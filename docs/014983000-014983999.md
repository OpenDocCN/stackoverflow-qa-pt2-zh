# StackOverflow 问答 14983000-14983999

# c++ - 我们可以在没有 MSTest 的情况下在 VS2012 或 VS2010 中获得原生 C++ 代码覆盖率吗？

> ID：14983003
> 
> 赞同：16
> 
> 时间：2013-02-20T15:02:18.460
> 
> 标签：c++, visual-studio-2012, code-coverage

我们想测量我们自己的自动化回归测试系统在相当大的本机应用程序上运行的代码覆盖率。这是一个复杂的脚本测试系统，使用我们应用程序的内置脚本。它有数千个测试，不会被 MSTest 单元测试取代。

虽然我们目前使用 VS2012 (Premium) 作为 IDE，但它仍然使用 VS2010 编译器和库进行编译。如果这是获得代码覆盖率的先决条件，那么这种情况可能会更快改变。

我们可以为此进行单独的构建——检测不是问题。

我只是对阅读 MS 文档感到困惑，这些文档似乎都是从假设您使用其内置测试框架运行单元测试开始的。那时我并没有努力寻找实际上首先谈论对 ALM 的本机支持的东西！

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-21T05:30:53.633

Visual Studio 2012 的代码覆盖工具完全独立于测试执行系统（完全披露：我编写了它，但在我离开微软后继承它的团队删除了一些相当有用的功能）。它在 VS 2012 中从头开始重写，以便在加载到进程中而不是修改磁盘上的可执行文件时动态检测本机代码（x86 和 x86-64）和托管代码（.NET 和 Silverlight）。

您可以在“%ProgramFiles%\Microsoft Visual Studio 11.0\Team Tools\Dynamic Code Coverage Tools”中找到 CodeCoverage.exe。

收集数据：

```
CodeCoverage.exe collect /output:foo.coverage foo.exe foos_args 
```

可以指定一个配置文件（该目录中有一个名为 CodeCoverage.config 的默认文件）来控制收集。

要分析覆盖率数据，您可以在 Visual Studio 2012 中打开 foo.coverage 或使用覆盖率工具本身进行分析：

```
CodeCoverage.exe analyze /output:results.xml foo.coverage 
```

注意：要进行检测，必须为您的模块发现 .pdb 文件。由于您使用 2010 进行构建，因此它们可能不适用于 2012 的 DIA，因此您可能必须使用 2012 的工具集进行重建。如果您在覆盖分析中没有看到您期望的模块，请传递`/include_skipped_modules`给分析命令；将有一个“原因”属性告诉您模块被跳过的原因（排除，没有调试信息等）。

编辑：另外，与以前版本的 Visual Studio 不同，2012 的覆盖文件格式是完全独立的。模块和 .pdb 不需要在分析时出现。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-08T15:48:37.430

我意识到这是一个旧帖子，但我相信答案仍然是相关的。

以前我在 C# 中可以使用的所有东西，当我迁移到 Visual C++ 时，我真的不喜欢我所看到的。另外，像你一样，MSTests 只对我部分有用；我也习惯有自己的测试应用程序。

基本上我想要的是以下内容：

*   运行 MS 测试或 EXE 文件
*   直接在 Visual Studio 中获取代码覆盖率。

在做了一些研究之后，我注意到 VS Enterprise 现在通过测试适配器支持此功能。

如果您不在 VSE 上，我注意到还有一些其他工具，每个工具都为用户提供独立的 UI。我个人不喜欢那样；我希望我的覆盖范围在 Visual Studio 中，最好是在 Visual Studio 社区版中。

所以我决定自己构建这个插件 - 虽然它不像 VSE 那样复杂 - 它对我有用。

*   [我在https://github.com/atlaste/CPPCoverage](https://github.com/atlaste/CPPCoverage)上写了一个 VSIX 代码覆盖工具。基本上，它管理 Visual Studio 中的突出显示，生成可点击的报告，并集成在解决方案资源管理器中。
*   对于覆盖率测量本身，我曾经使用[https://opencppcoverage.codeplex.com/](https://opencppcoverage.codeplex.com/)。基本上，这允许您对任何可调试（本机）可执行文件执行代码覆盖率测试。如今，我正在使用自己的代码覆盖率测量工具（上面也是开源的）。

# ember.js - Ember.js 嵌套视图变得非常慢

> ID：14983006
> 
> 赞同：4
> 
> 时间：2013-02-20T15:02:21.597
> 
> 标签：ember.js

我有一个两级深度数据模型，我想用 Ember.js 将其显示为嵌套列表。如果我做简单的版本，它会表现得很好：

```
 {{#each parent in content}}
    <p>Table {{parent.id}}</p>
          <ul>
              {{#each item in parent.children}}
                <ul>
                  <li>{{item.position}}</li>
                  <li>{{item.position}}</li>
                  <li>{{item.position}}</li>
                </ul>
              {{/each}}
            </ul>
    {{/each}} 
```

[http://jsfiddle.net/krumpi/TdZJG/](http://jsfiddle.net/krumpi/TdZJG/)

但是，如果不是将模型的属性显示为原始字符串，而是使用嵌套的 Ember.Select 和 Ember.TextArea 视图，性能会受到很大影响，按下加载按钮后需要相当长的时间才能在页面中显示控件：

```
 {{#each parent in content}}
            <ul>
              {{#each item in parent.children}}
                <ul>
                  <li>pos: {{item.position}}</li>
                  <li>
                    {{view Ember.Select
                        class="input-small"
                        contentBinding="App.CheckValues"
                        selectionBinding="item.status"}}
                  </li>
                  <li>{{view Ember.TextArea class="textarea-animated" name="description" valueBinding="item.comment"}}</li>
                </ul>
              {{/each}}
            </ul>
    {{/each}} 
```

[http://jsfiddle.net/krumpi/wtwHN/](http://jsfiddle.net/krumpi/wtwHN/)

您对如何提高性能有什么建议吗？这是使用 ember-1.0.0-pre4 完成的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T06:21:43.603

不使用 Ember 选择和 textarea 视图，而是为它们使用普通的 html 标记并仅绑定属性。这些视图通常会占用更多内存，并且将它们写入嵌套结构中会使您的代码运行缓慢。

# .net - 将 ASP.net MVC 网站部署到 Azure 网站的子文件夹？

> ID：14983008
> 
> 赞同：6
> 
> 时间：2013-02-20T15:02:32.280
> 
> 标签：.net, asp.net-mvc, azure, azure-web-app-service

我有一个 asp.net mvc 网站，我想将其部署到 Azure（最好通过 GitHub 部署），以便将其作为主域的子文件夹进行访问。

例如 [http://example.com/mymvcsite/](http://example.com/mymvcsite/)

理想情况下，我希望网站在子文件夹下完全独立。好像它被配置为一个很好的老式 IIS 应用程序文件夹。即我不想为 mydomain.com 建立一个域 mvc 网站，它恰好在 /mymvcsite/ 子文件夹路径下完成所有业务。

我很高兴整个网站都托管在 Azure 上，让这个特定项目存在于子文件夹下才有意义。

今天我一直在努力和谷歌搜索，试图弄清楚如何解决这个问题，却一无所获。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-28T19:56:01.960

如果您使用 Web 部署发布方法，您可以在站点名称中设置`mydomain/mymvcsite`而不是`mydomain`. 至少它适用于我的默认 windows azure 站点`http://mydomain.azurewebsites.net/mymvcsite`。

或者您可以使用 FTP 发布方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-01T04:59:45.447

您只需转到 azure 的控制面板并添加虚拟目录路径即可。

请访问这个 MDSN 博客，看看它是如何完成的。

[http://blogs.msdn.com/b/kaushal/archive/2014/04/19/microsoft-azure-web-sites-deploying-wordpress-to-a-virtual-directory-within-the-azure-web-网站.aspx](http://blogs.msdn.com/b/kaushal/archive/2014/04/19/microsoft-azure-web-sites-deploying-wordpress-to-a-virtual-directory-within-the-azure-web-site.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-30T13:44:28.920

**基本上，这需要执行以下步骤才能使其正常工作。**

解决方案包含

i) sampleApp.API(.Net Core Web API)

ii)sampleApp.UI( Angular 应用程序)

为两个应用程序设置 Azure 门户

1) 在 azure 门户中转到您的 Web 应用程序 -> 设置 -> 配置

2）选择路径映射并在此处为子站点创建新的映射条目。添加此条目时不要选择目录复选框以将其保留为虚拟应用程序类型。单击保存

```
 **Virtual Path:** /{folderName}            **physicalPath:**  /site/wwwroot/{folderName} 
```

3）现在转到VS2017右键单击您的API项目并单击发布

4）在发布设置窗口中将路径设置为

```
site name : existing + "/{folderName} "
DestinationUrl : existing + "/{folderName} " 
```

5) 现在 ng-build --prod 您的 Angular 应用程序并部署 dist/clientApp 文件夹并使用根路径发布。

所以现在两者都应该作为

```
angular app https://{AzureAppName}.azurewebsites.net

Web API https://{AzureAppName}.azurewebsites.net/{folderName}/api/{controllerName}/{action} 
```

如果用户在访问 api 项目时仍然面临“无法从 web.config 读取配置数据”问题

为此，在您的 API 项目中转到 startup.cs 并将配置函数更改为具有以下代码行

```
app.Map('/{folderName}', app1 => Configure1(app1, loggerFactory); 
```

并在名为 configure1 的配置函数的空白副本中创建并重新部署您的 API 项目，如上所述。

```
public void Configure1(IApplicationBuilder app, ILoggerFactory loggerFactory)
        {
            //keep it blank
        } 
```

# udp - recv() 在 UDP 上失败

> ID：14983012
> 
> 赞同：0
> 
> 时间：2013-02-20T15:02:35.253
> 
> 标签：udp, recv

我正在编写一个简单的客户端-服务器应用程序，暂时供我个人使用。我正在使用 Winsock 进行网络通信。在过去的 10 年里我没有做过任何网络，所以我很生疏。我想尽量少用外部代码，所以我自己写了一个服务器发现机制，如下。

客户端广播一条消息，其中包含绑定到任意端口的客户端 UDP 套接字的“名称”，我将其称为客户端的发现套接字。服务器 recv() 广播，然后 sendto() 客户端发现套接字其侦听套接字的“名称”。客户端然后使用此信息连接到服务器（在不同的套接字上）。这种机制应该允许服务器将其侦听套接字绑定到动态端口范围（49152-65535）内它可以绑定的第一个端口，并允许客户端发现服务器在哪里以及它正在侦听哪个端口。

服务器部分工作正常：服务器接收到广播消息并成功发送响应。

在客户端，防火墙日志显示服务器的响应到达了机器并且它被寻址到正确的端口（到客户端的发现套接字）。但是消息永远不会到达客户端应用程序。我试过在阻塞和非阻塞模式下做一个 recv() ，但从来没有任何数据可用。ioctlsocket() 总是显示没有可用的数据，即使我知道数据包已将其发送到机器。

服务器成功地对广播数据执行 recv()。但是客户端在执行服务器响应的 recv() 时失败，该响应被寻址到其发现套接字。

这个问题非常模糊：在这种情况下我应该注意什么问题？为什么 recv() 无法获得实际到达机器的数据包？套接字是 UDP，因此它们未连接的事实是无关紧要的。或者是吗？

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T02:09:18.750

> 客户端广播一条消息，其中包含绑定到任意端口的客户端 UDP 套接字的“名称”，我将其称为客户端的发现套接字。

消息不需要包含任何内容。*只需从*“发现套接字”广播一条空消息。`recvfrom()`会告诉服务器它来自哪里，它可以直接回复。

> 服务器 recv() 广播，然后 sendto() 客户端发现套接字其侦听套接字的“名称”。

很公平，尽管实际上服务器可以每 5 秒或其他时间广播自己的 TCP 侦听端口。

> 在客户端，防火墙日志显示服务器的响应到达机器并且它被寻址到正确的端口（到客户端的发现套接字）。但是消息永远不会到达客户端应用程序

如果它到达主机，它必须到达应用程序。你一定是把端口弄混了。如上所述简化并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T16:19:56.740

嗯，这是其中一种愚蠢的情况：Windows 防火墙处于活动状态，除了另一个防火墙，并且默默地丢弃数据包。停用它解决了这个问题。

但我仍然不明白它是如何工作的，因为它允许服务器接收通过广播发送的数据包。当我想尽办法将服务器设置为通过广播回复时，这些数据包被丢弃了。

两天的郁闷。我希望有人从我的经验中受益。

# python - 在 Python 中用正则表达式替换 html 脚本元素源

> ID：14983015
> 
> 赞同：1
> 
> 时间：2013-02-20T15:02:49.073
> 
> 标签：python, regex, escaping, html-parsing, shopify

我正在尝试编写一个大型 python/bash 脚本，将我的 html/css 模型转换为 Shopify 主题。此过程中的一个步骤是更改所有脚本源。例如：

```
<script type="text/javascript" src="./js/jquery.bxslider.min.js"></script> 
```

变成

```
<script type="text/javascript" src="{{ 'jquery.bxslider.min.js' | asset_url }}"></script> 
```

这是我到目前为止所拥有的：

```
import re
test = """
  <script type="text/javascript" src="./js/jquery-1.8.3.min.js"></script>
  <!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>-->
  <script type="text/javascript" src="./js/ie-amendments.js"></script>
  <script type="text/javascript" src="./js/jquery.bxslider.min.js"></script>
  <script type="text/javascript" src="./js/jquery.colorbox-min.js"></script>
  <script type="text/javascript" src="./js/main.js"></script>
"""
out = re.sub( 'src=\"(.+)\"', 'src="{{ \'\\1\' | asset_url }}"', test, flags=re.MULTILINE )
out 
```

打印出来

```
'\n  <script type="text/javascript" src="{{ \'./js/jquery-1.8.3.min.js\' | asset_url }}"></script>\n  <!--<script src="{{ \'http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript\' | asset_url }}"></script>-->\n  <script type="text/javascript" src="{{ \'./js/ie-amendments.js\' | asset_url }}"></script>\n  <script type="text/javascript" src="{{ \'./js/jquery.bxslider.min.js\' | asset_url }}"></script>\n  <script type="text/javascript" src="{{ \'./js/jquery.colorbox-min.js\' | asset_url }}"></script>\n  <script type="text/javascript" src="{{ \'./js/main.js\' | asset_url }}"></script>\n' 
```

到目前为止我有两个问题：

1.  我用来转义正则表达式中的单引号的一些反斜杠字符显示在输出中。

2.  我的捕获组正在捕获整个原始源字符串，但我只需要最后一个“/”之后的内容

**答案**：根据 Martijn Pieters 的有用建议，我查看了 ? 正则表达式运算符，并提出了这个解决方案，完美地解决了我的问题。此外，对于替换表达式，我将其封装在双引号中，而不是单引号，并转义双引号，最终删除了不必要的反斜杠。多谢你们！

```
re.sub( r'src=".+?([^/]+?\.js)"', "src=\"{{ '\\1' | asset_url }}\"", test, flags=re.MULTILINE ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:14:49.890

你的表达效果很好；Python 只是向您显示一个*字符串文字*，您必须在其中转义引号才能将其重新用作 Python 字符串。

如果您打印该值，则不会发生此类转义：

```
>>> re.sub( 'src=\"(.+)\"', 'src="{{ \'\\1\' | asset_url }}"', test, flags=re.MULTILINE )
'\n  <script type="text/javascript" src="{{ \'./js/jquery-1.8.3.min.js\' | asset_url }}"></script>\n  <!--<script src="{{ \'http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript\' | asset_url }}"></script>-->\n  <script type="text/javascript" src="{{ \'./js/ie-amendments.js\' | asset_url }}"></script>\n  <script type="text/javascript" src="{{ \'./js/jquery.bxslider.min.js\' | asset_url }}"></script>\n  <script type="text/javascript" src="{{ \'./js/jquery.colorbox-min.js\' | asset_url }}"></script>\n  <script type="text/javascript" src="{{ \'./js/main.js\' | asset_url }}"></script>\n'
>>> print(re.sub( 'src=\"(.+)\"', 'src="{{ \'\\1\' | asset_url }}"', test, flags=re.MULTILINE ))

  <script type="text/javascript" src="{{ './js/jquery-1.8.3.min.js' | asset_url }}"></script>
  <!--<script src="{{ 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript' | asset_url }}"></script>-->
  <script type="text/javascript" src="{{ './js/ie-amendments.js' | asset_url }}"></script>
  <script type="text/javascript" src="{{ './js/jquery.bxslider.min.js' | asset_url }}"></script>
  <script type="text/javascript" src="{{ './js/jquery.colorbox-min.js' | asset_url }}"></script>
  <script type="text/javascript" src="{{ './js/main.js' | asset_url }}"></script> 
```

您可以使用`?`to`+`和限定词non - *greedy*`*`；匹配最小值而不是最大值。您还可以匹配任何*不是*引号的内容：`?`

 **```
r'src="([^"]+)"' 
```

这更好地约束了正则表达式的那一部分；`[^"]`匹配任何*不是*双引号的字符。

在指定正则表达式模式时，通常使用 python 原始字符串文字 ( `r''`) 代替是一个好主意，这样可以省去很多关于哪些需要转义和哪些不需要转义的麻烦。使用原始字符串文字，您的替换模式可以简化为：

```
r'src="{{ \'\1\' | asset_url }}"' 
```

最后一行：

```
re.sub(r'src="([^"]+)"', r'src="{{ \'\1\' | asset_url }}"', test, flags=re.MULTILINE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:40:45.320

在不引起某些人的愤怒的情况下，您可以将其视为 xml。

```
txt = """<html>
<script type="text/javascript" src="./js/jquery.bxslider.min.js"></script>
<script type="text/javascript" src="./js/jquery.another.min.js"></script>
</html>
"""

import xml.etree.ElementTree as ET
import os
root = ET.fromstring(txt)

for e in root.findall('script'):
    e.attrib['src'] =  "{{ '%s' | assert_url }}" % os.path.basename(e.attrib['src'])

print ET.tostring(root) 
```

给出：

```
<html>
<script src="{{ 'jquery.bxslider.min.js' | assert_url }}" type="text/javascript" />
<script src="{{ 'jquery.another.min.js' | assert_url }}" type="text/javascript" />
</html> 
```

之后 xml 文档可能会有用；这一切都取决于你的 HTML 有多好和多好。**

# jquery - 一个接一个地为两个 Div 设置动画

> ID：14983019
> 
> 赞同：0
> 
> 时间：2013-02-20T15:02:55.483
> 
> 标签：jquery, html, css, jquery-animate

我有一个由按钮组成的菜单。当我点击第一个按钮时，jquery UI 选项卡出现不透明度设置为 0.7。然后，当我点击菜单中的第二个按钮时，我希望第一个 UI 选项卡不透明度更改为 0，并且第二个 UI 选项卡与第一个选项卡显示相同。我的菜单中有 4 个按钮，所以我希望这对每个按钮都有效。

```
$(document).ready(function(){
  $("#bt1").click(function(){
    $("#info1").animate({opacity:'0.7'});   
 });
});

$(document).ready(function(){
  $("#bt2").click(function(){
    $("#info1").animate({opacity:'0'}); 
    $("#info2").animate({opacity:'0.7'});   
 });
}); 
```

HTML

```
<div id="info1" class="info">
<div id="tabs"> 
<ul>
    <li><a href="#tabs-1">First</a></li>
    <li><a href="#tabs-2">Second</a></li>
    <li><a href="#tabs-3">Third</a></li>
</ul>
<div id="tabs-1"><p></p></div>
<div id="tabs-2"><p></p></div>
<div id="tabs-3"><p></p></div>
</div>

<div id="info2" class="info">

<div id="tabs">

<ul>
    <li><a href="#tabs-1">Fourth</a></li>
    <li><a href="#tabs-2">Fifth</a></li>
    <li><a href="#tabs-3">Sixth</a></li>
</ul>
<div id="tabs-1"><p>    </p></div>
<div id="tabs-2"><p>    </p></div>
<div id="tabs-3"><p>    </p></div> 
```

我对 jQuery 很陌生，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:49:18.163

HTML

```
<div id="nav">
    <ul>
        <li><a class="btn current" href="">Home</a></li>
        <li><a class="btn" href="">About</a></li>
        <li><a class="btn" href="">Info</a></li>
        <li><a class="btn" href="">Contact</a></li>
    </ul>
</div> 
```

jQuery

```
$(".btn").click(function() {
    $('.btn').removeClass('current');
    $(this).addClass('current').animate({opacity:1}, function() {
        $('.btn:not(.current)').animate({opacity:0.7})
    });
    return false;
}); 
```

jsFiddle 演示：http: [//jsfiddle.net/9APzE/](http://jsfiddle.net/9APzE/)

这个想法很简单：1 类用于“默认”状态 (.btn)，1 类用于“突出显示”状态 (.current)。你可以有 24 个按钮，这种技术会起作用。另外，您永远不必在 jQ 函数的任何行中添加类似“.btn-24...”的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:08:12.837

试试这个...

```
$(document).ready(function(){
    $("#bt1").click(function(){
        $("#info1").animate({opacity:'0.7'});
    });
    $("#bt2").click(function(){
        $("#info1").animate({opacity:'0'}, 400, "swing", function() {
            $("#info2").animate({opacity:'0.7'});
        });
    });
}); 
```

我已经摆脱了其中一个`$(document).ready()`障碍，因为您不需要它们两个-您可以合二为一。然后我把第二个动画放到了第一个动画的回调函数中，所以它会等到第一个动画完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:08:57.393

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

请参阅文档或任何教程。

解决方案：

```
$(document).ready(function(){
        $("#bt2").click(function(){
            //Start first animation.
            $("#info1").animate({opacity:'0'},
                /*on Animation Ends in the future*/
                function () {
                    //Start second animation.
                    $("#info2").animate({opacity:'0.7'});   
        });
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:29:09.170

怎么样：

```
$(document).ready(function(){
$("#bt1, #bt2, #bt3, #bt4").click(function(){
   Var id = $(this).attr("id").substring(2);
$("#info1, #info2, #info3, #info4").animate({opacity:'0'},
function () {
$("#info"+id).animate({opacity:'0.7'});
});

}); 
```

这样，它适用于所有四个按钮，以及应用回调。

**编辑**

```
$(document).ready(function(){
$("#bt1, #bt2, #bt3, #bt4").click(function(){
Var id = $(this).attr("id").substring(2);
$(".current").removeClass('current');
$("#info"+id).addClass('current').animate({opacity:'0.7'});
$("#info1, #info2, #info3, #info4").not('.current').animate({opacity:'0'});   
}); 
```

可以更好地解决您的需求（它会同时为旧的和新的动画制作动画，并且不需要您更改 html）

# javascript - 如何在 JavaScript 中添加句号到字符串的末尾，如果它不存在的话？

> ID：14983021
> 
> 赞同：4
> 
> 时间：2013-02-20T15:03:03.340
> 
> 标签：javascript

我试图弄清楚如何检查字符串是否以句号结尾，如果不是，则应通过香草 JavaScript 添加。有任何想法吗？

我在想这样的事情可能会实际查看变量末尾是否有句号，但它似乎出错了？

目前我也不知道如何将句号添加到字符串的末尾。

```
 if todoTitle.str.charAt(str.length-1) != "." {
        alert("doesn't end in .");
    } else {
        alert("does end in .");
    }; 
```

关于解决此问题的最佳方法的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T15:04:35.600

子句中的条件`if`必须用括号括起来。此外，您将字符串引用一次 as`todoTitle.str`和一次 as `str`。我认为只有前者是正确的？所以：

```
 if (todoTitle.str.charAt(todoTitle.str.length-1) != ".") {
        alert("doesn't end in .");
    } else {
        alert("does end in .");
    } 
```

（请注意，我也删除`;`了块后的不合适`else`。

此外，您可能需要明确检查以确保`todoTitle.str.length >= 1`.

* * *

至于实际添加字符：一种选择是使用上面的检查，然后写`todoTitle.str = todoTitle.str + '.'`. 另一种是结合check-and-add使用`replace`方法：

```
todoTitle.str = todoTitle.str.replace(/([^.])$/, '$1.'); 
```

这将把最后一个字符替换为 self-plus- `.`，前提是最后一个字符不是 self `.`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:08:05.817

> 目前我不知道如何将句号添加到字符串的末尾。

那将是通过字符串连接：

```
if (todoTitle.str.charAt(todoTitle.str.length-1) != ".") {
    todoTitle.str = todoTitle.str + "."
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:06:12.340

if 语句需要放在括号中：

```
if (todoTitle.str.charAt(str.length-1) != ".") { 
```

# sql-server - SmallInt 中的 SQL 按位

> ID：14983031
> 
> 赞同：0
> 
> 时间：2013-02-20T15:03:29.730
> 
> 标签：sql-server

我有一个关于在 sql 中存储按位标志的问题。我有许多状态标志，我想将它们存储在 SQL smallint 字段中。所以一个 smallint 可以表示 -32768 到 32767。

如果我想使用所有 32 位来存储布尔值，我该如何引用这些位。例如。如果我想存储构成数字 1 的位，我通常会在 LSB 中看到 31 个零和一个 1。该序列会等同于我的 smallint 字段中的值吗？MSB 中的 1 和所有其他位中的 0 呢？也许有更好的方法在 SQL 中存储和查询按位数据。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:25:00.843

使用[位](http://msdn.microsoft.com/en-us/library/ms177603.aspx)数据类型？您需要的每个标志一个

SQL Server 根据需要将位列打包成尽可能多的字节

*   最多 8 = 1 个字节
*   9-16 是 2 个字节
*   ...

数据库引擎还将为您处理所有位掩码等您
所看到的都是离散位值

那么...为什么要自己动手？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-20T15:28:59.630

理想的解决方案是使用 32 个独立的 TinyInt 字段。TinyInt 支持 0-255 的值。如果您尝试使用单个字段并进行位处理，您将失去索引任何这些标志的能力，就像您使用位类型字段时一样。

# linq-to-entities - 您将如何有效地编写此 linq 查询？

> ID：14983032
> 
> 赞同：0
> 
> 时间：2013-02-20T15:03:32.983
> 
> 标签：linq-to-entities

有 n 家公司 有 m 名员工 一名员工可以在多家公司工作

我给你一份公司名单 {c1,c2,...} 给我所有为这家公司工作的员工，他们的名字是 Bob。

```
context.EmployeeSet.Where(e => e.Companies.Intersect(_companiesParam)!=null).Where(emp=>emp.Name=="Bob").ToList(); 
```

搜索所有名为 Bob 的员工会非常慢，因为每家公司的平均员工人数少于 10 人，所以我首先按公司归档。

我关心的是我应该如何编写 .Where(e => e.Companies.Intersect(_companiesParam)!=null) 更有效。是否可以避免相交运算符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:08:50.397

如果你想避免相交，你总是可以用 Any 和 Contains 编写它。

```
context.EmployeeSet.Where(e => e.Companies.Any(c => _companiesParam.Contains(c)) && e.Name == "Bob").ToList(); 
```

# opengl - opengl 对象移动/切换语句

> ID：14983033
> 
> 赞同：0
> 
> 时间：2013-02-20T15:03:38.437
> 
> 标签：opengl, object, cube

任何人都可以教我如何在原点 (0, 0, 0) 中绘制 2 个对象，例如一个立方体和一个球体，当我移动立方体时，球体仍然保持在原点。与移动球体相同，立方体仍然存在..使用键盘功能。

```
if (!LightSwitch)
{ 
glEnable(GL_LIGHTING);
glEnable(GL_LIGHT0);
glPushMatrix();
glTranslatef(CubeX, CubeY, CubeZ);
glColor3f(1.0, 0.0, 0.0);
glPushAttrib(GL_LIGHTING_BIT | GL_CURRENT_BIT);
glMaterialfv(GL_FRONT_AND_BACK, GL_DIFFUSE, Green);
glutSolidCube(2.0);
glPopAttrib();
glPopMatrix();
glEnd(); 
}

if (!LightSwitch1)
{
glEnable(GL_LIGHTING);
glEnable(GL_LIGHT1);
glPushMatrix();
glTranslatef(AxisX, AxisY, AxisZ);
glColor3f(1.0, 0.0, 0.0);
glPushAttrib(GL_LIGHTING_BIT | GL_CURRENT_BIT);
glMaterialfv(GL_FRONT_AND_BACK, GL_DIFFUSE, Blue);
glutSolidSphere(2.0, 10.0, 5.0);
glPopAttrib();
glPopMatrix();
}
glEnd(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T22:49:36.840

我不是专家，但我相信通过为球体和立方体设置单独的 glPushMatrix() / glPopMatrix() 块，您可以为每个对象提供自己的局部坐标系。这就是它们相互独立变换的原因。

如果要将它们一起移动，则需要先在 glPushMatrix() / glPopMatrix() 之外指定 glTranslate() ：

```
glTranslatef(translation....);     // Translates the whole scene 
glPushMatrix();
   glTranslatef(the sphere);       // Sphere & cube locations changeable via keyb.
   glTranslatef(the cube);
glPopMatrix(); 
```

例如，如果您想相对于球体旋转立方体（即，使球体的中心成为立方体坐标系的原点），请在第一个块中创建一个新的 glPushMatrix()/glPopMatrix() 块：

```
glPushMatrix();
   glTranslatef(the sphere);       
        glPushMatrix();
        glRotatef(the cube);       // Rotate about specific axis of the sphere
        glPopMatrix();
glPopMatrix(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T06:30:23.133

我相信您的代码对于在位置 Axis 绘制球体和在位置 Cube 绘制立方体是正确的。您说您正在使用键盘功能，当您只想移动一个时，它会将它们一起移动。我相信您正在更新键盘功能中的两组变量。尝试打印出 CubeXYZ 和 AxisXYZ 并确保您得到正确的结果。

# java - 删除 SQLite 表时出现 IllegalStateException - Android

> ID：14983034
> 
> 赞同：0
> 
> 时间：2013-02-20T15:03:47.737
> 
> 标签：java, android, sqlite, illegalstateexception

我有一个显示高分表的 SQLite 数据库。如果用户愿意，我想为用户提供删除高分的选项（见下面的截图）。如果用户选择是，我希望对话框关闭，然后对话框后面的屏幕为空，除了 4 个列标题、2 个按钮和活动标题。

现在，当用户选择 Yes 时，它会给出下面的 LogCat。

```
02-20 09:59:39.686: E/AndroidRuntime(2458): FATAL EXCEPTION: main
02-20 09:59:39.686: E/AndroidRuntime(2458): java.lang.IllegalStateException: attempt to re-open an already-closed object: SQLiteDatabase: /data/data/matt.lyons.bibletrivia/databases/test3
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.database.sqlite.SQLiteClosable.acquireReference(SQLiteClosable.java:55)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.database.sqlite.SQLiteDatabase.delete(SQLiteDatabase.java:1489)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at matt.lyons.bibletrivia.DatabaseHelper.deleteAll(DatabaseHelper.java:46)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at matt.lyons.bibletrivia.Highscores$3.onClick(Highscores.java:198)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.view.View.performClick(View.java:4202)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.view.View$PerformClick.run(View.java:17340)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.os.Handler.handleCallback(Handler.java:725)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.os.Looper.loop(Looper.java:137)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at java.lang.reflect.Method.invokeNative(Native Method)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at java.lang.reflect.Method.invoke(Method.java:511)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-20 09:59:39.686: E/AndroidRuntime(2458):     at dalvik.system.NativeStart.main(Native Method) 
```

数据库助手.java

```
//Delete all rows/whole table from high scores.
public int deleteAll() { 
    return db.delete(TABLE, null, null);  //Line 46
} 
```

高分.java

```
public void areYouSure() {

    final Dialog dialog = new Dialog(context);
    dialog.setContentView(R.layout.clearhighscores);
    dialog.setTitle("Clear Highscores?");

    TextView question = (TextView)dialog.findViewById(R.id.question);
    Button yes = (Button)dialog.findViewById(R.id.yes);
    Button no = (Button)dialog.findViewById(R.id.no);

    question.setText("This is not reversable.  Are you sure you want to delete the high scores?");
    yes.setText("Yes");
    no.setText("No");

    yes.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            dh.deleteAll();  //Line 198
            dialog.dismiss();

        }
    });

    no.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            dialog.dismiss();
        }
    });
    dialog.show();
} 
```

![在此处输入图像描述](../Images/d3dce98d61e1d28f4ecd31a86351b7ca.png)

我的问题是如何让用户在程序不崩溃的情况下删除数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:07:16.127

> java.lang.IllegalStateException：尝试重新打开一个已经关闭的对象：SQLiteDatabase

这意味着您试图删除数据但您的数据库已**关闭**。所以在删除之前，你需要检查数据库是否打开，如果没有，打开它，否则只需执行删除操作。

你在哪里关闭数据库？`onDestroy()`您应该在or`onStop()`方法中关闭任何数据源、游标等。

# asp-classic - 在 ASP 中解析页面之间的信息

> ID：14983035
> 
> 赞同：0
> 
> 时间：2013-02-20T15:03:52.773
> 
> 标签：asp-classic, handler

我想要发生的是当用户选择他们想要点击提交的金额时。现在该金额将传递到下一页。

问题是我不理解处理程序中的代码，有没有人知道我可以得到一些简单的代码来实现这一点？

抱歉，我不清楚 asp 和 asp.net

谢谢

```
<form id='sampleform' method='post' action='handler.asp' >
   <p>
   Name: <input type='text' name='Name' />
   </p>
   <p>
   Email: <input type='text' name='Email' />
   </p>
<input type="radio" name="subject" value="ten" /> &pound;10
<input type="radio" name="subject" value="five" /> &pound;5
<input type="radio" name="subject" value="three" /> &pound;3
&pound;<input type='text' name='donate-amount' />
   <p>
   <input type='submit' name='Submit' value='Submit' />
   </p>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:58:18.207

如果我能在 handler.asp 中看到代码，那将会有所帮助。尝试以下作为您的 handler.asp 页面

```
<%=Request.Form("Name")%> <br />
<%=Request.Form("Email")%> <br />
<%=Request.Form("subject")%> <br />
<%=Request.Form("donate-amount")%> <br /> 
```

# php - Symfony2 Twig 表单的快捷方式：form_widget

> ID：14983036
> 
> 赞同：4
> 
> 时间：2013-02-20T15:03:53.390
> 
> 标签：php, forms, symfony, refactoring, twig

我想更换：

```
{{ form_errors(form.name) }}
{{ form_widget(form.name, { 'attr': {'placeholder': 'Nom'} }) }} 
```

经过：

```
{{ form.name|field('Nom') }} 
```

我怎么能那样做？我试图在 Twig 扩展中做到这一点，但我无权访问 form_widget 函数。

**编辑**：我可以用`form.name`属性（包括父表单）来做到这一点，但我会重复 symfony 代码，这将是一个非常丑陋的大黑客

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T10:54:44.460

如果您要求我将 attr 移至您的表单类，则更有意义：

```
class SomeForm extends AbstractType {
      //.....
      $builder->add('name', 'text', array('attr' => array('placeholder'=>'Nom')));
} 
```

由于我猜您需要为某些字段进行一些自定义渲染，因此您可以检查：

[http://symfony.com/doc/2.0/cookbook/form/form_customization.html#how-to-customize-an-individual-field](http://symfony.com/doc/2.0/cookbook/form/form_customization.html#how-to-customize-an-individual-field)

您还可以创建一个新类型并按照此处的说明对其进行自定义：

[http://symfony.com/doc/2.0/cookbook/form/form_customization.html#what-are-form-themes](http://symfony.com/doc/2.0/cookbook/form/form_customization.html#what-are-form-themes)

你甚至可以改变默认的渲染方式，并让 symfony 使用字段的标签字符串默认渲染你的占位符标签（全局启用表单主题的细节在上面引用的链接中介绍）：

```
{% block text_widget %}
    {% set type = type|default('text') %}
    <input type="text" {{ block('widget_attributes') }} value="{{ value }}" />
{% endblock field_widget %}

{% block widget_attributes %}
  {% spaceless %}
    {% for attrname,attrvalue in attr %}{{attrname}}="{{attrvalue}}" {% endfor %} placeholder="{{ label|trans }}"
  {% endspaceless %}
{% endblock widget_attributes %}

{% block form_row %}
  {% spaceless %}
    <div class="my-class">
        {{ form_errors(form) }}
        {{ form_widget(form) }}
    </div>
  {% endspaceless %}
{% endblock form_row %} 
```

因此，您将使用 symfony 提供的主题将自己限制在一个 form_row(form.name) 中。Symfony 的方法在我看来“非常”干/死。希望能帮助到你。

# php - 如何在codeigniter中显示数据库中的内容而不从视图中调用控制器？

> ID：14983038
> 
> 赞同：2
> 
> 时间：2013-02-20T15:03:55.533
> 
> 标签：php, mysql, codeigniter

我是codeigniter的新手。我按照视频教程成功创建了登录注册系统。注册或登录后，用户会到达一个名为 members.php 的页面。

members.php 是一个视图。

我的控制器是 main.php，模型是 model-users.php。

我希望 members.php 显示/包含数据库中的内容，以便用户可以在登录或注册后阅读它？

我关注了网络上的一些资源，这些资源说不要从视图中调用控制器。如果不这样做，我怎么能成为上述行为的同谋？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T15:18:14.763

我认为[CodeIgniter 文档](http://ellislab.com/codeigniter/user-guide/)实际上非常清晰，而且非常容易理解。不过，这里有一个示例，说明您可以如何构建您的应用程序。

**控制器**：

```
<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Members extends CI_Controller {
    function __construct() {
        parent::__construct();

        $this->load->model('members_model');
    }

    function index() {
        $data['members'] = $this->members_model->get_members();

        $this->load->view('header', $data);
        $this->load->view('members');
        $this->load->view('footer');
    }
} 
```

**型号**：

```
<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Members_model extends CI_Model {

    function get_members() {
        $query = $this->db->get('members');
        return $query->result_array();
    }
} 
```

**查看**：

```
<?php

print_r($members); 
```

* * *

要访问上述页面，您将访问[http://yoursite.com/index.php/members](http://yoursite.com/index.php/members)。

您可以使用文件从 URI`.htaccess`中删除段。`index.php`运行控制器时会自动调用该`index()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:14:53.027

我没有任何代码示例，但是当您可以显示成员的姓名和姓氏时，我编写了一个简单的 HTML 示例。控制器：

```
function members(){
  $members = $this->model-user->get_list(); //array of members
  $this->load->view('members.php', $members); // load members in view
} 
```

查看 members.php

```
<html>
<body>
    <table>
      <tr>
        <th>Name</th>
        <th>Surname</th>
      </tr>
      <?php foreach($members as $m): ?>
      <tr>
        <tr><?php echo $m['name']; ?>
        <tr><?php echo $m['surname']; ?>
      </tr>
      <?php endforeach; ?>
    <table>
</body>
</html> 
```

模型：

```
function get_list() {
   // query in database
   return $query = $this->db->get('members'); //table name members
} 
```

这是简短形式的简单示例。我希望你能理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T22:27:18.627

我想我知道你的意思，这绝对不是解决这个问题的正确方法，但如果你真的必须这样做，你可以从这样的视图中调用模型。
在视图中

```
<div>

    <?php 
    #You could load the model here or autoload it in config->autoload->models(i believe)
    $data = $this->model_name->model_function();?>
    foreach($data as $row): 
           echo '<pre>';
           print_r($row);
           echo '</pre>';
    endforeach; 
    ?>

</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-16T09:14:15.973

这是我的代码示例：

**意见：**

```
 <?php foreach($ecms as $i){ ?>
                    <tr>
                    <td><?php echo $i->accnum; ?></td>
                    <td><?php echo $i->crdnum; ?></td>
                    <td><?php echo $i->fname; ?></td>
                    <td><?php echo $i->bday; ?></td>
                </tr>
            <?php } ?> 
```

**模型：**

```
function masterHide()

{
    $sql =" select * from ecms";
    $query = $this->db->query($sql);
    return($query->num_rows() > 0) ? $query->result(): NULL;
} 
```

**控制器：**

```
 function search() {

//  $this->MasterListAccess();
    $this->load->model('navi_model');
    $query = $this->navi_model->masterHide();
    //check results or returned value of model
    //print_r($query);
    $data['ecms'] = $query;
    $data['main_content'] = 'search';
    $this->load->view('includes/template',$data);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-30T11:15:38.477

首先在您的项目文件中连接数据库并在您的视图页面中连接模​​型页面并尝试此代码。转到查看页面并尝试此代码

**看法**

```
20
21
<?php
	$get_data=$this->MyModel->get_table_data();
?>
<table class="table table-bordered">
	<thead>
		<tr>
			<th> Name </th>
			<th> Email </th>
			<th> Phone No </th>
		</tr>
	</thead>
	<tbody>
	<?php foreach($get_data as $val){ ?>
		<tr>
			<td><?php echo $val->name; ?></td>
			<td><?php echo $val->email; ?></td>
			<td><?php echo $val->phone; ?></td>
		</tr>
	<?php } ?>
	</tbody>
</table>
```

**模型**

```
public function get_table_data(){ $qry=$this->db->select('*')->from('Table Name')->get()->result(); return $qry; }
```

# javascript - jQuery 悬停鼠标进入鼠标离开

> ID：14983039
> 
> 赞同：1
> 
> 时间：2013-02-20T15:03:58.000
> 
> 标签：javascript, jquery, html

我正在尝试使用此脚本进行悬停效果：

```
function itemhover(){
    $(".item").mouseenter(function(){
        $(".mask").fadeIn();
    })
    $(".item").mouseleave(function(){
        $(".mask").fadeOut();
    })
} 
```

问题是，当我将鼠标悬停在任何项目上时，它会在所有的 .mask 中消失，我怎样才能将函数指向只在悬停的项目上工作？

另外，当我在项目上快速进出鼠标时，淡入淡出效果变得疯狂，就像它不会停止，然后过一会儿就停止了，这是为什么呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:05:09.887

听起来您的 .mask 元素包含在您的 .item 元素中。如果是这种情况，那么您可以使用`$(this)`“设置范围”悬停的项目（*这*是指悬停的项目）。

```
function itemhover(){
    $(".item").mouseenter(function(){
        $(this).find(".mask").stop(true, true).fadeIn();
    })
    $(".item").mouseleave(function(){
        $(this).find(".mask").stop(true, true).fadeOut();
    })
} 
```

此外，您可能希望在*淡入淡出*`.stop(true, true)`动画效果之前链接以停止任何先前排队的动画并跳转到最后一个排队动画的末尾。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:08:19.650

你可以使用这个语句

```
$(".mask",this).fadeIn(); 
```*

# php - 选择属于某个组的所有用户，查询复杂

> ID：14983042
> 
> 赞同：0
> 
> 时间：2013-02-20T15:04:11.123
> 
> 标签：php, mysql, join, group-concat

我正在处理一个目前运行良好的查询（我正在使用来自前端的输入来生成 WHERE 子句），但我希望能够搜索另一个参数，这真的让我难以置信。

1.  表`groups`包含 id、name。
2.  表`persons`是我要检索的人的表。
3.  表`group_memberships`是我的组<->人多对多关系表。列是参与者 (person.id) 和组 (groups.id)

检索到的结果集的最后一列是 group_memberships 的串联，但其中“1、2、3”已通过 JOIN 替换为组的真实姓名。

今天的查询如下：

```
SELECT
  `persons`.`id`,
  CONCAT_WS(\' \', `fname`, `lname`) AS `full_name`,
  `job_title`,
  `email`,
  `phone`,
  `participant_group_memberships`.`memberships`
FROM
  `persons`
  LEFT JOIN (SELECT
               `participant`, `name`,
               GROUP_CONCAT(`groups`.`name` ORDER BY `groups`.`name`
                            SEPARATOR  \', \') AS `memberships`
             FROM
               `group_memberships` JOIN `groups`
                ON (`groups`.`id` = `group_memberships`.`group`)
             GROUP BY `participant`) AS `participant_group_memberships`
  ON (`participant_group_memberships`.`participant` = `persons`.`id`)
WHERE TRUE . $where . '
ORDER BY `full_name` 
```

如果我添加 WHERE name = 'search_query_group' 那么串联列表只会显示我不想要的组。我仍然想显示该人所属的所有组。

我还想通过 1 个查询来实现这一点，并尽可能避免使用 IN()。

![在此处输入图像描述](../Images/8cdd750ec4632535f01752254fb2becb.png)

如您所见，最后一列（使用 GROUP_CONCAT 生成）将仅显示我搜索的组，而不是该人所属的所有组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:21:12.277

您可以在子查询的 HAVING 子句中使用 SUM 和 CASE 语句来包含搜索结果。您还需要将子查询的联接更改为 INNER JOIN。这将返回某个组中的所有人员，并显示他们所属的所有组。

```
SELECT  `persons`.`id`,
        CONCAT_WS(\' \', `fname`, `lname`) AS `full_name`,
        `job_title`,
        `email`,
        `phone`,
        `participant_group_memberships`.`memberships`

FROM    `persons` 

        JOIN `pers_department`
        ON (`pers_department`.`pers_rid` = `persons`.`id`)

        JOIN 
        (SELECT `participant`, `name`,
                GROUP_CONCAT(`groups`.`name` ORDER BY `groups`.`name`
                            SEPARATOR  \', \') AS `memberships`
         FROM   `group_memberships` 
                JOIN `groups` ON (`groups`.`id` = `group_memberships`.`group`)
         GROUP BY `participant`
         HAVING SUM(CASE WHEN name = 'search_query_group' THEN 1 ELSE 0 END) > 0
        ) AS `participant_group_memberships`
        ON (`participant_group_memberships`.`participant` = `persons`.`id`)

WHERE TRUE . $where . '

ORDER BY `full_name` 
```

# excel - 打开文件后保存 Excel 文件名

> ID：14983044
> 
> 赞同：0
> 
> 时间：2013-02-20T15:04:18.110
> 
> 标签：excel, filenames, vba

在 Excel 中，我正在编写一个宏来在两个文件之间移动和格式化数据。我首先打开第一个文件并运行一个允许您选择文件的宏。

我正在使用以下代码打开一个文件：

> myFileName= Application.GetOpenFilename(filefilter:="All Files, *.* ", Title:="All Files")

然后我用这个代码跟随它：

> Workbooks.Open 文件名：=myFileName

稍后在代码模块中，我想在这个新打开的文件和我从里面运行宏的文件之间复制和过去。目前我不得不像这样硬编码他们的名字：

> Windows("data.xlsx").激活

如何将新打开的文件的名称存储在字符串中，如何将我所在的 excel 文件的名称存储在字符串中？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:10:23.117

在打开第二个工作簿之前，将当前工作簿的名称分配给一个变量：

```
nameFirstWorkbook = ActiveWorkbook.Name 
```

您已经从打开文件对话框中获得了第二个工作簿的名称。

# css - IE 中的下拉导航隐藏/不起作用

> ID：14983048
> 
> 赞同：1
> 
> 时间：2013-02-20T15:04:25.690
> 
> 标签：css, internet-explorer, drop-down-menu, navigation

这是我的 css ......前段时间写了这个，它完美地在 IE/Firefox/Chrome 上运行，最近又回到了它，现在很惊讶它不会在 IE 中显示我的下拉导航。帮助？

[http://pastebin.com/smRU6Syb](http://pastebin.com/smRU6Syb) = html

```
/* ANYTHING UNDEFINED */
*
{
margin:0px;
border:none;
}    

/* CONTENT WRAPPER */ 
#contentwrapper {
margin-left: auto;
margin-right: auto;
margin-bottom:50px;
width: 800px;
border:1px solid black;
background-image:url('contentbg.png');
}

 /* IMAGE GALLERY */
 div.img
 {
 margin:2px;
 margin-left:auto;
 float:left;
 text-align:center;
}
div.img img
{
 display:inline;
border:1px solid black;
 }
div.img a:hover img
 {
 border:2px solid #0000ff;
 }
 div.desc
 {
 text-align:center;
 font-weight:normal;
 width:120px;
 margin:2px;
  }  /**** ^^^END IMG GALLERY^^^ ****/

 /* TITLE PANEL */
 #titlepane {
background-color: white;
background-image:url(badgesketch.jpg);
background-repeat: no-repeat;
margin-left: auto;
margin-right: auto;
text-align:center;
width: 800px;
\width: 800px /* IE9 */
 }
/* LEFT ALIGN ANYTHING WITH LA ID'S */
#la{
text-align:left;
}

/* BODY TEXT AND CONTENT */
#btext {
margin-top:50px;
min-height:500px;
text-align:CENTER;
margin-left:20px;
margin-right:20px;
margin-bottom:20px;
}

 /* NAVBAR DIV */
 #navbar {
 width:800px;
 \width:800px;
 }

 /* NAV ID'S */
 #nav {
background-image:url('navbarbg.png');
list-style: none;
font-weight: bold;
/* Clear floats */
float: right;
width: 760px;
/width:800px;
height:45px;
/* Bring the nav above everything else--uncomment if needed.
 position:relative;
 z-index:5;
 */
     }

    /* NAV LI'S */
    #nav li {
float: left;
margin-right: 10px;
position: relative;

       }

 /* TOP LINKS ACROSS THE NAVBAR (NON-DROPDOWNS) */
 #top {
 margin-top:7px;
 margin-bottom:7px;
 }

 /* FIRST NON-DROPDOWN LINK (CENTERING) */
 #first{
 margin-left:35px;
 /margin-left:73px;
 margin-top:7px;
 margin-bottom:7px;
 }

 /* FOOTER */
 #foot{
 text-align:center;
 border-top: 1px solid black;
 background-color:white;
 margin:0px;
 padding:10px;
 }

 /* LINKS WITH NAV ID'S */
 #nav a {
display: block;
padding: 5px;
color: white;
background: black;
border: 1px solid white;
text-decoration: none;
text-align:center;
z-index:400;
 }

 /* HOVERED LINKS WITH NAV ID'S */
 #nav a:hover {
color: red;
background: #000262;
text-decoration: underline;

 }
 /* UL'S WITH NAV ID'S */
 #nav ul {
background: black; /* Background color of the dropdown */
background: rgba(255,255,255,0); /* Transparency of the Background*/
list-style: none;
position: absolute;
left: -9999px; /* Hide the dropdown off-screen when not needed */
 }

 /* UL LI'S WITH NAV ID'S */
 #nav ul li {
padding-top: 0px; /* spacing between the li's */
float: none;
 }

 /* UL LINKS WITH NAV ID'S */
 #nav ul a {
white-space: nowrap; /* No text wrapping keeps links on one line*/
 }

 /* HOVERED LI'S WITH NAV ID'S (DISPLAYING DROPDOWNS) */
 #nav li:hover ul { /* Display the dropdown on hover */
left: -60px; /* Bring back on-screen when needed -60px is roughly centered */
 }

 /* HOVERED LI'S WITH NAV ID'S (TOP LINK HOVERED) */
 #nav li:hover a { /* Top link remains hovered */
background: black;
text-decoration: underline;
 }

 /* HOVERED LI'S WITH NAV ID'S (REMOVING EFFECTS) */
 #nav li:hover ul a { /* Remove effects */
text-decoration: none;
 }

 /* HOVERING OVER DROPDOWN LI'S WITH NAV ID'S */
 #nav li:hover ul li a:hover { /* What happens when you hover over a dropdown link*/
background:#000262;
 } 
```

我尝试更改 z-indexes，但没有效果。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:33:47.387

您缺少一些位置：相对声明。将它们添加到带有菜单的 div 和菜单下的 div

# meteor - exec-sync 的陨石问题

> ID：14983049
> 
> 赞同：1
> 
> 时间：2013-02-20T15:04:26.150
> 
> 标签：meteor, npm

我已经安装了 Meteor，Meteorite 和`npm`.

```
sudo npm install -g meteor
sudo npm install -g meteorite
sudo npm install -g exec-sync
mrt create myapp
mrt add router
mrt add typescript 
```

当我尝试添加一个简单的智能包时，`typescript`我遇到了麻烦。陨石似乎下载了智能包，并报告`Ok, everything's ready. Here comes Meteor!`。但这如下：

```
/home/fushunpoon/.meteorite/meteors/meteor/meteor/405cd9e86c6336bd9aaa7a8f240bb9815dceed2d/app/meteor/meteor.js:669
}).run();
   ^
Error: Cannot find module 'exec-sync'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
... 
```

（堆栈跟踪继续）。

我看到了`meteor-typescript` `README`建议人们做的建议

`sudo npm link exec-sync`

但这并不能解决问题。有什么想法有什么问题吗？

编辑：版本信息：

```
$ meteor --version
Meteor version 0.5.6 (aaa86c3e2d)

$ mrt --version
Meteorite version 0.4.7
Meteor version 0.5.6 (git checkout)

$ npm --version
1.1.62 
```

在 Ubuntu 12.04 上运行

# sql - 子查询顺序的随机浮点错误

> ID：14983054
> 
> 赞同：0
> 
> 时间：2013-02-20T15:04:35.580
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我正在运行 sql server 2008 数据库，我在 Web 应用程序中使用以下查询，但为了调试错误，我直接在管理工作室中运行查询。

我收到以下错误 - 发生了无效的浮点操作。运行此查询时。

```
select p.Id as Id,  p.CatId as CatId, p.MetaName as MetaName ,p.Active as Active,p.HasChildren as HasChildren ,p.Mlevel as Mlevel ,p.ParentId as ParentId ,p.Type as Type, p.VOrder as VOrder, p.UrlOrder as UrlOrder, Count('*') as VCount 
from MetaDataValues as m 
left join MetaData as p on m.MetaDataId = p.Id
left join Adverts as a on m.AdvertId = a.Id
where a.Status = 1
and a.ExpDate > current_timestamp and 
m.AdvertId in 
(select m2.AdvertId from MetaDataValues as m2 left join MetaData as p2 on m2.MetaDataId = p2.Id where p2.MetaName = 'meta1' 
and m.AdvertId in (select m3.AdvertId from MetaDataValues as m3 left join MetaData as p3 on m3.MetaDataId = p3.Id where p3.MetaName = 'meta2' 
and m.AdvertId in (select m4.AdvertId from MetaDataValues as m4 left join MetaData as p4 on m4.MetaDataId = p4.Id where p4.MetaName = 'meta3' 
and m.AdvertId in (select ad9.Id from Adverts as ad9 where dbo.GetDist(ad9.X,ad9.Y,ad9.Z,52.9131514,-2.9313405) < 969))))
group by p.Id, p.CatId, p.MetaName,p.Active,p.HasChildren,p.Mlevel,p.ParentId,p.Type, p.VOrder, p.UrlOrder 
```

为了解释导致问题的 GetDist 函数，如果我在子查询中将其向上移动到顶层，则查询运行正常？这不是理想的，因为构建此查询的代码是以某种方式编码的，我不想改变它。所以这是有效的查询，完全相同但顺序不同！

```
select p.Id as Id,  p.CatId as CatId, p.MetaName as MetaName ,p.Active as Active,p.HasChildren as HasChildren ,p.Mlevel as Mlevel ,p.ParentId as ParentId ,p.Type as Type, p.VOrder as VOrder, p.UrlOrder as UrlOrder, Count('*') as VCount 
from MetaDataValues as m 
left join MetaData as p on m.MetaDataId = p.Id
left join Adverts as a on m.AdvertId = a.Id
where a.Status = 1
and a.ExpDate > current_timestamp and 
m.AdvertId in 
(select m2.AdvertId from MetaDataValues as m2 left join MetaData as p2 on m2.MetaDataId = p2.Id where p2.MetaName = 'meta1' 
and m.AdvertId in (select ad9.Id from Adverts as ad9 where dbo.GetDist(ad9.X,ad9.Y,ad9.Z,52.9131514,-2.9313405) < 969)
and m.AdvertId in (select m3.AdvertId from MetaDataValues as m3 left join MetaData as p3 on m3.MetaDataId = p3.Id where p3.MetaName = 'meta2' 
and m.AdvertId in (select m4.AdvertId from MetaDataValues as m4 left join MetaData as p4 on m4.MetaDataId = p4.Id where p4.MetaName = 'meta3' )))
group by p.Id, p.CatId, p.MetaName,p.Active,p.HasChildren,p.Mlevel,p.ParentId,p.Type, p.VOrder, p.UrlOrder

GetDist code

USE [MVC]
GO
/****** Object:  UserDefinedFunction [dbo].[GetDist]    Script Date: 02/20/2013 17:05:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER FUNCTION [dbo].[GetDist] 
    (
    @xaxis float,
    @yaxis float,
    @zaxis float,
    @CenterLat float, 
    @CenterLon float
    )
RETURNS float
AS
    BEGIN

declare @CntXAxis float
declare @CntYAxis float
declare @CntZAxis float
declare @EarthRadius float 

set @EarthRadius = 3961
set @CntXAxis = cos(radians(@CenterLat)) * cos(radians(@CenterLon))
set @CntYAxis = cos(radians(@CenterLat)) * sin(radians(@CenterLon))
set @CntZAxis = sin(radians(@CenterLat))

return (@EarthRadius * acos( @XAxis*@CntXAxis + @YAxis*@CntYAxis + @ZAxis*@CntZAxis))

    END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:48:21.683

看起来 GetDist 可能正在计算一对纬度/经度值之间的距离。我有很多这方面的经验。像这样的大多数 GetDist 函数都使用反余弦函数“ACos”。此函数的参数限制在 -1 到 1 的范围内。如果您尝试传递此范围之外的值，您将在 SQL Server 中收到域错误。如果您的 GetDist 函数使用 CLR 函数，则错误将出现在您的 .net 代码中，并且消息会略有不同。

处理浮点数时，您必须注意奇怪的舍入问题。例如，如果您的计算将返回一个值 1.00000000000001，并且您将其传递给 ACos 函数，您将得到一个错误。

这里有很多猜测，我可能完全没有根据，但请考虑一下并花几分钟时间做一些研究。

根据您上面发布的 GetDist 函数，我建议进行一个相对较小的更改：

```
ALTER FUNCTION [dbo].[GetDist] 
    (
    @xaxis float,
    @yaxis float,
    @zaxis float,
    @CenterLat float, 
    @CenterLon float
    )
RETURNS float
AS
    BEGIN

declare @CntXAxis float
declare @CntYAxis float
declare @CntZAxis float
declare @EarthRadius float 
declare @Temp float

set @EarthRadius = 3961
set @CntXAxis = cos(radians(@CenterLat)) * cos(radians(@CenterLon))
set @CntYAxis = cos(radians(@CenterLat)) * sin(radians(@CenterLon))
set @CntZAxis = sin(radians(@CenterLat))

Set @Temp = @XAxis*@CntXAxis + @YAxis*@CntYAxis + @ZAxis*@CntZAxis
If @Temp > 1
    Set @Temp = 1
Else If @Temp < -1
    Set @Temp = -1

return (@EarthRadius * acos(@Temp))

    END 
```

即使这不能解决您最初的问题，它至少可以保护您免受奇怪的浮点/精度问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:27:34.207

问题是无效操作还是更像“将数据类型 varchar 转换为数字时出错”？当数值数据被存储为字符串时，这是一个相当普遍的问题。当字符串看起来正确时它可以工作，但在其他时候会失败。

的所有参数`getDist()`都是正确的类型吗？返回值是数字吗？

我猜想更高级别的过滤会过滤掉导致问题的错误值。

# c# - 无法在数据绑定（gridview）中将类型“字符串”隐式转换为“布尔”

> ID：14983057
> 
> 赞同：1
> 
> 时间：2013-02-20T15:04:55.477
> 
> 标签：c#, casting

这是 String 分配给布尔属性的行：

```
chkreputative.Checked = gvmanufacturers.DataKeys[rowindex]["IsReputative"].ToString(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:11:17.857

摆脱`ToString()`电话，并应用正确的演员表。您正在尝试将值分配给`String`一个`Boolean`值，这就是您得到异常的原因。

根据`DataKeys`对象的类型，您可以尝试以下一些方法：

```
chkreputative.Checked = (bool)gvmanufacturers.DataKeys[rowindex]["IsReputative"];

chkreputative.Checked = Boolean.Parse(gvmanufacturers.DataKeys[rowindex]["IsReputative"]);

chkreputative.Checked = Convert.ToBoolean(gvmanufacturers.DataKeys[rowindex]["IsReputative"]); 
```

# syntax - umbraco lucene 语法为 not

> ID：14983065
> 
> 赞同：0
> 
> 时间：2013-02-20T15:05:16.483
> 
> 标签：syntax, lucene, umbraco

我正在尝试编写一个 lucene 查询来检索我网站中的一些页面，所以我有以下内容：

```
string.Format("nodeName: ({0})^7 bodyText: ({0})^6", _searchTerm) 
```

这意味着它将搜索包含变量的`nodeName`或`bodyText`包含`_searchTerm`变量的内容

我苦苦挣扎的地方是我也希望它不包含任何`hideInNav`设置了标志的结果，`1`所以我尝试了：

```
string.Format("nodeName: ({0})^7 bodyText: ({0})^6 +hideInNav: NOT(1)", _searchTerm) 
```

但是，这会引发以下错误：

```
Encountered " <NOT> "NOT "" at line 1, column 140.
Was expecting one of:
   "(" ...
   "*" ...
   <QUOTED> ...
   <TERM> ...
   <PREFIXTERM> ...
   <WILDTERM> ...
   "[" ...
   "{" ...
   <NUMBER> ... 
```

据我所知，查询`(`在 NOT 之后确实有一个，所以我很难知道这是在哪里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:49:21.757

试试这个查询：

```
string.Format("nodeName: ({0})^7 bodyText: ({0})^6 !hideInNav: (1)", _searchTerm) 
```

感叹号也可以改为NOT：

```
string.Format("nodeName: ({0})^7 bodyText: ({0})^6 NOT hideInNav: (1)", _searchTerm) 
```

有关Lucene 查询语法的概述，请参阅[此页面（它不是当前版本，但我怀疑它改变了很多）](http://lucene.apache.org/core/3_6_2/queryparsersyntax.html)

编辑：也许逆转你 hideInNave 语句将修复它：

string.Format("nodeName: ({0})^7 bodyText: ({0})^6 +hideInNav: (0)", _searchTerm) 检查是否为零或检查是否为零。

您可能还想下载[Luke](http://code.google.com/p/luke/)以检查索引的内容并查看值是如何保存的。

# sql - 将 nvarchar 数据类型转换为 datetime 数据类型导致值超出范围 - 闰年

> ID：14983066
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:05:21.387
> 
> 标签：sql

我在存储过程代码中收到此错误，我发现其中一条记录来自闰年日期 2008 年 2 月 29 日。我如何使用我拥有的代码解决这个问题。这是代码：

```
set @ContractDate = cast(cast(@Year as nvarchar(4))
+ '/' + cast(datepart(mm,@ContractDate) as nvarchar(2))
+ '/' + cast(datepart(dd,@ContractDate) as nvarchar(2)) as datetime) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:21:16.680

首先：

*   你对@Year 和@ContractDate 有什么价值？
*   @ContractDate 是什么格式/类型？

我问是因为这在`us_english`SQL Server 2012上对我有用

```
SELECT cast('2008/02/29' as datetime) 
```

但是，如果我改变，`SET DATEFORMAT`那么我可以打破上面的代码

```
-- breaks
SET DATEFORMAT DMY;
SELECT cast('2008/02/29' as datetime) 
```

*无论*我使用什么 SET DATEFORMAT都可以使用 ISO 日期格式

```
SET DATEFORMAT DMY;
SELECT cast('20080229' as datetime);
SET DATEFORMAT MDY;
SELECT cast('20080229' as datetime);
SET DATEFORMAT YDM;
SELECT cast('20080229' as datetime); 
```

结论：您使用的是非 ISO 日期格式并依赖于隐式转换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:23:12.373

最好`yyyymmdd`在转换为日期时间/日期之前以 ISO 格式 () 获取字符串，并且无论文化设置如何，它都可以在任何服务器上工作

如果`@ContractDate`是一种*`datetime/date`*类型并且`@year`就像*`2012/'2012'`*然后下面应该工作。[**工作示例**](http://sqlfiddle.com/#!3/d41d8/9234)

```
Set @ContractDate = convert(datetime,
  convert(varchar(4),@year) + right(convert(varchar(8),@ContractDate,112),4)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T11:19:51.423

```
ALTER PROCEDURE [dbo].[Sden_report1]
@fromdt nvarchar(13),
@todt nvarchar(13)

AS

BEGIN 
select AD_PID,AD_Appointmentdate,AD_Patientname,AD_Patientphno,AD_Visitpurpose
from Appointment_Details1
where 
--PL_CID = @CID and PL_Itemcode = @JCode AND
(@fromdt = '' OR (DATEDIFF(DAY,AD_Appointmentdate, @fromdt) <= 0))
AND (@todt = '' OR (DATEDIFF(DAY,AD_Appointmentdate, @todt) >= 0))
end

GO

When i Execute the procedure
i will get below error:

EXEC Sden_report1 '20-11-2012','20-05-2013'

Error
The conversion of a nvarchar data type to a datetime data type resulted in an out-of-range value.

Anyone Help...`enter code here` 
```

# c# - 解析文本文件

> ID：14983067
> 
> 赞同：-4
> 
> 时间：2013-02-20T15:05:23.507
> 
> 标签：c#, string

首先，这不是一个巨魔问题，我真的很想为此找到解决方案，所以请尝试帮助我。

好吧，我有一个包含很多数字的字符串，它采用以下格式

```
[Block1]
Item1
Item2
Item3

[Block2]
Item1
Item2
Item3

...SO ON 
```

好吧，我尝试了很多没有运气的事情

```
string.IndexOf
StreamReader 
```

我想要实现的是搜索 [Block1] 并在数组中返回它下面的值。

我希望我已经清楚地解释了我想要实现的目标，并提前感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:22:28.733

这有点太简单了，所以我决定把它做成一个单行字来增加乐趣（为了可读性而格式化）：

```
IEnumerable<string> text = File.ReadAllLines(@"Path\To\File")
                               .SkipWhile(line => line != "[Block1]")
                               .Skip(1)
                               .TakeWhile(line => line != "[Block2]"); 
```

当然，您必须替换文本文件的路径。

如果它不在文件中而是在多行字符串中，则可以替换

`File.ReadAllLines(@"Path\To\File")`和`myString.Split('\n')`

# sql - 无法执行存储过程

> ID：14983068
> 
> 赞同：4
> 
> 时间：2013-02-20T15:05:25.303
> 
> 标签：sql, sql-server, database, stored-procedures, sql-server-express

我创建了一个存储过程，可以在存储过程节点下看到它，但是在尝试执行时找不到该过程。

在存储过程节点下，它被称为 dbo.CopyTable

```
exec CopyTable 
```

CopyTable 未定义为红色，表示它不存在。为什么？

即使我右键单击该过程并说脚本存储过程作为执行对象 - 它生成的代码也带有红色下划线并且也找不到存储过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:07:29.563

确保选择的数据库包含存储过程`CopyTable`

```
USE YourDatabase
EXEC CopyTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T22:28:59.353

尝试运行您的 CREATE PROCEDURE。突出显示它，f5 它，然后确保它在您在其他地方调用它之前运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:06:03.663

尝试添加`dbo`并选择正确的数据库，

```
USE databaseName
GO

EXEC dbo.CopyTable
GO 
```

*   [执行存储过程](http://msdn.microsoft.com/en-us/library/ms188332.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:11:47.243

很可能您只是在查询窗口中的错误数据库中，您可以像这样指定数据库：

```
EXEC [yourDBName].dbo.CopyTable 
```

阅读如何[执行存储过程](http://msdn.microsoft.com/en-us/library/ms189915.aspx)

考虑到您更新的问题：

> 即使我右键单击该过程并说脚本存储过程作为执行对象 - 它生成的代码也带有红色下划线并且也找不到存储过程。

如果您的存储过程无效，则可能会发生这种情况。请仔细检查 SPROC 的有效性并确保它引用的表存在等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-10T09:57:15.840

也许在您的程序中您不小心剪切粘贴了您的脚本名称 (dbo.CopyTable)，比如...

```
SELECT * FROM dbo.CopyTable
WHERE ClientId = @ClientId
RETURN 
```

然后，当您调用您的 proc 时，您会得到“无效的对象名称 dbo.CopyTable”，并假设 sql 无法找到存储的 proc ......这不是问题，它找到并运行 proc 但它实际上是一个问题过程。

# wcf - 绑定验证失败

> ID：14983075
> 
> 赞同：0
> 
> 时间：2013-02-20T15:05:36.833
> 
> 标签：wcf, msmq

我有一个非常简单的 WCF 程序，可以将数据写入 MSMQ，但出现此错误

```
Binding validation failed because the binding's MsmqAuthenticationMode property is set to WindowsDomain but MSMQ is installed with Active Directory integration disabled. The channel factory or service host cannot be opened. 
```

我正在使用的配置文件是这个

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <bindings>
      <netMsmqBinding>
        <binding name="MsmqBindingNonTransactionalNoSecurity" exactlyOnce="false">
          <security mode="None"/>
        </binding>
        <binding name="MsmqBindingNonTransactionalTransportSecurity" exactlyOnce="false">
          <security mode="Transport"/>
        </binding>
        <binding name="MsmqBindingTransactionalTransportSecurity" exactlyOnce="true">
          <security mode="Transport"/>
        </binding>
      </netMsmqBinding>
    </bindings>
    <client>
      <endpoint name="MsmqService"
                address="net.msmq://localhost/private/MsmqService/MsmqService.svc"
                binding="netMsmqBinding" bindingConfiguration="MsmqBindingTransactionalTransportSecurity"
                contract="MsmqContract.IMsmqContract" />
    </client>
  </system.serviceModel>
</configuration> 
```

知道有什么问题吗？

# sql-server - Searching for a string in all tables of database in SQL Server 2000

> ID：14983082
> 
> 赞同：1
> 
> 时间：2013-02-20T15:05:53.183
> 
> 标签：sql-server, sql-server-2000

There are many answers in many places about this question, such as:

[Search for a string in all tables, rows and columns of a DB](https://stackoverflow.com/questions/591853/search-for-a-string-in-an-all-the-tables-rows-and-columns-of-a-db)

However I am using SQL Server 2000 and need to do the same thing: search all tables in a database for a specific string.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:43:15.567

```
DECLARE @SearchString VARCHAR(32);
SET @SearchString = 'Something';

CREATE TABLE #results(o NVARCHAR(512), c SYSNAME, value NVARCHAR(4000));

DECLARE @sql NVARCHAR(4000), @o NVARCHAR(512), @c SYSNAME;

DECLARE c CURSOR LOCAL FAST_FORWARD FOR 
   SELECT QUOTENAME(u.name) + '.' + QUOTENAME(o.name), QUOTENAME(c.name)
FROM sysobjects AS o
INNER JOIN syscolumns AS c ON o.id = c.id
INNER JOIN sysusers AS u ON o.uid = u.uid
WHERE c.xtype IN (35, 99, 167, 175, 231, 239) AND o.xtype = 'U';

OPEN c;

FETCH c INTO @o, @c;

WHILE @@FETCH_STATUS = 0
BEGIN
  SET @sql = N'INSERT #Results(o,c,value) SELECT @o, @c, 
    CONVERT(NVARCHAR(4000), ' + @c + ') FROM ' + @o + ' WHERE ' 
    + @c + ' LIKE ''%' + @SearchString + '%'';';
  EXEC sp_executesql @sql, N'@o NVARCHAR(512), @c SYSNAME', @o, @c;
  FETCH c INTO @o, @c;
END

CLOSE c;
DEALLOCATE c;

SELECT o, c, value FROM #Results;

DROP TABLE #Results; 
```

# java - 构造函数中的多个参数

> ID：14983085
> 
> 赞同：2
> 
> 时间：2013-02-20T15:05:55.927
> 
> 标签：java, class-constructors

我把下面的构造函数放在一起。我的一个问题是：我如何使用相同的构造函数没有参数并且同时使用两个或三个？有不止一种方法可以做到这一点吗？谢谢

```
public class bankaccount {

  String firstnameString;
  String lastnameString;
  int accountnumber;
  double accountbalance;;

  public bankaccount(String firstname,String lastname){
    int accountnumber=999999;
    double accountbalance=0.0;
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:08:03.043

您需要实现所有要使用的变体。然后，您可以使用`this()`在构造函数之间调用，以避免代码冗余：

```
public class BankAccount {

  public BankAccount(){
     this("", "");
     // or this(null, null);
  }

  public BankAccount(String firstname){
     this(firstname, "");
     // or this(firstname, null);
  }

  public BankAccount(String firstname, String lastname){
      // implement the actual code here
  }
} 
```

顺便说一句，您应该查看[Java 编码约定](http://www.oracle.com/technetwork/java/codeconv-138413.html)-[类名](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)（以及因此构造函数）以驼峰式命名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:09:19.543

如果您没有实现任何构造函数，则会为您提供无参数构造函数。如果你想拥有多个构造函数，你需要自己实现所有的构造函数。

```
public class bankaccount {

  String firstnameString;
  String lastnameString;
  int accountnumber;
  double accountbalance;;

  public bankaccount(String firstname,String lastname){
    int accountnumber=999999;
    double accountbalance=0.0;
  }

  public bankaccount(){
    // put code here, or call this(null,null) / a different constructor
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:13:56.153

其他人建议您创建多个构造函数，这很好。但是，在某些情况下，您可能更喜欢只有零参数的构造函数并使用 getter 和 setter 来访问属性。

您的`BankAccount`班级可能是这些情况之一。它看起来像一个数据对象，是通过使用一些 ORM（例如 Hibernate）持久化到 DBMS 中的对象之一。Hibernate 不需要多参数构造函数，它会调用零参数构造函数并通过 getter 和 setter 访问属性。

这堂课是干什么用的？它是映射到对象的数据库实体吗？你真的需要所有这些构造函数吗（这可能是浪费时间）？

从理论上讲，我的建议可以被认为是与 OO 设计的良好实践的斗争，但实践与理论有些不同。如果您的类只携带一些数据并且您的构造函数不检查所提供参数的有效性，那么您可以只列出属性并使用 IDE 的工具来创建 getter 和 setter。

# c# - 为什么 bytes.length = 0？

> ID：14983091
> 
> 赞同：1
> 
> 时间：2013-02-20T15:06:06.693
> 
> 标签：c#, asp.net, binary, webforms

我不确定如何调试它。我正在尝试将文件上传到我的数据库中（通过将二进制文件内容读入我的存储过程）。我将输入流传递给我的方法，如下所示：

```
LoadFile(gAttachmentContentID, file.InputStream, trn); 
```

这是我的方法：

```
 public static void LoadFile(Guid gAttachmentContentID, Stream stm, IDbTransaction trn)
            {
                const int BUFFER_LENGTH = 40 * 1024;
                byte[] binFILE_POINTER = new byte[32];
                //Testing check out check in
                // 01/20/2006 Paul.  Must include in transaction
                SqlProcs.spATTACHMENTS_CONTENT_InitPointer(gAttachmentContentID, ref binFILE_POINTER, trn);

                using (BinaryReader reader = new BinaryReader(stm))
                {
                    int nFILE_OFFSET = 0;
                    byte[] binBYTES = reader.ReadBytes(BUFFER_LENGTH);
                    Debug.Print("binBYTES=" + binBYTES.Length.ToString());
                    while (binBYTES.Length > 0)
                    {
                        // 08/14/2005 Paul.  gID is used by Oracle, binFILE_POINTER is used by SQL Server. 
                        // 01/20/2006 Paul.  Must include in transaction
                        SqlProcs.spATTACHMENTS_CONTENT_WriteOffset(gAttachmentContentID, binFILE_POINTER, nFILE_OFFSET, binBYTES, trn);
                        nFILE_OFFSET += binBYTES.Length;
                        binBYTES = reader.ReadBytes(BUFFER_LENGTH);
                    }
                }
            } 
```

**为什么`binBYTES.length = 0`呢？我怎样才能调试这种类型的东西？**

**编辑：**

我现在正在使用这个功能：

```
 public static void LoadFile2(Guid gAttachmentContentID, Stream stm, IDbTransaction trn)
    {

        stm.Position = 0;
        byte[] binFILE_POINTER = new byte[32];

        // Now read s into a byte buffer. 
        byte[] bytes = new byte[stm.Length];
        int numBytesToRead = (int)stm.Length;
        int numBytesRead = 0;
        while (numBytesToRead > 0)
        {
            // Read may return anything from 0 to 10\. 
            int n = stm.Read(bytes, numBytesRead, 10);
            // The end of the file is reached. 
            if (n == 0)
            {
                break;
            }
            numBytesRead += n;
            numBytesToRead -= n;

        }
        stm.Close();
        SqlProcs.spATTACHMENTS_CONTENT_WriteOffset(gAttachmentContentID, binFILE_POINTER, 0, bytes, trn);
        // numBytesToRead should be 0 now, and numBytesRead should 
        // equal 100.
        Console.WriteLine("number of bytes read: {0:d}", numBytesRead);

    } 
```

使用此程序：

```
public static void spATTACHMENTS_CONTENT_WriteOffset(Guid gID, byte[] binFILE_POINTER, Int32 nFILE_OFFSET, byte[] byBYTES, IDbTransaction trn)
        {
            IDbConnection con = trn.Connection;
            using ( IDbCommand cmd = con.CreateCommand() )
            {
                cmd.Transaction = trn;
                cmd.CommandType = CommandType.StoredProcedure;
                if ( Sql.IsOracle(cmd) )
                    cmd.CommandText = "spATTACHMENTS_CONTENT_WriteOff";
                else
                    cmd.CommandText = "spATTACHMENTS_CONTENT_WriteOffset";
                IDbDataParameter parID               = Sql.AddParameter(cmd, "@ID"              , gID                );
                IDbDataParameter parFILE_POINTER     = Sql.AddParameter(cmd, "@FILE_POINTER"    , binFILE_POINTER    );
                IDbDataParameter parMODIFIED_USER_ID = Sql.AddParameter(cmd, "@MODIFIED_USER_ID",  Security.USER_ID  );
                IDbDataParameter parFILE_OFFSET      = Sql.AddParameter(cmd, "@FILE_OFFSET"     , nFILE_OFFSET       );
                IDbDataParameter parBYTES            = Sql.AddParameter(cmd, "@BYTES"           , byBYTES            );
                cmd.ExecuteNonQuery();
            }
        } 
```

但我收到以下错误：

```
Invalid text, ntext, or image pointer value 0x00000000000000000000000000000000. 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:08:37.580

它表明您已经到达流的末尾。从[文档](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readbytes.aspx)中：

> 当从 ReadBytes 返回的 Byte 数组的长度为零时，检测到正在读取的文件的结尾。

就我个人而言，我根本不会在`BinaryReader`这里创建一个：我会创建一个可以重用的*单*`Stream.Read`字节数组，然后重复调用（并将数据复制出来）直到返回 0 表示它已经到达流的末尾.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:48:56.970

我添加了这段代码，现在它工作正常：

IDbConnection con = trn.Connection; 使用 (IDbCommand cmd = con.CreateCommand()) { cmd.Transaction = trn;

```
 cmd.CommandText = "UPDATE ATTACHMENTS_CONTENT SET ATTACHMENT = @BYTES Where ID=@ID";

            // 2\. define parameters used in command object
            SqlParameter param = new SqlParameter();
            param.ParameterName = "@BYTES";
            param.Value = bytes;
            cmd.Parameters.Add(param);

            // 2\. define parameters used in command object
            SqlParameter param2 = new SqlParameter();
            param2.ParameterName = "@ID";
            param2.Value = gAttachmentContentID;
            cmd.Parameters.Add(param2);

            cmd.ExecuteNonQuery();
        } 
```

# xcode - Mac Pro 10.6.7 Snow Leopard 的最新 xcode 是什么？

> ID：14983094
> 
> 赞同：2
> 
> 时间：2013-02-20T15:06:19.030
> 
> 标签：xcode, osx-snow-leopard

全部，

我注意到最新的 xcode 是 4.6，但不知何故它不会安装在我的旧 Mac Pro 10.6.7 Snow Leopard 上。我想知道我怎样才能让它工作？我需要升级我的 Mac OS 吗？或者我可以在 Mac Pro 上运行的最新 xcode 版本是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:10:57.040

您可以在 10.6 上运行的最新版本是 Xcode 4.2。如果您更新到 10.7 或 10.8，您可以运行 Xcode 4.6。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:28:36.437

如果您打算将操作系统留在 10.6.7 Snow leopard 上，那么您可以运行的最新 Xcode 是 4.2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:08:56.623

为 XCode4.6 升级您的 Mac OS

或者

使用 XCode 3.2，这将像一个魅力。

# ios - 如何在 AS3 中运行 Main() 的另一个实例

> ID：14983108
> 
> 赞同：0
> 
> 时间：2013-02-20T15:06:50.647
> 
> 标签：ios, actionscript-3, air, instance, main

您将如何在 AS3 中运行 Main 函数的新实例？基本上我希望程序从一开始就重新运行，一旦它到达程序的末尾。我想过最后从树上删除我所有的孩子，然后再次运行第一种方法，但这似乎没有必要而且很混乱。该类扩展了 Sprite。

编辑：尝试创建一个自定义事件并使用`dispatchEvent`在程序结束时触发它，但有一点问题。这是我下面的当前代码。

整个 RunMain.as：

```
package  
{
    import flash.display.Sprite;
    import flash.events.Event;

    public class RunMain extends Sprite {

        public function RunMain():void {

            addEventListener(Event.ENTER_FRAME, loop);
        }

        private function loop(event:Event){

            removeEventListener(Event.ENTER_FRAME, loop);
            dispatchEvent(new EndEvent(EndEvent.END_EVENT));
        }

    }
} 
```

整个 EndEvent.as：

```
package  
{
    import flash.events.Event;

    public class EndEvent extends Event 
    {
        // Event types.
        public static const END_EVENT:String = "event1";

        public function EndEvent(type:String = EndEvent.END_EVENT) 
        {
            super(type);
        }

        override public function clone():Event {
            // Return a new instance of this event with the same parameters.
            return new EndEvent(type);
        }
    }
} 
```

Main.as 的部分内容：

```
public function Main() {
    runMain = new RunMain();
    runMain.addEventListener(EndEvent.END_EVENT, onProgramFinish);
    addChild(runMain);

    init();
    otherMethods();
}

public function onProgramFinish() {
    removeChild(runMain);

    runMain = null;

    runMain = new RunMain() ;
} 
```

在我的 Main 类中，我`onProgramFinish();`在程序末尾有一行。

目前，当我运行编译器时出现错误：
ArgumentError：错误 #1063：Main/onProgramFinish() 上的参数计数不匹配。
预期为 0，得到 1。

当我选择继续时，程序运行良好，但它不会在它结束时运行新实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:18:44.123

事实上，您必须创建一个特殊的类容器并在主类中准确地交换他（创建新的或删除）。这个游戏类可以`dispatch events`，至少精灵可以调度事件。创建您的自定义事件并将它们传递给越来越高的级别将允许您在 Main 类中执行操作。

```
class Main extends Sprite {
  public var game:Game ;
  public function Main():void {
    game = new Game(new Player(), "asd") ;
    game.addEventListener(GameEvent.GAME_OVER, onGameOver) ;
    addChild(game) ;
  }

  public function onGameOver(){
    removeChild(game) ;
    //also you can try removing heavy children of game
    game = null ; //Let garbage collector know about object without reference.

    game = new Game(new Player(), "example") ;
  }
}

public class Game extends Sprite {

  public var hero:Hero = new Hero() ;
  public function Game(player:Player, name:String):void {

    addEventListener(Event.ENTER_FRAME, loop) ;
  }

  private function loop(event:Event){
    if (hero.hp == 0){
      removeEventListener(Event.ENTER_FRAME, loop) ;
      dispatchEvent(new GameEvent(GameEvent.GAME_OVER)) ;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:34:07.423

您的活动：

```
package {
    import flash.events.Event;

public class ProgramEvent extends Event 
{

    public static const FINISH:String = "Finished" ;

    public function ProgramEvent(type:String, bubbles:Boolean=false, cancelable:Boolean=false) 
    { 
        super(type, bubbles, cancelable);

    } 

    public override function clone():Event 
    { 
        return new ProgramEvent(type, bubbles, cancelable);
    } 

    public override function toString():String 
    { 
        return formatToString("ProgramEvent", "type", "bubbles", "cancelable", "eventPhase"); 
    }

}

} 
```

运行主：

```
package  
{
    import flash.display.Sprite;
    import flash.events.Event;

    public class RunMain extends Sprite {

        public function RunMain():void {

            addEventListener(Event.ENTER_FRAME, loop);
        }

        private function loop(event:Event){

            removeEventListener(Event.ENTER_FRAME, loop);
            dispatchEvent(new ProgramEvent(ProgramEvent.FINISH));
        }

    }
} 
```

主要：

```
public function Main() {
    startProgram() ;

    init();
    otherMethods();
}

public function onProgramFinish(event:ProgramEvent) {
    runMain.removeEventListener(ProgramEvent.FINISH, onProgramFinish) ;
    removeChild(runMain);
    runMain = null;
    startProgram() ;
}

public function startProgram(){
  runMain = new RunMain() ;
  runMain.addEventListener(ProgramEvent.FINISH, onProgramFinish);
  addChild(runMain);
} 
```

# javascript - 如何检查数组是否包含指定项？

> ID：14983111
> 
> 赞同：1
> 
> 时间：2013-02-20T15:07:00.790
> 
> 标签：javascript, jquery

我在我的应用程序中使用 jQuery，并且我有一个包含字符串项的数组：

`var array = ["item","item1","item2","item3"]`

我如何测试数组是否包含“项目”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T15:07:25.647

您可以使用`array.indexOf("item")`-`-1`如果未找到该项目或找到该项目的索引，则返回。

请注意，旧版本的 IE 不支持此功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T15:07:41.583

```
if ($.inArray("item", array) > -1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:14:02.520

### Javascript

现代浏览器有 Array#indexOf，它就是这样做的；这是在 ECMAScript v5 版本规范中，但它已经在多个浏览器中使用了多年。使用该页面底部“兼容性”部分中列出的代码可以支持较旧的浏览器。

```
if(array.indexOf("item") > -1){
    //doSomething
} 
```

### jQuery

jQuery为此提供了一个[实用函数](http://docs.jquery.com/Utilities/jQuery.inArray)：

```
if($.inArray(value, array)){
    //doSomething
} 
```

它返回数组中值的索引。如果数组不包含该值，则返回 -1。

### 重复？

*   [查找项目是否在 JavaScript 数组中的最佳方法？](https://stackoverflow.com/questions/143847/best-way-to-find-an-item-in-a-javascript-array)
*   [如何检查数组是否包含 JavaScript 中的对象？](https://stackoverflow.com/questions/237104/array-containsobj-in-javascript)

# javascript - 动态创建网点

> ID：14983112
> 
> 赞同：4
> 
> 时间：2013-02-20T15:07:03.273
> 
> 标签：javascript, ember.js

假设我有一个具有两条路由的应用程序：“/services”和“/services/:service”。

当用户访问 :service 状态时，我希望他看到与一项特定服务有关的信息列表。到目前为止，微不足道。

但是，当同一个用户访问 /services 时，我想显示一个服务列表，*以及*每个服务的信息（对于每个服务）。我也想在没有任何模板重复的情况下做到这一点。

显而易见的答案似乎是网点，但看起来所有网点都必须静态命名，而且我有一个以前未确定的数量。它们都有唯一的名称，但我当然不能硬编码模板中的名称。我想动态确定插座名称，所以我可以在 renderTemplate 中适当地调用 this.render 来填充它们，但我不知道该怎么做。

你有什么建议？

更新：看来我可以使用 {{template}} 处理我的特殊情况，但这并不能连接另一条路线。我仍然想知道如何做到这一点；稍后我会做更复杂的事情，这肯定会更好，并且在各自的控制器中仍然存在重复的代码。

更新：我最终组成了自己的“dynOutlet”助手，如下所示：

```
// Define "dynamic outlets". These are just like normal outlets,
// except they dereference the outlet name.
Handlebars.registerHelper('dynOutlet', function(property, options) {
  Ember.assert("Syntax: {{dynOutlet <property>}}", arguments.length === 2);
  var context = (options.contexts && options.contexts[0]) || this,
      normalized = Ember.Handlebars.normalizePath(
        context, property, options.data),
      pathRoot = normalized.root,
      path = normalized.path,
      value = (path === 'this') ? pathRoot : Ember.Handlebars.get(
        pathRoot, path, options);
  return Ember.Handlebars.helpers.outlet(value, options);
}); 
```

不过，我还没有弄清楚它是否会按我想要的方式工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:15:55.323

我还需要定义动态的 Outlets。这是我实现的助手：

```
Ember.Handlebars.registerHelper('dynamicOutlet', function(property, options) {
    var outletSource;

    if (property && property.data && property.data.isRenderData) {
      options = property;
      property = 'main';
    }

    outletSource = options.data.view;
    while (!(outletSource.get('template.isTop'))){
      outletSource = outletSource.get('_parentView');
    }

    options.data.view.set('outletSource', outletSource);

    var firstContext = options.contexts.objectAt(0);

    options.hash.currentViewBinding = '_view.outletSource._outlets.' + firstContext.get(property);

    var controller = App.__container__.lookup("controller:movies");
    options.contexts.clear();
    options.contexts.addObject(controller);
    return Ember.Handlebars.helpers.view.call(controller, Ember.Handlebars.OutletView, options);
}); 
```

这是我在模板中使用它的方式：

```
<div>
  {{title}} <!-- accessing title property of context -->
  {{dynamicOutlet outletName}} <!-- accessing the property that should be used as name of the outlet -->
</div> 
```

帮助器可以使用模型的属性作为出口名称。

# ios - 将 RSS 数据存储在 NSDictionary 中

> ID：14983116
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:07:10.107
> 
> 标签：ios, uitableview, nsdictionary, nsmutabledictionary

我在一个项目中工作，您可以在其中显示 RSS 提要`UITableView`。当点击它时，它将被转发到`UIViewController`( `detailView`)。我的问题是我对 NSDictionary 不是很熟悉。我一直在阅读它，但没有正确理解它。

我的字典的一些信息：

```
[@"name"]
[@"title"]
[@"link"]
[@"pubDate"]
[@"description"] 
```

我在我的单元格中使用该样式`Subtitle`。我不知道这是否相关，但描述中有大约 4000 的迹象。这是一个问题吗？

这是我要存储的信息。

编辑：为了减少误解，所以我在这里再次发布代码

```
 Parser *parser = [[Parser alloc] initWithContentsOfURL:url];
    parser.rowElementName = @"item";
    parser.elementNames = @[@"title", @"link", @"pubDate", @"description"];
//    parser.attributeNames = @[@"img src="];
    [parser parse]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:28:32.300

在这里看看[这个问题](https://stackoverflow.com/questions/1760371/how-can-we-store-into-an-nsdictionary-what-is-the-difference-between-nsdictiona)。如果您真的只是在寻找一个简短而快速的 NSDictionary 用法示例，那听起来就像您想要的那样。

为了将来参考，发布一些您尝试过的示例并查看 NSDictionary 类参考，它们总是很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:48:57.413

为字典中的内容设置值：

```
NSDictionary *myDictionary;
[myDictionary setObject:@"GeneralMike" forKey:"name"];
[myDictionary setObject:@"Most Awesome Master of Everything" forKey:"title"]; 
```

要取回值：

```
myNameLabel.text = [myDictionary objectForKey:@"name"];
myTitleLabel.text = [myDictionary objectForKey:@"title"]; 
```

在这里，我将字符串放入标签中，您实际分配它们的内容取决于对象的类型以及您要执行的操作。关键是要确保你把任何东西放进去或者以某种方式使用它。

# php - mysql DELETE 适用于 phpmyadmin 但不适用于 php 脚本

> ID：14983118
> 
> 赞同：0
> 
> 时间：2013-02-20T15:07:13.287
> 
> 标签：php, mysql

基本上正如我的问题所述，它适用于 phpmyadmin 但不适用于 php 本身。当我运行脚本时，它返回 true，并且不会死。帮助！

这是查询：

```
DELETE FROM selections WHERE selectorID = '$userID' AND selectedID = '$ID' 
```

这是php脚本：

```
<?php

include_once "connect_to_mysql.php";

$errorB = false;

$error = '';
$id = '';
$userID = '';
if (empty($_GET['ID']) || empty($_GET['userID'])) {
$errorB = true;

if (empty($_GET['ID'])) {
    $error = $error.'-No selected ID was sent';

}

if (empty($_GET['userID'])) {
    $error = $error.'-No selector ID was sent';

}

} else {
$id = $_GET['ID'];
$userID = $_GET['userID'];
echo $id.$userID;
$sqlInsert = mysql_query("DELETE FROM selections WHERE selectorID = '$userID' AND selectedID = '$ID'") or die (mysql_error());
echo 'shz';
}

if ($errorB) {
echo $error;

}

?> 
```

我的数据库如下所示：

```
 id|selectorID|selectedID
 3  1          4
 4  1          5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:09:29.607

您的第一个但较小的麻烦是[PHP 变量的区分大小写的性质](http://php.net/manual/en/language.variables.basics.php)：

这里

```
$sqlInsert = mysql_query("DELETE FROM selections WHERE selectorID = '$userID' AND selectedID = '$ID'") or die (mysql_error()); 
```

你指的是`$ID`，但只有`$id`：

```
$id = $_GET['ID']; 
```

正确：

```
$sqlInsert = mysql_query("DELETE FROM selections WHERE selectorID = '$userID' AND selectedID = '$id'") or die (mysql_error()); 
```

**重要的提示**

**虽然这很可能会起作用，但这很容易发生[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)！改用 PDO，或者至少，[逃避](http://php.net/manual/en/function.mysql-real-escape-string.php)你的价值观！！！**

# javascript - 全局变量保持为空

> ID：14983121
> 
> 赞同：0
> 
> 时间：2013-02-20T15:07:16.813
> 
> 标签：javascript

我有一段 javascript 代码，我通过 ajax 调用检索员工列表。

```
var employees_json = '';

Ajax.callbackAsync('getEmployees', ['2627016'],
    function(response){
        employees_json = response;

        console.log('this: '+ employees_json);
    },
    function(error){
        alert('Error while retrieving employees: '+ error);
    }
);

console.log('that: '+ employees_json); 
```

（2627016 是 branch_id）

控制台上的输出：

```
this: [object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]
that: 
```

为什么employees_json 在ajax 调用之外是空的？
还是我做了一个我看不到的类型！？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:14:01.880

您的 console.log 在 function(response) 之前执行。

日志不就是这样吗？: that: this: [object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object],[object Object], [对象对象],[对象对象],[对象对象]

javascript 是 1 个线程，但你永远不知道回调函数何时运行。所以你必须调整你的代码。

# android - 我想为动态生成的edittexts实现textwatcher，并希望在这些edittexts中获取文本

> ID：14983122
> 
> 赞同：0
> 
> 时间：2013-02-20T15:07:16.723
> 
> 标签：android, android-edittext, textwatcher

```
protected void updateTable() {
    // TODO Auto-generated method stub

    final TableLayout tl = (TableLayout) findViewById(R.id.settingtable);
    tl.removeAllViews();

    for(int i=0; i<10; i++) {

        final TableRow tablerow = new TableRow(this);
        tablerow.setLayoutParams(new LayoutParams(
                LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));

        final TextView deviceedit = new TextView(this);

        deviceedit.setText(i+1);
        deviceedit.setTextColor(Color.BLACK);
        deviceedit.setGravity(Gravity.CENTER);
        deviceedit.setTextSize(20);
        deviceedit.setBackgroundResource(R.drawable.lighter_cell_shape);

        tablerow.addView(deviceedit);

        final EditText pondedit = new EditText(this);
        pondedit.setText("");
        pondedit.setTextColor(Color.BLACK);
        pondedit.setGravity(Gravity.CENTER);
        pondedit.setBackgroundResource(R.drawable.lighter_cell_shape);
        tablerow.addView(pondedit);
        pondedit.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                // TODO Auto-generated method stub

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {
                // TODO Auto-generated method stub

            }

            @Override
            public void afterTextChanged(Editable s) {
                // TODO Auto-generated method stub

            }
        });

        tl.addView(tablerow);
    }

} 
```

当我在生成的编辑文本中输入文本时，如何从编辑文本中获取这些文本并引用这些文本视图，即 1-> hai ， 2-> bye 像这样。TextWatcher 对这种情况有用吗？我想从edittexts 中获取数据并参考TextView 将数据保存在数据库中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T01:02:50.407

probably you will want to do this in separated for loops.

and to get the text entered in each `EditText` you need something like this:

```
ArrayList<String> textFromEditText = new ArrayList<>();

textFromEditText.add(pondedit.getText().toString()); 
```

dont forget to call the `.toString();` method since the from `EditText` you get a `Editable` type object.

once you have your data ready in the ArrayList just call this in another for loop:

```
for(i = 0;i < textFromEditText.size();i++){   
     final TextView deviceedit = new TextView(this);

     //other code of your textView

     deviceedit.setText(textFromEditText.get(i));

} 
```

maybe somebody can complement my answer.

# php - 正则表达式提取文本前的数字（各种文本组合）

> ID：14983127
> 
> 赞同：0
> 
> 时间：2013-02-20T15:07:35.613
> 
> 标签：php, regex

需要一些正则表达式（php）的帮助。我有以下文字：

11 小时 30 秒 12 分钟

和

12 分 11 小时 30 秒

和

12 分 11 小时 30 秒

我想提取没有。在分钟之前，正则表达式应该适用于所有文本组合。

对此的任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:09:31.420

像这样的简单正则表达式应该可以工作：

```
/(\d+) (?:mins|minutes)/ 
```

分钟数将在第一个捕获组中。

# c# - 如何将项目添加到数据库？

> ID：14983131
> 
> 赞同：1
> 
> 时间：2013-02-20T15:07:38.517
> 
> 标签：c#, database, listbox

我正在尝试使用 C# 将项目添加到我的数据库中。我有一个包含 2 个表的数据库：

“项目部分”

“项目表”，在这个表中有一个名为“项目名称”的列

但我收到此错误：

> 解析查询时出错。[令牌行号=1，令牌行偏移量=21，错误令牌=表]

这是我使用的代码。

```
private void button1_Click(object sender, EventArgs e)
    {
        sqlCEC.Open();

        //Project_List.Items.Add(new_project_name.Text.ToString());
        SqlCeCommand sqlCEcommand = new SqlCeCommand("INSERT INTO Project Table(Project Name) VALUES(@Project Name)", sqlCEC);
        sqlCEcommand.Parameters.AddWithValue("@Project Name", new_project_name.Text);

        sqlCEcommand.ExecuteNonQuery();

        sqlCEC.Close();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:09:33.313

您需要用括号将包含空格的表和字段括起来。

> SqlCeCommand sqlCEcommand = new SqlCeCommand("INSERT INTO [Project Table] ([Project Name]) VALUES (@ProjectName)", sqlCEC);

另外，不要在参数变量中包含任何空格，尝试将其更改为`@ProjectName`：

```
sqlCEcommand.Parameters.AddWithValue("@ProjectName", new_project_name.Text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:09:37.767

带有空格的表名和列名通常必须用`[`and包裹`]`。此外，参数中不能有空格

```
INSERT INTO [Project Table]([Project Name]) VALUES(@ProjectName) 
```

和

```
sqlCEcommand.Parameters.AddWithValue("@ProjectName", new_project_name.Text); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:09:54.850

当数据库对象包含空格时，需要用方括号将该名称括起来。
也不要使用空格命名参数。

```
private void button1_Click(object sender, EventArgs e)
{
    sqlCEC.Open();
    SqlCeCommand sqlCEcommand = new SqlCeCommand("INSERT INTO [Project Table] " + 
             "([Project Name]) VALUES(@ProjectName)", sqlCEC);
    sqlCEcommand.Parameters.AddWithValue("@ProjectName", new_project_name.Text);
    sqlCEcommand.ExecuteNonQuery();
    sqlCEC.Close();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T15:10:12.447

怎么样？

```
private void button1_Click(object sender, EventArgs e)
{
    sqlCEC.Open();
    SqlCeCommand sqlCEcommand = new SqlCeCommand("INSERT INTO [Project Table]([Project Name]) VALUES([@Project Name])", sqlCEC);
    sqlCEcommand.Parameters.AddWithValue("@Project Name", new_project_name.Text);
    sqlCEcommand.ExecuteNonQuery();
    sqlCEC.Close();
} 
```

因为您的数据库对象包含空格，所以您需要用`[]`

我的谦虚建议是，**切勿**在表格或列名中使用空格或其他特殊字符。

# oracle - 如何在 Oracle 中检查所有无效的同义词

> ID：14983139
> 
> 赞同：2
> 
> 时间：2013-02-20T15:08:00.470
> 
> 标签：oracle, synonym

我有表 user_synonyms，我可以在其中看到名称、表和表所有者。有没有办法查看这个同义词是否仍然有效，即 如果没有手动尝试引用表仍然存在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T15:14:30.700

您可以通过加入 ALL_TABLES 来检查表是否存在（同义词可能不在同一模式中的表上）。

```
select *
  from all_synonyms s
  left outer join all_tables t
    on s.table_owner = t.owner
   and s.table_name = t.table_name
 where s.owner = user 
```

`and t.table_name is null`如果您想要表不存在的同义词，请添加条件。

如果要检查同义词是否为 VALID 查询[ALL_OBJECTS](http://docs.oracle.com/cd/E11882_01/server.112/e25513/statviews_1155.htm#REFRN20146)。

```
select *
  from all_synonyms s
  join all_objects o
    on s.owner = o.owner
   and s.synonym_name = o.object_name
 where o.object_type = 'SYNONYM'
   and s.owner = user
   and o.status <> 'VALID' 
```

* * *

正如 a_horse_with_no_name 在评论中指出的那样，表、视图、序列甚至包都不需要同义词。

因此，您可能还想更改第一个查询以查找这些：

```
select *
  from all_synonyms s
  join all_objects o
    on s.table_owner = o.owner
   and s.table_name = o.object_name
 where s.owner = user 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-13T05:27:14.753

```
select distinct os.*
from   all_objects os
      ,all_synonyms s
where 1 = 1
and   os.object_type = 'SYNONYM'
and   os.STATUS      = 'INVALID'
and   os.object_name = s.synonym_name
and   not exists     ( select unique(1)
                       from   all_objects o1
                       where  o1.object_name = s.TABLE_NAME
                       and    o1.owner       = s.TABLE_OWNER)
order by 2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-01T18:01:07.830

Use the below query:

```
select s.table_owner, s.table_name 
from all_synonyms  s, all_tables t  
where s.table_owner = t.owner(+)
and s.table_name = t.table_name(+)
and t.owner is null
--s.owner = 'SCHEMA_NAME'
; 
```

# android - 计算不同的值并在 XML 中形成一个表？

> ID：14983140
> 
> 赞同：0
> 
> 时间：2013-02-20T15:08:02.167
> 
> 标签：android, xml

我想创建一个应用程序，我将在其中使用“for”循环...这样做我想保存我正在计算的每个值，并希望以 XML 的表格形式显示它们...我有问题在最后一部分...我似乎无法找到有关如何以表格形式将这些计算值发送到 XML 的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:13:47.417

一种选择是使用 StringBuilder 自己手动创建 xml 字符串。

我不能太具体，因为你的问题太模糊了，但是像这样：

```
StringBuilder sb = new StringBuilder();

sb.append("<parent>\n");
for(int i = 0; i < 10; i++){
  sb.append("<child>" + (i * 3.1415) + "</child>\n");
}
sb.append("</parent>"); 
```

那应该给你留下类似的东西：

```
<parent>
<child>0</child>
<child>3.1415</child>
<child>6.283</child>
.
.
.
</parent> 
```

# c# - 连接两个二维字符串数组

> ID：14983145
> 
> 赞同：1
> 
> 时间：2013-02-20T15:08:08.260
> 
> 标签：c#, string, arrays

我有两个二维字符串数组：

```
string[,] stringArray1 = {
                 {name1, name2, name3, name4, name5}, 
                 {value1, value2, value3, value4, value5}};

string[,] stringArray2 = {
                 {name1, name3, name5, name2, name4}, 
                 {defaultvalue1, defaultvalue3, defaultvalue5, 
                  defaultvalue2, defaultvalue4}}; 
```

有没有办法加入这两个字符串数组：

```
stringArrayJOINED = {
                  {name1, name2, name3, name4, name5}, 
                  {value1, value2, value3, value4, value5}, 
                  {defaultvalue1, defaultvalue2, defaultvalue3, 
                   defaultvalue4, defaultvalue5}}; 
```

注意：所有名称字段都是唯一的。

提前感谢您的帮助！=)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:29:42.943

我会先将 MD 转换成更有用的东西，

```
var dic1 =
   Enumerable.Range(stringArray1.GetLowerBound(1), stringArray1.GetUpperBound(1))
   .ToDictionary(
        i => stringArray1[0, i], 
        i => stringArray1[1, i]);

var dic2 =
   Enumerable.Range(stringArray2.GetLowerBound(1), stringArray2.GetUpperBound(1))
   .ToDictionary(
        i => stringArray2[0, i], 
        i => stringArray2[1, i]); 
```

然后，

```
var trios = dic1.Keys.Select(
                k => new { Key = k, Value = dic1[k], Default = dic2[k] }); 
```

那么，如果你真的觉得有必要...

```
var trioList = trios.ToList();
var stringArrayJOINED = new string[3, trioList.Count];
for (var i = 0; i < trioList.Count; i++)
{
    stringArrayJoined[0, i] = trioList[i].Key;
    stringArrayJoined[1, i] = trioList[i].Value;
    stringArrayJoined[2, i] = trioList[i].Default;
} 
```

* * *

如果默认值是稀疏填充的，听起来像是，像这样组合，

```
var robustButDirtyTrios = dic1.Keys.Select(k =>
                new 
                    { 
                        Key = k, 
                        Value = dic1[k], 
                        Default = dic2.FirstOrDefault(p => p.Key == k) 
                    }); 
```

然后像这样转换为MDA，

```
var trioList = robustButDirtyTrios.ToList();
var stringArrayJOINED = new string[3, trioList.Count];
for (var i = 0; i < trioList.Count; i++)
{
    stringArrayJoined[0, i] = trioList[i].Key;
    stringArrayJoined[1, i] = trioList[i].Value;
    var defaultValue = trioList[i].Default;
    if (defaultValue != null)
    {
        stringArrayJoined[2, i] = default; 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:29:52.860

所以你真正的问题是你使用二维数组来存储值之间的映射。这不是一个很好的数据结构。A `Dictionary`or`Lookup`更有效，因为它在逻辑上表示每个映射到一个值的键的集合，尽管在您的情况下拥有一个包含键和值的对象的列表或序列就足够了：

在这里做任何事情之前是一个方便的辅助方法，用于将二维数组的行作为序列取出；我们稍后会用到它：

```
public static IEnumerable<T> GetRow<T>(this T[,] array, int rowIndex)
{
    for (int i = 0; i < array.GetLength(1); i++)
    {
        yield return array[rowIndex, i];
    }
} 
```

现在我们可以轻松地将这两个数组映射成对序列：

```
var firstLookup = stringArray1.GetRow(0)
    .Zip(stringArray1.GetRow(1), (a, b) => new { Key = a, Value = b });

var secondLookup = stringArray2.GetRow(0)
    .Zip(stringArray2.GetRow(1), (a, b) => new { Key = a, Value = b }); 
```

一旦我们有了这个，我们就可以使用 LINQ`GroupJoin`运算符连接两个序列：

```
var finalLookup = firstLookup.GroupJoin(secondLookup, pair => pair.Key
        , pair => pair.Key
        , (pair, matches) => new { pair, matches })
    .ToDictionary(results => results.pair.Key
        , results => new[] { results.pair.Value }.Concat(
            results.matches.Select(group => group.Value))); 
```

（如果您确定没有重复的键，您可以使用`Join`代替`GroupJoin`，但这同样简单并且可以正确处理其他情况。）

最终结果是一个查找，其中每个序列中的每个名称都有一个键，映射到一个值；该值是一个字符串序列，它代表该键的所有值（在您的情况下，它始终是一个大小为 2 的序列）。

*如果你真的*需要，你可以将它转换回二维数组，但如果你这样做，它会更难使用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-20T15:11:07.173

尝试

```
stringArrayJoined = stringArray1.Concat(stringArray2); 
```

# .htaccess - .htaccess RewriteRule 具有相同的链接名称

> ID：14983146
> 
> 赞同：0
> 
> 时间：2013-02-20T15:08:07.997
> 
> 标签：.htaccess

以下代码是我的.htaccess。

```
RewriteEngine On
RewriteBase /

RewriteRule ^story$ story.html [L]
RewriteRule ^story/([0-9]+)/$ story2.html?seq=$1 [L] 
```

如您所见，我的意图很简单。我想将story.html之类的链接更改为story，将story2.html?seq=$1更改为story/(variable number)

前者效果很好，但 story2.html?seq=$1 不起作用。我认为这是因为我在链接中使用了相同的名称“故事”。如何在不将其更改为其他名称的情况下解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:14:21.050

在第二条规则中，因为您正在重写包含查询参数的 URL，所以您需要让重写引擎知道，如下所示：

```
RewriteRule ^store/([0-9]+)/$ story2.html?seq=$1 [L,QSA] 
```

意思是“`QSA`查询字符串追加”，让 mod_rewrite 知道您正在追加查询参数。

*   [RewriteRule 的 Apache mod_rewrite 文档](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)

# ruby-on-rails - ruby 数组映射双数组

> ID：14983147
> 
> 赞同：1
> 
> 时间：2013-02-20T15:08:09.703
> 
> 标签：ruby-on-rails, ruby, arrays, ruby-on-rails-3, multidimensional-array

，我知道如何将我想要的数据转换成一个数组。

即来自在一行中保存地理坐标的模型：

```
Place.all.map(&:latitude)

[12.34, 12.34, ...] 
```

如何将其转换为具有纬度和经度的嵌套双数组

```
ie [[12.34,23.34],[23.45,12,23],...] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:09:41.403

```
Place.all.map{ |place| [place.latitude, place.longitude] } 
```

旁注：

*   `all`查询是数据库杀手。

*   如果您只需要两个字段，请考虑使用`select`

# java - 关于有利于组合而不是继承方法，策略模式

> ID：14983148
> 
> 赞同：1
> 
> 时间：2013-02-20T15:08:11.313
> 
> 标签：java, oop, inheritance, composition, strategy-pattern

我在一次采访中被问到一个问题，可以说有一个类 A 使用方法 drawShape()，而另一个类 B 使用方法 drawSquare()。现在有第三个 C 类。在我的 CI 类中，需要 A 类和 B 类的这两种方法。我如何同时获得它们？

为此，我提出了以下方法：Java 不支持多类继承：

```
Class.interface IA {
   void drawshape();
}

inerface IB {
   void drawsquare();
}

class A implements IA {
    ...
}

class B implements IB {
    ...
}

class C implements IA, IB {
   private A a;
   private B b;

   void drawshape() {
     a.drawshape()
   } 

   void drawsquare() {
     b. drawsquare()
   }
} 
```

所示方法基于优先组合优于继承的原则。请让我知道这是否是正确的方法。这种模式也被称为策略模式，请告知它是正确的或我正在遵循的方法。伙计们对这种方法有任何更多的意见，请提出建议，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:13:58.713

是的，在这种情况下，组合可能是最好的方法。在某些情况下，您可能希望从一个类继承并在其他类上使用组合。

# android - “android.permission.ACCESS_CHECKIN_PROPERTIES”

> ID：14983153
> 
> 赞同：6
> 
> 时间：2013-02-20T15:08:13.813
> 
> 标签：android, android-manifest

我对android很陌生，任何人都可以详细说明为什么我们使用此权限“android.permission.ACCESS_CHECKIN_PROPERTIES”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-03-01T12:13:21.720

这是系统应用程序所需的权限。通常我们不使用此权限。如果您使用的是 android studio，您可以看到有关此权限的信息。它是所有权限中受保护的权限之一。但是安全应用程序，例如病毒防护等，正在使用此权限。

# c++ - 静态变量的哪个初始化是正确的

> ID：14983159
> 
> 赞同：1
> 
> 时间：2013-02-20T15:08:22.783
> 
> 标签：c++

我的标题中有一个静态变量。例子：

头文件：

```
class Fruits{
    public:
        static int colour;
} 
```

在包含头文件后的cpp文件中，最好写：

```
int Fruits::colour=1; 
```

或者

```
int Fruits::colour(1); 
```

有人告诉我，第一个不是变量的初始化，而是另一个变量的声明。设置初始化的正确方法和位置是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:14:01.180

在设计 C++ 时，他们决定，为了与早期代码保持一致，`type X = y;`将被视为等效于`type X(y);` **for built-in types**。因此，您给出的两个静态初始化示例被编译器视为完全相同，只是编写相同内容的不同方式。

对于类，它变得更加复杂。在许多情况下，`type X = y`它们`type X(y)`是可以互换的，但是在某些情况下，它们会导致不同的结果。[在这个问题](https://stackoverflow.com/questions/1051379/is-there-a-difference-in-c-between-copy-initialization-and-direct-initializati)的答案中详细讨论了这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T15:13:28.503

它们是相同的，除了第一个使用*复制初始化*语法（参见 C++11 标准的第 8.5/14 段）：

```
T a = b; 
```

而第二种使用*直接初始化*语法（参见 C++11 标准的第 8.5/15 段）：

```
T a(b); // C++11 also supports T a{b}; 
```

对于非类类型，两者是等价的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T15:11:38.943

这两行代码是等价的，都是初始化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-20T15:13:39.897

对于像这样的简单类型`int`，两者都是等价的。

对于类类型，有一个区别：第一个将从临时对象复制或移动初始化，而第二个将直接初始化命名变量。在实践中，复制或移动将被省略，两者将做完全相同的事情；但是如果该类既不可复制也不可移动，则第一个将无法编译。

所以最好将第二个用于类类型；而且，如果您喜欢一致性，您可能更愿意将它用于所有类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-20T15:17:42.263

“但是另一个人的声明”

是的，只有当您在不同的标题中多次定义它时，它才是另一个声明。但是仅在声明它的文件中定义它，那么它是相同的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-20T15:11:49.477

第一个解决方案似乎一切都很好。你可以用这个。据我所知，没有使用其他方式。

见[这里](http://www.learncpp.com/cpp-tutorial/811-static-member-variables/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-20T15:15:21.720

两者在操作上是等效的，尽管

`int Fruits::colour(1);`在这种情况下，如果`colour`是一个不同的对象，`class`那么它将调用构造函数（或者如果`class`提供了另一个相同的对象，它将调用复制构造函数）。

由于类型是`int`基本类型之一，因此它们是等价的并且同样有效。

# c# - SQLite 参考警告处理器不匹配

> ID：14983165
> 
> 赞同：4
> 
> 时间：2013-02-20T15:08:44.413
> 
> 标签：c#, winforms, sqlite

我刚刚从 SQL Server 更改为 SQLite，一切正常，一切正常，唯一困扰我的是，在警告消息下方，我收到关于与 SQLite 参考不匹配的警告：

> 警告 1 正在构建的项目的处理器架构“MSIL”与参考的处理器架构“System.Data.SQLite, Version=1.0.84.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139, processorArchitecture=x86”不匹配，“x86”。这种不匹配可能会导致运行时失败。请考虑通过配置管理器更改项目的目标处理器体系结构，以便在项目和参考之间对齐处理器体系结构，或者依赖具有与项目的目标处理器体系结构匹配的处理器体系结构的参考。LivePigeonClient

我是否安装了错误的参考？还是我真的需要将我的应用程序的目标设置为 x86？因为那不是我想要的，有没有人有一些关于做什么的建议，以摆脱这个警告？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:14:07.793

如果您希望使用此 ADO.NET 连接器，则必须为您的程序指定体系结构。这是因为这个程序集是一个混合模式程序集——它包含本机代码——因此它不能在其他体系结构下运行。如果您没有为可执行文件指定体系结构，则运行时将在 64 位机器上使用 64 位实例，并且引用的程序集将无法加载。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-12T10:33:51.677

安装 Nuget 包“System.Data.SQLite (x86/x64)”以消除此警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-16T14:56:30.423

我在 2020 年解决的问题（Microsoft Visual Studio Community 2019）遵循以下步骤

构建 -> 配置管理器 -> 活动解决方案平台 -> 选择 x86

# mysql - 出于性能原因，是否应按特定顺序放置 SQL JOIN？

> ID：14983167
> 
> 赞同：16
> 
> 时间：2013-02-20T15:08:49.060
> 
> 标签：mysql, optimization

假设我有以下查询。如果连接 t1 和 t2 时没有匹配项，MySQL 是否会忽略所有其他连接？

我问的原因是，如果不是，那么我将分解查询并使用 PHP 将其拼凑起来。如果没有性能影响，那么我将按照这样的顺序放置我的 JOIN，一旦之前的 JOIN 不成功，就不会继续。谢谢

```
SELECT whatever
FROM t1
INNER JOIN t2 ON t2.t1id=t1.id
INNER JOIN t3 ON t3.t2id=t2.id
INNER JOIN t4 ON t4.t3id=t3.id
INNER JOIN t5 ON t5.t4id=t4.id
INNER JOIN t6 ON t6.t5id=t5.id
INNER JOIN t7 ON t7.t6id=t6.id
INNER JOIN t8 ON t8.t7id=t7.id
INNER JOIN t9 ON t9.t8id=t8.id
WHERE t1.c=123 AND t4.c=321 AND t6.c=222 AND t9.c=222 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-20T15:47:55.747

MySQL的[文档](http://dev.mysql.com/doc/refman/5.0/en/left-join-optimization.html)指出“连接优化器计算应连接表的顺序”。

此顺序是根据有关表大小和其他因素（例如是否存在索引）的信息确定的。

您应该按照对阅读和维护查询最有意义的顺序放置连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:22:17.477

我的猜测是不会对性能造成影响。查询优化器应该确定 t2 和 t1 之间的连接无效，并将所有依赖连接解析为一个常量值，这意味着它们不会被评估。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-08T10:13:16.497

优化器仅在小型查询或小型数据库中表现出色。但它通常不适用于大型表和复杂查询。所以根据我的经验，答案是：

*   如果它们很少和/或数据库很小，您可以忘记连接的顺序。

*   如果您的表包含数百万行和/或您正在创建的连接，您必须仔细排序连接，从一个会切断大部分数据的连接到一个对要管理的数据量影响不大的连接很多。

# jquery - Flexslider 2.0 和 Animate.css 用于字幕

> ID：14983170
> 
> 赞同：2
> 
> 时间：2013-02-20T15:08:53.993
> 
> 标签：jquery, flexslider, animate.css

我正在尝试将 animate.css 集成到 flexslider 中，但尚未成功。任何专家都可以帮助我做到这一点。

谢谢-沙克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T04:03:27.797

我知道这可以使用数据属性来完成，看看我的小提琴，虽然在这个例子中我使用了 jquery.cycle2。

```
.caption1 {
font-weight:bold;
color:#FFF;
background:#000;
font-size:27px;
position:absolute;
top:20px;
left:20px;
z-index:30;
padding:5px;
-moz-animation: fadeInRight 1 ease-in 1.3s backwards; -webkit-animation: fadeInRight 1s ease-in 1s backwards; animation: fadeInRight 1s ease-in 1s backwards;
opacity: 1;
} 
```

希望这个对你有帮助。[小提琴](http://jsfiddle.net/defonic/npqB5/)

# validation - 单词用法：验证与验证

> ID：14983175
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:00.123
> 
> 标签：validation, verify

在检查表单字段中的错误以及检查数据库中的用户名和密码时，我应该使用、验证或验证哪个词？检查这个词是否适用于这两种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:12:50.873

如果你问你应该给你的函数起什么名字，你可以随心所欲地称呼它。我更喜欢 validate，因为它更具描述性。

# c++ - 如何设置 IDE ATA 控制器的 PIO 周期时序？

> ID：14983176
> 
> 赞同：2
> 
> 时间：2013-02-20T15:09:03.843
> 
> 标签：c++, windows, io, driver, hardware

我可以使用我自己编写的驱动程序在 Windows 8 x64 下以 PIO 模式传输数据以访问 I/O 端口。即使我将目标硬盘的传输模式（使用 ATA 命令）设置为 PIO 4，（读取操作的）传输速度也不会超过 1.2 MB/s（在 PIO 模式下约为 16 MB/s 4 应该达到）。奇怪的是，即使我将磁盘设置为 PIO 0 或 1，速度仍然保持不变。这就是让我认为我必须更改 IDE 控制器循环时间的原因。但是哪里？哪个端口？假设我有一个标准的 IDE 控制器，有两个通道，我正在使用通道 0，端口 0x1F0 到 0x1F7 用于 ATA 寄存器，端口 3F6 用于备用状态寄存器/设备控制，端口 FFA0 到 FFAF 用于 BusMaster。我知道对于 PIO 4，我应该使用 120 ns 的循环时间而不是 PIO 0 的 600 ns，但是，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T12:38:06.947

这个问题的答案取决于您的机器中的 IDE 控制器类型，因为设置主机时序不是 ATA 规范的一部分。举一个具体的例子，如果您使用 Intel ICHx 芯片之一上的内置 IDE 端口，则控制 IDE 时序的寄存器位于与控制器关联的 PCI 配置空间中的偏移量 0x40 到 0x41。其他几家制造商也出于相同目的采用了相同的寄存器。

因此，您可以尝试将 0x33 粘贴到此寄存器中并查看 I/O 是否加速 - 如果是，那么您有一个控制器可以处理此约定。

0x0- IORDY 在 5 个时钟采样 0x1- IORDY 在 4 个时钟采样 0x2- IORDY 在 3 个时钟采样 0x3- IORDY 在 2 个时钟采样

0x-0 tRecovery 4 个时钟 0x-1 tRecovery 3 个时钟 0x-2 tRecovery 2 个时钟 0x-3 tRecovery 1 个时钟

实际上，使用 0x33 应该适用于任何现代驱动器。

# c++ - 具有大量数据的类型安全实体对象

> ID：14983178
> 
> 赞同：2
> 
> 时间：2013-02-20T15:09:06.870
> 
> 标签：c++, sql, entity

目前，我们的系统使用类似于 Java Entity Beans 的东西，尽管它是用 C++/SQL 编写的。本质上，有些类（或多或少）象征着表格，这些类的实例等价于表格行。我想补充一点，这种方法一开始就有缺陷，请参阅这篇著名的文章：http: [//blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx) 另一方面，它运作良好，只要你接受它会导致一些不纯的东西，有时有点黑客。

然而，实际问题如下：虽然这些实体中有许多在内存占用方面相对较轻（十几列包含整数、浮点数和字符串）并且性能良好，但其中一些实际上并非如此。

1.  有些包含二进制块，例如网格或图片。有人可能会争辩说，这些不应该一开始就存储在数据库中，但这是另一个话题。
2.  有些实际上并不包含大量数据（以字节为单位），但是由于涉及的连接数量，获取完整集是一个非常大且相当慢的查询。

扭曲：这些“胖”对象经常在没有完整数据的情况下被使用。想象一下，您有一个“护照”类，其中包含生物特征数据、家庭关系树，还有姓名和出生日期。如果要显示护照列表，只需要基本数据。

我目前正在做的是创建一个 Passport 实例，但分两步填写。第一步仅添加简单字段，但将重字段保持打开状态（为 NULL）。稍后可以将该实例传递给将添加所有困难字段的函数。只要我没有犯错并在需要“完整”版本的地方使用“浅”实例，这将毫无问题。当然，我可以添加各种内部检查，但不仅扩展性很差（或多或少地为每个实体重新实现它们），而且还很容易出错。

因此，我的问题是：**我想在编译时区分这两个版本**，而不仅仅是在运行时。这样，我会在大多数错误发生之前就发现它们。

唯一可行的想法是将这两部分分成两个实体半，并将它们作为元组传递。如果第二个元组丢失，显然胖数据还没有加载。虽然这有效，但它会导致卑鄙的语法：

```
std::vector< EntityTuple<EmptyPassport, FullPassport>> 
```

我得到的所有类型安全都是以可读性为代价的，这并不是一个很大的改进。目前，我没有更好的想法，并且怀疑这在 C++ 中实际上是不可能的，但我可能是错的。也欢迎非 C++ 的建议，将来可能会有更好的方法来做到这一点。当然，如果有人能很好地说明为什么这是不可能的，我也会接受。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T17:56:17.417

[编辑] 你的“旗帜”想法没关系。

在另一个答案中，我提供了一个替代解决方案，我个人认为它是一个更好的解决方案，但这并不意味着您的想法是错误的。

下面的例子，我确实在某些情况下应用了，它是相同的“标志”想法，一个可能的实现，你可能想要或不想遵循。

例子：

```
public class EmployeeClass
{
  // --> logic fields
  private:
    bool    F_HeavyLoaded; 

  // --> "entity" fields
  public:
    int     Key;
    char    FirstName[150];
    char    LastName[150];
    Image*  Photo;    // <- picture
    Blob*   Contract; // <- scanned contract

  public:
  // --> constructors

    EmployeeClass
    (
      int   AKey,
      char* AFirstName,
      char* ALastName
    )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName;
      strcpy(LastName, ALastName);
      Photo = null; 
      Contract = null; 

      F_HeavyLoaded = false;
    } // EmployeeClass()

    // --> "heavy" constructor
    EmployeeClass
    (
      int    AKey,
      char*  AFirstName,
      char*  ALastName,
      Image* APhoto,
      Blob*  AContract
    )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName;
      strcpy(LastName, ALastName);
      Photo = APhoto; 
      Contract = AContract; 

      F_HeavyLoaded = true;
    } // EmployeeClass()

  public:
    // --> "entity" methods

    bool IsHeavyLoaded() { return F_HeavyLoaded; }

    void Insert();
    void Update();
    void Delete();
}; // class 
```

在这个例子中，有一个私有标志字段，叫做“F_IsHeavyLoaded”，它只能在构造函数中修改。它使用函数以只读方式公开提供。

干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:45:51.617

**概述**

让我提出一些处理“重”属性（如 blob、图像、文件）的想法。请记住，没有“一个解决方案”。我个人拒绝“加载所有重属性”标志的想法，并提出替代想法。

之前，我继续，请忽略小的语法或逻辑错误，并专注于代码示例的逻辑。

**[1] 定义示例**

首先，让我们从一个简单的例子开始：

```
public class EmployeeClass
{
  public:
    int     Key;
    char    FirstName[150];
    char    LastName[150];
    Image*  Photo;    // <- picture
    Blob*   Contract; // <- scanned contract
}; // class 
```

首先，您不必加载或不加载“重”属性，因为“实体”模型或其他编程技术是这样说的。

事实上，我不会为重物添加标志，因为这意味着加载所有“重”属性或根本不加载任何“重”属性。而且，有时您可能需要加载其中的一些，但不是全部。

**[2] 加载属性**

通常，程序的逻辑指示何时加载属性。

对于每种情况，通常的做法是使用不同的构造函数：

```
public class EmployeeClass
{
  public:
    int     Key;
    char    FirstName[150];
    char    LastName[150];
    Image*  Photo;
    Blob*   Contract;

  public:
    // --> generic constructor
    EmployeeClass()
    {
      Key = 0;
      strcpy(FirstName, "");
      strcpy(LastName, "");
      Photo = null; 
      Contract = null; 
    } // EmployeeClass()

    // --> "light" constructor
    EmployeeClass
    (
      int   AKey,
      char* AFirstName,
      char* ALastName
    )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName;
      strcpy(LastName, ALastName);
      Photo = null; 
      Contract = null; 
    } // EmployeeClass()

    // --> "heavy" constructor
    EmployeeClass
    (
      int    AKey,
      char*  AFirstName,
      char*  ALastName,
      Image* APhoto,
      Blob*  AContract
    )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName;
      strcpy(LastName, ALastName);
      Photo = APhoto; 
      Contract = AContract; 
    } // EmployeeClass()

    void Insert();
}; // class

void Test()
{
   ...
   int AKey = 0;
   char AFirstName[150];
   char ALastName[150];
   Image* APhoto = null;
   Blob*  AContract = null;

   // --> calling "light" constructor

   AKey = 1;
   strcpy(AFirstName, "Mary");
   strcpy(ALastName, "Thompson");

   EmployeeClass* AEmployee = new EmployeeClass
      (AKey, AFirstName, ALastName);

   AEmployee->Insert();

   // --> calling "heavy" constructor

   AKey = 2;
   strcpy(AFirstName, "John");
   strcpy(ALastName, "Doe");

   Image* APhoto = LoadPhoto();
   Blob*  AContract = LoadContract();

   EmployeeClass* AEmployee = new EmployeeClass
      (AKey, AFirstName, ALastName, APhoto, AContract);

   AEmployee->Insert();

   // --> calling "dummy" constructor,
   // --> more work, but, more flexible

   AKey = 1;
   strcpy(AFirstName, "Mary");
   strcpy(ALastName, "Thompson");

   EmployeeClass* AEmployee = new EmployeeClass();
     AEmployee->Key = AKey;
     strcpy(AEmployee->FirstName, AFirstName);
     strcpy(AEmployee->LastName, ALastName);
     AEmployee->Photo = LoadPhoto();
     AEmployee->Contract = LoadContract();
   AEmployee->Insert();

   ...
} // void Test() 
```

许多开发人员只使用“普通的轻量级构造函数”，并拒绝拥有多个构造函数的想法。

**[3] 附加帮助**

让我们暂时跳过“重”属性，稍后将继续。

这是许多 C/C++ 开发人员不喜欢的建议，但是，我个人觉得在处理实体对象时非常有用。我使用“两步初始化”。

对于每个实体类，我声明了一个构造函数，它没有清除字段的参数，并且添加了一个具有非常特定标识符的虚拟方法，它扮演构造函数的角色。

然后，我可能会添加几个充当构造函数的虚拟方法，例如决定是否加载“重”属性。

所以，前面的例子变成了这样：

```
public class EmployeeClass
{
  public:
    bool F_EmployeeClass_IsReady;
  public:
    int     Key;
    char    FirstName[150];
    char    LastName[150];
    Image*  Photo;
    Blob*   Contract;

  public:
    // --> only generic constructor
    Employee()
    {
      F_EmployeeClass_IsReady = false;

      Key = 0;
      strcpy(FirstName, "");
      strcpy(LastName, "");
      Photo = null; 
      Contract = null; 
    } // EmployeeClass()

    virtual bool IsReady()
    {
      return F_EmployeeClass_IsReady;
    } // bool IsReady(...)

    // --> works like "generic" constructor from previous example
    virtual void Create()
    {
      Key = 0;
      strcpy(FirstName, "");
      strcpy(LastName, "");
      Photo = null; 
      Contract = null; 

      F_EmployeeClass_IsReady = true;
    } // void Create()

    // --> works like "light" constructor from previous example
    virtual void CreateLight
      (
        int   AKey,
        char* AFirstName,
        char* ALastName
      )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName);
      strcpy(LastName, ALastName);
      Photo = null; 
      Contract = null; 

      F_EmployeeClass_IsReady = true;
    } // void CreateLight()

    virtual void Destroy()
    {
      F_EmployeeClass_IsReady = false;
    } // void Destroy()

    // --> works like "heavy" constructor from previous example
    virtual void CreateHeavy
      (
        int   AKey,
        char* AFirstName,
        char* ALastName,
        Image* APhoto,
        Blob*  AContract
      )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName);
      strcpy(LastName, ALastName);
      Photo = APhoto; 
      Contract = AContract; 

      F_EmployeeClass_IsReady = true;
    } // void CreateHeavy()

    void Insert();
}; // class

void Test()
{
   ...
   int AKey = 0;
   char AFirstName[150];
   char ALastName[150];
   Image* APhoto = null;
   Blob*  AContract = null;

   // --> calling "light" constructor

   AKey = 1;
   strcpy(AFirstName, "Mary");
   strcpy(ALastName, "Thompson");

   EmployeeClass* AEmployee = new EmployeeClass();
   AEmployee->CreateLight(AKey, AFirstName, ALastName);

     AEmployee->Insert();

   AEmployee->Destroy();
   delete AEmployee;

   // --> calling "heavy" constructor

   AKey = 2;
   strcpy(AFirstName, "John");
   strcpy(ALastName, "Doe");

   Image* APhoto = LoadPhoto();
   Blob*  AContract = LoadContract();

   EmployeeClass* AEmployee = new EmployeeClass();
   AEmployee->CreateHeavy
     (AKey, AFirstName, ALastName, APhoto, AContract);

     AEmployee->Insert();

   AEmployee->Destroy();
   delete AEmployee;

   // --> calling "dummy" constructor,
   // --> more work, but, more flexible

   AKey = 1;
   strcpy(AFirstName, "Mary");
   strcpy(ALastName, "Thompson");

   EmployeeClass* AEmployee = new EmployeeClass();
   AEmployee->Create();

     AEmployee->Key = AKey;
     strcpy(AEmployee->FirstName, AFirstName);
     strcpy(AEmployee->LastName, ALastName);
     AEmployee->Photo = LoadPhoto();
     AEmployee->Contract = LoadContract();

     AEmployee->Insert();

   AEmployee->Destroy();
   delete AEmployee;

   ...
} // void Test() 
```

在前面的示例中，每个实体都是使用 2 个步骤创建的，即“虚拟”构造函数和一个补充方法，每种情况都不同，具有一个有意义的标识符，在选择如何准备实体对象时很有用。

每个对象的销毁也是如此。

**[4] 重属性方法**

最后，您可能希望添加一些方法，在需要时负责加载“重”属性。有时显式调用，有时自动调用。

```
public class EmployeeClass
{
  public:
    bool F_EmployeeClass_IsReady;
  public:
    int     Key;
    char    FirstName[150];
    char    LastName[150];
    Image*  Photo;
    Blob*   Contract;

  public:
    // --> only generic constructor
    Employee()
    {
      F_EmployeeClass_IsReady = false;

      Key = 0;
      strcpy(FirstName, "");
      strcpy(LastName, "");
      Photo = null; 
      Contract = null; 
    } // EmployeeClass()

    virtual bool IsReady()
    {
      return F_EmployeeClass_IsReady;
    } // bool IsReady(...)

    void LoadPhoto();
    void SavePhoto();

    void LoadContract();
    void SaveContract();

    // --> works like "generic" constructor from previous example
    virtual void Create()
    {
      Key = 0;
      strcpy(FirstName, "");
      strcpy(LastName, "");
      Photo = null; 
      Contract = null; 

      F_EmployeeClass_IsReady = true;
    } // void Create()

    // --> works like "light" constructor from previous example
    virtual void CreateLight
      (
        int   AKey,
        char* AFirstName,
        char* ALastName
      )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName);
      strcpy(LastName, ALastName);
      Photo = null; 
      Contract = null; 

      F_EmployeeClass_IsReady = true;
    } // void CreateLight()

    virtual void Destroy()
    {
      F_EmployeeClass_IsReady = false;
    } // void Destroy()

    // --> works like "heavy" constructor from previous example
    virtual void CreateHeavy
      (
        int   AKey,
        char* AFirstName,
        char* ALastName,
        Image* APhoto,
        Blob*  AContract
      )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName);
      strcpy(LastName, ALastName);
      Photo = APhoto; 
      Contract = AContract; 

      F_EmployeeClass_IsReady = true;
    } // void CreateHeavy()

    // --> works like "heavy" constructor from previous example
    virtual void CreateAndLoad
      (
        int   AKey,
        char* AFirstName,
        char* ALastName
      )
    {
      Key = AKey;
      strcpy(FirstName, AFirstName);
      strcpy(LastName, ALastName);

      LoadPhoto();
      LoadContract; 

      F_EmployeeClass_IsReady = true;
    } // void CreateAndLoad()

    void Insert();
}; // class

void Test()
{
   ...
   int AKey = 0;
   char AFirstName[150];
   char ALastName[150];
   Image* APhoto = null;
   Blob*  AContract = null;

   // --> calling "load" constructor

   AKey = 1;
   strcpy(AFirstName, "Mary");
   strcpy(ALastName, "Thompson");

   EmployeeClass* AEmployee = new EmployeeClass();
   AEmployee->CreateLoad(AKey, AFirstName, ALastName);

     AEmployee->Insert();

   AEmployee->Destroy();
   delete AEmployee;

   ...
} // void Test() 
```

使用其他方法，您可能有一个忽略它们的 [fake] 构造函数，并且不加载“重”属性，一个调用它们的 [fake] 构造函数。或者，使用不使用它们的 [fake] 构造函数，并为特定的“重”属性显式调用加载程序。

如果您从文件系统路径加载图像并将它们保存到数据库字段中，这些也有帮助，反之亦然，从数据库字段加载文件并将它们保存到文件系统路径。

干杯。

# matlab - 在matlab中对多个矩阵求和

> ID：14983180
> 
> 赞同：2
> 
> 时间：2013-02-20T15:09:09.600
> 
> 标签：matlab

我有一个包含 60 个矩阵的文件。我想获得这 60 个矩阵中每个值的平均值。

所以矩阵中[1,2]的[1,1]均值的均值。

我无法使用 mean 命令，并且不确定执行此操作的最佳方法是什么。

这是文件：`https://dl.dropbox.com/u/22681355/file.mat`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:16:20.363

你可以试试这个：

```
 % concatenate the contents of your cell array to a 100x100x60 matrix
 c = cat(3, results_foptions{:});

 % take the mean
 thisMean = mean(c, 3); 
```

要四舍五入到最接近的整数，您可以使用

```
 roundedMean = round(thisMean); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:23:35.383

您应该将所有矩阵放在一个 3 维（矩阵？）*mat*中，如下所示：

```
mat(:,:,1) = mat1;
mat(:,:,2) = mat2;
mat(:,:,3) = mat3;
etc... 
```

然后简单地说：

```
mean(mat, 3); 
```

其中参数 '3' 规定您希望平均值在第 3 维上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:16:27.337

矩阵的平均值可以通过几种不同的方式计算。

首先，您可以计算每列的平均值，然后计算这些平均值的平均值：

```
colMeans = mean( A );
matMean = mean(colMean); 
```

或者您可以将矩阵转换为列向量并直接计算平均值

```
matMean = mean( A(:) ); 
```

# c# - 为什么添加自定义列后winform DataGridView控件不显示数据？

> ID：14983183
> 
> 赞同：1
> 
> 时间：2013-02-20T15:09:12.080
> 
> 标签：c#, winforms, datagridview

我有一个存储过程，它返回 10 列 [A 列、B 列等]。

根据该表，创建一个列出这些列的**winform ListBox。**

可以选择 ListBox 中的项目，然后选择“提交”按钮，它会打开一个带有 DataGridView 的新表单。

在新的 Forms 加载事件中，我放置了遍历列集合并创建 DataGridView 结构的代码。

我选择的列会显示，但数据不会填充到返回的行中。

```
 StoredProcedures.up_Report_Adapter reportAdapter = new StoredProcedures.up_Report_Adapter();

        gridCustomData.AutoGenerateColumns = false;

        gridCustomData.DataSource = reportAdapter.GetData();

        gridCustomData.Columns.Clear();
        gridCustomData.Columns.Add(new DataGridViewColumn() { HeaderText = "REPORT_ID", CellTemplate = new DataGridViewTextBoxCell() });

    foreach (var item in customReport.lstBoxSelectFields.SelectedItems)
            {
                gridCustomData.Columns.Add(item.ToString(), item.ToString());
            }

        gridCustomData.Refresh(); 
```

为数据显示了正确的行数，如果我在 gridCustomData.Refresh() 处插入一个中断，我可以看到从 ListBox 中选择的列的完整数据。

那么，如何让数据实际出现在每个定义的行/列中？

我尝试将创建列的顺序更改为在 gridCustomData DataSource 更新之前和之后使用相同的结果。

我还尝试创建一个 BindingSource 并将其用作 DataGridView 的 DataSource，然后使 BindingSource 的 DataSource 成为填充的表适配器。数据仍然不可见。

目标是创建一个“自定义查询”，但实际上，它只是意味着选择 DataSet 中的列。我正在获取存储过程返回的整个 DataSet（它本身受参数限制）。

作为旁注，如果有人知道一本关于这类事情的详尽食谱，我很想知道它的标题是什么。来自 MSDN 的 API 数据是无用的，因为它使用了人为的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:14:40.163

设置列后绑定到您的数据源。

首先为列设置 DataPropertyName`DataPropertyName = "REPORT_ID"`

```
gridCustomData.Columns.Add(new DataGridViewColumn() { HeaderText = "REPORT_ID", CellTemplate = new DataGridViewTextBoxCell(), DataPropertyName = "REPORT_ID" }); 
```

然后绑定到数据源。 `gridCustomData.DataSource = reportAdapter.GetData();`

# python - 从字典中获取值。键的范围匹配

> ID：14983184
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:13.337
> 
> 标签：python, dictionary

我创建了一个字典`myDict`，其中包含以下形式的 1000 万个条目。字典中的每个条目代表`{(id, age): code}`

```
>>> myDict = {('1039', '68.0864'): '42731,42781,V4501', 
              ('1039', '68.1704'): '4770,4778,V071', 
              ('0845', '60.4476'): '2724,27800,4019', 
              ('0983', '63.3936'): '41401,4168,4240,V1582,V7281'
             } 
```

常量`ageOffset`定义为 value =`0.1`

给定一个`(id,age)`元组，我如何从中获取所有`myDict`具有键的值`(id, X)`：

```
age <= X <= age+ageOffset 
```

我需要执行这个 fetch 操作 200 亿次。

```
Examples: 
1\. 
myTup = ('1039', '68.0')
the answer is: '42731,42781,V4501'

2\. 
myTup = ('0845', '60.0')
Ans : No value returned 
```

编辑：我可以在键的第一个元素的部分匹配的基础上创建一个子字典吗？我的意思是，如果元组 Key 的第一个元素匹配，则创建一个子字典。根据我的数据，这不会超过几百个。然后执行线性范围搜索，比较元组键中的第二个元素并找到相应的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:40:31.590

要执行此操作 200 亿（！）次，您必须对数据进行一些预处理。

首先，我会按 id 分组：

```
def preprocess(data):
    from collections import defaultdict # Python 2.5+ only
    preprocessed = defaultdict(list)
    # group by id
    for (id, age), value in data.iteritems():
        preprocessed[id].append((float(age), value))
    # sort lists for binary search, see edit
    for key, value in preprocessed.iteritems():
        value.sort()
    return preprocessed 
```

结果应如下所示：

```
>>> preprocess(myDict)
defaultdict(<type 'list'>, {
    '0845': [(60.4476, '2724,27800,4019')],
    '0983': [(63.3936, '41401,4168,4240,V1582,V7281')],
    '1039': [(68.0864, '42731,42781,V4501'), (68.1704, '4770,4778,V071')]} 
```

如果相对较少的项目共享相同的 id，从而导致列表较短，您可能会通过过滤列表而侥幸成功。

```
def lookup(data, id, age, age_offset=0.1):
    if id in data:
        return [value for x, value in data[id] if age <= x <= age+age_offset]
    else:
        return None     

lookup(preprocessed, '1039', 68.0) # Note that I use floats for age
['42731,42781,V4501'] 
```

但是，如果许多项目共享相同的 id，您将不得不遍历长列表，从而使查找相对较慢。在这种情况下，您将不得不应用进一步的优化。

编辑：正如@Andrey Petrov 所建议的那样

```
from bisect import bisect_left
from itertools import islice, takewhile
def optimized_lookup(data, id, age, age_offset=0.1):
    if id in data:
        l = data[id]
        idx = bisect_left(l, age)
        return [a for a,v in takewhile(lambda (x, value): x <= age+age_offset, islice(l, idx, None))]
    else:
        return None 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:03:18.107

Here's a way to do it in numpy, and though I haven't tested it I'm pretty confident it will be vastly faster than looping over the dictionary. I replaced the dictionary structure with a Numpy record array, and used np.where to locate the rows where they match the parameters you gave.

```
import numpy as np

myDict = {('1039', '68.0864'): '42731,42781,V4501', 
              ('1039', '68.1704'): '4770,4778,V071', 
              ('0845', '60.4476'): '2724,27800,4019', 
              ('0983', '63.3936'): '41401,4168,4240,V1582,V7281'
             }

records=[]
for k,v in myDict.iteritems():
    records.append([k[0], float(k[1]), v])

myArr = np.rec.fromrecords(records, formats='S10, f4, S100', 
                             names="ID, Age, Code")

def findInMyArray(arr, requestedID, requestedAge, tolerance=0.1):
    idx = np.where(((arr["Age"] - requestedAge) < tolerance) & (arr["ID"] == requestedID))
    return idx

idx = findInMyArray(myArr, "1039", 68.0, tolerance=0.1)
print "The index found is: ", idx
print "The values are: ", myArr["Code"][idx[0]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:44:00.680

```
def getr(t):
  id = float(t[0])
  age = float(t[1])
  os = 0.1
  rs = []
  correct_id=fixed[id]
  for k in correct_id.keys():
      if (k > age and k <= age + os):
          rs.append(correct_id.get(k))
  return rs

ct = {('1039', '68.0864'): '42731,42781,V4501',
      ('1039', '68.1704'): '4770,4778,V071',
      ('0845', '60.4476'): '2724,27800,4019',
      ('0983', '63.3936'): '41401,4168,4240,V1582,V7281' }

fixed={}

for k in ct:
    if not(float(k[0]) in fixed):
        fixed[float(k[0])]={}
    fixed[float(k[0])][float(k[1])] = ct[k]

print "1"
myTup = ('1039', '68.0')
assert(getr(myTup) == ['42731,42781,V4501'])

#the answer is: '42731,42781,V4501'

print "2"
myTup = ('0845', '60.0')
assert(getr(myTup) == [])
#Ans : No value returned 
```

# jquery - jQuery删除类的最后一个孩子

> ID：14983186
> 
> 赞同：1
> 
> 时间：2013-02-20T15:09:26.910
> 
> 标签：jquery

我正在处理一个动态表单，这些行有父下拉列表，当我们选择一个父级时，它会为子级的数量添加新的 ROW，我已经为每个子行分配了类。有动态添加父行的选项，依此类推。

到目前为止，添加和删除父行工作正常。我无法删除最后一个子行

下面是如何创建行的粗略概念，

```
 Row 1: <parent> select
  Row 2: -<child> select
  Row 3: -<child> select
  Row 4: - Child Add row / Remove row
  Row 5: <parent> select
  Row 6: -<child> select
  Row 7: - Child Add row / Remove row
  Row 8: Parent Add row / remove row 
```

为了更好的主意，这里是截图

![在此处输入图像描述](../Images/766087cf642b82d49ac5f5164aacbdda.png)

这个表很简单，没有嵌套表，只有6列12行，缩进是通过css完成的

现在，如果我`$('tr.partnumber_2_sub');`在萤火虫的控制台中使用，我可以看到类似的结果

```
Object[tr.partnumber_2_sub, tr.partnumber_2_sub, tr.partnumber_2_sub] 
```

但是当我使用`$('tr.partnumber_2_sub:last-child');`它时输出空对象。我想删除最后一个孩子，我的猜测是，`$('tr.partnumber_2_sub:last-child').remove();`但它不起作用。

**编辑**

感谢最后一行的答案，但我意识到我的孩子添加行/删除行在 tr 上也有相同的课程。现在我必须删除倒数第二个元素

**编辑**

好的，我在子行的 tr 上添加了额外的类，并没有添加子行的 add / del，所以现在我可以单独使用它们。改回标题并接受答案。

比你们所有人

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:13:01.577

尝试

```
$('tr.partnumber_2_sub').last().remove() 
```

# c# - 字符串替换换行符

> ID：14983187
> 
> 赞同：1
> 
> 时间：2013-02-20T15:09:27.487
> 
> 标签：c#, regex, string

我已将整个文件读入字符串对象：-

```
string result = File.ReadAllText(@"C:\TestLog.log"); 
```

我想删除所有换行符“\n”，但我还需要保留字符串对象中存在“\r\n”的任何实例。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:13:53.097

看起来你想要一个正则表达式替换。

```
string result = File.ReadAllText(@"C:\TestLog.log");
string newresult = Regex.Replace(result, @"[^\\r]\\n", ""); 
```

因此，该模式会查找前面没有 \r 的任何 \n。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:12:07.390

`result = result.Replace("\n","").Replace("\r","\r\n")`

虽然不使用正则表达式。不确定您是否打算使用它。

# php - PHP试图通过编写JavaScript代码来重定向url

> ID：14983191
> 
> 赞同：-2
> 
> 时间：2013-02-20T15:09:32.440
> 
> 标签：php, javascript

当我有

```
<script type="text/javascript"> <!-- window.location = "newthread.html" //--> </script> 
```

重定向工作正常，我希望它由 php 代码控制，但是当我尝试时

```
<?php print('<script type="text/javascript"> <!-- window.location = "newthread.html" //--> </script>'); ?> 
```

这没用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:13:16.280

使用 php[标头](http://php.net/manual/en/function.header.php)指令。在将任何内容输出到页面之前，该指令必须发生在脚本的最顶部。

```
<?php
header("Location: newthread.html");
exit;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:13:53.287

对于服务器的重定向，您需要在将其他任何内容返回给用户之前返回一个重定向标头（不是用于重定向的客户端脚本）

见[http://php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

代码：

```
<? header('Location: newthread.html'); ?> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-20T15:27:41.053

```
 $pagename="foo.php?bar=123";
  echo("<script type=\"text/javascript\"> \n <!-- \n top.location.href='$pagename'; \n //--> \n </script>");
  exit(); 
```

这将在输出某些内容**后**起作用，与`header`

为什么投反对票？

# c++ - 不完整的类型/转发声明的无效使用

> ID：14983192
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:32.020
> 
> 标签：c++, qt5

我一直在寻找有关此问题的信息..但我找到的解决方案都没有帮助我，我真的希望你能帮助我

*   maintabholder.h：

    ```
    #ifndef MAINTABHOLDER_H
    #define MAINTABHOLDER_H

    #include <QMainWindow>

    namespace Ui {
    class MainTabHolder;
    }

    class MainTabHolder : public QMainWindow
    {
        Q_OBJECT

    public:
        explicit MainTabHolder(QWidget *parent = 0);
        ~MainTabHolder();

    private:
        Ui::MainTabHolder *ui;
    };
    #endif // MAINTABHOLDER_H 
    ```

*   maintabholder.cpp：

    ```
    #include "maintabholder.h"
    #include "ui_maintabholder.h"

    MainTabHolder::MainTabHolder(QWidget *parent) :
        QMainWindow(parent),
        ui(new Ui::MainTabHolder)
    {
        ui->setupUi(this);
    }

    MainTabHolder::~MainTabHolder()
    {
        delete ui;
    } 
    ```

*   主.cpp：

    ```
    #include "maintabholder.h"
    #include <QApplication>

    int main(int argc, char *argv[])
    {
        QApplication a(argc, argv);
        MainTabHolder w;
        w.show();
        return a.exec();
    } 
    ```

*   ui_maintabholder.h #ifndef UI_MAINTABHOLDER_H #define UI_MAINTABHOLDER_H

    ```
    #include <QtCore/QVariant>
    #include <QtWebKitWidgets/QWebView>
    #include <QtWidgets/QAction>
    #include <QtWidgets/QApplication>
    #include <QtWidgets/QButtonGroup>
    #include <QtWidgets/QHBoxLayout>
    #include <QtWidgets/QHeaderView>
    #include <QtWidgets/QPushButton>
    #include <QtWidgets/QSpacerItem>
    #include <QtWidgets/QTabWidget>
    #include <QtWidgets/QVBoxLayout>
    #include <QtWidgets/QWidget>

    QT_BEGIN_NAMESPACE

    class Ui_Form
    {
    public:
        QHBoxLayout *horizontalLayout;
        QTabWidget *tabWidget;
        QWidget *comicViewer;
        QWidget *comicSearcher;
        QVBoxLayout *verticalLayout;
        QHBoxLayout *horizontalLayout_2;
        QPushButton *pushButton;
        QSpacerItem *horizontalSpacer;
        QPushButton *pushButton_2;
        QWebView *webView;

        void setupUi(QWidget *Form)
        {
            if (Form->objectName().isEmpty())
                Form->setObjectName(QStringLiteral("Form"));
            Form->resize(531, 308);
            horizontalLayout = new QHBoxLayout(Form);
            horizontalLayout->setObjectName(QStringLiteral("horizontalLayout"));
            tabWidget = new QTabWidget(Form);
            tabWidget->setObjectName(QStringLiteral("tabWidget"));
                    comicViewer = new QWidget();
            comicViewer->setObjectName(QStringLiteral("comicViewer"));
            comicViewer->setCursor(QCursor(Qt::ArrowCursor));
            tabWidget->addTab(comicViewer, QString());
            comicSearcher = new QWidget();
            comicSearcher->setObjectName(QStringLiteral("comicSearcher"));
            verticalLayout = new QVBoxLayout(comicSearcher);
            verticalLayout->setObjectName(QStringLiteral("verticalLayout"));
            horizontalLayout_2 = new QHBoxLayout();
            horizontalLayout_2->setObjectName(QStringLiteral("horizontalLayout_2"));
            pushButton = new QPushButton(comicSearcher);
            pushButton->setObjectName(QStringLiteral("pushButton"));

            horizontalLayout_2->addWidget(pushButton);

            horizontalSpacer = new QSpacerItem(40, 20, QSizePolicy::Expanding, QSizePolicy::Minimum);

            horizontalLayout_2->addItem(horizontalSpacer);

            pushButton_2 = new QPushButton(comicSearcher);
            pushButton_2->setObjectName(QStringLiteral("pushButton_2"));
            pushButton_2->setEnabled(false);

            horizontalLayout_2->addWidget(pushButton_2);

            verticalLayout->addLayout(horizontalLayout_2);

            webView = new QWebView(comicSearcher);
            webView->setObjectName(QStringLiteral("webView"));
            webView->setUrl(QUrl(QStringLiteral("about:blank")));

            verticalLayout->addWidget(webView);

            tabWidget->addTab(comicSearcher, QString());

            horizontalLayout->addWidget(tabWidget);

            retranslateUi(Form);

            tabWidget->setCurrentIndex(1);

            QMetaObject::connectSlotsByName(Form);
        } // setupUi

        void retranslateUi(QWidget *Form)
        {
            Form->setWindowTitle(QApplication::translate("Form", "Form", 0));
            tabWidget->setTabText(tabWidget->indexOf(comicViewer), QApplication::translate("Form", "Comic Viewer", 0));
            pushButton->setText(QApplication::translate("Form", "Go to SubManga", 0));
            pushButton_2->setText(QApplication::translate("Form", "Download Comic", 0));
            tabWidget->setTabText(tabWidget->indexOf(comicSearcher), QApplication::translate("Form", "Search For Comics", 0));
        } // retranslateUi

    };

    namespace Ui {
        class Form: public Ui_Form {};
    } // namespace Ui

    QT_END_NAMESPACE

    #endif // UI_MAINTABHOLDER_H 
    ```

编译器错误是：

```
 [...]\maintabholder.cpp: In constructor 'MainTabHolder::MainTabHolder(QWidget*)':
    [...]\maintabholder.cpp:6:16: error: invalid use of incomplete type 'class Ui::MainTabHolder'
    In file included from [...]\maintabholder.cpp:1:0:
    [...]\maintabholder.h:7:7: error: forward declaration of 'class Ui::MainTabHolder'
    [...]\maintabholder.cpp:8:7: error: invalid use of incomplete type 'class Ui::MainTabHolder'
    In file included from [...]\maintabholder.cpp:1:0:
    [...]\maintabholder.h:7:7: error: forward declaration of 'class Ui::MainTabHolder'
    [...]\maintabholder.cpp: In destructor 'virtual MainTabHolder::~MainTabHolder()':
    [...]\maintabholder.cpp:13:12: warning: possible problem detected in invocation of delete operator: [enabled by default]
    [...]\maintabholder.cpp:13:12: warning: invalid use of incomplete type 'class Ui::MainTabHolder' [enabled by default]
    In file included from [...]\maintabholder.cpp:1:0:
    [...]\maintabholder.h:7:7: warning: forward declaration of 'class Ui::MainTabHolder' [enabled by default]
    [...]\maintabholder.cpp:13:12: note: neither the destructor nor the class-specific operator delete will be called, even if they are declared when the class is defined 
```

你能帮忙吗？我会很感激...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:37:10.170

您正在使用由`uic`Qt 生成的文件；您应该验证此工具是否成功生成文件，例如检查构建输出和文件本身。此外，检查它是否在`*.pro`文件中（即，`maintabholder.h`标记为由 处理`uic`）。

我个人建议对 ui使用[多重继承方法：](http://doc.qt.digia.com/4.7-snapshot/designer-using-a-ui-file.html#the-multiple-inheritance-approach)

```
// in maintabholder.h
// ...
#include "ui_maintabholder.h"

class MainTabHolder : public QMainWindow, public Ui::MainTabHolder
{
    // ...
}; 
```

使用更简单，如果`ui_*.h`文件有问题，错误会更明确。

*你应该发帖`ui_maintabholder.h`。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T09:50:47.100

您在 .cpp 文件中包含了 ui 定义头，并定义了一个私有成员“Ui::MainTabHolder *ui;” 在你的 .h 文件中，所以你需要在你的类定义之前在你的 .h 文件（maintabholder.h:) 中添加一个前向声明：

```
class Ui_MainTabHolder; 
```

这里 Ui_MainTabHolder 是你的 Ui 类名，检查你自己的项目是否正确。

# php - 提交后如何清除ajax表单？

> ID：14983193
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:33.330
> 
> 标签：php, jquery, ajax, forms, submit

以下是用于处理我的表单的 ajax 标记：

```
$.ajax({
    dataType: "json",
    type: "get",
    url: "ajax.php?action=add_driver",
    data: $("#addDriver").serialize(),

    beforeSend: function(){
        $('.error, .success, .notice').remove();
    },

    success: function(json){
        if (json['status']=='success')
        {
            alert(json['message']);
            $("#addDriver").reset();
        }else{
            if(json['error']['my_variable']){
            $("input[name=my_variable]").after('<div class="error">'+json['error']['my_variable']+'</div>');    
            }
            $("#addDriver").reset();
        }
}); 
```

我想知道的是，一旦提交，我将如何清除表格？我厌倦了使用`$("#addDriver").reset();`，但它只是完全清除了表单而不提交表单。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:14:15.947

`how?`好吧，在你的情况下，这不是 的问题，而是 的问题`when?`。

`$("#addDriver")[0].reset();`应该没问题，只要它是您的表单的 id，只要您在`success()`或`complete()`回调函数中使用它。

# c# - 将摘要请求重定向到活动目录

> ID：14983194
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:33.470
> 
> 标签：c#, http, redirect, active-directory, digest-authentication

我正在尝试将带有摘要 MD5 标头信息的 http 请求重定向到活动目录以验证凭据。

我确实有 http 标头提供的信息，例如 nonce 和用户名。我现在的问题是我没有将这些信息放入`PrincipalContext`对象的链接。

我显然不能使用 PrincipalContext.ValidateCredentials(username, password) 因为它需要纯文本密码。

我能够使用的唯一验证是`UserPrincipal user = UserPrincipal.FindByIdentity(context, IdentityType.SamAccountName, username);`，但这不包括密码。

我有一个`HttpListenerContext`对象。但用户变量为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T09:39:18.563

在我告诉我的服务器给用户 AuthenticationSchemes.IntegratedWindowsAuthentication 之后，他自动提供了一个 WindowsPrincipal，它提供了来自 AD 的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:36:23.313

蒂姆一旦你得到信息，你可以做这样的事情来检查是否有效如果我理解你想要正确测试的内容，那么尝试这样的事情

如果您通过代码或服务运行此程序，则密码在暴露方面应该没有问题..如果您对此感到担忧，那么您需要编写一些内容来解密密码所在的 MD5 标头信息。

```
using(PrincipalContext prContext= new PrincipalContext(ContextType.Domain, "Your Domain"))
{
    bool isValid = prContext.ValidateCredentials("Username", "Password");
} 
```

# android - 用于 Web 应用程序的 Phonegap 构建需要时间加载

> ID：14983198
> 
> 赞同：1
> 
> 时间：2013-02-20T15:09:40.247
> 
> 标签：android, cordova

我有一个用于测验的网络应用程序，我已经使用 phonegap 转换为 Android 应用程序，但我遇到的问题是该应用程序需要 1-2 分钟才能加载，我认为这是因为加载了 javascript 和 css。我的测验应用程序中使用的 JS 和 CSS 文件是：

```
 <link rel="stylesheet"  href="css/jQueryMobilemin.css" />

   <script type="text/javascript" src="js/jquery-1.7.min.js"></script>
   <script type="text/javascript" src="js/jQueryMobilemin.js"></script>

    <link href="css/reset.css" media="screen" rel="stylesheet" type="text/css">
    <link href="css/slickQuiz.css" media="screen" rel="stylesheet" type="text/css">
    <link href="css/master.css" media="screen" rel="stylesheet" type="text/css">
    <script src="js/slickQuiz-config.js"></script>
    <script src="js/slickQuiz.js"></script>
    <script src="js/master.js"></script> 
```

有什么解决方案可以减少我的应用程序的加载时间。我读到异步 JS 加载更好，但它对最终的 android 应用程序有帮助吗

# linux - 从 HTML 文本文件中提取字符串并使用它来重命名文件

> ID：14983205
> 
> 赞同：1
> 
> 时间：2013-02-20T15:09:50.590
> 
> 标签：linux, shell, sed, awk, grep

我有几个 HTML 文件，其中包含我想要用于实际文件名的名称标签。示例 HTML 文件：

```
 <div class="top">SomethingFile</div>
    <a href="../files/15d705df3.txt"/> 
```

输出：我希望 SomethingFile 标记为 15d705df3.txt 的名称

```
 15d705df3.txt --> SomethingFile.txt 
```

我有大约 800 多个具有相同格式的文本和 HTML 文件，我想重命名它们。我一直在尝试使用 awk、sed 和 grep 来解决这个问题。但不幸的是，我不知所措，坚持创建最初的两个变量并使用它们重命名文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:14:01.617

[`awk`, `sed`, 并且`grep`不是此任务的正确工具](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)，而是我建议您

```
xmllint --html --xpath '/Xpath/expression' file.html 
```

带有[Xpath 表达式](http://en.wikipedia.org/wiki/Xpath)。

## 基本上

```
xmllint --html --xpath '//div[@class="top"]/text()' file.html 
```

## 最后

```
for f in *.html *.txt; do
    filename=$(xmllint --html --xpath '//div[@class="top"]/text()' "$f")
    mv "$f" "$filename.txt"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:17:50.643

在解析器`perl`的帮助下使用的一种解决方案：`html``HTML::TokeParser`

```
#!/usr/bin/env perl

use warnings;
use strict;
use HTML::TokeParser;
use File::Spec;

my ($newfile, $currentfile);

## Give as arguments the html files to process, like *.html
for ( @ARGV ) { 
    my $p = HTML::TokeParser->new( $_ ) or die;

    ## Search a "div" tag with the attribute "class" to value "top".
    while ( my $info = $p->get_tag( 'div' ) ) { 
        if ( $info->[1]{class} eq 'top' ) { 

            $newfile = $p->get_text;

            ## Omit next two tokens until following "a" tag (</div>, space).
            $info = $p->get_token for 1 .. 3;

            ## If tag is a start 'a' tag, extract file name of the href attribute.
            if ( $info->[0] eq 'S' &&
                 $info->[1] eq 'a' ) { 
                $currentfile = ( File::Spec->splitpath( $info->[2]{href} ) )[2];
                $newfile .= join q||, (split /(\.)/, $currentfile)[-2 .. -1];
            }   
            last;
        }   
    }   

    ## Rename file.
    if ( $newfile && $currentfile ) { 
        printf STDERR qq|Renaming --> %s <-- to --> %s <--\n|, $currentfile, $newfile;
        rename $currentfile, $newfile;
    }   
    $newfile = $currentfile = undef;
} 
```

像这样运行它：

```
perl-5.14.2 script.pl *.html 
```

在我的一项测试中，结果应该类似于：

```
Renaming --> 15d705df3.txt <-- to --> SomethingFile1.txt <--
Renaming --> 15d705dg6.txt <-- to --> SomethingFile2.txt <-- 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:46:20.413

受@sputnick 启发但使用**[Xmlstarlet](http://xmlstar.sourceforge.net/)**而不是`xmllint`.

```
xml sel -T -t -o "mv " -f -o " " -t -v 'string(//div[@class="top"])' -o ".txt" -nl *.html 
```

给出：

```
mv t.html SomethingFile.txt
mv tt.html SomethingElse.txt 
```

当你对你认为它会做的事情感到满意时。

```
xml sel -T -t -o "mv " -f -o " " -t -v 'string(//div[@class="top"])' -o ".txt" -nl *.html | sh 
```

所有功劳归功于@sputnick 播下种子并让我能够背负重担。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:16:40.593

循环遍历文件，用于`sed`提取文件的新名称，然后重命名文件。

```
for file in *
do
    name=$(sed -n 's|.*<div class="top">\(.*\)</div>|\1|p' "$file")
    mv "$file" "$name.txt"
done 
```

# android - 将数据从服务器发送到 Android 数据库

> ID：14983208
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:56.753
> 
> 标签：android, sql-server, web-services, synchronization

我有一个 android 应用程序，它从 web 服务接收数据并将其插入到 android 的本地数据库中。此数据流从应用程序管理面板中的按钮开始。我的意思是，作者登录到设备中的管理面板并单击“开始同步”按钮，设备的数据库开始与 SqlServer 数据库同步。

**我想做的是**从远程服务器触发这个事件。换句话说，当我单击 Web 应用程序中的按钮时，我希望这个过程开始时就像有人单击“开始同步”按钮一样。让这个 Web 应用程序是服务器，设备是客户端。我希望为所有客户端（广播）触发此过程。

我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:13:35.127

让客户端（应用程序）作为 GCM 客户端注册到您的服务器。然后，服务器可以向所有注册的客户端发送更新请求。在您的应用程序中，您将收到一个意图。[以下是如何开始](http://developer.android.com/google/gcm/gs.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:19:09.053

只是一个提示。

我也曾经想实施类似的策略来强制客户端更新。最后，我切换到应用程序和用户来决定何时下载数据。（在启动和控制非持久服务以进行每日更新的警报管理器）。

许多开发人员忘记了用户，我见过许多具有持久服务的应用程序，以及更多不良行为。仅仅因为您可以轻松控制用户或编程。

否则，正如 323go 所提到的，[谷歌云消息传递](http://developer.android.com/google/gcm/index.html)是要走的路

# c# - 断言组织单位有效的正则表达式

> ID：14983209
> 
> 赞同：0
> 
> 时间：2013-02-20T15:09:59.210
> 
> 标签：c#, regex, active-directory

我正在 c# 中构建一个 Active Directory“矿工”，并且需要断言输入字符串确实是一个有效的（正确的“语法”）组织单位。

一个组织单位是这样建立的：`CN=SomeName,OU=SomeOrganizationalUnit,DC=SomeDomainPart,DC=SomeDomainPart,DC=SomeDomainPart`

它不必包含 CN= 或 OU=，它可以包含至少两个 DC=，例如： `"DC=example,DC=com"`

所以我需要的是匹配两个字符（Az），然后是“=”，然后是一个单词（a-zAZ0-9）然后是一个逗号，这个组可能会出现无限次，但至少必须存在两个。整个字符串可能永远不会以逗号结尾。

我仍然主要处于正则表达式的复制页面状态。这就是我的初学者

```
.[a-zA-Z0-9]{2}.[=]\W 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:27:27.790

您可以执行以下操作（从 Lloyd 的原始正则表达式开始）：

```
^(?:(?:CN|OU|DC)\=\w+,)*(?:CN|OU|DC)\=\w+$ 
```

匹配零个或多个组，后跟逗号，然后是最后一组。

如果您想要求至少有两个组，只需更改`*`为`+`：

```
^(?:(?:CN|OU|DC)\=\w+,)+(?:CN|OU|DC)\=\w+$ 
```

如果要要求组数在一定范围内，请使用量词：

```
^(?:(?:CN|OU|DC)\=\w+,){1,3}(?:CN|OU|DC)\=\w+$ 
```

这总共需要两到四组。

如果您有其他要强制执行的要求（例如始终必须包含 DC，或者如果 OU 和 CN 不存在，则至少有两个 DC），那么您对单个正则表达式的要求太多。您将需要一个多步骤的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:28:19.103

以下正则表达式将匹配（两个字符 Az、等于、一个或多个字符 A-z0-9）两次或更多次，每次之间用逗号分隔：

```
^[A-Za-z]{2}=[A-Za-z0-9]+(,[A-Za-z]{2}=[A-Za-z0-9]+)+$ 
```

# php - 根据先前的选择（PHP/HTML）从数据库查询中选择下拉列表

> ID：14983210
> 
> 赞同：2
> 
> 时间：2013-02-20T15:10:02.980
> 
> 标签：php, javascript, html

我需要根据之前选择的下拉列表填充另一个下拉列表。请帮助。我的代码如下。现在，我如何将先前选择的值传递给下一个下拉 where 子句？

```
 <td align="right">Country</td>
   <td>
     <select  type="text" name="Country">
      <option selected  value="">Country Code</option>
       <?php $result=mysql_query("SELECT CountryName FROM tbl_country");          
        while($row_result=mysql_fetch_row($result))
        { echo "<option value=\"$row_result[0]\">$row_result[1]</option>";}
       ?>
       </select>*
    </td>
<td align="right">Area</td>
   <td>
     <select type="text"  name="Area">
      <option selected value="">Area</option>
       <?php $result=mysql_query("select Area from tbl_area where CountryName='???'");        
        while($row_result=mysql_fetch_row($result))
        { echo "<option value=\"$row_result[0]\">$row_result[0]</option>";}
       ?>
       </select>*
    </td> 
```

如何将所选国家/地区名称设置为第二个查询 where 子句？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:15:53.527

由于 PHP 在服务器上运行，您需要通过刷新页面或通过 AJAX 来请求服务器为您运行第二个查询，以便页面刷新但看起来不像它。

最简单的解决方案是跨 2 个页面进行，如果您想在一个页面上进行，那么 AJAX 是前进的方向。

给我一分钟，我会找一个例子。

# c# - 在@Url.Action() 路由值中使用枚举

> ID：14983218
> 
> 赞同：0
> 
> 时间：2013-02-20T15:10:25.533
> 
> 标签：c#, razor, asp.net-mvc-4

这个问题只是一个快速的问题。我在一个页面上有一组链接，它们实际上都指向同一个控制器方法——它们之间的区别在于它们各自向该方法传递了不同的值，因此后续过程略有不同。我碰巧已经定义了一个与传递的可能值相对应的枚举，所以我不假思索地这样做了：

```
@Url.Action("QueryStepTwo", new { type = QueryType.UserRecords }) 
```

并且惊喜地发现没有任何东西获得红色下划线。我点击编译并导航到该页面进行验证，显示 CS0103 的错误消息：“名称 'QueryType' 在当前上下文中不存在”。在编辑器中，`QueryType`语法突出显示，并且 IntelliSense 在我键入时提供选项列表。

我假设这只是 VS/IntelliSense 有点太聪明并且知道实际页面解析/渲染引擎无法做到的事情的一个例子？将枚举转换为其字符串或 int 值没有帮助，所以我猜这与执行的顺序有关；更具体地说，当 Razor 看到该页面时，枚举已超出范围。有没有办法在这样的 URL 帮助器中使用枚举，尤其是不需要将枚举定义为视图模型成员的方法？我不喜欢到处使用魔线；他们太容易受到拼写错误和愚蠢行为的影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:13:15.627

确保您完全限定了定义此枚举的命名空间：

```
@Url.Action("QueryStepTwo", new { type = SomeNamespace.QueryType.UserRecords }) 
```

或者，如果您不想这样做，您还可以`@using` 在 Razor 视图的顶部添加指令：

```
@using SomeNamespace 
```

如果您想为所有 Razor 视图全局执行此操作，您可以将此命名空间添加到`<namespaces>`节点中`~/Views/web.config`（不要与 混淆`~/web.config`）：

```
<system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />

        <add namespace="SomeNamespace" />
      </namespaces>
    </pages>
</system.web.webPages.razor> 
```

就 Razor 视图中的 Intellisense 而言，这不是可以信任的。希望微软会在未来的版本中改进它。

# php - PHP-GD 使文本换行上的所有字体的行高兼容

> ID：14983229
> 
> 赞同：0
> 
> 时间：2013-02-20T15:10:51.290
> 
> 标签：php, gd, image-manipulation, word-wrap

好的，所以我正在使用 jquery 开发一个简单的生成器。用户输入他/她选择的文本，选择字体、字体颜色和字体大小。所有这些属性都实时显示在单独的 div 上（实时预览）。

我现在需要将生成的预览保存为图片。为此，我使用 php GD 库。一切正常，但使用一些字体，一切都搞砸了。

![第一个字体行高看起来很完美](../Images/d7e84928177a8dd22bf2427ea6aba9fc.png)

![第二个字体行高搞砸了](../Images/54c203360878c928c17378b93515ab8c.png)

在第一张图片中，一切看起来都很好，但第二张图片，线高只是搞砸了。

这是我用来处理属性的 php 脚本

```
 <?php
        //Width and height of desired image  
        $width = 320;
        $height= 320;

       //Create an image with specified height and width
       $main_img = ImageCreate($width, $height);
       $mx = imagesx($main_img); 
       $my = imagesy($main_img); 

       //Capture values from form
       $main_text = $_POST['rtext'];
       $main_text_size =  $_POST['rfsize'];
       $color = $_POST['rcolor']; 
       $mt_f = $_POST['rfont'];
       $main_text_x = ($mx/2);

       // more code here      

       //wrap text if text too long
       $words = explode(' ', $main_text); 
       $lines = array($words[0]); 
       $currentLine = 0; 
       for($i = 1; $i < count($words); $i++) 
       { 
            $lineSize = imagettfbbox($main_text_size, 0, $mt_f, $lines[$currentLine] . ' ' . $words[$i]); 
            if($lineSize[2] - $lineSize[0] < $mx) 
            { 
                $lines[$currentLine] .= ' ' . $words[$i]; 
            } 
            else 
            { 
                $currentLine++; 
                $lines[$currentLine] = $words[$i]; 
            } 
       } 
       $line_count = 1; 

       // Loop through the lines and place them on the image 
       foreach ($lines as $line) 
       { 
           $line_box = imagettfbbox($main_text_size, 0, $mt_f, "$line"); 
           $line_width = $line_box[0]+$line_box[2]; 
           $line_height = $line_box[1]-$line_box[7]; 
           $line_margin = ($mx-$line_width)/2; 
           $line_y = (($line_height+12) * $line_count); 
           imagettftext($main_img, $main_text_size, 0, $line_margin, $line_y, $main_text_color, $mt_f, $line); 

           // Increment Y so the next line is below the previous line 
           $line_count ++; 
      } 
      header("Content-type: image/png");

      //code to download the image

    ?> 
```

有没有办法可以修改我包装文本以适应所有字体的代码部分？喜欢根据字体自动计算行高？

谢谢，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T22:03:19.800

我在 phpclasses `imagefittext.class.php` [http://www.phpclasses.org/browse/file/41869.html](http://www.phpclasses.org/browse/file/41869.html)找到了一个非常有用的类。我还找到了一个使用类[http://www.phpclasses.org/browse/file/41870.html](http://www.phpclasses.org/browse/file/41870.html)实现的示例脚本。这正是我想要的。

完美运行！！！1

# php - 使用 PHP 查询更改表，列名未显示在 phpMyAdmin 中

> ID：14983232
> 
> 赞同：2
> 
> 时间：2013-02-20T15:10:56.910
> 
> 标签：php, mysql, phpmyadmin

这是我的第一篇文章，这里有一个类似的帖子： [phpMyAdmin doesn't show added columns - Thinbug](https://stackoverflow.com/questions/12960302/phpmyadmin-doesnt-show-added-columns)

但由于没有人回答，我会在这里询问并提供更多细节，希望能解决这个问题。我的数据库中有一个表，我需要能够添加其他列。我使用以下查询完成了此操作：

```
$sql = "ALTER TABLE tablename ADD columnname INT(11)";  //Run the query.... 
```

这在第一天工作得很好，但是在第二天当我尝试通过这个 php 脚本添加一个额外的列时，它似乎可以从 phpMyAdmin 结构视图中工作。该列具有正确的列名和数据类型。但是，当我切换到浏览视图时，没有列名，只有填充了“空”值的空白列。但是，如果您单击单个行，它会显示正确的列名和一个值（如果该行存在一个值）。

我试过运行分析表，因为我在某处读到会更新架构的地方。但是，我在修复它方面没有任何成功。我宁愿不必删除表并重新启动，特别是如果我再次遇到此问题。由于这是我的第一篇文章，我已尝试正确格式化所有内容，但如果我没有，请原谅我。此外，如果有人在理解我的问题时遇到问题，我可以截屏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T12:04:43.920

如果可以，重新启动 mysql，它应该刷新所有内容，包括 phpmyadmin 可能正在使用的 mysql 缓存。

# upgrade - Firebird 从 2.1.3 升级到 2.5？

> ID：14983233
> 
> 赞同：3
> 
> 时间：2013-02-20T15:11:02.043
> 
> 标签：upgrade, firebird2.5, firebird2.1

是否有任何地方的列表或最佳实践说明将 firebird 数据库从一个版本更新到另一个版本（在我的情况下是 2.1.3 到 2.5.2）？

我见过提到的备份和恢复。过去我已经从 1.5 更新到 2.1，但这只是工作，即我刚刚安装了新的 firebird 版本，但我知道这可能只是运气。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T17:03:33.707

Firebird 2.5.2 发行说明中有一节介绍了升级时需要注意的[兼容性问题。](http://www.firebirdsql.org/file/documentation/release_notes/html/rlsnotes252.html#rnfb25-compat)Firebird 安装目录还包含有关在`misc/upgrade/metadata/metadata_charset.txt`. 如果您的数据库具有不正确的元数据字符集，则可能会损坏（但 AFAIK 在 Firebird 2.1 下它们也会损坏）。

从技术上讲，您可以升级到 2.5，而无需对数据库进行备份和恢复周期，但这意味着数据库的磁盘结构 (ODS) 未升级到 ODS 11.2，这可能意味着您实际上无法使用某些新版本引入的新功能（或：性能改进）。如果您实际上仍在使用 Firebird 1.5 的 ODS 10.1，情况可能会更糟。

# opencart - 禁用opencart中的一些选项

> ID：14983235
> 
> 赞同：0
> 
> 时间：2013-02-20T15:11:04.413
> 
> 标签：opencart, options

这是给你的一个:) 我有一个基于 opencart 的网上商店，我根据颜色和尺寸制作了预定义的选项。现在的问题是，有时并非所有颜色或尺寸都可用，所以我只想在选项中禁用该颜色或尺寸值，而不是删除它。

那可能吗？我找不到解决方案，对此进行扩展。

感谢转发。

这是选项值的图片：http: [//oi47.tinypic.com/2gtysdt.jpg](http://oi47.tinypic.com/2gtysdt.jpg) 我想要一个禁用字段，而不仅仅是删除

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T17:26:14.030

当您向某些产品添加选项`set subtract stock to yes`然后`quantity to 0`它不会显示在前端（因此暂时禁用它）时，当您希望它显示时，只需设置`subtract stock to no`它就会显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:27:05.053

您的意思是要细化哪些选项有子选项。如果是这样，我认为[依赖选项](http://www.opencart.com/index.php?route=extension/extension/info&extension_id=5214)是您所追求的修改（这是我不隶属的商业修改）

# entity-framework - 我应该将 TransactionScope 与 DbContext 一起使用吗

> ID：14983237
> 
> 赞同：2
> 
> 时间：2013-02-20T15:11:15.643
> 
> 标签：entity-framework, transactions

根据这个链接：[EF Code First DBContext and Transactions](https://stackoverflow.com/questions/6028626/ef-code-first-dbcontext-and-transactions)

我应该将 savechanges 包装在 TransactionScope using 语句中。

我认为 SaveChanges 的工作方式类似于事务方法。

例子：

在服务方法中，我在服务方法结束时的一个 http 请求中删除和添加不同的实体，我执行 SaveChanges 一个 ONE Con​​text。

我永远不会有多重上下文。它总是由 Ninject 为 http 请求的生命周期创建并在存储库之间共享的相同上下文注入。

那么当我有多个 dbcontext 时，我只需要在 TransactionScope 中包装 DbContext.SAveChanges 是真的吗？- 因为这些可能是多个数据库，也就是分布式事务 - ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T16:32:22.167

如果出现以下情况，则无需将 SaveChanges 调用包装在另一个 TransactionScope 中；

1.  如果您不尝试在同一事务中使用多个上下文。
2.  如果即使使用相同的上下文也没有进行多次 SaveChanges 调用。例如，删除后的一个 SaveChanges，添加后的另一个 SaveChanges...

总之，您可以使用相同的上下文执行多个删除/添加操作，最后调用 SaveChanges 方法一次 - 它们都将应用于一个事务。只有当您有嵌套事务场景时，才需要 TransactionScope。

# ruby-on-rails - 带有 sql server 的 Ruby on Rails

> ID：14983239
> 
> 赞同：3
> 
> 时间：2013-02-20T15:11:17.873
> 
> 标签：ruby-on-rails, sql-server, sql-server-2008-r2

有机会我将不得不使用带有 SQL Server 2008 r2 数据库的 RoR 来制作一个项目。在使用 RoR 进行开发时，使用 sql server 而不是 mysql 是否有任何复杂性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T16:17:49.663

mysql 适配器和 SQLServer 适配器的唯一区别是后者依赖于 freetds gem。当你第一次建立你的连接时，你可能需要处理一些freetds附带的简单实用程序来验证或调试连接。一旦你连接了，你处理数据库的方式就没有什么不同了，你的 RoR 代码中没有任何地方是特定于 SQLServer 与 mysql 的，它都是由 SQLServer 适配器和 freetds 处理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:12:27.177

应该不是太大的问题；请参阅Xavier Shay[对 Rails 3、Ruby 1.9.2、Windows 2008 和 SQL Server 2008 的截屏视频。](http://rhnh.net/2010/10/10/rails-3-ruby-1-9-2-windows-2008-and-sql-server-2008-tutorial)

如果您在处理此项目时遇到问题，StackOverflow 随时可以帮助您；-)

# javascript - 有选择地返回 JSON 对象结果

> ID：14983240
> 
> 赞同：0
> 
> 时间：2013-02-20T15:11:28.237
> 
> 标签：javascript, json, jquery

我正在尝试使用以下代码有选择地从标准 JSON 文件返回结果：

```
var filters = { manufacturer: "Samsung" };

// filters initialised, now getJSON with filters
$.getJSON("phones.json", filters, function(result)
{
    alert(result.phones.length);
}); // end getJSON 
```

我想要做的是只返回“制造商”是三星的对象。JSON 看起来像这样：

```
{
    "phones": [{
        "basic": {
            "id" : "1",
            "name": "Samsung Galaxy S III",
            "manufacturer": "Samsung", 
```

等等等等……

它不起作用，根本没有过滤 JSON。任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:34:05.457

`$.getJSON()`不支持过滤，因此假设您`phones.json`是一个没有服务器端处理的静态文件，您必须在客户端进行过滤：

```
$.getJSON("phones.json", function(result)
{
    var filtered = [];
    $.each(result.phones, function(key, value){
        if(value.basic.manufacturer == 'Samsung'){
            filtered.push(value);
        }
    });

    console.log(filtered);
}); 
```

以上将过滤后的电话存储在`filtered`.

# classification - Mahout：为什么使用 setProbes() 会产生这种影响？

> ID：14983244
> 
> 赞同：1
> 
> 时间：2013-02-20T15:11:41.503
> 
> 标签：classification, mahout

我正在使用 mahout 0.7 进行一些分类。我有一个连续变量的编码器

```
ContinuousValueEncoder durationPlanEncoder = new ContinuousValueEncoder("duration_plan"); 
```

与此编码器相关的功能是天数，范围可以从大约 6 到 16。

我正在使用 OnlineLogisticRegression 模型，并使用编码器对其进行训练：

```
durationPlanEncoder.addToVector(null, <duration_plan double val>, trainDataVector); 
```

为简单起见（因为我试图在学习 Mahout 的同时理解整个分类），我使用了 2 个变量：1）一个具有 6 个类别的分类变量——其中一个（“dev”）总是预测 =1 类别; 和 2) 这个“duration_plan”变量。

我期望发现的是，当我给分类器测试数据包含类别“dev”和“duration_plan”值时，分类器的准确性将随着我给它的“duration_plan”值越来越接近它训练数据的平均值。然而，这不是我所看到的。相反，随着“duration_plan”的值变为 0.0，分类器的准确性会提高。然而——没有duration_plan=0.0的训练向量！！为什么会这样？

然后我修改了我的 durationPlanEncoder 如下：

```
durationPlanEncoder.setProbes(2); 
```

并且准确性提高了。当我将探头数量设置为 20 和 200 时，它变得更好了。为什么？setProbes() 在做什么，这是异常情况还是我实际上应该这样做？

我的问题的最后一部分是提到，即使在设置 setProbes(20) 之后，更改测试数据中“duration_plan”的值也**不会**影响分类器的准确性——我不认为是这样应该。如果我给出的 duration_plan 值甚至不存在于任何训练数据中，因此永远不会与 =1 类相关，我希望分类器将测试样本分类为 =0。正确的？这让我觉得我一定是在编码一些完全错误的东西。任何建议表示赞赏。

Mahout 文档非常稀少。

谢谢。

# opencv - 如何使用 OpenCV 初始化多个 OpenNI 传感器

> ID：14983248
> 
> 赞同：1
> 
> 时间：2013-02-20T15:11:50.460
> 
> 标签：opencv, kinect, openni, asus-xtion

我想将两个 Asus Xtion Pro 传感器与 OpenCV (2.4.4) 一起使用，但不知道如何初始化这两个设备。

我可以像这样初始化一个：

```
VideoCapture capture;
capture.open(CV_CAP_OPENNI); 
```

如何为两个单独的传感器初始化两个 VideoCapture 实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T11:27:56.920

原来它就像这样简单：

```
VideoCapture sensor1;sensor1.open(CV_CAP_OPENNI_ASUS);
VideoCapture sensor2;sensor2.open(CV_CAP_OPENNI_ASUS+1); 
```

一个非常基本的可运行示例是：

```
#include "opencv2/core/core.hpp"
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc.hpp"

#include <iostream>

using namespace cv;
using namespace std;

int main(){
cout << "opening device(s)" << endl;

VideoCapture sensor1;sensor1.open(CV_CAP_OPENNI_ASUS);
VideoCapture sensor2;sensor2.open(CV_CAP_OPENNI_ASUS+1);

if( !sensor1.isOpened() ){
    cout << "Can not open capture object 1." << endl;
    return -1;
}

for(;;){
    Mat depth1,depth2;

    if( !sensor1.grab() ){
        cout << "Sensor1 can not grab images." << endl;
        return -1;
    }else if( sensor1.retrieve( depth1, CV_CAP_OPENNI_DEPTH_MAP ) ) imshow("depth1",depth1);

    if( !sensor2.grab() ){
        cout << "Sensor2 can not grab images." << endl;
        return -1;
    }else if( sensor2.retrieve( depth2, CV_CAP_OPENNI_DEPTH_MAP ) ) imshow("depth2",depth2);

    if( waitKey( 30 ) == 27 )   break;

   }
} 
```

# c# - C# 通过将代码移到网站外的文件夹上来跨多个网站共享代码

> ID：14983250
> 
> 赞同：1
> 
> 时间：2013-02-20T15:12:03.883
> 
> 标签：c#, asp.net, iis, web

我在根目录下的同一网络服务器上有 3 个不同的网站。3 个网站的很多代码都是相同的。

我想看看是否有办法将代码从所有 3 个网站上移一层（网站本身之外）到根目录（每个网站的文件夹都包含在其中。

前任。根目录是 c:\（我想将文件移动到每个网站并从中访问。网站本身包含在 c:\Website1、c:\Website2 等中。

那么是否可以将代码从 c:\Website1 移动到 c:\ 并从 c:\Website1 网站中的 c:\ 访问它？

如果您需要更多详细信息或我不清楚，请告诉我。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:27:35.697

我建议将库 DLL 放在[GAC](http://msdn.microsoft.com/en-us/library/yf1d93sz.aspx)中。

考虑一下：如果您需要更新库 DLL 以支持一个站点的新功能，但这会引入与其他站点的不兼容性怎么办？GAC 支持同一程序集的多个版本，因此您可以根据需要单独更新网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:17:22.763

根据您要完成的工作，将它们放置在 dll 中可能会导致。我建议将它们放在文件夹中：`c:\libs\`然后您可以通过以下方式访问它：`..\libs\`

# python - 如何通过Python执行excel操作？

> ID：14983252
> 
> 赞同：0
> 
> 时间：2013-02-20T14:35:35.503
> 
> 标签：python, windows, excel, csv

我正在做一个项目，想在我的 Windows 服务器上从 python 3 编写 excel 和 csv 文件。如果可以通过 python 实现目标，任何人都可以提供帮助吗？A HOW 将不胜感激。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:25:10.570

Python 有一个很棒的内置模块，叫做 csv，它可以帮助你处理 csv 文件。[这里](http://pymotw.com/2/csv/index.html)有示例，[Python 文档](http://docs.python.org/2/library/csv.html)（一如既往）是您的第一个/接近最佳的参考。

至于Excel，我为`xlrd`和`xlwt`模块编写了一些包装器并将它们发布在这里：[Python脚本通过自动填充列中的空格来操作excel表格](https://stackoverflow.com/questions/14567545/python-script-to-manipulate-excel-sheets-by-auto-filling-spaces-in-columns/14575047#14575047)该问题中的答案包含如何使用包装器的示例，包装器本身就是示例如何调用 xlrd 和 xlwt。我编写的包装器假定为方形表（可能带有空值），每个工作表一个表。任何比这更异国情调的东西，你就靠自己了:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:20:26.633

这是一个专门用于 python/excel 互操作的[网站](http://www.python-excel.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T15:28:29.897

[Python 有一个名为csv](http://docs.python.org/3.3/library/csv.html)的内置库。这个库可以读取 csv 文件并将它们转换为 python 数据结构，反之亦然。一个例子（来自 python 文档）：

```
import csv
with open('eggs.csv', 'w', newline='') as csvfile:
    spamwriter = csv.writer(csvfile, delimiter=' ',
                        quotechar='|', quoting=csv.QUOTE_MINIMAL)
    spamwriter.writerow(['Spam'] * 5 + ['Baked Beans'])
    spamwriter.writerow(['Spam', 'Lovely Spam', 'Wonderful Spam']) 
```

# css - 没有浮动元素的两列布局？

> ID：14983257
> 
> 赞同：11
> 
> 时间：2013-02-20T15:12:23.720
> 
> 标签：css, css-float, semantics

如何在不使用浮动的情况下并排放置 div？我问是因为我读过几次我不应该使用浮点数。或者在这种特殊情况下，浮动仍然是定位元素的最佳方式？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-20T20:27:02.737

[http://jsfiddle.net/9LaJt/](http://jsfiddle.net/9LaJt/)

你应该看看：

```
display: inline-block 
```

正如马克所说，为了避免基线对齐：

```
vertical-align: top 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:18:25.810

你有几个选择...

*   绝对定位 COL1 宽度：50% 左侧：0% COL2 宽度：50% 左侧：50%
*   固定定位“与上面相同，但会干扰滚动”
*   表格布局，即使纯粹主义者会抗议，它也会正常工作

# wpf - Wpf 样式：通过 ElementName 绑定到子属性

> ID：14983258
> 
> 赞同：7
> 
> 时间：2013-02-20T15:12:25.097
> 
> 标签：wpf, xaml

我有一个应用程序，它让我可以选择通过 RessourceDictionary 更改应用程序主题，这意味着我只能使用纯 XAML。

现在，我想做的是隐藏一个 DockPanel，它没有 ElementName，但它有一个带有 x:Name 属性的 Child。

```
<Style TargetType="DockPanel">
         <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource Self}, Path=Child.Visibility}"/>
</Style> 
```

使用此代码，我得到了 DockPanel 的第一个子项，但我想将该值绑定到具有唯一 ElementName 的特定子项。

因此，并非每个 DockPanel 都会消失，只有具有 Child 类型的 DockPanel 会消失，例如 Elementname 为“MyTextBox”的“TextBox”。

任何人都有一个想法如何做到这一点？谢谢 ;-）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-21T11:41:32.740

得到它的工作 DockPanel 有一个边框作为父级，使用此代码，我可以将此边框的可见性设置为隐藏！

```
<Style TargetType="Border">
        <Style.Triggers>
            <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Child.Children[2].Name}"
                         Value="SearchTextBox">
                <Setter Property="Visibility" Value="Hidden"/>
            </DataTrigger>
        </Style.Triggers>
    </Style> 
```

可能的改进：不要引用每个索引的文本框，遍历子...

# android - 除了过早调用 cursor.close() 之外，还有什么会导致 StaleDataException？

> ID：14983262
> 
> 赞同：12
> 
> 时间：2013-02-20T15:12:40.347
> 
> 标签：android, android-contentprovider, android-loadermanager, android-loader, staledataexception

我目前正在大量修改/重写一个Android应用程序，并且我看到了一个非常偶然的崩溃，如下所示：调用了一个`CursorAdapter`方法，它调用了`AbstractWindowedCursor#checkPosition()`，并且：

```
02-20 15:03:18.180 E/AndroidRuntime(17143): android.database.StaleDataException: Attempting to access a closed CursorWindow.Most probable cause: cursor is deactivated prior to calling this method.
02-20 15:03:18.180 E/AndroidRuntime(17143): at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:139)
02-20 15:03:18.180 E/AndroidRuntime(17143): at android.database.AbstractWindowedCursor.getLong(AbstractWindowedCursor.java:74)
02-20 15:03:18.180 E/AndroidRuntime(17143): at android.database.CursorWrapper.getLong(CursorWrapper.java:106)
02-20 15:03:18.180 E/AndroidRuntime(17143): at android.widget.CursorAdapter.getItemId(CursorAdapter.java:220) 
```

问题是，我们没有关闭任何`Cursor`s。我们所有的`Cursor`s 都来自`CursorLoader`s ，反过来又是由 a 产生的`ContentProvider`。我们从 中`Cursor`分别传递到每个中，我们在 中注册通知，我们从每个中*通知*，并且...简而言之，我找不到任何理由说明 a在使用时会关闭。`CursorAdapter``LoaderCallbacks``Cursor``ContentProvider`*`ContentResolver``insert(...)``delete(...)``update(...)``Cursor`*

 *那么： a 的*其他*原因是`StaleDataException`什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-01-06T01:40:42.220

如果您正在调用 Cursor.changeCursor(newCursor)，它将自动为您关闭旧光标。如果仍有任何东西试图访问游标，这可能会导致 android.database.StaleDataException。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-05-18T11:32:53.313

if you called `Context.managedQuery()` in android 4.0 and above, you should not call `Cursor.close()`, if you do so, `StaleDataException` will be thrown, you can modify you code as follow:

```
if(VERSION.SDK_INT < 14) {  
    cursor.close();  
} 
```*

# html - CSS3 background-image 之间 在垂直列表中

> ID：14983265
> 
> 赞同：0
> 
> 时间：2013-02-20T15:12:49.943
> 
> 标签：html, css

我有这样的列表`#menu` `<li>`：

```
<nav id="menu">
  <ul>
    <li><a>item 1</a></li>
    <li><a>item 2</a></li>
    <li><a>item 3</a></li>
    <li><a>item 4</a></li>
  </ul>
</nav> 
```

我想在每个 li 元素之后添加一个图像，并使用该`background-image: url('../img/menu_divider.png');`属性在整个列表上方添加一个图像。此外，即使在`@media only screen and (-webkit-min-device-pixel-ratio: 2)`媒体查询中将其替换为视网膜图像，我也想保持图像的大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:12:49.943

好的，所以在尝试了不同的东西之后，我发现我可以做这样的事情：

```
#menu ul > li {
  background: url('../img/menu_divider.png') no-repeat bottom left;

  -webkit-background-size: <image width> auto; /* Safari and Chrome */
  -moz-background-size: <image width> auto; /* Firefox */
  -ms-background-size: <image width> auto; /* Internet Explorer */
  -o-background-size: <image width> auto; /* Opera */
  background-size: <image width> auto; /* CSS3 */
}

@media only screen and (-webkit-min-device-pixel-ratio: 2) {
  #menu ul > li {
    background-image: url('../img/menu_divider@2x.png');
  }
} 
```

并添加此以在整个列表上方添加图像：

```
#menu ul {
  background: url('../img/menu_divider.png') no-repeat top left;

  -webkit-background-size: <image width> auto; /* Safari and Chrome */
  -moz-background-size: <image width> auto; /* Firefox */
  -ms-background-size: <image width> auto; /* Internet Explorer */
  -o-background-size: <image width> auto; /* Opera */
  background-size: <image width> auto; /* CSS3 */
}

@media only screen and (-webkit-min-device-pixel-ratio: 2) {
  #menu ul {
    background-image: url('../img/menu_divider@2x.png');
  }
} 
```

# sql - 甲骨文世界标准时间

> ID：14983266
> 
> 赞同：3
> 
> 时间：2013-02-20T15:12:50.413
> 
> 标签：sql, oracle, oracle11g, timezone

我正在尝试`TIMESTAMP WITH TIMEZONE`从 UTC-5 (NY) 的数据库中读取 Oracle 作为 UTC。

甲骨文让我发疯：

```
SELECT 
from_tz(MAX(TIMESTAMPWITHTIMEZONE),'UTC'),
SYS_EXTRACT_UTC(MAX(TIMESTAMPWITHTIMEZONE)),
SYS_EXTRACT_UTC(systimestamp), 
SYSTIMESTAMP AT TIME ZONE 'UTC'
FROM TABLE 
```

结果：

*   `SYS_EXTRACT_UTC(systimestamp)`给我：`2013-02-20 14:59:04`，这可能是正确的。

*   `SYSTIMESTAMP AT TIME ZONE 'UTC'`给我：`2013-02-20 15:59:04`这是我自己的本地柏林——随便

### 现在我想让 TIMESTAMPWITHTIMEZONE (TIMESTAMP(6)) 作为UTC

*   `SYS_EXTRACT_UTC(MAX(TIMESTAMPWITHTIMEZONE))`是`2013-02-20 08:55:01`

*   `from_tz(MAX(TIMESTAMPWITHTIMEZONE),'UTC')`是`2013-02-20 10:55:01`

严肃的。甲骨文。我想要UTC。

哪一个是正确的？或者，还有更好的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T15:39:48.757

功能不同：

*   [`SYS_EXTRACT_UTC`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions186.htm#SQLRF06119)将 a 转换`TIMESTAMP WITH TIMEZONE`为 a `TIMESTAMP`（推断但不存在时区=UTC）。
*   [`FROM_TZ`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions068.htm#i999803)将 a 转换`TIMESTAMP`为 a`TIMESTAMP WITH TIMEZONE`

这些函数在应用于单个值时通常会返回不同的结果：

```
SQL> SELECT sys_extract_utc(localtimestamp) ext,
  2         from_tz(localtimestamp, 'UTC')  from_tz
  3    FROM dual;

EXT                   FROM_TZ
--------------------- ------------------------
2013/02/20 15:34:24   2013/02/20 16:34:24 UTC 
```

在第一种情况下，`TIMESTAMP`隐**式**给出服务器的时区，然后转换为 UTC 时区的等效时间戳。请注意，通常您应该远离隐式转换。

在第二种情况下，时区之间没有计算：该`FROM_TZ`函数将地理位置添加到时间点变量中。

顺便说一句，您的示例中缺少一些内容：您不能将`FROM_TZ`函数应用于类型变量`TIMESTAMP WITH TIMEZONE`（在 9ir2 和 11ir2 上测试）：

```
SQL> select from_tz(systimestamp, 'UTC') from dual;

select from_tz(systimestamp, 'UTC') from dual

ORA-00932: inconsistent datatypes: 
   expected TIMESTAMP got TIMESTAMP WITH TIME ZONE 
```

* * *

编辑以下评论：

在您的情况下，假设您的列是 time `TIMESTAMP`，并且知道它们指的是 NY 时区，您可以使用[`AT TIME ZONE`](http://docs.oracle.com/cd/E11882_01/server.112/e10729/ch4datetime.htm#i1007699)表达式转换为`UTC`：

```
SQL> SELECT localtimestamp,
  2         from_tz(localtimestamp, 'America/New_York') AT TIME ZONE 'UTC' utc
  3    FROM dual;

LOCALTIMESTAMP        UTC
--------------------- ------------------------
2013/02/20 17:09:09   2013/02/20 22:09:09 UTC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-10T19:39:52.927

在 Oracle 18c 中，您可以使用[TO_UTC_TIMESTAMP_TZ](https://oracle-base.com/articles/18c/to_utc_timestamp_tz-function-18c?display_type=printable)函数：

> TO_UTC_TIMESTAMP_TZ 函数将表示为字符串的任何有效 ISO 8601 日期转换为 TIMESTAMP WITH TIMEZONE，可以选择将其用作 SYS_EXTRACT_UTC 函数的输入。

```
SELECT TO_UTC_TIMESTAMP_TZ(col_name)
FROM tab_name; 
```

# moq - 如何使用 Moq 和 StructureMap 模拟 ServiceStack ISession？

> ID：14983270
> 
> 赞同：5
> 
> 时间：2013-02-20T15:12:58.443
> 
> 标签：moq, structuremap, servicestack

我正在使用 ServiceStack / StructureMap / Moq。该服务调用类型为 ServiceStack.CacheAccess.ISession 的 Session。对于单元测试，我使用 Moq 创建了一个 Mock 对象，并将其添加到 StructureMap 配置中：

```
protected Mock<ISession> sessionMock = new Mock<ISession>();
ObjectFactory.Configure(
    cfg =>
       {
           cfg.For<ISession>().Use(sessionMock.Object); 
```

但是，当 Session 对象为 null 时，我并不感到惊讶——我很确定我遗漏了一步。我还需要做什么才能用模拟对象填充我的 Session 属性？

[编辑] 这是一个简单的测试场景

要测试的代码。简单的请求/服务

```
[Route("getKey/{key}")]
public class MyRequest:IReturn<string>
{
    public string Key { get; set; }
}

public class MyService:Service
{
    public string Get(MyRequest request)
    {
        return (string) Session[request.Key];
    }
} 
```

基础测试类和 MockSession 类

```
// test base class
public abstract class MyTestBase : TestBase
{
    protected IRestClient Client { get; set; }

    protected override void Configure(Container container)
    {
        // this code is never reached under any of my scenarios below
        container.Adapter = new StructureMapContainerAdapter();
        ObjectFactory.Initialize(
            cfg =>
                {
                    cfg.For<ISession>().Singleton().Use<MockSession>();
                });
    }
}

public class MockSession : ISession
{
    private Dictionary<string, object> m_SessionStorage = new Dictionary<string, object>();

    public void Set<T>(string key, T value)
    {
        m_SessionStorage[key] = value;
    }

    public T Get<T>(string key)
    {
        return (T)m_SessionStorage[key];
    }

    public object this[string key]
    {
        get { return m_SessionStorage[key]; }
        set { m_SessionStorage[key] = value; }
    }
} 
```

和测试。请参阅我在哪里看到失败的评论。我真的没想到版本 1 和 2 可以工作，但希望版本 3 可以。

```
[TestFixture]
public class When_getting_a_session_value:MyTestBase
{
    [Test]
    public void Test_version_1()
    {
        var session = ObjectFactory.GetInstance<MockSession>();
        session["key1"] = "Test";
        var request = new MyRequest {Key = "key1"};
        var client = new MyService();  // generally works fine, except for things like Session
        var result = client.Get(request);  // throws NRE inside MyService
        result.ShouldEqual("Test");
    }

    [Test]
    public void Test_version_2()
    {
        var session = ObjectFactory.GetInstance<MockSession>();
        session["key1"] = "Test";
        var request = new MyRequest {Key = "key1"};
        var client = ObjectFactory.GetInstance<MyService>();
        var result = client.Get(request);  // throws NRE inside MyService
        result.ShouldEqual("Test");
    }
    [Test]
    public void Test_version_3()
    {
        var session = ObjectFactory.GetInstance<MockSession>();
        session["key1"] = "Test";
        var request = new MyRequest {Key = "key1"};
        var client = CreateNewRestClient();
        var result = client.Get(request);  // throws NotImplementedException here
        result.ShouldEqual("Test");
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-21T21:10:30.583

看起来您正在尝试创建单元测试，但您正在使用 AppHost，就像您进行集成测试一样。[有关两者之间的差异](https://stackoverflow.com/a/14791657/85785)以及[有关测试的文档，](https://github.com/ServiceStack/ServiceStack/wiki/Testing)请参阅此先前的答案。

您可以通过在 中注册一个实例来模拟 Session `Request.Items["__session"]`，例如：

```
[Test]
public void Can_mock_IntegrationTest_Session_with_Request()
{
    using (new BasicAppHost(typeof(MyService).Assembly).Init())
    {
        var req = new MockHttpRequest();
        req.Items[SessionFeature.RequestItemsSessionKey] = 
            new AuthUserSession {
                UserName = "Mocked",
            };

        using (var service = HostContext.ResolveService<MyService>(req))
        {
            Assert.That(service.GetSession().UserName, Is.EqualTo("Mocked"));
        }
    }
} 
```

否则，如果您设置`AppHost.TestMode=true`ServiceStack 将返回`IAuthSession`在您的 IOC 中注册的内容，例如：

```
[Test]
public void Can_mock_UnitTest_Session_with_IOC()
{
    var appHost = new BasicAppHost
    {
        TestMode = true,
        ConfigureContainer = container =>
        {
            container.Register<IAuthSession>(c => new AuthUserSession {
                UserName = "Mocked",
            });
        }
    }.Init();

    var service = new MyService {
        Request = new MockHttpRequest()
    };
    Assert.That(service.GetSession().UserName, Is.EqualTo("Mocked"));

    appHost.Dispose();
} 
```

# php - 网络目录中的 Symfony 访问文件夹图像

> ID：14983271
> 
> 赞同：1
> 
> 时间：2013-02-20T15:13:00.250
> 
> 标签：php, symfony

我正在使用 Symfony 建立一个站点，但我遇到了一个小问题。我的图像存储在 /web/images/ 中，我想知道如何使用这个 php 函数 glob($imagesDir . '*.{jpg,jpeg,png,gif}', GLOB_BRACE); 获取文件列表。实际上，它返回一个空数组。

提前致谢。这是我直接从控制器使用的代码：

```
$imagesDir = $this->get('kernel')->getRootDir() . '/../web/images';
$images = glob($imagesDir . '*.{jpg,jpeg,png,gif}', GLOB_BRACE);
$json=json_encode($images); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:55:44.323

您`$imagesDir`没有尾部斜杠，`glob()`不添加它只是搜索具有 name 的文件`images*.{jpg,jpeg,png,gif}'`，更改为：

```
$imagesDir = $this->get('kernel')->getRootDir() . '/../web/images/';
$images = glob($imagesDir . '*.{jpg,jpeg,png,gif}', GLOB_BRACE);
$json=json_encode($images); 
```

它应该可以工作。

# performance - PHP 处理速度 apache 2.4 mpm-prefork mod_php 5.4 vs nginx 1.2.x PHP-FPM 5.4

> ID：14983276
> 
> 赞同：12
> 
> 时间：2013-02-20T15:13:10.500
> 
> 标签：performance, nginx, apache2, php, mod-php

我一直在寻找几天来看看是否有人做了一个好的、有记录的、PHP 处理速度比较

*   apache-mpm-prefork 2.4 和 mod_php 5.4

和

*   nginx 1.2.x + PHP-FPM 5.4

**为什么我在看：**我看到的唯一测试是 abunt 基准测试，提供整页或类似 Hello, World 的测试，但没有关于测试内容的适当文档。我不关心请求/秒数、硬件，但我确实需要查看测试了哪些 PHP 脚本以及使用了哪些确切配置。

**为什么这两个：** mod_php 被认为是处理 PHP 最快的（没有静态文件，没有请求/响应测量，只处理 PHP 本身）但从那时起发生了很多变化，包括 apache 版本。Nginx 和 PHP-FPM 占用的内存要少得多，因此更改架构是一个很好的理由，但如果在这种情况下它们不够快，那么更改将是无关紧要的。

我知道如果我找不到一个我必须自己做，但我不敢相信到目前为止没有人做过这样的测试:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-24T11:06:33.940

我已经在 CentOS 6.3 上使用 完成了这个测试`nginx 1.2.7`，`apache 2.4.3`并且`php 5.4.12`所有编译都没有更改默认值。

```
./configure
make && make install 
```

除了我启用 php-fpm 的 php

```
./configure --enable-fpm 
```

所有服务器都有 100% 的默认配置，除非如下所述。所有测试都在测试服务器上完成，测试之间没有负载和重新启动。该服务器在 RAID 1 中具有 Intel(R) Xeon(R) CPU E3-1230、1GB RAM 和 2 x 60GB SSD。测试使用运行`ab -n 50000 -c 500 http://127.0.0.1/test.php`

测试PHP脚本：

```
<?php

$testing = 0;

for ($i = 0; $i < 1000; $i++) {

    $testing++;

}

echo $testing; 
```

我还必须启用 php，`nginx.conf`因为默认情况下它没有启用。

```
location ~ \.php$ {
    fastcgi_pass   127.0.0.1:9000;
    fastcgi_index  index.php;
    fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;
    include        fastcgi_params;
} 
```

Nginx - PHP-FPM 在 127.0.0.1:9000

```
Concurrency Level:      500
Time taken for tests:   10.932 seconds
Complete requests:      50000
Failed requests:        336
   (Connect: 0, Receive: 0, Length: 336, Exceptions: 0)
Write errors:           0
Non-2xx responses:      336
Total transferred:      7837824 bytes
HTML transferred:       379088 bytes
Requests per second:    4573.83 [#/sec] (mean)
Time per request:       109.317 [ms] (mean)
Time per request:       0.219 [ms] (mean, across all concurrent requests)
Transfer rate:          700.17 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   34 338.5      0    7000
Processing:     0   34 166.5     23    8120
Waiting:        0   34 166.5     23    8120
Total:         13   68 409.2     23    9846

Percentage of the requests served within a certain time (ms)
  50%     23
  66%     28
  75%     32
  80%     33
  90%     34
  95%     46
  98%     61
  99%   1030
 100%   9846 (longest request) 
```

Nginx - 通过套接字的 PHP-FPM（配置更改为 fastcgi_pass）

```
fastcgi_pass   unix:/var/lib/php/php.sock;

Concurrency Level:      500
Time taken for tests:   7.054 seconds
Complete requests:      50000
Failed requests:        351
   (Connect: 0, Receive: 0, Length: 351, Exceptions: 0)
Write errors:           0
Non-2xx responses:      351
Total transferred:      7846209 bytes
HTML transferred:       387083 bytes
Requests per second:    7087.70 [#/sec] (mean)
Time per request:       70.545 [ms] (mean)
Time per request:       0.141 [ms] (mean, across all concurrent requests)
Transfer rate:          1086.16 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   26 252.5      0    7001
Processing:     0   24 112.9     17    3683
Waiting:        0   24 112.9     17    3683
Total:          7   50 306.4     17    7001

Percentage of the requests served within a certain time (ms)
  50%     17
  66%     19
  75%     20
  80%     21
  90%     23
  95%     31
  98%     55
  99%   1019
 100%   7001 (longest request) 
```

阿帕奇 - mod_php

```
Concurrency Level:      500
Time taken for tests:   10.979 seconds
Complete requests:      50000
Failed requests:        0
Write errors:           0
Total transferred:      9800000 bytes
HTML transferred:       200000 bytes
Requests per second:    4554.02 [#/sec] (mean)
Time per request:       109.793 [ms] (mean)
Time per request:       0.220 [ms] (mean, across all concurrent requests)
Transfer rate:          871.67 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   22 230.2      1    7006
Processing:     0   58 426.0     18    9612
Waiting:        0   58 425.9     18    9611
Total:          5   80 523.8     19   10613

Percentage of the requests served within a certain time (ms)
  50%     19
  66%     23
  75%     25
  80%     26
  90%     31
  95%     36
  98%   1012
  99%   1889
 100%  10613 (longest request) 
```

我很乐意进一步调整 apache，但似乎 apache 跟不上。明显的赢家是带有 php-fpm via socket 的 nginx。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-11-25T23:21:27.800

似乎您正在比较苹果和橙子，或者更准确地说，您正在通过调整两个变量来混淆结果。当然，将 Apache+fastcgi+php-fpm 与 nginx+php-fpm 进行比较会更明智吗？您会期望 php-fpm 部分是相同的，因此您将衡量 Apache_fastcgi 与 nginx 的优势。

# python - 每秒更新 GTK+ MenuItem 倒计时，并定期调用函数

> ID：14983279
> 
> 赞同：1
> 
> 时间：2013-02-20T15:13:18.470
> 
> 标签：python, gtk

这是我的国际空间站指示器。我正在尝试创建一个显示倒计时的 GTK MenuItem。这将在使用 AppIndicator3 的 Ubuntu Unity 指示器中。我希望此 MenuItem ( `futpass`) 每秒刷新一次（即，倒计时实时出现），但也希望它在未选择菜单时保持不活动状态，以免消耗系统资源。问题是，我不能让它自己刷新。

因为每次`checkiss`需要运行之间都有很长的等待时间，所以我还需要知道在设定的时间以最少的 CPU 唤醒来调用此函数的正确方法。

到目前为止，这是我的（粗略）代码：

```
#!/usr/bin/env python
#print time.localtime( time.time() )
import json, urllib2, time, math

#indicator
from gi.repository import Gtk
from gi.repository import AppIndicator3 as appindicator
class indicator():
    def __init__(self):
        #create indicator
        self.ind = appindicator.Indicator.new (
                        "issindicator",
                        "indicator-messages",
                        #"indicator-messages",
                        appindicator.IndicatorCategory.APPLICATION_STATUS)
        self.ind.set_status (appindicator.IndicatorStatus.ACTIVE)

        self.ind.set_attention_icon ("indicator-messages-new")

        #dropdown menu
        #now items
        self.menu = Gtk.Menu()
        self.curpass = Gtk.MenuItem("not refreshed")
        self.curpass.connect("activate", self.checkiss)
        self.menu.append(self.curpass)

        self.curpassdur = Gtk.MenuItem(" ")
        self.menu.append(self.curpassdur)

        self.curpassrise = Gtk.MenuItem(" ")
        self.menu.append(self.curpassrise)

        self.curpassset = Gtk.MenuItem(" ")
        self.menu.append(self.curpassset)

        self.sep1 = Gtk.SeparatorMenuItem()
        self.menu.append(self.sep1)

        #future items
        self.futpass = Gtk.MenuItem(" ")
        self.menu.append(self.futpass)

        self.sep2 = Gtk.SeparatorMenuItem()
        self.menu.append(self.sep2)

        #Options

        self.aboutmenu = Gtk.MenuItem("About")
        self.aboutmenu.connect("activate", self.onabout)
        self.menu.append(self.aboutmenu)

        self.quit = Gtk.MenuItem("Quit")
        self.quit.connect("activate", self.quitnow)
        self.menu.append(self.quit)

        self.curpass.show()
        self.sep1.show()
        self.futpass.show()
        self.sep2.show()
        self.aboutmenu.show()
        self.quit.show()
        self.ind.set_menu(self.menu)

        #get iss data
        self.updatecache()
        self.checkiss()

        Gtk.main()

    #define code to hide or show icon
    def hideicon(self, w=None):
        self.ind.set_status (appindicator.IndicatorStatus.PASSIVE)

    def showicon(self, w=None):
        self.ind.set_status (appindicator.IndicatorStatus.ACTIVE)

    def quitnow(self, w=None):
        Gtk.main_quit()

    def onabout(self,widget):
        widget.set_sensitive(False)
        ad=Gtk.AboutDialog()
        ad.set_name("aboutdialog")
        ad.set_version("0.1")
        ad.set_copyright('Copyrignt (c) 2013 mh00h')
        ad.set_comments('Indicating ISS Zarya')
        ad.set_license(''+
        'This program is free software: you can redistribute it and/or modify it\n'+
        'under the terms of the GNU General Public License as published by the\n'+
        'Free Software Foundation, either version 3 of the License, or (at your option)\n'+
        'any later version.\n\n'+
        'This program is distributed in the hope that it will be useful, but\n'+
        'WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n'+
        'or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for\n'+
        'more details.\n\n'+
        'You should have received a copy of the GNU General Public License along with\n'+
        'this program.  If not, see <http://www.gnu.org/licenses/>.')
        ad.set_website('https://launchpad.net/~mh00h/+archive/issindicator')
        ad.set_website_label('ISSIndicator Homepage')
        ad.set_authors(['mh00h'])
        ad.run()
        ad.destroy()
        widget.set_sensitive(True)

    def updatecache(self, w=None):
        self.passingstatus = 'not set yet'
        #get ISS data from api
        self.ip = urllib2.urlopen("http://api.exip.org/?call=ip").read()
        self.geoip = json.load(urllib2.urlopen("http://freegeoip.net/json/"+self.ip))
        self.data = json.load(urllib2.urlopen("http://api.open-notify.org/iss/?lat="+str(self.geoip["latitude"])+"&lon="+str(self.geoip["longitude"])+"&alt=280&n=27"))

    def checkiss(self, w=None):
        self.n = 0
        self.passingstatus = "The ISS is not overhead."

        #check if cache is out of date and update if needed
        if time.time() > self.data['response'][len(self.data['response'])-1]['risetime']:
            self.updatecache
        for k in self.data['response']:
            duration = self.data['response'][self.n]['duration']
            risetime = self.data['response'][self.n]['risetime']
            settime = risetime + duration
            #print risetime, time.time(), settime
            if risetime <= time.time() <= settime:
                self.showicon()
                self.passingstatus = "The ISS is overhead"
                self.curpass.get_child().set_text(self.passingstatus)
                self.curpassdur.get_child().set_text("Duration: "+
                                                     str(time.strftime('%M:%S', time.gmtime(duration)))+" ("+
                                                     str(time.strftime('%M:%S', time.gmtime(time.time()-duration)))+" remaining)")
                self.curpassdur.show()
                self.curpassrise.get_child().set_text("Rise time: "+time.strftime('%H:%M:%S', time.gmtime(risetime)))
                self.curpassrise.show()
                self.curpassset.get_child().set_text("Set time: "+time.strftime('%H:%M:%S', time.gmtime(settime)))
                self.curpassset.show()
                break
            else:
                self.n += 1

        if self.passingstatus != "The ISS is overhead":
            self.curpass.get_child().set_text(self.passingstatus)
            self.curpassdur.hide()
            self.curpassrise.hide()
            self.curpassset.hide()
            #self.hideicon()

        #regardless of isspass, show the next pass time
        if self.n != len(self.data['response']):
            self.futpass.get_child().set_text("Next Pass: "+str(time.strftime('%H:%M:%S', time.gmtime(self.data['response'][self.n]['risetime'])))+" ("+str(time.strftime('%H:%M:%S', time.gmtime(self.data['response'][self.n+1]['risetime']-time.time())))+")")
        else:
            self.futpass.get_child().set_text("Next Pass: "+str(time.strftime('%H:%M:%S', time.gmtime(self.data['response'][0]['risetime'])))+" ("+str(time.strftime('%H:%M:%S', time.gmtime(self.data['response'][0]['risetime']-time.time())))+")")

if __name__ == '__main__':
    issindicator = indicator() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T22:58:10.360

用于`gobject.timeout_add`安排回调定期发生。例如：

```
gobject.timeout_add(3600 * 1000, self.checkiss) 
```

只要返回真值，就会定期从主循环调用该函数。如果您想要一个一次性函数，只需 return`False`或允许它隐式地 return `None`。要在特定时间点安排函数，请计算从现在到该点的时间，并`timeout_add`在该时间段内调用。

激活菜单后，重新安排功能以更快地发生；停用后，再次缓慢安排。要重新调度函数，请`gobject.source_remove`使用返回的值`gobject.timeout_add`调用，然后`timeout_add`使用新的超时值调用。

gtk 主循环将确保进程不会被唤醒，除非它接收到事件，或者超时到期。

# php - 为什么运行此代码后出现 Ajax 错误？

> ID：14983283
> 
> 赞同：-2
> 
> 时间：2013-02-20T15:13:36.880
> 
> 标签：php, zend-framework, jquery, cakephp-1.3

我收到一个 ajax 错误。这是我的 buy.php 页面，用户可以在其中导航下拉菜单来选择产品。一旦他们选择它（通过 ajax），数据库中的所有内容都将被加载：

```
<?php
session_start();

$Name = $_POST['name'];
$Pass = $_POST['password'];

//STEP 1 Connect To Database
$host= "localhost";
$dbname= "register";
$user = "root";
$pass = "";

try {  
  # MySQL with PDO_MYSQL  
  $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);  
  //$DBH->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION ); 
  $STH = $DBH->query("SELECT username, password from tbl_users");
  $STH->execute();

  //STEP 2 Declare Variables

$Query = $DBH->query("SELECT * FROM tbl_users WHERE username='$Name' AND password='$Pass'");
$Query->execute();
$Query->setFetchMode(PDO::FETCH_NUM); 

$NumRows = $Query->fetch();
$_SESSION['name'] = $Name;
$_SESSION['password'] = $Pass;

//STEP 3 Check to See If User Entered All Of The Information

if(empty($_SESSION['name']) || empty($_SESSION['password']))
{
die("could not connect");
}

if($Name && $Pass == "")
{
die("Please enter  a name and password!");
}

if($Name == "")
{
die("Please enter your name!" . "</br>");
}

if($Pass == "")
{
die("Please enter a password!");
echo "</br>";
}

//STEP 4 Check Username And Password With The MySQL Database

if($NumRows != 0)
{

$STH->setFetchMode(PDO::FETCH_ASSOC); 
while($Row = $STH->fetch())
{
$dname = $Row['username'];
$dpass = $Row['password'];

}

}
else
{
 if( $_SESSION['name']!= $dname || $_SESSION['password'] != $dpass) 
 {
    header("location: login.php");
  } 

}

if($Name == $dname && $Pass == $dpass)
{
// If The User Makes It Here Then That Means He Logged In Successfully
echo "Hello " . $Name . "!";
}
}  

catch(PDOException $e) {  
    echo "I'm sorry, database connection is wrong.";  
    $e->getMessage(); 
}
?>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
<script>
  $(document).ready(function(){
    $('#pro').bind('change', function (e){
    var value = $(this).val();
     e.preventDefault(e)

      $.ajax({
        type: 'GET',
       url: 'product.php',
       data: value,
      dataType: 'html',
      success: function( msg ){
       $('#products').html(msg);
     });

    });
  });
  </script>

</head>
<body>
<p>
<select id="pro">
<?php
$STH = $DBH->query("SELECT productID, productName, productImage, productPrice from tbl_products");
$STH->setFetchMode(PDO::FETCH_ASSOC); 
while($PRow = $STH->fetch())
{
$Pid = $PRow['productID'];
$Pname = $PRow['productName'];
$Pimage = $PRow['productImage'];
$Pimage = $PRow['productPrice'];
echo "<option value='$Pid'>".$Pname. "</option>";
}
?>
</select>
</p>

<div id="products"></div>
</body>
</html> 
```

这是我的产品页面，其中查询字符串通过 ajax 传递并在 buy.php 页面中加载内容：

```
<?php
session_start();

$Name = $_POST['name'];
$Pass = $_POST['password'];

//STEP 1 Connect To Database
$host= "localhost";
$dbname= "register";
$user = "root";
$pass = "";

try {  
  # MySQL with PDO_MYSQL  
  $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);  
  //$DBH->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION ); 
  $STH = $DBH->query("SELECT username, password from tbl_users");
  $STH->execute();

  //STEP 2 Declare Variables

$Query = $DBH->query("SELECT * FROM tbl_users WHERE username='$Name' AND password='$Pass'");
$Query->execute();
$Query->setFetchMode(PDO::FETCH_NUM); 

$NumRows = $Query->fetch();
$_SESSION['name'] = $Name;
$_SESSION['password'] = $Pass;

//STEP 3 Check to See If User Entered All Of The Information

if(empty($_SESSION['name']) || empty($_SESSION['password']))
{
die("could not connect");
}

if($Name && $Pass == "")
{
die("Please enter  a name and password!");
}

if($Name == "")
{
die("Please enter your name!" . "</br>");
}

if($Pass == "")
{
die("Please enter a password!");
echo "</br>";
}

//STEP 4 Check Username And Password With The MySQL Database

if($NumRows != 0)
{

$STH->setFetchMode(PDO::FETCH_ASSOC); 
while($Row = $STH->fetch())
{
$dname = $Row['username'];
$dpass = $Row['password'];

}

}
else
{
 if( $_SESSION['name']!= $dname || $_SESSION['password'] != $dpass) 
 {
    header("location: login.php");
  } 

}

if($Name == $dname && $Pass == $dpass)
{
// If The User Makes It Here Then That Means He Logged In Successfully
echo "Hello " . $Name . "!";
}
}  

catch(PDOException $e) {  
    echo "I'm sorry, database connection is wrong.";  
    $e->getMessage(); 
}
?>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
<script>
  $(document).ready(function(){
    $('#pro').bind('change', function (e){
    var value = $(this).val();
     e.preventDefault(e)

      $.ajax({
        type: 'GET',
       url: 'product.php',
       data: value,
      dataType: 'html',
      success: function( msg ){
       $('#products').html(msg);
     });

    });
  });
  </script>

</head>
<body>
<p>
<select id="pro">
<?php
$STH = $DBH->query("SELECT productID, productName, productImage, productPrice from tbl_products");
$STH->setFetchMode(PDO::FETCH_ASSOC); 
while($PRow = $STH->fetch())
{
$Pid = $PRow['productID'];
$Pname = $PRow['productName'];
$Pimage = $PRow['productImage'];
$Pimage = $PRow['productPrice'];
echo "<option value='$Pid'>".$Pname. "</option>";
}
?>
</select>
</p>

<div id="products"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T12:58:53.020

AJAX 列表的属性列表缺少括号。基本上，*成功*函数没有正确关闭，导致 JavaScript 中断。

`}`请注意以下代码段中的额外内容：

```
 $.ajax({
    type: 'GET',
    url: 'product.php',
    data: value,
    dataType: 'html',
    success: function( msg ) {
      $('#products').html(msg);
    }
  }); 
```

# jquery - jQuery UI Datepicker - 在 min/maxdate 中排除禁用日期

> ID：14983284
> 
> 赞同：3
> 
> 时间：2013-02-20T15:13:39.333
> 
> 标签：jquery, jquery-ui, datepicker, jquery-ui-datepicker

我正在使用 jQuery UI 日期选择器，并在 beforeShowDay 上使用 noWeekends 方法来禁用周末的选择。与此相结合，我想设置从今天开始的 5 天和 -5 天的最小和最大日期。

我遇到的问题是，我不希望周末包含在这 5 天的跨度中。我希望它是 5 SELECTABLE 天的最小值和最大值，而不是一般的天数。我只希望在 min 和 maxdate 范围内计算未禁用的日期。

示例：如果在过去 45 天内有 2 天禁用，则 45 的 Mindate 实际上是 47（如果包括禁用日期）。

[http://jsfiddle.net/corydorning/8mp5W/](http://jsfiddle.net/corydorning/8mp5W/)

```
// what I need
$('.date').datepicker({
    maxDate: 5, // 5 selectable days
    minDate: -5, // -5 selectable days
    beforeShowDay: $.datepicker.noWeekends
}); 
```

注意：我正在寻找一种适用于任何禁用日期的解决方案，而不仅仅是周末。我只是在这个例子中使用了周末，因为它是最容易表示的并且是 jQuery UI 内置的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:43:58.250

像这样编辑`beforeShowDay`函数：

```
$('.date').datepicker({
    maxDate: 5,
    minDate: -5,
    beforeShowDay: function (date) {
        var day = date.getDay();
        //disable Tuesdays
        return [(day != 2), ""];
    }
}); 
```

在这里看小提琴：http: [//jsfiddle.net/8mp5W/1/](http://jsfiddle.net/8mp5W/1/)

使用该范例，您应该能够创建一个您不希望显示的日期列表（与仅周二等相比）。

我认为这回答了您关于如何获得自定义可用日期的能力的问题。

## 编辑

以下 javascript`minDate`通过从今天的日期向后计数并在`[0,6]`运行计数时跳过周末日期来设置。它会在达到您想要的 # 天后停止。

它可以变得更高效，并且应该被参数化等，但我将把调整和定制留给你。查找`maxDate`将以相同的方式工作，但将日期提前。

```
$(window).load(function(){
  $('.date').datepicker({
    minDate: findMin (),
    beforeShowDay: $.datepicker.noWeekends
  });
});

function findMin () {
        var today = new Date();
        var invalidWeekdays = [0,6]; //weekdays to disregard
        var validDaysPrior = 5; //number of days to count back

        var i = 0;
        while (i < validDaysPrior) {
           today.setDate(today.getDate()-1); //decrement day
           console.log("today is", today);
           var todayWeekday = today.getDay();
           if ( jQuery.inArray(todayWeekday, invalidWeekdays) < 0 ) {
               console.log(todayWeekday + " is valid");
               i++;
           } else {
               console.log(todayWeekday + " is NOT valid");
           }
        }
        console.log(validDaysPrior + " valid days ago occurred on " + today);
        return today;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-11T07:43:42.370

您可以尝试以下代码： get_date() 在我的代码中通过 ajax 调用。你可以创建一个数组。然后在那里输入一个日期。

```
window.natDays = [];
$.ajax({
  type : "POST",
  async : false,
  url : rootPath + '/get_date',
  data : "ajax=true",
  success : function(msg) {
    var a = $.parseJSON(msg);
    $i = 0;
    $.each(a, function(key, value) {
      arr = (value.Date['date']).split('-');
      arr2[key] = new Array(value.Date['month'], arr[2],
          value.Date['occassion']);
    });
    natDays = arr2;
  }
});
var dateMaxforswitch = new Date();
dateMinforswitch.setDate(dateMinforswitch.getDate()
    + (dateMinforswitch.getHours() >= 17 ? 1 : 0));
dateMaxforswitch.setDate(dateMaxforswitch.getDate()
    + (dateMaxforswitch.getHours() >= 17 ? 1 : 0));
AddBusinessDays(dateMaxforswitch, 25);

function AddBusinessDays(curdate, weekDaysToAdd) {
  while (weekDaysToAdd > 0) {
    curdate.setDate(curdate.getDate() + 1);
    // check if current day is business day
    if (noWeekendsOrHolidays(curdate)[0]) {
      weekDaysToAdd--;
    }
  }
}

function noWeekendsOrHolidays(date) {
  var noWeekend = $.datepicker.noWeekends(date);
  if (noWeekend[0]) {
    return nationalDays(date);
  } else {
    return noWeekend;
  }
}
function nationalDays(date) {
  for (i = 0; i < natDays.length; i++) {// alert(natDays[i][2]);
    if (date.getMonth() == natDays[i][0] - 1 && date.getDate() == natDays[i][1]) {
      return [ false, natDays[i][2] + '_day' ];
    }
  }
  return [ true, '' ];
} 
```

# java - #break 语句不起作用

> ID：14983287
> 
> 赞同：2
> 
> 时间：2013-02-20T15:13:46.113
> 
> 标签：java, velocity, break

我目前需要编写一些 Velocity 代码，这对我来说是新的。但是现在，我遇到了一个奇怪的错误。不是让我当前的#foreach 循环，而是显示#break 语句，就好像它是内容一样。这是我的代码：

```
<div id="posterWall2" class="bloc_home" style="float:left; width:758px; height:368px; margin:20px 0px 0px 0px;">
    <p class="titre">Salons Professionels</p>
    <ul class="list_salonspros">
         #if($postersSmall&&$postersSmall.size()>0)
             #foreach($content in $postersSmall)
                 #if ($velocityCount > 4)
                      ##this break is not working!
                      #{break} 
                 #end
                 <li>
                     <a href="$content.manifURL"><div style="width:172px; height:240px;"><img style="max-width:100%; max-height:100%;" src="$content.afficheURL"></div>
                     </a>
                 </li>
             #end
         #end
    </ul>
    <a class="btnspectacles" href="#">Spectacles</a>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:23:31.680

~~不是 100% 肯定，但我认为它应该`#break`代替`#{break}`.~~

此外，`#break`仅在 1.6 版（[请参阅此处](https://issues.apache.org/jira/browse/VELOCITY-612)）上添加了对的支持，因此如果您使用的是以前的版本，我猜它可能只是将其打印为内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:40:16.177

我终于找到了解决方案。由于之前的 pom.xml 问题，我们的 Tomcat 服务器的 lib 目录中有 2 个 Velocity jar。第一个用于 1.5 版，第二个用于 1.7。并且Tomcat可能加载了1.5版本，因此无法正常工作。

奇怪的是：如果我在 condition 中用 10 替换 4 `#if ($velocityCount > 4)`，我在代码中的另一个地方这样做，即使使用 1.5 版本，它也能完美运行。我还是不明白为什么...

# vb.net - 模板 T4 类型 xdocument 未定义

> ID：14983289
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:13:48.137
> 
> 标签：vb.net, templates

执行模板 T4 时出现此错误：“类型 xdocument 未定义”！！！

这是我的 T4 代码：

```
<#@ template debug="false" hostspecific="false" language="VB" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Xml.Linq.XDocument" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".txt" #>

<# dim xx as new XDocument#> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:57:35.667

您已导入`System.Xml.Linq.XDocument`.

这里的 XDocument 是类，因此您只想导入其所在的名称空间，而不是类本身，因此只需 import `System.Xml.Linq`。

此外，您需要包含对`System.Xml.Linq`. 在模板的情况下，这是使用`assembly`语句完成的（就像您已经拥有的那样 for `System.Core`）。

所以你需要在顶部包含这个：

```
<#@ assembly name="System.Xml" #>
<#@ assembly name="System.Xml.Linq" #> 
```

（包括 System.Xml 是为了安全起见——您可能会在某些时候使用该库中的某些内容）。

# c++ - 具有奇怪对齐要求的打包字节数组

> ID：14983290
> 
> 赞同：1
> 
> 时间：2013-02-20T15:13:48.773
> 
> 标签：c++, c, memory-management, bytearray, gpu

假设您有 32 个线程和 32 条数据供每个线程独立操作，例如

```
struct data
{
  unsigned short int N;
  char *features;  //array length N
  uint *values;  //array length N
};

data alldata[32]; 
```

假设这些线程的共享内存被“分区”为 32 个“banks”，其中每个 bank 为 4 个字节宽。 **每个线程都可以并行读取其对应的“bank”，但如果线程尝试同时访问同一个 bank，则读取操作会串行化。**

```
bank      |        0        |         1       |         2        |   .....
bytes     |  0   1   2   3  |  4   5  6   7   |  8   9   10  11  |  ....
bytes     | 128 129 130 131 | 132 133 134 135 | 136 137 138 139  |  ...
...............
...............
threads   |       0         |         1       |         2        |   ..... 
```

（这种奇异的情况被称为 GPU 计算）。

因此，为了最大程度地并行化：（就上图而言）alldata[0] 的成员变量只能写入第一列中的字节。alldata[1] 的变量成员到第二列等。等效地，

换句话说，我必须将 的内容`alldata[32]`写入一个动态数组，其中的成员变量`alldata[j]`以 4 字节的间隔写入每个`32*4`字节一次。然后，当我将此动态数组复制到线程的共享内存中时，它将为银行正确对齐。

**问题：** 是否有人知道任何类型的包可以将变量写入具有适当间距的字节数组，如上所述（每个`32*4`字节一次）？

这是一个绝望的问题...

# excel - 修改循环

> ID：14983304
> 
> 赞同：0
> 
> 时间：2013-02-20T15:14:09.860
> 
> 标签：excel, vba

我有以下代码：

```
Case "END-BOX"
    EndBox = ActiveCell.Row
    Selection.Offset(-1, 2).Select
    Selection.ClearContents
    Rows(2).Insert Shift:=xlDown
    TotalCols = ActiveSheet.UsedRange.Columns.Count
    Col = 4

    Cells(EndBox, Col).Select

    For i = EndBox To 1 Step -1
        If Cells(i, Col).Value <> "" Then
            n = n + 1
        Else
            Cells(i, Col).Value = n
            Cells(i, Col).Interior.ColorIndex = 4
            n = 0
        End If
    Next

    Range(EndBox).Select
    Selection.Offset(1, -2).Select 
```

它导致绿色单元格出现在结束框行以及新框行上。我只希望新框线着色。有什么方法可以修改代码以使其做到这一点？

[这](http://wikisend.com/download/322866/Stock%20Sheet%20Copy.xls)是我的工作簿。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:32:31.390

我建议使用 Autofilter 而不是 Looping。您正在检查 Col B 中的“新框”，因此请使用此代码。

```
Dim lRow As Long
Dim rng As Range

With Sheets("Spare")
    '~~> Remove any filters
    .AutoFilterMode = False

    lRow = .Range("B" & .Rows.Count).End(xlUp).Row

    With .Range("B1:B" & lRow) 'Filter, offset(to exclude headers)
        .AutoFilter Field:=1, Criteria1:="NEW-BOX"
        Set rng = .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow
        rng.Interior.ColorIndex = 4
    End With

    '~~> Remove any filters
    ActiveSheet.AutoFilterMode = False
End With 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:17:12.487

去掉上面写着的那一行：

`Cells(i, Col).Interior.ColorIndex = 4`

这是设置单元格颜色的线。

要仅对 B 列中带有“new-box”的行着色，请将该行更改为：

`If Cells(i, Col).Offset(0, -2).Value = "new-box" Then Cells(i, Col).Interior.ColorIndex = 4`

注意：这不会撤消之前应用的颜色格式。

# delphi - 在 Delphi FireMonkey 中寻找第 3 方选项卡控件

> ID：14983311
> 
> 赞同：0
> 
> 时间：2013-02-20T15:14:31.460
> 
> 标签：delphi, tabcontrol, firemonkey

我正在寻找[Raize](http://www.raize.com/DevTools/RzComps/Default.asp)组件的选项卡控件的替代方法。

我希望能够在每个页面的顶部添加关闭按钮，并且我想在标签上使用倾斜的标签和颜色。哦，我正在使用 FireMonkey 2。

//我知道raize不支持firmonkey。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T17:31:32.553

Firemonkey`TTabControl`在`Common Controls`页面中有它自己的（默认情况下）。您可以使用`TStylebook`. 例如，我很有信心可以在选项卡本身上添加一个关闭按钮。

毕竟，FMX 是一个基于矢量的框架，所以所有的视觉元素都必须存在于样式中。为此，您可能希望将样式加载到 TStylebook 中，因为我无法找到将默认样式加载到其中的方法。向下导航到`tabitemstyle`，从那里您将能够调整它的视觉外观。只需根据需要添加关闭按钮（对齐、布局等）。

回到您的应用程序代码中，您将寻找使用`FindStyleResource`例程来设置代码（XE2 使用`FindBinding`，因此您将设置`BindingName`属性）。我将假设您的关闭按钮称为“关闭按钮”（不带引号）；

```
var
  MyTab : TTabItem;
begin
  MyTab := ((TabItem1 as TTabItem).FindStyleResource('CloseButton') as TButton).OnClick := TabClose;
end; 
```

您希望在最初创建选项卡时添加该代码，或者如果在设计时创建所有选项卡，您需要在 FormCreate 中运行它。您基本上是在告诉它，当单击 CloseButton 时，您想要调用 notify event/procedure `TabClose`。此过程与单击按钮相同。

您甚至可以`StyleName`将选项卡的属性更改为`CloseButton`+Index_of_tab。

现在，至于关闭选项卡本身的代码，类似这个**未经测试的示例**可能会起作用，尽管您需要对其进行迭代。

```
procedure TForm1.TabClose(Sender: TObject);
var
  _mytab : Integer;
  _activetab : Integer;
begin
  _activetab := ((Sender as TTabItem).Parent as TTabControl).ActiveTab.Index;
  _mytab := ((Sender as TTabItem).Parent as TTabControl).ActiveTab.Index;
  ((Sender as TTabItem).Parent as TTabControl).Tabs[_MyTab].Free;
  ((Sender as TTabItem).Parent as TTabControl).TabIndex := _activetab;
end; 
```

现在，这是聪明的部分，并利用了框架的设计。当您单击另一个元素内的样式元素时，默认情况下，它将选择父元素。在此示例中，它将选择包含用户单击的关闭按钮的选项卡。然后，它将关闭该选项卡（从技术上讲，它会释放它，我在开发中没有过多地处理选项卡，因此您需要研究“关闭”它们的正确方法）。

但是，这有一个问题；如果您希望切换回之前活动的选项卡，您可能希望找到一种更好的方法来检测以前的活动选项卡。现在，它只会打开您刚刚关闭的选项卡之后的选项卡（由于选项卡计数现在减少 1，因此活动选项卡索引选择下一个物理选项卡）。您可能可以通过将`_activetab`代码拆分到其他地方来做到这一点。

* * *

我用自己的一些程序做过类似的事情，这就是我通常创建“混合”组件的方式。您实质上是在利用框架的模块化设计，使其做您想做的事情，而不必依赖第三方组件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:24:28.157

由于 FMX 是一个非常年轻的框架，因此支持它的第三方组件供应商并不多。

我还没有看到任何用于 FMX 的第 3 方 TabControl 组件，快速的 Google 搜索表明没有。所以你可能不走运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-13T00:25:34.803

我知道这是一个旧查询，但如果有人仍在寻找带有关闭按钮和倾斜标签边的标签，请查看 TMSSoftware 的 TTMSFMXTabSet。我在当前的开发项目中使用它，它工作正常。

# ruby-on-rails - 使用 rjs 设置字段的值

> ID：14983317
> 
> 赞同：0
> 
> 时间：2013-02-20T15:14:44.850
> 
> 标签：ruby-on-rails, rjs

我需要使用 rjs 在我的表单中设置字段的值。

该字段在我的表单中出现了两次，我只想设置在特定 div 中找到的字段的值。

下面的代码似乎不起作用。

```
page[:mydiv_id][:book_bk_title].value = "myvalue" 
```

我的问题是如何通过指定包含字段的 div 来设置字段的值。使用 rjs？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:38:14.527

如果您使用的是 Jquery：

```
var div_id = "mydiv";
$("#"+div_id+" :input[ID^='input_id']").val('Field Value'); 
```

# computer-vision - 交通运动识别

> ID：14983320
> 
> 赞同：1
> 
> 时间：2013-02-20T15:14:52.027
> 
> 标签：computer-vision, motion-detection

我正在尝试构建一个简单的交通运动监视器来估计移动车辆的平均速度，并且我正在寻找有关如何使用 OpenCV 或其他您可能为此目的推荐的开源软件包的指导。有什么特别适合这个问题的好资源吗？

我希望的设置是在相关道路旁边的高层建筑上安装网络摄像头，并将摄像头指向移动的交通。相机高度将在 20 英尺到 100 英尺之间，建筑物距离道路 20 英尺到 500 英尺之间。

感谢您的输入！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T00:50:43.023

一般来说，您需要一种检测汽车的方法，以便在视频帧中获取它们的 2D 坐标。您可能希望使用跟踪器来加快流程并利用车辆的可预测运动。您还需要一种校准相机的方法，以便将图像中的 2D 坐标转换为深度信息，以便估算速度。

所以第一步，看看检测器，如可变形零件模型 DPM，以及检测方法的跟踪。您可能需要从 Matlab 移植一些代码（如果需要，请使其可用:-)）。如果这太慢，可以对前景斑点进行一些分割，并使用粒子滤波器或卡尔曼滤波器跟踪颜色直方图或 HOG 描述符以预测运动。

# android - 将 ImageView 放置在特殊位置

> ID：14983330
> 
> 赞同：0
> 
> 时间：2013-02-20T15:15:26.887
> 
> 标签：android, layout, position, imageview

这个问题可能看起来很基本，但我找不到答案。

我需要将 imageView 放置在屏幕中的特殊位置。假设，我需要它位于屏幕顶部的十分之三和屏幕左侧的五分之一。

首先想到的是使用 AbsoluteLayout 并使用绝对坐标放置 imageView。然而，这种方法在使用不同的屏幕尺寸时会导致问题。问题是我无法在 xml 文件中获取屏幕尺寸（宽度和高度），另一方面，我找不到用于 ImageView 的 setX() / setY() 或类似方法以编程方式执行此操作。

解决这个问题的一个想法是使用 LinearLayout 而不是 AbsoluteLayout 并插入虚拟视图（如 textVies）来填充我想要的 imageView 后面或上方的空间。但是，如果我有多个图像视图要放置在屏幕中并且所需的位置未对齐，这会变得复杂。另一种解决方案是使用填充或边距，但它不适用于 AbsoluteView。

我不需要 imageView 与其他视图处于相对位置，我只需要它位于屏幕中的特殊位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T10:48:19.977

虽然它说 AbsoluteLayout 已被弃用，但这段代码对我有用：

```
 AbsoluteLayout.LayoutParams lp=new AbsoluteLayout.LayoutParams(width,height,x,y);
    myImageView.setLayoutParams(lp); 
```

# ruby-on-rails - 如何调用另一个控制器的方法

> ID：14983333
> 
> 赞同：3
> 
> 时间：2013-02-20T15:15:32.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我需要从另一个控制器调用方法。什么是最好的方法？例如：

catalogues_controller.rb

```
class Site::CataloguesController < ApplicationController
  respond_to :js, :html

  def index
    produc_list # call method other controller
  end
end 
```

other_controller.rb

```
class OtherController < ApplicationController

  respond_to :js, :html

  def produc_list
     myObj = Catalagues.find(params[:id])
     render :json => myObj
  end
end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T15:53:01.520

You could implement a module, and include it in your Controller.

Let's call this module "Products Helper":

```
# In your app/helpers
# create a file products_helper.rb
module ProductsHelper

  def products_list(product_id)
    catalague = Catalagues.where(id: product_id).first
    render :json => catalague
  end

end 
```

And then, in the controllers you need to use this method:

```
class Site::CataloguesController < ApplicationController
  include ProductsHelper

  respond_to :js, :html

  def index
    products_list(your_id) # replace your_id with the corresponding variable
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-08T08:20:37.343

您可以直接在控制器的方法上调用调度。传入一个 ActionDispatch::Response 实例，它将填充响应。假设在此示例中为 json 响应：

```
def other_controller_method
  req = ActionDispatch::Request.new(request.env)
  resp = ActionDispatch::Response.new
  YourControllerClass.dispatch(:your_controller_method_name, req, resp)
  render json: resp.body, status: resp.status
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:53:38.873

如果您有 RESTful 路由（并且可以访问它们附带的辅助方法），那么您应该能够使用 redirect_to 重定向到您想要调用的任何操作，

```
#  something like... controller_name_action_name_url 

#  In your case, in the catalouges/index method
#  Note this also assumes your controller is named 'other'
   redirect_to others_product_list_url(product_id) 
```

# c - 非阻塞 connect() 和 EINTR

> ID：14983335
> 
> 赞同：1
> 
> 时间：2013-02-20T15:15:41.513
> 
> 标签：c, sockets, connect, select-function

我正在使用来自 Stevens 的 connect_nonb()，UNIX 网络编程：

```
int
connect_nonb(int sockfd, const SA *saptr, socklen_t salen, int nsec)
{
    int                     flags, n, error;
    socklen_t               len;
    fd_set                  rset, wset;
    struct timeval  tval;

    flags = Fcntl(sockfd, F_GETFL, 0);
    Fcntl(sockfd, F_SETFL, flags | O_NONBLOCK);

    error = 0;
    if ( (n = connect(sockfd, saptr, salen)) < 0)
            if (errno != EINPROGRESS)
                    return(-1);

    /* Do whatever we want while the connect is taking place. */

    if (n == 0)
            goto done;      /* connect completed immediately */

    FD_ZERO(&rset);
    FD_SET(sockfd, &rset);
    wset = rset;
    tval.tv_sec = nsec;
    tval.tv_usec = 0;

    if ( (n = Select(sockfd+1, &rset, &wset, NULL,
                                     nsec ? &tval : NULL)) == 0) {
            close(sockfd);          /* timeout */
            errno = ETIMEDOUT;
            return(-1);
    }

    if (FD_ISSET(sockfd, &rset) || FD_ISSET(sockfd, &wset)) {
            len = sizeof(error);
            if (getsockopt(sockfd, SOL_SOCKET, SO_ERROR, &error, &len) < 0)
                    return(-1);                     /* Solaris pending error */
    } else
            err_quit("select error: sockfd not set");

done:
    Fcntl(sockfd, F_SETFL, flags);  /* restore file status flags */

    if (error) {
            close(sockfd);          /* just in case */
            errno = error;
            return(-1);
    }
    return(0);
} 
```

此函数允许 connect() 的自定义超时。如果在 select() 中阻塞等待连接成功时，接收到信号，则 select() 以 -1 (EINTR) 退出。此时 select() 超时尚未到期，连接未成功（即目标主机可能断开连接）但随后的 getsockopt() 没有返回错误。

getsockopt() 应该返回错误还是应该由 Stevens 代码检查 select() 的返回码（和 errno）？

当前，当连接到不存在的主机并且信号中断 select() 时，此函数会错误地返回成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:55:44.810

我不确定是什么`Select()`。我认为它是某种薄包装`select()`。

在大多数应用程序中，无论何时`select()`因.`EINTR``select()``select()`

本案也不例外。`select()`应该在一个循环中。

# c# - Guid.NewGuid() VS 来自 Random.Next() 的随机字符串生成器

> ID：14983336
> 
> 赞同：27
> 
> 时间：2013-02-20T15:15:48.337
> 
> 标签：c#, random, guid

我的同事和我正在讨论这些方法中的哪一种用于自动生成用户 ID 和发布 ID 以在数据库中进行识别：

一个选项使用 Random 的单个实例，并采用一些有用的参数，因此它可以用于各种字符串生成情况（即从 4 位数字引脚到 20 位字母数字 ID）。这是代码：

```
// This is created once for the lifetime of the server instance
class RandomStringGenerator
{
    public const string ALPHANUMERIC_CAPS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
    public const string ALPHA_CAPS = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    public const string NUMERIC = "1234567890";

    Random rand = new Random();
    public string GetRandomString(int length, params char[] chars)
    {
        string s = "";
        for (int i = 0; i < length; i++)
            s += chars[rand.Next() % chars.Length];

        return s;
    }
} 
```

另一种选择是简单地使用：

```
Guid.NewGuid(); 
```

请参阅[MSDN 上的 Guid.NewGuid](http://msdn.microsoft.com/en-us/library/system.guid.newguid.aspx)

我们都知道这`Guid.NewGuid()`可以满足我们的需求，但我宁愿使用自定义方法。它做同样的事情，但有更多的控制权。

我的同事认为，因为自定义方法是我们自己炮制出来的，所以更容易产生冲突。我承认我并不完全了解 Random 的实现，但我认为它与 Guid.NewGuid() 一样随机。自定义方法的典型用法可能是：

```
RandomStringGenerator stringGen = new RandomStringGenerator();
string id = stringGen.GetRandomString(20, RandomStringGenerator.ALPHANUMERIC_CAPS.ToCharArray()); 
```

**编辑1：**

*   我们正在使用没有自动增量（或类似）功能来生成密钥的 Azure 表。
*   这里的一些答案只是告诉我使用 NewGuid() “因为这就是它的用途”。我正在寻找一个更深入的原因，说明为什么在与 Guid 具有相同自由度的情况下，熟化的方法更有可能产生碰撞。

**编辑2：**

我们还使用成熟的方法来生成帖子 ID，与会话令牌不同，它需要看起来很漂亮才能在我们网站的 url 中显示（如[http://mywebsite.com/14983336](http://mywebsite.com/14983336)），所以这里不可以选择 guid ，但是仍然要避免碰撞。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-02-20T16:27:19.913

> 我正在寻找一个更深入的原因来解释为什么在与 Guid 具有相同的自由度的情况下，熟化的方法更有可能产生碰撞。

首先，正如其他人所指出的，`Random`它不是线程安全的；从多个线程中使用它可能会导致它破坏其内部数据结构，因此它总是产生相同的序列。

二`Random`是根据当前时间播种。`Random`在同一毫秒内创建的两个实例（回想一下，在现代硬件上，一毫秒是几*百万*个处理器周期）将具有相同的种子，因此将产生相同的序列。

第三，我撒谎。`Random`不是根据当前时间播种的；它是根据*机器活动的时间量*播种的。种子是一个 32 位的数字，由于粒度以毫秒为单位，因此只需几周时间即可完成。但这不是问题。问题是：**您创建该实例的时间段`Random`很可能在机器启动后的几分钟内。**每次重启机器或在集群中使新机器联机时，都会有一个小窗口在其中创建 Random 实例，并且发生的越多，获得种子的可能性就越大你以前有的。

（更新：.NET 框架的较新版本已经缓解了其中一些问题；在这些版本中，您不再让`Random`在同一毫秒内创建的每个都具有相同的种子。但是仍然存在许多问题`Random`；请始终记住，它只是伪-random, not crypto-strength random.`Random`实际上是非常可预测的，所以如果你依赖不可预测性，它是不合适的。）

正如其他人所说：如果您想要数据库的主键，那么*让数据库为您生成主键*；让数据库完成它的工作。如果您想要一个全局唯一标识符，请**使用 guid**；这就是他们的目的。

最后，如果您有兴趣了解更多关于 guid 的使用和滥用的信息，那么您可能想阅读我的“guid guide”系列；第一部分在这里：

[http://blogs.msdn.com/b/ericlippert/archive/2012/04/24/guid-guide-part-one.aspx](http://blogs.msdn.com/b/ericlippert/archive/2012/04/24/guid-guide-part-one.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-21T11:50:28.087

正如在其他答案中所写，我的实现有一些严重的问题：

*   **线程安全：**随机不是线程安全的。
*   **可预测性：**由于 Random 类的性质，该方法不能用于会话令牌等安全关键标识符。
*   **冲突：**尽管该方法创建了 20 个“随机”数字，但发生冲突的概率并不是`(number of possible chars)^20`因为种子值只有 31 位，并且来自错误的来源。给定相同的种子，*任何*长度的序列都是相同的。

`Guid.NewGuid()`会很好，除了我们不想在 url 中使用丑陋的 GUID 和 .NETs NewGuid() 算法不知道在会话令牌中使用加密安全 - 如果知道一点信息，它可能会给出可预测的结果。

这是我们现在使用的代码，它安全、灵活，据我所知，如果给定足够的长度和字符选择，它不太可能产生冲突：

```
class RandomStringGenerator
{
    RNGCryptoServiceProvider rand = new RNGCryptoServiceProvider();
    public string GetRandomString(int length, params char[] chars)
    {
        string s = "";
        for (int i = 0; i < length; i++)
        {
            byte[] intBytes = new byte[4];
            rand.GetBytes(intBytes);
            uint randomInt = BitConverter.ToUInt32(intBytes, 0);
            s += chars[randomInt % chars.Length];
        }
        return s;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-20T15:22:02.827

“自动生成用户 ID 和帖子 ID 以在数据库中识别”...为什么不使用数据库序列或身份来生成密钥？

对我来说，您的问题实际上是：“在我的数据库中生成主键的最佳方法是什么？” 如果是这种情况，您应该使用数据库的常规工具，该工具可以是序列或身份。这些比生成的字符串有好处。

1.  序列/身份索引更好。有许多文章和博客文章解释了为什么 GUID 等会导致索引不佳。
2.  保证它们在表中是唯一的
3.  它们可以通过并发插入安全地生成而不会发生冲突
4.  它们易于实施

我想我的下一个问题是，您考虑 GUID 或生成的字符串的原因是什么？您会跨分布式数据库进行集成吗？如果没有，你应该问问自己，你是否正在解决一个不存在的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-20T15:45:21.527

您的自定义方法有两个问题：

1.  它使用 的全局实例`Random`，但不使用锁定。=> 多线程访问可能会破坏其状态。之后，输出将比现在更糟。
2.  它使用可预测的 31 位种子。这有两个后果：
    *   在不可猜测性很重要的情况下，您不能将其用于任何与安全相关的事情
    *   小种子（31 位）会降低数字的质量。例如，如果您`Random`同时创建多个实例（自系统启动以来），它们可能会创建相同的随机数序列。

`Random`这意味着无论多长时间，您都不能依赖独特的输出。

[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)即使您不需要安全性，我也建议使用 CSPRNG ( )。它的性能对于大多数用途来说仍然是可以接受的，我相信它的随机数的质量超过`Random`. 如果您想要唯一性，我建议您获取大约 128 位的数字。

要使用生成随机字符串，`RNGCryptoServiceProvider`您可以查看我对[如何在 C# 中生成随机 8 个字符的字母数字字符串的回答？](https://stackoverflow.com/a/13416143/445517).

* * *

现在返回的 GUID`Guid.NewGuid()`是版本 4 GUID。它们是从 PRNG 生成的，因此它们具有与生成随机 122 位数字非常相似的属性（其余 6 位是固定的）。它的熵源的质量比`Random`使用的要高得多，但不能保证它在密码学上是安全的。

但是生成算法可以随时更改，因此您不能依赖它。例如，过去 Windows GUID 生成算法从 v1（基于 MAC + 时间戳）更改为 v4（随机）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-20T15:21:58.473

使用[`System.Guid`](http://msdn.microsoft.com/en-us/library/system.guid.aspx)它：

> ...可以在需要唯一标识符的所有计算机和网络上使用。

请注意，这`Random`是一个*伪随机数生成器*。它不是真正随机的，也不是唯一的。与 128 位 GUID 相比，它只有 32 位的值可供使用。

然而，即使是 GUID 也可能发生冲突（尽管机会非常渺茫），因此您应该使用数据库自​​己的功能来为您提供唯一标识符（例如，自动增量 ID 列）。此外，您不能轻松地将 GUID 转换为 4 或 20（字母）数字。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-20T15:34:35.303

与某些人在评论中所说的相反，由 Guid.NewGuid() 生成的 GUID 不依赖于任何特定于机器的标识符（只有类型 1 GUID，Guid.NewGuid() 返回类型 4 GUID，这主要是随机的）。

只要您不需要加密安全，`Random`该类应该足够好，但如果您想更加安全，请使用`System.Security.Cryptography.RandomNumberGenerator`. 对于 Guid 方法，请注意并非 GUID 中的所有数字都是随机的。引用自[维基百科](http://en.wikipedia.org/wiki/UUID)：

> 在规范表示中，`xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx`N 的最高有效位表示变体（取决于变体；使用一位、两位或三位）。UUID 规范涵盖的变体由 N 的两个最高有效位为 1 0 表示（即十六进制 N 将始终为 8、9、A 或 B）。在 UUID 规范涵盖的变体中，有五个版本。对于这个变体，M 的四位表示 UUID 版本（即十六进制 M 将是 1、2、3、4 或 5）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-20T15:58:49.807

关于您的编辑，这是首选 GUID 而不是生成的字符串的原因之一：

SQL Server 中 GUID（唯一标识符）的本机存储为 16 个字节。要存储等效长度的 varchar（字符串），其中 id 中的每个“数字”都存储为一个字符，需要 32 到 38 个字节，具体取决于格式。

由于它的存储，SQL Server 还能够比 varchar 列更有效地索引 uniqueidentifier 列。

# c# - 更改只读文本框c#的textcolor

> ID：14983341
> 
> 赞同：0
> 
> 时间：2013-02-20T15:15:58.713
> 
> 标签：c#, textbox, readonly

我有 textBox1 这是只读的。我正在努力改变

```
textBox1.ForeColor = Color.Red; 
```

但它不起作用。任何想法 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:17:08.690

当您将`TextBox`控件的属性设置为`ReadOnly`true 时，文本变为灰色。这是默认行为。

如果您需要将其显示为红色，则不应设置`ReadOnly`属性，而应`TextChanged`手动处理事件并保持旧值不变。但我不推荐它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:23:53.213

尝试取消 KeyPress 的事件：

```
textBox1.Text = "Test";
textBox1.ForeColor = Color.Red;
textBox1.KeyPress += new KeyPressEventHandler(textBox1_KeyPress);

void textBox1_KeyPress(object sender, KeyPressEventArgs e)
{
 e.Handled = true;
} 
```

ReadOnly 属性总是使控件变灰。这是默认行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:18:46.960

您可以对只读文本框做的事情是（首先将其更改为读/写）您可以覆盖所述`KeyPress()`事件`TextBox`并忽略从那里开始的所有输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-16T13:15:37.063

这应该可以帮助您：

```
textBox1.BackColor = Color.FromKnownColor(KnownColor.Control);
textBox1.ForeColor = Color.Red;
textBox1.ReadOnly = true; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-16T10:05:22.457

使用 RichTextBox。只读时，继续以彩色显示文本

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-06-05T06:06:47.657

这应该可以帮助你。

```
textboxname.ForeColor = Color.FromKnownColor(KnownColor.selectanycolor); 
```

# erlang - 更新erlang中的多条记录

> ID：14983345
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:16:18.143
> 
> 标签：erlang

我有这个记录的表人

```
-record(person, {id, firstname, lastname, phone}). 
```

我想更新这个表 Itry 的所有记录的电话

```
test()->
        Newphone ="216",
        Update=#person{phone=Newphone} ,
    Fun = fun() ->
                  List = mnesia:match_object(Update),
                  lists:foreach(fun(X) ->
                                        mnesia:write_object(X)
                                end, List)
          end,
    mnesia:transaction(Fun). 
```

表**person**包含

```
 12  alen     dumas        97888888
    15  franco   mocci      55522225
    13  ali      othmani    44444449 
```

我希望这张桌子变成这样：

```
 12  alen     dumas      216
    15  franco   mocci      216
    13  ali      othmani    216 
```

我尝试：

```
test()->
    Newphone ="216",
    Update=X#person{phone=Newphone, _ = '_'}
Fun = fun() ->
              List = mnesia:match_object(Update),
              lists:foreach(fun(X) ->
                                    mnesia:write(X)
                            end, List)
      end,
mnesia:transaction(Fun). 
```

但是使用这段代码我有这个错误：

```
Variable X is unbound 
```

这与这条线有关：

```
Update=X#person{phone=Newphone, _ = '_'} 
```

为了解决这个问题，我这样做：

```
test()->
    Newphone ="216",
    Update=#person{phone=Newphone, _ = '_'}
Fun = fun() ->
              List = mnesia:match_object(Update),
              lists:foreach(fun(X) ->
                                    mnesia:write(X)
                            end, List)
      end,
mnesia:transaction(Fun). 
```

当我测试我有这个消息：

```
{atomic,ok} 
```

但是当我查阅数据库时，我发现**记录没有改变**

**我的代码中的困难是更改表 person 的所有记录**

所以改变**97888888**和**55522225**和**44444449**

这个值应该变成**216**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T00:41:40.690

继续@legoscia 的开始。您的代码存在几个问题：

1.  在`mnesia:match_object/1`通话`Update`中被用作一种**模式**，因此当您在其中设置`phone`字段`phone=NewPhone`时，`Update`您实际上是在说`match_object`给我所有具有`phone`价值的记录`"216"`。这不是你想要的。
2.  您正在写回与匹配**的完全相同的记录。**在写回记录之前，您不会更改记录。

解决方案可能是（未经测试）：

```
test()->
    Newphone ="216",
    Match=#person{_ = '_'},                               %Will match all records
    Fun = fun() ->
              List = mnesia:match_object(Match),
              lists:foreach(fun(X) ->
                                %% Create new record with phone=NewPhone and write it back
                                Update = X#person{phone=NewPhone},
                                mnesia:write(Update)
                            end, List)
          end,
    mnesia:transaction(Fun). 
```

您设置的任何字段都`Match`将限制您将匹配的记录`match_object`。例如`Match = #person{phone="123",_='_'}`将匹配所有具有电话的记录`"123"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:32:33.837

这里有几件事需要改变：

1.  如果你打算使用一条记录作为[mnesia:match_object](http://www.erlang.org/doc/man/mnesia.html#match_object-1)的模板，你应该用 atom 填写你不关心的记录字段`'_'`。有一种特殊的语法可以做到这一点：

    ```
    Update=#person{phone=Newphone, _ = '_'} 
    ```

2.  您可能不希望`Newphone`在那里 - 您传递给的记录`match_object`应该匹配已经在表中但应该更改的对象，而不是您希望将对象更改为的对象。

    您要更改哪些记录？这将决定你应该传递给`match_object`.

3.  您在事务中唯一要做的就是读取记录并将它们原封不动地写回。查看[Erlang 参考手册的记录章节](http://www.erlang.org/doc/reference_manual/records.html)；您可能想要`X#person{phone = Newphone}`更改中的电话字段`X`。

4.  该功能`mnesia:write_object`不存在；您可能的意思是[mnesia:write](http://www.erlang.org/doc/man/mnesia.html#write-1)。

# r - R编程中如何处理多组数据？

> ID：14983347
> 
> 赞同：0
> 
> 时间：2013-02-20T15:16:19.887
> 
> 标签：r, cut, mean

Ca data <- cut(data$Time, breaks=seq(0, max(data$Time)+400, 400))  by(data$Oxytocin, cut, mean)

但这仅适用于一个人的数据....但是我有十个人有自己的时间和催产素数据....我如何同时获得他们的平均值？也不要有这种类型的输出：

```
cuts: (0,400]
[1] 0.7
------------------------------------------------------------ 
cuts: (400,800]
[1] 0.805 
```

有没有办法让我获得这些削减的清单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:52:01.197

这是使用`IRanges`包的解决方案。

`idx`假设您的数据格式是`Time`, `data`, `Time`, `data`, ... 等等。因此，它会创建索引`1,3,5,...ncol(df)-1`。

`ir1`是您想要平均值的间隔。它的宽度是 400。每个时间列（这里是第 1 列和第 3 列）从 0 到 max(Time)。

`ir2`是间隔宽度 = 1 的对应时间列。

然后我得到 with 的重叠`ir1`，`ir2`它基本上告诉我 ir2 的哪些间隔与 ir1 重叠（我们想要），我从中计算平均值并输出`data.frame`.

```
idx <- seq(1, ncol(df), by=2)
o <- lapply(idx, function(i) {  
    ir1 <- IRanges(start=seq(0, max(df[[i]]), by=401), width=401)
    ir2 <- IRanges(start=df[[i]], width=1)
    t <- findOverlaps(ir1, ir2)
    d <- data.frame(mean=tapply(df[[i+1]], queryHits(t), mean))
    cbind(as.data.frame(ir1), d)
})

> o
# [[1]]
#   start  end width      mean
# 1     0  400   401 0.6750000
# 2   401  801   401 0.8050000
# 3   802 1202   401 0.8750000
# 4  1203 1603   401 0.2285333

# [[2]]
#   start  end width    mean
# 1     0  400   401 0.73508
# 2   401  801   401 0.13408
# 3   802 1202   401 0.26408
# 4  1203 1603   401 1.06408
# 5  1604 2004   401 3.06408 
```

对于每一`Time`列，您将获得一个包含间隔和该间隔平均值的列表。

# c# - 如何根据日期时间和在c#中花费的天数计算经过的时间

> ID：14983354
> 
> 赞同：1
> 
> 时间：2013-02-20T15:16:38.167
> 
> 标签：c#, datetime, weekday

我想知道是否存在任何允许将天数与日期时间相加而不考虑复活节、圣诞节、星期六等“无工作日”的库/方法。

我知道存在 DateTime.Add 方法，但这没有考虑“非工作日”。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:18:55.223

您可以将 TimeSpan 结构用于时间间隔。这是另一个stackoverflow线程的示例：

[计算两个日期之间的工作日数？](https://stackoverflow.com/questions/1617049/calculate-the-number-of-business-days-between-two-dates)

[TimeSpan 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.timespan%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:21:05.570

不，您必须定义自己的非工作日并构建自己的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:27:12.167

有一个 DateTime 方法可以告诉你星期几，所以你可以检查周六/周日，但其余的取决于你。如果你打算将它与 Office 一起使用，那里有一些可以使用的 dll。否则，您可能希望找到一个可以为您计算出来的开源项目（其中有很多）。

`DateTime.Now.DayOfWeek`

这将是非常特定于地区的，因此如果您计划在多个国家/地区使用您的代码，则需要考虑。此外，在美国，不同的州也有不同的假期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:29:40.537

我假设您想在给定开始日期和需要多少工作日的情况下找到某事的结束日期？

如果是这样，下面的代码可能就是你想要的。它假定您有一个您支持的最大时间范围内的所有假期的列表。这可能是未来几年，具体取决于您的要求！

此代码获取开始日期和工作日数（以及假期列表）并返回结束日期。

```
public static DateTime AddWorkingDays(DateTime start, int workingDays, IEnumerable<DateTime> holidays)
{
    var dict = new HashSet<DateTime>(holidays);
    DateTime date;

    for (date = start; workingDays > 0; date = date.AddDays(1))
    {
        if (!dict.Contains(date))
        {
            --workingDays;
        }
    }

    return date;
} 
```

另一种实现假设您有一个谓词可以调用以确定一天是否为假期：

```
public static DateTime AddWorkingDays(DateTime start, int workingDays, Predicate<DateTime> isHoliday)
{
    DateTime date;

    for (date = start; workingDays > 0; date = date.AddDays(1))
    {
        if (!isHoliday(date))
        {
            --workingDays;
        }
    }

    return date;
} 
```

这两种实现都受到访问每个日期的影响。这可能不是问题，但如果日期范围很大，它可能会太慢。

# android - 如何在android中创建一个适合webview的div

> ID：14983359
> 
> 赞同：0
> 
> 时间：2013-02-20T15:16:43.813
> 
> 标签：android, html, webview, scale

我正在寻找一种将 div 元素放入 webview 的方法。挑战在于缩放 div 以适应不同 Android 设备上的 webview。

```
WebView wv = (WebView)findViewById(R.id.webview);
String divElement = "<div style="width: 100px; height: 100px;> STUFF </div>";
wv.loadData(divElement, "text/html", "urf-8"); 
```

**问题：**如何告诉 WebView “缩放”到 div 创建的 100px 正方形？或者，有没有更好的方法来创建 div？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:18:16.760

为什么不使用`width:100%`（或任何其他比例）作为 div？它需要有一个绝对值吗？

# datetime - 如何将 SSRS 中的时间格式化为 HH:MM AM/PM 格式？

> ID：14983362
> 
> 赞同：8
> 
> 时间：2013-02-20T15:16:55.307
> 
> 标签：datetime, reporting-services

我的任务是增加以下代码以显示没有秒数的时间，并使用 AM/PM：

```
=IIF(Fields!New_Date.Value <> "NO CHANGE", FormatDateTime(IIF(Fields!New_Date.Value = "NO CHANGE","1/1/12",Fields!New_Date.Value),DateFormat.ShortDate), "") &
IIF(Fields!New_Time.Value <> "NO CHANGE",FormatDateTime(IIF(Fields!New_Time.Value = "NO CHANGE","00:00",Fields!New_Time.Value),DateFormat.ShortTime), "") 
```

在意识到 FormatDateTime 不足以满足我的要求时，我发现以下内容不起作用（仅查看与时间字段相关的片段），：

```
Format(IIF(Fields!New_Time.Value = "NO CHANGE","00:00",Fields!New_Time.Value),"HH:mm tt") 
```

或这个

```
Format(IIF(Fields!New_Time.Value = "NO CHANGE","00:00",Fields!New_Time.Value),"HH:MM tt") 
```

我从[这里](http://thavash.wordpress.com/2007/10/02/date-formatting-in-reporting-services-list-of-format-codes/)获取格式代码。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T15:16:55.307

所以我发现，因为我实际上是在尝试格式化文本框，SSRS 从来没有真正“知道”它是一个时间字段。虽然我不是 100% 确定我的推理是正确的，但它确实解释了为什么以下工作：

```
Format(CDate(IIF(Fields!New_Time.Value = "NO CHANGE","00:00",Fields!New_Time.Value)),"hh:mm tt") 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-20T17:20:07.667

如果您的数据在简单的文本框（或表格单元格）中，那么您有更轻松的解决方案。

右键单击文本框>属性：

使用以下内容： ![在此处输入图像描述](../Images/d42f7ccc8bbc95650d4396e79266c11c.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-03-29T14:27:16.290

其他答案是正确的，但了解格式的关键区别是：

```
 h:mm tt --> 12-hour clock (e.g. 5:30 PM)
hh:mm tt --> 12-hour clock with a leading zero, if necessary (e.g. 05:30 PM)
 H:mm    --> 24-hour clock (e.g. 1:30 for 1:30 AM)
HH:mm    --> 24-hour clock with a leading zero, if necessary (e.g. 01:30 for 1:30 AM) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-03-21T01:57:02.683

从文本框属性->数字->自定义类别：

尝试输入：

dd-MMM-yy hh:mm tt

# java - 无法使用 Hibernate BigDecimal (SQLite) 添加

> ID：14983366
> 
> 赞同：0
> 
> 时间：2013-02-20T15:17:02.563
> 
> 标签：java, hibernate

当我尝试使用字段 BigDecimal (new BigDecimal("1.0")) 添加对象时，出现此错误：

> 16:00:59.058 [main] DEBUG ohejdbc.spi.SqlExceptionHelper - SQLite JDBC 驱动程序未实现 [n/a] java.sql.SQLException: org.sqlite.Unused.unused(Unused.java 的 SQLite JDBC 驱动程序未实现:29) ~[sqlite-jdbc-3.7.2.jar:na] at org.sqlite.Unused.setBigDecimal(Unused.java:58) ~[sqlite-jdbc-3.7.2.jar:na] at sun.reflect .NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_38] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) ~[na:1.6.0_38] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl. java:25) ~[na:1.6.0_38] 在 java.lang.reflect.Method.invoke(Method.java:597) ~[na:1.6.0_38] 在 org.hibernate.engine.jdbc.internal.proxy。 AbstractStatementProxyHandler.continueInvocation(AbstractStatementProxyHandler.java:122) ~[hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.jdbc.internal.proxy.AbstractProxyHandler.invoke(AbstractProxyHandler.java:81) ~[hibernate-core -4.1.4.Final.jar:4.1.4.Final] at $Proxy20.setBigDecimal(Unknown Source) ~[na:na] at org.hibernate.type.descriptor.sql.DecimalTypeDescriptor$1.doBind(DecimalTypeDescriptor.java: 58) ~[hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.type.descriptor.sql.BasicBinder.bind(BasicBinder.java:92) [hibernate-core-4.1\. 4.Final.jar:4.1.4.Final] 在 org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:305) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org .hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:300) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate。type.AbstractSingleColumnStandardBasicType.nullSafeSet(AbstractSingleColumnStandardBasicType.java:57) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.persister.entity.AbstractEntityPersister.dehydrate(AbstractEntityPersister.java:2602) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.persister.entity.AbstractEntityPersister.dehydrate(AbstractEntityPersister.java:2579) [hibernate-core-4.1.4.Final.jar :4.1.4.Final] 在 org.hibernate.persister.entity.AbstractEntityPersister$4.bindValues(AbstractEntityPersister.java:2760) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate .id.insert.AbstractSelectingDelegate.performInsert(AbstractSelectingDelegate.java:60) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java ：2767）[hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.persister.entity.AbstractEntityPersister.insert（AbstractEntityPersister.java:3278）[hibernate-core-4.1.4.Final .jar:4.1.4.Final] 在 org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:81) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org. hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue. java:203) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:183) [hibernate-core-4.1.4 .Final.jar:4.1.4.Final] 在 org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:167) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:320) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal .AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:287) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) [ hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126) [hibernate-core-4.1.4.Final.jar: 4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:204) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:189) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener. java:114) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:90) [hibernate-core-4.1.4 .Final.jar:4.1.4.Final] 在 org.hibernate.internal.SessionImpl.fireSaveOrUpdate(SessionImpl.java:728) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org. hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:720) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.spi.CascadingAction$5.cascade(CascadingAction.java ：258) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:380) [hibernate-core-4.1.4.Final .jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:323) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org. hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade. java:409) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:350) [hibernate-core-4.1.4 .Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在org.hibernate.engine.internal。Cascade.cascadeProperty(Cascade.java:208) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165) [hibernate -core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:448) [hibernate-core-4.1.4.Final.jar:4.1 .4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:293) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event。 internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126) [休眠核心4.1.4.Final.jar：4.1.4。最终] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:204) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener .entityIsTransient(DefaultSaveOrUpdateEventListener.java:189) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:114) [hibernate- core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:90) [hibernate-core-4.1.4.Final.jar:4.1\. 4.Final] 在 org.hibernate.internal.SessionImpl.fireSaveOrUpdate(SessionImpl.java:728) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:720) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.spi.CascadingAction$5.cascade(CascadingAction.java :258) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:380) [hibernate-core-4.1.4\. Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:323) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org .hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade .java:409) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:350) [hibernate-core-4.1\. 4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org .hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascade(Cascade .java:165) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:448) [hibernate-core-4.1\. 4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:293) [hibernate-core-4.1.4.Final.jar:4.1.4.Final]在 org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate .event.internal.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:204) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java :189) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:114) [hibernate-core-4.1.4\. Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:90) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.internal.SessionImpl.fireSaveOrUpdate(SessionImpl.java:728) [hibernate-core-4.1.4.Final.jar :4.1.4.Final] 在 org.hibernate.internal.SessionImpl.saveOrUpdate(SessionImpl.java:720) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine。 spi.CascadingAction$5.cascade(CascadingAction.java:258) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:380 ) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:323) [hibernate-core-4.1.4.Final. jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate .engine.internal.Cascade。cascadeCollectionElements(Cascade.java:409) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:350) [hibernate-core -4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326) [hibernate-core-4.1.4.Final.jar:4.1.4 .Final] 在 org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.engine.internal。 Cascade.cascade(Cascade.java:165) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:448) [hibernate -core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:293) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) [hibernate-core-4.1.4 .Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:204) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveEventListener.saveWithGeneratedOrRequestedId( DefaultSaveEventListener.java:55) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:189) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveEventListener.performSaveOrUpdate(DefaultSaveEventListener.java:49) [hibernate-core-4.1.4 .Final.jar:4.1.4.Final] 在 org.hibernate.event.internal.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:90) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在org.hibernate.internal.SessionImpl.fireSave(SessionImpl.java:757) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.internal.SessionImpl.save(SessionImpl.java: 749) [hibernate-core-4.1.4.Final.jar:4.1.4.Final] 在 org.hibernate.internal.SessionImpl.save(SessionImpl.java:745) [hibernate-core-4.1.4.Final.jar :4.1.4.Final] 在 database.sqlite.sessionsworkers.InsertSessionWorker.applyOnDatabase(InsertSessionWorker.java:25) [classes/:na] 在 database.sqlite.sessionsworkers.InsertSessionWorker.applyOnDatabase(InsertSessionWorker.java:1) [classes/:na] 在 database.local.sqlite.SQLite.doTransaction(SQLite.java:108) [classes/:na] 在数据库.local.sqlite.SQLite.save(SQLite.java:137) [classes/:na] 在 database.local.sqlite.SQLite.saveOwner(SQLite.java:173) [classes/:na] 在 database.local.sqlite .SQLiteTest.create_database(SQLiteTest.java:67) [test-classes/:na] 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_38] 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl. java:39) ~[na:1.6.0_38] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) ~[na:1.6.0_38] at java.lang.reflect.Method.invoke(Method.java:第597章~[na:1.6.0_38]在org.junit.runners。model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45) [junit-4.10.jar:na] at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15) [junit-4.10.jar: na] 在 org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42) [junit-4.10.jar:na] 在 org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20 ) [junit-4.10.jar:na] at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263) [junit-4.10.jar:na] at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java :68) [junit-4.10.jar:na] at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47) [junit-4.10.jar:na] at org.junit.runners.ParentRunner$3.run( ParentRunner.java:231) [junit-4.10.jar:na] 在 org.junit.runners。ParentRunner$1.schedule(ParentRunner.java:60) [junit-4.10.jar:na] at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229) [junit-4.10.jar:na] at org.junit .runners.ParentRunner.access$000(ParentRunner.java:50) [junit-4.10.jar:na] at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222) [junit-4.10.jar:na]在 org.junit.runners.ParentRunner.run(ParentRunner.java:300) [junit-4.10.jar:na] 在 org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50) [ .cp/:na] 在 org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38) [.cp/:na] 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner .runTests(RemoteTestRunner.java:467) [.cp/:na] at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683) [.cp/:na] 在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390) [.cp/:na] 在 org.eclipse.jdt.internal.junit。 runner.RemoteTestRunner.main(RemoteTestRunner.java:197) [.cp/:na]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-18T17:02:40.670

@Boris the Spider 在注释中你可以写

```
@Type (type="utils.BigDecimalToStringType")
private BigDecimal bigDecimal; 
```

（我不能发表评论，因为我的声誉很低）

PS我不知道你为什么在那里有摘要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:23:05.057

来自错误“未由 SQLite JDBC 驱动程序实现”-因此推测 SQLLite 不支持该数据类型。
也许实现 a`UserType`并将其另存为`String`?

```
public class BigDecimalToStringType implements UserType {

    private static final int[] SQL_TYPES = {Types.VARCHAR};

    @Override
    public int[] sqlTypes() {
        return SQL_TYPES;
    }

    /**
     *
     * @return
     */
    @Override
    public Class<BigDecimal> returnedClass() {
        return BigDecimal.class;
    }

    @Override
    public Object nullSafeGet(final ResultSet resultSet, final String[] names, final SessionImplementor si, final Object owner) throws HibernateException, SQLException {
        final String value = StandardBasicTypes.STRING.nullSafeGet(resultSet, names[0], si);
        if (value != null) {
            return new BigDecimal(value);
        }
        return null;
    }

    @Override
    public void nullSafeSet(final PreparedStatement preparedStatement, final Object value, final int index, final SessionImplementor si) throws HibernateException, SQLException {
        if (null == value) {
            preparedStatement.setNull(index, Types.VARCHAR);
        } else {
            StandardBasicTypes.STRING.nullSafeSet(preparedStatement, ((BigDecimal) value).toPlainString(), index, si);
        }
    }

    @Override
    public Object deepCopy(final Object value) throws HibernateException {
        return value;
    }

    @Override
    public boolean isMutable() {
        return false;
    }

    @Override
    public Object assemble(final Serializable cached, final Object owner) throws HibernateException {
        return cached;
    }

    @Override
    public Serializable disassemble(final Object value) throws HibernateException {
        return (Serializable) value;
    }

    @Override
    public Object replace(final Object original, final Object target, final Object owner) throws HibernateException {
        return original;
    }

    @Override
    public int hashCode(final Object x) throws HibernateException {
        return x.hashCode();
    }

    @Override
    public boolean equals(final Object x, final Object y) throws HibernateException {
        if (x == y) {
            return true;
        }
        if (null == x || null == y) {
            return false;
        }
        return x.equals(y);
    }
} 
```

不快，但你不会失去精度。默认情况下，hibernate 会生成 a `VARCHAR(255)`，因此您可能希望将其延长。
您将需要在您的休眠映射中指定这一点：

```
<property name="myValuePropertyName" type="com.my.package.name.BigDecimalToStringType"/> 
```

然后休眠将使用它来持久化数据。
也许有`JPA`知识的善良灵魂会给你同等的注释......

# windows - mklink：批处理文件的符号链接未运行批处理文件

> ID：14983377
> 
> 赞同：1
> 
> 时间：2013-02-20T15:17:30.610
> 
> 标签：windows, batch-file, cmd, mklink

这里的问题是，在创建到批处理文件的符号链接后，该链接不会运行批处理文件。例子：

```
mklink x x.cmd 
```

单击它会在记事本中`x`打开！`x.cmd`普通快捷方式（.lnk 文件）按预期工作。

```
> ftype cmdfile
cmdfile="%1" %*
> assoc .cmd
.cmd=cmdfile 
```

所以每个 .cmd 文件都应该自己运行。

有解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T13:33:39.217

一种方法是建立硬链接（mklink /H）。但是因为我认为你只需要某种捷径，试试这个：

1）像这样（shortcut_helper.vbs）制作一个shell脚本*.vbs：

```
set WshShell = WScript.CreateObject("WScript.Shell" )
set oShellLink = WshShell.CreateShortcut(Wscript.Arguments.Named("shortcut") & ".lnk")
oShellLink.TargetPath = Wscript.Arguments.Named("target")
oShellLink.Arguments = Wscript.Arguments.Named("arg")
oShellLink.WindowStyle = 1
oShellLink.Save 
```

2）让你的批处理脚本从一个批处理文件中像这样启动它：

```
path_to_vbs\shortcut_helper /target:"file_path\file.bat" /shortcut:"shortcut_name" /arg:"optional_arguments" 
```

现在 2) 为您创建快捷方式 (*.lnk)，然后您可以将它们移动到您喜欢的任何位置 =)

不过要小心，*.vbs 文件在某些​​情况下可能需要管理员权限。

# actionscript-3 - 单独循环音频和视频 AS3

> ID：14983379
> 
> 赞同：0
> 
> 时间：2013-02-20T15:17:34.353
> 
> 标签：actionscript-3, stream, flv

我有这个功能，女巫在流式视频完成后循环其中的所有内容有没有办法只循环流式视频`shaker(null)`而不循环音频？因为音频正在倾斜，但长度更大。所以基本上我需要独立循环播放视频和音频。

```
 function NCListener(e:NetStatusEvent){

    if (e.info.code == "NetStream.Play.Stop") {

        ns.play("http://media.easyads.bg/ads/display_ads_richmedia/video/avon/maria_ilieva/video_2.flv");
        soundChannel = sound.play(0, 9999);
        shaker(null);
        }
    };

var sound:Sound = new Sound();
var soundChannel:SoundChannel= new SoundChannel();
sound.load(new URLRequest("sound.mp3"));
sound.addEventListener(Event.COMPLETE, onSoundLoadComplete  );

function onSoundLoadComplete(e:Event):void{
    sound.removeEventListener(Event.COMPLETE, onSoundLoadComplete);

    soundChannel.addEventListener(Event.SOUND_COMPLETE, onSoundChannelSoundComplete);
}

function onSoundChannelSoundComplete(e:Event):void{
    e.currentTarget.removeEventListener(Event.SOUND_COMPLETE, onSoundChannelSoundComplete);
    soundChannel = sound.play(0, 9999);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:08:48.573

对于独立循环，您需要同时监听 NetStream (onPlayStatus) 和 SoundChannel (soundComplete) 上的事件。在事件处理程序中，您将仅重新启动已完成的媒体。

看起来您的示例代码只是在听 NetStream。

# python - 为什么 CSS 样式在 GtkButton 上不起作用？

> ID：14983385
> 
> 赞同：4
> 
> 时间：2013-02-20T15:17:52.533
> 
> 标签：python, css, styles, gtk, gtk3

请原谅我的英语。

我正在尝试使用 css 文件更改 GtkButton 的背景颜色，但我不能。我尝试了一些在网上找到的示例，但没有一个有效。我贴两个例子。一个在 Python 3.2.3 中，另一个在 C 中，我使用 Gtk+ 3.6 和 Kubuntu 12.10。

这是其中之一的代码：

```
from gi.repository import Gtk, Gdk

class MainWindow(Gtk.Window):
    def __init__(self):
        super().__init__()
        vbox = Gtk.Box(spacing=10,orientation=Gtk.Orientation.VERTICAL)
        self.add(vbox)

        self.entries = [ Gtk.Entry() for i in range(3) ]
        for e in self.entries:
            vbox.pack_start(e, True, True, 0)
            e.connect("changed", self.on_entry_changed)
            e.set_text('123')

        button=Gtk.Button(label='ok')
        vbox.pack_end(button,True,True,0)

    def on_entry_changed(self,entry):
        ctx = entry.get_style_context()
        if not entry.get_text().isnumeric():
            ctx.add_class('invalid')
        else:
            ctx.remove_class('invalid')
cssProvider = Gtk.CssProvider()
cssProvider.load_from_path('style.css')
screen = Gdk.Screen.get_default()
styleContext = Gtk.StyleContext()
styleContext.add_provider_for_screen(screen, cssProvider,
Gtk.STYLE_PROVIDER_PRIORITY_USER) # With the others GTK_STYLE_PROVIDER_PRIORITY values get the same result.

window = MainWindow()
window.connect("delete-event", Gtk.main_quit)
window.show_all()
Gtk.main() 
```

和 style.css

```
GtkEntry.invalid {
    background-color: #ffaaaa;
    background: #ffaaaa;
}

GtkButton {
    engine: oxygen-gtk; /*tried also with 'none' and without setting engine*/
    background-color: green;
    background: green;
} 
```

条目效果很好...... bg 颜色变化。但是按钮没有，也没有错误信息。

**EDIT3：（**删除预览编辑和更改一些标签） **总结...**我试图用我在网上找到的所有 Python、C 和 C++ 代码更改按钮颜色，但未成功。我阅读了我找到的所有教程和 GTK+ 3 参考手册。之后我所知道的就是问题出在 Kubuntu 主题上：如果我将 GTK 主题从*“oxygen-gtk”*更改为*“默认”*（在 GTK 配置中），这是我发现代码运行良好的唯一方法，但是这不是想法，按钮看起来很糟糕。

**所以，问题是：**

1.  为什么我不能更改按钮的背景颜色？
2.  为什么我只有按钮才有这个问题？（适用于其他小部件）
3.  我在这里和 GTK 论坛中得到答案，说这不是更改按钮颜色的好习惯，但是......如果我想要一个像这张图片（[链接](http://c.fsdn.com/con/app/proj/scrmopenerp/screenshots/ProjetatyScrmOpenerp_2.png)）中的菜单（见红色框按钮）怎么办？最好的做法是什么？

谢谢和问候！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-11T21:42:10.143

我知道这已经很老了，但是在前几个谷歌搜索结果中出现了，所以我想我会分享我的经验。

Gtk.Button 有一个用于按钮文本的内联 Gtk.Label ，默认情况下它不会从按钮继承，因此您必须明确告诉它（或仅指定其中的颜色）：

```
GtkButton GtkLabel {
    color: #fff; /* This changes the text color in the button */
} 
```

至于@sciamp 的回答，GTK 主题还为背景和边框设置了图像，因此您必须使用`background-image: none; border-image: none;`Hope 手动将其删除，这样可以节省一些人的麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-09T08:29:05.793

这应该有效（我的意思是它对我有用！）：

```
GtkButton {
  border-image: none;
  background-image: none;
  background-color: green;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T14:54:30.563

这很复杂，但我认为不能直接完成。

我相信核心原因是因为按钮不渲染背景。它所做的只是在其区域周围渲染一个框架，然后在其中渲染任何子项。请记住，GtkButton 是一个容器，它通常包含一个用于文本标签的 GtkLabel，但可以包含任何小部件。

我已经设法改变了文本标签的背景颜色，但是只有文本本身周围更窄的框才会受到影响，这不是你想要的。

间接解决方案是将 GtkButton 子类化以创建一个实际渲染其背景的变体。可以肯定的是，这对主题非常粗鲁，应该避免。

# c++ - 添加到结构向量时出现斯坦福 CS 106B 错误 - 编译器问题？

> ID：14983386
> 
> 赞同：0
> 
> 时间：2013-02-20T15:17:58.927
> 
> 标签：c++, vector, struct

我正在尝试在线学习斯坦福的 CS 106B 课程，但是当我尝试将元素添加到结构向量时遇到了困难。知道发生了什么吗？

```
 struct point {                  // Definition for our "point" structure
    int x;
    int y;
    };

Vector<point> pointVector;

point derp;
derp.x = 1;
derp.y = 2;
pointVector.add(derp); 
```

不幸的是，当我尝试这个时，我在 XCode 中遇到了两个错误。第一个是“模板参数使用本地类型'point'。”第二个是“请求'pointVector'中的成员'add'，它是非类类型'int'。这是我的编译器的某种问题吗？从文档来看，这应该可以工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:25:53.820

在 2011 年之前，该语言有一个奇怪且毫无意义的限制：模板参数不能涉及本地类型。这已在 2011 年标准中得到修复。

要修复第一个错误，请执行以下任一操作：

*   将定义`point`移出函数，移入类或命名空间；或者
*   在您的编译器中启用 C++11 支持，或者如果它不能做到这一点，请获取更新的编译器。

第二个错误是第一个错误的连锁反应；编译器无法确定 的类型`pointVector`，因此它无济于事地决定假装它是`int`并继续。修复第一个错误后，该错误应该消失。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T15:21:22.933

试着做

```
typedef struct point {                  // Definition for our "point" structure
    int x;
    int y;
}point;

std::vector<point> pointVector;

point derp;
derp.x = 1;
derp.y = 2;
pointVector.add(derp); 
```

或者

```
struct point {                  // Definition for our "point" structure
    int x;
    int y;
    };

std::vector<struct point> pointVector;

point derp;
derp.x = 1;
derp.y = 2;
pointVector.add(derp); 
```

这应该这样做。

# jpa - JPA Mapping，父到子和子到父，有两个类和抽象类

> ID：14983389
> 
> 赞同：1
> 
> 时间：2013-02-20T15:18:06.823
> 
> 标签：jpa, abstract, many-to-one

我有两个从抽象类继承并具有父子关系的类。

所以我使用注释 OneToMany 和 ManyToOne 但子类中的父实体始终为空。有人可以帮我吗，我花了几个小时在谷歌上搜索并测试了许多没有成功的conf。

这些是我的课程中的代码：

```
public @Table(name="flowentity") @Entity abstract class FlowEntity {

final static Logger log = LoggerFactory.getLogger(FlowEntity.class);

//Globals informations concerning the flow state
private @Id @GeneratedValue(strategy = GenerationType.IDENTITY) Integer flowId = 0;
private String flowName;

private @OneToMany(fetch=FetchType.EAGER, cascade=CascadeType.ALL) 
        Set<PeopleEntity> actorSet = new HashSet<>();

//Global parameters for most of flows
//Organizational parameters
private @OneToOne(fetch=FetchType.EAGER, cascade=CascadeType.ALL)
        @JoinColumn(name="organisationalEntity_Id")
        OrganisationalEntity organisationalEntity; 
```

...

```
public @Table(name="ams_newCPEntity") @Entity class NewMultiCPEntity  extends FlowEntity {

private @OneToMany(targetEntity=NewCPEntity.class, fetch=FetchType.EAGER, cascade=CascadeType.ALL,mappedBy="parent") 
        Set<NewCPEntity> cpList = new HashSet<NewCPEntity>();

//Constructor
    public NewMultiCPEntity(){
        setFlowName(EnumFlow.N_CP_M.getFlowAcronym());
    } 
```

...

```
public @Table(name="ams_newCPEntity") @Entity class NewCPEntity extends FlowEntity {

final static Logger log = LoggerFactory.getLogger(NewCPEntity.class);

private boolean formNCPValidated;

private @ManyToOne @JoinColumn(name="parent_Id", nullable=false)
        NewMultiCPEntity parent;

public NewCPEntity(){
    log.debug("Instanciation of a new CP");
    setFlowName(EnumFlow.N_CP.getFlowAcronym());
}

public @Override OrganisationalEntity getOrganisationalEntity(){
    return parent.getOrganisationalEntity();
} 
```

...

如果我不添加 @JoinColumn 注释，JPA 会创建一个关联表，但无法检索父级，而关联可以通过在数据库中请求直接完成。

非常感谢您的帮助。

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T09:35:57.807

谢谢克里斯的评论，你是对的，我忘记更改表的名称。我认为这不是问题，因为继承映射在一个带有 DTYPE 鉴别器列的表中。

最后，我通过在添加这样的新孩子时设置父属性来解决我的问题：

```
public @Table @Entity class NewMultiCPEntity  extends FlowEntity {

    private @OneToMany(targetEntity=NewCPEntity.class, fetch=FetchType.EAGER, cascade=CascadeType.ALL) 
            List<NewCPEntity> cpList = new ArrayList<>();

    //Constructor
        public NewMultiCPEntity(){
            setOrganisationalEntity(new OrganisationalEntity());
            setFlowName(EnumFlow.N_CP_M.getFlowAcronym());
        }

    public List<NewCPEntity> getNCPList(){
        if(cpList == null){
            cpList = new ArrayList<>();
        }
        if(cpList.isEmpty()){
            addCPEntity(new NewCPEntity());
        }
        return Collections.unmodifiableList(cpList);}

    public boolean removeCPEntity(NewCPEntity entity){
        return cpList.remove(entity);
    }
    public boolean addCPEntity(NewCPEntity entity){
        entity.setParent(this);
        entity.setOrganisationalEntity(this.getOrganisationalEntity());
        return cpList.add(entity);
    } 
```

我删除了子项中 getOrganizationalEntity 的覆盖：

```
public @Table @Entity class NewCPEntity extends FlowEntity {

    final static Logger log = LoggerFactory.getLogger(NewCPEntity.class);

    private @ManyToOne(targetEntity=NewMultiCPEntity.class,cascade=CascadeType.ALL)
            NewMultiCPEntity parent;

    public NewCPEntity(){
        log.debug("Instanciation of a new CP");
        setFlowName(EnumFlow.N_CP.getFlowAcronym());
    }

    public NewMultiCPEntity getParent() {
        return parent;
    }

    public void setParent(NewMultiCPEntity parent){
        this.parent = parent;
    } 
```

问候，

# java - java对同一个对象的多次反序列化

> ID：14983390
> 
> 赞同：1
> 
> 时间：2013-02-20T15:18:11.580
> 
> 标签：java, serialization, deserialization

我有一个关于 Java 序列化语义的问题：两次反序列化同一个对象实际上会在内存中创建两个实例吗？例如：

```
 ByteArrayOutputStream ba = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(ba);

    LinkedListNode tail = new LinkedListNode(null);
    LinkedListNode n1 = new LinkedListNode(tail);

    oos.writeObject(n1);
    oos.flush();

    ByteArrayInputStream bi = new ByteArrayInputStream(ba.toByteArray());
    ObjectInputStream ois = new ObjectInputStream(bi);
    LinkedListNode r1 = (Node)ois.readObject();

    ByteArrayInputStream bi2 = new ByteArrayInputStream(ba.toByteArray());
    ObjectInputStream ois2 = new ObjectInputStream(bi2);
    LinkedListNode r2 = (Node)ois2.readObject();

    System.out.println("r1 == r2 " + (r1 == r2)); // prints false
    System.out.println("r1.next == r2.next " + (r1.next == r2.next)); // prints false 
```

该代码似乎暗示答案是肯定的。我想知道这种行为是否有意义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:19:28.867

是的，反序列化会创建对象的一个​​新实例，并且多次反序列化会创建多个实例 - 除非您覆盖反序列化方法并实现某种池，例如，请参见[此处](https://stackoverflow.com/questions/1168348/java-serialization-readobject-vs-readresolve)

# c++ - 是向量 < 列表 > 解决这个问题的正确方法？

> ID：14983391
> 
> 赞同：0
> 
> 时间：2013-02-20T15:18:11.543
> 
> 标签：c++, c++11

我正在尝试解决工作问题，并且是新手程序员。我有三个文件，都是制表符分隔的。

File1 有两个字段：*Marker_id* &*位置*，此文件按位置 (0-26) 排序，然后 Marker_id 的顺序是另一个应用程序的结果，但不是字母顺序。Marker_id 的顺序很重要，因为目标我的程序是找到一个起始 Marker_id 并计算该标记和结束标记之间的标记数。该文件包含近 2,500,000 个条目。

File2 有一个字段 *Marker_id* 这与 File1 中使用的 Marker_id 相同，但该文件仅包含大约 2,200,000 个条目。这个文件是我的程序应该计算的“活动”标记或标记的列表。

File3 具有字段*位置**starting_marker**结束标记**number_markers* 和其他字段。我需要通过计算开始和结束之间的标记数来更新 number_markers 字段。

我已经有将 file1 读入的代码

```
vector< list<marker> >; 
```

其中标记是一个结构：

```
struct MARKER{
 string snp_id;
 bool included;
 MARKER(string temp_id) : snp_id(temp_id), included(false) { }
}; 
```

文件一中的位置 (0-26) 指定了向量中用于存储标记的索引。我还使用开始和停止之间的标记数成功更新了 file3 中的计数。

但是，我无法实现将列表修剪为仅“活动标记”的功能。我打算简单地做 MARKER.included(true); 对于 file2 中的条目，直到我意识到 file2 不包含*位置*，因此，我必须在每个向量索引处搜索每个列表。这是可能的，我只是觉得有这么多条目会非常慢。

我正在尝试考虑替代方法，例如将 file1 存储在键为 Marker_id 的地图中，但需要将 Marker_id 保持在原始计数顺序中，这让我束手无策。

有人有建议吗？谢谢。

更新（示例文件）：

```
***File1***
Marker_id                position
  test_marker_1              1
  test_marker_2              1 
  test_marker_3              1
  test_marker_4              1
  test_marker_5              1
  test_marker_6              1
  test_marker_7              1
  test_marker_8              1   
  test_marker_9              1 
```

.

```
***File2***
Marker_id         C20020.Log R Ratio    C20020.B Allele Freq
test_marker_1         0.0180                       0.0010
test_marker_3        -0.0340                       0.5000
test_marker_4         0.0500                       0.0700
test_marker_5         0.0500                       0.0700
test_marker_6         0.0500                       0.0700
test_marker_7         0.0500                       0.0700
test_marker_9         0.0500                       0.0700 
```

注意：文件 2 中省略了 test_marker_2 和 test_marker_8，因此不会包含在计数中。

```
***File3***
position  copy_num  sampleID   startMarker     endMarker          conf         num_Markers
   1         4      C20020    test_marker_1     test_marker_3     1774.967          0
   1         3      C20020    test_marker_3     test_marker_5      17.967           0
   1         0      C20020    test_marker_7     test_marker_9    107.967           0 
```

.

```
***My desired output***
position  copy_num  sampleID   startMarker     endMarker          conf         num_Markers
   1         4      C20020    test_marker_1     test_marker_3     1774.967          2
   1         3      C20020    test_marker_3     test_marker_5      17.967           3
   1         0      C20020    test_marker_7     test_marker_9    107.967           2 
```

就目前而言，除了所有三个示例的计数均为 3 之外，我的所有功能都正常运行，因为我不排除那些在 file2 中找不到的标记。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T09:40:39.603

我想到了几种方法。

您可以通过标记 id（当然是临时副本）对文件 1 和 2 进行排序，然后可以轻松地确定文件 1 中的标记，但单程中不包含在文件 2 中的标记。然后，您可以使用此“排除列表”来确定在算法的其他部分中要忽略的标记。根据您的数字，这将是大约 300,000 个项目，可以将其插入到哈希映射中以进行快速查找。

当然，如果你有大量的内存，你总是可以把**所有**的文件 2 放入一个哈希映射中，并以同样的方式使用它。

如果内存是一个真正的问题，但标记值是这样的，它们定义了一个完整的空间（例如数字 1 到 1000 万，或其他），其中标记可以映射到偏移量，那么您可以创建整个空间的位图, 1 仅用于活动的标记。同样，使用该位图来排除那些要被忽略的标记。

基本上，只要您可以对包含/排除测试进行恒定时间检查，您就在笑。

# javascript - 在 ASP.net 中，我是否正确添加了标头代码？

> ID：14983396
> 
> 赞同：0
> 
> 时间：2013-02-20T15:18:25.527
> 
> 标签：javascript, asp.net, reporting-services

我找到了一个很好的[教程（由谷歌缓存）](http://webcache.googleusercontent.com/search?q=cache%3aECpKFBcqCjkJ%3awww.rajbandi.net/category/Reporting-Services.aspx%20&cd=2&hl=en&ct=clnk&gl=us)，它展示了如何修复 SSRS 中的日期选择器。它告诉我

> 在 html 头部分添加以下脚本

所以，因为这是一个 ASPX 网站，所以没有 HTML 文件，我假设我应该将它添加到我的 Default.aspx 页面中，如下所示：

```
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
<script type="text/javascript">
$(document).ready(function(){ 
if ($.browser.webkit) { 
$($(":hidden[id*='DatePickers']").val().split(",")).each(function(i, item){ 
var h = $("table[id*='ParametersGrid'] span").filter(function(i) { 
var v = "[" + $(this).text() + "]"; 
return (v != null && v.indexOf(item) >= 0); }).parent("td").next("td").find("input").datepicker({ showOn: "button" ,buttonImage: '/Reserved.ReportViewerWebControl.axd?OpType=Resource&Name=Microsoft.Reporting.WebForms.calendar.gif' ,buttonImageOnly: true ,dateFormat: 'dd/mm/yy' ,changeMonth: true ,changeYear: true }); }); } }); 
</script>
</asp:Content> 
```

但是，这不能正常工作（日期选择器仍然不可点击/工作）。

代码是什么`($.browser.webkit)`意思？我是否需要在我自己的 JS 日期选择器中导入（我在网上找到了一些不同的日期选择器）？

谢谢！

# mysql - 存储过程中的动态 MySQL Where 子句

> ID：14983398
> 
> 赞同：6
> 
> 时间：2013-02-20T15:18:29.720
> 
> 标签：mysql, sql, procedure

我有一个问题，也许它很简单（对你来说是大师）。

我正在将我的 SQL 分页类从 C# 转换为 MySQL 存储过程。在我的 C# 自制对象中，查询是根据条件动态构建的。例子：

```
if(keywords is not null)
{ 
  whereClause += "WHERE description LIKE '%keywords%'"
}
if(price is not null)
{
  whereClause += "AND price = '%price%'"
} 
```

……

```
string query = "SELECT col1, col2 FROM tblThreads " + whereClause 
```

现在，我的问题是：如何在 MySQL 中执行类似于此的动态 where 子句？或者更确切地说，如果他们没有为这些参数输入任何内容，我将如何告诉存储过程中的 MySQL 跳过这些？IE：

```
SELECT col1, col2 FROM tblThreads 
```

如果这些参数为空，这样的事情会起作用吗？

```
SELECT col1, col2 FROM tblThreads WHERE (IS NULL @keywords OR description like '%@keywords%' 
```

??

多谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:24:26.117

您可以使用`CASE`语句来检查 的值`@keywords`，例如。

```
SELECT  col1, col2 
FROM    tblThreads 
WHERE   description LIKE  CASE WHEN @keywords IS NULL 
                            THEN description
                            ELSE CONCAT('%', @keywords, '%')
                            END
        AND
        price LIKE  CASE WHEN @price IS NULL 
                            THEN price
                            ELSE CONCAT('%', @price, '%')
                            END 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:23:19.233

如果您允许他们查询整个数据库，最简单的方法就是在`1 = 1`您的语句中添加一个类似的东西

```
whereClause = "WHERE 1 = 1"

if(keywords is not null)
{ 
 whereClause += "AND description LIKE '%keywords%'"
}
if(price is not null)
{
 whereClause += "AND price = '%price%'"
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:24:42.343

```
SELECT col1, col2 
FROM tblThreads 
WHERE case when @keywords is not null then description like '%' + @keywords + '%' when @price is not null then price like'%' + @price + '%' end 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-04-07T23:43:24.700

```
DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `sp_Name4`(
 IN a int(255),
 IN b int(255),
 IN dept_id_in int(255)
)
BEGIN
     SELECT
        emp.emp_id, emp.emp_name,
        emp.emp_job, 
        emp.dept, 
        emp.percent_doctor,
        emp.percent_center,
        patient_exam.exam_id,
        patient_exam.p_id,
        ABS(SUM(patient_exam.exam_price)) as SUM_price,
        ABS((SUM(patient_exam.exam_price)*  emp.percent_center )/100   ) as total_doc,
        ABS((SUM(patient_exam.exam_price)*  emp.percent_doctor )/100   ) as total_center
      FROM emp
      left join patient_exam 
      ON emp.emp_id = patient_exam.doctor
      WHERE emp.emp_is_delete=0 and patient_exam.ex_is_delete=0 and 1=1 

CASE WHEN dept_id_in IS not NULL 
                        THEN
                        and patient_exam.dept_id=dept_id_in

                        END   

                        group by emp.emp_id, patient_exam.exam_id order by emp.emp_id, patient_exam.exam_id desc limit a,b;

        END$$
DELIMITER ; 
```

# java - 使用触摸 UI 的处理程序时未切换可检查

> ID：14983399
> 
> 赞同：0
> 
> 时间：2013-02-20T15:18:30.530
> 
> 标签：java, android, scala

我有一个自定义 CursorAdapter，它在 bindView 中为 OnCheckedChangeListener 设置一个处理程序（newView 中的布局实现了 Checkable 接口）。'=>' 是 scala 中的匿名函数语法：

```
def setTaskCheckboxToggleListener() = {
  val v = view.findViewById(R.id.taskCheckbox).asInstanceOf[CheckBox]
  v.setOnCheckedChangeListener(
    (buttonView: CompoundButton, isChecked: Boolean) => {
      handler(buttonView, isChecked)
    }
  )
} 
```

适配器与 listView 一起使用。现在处理程序在包含 listView 的活动中设置一次，使用：

```
listView.setAdapter(Tasks.adapter(context))
listView.setChoiceMode(AbsListView.CHOICE_MODE_MULTIPLE);
listView.getAdapter().registerCheckBoxStateChangeHandler((buttonView: CompoundButton, _) => {
  findViewById(R.id.commandButton).astInstanceOf[Button].setText("✓")
} 
```

由于某种原因，此处理程序会阻止切换复选框。相比之下，复选框仅适用于空处理程序或未在 UI 元素上调用 .setText 的处理程序。这里可能是什么问题？

Adapter中使用的Checkable布局，res/中的xml文件有一个CheckBox元素：

```
import android.content.Context
import android.util.AttributeSet
import android.view.View
import android.widget.{CheckBox, Checkable, CheckedTextView, RelativeLayout}

class TaskLayout(context: Context, attrs: AttributeSet)
  extends RelativeLayout(context, attrs) with Checkable {
  private var checkbox: CheckBox = _

    override def onFinishInflate(): Unit = {
      super.onFinishInflate();

      for (i <- 0 to getChildCount()) {
        val v = getChildAt(i)
        if (v.isInstanceOf[CheckBox])
          checkbox = v.asInstanceOf[CheckBox];
      }
    }

    override def isChecked(): Boolean = {
      if (checkbox != null)
        checkbox.isChecked()
      else
        false
    }

    override def setChecked(checked: Boolean) =
      if (checkbox != null) checkbox.setChecked(checked)

    override def toggle() =
      if (checkbox != null) checkbox.toggle();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:39:53.277

注释掉 listView.setChoiceMode(AbsListView.CHOICE_MODE_MULTIPLE) 解决了这个问题。

# css - 如何在 Internet Explorer 开发人员工具中更改默认样式表规则顺序

> ID：14983402
> 
> 赞同：0
> 
> 时间：2013-02-20T15:18:41.657
> 
> 标签：css, firebug, ie-developer-tools

我不使用 Internet Explorer 进行 Web 开发的一个原因是它支持 CSS 属性操作的方式：它首先列出了最通用的样式表属性。当有很多样式表规则时，您必须向下滚动——这是大多数时候。有没有办法改变这个顺序？所以它首先列出最具体的样式规则，就像firebug和Chrome中的Firefox一样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:24:57.330

用IE测试仪试试。[www.my-debugbar.com/wiki/IETester/HomePage](http://www.my-debugbar.com/wiki/IETester/HomePage)。

您还需要为 IE 测试器安装调试工具栏[http://www.debugbar.com/download.php](http://www.debugbar.com/download.php)。

这个工具会给你你所需要的。

# ssis - 如何重新配置 平面文件连接管理器上的列信息？

> ID：14983403
> 
> 赞同：4
> 
> 时间：2013-02-20T15:18:41.547
> 
> 标签：ssis, etl, dataflow

我有一个平面文件源，它正在从平面文件中读取数据。我们最近在此平面文件中添加了一个新列。

平面文件数据被插入到数据库表中。为了适应目标组件中的新字段，我使用该`ALTER TABLE`语句将新列添加到表中。这是我所做的唯一改变。

平面文件和目标组件之间的映射是否应该自动更改？我在 SSIS 包中的任何地方都看不到平面文件中存在的附加列。

如何在 SSIS 包内的平面文件中配置附加列，以便平面文件源可以将数据传递到目标组件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-20T16:14:05.573

如果您向平面文件添加了新列，则需要更新*`Flat File Connection Manager`*以反映新更改。*平面文件连接管理器*将出现在*`Connection Manager`*包底部的选项卡下。

### 使用 SSIS 2012 说明的示例场景：

假设您有一个包含*StateCode*和*StateName*列的平面文件。

![初始平面文件](../Images/f98e635a2ab6d3d4eeea1bcf4553d77e.png)

配置时`Flat File Connection Manager`，您将看到在*高级*选项卡页面下配置的这些列，如下所示。

![初始连接管理器](../Images/bd6fa2b7d14fcc6f5c520c72a7c57e7c.png)

如果您修改平面文件以添加额外的列，例如添加名为*CountryCode*的新列。

![最终平面文件](../Images/5fa9dc578b4e7f6424aa2e36ffc489be.png)

平面文件连接管理器将不包含新的列定义。您需要打开平面文件连接管理器来添加新列，或者您可以删除平面文件连接管理器并使用新的平面文件列定义创建一个新的连接管理器。

您需要单击新建并选择适当的选项来插入该列。您不能移动列位置。因此，请确保选择正确的选项来添加列。设置适当的属性来定义列。

![最终连接管理器](../Images/49f843f449837d9817c161f87c3aa87c.png)

当您修改源或目标模式时，它将影响数据流任务中的源和目标组件。您可能会在组件上看到如下所示的警告图标，因为该组件与其关联的连接管理器的元数据信息不同步。

双击显示警告的组件，然后单击编辑器上的确定以解决映射问题。

![来源警告](../Images/04e6d3ae78316d973243f475f0947e1b.png)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:41:23.213

当您更改底层组件（例如平面文件或数据库）的元数据时，SSIS 不会自动刷新所有可用列。您必须手动执行此操作。

1.  打开源组件的编辑器并导航到“列”属性（左侧）并验证平面文件中的所有外部列都存在并被选为输出列。
2.  对目标组件的 Mappings 属性窗口重复此过程。验证所有平面文件列都映射到正确的目标列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-14T10:42:16.003

更新平面文件源中的列的最简单方法是重置平面文件连接上的列。

1.  从连接管理器打开您的平面文件连接
2.  选择列（在常规下方）
3.  单击重置列 - 这将包括任何新列。

当然，如果您对数据类型等进行了自定义更改，则需要小心。

# c# - 仅向 SQL 表插入新数据

> ID：14983414
> 
> 赞同：2
> 
> 时间：2013-02-20T15:19:11.207
> 
> 标签：c#, sql, sql-server

现在我有一个 SQL Server 表，其中填充了来自外部 .CSV 文件的数据，该文件偶尔会通过附加新数据来更新。最初，我将程序设置为每次运行时都删除表中的所有内容，并且它会从 .CSV 文件上传所有内容。现在我正在尝试重新配置它，以便它只从文件中插入新附加的数据，而不是先删除所有内容。

该程序首先从上传到数组的 .CSV 文件中分隔数据。然后我基本上遍历数组并上传每个元素。现在我有一个包含表中所有当前主键的辅助数组，到目前为止，我已经尝试将这些与正在读取的 .CSV 文件中的主键进行比较。因此，它会检查 .CSV 文件中的主键是否尚未在表/辅助数组中，它会继续进行插入。这似乎是一个合理的逻辑，但由于某种原因我无法让它工作。

这是我的代码的主要内容：

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
    {

        //Create new SQL connection and adapter using Windows Authentication
        SqlConnection myConnection = new SqlConnection("Data Source=database; Initial Catalog=Dashboard; Integrated Security=SSPI; Persist Security Info=false; Trusted_Connection=Yes");
        SqlDataAdapter da = new SqlDataAdapter();

        try
        {
            myConnection.Open();

            da.InsertCommand = new SqlCommand("INSERT INTO DashboardLibAnswer(Id,Date,Time,Question,Details,Answer,Notes,EnteredBy,WhereReceived,QuestionType,AnswerMethod,TransactionDuration)"
                + "VALUES(@Id,@Date,@Time,@Question,@Details,@Answer,@Notes,@EnteredBy,@WhereReceived,@QuestionType,@AnswerMethod,@TransactionDuration)", myConnection);

            da.InsertCommand.Parameters.Add("@Id", SqlDbType.NVarChar);
            da.InsertCommand.Parameters.Add("@Date", SqlDbType.Text);
            da.InsertCommand.Parameters.Add("@Time", SqlDbType.Text);
            da.InsertCommand.Parameters.Add("@Question", SqlDbType.Text);
            da.InsertCommand.Parameters.Add("@Details", SqlDbType.Text);
            da.InsertCommand.Parameters.Add("@Answer", SqlDbType.Text);
            da.InsertCommand.Parameters.Add("@Notes", SqlDbType.Text);
            da.InsertCommand.Parameters.Add("@EnteredBy", SqlDbType.NVarChar);
            da.InsertCommand.Parameters.Add("@WhereReceived", SqlDbType.NVarChar);
            da.InsertCommand.Parameters.Add("@QuestionType", SqlDbType.NVarChar);
            da.InsertCommand.Parameters.Add("@AnswerMethod", SqlDbType.NVarChar);
            da.InsertCommand.Parameters.Add("@TransactionDuration", SqlDbType.NVarChar);

            //Using the global variable counter this loop will go through each valid entry and insert it into the specifed database/table
            for (int i = 0; i < counter; i++)
            {
                //This is where I try to do the comparision. 
                //idS is the secondary array with all the current primary keys in the Table
                //collection is the primary array that stores new data from the .CSV file
                if (idS.ElementAt(i) != collection.getIdItems(i))
                {
                    da.InsertCommand.Parameters["@Id"].Value = collection.getIdItems(i);
                    da.InsertCommand.Parameters["@Date"].Value = collection.getDateItems(i);
                    da.InsertCommand.Parameters["@Time"].Value = collection.getTimeItems(i);
                    da.InsertCommand.Parameters["@Question"].Value = collection.getQuestionItems(i);
                    da.InsertCommand.Parameters["@Details"].Value = collection.getDetailsItems(i);
                    da.InsertCommand.Parameters["@Answer"].Value = collection.getAnswerItems(i);
                    da.InsertCommand.Parameters["@Notes"].Value = collection.getNotesItems(i);
                    da.InsertCommand.Parameters["@EnteredBy"].Value = collection.getEnteredByItems(i);
                    da.InsertCommand.Parameters["@WhereReceived"].Value = collection.getWhereItems(i);
                    da.InsertCommand.Parameters["@QuestionType"].Value = collection.getQuestionTypeItems(i);
                    da.InsertCommand.Parameters["@AnswerMethod"].Value = collection.getAnswerMethodItems(i);
                    da.InsertCommand.Parameters["@TransactionDuration"].Value = collection.getTransactionItems(i);
                    da.InsertCommand.ExecuteNonQuery();
                }

                //Updates the progress bar using the i in addition to 1 
                _worker.ReportProgress(i + 1);

            } // end for

            //Once the importing is done it will show the appropriate message
            MessageBox.Show("Finished Importing");

        } // end try
        catch (Exception exceptionError)
        {
            //To show exceptions thrown just uncomment bellow line
            //rtbOutput.AppendText(exceptionError.ToString);

        } // end catch

        //Closes the SQL connection after importing is done
        myConnection.Close();

    } // end backgroundWorker1_DoWork 
```

现在程序正在执行，但没有插入新数据。似乎该程序没有退出 for 循环，因为如果它成功运行，它会显示“完成导入”消息框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:29:05.877

线

```
if (idS.ElementAt(i) != collection.getIdItems(i)) 
```

看起来很奇怪。根据 getIdItems 返回的内容，在我看来，如果两个列表第一次不同步时您将匹配 - 因此，如果项目的出现顺序与您已经持久化它们的顺序不同，您可能会得到一个假阳性。IE。代码将评估该项目不存在并且应该保留，即使它存在于您集合中的其他位置。

然后，如果您有唯一约束，则插入将失败，将您发送到被注释掉的异常处理程序 - 然后退出。

我要做的第一件事是激活异常处理程序以了解发生了什么。其次，我可能会更改上面的代码，以便您查找而不是遍历您的`idS`集合。IE。如果您制作`idS`一个列表或包含 Linq 扩展方法，您可以执行以下操作：

```
if (!idS.Contains(collection.getIdItems(i)) 
```

编辑：请注意，对于 large `idS`，这不是特别有效，并且随着列表的增长也不能很好地扩展。如果您希望处理大量`idS`，您可能希望将列表更改为哈希集合或使用此处建议的解决方案[检查 list<t> 是否包含任何其他列表](https://stackoverflow.com/q/11092930/806549)。

# c# - 类中的属性

> ID：14983415
> 
> 赞同：0
> 
> 时间：2013-02-20T15:19:13.080
> 
> 标签：c#

我创建的两个属性之间有什么区别（即优势/劣势）？两者似乎都是正确的，但是在类中声明属性的最佳方式（实践）是什么？

```
[Serializable]
public class MySample
{
   public string String1 = string.Empty;

   private string _string2 = string.Empty;

   public string String2 
        {
            get { return _string2 ; }
            set { _string2 = value; }
        }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T15:21:48.283

只有`String2`一个是[属性](http://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx)，另一个是公共[字段](http://msdn.microsoft.com/en-gb/library/ms173118.aspx)。

有关详细信息，请参阅[C# .NET 3.5+ 中的属性和字段之间的区别，](https://stackoverflow.com/questions/653536/difference-between-property-and-field-in-c-sharp-net-3-5)但如果有疑问，您应该使用属性而不是公共字段。

如果这看起来输入太多，那么您会很高兴知道以下内容是等价的

```
public string String2 { get; set; } 
```

查看[自动属性](http://msdn.microsoft.com/en-us/library/bb384054.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:21:44.993

只有`String2`一个属性。`String1`只是一个公共字段，建议不要声明公共字段。

您可以通过使用自动属性来简化像这样的简单属性的声明：

```
public string String { get; set; } 
```

字段和属性之间的主要区别在于字段是直接访问的，而属性是通过`get`和`set`方法读取和写入的。当您像上面那样声明自动属性时，编译器会自动为您生成这些`get`和`set`方法，以及用于存储实际值的支持字段。

您还可以在`get`and`set`方法中执行其他代码，这些代码通常用于更改通知和验证等事情。您可以将`get`和`set`方法设置为不同的可见性，例如`{ get; private set; }`，这是字段没有的另一件事。

请注意，即使`String1`和`String2`示例中的用法相同，它们也不是二进制兼容的。也就是说，如果您有一个使用字段的类，并且您想将该字段更改为属性，则需要重新编译引用该类的所有程序集。所以最好从一开始就使用（至少是自动的）属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:21:14.900

最好的方法是使用自动属性：

像这样：

```
public string String1 {get;set;} 
```

如果您想要一个仅从中读取但不写入的属性：

```
public string String1 {get; private set;} 
```

如果您想要一个仅写入但不读取的属性：

```
public string String1 {set; private get;} 
```

通常建议您不要声明`fields`为`public`：

```
public string _string1; /*bad idea*/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:22:31.657

`String1`是公共领域，而不是财产。除非它是（并且是不可变的！），否则*不建议*这样做，例如.`static readonly`[`String.Empty`](http://msdn.microsoft.com/library/system.string.empty%28v=vs.80%29.aspx)

即使一个字段现在很好（尽管可能不是最先进的），稍后将其更改为属性会破坏类的二进制兼容性，因此是一个重大更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T15:22:36.987

第一个是：

```
public string String1 = string.Empty; 
```

是一个字段，而不是一个属性。您通常应该避免创建公共字段。

第二个是具有字段支持者的属性。如果您想在设置之前进行某种验证，这可能很有用。或者在获取值之前可能进行某种惰性初始化（显然，惰性初始化对于更复杂的类型或值的构造（如果不需要经常需要时间）更有效）。

第三个选项是自动属性，如下所示：

```
public string String3 { get; set; } 
```

这像属性一样编译，因此如果您将代码更改为字段支持的属性以添加额外的功能，那么您的类的签名不必更改，并且使用该类的任何现有代码都不需要更新调用属性而不是字段（因为它始终是属性）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-20T15:23:03.590

第一个不是属性，而是字段。你在这里实现这些的方式，实际上没有区别，但总的来说，属性给你更多的权力。

请参阅 [C# 中的字段和属性有什么区别？](https://stackoverflow.com/q/295104/1715579)

在 C# 中实现属性的常用方法是：

```
public string String1 { get; set; } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-20T15:24:06.367

你`String1`实际上是一个字段，而不是一个属性。我想您想要一个自动实现的属性，例如：

```
public string String1 { get; set; } 
```

Your `String2` is a field-backed property. One of the main differences between the two is that you have the opportunity to initialize the field-backed property by initializing the field instead of initializing the property in the constructor. Another important difference is that you have the opportunity in the field-backed property to do other things when the value is retrieved or set, such as performing change notification.

# android - Android：小部件说加载小部件失败

> ID：14983418
> 
> 赞同：2
> 
> 时间：2013-02-20T15:19:23.280
> 
> 标签：android, android-widget, broadcastreceiver

当我在主屏幕上单击我的小部件时，闪光灯会打开并弹出消息“加载小部件”！有人知道这个问题吗？

单击小部件之前/之后：

![在此处输入图像描述](../Images/60f1001223f28401ac9143750c4695bd.png)

![在此处输入图像描述](../Images/bf32efab6bc2a36a638cc8d48b832b7c.png)

**res/xml/flashlight_appwidget_info.xml**

```
 <?xml version="1.0" encoding="utf-8" ?>
<appwidget-provider
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:minWidth="50dp"
    android:initialLayout="@layout/flash_widget"
    android:updatePeriodMillis="1000"
    android:minHeight="50dp"
/> 
```

**资源/布局/flash_widget.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout01"
    android:layout_height="50dp"
    android:layout_width="50dp"
    android:orientation="horizontal">

    <Button
        android:id="@+id/button"
        android:layout_height="50dp"
        android:layout_width="50dp"
        android:background="@drawable/ic_launcher" />

</LinearLayout> 
```

**AndroidManifest.xml**

```
<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <receiver android:name=".FlashlightWidgetProvider" android:icon="@drawable/ic_launcher" android:label="@string/app_name">
         <intent-filter>
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
         </intent-filter>

        <meta-data android:name="android.appwidget.provider"
                   android:resource="@xml/flashlight_appwidget_info" />
    </receiver>

    <receiver android:name="FlashlightWidgetReceiver">
            <intent-filter>
                   <action android:name="COM_FLASHLIGHT"></action>
            </intent-filter>
    </receiver> 
```

**FlashlightWidgetProvider.java**

```
 @Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager,
                int[] appWidgetIds) {

        Intent receiver = new Intent(context, FlashlightWidgetReceiver.class);
        receiver.setAction("COM_FLASHLIGHT");
        receiver.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, appWidgetIds);
        PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, receiver, 0);

        RemoteViews views = new RemoteViews(context.getPackageName(),
                        R.layout.flash_widget);
        views.setOnClickPendingIntent(R.id.button, pendingIntent);

        appWidgetManager.updateAppWidget(appWidgetIds, views);

} 
```

**手电筒小部件接收器**

```
 public class FlashlightWidgetReceiver extends BroadcastReceiver {
    private static boolean isLightOn = false;
    private static Camera camera;

    @Override
    public void onReceive(Context context, Intent intent) {
            RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.flash_widget);

            if(isLightOn) {
                    views.setImageViewResource(R.id.button, R.drawable.ic_launcher);
            } else {
                    views.setImageViewResource(R.id.button, R.drawable.ic_launcher);
            }

            AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);
            appWidgetManager.updateAppWidget(new ComponentName(context,     FlashlightWidgetProvider.class),
                                                                             views);

            if (isLightOn) {
                    if (camera != null) {
                            camera.stopPreview();
                            camera.release();
                            camera = null;
                            isLightOn = false;
                    }

            } else {
                    // Open the default i.e. the first rear facing camera.
                    camera = Camera.open();

                    if(camera == null) {
                            Toast.makeText(context, "Keine Kamera", Toast.LENGTH_SHORT).show();
                    } else {
                            // Set the torch flash mode
                            Parameters param = camera.getParameters();
                            param.setFlashMode(Camera.Parameters.FLASH_MODE_TORCH);
                            try {
                                    camera.setParameters(param);
                                    camera.startPreview();
                                    isLightOn = true;
                            } catch (Exception e) {
                                    Toast.makeText(context, "Keine Kamera", Toast.LENGTH_SHORT).show();
                            }
                    }
            }
    }
} 
```

# git - 我想从更高的 git 存储库设置更低的存储库项目

> ID：14983419
> 
> 赞同：0
> 
> 时间：2013-02-20T15:19:24.057
> 
> 标签：git, git-submodules, git-filter-branch, repository-design

当我开始使用 GIT 时，我对项目代码并不熟悉，只想将所有代码置于源代码控制之下。项目层次结构是这样的：

```
/Projects/.git  # I put the git repository here, which I think was a big mistake.
/Projects/Project1
/Projects/Project2
/Projects/Project3
/Projects/Project4
/Projects/Project5 
```

有一次我最终创建了一个子存储库：

```
/Projects/.git (now it contains all of /Projects/Project3/.git changes too)
/Projects/Project1
/Projects/Project2
/Projects/Project3
/Projects/Project3/.git    # I think this will compound the problem of seperation
/Projects/Project4
/Projects/Project5 
```

我真正想要的是这样做：

```
/Projects/(no .git here)
/Projects/Project1/.git
/Projects/Project2/.git
/Projects/Project3/.git
/Projects/Project3/.git
/Projects/Project4/.git
/Projects/Project5/.git 
```

我查看了过滤器分支，但并不真正了解如何使用它将历史从较高的 /Projects/.git 存储库中提取到单独的较低的 /Projects/Project[1-5]/.git 存储库中.

我一直在环顾四周，发现有一个新的 git 子模块工具。我想知道这是否是我应该尝试使用的，但我不确定。

有谁知道如何将这些项目分成单独的存储库，以便我可以摆脱覆盖整个项目集的上层存储库？

任何帮助，将不胜感激。

艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:37:58.350

如果你不关心历史，你可以这样做：

在每个项目文件夹中：

```
git init .

git remote add origin <remote-repo-url e.g. github.com/kae/project1.git>

git add .

git commit -m "Initial Commit"

git push origin master 
```

这样，您的所有代码都将位于其自己的存储库中。删除外部 /Projects/.git 只是为了安全

# javascript - 如何从另一个页面链接到特定的 JavaScript 选项卡？

> ID：14983420
> 
> 赞同：1
> 
> 时间：2013-02-20T15:19:24.670
> 
> 标签：javascript, html, tabs

我正在尝试从目录页面链接到页面上的特定选项卡。我似乎无法找到一种对我有意义的方法来做到这一点。请耐心等待，因为我对编写 javascript 还是很陌生。

我正在使用的 HTML 是这个。

```
<ul id="tabs">
        <li><a href="#website">Website</a></li>
        <li><a href="#facebook">Facebook</a></li>
        <li><a href="#twitter">Twitter</a></li>
        <li><a href="#blog">Blog</a></li>
        <li><a href="#pub">Pub/Marketing</a></li>
    </ul>
    <div class="tabContent" id="website"><!--=================== Tab 1 ===================-->
        <h2>Website</h2>
        <h3>Website Redesign</h3>
        <p>For the new website, August 31st to September 30th:</p>
        <ul>
            <li>Bounce Rate: 23.59%</li>
            <li>Pageviews: 2,258</li>
        </ul>
        <p>Bounce rate is indicative of a massive improvement: the current website has a 40% bounce rate.</p>
        <h3>Most Popular Content</h3>
        <table id="popular_content" class="basic">
            <tr>
                <th>Page</th>
                <th>Page Views</th>
                <th>Bounce Rate</th>
                <th>% Exit</th>
            </tr>
            <tr>
                <td>/lrc/tutoring</td>
                <td>658</td>
                <td>18.47%</td>
                <td>21.88%</td>
            </tr>
            <tr class="odd">
                <td>/lrc/tutoring/tutors</td>
                <td>189</td>
                <td>50%</td>
                <td>85.19%</td>
            </tr>
            <tr>
                <td>/lrc/</td>
                <td>172</td>
                <td>25.45%</td>
                <td>26.74%</td>
            </tr>
        </table>
        <h3>LRC Mobile Website</h3>
        <p>For September, 2012:</p>
        <ul>
            <li>Visits: 162</li>
            <li>Unique Visitors: 73</li>
            <li>Pageviews: 286</li>
        </ul>
    </div> <!-- end of outreach_website div -->
    <div class="tabContent" id="facebook"><!--=================== Tab 2 ===================-->
        <h2>Facebook</h2>
        <table id="facebook_likes" class="basic">
            <tr>
                <th>Month</th>
                <th>Likes</th>
                <th>Friends of Fans</th>
            </tr>
            <tr>
                <td>July 2012</td>
                <td>78</td>
                <td>22,428</td>
            </tr>
            <tr class="odd">
                <td>Aug 2012</td>
                <td>84</td>
                <td>22,100</td>
            </tr>
        </table>
        <br />
        <img src="images/example_300x100.jpg" id="facebook_graph" style='max-width: 600px; height: auto;' />
        <img src="images/example_600x200.jpg" id="facebook_graph" style='max-width: 600px; height: auto;' />
        <img src="images/example_1200x400.jpg" id="facebook_graph" style='max-width: 600px; height: auto;' />
        <p>Popularity metrics from 7/19/12 to 10/1/12.<br />
        Definitions of the metrics are in the Facebook Page Insights product guide.</p>
        <br />
    </div><!-- end of outreach_facebook div --> 
```

javascript如下：

```
 /*
tabs.js
Chesapeake College
Monthly Statistics
author: Seamus O'Brien
created: 9-13-13
*/

var tabLinks = new Array();
var contentDivs = new Array();

function init() {
    //Grab the tab links and content divs from the page
    var tabListItems = document.getElementById('tabs').childNodes;
    for ( var i = 0; i < tabListItems.length; i++ ) {
        if (tabListItems[i].nodeName == "LI") {
            var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
            var id = getHash( tabLink.getAttribute('href') );
            tabLinks[id] = tabLink;
            contentDivs[id] = document.getElementById( id );
        }
    }

    //Assign onclick events to the tab links, and
    //highlight the first tab
    var i = 0;

    for( var id in tabLinks ) {
        tabLinks[id].onclick = showTab;
        tabLinks[id].onfocus = function() { this.blur()};
        if (i == 0 ) tabLinks[id].className = 'selected';
        i++;
    }

    //Hide all content divs except the first
    var i = 0;

    for( var id in contentDivs ) {
        if ( i !=0 ) contentDivs[id].className='tabContent hide';
        i++;
    }
}

// ShowTab Function

function showTab() {
    var selectedId = getHash( this.getAttribute('href') );

    //Highlight the selected tab, and dim all others.
    //Also show the selected content div, and hide all others.
    for ( var id in contentDivs ) {
        if ( id == selectedId ) {
            tabLinks[id].className = 'selected';
            contentDivs[id].className = 'tabContent';
        } else {
            tabLinks[id].className ='';
            contentDivs[id].className = 'tabContent hide';
        }
    }

    //Stop the Browser following the link.
    return false;
}

function getFirstChildWithTagName( element, tagName ) {
    for ( var i = 0; i < element.childNodes.length; i++ ) {
        if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
    }
}

function getHash(url) {
    var hashPos = url.lastIndexOf( '#' );
    return url.substring(hashPos + 1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T20:04:01.857

好吧，在等待答案时，我想出了在 javascript 中添加几行的解决方案。对于那些需要它的人，这里是最终版本。

```
var tabLinks = new Array();
var contentDivs = new Array();

function init() {
//Grab the tab links and content divs from the page
var tabListItems = document.getElementById('tabs').childNodes;
for ( var i = 0; i < tabListItems.length; i++ ) {
    if (tabListItems[i].nodeName == "LI") {
        var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
        var id = getHash( tabLink.getAttribute('href') );
        tabLinks[id] = tabLink;
        contentDivs[id] = document.getElementById( id );
    }
}

//Assign onclick events to the tab links, and
//highlight the first tab
var i = 0;

for( var id in tabLinks ) {
    tabLinks[id].onclick = showTab;
    tabLinks[id].onfocus = function() { this.blur()};
    if (i == 0 ) tabLinks[id].className = 'selected';
    i++;
}

//Hide all content divs except the first
var i = 0;

for( var id in contentDivs ) {
    if ( i !=0 ) contentDivs[id].className='tabContent hide';
    i++;
}

//Show linked tab
if ( document.location.hash ) showTab( document.location.hash.substring(1) );
} // end of init function

// ShowTab Function

function showTab(selectedId) {
if ( typeof selectedId != 'string' ) var selectedId = getHash(this.getAttribute('href') );

//Highlight the selected tab, and dim all others.
//Also show the selected content div, and hide all others.
for ( var id in contentDivs ) {
    if ( id == selectedId ) {
        tabLinks[id].className = 'selected';
        contentDivs[id].className = 'tabContent';
    } else {
        tabLinks[id].className ='';
        contentDivs[id].className = 'tabContent hide';
    }
}

//Stop the Browser following the link.
return false;
} //end of showTab function

function getFirstChildWithTagName( element, tagName ) {
for ( var i = 0; i < element.childNodes.length; i++ ) {
    if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
}
}

function getHash(url) {
var hashPos = url.lastIndexOf( '#' );
return url.substring(hashPos + 1);
} 
```

# javascript - 如何通过类名获取嵌套 div 中的元素？

> ID：14983425
> 
> 赞同：5
> 
> 时间：2013-02-20T15:19:34.777
> 
> 标签：javascript

带有 HTML 的网页如下所示：

```
<div id="Parent-div" > </div>
<div class="first-child-div"> </div>
<div class=" second-child-div"> 
    <div class="first-grand-child"> </div>
    <div class="second-grand-child"> </div>
    <div class="Third-grand-child"> 
        <div class="Grand-grand child"> 
           <button  class="Confirm-button">Confirm!</button> 
        </div>
    </div>
</div> 
```

我试过这个代码使用greasemonkey从div中删除一个名为“Grand-grand child”的类的按钮

这就是我所做的：

```
var targetDiv = document.querySelector("#<Parent-div>. Grand-grand.child");

targetDiv.innerHTML = "Hello world!"; 
```

Button 并没有被 Hello world 取代！文字，我做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-20T15:27:04.080

```
document.querySelector('.Grand.grand.child'); 
```

演示：http: [//jsfiddle.net/yGv3v/](http://jsfiddle.net/yGv3v/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-20T15:26:45.080

您应该更改`<div class=" Grand grand child">`为`<div class="Grand-grand-child">`，然后您可以使用 选择它`$('.Grand-grand-child')`。

**编辑**

如果你想使用纯 JavaScript，那么你可以通过选择节点元素

```
var grandChildChildNode = document.getElementsByClassName('Third')[0].children[0] 
```

这应该在足够现代的浏览器中工作。

# c# - ASP .NET 中的嵌套页面？

> ID：14983426
> 
> 赞同：1
> 
> 时间：2013-02-20T15:19:35.713
> 
> 标签：c#, asp.net

我有一个页面叫

```
EditProject.aspx?id=xxx 
```

我想在模式对话框中的任何地方调用它。模式对话框使用引导程序很简单。

我只想知道是否有一个控件可以在 div 或模式对话框中以某种方式调用页面。

我知道 IFrame，但是使用 asp .net 有更好更现代的方式吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:33:29.313

最好将 EditProject.aspx 移动到用户控件 EditPorject.ascx。

Userconrols 的工作方式与 aspx 页面非常相似，支持相同的事件，但您可以将它们嵌入 ASPX 页面中，如下所示：

```
<div id="edit-project-popup">
    <namespace:EditProject ID="editProject" runat="server" />
</div> 
```

您仍然可以从用户控件访问查询字符串参数。您还可以通过添加属性将值传递给用户控件：

```
 public partial class EditProject : UserControl
    {
        public int ID
        {
            get;
            set;
        }

        protected void Page_Load(object sender, EventArgs e)
        {
           // Your Code   
        }
    } 
```

然后，您可以在 ASPX 页面标记中设置此属性：

```
<uc:EditProject ID="editProject" runat="server" ID="xxx" /> 
```

或者在后面的 ASPX 页面代码中：

```
editProject.ID = "xxx"; 
```

希望这可以帮助。

有关用户控件的更多信息，请参阅 MSDN 上的此概述：http: [//msdn.microsoft.com/en-us/library/fb3w5b53 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/fb3w5b53(v=vs.100).aspx)

# html - .xls 文件的链接在我的 Intranet 站点上不起作用？

> ID：14983428
> 
> 赞同：0
> 
> 时间：2013-02-20T15:19:51.220
> 
> 标签：html, excel, asp-classic

我目前正在构建一个asp Intranet 站点。

我需要包含各种有用的链接，其中一些恰好是位于公司本地网络上的 .xls 文件。

我链接这些文档就像我链接任何 word 文档（顺便说一句，它工作得很好）。

```
<a href="file:///P:/-Projects-/SCHEDULE.xls" target="_blank"><span>Schedule</span></a> 
```

如果我只是将原始地址复制并粘贴到浏览器中，上面的链接就可以工作（出现一个弹出窗口，要求我在 Excel 中打开文件）。但是当我在 Intranet 站点上将此链接设置为并尝试单击它时，什么也没有发生。当我将鼠标悬停在状态栏上时，我可以看到该链接，仅此而已。它是不可点击的。任何人都知道是什么原因造成的以及如何解决它？

我应该提一下，其中两个 .xls 文件受密码保护，但其中一个只是一个只读文件，任何人都可以打开。

我 100% 确定这与 css 样式无关，因为同样的事情发生在其他人制作的当前（旧）Intranet 站点中，我也在不同的菜单栏上使用这些链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-13T06:15:54.657

此问题的解决方案是将站点添加到“受信任的站点”列表中。

在用户不知情的情况下打开 Intranet 文件被视为安全威胁。

在 IE 中转到 Internet 选项 -> 安全 -> 受信任的站点，然后添加该站点。

[http://answers.microsoft.com/en-us/ie/forum/ie9-windows_7/after-latest-update-ie-wont-open-network-file/172e4ac3-1c1f-4948-8a3f-c8c344eae06d](http://answers.microsoft.com/en-us/ie/forum/ie9-windows_7/after-latest-update-ie-wont-open-network-file/172e4ac3-1c1f-4948-8a3f-c8c344eae06d)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:29:21.923

我认为你对共享文件使用了错误的语法，试试这个：

`file:///P:\-Projects-\SCHEDULE.xls`

反斜杠对路径部分仍然有效。此外，我不确定 Sharepoint 是否可以正确识别最有可能网络驱动器的路径`P:`。

对我来说，这样的本地共享链接有效：

`file:///\\fs-1\Install\Windows\Servers\DB\MSSQL\SQL2005\en_sql_server_2005_service_pack_4_x64.exe`

# c++ - 这个结构是定义的，那么为什么函数认为它不是呢？

> ID：14983429
> 
> 赞同：0
> 
> 时间：2013-02-20T15:20:01.013
> 
> 标签：c++, arrays, parameters, struct, undefined

C++ 新手。只是制作一个简单的结构/数组程序。为什么我不能像我打算在这里那样传递一个结构数组？

```
int NumGrads();

int main()
{
      struct Student {
          int id;
          bool isGrad;
      }; 

    const size_t size = 2;
    Student s1, s2;
    Student students[size] = { { 123, true },
                             { 124, false } };

    NumGrads(students, size);

    std::cin.get();
    return 0;
}

int NumGrads(Student Stu[], size_t size){

} 
```

我很欣赏它必须与通过引用或值传递有关，但是如果我在 main() 中定义了它，我肯定不会在 NumGrads 的参数上出现错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-20T15:22:26.290

您的结构是在您的*内部*`main`定义的，而您的`NumGrads`函数是*在外部*定义的`main`。

这意味着您的结构是在您的函数可以看到它的范围之外定义的。

将您的结构的定义移到上面`main`，您的问题就解决了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-20T15:22:49.657

结构定义是本地的`main`。没有任何东西`main`可以看到它，包括您的`NumGrads`定义。在函数中定义结构并不是一件很常见的事情——通常你会在命名空间范围内拥有它。

此外，您的`NumGrads`声明与定义的参数类型不符。

```
// Define Student at namespace scope
struct Student {
    int id;
    bool isGrad;
}; 

int NumGrads(Student[], size_t); // The argument types are now correct

int main()
{
    // ...
}

int NumGrads(Student Stu[], size_t size){

} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-20T15:23:50.750

`Student`中定义`main()`。在 main 之外定义它，使其与以下范围相同`NumGrads`：

```
 struct Student
 {
      int id;
      bool isGrad;
 };

 int main()
 {
      ...
 } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-20T15:23:23.433

`struct Student`在 main 内部声明，所以`int NumGrads`看不到它。此外，该函数在您调用它时未声明`main`。此时，唯一可用的声明是`int NumGrads()`，这是一个不同的函数。

# windows-phone-8 - WP8 侧装停止工作

> ID：14983435
> 
> 赞同：2
> 
> 时间：2013-02-20T15:20:25.387
> 
> 标签：windows-phone-8, sideloading

几周前，侧面加载在我的 windows phone 8 设备上运行。我已经安装了一个有效的注册令牌（.aetx 文件）。我能够成功加载签名的 .xap 文件（通过在 IE 中下载或附加到电子邮件）。一切都很好。

然后我耗尽了电池，让设备死机了一个多星期。当我尝试运行旧的侧面加载应用程序时，它们可以工作。但是，当我尝试侧加载一个新的 xap 时，我收到一条错误消息，说明自从注册令牌通过 Microsoft 验证以来，它已经太久了。我希望我把它写下来，因为我不能让错误再次出现。

现在，当我尝试侧面加载应用程序时，什么也没有发生。它会弹出一个熟悉的对话框，确认我要安装应用程序（“您想从 [公司名称] 安装 [我的应用程序] 吗？”），然后我单击安装，对话框消失并且应用程序没有安装。

当我尝试再次安装 .aetx 时，它会弹出要安装的对话框，我单击安装，然后什么也没有（与第一次相同）。Xap 文件仍然无法安装。

猜测手机需要重新验证 Microsoft 的注册令牌，我尝试等待 24 小时，但这并没有帮助。我的想法不多了。

代替直接回答，有人可以帮助我至少得到一条错误消息吗？当我在调试应用程序时尝试侧向加载并且找不到任何操作系统级别的错误日志时，Visual Studio 的输出窗口中没有显示任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:44:10.487

您是否尝试在另一部手机上安装 aetx 或尝试重置您的手机？您还应该注意电话上的无效日期和时间。我在 Lumias 上遇到了类似的问题，一直重置到 1.9.2012 7:00。然后 aetx 被宣布无效并且没有安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-13T19:58:14.747

顺便说一句，它最终又开始为我工作了。我现在不记得花了多长时间，我想大约是一周，但我猜它最终会打电话回家并重新激活注册令牌。

# tfs - 卸载时如何删除自定义签入策略？

> ID：14983438
> 
> 赞同：0
> 
> 时间：2013-02-20T15:20:35.687
> 
> 标签：tfs, tfs-sdk, checkin-policy

我有一个用 c# 编写的自定义签入策略，并且我使用了 VSIX 项目，并在安装时启用了自定义操作。安装效果很好。如果我将自定义签入策略应用于 TFS 2010 中的团队项目，并且我从同一个安装程序中卸载了我的策略，它正在清理注册表和文件，但源代码管理仍然启用了该策略并引发**错误加载错误政策**。我希望我的安装程序在卸载策略时从源代码管理中删除该策略。我怎样才能做到这一点？

我试图在 OnAfterUninstall 事件中编写以下代码，但它没有做我需要的事情：

```
protected override void OnAfterUninstall(IDictionary savedState)
    {
        base.OnAfterUninstall(savedState);
        RemovePolicy();
    }

private void RemovePolicy()
    {
        try
        {
            TfsTeamProjectCollection projectCollection = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(projectCollectionUri, new UICredentialsProvider());
            projectCollection.EnsureAuthenticated();

            VersionControlServer vcs = projectCollection.GetService<VersionControlServer>();
            List<TeamProject> lstTeamProject = vcs.GetAllTeamProjects(true).ToList<TeamProject>();

            foreach (TeamProject tp in lstTeamProject)
            {
                List<PolicyEnvelope> tc = tp.GetCheckinPolicies().ToList<PolicyEnvelope>();
                var myPolicy = new MyCustomCheckinPolicy();
                TeamProject teamProject = vcs.GetTeamProject(tp.Name);

                foreach (PolicyType policyType in Workstation.Current.InstalledPolicyTypes)
                {
                    if (policyType.Name == myPolicy.Type)
                    {
                        tc.Remove(new PolicyEnvelope(myPolicy, policyType));
                        teamProject.SetCheckinPolicies(tc.ToArray());
                        break;
                    }
                }
            }
        }
        catch (Exception ex)
        {
            throw new InstallException("My Error Message");
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T07:57:20.160

因为需要在访问 TFS 项目的所有开发人员工作站上安装自定义签入策略，所以在卸载时将其从 TFS 项目中注销实际上将在*任何*这些开发人员卸载它时删除该策略。我怀疑这不是你想要的。

有一些方法可以[确保通过 Team Foundation Power Tools 将策略分发给所有团队成员](http://www.codewrecks.com/blog/index.php/2010/12/04/distributing-visual-studio-addin-for-the-team/)，这样，如果您需要发布升级或不同的策略，您将确保所有成员都拥有它。只能通过 UI 手动取消注册。

# android - Android：自定义微调器不显示所选项目

> ID：14983439
> 
> 赞同：0
> 
> 时间：2013-02-20T15:20:39.973
> 
> 标签：android, spinner

问题是在微调器中选择的项目以白色呈现，尽管我已经明确设置了颜色。我不知道该怎么做。我用谷歌搜索了类似的主题，但通过设置颜色解决了它们。对我来说没有帮助。这是我的代码：

```
private View getFormView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        LayoutInflater inflater = mA.getLayoutInflater();
        v = inflater.inflate(R.layout.f_new_program_form, null);
        Spinner sp = (Spinner) v.findViewById(R.id.spinnerExercises);
        ExerciseSpinnerAdapter spAdapter = new ExerciseSpinnerAdapter(mA);

        LoadTask task = new LoadTask((BBBaseAdapter) spAdapter,
                URLs.host + URLs.allExercisesUrl, mA);
        task.execute();
        sp.setAdapter(spAdapter);
    }
    return v;
} 
```

练习SpinnerAdapter.java：

```
public class ExerciseSpinnerAdapter extends BBBaseAdapter implements
    SpinnerAdapter {

protected JSONArray data = new JSONArray();

public ExerciseSpinnerAdapter(Activity a) {
    super(a);
}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return this.data.length();
}

@Override
public JSONObject getItem(int position) {
    try {
        return this.data.getJSONObject(position);
    } catch (JSONException e) {
        e.printStackTrace();
    }
    return null;
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
public int getItemViewType(int position) {
    return 0;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        v = mA.getLayoutInflater().inflate(R.layout.custom_spinner, parent,
                false);

    }
    TextView t = (TextView) v.findViewById(R.id.spinnerTextZZ);
    try {
        t.setText(getItem(position).getString("name"));
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
     t.setTextColor(Color.RED);

    return v;
}

@Override
public int getViewTypeCount() {
    // TODO Auto-generated method stub
    return 1;
}

@Override
public boolean hasStableIds() {
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean isEmpty() {
    // TODO Auto-generated method stub
    return false;
}

@Override
public void registerDataSetObserver(DataSetObserver observer) {
    // TODO Auto-generated method stub

}

@Override
public void unregisterDataSetObserver(DataSetObserver observer) {
    // TODO Auto-generated method stub

}

@Override
public View getDropDownView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        v = mA.getLayoutInflater().inflate(R.layout.custom_spinner, parent,
                false);

    }
    TextView t = (TextView) v.findViewById(R.id.spinnerTextZZ);
    try {
        t.setText(getItem(position).getString("name"));
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
     t.setTextColor(Color.RED);
    return v;
}

@Override
public void updateEntries(Object data) {
    this.data = (JSONArray) data;
    notifyChanges();
}   

public void notifyChanges() {
    notifyDataSetChanged();
}

} 
```

custom_spinner：

```
 < TextView xmlns:android="http://schemas.android.com/apk/res/android" 
   android:id="@+id/spinnerTextZZ"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:padding="0dp"
   android:layout_margin="0dp"
   android:text="!"
   android:textAppearance="?android:attr/textAppearanceMedium" android:textColor = "#000000" /> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T21:30:55.023

如果你有我有的额外方法：

```
@Override
public int getViewTypeCount() {
// TODO Auto-generated method stub
return 1;
}

@Override
public boolean hasStableIds() {
// TODO Auto-generated method stub
return false;
}

@Override
public boolean isEmpty() {
// TODO Auto-generated method stub
return false;
}

@Override
public void registerDataSetObserver(DataSetObserver observer) {
// TODO Auto-generated method stub

} 
```

删除它们或实施。但是如果你扩展 BaseAdapter 它们已经实现了。不知道我从哪个例子中得到它们。

# java - Appengine 应用的部署耗时太长？

> ID：14983442
> 
> 赞同：1
> 
> 时间：2013-02-20T15:20:41.797
> 
> 标签：java, eclipse, google-app-engine

我尝试将我的 appengine 应用程序在 eclipse 上部署到服务器（通过来自日本的 ADSL），上传大约 40 分钟后，它失败并出现错误：com.google.appengine.tools.admin.OAuth2ServerConnection$OAuthInvalidTokenException: 发布到 URL 时出错：[https ://appengine.google.com/api/appversion/rollback?app_id=XXXXX&version=1&](https://appengine.google.com/api/appversion/rollback?app_id=XXXXX&version=1&) 401 Unauthorized Invalid OAuth token

我的问题是：

1）我的项目文件夹的东西现在大约有 500MB。是不是太大了？

2）如果我的项目在构建路径上引用了另一个项目，部署工具是否也会上传整个项目？

3）我试图取消部署过程。10 分钟后，控制台上出现“用户已取消”消息。但之后这个过程会持续很长时间。禁止取消部署？

4) 错误信息是什么意思？

我很感激任何建议。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:51:46.323

500MB 的项目源代码太大了，当然需要一些时间来部署。你确定你需要所有这些文件吗？

我怀疑您正在上传大量静态文件，我猜这些文件可能（应该）被区别对待。

如果您想排除某些文件在 Google App Engine 上的部署，请参阅[Java 应用程序配置](https://developers.google.com/appengine/docs/java/config/appconfig#Including_and_Excluding_Files)中的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T06:13:48.843

使用最新的 App 引擎 SDK。我从 1.7.0 升级到 1.7.7，我的部署从 10 多分钟缩短到了几秒钟！（我的项目大约是 230MB）

我在取消时面临同样的问题。我发现让它完成部署然后重新部署更容易和更快，而不是等待它取消。

# javascript - jquery if else 语句

> ID：14983443
> 
> 赞同：0
> 
> 时间：2013-02-20T15:20:45.877
> 
> 标签：javascript, jquery, jquery-mobile

我在这里做错了什么？这是在 jquery-mobile 上。

```
$('.ui-checkbox').click(function() {
if ( 
    $('.ui-checkbox label.ui-checkbox-off').removeClass('off').addClass('on')) {        
}else {
    $('.ui-checkbox label.ui-checkbox-on').removeClass('on').addClass('off');
}
}); 
```

第一部分有效，但当我第二次单击时无效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T15:23:21.900

从您的评论中，您似乎想要

```
$('.ui-checkbox').click(function() {
   $('label.ui-checkbox-on,label.ui-checkbox-off', this)
        .toggleClass('on').toggleClass('off');
}); 
```

但这有点奇怪。您可以使用一个简单的类 ( `on`) 并简单地做

```
$('.ui-checkbox').click(function() {
   $('label', this).toggleClass('on');
}); 
```

您可能不需要 2 类，因为通常“关闭”意味着“不开启”。

# html - 将表单值直接提交到 URL 中？

> ID：14983444
> 
> 赞同：3
> 
> 时间：2013-02-20T15:20:48.007
> 
> 标签：html, url, variables, coldfusion

我在我的网站上为我的搜索功能创建了一个分页器。分页器工作得很好，搜索功能也是如此。但是，我遇到的问题是我不得不使用多余的代码来传递表单的值来运行查询。理想情况下，我希望它这样当我按下提交按钮+页面提交时，它将表单中的值作为 URL 变量直接发布到 URL 中，但是目前我正在提交它，检查是否有问题的表单是定义，然后将该值存储到变量中，将该变量通过所有页面链接的 URL 传递，然后将其存储为 URL 变量。我想去掉这个中间人，让它成为一个 URL 变量。有什么建议么？多谢你们。

```
<cfif IsDefined("form.search")>
    <cfset search = form.search>
</cfif>

<cfquery datasource="test.datasource" name="findbands">
    Select test_band
    From test
    Where test_band LIKE <cfqueryparam value="%#search#%" cfsqltype="cf_sql_varchar" />
</cfquery>

<FORM action="band_search.cfm" method="post">
    <INPUT type="text" name="search"></INPUT>
    <INPUT type="submit" value="Go"></INPUT>
</FORM>

<cfoutput query="findbands" startrow="1" maxrows="10">
    #currentrow#) #test_band#
</cfoutput>

<cfif IsDefined("search")>
    <cfset link = CGI.script_name & "?search=" & search>
    <A href="#link#>Previous</A>
</cfif>

<cfif IsDefined("search")>
    <cfset link = CGI.script_name & "?search=" & search>
    <A href="#link#>Next</A>
</cfif> 
```

我没有在上面演示它，但我有一些代码传递一个 URL 变量，编辑起始行并计算页面总数。然而，这无关紧要。我需要的解决方案是在提交表单时我可以只使用 URL.search 而不必创建变量搜索，如图所示。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:41:40.357

使用“get”而不是“post”的方法。它将所有输入作为 URL 参数附加到操作字符串。

换行：

```
<FORM action="band_search.cfm" method="post"> 
```

到：

```
<FORM action="band_search.cfm" method="get"> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T15:42:46.697

您可以使用 jQuery 的 POST 表单添加参数，如下所示：

```
$(".submit").click(function() { 
    //gettting the value
    var search_val = $('input#search').val();
    //add hidden input
    $("#formID").append("<input type='hidden' name='search' value='"+search_val+"' />").submit(); 
}); 
```

### 编辑：

也许这不是更好的方法，但是如果您只是想通过 url 传递参数，您可以在提交表单之前更改表单的操作。

```
$(".submit").click(function() { 
     //gettting the action of the form
     var action = $("#formID").attr("action");
     //changing the value of the form
     action += "?search="+$('input#search').val();
     //Now submit the form
     $("#formID").attr("action", action ).submit(); 
}); 
```

**更新：**更新您的问题后，我认为您只需要更改`POST`；`GET`）

# html - 为什么页脚不是 100% 宽度？

> ID：14983450
> 
> 赞同：0
> 
> 时间：2013-02-20T15:20:57.583
> 
> 标签：html, css

我希望我的页脚占据页面底部的所有水平空间，`width 100%`但由于某种原因它位于页面中心并且似乎具有我的包装器的特征。这是图片（网站尚未上线，所以我无法提供链接）

![在此处输入图像描述](../Images/19d9e3e7c226f48b39a99b1ef18c0d0b.png)

黑色页脚应该占据底部的所有水平空间，我将包含我认为导致此问题的代码（代码简化，因此与图像不同）。

JSfiddle [http://jsfiddle.net/aHpua/4/](http://jsfiddle.net/aHpua/4/)

**HTML**

```
<div class="content">
            <article class="content-info">Content
            </article>
            <aside class="sidebar">
                <h4>MORE INFORMATION</h4>
                <ul>
                    <li>
                        <a href="#">Item1</a>
                    </li>

                    <li>
                        <a href="#">Item2</a>
                    </li>
                </ul>
            </aside>
    </div><!-- END.content-wrapper -->
    <div class="contact-us">
        <h2>
            Have any questions for us?
            <a href="#">CONTACT US</a>
        </h2>
    </div><!-- END.contact-us -->
<div class="footer-container">
        <div class="wrapper">
            <footer class="footer">
                <ul>
                    <li>Tel:<span> 0000</span></li>
                    <li>Fax:<span> 0000</span></li>
                    <li>Email: <a href="mailto:nla@bla.com">bla</a></li>
                    <li><h1>Company Name</h1></li>
                </ul> 
            </footer>
        </div>
        <!-- END.footer-wrapper -->
        <div class="copyright">
            <div class="wrapper">
                &copy; Copyright 2013.
            </div><!-- END.copyright-wrapper -->
        </div>
    </div><!-- END.footer-container -->    
        <?php wp_footer(); ?>
       <!-- Google Analytics --> 
    </body>
</html> 
```

**CSS**

```
/* ==========================================================================
   =content
   ========================================================================== */

.content {
    background-color: #fff;
    border: 1px solid #e1e1e1;
    padding: 30px 65px 30px 65px;
    z-index: 999;
    overflow: hidden;
    box-shadow: 0 -1px 0 #ffffff inset,
                0 -2px 0 #ebebeb inset,
                0 -3px 0 #ffffff inset,
                0 -4px 0 #efefef inset;
}

.contact-us {
    background-color: #f9faf6;
    padding: 30px 65px 30px 65px;
    border-left: 1px solid #e1e1e1;
    border-right: 1px solid #e1e1e1;
    border-bottom: 1px solid #e1e1e1;
    box-shadow: 0 4px 5px -5px #d3d3d3 inset;
    clear: both;
}

.content-info {
    float: left;
    width: 590px;
    background: red;
    line-height: 25px;
}

.sidebar {
    float: right;
    width: 220px;
    line-height: 25px;
}

/* ==========================================================================
   =footer
   ========================================================================== */

.footer-container {
    background-color: #2a2a2b;
    background-image: url(img/header_bg.png);
    overflow: hidden;
    margin-top: 25px;
    width: 100%;
}

.footer {
    border-top: 5px solid #00b2e5;
    overflow: hidden;
}

.copyright {
    background-color: #242424;
    color: #6b6b6b;
    width: 100%;
}

.copyright .wrapper {
    padding: 7px 65px 7px 65px;
    width: 850px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:30:42.923

据我所知，这是一个 wordpress 主题。确保您的页脚不在 #page 内，它具有固定的宽度和边距 0 自动。

该 div 以 header.php 开始，以 footer.php 结束。

确保您的代码验证并且您没有未关闭的 div。如果页眉中有#page，请在页脚之前将其关闭

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:27:05.667

似乎 .content、.footer-container 等必须在某处具有固定宽度的共同父级。width: 100% 只会使页脚与父级一样宽，而不是更宽，因此您必须将其移到外面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T15:37:57.027

```
.wrapper {
width: 980px;
margin: 0 auto;
} 
```

该对象位于 .wrapper 内部

# c - 在管道上读/写，用C完成文件复制

> ID：14983451
> 
> 赞同：0
> 
> 时间：2013-02-20T15:20:59.597
> 
> 标签：c, pipe

我正在尝试从文件中读取，将其写入管道，然后在子进程中从管道中读取并将其写入新文件。程序传递了两个参数：输入文件的名称和要复制到的文件的名称。这是一个家庭作业项目，但我在网上花了几个小时，并且只找到了让它变得更加混乱的方法。我们得到了两个任务，这个和矩阵乘法与线程。我得到了矩阵乘法没有问题，但是这个应该相当容易，我遇到了很多麻烦。我得到了我正在复制的文件的第一个单词，但随后出现了一大堆乱码。

```
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>

int main(int argc, char *argv[]) {

    if(argc < 3) {
        printf("Not enough arguments: FileCopy input.txt copy.txt\n");
        exit(0);
    }
    char buffer[200];

    pid_t pid;
    int fds[2];

    pipe(fds);
    pid = fork();

    if (pid == 0) { /* The child process */
        //wait(NULL);
        write(1, "hi i am in child\n", 17);
        int copy = open(argv[2], O_WRONLY | O_CREAT, S_IWUSR | S_IRUSR | S_IXUSR | S_IRGRP);
        FILE* stream;
        close(fds[1]);

        stream = fdopen(fds[0], "r");
        while (fgets(buffer, sizeof(buffer), stream) != NULL) {
            //printf("%s\n", buffer);
            write(copy, buffer, 200);
            //printf("kjlkjljljlkj\n");
            //puts(buffer);

        }

        close(copy);
        close(fds[0]);

        exit(0);

    }
    else {
        write(1, "hi i am in parent\n", 18);
        FILE* input = fopen(argv[1], "r");
        FILE* stream;
        close(fds[0]);
        stream = fdopen(fds[1], "w");
        /*while (fscanf(input, "%s", buffer) != EOF) {
            //printf("%s\n", buffer);
            fprintf(stream, "%s\n", buffer);
            fflush(stream);
            //printf("howdy doody\n");
        }*/
        fgets(buffer, sizeof(buffer), input);
        printf("%s", buffer);
        fprintf(stream, "%s", buffer);
        fflush(stream);
        close(fds[1]);
        fclose(input);
        wait(NULL);
        exit(0);
    }
    return 0;
} 
```

我做错了读写吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:30:48.507

*我做错了读写吗？*

是的。

在孩子中，您将面向字符串的缓冲 I/O (fgets()) 与面向块的二进制 I/O 混合在一起。（即 write()。）这两种方法都可以，但通常的做法是选择其中一种。

如果将它们混合在一起，则必须考虑问题的更多方面。例如，在孩子中，您只从管道中读取一行，但随后将整个缓冲区写入文件。这是您可能在文件中看到的乱码的来源。

在父级中，您只发送没有循环的单行。之后，在 fclose() 缓冲 I/O 系统之前关闭底层文件描述符。这意味着当 fclose 尝试刷新缓冲区时，现在关闭的描述符将无法写入任何剩余的数据。

您可以使用 write()/read()/close()，它们是 Posix 指定的内核级操作，也可以使用 fdopen/puts/gets/fclose，它们是 ISO C 指定的标准 I/O 库操作。现在，有一种混合它们的方法会起作用。如果您在父级中使用 stdio，您仍然可以在子级中使用读/写，但是您将为每一行进行内核调用，这通常不是理想的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:33:05.910

您通常应该只使用读/写调用来读/写管道。

您应该为子（只读）和父（只写）关闭管道的相应端。然后，使用 write()-systemcall 从父级写入管道。并在孩子使用 read()-systemcall 阅读。

[在这里](http://tldp.org/LDP/lpg/node11.html)寻找一个很好的解释。

# asp.net - 从查询中填充多维数组（递归关系）

> ID：14983452
> 
> 赞同：1
> 
> 时间：2013-02-20T15:21:01.547
> 
> 标签：asp.net, arrays, vb.net, multidimensional-array

我正在尝试填充一个支持以下递归关系的多维数组（数据来自数据库表）。

这个多维数组将用于生成下面的列表。我对 VB.NET 中的多维数组的经验很少。任何帮助将不胜感激。如果您认为有更好的方法来实现这一点，请告诉我。

数据

```
ID      NAME                PARENTID
10      Bobby Brown         50          
20      Dave Matthew        80
30      Sergey Boostad      50
40      Linda View          50
50      Bill Lumberg        
60      Rina Gina           50
70      Ben Thompson        100
80      Maria Tree          50
90      Gustav Duffield     80
100     Jon Theodore        
110     Cedric Loomis       100 
120     Jeremy Oscar        100 
```

输出（实现）

```
[50] - Bill Lumberg
    [10] - Bobby Brown
    [30] - Sergey Boostad
    [40] - Linda View
    [60] - Rina Gina
    [80] - Maria Tree
        [20] - Dave Matthew
        [90] - Gustav Duffield
[100] - Jon Theodore    
    [70] - Ben Thompson
    [110] - Cedric Loomis       
    [120] - Jeremy Oscar 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:57:00.677

要将树存储在内存中，您可以创建这样的类：

```
Public Class NameNode
    Public Sub New(name As String)
        Me.Name = name
    End Sub

    Public Property Name As String
    Public Level As Integer
    Public Property Children As New List(Of NameNode)
End Class 
```

然后，您可以像这样使用它：

```
Dim bill As New NameNode("Bill Lumberg")
bill.Children.Add(New NameNode("Bobby Brown")
bill.Children.Add(New NameNode("Sergey Boostad") 
```

要从 flat 填充它`DataSet`，您需要创建一个递归方法，例如：

```
Public Function BuildNode(data As DataSet, nameId As Integer, level As Integer), As NameNode
    Dim node As New NameNode()
    node.Level = level
    ' Find name with the ID in the dataset and set the node's name property accordingly
    Dim childIds As New List(Of Integer)
    ' Search Get a list of all the name ID's that have the current ID as their parent
    For Each i As Integer In childIds
        node.Children.Add(BuildNode(data, i, level + 1))
    Next
    Return node
End Function 
```

然后你可以通过这样调用它来构建整个 Bill Lumberg 分支：

```
Dim bill As NameNode = BuildNode(data, 50, 0) 
```

# jquery - 如何在文本字段附近制作一列按钮

> ID：14983456
> 
> 赞同：1
> 
> 时间：2013-02-20T15:21:09.160
> 
> 标签：jquery, html, css, jquery-mobile, layout

我尝试了以下代码：

```
<div>
    <div>
        <a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true"></a>
        <a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true"></a>
    </div>
    <div>${comment.value}</div>
</div> 
```

它给了我以下结果：

![我有的布局](../Images/976513cd01333e4b9aa92008b3bef2ca.png)

我想做以下事情：

![我想要的布局](../Images/ff27eae4f779b098c027c2c7de5c67c3.png)

我尝试使用“ui-block-a”、“ui-block-b”类但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:33:29.423

这是一个工作示例：http: [//jsfiddle.net/Gajotres/kLfxg/](http://jsfiddle.net/Gajotres/kLfxg/)

它使用为 jQuery Mobile 构建的[fluid960网格。](http://jeromeetienne.github.com/jquery-mobile-960/)

**HTML：**

```
 <fieldset class="container_12">
            <div class="grid_1"><a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true"></a></div>
            <div class="grid_11">This is some button text</div>     
        </fieldset>
        <fieldset class="container_12">
            <div class="grid_1"><a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true"></a></div>
            <div class="grid_11">This is some button text</div>     
        </fieldset> 
```

**CSS：**

```
.grid_11 {
    line-height: 35px;
} 
```

而且因为这是灵活的网格（如 jQM 原始网格），这条线将使其宽度固定：

```
.container_12 .grid_1 {
    width: 40px !important;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:30:29.113

理论上，下面的代码应该做到这一点。

```
<div>
    <div style="float:left;">
        <a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true"></a>
        <a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true"></a>
    </div>
    <div>${comment.value}</div>
</div> 
```

我建议使用 css 类而不是内联 css，样式标签应该放在你的标题中。

```
<style>
    .left {float:left;}
</style>
<div>
    <div class="left">
        <a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true"></a>
        <a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true"></a>
    </div>
    <div>${comment.value}</div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:36:36.670

网格布局应按`ui-grid`类包装。

```
<div class="ui-grid-a">
 <div class="ui-block-a">
   <a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true">
   </a>
 </div>
 <div class="ui-block-b">Test Comment</div>
 <div class="ui-block-a">
  <a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true">
  </a>
 </div>
</div> 
```

JSfiddle：[测试](http://jsfiddle.net/NMM4B/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T12:10:57.357

使用 jquery mobile 的方法。正如我在问题中所说 - 尝试使用“ui-block-a”类，但我以错误的方式使用它 - 它应该同时提供给嵌套块和外部块。以下代码产生所需的行为：

```
<div class="ui-block-a">
    <div class="ui-block-a">
        <a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true"></a>
        <a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true"></a>
    </div>
    <div class="ui-block-a">${comment.value}</div>
</div> 
```

另请参阅[仅使用 css 回答](https://stackoverflow.com/a/14983678/222892)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-20T15:28:00.940

您需要将文本放在代码中的按钮旁边，而不是在其下方。

```
<div>
    <div>
        <a href="#" data-role="button" data-icon="plus" data-iconpos="notext" data-mini="true"></a> <span>${comment.value}</span>
        <a href="#" data-role="button" data-icon="minus" data-iconpos="notext" data-mini="true"></a>
    </div>
</div> 
```

您还没有显示您的 CSS，所以我不知道您是否需要更改其中的任何内容，但是此代码会将您的文本放在正确的位置，以便您能够在按钮旁边显示它。

# android - 致命异常 - 从服务器下载文件后开始播放视频时

> ID：14983457
> 
> 赞同：0
> 
> 时间：2013-02-20T15:21:09.203
> 
> 标签：android

我正在从服务器下载文件，然后将它们保存在内部。一旦我想播放视频，应用程序就会出现此错误日志

它一到达这条线就会中断：或者在它之后，即使我删除了这条线

```
videoView.setVisibility(View.VISIBLE);

02-20 17:18:29.533: I/media player(26499): play media!
02-20 17:18:29.533: I/FILENAME(26499): video_tvr_webtrailer2.mp4
02-20 17:18:29.533: I/media player(26499): play video!
02-20 17:18:29.533: W/dalvikvm(26499): threadid=11: thread exiting with uncaught exception (group=0x40bf31f8)
02-20 17:18:29.533: E/AndroidRuntime(26499): FATAL EXCEPTION: Thread-7014
02-20 17:18:29.533: E/AndroidRuntime(26499): android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.ViewRootImpl.checkThread(ViewRootImpl.java:4142)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.ViewRootImpl.requestLayout(ViewRootImpl.java:762)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.requestLayout(View.java:12727)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.requestLayout(View.java:12727)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.requestLayout(View.java:12727)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.requestLayout(View.java:12727)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.requestLayout(View.java:12727)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.setFlags(View.java:6767)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.View.setVisibility(View.java:4664)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at android.view.SurfaceView.setVisibility(SurfaceView.java:235)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at com.example.tvrplayer.MainActivity.playMedia(MainActivity.java:163)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at com.example.tvrplayer.MainActivity.createPlayList(MainActivity.java:184)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at com.example.tvrplayer.MainActivity.access$1(MainActivity.java:170)
02-20 17:18:29.533: E/AndroidRuntime(26499):    at com.example.tvrplayer.MainActivity$2.run(MainActivity.java:228)
02-20 17:18:34.572: D/OpenGLRenderer(26499): Flushing caches (mode 0)
02-20 17:18:36.291: D/OpenGLRenderer(26499): Flushing caches (mode 1) 
```

这是我的代码：

```
package com.example.tvrplayer;

import java.io.File;
import java.io.FileDescriptor;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.text.DateFormat.Field;
import java.util.ArrayList;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.media.MediaPlayer;
import android.media.MediaPlayer.OnCompletionListener;
import android.net.Uri;
import android.os.Bundle;
import android.os.Handler;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.ContextWrapper;
import android.content.res.AssetFileDescriptor;
import android.graphics.drawable.AnimationDrawable;
import android.widget.ImageView;
import android.widget.VideoView;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.WindowManager;

public class MainActivity extends Activity implements OnCompletionListener {

    int playListIndex;
    int currentMedia;
    String mediaName;
    ArrayList<Integer> playList = new ArrayList<Integer>();
    File[] filelist;
    private VideoView videoView;
    private ImageView imageView;
    Uri mediaPath;
    private Handler mHandler = new Handler();

//  Get this shit from login!
    public String channelid = "5e6d-e673-46b1-9ffd-a16600d58fc9";
    public String username = "sd@ere.co";
    public String linkid = "70sd3f-e054-4f33-9b6b-a16600d3f7d7";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);

        File mediadir = getDir("tvr", Context.MODE_PRIVATE);
//        filelist = mediadir.listFiles();
        try {
            getProgramList();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

//       Delete all files in folder
        if (mediadir.isDirectory()) {
            String[] children = mediadir.list();
            for (int i = 0; i < children.length; i++) {
                new File(mediadir, children[i]).delete();
            }
        }

//        videoView = (VideoView) findViewById(R.id.videoView);
//      videoView.setVisibility(View.VISIBLE);
//      videoView.setOnCompletionListener(this);
//      String path = "android.resource://" + getPackageName() + "/" + R.raw.tvr_webtrailer2;
//      Uri uri = Uri.parse(path);
//      videoView.setVideoURI(uri);
//      videoView.start();

//      currentMedia = 1;
//      createPlayList(this);
//      try {
//          getProgramList(this);
//      } catch (IOException e) {
//          e.printStackTrace();
//      } catch (JSONException e) {
//          e.printStackTrace();
//      }
//      are there any files? if not download some, still not? keep checking every few seconds.

//      try {
//          getProgramList(this);
//      } catch (IOException e1) {
//          // TODO Auto-generated catch block
//          e1.printStackTrace();
//      } catch (JSONException e1) {
//          // TODO Auto-generated catch block
//          e1.printStackTrace();
//      }
//      createPlayList(this);
//      currentMedia = 1;
//      try {
////            
//          playMedia(this, currentMedia);
//      } catch (IOException e) {
//          // TODO Auto-generated catch block
//          e.printStackTrace();
//      }
    }
    @Override
    public void onCompletion(MediaPlayer mp) {
        Log.i("media player", "play next please!");
        if (mp != null) {
            videoView.setVisibility(View.GONE);
        }
//      play next video
        currentMedia++;
        if (currentMedia > playList.size() - 1) {
            currentMedia = 0;
        }
        Log.d("MEDIA_COUNTER", String.format("%d", currentMedia));
        try {
            playMedia(currentMedia);
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
    private void playMedia(int playListIndex) throws IOException {
        Log.i("media player", "play media!");
//      int resourceID = filelist.get(playListIndex); // This is the resource id
//      String path = "android.resource://" + getPackageName() + "/" + resourceID;
        String path = filelist[playListIndex].getAbsolutePath();
        final Uri uri = Uri.parse(path);
        String filename = filelist[playListIndex].getName();
        Log.i("FILENAME",filename);
        if (filename.contains("image")) {
            imageView = (ImageView)findViewById(R.id.imageView);
            imageView.setVisibility(View.VISIBLE);
//          imageView.setImageURI(uri);
            mHandler.postDelayed(new Runnable() {
                public void run() {
                    imageView.setVisibility(View.GONE);
                    imageView.setImageURI(uri);
                    onCompletion(null);
                }
            }, 3000);
        } else if (filename.contains("video")) {
            Log.i("media player", "play video!");
            videoView = (VideoView) findViewById(R.id.videoView);
            videoView.setVisibility(View.VISIBLE);
            videoView.setOnCompletionListener(this);
            videoView.setVideoPath(path);
            videoView.start();
        }
    }

    private void createPlayList(Context context) {
        ContextWrapper cw = new ContextWrapper(context);
        File mediadir = cw.getDir("tvr", Context.MODE_PRIVATE);
        filelist = mediadir.listFiles();
        if (filelist != null)
        {
            for ( int i = 0;i<filelist.length;i++)
            {
               Log.i("FOKKER", filelist[i].getName());
               Log.i("FOKKER", filelist[i].getAbsolutePath());
            }
        }
        currentMedia = 0;
        try {
            playMedia(currentMedia);
        } catch (IOException e) {
            e.printStackTrace();
        }

//      java.lang.reflect.Field[] fields = R.raw.class.getFields();
//      for(java.lang.reflect.Field f : fields)
//      try {
//          playList.add(f.getInt(null));
//          } catch (IllegalArgumentException e) {
//          } catch (IllegalAccessException e) { }      

    }

    private void downloadMedia() throws IOException, JSONException {
        getProgramList();
    }

    private void getProgramList () throws IOException, JSONException {
        Thread thread = new Thread() {
            @Override
            public void run() {
                ContextWrapper cw = new ContextWrapper(getBaseContext());
                File mediadir = cw.getDir("tvr", Context.MODE_PRIVATE);
                JSONArray json = Json.getJson("http://192.168.2.136:8080/rest/program/"+ linkid +"/"+ username +"/" + channelid, "GET");
                try {
                    for (int i=0; i < json.length(); i++) { 
                        JSONObject json_data = json.getJSONObject(i);
                        String name = json_data.getString("Name").toLowerCase();
                        name = name.replace("-", "_");
                        if (name.contains("mp4")) {
                            name = "/video_"+name;
                        } else if (name.contains("png") || name.contains("jpg") || name.contains("jpeg")) {
                            name = "/image_"+name;
                        }
                        File file = new File(mediadir, name);
                        if(file.exists()) {} else {
                            download(this, name, "http://192.168.2.136:8080/rest/transfer/"+ linkid +"/"+ username +"/" + json_data.getString("ID"));
                        }
                    }
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                createPlayList(cw);
            }

            private void download(Thread thread, String name, String urlString) {   
                File mediadir = getDir("tvr", Context.MODE_PRIVATE);
                try {
                    URL url = new URL(urlString);
                    URLConnection conexion = url.openConnection();
                    conexion.connect();
                    int lenghtOfFile = conexion.getContentLength();
                    InputStream is = url.openStream();
                    Log.d("DOWNLOAD NAME",name);
                    FileOutputStream fos = new FileOutputStream(mediadir+name);
                    byte data[] = new byte[1024];
                    int count = 0;
                    long total = 0;
                    int progress = 0;
                    while ((count=is.read(data)) != -1){
                        total += count;
                        int progress_temp = (int)total*100/lenghtOfFile;
                        if(progress_temp%10 == 0 && progress != progress_temp){
                            progress = progress_temp;
                        }
                        fos.write(data, 0, count);
                    }
                    is.close();
                    fos.close();
                } catch (Exception e) {
                    // TODO Auto-generated catch block
                    Log.e("DOWNLOAD", e.toString());
                }
            } 
        };
        thread.start();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:33:43.097

这意味着从您的线程中，您似乎在您的 ui 中触摸或使用视图。我不确定它会是什么，我需要仔细看看。

最好的办法是把所有 UI 的东西都放在线程之外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:33:51.597

尝试这个：

```
MainActivity.this.runOnUiThread(new Runnable()
{

 public void run()
 {
 Log.i("media player", "play video!");
            videoView = (VideoView) findViewById(R.id.videoView);
            videoView.setVisibility(View.VISIBLE);
            videoView.setOnCompletionListener(this);
            videoView.setVideoPath(path);
            videoView.start();
 }

}); 
```

如果它有效，那么您可能想尝试重构您的代码，使其更好。

# matlab - 比较中使用的值没有返回，为什么？

> ID：14983465
> 
> 赞同：-4
> 
> 时间：2013-02-20T15:21:38.643
> 
> 标签：matlab, select, pixels

在`matlab`，我有[这个](https://www.dropbox.com/s/53u5k9qntx5lchc/matlab.mat?n=13215274) `.mat`文件。如果你看里面并双击带有 vlues 的单元格`1.000`，你会发现出现的值是`0.999999999259113` . 没关系。但是，当我使用例如以下命令时：

```
>> sel = find (u2 == 0.999999999259113 ); 
```

我得到的答案如下：

```
>> sel

sel =

     5 
```

我们有不止一个`0.999999999259113`价值。我们不是吗？他们在哪里？应该是什么`5`？

现在，当我来到以下函数时，因为该`.mat`文件与[该](https://www.dropbox.com/s/xohl4i5earnxht8/fuzzysegmented.jpg?n=13215274)图像相关：

```
function s = pixel(x, y)
        pixels = [];
        index = 1;
        for i=1:length(y)
                for j=1:length(y)
                    if y(i,j) == 0.999999999259113;
                        pixels(index) = x(i,j);
                        index = index+1;
                    end
                end
            end
            pixels
        end 
```

而且，当我运行该函数时，我得到以下信息（I：图像，u2：.mat 文件）：

> > 像素（我，u2）；

像素 =

```
 [] 
```

空的？！这是什么意思？

有什么想法为什么我没有得到预期的结果，尽管这些命令似乎在逻辑上有效？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:27:42.457

您可以设置一个容差，而不是检查精确的浮点相等性吗？像这样找到接近 1.0 的值：

```
tolerance = 0.01;
sel = find(abs(u2 - 1.0) < tolerance); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:28:12.680

尝试使用

```
if abs(y(i,j)-)<1e-6 
```

代替

```
if y(i,j) == 0.999999999259113; 
```

# rotation - 在 HTML5 + Javascript 和 Canvas 中使用固定形状矩形检查旋转矩形命中点

> ID：14983469
> 
> 赞同：0
> 
> 时间：2013-02-20T15:21:53.043
> 
> 标签：rotation, html5-canvas, rectangles, hit

嗨，我正在制作一个汽车游戏，其中我绘制了一个汽车形状矩形，如下所示。xP 和 yP 动态来自 JavaScript 中的键盘事件，旋转也是如此。

```
ctxDrift.clearRect(0, 0, 426, 754);
ctxDrift.save();
ctxDrift.beginPath();
ctxDrift.translate(xP-car.getWidth()/2, yP-car.getHeight()/2);
ctxDrift.rotate((Math.PI / 180) * car.getRotation());
ctxDrift.translate(-xP, -yP);
ctxDrift.rect(xP-car.getWidth()/2, yP-car.getHeight()/2, car.getWidth(), car.getHeight());
ctxDrift.fillStyle = 'yellow';
ctxDrift.fill();
ctxDrift.restore(); 
```

现在有一些障碍物，矩形形状，没有旋转。现在我怎么能检查这两个对象之间的命中。或者说如何检查矩形点是否位于另一个矩形内，如果旋转？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T10:59:28.210

这就是我正在寻找的这个查询

[http://www.rgraph.net/blog/2012/october/new-html5-canvas-features.html](http://www.rgraph.net/blog/2012/october/new-html5-canvas-features.html)

canvas 现在有 addHitRegion() 函数，我们可以在其中轻松跟踪。

新的和最好的

[http://www.playmycode.com/blog/2011/08/javascript-per-pixel-html5-canvas-image-collision-detection/](http://www.playmycode.com/blog/2011/08/javascript-per-pixel-html5-canvas-image-collision-detection/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T21:55:15.160

最简单的方法是在进行碰撞检查之前旋转矩形边界框，这样它们基本上就不再旋转了。然后在绘制图像之前将它们旋转回来。

更好的是，有一个不旋转的边界框，可用于宽相位测试（快速且便宜的检查，看看您是否需要进行窄相位检查）。

这称为**轴对齐边界框**，简称 AABB。这大大简化了您的碰撞检测代码。

*更新：*发现[此链接](http://www.gamefromscratch.com/post/2012/11/26/GameDev-math-recipes-Collision-detection-using-an-axis-aligned-bounding-box.aspx)可能有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T01:10:24.857

*甚至在您开始进行碰撞测试之前：* Canvas 不会跟踪您的对象在画布上的位置。**您**必须手动跟踪用户完成的累积 .translate() 和 .rotate()。您可以通过捕获每个用户键盘事件的转换矩阵更改来做到这一点。然后将这些变换累积到一个最终的变换矩阵中，您可以使用它来*开始*命中测试。

从那里开始，碰撞测试的数学变得非常复杂！

您最简单的碰撞测试就是用一个圆包围每个矩形，然后计算圆的中心点是否在 2 个圆半径之和内。代码如下所示：

```
function CirclesCollide(x1,y1,radius1,x2,y2,radius2){
    return ( Math.sqrt( ( x2-x1 ) * ( x2-x1 )  + ( y2-y1 ) * ( y2-y1 ) ) < ( radius1 + radius2 ) );
} 
```

如果您想要更好的碰撞测试并且您愿意涉足大量数学，这里是 3 个碰撞测试的良好来源： [http :](http://www.sfml-dev.org/wiki/en/sources/simple_collision_detection) **//www.sfml-dev.org/wiki/en/sources/simple_collision_detection**

也许最好的解决方案是使用像 FabricJs 这样的画布库，它可以跟踪对象在画布上的位置并为您提供命中测试。就这么简单！

```
var theyAreColliding = myCar.intersectsWithObject(myObstical); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T14:10:18.357

我终于添加了自己的逻辑，在这里

[http://jslogic.blogspot.in/2013/02/javascript-bound-rectangle-area-while.html](http://jslogic.blogspot.in/2013/02/javascript-bound-rectangle-area-while.html)

# php - 在 node.js 中验证 php 证书

> ID：14983471
> 
> 赞同：2
> 
> 时间：2013-02-20T15:21:58.173
> 
> 标签：php, node.js, ssl, rsa

我有以下验证证书的 php 函数：

```
<?php

function raven_check_sig($data, $sig) {
    $key_path = '/path/to/pubkey.crt';
    $key_crt = file_get_contents($key_path);
    $key = openssl_get_publickey($key_crt);

    $result = openssl_verify($data, base64_decode($sig), $key);

    openssl_free_key($key);

    if ($result == 1) {
        return TRUE;
    } else {
        return FALSE;
    }
} 
```

我正在将我的应用程序移植到 node.js，但我不知道如何实现这个功能。

我努力了：

```
function checkSignature(data, sig, kid) {
  var keyPath = '/path/to/pubkey.crt';
  var key = fs.readFileSync(keyPath);

  var verifier = crypto.createVerify('RSA-SHA256');
  verifier.update(data);
  var res = verifier.verify(key, sig, 'base64');

  if (res) {
    return true;
  } else {
    return false;
  }
} 
```

但这似乎总是回归`false`。我有两个问题，我认为这可能是导致失败的原因：

1.  我不知道`RSA-SHA256`验证证书的算法是否正确，因为我无法弄清楚是什么`openssl_verify`。
2.  我不知道调用的等价物`openssl_get_publickey`是什么，假设我确实需要这样的东西。

该文件的内容`pubkey.crt`是：

```
-----BEGIN CERTIFICATE-----
MIIDrTCCAxagAwIBAgIBADANBgkqhkiG9w0BAQQFADCBnDELMAkGA1UEBhMCR0Ix
EDAOBgNVBAgTB0VuZ2xhbmQxEjAQBgNVBAcTCUNhbWJyaWRnZTEgMB4GA1UEChMX
VW5pdmVyc2l0eSBvZiBDYW1icmlkZ2UxKDAmBgNVBAsTH0NvbXB1dGluZyBTZXJ2
aWNlIFJhdmVuIFNlcnZpY2UxGzAZBgNVBAMTElJhdmVuIHB1YmxpYyBrZXkgMjAe
Fw0wNDA4MTAxMzM1MjNaFw0wNDA5MDkxMzM1MjNaMIGcMQswCQYDVQQGEwJHQjEQ
MA4GA1UECBMHRW5nbGFuZDESMBAGA1UEBxMJQ2FtYnJpZGdlMSAwHgYDVQQKExdV
bml2ZXJzaXR5IG9mIENhbWJyaWRnZTEoMCYGA1UECxMfQ29tcHV0aW5nIFNlcnZp
Y2UgUmF2ZW4gU2VydmljZTEbMBkGA1UEAxMSUmF2ZW4gcHVibGljIGtleSAyMIGf
MA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC/9qcAW1XCSk0RfAfiulvTouMZKD4j
m99rXtMIcO2bn+3ExQpObbwWugiO8DNEffS7bzSxZqGp7U6bPdi4xfX76wgWGQ6q
Wi55OXJV0oSiqrd3aOEspKmJKuupKXONo2efAt6JkdHVH0O6O8k5LVap6w4y1W/T
/ry4QH7khRxWtQIDAQABo4H8MIH5MB0GA1UdDgQWBBRfhSRqVtJoL0IfzrSh8dv/
CNl16TCByQYDVR0jBIHBMIG+gBRfhSRqVtJoL0IfzrSh8dv/CNl16aGBoqSBnzCB
nDELMAkGA1UEBhMCR0IxEDAOBgNVBAgTB0VuZ2xhbmQxEjAQBgNVBAcTCUNhbWJy
aWRnZTEgMB4GA1UEChMXVW5pdmVyc2l0eSBvZiBDYW1icmlkZ2UxKDAmBgNVBAsT
H0NvbXB1dGluZyBTZXJ2aWNlIFJhdmVuIFNlcnZpY2UxGzAZBgNVBAMTElJhdmVu
IHB1YmxpYyBrZXkgMoIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBAUAA4GB
AFciErbr6zl5i7ClrpXKA2O2lDzvHTFM8A3rumiOeauckbngNqIBiCRemYapZzGc
W7fgOEEsI4FoLOjQbJgIrgdYR2NIJh6pKKEf+9Ts2q/fuWv2xOLw7w29PIICeFIF
hAM+a6/30F5fdkWpE1smPyrfASyXRfWE4Ccn1RVgYX9u
-----END CERTIFICATE----- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:40:56.947

原来正确的算法是 SHA1：

```
function checkSignature(data, sig) {
  var keyPath = '/path/to/pubkey.crt';
  var key = fs.readFileSync(keyPath);

  var verifier = crypto.createVerify('SHA1');
  verifier.update(data);
  var res = verifier.verify(key, sig, 'base64');

  if (res) {
    return true;
  } else {
    return false;
  }
} 
```

所以现在一切正常:)

# django - Django 的缓存中间件在 Gunicorn 中无法使用 Debug=False

> ID：14983473
> 
> 赞同：1
> 
> 时间：2013-02-20T15:22:02.000
> 
> 标签：django, caching, gunicorn

我有一个使用 Gunicorn 和 nginx 部署的 Django 项目。我还运行了一个 memcached，并设置了 Django 缓存中间件 () 来缓存站点。

使用 DEBUG=True 运行时一切正常，但是当我切换到 DEBUG=False 时，尝试访问该站点时 Gunicorn 日志中出现以下错误：

```
2013-02-20 16:09:50 [25196] [ERROR] Error handling request
Traceback (most recent call last):
  File "/home/toursprung/.virtualenvs/myproject/lib/python2.6/site-packages/gunicorn/workers/sync.py", line 102, in handle_request
    respiter = self.wsgi(environ, resp.start_response)
  File "/home/toursprung/.virtualenvs/myproject/lib/python2.6/site-packages/django/contrib/staticfiles/handlers.py", line 67, in __call__
    return self.application(environ, start_response)
  File "/home/toursprung/.virtualenvs/myproject/lib/python2.6/site-packages/django/core/handlers/wsgi.py", line 247, in __call__
    status_text = STATUS_CODE_TEXT[response.status_code]
AttributeError: 'NoneType' object has no attribute 'status_code' 
```

奇怪的是，我在 Django 发送给我的错误电子邮件中收到另一个错误。在这里我得到以下信息：（GZIP 中间件中的错误。wtf？）

```
Traceback (most recent call last):

  File "/home/toursprung/.virtualenvs/myproject/lib/python2.6/site-packages/django/core/handlers/base.py", line 188, in get_response
    response = middleware_method(request, response)
  File "/home/toursprung/.virtualenvs/myproject/lib/python2.6/site-packages/django/middleware/gzip.py", line 16, in process_response
    if len(response.content) < 200:
  File "/home/toursprung/.virtualenvs/myproject/lib/python2.6/site-packages/django/http/__init__.py", line 699, in _get_content
    return ''.join([str(e) for e in self._container])

UnicodeEncodeError: 'ascii' codec can't encode character u'\x8b' in position 26: ordinal not in range(128) 
```

有人知道为什么会这样吗？

提前致谢， 安东

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T08:53:46.197

这是我的中间件的订购！

这是我的订单，这是**错误**的：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.cache.UpdateCacheMiddleware',
    'myproject.middleware.StripCookieMiddleware', # fix caching problem with analytics cookies
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.gzip.GZipMiddleware',
    ...
    'django.middleware.cache.FetchFromCacheMiddleware'
) 
```

我把`GZipMiddleware`右边移到了`UpdateCacheMiddleware`（好吧，我的小中间件在两者之间去掉了谷歌分析 cookie），现在一切都按预期工作了。

所以这是中间件的**正确**顺序：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.cache.UpdateCacheMiddleware',
    'myproject.middleware.StripCookieMiddleware', # fix caching problem with analytics cookies
    'django.middleware.gzip.GZipMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    ...
    'django.middleware.cache.FetchFromCacheMiddleware'
) 
```

也许这将在未来帮助某人......

# authentication - Kohana：使用 php-activerecord 的 auth 模块，但将错误视为“未找到 Class 'Arm'”

> ID：14983476
> 
> 赞同：0
> 
> 时间：2013-02-20T15:22:09.737
> 
> 标签：authentication, kohana, php, phpactiverecord

我在 kohana 中使用 PHP-activerecord 并通过调用函数使用它的 auth 模块：

```
User::create_user("Name", "Name", "Name", "Name"); 
```

但看到错误：ErrorException [致命错误]：找不到类'Arm'

我在 bootstrap.php 中添加了 kohana-activerecord 并启用了 Auth 模块。arm.php 位于 kohana-activerecord/classes/ 中。

有人可以帮助了解如何找到 Class arm 并删除此错误。这会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T18:18:00.750

假设您使用的是[https://github.com/devi/kohana-activerecord](https://github.com/devi/kohana-activerecord)，最简单的答案是手动加载该类。

`require_once('/kohana-activerecord/classes/arm.php')`在您的代码中，并执行此操作，直到您加载了所有依赖项。我不完全确定 Kohana-Auth 库是如何正确加载的，它的 github 页面上没有真正有用的文档。但我假设只需手动加载类就可以了，因为它已经有几年没有更新了。

# c# - 如何从 groupbox 中删除控件？

> ID：14983477
> 
> 赞同：1
> 
> 时间：2013-02-20T15:22:11.997
> 
> 标签：c#, dynamic, groupbox

我在 groupbox 中动态创建按钮，所以当我按下第二个按钮时，它应该在同一个 groupbox 中显示不同的按钮集，所以我需要删除早期的按钮才能获得新的按钮，我想对了还是有其他方法.

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:07:48.537

我使用了这些代码：

```
int c = groupBox6.Controls.Count;

for (int i = c - 1; i >= 0; i--)
    groupBox6.Controls.Remove(groupBox6.Controls[i]); 
```

这已经奏效了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:25:14.730

使用[.OfType](http://msdn.microsoft.com/en-us/library/bb360913.aspx)

```
var x = groupBox1.Controls.OfType<Button>().Where(c => c.Name == "button1").FirstOrDefault();
groupBox1.Controls.Remove(x); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-28T19:35:25.663

您可以使用此代码清除您的组框：

```
groupbox.Controls.Clear(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-12T16:46:09.433

for 循环现在对我有用。我尝试了一个 foreach(Control ctl in ParameterFrame)，它只删除了一半的控件。我以这样的方法一次添加两个控件：

ParameterFrame.Controls.Add(txt); ParameterFrame.Controls.Add(lbl);

由于某种原因， foreach() 只会删除我添加的两个中的第一个。在上述情况下，只有 txt（文本框）会被删除。如果我切换顺序并首先添加标签，则 foreach 只会删除标签并将文本框留在那里。为什么我不知道。尽管正如我所说，常规的 for 循环将它们全部删除。

# maven-assembly-plugin - Maven 程序集插件：存在冒号时过滤器不转义反斜杠

> ID：14983480
> 
> 赞同：1
> 
> 时间：2013-02-20T15:22:21.360
> 
> 标签：maven-assembly-plugin

我正在使用 Maven 程序集插件 2.4 过滤一些配置文件，并且遇到了问题，即在 .bat 文件中，当值包含冒号时，文字反斜杠不会被转义。

pom.xml：

```
<plugin>
  <artifactId>maven-assembly-plugin</artifactId>
  <version>2.4</version>
  <configuration>
    <filters>
      <filter>src/assembly/filter.properties</filter>
    </filters>
    <descriptors>
      <descriptor>src/assembly/assembly.xml</descriptor>
    </descriptors>
  </configuration>
</plugin> 
```

过滤器属性：

```
#Double (escaped) backslashes
testPath1 = a\\b\\c
testPath2 = c:\\test
#testPath3 contains no colon
testPath3 = c\\test 
```

测试.bat：

```
REM ${testPath1}
REM ${testPath2}
REM ${testPath3} 
```

测试属性：

```
path1=${testPath1}
path2=${testPath2}
path3=${testPath3} 
```

程序集.xml：

```
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
  <id>distribution</id>
  <formats><format>zip</format></formats>
  <files>
    <file>
      <source>${basedir}/src/assembly/testBat.bat</source>
      <outputDirectory>/</outputDirectory>
      <filtered>true</filtered>
    </file>
    <file>
      <source>${basedir}/src/assembly/testProp.properties</source>
      <outputDirectory>/</outputDirectory>
      <filtered>true</filtered>
    </file>
  </files>
</assembly> 
```

而这会产生...

testBat.bat（所有反斜杠都被转义了）：

```
REM a\b\c
REM c:\test\path
REM c\test\path 
```

testProp.properties（path2 中的反斜杠没有按预期转义！！！）：

```
path1=a\b\c
path2=c:\\test\\path
path3=c\test\path 
```

任何人都知道这是某种特殊功能，还是实际上是一个错误？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-06T08:50:40.057

作为更新，我现在使用 Ant 的 filterset 功能而不是 Maven 程序集插件的过滤。最初我想使用 Maven 创建特定于环境的工件，但由于环境略有不同，我决定只使用 Maven 构建一个交付包，然后在部署时让 Ant 脚本填充配置模板。

# android - Android Facebook SDK 无法添加项目

> ID：14983482
> 
> 赞同：0
> 
> 时间：2013-02-20T15:22:24.807
> 
> 标签：android, eclipse, facebook, macos, sdk

我一直在按照下面的教程进行操作，但在添加 Facebook SDK 时遇到了问题。

```
https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/ 
```

当我进入“链接到 SDK 项目并配置 Facebook 应用程序 ID”阶段时会发生这种情况。

当我转到属性 - > Android - > 添加并添加 FacebookSDK 时，它似乎工作正常。但是，当我保存并关闭该页面并返回该页面时，参考文献中有一个大 X。

我尝试进入项目属性并将其从相对 url 更改为完整 url，如下所示：

```
FROM android.library.reference.1=../../facebook
TO android.library.reference.1=/Users/michael/Documents/facebook-android-sdk-3.0/facebook 
```

如果不能正常工作，我无法使用 Facebook SDK 做任何事情。

我在 Mac OSX 上，不知道在 Eclipse ADT 中还能做什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-29T11:45:51.920

FacebookSDK 项目必须与用户项目位于 HDD 的同一部分。

例如：
`E:\Facebook Android SDK 3.5`- FacebookSDK 项目
`E:\Work\Restaurant`- 用户的项目

它适用于我在 Windows 7 上。也许，它也会在你的操作系统上帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T00:36:36.087

看看你的控制台。android 支持 jar 可能存在依赖项错误。我前几天刚遇到这个问题。如果是这种情况，您需要从主项目中删除 jar，并将 android 支持 jar 从 facebook SDK 复制到您的项目中。

编辑：如果这不是问题，请告诉我，我想我遇到了在我的应用程序中实现 Facebook 的所有可能问题。我很确定我可以帮助您建立联系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T01:47:40.307

抱歉，问题已解决。Eclipse 很奇怪。重新启动程序后，一切正常。

# cron - 具有初始延迟的 Cron 表达式 - Quartz

> ID：14983486
> 
> 赞同：1
> 
> 时间：2013-02-20T15:22:29.577
> 
> 标签：cron, quartz-scheduler

我只是可以弄清楚如何在 Quartz 中配置一个具有初始延迟的 Cron 作业。所以我需要一个每小时运行一次的东西，初始延迟为 10 分钟。

```
"* * 0/1 * * ?" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-05-25T20:30:04.787

这是一个迟到的答案，希望这对其他人有帮助。我通过在我的服务类中有 2 个预定功能解决了这个问题：

```
@EnableScheduling
public class DeviceService {

    @Scheduled(initialDelayString = "${devices.update.initial}", fixedDelay = 2592000000L)
    public void initialUpdateDevices() {
        updateDevices();
    }

    @Scheduled(cron = "${devices.update.cron}")
    public void cronUpdateDevices() {
        updateDevices();
    }

    private void updateDevices() {
        ...
    }
} 
```

初始延迟和 cron 表达式在 application.properties 中设置。fixedDelay 存在是因为 Spring 不允许单独使用 initialDelay。我将其设置为 2592000000ms，即 30 天。在我们的应用程序中，潜在的额外更新不会造成任何伤害。

在 application.properties 中：

```
devices.update.initial = 600000
devices.update.cron = 0 30 1 * * * 
```

最初在 10 分钟（60000 毫秒）后运行，然后在每晚 01:30 运行。

在用于单元测试的 application-test.properties 中：

```
devices.update.initial = 86400000
devices.update.cron = 0 30 1 24 12 * 
```

我们没有一个单元测试需要 1 天的时间来执行，所以 86400000 毫秒是一个安全的赌注。cron "0 30 1 24 12 *" 设置为人们应该梦想美好事物的平安夜之夜。

# php - jQuery 将表单数据发布到 PHP

> ID：14983487
> 
> 赞同：2
> 
> 时间：2013-02-20T15:22:30.420
> 
> 标签：php, jquery, ajax, forms, post

我使用 HTML 表单中的数据将数据从 jQuery 发布到 PHP。

这是发送 POST 的 jQuery 行

```
$.post("InsertNewQuestion.php", $("Create_Question_Form").serialize()); 
```

这是PHP代码

```
<?php
$con = mysql_connect("localhost","root","");

mysql_select_db("Quizzes",$con);

$Quiz_Name = $_POST['Question'];
echo $Quiz_Name;
$Option_1 = $_POST['Option1'];
echo $Option_1;
$Option_2 = $_POST['Option2'];
echo $Option_2;
$Option_3 = $_POST['Option3'];
echo $Option_3;
$Option_4 = $_POST['Option4'];
echo $Option_4;
$Option_5 = $_POST['Option5'];
echo $Option_5;

$rowIDList = mysql_query("SELECT rowID FROM TestQuiz");

$ColumnValues = array();

$CurrentGreatestRowID = -1;

$LCV = 1;

while($row1 = mysql_fetch_assoc($rowIDList)) {

    if ($CurrentGreatestRowID < $row1['rowID']) {
        $CurrentGreatestRowID = $row1['rowID'];
    }
    $LCV++;  
}   

$CurrentRowID = $CurrentGreatestRowID+1;        

$sql = "INSERT INTO TestQuiz (rowID,Quiz_Name,Option_1,Option_2,Option_3,Option_4,Option_5,Option_1_Votes,Option_2_Votes,Option_3_Votes,Option_4_Votes,Option_5_Votes)
VALUES(".$CurrentRowID.",'".$Question."','".$Option1."','".$Option2."','".$Option3."','".$Option4."','".$Option5."',0,0,0,0,0);";

if (mysql_query($sql,$con)) {
    echo "Inserted values";
}
else {
    echo ("Could not insert values: ". mysql_error());
}

mysql_close($con);
?> 
```

这是HTML表单

```
<form id="Create_Question_Form" action="" method="POST">
Question Name: input id="Question" class="Create_Question_Text_Box" type="text" name="Question_Name"><span id="Invalid_1"></span><br>
Option 1: input id="Option1" class="Create_Question_Text_Box" type="text" name="Option_1"><span id="Invalid_2"></span><br>
Option 2: input id="Option2" class="Create_Question_Text_Box" type="text" name="Option_2"><span id="Invalid_3"></span><br>
Option 3: input id="Option3" class="Create_Question_Text_Box" type="text" name="Option_3"><span id="Invalid_4"></span><br>
Option 4: input id="Option4" class="Create_Question_Text_Box" type="text" name="Option_4"><span id="Invalid_5"></span><br>
Option 5: input id="Option5" class="Create_Question_Text_Box" type="text" name="Option_5"><span id="Invalid_6"></span><br>
input type="Submit" id="Question_Submit" value="Create Question"></input>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:26:04.860

您的表单选择器应该是`#Create_Question_Form`. 注意`#`表明这是一个元素 ID。

```
$("#Create_Question_Form").serialize() 
```

**更新**

您正在`$_POST`通过 ID 而不是名称访问值。试试这个：

```
$Option_1 = $_POST['Option_1'];
$Option_2 = $_POST['Option_2'];
// etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T14:42:57.363

```
input type="Submit" id="Question_Submit" value="Create Question"></input>
<input type="Submit" id="Question_Submit" value="Create Question" /> 
```

你似乎没有少一个括号

# java - List 和 List 的区别

> ID：14983489
> 
> 赞同：4
> 
> 时间：2013-02-20T15:22:34.417
> 
> 标签：java, list, generics, wildcard, unbounded-wildcard

我已经阅读了很多关于此的内容，并且我知道：

```
List<Object> listOfObject = new ArrayList<TYPE>();   // (0)
//can only work for TYPE == Object.
//if TYPE extends Object (and thus objects of type TYPE are Objects),
//this is not the same with Lists: List<Type> is not a List<Object> 
```

现在我读到以下是可以的：

```
List undefinedList = new ArrayList<TYPE>();   // (1)
//works for ANY type (except for primitives) 
```

和

```
List<?> wildcardList = new ArrayList<TYPE>();   // (2)  
//also works for ANY type (except for primitives) 
```

然后：

```
List undefinedlist = new ArrayList(); //no TYPE specified
undefinedList.add(new Integer(1)); //WORKS
undefinedList.add(new String("string")); //WORKS 
```

然而：

```
List<?> wildcardList = new ArrayList<TYPE>(); //TYPE specified
wildcardList.add(new TYPE(...)); //COMPILER ERROR 
```

例子：

```
List<?> wildcardList = new ArrayList<String>(); //TYPE specified
wildcardList.add(new String("string")); //COMPILER ERROR: The method add(capture#1-of ?) in the type List<capture#1-of ?> is not applicable for the arguments (String) 
```

我明白为什么你不能向通配符列表添加任何东西，因为它的类型可以是任何东西。但是，为什么可以添加到 undefinedList 中？给定（1）和（2），它们看起来相同并表现出相同的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:34:04.780

`List undefinedList`和`List<?> wildcardList`你自己发现的不一样。第一个是原始类型，第二个是无界通配符。

如果您想使用泛型类型但不知道或不关心实际类型参数是什么，请使用无界通配符。你不能把任何东西（除了null）放到这个列表中，你所知道的关于你从中得到的元素是它们扩展了 Object （实际上`List<?>`与 相同`List<? extends Object>`）。无界通配符很有用，因为如果您天真地将某些内容声明为`List<Object>`，则无法将例如分配`List<String>`给它，而可以将 a 分配`List<String>`给 a`List<?>`

您应该（几乎）永远不需要使用原始类型，它们仅用于与 Java 5 之前编写的代码兼容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T18:20:33.347

`List<?>`被读取为一些未知类型的列表。作为程序员，您不能对它是什么类型做出任何假设，并且除了 null 之外，您不能将任何东西放入这样的集合中。但是您可以放心，您的列表是类型安全的，因为编译器会为您保证类型安全。

`List`基本上称为原始类型。也就是说，它选择了退出编译器保证的类型安全。因此，您可以将任何类型的元素放入该 List 中，从而破坏其不变量。不再使用原始类型进行编码。它们基本上支持向后兼容，因为 Java 已经处于发展的第二个十年，当时 Sun 将泛型带到了桌面上，并且使用原始类型编写了大量代码，否则这些程序会中断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:42:06.700

List 意味着这是一个未知类型的列表 - 因此您不会在创建时使用它（如您的示例中所示），您通常会将其用作方法参数。未绑定通配符仅在用作方法中的参数时才真正有用，例如：

```
public void printList(List<?> items) 
```

这可以迭代（任何）未知项目的列表。在这种情况下，列表项将达到相同的目的，但客户端可能会收到警告。

如果您有以下情况：

```
public void printList(List<Object> items) 
```

然后只能`Object`处理一个列表 - 不是列表字符串、整数等。只有对象。

看看[无界通配符](http://docs.oracle.com/javase/tutorial/java/generics/unboundedWildcards.html)- 它很好地解释了它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:25:28.643

“未定义”`List`包含类型列表，`Object`它是所有类型的父亲，因此`List`不是类型安全的（可相互转换）

这就是为什么：

```
List undefinedlist = new ArrayList<TYPE>(); //IS LIST OF OBJECTS
undefinedList.add(new Integer(1)); //WORKS
undefinedList.add(new String("string")); //WORKS 
```

好吧..工作！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T15:32:57.503

基本上，`?`在以下

```
List<?> wildcardList = new ArrayList<TYPE>(); 
```

表示某种未知（特定）类型。因此，它不允许您添加类似`String`, 或`Integer`某些未知类型的列表，因为泛型是类型安全的。

同时，在下面

```
List<Object> listOfObject = new ArrayList<TYPE>(); 
```

您可以向其中添加任何内容，因为一切都是`Object`Java 中的。所以它是类型安全的。

还有以下

```
List undefinedList = new ArrayList<TYPE>(); 
```

你告诉编译器你不想在那里使用泛型。这意味着您调用的每个方法`undefinedList`都将是非泛型的，因为您已决定使用 raw `List`。集合框架中所有容器的非通用版本都是为工作而编写的`Object`（Java 中的任何对象都是如此）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-20T15:27:19.223

该`List<?>`类型是通用的：您放置在问号位置的任何类型都将在列表的方法中使用。因此，您可以这样做`list.add(item)`，并且仅`String`当您创建了`List<String>`. 类型安全第一。

```
List<String> list = new List<String>();
list.add("A");             // <-- Correct
list.add((Integer)10);     // <-- Error, it is a List of Strings 
```

`List`另一方面，允许任何东西`Object`放在那里。所以你可以做一个`List`，把一个`Giraffe`放在那里，然后再放一个`Squid`。它不在乎，如果您希望只有`Giraffe`对象存在，它可能是编程错误的根源。

```
List list = new List();
list.add("A");             // <-- Allowed
list.add((Integer)10);     // <-- Also allowed,
                           // but now the list contains not only strings 
```

# php - 如何从 php 中的本地连接连接到 Heroku postgres 数据库

> ID：14983491
> 
> 赞同：9
> 
> 时间：2013-02-20T15:22:40.533
> 
> 标签：php, postgresql, heroku, local

我正在尝试从本地运行的 php 代码访问我的 Heroku Postgres 数据库。

```
pg_connect("host=myhost port=5432 dbname=mydb user=me password=*** sslmode=require options='--client_encoding=UTF8'") 
```

当代码在 Heroku 上运行时运行良好，但不是在本地运行。（值是 Heroku 给出的值）

我收到此错误：

> 无法连接到 PostgreSQL 服务器：未编译 SSL 支持时 sslmode 值“require”无效

如果我删除 sslmode，我会收到此错误：

> 网络无法访问 服务器是否在主机“myhost”上运行并接受端口 5432 上的 TCP/IP 连接？

有人有线索吗？这会有很大帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:51:10.127

Heroku Postgres 需要 sslmode 进行外部连接。您可能需要使用`--with-openssl[=dir]`compile 标志编译 PHP。有关更多信息，请参见此处：[http ://www.php.net/manual/en/book.openssl.php](http://www.php.net/manual/en/book.openssl.php)

你能验证你安装的 PHP 是否已经编译了 openssl 吗？我知道检查这一点的唯一方法是使用`phpinfo()`页面并查找`--with-openssl`标志。

# python - 检查字符串是否符合某种格式

> ID：14983498
> 
> 赞同：2
> 
> 时间：2013-02-20T15:23:07.317
> 
> 标签：python, string, unit-testing, python-2.7, string-formatting

我正在尝试在我的单元测试中进行一些模式匹配。

我的源代码有以下

```
MY_CODE = "The input %s is invalid"

def my_func():
    check_something()
    return MY_CODE % some_var 
```

在我的测试中，我有这样的东西

```
def test_checking(self):
    m = app.my_func()
    # How do I assert that m is of the format MY_CODE???
    # assertTrue(MY_CODE in m) wont work because the error code has been formatted 
```

我想要断言上述内容的最佳方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:27:28.853

看起来你必须为此使用正则表达式：

```
assertTrue(re.match("The input .* is invalid", m)) 
```

您可以尝试通过翻译`%s`to `.*`、`%d`to`\d`等将格式字符串转换为正则表达式：

```
pattern = MY_CODE.replace('%s', '.*').replace(...) 
```

*（在这种简单的情况下，您可以只使用`startswith`and `endswith`。）*

尽管实际上我认为您根本不应该对此进行测试。

# php - 从excel导入数据时删除特殊字符

> ID：14983505
> 
> 赞同：4
> 
> 时间：2013-02-20T15:23:16.740
> 
> 标签：php, htmlspecialchars

我正在将数据从 excel 导入数据表。它工作正常。但在某些领域，导入的数据带有未知字符“�”。但是excel没有这样的性格。这是我的代码。

我已经尝试了很多方法。这是我的最终代码。

`$new_prod_desc = (ucfirst($data[0])." ".ucfirst($data[5])." ".ucfirst($data[1])." ".ucfirst($data[2])); $new_prod_desc = preg_replace("/&#?[a-z0-9]+;/i","",$new_prod_desc);`

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:29:47.400

这不是一个单字节字符，而是一个 UTF-8 序列`ef bf bd`：

从[这里](http://www.utf8-chartable.de/unicode-utf8-table.pl?start=65280)：

```
U+FFFD  �   ef bf bd    REPLACEMENT CHARACTER 
```

也许它正在取代一个更糟糕的角色？

如果你只是想让它消失，你可以搜索并替换字节序列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:26:30.897

首先验证excel文档是UTF-8编码的。

尝试添加功能

> utf8_decode

像这样：

```
$new_prod_desc = utf8_decode($new_prod_desc); 
```

# hibernate - Hibernate QueryException：'并非所有命名参数都已设置'-本机查询包含 ::int

> ID：14983508
> 
> 赞同：3
> 
> 时间：2013-02-20T15:23:20.093
> 
> 标签：hibernate, jpa-2.0, postgresql-8.4

在我们当前的项目中，我们需要一个长匹配前缀类型的查询，但奇怪的是，该列被定义为*bigint*。我们在下面的代码片段中提出了解决方案，我们希望在*dc*列中找到与参数*?2*和*?3*匹配的最长数字，并且*?1*日期在 2 个日期列之间。

以下是相关的依赖项：

*   Postresql 8.4
*   休眠 3.6.10
*   休眠 JPA 1.0.1
*   春天 3.2.1

这是来源：

```
...
String query_string = "SELECT * FROM numberlist WHERE " +
            "?1 BETWEEN init_date AND COALESCE(end_date,'2999-12-31') " +
            "AND dc IN " +
            "(select ?2/(10^i)::int8 from generate_series(0,floor(log(?3))::int) i) " +
            "ORDER BY dc DESC LIMIT 1";

Query query = emf.createEntityManager().createNativeQuery(query_string, MyNumber.class);
    query.setParameter(1, valid_date);
    query.setParameter(2, num);
    query.setParameter(3, num);

MyNumber result = (MyNumber)query.getSingleResult();
... 
```

我们得到以下异常：

```
Caused by: org.hibernate.QueryException: Not all named parameters have been set: [:int8, :int] 
```

我们认为问题在于 Hibernate 将*:int*和*:int8*作为参数但找不到解决方案。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-23T13:21:16.253

你可以重写`(select ?2/(10^i)::int8`为`CAST((select ?2/(10^i) AS INT8)`.
一般来说，任何类型转换都可以写成`<data>::<type>`and `CAST(<data> AS <type>)`。
这种形式是相同的，将给出相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T11:09:41.660

您是否尝试使用：

```
query.setParameter(":int8", valid_date); 
```

代替：

```
query.setParameter(1, valid_date); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T14:08:14.263

正如我在上面的评论中所写，我最终使用了：

```
public class LegacyDao extends JdbcDaoSupport 
```

通过这种方式，我能够重用 Hibernate 正在使用的 DataSource。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-24T01:28:28.840

`\`尝试在之前放双`:`

```
...
String query_string = "SELECT * FROM numberlist WHERE " +
            "?1 BETWEEN init_date AND COALESCE(end_date,'2999-12-31') " +
            "AND dc IN " +
            "(select ?2/(10^i)\\:\\:int8 from generate_series(0,floor(log(?3))\\:\\:int) i) " +
            "ORDER BY dc DESC LIMIT 1";

Query query = emf.createEntityManager().createNativeQuery(query_string, MyNumber.class);
    query.setParameter(1, valid_date);
    query.setParameter(2, num);
    query.setParameter(3, num);

MyNumber result = (MyNumber)query.getSingleResult();
... 
```

# machine-learning - 识别与 mahout 聚类相关的文档

> ID：14983515
> 
> 赞同：2
> 
> 时间：2013-02-20T15:23:35.023
> 
> 标签：machine-learning, cluster-analysis, mahout

使用 apache mahout 创建文档向量和集群相当容易。执行 clusterdump 允许用户查看与各个集群相关的术语。但是，如何识别属于每个集群的文档？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:28:11.537

我认为，对于每个文档，找到它的向量与每个集群中心的欧几里得距离，并将其分配给最近的集群。

# grid - ForeignKey 列不选择 Kendo-Grid 中的值

> ID：14983517
> 
> 赞同：5
> 
> 时间：2013-02-20T15:23:39.627
> 
> 标签：grid, kendo-ui

我有一个包含一些列的网格，其中一个列是 foreignKey 列。

我想在组合框中显示该列的所有可能值。`ViewData["States"]`是一个`IList<State>`where State 有一个`Id`field 和一个`Name`field 的地方。

为此，我修改了模板“GridForeignKey.cshtml”，如下所示：

```
@model object

@(
 Html.Kendo().ComboBoxFor(m => m)        
    .BindTo((SelectList)ViewData[ViewData.TemplateInfo.GetFullHtmlFieldName("") +  
   "_Data"]).Filter(FilterType.Contains).Placeholder("Select...")
) 
```

我的视图如下所示：

```
<div class="contentwrapper">
    @{
        ViewBag.Title = "Home Page";
        Layout = "~/Views/Shared/_Layout.cshtml";
    }

    @(
    Html.Kendo().Grid<CustomerModel>()    
    .Name("Grid")
    .Columns(columns => {
        columns.Bound(p => p.Name);

        columns.ForeignKey(p => p.StateId, (IEnumerable)ViewData["States"], "Id", "Name");

        columns.Bound(p => p.StreetAddress).Width(140);
        columns.Bound(p => p.Zip).EditorTemplateName("Integer");
        columns.Command(command => { command.Edit(); command.Destroy(); });//edit and delete buttons
    })
    .ToolBar(toolbar => toolbar.Create())//add button
    .Editable(editable => editable.Mode(GridEditMode.InLine))//inline edit
    .Pageable()
    .Sortable()
    .Scrollable()
    .Filterable()
    .DataSource(dataSource => dataSource        
        .Ajax()                 
        .Events(events => events.Error("error_handler"))
        .Model(model => {
            model.Id(c => c.CustomerId);
            model.Field(c => c.CustomerId).Editable(false);
            model.Field(c => c.Zip).DefaultValue(4444);
        }
        )//id of customer
        .Create(update => update.Action("EditingInline_Create", "Customer"))
        .Read(read => read.Action("EditingInline_Read", "Customer"))
        .Update(update => update.Action("EditingInline_Update", "Customer"))
        .Destroy(update => update.Action("EditingInline_Destroy", "Customer"))
    )
)
</div>
<script type="text/javascript">
    function error_handler(e) {
        if (e.errors) {
            var message = "Errors:\n";
            $.e`enter code here`ach(e.errors, function (key, value) {
                if ('errors' in value) {
                    $.each(value.errors, function () {
                        message += this + "\n";
                    });
                }
            });
            alert(message);//show error
        }
    }
    </script> 
```

现在我的问题：

1.  我的表不显示“状态”的选定值。
2.  当我编辑一行时，组合框会显示并包含所有所需的值，但未选择该值。相反，它总是显示占位符文本。
3.  在我将一个复杂对象绑定到我的网格之前，该对象具有一个本身就是复杂类型的字段（`State`其中包含`Id`and`Name`属性），但不知何故，剑道不允许我像`p => p.State.Id`. 这就是我将模型展平的原因，而我现在使用该字段`StateId`。甚至可以使用这样的级联复杂类型吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T04:30:50.420

你所拥有的将不起作用。您需要将 EditorViewData 中的列表传递给 EditorTemplate，并告诉它要使用哪个 EditorTemplateName。

```
columns.ForeignKey(p => p.StateId, (IEnumerable)ViewData["States"], "Id", "Name")
    .EditorViewData(new { statesList = ViewData["States"] })
    .EditorTemplateName("GridForeignKey"); 
```

和 GridForeignKey.cshtml 一样

```
@model int // Assuming Id is an int
@(Html.Kendo().ComboBoxFor(m => m)
    .Placeholder("Select...")
    .DataValueField("Id")
    .DataTextField("Name")
    .BindTo(ViewData["statesList"])
) 
```

这可能不完全正确，因为我只是在脑海中做到了。但它至少应该让你朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-26T16:06:03.827

为了实现您想要的，您需要在网格中定义编辑事件后实现一些客户端脚本

```
 .Events(events => events.Edit("onEdit"))

if your grid called **myGrid** then your script will be in this way

<script>
$(document).ready(function (e) {
    var innerContent = $(".k-grid-delete").html().replace("Delete", "");
    $(".k-grid-delete").html(innerContent);
});

function onEdit(e) {
    $("#**myGrid** tbody [data-role=dropdownlist]").each(function () {
        var ddl = $(this).data("kendoDropDownList");
        if (ddl) {
            ddl.options.optionLabel = "Select";
            ddl.refresh();
            ddl.value("");
        }
    })
} 
```

# java - 通过 Post 将 JSON 从 Java 发送到 PHP

> ID：14983521
> 
> 赞同：4
> 
> 时间：2013-02-20T15:23:59.517
> 
> 标签：java, php, android

我正在做一个应该将数据从平板电脑发送到 PHP Web 服务的 Android 程序。发送 JSON 的代码：

```
package com.example.shvalidation;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicHeader;
import org.apache.http.protocol.HTTP;
import org.json.JSONObject;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.View;

public class MainMenuScreen extends Activity {
    //JSON Variables
    JSONParser jsonParser = new JSONParser();
    String pid;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_menu_layout);
        new TestThread().execute();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main_menu_layout, menu);
        return true;
    }

    public void PlantToDome(View view) {
        Intent intent = new Intent(this, SelectLocationScreen.class);
        startActivity(intent);
    }

    //Código del Web Service
    public class TestThread extends AsyncTask<Void, Void, Void> {
        ProgressDialog dialog;
        protected void onPreExecute() {
            dialog = ProgressDialog.show(MainMenuScreen.this, "Loading", "Loading data, please wait..");
        }

        private String convertStreamToString(InputStream is) {

            BufferedReader reader = new BufferedReader(new InputStreamReader(is));
            StringBuilder sb = new StringBuilder();

            String line = null;
            try {
                while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                }
            } catch (IOException e) {
                e.printStackTrace();
            } finally {
                try {
                    is.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
            return sb.toString();
        }

        protected Void doInBackground(Void...args0) {
            try {
                HttpClient client = new DefaultHttpClient();
                HttpResponse response;
                HttpPost post = new HttpPost("http://192.168.1.101:8080/GetBook.php");

                JSONObject holder = new JSONObject();
                JSONObject euid = new JSONObject();
                euid.put("euid", 1);
                holder.accumulate("euids", euid);
                euid.put("euid", 2);
                holder.accumulate("euids", euid);

                post.setHeader("json", holder.toString());
                StringEntity se = new StringEntity(holder.toString());
                se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
                post.setEntity(se);
                response = client.execute(post);
                if (response != null) {
                    InputStream in = response.getEntity().getContent();

                    String a = convertStreamToString(in);
                    Log.i("Read from Server", a);
                }
            } catch (Exception e) {
                Log.d("error", e.toString());
            }
            return null;
        }

        protected void onPostExecute(Void unused) {
            dialog.dismiss();
        }
    }
} 
```

PHP 网络服务：

```
<?php
    ob_start();

    var_dump(json_decode(file_get_contents('php://input')));

    $out = ob_get_contents();

    ob_end_clean();

    $f = fopen('out.txt', 'w+');

    fwrite($f, html_entity_decode($out));

    fclose($f);
?> 
```

我尝试了不同的方法来获取 JSON，但没有一个对我有用。也许 StackOverflow 的优秀人员可以帮助我解决这个问题，因为他们总是会解决我遇到的所有其他问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:23:06.187

在评论部分，您似乎只希望将 JSON 发送到您的 PHP 脚本。通常，您将其发布到 PHP 并提取它：

```
<?php
    print_r($_POST);
    $json_string = $_POST['message']; 
    $json = json_decode($json_string);
    print_r($json);
?> 
```

然后是一个小客户端示例：

```
public static void main(String[] args) {

    String json = "{\"message\":\"This is a message\"}";

    HttpClient httpClient = new DefaultHttpClient();

    try {
        HttpPost request = new HttpPost("http://somesite.com/test.php");
        StringEntity params =new StringEntity("message=" + json);
        request.addHeader("content-type", "application/x-www-form-urlencoded");
        request.setEntity(params);
        HttpResponse response = httpClient.execute(request);

        // handle response here...

        System.out.println(org.apache.http.util.EntityUtils.toString(response.getEntity()));
        org.apache.http.util.EntityUtils.consume(response.getEntity());
    } catch (Exception ex) {
        // handle exception here
    } finally {
        httpClient.getConnectionManager().shutdown();
    }
} 
```

这个的输出是：

```
Array
(
    [message] => {"message":"This is a message"}
)
stdClass Object
(
    [message] => This is a message
) 
```

# php - 如何在 magento 中以编程方式进行自动发货？

> ID：14983522
> 
> 赞同：0
> 
> 时间：2013-02-20T15:23:59.923
> 
> 标签：php, magento

我尝试使用以下观察者代码。

```
...
    public function automaticallyInvoiceShipCompleteOrder($observer)
    {
        $order = $observer->getEvent()->getOrder();

        $orders = Mage::getModel('sales/order_invoice')->getCollection()
                        ->addAttributeToFilter('order_id', array('eq'=>$order->getId()));
        $orders->getSelect()->limit(1);
        if ((int)$orders->count() !== 0) {
            return $this;
        }
        try {
               if($order->canShip())
                {
                $itemQty =  $order->getItemsCollection()->count();
                $items[] = $itemQty;
                // This first definition and 2nd look overlapping, our one is obsolete?
                $shipment = Mage::getModel('sales/service_order', $order)->prepareShipment($itemQty);
                $ship = new Mage_Sales_Model_Order_Shipment_Api();
                $shipmentId = $ship->create($order->getId(), $items, 'Shipment created through ShipMailInvoice', true, true); 
//getting Error here

                }
              }
} catch (Exception $e) {
                $order->addStatusHistoryComment(' Exception occurred during automaticallyInvoiceShipCompleteOrder action. Exception message: '.$e->getMessage(), false);
                $order->save();
            }
return $this;
    }
..... 
```

当我下订单时，我可以使用观察者捕获订单成功事件。最终`Fatal error: Maximum function nesting level of '100' reached, aborting!`在 ajax 调用本身中得到“”。

我找不到解决方案。请对此提出一些建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:36:59.087

每次保存您的订单时，都会调用此观察者方法，由于 try 块中的一些错误，该方法会再次保存您的订单。这就是我认为它会无休止地执行并且在第 100 次之后会抛出致命错误的原因。

在你的 try 块中`$ship->create()`，你需要通过`Order Increment ID`而不是`Order Entity ID`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T06:19:04.303

我尝试使用以下代码，

```
 public function automaticallyInvoiceShipCompleteOrder($observer)
{
    //$order = $observer->getEvent()->getOrder();
    $incrementid = $observer->getEvent()->getOrder()->getIncrementId();      
    $order = Mage::getModel('sales/order')->loadByIncrementId($incrementid);
        try {
            // Is the order shipable?
            if($order->canShip())
            {
             $shipmentid = Mage::getModel('sales/order_shipment_api')->create($order->getIncrementId(), array());
            }
            //END Handle Shipment
        } catch (Exception $e) {
            $order->addStatusHistoryComment(' Exception occurred during automaticallyInvoiceShipCompleteOrder action. Exception message: '.$e->getMessage(), false);
        }
        return $this;
} 
```

货件已创建...

# java - Eclipse 未正确显示 UI

> ID：14983535
> 
> 赞同：0
> 
> 时间：2013-02-20T15:24:30.407
> 
> 标签：java, eclipse, java-3d

我已将我的 Eclipse 项目从我的电脑转移到笔记本电脑上。这是一个 java 3d 项目，它应该在顶部的按钮栏上显示带有一些按钮的主框架，在屏幕的其余部分显示 a`SimpleUniverse`
发生的是显示所有按钮的内容，但不是实际的java 3d 的东西，通常的黑色`SimpleUniverse`和所有应该可用的交互都不是。相反，框架内只有灰色的东西。
现在奇怪的事情来了。当我从以任何方式修改`BranchGroup`附加到的按钮执行命令时`SimpleUniverse`，一切都恢复正常，所有功能都正常工作。我认为这可能是由于我分离了`BranchGroup`，进行所需的更改，然后附加回来。但是，问题仍然存在。为什么一开始就不能正常工作？

PS 所有的库都包括在内，笔记本电脑比 PC 工作得更好，有更好的显卡，更多的 1Gb RAM 和更好的处理器，所以我不认为这是硬件问题

# java - 如何将 SQL Server 查询中的数据显示到 android 表中

> ID：14983540
> 
> 赞同：2
> 
> 时间：2013-02-20T15:24:51.213
> 
> 标签：java, android, sql, sql-server

我与外部服务器 SQL Server 建立连接，但只能使用以下代码显示数据：

```
void cursorset (){
    java.sql.DatabaseMetaData dm = null;

    try {
        connection = this.getConnection();

        if (connection != null) {
            Resultset = result;
            private final String statement = "select*from *******";
            dm = connection.getMetaData();            
            Statement select = connection.createStatement();
            result = select.executeQuery(statement);

            while (result.next()) {
                mostrar_datos.append("" +result.getObject(1)+result.getObject(2)+" "+result.getObject(3));
            }

            result.close();
            result = null;
            closeConnection();
        } else {
            mostrar_datos.append("Error: No active Connection");
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    dm = null;
} 
```

问题是我需要在具有动态行和列的表或 alertdialog 上显示此返回的数据，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:43:19.563

> 如何将 SQL Server 查询中的数据显示到 android 表中

因此，您应该创建一些解释真实数据库中的表的类，并且上述方法应该返回值列表。

随后，返回的数据可以简单地显示在`AlertDialog`或一些`ListView`。

## 例子：

您的数据库有一个表：用户有 3 列 - id（主键）、名称、姓氏。所以你创建具有“相同结构”的类

```
public class User {

   private int id;
   private String name;
   private String surname;

   // getters and setters
} 
```

然后您的方法可以如下所示：

```
public List<User> getAll() {
   List<User> users = new ArrayList<User>();
   User u = null;
   // initialise connection etc.
   while (resultSet.next()) {
      u = new User();
      u.setId(resultSet.getInt(1));
      u.setName(resultSet.getString(2));
      u.setSurname(resultSet.getString(3));
      users.add(u);  
   }
   return users;
   // in finally block close connection.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:02:30.107

You could easily display the data in a `ListView` with a corresponding `CursorAdapter`, your query would return a `Cursor` object. The `CursorAdapter`s responsibility is to map data from the `Cursor` to ids in the layout of a row in the `ListView`.

Here are a few tutorials to get you started:

[http://docs.xamarin.com/guides/android/user_interface/working_with_listviews_and_adapters/part_4_-_using_cursoradapters](http://docs.xamarin.com/guides/android/user_interface/working_with_listviews_and_adapters/part_4_-_using_cursoradapters)

[http://developer.android.com/reference/android/app/ListActivity.html](http://developer.android.com/reference/android/app/ListActivity.html)

# math - 蒙哥马利乘法VHDL实现

> ID：14983541
> 
> 赞同：1
> 
> 时间：2013-02-20T15:24:52.697
> 
> 标签：math, cryptography, vhdl, integer-arithmetic, modular-arithmetic

在这种情况下，我试图创建一个模块化算术运算：

```
x*y mod n 
```

据我所知，最快的方法是使用蒙哥马利乘法，但我无法理解其他方法实际上是如何使用 VHDL 在硬件中实现它的。

有人能够做到这一点或有任何图书馆可以让我使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:54:16.400

作为[这个](http://opencores.org/project,basicrsa)开放核心项目的一部分，可以在[此处找到基本的移位和加法模乘法。](http://opencores.org/websvn,filedetails?repname=BasicRSA&path=/BasicRSA/trunk/rtl/vhdl/modmult.vhd)

[这是](http://opencores.org/project,rsa_512)另一个使用蒙哥马利乘法的项目。

# google-analytics - 谷歌标签管理器规则识别流量来源

> ID：14983545
> 
> 赞同：0
> 
> 时间：2013-02-20T15:24:57.783
> 
> 标签：google-analytics, google-tag-manager

有没有办法创建一个标识流量来源类型的谷歌标签管理器规则（通过宏）？（像有机的？）。想要创建一个仅在流量来源是自然的情况下才会触发的标签。可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:24:02.213

最简单的方法是从 Google Analytics (__utmz) Cookie 中提取源 (utmcsr) 并根据该值触发标签管理器事件。然后根据该事件创建规则。

我认为仅通过标签管理器界面是不可能的。

（更新以添加）我过去使用过以下代码，并且猜测它仍然可以工作（恐怕我不能给予适当的信任，我从某个网站捏了它）。

```
/**
 Reads the Google utmz Cookie and returns he values as an array
 utmcsr = utm_source
 utmccn = utm_campaign
 utmcmd = utm_medium
 utmctr = utm_term
 utmcct = utm_content  */
function parseGACookie()  {
    var values = {};
    var cookie = readCookie("__utmz");
    if (cookie) {
        var z = cookie.split('.');
        if (z.length >= 4) {
            var y = z[4].split('|');
            for (i=0; i<y.length; i++) {
                var pair = y[i].split("=");
                values[pair[0]] = pair[1];
            }
        }
    }
    return values;
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

ga = parseGACookie();
if(ga['utmcsr'] == "cpc") {
    alert("Paid advertising");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-19T07:22:22.003

如果您的流量来自标记的 URL（例如来自您使用默认 GTM url 标签手动标记的广告系列），您可以通过 GTM 界面简单地执行此操作。

*   使用读取 URL 标签的查询组件类型创建一个 URL 类型宏，如下所示：[https ://www.evernote.com/shard/s56/sh/c1d43612-66ed-4972-aca3-4aa59c040322/347f19fb9561d11143e33a25d6fe080c](https://www.evernote.com/shard/s56/sh/c1d43612-66ed-4972-aca3-4aa59c040322/347f19fb9561d11143e33a25d6fe080c)
*   创建一个在此宏等于您的代码时触发的规则（例如 medium=cpc 或 utm_campaign=yourcampaign）
*   根据此规则创建发送 GA 事件的代码

我希望这有帮助。

# winapi - 如何使用 shell 文件夹 defview 在命名空间扩展中实现排序

> ID：14983550
> 
> 赞同：1
> 
> 时间：2013-02-20T15:25:14.070
> 
> 标签：winapi, sorting, explorer, windows-shell, shell-extensions

我有一个使用 ATL/MFC 的工作命名空间扩展。为了使它看起来像资源管理器，我使用 SHCreateShellFolderView 使用默认的 shell 文件夹视图 (defview)。到目前为止，一切都运行良好。我唯一的大问号是单击列时如何在defview中实现排序？当我单击 IShellFolder 的 CompareIDs 列时，我必须将焦点设置到视图中并按 F5 以查看一些更改。我尝试在互联网上搜索，但关于这个主题的信息非常罕见......

亲切的问候，迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:05:47.130

也许对[SFVM_COLUMNCLICK](http://msdn.microsoft.com/en-us/library/windows/desktop/bb774209%28v=vs.85%29.aspx)消息的响应可以帮助您。

例子：

```
HRESULT ExampleFolderView_OnColumnClick(HWND hwnd, UINT uiColumn)
{
    SHShellFolderView_Message(hwnd, SFVM_REARRANGE, uiColumn)
    return S_OK;
} 
```

# java - JOGL - 翻译 GL_QUADS

> ID：14983551
> 
> 赞同：1
> 
> 时间：2013-02-20T15:25:16.150
> 
> 标签：java, opengl, jogl

在 JOGL 中，我尝试使用 GL_QUADS（即整个对象的不同组件）创建一些 3D 形状，到目前为止这样做很好，但我不知道如何翻译形状，必须有办法做到这一点但是我对 GL_QUADS 不是很熟悉，所以我不完全确定如何去做。编辑`gl.glVertex3f`只会导致形状大小不同，这似乎是我唯一可以编辑的东西，是否可以给 GL_QUAD 一个变量名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:45:27.620

您可以使用以下`glTranslatef`功能：

```
// render the shape
gl.glTranslatef(5.0f, 0.0f, 0.0f); // translate along x, y, z
// render the shape - you will now have two shapes next to each other
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:57:17.553

调用`gl.glTranslatef(1.0f, 0.0f, 0.0f);`将应用于堆栈中的当前矩阵，这实际上意味着从那时起绘制的任何内容都将在 x 轴上出现 1 个单位，距离之前的矩阵所在的位置（可能是您的情况的原点）。

我可以理解为什么它看起来令人困惑，而不是创建形状*然后*移动它（不能完成，它已经被绘制），你需要翻译*然后*绘制你的形状。

例如：

```
gl.glPushMatrix();
    gl.glTranslatef(1.0f, 0.0f, 0.0f);
    gl.glBegin(GL2.GL_QUADS);
        // draw some vertices here
    gl.glEnd();
gl.glPopMatrix(); 
```

# jquery - HTML页面引用外部jquery文件不起作用

> ID：14983555
> 
> 赞同：0
> 
> 时间：2013-02-20T15:25:24.080
> 
> 标签：jquery

我在 Eclipse 中创建了一个 html 页面，但是**当我引用外部 jquery 文件时它不起作用**。下面是我的代码：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/layout.css">
<link rel="stylesheet" type="text/css" href="../css/flexigrid.css">
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="../script/flexigrid.js"></script>
<title>Insert title here</title>
<script charset="UTF-8">
$(document).ready(function(){
//  document.getElementById("data").style.display="block";
    $("data").css("display", "block");
}); 
</script>
</head>
<body">
<table id="data" style="width:200px; border:solid red 1px; display:none; ">
    <tr>
        <td>jnoifsf</td>
        <td>nifs</td>
        <td>nofsfsa</td>
    </tr>
    <tr>
        <td>mflsf</td>
        <td>noijfs</td>
        <td>mifsf</td>
    </tr>
</table> 
</body>
</html> 
```

**第 12 行带注释的代码可以工作。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:29:37.250

它应该是：

```
$('#data').css("display", "block"); 
```

或者更简单：

```
$('#data').show(); 
```

# ios - 为什么位置服务不能作为后台任务工作？

> ID：14983557
> 
> 赞同：0
> 
> 时间：2013-02-20T15:25:25.437
> 
> 标签：ios, objective-c, mkmapview, cllocationmanager, appdelegate

在我的应用程序中有一个要观看的位置（区域）。当设备从该位置移开（距离可能小至 5 到 10 米）时，会弹出一个 AlertView 并播放声音。当应用程序在后台时，会生成本地通知。点击或滑动通知会将应用程序带到最前面。这工作正常。但是，在后台运行时，位置更新会在 15-16 分钟左右后停止。箭头从状态栏中移除。将应用程序置于最前面会弹出 AlertView 并播放声音。据我所知，定位服务对当前位置进行了新的修复，并且显示了 AlertView，因为初始距离大于要观察的区域。由于要观看的区域很小，我想我不能使用“重大变化”或“

我在“必需的后台模式”中将 info.plist 中的标签设置为“应用程序注册位置更新”。

有没有人对正在发生的事情有所了解？我是否必须在 - (void)applicationDidEnterBackground:(UIApplication *)application {} 中放入一些代码，如果是这样......那应该是什么？

提前致谢，

问候，

阿德里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T13:20:07.600

在 startUpdatingLocation 之前，您可以设置 CLLocationManager 的 desiredAccuracy 和 distanceFilter 字段以获得所需的精度

# php - NOTORM 自定义 mysql 函数

> ID：14983560
> 
> 赞同：1
> 
> 时间：2013-02-20T15:25:37.487
> 
> 标签：php, slim, notorm

如何选择从现有字段计算的自定义值？

例如，我正在存储出生日期，并且我想选择从 mySql 函数计算的年龄。

```
$app->get("/users/:id", function ($id) use ($app, $db) {
$user = $db->users()->where("users_id", $id);
if ($data = $user->fetch()) {
    $hobbies = array();
    foreach ($data->users_hobbies() as $hobbie) { // get all tags of $application
        $hobbies[] = $hobbie["users_hobbies_name"]; // print the tag name
    }
    echo json_encode(array(
        "id" => $data["users_id"],
        "login" => $data["users_login"],
        "mail" => $data["users_mail"],
        "date_of_birth" => $data["users_date_of_birth"],
        "age" => ??
        "hobbies" => $hobbies
        ));
} else {
    echo json_encode(array(
        "status" => false,
        "message" => "User ID $id does not exist"
        ));
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T09:31:15.503

最简单的方法是使用您需要的所有数据（包括计算列）[定义一个 MySQL 视图：](http://dev.mysql.com/doc/refman/5.0/en/view-syntax.html)`age`

```
CREATE VIEW user_data AS 
SELECT users_id, 
       users_login, 
       users_mail, 
       users_date_of_birth,
       DATE_FORMAT(NOW(), '%Y') - DATE_FORMAT(users_date_of_birth, '%Y') - (DATE_FORMAT(NOW(), '00-%m-%d') < DATE_FORMAT(users_date_of_birth, '00-%m-%d')) AS age
 FROM  users; 
```

然后您可以简单地查询该视图。

```
$app->get("/users/:id", function ($id) use ($app, $db) {
$user = $db->user_data()->where("users_id", $id);
if ($data = $user->fetch()) {
    $hobbies = array();
    foreach ($data->users_hobbies() as $hobbie) { // get all tags of $application
        $hobbies[] = $hobbie["users_hobbies_name"]; // print the tag name
    }
    echo json_encode(array(
        "id" => $data["users_id"],
        "login" => $data["users_login"],
        "mail" => $data["users_mail"],
        "date_of_birth" => $data["users_date_of_birth"],
        "age" => $data["age"]
        "hobbies" => $hobbies
        ));
} else {
    echo json_encode(array(
        "status" => false,
        "message" => "User ID $id does not exist"
        ));
}
}); 
```

# java - 如何使用 JNA 从 Java 将 int 作为 C++ 函数参数传递

> ID：14983561
> 
> 赞同：2
> 
> 时间：2013-02-20T15:25:37.847
> 
> 标签：java, c++, jna

我目前正在开发一个项目，该项目需要开发一个 Java 应用程序可以访问的本机 DLL（在 C++ 中）。我已选择 JNA 进行桥接工作，但在将正确的 int 值从 Java 传递到 C++ 函数时遇到了问题。

简单地说，我有一个在 C++ 中接受 int 值作为参数的函数：（代码被剥离，方法被重命名以保持机密性）

```
JAVALINK_EXPORT SomeStructure WINAPI GetSomeStructureFromIndex(int index) {
    std::string debugMsg("Received index of ");
    debugMsg.append(toString(index));
    OutputDebugString(debugMsg.c_str());
    SomeStructure result = defaultStructure;
    if (index >= 0 && index < structListSize)
        result = structList[index];

    return result;
} 
```

`toString`是一种简单的方法，可以将任何数据类型的值转换为`std::string`使用`std::stringstream`. 实现如下：

```
template <class T>
inline std::string toString (const T& t) {
    std::stringstream ss;
    ss << t;
    return ss.str();
} 
```

`SomeStructure`从我在代码中使用的实际结构重命名。`structList`是一个数组`SomeStructure`。`structListSize`并且`structList`都是共享内存中的全局变量。

这是 DLL 的 Java 接口中的方法签名：

```
SomeStructure.ByValue GetSomeStructureFromIndex(int index); 
```

这就是我在 Java 中将方法用于测试用例的方式：

```
SomeStructure.ByValue received = library.GetSomeStructureFromIndex(1); 
```

`library``StdCallLibrary`是使用生成的 DLL 文件（的子类）的接口实例`Native.loadLibrary`。当上面的代码在 Java 中执行时，我在我的 Windows 调试输出中得到类似以下的输出：

```
Received index of 86701080 
```

（如果我在从数组中获取结构之前省略了`index`对该行的检查，则程序将继续遇到访问冲突错误）`if (index >= 0 && index < structListSize)`

`86701080`可以是任意值。我意识到它会根据导出函数的签名而变化。我在这里错过了什么吗？`1`函数正确地接收到函数签名的期望值`void PrintIndex(int index)`

编辑（0）：我修改了示例代码以更接近地匹配实际代码。

编辑（1）：根据@technomage 的指针，我已经开始将`ByValue`所有方法签名和变量用于收集返回的结构。

编辑（2）：与C++`SomeStructure`中的结构相比，Java 类有一个额外的变量和一个 Java 方法。`SomeStructure`我目前正在测试这是否是导致差异的原因。

**问题解决了**

@technomage 解释说，要让 C++ 函数按预期解释其参数和返回值，用作返回类型（以及用作函数参数的结构）的大小不应与其 Java 对应物不同。这可以在 的情况下`SomeStructure`在 C++ 中`sizeof(SomeStructure)`和在 Java 中使用`SomeStructure.size()`.

基本上，发生的事情是`SomeStructure`结构的大小与其 Java 表示不同。`SomeStructure`包含一个固定长度的数组，如下面的代码所示：

```
#define MAX_LIST_SIZE 256
typedef struct {
    int list[MAX_LIST_SIZE];
    int length;
} SomeStructure; 
```

但是，Java 表示没有指定固定长度数组的大小。`list`被初始化为包含 的单个值`0`。

```
package model;

import com.sun.jna.Structure;

public class SomeStructure extends Structure {
    public static class ByValue extends SomeStructure implements Structure.ByValue { }
    public int[] list = {0};
    public int length = 0;
} 
```

我通过用以下替换错误的初始化语句解决了这个问题：

```
private static final int MAX_LIST_SIZE = 256;
public int[] list = new int[MAX_LIST_SIZE]; 
```

**注意**：整数常量`MAX_LIST_SIZE`被声明`private`为只保留 Java。

进行所有这些修改后，我的代码运行良好，不再遇到访问冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:01:58.357

'WINAPI' 暗示 stdcall 调用约定，但您必须查看宏的本地定义才能确定。如果是这样，您需要`StdCallLibrary`代替`Library`. 这可能会影响您传入的`index`论点。

您还复制了您的结构（按值语义），而不是指向它的指针。当您按值传递结构或按值返回结构时，您需要[告诉 JNA 您正在这样做](http://twall.github.com/jna/3.5.1/javadoc/overview-summary.html#structures)。

**编辑**

确保`SomeStructure.size()`与本机匹配`sizeof(SomeStructure)`。通常按值返回的结构是这样实现的，即调用者在堆栈上分配内存并将隐式指针传递给被调用者，然后被调用者写入该内存。如果调用者和被调用者对该内存的大小存在分歧，它可能会影响堆栈上的其他内容（例如参数和返回值）。您还可以向函数添加更多参数并打印它们的值（作为十六进制）以获得堆栈上的近似值。如果您传入可识别的参数（例如 0x12345678），通常会清楚是什么在错误的方向推动或拉动堆栈。

# jquery - 提交后jQuery删除输入上的文本

> ID：14983564
> 
> 赞同：0
> 
> 时间：2013-02-20T15:25:45.870
> 
> 标签：jquery, jquery-validate

我在我的聊天中放了一个 jQuery 脚本，这样消息就可以在不刷新页面的情况下发送。

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.4.2.min.js"></script> 
```

```
<script type="text/javascript">

    $(document).ready(function(){
            $("#msgsending").validate({
               type: "POST",
                    debug: false,

                    submitHandler: function(form) {
                            // do other stuff for a valid form
                            $.post('index.php', $("#msgsending").serialize(), function(data) {

                            });
                    }
            });
    });
    </script> 
```

并形成

```
 <form id="msgsending" name="form" method="post" action="" > 
<input name="message" id="message" type="text" maxlength="350" />

<input name="message" id="message" type="text" maxlength="350" />

<input name="submit" type="submit" value="Send!" />

</form> 
```

该代码完美运行。（索引是在数据库中插入消息+用户名的脚本）

但现在我有一个问题。

提交后消息输入中的文字不会被删除。我用谷歌搜索了很多页面，所有代码都不起作用。（Somes 工作，但消息未发送）

你有什么建议我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:27:31.980

`$('#message').val('');`应该清除`input`' 的值，我猜你会在发送消息后执行此操作，例如：

```
$(document).ready(function(){
    $("#msgsending").validate({
       type: "POST",
          debug: false,
          submitHandler: function(form) {
               // do other stuff for a valid form
               $.post('index.php', $("#msgsending").serialize(), function(data) {
                    $('#message').val('');
               });
          }
    });
}); 
```

这仅适用于具有 的第一个元素`ID` `#message`，因为`ID`' 是唯一的，您不能有两个具有相同 的元素`ID`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:28:22.680

代替

```
$.post('index.php', $("#msgsending").serialize(), function(data) {

}); 
```

您可以执行以下操作：

```
var data = $("#msgsending").serialize();
$('#message').val('');

$.post('index.php', data, function(data) {

}); 
```

*在发送请求之前*清空消息字段或如@adeneo 建议的那样，您可以在 AJAX 的成功回调中清空该字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T16:26:10.663

您可以在回调函数中放置任何代码`.post()`以清除或重置表单。

您还`type: "POST"`列出了`.validate()`. 您应该删除它，因为它[不是此插件的有效选项/参数](http://docs.jquery.com/Plugins/Validation/validate#toptions)。

由于您正在使用 ajax，因此您需要`return false`在末尾`submitHandler`添加 a 以防止页面重定向。

可选地，您还可以替换`$('#msgsending').serialize()`为`$(form).serialize()`或`form.serialize()`因为`form`被传递到`submitHandler`回调函数中。

```
$(document).ready(function(){
    $("#msgsending").validate({
        type: "POST", // <-- REMOVE THIS... not a valid plugin option
        debug: false,
        submitHandler: function(form) {
            // do other stuff for a valid form
            $.post('index.php', $(form).serialize(), function(data) {
                $('#message').val(''); // clears out #message
                // any other code to clear out or reset the form
            });
            return false; // prevent page redirection
        }
    });
}); 
```

# c - 如何将选择与标准输出一起使用？

> ID：14983565
> 
> 赞同：1
> 
> 时间：2013-02-20T15:25:48.983
> 
> 标签：c, select, stdout

我有以下代码

```
 fd_set          set;
    struct          timeval timeout;
    printf("first printf\n"); // displayed
    FD_ZERO(&set);
    timeout.tv_sec = 1;

    FD_SET(fileno(stdout), &set);
    if (select(FD_SETSIZE, NULL, &set, NULL, &timeout)!=1)
    {
        stdout_closed = true;
        return;
    }
    printf("second printf\n"); // Not displayed 
```

我正在尝试检查之前写入标准输出的能力`printf("second printf\n");`。但是使用此代码，选择返回一个值`!= 1`，然后 printf 仍然无法访问。看起来选择返回“*不可能*”写入标准输出。

你能解释一下这种行为吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:36:42.053

对 select() 的调用返回 -1，而 errno 为 22（无效参数），因为您在超时中有垃圾值。试试这个：

```
FD_ZERO(&set);
timeout.tv_sec = 1;
timeout.tv_usec = 0; /* ADD THIS LINE to initialize tv_usec to 0 so it's valid */ 
```

它应该可以工作。

# c# - 相对路径改变？

> ID：14983567
> 
> 赞同：1
> 
> 时间：2013-02-20T15:25:56.600
> 
> 标签：c#, .net, path, directory, filestream

我有一个日志对象，它使用相对路径写入每日日志文件。这相当简单（.NET 4.0，VS 2010）。

```
public void LogLine(string txt)
{
    DateTime dt = DateTime.Now;
    if (CurrentDay != dt.Day)
    {
        string newFileName = "..\\Log\\" + programName + dt.Day + ".log";
        fs = new FileStream(newFileName, FileMode.Create, FileAccess.Write);
        sw = new StreamWriter(fs);
        CurrentDay = dt.Day;
    }
    sw.WriteLine(txt);
} 
```

这几乎一直有效。但是，有时我会得到一个看似随机的*DirectoryNotFoundException*，但路径完全不同。例如，当我第一次运行程序时，它会创建一个文件：

*C:\MyFiles\Log\MyApp19.log*

在使用了一些程序并让它在一夜之间运行以便创建一个新文件和流之后（在午夜之后的第一个日志中），我回到*DirectoryNotFoundException*，说明如下：

*C:\MyFiles\MyOtherFiles\Resources\Log\MyApp20.log*

我唯一能想到的是：在软件的整个生命周期中，我多次使用 OpenFileDialog 和 SaveFileDialog，其中一个打开/保存对话框访问其中的文件

*C:\MyFiles\MyOtherFiles\Resources\SavedFiles\*

所以在我看来，当我使用对话框时，我打开/保存一些东西到*SavedFiles*目录中，当它创建新日志时，相对文件路径*..\*上升到*Resources*（来自*SavedFiles*），然后找不到*Resources*中的目录*Log*并引发异常。但是，我无法使用对话框重现问题，并且我认为相对路径是相对于可执行文件的？打开/保存文件对话框能否改变软件计算相对文件路径的方式？有人有什么想法吗？谢谢你的时间！

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:36:52.733

我认为以下链接可以帮助您：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.filedialog.aspx)

注意以下部分：

> 重要提示：如果您的应用程序的用户更改了 FileDialog 中的文件夹，那么您的应用程序的当前工作目录将设置为 FileDialog 中指定的位置。为防止出现这种情况，请将 RestoreDirectory 属性设置为 true。

尝试使用 Microsoft 提出的路径方法，如上述链接中所述。

这也可以帮助您 [http://msdn.microsoft.com/en-us/library/system.windows.forms.application.executablepath.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.executablepath.aspx)

问候

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:29:42.983

相对路径始终适用于应用程序的当前目录。这很容易改变，例如当您显示保存对话框时。
创建相对于可执行文件的路径总是更好。

```
var assembly = Assembly.GetEntryAssembly() ?? Assembly.GetCallingAssembly();
var path = Path.GetDirectoryName(assembly.Location);
newFileName = Path.Combine(path,  "..\\Log\\" + programName + dt.Day + ".log"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:32:58.120

我猜测应用程序会在某个时候更改当前工作目录。因此，在此基础上，我会为日志文件使用完全限定的路径。您可以使用程序集的启动路径，例如 Application.StartupPath，即使应用程序出于某种原因更改了文件夹，它也不应该更改。*

# php - 在一个函数中创建一个变量并在 PHP 中将其传递给另一个函数

> ID：14983569
> 
> 赞同：1
> 
> 时间：2013-02-20T15:25:58.557
> 
> 标签：php, function, variables

首先让我说我花了一天时间阅读了关于这个主题的三个谷歌页面的文章，并在[这里](https://stackoverflow.com/questions/3898170/can-i-share-variables-between-different-functions-in-php "我可以在 PHP 中的不同函数之间共享变量吗？")研究了这个页面。

好的，这是我的困境。我有两个功能。两者都通过 AJAX 调用。第一个为变量赋值，第二个使用该变量。这两个功能都由两个单独的按钮触发，需要保持这种状态。AJAX 和函数的触发工作正常，但变量没有传递。这是我的代码：

```
if( $_REQUEST["subjectLine"] ) //initiate first function
{
    $CID = wpCreateChimpCampaign();
    echo $CID; //this works
}

if( $_REQUEST["testEmails"] ) //initiate second function
{
    echo $CID; //does not return anything but should contain "apple"
    wpSendChimpTest($CID);
} 

function wpCreateChimpCampaign () //first function
{
    $CID = "apple";
    return $CID;    
}

function wpSendChimpTest ($CID) //second function
{
    echo $CID; //does not return anything but should contain "apple"
} 
```

我愿意使用课程，但我在那里也没有太多运气。我希望在不使用类的情况下解决这个问题。我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:35:11.170

如果您对该文件进行 2 次单独调用，将其可视化为 2 个完全独立文件中的 2 个函数可能会有所帮助。虽然它们存在于同一个 PHP 文件中，但因为它们在不同的调用中使用了 call，所以它们不保留变量 $CID 的值。文件运行后，该变量将被销毁，当您再次调用该文件时，该值再次为 null。

因此，您需要在调用之间存储该变量。您可以将其存储在数据库中，也可以将其存储在会话变量中。

所以调用 session_start(); 在文件的开头，而不是使用 $CID，只需使用 $_SESSION['CID'];

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:28:56.063

我不知道搁置在哪里。您拥有的代码将起作用：

```
$CID = wpCreateChimpCampaign(); // returns 'apple'
wpSendChimpTest($CID);          // echos 'apple' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:33:12.817

代码看起来不错，但是您确定所有要求都得到满足，因此两个函数都可以执行吗？

换句话说，您是否同时为`$_REQUEST["subjectLine"]`和提供值`$_REQUEST["testEmails"]`？

# quickbooks - QuickBooks 在线应用程序 - 支持的国家/地区

> ID：14983571
> 
> 赞同：5
> 
> 时间：2013-02-20T15:25:59.923
> 
> 标签：quickbooks, intuit-partner-platform, quickbooks-online

我在 Intuit 合作伙伴平台文档中看不到任何地方解释了我的应用程序将在哪些国家/地区可用或在国际国家/地区使用的版本的限制。

QuickBooks Online 的销售代表告诉我，“并非所有在美国版应用程序中心运行的程序都可以在国际国家运行。”

我特别想知道来自加拿大、牙买加、英国、印度和澳大利亚的用户是否可以使用我的应用，如果它发布在美国的 Intuit 应用中心。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T16:15:57.290

At this time, IPP only supports apps that integrate with QuickBooks Online (QBO) for the US market. However, we do plan to enable developers who want to integrate with QBO for customers outside of the US where QBO becomes available.

This is a high priority for Intuit and IPP and we'll share our detailed roadmap with the developer community ASAP. In the meantime, you can register for today's webinar here [http://ippblog.intuit.com/blog/2013/02/registration-for-ipp-quickbooks-api-v3-webinar-.html](http://ippblog.intuit.com/blog/2013/02/registration-for-ipp-quickbooks-api-v3-webinar-.html) that provides the roadmap for the IPP QuickBooks API including some details on global readiness.

regards,
Jarred

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T18:15:05.380

Intuit 合作伙伴平台和 Intuit Anywhere 仅适用于美国版本的 QuickBooks。期，故事结束。

Intuit 表示他们正在致力于国际化，但尚未给出任何时间表。

苏...

> 我特别想知道来自加拿大、牙买加、英国、印度和澳大利亚的用户是否可以使用我的应用，如果它发布在美国的 Intuit 应用中心。

不，他们不能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-29T13:41:43.627

关于 QBO v3 API 的更新。

QBO v3 API 支持每个拥有 QuickBooks Online 版本的国家。

参考：[https ://intuitpartnerplatform.lc.intuit.com/questions/902695-total-list-of-countries-supported-for-qbo-v3-api](https://intuitpartnerplatform.lc.intuit.com/questions/902695-total-list-of-countries-supported-for-qbo-v3-api)

# xaml - 在 Windows 8 应用程序中使矩形高度为 0 的动画

> ID：14983574
> 
> 赞同：4
> 
> 时间：2013-02-20T15:26:08.173
> 
> 标签：xaml, windows-8, microsoft-metro

在 win8 应用程序中，我正在尝试使用小动画来制作 Rectangle 0 的高度

不透明度之类的属性工作正常，但我无法将动画带入高度或宽度。

```
<Page.Resources>
    <Storyboard x:Name="NewStory">
        <DoubleAnimation Storyboard.TargetName="MyRectangle"  Storyboard.TargetProperty="Height" From="100" To="0" Duration="0:0:1" />
    </Storyboard>
</Page.Resources> 

<Rectangle Name="MyRectangle" Width="100" Height="100" Tapped="MyRectangle_OnTapped">

private void MyRectangle_OnTapped(object sender, TappedRoutedEventArgs e)
{
    NewStory.Begin();
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T15:32:53.620

当您尝试更改影响布局的内容时，此更改的动画称为*相关动画*，默认情况下它不起作用。为了能够使用它，您应该将 EnableDependentAnimation 属性设置为 true。

```
<Storyboard x:Name="NewStory">
    <DoubleAnimation Storyboard.TargetName="MyRectangle"  Storyboard.TargetProperty="Height" From="100" To="0" Duration="0:0:1" EnableDependentAnimation="true" />
</Storyboard> 
```

# javascript - 按 Id 比较两个数组的元素，并从一个数组中删除另一个数组中未出现的元素

> ID：14983575
> 
> 赞同：3
> 
> 时间：2013-02-20T15:26:10.140
> 
> 标签：javascript, jquery

我有两个这样的对象数组：

```
var arr1 = [{Id: 1, Name: "Test1"}, {Id: 2, Name: "Test2"}, {Id: 3, Name: "Test3"}, {Id: 4, Name: "Test4"}]

var arr2 = [{Id: 1, Name: "Test1"}, {Id: 3, Name: "Test3"}] 
```

我需要比较两个数组`Id`的元素并从中删除`arr1`未出现的`arr2`元素（没有元素`Id`）。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-20T15:34:46.100

```
var res = arr1.filter(function(o) {
    return arr2.some(function(o2) {
        return o.Id === o2.Id;
    })
}); 
```

*垫片，垫片，垫片。*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-20T15:32:52.257

您可以使用接受任意数量数组的函数，并仅返回所有数组中存在的项目。

```
function compare() {
    let arr = [...arguments];
    return arr.shift().filter( y => 
        arr.every( x => x.some( j => j.Id === y.Id) )
    )
} 
```

```
var arr1 = [{Id: 1, Name: "Test1"}, {Id: 2, Name: "Test2"}, {Id: 3, Name: "Test3"}, {Id: 4, Name: "Test4"}];
var arr2 = [{Id: 1, Name: "Test1"}, {Id: 3, Name: "Test3"}, {Id: 30, Name: "Test3"}];
var arr3 = [{Id: 1, Name: "Test1"}, {Id: 6, Name: "Test3"}, {Id: 30, Name: "Test3"}];

var new_arr = compare(arr1, arr2, arr3);
console.log(new_arr);

function compare() {
	let arr = [...arguments]

	return arr.shift().filter( y => 
  	arr.every( x => x.some( j => j.Id === y.Id) )
  )
}
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-19T18:14:57.143

使用散列（一个集合）将获得性能提升：

```
var arr1 = [{Id: 1, Name: "Test1"}, {Id: 2, Name: "Test2"}, 
            {Id: 3, Name: "Test3"}, {Id: 4, Name: "Test4"}];

var arr2 = [{Id: 1, Name: "Test1"}, {Id: 3, Name: "Test3"}];

arr1 = arr1.filter(function (el) {
    return this.has(el.Id);
}, new Set(arr2.map(el => el.Id)));

console.log(arr1);
```

创建了一个新的[Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set) ，它从以下位置获取`Id`值`arr2`：

```
"1","3" 
```

该 Set 作为 to 传递[，`thisArg`因此`filter`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)在`filter`回调中它可以作为`this`.

# html - div重叠有问题，想设置固定位置

> ID：14983576
> 
> 赞同：0
> 
> 时间：2013-02-20T15:26:14.540
> 
> 标签：html, css

我是stackoverflow的新手，所以我提前为重新讨论这里已经解决的任何问题道歉（我相信他们是，只是不确定如何适用于我的具体情况）。

无论如何，这是我正在开发的网站 - [www.betsyandalex2013.com](http://www.betsyandalex2013.com)。我想将所有元素固定到位。我一直在使用 Firebug 玩它，但是当我使用`position: fixed;`on 时说`#wrap`我无法滚动查看其余内容。或者，当我固定 的位置时`#header`，链接会消失。同样，理想情况下，我希望将所有元素固定到位，并能够在调整浏览器大小时滚动（和向上/向下）以查看任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:33:36.943

我不确定你说的是什么。但是设置：#header {位置：固定；顶部：0；它会起作用：标题将超出页面的自然变化，即使您向下/向上滚动，它也会位于屏幕顶部。

PS：要查看效果，请将内容放入#wrap 元素。

# java - 转换 CharSequence[] 和 CharSequence[]

> ID：14983577
> 
> 赞同：1
> 
> 时间：2013-02-20T15:26:16.967
> 
> 标签：java, android

我一直认为 CharSequence[] 和 String[] 本质上是一样的，但是：

我有一些具有以下内容的代码：

```
CharSequence[] mEntries;
...
String[] mEntriesString = (String[]) mEntries;
ListAdapter adapter = new ArrayAdapter<String>(getContext(), R.layout.two_lines_list_preference_row, mEntriesString) 
```

当代码运行时，我得到

```
java.lang.ClassCastException: java.lang.CharSequence[] cannot be cast to java.lang.String[] 
```

那么两个问题？

*   为什么这个演员表不会发生
*   为什么 ArrayAdapter 不允许在其构造函数中使用 CharSequence[]。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:29:23.460

`CharSequence`是类实现`String`的接口。所以可以持有任何这个实现类的 Object 并返回，试试 -`StringBuffer``StringBuilder``CharSequence``CharSequence#toString``String`

```
String[] mEntriesString = new String[mEntries.length];
int i=0;
for(CharSequence ch: mEntries){
    mEntriesString[i++] = ch.toString(); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:29:39.577

`CharSequence`是一个接口。`String`类实现该接口。因此，您不能将其转换为`String`，就像您不能`List`转换为一样`ArrayList`，因为它不必是该具体类的实例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:33:16.253

您不能将引用`CharSequence[]`转换为`String[]`.

您只能在这种情况下施放它：

```
 CharSequence[] charSequencesAsString = new String[] { "test" };
        String[] result = (String[]) charSequencesAsString;
        System.out.println(Arrays.toString(result)); 
```

解决问题的安全方法：

```
public static void main(String[] args) {

    CharSequence[] charSequencesAsString = new String[] { "test" };
    CharSequence[] charSequencesAsCharSequence = new CharSequence[] { "test" };
    CharSequence[] charSequencesAsStringBuilder = new StringBuilder[] { new StringBuilder("Test") };

    String[] stringsFromStrings = convertToStringArray(charSequencesAsString);
    String[] stringsFromCharSequence = convertToStringArray(charSequencesAsCharSequence);
    String[] stringsFromStringBuilder = convertToStringArray(charSequencesAsStringBuilder);

    System.out.println("Same array after conversion: " + (stringsFromStrings == charSequencesAsString));
    System.out.println("Same array after conversion: " + (stringsFromCharSequence == charSequencesAsCharSequence));
    System.out.println("Same array after conversion: " + (stringsFromStringBuilder == charSequencesAsStringBuilder));
}

public static String[] convertToStringArray(CharSequence[] charSequences) {
    if (charSequences instanceof String[]) {
        return (String[]) charSequences;
    }

    String[] strings = new String[charSequences.length];
    for (int index = 0; index < charSequences.length; index++) {
        strings[index] = charSequences[index].toString();
    }

    return strings;
} 
```

# r - 对 R 中数据框的每一行运行 Fisher 测试

> ID：14983579
> 
> 赞同：2
> 
> 时间：2013-02-20T15:26:18.880
> 
> 标签：r, matrix, dataframe

我有一个由约 3k 调查人员进行的约 50k 测量的数据框。

```
INVETIGATOR_ID \\\ SAMPLE_ID \\\ MEASUREMENT
1000 \\ 38942 \\ 20.1
1000 \\ 38942 \\ 10.2
1001 \\ 38432 \\ 5.6
1002 \\ 553 \\ 10.6
...

```

我的目标是将每个调查员的样本测量值与整个数据集的测量值进行比较：

1.  对于每个调查员，计算那些与该调查员收集的测量平均值相差 +/- 一个标准偏差的测量值。
2.  对于整个数据框，计算那些与平均值相差 +/- 一个标准偏差的测量值。
3.  对于每个具有样本测量值 +/- 一个标准偏差的调查员，运行 Fisher 精确检验以确定样本数量是否显着（与整个数据框相比）。

我使用 Plyr 库 ( `ddply`) 来汇总数据`INVESTIGATOR_ID`。将数据合并在一起，最终结果是一个数据框，其中每一行包含一个调查员 ID、该调查员测量的样本数、该调查员测量的样本数 +/- 1 SD、15000 和 50000（其中 15000和 50000 是相应的样本数 +/- 1 SD 和整个数据帧的样本总数）。

```
INVESTIGATOR_ID \\\ NUMBER_OF_SAMPLES \\\ NUMBER_OF_SAMPLES_SD \\\ 15000 \\\ 50000 
```

如何获取数据框的每一行，将字段转换`c(2:5)`为矩阵，运行 Fisher 检验，并创建一个新的结果数据框？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:59:52.000

类似的东西（改编自我的脚本，可能需要更多修改以满足您的需要）：

```
get_fisher <- function(df){
  mat <- matrix(as.numeric(df[c(2:5)]), ncol=2)
  f <- fisher.test(as.table(mat), alt="two.sided")
  return(c(df[1], f$p.value))
}

fishers <- apply(df, 1,  get_fisher) 
```

# perl - Perl 中的 for 循环（如何对每个 url 做一些事情）

> ID：14983580
> 
> 赞同：-4
> 
> 时间：2013-02-20T15:26:25.037
> 
> 标签：perl

看看@arr 和@arre，因为我在第 20 行遇到错误：在 test.pl 第 20 行使用“strict refs”时不能使用字符串 ("") 作为 HASH ref。

第 20 行`for our $post (@{ $resp->{data} }) {`

```
sub graph_api {

  unlink "data.txt";
  open(MYFILE2, ">data.txt");
  close(MYFILE2);

  our @arr = (
    "me/inbox?fields=comments.limit(2)&limit=1",
    "me/home?fields=name,link,from,story,is_hidden,message&limit=1"
  );

  foreach our $arre (@arr) {
    my $uri = new URI("https://graph.facebook.com/" . $arre . "&access_token=");

    chomp(my $content = get $uri);
    die "Couldn't get $uri" unless defined $content;

    our $resp = get("$uri");

    defined $resp ? decode_json($resp) : undef;
  } 
```

但是当我改变这个 pert 时一切正常：

```
our @arr = ("me/inbox?fields=comments.limit(2)&limit=1","me/home?fields=name,link,from,story,is_hidden,message&limit=1");

  my $uri = new URI("https://graph.facebook.com/".$arr[0]."&access_token="); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:36:33.720

### 最初的问题

问题的原始版本询问了代码片段：

```
my @arr(somting somting1); 
for my $i(0 .. $#arr){ 
    my url = get (www.$arr[$i].com); 
    do something with url... 
} 
```

该问题已被更新，丢失了此信息。

### 初步反应

添加：

```
use strict;
use warnings; 
```

并修复它发现的问题。专家使用它们来确保他们不会犯愚蠢的错误。出于同样的原因，初学者需要使用它们。

显示的代码中至少有四个裸字。

初始化的语法`@arr`是错误的。使用其中之一：

```
my @arr = ( "somting", "somting1" );
my @arr = qw( somting somting1 ); 
```

你需要在你的论点周围加上双引号`get`：

```
get("www.$arr[$i].com"); 
```

更惯用的 Perl 会使用：

```
for my $core (@arr)
{
    my $url = get("www.$core.com");
    ...check...use...
} 
```

* * *

### 对修订问题的回应

您收到错误消息：

```
Can't use string ("") as a HASH ref while "strict refs" in use at test.pl line 20. 
```

在第 20 行，显然是：

```
for our $post (@{ $resp->{data} }) { 
```

该表示法`$resp->{data}`试图将`$resp`其视为哈希引用，但`$resp`不是哈希引用。您的代码包含：

```
defined $resp ? decode_json($resp) : undef; 
```

它表明循环中`$resp`可能未定义`for`，或者它包含需要解码的字符串（可能是一些 JSON）。你也许是说：

```
$resp = (defined $resp) ? decode_json($resp) : undef; 
```

我很感兴趣您使用的是`our`变量而不是`my`变量。这并不完全是错误的，但它是不寻常的。`my`除非您有明确的理由使用`local`or ，否则请使用`our`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:37:24.703

不要使用这样的索引变量来循环你的数组。像这样直接遍历数组：

```
my @domains = ( ... );
for my $domain ( @domains ) {
    my $url = "http://www.$host.com";
    ...
} 
```

而且，正如其他人所说，总是`use strict; use warnings;`，尤其是作为初学者。

# variables - 如何使用 VBA 循环访问 MS Access 记录集并将变量分配给结果？

> ID：14983587
> 
> 赞同：4
> 
> 时间：2013-02-20T15:26:51.283
> 
> 标签：variables, ms-access, loops, vba, assign

我的 VBA 生锈了，我似乎在画一个空白。如果重要，我正在使用 MS Access 2010。

我有一个查询的结果，它返回两个字段（Field1 是文本，Field2 是双精度）和五个记录，我想根据 Field1 中的内容将 Field2 值分配给五个不同的变量。对我来说，这是某种案例陈述——我将如何在记录集上的 VBA 中执行此操作？

```
 Private Sub test()

  Dim myRS As DAO.Recordset
  Dim db As Database
  Dim strSQL As String
  Dim v1, v2, v3, v4, v5 As Double

  ' Pretend strSQL is a different query that gives five records

  Set dbs = CurrentDb
  strSQL = "SELECT Field1, BigNumber FROM tmp1"
  Set myRS = dbs.OpenRecordset(strSQL)

  Do While Not myRS.EOF
      v1 = ?         ' I want v1 = Field2 when Field1="A"
      v2 = ?         ' I want v2 = Field2 when Field1="B"
      v3 = ?         ' I want v3 = Field2 when Field1="C"
      v4 = ?         ' I want v4 = Field2 when Field1="D"
      v5 = ?         ' I want v5 = Field2 when Field1="E"
  Loop

  End Sub 
```

非常感谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T15:37:11.800

```
Private Sub test()

Dim myRS As DAO!Recordset
Dim db As Database
Dim strSQL As String
Dim v1, v2, v3, v4, v5 As Double

' Pretend strSQL is a different query that gives five records

Set dbs = CurrentDb
strSQL = "SELECT Field1, BigNumber FROM tmp1"
Set myRS = dbs!OpenRecordset(strSQL)

Do While Not myRS!EOF
    Select Case myRS.Fields(0)
    Case "A"
        v1 = myRS.Fields(1)
    Case "B"
        v2 = myRS.Fields(1)
    Case "C"
        v3 = myRS.Fields(1)
    Case "D"
        v4 = myRS.Fields(1)
    Case "E"
        v5 = myRS.Fields(1)
    End Select
Loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-04T14:48:15.477

我认为你失踪了`MoveNext`：

```
Do While Not rec.EOF
    rec.MoveNext
Loop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:32:46.693

在这种情况下，您不妨只使用 DlookUp 而忘记记录集：

```
 v1 = DLookUp("BigNumber","tmp1","Field1='A'")
 v2 = DLookUp("BigNumber","tmp1","Field1='B'")

 <...> 
```

# excel - 当我合并工作簿时，数据验证停止工作

> ID：14983588
> 
> 赞同：1
> 
> 时间：2013-02-20T15:26:52.340
> 
> 标签：excel, merge, validation, vba

我使用 Visual Basics 将 8 个工作簿合并在一起；但是，当我这样做时，除了新工作簿的第一页之外，我的数据验证停止了所有工作。有谁知道为什么会发生这种情况以及我能做些什么来解决它？是否有一种方法可以在不使用视觉基础的情况下合并工作簿，从而保持数据验证？非常感谢你的帮助！

# wordpress - 使用 .htaccess 防止 DDOS 攻击无法使用永久链接

> ID：14983590
> 
> 赞同：1
> 
> 时间：2013-02-20T15:26:59.113
> 
> 标签：wordpress, .htaccess, permalinks, ddos

我们已成为 WordPress 网站上恶意 DDOS 攻击的受害者。

值得庆幸的是，它们应该很容易被删除，因为它们是带有字符串 ?ptrxcz 附加到 URL 末尾的 GET 请求。

考虑到这一点，我们设置了规则，为使用 .htacess 实现此功能的请求提供 403 权限错误页面。问题是这些似乎也不适用于安装的永久链接。

这是我完整的 .htaccess 文件。

> ```
> RewriteEngine On
> RewriteCond %{QUERY_STRING} .*ptrxcz.*
> RewriteRule (.*) - [F]
> 
> # BEGIN WordPress
> 
> <IfModule mod_rewrite.c>
> RewriteEngine On
> RewriteBase /
> RewriteRule ^index\.php$ - [L]
> RewriteCond %{REQUEST_FILENAME} !-f
> RewriteCond %{REQUEST_FILENAME} !-d
> RewriteRule . /index.php [L]
> </IfModule>
> 
> # END WordPress 
> ```

开始部分是使用 ptrxcz 将用户重定向到 403 页面。如果我删除它下面的 WordPress 规则，这将非常有效，但如果包含它们，它就永远不会起作用。

令人沮丧的是，使用带有 QUERY_STRING 搜索的负正则表达式可以正确地反向工作（使用查询字符串阻止除请求之外的所有内容，如下所示：

```
RewriteCond %{QUERY_STRING} !.*ptrxcz.* 
```

（注意添加的！）

有谁有想法吗：

1.  为什么它不适用于永久链接
2.  我如何使它与永久链接一起使用
3.  为什么查询字符串上的负正则表达式有效但不是正则表达式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T15:29:43.947

我遇到了同样的问题，但严重到我启动了一个小型 Web 服务器来充当前端并过滤掉这些请求。相关的 iptables 规则是：

iptables -A INPUT -p tcp --dport 80 -m string --to 70 --algo bm --string 'ptrxcz_' -j DROP

它指示系统检查请求的前 70 个字符，如果找到“ptrxcz_”，则静默丢弃请求。我尝试返回错误消息，但考虑到连接的另一端永远不会有用户读取错误，错误代码消耗的带宽不值得。

我创建了一篇博客文章，描述了我采取的步骤：

[http://web.htcomp.net/?pageid=85&blogger=2](http://web.htcomp.net/?pageid=85&blogid=2)

拉里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T09:27:14.637

如果您`QUERY_STRING`在上面的代码中替换为`THE_REQUEST`then 这可以正常工作，并且完全符合 WordPress 中的要求。

# c# - 将数组解包到方法参数中

> ID：14983592
> 
> 赞同：8
> 
> 时间：2013-02-20T15:27:01.700
> 
> 标签：c#, arrays, syntax, variadic-functions, params-keyword

如您所知，C# 通过`params`关键字支持可变参数方法：

```
int Add(params int[] xs) {
    return xs.Sum();
} 
```

然后可以使用您喜欢的任意数量的参数调用它：

```
Add(1);
Add(1, 2);
Add(1, 2, 3); 
```

但是假设我想使用s ¹`Add`的数组来调用。这是否可能以及如何（最好没有反思）？我尝试了以下方法，但它们给出了语法错误（语法纯属猜测）：`int`

```
var xs = new[] { 1, 2, 3 };
Add(xs...); // doesn't work; syntax error
Add(params xs); // doesn't work; syntax error 
```

* * *

^(¹我的实际用例有所不同，但我认为这个例子不会那么复杂。)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-20T15:30:02.937

您的方法需要返回类型：

```
int Add(params int[] xs) {
    return xs.Sum();
} 
```

要使用数组调用它，您只需使用方法调用的普通语法：

```
int[] xs = new[] { 1, 2, 3 };
var result = Add(xs); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:33:34.283

关键字基本上只允许您利用`params`一点语法糖。它告诉编译器当它看到

```
Add(1, 2, 3); 
```

它应该将其转换为

```
Add(new int[] { 1, 2, 3}); 
```

因此，要从您的代码中执行此操作，您无需执行任何特殊操作。

```
 int[] parameters = new int[] { ... }
 results = Add(parameters); 
```

有关更多详细信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/w5zay9db.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:30:19.270

据我所知，您可以像使用普通方法一样使用数组调用它：

```
Add(xs); 
```

没什么花哨`params`的，方法调用上没有关键字，没有点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:31:41.733

```
static void Main(string[] args)
{
    int[] tmp =  {1, 2};
    var sum = Add(tmp);
}
public static int Add(params int[] xs)
{
    return xs.Sum();
} 
```

应该可以正常工作..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T15:34:14.813

如果它与 Java 类似，则可以将数组作为参数调用该方法。

此功能也是使可变参数变得危险的原因，尤其是如果可变参数类型之一也是数组时...

# sql - 根据 SQL Server 中的两列选择行

> ID：14983598
> 
> 赞同：0
> 
> 时间：2013-02-20T15:27:10.757
> 
> 标签：sql, sql-server

我有一个存储数据的表，由于服务器端代码上的用户名字段区分大小写，因此意外存储了多次数据。用户名字段应被视为不区分大小写。该表的重要列和数据可以在下面找到。

我现在的要求是删除除最近保存的数据之外的所有数据。我正在为此编写一个 sql 脚本，并从识别所有重复的行开始。此选择返回如下表。

对于每一行，最近的保存是 LASTUPDATEDDATE（如果存在），否则是 CREATEDDATE。对于此示例，“用户名”的最新保存将是第 3 行。

```
ID CREATEDDATE LASTUPDATEDDATE USERNAME                           
-- ----------- ---------------- --------
1 11-11-11 用户名                                
2 01-NOV-11 02-NOV-11 用户名                            
3 2012 年 1 月 8 日用户名      

```

我的脚本（选择出现重复用户名的所有行）如下所示：

```
 SELECT 
  id, createddate, lastupdateddate, username
FROM
  table
WHERE
  LOWER(username)
IN
  (
    SELECT 
      LOWER(username)
    FROM 
      table
    GROUP BY 
      LOWER(username)
    HAVING 
      COUNT(*) > 1
  )  
ORDER BY
  LOWER(username) 
```

我现在的问题是：**如何选择除第 3 行之外的所有内容？**我在 Stack Overflow 上搜索了该问题的匹配项，但没有找到足够匹配的匹配项。我知道我可能必须加入某种形式，但我无法真正理解它。非常感谢您朝着正确的方向前进。

我们正在使用 SQL Server，可能是一个相当新的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:30:06.387

要删除重复项，您可以使用：

```
with todelete as (
     select t.*,
            row_number() over (partition by lower(username) order by createddate desc) as seqnum
     from table
    )
delete from t
where seqnum > 1 
```

这会为每一行分配一个序列号，从 1 开始表示最近的行。然后它会删除除最新的以外的所有内容。

对于两个日期，您可以使用：

```
with todelete as (
     select t.*,
            row_number() over (partition by lower(username) order by thedate desc) as seqnum
     from (select t.*,
                  (case when createddate >= coalesdce(updateddate, createddate)
                        then createddate 
                        else updateddate
                   end) as thedate
           from table
          ) t
    )
delete from t
where seqnum > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:45:42.020

有几点需要注意——没有理由`LOWER`在您的查询中使用。A = SQL Server 中的一个。

此外，要获得正确的日期，您可以使用`COALESCE`来确定 LastUpdatedDate 是否存在，如果存在，则按它排序，否则按 CreatedDate 排序。

放在一起，这应该工作：

```
DELETE T
FROM YourTable T 
  JOIN (
     SELECT *, ROW_NUMBER() OVER (PARTITION BY username  
                   ORDER BY COALESCE(lastupdateddate, createddate) DESC) as RN
     FROM YourTable
    ) T2 ON T.Id = T2.Id
WHERE T2.RN > 1 
```

这是一个示例小提琴：[http ://www.sqlfiddle.com/#!3/51f7c/1](http://www.sqlfiddle.com/#!3/51f7c/1)

正如@Gordon 正确建议的那样，您还可以根据您使用的 SQL Server 版本（2005+）使用 CTE：

```
WITH CTE AS (
     SELECT *, ROW_NUMBER() OVER (PARTITION BY username  
                               ORDER BY COALESCE(lastupdateddate, createddate) DESC) as RN
     FROM YourTable
    ) 
DELETE FROM CTE WHERE RN > 1 
```

# php - 位置标题上的管道字符不起作用

> ID：14983600
> 
> 赞同：0
> 
> 时间：2013-02-20T15:27:15.617
> 
> 标签：php, header, location, pipe

我正在尝试使用以下方法重定向 URL：

$url = "位置：[http](http://mydomain.com/#!Mypage|000) ://mydomain.com/#!Mypage|000 "; 标头（$url）；

但结果是重定向到：

[http://mydomain.com/#!Mypage%7C000](http://mydomain.com/#!Mypage%7C000)

问题是管道字符。正确的方法是如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:31:19.817

`%7C` *是*管道字符。如果 mydomain.com 上的 Web 服务器的处理`Mypage%7C000`方式不同于`Mypage|000`，则 Web 服务器已损坏。

# php - 正则表达式匹配 http:// 但不是 http:// 前面有引号

> ID：14983602
> 
> 赞同：0
> 
> 时间：2013-02-20T15:27:24.483
> 
> 标签：php, regex, html-parsing

我有这个正则表达式来匹配文本的**http://**链接式部分：

```
([A-Za-z]{3,9}):\/\/([-;:&=\+\$,\w]+@{1})?([-A-Za-z0-9\.]+)+:?(\d+)?(\/[-\+~%\/\.\w]+)?\??([-\+=&;%@\.\w]+)?#?([\w]+)? 
```

然后用一些代码将它们转换为超链接。它真的很好用。

但是，http:// 部分文本也可以在 <img> 标签中找到：

```
<img src="http://www.nature.com/images/home_03/main_news_pic2013.02.19.jpg" alt="Pulpit rock" width="304" height="228"> 
```

因此，我必须修改现有的正则表达式，以不匹配之前带有引号或撇号的类似 http 链接的文本部分。如何不匹配：

```
"http 
```

我尝试使用 [^"|']：

```
[^"|']([A-Za-z]{3,9}):\/\/ .......... 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:30:34.473

您需要使用否定的lookbehind（即“不在前面”）：

```
(?<!")http://… 
```

# wcf - 为了在 IIS 上部署 WCF 服务，我需要在 Web 配置中进行哪些更改

> ID：14983605
> 
> 赞同：0
> 
> 时间：2013-02-20T15:27:31.597
> 
> 标签：wcf

```
 <system.serviceModel>
    <behaviors>
        <serviceBehaviors>
           <behavior name="ServiceBehavior">
               <serviceMetadata httpGetEnabled="true"/>
               <serviceDebug includeExceptionDetailInFaults="true"/>
           </behavior>
        </serviceBehaviors>
        <endpointBehaviors>
            <behavior name="EndpBehavior">
                <webHttp/>
            </behavior>
        </endpointBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
    <standardEndpoints>
        <webScriptEndpoint>
             <standardEndpoint name="" crossDomainScriptAccessEnabled="true" />
        </webScriptEndpoint>
    </standardEndpoints>
    <services>
        <service behaviorConfiguration="ServiceBehavior" name="Service">
            <endpoint address="" binding="webHttpBinding" contract="IService" behaviorConfiguration="EndpBehavior"/>
        </service>
    </services>
</system.serviceModel> 
```

在 IIS 上部署 WCF 服务后，我需要在 Web 配置中进行哪些更改？我的代码正在运行两个项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T18:02:39.810

Your service and contract name should be a fully qualified names.

check this

# java - 使用 Google Guice 上下文绑定两个不同的接口实现

> ID：14983612
> 
> 赞同：0
> 
> 时间：2013-02-20T15:27:38.777
> 
> 标签：java, servlets, guice

假设我有一个名为的接口`IValidator`，如下所示：

```
public interface IValidator {
    /**
     * Returns true if the specified strings are valid.
     */
    public boolean validate(List<String> someStrings);
} 
```

现在假设我有两个实现`IValidator`：

```
public class StrictValidator implements IValidator {
    public boolean validate(List<String> someStrings) {
        //some strict validation code
        return false;
    }
}

public class LaissezFaireValidator implements IValidator {
    public boolean validate(List<String> someStrings) {
        //some easy-going validation code
        return true;
    }
} 
```

现在让我们添加一个使用注入实例的 servlet `IValidator`：

```
@Service
@At("/rest")
public class MyServlet extends AbstractServlet {

    private final IValidator validator;

    @Inject
    public MyServlet(final IValidator validator) {
        this.validator = validator;
    }

    @Post
    @At("/validate")
    @LaissezFaire
    public Reply<?> validate(Request request) {
        //get the strings to validate out of the request object
        List<String> strings = (List<String>) restUtil.parseRequest(request, List.class);

        //validate the request
        if (!this.validator.validate(strings)) {
            return Reply.saying().status(409);
        } else {
            return Reply.saying().noContent();
        }
    }
} 
```

当然，我们还需要绑定`IValidator`到`StrictValidator`模块中：

```
public class ValidatorModule implements Module {
    @Override
    protected void configure() {
        bind(IValiator.class).to(StrictValidator.class);
    }
} 
```

但是，如果我想在一种情况下有条件地绑定`IValidator`到`StrictValidator`，但在另一种情况下将其绑定到，会发生什么`LaissezFaireValidator`？

注意到上面的`@LaissezFaire`注释了`MyServlet.validate`吗？这是一个看起来像这样的拦截器：

```
@BindingAnnotation
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface LaissezFaire { }

public class LaissezFaireInterceptor implements MethodInterceptor {
    private boolean debug;
    private IValidator validator;

    @Inject
    public void setDebug(@Named("debug.enabled") boolean debugEnabled) {
        this.debug = debugEnabled;
    }

    @Inject
    public void setValidator(final IValidator validator) {
        this.validator = validator;
    }

    @Override
    public Object invoke(MethodInvocation invocation) throws Throwable {
        if (debug) {
            if (!this.validator.validate(strings)) {
                return Reply.saying().status(409);
            } else {
                return Reply.saying().noContent();
            }
        } else {
            return invocation.proceed();
        }
    }
} 
```

再一次，我们需要一些绑定来设置拦截器：

```
public class InterceptorModule implements Module {
    @Override
    protected void configure() {
        final MethodInterceptor lfInterceptor = new LaissezFaireInterceptor();
        requestInjection(lfInterceptor);
        bindInterceptor(Matchers.subclassesOf(AbstractServlet.class), Matchers.AnnotatedWith(LaissezFaire.class), lfInterceptor);
    }
} 
```

根据`ValidatorModule`，该类会在调用时`LaissezFaireInterceptor`获得一个实例。`StrictValidator``InterceptorModule``requestInjection(lfInterceptor);`

相反，我想`MyServlet`获取 的实例`StrictValidator`和`LaissezFaireInterceptor`的实例`LaissezFaireValidator`。

根据[Google Guice 文档](http://code.google.com/p/google-guice/wiki/BindingAnnotations)，我可以在请求注入时使用命名注释。的构造函数`MyServlet`将被修改为如下所示：

```
 @Inject
    public MyServlet(@Named("strict") final IValidator validator) {
        this.validator = validator;
    } 
```

并且`setValidator`方法`LaissezFaireInterceptor`将被修改为如下所示：

```
 @Inject
    public void setValidator(@Named("laissezfaire") final IValidator validator) {
        this.validator = validator;
    } 
```

最后`ValidatorModule`将被修改为如下所示：

```
public class ValidatorModule implements Module {
    @Override
    protected void configure() {
        bind(IValiator.class).annotatedWith(Names.named("strict")).to(StrictValidator.class);
        bind(IValidator.class).annotatedWith(Names.named("laissezfaire")).to(LaissezFaireValidator.class);
    }
} 
```

这一切都很好，除了文档特别说要避免这种方法，因为编译器无法检查字符串名称。此外，这意味着我必须`@Named`在代码中请求`IValidator`通过注入的每个地方添加注释，否则绑定将失败。

我真的希望[Provider Bindings](http://code.google.com/p/google-guice/wiki/ProviderBindings)可以为我解决这个问题，但他们似乎对进行绑定的上下文一无所知。由于他们不知道请求绑定的类的类型，因此我无法选择从该方法`IValidator`返回的类型。`get()`

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T14:59:56.413

虽然[Condit](https://stackoverflow.com/users/463324/condit)提供了一些出色的建议，但我们选择使用更直接的解决方案来解决这个问题。

如上，我们创建了`IValidator`接口，以及`StrictValidator`和`LaissezFaireValidator`类。我们在默认情况下使用`ValidatorModule`绑定`IValidator`到。`StrictValidator`提醒一下，它看起来像这样：

```
public class ValidatorModule implements Module {
    @Override
    protected void configure() {
        //in the default case, inject an instance of StrictValidator
        bind(IValiator.class).to(StrictValidator.class);
    }
} 
```

在绝大多数情况下，`StrictValidator`这是必需的实现，因为`LaissezFaireInterceptor`它是用于测试的作弊。

无论我们想要一个`StrictValidator`（就像我们在 中所做的那样`MyServlet`），我们都注入了一个实例`IValidator`：

```
public class MyServlet extends AbstractServlet {

    private final IValidator validator;

    @Inject
    public MyServlet(final IValidator validator) {
        this.validator = validator;
    }

    //... there's more code here (look above) ...
} 
```

无论我们想要一个实例`LaissezFaireValidator`，我们都要求注入它的具体实现来代替`IValidator`：

```
public class LaissezFaireInterceptor implements MethodInterceptor {

    private final IValidator validator;

    //... a bunch of other code goes here (see above) ...

    @Inject
    public void setValidator(final LaissezFaireValidator validator) {
        this.validator = validator;
    }

    //... and a bunch more code goes here (again, see above) ...
} 
```

通过这种方式，我们能够根据注入的上下文有条件地注入所需的实现，而无需引入任何额外的注释或工厂。

当然，它并不像它可能的那样*Guicy ，但它确实有效。*

# sql-server-2008 - 无法在 SQL 中多次运行查询

> ID：14983618
> 
> 赞同：1
> 
> 时间：2013-02-20T15:27:49.817
> 
> 标签：sql-server-2008

使用 SQL Server 2008，我有这个第一次运行它的查询，但如果我尝试再次运行它，我得到一个错误

```
if (exists (select * from tempdb.INFORMATION_SCHEMA.TABLES where TABLE_NAME = '##a12'))
begin
drop table ##a12
end
else
declare @p varchar(1000)
declare @s varchar(5)
declare @xx2 varchar(2000)

set @p = '64-267-601'
select top 1  @p=ivproduct from rpiv where upc=@p or ivproduct=@p
select distinct storeid,color,wil,cast('OH' as varchar(4)) as TP into ##a12 from rpiv i, rpproducts p where i.ivproduct=p.productid and p.productid=@p
insert into ##a12 select storeid,color,wil,'Rcvd' from ##a12
insert into ##a12 select storeid,color,wil,'Sld' from ##a12 where tp='oh'

DECLARE myCursor CURSOR FOR SELECT distinct size from rpiv where ivproduct=@p
open MyCursor
FETCH NEXT FROM myCursor into @S
WHILE @@FETCH_STATUS = 0
    begin
    set @xx2='alter table ##a12 add ['+@s+'] varchar(5)'
    exec(@xx2)
    set @xx2='update a set a.['+@s+']=coalesce(b.onhand,0) from ##a12 a,rpiv b where a.tp=''oh'' and a.storeid=b.storeid and a.color=b.color and a.wil=b.wil and b.size='''+@s+''''
    exec(@xx2)
    set @xx2='update a set a.['+@s+']=coalesce(b.PurchasedToDate,0) from ##a12 a,rpiv b where  a.tp=''rcvd'' and a.storeid=b.storeid and a.color=b.color and a.wil=b.wil and b.size='''+@s+''''
    exec(@xx2)
    set @xx2='update a set a.['+@s+']=coalesce(b.SoldtoDate,0) from ##a12 a,rpiv b where  a.tp=''sld'' and a.storeid=b.storeid and a.color=b.color and a.wil=b.wil and b.size='''+@s+''''
    exec(@xx2)
    set @xx2='update ##a12 set ['+@s+']='''' where ['+@s+'] =''0'''
    exec(@xx2)
    set @xx2='update ##a12 set ['+@s+']='''' where ['+@s+'] is null'
    exec(@xx2)

    FETCH NEXT FROM myCursor into @S
    End
Close myCursor
DEALLOCATE myCursor
if not exists(select * from ##a12 where wil<>'') 
begin
alter table ##a12 drop column wil
select * from ##a12 order by storeid,color,tp
end
else
select * from ##a12 order by storeid,color,wil,tp 
```

这是我得到的错误：

```
Msg 207, Level 16, State 1, Line 14
Invalid column name 'wil'.
Msg 213, Level 16, State 1, Line 14
Column name or number of supplied values does not match table definition. 
```

如果我重新加载我的管理工作室，它工作得很好，如果我手动删除表，它也工作得很好。我之前在开始时使用过 if > drop 语句没有问题，但由于某种原因它现在没有使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:37:22.240

尝试添加`GO`：

```
Close myCursor
DEALLOCATE myCursor
GO

if not exists(select * from ##a12 where wil<>'') 
begin 
```

发生这种情况是因为在第二次执行时解析批处理时，该`wil`列已被删除，并且解析器没有意识到当临时表被删除并重新创建时它将被重新添加。

通过添加`GO`，您将批次分成两部分......当第二批运行时，该`wil`列再次存在。

# java - 获取以 JSoup 结尾的 .html 的 URL

> ID：14983619
> 
> 赞同：2
> 
> 时间：2013-02-20T15:27:49.763
> 
> 标签：java, jsoup

我正在尝试使用 JSoup 连接到 URL。

当我使用以下代码时

```
Jsoup.connect("http://www.example.com/").get();
Jsoup.connect("http://www.example.com/example.html").get(); 
```

第一次调用成功，第二次引发异常：

```
Exception in thread "main" java.lang.IllegalArgumentException: Malformed URL: http://www.example.com/example.html
  at org.jsoup.helper.HttpConnection.url(HttpConnection.java:55)
  at org.jsoup.helper.HttpConnection.connect(HttpConnection.java:27)
  at org.jsoup.Jsoup.connect(Jsoup.java:73)
  at webscraper.JsoupTest.main(JsoupTest.java:259)
Caused by: java.net.MalformedURLException: no protocol: http://www.example.com/example.html
  at java.net.URL.<init>(URL.java:567)
  at java.net.URL.<init>(URL.java:464)
  at java.net.URL.<init>(URL.java:413)
  at org.jsoup.helper.HttpConnection.url(HttpConnection.java:53)
  ... 3 more 
```

我认为它与 URL 中的“.html”有关。

如何使用 JSoup 连接到 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:43:28.127

它与 .html 无关，您的第二个 url 中有一个空格前缀。删除空白空间，它会在我身边正常工作。

您可以使用此[工具](http://www.dolcevie.com/js/converter.html)将 asii 单独转换为十六进制的行代码，您会注意到第二个 url 在 16 的位置有一个多余的 char '1f'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:36:21.660

我猜这是因为您应该对 URL 中的破折号进行编码。尝试这个：

```
String url = java.net.URLEncoder.encode("http://www.example.com/example.html", "UTF-8");
Jsoup.connect(url).get(); 
```

文档：[http ://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)

# php - 复制PHP时如何设置目标文件夹

> ID：14983621
> 
> 赞同：1
> 
> 时间：2013-02-20T15:28:02.270
> 
> 标签：php, directory, copying

嗨，PHP 新手一直在尝试使用复制和粘贴代码（不要恨我）来组合一个应用程序并对其进行定制以满足我的需要，但我已经碰壁了。以这种方式做事的问题是很难得到充分的理解。这是问题所在。我正在将文件从一个目录复制到另一个目录，并在此过程中对其进行重命名。但是我想实际从源复制一个文件（这很好），然后将它放在一个名为 users 的文件夹中。尝试了几个不同的选项，只是得到了错误。任何帮助表示赞赏。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>User registration</title>
</head>
<body>
<?php
require_once('config.php'); // include config file
require_once('function.php'); // include copy file that have copy function.
?>
<div class="center">
<h1>Please Enter the details shown below..</h1>
<form action="index.php?action=submit" method="post">
<table class="table" align="center">
<tr>
<td>User Name:</td>
<td><input type="text" name="uname" /></td>
</tr>
<tr>
<td>Password:</td>
<td><input type="password" name="pwd" /></td>
</tr>
<tr>
<td>Click on Submit..</td>
<td><input type="submit" value="Submit" name="action"/></td>
</tr>
</table>
</form>
</div>
<?php
if($_POST["action"]=='') // check for parameter if action=submit or not if it is blank    then show this message
{
echo "Please fill 'User Name' and 'Password' above!";
}
else{
if($_POST["uname"]==''){ // if username left then check for password field
if($_POST["pwd"]==''){ // if it also blank then show this message
echo "You leave both the fields blank. Please fill them and then click on submit to    continue.";
} 
else {echo "User Name field can not be left blank."; // else show user name left blank
 }
 }
elseif ($_POST["pwd"]==''){ // if username is there then check for a null password
echo "Password field can not be left blank.";
}
else{
// We will add User into database here..
$query="INSERT INTO $DBTable (username, password)
VALUES('$_POST[uname]','$_POST[pwd]')";
// We are doing it for an example. Please encrypt your password before using it on your   website
if (!mysql_query($query,$con))
{
die('Error: ' . mysql_error());
}
echo "1 record added ";

// Now Create a directory as User Name.
 $username=$_POST["uname"];
 mkdir(dirname(__FILE__)."/users/"."$username"); // Create Directory
 recurse_copy($SourceDir,$username); // Copy files from source directory to target  directory
 // Finally print the message shown below.?> 
  Welcome <?php echo $_POST["uname"]; ?>!
  You are account folder with name <?php echo $_POST["uname"]; ?> has been created    successfully.
  <?}}?>
  </body>
  </html> 
```

这是功能代码。

```
<?php
// This source code is copied from http://php.net/manual/en/function.copy.php 
// Real author of this code is gimmicklessgpt at gmail dot com
function recurse_copy($src,$dst) { // recursive function that copy files from one    directory to another
$dir = opendir($src);
@mkdir($dst);
while(false !== ( $file = readdir($dir)) ) {
    if (( $file != '.' ) && ( $file != '..' )) {
        if ( is_dir($src . '/' . $file) ) {
            recurse_copy($src . '/' . $file,$dst . '/' . $file);
        }
        else {
            copy($src . '/' . $file,$dst . '/' . $file);
        }
    }
    }
    closedir($dir);
   //echo "$src";
 }

 ?> 
```

不要认为配置文件包含任何会更改副本目标的内容，因此不包括在内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:40:48.400

我看到2个问题。首先是你如何调用你的函数：

```
mkdir(dirname(__FILE__)."/users/"."$username"); // Create Directory
recurse_copy($SourceDir,$username); // Copy files from source directory to target  directory 
```

应该：

```
// Create Directory
mkdir(dirname(__FILE__)."/users/"."$username"); 
// Copy files from source directory to target  directory; the one you just created
recurse_copy($SourceDir,dirname(__FILE__)."/users/"."$username"); 
```

第二个是`@mkdir($dst);`在你的函数中。您应该更改逻辑以仅创建原始目标的子目录。

# database-design - 实体关系用户和联系人

> ID：14983622
> 
> 赞同：2
> 
> 时间：2013-02-20T15:28:05.567
> 
> 标签：database-design, entity-relationship

我正在尝试创建用户有联系人的数据库。我设计了下表，我对关系应该如何的部分感到困惑，因为它看起来应该是一对多的，但它也是多对多的关系。

在数据库中，每个用户都必须有联系人表，联系人是数据库中的其他用户。但是联系人必须属于每个用户。

在这种情况下是什么关系？

![在此处输入图像描述](../Images/389deb73201fa5f179d51dcb57486170.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:15:02.647

> 在这种情况下是什么关系？

多对多。

在您的联系人表中，您有一个 owner_id 和一个contact_id。您可以轻松地将这些列称为 user_1_id 和 user_2_id。

使用您的列名，一个contact_id 可以有多个owner_id，一个owner_id 可以有多个contact_id。

Contacts 表上的集群（主）索引是 (owner_id, contact_id)。您还需要在 Contacts 表上定义一个唯一索引 (contact_id, owner_id)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:38:07.047

联系人是人，用户也是人（公司是法人）。

一个人可以扮演用户的角色，也可以不扮演。

一个人可以在一段时间内与另一个人建立关系。

一个示例party_relationship.type 将是“联系人”

![在此处输入图像描述](../Images/cf50357ed9819fdd36a22af2f969e3d0.png)

# visual-studio-2008 - lc.exe 在 Visual Studio 2008 中找不到

> ID：14983624
> 
> 赞同：1
> 
> 时间：2013-02-20T15:28:11.990
> 
> 标签：visual-studio-2008

先生，我是新站点，对于 Visual Studio，我安装了 vs2008，并且我使用 xp sp3，当我调试我的项目时，它说

**“任务失败，因为未找到“LC.exe”，或者未安装正确的 Microsoft Windows SDK。该任务正在注册表的 InstallationFolder 值中指定的位置下的“bin”子目录中查找“LC.exe”密钥 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v6.0A。您可以通过执行以下操作之一解决此问题：1) 安装适用于 Windows Server 2008 和 .NET Framework 3.5 的 Microsoft Windows SDK。2)安装 Visual Studio 2008。3) 手动将上述注册表项设置到正确的位置。4) 将正确的位置传递到任务的“ToolPath”参数中。”**

在 SOFTWARE\Microsoft\Microsoft SDKs\Windows\v6.0A 它包含名为 lc.exe 的 .exe

但在 Program Files\Microsoft Visual Studio 9.0\SDK\v3.5\Bin 中没有名为 lc.exe 的文件或应用程序

可能这是一个转储问题，但请帮助..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-16T12:19:08.807

任务失败，因为找不到“LC.exe”，或者未安装正确的 Microsoft Windows SDK。该任务正在注册表项 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v6.0A 的 InstallationFolder 值中指定的位置下的“bin”子目录中查找“LC.exe”。您可以通过执行以下操作之一来解决此问题： 1) 安装适用于 Windows Server 2008 和 .NET Framework 3.5 的 Microsoft Windows SDK。2) 安装 Visual Studio 2008。 3) 手动将上述注册表项设置到正确的位置。4) 将正确的位置传递到任务的“ToolPath”参数中。”

# session - $_POST 会话重新启动后不存储值

> ID：14983625
> 
> 赞同：1
> 
> 时间：2013-02-20T15:28:11.637
> 
> 标签：session, post

我正在使用 $_SESSION 存储多页表单中的数据。表单完成并提交后，终止会话并擦除会话数据：

```
$_SESSION = array();

setcookie(session_name(), '', time() - 42000]

session_destroy(); 
```

然后，当我下次提供表单时，我会调用 session_start()。

但是，重新启动会话后，没有任何内容存储在 $_POST 或 $_SESSION 中。我试过切换浏览器和重启服务器，都没有效果。

我真的很感激任何想法。可能会发生什么。

谢谢，

菲尔

# paypal - 使用 PayPal IPN 作为 API 触发器是一个好的实现吗？

> ID：14983626
> 
> 赞同：0
> 
> 时间：2013-02-20T15:28:12.373
> 
> 标签：paypal, paypal-ipn, paypal-adaptive-payments

根据 PayPal 的建议，我正在使用 PayPal API 和 IPN 的组合来创建“自适应支付”流程。

当我的 IPN 侦听器收到来自 PayPal 的新通知时，我有两个选择（在安全检查之后）：

1）使用接收到的数据在我的网站上进行直接操作（例如将预先批准设置为已批准）

或者是一种更安全、更干净的方式（我认为）：

2) 检测交易类型变量（或其他标识符）并相应地向 PayPal 请求更多详细信息。

例如，如果“transaction_type”是“Adaptive Payment Preapproval”，那么我将使用收到的“preapproval_key”通过 PreapprovalDetails API 调用请求预先批准的详细信息，然后使用接收到的该调用的数据将预先批准设置为已批准。

这是（选项2）更好的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T01:59:42.283

一般来说，IPN 中可能有足够的信息供您采取行动，但是 IPN 很容易混淆所有可选字段以及订阅事件中没有 payment_status 或 txn_id 以及支付事件中没有订阅信息的方式，所以让他们结婚会很有趣。如果您继续按照您的建议通过他们的 API 从他们那里获取每个 IPN 的相关信息，您可能会发现更容易理解。

# javascript - Facebook页面喜欢计数

> ID：14983632
> 
> 赞同：1
> 
> 时间：2013-02-20T15:28:20.880
> 
> 标签：javascript, facebook-graph-api, coding-style, facebook-fql, facebook-page

如何将其放入 <script> 或 javascript 设置中

```
https://api.facebook.com/method/fql.query?format=json&query=select+fan_count+from+page+where+page_id%3D80177638103
```

这将返回 fan_count 编号。到一个页面。

```
<p> 粉丝数 </p>
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T17:19:26.700

如果您只想使用纯 javascript，那么您可以使用

```
<script>
    function showCount(count){
        if(count)
            document.getElementById('fb_fan_count').innerHTML = 'Total fans : ' + count[0].fan_count;
    }
</script>
<p id="fb_fan_count"></p>
<script type="text/javascript" src="https://api.facebook.com/method/fql.query?format=json&callback=showCount&query=select+fan_count+from+page+where+page_id%3D80177638103"></script> 
```

[**演示**](http://jsfiddle.net/7NMnJ/12/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:13:33.553

尚未对此进行测试，但类似这样的东西应该可以解决问题。您可能只需将 替换为`results.fan_count`Facebook 输出的正确对象名称。

```
$.getJSON('https://api.facebook.com/method/fql.query?format=json&query=select+fan_count+from+page+where+page_id%3D80177638103', function( results ) {
    $('body').html(
        $.map( results.fan_count, function( obj, index ) {
            return '<p>' + obj.text + '</p>'
        }).join('')
    );
}); 
```

# iphone - 如何在两个方括号Objective C之间提取字符串

> ID：14983638
> 
> 赞同：0
> 
> 时间：2013-02-20T15:28:39.453
> 
> 标签：iphone, ios, objective-c

我有这样的字符串：

```
jsonArray:
{
d = "[{\"Training_Code\":\"1234      \",\"Training_Duration\":\"2hrs      \",\"Training_Startdate\":\"14/02/2013 15:00:00\",\"Training_Enddate\":\"14/02/2013 17:00:00\",\"Trainer_ID\":1,\"Training_Location\":\"B-Wing Training room-4\",\"Comments\":\"C# training\",\"Keyword\":\"C#1234\",\"NumberofDays\":1},{\"Training_Code\":\"4321      \",\"Training_Duration\":\"16        \",\"Training_Startdate\":\"17/02/2013 10:30:00\",\"Training_Enddate\":\"17/02/2013 17:30:00\",\"Trainer_ID\":2,\"Training_Location\":\"A-Wing Training Room-6\",\"Comments\":\"Objective-C\",\"Keyword\":\"Obj-C4321\",\"NumberofDays\":2}]";
} 
```

我想获取两个方括号（包括方括号）之间的数据，然后删除所有“\”以获得我的最终字符串，如下所示：

```
[
{
"Training_Code": "1234",
"Training_Duration": "2hrs",
"Training_Startdate": "14/02/201315: 00: 00",
"Training_Enddate": "14/02/201317: 00: 00",
"Trainer_ID": 1,
"Training_Location": "B-WingTrainingroom-4",
"Comments": "C#training",
"Keyword": "C#1234",
"NumberofDays": 1
},
{
"Training_Code": "4321",
"Training_Duration": "16",
"Training_Startdate": "17/02/201310: 30: 00",
"Training_Enddate": "17/02/201317: 30: 00",
"Trainer_ID": 2,
"Training_Location": "A-WingTrainingRoom-6",
"Comments": "Objective-C",
"Keyword": "Obj-C4321",
"NumberofDays": 2
}
] 
```

我怎样才能在objective-c中做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:37:39.053

尝试使用`JSONKit`( [ref](https://github.com/johnezang/JSONKit) ) 或`NSJSONSerialization`( [ref](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html) )，它们会给出一个`NSArray`or `NSDictionary`，具体取决于 JSON 字符串的结构。

* * *

**更新**：

`d`看起来像一个格式良好的 JSON 字符串，但它来自哪里？它是`char[]`（如上面的评论中所述）`NSString`、还是控制台输出？

从这里可以看出，您的第一个代码清单是打印到控制台的内容。将 JSON 字符串打印到控制台通常会打印转义字符 ( `\`)。在您的另一篇文章中，您假设每个响应都可以解析为一个数组。将返回的对象存储到`id`first 中会更安全，然后检查其类：

```
id rawData = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers|NSJSONReadingAllowFragments error:&jsonParsingError

if ( jsonParsingError != nil ) {
    // investigate the parsing error
}
else if ( [rawData isKindOfClass[NSDictionary class]] ) {
    NSDictionary *dict = rawData;
    //  process dictionary
}
else if ( [rawData isKindOfClass[NSArray class]] ) {
    NSArray *array = rawData;
    // process array
}
else {
    // some thing went completely wrong
} 
```

您也没有表示您正在检查任何可能的错误。检查`jsonParsingError`可能会提供有关正在发生的事情的线索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T16:34:09.777

1.  使用 nsstring 方法`dataUsingEncoding`获取 nsdata 实例。
2.  利用`NSJSONSerialization`

您想要的字符串与您提供的字符串相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T17:38:31.587

仅当源字符串各包含一个 [ 和 ] 时，才...

1.  使用 componentsSeparatedByString 将源字符串与 [.
2.  使用 componentsSeparatedByString 将上面的结果 (objectAtIndex:0) 与 ] 分开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T16:27:24.167

由于 d 是一个字符串：

要删除 "\" ，您可以这样做：

```
NSString *newString = [myString stringByReplacingOccurrencesOfString:@"\" withString:@""]; 
```

由于方括号在前面和最后，也许你可以这样做：

```
[newString removeObjectAtIndex:0];
[newString removeObjectAtIndex:[newString count]-1]; 
```

第一步是根据您的情况获取该字符串并将 myString 替换为您的字符串。

# c# - DateTimePicker 从年份开始

> ID：14983649
> 
> 赞同：0
> 
> 时间：2013-02-20T15:29:08.193
> 
> 标签：c#, drop-down-menu, datetimepicker

这里有几个关于格式化 C# DateTimePickers 的 QA，但似乎没有一个解决这个方面：

默认行为是，当用户单击 DateTimePicker 下拉列表时，他从一个月视图开始，顶部有一个滚动条，一次翻一页。

从 UI 中，您可以升级到年级，但我的操作员不是本地的或直观的控制使用。我要求用户输入跨越 10 年的数据（某些产品的制造日期）。我想从年级开始，以便更快/更容易地在正确的任意位置附近开始。

我可以让日历下拉自动从年份级别开始并向下钻取吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T09:47:19.920

如果您使用的是 WPF，那么我认为您指的是 DatePicker 控件。

在您的 XAML 中：

```
<DatePicker CalendarOpened="DatePicker_CalendarOpened" /> 
```

然后在后面的代码中

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Controls.Primitives;

private void DatePicker_CalendarOpened(object sender, RoutedEventArgs e)
{
    DatePicker datepicker = (DatePicker)sender;
    Popup popup = (Popup)datepicker.Template.FindName("PART_Popup", datepicker);
    Calendar cal = (Calendar)popup.Child;
    cal.DisplayMode = CalendarMode.Year;
} 
```

# html - 中间底部文本的页脚

> ID：14983651
> 
> 赞同：0
> 
> 时间：2013-02-20T15:29:10.033
> 
> 标签：html, css, footer

无论内容中有多少文字，我都试图将页脚保持在底部。我究竟做错了什么？布局是：

```
 .top{
    width:500px;
    height:100px;
    background-color:black;
}

.content{
    width:500px;
    min-height:100%;
    position:relative;
}

.footer{
    width:500px;
    height:100px;
    background-color:blue;
    position:absolute;
    bottom:0;
}

<div class="top"></div>
<div class="content"></div>
<div class="footer"></div> 
```

[http://jsfiddle.net/RDuWn/68/](http://jsfiddle.net/RDuWn/68/)

问候，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:31:58.783

我认为您必须像这样使用 position:fixed ：

```
.footer{
    width:500px;
    height:100px;
    background-color:blue;
    position:fixed
    bottom:0;
} 
```

[演示](http://jsfiddle.net/RDuWn/70/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:11:02.037

是你的绝对定位导致了重叠。绝对元素从正常流程中移除，并在确定位置时被其他元素本身“忽略”。如果您未在 css 中指定位置，则默认为静态定位，并且所有元素都将正确位于“流”中。

[http://www.w3schools.com/css/css_positioning.asp](http://www.w3schools.com/css/css_positioning.asp)

这是我使用的 CSS：

```
.top{
    width:500px;
    height:100px;
    background-color:pink;
}

.content{
    width:500px;
    min-height:100%;
    background-color:blue;
}

.footer{
    width:500px;
    height:100px;
    background-color:black;
    margin-bottom:0px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:34:36.803

您的代码有效，但您需要在页脚类中设置最小高度而不是高度，以便它可以拉伸到您的内容大小。

```
.footer{
    width:500px;
    min-height:100px;
    background-color:blue;
    position:fixed;
    bottom:-1px;
} 
```

[这](http://jsfiddle.net/RDuWn/73/)是更改后的外观，以及添加到页脚的一些占位符内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:32:17.723

我会`position:absolute; bottom:0;`从`.footer` [小提琴中删除](http://jsfiddle.net/RDuWn/69/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T15:32:54.683

在你的[jsfiddle](http://jsfiddle.net/RDuWn/68/)中，

```
.footer{
    width:500px;
    height:100px;
    background-color:blue;
    position:fixed;
    bottom:-1px;
} 
```

为我工作..

看[小提琴](http://jsfiddle.net/RDuWn/71/)

看到`bottom:-1px;`它将确保您在浏览器中的位置...

# c# - 如果数字是正数或负数，DataGridCell 会发生变化

> ID：14983653
> 
> 赞同：0
> 
> 时间：2013-02-20T15:29:17.280
> 
> 标签：c#, wpf, xaml

我有一个 DataGridTextColumn，它接受来自名为 Numbers 的数据库表中的数字。如果单元格中的数字是正数，我希望下一个 DataGridTextColumn 里面有“Positive”这个词。我尝试使用 IConverter Styles 但仍然不知道如何正确操作。我希望有人可以帮助我。

到目前为止，这是我的代码：

```
<DataGrid Grid.Row="0" Grid.Column="1" AutoGenerateColumns="False" IsReadOnly="false" CanUserAddRows="True" Margin="5,5,10,5" ItemsSource="{Binding ElementName=Numbers}">

        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding Num}" Header="Number" FontSize="16"/>

            <DataGridTextColumn Header="Positive/Negative" FontSize="16">

                <DataGridTextColumn.ElementStyle>
                    <Style TargetType="{x:Type TextBlock}">
                        <Setter Property="Text" Value="{Binding Amount, Converter={StaticResource PositiveNegativeConverter}}"/>
                    </Style>
                </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>
    </DataGrid> 
```

我在资源里面也有这个：

```
 <local:PositiveNegativeConverter x:Key="PositiveNegativeConverter"/>
</UserControl.Resources> 
```

我的转换器如下所示：

```
class PositiveNegativeConverter : IValueConverter
{
  public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        bool revert = (parameter as string).StartsWith("-");

        string stringValue = value as string;
        string compareValue = parameter as string;

        if (revert)
        {
            return "Negative";
        }
        else
            return "Positive";
    }
    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:32:29.053

您不必为此添加样式，只需将转换器添加到 DataGridTextColumn 中的绑定即可。

像这样的东西：

```
<DataGridTextColumn Binding="{Binding Num, Converter={StaticResource PositiveNegativeConverter}}" Header="Number" FontSize="16"/> 
```

# c++ - 使用字符串类型的解引用向量迭代器作为函数参数

> ID：14983657
> 
> 赞同：0
> 
> 时间：2013-02-20T15:29:34.130
> 
> 标签：c++, string, vector, iterator, dereference

我正在迭代一个向量

```
std::vector<std::string>::reverse_iterator ritr; 
```

我需要在某个时候确定此向量中的字符串是否是使用该函数的运算符

```
bool IsOperator(const std::string s); 
```

当我按照以下方式调用函数时，

```
if(IsOperator(*ritr)) 
```

日食抱怨！

`Candidates are: bool IsOperator(char) bool IsOperator(std::basic_string<char,std::char_traits<char>,std::allocator<char>>)`

（我有一个用 accept`char`代替的重载函数`std::string`）但是，它允许将 deferenced 迭代器存储在字符串中的操作

```
std::string str= *ritr; 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:50:13.303

你的代码很好。`isOperator(char)`消除和之间的歧义`isOperator(string)`不是问题，因为 a`string`不能隐式转换为 a `char`。

我希望您的程序能够编译（如果没有，那么您没有显示其他内容），而 IDE 用红色曲线抱怨只是意味着您的 IDE 有错误。

* * *

另外，几点说明：

> 我有一个类型的功能`std::vector<std::string>`

函数不能没有类型`std::vector<std::string>`。它可以*返回*一个 type 的值`std::vector<std::string>`，也可以接受一个。我猜你说的是后者。

> `bool IsOperator(const std::string s)`

这个函数签名没有多大意义。您可能意味着接受对对象的常量*引用*`std::string`：

```
bool IsOperator(std::string const& s) 
```

# sql - 如果以前的值为 Null，则更新列

> ID：14983659
> 
> 赞同：1
> 
> 时间：2013-02-20T15:29:38.770
> 
> 标签：sql, loops, null, db2, sql-update

我正在使用 DB2 SQL。我有一个表名ITEMATRIX，它看起来像 -

```
ITNBR   LBRCST  MFGOH   STDUC   YRMNT
RM-013         0    0   499.6   2010-02
H-178          0    0   164.5   2010-02
FP9-003        0    0   6       2010-02
FP9-059        0    0   2       2010-02
A94-103B-M     0    0   0       2010-02
140-07-1012C   0    0   10      2010-05
140-07-1012C   0    0   0       2010-06 
```

然后

```
 ITNBR  LBRCST  MFGOH   STDUC   YRMNT
 140-07-1012C   0   0   10      2010-05
 140-07-1012C   0   0   **10**      2010-06 
```

等等等等……

`STDUC`如果值为 0 或 Null，我想将字段更新为最近月份的值。假设 for`ItNBR` `140-07-1012C`是for ，`STDUC`那么首先我必须找出该项目编号在 2010 年是否有任何月份的标准成本，如果是，则复制上个月的值。有许多具有相同项目编号的记录，我稍后将对其进行转置。谁能给我一些关于如何解决这个问题的想法？`0``2010-05``2010-04`

谢谢瓦伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:37:42.817

我认为他遵循的是您想要的逻辑：

```
update itematrix
    set stduc = (select stduc
                 from itematrix im2
                 where im2.stduc <> 0 and im2.stduc is not null and im2.itnbr = itematrix.itnbr
                 order by yrmnt desc
                 fetch first 1 row only
                )
    where stduc is null or stduc = 0 
```

我还没有在 DB2 中测试过这个。`fetch first`在与更新中使用的表相同的表上使用可能会出现问题。我发现[文档](http://pic.dhe.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=/com.ibm.db2z10.doc.sqlref/src/tpc/db2z_sql_fetchfirstclause.htm)模棱两可。

如果您不需要实际更新，而只想查看值，请尝试：

```
select itemmatrix.*,
       (select stduc
        from itematrix im2
        where im2.stduc <> 0 and im2.stduc is not null and im2.itnbr = itematrix.itnbr
        order by yrmnt desc
        fetch first 1 row only
       )
from itemmatrix 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:08:05.227

如果使用 DB2 9.7，您可以使用 LAG() 函数：[https ://www.ibm.com/developerworks/mydeveloperworks/blogs/dbtrue/entry/lag_lead_first_value_last_value_totally_new_in_db21?lang=en](https://www.ibm.com/developerworks/mydeveloperworks/blogs/dbtrue/entry/lag_lead_first_value_last_value_totally_new_in_db21?lang=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T13:34:48.187

我将流程转移到 EXCEL 并且可以轻松地使用`IF`和`VLOOKUP`从最早的月份开始使用单个成本值，然后简单地比较上个月的值并相应地更改，然后`UPDATE`使用创建语句`&`。我将流程转移到 EXCEL 并且可以做到轻松使用`IF`，`VLOOKUP`然后`UPDATE`使用`&`.

# c# - 向外传递数据

> ID：14983665
> 
> 赞同：0
> 
> 时间：2013-02-20T15:29:48.960
> 
> 标签：c#, .net, foreach, web-controls

我目前对 foreach 循环有点噩梦。简而言之，我要做的是拆分一个字符串，然后根据该字符串过滤此数据。然后，我需要将所述数据绑定到进一步过滤它的控件。到目前为止，我有以下代码

```
 if (Session["Contract"] != null)
        {
            string[] contract = Session["Contract"].ToString().Split(',');
            foreach (string i in contract)
            {
                if (i.ToString() != "")
                {
                  data = data.Where(x => x.Term.Trim().ToUpper().Contains(i.ToString().Trim().ToUpper()));
                }
            }
        }

        LV_Jobs.DataSource = data;
        LV_Jobs.DataBind(); 
```

现在循环时，过滤工作正常，但是一旦你完成了一项，数据变量就被清除了？显然，我需要将“数据”从 foreach 循环中传回。谁能指出我如何做到这一点的方向？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:31:40.943

只需在结果列表或在 for/foreach 范围之外声明的任何其他数据结构中收集所需的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:32:45.853

您的`data`变量未清除。相反，在`foreach`where `i.ToString() != ""`your `Where()`condition is *not true*的最后一次迭代中。所以`data`变成了一个空列表。

当你找到你要找的东西时，你就可以`break`离开了。`foreach`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:45:37.560

`data`每次循环迭代时您都在重置。试试这个（取决于是什么`data`）

```
 var filteredData = new List<string>();
        if (Session["Contract"] != null)
        {
            filteredData = Session["Contract"].ToString().Split(',').Join(
                                data, 
                               i => i.ToString().Trim().ToUpper(), 
                               x => x.Term.Trim().ToUpper(),
                               (i, x) => x);
        }

        LV_Jobs.DataSource = filteredData;
        LV_Jobs.DataBind(); 
```

# ios - 如何判断指针指向的值何时为nil

> ID：14983670
> 
> 赞同：2
> 
> 时间：2013-02-20T15:30:03.937
> 
> 标签：ios, objective-c, cocoa-touch, pointers, cocos2d-iphone

我有一种情况，部队可以攻击建筑物。每个部队都有一个指向其目标的指针。

```
@property (nonatomic, weak) Building *target; 
```

在更新循环中，部队会定期对其目标造成伤害。

```
if (_target)  
{
    if (/*enough time has passed since last attack, attack again*/)
    {
        [_target attack];
        if (_target.health <= 0)
        {
            [_target removeFromParentAndCleanup:YES];   //Cocos2d
            _target = nil;
        }
    }
}
else /* Find new target */ 
```

* * *

问题是：

*   `troop1`处理掉下`building1`来并继续前进的打击`building2`
*   `troop2`正在攻击`building1`，但要等到它的下一次攻击才能确定`building1`是现在`nil`。

我意识到问题在于`troop2`' 的**指针**尚未设置为 nil，而是我应该检查**指针的值**是否为 nil。

我尝试使用`if (*_target)`但收到消息

> 语句需要标量类型的表达式

如果有办法在 Objective-C 中实现这种比较？还有哪些其他选项可用于确定值何时发生变化？KVO？一些广泛的委托模式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T16:08:02.420

当指针指向的对象被释放时，指针本身被设置为 nil。`if (objectPointer == nil)`始终是在 Objective-C/Cocoa 中检查对象是否为 nil 的方法。如果指针不为零，则表示该对象实际上并未被释放。如果取消引用指向对象的指针，则会得到一个结构，因此会出现编译器错误，即 if 表达式中需要一个标量值。

因此，在您的情况下，如果`if(self.target != nil)`没有给您期望的结果，您应该寻找对目标的剩余强引用（来自其他对象）。

更广泛地说，正如 trojanfoe 的回答所暗示的那样，您依赖 ARC 对真实程序逻辑的归零弱引用行为。理论上这是可以的，因为（与他最初的陈述相反），ARC 的归零弱行为是可靠的/确定的。但是，这确实意味着您必须确保当目标不再处于竞争环境（或其他任何情况）时，它们*总是被解除分配。*这有点脆弱。清零弱引用旨在避免保留循环（本质上是一种内存泄漏形式），而不是按照您正在做的方式实现逻辑的一种方式。trojanfoe 解决方案的要点，您可以根据需要显式注册和取消注册目标，这可能是一个更强大的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:44:17.863

我可能在这里忽略了一些东西，但是要检查`target2`属性是否为`nil`，只需执行以下操作：

```
if ( self.target2 == nil ) {
     // Something
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:55:05.080

我认为您过于依赖 ARC 的实现，因为您只知道如果指针是`nil`. 这是不可移植的~~，您可以在被释放的对象和指针变为 之间做出任何保证`nil`吗？~~

相反，使用对象的中央字典，映射到它们的唯一 ID 并只存储这个唯一 ID 而不是对象指针本身。在此示例中，我使用`NSNumber`递增整数作为键，但可能有更好的键可以使用。也是`Object`您要存储在此字典中的任何对象的基类：

```
// Probably ivars in a singleton class
unsigned _uniqueId = 1;
NSMutableDictionary *_objects;

- (NSNumber *)addObject:(Object *)object
{
    NSNumber *key = [NSNumber numberWithUnsignedInt:_uniqueId++];
    [_objects setObject:object forKey:key];
    return key;
}

- (void)removeObjectForKey:(NSNumber *)key
{
    [_objects removeObjectForKey:key];
}

- (Object *)getObjectForKey:(NSNumber *)key
{
    return [_objects objectForKey:key];
} 
```

在您的目标中，只需存储构建密钥：

```
@property (strong) NSNumber *buildingKey; 
```

并通过提供的方法获取建筑物：

```
Building *building = (Building *)[objectDictionary objectForKey:buildingKey];
if (building != nil)
{
    // building exists
}
else
{
    // building does not exist; throw away the key
    buildingKey = nil;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T16:09:17.853

由于目标是弱引用，因此您的代码应该“按原样”工作，假设`[_target removeFromParentAndCleanup:YES];`删除了对目标的所有强引用。

当最后一个强引用被移除时，所有指向它的弱属性都会自动设置为`nil`. 如果它们没有自动设置为`nil`，那么在某处仍然存在对目标的强引用。

查找并删除该引用，这将正常工作。

# c++ - exit(3) 在 Linux C++ 中挂起

> ID：14983672
> 
> 赞同：2
> 
> 时间：2013-02-20T15:30:06.540
> 
> 标签：c++, gcc, arm, exit, cross-compiling

我有一个小型 C++ 程序，它可以 ping 网络上的其他机器并通过另一个网络发送状态信息。该程序作为守护进程运行，因此启动进程派生出一个子进程，然后调用`exit`. 该程序经过交叉编译，可在两种不同的架构上运行：x86 和 ARM。GCC 版本分别为 4.4 和 3.5。我可以在 x86 上编译和运行该程序，它可以完美运行。但是，当我在 ARM 上运行程序时，它会在我调用的任何时候挂起`exit`，而不仅仅是在`fork`. 我没有使用`atexit`or注册的函数`on_exit`。以下是我的包括：

```
#include <cstdio>
#include <cstdlib>
#include <cstring>

#include <iostream>
#include <sstream>
#include <string>
#include <set>
#include <vector>

#include <boost/bind.hpp>
#include <boost/asio.hpp>
#include <boost/thread.hpp>
#include "telnet_client.h"

#include <stdint.h>

#include <sys/types.h>
#include <sys/socket.h>
#include <sys/select.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <sys/time.h>
#include <netdb.h>
#include <net/if.h>
#include <sys/ioctl.h>
#include <unistd.h>
#include <syslog.h>
#include <customlib1.h>
#include <customlib2.h> 
```

以下是我的 GCC 命令：

```
arm-none-linux-gnueabi-g++ -Wall -DBUILDSTAMP="\"`date '+%F %T'`\"" -g -ggdb -O0 -I/usr/local/arm/arm-2007q1/arm-none-linux-gnueabi/libc/usr/include -DEMBEST_ARM -I/usr/local/share/arm/boost/src -I../include/ -I../include_rms -c can_wifid.cpp -o can_wifid.o
arm-none-linux-gnueabi-g++ -Wall -DBUILDSTAMP="\"`date '+%F %T'`\"" -g -ggdb -O0 -I/usr/local/arm/arm-2007q1/arm-none-linux-gnueabi/libc/usr/include -DEMBEST_ARM -I/usr/local/share/arm/boost/src -I../include/ -I../include_rms -c telnet_client.cpp -o telnet_client.o
arm-none-linux-gnueabi-g++ -Wall -DBUILDSTAMP="\"`date '+%F %T'`\"" -g -ggdb -O0 -I/usr/local/arm/arm-2007q1/arm-none-linux-gnueabi/libc/usr/include -DEMBEST_ARM -I/usr/local/share/arm/boost/src can_wifid.o telnet_client.o -L/usr/local/arm/arm-2007q1/arm-none-linux-gnueabi/libc/usr/lib  -L../lib_embest_arm -L../lib_rms_embest_arm -Wl,-Bdynamic -lutilities -lboost_system -lboost_thread -lcanprovider -lembestcan -o can_wifid 
```

即使只是解析我的命令行参数，`getopt`然后在版本消息之后调用也会`exit`导致这个问题（我的程序中最简单的情况）。有没有人经历过这样的事情`exit`？

编辑：为主要功能的第一部分添加了代码：

```
struct canwifid_options
{
public:
bool daemon_mode;
int verbosity;

canwifid_options()
{
    this->daemon_mode = false;
    this->verbosity = LOG_NOTICE;
}
};

static canwifid_options options;

int main(int argc, char * argv[])
{
int LoggingOptions = LOG_CONS|LOG_NDELAY|LOG_PID;
pid_t Pid;

ParseCommandLine(argc, argv);

if (!options.daemon_mode)
{
    LoggingOptions |= LOG_PERROR;
}

openlog("can_wifid", LoggingOptions, LOG_USER);

setlogmask(LOG_UPTO(options.verbosity));

if (options.daemon_mode)
{
    Pid = fork();

    if (Pid < 0)
    {
        // couldn't fork off and create a child process
        // log it, %m is a special syslog flag
        syslog(LOG_CRIT, "Unable to create daemon [Error: %m]");
        exit(ESRCH);
    }
    else if (Pid > 0)
    {
        // we're the parent, so we're done and out of here
        exit(EXIT_SUCCESS);
    }
    else
    {
        // we're the child, take control of the session.
        setsid();

        // change to the root directory so we don't retain unnecessary control
        // of any mounted volumes
        chdir("/");

        // clear our file mode creation mask
        umask(0000);
    }
}
else
{
    // get our process ID
    Pid = getpid();
}

syslog(LOG_INFO, "Running as %s", options.daemon_mode ? "daemon" : "standalone");

    // Network code here, snipped for clarity
} 
```

还有 ParseCommandLine 函数：

```
static void ParseCommandLine(int argc, char *argv[])
{
int c;

while ((c = getopt(argc, argv, "dhqvDV?")) > 0)
{
    switch (c)
    {
        case 'd':
            options.daemon_mode = true;
            break;
        case 'V':
            VersionMessage(argv);
            exit(EXIT_SUCCESS);
            break;
        case 'q':
            options.verbosity = LOG_WARNING;
            break;
        case 'v':
            options.verbosity = LOG_INFO;
            break;
        case 'D':
            options.verbosity = LOG_DEBUG;
            break;
        case 'h':
        case '?':
        default:
            HelpMessage(argv);
            exit(EXIT_SUCCESS);
            break;
    }
}

return; //done
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:16:58.023

我曾经遇到的一个问题是调用`exit`尝试退出并调用全局析构函数而不尝试展开堆栈或为堆栈上的本地对象调用任何析构函数。如果您有全局析构函数可能需要的任何类型的锁，这很容易体现出来。例如，这个程序在退出时死锁（实际上是在全局 dtor 中）：

```
#include <iostream>
#include <mutex>

std::mutex  lock;

class A {
public:
    A() {
        std::lock_guard<std::mutex> acquire(lock);
        std::cout << "ctor A" << std::endl;
    }
    ~A() {
        std::lock_guard<std::mutex> acquire(lock);
        std::cout << "dtor A" << std::endl;
    }
};

A a;

int main()
{
    std::lock_guard<std::mutex> acquire(lock);
    exit(0);
} 
```

现在你的问题可能是完全不同的东西，但很有可能它与全局析构函数中的某些东西有关，因为堆栈上的某些对象没有被正确销毁。

如果您想在正确展开堆栈时退出（这是 RAII 结构化代码所必需的），则不能调用 exit。相反，您需要抛出一个异常，该异常（仅）在 main 中捕获并导致 main 返回。

# java - 我应该使用 XSLT 还是 Java 来转换我的 XML 文档？

> ID：14983674
> 
> 赞同：2
> 
> 时间：2013-02-20T15:30:12.300
> 
> 标签：java, xml, xslt

我必须将一堆 XML 文档转换为另一种格式。

据我所知，我可以使用 XSLT 或 Java 以及 XML 读取器/写入器。根据过去的经验，我记得 XSLT 是一场缓慢而艰难的斗争。

关于我是否会更好地使用 XSLT 与 Java + XML 阅读器/编写器来制作这些新的 XML 文件有什么建议吗？

转变的速度对我来说并不重要。对于我需要处理的 20 个 xml 文件中的每一个，此过程将发生一次。我不必一直这样做——换句话说，这个过程是一次性的。

输出 XML 将是类似的简单 XML。没有炫耀。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:41:44.270

对于一个一次性的过程，你只需要做一次然后扔掉，然后使用你喜欢的任何东西并拥有工具。如果您有更多使用 Java 的经验/工具，那就去吧。

更一般地说，我的经验是在大型项目上，我们几乎总是最终求助于 java（即使我们开始使用 xslt 开发）——在更大、正在进行的项目中，需求经常增长并变得更加复杂，并且通常发现 xslt 转换为大型具有多个嵌套级别（带有列表节点）的复杂文档难以理解/测试。再加上不可避免的需要额外的逻辑/条件转换/数据库查找等总是在某个地方突然出现。

最后，按照你所知道的去做！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:41:18.387

我建议您**使用您最熟悉的技术**。你不应该为此付出太多努力，因为它不是一个关键项目——在这种情况下，即使速度也不重要。

你有一些选择：

*   XSLT
*   Java SAX解析器
*   Java DOMParser + 迭代
*   Java StAX

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:44:33.057

我不得不使用 XSLT，但最终的决定将取决于你有哪些可用的工具。

您可能相当简单，使用诸如 Dozer 和/或 Castor-XML 之类的东西用 Java 编写它，如果您只有一个 Java IDE，这将是一件好事。

如果您有一个好的 XSLT 工具（如 XMLSpy），那么 XSLT 将是您的最佳选择。

是的。根据您拥有的工具，任何一个都可以在几个小时内完成（如果您需要首先学习框架，在 Java 中可能会稍微多一点）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T15:47:50.723

这个问题没有足够的信息来得出结论性的答案，所以这里有一些可能的指针。

如果工作只是将 XML 转换为另一种形式的 XML，并且所有必需的数据都在原始 XML 中可用，那么 XSLT 可能是最合适的。毕竟，这就是 XSLT 的全部目的。

如果您从未使用过 XSLT，不想学习或没有时间学习，并且在 Java 方面非常胜任，那么 Java 很可能是使用的工具。使用您已经熟悉的工具会更快。

如果转换需要从其他来源（例如数据库）获取数据，或者进行一些复杂的计算，那么您可能必须使用 Java。

如果两种格式的形状差异很大，那么 XSLT 可能是一种更清晰、更容易执行转换的方法。

如果差异很小，并且您有很多文档要转换，那么在 Java 中使用 DOM 可能会明显提高性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T15:35:40.157

Java 是一门强大的语言，将为数以千计的可用 API 资源/文档提供强大的支持。所以如果我是你，我肯定会选择 Java。

# python - 使用python，numpy进行圆形检测？

> ID：14983675
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:30:11.897
> 
> 标签：python, numpy, scipy, hough-transform

1.  我想使用 python 实现霍夫变换算法，`numpy`并且`scipy`.

2.  我不想使用`opencv`.

3.  我正在尝试检测没有​​已知半径的图像中的圆心或圆心。

我该如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-11T21:31:55.297

实现霍夫变换的过程非常简单。我建议您在 youtube 上查看一些有关它的视频，甚至还有带有代码/伪代码的视频。

话虽如此，我一直处于同样的情况，希望实现 HT 来检测圆圈。但是，我决定使用的方法与传统的 HT 有点不同。我没有循环遍历所有像素以生成在至少一个圆点上传递的圆，而是使用圆点作为中心，将半径从 min_radius 增加到 max_radius 并以与经典 HT 相同的形式累积它。

这样，您最终将拥有一个带有（x、y 和半径）的 3D 数组。中心和半径将是具有最大累积值的 (x, y, radius)。

[简化霍夫变换](http://i.stack.imgur.com/nyHqe.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:51:38.903

我用谷歌搜索了一下，我发现了以下内容：

[http://nabinsharma.wordpress.com/2012/12/26/linear-hough-transform-using-python/](http://nabinsharma.wordpress.com/2012/12/26/linear-hough-transform-using-python/)

也许这就是您正在搜索的内容。

抱歉，我认为对于圈子，您应该尝试以下操作：

[http://nullege.com/codes/search/houghcircles](http://nullege.com/codes/search/houghcircles)

# c++ - C++十进制检查是否语句错误？

> ID：14983679
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:30:30.573
> 
> 标签：c++, if-statement, casting

我正在为 C++ 课程做一些功课，而且我对 C++ 还是很陌生。我的 if 语句遇到了一些问题……我在做什么，是让用户输入一个时间，介于 0.00 和 23.59 之间。: 被替换为句号。那部分有效。然后我将小时和分钟分开，并检查它们以确保它们处于有效的约束中。检查小时有效，但不是一分钟......这是我的代码：

```
minute= startTime - static_cast<int>(startTime);
hour= static_cast<int>(startTime);

//check validity
if (minute > 0.59) {
    cout << "ERROR! ENTERED INVALID TIME! SHUTTING DOWN..." << endl;;
    return(0);
}
if (hour > 23) {
    cout << "ERROR! ENTERED INVALID TIME! SHUTTING DOWN..." << endl;;
    return(0);
} 
```

同样，如果我输入 23，小时有效，但如果我输入 23.59，我会收到错误，但如果我输入 23.01，我不会。另外，如果我输入 0.59 它也会给出错误，但不是 0.58。我尝试切换`if(minute > 0.59)`到`if(minute > 0.6)`但由于某种原因导致其他地方出现问题。我完全不知道该怎么做，所以任何帮助都会很棒！太感谢了！

**编辑：**我刚输入 0.58，它没有给我错误...但是如果我将其设为 1.59，它会再次出现错误...此外，赞成票会很好：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:36:38.263

浮点运算 (`float`和`double`) 本质上是模糊的。小数点后面总有一些数字是您在发送到流的舍入表示中看不到的，并且比较也可能是模糊的，因为您习惯的表示（十进制）不是计算机使用的表示（二进制）。

将时间表示为`int hours`和`int minutes`，您的问题就会消失。大多数库以刻度（通常是秒或微秒）为单位测量时间，并且不提供子刻度分辨率。你很好地模仿他们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:37:17.823

浮点数的比较很容易失败，因为它们中很少有人可以精确地以 2 为基数表示。两个不同的数字总是有可能在不同的方向上四舍五入。

最简单的解决方法是在您要比较的数字上添加一个非常小的软糖因子：

```
if (minute > 0.59 + epsilon) 
```

看看[每个计算机科学家应该知道的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:43:03.603

永远不要使用 double（或 float）来存储两个整数值，并使用整数和小数部分作为分隔符。十进制数据类型不够精确，因此您可能会得到错误的结果（如果是一轮）。

在您的情况下，一个好的解决方案是使用一个结构（或一对）甚至一个整数。

使用整数，您可以使用 mod 或 div 的倍数来提取实际值。例子：

```
int startTime = 2359;
int hour = startTime / 100;
int minute = startTime % 100; 
```

虽然，使用 struct 代码看起来更简单，更容易理解（和维护）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:45:38.047

你无法准确地比较`0.59`；该值无法在机器中表示。您正在将非常接近的东西与非常接近`0.59`的东西进行比较`0.59`。

就个人而言，我根本不会以这种方式输入时间。一个更好的解决方案是学习如何使用`std::istream`来读取值。但是如果你坚持，并且你有`startTime`你的`double`，你需要将它乘以`100.0`（这样你感兴趣的所有值都是整数，并且可以精确表示），然后将它四舍五入，然后将其转换为整数，然后使用*整数上*的模和除法运算符来提取您的值。类似于以下内容：

```
assert( startTime >= 0.0 && startTime <= 24.0 );
int tmpTime = 100.0 * startTime + 0.5;
int minute = tmpTime % 100;
int hour = tmpTime / 100; 
```

在处理整数值时，使用整数类型要简单得多。

# .htaccess - 所有子文件夹的 htaccess seo 友好 URL

> ID：14983684
> 
> 赞同：1
> 
> 时间：2013-02-20T15:30:40.740
> 
> 标签：.htaccess

我在所有文件夹的 index.php 中有脚本

需要像这样制作漂亮的 url/seo 友好的 url：site.com/folder1/`something.html`

现在我有这样丑陋的网址：site.com/folder1/`index.php?category=something`

这部分`index.php?category=something`在所有子文件夹中总是相同的，我只是想把它改成对 seo 更友好`something.html`

再一次：找到`index.php?category=1$`并替换它，`1$.html` 不要触摸其他任何东西，只是这部分 url

所以当我访问时：

```
site.com/another-subfolder/and-one-more-folder-here/index.php?category=something 
```

需要在地址栏中看到这个：

```
site.com/another-subfolder/and-one-more-folder-here/something.html 
```

我希望你明白吗？

`folder1`我在root的htaccess中试过这个

```
RewriteRule ^folder1/(.*).html$ folder1/index.php?category=$1 [L,R=301] 
```

好的，这可行，但是我怎样才能使它适用于整个站点的所有子文件夹，如下所示：

```
site.com/folder145/index.php?category=something
site.com/subfolder/index.php?category=something
site.com/another-subfolder/and-one-more-folder-here/index.php?category=something 
```

将有 1000 个具有不同名称的子文件夹，因此手动为每个子文件夹创建 RewriteRule 将不起作用

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:28:04.723

首先，您需要将生成的所有链接从`index.php?category=`表单更改为`category.html`表单。

然后在文档根目录的 htaccess 文件中，添加这些规则以在内部将`category.html`表单重写回`index.php?category=`表单：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+?/)?([^/]+)\.html$ /$1index.php?category=$2 [L] 
```

然后，指向您无法控制的链接（或使用 FORM 生成的链接）从外部重定向对`index.php?category=`表单中链接的任何直接访问：

```
RewriteCond %{THE_REQUEST} ^(GET|HEAD)\ (/.*?)?/index\.php\?category=([^&\ ]+)
RewriteRule ^(.+?/)?index\.php$ /$1%3.html? [L,R=301] 
```

这应该匹配任何和每个子目录。

# jquery - 在 Jquery AJAX 中使用自动图像蒙太奇

> ID：14983688
> 
> 赞同：0
> 
> 时间：2013-02-20T15:30:44.247
> 
> 标签：jquery, ajax, montage

我正在使用此处找到的自动图像蒙太奇插件：

[http://tympanus.net/Development/AutomaticImageMontage/index4.html](http://tympanus.net/Development/AutomaticImageMontage/index4.html)

我正在使用 Jquery 在单击按钮时调用我的其他图像。

```
<div id="montage_overlay" class="paddingspacer2">
                <div class="am-container" id="am-container">

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_181.jpg" rel="galleryfacebox" title="'92 Bison Alumni"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_181.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_183.jpg" rel="galleryfacebox" title="Bison Alumni Honored"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_183.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_185.jpg" rel="galleryfacebox" title="Yuker at Bubba's"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_185.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_186.jpg" rel="galleryfacebox" title="Home Team for 3"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_186.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_188.jpg" rel="galleryfacebox" title="...the crowd gets the skinny on W&J"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_188.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_189.jpg" rel="galleryfacebox" title="Bison Finish Regular Season in Strong Fashion"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_189.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_190.jpg" rel="galleryfacebox" title="...a long weekend in b-town"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_190.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02282008_192.jpg" rel="galleryfacebox" title="Bison Baller #1"><img src="http://mediastorage.playerspace.com/photo/groups/6_02282008_192.jpg"></img></a>

                </div>
                <div id="loadmore2" class="siteusemorebox">
                    <a href="#" class="loadmore" id="2">View more media</a>
                </div>              
            </div>

            <div class="clearboth"></div>
            <script type="text/javascript" src="/scripts/jquery/plugins/montage/jquery.montage.min.js"></script>
            <script language="javascript1.1">
                window.media_more_script = '/ajax_results.cfm?rpp=6&ajax_type=my_group_photos&eventid=37&media_type=1&myscript=%2Findex%2Ecfm%2Fleague%2F23%2Faction%2Fdashboard%2Fcontent%5Faction%2Fevents%2Feventid%2F37%2Fevent%5Faction%2Fphotos';
            </script>                       
            <script type="text/javascript">
                $(function() {
                    var $container  = $('#am-container'),
                        $imgs       = $container.find('img').hide(),
                        totalImgs   = $imgs.length,
                        cnt         = 0;

                    $imgs.each(function(i) {
                        var $img    = $(this);
                        $('<img/>').load(function() {
                            ++cnt;
                            if( cnt === totalImgs ) {
                                $imgs.show();
                                $container.montage({
                                    minw : 150,
                                    alternateHeight : true,
                                    alternateHeightRange : {
                                        min : 150,
                                        max : 350
                                    },
                                    margin : 3,
                                    fillLastRow : true
                                });

                                /* 
                                 * just for this demo:
                                 */
                                $('#montage_overlay').fadeIn(500);

                                $(document).on("click",'.loadmore',function()                               
                                    {
                                    var ID = $(this).attr("id");
                                    var myscript3 = window.media_more_script || null;                       
                                    if(ID)
                                        {
                                        $("#loadmore"+ID).html('<img src="/images/processing.gif" />');                 
                                        $.ajax({
                                        type: "POST",
                                        url: myscript3,
                                        data: "lastmsg="+ ID, 
                                        cache: false,
                                        success: function(html){$container.append(html).montage( 'add',html);}
                                        });
                                        }
                                    else
                                        {
                                        $(".siteusemorebox").html('No more records.');
                                        }               
                                    return false;
                                }); 

                            }
                        }).attr('src',$img.attr('src'));
                    }); 

                });
            </script> 
```

谷歌浏览器返回以下错误：

```
TypeError: Object 
                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02282008_192.jpg" rel="galleryfacebox" title="Bison Baller #1"><img src="http://mediastorage.playerspace.com/photo/groups/6_02282008_192.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_190.jpg" rel="galleryfacebox" title="...a long weekend in b-town"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_190.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_189.jpg" rel="galleryfacebox" title="Bison Finish Regular Season in Strong Fashion"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_189.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_188.jpg" rel="galleryfacebox" title="...the crowd gets the skinny on W&J"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_188.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_186.jpg" rel="galleryfacebox" title="Home Team for 3"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_186.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_185.jpg" rel="galleryfacebox" title="Yuker at Bubba's"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_185.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_183.jpg" rel="galleryfacebox" title="Bison Alumni Honored"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_183.jpg"></img></a>

                        <a href="http://mediastorage.playerspace.com/photo/groups/6_02252008_181.jpg" rel="galleryfacebox" title="'92 Bison Alumni"><img src="http://mediastorage.playerspace.com/photo/groups/6_02252008_181.jpg"></img></a>
                     has no method 'find' [http://halosummerleague.playerspace.com/scripts/jquery/plugins/montage/jquery.montage.min.js:1] 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:40:54.703

知道了

```
 <script type="text/javascript">
        $(function() {
            var $container  = $('##am-container'),
                $imgs       = $container.find('img').hide(),
                totalImgs   = $imgs.length,
                cnt         = 0;

            $imgs.each(function(i) {
                var $img    = $(this);
                $('<img/>').load(function() {
                    ++cnt;
                    if( cnt === totalImgs ) {
                        $imgs.show();
                        $container.montage({
                            minw : 150,
                            alternateHeight : true,
                            alternateHeightRange : {
                                min : 150,
                                max : 350
                            },
                            margin : 3,
                            fillLastRow : true
                        });
                        $('##montage_overlay').fadeIn(500);                             
                        $(document).on("click",'.loadmore',function()                               
                            {
                            var ID = $(this).attr("id");
                            var myscript3 = window.media_more_script || null;                       
                            if(ID)
                                {
                                    $("##loadmore"+ID).html('<img src="/images/processing.gif" />');                    
                                    $.ajax
                                        ({
                                            type: "POST",
                                            url: myscript3,
                                            data: "lastmsg="+ ID, 
                                            cache: false,
                                            success: function(html){

                                                var $newimages = $( html );
                                                $newimages.imagesLoaded( function(){
                                                $container.append( $newimages ).montage( 'add', $newimages );
                                                $("##loadmore"+ID).remove();
                                                });                                                 
                                            }
                                        });
                                }
                            else
                                {
                                    $(".siteusemorebox").html('No more records.');
                                    $("##loadmore"+ID).remove();
                                }               
                            return false;
                        });                 
                    }
                }).attr('src',$img.attr('src'));
            }); 

        });
    </script> 
```

# database - 根据距离分配位置

> ID：14983690
> 
> 赞同：2
> 
> 时间：2013-02-20T15:30:47.633
> 
> 标签：database, math

作为一个过于简单的例子，我有一个出席人数最多的活动列表：

```
 event    | places
===================
 event_A  |   1
 event_B  |   2
 event_C  |   1 
```

以及与活动距离的与会者名单：

```
 attendee    | event_A dist | event_B dist | event_C dist
==========================================================
 attendee_1  |      12      |      15      |      12      
 attendee_2  |      11      |      15      |      11
 attendee_3  |      10      |      11      |      12 
```

谁能建议一种简单的方法来生成一组选项，根据最短的总距离和最短的平均距离提供最佳案例分配？

我目前将数据保存在 Oracle Spatial 数据库中，但我愿意接受建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T10:16:53.660

我目前对您的问题的理解如下：

*   每个与会者都应该被分配到一个事件
*   每个事件都有分配给它的参加者人数的限制
*   未满甚至是空的事件都没有问题
*   事件和参加者之间的每个分配对应于给定的距离
*   您希望最小化所有作业的总距离
*   您可能希望不使用总和而是使用均值来打印结果

基于这种解释，我建议以下算法：

1.  创建一个完整的二分图，分区*A*中的节点代表参加者，分区*B*中的节点代表事件中的地点。所以每个参加者对应一个节点，每个事件对应的节点与它的位置一样多。所有参加者都连接到所有事件节点，距离作为边缘成本。

    此时，您的问题对应于[一般分配问题](http://en.wikipedia.org/wiki/Assignment_problem)，“代理”对应于您的活动地点，“任务”对应于您的参加者。必须覆盖每个与会者，但并非必须使用每个活动场所。

2.  添加虚拟与会者以实现完美匹配。简单地总结所有地方，从中减去实际参加者的数量。对于差异，创建尽可能多的参加者节点，到所有事件节点的距离为零。

    通过使两个分区的大小相等，您现在处于更常见的[线性分配问题](http://en.wikipedia.org/wiki/Assignment_problem)的域中。

3.  使用[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm)计算最小成本分配。也许您可以考虑一些简化，利用您有许多等效节点的事实，即同一事件的地点和所有那些虚拟参加者。

所有这些可能都应该在应用程序代码中完成，而不是在数据库中。所以我宁愿标记这个[算法](/questions/tagged/algorithm "显示标记为“算法”的问题")。您需要从数据库中提取完整的成本矩阵来为您的边缘提供成本。

# c# - 为什么比较两个相等的波斯词不返回 0？

> ID：14983692
> 
> 赞同：5
> 
> 时间：2013-02-20T15:30:58.437
> 
> 标签：c#, .net, vb.net, cultureinfo, culture

我们有两个相同的字母 'ی' 和 'ي'，第一个作为主字母出现在 Windows 7 之后。
回到旧 XP，我们将第二个作为主要版本。
现在，如果一个客户端在 Windows XP 上而另一个客户端在 Windows 7 上，我得到的输入被确定为不同。
我也尝试过使用波斯文化，但没有成功。
我错过了什么吗？
**编辑：为了更好地理解，不得不更改单词。现在它们看起来很相似。**

```
foreach (CompareOptions i in Enum.GetValues(new CompareOptions().GetType()).OfType<CompareOptions>()) 
    Console.WriteLine( string.Compare("محسنين", "محسنین", new CultureInfo("fa-ir"), i) + "\t : " + i ); 
```

输出：

```
-1       : None
-1       : IgnoreCase
-1       : IgnoreNonSpace
-1       : IgnoreSymbols
-1       : IgnoreKanaType
-1       : IgnoreWidth
1        : OrdinalIgnoreCase
-1       : StringSort
130      : Ordinal 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:41:29.683

两个字符串*不*相等。最后一个字母不同。

关于为什么`IgnoreCase`返回 -1 但`OrdinalIgnoreCase`返回 1：

*   `OrdinalIgnoreCase`使用不变的文化将字符串转换为大写，然后执行逐字节比较
*   `IgnoreCase`使用指定的区域性执行不区分大小写的比较。

不同之处在于，`IgnoreCase`它对指定语言字母的差异“了解更多”，并且可能会以不同于不变文化的方式对待它们，从而导致不同的结果。
这是后来被称为[“土耳其 İ 问题”](http://haacked.com/archive/2012/07/05/turkish-i-problem-and-why-you-should-care.aspx)的另一种表现形式。

您可以使用 InvariantCulture 而不是 Persian 来验证它自己：

```
foreach (CompareOptions i in Enum.GetValues(new CompareOptions().GetType()).OfType<CompareOptions>()) 
    Console.WriteLine( string.Compare("محسنی", "محسني", CultureInfo.InvariantCulture, i) + "\t : " + i ); 
```

这将为`IgnoreCase`和输出 1 `OrdinalIgnoreCase`。

关于您编辑的问题：
这两个字符串仍然不同。以下代码输出字符串中单个字符的值。

```
foreach(var value in strings.Select(x => x.ToCharArray().Select(y => (int)y)))
    Console.WriteLine(value); 
```

结果将如下所示：

```
1605
1581
1587
1606
1610 // <-- "yeh": ي
1606

1605
1581
1587
1606
1740 // <-- "farsi yeh": ی
1606 
```

如您所见，有一个字符不同，导致比较将这两个字符串视为不相等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-24T07:39:54.793

这里我的代码字符阿拉伯文“ي,ك”到波斯文“ی,ک”，通过扩展方法：

```
 private static readonly string[] pn = { "ی", "ک" };
    private static readonly string[] ar = { "ي", "ك" };
    public static string ToFaText(this string strTxt)
    {
        string chash = strTxt;
        for (int i = 0; i < 2; i++)
            chash = chash.Replace(ar[i],pn[i]);
        return chash;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-08T09:57:33.897

```
public string ToFaText(string strTxt)
{
    return strTxt.Replace("ك","ک").Replace("ي","ی");
} 
```

用法：

```
 string str="اولين برداشت";
        string per = ToFaText(str); 
```

# java - 使用 LWJGL 重绘线条

> ID：14983694
> 
> 赞同：0
> 
> 时间：2013-02-20T15:31:00.737
> 
> 标签：java, opengl, lwjgl

我想做一个小应用程序，你有 4 行，每行都有第一个坐标在窗口的一侧随机设置，第二个坐标将跟随鼠标，所以你得到这个效果：

[![图像](../Images/b99a05a779744e5dbb2276a055555f04.png)](https://i.stack.imgur.com/cm1tT.png)

您看不到光标，但线条在中心与光标相遇。

我的问题是我无法让它保持随机移动线条。因此，每一帧、每滴答或每一毫秒，这些行都会随机改变位置并删除前面的行。在此之后，我想随机更改线条的颜色，以便它会选择一个位置和一个随机位置，并且几乎可以让任何人都适合癫痫症，但我需要先弄清楚位置。

我试过做一些 glClear(GL_...) 命令，但它们似乎不起作用。有没有办法完全清除屏幕并重做 glBegin(GL_LINES) 命令将其定位在另一个地方？

这是我的代码：

```
 package tests;

import static org.lwjgl.opengl.GL11.*;
import java.util.Random;
import org.lwjgl.LWJGLException;
import org.lwjgl.input.*;
import org.lwjgl.opengl.*;

public class game {

int wx = 600;
int hy = 400;

int rx = new Random().nextInt(wx);
int ry = new Random().nextInt(hy);

public game() throws LWJGLException {

    int mouseX = Mouse.getX();
    int mouseY = hy-Mouse.getY()-1;

    Display.setDisplayMode(new DisplayMode(wx, hy));
    Display.create();
    Display.setTitle("Game");

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, wx, hy, 0, 1, -1);
    glMatrixMode(GL_MODELVIEW);

    while(!Display.isCloseRequested()) {
        lines();

        while(Keyboard.next()) {
            if(Keyboard.getEventKey() == Keyboard.KEY_ESCAPE) {
                Display.destroy();
                System.exit(0);
            }
        }

        while(Mouse.next()) {
            if(Mouse.isButtonDown(0)) {
                System.out.println("(" + mouseX + ", " + mouseY + ")");
            }
        }
    }
}

public void lines() {

    glClear(GL_COLOR_BUFFER_BIT);

    int mouseX = Mouse.getX();
    int mouseY = hy-Mouse.getY()-1;

    glBegin(GL_LINES);
        glVertex2i(rx, 0);
        glVertex2i(mouseX, mouseY);
    glEnd();

    glBegin(GL_LINES);
        glVertex2i(0, ry);
        glVertex2i(mouseX, mouseY);
    glEnd();
    glBegin(GL_LINES);
        glVertex2i(rx, hy);
        glVertex2i(mouseX, mouseY);
    glEnd();
    glBegin(GL_LINES);
        glVertex2i(wx, ry);
        glVertex2i(mouseX, mouseY);
    glEnd();
        glLineWidth(5);
        glColor3f(1f, 0f, 0f);

    Display.update();
    Display.sync(500);

}

public static void main(String[] args) throws LWJGLException {
    new game();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:52:39.463

Try moving your `rx`/`ry` calculation inside `lines()`:

```
public void lines() 
{
    int rx = new Random().nextInt(wx);
    int ry = new Random().nextInt(hy);

    glClear(GL_COLOR_BUFFER_BIT);

    int mouseX = Mouse.getX();
    int mouseY = hy-Mouse.getY()-1;

    glLineWidth(5);
    glColor3f(1f, 0f, 0f);

    glBegin(GL_LINES);
        glVertex2i(rx, 0);
        glVertex2i(mouseX, mouseY);
    glEnd();

    glBegin(GL_LINES);
        glVertex2i(0, ry);
        glVertex2i(mouseX, mouseY);
    glEnd();

    glBegin(GL_LINES);
        glVertex2i(rx, hy);
        glVertex2i(mouseX, mouseY);
    glEnd();

    glBegin(GL_LINES);
        glVertex2i(wx, ry);
        glVertex2i(mouseX, mouseY);
    glEnd();

    Display.update();
    Display.sync(500);
} 
```

# user-agent - IE10 用户代理字符串显示三叉戟 5 而不是 6

> ID：14983698
> 
> 赞同：0
> 
> 时间：2013-02-20T15:31:32.500
> 
> 标签：user-agent, internet-explorer-10

最近，我们遇到一位客户在加载我们的一个安全页面时遇到问题。然后突然间问题就消失了。

客户最近在 Win7 上将 IE9 升级为 IE10。当他遇到问题时，用户代理字符串指示“trident/5.0”。当问题似乎自行解决时，用户字符串中的唯一区别是“trident/6.0”

这是一个问题还是我在这里吠错了树。

# .net - 是否有任何 .NET dll 可以执行 GIMP 或其他一些图像程序工作？

> ID：14983702
> 
> 赞同：1
> 
> 时间：2013-02-20T15:31:43.430
> 
> 标签：.net, image-processing, graphics32

我想知道是否有任何 dll 可用于导入到我的 C# 项目中以处理图像。我期望做的是：

1.  增加/减少亮度，曝光
2.  将两张照片放在同一位置，并使用像 Photoshop 那样的“乘法”功能。
3.  缩放和调整大小

就我而言，我发现了 gimp#，这不是我所期望的，因为它只适用于 GIMP 插件。再挖一点，我发现了 Graphics32。

Graphics32 正是我在功能方面所需要的，但它不是为 .NET 制作的

我不确定是否可以编译 Graphics32 代码并以某种方式在 C# 中使用它（我正在考虑）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:35:17.547

ImageMagick 是我以前用过的东西：

[http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php)

可以在此页面上找到 .NET API：

[http://www.imagemagick.org/script/api.php](http://www.imagemagick.org/script/api.php)

# java - Ubuntu 12.04 中 localhost 文件夹的位置

> ID：14983703
> 
> 赞同：0
> 
> 时间：2013-02-20T15:31:45.353
> 
> 标签：java, eclipse, tomcat

我正在使用 Tomcat 7.0.29 运行 eclipse Juno。我有一些文件由我的 webapp 保存到 webapp 的根目录，我想删除它们。我试图找到 localhost 文件夹以便能够做到这一点。我正在阅读的所有内容都告诉我它应该位于 /var/www，但是 var 中没有 /www 目录。它可能在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:12:05.673

由于您使用的是 Eclipse IDE，并且您不知道 Tomcat 安装文件夹在哪里，您可以通过转到*Windows/Preferences*使用 IDE 找到它。它将弹出一个 Preferences 窗口，在左侧树中选择*Server/Runtime Environment*选项，在右侧必须出现*Apache Tomcat v7.x*。从列表中选择它并选择*Edit...*选项，它将显示 tomcat 安装目录。我们称这个文件夹`<tomcat>`

现在您知道了文件夹安装，但也许 Eclipse 没有使用它来部署 Java Web 应用程序。为了确保这一点，在您的 Eclipse 中，转到*Servers*视图（如果它在 IDE 中不可见，请转到*Window/Show view/Servers*），它将显示您的 tomcat 服务器（和其他服务器），双击它. 在 Tomcat 概览窗口中，检查*Server locations*面板，展开它并检查 webapp 的部署位置：

*   如果选择的选项是*使用 Tomcat 安装*，那么 Web 应用程序必须在*`<tomcat>`webapps中*
*   如果选择的选项是*使用工作区元数据*，则 Web 应用程序必须位于*.metadata/.plugins/org.eclipse.wst.server.core/tmp[number]/wtpwebapps*内的工作区中（感谢[Lars Vogel 博客文章](http://www.vogella.com/blog/2009/04/08/eclipse-wtp-deployment-location-of-the-local-tomcat/)）。这是 Eclipse 创建的一个特殊文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:34:27.923

默认的 tomcat 文件夹位于 /var/lib/tomcat7。您的 webapps 在 /var/lib/tomcat7/webapps 下

不确定您指的是哪个 localhost 文件夹。有 /etc/tomcat7/Catalina/localhost 但我看不出你应该触摸它的原因。

这假设您使用标准的 Ubuntu 工具来安装 tomcat。

# scala - 获取 Scala 类型绑定错误：未找到：类型 <%<

> ID：14983705
> 
> 赞同：7
> 
> 时间：2013-02-20T15:31:55.613
> 
> 标签：scala, type-bounds

所以我一直在尝试通过[twitter Scala school](http://twitter.github.com/scala_school)学习 Scala 。但我目前停留在他们的[类型绑定示例之一](http://twitter.github.com/scala_school/advanced-types.html#otherbounds)。

`<%<`特别是，它是使用类型关系运算符将类型绑定为特定类型的类型。

当我在 Scala 控制台中执行以下代码时：

```
scala> class Container[A](value: A) { def addIt(implicit evidence: A <%< Int) = 123 + value } 
```

...我收到以下错误：

```
<console>:7: error: not found: type <%<
       class Container[A](value: A) { def addIt(implicit evidence: A <%< Int) = 123 + value }
                                                                     ^
<console>:7: error: overloaded method value + with alternatives:
  (x: Double)Double <and>
  (x: Float)Float <and>
  (x: Long)Long <and>
  (x: Int)Int <and>
  (x: Char)Int <and>
  (x: Short)Int <and>
  (x: Byte)Int <and>
  (x: String)String
 cannot be applied to (A)
       class Container[A](value: A) { def addIt(implicit evidence: A <%< Int) = 123 + value } 
```

我的问题是，为什么 Scala 解释器会抱怨？

我一直在尝试浏览 Scala 文档，但我无法在任何地方找到该操作员的信息。我可以看到 Scala 学校是在 Scala 2.8.0 的基础上创建的，而我正在运行 Scala 2.10.0 - 所以也许这已经被删除了？如果是这种情况，为什么这似乎是一个有用的运算符？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T15:43:47.200

Scala 2.8 中的约束`A <%< B`定义为

```
 sealed abstract class <%<[-From, +To] extends (From => To)
  object <%< {
    implicit def conformsOrViewsAs[A <% B, B]: A <%< B = new (A <%< B) {def apply(x: A) = x}
  } 
```

所以你总是可以用这种方式把它带回来。但是，我猜它被弃用的原因是视图绑定只是要求从`A`to的隐式函数`B`，并且已经有一种非常好的方法可以以通用的方式表达该特定约束：

```
class Container[A](value: A) { def addIt(implicit evidence: A => Int) = 123 + value } 
```

顺便说一句，值得注意的是，它不是运算符，而是中缀位置的类，正如您从定义中看到的那样。也是如此`=>`，这只是引用`Function1`类型构造函数的另一种方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:38:06.157

在[这个站点上](http://scalabound.org/?page_id=201#G)，它说`A <%< B`在 Scala 2.9 中已弃用。我不知道为什么，我同意这似乎有点奇怪，因为它对我来说也是一个非常有用的运算符。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-20T16:39:32.457

正确的用法似乎是

```
class Container[A](value: A) { def addIt[A <% Int] = 123 + value } 
```

至于重载的值，`scala`是选择不解决歧义；在这种情况下，您必须做出决定。

*   你可以尝试调试：`-Xprint:typer`

*   或者您可以通过使用或已经建议的方式来确定`A`确实是这样。它们是等价的。但在这里你说的是一种; 相反，可以看作是which is what does。`Int``class Container[A](value: A) { def addIt = 123 + value.asInstanceOf[Int] }``class Container[A](value: A) { def addIt(implicit evidence: A => Int) = 123 + value }``A``Int``A``Int``<%`

第二种选择并非微不足道。考虑以下

```
scala> class Container[A](value: A) { def printIt[A <% Int] = println( 123+" could be " + value) }
defined class Container

scala> val x = new Container("Love")
x: Container[String] = Container@21ebfd82

scala> x.printIt
123 could be Love 
```

显然`"love"`不是一种，`Int`因为它是`String`，但在这种情况下它完全没问题：这就是为什么你应该小心使用`A => Int`.

# javafx - JavaFX - StackPane X、Y 坐标

> ID：14983706
> 
> 赞同：8
> 
> 时间：2013-02-20T15:31:57.147
> 
> 标签：javafx, stackpanel

我使用 StackPanel 作为我的图形、面板等的容器。我发现，坐标 X,Y (0,0) 位于面板的中心。

是否可以将其移动到左上窗格？从中心计算所有尺寸要困难得多。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-20T20:31:47.873

[您可以使用StackPane.setAlignment(node, position)](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/StackPane.html)方法将添加到 StackPane 的节点的布局设置为 Stackpane 内的某个位置：

```
Label topLeftLabel = new Label("Top Left");
StackPane stack = new StackPane();
stack.getChildren().add(topLeftLabel);

StackPane.setAlignment(topLeftLabel, Pos.TOP_LEFT); 
```

* * *

尽管这是可能的，但从您对如何尝试使用 StackPane 的简要描述来看，听起来您最好使用常规[Pane](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/Pane.html)或[Group](http://docs.oracle.com/javafx/2/api/javafx/scene/Group.html)或[AnchorPane](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/AnchorPane.html)来获得您似乎想要的那种绝对定位达到。

也可能考虑使用诸如[SceneBuilder 之](http://www.oracle.com/technetwork/java/javafx/tools/index.html)类的可视化工具。即使您最终没有使用它输出的 FXML，SceneBuilder 也应该让您更好地了解 JavaFX 布局机制的工作原理。SceneBuilder 将`AnchorPane`其用作其默认布局窗格，用于为元素提供绝对定位（这似乎是您想要实现的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-25T12:52:32.640

在这种情况下，前面的答案当然是最好的，但知道您可以使用 Translation 在 StackPane 上移动节点也是明智的。

前任。

```
 Label topLeftLabel = new Label("Top Left");
    StackPane stack = new StackPane();
    stack.getChildren().add(topLeftLabel);

    topLeftLabel.setTranslateX(stack.getWidth()/2);
    topLeftLabel.setTranslateY(stack.getHeight()/2); 
```

它会做同样的事情（但可能看起来更糟）

# .net - 如何使用自定义 WebResponse 创建 WebException

> ID：14983708
> 
> 赞同：2
> 
> 时间：2013-02-20T15:31:59.027
> 
> 标签：.net, asp.net-mvc-4, asp.net-web-api, httpwebresponse, system.net.webexception

我使用 MVC4 Web API 创建了一个 RESTful Web 服务。如果出现问题，我将抛出 WebException。

```
throw new WebException("Account not found"); 
```

这是处理异常的客户端代码：

```
private void webClientPost_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
    {
        try
        {
            if (e.Error == null)
            {
                // Display result
                textBoxResult.Text = e.Result;
            }
            else
            {
                // Display status code
                if (e.Error is WebException)
                {
                    StringBuilder displayMessage = new StringBuilder();

                    WebException we = (WebException)e.Error;
                    HttpWebResponse webResponse = (System.Net.HttpWebResponse)we.Response;

                    displayMessage.AppendLine(webResponse.StatusDescription);

                    // Gets the stream associated with the response.
                    Stream receiveStream = webResponse.GetResponseStream();
                    Encoding encode = System.Text.Encoding.GetEncoding("utf-8");

                    // Pipes the stream to a higher level stream reader with the required encoding format. 
                    StreamReader readStream = new StreamReader(receiveStream, encode);

                    displayMessage.Append(readStream.ReadToEnd());

                    readStream.Close();

                    textBoxResult.Text = displayMessage.ToString();
                }
            }
        }
        catch (Exception ex)
        {
            textBoxResult.Text = ex.Message;
        }
    } 
```

如您所见，客户端代码正在显示 WebException 中包含的 HttpWebResponse。但是显示的是：

```
Internal Server Error {"Message":"An error has occurred."} 
```

这不是我的错误消息:-(所以我想我会使用 Mircosoft [MSDN WebException 4th Constructor指定的 WebException 的替代构造函数](http://msdn.microsoft.com/en-gb/library/b2zywh13.aspx)

在 MSDN 示例中，他们通过以下方式创建 WebResponse：

```
MemoryStream memoryStream = new MemoryStream(recvBytes);
getStream = (Stream) memoryStream;

// Create a 'WebResponse' object
WebResponse myWebResponse = (WebResponse) new HttpConnect(getStream);
Exception myException = new Exception("File Not found");

// Throw the 'WebException' object with a message string, message status,InnerException and WebResponse 
throw new WebException("The Requested page is not found.", myException, WebExceptionStatus.ProtocolError, myWebResponse); 
```

但是 .Net 框架中不存在 HttpConnect :-(。

有谁知道如何使用特定的 WebResponse 创建 WebException？谢谢，马特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T15:38:19.637

> 如果出现问题，我将抛出 WebException

哦不，不要。如果您的 Web API 出现问题，请设置相应的响应状态代码。

例如：

```
public HttpResponseMessage Get(int id)
{
    var model = this.repository.Get(id);
    if (model == null)
    {
        return Request.CreateErrorResponse(
            HttpStatusCode.NotFound, 
            string.Format("Sorry but we couldn't find a resource with id={0}", id)
        );
    }

    return Request.CreateResponse(HttpStatusCode.OK, model);
} 
```

然后在客户端：

```
using (var client = new WebClient())
{
    try
    {
        string result = client.DownloadString("http://example.com/api/someresources/123");
    }
    catch (WebException ex)
    {
        // get the status code:
        var response = (HttpWebResponse)ex.Response;
        var statusCode = response.StatusCode;
        // you could also read the response stream:
        using (var reader = new StreamReader(response.GetResponseStream()))
        {
            // now you could read the body
            string body = reader.ReadToEnd();
        }
    }
} 
```

# python - 编译好的 opencl 程序可以存储为单独的二进制文件吗？

> ID：14983709
> 
> 赞同：2
> 
> 时间：2013-02-20T15:32:00.403
> 
> 标签：python, opencl, gpgpu, pyopencl, amd-processor

我在单独的文件上有 2 个两个 python 脚本。第一个具有 opencl 程序，该程序对传递给它的图像执行一些图像处理并返回结果。第二个脚本从文件中读取图像并调用第一个脚本，将读取的图像作为参数传递并获得它返回的结果，用于进一步处理。

现在，我的文件夹中有 100 张图像。因此，第二个脚本调用第一个脚本 100 次，每次调用第一个脚本时，都会编译 opencl 内核，这是绝对没有必要的，因为所有图像的格式和尺寸都相同。有没有办法先编译一次opencl内核，以二进制格式存储它并在需要时调用它？当然，我可以将所有代码放在一个大文件中，编译内核一次并循环调用 100 次，但为了方便起见，我想要单独的文件。

硬件：

CPU：AMD A8 APU，AMD Phenom 2 X4

GPU：AMD Radeon HD 7640G + 7670M 双显卡，ATI Radeon HD5770

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:59:00.907

是的，您可以通过`clGetProgramInfo()`并存储程序的编译“二进制”。然后，您将使用`clCreateProgramWithBinary()`而不是加载程序`clCreateProgramWithSource()`。

但是您使用的是 PyOpenCL，它会[自动缓存](http://documen.tician.de/pyopencl/runtime.html#pyopencl.Program.build)程序二进制文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T06:02:58.307

在 NVIDIA 上，二进制文件将采用 ptx 格式。使用标志 CL_PROGRAM_BINARY_SIZES 获取二进制大小 clGetProgramInfo()

将二进制文件存储在 ptx 文件中。使用标志 CL_PROGRAM_BINARIES 的 clGetProgramInfo()

使用 ptx 文件作为输入的 clCreateProgramWithBinary()。

# magento - 无按钮保存以创建订单发货

> ID：14983710
> 
> 赞同：2
> 
> 时间：2013-02-20T15:32:01.033
> 
> 标签：magento, adminhtml

我无法更改订单状态。请参阅图像上的问题。页面中没有“保存以创建订单发货”的按钮。

有问题的订单已经处于处理状态。

版本：1.6.2.0

[问题 http://img17.imageshack.us/img17/5984/nosavebuttonshipping.jpg](http://img17.imageshack.us/img17/5984/nosavebuttonshipping.jpg)

我在 app/design/adminhtml/default/default/template/sales/order/shipment/create/items.phtml 中注释代码后恢复按钮

```
<div class="order-totals-bottom">

      <?php //if ($this->canCreateShippingLabel()): ?>
      <p>
          <label class="normal" for="create_shipping_label"><?php echo Mage::helper('sales')->__('Create Shipping Label') ?></label>
          <input id="create_shipping_label" name="shipment[create_shipping_label]" value="1" type="checkbox"  onclick="toggleCreateLabelCheckbox();" />
      </p>
      <?php //endif; ?>
      <p>
          <label class="normal" for="notify_customer"><?php echo Mage::helper('sales')->__('Append Comments') ?></label>
          <input id="notify_customer" name="shipment[comment_customer_notify]" value="1" type="checkbox" />
      </p>
      <?php if ($this->canSendShipmentEmail()): ?>
      <p>
          <label class="normal" for="send_email"><?php echo Mage::helper('sales')->__('Email Copy of Shipment') ?></label>
          <input id="send_email" name="shipment[send_email]" value="1" type="checkbox" />
      </p>
      <?php endif; ?>
      <div class="a-right">
      <?php echo $this->getChildHtml('submit_button') ?>
      </div>
</div> 
```

`$this->canCreateShippingLabel()`但是为什么其他两个选项（发货的电子邮件副本和附加评论）在为 NULL时没有出现？

有任何想法吗？

# c# - 在组合暂时关闭的事件时提高效率和公平性

> ID：14983713
> 
> 赞同：26
> 
> 时间：2013-02-20T15:32:21.767
> 
> 标签：c#, concurrency

我有一堆线程会生成 type`A`和 type的事件`B`。

我的程序接收这些事件，将它们包装在一条消息中并通过网络发送它们。消息可以包含一个`A`事件、一个`B`事件或一个`A`事件和一个`B`事件：

```
SendMessage(new Message(a: 1,    b: null));
SendMessage(new Message(a: null, b: 2   ));
SendMessage(new Message(a: 3,    b: 4   )); 
```

类型`A`事件发生得相当频繁，而类型事件发生的频率`B`要低得多。因此，当一个线程生成一个`B`事件时，我的程序会稍等片刻，看看另一个线程是否生成了一个事件，并在可能的情况下将事件和`A`事件结合起来。`A``B`

这是我的代码：

```
object gate = new object();
int? pendingB;

Message WrapA(int a, int millisecondsTimeout)
{
    int? b;

    lock (gate)
    {
        b = pendingB;
        pendingB = null;
        Monitor.Pulse(gate);
    }

    return new Message(a, b);
}

Message WrapB(int b, int millisecondsTimeout)
{
    lock (gate)
    {
        if (pendingB == null)
        {
            pendingB = b;
            Monitor.Wait(gate, millisecondsTimeout);
            if (pendingB != b) return null;
            pendingB = null;
        }
    }

    return new Message(null, b);
} 
```

到目前为止，这有效。但是，有两个问题：

*   如果有很多`A`事件和很多事件，该算法不是很有效：即使有足够的事件，也`B`只有一定百分比的`B`事件附加到事件。`A``A`

*   如果有`A`一段时间没有事件生成（不常见，但并非不可能），该算法是完全不公平的：一个线程生成`B`事件每次都必须等待，而所有其他线程可以立即发送它们的`B`事件。

如何提高算法的效率和公平性？

[约束：
•  `WrapA`并且`WrapB`必须在很短的、确定的时间内终止。
•  `SendMessage`必须在任何锁之外调用。
• 除了 之外，没有可用的同步机制`gate`。
• 没有额外的线程、任务、计时器等可用。
• 由于`A`在正常情况下此类事件发生得如此频繁，因此忙于等待`WrapB`是可以的。]

* * *

这是一个可以用作基准测试的测试程序：

```
public static class Program
{
    static int counter0 = 0;
    static int counterA = 0;
    static int counterB = 0;
    static int counterAB = 0;

    static void SendMessage(Message m)
    {
        if (m != null)
            if (m.a != null)
                if (m.b != null)
                    Interlocked.Increment(ref counterAB);
                else
                    Interlocked.Increment(ref counterA);
            else
                if (m.b != null)
                    Interlocked.Increment(ref counterB);
                else
                    Interlocked.Increment(ref counter0);
    }

    static Thread[] Start(int threadCount, int eventCount,
        int eventInterval, int wrapTimeout, Func<int, int, Message> wrap)
    {
        Thread[] threads = new Thread[threadCount * eventCount];
        for (int i = 0; i < threadCount; i++)
        {
            for (int j = 0; j < eventCount; j++)
            {
                int k = i * 1000 + j;
                int l = j * eventInterval + i;
                threads[i * eventCount + j] = new Thread(() =>
                {
                    Thread.Sleep(l);
                    SendMessage(wrap(k, wrapTimeout));
                });
                threads[i * eventCount + j].Start();
            }
        }
        return threads;
    }

    static void Join(params Thread[] threads)
    {
        for (int i = 0; i < threads.Length; i++)
        {
            threads[i].Join();
        }
    }

    public static void Main(string[] args)
    {
        var wrapper = new MessageWrapper();
        var sw = Stopwatch.StartNew();

        // Only A events
        var t0 = Start(10, 40, 7, 1000, wrapper.WrapA);
        Join(t0);

        // A and B events
        var t1 = Start(10, 40, 7, 1000, wrapper.WrapA);
        var t2 = Start(10, 10, 19, 1000, wrapper.WrapB);
        Join(t1);
        Join(t2);

        // Only B events
        var t3 = Start(10, 20, 7, 1000, wrapper.WrapB);
        Join(t3);

        Console.WriteLine(sw.Elapsed);

        Console.WriteLine("0:  {0}", counter0);
        Console.WriteLine("A:  {0}", counterA);
        Console.WriteLine("B:  {0}", counterB);
        Console.WriteLine("AB: {0}", counterAB);

        Console.WriteLine("Generated A: {0}, Sent A: {1}",
            10 * 40 + 10 * 40, counterA + counterAB);
        Console.WriteLine("Generated B: {0}, Sent B: {1}",
            10 * 10 + 10 * 20, counterB + counterAB);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T02:14:08.123

为了好玩，这里有一个无锁实现：

```
public sealed class MessageWrapper
{
    private int pendingB;

    public Message WrapA(int a, int millisecondsTimeout)
    {
        int b = Interlocked.Exchange(ref pendingB, -1);
        return new Message(a, b == -1 ? null : b);
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        var sw = new SpinWait();
        while (Interlocked.CompareExchange(ref pendingB, b, -1) != -1)
        {
            // Spin
            sw.SpinOnce();

            if (sw.NextSpinWillYield)
            {
                // Let us make progress instead of yielding the processor
                // (avoid context switch)
                return new Message(null, b);
            }
        }

        return null;
    }
} 
```

**结果**

原始实现：

```
00:00:02.0433298
0:  0
A:  733
B:  233
AB: 67
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

无锁实现：

```
00:00:01.2546310
0:  0
A:  717
B:  217
AB: 83
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

**更新**

不幸的是，上面的实现有一个错误和一些缺点。这是一个改进的版本：

```
public class MessageWrapper
{
    private int pendingB = EMPTY;
    private const int EMPTY = -1;

    public Message WrapA(int a, int millisecondsTimeout)
    {
        int? b;
        int count = 0;
        while ((b = Interlocked.Exchange(ref pendingB, EMPTY)) == EMPTY)
        {
            if (count % 7 == 0)
            {
                Thread.Sleep(0);
            }
            else if (count % 23 == 0)
            {
                Thread.Sleep(1);
            }
            else
            {
                Thread.Yield();
            }
            if (++count == 480)
            {
                return new Message(a, null);
            }
        }
        return new Message(a, b);
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        int count = 0;
        while (Interlocked.CompareExchange(ref pendingB, b, EMPTY) != EMPTY)
        {
            // Spin
            Thread.SpinWait((4 << count++));
            if (count > 10)
            {
                // We didn't manage to place our payload.
                // Let's send it ourselves:
                return new Message(null, b);
            }
        }

        // We placed our payload. 
        // Wait some more to see if some WrapA snatches it.
        while (Interlocked.CompareExchange(ref pendingB, EMPTY, EMPTY) == b)
        {
            Thread.SpinWait((4 << count++));
            if (count > 20)
            {
                // No WrapA came along. Pity, we will have to send it ourselves
                int payload = Interlocked.CompareExchange(ref pendingB, EMPTY, b);
                return payload == b ? new Message(null, b) : null;
            }
        }
        return null;
    }
} 
```

结果：

OP的实现

```
00:00:02.1389474
0:  0
A:  722
B:  222
AB: 78
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

第二种实现：

```
00:00:01.2752425
0:  0
A:  700
B:  200
AB: 100
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-24T17:45:12.050

为了多样性，我尝试了一种基于并发集合的方法。对我来说，从发布的约束中不清楚这是否可以，但无论如何我都会回答：

这是我机器上原始代码的典型输出：

```
00:00:01.7835426
0:  0
A:  723
B:  223
AB: 77
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

这是我建议的典型输出，比原始代码慢约 20%，但它捕获了更多的“AB”消息：

```
00:00:02.1322512
0:  0
A:  701
B:  201
AB: 99
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

MessageWrapper 实现：

```
public class MessageWrapper
{
    private BlockingCollection<int?> messageA = new BlockingCollection<int?>();
    private BlockingCollection<int?> messageB = new BlockingCollection<int?>();

    public Message WrapA(int a, int millisecondsTimeout)
    {
        messageA.Add(a);
        return CreateMessage(0);
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        messageB.Add(b);
        return CreateMessage(millisecondsTimeout);
    }

    private Message CreateMessage(int timeout)
    {
        int? a, b;

        if (messageB.TryTake(out b) | messageA.TryTake(out a, timeout))
        {
            return new Message(a, b);
        }
        else
        {
            return null;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T15:52:25.090

好的，所以我尝试创建一个快速 A 和 AB，然后创建一个慢 B。这意味着我的整体时间较慢（主要是因为 b-only 流），但组合时间和 a-only 时间更快。结果如下：

```
A's only: 00:00:00.3975499
Combine: 00:00:00.4234934
B's only: 00:00:02.0079422
Total: 00:00:02.8314751
0:  0
A:  700
B:  200
AB: 100
Generated A: 800, Sent A: 800
Generated B: 300, Sent B: 300 
```

这是代码：

```
 class MessageWrapper
    {
        object bMessageLock = new object();
        object pendingBLock = new object();
        int? pendingB;

        ManualResetEvent gateOpen = new ManualResetEvent(true); // Gate is open initially.

        private bool IsGateOpen()
        {
            return gateOpen.WaitOne(0);
        }

        private void OpenGate()
        {
            gateOpen.Set();
        }

        private void CloseGate()
        {
            gateOpen.Reset();
        }

        public Message WrapA(int a, int millisecondsTimeout)
        {
            // check if the gate is open. Use WaitOne(0) to return immediately.
            if (IsGateOpen())
            {
                return new Message(a, null);
            }
            else
            {
                // This extra lock is to make sure that we don't get stale b's.
                lock (pendingBLock)
                {
                    // and reopen the gate.
                    OpenGate();

                    // there is a waiting b
                    // Send combined message
                    var message = new Message(a, pendingB);

                    pendingB = null;

                    return message;
                }
            }
        }

        public Message WrapB(int b, int millisecondsTimeout)
        {

            // Remove this if you don't have overlapping B's
            var timespentInLock = Stopwatch.StartNew();

            lock (bMessageLock) // Only one B message can be sent at a time.... may need to fix this.
            {
                pendingB = b;

                // Close gate
                CloseGate();

                // Wait for the gate to be opened again (meaning that the message has been sent)
                if (timespentInLock.ElapsedMilliseconds < millisecondsTimeout && 
                    gateOpen.WaitOne(millisecondsTimeout - (int)timespentInLock.ElapsedMilliseconds)) 
                // If you don't have overlapping b's use this clause instead.
                //if (gateOpen.WaitOne(millisecondsTimeout)) 
                {
                    lock (pendingBLock)
                    {
                        // Gate was opened, so combined message was sent.
                        return null;
                    }
                }
                else
                {
                    // Timeout expired, so send b-only message.
                    lock (pendingBLock)
                    {
                        // reopen gate.
                        OpenGate();
                        pendingB = null;
                        return new Message(null, b);
                    }
                }
            }
        }

    } 
```

主要工作是使用手动重置事件完成的。这个想法是，如果门是打开的，那么你可以自由地发送 A。当“b”到达时，您关闭门并强制 A 将其合并。我必须说，拥有一个`pendingB`字段会在一定程度上限制此操作。只有一个变量意味着只有一个线程可以将它的 b 存储在 pendingB 中。这就是为什么我有多余的`bMessageLock`.

此外，需要控制对该变量的访问，因此`pendingBLock`.

这段代码中可能仍然存在错误，但就我的测试而言，我仍然得到了所有 100 条消息的组合。

最后，我对 WrapB 等待的时间进行了检查。最初 WrapB 只需要排队 200 秒。如果您有重叠的电话，那么您可以添加检查。如果您不介意他们排队，请改用更简单的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-25T20:08:53.077

我将给出另一个更严格地遵循给定约束的建议；在我的机器上，此实现在运行测试程序时始终捕获 97 条或更多“AB”消息，与原始代码相比，性能下降了约 5%：

```
class MessageWrapper
{
    object gate = new object();
    int? pendingB;

    public Message WrapA(int a, int millisecondsTimeout)
    {
        Message returnMessage = null;
        bool lockTaken = false;

        Monitor.TryEnter(gate, 100, ref lockTaken);

        if (lockTaken)
        {
            returnMessage = new Message(a, pendingB);

            pendingB = null;
            Monitor.Pulse(gate);

            Monitor.Exit(gate);
        }
        else
        {
            returnMessage = new Message(a, null);
        }

        return returnMessage;
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        Message returnMessage = null;
        bool lockTaken = false;

        Monitor.TryEnter(gate, 100, ref lockTaken);

        if (lockTaken)
        {
            if (pendingB != null)
            {
                Monitor.Wait(gate, 100);
            }

            if (pendingB != null)
            {
                returnMessage = new Message(null, b);
            }
            else
            {
                pendingB = b;

                if (!Monitor.Wait(gate, millisecondsTimeout))
                {
                    pendingB = null;
                    Monitor.Pulse(gate);
                    returnMessage = new Message(null, b);
                }
            }

            Monitor.Exit(gate);
        }
        else
        {
            returnMessage = new Message(null, b);
        }

        return returnMessage;
    }
} 
```

这里发生的事情与原始代码中的基本相同，但我们也在等待已经有一个*pendingB*对象，而不是仅仅返回一个“B”消息。这以很小的性能成本提高了我们可以找到的“AB”消息的数量。

它看起来有点乱，但这主要是因为我选择使用更实时友好的构造*Monitor.TryTake*而不是 raw *lock*。此外，使用单个*return语句是一个巧妙的技巧，可以避免在调用**Monitor.Exit*之前意外返回死锁。

摆弄各种超时可以以准确性为代价提高性能，反之亦然。100ms 是我最初的猜测，至少在我的机器上看起来不错。

* * *

最后一点，在*WrapB*的这个实现中，我们可以更改行

```
 if (pendingB != null)
            {
                Monitor.Wait(gate, 100);
            } 
```

至

```
 while (pendingB != null)
            {
                Monitor.Wait(gate, 100);
            } 
```

获得 100% 的准确率，但它严重扰乱了测试程序的指标，因为它同步了“B”事件，当只有“B”消息流时，这显然表现极差。

如果我删除*t3*测试，它的运行*速度*比原始代码快约 5%，同时始终在 100 条“AB”消息中找到 100 条。但是，运行时当然不再是确定性的，因为我们无法确定我们将围绕循环旋转多少次。

编辑：

好吧，除非我们做类似的事情

```
 int spinCount = 0;

            while (pendingB != null && spinCount < 5)
            {
                spinCount++;
                Monitor.Wait(gate, 100);
            } 
```

这将为我们提供等待时间的上限。当我们只有“B”消息流时，它确实解决了性能问题，并且运行时间与原始代码大致相同，同时始终在 100 条“AB”消息中找到 100 条。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T23:29:51.413

似乎是[Reactive Extesions](http://msdn.microsoft.com/en-us/data/gg577609.aspx)的完美候选人。您可以使用[Buffer](http://msdn.microsoft.com/en-us/library/hh229308%28v=VS.103%29.aspx)方法对事件进行分组或其他类似的扩展来过滤和组合事件。

也许这个解决方案不符合您的限制之一，但在我看来这是最好的解决方案。反应式扩展非常强大。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-24T01:08:38.417

Great problem. I really enjoyed spending some time on this. The solution that I used had 4 times the amount of matches that your original problem resulted with on my computer hardware.

Perhaps someone that is more knowledgeable than I am with Monitor and locks can improve this.

1.  Release another thread when a match is made instead of having that thread do a full sleep just to return null in the end. Perhaps this really is not that costly though. To solve this I introduced the AutoResetEvent, but for reasons that I do not understand, the AutoResetEvent is not acting as I intended and reduces the matches from 100 to 70.

2.  The final timeout of threads can be improved since once it times out it still needs to pass a contested lock.

It does fully fit the requirements:

1.  All processes will terminate within the specified period of time (The last lock may add a few cycles depending on how contested the lock is).
2.  Sending is outside of the locks.
3.  Synchronizes using gate
4.  No extra timers
5.  Preference and threads are treated equally

Original Questions Results:

1.  Time: 4.5 seconds
2.  A: 773
3.  B: 273
4.  AB: 27

This Classes Results:

1.  Time: 5.4 seconds
2.  A: 700
3.  B: 300
4.  AB: 100

    ```
    class MessageWrapper
    {
    object gate = new object();
    int EmptyThreadsToReleaseA = 0;
    int EmptyThreadsToReleaseB = 0;
    Queue<int> queueA = new Queue<int>();
    Queue<int> queueB = new Queue<int>();
    AutoResetEvent EmptyThreadEventA = new AutoResetEvent(false);
    AutoResetEvent EmptyThreadEventB = new AutoResetEvent(false);

    public Message WrapA(int a, int millisecondsTimeout)
    {
        lock (gate)
        {
            if (queueB.Count > 0)
            {
                Interlocked.Increment(ref EmptyThreadsToReleaseB);
                EmptyThreadEventB.Set();
                return new Message(a, queueB.Dequeue());
            }
            else
            {
                queueA.Enqueue(a);
            }
        }

        System.Threading.Thread.Sleep(millisecondsTimeout);
        //EmptyThreadEventA.WaitOne(millisecondsTimeout);

        lock (gate)
        {
            if (EmptyThreadsToReleaseA > 0)
            {
                Interlocked.Decrement(ref EmptyThreadsToReleaseA);
                return null;
            }

            return new Message(queueA.Dequeue(), null);
        }
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        lock (gate)
        {
            if (queueA.Count > 0)
            {
                Interlocked.Increment(ref EmptyThreadsToReleaseA);
                EmptyThreadEventA.Set();
                return new Message(queueA.Dequeue(), b);
            }
            else
            {
                queueB.Enqueue(b);
            }
        }

        System.Threading.Thread.Sleep(millisecondsTimeout);
        //EmptyThreadEventB.WaitOne(millisecondsTimeout);

        lock (gate)
        {
            if (EmptyThreadsToReleaseB > 0)
            {
                Interlocked.Decrement(ref EmptyThreadsToReleaseB);
                return null;
            }

            return new Message(null, queueB.Dequeue());
        }
    }
    } 
    ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-20T17:12:10.790

这是一种提高公平性的方法的草图——这意味着*所有* `B`的发送都会受到长达 100 毫秒的延迟。但是我不知道它是否符合您的限制。

*   在全局上下文中，有一个`MessageSender`类型的对象`IMessageSender`
*   有两种实现`IMessageSender`，即`DefaultMessageSender`，和`BWrappingMessageSender`（存储一个`b`值）

消息发送者的行为如下：

*   `DefaultMessageSender`在被要求发送一个`A`: 只是发送它
*   `DefaultMessageSender`在被要求发送一个`B`: 将全局切换`MessageSender`为一个新的`BWrappingMessageSender`，它知道刚刚传递的值`b`

*   `BWrappingMessageSender`在被要求发送一个`A`: 发送一个带有传递的 AB`a`和它自己的 AB `b`，并将全局切换`MessageSender`为`DefaultMessageSender`

*   `BWrappingMessageSender`在被要求发送 a时`B`：发送`B`带有自己的a `b`，并将全局切换`MessageSender`为新的`BWrappingMessageSender`，它知道刚刚传递的值`b`

我没有确定的是一个新创建的`BWrappingMessageSender`知道在创建后发送一个简单的`B`100 毫秒的方式，如果它在那段时间没有被告知做任何其他事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-20T19:52:04.440

经过一些实验，这是我的解决方案：

*   如果单元素队列是空的，我们就占位。
*   如果该位置已被占用，我们会礼貌地推动乘员继续前进，稍等片刻再试一次。
*   如果有人粗鲁并在我们等待时劫持了现场，我们会插队继续前进。

*代码：*

```
Message WrapA(int a, int millisecondsTimeout)
{
    bool lockTaken = false;
    int? b = null;

    try
    {
        Monitor.TryEnter(gate, millisecondsTimeout, ref lockTaken);
        if (lockTaken)
        {
            if (pendingB != null)
            {
                b = pendingB;
                pendingB = null;
                Monitor.Pulse(gate);
            }
        }
    }
    finally
    {
        if (lockTaken)
        {
            Monitor.Exit(gate);
        }
    }

    return new Message(a, b);
}

Message WrapB(int b, int millisecondsTimeout)
{
    bool lockTaken = false;

    try
    {
        TimeoutHelper timeout = new TimeoutHelper(millisecondsTimeout);
        Monitor.TryEnter(gate, timeout.RemainingTime(), ref lockTaken);
        if (lockTaken)
        {
            if (pendingB == null)
            {
                pendingB = b;
                Monitor.Wait(gate, timeout.RemainingTime());
                if (pendingB == null) return null;
                pendingB = null;
            }
            else
            {
                Monitor.Pulse(gate);
                try { }
                finally { lockTaken = false; Monitor.Exit(gate); }
                Thread.Sleep(1);
                Monitor.TryEnter(gate, timeout.RemainingTime(), ref lockTaken);
                if (lockTaken)
                {
                    if (pendingB == null)
                    {
                        pendingB = b;
                        Monitor.Wait(gate, timeout.RemainingTime());
                        if (pendingB == null) return null;
                        pendingB = null;
                    }
                }
            }
        }
    }
    finally
    {
        if (lockTaken)
        {
            Monitor.Exit(gate);
        }
    }

    return new Message(null, b);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-23T13:08:08.843

不确定它是否符合您的要求，但这是我的建议。它基本上尽可能将任何 B 消息传递给 A，并检查消息是否已发送：

```
class MessageWrapper
{
    object gate = new object();
    int? pendingB;

    public Message WrapA(int a, int millisecondsTimeout)
    {
        int? b;

        lock (gate)
        {
            b = pendingB;
            pendingB = null;
            Thread.Sleep(1); // yield. 1 seems the best value after some testing
        }

        return new Message(a, b);
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        int? bb = b;

        lock (gate)
        {
            if (pendingB == null)
            {
                pendingB = b;
                bb = null;
            }
        }

        Thread.Sleep(3);

        if (bb == null)
        {
            lock (gate)
            {
                if (pendingB != null)
                {
                    bb = pendingB;
                    pendingB = null;
                }
            }
        }
        return new Message(null, bb);
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-20T15:44:23.287

好吧，我的第一个想法是拥有一个也处理优先级的信号量，但也许这篇文章会给你更多的洞察力[.Net Mutex Question](https://stackoverflow.com/questions/3978893/net-mutex-question)

基本上，想法是有一些方法来优先考虑这两种类型的事件，以便`B`如果没有接收到类型的事件，类型的事件可以尽可能快地运行`A`。

我意识到这可能不是适合您的解决方案，因为您的第三个限制是除了 Gate 之外没有可用的同步机制，但我希望我可以为您指明正确的方向。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-23T17:01:59.707

这是另一个尝试。该方法是等待事件的生成`A`附加到`B`事件，而不是等待`B`事件附加到`A`事件。

```
object gate = new object();
int? pendingA;

public Message WrapA(int a, int millisecondsTimeout)
{
    bool queued = false;

    lock (gate)
    {
        if (pendingA == null)
        {
            queued = true;
            pendingA = a;
            Monitor.Pulse(gate);
        }
    }

    if (queued)
    {
        Thread.Sleep(3);
        lock (gate)
        {
            if (pendingA == null)
                return null;

            a = pendingA.Value;
            pendingA = null;
        }
    }

    return new Message(a, null);
}

public Message WrapB(int b, int millisecondsTimeout)
{
    int? a;

    lock (gate)
    {
        if (pendingA == null)
            Monitor.Wait(gate, millisecondsTimeout);

        a = pendingA;
        pendingA = null;
    }

    return new Message(a, b);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-26T14:21:10.343

我试图避免不必要的锁，尤其是对于 A 类型的事件。我还对包装类的逻辑进行了一些更改。我发现直接从这个类发送消息而不是只返回消息会更方便，这是因为在我的实现中，一次调用`SendB`可能会发送两条 B 消息。我在代码中添加了一些解释性注释

```
public class MessageWrapper
{
    private readonly object _gate = new object();
    private object _pendingB;

    public void SendA(int a, int millisecondsTimeout, Action<Message> send)
    {
        var b = Interlocked.Exchange<object>(ref _pendingB, null);

        send(new Message(a, (int?)b));

        // this code will just release any pending "assure that B was sent" threads.
        // but everything works fine even without it
        lock (_gate)
        {
            Monitor.PulseAll(_gate);
        }
    }

    public void SendB(int b, int millisecondsTimeout, Action<Message> send)
    {
        // needed for Interlocked to function properly and to be able to chack that exatly this b event was sent.
        var boxedB = (object)(int?)b;

        // excange currently pending B event with newly arrived one
        var enqueuedB = Interlocked.Exchange(ref _pendingB, boxedB);

        if (enqueuedB != null)
        {
            // if there was some pending B event then just send it.
            send(new Message(null, (int?)enqueuedB));
        }

        // now we have to wait up to millisecondsTimeout to ensure that our message B was sent
        lock (_gate)
        {
            // release any currently waiting threads.
            Monitor.PulseAll(_gate);

            if (Monitor.Wait(_gate, millisecondsTimeout))
            {
                // if we there pulsed, then we have nothing to do, as our event was already sent 
                return;
            }
        }

        // check whether our event is still pending 
        enqueuedB = Interlocked.CompareExchange(ref _pendingB, null, boxedB);

        if (ReferenceEquals(enqueuedB, boxedB))
        {
            // if so, then just send it.
            send(new Message(null, (int?)enqueuedB));
        }
    }
} 
```

此外，我在您的测试类中进行了一些更改，这是我在评论中提到的一个原因 - 我在所有测试线程中添加了同步事件，以防我们测试 AB 子句。此外，我已将同时运行的线程数从您的版本中的 500 个减少到 20 个（全部用于 AB 子句）。所有这些线程中的仍然调用按线程数移动（在线程 Start 方法中作为参数传递），所以我希望 test 仍然非常相关。

```
public static class Program
{
    private static int _counter0 = 0;
    private static int _counterA = 0;
    private static int _counterB = 0;
    private static int _counterAb = 0;
    private static object _lastA;
    private static object _lastB;

    private static object _firstA;
    private static object _firstB;

    public static void Main(string[] args)
    {
        var wrapper = new MessageWrapper();
        var sw = Stopwatch.StartNew();

        var threadsCount = 10;
        var a0called = 40;

        // Only A events
        var t0 = Start(threadsCount, a0called, 7, 1000, wrapper.SendA);
        Join(t0);

        var aJointCalled = 40;
        var bJointCalled = 10;

        var syncEvent = new CountdownEvent(threadsCount + threadsCount);
        _firstA = null;
        _firstB = null;
        // A and B events
        var t1 = Start(threadsCount, aJointCalled, 7, 1000, wrapper.SendA, syncEvent);
        var t2 = Start(threadsCount, bJointCalled, 19, 1000, wrapper.SendB, syncEvent);
        Join(t1);
        Join(t2);
        var lastA = _lastA;
        var lastB = _lastB;

        var b0called = 20;

        // Only B events
        var t3 = Start(threadsCount, b0called, 7, 1000, wrapper.SendB);
        Join(t3);

        Console.WriteLine(sw.Elapsed);

        Console.WriteLine("0:  {0}", _counter0);
        Console.WriteLine("A:  {0}", _counterA);
        Console.WriteLine("B:  {0}", _counterB);
        Console.WriteLine("AB: {0}", _counterAb);

        Console.WriteLine(
            "Generated A: {0}, Sent A: {1}",
            (threadsCount * a0called) + (threadsCount * aJointCalled),
            _counterA + _counterAb);
        Console.WriteLine(
            "Generated B: {0}, Sent B: {1}",
            (threadsCount * bJointCalled) + (threadsCount * b0called),
            _counterB + _counterAb);

        Console.WriteLine("First A was sent on {0: MM:hh:ss ffff}", _firstA);
        Console.WriteLine("Last A was sent on {0: MM:hh:ss ffff}", lastA);
        Console.WriteLine("First B was sent on {0: MM:hh:ss ffff}", _firstB);
        Console.WriteLine("Last B was sent on {0: MM:hh:ss ffff}", lastB);

        Console.ReadLine();
    }

    private static void SendMessage(Message m)
    {
        if (m != null)
        {
            if (m.A != null)
            {
                if (m.B != null)
                {
                    Interlocked.Increment(ref _counterAb);
                }
                else
                {
                    Interlocked.Increment(ref _counterA);
                    Interlocked.Exchange(ref _lastA, DateTime.Now);
                    Interlocked.CompareExchange(ref _firstA, DateTime.Now, null);
                }
            }
            else if (m.B != null)
            {
                Interlocked.Increment(ref _counterB);
                Interlocked.Exchange(ref _lastB, DateTime.Now);
                Interlocked.CompareExchange(ref _firstB, DateTime.Now, null);
            }
            else
            {
                Interlocked.Increment(ref _counter0);
            }
        }
    }

    private static Thread[] Start(
        int threadCount, 
        int eventCount, 
        int eventInterval, 
        int wrapTimeout, 
        Action<int, int, Action<Message>> wrap,
        CountdownEvent syncEvent = null)
    {
        var threads = new Thread[threadCount];
        for (int i = 0; i < threadCount; i++)
        {
            threads[i] = new Thread(
                (p) =>
                    {
                        if (syncEvent != null)
                        {
                            syncEvent.Signal();
                            syncEvent.Wait();
                        }

                        Thread.Sleep((int)p);

                        for (int j = 0; j < eventCount; j++)
                        {
                            int k = (((int)p) * 1000) + j;
                            Thread.Sleep(eventInterval);
                            wrap(k, wrapTimeout, SendMessage);
                        }
                    });

            threads[i].Start(i);
        }

        return threads;
    }

    private static void Join(params Thread[] threads)
    {
        foreach (Thread t in threads)
        {
            t.Join();
        }
    }
} 
```

PS 此外，感谢您提出非常有趣的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-27T02:27:59.247

对此的限制因素实际上是约束，特别是仅`gate`用于同步的要求以及无法生成任何其他计时器/线程/任务等。这最终将编程解决方案与使用`Monitor`对象联系在一起。例如，Christoffer 的解决方案虽然优雅，但在技术上使用同步，而不是`gate`封装在`BlockingCollection`. afrischke 之前列出的另一个非常创新的解决方案也使用了除`gate`.

经过大量的实验、阅读和研究，我不得不说我认为这个问题没有更好（更快？）的解决方案可以完全满足约束条件。我设法使用以下机制获得了边际性能增益。它并不漂亮，但它符合要求，至少在我的机器上平均快 1-5%；

```
object gate = new object();
ConcurrentDictionary<Guid, int> _bBag = new ConcurrentDictionary<Guid, int>();

public Message WrapA(int a, int millisecondsTimeout)
{
    Message message = null;
    int? b = null;
    lock (gate)
    {
        if (!_bBag.IsEmpty)
        {
            Guid key = _bBag.Keys.FirstOrDefault();
            int gotB = 0;
            if (_bBag.TryRemove(key, out gotB))
            {
                b = gotB;
                Monitor.PulseAll(gate);
            }
        }
    }

    message = new Message(a, b);
    return message;
}

public Message WrapB(int b, int millisecondsTimeout)
{
    Guid key = Guid.NewGuid();
    _bBag.TryAdd(key, b);
    lock (gate) { Monitor.Wait(gate, millisecondsTimeout); }
    int storedB = 0;
    if (_bBag.TryRemove(key, out storedB))
    {
        return new Message(null, b);
    }
    return null;    
} 
```

放宽`gate`要求又会提高一点速度，尤其是在不运行在调试模式下时；

```
object gate = new object();
ManualResetEvent mre = new ManualResetEvent(false /*initialState*/);
ConcurrentDictionary<Guid, int> _bBag = new ConcurrentDictionary<Guid, int>();

public Message WrapA(int a, int millisecondsTimeout)
{
    Message message = null;
    int? b = null;
    lock (gate)
    {
        if (!_bBag.IsEmpty)
        {
            Guid key = _bBag.Keys.FirstOrDefault();
            int gotB = 0;
            if (_bBag.TryRemove(key, out gotB))
            {
                b = gotB;
                Monitor.PulseAll(gate);
            }
        }
    }

    message = new Message(a, b);
    return message;
}

public Message WrapB(int b, int millisecondsTimeout)
{
    Guid key = Guid.NewGuid();
    _bBag.TryAdd(key, b);
    mre.WaitOne(millisecondsTimeout);    // use a manual reset instead of Monitor
    int storedB = 0;
    if (_bBag.TryRemove(key, out storedB))
    {
        return new Message(null, b);
    }
    return null;
} 
```

总而言之，考虑到严格的要求，我想说您已经有了一个非常精细的解决方案。我实际上希望我错了，有人找到更好的解决方案 - 这将非常有用！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-02-23T20:37:48.933

经过三个小时的尝试，我设法得到了以下结果：

```
00:00:01.8577304
0:0
答：741
乙：241
乙：59
生成 A：800，发送 A：800
生成 B：300，发送 B：300
总计：1100

```

我的方法：

**(1)**每当有消息 B（现在称为 B）并且还没有 B 等待时，它会将其放入“队列”。如果在给定的超时时间内没有其他数据包，它将发送消息。**(2)**当队列中确实有一个 B 时，它会撞掉队列中的第一个 B 并发送此消息。这是为了确保公平。正在发送的新 B 将遵循与情况 1 相同的情况（它将被排队，并在给定的时间内发送）。**（3）**当有消息A（现在称为A），并且没有待处理的B时，A会立即发送。不执行实际等待。**(4)**当发送 A 并且队列中有一个 B 时，它将从队列中“窃取”它。两条消息都被包装，并一起发送。因为 B 在另一个线程上等待发送，而 A 偷了它，我们需要一个空检查。A 将通知 B，但 B 注意到它没有要发送的内容。B 将返回空值。

要在代码中完成此操作：

```
public class MessageWrapper
{
    readonly object _gate = new object();
    int? _pendingB;

    public Message WrapA(int a, int millisecondsTimeout)
    {
        int? currentB;

        lock (_gate)
        {
            currentB = _pendingB;
            _pendingB = null;

            Monitor.Pulse(_gate); // B stolen, get rid of waiting threads
        }

        return new Message(a, currentB);
    }

    public Message WrapB(int b, int millisecondsTimeout)
    {
        lock (_gate)
        {
            if (_pendingB != null)
            {
                var currentB = _pendingB;
                _pendingB = b;

                Monitor.Pulse(_gate); // release for fairness
                Monitor.Wait(_gate, millisecondsTimeout); // wait for fairness

                return new Message(null, currentB);
            }
            else
            {
                _pendingB = b;

                Monitor.Pulse(_gate); // release for fairness
                Monitor.Wait(_gate, millisecondsTimeout); // wait for A

                if (_pendingB == null) return null;

                var currentB = _pendingB;
                _pendingB = null;
                return new Message(null, currentB);
            }
        }
    }
} 
```

# java - 如何快速验证大型应用程序的多个实现？

> ID：14983714
> 
> 赞同：0
> 
> 时间：2013-02-20T15:32:25.080
> 
> 标签：java, eclipse, unit-testing, validation, testing

我正在通过在线课程做一个爱好项目，该项目是由几组学生组成的团队完成的。该项目的源代码（大约 15k 行 java 代码）被许多学生共享。我掌握了一种这样的实现，我认为它是正确的/参考实现。我的目标是通过在添加附加功能的同时实现它们来尽快理解这些概念。但问题是概念和要求对我来说不是很清楚，参考实现也没有很好的评论。它也不包含任何测试用例。我想使用参考代码和课程资料作为学习概念并快速掌握它们的一种手段。我想将参考代码视为基线，并以我自己的方式为每个文件和函数开发代码。然而，

在这种情况下，快速验证实现（参考和我在 Eclipse 的单个项目中的实现）的好策略是什么？我如何制作或组织一个将有两个实例和测试套件/用例并执行等效检查的项目？我应该如何创建开始时非常合理的测试用例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:40:19.550

首先，我认为你需要重新考虑你的目标。编写测试以涵盖 15K 行项目中所有可能的问题将是一项……艰巨的任务。使您的任务复杂化的是您说“需求不是很清楚”——这使测试*变得*更加困难——当您不完全确定代码应该如何表现时，如何针对代码进行测试？

最好的建议是从课程中的一小部分需求开始，您认为您了解项目的目标以及您认为代码应该做什么，这可以通过一些测试用例合理地涵盖。

# firefox - 我希望 Firefox 在 pin Tabs 更改时播放声音？

> ID：14983720
> 
> 赞同：2
> 
> 时间：2013-02-20T15:32:44.550
> 
> 标签：firefox, browser, firefox-addon

当我的一个固定标签发生变化时，Firefox 可以播放一点“bing”吗？

实际上，Firefox 会突出显示标签图标，但我也想要一个声音通知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T00:09:03.997

当然！:) 您需要为此制作一个附加组件，但我可以为您提供相关详细信息。获取一个 wav 文件并将其放入您的附加`data`目录；我叫我的'ding.wav'

我采取了在低级别观看标签的方法，尽管这可能不适合您。还有另一种更高级别的方法也可以工作，我在下面添加了对其的描述。但是，此代码确实有效。

```
var {Cc, Ci, Cr} = require("chrome");

var data = require('sdk/self').data;
var tabutils = require('sdk/tabs/utils');

// utility function
function newURI(uriStr, base) {
  var ios = Cc['@mozilla.org/network/io-service;1']
                .getService(Ci.nsIIOService);
  try {
    var baseURI = base ? ios.newURI(base, null, null) : null;
    return ios.newURI(uriStr, null, baseURI);
  }
  catch (e) {
    if (e.result === Cr.NS_ERROR_MALFORMED_URI) {
      throw new Error("malformed URI: " + uriStr);
    } else if (e.result === Cr.NS_ERROR_FAILURE ||
      e.result === Cr.NS_ERROR_ILLEGAL_VALUE) {
      throw new Error("invalid URI: " + uriStr);
    }
  }
  return null;
}

// actual function
function attachToTabs() {
  tabutils.getTabs().forEach(function (tab) {
    if (tab.getAttribute('pinned') === 'true') {
      var browser = tabutils.getBrowserForTab(tab);
      browser.addEventListener('DOMTitleChanged', function() {
        try {
          var sound = Cc["@mozilla.org/sound;1"].createInstance(Ci.nsISound);
          sound.play(newURI(data.url('ding.wav')));
        } catch (e) {
          console.log(e);
        }
      } );
    }
  });  
}

// call the actual function to run on startup
attachToTabs(); 
```

此代码不会主动监视已固定的新选项卡，我将把它留给你。它仅在启动时运行一次以附加到现有的固定选项卡，因此每次固定新选项卡时都必须重新启动才能使声音正常工作。

--

与这种方法相比，您还可以采用更高级别的方法来使用标签模块并附加到固定的标签。addon-sdk[选项卡模块](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/tabs.html%20tabs%20module)提供了一种查看选项卡已固定然后附加到该选项卡的方法。连接后，您可以从内部查看选项卡内容以获取标题更改事件，然后播放您的声音。

# c# - 从事件中检索情节提要

> ID：14983725
> 
> 赞同：0
> 
> 时间：2013-02-20T15:32:53.223
> 
> 标签：c#, wpf, xaml, events, storyboard

我`Storyboard`在 XAML 中定义了一个泛型，如下所示：

```
<Storyboard Core:Key="GenericAnimation" Completed="OnStoryboardCompleted"/> 
```

在我的代码隐藏中如下：

```
m_GenericAnimation = (Storyboard)Resources["GenericAnimation"]; 
```

我的每个`Storyboard`应用程序都共享相同的`Completed`事件`OnStoryboardCompleted`。我想根据刚刚完成的动画来改变我的事件的行为（伪代码）：

```
private void OnStoryboardCompleted(object sender, EventArgs e)
{
    if (completedStoryboard == m_GenericAnimation)
        DoSomethingSpecific();

    DoSomethingCommon();
} 
```

如何`Storyboard`从发件人那里检索当前完成的内容？如何正确比较两个`Storyboard`对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:04:20.233

You can use the `Name` property on `Storyboard`:

```
<Storyboard x:Key="Storyboard1" Name="Storyboard1_Name">
    <!-- ... -->
</Storyboard>

<Storyboard x:Key="Storyboard2" Name="Storyboard2_Name">
    <!-- ... -->
</Storyboard> 
```

And then:

```
Storyboard sb1, sb2;
public MainWindow()
{
    InitializeComponent();
    sb1 = (Storyboard)Resources["Storyboard1"];
    sb2 = (Storyboard)Resources["Storyboard2"];

    sb1.Completed += storyboard_Completed;
    sb2.Completed += storyboard_Completed;
}

void storyboard_Completed(object sender, EventArgs e)
{
    string StoryBoardName = ((ClockGroup)sender).Timeline.Name;
    if (StoryBoardName == "Storyboard1_Name") { /* DoSomething(); */ }
    if (StoryBoardName == "Storyboard2_Name") { /* DoSomething(); */ }
} 
```

# python - 使用 root 安装 Setuptools - 出现 PythonPath 错误

> ID：14983730
> 
> 赞同：11
> 
> 时间：2013-02-20T15:32:58.750
> 
> 标签：python, setuptools, python-module

我已经做了虚拟python环境。当我尝试安装 setuptools 时，我得到以下信息：

```
 python setup.py install --prefix=/home/dgomez/ 
```

错误：

```
TEST FAILED: /home/dgomez//lib/python2.7/site-packages/ does NOT support .pth files
error: bad install directory or PYTHONPATH

You are attempting to install a package to a directory that is not
on PYTHONPATH and which Python does not read ".pth" files from.  The
installation directory you specified (via --install-dir, --prefix, or
the distutils default setting) was:

        /home/dgomez//lib/python2.7/site-packages/

and your PYTHONPATH environment variable currently contains:

    '' 
```

当我检查系统路径时，我收到以下输出：

```
>>> import sys
>>> import sys

/usr/lib/python27.zip
/usr/lib64/python2.7
/usr/lib64/python2.7/plat-linux2
/usr/lib64/python2.7/lib-tk
/usr/lib64/python2.7/lib-old
/usr/lib64/python2.7/lib-dynload
/usr/lib64/python2.7/site-packages
/usr/local/lib64/python2.7/site-packages
/usr/local/lib/python2.7/site-packages
/usr/lib64/python2.7/site-packages/gst-0.10
/usr/lib64/python2.7/site-packages/gtk-2.0
/usr/lib/python2.7/site-packages 
```

我该如何解决这个问题？

### 更新

我通过编辑 .bashrc 解决了这个问题，并添加了以下行：

```
PYTHONPATH="${PYTHONPATH}:/home/dgomez/lib/python2.7/site-packages/"
export PYTHONPATH 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-20T15:44:48.330

尝试将 /home/dgomez/lib/python2.7/site-packages 放入 PYTHONPATH 环境变量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-06T02:21:44.387

@amb1s1

环境变量是您的系统用来使许多程序能够轻松找到某些共享资源的快捷方式。在 Linux 环境中，这些变量是在您登录终端时为您设置的。

您可以通过在终端中输入此代码来解决此问题

```
export PYTHONPATH="/home/dgomez/lib/python2.7/site-packages" 
```

对于永久修复，您可以将这些环境变量添加到“.bashrc”或“.bash_profile”，只需在其中添加上述代码即可。每次您打开一个新终端或远程登录到服务器时，这些文件都会被执行，因此所有环境变量都是可用的。

# android - 按钮打开一个片段

> ID：14983738
> 
> 赞同：0
> 
> 时间：2013-02-20T15:33:28.103
> 
> 标签：android, listview, button, android-fragments

我需要在我的 Android 应用程序中实现片段，当按下按钮打开时。但我不确定将片段放在 XML 中的哪个位置。

交互在列表视图中，当您在列表视图中按下项目中的按钮时，该按钮将打开片段。但是我应该在 listview 行 xml 的 xml 中还是在主布局 xml 中实现片段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T17:32:42.410

首先，您应该创建一个至少具有a 的[FragmentActivity](https://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)`LinearLayout` ， 然后您应该创建两个[Fragment](https://developer.android.com/reference/android/support/v4/app/Fragment.html)，一个带有 the`ListView`及其项目，一个带有您想要做的事情。

在你的`FragmentActivity`你可以管理这两个`Fragment`交易。

仔细阅读来自 Android 开发者网站的[此链接。](https://developer.android.com/guide/components/fragments.html#Adding)它包含您需要的所有信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T13:28:03.543

我最终得出结论，在按下 listView 中的项目后打开辅助视图时使用片段是一个非常糟糕的主意。

所以我的解决方案是在列表视图中按下按钮的那一刻使用和扩展自定义视图。

# javascript - 气球iphone问题

> ID：14983753
> 
> 赞同：-2
> 
> 时间：2013-02-20T15:34:12.887
> 
> 标签：javascript, ios, local-storage

所以我有一个脚本可以为首次访问者打开一个气球。当您从 Ipad 访问该网站时，气球会显示一次，然后在 iPhone 上停止，每当您访问链接时它就会一直显示。

我在看代码，气球的东西是由这个控制的：localStorage.setItem

有任何想法吗？谢谢。

以下代码的重要部分：

```
 if ( !lastVisit ) lastVisit = now;

    // If it is expired we need to reissue a new balloon
    isExpired = isReturningVisitor && lastVisit <= now;

    if ( options.hookOnLoad ) w.addEventListener('load', loaded, false);
    else if ( !options.hookOnLoad && options.autostart ) loaded();
}

function loaded () {
    w.removeEventListener('load', loaded, false);

    if ( !isReturningVisitor ) w.localStorage.setItem('addToHome', Date.now());
    else if ( options.expire && isExpired ) w.localStorage.setItem('addToHome', Date.now() + options.expire * 60000);

    if ( !overrideChecks && ( !isSafari || !isExpired || isSessionActive || isStandalone || !isReturningVisitor ) ) return;

    var icons = options.touchIcon ? document.querySelectorAll('head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]') : [],
        sizes,
        touchIcon = '',
        closeButton,
        platform = nav.platform.split(' ')[0],
        language = nav.language.replace('-', '_'),
        i, l;

    balloon = document.createElement('div');
    balloon.id = 'addToHomeScreen';
    balloon.style.cssText += 'left:-9999px;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);position:' + (OSVersion < 5 ? 'absolute' : 'fixed'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T14:49:01.273

问题已修复。只需转到 Safari 设置中的高级并删除网站数据。

# php - PHP 中的内容控制

> ID：14983755
> 
> 赞同：2
> 
> 时间：2013-02-20T15:34:14.783
> 
> 标签：php, docx, contentcontrol

我正在尝试找到一种 api 或 php 技术，可以读取 docx 文档，删除一些 MS 内容控制值，然后重新创建相同的 docx 文档，同时保留所有 MSWord 内容和样式元素。

您可能想知道这有什么用处。例如，您可以像这样在 MSWord 中设置问题：

```
The sky is blue in colour. 
```

然后，在另一端，当在 MSWord 中查看处理过的文件时，用户只看到：

```
The Sky is      in colour. 
```

一方面，您可以将 Content Control 元素中的“蓝色”数据提取到您的数据库中。另一方面，您可以让其他最终用户在 MSWord 中查看已处理的文件，而不会显示蓝色的“答案”。多么酷啊。

我的想法一般是这样的：

**1\. 打开 MSWord 创建的 docx 文件（MSWord 2007 及更高版本）。该文件包含一些常用的 MSWord 文本和样式元素以及自定义内容控制元素（您在开发人员的 MSWord/Visual Studio 中创建的），看起来像（伪）：**

> `... some standard MS styles or runs ...`
> …… `<SdtRun> The sky is </SdtRun>`
> `<Sdt Content Control attribute: colour>`
> `<Sdt Content Control value> blue** </Sdt Content Control value>`
> `</Sdt Content Control attribute>`
> `<SdtRun> in colour.></SdtRun>`
> _

**2\. 删除内容控件元素内的*值*，同时保留该值包含的空格。**

**3\. 生成一个没有指定内容控制元素值的新MSword文档。所有常用的 MSWord 文本和样式元素都被保留。或者，新生成的 docx 可以不使用以静态文本形式保存的原始内容控制标签和空格。**

**4\. 无需应用 Content Control 绑定技术即可实现上述目标** *（在某些情况下，您宁愿不绑定 Content Control 元素，但这本身就是另一个话题）*。

挑战在于创建一个新的 MSWord docx 并保留所有标准的 MSWord 内容（文本、样式等），而不使用任何预定义的模板。我环顾四周寻找 apis，但似乎找不到任何可以读写 MSWord docx 文档的东西。我只能确定一些可以写入预制模板（例如 phpdocx）的内容。

我什至不确定上述方法是否合适，但它的要点实际上是在不破坏原始文档的内容、样式和布局的情况下从 docx 文档中删除内容控制值。我猜该解决方案可能涉及
（i）通过 XML api 定位 document.xml 本身或
（ii）通过 docx api 定位本机 docx，或
（iii）您可能希望分享的任何其他技术。

有没有人可以分享一些指针？

=======在 13 年 2 月 23 日添加了详细信息========

我想多分享一点，以便为原始问题提供背景信息。我想要实现的要点是为人们创建一种通过可编辑的 MSWord 模板将数据上传到数据库的方法。

此类使用的一个示例可能是营销研究公司希望在 MSword 中即时创建在线调查表格，上传这些表格，然后立即在线启动这些调查表格，所有这些都只需通过网页上传 MSWord Doc。在 docx 本身上，有些人可能希望在同一表单中灵活地复制和粘贴数据字段占位符（即内容控制标签），并且不受固定长度模板的显着限制。

数据绑定对于固定长度的固定布局方案来说是理想的。但是在这种情况下，最终用户将无法轻松编辑模板，因为复制-n-粘贴数据绑定标签也意味着在第 n 个复制和粘贴标签中复制相同的值（MSword 自动执行此操作）。我尝试了另一种方法，我直接解析来自 document.xml 而不是 customXml 的值，并且能够从 document.xml 中提取 sdt 节点，并通过简单地为某些内容控制标签分配含义并通过节点识别它们来重建所需的数据结构属性。

我什至能够通过“blip”节点解析图像，但我还没有从 custom.XML 中找到这样做的方法。在这种情况下，用户可以不受限制地复制内容控制标签，包括图像标签，并且仍然能够从这些标签中捕获值。

最后，有些人可能希望能够接收他们上传的原始 docx 的返回“公共”版本，去除某些“默认”内容控制值。因此，提出了上述问题。我将深入研究各种 api，例如 phpWord。同时，我希望能听到更多关于您的消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:30:27.867

好吧，您似乎没有进行足够的搜索。您可以使用[phpWord](http://phpword.codeplex.com/ "phpword")，它是一个可以读取和写入 word 文件的库。您可以浏览它的示例并遵循它们。你问的很简单。

# javascript - 由于谷歌地图，页面滚动“禁用”

> ID：14983756
> 
> 赞同：1
> 
> 时间：2013-02-20T15:34:20.090
> 
> 标签：javascript, jquery

我的网站上有导航栏，下面有一个谷歌地图，在一个 100% 宽的 div 中。当访问者来到页面并尝试向下滚动时，谷歌地图会缩小而不是向下滚动，所以我猜焦点是地图所在的 map/div 元素。任何人都可以帮我扔一些代码片段来解决这个问题吗？很多用户甚至不知道地图下面有东西，因为他们不能正常滚动。这是一个代码：

```
<body onload="initialize()">

    <header>
        <div class="wrap clearfix">

            <h1 class="logo"><a href="#" title=""><img src="assets/images/txt/logo.png"/></a></h1>
        </div>

        <nav class="main-nav" role="navigation">

            <ul class="wrap">
                <li><a href="#" title="Home">Home</a></li>
                <li><a href="#" title="About">About</a></li>
                <li><a href="#" title="Bio">Bio</a></li>
            </ul>

        </nav>

    </header>

  <div id="map_canvas" style="width:100%; height:100%"></div>

  <div class="main" role="main">

  Some webpage content here

  </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:17:59.227

初始化地图时，您可以设置一个选项以在使用鼠标滚轮时禁用缩放。

[https://developers.google.com/maps/documentation/javascript/reference#MapOptions](https://developers.google.com/maps/documentation/javascript/reference#MapOptions)

请参阅“滚轮”选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:39:42.547

您的选择是：

1.  使地图更小，这样他们就不会总是把地图放在上面。
2.  在地图上放置某种不可见的 dom 元素，这样他们的光标就不会与地图交互。（这会禁用地图上的滚动缩放等）类似于：

HTML

```
<div class="overlay"></div> 
```

CSS

```
.overlay {
height:100%;
width:100%;
position:absolute;
top:0px; /*adjust to move it down */
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T16:14:49.347

这是详细的过程。确保编辑您的 Javascript 文件，并且可以在您的浏览器中访问它！（/js/mycode.js）。只需编辑 HTML 文件，复制并粘贴（无需编辑 JS）。

HTML (/map.html):

```
<head>
   <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
   <script src="/js/mycode.js"></script>
</head>

<body>
    <div id="map-canvas" style="height:400px;"></div>
</body> 
```

Javascript（/js/mycode.js）：（**只需复制和粘贴！**）

```
if ($('#map-canvas').length) {
        var map,
            service;

        jQuery(function($) {
            $(document).ready(function() {
                var latlng = new google.maps.LatLng(26.13485, -73.87206);
                var myOptions = {
                    zoom: 16,
                    center: latlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    scrollwheel: false
                };

                map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);

                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map
                });
                marker.setMap(map);

                $('a[href="#google-map-tab"]').on('shown.bs.tab', function(e) {
                    google.maps.event.trigger(map, 'resize');
                    map.setCenter(latlng);
                });
            });
        });
    } 
```

现在编辑样式、经纬度等地图参数。给你！

# java - 使用 PhoneStateListener 设置扬声器

> ID：14983759
> 
> 赞同：0
> 
> 时间：2013-02-20T15:34:28.917
> 
> 标签：java, android

我正在使用 PhoneStateListener，因此当用户接听电话或开始通话时，扬声器将立即开启。

```
 PhoneStateListener phoneStateListener = new PhoneStateListener()
    {
        @Override
        public void onCallStateChanged(int state, String incomingNumber)
        {
            if (state == TelephonyManager.CALL_STATE_RINGING) 
            {

            } else if(state == TelephonyManager.CALL_STATE_IDLE)
            {

                AudioManager audioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);

                audioManager.setSpeakerphoneOn(false);

            } else if(state == TelephonyManager.CALL_STATE_OFFHOOK)
            {

                AudioManager audioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
                audioManager.setSpeakerphoneOn(true);
            }
            super.onCallStateChanged(state, incomingNumber);
        }
    };

    TelephonyManager mgr = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);

    if(mgr != null) 
    {
        mgr.listen(phoneStateListener, PhoneStateListener.LISTEN_CALL_STATE);
    } 
```

这是我使用的代码。在我安装果冻豆之前它工作得很好，现在我注意到它只在用户接到电话时才打开扬声器，但如果他开始打电话，它什么也不做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:42:38.723

找到了。

TelephonyManager 似乎只适用于来电。

对于传出呼叫，使用 IntentFilter 的意图 android.intent.action.NEW_OUTGOING_CALL 字符串参数创建一个广播侦听器，并且不要忘记在 AndroidMenifest 中授予 PROCESS_OUTGOING_CALLS 权限。这将起作用。每当有传出呼叫时，将在广播侦听器中调用 onReceive。

# matlab - 通过坐标 MATLAB 将向量元素分配给矩阵

> ID：14983764
> 
> 赞同：1
> 
> 时间：2013-02-20T15:34:35.700
> 
> 标签：matlab, vector, matrix, coordinates, assign

我有一个值向量，我想将其分配给 NxN 矩阵。向量值对应矩阵的下半部分，但矩阵是对称的。

问题是向量值不是按顺序排列的，而是非常混乱，我看到这种情况发生的唯一方法是通过它们在矩阵中的相应坐标来分配值。这些坐标是已知的并且可以作为不同的向量使用。

所以实际上我有：

行=

```
 1    25    26    27    28    29    30     2    37    38 ... 
```

栏=

```
 1     1     1     1     1     1     1     2     2     2 ... 
```

矢量=

```
1.2694   -0.1983    0.0574    0     0      0      0    1.2694    0      0 ... 
```

...其中值代表：k(1,1)=1.2694, k(25,1)=-0.1983,k(2,2)=0...等

我想要的结果是：K=[

```
 1.2694      k(1,2)   k(1,3)   ...
     0         0     k(2,3)     ...    
 -0.0951   -0.0261    0.3019    ...    
     .         .         .      ...
     .         .         .      ... 
     .         .         .      ... 
```

我是 matlab 的偶尔用户，而且绝对不是专业人士。这就是我认为可行的方式，因为没有其他有用的东西出来。

如果有人可以提供帮助，或者对解决此问题有其他想法，我将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:46:20.223

您可以使用它`sub2ind`来执行此操作。

```
ind = sub2ind( size(K), R,C);

K(ind) = V; 
```

# javascript - JsMockito 验证机制不起作用

> ID：14983767
> 
> 赞同：0
> 
> 时间：2013-02-20T15:34:38.197
> 
> 标签：javascript, unit-testing, mocking

JsMockito的**验证**机制对我不起作用。我的设置是我有 2 个类，Common 和 Suggestions。

```
MyNS.Common = function() {};
MyNS.Suggestions = function() {}; 
```

我在建议中设置了一个 Common 的实例。

```
MyNS.Suggestions.prototype.setCommon = function(common) {this.common = common;}; 
```

然后我使用 Common.getAdGroupId() 的返回值并使用该值调用 Suggestions.refresh()。这就是我想要测试的全部内容。

```
MyNS.Suggestions.prototype.init = function() {
    // This is mocked to return 56 as can be seen in the test above.
    var adGroupId = this.common.getAdGroupId();
    this.refresh(adGroupId);
}; 
```

完整的工作示例在小提琴上：http: [//jsfiddle.net/sbel/kqdTV/2/](http://jsfiddle.net/sbel/kqdTV/2/)。请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T00:43:45.257

你在这里有几个错误。

1.  你已经模拟了你的测试系统。您正在测试 MyNS.Suggestions，对吗？因为它是一个模拟，“init()”方法是一个空存根。您需要使用 MyNS.Suggestions 对象的真实实例。
2.  您正在调用“mockedSuggestions.setCommon(mockedCommon)”。因为“setCommon”是一个模拟方法，所以它什么也不做。如果你想引用一个模拟对象的值，你需要创建一个getter方法（“getCommon”），然后执行“when(mockedSuggestions).getCommon().thenReturn(mockedCommon);”。当然，这无关紧要，因为 Suggestions 对象首先不应该是模拟对象。

希望这可以帮助！

# apache - aar 存档中的 Jar 依赖关系

> ID：14983768
> 
> 赞同：0
> 
> 时间：2013-02-20T15:34:38.657
> 
> 标签：apache, tomcat, axis2

我正在构建一个新的 Axis2 REST 服务，它在内部使用了一些 JAXB 类。

JAXB 类嵌入在一个 Jar 文件中（我们称之为 JAXB.jar）

我的 aar 文件的架构是这样的：

**服务.aar**

*   org \ company \ **myService.class**
*   元信息\**服务.xml**
*   库\ **JAXB.jar**

在我的**myService.class**文件中，我使用它们在 Jar 文件中的包调用 JAXB 类......

但是当我启动我的服务器（Tomcat）时，我收到如下错误：

> 错误：org.apache.axis2.deployment.DeploymentException：架构生成期间发生以下错误：null ...

我还尝试将**JAXB.jar**文件移动到我的**axis2** webapp lib 文件夹中，但消息相同。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:38:10.830

我试图在我的服务方法中返回一个 JAXB 对象。我的错。

# javascript - 在其 in dom 之前创建 onClick 事件

> ID：14983770
> 
> 赞同：0
> 
> 时间：2013-02-20T15:34:40.150
> 
> 标签：javascript, html, dom, onclick

我有一个将 html 推送到数组中的函数，完成后它返回 html，并且 html 由另一个使用 jQuery 的 .html 的函数推送到 dom。

推送 html 的函数有一个参数，该参数包含一个在单击表格时应调用的方法。

但是当我尝试使用 onclick 时，它会将我的函数呈现为字符串（函数的全部内容）。

我究竟做错了什么？

```
function GenerateTapHeader(TabName, clickCallbackFunction) {
    var tmpTapHeaderHTML = new Array();

    tmpTapHeaderHTML.push('<table id="Table_' + TabName + '" class="TapHeader" onclick="' + clickCallbackFunction + '">');
    tmpTapHeaderHTML.push('<tr>');
    tmpTapHeaderHTML.push('<td></td><td></td>');
    tmpTapHeaderHTML.push('<td><span></span></td>');
    tmpTapHeaderHTML.push('<td></td>');
    tmpTapHeaderHTML.push('<td><div>' + TabName + '</div></td>');
    tmpTapHeaderHTML.push('<td></td>');
    tmpTapHeaderHTML.push('<td></td>');
    tmpTapHeaderHTML.push('</tr>');
    tmpTapHeaderHTML.push('</table>');

    return tmpTapHeaderHTML.join('');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:03:16.327

hm you cant do this because there has to be a reference in the global scope to run the onclick function say you got

```
<a oncklick="runme()">runme()</a> 
```

you would have to have the function runme present in the global scope (window) so you would have to do this (clickCallbackFunctionName must be a string containing the NAME of the function you want to call):

```
function GenerateTapHeader(TabName, clickCallbackFunctionName) {
    var tmpTapHeaderHTML = new Array();

    tmpTapHeaderHTML.push('<table id="Table_' + TabName + '" class="TapHeader" onclick="' + clickCallbackFunctionName + '();">');
    tmpTapHeaderHTML.push('<tr>');
    tmpTapHeaderHTML.push('<td></td><td></td>');
    tmpTapHeaderHTML.push('<td><span></span></td>');
    tmpTapHeaderHTML.push('<td></td>');
    tmpTapHeaderHTML.push('<td><div>' + TabName + '</div></td>');
    tmpTapHeaderHTML.push('<td></td>');
    tmpTapHeaderHTML.push('<td></td>');
    tmpTapHeaderHTML.push('</tr>');
    tmpTapHeaderHTML.push('</table>');

    return tmpTapHeaderHTML.join('');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:37:47.727

等到将表添加到 dom 之后，然后执行以下操作：

```
$('#Table_' + TabName).click(function(){
    clickCallbackFunction();
}); 
```

# twitter-bootstrap - 带下划线的 Bootstrap Pills

> ID：14983776
> 
> 赞同：2
> 
> 时间：2013-02-20T15:35:01.930
> 
> 标签：twitter-bootstrap

![改良的引导药丸](../Images/c8404fa02e385ca2e77c92e3554ca7e5.png)

是否可以使用粗下划线栏呈现引导导航药丸，与此处显示*的选项卡文本设置宽度*一样宽？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T15:50:18.823

您可以为您的导航药丸使用以下样式属性

[Jsfidlle 与 navpills](http://jsfiddle.net/2Mf5v/)

```
 .nav-pills > .active > a,.nav-pills > .active > a:hover,
   .nav-pills > li > a:hover {
    color: #000 !important;
    background-color: transparent !important;
    text-decoration: none;
   font-weight: bold;
   border-radius:0px;
   border-bottom-width: 4px;
   border-bottom-style: solid;
   border-bottom-color: #FF6600;
         }
    .nav-pills > li > a{
    border-radius:0px;
     } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-09T19:50:31.617

为带有 SASS 的 Bootstrap 4 尝试此解决方案。它添加了一种新样式 .nav-pills-underline，您可以将其应用于基本药丸。

在 sass 文件中相应地更改变量。

mynavs.scss

```
$nav-pills-underline-link-active-color: $link-color !default;
$nav-pills-underline-link-hover-color: $link-hover-color !default;

$nav-pills-underline-bg:    transparent !default;
$nav-pills-underline-active-bg:    transparent !default;
$nav-pills-underline-hover-bg:    transparent !default;

$nav-pills-underline-border-width:    3px !default;
$nav-pills-underline-border-color:    map-get($theme-colors, "secondary");

.nav-pills-underline{
  .nav-link {
    @include border-radius(0);

    &.active,
    .show > & {
      color: $nav-pills-underline-link-active-color;
      //background-color: $nav-pills-underline-active-bg;

    }
  }

  > li.nav-item {
    > a.nav-link{

      background-color: $nav-pills-underline-bg !important;

      border-bottom-width: $nav-pills-underline-border-width;
      border-bottom-style: solid;
      border-bottom-color: transparent;
    }

    > a.nav-link.active,
    > a.nav-link.active:hover,
    > a.nav-link:hover
    {
      text-decoration: none;

      border-bottom-width: $nav-pills-underline-border-width;
      border-bottom-style: solid;
      border-bottom-color: $nav-pills-underline-border-color;
    }

    // bg
    > a.nav-link.active{
      background-color: $nav-pills-underline-active-bg !important;
    }

    // color
    > a.nav-link.active:hover,
    > a.nav-link:hover
    {
      color: $nav-pills-underline-link-hover-color;
      background-color: $nav-pills-underline-hover-bg !important;

    }

  }

} 
```

哈姆勒：

```
 %ul.nav.nav-pills.nav-pills-underline
    %li.nav-item
      %a.nav-link.active{:href => "#"} Active
    %li.nav-item
      %a.nav-link{:href => "#"} Link
    %li.nav-item
      %a.nav-link{:href => "#"} Link 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-16T12:09:35.477

带有 CSS 解决方案的 Bootstrap 4：

```
.nav-pills .nav-link {
  border-radius: 0;
}

.nav-pills .nav-link.active,
.nav-link.show>.nav-link {
  color: #121212;
  text-decoration: none;
  border-bottom-width: 4px;
  border-bottom-style: solid;
  border-bottom-color: #FAA330;
  background-color: #ffffff !important;
}

.nav-pills .nav-link:not(.active) {
  background-color: #ffffff;
  color: black;
}
```

```
<div>
  <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">

    <li class="nav-item">
      <a class="nav-link active" id="pills-all-tab" data-toggle="pill" href="#pills-all" role="tab" aria-controls="pills-all" aria-selected="true">All</a>
    </li>

    <li class="nav-item">
      <a class="nav-link" id="pills-review-tab" data-toggle="pill" href="#pills-review" role="tab" aria-controls="pills-review" aria-selected="false">In review</a>
    </li>

  </ul>
  <hr style="margin-top: -16px">

</div>

<div class="tab-content" id="pills-tabContent">

  <div class="tab-pane fade show active" id="pills-all" role="tabpanel" aria-labelledby="pills-all-tab">
    All content
  </div>

  <div class="tab-pane fade" id="pills-review" role="tabpanel" aria-labelledby="pills-review-tab">
    <p>Review content</p>
  </div>

</div>
```

# java - Android - 离开活动时停止所有线程

> ID：14983777
> 
> 赞同：1
> 
> 时间：2013-02-20T15:35:06.967
> 
> 标签：java, android, multithreading, android-asynctask, android-activity

我的应用程序包含一个`Activity`启动一堆`AsyncTasks`递归函数。一切正常 - 即使我通过`back`或`home`按钮离开我的活动。

是否有一个简单的解决方案可以在离开活动时停止一切？

**编辑**

我的后台线程进行 http 调用等。通过我的日志，我可以看到线程仍在运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:42:29.267

没有直接的方法可以取消所有后台线程。

您需要调用以下方法来停止 AsyncTask 的活动的 OnStop 或 onDistroy。

```
asyncTask.stop(boolean) 
```

好吧，它不会直接阻止你 asyncTask 但在 doInBackground 方法中你需要继续检查[isCancelled](http://developer.android.com/reference/android/os/AsyncTask.html#isCancelled%28%29)值，如果它是真的，那么只需结束 doInBackground 并跳过 postExecute 以获得适当的状态返回值。这是我所知的唯一方法。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-20T16:33:20.487

您可以在活动中覆盖 onPause() 以停止线程。

所以你可以这样做：

```
@Override    
public void onPause(){
    super.onPause()
    // Stop threads here
} 
```

并在 onResume() 中重新创建它们。

# iphone - 如何让应用保存数据

> ID：14983780
> 
> 赞同：-2
> 
> 时间：2013-02-20T15:35:15.890
> 
> 标签：iphone, xcode

我制作了一个应用程序，基本上你可以在其中输入一些文本。您可以对其进行编辑，但关闭应用程序后，所有数据都会丢失。

是否有为应用程序保留数据的教程？

我如何通过存储到数据库或 plist 来保存数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T15:39:45.703

有数百个教程 - 但您还需要考虑哪种方法最适合您的应用程序。要保存少量简单的数据（例如用户设置），请使用`NSUserDefaults`. 对于更复杂的数据，您可以使用`CoreData`或 SQLite。

*   NSUserDefaults - [NSUserDefaults - tutsplus.com](http://mobile.tutsplus.com/tutorials/iphone/nsuserdefaults_iphone-sdk/)
*   核心数据 -[核心数据 - raywenderlich.com](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)
*   SQLite - [SQLite 教程 - 添加/显示/删除 - Xcode 4.5 - Youtube](http://www.youtube.com/watch?v=bC3F8a4F_KE)

* * *

**NSUserDefaults**很简单：

1.  设置对象：

    ```
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:@"Patrick" forKey:@"username"];
    [defaults synchronize]; 
    ```

2.  要检索和反对：

    ```
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSString *username = [defaults objectForKey:@"username"]; 
    ```

如果尚未设置对象，它将返回 nil 以便您可以执行`if (username == nil) {`. `NSUserDefaults`即使在更新后仍由应用程序保留。

你可以在[这里](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)阅读它的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:40:33.497

最好的核心数据教程之一： [http ://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:38:56.943

这取决于您要保存的数据（多少等）。它可能正在使用 NSUserDefault（首选用于小数据，例如用户喜欢已经打开应用程序一次，因此停止显示教程），在 .plist 中，在一个数据库（CoreData/SQL）...

# c# - 即使实体框架的 SaveChanges 出现错误，也要继续在循环中添加对象

> ID：14983784
> 
> 赞同：0
> 
> 时间：2013-02-20T15:35:19.700
> 
> 标签：c#, entity-framework

我在循环外创建了实体对象。

在循环中创建并保存模型对象，现在如果任何对象由于截断错误而未能保存，则 EF 开始在每个对象上给出错误。我认为它已经引用了内存中的对象。

代码是这样的

```
 Entity dbEntity = new Entity();
 foreach(obj in list)
 {
   try
    {
     //some changes in object
     dbEntity.AddObject(obj);
     dbEntity.SaveChanges(); //at this point error comes
     obj=null;  
    }
    catch(ex as exception)
    {

    }
 } 
```

所以说假设循环第一次运行对象保存了一切正常当第二个对象出现它有一些文本超过字段长度它现在给出错误第三次obj有更少的文本但是当`SaveChanges`它发生时它给出相同的错误截断文本因此，如果列表中有 50 个对象，则只有第一个对象被保存，如果第二个对象出现错误，则其余所有对象都给出错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:42:55.307

我同意@Deepesh 的观点，即吞下异常不是要走的路。它给你错误的原因是它`dbEntity`内部有两个列表。一种是“在内存中”并保存您的更改，另一种是实际持久化的。当您添加一个引发错误的项目时，它会阻止添加*当前在内存中的任何内容*。在这种情况下，您添加第 1 项，尝试保存并且它可以工作。您添加第 2 项并保存，但它失败了。您添加第 3 项，现在第 2项**和**第 3 项尝试保存，第 2 项再次失败，第 2 项**和**第 3 项未保存。后续循环运行也是如此。如果某事失败，也许在尝试保存下一项之前将其从 dbEntity 集合中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-06T13:59:03.360

在 catch 块中实例化一个新的上下文可能是可以接受的。

```
var context = new Context();
foreach (var obj in list)
{
    // do some stuff
    try
    {
        context.SaveChanges();
    }
    catch (Exception ex)
    {
        // do some logging operation
        context.Dispose();
        context = new Context();
    }
}
context.Dispose(); 
```

# javascript - Node.js中变量作用域的处理方法

> ID：14983787
> 
> 赞同：0
> 
> 时间：2013-02-20T15:35:27.090
> 
> 标签：javascript, node.js, scope

我正在从头开始在 Node.js 中构建一个 Web 服务器（没有快递，没有猫鼬）。我的代码（非常简化）看起来像这样：

```
var app = {};

app.config = require('./config');
app.http = require('http');
app.router = require('./router');
app.mongoDb = require('mongodb');
app.mongoClient = app.mongoDb.MongoClient;
app.mongoClient.connect(
        'mongodb://'
        + app.config.db.server + ':'
        + app.config.db.port + '/'
        + app.config.db.catalog, function(err, db) {
if (!err) {
        app.db = db;
        app.httpServer = app.http.createServer();
        app.httpServer.on('request', function(req, response) {
            req.app = app;
            req.response = response;
            req.value = {};
            app.router.main(req);
        });
        app.httpServer.listen(app.config.port);
    }
}); 
```

基本上，我在一个名为`app`. 我连接数据库并创建一个 http 服务器，然后我将其放入事件处理程序`app`的请求对象 ( ) 中。`req`我还将响应对象 ( `response`) 和空值对象 ( `value`) 放在`req`.

所以现在，如果我用 调用路由器函数`app.router.main(req)`，我只需要传递`req`给它，我仍然可以访问所有全局内容以及请求、响应和与请求相关的任何其他值。它似乎工作正常。

我对这种方法的问题是：

1.  当我需要它们时，是否有更简单的方法来获取我的所有对象？
2.  物体在各处的传递`req`会对性能产生显着的不利影响吗？
3.  这会导致与数据库连接、请求、响应或我的应用程序的任何其他部分相关的不可预见的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:45:33.283

1.  > 当我需要它们时，是否有更简单的方法来获取我的所有对象？

    *将所有东西*捆绑在一个对象下对我来说似乎不是最好的设计选择。当然，我可以接受这一点`req`，并且`res`几乎*总是*联系在一起，所以*当然*可以随意放置`req.res = res`，但是`app`？

    此外，您`app`不应该真正改变；所以你不需要*不断地*传递它；一次就足够了。

    我会考虑将接受`app`上下文的导出添加到需要它们的程序模块中。

    ```
    var app;

    module.exports = {
        init: function (_app) {
            app = _app;
        },

        something: function (req) {
           // use req, you've got app if you need it.
        }
    } 
    ```

2.  > 到处传递 req 对象会对性能产生显着的不利影响吗？

    不，没什么严重的。您只是传递对对象的引用，而不是对象本身。如果您要跟踪`reqs`持久对象（例如`app`）上的所有内容，那么您将遇到与 JavaScript 等效的内存泄漏，但这不适用于此处。

3.  > 这会导致与数据库连接、请求、响应或我的应用程序的任何其他部分相关的不可预见的问题吗？

    不是我能想到的。

    如果您*经常*需要传递上下文对象，我会仔细检查您的模块结构是否不佳，或者您的代码是否过度模块化。

* * *

FWIW，即使您没有使用 express 或 connect，查看他们的代码库并查看*他们*如何解决问题也没有错；它们都是开源的（[https://github.com/visionmedia/express](https://github.com/visionmedia/express)，[https://github.com/senchalabs/connect](https://github.com/senchalabs/connect)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:47:02.673

更简单的方法是只使用一个框架。否则，整个模块的构造函数/初始化程序。或者只是将大部分内容放在一个文件中，因为模块并不适合这种事情。

顺便说一下，整个模块的初始化程序示例如下：

```
app.router = require('./router').create(app); 
```

```
var app;

module.exports.create = function(_app) {
    app = _app;
    return module.exports;
}; 
```

不，与其他任何事情相比，传递它不会对性能产生任何明显影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:57:59.767

嗯，我几乎总是在我需要的时候需要某种 singelton，可以说你得到了：

应用程序.js

```
module.exports = exports = {
    start: function(config) {
         this.database = new database(config.database);
         this.webserver= http.createServer();
    }
 } 
```

现在你必须设置你的路线说，如果你需要你的数据库对象，也许他们每个人都有自己的文件，例如你可以做的。

```
var db = require('app.js').database; 
```

恕我直言，这很好用，让您可以在任何需要的地方访问重要的东西:)

# java - 线程问题：程序没有启动

> ID：14983788
> 
> 赞同：0
> 
> 时间：2013-02-20T15:35:30.287
> 
> 标签：java, multithreading, processing

好的，伙计们，这就是我所拥有的：我正在尝试在 Processing 中创建一个基于线程的程序。程序做的事情真的很简单，我可以处理，但是当我试图让它在一个线程中运行时，它让我很开心！

长话短说，我试过做这样的事情：

```
class supportClass{
   [All the junk.];
};
class threadClass extends Thread{
   boolean goingThread;
   [Some other junk.];
   threadClass(){
      goingThread = false;
      [Junk.]
   }
   void start(supportClass var){
      goingThread = true;
      run(var);
      goingThread = false;
   }
   void run(supportClass var){
      [Junk which does all the work!]
   }
}; 
```

这是`setup()`方法：

```
void setup(){
   [Some junk init.];
   supportClass mySupportClass = new supportClass();
   threadClass myClass = new threadClass();
   myClass.start(mySupportClass);
} 
```

所以，这里的问题有两个：

1）框架甚至不显示自己；我的意思是：程序似乎根本没有运行……；

2）我不确定我正在使用的价值赋予方法，因为`mySupportClass`.

在 StackOverflow 中搜索我没有找到任何关于在线程 [处理中] 解析值的信息，所以......我来了！

任何提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:52:21.333

@Override the superclass run() method to add your thread code. If you want to have your very own start() method with parameters, fine, but do not call run(), call start().

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T17:04:45.903

首先，您的线程将永远不会执行，因为您的重载方法`run(supportClass var)`将被 Thread 类忽略，除非您自己调用它。事实上，Thread 类期望`run`执行一个没有参数的方法。

其次，对于启动方法。在您的代码中，您提供了自己的启动方法。您没有覆盖`start`Thread 类的方法。结果，您的线程将永远不会进入可运行状态。Thread类的`start`方法将当前线程状态从一个`New`状态（刚刚创建）变为一个`Runnable`状态（通过调用run方法准备执行）。当线程处于Runnable状态时，JVM调度器可以随时选择执行。

因此，您有两件事要做（无需更改代码）：首先在`start(supportClass var)`方法中，只需调用`super.start()`使其处于可运行状态即可。并且还要删除该行`run(var)`，因为正如我所说，调用线程不是程序员的工作，而是调用 JVM 调度程序。并定义一个`run`没有参数的方法。

如果你想将参数传递给你的线程类，这取决于你的策略。如果您希望每个 SupportClass 实例有一个线程（这是最简单的），您可以在构造函数中传递它们。

我建议您阅读这些链接以获取有关线程的更多信息：

1.  [http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)
2.  [http://docs.oracle.com/javase/tutorial/essential/concurrency/](http://docs.oracle.com/javase/tutorial/essential/concurrency/)

# c++ - 如何在场景中绘制文字？

> ID：14983793
> 
> 赞同：1
> 
> 时间：2013-02-20T15:35:47.213
> 
> 标签：c++, directx, directx-9

我有一些很久以前从互联网上下载的代码，我想玩它。

所以我提取了有趣的部分，创建了一个代理 d3d9.dll 并连接到一个游戏。

现在我有一个问题，因为我找不到这两个代码片段之间的绘图*差异*，这些代码片段确定顶点是必须在屏幕上还是在游戏场景中绘制

（我的意思是，就像 - HUD 在屏幕上，你总是能看到它，而车辆在游戏场景中，当你转身时你看不到它）。

第一段是我要编辑的代码，我想让它在游戏场景中显示文本，而不是作为静态文本在屏幕上显示。

DLL中使用的代码是这样的：

```
float                   m_fTexCoords[224][4];

float CD3DFont::DrawLength ( const char *szText ) const
{
    float   len = 0.0f;
    float   sub = ( m_dwCreateFlags & FCR_BORDER ) ? 2.0f : 0.0f;

    for ( const char *p = szText; *p; p++ )
    {
        int c = *(unsigned char *)p - 32;
        if ( c >= 0 && c < 224 )
            len += ( (m_fTexCoords[c][2] - m_fTexCoords[c][0]) * m_texWidth - sub ) - m_chrSpacing * 2;
    }

    return len;
}

HRESULT CD3DFont::Print ( float x, float y, DWORD color, const char *szText)
{
    if ( !m_isReady )
        return E_FAIL;

    float   strWidth = DrawLength( szText );

    x -= (float)m_chrSpacing;

    if ( FAILED(this->BeginRender()) )
        return E_FAIL;

    DWORD   fvf;
    m_pD3Ddev->GetFVF( &fvf );
    m_pD3Ddev->SetFVF( D3DFVF_BITMAPFONT );
    m_pD3Ddev->SetTexture( 0, m_pD3Dtex );
    m_pD3Ddev->SetStreamSource( 0, m_pD3Dbuf, 0, sizeof(d3dvertex_s) );

    while ( *szText )
    {
        UINT        usedTriangles = 0;
        d3dvertex_s *pVertex;

        if ( FAILED(m_pD3Dbuf->Lock(0, 0, (void **) &pVertex, D3DLOCK_DISCARD)) )
        {
            m_pD3Ddev->SetFVF( fvf );
            this->EndRender();
            return E_FAIL;
        }

        for ( ; *szText; szText++ )
        {
            int c = *(unsigned char *)szText - 32;
            if ( !(c >= 0 && c < 224) )
                continue;

            float   tx1 = m_fTexCoords[c][0];
            float   tx2 = m_fTexCoords[c][2];
            float   ty1 = m_fTexCoords[c][1];
            float   ty2 = m_fTexCoords[c][3];
            float   w = ( tx2 - tx1 ) * m_texWidth;
            float   h = ( ty2 - ty1 ) * m_texHeight;

            *pVertex++ = Init2DVertex( x - 0.5f, y - 0.5f, color, tx1, ty1 );           //topleft
            *pVertex++ = Init2DVertex( x + w - 0.5f, y - 0.5f, color, tx2, ty1 );       //topright
            *pVertex++ = Init2DVertex( x - 0.5f, y + h - 0.5f, color, tx1, ty2 );       //bottomleft
            *pVertex++ = Init2DVertex( x + w - 0.5f, y - 0.5f, color, tx2, ty1 );       //topright
            *pVertex++ = Init2DVertex( x + w - 0.5f, y + h - 0.5f, color, tx2, ty2 );   //bottomright
            *pVertex++ = Init2DVertex( x - 0.5f, y + h - 0.5f, color, tx1, ty2 );       //bottomleft
            if ( m_dwCreateFlags & FCR_BORDER )
                w -= 2.0f;

            x += w - ( m_chrSpacing * 2 );

            usedTriangles += 2;
            if ( usedTriangles >= m_maxTriangles )
                break;
        }

        if ( usedTriangles > 0 )
        {
            m_pD3Dbuf->Unlock();
            m_pD3Ddev->DrawPrimitive( D3DPT_TRIANGLELIST, 0, usedTriangles );
        }
    }

    m_pD3Ddev->SetFVF( fvf );
    this->EndRender();

    return S_OK;
} 
```

然后我看到了一个名为“DrawLine”的函数，所以我决定去看看它是做什么的，它在游戏世界中画了一条线，而不是屏幕上的一条静态线，所以当我转身时，不要查看具体位置 - 我不会看到这条线：

```
bool CD3DRender::DrawLine ( const D3DXVECTOR3 &a, const D3DXVECTOR3 &b, DWORD dwColor )
{
    if ( FAILED(CD3DBaseRender::BeginRender()) )
        return false;

    ////////////////////////////////////////////////////
    // Make sure we have a valid vertex buffer.
    if ( m_pD3Dbuf == NULL )
    {
        return false;
    }

    m_pD3Ddev->SetTextureStageState( 0, D3DTSS_COLOROP, D3DTOP_SELECTARG2 );
    m_pD3Ddev->SetTextureStageState( 0, D3DTSS_ALPHAOP, D3DTOP_SELECTARG2 );
    //m_pD3Ddev->SetTextureStageState( 0, D3DTSS_COLORARG2, D3DTA_DIFFUSE );
    //m_pD3Ddev->SetTextureStageState( 0, D3DTSS_ALPHAARG2, D3DTA_DIFFUSE );

    m_pD3Ddev->SetRenderState( D3DRS_CLIPPING, false );
    m_pD3Ddev->SetRenderState ( D3DRS_ZENABLE, false );
    //m_pD3Ddev->SetRenderState ( D3DRS_LIGHTING, false );
    D3DLVERTEX  lineList[2];

    //////////////////////////////////////////////////
    // Lock the vertex buffer and copy in the verts.
    m_pD3Dbuf->Lock( 0, 0, (void **) &lineList, D3DLOCK_DISCARD | D3DLOCK_NOSYSLOCK ); // flogs: D3DLOCK_NOSYSLOCK, D3DLOCK_DISCARD
    {
        lineList[0].x = a.x;
        lineList[0].y = a.y;
        lineList[0].z = a.z;
        lineList[0].color = dwColor;
        lineList[0].specular = dwColor;

        lineList[1].x = b.x;
        lineList[1].y = b.y;
        lineList[1].z = b.z;
        lineList[1].color = dwColor;
        lineList[1].specular = dwColor;
    }

    m_pD3Dbuf->Unlock();

    // store FVF to restore original at the end of this function
    DWORD       fvf;
    m_pD3Ddev->GetFVF( &fvf );
    m_pD3Ddev->SetFVF( D3DFVF_LVERTEX );
    //m_pD3Ddev->SetFVF( D3DFVF_PRIMITIVES );

    ////////////////////////////////////////////////////
    // Draw!
    m_pD3Ddev->DrawPrimitiveUP( D3DPT_LINESTRIP, 1, lineList, sizeof(lineList) / 2 );

    // reset states
    m_pD3Ddev->SetTextureStageState( 0, D3DTSS_COLOROP, D3DTOP_MODULATE );
    m_pD3Ddev->SetTextureStageState( 0, D3DTSS_ALPHAOP, D3DTOP_MODULATE );
    m_pD3Ddev->SetRenderState ( D3DRS_ZENABLE, true );
    m_pD3Ddev->SetRenderState( D3DRS_CLIPPING, true );

    // restore FVF
    m_pD3Ddev->SetFVF( fvf );

    CD3DBaseRender::EndRender();

    return true;
} 
```

现在的问题是：区别在哪里？这段代码在哪里说明：

“嘿，在播放器屏幕上绘制文本并让它停留在那里”？

和

“嘿，在游戏世界里画这个，只画玩家看得见的棋子”？

谁能指出我正确的方向？或者也许如何编辑打印功能以在游戏世界中显示文本？

提前致谢。

* * *

*我想要实现的*简洁示例：**

 *Print 现在做什么（绿色框）和我想要它做什么（红色框）

（屏幕取自另一个存在此类“3d 文本”但程序是封闭源代码的游戏）： ![在此处输入图像描述](../Images/c52e0d253f00b95b2188c6fdbb84a56a.png) ![在此处输入图像描述](../Images/e7ee32688563b9121ab4ba5c69d9452c.png)

您可以看到红框中的文字位置在屏幕上发生了变化，但在游戏中没有。我也想这样做。（你也可以看到红色和蓝色的#）

DrawLine 代码已经在游戏中创建了线条，但它只是线条，而不是文本，那么最终如何发生另一个是另一个不是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:23:02.327

我只能猜测其余代码的作用。似乎该`Print`方法是在转换矩阵已设置为形成正交视图的环境中调用的，而该`DrawLine`方法使用游戏的矩阵。

但是，您不想在场景中绘制文本。这将导致文本未对齐和错误缩放。您真正想要做的是在屏幕上获取场景位置所在的位置并在那里绘制文本。您可以为此使用[D3DXVec3Project](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205516%28v=vs.85%29.aspx)函数。确保提供正确的变换矩阵。不是用于 2D 渲染的更新版本。*

# vms - 进程和子进程之间的 DCL 信息

> ID：14983794
> 
> 赞同：1
> 
> 时间：2013-02-20T15:35:47.450
> 
> 标签：vms, dcl

我正在尝试在主流程和子流程之间传递信息（了解这一切在流程中如何工作）我需要从子流程中获取信息，在这种情况下是 g_start 的值。这是我在网上看到的处理方法，如果有更好的方法请告诉我！

主文件包含

```
$ define/job/nolog g_start false
$ g_test == 6
$ spawn @test.com
$ if f$trnlnm(g_start) .eqs. true
$ then 
```

文件 test.com 包含：

```
$ If g_test .nes. 5 
$ then
$ define/job g_start true
$ endif
$ logout 
```

当运行主文件 g_test 时找不到我做错了什么，我没有让数据在主进程和子进程之间来回传递。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:47:22.313

DCL 符号 ( `g_test`) 不在进程之间共享。使用共享的逻辑名称，例如在工作表中，将起作用。

可以使用邮箱完成更高级的通信，例如传递消息。

**编辑**：为了澄清，`spawn/symbols`将导致符号在创建时被复制到子进程，但这会创建一组新的符号。然后，父进程会顺其自然，任何一个进程中的任何符号更新都会独立发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:10:41.613

我能够解决这个问题，我猜是我的错字。

文件 1：

```
$ define/job g_start false
$ g_test == 6
$ spawn @test.com
$ result = f$trnlnm("g_start")
$ write sys$output ''result'
$ if (''result' .eq. "true")
$ then 
```

文件 2：

```
$ If g_test .nes. 5 
$ then
$ define/job g_start true
$ endif
$ logout 
```

# c# - 绑定到数据源时向下滚动 DataGridView 控件会导致用户滚动停止。我怎样才能避免这种情况？

> ID：14983798
> 
> 赞同：1
> 
> 时间：2013-02-20T15:35:56.110
> 
> 标签：c#, .net, vb.net, datagridview

我有一个 DataGridView，它不断被反弹到数据源。每秒一次。由于 DGV 的工作方式，我必须在每次刷新期间手动记录和重置滚动位置、排序列和选定行。所有这些工作正常。但是，当单击并拖动滚动条时，重新绑定数据会停止滚动。

例如，如果我在 DGV 的顶部并且开始向下滚动到底部，那么在它自行停止滚动之前，我可能只会向下滚动 1/2。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:44:13.293

请查看[这个](https://stackoverflow.com/questions/378330/how-can-i-set-the-position-of-my-datagrid-scrollbar-in-my-winforms-app)（问题是针对 DataGrid，但答案是针对 DataGrid/DataGridView）

> 您实际上并不直接与滚动条交互，而是设置了 FirstDisplayedScrollingRowIndex。因此，在重新加载之前，捕获该索引，一旦重新加载，将其重置为该索引。资料来源：[Anurag Ranjhan](https://stackoverflow.com/users/884410/anurag-ranjhan)

希望这会有所帮助！玩得开心

* * *

# 编辑

根据您的评论，也许这可能会有所帮助。尝试这个...

```
 Private Declare Sub mouse_event Lib "user32" (ByVal dwFlags As Long, ByVal dx As Long, ByVal dy As Long, ByVal cButtons As Long, ByVal dwExtraInfo As Long) 
```

刷新时尝试在当前位置模拟鼠标左键单击。（向上会取消状态......这可能是一个很好的测试）

```
mouse_event(&H2, 0, 0, 0, 0) 'down
mouse_event(&H4, 0, 0, 0, 0) 'up 
```

您也许可以玩这个并让它重新创建拖动状态。记得添加对 System.Runtime.InteropServices 的引用

# google-analytics - 为什么目标完成数和漏斗转化数可能不同？

> ID：14983802
> 
> 赞同：2
> 
> 时间：2013-02-20T15:36:06.637
> 
> 标签：google-analytics, goal-tracking

我遇到了一个问题，根据我在 Google Analytics 中对目标的看法，这些数字与“目标完成概述”和“目标漏斗”数字不同。目标完成概述报告 1,973 和目标漏斗状态 595 访问者完成了漏斗。两者的转化率相同。

我最初的想法是，也许目标完成概述与每个访问者的多次浏览量和漏斗报告有关访问者的确切数量更相关，但我不确定。

有人对此有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T13:46:42.693

当您将目标的第一步设置为必需步骤时，就会发生这种情况。所需步骤仅适用于渠道，不适用于其他报告的目标完成情况。

因此，每当用户从任何会生成目标完成但不在渠道中的路径到达您的目标页面时，除非用户首先访问了您所需的步骤。

# r - 如何在条件下自行加入 data.table

> ID：14983805
> 
> 赞同：15
> 
> 时间：2013-02-20T15:36:10.553
> 
> 标签：r, join, data.table

我想在我的 data.table 中添加一个新列。此列应包含满足特定条件的所有行的另一列的总和。一个例子：我的 data.table 看起来像这样：

```
require(data.table)
DT <- data.table(n=c("a", "a", "a", "a", "a", "a", "b", "b", "b"),
             t=c(10, 20, 33, 40, 50, 22, 25, 34, 11),
             v=c(20, 15, 16, 17, 11, 12, 20, 22, 10)
             )
DT
   n  t  v
1: a 10 20
2: a 20 15
3: a 33 16
4: a 40 17
5: a 50 11
6: a 22 12
7: b 25 20
8: b 34 22
9: b 11 10 
```

对于每一行 x 和每一行 i，其中 abs(t[i] - t[x]) <= 10，我想计算

```
foo = sum( v[i] * abs(t[i] - t[x]) ) 
```

在 SQL 中，我会使用自连接来解决这个问题。在 RI 中，使用 for 循环能够做到这一点：

```
for (i in 1:nrow(DT))
    DT[i, foo:=DT[n==DT[i]$n & abs(t-DT[i]$t)<=10, sum(v * abs(t-DT[i]$t) )]]

DT
   n  t  v foo
1: a 10 20 150
2: a 20 15 224
3: a 33 16 119
4: a 40 17 222
5: a 50 11 170
6: a 22 12  30
7: b 25 20 198
8: b 34 22 180
9: b 11 10   0 
```

不幸的是，我必须经常这样做，而且我使用的桌子更大。for 循环方法有效，但速度太慢。我玩弄了 sqldf 包，没有真正的突破。我很想使用一些 data.table 魔法来做到这一点，我需要你的帮助:-)。我认为需要的是某种自连接，条件是 t 值的差异小于阈值。

**跟进：** 我有一个跟进问题：在我的应用程序中，这个加入被一遍又一遍地完成。v 发生了变化，但 t 和 n 始终相同。所以我正在考虑以某种方式存储哪些行属于一起。任何想法如何以聪明的方式做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-20T16:53:26.617

好问题。这个答案只是里卡多答案的试吃者。

理想情况下，我们希望避免大的笛卡尔自连接以提高效率。不幸的是[，范围连接（FR#203）](https://r-forge.r-project.org/tracker/?group_id=240&atid=978&func=detail&aid=203)尚未实现。同时，使用最新的 v1.8.7（未经测试）：

```
setkey(DT,n,t)
DT[,from:=DT[.(n,t-10),which=TRUE,roll=-Inf,rollends=TRUE]]
DT[,to:=DT[.(n,t+10),which=TRUE,roll=+Inf,rollends=TRUE]]
DT[,foo:=0L]
for (i in 1:nrow(DT)) {
    s = seq.int(DT$from[i],DT$to[i])
    set(DT, i, "foo", DT[,sum(v[s]*abs(t[s]-t[i]))] )
} 
```

一旦 FR#203 完成，上面的逻辑就会被内置，它应该变成一个单行：

```
setkey(DT,n,t)
DT[.(n,.(t-10,t+10),t), foo:=sum(v*abs(t-i.t))] 
```

表的第二列`i`有一个 2 列的列（表示一个*between* join）。这应该很快，因为像往常一样，`j`将对每一行进行评估，`i`而无需创建一个巨大的笛卡尔自连接表。

无论如何，这就是当前的想法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-20T16:25:29.617

尝试以下操作：

```
unique(merge(DT, DT, by="n")[abs(t.x - t.y) <= 10, list(n, sum(v.x * abs(t.x - t.y))), by=list(t.x, v.x)]) 
```

* * *

**上述行的细分**：

您可以将一个表与其自身合并，输出也将是一个 data.table。请注意，列名将被赋予一个后缀`.x`和`.y`

```
merge(DT, DT, by="n") 
```

...您可以像使用任何 DT 一样过滤和计算

```
# this will give you your desired rows
[abs(t.x - t.y), ]

# this is the expression you outlined
[ ... , sum(v.x * abs(t.x - t.y)) ]

# summing by t.x and v.x
[ ... , ... , by=list(t.x, v.x)]) ] 
```

然后最后将其全部包装`unique`以删除任何重复的行。

* * *

更新：下面的行与您的输出相匹配。这个和这个答案顶部的唯一区别是这个词`v.y`在`sum(v.y * ...)`然而`by`声明中仍然使用`v.x`。这是故意的吗？

```
unique(merge(DT, DT, by="n")[abs(t.x - t.y) <= 10, list(n, sum(v.y * abs(t.x - t.y))), by=list(t.x, v.x)]) 
```

# linux - LDAP 登录通过终端工作，但不能通过 GUI 工作

> ID：14983807
> 
> 赞同：0
> 
> 时间：2013-02-20T15:36:17.047
> 
> 标签：linux, apache, directory, ldap, xubuntu

如果你能给我一些关于我做错了什么的建议，你会让我很高兴。我一直在努力解决这个问题，没有运气，我有点绝望。

*   我在 Windows Xp 上安装了一个带有 LDAP 服务器的虚拟机。它是 Apache 目录工作室。
*   然后我有另一个虚拟机，上面有 Xubuntu。我希望它向 Apache Directory Studio 进行身份验证。
*   两台机器可以互相看到并正确执行ping操作。

**服务器部分（带有 Apache Directory Studio LDAP 服务器的 Windows XP）：**

*   服务器运行良好，我在其上创建了一个域 dc=mydomain,dc=com，上面有两个 ou，ou=People 和 ou=Groups。
*   做了一些 posixAccounts 和一些 posixGroup。选择高 uid 数（2000 年以后）以避免冲突。
*   服务器端一切正常。

**客户端部分（Xubuntu）：**

*   以 root 身份输入。
*   做过：

    apt-get 安装 libnss-ldap

*   配置了我的 LDAP 服务器的 ip（检查它，它是“pingable”）。

![LDAP 服务器 IP](../Images/915f0a167eb09f312d060d9ccb91089b.png)

*   然后进入我的域，例如：dc=mydomain,dc=com。
*   然后选择我的服务器正在运行的 LDAP 版本：

![LDAP 版本](../Images/a2733bfee64316aa4aabaebe4054e76a.png)

*   然后选择*“是”*以*“使本地根数据库管理员”*。
*   选择*“否”*到*“LDAP 数据库是否需要登录？”* .
*   然后选择LDAP服务器管理员的登录名和密码。这是 100% 确认为真实的实际登录，在 Apache Directory Studio 中检查并多次验证。

![根](../Images/334ab476bca51d9c99b188852e04c1c0.png)

*   将密码加密系统设置为“清除”。
*   好的，我知道 Apache Directory Studio 正在监听 10389 而不是 389，所以我转到 /etc/ldap.conf 并手动将端口从 389 更改为 10389（389 是默认值，GUI 不会让你改变）。
*   然后它可以工作，但只能通过终端，如果我这样做的话

    su 测试用户

它有效，因为我只在 LDAP 服务器中获得了该用户，当我与其他用户一起测试时它不起作用。getent passwd testuser 也是如此。

*   然后我想做图形登录，我关闭会话，输入凭据，但它不起作用。它可以在终端中运行，但是使用 GUI 时不行，天哪，为什么？

*   PS：是否 apt-get install nscd （为某人工作）但对我没有效果。

*   PS2：提前感谢您的时间和耐心，并考虑这个问题（这不是严格的编程问题）。
*   PS3：我创建了 /home/testuser 目录，它并没有因此而失败，因为它仍然无法通过 GUI 登录到 LDAP（但可以通过终端工作）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:07:03.650

您的问题是 GDM 尝试关注

自动创建主文件夹

只需手动编辑并在任何和设置`/etc/pam.d/common-session`之前添加以下行：`pam_ldap``pam_krb5`

```
session required        pam_mkhomedir.so umask=0022 skel=/etc/skel 
```

确保您有 gdm 条目`/etc/security/group.conf`

并在以下行`/etc/pam.d/gdm`

```
auth optional pam_group.so 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T14:46:11.623

对于使用 X 登录的用户，必须修改 /etc/pam.d/gdm 以便 GDM 使用 LDAP。就像是：

```
auth     sufficient     pam_ldap.so
auth     required       pam_nologin.so
auth     required       pam_env.so
auth     required       pam_unix_auth.so

account  sufficient     pam_ldap.so
account  required       pam_unix_acct.so

password required       pam_ldap.so

session  sufficient     pam_ldap.so
session  required       pam_unix_session.so 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T08:33:54.223

回答太晚了，但可能会帮助其他人，因为我完成了这个。

在终端使用

```
sudo nano /etc/pam.d/common-auth 
```

在底部添加这些行`auth required pam_access.so`

在这个文件中`sudo nano /etc/security/access.conf`

`-:ALL EXCEPT root (admin):ALL EXCEPT LOCAL`在底部添加这一行

有关详细信息：[使用 LDAP 验证客户端计算机](https://www.digitalocean.com/community/articles/how-to-authenticate-client-computers-using-ldap-on-an-ubuntu-12-04-vps)

谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T11:44:51.227

您应该能够执行

```
getent passwd 
```

形成命令行并显示用户是否从 LDAP 服务器返回。应该显示来自 /etc/passwd 的所有用户和来自 LDAP 的用户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-11T11:51:56.483

我有同样的问题，以上答案都没有解决它。这是我在 Ubuntu 18.04 和 kali 上完成的配置

我们需要遵循的步骤如下

1.  安装 libpam-ldap / libnss-ldap Ubuntu：

`apt-get install libpam-ldap`

卡利 Linux：

```
apt-get install libpam-ldap libnss-ldapd 
```

2.  配置 ldap 设置

    `dpkg-reconfigure libpam-ldap`

将所有设置为是并创建本地数据库：是

```
base : ou-People,dc=sqtk,dc=team

root dn : dc=admin,dc=sqtk,dc=team 
```

询问的每个选项都应该是（将数据库存储在本地是并指定 ldap 管理员用户名和密码）对于数据库内容仅使用管理员用户

3.  更改 /etc/nsswitch.conf 让 passwd 、 group 、 shadow 使用**ldap**和**netgroup**到**nis**

/etc/nsswitch.conf

```
passwd: files ldap
group: files ldap
shadow: files ldap
gshadow:        files

hosts:          files mdns4_minimal [NOTFOUND=return] dns myhostname
networks:       files

protocols:      db files
services:       db files
ethers:         db files
rpc:            db files

netgroup: nis 
```

注意：将 netgroup 更改为 nis（网络信息系统），这表示组也是从 nis 从 netgroup 中获取的，因此在下面的步骤中我们进行组映射（我的假设，不要质疑它，它有效）

现在我们可以使用以下命令验证是否可以连接到 ldap 服务器

```
ldapsearch -x -W -D 'cn=ldaptest,ou=People,dc=sqtk,dc=team' -b "" -s base 
```

3.一旦用户登录，我们需要设置创建一个主目录，这是通过使用**pam_mkhomedir.so**实现的（通过执行 find find / -name pam_mkhomedir.so 验证它是否存在，如果不存在则安装它应该是默认存在）

3.1 目前当我们运行命令时

```
pam-auth-config 
```

我们没有看到 mkhomedir 的选项（创建用户登录时需要的主目录） 3.2 要获得此选项，如果不存在以下内容，我们需要创建一个文件 /usr/share/pam-configs/mkhomedir

内容 ：

```
Name: activate mkhomedir
Default: yes
Priority: 900
Session-Type: Additional
Session:
        required                        pam_mkhomedir.so umask=0022 skel=/etc/skel 
```

3.3 现在如果我们运行命令

```
pam-auth-config 
```

我们看到了**mkhomedir**的选项，所以我们也需要选择它（我们通过使用键盘上的空格来选择选项） 3.4 要验证是否设置了 mkhomedir，我们可以`cat /etc/pam.d/common-session`归档并查看如下条目（不要手动编辑文件尝试使用 pam -auth-update only ) 它将具有如下条目

```
session required        pam_mkhomedir.so umask=0022 skel=/etc/skel 
```

4.  ldap 域到组映射

4.1 我们需要用 ldap 组技术做​​一个域映射 这个映射只不过是我们将 ldap 组名映射到本地 ldap 的组 id。

我遇到了一个问题，我曾经在本地系统上获取组 id 即 > 500 的 ldap 组，但不知何故，系统无法获取给定 id 的组名，所以我在下面进行了配置

4.2 要将本地组分配给域 (ldap) 用户，请执行以下编辑`/etc/security/group.conf`并添加如下内容

```
*;*;*;Al0000-2400;audio,cdrom,dialout,floppy 
```

4.3 为了让 pam_group 模块工作，您可以创建一个文件，如`/usr/share/pam-configs/my_groups`：

```
Name: activate /etc/security/group.conf
Default: yes
Priority: 900
Auth-Type: Primary
Auth:
        required                        pam_group.so use_first_pass 
```

现在我们通过运行来激活它

```
pam-auth-update 
```

这大致相当于`/etc/pam.d/common-auth`手动编辑并在任何 pam_ldap 和 pam_krb5 设置之前添加以下行：

```
auth    required     pam_group.so use_first_pass 
```

**重要 # 您现在应该为通过 gdm 和 ssh 登录的用户显示本地组，并且可以** **通过 # 执行 id 或组来验证这一点。**

4.4 现在我们需要验证我们是否只获得了组名和 id 使用下面的命令

```
getent group 
```

如果命令不起作用或显示验证您是否可以连接到 ldap 服务器

您还可以通过触发以下命令来验证我们是否可以从 ldap 获取用户

```
getent passwd

id <username in ldap> 
```

再次，如果上述命令中的任何一个都没有按照接受的方式执行，那么验证我们是否可以成功连接到 ldap 使用以下命令

```
ldapsearch -x -W -D 'cn=bumbum,ou=People,dc=sqtk,dc=team' -b "" -s base
-W == prompt for password
-D == User to validate 
```

5.  ldap 组被授予 sudo 访问权限 授予对 ldap 上存在的组的 sudo 访问权限，并确保用户属于您登录的同一组

    visudo % 全部=（全部）全部

如果组名是 ldaptest 则需要添加以下行

```
%ldaptest ALL=(ALL) ALL 
```

您应该能够从桌面和终端登录

（注意：要使上述工作正常工作，请为**kali Linux安装****libnss-ldapd**软件包，然后才能正常工作）

# pexpect - 在多个 pexpect 进程之间同步

> ID：14983808
> 
> 赞同：2
> 
> 时间：2013-02-20T15:36:19.307
> 
> 标签：pexpect

我正在编写一个需要同时 ssh 和 telnet 到设备的应用程序。伪代码是这样的。

```
p1 = pexpect.spawn("ssh to the device")
p1.send("run some command")
p1.expect("..")

p2 = pexpect.spawn("telnet to same device")
p2.send("run a command that can be run only through telnet")
p2.expect("..")

p1.send("run some other command")
p1.expect("..")

p2.send("run another command that can be run only through telnet")
p2.expect("..")` 
```

如果您注意到，我需要在两个 pexpect 孩子之间进行同步，以便一个接一个地运行它们。我搜索了很多，但找不到任何信息。请帮忙。谢谢

# php - 使用 PHP 和 Soap 与 Microsoft Dynamics CRM 2011 Online 交谈

> ID：14983814
> 
> 赞同：2
> 
> 时间：2013-02-20T15:36:33.737
> 
> 标签：php, soap, dynamics-crm-2011, crm, microsoft-dynamics

嗨，有谁知道使用 php 和 SOAP 与 microsoft 动态交互的简单示例。我已经阅读了一些内容，看起来他们最近更改了身份验证标头？诸如此类的示例已过时： http: [//mscrmtools.blogspot.pt/2012/08/php-to-crm-online-easy-way-to-do.html](http://mscrmtools.blogspot.pt/2012/08/php-to-crm-online-easy-way-to-do.html)

有谁知道如何让它工作？

谢谢！

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T04:44:14.520

现在有各种各样的示例，其中一些使用 SOAP 和 Office 365 身份验证系统成功连接到 CRM Online。

如果您仍在寻找解决方案，那么我已经开始在此处记录我的解决方案。 [http://crmtroubleshoot.blogspot.com.au/2013/07/dynamics-crm-2011-php-and-soap-using.html](http://crmtroubleshoot.blogspot.com.au/2013/07/dynamics-crm-2011-php-and-soap-using.html)

基本上，您需要针对返回 Office 365 身份验证所需的令牌的[https://login.microsoftonline.com/RST2.srf进行身份验证。](https://login.microsoftonline.com/RST2.srf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T00:07:46.073

你看过这篇文章吗？

[使用 Microsoft Dynamics CRM 2011 和 Microsoft Dynamics CRM Online 的 WSDL 端点](http://msdn.microsoft.com/en-us/library/gg509052.aspx)。

并不是我自己使用过它，而是文章建议您在使用非 .net 语言时使用 WSDL。

> 虽然 Microsoft Dynamics CRM 2011 和 Microsoft Dynamics CRM Online 最常见的开发风格是使用具有早期或晚期绑定类型的 SOAP 端点，但在某些情况下，您希望直接使用 Web 服务描述语言 (WSDL) 端点。这是一个轻量级端点，可以从非 .NET 语言中使用。

# java - 获取 Java Filesystem-Folder onchange 事件（如 Dropbox）

> ID：14983821
> 
> 赞同：0
> 
> 时间：2013-02-20T15:36:55.920
> 
> 标签：java, file, events, filesystems, onchange

我想同步一个像 Dropbox 这样的文件夹。如果在我的文件夹中更改了文件或文件夹，我想获得一个事件，它启动我的同步类。如何在不通过 Intervall 扫描此文件夹的情况下获得这样的事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:51:59.233

You have at least two options. You can either reinvent the wheel as Arpit suggested or you can also use the [WatchService API.](http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html)

You can find a WatchService tutorial [here](http://docs.oracle.com/javase/tutorial/essential/io/notification.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:48:16.973

一些开始为您服务：

获取所有文件的列表：`yourdir.listFiles()`

现在对于文件列表中的每个文件： `file.getLastModified()`

如果它等于当前时间或不同于`lastSynctime`（您需要在同步类中维护它）然后同步它。

# java - 使用 Mockito 进行 Powermock

> ID：14983831
> 
> 赞同：0
> 
> 时间：2013-02-20T15:37:17.030
> 
> 标签：java, android, mockito, powermock

我试图将 PowerMock 与 Mockito 一起使用，但 PowerMock.replayAll(); 和 PowerMock.verifyAll(); 在我的 Eclipse 环境中找不到。使用了这个下载链接：

```
http://code.google.com/p/powermock/downloads/detail?name=powermock-mockito-junit-1.5.zip&can=2&q= 
```

并在此处下载 EasyMock：

```
http://sourceforge.net/projects/easymock/files/EasyMock/3.1/easymock-3.1.zip/download 
```

将所有 jar 添加到我的 libs 目录（从我的构建路径中删除它）。任何人？谢谢！

![在此处输入图像描述](../Images/ad982a329aaf7c7f78eee2e8ed480597.png)

![在此处输入图像描述](../Images/da220b9a13f62616d38c56a4a8653a5f.png)

![在此处输入图像描述](../Images/4a1c8a91ea0f542a598a514a15e204f7.png)

源码Android项目和测试项目：

```
https://github.com/powder366/test
https://github.com/powder366/testtest 
```

例子。

```
package com.test

import static org.junit.Assert.*;
import org.easymock.EasyMock;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.PowerMockUtils;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
@PrepareForTest(Greeter.class)
public class MockStaticExampleTest {
    @Test
    public void mockStaticExample() throws Exception {
        String expectedGreeting = "greeting";
        String nameToGreet = "name";

        PowerMockito.mockStatic(Greeter.class);
        EasyMock.expect(Greeter.getGreeting(nameToGreet)).andReturn(expectedGreeting);
        PowerMock.replayAll();

        String actualGreeting = Greeter.getGreeting(nameToGreet);

        PowerMock.verifyAll();
        assertEquals("Expected and actual greeting did not match", expectedGreeting, actualGreeting);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:42:17.113

您不必将您的添加`jars`到`Eclipse`构建路径，但您必须将其`jars`放在`libs`文件夹内。`ADT`将尽一切努力导入它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:24:06.350

我终于下载了：

```
http://code.google.com/p/powermock/downloads/detail?name=powermock-easymock-1.5-full.jar&can=2&q= 
```

它与 PowerMock.replayAll(); 和 PowerMock.verifyAll();

# r - 从 SPSS 到 R 的 AUTORECODE

> ID：14983833
> 
> 赞同：2
> 
> 时间：2013-02-20T15:37:19.657
> 
> 标签：r, spss

我想编写一个与 SPSS 命令 AUTORECODE 相同的函数。

AUTORECODE 将字符串和数值变量的值重新编码为连续整数，并将重新编码的值放入称为目标变量的新变量中。

一开始我是这样尝试的：

```
AUTORECODE <- function(variable = NULL){
    A <- sort(unique(variable))
    B <- seq(1:length(unique(variable)))
    REC <- Recode(var = variable, recodes = "A = B")
    return(REC)
} 
```

但这会导致错误。我认为这个问题是由 A 和 B 对 recodes 论点的承诺引起的。这就是我尝试的原因

```
eval(parse(text = paste("REC <- Recode(var = variable, recodes = 'c(",A,") = c(",B,")')"))) 
```

函数内。但这不是正确的解决方案。

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T17:00:30.063

`factor`正如詹姆斯在评论中所建议的那样，可能正是您所需要的，它将它们存储为幕后的整数（如 所见`str`）并仅输出相应的标签。这也可能非常有用，因为 R 有很多命令可以适当地处理因子，例如在拟合线性模型时，它会为您生成所有“虚拟”变量。

```
> x <- LETTERS[c(4,2,3,1,3)]
> f <- factor(x)
> f
[1] D B C A C
Levels: A B C D   

> str(f)
 Factor w/ 4 levels "A","B","C","D": 4 2 3 1 3 
```

如果您确实只需要数字，请使用`as.integer`因子。

```
> n <- as.integer(f)
> n
[1] 4 2 3 1 3 
```

另一种解决方案是使用`match`，但如果您从浮点数开始，请注意浮点陷阱。 `factor`首先将所有内容转换为字符，这有效地将浮点数四舍五入到一定数量的数字，从而减少浮点陷阱的问题。

```
> match(x, sort(unique(x)))
[1] 4 2 3 1 3 
```

# java - 将 POST 发送到带有数据的 servlet

> ID：14983838
> 
> 赞同：0
> 
> 时间：2013-02-20T15:37:26.403
> 
> 标签：java, servlets, testng, smartgwt, smartclient

我已成功使用 cURL 向使用 GWT/SmartGWT 和 SmartClient 的 Java 编写的 Web 应用程序提交 POST 请求。cURL 命令如下：

```
`curl -v --header "Content-Type: application/x-www-form-urlencoded; charset=UTF-8" --header "CUSTOM-userid: ghettosamson-cURL1" -D respheaders1.txt -o response-1.txt --data _transaction=%3Ctransaction%20xmlns%3Axsi%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2F10%2FXMLSchema-instance%22%20xsi%3Atype%3D%22xsd%3AObject%22%3E%3CtransactionNum%20xsi%3Atype%3D%22xsd%3Along%22%3E16%3C%2FtransactionNum%3E%3Coperations%20xsi%3Atype%3D%22xsd%3AList%22%3E%3Celem%20xsi%3Atype%3D%22xsd%3AObject%22%3E%3CappID%3Emyapplication%3C%2FappID%3E%3CclassName%3EmyServlet%3C%2FclassName%3E%3CmethodName%3EmyMethodName%3C%2FmethodName%3E%3Carguments%20xsi%3Atype%3D%22xsd%3AList%22%3E%3Celem%3EmyDataSource%3C%2Felem%3E%3Celem%3EBIRTTemplate.rptdesign%3C%2Felem%3E%3Celem%3Ereporttype%3C%2Felem%3E%3Celem%3Ereporttype%20Data%20Set%3C%2Felem%3E%3Celem%3E1%3C%2Felem%3E%3Celem%3E%3C%2Felem%3E%3Celem%3Eghettosamson%20cURL%20Report%3C%2Felem%3E%3Celem%3ESTART_TIMESTAMP%20IS%20NOT%20NULL%20AND%20\(START_TIMESTAMP%20%26lt%3B%3D%20TO_DATE\(%26apos%3B2013-01-04%2023%3A59%3A00%26apos%3B%2C%26apos%3BYYYY-MM-DD%20HH24%3AMI%3ASS%26apos%3B\)%20OR%20START_TIMESTAMP%20IS%20NULL\)\)\)\)%0A%20%20%20%20%09%09%3C%2Felem%3E%3Celem%3E%3C%2Felem%3E%3C%2Farguments%3E%3Cis_ISC_RPC_DMI%20xsi%3Atype%3D%22xsd%3Aboolean%22%3Etrue%3C%2Fis_ISC_RPC_DMI%3E%3C%2Felem%3E%3C%2Foperations%3E%3C%2Ftransaction%3E --data isc_tnum=10 --data protocolVersion=1.0 myipaddress:myport/myapplication/myapplication/sc/IDACall?isc_rpc=1&isc_v=v8.2p_2012-08-28&isc_xhr=1 &` 
```

收到的响应写入文件，如下所示：

```
`<HTML>
<BODY ONLOAD='var results = document.formResults.results.value;null'><BR>
<BR><BR><BR>  <BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>
<FORM name='formResults'><TEXTAREA readonly name='results'>
//isc_RPCResponseStart-->[{status:0,data:"http://myipaddress:myport/myapplication
/reports/ghettosamson-cURL1.pdf"}]//isc_RPCResponseEnd</TEXTAREA></FORM>
</BODY></HTML>` 
```

我正在尝试使用 java 复制此请求并将其作为 testng 测试运行。我从这里尝试了几个不同的例子，但没有任何效果。以下是我尝试的代码示例：

```
`@Autowired @Qualifier("contentHeader")
 private Header theContentHeader; 
 @Autowired @Qualifier("userHeader")
 private Header theUserHeader;   
 @Autowired @Qualifier("transactionPair")
 private NameValuePair theTransactionPair;
 @Autowired @Qualifier("iscPair")
 private NameValuePair theIscPair;   
 @Autowired @Qualifier("protocolPair")
 private NameValuePair theProtocolPair;
 @Test
 public void testConcurrentCreateAndOpenReportRequests() 
 throws ClientProtocolException, IOException
 {
    Assert.notNull(theTestPost);
    Assert.notNull(theContentHeader);
    Assert.notNull(theUserHeader);
    Assert.notNull(theTransactionPair);      
    HttpClient httpclient = new DefaultHttpClient();
    theTestPost.addHeader(theContentHeader);
    theTestPost.addHeader(theUserHeader);      
    ArrayList<BasicNameValuePair> parameters = new ArrayList<BasicNameValuePair>();
    parameters.add(theTransactionPair);
    parameters.add(new BasicNameValuePair("isc_tnum", "10"));
    parameters.add(new BasicNameValuePair("protocolVersion", "1.0"));
    theTestPost.setEntity(new UrlEncodedFormEntity(parameters, "UTF-8"));
    HttpResponse response = httpclient.execute(theTestPost);
    HttpEntity entity = response.getEntity();      
    Assert.notNull(entity);
    InputStream instream = entity.getContent();
    System.out.println(instream.toString());
    instream.close();      
 }
 @Test
 public void testSimplePost() throws HttpException, IOException
 {
    HttpClient client = new HttpClient();
    PostMethod method = new PostMethod("http://myipaddress:myport/
    myapplication/myapplication/sc/IDACall?isc_rpc=1&isc_v=v8.2p_2012-08-28&
    isc_xhr=1");
    method.addRequestHeader(theContentHeader);
    method.addRequestHeader(theUserHeader);
    method.addParameter(theTransactionPair);
    method.addParameter("isc_tnum", "10");
    method.addParameter("protocolVersion", "1.0");
    int statuscode = client.executeMethod(method);
    if (statuscode != -1)
    {
       InputStream instream = method.getResponseBodyAsStream(); 
       System.out.println(instream);
    }
 }   
 @Test
 public void testAnomalyPost() throws IOException
 {
    String urlParameters = String.format("%s=%s&%s=%s&%s=%s", 
                                         theTransactionPair.getName(),
                                         theTransactionPair.getValue(),
                                         theIscPair.getName(),
                                         theIscPair.getValue(),
                                         theProtocolPair.getName(),
                                         theProtocolPair.getValue());
    String request = "http://myipaddress:myport/myapplication/
    myapplication/sc/IDACall?isc_rpc=1&isc_v=v8.2p_2012-08-28&isc_xhr=1";
    URL url = new URL(request); 
    HttpURLConnection connection = (HttpURLConnection) url.openConnection();           
    connection.setDoOutput(true);
    connection.setDoInput(true);
    connection.setInstanceFollowRedirects(false); 
    connection.setRequestMethod("POST"); 
    connection.setRequestProperty("Content-Type", 
   "application/x-www-form-urlencoded; charset=UTF-8");
    connection.setRequestProperty("CUSTOM-userid", "ghettosamson-testNG");
    connection.setUseCaches (false);
    DataOutputStream wr = new DataOutputStream(connection.getOutputStream ());
    wr.writeBytes(urlParameters);
    wr.flush();
    wr.close();
    connection.disconnect();
 }` 
```

# android - 仅第一个数字降序

> ID：14983843
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:37:41.897
> 
> 标签：android, sql, database

我无法想象为什么我的分数没有下降。这是仅排序的第一个数字。帮我分析这段代码并告诉我什么是错的还有答案。

```
 public String getData() {    
   Cursor c= ourDatabase.query(DATABASE_TABLE, new String[] {KEY_NAME, KEY_SCORE},  
null, null, null, null, KEY_SCORE +" DESC");
   String result = "";

int iname = c.getColumnIndex(KEY_NAME);
int iscore = c.getColumnIndex(KEY_SCORE);

for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
    result = result +  c.getString(iname) + "    "+   c.getInt(iscore)+ "\n";

 }

 return result;

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:53:30.903

The problem is probably that `KEY_SCORE` is being stored as a string and not as a number.

There is more than one way to fix this. Cast the score to an integer or float:

```
cast(Key_Score as float) desc 
```

Or, if it is an integer with no leading 0s, the following trick works:

```
len(Key_Score) desc, key_score desc 
```

However, in some databases the `len()` function might be spelled `length()` or something else.

# java - 让多个线程使用和更改同一个变量

> ID：14983847
> 
> 赞同：5
> 
> 时间：2013-02-20T15:37:49.523
> 
> 标签：java, multithreading

在我的程序中，我需要让多个线程使用和编辑同一个变量，但它似乎不起作用。这是我的意思的一个例子，这将是我的主要课程。

```
public class MainClass {

  public static int number = 0;
  public static String num = Integer.toString(number);

  public static void main(String[] args) {
    Scanner in = new Scanner(System.in);
    System.out.println("Enter number of threads.");
    int threads = in.nextInt();
    for (int n = 1; n <= threads; n++) {
      java.lang.Thread t = new Thread();
      t.start();
    }
  }
} 
```

这将是我的线程类：

```
public class Thread extends java.lang.Thread
{
  public void run()
  {
      MainClass.number++;
      System.out.println("Thread started");
      System.out.println(MainClass.num);
  }
} 
```

这段代码是我现场写的，可能会有一些错误，不过没关系。我的程序基本上需要做这样的事情，但不是每次都打印数字加 1，而是所有线程只是多次打印相同的数字 0。请帮助我，谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-20T15:40:17.937

> 在我的程序中，我需要让多个线程使用和编辑同一个变量，但它似乎不起作用......

每当多个线程更新同一个变量时，您都需要担心内存同步。线程获得高性能的方法之一是因为每个线程都使用本地 CPU 内存缓存，因此可能正在处理过时的变量副本。您需要使用`synchronized`or`volatile`关键字来强制线程的缓存将任何更新写入中央存储或从中央更新其缓存。

尽管这会处理内存同步，但它不一定能保护您免受竞争条件的影响。同样重要的是要意识到这`++`实际上是 3 个操作：获取当前值，递增它，然后再次存储它。如果多个线程尝试执行此操作，则存在可能导致操作丢失的[线程竞争条件。](http://en.wikipedia.org/wiki/Race_condition#Software)`++`

在这种情况下，您应该使用`AtomicInteger`包装`volatile int`字段的类。它为您提供`incrementAndGet()`了以线程安全方式递增该字段的方法。

```
public static AtomicInteger number = new AtomicInteger(0);
...
MainClass.number.incrementAndGet(); 
```

然后多个线程可以安全地递增同一个变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-15T12:30:19.447

干得好...

```
 import java.util.Scanner;
    import java.util.concurrent.atomic.AtomicInteger;

    public class UpdateVariables
    {
        static int num = 0;
        public static AtomicInteger  atomicInteger = new AtomicInteger(num);

        @SuppressWarnings("resource")
        public static void main(String args[])
        {
            Scanner userInput = new Scanner(System.in);
            System.out.println("Enter Number of Threads: ");
            int getThreadNumber = userInput.nextInt();
            for(int i = 0; i < getThreadNumber; i++)
            {
                PrintThread p = new PrintThread();
                p.start();
            }

        }

    }

    class PrintThread extends Thread
    {
        public void run()
        {
            System.out.println("Thread Started: ");
            System.out.println(UpdateVariables.atomicInteger.incrementAndGet());

        }
    } 
```

# java - 获取异常：我的 jsp 页面上的 java.lang.NullPointerException

> ID：14983848
> 
> 赞同：0
> 
> 时间：2013-02-20T15:37:51.817
> 
> 标签：java, jsp

我正在发布我的代码，其中我得到了 java.lang.NullPointerException 异常。

```
<%@ page contentType="text/html;charset=UTF-8" %>
<%@ page errorPage="myError.jsp?from=customers.jsp" %>
<%@ page import="java.sql.*" %>
<html>
<head>
<title>Insurance Quoting System</title>
</head>
<body>
<basefont face="Arial">
<!-- JSP Declarations -->
<%! ResultSet rs = null; %>

<!-- JSP Scriptlet -->
<%
try {
Class.forName("com.mysql.mysql.Driver");
Connection db = DriverManager.getConnection("jdbc:mysql://localhost:3306/quoting","root","root");
Statement s = db.createStatement();
rs = s.executeQuery("select * from customer");
}
catch (Exception e) {
// For now, just report the error to the system log
System.out.println(e.toString());
}
%>
<!-- Template text -->
<table width="550" border="0" align="center">
<tr>
<td bgcolor="#006633">
<div align="center">
<font size="6" color="#FFFFFF">
<b>Insurance Quoting System</b>
</font>
</div>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="center"><b>Customers</b></p>
<table width="290" border="0" align="center">
<%
try {
while (rs.next()) {
%>
<!-- JSP Expressions used within template text -->
<tr>
<td width="20"><%= rs.getInt(1) %></td>
<td width="70"><%= rs.getString(2) %></td>
<td width="70"><%= rs.getString(3) %></td>
<td width="40">
<a href="custMaint.jsp?id=<%= rs.getString(1) %>&action=edit">
edit
</a>
</td>
<td width="40">
<a href="custMaint.jsp?id=<%= rs.getString(1) %>&action=delete">
delete
</a>
</td>
<td width="40">
<a href="custMaint.jsp?id=<%= rs.getString(1) %>&action=newQuote">

new quote
</a>
</td>
</tr>
<%
}
}
catch (SQLException e) {
// For now, just report the error to the system log
System.out.println(e.toString());
}
%>
</table>
</td>
</tr>
<tr>
<td>
<p>&nbsp;</p>
<p align="center"><a href="custMaint.jsp?action=add">New Customer</a></p>
</td>
</tr>
</table>
</body>
</html> 
```

我正在制作一个 jsp 页面，它在我的 jsp 页面上给出了一些错误 java.lang.NullPonterException 如果有人有，请告诉我 ans。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:43:42.183

我能想到的唯一原因是您在第一个`try-catch`块中捕获了一个异常，然后尝试使用`ResultSet`它，就好像它已被初始化一样，但它仍然为空，所以您得到了 NPE。检查您的数据库操作是否正常工作。

# grails - 从 groovy 中的对象列表中收集值

> ID：14983850
> 
> 赞同：1
> 
> 时间：2013-02-20T15:37:53.233
> 
> 标签：grails, groovy, grails-orm

我有这样的方法

```
static getList (long colorid) {
     ColorShades.findAll 'from ColorShades where color.id = :colorid', [colorid: colorid]
} 
```

我这样使用它：

```
def shadeIdsForAColor = ColorShades.getList(colorid as long) 
```

**问题**

该方法返回一个`ArrayList`对象`ColorShade`，每个对象都有一个`shadeId`。

我该怎么做才能将这些 id 作为整数列表放入`shadeIdsForAColor`变量中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:41:03.433

这不行吗？

```
def shadeIdsForAColor = ColorShades.getList(colorid as long).shadeId 
```

# asp.net - 我可以在同一服务器上托管的现有第 3 方应用程序上重复使用我的 ASP.Net 身份验证吗？

> ID：14983852
> 
> 赞同：0
> 
> 时间：2013-02-20T15:37:55.860
> 
> 标签：asp.net, silverlight, iis

我们有一个第三方数据可视化工具（用 Silverlight 编写），它托管在 IIS 中，根本不提供安全性或身份验证（即，如果您可以访问服务器并且知道 URL，您可以使用它查看它公开的所有数据ODBC 连接中的凭据）。我们已经构建了另一个应用程序，它确实根据登录用户提供了适当的身份验证和访问限制。我们当前“保护”第 3 方应用程序的解决方案是检查用户是否从我们的应用程序访问它。看来我们是通过 Referer 标头来检查 URL 的。

我想知道是否可以向管道添加一个模块，该模块使用我们现有的身份验证和权限来控制对第三方应用程序的访问（我们目前正在使用会话和表单身份验证的混合，但可能会使用声明重写）。听起来它应该可以工作，但是有没有人有尝试过这种事情的经验？陷阱？全方位的坏主意？

更新：我已经与供应商确认它只是一个带有几个页面作为入口点的 ASP.Net 应用程序，因此我应该能够添加表单身份验证。我试图让它使用共享表单cookie，但到目前为止还没有运气。我在我们的网站（localhost/MainApp）和供应商网站（localhost/Vendor）的每个 web.config 中都有这个：

```
<authentication mode="Forms">
  <forms name=".ASPXFORMSAUTH" loginUrl="Login.aspx" protection="All" timeout="20" path="/" />
</authentication>
<machineKey
  validationKey="C50B3C89CB21F4F1422FF158A5B42D0E8DB8CB5CDA1742572A487D9401E3400267682B202B746511891C1BAF47F8D25C07F6C39A104696DB51F17C529AD3CABE"
  decryptionKey="8A9BE8FD67AF6979E7D20198CFEA50DD3D3799C77AF2B72F"
  validation="SHA1"/> 
```

作为记录，这些**不是**我将在生产中使用的密钥，而是取自 MSDN 示例。

我已经更新了供应商的 global.asax 文件（我们已经在我们的安装程序中这样做了）以添加：

```
protected void FormsAuthentication_OnAuthenticate(object sender, FormsAuthenticationEventArgs args)
{
    System.Diagnostics.Debug.WriteLine("FormsAuthentication_OnAuthenticate");
    if (Request.Cookies[FormsAuthentication.FormsCookieName] != null)
    {
        System.Diagnostics.Debugger.Break();
        try
        {
            FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt(Request.Cookies[FormsAuthentication.FormsCookieName].Value);
            args.User = new System.Security.Principal.GenericPrincipal(new FormsIdentity(ticket), new string[0]);

            if (!args.User.Identity.IsAuthenticated)
            {
                Context.Response.Redirect("~/Error.htm");
            }
        }
        catch (Exception e)
        {
            Context.Response.Redirect("~/Error.htm?" + e.Message);
            // Decrypt method failed.
        }
    }
    else
    {
        Context.Response.Redirect("~/Error.htm?CookieNotFound");
    }    
} 
```

~~但现在我只是得到“无法验证数据”。~~从表单标签中删除域后，身份验证现在正在工作。我只需要将它从服务调用中删除，我就准备好了（是的，这确实向全世界开放了服务，或者至少向可以访问 Intranet 的每个人开放）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:18:58.457

所以你有一个 .xap 文件？您想通过表单身份验证来保护它，对吗？我建议在 IIS 中简单地为 .xap 扩展添加一个处理程序映射并将其映射到 ASP.NET。您可以更进一步，创建一个实际流式传输 .xap 文件的中间页面或处理程序。这样 - 它将受到表单身份验证的保护。以下是一些讨论（他们使用 Flash SWF 文件，但概念相同）：

[如何使用 ASP.NET 保护对 SWF 文件的访问？](https://stackoverflow.com/questions/2582701/how-to-secure-access-to-swf-file-using-asp-net)

[http://www.justskins.com/forums/file-types-not-protected-157682.html](http://www.justskins.com/forums/file-types-not-protected-157682.html)

您的 silverlight 应用程序是否也调用您托管的 Web 服务？您可能还想确保这些都是安全的。

编辑：我还刚刚注意到您将它们设置为两个单独的应用程序 - 如果 .NET 框架在两者之间相似，您应该尝试将基于 silverlight 的应用程序设置为 ASP.NET 应用程序下的子应用程序。表单身份验证设置应该以这种方式继承..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T21:12:54.763

Silverlight 需要托管在 html 文件（基于浏览器）中 - 好的，它会将其放置在某个位置，但您*可以*使用重定向到该位置，它只能由经过表单身份验证的页面访问。

您可以将登录 cookie 的要求添加到为 silverlight 应用程序提供服务的 html/aspx 页面。

# python - 如何将带有.txt扩展名的逗号sep值作为数组读入python？

> ID：14983859
> 
> 赞同：1
> 
> 时间：2013-02-20T15:38:15.970
> 
> 标签：python, r

我是生物学家，对 Python 非常陌生，在此之前，我学了一点 R。

所以我有一个非常大的文本文件（3 GB，在 R 中太大而无法处理），所有值都用逗号分隔，但扩展名是 .txt（我不知道这是否是必要的信息）。我想做的是：

将其作为对象读入python，相当于R中的数据框，去掉中间的列减小对象的大小将其写入txt文件

把剩下的带到 R。

如果你能帮助我，我会很高兴。谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:45:52.253

没有必要先进入python。你的问题看起来很像[这个问题](https://stackoverflow.com/questions/3094866/trimming-a-huge-3-5-gb-csv-file-to-read-into-r)。标记为正确答案的答案迭代地读取大文件，并创建一个新的较小的文件。其他好的替代方案是使用`sqlite`和`sqdf`包，或使用`ff`包。最后一种方法效果特别好，因为与行数相比，列数很小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T16:03:53.580

This will take minimal memory as it does not load the whole file at once.

```
import csv
with open('in.txt', 'rb') f_in, open('out.csv', 'wb') as f_out:
    reader = csv.reader(f_in)
    writer = csv.writer(f_out)
    for row in reader:
        # keep first two columns and last three columns
        writer.writerow(row[:2] + row[-3:]) 
```

Note: If using Python 3 change the file modes to `'r'` and `'w'`, respectively.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T15:39:57.867

我不熟悉 r 数据框，但`pandas`提供了将 csv 读入 pandas 数据框的[助手：](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.io.parsers.read_csv.html)

```
from pandas import read_csv    
df = read_csv('yourfile.txt')
print df
print df['Line'] 
```

如果这不是您需要的，您可以使用[`csv`](http://docs.python.org/2/library/csv.html)模块将 csv 的每一行作为 python 列表进行迭代，并将其放入您想要的任何数据结构中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T16:15:08.647

每个[CRAN](http://stat.ethz.ch/R-manual/R-devel/NEWS)（新功能和错误修复重新：开发）新的开发版本 3.0.0 应该允许 R 使用页面文件/交换。在 Windows 中，您需要将 R_MAX_MEM_SIZE 设置为适当大的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T16:39:01.260

If you insist on using a preprocessing step, using the linux command tools is a really good and fast option. If you use Linux, these tools are already installed, under Windows you'll need to first install MinGW or Cygwin. [This SO question](https://stackoverflow.com/questions/10217663/splitting-csv-file-and-excluding-column-in-output-using-bash-sed-or-awk) already provides some nice pointers. In essence you use the `awk` tool to iteratively process the text file, creating an output text file as you go. Copying form the accepted answer of the SO question I linked:

```
awk -F "," '{ split ($8,array," "); sub ("\"","",array[1]); sub (NR,"",$0); sub (",","",$0); print $0 > array[1] }' file.txt 
```

This read the file, grabs the eight column, and dumps it to a file. See the answer for more details.

# java - 如何在 Adob e Reader 中从 Android 应用程序从服务器打开 pdf

> ID：14983870
> 
> 赞同：1
> 
> 时间：2013-02-20T15:38:49.177
> 
> 标签：java, android, pdf, adobe-reader

我正在尝试从 adobe reader 中的服务器打开一个 pdf 文件。这些是我可以在其他应用程序中查看的有效 pdf。以下代码给了我一条消息，说“无法打开文档”有什么想法吗？

```
 PackageManager pm = getPackageManager();
    Intent intent = pm.getLaunchIntentForPackage("com.adobe.reader");
    intent.setDataAndType(Uri.parse(documents.get(position).getPdf_url()), "application/pdf");
    startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:48:18.437

```
 Intent intent = new Intent();
            intent.setPackage("com.adobe.reader");
            intent.setDataAndType(Uri.parse(doc), "application/pdf");
            startActivity(intent); 
```

上面的代码对我有用，有两种可能性，可能是您只需要有意地设置包，或者您对 doc URI 做错了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T04:18:04.547

解决方案是在外部应用程序中打开之前将 pdf 文件下载到本地内存。

# android - 使用哈希映射在 ListView 中使用 SimpleAdapter 显示图像 - Android

> ID：14983873
> 
> 赞同：3
> 
> 时间：2013-02-20T15:38:59.523
> 
> 标签：android, android-listview, simpleadapter

我正在使用 SimpleAdapter`ListView`在 JSON 解析数据的哈希图中显示 a 。一切都很完美。如何有效地在其中添加图像`ListView`（或向 中添加图像`Map`）？将图像添加到哈希映射不会显示图像，也不会引发错误或异常！

这是我的一段代码..

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.event_list);
            // Hashmap for ListView
            inboxList = new ArrayList<HashMap<String, String>>();

            // Loading INBOX in Background Thread
            new LoadInbox().execute();
        }

        /**
         * Background Async Task to Load all INBOX messages by making HTTP Request
         * */
        class LoadInbox extends AsyncTask<String, String, String> {

            /**
             * Before starting background thread Show Progress Dialog
             * */
            @Override
            protected void onPreExecute() {
                super.onPreExecute();
                pDialog = new ProgressDialog(AllEvents.this);
                pDialog.setMessage("Loading Events ...");
                pDialog.setIndeterminate(false);
                pDialog.setCancelable(false);
                pDialog.show();
            }

            /**
             * getting Inbox JSON
             * */
            protected String doInBackground(String... args) {
                // Building Parameters
                List<NameValuePair> params = new ArrayList<NameValuePair>();

                // getting JSON string from URL
                JSONObject json = jsonParser.makeHttpRequest(INBOX_URL, "GET",
                        params);

                // Check your log cat for JSON reponse
                Log.d("Inbox JSON: ", json.toString());

                try {
                    inbox = json.getJSONArray(TAG_MESSAGES);
                    // looping through All messages
                    for (int i = 0; i < inbox.length(); i++) {
                        JSONObject c = inbox.getJSONObject(i);

                        // Storing each json item in variable

                        String from = c.getString(TAG_FROM);
                        String subject = c.getString(TAG_SUBJECT);
                        String date = c.getString(TAG_DATE);

                        // creating new HashMap
                        HashMap<String, String> map = new HashMap<String, String>();

                        picture = String.valueOf(R.drawable.ic_launcher);
                        // adding each child node to HashMap key => value

                        map.put(TAG_PIC, picture);
                        map.put(TAG_FROM, from);
                        map.put(TAG_SUBJECT, subject);
                        map.put(TAG_DATE, date);

                        // adding HashList to ArrayList
                        inboxList.add(map);
                    }

                } catch (JSONException e) {
                    e.printStackTrace();
                }

                return null;
            }

            /**
             * After completing background task Dismiss the progress dialog
             * **/
            protected void onPostExecute(String file_url) {
                // dismiss the dialog after getting all products
                pDialog.dismiss();
                // updating UI from Background Thread
                runOnUiThread(new Runnable() {
                    public void run() {
                        /**
                         * Updating parsed JSON data into ListView
                         * */
                        SimpleAdapter adapter = new SimpleAdapter(
                                AllEvents.this, inboxList,
                                R.layout.event_list_item, new String[] { TAG_PIC, TAG_FROM, TAG_SUBJECT, TAG_DATE, },
                                new int[] {  R.id.imageView1,R.id.from, R.id.subject, R.id.date });
                        // updating listview

                        setListAdapter(adapter);
                    }
                });

            }

        } 
```

SimpleAdapter 使用的布局“event_list_item.xml”如下：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <!-- From Label -->

    <ImageView
        android:id="@+id/imageView1"
         android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:contentDescription="hello"
            android:paddingTop="10dp"
            android:paddingRight="10dp"
            android:paddingBottom="10dp"   
            android:layout_toLeftOf="@+id/subject"
         />

    <TextView
        android:id="@+id/from"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:paddingTop="8dip"
        android:paddingLeft="8dip"
        android:paddingBottom="4dip"
        android:textSize="20sp"
        android:textStyle="bold" />

    <!-- Mail Subject -->
    <TextView android:id="@+id/subject"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:paddingLeft="8dip"
        android:paddingBottom="6dip"
        android:textSize="15sp"
        android:layout_below="@id/from"/>

    <!-- Mail date -->
    <TextView android:id="@+id/date"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:padding="8dip"/>

</RelativeLayout> 
```

我该怎么做才能获得像 View in a Simple Adapter 这样的惰性列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-20T04:26:07.923

图像不是字符串，所以用字符串对象替换字符串，如下所示：

```
 ArrayList<HashMap<String, object>> inboxList = new ArrayList<HashMap<String, object>>();
    HashMap<String, Object> map = new HashMap<String, Object>(); 
```

# php - 从 mysql 表中的值创建一个数组

> ID：14983877
> 
> 赞同：0
> 
> 时间：2013-02-20T15:39:13.397
> 
> 标签：php, mysql, arrays

我正在使用 PHPlot 制作图表。

我在从 MySQL 表生成数组时遇到问题。

基本上，我想要的数组如下：

```
$values = array($arrayx);
array('a',-3),
array('b',5),
array('c',7),
array('d',8),
array('e',12),
array('f',-6),
//);

$graph->SetDataValues($values);
$graph->SetXTickPos('none');
$graph->SetXTickLabelPos('none'); 
```

我尝试从表中检索值以提供数组的部分代码

```
$query="SELECT * FROM tasks";
$result=mysql_query($query);

//using a for loop to add values to the array
while ($resource=mysql_fetch_array($result)){
$thedate = $resource["date"];
$title = $resource2["title"];

$innerarray = "array('.$thedate.', $title),";

}
$values = array($innerarray).");";

$graph->SetDataValues($values);
$graph->SetXTickPos('none');
$graph->SetXTickLabelPos('none');

//Draw it
$graph->DrawGraph();
  } 
```

我做 $innerarray 和 $values 的方式似乎是错误的。你能帮我修一下吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:44:22.790

我认为这是您想要的：

```
 $sql="SELECT datefield, titlefield FROM tasks";

  ....     

  while (list($thedate,$thetitle) = mysql_fetch_array($result)) {

      $values[] = array($thedate,$thetitle);

 }

 echo $values[0][0]; // will output your 1st date
 echo $values[0][1]; // will output your 1st title 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:46:40.067

尝试更换

```
$innerarray = "array('.$thedate.', $title),"; 
```

和

```
$innerarray = array($thedate, $title);
$new = array();
while(for condition ){
$new[] = '\''.thedate[$i].''\','.$title[$i].'\';
}

var_dump($new); 
```

这是一个想法，您需要编辑代码以使其正常工作

# mysql - SQL单选修改所有wordpress帖子中的第二个字符串出现

> ID：14983879
> 
> 赞同：0
> 
> 时间：2013-02-20T15:39:38.010
> 
> 标签：mysql, database, string, wordpress

我正在尝试使用单个 SQL SELECT 语句来更新 worpress 数据库中的所有帖子内容。

对于每个单独的帖子，我需要更新在帖子正文中随机定位的特定字符串值。这个值不是唯一的，因此它在内容中出现了多次，但我只需要更新第二次出现。

下面，我有一个单独的帖子的代码，我需要一些帮助来扩展它，以便为数据库中的整个帖子表执行此操作。

```
SET @pos=2; // this is the occurrence index

SET @str := (SELECT `post_content` FROM `wp_posts` WHERE ID = 1); // this is a specific post identified by the ID

SET @search='1234'; // this is the test string I'm looking for

// 4321 is the replacement value of 1234 search sting above

// post update sql query

UPDATE `wp_posts` SET `post_content` = (SELECT CONCAT(SUBSTRING_INDEX(@str,@search,@pos),'4321',SUBSTRING_INDEX(@str,@search,(@pos-1-(LENGTH(@str)-LENGTH(REPLACE(@str,@search,'')))/LENGTH(@search))))) WHERE ID = 1; 
```

现在，这可以完美地用作对由 ID 标识的单个帖子的查询，但是我不太确定如何将其扩展为应用于 wordpress 数据库中的所有帖子，但使用单个 sql 查询。

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T17:14:54.653

无需将特定帖子放入@str 并在更新查询中对其进行操作，而是直接对“post_content”进行操作。（`@str`替换`post_content`并`WHERE ID = 1`删除）

```
UPDATE `wp_posts` SET `post_content` = (SELECT CONCAT(SUBSTRING_INDEX(`post_content`,@search,@pos),'4321',SUBSTRING_INDEX(`post_content`,@search,(@pos-1-(LENGTH(`post_content`)-LENGTH(REPLACE(`post_content`,@search,'')))/LENGTH(@search))))); 
```

# entity-framework - 实体框架 - 没有配置的数据库优先

> ID：14983882
> 
> 赞同：3
> 
> 时间：2013-02-20T15:39:44.273
> 
> 标签：entity-framework, entity-framework-5

我正在开发一个使用 EF 处理现有数据库的类库。我想避免类库（和 .exe 或网站）的使用者在 *.config 文件中包含实体连接字符串。我希望连接字符串设置一个运行时。

如何使用 Database First 方法设置连接字符串？没有使用连接字符串的构造函数重载，当我创建一个（在单独的部分类中）时，我得到了“UnintentionalCodeFirstException”。

我已经查看了以下链接：

*   [有没有办法先更改数据库中的连接字符串？](https://stackoverflow.com/questions/10508798/is-there-a-way-to-change-connection-string-in-database-first). 它是关于修改配置文件中的连接字符串，我想避免这样做，因为它会回收进程（在 Web 应用程序的情况下）
*   [我如何在没有 App.config 的情况下使用实体框架](https://stackoverflow.com/questions/8853345/how-can-l-use-entity-framework-without-app-config)。不好，因为它使用 ObjectContext 并且我需要导入数据库时​​生成的上下文。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:48:02.383

DbContext 上有一个接受 DbConnection 的构造函数，您需要为其使用 EntityConnection 对象：

```
SqlConnectionStringBuilder sqlBuilder = new SqlConnectionStringBuilder();

// Set the properties for the data source.
sqlBuilder.DataSource = "server name";
sqlBuilder.InitialCatalog = "database name";
sqlBuilder.IntegratedSecurity = true;

// Build the SqlConnection connection string.
string providerString = sqlBuilder.ToString();

var entityBuilder = new EntityConnectionStringBuilder();

// Initialize the EntityConnectionStringBuilder.
//Set the provider name.
entityBuilder.Provider = "System.Data.SqlClient";

// Set the provider-specific connection string.
entityBuilder.ProviderConnectionString = providerString;

// Set the Metadata location.
entityBuilder.Metadata = @"res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl";

using(var context = new YourDbContext(entityBuilder.ToString())){
    //do stuff here
} 
```

需要注意的重要一点是元数据部分 - “Model1”显然需要替换为您的模型名称。

参考：http: [//msdn.microsoft.com/en-us/library/bb738533.aspx](http://msdn.microsoft.com/en-us/library/bb738533.aspx)

编辑 20/02/2013 22:25

因此，作为补充，您需要使用部分类扩展创建的 DbContext 类，该类添加构造函数以支持上述代码，如下所示：

```
public partial class YourDbContext
{
    public YourDbContext(string connection) : base(connection) {}
} 
```

此类需要与实体框架向导生成的 DbContext 位于同一命名空间中。

# javascript - jQuery将JSON值插入具有特定类的元素

> ID：14983886
> 
> 赞同：1
> 
> 时间：2013-02-20T15:39:50.647
> 
> 标签：javascript, jquery, json, getjson

我今天尝试整理的一些 jQuery 有点麻烦。

基本上，我想要实现的是通过读取 JSON 提要动态地将价格插入到我页面上的价格按钮中。

这个想法是有一个包含价格的空跨度。我已经给出了全班的所有价格`.getPriceNew`。每个跨度也有一个 id，它等于这样的项目的 SKU 编号`<span class="getPriceNew" id="123456"></span>`。

机制是，对于每个具有类`.getPriceNew`的跨度，将查询 JSON 以获取信息，并将 SKU id 用作查询字符串的一部分。

这是我尝试过的代码示例

**jQuery**

```
$(".getPriceNew").each(function() {
    var sku = $(this).attr("id");
    var priceNew = $.getJSON('/api/MyApi.svc/GetProductBySku/'+sku , function(data) {
            return(data.Variants[0].Price);
            });
    $(this).html("&euro;"+priceNew);        
}) 
```

**HTML**

```
<span class="getPriceNew" id="123456"></span>
<span class="getPriceNew" id="789123"></span>
<span class="getPriceNew" id="456789"></span>
<span class="getPriceNew" id="654321"></span> 
```

**JSON 示例** 这是来自 JSON 提要的单个项目的外观 - 我已经对其进行了一点过滤 /api/MyApi.svc/GetProductBySku/123456

**使用有效的 JSON 更新**

```
 {
    "Age": {
        "Description": "Age 18+",
        "Thumbnail": "http://someurl.com/productImages/assets/img//icon18.gif"
    },
    "Barcode": {
        "Barcode": "5026555408684"
    },
    "Description": "HTML",
    "Id": 12214,
    "Packshots": [
        "http://someurl.com/productImages/914383/1min.jpg",
        "http://someurl.com/productImages/914383/2med.jpg",
        "http://someurl.com/productImages/914383/3max.jpg"
    ],
    "Pegis": [],
    "Platform": {
        "Button": "Format",
        "ID": 0
    },
    "Publisher": {
        "Description": null
    },
    "Release": "/Date(1364252400000+0100)/",
    "Screenshots": [],
    "Title": "Product Title",
    "Variants": [
        {
            "Id": 22488,
            "MaxOrderQuantity": 3,
            "Presellable": true,
            "Price": 49.97,
            "Sku": 914383,
            "Type": {
                "Description": "Pre-Order"
            }
        }
    ],
    "Vendor": {
        "Description": "Take Two Interactive Software"
    },
    "VideoHTML": "HTML",
    "status": {
        "Response": "product found",
        "Success": true
    }
} 
```

我希望得到一些帮助，因为在这个阶段我真的在摸我的新手头。我已经设法让 console.log 将价格输出到日志中，但是当我尝试将它们重新插入跨度时，我得到的只是 [object] [Object]。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:45:41.210

你在做

```
$(".getPriceNew").each(function() {
    var sku = $(this).attr("id");
    var priceNew = $.getJSON('/api/MyApi.svc/GetProductBySku/'+sku , function(data) {
            return(data.Variants[0].Price);
            });
    $(this).html("&euro;"+priceNew);        
}) 
```

`getJSON`返回一个`jqXHR`对象，这不是您需要的。试试这个：

```
$(".getPriceNew").each(function() {
    var sku = $(this).attr("id");
    // Save a refference to this span.
    var thisSpan = $(this);
    $.getJSON('/api/MyApi.svc/GetProductBySku/'+sku , function(data) {
            // Request complete, NOW we can use the data we got!
            thisSpan.html("&euro;"+data.Variants[0].Price); 
    });

}) 
```

回调是您想要使用从 AJAX 调用中获得的数据的地方。所有 AJAX 方法（$.ajax、$.get、$.post、$.getJSON 等）都将返回一个[jqXHR](http://api.jquery.com/Types/#jqXHR)对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:08:57.007

我认为您的 javascript 代码是正确的，但您的 Json 输出有两个错误：1：“描述”：“这里的一些 HTML 描述，<-您忘记了结束引号 2：“ID”：0}，<-删除结束括号

所以你的 Json 会是这样的：

```
{
"Age": {
    "Description": "Age 18+",
    "Thumbnail": "http://url.com/image.gif"
},
"Barcode": {
    "Barcode": "4876416541647"
},
"Description": "Some HTML Description here",
"Id": 12214,
"Packshots": [
    "http: //url.com/productImages/914383/1min.jpg",
    "http: //http: //url.com/2med.jpg",
    "http: //http: //url.com/3max.jpg"
],
"ID": 0,
"Publisher": {
    "Description": null
},
"Release": "/Date(1364252400000+0100)/",
"Screenshots": [],
"Title": "Titleoftheproduct",
"Variants": [
    {
        "Id": 22488,
        "MaxOrderQuantity": 3,
        "Presellable": true,
        "Price": 49.97,
        "Sku": 914383,
        "Type": {
            "Description": "Pre-Order"
        }
    }
],
"Vendor": {
    "Description": "Vendorname"
},
"VideoHTML": "&lt;iframewidth=&quot;725&quot;height=&quot;408&quot;src=&quot;http: //www.youtube.com/embed/videoseries?list=PLofwA47XDv2_KnfUY52_8mlWg0iUEv8ci&quot;frameborder=&quot;0&quot;allowfullscreen&gt;&lt;/iframe&gt;",
"status": {
    "Response": "productfound",
    "Success": true
}  } 
```

现在你的代码

```
data.Variants[0].Price 
```

将返回 49.97 来验证 Json 你可以将它粘贴到[http://jsonlint.com/](http://jsonlint.com/)我认为非常有用

希望这可以帮助

# java - Java spring 3 数据源 SingleConnectionDataSource

> ID：14983889
> 
> 赞同：0
> 
> 时间：2013-02-20T15:40:01.107
> 
> 标签：java, spring, spring-jdbc

Java - 春天 3

以下是在 spring-context 文件中配置的数据源连接。

问题是它是 SingleConnectionDataSource 并且在多线程中不起作用，在多线程中起作用的其他选择是什么？

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.SingleConnectionDataSource">
        <property name="driverClassName" value="net.sourceforge.jtds.jdbcx.JtdsDataSource"/>
        <property name="url" value="${dataSource.url}"/>
        <property name="username" value="${dataSource.username}"/>
        <property name="password" value="${dataSource.password}"/>
    </bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:46:45.573

```
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
  <property name="driverClass" value="net.sourceforge.jtds.jdbc.Driver"/> 
```

是我们一直用来连接sql server的。马文：

```
 <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
            <type>jar</type>
            <scope>compile</scope>
        </dependency> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T19:06:30.890

对于池化数据源，池中的连接实际上并没有关闭，它们只是返回到池中。但是，当应用程序关闭时，那些与数据库的连接应该正确并实际关闭，这就是最终清理的地方。

顺便说一句，c3p0 项目几乎已经死了，我建议您改用 Apache Commons DBCP，它仍在维护中。

[Apache Commons DBCP](http://commons.apache.org/dbcp/) 检查此链接以获取 [将 BasicDataSource 配置为 web.xml 中的 bean的代码](https://stackoverflow.com/questions/6403664/configure-basicdatasource-as-bean-in-web-xml)

# asp.net-mvc - 如何在使用 forloop 从 MVC 中的数据库中提取的数据的 8 个项目之后创建一个新列？

> ID：14983890
> 
> 赞同：0
> 
> 时间：2013-02-20T15:40:03.330
> 
> 标签：asp.net-mvc

目前，这是我从数据库中提取项目列表并在菜单项下显示的代码：

```
<div class="top">
<ul>
<li class='itemCaption f17o'>&nbsp;</li>
@foreach (var category in Model.CatList)
{
<li>
<a href="/c/@category.Id/@category.Name" class='white'>@category.Name</a>
</li>
}
</ul>
</div> 
```

我也使用下面的代码尝试了相同的操作，但是即使逻辑看起来正确，名为 value 的变量也会产生问题……因为我对 MVC 很陌生，这对我来说也很头疼……

```
@foreach (var category in Model.CatList.Select((Value, i => new { i, Value }))
{
    if (category.i % 8 == 0)
    {
        @("</ul></li><li><ul>")
    }
    <li>
        <a href="/c/@category.Value.Id/@category.Value.Name" class='white'>@category.Value.Name</a>
    </li>
} 
```

.. 有人可以帮我重写 For-loop 中的代码而不是 for-each ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:16:59.253

我没有使用你的模式，但我希望你能适应下面的例子

```
@foreach (var x in Enumerable.Range(0, 200))
{
    if (x % 8 == 0)
    {
        @:<ul>
        @:<li>@x</li>
    }
    else if (x % 8 == 7)
    {
        @:<li>@x</li>
        @:</ul>
    }
    else {
         @:<li>@x</li>
    }
} 
```

如果这不是你想要完成的，请告诉我，我会编辑

编辑

你的模型应该是

```
@foreach (var category in Model.CatList.Select((Value, i) => new { i, Value }))
{
    if (category.i % 8 == 0)
    {
        @:<ul>
        @:<li><a href="/c/@Value.Id/@Value.Name" class='white'>@Value.Name</a></li>
    }
    else if (category.i % 8 == 7)
    {
        @:<li><a href="/c/@Value.Id/@Value.Name" class='white'>@Value.Name</a></li>
        @:</ul>
    }
    else {
         @:<li><a href="/c/@Value.Id/@Value.Name" class='white'>@Value.Name</a></li>
    }
} 
```

# android - 实现这种布局的正确方法？

> ID：14983891
> 
> 赞同：1
> 
> 时间：2013-02-20T15:40:04.170
> 
> 标签：android, android-fragments, usability

这是我想在应用程序中做的事情，希望很清楚：

![在此处输入图像描述](../Images/6cd3ec11b37ba5cc9b61c83bcc60c0c0.png)

注意：我不想同时在屏幕上显示所有 3 个视图！

我有一个搜索窗口，我有结果，并且我想在单击结果项时显示有关它的详细信息。在一个小屏幕（电话）上很清楚：我一次显示一个视图。

在平板电脑上，尤其是在横向模式下，我想一次显示 2 个视图，这意味着：

[搜索 | results] 并在单击结果项时显示 [results | 项目详情]。

我的想法：

1.  有一个Activity“SearchAndResults”，当点击结果项时，打开另一个Activity调用ResultsAndDetails。两个活动都将使用片段，例如 SearchFragment、ResultFragment、DetailFragment。这可能很容易实现，但对我来说似乎不是很优雅，尤其是因为我没有任何动画（让结果视图向左滑动，让细节视图从右侧滑入）

2.  在一个活动中拥有所有 3 个视图，并使用 layout.setvisibility() 隐藏/显示它们。也没有动画，我讨厌在我的代码中做太多布局的东西。

3.  显示 2 个视图但用户不能仅从代码中滑动的 viewpager？

有什么好方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T17:31:18.073

我会使用 Fragments，就像你的想法 #1 一样。[这个问题](https://stackoverflow.com/questions/12253965/complete-working-sample-of-the-gmail-three-fragment-animation-scenario)似乎正在描述您尝试实现的完全相同类型的布局。它有几个关于如何动画片段转换的答案，包括完整的代码示例。

# visual-studio-2010 - 在文件中查找 查找不在解决方案中的文件

> ID：14983892
> 
> 赞同：1
> 
> 时间：2013-02-20T15:40:08.160
> 
> 标签：visual-studio-2010, visual-studio

我在 VS2010 中遇到了一些奇怪的行为。当我对某些文本执行“在文件中查找”并在“查找范围”字段中选择“整个解决方案”时，我会在“结果”窗口中返回不属于我的解决方案的文件。我已经检查了这些文件是否被意外添加到我的解决方案中并且无法在解决方案资源管理器中看到它们，所以任何人都可以告诉我为什么会发生这种情况，以及我可以如何防止这些文件出现在我的搜索中，因为我可以不小心输入一个进行更改，却没有意识到它们是错误的解决方案。

谢谢，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:41:50.717

执行了一个干净的解决方案，这似乎已经停止了文件的出现。不过很想知道它是怎么发生的。

# javascript - 使用 jqPlot 的 AJAX 调用未正确显示轴

> ID：14983895
> 
> 赞同：0
> 
> 时间：2013-02-20T15:40:20.210
> 
> 标签：javascript, jquery, jqplot

我有一个 AJAX 函数，它调用数据库中的记录列表。然后我尝试使用 jqPlot 来显示表格上的某些行，其中 x 轴是记录的时间戳，y 轴是心率 (hr)。

对 jqPlot 函数的调用是在 AJAX 调用成功的情况下进行的，如下所示：

```
success: function(data) {
                if(data.moves) {
                    $('#records').html('');
                    var html = "";
                    var dataarray = [];
                    html += "<table>";
                    $.each(data.moves, function(k, v) { 
                        dataarray.push([v.timestamp, v.hr]);
                        html += "<tr>";
                        html += "<td>" + v.hr + "</td>";
                        html += "<td>" + v.time + "</td>";
                        html += "<td>" + v.title + "</td>";
                        html += "<td>" + v.zone + "</td>";
                        html += "</tr>";
                    });
                    html += "</table>";
                    $('.records').html(html);   
                    var plot1 = $.jqplot('records',  [dataarray], {
                        title: 'Heart Rate for this move',
                        axesDefaults: {
                            min: 0,
                            max: 200
                        },
                        axes: {
                            xaxis: {
                                label: "Time",
                                pad: 0,
                                renderer: $.jqplot.DateAxisRenderer,
                                tickRenderer: $.jqplot.CanvasAxisTickRenderer,
                                tickOptions: {
                                    formatString: '%H:%M',
                                    angle: -45
                                }
                            },
                            yaxis: {
                                label: "Heart Rate"
                            }
                        }
                    });
                }
            } 
```

如您所见，我正在遍历数据变量中返回的每条记录，并使用 jqPlot 使用的“hr（心率）”和“时间（日期戳）”字段填充一个名为“dataarray”的数组。

这是从 AJAX 调用返回的 json 数组：

```
$moves = $this->myzone_model->getUsersMoves($options);
            $moves_arr = array();
            foreach($moves as $move) {
                $timestamp = strtotime($move['time']);
                $moves_arr[] = array(
                    'myzone_user_hr_records_id' => $move['myzone_user_hr_records_id'],
                    'GUID'                      => $move['GUID'],
                    'hr'                        => $move['hr'],
                    'time'                      => $move['time'],
                    'timestamp'                 => $timestamp,
                    'title'                     => $move['title'],
                    'maxHR'                     => $move['maxHR'],
                    'zone'                      => $move['zone']
                );
            }
            $json = array('moves' => $moves_arr); 
```

不幸的是，这似乎不起作用，我不确定为什么。这就是我得到的：

![在此处输入图像描述](../Images/7bf2dd11d414817f4010069251cc8a59.png)

如您所见，绘图未出现，x 轴未显示正确的时间范围。我以前没有真正使用过 jqPlot，所以似乎无法调试这个。有谁知道我哪里出错了？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:08:37.070

好的，由于一些检查数据数组数组的输出的建议，我已经设法得到这个排序。基本上，由于 UNIX 时间戳以秒为单位工作，而 Javascript 时间戳以毫秒为单位，我需要将我的时间戳从 UNIX 时间戳转换为 Javascript，以便正确读取日期。希望这对其他人有帮助！

# batch-file - 如何使用通过批处理文件调用的程序打开非特定文件？

> ID：14983899
> 
> 赞同：2
> 
> 时间：2013-02-20T15:40:27.270
> 
> 标签：batch-file, dos

我可以在互联网上找到很多关于如何打开特定文件的答案，例如[http://answers.yahoo.com/question/index?qid=20080102230630AAfu5dF](http://answers.yahoo.com/question/index?qid=20080102230630AAfu5dF)

但是，我需要提供一种在批处理文件调用的程序中打开非特定文件的方法。

为了解释，这里是一个例子。用户有一个包含 100 个文件的文件夹，扩展名为 .xyz。他希望能够双击任何文件并在他的“XYZ 查看器”中打开它，但要运行他的 XYZ 查看器，他需要运行一个更改他的注册表的批处理文件，然后运行实际的 XYZ 查看器 .exe。

如果您通过“始终使用所选程序打开此类文件”复选框选择批处理文件作为默认程序，它将打开该程序，但不使用标准的 Windows 打开文件的功能，即启动运行该程序。

有没有办法通过批处理文件运行程序并让它既运行程序又打开启动程序运行的任何文件？

我怀疑这是不可能的，但任何建议都会非常感激！

干杯。

编辑：该程序最终确实支持打开作为参数放置的文件。

我的代码是
`reg import c:\regent\31.2.03.reg
start C:\Program\Program.exe`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:01:37.940

程序最终是否支持打开作为参数放置的文件？在您链接的示例中， mspaint 打开给它的第一个参数。

如果您的批处理文件当前未执行此操作，则必须对其进行编辑以包含批处理参数。

有关它的一些更完整的文档，请参阅[http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/percent.mspx?mfr=true](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/percent.mspx?mfr=true)。

本质上，您想在某处添加 %1，例如：

```
reg import c:\regent\31.2.03.reg
start C:\Program\Program.exe %1 
```

# excel - 使用 VBA 在 Outlook 中添加项目 - 导致侦听器随机“取消设置”的事情

> ID：14983903
> 
> 赞同：0
> 
> 时间：2013-02-20T15:40:35.857
> 
> 标签：excel, events, vba, outlook

我在特定子文件夹上使用带有事件侦听器的 VBA 在该文件夹收到电子邮件时运行宏。它运行良好，但有一个例外。我将对象设置为听，但它们似乎随机地设置回“无”，这会阻止听众“听”。这是我用来设置侦听器和触发宏的代码：

```
Public WithEvents myOLItems As Outlook.Folder
Public WithEvents myTDLoanEmails As Outlook.Items

Private Sub Application_Startup()
    Set myOLItems = Outlook.Session.GetDefaultFolder(olFolderInbox)
    Set myTDLoanEmails = myOLItems.Folders("Trust Loan Collateral Tracking Text Files").Items
End Sub

Private Sub myTDLoanEmails_ItemAdd(ByVal Item As Object)
    Call getAttachments
    Call runTextToExcel
End Sub 
```

“runTextToExcel”创建一个 Excel 应用程序，打开一个 Excel 文件，在该文件中运行一个宏，然后关闭文件和应用程序。我认为错误可能源于文件/Excel 应用程序没有完全关闭，因为如果我在完成后立即再次运行 Outlook 宏，它找不到 Excel 文件，尽管它没有移动。这会导致错误，我认为这可能会使听众“不安”。这可能吗？

如果它有帮助（或者你很好奇），这里是上面调用的两个子：

```
Private Sub runTextToExcel()
Dim xlApp As Object
Dim oWbk As Workbook
Dim TextToExcelFile As Workbook

Set xlApp = CreateObject("Excel.Application")
With xlApp
    .Visible = True
    .EnableEvents = False
End With

sFile = "Loan Text Files to Excel Converter_v004.xlsm"
sPath = "K:\Shared\Text to Excel\"

bOpened = False
For Each oWbk In Workbooks
    If oWbk.Name = sFile Then bOpened = True
Next oWbk
If bOpened = False Then Workbooks.Open (sPath & sFile)

xlApp.Run "'" & sFile & "'!LoanTextFilesToExcel"

xlApp.DisplayAlerts = False
Workbooks(sFile).Close (True)
xlApp.DisplayAlerts = True
xlApp.Quit

End Sub

Private Sub getAttachments()
    On Error GoTo GetAttachments_err

Dim ns As NameSpace
Dim Inbox As MAPIFolder
Dim TDLoanEmails As MAPIFolder
Dim Item As Object
Dim Atmt As Attachment
Dim FileName As String
Dim i As Integer

Set ns = GetNamespace("MAPI")
Set Inbox = ns.GetDefaultFolder(olFolderInbox)
Set TDLoanEmails = Inbox.Folders("Trust Loan Collateral Tracking Text Files")

For Each Item In TDLoanEmails.Items
    If Item.Attachments.Count > 3 Then
        If Day(Item.ReceivedTime) = Day(Date) And Month(Item.ReceivedTime) = Month(Date) And Year(Item.ReceivedTime) = Year(Date) Then
            For Each Atmt In Item.Attachments
                If Right(Atmt.FileName, 4) = ".TXT" Then
                    FileName = "K:\Shared\Text to Excel\Text Files\" & Left(Atmt.FileName, Len(Atmt.FileName) - 4) & "-" & Format(Date, "mmddyyyy") & ".txt"
                    Atmt.SaveAsFile FileName
                End If
            Next Atmt
        End If
    End If
Next Item

GetAttachments_exit:
    Set Atmt = Nothing
    Set Item = Nothing
    Set ns = Nothing
    Exit Sub

GetAttachments_err:
   MsgBox "An unexpected error has occurred." _
      & vbCrLf & "Please note and report the following information." _
      & vbCrLf & "Macro Name: GetAttachments" _
      & vbCrLf & "Error Number: " & Err.Number _
      & vbCrLf & "Error Description: " & Err.Description _
      , vbCritical, "Error!"
   Resume GetAttachments_exit
End Sub 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T17:12:36.423

不确定是否是因为`runTextToExcel`但是备份您现有的`runTextToExcel`并用它替换它。

我相信你正在使用`Late Binding`

此代码中所做的更改

1.  对象声明
2.  对象正确关闭和释放

**代码**

```
Private Sub runTextToExcel()
    Dim xlApp As Object
    Dim oWbk As Object, wb As Object
    Dim TextToExcelFile As Object '<~~ Are you using this anywhere?
    Dim bOpened As Boolean

    Set xlApp = CreateObject("Excel.Application")

    With xlApp
        .Visible = True
        .EnableEvents = False
    End With

    sFile = "Loan Text Files to Excel Converter_v004.xlsm"
    sPath = "K:\Shared\Text to Excel\"

    bOpened = False

    For Each oWbk In xlApp.Workbooks
        If oWbk.Name = sFile Then bOpened = True
    Next oWbk

    If bOpened = False Then Set wb = xlApp.Workbooks.Open(sPath & sFile)

    xlApp.Run "'" & sFile & "'!LoanTextFilesToExcel"

    xlApp.DisplayAlerts = False
    wb.Close (True)
    xlApp.DisplayAlerts = True
    xlApp.Quit

    Set wb = Nothing
    Set xlApp = Nothing
End Sub 
```

# vb.net - 如何在字符串中查找数值

> ID：14983908
> 
> 赞同：-3
> 
> 时间：2013-02-20T15:40:47.900
> 
> 标签：vb.net, artificial-intelligence, information-retrieval, information-extraction

我正在尝试创建一个分析文本字符串以查看它是否包含数值的方法。例如，给定以下字符串：

> 什么是 2 * 2？

我需要确定以下信息：

*   该字符串包含一个数值：`True`
*   它包含的数值是什么：（他们中`2`的任何人都应该使函数返回 true，我应该将字符串中每个 2 的位置放在一个变量中，例如前 2 的位置 0）

这是我到目前为止的代码：

```
Public Function InQuestion(question As String) As Boolean
    ' Possible substring operations using the position of the number in the string?
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:10:00.693

这是一个示例控制台应用程序：

```
Module Module1
    Sub Main()
        Dim results As List(Of NumericValue) = GetNumericValues("What is 2 * 2?")
        For Each i As NumericValue In results
            Console.WriteLine("{0}: {1}", i.Position, i.Value)
        Next
        Console.ReadKey()
    End Sub

    Public Class NumericValue
        Public Sub New(value As Decimal, position As Integer)
            Me.Value = value
            Me.Position = position
        End Sub

        Public Property Value As Decimal
        Public Property Position As Integer
    End Class

    Public Function GetNumericValues(data As String) As List(Of NumericValue)
        Dim values As New List(Of NumericValue)()
        Dim wordDelimiters() As Char = New Char() {" "c, "*"c, "?"c}
        Dim position As Integer = 0
        For Each word As String In data.Split(wordDelimiters, StringSplitOptions.None)
            Dim value As Decimal
            If Decimal.TryParse(word, value) Then
                values.Add(New NumericValue(value, position))
            End If
            position += word.Length + 1
        Next
        Return values
    End Function
End Module 
```

如您所见，它传递了字符串“什么是 2 * 2？” 它输出每个数值的位置和值：

> 8：2
> 
> 12：2

# django - 找不到 Django 页面 (404)

> ID：14983912
> 
> 赞同：-1
> 
> 时间：2013-02-20T15:40:52.840
> 
> 标签：django

我正在设计一个照片应用程序。

每次我在管理页面上查看上传的图片时都会收到此错误。

```
 Page not found (404)
 Request Method:    GET
 Request URL:   http://127.0.0.1:8000/media/images/California_Poppy.jpg

 Using the URLconf defined in mysite.urls, Django tried these URL patterns, in this order:

     ^polls/
     ^admin/
     ^cool/
     ^forum/
     ^register/

 The current URL, media/images/California_Poppy.jpg, didn't match any of these. 
```

我当前的设置是：

```
 MEDIA_ROOT = 'C:/djcode/mysite/photo'

 MEDIA_URL = 'http://127.0.0.1:8000/media/' 
```

我认为问题出在这些设置上。我正在使用窗口顺便说一句

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:05:32.610

[Django 文档](https://docs.djangoproject.com/en/1.4/howto/static-files/#serving-other-directories)为您提供了在开发中为媒体提供服务的解决方案。通常在生产中，您可以为您的媒体目录设置别名，以便直接从您的网络服务器提供服务，以提高效率。为了在开发中服务，文档显示了两种不同的解决方案。您可以查看提供的链接以阅读文档并找出哪个更适合您。

```
from django.conf import settings

# ... the rest of your URLconf goes here ...

if settings.DEBUG:
    urlpatterns += patterns('',
        url(r'^media/(?P<path>.*)$', 'django.views.static.serve', {
            'document_root': settings.MEDIA_ROOT,
        }),
   ) 
```

或者

```
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = patterns('',
    # ... the rest of your URLconf goes here ...
) + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT) 
```

# docx4j - 更改文档中间的页面方向

> ID：14983913
> 
> 赞同：3
> 
> 时间：2013-02-20T15:40:56.000
> 
> 标签：docx4j

我需要为文档的某些页面设置横向。我试过这段代码：

```
 SectPr sectionLandscape = objectFactory.createSectPr();

String rsidR = sectionLandscape.getRsidR();     

SectPr sectionPortrait = objectFactory.createSectPr();
sectionPortrait.setRsidR(rsidR);
sectionPortrait.setRsidSect(rsidR);    

PgSz landscape = new PgSz();
landscape.setOrient(STPageOrientation.LANDSCAPE);
landscape.setH(BigInteger.valueOf(11906));
landscape.setW(BigInteger.valueOf(16383));       

sectionLandscape.setPgSz(landscape);

mdp.addObject(sectionLandscape); 
```

它创建这个 xml 代码：

```
<w:sectPr>
    <w:pgSz w:w="16383" w:orient="landscape" w:h="11906"/>
</w:sectPr> 
```

在 Section 标记之后有我在横向页面中需要的文本和表格。使用 Word 2007/2010，我只能看到纵向页面，在页面的编辑模式下，我可以看到选择为横向的页面。

[http://i.stack.imgur.com/HHuGB.png](http://i.stack.imgur.com/HHuGB.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:23:03.410

sectPr 应该在横向显示的内容**之后的 aw:p/w:pPr 中。**

您需要 sectPr 在该内容之前指定肖像。

# plone - Plone 4.2.4 显示错误的当地时间/提前 3.5 小时

> ID：14983923
> 
> 赞同：1
> 
> 时间：2013-02-20T15:41:20.633
> 
> 标签：plone, zope

全新的 plone 4.2.4 安装（Linux 的统一安装程序）为所有 Plone/Zope 事件写入错误的时间。

我的时区设置为亚洲/耶路撒冷，时间设置为“本地 PC 时间”。

Plone 领先它正好 3.5（三个半）小时。

我该如何解决这个问题，为什么会发生这种情况？

系统是 OpenSuse 12.2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T16:16:06.837

Python 只能将时区作为三个字母的缩写给 Zope。对于亚洲/耶路撒冷，即[`IST`](http://www.timeanddate.com/library/abbreviations/timezones/asia/ist-israel.html).

不幸的是，同样的缩写也用于[印度标准时间](http://www.timeanddate.com/library/abbreviations/timezones/asia/ist.html)，比亚洲/耶路撒冷早 3 个半小时。

`TZ`解决方案是在 Zope 构建配置中添加一个环境变量，以消除时区的*歧义*：

```
[instance]
recipe = plone.recipe.zope2instance
...
environment-vars =
    TZ JIST-2JIDT-3,M3.5.5/2,M9.3.0/2 
```

这`JIST`是耶路撒冷 IST 与其他 IST 含义的对比，其中当前时间为 -2 UTC，夏令时在 3 月的最后一个星期五 2 点移动到 -3 UTC，并在 9 月的第 3 个星期日再次移动到冬季，又是2点。

# c# - C#中的鼠标事件

> ID：14983927
> 
> 赞同：0
> 
> 时间：2013-02-20T15:41:23.213
> 
> 标签：c#, .net, winforms, mouseevent

我正在尝试用 C# 构建一个 Checkers/Drafts 游戏。该项目是使用 Windows 窗体构建的。

我所做的是分解游戏板。所以我有一个“董事会”课程。和“BoardSquare”类（这个类在正确的位置和颜色绘制一个正方形）

该板由 8 X 8 BoardSquare 构建。

我想到了这个方案，方块需要知道它是否为空，如果它不为空则意味着它上面有一个“GameSoldier”。

因此，当我想将士兵移动到另一个方格时，我需要单击当前方格以获取 GameSoldier，然后按下目标方格。

所以我想做的是在 BoardSquare 类中添加鼠标功能来获取正方形的属性，比如位置。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:53:46.530

单击板时，您可以从 EventArgs 中获取光标的坐标。要将这些坐标转换为板上的正方形，您必须跨行从左上角到右下角布置图块，并将它们存储在索引列表或数组中。

然后 X 坐标（在“tiles”中）是`Math.Floor(X_Clicked / TileWidth)`

Y坐标是`Math.Floor(Y_Clicked / TileHeight)`

例如，如果您的图块是 50 像素宽和 50 像素高，并且用户点击 (329, 186) 这将是图块：

329 / 50 = 6,58 = 6

186 / 50 = 3,72 = 3

单击 (6, 3) 处的图块。要将其转换为列表/数组中的索引：

x + (y * tiles_in_a_row) = 6 + (3 * 8) = 30，所以 Tile[30] 被点击了。

请记住，这是一个从零开始的坐标系，因此第一个图块位于 (0, 0)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:55:42.690

有几种方法可以解决这个问题，您的 boardsquare 课程可能会妨碍简单的课程，因为它会集中注意力。

当你点击一个被占用的棋盘格时，它的鼠标事件就会触发。它在板上的位置可以通过它的顶部/高度和左侧/宽度来识别，然后您可以将其传递给板上定义的 BoardSquareSelected 事件处理程序。当您单击未占用的正方形鼠标位置时，x / 正方形宽度，y / 正方形高度您需要更多的逻辑来确定第一次单击被占用，第二次不是合法移动等。您也可以查看拖放导数。但就我个人而言，我会摆脱 boardsquare 作为一个组件。如果 board 有一个 8x8 的正方形数组，并且您使用 Invalidate(rect) 来避免在任何更改时重新绘制整个事物，那么您实际上并不需要它。然后，您所有的选择内容都完全由 board 类封装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:50:13.300

您要做的是为您正在渲染的控件的 MouseClick 事件添加一个 Eventhandler。在该事件的 EventArgs 中，您将能够检索鼠标坐标。然后，您可以将该信息与控件本身的大小相结合，以计算单击了哪个方块。

以下是更多信息：

[在 DoubleClick 事件上获取鼠标点击的位置/按钮](https://stackoverflow.com/questions/690904/obtain-position-button-of-mouse-click-on-doubleclick-event)

（尤其是穆斯的回答）

# ios - UIButton 不在故事板上的同一个地方

> ID：14983928
> 
> 赞同：1
> 
> 时间：2013-02-20T15:41:28.980
> 
> 标签：ios, objective-c, uibutton, storyboard

我将所有的东西都移动`UIButtons`到一个特定`UIImageView`的位置，并且由于某种原因，当在模拟器或 iPad 本身上运行时，它们没有匹配到正确的位置作为情节提要。这很奇怪，我很困惑。

这是[故事板中的截图](http://puu.sh/25BTH/edf3d69075)。

这是[模拟器上的截图](http://i.stack.imgur.com/YOOfH.png)。

注意标题的一些圆圈（按钮）是如何显示的。为什么会发生这种情况，我怎样才能让他们进入故事板中的位置？谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:32:34.393

好的，由于某种原因，我禁用了情节提要上的自动布局。但是，当我重新启用它时，它似乎工作了。奇怪的错误，但问题现在已修复。感谢 larme，让我意识到自动布局的事情。

# php - pear include_path 数据文件夹不再有效

> ID：14983930
> 
> 赞同：0
> 
> 时间：2013-02-20T15:41:33.200
> 
> 标签：php, centos, pear

我有一个带有 centOS LAMP 堆栈和多个域/ips 的 vps。很久以前，我有一个更熟悉 SSH 的人在 vps 上安装 pear，我相信他为特定的用户/域配置了它，该用户/域不再存在，现在 pear 正在抛出错误。

不再存在的旧用户/域是“ljsspin”但是当我查看我的 php.ini 时，包含路径是：

```
include_path = ".:/usr/share/pear/:/usr/share/php:/var/www/ljsspin/data/pear/:" 
```

我可以在 ssh 中执行 pear 命令，但我假设包含路径的最后一部分不再存在是错误的原因。

所以我的问题是如何将必要的 /data/pear 文件安装到新目录中？我已经尝试升级 pear，这也产生了错误（无法解压缩结构文件）。

感谢您的任何指导。

我收到的确切错误消息：

```
Warning: include() [function.include]: open_basedir restriction in effect. File(/usr/share/pear/Mail.php) is not within the allowed path(s): (/var/www/steve/data:.) in /var/www/steve/data/www/newdomain.com/admin/dashboard/includes/pdf.php on line 3

Warning: include(/usr/share/pear/Mail.php) [function.include]: failed to open stream: Operation not permitted in /var/www/steve/data/www/newdomain.com/admin/dashboard/includes/pdf.php on line 3

Warning: include() [function.include]: Failed opening 'Mail.php' for inclusion (include_path='.:/usr/share/pear/:/usr/share/php:/var/www/ljsspin/data/pear/:') in /var/www/steve/data/www/newdomain.com/admin/dashboard/includes/pdf.php on line 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T16:08:36.453

**open_basedir 限制有效**错误消息意味着您已经为[open_basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir) PHP 指令设置了一个值，因此不允许脚本从给定目录集之外读取文件，在您的情况下是：

*   `/var/www/steve/data`
*   `.`

由于 PEAR 包安装在其他目录中：

*   `/usr/share/pear/`

... PHP 阻止脚本读取它们，因为它被指示这样做。

如果您打算允许访问`/usr/share/pear/`，您显然必须扩大限制。

# javascript - 在 HighCharts 中链接多个图表控件

> ID：14983931
> 
> 赞同：6
> 
> 时间：2013-02-20T15:41:33.167
> 
> 标签：javascript, highcharts

在我的网页上，我显示了 5 个带有可缩放 X 轴的不同折线图。每个图表还具有许多对于所有图表都相同的系列。

我正在寻找控件，无论我更改哪些图表控件，您都可以在其中显示/隐藏在每个图表中发生的系列和缩放功能。

这是 Highcharts 支持的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T13:20:43.193

请熟悉同步三个图表并具有取消缩放按钮的示例。

```
$(function() {
var chart1;
    var chart2;
    var chart3;
    var controllingChart;

    var defaultTickInterval = 5;
    var currentTickInterval = defaultTickInterval;

    $(document).ready(function() {
        function unzoom() {
             chart1.options.chart.isZoomed = false;
             chart2.options.chart.isZoomed = false;
             chart3.options.chart.isZoomed = false;

            chart1.xAxis[0].setExtremes(null, null);
            chart2.xAxis[0].setExtremes(null, null);
            chart3.xAxis[0].setExtremes(null, null);
        }

        //catch mousemove event and have all 3 charts' crosshairs move along indicated values on x axis

        function syncronizeCrossHairs(chart) {
            var container = $(chart.container),
                offset = container.offset(),
                x, y, isInside, report;

            container.mousemove(function(evt) {

                x = evt.clientX - chart.plotLeft - offset.left;
                y = evt.clientY - chart.plotTop - offset.top;
                var xAxis = chart.xAxis[0];
                //remove old plot line and draw new plot line (crosshair) for this chart
                var xAxis1 = chart1.xAxis[0];
                xAxis1.removePlotLine("myPlotLineId");
                xAxis1.addPlotLine({
                    value: chart.xAxis[0].translate(x, true),
                    width: 1,
                    color: 'red',
                    //dashStyle: 'dash',                   
                    id: "myPlotLineId"
                });
                //remove old crosshair and draw new crosshair on chart2
                var xAxis2 = chart2.xAxis[0];
                xAxis2.removePlotLine("myPlotLineId");
                xAxis2.addPlotLine({
                    value: chart.xAxis[0].translate(x, true),
                    width: 1,
                    color: 'red',
                    //dashStyle: 'dash',                   
                    id: "myPlotLineId"
                });

                var xAxis3 = chart3.xAxis[0];
                xAxis3.removePlotLine("myPlotLineId");
                xAxis3.addPlotLine({
                    value: chart.xAxis[0].translate(x, true),
                    width: 1,
                    color: 'red',
                    //dashStyle: 'dash',                   
                    id: "myPlotLineId"
                });

                //if you have other charts that need to be syncronized - update their crosshair (plot line) in the same way in this function.                   
            });
        }

         //compute a reasonable tick interval given the zoom range -
    //have to compute this since we set the tickIntervals in order
    //to get predictable synchronization between 3 charts with
    //different data.
    function computeTickInterval(xMin, xMax) {
        var zoomRange = xMax - xMin;

        if (zoomRange <= 2)
            currentTickInterval = 0.5;
        if (zoomRange < 20)
            currentTickInterval = 1;
        else if (zoomRange < 100)
            currentTickInterval = 5;
    }

    //explicitly set the tickInterval for the 3 charts - based on
    //selected range
    function setTickInterval(event) {
        var xMin = event.xAxis[0].min;
        var xMax = event.xAxis[0].max;
        computeTickInterval(xMin, xMax);

        chart1.xAxis[0].options.tickInterval = currentTickInterval;
        chart1.xAxis[0].isDirty = true;
        chart2.xAxis[0].options.tickInterval = currentTickInterval;
        chart2.xAxis[0].isDirty = true;
        chart3.xAxis[0].options.tickInterval = currentTickInterval;
        chart3.xAxis[0].isDirty = true;
    }

    //reset the extremes and the tickInterval to default values
    function unzoom() {
        chart1.xAxis[0].options.tickInterval = defaultTickInterval;
        chart1.xAxis[0].isDirty = true;
        chart2.xAxis[0].options.tickInterval = defaultTickInterval;
        chart2.xAxis[0].isDirty = true;
        chart3.xAxis[0].options.tickInterval = defaultTickInterval;
        chart3.xAxis[0].isDirty = true;

        chart1.xAxis[0].setExtremes(null, null);
        chart2.xAxis[0].setExtremes(null, null);
        chart3.xAxis[0].setExtremes(null, null);
    }

            $(document).ready(function() {

                $('#btn').click(function(){
                    unzoom();
                });

                var myPlotLineId = "myPlotLine";
                chart1 = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container',
                        type: 'line',
                        zoomType: 'x',
                        //x axis only
                        borderColor: '#003399',
                        //'#022455',
                        borderWidth: 1,
                        isZoomed:false
                    },
                    title: {
                        text: 'Height Versus Weight'
                    },
                    subtitle: {
                        text: 'Source: Notional Test Data'
                    },
                    xAxis: {
                        title: {
                            enabled: true,
                            text: 'Height (cm)'
                        },
                        tickInterval:5,
                        startOnTick: true,
                        endOnTick: true,
                        showLastLabel: true,
                        events:{

                            afterSetExtremes:function(){

                                 if (!this.chart.options.chart.isZoomed)
                                 {                                         
                                    var xMin = this.chart.xAxis[0].min;
                                    var xMax = this.chart.xAxis[0].max;

                                    var zmRange = computeTickInterval(xMin, xMax);
                                    chart1.xAxis[0].options.tickInterval =zmRange;
                                    chart1.xAxis[0].isDirty = true;
                                    chart2.xAxis[0].options.tickInterval = zmRange;
                                    chart2.xAxis[0].isDirty = true;
                                    chart3.xAxis[0].options.tickInterval = zmRange;
                                    chart3.xAxis[0].isDirty = true;

                                   chart2.options.chart.isZoomed = true;
                                   chart3.options.chart.isZoomed = true;
                                   chart2.xAxis[0].setExtremes(xMin, xMax, true);

                                    chart3.xAxis[0].setExtremes(xMin, xMax, true);
                                      chart2.options.chart.isZoomed = false;
                                   chart3.options.chart.isZoomed = false;
                                }
                            }

                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Weight (kg)'
                        }
                    },
                    tooltip: {
                        formatter: function() {
                            return '' + this.x + ' km, ' + this.y + ' km';
                        }
                    },
                    legend: {
                        layout: 'vertical',
                        align: 'left',
                        verticalAlign: 'top',
                        x: 100,
                        y: 70,
                        floating: true,
                        backgroundColor: '#FFFFFF',
                        borderWidth: 1
                    },
                    plotOptions: {
                        scatter: {
                            marker: {
                                radius: 5,
                                states: {
                                    hover: {
                                        enabled: true,
                                        lineColor: 'rgb(100,100,100)'
                                    }
                                }
                            },
                            states: {
                                hover: {
                                    marker: {
                                        enabled: false
                                    }
                                }
                            }
                        }
                    },
                    series: [{
                        name: 'Group 1',
                        color: 'rgba(223, 83, 83, .5)',
                        data: [[146.2, 51.6], [147.5, 59.0], [148.5, 49.2], [151.0, 63.0], [155.8, 53.6],
                                                                                [157.0, 59.0], [159.1, 47.6], [161.0, 69.8], [166.2, 66.8], [168.2, 75.2],
                                                                                [172.5, 55.2], [174.9, 54.2], [176.9, 62.5], [180.4, 42.0], [190.0, 50.0]]

                        },
                    {
                        name: 'dummy_data',
                        //put this in so that x axis is consistent between 3 charts to begin with
                        color: 'rgba(119, 152, 191, .5)',
                        showInLegend: false,
                        data: [[145.0, 0.0], [200.0, 0.0]]}]

                }, function(chart) { //add this function to the chart definition to get synchronized crosshairs
                    syncronizeCrossHairs(chart);
                });

                chart2 = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container2',
                        type: 'line',
                        zoomType: 'x',
                        //x axis only
                        borderColor: '#003399',
                        //'#022455',
                        borderWidth: 1,
                        isZoomed:false
                        /*events: {
                            selection: function(event) { //this function should zoom chart1, chart2, chart3 according to selected range
                                controllingChart = "chart2";
                                setTickInterval(event);
                            }
                        }*/
                    },
                    title: {
                        text: 'Height Versus Weight'
                    },
                    subtitle: {
                        text: 'Source: Notional Test Data'
                    },
                    xAxis: {
                        title: {
                            enabled: true,
                            text: 'Height (cm)'
                        },
                        tickInterval:5,
                        startOnTick: true,
                        endOnTick: true,
                        showLastLabel: true,
                        events: {
                            afterSetExtremes: function() {
                                if (!this.chart.options.chart.isZoomed) 
                                {
                                    var xMin = this.chart.xAxis[0].min;
                                    var xMax = this.chart.xAxis[0].max;
                                    var zmRange = computeTickInterval(xMin, xMax);
                                    chart1.xAxis[0].options.tickInterval =zmRange;
                                    chart1.xAxis[0].isDirty = true;
                                    chart2.xAxis[0].options.tickInterval = zmRange;
                                    chart2.xAxis[0].isDirty = true;
                                    chart3.xAxis[0].options.tickInterval = zmRange;
                                    chart3.xAxis[0].isDirty = true;

                                   chart1.options.chart.isZoomed = true;
                                   chart3.options.chart.isZoomed = true;
                                    chart1.xAxis[0].setExtremes(xMin, xMax, true);

                                    chart3.xAxis[0].setExtremes(xMin, xMax, true);
                                     chart1.options.chart.isZoomed = false;
                                   chart3.options.chart.isZoomed = false;

                                }
                            }
                        }
                    },
                    yAxis: {
                        title: {
                            text: 'Weight (kg)'
                        }
                    },
                    tooltip: {
                        formatter: function() {
                            return '' + this.x + ' km, ' + this.y + ' km';
                        }
                    },
                    legend: {
                        layout: 'vertical',
                        align: 'left',
                        verticalAlign: 'top',
                        x: 100,
                        y: 70,
                        floating: true,
                        backgroundColor: '#FFFFFF',
                        borderWidth: 1
                    },
                    plotOptions: {
                        scatter: {
                            marker: {
                                radius: 5,
                                states: {
                                    hover: {
                                        enabled: true,
                                        lineColor: 'rgb(100,100,100)'
                                    }
                                }
                            },
                            states: {
                                hover: {
                                    marker: {
                                        enabled: false
                                    }
                                }
                            }
                        }
                    },
                    series: [{
                        name: 'dummy_data',
                        color: 'rgba(223, 83, 83, .5)',
                        showInLegend: false,
                        data: [[145.0, 0.0], [200.0, 0.0]]},
                    {
                        name: 'Group 2',
                        color: 'rgba(119, 152, 191, .5)',
                        data: [[151.0, 65.6], [166.3, 71.8], [167.5, 80.7], [168.5, 72.6], [172.2, 78.8],
                                                                                                    [174.5, 74.8], [175.0, 86.4], [181.5, 78.4], [182.0, 62.0], [184.0, 81.6],
                                                                                                    [185.0, 76.6], [186.8, 83.6], [186.0, 90.0], [188.0, 74.6], [190.0, 71.0],
                                                                                                    [192.0, 79.6], [193.7, 93.8], [196.5, 70.0], [199.0, 72.4]]}]
                }, function(chart) { //add this function to the chart definition to get synchronized crosshairs
                    //this function needs to be added to each syncronized chart 
                    syncronizeCrossHairs(chart);

                });

                chart3 = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container3',
                        type: 'line',
                        zoomType: 'x',
                        //x axis only
                        borderColor: '#003399',
                        //'#022455',
                        borderWidth: 1,
                        isZoomed:false
                        /*events: {
                            selection: function(event) { //this function should zoom chart1, chart2, chart3
                                controllingChart = "chart3";
                                setTickInterval(event);
                            }
                        }*/
                    },
                    title: {
                        text: 'Height Versus Weight'
                    },
                    subtitle: {
                        text: 'Source: Notional Test Data'
                    },
                    xAxis: {
                        title: {
                            enabled: true,
                            text: 'Height (cm)'
                        },
                        tickInterval:5,
                        startOnTick: true,
                        endOnTick: true,
                        showLastLabel: true,
                        events: {
                             afterSetExtremes: function() {
                                 if (!this.chart.options.chart.isZoomed) {
                                    var xMin = this.chart.xAxis[0].min;
                                    var xMax = this.chart.xAxis[0].max;
                                    var zmRange = computeTickInterval(xMin, xMax);
                                    chart1.xAxis[0].options.tickInterval =zmRange;
                                    chart1.xAxis[0].isDirty = true;
                                    chart2.xAxis[0].options.tickInterval = zmRange;
                                    chart2.xAxis[0].isDirty = true;
                                    chart3.xAxis[0].options.tickInterval = zmRange;
                                    chart3.xAxis[0].isDirty = true; 

                                   chart1.options.chart.isZoomed = true;
                                   chart2.options.chart.isZoomed = true;
                                   chart1.xAxis[0].setExtremes(xMin, xMax, true);

                                   chart2.xAxis[0].setExtremes(xMin, xMax, true);
                                     chart1.options.chart.isZoomed = false;
                                   chart2.options.chart.isZoomed = false;

                                }
                    }
                            }
                    },
                    yAxis: {
                        title: {
                            text: 'Weight (kg)'
                        }
                    },
                    tooltip: {
                        formatter: function() {
                            return '' + this.x + ' km, ' + this.y + ' km';
                        }
                    },
                    legend: {
                        layout: 'vertical',
                        align: 'left',
                        verticalAlign: 'top',
                        x: 100,
                        y: 70,
                        floating: true,
                        backgroundColor: '#FFFFFF',
                        borderWidth: 1
                    },
                    plotOptions: {
                        scatter: {
                            marker: {
                                radius: 5,
                                states: {
                                    hover: {
                                        enabled: true,
                                        lineColor: 'rgb(100,100,100)'
                                    }
                                }
                            },
                            states: {
                                hover: {
                                    marker: {
                                        enabled: false
                                    }
                                }
                            }
                        }
                    },
                    series: [{
                        name: 'dummy_data',
                        //I put this in to try to get the charts to have the same range on the x axis
                        color: 'rgba(223, 83, 83, .5)',
                        showInLegend: false,
                        data: [[145.0, 0.0], [200.0, 0.0]]},
                    {
                        name: 'Group 3',
                        color: 'rgba(119, 152, 191, .5)',
                        data: [[153.0, 65.6], [156.3, 71.8], [167.5, 80.7], [169.5, 72.6], [171.2, 78.8],
                                                                                                    [172.5, 74.8], [177.0, 86.4], [181.5, 78.4], [183.0, 62.0], [184.0, 81.6],
                                                                                                    [185.0, 76.6], [186.2, 83.6], [187.0, 90.0], [188.7, 74.6], [190.0, 71.0],
                                                                                                    [192.0, 79.6], [195.7, 93.8], [196.5, 70.0], [199.4, 72.4]]}]
                }, function(chart) { //add this function to the chart definition to get synchronized crosshairs
                    //this function needs to be added to each syncronized chart 
                    syncronizeCrossHairs(chart);

                });

            });

    });

}); 
```

[http://jsfiddle.net/Gv7Tg/27/](http://jsfiddle.net/Gv7Tg/27/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:12:45.063

有两种可能的解决方案：

最简单的选择是使用额外的按钮显示/隐藏和缩放。因此，您将在页面中添加一些按钮并执行如下功能：

//编辑选择图表时出错：

您应该在创建图表时创建图表并将其添加到数组中。例如：

```
var charts = new Array(); 
var chart = new Highcharts.StockChart(opts);
charts.push(chart); 
```

然后对于函数：

```
//Set xAxis extremes (zoom)
for (var i = 0; i < charts.length; i++) {
        charts[i].xAxis[0].setExtremes(startDate, endDate);
} 
```

更改缩放。显示和隐藏系列也很简单：

[Highstock 期权参考](http://api.highcharts.com/highstock#Series.hide%28%29)

所以你可以打电话`charts[i].series[0].hide();`隐藏第一个系列

另一种可能性是在用户单击图表时使用 Highcharts 事件来启动类似的功能。

例如关于图例：[Highstock 期权参考](http://api.highcharts.com/highstock#plotOptions.area.events.legendItemClick)

对于缩放：

```
xAxis : {
     events : {
        afterSetExtremes : afterSetExtremes
    },
}, 
```

# php - 我无法让我的like 查询工作

> ID：14983935
> 
> 赞同：-2
> 
> 时间：2013-02-20T15:41:46.243
> 
> 标签：php, mysql, sql

我正在尝试创建一个目录，您可以在其中根据您提供的参数进行搜索。naam 是产品的名称，而 wood 是给定的字符。稍后在脚本中，我将查询的这一部分粘贴到第一部分。

谢谢

```
if(strlen($whereQuery) > 0) 
    $whereQuery .= 'AND naam LIKE '%'.$woord.'%'';
else
    $whereQuery = 'WHERE naam LIKE '%'.$woord.'%''; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:42:28.500

我宁愿使用双引号以避免混淆，

```
if(strlen($whereQuery) > 0) 
    $whereQuery .= " AND naam LIKE '%" .$woord. "%' ";
else
    $whereQuery = " WHERE naam LIKE '%" .$woord. "%' "; 
```

或者简单地说，

```
if(strlen($whereQuery) > 0) 
    $whereQuery .= " AND naam LIKE '%$woord%' ";
else
    $whereQuery = " WHERE naam LIKE '%$woord%' "; 
```

* * *

作为旁注，[`SQL Injection`](http://bobby-tables.com/)如果变量的值（*s*）来自外部，则查询很容易受到攻击。请看下面的文章，了解如何预防。通过使用`PreparedStatements`，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:42:43.137

使用双引号。

或转义单引号。

* * *

也请不要做你目前正在做的事情。

[**不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:42:42.957

您需要转义作为查询一部分的引号：

```
if(strlen($whereQuery) > 0) 
    $whereQuery .= 'AND naam LIKE \'%'.$woord.'%\'';
else
    $whereQuery = 'WHERE naam LIKE \'%'.$woord.'%\''; 
```

或者混合使用单引号和双引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:46:32.400

任何带有颜色编码的编辑器都会立即向您显示问题。只需查看问题中的代码即可。

试试这个：

```
$whereQuery = ($whereQuery ? $whereQuery." AND" : " WHERE")." naam LIKE '%".$woord."%'"; 
```

这样可以避免重复整个“LIKE”部分两次；）

另外，请确保您已正确逃脱`$woord`。`mysql_real_escape_string`在这种情况下是不够的。您还需要运行它`preg_replace("/[%_]/","\\$1",$woord);`以转义 WHERE 子句中的特殊字符。

# oracle - 物化视图创建速度很快，但刷新需要几个小时

> ID：14983941
> 
> 赞同：5
> 
> 时间：2013-02-20T15:42:09.777
> 
> 标签：oracle, plsql, oracle10g, materialized-views

我正在使用物化视图，我无法将其设置为快速刷新，因为某些表来自没有物化视图日志的远程数据库。

当我创建物化视图时，大约需要 20 30 秒。但是，当我试图刷新它时。花了超过2 3个小时。记录总数只有 460,000 左右。

有没有人知道它会如何发生？

谢谢

代码如下所示

```
create materialized view MY_MV1
refresh force on demand
start with to_date('20-02-2013 22:00:00', 'dd-mm-yyyy hh24:mi:ss') next trunc(sysdate)+1+22/24 
as
( SELECT Nvl(Cr.Sol_Chng_Num, ' ') AS Change_Request_Nbr,
       Nvl(Sr.Sr_Num, ' ') AS Service_Request_Nbr,
       Nvl(Sr.w_Org_Id, 0) AS Org_Id,
       Fcr.rowid,
       Cr.rowid,
       Bsr.rowid,
       Sr.rowid,
       SYSDATE
  FROM Dwadmin.f_S_Change@DateWarehouse.World Fcr
 INNER JOIN Dwadmin.d_S_Change@DateWarehouse.World Cr
    ON Fcr.w_Sol_Chng_Id = Cr.w_Sol_Chng_Id
 INNER JOIN Dwadmin.b_S_Change_Obl@DateWarehouse.World Bsr
    ON Fcr.w_Sol_Chng_Id = Bsr.w_Sol_Chng_Id
 INNER JOIN Dwadmin.d_S_Rec@DateWarehouse.World Sr
    ON Sr.w_Srv_Rec_Id = Bsr.w_Srv_Rec_Id
 WHERE Sr.Sr_Num <> 'NS'
); 
```

我尝试使用 dbms_mview.refresh('MY_MATVIEW', 'C', atomic_refresh=>false) 但它仍然需要 141 分钟才能运行......而没有 atomic_refresh=>false 需要 159 分钟

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T20:07:32.180

我个人不会使用 mat view CREATE 语句中内置的调度程序（从 ... next 子句开始）。

主要原因（对我来说）是你不能以这种方式声明刷新非原子（至少我在创建时没有找到它的语法）。根据您的刷新要求和大小，**这可以节省大量时间**。

我会使用 dbms_mview.refresh('MY_MATVIEW', 'C', **atomic_refresh=>false** )。这个会：

1.  截断 MY_MATVIEW 快照表
2.  将追加插入到 MY_MATVIEW 表中

如果您在 create 语句中使用 next 子句，它将设置原子刷新，这意味着它将：

1.  从 MY_MATVIEW 中删除 *
2.  插入 MY_MATVIEW
3.  犯罪

这会更慢（有时慢得多），但其他人仍然可以在刷新时从 MY_MATVIEW 查询。所以，看你的情况和需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-23T07:35:52.190

你可以测试一下。我手动运行它，它适用于我的朋友:)

```
BEGIN
   DBMS_REFRESH.make(
   name                 => 'DB_NAME.MINUTE_REFRESH',
   list                 => '',
   next_date            => SYSDATE,
   interval             => '/*1:Mins*/ SYSDATE + 1/(60*24)',
   implicit_destroy     => FALSE,
   lax                  => FALSE,
   job                  => 0,
   rollback_seg         => NULL,
   push_deferred_rpc    => TRUE,
   refresh_after_errors => TRUE,
   purge_option         => NULL,
   parallelism          => NULL,
   heap_size            => NULL);
END;
/

BEGIN
   DBMS_REFRESH.add(
   name => 'DB_NAME.MINUTE_REFRESH',
   list => 'DB_NAME.MV_NAME',
   lax  => TRUE); 
```

结尾; /

然后你可以用这个摧毁它。

```
BEGIN
  DBMS_REFRESH.destroy(name => 'DB_NAME.MINUTE_REFRESH');
END;
/ 
```

您可以创建物化视图日志。

```
CREATE MATERIALIZED VIEW LOG ON DB_NAME.TABLE_NAME
TABLESPACE users
WITH PRIMARY KEY
INCLUDING NEW VALUES; 
```

我希望它可以帮助你。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:43:32.497

如果创建只需要 20-30 秒，为什么不直接删除并重新创建物化视图而不是刷新它呢？

# phpstorm - 如何禁用我所有项目的拼写检查

> ID：14983942
> 
> 赞同：83
> 
> 时间：2013-02-20T15:42:16.280
> 
> 标签：phpstorm

有没有办法在 PHPStorm 的 IDE 级别禁用拼写检查？我现在需要为我的所有项目单独禁用拼写检查，这有点麻烦。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2013-02-20T16:03:27.987

现有项目没有“全局”设置——需要为**每个项目单独**完成（拼写检查器是一种检查，检查是在每个项目级别配置的）。

您需要在`Settings/Preferences | Editor | Inspections | Proofreading`（`Spelling`以前）禁用整个组。

[![在此处输入图像描述](../Images/2a69f90a28ca389a3813828e5c0b3e64.png)](https://i.stack.imgur.com/T0wxG.png)

* * *

您可以将其配置为默认禁用**任何未来的新项目**（`File | New Projects Setup | Settings for New Projects...`以前是`File | Default Settings`）。

[https://www.jetbrains.com/help/phpstorm/2021.2/configure-project-settings.html#new-default-settings](https://www.jetbrains.com/help/phpstorm/2021.2/configure-project-settings.html#new-default-settings)

[![在此处输入图像描述](../Images/5b2d6e443f46d77459359450f25d49b1.png)](https://i.stack.imgur.com/lCLtl.png)

* * *

还要检查@Amged 的​​建议——编辑您的颜色模式以简单地删除拼写错误的单词的任何视觉效果：`Settings/Preferences | Editor | Colors & Fonts | General --> Errors & Warnings | Typo`。

这样，只要您使用该颜色模式，它就会立即影响所有项目。如果您运行，它还允许您列出所有拼写错误`Code | Inspect Code...`。

可能的缺点：拼写检查器仍在运行；右键单击此类单词时，您将看到额外的 2 个菜单条目。

[![在此处输入图像描述](../Images/87cbb09ae5b5abbe0fb221e3c6a1ccc7.png)](https://i.stack.imgur.com/Grh8E.png)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-09-27T06:43:16.413

您可以启用拼写检查检查，然后转到设置 | 删除编辑器中的视觉效果。颜色和字体 | 一般 | 错字和取消选中效果。这样它就不会在编辑器中突出显示拼写错误，但是当您手动运行代码检查器时，会列出拼写错误。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-11-21T12:53:34.720

我正在使用“CLion”，但我很确定设置非常接近“phpstorm”，因为它们都是由同一家公司生产的:)

转到`File`选项卡，然后选择设置。在打开的窗口中选择如下图的项目并取消选中拼写项目。

[![在此处输入图像描述](../Images/aefbea88f4e42d3179712d3379505784.png)](https://i.stack.imgur.com/2q59v.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-19T14:29:13.703

windows: **File->Settings->Editor**现在点击**Inspections**项目并找到**Spelling**点击 check 按钮，现在**应用并确定**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-09T08:24:57.560

在更改中全局`Settings/Preferences | Editor | Inspections`更改`Project default`为`Default.`

# java - 为什么将数组传递给另一个方法会更改原始数组？

> ID：14983953
> 
> 赞同：1
> 
> 时间：2013-02-20T15:42:40.253
> 
> 标签：java, arrays

在下面的代码中，调用 swapBig(a,some number,somenumber)，其中 a 是一个数组，被复制到 swapBig() 中的 bleh[]。当 bleh[] 中的值被交换时，a[] 中的相应值也会改变。为什么会发生这种情况，我将如何编写代码以便只修改 bleh[] 而不是原始的 a[]？非常感谢！

```
public static void swapBig(String bleh[], int to, int from){ //switches data
    //Actually performing the swaps
    String temp;
    temp = bleh[to];
    bleh[to] = bleh[from];
    bleh[from] = temp;
}
public static void quickSort(String a[], String b[], String c[], String d[],
String e[],String f[], int from, int to){
    //performing the quickSort
    if (from >= to) return;
    int p = (from + to) / 2;
    int i = from;
    int j = to;
    while (i <= j){
        if (a[i].compareTo(a[p]) <= 0)
            i++;
        else if (a[j].compareTo(a[p]) >= 0)
            j--;
        else{
            swapBig(a, i, j);
            swapBig(b, i, j);
            swapBig(c, i, j);
            swapBig(d, i, j);
            swapBig(e, i, j);
            swapBig(f, i, j);
            i++;
            j--;
        }
    }
    if (p<j){
        swapBig(a, p, j);
        swapBig(b, p, j);
        swapBig(c, p, j);
        swapBig(d, p, j);
        swapBig(e, p, j);
        swapBig(f, p, j);
        p = j;
    }else if (p>i){
        swapBig(a, p, i);
        swapBig(b, p, i);
        swapBig(c, p, i);
        swapBig(d, p, i);
        swapBig(e, p, i);
        swapBig(f, p, i);
        p = i;
    }
    quickSort(a, b, c, d,e,f, from, p-1);
    quickSort(a, b, c, d,e,f, p + 1, to);
}

public static void main (String args [])
{
    //Asking for options (what to sort by/search for)
    System.out.println("Sort or Search?");
    String look = promptFor.nextLine();
    if (look.equalsIgnoreCase("Sort")){
    System.out.println("Sort by First, Last, Instrument, Instrument Family, 
    Special Title, or University:");
    String toSortBy = promptFor.nextLine();
    if (toSortBy.equalsIgnoreCase("First"))
        quickSort(fname,lname,inst,instFam,title,uni,0,9);
    if (toSortBy.equalsIgnoreCase("Last"))
        quickSort(lname,fname,inst,instFam,title,uni,0,9);
    if (toSortBy.equalsIgnoreCase("Instrument"))
        quickSort(inst,lname,fname,instFam,title,uni,0,9);
    if (toSortBy.equalsIgnoreCase("Instrument Family"))
        quickSort(instFam,lname,inst,fname,title,uni,0,9);
    if (toSortBy.equalsIgnoreCase("Special Title"))
        quickSort(title,lname,inst,instFam,uni,fname,0,9);
    if (toSortBy.equalsIgnoreCase("University"))
        quickSort(uni,lname,inst,instFam,title,fname,0,9);
    print();
    main(null);     }
    else if (look.equalsIgnoreCase("Search")) {
    System.out.println("Which last name do you wish to search for?");
        searchFor(promptFor.nextLine());
    }
    else
    {
        System.out.println("Command Not Recognized\n");
        main(null);
    }
}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T15:43:52.340

您正在传递对数组的引用，而不是它的副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T15:46:23.000

变量`bleh`被复制变量的值，`a`因此实际上`bleh`指向实际对象，如果您使用它进行修改`bleh`将更改实际对象，这是因为 java 支持按值传递。

如果在通过之前克隆它，您可以获得所需的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T15:48:24.210

这很简单。

数组的值是交换的，因为您将数组传递给交换函数，而在 Java 中，参数是通过引用传递的。

为了避免这种情况。

```
String[] tempArray = a.clone();
swapBig(tempArray, i, j); //This will not change the values in a, but tempArray. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T15:45:53.383

因为你已经传递了对象的引用，任何使用这个引用的操作都会修改主对象

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-20T15:46:52.833

如果要传递数组的副本，请使用 arrayVar.clone() 方法、System.arraycopy() 或 Array.copyOf()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-18T11:31:17.010

将数组传递给方法时，java 不会为该方法创建数组 X 的副本。它传递对数组 X 的引用。

例子：

```
public void swap(Color a, Color b) {
    Color temp = a;
    a = b;
    b = temp;
} 
```

这没有效果。但，

```
.
.
.
   swap(x, y);
}

public void swap(Color[] a, Color[] b) {
   Color temp = a[0];
   a[0] = b[0];
   b[0] = temp;
} 
```

这会将 x[] 的第一个值与 y[] 的第一个值交换。

# javascript - 谷歌地图关闭信息窗口汽车中心

> ID：14983959
> 
> 赞同：1
> 
> 时间：2013-02-20T15:42:50.257
> 
> 标签：javascript, google-maps, center, infowindow

我使用 Google Maps API V3 向我的网站添加了地图。除此以外，我一切正常：当我关闭信息窗口时，如何让地图自动居中？示例代码：

```
var myLatlng = new google.maps.LatLng(1.0, -1.0);

google.maps.event.addListener(infowindow, 'closeclick', function () {
map.setCenter(myLatlng); 
}); 
```

真的卡住了，不胜感激任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T16:26:45.547

谢谢你的jsfiddle。我让它在我的地图上工作，并添加了一个选项，可以在单击信息窗口时缩小到完整地图。这是一个例子：

```
var mapCenter = new google.maps.LatLng(0,22); 

`google.maps.event.addListener(infowindow, 'closeclick', function () {
map.setCenter(mapCenter); 
var opt = { zoom: 2};
map.setOptions(opt);
});` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T23:32:01.497

尝试这个

```
google.maps.event.addListener(infowindow, 'closeclick', function () {
   map.setCenter(this.getPosition()); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-29T03:41:44.377

您的代码中一定有一些错误，因为它对我有用：

[http://jsfiddle.net/SZ3XC/](http://jsfiddle.net/SZ3XC/)

```
var infowindow = new google.maps.InfoWindow({
    content: 'ahoj'
});

google.maps.event.addListener(marker, 'click', function() {
    infowindow.open(map,marker);
});

var myLatlng = new google.maps.LatLng(1.0, -1.0);

google.maps.event.addListener(infowindow, 'closeclick', function () {
     map.setCenter(myLatlng); 
}); 
```

# php - PHPUnit - 将代码分解成可测试的块

> ID：14983965
> 
> 赞同：1
> 
> 时间：2013-02-20T15:43:04.870
> 
> 标签：php, tdd, phpunit

我在某处读到，将方法分解为更小的、可测试的函数是一个好主意，以便可以测试更小的方法。但是我对如何测试调用较小方法的方法感到困惑。这是一个例子：

```
class MyTestableClass
{
    public function myHugeFunction($list, array $list_filter_params)
    {
        // do a bunch of stuff, then...
        foreach($list as $item) {
            $this->subFunction($item);
        }
    }

    public function subFunction()
    {
        // do stuff for each item
    }
} 
```

和测试类：

```
class MyTestableClassTest extends PHPUnit_Framework_TestCase
{
    public function testSubFunction
    {
        // This tests the smaller, bite-size method, which is good.
    }
    public function testMyHugeFunction
    {
        // this tests the parent function *and* the subFunction. I'm trying
        // to test *just* the parent function.
    }
} 
```

我知道如何测试 subFunction，但是由于我不能在同一个类中存根方法，所以我不知道如何*仅*测试父方法。我想找到一种以某种方式将 subFunction 存根以返回 true 的方法。

您是否使用事件并存根事件类？这是我能想到的唯一方法来存根在同一个类中调用的另一个方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T10:52:04.810

除了@fab 在他的评论中所说的（你真的应该考虑一下！），实际上你可以在 SUT 中存根/模拟方法。对于您的示例，构建您的 SUT 对象可能如下所示：

```
class MyTestableClassTest extends PHPUnit_Framework_TestCase
{
    public function testSubFunction
    {
        // This tests the smaller, bite-size method, which is good.
    }
    public function testMyHugeFunction
    {
        // first, prepare your arugments $list and $list_filter_params
        // (...)

        // Next build mock. The second argument means that you will mock ONLY subFunction method
        $this->sut = $this->getMock('Namespace\MyTestableClass', array('subFunction'));

        // now you can set your subFunction expectations:
        $this->sut->expects($this->exactly(count($list))
            ->with($this->anything()); // of course you can make this mock better, I'm just showing a case

        // start testing
        $this->sut->myHugeFunction($list, $list_filter_params);
    }
} 
```

PS 再说一次，正如@fab 所说：如果你展示一个具体的案例，我相信你会从这里的人们那里得到很多好的答案。

# c# - 尝试将命令绑定到 TextBox 时 XAML 未编译

> ID：14983966
> 
> 赞同：0
> 
> 时间：2013-02-20T15:43:07.997
> 
> 标签：c#, wpf, xaml, mvvm

我有一个 WPF 应用程序（我之前写过的同一个应用程序），我正在使用塞缪尔杰克页面[http://blog.functionalfun.net/2008/09/hooking-up-commands-to-中显示的事件处理程序wpf.html 中的事件](http://blog.functionalfun.net/2008/09/hooking-up-commands-to-events-in-wpf.html)。我正在尝试向 UI 中的 TextBox 添加一个事件处理程序，以执行按下按钮时发生的相同操作。但是，它不会编译，编译错误是这样的：

错误 2 不能在“文本框”集合中使用“绑定”。只能在 DependencyObject 的 DependencyProperty 上设置“绑定”。

这是 XAML（注意，我希望在 TextBox 处于焦点时按 Enter 与单击按钮具有相同的操作时发生相同的行为：

这是视图模型代码：

```
/// <summary>
/// The ViewModel in the MVVM pattern
/// </summary>
public class ApplicationViewModel : INotifyPropertyChanged
{
    #region Private members
    private string searchString;
    private string emailString;
    private string toolName;
    private NexusApp selectedApp;
    private ICommand searchButtonCmd;
    private ICommand clearButtonCmd;
    private ICommand emailButtonCmd;
    private ICommand textboxKeyCmd;
    #endregion

    #region INotifyPropertyChanged implementation
    /// <summary>
    /// Notifies the view that the observablecollection bound to the listview has changed
    /// </summary>
    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(string propertyName = "")
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    #endregion

    #region Properties
    /// <summary>
    /// Collection bound to listview in ui view
    /// </summary>
    public ObservableCollection<NexusApp> AppCollection { get; set; }

    /// <summary>
    /// The application record selected by user
    /// </summary>
    public NexusApp SelectedApp
    {
        get
        {
            return this.selectedApp;
        }
        set
        {
            this.selectedApp = value;
            this.emailString = this.selectedApp.Email;
            this.toolName = this.selectedApp.Name;
        }
    }

    /// <summary>
    /// String entered by user into search box
    /// </summary>
    public string AppToSearch
    {
        get
        {
            return searchString;
        }
        set
        {
            searchString = value;
        }
    }

    /// <summary>
    /// Email address of team that owns app user is trying to request
    /// </summary>
    public string AppToRequest
    {
        get
        {
            return emailString;
        }
        set
        {
            emailString = value;
        }
    }
    #endregion

    /// <summary>
    /// Default constructor, initialises and populates collection
    /// </summary>
    public ApplicationViewModel()
    {
        this.AppCollection = ApplicationsModel.Current;
    }

    #region Button command handlers
    /// <summary>
    /// Handles search button
    /// </summary>
    public ICommand SearchButtonPressed
    {
        get
        {
            if (this.searchButtonCmd == null)
            {
                this.searchButtonCmd = new RelayCommand(SearchButtonPressedExecute, c => CanSearch);
            }
            return this.searchButtonCmd;
        }
    }

    /// <summary>
    /// Handles clear button
    /// </summary>
    public ICommand ClearButtonPressed
    {
        get
        {
            if (this.clearButtonCmd == null)
            {
                this.clearButtonCmd = new RelayCommand(ClearButtonPressedExecute, c => CanClear);
            }
            return this.clearButtonCmd;
        }
    }

    /// <summary>
    /// Handles Request Application button
    /// </summary>
    public ICommand EmailButtonPressed
    {
        get
        {
            if (this.emailButtonCmd == null)
            {
                this.emailButtonCmd = new RelayCommand(EmailButtonPressedExecute, c => CanEmail);
            }
            return this.emailButtonCmd;
        }
    }

    public ICommand TextBoxKeyPressed
    {
        get
        {
            if (this.textboxKeyCmd == null)
            {
                this.textboxKeyCmd = new RelayCommand(TextBoxKeyPressedExecute, c => CanSearch);
            }
            return this.textboxKeyCmd;
        }
    }

    private void SearchButtonPressedExecute(object parameter)
    {
        try
        {
            ApplicationsModel.Current.Search(this.searchString);
        }
        catch (Exception e)
        {
            string error = String.Format("Could not refresh repository list: {0}", e.Message);
            MessageBox.Show(error, "Error Performing Search", MessageBoxButton.OK, MessageBoxImage.Error);
        }
        NotifyPropertyChanged();
    }

    private void ClearButtonPressedExecute(object parameter)
    {
        try
        {
            this.searchString = String.Empty;
            this.AppToSearch = String.Empty;
            this.AppToSearch = String.Empty;
            ApplicationsModel.Current.ClearSearch();
            NotifyPropertyChanged();
        }
        catch (Exception e)
        {
            string error = String.Format("Could not refresh repository list: {0}", e.Message);
            MessageBox.Show(error, "Error Clearing Search", MessageBoxButton.OK, MessageBoxImage.Error);
        }
    }

    private void EmailButtonPressedExecute(object parameter)
    {
        if (String.IsNullOrEmpty(this.toolName))
        {
            MessageBox.Show("Please select one of the applications to request", "Please select application", MessageBoxButton.OK, MessageBoxImage.Hand);
            return;
        }
        try
        {
            string message;
            if (EmailHelper.IsValidEmail(this.emailString))
            {
                message = String.Format("Request for application {0} successfully sent", this.toolName);
            }
            else
            {
                message = String.Format("Could not send request for access\nThe email address is not defined for tool {0}.\nThe Equity Nexus team has been alerted, asking them to investigate", this.toolName);
            }
            ApplicationsModel.Current.Email(this.emailString, this.toolName);
            MessageBox.Show(message, "Request Sent", MessageBoxButton.OK, MessageBoxImage.Information);
        }
        catch (Exception e)
        {
            string error = String.Format("Could not send application request email, error: {0}", e.Message);
            MessageBox.Show(error, "Erorr sending request", MessageBoxButton.OK, MessageBoxImage.Error);
        }
    }

    private void TextBoxKeyPressedExecute(object parameter)
    {
        MessageBox.Show("Hit textbox event execute");
    }

    /// <summary>
    /// Ability to do search, always true
    /// </summary>
    public bool CanSearch
    { get { return true; } }

    /// <summary>
    /// Ability to clear search, always true
    /// </summary>
    public bool CanClear
    { get { return true; } }

    /// <summary>
    /// Ability to send email, always true
    /// </summary>
    public bool CanEmail
    { get { return true; } }
    #endregion
     } 
```

这是 RelayCommand 代码：

```
/// <summary>
/// Hooks up commands to the actions in Button Behaviour class
/// </summary>
public class RelayCommand : ICommand
{
    readonly Action<object> _execute;
    readonly Predicate<object> _canExecute;

    public RelayCommand(Action<object> execute)
        : this(execute, null)
    {
    }

    public RelayCommand(Action<object> execute, Predicate<object> canExecute)
    {
        if (execute == null)
        {
            throw new ArgumentNullException("execute");
        }

        _execute = execute;
        _canExecute = canExecute;
    }

    public bool CanExecute(object parameter)
    {
        return _canExecute == null || _canExecute(parameter);
    }

    public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    }

    public void Execute(object parameter)
    {
        _execute(parameter);
    }
} 
```

这是 ButtonBehaviour 代码：

```
public static class ButtonBehaviour
{
    public static readonly DependencyProperty SearchCommand;
    public static readonly DependencyProperty ClearCommand;
    public static readonly DependencyProperty EmailCommand;
    public static readonly DependencyProperty TextBoxKeyCommand;

    static ButtonBehaviour()
    {
        SearchCommand = EventBehaviourFactory.CreateCommandExecutionEventBehaviour(Button.ClickEvent, "SearchCommand", typeof(ButtonBehaviour));
        ClearCommand = EventBehaviourFactory.CreateCommandExecutionEventBehaviour(Button.ClickEvent, "ClearCommand", typeof(ButtonBehaviour));
        EmailCommand = EventBehaviourFactory.CreateCommandExecutionEventBehaviour(Button.ClickEvent, "EmailCommand", typeof(ButtonBehaviour));
        TextBoxKeyCommand = EventBehaviourFactory.CreateCommandExecutionEventBehaviour(TextBox.KeyDownEvent, "EnterKeyCommand", typeof(ButtonBehaviour));
    }

    public static void SetSearchCommand(DependencyObject depobj, ICommand value)
    {
        depobj.SetValue(SearchCommand, value);
    }

    public static ICommand GetSearchCommand(DependencyObject depobj)
    {
        return depobj.GetValue(SearchCommand) as ICommand;
    }

    public static void SetClearCommand(DependencyObject depobj, ICommand value)
    {
        depobj.SetValue(ClearCommand, value);
    }

    public static ICommand GetClearCommand(DependencyObject depobj)
    {
        return depobj.GetValue(ClearCommand) as ICommand;
    }

    public static void SetEmailCommand(DependencyObject depobj, ICommand value)
    {
        depobj.SetValue(EmailCommand, value);
    }

    public static ICommand GetEmailCommand(DependencyObject depobj)
    {
        return depobj.GetValue(EmailCommand) as ICommand;
    }

    public static void SetTextBoxKeyCommand(DependencyObject depobj, ICommand value)
    {
        depobj.SetValue(TextBoxKeyCommand, value);
    }

    public static ICommand GetTextBoxKeyCommand(DependencyObject depobj)
    {
        return depobj.GetValue(TextBoxKeyCommand) as ICommand;
    }
} 
```

XAML 代码：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Image Grid.Row="0" Height="84" HorizontalAlignment="Left" Margin="0,5,5,5" Name="imgNexusLogo" Stretch="Fill" VerticalAlignment="Top" Width="600" Source="nexus1bannerlong.png" />
    <Grid Grid.Row="1" HorizontalAlignment="Center" Margin="0,5,5,5" VerticalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Label Grid.Row="0" Grid.Column="0" Content="Search for Application">
            <Label.Foreground>
                <SolidColorBrush Color="LightCyan" />
            </Label.Foreground>
        </Label>
        <TextBox Grid.Row="0" Grid.Column="1" Margin="3" Width="500" Text="{Binding AppToSearch}" vm:ButtonBehaviour.TextBoxKeyCommand="{Binding TextBoxKeyPressed}" />
        <Button Grid.Row="0" Grid.Column="2" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Search" ToolTip="Click to filter application list by search value" vm:ButtonBehaviour.SearchCommand="{Binding SearchButtonPressed}" />
        <Button Grid.Row="0" Grid.Column="3" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Clear Search" ToolTip="Click to restore application list to full listing" vm:ButtonBehaviour.ClearCommand="{Binding ClearButtonPressed}"/>
    </Grid>
    <ListView Grid.Row="2" BorderBrush="Black" HorizontalAlignment="Stretch" ItemsSource="{Binding Path=AppCollection}" SelectedItem="{Binding SelectedApp}">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Application Name" Width="200" DisplayMemberBinding="{Binding Name}"/>
                <GridViewColumn Header="Application Description" Width="631" DisplayMemberBinding="{Binding Description}"/>
                <GridViewColumn Header="Application Owner" Width="150" DisplayMemberBinding="{Binding Owner}"/>
            </GridView>
        </ListView.View>
    </ListView>
    <Button Grid.Row="3" HorizontalAlignment="Center" Width="200" Height="30" Margin="3" Background="LightCyan" Content="Request Application" ToolTip="Click here to contact app owners" vm:ButtonBehaviour.EmailCommand="{Binding EmailButtonPressed}" />
</Grid> 
```

事件行为工厂代码可以在[http://blog.functionalfun.net/2008/09/hooking-up-commands-to-events-in-wpf.html](http://blog.functionalfun.net/2008/09/hooking-up-commands-to-events-in-wpf.html)找到，我没有对其进行任何更改。

有人知道我在做什么错吗？这可能很简单，但由于我是 WPF 和 MVVM 的新手，我需要了解它。

谢谢！

**跟进**

我只是在后面做了一个代码并处理了这样的事件。避免任何代码落后是不值得的，而且这个项目的截止日期比 MVVM 思想纯度更高。对于任何感兴趣的读者，这是我所做的：

C#代码：

```
 private void TextBox_KeyDown(object sender, System.Windows.Input.KeyEventArgs e)
    {
        if (e.Key == Key.Enter)
        {
            ApplicationViewModel viewModel = DataContext as ApplicationViewModel;
            if (viewModel != null)
            {
                viewModel.AppToSearch = textboxSearch.Text;
                viewModel.SearchButtonPressedExecute(textboxSearch.Text);
            }
        }
    } 
```

XAML：

```
 <TextBox Name="textboxSearch" Grid.Row="0" Grid.Column="1" Margin="3" Width="500" Text="{Binding AppToSearch}" KeyDown="TextBox_KeyDown"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-18T01:34:25.123

我通常使用触发器将文本框绑定到视图模型中的命令。

```
<ComboBox Margin="5" ItemsSource="{Binding Configs}" SelectedItem="{Binding SelectedConfig, Mode=TwoWay}">
      <i:Interaction.Triggers>
          <i:EventTrigger EventName="SelectionChanged">
              <i:InvokeCommandAction  Command="{Binding RetrieveSourceLayersCommand}" />
       </i:EventTrigger>
       </i:Interaction.Triggers>
</ComboBox> 
```

您需要在 xaml: xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" 中添加对此命名空间的引用，并且需要在项目引用中添加适当的程序集。在我的例子中，我添加了这个程序集：选择 Project > Add Reference。在 Reference Manager 对话框的 Extensions 选项卡上，检查 System.Windows.Interactivity 的列表。您可以在“程序集”>“扩展”下找到它。

# python - pymongo操作错误

> ID：14983970
> 
> 赞同：0
> 
> 时间：2013-02-20T15:43:17.057
> 
> 标签：python, mongodb, pymongo

我从我的 MongoDB 中获取了很多记录，并且在此过程中我得到了一个错误

```
File "C:\database\models\mongodb.py", line 228, in __iter__
    for result in self.results:
  File "C:\Python27\Lib\site-packages\pymongo\cursor.py", line 814, in next
    if len(self.__data) or self._refresh():
  File "C:\Python27\Lib\site-packages\pymongo\cursor.py", line 776, in _refresh
    limit, self.__id))
  File "C:\Python27\Lib\site-packages\pymongo\cursor.py", line 720, in __send_message
    self.__uuid_subtype)
  File "C:\Python27\Lib\site-packages\pymongo\helpers.py", line 99, in _unpack_response
    cursor_id)

pymongo.errors.OperationFailure: cursor id '866472135294727793' not valid at server
Exception KeyError: KeyError(38556896,) in <module 'threading' from 'C:\Python27\lib\threading.pyc'> ignored 
```

这是什么意思，我该如何解决。我不知道这是否重要，但我`from gevent import monkey; monkey.patch_all()`在打开连接时确实使用过

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T00:47:35.497

当游标长时间打开而没有对其进行任何操作时，它（游标）可能会超时->这会导致错误

您可以在查找查询中设置 timeout=False 以关闭超时

[参考](http://api.mongodb.org/python/current/faq.html#what-does-operationfailure-cursor-id-not-valid-at-server-mean)

# batch-file - 批处理文件转到在 for 循环中不起作用

> ID：14983972
> 
> 赞同：1
> 
> 时间：2013-02-20T15:43:20.517
> 
> 标签：batch-file, goto, labels

我的批处理文件中有一个循环遍历文件夹的 for 循环。我想跳过特定的文件夹。我可以使用 IF 语句来做到这一点，但更喜欢 GOTO，如下所示。

```
for /d %%F in (*) do (
 if /i "%%F"=="Archive" goto nextFolder
 REM do stuff here
:nextFolder
) 
```

但上面给了我错误：

```
) was unexpected at this time 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:20:29.860

这是行不通的——你不能跳入*控制*流结构并期望一切都好。

请看一下[if 块中的（Windows 批处理）Goto 的行为非常奇怪](https://stackoverflow.com/questions/8481558/windows-batch-goto-within-if-block-behaves-very-strangely)，以便很好地讨论为什么这是一个糟糕的主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:03:04.540

您可以使用 NOT 排除一个或多个文件夹，而不是使用 GOTO。

```
for /d %%F in (*) do (
   if /i NOT "%%F"=="ARCHIVE"
       REM do stuff here
) 
```

# java - Struts2 或 spring 在 WEB-inf 中打开文件

> ID：14983977
> 
> 赞同：0
> 
> 时间：2013-02-20T15:43:29.460
> 
> 标签：java, spring, file, struts2

我正在尝试用 Struts2 做第一个网络应用程序。如何将数据*写入*文本文件，它可以放在哪里？我将 Struts2 与 Spring（Tomcat7 和 eclipse）一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:49:58.327

您可以将数据写入文件系统上任何位置的文本文件，只要您拥有完整路径和写入权限，无论 Struts2 还是 Spring。

# java - Java 泛型转换不如预期

> ID：14983979
> 
> 赞同：0
> 
> 时间：2013-02-20T15:43:32.620
> 
> 标签：java, generics, type-conversion

如果有人可以为我解决这个难题。我确定我错过了一些东西！

```
interface a { }
class b implements a { }
class c extends ArrayList<b> { }
class d {
    d(ArrayList<a> param) {}
}

class e {
    public static void main(String[] arg) {
         d newd = new d(new c());
    }
} 
```

此代码有错误：错误 `d(ArrayList<a>) is not applicable (actual argument c cannot be converted to ArrayList<a> by method invocation conversion)`

当然，类`c`可以转换`ArrayList<a>`为`c`扩展`ArrayList<b>`和`b`实现`a`！我尝试过显式转换，但没有帮助。

`class c extends ArrayList<b>`改成to`extends ArrayList<a>`作为`c`集合的目的也没有意义`b`，界面`a`仅用于显示目的。class`d`也是一个通用显示类，它依赖于接口中表达的功能`a`，因此更改它也没有任何意义。

建议会很方便！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T15:51:40.347

This should suit your needs:

```
class d {
    d(ArrayList<? extends a> param) {
    }
} 
```

`c` isn't an `ArrayList<a>` but an `ArrayList<? extends a>` since `b` is a subtype of `a`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:51:56.103

The problem is that an ArrayList is not the same thing as an ArrayList, even if b extends A. What would happen if D called param.add(new AImpl()), where AImpl was some other implementation of interface A?

For more details, see [The Java Generics Tutorial section on inheritance](http://docs.oracle.com/javase/tutorial/java/generics/inheritance.html).

(As an aside, it's also generally not a good idea to extend an ArrayList - most of the time, you want to be wrapping it, not extending it.)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:52:08.483

It should be:

```
d(ArrayList<? extends a> param) {} 
```

ArrayList is not a subclass of ArrayList because the former can have a's added to it while the latter cannot.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T15:53:16.990

Please respect java naming conventions:

```
interface A {
}

class B implements A {
}

class C extends ArrayList<B> {
}

class D {

    D(ArrayList<A> param) {
    }
}

class E {

    public static void main(String[] arg) {
        D newd = new D(new C());
    }
} 
```

So your assumption is that `ArrayList<B>` is castable to an `ArrayList<A>` as `B implements A`. This is not true, this is not how generics work. You simply cannot cast generic types. Try doing something like:

```
final ArrayList<Object> myNewArrayList = new ArrayList<String>(); 
```

To distill the problem.
You need to use [bounded type parameters](http://docs.oracle.com/javase/tutorial/java/generics/bounded.html) to solve this. Changing your `D` class to:

```
class D {

    D(ArrayList<? extends A> param) {        
    }
} 
```

Would make it work as now you're saying: I want a collection of any type as long as it's an `A`.

# android - Android在打开openGL上下文后显示黑色矩形而不是可绘制图像

> ID：14983983
> 
> 赞同：0
> 
> 时间：2013-02-20T15:43:51.360
> 
> 标签：android, opengl-es, drawable

我正在开发一个简单的 Android 应用程序，它有一些**活动**，例如：**A**、**B**、**C**和**D。** **活动 A* * 是一个闪屏。当相同的数据完成加载时调用finish()。 **活动 B**显示一些信息和几个按钮 **活动 C**启动一个 web 视图，内容对应于 B 中按下的按钮 **活动 D**打开一个 openGL 上下文。

从活动 AI 转到活动 B.，从 B 到 C，从 C 到 D。

**我面临**的问题：一些drawables和progressBar在按下从Activity D（启动openGL上下文的活动）返回的**后退按钮**后**显示黑色矩形。** 我应该研究的任何想法？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:02:40.247

当图像的位图资源不再可用（例如设置`null`或回收）时，通常会出现黑框。

在 openGL 视图中，这可能在活动进入后台时发生，通常是因为丢失了上下文。一个好的起点是查看 GLSurfaceView 文档，特别是方法[setPreserveEGLContextOnPause(...)](http://developer.android.com/reference/android/opengl/GLSurfaceView.html#setPreserveEGLContextOnPause%28boolean%29)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T16:20:24.713

添加`android:hardwareAccelerated="false"`到`<application>`清单是一种解决方法，但不能解决问题。Phil 提到的 OpenGL 状态和上下文保存可能在这里发挥作用。**

# android - Android 从菜单布局中获取属性

> ID：14983985
> 
> 赞同：3
> 
> 时间：2013-02-20T15:43:53.197
> 
> 标签：android, menu, android-menu

我了解如何从布局文件创建菜单的正确用法。

我的问题是：是否可以从菜单文件中获取属性而不膨胀它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:53:10.117

不，你必须给它充气，才能访问它。例如：

```
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    getMenuInflater().inflate(R.menu.my_menu, menu);
    View v = menu.findItem(R.id.item).getActionView(); // Get access to a View associated with example item
    return true;
} 
```

# javascript - 冒泡可用于图像加载事件吗？

> ID：14983988
> 
> 赞同：26
> 
> 时间：2013-02-20T15:44:04.480
> 
> 标签：javascript, dom-events, onload, event-bubbling

我可以用吗：

```
window.addEventListner(); 
```

某种程度上来说。

我所有的图像都有一个`display = 'none'`.

图像加载后，

我想设置`display = 'inline'`

通过这种方式，我可以标准化下载图像时显示的内容。

在这种情况下，我无法预加载我的图像。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2014-07-07T12:55:04.747

在（或感兴趣的图像元素的其他父级）以外的某个 DOM 节点上使用**捕获事件侦听器：**`window`**`body`**

```
document.body.addEventListener(
    'load',
    function(event){
        var tgt = event.target;
        if( tgt.tagName == 'IMG'){
            tgt.style.display = 'inline';
        }
    },
    true // <-- useCapture
) 
```

有了这个，您不必在迭代时（重新）附加事件处理程序`document.images`。

这也适用于动态插入的图像。

[图像的`error`加载事件也是如此。](http://matthewcaruanagalizia.tumblr.com/post/30934181934/error-events-dont-bubble-from-images-and-how-to)MDN：[添加事件监听器](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-21T00:36:16.257

**/事件不会冒泡`load`（`onload`**[参考](https://developer.mozilla.org/en-US/docs/Mozilla_event_reference/load)，[参考](https://developer.mozilla.org/en-US/docs/DOM_Client_Object_Cross-Reference/DOM_Events#Events)），所以~~你要求的是不可能的~~。如其他答案中所建议的，您必须将事件处理程序附加到每个图像节点，或在捕获阶段拦截事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T15:48:30.347

```
Array.prototype.forEach.call(document.querySelectorAll('img'), function (elem) {
    elem.addEventListener('load', function () {
        this.style.display = 'inline';
    });
    if (elem.complete) {
        elem.style.display = 'inline';
    }
}); 
```

如果图像已经偶然加载，则不会触发“加载”事件；因此，我们检查是否`complete`已经设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T15:46:33.640

您可以使用`Image.onload`事件处理程序，但不涉及冒泡。

```
var i = new Image;
i.onload = function() {
  this.style.display = 'block';
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-01T11:02:35.963

由于加载事件不会冒泡，因此您可以启动自己的冒泡事件。一个 jQuery 的例子：

```
<img src="dog.jpg" onload="$(this).trigger('image-loaded')" /> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-20T15:45:32.803

```
$('img').on('load', function() {
    $(this).show()
}) 
```

* * *

没有库：

```
window.onload = function() {
   var imgs = document.querySelectorAll('img')
   imgs.onload = function() {
      this.style.display = 'inline';
   }
} 
```

# rrdtool - RRDTool 数据库定义和绘制数据 - 我需要第二个意见

> ID：14983991
> 
> 赞同：0
> 
> 时间：2013-02-20T15:44:11.170
> 
> 标签：rrdtool

这是我想要实现的目标：我每天读取一次数据（一天中的确切时间不是很重要）。我想将此 DS 的值存档两年前。我需要能够回顾 2 年，我需要每天的值，我还需要查看每周平均值 如果我连续两天错过读数，则应宣布数据未知

这是我正在使用的：

```
rrdtool create Carsforsale.rrd --start 20130217 --step 86400 ^ 
DS:MidsizeCars:GAUGE:172800:U:U ^ 
DS:FullSizeCars:GAUGE:172800:U:U ^ 
RRA:AVERAGE:0:7:104^ 
RRA:LAST:0:7:1:720 
```

我更新了上面的数据库

```
rrdtool update Carsforsale.rrd 1361203200:554:791
rrdtool update Carsforsale.rrd 1361289600:556:795 
```

更新对应昨天和前天（2月18日，2月19日）

我试图用这个来绘制上面的图表

```
rrdtool graph "Inventory.png" \
--start "20130217" \
--imgformat PNG --width 850 --height 400 \
DEF:MidsizeCars=Carsforsale.rrd:MidsizeCars:AVERAGE \
DEF:FullSizeCars=Carsforsale.rrd:FullSizeCars:AVERAGE \
AREA:MidsizeCars#0000FF:"MidsizeCars" \
AREA:FullSizeCars#FF004D:"FullSizeCars:STACK"' 
```

现在这是我的问题：

1.  对于我想做的事情，步数和心跳是否正确定义？
2.  为什么我的图表是空的？
3.  使用名为 RRD Editor 的免费软件实用程序查看数据库，我可以看到最后的值存储在 MidSizeCars 和 FullSizecars 中，但唯一包含已加载到数据库中的内容历史的 DS 是归档功能 LAST 我应该绘制 LAST 或 Average 以查看当前值？

谢谢 C

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T07:22:05.990

由于您想以 1 天的分辨率将数据保留两年，因此您必须为此设置适当的 RRA ...因为这将只有大约 730 个值，所以我不会费心为星期。这将即时计算...

# ios - 使用 customIOS 框架中的类别

> ID：14983993
> 
> 赞同：1
> 
> 时间：2013-02-20T15:44:14.530
> 
> 标签：ios, frameworks, categories

我什至不知道这是否可能，我搜索但没有找到类似的东西。

**我制作了一个自定义框架**（使用[jverkoey/iOS-Framework](https://github.com/jverkoey/iOS-Framework#walkthrough)），旨在成为我公司每个项目的其他框架和工具的集合。

**在这个框架中，我有一个简单的类别**“UIImage+H568”，它仅用于在 iphone 5 存在时自动加载图像。

**我想要的是在使用我的框架的项目中自动使用类别**，或者至少，这些项目可以像在项目本身中一样调用类别。

谢谢你的帮助 ：）

PS：我不想使用框架本身的类别，我这样做是没有问题的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T15:47:02.983

是的，有可能。

我认为Apple的以下技术问答应该会有所帮助

[http://developer.apple.com/library/mac/#qa/qa1490/_index.html](http://developer.apple.com/library/mac/#qa/qa1490/_index.html)