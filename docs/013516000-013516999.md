# StackOverflow 问答 13516000-13516999

# unix-timestamp - 如何使用 UNIX 命令比较两个日期

> ID：13516000
> 
> 赞同：4
> 
> 时间：2012-11-22T15:37:54.567
> 
> 标签：unix-timestamp

我有这样的约会

Date1="2012 年 10 月 21 日星期三 13:05:14"

Date2="2010 年 11 月 21 日星期三 12:55:30"

Date3="2012 年 11 月 21 日星期三 14:22:30"

我如何知道最新日期？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T16:03:42.183

unix`date`命令可以转换日期格式，请参见[此处](https://stackoverflow.com/questions/6508819/convert-date-formats-in-bash)的示例。所以在 bash 中，你会做这样的事情：

```
#!/bin/sh

Date1="Wed Oct 21 13:05:14 2012"
Date2="Wed Nov 21 12:55:30 2010"
Date3="Wed Nov 21 14:22:30 2012"

ts1=`date -d"${Date1}" +%Y%m%d%H%M%S`
ts2=`date -d"${Date2}" +%Y%m%d%H%M%S`
ts3=`date -d"${Date3}" +%Y%m%d%H%M%S`

latest=ts1

if [ $ts2 -gt $ts1 ]; then
    latest=ts2
fi

if [ $ts3 -gt $ts1 ]; then
    latest=ts3
fi

echo "Latest date is ${latest}" 
```

# crontab - crontab 不工作

> ID：13516002
> 
> 赞同：0
> 
> 时间：2012-11-22T15:38:17.533
> 
> 标签：crontab

我有 crontab ：

```
35 16 * * * mysqldump -h mysql2.alwaysdata.com -u user -ppass --all-databases > ../copias/fichero_`date +%d-%m-%Y-%H:%M:%S`.sql 
```

但该命令在没有 crontab 的情况下正常工作。文件夹`chmod 777 -R`。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T15:40:29.690

您应该使用绝对路径而不是`../copias/fichero...`.

当命令由 cron 运行时，您不知道当前目录是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:40:21.257

在 /etc/crontab 文件中，您还必须在要运行的命令之前指定用户名。

# c++ - 如何在谷歌测试中测试多线程？

> ID：13516010
> 
> 赞同：8
> 
> 时间：2012-11-22T15:39:02.863
> 
> 标签：c++, multithreading, googletest

以下测试代码创建了一个服务器和一个客户端套接字。然后客户端向服务器发送消息，服务器回复。就这样。但我无法编译。线程函数中的所有`ASSERT_EQ`内容都会引发错误`"error: void value not ignored as it ought to be"`。我不知道这应该告诉我什么。这里有什么问题？类型无关紧要，因为`ASSERT_EQ(1, 1);`也会引发错误。

**编辑**在谷歌的常见问题解答中找到了这个：

问：我的编译器抱怨“没有按照应有的方式忽略 void 值”。这是什么意思？

答：您可能在不返回 void 的函数中使用了 ASSERT_XY()。ASSERT_XY() 只能用于 void 函数。

我该如何理解？

```
void * serverfunc(void * ptr);  
void * clientfunc(void * ptr);    

TEST(netTest, insert)
{
  pthread_t mThreadID1, mThreadID2;
  ::pthread_create(&mThreadID1, nullptr, serverfunc, nullptr);
  ::sleep(1);
  ::pthread_create(&mThreadID1, nullptr, clientfunc, nullptr);
  ::pthread_join(mThreadID1, nullptr);
  ::pthread_join(mThreadID2, nullptr);        
}

void * serverfunc(void * ptr)
{
  net::ServerSocket serv(IPV4, TCP, 55555,5);
  net::ServerSocket * conn = serv.accept();
  net::Message msg;

  conn->recvmsg(&msg);

  ASSERT_EQ(msg.size(),5);
  ASSERT_EQ(msg[0],1);
  ASSERT_EQ(msg[1],2);
  ASSERT_EQ(msg[2],3);
  ASSERT_EQ(msg[3],4);
  ASSERT_EQ(msg[4],5);

  msg = {9,8,6};
  ASSERT_EQ(msg.size(),3);
  ASSERT_EQ(msg[0],9);
  ASSERT_EQ(msg[1],8);
  ASSERT_EQ(msg[2],6);

  conn->sendmsg(msg);

  ::sleep(1);

  delete conn;
  return 0;
}

void * clientfunc(void * ptr)
{
  net::ClientSocket clie(IPV4, TCP, "localhost",55555);
  net::Message msg;

  msg = {1,2,3,4,5};
  ASSERT_EQ(msg.size(),5);
  ASSERT_EQ(msg[0],1);
  ASSERT_EQ(msg[1],2);
  ASSERT_EQ(msg[2],3);
  ASSERT_EQ(msg[3],4);
  ASSERT_EQ(msg[4],5);

  clie.sendmsg(msg);

  clie.recvmsg(&msg);

  ASSERT_EQ(msg.size(),3);
  ASSERT_EQ(msg[0],9);
  ASSERT_EQ(msg[1],8);
  ASSERT_EQ(msg[2],6);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T22:51:07.557

> 问：我的编译器抱怨“没有按照应有的方式忽略 void 值”。这是什么意思？
> 
> 答：您可能在不返回 void 的函数中使用了 ASSERT_XY()。ASSERT_XY() 只能用于 void 函数。
> 
> 我该如何理解？

您的函数不返回`void`，它们返回`void*`- 即它们返回一些东西（`void*`是一个指向任何东西的指针），而它们应该什么也不返回。常见问题解答说使用 ASSERT_EQ() 的函数需要具有`void`返回类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-10T02:51:52.807

我也有同样的问题，我找到了一个“丑陋”的方法来解决它：

```
void* your_func(void* ptr)
{
    _your_func(ptr);
    reutrn NULL;
}

void _your_func(void* ptr)
{
    ...
    ASSERT_EQ(1, 1);
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:06:01.797

看起来 ASSERT_EQ 只能在具有正确返回类型的函数中调用（这似乎是 void 而你的返回 void *）

就我个人而言，我不喜欢宏的过度使用，但事实就是这样。宏的问题是它混淆了代码，所以你看不到它做错了什么。

所以就写这么一个函数，让serverfunc和clientfunc来调用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T09:43:55.943

按照建议，您应该将`void*`方法的类型替换为`void`,`return 0`和`return`。

# three.js - 在 ThreeJS 中使用 imageData 作为纹理

> ID：13516012
> 
> 赞同：1
> 
> 时间：2012-11-22T15:39:19.313
> 
> 标签：three.js, texture-mapping

我尝试加载 imageData 以在 threeJS 中创建纹理。我尝试这样，但它不起作用。

```
pMaterial =
new THREE.ParticleBasicMaterial({
    color: 0xFFFFFF,
    size: 20,
    map: THREE.DataTexture(
        myimageData
        ),
    blending: THREE.AdditiveBlending,
    transparent: true
}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T07:34:56.003

它适用于以下代码。

```
var texture = new THREE.Texture(myImageData);
texture.needsUpdate = true;

particles = new THREE.Geometry(),
pMaterial =
new THREE.ParticleBasicMaterial({
    size: 20,
    map: texture,
    blending: THREE.AdditiveBlending,
    transparent: true
}); 
```

# java - 如何引用 Jasmine 测试根文件夹上方的文件？

> ID：13516015
> 
> 赞同：2
> 
> 时间：2012-11-22T15:39:26.147
> 
> 标签：java, ruby, unit-testing, jasmine

我有 Java 项目，我们将使用 jasmine gem 进行测试。但是，我不能引用 Jasmine 根文件夹路径上方的任何 javascript。像：

我所有的 javascript 都在 /src/main/webapp/resources/js 下，我的 jasmine 文件夹在 /src/test/unit/js 下。

我尝试将 jasmine.yml 更改为移至 ../../../main/webapp/resources/js 但没有用。

我怎样才能让它工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T18:00:10.417

所以这只是一个设置问题。为了使它工作，有一个 jasmine.yml 并且只是使用“../../../”将 src_dir 更改为顶级文件夹。

之后，将 src_files 更改为 main/xxxxxx/xxxxx/*.js

就这样！

# delphi - Snappy DBExpress SQL 执行器方法

> ID：13516017
> 
> 赞同：3
> 
> 时间：2012-11-22T15:39:29.747
> 
> 标签：delphi, dbexpress

鉴于以下

```
{------------------------------------------------------------------------------}
function TTestClass.NewQuery(const ASql : String) : TSqlQuery;
begin
  Result := TSqlQuery.Create(FConn);
  Result.SQLConnection := FConn;
  Result.Sql.Text := ASql;
  Result.Prepared := True;
end;

{------------------------------------------------------------------------------}
procedure TTestClass.ExecuteSql(const ASql : String);
begin
  with NewQuery(ASql) do
  try
    ExecSql();
  finally
    Free;
  end;
end; 
```

如何创建一个`ExecSql`填充查询参数的方法？

我试过这个重载方法：

```
{------------------------------------------------------------------------------}
procedure TTestClass.ExecuteSql(const ASql : String; const ParamVals : Array Of Variant);
var
  i : integer;
  Qry : TSqlQuery;
begin
  Qry := NewQuery(ASql);
  with Qry do
  try
    for i := Low(ParamVals) to High(ParamVals) do
      Qry.Params[i].Value := ParamVals[i];
    ExecSql();
  finally
    Free;
  end;
end; 
```

但我收到错误消息：

> *MyProj.exe 项目引发异常类 EDatabaseError，并带有消息“参数 'SomeParam' 没有值”。*

观察 Parameter[0] 显然表明该值已设置 - 参数名称与我预期的一样。谁能建议我做错了什么？

而且我过去曾因使用“变体数组”而受到批评——我想知道是否有更好的方法。

谢谢大家。

我发现了一些有趣的东西：

```
ParamByName('SomeParam').Value := 1234567; 
```

产生相同的错误消息，而

```
ParamByName('SomeParam').AsInteger := 1234567; 
```

才不是。

我使用 DBExpress 已经很多年了——我忘记了什么吗？

**编辑**

我想出了一个可行的方法，但对它不满意；通过检查 VALUE 的变体类型，我设法得到了一些结果

```
{------------------------------------------------------------------------------}
procedure TMyTestCase.SetParamValues(const AQuery : TSqlQuery; const ParamVals : Array Of Variant);
var
  i : Integer;
begin
  for i := 0 to AQuery.Params.Count - 1 do begin
    case VarType(ParamVals[i]) of
      varEmpty  :    AQuery.Params[i].AsInteger  := VarNull;       //The variant is Unassigned.
      varNull  :     AQuery.Params[i].AsInteger  := VarNull;       //The variant is Null.
      varAny  :      AQuery.Params[i].AsInteger  := VarNull;       //Represents a Variant that can hold any value.
      varSmallint  : AQuery.Params[i].AsInteger  := ParamVals[i];  //16-bit signed integer (type Smallint in Delphi, short in C++).
      varInteger  :  AQuery.Params[i].AsInteger  := ParamVals[i];  //32-bit signed integer (type Integer in Delphi, int in C++).
      varSingle  :   AQuery.Params[i].AsFloat    := ParamVals[i];  //Single-precision floating-point value (type Single in Delphi, float in C++).
      varDouble  :   AQuery.Params[i].AsFloat    := ParamVals[i];  //Double-precision floating-point value (type double).
      varCurrency  : AQuery.Params[i].AsFloat    := ParamVals[i];  //Currency floating-point value (type Currency).
      varDate  :     AQuery.Params[i].AsDateTime := ParamVals[i];  //Date and time value (type TDateTime).
      varOleStr  :   AQuery.Params[i].AsString   := ParamVals[i];  //Reference to a dynamically allocated UNICODE string.
      varDispatch  : AQuery.Params[i].AsInteger  := VarNull;       //Reference to an Automation object (an IDispatch interface pointer).
      varError  :    AQuery.Params[i].AsInteger  := VarNull;       //Operating system error code.
      varBoolean  :  AQuery.Params[i].AsBoolean  := ParamVals[i];  //16-bit Boolean (type WordBool).
      varVariant  :  AQuery.Params[i].AsInteger  := VarNull;       //Indicates another variant.
      varUnknown  :  AQuery.Params[i].AsInteger  := VarNull;       //Reference to an unknown object (an IInterface or IUnknown interface pointer).
      varShortInt  : AQuery.Params[i].AsInteger  := ParamVals[i];  //8-bit signed integer (type ShortInt in Delphi or signed char in C++).
      varByte  :     AQuery.Params[i].AsInteger  := ParamVals[i];  //A Byte.
      varWord  :     AQuery.Params[i].AsInteger  := ParamVals[i];  //Unsigned 16-bit value (Word).
      varLongWord  : AQuery.Params[i].AsInteger  := ParamVals[i];  //Unsigned 32-bit value (type LongWord in Delphi or unsigned long in C++).
      varInt64  :    AQuery.Params[i].AsInteger  := ParamVals[i];  //64-bit signed integer (Int64 in Delphi or __int64 in C++).
      varStrArg  :   AQuery.Params[i].AsString   := ParamVals[i];  //COM-compatible string.
      varString  :   AQuery.Params[i].AsString   := ParamVals[i];  //Reference to a dynamically allocated string (not COM-compatible).
      varArray  :    AQuery.Params[i].AsInteger  := VarNull;       //Indicates a Variant array.
      varByRef  :    AQuery.Params[i].AsInteger  := VarNull;       //Indicates that the variant contains a reference as opposed to a value.
      varTypeMask:   AQuery.Params[i].AsInteger  := VarNull;       //
    end;
  end;
end; 
```

我肯定错过了一步 - 为什么查询参数没有类型？

**再次编辑**

我目前的“最佳”解决方案是依靠程序员提供正确的类型和数量的值。我已经在上面发布了完整的 SetParamValues() 方法。这绝不是经过彻底测试，但希望它会对某人有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T01:09:05.123

## 没有简单的解决方案

* * *

使用 Delphi XE3 和 MySQL 执行的所有测试

* * *

**行为解释**

在设计时，只要参数依赖于 FROM 表中没有别名的表字段，您将获得正确的参数数据类型

```
SELECT id FROM items WHERE id = :id 
```

但如果不是，它也会失败

```
SELECT id FROM items WHERE id/2 = :id 
```

这也会失败

```
SELECT i.* FROM items i WHERE i.id = :id 
```

在运行时，两者都会产生带有 datatype 的参数`ftUnknown`。

参数在私有方法中设置

```
// Delphi XE3
Data.SqlExpr.TCustomSQLDataSet.SetParameterFromSQL 
```

在此方法中，表名被提取并且仅

```
if csDesigning in ComponentState then 
```

创建一个临时数据集

```
SELECT * FROM <tablename> WHERE 0 = 1 
```

根据该数据集中的字段名称检查每个参数，如果名称匹配，则设置参数数据类型。

`ftUnknown`这就是您在运行时获取参数的原因。

为了解决 Delphi 的问题，您尝试使用您的解决方案，但 dbexpress 有时会失败。参数设置器位于

```
Data.DB.TParam.SetAsVariant 
```

并且 value`1234567`具有变体类型`varLongword`，并且参数数据类型将设置为`ftLongword`并导致此错误。

* * *

**解决方法**

作为一种解决方法，您可以将参数数据类型设置为 ftString/ftWideString，因为这在**大多数**情况下都有效。

```
procedure TTestClass.ExecuteSql(const ASql : String; const ParamVals : Array Of Variant);
var
  i : integer;
  Qry : TSqlQuery;
begin
  Qry := NewQuery(ASql);
  with Qry do
  try
    for i := Low(ParamVals) to High(ParamVals) do
    begin
      Qry.Params[i].DataType := ftWideString;
      Qry.Params[i].Value := ParamVals[i];
    end;
    ExecSql();
  finally
    Free;
  end;
end; 
```

为了获得更好的解决方案，您需要一个程序将参数数据类型设置为`ftString`/`ftWidestring`仅用于关键变体类型（如您的方法 SetParamValues 但更通用）

```
procedure SetParamValues( const AParams : TParams; const AValues : array of Variant );
var
  LIdx : Integer;
  LParam : TParam;
  LValue : Variant;
begin
  for LIdx := 0 to Pred( AParams.Count ) do
  begin
    LParam := AParams[LIdx];
    LValue := AValues[LIdx];
    // only handle the critical parts
    case VarType( LValue ) of
      varByte, varLongword : LParam.DataType := ftWideString;
    end;
    // all other will be set here
    LParam.Value := LValue;
  end;
end; 
```

* * *

**解决方案：艰难的方式**

正如我首先所说，没有简单的解决方案。对于功能齐全的解决方案，您必须解析整个 WHERE 语句

```
SELECT a.*, b*
FROM table1 a
JOIN table2 b ON a.id = b.id
WHERE a.id = :id AND b.count / 2 = :halfcount 
```

并由此构建查询

```
SELECT a.id as Param1, b.count / 2 as Param2
FROM table1 a
JOIN table2 b ON a.id = b.id
WHERE 0 = 1 
```

获得预期的数据类型。

* * *

**解决方案：长路漫漫**

恕我直言，这是一个错误，应该报告给 EMBA ...

* * *

**解决方案：昂贵的方式**

我用[UniDAC](http://www.devart.com/unidac/)做了一个测试，一切都和 dbExpress 一样。参数数据类型是`ftUnknown`，设置参数值会将数据类型设置为`ftLongword`。

但是有一种特殊情况：您不会收到错误消息，并且您的查询会按预期进行处理。

# css - CSS 悬停颜色一直到边缘

> ID：13516023
> 
> 赞同：0
> 
> 时间：2012-11-22T15:39:37.407
> 
> 标签：css

有人可以帮助我需要做些什么来使主导航的“主页”和“博客”部分以悬停颜色一直延伸到最后吗？即，当我将鼠标悬停在任一悬停颜色上时，导航中的主页和博客部分的左侧和右侧仍然有一点深棕色区域。

www.utahshutters.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:43:17.980

从此更改您的CSS：

```
 #nav ul{
       width: 950px;
       padding: 0 0 0 10px;
    }

    #nav li a{
      padding 13px 17px 12px 15px;}

    } 
```

对此

```
 #nav ul{
       //width removed
       padding: 0 0 0 0;
    }

    #nav li a{
      padding 13px 17px 12px 16px;

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:50:08.590

为了使导航栏中的列表项加起来为整个宽度，您需要为每个 Lis 提供一个单独的宽度，该宽度加起来等于总宽度。

'a' 标签可以被设置为 display:block 以扩展到每个 LI 的宽度。

您的导航栏 ( UL ) 需要有 960px 的宽度或没有宽度。

希望这是有道理的。

# spring - 在没有注释参数的情况下获取 resteasy servlet 上下文

> ID：13516025
> 
> 赞同：0
> 
> 时间：2012-11-22T15:39:42.287
> 
> 标签：spring, jsf-2, resteasy

快速项目说明：我们有一个基于 JSF2 + Spring 的带有动态数据源的构建应用程序。数据引用控件是使用 spring-config 进行的：

```
<bean id="dataSource" class="com.xxxx.xxxx.CustomerRoutingDataSource">
.... 
```

和一个类（上面引用）：

```
public class CustomerRoutingDataSource extends AbstractRoutingDataSource {

@Override
protected Object determineCurrentLookupKey() {
    return CustomerContextHolder.getCustomerType();
}

public Logger getParentLogger() throws SQLFeatureNotSupportedException {
    return null;
}
} 
```

上面调用的 CustomerContextHolder 如下：

```
public class CustomerContextHolder {

private static final ThreadLocal<String> contextHolder = new ThreadLocal<String>();

public static void setCustomerType(String customerType) {
    contextHolder.set(customerType);
}

public static String getCustomerType() {

    String manager = (String)FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("dataBaseManager");

    if (manager != null) {
        contextHolder.set(manager);
        FacesContext.getCurrentInstance().getExternalContext().getSessionMap().put("dataBaseManager", null);
    } else {
        String base =     (String)FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("currentDatabBase");
        if (base != null)
            contextHolder.set(base);
    }
    return (String) contextHolder.get();
}

public static void clearCustomerType() {
    contextHolder.remove();
}
} 
```

问题是最后一个人正在调用 FacesContext.getCurrentInstance() 来获取 servlet 上下文。只是为了解释一下，它使用会话属性 dataBaseManager 来告诉它应该使用哪个基础。对于实际的解决方案，它运行良好，但是通过 RESTEASY Web 服务的实现，当我们发出 get 请求时，FacesContext.getCurrentInstance() 显然返回 null 并崩溃。

我进行了很多搜索，但找不到从 @GET 参数之外获取 servlet-context 的方法。我想知道是否有任何方法可以得到它，或者我的动态数据源问题是否有另一种解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T11:44:32.940

就像魔术一样，可能没有多少人知道。

我深入研究了 Resteasy 文档，发现了 resteasy jar 附带的 springmvc 插件的一部分，它有一个名为 RequestUtil.class 的类。这样，我就可以在没有“@Context HttpServletRequest req”参数的情况下使用 getRequest() 方法。

使用它，我能够在请求属性上设置所需的数据库，并从另一个线程（由 spring 调用）获取它并从正确的位置加载内容！

我现在使用它一个星期，它就像一个魅力。我唯一需要做的就是将上面的 determineLookupKey() 更改为：

```
 @Override
protected String determineCurrentLookupKey() {
    if (FacesContext.getCurrentInstance() == null) {
        //RESTEASY
        HttpServletRequest hsr = RequestUtil.getRequest();
        String lookUpKey = (String) hsr.getAttribute("dataBaseManager");
        return lookUpKey;
    }else{
        //JSF
        return CustomerContextHolder.getCustomerType();         
    }
} 
```

希望这对其他人有帮助！

蒂亚戈

# matlab - 在一个数组中查找不在另一个数组中的元素

> ID：13516028
> 
> 赞同：7
> 
> 时间：2012-11-22T15:39:47.560
> 
> 标签：matlab

我有两个数组可以说 A = [1;2;4;7;10;20]; B = [1;4;8];

现在我想找到 A 中不在 B 中的元素，即；[2;7;10;20]。我只需要它们的索引，即 A 中元素 [2;7;10;20] 的索引。如何在 matlab 中实现它。我可以使用循环和所有。但这不是我想要的。我想要一个优雅的解决方案。建议？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T15:48:26.797

您可以使用该`ismember`功能来做到这一点。

```
A = [1;2;4;7;10;20]; 
B = [1;4;8];
ismem = ismember(A,B); 
```

会给你

```
[1 0 1 0 0 0]' 
```

如果你真的需要索引，你可以使用`find`.

```
find(ismem==0) 
```

提醒一下，您始终可以像这样使用逻辑索引：

```
A(~ismem) 
```

会给你

```
[2 7 10 20]' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T15:47:00.083

如果您想要 A 中不在 B 中的元素，您可以使用[setdiff](http://www.mathworks.co.uk/help/matlab/ref/setdiff.html)。

如果你想要元素的索引而不是它们的值，你可以使用[ismember](http://www.mathworks.co.uk/help/stats/ordinal.ismember.html)并否定结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-22T15:48:47.610

签出`setxor`：

[C, ia, ib] = setxor(A, B)

[这](http://www.mathworks.com/help/matlab/ref/setxor.html)是 Mathworks 页面。您将需要`ia`那些在 A 但不在 B 中的索引。

# css - Listcontent 的自定义对齐问题

> ID：13516029
> 
> 赞同：0
> 
> 时间：2012-11-22T15:39:51.150
> 
> 标签：css

我的新帮助：

我尝试了很多东西，但没有一个效果很好。我想让像“Sympany Hauptsitz”中心和Nan KM 这样的文本有点不利。

如何从文本中更改位置？

这是我的问题的图片。

![在此处输入图像描述](../Images/1a9b54c26175c8a79c823486f58540ec.png)

我有这个源代码：

这是我的源代码：

```
<section id="listview">
<ul class="liste">

</ul>
</section>

<script>
//laden der json datei und befüllen der Tabelle
$.getJSON('faddress.json', function(json){
var erg = json;
$.each(json, function(i, daten){
//Kartenausschnitt
var ausschnitt = 'http://maps.googleapis.com/maps/api/staticmap?size=50x50&markers=color:blue|size:tiny|'+daten.Position.Latitude+','+daten.Position.Longitude+'&sensor=true';

$('#listview').find('ul.liste').append('<li><img src="'+ausschnitt+'">'+ i +'<span>'+ entfernungBerechnen(mylongitude,mylatitude,daten.Position.Longitude,daten.Position.Latitude )+'</span></li>');
});
});
</script> 
```

而这个Sytelsheet：

```
ul.liste {
padding: 0;
margin: 9px;
list-style: none;
border: 1px solid #a1a7ad;
border-radius: 8px;

font-weight: bold;
box-shadow: 0 1px 0 #fff;
}

ul.liste li {
background: #f7f7f7;
border-top: 1px solid #fdfdfd;
border-bottom: 1px solid #cacaca;
padding: 5px 10px;
line-height: 30px;
font-size:12px;
height: 50px;
}

ul.liste li:first-child {
border-top-left-radius: 8px;
border-top-right-radius: 8px;
border-top-color: #e5e5e5;
}

ul.liste li:last-child {
border-bottom-left-radius: 8px;
border-bottom-right-radius: 8px;
}

ul.liste li span {
float: right;
display: block;
color: #999;
font-weight: normal;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:44:10.753

**样式列表的 #1 规则：**

`display:block`在-tag 上使用`A`并将所有非位置样式放在 A-tag 上，而不是`LI`.

对于 LI，仅使用:`display:` `position:`和`float:`，其余的继续使用 A。

# c++ - 一般的OpenCV线检测

> ID：13516031
> 
> 赞同：6
> 
> 时间：2012-11-22T15:39:55.953
> 
> 标签：c++, opencv, feature-detection

我是 opencv 的新手（在 c++ 中），我正在尝试实现线路检测。

我有一张带有几条线的图片，我正在尝试确定线条之间的距离。我知道有 Hough、Canny 等，但我怎样才能得到不同线条的坐标来计算线条之间的距离？我应该使用opencv轮廓函数还是有更好的方法？我不需要完整的代码示例，但谁能告诉我完成工作的最佳方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-22T16:43:14.903

线检测通常导致使用霍夫变换，Canny 边缘检测器和轮廓检测仅在需要时充当方便的预处理器。

如果您有**平行线**，请使用

```
void HoughLines(InputArray image, OutputArray lines, double rho, double theta, int threshold, double srn=0, double stn=0 ) 
```

用于检测第二个参数将包含检测的行：

> 线 - 线的输出向量。每条线由一个二元素向量 (ρ, θ) 表示。ρ 是距坐标原点 (0, 0)（图像左上角）的距离。θ 是以弧度为单位的线旋转角度（ 0 ∼ 垂直线， π/2 ∼ 水平线 ）。
> [opencv2refman.pdf]

这意味着，两条线之间的距离应该是`abs(rho1-rho2)`，距离是 的第一列中像素值之间的绝对差`lines`。（注意：方法应该在`CV_HOUGH_STANDARD`这里！）

对于**非平行线**，您必须定义您认为的距离，但 OpenCV 可能仍会为您提供每条检测到的线的端点坐标。
你只需要使用`method = CV_HOUGH_PROBABILISTIC`.

> CV_HOUGH_PROBABILISTIC 概率霍夫变换（如果图片包含一些长线性段，则更有效）。它返回线段而不是整条线。每个段由起点和终点表示，并且矩阵必须是（创建的序列将是）CV_32SC4 类型。
> [opencv2refman.pdf]

您还可以在`opencv_tutorials.pdf`已安装 OpenCV 的文档中找到教程。

# ios - Phonegap Sqlite Order by Not Correct utf8 问题

> ID：13516032
> 
> 赞同：2
> 
> 时间：2012-11-22T15:40:04.290
> 
> 标签：ios, sqlite, cordova

我正在尝试在 Phonegap 上使用 Sqlite 对 SQL 排序数据进行排序，但结果不正确！这将是：abcçdeéě

我的代码：

```
db.transaction(function(tx){

        tx.executeSql('SELECT id,keyword FROM Glossary ORDER BY lower(keyword) COLLATE NOCASE',[] , function(tx, results){
            var lastAlpha = "*";
            for(i=0;i<results.rows.length;i++){
                var firstChr = results.rows.item(i).keyword.substring(0,1).toUpperCase();
                if(firstChr!=lastAlpha){
                    console.log(firstChr);
                    lastAlpha = firstChr;
                }
            }
        },errorCB2);
    }); 
```

结果 ：

```
2012-11-22 17:14:14.641[15032:c07] [LOG] A
2012-11-22 17:14:14.641[15032:c07] [LOG] B
2012-11-22 17:14:14.642[15032:c07] [LOG] C
2012-11-22 17:14:14.644[15032:c07] [LOG] D
2012-11-22 17:14:14.645[15032:c07] [LOG] E
2012-11-22 17:14:14.646[15032:c07] [LOG] F
2012-11-22 17:14:14.647[15032:c07] [LOG] G
2012-11-22 17:14:14.648[15032:c07] [LOG] H
2012-11-22 17:14:14.649[15032:c07] [LOG] I
2012-11-22 17:14:14.650[15032:c07] [LOG] J
2012-11-22 17:14:14.651[15032:c07] [LOG] K
2012-11-22 17:14:14.652[15032:c07] [LOG] L
2012-11-22 17:14:14.654[15032:c07] [LOG] M
2012-11-22 17:14:14.655[15032:c07] [LOG] N
2012-11-22 17:14:14.656[15032:c07] [LOG] O
2012-11-22 17:14:14.657[15032:c07] [LOG] P
2012-11-22 17:14:14.658[15032:c07] [LOG] Q
2012-11-22 17:14:14.659[15032:c07] [LOG] R
2012-11-22 17:14:14.660[15032:c07] [LOG] S
2012-11-22 17:14:14.661[15032:c07] [LOG] T
2012-11-22 17:14:14.662[15032:c07] [LOG] U
2012-11-22 17:14:14.664[15032:c07] [LOG] V
2012-11-22 17:14:14.665[15032:c07] [LOG] W
2012-11-22 17:14:14.666[15032:c07] [LOG] X
2012-11-22 17:14:14.668[15032:c07] [LOG] Y
2012-11-22 17:14:14.669[15032:c07] [LOG] Z
2012-11-22 17:14:14.671[15032:c07] [LOG] Ç
2012-11-22 17:14:14.672[15032:c07] [LOG] É
2012-11-22 17:14:14.673[15032:c07] [LOG] Ö
2012-11-22 17:14:14.674[15032:c07] [LOG] Ü
2012-11-22 17:14:14.674[15032:c07] [LOG] İ
2012-11-22 17:14:14.676[15032:c07] [LOG] Ş 
```

我在 The Last 看过像“拉丁人物”这样的作品。！你有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T19:32:53.340

[http://www.sqlite.org/datatype3.html#collat​​ion](http://www.sqlite.org/datatype3.html#collation)

> NOCASE - 与二进制相同，除了 ASCII 的 26 个大写字符在执行比较之前被折叠成它们的小写等效字符。请注意，只有 ASCII 字符是大小写折叠的。由于所需表的大小，SQLite 不会尝试进行完整的 UTF 大小写折叠。

我相信这是说 SQLite 不会提供这种排序，因为它需要太多的处理时间才能实现。SQLite 确实提供了一个接口来定义您自己的排序规则序列（http://www.sqlite.org/c3ref/create_collat​​ion.html），但我认为这在 PhoneGap 中并不容易使用。

如果您非常确定要进行这种排序，您可以稍微修改一下并执行多个查询，这些查询将基于“开始于”类型运算符进行查询，然后以所需的顺序将它们链接在一起。但我一想到真正尝试这样做就感到畏缩。

# java - 如何使用弹簧安全检测会话超时过期？

> ID：13516033
> 
> 赞同：0
> 
> 时间：2012-11-22T15:40:09.947
> 
> 标签：java, ajax, jsf, spring-security

在没有导航的 JSF 应用程序中超时到期时如何检测和重定向页面。我的应用程序只包含一个 xhtml 页面。以及如何调整超时？

# windows - Windows 7 和 Windows 8（桌面/Metro）之间的 Internet Explorer 10 有何不同？

> ID：13516041
> 
> 赞同：3
> 
> 时间：2012-11-22T15:40:47.880
> 
> 标签：windows, internet-explorer, windows-7, windows-8, cross-browser

Windows 7 和 Windows 8（桌面模式和/或 Metro 模式）上的 IE10 有什么区别。

像：

*   渲染差异（包括硬件加速、DX 过滤器和媒体查询）
*   JS 差异（例如触摸事件、窗口大小调整）
*   插件差异（他们沙箱 Flash 不同吗？）
*   怪癖（兼容性）模式差异

没有那么多的东西：

*   [在 Windows 8 和其他Windows 8 集成](http://msdn.microsoft.com/en-us/library/ie/hh781490%28v=vs.85%29.aspx)中将站点“[固定](http://blogs.msdn.com/b/ie/archive/2012/04/03/pinned-sites-in-windows-8.aspx)”到开始屏幕的能力
*   [用户代理](http://msdn.microsoft.com/en-us/library/ie/hh920767%28v=vs.85%29.aspx)（在`Windows NT 6.2`Windows 8 上，`Windows NT 6.1`在 Windows 7 上）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T15:58:55.173

微软似乎在这里总结得很好：[Windows 7 上的 Internet Explorer 10](http://msdn.microsoft.com/en-us/library/ie/jj819730%28v=vs.85%29.aspx)

# xml - xslt 中的 for-each

> ID：13516046
> 
> 赞同：0
> 
> 时间：2012-11-22T15:41:07.867
> 
> 标签：xml, xslt

我需要循环我的根标签内的所有元素，比如

```
<?xml version="1.0" encoding="UTF-8"?>    
<root>
<mijnFamilyPack>
    <rt>id123</rt>
    <rt>id345</rt>
    <rt>id084</rt>
    <INPORTING>NO</INPORTING>
    <id>345</id>
</mijnFamilyPack>
</root> 
```

我写了 for-each 来获取所有“rt”元素值。但我可以单独使用第一个 cvalue。

```
<xsl:for-each select="/root/mijnFamilyPack/">
<xsl:value-of select="rt"/>
</xsl:for-each> 
```

我如何单独获得“rt”值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:43:30.043

您只有一个 node 实例`mijnFamilyPack`，因此`<xsl:for-each select="/root/mijnFamilyPack/">`循环一次，您正在打印第一个`rt`节点的值。

您可能还希望将`rt`节点也放入您的`for-each`并打印当前节点的值，如下所示：

```
 <xsl:for-each select="/root/mijnFamilyPack/rt">
       <xsl:value-of select="."/>
 </xsl:for-each> 
```

如果您认为可能有多个节点，`mijnFamilyPack`则使用嵌套循环，首先迭代`mijnFamilyPack`，然后再迭代`rt`内部`mijnFamilyPack`节点。

```
 <xsl:for-each select="/root/mijnFamilyPack/">
    <xsl:for-each select="rt">
       <xsl:value-of select="."/>
    </xsl:for-each>
 </xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T15:42:58.807

您正在选择`mijnFamilyPack`节点，而不是`rt`节点集：

```
<xsl:for-each select="/root/mijnFamilyPack/rt">
   <xsl:value-of select="."/>
</xsl:for-each> 
```

但是，请考虑使用实际模板而不是`for-each`：

```
<xsl:template match="/root/mijnFamilyPack/rt">
   <xsl:value-of select="."/>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T19:30:33.030

就像 Oded 所说，您应该使用模板来匹配`rt`元素。`For-each`不应在此处使用（另请参阅此线程中的答案：[For loops vs. apply-templates](https://stackoverflow.com/questions/6342902/for-loops-vs-apply-templates)）

如果将此 XSLT 应用于源 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
version="1.0">

<xsl:template match="/">
    <list>
        <xsl:apply-templates select="//rt"/>
    </list>
</xsl:template>

<xsl:template match="rt">
    <rt>
        <xsl:value-of select="."/>
    </rt>
</xsl:template>

</xsl:stylesheet> 
```

你得到想要的输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<list>
<rt>id123</rt>
<rt>id345</rt>
<rt>id084</rt>
</list> 
```

# xml - 在 .NET 2.0 中选择具有相同属性名称的单个节点

> ID：13516048
> 
> 赞同：2
> 
> 时间：2012-11-22T15:41:11.500
> 
> 标签：xml, vb.net, asp.net-2.0

我的 xml 看起来像

```
<article>
    <article-id pub-id-type="local">ABC</article-id>
    <article-id pub-id-type="external">XYZ</article-id>
</article> 
```

我可以做到以下几点

```
dim articleId as string =  doc.SelectSingleNode("./article/article-id", nsm).InnerText 
```

结果是ABC

我不知道如何让结果成为 XYZ - 我假设因为我使用的是 SelectSingleNode 它正在获取第一项。有没有办法告诉它获得第二个？

请注意，虽然我展示了一个只有 2 个节点的示例，但可能有任何数字，因此它必须是“可搜索”的，名称为“外部”

我以前没有真正使用过 .NET 2.0，而且 MSDN 并没有真正帮助我。

任何帮助都会很棒，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:47:16.880

您可以使用以下 XPath：

```
"./article/article-id[@pub-id-type='external']" 
```

是`[@pub-id-type='external']`一个属性过滤器。

如果您有多个可能的元素，则可以添加`[last()]`以获取最后一个。

有关更多 XPath 信息，请查看[此页面](http://msdn.microsoft.com/en-us/library/ms256086.aspx)。

# php - PHP 下载页面：file_exists() 返回 true，但浏览器返回 'page not found'

> ID：13516050
> 
> 赞同：1
> 
> 时间：2012-11-22T15:41:22.880
> 
> 标签：php, wordpress, .htaccess, download

我正在使用 PHP 作为文件下载页面。这是问题代码的片段：

```
if (file_exists($attachment_location)) {
    header($_SERVER["SERVER_PROTOCOL"] . " 200 OK");
    header("Cache-Control: public"); // needed for i.e.
    header("Content-Type: application/zip");
    header("Content-Transfer-Encoding: Binary");
    header("Content-Length:".filesize($attachment_location));
    header("Content-Disposition: attachment; filename=file.zip");
    readfile($attachment_location);  
    die("Hooray");   
}
else {
    die("Error: File not found.");
} 
```

此代码在本地测试时工作得非常好，但在部署到实时服务器后，浏览器会返回“找不到页面”错误。我认为这可能是一个 .htaccess 问题，但实时服务器上的所有 .htaccess 文件都与它们的本地对应文件相同。我的下一个猜测是实时服务器的 PHP 配置，但我不知道什么 PHP 设置可能会导致这种行为。

file_exists() 函数总是返回 true - 我已经在实时服务器上检查了这个，它总是正确地获取文件、它的大小等，所以它确实有一个文件句柄。它只是不会执行下载！

主站点是一个 Wordpress 站点，但此代码不是 Wordpress 页面的一部分 - 它位于站点根目录中的独立目录中。

更新： is_file() 和 is_readable() 都为文件返回 true，所以这不是问题。导致问题的特定行是：

```
readfile($attachment_location) 
```

在那之前的一切都非常快乐。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T15:48:25.793

仅仅因为一个文件存在并不意味着你可以提供它。它可能具有错误的权限，或者在其他内容写入时被锁定，它甚至可能根本不是文件。file_exists 函数为目录、符号链接等返回 true。

您可能想看看使用 is_file 代替。此外，您可能还想查看 is_readable 以进行文件权限检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:48:25.107

原来是文件大小问题。有问题的文件非常大（超过 300MB）——我尝试用较小的文件（~1MB）替换它，一切都按预期工作。下一个障碍是尝试让服务器处理大文件！感谢大家的帮助。

[编辑：在 php.net](http://php.net/manual/en/function.readfile.php)的 readfile 函数页面上有很多关于 readfile 函数的限制以及如何规避它们的讨论

# javascript - Knockoutjs 自定义绑定以显示加载 gif

> ID：13516052
> 
> 赞同：2
> 
> 时间：2012-11-22T15:41:29.197
> 
> 标签：javascript, knockout.js, custom-binding

我正在尝试创建一个自定义绑定，该绑定将在加载内容时显示加载 gif。

```
ko.bindingHandlers.loader = {
    init: function (element) {
        $('<div>').addClass('loader').hide().appendTo($(element));
    },
    update: function (element, valueAccessor) {
        var isLoading = ko.utils.unwrapObservable(valueAccessor());
        var $element = $(element);
        var $children = $element.children(':not(.loader)');
        var $loader = $(element).find('.loader');

        if(isLoading) {
            $children.stop(true).css('visibility', 'hidden').attr('disabled', 'disabled');
            $loader.stop().fadeIn();
        } else {
            $loader.stop(true).fadeOut(function () {
                $children.css('visibility', 'visible').removeAttr('disabled');
            });
        }
    }
}; 
```

我可以在`div.loader`附加到的 init 中看到，并且可以看到更新函数在更改为 true`element`时触发。`isLoading`但是一旦图像加载（通过加载我的意思是每个图像在其各自的加载事件上返回一个已解决的承诺）我看不到更新触发一次`isLoading`被设置回false。

**视图模型**

```
function viewModel() {
    var self = this;

    self.movies = ko.observableArray([]);
    self.searchValue = ko.observable();
    self.isLoading = ko.observable(false);

    self.search = function () {
        self.isLoading = true;
        $.getJSON(arguments[0].action, { name: this.searchValue() }, function (data) {
            self.movies(data);
            $.when.apply($, promises).done(function() {
                setThumbnailHeight(function () {
                    self.isLoading = false;
                });
            });
        });
    }; 
    var setThumbnailHeight = function(callback) {
        var $items = $('.thumbnails li');
        var maxHeight = Math.max.apply(null, $items.map(function () {
            return $(this).innerHeight();
        }).get());
        $items.css('height', maxHeight);
        callback();
    };

}

ko.applyBindings(new viewModel()); 
```

`setThumbnailHeight`正在正确的时间被调用（一旦所有的承诺都解决了）并且工作正常，因为我看到它将每个的高度设置为`li`最大高度并且可以看到回调（在这种情况下`function(){ self.isLoading = false; }` 被调用。

**我的绑定**

```
<ul class="content thumbnails" data-bind="foreach: movies, loader: $root.isLoading">
    <li class="movie">
        ...
    </li>
</ul> 
```

回顾一下，问题在于加载 gif 将在`isLoading`设置为 true 时显示，但在设置回 false 时不会隐藏和显示新加载的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T15:45:27.267

所有的 observables 都是函数，所以你不能使用`=`. 使用`self.isLoading(true);`代替`self.isLoading = true;`

```
self.search = function () {
    self.isLoading(true);
    $.getJSON(arguments[0].action, { name: this.searchValue() }, function (data) {
        self.movies(data);
        $.when.apply($, promises).done(function() {
            setThumbnailHeight(function () {
                self.isLoading(false);
            });
        });
    });
};

function(){ self.isLoading(false); } 
```

# java - For 循环形式为：Java 中的“for (A b : c)”

> ID：13516053
> 
> 赞同：4
> 
> 时间：2012-11-22T15:41:34.050
> 
> 标签：java, loops, for-loop, foreach

这是我第一次看到这种语法：

```
// class Node
public class Node { 

...
...

}

public class Otherclass { ... }

Otherclass graph = new Otherclass();

// getSuccessors is a method of Otherclass class 

Node currentNode ;

List<Node> successors = graph.getSuccessors(currentNode);

// weird for loop 

for (Node son : successors) { 

// do something 

} 
```

那是什么for循环？某种 Matlab 语法？

有没有其他方法可以编写 for 循环？

问候

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T15:42:44.173

那是一个**[`for-each`](http://www.leepoint.net/notes-java/flow/loops/foreach.html)**循环（也称为`enhanced-for`.）

```
for (type var : arr) { //could be used to iterate over array/Collections class
    body-of-loop
} 
```

> Java 5 中扩展了基本的 for 循环，以使对数组和其他集合的迭代更加方便。这种较新的 for 语句称为增强的 for 或 for-each

**[（文档）](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-22T15:43:23.860

这是一个 for each 循环。你也可以这样写：

```
for(int i = 0; i < successors.size(); i++) {
    Node son = successors.get(i);
} 
```

尽管我个人唯一一次这样做是在需要索引来执行除访问元素之外的其他操作时。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-22T15:44:20.660

它是增强的 for 语句。请参阅第[14.14.2 节。Java 语言规范的增强 for 语句](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.14.2) 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-22T15:42:56.773

它被称为`Enhanced for-loop`。它基本上通过按顺序获取每个元素来迭代集合。所以你不需要访问索引上的元素。

```
List<Integer> list = new ArrayList<Integer>();

for (int val: list) {
    System.out.println(val);  // Prints each value from list
} 
```

请参阅[**§14.14.2 -**](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.14.2) Java 语言规范的增强 for 循环部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-22T15:46:03.873

这是您的 for 循环的一种表示形式

```
for(int i=0;i<successors.size();i++){

        Node myNode = successors.get(i);
    } 
```

这不是 for 循环，但您仍然可以这样做。

```
Iterator<Node> itr = successors.iterator();

    while(itr.hasNext()){
        Node myNode = itr.next();
        // your logic
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-22T15:43:09.520

它的意思是“对于每个`son`in `successors`，其中的类型`son`是`Node`”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-22T15:49:56.493

它被称为增强的 for 循环，而不是使用迭代器来迭代一个集合，你可以简单地使用这个 for 循环

使用迭代器

```
Iterator<String> i=a.iterator();

while(i.hasNext())
{
String s=i.next();
} 
```

您可以简单地使用增强的 for 循环。

```
for(String s : a)
{
 .. do something
} 
```

所以它只是 Java 5 中引入的一种语法糖，它执行与迭代器相同的功能，并且它在内部使用迭代器。该类应实现 Iterator 接口才能使用此 for 循环

```
class Node<T> implements Iterator<String>{

@Override
public boolean hasNext() {
    // TODO Auto-generated method stub
    return false;
}

@Override
public String next() {
    // TODO Auto-generated method stub
    return null;
}

@Override
public void remove() {
    // TODO Auto-generated method stub

}

} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-03-09T15:05:17.727

在这种情况下，它是一个 for each 循环，它是这样写的

# html - 使文本和导航栏垂直和相对水平固定？

> ID：13516061
> 
> 赞同：2
> 
> 时间：2012-11-22T15:42:03.647
> 
> 标签：html, css

在网站 www.bedriftsdesign.no 上工作，我同时制作了导航和#landing-text（在标题图像顶部固定。

当我将他们的位置更改为固定时，尽管发生了其他事情。尽管它们在垂直滚动时会保持固定，但如果您水平滚动（尤其是在小屏幕上），它们将不会粘在它们的位置上。

所以我的问题是，我可以制作固定（垂直）和相对（水平）的东西吗？如果是这样，怎么做？

这是一个可以运行的网站示例，以及我想要获得的大致内容：www.googleventures.com

谢谢

# macos - 如何在我的 Mac 计算机上删除整个 SQLAlchemy 数据库？

> ID：13516062
> 
> 赞同：0
> 
> 时间：2012-11-22T15:42:04.173
> 
> 标签：macos, sqlite

我意识到我的 MacBook Pro 上存储了太多数据库。在我的大多数文件中，我通过以下方式初始化数据库：

> app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:////tmp/UNIQUE_NAME'

但是，我似乎无法访问此目录，并且`tmp`在 Spotlight 中搜索该文件夹不会返回我正在寻找的文件夹。那么，我怎样才能访问这个文件夹并删除它包含的一些数据库。提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T19:32:18.680

这实际上是一个 OS X 问题，但在 OS X 中，转到 Finder，选择 Go 菜单，然后选择 Go to Folder。然后键入“/tmp”作为要转到的文件夹。

您应该能够看到您的数据库并从那里删除。

FWIW，您可以在任何地方创建 SQLlite 数据库 - 例如，在 Documents 目录中创建一个“db”文件夹，然后将其用作配置：

```
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:////Users/you/Documents/db/UNIQUE_NAME' 
```

这样，在您完成数据库后，清除您的数据库会容易得多。

# android - adb 无法检测到 Xperia S

> ID：13516064
> 
> 赞同：2
> 
> 时间：2012-11-22T15:42:05.983
> 
> 标签：android, adb

我有一个问题。我使用 Xperia S 作为 Android 设备来测试我的项目。我按照以下步骤操作： - 将手机与笔记本电脑连接，打开 USB 调试 - 我在设备管理器中再次检查，笔记本电脑识别出我的手机。（这意味着我可以访问手机的 SD 卡） - 在 cmd promt 中，我输入了“adb devices”=> 没有显示任何连接的设备，即使通过 Eclipse 也不显示。- 我尝试了“adb usb”=> 显示“错误：未找到设备” - 我还尝试重新启动 adb 服务器（“adb kill-server”和“adb start-server”），但它仍然无法正常工作。谁能指导我如何将我的设备连接到 adb？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T15:46:51.350

您需要下载并安装索尼 xperia S 驱动程序才能工作。从这里获取它[http://www.sonymobile.com/global-en/support/phones/xperia-s/](http://www.sonymobile.com/global-en/support/phones/xperia-s/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:46:14.180

您需要安装 ADB 驱动程序才能进行调试。您的机器将设备视为 SD 卡这一事实无关紧要。

# android - 为列表视图设置字体

> ID：13516068
> 
> 赞同：1
> 
> 时间：2012-11-22T15:42:13.373
> 
> 标签：android, listview, fonts, typeface

我尝试使用这种方法为文本视图设置字体：

```
public static final void setAppFont(ViewGroup mContainer, Typeface mFont)
{
    if (mContainer == null || mFont == null) return;

    final int mCount = mContainer.getChildCount();

    // Loop through all of the children.
    for (int i = 0; i < mCount; ++i)
    {
        final View mChild = mContainer.getChildAt(i);
        if (mChild instanceof TextView)
        {
            // Set the font if it is a TextView.
            ((TextView) mChild).setTypeface(mFont);
        }
        else if (mChild instanceof ViewGroup)
        {
            // Recursively attempt another ViewGroup.
            setAppFont((ViewGroup) mChild, mFont);
        }
    }
}
@Override
protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    // See assets/res/any/layout/styled_text.xml for this
    // view layout definition.
    setContentView(R.layout.read_asset);

    final Typeface mFont = Typeface.createFromAsset(getAssets(),
            "myfont.otf"); 
            final ViewGroup mContainer = (ViewGroup) findViewById(
            android.R.id.content).getRootView();
            MyActivity.setAppFont(mContainer, mFont);
} 
```

但现在我想为这个 listview 适配器设置相同的字体：

```
public class MainActivity extends Activity {

// List view
private ListView lv;

// Listview Adapter

ArrayAdapter<String> adapter;

// Search EditText
EditText inputSearch;

// ArrayList for Listview

ArrayList<HashMap<String, String>> productList;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Listview Data

String products[] = {"item1", "item2","item3","item4","item5","item6" };

    lv = (ListView) findViewById(R.id.list_view);
    inputSearch = (EditText) findViewById(R.id.inputSearch);

    // Adding items to listview

    adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.product_name, products);
    lv.setAdapter(adapter);

    /**
     * Enabling Search Filter
     * */
    inputSearch.addTextChangedListener(new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence cs, int arg1, int arg2, int arg3) {
            // When user changed the Text
            MainActivity.this.adapter.getFilter().filter(cs);
        }

        @Override
        public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
                int arg3) {
            // TODO Auto-generated method stub

        }

        @Override
        public void afterTextChanged(Editable arg0) {
            // TODO Auto-generated method stub
        }
    });
}
} 
```

有什么建议吗？先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T15:52:15.917

只需覆盖`getView`适配器的方法：

```
 final Typeface mFont = Typeface.createFromAsset(getAssets(), "myfont.otf"); 
    adapter = new ArrayAdapter<String>(this, R.layout.list_item, R.id.product_name, products) {
        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            ViewGroup view = (ViewGroup) super.getView(position, convertView, parent);
            if(convertView == null) MyActivity.setAppFont(view, mFont);
            return view;
        }
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:49:14.840

这是你需要的吗？我建议您使用自定义列表适配器，它可以帮助您根据需要添加或自定义列表视图。

例如在 getView() 方法中，您可以这样做

```
public View getView(int arg0, View arg1, ViewGroup arg2) {
View convertView = arg1;

            if(convertView == null)
            {
                 inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            }
            convertView = inflater.inflate(R.layout.inflating, arg2, false);
            TextView mTV_names = (TextView)convertView.findViewById(R.id.inflating_TV_names);

            // typeface used to display the text in different language other than english 
            // here it is tamil, hindi and telugu.

            Typeface face = Typeface.createFromAsset(getAssets(), "DroidSansRegionalAAD.ttf");

            //setting the typeface to the particular text 

            mTV_names.setTypeface(face);
            mTV_names.setText(""+countries[arg0]);
            return convertView;

        }
    } 
```

一旦看看[检查这个](http://codinglookseasy.blogspot.in/2012/08/localization-using-ttf-files.html)

如果您需要使用您尝试使用的函数而不是编写所有内容，只需`setAppFont(convertView, face)`从 getView() 方法调用

# java - 在另一个 JSP 文件中包含 JSP 文件

> ID：13516069
> 
> 赞同：0
> 
> 时间：2012-11-22T15:42:13.503
> 
> 标签：java, jsp, spring-mvc, wizard

我正在编写一个使用 Spring MVC 在我的应用程序中创建用户的向导。在每一步，控制器将为已完成的向导字段设置会话属性。

我希望向导看起来一样，不管它在哪个页面上，除了每个页面的字段，显然。例如，页面顶部的菜单和链接以及底部的按钮应该保持不变。

我有以下 JSP

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
        <title>Create a new User</title>
    </head>

    <body>
        <h1>User Creation Wizard</h1>
        Step <c:out value = "${pageNum}"/>/<c:out value = "${pageMax}"/>

        <form action="" method="POST">
            <jsp:include page="userform${pageView}.jsp"/>

            <input name = "currentPage" type = "hidden" value = "${pageNum}"/>
            <c:if test = "${pageNum > 1}">
                <input name = "prev" type = "submit" value = "Previous" />
            </c:if>

            <c:if test = "${pageNum < pageMax}">
                <input name = "next" type = "submit" value = "Next" />
            </c:if>

            <c:if test = "${pageNum == pageMax}">
                <input name = "submit" type = "submit" value = "Finish" />
            </c:if>
        </form>
    </body>
</html> 
```

在我包含的 jsp 中，是否需要删除`<html>`、`<head>`和`<body>`标签？上面的代码就是基于[这个例子](http://gablog.eu/online/node/89.html)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:50:57.523

是的，您需要从包含的 JSP 文件中删除`<html>`,`<head>`和`<body>`标记。由于它们已经存在于包含文件中，因此保留它们会导致 HTML 无效。

只有您想要改变的内容才会在您包含的 JSP 文件中。其他所有内容，包括必要`<html>`的`<head>`和`<body>`标签，都将在执行包含的 JSP 文件中。

# r - R情节图例行为中的换行符

> ID：13516070
> 
> 赞同：6
> 
> 时间：2012-11-22T15:42:14.317
> 
> 标签：r, plot, legend

我在 R 的图例中有一个换行符，我的问题是图形看起来不像预期的那样。我的最小示例如下：

```
plot(1)
legendLabel<-c("t\nu ","tu","wh","trr\nni")
legend("top",legend=legendLabel,horiz=TRUE,fill=c("red","blue","gray","black")) 
```

我希望图例的上下边距相等，但事实并非如此。![在此处输入图像描述](../Images/1b71521556dc3baa4acf36aafaca6b4f.png)

正如您在附图中看到的那样，下边距小于上边距。

有谁知道如何解决它，或者谁能告诉我问题是什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T08:53:49.703

好的，我相信我有一个解决方案给你。我将图例位置的信息保存在一个名为的对象中`ld`，然后`polygon`根据这些坐标创建一个。理解起来有点棘手，但我基本上是将多边形扩展了几个点大小的长度。为了做到这一点，我必须首先获得以英寸为单位的字符大小，`par()$cin`并将点大小转换为这些尺寸（除以 72 并乘以`par()$ps`。然后，通过缩放将其转换为绘图单位`par()$usr`以获得字符宽度单位（我认为这是正确的 - 在任何情况下它都有效！）。我在`ld`坐标的左侧添加了 3 个单位，在右侧添加了 2 个，向上添加了 1 个，向下添加了 1 个。这是结果和代码：

![在此处输入图像描述](../Images/d6f244c526b00b274a679aa91148a9bf.png)

```
plot(1)
legendLabel<-c("t\nu ","tu","wh","trr\nni")
ld <- legend("top",legend=legendLabel,horiz=TRUE,fill=c("red","blue","gray","black"), bty="n")

CIN <- par()$cin
PS <- par()$ps
USR <- par()$usr
CIN.USR <- c((CIN[1]/72*PS)/(USR[2]-USR[1]), (CIN[2]/72*PS)/(USR[4]-USR[3]))

xs <- c(ld$text$x[1], ld$text$x[1], ld$text$x[length(ld$text$x)], ld$text$x[length(ld$text$x)])
ys <- c(ld$text$y[1], ld$text$y[1], ld$text$y[length(ld$text$x)], ld$text$y[length(ld$text$x)])

polygon(
x = xs + c(-3*CIN.USR[1], -3*CIN.USR[1], 2*CIN.USR[1], 2*CIN.USR[1]), 
y = ys+c(-1*CIN.USR[2], 1*CIN.USR[2], 1*CIN.USR[2], -1*CIN.USR[2])
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T13:10:44.970

感谢@'Marc in the box'，我找到了一个很好的解决方案。按照他的说法禁用盒子`bty="n"`，然后

```
 ld<-legend("top",legend=legendLabel, cex=0.65, fill=colorNames, horiz=TRUE,bty="n")
  height<-(ld$rect$top-ld$text$y[1])*2
  xs <- c(ld$rect$left, ld$rect$left, ld$rect$left+ld$rect$w, ld$rect$left+ld$rect$w)
  ys <- c(ld$rect$top, ld$rect$top-height, ld$rect$top-height, ld$rect$top)
  polygon(x = xs , y = ys) 
```

所以我首先计算了顶角和 dataPoint 之间的距离，然后用这个信息绘制一个多边形。据我所见，作品相当普遍。

谢谢。

# oracle - Oracle：是否可以检查最后一个 Session Commit？

> ID：13516072
> 
> 赞同：0
> 
> 时间：2012-11-22T15:42:16.590
> 
> 标签：oracle, transactions

> **可能重复：**
> [如何判断我在 Oracle 事务中是否有未提交的工作？](https://stackoverflow.com/questions/506456/how-can-i-tell-if-i-have-uncommitted-work-in-an-oracle-transaction)
> [Oracle：如何查明是否有待处理的事务？](https://stackoverflow.com/questions/1299694/oracle-how-to-find-out-if-there-is-a-transaction-pending)

我正在使用 Toad for oracle。也许我忘了提交我对记录所做的更改。我想在不提交另一个提交的情况下进行检查。

是否可以检查我给 toad 的最后一个会话提交？

# c++ - 确定未在 Fortran 子例程顶部声明的变量类型

> ID：13516074
> 
> 赞同：1
> 
> 时间：2012-11-22T15:42:21.767
> 
> 标签：c++, types, fortran, fortran77

我正在使用旧版 Fortran 77 代码子例程，其中未在代码块顶部声明参数类型。

这是一个显示子例程最顶部的片段。

```
 SUBROUTINE BPASS(F1,F2,F3,F4,SI,N,A,IERR)
   REAL * 4 A( N ),FV( 4 ) 
```

综上所述，我认为这是一个长度为 type`A`的数组，其大小相当于一个 C 。或者，是一个类型为 的长度数组。`N``REAL *4``float``FV(4)``4``REAL *4`

但是，`F1,F2,F3,F4,SI,N,IERR`如果未列出类型，则 的类型是什么？看来`N`应该是一个`integer`。

我需要知道类型，以便我可以从 C++ 代码中调用子例程。对于未声明的类型是否有 Fortran 约定？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T15:52:47.287

默认情况下，Fortran 会将类型分配给`integer`名称以字母开头的变量，`I,J,K,L,M,N`并将类型分配`real`给所有其他未声明的变量。

我同意你对`A`和定义的解析`FV`。

现代 Fortran 提供了确保不应用默认规则的表达式`implicit none`，但是在使用旧代码时，有时无法避免熟悉旧的黑暗方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T15:53:06.997

在`FORTRAN77`中，默认情况下以 I、J、K、L、M 或 N 开头的变量为`INTEGER`，否则为`REAL`。`FORTRAN90`和 的一些变体`FORTRAN77`提供了一种机制来通过使用来禁用它`IMPLICIT NONE`。

# javascript - Firefox/Firebug 上像素的小数部分

> ID：13516077
> 
> 赞同：2
> 
> 时间：2012-11-22T15:42:25.697
> 
> 标签：javascript, firefox, dom, mootools, firebug

今天我偶然发现了一个简单的盒子，样式如下：

```
div.menubox {
    background-color: #FFFFFF;
    border: 1px solid #887777;
    border-radius: 0 5px 5px 0;
    box-shadow: 1px 1px 3px #998888;
    font-family: Lato,sans serif;
    font-size: 12px;
    left: -5px;
    margin-bottom: 2em;
    min-height: 675px;
    overflow: hidden;
    padding: 25px 0 2em;
    position: absolute;
    top: 195px;
    transition-duration: 0.5s;
    transition-property: top;
    width: 215px;
    z-index: 99;
} 
```

它包含一个`ul`和几个`li`。在我要求萤火虫在控制台中打印菜单框高度之前，没什么特别的。

`console.log(document.getElementById("menubox").offsetHeight)`返回一个出色的 **"677.2px"**。

这是我第一次遇到这种奇怪的行为（我在旧的 Windows XP 安装上运行 firefox 17，带有 firebug 1.10.6，带有一堆插件）。

这是组件之一的已知问题还是新的*“功能”*？

**附录**

删除边框阴影，边框半径 css 属性（通过萤火虫禁用）结果不会改变。

chrome 报告“649.5999755859375px”嗯......需要进一步调查
底层的javascript代码

**EXTRA** Ops，javascript代码是填充变量的死线，真正的代码是console.log(document.id("menubox").getStyle("height))`所以主要怀疑**mootools 1.4.5** （手动发布控制台上的命令在两个浏览器上都返回一个整数像素数）。

但是，问题仍然存在，您是否遇到过类似的行为，是否有解决方法（除了手动舍入结果）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T10:33:38.127

像素上的小数部分在 CSS 中并不奇怪，因为它不是屏幕上的“点”，而是角度测量。

来自 CSS 2.1 文档：

> “像素单位与查看设备的分辨率有关，即最常见的是计算机显示器。如果输出设备的像素密度与典型计算机显示器的像素密度有很大不同，用户代理应该重新调整像素值。它是推荐参考像素为像素密度为96dpi、距离阅读器一臂远的设备上一个像素的视角，对于标称臂长28英寸的设备，可视角度约为0.0213度。 ”</p>

更多信息可以在这里找到：http: [//inamidst.com/stuff/notes/csspx](http://inamidst.com/stuff/notes/csspx)

我的猜测是您将 em:s 与 px:s 混合在一起，这将导致返回碎片化的像素值。请注意，这种行为没有任何问题，所以只要您不遇到麻烦，我就不会在意。特别是因为您只在 DOM 元素上定义了最小高度。

# python - 意外的文件行为python

> ID：13516078
> 
> 赞同：1
> 
> 时间：2012-11-22T15:42:25.763
> 
> 标签：python, file, output

> **可能重复：**
> [写入和读取文件时的奇怪行为](https://stackoverflow.com/questions/13083183/weird-behavior-when-writing-and-reading-file)

当我尝试写入文件然后读取它时，我得到了意想不到的结果。

我的代码是：

```
f=open("z.txt","w+")
f.write("Hello")
content=f.read()
print content
f.close() 
```

输出的文件是：

> Hellolף  ן (I11 (S'QUEUE' p1 (S'exec' p2 S'runco​​de' p3 (cidlelib.rpc unpickle_code p4 (S'c\x00\x00\x00\x00\x00\x00\ x00\x00\x03\x00\x00\x00@\x00\x00\x00s6\x00\x00\x00e\x00\x00d\x00\x00d\x01\x00\x83\x02\x00Z\x01\x00e\x01\x00j \x02\x00d\x02\x00\x83\x01\x00\x01e\x01\x00j\x03\x00\x83\x00\x00Z\x04\x00e\x01\x00j\x05\x00\x83\x00\x00\x01d \x03\x00S(\x04\x00\x00\x00s\x05\x00\x00\x00z.txts\x02\x00\x00\x00w+t\x05\x00\x00\x00HelloN(\x06\x00\x00\x00t \x04\x00\x00\x00opent\x01\x00\x00\x00ft\x05\x00\x00\x00writet\x04\x00\x00\x00readt\x07\x00\x00\x00contentt\x05\x00\x00\x00close(\ x00\x00\x00\x00(\x00\x00\x00\x00(\x00\x00\x00\x00s\x17\x00\x00\x00C:/用户/x/桌面/zt\x08\x00\x00\x00 \x01\x00\x00\x00s\x06\x00\x00\x00\x0f\x01\r\x01\x0c\x01' tRp5 tp6 (dp7 ttp8 tp9 . '2ר ְ ז׀l Ak !
> €qg ¸Ck PCk $ ְBkאBkנBk 8Ck
> xCk XBkxBk °Ck׀CkנCkDk
> @' (Ck～Ck kצ Ck Ck
> ְpg DkDֽ～F ! €qg + ～Ck
> (Dk @k @k xDk ר?k @f HDkhDkpDk ～Dk
> נDkEk0E ְ” kצ
> ְpg ! ～F ,
> ״Dk
> 
> ```
> @k @k                      ר?k 
> ```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:00:16.333

我相信这是一个 Windows 问题，与文件系统块大小有关。如果你`.flush()`在`.write()`你之前`.read()`，它会工作得很好。我可以在Win7上重现它。

（我认为正在发生的事情是 Windows 以 4KB 的块为单位分配您的文件，因此写入`"Hello"`会使您达到下一个块大小。如果您随后`.read()`从块的其余部分得到随机的乱码，因为 Python 没有机会处理它。如果你`.flush()`在`.read()`ing 之前，Python 会正确地写出文件，然后你只会得到一个空字符串。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:50:27.203

```
f=open("z.txt","w+")
f.write("Hello")
f.seek(0)
content=f.read()
print content
f.close() 
```

我失踪了
`f.seek(0)`

# android - “配对”2个安卓设备

> ID：13516079
> 
> 赞同：-1
> 
> 时间：2012-11-22T15:42:29.333
> 
> 标签：android, remote-control

我正在尝试构建一个android应用程序。
此应用程序的目的是“配对”2 台 android 设备，这样第一台 android 设备将能够在第二台 android 设备上远程执行以下操作：

1\. 使用相机拍摄照片/视频
2\. 打开/关闭录音机
3\. 使用 GPS 获取手机的当前位置

我想知道是否可以帮助我弄清楚以下内容：

1\. 这是否可以在常规设备（未植根）上执行上述操作？
2\. 我可以建立p2p连接并执行上述操作，还是应该使用第三方服务器来处理所有请求？
3\. 如果我确实使用服务器来处理请求，那么建立连接的最佳方式是什么？

如果您可以将我重定向到相关的 API，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:50:52.877

1.  是的，这是可能的。
2.  P2P理论上是可能的，但是如果移动运营商使用NAT或防火墙，你将不得不处理各种网络问题。
3.  我会使用 HTTP，因为它在移动设备上最常见且最强大。考虑使用提供消息系统的 IaaS，例如[pubnub](http://www.pubnub.com/)，它会为您省去很多麻烦并且不会花费您太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T15:51:09.650

> 打开/关闭录音机

由于我不知道任何实际具有“磁带”的 Android 设备（缺少有破裂外壳的人），因此我将其翻译为“录制一些音频”。

> 这是否可以在常规设备（未植根）上执行上述操作？

当然。用于`MediaRecorder`音频/视频（或`Camera`静止图像），并`LocationManager`用于 GPS。您将需要几个权限，用户需要在安装时同意这些权限。

> 我可以建立 p2p 连接并执行上述操作，还是应该使用第三方服务器来处理所有请求？

互联网上几乎没有什么是真正的 P2P。特别是，在移动设备上进行真正的 P2P 的唯一方法是它们在同一个 WiFi 网络上并且可以直接相互寻址。即便如此，在移动设备上开放端口（允许一个应用程序连接到另一个应用程序所必需的）也不是一个好主意，除非你有一个非常大的法律辩护基金来处理所有的诉讼。

更实用的方法是使用 GCM 推送通知来触发事件。

> 如果我确实使用服务器来处理请求，那么建立连接的最佳方式是什么？

使用因特网。除此之外，无法回答，因为有无数的“服务器”。

# solr - solr中的“*”和“*:*”有什么区别

> ID：13516080
> 
> 赞同：2
> 
> 时间：2012-11-22T15:42:39.490
> 
> 标签：solr

solr 4.0`*`和in有什么区别？`* : *`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:29:32.647

查询等效于：-

`q=*`--> 默认`field:*`
搜索 如果指定字段，默认搜索将触发通配符查询

`q=*:*`--> All`Fields:*`
它会在所有字段上触发通配符查询。通常用于从集合中获取所有结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:01:02.100

* 是通配符，表示前面的字符出现零次或多次。例如，如果有一个索引词 Stackoverflow，那么您可以使用 Stackover* 搜索它，它会找到索引词。

另一方面，*:* 与主查询 (q) 一起使用以从索引中获取所有文档（如果没有设置其他参数）。

# c++ - XML QDomElement 比较通用 - C++/Qt

> ID：13516083
> 
> 赞同：0
> 
> 时间：2012-11-22T15:42:58.100
> 
> 标签：c++, xml, qt, parsing, binary

在大多数情况下，我实现了一个例程 C++/Qt 来比较 QDomElement。

```
bool XMLtools::compare( QDomElement & element1, QDomElement & element2 )
{
    QString tag1 = element1.tagName() ;   
    QString tag2 = element2.tagName() ;
    if ( tag1 != tag2 )
        return false ;
    QList<QDomElement> elts1 = getChildElements(element1);
    QList<QDomElement> elts2 = getChildElements(element2);
    QDomElement c1, c2, tmp ;

    QString name1, name_tmp, text1, text2 ;
    if(elts1.size() != elts2.size())
        return false ;
    if(elts1.size() == 0)
    {
        text1 = c1.text() ;
        text2 = c2.text() ;

        if( text1 != text2 )
            return false ;
    }
    for ( int i = elts1.size() - 1 ; i > -1 ; i-- ) 
    {
        c1 = elts1.at(i);
        QString name1 = c1.tagName();

        for( int j = elts2.size() - 1 ; j > -1 ; j-- )
        {
            tmp = elts2.at(j) ;
            name_tmp = tmp.tagName() ;

            if( name_tmp == name1 )
            {
                c2 = tmp ;
                break ;
            }

            if( j == 0 )
                return false ; 
        }
        if ( ! compare(c1, c2) )
            return false ;      
    }
    return true ;
} 
```

1\. 可以用这种方法比较所有的QDomNode元素吗（即比较text()）？

1.  `QDomCDATASection`特别是，作为元素和二进制格式，我应该对特殊情况保持谨慎吗？

2.  如果 a`QDomNode`包含二进制数据，如何比较它们，当内部数据相同时返回 true ？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T19:23:06.620

我想出了以下相等检查算法：

## 两个节点`a`和`b`相等，如果`a >= b`和`b>=a`

```
bool compare( QDomElement  element1, QDomElement  element2 )
{
    return ! lessThen(element1, element2) && !lessThen(element2, element1);
} 
```

现在我们只需要介绍

## 比较算法

现在将使用本机`QString`比较功能

首先，在一般的方法中，我们不仅要比较`QDomElement`s，还要比较`QDomNode`Dom 中的 every。

*   如果`a.nodeType < b.nodeType`，那么`a < b`
*   否则，如果`a.nodeName < b.nodeName`，则`a < b`
*   否则，如果`a.children.size() < b.children().size()`，则`a < b`
*   否则，如果`a.children().size() ==0 && b.children().size() ==0`，比较`nodeValue()`。请注意，这种方法适用于属性节点和文本节点。QDomElement 本身没有`nodeValue`. 如果是一些文本，写在元素内部，元素将有文本类型的子节点。这就是为什么`element.nodeValue()`调用总是返回空字符串。
*   否则，使用`lessThen`比较函数对给定节点的所有子节点进行排序。
*   然后，检查每个孩子的`c`属于`a`和`d`属于`b`：
    *   如果`d > c`，那么`a > b`
    *   如果`c < d`，那么`a < b`
    *   否则 ( `c==d`) 继续比较下一个`c`和`d`。
*   如果 all`c`等于`d`，则`a == b`，显然`a < b`是错误的。

## 代码，实现这个算法：

```
QList<QDomNode> getChildElements(const QDomNode& e)
{
    QList<QDomNode> r;
    for (int k = 0; k < e.childNodes().size(); ++k) {
        QDomNode n = e.childNodes().at(k);
        r << n;
    }
    return r;
}

bool lessThen( QDomNode  element1, QDomNode  element2 )
{
    if (element1.nodeType() != element2.nodeType()) {
        return element1.nodeType() < element1.nodeType();
    }
    QString tag1 = element1.nodeName() ;
    QString tag2 = element2.nodeName() ;

    //qDebug() << tag1 <<tag2;
    if ( tag1 != tag2 )
        return tag1 < tag2;

    QList<QDomNode> elts1 = getChildElements(element1);
    QList<QDomNode> elts2 = getChildElements(element2);

    QString value1, value2 ;

    if(elts1.size() != elts2.size())
        return elts2.size() < elts1.size() ;

    if(elts1.size() == 0)
    {
        value1 = element1.nodeValue();
        value2 = element2.nodeValue();

        //qDebug() <<value1 << value2 << (value1 < value2);
        return value1 < value2;

    }

    qSort(elts1.begin(), elts1.end(), lessThen);
    qSort(elts2.begin(), elts2.end(), lessThen);
    //qDebug() << "comparing sorted lists";
    for(int  k = 0; k < elts1.size(); ++k) {
        if (!lessThen(elts1[k], elts2[k])) {
            if (lessThen(elts2[k], elts1[k])) {
                //qDebug() << "false!";
                return false;
            }
        }else {
            //qDebug() << "true!";
            return true;
        }
    }
    return false;
}

bool compare( QDomElement  element1, QDomElement  element2 )
{
    return ! lessThen(element1, element2) && !lessThen(element2, element1);
} 
```

请注意，该比较算法具有极高的复杂性。我花了大约 10 分钟来处理 2MB xml 文件（使用*xml-should-be-equal-to-itself*测试）

# 可能的测试

格式：

```
description (desired result)
<xml1>
<xml2>
result 
```

测试：

```
different order (true) 
"<r>
 <a>x</a>
 <a>y</a>
</r>
" 
"<r>
 <a>y</a>
 <a>x</a>
</r>
" 
true 
different text (false) 
"<a>x</a>
" 
"<a>y</a>
" 
false 
different text with structure (false) 
"<a>x<b/>ddcd</a>
" 
"<a>y<b/>dede</a>
" 
false 
same structure different names (false) 
"<r>
 <a/>
 <a/>
 <b/>
</r>
" 
"<r>
 <a/>
 <b/>
 <b/>
</r>
" 
false 
same text with structure (true) 
"<a>y<b/>x</a>
" 
"<a>x<b/>y</a>
" 
true 
attributes vs text (false) 
"<a b="c"/>
" 
"<a>
 <b>c</b>
</a>
" 
false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:44:27.337

它与 Qt 方法一起使用，该方法`NodeValue()`转换为`QString`a 的值，`QDomNode`而不管其类型如何。我的比较功能如下：

```
bool XMLtools::compare( QDomElement & element1, QDomElement & element2 )
{
    QString tag1 = element1.tagName() ;  //attribute("Name") ;
    QString tag2 = element2.tagName() ;

    if ( tag1 != tag2 )
        return false ;

    QList<QDomElement> elts1 = getChildElements(element1);
    QList<QDomElement> elts2 = getChildElements(element2);
    QDomElement c1, c2 ;

    bool these_nodes_are_equal = true ;
    bool one_comparing_tag = false ;

    QString name1, name2, value1, value2 ;

    if(elts1.size() != elts2.size())
        return false ;

    if(elts1.size() == 0)
    {
        value1 = c1.nodeValue() ;
        value2 = c2.nodeValue() ;

        if( value1 != value2 )
            return false ;
    }

    for ( int i = elts1.size() - 1 ; i > -1 ; i-- ) 
    {
        c1 = elts1.at(i);
        QString name1 = c1.tagName();

        for( int j = elts2.size() - 1 ; j > -1 ; j-- )
        {
            c2 = elts2.at(j) ;
            name2 = c2.tagName() ;

            if( name2 == name1 )
            {
                one_comparing_tag = true ;
                if ( ! compare(c1, c2) ) // c1 and c2 are potential identical nodes
                    these_nodes_are_equal = false ;
                else
                {
                    these_nodes_are_equal = true ;
                    break ;
                }
            }
        }

        if( !one_comparing_tag ) // if no node in elts2 is corresponding to node in elts1
            return false ; 

        if ( !these_nodes_are_equal ) // if no node in elts2 could compare to this node in elts1
            return false;   
    }

    return true ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-21T16:00:15.410

请注意，这没有考虑属性。以下基于 octoback 的代码，但在应用于 Lol4t0 的排序版本时可能会更好（更快）。我没有彻底测试这个。

```
bool compareElements (QDomElement & element1, QDomElement & element2)
{
    QString tag1 = element1.tagName ();  //attribute("Name") ;
    QString tag2 = element2.tagName ();

    if (tag1 != tag2)
        return false;

    QList<QDomElement> elts1 = getChildElements (element1);
    QList<QDomElement> elts2 = getChildElements (element2);

    bool these_nodes_are_equal = true;
    bool one_comparing_tag = false;

    QString name1, name2, value1, value2;

    if (elts1.size () != elts2.size ())
        return false;

    if (elts1.size () == 0)
    {
        value1 = element1.nodeValue ();
        if (!value1.isEmpty ())
        {
            value2 = element2.nodeValue ();
            if (!value2.isEmpty ())
            {
                if (value1 != value2)
                    return false;
            }
        }

        // attributes
        QDomNamedNodeMap attributes1 = element1.attributes ();
        QDomNamedNodeMap attributes2 = element2.attributes ();
        if (attributes1.size () != attributes2.size ())
            return false;
        for (int i1 = 0; i1 < attributes1.size (); i1++)
        {
            QDomNode item1 = attributes1.item (i1);
            QString a1 = item1.nodeName ();
            if (!a1.isEmpty ())
            {
                bool found = false;
                for (int i2 = 0; i2 < attributes2.size (); i2++)
                {
                    QDomNode item2 = attributes2.item (i2);
                    QString a2 = item2.nodeName ();
                    if (a1 == a2)
                    {
                        if (item1.nodeValue () != item2.nodeValue ())
                            return false;
                        found = true;
                        break;
                    }
                }
                if (!found)
                    return false;
            }
        }
    }

    QDomElement c1, c2;
    for (int i = elts1.size () - 1; i > -1; i--)
    {
        c1 = elts1.at (i);
        name1 = c1.tagName ();

        for (int j = elts2.size () - 1; j > -1; j--)
        {
            c2 = elts2.at (j);
            name2 = c2.tagName ();

            if (name2 == name1)
            {
                one_comparing_tag = true;
                if (!compareElements (c1, c2)) // c1 and c2 are potential identical nodes
                    these_nodes_are_equal = false;
                else
                {
                    these_nodes_are_equal = true;
                    break;
                }
            }
        }

        if (!one_comparing_tag) // if no node in elts2 is corresponding to node in elts1
            return false;

        if (!these_nodes_are_equal) // if no node in elts2 could compare to this node in elts1
            return false;
    }

    return true;
} 
```

# c# - 使用实体框架检索具有子组的组，每个子组都有自己的子组

> ID：13516086
> 
> 赞同：1
> 
> 时间：2012-11-22T15:43:03.470
> 
> 标签：c#, entity-framework-5

我正在建立一个组层次结构来表示一个组织结构。我有一个顶级组，然后有许多子组。然后每个子组可以具有任意数量的子组，依此类推。

我已经建立了一个带有两个表的 sql 数据库。

具有以下列的组。

*   标识（整数）
*   说明 (nvarchar(max))

GroupChildren 具有以下列。

*   标识（整数）
*   GroupId (int)
*   ChildGroupId (int)

例如，如果 Group 1 有两个子组，Group 2 和 Group 3，则 Groups 表将有 3 条记录

*   ID - 1，描述 - 第 1 组
*   ID - 2，描述 - 第 2 组
*   ID - 3，描述 - 第 3 组

GroupChildren 表将有 2 条记录

*   Id - 主键 ID，GroupId - 1，ChildGroupId - 2
*   Id - 主键 ID，GroupId - 1，ChildGroupId - 3

这将我的两个子组链接到第 1 组。我有两个 POCO 类来表示这一点，如下所示

```
public class Group
{
    public int Id { get; set; }
    public string Description { get; set; }
    public virtual ICollection<GroupChild> GroupChildren { get; set; }
}

public class GroupChild
{
    public int Id { get; set; }
    public int GroupId { get; set; }
    public Group ChildGroup { get; set; }
} 
```

我为这两个类创建了映射器，设置如下

```
internal class GroupMapper : EntityTypeConfiguration<Group>
{
    internal GroupMapper()
    {
        HasKey(t => t.Id);

        Property(t => t.Id).HasColumnName("Id").IsRequired();
        Property(t => t.Description).HasColumnName("Description").IsRequired();

        ToTable("Groups");
    }
}

internal class GroupChildMapper : EntityTypeConfiguration<GroupChild>
{
    internal GroupChildMapper()
    {
        HasKey(g => g.Id);

        Property(g => g.Id).HasColumnName("Id").IsRequired();
        Property(g => g.GroupId).HasColumnName("GroupId").IsRequired();

        HasRequired(g => g.ChildGroup)
            .WithMany()
            .Map(x => x.MapKey("ChildGroupId"))
            .WillCascadeOnDelete(false);

        ToTable("GroupChildren");
    }
} 
```

要检索我调用的组和子组

```
return GetDbSet<Group>()
    .Where(c => c.Id == id)
    .Single(); 
```

这将返回具有 Id 和 Description 的组，但在查看 GroupChildren 属性时出现以下错误

> 列名“Group_Id”无效。
> 列名“Group_Id”无效。

'Group_Id' 列在代码或数据库中的任何位置都不存在。我试图通过查看其他帖子来解决这个问题，有些人认为这是 EF 解释主/外键值的方式，但我找不到如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T08:17:44.867

您收到`Invalid column name 'Group_Id'`错误的原因可能是因为您通过`public int GroupId { get; set; }`在`ChildGroup`.

尝试`public int GroupId { get; set; }`从`ChildGroup`. 框架应该为你处理好关系。完成数据迁移以匹配更新后的模型后，您应该会看到框架已`Group_ID`在您的表中创建了一个列`Group`，该列设置了关系。

# google-maps - 沿着鼠标移动画一条线

> ID：13516092
> 
> 赞同：-2
> 
> 时间：2012-11-22T15:43:20.397
> 
> 标签：google-maps, google-maps-api-3

是否可以画一条线，当鼠标左键按下时跟随鼠标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T13:27:54.037

查看 OpenLayers - 一个具有许多功能的地图库。在那里，您可以使用谷歌地图作为数据，并在此基础上进行绘图。

[http://openlayers.org/dev/examples/draw-feature.html](http://openlayers.org/dev/examples/draw-feature.html)

# vb.net - 检查 localhost VB.Net 上的端口 57875 是否已关闭？

> ID：13516096
> 
> 赞同：1
> 
> 时间：2012-11-22T15:43:32.923
> 
> 标签：vb.net, connection, portforwarding

我正在尝试查看计算机 localhost 上的端口 57875 是否已关闭。这是我到目前为止的代码：

```
Try
        Dim checkPort As TcpClient = New TcpClient("localhost", 57875)
    Catch ex As Exception
        MsgBox("WARNING: Port 57875 is not forwarded ! The game will probably encounter an error !")
    End Try 
```

即使它被转发，它也会认为它不是。代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:48:07.490

这里有一个例子：

```
Dim host As String = "localhost"

Dim port As Integer = 57875

Dim addr As IPAddress = DirectCast(Dns.GetHostAddresses(host)(0), IPAddress)

Try   

    Dim tcpList As New TcpListener(addr, port)   
    tcpList.Start()

Catch sx As SocketException
  'Catch exception - No available port
End Try 
```

# c# - 在 C# 中使用 MSHTML 时检查返回值

> ID：13516097
> 
> 赞同：0
> 
> 时间：2012-11-22T15:43:40.793
> 
> 标签：c#, return-value, mshtml

我正在尝试在我的 C# 应用程序 (BHO) 中使用 MSHTML。特别是我想使用 IMarkupPointer.findText 方法。此方法搜索文本，我想检查是否找到文本。在 C++ 中执行此操作时，我只是这样做了：

```
HRESULT hr = ptrBegin->FindText(text, 0, ptrEnd, NULL); 
if (S_FALSE == hr) 
{
    // Do something if text wasn't found.
} 
```

但在 C# 中我不能这样做，因为在 PIA 中，此方法具有 void 返回类型。有没有其他方法可以检查是否找到了文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T17:25:51.897

在这种特殊情况下，我使用了以下解决方法来确定是否找到了文本：

```
IMarkupPointer pBegin, pEnd;
IMarkupServices markupServices;
// ...

pBegin.findText(word, 2, pEnd, null);

IHTMLTxtRange range = htmlDocument2.selection.createRange();
markupServices.MoveRangeToPointers(pBegin, pEnd, range);

if(range.text != word)
{
    // ...Text not found
} 
```

# c# - 如何限制多个登录同一用户 C# 和 Active Directory 成员身份

> ID：13516112
> 
> 赞同：2
> 
> 时间：2012-11-22T15:44:59.443
> 
> 标签：c#, authentication, login, active-directory, asp.net-membership

如何使用 AD 成员资格和 C# 防止同一用户多次登录？

我尝试使用 MembershipUser.IsOnline 但这不受 AD 成员资格提供商的支持。

这是一个代码：

```
 MembershipUser muser = Membership.GetUser(model.UserName);
                if(muser.IsOnline)
                {
                    //TODO
                } 
```

但它抓住了这个例外：Active Directory 成员资格提供程序不支持“LastLoginDate”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:04:42.327

这似乎更像是您的活动目录中的配置问题，您可以将网络策略中的缓存凭据设置为 0，因此您不会使用 kerberos 票证缓存。

然后您必须解决下一个问题，即您的网络允许多少次登录，本文介绍了一种解决方法：[http://technet.microsoft.com/en-us/magazine/2005.05.utilityspotlight。 aspx](http://technet.microsoft.com/en-us/magazine/2005.05.utilityspotlight.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T20:26:45.410

我认为我的情况有点不同，但我觉得同样的原则可以适用。我的情况是，我必须确保一次只从一台设备登录用户 ID（顺便说一下，表单身份验证，而不是 AD）。当用户 ID 尝试登录另一台设备但仍登录现有设备时，它会终止其现有设备上的会话，同时允许他们登录新设备。我在 Stack Overflow 上的原始帖子中写了一个解决方案：

[当同一个用户 ID 尝试在多台设备上登录时，如何终止另一台设备上的会话？](https://stackoverflow.com/questions/15903574/when-the-same-user-id-is-trying-to-log-in-on-multiple-devices-how-do-i-kill-the/15939899#15939899)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:04:10.483

没有 AD 会员课程的帮助，但仍然：

*   每次会话开始时将用户的 SessionId 添加到应用程序。
*   将用户的 SessionId 添加到他的 cookie

您必须检查 SessionId 是否匹配的每个请求。

# asp.net-mvc-3 - 我怎样才能有一个使用 int 的 CheckBoxFor？

> ID：13516113
> 
> 赞同：7
> 
> 时间：2012-11-22T15:45:00.783
> 
> 标签：asp.net-mvc-3, razor, custom-controls

我需要帮助来构建 CheckBoxFor 以获得`int`价值。

就像是：

```
@Html.CheckBoxForInt(m => m.foo.intValue) 
```

如果没有**检查**，则应**检查**。`intValue = 1`

 *** * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-22T18:48:23.820

你为什么不在你的模型中公开一个 bool 属性来转换成 int 或从 int 转换？

像这样的东西：

```
public bool BoolValue
{
    get { return IntValue == 1; }
    set { IntValue = value ? 1 : 0;}
}

public int IntValue { get; set; } 
```

然后你可以用它来创建复选框

```
@Html.CheckBoxFor(m => m.foo.BoolValue) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-23T16:31:05.313

出于某种原因，上面的响应给了我错误，但基于同样的想法，我改变了这样的代码：

```
public int IntValue { get; set; }

public bool BoolValue
{
    get { return IntValue == 1; }
    set { 
            if(value)
                IntValue = 1;
            else
                IntValue = 0;
    }
} 
```

这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-30T10:14:28.050

这是用于处理 int 值的复选框帮助程序示例：

```
 public static MvcHtmlString CheckBoxIntFor<TModel>(this HtmlHelper<TModel> html, Expression<Func<TModel, int>> expression, object htmlAttributes)        
    {
        // get the name of the property
        string[] propertyNameParts = expression.Body.ToString().Split('.');

        // create name and id for the control
        string controlId = String.Join("_", propertyNameParts.Skip(1));
        string controlName = String.Join(".", propertyNameParts.Skip(1));

        // get the value of the property
        Func<TModel, int> compiled = expression.Compile();
        int booleanSbyte = compiled(html.ViewData.Model);

        // convert it to a boolean
        bool isChecked = booleanSbyte == 1;

        // build input element
        TagBuilder checkbox = new TagBuilder("input");
        checkbox.MergeAttribute("id", controlId);
        checkbox.MergeAttribute("name", controlName);
        checkbox.MergeAttribute("type", "checkbox");

        if (isChecked)
        {
            checkbox.MergeAttribute("checked", "checked");
            checkbox.MergeAttribute("value", "1");
        }
        else
        {
            checkbox.MergeAttribute("value", "0");
        }
        SetStyle(checkbox, htmlAttributes);

        // script to handle changing selection
        string script = "<script>" +
                            "$('#" + controlId + "').change(function () { " +
                                "if ($('#" + controlId + "').is(':checked')) "+
                                    "$('#" + controlId + "').val('1'); " +
                                "else " +
                                    "$('#" + controlId + "').val('0'); " +
                            "}); " +
                        "</script>";

        return MvcHtmlString.Create(checkbox.ToString(TagRenderMode.SelfClosing) + script);
    }

    private static void SetStyle(TagBuilder control, object htmlAttributes)
    {
        if(htmlAttributes == null)
            return;

        // get htmlAttributes
        Type t = htmlAttributes.GetType();
        PropertyInfo classInfo = t.GetProperty("class");
        PropertyInfo styleInfo = t.GetProperty("style");
        string cssClasses = classInfo?.GetValue(htmlAttributes)?.ToString();
        string style = styleInfo?.GetValue(htmlAttributes)?.ToString();

        if (!string.IsNullOrEmpty(style))
            control.MergeAttribute("style", style);
        if (!string.IsNullOrEmpty(cssClasses))
            control.AddCssClass(cssClasses);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-17T10:10:59.413

稍微不同的方法：

我的数据库需要接受一个 int，我想要一个复选框，从我在 Razor 的表单中发送该 int。在页面上我也使用了 angularJS（也很容易使用纯 JS）。所以这是一个不涉及更改模型等的解决方案。

通知：

```
<input ng-click="checkCheckBox()" type="checkbox" id="myCheck">

@Html.HiddenFor(m => m.Role, new { id = "id_checkbox", Value = 0 }) 
```

在 JavaScript 中：

```
$scope.checkCheckBox= function(){

   var x = document.getElementById("myCheck").checked;

   if (x == true) { $('#id_checkbox').val(3);}
   else { $('#id_checkbox').val(0);}

} 
```**

# go - 如果没有无法访问的 return 语句，Go 代码将无法编译

> ID：13516118
> 
> 赞同：17
> 
> 时间：2012-11-22T15:45:32.527
> 
> 标签：go

这是在 Go 中查找数字的阶乘的程序：

```
func factorial(x uint) uint {
    if x == 0 {
        return 1
    }

    return x * (factorial(x - 1))
} 
```

在输入 5 上调用此函数时的输出为 120。但是，如果我添加一条`else`语句，则会出现错误。

```
func factorial(x uint) uint {
    if x == 0 {
        return 1
    } else {
        return x * (factorial(x - 1))
    }
} 
```

错误 ：`function ends without a return statement`

我`return`在最后添加了一个：

```
func factorial(x uint) uint {
    if x == 0 {
        return 1
    } else {
        return x * (factorial(x - 1))
    }
    fmt.Println("this never executes")
    return 1
} 
```

我得到了 120 的预期输出。

为什么第二种情况会导致错误？为什么在第三种情况下，即使函数从未到达 last `return 1`，它也会计算正确的输出？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-22T15:58:56.050

这是编译器的一个众所周知的问题。

甚至记录了一个问题：[http ://code.google.com/p/go/issues/detail?id=65](http://code.google.com/p/go/issues/detail?id=65)

用 Go 语言的一位作者的话来说：

> 编译器要求 return 或 panic 在具有结果的函数中词法上最后。这条规则比需要完整的流控制分析来确定一个函数是否到达末尾而不返回（这通常很难）更容易，并且比枚举诸如此类的简单案例的规则更简单。此外，由于纯粹是词法的，错误不会由于函数内部控制结构中使用的常量等值的变化而自发产生。
> 
> -抢

[从golang-nuts 的](https://groups.google.com/forum/?fromgroups=#!topic/golang-nuts/u66fQbfbzEo)另一条评论中，我们可以推断它不会很快被“修复”：

> 这不是错误，而是经过深思熟虑的设计决定。
> 
> -抢

请注意，其他语言（如 Java）有允许这样做的规则`else`。

* * *

**2013 年 3 月编辑 -**它刚刚[在 Go1.1 中发生了变化](http://tip.golang.org/doc/go1.1)：

> 在 Go 1.1 之前，返回值的函数需要在函数末尾显式“返回”或调用 panic；这是一种让程序员明确了解函数含义的简单方法。但是在很多情况下，最终的“返回”显然是不必要的，例如只有无限“for”循环的函数。
> 
> 在 Go 1.1 中，关于最终“return”语句的规则更加宽松。它引入了终止语句的概念，该语句保证是函数执行的最后一条语句。示例包括没有条件的“for”循环和“if-else”语句，其中每一半都以“return”结束。如果函数的最终语句可以在语法上显示为终止语句，则不需要最终的“return”语句。
> 
> 请注意，该规则是纯语法的：它不关注代码中的值，因此不需要复杂的分析。
> 
> 更新：更改是向后兼容的，但现有代码具有多余的“return”语句和对恐慌的调用可以手动简化。此类代码可以通过 go vet 识别。

我提到的问题现在以状态*"Fixed"*关闭。

# ssh - 带有 openssh 密钥的 TortoiseGit 未使用 ssh-agent 进行身份验证

> ID：13516119
> 
> 赞同：44
> 
> 时间：2012-11-22T15:45:36.353
> 
> 标签：ssh, ssh-keys, openssh, tortoisegit, ssh-agent

我在 Windows XP（msysGit 1.7.11，TortoiseGit 1.7.14）上设置了一个 git 环境，并试图实现以下几点：

*   与默认 22 不同的端口上的 ssh 连接
*   由 ssh-agent 处理的 ssh 身份验证

所以我创建了一个*~/.ssh/config*文件：

```
Host gitbox
   User gitolite
   Hostname XX.XX.XX.XX
   Port 154
   PreferredAuthentications publickey
   IdentityFile "/c/Documents and Settings/kraymer/.ssh/id_rsa" 
```

使用 git bash CLI 时，一切都按预期工作。

我正在与 TortoiseGit 斗争。
我首先使用 Plink 安装 TortoiseGit 并使用 Pageant 加载 ssh 私钥。自动身份验证（选美）工作但设置失败，因为 TortoiseGit 无法识别格式为*gitolite@gitbox/repo.git*的 git repos url 。

然后我决定使用 openssh 客户端安装 TortoiseGit，以便ssh 客户端可以读取*配置文件，并模仿 git CLI 设置。*
我在 TortoiseGit 设置中选择了*msys* git 附带的 ssh.exe 作为 ssh 客户端。
执行 a`git pull`时，远程 url 现在已解析，但在我希望 ssh-agent 自动身份验证发生时询问密码密码。

![https://dl.dropbox.com/u/1026715/tortoisegit.png](../Images/32f3b8d386ba3dcd25d0a72a01886ac3.png)

是否可以让 TortoiseGit 与 ssh-agent 一起使用？
或者让 TortoiseGit (Plink) 知道*.ssh/config*？

**编辑#1**

按照@VonC 的建议，我配置了我的 $HOME 变量。
当我在 TortoiseGit 中单击*Show environment variables*时，我现在有：

```
 HOME=C:\Documents and Settings\kraymer  
 HOMEDRIVE=C: 
 HOMEPATH=\Documents and Settings\kraymer 
```

但`git pull`仍然需要我输入密码。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2015-10-25T10:28:53.787

No tweaks needed.

Just make TortoiseGit point to the same ssh client used by git itself, see the screenshot:

[![在此处输入图像描述](../Images/b9471ffece8407ad13813c27b8853958.png)](https://i.stack.imgur.com/FHPmP.png)

This should be `C:\Program Files\Git\usr\bin\ssh.exe` in latest version of Git as mentioned by Aleksey Kontsevich in the comments.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T16:51:38.543

> I first installed TortoiseGit with Plink and using Pageant to load ssh private key. The automatic authentication (Pageant) worked but setup was a fail as TortoiseGit don't recognize git repos url formatted as gitolite@gitbox/repo.git.

I finally found a workaround which consist to create a PuTTY session with the same name that the ssh alias (ie *gitbox* in the question).
This way I can clone as `git clone gitbox/monrepo` in the CLI and the `origin` syntax is correctly handled by TortoiseGit.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-16T17:48:09.393

## 1) Cygwin

Use approach described in the following article: [https://help.github.com/articles/working-with-ssh-key-passphrases](https://help.github.com/articles/working-with-ssh-key-passphrases)

Password will be asked only once on the cygwin session startup. !!! Before exiting cygwin session don't forget to kill ssh-agent process (use ps for find process PID and kill -9).

We are using separate approach for cygwin, because cygwin by some reason doesn't see processes started externally in windows environment.

## 2, 3) MsysGit, TortoiseGit

Useful link: [http://dogbiscuit.org/mdub/weblog/Tech/WindowsSshAgent](http://dogbiscuit.org/mdub/weblog/Tech/WindowsSshAgent)

Install MsysGit. Install TortoiseGit (check openssh instead of plink during installation). !!! Check systems variables. If there is GIT_SSH variable present - remove it.

Go to TortoiseGit->Settings->General

Set Git exe Path to /bin Set External dll path to /mingw/bin

Go to TortoiseGit->Settings->Network Set SSH Client property to /bin/ssh.exe

Define system variable SSH_AUTH_SOCKS=C:\temp.ssh-socket

Start cmd.exe and execute following commands(since we installed MsysGit all following commands are accessible in cmd - /bin is added to system PATH variable):

```
# following command is required to execute for avoiding Address already bind message when ssh-agen is not started yet but .ssh-socket exists after previous agent session
rm "%SSH_AUTH_SOCK%"

# Starting ssh-agent
ssh-agent -a "%SSH_AUTH_SOCK%"

# Adding our openssh key
ssh-add "%USERPROFILE%\.ssh\id_rsa"

# Type password for your key 
```

That's it. From that moment you can execute git push, git pull from TortoiseGit and MsysGit without prompting passphrase.

When ssh-agent is no longer required you can kill it through windows task manager.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-07-07T22:55:59.587

None of the above answers worked for me.

I created this batch file to solve the problem.

```
CALL "C:\Program Files\Git\cmd\start-ssh-agent.cmd"
SETX SSH_AUTH_SOCK "%SSH_AUTH_SOCK%"
SETX SSH_AGENT_PID "%SSH_AGENT_PID%" 
```

Run this once, and enter your passphrase.

Then you can use tortoisegit with openssh without having to enter your passphrase for every operation.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-11-19T01:39:33.927

There seems to be a whole variety of options to solve this. As none of the above have worked for me, I tought I'd share what helped for me.

[Screenshot: Network settings / Git SSH Client](https://i.stack.imgur.com/pBOFt.png)

In `Settings... -> Network -> SSH -> SSH client`, set the client to `C:\Program Files\TortoiseGit\bin\TortoiseGitPlink.exe`. Using Pageant, you're then automatically authenticated as expected, otherwise you are prompted for your private key passphrase. Make sure the "Autoload Putty Key" option is checked in the push dialog.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-23T07:35:49.210

Make sure to launch your TortoiseGit in an environment where `HOME` is defined, and reference the parent directory of `.ssh`.
This is important since, on Windows, HOME isn't defined by default.

See as an example: "[Auth fails on Windows XP with git and tortoisegit](https://stackoverflow.com/questions/5318590/auth-fails-on-windows-xp-with-git-and-tortoisegit)".
(Other possible sources: "[How to I tell Git for Windows where to find my private RSA key?](https://serverfault.com/questions/194567/how-to-i-tell-git-for-windows-where-to-find-my-private-rsa-key)")

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-03-20T16:28:46.537

Since the explanations here are a bit outdated, I decided to post my solution.

I am using Git Bash and TortoiseGit 2.8.0 in Windows 10, which are common nowadays.

I set `ssh.exe` as SSH client in `Settings->Network` as explained in previous posts.

I created a script with the following commands, as explained in a previous comment. You might also want to set a HOME environment variable, in case your system does not do it automatically. Assuming your home is in drive H:\ you can add the following lines:

```
SETX HOME /h
CALL "C:\Program Files\Git\cmd\start-ssh-agent.cmd"
SETX SSH_AUTH_SOCK "%SSH_AUTH_SOCK%"
SETX SSH_AGENT_PID "%SSH_AGENT_PID%" 
```

`Win logo`我使用+将脚本添加`R` `shell:startup`到启动文件夹中。或者，您可以将脚本添加到注册表以保证它在其他进程之前运行：

```
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run 
```

确保键入`exit`以关闭控制台并允许为将来的进程设置变量。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-10-05T21:28:45.217

**Windows10 系统**
#TortoiseGit
在网络部分
从： *C:\Program Files\TortoiseGit\bin\TortoiseGitPlink.exe*
到： *“C:\Users{user}\AppData\Local\Programs\Git\usr\bin\ssh.exe”*

[![在此处输入图像描述](../Images/2a60250562ddb95bc825500008afcd92.png)](https://i.stack.imgur.com/h5p7e.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-11-05T20:29:23.173

如果您在存储库中使用 RSA 密钥，请按上述说明在脚本末尾添加^

```
CALL "C:\Program Files\Git\cmd\start-ssh-agent.cmd"
...
"C:\Program Files\Git\usr\bin\ssh-add"  ~/.ssh/myid.rsa 
```

适用于 Git 2.24.0、TortoiseGit 2.9.0、Windows 10 且不使用任何 Putty。

# pgadmin - 为什么不能编辑 VIEW 的权限？

> ID：13516123
> 
> 赞同：1
> 
> 时间：2012-11-22T15:45:52.863
> 
> 标签：pgadmin

在 PGAdmin-1.14 中，如果我打开 TABLE 或 SEQUENCE 的属性，我会得到一个权限选项卡，可以在其中为用户和/或组添加或撤销 GRANT。

VIEWs 的属性选项卡没有这样的选项卡，但是，我仍然可以通过 Grant Assistent 更改权限。

这是疏忽，还是有更深层次的含义？

# mysql - MySQL - 选择相互行

> ID：13516130
> 
> 赞同：1
> 
> 时间：2012-11-22T15:46:30.923
> 
> 标签：mysql

我有一张这样的桌子：

用户 ID | want_user_id | 状态

我想选择相互的行并且有一`state`列的值为“是”或“可能”。

示例数据：

第 1`1 | 2 | "yes"`
行： 第 2`2 | 1 | "maybe"`
行： 第 3 行：`3 | 2 | "yes"`

在这种情况下，我想选择第 1 行和第 2 行，然后在`wants_user_id`（第二列）我想从 table 加入用户数据`users`，但我无法弄清楚 sql 命令。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:49:41.033

使用自联接来获取匹配的行（我假设这里的“互行”是指需要彼此的用户）：

```
SELECT *
FROM myTable a
INNER JOIN myTable b ON a.user_id = b.wants_user_id
    AND b.user_id = a.wants_user_id
INNER JOIN users ua ON a.user_id = ua.id
INNER JOIN users ub ON b.user_id = ub.id
WHERE a.state IN ('yes', 'maybe')
AND b.state IN ('yes', 'maybe') 
```

在这种情况下，您将获得两个“重复”行，一个用于 1<->2，一个用于 2<->1。为了消除这种情况，您可以`AND b.user_id > a.user_id`在连接条件中添加一个 - 这将只选择每对中的一行。

# javascript - search() 函数的算法是什么？

> ID：13516137
> 
> 赞同：1
> 
> 时间：2012-11-22T15:46:54.383
> 
> 标签：javascript, algorithm, search

`search()`有没有人知道javascript中用于函数的算法是什么？

```
var myRegExp = /Alex/;
var string1 = "Today John went to the store and talked with Alex.";
var matchPos1 = string1.search(myRegExp);

if(matchPos1 != -1)
    document.write("There was a match at position " + matchPos1); 
else
    document.write("There was no match in the first string"); 
```

[示例复制 tizaq.com](http://www.tizag.com/javascriptT/javascript-string-search.php)

我需要使用此函数在文本文档中搜索不同的字符串值。但是我需要记录下这个方法背后的算法是什么，复杂性是什么。否则，我必须编写自己的方法来搜索我拥有的文本文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:23:10.953

规范说它是作为正则表达式匹配实现的：

> 3) 如果Type(regexp) 是Object 并且regexp 的[[Class]] 内部属性的值是“RegExp”，那么令rx 是regexp；
> 
> 4) 否则，设 rx 是一个新的 RegExp 对象，就像由表达式 new RegExp(regexp) 创建的，其中 RegExp 是具有该名称的标准内置构造函数。
> 
> 5) 从值字符串的开头搜索正则表达式模式 rx 的出现。让 result 是一个数字，表示模式匹配的字符串中的偏移量，如果不匹配，则为 –1。(...)

（[第 15.5.4.12 节 String.prototype.search (regexp)](http://es5.github.com/#x15.5.4.12)）。

这意味着您的问题归结为正则表达式匹配算法。但这也不在规范中，它取决于实现：

> [[Match]] 内部属性的值是 RegExp 对象的 Pattern 的实现依赖表示。

（[第 15.10.7 节 RegExp 实例的属性](http://es5.github.com/#x15.10.7)）。

因此，如果确实需要记录该算法的复杂性，我想您将不得不编写自己的方法。但请记住，通过这样做，您可能会想出一些效率较低的东西，并且可能依赖于复杂性未知的其他内置方法（甚至可能是`RegExp`其自身）。那么，你不能说服那些记录内置的、依赖于实现的 js 方法的复杂性不是你的工作的权力吗？

# ios - 如何在 Interface Builder 中定位 3.5” 和 4” Retina 的视图？

> ID：13516139
> 
> 赞同：8
> 
> 时间：2012-11-22T15:46:55.083
> 
> 标签：ios, xcode, interface-builder, alignment, autolayout

我想定位一个 UIView，使其出现在 3.5 英寸和 4 英寸 Retina 屏幕的中心。做这个的最好方式是什么？如果我关闭所有 Autosizing 条，我希望它与屏幕中心对齐，但这似乎不会发生。

我很高兴使用新的 Autolayout，但我也不知道如何让它做到这一点。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-22T16:38:48.653

为您的 XIB 执行以下步骤，您应该为您的视图获得正确的调整大小：

1.  为了无缝兼容 iOS4，首先将顶视图大小设置为 Retina 3.5 大小。

2.  移除顶视图的尺寸参数并将其设置为“无”。您现在应该有一个大小正确但没有固定设置大小选项的主视图。

3.  在“尺寸检查器”选项卡下为顶视图打开所有垂直自动调整大小。

4.  对于每个子视图，请执行以下操作

    *   选择视图并转到 Size Inspector 选项卡
    *   选择排列（垂直居中或对齐）
    *   如果您希望它居中，请删除 Autosizing 框中的两个对齐标记。如果您希望它“粘性”，请选择其中之一，如果您希望它填充父母，请选择两者。
    *   通过突出显示或取消突出显示垂直的“双尖箭头”来选择是否应相对调整大小
    *   确保此时所有元素都位于 3.5" 视图中的预期位置 - 这对于它在 iOS4 上的工作至关重要。
5.  保存您的更改。通过选择顶视图并选择大小来检查您的自动调整大小是否成功：“Retina 4 Full Screen”。执行此操作时，您的视图应该看起来像您的预期结果。

6.  撤消 5 中的更改（使 xib 中的视图再次具有 3.5 大小，但大小选项设置为“无”，保存并运行您的应用程序。

这也适用于 iOS4，因为视图的大小已经针对 Retina 3.5 进行了调整，因此旧屏幕大小没有使用自动调整大小。

在某些情况下，不可能为所有元素获得正确的尺寸/位置。在这些情况下，您需要以编程方式更改 4" 屏幕尺寸的视图尺寸位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T15:52:07.243

在 IB 中使用自动布局在其父（容器）视图中居中视图：

*   选择您查看
*   转到菜单并选择 Editor->Align->Horizo​​ntal/Vertical Center in Container 选项

但是，仅当您支持 iOS 6 及更高版本时才能使用自动布局，如果您针对较早的操作系统版本，则必须使用其他方法（例如，使用 Eric 建议的代码设置居中视图）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T15:50:32.733

以下是您手动操作的方法（不使用自动布局）：

```
int screenWidth = [[UIScreen mainScreen] applicationFrame].size.height;
int screenHeight = [[UIScreen mainScreen] applicationFrame].size.width;

UIView *myView = [[UIView alloc] initWithFrame:CGRectMake(0,0,100,200)];
[myView setCenter:CGPointMake(screenWidth/2, screenHeight/2)];

[self.view addSubview:myView]; 
```

# c# - 具有不同 LINQ 语法的 Raven Db 似乎无法正常工作

> ID：13516141
> 
> 赞同：3
> 
> 时间：2012-11-22T15:46:59.427
> 
> 标签：c#, ravendb

我刚刚开始使用 RavenDB，遇到了一个奇怪的场景。

当我运行以下查询时，模型会很好地填充。一切都很好。

```
var contacts = Session.Query<Contact>()
                      .Where(c => c.UserId == this.userId)
                      .ToList();

var model = contacts.Select(c => new SelectListItem() { 
                                     Text = c.FullName, 
                                     Value = c.Id }).ToList(); 
```

但是，这不是我开始使用的代码。我从下面的代码开始，它从联系人 FullName 填充 Text 属性。由于某种随机原因，它不会从联系人 ID 填充 Value 属性。

```
 var model = (from c in Session.Query<Contact>()
              where c.UserId == this.userId
              select new SelectListItem() { 
                         Text = c.FullName, 
                         Value = c.Id }).ToList(); 
```

我不确定这是否是一个错误，或者我只是缺少一些简单的东西。想法？

** 更新 **

它也不喜欢这种语法。我必须在这里遗漏一些非常基本的东西。

```
 var model = Session.Query<Contact>()
                    .Where(c => c.UserId == this.userId)
                    .Select(c => new SelectListItem() { Text = c.FullName, Value = c.Id })
                    .ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T15:54:42.410

不同之处在于，在第一种情况下，您在投影*之前*`ToList()`接到了电话。所以 LINQ 提供者唯一需要担心的是调用。它将获取每个 的*所有*数据，然后在 LINQ to Objects 中进行投影。*`Where`*`Contact`**

 **在您的第二个代码中，`Select`调用也需要由 LINQ 提供程序处理 - 并且可能它没有做正确的事情。

所以是的，这听起来像是 RavenDB LINQ 提供程序中的一个错误，在`Select`处理中。

请注意，强制其余查询在 LINQ to Objects 中执行的另一种方法是使用`AsEnumerable()`- 所以这应该有效：

```
var model = Session.Query<Contact>()
                   .Where(c => c.UserId == this.userId)
                   .AsEnumerable()
                   .Select(c => new SelectListItem { 
                                  Text = c.FullName, 
                                  Value = c.Id })
                   .ToList(); 
```

（我也在对象初始化表达式中转换`new SelectListItem()`为`new SelectListItem`，但这实际上是一个空操作。）**

# c - OCaml 的 MIT-SHM 绑定

> ID：13516146
> 
> 赞同：1
> 
> 时间：2012-11-22T15:47:20.590
> 
> 标签：c, ocaml, shared-memory, xlib

我正在尝试使用[MIT-SHM 扩展](http://www.x.org/releases/current/doc/xextproto/shm.html)的绑定来扩展[OCaml-Xlib](http://www.linux-nantes.org/~fmonnier/ocaml/Xlib/)。这是我第一次尝试将 C 与 OCaml 连接，而且我从来没有用 C 写过任何东西，所以我想我在某处做了一些愚蠢的事情。

我首先添加了 XShmQueryExtension 函数。我将以下内容添加到 Xlib.ml 文件中

```
external xShmQueryExtension: dpy:display -> bool = "ml_xShmQueryExtension" 
```

wrap_xlib.c 文件的以下内容

```
CAMLprim value
ml_xShmQueryExtension( value dpy )
{
  int ans = XShmQueryExtension( Display_val(dpy) );
  return Val_bool(ans);
} 
```

我将 Makefile 更改为与 Xext 链接，它可以工作：当我从 OCaml 调用 xShmQueryExtension 函数时，我得到了正确的结果。

现在我正在尝试编写一个创建共享 xImage 的函数，初始化共享内存并将其附加到 X 服务器。我在 Xlib.ml 文件中添加了以下内容：

```
type xShmSegmentInfo

external xShmCreateImageAndAttach:
  dpy:display -> visual:visual -> depth:int -> fmt:ximage_format
  -> width:uint -> height:uint -> xShmSegmentInfo * xImage
    = "ml_xShmCreateImageAndAttach_bytecode"
      "ml_xShmCreateImageAndAttach" 
```

以及 wrap_xlib.c 文件的以下内容：

```
#define Val_XShmSegmentInfo(d) ((value)(d))
#define XShmSegmentInfo_val(v) ((XShmSegmentInfo *)(v))

CAMLprim value
ml_xShmCreateImageAndAttach( value dpy, value visual, value depth, value format,
                             value width, value height)
{
    CAMLparam5(dpy, visual, depth, format, width);
    CAMLxparam1(height);
    CAMLlocal1(ret);

    XShmSegmentInfo *shminfo = malloc(sizeof(XShmSegmentInfo));

    XImage *ximage = XShmCreateImage(
        Display_val(dpy),
        Visual_val(visual),
        Int_val(depth),
        XImage_format_val(format),
        NULL,
        shminfo,
        UInt_val(width),
        UInt_val(height)
    );
    shminfo->shmid = shmget (IPC_PRIVATE,
      ximage->bytes_per_line * ximage->height, IPC_CREAT|0777);
    shminfo->shmaddr = ximage->data = (char *) shmat (shminfo->shmid, 0, 0);
    if (shminfo->shmaddr == -1)
      fprintf(stderr,"Error");
    shminfo->readOnly = False;
    XShmAttach (Display_val(dpy), shminfo);

    ret = caml_alloc(2, 0);
    Store_field(ret, 0, Val_XShmSegmentInfo(shminfo) );
    Store_field(ret, 1, Val_XImage(ximage) );
    CAMLreturn(ret);
}

CAMLprim value
ml_xShmCreateImageAndAttach_bytecode( value * argv, int argn )
{
    return ml_xShmCreateImageAndAttach(argv[0], argv[1], argv[2], argv[3],
                                       argv[4], argv[5]);
} 
```

现在我在我的 OCaml 程序中调用这个函数：

```
let disp = xOpenDisplay ""
let screen = xDefaultScreen disp
let (shminfo, image) = xShmCreateImageAndAttach disp
  (xDefaultVisual disp screen)
  (xDefaultDepth disp screen) ZPixmap 640 174 
```

这是我的 OCaml 程序中的顶级调用，我再也不会使用变量 shminfo 和 image （这只是为了测试该函数是否有效）。这个调用没有失败，但我的程序段错误一段时间后（我的程序的其余部分不断用 xGetImage 转储屏幕并用像素做一些事情，我在一些 xGetPixel 中得到一个段错误，这与调用无关xShmCreateImageAndAttach 上面）。我注意到，如果我删除该行，`shminfo->shmaddr = ximage->data = (char *) shmat (shminfo->shmid, 0, 0);`我就不会再出现段错误（但这当然不会做我想要的）。

我认为这与垃圾收集器有关，但我不知道如何解决。在[OCaml doc](http://caml.inria.fr/pub/docs/manual-ocaml-4.00/manual033.html#htoc259)上，有一条关于将使用 malloc 获得的指针转换为值类型的警告，但我不太明白它的含义，也不知道它是否相关。

**编辑：**

我将以下两行替换为`shmat`以下内容：

```
fprintf(stderr,"%i\n",(int)shminfo->shmaddr);
fflush(stderr); 
```

我得到类似的东西`1009700864`，所以调用`shmat`似乎正在工作。

这是gdb给出的回溯：

```
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff7acdde8 in ?? () from /usr/lib/libX11.so.6
(gdb) backtrace
#0  0x00007ffff7acdde8 in ?? () from /usr/lib/libX11.so.6
#1  0x000000000044070c in ml_XGetPixel ()
#2  0x00000000004165b9 in camlInit__rvb_at_1023 () at init.ml:43
#3  0x0000000000415743 in camlParse__find_guy_1046 () at parse.ml:58
#4  0x000000000041610c in camlParse__pre_parse_1044 () at parse.ml:95
#5  0x0000000000415565 in camlGame__entry () at game.ml:26
#6  0x00000000004141f9 in caml_program ()
#7  0x000000000045c03e in caml_start_program ()
#8  0x000000000044afa5 in caml_main ()
#9  0x000000000044afe0 in main () 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:53:42.013

如果 X 将调用您要转换为类型`free()`的指针，则警告是相关的。问题是 OCaml 假设值可以被 GC 自由复制和处理。这不适用于您的指针值，因此可能会有指针的悬空副本。此外，这个空间可以作为 OCaml 堆的一部分被重用，然后你就遇到了*真正的*麻烦。`shminfo``value`

 *在我看来，X 不会这样做，而且由于您没有调用`free()`代码，我认为这不是问题所在。但它可能是——我不知道 X 是如何工作的。

`fflush(stderr)`在您致电 后致电可能会更好`fprintf()`。它可能不会改变任何东西，但我发现我的跟踪消息往往会被缓冲，并且在程序崩溃时永远不会出现。

知道段错误地址的样子也很好。接近0了吗？或者堆中间某处的大地址？

抱歉，我无法查明您的错误。在阅读 4 或 5 次代码后，我看不出你做错了什么，假设`Display_val`其余的工作正常。但这很难做到。*

# python - 如何使用 The Grinder 从请求中获取 html 源代码

> ID：13516148
> 
> 赞同：1
> 
> 时间：2012-11-22T15:47:20.767
> 
> 标签：python, jython, grinder

我有以下脚本：

```
 def page2(self):
  """GET / (request 201)."""
     result = request201.GET('/mypage/', None,
     ( NVPair('Accept', 'image/gif, image/jpeg, image/pjpeg, image/pjpeg, application/x-   shockwave-flash, */*'), 
     NVPair('Accept-Language', 'en-us'), ))

# here i want to print the html source code from the result

return result 
```

[该脚本是使用Grinder Proxy](http://grinder.sourceforge.net/g3/tcpproxy.html)录制的。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T01:37:11.717

添加这一行：

```
print result.text 
```

有关更多详细信息，请参阅[http://grinder.sourceforge.net/g3/script-javadoc/HTTPClient/HTTPResponse.html](http://grinder.sourceforge.net/g3/script-javadoc/HTTPClient/HTTPResponse.html)。

# makefile - 从传递给用户定义函数的参数中去除前导空格

> ID：13516149
> 
> 赞同：4
> 
> 时间：2012-11-22T15:47:30.313
> 
> 标签：makefile, gnu-make

如何使用 gnu-make 从传递给用户定义函数的参数中去除前导空格？

例如：

```
define FOO
# --- some build rules

# run the built target
/home/user/dir/bin/$(1)

endef 
```

以下调用正常工作，因为没有前导空格：

```
$(eval $(call FOO,my_test ) ) 
```

不幸的是，以下失败，因为`$(1)`有一个领先的空间

```
$(eval $(call FOO, my_test ) )
                  ^
                Additional space to 'prettier' formatting 
```

这最终扩展到：

```
/home/user/dir/bin/ $(1)
                   ^
                 Leading whitespace 
```

如何从传递给用户定义函数的参数中去除前导空格？

这样做是不好的形式，还是我应该简单地假设参数是在没有前导空格的情况下传递的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T16:11:06.680

使用`strip`功能：

```
define FOO
# ...
/home/user/dir/bin/$(strip $(1))
endef 
```

有关详细信息，请参阅[文本函数](http://www.gnu.org/software/make/manual/html_node/Text-Functions.html)。因此，为了避免`strip`在任何地方使用，最好在将参数传递给函数时避免逗号后面的空格。

# mysql - 将数据从数据库导出到另一个 _mysql_exceptions。警告：第 1 行的列“x”的数据被截断

> ID：13516150
> 
> 赞同：0
> 
> 时间：2012-11-22T15:47:33.797
> 
> 标签：mysql, django

嗨，我有一个 PHP 项目，我想用 Django 开发相同的项目，出于多种原因，我决定创建一个新数据库，所以现在我必须将所有数据从旧数据库导出到新数据库，为此我使用我为 Django 开发的模型，它一直有效，直到我遇到这个错误：

```
_mysql_exceptions.Warning: Data truncated for column 'bloomberg' at row 1 
```

这是我正在试验这个问题的表的模型：

```
class Contact(models.Model):
company_id = models.ForeignKey(Company)
address = models.CharField(max_length=150)
first_name= models.CharField(max_length=50)
last_name = models.CharField(max_length=50)
role = models.CharField(max_length=20)
sector = models.CharField(max_length=45)
work_phone = models.CharField(max_length=30)
contact_source = models.CharField(max_length=30)
alt_work_phone = models.CharField(max_length=30)
mobile_phone = models.CharField(max_length=30)
work_fax = models.CharField(max_length=30)
bloomberg = models.CharField(max_length=60)
work_email = models.CharField(max_length=60)
research_email = models.CharField(max_length=60)
product_focus = models.CharField(max_length=2)
preferred_email = models.CharField(max_length=60)
job_title = models.CharField(max_length=80)
created_by = models.CharField(max_length=25)
legal_entity_name = models.CharField(max_length=100)
status= models.ForeignKey(Status)
title = models.CharField(max_length=5)
zipcode = models.CharField(max_length=10)
country = models.CharField(max_length=15)
city= models.CharField(max_length=20)
created_date=models.DateTimeField('creation date ')
updated_date=models.DateTimeField('update date ')
updated_by = models.CharField(max_length=20)
parent = models.CharField(max_length=45)
address_line_2 = models.CharField(max_length=100)
new = models.BooleanField()
hided = models.BooleanField()
employee = models.BooleanField()

def __unicode__(self):
    s = u" Contact "
    return s + self.first_name + " " + self.last_name 
```

两个数据库中的字段长度相同，所以我不明白这个错误，谷歌搜索后我注意到通常这个问题是通过修复列的尺寸来解决的，但这不是我的情况。有人可以告诉我如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:04:52.773

看起来 60 个字符对于您的“bloombergs”来说是不够的。尝试将其设置得更高，例如：

```
bloomberg = models.CharField(max_length=255) 
```

请注意，如果您已经同步了模型，您还必须在数据库级别执行此操作。希望这可以帮助。

# php - Symfony2 多个项目

> ID：13516153
> 
> 赞同：1
> 
> 时间：2012-11-22T15:47:40.193
> 
> 标签：php, symfony

你能指导我一些关于 Symfony2 和类似项目中常见组件的教程或有用信息吗？我有两个项目将使用大量相同的代码（主要是后端逻辑/用户处理/签出），但前端模板、显示和功能会有很大不同。

目前我有三个带有符号链接的文件夹（项目 1、项目 2 和 Symfony Base）。这是最好的设置吗？做得更好的建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:51:29.723

Symfony 2 Bundles 就是你想要的。将您想要在项目之间共享的所有内容打包到安装在两者中的捆绑包中 - 然后在其之上构建项目特定的 UI。

会推荐 Symfony 2 文档：[http ://symfony.com/doc/2.0/cookbook/bundles/index.html](http://symfony.com/doc/2.0/cookbook/bundles/index.html)

# sql - 根据选择语句更新日期的年份和月份

> ID：13516159
> 
> 赞同：2
> 
> 时间：2012-11-22T15:48:04.660
> 
> 标签：sql, sql-update

我有桌子`columns`

```
Year | Day | CreatedDate. 
```

我想更新`CreatedDate column`，所以一天部分喜欢`CreatedDate=Day`和一年部分`CreatedDate=Year`。

我尝试在更新语句中使用 datepart 函数但没有成功。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:16:19.917

尝试这样的事情：

```
UPDATE
   YourTable
SET
   CreatedDate = DateAdd(year, [Year] - DatePart(year, CreatedDate), 
      DateAdd(day, [Day] - DatePart(day, CreatedDate), CreatedDate)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:24:39.270

对于 SQL-Server 2012，它具有新功能**[`DATEFROMPARTS()`](http://msdn.microsoft.com/en-us/library/hh213228.aspx)**：

```
UPDATE
   TableX
SET
   CreatedDate = DATEFROMPARTS( [Year], MONTH(CreatedDate), [Day] ) ; 
```

# regex - 单个空格的正则表达式

> ID：13516162
> 
> 赞同：13
> 
> 时间：2012-11-22T15:48:16.027
> 
> 标签：regex

我正在尝试匹配由多个空格分隔的文件。我遇到的问题是第一个字段可以包含一个空格。如何将其与正则表达式匹配？

例如：

```
Name           Other Data    Other Data 2 
Bob Smith      XX1           0101010101
John Doe       XX2           0101010101
Bob Doe        XX3           0101010101
John Smith     XX4           0101010101 
```

我可以用正则表达式将这些行分成三个字段，用空格分隔，但在第一个字段中允许单个空格吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T15:53:03.503

嗨，下面的正则表达式应该可以工作

```
(\w*\s\w*)\s+\w{2}\d\s+\d* 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T16:04:39.523

这会起作用：

图案：

```
(.*?)[ ]{2,}(.*?)[ ]{2,}(.*) 
```

替换：

```
+$1+ -$2- *$3* 
```

`$1`包含第一列，`$2`第二列和`$3`第三列。

示例： [http ://regexr.com?32tbt](http://regexr.com?32tbt)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-22T15:53:54.800

您可以在两个或多个空格处拆分：

```
[ ]{2,} 
```

但是你可能会更好，确定这个正则表达式的捕获长度：

```
(Name[ ]+)(Other Data[ ]+) 
```

然后使用一个简单的子字符串方法将你的行分割成相同长度的部分。

因此，在您的情况下，第一次捕获将是 15 个字符长，第二个 14 和列将有 13 个（但最后一个并不重要，这就是它实际上没有被捕获的原因）。然后取前 15 个、接下来的 14 个以及每一行和`trim`每一行的剩余字符（删除尾随空格）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T16:10:59.153

我认为最简单的是使用匹配两个或多个空格的正则表达式。

```
/  +/ 
```

它分解为...定界符 ( `/`) 后跟一个空格 ( `) 后跟另一个空格一次或多次 ( `+) 后跟结束定界符（`/`在我的示例中，但特定于语言）。``

 ``所以简单地说，使用正则表达式来匹配空格，然后使用一个或多个空格来分割你的字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T15:55:04.853

通常，对于此类文件，最好的方法是根据所需信息的位置获取子字符串，然后对其进行修剪。我看到您的文件在第二个字段之前包含 16 个字符，您可以从开头获取长度为 16 的子字符串，其中包含您想要的文本。您应该修剪它以仅获取您需要的文本而没有空格。

如果您发布的间距模式是一致的（如果它不会在这种不同的文件之间发生变化），那么您还有另一个问题：更长的名称会发生​​什么？

```
Name           Other Data
Johnny AppleseeXX1
TutankamonfirstXX2 
```

如果您真的想使用正则表达式，请务必避免那些极端情况。``

# java - Javac 命令不起作用

> ID：13516164
> 
> 赞同：0
> 
> 时间：2012-11-22T15:48:22.133
> 
> 标签：java

我的 javac 命令不起作用。

“javac 不是内部或外部命令、可运行程序或批处理文件。”

1.  -java版本工作
2.  我已经尝试在命令提示符下成功设置类路径。`SET CLASSPATH "C:\Program Files\Java\jdk1.7.0_09\bin";`
3.  我已经将它添加到环境变量中。`;C:\Program Files\Java\jdk1.7.0_09\bin ;C:\Program Files\Java\jre7\bin`
4.  我检查了 bin 文件夹`java.exe`以及`javac.exe`.

^ 尝试了所有这些仍然不起作用。我也重新启动了命令提示符仍然不起作用。

为什么不工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:50:30.597

您显然使用了正确的路径，但您应该将其分配给`PATH`变量，而不是`CLASSPATH`变量。

您正在尝试将访问路径设置为可执行文件，而不是类文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T15:54:01.067

就这样做

在同一个对话框中，确保**JAVA_HOME**存在于您的用户变量或系统变量中，并将其设置为 JDK 的位置，例如 C:\Program Files\Java\jdk1.5.0_02 和**%JAVA_HOME%\bin**在您的 Path 环境变量中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T15:51:27.450

只需将 JAVA_HOME 设置为

```
C:\Program Files\Java\jdk1.7.0_09 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T15:51:58.473

在将 jre7\bin-Folder 的路径添加到 PATH-Variable 后，大多数情况下您需要重新启动计算机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T15:53:03.690

您是否尝试创建 JAVA_HOME 变量？该值应该是没有 bin 的 java 的路径。

另外，尝试打开 Eclipse。如果没有任何帮助，您可以做的最后一件事是安装 netbeans，它将配置所有内容。

# jquery-ui - jqueryui.com：关于 css 类的信息消失了

> ID：13516170
> 
> 赞同：0
> 
> 时间：2012-11-22T15:48:32.407
> 
> 标签：jquery-ui

在更新之前`jqueryui.com`，您通常会在任何小部件的文档中找到一个 css 类列表，您可以使用这些类来操纵外观或其位置。我的意思是*使用`ui-button-text`改变 xxx 之*类的东西。

在我看来，这些信息现在已经消失了，或者至少我找不到它。

有谁知道我在哪里可以获得任何小部件的这些信息？

# iphone - 如何打开蓝牙设置屏幕

> ID：13516173
> 
> 赞同：2
> 
> 时间：2012-11-22T15:48:43.007
> 
> 标签：iphone, ios6

我正在使用此代码打开蓝牙屏幕设置：

`NSURL *url = [NSURL URLWithString:@"prefs:root=General&path=Bluetooth"];
[[UIApplication sharedApplication] openURL: url];`

但它不起作用，我使用的是 iOS 6.0 SDK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T17:19:24.307

我相信在 iOS 5.1 中不推荐打开设置应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T16:29:57.763

似乎所有编程方式都是通过 url（仅适用于 5.0），或直接修改设置（非公共 api）。

但是，它也必须在 5.1+ 上以某种方式成为可能，例如“Runtastic”-App 在您启动它时正是这样做的（显示询问您是否要打开蓝牙设置的对话框）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-27T13:20:36.937

Swift 3.0 & iOS 10 及以上

```
func openBluetoothSettings(){
        let urlBTSet = URL(string: "App-Prefs:root=Bluetooth")
        let objApp = UIApplication.shared
        objApp.openURL(urlBTSet!)
    } 
```

目标-c

```
-(void) openBluetoothSettings{
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"App-Prefs:root=Bluetooth"]];
} 
```

所以，在上面的代码中，他们改变的是字符串需要添加“App-Prefs:root=Bluetooth”（这是打开蓝牙设置的例子）

不要忘记：'Goto taget -> info -> URL Types -> Add "prefs" in URL Schemes'

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-18T07:34:58.350

这是 iOS 6.0 的问题，但对于 iOS 8/9，这是答案，

转到您的 XCode 项目，在 Info -> URL Types 部分 -> URL Scheme 中的“prefs”下

> 在 IOS9 中：让 url = NSURL(string: "prefs:root=Bluetooth")!
> 
> IOS8: 让 url = NSURL(string: "prefs:root=General&path=Bluetooth")!

# ember.js - 如何在 Ember.js 中进行 _fast_ 表排序？

> ID：13516175
> 
> 赞同：7
> 
> 时间：2012-11-22T15:48:45.367
> 
> 标签：ember.js

我有一个 Ember 应用程序，它呈现一个约 200-300 行的表。我尝试实现类似 Tablesorter 的功能，但遇到了非常糟糕的性能。

应用程序相关部分的概述如下：有一个对象集合，一个`ArrayController`and `CollectionView`。`CollectionView#content`绑定到`ArrayController#arrangedContent`并通过设置`ArrayController#sortProperties`属性进行排序。

为了方便起见，我设置了一个 JS 小提琴：http: [//jsfiddle.net/496tT/1/](http://jsfiddle.net/496tT/1/)。在 JS 控制台的 Chrome 中，您可以看到原始排序大约需要 5 毫秒，而表格排序大约需要 1000 毫秒。

在我当前的实现中，Ember`arrangedContent`会在更新时重新呈现所有视图。*我认为可以通过对项目视图*进行排序来加快排序，`CollectionView`从而以正确的顺序有效地将视图重新附加到 DOM。但我不知道如何在 Ember.js 中正确执行此操作。

有什么想法吗？

PS——这里有一个副本——https: [//stackoverflow.com/questions/12915647/table-sort-with-emberjs-clear-and-rebuild-the-table——](https://stackoverflow.com/questions/12915647/table-sort-with-emberjs-clear-and-rebuild-the-table)但它没有答案；在这个问题中，为了方便起见，我设置了一个小提琴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T05:43:49.413

我不知道这是否会让你的工作速度得到足够的提升，但你可以做的一件事是改变视图绑定的内容。您将其绑定到 controller.arrangedContent 而不仅仅是控制器。如果我改变，在小提琴中：

```
App.MyView = Ember.CollectionView.extend({
    tagName: 'ul',
    contentBinding: 'controller.arrangedContent',
    itemViewClass: Ember.View.extend({
        tagName: 'li',
        templateName: 'element'
    })
}); 
```

至：

```
App.MyView = Ember.CollectionView.extend({
    tagName: 'ul',
    contentBinding: 'controller',
    itemViewClass: Ember.View.extend({
        tagName: 'li',
        templateName: 'element'
    })
}); 
```

对我来说，事情从大约 9 秒“原始排序”到 6 秒。s1 和 s2 也平均在 900 左右，而不是 1400 左右。

# sitefinity-5 - 如何将共享内容块映射到 Sitefinity 5.2 中的模板？

> ID：13516177
> 
> 赞同：0
> 
> 时间：2012-11-22T15:48:47.553
> 
> 标签：sitefinity-5

我刚刚将我的 3.7 网站迁移到 5.2 网站，但我注意到 3.7 项目中的通用内容已转换为 5.2 中的共享内容块。最重要的是不是全部（只有少数与页面相关，即在页面中使用的列具有“未使用”值）。

我进行了很多搜索，但找不到任何将这些块映射到页面的方法，就像它们在 3.7 Project 中一样。

但是，我试图按照教程： [http ://www.sitefinity.com/documentation/documentationarticles/user-guide/widgets/content-widgets-group/configuring-the-content-block-widget](http://www.sitefinity.com/documentation/documentationarticles/user-guide/widgets/content-widgets-group/configuring-the-content-block-widget)

但是我在编辑模板模式下没有看到任何选项，例如“从现有共享内容按钮中选择”，我在编辑页面模式下获得了这个选项，当我通过选择现有内容来设置内容时，它不会在查看模式下显示，但是它以编辑模式显示。

任何想法如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T08:17:54.903

随着 Sitefinity v4 的引入，共享内容不再可用于模板，而仅可用于页面。不幸的是，由于架构原因和性能问题，他们删除了该功能。

目前关于如何解决它的官方评论是使用继承模板，您将普通内容块放在“父”模板上，因此其子模板继承它，同时保持单点编辑。

作为**非推荐**的“hack”，您可以激活它，如此[处](http://jbokkers.posterous.com/shared-content-in-sitefinity-4-templates)所述。但请记住 Telerik 的回复：

> 会导致性能问题。这就是默认禁用此功能的原因，我们不建议使用它。

但是，当您阅读计划于 2012 年 12 月末发布的[Sitefinity 5.3 路线图](http://www.sitefinity.com/product/see-also/roadmap)时，也有一个好消息：

> 5.3 版本包括以下改进： 共享内容现在可用于内部页面模板

希望这会有所帮助，约赫姆。

# java - 主线程和从线程应该使用 ctrl+c 关闭

> ID：13516183
> 
> 赞同：1
> 
> 时间：2012-11-22T15:49:13.163
> 
> 标签：java

我正在编写一个程序，其中 Main 类初始化并启动一个主线程。这个主线程启动`n`从线程。该程序应使用终止`Ctrl+C`。主线程必须停止从线程并最终停止自己。我已经阅读了很多`addShutdownHook`，这是我的简化实现：

```
package dictator;

import java.util.ArrayList;
import java.util.List;

public class Main {

    public static void main(String[] args) {
        Master m = new Master();
        m.start();
    }
}

class Master extends Thread {

    List<Slave> slaveMonitor = new ArrayList<Slave>();

    public Master() {
        for (int i = 0; i < 4; i++) {
            Slave slaveThread = new Slave();
            slaveMonitor.add(slaveThread);
        }

        Thread shutDown = new Thread() {
            @Override
            public void run() {
                try {
                    System.out.format("%nShutting down threads...%n");
                    for (Slave s : slaveMonitor) {
                        s.interrupt();
                        s.join();
                    }
                    interrupt()
                } catch (InterruptedException ex) {
                    ex.printStackTrace();
                }
            }
        };
        Runtime.getRuntime().addShutdownHook(shutDown);
    }

    @Override
    public void run() {
        for (Slave s : slaveMonitor) {
            s.start();
        }

        while (true) {
            System.out.println(getName() + " - Master");
            try {
                Thread.sleep(1000);
            } catch (InterruptedException ex) {
                System.out.println(getName() + " interrupted.");
               break;
            }
        }
        System.out.println(getName() + " exiting.");
    }
}

class Slave extends Thread {

    public Slave() {}

    @Override 
    public void run() {
        while (true) {
            System.out.println(getName() + " - Slave");
            try {
                Thread.sleep(1500);
            } catch (InterruptedException ex) {
                System.out.println(getName() + " interrupted.");
                break;
            }
        }
    }
} 
```

`addShutdownHook`捕获信号并终止所有从属线程，但我没有看到主线程退出（行`System.out.println(getName() + " interrupted.");`和在主线程的`System.out.println(getName() + " exiting.");`运行主体中。

这是我的终端的输出：

```
Thread-1 - Slave
Thread-2 - Slave
Thread-3 - Slave
Thread-0 - Master
Thread-4 - Slave
Thread-0 - Master
^C
Shutting down threads...
Thread-1 interrupted.
Thread-2 interrupted.
Thread-3 interrupted.
Thread-4 interrupted. 
```

我不应该看到以下行吗？*我做错了什么？*

```
Thread-0 interrupted.
Thread-0 exiting. 
```

## 更改主线程

```
class Master extends Thread {

    List<Slave> slaveMonitor = new ArrayList<>();
    List<Thread> killList = new ArrayList<>();

    public Master() {

        for (int i = 0; i < 4; i++) {
            Slave slaveThread = new Slave();
            slaveMonitor.add(slaveThread);
        }
        killList.add(this);

        Thread shutDown = new Thread() {
            @Override
            public void run() {
                try {
                    killList.addAll(slaveMonitor);
                    Collections.reverse(killList);
                    System.out.format("%nShutting down threads...%n");
                    for (Thread t : killList) {
                        t.interrupt();
                        t.join();
                    }
                } catch (InterruptedException ex) {
                    ex.printStackTrace();
                    System.out.println("Interrupted shutdown process");
                    System.exit(1);
                }
            }
        };
        Runtime.getRuntime().addShutdownHook(shutDown);
    }
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:02:52.443

您的关闭线程永远不会中断主线程。它是与主线程分开的线程，因此当您调用时

```
 interrupt() 
```

在其正文中，您要求该线程自行中断。您需要将主线程添加到要终止的线程列表中。

将您的代码更改为：

```
 List<Thread> killList = new ArrayList<Thread>();
   ....
    for (int i = 0; i < 4; i++) {
        Slave slaveThread = new Slave();
        slaveMonitor.add(slaveThread);
    }
    killList.addAll(slaveMonitor);
    killList.add(this); 
```

并使用`killList`来终止线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T14:56:25.287

1）创建一个使用两种类型线程的程序：从属（传感器）和主线程。

从属线程收集测量值并将其转发给主线程

为简单起见，从站测量当前时间（System.currentTimeMillis()）。只有主线程将值输出到控制台。测量值存储在共享变量中。从机的数量应从控制台读取。

# python - 与泛滥的 api 集成 - 扭曲延迟

> ID：13516187
> 
> 赞同：1
> 
> 时间：2012-11-22T15:49:33.257
> 
> 标签：python, twisted

我有一个非常简单的脚本来监视文件传输进度，将其实际大小与目标进行比较，然后计算其哈希值，与所需的哈希值进行比较，并在一切正常时启动一些额外的东西。

我已将用于文件传输的工具 (wget) 替换为 deluged，它有一个简洁的 api 可以与之集成。

而不是比较文件进度和比较哈希值，我现在只需要知道何时完成下载文件。为了实现这一点，我能够根据自己的需要修改[这个脚本](http://forum.deluge-torrent.org/viewtopic.php?f=8&t=39731#p167183)，但是我一直在试图将我的头包裹在被淹没的扭曲框架上。

为了尝试克服它，我从[扭曲的延迟文档](http://twistedmatrix.com/documents/current/core/howto/defer.html)中获取了一个示例脚本，围绕它包装了一个类，并尝试使用我在我提到的这个脚本中使用的相同概念。

现在，我不知道如何处理 reactor 对象，因为它基本上是一个无法重新启动的阻塞循环。

这是我正在使用的示例代码：

```
from twisted.internet import reactor, defer
import time

class DummyDataGetter:
    done = False
    result = 0
    def getDummyData(self, x):
        d = defer.Deferred()
        # simulate a delayed result by asking the reactor to fire the
        # Deferred in 2 seconds time with the result x * 3
        reactor.callLater(2, d.callback, x * 3)
        return d

    def assignResult(self, d):
        """
        Data handling function to be added as a callback: handles the
        data by printing the result
        """
        self.result = d
        self.done = True
        reactor.stop()

    def run(self):

        d = self.getDummyData(3)
        d.addCallback(self.assignResult)

        reactor.run()

getter = DummyDataGetter()
getter.run()
while not getter.done:
    time.sleep(0.5)
print getter.result
# then somewhere else I want to get dummy data again

getter = DummyDataGetter()
getter.run() #this throws an exception of type error.ReactorNotRestartable
while not getter.done:
    time.sleep(0.5)
print getter.result 
```

我的问题是：

1.  是否应该在另一个线程中触发 reactor 以防止它阻塞代码？

2.  如果是这样，我将如何在一个单独的线程中向这个反应器添加更多回调？`reactor.callLater(2, d.callback, x * 3)`只需从我的主线程中执行类似于, 的操作吗？

3.  如果不是，有什么技术可以克服不能在同一过程中启动/停止反应器两次或更多次的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T02:46:43.713

好的，我发现的最简单的方法是简单地使用一个名为 using 的单独脚本`subprocess.Popen`，将种子的状态和其他任何需要的内容转储到标准输出（使用 JSON 序列化）并将其通过管道传输到调用脚本中。

比学习扭曲的创伤要小得多，但当然远非最佳。

# javascript - JavaScript，在变量中获取 url 正文

> ID：13516188
> 
> 赞同：2
> 
> 时间：2012-11-22T15:49:40.160
> 
> 标签：javascript, arrays, url, variables

我知道这很容易，抱歉问了，但我快疯了，我无法理解。一定是基础，我把它们都弄混了:((

我有这个网址：

[https://www.myweb.sub.com/~user/folder/file.php?param=Value](https://www.myweb.sub.com/~user/folder/file.php?param=Value)

我需要得到：

[https://www.myweb.sub.com/~user/folder/](https://www.myweb.sub.com/~user/folder/)

在一个变量中。

请帮助实现它。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:51:54.140

所以我们不会为你咀嚼它，这里有一个链接应该让你走上正确的道路：

找到一个字符的最后一个索引：http: [//www.w3schools.com/jsref/jsref_lastindexof.asp](http://www.w3schools.com/jsref/jsref_lastindexof.asp)

用这个获取字符串的子字符串：http: [//www.w3schools.com/jsref/jsref_substring.asp](http://www.w3schools.com/jsref/jsref_substring.asp)

告诉我们您之后是否仍需要帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T15:53:12.520

您可以使用[`slice()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/slice)和[`lastIndexOf()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/lastIndexOf)方法：

```
var url = "https://www.myweb.sub.com/~user/folder/file.php?param=Value"; 
var segment = url.slice(0, url.lastIndexOf("/") + 1); 
```

如果您当前的 URL 实际上是`https://www.myweb.sub.com/~user/folder/file.php?param=Value`，请`window.location.href`改为操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T15:56:59.700

用这个 ：-

```
var str="https://www.myweb.sub.com/~user/folder/file.php?param=Value";
var n=str.substring(0,str.indexOf("file")); 
```

# google-fusion-tables - 如何查询融合表中的数据

> ID：13516196
> 
> 赞同：1
> 
> 时间：2012-11-22T15:49:57.273
> 
> 标签：google-fusion-tables

我在融合表上有两个数据集。一个是点图层（图书馆），另一个是多边形图层（地块）。如何使用谷歌地图/融合表设计查询来解决这个问题：图书馆 1 公里（例如）内有多少地块？

此外，我还看到了一些类似这样的搜索距离是预定义的。是否可以设计一个没有预定义搜索距离的查询？我希望距离未定义。

我知道这项任务将需要使用 javascript（我还是个初学者），所以在这方面的帮助也将不胜感激。

谢谢你的帮助！

# c# - 处理连接时未调用 DbConnection.StateChange？

> ID：13516199
> 
> 赞同：2
> 
> 时间：2012-11-22T15:50:00.673
> 
> 标签：c#, semaphore, idisposable, dbconnection

我有一个可以同时从数百个线程访问的单例数据库类。每个线程都有自己的连接。由于无法控制线程数，所以需要限制并发连接数。我决定使用**信号量**，如下所示。现在，连接总是在一个`using`块中分配，因此确实可以保证关闭 - 即使抛出异常。

但是，抛出异常时似乎没有**调用**[StateChange 。](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnection.statechange.aspx)显然，这破坏了我下面的代码。

 ****问题：**我如何确保`StateChange`在这种情况下确实被调用？或者，如果不可能，我该如何解决这个特定问题？

```
private const int MAX_CONNECTIONS = 10;
private static SemaphoreSlim connectionLock = new SemaphoreSlim(MAX_CONNECTIONS);

protected DbConnection OpenConnection()
{
    var connection = ProviderFactory.CreateConnection();
    connection.ConnectionString = ConnectionString;
    connection.Open();

    connectionLock.Wait();

    connection.StateChange += (s, e) =>
    {
        if (e.CurrentState == ConnectionState.Closed)
        {
            connectionLock.Release();
        }
    };

    return connection;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:51:46.090

好的...如果*在*调用`OpenConnection`. 当我对此进行测试时，我`throw new Exception()`在返回连接之前放置了一个显式的......哎呀！**

# javascript - 在请求发送后实现服务器端

> ID：13516200
> 
> 赞同：0
> 
> 时间：2012-11-22T15:50:05.307
> 
> 标签：javascript, json, node.js, architecture, mongoose

现在，我发现如果我将这个 url 放到我的浏览器中，一个`.csv`文件将被下载到我的电脑上的下载文件夹中，其中这个词`YHOO`是雅虎 [http://ichart.finance.yahoo 的股票代码。 com/table.csv?s=YHOO&d=0&e=28&f=2010&g=d&a=3&b=12&c=1996&ignore=.csv](http://ichart.finance.yahoo.com/table.csv?s=YHOO&d=0&e=28&f=2010&g=d&a=3&b=12&c=1996&ignore=.csv)

有什么方法可以在我自己的个人使用的 RESTful 网站上实现上述操作

1.  在客户端 GUI 上，用户输入符号
2.  在客户端，请求 URL 是用符号构造的
3.  客户端将请求 URL 发送到浏览器（类似于我上面描述的操作）
4.  浏览器将文件下载到服务器上的某个位置（Dropbox / EC2）
5.  `.csv`文件被转换为`json`服务器上的对象
6.  `json`对象返回给客户端

我该怎么做，以及推荐使用哪个框架以获得高性能。我正在考虑 NodeJS 和 Mongoose。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:06:37.587

我这样解释你的问题：

1.  在浏览器或 GUI 上，用户输入符号
2.  在服务器端，请求 URL 是用符号构造的
3.  服务器端将请求 URL 发送到上述 url（类似于我上面描述的操作）
4.  服务器端将文件下载到服务器或远程存储库（dropbox / EC2）上的某个位置
5.  .csv 文件在服务器上转换为 json 对象
6.  然后服务器返回 json 对象返回给浏览器或 GUI

如果是这样，那么您的问题的答案是肯定的，如果您想正常工作，这可能会有点棘手。这不一定是 Node.js 特定的。您不需要 Node.js 或 Mongoose，因为您没有将 CSV 保存到硬盘驱动器，而只是作为临时传输器。

基本上，您可以在“servlet”中向另一个 url 发出 POST 调用并获取 CSV 文件。

然后将其转换并在响应中写入文件并将其返回给客户端。

# windows-8 - 区分 Windows 8 Web 浏览器和应用程序用户代理

> ID：13516203
> 
> 赞同：3
> 
> 时间：2012-11-22T15:50:12.797
> 
> 标签：windows-8, user-agent

我正在尝试在用户代理上使用 Reg-ex 来识别 Windows 8 请求。区分应用程序请求/浏览器请求的最佳方法是什么？我在用户代理字符串中寻找什么差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:01:50.557

[这](http://social.msdn.microsoft.com/Forums/en-US/windowsdeveloperpreviewgeneral/thread/6be392da-4d2f-41b4-8354-8dcee20c85cd/)应该有助于构建您的正则表达式

# flash - 版本控制 .swf 文件的最佳实践

> ID：13516204
> 
> 赞同：1
> 
> 时间：2012-11-22T15:50:13.177
> 
> 标签：flash, git, apache-flex, version-control

我们的团队有一个 assets.swf 文件，其中包含 Flex 应用程序的所有图标。

对 .swf 文件进行版本控制的最佳做法是什么？
我们应该为每个开发者创建 .swf 文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T12:46:16.203

有一些工具可用于从文本源（SWFMill、HXSWFML 等）创建 SWF 图形，FXG 试图解决这个问题，但大多数设计人员使用无法版本化的源格式，或者是很难融入版本控制系统。

阻力最小的途径是允许检入 SWF 二进制文件并手动解决冲突。嗯……至少你知道这不是你的错。

您可以做什么（我这样做了，但出于其他原因）：运行旧 SWF 文件和新 SWF 文件`swfdump`并查看差异。不幸的是，Flash 编译器的设计目的不是为了在二进制文件中保留完全相同的信息，如果它在编译之间没有改变，那么一些噪音会通过。但是，如果您不确定如何解决冲突（不知道 SWF 中的内容），这可能会让您更好地了解发生了什么变化。从技术上讲，您甚至可以检查`swfdump`（它可以稍后被组装成 SWF 文件来解析它），但这听起来不值得麻烦，最好在管理级别解决，也许要求人们锁定文件，如果他们正在修改它（然后用电锯追赶他们，要求他们解锁......）等等。好吧，正如我之前所说，不是*很好*的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:47:34.107

小的静态（即不经常更改）资源（如图标）可以存储在 Git 中。
只有当这些资源太大（因为它们的大小或数量）时才会出现问题，然后您必须考虑将它们存储在外部引用中。

至于 SWF 文件（如“[从 SWF 文件中嵌入资源](http://blog.flexexamples.com/2007/07/25/embedding-assets-from-swf-files/)”中所述），与任何其他来源一样，也有文本文件，所有开发人员都可以访问、分支、合并。

# iphone - MFMailComposeViewController 在 canSendMail 上超时？

> ID：13516205
> 
> 赞同：3
> 
> 时间：2012-11-22T15:50:26.110
> 
> 标签：iphone, ios, mfmailcomposeviewcontroller

所以这个主题大多是不言自明的。当我踏入

```
if ([MFMailComposeViewController canSendMail] && [sender.titleLabel.text isEqualToString:@"Contact Support"])
        [self displaySupportComposerSheet];
    else if([MFMailComposeViewController canSendMail])
        [self displayDarrenComposerSheet]; 
```

我在控制台中收到此消息：超时消息邮件确定 CanSendMail 状态

我还尝试了似乎是旧式的邮件撰写方式，即

```
 Class mailClass = (NSClassFromString(@"MFMailComposeViewController")); 
```

我仍然收到同样的信息。有任何想法吗？

此外，当我将 MFMailComposeViewController 设为属性而不是每个方法的局部变量时，它似乎不喜欢它，这是为什么呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-21T17:46:47.010

在我调用之前编写要添加为附件的大型 PDF 文件时出现此错误`[[MFMailComposer alloc] init]`。当我将 Composer 创建移动到 PDF 创建器的大量内存消耗之前的某个点时，我不再在日志中看到此错误。

# sql - SQL Server 中的月份名称

> ID：13516210
> 
> 赞同：1
> 
> 时间：2012-11-22T15:50:37.993
> 
> 标签：sql, sql-server

SQL Server 中是否有一个内置函数可以逐月返回我的波兰语（或任何其他语言）名称？还是需要我编写自己的函数？

例如

```
GetMonthName(11) => Listopad (November) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T15:58:27.530

您可以使用函数[Month](http://msdn.microsoft.com/en-us/library/ms187813.aspx)或 datepart "month" 从日期/时间返回月份数。然后你可以使用[DATENAME](http://msdn.microsoft.com/en-us/library/ms174395.aspx)函数：

```
SELECT DATENAME(month, GETDATE()) AS 'Month Name' 
```

返回值取决于使用 SET LANGUAGE 设置的语言环境和登录的“配置默认语言”服务器配置选项。

因此，根据 Jacek 的评论，这可以概括为：

```
SET LANGUAGE Polish SELECT DATENAME(month, GETDATE()) AS 'Month Name' 
```

如果实际上您只有一个月份数，则需要构建一个包含该月份数的日期时间变量，以便您可以应用上述方法。在 SQL Server 2012 中，您可以使用[DATETIMEFROMPARTS](http://msdn.microsoft.com/en-us/library/hh213233.aspx)：

```
SELECT @RandomDate = DATETIMEFROMPARTS(2012, @MonthNumber, 1, 1, 1, 1, 0) 
SET LANGUAGE Polish SELECT DATENAME(month, @RandomDate) AS 'Month Name' 
```

# c# - C#中的双重检查锁定

> ID：13516211
> 
> 赞同：0
> 
> 时间：2012-11-22T15:50:43.670
> 
> 标签：c#, .net, multithreading, double-checked-locking

这个想法是从

*   一个变量
*   如果不存在，则从文件中
*   如果不存在，则从服务器

```
public static string LoadData(int id)
{
    if (_isDataLoaded[id - 1])
    {
      return _data[id - 1];
    }

    if (File.Exists(_fileName))
    {
        bool dataExists;
        string cachedData;
        if (GetCachedConstant(id, out cachedData)) //read from a file
        {
            lock (_locker)
            {
                _isDataLoaded[id - 1] = true;
                _data[id - 1] = cachedData;
            }

            return _data[id - 1];
        }
    }

    string remoteData = GetFromServer(id);
    lock (_locker)
    {
        CacheToFile(id, remoteData); //write to a file
        _data[id - 1] = remoteData;
        _isDataLoaded[id - 1] = true;
    }

    return _data[id - 1];
} 
```

许多线程使用此代码。尽管它看起来是线程安全的，但实际上并非如此。因此，我对其进行了测试，这给了我这个想法并让我确信。`_data`写作前应仔细检查现有情况。例如，它应该像通常在模式 Singleton 中使用的双重检查。

有人请让我了解如何在这里实现它？

**编辑：**

```
string[] _data;
bool[] _isDataLoaded. 
```

**编辑2**：

上面的代码可能与 .NET < 4.0 一起使用，因此不允许在那里使用 Lasy。我现在唯一的问题是，我应该使用 volatile 以防我使用双重检查锁定吗？

```
volatile string[] _data;
volatile bool[] _isDataLoaded. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:05:49.163

我可以看到两个明显的线程问题来源

*   `_data`和是什么类型`_isDataLoaded`？ **如果这些类型不是线程安全的，那么** [如果没有两个线程访问相同的元素，那么您的代码数组也不是线程安全的](https://stackoverflow.com/questions/1460634/are-c-sharp-arrays-thread-safe)，这可能发生在上面的代码中。尝试改用[ConcurrentDictionary](http://msdn.microsoft.com/en-us/library/dd287191.aspx)。
*   取决于确切的实现，`GetCachedConstant`并且`CacheToFile`存在潜在的竞争条件，即线程 A 可能开始将缓存数据写入文件，导致线程 B 沿着该`File.Exists`路线走，而实际上该文件仅包含部分写入的数据

我猜罪魁祸首是这两个中的第一个 - 可能还有其他问题，但除非这些类型是线程安全的，否则再多的双重检查锁定将拯救你，除非你也同步对这些对象的访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:12:38.943

我将替换`_data`为`Lazy<string>[]`，其中从文件和网络中获取发生在您传入的委托中。

因此，在静态构造函数中执行以下操作：

```
_data=new Lazy<string>[maxId+1];
for(int i=0;i<_data.Length;i++)
{
  _data[i]=new Lazy<string>(()=>fetchData(i), LazyThreadSafetyMode.ExecutionAndPublication);
} 
```

然后简单地获得价值`_data[i].Value`。

* * *

如果你*真的*想要双重检查锁定，它基本上是这样的：

```
if (!_isDataLoaded[id - 1])
{
    lock(locker)
    {
        if(!_isDataLoaded[id - 1])
        {
            ...
            _data[id - 1] = ...;
            _isDataLoaded[id - 1] = true;
        }
    }
}
return _data[id - 1]; 
```

这段代码的问题是很难弄清楚它是否真的能保证工作。这取决于您运行的平台的内存模型。AFAIK .net 2.0 内存模型保证这是可行的，但 ECMA CLR 模型和 java 模型不能。内存模型问题非常微妙且容易出错。所以我强烈建议不要使用这种模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T16:05:13.917

怎么样，保持一个锁来从/向缓存加载/持久化数据

```
public static string LoadData(int id)
{
    if (_isDataLoaded[id - 1])
      return _data[id - 1];

    lock (_locker)
    {
        if (_isDataLoaded[id - 1])
          return _data[id - 1];

        if (File.Exists(_fileName))
        {
            bool dataExists;
            string cachedData;
            if (GetCachedConstant(id, out cachedData)) //read from a file
            {
                _data[id - 1] = cachedData;
                _isDataLoaded[id - 1] = true;
                return _data[id - 1];
            }
        }

        string remoteData = GetFromServer(id);
        CacheToFile(id, remoteData); //write to a file
        _data[id - 1] = remoteData;
        _isDataLoaded[id - 1] = true;
        return _data[id - 1];
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T16:02:17.797

为什么不在方法的开头锁定。这可以确保您的数据（缓存）始终处于有效/一致的状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-22T16:11:25.237

```
 lock (_locker)
    {
        _isDataLoaded[id - 1] = true;
        _data[id - 1] = cachedData;
    } 
```

这里`_isDataLoaded`是在 之前设置的，因此初始化之前`_data`有人看到`_isDataLoaded`和阅读的比赛。`_data``_data`

但扭转它并不能解决问题。不能保证另一个线程会以相同的顺序看到分配，因为阅读器不使用任何锁或内存屏障。

检查 Wikipedia 以了解使用 C# 执行此操作的正确方法。[http://en.wikipedia.org/wiki/Double-checked_locking](http://en.wikipedia.org/wiki/Double-checked_locking)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-22T15:54:11.680

双重检查锁定背后的想法就是它的名字。您之前检查您的条件`lock`（如在您的代码中），但也`lock`再次在块内检查，以确保另一个线程没有更改状态（即条件的结果），而当前线程在（成功）检查和`lock`陈述。

# java - java - 将多个列表背靠背写入单个 JsonArray 的最佳方法

> ID：13516216
> 
> 赞同：2
> 
> 时间：2012-11-22T15:50:53.450
> 
> 标签：java, json, jackson

我的问题是将多个列表转换回单个 JsonArray 的最佳方法是什么。列表是即时出现的，所以我不想或者我不能将所有列表（list1 - listn）合并到一个大列表中，然后使用 Jackson 将合并的列表写入 JsonArray。

兑换

```
ArrayList<Event> list1 = new ArrayList<Event>();
    list1.add(new Event("a1","a2"));
    list1.add(new Event("b1","b2"));

ArrayList<Event> list2 = new ArrayList<Event>();
    list2.add(new Event("c1","c2"));
    list2.add(new Event("d1","d2"));
......
......listn 
```

对于单个 jsonArray：

```
[
{"field1":"a1", "field2":"a2"},
{"field1":"b1", "field2":"b2"},
{"field1":"c1", "field2":"c2"},
{"field1":"d1", "field2":"d2"},
......
{"field1":"n1", "field2":"n2"}
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:16:25.877

我不知道`Jackson`，但看着`API`我会这样做：

1.  创建`WriterBasedJsonGenerator`（或`JsonGenerator`您使用的任何）的自定义实现，以稍微修改行为：

```
    公共 MyJsonGenerator 扩展 WriterBasedJsonGenerator {
        @覆盖
        public void writeStartArray() {//什么都不做
        }

        @覆盖
        public void writeEndArray() {//什么都不做
        }
    }

```

1.  比在写第一个之前`ArrayList`我会做

    ```
    生成器.writeRaw('[');
    ```

在下一个列表之前

```
generator.writeRaw (','); 
```

在最后一个列表之后

```
generator.writeRaw (']'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T10:52:19.683

在一天结束时，我发现杰克逊没有这样的方法允许您直接将两个列表背靠背写入 JsonArray。您可以使用自己的实现 writeStartArray() writeEndArray() 来实现 JsonGenerator 或者更简单，您可以定义 startArray 和 endArray，并自己构造 jsonArray

```
private static final String JSON_ARRAY_START = "[" + LINE_BREAK;
private static final String JSON_ARRAY_COMMA = "," + LINE_BREAK;
private static final String JSON_ARRAY_END = LINE_BREAK+ "]"; 
```

所以代码大致如下所示：

```
write(JSON_ARRAY_START)
foreach list1
    use objectMapper write every Event object
    write(JSON_ARRAY_COMMA)
foreach list2
    use objectMapper write every Event object
    if it's not the last element in the list, write(JSON_ARRAY_COMMA)
write(JSON_ARRAY_END) 
```

# c# - Castle Windsor StartableFacility 无法启动

> ID：13516218
> 
> 赞同：0
> 
> 时间：2012-11-22T15:50:55.560
> 
> 标签：c#, .net-4.0, castle-windsor

我正在遵循以下示例（激进的旧模式）：

[http://docs.castleproject.org/Default.aspx?Page=Startable-Facility&NS=Windsor&AspxAutoDetectCookieSupport=1](http://docs.castleproject.org/Default.aspx?Page=Startable-Facility&NS=Windsor&AspxAutoDetectCookieSupport=1)

这是我的完整源代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;
using Castle.Facilities.Startable;
using Castle.MicroKernel;
using Castle.MicroKernel.Registration;

namespace Test
{
    public interface IStartable
    {
        void Start();
        void Stop();
    }

    public class Startable : IStartable
    {
        public Startable()
        {
            Console.WriteLine("Created!");
        }

        public void Start()
        {
            Console.WriteLine("Started!");
        }

        public void Stop()
        {
            Console.WriteLine("Stopped!");
        }
    }

    [TestFixture]
    public class StartableFacilityContainerTest
    {

        [Test]
        public void TestOperation()
        {
            IKernel container = new DefaultKernel();

            container.AddFacility<StartableFacility>();

            container.Register(Component.For<Startable>());
            Console.WriteLine("Registered!");

            container.Dispose();
            Console.WriteLine("Released!");
        }
    }
} 
```

但是，当我运行它时，我得到：

```
Registered!
Released! 
```

当我期望得到（如示例中所示）时：

```
Created!
Started!
Registered!
Stopped!
Released! 
```

基本上我的 Startable 没有启动。

这是在 .Net 4.0 和 Castle Windsor 3.0 中测试的

我做错什么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-29T14:35:11.217

我正在使用安装程序。这帮助了我：

```
container.AddFacility<StartableFacility>(f => f.DeferredTryStart()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:02:32.107

尝试

```
container.Register(Component.For<Startable>()
     .StartUsingMethod(s => s.Start)
     .StopUsingMethod(s => s.Stop); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-08T14:16:40.200

问题是您已经创建并实现了自己的`IStartable`界面，而不仅仅是实现`Castle.Core.IStartable`

# c# - 设计器中的 Microsoft.Practices.Unity 程序集错误

> ID：13516223
> 
> 赞同：3
> 
> 时间：2012-11-22T15:51:15.980
> 
> 标签：c#, unity-container, windows-forms-designer

我正在尝试使用 Windows 窗体设计器打开 ActiveReport 文件，但出现此错误：

```
Could not load file or assembly 'Microsoft.Practices.Unity, Version=2.0.414.0, ... ' or one of its dependencies. The specified file could not be found. 
```

我检查了调用堆栈并转到导致异常的文件。`Microsoft.Practices.Unity`并且`Microsoft.Practices.Unity.InterceptionExtension`都包括在内，参考路径很好，dll在文件夹中......

为什么设计器会抛出此异常而编译器不会？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:03:05.667

仍然不知道是什么导致了这个错误，但是删除然后重新添加引用似乎是一个部分解决方案，直到错误再次显示......

# java - 使用 WindowBuilder + Scala，有什么好主意吗？

> ID：13516224
> 
> 赞同：0
> 
> 时间：2012-11-22T15:51:15.780
> 
> 标签：java, eclipse, scala, user-interface

我这里有一个小型 Scala 控制台应用程序，它工作正常。我现在只有一个麻烦：这个应用程序应该被扩展。其中一个请求是，应该有一个 GUI（AWT、SWT、Swig - 没关系，它只需要在 Windows 上运行）。

好吧，我真的不想编写自己的 GUI。我喜欢像 WindowBuilder 这样的工具。我可以结合这个有效吗？如果我用编辑器创建 GUI，我会得到生成的 Java 代码，对吗？这会是个问题吗？我只需要创建一个 Mixin-Project，构建 GUI 并为每个 GUI 元素（按钮或任何带有侦听器的东西）分配一个 scala 函数。所以我不必重写任何 scala 的东西，只需指向函数。这就是它的工作方式吗？有什么建议么？谢谢

编辑：对我来说，在 scala 应用程序中生成 java 代码看起来很脏，但是我看到没有其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:59:39.560

我已经这样做了好几次，发现在一个项目中混合 Java 和 Scala 代码没有问题。

为了让 Scala 编译器更容易，不要将 Java 和 Scala 类放在同一个包中。

# c# - System.NullReferenceException 在 Process.start

> ID：13516232
> 
> 赞同：2
> 
> 时间：2012-11-22T15:52:02.863
> 
> 标签：c#, .net, configuration-files

我有一个使用 Process.Start 执行 exe 的应用程序。它适用于我测试过的所有 .exe，除非 .exe 有一个配置文件，它在其中获取连接字符串，当这种情况发生时，我得到一个 System.NullReferenceException。这是我的代码。

执行exe：

```
string eucApp = @"C:\Temp\app.exe"
startInfo = new ProcessStartInfo(eucApp);
using (Process execProcess = Process.Start(startInfo))
{
    execProcess.WaitForExit();
} 
```

然后exe启动，第一件事就是用这个代码行获取一个连接字符串

```
strCadena = ConfigurationManager.ConnectionStrings("ConnectionString") 
```

如果我用这样的连接字符串替换它，它工作正常

```
strCadena = "Data Source=HostName;Initial Catalog=MyDB;Integrated security=True" 
```

我会删除配置文件并将其值放入 .exe 代码中，但问题是我有超过 500 个使用配置文件的 .exe，所以如果有人知道避免这种情况的方法，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:22:30.300

谢谢你的帮助。我解决了这个问题。不知何故，.exe 指向启动进程的应用程序的 app.config。我将这个类添加到用 VB .Net 开发的 .exe 中

```
Imports System.Configuration
Imports System.Reflection
Public Class AppConfig
  Implements IDisposable
  Public Shared Function Change(ByVal path As String) As AppConfig

    Return New ChangeAppConfig(path)
  End Function
  Public Overridable Sub Dispose() Implements IDisposable.Dispose
  End Sub
  Private Class ChangeAppConfig
    Inherits AppConfig
    Private ReadOnly oldConfig As String = AppDomain.CurrentDomain.GetData("APP_CONFIG_FILE").ToString
    Private disposedValue As Boolean
    Public Sub New(ByVal path As String)
      AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", path)
      ResetConfigMechanism()
    End Sub
    Public Overrides Sub Dispose()
      If (Not disposedValue) Then
        AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", oldConfig)
        ResetConfigMechanism()
        disposedValue = True
      End If
      GC.SuppressFinalize(Me)
    End Sub
    Private Shared Sub ResetConfigMechanism()

      GetType(ConfigurationManager).GetField("s_initState", BindingFlags.NonPublic Or BindingFlags.Static).SetValue(Nothing, 0)
      GetType(ConfigurationManager).GetField("s_configSystem", BindingFlags.NonPublic Or BindingFlags.Static).SetValue(Nothing, Nothing)
      Dim assemblies() As Type = GetType(ConfigurationManager).Assembly.GetTypes()
      For Each assembly As Type In assemblies
        If (assembly.FullName = "System.Configuration.ClientConfigPaths") Then
          assembly.GetField("s_current", BindingFlags.NonPublic Or BindingFlags.Static).SetValue(Nothing, Nothing)
          Exit For
        End If
      Next
    End Sub
  End Class
End Class 
```

我在程序开始时调用 Change 函数

```
AppConfig.Change(Application.StartupPath & "\app.exe.Config") 
```

这样它需要正确的配置文件

# javascript - 使用数组值作为变量名

> ID：13516234
> 
> 赞同：1
> 
> 时间：2012-11-22T15:52:09.163
> 
> 标签：javascript, jquery

我需要使用 jQuery 的 keyup 函数从输入的 html 表单元素中获取值，并在其他地方的 div 中显示所述值。

工作代码如下所示：

```
$('#name').keyup(function() {
    var name = $(this).val();
    $('#name-in-document').html(name);
}); 
```

由于我有许多相同的上述代码块实例，我想使用一个 for 循环来循环一个值数组。catch 是第二行中变量的名称

```
var name = $(this).val(); 
```

将来自数组。

我尝试了以下循环，但它不起作用，因为（据我了解）Javascript 变量不能命名为数组值：

```
var inputsArray = ["phone", "name", "address"];

for (var i = 0; i < inputsArray.length; i++) {

    $("#"+inputsArray[i]).keyup(function() {

    var inputsArray[i] = $(this).val();
    $("#"+inputsArray[i]+"-in-document").html(inputsArray[i]);

    }) 
```

};

所以我有两个问题：

1.  我不能使用数组值在 for 循环中创建变量是真的吗？
2.  是否有另一种方法来完成可能有效的相同事情（从数组中获取变量名）？

我刚刚开始使用 JavaScript，非常感谢任何见解。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:57:51.180

**1.**这不是真的
**2.**您需要对变量`i`或`inputArray[i]`事件绑定中的值进行闭包，关键字`this`指的是 DOMNode 女巫触发事件：

[在这里阅读更多关于闭包的[内容 JavaScript 闭包是如何工作的？](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)]

```
var inputsArray = ["phone", "name", "address"],
    i = 0,
    len = inputsArray.length;

for ( ; i < len; i ++ ) {
    makeKeyupBind(inputsArray[i]);
} 

function makeKeyupBind( value ) {
    $("#" + value).on("keyup", function() {
        $("#" + value + "-in-document").html( this.value );
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T15:57:14.353

该变量仅存在于作为`keyup`事件回调传递的函数范围内，因此我真的不认为需要给它一个动态名称；你完全可以称它为任何东西，而不会遇到冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T15:56:15.457

试试这个：

```
var inputsArray = ["phone", "name", "address"];

for (var i = 0; i < inputsArray.length; i++) {

    $("#"+inputsArray[i]).keyup(function() {

    var valuesArray[i] = $(this).val();
    $("#"+inputsArray[i]+"-in-document").html(valuesArray[i]);

    }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T15:57:17.280

```
 var inputsArray = ["phone", "name", "address"]; 
 for (var i = 0; i < inputsArray.length; i++) {
   $("#"+inputsArray[i]).keyup(function() {

   var htmlValue = $(this).val();
   $("#"+inputsArray[i]+"-in-document").html(htmlValue);
}) 
```

我认为您不需要从数组中命名变量，对吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T16:00:41.463

您可以直接从数组构建选择器并完全跳过循环。使用当前输入的 id 为其他元素创建选择器

```
var inputsArray = ["phone", "name", "address"];

$('#'+ inputsArray.join(',#') ).keyup(){
   $('#'+this.id+"-in-document").html(  $(this).val() );
}) 
```

这将创建选择器：

```
$('#phone,#name,#address') 
```

以上假设您正在尝试查找元素：

```
 $("#phone-in-document").html(val);
   $("#name-in-document").html(val);/* etc*/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-22T16:08:27.223

对于替代方法，我建议给`#name`（和他的朋友）一个类名，例如

```
<input class="js-key-up" id="name" /> 
```

然后你可以完全取消数组和`for`循环。此外，添加新的 HTML 元素不需要将项目添加到数组中。

**HTML**

```
<input class="js-key-up" id="phone">
<input class="js-key-up" id="name">
<input class="js-key-up" id="address">

<p id="phone-in-document"></p>
<p id="name-in-document"></p>
<p id="address-in-document"></p> 
```

**JavaScript** ​</p>

```
$('.js-key-up').keyup(function (e) {
    var id = $(this).attr('id');
    $('#' + id + '-in-document').html($(this).val());
});​ 
```

我[创建了一个](http://jsfiddle.net/47pZS/)带有代码的jsfiddle。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-22T16:20:32.673

@Wes Cossick：循环内的这条线是错误的：

```
var valuesArray[i] = $(this).val(); 
```

如果你想这样做，在循环之前声明数组。那是OP的问题

@diana：如果我理解你是正确的，你想为数组中的每个项目添加一个动态 keyup 处理程序吗？如果是这种方式，那么该代码应该这样做（不要重新分配数组中的项目！）诀窍是创建一个闭包（代码未经测试）。

```
var inputsArray = ["phone", "name", "address"];

for (var i = 0; i < inputsArray.length; i++) {

  (function(item) {
    $("#"+item).keyup(function() {
      $("#"+item+"-in-document").html($(this).val());
    });
  })(inputsArray[i]);

}; 
```

如果您使用的是 jQuery（而且看起来如此；-），请查看 jQuery 中的 each-function：http: [//api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

这对你来说应该容易得多;-)

# iphone - 推送通知，添加功能

> ID：13516237
> 
> 赞同：0
> 
> 时间：2012-11-22T15:52:25.357
> 
> 标签：iphone, push-notification, apple-push-notifications

我正在尝试添加推送通知，所以当我阅读时，我要做的第一件事就是修改我的 App ID，以便启用推送通知，问题是 APN 证书永远不会生成，屏幕永远不会改变：

![在此处输入图像描述](../Images/3bb28530fa8f861423464190a4a3d49e.png)

需要 CSR 文件有一些特殊信息吗？我没有收到错误或确认

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:59:38.123

我想你会发现这是一个出现在某些浏览器中的错误。我曾一度遇到同样的问题。如果您还没有使用 Safari，请尝试使用 Safari，否则请尝试使用其他浏览器，例如 Firefox 或 Chrome。如果您有时间，请向 Apple 提交错误报告。

# php - $_POST 中的语法

> ID：13516238
> 
> 赞同：1
> 
> 时间：2012-11-22T15:52:28.133
> 
> 标签：php, html, variables, post, checkbox

我有这个代码行：

```
<input  lass="validate[minCheckbox[1]] checkbox" name="samplecheckbox <?=$row_Answer['QuestionIDFK']; ?> []"  id="samplecheckbox <? = $row_Answer['QuestionIDFK']?>[]" value="<?= $row_Answer['AnswerIDPK']; ?>" type="checkbox" /> 
```

复选框的名称类似于`samplechecbox14[],samplechebox21[]`

在 a 中调用这个元素的正确 php 语法是`$_POST`什么？. 我正在尝试：

```
foreach(... as $QuestionIDFK){

        foreach($_POST['samplecheckbox.$QuestionIDFK.'] as $valueID){
                // Intert on tables
}} 
```

或者

```
 foreach(... as $QuestionIDFK){

        foreach($_POST['samplecheckbox<?= $row_Answer['QuestionIDFK']?>'] as $valueID){
                // Intert on tables
}} 
```

但不起作用。我需要以这种方式称呼它，我知道其他方式，但我使用它是因为我需要每个问题的通用名称（以及每个问题的多个答案）。那么我应该在 POST 里面写什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T15:55:55.617

```
 foreach($_POST['samplecheckbox' . $QuestionIDFK] as $valueID){ 
```

假设它`$QuestionIDFK`包含`$row_Answer['QuestionIDFK']`您在构建表单时使用的值。

# grails - 仅针对测试数据覆盖 Grails dateCreated 和 lastUpdated？

> ID：13516251
> 
> 赞同：8
> 
> 时间：2012-11-22T15:53:06.823
> 
> 标签：grails, groovy, grails-orm, grails-2.0, grails-domain-class

我有几个 Grails 2.1 域类，其中包括GORM 自动管理`dateCreated`的`lastUpdated`字段，例如：

```
class Person {
    Date dateCreated
    Date lastUpdated
    String name
} 
```

我*希望*Grails 在运行时自动填写这些字段，但我*还想*创建一些测试数据，我可以在其中手动定义这些日期的值。问题是如果这些字段带有拦截器，即使我专门设置了它们，Grails 也会自动设置这些值。

我已经看到[了这个 SO question](https://stackoverflow.com/questions/5733448/overriding-datecreated-for-testing-in-grails)，它描述了如何允许更改`dateCreated`，但我也需要更改`lastUpdated`。这可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-22T17:08:21.580

哎呀，我的错误，另一个问题中的方法确实有效，但是有问题的实体被单独保存在其他地方。似乎您还需要明确`flush`的才能使事情正常进行：

```
def withAutoTimestampSuppression(entity, closure) {
    toggleAutoTimestamp(entity, false)
    def result = closure()
    toggleAutoTimestamp(entity, true)
    result
}

def toggleAutoTimestamp(target, enabled) {
    def applicationContext = (ServletContextHolder.getServletContext()                                                           
                              .getAttribute(ApplicationAttributes.APPLICATION_CONTEXT))

    def closureInterceptor = applicationContext.getBean("eventTriggeringInterceptor")
    def datastore = closureInterceptor.datastores.values().iterator().next()
    def interceptor = datastore.getEventTriggeringInterceptor()

    def listener = interceptor.findEventListener(target)
    listener.shouldTimestamp = enabled
    null
}

def createTestPerson() {

    def luke = new Person(name: "Luke Skywalker")
    withAutoTimestampSuppression(luke) {

        def lastWeek = new Date().minus(7)
        luke.dateCreated = lastWeek
        luke.lastUpdated = lastWeek
        luke.save(failOnError: true, flush: true)
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-22T21:53:49.797

如果是集成测试，可以使用 hql update 语句手动设置 lastUpdated。

# ruby-on-rails - 带有 find_by 的“ArgumentError 异常：未知键”

> ID：13516253
> 
> 赞同：1
> 
> 时间：2012-11-22T15:53:11.223
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个优惠券系统，我正在尝试`coupon`使用以下方法获取对象`find_by`：

```
Coupon.find_by_coupon(params[:coupon]) 
```

我收到此错误：

```
ArgumentError Exception: Unknown key: coupon 
```

我确定`params[:coupon]`是对的：

```
(rdb:1) eval params[:coupon]
{"coupon"=>"100"} 
```

我有以下模型：

```
# Table name: coupons
#
#  id              :integer         not null, primary key
#  coupon          :string(255)
#  user_id         :integer 
```

* * *

更新：

如果我把`Coupon.find_by_coupon(params[:coupon][:coupon])`而不是`Coupon.find_by_coupon(params[:coupon])`.

在我看来，这是带有表单的代码：

```
<%= semantic_form_for Coupon.new, url: payment_summary_table_offers_path(@booking_request) do |f| %>
    <%= f.input :coupon, :as => :string, :label => false, no_wrapper: true %>
    <%= f.action :submit, :as => :button, :label => t(:button_use_coupon), no_wrapper: true,
    button_html: { value: :reply, :disable_with => t(:text_please_wait) } %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:15:09.087

如果您使用的是 Rails 3，我建议您使用以下方法查找对象：

```
# equivalent of find_all
Coupon.where(:coupon => params[:coupon]) # => Returns an array of Coupons
# equivalent of find :first
Coupon.where(:coupon => params[:coupon]).first # => Returns a Coupon or nil 
```

尝试做一个`params.inspect`看看究竟是如何制作你的哈希的。我认为它是这样构建的：

```
{ :coupon => { :coupon => '100' } } 
```

如果是，您应该使用`params[:coupon][:coupon]`获取字符串 '100'

**根据您的更新：**

`semantic_form_for`正在为您创建表单，当您给他 a`Coupon.new`时，它将以这种方式构建参数：

```
params = {
  :coupon => { :attribute_1 => 'value_1', :attribute_2 => 'value_2' }
} 
```

如果您更喜欢使用 find_by 方法：

```
Coupon.find_by_coupon(params[:coupon][:coupon]) # => Returns a Coupon or raise a RecordNotFound error 
```

或者使用 where 方法：

```
Coupon.where(:coupon => params[:coupon][:coupon]).first # => Returns a Coupon or nil 
```

# java - MyFaces CODI - 添加到项目

> ID：13516255
> 
> 赞同：0
> 
> 时间：2012-11-22T15:53:21.313
> 
> 标签：java, maven, jsf-2, myfaces, codi

我正在开发一个*Maven* JSF Web 应用程序。我想在一些**@ViewScoped bean 上使用****@PreDestroy**，但是这在JSF 2.0 中是不可能的（或者在页面关闭或重定向时不行）我发现MyFaces CODI 的**@ViewAccessScoped**可能是解决方案，但是我在添加它时遇到了问题。当我尝试这个时：

 ****```
<dependency>
    <groupId>org.apache.myfaces.extensions.cdi.bundles</groupId>
    <artifactId>myfaces-extcdi-bundle-jsf20</artifactId>
    <version>1.0.5</version>
</dependency> 
```

它在编译时导致错误。

没有依赖项目运行良好。

我附上错误日志：

```
com.sun.faces.config.ConfigurationException: Factory 'javax.faces.context.FacesContextFactory' was not configured properly.
    at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactoriesExist(FactoryConfigProcessor.java:329)
    at com.sun.faces.config.processor.FactoryConfigProcessor.process(FactoryConfigProcessor.java:235)
    at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:376)
    at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:227)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4779)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5273)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:649)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:530)
    at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1471)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:791)
    at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1436)
    at org.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:856)
    at org.apache.catalina.manager.ManagerServlet.doGet(ManagerServlet.java:353)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: javax.faces.FacesException: org.apache.myfaces.extensions.cdi.jsf2.impl.listener.request.CodiFacesContextFactory
    at javax.faces.FactoryFinder.getImplGivenPreviousImpl(FactoryFinder.java:712)
    at javax.faces.FactoryFinder.getImplementationInstance(FactoryFinder.java:574)
    at javax.faces.FactoryFinder.access$500(FactoryFinder.java:140)
    at javax.faces.FactoryFinder$FactoryManager.getFactory(FactoryFinder.java:1122)
    at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:381)
    at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactoriesExist(FactoryConfigProcessor.java:327)
    ... 46 more
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at javax.faces.FactoryFinder.getImplGivenPreviousImpl(FactoryFinder.java:692)
    ... 51 more
Caused by: java.lang.NoClassDefFoundError: javax/enterprise/context/spi/Contextual
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.getClassDeactivator(ClassDeactivation.java:69)
    at org.apache.myfaces.extensions.cdi.core.impl.util.ClassDeactivation.isClassActivated(ClassDeactivation.java:50)
    at org.apache.myfaces.extensions.cdi.jsf2.impl.listener.request.CodiFacesContextFactory.isActivated(CodiFacesContextFactory.java:138)
    at org.apache.myfaces.extensions.cdi.jsf2.impl.listener.request.CodiFacesContextFactory.<init>(CodiFacesContextFactory.java:46)
    ... 56 more
Caused by: java.lang.ClassNotFoundException: javax.enterprise.context.spi.Contextual
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
    ... 60 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:57:12.760

当我在 JSF 中使用 Spring 时，我正在使用一个巴西框架，该框架使用 myfaces Orchestra 范围作为 Spring 新范围的背景：

*   “SameViewed”-> 就像 @ViewScope (JSF)
*   "AccessScoped" -> 就像 ViewAccessScoped

这是一个非常好的库，我的项目中的范围不再有问题。

抱歉，这是葡萄牙语，但如果显示了信任，我可以翻译或帮助您开始... 葡萄牙语教程的链接：

[http://lindbergframework.blogspot.com/2012/02/como-manter-o-estado-de-um-managedbean.html](http://lindbergframework.blogspot.com/2012/02/como-manter-o-estado-de-um-managedbean.html)

希望这可以帮助！！:)****

# mysql - 如何从 mysql 表中选择最后但 10 行

> ID：13516260
> 
> 赞同：2
> 
> 时间：2012-11-22T15:53:32.950
> 
> 标签：mysql, syntax, row, limit

我想运行这个查询

```
select *
from  table
order asc
limit N; 
```

其中 N 是总行数减去 10。

```
SELECT COUNT(*) FROM (SELECT * FROM table) 
```

返回总数为 189 所以，在这种情况下，我希望我的限制为 179

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:25:48.620

如果顺序不重要，您可以使用以下偏移量`limit`：

请注意，“直到表格结束”没有实际值。[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/select.html)建议对第二个参数使用“一些大数字”。

```
SELECT *
FROM table1
order by ID DESC
LIMIT 10, 999999999999999 
```

如果您确实希望按升序排列，则可以在之后应用不同的排序：

```
SELECT 
  * 
FROM
  (SELECT *
  FROM table1
  ORDER BY ID DESC
  LIMIT 10, 999999999999999) x
ORDER BY
  ID ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:20:43.710

不确定是否最有效，但如果您只有一个字段作为主键，这应该可以工作。

```
select *
from T1
where
    T1.id not in (
        select top(10) id
        from T1
        order by id desc
    )
order by
    id; 
```

它将按您的订单获取最后一行，然后您可以按键排除。

**编辑：**

更好的是，您可以使用左外连接，而不是 not in。

```
select 
    T1.*
from T1
left outer join ( select top(10) id from Enums_Tables order by id desc ) as T2
on
    T1.id = T2.id
where
    T2.id is null; 
```

# javascript - Searching MongoDB when everything is variable

> ID：13516263
> 
> 赞同：2
> 
> 时间：2012-11-22T15:53:36.963
> 
> 标签：javascript, node.js, mongodb

I am trying to use node.js to provide json results from MongoDB.

```
var http = require('http');
var mongo = require('mongoskin');

http.createServer(function (req, res) {
  var args = req.url.split("/");
  console.log(args);
  var searchCollection = args[1];
  var searchVar = args[2];
  var searchString = args[3];
  var conn = mongo.db('user:pass@alex.mongohq.com:10039/name',{safe:true});
  conn.collection(searchCollection).find({searchVar:searchString}).toArray(function(err, items){
    if(err) throw err;
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end(JSON.stringify(items));
  });
}).listen(process.env.PORT, process.env.IP); 
```

The problem I am having is when I call the find function on the database it:-

*   searches for a document with a variable 'searchVar'
*   rather than searching for a variable with the value of the searchVar

Any help would be appreciated. Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:04:25.367

You will need to create your query object something like this:

```
var query = {};
query[searchVar] = searchString; 
```

And then pass this into your query:

```
 conn.collection(searchCollection).find(query).toArray(function(err, items){
    if(err) throw err;
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end(JSON.stringify(items));
  }); 
```

# c# - 子类可以实现与其父类相同的接口吗？

> ID：13516264
> 
> 赞同：17
> 
> 时间：2012-11-22T15:53:38.107
> 
> 标签：c#, oop, interface, implementation

我在今天之前从未遇到过这个问题，并且想知道完成这种行为的约定/最佳实践是什么。

基本设置是这样的：

```
public interface IDispatch {
    void Dispatch();
}

public class Foo : IDispatch {
    void IDispatch.Dispatch() {
        DoSomething();
    }
}

public class Bar : Foo {
     ...
} 
```

Bar 需要继承 Foo 的子类，因为它与 Bar 共享所有相同的属性，并且引入了我需要遇到的 2 个新属性。我遇到的问题是 Foo 还需要稍微不同的 Dispatch() 实现。通常它会被覆盖，但这对于接口方法无效，所以让 Bar 实现 IDispatch 也可以，所以我的类定义如下所示：

```
public class Bar : Foo, IDispatch { .... } 
```

然后在 Bar 中也对该接口方法进行显式实现？当我尝试这样做时，我的编译器似乎没有抱怨，但我不确定它是否会导致任何运行时问题解决在路上使用哪个实现，或者是否有更好的方法来完成这样的事情。

另外值得一提的是，在我的工作场所，我们使用 UML 模型生成代码，这强制所有类设计必须首先从模型完成。代码生成工具是导致显式实现接口方法的原因（不想争论这个的利弊，这正是我现在被迫处理的，所以不能选择隐式实现）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-22T16:00:04.110

或者，您可以通过以下两种方式之一执行此操作：

首先，不要显式实现接口：

```
public class Foo : IDispatch {
    public virtual void Dispatch() {
        whatever();
    }
}

public class Bar : Foo {
    public override void Dispatch() {
        whateverElse();
    }
} 
```

其次，显式实现它，但添加一个子类可以覆盖的函数：

```
public class Foo : IDispatch {
    void IDispatch.Dispatch() {
        this.Dispatch();
    }

    protected virtual void Dispatch() {
        whatever();
    }
}

public class Bar : Foo {
    protected override void Dispatch() {
        whateverElse();
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-22T15:59:15.050

是的，你可以明确地重新声明你想要实现`IDispatch`，然后在`Bar`.

**但是**，您将无法在`Foo`. 如果您需要这样做，您需要更改`Foo`为使用带有虚拟方法的隐式接口实现（可以覆盖然后用`base.Dispatch()`in调用`Bar`），或者使`Foo`实现调用一个受保护的虚拟方法，您将再次覆盖 in `Bar`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-22T16:01:17.050

如果 Bar 是 Foo 的子类，它已经实现了 IDispatch，无需明确说明。如果您只想以不同的方式实现一种接口方法，请执行以下操作：

```
IDispatch { void Method(); }
Foo : IDispatch { public virtual void Method() { implementation1 } }
Bar : Foo { public override void Method() { implementation2 } } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-22T16:00:27.843

您不必这样做`IDispatch.Dispatch`- 只要`Dispatch`在您的类中调用了一个方法，您就已经实现了该接口。

你可以这样做，它为我构建：

```
 public class Foo : IDispatch
  {
    public virtual void Dispatch()
    {
    }
  }
  public class Bar : Foo
  {
    public override void Dispatch()
    {
      base.Dispatch();
    }
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-17T16:54:42.473

我更喜欢显式实现接口。不熟悉您的代码库的人更容易理解什么是接口与特定于类的逻辑。

您仍然可以在显式实现接口的同时完成类继承。您只需要让基类实现接口，并将该实现调用到可以扩展的虚函数中。这是一个例子：

```
interface Inter
{
    void Call();
}

class A : Inter
{
    //Explicitly implemented interface
    void Inter.Call()
    {
        this.Call();
    }

    public virtual void Call() { Console.WriteLine("Base call in A"); }
}

class B : A
{
    public override void Call()
    {
        Console.WriteLine( "Called B" );
    }
}

class Program
{
    static void Main( string[] args )
    {
        var a = new A();   //Base class
        var aa = (Inter)a; //Interface only
        a.Call();
        aa.Call();

        var b = new B();   //Child class
        var bb = (Inter)b; //Interface only of Child class
        b.Call();
        bb.Call();

        //See the output before the console program closes
        Console.ReadLine();         
    }
} 
```

程序输出：

```
Base call in A
Base call in A
Called B
Called B 
```

# php - 将主页和站点 url 映射到 SERVER_NAME 的安全问题

> ID：13516266
> 
> 赞同：0
> 
> 时间：2012-11-22T15:53:43.843
> 
> 标签：php, wordpress, security

当我在开发、测试和生产环境中工作时，我正在研究不同的方法以允许 Wordpress 在没有额外配置的情况下工作。一种可能的解决方案是简单地将 WP_SITEURL 和 WP_HOME 常量设置为 wp-config.php 文件中的 SERVER_NAME 值，如[其他地方所述](https://stackoverflow.com/questions/12754209/make-wordpress-available-from-any-domain)：

```
$domain = sprintf('%s://%s', 
    $_SERVER['SERVER_PORT'] == 80 ? 'http' : 'https', 
    $_SERVER['SERVER_NAME']);
define('WP_SITEURL',       $domain);
define('WP_HOME',          $domain); 
```

这会导致任何安全漏洞吗？

谢谢！

# javascript - 谷歌图表仪表板 - 隐藏列

> ID：13516267
> 
> 赞同：14
> 
> 时间：2012-11-22T15:53:46.497
> 
> 标签：javascript, google-visualization

我使用谷歌图表仪表板来显示折线图，我想在运行时控制显示的元素。例如：

```
function drawVisualization() {
// Create and populate the data table.
var data = google.visualization.arrayToDataTable([
    ['x', 'Cats', 'Blanket 1', 'Blanket 2'],
    ['A',   1,       1,           0.5     ],
    ['B',   2,       0.5,         1       ],
    ['C',   4,       1,           0.5     ],
    ['D',   8,       0.5,         1       ],
    ['E',   7,       1,           0.5     ],
    ['F',   7,       0.5,         1       ],
    ['G',   8,       1,           0.5     ],
    ['H',   4,       0.5,         1       ],
    ['I',   2,       1,           0.5     ],
    ['J',   3.5,     0.5,         1       ],
    ['K',   3,       1,           0.5     ],
    ['L',   3.5,     0.5,         1       ],
    ['M',   1,       1,           0.5     ],
    ['N',   1,       0.5,         1       ]
]);

// Create and draw the visualization.
new google.visualization.LineChart(document.getElementById('visualization')).
  draw(data, {curveType: "function",
              width: 500, height: 400,
              vAxis: {maxValue: 10}}
      );
} 
```

我想控制 的可见性`Cats`，`Blanket 1`并`Blanket 2`以类似于[此 Google Charts 类别过滤器示例](http://jsfiddle.net/fcqeA/1/)的方式进行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-02-18T07:08:28.520

一种方法是使用标志值映射到 Cats / Blanket 1 / Blanket 2，然后使用适当的数据初始化相应地调用函数。

```
google.charts.load('current', {packages: ['corechart']});

function drawVisualization(flag) {
    if(flag=="cats")
      var data = google.visualization.arrayToDataTable([
        ['x', 'Cats' ],
        ['A',   1 ],
        ['B',   2 ],
        ['C',   4 ],
        ['D',   8 ],
        ['E',   7 ],
        ['F',   7 ],
        ['G',   8 ],
        ['H',   4 ],
        ['I',   2 ],
        ['J',   3.5 ],
        ['K',   3 ],
        ['L',   3.5 ],
        ['M',   1 ],
        ['N',   1 ]
      ]);

    else if (flag=="Blanket 1")
      var data = google.visualization.arrayToDataTable([
        ['x', 'Blanket 1'],
        ['A',  1],
        ['B',  0.5],
        ['C',  1],
        ['D',  0.5],
        ['E',  1],
        ['F',  0.5],
        ['G',  1],
        ['H',  0.5],
        ['I',  1],
        ['J', 0.5],
        ['K',  1],
        ['L',  0.5],
        ['M', 1 ],
        ['N',  0.5 ]
      ]);

    else if(flag=="Blanket 2")
      var data = google.visualization.arrayToDataTable([
        ['x', 'Blanket 2'],
        ['A',  0.5],
        ['B',  1],
        ['C', 0.5],
        ['D',  1],
        ['E', 0.5],
        ['F',  1],
        ['G', 0.5],
        ['H', 1],
        ['I', 0.5],
        ['J', 1],
        ['K', 0.5],
        ['L', 1],
        ['M', 0.5],
        ['N', 1]
      ]);

    else
      var data = google.visualization.arrayToDataTable([
        ['x', 'Cats', 'Blanket 1', 'Blanket 2'],
        ['A',   1,       1,           0.5],
        ['B',   2,       0.5,         1],
        ['C',   4,       1,           0.5],
        ['D',   8,       0.5,         1],
        ['E',   7,       1,           0.5],
        ['F',   7,       0.5,         1],
        ['G',   8,       1,           0.5],
        ['H',   4,       0.5,         1],
        ['I',   2,       1,           0.5],
        ['J',   3.5,     0.5,         1],
        ['K',   3,       1,           0.5],
        ['L',   3.5,     0.5,         1],
        ['M',   1,       1,           0.5],
        ['N',   1,       0.5,         1]
      ]);

    new google.visualization.LineChart(document.getElementById('visualization')).
      draw(data, {curveType: "function",
                  width: 500, height: 400,
                  vAxis: {maxValue: 10}}
          );
}
```

```
<script src="https://www.gstatic.com/charts/loader.js"></script>
 <div class="btn-group" role="group" aria-label="..."> 
     <button type="button" class="btn btn-default" onclick="drawVisualization('Cats')">Cats</button>  
     <button type="button" class="btn btn-default" onclick="drawVisualization('Blanket 1')">Blanket 1</button>
     <button type="button" class="btn btn-default" onclick="drawVisualization('Blanket 2')">Blanket 2</button>
</div>

<div id="visualization"></div>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-24T13:40:15.847

我建议使用[DataView](https://developers.google.com/chart/interactive/docs/reference#DataView)来隐藏列...

```
google.charts.load('current', {
  packages: ['corechart'],
  callback: drawVisualization
});

function drawVisualization(category) {
  var data = google.visualization.arrayToDataTable([
    ['x', 'Cats', 'Blanket 1', 'Blanket 2'],
    ['A',   1,       1,           0.5],
    ['B',   2,       0.5,         1],
    ['C',   4,       1,           0.5],
    ['D',   8,       0.5,         1],
    ['E',   7,       1,           0.5],
    ['F',   7,       0.5,         1],
    ['G',   8,       1,           0.5],
    ['H',   4,       0.5,         1],
    ['I',   2,       1,           0.5],
    ['J',   3.5,     0.5,         1],
    ['K',   3,       1,           0.5],
    ['L',   3.5,     0.5,         1],
    ['M',   1,       1,           0.5],
    ['N',   1,       0.5,         1]
  ]);

  var chart = new google.visualization.LineChart(document.getElementById('visualization'));
  var options = {
    curveType: 'function',
    width: 500,
    height: 400,
    vAxis: {
      maxValue: 10
    }
  };

  var view = new google.visualization.DataView(data);
  var viewColumns = [0];

  switch (category) {
    case 'Cats':
      viewColumns.push(1);
      break;

    case 'Blanket 1':
      viewColumns.push(2);
      break;

    case 'Blanket 2':
      viewColumns.push(3);
      break;

    default:
      viewColumns.push(1);
      viewColumns.push(2);
      viewColumns.push(3);
  }

  view.setColumns(viewColumns);
  chart.draw(view, options);
}
```

```
<script src="https://www.gstatic.com/charts/loader.js"></script>
<div id="btn-group">
  <button type="button" class="btn btn-default" onclick="drawVisualization()">All</button>
  <button type="button" class="btn btn-default" onclick="drawVisualization('Cats')">Cats</button>
  <button type="button" class="btn btn-default" onclick="drawVisualization('Blanket 1')">Blanket 1</button>
  <button type="button" class="btn btn-default" onclick="drawVisualization('Blanket 2')">Blanket 2</button>
</div>
<div id="visualization"></div>
```

# session - PHP会话未注册

> ID：13516268
> 
> 赞同：1
> 
> 时间：2012-11-22T15:53:54.317
> 
> 标签：session, php

> **可能重复：**
> [使用全局变量作为数据源的 PHP 会话副作用警告](https://stackoverflow.com/questions/175091/php-session-side-effect-warning-with-global-variables-as-a-source-of-data)

我使用的登录脚本有问题。问题是一些托管服务提供商在登录后会话未注册。在 php 错误日志中我可以看到这个错误

> PHP 警告：未知：您的脚本可能依赖于在 PHP 4.2.3 之前存在的会话副作用。请注意，除非启用了 register_globals，否则会话扩展不会将全局变量视为数据源。您可以通过分别在第 0 行的未知中将 session.bug_compat_42 或 session.bug_compat_warn 设置为 off 来禁用此功能和此警告

但是在大多数托管服务中，例如 bluehost、hostmonster，它可以正常工作，没有任何错误。有人可以指出我在这里做错了什么吗？谢谢你。

*代码：*

```
<?
session_start();
ob_start();
?>

        <?php
        $err=isset($_GET['error'])?$_GET['error']:""; 
        if($err=='error'){?>
        <div class="errormsgbox">Wrong Username or Password. Please try again.</div>    
        <?php }

        if(!isset($_SESSION['adminuser'])){
        if($_SERVER["REQUEST_METHOD"] == "POST")
        {
        // username and password sent from Form
        $adminuser=mysql_real_escape_string($_POST['adminuser']); 
        $adminpassword=mysql_real_escape_string($_POST['adminpassword']); 
        $gpassword=md5($adminpassword); // Encrypted Password
        $sql="SELECT id FROM admin WHERE adminuser='$adminuser' and adminpassword='$gpassword'";
        $result=mysql_query($sql);
        $count=mysql_num_rows($result);

        // If result matched $username and $password, table row must be 1 row
        if($count==1)
        {

        session_register("adminuser");

        header("location:index.php");
        }
        else
        {
        header("location:login.php?error=error");

        }
        }
        ob_end_flush();

        ?>
    <form action="login.php" method="post">
    <div class="login_input">
    <label class="loginlbl"  for="adminuser">UserName :</label>
    <input type="text" name="adminuser"/>
    </div>
    <div class="login_input">
    <label class="loginlbl"  for="adminpassword">Password :</label>
    <input type="password" name="adminpassword"/>
    </div>
    <div class="login_submit">
    <input type="submit" id="submit" value=" Login to Admin Contol Panel"/>
    </div>
    </form>
    <?php }else{
    header("location:index.php");
    }
    ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:55:22.567

尝试替换`<?`为`<?php`- 它可能是您的主机禁用了所谓的短标签，因此该部分永远不会执行。从不使用短标签基本上是一个好习惯

**编辑**

您可以通过添加以下内容来禁用此警告：

```
ini_set('session.bug_compat_warn', 0);
ini_set('session.bug_compat_42', 0); 
```

或修复您的代码以不使用相同名称的脚本变量和会话密钥，即这将触发此警告：

```
$_SESSION['foo'] = false;
$foo = 0; 
```

PHP4 时代的遗产...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T15:59:47.510

[如PHP:SESSION_REGISTER](http://php.net/session_register)`session_register`中所述，不推荐使用

你应该使用：

```
//session_register("adminuser"); //deprecated
$_SESSION["adminuser"] = $adminuser; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-22T16:00:04.880

手册[`session_register`](http://php.net/manual/en/function.session-register.php)：

> 自 PHP 5.3.0 起，该函数已被弃用，自 PHP 5.4.0 起已移除。

就像使用`$_SESSION['adminuser']`任何其他变量一样使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T16:01:38.780

问题是您有一个与普通变量同名的变量。

```
$_SESSION['yourvar'] = null;
$yourvar = 'something'; 
```

[使用全局变量作为数据源的 PHP 会话副作用警告](https://stackoverflow.com/questions/175091/php-session-side-effect-warning-with-global-variables-as-a-source-of-data)

**和：**

**session_register**已被弃用`$_SESSION['yourvar']`。功能会话寄存器导致错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T16:00:16.747

不是答案，而是不适合评论的警告：

您正在向后进行密码处理。你在逃跑，然后是 md5-ing。这是不正确的。考虑一个简单的密码：

```
o'brien 
```

逃到

```
o\'brien 
```

然后md5'd。该反斜杠将成为哈希值的一部分：

```
o'brien -> 255740509ca6c0e7d86c88fc4d8ddf9d
o\'brien -> afd5c6601a6df7e48d0ce5584b10bf12 
```

请注意，哈希值完全不同。如果您在其他地方比较散列值并忘记转义阶段，这可能会反过来咬您。

# asp.net - Treeview Website.sitemap 获取选定节点

> ID：13516270
> 
> 赞同：1
> 
> 时间：2012-11-22T15:53:59.377
> 
> 标签：asp.net, vb.net, treeview, sitemapprovider, web.sitemap

我希望能够将树视图与 asp.net 中的站点地图数据提供程序绑定，并且当用户单击节点时，它不会导航到该页面，而是更新文本框。

我不确定这是否可能并且正在努力寻找有关如何实现这一目标的任何建议。

我也使用 VB.Net 作为编码语言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T00:57:40.560

这必须使用 JavaScript 来完成。使用一个函数来阻止每个节点上的默认单击操作，并将树中的值放入文本框中。

例如使用 JQuery...

```
$(".nodes").click(function(event) {
    event.preventDefault();

    $("#<%= TextBox.ClientID").text($(this).text());
}); 
```

# python - 取代用户在python 3.0中输入字符串后需要回车

> ID：13516272
> 
> 赞同：3
> 
> 时间：2012-11-22T15:54:05.277
> 
> 标签：python, input

我一直在尝试在 python 3.0 中创建一个简单的 Rock, Paper, Scissors 游戏——对于任何学习编程的人来说都是非常标准的任务。

但是，当我完成一个点时，我想，“哇，那太棒了”，或者“这样做会很酷！” 所以无论如何，我继续在这个项目上建立......

我开发了一个菜单，一个单人游戏与电脑游戏，刚刚完成了多人游戏。但是，我意识到，多人游戏并不是很有效。它只是不像游戏的模拟版本那样工作。

目前，它会询问 player1 的输入，然后是 player2 的输入，比较它们，然后输出结果和当前分数。我宁愿发生的是程序同时要求两个玩家输入，并且两个玩家同时输入他们的选择。

我知道我可以很容易地做到这一点，只需抓住第一个和第二个答案的索引并比较两个输入 - 很容易。但我宁愿发生的是，在两个玩家同时输入他们的一个角色答案后（r 代表石头，p 代表纸，或 s 代表剪刀），然后程序将自动输入输入。不需要有人按回车。

输入将由已输入 2 个字符的事实决定。

我想我的问题是：有没有办法规定什么可以用作“输入”的输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:25:19.783

我想你正在寻找类似的东西[`msvcrt.getch()`](http://docs.python.org/3/library/msvcrt.html)。

如果你只需要 Windows，这很简单：

```
from msvcrt import getch
letter1 = getch()
letter2 = getch()        
print("Pressed", letter1, "and", letter2) 
```

对于 Linux，它有点复杂：

```
import sys, tty, termios
def getch():
    fd = sys.stdin.fileno()
    old_settings = termios.tcgetattr(fd)
    try:
        tty.setraw(sys.stdin.fileno())
        ch = sys.stdin.read(1)
    finally:
        termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
    return ch

letter1 = getch()
letter2 = getch()        
print("Pressed", letter1, "and", letter2) 
```

请注意，他们不会回应按下的字母。如果两个玩家都在同一台计算机上，这实际上可能对这个游戏有益，但您总是可以在收到值后手动打印它。

对于使用多态性来选择正确版本的跨平台解决方案，请查看以下配方：

[http://code.activestate.com/recipes/134892/](http://code.activestate.com/recipes/134892/)

# spring - 为什么“web mvc 安装语言”不可用？

> ID：13516274
> 
> 赞同：0
> 
> 时间：2012-11-22T15:54:09.940
> 
> 标签：spring, spring-mvc, spring-roo

我尝试使用 roo shell 命令为我的 ROO 项目添加德语支持

> `web mvc install language --code de`

出现以下消息。

> 找到命令“web mvc install language --code de”，但当前不可用（输入“帮助”，然后按 ENTER 了解此命令）

我知道该命令没有任何问题，但是存在一些不满意的依赖关系或其他问题。请帮忙，我一直在寻找网络，但没有找到明确的答案。必须满足哪些先决条件才能使其发挥作用？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:29:30.083

您需要先运行一些命令，您是否运行过这个：

```
web mvc setup 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T12:24:30.680

它不是一个答案。只是一个小建议。Roo 这样做了，有时它说该命令已找到，但当前不可用（我在执行 jpa setup 命令时得到了那个）。它没有给出必要的解释。

在这些情况下，

1.  你应该看看你当前的 roo 焦点。检查您是否确实在正确的位置执行该命令。

2.  尝试通过执行“执行清理”来清理项目。

3.  检查 log.roo，查看之前的任何命令都失败了。

4.  在极端情况下（当你的头像我的一样快要爆炸时；））复制 log.roo 的正确部分，然后完全删除项目，然后执行 log.roo 的正确部分。

希望有帮助。

# php - 无法通过composer安装phpmd

> ID：13516283
> 
> 赞同：1
> 
> 时间：2012-11-22T15:54:36.243
> 
> 标签：php, jenkins, composer-php, phpmd

我的 composer.json 文件中有这个：

```
"require": {
    "phpmd/phpmd:": "1.4.0"
} 
```

当我做：

```
php composer.phar update 
```

我得到：

问题 1 - 找不到请求的包 phpmd/phpmd: 1.4.0。

在文档中，他们说它可以通过我使用的行通过composer安装 - “phpmd/phpmd：”：“1.4.0”。

但它不起作用。

[http://phpmd.org/download/index.html](http://phpmd.org/download/index.html)

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:58:35.050

该`phpmd/phpmd`包位于 packagist (https://packagist.org/packages/phpmd/phpmd)，这是 composer 搜索包的默认存储库。无法找到 phpmd 听起来像是您的系统处于脱机状态、网络问题或 packagist.org 超时。

/编辑：

我看你有错别字。不要写`phpmd/phpmd:`但是`phpmd/phpmd`（没有尾随的冒号）。

# php - 无法在 if 语句中实现第二个条件

> ID：13516287
> 
> 赞同：0
> 
> 时间：2012-11-22T15:54:42.483
> 
> 标签：php, wordpress

我正在尝试在我的主页上显示一个滑块......这个声明`<?php include (TEMPLATEPATH . '/featured-narrow.php'); ?>` 让我得到一个滑块......

我在我的以下代码中找到了`home.php`：

```
<?php if ( get_post_meta( $postid, 'post_featcontent', true ) == "Yes" ) { ?>
                <?php include (TEMPLATEPATH . '/featured-vids.php'); ?>
            <?php } ? 
```

我很确定如果我改变这个条件，我可以显示一个滑块......

实际上在那个'if'语句中，我需要两个条件：a）检查主页和b）它满足'post_featcontent'的值等于“窄宽度特色内容滑块”的条件......

我尝试如下：

```
if ( is_front_page() && get_post_meta( $postid, 'post_featcontent', true ) == "Narrow Width Featured Content Slider" ) 
```

我能够通过 a) 取得成功，但无法达到 b) 的条件（顺便说一句，这是一个 WordPress ..，但我觉得这只是一个 PHP 怀疑..）

有人可以帮忙吗..？

**编辑：**

```
$meta_boxes = array(

        "layout" => array(
            "name" => "layout",
            "type" => "select",
            "title" => __("Page Layout", "solostream"),
            "description" => __("Select a layout for this page/post.", "solostream"),

        "post_featcontent" => array(
            "name" => "post_featcontent",
            "type" => "select",
            "title" => __("Add Featured Articles/Posts to This Post", "solostream"),
            "description" => __("If you'd like to add featured articles/posts to the top of this post, make your selection below.", "solostream"),
            "options" => array(
                    "No", 
                    "Full Width Featured Content Slider", 
                    "Narrow Width Featured Content Slider")),

); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-22T16:56:48.127

更改您的 if 语句以包含另一组括号

```
if ( (is_front_page()) && (get_post_meta( $postid, 'post_featcontent', true) == "Narrow Width Featured Content Slider") 
   ){ 
```

本质上，您希望将每个条件分开以满足特定标准，

即： if((this=this) && (this=this))

为了继续，两个条件都需要为真，为此，您将每个条件都用括号括起来，然后用另一组括号封装两者。

# lua - Lua 2nd ed 中的编程说“.. 是正确的关联”

> ID：13516288
> 
> 赞同：4
> 
> 时间：2012-11-22T15:54:45.423
> 
> 标签：lua

我不明白你为什么会提到字符串连接是“右结合”。连接是关联的，所以我看不出 Lua 评估它的顺序有多重要。我错过了什么吗？

例如`a^(b^c) == (a^b)^c`，通常不正确，但确实如此`a..(b..c) == (a..b)..c`。我的意思是假设如果你将 concat 元方法用于一些行为不像连接的东西，那会很重要，但我不明白为什么有人会想要这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:03:40.093

你似乎已经回答了你自己的问题，除了你结束了它，`but I don't see why anyone would want to do that.`

*您*认为对该功能的适当使用并不重要。Lua 是一种*编程语言*。程序员最喜欢的莫过于滥用语言中的一个特性来做一些非预期的事情。

说它是正确的联想只是向读者提供信息。你如何处理这些信息取决于你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-19T19:21:31.103

关于为什么 .. 关联性是 right2left 这里的一些信息[http://lua-users.org/wiki/AssociativityOfConcatenation](http://lua-users.org/wiki/AssociativityOfConcatenation)

它并不能完全解释“速度优化”是什么。我知道他/他们带有连接链接，但这也可以用于从左到右的关联性......

# android - 相对布局检查横幅广告？

> ID：13516289
> 
> 赞同：0
> 
> 时间：2012-11-22T15:54:47.653
> 
> 标签：android, layout, android-relativelayout, ads, banner

我在屏幕底部显示横幅。

这是 XML 代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layoutAdView"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="50dp" 
    android:layout_alignParentBottom="true"
    android:gravity="center_horizontal" >   
</RelativeLayout> 
```

有时我会收到广告请求已完成，但我没有看到横幅。

如何检查相对布局？如果在相对布局中显示了某些东西，那么它应该给我 true else false 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:22:50.970

假设您使用的是 Google Admob SDK，因为您尚未指定您使用的广告服务器软件。

您可以将 AdListener 附加到屏幕上的广告空间，并在添加失败时处理您想要执行的操作。

```
import android.content.Context;
import android.util.Log;
import android.widget.Toast;

import com.google.ads.Ad;
import com.google.ads.AdListener;
import com.google.ads.AdRequest;
import com.google.ads.AdRequest.ErrorCode;

public class AdmobAdListener implements AdListener {

    Context context;
    AdRequest adRequest;

    public AdmobAdListener(Context context, AdRequest adRequest) {
        this.context = context;
        this.adRequest = adRequest;
    }

    /** The log tag. */
    private static final String LOG_TAG = "AdmobAdListener";

    /** Called when an ad is clicked and about to return to the application. */
    public void onDismissScreen(Ad arg0) {
         Log.d(LOG_TAG, "onDismissScreen");
         Toast.makeText(context, "onDismissScreen",
         Toast.LENGTH_SHORT).show();

    }

    /** Called when an ad was not received. */
    public void onFailedToReceiveAd(Ad ad, ErrorCode error) {
        String message = LOG_TAG + " onFailedToReceiveAd (" + error + ")";
        Log.d(LOG_TAG, message);
        Toast.makeText(context, message, Toast.LENGTH_SHORT).show();
        ad.loadAd(adRequest);
    }

    /**
     * Called when an ad is clicked and going to start a new Activity that will
     * leave the application (e.g. breaking out to the Browser or Maps
     * application).
     */
    public void onLeaveApplication(Ad ad) {
         Log.d(LOG_TAG, "onLeaveApplication");
         Toast.makeText(context, "onLeaveApplication", Toast.LENGTH_SHORT).show();
    }

    /**
     * Called when an Activity is created in front of the app (e.g. an
     * interstitial is shown, or an ad is clicked and launches a new Activity).
     */
    public void onPresentScreen(Ad ad) {
         Log.d(LOG_TAG, "onPresentScreen");
         Toast.makeText(context, "onPresentScreen",
         Toast.LENGTH_SHORT).show();
    }

    /** Called when an ad is received. */
    public void onReceiveAd(Ad ad) {
         Log.d(LOG_TAG, "onReceiveAd");
         Toast.makeText(context, "onReceiveAd", Toast.LENGTH_SHORT).show();
    }

} 
```

在布局 XML 文件中使用此标记

```
<com.google.ads.AdView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:id="@+id/adMob"
        ads:adUnitId="abcdefghighlmnop123"
        ads:adSize="BANNER"/> 
```

# installshield - Installshield静默安装日志

> ID：13516291
> 
> 赞同：2
> 
> 时间：2012-11-22T15:54:56.047
> 
> 标签：installshield

我已经从第 3 方（使用 Installshield 制作）获得了静默安装，我需要将其作为我目前正在进行的项目的一部分。

在我将它刻录到 DVD 并尝试安装之前，我已经完成了所有工作。

静默安装模式下的 Installshield 将日志文件写入与 setup.exe 相同的目录。在 DVD 上，这是一个只读文件夹。

我看到我可以使用命令行开关更改日志文件的默认位置，但是有没有办法让它根本不创建一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T01:26:14.203

我遇到了同样的问题。我试过了：

```
Setup.exe /s /f2null 
```

之后我在任何地方都找不到日志文件......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T02:47:45.793

对于 installsheild 构建的每个 setup.exe，您可以使用 f2"logpath" 参数在您自己的脚本中指定日志文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T08:01:32.560

如果第 3 方“setup.exe”自动创建日志 - 最简单的解决方案是将此日志重定向到 %temp% 目录。

# javascript - 是否可以从 WebBrowser 控件内部调用 Windows Phone 代码（即 Launch WebBrowserTask）？

> ID：13516292
> 
> 赞同：0
> 
> 时间：2012-11-22T15:54:56.923
> 
> 标签：javascript, windows-phone-7, xaml, webbrowser-control

我有一些静态网页作为我的 Windows Phone 7 应用程序的一部分。然而，对于指向网络上非本地站点的链接能够启动网络浏览器（即调用`WebBrowserTask`. 此外，鉴于 WebBrowser 控件嵌入在 XAML 页面中，如果我可以（例如通过 javascript）从 WebBrowser 控件中调用页面上的行为，那就太好了。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T12:42:09.573

据我了解，您需要在 WP7 浏览器中启动 JavaScript。有一些安全限制。但最简单的东西效果很好。查看“ **InvokeScript** ”、 WebbrowserControl 上的**IsScriptEnable**和“ **eval** ”

```
public partial class MainPage : PhoneApplicationPage
{
    public MainPage()
    {
        InitializeComponent();

        Wb.Navigated += new EventHandler<System.Windows.Navigation.NavigationEventArgs>(Wb_Navigated);
        MouseLeftButtonDown += new MouseButtonEventHandler(MainPage_MouseLeftButtonDown);

        Wb.NavigateToString("<html><body><form action='http://google.com/'></form></body></html>");
    }

    void Wb_Navigated(object sender, System.Windows.Navigation.NavigationEventArgs e)
    {
        Wb.InvokeScript("eval", "document.forms[0].submit();"); // Throws 80020101
    }

    private void MainPage_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        Wb.InvokeScript("eval", "document.forms[0].submit();"); // Works
    }
} 
```

# javascript - 带有 Javascript 的 ID 不能按需要工作

> ID：13516301
> 
> 赞同：0
> 
> 时间：2012-11-22T15:55:56.163
> 
> 标签：javascript, raphael

在 Raphaeljs 中，它写了这行代码：（仅显示相关部分）

```
......
    sets.id = index;
    grid.hex[poly].click(
      function(e)
    {   
        var id=this.id
..... 
```

它正确设置了 sets[] 的 id，但“this”的 id 是集合内路径的 id，即被点击的路径。我必须有集合的ID。我怎样才能做到这一点？

**编辑：我希望设置“this”，而不是单击的路径。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:19:37.613

绑定函数到`sets`

```
......
    sets.id = index;
    grid.hex[poly].click($.proxy(function(e){
         var id = this.id;
    }, sets);
..... 
```

或者，如果您不使用 jQuery。

```
//https://gist.github.com/978329
if(!Function.prototype.bind) {
   Function.prototype.bind = function(to){
        // Make an array of our arguments, starting from second argument
    var partial = Array.prototype.splice.call(arguments, 1),
        // We'll need the original function.
        fn  = this;
    var bound = function (){
        // Join the already applied arguments to the now called ones (after converting to an array again).
        var args = partial.concat(Array.prototype.splice.call(arguments, 0));
        // If not being called as a constructor
        if (!(this instanceof bound)){
            // return the result of the function called bound to target and partially applied.
            return fn.apply(to, args);
        }
        // If being called as a constructor, apply the function bound to self.
        fn.apply(this, args);
    }
    // Attach the prototype of the function to our newly created function.
    bound.prototype = fn.prototype;
    return bound;

}

grid.hex[poly].click(function(e){
         var id = this.id;
    }.bind(sets)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:06:57.710

你有没有尝试过？：

```
var id = this.parentElement.id 
```

**更新：**

来自[http://raphaeljs.com/](http://raphaeljs.com/)：

> Raphaël ['ræfeɪəl] 使用 SVG W3C Recommendation 和 VML 作为创建图形的基础。**这意味着您创建的每个图形对象也是一个 DOM 对象**，因此您可以附加 JavaScript 事件处理程序或稍后修改它们。

假设`sets`是一个图形对象（因为它包含路径，我假设它是），那么`this`应该有一个`parentElement`可以访问的属性。

如果它不起作用，您也可以尝试访问它：

```
var id = sets.id; 
```

由于关闭，这应该可以工作。

# c# - 使用 C# 的 PostgreSQL 异常

> ID：13516308
> 
> 赞同：0
> 
> 时间：2012-11-22T15:56:28.487
> 
> 标签：c#, sql, database, postgresql, npgsql

我正在尝试通过 C#（不是 asp.net）使用 PostgreSQL `Npqsql`，我创建了一个名称`GenData`为 SQL 的表；

```
CREATE TABLE gendata
(
  empname text NOT NULL,
  pyrll text NOT NULL,
  contracno text,
  expird date,
  dtbrth date,
  plbrth text,
  cid text,
  passport text,
  jndt date,
  postn text,
  dept text,
  hmtwn text,
  familymen numeric,
  contno text,
  CONSTRAINT gendata_pkey PRIMARY KEY (pyrll)
) 
```

我尝试使用以下代码插入表格：

```
String sql = String.Format("INSERT INTO GenData VALUES ({0},{1},{2},'{3}',{4},{5},{6},{7},{8},{9},{10},{11},{12},{13});"
                    ,textBox1.Text
                    ,textBox2.Text
                    ,textBox3.Text
                    ,textBox4.Text
                    ,textBox5.Text
                    ,textBox6.Text
                    ,textBox7.Text
                    ,textBox8.Text
                    ,textBox9.Text
                    ,textBox10.Text
                    ,textBox11.Text
                    ,textBox12.Text
                    ,textBox13.Text
                    ,textBox14.Text); 
```

但我总是得到一个例外，比如： ![在此处输入图像描述](../Images/a7f877b5c6a53fc6c957afe8fb3d7241.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:03:24.130

由于您没有使用 SQL 参数，而是直接将值嵌入到字符串中（这被认为是非常糟糕的做法），因此您应该遵循 SQL 语法。在您的特定情况下，您应该将所有字符串参数包装到`'`.

更好的方法是使用[`SQLParameter`](http://msdn.microsoft.com/ru-ru/library/system.data.sqlclient.sqlparameter.aspx)类来允许 .NET 对输入数据执行所有必要的转换、转义数据以避免 sql 注入等。我对 Npgsql 不太熟悉，但我几乎可以肯定它遵循与其他 .NET 数据库提供程序相同的准则，因此您应该能够以`SQLParameter`相同的方式使用该类。

# javascript - Dojo 折线图上的自定义标记/工具提示

> ID：13516315
> 
> 赞同：5
> 
> 时间：2012-11-22T15:56:52.350
> 
> 标签：javascript, dojo, dojox.charting

我正在使用 Dojo 1.8 创建一个折线图，用于绘制时间序列数据。数据由在 24 个周期内每 5 分钟采集一次的样本组成，最多提供 288 个 (12x24) 数据点。

为了在图表上显示工具提示，我需要在图表上启用标记（dojo 需要这样做）。问题是，默认情况下，dojo 会为每个数据点创建一个标记，这会导致标记过多。理想情况下，我会为最新数据点显示一个标记，并且可能每隔一两个小时显示一个标记。

可以自定义标记的外观，但到目前为止，我还没有找到任何自定义标记出现频率的方法。任何建议都会非常受欢迎。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T20:11:13.190

尝试使用 MarkersOnly 模块：

```
require(["dojox/charting/Chart", "dojox/charting/axis2d/Default", "dojox/charting/plot2d/Lines", "dojox/charting/plot2d/MarkersOnly", "dojox/charting/Series", "dojo/ready"],
function(Chart, Default, Lines, MarkersOnly, Series, ready) {
  ready(function(){
    var chart = new Chart("simplechart");
        chart.addPlot("plot_lines", { type: Lines });
        chart.addPlot("plot_markers", { type: MarkersOnly });
        chart.addAxis("x");
        chart.addAxis("y", {vertical:true});
        chart.addSeries("series_lines", [4, 2, 6, 4, 5, 8, 8, 1, 7, 9]);
        // if you want your markers at data points 6 and 7;
        chart.addSeries("series_markers", [{x:3,y:6}, {x:9,y:7}], { plot: "plot_markers" , stroke: { color: "blue" } });
        chart.render();
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T18:30:18.040

我真的很难处理文档，我只是想通了。 这是一个带有工作示例[的 jsFiddle 。](http://jsfiddle.net/5g5hZ/3/)我使用了 Andy W 的解决方案，并使用我在 DojoToolkit.org 上可以找到的东西来定制标记。

首先，您需要按照 Andy 的说明创建 MarkersOnly 图，然后您可以自定义标记。[您可以在本文档](http://dojotoolkit.org/reference-guide/1.8/dojox/charting.html)中找到所有内容。

```
//found on http://dojotoolkit.org/reference-guide/1.8/dojox/charting.html
//CIRCLE:           "m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",
//SQUARE:           "m-3,-3 l0,6 6,0 0,-6 z",
//DIAMOND:          "m0,-3 l3,3 -3,3 -3,-3 z",
//CROSS:            "m0,-3 l0,6 m-3,-3 l6,0",
//X:                "m-3,-3 l6,6 m0,-6 l-6,6",
//TRIANGLE:         "m-3,3 l3,-6 3,6 z",
//TRIANGLE_INVERTED:"m-3,-3 l3,6 3,-6 z"

var customTheme = new SimpleTheme({
     markers: {
                    DIAMOND: "m0,-3 l3,3 -3,3 -3,-3 z",
                    CROSS:   "m0,-3 l0,6 m-3,-3 l6,0"
                }
            });

var chart = new Chart("chartCustomMarkers",
     {
          title: "Custom Markers Chart",
          titlePos: "top",
          titleFont: "normal normal normal 15pt Arial",
     });
chart.addPlot("default", { type: MarkersOnly })
     .addAxis("x")
     .addAxis("y", { vertical: true })
     .addSeries("Series 1", [1, 2, 2, 3, 4, 5, 5, 7])
     .addSeries("Series 2", [2, 5, 4, 8, 5, 6, 6, 1])
     .setTheme(customTheme)
     .render(); 
```

我的一位同事向我展示了如何自定义 SVG 路径（创建自己的模式）。只是[去这里](http://www.w3schools.com/svg/svg_path.asp)了解更多信息。

# mysql - 从 csv 导入时间/日期，没有秒数

> ID：13516321
> 
> 赞同：0
> 
> 时间：2012-11-22T15:57:13.723
> 
> 标签：mysql

我需要能够从 csv 文件（我无法更改）导入到 mysql 数据库中，日期和时间在`csv = 201210021015`

即`YYYYMMDDHHMM`...但没有秒

当我导入`201111221420`a时，`DATETIME`我会得到奇怪的结果，例如`2020-11-11`.

`TIMESTAMP`格式忽略小时和分钟。

有人可以建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:58:24.393

尝试使用大整数格式，而不是日期格式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:18:37.043

像这样使用`str_to_date()`函数：

像这样的东西应该工作：

```
load data infile 'myfile.csv'
into table xxx 
fields terminated by ',' 
lines terminated by '\n' 
(@col1)
set 
  col1 = str_to_date(@col1, '%Y%m%d%H%i') 
```

# c# - WPF DataGrid - CellEditEnding 事件更新数据

> ID：13516324
> 
> 赞同：1
> 
> 时间：2012-11-22T15:57:29.097
> 
> 标签：c#, .net, wpf, datagrid

我在 WPF 中的 DataGrid 中苦苦挣扎。我有一个绑定到它的 ObservableCollection。当用户进入第一个单元格时，其他单元格将相应更新。为此，我订阅了 CellEditEnding 事件以在第一个单元格更改后强制更新。

在这种情况下，我还会像这样更新 MyClass 的其他属性：

```
 private void DataGridTeilnehmer_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
    {
        if (!commiting)
        {
          commiting = true;
            DataGridTeilnehmer.CommitEdit(DataGridEditingUnit.Row, false);
            commiting = false;

            if (e.Column.DisplayIndex == 0)
            {
                MyClass data = (e.Column.GetCellContent(e.Row) as ContentPresenter).Content as MyClass;
                data.pass = "nothing";
            }
        } 
```

问题是，Grid 不会自行更新，因此不会显示“nothing”，直到我进入绑定到包含“nothing”的属性“pass”的单元格的编辑模式。但我想立即展示它。

提前致谢，
弗兰克

PS：我一生中使用过许多（数据）网格，但 WPF 网格是我迄今为止遇到的最糟糕的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-22T10:04:45.603

正确的方式如下，目前在我的软件中使用这种方式

```
private void MyWPFFrid_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
    {
        if (e.Column.SortMemberPath.Equals("EndDate"))
        {
            if (((MyObject)e.Row.Item).EndDate.Equals(DateTime.MinValue))
            {
                ((MyObject)e.Row.Item).Completed = 1;
                ((MyObject)e.Row.Item).CompletedDescription = "YES";
            }
            else
            {
                ((MyObject)e.Row.Item).Completed = 0;
                ((MyObject)e.Row.Item).CompletedDescription = "NO";
            }

            this.MyWPFFrid.CurrentItem = ((MyObject)e.Row.Item);

            if (!e.Row.IsEditing)
            {
                this.MyWPFFrid.Items.Refresh();
            }

        }
    } 
```

# android - 编写自定义 lint.xml

> ID：13516327
> 
> 赞同：12
> 
> 时间：2012-11-22T15:57:38.533
> 
> 标签：android, reporting, lint

我们的 Android 项目依赖于一些我们无法控制的外部项目。因此，我正在尝试设置自定义 lint.xml 文件，以便我们可以为它们添加忽略规则。作为开始的场景，我试图从 ActionBarSherlock 中删除警告（杰克没有冒犯）

```
<?xml version="1.0" encoding="UTF-8"?>
<lint>
  <issue id="FloatMath">
    <ignore path="app/target/classes/com/actionbarsherlock/*" />
  </issue>
  <issue id="DefaultLocale">
    <ignore path="app/target/classes/com/actionbarsherlock/*" />
  </issue>
  <issue id="ViewConstructor">
    <ignore path="app/target/classes/com/actionbarsherlock/*" />
  </issue>
</lint> 
```

使用以下命令

```
lint app --disable FloatMath,DefaultLocale,ViewConstructor --xml lint-result.xml 
```

然而，生成的报告仍然包含来自 ABS 的消息。

**更新** 我将命令更改为

```
lint --disable FloatMath,DefaultLocale,ViewConstructor --xml lint-result.xml app 
```

无论忽略什么，Jenkins 都不会做任何更改，仍然会产生相同的报告，但是如果在命令行中运行，它会忽略禁用后列出的所有问题。我希望有一种简单的说法，嘿以 Maven 的方式忽略/排除事物......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-09-08T18:17:16.407

现在可以这样做了：

```
<?xml version="1.0" encoding="UTF-8"?>
<lint>
    <issue id="all">
        <ignore regexp="target/classes/com/actionbarsherlock/.*[.]class" />
    </issue>
</lint> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-30T16:17:01.037

再次回答我自己的问题... lint.xml 现在看起来像这样，它将忽略 ASB 4.2.0 上的任何 ActionBarSherlock 报告

```
<?xml version="1.0" encoding="UTF-8"?>
<lint>
  <issue id="NewApi">
    <ignore path="target/classes/com/actionbarsherlock/internal/ActionBarSherlockNative.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/ActionBarSherlockNative$ActionModeWrapper.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarWrapper.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarWrapper$TabWrapper.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/view/ActionProviderWrapper.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/ActionMenuItemView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/MenuItemWrapper.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/ActionMenuPresenter$HasPermanentMenuKey.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsAdapterView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsProgressBar.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ActionBarView$HomeView.class" />
    <ignore path="target/classes/com/actionbarsherlock/widget/SearchView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/widget/NineFrameLayout.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/widget/NineHorizontalScrollView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/widget/NineLinearLayout.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/view/NineViewGroup.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/BaseMenuPresenter.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/AbsActionBarView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ActionBarContextView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ActionBarView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingButton.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingTextView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsAbsSpinner.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsLinearLayout.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsListPopupWindow.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ScrollingTabContainerView.class" />
    <ignore path="target/classes/com/actionbarsherlock/widget/ActivityChooserView$SetActivated.class" />
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockActivity.class" />
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockExpandableListActivity.class" />
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockListActivity.class" />
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockPreferenceActivity.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/ActionBarSherlockNative$ActionModeCallbackWrapper.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarImpl$1.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarImpl.class" />
  </issue>

  <issue id="FloatMath">
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/view/animation/AnimatorProxy.class" />
  </issue>

  <issue id="DefaultLocale">
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingTextView.class" />
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingButton.class" />
  </issue>

  <issue id="ViewConstructor">
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CollapsibleActionViewWrapper.class" />
  </issue>

  <issue id="WrongCall">
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsAdapterView.class" />
  </issue>
</lint> 
```

我们现在使用的Shell执行命令是

```
lint --config lint.xml --xml lint-results.xml .; 
```

PS：请注意，这不会像在这种情况下 ABS 一样删除所有排除的 APKLIB 报告，因为到目前为止还没有办法排除 R.class 未使用资源的报告。在编译过程中，链接库的 R.class 和您的项目确实被合并，而 Lint 无法知道这一点。它只看到带有一些未使用的引用的单个 R.class 并报告它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-25T22:26:27.050

我已完成 lint.xml 文件以排除更多 actionbarsherlock 错误。但是，最好有一个排除包机制。

```
<?xml version="1.0" encoding="UTF-8"?>
<lint>
  <issue id="NewApi">
    <ignore path="target/classes/com/actionbarsherlock/internal/ActionBarSherlockNative.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/ActionBarSherlockNative$ActionModeWrapper.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarWrapper.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarWrapper$TabWrapper.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/view/ActionProviderWrapper.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/ActionMenuItemView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/MenuItemWrapper.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/ActionMenuPresenter$HasPermanentMenuKey.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsAdapterView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsProgressBar.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ActionBarView$HomeView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/widget/SearchView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/AbsActionBarView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ActionBarContextView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarImpl$1.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/app/ActionBarImpl.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/ActionBarSherlockNative$ActionModeCallbackWrapper.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ActionBarView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/widget/ActivityChooserView$SetActivated.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/view/menu/BaseMenuPresenter.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingButton.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingTextView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsAbsSpinner.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsLinearLayout.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/IcsListPopupWindow.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/widget/NineHorizontalScrollView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/widget/NineLinearLayout.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/view/NineViewGroup.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/ScrollingTabContainerView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockActivity.class"/>
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockExpandableListActivity.class"/>
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockListActivity.class"/>
    <ignore path="target/classes/com/actionbarsherlock/app/SherlockPreferenceActivity.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/widget/NineFrameLayout.class"/>
    <ignore path="target/classes/com/viewpagerindicator/IcsLinearLayout.class"/>
</issue>

<issue id="FloatMath">
    <ignore path="target/classes/com/actionbarsherlock/internal/nineoldandroids/view/animation/AnimatorProxy.class"/>
</issue>

<issue id="DefaultLocale">
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingTextView.class"/>
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CapitalizingButton.class"/>
</issue>

<issue id="ViewConstructor">
    <ignore path="target/classes/com/actionbarsherlock/internal/widget/CollapsibleActionViewWrapper.class"/>
</issue>
</lint> 
```

# haskell - 返回带有状态单子的值

> ID：13516333
> 
> 赞同：0
> 
> 时间：2012-11-22T15:58:15.853
> 
> 标签：haskell, monads, state-monad

一般来说，我是 Monads 和 Haskell 的新手，并试图了解如何在使用它们时返回一个值。我的代码如下所示：

```
foo :: A -> B
foo a = do  b <- fooC a (C 0)
            -- want to return just (B "b")

fooC :: A -> C -> State MyState B
fooC a c = return (B "b") 
```

我尝试使用`snd (snd b)`，但显然`State MyState B`不是元组？如何返回所需的值`(B "b")`？

**编辑**：考虑到丹尼尔的建议，重写看起来像这样：

```
data MyState = MyState String
data C = C Int
foo :: String -> String
-- want to return just "b"
foo a = evalState (fooC a) (C 0)

fooC :: String -> Int -> State MyState String
fooC a c = return "b" 
```

这仍然会导致编译错误：

```
Couldn't match expected type `State s0 String'
            with actual type `Int -> State MyState String'
In the return type of a call of `fooC'
Probable cause: `fooC' is applied to too few arguments
In the first argument of `evalState', namely `(fooC a)'
In the expression: evalState (fooC a) (C 0) 
```

**编辑2**：固定！最终版本如下所示：

```
import Control.Monad.State
data MyState = MyState String
data C = C Int
foo :: String -> String
-- want to return just (B "b")
foo a = evalState (fooC a (C 0)) (MyState "whatever")

fooC :: String -> C -> State MyState String
fooC a c = return "b"

main = print(foo("test"))
-- prints "b" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T16:09:45.993

你需要的是

```
foo a = evalState (fooC a (C 0)) (MyState "whatever") 
```

您构造`State MyState B`action `fooC a (C 0)`，将其解包以获取一个函数，并将该函数应用于初始状态。由于此示例中未使用状态，因此您也可以在此处使用`undefined`而不是`MyState "whatever"`，但通常，您需要提供有意义的初始状态。

`State MyState B`不是元组，它与函数同构

```
MyState -> (B, MyState) 
```

但是该函数被包装在 a 中`newtype`（细节因 monad 转换器库包和版本而异），因此要访问应用于初始状态的该函数的结果，您需要一个解包函数。对于`State`，有

```
runState :: State s r -> (s -> (r,s)) 
```

它为您提供了返回该对的函数，

```
evalState :: State s r -> (s -> r) 
```

这为您提供了由 组成的函数`fst`，因此最终状态被丢弃，并且

```
execState :: State s r -> (s -> s) 
```

它与 组成函数`snd`，因此只返回最终状态。

# android - 如何在Android中处理TabLayout中的onActivityResult函数

> ID：13516340
> 
> 赞同：0
> 
> 时间：2012-11-22T15:58:44.680
> 
> 标签：android, android-layout, android-activity, tabactivity, onresume

我有带有 5 个选项卡的选项卡活动，即相机选项卡中的相机、画廊、列表、历史记录和注销我打开相机并拍照并保存在画廊中，同时我用这个挑选的图像打开表单。我的问题是当我不填写表格并移动到其他选项卡并再次回到该相机时，它显示 onActivityResult() 函数中使用的相同布局这是我的代码。请给我答案，我们可以完成活动打开 onActivityResult()。

```
public class PhotoScreen extends Activity{
//private static final String[] COUNTRIES = new String[] {"Apartment", "Land"};
public int TAKE_PICTURE = 0;
Button takepicture;
public static String propertynamevalue;
Bitmap mBitmap = null;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.photolayout);

    takepicture = (Button) findViewById(R.id.button1);
    takepicture.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            startActivityForResult(intent, TAKE_PICTURE);

        }
    });

}

@Override
protected void onActivityResult(int requestCode, int resultCode, final Intent data) 
{
   setContentView(R.layout.publish);
    super.onActivityResult(requestCode, resultCode, data);
    final DatabaseHandler db=new DatabaseHandler(this.getBaseContext());
    Button save =(Button)findViewById(R.id.save);
    if (requestCode == TAKE_PICTURE) 
    {

           if(resultCode == RESULT_OK)
           { 
               Log.v("test", "Camera intent succeeded");

               mBitmap = (Bitmap) data.getExtras().get("data");
                   ImageView imageView =(ImageView)findViewById(R.id.imgView);
                   Canvas can = new Canvas();
                   can.setBitmap(Bitmap.createBitmap(mBitmap.getWidth(), mBitmap.getHeight(), Bitmap.Config.RGB_565));
                   imageView.setImageBitmap(mBitmap);

           }
           else if(resultCode == RESULT_CANCELED)
           {  
               setContentView(R.layout.photolayout);
               Log.i("test1", "Camera intent aborted");
           }
           else
           {  
               Log.e("test2", "Camera intent failed with result code: " + resultCode);
           }
    }
    save.setOnClickListener(new OnClickListener(){

        @Override
        public void onClick(View arg0) {
            // Inserting Property
            EditText propname=(EditText)findViewById(R.id.etcity1);
            EditText propcost=(EditText)findViewById(R.id.etcity2);
            EditText propaddress=(EditText)findViewById(R.id.etcity3);
            EditText propbuilduparea=(EditText)findViewById(R.id.etcity4);
            EditText propcategory=(EditText)findViewById(R.id.etcity5);
            Log.d("Insert: ", "Inserting ..");
            db.addProperty(new Property(propname.getText().toString(), propcost.getText().toString(),propaddress.getText().toString(),propbuilduparea.getText().toString(),propcategory.getText().toString()));
            //Log.d("propcost: ", ""+Double.parseDouble(propcost.getText().toString())+"");
            propname.setText("");
            propcost.setText("");
            propaddress.setText("");
            propbuilduparea.setText("");
            propcategory.setText("");

            // Reading all contacts
            List<Property> property = db.getAllContacts();
            for (Property cn : property){
                Log.d("Reading: ", "Reading all contacts..");
                String log = "Id: "+cn.getID()+" ,Name: " + cn.getName() + " ,Cost: " + cn.getCost()+ " ,Address: " + cn.getAddress()+ " ,Builduparea: " + cn.getBuilduparea()+" ,Category: " + cn.getCategory();
                // Writing Contacts to log
                Log.d("Name: ", log);
            }
            setContentView(R.layout.photolayout);
            Toast.makeText(getApplicationContext(), "Your Data Has been saved successfully", Toast.LENGTH_LONG).show();
            }

    });

} 
```

# android - 安卓。如何创建自定义进度条对话框？附图片

> ID：13516344
> 
> 赞同：0
> 
> 时间：2012-11-22T15:59:01.227
> 
> 标签：android, android-layout, android-widget

我想创建这样一个对话框来显示我所附的进度条。我想在后台进行一些工作并且向用户显示进度条时显示一些图片序列。我怎样才能进行这样的活动/对话？谁能给我一些建议？

![在此处输入图像描述](../Images/471911c60fc05bf6bf778e5eb09dc1f1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:37:08.950

你的问题到底是什么？根据进度显示不同图像的布局或代码？

我猜它不是布局。因此，我建议您将 Runnable / AsyncTask 与 Handler 一起使用。请参阅[AsyncTask 参考](http://developer.android.com/reference/android/os/AsyncTask.html)。

所以主要的想法是：在你的 Main Activity 和一个 Runnable 中启动一个对话框，它从你的 main Activity 接收一个[处理程序](http://developer.android.com/reference/android/os/Handler.html)。Runnable 本身扩展 AsyncTask 并在“doInBackground”函数中执行某些操作，例如通过 Handler.sendMessage(msg) 函数向进度对话框发送消息，您的主类可以通过“handleMessage”函数接收此消息并根据情况更新图像在收到的消息上。这可能不是最准确的解释，但上面的链接应该清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T17:58:42.487

利用 ProgressBar ui 元素。

[http://developer.android.com/reference/android/widget/ProgressBar.html](http://developer.android.com/reference/android/widget/ProgressBar.html)

您的布局如下所示。

```
<LinearLayout
     android:orientation="horizontal"
     ... >
     <ImageView
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         ..... />
     <ProgressBar
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         style="@android:style/Widget.ProgressBar.Horizontal"
         android:layout_marginRight="5dp" />
 </LinearLayout> 
```

[然后在您的活动中，当您在AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)的“onProgressUpdate”中更新进度条时，您还可以以某种间隔切换 imageView 中的图像。

# html - 如何通过 HTML5 视频标签播放 YouTube 视频

> ID：13516345
> 
> 赞同：23
> 
> 时间：2012-11-22T15:59:14.367
> 
> 标签：html, html5-video

这段代码工作了一会儿，但我认为链接发生了变化，导致第二天找不到它？
Firefox/Chrome/Opera下播放的视频...如何让video标签永久播放该视频？！

```
<video width="480" height="270" controls="controls" style="color:green;">
  <source src="youtubelink" type="video/mp4">
  <source src="youtubelink" type="video/ogg">
  <source src="youtubelink" type="video/webm">
Your browser does not support the video tag.
</video> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-24T18:35:59.460

没有真正可靠的方法可以在真实视频标签中实际播放 YouTube 视频。YouTube 不希望你这样做，这可能违反了他们的服务条款。无论如何，该 URL 可能会定期更改，无论 YT 是否调整其基础架构，或者他们会竭尽全力阻止人们直接访问视频文件。

但是，如果您使用视频标签，您可以采取一些步骤来完成您可以做的所有事情。首先，您可以在嵌入中添加“html5=1”提示，这将告诉 youtube 使用 html5 视频而不是 Flash（它通常符合，但并非总是如此）。视频将在 iframe 中，但您可以将所有常用的 CSS 技巧应用于该 iframe - 不透明度、变换等。

如果您使用的是 YouTube API，请添加`html5: 1`到`playerVars`. 如果您只是直接嵌入 iframe，请将其添加到查询字符串中，如下所示： [http ://www.youtube.com/embed/okqEVeNqBhc?html5=1](http://www.youtube.com/embed/okqEVeNqBhc?html5=1)

现在，如果你想更进一步，Popcorn.js 现在为 YouTube API 提供了一个漂亮的[包装对象](https://github.com/hapyak/popcorn-js/blob/feature/youtube/wrappers/youtube/popcorn.HTMLYouTubeVideoElement.js)，它将使 YouTube（他们也为 Vimeo 提供一个）视频表现得像一个 HTMLVideoElement，具有大多数相同的属性，方法和事件。它并不完美，但它非常好。

注意：该文件的官方来源位于[mozilla/popcorn-js](https://github.com/mozilla/popcorn-js/)存储库中，但[该](https://github.com/hapyak/popcorn-js/blob/feature/youtube/wrappers/youtube/popcorn.HTMLYouTubeVideoElement.js)文件目前正在修复错误和功能。您需要包含最新版本的 Popcorn.js 和`wrappers/common/popcorn._MediaElementProto.js`来自该 repo 的内容。确保`&html5=1`在设置`src`.

您会注意到的差异是：

*   即使使用包装器，HTML5 视频 API 的性能也比 YT API 好一点。例如，更灵敏和更好的缓冲报告。

*   您无法摆脱在暂停或鼠标悬停时显示的右下角的 YouTube 图标。

*   您无法阻止 YouTube 展示广告。

*   您无法访问音频 API 和 canvas/webgl 绘图之类的实际视频/音频内容。但是由于跨域限制，您无论如何都不能这样做。

# c - 使用共享内存发送 2 个整数

> ID：13516347
> 
> 赞同：0
> 
> 时间：2012-11-22T15:59:14.943
> 
> 标签：c, windows, shared-memory

我有一个通信服务器-客户端，我从服务器向客户端发送一个带有 CopyMemory 函数的整数。我的问题是，如果我通过 MapViewOfFile 获得的相同指针发送第二个整数，我可以只调用 CopyMemory 到同一个指针，或者我必须创建另一个 FileMapp，获取 MapViewOfFile 等。谢谢

# database - EJB3 的持久性不起作用

> ID：13516350
> 
> 赞同：0
> 
> 时间：2012-11-22T15:59:23.540
> 
> 标签：database, ejb, ejb-3.0, flush, persist

我有一种方法可以在 EJB bean 中保存一个新对象。调用此方法，没有错误，但数据库中没有任何变化。我不明白为什么。

这是代码：

```
@Stateless(name = "Ar", mappedName = "ManagementBean")
public class ManagementBean implements IManagementBeanLocal, IManagementBeanRemote {
...
    @Override
    public int storeRawSms(String raw, String requestUid, String text, String service, boolean correctlyAnalysed, Date receivedTimestamp,
            boolean toBeAnalysed, String phoneNumber) {

        // Get phone number, create if it dosn't exist
        PhoneNumber pn = getOrCreatePhoneNumberPrivate(phoneNumber);

        // Create rawSMS
        RawSms rawSms = new RawSms(raw, requestUid, text, service, correctlyAnalysed, receivedTimestamp, toBeAnalysed, pn);

        // Store and return result
        em.persist(rawSms);
        int result =  rawSms.getId();

        em.flush();
        em.clear();

        return result;
    }

... 
```

和来电者：

```
@PersistenceContext private EntityManager em; 
... 
int rawSmsIs = bean.storeRawSms(raw, requestUid, message, service, false, new Date(), true, sender); 
```

你有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T07:36:04.617

我看到您在客户端中注入了对 EntityManager 的引用（不知道为什么），但我在会话 bean 中没有看到它（可能只是因为您没有在消息中包含该行）。您是否可能忘记在无状态会话 bean 中使用注释 @PersistenceContext？

另外，请注意：根据您使用的 JPA 实现和 id 的生成策略，您应该在调用 getId( )**之前调用 flush()。**实际上，如果您让数据库生成您的 ID，那么您需要一个 flush() 在方法返回值之前发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T08:56:10.123

谢谢，建议的解决方案有效！

我像这样使用容器管理的事务：

```
@Stateless(name = "Ar", mappedName = "ManagementBean")
@TransactionManagement(TransactionManagementType.CONTAINER)
public class ManagementBean implements IManagementBeanLocal, IManagementBeanRemote {
....
    @Override
    @TransactionAttribute(TransactionAttributeType.REQUIRES_NEW)
    public int storeRawSms(String raw, String requestUid, String text, String service, boolean correctlyAnalysed, Date receivedTimestamp, boolean toBeAnalysed, String phoneNumber) {
.... 
```

再次感谢！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-26T08:16:48.830

您的事务似乎从未提交，因此请尝试更改事务管理：

```
@Stateless(name = "Ar", mappedName = "ManagementBean")
@TransactionManagement(TransactionManagementType.BEAN)
public class ManagementBean implements IManagementBeanLocal, IManagementBeanRemote {

      @Resource
      private UserTransaction utx;

      @Override
      public int storeRawSms(..) {

            try {
                  utx.begin();
                  ..
                  em.persist(rawSms);
                  int result =  rawSms.getId();
                  utx.commit();
            }
            catch(Exception ex) {
                  //EXCEPTION HANDLING
                  utx.rollback();
            }
      }
} 
```

# mysql - 如何定义在 pentaho 水壶 4.2.0 上使用哪个 mysql 驱动程序？

> ID：13516353
> 
> 赞同：2
> 
> 时间：2012-11-22T15:59:26.660
> 
> 标签：mysql, repository, driver, pentaho, kettle

我很难连接到 MySQL pentaho 数据集成存储库。Kitchen.sh 不断要求 org.gjt.mm.mysql.Driver 而不是所需的 com.mysql.jdbc.Driver。如何定义正确的驱动程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T08:17:25.107

1.  将实际 JDBC-Driver 的 jar 文件放入 /libext/JDBC
2.  一个。创建新的数据库连接 b. 选择连接类型“***通用数据库***”，c。将属性“ ***Custom Driver Class Name*** ”设置为“ ***com.mysql.jdbc.Driver*** ” d．将“ ***Custpm Connection URL*** ”设置为“ *jdbc:mysql:// **myhost** :3306/ **mydb*** ”，其中***myhost***是您的主机名，***mydb*** - 您的数据库名。e. 设置数据库的***用户名***和***密码***
3.  使用该连接连接到存储库

# ruby-on-rails - 未定义的项目

> ID：13516355
> 
> 赞同：0
> 
> 时间：2012-11-22T15:59:34.130
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

所以昨天我问了一个关于为当前用户获取项目的问题。好吧，我遇到了一个问题。[在这里看到那个线程。](https://stackoverflow.com/questions/13497912/problems-showing-only-projects-that-belong-to-a-user)所以今天我正在为用户显示类别和任务以及任何讨论。当我加载页面以查看此内容时，我得到了：

```
NoMethodError in UsersController#show

undefined method `projects' for #<User:0xad5823f4>
Rails.root: /home/adam/Documents/Aptana Studio 3 Workspace/StartPoint

Application Trace | Framework Trace | Full Trace
app/controllers/users_controller.rb:25:in `show'
Request

Parameters:

{"id"=>"4"} 
```

这是目前我的 users#show 方法中的内容：

```
 def show
    @projects = current_user.projects
    @tasks = current_user.tasks
    @categories = current_user.categories
    @discussions = current_user.discussions
  end 
```

表名是项目、任务、类别和讨论。我在其他任何地方都没有问题，为什么我会看到这个错误？

如果您需要更多代码，我可以展示它。错误很明显，但我再次使用这种类型的调用来显示项目特定信息，例如项目类别或任务。这可能与我的用户与类别、讨论、任务等之间的关系有关吗？因为我确实在 show 方法中列出的每个表中都有 user_id 等等。

我也想到了这一点，今天早上开始讨论这个话题：current_user 似乎是错误的，因为如果我点击 Bobs 个人资料，我会看到我所有的东西，不是吗？它不应该是更特定于用户 ID 的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:02:10.277

您是否在每个模型中建立了关联？

```
class User < ActiveRecord::Base
  has_many :projects
end 
```

还要确保它`current_user`实际上是一个用户对象，而不是一些瘦代理。

一般需要区分会话用户和显示用户。这就是为什么喜欢的名字`current_user`是有害的。我建议使用`session_user`来指代登录用户并`@user`指代正在显示的用户。

一些登录系统只定义了一个`current_user`方法，但是给它起别名并不难。在这种情况下，它只是设计上有缺陷。

# python - 为什么 NotImplemented 不引发 TypeError？

> ID：13516357
> 
> 赞同：3
> 
> 时间：2012-11-22T15:59:43.570
> 
> 标签：python, python-3.x, comparison-operators

假设我定义了一个类`A`，并且我不希望任何人写出该类的不等式而不逃脱。

```
class A():
    def __ne__(self, other):
        return NotImplemented
print(A() != A()) 
```

但是尽管我故意“关闭”了操作员，但这打印出来`True`并没有引发？`TypeError``!=`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-22T16:08:53.193

当您返回时`NotImplemented`，您表示您不*知道*是否`__ne__`应该返回`True`或`False`。

通常，Python 会交换操作数；如果`a != b`结果为`NotImplemented`，它会`b != a`改为尝试。这也会失败，因为您在运算符的两侧使用相同的类型。对于`!=`操作符，Python 将回退到比较它们的内存地址，并且这些地址不相同（两个单独的实例），因此返回 False。

有关详细信息，请参阅[`do_richcompare`C 函数](http://hg.python.org/cpython/file/e456da396ad9/Objects/object.c#l540)。

`TypeError()`如果这是您的预期结果，您将不得不手动加注。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-22T16:04:56.223

它给你 True 因为你正在**返回**一个异常，而不是**引发**它。这意味着您将返回一个非 Null 对象（异常）作为测试的结果。除非另有说明，否则非 Null 对象将被评估为 True。请记住，异常是一个普通对象，直到您引发它。

所以你应该有一个看起来像这样的方法：

```
class A():
    def __ne__(self, other):
        raise NotImplementedError 
```

# sorting - Jtable 按列排序

> ID：13516361
> 
> 赞同：0
> 
> 时间：2012-11-22T16:00:06.160
> 
> 标签：sorting, jtable

表

页眉1 | 页眉2 | 页眉3

温度1 | 温度1 | 布尔值.FALSE

温度2 | 温度2 | 布尔值.TRUE

温度3 | 温度3 | 布尔值.FALSE

温度4 | 温度4 | 布尔值.TRUE

如何对 Header3 进行排序？首先进入 Boolean.TRUE，然后进入 Boolean.FALSE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T18:51:27.860

> 我不知道将第三列设置为要排序的列。

参考[教程](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#sorting)和此[示例](https://stackoverflow.com/a/13467228/230513)，您可以指定列，`SortOrder`如下所示`CHECK_COL`：

```
public CheckABunch() {
    ...
    table.setAutoCreateRowSorter(true);
    DefaultRowSorter<DefaultTableModel, Integer> sorter =
        ((DefaultRowSorter) table.getRowSorter());
    List<RowSorter.SortKey> sortKeys = new ArrayList<RowSorter.SortKey>();
    sortKeys.add(new RowSorter.SortKey(CHECK_COL, SortOrder.DESCENDING));
    sorter.setSortKeys(sortKeys);
} 
```

![在此处输入图像描述](../Images/4140526e9d1f7381e5f206a0b70ce7bc.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:10:04.943

您可以使用 TableRowSorter 进行排序。搜索它，你会得到很多例子。

# python - 在 nltk 中使用 scikit-learn 分类器，多类案例

> ID：13516364
> 
> 赞同：6
> 
> 时间：2012-11-22T16:00:18.110
> 
> 标签：python, nltk, scikit-learn

文本文档的分类是[scikit-learn 的一项简单任务，](https://stackoverflow.com/questions/10526579/use-scikit-learn-to-classify-into-multiple-categories)但在 NLTK 中并没有明确的支持，也有一些样本可以像这样以艰难的方式做到这[一点](https://github.com/japerk/nltk-trainer/blob/master/nltk_trainer/classification/multi.py#L79)。我想用 NLTK 进行预处理并用 sckit-learn 进行分类，我在 NLTK 中找到了 SklearnClassifier，但是有一个小问题。

在 scikit-learn 中一切正常：

```
from sklearn.naive_bayes import MultinomialNB
from sklearn.multiclass import OneVsRestClassifier

X_train = [[0, 0], [0, 1], [1, 1]]
y_train = [('first',), ('second',), ('first', 'second')]

clf = OneVsRestClassifier(MultinomialNB())
clf.fit(X_train, y_train)
print clf.classes_ 
```

结果是`['first' 'second']`，这是我的期望。但是当我尝试在 NLTK 中使用相同的代码时：

```
from nltk.classify import SklearnClassifier

X_train = [{'a': 1}, {'b': 1}, {'c': 1}]
y_train = [('first',), ('second',), ('first', 'second')]
clf = SklearnClassifier(OneVsRestClassifier(MultinomialNB()))
clf.train(zip(X_train, y_train))
print clf.labels() 
```

结果是`[('first',), ('second',), ('first', 'second')]`，它不是正确的。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-22T16:28:16.500

scikit-learn 的 NLTK 包装器不知道多标签分类，也不应该因为它没有实现[`MultiClassifierI`](http://nltk.org/api/nltk.classify.html#nltk.classify.api.MultiClassifierI). 实现它需要一个单独的类。

您可以实现缺少的功能，也可以在没有包装器的情况下使用 scikit-learn。较新版本的 scikit-learn`DictVectorizer`接受的输入与 NLTK 包装器接受的输入大致相同：

```
from sklearn.feature_extraction import DictVectorizer

X_train_raw = [{'a': 1}, {'b': 1}, {'c': 1}]
y_train = [('first',), ('second',), ('first', 'second')]

v = DictVectorizer()
X_train = v.fit_transform(X_train_raw)

clf = OneVsRestClassifier(MultinomialNB())
clf.fit(X_train, y_train) 
```

然后，您可以使用`X_test = v.transform(X_test_raw)`将测试样本转换为矩阵。A`sklearn.pipeline.Pipeline`通过将矢量化器和分类器捆绑在一个对象中使这更容易。

**免责声明**：根据[常见问题解答](/faq)，我应该披露我的隶属关系。`DictVectorizer`我为 scikit-learn编写了两者和 NLTK 包装器。

# php - 如何使用 php 从 oracle 获取 xml 格式的数据

> ID：13516370
> 
> 赞同：2
> 
> 时间：2012-11-22T16:00:47.907
> 
> 标签：php, xml, web-services, oracle

如果有人帮助我，我会很高兴:)

我正在尝试编写从 Oracle DB 读取查询并将结果显示为 XML 的 php Web 服务。我花了几天时间寻找解决方案，但不幸的是它没有用

以下是我尝试过的一些查询：

```
 <?php
  $db ="(DESCRIPTION=
         (ADDRESS_LIST=
           (ADDRESS=(PROTOCOL=TCP)(HOST=xxxx)(PORT=1530))
          )
         (CONNECT_DATA=(SID=DEV))
       )";
$c = oci_connect("uname", "pass", $db);

$q = "select dbms_xmlgen.getxml(
       'select user_name
        from fnd_user
        where user_name = 007144') xml
      from dual";

$s = oci_parse($c, $q);
oci_execute($s);
$r = oci_fetch_array($s, OCI_ASSOC);
$mylob = $r['XML']->load();   // Treat column data as a LOB descriptor

echo "<pre>";
echo htmlentities($mylob);
echo "</pre>";
?> 
```

第二个代码：

```
<?php
//File: DOM.php
$db="(DESCRIPTION=
     (ADDRESS_LIST=
       (ADDRESS=(PROTOCOL=TCP)
         (HOST=xxx)(PORT=1530)
       ) )
       (CONNECT_DATA=(SID=DEV))
 )";
 $conn = OCILogon("uname","pass",$db);
 if ($conn) {
   //echo "Successfully connected to Oracle.";  
 } else {
   $err = oci_error();
   echo "Oracle Connect Error " . $err['text'];
 }
$query = "SELECT user_name from fnd_user where user_name = '007144'";
$stmt = oci_parse($conn,$query);

if (!oci_execute($stmt, OCI_DEFAULT)) {
$err = oci_error($stmt);
trigger_error('Query failed: ' . $err['message'], E_USER_ERROR);
}
$dom = new DOMDocument('1.0', 'UTF-8');
$root = $dom->createElement('EMPLOYEES', 'Root');
$dom->appendChild($root);//$root = $dom->appendChild($root);
while ($row = oci_fetch_array($stmt, OCI_RETURN_NULLS)) 
{
$emp = $dom->createElement('EMPLOYEE', 'emp');
$emp = $root->appendChild($emp);
$emp->setAttribute('id', $row['user_name']);

/*
$emp = $dom->createElement('EMPLOYEE', '');
                $emp = $root->appendChild($emp);
                $emp->setAttribute('id', $row['user_name']);
                $ename = $dom->createElement('ENAME', $row['user_name']);
                $ename = $emp->appendChild($ename);
                $salary = $dom->createElement('SALARY', $row['user_name']);
                $salary = $emp->appendChild($salary);
*/
}
        echo $dom->saveXML();
        //$dom->save("employees.xml");
oci_close($conn); 
?> 
```

上面的代码给了我没有数据的 XML，如下图所示！ [http://i48.tinypic.com/2lnv5eo.jpg](http://i48.tinypic.com/2lnv5eo.jpg)

第三密码

```
<?php
  //File: XMLFromSQL.php
  $user = 'uname';
  $pswd = 'pass';
  $db ='(DESCRIPTION=
         (ADDRESS_LIST=
           (ADDRESS=(PROTOCOL=TCP)(HOST=xxx)(PORT=1530))
          )
         (CONNECT_DATA=(SID=DEV))
       )';

 $sql = "SELECT user_name as RESULT FROM  fnd_user 
          WHERE user_name=:deptno";
  $deptno = 007144;
 //Connect to the database and obtain info on a given department in XML format
  $conn = oci_connect($user, $pswd, $db);

 $query = oci_parse($conn, $sql);
  oci_bind_by_name($query, ":deptno", $deptno, 2);
  oci_execute($query);
  oci_fetch($query);
  $strXMLData = oci_result($query, 'RESULT');

  //Create a new DOM document and load XML into its internal XML tree
  $doc = new DOMDocument("1.0", "UTF-8");
  $doc->loadXML($strXMLData);

  //For simplicity, just print out the XML document
  print $doc->saveXML();
?> 
```

如果您有其他方法，请帮助我，否则我会发疯的:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T16:59:28.907

最后，我得到了这个 XML

```
<?php
//File: DOM.php
$db="(DESCRIPTION=
     (ADDRESS_LIST=
       (ADDRESS=(PROTOCOL=TCP)
         (HOST=xxx)(PORT=1530)
       )
     )
       (CONNECT_DATA=(SID=DEV))
 )";
 $conn = OCILogon("uname","pass",$db);
 if ($conn) {
   //echo "Successfully connected to Oracle.";  
 } else {
   $err = oci_error();
   echo "Oracle Connect Error " . $err['text'];
 }
//$dept_id = 007144;
$query = "SELECT user_name from fnd_user where user_name = '007144'";

$stmt = oci_parse($conn,$query);
//oci_bind_by_name($stmt, ':deptid', $dept_id);
if (!oci_execute($stmt, OCI_DEFAULT)) {
$err = oci_error($stmt);
trigger_error('Query failed: ' . $err['message'], E_USER_ERROR);
}
$dom = new DOMDocument('1.0', 'UTF-8');
$root = $dom->createElement('EMPLOYEES', '');
$dom->appendChild($root);//$root = $dom->appendChild($root);
while ($row = oci_fetch_array($stmt, OCI_RETURN_NULLS)) 
{

//var_dump($row);
//$emp = $dom->createElement('EMPLOYEE', 'emp');
//$emp = $root->appendChild($emp);
//$emp->setAttribute('id', $row['EMPLOYEE_NUMBER']);

$emp = $dom->createElement('EMPLOYEE', '');
                $emp = $root->appendChild($emp);
                //$emp->setAttribute('id', $row['FULL_NAME']);
                $EmpName = $dom->createElement('EmpName', $row['FULL_NAME']);
                $EmpName = $emp->appendChild($EmpName);
                $empid = $dom->createElement('EmpID', $row['EMPLOYEE_NUMBER']);
                $empid = $emp->appendChild($empid);
                $email = $dom->createElement('email', $row['EMAIL_ADDRESS']);
                $email = $emp->appendChild($email);
}
        echo $dom->saveXML();
        $dom->save("employees.xml");
oci_close($conn); 
?> 
```

结果在这里： http: [//filedb.experts-exchange.com/incoming/2012/11_w47/617768/XMLinPHP4.jpg](http://filedb.experts-exchange.com/incoming/2012/11_w47/617768/XMLinPHP4.jpg)

现在，我将开始解析这个 XML，我希望它最终会成功，否则我会再次回来打扰您，对不起 :(

明天我会告诉你的，等我:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:17:27.987

我测试了你的文件：

和`$row['user_name']`

```
C:\Apps\PHP>php c:\temp\test.php
PHP Notice:  Undefined index: user_name in C:\temp\test.php on line 25

Notice: Undefined index: user_name in C:\temp\test.php on line 25
<?xml version="1.0" encoding="UTF-8"?>
<EMPLOYEES>Root<EMPLOYEE id="">emp</EMPLOYEE></EMPLOYEES> 
```

和`$row['USER_NAME']`

```
C:\Apps\PHP>php c:\temp\test.php
<?xml version="1.0" encoding="UTF-8"?>
<EMPLOYEES>Root<EMPLOYEE id="007144">emp</EMPLOYEE></EMPLOYEES> 
```

这能解决你的问题吗？

编辑：对于解决方案 1（PLSQL 端）

```
$s = oci_parse($c, $q);
oci_execute($s, OCI_DEFAULT);
$r = oci_fetch_array($s, OCI_RETURN_NULLS+OCI_RETURN_LOBS);
echo "<pre>";
echo htmlentities($r["XML"]);
echo "</pre>"; 
```

或者对元素的名称给予更多的控制

```
$q = "select xmlelement(
         \"EMPLOYEES\",
         xmlagg(
           xmlelement(
             \"EMPLOYEE\", 
             xmlforest(user_name as \"EmpName\",
                       id as \"EmpID\",
                       email as \"email\"
                      )
           )
         )
       ).getclobval() xml
  from fnd_user";

$s = oci_parse($c, $q);
oci_execute($s, OCI_DEFAULT);
$r = oci_fetch_array($s, OCI_RETURN_NULLS+OCI_RETURN_LOBS);
echo "<pre>";
echo htmlentities($r["XML"]);
echo "</pre>"; 
```

xmlforest 版本的示例输出为：

```
C:\Apps\PHP>php c:\temp\test3.php
<pre>&lt;EMPLOYEES&gt;&lt;EMPLOYEE&gt;&lt;EmpName&gt;John Doe&lt;/EmpName&gt;&lt;EmpID&gt;1&lt;/EmpID&gt;&lt;email&gt;d@d.com&lt;/email&gt;&lt;/EMPLOYEE&gt;&lt;EMPLOYEE&gt;&lt;
EmpName&gt;Alan Smith&lt;/EmpName&gt;&lt;EmpID&gt;2&lt;/EmpID&gt;&lt;email&gt;e@e.com&lt;/email&gt;&lt;/EMPLOYEE&gt;&lt;/EMPLOYEES&gt;</pre>
C:\Apps\PHP> 
```

IE：

```
<EMPLOYEES>
    <EMPLOYEE>
        <EmpName>John Doe</EmpName>
        <EmpID>1</EmpID>
        <email>d@d.com</email>
    </EMPLOYEE>
    <EMPLOYEE>
        <EmpName>Alan Smith</EmpName>
        <EmpID>2</EmpID>
        <email>e@e.com</email>
    </EMPLOYEE>
</EMPLOYEES> 
```

# java - 如何在 Java 中将此“Tue Nov 13 14:35:04 +0000 2012”字符串格式转换为日期？

> ID：13516371
> 
> 赞同：2
> 
> 时间：2012-11-22T16:00:49.383
> 
> 标签：java, date

如何`Tue Nov 13 14:35:04 +0000 2012`在Java中将日期字符串格式转换为日期？我知道，`Date.parse(String)`但我不知道我应该使用哪种格式作为日期。我是否必须修改字符串以便将其解析为日期，如果是，那么如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T16:03:46.050

使用[`SimpleDateFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html), 格式字符串为

```
"E MMM dd HH:mm:ss Z yyyy" 
```

您应该明确使用`Locale.US`假设这些肯定会使用英文月/日名称。（例如，您不希望仅仅因为默认语言环境是法语就尝试解析法语名称。）

另外，不要忘记`Date`返回的值不知道原始时区——它将具有原始文本中表示的*瞬间*的正确值，但不要期望调用结果`toString()`使用相同的时区——`Date.toString()`始终使用默认时区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:20:29.923

```
 SimpleDateFormat sdf = new SimpleDateFormat("EEE MMM dd HH:mm:ss Z yyyy", Locale.US);
 Date test = sdf.parse("Tue Nov 13 14:35:04 +0000 2012");
 System.out.print(test.toString()); 
```

# java - 在 Java 中使用 LIBSVM 实现 Precision & Recall

> ID：13516374
> 
> 赞同：0
> 
> 时间：2012-11-22T16:01:10.227
> 
> 标签：java, libsvm, precision-recall

我使用 libsvm.jar（独立于 weka）开发了一个数据挖掘应用程序。但我找不到如何实现 Precision/Recall（在 java 中）来验证我的模型性能。

Libsvm Classes 中是否有要包含的 API 或要使用的方法？

知道这种功能包含在 C 和 Python 版本的 LIBSVM 中（但不包含在 java 中）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T14:05:03.277

为此，我们需要 weka。

Weka 和 libsvm 在一个包中提供

按照这个链接结合 Weka 和 libsvm [http://www.cs.iastate.edu/~yasser/wlsvm/](http://www.cs.iastate.edu/~yasser/wlsvm/)

weka 可以很好地计算 ROC、recall 等……而 libsvm 可以很好地用于分类、回归等……

# python - 用于配置 XBee 模块的 Python 脚本在树莓派上失败

> ID：13516378
> 
> 赞同：1
> 
> 时间：2012-11-22T16:01:25.193
> 
> 标签：python, configuration, raspberry-pi, xbee

我有一个 python 脚本，我想用它来配置一些 XBee 模块。当通过[xbee 开发板](http://microframework.dk/post/XBee-RF-module-specifications.aspx)连接到计算机时，它可以完美地找到，但在通过 pi 板片连接到树莓派时失败。

我已将问题缩小到无法进入命令模式，发送 +++ 后 xbee 从未发送 OK 消息。以下是相关代码：

```
...
CC = '+'
GT = '1.1' # Tried different values here
...

def startCommandMode(self):
    self.emptyBuffer() # Tried with and without this line
    sleep(self.GT) # Tried with and without this line
    self.ser.write(self.CC + self.CC + self.CC)
    sleep(self.GT)
    return self.getReply() == 'OK'

...

def getReply(self):
    count = 0
    reply = ''
    while True:
        char = self.ser.read()
        if char == '\r':
            break
        if len(char) == 0:
            return None
        reply += char

    return reply 
```

如果需要，可以在[github](https://github.com/james147/xbee-config/blob/master/xbee-config.py)上找到完整的源代码。

我知道 xbee 模块、树莓派或 pi 板片不是问题，因为如果我使用“picocom -lc /dev/ttyAMA0”手动尝试它，它工作得非常好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T11:27:53.250

使用以下内容：

```
....
if args.common:
    args.at = ['ID', 'CH', 'MY', 'DL', 'DH', 'AP'] + args.at
xbee = XBee(args.port, args.baud);
sleep(2)
xbee.CC = args.CC
xbee.GT = args.GT
....
.... 
```

恕我直言，我厚 Rpi 需要更多时间来初始化串口，这就是我使用这个延迟的原因。也适用于透明模式，因此在端口初始化后添加延迟。

我希望这对你来说没问题。对我来说已经解决了。

BR。曼内尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T18:38:00.943

需要检查的一些事项：

*   你有什么回应吗？

*   您是否在 XBee 上启用了流量控制？确保`D6`和`D7`设置为 0，因为 Raspberry Pi 串行端口没有流量控制。

*   是否为流控制配置了 Python 代码？它可能正在等待一个从未被断言的 CTS 信号。

*   您可以尝试在树莓派的 USB 端口上使用 XBee 开发板吗？

# scons - scons carshed当给出包含结肠的值的选项时

> ID：13516379
> 
> 赞同：0
> 
> 时间：2012-11-22T16:01:26.953
> 
> 标签：scons

在 Windows 上，当我将包含“：”的参数传递给 SCons（使用 AddOption 添加）时，Scons 以错误代码 2 退出并且无法编译。执行编译之前的所有步骤。

```
scons --test_option="abc:" # Fails
scons --test_option="abc" # Works 
```

即使选项本身未使用，它也不起作用。

冒号首先通过以提供完整路径。但是，它似乎与路径无关。

版本：2.2

# java - 如何使用 Libgdx 调整窗口内的舞台大小

> ID：13516387
> 
> 赞同：0
> 
> 时间：2012-11-22T16:01:51.820
> 
> 标签：java, screen, libgdx

我正在尝试使用 Libgdx 在屏幕内“调整”我的游戏视图。确实，我需要在屏幕的底部和左侧放置一个黑条。因此，如果您使用 MS Paint 或 Gimp 调整正方形的大小，我想在我的游戏阶段这样做。（我试图上传一个数字来让我的问题更清楚，但显然 Stackoverflow 禁止我这样做）

我想我把舞台尺寸、相机尺寸和视口混在一起了。任何建议将不胜感激 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:19:40.330

如果您使用的是舞台，那么您可以尝试用其他视口尺寸替换您自己的相机视图。

```
Camera newCamera = new OrthographicCamera(300, 200);
//... here is some other camera initialization code
newCamera.update();//recalculate camera matrices
stage.setCamera(newCamera);

//after that you may need to update sprite batch projection matrix

_gameStage.getSpriteBatch().setProjectionMatrix(newCamera.combined); 
```

# android - 在我的活动/服务中接收 USB 控制请求/usb 消息

> ID：13516388
> 
> 赞同：1
> 
> 时间：2012-11-22T16:01:55.940
> 
> 标签：android, embedded, usb, arduino

**如果我连接两个 android USB 设备（通过 OTG 电缆），我可以在另一部手机上运行的我的活动/服务中接收从一个设备发送的控制请求**吗？我浏览了所有 api，但不知道如何。

在 android sdk 示例应用程序 MissileLauncher 中，应用程序向 USB 设备发送控制请求，但没有示例如何读取这些控制请求。

# android - Android TimePickerDialog 设置最大时间

> ID：13516389
> 
> 赞同：26
> 
> 时间：2012-11-22T16:02:08.440
> 
> 标签：android, timepicker

我正在寻找一种方法来设置 Android 上可选择的最大和`TimePickerDialog`最小时间，并将默认分钟间隔从 1 分钟更改为 5 分钟，

我以为这很容易，但我找不到方法！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-06-05T14:29:20.617

**这个答案已经过时了**

它不适用于 Android 5 或更高版本。

* * *

这是提琴手答案的扩展。在某些 Android 版本中，TimePickerDialog 以某种方式未设置 onTimeChangedListener：

前任。 [http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.1_r1.2/android/app/TimePickerDialog.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.2.1_r1.2/android/app/TimePickerDialog.java)

因此永远不会调用 onTimeChanged 方法！目前针对此问题的最佳解决方案可能是使用 fiddler 的最小/最大逻辑编写自定义 TimePickerDialog。

更丑陋的解决方法是这个。（使用反射添加侦听器）我还更新了标题以显示当前选择的时间。

```
package com.mysuger.android.dialogs;

import java.lang.reflect.Field;
import java.text.DateFormat;
import java.util.Calendar;

import android.app.TimePickerDialog;
import android.content.Context;
import android.widget.TimePicker;

/**
 * A time dialog that allows setting a min and max time.
 * 
 */
public class RangeTimePickerDialog extends TimePickerDialog {

private int minHour = -1;
private int minMinute = -1;

private int maxHour = 25;
private int maxMinute = 25;

private int currentHour = 0;
private int currentMinute = 0;

private Calendar calendar = Calendar.getInstance();
private DateFormat dateFormat;

public RangeTimePickerDialog(Context context, OnTimeSetListener callBack, int hourOfDay, int minute, boolean is24HourView) {
    super(context, callBack, hourOfDay, minute, is24HourView);
    currentHour = hourOfDay;
    currentMinute = minute;
    dateFormat = DateFormat.getTimeInstance(DateFormat.SHORT);

    try {
        Class<?> superclass = getClass().getSuperclass();
        Field mTimePickerField = superclass.getDeclaredField("mTimePicker");
        mTimePickerField.setAccessible(true);
        TimePicker mTimePicker = (TimePicker) mTimePickerField.get(this);
        mTimePicker.setOnTimeChangedListener(this);
    } catch (NoSuchFieldException e) {
    } catch (IllegalArgumentException e) {
    } catch (IllegalAccessException e) {
    }
}

public void setMin(int hour, int minute) {
    minHour = hour;
    minMinute = minute;
}

public void setMax(int hour, int minute) {
    maxHour = hour;
    maxMinute = minute;
}

@Override
public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {

    boolean validTime = true;
    if (hourOfDay < minHour || (hourOfDay == minHour && minute < minMinute)){
        validTime = false;
    }

    if (hourOfDay  > maxHour || (hourOfDay == maxHour && minute > maxMinute)){
        validTime = false;
    }

    if (validTime) {
        currentHour = hourOfDay;
        currentMinute = minute;
    }

    updateTime(currentHour, currentMinute);
    updateDialogTitle(view, currentHour, currentMinute);
}

private void updateDialogTitle(TimePicker timePicker, int hourOfDay, int minute) {
    calendar.set(Calendar.HOUR_OF_DAY, hourOfDay);
    calendar.set(Calendar.MINUTE, minute);
    String title = dateFormat.format(calendar.getTime());
    setTitle(title);
}
 } 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-02-19T07:33:44.173

对于棒棒糖和更高版本的android，您可以使用这个修改后的 RangeTimePickerDialog 类

（在棒棒糖中，Timepicker 默认使用时钟模式（材料设计），因此旧的自定义类将无法工作。我们可以将模式更改为微调器以获取最新版本，并可以重用该类）

```
public class RangeTimePickerDialog extends TimePickerDialog {

    private int minHour = -1;
    private int minMinute = -1;

    private int maxHour = 25;
    private int maxMinute = 25;

    private int currentHour = 0;
    private int currentMinute = 0;

    private Calendar calendar = Calendar.getInstance();
    private DateFormat dateFormat;

    public RangeTimePickerDialog(Context context, int dialogTheme, OnTimeSetListener callBack, int hourOfDay, int minute, boolean is24HourView) {
        super(context, callBack, hourOfDay, minute, is24HourView);
        currentHour = hourOfDay;
        currentMinute = minute;
        dateFormat = DateFormat.getTimeInstance(DateFormat.SHORT);
        fixSpinner(context, hourOfDay, minute, is24HourView);

        try {
            Class<?> superclass = getClass().getSuperclass();
            Field mTimePickerField = superclass.getDeclaredField("mTimePicker");
            mTimePickerField.setAccessible(true);
            TimePicker mTimePicker = (TimePicker) mTimePickerField.get(this);
            mTimePicker.setOnTimeChangedListener(this);
        } catch (NoSuchFieldException e) {
        } catch (IllegalArgumentException e) {
        } catch (IllegalAccessException e) {
        }
    }

    public void setMin(int hour, int minute) {
        minHour = hour;
        minMinute = minute;
    }

    public void setMax(int hour, int minute) {
        maxHour = hour;
        maxMinute = minute;
    }

    @Override
    public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {

        boolean validTime = true;
        if (hourOfDay < minHour || (hourOfDay == minHour && minute < minMinute)){
            validTime = false;
        }

        if (hourOfDay  > maxHour || (hourOfDay == maxHour && minute > maxMinute)){
            validTime = false;
        }

        if (validTime) {
            currentHour = hourOfDay;
            currentMinute = minute;
        }

        updateTime(currentHour, currentMinute);
        updateDialogTitle(view, currentHour, currentMinute);
    }

    private void updateDialogTitle(TimePicker timePicker, int hourOfDay, int minute) {
        calendar.set(Calendar.HOUR_OF_DAY, hourOfDay);
        calendar.set(Calendar.MINUTE, minute);
        String title = dateFormat.format(calendar.getTime());
        setTitle(title);
    }

    private void fixSpinner(Context context, int hourOfDay, int minute, boolean is24HourView) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) { // android:timePickerMode spinner and clock began in Lollipop
            try {
                // Get the theme's android:timePickerMode
                //two modes are available clock mode and spinner mode ... selecting spinner mode for latest versions
                final int MODE_SPINNER = 2;
                Class<?> styleableClass = Class.forName("com.android.internal.R$styleable");
                Field timePickerStyleableField = styleableClass.getField("TimePicker");
                int[] timePickerStyleable = (int[]) timePickerStyleableField.get(null);
                final TypedArray a = context.obtainStyledAttributes(null, timePickerStyleable, android.R.attr.timePickerStyle, 0);
                Field timePickerModeStyleableField = styleableClass.getField("TimePicker_timePickerMode");
                int timePickerModeStyleable = timePickerModeStyleableField.getInt(null);
                final int mode = a.getInt(timePickerModeStyleable, MODE_SPINNER);
                a.recycle();
                if (mode == MODE_SPINNER) {
                    TimePicker timePicker = (TimePicker) findField(TimePickerDialog.class, TimePicker.class, "mTimePicker").get(this);
                    Class<?> delegateClass = Class.forName("android.widget.TimePicker$TimePickerDelegate");
                    Field delegateField = findField(TimePicker.class, delegateClass, "mDelegate");
                    Object delegate = delegateField.get(timePicker);
                    Class<?> spinnerDelegateClass;
                    if (Build.VERSION.SDK_INT != Build.VERSION_CODES.LOLLIPOP) {
                        spinnerDelegateClass = Class.forName("android.widget.TimePickerSpinnerDelegate");
                    } else {

                        spinnerDelegateClass = Class.forName("android.widget.TimePickerClockDelegate");
                    }
                    if (delegate.getClass() != spinnerDelegateClass) {
                        delegateField.set(timePicker, null); // throw out the TimePickerClockDelegate!
                        timePicker.removeAllViews(); // remove the TimePickerClockDelegate views
                        Constructor spinnerDelegateConstructor = spinnerDelegateClass.getConstructor(TimePicker.class, Context.class, AttributeSet.class, int.class, int.class);
                        spinnerDelegateConstructor.setAccessible(true);
                        // Instantiate a TimePickerSpinnerDelegate
                        delegate = spinnerDelegateConstructor.newInstance(timePicker, context, null, android.R.attr.timePickerStyle, 0);
                        delegateField.set(timePicker, delegate); // set the TimePicker.mDelegate to the spinner delegate
                        // Set up the TimePicker again, with the TimePickerSpinnerDelegate
                        timePicker.setIs24HourView(is24HourView);
                        timePicker.setCurrentHour(hourOfDay);
                        timePicker.setCurrentMinute(minute);
                        timePicker.setOnTimeChangedListener(this);
                    }
                }
            } catch (Exception e) {
                throw new RuntimeException(e);
            }
        }
    }
    private static Field findField(Class objectClass, Class fieldClass, String expectedName) {
        try {
            Field field = objectClass.getDeclaredField(expectedName);
            field.setAccessible(true);
            return field;
        } catch (NoSuchFieldException e) {} // ignore
        // search for it if it wasn't found under the expected ivar name
        for (Field searchField : objectClass.getDeclaredFields()) {
            if (searchField.getType() == fieldClass) {
                searchField.setAccessible(true);
                return searchField;
            }
        }
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-22T16:15:48.183

您可以以此为起点。

我扩展了 TimePickerDialog 并添加了 2 个方法`setMin`和`setMax`.

在该`onTimeChanged`方法中，我检查新时间对于最小/最大时间是否有效。

不过还是需要打磨一下。。。

```
public class BoundTimePickerDialog extends TimePickerDialog {

    private int minHour = -1, minMinute = -1, maxHour = 100, maxMinute = 100;

    private int currentHour, currentMinute;

    public BoundTimePickerDialog(Context context, OnTimeSetListener callBack, int hourOfDay, int minute, boolean is24HourView) {
        super(context, callBack, hourOfDay, minute, is24HourView);
    }

    public void setMin(int hour, int minute) {
        minHour = hour;
        minMinute = minute;
    }

    public void setMax(int hour, int minute) {
        maxHour = hour;
        maxMinute = minute;
    }

    @Override
    public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {
        super.onTimeChanged(view, hourOfDay, minute);

        boolean validTime;
        if(hourOfDay < minHour) {
            validTime = false;
        }
        else if(hourOfDay == minHour) {
            validTime = minute >= minMinute;
        }
        else if(hourOfDay == maxHour) {
            validTime = minute <= maxMinute;
        }
        else {
            validTime = true;
        }

        if(validTime) {
            currentHour = hourOfDay;
            currentMinute = minute;
        }
        else {
            updateTime(currentHour, currentMinute);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-13T15:09:10.330

重构提琴手的代码后：

```
public class RangeTimePickerDialog extends TimePickerDialog {

    private int mMinHour = -1;
    private int mMinMinute = -1;
    private int mMaxHour = 100;
    private int mMaxMinute = 100;
    private int mCurrentHour;
    private int mCurrentMinute;

    public RangeTimePickerDialog(Context context, OnTimeSetListener callBack, int hourOfDay, 
        int minute, boolean is24HourView) {
        super(context, callBack, hourOfDay, minute, is24HourView);
        mCurrentHour = hourOfDay;
        mCurrentMinute = minute;
        // Somehow the onTimeChangedListener is not set by TimePickerDialog
        // in some Android Versions, so, Adding the listener using
        // reflections
        try {
            Class<?> superclass = getClass().getSuperclass();
            Field mTimePickerField = superclass.getDeclaredField("mTimePicker");
            mTimePickerField.setAccessible(true);
            TimePicker mTimePicker = (TimePicker) mTimePickerField.get(this);
            mTimePicker.setOnTimeChangedListener(this);
        } catch (NoSuchFieldException e) {
        } catch (IllegalArgumentException e) {
        } catch (IllegalAccessException e) {
        }
    }

    public void setMin(int hour, int minute) {
        mMinHour = hour;
        mMinMinute = minute;
    }

    public void setMax(int hour, int minute) {
        mMaxHour = hour;
        mMaxMinute = minute;
    }

    @Override
    public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {
        super.onTimeChanged(view, hourOfDay, minute);
        boolean validTime;
        if (((hourOfDay < mMinHour ) || (hourOfDay == mMinHour && minute < mMinMinute)) 
                || ((hourOfDay > mMaxHour) || (hourOfDay == mMaxHour && minute > mMaxMinute))) {
            validTime = false;
        } else {
            validTime = true;
        }
        if (validTime) {
            mCurrentHour = hourOfDay;
            mCurrentMinute = minute;
        } else {
            updateTime(mCurrentHour, mCurrentMinute);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-22T16:12:22.533

没有设置最大/最小时间的本机方法，但如果您扩展它可能会起作用，`onTimeChanged`或者`updateTime`您可以防止将时间设置为超出范围的值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-18T03:02:47.283

您可以只使用带有反射的自定义 TimePicker 来设置值。

```
 @Override
protected void onAttachedToWindow() {
    super.onAttachedToWindow();

    try {
        Class<?> classForid = Class.forName("com.android.internal.R$id");
        Field field = classForid.getField("minute");

        NumberPicker mMinuteSpinner = (NumberPicker) findViewById(field.getInt(null));
        mMinuteSpinner.setMinValue(5);
        mMinuteSpinner.setMaxValue((60 / timeInterval) - 1);

        List<String> displayedValues = new ArrayList<>();
        for (int i = 0; i < 60; i += timeInterval)
            displayedValues.add(String.format("%02d", i));
        mMinuteSpinner.setDisplayedValues(displayedValues.toArray(new String[0]));

        mMinuteSpinner.setWrapSelectorWheel(true);

    } catch (Exception e) {
        e.printStackTrace();
    }

} 
```

所以你可以设置你想要的值

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-21T07:53:11.883

希望这会有所帮助。我使用了 Joda 时间库。

```
public class RangeTimePicker extends TimePicker implements
        TimePicker.OnTimeChangedListener {

    private int mMinHour = -1;

    private int mMinMinute = -1;

    private int mMaxHour = 25;

    private int mMaxMinute = 61;

    private int mCurrentHour;

    private int mCurrentMinute;

    public RangeTimePicker(Context context) {
        super(context);
        setOnTimeChangedListener(this);
    }

    public RangeTimePicker(Context context, AttributeSet attrs) {
        super(context, attrs);
        setOnTimeChangedListener(this);
    }

    public RangeTimePicker(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        setOnTimeChangedListener(this);
    }

    public void setMaxTime(int hourIn24, int minute) {
        mMaxHour = hourIn24;
        mMaxMinute = minute;

        LocalTime currentTime = LocalTime.now();
        LocalTime maxTime = new LocalTime(mMaxHour, mMaxMinute);

        if (currentTime.isAfter(maxTime)) {
            this.setCurrentHour(mCurrentHour = currentTime.getHourOfDay());
            this.setCurrentMinute(
                    mCurrentMinute = currentTime.getMinuteOfHour());
        }

    }

    public void setMinTime(int hourIn24, int minute) {
        mMinHour = hourIn24;
        mMinMinute = minute;

        LocalTime currentTime = LocalTime.now();
        LocalTime minTime = new LocalTime(mMinHour, mMinMinute);

        if (currentTime.isBefore(minTime)) {
            this.setCurrentHour(mCurrentHour = minTime.getHourOfDay());
            this.setCurrentMinute(mCurrentMinute = minTime.getMinuteOfHour());
        }
    }

    @Override
    public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {
        boolean validTime = true;
        if (hourOfDay < mMinHour || (hourOfDay == mMinHour
                && minute < mMinMinute)) {
            validTime = false;
        }

        if (hourOfDay > mMaxHour || (hourOfDay == mMaxHour
                && minute > mMaxMinute)) {
            validTime = false;
        }

        if (validTime) {
            mCurrentHour = hourOfDay;
            mCurrentMinute = minute;
        }

        setCurrentHour(mCurrentHour);
        setCurrentMinute(mCurrentMinute);

    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-19T23:31:19.847

希望这项工作，它与我完美配合......

设置时间选择器的最长时间。

```
 timePicker.setOnTimeChangedListener(new TimePicker.OnTimeChangedListener() {
        @Override
        public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {

            if (!mIsOnTimeChanged) {
                mIsOnTimeChanged = true;

                Calendar c = Calendar.getInstance();

                //get the selected day if it is before today allow AM and PM trick
                //else apply rules

                int selected_year = datePicker.getYear();
                int selected_month = datePicker.getMonth();
                int selected_day = datePicker.getDayOfMonth();

                int today = c.get(Calendar.DAY_OF_MONTH);
                int year = c.get(Calendar.YEAR);
                int month = c.get(Calendar.MONTH);

                int hour = c.get(Calendar.HOUR);
                hour += 12;
                int min = c.get(Calendar.MINUTE);

                //Check if user enter hh | mm | more than current reset the timePicker with the current time

                //http://stackoverflow.com/questions/2659954/timepickerdialog-and-am-or-pm

                if ((hourOfDay == hour | hour < hourOfDay | hourOfDay > hour | hour > hourOfDay | minute > min) && (selected_month == month && selected_day == today && selected_year == year)) {

                    int AM_PM_Value = hourOfDay;

                    Calendar datetime = Calendar.getInstance();

                    int hour_without_24 = (hour - 12);
                    if ((datetime.get(Calendar.AM_PM) == Calendar.AM) && (hourOfDay > hour_without_24)) {
                        //set AM
                        timePicker.setCurrentHour(hour - 12);
                    }

                    if (hourOfDay == (hour - 12) && minute > min) {
                        timePicker.setCurrentMinute(min);

                    }

                    if (hourOfDay > hour && datetime.get(Calendar.AM_PM) != Calendar.AM) {
                        timePicker.setCurrentHour(hour);

                        if (minute > min) {
                            timePicker.setCurrentMinute(min);

                        }
                    }

                } else if (selected_month != month | selected_day != today | selected_year != year) {

                } else if (hourOfDay == hour && minute > min) {
                    timePicker.setCurrentMinute(min);
                } else if (hourOfDay > hour) {
                    timePicker.setCurrentHour(hour);

                    if (minute > min) {
                        timePicker.setCurrentMinute(min);

                    }
                }
                //
                isTimePickerChanged = true;
                String AM_PM;
                if (hourOfDay < 12) {
                    AM_PM = "AM";
                } else {
                    AM_PM = "PM";
                }

                //to set as 12 hour
                time_format = (hourOfDay + ":" + minute + ":" + "00");

                if (hourOfDay > 12) {
                    hourOfDay = (hourOfDay - 12);
                }

                st_time = (hourOfDay + ":" + pad(minute) + " " + AM_PM);

                mIsOnTimeChanged = false;

            }

        }
    }); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-06-17T09:29:07.280

我以@Zarooka 的解决方案为起点。我想我发现了一个错误。如果您的开始时间已经超出范围，那么您将无法再移动它，因为任何“onChanged”都被拒绝。这就是为什么我扩展了 setMax 和 setMin 以便在设置最小值/最大值时进入有效范围。

```
package de.appdream.garooda.view;

import java.util.Calendar;
import java.util.Date;

import android.app.TimePickerDialog;
import android.content.Context;
import android.text.format.DateFormat;
import android.widget.TimePicker;

import java.lang.reflect.Field; 

public class GaroodaTimePickerDialog extends TimePickerDialog {

private int minHour = -1;
private int minMinute = -1;

private int maxHour = 25;
private int maxMinute = 61;

private int currentHour = 0;
private int currentMinute = 0;

    private Calendar calendar = Calendar.getInstance();
    //private DateFormat dateFormat;

public GaroodaTimePickerDialog(Context context, OnTimeSetListener callBack, int hour, int minute,
        boolean is24HourView) {
    super(context, callBack, hour, minute, is24HourView);

    currentHour = hour;
    currentMinute = minute;
    //dateFormat = DateFormat.getTimeInstance(DateFormat.SHORT);

    try {
        Class<?> superclass = getClass().getSuperclass();
        Field mTimePickerField = superclass.getDeclaredField("mTimePicker");
        mTimePickerField.setAccessible(true);
        TimePicker mTimePicker = (TimePicker) mTimePickerField.get(this);
        mTimePicker.setOnTimeChangedListener(this);
    } catch (NoSuchFieldException e) {
    } catch (IllegalArgumentException e) {
    } catch (IllegalAccessException e) {
    }
}

public void setMin(int hour, int minute) {
    minHour = hour;
    minMinute = minute;

    Calendar min = Calendar.getInstance();
    Calendar existing = Calendar.getInstance();

    min.set(Calendar.HOUR_OF_DAY, minHour);
    min.set(Calendar.MINUTE, minMinute);

    existing.set(Calendar.HOUR_OF_DAY, currentHour);
    existing.set(Calendar.MINUTE, currentMinute);

    if (existing.before(min)) {
        currentHour = minHour;
        currentMinute = minMinute;
        updateTime(currentHour, currentMinute);
    }
}

public void setMax(int hour, int minute) {
    maxHour = hour;
    maxMinute = minute;

    Calendar max = Calendar.getInstance();
    Calendar existing = Calendar.getInstance();

    max.set(Calendar.HOUR_OF_DAY, maxHour);
    max.set(Calendar.MINUTE, maxMinute);

    existing.set(Calendar.HOUR_OF_DAY, currentHour);
    existing.set(Calendar.MINUTE, currentMinute);

    if (existing.after(max)) {
        currentHour = maxHour;
        currentMinute = maxMinute;
        updateTime(currentHour, currentMinute);
    }

}

@Override
public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {

    boolean validTime = true;
    if (hourOfDay < minHour || (hourOfDay == minHour && minute < minMinute)){
        validTime = false;
    }

    if (hourOfDay  > maxHour || (hourOfDay == maxHour && minute > maxMinute)){
        validTime = false;
    }

    if (validTime) {
        currentHour = hourOfDay;
        currentMinute = minute;
    }

    updateTime(currentHour, currentMinute);
    updateDialogTitle(view, currentHour, currentMinute);
}

private void updateDialogTitle(TimePicker timePicker, int hourOfDay, int minute) {
    calendar.set(Calendar.HOUR_OF_DAY, hourOfDay);
    calendar.set(Calendar.MINUTE, minute);
    //String title = dateFormat.format(calendar.getTime());
    //setTitle(title);
}
} 
```

# ios - 未收到 Facebook 请求

> ID：13516395
> 
> 赞同：3
> 
> 时间：2012-11-22T16:02:20.510
> 
> 标签：ios, xcode, facebook

我有一个集成了 Facebook 请求的应用程序。当我向帐户发送请求时，通知会出现在 Facebook.com 网站的通知下，但不会出现在 IOS 上运行的移动 Facebook 应用程序上。如果我打开通知选项卡，我会看到网站上出现的所有通知，除了我的。这有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:18:36.850

您可能忘记将 iOS 应用程序的设置放入应用程序仪表板的应用程序设置中

如果没有配置 iOS 应用程序，则没有理由在 Facebook 的移动应用程序中显示请求，因为用户无法对其采取行动

# javascript - 如何更新 bootstrap-typeahead.js 中的源选项

> ID：13516396
> 
> 赞同：8
> 
> 时间：2012-11-22T16:02:20.557
> 
> 标签：javascript, jquery, twitter-bootstrap, bootstrap-typeahead

我正在使用 bootstrap-typeahead 以允许多项选择。这是[演示](http://jsfiddle.net/Sherbrow/BwDmM/3/)。

原始代码已由@Sherbrow [Twitter bootstrap typeahead 多个值更新](https://stackoverflow.com/questions/12662824/twitter-bootstrap-typeahead-multiple-values)

我的问题与以下用例有关：
插入`Alaska`值后，我想更新不再显示`Alaska`值的源。
有什么提示吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-22T16:11:53.280

我有同样的问题，这个会为你节省很多时间。我已经用我的代码示例更新了你的旧[jsFiddle 。](http://jsfiddle.net/BwDmM/62/)基本的事情是你需要做

```
var autocomplete = $('input').typeahead();
autocomplete.data('typeahead').source = newSource; 
```

`newSource`新数组在哪里。现在您只需要一个添加或删除元素的函数，或者您需要对它执行的任何操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-05-19T21:34:48.727

给定的答案都不适合我，我不得不销毁原来的 typeahead 实例并重新初始化它。

`$('input').typeahead('destroy').typeahead(options);`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T20:42:07.943

基于`updater`typeahead 的默认方法：

```
updater: function (item) {
  var pos = this.source.indexOf(item);
  if(pos != -1) {
    var newSource =
      this.source.slice(0,pos)
      .concat(this.source.slice(pos+1));
    this.source = newSource;
  }
  return item
} 
```

[具有多个值的演示（jsfiddle）](http://jsfiddle.net/Sherbrow/BwDmM/67/)

请记住，考虑到预输入已初始化，您可以从任何地方*访问此源*`$('sel').data('typeahead').source`

# html - 子元素覆盖父元素

> ID：13516399
> 
> 赞同：0
> 
> 时间：2012-11-22T16:02:37.003
> 
> 标签：html, css

基本上我的网站的布局方式是，我有一些元素在内容页面之外具有全宽背景（例如，让导航栏背景完全穿过页面）。所以基本上我决定做的是`div`在内容中创建另一个`div`，并且导航栏可以正常工作，但是对于网站的下一部分，由于某种原因，子元素覆盖了所有浏览器中的父元素。我不明白为什么它似乎适用于导航栏部分。

这是CSS

```
#top-slider {
width:100%;
height:400px;
background: #222; /* Show a solid color for older browsers */
background: -moz-linear-gradient(#fefefe, #f1f1f1);
background: -o-linear-gradient(#fefefe, #f1f1f1);
background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#fefefe), to(#f1f1f1)); /* older webkit syntax */
background: -webkit-linear-gradient(#fefefe, #f1f1f1);
-webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 1px 2px;
-moz-box-shadow: rgba(0, 0, 0, 0.4) 0px 1px 2px;
box-shadow: rgba(0, 0, 0, 0.4) 0px 1px 2px; 
float:left;
padding-bottom:20px;
position:relative;
width:980px;

}

#top-slider-full-bar {
position:absolute;
left:-9999px;
width:99999px;
background: #222; /* Show a solid color for older browsers */
background: -moz-linear-gradient(#fefefe, #f1f1f1);
background: -o-linear-gradient(#fefefe, #f1f1f1);
background: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#fefefe), to(#f1f1f1)); /* older webkit syntax */
background: -webkit-linear-gradient(#fefefe, #f1f1f1);
-webkit-box-shadow: rgba(0, 0, 0, 0.4) 0px 1px 2px;
-moz-box-shadow: rgba(0, 0, 0, 0.4) 0px 1px 2px;
box-shadow: rgba(0, 0, 0, 0.4) 0px 1px 2px; 
height:400px; 
```

}

这是网站， http: [//limerickchambers.hailstormcommerce.com](http://limerickchambers.hailstormcommerce.com)如您所见，导航栏似乎工作正常......我试过`z-index`但似乎没有效果。Limerickchambers.hailstormcommerce.com

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:09:32.400

考虑将您的 html 结构更改为如下所示：http: [//jsfiddle.net/KpTHz/](http://jsfiddle.net/KpTHz/)

这将使这一切更容易管理。

```
<div class="outer">
 <div class="inner">HEADER</div>
</div>

<div class="outer">
 <div class="inner">CONTENT</div>
</div>

<div class="outer">
 <div class="inner">FOOTER</div>
</div>

.outer {
 width:100%;
 background:#ccc;
}

.inner {
 width:920px;
 background:#999;
 margin:0 auto 20px;
 padding:20px;
} 
```

# jsf - web.xml 错误页面在 FileNotFoundException 的情况下不起作用

> ID：13516400
> 
> 赞同：0
> 
> 时间：2012-11-22T16:02:37.637
> 
> 标签：jsf, error-handling

我对海关错误页面及其异常类型有一些问题。我在`web.xml`这个错误页面中有；

```
<error-page>
    <exception-type>java.io.FileNotFoundException</exception-type>
    <location>/faces/error.xhtml</location>
</error-page> 
```

当我单击链接并且 JSF 文件不存在时会发生此错误。我的问题是发生此错误时，网页不会重定向到我的`error.xhtml`页面。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:24:29.800

仅`FileNotFoundException`当您实际请求的 URL 与`FacesServlet`. 所以想象一下`FacesServlet`被映射到`*.jsf`，然后打开`/somenotexistent.jsf`会在 Mojarra 的情况下确实抛出一个子类，`FileNotFoundException`它确实会匹配你的错误页面。

但是，如果您请求的 URL与 的 URL 模式*不*匹配`FacesServlet`，则该请求将由另一个 servlet 处理，通常是容器自己的`DefaultServlet`. 如果资源不存在，那么它通常会返回 404 而不是抛出异常。

您还想添加另一个错误页面来覆盖它：

```
<error-page>
    <error-code>404</error-code>
    <location>/faces/error.xhtml</location>
</error-page>
<error-page>
    <exception-type>java.io.FileNotFoundException</exception-type>
    <location>/faces/error.xhtml</location>
</error-page> 
```

但是，为了防止这种重复，您还可以考虑使用一个[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)，该过滤器捕获`FileNotFoundException`来自的任何实例，`FacesServlet`然后正确返回 404。JSF 实用程序库[OmniFaces](http://omnifaces.org)已经有这样一个过滤器[，`FacesExceptionFilter`](http://showcase.omnifaces.org/filters/FacesExceptionFilter) . 这样，您最终只能得到错误代码 404 上的错误页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T16:08:04.130

不，正如您编写的那样，当您的 servlet/JSP/JSF/whatever 抛出`FileNotFoundException`. 在 404 的情况下，您的 servlet 甚至没有被调用，因此它不会抛出任何东西。

用这个

```
<error-page>
  <error-code>404</error-code>
  <location>/the404_page.html</location>
</error-page> 
```

# python-sphinx - Sphinx 错误：未知指令类型“automodule”或“autoclass”

> ID：13516404
> 
> 赞同：90
> 
> 时间：2012-11-22T16:02:53.150
> 
> 标签：python-sphinx, autodoc

我需要使用 Sphinx 记录我的 Python 项目。但我不能使用`autodoc`.

当我配置我的项目时，我选择了“extension autodoc”选项，但现在如果我使用

```
.. autoclass:: Class 
```

我收到一个错误：

```
ERROR: Unknown directive type "autoclass" 
```

我配置了`PYTHONPATH`，现在好了。但是我已经有这个问题了。

我的索引文件是：

```
.. ATOM documentation master file, created by
   sphinx-quickstart on Thu Nov 22 15:24:42 2012.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Welcome to ATOM's documentation!
================================

Contents:

.. toctree::
   :maxdepth: 2

.. automodule:: atom

Indices and tables
==================

* :ref:`genindex`
* :ref:`modindex`
* :ref:`search` 
```

我需要有人告诉我如何解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2013-06-08T23:16:59.413

这样的事情我也经历过！要修复它，请转到 conf.py 中这样说的行：

```
extensions = ['sphinx.ext.todo', 'sphinx.ext.viewcode'] 
```

您的可能看起来会有所不同。无论如何，添加`'sphinx.ext.autodoc'`到列表中。例如

```
extensions = ['sphinx.ext.todo', 'sphinx.ext.viewcode', 'sphinx.ext.autodoc'] 
```

如果它是：

```
extensions = [] 
```

那么您将其更改为：

```
extensions = ['sphinx.ext.autodoc'] 
```

来源：[Sphinx 文档：错误：未知指令类型“程序输出”](https://stackoverflow.com/questions/12842285/sphinx-documentation-error-unknown-directive-type-program-output)

# ruby - 如何向嵌套哈希添加值？

> ID：13516407
> 
> 赞同：0
> 
> 时间：2012-11-22T16:03:06.827
> 
> 标签：ruby, hash

我有一个嵌套哈希：

```
hash = {
  "a" => "a",
  "b" => {
    "c" => "c",
    "d" => {
      "e" => "e"
    }
  }
} 
```

我有一个哈希：

```
new_value = {
  "b.d.e" => "new value"
} 
```

我需要某种“神奇”函数来替换 处的哈希值`hash["b"]["d"]["e"]`，例如：

```
magical_function(hash, new_value)
#=> hash = {
      "a" => "a",
      "b" => {
        "c" => "c",
        "d" => {
          "e" => "new value"
        }
      }
    } 
```

我不知道怎么做。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T16:07:22.307

如果以直截了当的方式实现它并不神奇：

```
merge_hash.each do |key, value|
  parts = key.split('.')
  leaf = parts.pop

  target = parts.inject(hash) do |h, k|
    h[k] ||= { }
  end

  target[leaf] = value
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:22:42.490

这是另一个解决方案：

```
class Hash
  def replace_value(*keys, value)
    current = self
    current = current[keys.shift] while keys.size > 1
    current[keys.last] = value
  end
end 
```

通过调用来调用`hash.replace_value("b","d","e", "new_value")`。

# windows - 在 Powershell 中将 X 文件从一个文件夹移动到另一个文件夹

> ID：13516414
> 
> 赞同：2
> 
> 时间：2012-11-22T16:03:51.120
> 
> 标签：windows, file, powershell

我有一个文件夹**A**，其中包含要处理的 75000 个文件。我旁边有 4 个文件夹（A、B、C、D），一次可以处理 3000 个文件。

我想要一个脚本从 A 获取 3000 个文件并将其放入 B。然后它应该再获取 3000 个文件并放入 C，然后是 D，​​最后是 E

以下是我到目前为止的代码。这需要 10 个文件并将它们移动到 B 中，但是它只是永远坐在那里，没有将任何文件放入 C、D 或 E 中。

有没有办法退出代码的 EnumerateFiles 部分？我只想移动它找到的第一个 X 文件，我不在乎 A 中有多少文件。

任何想法？

```
$dirBase = "\\networkDir\A\"
$dirProc1 = "\\networkDir\B\"
$dirProc2 = "\\networkDir\C\"
$dirProc3 = "\\networkDir\D\"
$dirProc4 = "\\networkDir\E\"

cd $dirBase

$directoryInfo1 = Get-ChildItem $dirProc1 | Measure-Object
$directoryInfo2 = Get-ChildItem $dirProc2 | Measure-Object
$directoryInfo3 = Get-ChildItem $dirProc3 | Measure-Object
$directoryInfo4 = Get-ChildItem $dirProc4 | Measure-Object

if ($directoryInfo1.count -eq 0) {
    MoveFiles $dirBase $dirProc1
} 
if ($directoryInfo2.count -eq 0) {
    MoveFiles $dirBase $dirProc2
} 
if ($directoryInfo3.count -eq 0) {
    MoveFiles $dirBase $dirProc3
} 
if ($directoryInfo4.count -eq 0) {
    MoveFiles $dirBase $dirProc4
} 

function MoveFiles([string]$srcDir, [string]$dest)
{
    $FileLimit = 10    
    $Counter = 0

    [IO.Directory]::EnumerateFiles($srcDir) | Where-Object {$Counter -lt $FileLimit} | %{ 
    #Get-ChildItem $srcDir | Select-Object -first $FileLimit | %{ 

        Move-Item $_ -destination $dest
        $Counter++

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:25:30.687

```
Get-ChildItem $dirProc1 | select -first 3000 
```

?

# c# - 错误：iisexpress.exe - 断言失败

> ID：13516420
> 
> 赞同：3
> 
> 时间：2012-11-22T16:04:14.007
> 
> 标签：c#

我正在尝试学习 mvc。我在此站点 (asp.net) 中使用 Pluralsight 培训视频。
在本视频中，我们创建了一个`DBContext`名为`OdeToFoodDb`：

```
public class OdeToFoodDb: DbContext
{
    public DbSet<Restaurant> Restaurants { get; set; }
    public DbSet<Review> Reviews { get; set; }

    protected override void OnModelCreating(System.Data.Entity.ModelConfiguration.ModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Restaurant>()
            .HasMany(resturant => resturant.Reviews)
            .WithRequired(review => review.Resturant);
        base.OnModelCreating(modelBuilder);
    }
} 
```

问题是当我创建这个类的新对象时：

```
OdeToFoodDb _db = new OdeToFoodDb(); 
```

我收到以下错误：

```
iisexpress.exe - Assertion failed.
Expression: primitiveType != null
Description: Assertion failed: primitiveType != null 
```

我怎样才能避免这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:10:08.763

尝试将 EntityFramework 更新到最新版本或为您的项目使用 .NET4。

[这篇博文可能是相关的。](http://blog.luppes.com/2012/09/15/mvc3-application-failing-after-asp-net-4-5-install/)

# blackberry - “正在播放...”黑莓智能手机上的曲目信息

> ID：13516422
> 
> 赞同：3
> 
> 时间：2012-11-22T16:04:21.540
> 
> 标签：blackberry, java-me, media-player

我正在为 Blackberry OS 7 开发基于 java 的应用程序。可能的功能之一是查看当前播放的音频文件的名称。问题：是否可以仅使用 Java API 从系统获取此信息？是否有可能获得此类信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T13:18:58.570

我认为没有任何直接的方法可以获取此信息，至少没有任何记录在案的方法。不幸的是，从这个意义上说，黑莓的 Java API 有点傻。

如果您愿意，您可能会做一些临时性的尝试来尝试获取该信息，但这不会是无痛的。一个例子可以是抓取“正在播放”应用程序的 UI 元素，该应用程序在播放期间在后台运行以进行任何更改并反映在您的应用程序中，但话又说回来，它不会完全优雅。

# c - 用openGL截屏并保存为png

> ID：13516424
> 
> 赞同：5
> 
> 时间：2012-11-22T16:04:23.727
> 
> 标签：c, opengl, gdlib

我正在尝试截取全屏截图并将其保存为 png。[我在这里](http://code.google.com/p/fds-smv/source/browse/trunk/FDS/trunk/SMV_5/source/smokeview/renderfile.c?r=3037&spec=svn3037)找到了一个代码并对其进行了一些修改。对于屏幕截图，我使用 openGL 和 Glut，并在 png 中保存 c 的 gd 库。我得到的只是一个黑色的png，我不知道为什么。我在stackoverflow中搜索并找到了一些帖子，但不幸的是它们没有帮助。其中之一是使用 glReadBuffer(GL_FRONT); 而不是 glReadBuffer(GL_BACK); 我尝试了他们两个都没有成功。这是我的代码：

```
int SVimage2file(char *filename){
    int width = glutGet(GLUT_SCREEN_WIDTH);
    int height = glutGet( GLUT_SCREEN_HEIGHT);
    FILE *png;
    GLubyte *OpenGLimage, *p;
    gdImagePtr image;
    unsigned int r, g, b;
    int i,j,rgb;

    png = fopen(filename, "wb");

    if (png == NULL) {
        printf("*** warning:  unable to write to %s\n",filename);
        return 1;
    }

    OpenGLimage = (GLubyte *) malloc(width * height * sizeof(GLubyte) * 3);
    if(OpenGLimage == NULL){
        printf("error allocating image:%s\n",filename);
        exit(1);
    }

    printf("Saving to: %s .\n",filename);
    glPixelStorei(GL_PACK_ALIGNMENT, 1);
    glReadBuffer( GL_FRONT);
    glReadPixels(0, 0, width, height, GL_RGB, GL_UNSIGNED_BYTE, OpenGLimage);
    p = OpenGLimage;
    image = gdImageCreateTrueColor(width,height);

    for (i = height-1 ; i>=0; i--) {
        for(j=0;j<width;j++){
                r=*p++; g=*p++; b=*p++;
                rgb = (r<<16)|(g<<8)|b;
                //printf("the rgb color %d\n", rgb );
                gdImageSetPixel(image,j,i,rgb);
        }
    }

    gdImagePng(image,png);
    fclose(png);
    gdImageDestroy(image);
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:57:03.957

您可以使用[魔鬼图像库](http://openil.sourceforge.net/)并通过以下方式截取截图：

```
void takeScreenshot(const char* screenshotFile)
{
    ILuint imageID = ilGenImage();
    ilBindImage(imageID);
    ilutGLScreen();
    ilEnable(IL_FILE_OVERWRITE);
    ilSaveImage(screenshotFile);
    ilDeleteImage(imageID);
    printf("Screenshot saved to: %s\n", screenshotFile);
}

takeScreenshot("screenshot.png"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-23T09:22:42.227

如果你不拒绝使用 C++ 库，你应该试试[PNGwriter](http://pngwriter.sourceforge.net/)！它逐像素写入图片及其RGB值。由于 PNGwriter 从左上角开始，而 glReadPixels() 从左下角开始，因此您的代码如下：

```
GLfloat* OpenGLimage = new GLfloat[nPixels];
glReadPixels(0.0, 0.0, width, height,GL_RGB, GL_FLOAT, OpenGLimage);
pngwriter PNG(width, height, 1.0, fileName);
size_t x = 1;   // start the top and leftmost point of the window
size_t y = 1;
double R, G, B;
for(size_t i=0; i<npixels; i++)
{
      switch(i%3) //the OpenGLimage array look like [R1, G1, B1, R2, G2, B2,...]
     {
           case 2:
                 B = (double) pixels[i]; break;
           case 1:
                 G = (double) pixels[i]; break;
           case 0:
                 R = (double) pixels[i];
                 PNG.plot(x, y, R, G, B);
                 if( x == width )
                 {
                       x=1;
                       y++;
                  }
                  else
                  { x++; }
                  break;
     }
}
PNG.close(); 
```

PS。我也尝试过 libgd，但似乎只能将一个图像文件（在硬盘或内存中）转换为另一种格式的图像。但我认为当您想将许多 PNG 文件转换为 GIF 格式以创建 GIF 动画时，它仍然很有用。

# deployment - Capistrano 部署：设置有效，但不部署：检查

> ID：13516427
> 
> 赞同：3
> 
> 时间：2012-11-22T16:04:31.880
> 
> 标签：deployment, capistrano

用一个简单的食谱测试 capistrano。

```
$ cap deploy:setup
  * executing `deploy:setup'
  * executing "sudo -p 'sudo password: ' mkdir -p /u/apps/ [..]
    [..] 
```

`deploy:setup`按预期工作。

**然而**

```
$ cap deploy:check
  * executing `deploy:check'
  * executing "test -d /u/apps/[..]
    [..] 
```

运行时`deploy:check`出现以下错误：

```
The following dependencies failed. Please check them and try again:
--> You do not have permissions to write to `/u/apps/
[..]
--> `/u/apps/app/shared is not writable [..] 
```

似乎 capistrano 在`deploy:check`模式下没有使用 sudo 。

**我不明白！**

虽然在`deploy:setup`整个目录结构中是由 capistrano 创建的而没有任何问题？

为什么 capistrano 不使用 sudo `deploy:check`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T15:49:23.990

我也遇到了这个问题，结果发现 capistrano 正在创建`<user>`组下的所有文件夹，共享文件夹除外。SSH 到您的服务器并进行长列表`ls -l`。如果您看到 - root - root - 共享文件夹，您只需要更新文件夹的权限：

```
sudo chown <user> shared
sudo chgrp <user> shared 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T00:13:50.250

我遇到了[同样的问题](https://stackoverflow.com/q/15144815/341929)：诀窍是明确配置 Capistrano 不使用`sudo`。你可以在你的文件
中关闭它：`deploy.rb`

```
set :use_sudo, false 
```

* * *

如果你需要使用 sudo，那么在你的命令中使用[**sudo** DSL Action Invocation](https://github.com/capistrano/capistrano/wiki/2.x-DSL-Action-Invocation-Sudo)怎么样：

```
run "#{sudo} apachectl restart" 
```

# smtp - 邮件中继器如何不向已收到的收件人发送邮件？

> ID：13516428
> 
> 赞同：1
> 
> 时间：2012-11-22T16:04:33.477
> 
> 标签：smtp, emailrelay

我在想。

假设我有一个交换服务器（域可以是 me@company.com），另外，我有一个中继服务器，它接受对 Internet 域（gmail/yahoo/etc）的请求。

假设我将邮件发送到：（you@company.com; him@gmail.com） - 来自域中的用户（me@company.com）

邮件被发送到交换服务器，然后交换组域（company.com 和 gmail.com）=> 它将邮件放入**you@company.com 邮箱**。

然后，exchange 看到需要发送到 him@gmail.com，所以会发送到**中继服务器**。

**中继服务器**将收到 SMTP 请求：

来自：me@company.com

至：you@company.com；他@gmail.com

* * *

问题是 - smtp 中继服务器如何知道不将其发送到 you@company.com - 从而导致收到重复的邮件？

另外，gmail服务器如何知道不要尝试再次发送它收到的邮件？（因为他们只收到 smtp 请求，类似于发送邮件的客户端）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T20:08:29.713

邮件的内容不被交换或中继解析以确定邮件应该去哪里。在这种情况下，每个人都在互相谈论 SMTP，并使用 RCPT 协议消息指定收件人。所以你的邮件客户端告诉exchange 两个RCPT，exchange 决定其中一个是远程的，然后说一个RCPT 给relay，依此类推。[本文档](ftp://ftp.rfc-editor.org/in-notes/rfc5321.txt)指定了 SMTP 协议，您可以在其中阅读有关 RCPT 动词的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T20:04:34.480

您看到的标头不用于传递消息。相反，SMTP 定义了一个称为*信封*的概念，它具有一组完全不同的标头。作为一个常见的例子，这也是 Bcc: 的工作方式；收件人地址被复制到信封中，然后从信封内的邮件​​中删除。

邮件传递时，通常会将信封发件人复制到`Return-Path:`标头中，有时您可以看到信封收件人信息复制到`Received:`标头中。

在邮件服务器决定消息应该发送到哪些目的地时，通常对于每个不同的目的地都有一个消息副本（假脱机文件，队列条目，你有什么）。因此，如果您从 you@company 发送到 me@company、you@private 和friend@gmail，第一台服务器可能会确定外部地址都应该发送到同一个出站中继，而内部副本在本地传递。然后中继同样决定它需要联系两个不同的目的地，因此单个传入消息被复制到两个出站消息，一个到 you@private，另一个到friend@gmail。

# mysql - mysql索引问题

> ID：13516430
> 
> 赞同：1
> 
> 时间：2012-11-22T16:04:39.347
> 
> 标签：mysql

我的表有 1,000,000 行和 4 列：

```
id  cont    stat   message

1   rgrf       0   ttgthyhtg
2   frrgt      0   tthyrt
3   4r44       1   rrttttg
... 
```

我正在执行一个非常慢的选择查询，即使我已经完成了索引

```
 SELECT * FROM tablea WHERE stat='0' order by id LIMIT 1 
```

这个查询让我`mysql`很慢，我用 mysql explain 查了一下，发现这个

```
 explain SELECT * FROM tablea WHERE stat='0' order by id LIMIT 1 
```

我对输出感到震惊，但我不知道如何优化它。

```
id  select_type  table   type  possible_keys  key  key_len  ref      rows  Extra
 1  SIMPLE       tablea  ref   stat           stat       4  const  216404  Using where 
```

有 216,404 行需要优化，我必须减少到 1 或 2，但如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:49:12.570

我建议您尝试在 (stat, id) 上创建复合索引。这可能使您的搜索/订单操作得到优化。当然，有一个缺点：插入和更新会产生额外的开销。

```
CREATE INDEX ON tablea (stat,id) USING BTREE 
```

试试看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:53:44.417

问题是 MySQL 在查询中每个表只能使用一个索引，`stat`在您的情况下这是索引。因此，在`ORDER BY`不使用索引的情况下执行，这在 1M 行上非常慢。尝试以下操作：

*   隐式使用正确的索引： `SELECT * FROM tablea USE INDEX(PRIMARY) WHERE stat='0' order by id LIMIT 1`

*   创建一个复合索引，就像上面所说的 Ollie Jones 一样。

# android - 从 ListView 中选择项目（Json 数据）

> ID：13516432
> 
> 赞同：0
> 
> 时间：2012-11-22T16:04:48.280
> 
> 标签：android, json, rest, listview, listactivity

我正在尝试实现一个简单的 android REST 客户端，但在理解如何在我的活动之间传递数据时遇到了一些问题。

我有这个 ListActivity（我正在使用 Spring REST 模板）：

```
 public class MainActivity extends ListActivity
{
    protected static final String TAG = MainActivity.class.getSimpleName();
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //setContentView(R.layout.activity_main);
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        Toast.makeText(this, "You have selected" + position + id ,
                Toast.LENGTH_SHORT).show();
    }

    @Override
    protected void onStart() {

        super.onStart();
        new DownloadClientesTask().execute();
    }

    private void refreshClientes(List<Cliente> clientes) {
        if (clientes == null) {
            return;
        }

        ClientesListAdapter adapter = new ClientesListAdapter(this, clientes);
        setListAdapter(adapter);
    }

    private class DownloadClientesTask extends AsyncTask<Void, Void, List<Cliente>> {

        @Override
        protected List<Cliente> doInBackground(Void... params) {
            final String url = "http://192.168.1.119/~henry/api_slim/index.php/customers";

            try {
                // Set the Accept header for "application/json"
                HttpHeaders requestHeaders = new HttpHeaders();
                List<MediaType> acceptableMediaTypes = new ArrayList<MediaType>();
                acceptableMediaTypes.add(MediaType.APPLICATION_JSON);
                requestHeaders.setAccept(acceptableMediaTypes);

                // Populate the headers in an HttpEntity object to use for the request
                HttpEntity<?> requestEntity = new HttpEntity<Object>(requestHeaders);

                // Create a new RestTemplate instance
                RestTemplate restTemplate = new RestTemplate();
                restTemplate.getMessageConverters().add(new MappingJacksonHttpMessageConverter());

                // Perform the HTTP GET request
                ResponseEntity<Cliente[]> responseEntity = restTemplate.exchange(url, HttpMethod.GET, requestEntity,
                        Cliente[].class);

                // convert the array to a list and return it
                return Arrays.asList(responseEntity.getBody());
            } catch (Exception e) {
                // TODO Auto-generated catch block
                Log.e(TAG, e.getMessage(), e);
            }

            return null;

        }

        @Override
        protected void onPostExecute(List<Cliente> result) {

            refreshClientes(result);
        }

    } 

} 
```

这是我的 listAdapter ：

```
public class ClientesListAdapter extends BaseAdapter{

    private List<Cliente> clientes;
    private final LayoutInflater layoutInflater;

    public ClientesListAdapter(Context context, List<Cliente> clientes) {
        this.clientes = clientes;
        this.layoutInflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return this.clientes != null ? clientes.size() : 0;
    }

    @Override
    public Cliente getItem(int position) {
        return this.clientes.get(position);
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if (convertView == null) {
            convertView = this.layoutInflater.inflate(R.layout.cliente_list_item, parent, false);
        }

        Cliente cliente = getItem(position);
        if (cliente != null) {
            TextView t = (TextView) convertView.findViewById(R.id.name);
            t.setText(cliente.getFirstname());
        }

        return convertView;
    }

} 
```

这是我得到的数据的 POJO 类：

```
public class Cliente {
    private Integer id_customer; 
        private String firstname;
        public Integer getId_customer() {
        return id_customer;
    }
    public void setId_customer(Integer id_customer) {
        this.id_customer = id_customer;
    }
        public String getFirstname() {
        return firstname;
    }
    public void setFirstname(String firstname) {
        this.firstname = firstname;
    }
} 
```

当我从 listView 中选择一个元素时，我想在另一个活动或片段上显示有关此元素的特定详细信息，但我不知道如何从列表中获取此元素的 customer_id，我是否必须在处理时保存它响应？我需要使用内容提供者或数据库来提供这种行为吗？我真的很困惑，在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:17:03.903

您的列表在适配器中：

```
private List<Cliente> clientes; 
```

在 onListItemClick 中，您可以使用 position 参数从此列表中获取 Cliente。

当您调用 startActivity 时，您将信息传递给另一个活动，并传递给它一个 Intent。Intent 可能有其他信息，在您的情况下，您可以将 customer_id 设置为额外的 int，例如：

```
intent.putExtra(EXTRA_CUSTOMER_ID, customer_id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:15:31.113

获取单击的项目的位置，并从数组列表中获取该位置存在的对象，并使用它来获取所需的详细信息。

利用

```
@Override
    protected void onListItemClick(ListView l, View v, int position, long id) {
        Toast.makeText(this, "You have selected" + position + id ,
                Toast.LENGTH_SHORT).show();
      // use  this.clientes.get(position) and pass it to the next activity or fragment  using putextras to where you need to pass and display this in the destination end using the same object by getting it using getExtra()

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T09:32:45.200

[这里](https://stackoverflow.com/questions/3848148/sending-information-with-intent-putextra)有关于如何将数据从一个活动传递到另一个活动的很好的例子，在[活动之间传递对象](https://stackoverflow.com/questions/2736389/how-to-pass-object-from-one-activity-to-another-in-android)。您可能想先看看这些链接上的解决方案。

请参阅下面的示例，该示例可以使您走上正轨。

列出适配器类：

```
public class ClientesListAdapter extends BaseAdapter{

    //private members
    private List<Cliente> clientes;

    //adapter position - not used for this example
    public int adapterPosition;

    //context of app
    private Context mContext;

    //default constructor
    public ClientesListAdapter(Context context, List<Cliente> clientes) {

        //context pointer
        this.mContext = context;

        //alloc
        this.clientes = new ArrayList<Cliente>(clientes.size());
        this.clientes.addAll(clients);
    }

    //Holder for events and dates (memory management)
    public static class ViewHolder{
        TextView myTextView;//this is actually findViewById(R.id.name) @see getView() method
    }

    //generated method
    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return this.clientes != null ? clientes.size() : 0;
    }

    //generated method
    @Override
    public Cliente getItem(int position) {
        return this.clientes.get(position);
    }

    //generated method
    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    //get client's id
    public int getClienteId(int position){
        return this.clientes.get(position).getClienteId();
    }

    //get client's id without passing the position
    public int getClienteId(){
        return this.clientes.get(adapterPosition).getClienteId();
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        //row is actually convertView (the current view)
        View row = convertView;
        //holds our view elements
        ViewHolder holder;

        //if row is null 
        if(row == null){
            //inflate layout to get our view elements
            LayoutInflater inflater = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            row = inflater.inflate(com.yourapp.R.layout.my_layout, parent, false);//your layout here, modify code
            //set up the holder
            holder = new ViewHolder();
            holder.myTextView = (TextView) row.findViewById(com.yourapp.R.id.name);

            //give the row a tag (holder)
            row.setTag(holder);

        }else{
            //row is not null we can see it (no need to allocate memory)
            holder = (ViewHolder) row.getTag();
        }

        //get your cliente object
        Cliente cliente = this.clientes.get(position);
        if (cliente != null) {
            holder.myTextView.setText(cliente.getFirstname());
        }

        //copy position
        adapterPostion = position;

        return convertView;
    }

} 
```

您会看到我们使用 ViewHolder 类进行内存管理。这是在列表适配器中保存视图元素的好习惯。您可以找到有关列表视图的更多信息，由 [Romain Guy - The World of ListViews](http://www.youtube.com/watch?v=wDBM6wVEO70)解释。

从您的 MainActivity 分配适配器并点击获取您的项目：

```
//---- code --- //
ListView myListView = (ListView)findViewById(R.id.mylistview);//or you may use ListActivity
ClientesListAdapter adapter = new ClientesListAdapter(this, clientes);//"this" or "getApplicationContext()"
myListView.setAdapter(adapter);
adapter.notifyDataSetChanged();//notify
// ---- code --- //
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Toast.makeText(this, "You have selected" + position + id ,
            Toast.LENGTH_SHORT).show();

    Intent intent = new Intent(MyActivity.this, ActivityB.class);
    intent.putInt("cliente_id",adapter.getClienteId());
    startActivity(intent);
} 
```

另一个例子是在适配器中实现一个接口，如下所示：

```
//--code//
//Interface method
private OnSaveEditsListener saveEditsListener = null;
public void setOnSaveEditsListener(OnSaveEditsListener l) {
    saveEditsListener = l;
}
//--code//

    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {

        //--code--//

        //get clicked position of calendar (get clicked day)
        convertView.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                v.requestFocusFromTouch();
                currentAgendaPosition = position;
                try{
                    saveEditsListener.onSaveEdits();
                }catch(Exception ex){
                    ex.printStackTrace();
                }
            }
        });

        //returns current row
        return row;
    }
    //--code--// 
```

从您的 MainActivity 开始第二个活动，如下所示：

```
adapter.setOnSaveEditsListener(new OnSaveEditsListener() {

    @Override
    public void onSaveEdits() {
        //Start activity from here
        //--code--//
        startActivity(intent);
    }
}); 
```

# python - 从 html 文档中保存表格

> ID：13516434
> 
> 赞同：1
> 
> 时间：2012-11-22T16:04:49.627
> 
> 标签：python

我尝试将文档中的表格保存为目录下的文件，如下所示：

```
for table in tables:
    tableString = html.tostring(table)
    fileref=open('c:\\Users\\ahn_133\\Desktop\\appleTables\\Apple-' + str(count) + '.htm', 'w')
    fileref.write(tableString)
    fileref.close()
    count+=1 
```

但是，我不断收到如下错误：

```
Traceback (most recent call last):
  File "<pyshell#27>", line 4, in <module>
    fileref.write(tableString)
TypeError: must be str, not bytes 
```

我正在使用 Python 3.3 并安装了 lxml-3.0.1.win32-py3.3.‌exe

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:15:50.197

lxml 的`tostring`方法返回一个*字节*字符串 ( `bytes`)，因为它已经被编码。这是必要的，因为 XML/HTML 文档可以指定自己的编码，而且最好是正确的！

只需以二进制模式打开文件：

```
for table in tables:
    tableString = html.tostring(table)
    filename = r'c:\Users\ahn_133\Desktop\appleTables\Apple-' +str(count)+ '.htm'
    with open(filename, 'wb') as fileref:
        #                 ^
        fileref.write(tableString)
    count+=1 
```

# php - 调用未定义的函数 ZipArchive

> ID：13516437
> 
> 赞同：1
> 
> 时间：2012-11-22T16:04:58.513
> 
> 标签：php, zip, ziparchive

我似乎无法使 zipArchive 工作。我要求我的网络主机启用 ZLib，他告诉我他做到了。当我使用 phpinfo();

```
I get this:

Zlib Support: enabled

Stream Wrapper support: compress.zlib://

Stream Filter support: zlib.inflate, zlib.deflate

Compiled Version: 1.2.3

Linked Version: 1.2.3 
```

我真的迷路了。我不知道该怎么办了。

编辑：这是我的简单代码

```
$path = plugin_dir_path(__FILE__); 
$zip = new ZipArchive;
if ($zip->open('test.zip') === TRUE) {
    $zip->extractTo($path);
    $zip->close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:32:33.177

一些东西：

*   `zip`并且`zlib`不一样；
*   [`ZipArchive`](http://php.net/manual/en/class.ziparchive.php)不是一个函数，它是一个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:33:25.343

如果要操作 ZIP 文件，则需要[Zip](http://es1.php.net/manual/en/book.zip.php)扩展名，而不是[Zlib](http://es2.php.net/manual/en/book.zlib.php)。

压缩：

> 使您能够透明地读取或写入**ZIP**压缩档案

兹库：

> 使您能够透明地读写**gzip** (.gz) 压缩文件

此外，如果您收到*Call to undefined function ZipArchive*错误消息，则您的代码（您未显示）不可能正确，因为[ZipArchive](http://es1.php.net/manual/en/class.ziparchive.php)是一个**类**，而不是一个函数。

# github - 没有 composer.json 的作曲家

> ID：13516438
> 
> 赞同：1
> 
> 时间：2012-11-22T16:05:02.637
> 
> 标签：github, composer-php

是否可以通过没有 composer.json 的 github 上的 composer 请求项目（等[https://github.com/sebastianbergmann/phpcpd](https://github.com/sebastianbergmann/phpcpd)）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-04T06:35:50.397

实际上这个存储库有一个 composer.json 和一个关于 packagist 的条目：[https ://packagist.org/packages/sebastian/phpcpd](https://packagist.org/packages/sebastian/phpcpd)

所以在你的 composer.json 中要求它就可以了。:)

# mysql - 尽管排序时有索引，但 MySQL 查询使用文件排序

> ID：13516440
> 
> 赞同：2
> 
> 时间：2012-11-22T16:05:04.913
> 
> 标签：mysql, sql, join, indexing

**编辑：** 我让查询变得更简单只是为了测试：

```
select *
from table1 where date >= '2012-02-02' order by date, col_2 desc 
```

我在 date 和 col_2 上有复合索引，但是当我对查询进行解释时，它显示：

```
+----+-------------+------------------+-------+--------------------------+-----------------+---------+------+------+-----------------------------+
| id | select_type | table            | type  | possible_keys            | key             | key_len | ref  | rows | Extra                       |
+----+-------------+------------------+-------+--------------------------+-----------------+---------+------+------+-----------------------------+
|  1 | SIMPLE      | table1           | range | col_2_date, date         | col_2_date      | 4       | NULL | 4643 | Using where; Using filesort |
+----+-------------+------------------+-------+--------------------------+-----------------+---------+------+------+-----------------------------+ 
```

如果我在 col_2 和 date 列上有索引，为什么 mySQL 使用文件排序，我该如何防止它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:53:55.547

答案是按照您创建索引的相同顺序对结果进行排序..例如，如果索引是 (col_1, col_2) 然后使用`... order by col_1 desc, col_2 desc`or`... order by col_1 asc, col_2 asc`而不是`... order by col_1 asc, col_2 desc`or`order by col_2, col_1`例如。

# python - 使 NaN 在颜色图上变成不同的颜色

> ID：13516442
> 
> 赞同：0
> 
> 时间：2012-11-22T16:05:16.473
> 
> 标签：python, matplotlib

我有一个与[这个问题](https://stackoverflow.com/questions/2578752/how-can-i-plot-nan-values-as-a-special-color-with-imshow-in-matplotlib)类似的问题，我已经尝试了这篇文章中提供的解决方案，但是当我运行代码时，我收到以下错误：

> 警告（来自警告模块）：
> 文件“/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages/numpy/ma/core.py”，第3785行
> warnings.warn（“警告：将蒙面元素转换为 nan。”）
> 用户警告：警告：将蒙面元素转换为 nan。

有谁知道是什么原因造成的，我该如何解决？
如果需要，我可以发布我的代码，但我应该警告每个人它依赖于从文本文件中读取的数据。

# tsql - 创建前 10 名，但在其他中包含除前 9 名之外的所有内容

> ID：13516443
> 
> 赞同：0
> 
> 时间：2012-11-22T16:05:17.943
> 
> 标签：tsql, common-table-expression

我想做的是有一个前 10 名，但第 10 个条目被称为“其他”，其中所有内容的总和前 9 名的总和有一个总数。所以基本上它看起来像这样：

```
ReportingDate   FundCode    Currency            Duration Contribution   Percentage
31/10/2012      1111        Malaysian Ringgit   0.5                     14.6
31/10/2012      1111        Turkish Lira        0.3                     13.5
31/10/2012      1111        Russian Rouble      0.5                     11.9
31/10/2012      1111        Indunesian Rupiah   0.6                     11.7
31/10/2012      1111        Mexican Peso        0.6                     11.7
31/10/2012      1111        Polish Zloty        0.3                     10.2
31/10/2012      1111        Mexican Peso        0.4                     10.1
31/10/2012      1111        Polish Zloty        0.3                      9.9
31/10/2012      1111        South African Rand  0.2                      5.8
31/10/2012      1111        Brazilian Real      0.3                      2.0
31/10/2012      1111        Other               0.6                     -1.4
31/10/2012      1111        Total               4.6                    100.0 
```

我的代码目前如下所示：

```
;;WITH CTE AS
(
SELECT 
    ReportingDate
,   PortfolioID
,   DV.dmv_nme AS Currency
,   RANK() OVER (PARTITION BY PortfolioID ORDER BY SUM(Percentage) DESC) AS [Rank]
,   ISNULL(CAST(SUM(DurationContribution)/100.0 AS DECIMAL(22,1)),0)    AS [Duration Contribution]
,   CAST(SUM(Percentage) AS DECIMAL(22,1))  AS [Weight]

FROM @Worktable as WT

INNER JOIN dw_domain_value AS DV
    ON DV.dmv_value = WT.Currency
    AND DV.data_cls_num = 2

GROUP BY    WT.ReportingDate
    ,   WT.PortfolioID
    ,   DV.dmv_nme
)

SELECT 
ReportingDate
, PortfolioID
, Currency
, [Rank]
, [Duration Contribution]
, [Weight]
FROM CTE
WHERE [Rank] <= 10
ORDER BY ReportingDate, PortfolioID, [Rank], [Weight] DESC 
```

所以这给了我前10名的罚款。那么我怎么能得到它，以便最后的第 10 行是“其他”，除了前 9 行之外的所有内容，最后还包括总数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T05:05:11.643

这是一种解决方案。但是您可以将其移至 CTE 以获得更好的性能。

```
;;WITH CTE AS
(
SELECT 
ReportingDate
,PortfolioID
,DV.dmv_nme AS Currency
,RANK() OVER (PARTITION BY PortfolioID ORDER BY SUM(Percentage) DESC) AS [Rank]
,ISNULL(CAST(SUM(DurationContribution)/100.0 AS DECIMAL(22,1)),0) AS [Duration Contribution]
,CAST(SUM(Percentage) AS DECIMAL(22,1))  AS [Weight]

FROM @Worktable as WT

INNER JOIN dw_domain_value AS DV
ON DV.dmv_value = WT.Currency
AND DV.data_cls_num = 2

GROUP BY    WT.ReportingDate
,   WT.PortfolioID
,   DV.dmv_nme
)    

SELECT 
ReportingDate
, PortfolioID
, CASE WHEN [Rank] <= 10 THEN Currency ELSE 'Total' END As Currency
, SUM([Duration Contribution]) As [Duration Contribution]
, SUM([Weight]) As [Weight]
FROM CTE
GROUP BY
ReportingDate
, PortfolioID
, CASE WHEN [Rank] <= 10 THEN Currency ELSE 'Total' END As Currency
WITH ROLLUP
ORDER BY ReportingDate, PortfolioID, [Rank], [Weight] DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T11:21:18.280

为此，我决定不能使用 CTE，因此最终不得不将这些部分逐节插入临时表中，如下所示：

```
/* Include only top 9 */
INSERT INTO @FinalOutput
SELECT 
        ReportingDate
    ,   PortfolioID
    ,   PortfolioNme
    ,   Currency
    ,   [Rank]
    ,   DurationContribution
    ,   [Weight]
FROM @WorktableGrouped

WHERE [Rank] <= 9

ORDER BY ReportingDate, PortfolioID, [Rank], [Weight] DESC

/* Aggregate everything outside the top 9 into other */
INSERT INTO @FinalOutput
SELECT 
        ReportingDate
    ,   PortfolioID
    ,   PortfolioNme
    ,   'Other'         AS Currency
    ,   10              AS [Rank]
    ,   SUM(DurationContribution) AS DurationContribution
    ,   SUM([Weight])   AS [Weight]
FROM @WorktableGrouped

WHERE [Rank] > 9

GROUP BY ReportingDate, PortfolioID, PortfolioNme

ORDER BY ReportingDate, PortfolioID, [Rank], [Weight] DESC

SELECT * FROM @FinalOutput

/* Final Select with roll up for total per portfolio */
SELECT 
    ReportingDate
,   PortfolioID
,   PortfolioNme

,   CASE 
        WHEN GROUPING_ID(ReportingDate, PortfolioID, PortfolioNme, Currency, [Rank]) = 3 THEN 'Total'
        ELSE Currency
    END                                                         AS Currency

,   CASE 
        WHEN GROUPING_ID(ReportingDate, PortfolioID, PortfolioNme, Currency, [Rank]) = 3 THEN 11
        ELSE [Rank]
    END                                                         AS [Rank]

,   ISNULL(CAST(SUM(DurationContribution) AS DECIMAL(22,1)),0)  AS [Duration Contribution]  
,   CAST(SUM([Weight]) AS DECIMAL(22,1))                        AS [Weight]
--, GROUPING_ID(ReportingDate, PortfolioID, PortfolioNme, Currency, [Rank])

FROM @FinalOutput

GROUP BY ReportingDate
, PortfolioID
, PortfolioNme
, Currency
, [Rank] WITH ROLLUP

HAVING GROUPING_ID(ReportingDate, PortfolioID, PortfolioNme, Currency, [Rank]) IN (0,3)

ORDER BY ReportingDate, PortfolioID, [Rank] 
```

# azure - Team Foundation Service 通过多个分支发布到 Azure

> ID：13516444
> 
> 赞同：1
> 
> 时间：2012-11-22T16:05:18.037
> 
> 标签：azure, tfs, publishing, azure-devops

我目前正在将 Team Foundation Service 与 Windows Azure 结合使用。我在 Azure 中创建了一个网站并设置了 TFS 发布。

除了我想知道如何配置不同的分支之外，一切都运行良好。

[本文](http://www.bradygaster.com/multiple-environments-with-windows-azure-web-sites)解释了如何使用 Git 配置不同的网站以指向不同的分支。它说：

> 在此示例中，我将使用 GitHub.com 来管理我的源代码。您不必为此使用 GitHub.com，因此，如果您是 Git 新手，请不要惊慌，您还有其他选择，例如 CodePlex、BitBucket 或 **TFS**。哎呀，如果您愿意，您甚至可以自动化 FTP 部署。

但是，我找不到 TFS 发布配置的分支选项。我错过了什么吗？这是 Git 独有的功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T17:16:33.917

在网上搜索并与 Microsoft 联系后，我找到了必要的配置步骤。

这些是你必须做的事情：

*   将这两个网站链接到您的团队项目
*   分支你的代码
*   将构建定义上的工作区映射调整到暂存站点以映射分支
*   更改解决方案以在暂存站点的构建定义上构建属性以指向分支中的解决方案

我写了一篇关于它的博客文章，更详细地解释了它：[Branches, Team Foundation Service and Azure Websites](http://wouterdekort.blogspot.nl/2012/11/branches-team-foundation-service-and.html)

# c# - 将组合框值转换为另一种形式

> ID：13516445
> 
> 赞同：2
> 
> 时间：2012-11-22T16:05:24.297
> 
> 标签：c#, .net, forms, combobox

> **可能重复：**
> [（c# + windows forms）将项目添加到不同类的listBox](https://stackoverflow.com/questions/13439624/c-windows-forms-adding-items-to-listbox-in-different-class)

我想在form1中获取combobox值并在form2中使用它，因为该值会从注册用户返回另一个数据

```
public void povoacboxcliente()
{
    List<SM.BancoDados.BD.Model.Clientes> lstClientes = new List<SM.BancoDados.BD.Model.Clientes>();
    ClienteFlow flow = new ClienteFlow();

    lstClientes = flow.RetornaClientes();

    cboxCliente.DataSource = lstClientes;
    cboxCliente.DisplayMember = "Nome";
    cboxCliente.ValueMember = "Id";    
} 
```

现在值成员 (Id) 将返回成员的性别，即在数据库上，这部分没问题，但我想要以另一种形式进行操作.. 这是我在 form2 上尝试的代码

```
public void enviasexo()
    {
        EnviarComando("0238373b3be503");
        idClient = Convert.ToInt32(cboxCliente.SelectedValue); 

        UsuarioFlow usuarioFlow = new UsuarioFlow();

        string combo = cboxCliente.SelectedValue.ToString();

        string sexo = usuarioFlow.RetornaSexo(combo);

        if (sexo == "M")
        {
            Thread.Sleep(2000);
            EnviarComando("0232343b3bdc03");
            Thread.Sleep(200); //envia comando
        }
        else if (sexo == "F")
        {
            Thread.Sleep(2000);
            EnviarComando("0232353b3bdd03");
            Thread.Sleep(200);
        }
    } 
```

"cboxCliente" 在 form1 中使用

感谢人们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:10:49.957

一种方法是在 Form1.Designer.cs 中公开 ComboBox

然后从 Form2 访问 ComboBox

```
Form Form1Object = new Form1();
Form1Object.cboxCliente.SelectedValue.ToString(); 
```

请参阅类似的答案

[Stack Overflow 其他类似问题的答案](https://stackoverflow.com/a/11595381/823369)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:33:11.740

在以不同形式传递值时，请使用 Asp.Net 中可用的状态管理技术之一。

看到这个
[http://www.codeproject.com/Articles/331962/A-Beginner-s-Tutorial-on-ASP-NET-State-Management](http://www.codeproject.com/Articles/331962/A-Beginner-s-Tutorial-on-ASP-NET-State-Management)

**客户端状态管理技术**

查看状态 控制状态 隐藏字段 Cookies 查询字符串

**服务器端状态管理技术**

应用程序状态会话状态

作为最佳实践，如果其中一个控制值严格依赖于表单 1...来自用户的输入，则不应向用户显示表单 2。如果未选择下拉列表中的值，则在表单 2 上应用页面验证并将用户重定向到表单 1。

希望这会有所帮助[shaz]

# .net - Visual Studio 2010 Express 上的 Web 服务：如何获取 WSDL 地址？

> ID：13516446
> 
> 赞同：0
> 
> 时间：2012-11-22T16:05:25.550
> 
> 标签：.net, wsdl

从在 Visual Studio 2010 Express 中开发的 .NET Web 服务开始，我怎样才能让自己的 Web 服务知道它自己提供的 WSDL 的 URL？

例如，如果我有一些样板代码

```
[WebService]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
public class MyWS : System.Web.Services.WebService
{
  [WebMethod(Description="Something like: http://localhost:12345/MyWS.asmx?WSDL")]
  public int RegisterInDB(string ConnectionString)
  {
    string urlWSDL = "HOW_TO_GET_WEBSERVICE'S_OWN_WSDL_URL_HERE ???";
    int NewRowId;
    // 1) Connect to DB with ConnectionString
    // 2) INSERT into table some info, including urlWSDL
    // 3) Get Id of INSERT'ed row.
    return NewRowId;
  }
} 
```

哪个方法/属性在运行时提供 WSDL？

# jquery - 滚动功能

> ID：13516448
> 
> 赞同：0
> 
> 时间：2012-11-22T16:05:45.673
> 
> 标签：jquery

当我移动滚动条时，我正在尝试制作一个上下移动的菜单。我离它很近，但是当它移动时它会跳动一点，菜单（div right）的移动并不顺畅。有谁知道如何改进它？

（当然不能横向移动，也不能和左边的内容重叠。请看这里的例子：http://jsfiddle.net/67ZFe/）

查询：

```
$(function(){

    $(document).scroll(function(){
        var windowTop = $(window).scrollTop();
        $('#right').css('margin-top', (windowTop)  + 'px'); 
    });

}) 
```

CSS：

```
body {background-color: #f2f2f2;font-size: 13px;margin: 0;padding: 0;}
#wrapper {position: relative; margin:0 auto;width:700px;height:900px;background-color:#fff;}
#right {
    position: absolute;
    top: 40px;
    right:0px;
    width:200px;
    height:200px;
    background-color: red;
}
#text {
    position: absolute;
    left: 0px;
    width:400px;
    padding:40px;
} 
```

的HTML：

```
<div id="wrapper">
  <div id="text"> </div>
  <div id="right"> </div>
</div> 
```

我在这里有一个例子：http: [//jsfiddle.net/67ZFe/](http://jsfiddle.net/67ZFe/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:08:06.803

`position:fixed;`使用css 属性而不是使用 jQuery可能会更好、更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:08:59.903

我可能会遗漏一些东西，但是使用固定位置的元素而不是一直移动元素不是更容易吗？

当一个元素使用固定位置时，它的位置是相对于浏览器窗口而不是页面确定的。因此，即使您滚动页面，菜单也将始终放置在相对于顶部的特定位置。

使用固定定位将比使用 JavaScript 解决方案顺畅得多。

我会使用类似的东西：

```
#right {
   position: fixed;
   top: 50px; /* Or whatever suits you */
} 
```

# ruby-on-rails - Rails 使用 MS SQL 服务器数据库

> ID：13516451
> 
> 赞同：5
> 
> 时间：2012-11-22T16:05:58.607
> 
> 标签：ruby-on-rails, ruby, sql-server, sql-server-2008-r2, odbc

在我的 rails 应用程序中，我需要使用现有的 MS SQL 数据库。我已尝试遵循本手册：

[http://rubyrailsandwindows.blogspot.com/2008/03/rails-2-and-sql-server-2008-on-windows_24.html](http://rubyrailsandwindows.blogspot.com/2008/03/rails-2-and-sql-server-2008-on-windows_24.html)

我不知道如何做模型、脚手架等，因为 rails 不能简单地使用另一个数据库。我不想为 MS SQL 数据库中的表运行 rake db:migrate。我还需要在模型中写什么？如果简单：使用 MS SQL 服务器数据库中的表，但我也想解决迁移等问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:16:18.580

如果您需要在现有数据库之上运行 Rails，并且希望确保可以创建与现有表匹配的所有模型，请遵循本指南：

*   [使用http://guides.rubyonrails.org/migrations.html#schema-dumping-and-you](http://guides.rubyonrails.org/migrations.html#schema-dumping-and-you)将模式转储到 schema.rb 中。我实际上会使用架构（`config.active_record.schema_format = :sql`）的 SQL 模式，只需使用 SQL Server 工具生成数据库架构的 SQL 文件并将其保存为`db/structure.sql`
*   建立数据库模式后，您可以使用此处概述的方法重定向模型中的表和主键：[将 Rails 置于现有数据库之上](https://stackoverflow.com/questions/4597570/putting-rails-over-top-of-an-existing-database)

作为 ActiveRecord 的替代品，您可能会考虑[使用 DataMapper](http://datamapper.org/why.html)，因为它声称可以更好地处理“棕地”（即已经建立的）数据库。

# php - mysql utf8 uni 字符集

> ID：13516455
> 
> 赞同：1
> 
> 时间：2012-11-22T16:06:04.803
> 
> 标签：php, mysql, apache, utf-8

我的数据库中有一些德国数据集。在我使用 utf8 uni 的那些字段上，我的 php 和 apache 也在 utf8 uni 上运行。我不知道为什么，但是如果有一些德语特殊字符，mysql会像这样保存这些字段中的数据

```
Mit Gummizug fÃ¼r den perfekten 
```

我不想要那些“Ã¼”我需要改变什么才能正确显示这些特殊字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:10:51.890

您是否以 UTF8 模式打开了与 mySQL 的连接？如果没有，我怀疑这是你的问题。

假设您使用的是 PDO，您可以通过将 'charset=utf8' 附加到连接字符串来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:35:09.433

在进行查询和插入之前，告诉连接对象传递 UTF-8：

```
// tells the mysqli connection to deliver UTF-8 encoded strings.
$db = new mysqli($dbHost, $dbUser, $dbPassword, $dbName);
$db->set_charset('utf8'); 
```

对于其他类型的 mysql 连接，请查看[此处](http://www.martinstoeckli.ch/php/php.html#utf8)。

# asp.net - 将 nvarchar 值“aaa”转换为数据类型 int 时转换失败

> ID：13516459
> 
> 赞同：0
> 
> 时间：2012-11-22T16:06:19.950
> 
> 标签：asp.net, sql, sql-server, sql-server-2008

`SqlDataSource`尝试从文本框通过输出到网格视图进行简单搜索时，我在标题中出现错误。如果我搜索**123**，它应该返回 ID 为 123 的记录。如果我搜索**aaa**它会返回错误。有人知道为什么吗？？？数据库如下所示：

```
id       int           (primary key / identity)
struser  nvarchar(50) 
```

SQL 语句如下所示：

```
SELECT id, struser 
FROM ticket 
WHERE (id = @id) OR (struser = @struser) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:14:37.357

您可以使用 case 语句，下面假设您没有 id 值`-1`：

```
SELECT id, struser FROM ticket WHERE (id = CASE ISNUMERIC(@id) WHEN 1 THEN CONVERT(int,@id) ELSE -1 END) OR (struser = @struser) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:08:53.010

尝试将其转换为，`varchar`但*我认为*它不再使用索引。

```
WHERE (CAST(id AS VARCHAR(20)) = @id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:14:50.100

尝试

```
SELECT id, struser 
FROM ticket 
WHERE (CONVERT(VARCHAR,id) = @id ) OR (struser = @struser) 
```

# php - .htaccess 在本地工作，但不在服务器上

> ID：13516461
> 
> 赞同：0
> 
> 时间：2012-11-22T16:06:33.310
> 
> 标签：php, apache

我的本地 Windows 机器上有 apache 和 PHP，我的 .htaccess 规则工作正常。我将所有文件上传到我的 Linux 服务器并得到不同的结果。我完全控制了我的 Linux VPS。它不是共享主机或任何东西。我创建了一个文件 showme.php，所有请求都应该转到该文件。showme.php 只是输出一些 $_SERVER 变量，所以我知道它有效。但是对服务器的每个请求都会给我 404 not found 。相同的请求在本地提供 showme.php 就像它应该的那样。

-本地示例：[http://localhost/somepage](http://localdomain.com/somepage)（我得到了 showme.php 呈现的正确页面）

-服务器示例： http: [//mydomain.com/somepage](http://mydomain.com/somepage) （我收到 404 消息）

这是我的 .htaccess 文件。我不明白为什么我会得到不同的结果。有文件权限的东西？

```
# AddType x-mapp-php5 .php
# AddHandler x-mapp-php5 .php

RewriteEngine on
Options +FollowSymlinks

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . showme.php [L]

ErrorDocument 404 /page-unavailable/

<files ~ "\.tpl$">
order deny,allow
allow from none
deny from all
</files> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:22:28.250

答案是在我的 httpd.conf 中，我需要将 AllowOverride All 设置在某个位置。它在某些目录中，但我想不是默认的..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:09:44.230

如果您使用`phpinfo()`并进行搜索`mod_rewrite`（通常在配置下），您将能够判断您是否有能力使用`RewriteRules`. 这通常是您看到`IfModule`重写的原因：

```
<IfModule mod_rewrite.c>
    RewriteEngine on

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . showme.php [L]
</IfModule> 
```

# html - 全宽 div 浏览器调整大小问题

> ID：13516462
> 
> 赞同：0
> 
> 时间：2012-11-22T16:06:36.103
> 
> 标签：html, css, resize

我有一个 100% 宽度的 div，它可以很好地填充屏幕（水平），但是当我手动调整浏览器窗口的大小（水平）直到它达到我的固定宽度包装器（所以出现滚动条）然后向右滚动 100% width div 不再适合 100%。可能听起来比它更复杂。

此处示例：[链接](http://s169332309.websitehome.co.uk/fullwidth_issue.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:21:11.200

将`min-width`页面正文的宽度设置为与固定宽度包装器相同的宽度，例如：

```
body {
    min-width: 900px;
} 
```

见这个例子：http: [//jsfiddle.net/XLHqN/](http://jsfiddle.net/XLHqN/)

# sql-server - 查询挂起，但如果我更新统计信息就可以了

> ID：13516466
> 
> 赞同：0
> 
> 时间：2012-11-22T16:06:43.477
> 
> 标签：sql-server, sql-server-2008

遇到一个问题，我有一个复杂的 sql 查询，偶尔挂起并且不在 MS SQL 上执行。但是，当我对查询中涉及的表运行更新统计信息时，查询会正常执行。

关于原因的任何想法或指示？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T21:54:27.013

SQL Server 创建一个“执行计划”，它使用统计信息来确定过滤数据/减少对数据库表的访问的最佳顺序。

这个执行计划存储在数据库缓存中，只要数据库在线就可以重复使用；不会重建统计信息，也不会修改查询。

更新索引时，也会更新统计信息。

因此，为您的查询存储的执行计划不再是最佳的，因此将不再使用。

我希望 SQL Server 在重建索引之前也会关闭表的未使用锁和事务。这是一个未记录的功能。

# matlab - MATLAB中将相同的左右矩阵乘法应用于大量矩阵的有效方法

> ID：13516474
> 
> 赞同：1
> 
> 时间：2012-11-22T16:07:16.190
> 
> 标签：matlab, matrix-multiplication

我有很多 2×2 矩阵 S1、S2、...、SN，并且在每个矩阵上，我想像 R*S*R^T 一样执行左右矩阵乘法，其中 R也是一个 2×2 矩阵。显然我可以用一个 for 循环来写这个，但我预计它对于 MATLAB 中的大 N 来说会非常慢。有没有一种简单有效的方法可以在不使用 for 循环的情况下完成此操作？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:29:26.457

你最大的问题不是循环。对于如此小的矩阵，调用 MATLAB 会`A*B`带来很多开销。您可以做的最好的事情是将所有矩阵存储在一个大`4 x n_matrices`矩阵中并手动拼出矩阵乘法：

```
A = rand(4, 1000);
B = rand(4, 1000);

tic;
C = zeros(size(A));
C(1,:) = A(1,:).*B(1,:) + A(3,:).*B(2,:);
C(2,:) = A(2,:).*B(1,:) + A(4,:).*B(2,:);
C(3,:) = A(1,:).*B(3,:) + A(3,:).*B(4,:);
C(4,:) = A(2,:).*B(3,:) + A(4,:).*B(4,:);
toc

Elapsed time is 0.020950 seconds. 
```

如您所见，这需要很少的时间（这是一台使用了 6 年的台式 PC）。对于像这样的小矩阵，它是实用的，我无法想象用 MATLAB 编写的任何其他东西可以在性能方面击败这个。好吧，对于大量`2x2`矩阵，您可以引入阻塞（即一次只处理多个矩阵）以增强缓存重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:28:37.130

我会说这里的周期不是那么糟糕也不是那么慢，考虑一下

```
N = 1000000
S = cell(1,N);
Out = S;
A = rand(2);
B = rand(2);

for i = 1 : N     
    S{i} = rand(2);
end

tic
for i = 1 : N
    Out{i} = A * S{i} * B;    
end
toc

tic
  f = @(i) A*i*B;
  Out = cellfun(f,S,'UniformOutput' , false);  
toc

  N =

 1000000

   Elapsed time is 2.609569 seconds.
   Elapsed time is 9.871200 seconds. 
```

您可能会考虑执行`cat`2x2 矩阵中的一个，然后仅执行 2 次乘法（在途中正确转置）。但是你会在`cat`ting 中浪费时间。

# actionscript-3 - 播放器在加载外部 SWF 后更改大小（但未使用）

> ID：13516475
> 
> 赞同：0
> 
> 时间：2012-11-22T16:07:18.940
> 
> 标签：actionscript-3, flash

我有一个正在开发的 Flash 播放器（在 AS3 中开发）。

舞台（和播放器）尺寸为 640x979。

在播放器的底部，我有一个控制栏，带有播放暂停按钮等。

这是播放器的图像（[图像](https://s14.postimage.org/ggi0pn7jj/good_banner_blurred.png)）。

![图片](../Images/ba20c26418aac4bebe2db939e2927de3.png)

**到目前为止，一切都很好。**

现在 - 在我加载的大多数外部 SWF 上 - 它们加载正常。但在某些情况下——如果我尝试使用 Loader 类加载它们——玩家会发疯！控制栏消失，视频以一种时髦的方式拉伸。您可以在附加的图像 ( [image](https://s17.postimage.org/y6793x8zx/bad_banner_blurred.png) ) 中看到这一点。

![图片](../Images/f39643a90ba97045d374f128887a1d08.png)

这里真正奇怪的是 - 即使我没有将 Loader 对象添加为孩子，也会发生这种情况！

我只是这样做：

```
public function PlayerCtor()
{
    swfUrlLoader = new Loader();
    swfUrlLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onSwfReceived);   
    swfUrlLoader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onSwfIOError);
    swfUrlLoader.load(new URLRequest(swfUrl));
}
private function onSwfReceived(e:Event):void
{
   swfUrlLoader.contentLoaderInfo.removeEventListener(Event.COMPLETE, onSwfReceived);
   swfUrlLoader.contentLoaderInfo.removeEventListener(IOErrorEvent.IO_ERROR, onSwfIOError);
} 
```

.

而已 ！除了加载外部 SWF 之外，我什么也不做！

我能想到的唯一事情是：

1.  也许“坏”的 SWF 文件中有一些导致这种行为发生的代码隐藏？
2.  “坏”横幅应该是 906x340。我注意到他们有动画从这些边界的“外部”飞入......（我通过使用“Flash Decomplier”试用反编译 SWF 发现了这一点）。

以下是可以正常使用且没有任何问题的 SWF 横幅：

*   [Adom-Adom SWF](http://www.tnuva.co.il/PublishingImages/Banners/new_adom.swf)
*   [妈妈关 SWF](http://www.tnuva.co.il/PublishingImages/Banners/Mama_of.swf)

以下是让我的玩家发疯的“坏”横幅：

*   [奶酪 SWF](http://www.tnuva.co.il/PublishingImages/Banners/Tnuva_TAMI_906x340.swf)
*   [Emek 奶酪 SWF](http://www.tnuva.co.il/PublishingImages/Banners/New_emek_906x340.swf)

谁能帮我弄清楚如何防止这搞砸我的播放器，好吗？

感谢所有可以提供帮助的人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T20:57:48.767

听起来一些辅助负载正在改变 stageAlign 和/或 stageScaleMode。查看加载完成后将 stage.stageAlign 和 stage.stageScaleMode 更改为您期望的值是否可以解决问题

# gcc - long double（GCC 特定）和 __float128

> ID：13516476
> 
> 赞同：36
> 
> 时间：2012-11-22T16:07:20.237
> 
> 标签：gcc, long-double

我正在寻找有关GCC/x86 的详细信息（更多的是出于好奇而不是因为实际问题）`long double`。`__float128`

可能很少有人会需要这些（我只是，有史以来第一次，*真正*需要 a `double`），但我想知道你的工具箱里有什么以及它是关于什么的仍然是值得的（而且很有趣）。

鉴于此，请原谅我有些开放的问题：

1.  有人可以解释这些类型的实现原理和预期用途，也可以相互比较吗？例如，它们是否因为标准允许类型而“令人尴尬的实现”，如果它们只是与 相同的精度`double`，或者它们打算作为一流类型，有人可能会抱怨？
2.  或者，有人可以分享一个好的、可用的网络参考吗？谷歌搜索`"long double" site:gcc.gnu.org/onlinedocs`并没有给我太多真正有用的东西。
3.  假设常见的口头禅*“如果你认为你需要双精度，你可能不了解浮点数”*不适用，即你*真的*需要比精度更高的精度`float`，而且不关心是 8 字节还是 16 字节的内存烧毁...是否可以合理地期望一个人也可以直接跳到`long double`或者`__float128`没有`double`显着的性能影响？
4.  历史上，当值在内存和寄存器之间移动时，英特尔 CPU 的“扩展精度”特性一直是令人讨厌的意外之源。如果实际存储了 96 位，则该`long double`类型应消除此问题。另一方面，我知道该`long double`类型与 是互斥的`-mfpmath=sse`，因为 SSE 中没有“扩展精度”之类的东西。`__float128`，另一方面，在 SSE 数学上应该可以很好地工作（尽管在没有四精度指令的情况下肯定不是在 1:1 指令库上）。我的这些假设是对的吗？

（3\. 和 4\. 可能可以通过在分析和反汇编上花费一些工作来弄清楚，*但也许其他人之前也有同样的想法并且已经完成了这项工作*。）

**背景（这是 TL;DR 部分）：**
我最初偶然发现`long double`是因为我正在查找`DBL_MAX`，`<float.h>`顺便说`LDBL_MAX`一下在下一行。“哦，看，GCC 实际上有 128 位双打，不是我需要它们，但是……很酷”是我的第一个想法。惊喜，惊喜：`sizeof(long double)`返回 12……等等，你是说 16？

毫不奇怪，C 和 C++ 标准没有给出非常具体的类型定义。C99 (6.2.5 10) 表示的数字是C++03 状态 (3.9.1 8)`double`的子集，其精度至少与(这是同一件事，只是措辞不同)。基本上，标准将所有内容留给实现，与、和.`long double``long double``double``long``int``short`

维基百科说 GCC 使用*“x86 处理器上的 80 位扩展精度，而不管使用的物理存储如何”*。

GCC 文档在同一页面上声明，由于 i386 ABI，类型的大小为 96 位，但任何选项（嗯？什么？）启用的精度不超过 80 位，还有 Pentium 和更新版本处理器希望它们对齐为 128 位数字。这是 64 位下的默认设置，可以在 32 位下手动启用，从而产生 32 位的零填充。

运行测试的时间：

```
#include <stdio.h>
#include <cfloat>

int main()
{
#ifdef  USE_FLOAT128
    typedef __float128  long_double_t;
#else
    typedef long double long_double_t;
#endif

long_double_t ld;

int* i = (int*) &ld;
i[0] = i[1] = i[2] = i[3] = 0xdeadbeef;

for(ld = 0.0000000000000001; ld < LDBL_MAX; ld *= 1.0000001)
    printf("%08x-%08x-%08x-%08x\r", i[0], i[1], i[2], i[3]);

return 0;
} 
```

使用 时`long double`，输出看起来有点像这样，标记的数字是恒定的，而所有其他数字最终都会随着数字越来越大而变化：

```
5636666b-c03ef3e0-00223fd8-deadbeef
                  ^^       ^^^^^^^^ 
```

这表明它**不是**80 位数字。一个 80 位数字有 18 个十六进制数字。我看到 22 个十六进制数字发生了变化，这看起来更像是一个 96 位数字（24 个十六进制数字）。它也不是一个 128 位的数字，因为没有被触及，这与返回 12`0xdeadbeef`是一致的。`sizeof`

的输出`__int128`看起来真的只是一个 128 位的数字。所有位最终都会翻转。

**如文档所示，**使用 32 位零填充与 128 位不`-m128bit-long-double`对齐。它也不使用，但确实似乎与 128 位对齐，并用值(?!) 填充。**`long double``__int128``0x7ffdd000`**

 **此外，`LDBL_MAX`, 似乎对`+inf`和 都`long double`有效`__float128`。在相同的位模式中添加或减去类似`1.0E100`或`1.0E2000`到/从的数字。 到现在为止，我相信常量将包含最大的可表示数字，但事实*并非如此*（显然情况并非如此？）。我也不太确定一个 80 位数字如何可以想象128 位值......也许我在一天结束时太累了并且做错了什么。`LDBL_MAX`
`foo_MAX` *`+inf``+inf`*

 ** * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-05-03T14:13:34.397

广告 1。

这些类型旨在处理具有巨大动态范围的数字。long double 在 x87 FPU 中以本机方式实现。我怀疑 128b double 将在现代 x86s 上以软件模式实现，因为没有硬件可以在硬件中进行计算。

有趣的是，连续执行许多浮点运算是很常见的，并且中间结果实际上并不存储在声明的变量中，而是存储在 FPU 寄存器中，以利用全精度。这就是为什么比较：

```
double x = sin(0); if (x == sin(0)) printf("Equal!"); 
```

不安全且不能保证工作（没有额外的开关）。

广告。3.

速度会受到影响，具体取决于您使用的精度。您可以使用以下方法更改使用的 FPU 精度：

```
void 
set_fpu (unsigned int mode)
{
  asm ("fldcw %0" : : "m" (*&mode));
} 
```

较短的变量会更快，更长的变量会更慢。128 位双打可能会在软件中完成，所以会慢得多。

这不仅与浪费 RAM 内存有关，还与浪费缓存有关。从 64b double 转到 80 bit double 将浪费 33% (32b) 到几乎 50% (64b) 的内存（包括缓存）。

广告 4。

> 另一方面，我知道 long double 类型与 -mfpmath=sse 是互斥的，因为 SSE 中没有“扩展精度”之类的东西。另一方面，__float128 应该与 SSE 数学完美配合（尽管在没有四精度指令的情况下肯定不是在 1:1 指令库上）。我在这些假设下是对的吗？

FPU 和 SSE 单元是完全独立的。您可以在使用 SSE 的同时使用 FPU 编写代码。问题是如果您将其限制为仅使用 SSE，编译器会生成什么？它会尝试使用 FPU 吗？我一直在用 SSE 进行一些编程，而 GCC 只会自己生成一个 SISD。您必须帮助它使用 SIMD 版本。__float128 可能适用于每台机器，甚至是 8 位 AVR uC。毕竟这只是摆弄比特。

十六进制表示的 80 位实际上是 20 个十六进制数字。也许未使用的位来自某些旧操作？在我的机器上，我编译了你的代码，在长模式下只有 20 位变化：66b4e0d2-ec09c1d5-00007ffe-deadbeef

128 位版本的所有位都发生了变化。看`objdump`它看起来好像在使用软件仿真，几乎没有 FPU 指令。

> 此外，LDBL_MAX 似乎对于 long double 和 __float128 都可以用作 +inf。在 LDBL_MAX 中添加或减去 1.0E100 或 1.0E2000 等数字会产生相同的位模式。到现在为止，我相信 foo_MAX 常量将保存最大的可表示数字，而不是 +inf （显然情况并非如此？）。

这似乎很奇怪……

> 我也不太确定一个 80 位的数字如何可以作为 128 位的值的 +inf ......也许我在一天结束时太累了并且做错了什么。

应该是延长了 在 80 位中被识别为 +inf 的模式也被转换为 128 位浮点中的 +inf。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-06-05T19:23:30.393

IEEE-754 定义了 32 位和 64 位浮点表示以实现高效的数据存储，并定义了 80 位表示以实现高效计算。其目的是通过将参数转换为 80 位浮点值、添加它们并将结果转换回 64 位浮点类型来执行给定`float f1,f2; double d1,d2;`的语句。`d1=f1+f2+d2;`与直接对其他浮点类型执行操作相比，这将提供三个优势：

1.  虽然在 32 位类型和 64 位类型之间的转换需要单独的代码或电路，但只需要一个“加法”实现、一个“乘法”实现、一个“平方根”实现，等等

2.  尽管在极少数情况下，使用 80 位计算类型产生的结果可能比直接使用其他类型的结果准确度略低（在其他类型的计算会产生 511/1024ulp 错误的情况下，最坏情况舍入误差为 513/1024ulp )，使用 80 位类型的链式计算通常比使用其他类型的计算更准确——有时*更准确。*

3.  在没有 FPU 的系统上，`double`在执行计算之前将 a 分离为单独的指数和尾数、标准化尾数以及将单独的尾数和指数转换为 a`double`有点耗时。如果一个计算的结果将用作另一个计算的输入并被丢弃，则使用未打包的 80 位类型将允许省略这些步骤。

然而，为了使这种浮点数学方法有用，代码必须能够以与计算中使用的精度相同的精度存储中间结果，从而`temp = d1+d2; d4=temp+d3;`产生与`d4=d1+d2+d3;`. 据我所知，目的`long double`是*成为*那种类型。不幸的是，尽管 K&R 设计了 ​​C 以便所有浮点值都以相同的方式传递给可变参数方法，但 ANSI C 打破了这一点。在最初设计的 C 中，给定 code `float v1,v2; ... printf("%12.6f", v1+v2);`，该`printf`方法不必担心是否`v1+v2`会产生 a`float`或 a `double`，因为无论如何结果都会被强制转换为已知类型。此外，即使类型`v1`或`v2`更改为`double`，该`printf`语句不必更改。

然而，ANSI C 要求调用的代码`printf`必须知道哪些参数是`double`，哪些是`long double`；许多代码（如果不是大多数代码）使用`long double`但编写在与它同义的平台上，但`double`未能使用正确的`long double`值格式说明符。许多编译`long double`器决定将`long double`其与`double`并且不提供任何存储中间计算结果的方法。由于使用扩展精度类型进行计算只有在程序员可以使用该类型时才是好的，所以许多人得出结论认为扩展精度是邪恶的，尽管只是 ANSI C 未能明智地处理可变参数参数才造成问题。

`long double`PS-如果还有一个`long float`被定义为`float`可以最有效地提升参数的类型，那么的预期目的将会受益；在许多没有浮点单元的机器上可能是 48 位类型，但最佳大小的范围可以从 32 位（在具有直接执行 32 位数学的 FPU 的机器上）到 80 位（在使用IEEE-754 所设想的设计）。不过现在为时已晚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-15T18:24:27.353

它归结为 4.9999999999999999999 和 5.0 之间的差异。

1.  尽管范围是主要区别，但重要的是精度。
2.  在可能与 GPS 系统一起使用的大圆计算或坐标数学中将需要这些类型的数据。
3.  由于精度比普通双精度高得多，这意味着您通常可以保留 18 位有效数字，而不会失去计算的准确性。
4.  我相信扩展精度使用 80 位（主要用于数学处理器），因此 128 位会更准确。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-31T22:22:14.530

C99 和 C++11 添加了类型`float_t`，`double_t`它们是内置浮点类型的别名。粗略地说，`float_t`是在 type 的值之间进行算术运算的结果的类型`float`，并且`double_t`是在 type 的值之间进行算术运算的结果的类型`double`。***

# exchange-server - 通过 Exchange Web 服务创建现有事件

> ID：13516479
> 
> 赞同：2
> 
> 时间：2012-11-22T16:07:35.673
> 
> 标签：exchange-server, exchangewebservices

我正在将业务从 Kerio Connect 迁移到 MS Exchange 2010（不要问为什么）。因此，我编写了一些代码，通过 CalDAV 从 Kerio 中提取事件和任务，并使用 EWS（Exchange Web 服务）在 Exchange 中重新创建它们。

一切都很好，除了一件事：组织者和参与者之间的联系被打破了。我的意思是，参与者可以编辑会议，这是他不应该做的，如果组织者更改会议时间，参与者不会得到更新。

我查看了 Outlook 2011 和 iCal 在创建事件时所做的事情，并且我执行相同的步骤，除了一件重要的事情：我在 Exchange 中重新创建的事件是参与者已经接受邀请的事件，我们不想发送邀请当我们开始迁移时。

这是在 EWS 中创建事件的请求：

```
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
  <S:Header>
    <ns2:MailboxCulture xmlns:ns2="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:ns3="http://schemas.microsoft.com/exchange/services/2006/messages">en-US</ns2:MailboxCulture>
    <ns2:RequestServerVersion xmlns:ns2="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:ns3="http://schemas.microsoft.com/exchange/services/2006/messages" Version="Exchange2010_SP1" />
    <ns2:TimeZoneContext xmlns:ns2="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:ns3="http://schemas.microsoft.com/exchange/services/2006/messages">
      <ns2:TimeZoneDefinition Id="Eastern Standard Time" />
    </ns2:TimeZoneContext>
  </S:Header>
  <S:Body>
    <ns3:CreateItem xmlns:ns2="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:ns3="http://schemas.microsoft.com/exchange/services/2006/messages" SendMeetingInvitations="SendToAllAndSaveCopy">
      <ns3:SavedItemFolderId>
        <ns2:FolderId Id="AAMkADZkZDFkMjcwLTM5YWItNGRiYy05YzA0LWZhZmM3MjBkNDM1ZgAuAAAAAAAQdcJHRof+QosJDrhZyY00AQCw+XICdccgRJNrvNFaYvpgAAAAevvIAAA=" />
      </ns3:SavedItemFolderId>
      <ns3:Items>
        <ns2:CalendarItem>
          <ns2:Subject>Test prob -&gt; probert</ns2:Subject>
          <ns2:Body BodyType="Text"> 
          </ns2:Body>
          <ns2:Importance>Normal</ns2:Importance>
          <ns2:UID>3CB0FF7D-63F0-47A0-80B6-3B3131E7BCF4</ns2:UID>
          <ns2:Start>2012-12-21T17:00:00</ns2:Start>
          <ns2:End>2012-12-21T18:30:00</ns2:End>
          <ns2:IsAllDayEvent>false</ns2:IsAllDayEvent>
          <ns2:Location>salle3219_6</ns2:Location>
          <ns2:RequiredAttendees>
            <ns2:Attendee>
              <ns2:Mailbox>
                <ns2:Name>Pascal Robert</ns2:Name>
                <ns2:EmailAddress>probert@mydomain.com</ns2:EmailAddress>
              </ns2:Mailbox>
              <ns2:ResponseType>Accept</ns2:ResponseType>
            </ns2:Attendee>
          </ns2:RequiredAttendees>
          <ns2:OptionalAttendees>
            <ns2:Attendee>
              <ns2:Mailbox>
                <ns2:Name>salle3219_6</ns2:Name>
                <ns2:EmailAddress>salle3219_6@mydomain.com</ns2:EmailAddress>
              </ns2:Mailbox>
              <ns2:ResponseType>Accept</ns2:ResponseType>
            </ns2:Attendee>
          </ns2:OptionalAttendees>
        </ns2:CalendarItem>
      </ns3:Items>
    </ns3:CreateItem>
  </S:Body> 
```

# iphone - Xcode：在 applicationDidBecomeActive 中显示登录视图

> ID：13516481
> 
> 赞同：6
> 
> 时间：2012-11-22T16:07:55.553
> 
> 标签：iphone, objective-c, ios, xcode

在我的应用程序中，我想显示一个登录屏幕 - 将在应用程序启动和应用程序激活时显示。作为参考，我使用的是故事板、ARC，它是一个标签栏应用程序。

因此，我需要在`applicationDidBecomeActive`方法中执行该过程：

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    if ( ... ) { // if the user needs to login
        PasswordViewController *passwordView = [[PasswordViewController alloc] init];
        UIViewController *myView = self.window.rootViewController;
        [myView presentModalViewController:passwordView animated:NO];
    }
} 
```

在某种程度上，这确实有效 - 我可以调用一个方法，在`viewDidAppear`该方法中显示警报视图以允许用户登录。但是，这是不可取的，我希望有一个登录文本框和其他 ui 元素。如果我不调用我的登录方法，则不会发生任何事情并且屏幕保持黑色，即使我在视图上放置了标签和其他元素。

有谁知道解决这个问题的方法？我的密码视图嵌入在导航控制器中，但与主故事板分离。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T11:01:27.267

各种各样的答案最终让我找到了一个看起来不太复杂的答案，所以我会在这里发布 - 如果我说实话，它实际上看起来真的很好。

首先，我的密码视图嵌入在导航控制器（编辑器-> 嵌入）中，并使用带有 id 的模态 segue 连接到主选项卡栏控制器，在我的情况下为“loginModal”。

在`applicationDidBecomeActive`方法中放这样的东西：

```
[self performSelector:@selector(requestPasscode) withObject:nil afterDelay:0.2f]; 
```

然后把这个函数放在 App Delegate 的某个地方

```
-(void)requestPasscode{
    if ( /* If the user needs to login */ ) {
        [self.window.rootViewController performSegueWithIdentifier:@"loginModal" sender:self];
    }
} 
```

每当应用程序开始或进入前台时（例如，切换应用程序时），这将显示您的登录视图。

**注意：** 如果您的应用程序的根目录嵌入在导航控制器中，则上述行将不起作用。

但是有两个错误；

1.  如果用户在关闭应用程序时之前正在查看模态视图
2.  如果用户在密码视图中关闭了应用程序。

这两种情况都会导致应用程序崩溃，因此方法中包含以下行`applicationWillResignActive`。

```
[self.window.rootViewController dismissViewControllerAnimated:NO completion:nil]; 
```

It basically dismisses all modal views that are presented. This may not be ideal, but modal views are more often then not, used for data entry and so in many cases, this is a desired effect.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-22T16:22:54.697

您应该 `PasswordViewController`从 xib 初始化 viewcontroller，或者如果您将 UI 存储在 Storyboard 中，您应该使用 Segue 来呈现这个控制器。

我不能说其他部分，但那部分在我看来很奇怪。

> 我的密码视图嵌入在导航控制器中，但与主故事板分离。

在情节提要中，您可以在视图控制器中存储视图控制器和视图，因此在视图控制器之外存储一些视图并不好，因为在收到内存警告后您将无法从情节提要中加载此视图。如果我没有明白你的意思，请纠正我。

`PasswordViewController`如果我们按照您的方式进行，那么在 Storyboards 的第一个视图控制器上或在您的第一个视图控制器上加载没有区别`applicationDidBecomeActive`，因为您从第一个加载的视图控制器调用当前视图控制器。所以你可以在你的第一个视图控制器中做到这一点。您还可以在您的第一个视图控制器中存储一些隐藏视图，并在用户需要登录时显示此视图。

我测试了它。所以首先你的控制器被加载，然后你得到了方法`applicationDidBecomeActive`。所以最好把你的代码放在`-(void)viewDidAppear:animated`你的第一个视图控制器的方法中。

最好的问候，丹尼尔

# node.js - 使用 nginx 和节点设置上游？

> ID：13516486
> 
> 赞同：0
> 
> 时间：2012-11-22T16:08:08.987
> 
> 标签：node.js, nginx, load-balancing, reverse-proxy

我在aws上有三个实例。一个用于前端服务器的 nginx，以及两个后端 nodejs 实例。

我试图将 nginx 服务器设置为这些 node.js 实例的上游：

```
upstream node_servers {
        server private_ip:8124 weight=10 max_fails=3; // node server 1 private_ip:port
        server private_ip:8124 weight=10 max_fails=3; // node server 2 private_ip:port
}
server {
    listen  private_ip:80;     // nginx server private ip:port
    root /home/ubuntu/project/;
    server_name public_ip.eu-west-1.compute.amazonaws.com;  // nginx public DNS
    location / {

                try_files $uri $uri/ /index.html;
                proxy_pass http://node_servers/;

     }
} 
```

在我的节点 1 服务器上，节点 2 服务器实例 app.js 代码：

```
app.listen(8124, "127.0.0.1");
console.log("listening on 8124"); 
```

我去nginx服务器公共域名，并没有真正发生任何事情，它只是永远加载发送请求......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:30:35.860

在您的节点代码中，您正在侦听 127.0.0.1 上的环回接口（仅来自本地主机的请求）：

```
app.listen(8124, "127.0.0.1"); 
```

您必须监听您的特定私有 IP 或 0.0.0.0：

```
app.listen(8124, "0.0.0.0"); 
```

# java - 从线程中的 Pixmap 对象创建纹理时，纹理为空

> ID：13516488
> 
> 赞同：0
> 
> 时间：2012-11-22T16:08:10.983
> 
> 标签：java, multithreading, textures, libgdx, pixmap

```
try {
        URL url = new URL(this.url);
        InputStream in = new BufferedInputStream(url.openStream());
        ByteArrayOutputStream out = new ByteArrayOutputStream();
        byte[] buf = new byte[1024];
        int n = 0;
        while (-1 != (n = in.read(buf))) {
            out.write(buf, 0, n);
        }
        out.close();
        in.close();
        byte[] response = out.toByteArray();
        Pixmap pixmap = new Pixmap(response, 0, response.length);
        texture = new Texture(pixmap); // <- here Im getting an exception
    } catch (Exception e) {
        // cause=NullPointerException
        // pixmap was initialized successfully
    } 
```

所有代码都在线程中工作。代码在 UI 线程中运行良好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T22:05:06.283

我认为您不允许在与创建 opengl 上下文的线程不同的线程中使用 opengl。

[http://code.google.com/p/libgdx/wiki/ApplicationThreading](http://code.google.com/p/libgdx/wiki/ApplicationThreading)

# android - 在一个活动中一次加载所有视图

> ID：13516492
> 
> 赞同：0
> 
> 时间：2012-11-22T16:08:35.897
> 
> 标签：android, listadapter

![在此处输入图像描述](../Images/257d0046bea99bb5304dca7e6173e1a3.png) 我使用列表适配器显示一组图像视图。我在程序中动态设置了他们的 ID。问题是当我向右滚动适配器时，图像只有在它们出现在屏幕上时才会获得它们的 ID。当我再次向左滚动时，以前图像的 ID 将重置为新值。我怎样才能停止这种行为并在活动启动开始时设置所有图像的 ID？

工作原理如图所示。每次将旧图像带入活动屏幕时，旧图像都会获得一个新 ID，这会产生通过旧 ID 访问它的问题。我的图像适配器代码：

```
public View getView(final int position, View convertView,ViewGroup parent) 
    {
        final ImageView i = new ImageView(thView.getView().getContext());
        Bitmap bm;
        try {
            bm = thView.getBitmapFromAsset(lis.get(position));
            bm = Bitmap.createScaledBitmap(bm, 100, 100, false);
        } catch (IOException e) {
            e.printStackTrace();
            bm=null;
        }
        i.setImageBitmap(bm);
        final RelativeLayout borderImg = new RelativeLayout(thView.getView().getContext());

        i.setId(x);
        Log.w("ID set as",""+x);
        i.setTag(IMAGEVIEW_TAG);
        x++;
        borderImg.addView(i);           
         i.setOnLongClickListener(new OnLongClickListener() {
            public boolean onLongClick(View v) {
                fname = lis.get(position);
                ClipData.Item item = new ClipData.Item((CharSequence) v
                        .getTag());
                dragData = new ClipData(
                        (CharSequence) v.getTag(),
                        new String[] { ClipDescription.MIMETYPE_TEXT_PLAIN },
                        item);

                View.DragShadowBuilder myShadow = new MyDragShadowBuilder(i);
                v.startDrag(dragData, myShadow, null, 0);
                return false;
            }
         });
         myDragEventListener mDragListen = new myDragEventListener();
         i.setOnDragListener(mDragListen);
        return borderImg;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:24:48.917

是什么`x`？如果`x`取决于位置，那你为什么不使用它，因为你总是有它？

如果不真正了解 AdapterView 的含义，您将无法做您想做的事。此外，如果您在开始时渲染所有图像视图，您可能会遇到内存不足的问题。

我想真正的问题是你想用 ID 完成什么？

# java - KD-Tree“列表中位数”构造

> ID：13516500
> 
> 赞同：1
> 
> 时间：2012-11-22T16:09:00.653
> 
> 标签：java, algorithm, data-structures, kdtree

我使用[“列表中位数”](http://en.wikipedia.org/wiki/K-d_tree#Construction)算法在 Java 中编写了一个 KD-Tree，以构建一个更平衡的树。使用 wiki 提供的数据时似乎工作正常，请注意 wikipedia 示例仅使用 X、Y 值，因此它不评估 Z 深度。

来自维基百科：

```
point_list = [(2,3), (5,4), (9,6), (4,7), (8,1), (7,2)] 
```

![在此处输入图像描述](../Images/fae00626c945d8a3736636e6bea7c361.png)

从[我的java程序](http://code.google.com/p/java-algorithms-implementation/source/browse/src/com/jwetherell/algorithms/data_structures/KdTree.java)：

```
depth=0 id=(7.0, 2.0, 0.0)
├── [left] depth=1 id=(5.0, 4.0, 0.0)
│   ├── [left] depth=2 id=(2.0, 3.0, 0.0)
│   └── [right] depth=2 id=(4.0, 7.0, 0.0)
└── [right] depth=1 id=(9.0, 6.0, 0.0)
    └── [left] depth=2 id=(8.0, 1.0, 0.0) 
```

但是，当我对这些数据使用“列表中位数”方法时，它似乎无法正常工作。

```
point list = [(1,0,-1), (1,0,-2), (1,0,1), (1,0,2)] 
```

我得到一棵这样的树：

```
depth=0 id=(1.0, 0.0, 1.0)
├── [left] depth=1 id=(1.0, 0.0, -2.0)
│   └── [left] depth=2 id=(1.0, 0.0, -1.0)
└── [right] depth=1 id=(1.0, 0.0, 2.0) 
```

这看起来不正确，因为 (1.0, 0.0, 2.0) 在 (1.0, 0.0, 1.0) 的右侧，但它们本质上是相等的，因为它们的 Y 值相等。此外， (1.0, 0.0, -1.0) 在 (1.0, 0.0, -2.0) 的左侧，它应该在右侧，因为它的 Z 值更大。

我认为问题源于具有相等的 X 和 Y 值并且只有可变的 Z 值，因此列表的中位数并没有真正准确地拆分列表。

...遵循wiki的python代码的原始代码...

```
private static KdNode createNode(List<XYZPoint> list, int k, int depth) {
    if (list == null || list.size() == 0) return null;

    int axis = depth % k;
    if (axis == X_AXIS) Collections.sort(list, X_COMPARATOR);
    else if (axis == Y_AXIS) Collections.sort(list, Y_COMPARATOR);
    else Collections.sort(list, Z_COMPARATOR);

    KdNode node = null;
    if (list.size() > 0) {
        int mediaIndex = list.size() / 2;
        node = new KdNode(k, depth, list.get(mediaIndex));
        if ((mediaIndex - 1) >= 0) {
            List<XYZPoint> less = list.subList(0, mediaIndex);
            if (less.size() > 0) {
                node.lesser = createNode(less, k, depth + 1);
                node.lesser.parent = node;
            }
        }
        if ((mediaIndex + 1) <= (list.size() - 1)) {
            List<XYZPoint> more = list.subList(mediaIndex + 1, list.size());
            if (more.size() > 0) {
                node.greater = createNode(more, k, depth + 1);
                node.greater.parent = node;
            }
        }
    }

    return node;
} 
```

...基于我的评论的新代码...

```
private static KdNode createNode(List<XYZPoint> list, int k, int depth) {
    if (list == null || list.size() == 0) return null;

    int axis = depth % k;
    if (axis == X_AXIS) Collections.sort(list, X_COMPARATOR);
    else if (axis == Y_AXIS) Collections.sort(list, Y_COMPARATOR);
    else Collections.sort(list, Z_COMPARATOR);

    KdNode node = null;
    if (list.size() > 0) {
        int medianIndex = list.size() / 2;
        node = new KdNode(k, depth, list.get(medianIndex));
        List<XYZPoint> less = new ArrayList<XYZPoint>(list.size()-1);
        List<XYZPoint> more = new ArrayList<XYZPoint>(list.size()-1);
        //Process list to see where each non-median point lies
        for (int i=0; i<list.size(); i++) {
            if (i==medianIndex) continue;
            XYZPoint p = list.get(i);
            if (KdNode.compareTo(depth, k, p, node.id)<=0) {
                less.add(p);
            } else {
                more.add(p);
            }
        }
        if (less.size() > 0) {
            node.lesser = createNode(less, k, depth + 1);
            node.lesser.parent = node;
        }
        if (more.size() > 0) {
            node.greater = createNode(more, k, depth + 1);
            node.greater.parent = node;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T17:59:11.243

问题确实与相等的坐标有关，并且源于您如何将节点分成`less`和`more`部分。既然你有中位数索引，为什么不使用索引来分割而不是检查坐标呢？只需将第`createNode`116 行中的条件从

```
if (KdNode.compareTo(depth, k, p, node.id)<=0) { 
```

到

```
if (i<medianIndex) { 
```

顺便说一句：与排序相比，有更有效的算法将列表划分为下、中、上。（下部和上部不需要排序！参见例如`std::nth_element`C++ stdlib 中的实现 - 抱歉，我非常喜欢 Java 编程）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T20:36:07.003

我认为此时的基本问题是：您到底想用 KD-tree 做什么？

*   如果您只想使用 X 和 Y 距离找到最近的点，那么您拥有的算法非常好 - 您将找到与您的示例具有相等 XY 距离的四个点中的至少一个。
*   如果你想在 XY 距离中找到*所有*最近的点，那么仍然保持 KD-tree 构建函数相同，但只需将查找函数中的所有 '<' 运算符更改为 '<='。如果您恰好在查询点找到一个 KD-tree 点，您仍然需要沿着该树的任意子节点下降，直到找到一个叶子。然后像往常一样在 KD-tree 中上树，如果它可能与您迄今为止找到的最短距离相匹配，则总是沿着兄弟树向下。
*   如果您想使用涉及 X、Y 和 Z 坐标的距离，您需要使您的树成为 3 维 KD 树，其中 X、Y 和 Z 层交替（或者可能有一些聪明的选择下一步细分哪个维度的方案）。

# php - 如何使用 jquery 删除/删除 HTML TR 块

> ID：13516503
> 
> 赞同：1
> 
> 时间：2012-11-22T16:09:21.933
> 
> 标签：php, jquery, html, html-table

我在 jQuery 上有这个代码来动态添加一个 tr 块和一些输入，它工作正常；但删除功能不起作用，我将不胜感激任何帮助使其工作。

```
<script type="text/javascript">
var counter = 1;
function remove_row(indice){
    alert(indice);
    $("#" + indice).remove();
    counter--;
} 
function addTableRow(jQtable){
    jQtable.each(function(){
        var $table = $(this);
        // Number of td's in the last table row
        var n = $('tr:last td', this).length;
        var tds = "<tr id='row_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Apellido(s)</strong></td><td><input type='text' name='apellidos_" + counter + "' id='apellidos_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td>  <td class='borde'>&nbsp;<br/>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Nombre(s):</strong></td><td align='left'><input type='text' name='nombres_" + counter + "' id='nombres_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Cédula:</strong></td><td align='left'><select name='pre_ced_" + counter + "' id='pre_ced_" + counter + "'><option selected='selected' value='0'> Seleccione... </option><option value='3'>V</option><option value='4'>E</option></select> - <input type='text' name='suf_ced_" + counter + "' id='suf_ced_" + counter + "'  width='170'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Teléfono:</strong></td><td align='left'><input type='text' name='pre_tel1_" + counter + "' id='pre_tel1_" + counter + "' style='width:60px'/> - <input type='text' name='suf_tel1_" + counter + "' id='suf_tel1_" + counter + "' /></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Celular:</strong></td><td align='left'><input type='text' name='pre_tel2_" + counter + "' id='pre_tel2_" + counter + "' style='width:60px'/> - <input type='text' name='suf_tel2_" + counter + "' id='suf_tel2_" + counter + "' /></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Fax/Otro:</strong></td><td align='left'><input type='text' name='pre_tel3_" + counter + "' id='pre_tel3_" + counter + "' style='width:60px'/> - <input type='text' name='suf_tel3_" + counter + "' id='suf_tel3_" + counter + "' /></td><td class='requerido'>&nbsp;</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Correo:</strong></td><td align='left'><input type='text' name='correo_" + counter + "' id='correo_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td align='right'><strong>Profesión:</strong></td><td align='left'><input type='text' name='profesion_" + counter + "' id='profesion_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr><td class='borde'>&nbsp;</td><td>&nbsp;</td><td><input type='button' value='Eliminar Participante' onclick=\"remove_row('row_" + counter + "');\"> <input type='button' value='Mismos Datos Facturación'></td><td>&nbsp;</td><td class='borde'>&nbsp;</td></tr><tr><td colspan='5'  class='borde' align='center'>&nbsp;</td></tr>";
        if($('tbody', this).length > 0){
            $('tbody', this).append(tds);
        }else {
            $(this).append(tds);
        }
    });
    counter++;
}
</script> 
```

这是我的html

```
<form action="inscripcion.php" method="post" enctype="multipart/form-data" name="inscribir" id="inscribir">
      <div id="formdiv">
      <table border="0" align="center" cellspacing="0" id="myTable" name="myTable">
      <tr id="row_0">
          <td colspan="5"  class="borde" align="center" >
          Fecha <?php echo date("d/m/Y"); ?>
          </td>
      </tr>
      <tr>
          <td colspan="5"  class="borde" align="center">
          Evento a Inscribirse
          </td>      
      </tr>

      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Taller:
          </strong></td>
          <td align="left"><label for="taller"></label>
            <select name="taller" id="taller" style="width:300px" onchange="xajax_cargar(this.value);">
              <option selected="selected" value="0"> Seleccione... </option>
              <?php
do {  
?>
              <option value="<?php echo $row_cursos['idcurso']?>"><?php echo $row_cursos['titulo']?></option>
              <?php
} while ($row_cursos = mysql_fetch_assoc($cursos));
  $rows = mysql_num_rows($cursos);
  if($rows > 0) {
      mysql_data_seek($cursos, 0);
      $row_cursos = mysql_fetch_assoc($cursos);
  }
?>
            </select></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Período/Ciudad:
          </strong></td>
          <td align="left">
          <div id="ciudadesyfechas">
            <center>Seleccione Taller Primero</center>
          </div>
          </td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>

      <tr>
          <td colspan="5"  class="borde" align="center">
          Datos a Facturar
          </td>      
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Razón Social:
          </strong></td>
          <td align="left"><label for="razon_social"></label>
            <input type="text" name="razon_social" id="razon_social" style="width:300px"/>

          </td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          RIF/CI:
          </strong></td>
          <td align="left"><label for="razon_social"></label>
            <label for="pre_rif"></label>
            <select name="pre_rif" id="pre_rif">
            <option selected="selected" value="0">
            Seleccione...
            </option>
            <option value="1">J</option>
            <option value="2">G</option>
            <option value="3">V</option>
            <option value="4">E</option>
          </select> 
            -
            <label for="suf_rif"></label>
          <input type="text" name="suf_rif" id="suf_rif"  style="width:120px"/> 
          -
          <input type="text" name="suf2_rif" id="suf2_rif" style="width:40px"/></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Teléfono:
          </strong></td>
          <td align="left">
          <input type="text" name="pre_tel1" id="pre_tel1" style="width:60px"/> 
          - 
          <label for="suf_tel1"></label>
          <input type="text" name="suf_tel1" id="suf_tel1" /></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Celular:
          </strong></td>
          <td align="left">
          <input type="text" name="pre_tel2" id="pre_tel2" style="width:60px"/> 
          - 

          <input type="text" name="suf_tel2" id="suf_tel2" /></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Fax/Otro:
          </strong></td>
          <td align="left">

          <input type="text" name="pre_tel3" id="pre_tel3" style="width:60px"/> 
          - 

          <input type="text" name="suf_tel3" id="suf_tel3" /></td>
          <td class="requerido">&nbsp;</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Dirección:
          </strong></td>
          <td align="left">
          <input type="text" name="direccion" id="direccion" style="width:300px"/>
</td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Correo:
          </strong></td>
          <td align="left">

          <label for="correo"></label>
          <input type="text" name="correo" id="correo" style="width:300px"/>
</td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td colspan="5"  class="borde" align="center">
          Participante(s)
          </td>      
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Apellido(s):
          </strong></td>
          <td align="left">

          <input type="text" name="apellidos_0" id="apellidos_0" style="width:300px"/>
</td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Nombre(s):
          </strong></td>
          <td align="left">

          <input type="text" name="nombres_0" id="nombres_0" style="width:300px"/>
</td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Cédula:
          </strong></td>
          <td align="left"><select name="pre_ced" id="pre_ced">
            <option selected="selected" value="0"> Seleccione... </option>

            <option value="3">V</option>
            <option value="4">E</option>
          </select>
            - 
            <label for="suf_ced"></label>
            <input type="text" name="suf_ced_0" id="suf_ced_0"  width="170"/></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Teléfono:
          </strong></td>
          <td align="left">
          <input type="text" name="pre_tel1_0" id="pre_tel1_0" style="width:60px"/> 
          - 
          <label for="suf_tel1"></label>
          <input type="text" name="suf_tel1_0" id="suf_tel1_0" /></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Celular:
          </strong></td>
          <td align="left">
          <input type="text" name="pre_tel2_0" id="pre_tel2_0" style="width:60px"/> 
          - 

          <input type="text" name="suf_tel2_0" id="suf_tel2_0" /></td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Fax/Otro:
          </strong></td>
          <td align="left">

          <input type="text" name="pre_tel3_0" id="pre_tel3_0" style="width:60px"/> 
          - 

          <input type="text" name="suf_tel3_0" id="suf_tel3_0" /></td>
          <td class="requerido">&nbsp;</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Correo:
          </strong></td>
          <td align="left">

          <input type="text" name="correo_0" id="correo_0" style="width:300px"/>
</td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right"><strong>
          Profesión:
          </strong></td>
          <td align="left">

          <input type="text" name="profesion_0" id="profesion_0" style="width:300px"/>
</td>
          <td class="requerido">*</td>
          <td class="borde">&nbsp;
          </td>
      </tr>
      <tr>
          <td class="borde">&nbsp;

          </td>
          <td align="right">&nbsp;</td>
          <td align="left"><input type="button" value="Agregar Participante" id="add" name="add" onclick="addTableRow($('#myTable'));"/> <input type="button" value="Mismos Datos Facturación" /></td>
          <td class="requerido">&nbsp;</td>
          <td class="borde">&nbsp;
          </td>
      </tr>

      <tr>
          <td colspan="5"  class="borde" align="center">
          &nbsp;<input type="hidden" id="num_campos" name="num_campos" value="0" />
<input type="hidden" id="cant_campos" name="cant_campos" value="0" />
          </td>      
      </tr>

      </table>
     <table align="center" border="0">
     <tr>
     <td><input type="submit" name="Submit" id="button" value="Guardar" /> <input type="reset" name="button2" id="button2" value="Restablecer" />
     </td>
     </tr>
     </table>
      </form> 
```

* * *

解决方案

最后，我想出了给每个 tr 行一个附加到生成的索引的索引：

```
function eliminar(index) {

    var r=confirm("¿Seguro Desea Eliminar este Participante?");
    if (r==true)
      {
            for (n = 0; n < 10; n++)
            {
                $('tr#row' + n + "_" + index).remove();
                                counter--;
            }
      }

}

function addTableRow(jQtable){
    jQtable.each(function(){
        var $table = $(this);
        // Number of td's in the last table row
        var n = $('tr:last td', this).length;
        var tds = "<tr id='row0_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Apellido(s)</strong></td><td><input type='text' name='apellidos_" + counter + "' id='apellidos_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td>  <td class='borde'>&nbsp;<br/>&nbsp;</td></tr><tr  id='row1_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Nombre(s):</strong></td><td align='left'><input type='text' name='nombres_" + counter + "' id='nombres_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr  id='row2_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Cédula:</strong></td><td align='left'><select name='pre_ced_" + counter + "' id='pre_ced_" + counter + "'><option selected='selected' value='0'> Seleccione... </option><option value='3'>V</option><option value='4'>E</option></select> - <input type='text' name='suf_ced_" + counter + "' id='suf_ced_" + counter + "'  width='170'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr id='row3_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Teléfono:</strong></td><td align='left'><input type='text' name='pre_tel1_" + counter + "' id='pre_tel1_" + counter + "' style='width:60px'/> - <input type='text' name='suf_tel1_" + counter + "' id='suf_tel1_" + counter + "' /></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr id='row4_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Celular:</strong></td><td align='left'><input type='text' name='pre_tel2_" + counter + "' id='pre_tel2_" + counter + "' style='width:60px'/> - <input type='text' name='suf_tel2_" + counter + "' id='suf_tel2_" + counter + "' /></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr  id='row5_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Fax/Otro:</strong></td><td align='left'><input type='text' name='pre_tel3_" + counter + "' id='pre_tel3_" + counter + "' style='width:60px'/> - <input type='text' name='suf_tel3_" + counter + "' id='suf_tel3_" + counter + "' /></td><td class='requerido'>&nbsp;</td><td class='borde'>&nbsp;</td></tr><tr  id='row6_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Correo:</strong></td><td align='left'><input type='text' name='correo_" + counter + "' id='correo_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr  id='row7_" + counter + "'><td class='borde'>&nbsp;</td><td align='right'><strong>Profesión:</strong></td><td align='left'><input type='text' name='profesion_" + counter + "' id='profesion_" + counter + "' style='width:300px'/></td><td class='requerido'>*</td><td class='borde'>&nbsp;</td></tr><tr  id='row8_" + counter + "'><td class='borde'>&nbsp;</td><td>&nbsp;</td><td><input type='button' value='Eliminar Participante' onclick=\"eliminar('" + counter + "');\"> <input type='button' value='Mismos Datos Facturación'></td><td>&nbsp;</td><td class='borde'>&nbsp;</td></tr><tr id='row9_" + counter + "'><td colspan='5'  class='borde' align='center'>&nbsp;</td></tr>";
        if($('tbody', this).length > 0){
            $('tbody', this).append(tds);
        }else {
            $(this).append(tds);
        }
    });
    counter++;
} 
```

这是函数，现在我只需要一个包含总行数的隐藏值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:13:29.740

您需要使用**[jquery on](http://api.jquery.com/on/)**将事件添加到动态添加的 html 元素。为要附加删除事件的按钮分配一个类。

```
$(document).on('click', '.remove', function (){

    $(this).remove();
    counter--;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T23:26:10.250

用解决方案更新了我的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:12:16.557

您需要删除之间的空间`.remove ();`

`$("#" + indice).remove ();`

应该：

`$("#" + indice).remove();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T17:08:20.550

好吧，我仍然看不到您首先在哪里调用该函数。似乎没有附加任何事件。但是，假设您在点击事件或类似事件中的其他地方触发它。

您已将行的 id 分配为 'row_'+counter。所以你会有一个 id="row_2" 或类似的东西。

你是 .remove() 函数（塞缪尔是正确的关于使它成为 .remove() ）应该调用

```
$('tr#row_' + index).remove(); 
```

您还可以按照 jQuery 的文档使用 .replaceWith("") 。他们做同样的事情。

# internet-explorer - IE点击后锚链接消失

> ID：13516504
> 
> 赞同：1
> 
> 时间：2012-11-22T16:09:24.983
> 
> 标签：internet-explorer

我正在使用`site_url`CodeIgniter 中的按钮，当您单击 PDF 下载按钮时。它在 Chrome 和 Firefox 中运行良好，但在 IE 中，当我单击按钮时 PDF 下载，但按钮消失。我究竟做错了什么？

这是整个代码`<li><a href="<?php echo site_url('admin/button/pdf');?>">Download PDF</a></li>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T17:06:19.877

```
<a href="<?php echo site_url('admin/button/pdf');?>">Download PDF</a> 
```

**引用 OP**：*“在 IE 中，当我点击 PDF 下载按钮时，按钮消失了。”*

那不是一个`button`，那是一个`anchor`标签，`<a></a>`。而且由于 PHP 代码在到达任何浏览器之前在服务器上进行了处理，因此您的问题与 PHP 或 CodeIgniter 无关。

如果单击后链接消失，听起来您有 CSS 问题...也许`:visited`伪类将字体颜色更改为与您的背景相匹配的颜色？

检查你的 CSS 文件是否有这样的规则。

```
 background-color: #ffffff; 
```

您正在寻找`background-color`诸如`body`,`ul`或`li`任何包含您的下载链接的特定父元素。

然后检查类似的规则。

```
a:visited {
    color: #ffffff;
} 
```

在哪里`a`定位您的特定下载链接。这很可能与它的`color`值匹配`background-color`。此外，如果这只发生在 IE 中，那么您可能有一些写得不好或无效的 CSS 伪类选择器。

# php - APNS 托管服务

> ID：13516510
> 
> 赞同：0
> 
> 时间：2012-11-22T16:09:44.007
> 
> 标签：php, mysql, web-hosting, apple-push-notifications

Apple Push Notification Service (APNS) 有什么好的服务吗？我已经检查了 Site5，但我不确定我是否无法通过 hostbasic 计划实现这一目标。他们是否允许端口 2195 和 2196 上的传出连接以便能够发送推送通知？谁能证实这一点或建议一些更好的服务？

PS（我还需要支持PHP和MySQL）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:16:19.273

1and1.com 与任何其他共享托管服务提供商都存在相同的故障，但它们为您提供了 ssh 访问权限，并且能够在需要时安装和编译软件包。有一个用于 cronjobs 的管理面板，但您也可以通过 SSH 通过 crontab 来完成。如果您对 SSH 不感兴趣，那么我会去其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T10:33:08.877

我在 site5 (hostbasic) 上购买了托管计划，一切正常。不必要求打开额外的端口，2195 和 2196 似乎已经打开了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T13:56:13.550

我最近使用了[Dreamhost](http://www.dreamhost.com/)的主机（**共享主机）**，他们打开了 2195 端口并支持 apns 下的推送通知。它对我有用，可能其他人也可以得到一些帮助。

**编辑：**

目前我正在使用**来自 Host Gator 的共享主机**，当我请求时，他们已经为我**打开了端口 2195**（仅限**外联**）及其**工作**！我可以发送通知。干杯！！！

Hostgator比 Site5**便宜，**[在这里](http://www.hostgator.com/shared) 和[这里](http://www.site5.com/hosting/web/)比较计划。

# java - 如何处理 java.lang.OutOfMemoryError

> ID：13516512
> 
> 赞同：1
> 
> 时间：2012-11-22T16:09:44.930
> 
> 标签：java

我正在运行一个makefile，过了一会儿我收到以下错误：

```
 java.lang.OutOfMemoryError 
```

我想知道是否有一个命令可以让我增加 Java 堆空间。我不想更改 makefile 本身，所以我需要某种“全局”命令来允许我重置 Java 堆空间。

非常感谢，帕特里克

编辑：感谢您的回答。但我正在寻找一个更全局的命令，它允许我一劳永逸地指定设置堆空间，例如：

设置 JAVA_HEAP_SPACE = 5GB

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:11:19.263

*   您可以从命令行设置 java 堆空间：`java -Xmx1600m program`现在您的堆空间为 1600 MB。（假设您的硬件已经负担得起 1600 MB。）

*   对于 Windows 平台，您也可以从***Java 运行时环境设置***中进行设置。按照*控制面板 => 程序 => Java*。导航到 Java 选项卡。查看 Java 运行时环境设置。添加`-Xmx1600m`到运行时参数。保存并继续。

*   对于 Linux 平台，您可以启动控制面板并编辑运行时参数。它可以从类似的东西运行`/usr/j2se/jre/bin/ControlPanel`。找到你自己的目录。请在这里阅读：http: [//docs.oracle.com/javase/7/docs/technotes/guides/deployment/deployment-guide/jcp.html](http://docs.oracle.com/javase/7/docs/technotes/guides/deployment/deployment-guide/jcp.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:12:10.037

您可以使用以下命令：

```
java -Xms64m -Xmx256m ClassName
Xms<size>        set initial Java heap size
Xmx<size>        set maximum Java heap size 
```

在此示例中，初始堆大小设置为 64MB，最大堆大小设置为 256MB。有关更多信息，请查看[此](http://viralpatel.net/blogs/jvm-java-increase-heap-size-setting-heap-size-jvm-heap/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:14:37.863

问题不是很清楚但是您应该将 -Xmx 标志视为 JVM 启动参数，以便为您的应用程序提供更多内存。请阅读[此处](http://www.caucho.com/resin-3.0/performance/jvm-tuning.xtp)了解更多信息。您还应该对您的 Java 应用程序进行分析，并查看大部分可用内存在哪里被消耗。你可以使用 JProfiler（只是谷歌关于分析你的 Java 应用程序的工具）来分析和查看关于应用程序的哪个部分消耗更多系统资源的统计信息。

# javascript - 连接2个文件

> ID：13516514
> 
> 赞同：0
> 
> 时间：2012-11-22T16:09:56.477
> 
> 标签：javascript, node.js

我有 2 个 HTML 文件。

这 2 个 HTML 文件将需要添加。

在 Javascript、Jquery 中有没有一种方法可以添加 2 个文件并获取一个文件。

在 Jquery 中，我看到了追加和其他功能，但我的用例是我想添加 2 个大文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:15:51.703

我没有确切的代码，但你不应该需要它（jQuery 有据可查）

1.  使用 Ajax 获取 HTML 数据（代码）
2.  大概你想添加内容？您需要获取 body 标签之间的数据（也可能在 head 标签之间）
3.  连接那些。请记住，ajax 数据是一个字符串

虽然，这种类型的东西对于像 PHP 这样的服务器端语言来说听起来更好。您可以对“builder”PHP 文件发出 ajax 请求，该文件将返回放在一起的两个文件。另外，如果你使用正确的模板，你不需要做头部/身体过滤杂乱的东西

示例伪代码

```
//template.php
<html>
    <head></head>
    <body>
        <?php include 'foo.php'; ?>
    </body>
</html>

//foo.php
My html content
<h1>Hello</h1>

//bar.php
My other page
<h1>About</h1>

//builder.php
<html>
    <head></head>
    <body>
        <?php include 'foo.php'; include 'bar.php'; ?>
    </body>
</html> 
```

不是最好的例子（非常非常简单），但它应该给你这个想法。在 builder.php 上获取 ajax 请求，这就是您的全部内容。您可以通过创建一个 builder.php 文件来使其更加强大，该文件采用文件名参数进行连接（并且您应该对这些文件进行验证......）

# c++ - 对孩子隐藏功能

> ID：13516527
> 
> 赞同：2
> 
> 时间：2012-11-22T16:11:08.747
> 
> 标签：c++

我希望一些孩子（继承类）看不到父类中的某些工作功能。我知道将这些设为私有意味着孩子们无法使用这些功能，但问题是他们会看到它们。我试图避免在自动完成中出现一堆“垃圾”的问题。

考虑到上述情况，我想出了一个主意。代码如下。问题是我不完全确定 secretFunc 的性质是什么。这是一个全局函数还是以某种方式属于 Parent 类？它没有在头文件中声明，它只是在 cpp 中定义。这个想法是我可以在 Parent 中拥有一些像这样的工作功能，然后这些功能将从 Child 类中隐藏起来。是一种更精英的方式来做到这一点吗？即使有，我还是想了解一下 secretFunc 的本质。

```
#ifndef PARENT_H
#define PARENT_H

class Parent
{
public:
    Parent();
    ~Parent();

private:
    void privateFunc();
protected:
    void protectedFunc();
public:
    void publicFunc();

};

#endif 
```

* * *

```
#include "Parent.h"

//What is the nature of this function???
void secretFunc()
{
}

UnitTest::UnitTest()
{
}

UnitTest::~UnitTest()
{
}

void UnitTest::privateFunc()
{
}

void UnitTest::protectedFunc()
{
}

void UnitTest::publicFunc()
{
} 
```

* * *

```
#ifndef CHILD_H
#define CHILD_H

#include "Parent.h"

class Child : public Parent
{
public:
    Child();
    ~Child();
};

#endif 
```

* * *

```
#include "Child.h"

UnitTest::Child()
{
}

UnitTest::~Child()
{
}

//Auto complete can see private Parent functions!
//Of course, child can't use them, but it can see them.
//I wish to hide these private functions from child.

//Auto complete can see and can also use protected Parent funcitons.
//As should be...

//Auto complete can see and can also use public Parent funcitons.
//As should be...

//secetFunc should be invisible. 
```

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:38:36.723

你得到`secretFunc()`的本质上与你得到的相反`privateFunc()`。那是：

*   `privateFunc()`可见但不可访问（只有其他`Parent`方法可以调用它）。
*   `secretFunc()`不可见，但可访问。

详细地说，一个定义为 like 的自由函数`secretFunc()`在全局命名空间中，即使头文件中没有可用的声明。因此，只要它是正确的，与之链接的任何其他文件中的代码`Parent.cpp`都可以通过编写自己的声明来调用。`secretFunc()`

也就是说，`Child.cpp`可以包含

```
void secretFunc(); 
```

在顶部，这使函数可见，然后任何内容都`Child.cpp`可以调用`secretFunc()`.

如果您要做的只是使该功能对自动完成不可见，那么这可能不是问题。但是您可以同时实现隐形和不可访问。您需要做的是`secretFunc`从全局命名空间中删除。您可以通过将其封闭在匿名命名空间中来做到这一点。

所以在`Parent.cpp`你写：

```
namespace {
  void secretFunc() {
     // ...
  }
} 
```

这使得该函数对`Parent.cpp`文件之外的任何内容都是不可见和不可访问的。如果`Child.cpp`要进行自己的声明（如上所述），链接器将产生错误，因为它无法`secretFunc`在全局命名空间中找到具有该名称的函数。

请注意，这与私有方法不同，方式如下：

*   可访问性仅限于`Parent.cpp` *文件*中的内容，而不是`Parent` *类*。
*   因为它不是 的类成员`Parent`，所以它没有对对象的特殊访问`Parent`（并且没有`this`指针）。

最后一件事。使用`static`关键字而不是将函数封闭在匿名命名空间中具有相同的效果，但这是 C-ism。使用匿名命名空间是惯用的 C++ 方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:18:09.510

这`secretFunc`是一个独立的函数，任何看到它或其声明的人都可以调用它。它与类方法的不同之处在于它无法访问调用它的类实例的成员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T16:20:07.363

对于您关于从自动完成中隐藏私有成员函数的问题，这取决于您的 IDE，但[如果您使用的是 Visual Studio，它看起来是不可能的](https://stackoverflow.com/questions/9027338/how-to-hide-private-members-of-a-class)。[如果您使用的是 Qt Creator，它看起来也是不可能的](https://bugreports.qt-project.org/browse/QTCREATORBUG-1984)。我不确定 Eclipse，但我怀疑它也不可能。当我说“不可能”时，我的意思是如果不更改您的代码就不可能。pimpl[习惯用法](http://c2.com/cgi/wiki?PimplIdiom)可用于隐藏私有成员以及外部依赖项。当然，您`private pimpl`仍然可以通过自动完成看到，但它是一个不完整的指针类型，所以它对用户没有多大用处，它只是一个成员。

对于您关于 的问题`secretFunc`，如果您制作`secretFunc` `static`，那么只有 Parent.cpp 才能看到和使用它。就目前而言，任何其他源文件都可以说`extern void secretFunc();`然后开始使用`secretFunc`.

如果你给它`static`修饰符（`static void secretFunc()`），那么它只能被它所在的源文件看到。链接器不会将它暴露给其他翻译单元。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T17:26:35.203

您可以拥有私有虚函数，并且可以在派生类中覆盖（但不能调用）它们。正如他们所说，这种语言功能在狭窄的圈子中广为人知。人们在生产代码中使用它。

因此，对 IDE 隐藏私有成员似乎会适得其反。

在 VS 中，您可以使用一些预处理器技巧从 IntelliSense 隐藏任何成员：

```
#ifndef __INTELLISENSE__    
void ThisShouldNotBeSeen() {}
#endif 
```

但这会将它隐藏在任何地方的 IntelliSense 中，而不仅仅是在派生类中。这在开发父类本身时很不方便，因为您会得到很多虚假的 IntelliSense 错误和红色下划线。将此宏添加到您发布的头文件中可能很有用。

我不确定其他 IDE。

# wkhtmltopdf - 如何避免 wkhtmltopdf 表格行内的分页符

> ID：13516534
> 
> 赞同：88
> 
> 时间：2012-11-22T16:11:36.937
> 
> 标签：wkhtmltopdf, pdfkit

我正在用**一张表格**从 html 页面生成 pdf 报告。

我为此目的使用**wkhtmltopdf**。

生成 pdf 时，它**会在 tr tag 中的任何位置中断**。

我想避免它。

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2012-11-23T09:01:26.887

**17.09.2015更新：**检查您使用的版本：[wkhtmltopdf 0.12.2.4 据说可以解决问题（我没有检查）](https://github.com/wkhtmltopdf/wkhtmltopdf/commit/5dea2532977e5e9fbcb8da7aa3bd399b257096f4)。

* * *

这是 wkhtmltopdf 中的一个已知问题。webkit 使用的分页算法（WKhtmltopdf 中的 WK）对于大表并不适用。我建议将表格分解成更小的块，这些块更容易拆分为页面并大量使用 css：

```
table, tr, td, th, tbody, thead, tfoot {
    page-break-inside: avoid !important;
} 
```

还请查看以下 wkhtmltopdf 问题，他们有有趣的评论，例如讨论表拆分问题。有一个 JS 解决方案可以以编程方式将表拆分为 168，这可能会对您有所帮助（虽然我不使用它）。

*   [https://code.google.com/p/wkhtmltopdf/issues/detail?id=168](https://code.google.com/p/wkhtmltopdf/issues/detail?id=168)
*   [https://code.google.com/p/wkhtmltopdf/issues/detail?id=9](https://code.google.com/p/wkhtmltopdf/issues/detail?id=9)

**更新 08.11.2013** 上面链接的第 168 期对此进行了很多讨论。有人设法编译了一个支持更好的分表的 wkhtmltopdf 版本，但不幸的是，它似乎没有正式发布并且可能包含其他错误。我不知道如何获取它，也不知道如何在 Windows 上编译，但任何有兴趣的人都可以查看~~[这里](https://code.google.com/p/wkhtmltopdf/issues/detail?id=168#c85)~~的评论（请参阅下面的新更新）。

**2014 年 2 月 24 日更新** 您会很高兴听到在 wkhtmltopdf 0.12 中此功能已得到极大改进。然而，在开始使用任何新版本之前等待 0.12.1 并彻底测试，尽管使用 antialize 的新人做得很好（ashkulz 摇滚），但它仍然有点不稳定！[在wkhtmltopdf.org](http://wkhtmltopdf.org/)和[github](https://github.com/wkhtmltopdf/wkhtmltopdf)保持更新。谷歌代码站点已经过时并且正在缓慢迁移。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-08-31T18:43:57.370

这是旧帖子，但由于我浪费了很多时间试图找到合适的解决方案，我会把它放在这里，也许它会对某人有用。

所以从我读到的，问题是

```
page-break-inside: avoid 
```

是它不起作用。但实际上，如果您将它设置在可以按预期工作的元素上`display:block`（如 SO 中的某处所述）。所以对于表格css的简单结构

```
td div, th div{
    page-break-inside: avoid;
} 
```

和表结构

```
<table>
....
<tr>
    <td><div>some text</div></td>
    <td><div>more text</div></td>
</tr>
....
</table> 
```

将按预期工作。

我的行跨度有点复杂，所以上面的解决方案是将其打破，这不是预期的效果。我使用 div 为每行跨行集解决了这个问题。我的 jquery js 完成了所有的工作：

```
$(window).load(function () {
    var sizes = {};
    $('#the_table tr:first th').each(function (a, td) {         
        var w = $(td).width();
        if (sizes.hasOwnProperty('' + a)) {
            if (sizes['' + a] < w)
                sizes['' + a] = w;
        }
        else {
            sizes['' + a] = w;
        }
    });

    var tableClone = $('#the_table').clone();
    $('#the_table').replaceWith('<div class="container"></div>');

    var curentDivTable;
    var cDiv = $('.container');
    tableClone.find('tr').each(function (i, ln) {
        var line = $(ln);
        if (line.hasClass('main_row')) {
            var div = $('<div class="new-section"><table><tbody>')
            currentDivTable = div.find('tbody');
            cDiv.append(div);               
        }
        currentDivTable.append(line);
    });
    //optional - maybe in % its better than px
    var sum = 0;
    $.each(sizes, function (a, b) {
        sum += b;
    });
    var widths = {};
    $.each(sizes, function (a, b) {
        var p = Math.ceil(b * 100 / sum);
        widths['' + a] = p + '%';
    });
    //setup
    $('.container table').each(function (a, tbl) {
        $(tbl).find('tr:first td, tr:first th').each(function (b, td) {
            $(td).width(widths['' + b]);
        });
        $(tbl).addClass('fixed');
    });
}); 
```

CSS：

```
div.new-section {
    page-break-inside: avoid;
}
.container, .new-section, .new-section table.fixed{
    width: 100%;
}

.new-section table.fixed{
    table-layout:fixed;
} 
```

我不知道是否需要一切，我不认为它是完美的，但它可以完成工作。仅在 chrome 上测试

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2015-09-15T12:25:05.657

自 0.12 以来，此问题已得到解决，但有时，当表格太长而无法放入页面时，wkhtmltopdf 会将其分成两部分并在新页面上重复列标题，并且这些列标题会叠加到第一行。

我在 wkhtmltopdf github 问题部分找到了这个问题的临时解决方案： [https ://github.com/wkhtmltopdf/wkhtmltopdf/issues/2531](https://github.com/wkhtmltopdf/wkhtmltopdf/issues/2531)

只需将此行添加到您的视图 css 中：

```
tr {
  page-break-inside: avoid; 
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-01-10T08:31:54.707

我已经研究了几天这个问题，终于找到了完美的解决方案。你可以参考这个项目[phpwkhtmltopdf](https://github.com/subtlephp/phpwkhtmltox)。查看目录`article`，您会发现 3 个问题的 3 个解决方案。总之，最终的解决方案是添加css样式

```
thead {
    display: table-row-group;
}
tr {
    page-break-before: always;
    page-break-after: always;
    page-break-inside: avoid;
}
table {
    word-wrap: break-word;
}
table td {
    word-break: break-all;
} 
```

如果您是中国人，请随时查看[有关 wkhtmltopdf 的网站，](http://pipe.b3log.org/blogs/happyhacker/articles/2018/02/28/1519809638546)您一定想知道这些 如果您想[了解 wkhtmltopdf的要点，请查看要点](https://gist.github.com/lovelock/70b76ef8db5b8a2d9c3fbd9f2975523f)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-02-08T21:36:57.010

在我的特殊情况下，由于某种原因，以前的答案都没有对我有用。最终起作用的实际上是几件事的结合。

1.  我使用 pip3 安装了（在 Ubuntu 16.04 中）[名为 pdfkit 的 Wkhtmltopdf python 包装器](https://pypi.python.org/pypi/pdfkit)，然后**我没有通过 apt-get 安装 Wkhtmltopdf，而是按照下面的脚本安装了静态二进制文件（版本 0.12.3），[取自此处](https://github.com/JazzCore/python-pdfkit/blob/master/travis/before-script.sh)**

    ```
    #!/bin/sh

    sudo apt-get install -y openssl build-essential xorg libssl-dev
    wget http://download.gna.org/wkhtmltopdf/0.12/0.12.3/wkhtmltox-0.12.3_linux-generic-amd64.tar.xz
    tar -xJf wkhtmltox-0.12.3_linux-generic-amd64.tar.xz
    cd wkhtmltox
    sudo chown root:root bin/wkhtmltopdf
    sudo cp -r * /usr/ 
    ```

2.  添加了这个 CSS（如这里的答案之一所建议的那样）：

    ```
    tr, td div, th div{
        page-break-inside: avoid;
    } 
    ```

3.  然后**也**按照这里的建议添加`<thead>`和`<tbody>`标签（没有这些，表格仍然会以一种丑陋的方式破坏）：

    ```
    <table>
        <thead>
            <tr>
                <th>Column 1</th>
                <th>Column 2</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>Value 1</td>
                <td>Value 2</td>
            </tr>
        </tbody>
    </table> 
    ```

通过这些修改，我现在可以成功地使用[Mako 模板](http://www.makotemplates.org/)生成 HTML，然后将其提供给 Wkhtmltopdf 并获得精美的分页 PDF。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-08-12T06:57:30.307

我尝试了对我的表格进行各种操作，但我尝试的任何方法都无法阻止将分页符放在一行的中间。无奈之下，我尝试了不同的版本，结果如​​下：

Wkhtmltopdf 0.12.2.1：不好

Wkhtmltopdf 0.12.3：不好

Wkhtmltopdf 0.12.1：好

我的解决方案是降级到版本 0.12.1，这解决了我的问题。诚然，他们可能部分是由于我对我的 html 不是超级强迫症，但由于 HTML 是在 TinyMCE 内部生成的（由用户），我真的没有太多选择。

此外，嵌套表不适用于我的任何版本。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-11-13T06:07:23.853

我遇到了同样的问题，经过大量的试验 n 错误后，这个 css 解决了这个问题

```
tr {
    display: inline-table;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-01-12T07:17:30.400

**如何在不中断 tr 的情况下在 pdf 中使用分页符？**

这是您可以在任何 html 文件中使用的解决方案.....

启动 tr 后，您必须在 tr 中取一个 div 并将这个 css 提供给 div：

```
<tr>
      <div style="page-break-inside:avoid !important; page-break-after:auto !important; overflow: hidden; display:block !important; width:100% ">
     </tr> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-07-19T16:32:02.507

我结合使用一些建议的解决方案解决了这个问题。

我将表格包装在一个 div 中并定义了以下 CSS。

```
.wrapping-div {
        display: block;
        page-break-inside: avoid !important;
    }

.wrapping-div table, .wrapping-div tbody, .wrapping-div tr, .wrapping-div td, .wrapping-div th {
        page-break-inside: avoid !important;
    } 
```

完成后的表结构定义如下示例：

```
<div class="wrapping-div">
 <table>
  <tbody>
   <tr>
    <th>
      header
    </th>
    <td>
      content
    </td>
   </tr>
  </tbody>
 </table>
</div> 
```

我不需要在 td 或 th 标签内创建任何 div 。

我在尝试解决问题时注意到的重要事项：

*   tbody 必须包含在表中
*   div 必须有 display: block
*   当一个表格不适合一个页面时，它会自动将整个表格移动到下一页（我没有尝试过这个巨大的表格）
*   如果您只从 CSS 中删除**“.wrapping-div table”**选择器，它将允许将表格分成两页，但会正确呈现它，而不是在两页中破坏一个单元格（这就像 Word 上的默认行为)

我希望这有帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-05-30T11:13:03.017

除了 Nanotelep 所说的，这里是手动表格分页算法的工作实现。 [https://github.com/Averin/JSUtils/tree/master/wkhtmltopdfTableSplitHack](https://github.com/AAverin/JSUtils/tree/master/wkhtmltopdfTableSplitHack)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-08-18T22:09:58.997

上面的答案对我不起作用。我必须专门禁用我的 pdfkit 配置的缩放选项。

```
PDFKit.configure do |config|

  config.default_options = {
    print_media_type: false,
    page_size: "A4",
    encoding: "UTF-8",
    ## Make sure the zoom option is not enabled!
    ## zoom: '1.3',
    disable_smart_shrinking: false,
    footer_right: "Page [page] of [toPage]"
  }

end 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-11-20T19:57:00.973

对于任何对此仍有疑问的人，要记住的一件事是**table**必须是**body**的直接子级，否则 css 将无法工作（至少这就是我发生的事情）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-06-22T03:37:45.863

我找到了这个荒谬的解决方案，但**它对我来说效果很好**:)

我只是像这样放了一个很长的行跨度列

```
<td rowspan="XXX TOTAL ROWS" style="width:0px"></td> 
```

然后桌子就不会破裂。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-06-22T21:42:37.173

另一种选择：将每个`tr`单独放置`tbody`，然后将 peage break css 规则应用于`tbody`. 表支持多个`tbody`s。

一些额外的标记，但对我来说工作得体。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-09-04T12:24:41.707

我一直在努力解决这个问题，使用最新的[h4cc/wkhtmltopdf-amd64 版本 0.12.4](https://packagist.org/packages/h4cc/wkhtmltopdf-amd64#0.12.4)并最终通过将包的版本降级为`0.12.3`!

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-07-23T09:48:00.087

为了避免分页符，我们可以使用分页符避免 css 选项。

```
tr { page-break-inside: avoid; } 
```

打破任何内容**（图像/文本）**并使其出现在**下一页**

```
.sample-image { page-break-before: always; } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-11-22T16:17:42.677

你有台头吗？和一个表体？

```
<table>
<tbody>
<tr><th>Name</th><th>Value</th></tr>
<tr><td>url</td><td>stackoverflow.com</td></tr>
<tr><td>ip</td><td>123.123.123.123</td></tr>
</tbody>
</table> 
```

这是表格的正确格式，虽然大多数*浏览器*不在乎，但您提到的*转换器*`<tbody>`可以，如果您缺少或`<th>`标签，我建议您先尝试添加这些。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-05-19T15:56:36.853

使用相应的类添加此 CSS

```
#main_div {
        position: relative;
        width: 672px; /* find your width in px based on the page margins */
    }
tr td {
        page-break-before: auto;
        page-break-inside: avoid !important;
    } 
```

但最重要的是为**包含表格（或某些父 div）的容器提供以像素为单位的固定宽度**。应该适用于大多数（WebKit）pdf 生成器，并允许它们正确计算高度。

我可以确认在 kubuntu 20.04 中使用 wkhtmltopdf 0.12.6（带有修补的 qt）对我有用

# c++ - 如何使用大值在 C++ 中表示未定义的数字？

> ID：13516535
> 
> 赞同：0
> 
> 时间：2012-11-22T16:11:38.850
> 
> 标签：c++, numbers, numerical-methods

在 C++ 中，我想使用一对大值来表示一个未定义的数字：

```
void setUndefined(float& a) {
    a = set_undefined_value;
}

bool isUndefined(float a) {
    return a > is_undefined_value;
} 
```

我想对所有数字类型以及模板化代码使用这种方法，所以我在考虑模板的行：

```
template<typename T>
    class Undefined {
    public:
        static T set_undefined_value() {
            NOT_IMPLEMENTED_FOR_THIS_TYPE_YET;
        }
        static T is_undefined_value() {
            NOT_IMPLEMENTED_FOR_THIS_TYPE_YET;
        }
    };

    // Template specialization for all numeric types: ... 
```

**如何为所有数字类型找到合适的值对？**

有没有什么方法可以使用 std::numeric_limits::max() 模板？

如果我将未定义的值写入文件，它们是否可以跨计算机和操作系统移植？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T17:15:41.740

对于浮点数和双精度数，为每个对应于 IEEE754 中的 NaN 选择一个位模式。然后，您可以制作一个宏，用于在所有可以想象的编译器和所有可以想象的浮点优化上测试 nan。

对于有符号整数，使用最大的负值（0x80...）

对于无符号整数，使用最正值 (0xFF...)

# node.js - Node.JS MVC - 在哪里放置数据访问代码？

> ID：13516538
> 
> 赞同：8
> 
> 时间：2012-11-22T16:11:52.367
> 
> 标签：node.js

我现在有一些小型 Node.js / Express 应用程序正在运行，但我从未对任何数据库访问解决方案感到满意。

*   我从包含数据库访问的“胖控制器”开始；
*   我尝试使用 Mongoose 的“胖模型”，但这严重污染了具有数据库访问权限的模型；
*   我尝试了一种用 Java 实现的 DAO 模式，并将我的模型转换回值对象来移动数据，但这感觉不是很惯用。

您认为 Node.js MVC Web 应用程序的数据库访问代码在哪里？

回来ActiveRecord，一切都被原谅了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:27:11.217

在我看来，这实际上取决于您正在使用哪种数据库架构。使用 MySQL 时，我通常在控制器中使用它们，而使用 MongoDB 时，我将它们放入模型中，因为它感觉更自然。老实说，由于 NodeJS 更像是升级后的 javascript，因此 MVC 完全是关于定义的。

当通过 NPM 考虑 MVC 和 NodeJS 的结构时，曾经很容易想到将数据库访问转移到一个新模块中。我也不完全满意您在 nodeJS 中实现数据库访问的方式。

虽然使用 Express 时，我们通常应用 RESTful 接口并使用路由来填充 CRUD 操作。我的应用程序从来没有那么大，这样的行为本来会非常大，但是对于大型项目，人们可能想要像这样构建路由

```
app.get('/api/item', function(req, res){
 //access to your API and do database business
}); 
```

通过将它们拆分为一个调用的数据库访问文件`datbase.js`，可以将它们加载到您的主应用程序中

```
require('./datbase.js').setupDatabase('localhost', port); 
```

例如，这样的数据库组织者可能看起来像

```
function setupDatabase(address, port) {
  //connect to your datbase
  //access to your API and do database business
 });
}

module.exports.setupDatabase = setupDatabase; 
```

我个人从未以这种方式尝试过，但我认为这可以帮助您更好地构建访问数据库的方式。希望这有帮助！

**编辑** 作为一个 CRUD 的实现，我要求我用 Mongoose 发布一个。您可以与您正在使用的所有其他数据库交换它

```
var application_root = __dirname,
 express = require("express"),
 path = require("path"),
 mongoose = require('mongoose');

var app = express();

mongoose.connect('mongodb://localhost/my_database');

var Item = mongoose.model('Item', new mongoose.Schema({
  text: String
}));

app.configure(function(){
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(path.join(application_root, "public")));
});

app.get('/', function(req, res){
  res.send('Hello World');
});

app.get('/item', function(req, res){
  res.render('item', {title: "Your App"});
});

app.get('/api/items', function(req, res){
  return Item.find(function(err, items) {
    return res.send(items);
  });
});

app.get('/api/items/:id', function(req, res){
  return Item.findById(req.params.id, function(err, item) {
    if (!err) {
      return res.send(item);
    }
  });
});

//etc. 
```

所有这些 CRUD 操作都适用于您在 Backbone 应用程序中引入的模型并将其与 MongoDB 连接。除了使用 MongoDB 的一般路径之外，您还可以使用其他包通过使用 NPM 创建 mysql 查询并安装我发现有时非常有用的[nodejs-mysql-native 。](https://github.com/sidorares/nodejs-mysql-native)

# c++ - 嵌套成员类型识别

> ID：13516548
> 
> 赞同：0
> 
> 时间：2012-11-22T16:12:36.870
> 
> 标签：c++, c++11, sfinae

今天，我试图对某个类是否具有嵌套类型进行类型切换`reverse_iterator`。我在这些论坛上找到了一些可行的解决方案，如下所示：

```
template<typename T>
struct is_reverse_iterable
{
    using yes   = uint8_t;
    using no    = uint16_t;

    template<typename U>
    static yes& test(typename U::reverse_iterator*);

    template<typename>
    static no& test(...);

    static constexpr bool value = sizeof(test<T>(0)) == sizeof(yes);
}; 
```

如果我只是从 main 中检查条件，这个类就可以正常工作，但是，我还编写了那个小函数，这会导致一些问题。

```
template<typename T>
void foo(T&& iter)
{
    std::cout << typeid(T).name() << std::endl;
    std::cout << is_reverse_iterable<T>::value << std::endl;
} 
```

这是导致我出现一些问题的主要原因：

```
int main()
{
    using namespace std;

    vector<int> v;

    cout << typeid(decltype(v)).name() << endl;
    cout << is_reverse_iterable<decltype(v)>::value << endl;

    foo(v);

    return 0;
} 
```

由于`std::vector<int>`包含嵌套类型 name `reverse_iterator`，人们会认为 - 或者至少，我认为 -`is_reverse_iterable<vector<int>>::value`无论我放在哪里都会返回 true。但事实并非如此。这是上面主要的结果：

```
St6vectorIiSaIiEE
1
St6vectorIiSaIiEE
0 
```

当从 main 调用时，结构`is_reverse_iterable`识别 中的名称`reverse_iterator`，`vector<int>`但从 调用时它没有这样做`foo`。实际上，我不知道为什么，我希望有人向我解释问题所在:)

PS：我使用 MinGW g++ 4.7.1 编译，选项 -std=c++11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:57:15.610

问题是当你调用时`foo(v)`，它被推断`T`为类型`std::vector<int>&`（**一个左值引用**），所以`typename T::reverse_iterator`不会编译。您可以自己轻松检查：

```
template<typename T>
void foo(T&& iter)
{
    std::cout << typeid(T).name() << std::endl;
    std::cout << is_reverse_iterable<T>::value << std::endl;

    typename T::reverse_iterator t;  // <-- add this line to see what's wrong
} 
```

产量：

```
3.cpp: In instantiation of ‘void foo(T&&) [with T = std::vector<int>&]’:
3.cpp:40:10:   required from here
3.cpp:27:34: error: ‘std::vector<int>&’ is not a class, struct, or union type 
```

解决方案很简单：在启动 SFINAE 之前删除引用，例如

```
static constexpr bool value = sizeof(test<typename std::decay<T>::type>(0))
                                == sizeof(yes); 
```

# c# - 陷入无限循环

> ID：13516550
> 
> 赞同：2
> 
> 时间：2012-11-22T16:12:46.327
> 
> 标签：c#, foreach, try-catch, infinite-loop, do-while

我看不到这里的问题。

当我调用一个条目时，我陷入了无限循环。

我正在做 wcf，所以我的服务器工作正常。这是我的客户。如果我把循环拿出来，一切都会奏效。但我需要这些作为菜单。所以我知道我的代码是正确的，但我的循环不是。

看不到我哪里出错了。

```
class Client
{
    static void Main(string[] args)
    {
        try
        {
            BikeReference.BikeSalesClient bikeRef = new BikeClient.BikeReference.BikeSalesClient();
            String menu = "\n\nEnter:\n" +
                "0 to get all the bike stock;\n" +
                "1 to get all the bike types;\n" +
                // ...
                "8 to quit:\n";

            Console.WriteLine(menu);

            // will throw FormatException if not int
            int entry = int.Parse(Console.ReadLine());

            do
            {
                switch (entry)
                {
                    case 0:
                        foreach (var obj in bikeRef.GetAllBikeStock())
                        {
                            Console.WriteLine("");
                            Console.WriteLine("Bike ID: {0}", obj.IdBikeStock);
                            Console.WriteLine("Bike Type ID: {0}", obj.IdBikeType);
                            // ...
                            Console.WriteLine("Sold: {0}", obj.isItSold);
                            //break;
                        }
                        break;

                    case 1:
                        Console.WriteLine(bikeRef.UpdateBikeStock(15));
                        break;

                    default:
                        Console.WriteLine("Unrecognised option...");
                        break;
                }
            }
            while (entry != 7);
        }

        catch (Exception)//(Exception e)
        {
           // Console.WriteLine("{0} Exception caught.", e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:15:05.450

更改循环内的入口变量

```
int entry = 0; //Init
do
{
    Console.WriteLine(menu);

    // will throw FormatException if not int
    entry = int.Parse(Console.ReadLine());
    ...
} while (entry != 7); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T16:14:13.890

在循环内部，您没有修改变量“entry”。因此，除非您的第一个条目 = 7，否则您将陷入循环，因为`(entry != 7)`在`while (entry != 7);`

`entry = int.Parse(Console.ReadLine());`在前面添加行`switch (entry)`这样，您将继续要求“输入”，因为输入可能等于 7。因此，退出循环。

```
 int entry;

    do
    {  
        Console.WriteLine(menu);

        entry = int.Parse(Console.ReadLine());
        switch (entry)
        //...
   }while (entry != 7); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T16:31:07.277

如上所述，您必须更改`entry`循环内的变量：

```
class Client
{
    static void Main(string[] args)
    {
        try
        {
            BikeReference.BikeSalesClient bikeRef = new BikeClient.BikeReference.BikeSalesClient();
            String menu = "\n\nEnter:\n" +
                "0 to get all the bike stock;\n" +
                "1 to get all the bike types;\n" +
                // ...
                "8 to quit:\n";

            Console.WriteLine(menu);

                // will throw FormatException if not int
                int entry = int.Parse(Console.ReadLine());

            do
            {
                switch (entry)
                {
                    case 0:
                        foreach (var obj in bikeRef.GetAllBikeStock())
                        {
                            Console.WriteLine("");
                            Console.WriteLine("Bike ID: {0}", obj.IdBikeStock);
                            Console.WriteLine("Bike Type ID: {0}", obj.IdBikeType);
                            // ...
                            Console.WriteLine("Sold: {0}", obj.isItSold);
                            //break;
                        }
                        break;

                    case 1:
                        Console.WriteLine(bikeRef.UpdateBikeStock(15));
                        break;

                    default:
                        Console.WriteLine("Unrecognised option...");
                        break;
                }
            entry = int.Parse(Console.ReadLine());
            }
            while (entry != 7);
        }

        catch (Exception)//(Exception e)
        {
           // Console.WriteLine("{0} Exception caught.", e);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T16:15:28.043

您必须在切换后等待输入。否则条目不能变成 != 7

# c# - 使用 Kinect 获取面部点的深度信息

> ID：13516555
> 
> 赞同：0
> 
> 时间：2012-11-22T16:13:04.393
> 
> 标签：c#, sdk, kinect, face-recognition, depth

我目前正在使用 Microsoft 的 SDK 跟踪人脸，可以检测到人脸的 121 个点。我可以得到以下庄园的点坐标：

```
 if (!this.lastFaceTrackSucceeded || this.skeletonTrackingState != SkeletonTrackingState.Tracked)
                return;

            var faceModelPts = new List<Point>();
            var faceModel = new List<FaceModelTriangle>();

            for (int i = 0; i < this.facePoints.Count; i++)
            {
                faceModelPts.Add(new Point(this.facePoints[i].X + 0.5f, this.facePoints[i].Y + 0.5f));
                FaceDataPoints.XPointInfo[i] = this.facePoints[i].X;
                FaceDataPoints.YPointInfo[i] = this.facePoints[i].Y;
            } 
```

但这些点似乎是彩色图像的坐标。如何获取有关每个像素的相应深度信息。比如用户脸上的“20”点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T18:25:12.930

找到了答案

“GetProjected3DShape”形状包含面部跟踪基础使用的 2D 坐标

要获取深度信息，请使用“Get3DShape”

2的比较

```
 private EnumIndexableCollection<FeaturePoint, PointF> ColourPoints;

        private EnumIndexableCollection<FeaturePoint, Vector3DF> DepthPoints; 
```

深度点保存每个面部点的 X、Y 和 Z 坐标信息

# vb.net - 表单背景图像的视觉问题

> ID：13516557
> 
> 赞同：0
> 
> 时间：2012-11-22T16:13:09.913
> 
> 标签：vb.net, image, visual-studio, visual-studio-2012, background-image

这是应用程序的设计：

![在此处输入图像描述](../Images/79d0e98ba4cd6e1a49f99f6b6c7f402e.png)

这就是我向上或向下使用滚动条时发生的情况：

![在此处输入图像描述](../Images/f8978c892b839bcdbc86f67a594f0bfe.png)

复选框在面板内，面板是透明的（很明显），只有表单使用背景图像。

为什么会发生这种失真以及如何解决问题？

PS：如果您需要更多信息或所有表格或其他内容，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T14:14:00.310

有效的解决方案是创建一个自定义面板（从控制面板继承的类），并使用 API 调用 LockWindowUpdate 和用于防止滚动闪烁的 OptimizedDoubleBuffer 属性制作锁定重绘的必要代码。

```
Public Class MyPanel
Inherits Panel
Public Sub New()
    Me.AutoScroll = True
    Me.SetStyle(ControlStyles.SupportsTransparentBackColor, True)
    Me.SetStyle(ControlStyles.OptimizedDoubleBuffer, True)
End Sub
Private mImage As Image
Public Property Image() As Image
    Get
        Return mImage
    End Get
    Set(ByVal value As Image)
        mImage = value
        Invalidate()
    End Set
End Property
Protected Overrides Sub OnScroll(ByVal se As ScrollEventArgs)
    If se.Type = ScrollEventType.First Then
        LockWindowUpdate(Me.Handle)
    ElseIf se.Type = ScrollEventType.ThumbTrack OrElse se.Type = ScrollEventType.ThumbPosition Then
        LockWindowUpdate(IntPtr.Zero)
        Me.Refresh()
        LockWindowUpdate(Me.Handle)
    Else
        LockWindowUpdate(IntPtr.Zero)
        Me.Invalidate()
    End If
    MyBase.OnScroll(se)
End Sub
Protected Overrides Sub OnPaint(ByVal e As PaintEventArgs)
    Console.WriteLine(e.ClipRectangle.ToString())
    Using br As New SolidBrush(Me.BackColor)
        e.Graphics.FillRectangle(br, Me.ClientRectangle)
    End Using
    If mImage IsNot Nothing Then
        e.Graphics.DrawImage(mImage, 0, 0)
    End If
    MyBase.OnPaint(e)
End Sub
<DllImport("user32.dll")> _
Private Shared Function LockWindowUpdate(ByVal hWnd As IntPtr) As Boolean
End Function
End Class 
```

就像 Visual Basic 的一个普通面板，它继承了面板的所有属性，除非你编写程序来做你想做的事情。请注意，您必须在控制栏中显示为一个控件，称为“MyPanel”，然后将其重命名为您想要的。要以您控制的方式出现，您必须构建解决方案。

你把表格和瞧，你使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:43:28.643

乍一看，如果没有一些低级的调整，这似乎是不可能的。但我找到了一个“有点”的解决方法。

1.  在您的面板上创建*OnScroll*事件
2.  使用一些背景颜色（如黑色）重新绘制它，然后再次将其设置为透明

这是我的面板滚动事件处理程序中的 C# 代码。

```
private void panel1_Scroll(object sender, ScrollEventArgs e)
{
    panel1.BackColor = System.Drawing.Color.Empty;
    panel1.BackColor = System.Drawing.Color.Transparent;
} 
```

## 编辑

由于此事件仅适用于您的滚动条，因此您希望在鼠标滚轮滚动上实现相同的操作。在 VB 中很简单，只需添加另一个函数即可。

这是完整的代码

```
Private Sub Panel1_Scroll(sender As Object, e As ScrollEventArgs) Handles Panel1.Scroll
    Panel1.BackColor = System.Drawing.Color.Empty
    Panel1.BackColor = System.Drawing.Color.Transparent
End Sub

Private Sub Panel1_MouseScroll(sender As Object, e As MouseEventArgs) Handles Panel1.MouseWheel
    Panel1.BackColor = System.Drawing.Color.Empty
    Panel1.BackColor = System.Drawing.Color.Transparent
End Sub 
```

而已。现在它在滚动条和鼠标滚轮上的工作方式相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T17:48:10.120

The ScrollableControl class, the parent of Panel, doesn't override the OnPaintbackground() method like it should to draw the image correctly. The combination with the "Show window contents while dragging" option that's turned on for all modern Windows versions makes a mess of it.

Add a new class to your project and paste the code shown below. Compile. Drag the new control from the top of the toolbox onto your form, replacing the old one.

```
using System;
using System.Windows.Forms;

class MyPanel : Panel {
    public MyPanel() {
        this.DoubleBuffered = true;
    }
    protected override void OnPaintBackground(PaintEventArgs e) {
        if (this.BackgroundImage != null) {
            e.Graphics.TranslateTransform(this.AutoScrollPosition.X, this.AutoScrollPosition.Y);
            e.Graphics.Clear(this.BackColor);
            e.Graphics.DrawImage(this.BackgroundImage, 0, 0);
        }
        else base.OnPaintBackground(e);
    }
} 
```

# html - XSL 中的表列拆分问题

> ID：13516560
> 
> 赞同：0
> 
> 时间：2012-11-22T16:13:26.340
> 
> 标签：html, css, xml, xslt

![在此处输入图像描述](../Images/e39ec759cc7dd1007da1b0f48243e83d.png)![在此处输入图像描述](../Images/b12b15829229126475729d59739a7bab.png)我正在寻找此代码中的错误，我的表格列被分成两行，但我想在单行中显示列数据。同一张表用于在其他 senario 中显示数据并且工作正常。我相信列数据“数据不可用”将内容拉入 2 行，任何输入都会有很大帮助。

```
<table style="width=73%;table-layout:auto" border="0"  white-space-collapse="false" wrap-option="no-wrap" white-space="nowrap">
<xsl:for-each select="webpage/param">    
  <tr>
    <xsl:if test="@type !='i'">  
    <td class="rowBlue">
    <xsl:if test="@indent !=''">  

        <!-- Generate the appropriate number of indentation -->
        <xsl:variable name="count" select="@indent"/>
        <xsl:for-each select="(//*)[position()&lt;=$count]">
            <xsl:text>&#xa0;</xsl:text>
        </xsl:for-each>   

    </xsl:if>           
    <xsl:choose>            
        <xsl:when test="@isBold='1'">
            <strong><span id="{position()-1}{@nameStrID}"><xsl:value-of select="@name"/></span></strong>
        </xsl:when>
        <xsl:otherwise>  
            <span id="{position()-1}{@nameStrID}"><xsl:value-of select="@name"/></span>
        </xsl:otherwise>    
    </xsl:choose>  
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>
    <xsl:text>&#xa0;</xsl:text>        
    </td>
    </xsl:if> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:09:22.627

尝试使用风格

```
<span style="white-space: nowrap;" id="{position()-1}{@nameStrID}">  
  <xsl:value-of select="@name"/></span> 
```

# wicket - 自定义 AJAX URL

> ID：13516563
> 
> 赞同：2
> 
> 时间：2012-11-22T16:13:38.200
> 
> 标签：wicket, wicket-1.5, wicket-1.6

在我们的一个页面上，我们添加了一个`AbstractAjaxTimerBehavior`（将潜在的新项目添加到一个`Repeatingview`）。执行的 AJAX 调用如下：

```
https://.../home/?0-1.IBehaviorListener.0-filteredContentHandler&random=0.38872813899070024 
```

但是，由于随机部分，此 URL 不是静态的。我也不确定是否`?0-1`总是一样。

Wicket 1.5 或 Wicket 6（我们可能会升级到）有没有办法为某个呼叫设置静态 URL？

* * *

*（此要求的原因是将此 URL 提供给 Siteminder (SSO)，以便 SSO 会话忽略这些 URL 以保持 SSO 会话活动）。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:40:13.160

回答我自己的问题：

```
public class AjaxTimerBehaviorMapper extends AbstractComponentMapper {

    private final IRequestMapper wrappedMapper;

    private final String prefix;

    /**
     * @param rootRequestMapper
     */
    public AjaxTimerBehaviorMapper(IRequestMapper wrappedMapper, String prefix) {
        this.wrappedMapper = wrappedMapper;
        this.prefix = prefix;
    }

    @Override
    public IRequestHandler mapRequest(Request request) {
        Url url = request.getUrl();
        if (url.getSegments().size() >= 1 && url.getSegments().get(0).equals(this.prefix)) {
            url.removeLeadingSegments(1);
        }
        return this.wrappedMapper.mapRequest(request.cloneWithUrl(url));
    }

    @Override
    public int getCompatibilityScore(Request request) {
        return this.wrappedMapper.getCompatibilityScore(request);
    }

    @Override
    public Url mapHandler(IRequestHandler requestHandler) {
        Url url = this.wrappedMapper.mapHandler(requestHandler);
        if (requestHandler instanceof ListenerInterfaceRequestHandler) {
            ListenerInterfaceRequestHandler listenerInterfaceRequestHandler = (ListenerInterfaceRequestHandler) requestHandler;

            RequestListenerInterface requestListenerInterface = listenerInterfaceRequestHandler.getListenerInterface();
            if (requestListenerInterface != null) {
                Class<? extends IRequestListener> listenerInterfaceClass = requestListenerInterface.getListenerInterfaceClass();
                if (IBehaviorListener.class.isAssignableFrom(listenerInterfaceClass)) {
                    IRequestableComponent requestableComponent = listenerInterfaceRequestHandler.getComponent();
                    if (requestableComponent != null) {
                        Integer behaviorIndex = listenerInterfaceRequestHandler.getBehaviorIndex();
                        Behavior behavior = requestableComponent.getBehaviorById(behaviorIndex);
                        if (behavior != null) {
                            if (AbstractAjaxTimerBehavior.class.isAssignableFrom(behavior.getClass())
                                || CustomAbstractAjaxTimerBehavior.class.isAssignableFrom(behavior.getClass())) {
                                url.prependLeadingSegments(newArrayList(this.prefix));
                            }
                        }
                    }
                }
            }
        }
        return url;
    }
} 
```

这样，wicket 将在 url 中使用给定的固定前缀。

# asp.net - 表单取消按钮问题

> ID：13516564
> 
> 赞同：0
> 
> 时间：2012-11-22T16:13:44.173
> 
> 标签：asp.net, html, forms

我有一个移动网站的工作表。我将取消按钮更改为按钮的图像样式，现在在移动浏览器中单击它时会弹出表单验证。关闭验证消息后，站点返回上一页。当用户单击取消按钮时，表单没有被验证，但是当我将类型从“按钮”切换到“图像”时，表单得到验证，我不知道为什么。

前：

```
<pre>
    input type="button" onclick="history.back();" value="Cancel"
</pre> 
```

后：

```
<pre>
    input type="image" onclick="history.back();"
    src="images/Mobile_Form_Button_01_Cancel.png"

</pre> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:27:57.310

```
<input type="image" /> 
```

实际上是一个“提交”按钮作为图像。更多信息[在这里（W3C 学校）](http://www.w3schools.com/tags/att_input_type.asp)。

要使其正常工作，请将其改回`<input type="button" />`并使用 CSS 设置样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:51:12.167

发生这种情况的原因是在`form`元素内部，[`input type=image`](http://www.w3.org/TR/html4/interact/forms.html#h-17.4.1)充当了一种特殊的提交按钮。这意味着默认情况下将进行任何脚本化或 HTML 定义的验证。简而言之，一个`input type=button`元素创建一个没有默认操作的按钮；任何动作都必须编写脚本。（这通常使它在静态 HTML 中成为一个糟糕的选择：当在浏览器中禁用脚本时，无论您单击多少按钮，该按钮都会坐在那里并且什么也不做。）

有不同的方法可以避免这种情况。一种方法是`return false`在代码末尾添加`onclick`，防止默认操作。另一种是根据您的喜好使用`input type=button`或设置样式。`button`还有一个是只有一个`img`具有属性的元素`onclick`（但最好由 JavaScript 生成）。

最好的选择是删除元素。从可用性的角度来看，您不应该重复浏览器功能——除非您正在编写 HTML5 应用程序而不是网页。

# c# - jquery $.getjSON 没有到达回调函数

> ID：13516566
> 
> 赞同：0
> 
> 时间：2012-11-22T16:13:53.283
> 
> 标签：c#, jquery, asp.net-mvc

我正在尝试处理 JSON 请求，getJSON 中使用的 url 是

```
http://localhost:52563/Documentos/Docs/CondicionesMostrar?NumIdTransaccion=16091&NumIdConcepto=421\. 
```

我的部分视图使用此返回的文本：

```
string ljListaItems = Json.Encode(loListaItems).ToString();
@ljListaItems 
```

它返回此数据

```
 [{"MedidasRelativas":false,"CssClass":"ParadigmaNTouchItem","CssClassAlterna":"ParadigmaNTouchItemAlterno","CssClassImage":"","CssClassTitle":"","CssClassFlag":"","ajaxRegion":"DetalleCondiciones","ajaxAction":"onclick=\"/Documentos/Docs/CondicionesAgregar?NumIdtransaccion=16090&IntIdCondicion=1&status=False\"","ajaxActionIzq":"","ajaxEnabled":true,"ajaxMethod":0,"ajaxMode":0,"ajaxRegionLoading":"#trabajando","ajaxData":"","image":"","editarCantidad":false,"cantidad":0,"useCssAlterno":false,"id":"I_Cond_1","title":"sin pulpo","flag":null,"width":0,"height":0,"top":0,"left":0},{"MedidasRelativas":false,"CssClass":"ParadigmaNTouchItem","CssClassAlterna":"ParadigmaNTouchItemAlterno","CssClassImage":"","CssClassTitle":"","CssClassFlag":"","ajaxRegion":"DetalleCondiciones","ajaxAction":"onclick=\"/Documentos/Docs/CondicionesAgregar?NumIdtransaccion=16090&IntIdCondicion=2&status=False\"","ajaxActionIzq":"","ajaxEnabled":true,"ajaxMethod":0,"ajaxMode":0,"ajaxRegionLoading":"#trabajando","ajaxData":"","image":"","editarCantidad":false,"cantidad":0,"useCssAlterno":false,"id":"I_Cond_2","title":"sin salami","flag":null,"width":0,"height":0,"top":0,"left":0}] 
```

这是这个类的表示：

```
public class RootObject
{
 public bool MedidasRelativas { get; set; }
 public string CssClass { get; set; }
 public string CssClassAlterna { get; set; }
 public string CssClassImage { get; set; }
 public string CssClassTitle { get; set; }
 public string CssClassFlag { get; set; }
 public string ajaxRegion { get; set; }
 public string ajaxAction { get; set; }
 public string ajaxActionIzq { get; set; }
 public bool ajaxEnabled { get; set; }
 public int ajaxMethod { get; set; }
 public int ajaxMode { get; set; }
 public string ajaxRegionLoading { get; set; }
 public string ajaxData { get; set; }
 public string image { get; set; }
 public bool editarCantidad { get; set; }
 public int cantidad { get; set; }
 public bool useCssAlterno { get; set; }
 public string id { get; set; }
 public string title { get; set; }
 public object flag { get; set; }
 public int width { get; set; }
 public int height { get; set; }
 public int top { get; set; }
 public int left { get; set; }
} 
```

注意：这个类是在[http://json2csharp.com/](http://json2csharp.com/)生成的， 我的 jquery 代码是这样的：

```
function actualizarCondiciones(tcLink) {
 $.getJSON(tcLink, function (condiciones) {
     alert(condiciones); //It never reach.
     $.each(condiciones, function (key, val) {
         alert(val);
     });
 });
} 
```

问题是回调函数永远不会到达。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:33:59.670

在聊天中，您包含以下代码：

```
public ActionResult CondicionesMostrar(decimal NumIdTransaccion , decimal NumIdConcepto) 
{ 
    // Se verifica si la session de usuario ya tiene cargada una Id de Transaccion 
    VerificarTransaccion(NumIdTransaccion); 

    //Se seleccionan el item, este ya tiene relacionado el grupo y las condiciones del mismo 
    var item = from i in db.Merlin_ConceptosFacturacion 
    where i.NumIdConcepto == NumIdConcepto 
    select i ; 

    // Se verifica si ya se han agregado algunas condiciones 
    var condiciones = from c in db.Merlin_BR_Condiciones_x_Pedido 
    where c.NumIdTransaccion == NumIdTransaccion 
    select c; 

    ViewBag.condiciones = condiciones.ToList(); 

    return View(item.First()); 
} 
```

但是您应该返回一个 json 类型，如下所示：

```
public JsonResult CondicionesMostrar(decimal NumIdTransaccion , decimal NumIdConcepto) 
{ 
    ...
    return Json(item.First()); 
} 
```

要对此进行测试，您可以编写以下代码：

```
public JsonResult CondicionesMostrar(int numIdTransaccion, int numIdConcepto) 
{ 
    return Json(new {NumIdTransaccion = numIdTransaccion, NumIdConcepto = numIdConcepto}); 
} 
```

在javascript中：

```
function actualizarCondiciones(tcLink) {
 $.getJSON(tcLink, function (condiciones) {
     console.log(condiciones); // depending on the browser you use, there might not "console.log"
     $.each(condiciones, function (key, val) {
         console.log(key, val);
     });
 }).fail(function() {
     console.log('error', arguments);
 });
} 
```

使用 GET 方法更新请求：

```
public JsonResult CondicionesMostrar(int numIdTransaccion, int numIdConcepto) 
{ 
    return Json(
          new {NumIdTransaccion = numIdTransaccion, NumIdConcepto = numIdConcepto}
          ,JsonRequestBehavior.AllowGet
    ); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:19:04.783

你打错电话`getJSON`了。第二个参数是要传递给服务器的数据。你不能忽略它。如果不需要数据，只需传递`null`或清空对象`{}`作为第二个参数：

```
$.getJSON(tcLink, null, function (condiciones) {
     alert(condiciones); //It never reach.
     $.each(condiciones, function (key, val) {
         alert(val);
     });
 }) 
```

详情见[`$.getJSON`](http://api.jquery.com/jQuery.getJSON/)_

# c# - 使用按钮编辑和删除复选框中的项目

> ID：13516571
> 
> 赞同：0
> 
> 时间：2012-11-22T16:14:16.560
> 
> 标签：c#, .net, visual-studio-2010, user-interface, checklistbox

我有一个将项目添加到复选框的按钮。

```
private void btnDelivery_Click(object sender, EventArgs e)
{
    deliveryForm.deliverytrips = new DeliveryTrips();
    deliveryForm.ShowDialog();
    if (deliveryForm.deliverytrips != null)
    {
        DeliveryTrips newApp = deliveryForm.deliverytrips;
        theDelivery.addDeliveryTrip(newApp);
    }
    updateList();
}

private void updateList()
{
    clbSummary.Items.Clear();
    List<String> listOfDelivery = theDelivery.listDeliveryTrips();
    clbSummary.Items.AddRange(listOfDelivery.ToArray());
} 
```

使用按钮我如何编辑，我添加到清单框中或从清单框中删除的内容？

刚才我有这个用于编辑项目

```
 int index = clbSummary.SelectedIndex;

        DeliveryTrips selected = theDelivery.getDeliveryTrips(index);

        deliveryForm.deliverytrips = selected;

        deliveryForm.ShowDialog();

        updateList(); 
```

但这仅在选中且未选中时编辑项目，与删除按钮相同，仅在选中且未选中时删除项目。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:50:11.093

删除是容易的部分。如果您的列表支持选定的单个项目 ( `SelectionMode` `One`)，您可以执行类似的操作

```
private void DeleteButton_Click(object sender, EventArgs 
{
    clbSummary.Items.RemoveAt(clbSummary.SelectedIndex);
} 
```

现在，如果您支持多项选择（`SelectionMode` `MultiSimple`/ `MultiExtended`- 适用于标准列表，而不是 CheckboxLists），以下代码将删除整个选择

```
private void DeleteButton_Click(object sender, EventArgs e)
{
    for(int i = clbSummary.SelectedIndices.Count - 1; i >= 0; --i)
    {
        clbSummary.Items.RemoveAt(clbSummary.SelectedIndices[i]);
    }
} 
```

在这里，颠倒顺序很重要，否则items中的删除会改变你的内容，`clbSummary`删除的item越多，偏移量就会越大。

如果你想删除 Checked 项目，它是同一件事，但你使用`CheckedIndices`

```
private void DeleteButton_Click(object sender, EventArgs e)
{
    for (int i = clbSummary.CheckedIndices.Count - 1; i >= 0; --i)
    {
        clbSummary.Items.RemoveAt(clbSummary.CheckedIndices[i]);
    }
} 
```

要进行编辑，我建议创建一个表单来编辑项目的内容，或者如果它只是一个字符串，也许一个简单的输入对话框就足够了（我真的使用引用来简化它`Microsoft.VisualBasic`）`InputBox`。通常您的项目可能对应于比字符串更复杂的对象，因此`Editor`可能需要适当的（专门用于编辑项目的表单）

```
private void EditButton_Click(object sender, EventArgs e)
{
    string content = clbSummary.SelectedItem.ToString();
    string newValue = Interaction.InputBox("Provide new value", "New Value", content, -1, -1);
    int selectedIndex = clbSummary.SelectedIndex;
    clbSummary.Items.RemoveAt(selectedIndex);
    clbSummary.Items.Insert(selectedIndex, newValue);
} 
```

# php - 为什么 dir_module 似乎没有加载，尽管它显然已加载到 httpd.conf 和 modules 文件夹中？

> ID：13516573
> 
> 赞同：1
> 
> 时间：2012-11-22T16:14:32.723
> 
> 标签：php, apache, module, dir, system-administration

我检查了 httpd.conf 文件，其中已经取消了“LoadModule dir_module modules/mod_dir.so”的注释。我还检查了 apache 模块文件夹，发现 mod_dir.so 也在那里。但是 module_dir 似乎根本没有加载。

因为当我尝试设置此虚拟文件夹时，如果我将 Alias /myblog "D:/php/try" 行放入 ifmodule 指令中，如下所示：

```
<IfModule dir_module>
    DirectoryIndex index.html index.htm index.php
    Alias /myblog "D:/php/try"
   <Directory "d:/php/try">
   Order allow,deny
   Allow from all
   </Directory> 
</IfModule> 
```

它不起作用，当通过 url /blog apache 访问时说找不到错误 404。

但是，如果我将
Alias /myblog "D:/php/try"
行放在 ifmodule 指令之外，那么该行将起作用并且 apache 可以找到该文件夹​​。所以我认为这是因为 module_dir 尚未加载。

但是我怎样才能加载它？我已经检查了上面提到的两个地方，这似乎表明它已经加载了。请帮忙。提前致谢。

ps 我的平台是windows 7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T03:09:27.157

删除`<IfModule>`标签并且只有`DirectoryIndex index.html index.cgi index.pl index.php index.xhtml`（在 httpd.conf 中）。这适用于我在 Windows 7 环境中。

# mysql - 在特定位置读取数字

> ID：13516576
> 
> 赞同：0
> 
> 时间：2012-11-22T16:14:38.837
> 
> 标签：mysql

我有一张包含电话号码字段的表格。我需要更新左起第三个数字函数中的“地区名称”字段。

```
 UPDATE mytable
 SET districtname =
 CASE
    WHEN the3rdnumberfromleft = '8' THEN 'Mycountryname'
    ELSE ''
 END 
```

如何设置条件以读取该特定位置的数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:42:04.217

您可以`LIKE`在 MySql 中使用通配符

```
UPDATE mytable 
   SET districtname = 'yourDesiredName'
WHERE telephone LIKE '__8%' 
```

**解释：**

`__8%`将匹配任何电话号码`8`在左起第三位的电话号码。

请注意，在含义之前有两个`_`（下划线）字符`8`首先匹配`two`任何字符（每个字符一个）

然后来`8`了，所以它只会匹配`8`

然后是`%`意思匹配之后的任何字符。

有关更多信息，请参阅[此链接](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:22:40.080

如果我正确阅读了您的问题，则您只想更新表中的某些行。如果这是真的，试试这个。

```
 UPDATE mytable 
    SET districtname = 'Mycountryname'
  WHERE SUBSTRING(LTRIM(telephone),3,1) = '8' 
```

这将只选择您提到的 8 行。我投入了 LTRIM 以应对您的电话号码前面可能有空格的情况。如果您确定所有电话号码都是左对齐的，则不需要它。

如果电话号码存储在整数字段中，这仍然有效，因为 MySQL 隐式转换您使用的整数，就好像它们是字符串一样。

# php - 无法运行通过composer安装的phploc

> ID：13516577
> 
> 赞同：1
> 
> 时间：2012-11-22T16:14:48.323
> 
> 标签：php, jenkins, composer-php

这是我的 composer.json 文件。它安装成功：

```
{
    "name": "lorem-ipsum",
    "description": "Lorem Ipsum",
    "minimum-stability": "dev",
    "require": {
        "php": ">=5.4",
        "zendframework/zendframework": "2.0.4",
        "doctrine/doctrine-module": "0.5.2",
        "doctrine/doctrine-orm-module": "0.5.3",
        "gedmo/doctrine-extensions": "2.3.1"
    },
    "require-dev": {
        "phpunit/phpunit": "3.7.9",
        "squizlabs/php_codesniffer": "1.4.2",
        "phpmd/phpmd": "1.4.0",
        "phploc/phploc": "1.7.4"
    }
} 
```

但是当我然后运行时：

```
./vendor/bin/phploc 
```

我得到错误：

```
PHP Fatal error:  Class 'PHPLOC_TextUI_Command' not found in /home/richard/projects/lorem-ipsum/workspace/vendor/phploc/phploc/composer/bin/phploc on line 70 
```

我认为有一些自动加载问题。如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:20:55.157

[几周前](https://github.com/sebastianbergmann/phploc/commit/a6fbaeba83a809b53b1319ce69efb4cddde7a584)发布此提交后不久，此问题已修复- 我建议您在下一个版本之前使用 dev-master 而不是 1.7.4。

# php - 合并两个数组时遇到问题

> ID：13516579
> 
> 赞同：1
> 
> 时间：2012-11-22T16:14:49.993
> 
> 标签：php, arrays

我将从数组开始，以使图片清晰。我从我的数据库中获取了两个数组。

这是数组 1 中的一条记录

```
Array ( [0] => Array ( [vraag_id] => 2 [vraag_titel] => Je bent geen randdebiel he [categorie_id] => 1 [categorie_naam] => Eierstokkanker / Ovarium [gebruiker] => Bas Koesveld [reacties] => 13 [vraag_inhoud] => Omdat ik het zeg verdomme! [vraag_datum] => 2012-11-19 00:00:00 ) ) 
```

这是来自 Array 2 的部分完整记录

```
Array ( [0] => Array ( [vraag_id] => 1 [resultaat] => 2 ) [1] => Array ( [vraag_id] => 2 [resultaat] => 1 ) [2] => Array ( [vraag_id] => 3 [resultaat] => 1 ) [3] => Array ( [vraag_id] => 4 [resultaat] => 1 ) [4] => Array ( [vraag_id] => 5 [resultaat] => 1 ) [5] => Array ( [vraag_id] => 6 [resultaat] => 1 ) [6] => Array ( [vraag_id] => 7 [resultaat] => 1 ) [7] => Array ( [vraag_id] => 8 [resultaat] => 1 ) [8] => Array ( [vraag_id] => 9 [resultaat] => 1 ) [9] => Array ( [vraag_id] => 10 [resultaat] => 1 ) [10] => Array ( [vraag_id] => 11 [resultaat] => 1 ) [11] => Array ( [vraag_id] => 12 [resultaat] => 1 ) ) 
```

我想将数组 2 中的列 resultaat 添加到 vraag_id 匹配的数组 1 的记录中。

我对 PHP 很陌生，并且尝试了很多，但没有成功。有谁能帮助我吗？

编辑：

感谢大家的评论！我想我觉得我应该让自己更清楚一点。两个内容都来自同一个表，但查询不同。查询是：

```
SELECT T.id AS vraag_id, T.titel AS vraag_titel, C.id AS categorie_id, C.naam AS categorie_naam, L.gebruikersnaam AS gebruiker, P.inhoud AS vraag_inhoud, P.datum AS vraag_datum 
FROM categorie C
JOIN topic T ON C.id = T.categorie
JOIN post P ON T.id = P.vraag
JOIN lid L ON P.lid = L.id 
WHERE P.lid = 2 
ORDER BY P.datum DESC 
```

这为我提供了数据库所需的结果。现在我想计算一个问题有多少回复，我用这个查询来做到这一点：

```
SELECT vraag AS vraag_id, COUNT( * )
FROM post
WHERE lid = 2
GROUP BY vraag_id 
```

现在我如何加入这些查询？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:36:58.733

您可以做的最好的事情是将查询中的结果加入数据库。

说，你的问题很容易解决：

```
// rework your array2:
$temp = array();
foreach ($array2 as $index) {
    $temp[$index['vraag_id']]=$index['resultaat'];
}

// then add the resultaat to the right record:

for($i=0; $i< count($array1); $i++) {
    $array1[$i]['resultaat'] = $temp[$array1[$i]['vraag_id']];
} 
```

顺便说一句，我建议另一次使用 sql join 以更有效和优雅的方式获取结果。

您是否尝试过像这样组合这两个查询？

```
SELECT T.id AS vraag_id, T.titel AS vraag_titel, C.id AS categorie_id, C.naam AS 
       categorie_naam, L.gebruikersnaam AS gebruiker, P.inhoud AS vraag_inhoud, 
       P.datum AS vraag_datum, res.resultaat 
FROM categorie C
JOIN topic T ON C.id = T.categorie
JOIN post P ON T.id = P.vraag
JOIN lid L ON P.lid = L.id 
JOIN (SELECT vraag AS vraag_id, COUNT( * ) as resultaat
    FROM post
    WHERE lid = 2
    GROUP BY vraag_id) as res ON T.id = res.id
WHERE P.lid = 2 
ORDER BY P.datum DESC 
```

我现在手头没有 mysql，也无法自己测试，但不包括拼写错误，它应该可以工作）。

诀窍是在同一个表上使用子查询并即时加入它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:27:18.740

假设第一个数组中的每个 vraag_id 在第二个数组中只有一个条目，那么大致（也是最简单的）：

```
<?php

foreach ($array2 as $a2i)
{
    foreach ($array1 as $a1i)
    {
        if ($a2i['vraag_id'] == $a1i['vraag_id'])
        {
            $a1i['result'] = $a2i['resultaat'];
        }
    }
} 
```

允许每个 vraag_id 有多个结果需要进行微不足道的更改。

或者，使用（可能）LEFT JOIN 在数据库级别执行此操作。

# p2p - 通过蜂窝 ISP 进行对等连接的 IP 欺骗

> ID：13516588
> 
> 赞同：1
> 
> 时间：2012-11-22T16:15:30.830
> 
> 标签：p2p, nat, spoofing, hole-punching

出于 Voip 的目的，我正在寻找创建点对点连接的方法。

我已经使用类似 STUN 的服务器来将 2 个对等点连接在一起。它适用于大多数 NAT，但正如预期的那样，这种技术不适用于对称 NAT 和随机端口影响。

不幸的是，大多数蜂窝网络使用对称 NAT（即使它们允许 VOIP）。

所以我想知道，如果每个客户端都向我的集合点服务器发送一个 UDP 数据包，以便相互交换每个信息（ip - 端口），它会起作用吗？然后从每个客户端执行“ip-spoofing”技术，让其他 Peer 的 NAT 认为数据来自我自己的集合服务器的 ip。（因为在每个 Nat 上打开了带有传出数据的端口）

它可以让我避免创建一个仅使用带宽将数据从一个对等点传递到另一个对等点的代理服务器。

# java - 如何使会话中的一个属性过期（Java）

> ID：13516590
> 
> 赞同：0
> 
> 时间：2012-11-22T16:15:30.377
> 
> 标签：java, spring, session

我正在寻找关于如何在 Spring 的会话中仅使一个参数过期的最佳解决方案。我有一个 3 小时后过期的会话，我需要向它添加一个参数并在 10 分钟内过期。

有什么建议么 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:22:16.260

您可以创建一个解决方案，其中对会话的所有访问都通过一个组件，该组件包装您的会话并提供您想要的到期策略。这个组件可以有一个`session`范围。

# java - Android 视图字段名称约定

> ID：13516591
> 
> 赞同：5
> 
> 时间：2012-11-22T16:15:40.460
> 
> 标签：java, android, android-layout, android-view

例如，我有 id 的视图：

```
<ImageButton
        android:id="@+id/imageButtonStart"
        android:layout_width="100dp"
        android:layout_height="100dp" /> 
```

我是否需要创建具有相同名称的私有字段，如下所示：

```
private ImageButton imageButtonStart; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:18:33.317

> 我需要一个同名的私有字段吗？

不，`android:id`布局 xml 文件中的 不要求您在代码中具有同名的变量。

但是，如果您搜索 id，则需要使用确切的名称

```
View randomName = findViewById(R.id.imageButtonStart); 
```

命名是很多个人喜好。您应该选择清楚地定义命名事物所代表的名称。你应该与你的命名方案保持一致。

该名称应该多长是有争议的，有些人会选择它`startBtn`，`imageButtonStart`因为它在您的代码中更短且不那么烦人。如果按钮是 an 的事实`ImageButton`与您的代码无关，则无需命名它`imageButton`，只需`button`使其含义清晰即可。

有些人喜欢使用具有层次结构的名称，其中最重要的区别首先出现。像 Java 和 Android 包名称`com.google.market`而不是`market.google.com`.

而不是`startButton`and `endButton`，他们选择了`buttonStart`and `buttonEnd`。这背后的原因是您可以更有效地使用自动完成。如果您不记得是否命名了结束按钮`endButton`，或者`stopButton`您需要查看整个提案列表。使用该`buttonXYZ`方案，您可以开始输入`button`，因为您知道它是一个按钮并且只会得到一些建议。

上面也是一个很好的例子，为什么你应该保持一致。如果您命名一个按钮`buttonStart`和另一个按钮，`clickablethingStop`则整个方案是无用的。不一致的命名需要更多时间来找到正确的东西，如果你选择了错误的东西，可能会导致错误。

另一件事是您用于名称的语言。如果您只是为自己或说该语言的人编写代码，那么使用您自己的语言是完全可以的。但是，一旦您想与他人分享，请继续使用英语。即使是不正确的英文命名也比您根本不懂的语言中的名称更容易阅读和理解。

还有很多其他的命名约定：[WP：命名约定](http://en.wikipedia.org/wiki/Naming_conventions_%28programming%29)

例如 Android[编码风格指南](http://source.android.com/source/code-style.html)指出：

*   非公共、非静态字段名称以 m 开头。
*   静态字段名称以 s 开头。
*   其他字段以小写字母开头。
*   公共静态最终字段（常量）是 ALL_CAPS_WITH_UNDERSCORES。

这将是`private ImageButton mButtonStart;`或`private static sSingletonThing;`

顺便说一句，只有在您想为 Android 源代码做出贡献时才需要使用该约定，您可以以任何风格编写自己的应用程序。

您真正应该遵循的唯一命名约定是通用 Java 类/方法/变量模式：（来自上面的 wikipedia 链接）

*   类名：UpperCamelCase
*   方法名称：lowerCamelCase
*   变量名：lowerCamelCase
*   常量：ALL_CAPS

如果其他人阅读您的代码并且您有小写的类名等，他们就会开始感到*非常困惑。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T16:17:52.000

尽管保持一致并为变量使用相同的名称是一种很好的做法，但您不需要将类变量与 XML 中的 id 调用相同，因为您将在代码中手动连接它们，例如：

```
ImageButton imageButtonNotStart = (ImageButton) this.findViewById(R.id.imageButtonStart); 
```

我个人偏好使用XML`componentTypeDescriptiveName`等格式`imageButtonStart`，但在代码中我更喜欢英语驱动的方法，例如`startButton`.

通常我最终得到

```
<ImageButton
        android:id="@+id/imageButtonStart"
        android:layout_width="100dp"
        android:layout_height="100dp" />

ImageButton startButton = (ImageButton) this.findViewById(R.id.imageButtonStart); 
```

# asp.net - Razor 不理解 Html.TextBoxFor 中的 ViewBag 有或没有 @ 前缀

> ID：13516597
> 
> 赞同：1
> 
> 时间：2012-11-22T16:16:03.487
> 
> 标签：asp.net, asp.net-mvc, razor, asp.net-mvc-4

发现了一个新问题，所以我要创建一个新帖子。Razor 引擎今天没有帮我完成我的工作..

使用此代码，我的屏幕上没有打印 ViewBag.user.UserName

```
<td>@Html.TextBoxFor(m => m.UserName, new { @class = "validate[required]", disabled = "disabled", value = @ViewBag.user.UserName }) @Html.ValidationMessage("usernameVal", "*")</td> 
```

现在，如果我像这样放在 TextBoxFor 之外：

```
@ViewBag.user.UserName 
```

我得到用户名。

Razor 是否应该足够聪明地检测到这样的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:46:24.340

我认为那是因为您正在尝试设置值属性，剃须刀将使用模型值进行设置。

但是，您可以在调用帮助程序之前使用代码块使用视图包中的模型值更新模型值：

```
@{
    Model.UserName = ViewBag.user.UserName;
}
<td>@Html.TextBoxFor(m => m.UserName, new { @class = "validate[required]", disabled = "disabled" }) @Html.ValidationMessage("usernameVal", "*")</td> 
```

但是你为什么要这样做，而不是在模型中已有价值呢？

# sql-server - 如果我去掉 INSERT、DELETE、DROP 等，还有人会造成损害吗？

> ID：13516603
> 
> 赞同：0
> 
> 时间：2012-11-22T16:16:22.737
> 
> 标签：sql-server, sql-injection

如果我有一个开放的表单，有人可以将任何 sql 语句输入到我的 sql server 进行内部测试，并且我在执行之前从语句中删除了以下关键字，那么有人执行突变是否仍然危险？

```
INSERT, DELETE, DROP, UPDATE, CREATE, ALTER, TRUNCATE, EXEC 
```

将运行这些操作的 sql 帐户具有读/写权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T21:57:20.503

如果攻击者仅对单个表具有只读权限，并且他们可以欺骗您的应用程序执行任意 SQL，那么他们可以通过运行笛卡尔积来实施至少一次拒绝服务攻击：

```
SELECT * 
FROM table, table, table, table, table, table, table, table, table, table
ORDER BY RAND(); 
```

如果表有 100 行，你的 sql server 可以处理排序 100 ^(10)行而不会崩溃吗？:-)

结论是限制 SQL 权限可以成为解决方案的一部分，但它不是保护自己免受攻击者的完整解决方案。你需要知道如何使用多种技术，以及如何防御性地编写代码。

我在演讲中介绍了不同的防御技术以及哪些技术在不同情况下有用： [SQL 注入神话和谬误](http://www.slideshare.net/billkarwin/sql-injection-myths-and-fallacies)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:22:01.623

是的 - 可以使用 SELECT INTO，也许还有其他。

[http://www.w3schools.com/sql/sql_select_into.asp](http://www.w3schools.com/sql/sql_select_into.asp)

最好正确使用用户帐户可用的权限。创建一个具有只读权限的帐户，所有主流服务器都会允许您这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:37:36.487

如果您无法更改权限，那么您可以将 select 语句包装到`CREATE VIEW AS`然后运行视图中吗？如果运行 select 以外的任何内容，这应该（取决于您的环境）错误。

# java - 类中的空指针异常（代码看起来不错）Java

> ID：13516607
> 
> 赞同：2
> 
> 时间：2012-11-22T16:16:48.023
> 
> 标签：java, swing, nullpointerexception

# NPE的问题根本不应该为空，请帮助

大家好，我有这段代码在表格中显示一个对象，方法 savet 将对象保存到该类中以便可以引用它，并且它可以工作（经过尝试和测试）但是当我尝试调用方法 displayTeacher 我得到一个空指针例外。这是因为它没有识别 t1，即使它明显在类中，甚至作为一个属性

```
public class Display
{
    private JTable table;
    private JFrame f;
    private int i = 0;
    public SubjectTeacher t1;

    public void savet (SubjectTeacher teachIn)
    {
        SubjectTeacher tempt = new SubjectTeacher(teachIn.getName(), teachIn.getSurname(), teachIn.getID(), teachIn.getPay(), teachIn.getSubjectID());
        t1 = tempt;
    }

    public void displayTeachers()
    {
        f = new JFrame("Teachers");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setSize(500,400);
        f.setVisible(true);

        String[] columnNames =  {"Name", "Surname", "ID", "Pay", "Subject"};
        Object[][] data = {
            {
             t1.getName(),
             t1.getSurname(),
             t1.getID(),
             t1.getPay(),
             t1.getSubjectID()
            }
          };
    JTable table = new JTable (data, columnNames);
    f.add(table);
    }
} 
```

非常感谢任何帮助，因为我必须很快完成一个学校项目，谢谢，马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:23:40.177

> 这是因为它没有识别`t1`出来，即使它显然在课堂上

它在课堂上，但它是否已*初始化*？引用类型字段的[默认值为](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)，`null`因此如果您`t1`在尝试对其调用非静态方法之前从未分配给任何内容，您将得到一个`NullPointerException`（因为`t1`会是`null`）。在您的情况下，您分配的唯一位置`t1`是在方法中，因此如果您在调用*之前*`savet`不调用此方法，则仍然是.*`displayTeachers` `t1``null`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T17:20:37.390

你说你从不同的类中调用这两种方法。你确定你在 Display 的同一个实例上调用这些方法吗？您可能只需要一个 Display 实例，因此您应该使用单例设计模式，以确保只有一个实例。

另一个观察结果是，在你的方法中：

```
 public void savet (SubjectTeacher teachIn)
            {
                SubjectTeacher tempt = new SubjectTeacher(teachIn.getName(), teachIn.getSurname(), teachIn.getID(), teachIn.getPay(), teachIn.getSubjectID());
                t1 = tempt;
            } 
```

如果你写会更容易`t1=teachIn`，并且会产生相同的效果。

编辑：您的 Display 类应如下所示：

```
 import javax.swing.JFrame;
    import javax.swing.JTable;

    public class Display {
        private static Display instance;
        private JFrame f;
        public SubjectTeacher t1;

        private Display() {
        }

        public static Display getInstance() {
            if (instance == null) {
                instance = new Display();
            }

            return instance;
        }

        public void savet(SubjectTeacher teachIn) {
            t1 = teachIn;
        }

        public void displayTeachers() {
            f = new JFrame("Teachers");
            f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            f.setSize(500, 400);
            f.setVisible(true);

            String[] columnNames = { "Name", "Surname", "ID", "Pay", "Subject" };
            Object[][] data = { { t1.getName(), t1.getSurname(), t1.getID(),
                    t1.getPay(), t1.getSubjectID() } };

            f.add(new JTable(data, columnNames));
        }
    } 
```

当您想创建一个新的 display 实例时：而不是`Display d = new Display();`键入：`Display d = Display.getInstance();` 这样，将只有一个 Display 实例，并且您将在两个类中引用相同的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:28:40.867

确保在调用**displayTeachers()**之前调用**savet(SubjectTeacher)**方法。我的猜测是您正在调用**displayTeachers()**并且尚未调用**savet(SubjectTeacher) 。**也是如此，当您尝试从.******`t1``null``NullPointerException``t1`******

 ******* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T16:24:46.837

那么是`savet`从不同的线程调用的`displayTeachers`吗？如果是这样，请尝试替换`public SubjectTeacher t1;`为`public volatile SubjectTeacher t1;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-23T08:49:59.107

您提到您`Display`在其他两个类中使用该类。

你有2个不同的实例吗？或者换句话说：你`new Display()`在两个班级都打电话吗？

如果是这样，您是否 100% 确定在**两个**类中都调用了该`savet()`方法？

您可能会调用`savet()`一个实例化和`displayTeachers()`另一个实例化。这肯定会导致您的 NPE 问题。*******

# javascript - 在 Wordpress 中包含 jquery 脚本的正确方法？

> ID：13516609
> 
> 赞同：0
> 
> 时间：2012-11-22T16:16:55.110
> 
> 标签：javascript, jquery, wordpress

我在 Wordpress 站点中使用以下 jquery 脚本。当我不排队 jQuery 时它工作正常。但是，当 jQuery 入队时，它不再运行。

任何想法我做错了什么？

```
$(function() {

    var $sidebar   = $(".side"), 
        $window    = $(window),
        offset     = $sidebar.offset(),
        topPadding = 15;

    $window.scroll(function() {
        if ($window.scrollTop() >= 240) {
            $sidebar.stop().animate({
                marginTop: $window.scrollTop() - offset.top + topPadding
            });
        } else {
            $sidebar.stop().animate({
                marginTop: 0
            });
        }
    });

}); 
```

PS。是的，我尝试将初始调用从更改为`$(function))`，`jquery(function))`但它仍然没有运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:22:48.207

您需要将`$`符号传递给函数：`jQuery(function($){ })`以便您可以在代码中使用它。否则，您需要将`$`代码中的每个替换为`jQuery`

请参阅：[jQuery.noConflict()](http://api.jquery.com/jQuery.noConflict/)

# javascript - 当另一个网页的内容发生变化时，如何使网页重新加载

> ID：13516610
> 
> 赞同：0
> 
> 时间：2012-11-22T16:16:56.167
> 
> 标签：javascript, html, forms, file-upload

我目前正在开发一个应用程序，该应用程序允许用户通过 html 表单将文件上传到服务器，然后服务器将使用几种不同的方法处理文件。我想知道是否有办法经常轮询服务器以检查文件处理的状态，以确定何时适合刷新网页。或者可能是某种带有推送界面的网页。我在想 javascript 可能适用于这种类型的事情，但我不完全确定我应该如何去做。说了这么多，我想知道是否有人可以为此提供任何建议？谢谢！（文件处理是通过 bash 以及服务器上的一些其他脚本完成的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:29:31.987

最务实的做法是使用 ajax 调用 setInterval 来检查服务器上的状态，然后在完成后 clearInterval。如果您正在运行 Node.js，则使用 Socket.io / Now.js 通过 html5 websockets 推送状态更新。这仅取决于浏览器支持要求是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:31:41.660

您需要将“X-Progress-ID”参数设置为 HTTP post 请求标头，以便您可以检查文件上传进度。您可以检查状态抛出定期 ajax 调用。不要忘记在服务器上处理此操作。另一种方法是启用推送通知 throw HTML5 websockets。然后，会有一个事件会触发一些 javascript 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T17:49:41.850

[ajaxform](http://www.malsup.com/jquery/form/#file-upload)为您解决了这个问题。它接受一个 uploadProgress 回调。它所做的只是监听[XHR 进度事件](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest#Monitoring_progress)。

# javascript - 如何阻止 Foursquare Check in Response 向用户显示？

> ID：13516612
> 
> 赞同：0
> 
> 时间：2012-11-22T16:17:02.473
> 
> 标签：javascript, html

我制作了一个简单的链接，用于检查foursquare 中的预定义地点。我正在使用foursquare api：[https](https://api.foursquare.com/v2/checkins/add) ://api.foursquare.com/v2/checkins/add 。我传递了所需的参数，但问题是签入后，将http post请求的响应显示给用户。我希望将用户重定向到 m.foursquare.com

我已经在一个移动网站上实现了它。

```
 <form id="frm1" action="https://api.foursquare.com/v2/checkins/add" method="post">
    <input type="hidden" name="venueId" value="50add32f29a67a495fca09c1"><br>
    <input type="hidden" name="shout" value="I am watching Black Cat at Chinese     Multiplex"><br>
    <input type="hidden" id="token" name="oauth_token"><br>
    <input type="hidden" name="v" value="20121122"><br> 
```

然后我将访问令牌值设置为：

```
 document.getElementById("token").value=at; 
```

然后我提交表格

```
 document.getElementById("frm1").submit(); 
```

我正在通过一些代码从 url 中提取访问令牌......它正在请求中传递，甚至签入成功但显示的响应是不需要的。因为响应看起来像一个包含 meta 等元素的 javascript 对象，通知等。所以请建议一种绕过响应并转到foursquare主页的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:23:47.613

您不能仅在 JavaScript 中执行此操作。

由于 Foursquare 期望向其 API 发出 POST 请求，因此您不能使用[JSONP](https://stackoverflow.com/questions/3839966/can-anyone-explain-what-jsonp-is-in-layman-terms)或任何其他 x-browser 技术来规避[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)。

此外，由于 Foursquare 的 API 似乎不支持任何`redirect`参数，您别无选择，只能代表您的客户端在服务器上进行 API 调用，等待响应，然后重定向它们。

# scala - 异常动态过滤器

> ID：13516613
> 
> 赞同：13
> 
> 时间：2012-11-22T16:17:08.287
> 
> 标签：scala, playframework, playframework-2.0, anorm

我正在研究一点 anorm 文档（来自 play framework），不清楚它是否支持常见的查询用例：动态过滤器，即用户在 10 个字段的搜索表单上填写 2 或 3 个搜索条件。

在这种情况下，如何在没有经典字符串操作的情况下动态构造查询？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-08-19T06:56:51.937

是的，我认为 Robin Green 提到的问题包含了答案。只需使用占位符（例如 ）使用所有可能的条件定义您的查询，然后在查询上`{criterion1}`调用该方法，并按照接受的答案中的描述`on()`传递参数的实际`Seq`值。`Option`

* * *

来自 Anorm 文档的修改示例，假设您有两个条件，但只希望您的查询过滤国家代码而不是首都：

```
SQL(
"""
select * from Country c 
join CountryLanguage l on l.CountryCode = c.Code 
where ({countryCode} is null or c.code = {countryCode})
  and ({capital} is null or c.capital = {capital});
"""
).on("countryCode" -> Some("FRA"), "capital" -> None) 
```

这应该够了吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-19T07:24:30.750

先简答。假设您在数据库中有一个包含 3 列的表：`name`、`email`、`pass`。但是从用户那里，你只得到了`name`and`password`而不是`email`. 所以选择所有 3

```
val name:Option[String] = Some("alice")
val email:Option[String] = None
val pass:Option[String] = Some("password")

//For db insertion have this:

  DB.withConnection { implicit conn =>
  SQL("INSERT INTO USERS (name,email,pass) VALUES ({n},{e},{p})").on(
 'n -> name, 'e -> email,'p -> pass).executeInsert()
 } 
```

`email`按原样执行上述操作`None`，它将插入`null`到您的数据库中。因此，在您的情况下，对于所有 10 列，您可以在`SQL`上面的语句中定义它们并传入`Option`. `on()`如果其中任何一个是`None`，那么它将把它作为`null`在数据库中。

尽管如果架构中的列存在约束，则可能会出现问题`NOT NULL`。在这种情况下，您可以使用`getOrElse`以下列：

```
DB.withConnection { implicit conn =>
  SQL("INSERT INTO USERS (name,email,pass) VALUES ({n},{e},{p})").on(
 'n -> name, 'e -> email.getOrElse("Default Email"),'p -> pass).executeInsert() 
```

下面是一个关于 play 如何将类型转换为数据库类型的理解列表。它可以在对象中找到`anorm.ToStatement`：

```
 case Some(bd: java.math.BigDecimal) => stmt.setBigDecimal(index, bd)
        case Some(o) => stmt.setObject(index, o)
        case None => stmt.setObject(index, null)
        case bd: java.math.BigDecimal => stmt.setBigDecimal(index, bd)
        case date: java.util.Date => stmt.setTimestamp(index, new java.sql.Timestamp(date.getTime()))
        case o => stmt.setObject(index, o) 
```

上面你看到了，因为`None`它把它当作空值。

* * *

在这种情况下`SELECT`，我不知道有任何异常功能在这里有帮助，但我想简单的字符串操作可能就足够了：

```
def getColumns(xs:List[Option[_]]):String = {
    val notNone = xs.collect{
       case Some(x) => x.toString
    }
    notNone.mkString(",")
} 
```

然后`SQL("SELECT %s from table".format(getColumns(List(nameColumn,emailColumn,passColumn)))`。

虽然这不是你想要的。Anorm 只是一个 sql 构建库。为了做你想做的事，它还必须记住你的表模式（即至少列名..）。我不认为 anorm 是为了做这一切

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-19T09:35:30.750

Anorm 似乎在您插入普通旧 SQL 的前提下运行，没有任何功能，例如类型安全或查询构建。它可能不是动态查询的正确工具。构建查询最终必须是字符串操作，因此我建议使用为您执行此操作的库。将任何用于生成 SQL 语句的库与 Anorm 集成应该很容易。

您可以使用 jOOQ 之类的库动态构建查询并将该查询字符串传递给[Anorm](http://www.jooq.org/)。作为奖励，您将获得对许多数据库的支持。jOOQ 似乎很受欢迎，但您可能可以使用许多其他库来代替。或者如果 Anorm 不适合您的项目，则完全替换它。

# java - 使用 MVEL 有什么好处？

> ID：13516616
> 
> 赞同：2
> 
> 时间：2012-11-22T16:17:42.050
> 
> 标签：java, jbpm, business-process, mvel

我正在学习jBPM引擎，我注意到它在流程设计中默认使用MVEL方言。那么问题来了：使用 MVEL 而不是纯 Java 有什么优势呢？如果我开始用 Java 编写更复杂的流程，我会遇到麻烦吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-12-08T16:13:20.190

jBPM 文档写道：

> « 请注意，MVEL 接受任何有效的 Java 代码，并另外提供对参数嵌套访问的支持。例如，Java 调用 person.getName() 的 MVEL 等效项是 person.name。MVEL 还提供了对 Java 的其他改进，并且 MVEL 表达式通常对业务用户更方便。»
> -- jBPM 文档
> -- [https://docs.jbpm.org/7.54.0.Final/jbpm-docs/html_single/#:~:text=Note%20that%20MVEL,for%20business%20users](https://docs.jbpm.org/7.54.0.Final/jbpm-docs/html_single/#:%7E:text=Note%20that%20MVEL,for%20business%20users)。
> -- 2021 年 12 月 8 日，星期三

所以 MVEL 符号是：

*   短的;
*   简单的;
*   （非技术）用户友好。

在某些情况下，MVEL 中的解决方案直观简单，但在 Java 风格中则复杂或未知。参见，例如：

[如何在 jbpm 任务的数据分配 I/O 中调用 setter 方法？](https://stackoverflow.com/questions/70269532/how-to-call-a-setter-method-in-the-data-assignments-i-o-in-a-jbpm-task)

# wcf-data-services - WCF DataService 不支持预检选项请求？

> ID：13516617
> 
> 赞同：6
> 
> 时间：2012-11-22T16:17:50.443
> 
> 标签：wcf-data-services, odata, cors, preflight

我想使用基于 ajax 的组件 (KendoUI) 来读取/修改由 WCF DataServices 实现的 OData 端点上的实体。

首先，服务实现相当简单：

```
public class MyFooService : DataService<FooContext>
{
    public static void SetEntitySetAccessRules(IDataServiceConfiguration config)
    {
        config.SetEntitySetAccessRule("Foos", EntitySetRights.AllWrite);
    }
} 
```

现在我期待能够使用 PUT 修改实体。KendoUI 提供了一个漂亮且简单的配置界面，并且在生成 PUT 请求方面做得很好。

我们正在发出跨域请求并使用 CORS。因此，例如，Firefox 在发送 PUT 之前向 OData 服务发送预检 OPTIONS 请求。

不幸的是，服务端点似乎不支持开箱即用的 OPTIONS：对 OPTIONS 请求的响应是“501 Not Implemented”，内容为空。至少我们设法使响应具有如下 CORS 标头：

```
<system.webServer>
  <modules runAllManagedModulesForAllRequests="true" />
  <!-- Enable cross-origin resource sharing -->
  <!-- http://enable-cors.org/#how-asp.net -->
  <httpProtocol>
    <customHeaders>
      <add name="Access-Control-Allow-Origin" value="*" />
      <add name="Access-Control-Allow-Methods" value="POST, PUT, DELETE, GET, OPTIONS" />
      <add name="Access-Control-Allow-Headers" value="content-Type, accept, origin, X-Requested-With" />
      <add name="Access-Control-Allow-Credentials" value="true" />
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

对此进行谷歌搜索有点挑战性，因为“选项”是一个非常流行的术语......

我找到[了这篇文章](http://blogs.msdn.com/b/carlosfigueira/archive/2012/05/15/implementing-cors-support-in-wcf.aspx)，但它看起来非常***非常***复杂。我的意思是，OData 都是关于 REST 的，我无法想象 WCF 数据服务不提供一种简单的方法来允许预检请求，或者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-02T14:46:49.610

目前 WCF DataServices 不支持 CORS，而且我看到的每一个解决方案都是一个 hack，充其量只能工作。

我遇到了同样的问题，我只是将我的代码从 WCF 移植到 Web API 2 OData 解决方案。Web API 2 支持 CORS，而且非常容易设置。

如果您熟悉 Web API，请查看此链接：http: [//msdn.microsoft.com/en-us/magazine/dn532203.aspx](http://msdn.microsoft.com/en-us/magazine/dn532203.aspx)

这里是关于如何使用 Web API 创建 OData 端点的教程： [http ://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/odata-v3/creating- an-odata-端点](http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/odata-v3/creating-an-odata-endpoint)

# php - 客户端应用程序的 PHP REST API 授权

> ID：13516622
> 
> 赞同：0
> 
> 时间：2012-11-22T16:18:19.307
> 
> 标签：php, api, rest, authorization

> **可能重复：**
> [Restful API 身份验证建议？](https://stackoverflow.com/questions/3531524/restful-api-authentication-recommendation)

我正在用 PHP 编写一个 API，它选择使用 Respect/REST。

这不是一个公共 API，即只有授权的客户端应用程序可以在那里消费。这就是我想知道如何保证 API 处理的信息的安全性的地方。客户端应用程序可以用任何语言编写，但正如我所说，它们应该被允许使用 API。

目前我正在使用 jQuery.rest 为这个 API 编写一个测试客户端。

我的疑问是：

1）如何保证只有授权的客户端才能访问API？

2）如何保证对API的每一个请求都经过了客户端的授权？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T19:23:49.647

最常见的方法之一是使用[oauth](http://en.wikipedia.org/wiki/OAuth)，但它不是唯一的方法。

尝试在[apigee](http://apigee.com)上查看资源，他们有关于 api 服务器和身份验证的有用的免费电子书和网络广播。

*   [OAuth：大局](http://apigee.com/about/api-best-practices/oauth-big-picture)
*   [网页api设计](http://apigee.com/about/content/web-api-design)
*   [你的api是裸的吗？](http://apigee.com/about/content/your-api-naked)
*   [API 外观模式](http://apigee.com/about/content/api-fa%C3%A7ade-pattern)

第一个可能会解决您的疑问，另一个只是为了了解更多关于服务器 API 的信息

也看看他们的[视频](http://apigee.com/about/api-best-practices/all/video)和[网络广播](http://apigee.com/about/api-best-practices/all/webcast)

# vba - 将交换电子邮件转换为 smtp 电子邮件

> ID：13516624
> 
> 赞同：0
> 
> 时间：2012-11-22T16:18:24.927
> 
> 标签：vba, outlook-2003

是否可以将交换电子邮件转换为 smtp 电子邮件。我可以在谷歌搜索时找到一些帮助，但解决方案不可行，因为我使用的是旧版本（outlook 2003）。

当我检查 MailItem.SenderEmailAddress 属性时，该属性中的值看起来像这种格式

```
/O=MYCOMPANY/OU=COUNTRY/CN=RECIPIENTS/CN=joseph 
```

我想将其转换为 smtp 电子邮件，它应该是

```
joseph@mail.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-26T18:30:35.973

我正在为我的.Net使用这种方式：

```
service.ResolveName(emailAddress.Address).First().Mailbox.Address
// emailAddress.Address = "/o=ExchangeLabs/ou=Exchange(abc)/cn=Recipients/cn=xyz"
// => abc@xyz.com 
```

ResolveName 方法参考：[https ://msdn.microsoft.com/en-us/library/dd635548(v=exchg.80).aspx](https://msdn.microsoft.com/en-us/library/dd635548(v=exchg.80).aspx)

我正在使用 .Net 而不是 VBA。但是希望会激发您的 VBA 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T21:19:06.103

```
MailItem.Sender.GetExchangeUser().PrimarySmtpAddress 
```

我知道这适用于 Outlook 2010，但您的里程可能会随 2003 年而有所不同。

# mime-types - Dropbox 上的 Javascript 和 CSS 问题（mime 类型）

> ID：13516632
> 
> 赞同：3
> 
> 时间：2012-11-22T16:18:47.357
> 
> 标签：mime-types, dropbox, jsfiddle, jsbin

我想我会为其他人分享这个答案，因为我花了一些时间才弄清楚：

我正在使用 jsbin 和 jsfiddle 来测试网页。我有许多 javascript 和 CSS 文件（以及从 CSS 文件引用的图像）。我正在使用 DropBox 来存储带有 Javascript 和 CSS 的文件夹和文件。问题是 Dropbox 最近更改了公共文件夹的政策。如果您从非公共文件夹共享指向 CSS 文件的链接，您将不会获得 CSS (text/css) mime 类型，而是格式良好的 text/html。在 JSBIn (firebug) 中，您将看到如下错误：

```
The stylesheet https://www.dropbox.com/s/y9ms5jr6zqdans2/leaflet.css was not loaded because its MIME type, "text/html", is not "text/css". 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T16:18:47.357

如果您将 url 更改为[https://dl.dropbox.com/](https://dl.dropbox.com/) ... 那么您将获得一个直接链接并获得 CSS 类型。

但是我的 CSS 文件引用了如下图像文件：

```
.leaflet-control-layers a {
background-image: url(images/layers.png);
width: 36px;
height: 36px;
} 
```

所以就我而言，我必须使用 DropBox PUBLIC 文件夹。新帐户没有这个选项（他们没有一个名为 PUBLIC 的文件夹），所以我想如果你有一个新的 DropBox 帐户，你将不得不使用 GITHub 或类似的东西

可以在以下位置查看如何执行此操作的示例：http: [//jsbin.com/idovub/5/edit](http://jsbin.com/idovub/5/edit)

# python - 如何标记在 python（和 selenium）中没有可识别差异的对象？

> ID：13516635
> 
> 赞同：0
> 
> 时间：2012-11-22T16:18:52.460
> 
> 标签：python, selenium

我正在使用 selenium webdriver 在 python 中编写一个程序，它可以自动化 firefox 浏览器。我去的一个网站有几个对象，它们有一个倒计时直到它们消失的计时器。其中一些对象是相同的。我希望能够单独与它们交互，但是当它们消失时，我希望我的程序“忘记”它们，只担心当前的。

见图片：

[http://img16.imageshack.us/img16/5349/bidsl.png](http://img16.imageshack.us/img16/5349/bidsl.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:49:18.550

您可以在对其执行任何操作之前检查元素的存在。如果元素存在，则只对它做一些事情，否则忘记它。

# ruby-on-rails - Rails g bootstrap：安装不起作用

> ID：13516638
> 
> 赞同：0
> 
> 时间：2012-11-22T16:19:11.513
> 
> 标签：ruby-on-rails, twitter-bootstrap-rails

我在运行命令时遇到问题

`rails g bootstrap:install`作为`twitter-bootstrap-rails`宝石的一部分。

我收到以下错误：

```
/Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-0.8.2/lib/v8/context.rb:74:in `IsEntered': HandleScope::HandleScope: Entering the V8 API without proper locking in place (fatal)
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-    0.8.2/lib/v8/context.rb:74:in `enter'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-0.8.2/lib/v8/portal.rb:74:in `open'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-0.8.2/lib/v8/object.rb:18:in `block in []='
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-0.8.2/lib/v8/object.rb:17:in `tap'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-0.8.2/lib/v8/object.rb:17:in `[]='
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/therubyracer-0.8.2/lib/v8/context.rb:56:in `[]='
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/less-2.2.2/lib/less/loader.rb:12:in `initialize'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/less-2.2.2/lib/less.rb:14:in `new'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/less-2.2.2/lib/less.rb:14:in `<module:Less>'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/less-2.2.2/lib/less.rb:9:in `<top (required)>'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler/runtime.rb:68:in `require'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler/runtime.rb:66:in `each'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler/runtime.rb:66:in `block in require'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler/runtime.rb:55:in `each'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler/runtime.rb:55:in `require'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327@global/gems/bundler-1.2.2/lib/bundler.rb:128:in `require'
 from /Users/matty/Documents/rubyboot/boots/store/config/application.rb:7:in `<top (required)>'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.8/lib/rails/commands.rb:24:in `require'
 from /Users/matty/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.8/lib/rails/commands.rb:24:in `<top (required)>'
 from script/rails:6:in `require'
 from script/rails:6:in `<main>' 
```

有人可以帮我诊断吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T15:43:21.920

尝试更新 ruby​​racer 的版本，这也应该从依赖关系的角度更新 libv8：

```
bundle update therubyracer 
```

# php - PHP 阻止用户从多个浏览器/PC 登录

> ID：13516639
> 
> 赞同：0
> 
> 时间：2012-11-22T16:19:11.487
> 
> 标签：php, mysql, session

我的用户表中有一个“在线”列，它每 90 分钟更新一次，显示他们上次在线的时间，它显示如下：

2012-11-22 19:15:18

如果该用户在过去 90 分钟内一直在线，我将如何阻止人们登录？

人们目前通过获得 x10 合法数量的网站货币来滥用我的系统。

编辑：

HTML登录表单：

```
<form method="post" action="">
            <input class="l_form" onfocus="if(this.value == '<?=$lang['b_14']?>') { this.value = ''; }" onblur="if(this.value=='') { this.value = this.defaultValue }" value="<?=$lang['b_14']?>" name="login" type="text">
            <input class="l_form" onfocus="if(this.value == '<?=$lang['b_15']?>') { this.value = ''; }" onblur="if(this.value=='') { this.value = this.defaultValue }" value="<?=$lang['b_15']?>" name="pass" type="password">                                  
            <?=$errMsg?>
            <div class="buttons">
                <input class="gbut" name="connect" value="<?=$lang['b_13']?>" type="submit"><br /><br />
                <span style="float:right;display:inline"><a href="recover.php" style="font-size:12px"><?=$lang['b_16']?></a></span>
            </div>                                        
        </form> 
```

Is online 有一个功能：

```
/* User Session */
$is_online = (isset($_SESSION['EX_login']) ? true : false);
if(isset($_SESSION['EX_login'])){
$sql                = $db->Query("SELECT *,UNIX_TIMESTAMP(`online`) AS `online` FROM `users`     WHERE (`login`='".$_SESSION['EX_login']."' OR `email`='".$_SESSION['EX_login']."')");
$data               = $db->FetchArray($sql);
if($data['id'] == ''){
    session_destroy();
}elseif($data['online']+90 < time()){
    $db->Query("UPDATE `users` SET `online`=NOW() WHERE `id`='".$data['id']."'");
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:32:16.250

您可以尝试以下方法：

```
$currentTime = time();
$limit = $currentTime - 60 * 90;
if ($data['online'] < $limit) {
    echo "You have to wait..";
  exit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:33:58.273

当用户尝试登录类似的东西时，这不能用 MYSQL 完成吗

```
SELECT * FROM users WHERE online <= NOW() - INTERVAL 90 MINUTE; 
```

# c# - 我的“while”语句有什么问题

> ID：13516641
> 
> 赞同：0
> 
> 时间：2012-11-22T16:19:18.197
> 
> 标签：c#, validation, date

```
int monthentered = 0;
int dayentered = 0;
int year = 0000;
int [] month = new int [12];
int [] day = new int [31];
bool leap = false;

for (int x = 0; x <= 11; x++)
{
    month[x] = x+1;
}

for (int x = 0; x <= 30; x++)
{
    day[x] = x+1;
}
Console.WriteLine("Please enter a year...");
year = (Convert.ToInt16(Console.ReadLine()));
Console.WriteLine("{0}", year);

Console.WriteLine("Please enter a month...");
monthentered = (Convert.ToInt16(Console.ReadLine()));

Console.WriteLine("Please enter a day...");
dayentered = (Convert.ToInt16(Console.ReadLine()));

while (monthentered == 01 || 03 || 05 || 07 || 08 || 10 || 12)
{
    while (dayentered == 31)
    {
        Console.WriteLine("There are only 30 days in this month please re-enter your day...");
        dayentered = (Convert.ToInt16(Console.ReadLine()));
    }
}

while (monthentered == 02)
{
    while (dayentered > 28)
    {
        Console.WriteLine("There are only 28 days in this month please re-enter your day...");
        dayentered = (Convert.ToInt16(Console.ReadLine()));
    }
}

Console.WriteLine("{0}/{1}/{2}", dayentered, monthentered, year);
Console.ReadKey(); 
```

线路有什么问题`while (monthentered == 01 || 03 || 05 || 07 || 08 || 10 || 12)`吗？我收到一个我不明白的错误。`"Operator '||' cannot be applied to operands of type 'bool' and 'int'"`

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:20:57.347

```
while(monthentered == 01 || monthentered == 03 || monthentered == 05 || monthentered == 07 || monthentered == 08 || monthentered == 10 || monthentered == 12) 
```

|| 之间的每一个操作 并且 && 必须呈现为布尔值（即完整的测试），因为每个操作都是独立计算的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:21:29.443

现在它是这样的`while(bool || int || int)`，我猜你想要这样的东西：

```
while (monthentered == 1 || monthentered == 3 || monthentered == 5 /*|| ...*/) 
```

你需要每次检查变量的值，所以它会是`while(bool || bool || bool)`等

您还可以创建有效月份的集合并检查输入的数字是否在其中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T16:21:46.067

> 运算符“||” 不能应用于“bool”和“int”类型的操作数

您不能`||`在数字上使用 - 您使用的每个部分都`||`应该评估为`bool`.

条件应如下所示：

```
while (monthentered == 01 || 
       monthentered == 03 || 
       monthentered == 05 || 
       monthentered == 07 || 
       monthentered == 08 || 
       monthentered == 10 || 
       monthentered == 12) 
```

尽管更具可读性的选项是：

```
var validMonths = new int[] { 1, 3, 5, 7, 8, 10, 12 };

while(validMonths.Contains(monthentered)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T16:22:39.847

您不能将 an`int`与`bool`with[`||`运算符](http://msdn.microsoft.com/de-de/library/6373h346%28v=vs.80%29.aspx)进行比较。`monthentered == 01`是`bool`（真/假），其余的是`ints`。

因此，将 while 更改为：

```
int[] allAllowedMonths = new[]{ 1, 3, 5, 7, 8, 10, 12 };
while (allAllowedMonths.Contains( monthentered ))
{
    // ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-22T16:20:49.800

它应该是

```
while (monthentered  == 01 ||monthentered  == 03 || monthentered  ==05 || monthentered  ==07 || monthentered  ==08 || monthentered  ==10 || monthentered  ==12) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-22T16:22:36.990

它应该是

```
while (monthentered == 01 || 
       monthentered == 03 || 
       monthentered == 05 || 
       monthentered == 07 || 
       monthentered == 08 || 
       monthentered == 10 || 
       monthentered == 12)

 {  
   //code here
 } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-22T16:22:39.877

导致代码*编译*但*不起作用*的直接答案：您需要使用

```
(monthentered == 01 || monthentered == 03 || monthentered == 05 ||
 monthentered == 07 || monthentered == 08 || monthentered == 10 ||
 monthentered == 12) 
```

进一步的问题：

*   您的代码在大多数月份允许 32 天以上。
*   您`while`的月份循环将永远不会终止，因为您永远不会更改月份的值。改为使用`if`语句。

额外提示：您可以使用[`DateTime.DaysInMonth`](http://msdn.microsoft.com/en-us/library/system.datetime.daysinmonth.aspx)获取每个月和年允许的最大数字，而不是手动检查月数。这也将适应闰年。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-22T16:25:11.267

这是繁琐的语法，但您需要将 while 语句编写为：

`while (monthentered == 01 || monthentered == 02 || monthentered == 3`...ETC

您的语句将首先评估布尔条件`monthentered == 01`，然后尝试在逻辑上或结果与其他整数，因此错误。

但是，我会看看你想要做什么，看看 while 循环是否真的是你想要的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-22T16:22:13.090

C# while 只接受真/假表达式！

```
while (monthentered == 01 || monthentered ==03 || monthentered ==05 || monthentered ==07 || monthentered ==08 || monthentered ==10 || monthentered ==12) 
```

# css - 如何在数据表中制作水平滚动单元格

> ID：13516642
> 
> 赞同：6
> 
> 时间：2012-11-22T16:19:21.663
> 
> 标签：css, jsf-2, primefaces

这是 PrimeFaces，但我认为这个问题同样适用于标准的 JSF 数据表。

我有一个数据表列，其中条目被自动换行，因为内容可能很长。为了使显示更具可读性，我希望内容不被包装，而是提供水平滚动来查看默认情况下不显示的任何内容。

我确信这是一个简单的 CSS 修改，但我的熟练度非常低。

```
<p:dataTable ... >

    <p:column headerText="Book Title">
         <h:outputText value="#{book.title}" style="???" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T16:45:28.533

仅当文本包含在具有定义宽度和禁用文本换行的[块级 HTML 元素](http://www.htmlhelp.com/reference/html40/block.html)中并且相关元素具有 CSS 属性`overflow:scroll`或至少已定义时，`overflow-x:scroll`这才有可能。

因此，用纯 HTML 术语来说，这基本上是以下方法：

```
<div style="width: 200px; white-space: nowrap; overflow-x: scroll;">
    Some really really lengthy book title about a really really lengthy book.
</div> 
```

在 PrimeFaces`<p:column>`术语中，这将是：

```
<p:column styleClass="scrollableCell">
    #{book.title}
</p:column> 
```

和

```
.ui-datatable td.scrollableCell div.ui-dt-c {
    width: 200px;
    white-space: nowrap;
    overflow-x: scroll;
} 
```

请注意，您不需要引入任何 div，`<p:column>`已经这样做了。

### 也可以看看：

*   [如何使用自定义样式覆盖默认的 PrimeFaces CSS？](https://stackoverflow.com/questions/8768317/how-do-i-override-those-classes-defined-in-primefaces-css/8774997#8774997)

# c++ - 朋友类中没有返回语句

> ID：13516644
> 
> 赞同：1
> 
> 时间：2012-11-22T16:19:37.677
> 
> 标签：c++

该`ostream & operator<<(ostream &os, A &A0)`函数正在生成警告。

# 这是该类的定义方式：

```
class A
{
    public:
        friend ostream & operator<<(ostream &os, A &A0);
        A& operator=(string strSlot_);
        A& operator+(string strSlot_);
        A& operator+(const A &B);
        A& operator=(const A &B);
        string slotReturn();
        A(string strSlot_);
        A(const A &object);
        void slotChange();
        void sCout();
        ~A();
        A();
    private:
        string strSlot;
        int n;
};

ostream & operator<<(ostream &os, A &A0)
{
    os << "strSlot = \"" << A0.slotReturn() << "\"" << endl;
}

string A::slotReturn()
{
    return strSlot;
} 
```

* * *

问题是，它应该返回什么？`*this`似乎不起作用（因为它是一个`friend`？）。（这只是一个警告，但我还是想知道。）

另外，为什么我不能`A &A0`作为 const 传递（在这种情况下，错误是：“将 'const A' 作为 'std::string A::slotReturn()' 的 'this' 参数传递会丢弃限定符”）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:20:59.187

您需要返回`std::ostream&`自身：

```
ostream & operator<<(ostream &os, A &A0)
{
   return  os << "strSlot = \"" << A0.slotReturn() << "\"" << endl;
} 
```

顺便说一句，术语略有偏差。没有“朋友班”。是这里`std::ostream& operator<<`的朋友。但它甚至不需要成为朋友，因为它只是调用`A`. 所以你可以删除朋友声明。

您可能还应该制作`slotReturn()`一个`const`方法：

```
string slotReturn() const;
        //            ^ const method 
```

并修改`ostream& operator<<`以获取 const 引用：

```
ostream & operator<<(ostream& os, const A& A0) { .... } 
```

这将允许您打印出临时文件：

```
std::cout << A("I am a temporary!") << "\n"; 
```

# android - 糖豆家酒吧淡出

> ID：13516645
> 
> 赞同：0
> 
> 时间：2012-11-22T16:19:40.437
> 
> 标签：android, android-4.2-jelly-bean, home-button

由于似乎我们不能再在 Jellybean 中隐藏带有 home 和 back 按钮的栏，我至少想像在 Kindle 应用程序中那样淡出它（按钮只是小的离散点）。我一直在寻找这个地方，但我似乎找不到它！

干杯/M

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:42:10.573

您可以使用：

```
View rootView = getWindow().getDecorView();
rootView.setSystemUiVisibility(View.STATUS_BAR_HIDDEN); 
```

[View.SYSTEM_UI_FLAG_LOW_PROFILE](http://developer.android.com/reference/android/view/View.html#SYSTEM_UI_FLAG_LOW_PROFILE)在 Android 4.0 及更高版本上替换[View.STATUS_BAR_HIDDEN 。](http://developer.android.com/reference/android/view/View.html#STATUS_BAR_HIDDEN)

您还可以使用[View.SYSTEM_UI_FLAG_HIDE_NAVIGATION](http://developer.android.com/reference/android/view/View.html#SYSTEM_UI_FLAG_HIDE_NAVIGATION)尝试完全隐藏栏。请注意，这主要只适用于手机而不是平板电脑，并且一些三星 TouchWiz 设备无法正确解释这一点。当您的应用程序运行时，该栏还将消耗与屏幕的第一次用户交互以再次显示自己。

```
getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_HIDE_NAVIGATION); 
```

# string - 扫描文本并检查它是否包含指定列表中的单词

> ID：13516646
> 
> 赞同：2
> 
> 时间：2012-11-22T16:19:51.343
> 
> 标签：string, algorithm

要求

1.  目前我们有一个包含上万个关键词或句子的列表（数量为N）
2.  输入一个长字符串，长度为L

问题：检查字符串是否包含给定列表中的关键字或句子

该问题可以描述为[wikipedia](http://en.wikipedia.org/wiki/Wordfilter)上的单词过滤器，但我在该页面上没有找到任何算法。解决此问题的最简单方法是迭代所有关键字或句子，并且每次检查长文本是否包含此类子字符串。由于我们有多个关键字，同时考虑到长文本，性能很差。它使用 O(NL) 时间

似乎更好的解决方案应该在 O(L) 中完成。有人可以对此提出一些建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:37:51.027

有几种方法可以解决这个问题，时间复杂度为 O(M + L)，其中 L 是字符串的长度，M 是所有模式的组合长度：

1.  [Aho–Corasick 字符串匹配算法](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)。
2.  [使用Ukkonen 算法](http://en.wikipedia.org/wiki/Ukkonen%27s_algorithm)为字符串构造一个[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)，然后找到每个模式与该后缀树的匹配项。
3.  为一组模式构造一个[通用的后缀树](http://en.wikipedia.org/wiki/Generalized_suffix_tree)，然后找到输入字符串和这个后缀树之间的匹配。
4.  为字符串构造一个[Suffix 数组](http://en.wikipedia.org/wiki/Suffix_array)，并使用它来搜索每个模式。这种方法的时间复杂度为 O(M + L + N log L)，其中 N 是模式的数量。
5.  [Commentz-Walter 算法](http://en.wikipedia.org/wiki/Commentz-Walter_algorithm)。

您可以在这本书中找到所有这些算法（除了 Commentz-Walter 算法）的详细信息：[Dan Gusfield 的字符串、树和序列算法](https://rads.stackoverflow.com/amzn/click/com/0521585198)。

* * *

如果您可以明确地从输入字符串中提取单独的单词/句子，则可以使用几种不同（更简单）的方法。

1.  准备一个大小足够大的[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)，以保证 N 个模式的误报概率低。添加到布隆过滤器位，由关键字/句子的哈希函数确定。然后扫描字符串，提取连续的单词/句子，并检查这些单词/句子是否可以在布隆过滤器中找到。仅当 Bloom 过滤器中存在单词/句子时，才在模式列表中搜索它。该算法具有预期的时间复杂度 O(M + L) 并且是节省空间的。
2.  将所有模式插入哈希集中。然后扫描字符串，提取连续的单词/句子，并检查它们是否在哈希集中。这具有相同的预期时间复杂度 O(M + L)，比布隆过滤器方法更简单，但不节省空间。
3.  将所有模式插入基数树（trie）。然后用它从字符串中搜索单词/句子。这与广义后缀树方法没有太大区别，但更简单，性能更好。它具有最坏情况下的时间复杂度 O(M + L)，可能比 Bloom 过滤器或哈希集方法要慢一些，并且在必要时可以非常节省空间。

# php - 删除标签内 XML 中的减号

> ID：13516647
> 
> 赞同：1
> 
> 时间：2012-11-22T16:19:55.007
> 
> 标签：php

我正在尝试使用 preg_replace 仅在标签之间替换 - 到 _

测试字符串通常在 POST 请求的标头响应中收到

```
 $response['body'] = <<<STR
    <?xml version="1.0"?>
        <tracking-events>
        <tracking-event>
        <type>DELIVERED</type>
        <time>2012-12-04T11:45:08.554+0200</time>
        <tracking-id>AB10000</tracking-id>
        </tracking-event>
        </tracking-events>
    STR; 
```

你能帮我把 - 改成 _ 并保持日期格式不变吗

```
$response['body'] = <<<STR
<?xml version="1.0"?>
    <tracking_events>
    <tracking_event>
    <type>DELIVERED</type>
    <time>2012-12-04T11:45:08.554+0200</time>
    <tracking_id>AB10000</tracking_id>
    </tracking_event>
    </tracking_events>
STR; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:05:46.553

我建议使用 XSL 样式表来转换文档：

```
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >

<xsl:template match="*"> 
  <xsl:choose>
    <xsl:when test="contains(name(), '-')">
      <xsl:element name="{translate(name(),'-','_')}">
      <xsl:copy-of select="@*"/>
          <xsl:apply-templates/>
      </xsl:element>
    </xsl:when>
    <xsl:otherwise>
      <xsl:copy>
          <xsl:copy-of select="@*"/>
          <xsl:apply-templates/>
      </xsl:copy>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template>

</xsl:stylesheet> 
```

样式表将创建一个具有固定 nodeName 的新元素，并将属性和 childNodes 复制到该节点上，仅此而已。

演示：[**http ://www.xsltcake.com/slices/5Wuq6P**](http://www.xsltcake.com/slices/5Wuq6P)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:34:32.440

您是否尝试过使用正则表达式？就像是

```
$response['body'] = preg_replace('(<[^>]*)[a-zA-Z]\-[a-zA-Z]([^>]*)', '$1_$2', $response['body']); 
```

没有测试以上，但我认为它应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T20:16:44.410

这循环通过 XML 表示。恐怕任何属性都会丢失（如果需要，应该很容易调整函数以保留它们）。这是一个通用功能，不会被文本内容绊倒。

```
<?php

header('Content-Type: text/plain');

$response['body'] = <<<STR
<?xml version="1.0"?>
    <tracking-events>
    <tracking-event>
    <type>DELIVERED</type>
    <time>2012-12-04T11:45:08.554+0200</time>
    <tracking-id>AB10000</tracking-id>
    </tracking-event>
    </tracking-events>
STR;

$existing = new SimpleXMLElement($response['body']);
$name = $existing->getName();
$name = str_replace('-', '_', $name);
$new = new SimpleXMLElement('<' . $name . '/>');

add_corrected_nodes($existing, $new);

function add_corrected_nodes(&$from, &$to) {
    foreach ($from as $k => $v) {
        $new = str_replace('-', '_', $k);
        $child = $to->addChild($new);
        if ($from->$k->children()) {
            add_corrected_nodes($from->$k->children(), $child);
        } else {
            $to->$new = $v;
        }
    }
}

print_r($new->asXML()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T16:41:29.860

经过测试，它有效！:D

```
 $xml=preg_replace('/<([^>]*?)-([^>]*?)>/', '<$1_$2>',$xml); 
```

# node.js - NodeJS 等待事件时发生了什么

> ID：13516648
> 
> 赞同：2
> 
> 时间：2012-11-22T16:19:56.240
> 
> 标签：node.js

> **可能重复：**
> [node.js 的内部结构。它实际上是如何工作的](https://stackoverflow.com/questions/8575442/internals-of-node-js-how-does-it-actually-work)

我是 NodeJS 的新手，我对事件循环的工作方式感到困惑。

首先，如果我有一个空白文件（假设它被称为 blank.js），并且我使用 node ( `node blank.js`) 运行它，那么 node 运行该文件并立即退出。为什么事件循环没有开始，是什么让它开始的？

其次，当在 NodeJS 上运行服务器时，服务器实际上是在等待输入（即客户端请求）。它在等待时发生了什么，它是如何等待的（它不是在睡觉，我确信它会阻止事件循环）。已经描述了节点的方式，它是事件的（因此它正在等待一个事件），但是它是如何做到的呢？

最后，Ryan Dahl 将 Node 描述为一个单一的堆栈。我认为由于 Node 的事件性质，函数调用不像递归调用中那样具有堆栈。这个对吗？

所以总结一下我的问题：

1.  什么启动事件循环，它是如何启动的？
2.  当 Node 处于等待状态时（这是非阻塞的），这是如何实现的呢？
3.  用于回调的函数的函数内存堆栈会发生什么变化？

我读过有关 NodeJS 的书籍，是的，我意识到 Nodes 是异步单线程非阻塞 IO。我只是不知道内部是如何工作的，也没有书告诉我这一点。

# video - 尽管使用了 avformat_write_header，但 mpg 中缺少标题

> ID：13516652
> 
> 赞同：2
> 
> 时间：2012-11-22T16:20:23.750
> 
> 标签：video, ffmpeg, video-encoding, mpeg-2

我正在使用 ffmpeg C API 将实时渲染的视频编码为 mpg 和/或 mp4（取决于视频的后期使用）。编码为 mp4 时，一切正常。但是当编码为 mpg 时，任何播放器都无法播放生成的视频。快速调用 ffprobe 显示标题丢失。但这似乎几乎是不可能的，因为我明确地写了它。

在对任何帧进行编码之前，这就是我编写标头的方式：

```
// ptr->oc is the AVFormatContext
int error = avformat_write_header(ptr->oc, NULL);
if (error < 0)
{
    s_logFile << "Could not write header. Error: " << error << endl;
    fprintf(stderr, "Could not write header. Error: '%i'\n", error);
    return 1;
} 
```

写入标头时永远不会出现任何错误。

对于编码，我遵循[官方 muxing.c 示例](http://ffmpeg.org/doxygen/trunk/muxing_8c-source.html)，所以我设置了 CODEC_FLAG_GLOBAL_HEADER 标志。我使用 CODEC_ID_MPEG2VIDEO（用于视频）和 CODEC_ID_MP2（用于音频）。

当我在一个额外的步骤中使用外部 ffmpeg 可执行文件“编码”它时，结果 mpg 确实有效：**"ffmpeg -i ownEncoded.mpg -sameq -y working.mpg"**。所以似乎所有数据都在那里，只是由于某种原因缺少标题......

这是 ffmpeg 在编写标头之前/时报告的唯一内容：

```
mpeg -------------------
lvl: 24
msg: VBV buffer size not set, muxing may fail 
```

这可能是问题吗？

我想知道这里有什么问题，因为我用完全相同的函数编码 mp4，除了在编码为 mp4 时设置一些特殊值，如 qmin、qmax、me_method 等。我是否可能必须设置任何特殊值才能使 ffmpeg 真正正确地写入标头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T08:05:13.473

也许你必须`CODEC_FLAG_GLOBAL_HEADER`为`AVCodecContext`. 需要它以防万一`outputFormat->oformat->flags & AVFMT_GLOBALHEADER == true`，在`outputFormat`哪里`AVOutputFormat`

因此你应该写

```
if(outputFormat->oformat->flags & AVFMT_GLOBALHEADER) 
  codec->flags |= CODEC_FLAG_GLOBAL_HEADER; 
```

还要看ffmpeg的输出，可能有警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T09:30:52.950

天啊！

原来我有一个错字导致 CODEC_ID_MPEG2VIDEO 设置不正确，而是使用 H264 作为默认值。当然，这在.mpg 中效果不佳。

感谢评论中的提示，让我又看了一遍！:)

# mysql - 是否可以获得所有 MySQL 系统函数的列表？

> ID：13516656
> 
> 赞同：2
> 
> 时间：2012-11-22T16:20:35.253
> 
> 标签：mysql

我看起来像：

```
SHOW FUNCTION STATUS 
```

获取当前服务器版本的所有可用系统功能的列表。可以直接从 MySQL 引擎获取像[这里这样的表吗？](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html)

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T16:54:26.510

如果您已经安装了帮助表（大多数二进制发行版都安装了；`fill_help_tables.sql`如果没有安装，则会调用一个脚本），您可以输入：

```
mysql> HELP FUNCTIONS
You asked for help about help category: "Functions"
For more information, type 'help <item>', where <item> is one of the following
topics:
       PROCEDURE ANALYSE
categories:
   Bit Functions
   Comparison operators
   Control flow functions
   Date and Time Functions
   Encryption Functions
   Information Functions
   Logical operators
   Miscellaneous Functions
   Numeric Functions
   String Functions 
```

...然后是这样的：

```
mysql> HELP String Functions
You asked for help about help category: "String Functions"
For more information, type 'help <item>', where <item> is one of the following
topics:
  ASCII
  BIN
  BINARY OPERATOR
  BIT_LENGTH
  CAST
  CHAR FUNCTION
... 
```

...在最后做类似的事情之前：

```
mysql> HELP bin
Name: 'BIN'
Description:
Syntax:
BIN(N)

Returns a string representation of the binary value of N, where N is a
.... 
```

**如何生成自己的列表！**

以下查询（在`mysql`数据库上）在一个列表中提供了所有函数及其类别：

```
SELECT help_category.name, help_topic.name 
FROM help_topic JOIN help_category 
    ON help_category.help_category_id = help_topic.help_category_id 
WHERE help_category.help_category_id IN (
    SELECT help_category_id FROM help_category 
    WHERE parent_category_id=37
) ORDER BY 1; 
```

如果你想要每个的文本描述，只需`description`在子句中添加一个列`SELECT`，虽然它很长，所以你可能想要使用`\G`而不是`;`

# linux - crontab 在空白页上打开，无法保存

> ID：13516658
> 
> 赞同：1
> 
> 时间：2012-11-22T16:20:39.113
> 
> 标签：linux, cron, crontab

我对Linux真的不熟悉，最近才开始使用它，所以请耐心等待。我正在尝试通过 crontab 中调用的脚本定期控制相机。当我启动计算机时，我可以打开 crontab 文件，编辑并保存，一切都正确执行。所以我的剧本很好。（顺便说一句，我使用 gedit 作为编辑器）

但是，除非我先重新启动计算机，否则我永远无法再次打开 crontab。这就是发生的情况：我在终端中输入 crontab -e 并得到一个空白页。（通常，crontab 首先将完整的解释显示为注释，然后键入实际命令。）当我键入命令并尝试保存文件（/tmp/crontab.something）时，我收到以下消息：无法找到文件 /tmp/crontqb.something/crontab。请检查您输入的位置是否正确，然后重试。然后我关闭文件而不保存后，终端说“没有修改”，这很公平..

当我尝试：crontab -l 时，我确实在终端中得到了正确的 crontab 内容。

我不知道这是否相关，但是当我尝试 sudo crontab -e 时，我得到“root 没有 crontab。使用一个空的。888”但他没有打开任何东西，我在终端。

重新启动计算机后， crontab -e 再次正常工作，但只有一次..

非常感谢任何帮助！

莎拉

# javascript - 画布精灵动画在 iPhone/Safari 和 Chrome 上部分不可见，但在 Firefox 上没问题

> ID：13516665
> 
> 赞同：0
> 
> 时间：2012-11-22T16:20:53.963
> 
> 标签：javascript, iphone, html, animation, canvas

我想制作一个四处走动的动画精灵。因此，我使用一个包含角色所有动作的精灵表，并通过不同的动画阶段制作动画。

在使用 Firefox 的 PC 上一切正常，但在 Chrome 和 iPhone 上，动画部分损坏。您可以在 PC 上测试它 [http://fiddle.jshell.net/WnjB6/48/](http://fiddle.jshell.net/WnjB6/48/)

和 iphone 直接去这里： http: [//fiddle.jshell.net/WnjB6/48/show/](http://fiddle.jshell.net/WnjB6/48/show/)

我发现 spritesheet 的第二列仅在 iphone 上的动画期间没有显示。对于较小的精灵表，这是可行的。看这里

电脑 [http://jsfiddle.net/WnjB6/7/](http://jsfiddle.net/WnjB6/7/)

iphone [http://jsfiddle.net/WnjB6/7/show](http://jsfiddle.net/WnjB6/7/show)

iphone 的文件大小或 Chrome 如何处理图像是否有限制？

这是来源

```
var canvas = document.getElementById('canvas');
var context = canvas.getContext('2d');

// Constructor for an animation object
// image: graphics source
// x, y: position to draw the animation
// width, height: size of each tile
// htiles: number of tiles horizontally in the image source
var Animation = function(image, x, y, width, height, htiles) {
    this.image = image;
    this.x = x;
    this.y = y;
    this.width = width;
    this.height = height;
    this.htiles = htiles;
    this.animations = {};
    this.currentAnimation = [0];
    this.currentFrame = 0;
}

// Add animation to the object
Animation.prototype.add = function(name, frames) {
    this.animations[name] = frames;
};

// Select animation by name
Animation.prototype.play = function(name) {
    this.currentAnimation = this.animations[name];
    this.currentFrame = 0;
};

// Advance animation, and draw the tile
Animation.prototype.nextFrame = function() {
    // Move to next frame in current animation
    this.currentFrame = (this.currentFrame + 1) % this.currentAnimation.length;
    // Extract which image tile that is
    var tile = this.currentAnimation[this.currentFrame];
    this.drawTile(tile);
};

// Draw the given tile at the current position
Animation.prototype.drawTile = function(tile) {
    // Clear region we are going to draw on
    context.clearRect(this.x, this.y, this.width, this.height);
    context.drawImage(this.image, (tile % this.htiles) * this.width, Math.floor(tile / this.htiles) * this.height, this.width, this.height, this.x, this.y, this.width, this.height);
};

// Initialize the animation
var image = new Image();
image.src = 'http://www.playa.cc/pic/playerstant.png';

var player1 = new Animation(image, 0, 0, 51, 51, 2);
var aniStates = ['stand', 'right', 'walk'];
player1.add(aniStates[0], [65, 67, 69, 71, 73, 75, 77, 79]);
player1.add(aniStates[1], [0, 2, 4, 6, 8, 10, 12, 14, 16]);
player1.add(aniStates[2], [72, 74, 76, 78, 1, 3, 5, 7, 9]);

// Start with the walking animation, and start animating
player1.play(aniStates[0]);
var interval = setInterval(function() {
    player1.nextFrame();
}, 200);

// Toggle animation between standing and walking every 3 seconds
var mode = 0;
setInterval(function() {
    player1.play(aniStates[mode++]);
    mode = mode % aniStates.length;
}, 3000); 
```

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:29:32.063

简短回答一个长问题：

当剪辑部分超出原始图像时，iPhone 上的 Chrome 和 Safari 不会在画布上显示图像。例如，您的图像尺寸为 x:100, y:100，并且您使用

> context.drawImage(image, 0, 0, 101 /* 错误 */, 100, 0, 0, 100, 100)

另请参阅[drawImage 规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-drawimage)

# r - 用于在 R 中以矩阵形式生成引导样本的快速函数

> ID：13516666
> 
> 赞同：2
> 
> 时间：2012-11-22T16:20:54.210
> 
> 标签：r, statistics-bootstrap

我有一个矩阵`A`，我想从每一列中抽取样本`A`并构造新矩阵。例如：

`A = matrix(seq(1,9),3,3)`

所以要获得第一个引导矩阵，我将从 的第一列（`A`即 1、2、3）进行替换（3 次）采样，从 的第二列（`A`即 4、5、6）进行替换（3 次）采样，并从 的第三列`A`，即 7、8、9中替换（3 次）样本。之后，我通过组合三个引导向量重新构造第一个引导矩阵 B1。我将重复此过程 B=199 次，以便引导矩阵 B1、...、B199 可用。

我的问题是，我怎样才能让这个程序运行得更快？我应该使用哪个功能？我知道`apply`本质上涉及`for`循环，因此无法保证速度。怎么样`do.call`？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:27:45.587

您可以使用`replicate`和`apply`：

```
A <- matrix(seq(1,9),3,3)

B <- 199

replicate(B, apply(A, 2, sample, replace = TRUE)) 
```

# wix - 在每台机器安装上删除 HKCU 下的注册表项

> ID：13516684
> 
> 赞同：12
> 
> 时间：2012-11-22T16:22:09.517
> 
> 标签：wix, wix3.6

我使用 WiX 3.6 构建了一个 perMachine 安装程序来安装我没有开发的软件。不幸的是，该软件在执行期间会在 HKCU 下创建一些注册表项。

卸载时，还应删除自行创建的密钥。删除这些键似乎并不容易。我正在与 ICE57 和/或 ICE38 “战斗”。两者都抱怨 perUser 和 perMachine 数据之间的混合。

希望您能指出我解决此问题的正确方向。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T14:09:27.103

要克服 ICE，您应该将 Per-User 注册表移动到单独的组件，并使用一些注册表项作为该组件的 keyPath，即：

```
<Component Id='PerUserRegistry' Guid='*'>
  <RegistryValue Id="PerUserRegistry_KeyPAth" KeyPath="yes" Root="HKCU" Key="Software\[Manufacturer]\[ProductName]\[ProductCode]\PerUserRegistry" Name="[PackageCode]" Value="[ProductVersion]" Type="string" />
  <!--Other Per-user registry goes here-->
</Component> 
```

我完全同意 Christopher 的观点：通常的做法是在卸载时保留每个用户的数据，但如果需要删除，那么 Active Setup 是唯一真正的选择。

首先，我建议您在安装或重新安装时删除它们而不是卸载，您只需要添加 RemoveRegirty 条目和 Active Setup，即使用以下 WiX 代码：

```
<Component Id='ActiveSetup' Guid='*'>
  <RegistryValue Id="ActiveSetup00" Root="HKLM" KeyPath="yes" Key="SOFTWARE\SOFTWARE\Microsoft\Active Setup\Installed Components\[PackageCode]\" Name="StubPath" Value="msiexec /fup [ProductCode] /qb-!" Type="string" />
  <RegistryValue Id="ActiveSetup01" Root="HKLM" Key="SOFTWARE\SOFTWARE\Microsoft\Active Setup\Installed Components\[PackageCode]\" Value="[ProductName] [ProductVerion] Configuration" Type="string" />
</Component>
<Component Id='PerUserRegistryCleanup' Guid='*'>
  <RegistryValue Id="PerUserRegistry_KeyPath" Root="HKCU" KeyPath="yes" Key="SOFTWARE\SOFTWARE\Microsoft\Active Setup\Installed Components\[PackageCode]\" Name="StubPath" Value="msiexec /fup [ProductCode] /qb-!" Type="string" />
  <RemoveRegistryKey Id='PerUserRegCleanup' Root='HKCU' Action='removeOnInstall' Key='Key\To\Be\Removed'/>
</Component> 
```

注意：非常推荐在 ActiveSetup 中使用 [PackageCode]，因此对于 MSI 包的每个新版本（构建），您都添加单独的条目（另见我的最后说明）。我故意使用每个用户的活动设置注册表作为键路径，所以你不要为当前用户运行它两次。

至于卸载后删除它们，现在，希望您需要删除整个密钥，而不仅仅是一些值。在任何一种情况下，我都会创建自定义操作以在卸载期间为 Active Setup 添加注册表项（或者如果有许多这样的键/值，创建和部署 .CMD 文件并在卸载时启动它，然后在 RemoveFiles 操作之前添加所有其中注册）。

注意：我强烈建议在安装期间添加删除此注册表，否则您可能最终会在安装软件时删除每个用户的值。

所以这是所有这些的WiX代码：

```
<CustomAction Id="CA_UninstallRegistryCleanUp" Directory="SystemFolder" ExeCommand="REG.exe ADD &quot;HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\MySoftName_CleanUp&quot; /v StubPath /d &quot;reg add ^&quot;HKCU\Key\To\Be\Removed^&quot; /va /f&quot; /f" Return="ignore" />
<InstallExecuteSequence>
  <Custom Action='CA_UninstallRegistryCleanUp' After='RemoveRegistryValues'>REMOVE~="ALL"</Custom>
</InstallExecuteSequence>

<Component Id='RegCleanup_Remover' Guid='*'>
  <RegistryValue Id="PerUserRegistry_KeyPAth" Root="HKLM" KeyPath="yes" Key="SOFTWARE\[Manufacturer]\[ProductName]\[ProductCode]\" Name="DummyKey" Value="[ProductVersion]" Type="string" />
  <RemoveRegistryKey Id='RegCleanup_Remover' Root='HKLM' Action='removeOnInstall' Key='SOFTWARE\Microsoft\Active Setup\Installed Components\MySoftName_CleanUp'/>
</Component> 
```

最后说明：所有这些 Active Setup 的东西只有两个小问题：在 Windows 终端服务器上要小心；并且一旦为当前 .MSI 的一个用户运行了活动安装程序，如果您决定重新安装相同的软件包，它将不会再次运行，除非您更改其 PackageConde 或在 ActiveSetup 注册表项下提高版本。这些是另一天的主题，如果需要澄清，请告诉我。

并且不要忘记将上述所有组件添加到某些功能中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T02:30:49.637

Windows 安装程序会考虑此用户数据，最佳做法是不删除它。无论哪种方式，都很难尝试将其删除，因为其他用户配置文件超出了范围/上下文。理论上可以编写自定义操作来枚举配置文件和加载注册表配置单元，但在某些版本的 Windows ( Vista ) 上由于授予 Windows 安装程序服务的权限受限而无法工作。

如果您真的必须能够在卸载时删除自定义操作数据，请查看：

[活动设置解释](http://www.sepago.de/helge/2010/04/22/active-setup-explained/)

您将需要通过将组件标记为永久来留下程序（例如 exe）。然后，您将需要一个自定义操作来在卸载期间写入注册表值（因为 Windows Installer 不支持此操作）。

这个概念是在安装过程中你放下一个 EXE，在卸载过程中你离开你。然后，您写入 ActiveSetup 注册表项，告诉它为每个后续用户登录到计算机运行一次 EXE。EXE 然后删除您的注册表值。如果需要从资源管理器中卸载扩展，请重新启动（礼貌地）。

但老实说，一个设计更好的应用程序不需要所有这些。

# reverse-engineering - iBatis/MyBatis 实体映射到 DDL 反向生成

> ID：13516687
> 
> 赞同：1
> 
> 时间：2012-11-22T16:22:14.497
> 
> 标签：reverse-engineering, mybatis, ddl

我正在寻找一种从现有 iBatis sql 实体映射中生成 DDL 的方法？有没有我在网上找不到的。

# c# - 对于 i = 0，为什么 (i += i++) 等于 0？

> ID：13516689
> 
> 赞同：254
> 
> 时间：2012-11-22T16:22:17.410
> 
> 标签：c#, .net

采用以下代码（可用作控制台应用程序）：

```
static void Main(string[] args)
{
    int i = 0;
    i += i++;
    Console.WriteLine(i);
    Console.ReadLine();
} 
```

结果`i`是 0。我预计是 2（正如我的一些同事所做的那样）。编译器可能会创建某种导致`i`为零的结构。

我期望 2 的原因是，在我的思路中，首先评估右手语句，将 i 增加 1。然后将其添加到 i。因为 i 已经是 1，所以它将 1 添加到 1。所以 1 + 1 = 2。显然这不是正在发生的事情。

你能解释一下编译器做了什么或者在运行时发生了什么吗？为什么结果为零？

*某种免责声明：我绝对知道您不会（并且可能不应该）使用此代码。我知道我永远不会。尽管如此，我发现知道它为什么会以这种方式运行以及究竟发生了什么是很有趣的。*

* * *

## 回答 #1

> 赞同：425
> 
> 时间：2012-11-22T16:25:56.527

这：

```
int i = 0;
i += i++ 
```

可以看作是你在做的（以下是粗略的过度简化）：

```
int i = 0;
i = i + i; // i=0 because the ++ is a postfix operator and hasn't been executed
i + 1; // Note that you are discarding the calculation result 
```

实际发生的事情比这更复杂 - 看看 MSDN，[7.5.9 Postfix 增量和减量运算符](http://msdn.microsoft.com/en-us/library/aa691363.aspx)：

> x++ 或 x-- 形式的后缀递增或递减操作的运行时处理包括以下步骤：
> 
> *   如果 x 被归类为变量：
>     
>     
>     *   x 被评估以产生变量。
>     *   x 的值被保存。
>     *   使用保存的 x 值作为其参数调用选定的运算符。
>     *   运算符返回的值存储在 x 的求值给出的位置。
>     *   x 的保存值成为操作的结果。

请注意，由于[优先顺序](http://msdn.microsoft.com/en-us/library/aa691323.aspx)，后缀`++`出现*在 之前* `+=`，但结果最终未被使用（因为使用了之前的值`i`）。

* * *

对其构成的部分进行更彻底的分解`i += i++`需要知道两者`+=`都不`++`是原子的（即，两者都不是单个操作），即使它们看起来像。这些实现的方式涉及临时变量，`i`操作发生之前的副本 - 每个操作一个。（我将使用名称`iAdd`和分别`iAssign`用于 和 的临时变量`++`）`+=`。

因此，更接近正在发生的事情是：

```
int i = 0;
int iAdd = i; // Copy of the current value of i, for ++
int iAssign = i; // Copy of the current value of i, for +=

i = i + 1; // i++ - Happens before += due to order of precedence
i = iAdd + iAssign; 
```

* * *

## 回答 #2

> 赞同：195
> 
> 时间：2012-11-22T17:33:17.760

运行代码的反汇编：

```
int i = 0;
  xor         edx, edx
  mov         dword ptr i, edx         // set i = 0
i += i++;
  mov         eax, dword ptr i         // set eax = i (=0)
  mov         dword ptr tempVar1, eax  // set tempVar1 = eax (=0)
  mov         eax, dword ptr i         // set eax = 0 ( again... why??? =\ )
  mov         dword ptr tempVar2, eax  // set tempVar2 = eax (=0)
  inc         dword ptr i              // set i = i+1 (=1)
  mov         eax, dword ptr tempVar1  // set eax = tempVar1 (=0)
  add         eax, dword ptr tempVar2  // set eax = eax+tempVar2 (=0)
  mov         dword ptr i, eax         // set i = eax (=0) 
```

## 等效代码

它编译为与以下代码相同的代码：

```
int i, tempVar1, tempVar2;
i = 0;
tempVar1 = i; // created due to postfix ++ operator
tempVar2 = i; // created due to += operator
++i;
i = tempVar1 + tempVar2; 
```

第二个代码的反汇编（只是为了证明它们是相同的）

```
int i, tempVar1, tempVar2;
i = 0;
    xor         edx, edx
    mov         dword ptr i, edx
tempVar1 = i; // created due to postfix ++ operator
    mov         eax, dword ptr i
    mov         dword ptr tempVar1, eax
tempVar2 = i; // created due to += operator
    mov         eax, dword ptr i
    mov         dword ptr tempVar2, eax
++i;
    inc         dword ptr i
i = tempVar1 + tempVar2;
    mov         eax, dword ptr tempVar1
    add         eax, dword ptr tempVar2
    mov         dword ptr i, eax 
```

## 打开拆卸窗口

大多数人不知道，甚至不记得，他们可以使用 Visual Studio**反汇编**窗口看到最终的内存中汇编代码。它显示正在执行的机器代码，它不是 CIL。

在调试时使用它：

`Debug (menu) -> Windows (submenu) -> Disassembly`

## 那么 postfix++ 发生了什么？

后缀++告诉我们想在评估之后增加操作数的值……每个人都知道……有点混淆的是*“评估之后”*的含义。

那么*“评估后”*是什么意思：

*   必须影响同一行代码中操作数的其他用法：
    *   `a = i++ + i`第二个 i 受增量影响
    *   `Func(i++, i)`第二个我受到影响
*   同一行上的其他用法尊重短路运算符，例如`||`and `&&`：
    *   `(false && i++ != i) || i == 0`第三个 i 不受 i++ 影响，因为它没有被评估

**那么： 的含义是`i += i++;`什么？**

它与`i = i + i++;`

评价顺序为：

1.  存储 i + i（即 0 + 0）
2.  增加 i (i 变为 1)
3.  将第 1 步的值赋给 i（i 变为 0）

并不是说增量被丢弃。

**是什么意思：`i = i++ + i;`？**

这与前面的示例不同。第三个`i`受增量影响。

评价顺序为：

1.  存储 i（即 0）
2.  增加 i (i 变为 1)
3.  存储 step 1 + i 的值（即 0 + 1）
4.  将第 3 步的值赋给 i（i 变为 1）

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2012-11-22T16:31:29.583

```
int i = 0;
i += i++; 
```

评估如下：

```
Stack<int> stack = new Stack<int>();
int i;

// int i = 0;
stack.Push(0);                   // push 0
i = stack.Pop();                 // pop 0 --> i == 0

// i += i++;
stack.Push(i);                   // push 0
stack.Push(i);                   // push 0
stack.Push(i);                   // push 0
stack.Push(1);                   // push 1
i = stack.Pop() + stack.Pop();   // pop 0 and 1 --> i == 1
i = stack.Pop() + stack.Pop();   // pop 0 and 0 --> i == 0 
```

ie`i`被更改了两次：一次由`i++`表达式更改，一次由`+=`语句更改。

但是`+=`语句的操作数是

*   `i`评估前的值`i++`（的左侧`+=`）和
*   ( 的右侧)`i`评估之前的值。`i++``+=`

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2012-11-22T16:26:06.103

首先，`i++`返回 0。然后`i`加 1。最后`i`设置为初始值`i`0 加上`i++`返回的值，也就是 0。0 + 0 = 0。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2012-11-22T18:19:55.200

这只是抽象语法树的从左到右、自下而上的评估。从概念上讲，表达式的树是从上往下走的，但是当递归从底部弹出树时，评估就会展开。

```
// source code
i += i++;

// abstract syntax tree

     +=
    /  \
   i    ++ (post)
         \
         i 
```

评估从考虑根节点开始`+=`。这是表达式的主要组成部分。`+=`必须计算左操作数以确定我们存储变量的位置，并获得零的先验值。接下来，必须评估右侧。

右侧是后自增`++`运算符。它有一个操作数，`i`既可以作为值的来源，也可以作为存储值的位置。操作员评估`i`、发现`0`并因此将 a 存储`1`到该位置。它根据返回先验值`0`的语义返回先验值。

现在控制权又回到了`+=`操作员手中。它现在拥有完成其操作的所有信息。它知道存储结果的位置（ 的存储位置`i`）以及先验值，并且它具有要添加到先验值的值，即`0`。所以，`i`以零结束。

与 Java 一样，C# 通过固定求值顺序净化了 C 语言的一个非常愚蠢的方面。从左到右，自下而上：编码人员可能期望的最明显的顺序。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2012-11-22T16:24:31.170

因为`i++`首先返回值，然后递增它。但是在 i 设置为 1 之后，您将其设置回 0。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2012-11-22T16:36:27.310

后增量方法看起来像这样

```
int ++(ref int i)
{
    int c = i;
    i = i + 1;
    return c;
} 
```

所以基本上当你打电话时`i++`，`i`是增量，但在你的情况下返回原始值，它是 0 被返回。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2012-11-22T16:24:07.617

后修复增量运算符 ,`++`在表达式中为变量提供一个值，然后执行*您分配的增量返回零 (0) 值`i`再次覆盖增量的一 (1)*，因此您得到零。*[您可以在++ 运算符](http://msdn.microsoft.com/en-us/library/36x43w8w%28v=vs.71%29.aspx)*(MSDN)中阅读有关增量运算符的更多信息。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2012-11-22T20:52:12.147

i++ 表示：返回 i 的值，然后递增它。

i += i++ 表示：取 i 的当前值。添加 i++ 的结果。

现在，让我们添加 i = 0 作为起始条件。i += i++ 现在评估如下：

1.  i的当前值是多少？它是 0。存储它，以便我们可以将 i++ 的结果添加到它。
2.  评估 i++（评估为 0，因为这是 i 的当前值）
3.  加载存储的值并将步骤 2 的结果添加到其中。（加 0 到 0）

注意：在第 2 步结束时，i 的值实际上是 1。但是，在第 3 步中，您通过在 i 递增之前加载它的值来丢弃它。

与 i++ 不同，++i 返回递增的值。

因此， i+= ++i 会给你 1。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2012-11-23T05:34:50.820

### 简单的答案

```
int i = 0;
i += i++;
// Translates to:
i = i + 0; // because post increment returns the current value 0 of i
// Before the above operation is set, i will be incremented to 1
// Now i gets set after the increment,
// so the original returned value of i will be taken.
i = 0; 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2012-11-22T16:25:17.710

`i += i++;`将等于零，因为它会在`++`之后。

`i += ++i;`之前会做

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2012-11-22T16:26:00.377

++ 后缀`i`在递增之前求值，并且`+=`只求值`i`一次。

因此，0 + 0 = 0，as`i`在递增之前被评估和使用，因为使用的是后缀格式`++`。要`i`首先递增，请使用前缀形式 ( `++i`)。

（另外，请注意：您应该只得到 1，因为 0 + (0 + 1) = 1）

参考： http: [//msdn.microsoft.com/en-us/library/sa7629ew.aspx](http://msdn.microsoft.com/en-us/library/sa7629ew.aspx) (+=)
[http://msdn.microsoft.com/en-us/library/36x43w8w.aspx](http://msdn.microsoft.com/en-us/library/36x43w8w.aspx) (++)

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2012-11-23T19:52:20.253

## C# 在做什么，以及困惑的“为什么”

我还预计该值为 1……但对此事的一些探索确实澄清了一些观点。

考虑以下方法：

```
 static int SetSum(ref int a, int b) { return a += b; }

    static int Inc(ref int a) { return a++; } 
```

我希望这`i += i++`与`SetSum(ref i, Inc(ref i))`. 此语句后 i 的值为**1**：

```
int i = 0;
SetSum(ref i, Inc(ref i));
Console.WriteLine(i); // i is 1 
```

但后来我得出另一个结论......`i += i++`实际上与`i = i + i++`......相同，所以我创建了另一个类似的例子，使用这些函数：

```
 static int Sum(int a, int b) { return a + b; }

    static int Set(ref int a, int b) { return a = b; } 
```

调用此`Set(ref i, Sum(i, Inc(ref i)))`函数后， i 的值为**0**：

```
int i = 0;
Set(ref i, Sum(i, Inc(ref i)));
Console.WriteLine(i); // i is 0 
```

这不仅解释了 C# 在做什么……而且解释了为什么很多人对它感到困惑……包括我。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2012-11-23T10:52:10.637

我一直记得的一个很好的助记符如下：

如果`++`位于表达式**之后**，则返回它**之前**的值。所以下面的代码

```
int a = 1;
int b = a++; 
```

是 1，因为**在它被****之后**的站立增加之前`a`是 1 。人们将此称为**post** fix 表示法。还有一个**前缀**表示法，情况正好相反：如果代表**before**，则表达式返回操作**后**的值：**`++` **`a`****`++`********

 ******```
int a = 1;
int b = ++a; 
```

`b`是两个在这里。

因此，对于您的代码，这意味着

```
int i = 0;
i += (i++); 
```

`i++`返回 0（如上所述），所以`0 + 0 = 0`.

```
i += (++i); // Here 'i' would become two 
```

[Scott Meyers](http://en.wikipedia.org/wiki/Scott_Meyers)在“有效的 C++ 编程”中描述了这两种符号之间的区别。在内部，`i++`(postfix) 记住值`i`was，并调用前缀表示法 ( `++i`) 并返回旧值，`i`。这就是为什么您应该始终使用`++i`in`for`循环（尽管我认为所有现代编译器都在转换`i++`为`++i`in`for`循环）。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2014-03-26T09:13:46.710

您问题的唯一正确答案是：**因为它是未定义的。**

好吧，在你们都烧我之前..

你们都回答了为什么`i+=i++`结果是可以且合乎逻辑的`i=0`。

我很想对你的每一个答案都投反对票，但我计算出的声誉打击太高了..

为什么我对你们这么生气？不是因为你的答案解释了什么。
我的意思是，我读到的每一个答案都做出了非凡的努力来解释不可能的事情，我鼓掌！

但是结果如何？？它是直观的结果吗？这是可以接受的结果吗？

你们每个人都看到了“裸王”，并以某种方式接受它为理性的国王。

**你们都错了！**

`i+=i++;`结果`0`是未定义的。

如果你愿意的话，语言评估机制中的一个错误......甚至更糟！设计中的错误。

想要证明？你当然想要！

`int t=0; int i=0; t+=i++; //t=0; i=1`

现在这……是直观的结果！因为我们首先评估`t`分配了一个值，并且只有在评估和分配之后我们才进行后期操作 - 不是很合理吗？

是否合理：`i=i++`并`i=i`产生相同的结果`i`？

while`t=i++`和`t=i`有不同的结果`i`。

后操作是在语句评估之后应该发生的事情。
所以：

```
int i=0;
i+=i++; 
```

如果我们写的话应该是一样的：

```
int i=0;
i = i + i ++; 
```

因此与以下内容相同：

```
int i=0;
i= i + i;
i ++; 
```

因此与以下内容相同：

```
int i=0;
i = i + i;
i = i + 1; 
```

如果我们进行理性思考，任何不`1`表示编译器中的错误或语言设计中的错误的结果 - 但是 MSDN 和许多其他来源告诉我们“嘿 - 这是未定义的！”

现在，在我继续之前，即使我给出的这组例子也没有得到任何人的支持或认可。然而，按照直觉和理性的方式，这应该是结果。

编码人员应该不知道程序集是如何编写或翻译的！

如果它是以不尊重语言定义的方式编写的 - 这是一个错误！

最后，我从 Wikipedia 中复制了这个[增量和减量运算符](http://en.wikipedia.org/wiki/Increment_and_decrement_operators)：
***由于增量/减量运算符会修改其操作数，因此在同一表达式中多次使用此类操作数会产生未定义的结果****。例如，在诸如 x − ++x 之类的表达式中，并不清楚应该按什么顺序执行减法和增量运算符。当编译器应用优化时，这种情况会变得更糟，这可能导致操作的执行顺序与程序员的预期不同。*

**因此。** 

**正确答案是不应该使用这个！（因为它是未定义的！）** 

是的.. - 即使 C# 编译器试图以某种方式对其进行规范化，它也会产生不可预测的结果。

我没有找到任何 C# 文档来描述你们所有人都记录为该语言的正常或明确定义的行为。我发现的恰恰相反！

[[从 MSDN 文档中复制后缀增量和减量运算符：++ 和 --](http://msdn.microsoft.com/en-us/library/e1e3921c.aspx) ]

*将后缀运算符应用于函数参数时，**不保证**参数的值在传递给函数之前会递增或递减。有关详细信息，请参阅 C++ 标准中的第 1.9.17 节。*

请注意那些**不能保证**的词...

如果这个答案显得傲慢，请原谅我——我不是一个傲慢的人。我只是认为成千上万的人来这里学习，我读到的答案会误导他们，并会损害他们对主题的逻辑和理解。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2012-11-22T16:27:16.890

变量后的 ++ 运算符使其成为后缀增量。递增发生在语句中的所有其他内容之后，即添加和赋值。相反，如果您将 ++ 放在变量之前，它将在 i 的值被评估之前发生，并为您提供预期的答案。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2012-11-23T13:25:53.017

计算步骤如下：

1.  `int i=0`//初始化为0
2.  `i+=i++` //方程
3.  `i=i+i++` //通过编译器简化方程后
4.  `i=0+i++` //i 值替换
5.  `i=0+0` //i++ 为 0，如下所述
6.  `i=0` //最终结果i=0

在这里，最初的值`i`是 0。WKT`i++`只不过是：首先使用该`i`值，然后将该`i`值递增 1。所以它在计算时使用该`i`值 0，`i++`然后将其递增 1。所以它产生一个值0。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2012-11-22T16:29:07.797

有两种选择：

第一种选择：如果编译器读取语句如下，

```
i++;
i+=i; 
```

那么结果是2。

为了

```
else if
i+=0;
i++; 
```

结果是 1。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2012-11-23T12:39:08.080

要非常小心：阅读 C[常见问题解答](http://en.wikipedia.org/wiki/FAQ)：您正在尝试做的事情（混合赋值和`++`同一个变量）不仅未指定，而且也未定义（意味着编译器在评估时可以做*任何事情*！，不仅给出“合理”的结果）。

请阅读[第 3 节](http://www.faqs.org/faqs/C-faq/faq/)。整个部分非常值得一读！尤其是 3.9，它解释了 unspecified 的含义。第 3.3 节简要总结了使用“i++”等可以做什么和不能做什么。

根据编译器的内部结构，您可能会得到 0、2、1 甚至其他任何值！由于它是未定义的，因此他们可以这样做。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2014-09-09T13:25:21.733

上面的答案有很多很好的推理，我只是做了一个小测试，想和你分享

```
int i = 0;
i+ = i++; 
```

这里结果 i 显示 0 结果。现在考虑以下情况：

情况1：

```
i = i++ + i; //Answer 1 
```

早些时候我认为上面的代码类似于这个，所以乍一看答案是 1，而这个我的真正答案是 1。

案例二：

```
i = i + i++; //Answer 0 this resembles the question code. 
```

这里增量运算符不会出现在执行路径中，这与之前 i++ 有机会在添加之前执行的情况不同。

我希望这个能有一点帮助。谢谢

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2012-11-27T19:13:58.887

希望从 C 编程 101 类型的角度回答这个问题。

在我看来，它是按以下顺序发生的：

1.  `i`被评估为 0，导致`i = 0 + 0`增量操作`i++`“排队”，但 0 的分配`i`也尚未发生。
2.  增量`i++`发生
3.  上面的赋值`i = 0`发生了，有效地覆盖了#2（后增量）所做的任何事情。

现在，#2 可能永远不会真正发生（可能不会？），因为编译器可能意识到它没有任何作用，但这可能取决于编译器。无论哪种方式，其他更有见识的答案都表明结果是正确的并且符合 C# 标准，但没有定义 C/C++ 此处发生的情况。

如何以及为什么超出了我的专业知识，但之前评估的右侧分配发生在后增量之后的事实可能在这里令人困惑。

`++i`此外，除非您这样做而不是`i++`我相信，否则您不会期望结果为 2 。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2012-11-28T17:06:04.120

简单的说，

i++，将在“+=”运算符完成后将“i”加 1。

您想要的是 ++i，以便在执行“+=”运算符之前将“i”加 1。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-11-23T16:04:14.567

```
i=0

i+=i

i=i+1

i=0; 
```

然后将 1 添加到`i`.

我+=我++

所以在给加 1 之前，取值为 0。只有我们之前加 1 时，才`i`取值为0。`i``i`

```
i+=++i

i=2 
```

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2012-11-23T07:33:20.633

答案是`i`会`1`。

让我们看看如何：

最初`i=0;`.

然后在`i +=i++;`根据 的值进行计算时，我们会有类似的东西`0 +=0++;`，所以根据运算符优先级`0+=0`将首先执行，结果将是`0`。

然后增量运算符将应用 as `0++`， as`0+1`和值`i`will be `1`。******

# java - 使用 hibernate 映射基本类型的集合

> ID：13516706
> 
> 赞同：0
> 
> 时间：2012-11-22T16:22:59.863
> 
> 标签：java, spring, hibernate, spring-mvc, hibernate-mapping

我正在尝试保留一个列表，但是我收到了这个错误

```
org.hibernate.MappingException: Could not determine type for: java.util.List, at table: Person, for columns: [org.hibernate.mapping.Column(comments)] 
```

我使用了 hibernate 文档中指定的 @ElementCollection 注释。我看不出还有什么可以尝试的。

请忽略这一段只是为了让我可以提交问题。

```
import java.util.ArrayList;
import java.util.List;

import javax.persistence.Column;
import javax.persistence.ElementCollection;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

import org.hibernate.annotations.GenericGenerator;
import org.springframework.stereotype.Component;

@Component
@Entity
public class Person {
    private String name;

private Long id;
private String reviewName;
private String review;
private List<String> comments = new ArrayList<String>();

public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
}

@Id
@GeneratedValue(generator="increment")
@GenericGenerator(name="increment", strategy="increment")
public Long getId() {
    return id;
}

public void setId(Long id) {
    this.id = id;
}

@Column(columnDefinition="LONGTEXT")
public String getReview() {
    return review;
}

public void setReview(String review) {
    this.review = review;
}

public String getReviewName() {
    return reviewName;
}

public void setReviewName(String reviewName) {
    this.reviewName = reviewName;
}

public List<String> getComments() {
    return comments;
}

@ElementCollection
public void setComments(List<String> comments) {
    this.comments = comments;
}

public void addComment(String comment) {
    getComments().add(comment);
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T17:12:16.280

@elementcollection 注释应该放在 getter (getComments()) 而不是 setter

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-29T11:51:35.333

问题是你应该有

```
@ElementCollection(targetClass=String.class) 
```

在每次提到集合类型（map/list/etc）之前，包括属性声明和方法声明。

不是在一次提到“而不是”另一个之前，而是在任何地方。

# python - 如何将我的 django 应用程序的所有文件放入一个文件夹中？

> ID：13516708
> 
> 赞同：0
> 
> 时间：2012-11-22T16:23:16.370
> 
> 标签：python, django

我目前有一个名为 Reserve 的 Django 应用程序。在名为“reserve”的文件夹中，我拥有应用程序的大部分内容（views.py、urls.py、models.py、模板文件夹）。但是，我在“reserve”之外有一个名为“booking”的文件夹，其中只有我的 settings.py。我尝试通过将“预订”中的 settings.py 放入“预订”来进行整合，但我似乎遇到了错误。关于如何只拥有一个包含所有内容的文件夹的任何建议？

我得到的错误是： ImportError: Could not import settings 'booking.settings' (Is it on sys.path?): No module named booking.settings

```
overall project folder
    booking folder
        settings.py
        init.py

    reserve folder (the app)
        views.py
        admin.py
        models.py
        ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:49:43.740

我假设您在整个项目目录中有 manage.py ？我还假设您只想`runserver`.

您似乎将`settings.py`文件移到了整个项目目录之外。如果这样做，则必须在运行服务器时指定设置文件路径，或者您也可以导出 django 设置模块以指向新设置路径（使用点表示法）。在这种情况下，我认为它会是（在命令行中）：

```
export DJANGO_SETTINGS_MODULE=<overal-project-folder-name>.booking.settings
python manage.py runserver 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:52:05.263

你用的是什么版本的django？你在运行什么命令？假设您只是尝试使用命令运行命令`manage.py` ，如果您要永久保留此项目结构，则只需 chnage manage.py 即可反映这一点

```
#!/usr/bin/env python
import os
import sys 

if __name__ == "__main__":
    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "your_project.settings")

    from django.core.management import execute_from_command_line

    execute_from_command_line(sys.argv) 
```

您应该更改`os.environ.setdefault`为您的 settings.py 的正确目录

# java - Java - 将 txt 文件的部分添加到数组中

> ID：13516709
> 
> 赞同：2
> 
> 时间：2012-11-22T16:23:18.333
> 
> 标签：java, arrays, string, csv

我已经导入了一个`.csv`数据库文件，其中列出了程序的用户，以及以下形式的其他信息：UserName、Password、PropertyName、EstimatedValue。

我已经想出了如何获取用户名，但它只会读取数据库中的最后一个用户名，而不会读取其他用户名。帮助将不胜感激。

```
import java.util.*;
import java.io.*;

public class readCSV
{
    String[] userData;

    public void checkLogin() throws IOException
    {
        try
        {
            File file = new File("C:/Users/Sean/Documents/Programming assigment/Users.csv");
            BufferedReader bufRdr  = new BufferedReader(new FileReader(file));      
            String lineRead = bufRdr.readLine();
            while(lineRead != null)
            {
                this.userData = lineRead.split(",");
                lineRead = bufRdr.readLine();
            }
            bufRdr.close();
        }
        catch(Exception er){
            System.out.print(er); 
            System.exit(0);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:26:41.093

违规行是这样的：

```
this.userData = lineRead.split(","); 
```

您应该将其放入某个集合中，例如列表

```
final List<String[]> userData = new LinkedList<String[]> ();

try
    {
        File file = new File("C:/Users/Sean/Documents/Programming assigment/Users.csv");
        BufferedReader bufRdr  = new BufferedReader(new FileReader(file));      
        String lineRead = bufRdr.readLine();
        while(lineRead != null)
        {
            this.userData.add (lineRead.split(","));
        }
        bufRdr.close();
    }
    catch(Exception er){
        System.out.print(er); 
        System.exit(0);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T16:27:05.157

您的线路；

```
this.userData = lineRead.split(","); 
```

每次迭代都会覆盖 的值`this.userData`，结果是它只保存最终迭代的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T16:26:59.113

您的 String[] (userData) 在每次迭代时都被替换/覆盖，您必须将它们存储在数组/集合中。

```
List<String[]> list = new ArrayList<String[]>();
while((lineRead=bufRdr.readLine())!= null)
        {
            this.userData = lineRead.split(",");
            list.add(this.userData);
        }
        bufRdr.close(); 
```

要打印内容：

```
for(String[] str : list){
    for(String s: str){
       System.out.pritnln(s);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-22T16:36:51.587

如果你想读取许多用户，你需要一个用户数据的 ArrayList：
this.userData 定义为

```
 ArrayList<UserData> userDataList; 
```

在你的循环中：

```
 while(lineRead != null)
 {
      this.userDataList.add(lineRead.split(","));
      lineRead = bufRdr.readLine();
 } 
```

您当前的代码会遍历所有名称，但会覆盖每次迭代中的值。最后只保留最后一个值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T16:28:26.117

问题是在你的while循环中你将你的字符串分配给同一个变量......所以一旦你阅读了整个文件......这个变量只保存最后一个值。

你需要做的是：

```
Vector<String> userData = new Vector<String>(); 
```

然后在你的循环中......

```
userData.add(lineRead); 
```

然后稍后您可以拆分每个并在那时进行其他处理....

# meteor - 在异步回调上更新 Meteor 集合

> ID：13516710
> 
> 赞同：1
> 
> 时间：2012-11-22T16:23:35.573
> 
> 标签：meteor

我有一个使用节点模块 MQTTClient 的流星应用程序。

每当将某些内容发布到客户端订阅的主题时，此客户端都会发送事件。

当事件发生时，我想更新集合中的条目，但是当我这样做时，我得到断言失败并且数据库被损坏。

```
Assertion failed: (handle->InternalFieldCount() > 0), function Unwrap, file ../src/node_object_wrap.h, line 61.
Exited from signal: SIGABRT
Your application is crashing. Waiting for file change. 
```

这是我目前拥有的：

```
...

client.connect(function () {
  console.log('connected to MQTT broker');

  Fiber(function(){
    var allTopics = Topics.find({});
    allTopics.forEach(function(topic){
      console.log('subscribing to ' + topic.name);
      client.subscribe(topic.name);
    });
  }).run();

});

var onPublish = function(topicName, payload, message_id) {
  console.log("New message: " + topicName + ":" + payload);
  Topics.insert({name: payload, value: payload});
};

var wrappedOnPublish = Meteor.bindEnvironment(onPublish, function(e){
  var message = "Something went wrong! " +
                "Everything is broken! " + 
                "Your life is ruined!";

  console.log(message, e.stack);
});

client.on('publish', wrappedOnPublish); 
```

我还尝试通过将回调包装在 Fiber(..).run() 中来处理回调，但发生完全相同的错误。

# regex - JavaScript 源的正则表达式

> ID：13516712
> 
> 赞同：0
> 
> 时间：2012-11-22T16:23:39.993
> 
> 标签：regex, xpages-ssjs

XPages 应用程序失败并显示以下堆栈跟踪：

```
com.ibm.jscript.InterpretException: Script interpreter error, line=30, col=43: 'component' is null
at com.ibm.jscript.ASTTree.ASTMember.interpret(ASTMember.java:153)
at com.ibm.jscript.ASTTree.ASTCall.interpret(ASTCall.java:88)
at com.ibm.jscript.ASTTree.ASTBlock.interpret(ASTBlock.java:100)
at com.ibm.jscript.ASTTree.ASTIf.interpret(ASTIf.java:85)
at com.ibm.jscript.ASTTree.ASTBlock.interpret(ASTBlock.java:100)
at com.ibm.jscript.ASTTree.ASTIf.interpret(ASTIf.java:85)
at com.ibm.jscript.ASTTree.ASTBlock.interpret(ASTBlock.java:100)
at com.ibm.jscript.ASTTree.ASTTry.interpret(ASTTry.java:109)
at com.ibm.jscript.ASTTree.ASTIf.interpret(ASTIf.java:85)
at com.ibm.jscript.ASTTree.ASTProgram.interpret(ASTProgram.java:119)
at com.ibm.jscript.ASTTree.ASTProgram.interpretEx(ASTProgram.java:139) 
```

由此我知道，嵌套在块层次结构中的变量“组件”存在问题：if -> try -> { -> if -> { -> if -> { -> 使用无效参数的方法调用。

我不知道到底要寻找什么，搜索“组件”会产生太多结果。

我应该使用什么正则表达式来根据代码层次结构找到正确的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T16:32:27.630

在这种情况下，我很可能没有将所有 SSJS 代码放入 try/catch 块中。坏消息：搜索此错误的原因非常麻烦，因为靠近所有 SSJS 块可能是此错误的根本原因。

出于这个原因，我设置了自己的规则（并且不时地忽略它）将每个 SSJS 块放入 try/catch 中，如下所示：

```
try {
    // ... do fancy stuff here
} catch (e) {
    print(e.toString());
} 
```

toString() 调用用于某些特殊情况，其中错误对象似乎不会自动转换为可以由 print 方法处理的对象。

如果是这种情况，您还没有将所有 SSJS 块放入 try/catch 中，这正是这样做并为将来保留该编码模式的正确时机。它真的时不时有帮助;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T19:42:34.003

而不是 printStackTrace 和 toString() ，您可以只说 print(e)，它只会输出错误消息（应该与 e.message 相同）。如果将错误对象传递给 java 例程，您可以获得错误行。

嵌套在块层次结构中的变量“组件”==>我们已经使这个工作没有问题。

# jquery - 使用到达的 div id 更改 URL 哈希值

> ID：13516716
> 
> 赞同：0
> 
> 时间：2012-11-22T16:23:53.950
> 
> 标签：jquery, css

考虑以下代码段：

```
<div id="container">
    <div id="1" class="flag"></div> 
    /* some text */

    <div id="2"  class="flag"></div> 
    /* some text */

    <div id="3"  class="flag"></div> 
    /* some text */
</div> 
```

容器溢出，它有一个滚动条。我需要在滚动时使用 div 的 id 更改 URL 中的哈希值。例如，滚动条位于容器的顶部/底部。我开始向下/向上滚动，一旦到达 div，我将 URL 的哈希值更改为到达的 div 的*id*。

当我到达一个非常特定的 div(JQuery) 时，这种方式将哈希值更改为一个非常特定的值：

```
 var t = $("#someDiv").offset().top;
                $("#container").scroll(function(){
                    if($(this).scrollTop() > t )
                    {   
                        location.hash = "100";
                    }
                }); 
```

需要进行哪些更改才能使其按需要工作？任何片段、关键字或链接将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:28:52.523

为什么不检查每一个`div`？

```
$("#container").scroll(function() {
    $('#container > div').each(function() {
        if( $("#container").offset().top > $(this).offset().top ) {
            window.location.hash = this.id;
        }
    });
}); 
```

jsfiddle：http: [//jsfiddle.net/2ZjWP/](http://jsfiddle.net/2ZjWP/)

# c# - .NET 的 JavaScriptSerializer.Deserialize() 忽略 JSON 中数字中的小数点

> ID：13516717
> 
> 赞同：4
> 
> 时间：2012-11-22T16:23:56.960
> 
> 标签：c#, .net, json, javascriptserializer

我`JavaScriptSerializer.Deserialize()`用来从 JSON 文件中获取数据。
但它忽略了小数点，虽然`.GetType()`在值上使用，但返回`System.Decimal`.

这是 C# 代码：

```
JavaScriptSerializer jss = new JavaScriptSerializer();          
Dictionary< string, object > dic = jss.Deserialize< Dictionary< string, object >>( json ); 
```

这是 JSON：

```
{ "num": 3.14 } 
```

我试试这个：`Console.WriteLine ( "{0} {1}", dic["num"].GetType(), dic["num"] );`
得到这个：`System.Decimal 314`

PS：如您所见，我是 .NET 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:19:26.163

你一定在做一些你没有告诉我们的事情。

这是完整的工作代码：

```
String json = " { \"num\": 3.14 }";
JavaScriptSerializer jss = new JavaScriptSerializer();
Dictionary<string, object> dic = jss.Deserialize<Dictionary<string, object>>(json);

String test = String.Format("{0} {1}", dic["num"].GetType(), dic["num"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T08:08:07.007

我在 IIS/WAS 中托管的 WCF 服务中遇到了同样的问题，我使用这个类来反序列化一些 JSON。将服务从一个生产服务器移动到另一个文化设置不同的生产服务器后，问题就出现了。

根本问题原来是不同的。尽管运行 WCF 服务的应用程序池是针对具有正确文化的标识，但在服务器重新启动后，运行该服务的进程立即被证明具有错误的标识或错误的文化。我们还没有弄清楚问题到底出在哪里，但这可能是由于 ThreadPool 污染（返回到线程池的线程不会重置其文化），或者是 AppFabric 自动启动中的错误......也许。

无论如何，原始帖子中的问题归结为错误的 CurrentCulture，并且可能是 JavaScriptSerializer 的错误实现（不是 JSON 规范要求小数点使用小数点吗？）。使用不兼容的 CurrentCulture 将无法正确反序列化小数。

# c++ - 在哪里放置重载<<代码？

> ID：13516720
> 
> 赞同：3
> 
> 时间：2012-11-22T16:24:08.927
> 
> 标签：c++, operator-overloading

我正在尝试重载流运算符 <<，对于已经具有 `toString()`返回字符串的函数的类 Foo，使用以下代码：

```
std::ostream &operator<<( std::ostream &flux, Foo const& foo )
{
    flux <<  foo.toString(); 
    return flux;
} 
```

为了在`main.cpp`文件中使用它

我的问题是：把那段代码放在哪里？

*   如果我把它放在`main.cpp`, 在它使用之前，它工作得很好，但我可能想在其他文件中使用它。
*   如果我将它放在 中`foo.cpp`，我会收到“没有这样的功能”错误：

    ```
    src/main.cpp:77: error: no match for ‘operator<<’ in ‘std::cout << foo’ 
    ```

    这是有道理的，因为代码不包含在`main.cpp`文件中

*   如果我把它放在`foo.h`类头中，在类声明之外，我会得到一个“多重定义”错误：

    ```
    foo.o: In function `operator<<(std::basic_ostream<char, std::char_traits<char> >&, Foo const&)':
    foo.cpp:(.text+0x0): multiple definition of `operator<<(std::basic_ostream<char, std::char_traits<char> >&, Matrix const&)'
    bar.o:bar.cpp:(.text+0x0): first defined here 
    ```

    标`foo.h`头确实包含在不同的类/文件中，但是有一个 ifdef 保护，所以我不明白这一点。

那我该怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-22T16:28:15.477

有多种选择：

### 在标头中声明它，在 之后`Foo`，并在 中定义它`Foo.cpp`。

```
//foo.h
class Foo
{};
std::ostream &operator<<( std::ostream &s, Foo const& foo );

//foo.cpp
#include "foo.h"
std::ostream &operator<<( std::ostream &s, Foo const& foo )
{
    return s;
} 
```

### 将其定义为`friend`类定义内部。

```
//Foo.h
class Foo
{
   friend std::ostream &operator<<( std::ostream &s, Foo const& foo )
   {
      return s;
   }
}; 
```

### 定义在头部，在类定义之外，并标记为`inline`防止多重定义。

```
//Foo.h
class Foo
{
};

inline std::ostream &operator<<( std::ostream &s, Foo const& foo )
{
   return s;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T16:26:03.327

将重载的原型放在类声明中，将其实现放在`Foo`实现处（或者如果你想要它`inline`，把它放在`Foo`声明处）。

所以要么：

```
// foo.h
#ifndef FOO_H_ASDSADKJSLADJL
#define FOO_H_ASDSADKJSLADJL
class Foo {
};
std::ostream& operator<< (std::ostream &, Foo const &);
#endif // FOO_H_ASDSADKJSLADJL 
```

* * *

```
// foo.cpp
#include "foo.h"
....
std::ostream& operator<< (std::ostream &os, Foo const &) {
    ....
    return os;
} 
```

或者

```
#ifndef FOO_H_ASDSADKJSLADJL
#define FOO_H_ASDSADKJSLADJL
class Foo {
};
inline std::ostream& operator<< (std::ostream &os, Foo const &) {
    ....
    return os;
}
#endif // FOO_H_ASDSADKJSLADJL 
```

您的编译器没有找到它的错误是缺少重载原型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-22T16:26:33.747

将声明放在头文件中，将定义放在 cpp 文件中。

也就是说，放

```
std::ostream &operator<<( std::ostream &flux, Foo const& foo ); 
```

在你的头文件中，并把

```
std::ostream &operator<<( std::ostream &flux, Foo const& foo )
{
    flux <<  foo.toString(); 
    return flux;
} 
```

在你的 cpp 文件中。

这样，你可以在任何你想要的地方包含头文件，并且可以使用该函数，但它只会被定义一次，所以你不会得到`multiple definitions`错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T16:27:22.787

在标头中声明它，在哪里声明`Foo`，在源代码中定义它，在哪里定义`Foo`方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T16:29:13.767

与 C 和 C++ 一样，您应该

1.  将实际代码放入适当的`.c`/`.cpp`文件中 - 我建议在这里`foo.cpp`
2.  将**预先声明**放入适当的`.h`/头文件中，并对从主 c/cpp 文件外部使用的所有内容`.hpp`进行适当的保护。`#ifdef`

在某些情况下，您可以使用`#define`宏或`inline`函数。这应该在标题中完成；由于内联，不应该有多重声明错误。

**从技术上讲**，您可以做很多事情。我建议坚持在头文件中定义 API 并将实现放入代码文件中的**最佳实践。**这是最可扩展的。该`inline`hack 将适用于这种情况，但如果您稍后决定增强该方法并删除内联，它会令人惊讶地中断。

标头/代码拆分最不可能中断。

# javascript - 在 iOS 上使用 null 调用 forge.facebook.ui 回调

> ID：13516726
> 
> 赞同：3
> 
> 时间：2012-11-22T16:24:57.900
> 
> 标签：javascript, ios, facebook-javascript-sdk, trigger.io, forge

我在使用 Trigger.io Forge 并从本机 FB 好友选择器 UI 获取回调时遇到问题。该问题仅在 iOS 上显示，在 Android 上运行良好。

在 iPhone 设备或模拟器上的催化剂中运行此代码会导致 FB 对话正确显示。

```
>forge.facebook.ui({
        method: 'apprequests',
        message: 'Hey'
    }, function(a){console.log('success: '+JSON.stringify(a))}, function(error) {console.log('error:'+JSON.stringify(error))});
>undefined
>success: null 
```

选择某些用户并发送对话请求关闭时，但从未调用回调。Forge 调试日志中显示以下内容：

```
[DEBUG] Native call: {
[DEBUG]     callid = "35938A56-CEEC-44E1-8742-889D273F6E9E";
[DEBUG]     method = "facebook.ui";
[DEBUG]     params =     {
[DEBUG]         "exclude_ids" = "";
[DEBUG]         message = "invited you to play Halo 4";
[DEBUG]         method = apprequests;
[DEBUG]     };
[DEBUG]     start = "1353579502.975";
[DEBUG] }
[DEBUG] Returning to javascript: {
[DEBUG]     callid = "35938A56-CEEC-44E1-8742-889D273F6E9E";
[DEBUG]     content = "<null>";
[DEBUG]     status = success;
[DEBUG] }
[DEBUG] 2012-12-05 13:04:09.631 Forge[5110:c07] An instance 0x9dd3700 of class  FBSessionManualTokenCachingStrategy was deallocated while key value observers were still registered with it. Observation info was leaked, and may even become mistakenly attached to some other object. Set a breakpoint on NSKVODeallocateBreak to stop here in the debugger. Here's the current observation info:
[DEBUG] <NSKeyValueObservationInfo 0x9dcad90> (
[DEBUG] <NSKeyValueObservance 0x9dd1300: Observer: 0x9de4680, Key path: accessToken, Options: <New: NO, Old: NO, Prior: YES> Context: 0x112ad4, Property: 0xc9a6fe0>
[DEBUG] <NSKeyValueObservance 0x9dbba50: Observer: 0x9de4680, Key path: expirationDate, Options: <New: NO, Old: NO, Prior: YES> Context: 0x112ad4, Property: 0xc9a0a60>
[DEBUG] ) 
```

我们尝试了 Forge 版本 1.4、1.4.21，没有任何乐趣。我认为这与回调内容 = null 有关。

谢谢你的帮助。

**更新** 詹姆斯，你是对的 - iPhone 回调*被*调用，但响应始终为空。我期待收到一个带有 FB 用户 ID 和请求 ID 的对象。

作为参考，Android 工作正常，并返回：

```
[DEBUG] Native call "facebook.ui" with task.params: {"method":"apprequests","message":"Hey"}
[DEBUG] Returning: {"content":{"to[0]":"100004602392907","request":"453015091412347",
                                   "to[1]":"515252483"},
                                    "status":"success",
                                    "callid":"ED47AAB4-7A72-45A0-B0B3-0DADC9A75E9C"} 
```

如果用户取消 FB 对话，则会返回：

```
[DEBUG] Returning: {"content":{},"status":"success",
                        "callid":"256CB78F-3EE1-4BD7-8990-EDE26275D68F"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T18:05:01.893

对此的修复将包含在 v1.4.23 Trigger.io 平台版本中。

您的成功回调将被调用（例如，对于 apprequests）：

```
{"request":"519074534448448","to[0]":"105000524002524"} 
```

**注意：**如果用户点击取消，您的成功回调仍将被调用：`{}`将作为回调参数传递。

如果他们点击`x`左上角的，您的失败回调将被调用。

# java - 禁止 Enter 键在 JTable 中向下移动一行

> ID：13516730
> 
> 赞同：5
> 
> 时间：2012-11-22T16:25:13.873
> 
> 标签：java, swing, jtable, keylistener, key-bindings

我需要覆盖 JTable 上的输入键功能。目前，默认行为是当用户按下“Enter”键时，将行选择向下移动一行。我想禁用它并让它根据他们的选择做一些不同的事情。问题是它似乎在进入我的 keylistener 之前向下移动，它接受了行选择 - 因此这会打开另一个窗口，其中选择了错误的行。

到目前为止，这是我的代码...：

```
public class MyJTable extends JTable {

   public MyJTable(){
        setRowSelectionAllowed(true);
        addListeners()
    }

    public void addListeners(){

         addKeyListener(new KeyListener() {
                @Override
                public void keyTyped(KeyEvent e) {}

                @Override
                public void keyPressed(KeyEvent e) {}

                @Override
                public void keyReleased(KeyEvent e) {
                    int key = e.getKeyCode();
                    if (key == KeyEvent.VK_ENTER) {

                        openChannel();
                    }
                }
           });
    }

    public void openChannel(){
            for (int selectedRow : getSelectedRows()){
                //Code to open channel based on row selected
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-22T16:41:44.083

+1 @Robin 的回答

添加到我的评论...

Swing 使用[`KeyBinding`s](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)`KeyBinding`简单地通过添加一个新的 to 来替换现有的功能`JTable`（美丽的原因是`JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT`）：

```
private void createKeybindings(JTable table) {
table.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "Enter");
    table.getActionMap().put("Enter", new AbstractAction() {
        @Override
        public void actionPerformed(ActionEvent ae) {
            //do something on JTable enter pressed
        }
    });
} 
```

只需调用此方法并传递`JTable`实例即可覆盖`JTable` `ENTER`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-22T16:33:22.753

这是使用键绑定实现的，它优于键侦听器。我强烈建议您也这样做：用键绑定替换您的键侦听器。

解决方案是替换 InputMap 中的条目以指向您自己的 Action（您将其插入到操作映射中），或者仅替换操作映射中的相应条目。

[键绑定教程](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)包含更多信息

# android - 锁定屏幕时活动更改

> ID：13516735
> 
> 赞同：0
> 
> 时间：2012-11-22T16:25:28.287
> 
> 标签：android, android-activity

[解决了]

我有一个问题...当我在我的应用程序运行时锁定手机时，它会在解锁时自动更改为主要活动（从一开始就启动的活动）。

有人知道如何处理锁定时的活动吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:30:34.420

您的活动是否在其 onPause() 方法中调用了 finish()？如果是，请将其删除

# sql - SQL 将重复项作为多列集删除

> ID：13516736
> 
> 赞同：1
> 
> 时间：2012-11-22T16:25:29.493
> 
> 标签：sql

想象一下这样的表：

```
RecordID  Key1  Key2
--------------------
1         111   222  
2         222   111  
3         555   444  
4         000   444  
5         444   000 
```

由于重复项被认为是在列和上具有**相同集**的记录。`Key1``Key2`

例如，记录：（1 和 2）和（4 和 5）被认为是重复的，因为它们具有相同的条目*集*。

因此，重复数据删除的一个示例输出可能是：

```
1         111   222
3         555   444
4         000   444 
```

任何想法如何在 SQL 中最好地实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T18:18:03.523

询问：

**[SQLFIDDL示例](http://sqlfiddle.com/#!2/e8063/1)**

```
SELECT
t1.*
FROM MyTable t1
  LEFT JOIN MyTable t2
    ON t1.Key1 = t2.Key2
      AND t1.Key2 = t2.Key1
      AND t1.RecordID>t2.RecordID
WHERE t2.RecordID is null 
```

结果：

```
| RECORDID | KEY1 | KEY2 |
--------------------------
|        1 |  111 |  222 |
|        3 |  555 |  444 |
|        4 |    0 |  444 | 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-22T16:45:54.410

这应该得到被欺骗的记录：

```
SELECT alt.RecordID
FROM yourtable AS main
INNER JOIN yourtable AS alt ON (main.Key1 = alt.Key2) AND (main.Key2 = alt.Key1) 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-22T16:45:24.953

要获得您描述的结果，您可以尝试：

```
SELECT M1.RecordId
FROM MyTable M1
WHERE Key1 IN (
    SELECT Key2 
    FROM MyTable
    WHERE Key2 = M1.Key1 AND RecordID <> M1.RecordId
    )
    AND
    Key2 IN (
    SELECT Key1
    FROM MyTable
    WHERE Key1 = M1.Key2 AND RecordID <> M1.RecordId
    ) 
```

要删除记录，只需使用 RecordId ...

就像是 ：

```
DELETE MyTable WHERE RecordId IN ([Previous Query]) 
```

要获得重复数据：

```
SELECT  M1.RecordID
FROM    MyTable AS M1 
        LEFT JOIN MyTable AS MK1 ON M1.Key1 = MK1.Key2 AND M1.RecordID <> MK1.RecordID AND MK1.RecordId > M1.RecordId
        LEFT JOIN MyTable AS MK2 ON M1.Key2 = MK2.Key1 AND M1.RecordID <> MK2.RecordID AND MK2.RecordId > M1.RecordId
WHERE MK2.Key1 IS NOT NULL 
```

:) 对不起，误解了你

# jquery - IE javascript 无法触发事件

> ID：13516740
> 
> 赞同：0
> 
> 时间：2012-11-22T16:25:39.443
> 
> 标签：jquery

我在使用以下脚本时遇到问题，

```
$('#colours li a').click(function(e) {

    $('option').attr("selected", false);

    var selected = $(this).parent("li");
    var colour = selected.attr("class");
    colour = colour.replace("rounded ", "");

  alert(colour);

    $('option[value=' + colour + ']').attr('selected',true);

    if($("#" + colour).hasClass("active")) { return; }

    var active = $(".active");
    var next = $("#" + colour);

    $('#colours li').removeClass("active");
    selected.addClass("active");

    $('option[value=' + colour + ']').attr('selected',true);
    e.preventDefault();
}); 
```

基本上这是在点击时它应该在隐藏的选择中选择一个值，但是在 IE8 中这并没有发生，这是为什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:34:55.640

有一种更简单的方法可以`option`通过更改 parent 的值来更改 selected `select`。

`$('select').val(colour)`将取代这两个`attr()`电话。更改 a 的值会`select`自动处理`selected`更改

`attr()`两者都不是首选方法`selected`，应该使用`prop()`. 这可能是您遇到问题的根源

# wordpress - Wordpress 删除的文件信息“更新 wp_options SET option_value”

> ID：13516741
> 
> 赞同：0
> 
> 时间：2012-11-22T16:25:39.803
> 
> 标签：wordpress

我正在学习取证课程，我一直在研究对博客服务器的攻击。我发现了许多已删除的 Wordpress 文件，并且我设法找出了哪些包含博客文章。

我无法弄清楚的一个文件包含以下开头的信息：

wordpress#UPDATE wp_options SET option_value = 'O:9:\"MagpieRSS\":19:{s:6:\"parser\";i:0;s:12:\"current_item\";a:0:{ }s:5:\"items\";a:10:{i:0;a:9:{s:5:\"title\";s:37:\"印度对巴基斯坦：现在是网络恐怖？\ ";s:6:\"作者\";s:8:\"chinchak\";s:4:\"链接\";s:59:\"http://feeds09.technorati.com/~r /trarticles/~3/sxlCqi2M9aE/\";s:4:\"guid\";s:74:\"http://technorati.com/politics/article/india-vs-pakistan-now-cyber-terror /\";s:11:\"description\";s:182:\"印巴关系可以说是人类有史以来最大的谜团。\";s:7:\"pubdate\"; s:31:\"Tue, 21 Aug 2012 00:03:41 +0000\";s:8:\"category\";s:51:\"PoliticsAssam ViolenceCyber​​ TerrorIndia Vs Pakistan\";s:10:\"feedburner\";a:1:{s:8:\"origlink\";s:74:\"http://technorati.com/politics/article/india-vs-pakistan-现在网络恐怖/\";}

它以这种方式持续了一段时间，但我没有太多运气尝试使用 Google 告诉我“wp_options”的含义。看起来有人试图用评论向博客发送垃圾邮件，但如果没有可以确认我的观点正确的来源，我无法确定。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:23:13.567

wp_option 表在 option_name 和 option_value 列中存储键值信息。存储数组时，它们会被序列化，要对它们进行解码，您可以使用 PHP 的 unserialize 函数。看起来您正在处理试图混淆 Wordpress 用户选项的 SQL 注入。目的并不明显，因为它们很少显示。只在内部使用。如果该 SQL 语句中某处的 where 子句告诉您它正在尝试编辑哪个选项名称，您可能可以使用以下列表匹配它： http: [//codex.wordpress.org/Option_Reference](http://codex.wordpress.org/Option_Reference)

# c# - 转换并检查 struct IList 是否包含可为空的 int。C＃

> ID：13516742
> 
> 赞同：0
> 
> 时间：2012-11-22T16:25:42.673
> 
> 标签：c#, struct, int, nullable, typeconverter

我有一个名为`CheckedNumber`. 此类型用于属性：

```
`public IList<CheckedNumber> CheckedNumbers { get { return this._checkedNumbers; } }` 
```

...保留数字列表。

我有另一个财产：

```
`public int? TheNumber { get { return this._theNumber; } }` 
```

...并想检查其值是否存在于`CheckedNumbers`列表中。

这个：

```
if (this.CheckedNumbers.Contains(this.TheNumber)) { //... } 
```

给出错误：

```
Argument 1: cannot convert from 'int?' to 'ProjectName.Models.CheckedNumber' 
```

我怎么能转换int？到我的结构类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:38:03.187

好的，现在问题*稍微*清楚了一些 - 但从根本上说，您是在询问`CheckedNumber`值列表是否包含特定`int?`值。这是没有意义的，因为 a`int?` *不是*a `CheckedNumber`- 这就像询问 a 是否`List<Fruit>`包含汽车。

如果*part*或您的`CheckedNumber`struct 是`int?`，您可能需要：

```
if (CheckedNumbers.Any(x => x.SomeProperty == TheNumber)) 
```

或者，您*可能*想要：

```
if (CheckedNumbers.Contains(new CheckedNumber(TheNumber))) 
```

否则，您将不得不进一步澄清问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:50:06.697

让`CheckedNumber`实施`IEquatable<CheckedNumber>`。然后`Contains`，您的列表方法可以使用此方法查找列表项。

```
public struct CheckedNumber : IEquatable<CheckedNumber>
{
    public CheckedNumber(int? number)
    {
        _value = number;
    }

    private int? _value;
    public int? Value { get { return _value; } }

    public bool Equals(CheckedNumber other)
    {
        return _value == other._value;
    }
} 
```

现在您可以通过`int?`将`CheckedNumber`

```
if (this.CheckedNumbers.Contains(new CheckedNumber(this.TheNumber))) {
    //...
} 
```

# c# - 如何创建多语言网站

> ID：13516746
> 
> 赞同：4
> 
> 时间：2012-11-22T16:25:48.427
> 
> 标签：c#, .net, asp.net-mvc, localization, satellite-assembly

我即将开始一个必须支持多种欧洲语言的项目。本网站上的所有静态内容必须可以在这些语言之间进行翻译。我听说过附属程序集，并且听说它们用于 .NET 中的多语言站点，但这是很久以前的事了。这仍然是 .NET 中的当前做法吗？我正在使用 ASP.NET MVC。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:30:11.177

如果您使用的是 ASP.NET MVC，则一种选择是为每个视图使用不同的资源。我写了一篇关于它的文章，也许它可以帮助：

[ASP.NET MVC 本地化：使用自定义模板生成资源文件和本地化视图](http://ruijarimba.wordpress.com/2011/05/16/asp-net-mvc-localization-generate-resource-files-and-localized-views-using-custom-templates/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-04T11:19:57.170

如果没有附属部分，您可以将`App_GlobalResources`文件夹添加到项目并`*.resx`为每种语言添加文件。您可以为整个项目拥有一个资源文件，或者每个 ASP.NET MVC 区域拥有一个资源文件，或者您认为合适的资源文件，但您不需要超过 1 个。

App_GlobalResources

```
MyResources.resx        (Neutral / Default language translated texts)
MyResources.en-GB.resx
MyResources.de-DE.resx 
```

在 MyResources.resx

```
Name    Value
TextID  Some text which will be localized to the end user. 
```

在 Global.asax.cs ( `Application_PreRequestHandlerExecute`)

```
// Set it according to cookies/Session etc.
System.Threading.Thread.CurrentThread.CurrentUICulture = "de-DE"; 
System.Threading.Thread.CurrentThread.CurrentCulture = "de-DE"; 
```

然后在 Views 和 PartialViews（例如 MyView.cshtml）中。

```
<span>@Resources.MyResources.TextID</span> 
```

**可选的：**

资源可以作为链接添加，并使用自定义命名空间。

```
BuildAction:           Embedded Resource
CopyToOutputDirectory: Copy always
CustomTool:            PublicResXFileCodeGenerator
CustomToolNamespace:   MyNamespaceHere 
```

mToolNamespace: MyNamespaceHere

然后他们将可以通过访问。

```
<span>@MyNamespaceHere.MyResources.TextID</span> 
```

这是在 ASP.NET MVC 中使用（普通/链接）资源的一般方式。如果您使用“添加为链接”，您可以在单独的项目中拥有一个物理副本。

**卫星：**

有关卫星程序集的一些信息：

[MSDN：创建附属程序集](http://msdn.microsoft.com/en-us/library/21a15yht%28v=VS.100%29.aspx)

[MSDN 博客：卫星程序集简介](http://blogs.msdn.com/b/global_developer/archive/2011/07/22/introduction-to-satellite-assemblies.aspx)

# php - PHP Regex 帮助 - 对如何构建这个非常困惑

> ID：13516747
> 
> 赞同：0
> 
> 时间：2012-11-22T16:25:48.960
> 
> 标签：php, regex

我有一个字符串列表（数字是字符串中不包含的行号！）

```
1\. 2-1-44-1 WORD
2\. 02-00-1030-1 WORD2
3\. EKFOK (GI (I  I((II( 
4\. 100-01-1-100 WORD3
5\. 01 / 1-1-2-4 WORD4
6\. 401 / 100-230-3-3 WORD5
.
.
. 
```

我希望能够从具有以下结构的列表中仅选择第 1、2、4、5 和 6 行：

```
{STRING[NUM] / }STRING[NUM]-STRING[NUM]-STRING[NUM]-STRING[NUM] STRING[A-Z-NUM] 
```

其中 {STRING[NUM] / } 是可选的。

所以我写：

```
if(preg_match("[0-9]-[0-9]-[0-9]-[0-9] [a-zA-Z0-9]", $line))
    echo $line . '<br>'; 
```

但它说未知修饰符`-`。我试图逃避，`-`但它仍然给我带来了问题。

我正在考虑使用我的表达方式：

```
"[0-9]-[0-9]-[0-9]-[0-9] [a-zA-Z0-9]" 
```

然后 OR 得到可选的前面部分：

```
([0-9] / [0-9]-[0-9]-[0-9]-[0-9] [a-zA-Z0-9])|([0-9]-[0-9]-[0-9]-[0-9] [a-zA-Z0-9]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:29:00.457

你很接近它应该是

```
if(preg_match('/\d+-\d+-\d+-\d+\s+[a-zA-Z\d]+/', $line)) 
```

`\d`类似于`[0-9]`

`+`表示匹配 1 到多个字符

`\s+`表示匹配 1 到多个空间

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T18:00:06.327

我从@kuya_John 获取了正则表达式，然后修改为返回一个包含**所有**匹配项的数组（也是可选部分）。

```
$p="#((\d+\s+/\s+|)(\d+(-\d+){3}\s[a-zA-Z\d]+\n)|.*\n)#ismU";
$b=file_get_contents('text_to_parse.txt');
preg_match_all($p,$b,$m));

//var_dump($m);
echo "line 1,6 \"full\" match\n";
echo "1: ".trim($m[0][0])."\n";
echo "2: ".trim($m[0][1])."\n";
echo "4: ".trim($m[0][3])."\n";
echo "5: ".trim($m[0][4])."\n";
echo "6: ".trim($m[0][5])."\n";

echo "line 5,6 \"base\" part\n";
echo "5: ".trim($m[3][4])."\n";
echo "6: ".trim($m[3][5])."\n";

echo "line 5,6 \"optional\" part\n";
echo "5: ".trim($m[2][4])."\n";
echo "6: ".trim($m[2][5])."\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:30:07.760

试试这个模式

```
[0-9]+(-[0-9]+){3}\s[a-zA-Z0-9]+ 
```

或者

```
\d+(-\d+){3}\s[a-zA-Z\d]+ 
```

![在此处输入图像描述](../Images/3f47f9744e013f77d9a1115166c42c5d.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T16:47:49.857

尝试这个

```
^(\d+ / )?\d+-\d+-\d+-\d+ \w+$ 
```

# jquery - 使用 jPlayer 创建自定义音频播放器

> ID：13516750
> 
> 赞同：0
> 
> 时间：2012-11-22T16:26:00.300
> 
> 标签：jquery, audio, media-player, html5-audio, jplayer

在[这篇](http://www.karolodesign.com/blog/developer/177-jplayer-how-to-use-jplayer-to-build-your-own-mp3-player.html)文章之后，我正在尝试使用[jPlayer](http://jplayer.org/)创建一个简单的自定义音频播放器。

这是 HTML 代码

```
<div id="audio-player">
    <div id="track-info">

    </div>
    <div id="player-buttons">
        <div id="player">
            <div id="playButton" class="button">
                <img id="play-button" src="images/bage-playing.png" />
            </div>
            <div id="pauseButton" class="button">
                <img id="pause-button" src="images/bage-paused.png" />
            </div>
            <div id="stopButton" class="button">
                <img id="stop-button" src="images/bage-busy.png" />
            </div>
        </div>
    </div>
</div><!-- end of audio-player --> 
```

它看起来像这样。

![在此处输入图像描述](../Images/33227a0e69f8c8667b4b027726c5f05b.png)

我将以下脚本放在一个单独的 JS 文件中，并将其与 jPlayer 的 JS 文件一起添加到 HTML 页面的头部。

我的问题是当我运行页面时，按钮消失了！我完全不知道是什么原因造成的。

如果有人以前遇到过类似的情况，或者您有任何建议让这个工作正常进行，我会全力以赴。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:45:23.330

如果没有示例 URL，就无法确定这里发生了什么，但需要牢记以下几点：

使用 JPlayer 时，一旦您使用 API 的 'cssSelectors' 属性“绑定”了控件，它将使用 Javascript DOM 方法并通过将内联 CSS 应用于 DOM 项来操作这些控件本身。

首先，值得知道 JPlayer 会在适当的时候一次隐藏一个播放和暂停按钮。例如，当曲目正在播放时，它会隐藏播放按钮，而当曲目暂停时，它将隐藏播放按钮 - 这可能是您的一些问题的原因。

更可能的问题是您有按钮的 div 容器，并且正在指定它们，然后 jPlayer 正在清除它们的内容。如果您更改按钮 div 中的图像，并在 div 上使用背景和指定大小，我怀疑您的代码将起作用。

您的代码如下所示：

```
<div id="audio-player">
    <div id="track-info">

    </div>
    <div id="player-buttons">
        <div id="player">
            <div id="playButton" class="button">
                <img id="play-button" src="images/bage-playing.png" />
            </div>
            <div id="pauseButton" class="button">
                <img id="pause-button" src="images/bage-paused.png" />
            </div>
            <div id="stopButton" class="button">
                <img id="stop-button" src="images/bage-busy.png" />
            </div>
        </div>
    </div>
</div> 
```

我将其更改为：

```
<div id="audio-player">
    <div id="track-info">

    </div>
    <div id="player-buttons">
        <div id="player">
            <div id="playButton" class="button">
            </div>
            <div id="pauseButton" class="button">
            </div>
            <div id="stopButton" class="button">
            </div>
        </div>
    </div>
</div> 
```

然后添加一些像这样的 css 来恢复图像：

```
#playButton {
    background: transparent url('images/bage-playing.png') no-repeat;
    height: 20px; /* Correct this size ;-) */
    width: 20px; /* Also correct this size ;-) */
} 
```

然后对每个按钮执行相同的操作，我希望您的代码能够正常工作。如果没有，请发回您正在做的演示的 URL，我会仔细查看。

欧文

**附录：**

现在您已经发布了代码，我可以看到两个问题，希望在您修复它们时使其正常工作：

首先，您在 javascript 中选择元素而不是 ID。在您拥有“cssSelector”对象的地方，您使用的字符串说：

```
cssSelector: { 
        play: 'playButton',
        pause: 'pauseButton',
        stop: 'stopButton'
    }, 
```

当他们应该说：

```
cssSelector: { 
    play: '#playButton',
    pause: '#pauseButton',
    stop: '#stopButton'
}, 
```

您的版本将按名称而不是 ID 选择元素，例如 not 。我猜这是因为您习惯使用 document.getElementById，或者 mooTools。

除此之外，您在 JPlayer 设置中的“就绪”调用缺少一个功能。它看起来像这样：

```
ready: jQuery(this).jPlayer("setMedia", { 
                mp3: 'http://www.karolodesign.com/media/music/bass-walker.mp3'
            }); 
```

应该是这样的：

```
ready: function() { // This bit!
            jQuery(this).jPlayer("setMedia", { 
                mp3: 'http://www.karolodesign.com/media/music/bass-walker.mp3'
            });
       } 
```

这是我的错，因为我在网站上的原始示例实际上是错误的！我会马上纠正。

解决这两个问题，应该没问题。JQuery 抛出错误，但我认为这只是因为缺少函数。如果它不起作用，请告诉我，我再看看。

欧文

# java - 将 OpenGL 与 Akka Actor 一起使用：保证单个线程用于特定的 Actor

> ID：13516752
> 
> 赞同：4
> 
> 时间：2012-11-22T16:26:01.327
> 
> 标签：java, multithreading, scala, opengl, akka

我有一个使用 Akka 框架的 Scala/Java OpenGL 应用程序。目前，我的 OpenGL 线程独立于 Actor 系统，因此我可以保证对 OpenGL 函数的调用始终来自单个线程。这很重要，否则 OpenGL 会报错。

到现在为止，我必须从 OpenGL 线程向系统中的参与者发送消息，这工作得很好。我现在需要以相反的方式发送消息，但当然我不能简单地将 OpenGL 放在一个 actor 中，因为这会打破它从单个线程运行的要求。

另一种方法是手动使用队列和锁来进行actor和OpenGL线程之间的通信，但我想知道是否有办法将OpenGL调用放在一个特殊的Actor中，Akka会保证在单个线程中运行。

问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T17:13:12.273

您可以使用`PinnedDispatcher`. 根据文档：

> 这个调度器为每个使用它的actor指定一个唯一的线程；即每个参与者将有自己的线程池，池中只有一个线程。

# javascript - 如何检查tinymce编辑器是否为空并且forced_root_block选项设置为div

> ID：13516753
> 
> 赞同：4
> 
> 时间：2012-11-22T16:26:01.570
> 
> 标签：javascript, jquery, tinymce, html-editor

如何检查tinymce 是否有空内容？我正在测试它：

[http://jsfiddle.net/Jjw2U/](http://jsfiddle.net/Jjw2U/)

Tinymce 编辑器没有返回空字符串，因为它默认设置了一个空标签

```
 <div>&nbsp;</div> 
```

它放置了空的 div 行，因为我将forced_root_block 选项设置为'div'，但我不想更改forced_root_block。

我尝试使用正则表达式

```
 editorContent.replace("/(<div>&nbsp;</div>)+/gi"," "); 
    editorContent = editorContent.replace(/^\s+|\s+$/g,""); 
```

但它不起作用。我错了正则表达式？

我能怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:37:46.400

只需将其添加到您的测试中：

```
if (editorContent == '' || editorContent == null || editorContent == '<div>&nbsp;</div>') 
```

这不是严格意义上的空内容，但它表明用户没有对 textarea 进行任何有意义的更改，这是我假设您想知道的。

# actionscript-3 - 删除特定组件的过滤器

> ID：13516757
> 
> 赞同：0
> 
> 时间：2012-11-22T16:26:11.487
> 
> 标签：actionscript-3, apache-flex

我有一个包含很多组件的组。

我对这个组应用了一个过滤器。

但我想从其中一个组件中移除过滤器。

如果我只是设置`componentIWantToRemoveFilter.filters = null`它不起作用，因为过滤器应用于父组件。

有一些方法可以删除过滤器，而不将其应用于每个组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:21:24.553

并非如此，如果您对 应用过滤器`DisplayObjectContainer`，则其所有子代都会受到影响，因为它们是其外观的一部分（这与为其所有子代分配相同的过滤器不同）。

因此，您可以尝试以下方法之一：

1.  将过滤器分配给每个组件而不是组（如果这给出了您想要的结果并且不会对性能造成太大影响）并在您需要时取消
2.  创建 2 个组，一组带过滤器，一组不带过滤器。如果您经常需要添加/删除过滤器，只需使用`removeChild()`/`addChild()`将您的组件从一组移动到另一组

# python - 破坏不破坏

> ID：13516760
> 
> 赞同：2
> 
> 时间：2012-11-22T16:26:16.787
> 
> 标签：python, tkinter

我不明白破坏的工作方式......

我有一个类 SubWindow，它是 Tk.Toplevel 的子类如果这个子窗口有一个内部小部件

> self.label = Tk.Label(master=self, text='这是子窗口：%s!!!!'%self)

当我销毁子窗口时，它不会死，它仍然活着（我知道这看着子窗口数组）

销毁子窗口的唯一方法是调用

> 删除自我标签

在销毁方法中。

```
import Tkinter as Tk
import weakref

root = Tk.Tk()
subwindows = []

def subwindow():
    subwindows.append(weakref.ref(SubWindow(root)))

def list_subwindows():
    print 'Subwindows: ',
    for subwindow in subwindows:
        sw = subwindow()
        if sw:
            print sw,
    print ''

class SubWindow(Tk.Toplevel):
    def __init__(self, window):
        Tk.Toplevel.__init__(self, master = window)
        self.label = Tk.Label(master=self, text='This is Sub Window: %s!!!!'%self)
        self.label.pack()
#        self.bind('<Destroy>', self._destroy)

    def _destroy(self, event):
        try:
            del self.label 
        except:
            pass

bStartWindow = Tk.Button(master=root, text='Start Sub Window', 
                         command=subwindow)
bStartWindow.pack()

bListSubwindows = Tk.Button(master=root, text='List Active subwindows',
                            command = list_subwindows)
bListSubwindows.pack()

root.mainloop() 
```

为什么子窗口有内部小部件时不会被销毁？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T19:12:47.600

由于 Tkinter 的实现方式，像顶层这样的小部件实际上是两个对象。它是 python 类的一个实例，在某种意义上它也是一个对象，因为它是底层 Tk 库可以理解的东西。

我没有仔细看，但我怀疑窗口的默认绑定是销毁小部件而不是销毁 python 类实例。因此，顶级小部件被销毁，但实例`Subwindow`不会立即被销毁。或者更准确地说，它已被销毁但尚未被垃圾收集。

当一个小部件被它销毁时，它的所有子小部件也被销毁。我不太确定您为什么认为标签没有被破坏，因为我没有看到任何实际检查标签小部件的代码。为什么你认为标签没有被销毁？

您所看到的只是垃圾收集器没有运行的证据。小部件已被销毁，但 Tkinter 包装器仍然存在。

修改`list_windows`为强制垃圾回收，你会看到对象真的被销毁了：

```
def list_subwindows():
    import gc
    gc.collect()
    print 'Subwindows: ',
    for subwindow in subwindows:
        sw = subwindow()
        if sw:
            print sw,
    print '' 
```

# android - 在 NDK 构建中包含 libjpeg

> ID：13516762
> 
> 赞同：1
> 
> 时间：2012-11-22T16:26:27.320
> 
> 标签：android, android-ndk, libjpeg

正如[这个答案](https://stackoverflow.com/questions/12294709/how-to-build-libjpeg-for-ndk-use)中所指定的，我从 github 下载了 libjpeg 8d 并将其放在一个文件夹`{ANDROID_APP}/jni/libjpeg`中。这个库有它自己的`Android.mk`，所以我试图在我的最后包含它`{ANDROID_APP}/jni/Android.mk`：

`include $(LOCAL_PATH)/libjpeg/Android.mk`

注意：我使用的是最新版本的 android NDK (r8c)

运行 ndk-build 后，我仍然收到此错误：

`ANDROID_APP/jni/libfoo/foo_analysis.c:36:21: fatal error: jpeglib.h: No such file or directory`

这是我的全局结构`Android.mk`：

```
LOCAL_PATH := $(call my-dir)

# libFoo
include $(CLEAR_VARS) 

LOCAL_MODULE := libfoo
LOCAL_MODULE_FILENAME := libfoo
LOCAL_SRC_FILES := libfoo/foo.c libfoo/foo_analysis.c libfoo/foo_extract.c

LOCAL_STATIC_LIBRARIES := libbmp # declared previously but not shown in this example

LOCAL_CFLAGS   = ${FLAGS}
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/libfoo
LOCAL_EXPORT_LDLIBS := -llog

include $(BUILD_STATIC_LIBRARY)

# libBar
include $(CLEAR_VARS)

LOCAL_MODULE := libbar
LOCAL_MODULE_FILENAME := libbar
LOCAL_SRC_FILES := bar/bar.c

LOCAL_STATIC_LIBRARIES := libfoo

LOCAL_CFLAGS   = ${FLAGS}
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/bar
LOCAL_EXPORT_LDLIBS := -llog

include $(BUILD_STATIC_LIBRARY)

# callbar
LOCAL_MODULE := libcallbar
LOCAL_MODULE_FILENAME := libcallbar
LOCAL_SRC_FILES := com_androidapp_nativeC_callbar.c

LOCAL_STATIC_LIBRARIES := libbar

LOCAL_CFLAGS   = ${FLAGS}

include $(BUILD_SHARED_LIBRARY)

#libjpeg
include $(LOCAL_PATH)/libjpeg/Android.mk 
```

我尝试在 libFoo 模块中使用`LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/libfoo $(LOCAL_PATH)/libjpeg` and `LOCAL_C_INCLUDES := $(LOCAL_PATH)/libjpeg`，但仍然遇到相同的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T18:46:57.657

刚刚查看 jpeg8d-master 文件夹中的 Android.mk ，似乎它什么都没有。

我试图根据 STANDALONE-TOOLCHAIN.HTML 直接编译库

我下一步要做： $export NDKROOT=/home/alex/tools/android-ndk-r8c （你的 NDK 在哪里） $export SYSROOT=$NDKROOT/platforms/android-9/arch-arm （或任何其他 android 平台）

但是来自 jpeg8d-master 的文件有 windows \r 符号，我删除了 config.guess、config.sub、depcomp 而不是使用 $automake -a 命令。并从 glib-2.34.0 替换 ltmain.sh

比 $./configure CC="$NDKROOT/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86/bin/arm-linux-androideabi-gcc --sysroot=$SYSROOT" --host=arm -linux-androideabi $make

下一步尝试预建功能[NDK - 如何在另一个项目](https://stackoverflow.com/questions/5669220/ndk-how-to-use-a-generated-so-library-in-another-project)和 NDK/PREBUILTS.HTML中使用生成的 .so 库

# jquery - 将post中的wordpress变量传递给jquery

> ID：13516763
> 
> 赞同：0
> 
> 时间：2012-11-22T16:26:32.737
> 
> 标签：jquery, wordpress

我有一个 jQuery 函数，我在其中获取 10 张图像，并通过单击颜色选择器图表上的颜色来加载每张图像。

[jsfiddle 在这里由 TNCodeMonkey 提供](http://jsfiddle.net/TNCodeMonkey/M9ysa/3/)

我需要集成它，以便它出现在选定的 Wordpress 帖子中。我在我的 functions.php 文件中正确地加入并加载了最新版本的 jQuery。

我想在帖子中将这些图像列为短代码，如下所示：

```
[picker1img]/images/image1.jpg[/picker1img]
[picker2img]/images/image1.jpg[/picker2img]
[picker3img]/images/image1.jpg[/picker3img]
etc 
```

然后过滤帖子，以便我的 jQuery 脚本将这些图像路径传递给它。

更新说明：帖子中还有其他图片，但我只想在简码中传递这些图片。我不受任何特定的简码语法的约束。

我需要知道连接到帖子并获取这些图像变量的最佳方法，然后在帖子循环中显示我的代码。

我还需要知道是否可以将其作为插件而不是在functions.php 中加载。

提前致谢。

# java - 限制执行第三方软件的线程的权限

> ID：13516766
> 
> 赞同：5
> 
> 时间：2012-11-22T16:26:37.023
> 
> 标签：java, multithreading, permissions, eclipse-rcp, rcp

我正在开发一个能够执行第三方组件（不是 eclipse-plugin）的基于 Eclipse 的应用程序。

每个组件都有一个列出权限的自定义描述符（具有相应的动机）。通过这种方式，最终用户可以决定是否执行它。

组件在单独的线程中执行。如何根据描述符限制这些线程的权限，而不限制整个应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T00:08:55.163

首先，您应该打开安全管理器。然后创建一个具有所需权限的[AccessControlContext 。](http://docs.oracle.com/javase/6/docs/api/java/security/AccessControlContext.html)[（在我的示例中没有权限。）最后在AccessController.doPrivileged(...)](http://docs.oracle.com/javase/6/docs/api/java/security/AccessController.html#doPrivileged%28java.security.PrivilegedAction,%20java.security.AccessControlContext%29)方法中执行第三方代码。

这是一个非常简单的解决方案：

```
public abstract class SafeRunnable implements Runnable {

public abstract void protectedRun();

@Override
public final void run() {
    CodeSource nullSource = new CodeSource(null, (CodeSigner[]) null);
    PermissionCollection noPerms = new Permissions();
    ProtectionDomain domain = new ProtectionDomain(nullSource, noPerms);
    AccessControlContext safeContext = new AccessControlContext(
            new ProtectionDomain[] { domain });

    AccessController.doPrivileged(new PrivilegedAction() {
        public Object run() {
            protectedRun();
            return null;
        }
    }, safeContext);
}
} 
```

测试 SafeRunnable：

```
public static void main(String args[]) throws Exception {
    // Turn on the security management
    SecurityManager sm = new SecurityManager();
    System.setSecurityManager(sm);

    new Thread(new SafeRunnable() {
        public void protectedRun() {
            // friendly operation:
            System.out.println("Hello");
        }
    }).start();

    new Thread(new SafeRunnable() {
        public void protectedRun() {
            // malicious operation
            System.exit(0);
        }
    }).start();
} 
```

第一个线程打印 Hello，第二个线程抛出`AccessControlException: access denied ("java.lang.RuntimePermission" "exitVM.0")`

# drop-down-menu - 带有切换箭头的 jQuery 切换下拉菜单

> ID：13516767
> 
> 赞同：0
> 
> 时间：2012-11-22T16:26:38.167
> 
> 标签：drop-down-menu, jquery

我正在尝试做一个带有下拉菜单的垂直菜单，可以通过箭头切换激活，同时仍然保持顶级链接处于活动状态和可点击状态。我正在使用自定义 CMS，因此我对如何使这项工作有一些限制。

**HTML**

```
<ul class="topnav">
    <li class="tn_first">
        <span></span><a class="topmenu" href="/default.asp">Home</a>
    </li>
    <li class="tn_mid">
        <span></span><a class="topmenu" href="/listings.asp">My Listings</a>
        <ul class="subnav">
            <li class="sn_first">
                <a class="submenu" href="#">Listing 1</a>
            </li>
            <li class="sn_mid">
                <a class="submenu" href="#">Listing 2</a>
            </li>
            <li class="sn_last">
                <a class="submenu" href="#">Listing 3</a>
            </li>
        </ul>
    </li>   
    <li class="tn_last">
        <span></span><a class="topmenu" href="/links.asp">System Pages</a>
        <ul class="subnav">
            <li class="sn_first">
                <a class="submenu" href="#">Page 1</a>
            </li>
            <li class="sn_mid">
                <a class="submenu" href="#">Page 2</a>
            </li>
            <li class="sn_last">
                <a class="submenu" href="#">Page 3</a>
            </li>
        </ul>
    </li>               
</ul> 
```

所以我有一个非常简单的 UL LI 菜单系统。我在顶层导航的模板中添加了一个 span 标签，我想将其用作切换开关。跨度可以更改为任何内容，这正是我目前所拥有的。

我遇到的问题是，鉴于这是一个模板系统，我可以选择将跨度放入，但不能根据 ul.subnav 是否存在于同一个 li 中有条件地显示它。因此，我需要某种方式将 display:block 应用于实际满足此条件的那些，然后我将默认 display:none 其他跨度。

我尝试使用此解决方案，它确实有效，但它不适用于多个下拉菜单，它似乎只有在您的菜单结构中有一个下拉菜单实例时才有效。

[jQuery 切换下拉菜单](https://stackoverflow.com/questions/9761648/jquery-toggle-dropdown-menu) 和 [http://jsfiddle.net/hXNnD/1/](http://jsfiddle.net/hXNnD/1/)

**Javascript**

```
jQuery(document).ready(function () {

var subMenu = jQuery("li ul li");
var linkClick = jQuery("ul li").filter(":has(ul)");

subMenu.hide();

linkClick.click(function (e) {
    e.preventDefault();
    subMenu.slideToggle("fast");
});
}); 
```

我创建了另一个具有 2 个子 UL 的示例，因此您可以看到代码在哪里下降。

[http://jsfiddle.net/BxsEX/](http://jsfiddle.net/BxsEX/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:50:36.760

使用 CSS 隐藏您的跨度并执行以下操作：`$('.topnav li:has(ul) span').show();`

[http://jsbin.com/ujoqek/1/edit](http://jsbin.com/ujoqek/1/edit)

CSS：

```
.topnav li span{ display:none; } 
```

问：

```
var arrow = ['&#9660;','&#9650;'];

$('.topnav li:has(ul) span').show().html( arrow[0] ).data('a',0);
$('.topnav li > ul').hide();

$('.topnav span').click(function(){
  $(this).closest('li').find('ul').slideToggle();
  var arrw = $(this).data('a');
  $(this).html( arrow[++arrw%2] ).data('a', arrw); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:47:16.160

我想这就是你想要的。我可能错了。

```
$('li').each(function(){ 
    //if we can find a UL with the class of subnav within our LI
    if($(this).find('ul.subnav').length){ 
        //find the span within this LI and give it a display block
        $(this).find('span').css('display', 'block')
    }else{
        //otherwise, hide the span.
        $(this).find('span').css('display', 'none')
    }
}); 
```

# cucumber - 如何确保 Cucumber 不打印跳过的步骤？

> ID：13516777
> 
> 赞同：0
> 
> 时间：2012-11-22T16:27:10.423
> 
> 标签：cucumber

我有一个很长的 Cucumber 场景，只实现了几个步骤，还有很多步骤正在等待中。在我的设置中，Cucumber 会跳过所有待处理的步骤，但仍会在输出中打印那些跳过的测试的所有名称，这使得向上滚动以查找场景失败的步骤变得乏味。

如何确保跳​​过的步骤未打印在输出中？理想情况下，我希望输出显示所有通过的步骤和最后失败的步骤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:41:25.833

我认为没有开箱即用的格式化程序可以做到这一点。您需要创建一个自定义的，但也许您可以使用`progress`格式化程序。它打印有关失败步骤的信息，通过步骤的绿点和跳过的步骤的破折号：

```
>> cucumber --format progress

..............................F-

(::) failed steps (::)
"Error messages here"

Failing Scenarios:
cucumber features/dashboard.feature:13 # Scenario: Dashboard data is loaded

4 scenarios (1 failed, 3 passed)
26 steps (1 failed, 1 skipped, 24 passed)
0m41.604s 
```

您也可以组合不同的格式化程序。一个在控制台中给出它的输出，另一个在不同的文件中输出它的格式以供以后检查。例如：

```
$ cucumber -f progress -f pretty --out results.txt -f rerun --out rerun.txt 
```

# doctrine-orm - 如何进行 Doctrine2 计算字段排序

> ID：13516784
> 
> 赞同：1
> 
> 时间：2012-11-22T16:27:37.757
> 
> 标签：doctrine-orm

我的以下教条2 查询运行良好，它检索某个地理半径内的所有“标记”。

```
 $qb->select('marker')
        ->from('SndSpecialistLocator\Entity\Marker', 'marker')
        ->where('DISTANCE(marker.location, POINT_STR(:point)) < :distance')
        ->setParameter('point', $point)
        ->setParameter('distance', $radius); 
```

现在我想按距离对它们进行排序。

```
 $qb->select('marker (DISTANCE(marker.location, POINT_STR(:point))) AS distance')
        ->from('SndSpecialistLocator\Entity\Marker', 'marker')
        ->where('DISTANCE(marker.location, POINT_STR(:point)) < :distance')
        ->setParameter('point', $point)
        ->orderBy('distance', 'DESC')
        ->setParameter('distance', $radius); 
```

但不幸的是，这不起作用，我想知道这是否可能，因为距离不是我实体的真实属性，而是计算出来的？

这里的诀窍是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-23T18:07:01.123

或者，尝试在调用 select() 时使用 HIDDEN ：

```
$qb->select('m as marker, (DISTANCE(m.location, POINT_STR(:point))) as HIDDEN distance')
// note HIDDEN added here --->------->------->------->------->------->---^
    ->from('SndSpecialistLocator\Entity\Marker', 'm')
    ->where('DISTANCE(m.location, POINT_STR(:point)) < :distance')
    ->setParameter('point', $point)
    ->orderBy('distance', 'ASC')
    ->setParameter('distance', $radius)
    ->setMaxResults(5);

$query = $qb->getQuery();
$result = $query->execute(); 
```

将 HIDDEN 添加到 SELECT 子句会在结果中隐藏它，但允许在 orderby 子句中使用它。然后，您的 $result 应该包含您想要的对象，而无需执行额外的 array_walk。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:33:12.393

不幸的是，不能按别名排序。您可以做的 * 是在 orderBy 语句中手动重复该功能：

```
$qb->select('marker (DISTANCE(marker.location, POINT_STR(:point))) AS distance')
    ->from('SndSpecialistLocator\Entity\Marker', 'marker')
    ->where('DISTANCE(marker.location, POINT_STR(:point)) < :distance')
    ->setParameter('point', $point)
    ->orderBy('DISTANCE(marker.location, POINT_STR(:point))', 'DESC')
    ->setParameter('distance', $radius); 
```

**我们可能都会因为走下 DRY 的神圣之路而落入开发者地狱*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T15:26:11.507

找到了解决方案。

```
 $qb->select('m as marker, (DISTANCE(m.location, POINT_STR(:point))) as distance')
        ->from('SndSpecialistLocator\Entity\Marker', 'm')
        ->where('DISTANCE(m.location, POINT_STR(:point)) < :distance')
        ->setParameter('point', $point)
        ->orderBy('distance', 'ASC')
        ->setParameter('distance', $radius)
        ->setMaxResults(5);

    $query = $qb->getQuery();
    $result = $query->execute();

    /**
     * Convert the resulting associative array into one containing only the entity objects
     *
     * array (size=5)
     *   0 =>
     *     array (size=2)
     *       'marker' =>
     *         object(SndSpecialistLocator\Entity\Marker)[647]
     *           protected 'id' => int 43
     *           protected 'title' => string 'c5d07acdd47efbe38a6d0bf4ec64f333' (length=32)
     *           private 'location' =>
     *             object(SndSpecialistLocator\Orm\Point)[636]
     *                private 'lat' => float 52.2897
     *                private 'lng' => float 4.84268
     *       'distance' => string '0.0760756823433058' (length=18)
     *   1 => ...
     *
     * array (size=5)
     *   0 =>
     *     object(SndSpecialistLocator\Entity\Marker)[647]
     *       protected 'id' => int 43
     *       protected 'title' => string 'c5d07acdd47efbe38a6d0bf4ec64f333' (length=32)
     *       private 'location' =>
     *         object(SndSpecialistLocator\Orm\Point)[636]
     *           private 'lat' => float 52.2897
     *           private 'lng' => float 4.84268
     *   1 => ...
     *
     */
    array_walk($result, function (&$item, $key)
    {
        $item = $item['marker'];
    }); 
```

# .htaccess - 强制 www。对于除某些目录之外的所有 url，通过 htaccess

> ID：13516785
> 
> 赞同：1
> 
> 时间：2012-11-22T16:27:41.780
> 
> 标签：.htaccess

在我的 htaccess 中，我使用此代码将所有非 www 请求重定向到 www，除了一个删除 www 的目录和 httpS（如果强制）。

```
RewriteCond $1 !^example1
RewriteCond %{HTTP_HOST} !^www.example.com$ [NC] 
RewriteRule ^(.*)$ http://www.example.com/$1 [L,R=301]
RewriteCond %{HTTPS} =off [NC]
RewriteCond %{REQUEST_URI} ^/example1/(.*) [NC]
RewriteRule ^(.*)$ https://example.com/example1/%1 [R=301,L] 
```

我的问题是当我想添加更多异常时，例如 example2。我该怎么做呢？

此外，如果异常目录比 www.example.com/dir/example3 低一级，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:36:45.207

好吧，有两种选择：

1.  您必须指定正则表达式而不是文字字符串，并且该正则表达式必须匹配所有异常。

2.  你使用重写地图。我建议你看一下文档。

* * *

使用正则表达式：

```
# some expections
RewriteCond %{HTTPS} =off [NC]
RewriteCond %{REQUEST_URI} ^/(example[0-9]+.*)$ [NC]
RewriteRule ^(.*)$ https://example.com/%1 [R=301,L]

# the default rule: => add "www."
RewriteCond %{HTTP_HOST} !^www.example.com$ [NC] 
RewriteRule ^(.*)$ http://www.example.com/$1 [L,R=301] 
```

我扭转了局面，在开始时有异常，最后是“全部捕获”默认值。显然，您可以通过将第一行加倍来添加更多例外。或者通过更改正则表达式。请注意，显然所需的正则表达式的详细信息取决于您拥有的异常集合。只有你知道......我建议你阅读优秀的[手册](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)。

* * *

除了更复杂的正则表达式，您还可以在条件块内使用逻辑运算符：

```
# some expections
RewriteCond %{HTTPS} =off [NC]
RewriteCond %{REQUEST_URI} ^/(example1.*)$ [NC,OR]
RewriteCond %{REQUEST_URI} ^/(example2.*)$ [NC]
RewriteRule ^(.*)$ https://example.com/%1 [R=301,L]

# the default rule: => add "www."
RewriteCond %{HTTP_HOST} !^www.example.com$ [NC] 
RewriteRule ^(.*)$ http://www.example.com/$1 [L,R=301] 
```

* * *

在谈到重写时，有两件*重要的*事情不能经常重复：

1.  阅读手册！它非常好，带有精确的描述和很好的例子。

2.  如果您有权访问主服务器配置，则使用 REWRITE DEBUGGING：重写模块为此定义了两个`RewriteLog`命令`RewriteLogLevel`。配置一些日志文件和级别可能为 7。然后发出一个*请求*并监视日志文件中的新条目（使用`tail -f /path/to/logfile`）。这有助于了解重写引擎内部发生了什么以及意外事情开始发生的地方。

# javascript - javascript：获取解释器中返回的最后一个值的方法

> ID：13516788
> 
> 赞同：0
> 
> 时间：2012-11-22T16:27:45.530
> 
> 标签：javascript, interpreter

我试图找到一种以编程方式获取 Javascript 解释器返回的最后一个值的方法。举个例子，Ruby 的解释器有“_”：

```
1 + 2 #=> 3
_ #=> 3 
```

我想知道Javascript中是否存在相同的东西。

编辑：

另一种可能实现这一目标的方法。是否有任何语法支持在换行符中延续表达式？像这样的东西：

```
var a = \&
    1 + 2;
a #=> 3 
```

某种字符组合告诉解释器表达式在换行符中继续（例如用于字符串连接的 +）。

目的：

这项研究的目的是确定我是否可以使用脚本标记加载 JSON 数据结构并从其范围之外成功分配它，如下所示：

```
<script> var json_struct = </script>
<script src="http://domain.com/myjsonfile.json" type='application/json' ></script> 
```

顺便说一句，这是行不通的。令人惊讶:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T15:06:08.657

> 目的：
> 
> 这项研究的目的是找出我是否可以使用脚本标签加载 JSON 数据结构并从其范围之外成功分配它

基于浏览器的 javascript 中没有可以做到这一点的构造。

原因是，从最早的 Netscape 时代开始，浏览器总是在关闭 script 标签时启动脚本编译器。无论是 javascript、VBscript（仅限 IE）还是 Tcl（使用适当的插件）。

这意味着任何不完整的语句都将被简单地视为语法错误。每个`<script>`标签基本上都被视为一个文件。

您正在尝试做的事情与 Ruby 中的类似：

```
a = require 'one_plus_two.rb' 
```

我认为这在 Ruby 中不起作用。

* * *

但是，在支持 Node.js 等模块的非浏览器环境中，导入模块的方法实际上会返回一个值（通常是一个对象）。所以你可以在 node.js 中做这样的事情：

```
var a = require('my_data_file.js'); 
```

不幸的是，该`require`功能仅适用于本地文件。但是 Node.js 是开源的，所以你可以随时 fork 和修改它，`require`以便能够`http://`像 PHP 一样获取源代码。

唉，如果你想做的是浏览器脚本，那么上面的观点是没有意义的。

# sql - SQL 网络接口，错误：26 仅在解决方案重建时

> ID：13516789
> 
> 赞同：4
> 
> 时间：2012-11-22T16:27:52.880
> 
> 标签：sql, asp.net-mvc, authorization, roles

我有一个使用 MVC4 构建的站点，该站点从数据库中获取内容，并且一切正常。

如果我然后重建解决方案并尝试刷新页面以检查我的更改，我将始终得到 SQL 网络接口，错误：26 说我无法连接到服务器。

但是，如果我然后浏览到我的主页，然后返回到我正在查看的页面，它将正常工作。

有谁知道什么可能导致这个问题，因为它真的很烦人

**编辑**

除此之外，我发现在重建后加载 AuthorizationContext filterContext 时，它无法连接到数据库

**编辑 2**

与下面的尼尔一样，我发现只有在尝试访问已分配角色的页面时才会遇到问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-06T19:42:49.960

当我登录浏览器时，在重建应用程序时发生了这种情况。

删除 cookie 为我解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-23T12:43:09.100

我看到了完全相同的问题，可以将其追溯到浏览器中的 .ASPXAUTH 会话 cookie。删除该 cookie，数据库错误就会消失，直到下一次重建。

如果您通过身份验证，然后重新构建项目并尝试浏览以下任一页面，则该错误会定期发生：

*   需要身份验证
*   调用 User 对象（例如`@if (User.IsInRole("Administrators"))`）

如果您在 App_Start/FilterConfig.cs 中设置了 AuthorizeAttribute 过滤器，您将在每个页面上都看到它。

这似乎是最新补丁星期二更新后的新行为。以前，我看到奇怪的行为，我会保持登录状态，但我会失去我的滚动会员资格。在最近的补丁之后，似乎 Simple Membership 在收到错误的 .ASPXAUTH cookie 时会阻塞（由于重建而无效）。

我在 InitializeSimpleMembershipAttribute.cs 中有正确的连接字符串，但在这个实例中，就像简单成员默认为其他东西一样。

请注意，我已将 Simple Membership 数据库从原始 (localDb) 移动到成熟的（本地）SQL Server 实例。不知道为什么这很重要，并且在所有其他情况下都可以正常工作。

**更新：**

我还尝试使连接字符串名称与 EF 上下文名称（例如“ProjectContext”）相同，理论上它默认为标准约定，但这并没有什么区别。我在所有上下文类构造函数中明确识别连接字符串名称（使用`: base("connectionString")`语法），并且简单成员能够在所有其他时间找到正确的连接字符串。

**更新 2：**

*只有在访问受角色*保护的页面时重建后才会出现此问题。一个简单的`[Authorize]`不会触发它。你需要类似的东西`[Authorize(Role="Admin")]`。我已经在一个新的 MVC 4 项目上复制了这个，没有其他修改，使用默认的 (localDb) 数据库。清除 cookie，同一用户可以访问受保护的内容而不会出现任何问题。我相信这是一个核心 .NET 或 MVC 错误，需要这样报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-22T20:57:11.990

使用 SimpleMembership 时，任何使用角色都会出现此错误 - 不仅在控制器中，而且在我使用时也会出现：

如果（角色。IsUserInRole（角色名）{...

我迟到了这个答案，但我将 [InitializeSimpleMembership] 添加到我的家庭控制器中，我认为这解决了它。

# animation - 当我点击一个链接时，怎么会有一个downstate动画？

> ID：13516800
> 
> 赞同：1
> 
> 时间：2012-11-22T16:28:31.253
> 
> 标签：animation, jquery-plugins, click, hyperlink

我找到了这个很酷的插件[甜蜜菜单](http://www.adambecker.info/#playground)，当我单击链接时，我无法让easeoutbounce 动画停止。例如，当我单击主动画时，我希望有一个“下状态”，我希望看到动画（非常像鼠标悬停功能（但没有用鼠标离开返回。我希望有人可以帮助我，因为我我是所有这些代码的新手，我开始疯狂了：）提前感谢您的帮助！

这是脚本：

```
<script type="text/javascript" src="Widgets/sweetMenu/jquery.easing.js"></script>
<script type="text/javascript" src="Widgets/sweetMenu/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="Widgets/sweetMenu/jquery.sweet-menu-1.0.js"></script>
<script type="text/javascript" src="Widgets/sweetMenu/jquery.sweet-menu-min-1.0.js"></script>
<script type="text/javascript"> 

$(document).ready(function(){ 

$('#exampleMenu').sweetMenu({
    top: 200,
    padding: 8,
    iconSize: 48,
    easing: 'easeOutBounce',
    duration: 500,
    icons: [
    'widgets/sweetmenu/images/home.png',
    'widgets/sweetmenu/images/comments.png',
    'widgets/sweetmenu/images/red_heart.png',
    'widgets/sweetmenu/images/male_user.png',
    'widgets/sweetmenu/images/yellow_mail.png',
    'widgets/sweetmenu/images/computer.png'
                ]   
    });
    });
</script> 
```

这是CSS：

```
 .sweetMenuAnchor{
border-top: 1px solid #ffffff;
border-right: 1px solid #ffffff;
border-bottom: 1px solid #ffffff;
border-top-right-radius: 4px;
-moz-border-radius-topright: 4px;
border-bottom-right-radius: 4px;
-moz-border-radius-bottomright: 4px;
color: #0071bb;
font-size: 24px;
font-weight: bold;
text-align: right;
text-transform: uppercase;
font-family: Arial, Helvetica, sans-serif;
text-decoration: none;
background-color: #888888;
opacity: 0.6;
visibility: visible;
z-index: 999999;
        }

        .sweetMenuAnchor span{
display: block;
padding-top: 10px;
        }

        h1
        {
            display: block;
            text-align: center;
            font-size: 48px;
            color: #ffffff;
            text-shadow: 0px 0px 12px #000000;
            font-family: "Trebuchet MS";
        } 
```

最后是 HTML：

```
<ul id="exampleMenu">
        <li><a href="#">Home</a></li>
        <li><a href="#">Blog</a></li>
        <li><a href="#home">portfolio</a></li>
        <li><a href="#home">Hire Me</a></li>
        <li><a href="#home">Contact</a></li>
        <li><a href="#home">My Apps</a></li>
  </strike> 
```

# javascript - Apply modifier to more than one element of an object

> ID：13516816
> 
> 赞同：0
> 
> 时间：2012-11-22T16:29:19.777
> 
> 标签：javascript, mongodb

I have a document structure like this:

```
{
  _id: ...,
  name: ...,
  keywords: {
    group_a: [1, 2, 5],
    group_b: [4, 7, 6]
  }
} 
```

I know I can add elements to *one* of the elements of the `keywords` object like this:

```
db.coll.update({_id: ...}, {
  $addToSet: {
    'keywords.group_a': {
      $each: [9, 12, 17]
    }
  }
}) 
```

Is there a command I can run to add the same set of elements to `group_a` *and* `group_b`? Something like

```
db.coll.update({_id: ...}, {
  $addToSet: {
    ['keywords.group_a', 'keywords.group_b']: {
      $each: [9, 12, 17]
    }
  }
}) 
```

which of course isn't valid.

I know the names of the groups in advance, but an "add them to *all* elements" solution is equally fine.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:42:36.833

You can affect multiple fields with a single `$addToSet` operator like so:

```
db.coll.update({_id: ...}, {
  $addToSet: {
    'keywords.group_a': {
      $each: [9, 12, 17]
    },
    'keywords.group_b': {
      $each: [9, 12, 17]
    }
  }
}) 
```

To keep it DRY you can, of course, do:

```
var each = { $each: [9, 12, 17] };
db.coll.update({_id: ...}, {
  $addToSet: {
    'keywords.group_a': each,
    'keywords.group_b': each
    }
  }
}) 
```

# javascript - JavaScript Canvas 羽毛弧

> ID：13516818
> 
> 赞同：0
> 
> 时间：2012-11-22T16:29:28.633
> 
> 标签：javascript, html, canvas

我目前正在用画布标签绘制弧线，有人问我是否可以羽化（软化）弧线的边缘。这可能吗？在这里谷歌搜索和搜索似乎比它的价值更麻烦。

我也尝试过查看 mdn，但羽化元素的资源似乎很少。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T15:08:03.837

从您在评论中链接到的图像来看，您似乎正在尝试制作阴影。

如果是这种情况，您可以这样做：

![在此处输入图像描述](../Images/cbb7b28d51172fce44cd867bbbd6a55e.png)

使用此代码：

```
c.beginPath();
c.arc(33, 33, 22, 0, Math.PI, false);
c.shadowOffsetX = 2;
c.shadowOffsetY = 2;
c.shadowBlur = 5;
c.shadowColor  = 'rgba(0, 0, 0, 0.8)';
c.fillStyle = "red";
c.fill(); 
```

[​示范](http://jsfiddle.net/anEvh/)

或者，也许您正在尝试这样做：

![在此处输入图像描述](../Images/211282b1408828b57e1d831221a88f09.png)

```
c.beginPath();
c.arc(33, 33, 22, 10, Math.PI*2, false);
c.lineWidth = 2;
var gradient = c.createLinearGradient(20, 0, 50, 40);
gradient.addColorStop(0, "white");
gradient.addColorStop(0.5, 'red');
gradient.addColorStop(1, "white");
c.strokeStyle = gradient;
c.stroke(); 
```

[示范](http://jsfiddle.net/Su8Gb/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T15:39:06.597

不幸的是，没有羽毛选项（还），但是回答[这个问题](https://stackoverflow.com/questions/9010835/how-to-create-soft-stroke-edge-using-html5-canvas) 的人提出了这个小提琴，它可能非常接近你想要使用 RGBA 渐变实现的目标：

```
gradient.addColorStop(0,    "rgba("+r+","+g+","+b+",0)"); 
```

在这里查看他的 jsfiddle：http: [//jsfiddle.net/chdh/MmYAt/](http://jsfiddle.net/chdh/MmYAt/)

但这仍然有点麻烦。我想为此提交功能请求，但我根本不知道在哪里？

# python - 使用python正则表达式解析具有来自不同块的值的特定单词

> ID：13516823
> 
> 赞同：1
> 
> 时间：2012-11-22T16:29:41.667
> 
> 标签：python, regex

我正在尝试使用 Python 正则表达式从 3GB 日志文件中提取数据作为元组。

日志的格式如下。

```
2012-11-22 08:57:25,232 [P:DEBUG] moteId=245 statusElem=1
2012-11-22 08:57:25,042 [P:DEBUG] parsed into Tuple_IsSync(isSync=1)
2012-11-22 08:57:26,128 [P:DEBUG] parsed into Tuple_ScheduleRow(row=9, slotOffset=9, type=6, shared=0, channelOffset=0, neighbor_type=0, neighbor_bodyH=0, neighbor_bodyL=0, backoffExponent=1, backoff=0, numRx=0, numTx=0, numTxACK=0, lastUsedAsn_4=0, lastUsedAsn_2_3=0, lastUsedAsn_0_1=0, next=7638) 
```

我想要元组：

```
(2012-11-22, 08:57:25,042, moteId=245, statusElem=1, isSync=1, numRx=0, numTx=0, numTxACK=0,) 
```

在一行中。

```
import re
import sys

files=open('/Users/s/Desktop/p.log','r')

match=re.findall(r'\w[\s*moteId\s(statusElem)(isSync)(numTxAck).*]+.\d+',files.read())
f=open('/Users/s/Desktop/w.txt','w')
f.writelines(match)
f.close() 
```

我的代码并没有完全提取我正在寻找的内容。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T22:21:27.790

好吧，这不是正则表达式，只是标准序列方法和切片，但它有效，至少对于您提供的数据：

```
from StringIO import StringIO

data = '''
2012-11-22 08:57:25,232 [P:DEBUG] moteId=245 statusElem=1
2012-11-22 08:57:25,042 [P:DEBUG] parsed into Tuple_IsSync(isSync=1)
2012-11-22 08:57:26,128 [P:DEBUG] parsed into Tuple_ScheduleRow(row=9, slotOffset=9, type=6, shared=0, channelOffset=0, neighbor_type=0, neighbor_bodyH=0, neighbor_bodyL=0, backoffExponent=1, backoff=0, numRx=0, numTx=0, numTxACK=0, lastUsedAsn_4=0, lastUsedAsn_2_3=0, lastUsedAsn_0_1=0, next=7638)
'''

flo = StringIO(data)
mlst = []
for line in flo:
    lst = line.split()

    if 'moteId' in line:
        mote, status = lst[3], lst[4]

    elif 'isSync' in line:
        dt, tm = lst[0], lst[1]
        sync = lst[-1][-9:-1]

    elif 'Tuple_ScheduleRow' in line:
        numRx = lst[15].replace(',', '')
        numTx = lst[16].replace(',', '')
        numTxACK = lst[17].replace(',', '')
        t = dt, tm, mote, status, sync, numRx, numTx, numTxACK
        mlst.append(t) 
```

我使用 StringIO 来模拟一个文件，您将只使用该文件。最后我将元组存储在主列表中。但是，如果您对这种大小的文件执行此操作，您可能会感到抱歉，具体取决于您的内存情况。最好对元组做任何你需要做的事情，然后让它被 gc'd。如果您必须使用正则表达式，那么您仍然可以使用此逻辑并为每种线型应用不同的正则表达式，替换我的切片等。

这当然不是优化的，但希望它能给你一些想法并有所帮助。

麦克风

# xquery - xquery - 当我使用来自 xqueryfunctions.com 的 functx 库时出现重复的函数定义错误

> ID：13516826
> 
> 赞同：0
> 
> 时间：2012-11-22T16:29:44.280
> 
> 标签：xquery, functx, xquery-3.0

我正在尝试在 java 程序中运行一些 Xquery 代码，为此我正在使用 Saxon 免费的 java 库。

现在由于某种原因，当我运行此代码时，我收到重复的“重复函数定义”错误——我从 xqueryfunctions.com 下载的“Functx”Xquery 库发生了这个错误。

我不明白这里有什么问题？我直接调用 FunctX 库中的一些函数。

下面给出的是错误日志的一部分——它还提到了“重复函数”的行号——但是，当我转到 2 个行号时，我看到一个行号对应于该函数的开头，而其他行号关闭了该功能。

我正在使用的库位于此 URL -
[http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.com/functx-1.0.xq](http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.com/functx-1.0.xq)

下面给出了错误日志的一部分 -

```
Error on line 2488 column 4 of functx-1.0.xq:
  XQST0034 XQuery static error near #...ion the duration :) declare#:
    Duplicate definition of function functx:total-days-from-duration (see line 2
 484 in
  http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.c
 om/functx-1.0.xq)
Error on line 2502 column 4 of functx-1.0.xq:
  XQST0034 XQuery static error near #...ion the duration :) declare#:
    Duplicate definition of function functx:total-hours-from-duration (see line
 2498 in
 http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.c
 om/functx-1.0.xq)
 Error on line 2516 column 4 of functx-1.0.xq:
 XQST0034 XQuery static error near #...ion the duration :) declare#:
   Duplicate definition of function functx:total-minutes-from-duration (see lin
 e 2512 in
 http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.c
 om/functx-1.0.xq)
Error on line 2530 column 4 of functx-1.0.xq:
  XQST0034 XQuery static error near #...ion the duration :) declare#:
    Duplicate definition of function functx:total-months-from-duration (see line
2526 in
  http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.c
 om/functx-1.0.xq)
Error on line 2544 column 4 of functx-1.0.xq:
  XQST0034 XQuery static error near #...ion the duration :) declare#:
    Duplicate definition of function functx:total-seconds-from-duration (see lin
 e 2540 in
  http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.c
 om/functx-1.0.xq)
Error on line 2558 column 4 of functx-1.0.xq:
  XQST0034 XQuery static error near #...e string to trim :) declare#:
    Duplicate definition of function functx:total-years-from-duration (see line
  2554 in
 http://e0aad1ab954aa14b69e0-bd55729d8fadb0b3214bfee0a8fb65e0.r16.cf1.rackcdn.c
 om/functx-1.0.xq) 
```

现在，查看如上所示的最后一个错误——functx-1.0.xq 中重复函数定义错误的行号是“2558”和“2554”

来自文件 functx-1.0.xq 的第 2554-2558 行的相关代码现在给出如下——

```
 declare function functx:total-years-from-duration 
   ( $duration as xs:yearMonthDuration? )  as xs:decimal? {

    $duration div xs:yearMonthDuration('P1Y')
  } ; 
```

如何解决此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-08-21T12:50:50.657

例如，当您在循环中使用 xquery 引擎（我的情况）并使用一个对象执行多个导入相同函数的 xquery 时，引擎每次都会尝试导入该函数，因此您复制了第二个循环。

为了解决这个问题，我每次执行 xquery 时只需重置对象配置（在我的 Java 问题中，我创建了一个运行 xquery 引擎的类，并且每次都从 0 开始执行所有配置，这样之前的运行就不会弄乱新的运行）。

# xml-rpc - 在 Supervisord 中使用 XML-RCP 生成新程序？

> ID：13516827
> 
> 赞同：1
> 
> 时间：2012-11-22T16:29:47.633
> 
> 标签：xml-rpc, supervisord

是否可以通过 XML-RCP在[supervisord](http://supervisord.org/)中生成新程序？

我正在使用[supervisord](http://supervisord.org/)来管理我的[Apache Qpid](http://qpid.apache.org/)代理和我的 python 工作人员。当队列中的消息数量超过某个限制时，我希望能够产生更多的工作人员。

到目前为止，我只设法启动和停止已经运行的进程。但我想在 supervisord.conf 中指定一个通用程序并即时启动它们。

示例程序：

```
[program:qpid_worker]
command=python path/to/worker.py
autorestart=true
process_name=worker
redirect_stderr=true
stdout_logfile=/tmp/worker.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
loglevel=warn 
```

任何人都知道这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T12:48:49.883

不，这不是 supervisord 支持的功能。它无法基于模板创建任意数量的进程。

您必须预先定义您的工作人员并根据需要启动和停止这些工作人员。

# java - JFileChooser 在 Windows 中更改默认目录

> ID：13516829
> 
> 赞同：20
> 
> 时间：2012-11-22T16:29:54.787
> 
> 标签：java, windows, jfilechooser

我想在 Windows 上将我的 JFileChooser 的默认目录更改为“我的音乐”。这个目录`C:\Users\Fre\Music`在我的帐户上，因为我的用户名是`Fre`

默认设置为`C:\Users\Fre\Documents`（取决于我认为的操作系统）。我怎样才能改变这个？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-22T16:32:03.537

您可以在初始化 JFileChooser 对象时使用 API 方法[setCurrentDirectory ：](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JFileChooser.html#setCurrentDirectory%28java.io.File%29)

```
public void setCurrentDirectory(File dir) 
```

示例用法可能如下：

```
yourFileChooser.setCurrentDirectory(new File  
(System.getProperty("user.home") + System.getProperty("file.separator")+ "Music")); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-05-09T07:03:43.043

为什么不直接在创建 FileChooser 时为其提供路径，例如：

```
JFileChooser chooser = new JFileChooser("C:\\Users\\Fre\\Music\\"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-22T16:37:37.077

很抱歉占用您的时间，我自己找到了答案：

```
String userhome = System.getProperty("user.home");
JFileChooser fc = new JFileChooser(userhome +"\\Music"); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-09-19T11:46:15.637

```
JFileChooser openFile = new JFileChooser("C:\\Users\\Fre\\Music"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-19T09:12:58.783

创建所有自己的代码以设置默认文件目录是不必要且冗长的。一种更简单快捷的方法是在设计视图上右键单击文件选择器本身，然后右键单击“自定义代码”。

[自定义文件选择器代码](http://i.stack.imgur.com/gZgdP.jpg)

这将向您展示该 GUI 组件的重要代码。从第一行代码旁边的下拉框中，选择“自定义创建”。

这将允许您自定义 `fileChooser =`分配的内容。在大括号之间，`JFileChooser()`您可以使用这样的语音标记在文件目录中硬编码。

```
JFileChooser("C:\Users\user\Documents") 
```

或输入您之前创建的变量的名称。该变量将保存文件目录。我会推荐后一种选择，尽管任何一种都可以正常工作。

希望这可以帮助。

ps 很抱歉不得不使用照片链接。我还没有足够的特权。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-29T08:48:58.220

您可以在 Windows 上将我的 JFileChooser 的默认目录更改为“您想要的目录”

```
JFileChooser fileChooser = new JFileChooser();
fileChooser.setCurrentDirectory(new File("put here your directory"));
int result = fileChooser.showOpenDialog(getParent());
if (result == JFileChooser.APPROVE_OPTION) 
{
    File selectedFile = fileChooser.getSelectedFile();
    jTextField.setText(selectedFile.getAbsolutePath());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-03T13:22:35.907

很简单：

```
JFileChooser browseImageFile = new JFileChooser("User Defined Directory"); 
```

# java - 单击旁边的自定义对话框会消失

> ID：13516830
> 
> 赞同：0
> 
> 时间：2012-11-22T16:29:59.857
> 
> 标签：java, android, android-layout

我想显示一个自定义对话框并强制用户单击按钮一还是二。

问题是用户可以使用后退按钮，如果他们单击背景中显示的视图，我的对话框也会消失。

为什么？我怎么能防止这种情况呢？

```
 final Main t = this;
        final Dialog dialog = new Dialog(this);
        dialog.setContentView(R.layout.prompt_input_access);
        dialog.setTitle("Title");

        Button cmdLoginAccount = (Button) dialog.findViewById(R.id.cmdLoginAccount);
        Button cmdLoginBank = (Button) dialog.findViewById(R.id.cmdLoginBank);
        cmdLoginAccount.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                loginToBank = true;
                dialog.dismiss();

                Intent intent = new Intent(t, UserMenu.class);
                startActivity(intent);
            }
        });

        cmdLoginBank.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                loginToBank = false;
                dialog.dismiss();

                Intent intent = new Intent(t, UserMenu.class);
                startActivity(intent);
            }
        });

        dialog.show(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:32:06.013

您只需要使用[setCanceledOnTouchOutside](http://developer.android.com/reference/android/app/Dialog.html#setCanceledOnTouchOutside%28boolean%29)方法：

```
dialog.setCanceledOnTouchOutside(false); 
```

# routing - AngularJS location.path() 短暂更改 URL，然后恢复

> ID：13516834
> 
> 赞同：8
> 
> 时间：2012-11-22T16:30:12.353
> 
> 标签：routing, pagination, angularjs

我有一个令人沮丧的早晨。

我有一个具有基本位置的应用程序，所以在头部是`<base href="/my/path/fruits/index.html" />`. 我正在尝试通过函数设置分页`nextPage()`。当我点击触发的链接时`nextPage()`，我使用`$location.path('/page/:page')`.

*预期行为：*浏览器位置 url 应更改为`http://localhost/my/path/fruits/page/2`.

*实际行为：*浏览器 URL 更改（非常短暂）为`http://localhost/my/path/fruits/page/2`，然后恢复为`http://localhost/my/path/fruits/`.

**注意**：如果我不使用基本位置，这种行为似乎不会发生。但是，我需要使用基本位置，因为该应用程序位于服务器的 sub/sub/sub 目录中。

**另外**：如果我设置，则不会发生此行为`$locationProvider.html5Mode(false)`。

难道我做错了什么？这是Angular中的错误吗？任何帮助是极大的赞赏。

以下是相应的文件。

**索引.html：**

```
<!doctype html>
<html ng-app="fruits">
  <head>
    <base href="/my/path/fruits/index.html" />
    <script src="angular.js"></script>
    <script src="script.js"></script>
  </head>
  <body>
    <div ng-controller="MainCntl">
      <div ng-view></div>
    </div>
  </body>
</html> 
```

**脚本.js：**

```
angular.module('fruits', [], function($routeProvider, $locationProvider) {
    $routeProvider
    .when('/', {
        templateUrl: 'fruits.html',
        controller: FruitCntl,
    })
    .when('/page/:page', {
        templateUrl: 'fruits.html',
        controller: FruitCntl,
    })
    .otherwise({redirectTo:'/'})
    ;

    // configure html5 
    $locationProvider.html5Mode(true).hashPrefix('!');
}).filter('startFrom', function() 
    {
        return function(input, start) 
        {
            start = +start; //parse to int
            if (input == undefined){
                input = [];
            }
            return input.slice(start);
        }
})
;

function MainCntl($scope,$location){
    angular.extend($scope,{
        current_page: 1,
        per_page: 3,
        fruits: [
            {name: 'Apples', color: 'red'},
            {name: 'Bananas', color: 'yellow'},
            {name: 'Oranges', color: 'orange'},
            {name: 'Grapes', color: 'purple'},
            {name: 'Blueberries', color: 'blue'},
            {name: 'Strawberries', color: 'red'},
            {name: 'Raspberries', color: 'red'},
            {name: 'Clementines', color: 'orange'},
            {name: 'Pears', color: 'green'},
            {name: 'Mangoes', color: 'orange'}
        ],

        nextPage: function(){
            this.current_page++;
            $location.path('/page/'+this.current_page);
        },

        previousPage: function(){
            this.current_page--;
            $location.path('/page/'+this.current_page);
        }
    })
    $scope.total_pages = Math.ceil($scope.fruits.length / $scope.per_page);
}

function FruitCntl($scope,$location,$routeParams){
    if ($routeParams.page != undefined){
        $scope.current_page = $routeParams.page;
    }
} 
```

**fruits.html（视图）**

```
Page: <a ng-click="previousPage()" ng-show="current_page > 1">Previous</a> {{current_page}} of {{total_pages}} <a ng-click="nextPage()" ng-show="current_page < total_pages">Next</a>
<div ng-repeat="fruit in fruits | startFrom:(current_page - 1)*per_page | limitTo:per_page">
    {{fruit.name}} are {{fruit.color}}<br/>
</div> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-24T13:46:08.967

我有同样的问题，我一生都无法弄清楚出了什么问题。对我有用的是更改将 ng-click 事件附加到按钮标签的锚标签。据我所知，当没有给出 href 属性以防止默认操作时，Angular 会修改锚标记的行为，因此如果您在 ng-click 事件处理程序中手动更新位置，这可能会干扰。这只是我的猜测，所以希望有人能够更好地解释。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-10T18:21:47.377

正在发生浏览器回滚，因为 url 更改发生了两次，一次是触发 ng-click 函数，另一次是发生 a 标签的默认浏览器行为。

这就是为什么您在 url/view 中看到更新，然后它又恢复到原始状态的原因。

它以这种方式发生，因为这是浏览器理解它应该做的事情。

## **可能的解决方案：**

***按钮解决方案*** 正如在您可以触发对按钮的 ng-click 之前所建议的那样，这是有效的，因为该按钮没有更新 url 的有意义的 href 属性。您可以将 href 添加到按钮，但它不会做任何事情。

***a 标签：*** 不要在 ng-click 中进行更新，而是避免使用函数并使 href 执行更改 url 的逻辑。这是一个更简洁的解决方案，因为您让浏览器执行更新 url 的标记的默认行为。

我看到这样做的好处是任何人都可以一目了然地理解 url shceme，因此代码更易于维护。

```
<a href="#/go/to/logic/5">Update to logic 5</a> 
```

***带有 ng-click 的标签：*** 如果您绝对需要以编程方式进行更改，您应该做的是避免标签的默认行为。

在 jQuery 中，您将绑定到单击事件并执行 event.preventDefault()，然后执行您的自定义逻辑。

由于框架强加的逻辑分离，AngularJS 的方式有点不同，所以解决这个问题的方法是创建一个指令来执行 preventDefault。

* * *

**IgnoreClick 指令.js**

```
angularModule.directive('ignoreClick',  function() {

    return {
        restrict: 'A',
        link: function(scope, element) {
            element.bind('click', function(event) {
                event.preventDefault();
            });
        }
    }
}); 
```

使用示例

```
<a href=”http://stackoverflow.com/” ignore-click=”ignore-click” ng-click=”whatever()”&gt;Don't Go</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T20:07:46.787

也许这不会直接回答您关于它为什么以这种方式工作的问题，或者这是一个错误，因为我无法轻松地复制它（我的意思是基本路径），但是我会尝试向您建议一些解决方案。

您应该尝试使用 ?page=4 之类的 url 参数，而不是使用 url change 来指示要与*reloadOnSearch: false*参数一起显示的页面，如下所示：

```
 $routeProvider
    .when('/', {
        templateUrl: 'fruits.html',
        controller: FruitCntl,
        reloadOnSearch: false
    })
    .otherwise({redirectTo:'/'}) 
```

我认为在您的情况下只有一条路线就足够了。现在我们必须更改分页逻辑以使用 $location 的搜索功能（而不是您的 $location.path）：

```
$location.search('page', this.current_page); 
```

这样，每次更改页面时，它都会更新您的页面，而无需创建新的控制器。它还简化了路由逻辑。希望有帮助！

**注意：**我必须删除*$locationProvider.html5Mode(true).hashPrefix('!');* 因为当我在本地运行它时它会破坏网站。

# java - 为什么在 ViewHolder 模式中 ViewHolder 类应该是静态的？

> ID：13516835
> 
> 赞同：23
> 
> 时间：2012-11-22T16:30:12.720
> 
> 标签：java, android, android-viewholder

我只是想更好地理解我经常用来优化的以下模式`ListView`

我的阅读只指出静态内部类被视为顶级类的事实。与成员类（非静态）相比，这样的事情有什么好处？

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    Comment comment = getItem(position);
    ViewHolder holder;
    if (convertView == null){
        holder = new ViewHolder();
        convertView = LayoutInflater.from(context).inflate(R.layout.mylayout, null);
        holder.nickname = (TextView) ((ViewGroup) convertView).findViewById(R.id.nickname);
        convertView.setTag(holder);
    }else{
        holder = (ViewHolder) convertView.getTag();
    }

    holder.nickname.setText(comment.getMember_nickname());
    CharSequence
    return convertView;
}

public static class ViewHolder{
    TextView nickname;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-09-26T03:42:32.487

我的观点是最好让 ViewHolder 类静态，因为它不会泄漏适配器。

如果适配器保留了一些重的集合甚至视图（取决于每个特定情况），最好控制哪些对象保留适配器。

拥有大量内部类的对象实例将使这些对象引用适配器，从而保留它。您应该注意标签的管理方式（如果视图被自动清理/删除，则没有问题>）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T17:05:18.097

使用静态内部类的一个好处是可以从静态方法访问内部类，而无需外部类的实例。

如果内部类是非静态的：

```
class MyOuter {
    private int x = 7;
    public void makeInner() {
        MyInner in = new MyInner();
        in.seeOuter();
    }
    class MyInner {
        public void seeOuter() {
            System.out.println("Outer x is " + x);
        }
    }
}

public static void main(String[] args) {
    MyOuter mo = new MyOuter();
    MyOuter.MyInner inner = mo.new MyInner();
    inner.seeOuter();
} 
```

如果内部类是静态的：

```
class BigOuter {
    static class Nest {void go() { System.out.println("hi"); } }
}

class Broom {
    static class B2 {void goB2() { System.out.println("hi 2"); } }
    public static void main(String[] args) {
        BigOuter.Nest n = new BigOuter.Nest();
        n.go();
        B2 b2 = new B2();
        b2.goB2();
    }
} 
```

# php - 如何将联系表重定向到感谢页面

> ID：13516836
> 
> 赞同：2
> 
> 时间：2012-11-22T16:30:12.557
> 
> 标签：php, forms, wordpress, redirect, contact

我正在使用高级 Wordpress 主题，我正在尝试获取主题附带的自定义联系表单，以便在成功完成后重定向到感谢页面（这是为了转换跟踪目的）

无论如何，这是在页面上输入时调用简码的代码

```
 add_shortcode('etheme_contacts', 'etheme_contacts_shortcodes');
    function etheme_contacts_shortcodes($atts, $content=null){
    $a = shortcode_atts( array(
       'gmap' => 1
    ), $atts );
    if(isset($_GET['contactSubmit'])){
    $emailFrom = strip_tags($_GET['contactEmail']);
    $emailTo = etheme_get_option('contacts_email');
    $subject = strip_tags($_GET['contactSubject']);

    $name = strip_tags($_GET['contactName']); 
    $email = strip_tags($_GET['contactEmail']); 
    $message = strip_tags(stripslashes($_GET['contactMessage'])); 

    $body = "Name: ".$name."\n";
    $body .= "Email: ".$email."\n";
    $body .= "Message: ".$message."\n";
    $body .= $name.", <b>".$emailFrom."</b>\n";

    $headers = "From: ".$emailFrom."\n";
    $headers .= "Reply-To:".$emailFrom."\n";    

    if(isset($_GET['contactSubmit'])){
        $success = mail($emailTo, $subject, $body, $headers);
        if ($success){
        echo '<p class="yay">All is well, your e&ndash;mail has been sent.</p>';
        } 
    } else {
        echo '<p class="oops">Something went wrong</p>';
    }
    } else {
    if($a['gmap'] == 1):
    ?>

    <div id="map">
        <p>Enable your JavaScript!</p>
    </div>
    <script type="text/javascript">
        var $map = jQuery('#map');    
        if( $map.length ) {    
            $map.gMap({
                address: '<?php etheme_option('google_map'); ?>',
                zoom: 16,
                markers: [
                    { 'address' : '<?php etheme_option('google_map'); ?>' }
                ]
            });    
        }  
        var succmsg = '<?php _e('All is well, your e&ndash;mail has been sent!',     ETHEME_DOMAIN); ?>';
    </script>
    <?php endif; ?>
    <?php if(etheme_option('contacts_custom_html') != ''): ?>
    <div class="custom-html">
        <?php echo etheme_option('contacts_custom_html') ?>
    </div>
    <?php endif; ?>
    <div class="one-third">      
        <div id="contactsMsgs"></div>  
        <form action="<?php the_permalink(); ?>" method="POST" class="form"      id="ethemeContactForm">   
            <div class="formField">
                <label for="contactName"><?php _e('Name', ETHEME_DOMAIN); ?> <span class="required">*</span></label>
                <input type="text" class="textField required-field" name="contactName" id="contactName" />
                <div class="clear"></div>
            </div>
            <div class="formField">
                <label for="contactEmail"><?php _e('Email', ETHEME_DOMAIN); ?> <span class="required">*</span></label>
                <input type="text" class="textField required-field email" name="contactEmail" id="contactEmail" />
                <div class="clear"></div>
            </div>
            <div class="formField">
                <label for="contactSubject"><?php _e('Subject', ETHEME_DOMAIN); ?></label>
                <input type="text" class="textField" name="contactSubject" id="contactSubject" />
                <div class="clear"></div>
            </div>
            <div class="formField">
                <label for="contactMessage"><?php _e('Message', ETHEME_DOMAIN); ?> <span class="required">*</span></label>
                <textarea class="textField required-field" name="contactMessage" id="contactMessage" cols="30" rows="10"></textarea>
                <div class="clear"></div>
            </div>
            <div class="formField ">
                <button class="button" name="contactSubmit" type="submit"><span><?php _e('Send Request', ETHEME_DOMAIN); ?></span></button>
                <div class="contactSpinner"></div>
            </div>
        </form>      
    </div>
    <div class="one-third last fl-r">
        <div class="block non-line contats">
            <?php etheme_option('contacts_info'); ?>
        </div>
    </div>
<?php
}
} 
```

我假设这里需要更改一些内容，因为这是 php 为要提交的表单设置函数的地方，但由于我的菜鸟，我不确定如何处理这段代码。

```
if(isset($_GET['contactSubmit'])){
$success = mail($emailTo, $subject, $body, $headers);
if ($success){
echo '<p class="yay">All is well, your e&ndash;mail has been sent.</p>';
} 
} else {
echo '<p class="oops">Something went wrong</p>';
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T16:35:14.643

尝试这个 ：

```
header( 'Location: http://www.yoursite.com/thanyk_you.html' ) ; 
```

替换当前：

```
echo '<p class="yay">All is well, your mail has been sent.</p>'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-23T13:07:46.410

只需将所需的 URL 放入“附加设置”框中

> on_sent_ok: "位置 = 'http://example.com/';"

请记住，您应该在 footer.php 中包含页脚函数，否则它将不起作用。

第二种解决方案是更改插件文件中的编码。

希望它会帮助你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-22T16:35:11.457

这里有几种解决方案，但打字量最少的一个是这样的：

1.  制作一个感谢页面（在 wordpress 中）并获取 url
2.  用您的 url 代替succes echo 行，`<meta http-equiv='refresh' content='0; url=http://stackoverflow.com'>`而不是 stackoverflow 行。`header( 'Location: http://www.yoursite.com/new_page.html' ) ;`
3.  对出现问题的回声线执行相同的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T16:38:18.997

由于您使用 Wordpress id 推荐内置 wp_redirect();

[http://codex.wordpress.org/Function_Reference/wp_redirect](http://codex.wordpress.org/Function_Reference/wp_redirect)

```
if(isset($_GET['contactSubmit'])){
   $success = mail($emailTo, $subject, $body, $headers);
   if ($success){
     //comment out below...
     //echo '<p class="yay">All is well, your e&ndash;mail has been sent.</p>';
     wp_redirect(get_bloginfo('wpurl').'/your-thank-you-page/');
     exit;
   } 
} else {
  echo '<p class="oops">Something went wrong</p>';
} 
```

# mysql - MySql“多对一”表设计

> ID：13516839
> 
> 赞同：5
> 
> 时间：2012-11-22T16:30:35.063
> 
> 标签：mysql, database-design, database-schema

我是数据库设计的新手，在查找有关如何定义“多对一”关系的信息时遇到了一些麻烦。我可以找到关于“一对多”和“多对多”的各种信息，但没有关于“多对一”的信息。我的挂断是如何存储数据。我有一个名为“Categories”的表，然后我有另一个名为“Inventory”的表，每个“Inventory”项目可以属于多个“Categories”。

如何在单个“库存”行中存储多个“类别”？我是否应该有一个中间表来存储具有相应“库存”ID 的“类别”ID？或者在“Inventory”行中添加类似 JSON 字符串的“Categories”ID 是正确的方法吗？或者有没有办法在“库存”行中存储“类别”ID的数组？

感谢分配的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-22T16:42:03.803

的正确术语`Many to One`是`One to Many`。只需创建一个这样的表，

```
CREATE TABLE Categories
(
    CategoryID INT Primary KEY,
    CategoryName
);

CREATE TABLE InventoryList
(
    ProductID INT Primary KEY,
    CategoryID INT,
    ProductName VARCHAR(50),
    CONSTRAINT tb_fk FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID)
); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-22T16:40:35.990

首先，我建议您下载[mysql workbench](http://www.mysql.com/products/workbench/) - 它为您提供了一个很好的可视化数据库设计模式，因此您可以看到事情是如何联系在一起的（为您创建外键关系等）。

在这种情况下，这实际上是一个多对多的关系。因此，您将需要一个类别表、一个库存表和一个 category_has_inventory 表（或inventory_has_category，取决于语义），您将在每个元组中存储库存和类别的 id - 工作台甚至在使用多对时为您创建此表- 多关系工具。

如果您需要进一步的帮助，请回到这里。

如果一个类别只能包含一个库存项目，那么您可以通过将 inventory_id 添加到类别表来创建一对多关系，但这对我来说听起来是错误的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-22T16:40:16.833

“多对一”只是从另一端看的“一对多”。

`inventory_id`只需在表格中添加一列`Categories`。

如果不仅每个“库存”项目可以属于多个“类别”，而且每个“类别”项目可以属于多个“库存”项目，那么您就有一个多对多关系，您需要一个中间表`category_id`和`inventory_id`.

# sql - SQL Server 2008 中的这个游标可以重构为“基于集合”的东西吗

> ID：13516840
> 
> 赞同：2
> 
> 时间：2012-11-22T16:30:50.010
> 
> 标签：sql, sql-server, cursor

```
DECLARE @PaymentTime VARCHAR (50)

DECLARE @DueDate VARCHAR (50)
DECLARE @CustomerID int

DECLARE MYCURSOR5 CURSOR 
FOR SELECT   distinct  Payment.PaymentTime,Invoice.DueDate, Customer.CustomerID
FROM         Cus_Cred_Terms INNER JOIN
                      Customer ON Cus_Cred_Terms.CustomerID = Customer.CustomerID INNER JOIN
                      Payment ON Customer.CustomerID = Payment.CustomerID INNER JOIN
                      Invoice ON Payment.InvoiceID = Invoice.InvoiceID

open MYCURSOR5 

FETCH MYCURSOR5 INTO @PaymentTime, @DueDate, @CustomerID

WHILE @@FETCH_STATUS = 0
BEGIN 

if(@PaymentTime > @DueDate)
begin
print'payment time:'
PRINT @PaymentTime 
print'due date:'
PRINT @DueDate 

print''
print @CustomerID
print''
update dbo.Cus_Cred_Terms
set dbo.Cus_Cred_Terms.CreditAllowed = 0
FROM Cus_Cred_Terms INNER JOIN
 Customer ON Cus_Cred_Terms.CustomerID = Customer.CustomerID INNER JOIN
 Payment ON Customer.CustomerID = Payment.CustomerID
 where Customer.CustomerID = @CustomerID and dbo.Cus_Cred_Terms.CreditAllowed = 1
end

FETCH MYCURSOR5  INTO @PaymentTime, @DueDate, @CustomerID

END
CLOSE MYCURSOR5 
```

它遍历每个字段，检查 DueDate 是否小于实际 PaymentDate，如果小于，则将另一个表中的字段设置为 0（1 表示允许信用，0 表示不允许信用）

所以问题是，我可以避免使用光标来执行此操作吗？如果您需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:39:40.390

尝试这样的事情：

```
;WITH CTE AS 
(
    SELECT DISTINCT  
        Customer.CustomerID
    FROM         
        Cus_Cred_Terms 
    INNER JOIN
        Customer ON Cus_Cred_Terms.CustomerID = Customer.CustomerID 
    INNER JOIN
        Payment ON Customer.CustomerID = Payment.CustomerID 
    INNER JOIN
        Invoice ON Payment.InvoiceID = Invoice.InvoiceID
    WHERE
        Payment.PaymentTime > Invoice.DueDate
)
UPDATE
    dbo.Cus_Cred_Terms
SET
    dbo.Cus_Cred_Terms.CreditAllowed = 0
FROM 
    CTE 
WHERE 
    dbo.Cus_Cred_Terms.CustomerID = CTE.CustomerID
    AND dbo.Cus_Cred_Terms.CreditAllowed = 1 
```

CTE（通用表表达式）基本上具有`SELECT`您的光标所具有的 - 除了它还检查约束`Payment.PaymentTime > Invoice.DueDate`。仅选择与此条件匹配的那些客户 ID。

如果该表中的列等于 1 ，则根据这些`CustomerID`值`dbo.Cus_Cred_Terms`更新该表。`CreditAllowed``CustomerID`

# c# - 如何对我的 JQueryUI 元素（组合框）进行不显眼的验证？

> ID：13516841
> 
> 赞同：0
> 
> 时间：2012-11-22T16:30:56.000
> 
> 标签：c#, asp.net-mvc, jquery-ui, unobtrusive-validation

在 ASP NET MVC 中，我有一个 @Html.DropDownList，其中该字段的验证工作得很好。

因为我需要该字段是可编辑的，所以我决定使用 JQueryUI 组合框，但现在我在提交表单之前没有得到不显眼的验证。因此，当我选择正确的值时，之前发布的错误消息不会消失。

如何在我的 JQueryUI 组合框上的每个按键上再次进行不显眼的验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T15:52:09.837

这些字段没有得到验证，因为当您使用 JQueryUi 组合框时它们被隐藏了。通过 Document.Ready 事件中的下一个脚本，您可以指定验证器不忽略隐藏字段。

```
 var validator = $("Form").data('validator');
    validator.settings.ignore = ""; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:44:09.103

值得检查渲染 html 以确保添加了正确的不显眼的验证属性

否则，您是否尝试过在组合框的更改事件上调用 validate 函数.. 在 $(document).ready 部分中放置类似的内容

```
$('#combobox').change(function(){
       $(this).validate();
}); 
```

# shell - 如何使用 sed 格式化输出

> ID：13516842
> 
> 赞同：1
> 
> 时间：2012-11-22T16:31:05.037
> 
> 标签：shell, sed

我有一个 shell 脚本，需要你的专业知识。

```
 SearchAirline() {
echo "Enter Airline Name:"
read airlineName

if [ $? -eq 0 ];then
echo -e "\t\t\E[43;31;1mFlight Information\E[0m"
echo -e "Departure Time     Flight      Airlines    Vacancy"
echo "__________________________________________________________________________"

#cat flightlist.txt | grep $airlineName flightlist.txt
    old_IFS=$IFS 
    IFS=$'\n'
for LINE in `sed -e '$airlineName'  flightlist.txt`
    do
        print_flight $LINE
    done
  IFS=$old_IFS 
fi

} 
```

给我过滤列表是行不通的。相反，它会打印整个列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:36:01.113

*   将“$airlineName”更改为“$airlineName”。变量出现在单引号中时不会被插值。
*   将 sed 表达式更改为仅打印匹配的行：

    `sed -n "/$airlineName/p"`

**编辑：**其他答案建议使用其他工具，例如*grep*，他们可能是对的。我的回答与 sed 有关的唯一原因是您的问题特别要求它。我假设您希望使用 sed 进行比您在问题中描述的更重要的处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:23:34.430

As @D.Shawley pointed out, this is REALLY a job for awk but that would mean rewriting the print_flight function too so here's a fixed shell script given some assumptions about your input file:

```
SearchAirline() {
   echo "Enter Airline Name:"
   read airlineName

   if [ $? -eq 0 ];then
      echo -e "\t\t\E[43;31;1mFlight Information\E[0m"
      echo -e "Departure Time     Flight      Airlines    Vacancy"
      echo "__________________________________________________________________________"

      grep "$airlineName" flightlist.txt |
      while IFS= read -r line
      do
         print_flight "$line"
      done
   fi
} 
```

I strongly recommend you rewrite your script in awk though. If you'd like help with that, post another question and show us what print_flight looks like.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:34:14.200

将[`-n`选项](http://pubs.opengroup.org/onlinepubs/009695399/utilities/sed.html)添加到您的 sed 调用中：

> **-n**
> 
> 抑制默认输出（其中每一行，在检查编辑后，被写入标准输出）。仅写入明确选择用于输出的行。

*编辑*：您还必须使用正确的引号`$airlineName`。单引号禁用变量替换。我将这一点归功于[Martin Ellis](https://stackoverflow.com/questions/13516842/how-to-format-output-using-sed/13516909#13516909)，因为我第一次没有注意到它。

顺便说一句 - 我强烈建议使用`awk`这种报告。它可以处理格式和选择，如果你有一个大数据集，它会快很多。

# http - Windows 8 显然从压缩的 HTTP 响应中删除了内容编码标头

> ID：13516844
> 
> 赞同：12
> 
> 时间：2012-11-22T16:31:06.580
> 
> 标签：http, windows-8, http-headers, http-compression

我不完全确定这是否属于 SO，但我不知道还有什么要问的。

当我检查我的网络应用程序的加载速度时，我注意到显然没有 HTTP 响应（无论是什么类型 - html、css、js）是 gzip/deflate 压缩的。也就是说，任何请求中都没有像“Content-Encoding: gzip”这样的响应头，并且浏览器报告资源没有被压缩。

*   在多个浏览器（IE10、FF 17、Chrome 23、Opera 12.10、Safari 5.x）中测试和确认
*   在运行 Windows 8 Pro 的两台机器上测试并确认
*   使用 Fiddler 仔细检查 - 响应未压缩且不包含内容编码标头
*   这不仅发生在我的网络应用程序中，我测试的其他网站似乎都没有发送压缩响应（根据浏览器*）*
*   在 Windows 7 上，响应到达压缩并带有所有标头
*   HTTPS 响应*被*压缩

这是响应标头的示例（请注意缺少内容编码标头）： ![客户端机器上的响应头](../Images/7005e44a469d1f40d7c1ee19040584ff.png)

我还检查了服务器端。服务器正在运行 Windows Server 2008 R2/IIS 7.5。我使用失败的请求跟踪来找出服务器正在发送的内容。资源似乎被压缩：

![服务器端压缩](../Images/fed82f55d45f47e524066d372d5650cd.png)

此外，服务器似乎发送了正确的标头：

![压缩头](../Images/6deeb32803aae5626c77094f0de61503.png)

我的结论是：一定是 Windows 8 介入了这里。显然它修改了 HTTP 响应。我假设 Windows 8 正在接收压缩响应，将其解压缩，删除内容编码标头并将修改后的响应进一步传递到管道中。

现在我的问题：

*   任何人都可以确认 Windows 8 修改了 HTTP 响应并且它按照我描述的方式工作吗？
*   有没有办法监控甚至禁用这种​​行为？

提前感谢您的回答。

问候， 安德烈

* * *

更新：我使用 Wireshark 查看到达客户端的内容。正如我所料，资源被压缩并且内容编码标头仍然存在。下图显示了 wireshark 协议，右下角显示了 Chrome 收到的响应。

![线鲨](../Images/0cc4a06b4f07c78b151d2e4edfdadd6e.png)

这证实了我的假设，即 Windows 8 正在干预。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T23:45:13.767

原来，罪魁祸首是我的杀毒软件 Avast，更确切地说是集成的实时网络盾牌。关闭它会导致响应在浏览器中再次出现压缩。

仍然有趣的是，Avast 也在 Windows 7 机器上运行，即使在我的测试期间在适用的地方压缩了这些机器上的响应。

# sql - 导入 sqlé 变成 é

> ID：13516845
> 
> 赞同：0
> 
> 时间：2012-11-22T16:31:12.557
> 
> 标签：sql, phpmyadmin

我忘记了我需要做什么，但是当我将我的 sql 数据库导入一个单独的站点时，它会将我所有的特殊字符更改为 Ã© well me é 至少。

我正在将一个 sql 文件直接导入 phpmyadmin。

我相信我选择的字符集是 utf8 我应该选择其他的还是其他地方的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:55:39.390

检查你的文件的编码是否也是UTF-8（Notepad++有这个功能），或者尝试将内容粘贴到phpmyadmin的sql执行器中。

# vb.net - 如果文本框是动态添加的，为什么文本框上的 WordWrap 和 AutoSize 属性的行为会有所不同？

> ID：13516846
> 
> 赞同：-1
> 
> 时间：2012-11-22T16:31:20.240
> 
> 标签：vb.net

我正在**自定义控件**中动态创建一些文本框（实际上只是一个带有绑定源的面板，它在运行时添加其他子控件。

在其中一些我设置`WordWrap=True`，因为我期待大文本。但是文本框只有一行。我还注意到我必须将属性设置`AutoSize`为 False。当我在表单中添加动态文本框时，一切正常（即使没有设置 AutoSize 和 WordWrap.

```
 Dim txt as new textbox
 txt.Multiline = True
 txt.AutoSize = False
 txt.Size = New Size(100, 50)
 txt.WordWrap = True
 txt.Location = New Point(10, 10)
 Me.Controls.Add(txt)   'Me is my custom Control 
```

`WordWrap`插入文本框后（双击），我检查了文本框的属性，结果为真。

任何想法为什么我在自定义控件中遇到这种奇怪的行为？

编辑：问题是我不能让我的文字自动换行。因此，尽管我将 MultiLine 设置为 true，AutoSize 设置为 false，WordWrap 设置为 True，但文本并没有换行。我不想添加滚动条。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T09:37:21.883

伙计们，我必须道歉。
错误出现在我的 xml 中（我有 MultiLine 而不是 Multiline），所以我的文本框从来都不是 Multiline。感谢您的宝贵时间，很抱歉无意义地花费了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T20:32:07.450

您可以在 .Text 更改时调整 TextBox 的 .Height ：

```
Public Class Form1

    Dim txt As TextBox

    Sub maketb()
        txt = New TextBox
        txt.Multiline = True
        txt.Size = New Size(100, 50)
        txt.WordWrap = True
        txt.Location = New Point(10, 10)
        Me.Controls.Add(txt)
    End Sub

    Sub SetHeight(sender As Object, e As EventArgs)
        Dim target = DirectCast(sender, TextBox)
        Dim fn = target.Font
        Dim gr = target.CreateGraphics()
        Dim lrMarginSize = target.Margin.Left + target.Margin.Right
        Dim tbMarginSize = target.Margin.Top + target.Margin.Bottom
        Dim h = gr.MeasureString(target.Text, fn, target.Width - lrMarginSize).Height + tbMarginSize
        target.Height = CInt(Math.Ceiling(h))
    End Sub

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        maketb()
        AddHandler txt.TextChanged, AddressOf SetHeight
        txt.Text = "dfgd dfd gg hgljhhkjlh jhkkj hkjh hghjg hgjhgz hfjsdhfytu hgjahg ht gretyt jgagury agha gty ajhg ajgx"
    End Sub

End Class 
```

# c# - 如何将 Frame.Content 大小设置为 Frame 大小？

> ID：13516848
> 
> 赞同：0
> 
> 时间：2012-11-22T16:31:23.363
> 
> 标签：c#, .net, wpf

我的 XAML 中有一个框架：

```
<Frame Grid.Row="1" Content="{Binding MainContent}" Margin="8" NavigationUIVisibility="Hidden" /> 
```

内容是在代码中设置的页面，如下所示：

```
MainContent = new MyPage(); 
```

我想将宽度和高度绑定`MyPage`到父框架的宽度和高度。框架位于网格行中，因此将随窗口调整大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:46:52.403

将 MyPage 的 Horizo​​ntalAlignment 和 VerticalAlignment 属性都设置为“Stretch”，并将其 Margin 设置为 0。如果这还不够，请将 Frame 的 Horizo​​ntalContentAlignment 和 VerticalContentAlignment 设置为“Stretch”。

要进行调试，首先检查您的 Frame 是否确实跟随其父级、更改其背景或做类似的事情。检查页面的高度和宽度是否设置为自动，并且 MaxHeight 和 MaxWidth 为 0。还要检查页面中的子控件。有时 Blend 可能会使用固定值覆盖此属性或在自动生成控件时设置它们。

例如，当您使用“Group”命令包装子元素时，生成的面板控件可能带有固定的宽度和高度。

另一种情况：当您更改网格行或列大小类型的类型（使用设计器上的图标）而不在属性视图中显示其属性时，Blend 可能会设置最小宽度/高度。尤其是在将尺寸类型更改为自动时会发生这种情况。

# mspec - 为什么这个 Machine.Fakes 参数匹配会抛出异常？

> ID：13516849
> 
> 赞同：1
> 
> 时间：2012-11-22T16:31:26.157
> 
> 标签：mspec, machine.fakes

我正在使用`Machine.Fakes.NSubstitute`并且想要“伪造”一个返回值，这样如果输入参数与特定值匹配，则返回模拟对象，否则返回 null。

我尝试了以下方法：

```
host.WhenToldTo(h => h.GetTenantInstance(Param.Is(new Uri("http://foo.bar"))))
    .Return(new TenantInstance()); 
```

但它会引发以下异常：

> System.InvalidCastException：无法将“System.Linq.Expressions.NewExpression”类型的对象转换为“System.Linq.Expressions.ConstantExpression”类型。

我目前的解决方法是执行以下操作：

```
host.WhenToldTo(h => h.GetTenantInstance(Param.IsAny<Uri>()))
    .Return<Uri>(uri => uri.Host == "foo.bar" ? new TenantInstance() : null); 
```

这有点臭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-24T15:04:16.800

我在这里看到三个方面：

1.  当在模拟对象上调用具有引用类型返回值的方法并且没有为调用设置任何行为时，模拟对象**将返回一个模拟**。如果您希望它返回`null`，则必须明确配置它。因此，仅设置是不够的

    ```
    host.WhenToldTo(h => h.GetTenantInstance(Param.Is(new Uri("http://foo.bar"))))
        .Return(new TenantInstance()); 
    ```

    您还必须使用以下内容设置另一种情况：

    ```
    host.WhenToldTo(h => h.GetTenantInstance(Param<Uri>.Matches(x => !x.Equals(new Uri("http://foo.bar")))))
        .Return((TenantInstance)null); 
    ```

    我发现您的*“解决方法”*解决方案比这两种设置更优雅。

2.  当您为相等性匹配方法调用参数时，**无需使用`Param.Is()`**. 您可以简单地设置行为

    ```
    host.WhenToldTo(h => h.GetTenantInstance(new Uri("http://foo.bar")))
        .Return(new TenantInstance()); 
    ```

3.  `Param.Is()`在这里使用时出现异常的事实是**Machine.Fakes 的缺点**。我看不出为什么这不起作用。我会在某个时候纠正它并让你知道。

# jquery - 规避 ui-dialog .dialog() 与移动端 .dialog() 冲突

> ID：13516857
> 
> 赞同：3
> 
> 时间：2012-11-22T16:32:11.677
> 
> 标签：jquery, jquery-ui, jquery-mobile, jquery-plugins

我是尝试同时使用 jquery-ui 和 jqm 的人之一。除非我尝试使用 jquery-ui 对话框，否则一切正常。

呼吁

```
$('#tag').dialog(options) 
```

当我包含 jquery-mobile.js 时，转到 jquery mobile 的对话框。我有兴趣使用 ui-dialog 而不是 jquery 移动对话框。

经过一番研究，我看到 ui.dialog 被安装为 $['ui']['dialog] 我想知道是否有一种方法可以直接从那里调用它来规避对 .dialog() 的调用传递给移动设备的对话框（）。所以做类似的事情：

```
var dialogInstance = $['ui]['dialog']({Options...}, tag); 
```

其中标签是 $('#tag')。我试图这样做并得到以下错误：

```
Uncaught TypeError: Object #<Object> has no method '_createWidget' 
```

显然我做错了什么。在我花更多时间之前，寻求专家建议。

抱歉，jquery ui/mobile 的新手。任何帮助深表感谢 ！！

# linux - 用于 Debian Linux 的 nspr-devel？

> ID：13516858
> 
> 赞同：0
> 
> 时间：2012-11-22T16:32:12.490
> 
> 标签：linux, ubuntu, centos, debian, rhel

我想知道这是否可能。我可以将 nspr 安装到 CentOS 中；

```
yum install nspr-devel 
```

我看到这实际上只适用于 CentOS/RHEL/Fedora 所以请注意

[http://pkgs.org/download/nspr-devel](http://pkgs.org/download/nspr-devel)

有没有办法可以使用 apt-get 将其安装到最新版本的 Debian 中？如果是这样，是否有人有分步说明？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:39:36.023

看起来 libnspr4-dev 是您想要的软件包。

我使用 apt-cache 搜索找到了它：

```
$ apt-cache search nspr
dnsproxy - proxy for DNS queries
libnspr4 - NetScape Portable Runtime Library
libnspr4-0d - NetScape Portable Runtime Library - transitional package
libnspr4-dbg - Debugging symbols for the NetScape Portable Runtime library
libnspr4-dev - Development files for the NetScape Portable Runtime library
python-nss - Python bindings for Network Security Services (NSS) 
```

看起来它已经在 Debian 存储库中，这意味着您不需要从其他地方获取它。

您可以使用 apt-cache 策略查看将安装哪个版本：

```
$ apt-cache policy libnspr4-dev
libnspr4-dev:
  Installed: (none)
  Candidate: 2:4.9.2-1
  Version table:
     2:4.9.2-1 0
        500 http://ftp.uk.debian.org/debian/ testing/main amd64 Packages 
```

如果没问题，您可以使用`apt-get install libnspr4-dev`.

如果没有，那么您应该检查`/etc/apt/sources.list`以确保它列出了具有您需要的版本的存储库。

# javascript - 格式化日期是JS

> ID：13516860
> 
> 赞同：0
> 
> 时间：2012-11-22T16:32:13.163
> 
> 标签：javascript, calendar

我正在尝试用 Javascript 做一些非常简单的事情。我需要脚本以下列格式打印出日期：`yyyymmdd`/ `yyyymmdd`。

我只是无法让以下脚本工作。它提供谷歌日历以输出当前日视图。

```
 var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();

    if(dd<10){dd='0'+dd} if(mm<10){mm='0'+mm} today = yyyy+''+mm+''+dd;

    document.write ('<iframe src="https://www.google.com/calendar/embed?

        showTitle=0&amp;dates=today"/"today&amp;mode=DAY&amp;height=1200&amp;wkst=1&amp;hl=en_GB&amp;bgcolor

=%23FFFFFF&amp;src=my cal source&amp;color=%23711616&amp;ctz=Etc%2FGMT" style=" border:solid 

1px #777 " width="950" height="715"frameborder="0" scrolling="no"></iframe>'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:39:03.810

问题是字符串连接。你必须告诉 JS 什么是字符串，什么是要添加的变量。更新您的代码如下：

```
document.write( '<iframe src="https://www.google.com/calendar/embed?showTitle=0&amp;dates='
    + today + '/' + today +
    '&amp;mode=DAY&amp;height=1200&amp;wkst=1&amp;hl=en_GB&amp;bgcolor=%23FFFFFF&src=my cal source&color=%23711616&ctz=Etc%2FGMT" style=" border:solid 1px #777 " width="950" height="715"frameborder="0" scrolling="no">' ) 
```

# javascript - 中间没有服务器的情况下发送数据

> ID：13516862
> 
> 赞同：1
> 
> 时间：2012-11-22T16:32:17.197
> 
> 标签：javascript, html

使用浏览器，是否可以使用仅客户端技术（如 JS、HTML ...）将数据发送到另一个浏览器，而无需通过为 HTML 页面提供服务的服务器？我的意思是如果两端已经同步（一个打开一个端口，另一个发送数据），是否可以这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:34:08.323

仅使用 javascript 和 HTML，答案显然是否定的：您无法建立直接的 P2P 连接。

有涉及插件的解决方案，例如 java（在 java 的情况下，用户必须放松安全性，通常通过签名）。

但请注意，使用[websockets](http://fr.wikipedia.org/wiki/Websocket)您可以通过服务器进行连接和交换，但它对于大多数用途来说足够高效（前提是您的用户将接受[不使用 IE9-](http://caniuse.com/#feat=websockets)）。那些日子，WebSocket 编程很容易（这里有[一个完整的聊天客户端/服务器](http://gary.beagledreams.com/page/go-websocket-chat.html)的例子，谷歌搜索会给出一个你最喜欢的语言的例子）所以我真的建议不要尝试使用插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:38:09.340

您还不能使用 JS、HTML 进行直接的客户端到客户端事务，但是如果您选中[red5](http://www.red5.org/)以使用 Java 框架，它提供了用于 P2P 连接的 RTMP（实时媒体协议）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:35:10.493

HTTP 需要服务器。对于个人项目，您可以尝试 Firefox 的 Web 服务器插件：

[https://addons.mozilla.org/en-us/firefox/addon/pow-plain-old-webserver/](https://addons.mozilla.org/en-us/firefox/addon/pow-plain-old-webserver/)

# c# - 使用 ASP.NET、C# 和 SQL

> ID：13516869
> 
> 赞同：1
> 
> 时间：2012-11-22T16:32:58.287
> 
> 标签：c#, asp.net, .net, sql, web

我的任务是创建一个商店网站，允许用户查看商店页面中可用的 DVD，然后当他们单击一个时，他们将被带到一个详细信息页面，该页面将动态提供有关 DVD 的更多信息。我还得到了一个 ac# 文件，其中包含一个名为 DVD 的类。到目前为止，我已经获得了我在 ASP.NET 中制作的网页，这很容易从数据库中提取所有内容，并且一切正常，但这与 DVD.cs 文件无关。

我错过了一些明显的东西吗？我必须使用这个文件，我将在下面发布：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace DVDs
{
class DVD
{
    public string Title
    {
        get;
        set;
    }

    public int Price
    {
        get;
        set;
    }

    public int YearReleased
    {
        get;
        set;
    }

    public string Desc
    {
        get;
        set;
    }

    public DVD(string title, int price, int yearReleased, string desc)
    {
        Title = title;
        Price = price;
        YearReleased = yearReleased;
        Desc = desc;

    }

    protected bool Save()
    {
        //add code to save to the database
        return true;
    }

    protected bool Load()
    {
        //add code to load from the database
        return true;
    }
}
} 
```

有人可以解释一下我如何使用这些变量来链接数据库和 .aspx 文件吗？

所有帮助将不胜感激谢谢

**编辑**：到目前为止尝试的代码

```
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);
    if (this.IsPostBack)
    {
        PageAsyncTask pat = new PageAsyncTask(BeginAsync, EndAsync, null, null, true);
        RegisterAsyncTask(pat);
    }
}

private IAsyncResult BeginAsync(object sender, EventArgs e, AsyncCallback cb, object state)
{
    DVD dvd = new DVD();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T09:32:04.043

或者使用 MVC 来实现，或者查看 ASP.Net 绑定以将您的 DVD 对象链接到 UI。

这可能是一个很好的起点：http: [//support.microsoft.com/kb/307860](http://support.microsoft.com/kb/307860)

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-11-22T16:39:12.510

使用实体框架将帮助您以一种非常简单的方式将您的类连接到数据库，但是要将您的类属性链接到 ASP.NET .aspx 文件，您可以使用`session["key"] = value`

# javascript - 全局变量超出范围

> ID：13516876
> 
> 赞同：-1
> 
> 时间：2012-11-22T16:33:27.977
> 
> 标签：javascript, jquery, variables, scope

在我的程序中，我在顶部有全局变量，供游戏中的各种函数使用。有时调用它们时，它们在控制台中显示为未定义。我已经玩了很长时间，但似乎找不到问题的根源。是因为它们是数组，还是有其他原因？

```
var randomWord = [];
var listOfWords = [];
var gridSize = [];
var populationNumber = [];
var completionNumber = [];
var attemptNumber = []; 
```

这是一个与脚本中的小提琴......

[http://jsfiddle.net/sYDs4/1/](http://jsfiddle.net/sYDs4/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:53:51.213

以下是一些不适合评论的评论......

```
 if (populationNumber >= 6) {
        var populationNumber = 6;
    }
    if (completionNumber >= 6) {
        var completionNumber = 6;
    } 
```

不应该在 JS 中完成，这很危险，因为您创建了一个与全局变量同名的局部变量。甚至没有提到您将一个数字分配给一个应该是数组的变量（全局变量）。

```
function nextButton() {
    //Next question click event
    $('td').removeClass('highlight-problem');
    var r = randomWord;
    while (r == randomWord) {
        randomWord = Math.floor(Math.random() * (listOfWords.length));
    } 
```

这将分配一个数字，`randomWord`该数字在其他地方用作数组，但在此函数中用作数字。功能也是如此`closeButton`。

# android - 布局edittext cast webview

> ID：13516877
> 
> 赞同：0
> 
> 时间：2012-11-22T16:33:27.880
> 
> 标签：android, android-layout

我会创建这个布局：

[网络浏览]

[编辑文本][按钮]

这是我的布局代码首先我声明一个具有宽度和高度的布局：fill_parent 在我为 webview 声明一个布局最后，我为 EditText 和按钮声明一个布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#3b3b3b"
        android:gravity="center_horizontal"
        android:orientation="vertical" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="#3b3b3b"
        android:gravity="center_horizontal"
        android:orientation="vertical" >

        <WebView
                android:id="@+id/web"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="20dip"
                android:background="#3b3b3b"
                android:gravity="center"
                android:textSize="20dip"
         />

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:background="#3b3b3b"
            android:layout_marginTop="20dip"
            android:gravity="center_horizontal"
            android:orientation="horizontal" >

            <EditText
                android:id="@+id/Response"
                android:layout_width="200dp"
                android:layout_height="wrap_content"
                android:ems="10" />

        <Button
            android:id="@+id/btnSend"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Send" />

        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
```

当我启动活动时，我的应用程序崩溃了:(

```
11-22 16:10:08.036: E/AndroidRuntime(675): FATAL EXCEPTION: main
11-22 16:10:08.036: E/AndroidRuntime(675): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.lgc/com.example.lgc.MyActivity}: java.lang.ClassCastException: android.widget.EditText cannot be cast to android.webkit.WebView 
```

问题是什么 ？

# c - c 编程中的分段错误（核心转储）

> ID：13516878
> 
> 赞同：-1
> 
> 时间：2012-11-22T16:33:37.480
> 
> 标签：c, unix

我有一个简单的 c 应用程序，我有服务器，我首先运行它，然后尝试执行我的 c 程序，我得到这个错误分段错误核心转储。我认为问题可能来自我的分配内存，但不知道它是否来自那里如何修复它： Bellow 是我的代码：

```
 /* This is student.c file which as a part of MAD assignment 1 is referenced and used in main.c */

#include <stdio.h>
#include <stdlib.h>

#include <string.h>

#include "config.h" // auto generated
#include "customer.h"

Customer *make_customer(unsigned id)
{

  Customer *cust;

  if ((cust = (Customer *)malloc(sizeof(Customer))) == NULL) {
    fprintf(stderr, "Failed to allocate Customer structure!\n");
    exit(EXIT_FAILURE);
  }
  cust->active = 0;
  cust->id = id;
  cust->old = NULL;
  cust->address = NULL;
  cust->name = NULL;

  return cust;
}

void free_customer(Customer *cust)
{
  free(cust->old);
  free(cust->address);
  free(cust->name);
  free(cust);
}

void make_customer_active(Customer *cust)
{
  cust->active = 1;
}

void set_customer_old(Customer *cust, char *old)
{
  cust->old = strdup(old);
}

void set_customer_address(Customer *cust, char *address)
{
  cust->address = strdup(address);
}

void set_customer_name(Customer *cust, char *name)
{
  cust->name = strdup(name);
}

int is_customer_active(Customer *cust)
{
  return cust->active;
}

int serialize_customer(char *buffer, Customer *cust)
{
  size_t offset = 0;

  memcpy(buffer, &cust->id, sizeof(cust->id));
  offset = sizeof(cust->id);
  memcpy(buffer+offset, &cust->active, sizeof(cust->active));
  offset = offset + sizeof(cust->active);
  memcpy(buffer+offset, cust->old, strlen(cust->old)+1);
  offset = offset + strlen(cust->old)+1;
  memcpy(buffer+offset, cust->address, strlen(cust->address)+1);
  offset = offset + strlen(cust->address)+1;
  memcpy(buffer+offset, cust->name, strlen(cust->name)+1);
  offset = offset + strlen(cust->name)+1;

  return offset;
}

int deserialize_customer(char *buffer, Customer *cust)
{
  size_t offset = 0;

  memcpy(&cust->id, buffer, sizeof(cust->id));
  offset = sizeof(cust->id);
  memcpy(&cust->active, buffer+offset, sizeof(cust->active));
  offset = offset + sizeof(cust->active);
  memcpy(cust->name, buffer+offset, strlen(buffer+offset)+1);
  offset = offset + strlen(buffer+offset)+1;

  return offset;
}

void print_customer(Customer *cust)
{
  printf("Customer id:%d\n", cust->id);
  printf("Cutomer age:%s\n", cust->old);
  printf("Cutomer name:%s\n", cust->name);
  printf("Cutomer address:%s\n", cust->address);
}

Customer *alloc_blank_customer() 
{

  Customer *cust;

  if ((cust = (Customer *)malloc(sizeof(Customer))) == NULL) {
    fprintf(stderr, "Failed to allocate Customer structure!\n");
    exit(EXIT_FAILURE);
  }
  cust->active = 0;
  cust->id = 0;
  if ((cust->name = malloc(MAX_NAME)) == NULL) {
    fprintf(stderr, "Failed to allocate name!\n");
    exit(EXIT_FAILURE);
if ((cust->old = malloc(MAX_OLD)) == NULL) {
    fprintf(stderr, "Failed to allocate age!\n");
    exit(EXIT_FAILURE);
if ((cust->address = malloc(MAX_ADDRESS)) == NULL) {
    fprintf(stderr, "Failed to allocate address!\n");
    exit(EXIT_FAILURE);
  }

  return cust;
 }}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:40:54.650

您尚未发布完整的程序，因此无法说出您的问题所在。代码中可能导致段错误的一个错误是`alloc_blank_customer`为各种 char 数组分配内存但不初始化它。如果您稍后在这些未初始化的数组上使用字符串处理函数，则效果将是未定义的，并可能发生崩溃。

您可以通过使用`calloc`分配 char 数组来解决此问题：

```
cust->name = calloc(1, MAX_NAME); 
```

或者通过在数组的开头添加一个 nul 终止符：

```
cust->name = malloc(MAX_NAME);
cust->name[0] = '\0'; 
```

# php - 用于产品描述的 Shopify API

> ID：13516879
> 
> 赞同：0
> 
> 时间：2012-11-22T16:33:40.447
> 
> 标签：php, e-commerce, shopify

我正在使用 Shopify PHP API 来更新产品描述。如何使用 API 在我的产品描述中包含文本格式？我喜欢能够在我的产品描述中使用粗体、下划线等格式。非常感谢任何指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-24T22:47:25.217

您可以在修改产品字段时使用 HTML `body_html`，Shopify 将在客户查看该产品描述时呈现格式化版本。

# python - FOR循环范围一次处理一定数量的文件

> ID：13516880
> 
> 赞同：1
> 
> 时间：2012-11-22T16:33:48.603
> 
> 标签：python, loops, range

我有一个 for 循环，它遍历一个目录并处理那里的文件，但我想一次只处理一定数量的文件。例如，我有一个包含 1000 个文件的目录，但我每天只能处理 250 个文件，所以我第一次运行脚本时，它会处理前 250 个文件，然后处理下一个 250 个文件，依此类推。

首先，我将根据记录已同步文件名称的 XML 文件检查文件名，这样我就不会再次处理它们。然后我想处理接下来的 n 个文件，其中我有一个变量`synclimit = n`

我考虑将 in range 语句添加到 for 循环中，如下所示：

```
tree = ET.parse("sync_list.xml")
root = tree.getroot()
synced = [elt.text for elt in root.findall('synced/sfile')]
for filename in os.listdir(filepath) and in range (0, synclimit) :
    if fnmatch.fnmatch(filename, '*.txt') and filename not in synced:
    filename = os.path.join(filepath, filename)
    result = plistlib.readPlist(filename) 
```

但是，我很确定这只会每次检查目录中的前 n 个文件。我应该将范围语句添加到 if 语句吗？喜欢：

```
tree = ET.parse("sync_list.xml")
root = tree.getroot()
synced = [elt.text for elt in root.findall('synced/sfile')]
for filename in os.listdir(filepath):
    if fnmatch.fnmatch(filename, '*.txt') and filename not in synced and in range (0, synclimit):
    filename = os.path.join(filepath, filename)
    result = plistlib.readPlist(filename) 
```

还是有更简单的方法来做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:35:17.400

只需保留一个单独的计数器并增加它，然后测试它是否已达到`synclimit`. 就那么简单。这里不需要太聪明：

```
processed = 0
for filename in os.listdir(filepath):
    if not filename.endswith('.txt') or filename in synched:
        continue
    # process
    processed += 1
    if processed >= synclimit:
        break  # done for today. 
```

或者，由于`os.listdir()`返回一个列表，如果您已经在一组文件名中同步了列表，则可以对其进行过滤，然后将其切成最大大小：

```
synced = set(elt.text for elt in root.findall('synced/sfile'))
to_process = [f for f in os.listdir(filepath) if f.endswith('.txt') and f not in synched]

for filename in to_process[:synclimit]:
    # process 
```

请注意，我只是测试`.endswith('.txt')`而不是使用您的简单文件匹配器；测试归结为同一件事。

# php - php SimpleXML 排序数据键和值。需要找到前 10 个值

> ID：13516887
> 
> 赞同：1
> 
> 时间：2012-11-22T16:34:12.267
> 
> 标签：php, xml, multidimensional-array, simplexml

我有一个 XML 文件，其中包含以下数据……</p>

```
<posts>
  <post id="22359">
    <postviews>31</postviews>
  </post>
  <post id="20963">
    <postviews>1</postviews>
  </post>
  <post id="20595">
    <postviews>3</postviews>
  </post>
  <post id="22640">
    <postviews>72</postviews>
  </post>
  <post id="22227">
    <postviews>1</postviews>
  </post>
...etc etc
</posts> 
```

我想找到前 10 个最高的 postview 值，然后获取父节点 post id，所以我基本上拥有前 10 个 postview 的 id。

我不知道该怎么做，有人可以帮忙吗？如果我通过...加载 XML 文件是否已经是一个数组？</p>

```
$xml = simplexml_load_file($xmlFile); 
```

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:53:48.140

可以通过将每个`post`SimpleXML 元素添加到数组中来完成，然后使用以下命令对该数组进行排序[`usort()`](http://php.net/manual/en/function.usort.php)：

```
function cmp($a, $b){
    if ((int)$a->postviews[0] == (int)$b->postviews[0]) {
        return 0;
    }
    return ((int)$a->postviews[0] > (int)$b->postviews[0]) ? -1 : 1;
}

$xml = simplexml_load_string($xmlStr);

$posts = array();

foreach($xml->post as $p)
{
    $posts[] = $p;
}

usort($posts, "cmp");

// $posts is now sorted by the views

// output them
foreach($posts as $post)
{
  echo "Post ID " . $post->attributes()->id . " has " . (int)$post->postviews . " views\n";
} 
```

如果您只想要前 10 个，那么只需使用`for`循环或添加检查以在前 10 个之后停止循环，或者您可以`unset()`在前 10 个之后的所有内容。

**输出**

> 帖子 ID 22640 有 72 次浏览
> 帖子 ID 22359 有 31 次浏览
> 帖子 ID 20595 有 3 次浏览
> 帖子 ID 22227 有 1 次浏览
> 帖子 ID 20963 有 1 次浏览

**[键盘演示](http://codepad.org/s6MBg9GB)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:43:00.760

编辑：大声笑，您可能想使用 MrCode 的示例而不是我的示例。我完全忘记了 XML 是单独解释的。

好吧，我对 XML 没有任何经验。但无论如何，我会尽力提供帮助。不确定您想如何读取 XML 文件，但我将在此处使用 fgets()：

```
$file_handle = fopen($xmlFile, "r");
$i = 1;
while ($i <= 31) { //We have the inital declaration, then 3 lines per read. 31.
while (!feof($file_handle)) {
   $line = fgets($file_handle);
   echo $line;
$i++;
}
}
fclose($file_handle); 
```

这有帮助吗？

# node.js - 对 Express 上的某些请求禁用 csrf 验证

> ID：13516898
> 
> 赞同：15
> 
> 时间：2012-11-22T16:35:06.857
> 
> 标签：node.js, express, csrf

我正在使用 Express 框架使用 Node.js 编写一个小型 Web 应用程序。我正在使用 csrf 中间件，但我想为某些请求禁用它。这就是我将它包含在我的应用程序中的方式：

```
var express = require('express');
var app = express();

app.use(express.bodyParser());
app.use(express.cookieParser());
app.use(express.cookieSession({secret: 'secret'}));
app.use(express.csrf()); 
```

我想设置一个没有 csrf 控件的 POST 路由。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-22T18:37:19.033

有几种可能的方法。你基本上需要了解什么是最简单最正确的规则来决定是否使用 csrf 中间件。如果您大部分时间都需要 csrf，除了一小部分请求模式的白名单，请按照[我对条件日志中间件的答案](https://stackoverflow.com/a/9351428/266795)中的示例进行操作（为方便起见，复制如下）。

```
var express = require("express");
var csrf = express.csrf();
var app = express.createServer();

var conditionalCSRF = function (req, res, next) {
  //compute needCSRF here as appropriate based on req.path or whatever
  if (needCSRF) {
    csrf(req, res, next);
  } else {
    next();
  }
}

app.use(conditionalCSRF);
app.listen(3456); 
```

另一种方法可能是仅在特定路径上使用中间件，例如`app.post('/forms/*', express.csrf())`. 您只想找到一种表达方式，以便在使用或不使用中间件时使其干净。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-09T02:43:04.137

由于 Express 中间件按顺序执行，因此您始终可以将语句放在代码中的 csrf() 语句之上。

像这样：

```
app.get '/ping', (req, res) -> res.status(200).end()
app.use csrf() 
```

Express 将在您的 csrf 令牌设置之前返回。对于极少数端点（我只有一个适合此类别的端点），我发现这是一种更清洁的解决方案。

此外，在撰写本文时，上述答案的代码如下所示：

```
customCsrf = (req, res, next) ->
  if req?.url isnt '/ping'
    return csrf()(req, res, next)
  else
    return next()

app.use customCsrf 
```

那个额外的（req，res，next）让我绊倒了一段时间，所以希望这对某人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T21:25:10.837

[dailyjs.com](http://dailyjs.com/2012/09/13/express-3-csrf-tutorial/)有一篇关于 csrf 和 express 的好文章。它基本上是这样工作的：

使用 csrf 中间件：

```
app.configure(function() {
  // ...
  app.use(express.csrf());
  // ..
}); 
```

创建一个自定义中间件，将局部变量`token`设置为 csrf 值：

```
function csrf(req, res, next) {
  res.locals.token = req.session._csrf;
  next();
} 
```

在您想要的每条路线中使用您的自定义中间件：

```
app.get('/', csrf, function(req, res) {
  res.render('index');
}); 
```

在您的表单中创建一个包含 csrf 值的隐藏字段：

```
form(action='/contact', method='post')
  input(type='hidden', name='_csrf', value=token) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-22T16:26:24.317

使用 express 应用级别的中间件将每个 HTTP 方法添加到忽略列表中，以确保默认情况下**不会**验证保护。

例如

```
const ignoredMethods = [
    'GET',
    'HEAD',
    'POST',
    'PUT',
    'DELETE',
    'OPTIONS'
]

const csrfInit = csurf({ignoredMethods, cookie: true });
app.use(csrfInit); 
```

这会将 csrfToken() 方法注入到每个请求对象中，从而允许应用程序设置隐藏字段或可消耗的 cookie。

然后在你的 as 中间件中添加一个受保护的版本到所需的路由，并忽略不需要它的那些。

例如受保护

```
const csrfProtection = csurf({ cookie: true });

router.post('/api/foo', csrfProtection, (req, res, next) => ... 
```

例如未受保护的

```
const csrfProtection = csurf({ cookie: true });

router.post('/api/foo', (req, res, next) => ... 
```

这对我有用。

# objective-c - 关于objective-c中类扩展和继承的问题

> ID：13516905
> 
> 赞同：1
> 
> 时间：2012-11-22T16:35:20.647
> 
> 标签：objective-c, class-extensions

我没有什么特别要实现的，但我正在尝试更多地了解类扩展。

这是直接来自[苹果类别和扩展](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)的类扩展的解释：

```
@interface MyClass : NSObject
@property (retain, readonly) float value;
@end

// Private extension, typically hidden in the main implementation file.
@interface MyClass ()
@property (retain, readwrite) float value;
@end 
```

但是，假设我有一个扩展 MyClass 的 MyClass2，这对我来说确实很有意义：

```
@interface MyClass2 : MyClass
@property (retain, readwrite) float value;
@end 
```

所以我有几个问题，如果不涉及类扩展，我可以很容易地回答：

*   在运行时，当我在**MyClass中进行赋值****self.value=2**或只是调用**float x=self.value**时，调用了哪个 setter 和 getter @property？MyClass 还是 MyClass2 ？
*   编译器不应该至少发出关于重新定义只读属性的警告吗？
*   我知道@property 由 ivar 支持，那么到底有多少 ivar？与此相关，从**MyClass2**的角度调用相同的 self.value 哪个 ivar 会设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:53:51.453

首先，属性应该是“分配”而不是“保留”，因为它们是标量类型。

更改类扩展或子类中的可写性是分别实现公开只读但私有可写属性和不可变类的可变子类的常见模式。Apple Objective-C Programming Guide 有一个[很好的讨论](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/objectivec/chapters/ocproperties.html "很好的讨论")。

要回答您的第一个问题，只有在 MyClass 或其任何超类中声明的方法在 MyClass 中是可见的。您的私有类扩展在实现范围内声明了 setter，因此将调用它。MyClass2 接口中的 readwrite 声明只是将 setter 带入公共范围。实现仍在 MyClass 中。

您的第二个问题的答案是否定的，不会发出警告。将可写性从只读更改为读写是有效的。

最后，只有一个 ivar。从 MyClass2 访问它会影响 MyClass 中可见的相同 ivar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T17:20:28.577

你不能`retain`一个`float`. 换个方式写吧`(readonly)`。

`MyClass`对 的一无所知`MyClass2`，这似乎是 的子类`MyClass`。当你写的时候`self.value = 2`，它会被转换成`[self setValue:2]`，代码会从 MyClass 开始，寻找`setValue`方法。这将被创建，因为您将其定义`value`为属性。setter 方法看起来像

```
-(void) setValue:(int newValue) {
      _value = newValue; // _value is the actual storage for the property value
} 
```

并且该变量`_value`将是`MyClass`您正在执行的对象实例中分配的变量。

实际上只有一个 iVar。如果， In `MyClass2`，你写

```
self.value = 3;
super.value = 4;
float myFloat = self.value; 
```

`myFloat`最终等于 4。

大概编译器不会抱怨重新定义属性 in`MyClass`因为这是一件非常合理的事情。这样，其他类无法写入`value`，但在 内`MyClass`，您可以写入`self.value = 2;`并且它会起作用。

我确实相信有两个 iVar，但我错了。很抱歉让任何人感到困惑。感谢 Martin R 和 BradS 对我的教育。

# jquery - jQuery 在第一次悬停时不适用于下拉菜单

> ID：13516915
> 
> 赞同：0
> 
> 时间：2012-11-22T16:36:33.827
> 
> 标签：jquery, html, css, drop-down-menu, navigation

我使用 CSS 创建了一个简单的下拉菜单，并希望使用 jQuery 创建一个淡入淡出。淡入淡出有效，但只有在您将鼠标悬停在列表元素上两次之后。第一次悬停没有淡入淡出效果。

这是HTML代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>dropdown_2</title>

    <link href="css/dropDrownNav.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            $("#nav li").has("ul").hover(function () {
                $(this).addClass("current").children("ul").fadeIn(500);
            }, function () {
                $(this).removeClass("current").children("ul").stop(true, true).css("display", "none");
            });

        });
</script>

</head>
<body>

   <!--begin added nav-->
    <div id="main-navigation" >
        <div id="nav">
        <ul>
            <li class="first"><a href="#">Home</a>
            <ul>
                <li><a href="#">Home1</a></li>
                <li><a href="#">Home2</a></li>
                <li><a href="#">Home3</a></li>
            </ul>
            </li>
            <li><a href="#">About Me</a>
            <ul>
                <li><a href="#">About Me1</a></li>
                <li><a href="#">About Me2</a></li>
                <li><a href="#">About Me3</a></li>
            </ul>
            </li>
            <li><a href="#">Portfolio</a>
            <ul>
                <li><a href="#">Web</a></li>
                <li><a href="#">Print</a></li>
                <li><a href="#">Photos</a></li>
            </ul>
            </li>
            <li><a href="#">Contact Me</a>
            <ul>
                <li><a href="#">Contact Me1</a></li>
                <li><a href="#">Contact Me2</a></li>
                <li><a href="#">Contact Me3</a></li>
            </ul>
            </li>
        </ul>
        </div>
    </div><!--end main navigation-->
    <!--end added nav-->

</body>
</html> 
```

CSS 代码：

```
*{ margin:0px; padding: 0px; }

#nav {
     font-family: arial, sans-serif;
     position: relative;
     width: 390px;
     height:56px;
     font-size:14px;
     color:#000;
     margin: 0px auto;
}

#nav ul {
     list-style-type: none;
}

#nav ul li {
     float: left;
     position: relative;
}

#nav ul li a {
     text-align: center;
     border-right:1px solid #000;
     padding:20px;
     display:block;
     text-decoration:none;
     color:#000;
}

#nav ul li ul {
     display: none
}

#nav ul li:hover ul {
     display: block;
     position: absolute;
}

#nav ul li:hover ul li a {
     display:block;
     background:#12aeef;
     color:#ffffff;
     width: 110px;
     text-align: center;
     border-bottom: 1px solid #f2f2f2;
     border-right: none;
}

#nav ul li:hover ul li a:hover {
     background:#6dc7ec;
     color:#fff;
} 
```

链接到一个[工作示例](http://ken-shoufer.com/navtest/testNav1.html)。

谢谢，肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:41:03.447

尝试从这行 css 中删除 display:block ...

```
#nav ul li:hover ul {
 display: block;
 position: absolute;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:43:07.103

我在您的淡入淡出行中添加了一个 show().hide() ，它似乎像这样工作：

```
$("#nav li").has("ul").hover(function () {
    $(this).addClass("current").children("ul").show().hide().fadeIn(500);             
}, function () {                 
    $(this).removeClass("current").children("ul").stop(true, true).css("display", "none");           
}); 
```

[http://jsfiddle.net/ewQB2/1/](http://jsfiddle.net/ewQB2/1/)

# ios - iOS，如何在“元数据和上传”中添加阿拉伯语

> ID：13516917
> 
> 赞同：1
> 
> 时间：2012-11-22T16:36:47.307
> 
> 标签：ios, metadata, arabic

除了默认的英语语言之外，我还想在我的应用程序的“元数据和上传”中添加阿拉伯语。我单击“英语（默认）”下拉列表，但在那里找不到阿拉伯语。是因为它是从右到左的语言吗？

我在我的应用程序中添加了阿拉伯语 localizable.strings，现在需要在这个 itunesconnect 页面中添加这种语言，以便我的应用程序可以以阿拉伯语列出。

任何的想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T06:03:46.913

Apple 仍然不支持将阿拉伯语作为 iTunes Connect 中的本地化语言。尽管 iOS 应用程序提供了对阿拉伯语的本地化支持，但目前仍不支持以阿拉伯语查看 App Store 元数据页面。

最好的办法是暂时在英文详细信息下方包含阿拉伯语翻译。

# c# - MVC 4 - 在同一页面上返回子详细信息

> ID：13516923
> 
> 赞同：0
> 
> 时间：2012-11-22T16:37:22.037
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我刚刚正确地进入 MVC，我被困在一个我认为相对简单的概念上。

所以，我有一个表格，其中发布到控制器（这很好），此时我有：

**控制器**

```
public ActionResult TestAction(int productId)
{
    // What to do here... ?
    return View();
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult TestAction(FormCollection values)
{
    // Do work here and return the objects
    return View(Products);
} 
```

**看法**

```
@foreach (var product in Model)
            {
                <tr>
                    <td>@product.Provider.Name</td>
                    <td>&pound;@product.MonthlyPremium</td>
                    <td>@Html.ActionLink("More Details", "TestAction", new { productId = product.ProductId })</td>
                    <td>Compare</td>
                </tr>
            }

// I want the singular product details to be displayed here, under the product list... but how?! 
```

现在，我想要的是当您单击“更多详细信息”（ActionLink）时，将显示产品详细信息，它们是单个 Product 对象的一部分。我从 GET 中调用了 TestAction 控制器，但是如何保留产品视图并显示单个产品的详细信息？将这个单一的产品分配给 ViewBag 并这样做？那么，对于产品列表，缓存原始列表并使用该缓存？

我希望通过回发来完成此操作，因为这是针对我网站的非 JS 版本的。

当然必须有更好的方法来做到这一点，或者我是不是已经被 ViewState 养得太久了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T16:45:59.070

您可以为模型添加一个属性，例如`bool ViewDetail`，并在控制器中为与参数对应的项目设置该属性`productId`：

```
public ActionResult TestAction(int productId)
{
    // TODO: error checking
    Products.Single(m => m.ProductId == productId).ViewDetail = true;
    return View(Products);
} 
```

并将其显示在您的视图上：

```
var productDetail = Model.SingleOrDefault(m => m.ViewDetail == true);
if (productDetail != null)
{
    // Display product details
} 
```

或者您可以更改您的模型以包含：

```
public class ProductsWithDetailModel
{
    public IEnumerable<Product> Products { get; set; }  // to loop over and display all products
    public Product DetailProduct { get; set; }          // to display product details, if not null
} 
```

然后再次`DetailProduct`根据`productId`参数设置，如果不为null，则显示在视图中。

# javascript - 如何在 Firefox 扩展上使用 visibilitychange 事件

> ID：13516929
> 
> 赞同：1
> 
> 时间：2012-11-22T16:37:47.447
> 
> 标签：javascript, firefox-addon, dom-events

我正在尝试学习如何制作 Firefox 扩展。我想创建一个只显示在特定页面上的工具栏。我可以使工具栏出现，但是当我打开或切换到新选项卡或关闭具有该特定页面的选项卡时，它应该被隐藏。不过，我不明白如何使`visibilitychange`活动正常进行，无论我尝试什么，都没有任何反应。

```
window.addEventListener("load", function load(event){
  window.removeEventListener("load", load, false);
  myExtension.init();  
},false);

var myExtension = {

  init: function (aEvent) {
    gBrowser.addEventListener("DOMContentLoaded", this.showToolbar, false);
  },

  showToolbar: function(aEvent) {
    var doc = aEvent.originalTarget;

    if(doc.location.href=="http://www.google.ca/"){
      eToolbar=document.getElementById("nav-toolbar");
      eToolbar.hidden=false;

      //no matter how I change this line below it never does anything
      gBrowser.addEventListener("mozvisibilitychange", this.toggleToolbar, false);
    }
  },

  toggleToolbar: function(aEvent) {
    eToolbar=document.getElementById("nav-toolbar");
    if(document["mozVisibilityState"]=="mozHidden"){
        eToolbar.hidden=true;
    } else {
        eToolbar.hidden=false;
    }
  } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T18:48:32.433

`mozVisibilityState`可以是`visible`或`hidden`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T02:07:37.767

我设法通过使用 TabSelect 事件来达到预期的效果。

```
window.addEventListener("load", function load(event){
   window.removeEventListener("load", load, false);
   myExtension.init();  
},false);

var myExtension = {

   init: function (aEvent) {
      gBrowser.addEventListener("DOMContentLoaded", this.showToolbar, false);
   },

   showToolbar: function(aEvent) {
      var doc = aEvent.originalTarget;

      if(doc.location.href=="http://www.google.ca/"){
         eToolbar=document.getElementById("nav-toolbar");
         eToolbar.hidden=false;

         var container = gBrowser.tabContainer;
         container.addEventListener("TabSelect", myExtension.toggleToolbar, false);
      }
   },

   toggleToolbar: function(aEvent) {
      eToolbar=document.getElementById("nav-toolbar");
      if(window._content.document.location.href=="http://www.google.ca/"){
         eToolbar.hidden=false;
      } else {
         eToolbar.hidden=true;
      }
   } 
} 
```

# html - 防止光标在文本输入上移动

> ID：13516931
> 
> 赞同：0
> 
> 时间：2012-11-22T16:37:51.893
> 
> 标签：html, internet-explorer, input

我有一些文本输入，当它们处于焦点时我称之为 JS 函数。基本上这个函数改变了这个字段的值。当我这样做时，在 IE 上，光标移动到我输入的左端。这在 Firefox 中不会发生。它只是停留在我把它放在首位的地方。

```
<input maxlength="5"  type="text" onFocus=\"changeValueOnFocus(this);\">";

function changeValueOnFocus(myInput){
  myInput.value = 1234;
} 
```

有没有办法避免这种情况？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T17:25:24.720

而`onfocus`不是 use `onfocusin`，这将使您的代码正常工作。

**编辑**

我刚刚意识到，Firefox 中没有`focusin`。因此，您需要更重的东西。

剧本：

```
function changeValueOnFocus (e, elm) {
        elm = elm || this;
        elm.value = 1234;
        return;  
}

window.onload = function () {
    if (window.onfocusin === undefined) {
        document.getElementById('someinput').addEventListener('focus', changeValueOnFocus, false);
    }
    return;
} 
```

`input`你需要一个`id`：

```
<input id="someinput" maxlength="5" onfocusin="changeValueOnFocus(event, this);" type="text" /> 
```

现在这应该是一个跨浏览器的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T17:09:22.980

将光标移动到文本框的末尾修改您的函数，如下所示：

```
 function changeValueOnFocus(myInput) {
     myInput.value = 1234;

     //use this function to select text but in this case just to move cursor to the end 

         myInput.setSelectionRange(myInput.value.length, myInput.value.length);

 } 
```

# java - 如何使用 JFileChooser 在 JFrame 中上传和显示图像

> ID：13516939
> 
> 赞同：4
> 
> 时间：2012-11-22T16:38:44.123
> 
> 标签：java, jfilechooser

我需要上传并显示用 .. 选择的图像`JFileChooser`（即用户想要设置他/她的个人资料图片）`JFrame`。我应该怎么做？

这是我选择文件的代码：

```
private void UploadImageActionPerformed(java.awt.event.ActionEvent evt) {
    int returnVal = fileChosser.showOpenDialog(this);
    if (returnVal == JFileChooser.APPROVE_OPTION) {
        File file = fileChosser.getSelectedFile();
        // What to do with the file
        // I want code for this part
        try {
            //code that might create an exception 
        } 
        catch (Exception e1) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T08:45:45.063

我自己解决了。我选择了一张图片并显示在`JLabel`.

这是我的代码：

```
private void uploadImageActionPerformed(java.awt.event.ActionEvent evt) {                                            
    JFileChooser filechooser = new JFileChooser();
    filechooser.setDialogTitle("Choose Your File");
    filechooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
    // below code selects the file 
    int returnval = filechooser.showOpenDialog(this);
    if (returnval == JFileChooser.APPROVE_OPTION)
    {
        File file = filechooser.getSelectedFile();
        BufferedImage bi;
        try {
            // display the image in a Jlabel
            bi = ImageIO.read(file);
            jLabel1.setIcon(new ImageIcon(bi));
        } catch(IOException e) {
           e.printStackTrace(); // todo: implement proper error handeling
        }
        this.pack();
    }
} 
```

# objective-c - 在具有自定义背景的 UIPopoverController 中 UITableView 性能不佳

> ID：13516943
> 
> 赞同：1
> 
> 时间：2012-11-22T16:39:11.383
> 
> 标签：objective-c, ios, ipad, uitableview, uipopovercontroller

我有以下情况（在 iPad、iOS 5.1 上测试）：

1.  里面有一个带有 UINavigationController 的 UIPopoverController 和自定义弹出背景视图（UIPopoverBackgroundView 的子类）。
2.  导航控制器中有一个通用的 UIViewController（我们称之为 VC1）作为根 VC。
3.  我在导航控制器堆栈上使用 UITableView 推送另一个 UIViewController (VC2)。

效果：表格滚动不稳定（看起来像 10-15 fps）。出于测试目的，我使用了一个最简单的 UITableView，没有图像等，所以它不是由错误的 UITableView 实现引起的。

*   如果 VC2 是 Navigation Controller 的根视图控制器，即使使用自定义 Popover 背景，滚动也不会断断续续。
*   如果作为第二个 VC 推送，它也不会不稳定，但我没有为 UIPopoverController 使用自定义 bg 视图类。

我在我的 UIPopoverBackgroundView 子类中记录了每个被覆盖的方法，并且它们不会被不断地调用或任何东西，理论上这可能会导致性能下降。我将进一步调试问题，但也许有人已经解决了它？

或者也许有人对如何找到罪魁祸首有很好的建议？我尝试查看时间分析器以查找有问题的函数调用，但在那里我没有找到太多...

# javascript - 在 Ie 7 上导出画布图像

> ID：13516945
> 
> 赞同：1
> 
> 时间：2012-11-22T16:39:19.377
> 
> 标签：javascript, internet-explorer, activex

[我们使用flot](http://people.iola.dk/olau/flot/examples/)开发了一个复杂的报告应用程序，但是我没有预见到的是我们将在输出方面遇到问题，尽管一切看起来和工作都很酷商业用户无法在他们的演示文稿中复制图表，因为输出是画布元素。

我已经寻找了几种方法，我什至找到了将画布转换为图像的方法，但这仅适用于支持 HTML5 的浏览器，不幸的是我们的用户使用 IE7 我知道这很旧但我无能为力（相信我，我们试过）所以我必须想出一个解决方案来将图形导出为图像格式。

我最后一次尝试是使用 fxcanvas 和 flashcanvas 来模拟 toDataURL 方法，但结果是有一个 32kb 的缓冲区，其中我的图像至少为 300kb。

业务用户（高层管理人员）正在推动解决方案，他们显然不明白这里存在​​技术界限，我对任何不涉及以下内容的解决方案持开放态度：

*   升级/更改浏览
*   安装chrome tab之类的插件。
*   在服务器或用户机器上安装 cab 文件

但是，我对任何 Active X 解决方案或任何不需要安装 3rd 方程序的导出选项持开放态度（除了 MS 库，它们不需要执行任何附加步骤，如注册库）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-02T05:38:58.020

基本的方法是使用`canvas.toDataURL("image/png");`，但我也为你找到了这个链接

[http://nihilogic.dk/labs/canvas2image/](http://nihilogic.dk/labs/canvas2image/)

我没有测试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:57:09.007

如果您希望用户获得相同的结果（或至少尽可能接近），为什么不尝试依赖后端？（假设有）只需在后端生成图像并输出标准 jpg 或 png .

我真的想不出另一种解决方案，即使 SVG 仅在 IE7+ 上兼容，不使用后端的最接近的解决方案是使用 flash，因为它是第三方，但它是众所周知的，并且它内置在现代浏览器中。

依赖客户端总是涉及到：要求他们升级浏览器/使用第三方插件，所以在未来的项目规划中要注意，兼容性问题是我认为Web开发中最烦人的问题之一

# .net - FluentNHibernate 实体本地化

> ID：13516946
> 
> 赞同：0
> 
> 时间：2012-11-22T16:39:21.653
> 
> 标签：.net, localization, fluent-nhibernate

首先，我研究了一些像[这样](http://blogs.planetcloud.co.uk/mygreatdiscovery/post/Localizing-entities-with-NHibernate.aspx)的解决方案 现在，我正在尝试实现这样的目标：

```
public class Article : Entity 
{
   public int ID {get;set;}
   public CultureInfo Culture {get;set;}
   public DateTime PublishedOn {get;set;}
   public string Title {get;set;}
} 
```

现在这里是事实：

1.  ID 是唯一标识符
2.  文化应该区分不同的文化版本
3.  Title 属性应该本地化（每种文化一个 raw）
4.  PublshDate 不应本地化，因为它对所有文化都相同

现在，这就是我需要的：

1.  每个实体只使用一个类：我不想要“Article”和“ArticleLocal”类
2.  提供系统让 NHibernate 为实体获取适当的原始文化（基于当前文化的 soem 全局属性）
3.  如果可能，强制 NHibernate 在初始化时自动创建本地表。

我的想法是使用属性，但不确定是否已经有经过验证的解决方案。这是想法：

```
[LocalizedEntity]
public class Article : Entity 
{
   public int ID {get;set;}
   [LocalizedCulture("CultureID")]
   public CultureInfo Culture {get;set;}
   public DateTime PublishedOn {get;set;}
   [Localized("Title")]
   public string Title {get;set;}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T08:28:52.427

这个问题不时出现，我会建议一些没有太多魔法的东西

*   [https://stackoverflow.com/a/12495858/671619](https://stackoverflow.com/a/12495858/671619)
*   [https://stackoverflow.com/a/11289016/671619](https://stackoverflow.com/a/11289016/671619)

这样做的好处是实现回退和添加本地化非常容易

# google-app-engine - 如何在 jstl 标签内建立与数据存储的连接

> ID：13516947
> 
> 赞同：0
> 
> 时间：2012-11-22T16:39:27.030
> 
> 标签：google-app-engine, jsp, jstl, google-cloud-datastore

我正在 Google App Engine 上创建一个项目，并且在我的一个 jsp 文件中，我想在我的数据存储中搜索一个条目。我通常通过单击此 jsp 页面上的按钮来执行此搜索，然后在 servlet 中建立与数据存储的连接，然后将查询结果发送回 jsp。好吧，我想在不单击此按钮的情况下查询数据存储。当我加载页面时，我想在我的页面上看到查询结果。当我使用 EL 标签库时，我只需键入 <% %> 即可，现在我使用的是 jstl 标签库。那么有什么办法吗？使用 jstl 标签后，我无法使用 EL 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T15:27:16.460

> *好吧，我想在不单击此按钮的情况下查询数据存储*

创建一个 servlet，它在方法中执行工作`doGet()`，转发到一个 JSP，该 JSP 显示结果，只调用 servlet 的 URL 而不是 JSP 的 URL。这与您在提交表单时所做的完全相同`doPost()`，但不需要传递/收集请求参数。

### 也可以看看：

*   [我们的 Servlets wiki 页面](https://stackoverflow.com/tags/servlets/info)- 第二个 Hello World 示例完全符合您的要求。

* * *

**与具体问题无关**，这些`<% %>`东西（“scriptlet”）绝对与 EL 无关。EL就是那些`${}`东西。

### 也可以看看：

*   [我们的 JSTL 维基页面](https://stackoverflow.com/tags/jstl/info)
*   [我们的 EL 维基页面](https://stackoverflow.com/tags/el/info)

# vba - VBA中的错误，我不知道为什么，请告知

> ID：13516951
> 
> 赞同：-1
> 
> 时间：2012-11-22T16:39:48.910
> 
> 标签：vba, excel

我正在尝试在 VBA 中编写一个可以将成员添加到 excel 的系统。目前这很简单，我真的不知道为什么会出现这个错误......我已经编写了类似的 subs 和函数来将其他实体添加到我的数据库中并且它们没有问题......但是当我尝试添加一个新的“成员”我收到此错误消息“应用程序定义或对象定义错误”。这是代码，并提前感谢任何可以提供建议的人。

```
Sub Member_Sign_Up(MemberId As String)
Dim FirstName As String
Dim LastName As String
Dim PCode As String
Dim NumberOnLoan As String
Dim NextRM As Integer

With Range("A1:F1").Font
    .Bold = True
    End With

Worksheets("Members").Cells(1, 1) = "First Name"            'Set up the headings for the member fields
Worksheets("Members").Cells(1, 2) = "Last Name"             'Also set the font to bold
Worksheets("Members").Cells(1, 3) = "Post Code"
Worksheets("Members").Cells(1, 4) = "Number of Books on Loan"
Worksheets("Members").Cells(1, 5) = "Member ID"
Worksheets("Members").Cells(1, 6) = "Number of Members"

NextRM = Worksheets("Members").Cells(2, 6) + 2              'NextR is the next available row for new data (using the number of different Members to determine when the next free row is)

FirstName = InputBox("First Name?")
LastName = InputBox("Last Name?")
PCode = InputBox("Your Postcode (without spaces)?")

Worksheets("Members").Cells(2, 6) = Worksheets("Members").Cells(2, 6) + 1  'update the Members sheet "number of Members"

Worksheets("Members").Cells(NextRB, 1) = FirstName
Worksheets("Members").Cells(NextRB, 2) = LastName                  'update the Members sheet
Worksheets("Members").Cells(NextRB, 3) = PCode
Worksheets("Members").Cells(NextRB, 5) = MemberId

End Sub

Sub Attempt_Sign_Up()
Dim i As Integer
Dim MemberId As String

MemberId = InputBox("Enter a prefered member ID, it must contain at least five letters and two numbers.")
If Not Check_Member_Exists(MemberId) Then 'And Check_MemberId_Valid(MemberId)
Member_Sign_Up (MemberId)
Else
    MsgBox ("Member with ID " & MemberId & " is already taken or is not valid")
End If

End Sub

Function Check_Member_Exists(MemberId As String) As Boolean

Dim i As Integer
Dim Member_Found As Boolean

Member_Found = False                                      'Set Member_Found to false so that if it becomes true we know a member with that ID already exists
i = 0
Do                                                        'Look through all the cells in Books worksheet with i as the index
    i = i + 1
    If Worksheets("Members").Cells(i, 6) = MemberId Then
        Member_Found = True                                 'Check to see if we've found the ISBN
    End If
Loop Until Member_Found Or i = Worksheets("Members").Cells(2, 6) + 2
Check_Member_Exists = Member_Found

End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:57:39.327

在更新成员表（等）时将变量的名称更改`NextRM`为`NextRB`您调用的名称，它对我有用。`Worksheets("Members").Cells(NextRB, 1) = FirstName`

# c# - 测试 NHibernate 地图

> ID：13516952
> 
> 赞同：2
> 
> 时间：2012-11-22T16:39:51.540
> 
> 标签：c#, nhibernate, orm, fluent-nhibernate, nhibernate-mapping

测试 NHibernate 映射类的最佳方法是什么？

假设我想测试以下地图：

```
public QuoteMap()
{
    this.Table("QUOTE");
    this.Id(x => x.Id).Column("QUOTE_ID").GeneratedBy.Sequence("SEQ_QUOTE_ID");
    this.Map(x => x.IsDeleted).Column("IS_DELETED");
    this.References(x => x.Proposal).Column("PROPOSAL_ID");
} 
```

其中`Proposal`type 映射到另一个表。

QUOTE 表如下所示：

```
CREATE TABLE "QUOTE"
  (
    "QUOTE_ID"    NUMBER(18,0) NOT NULL,
    "PROPOSAL_ID" NUMBER(18,0) NOT NULL ENABLE,
    "IS_DELETED"  NUMBER(1,0) DEFAULT 0 NOT NULL ENABLE,

    CONSTRAINT "PK_QUOTE" PRIMARY KEY ("QUOTE_ID"),
    CONSTRAINT "FK_QUOTE_PROPOSAL" FOREIGN KEY ("PROPOSAL_ID") REFERENCES
        "PROPOSAL" ("PROPOSAL_ID") ENABLE
  ) 
```

**选项1：[持久性规范](https://github.com/jagregory/fluent-nhibernate/wiki/Persistence-specification-testing)**

```
new PersistenceSpecification<Quote>(session, new CustomEqualityComparer())
    .CheckProperty(c => c.TenantId, 1)
    .CheckProperty(c => c.IsDeleted, false)
    .CheckReference(
        c => c.Proposal,
        new Proposal
            {
                Id = 1,
                IsDeleted = false,
                TenantId = 1,
                VersionNumber = 1,
                OutletId = 1,
                StatusId = "TST"
        })
    .VerifyTheMappings();
transaction.Commit(); 
```

...此测试将失败，但出现以下异常：

> NHibernate.Exceptions.GenericADOException: 无法插入：[Quote#18][SQL: INSERT INTO QUOTE (IS_DELETED, PROPOSAL_ID, QUOTE_ID) VALUES (?, ?, ?)] ---> Oracle.DataAccess.Client.OracleException: ORA -02291: 违反完整性约束 (PROPOSALOWN.FK_QUOTE_PROPOSAL) - 未找到父键

...因为它依赖于提案记录的`Id = 1`存在。另一个问题是，如果您恰好映射`PropertyA`到`ColumnB`并且`PropertyB`您`ColumnA`的测试将通过并且不会指出您的错误。

**选项 2：原始 SQL 到 INSERT，NHibernate 到 SELECT** 现在这将是理想的：您通过发出原始 SQL 语句来插入，例如

```
INSERT INTO QUOTE (QUOTE_ID, PROPOSAL_ID, IS_DELETED) 
  SELECT SEQ_QUOTE_ID.NextVal, 1, 0 from dual; 
```

然后您使用 Nhibernate 阅读并检查值。问题再次是依赖于 PROPOSAL 记录的存在。插入此测试的提案记录？当然！但是，Proposal 表有另一组 FOREIGN KEYS，因此您可能最终将 ROWS 插入到几十个表中，只是为了测试您的映射……不喜欢！

当然有更好、更简单的方法来测试 NHibernate Maps。你能推荐一个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:52:44.610

您应该`CheckReference`用于提案：

```
.CheckReference(
        c => c.Proposal,
        new Proposal
            {
                IsDeleted = false,
                TenantId = 1,
                VersionNumber = 1,
                OutletId = 1,
                StatusId = "TST"
        }) 
```

# where-clause - 相当于 indexeddb 中的 where 子句

> ID：13516955
> 
> 赞同：4
> 
> 时间：2012-11-22T16:40:17.007
> 
> 标签：where-clause, indexeddb

假设我们有一个用于 todolist 的数据库，并且想要查询所有重要且尚未完成的项目。在 SQL 中，我将使用类似

```
SELECT * FROM todolist WHERE important = true AND state <> 'done' 
```

我们如何在 indexeddb nosql 数据库中执行这种类型的请求？有索引吗？其他方式？不可能？

据我所知，过滤结果`important = true`：

```
objectstore.index('important').openCursor(IDBKeyRange.only('true')) 
```

但我不知道如何过滤，`state <> 'done'`因为我们只有`IDBKeyRange.only(z)`.

而且我不知道如何过滤这两个子句。

注意：在 MongoDB 中，我们这样做：

```
db.userdetails.find({"date_of_join" : "16/10/2010","education":"M.C.A."}) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-25T21:58:12.667

在 onupgradeneeded 中，根据使用数组的条件创建索引：

```
todolistStore.createIndex('importantIncomplete', ['important','state'],{unique:false}); 
```

对于您的查询，请执行以下操作：

```
var lowerBound = ['true','started'];
var upperBound = ['true','almostdone'];
var range = IDBKeyRange.bound(lowerBound,upperBound);
var request = todolistStore.index('importantIncomplete').openCursor(range); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T05:05:06.323

在 IndexedDB 中查询多个索引有两种方法。Josh 描述了使用复合索引查询多个字段的最快方法。然而，它有存储成本和减慢写入速度。此外，查询必须是先验已知的，因此根据需要创建索引。第二种方法是使用排序合并或其他算法手动键连接。这种方法需要对感兴趣的字段进行索引（不是复合的），并且可以进行所有组合查询。请参阅此处[http://dev.yathit.com/ydn-db/nosql-query.html](http://dev.yathit.com/ydn-db/nosql-query.html)以了解 ydn-db 库中的排序合并、嵌套循环和之字形合并实现。我参加添加更多的关键加入算法。

顺便说一句，通常我们不索引布尔值。如果您的查询字段是布尔数据类型，只需进行表扫描。不指向使用索引。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-11-22T18:55:16.880

为此，您将需要索引，并且您可以使用可以提供一个过滤器的游标来检索数据。

在我的博客（[http://www.kristofdegrave.be/2012/01/indexed-db-reading-multiple-records.html?m=1](http://www.kristofdegrave.be/2012/01/indexed-db-reading-multiple-records.html?m=1)）上，您可以找到有关它的更多信息。

# java - 如何在 Java 客户端中使用 WCF 流服务？

> ID：13516958
> 
> 赞同：8
> 
> 时间：2012-11-22T16:40:37.203
> 
> 标签：java, wcf, stream, interop

我正在开发一个 java 客户端来使用下面的 WCF 服务。由于 WCF 服务使用的是 Stream 技术，我也希望在 java 客户端代码中使用 Stream 技术来减少内存使用。有没有人可以给我一个关于如何写它的建议？谢谢。

```
namespace TmpWcfStream
{
    [MessageContract]
    public class InputMessage
    {
        [MessageHeader(MustUnderstand = true)]
        public string TranName { get; set; }

        [MessageBodyMember(Order=1)]
        public Stream FileData { get; set; }
    }

    [MessageContract]
    public class OutputMessage
    {
        [MessageBodyMember(Order = 100)]
        public bool Success { get; set; }

        [MessageBodyMember(Order = 200)]
        public string ErrorMsg  { get; set; }
    }
}

namespace TmpWcfStream
{
    public class UploadDataSvc : UploadSvcContract
    {
        private const int bufferLen = 4096;

        public OutputMessage UploadData(InputMessage msg)
        {
            OutputMessage outputMsg = new OutputMessage { ErrorMsg = string.Empty, Success = true };

            try
            {
                Stream inputStream = msg.FileData;
                String filePath = @"C:\tmp\output.txt";

                using (FileStream targetStream = new FileStream(filePath, FileMode.Create, FileAccess.Write, FileShare.None))
                {
                    byte[] buffer = new byte[bufferLen];
                    int count = 0;
                    while ((count = inputStream.Read(buffer, 0, bufferLen)) > 0)
                    {
                        targetStream.Write(buffer, 0, count);
                    }
                }
                inputStream.Close();
            }
            catch(Exception e)
            {
                outputMsg.Success = false;
                outputMsg.ErrorMsg = e.ToString();
            }

            return outputMsg;
        }
} 
```

# c++ - pthread_cond_wait 和 pthread_cond_signal 的性能

> ID：13516959
> 
> 赞同：0
> 
> 时间：2012-11-22T16:40:51.983
> 
> 标签：c++, linux, pthreads, signals, wait

我有两个线程。从队列中读取的一个。我不希望它在 while(1) 上运行以读取，所以我正在考虑在每次循环时给它一个条件变量：

```
while(1){
    while queue is not empty
        wait(cond)
        pop() 
} 
```

代替：

```
while(1){
  while queue is not empty
      pop
} 
```

和一个推送到队列的线程。如果我使用等待和信号方法，那么该线程需要通过每次推送弹出线程来通知（！）它推送问题是什么更好用？如果队列大部分不是空的，那么发送信号是没有价值的（或者不是？）因为弹出线程没有等待，我担心它会降低性能。但是，如果队列有一半时间是空的，那么像第二种 pop 方法那样循环它可能是一个忙碌的等待。

我希望这里的某个人会通过取消向没有等待它的线程发送信号仍然可以的事实来消除我的恐惧

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T18:19:52.560

首先只是为了确定，`pthread_cond_signal`不发送一个意义上`signal`的。`signal(2)`它只是标记条件变量并释放任何等待它的变量。因此，如果您`pthread_cond_signal`在消费进程调用良好之前调用，那将被忽略。

其次，pthread_cond_wait 是快还是慢？这得看情况。你可以用得不好，也可以用得很好。如果你用得不好，我相信它会表现得很糟糕。如果你只在真正需要的时候等待，我认为它会表现得很好。

所以，既然你需要持有一个互斥量来使用条件变量，那么你不妨检查一下此时是否有数据（并将这个互斥量用作同步点）。

队列数据结构的一个想法：

```
struct q {
    struct qe *h;
    struct qe *t;

    pthread_mutex_t m;
    pthread_cond_t c;
    int len;
}; 
```

消费者（假设您只有一个消费者，如果您有多个需要锁定头部检查）：

```
void *consumer(void*arg) {
    struct q *q = arg;

    while(1) {
        pthread_mutex_lock(&q->m);
        if(q->h == NULL) 
            pthread_cond_wait(&q->c, &q->m);
        /* We hold the mutex when we exit pthread_cond_wait */
        pthread_mutex_unlock(&q->m); /* we can make the check without the mutex */
        while(q->h != NULL) {
            pthread_mutex_lock(&q->m);  /* but we need it to modify */
            pop(); 
            pthread_mutex_unlock(&q->m);
            /* Process data */
        }
    }
} 
```

制作人：

```
void *producer(void*arg) {
    int i;
    struct q *q = arg;
    while(1) {
        pthread_mutex_lock(&q->m);
        push(q, some_data);
        if(q->h == q->t) /* only one element */
            pthread_cond_signal(&q->c);
        pthread_mutex_unlock(&q->m);
    }    
    return NULL;
} 
```

# use-case - UI 规范 - 参考用例

> ID：13516966
> 
> 赞同：0
> 
> 时间：2012-11-22T16:41:20.840
> 
> 标签：use-case, uispec

我已经编写了用例，现在我正在编写 UI 规范。它只有一个屏幕，但根据用例有很多细微之处。我可以展示我的 UI 原型，然后在标题中引用特定的用例吗？

例如图 3\. 用例“添加新用户 - 替代流程 B”结束时的 UI

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:16:46.020

即使只有一个屏幕，您也可能希望显示屏幕的每个变化（后置条件），具体取决于操作。如果所有在该屏幕上具有相同的先决条件并且输出或隐藏操作不同，那么列表就足够了。

# c - Code::blocks 最大迭代次数

> ID：13516967
> 
> 赞同：0
> 
> 时间：2012-11-22T16:41:23.617
> 
> 标签：c, codeblocks, montecarlo

> **可能重复：**
> [C 中的最大数组大小](https://stackoverflow.com/questions/13504807/max-array-size-in-c)

我的问题是： Code::blocks 是否有循环的最大迭代次数？

我正在运行蒙特卡罗，我想通过 for 循环运行一百万个粒子。但它似乎没有崩溃的最大值是 110000。

谢谢！

更多信息：

我正在使用按时间播种的随机数生成器：

```
 srand(time(NULL)); 
```

然后我想创建一百万个粒子（随机）

```
 for(k=0; k<M; k++){
    R[k] = rand()*(1)/(double)RAND_MAX;
    z[k] = -log(1 - R[k])/(1000*U); 
```

其中M = Num / 10（我想#define N 1000000）

这是我唯一能想到的就是制造问题？

这是一个不起作用的示例代码。

```
 #include <stdio.h>
    #include <math.h>
    #include <time.h>
    #include <stdlib.h>

    int main(){

      srand(time(NULL));

       int j=0;
       int i;
       double A[1000000];

       for(i=0;i<1000000;i++){
          A[i] = rand()*(1.0)/(double)RAND_MAX;
           if (A[i] == 1.0){
              printf("Wow!\n");
           }
       }

       return 0;

    } 
```

这可能是由于我的 Code::blocks 设置造成的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T18:16:22.213

没有最大迭代次数，但堆栈大小有限制。

当你声明一个局部变量时，内存是从堆栈中分配的。的大小`A`太大，无法放入堆栈。（例如，Windows 上的典型堆栈大小为 1MB，`1000000 * sizeof(double)`要大得多。）

您可以尝试更改`A`为全局变量或通过`malloc`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T17:52:06.723

编辑：这是因为默认的最大堆栈大小在 Windows 上为 1MB（但在 Linux 上为 8MB）。

我没有最终答案，但我知道：

a) 它在 Linux 命令行中运行良好。

b) Valgrind 给出了大量这种形式的错误：

```
==2465== Invalid write of size 8
==2465==    at 0x804851D: main (test2.c:16)
==2465==  Address 0xbe4480e4 is on thread 1's stack
==2465== 
==2465== Invalid write of size 4
==2465==    at 0x8048521: main (test2.c:16)
==2465==  Address 0xbe4480e0 is on thread 1's stack
==2465== 
==2465== Invalid read of size 4
==2465==    at 0x4081D69: printf (printf.c:35)
==2465==    by 0x8048528: main (test2.c:16)
==2465==  Address 0xbe4480e0 is on thread 1's stack
==2465== 
==2465== Invalid read of size 8
==2465==    at 0x407AC05: vfprintf (vfprintf.c:1622)
==2465==    by 0x4081D7F: printf (printf.c:35)
==2465==    by 0x8048528: main (test2.c:16)
==2465==  Address 0xbe4480e4 is on thread 1's stack 
```

c) 错误显然与数组的读写有关。这个更简单的程序版本不会导致任何 Valgrind 错误：

```
#include <stdio.h>
#include <math.h>
#include <time.h>
#include <stdlib.h>

int main(){
  srand(time(NULL));
  int i;
  for(i=0;i<1000000;i++){
     if (rand()*(1.0)/(double)RAND_MAX == 1.0){
         printf("Wow!\n");
     }
  }
  return 0;
} 
```

# java - 登录活动已泄漏窗口

> ID：13516969
> 
> 赞同：0
> 
> 时间：2012-11-22T16:41:30.283
> 
> 标签：java, android, exception, dialog, memory-leaks

我知道该异常来自未解除的对话框。

这是使应用程序崩溃的活动（**以下代码是活动的主要部分，其他只是小功能（没有对话框）**：

```
 public void facebookLogin()
{
    shareAppPreferences = new AppPreferences(getApplicationContext());
     facebook =  new Facebook("something");//((GlobalVars)getApplicationContext()).facebook;

     String access_token = shareAppPreferences.getAccessToken();
     Long expires = shareAppPreferences.getAccessExpires();
     Log.d("MyTag","token:" +access_token);
     if(access_token != null) {
         facebook.setAccessToken(access_token);
     }
     if(expires != 0) {
         facebook.setAccessExpires(expires);
     }
     /*
      * Only call authorize if the access_token has expired.
      */
     if(!facebook.isSessionValid()) {
         Log.d("MyTag","In Authorize");
          facebook.authorize(this, new String[] {"publish_stream", "email"}, Facebook.FORCE_DIALOG_AUTH, new DialogListener() {
              public void onComplete(Bundle values) {

                  shareAppPreferences.saveAccessToken(facebook.getAccessToken());
                  Log.d("MyTag","face token: " +facebook.getAccessToken());
                  shareAppPreferences.saveAccessExpires(facebook.getAccessExpires());

              }

              public void onFacebookError(FacebookError e) {
                Toast.makeText(getApplicationContext(), "onFacebookError", Toast.LENGTH_SHORT).show();
            }

            public void onError(DialogError e) {
                Toast.makeText(getApplicationContext(), "onError", Toast.LENGTH_SHORT).show();
            }
            public void onCancel() {

          }
          });
     }
     new AccessKeyTask().execute("someURL");
     Intent intent = new Intent(this,MainActivity.class);
     Log.d("MyTag", "starting activity");
     startActivity(intent);

} 
```

这是 Logcat 异常部分：

```
 11-22 18:32:06.484: I/MapActivity(19687): Handling network change notification:CONNECTED
11-22 18:32:06.488: E/MapActivity(19687): Couldn't get connection factory client
11-22 18:32:06.707: E/WindowManager(19687): Activity com.inturnex.allaround.Login has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@4055d560 that was originally added here
11-22 18:32:06.707: E/WindowManager(19687): android.view.WindowLeaked: Activity com.inturnex.allaround.Login has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@4055d560 that was originally added here
11-22 18:32:06.707: E/WindowManager(19687):     at android.view.ViewRoot.<init>(ViewRoot.java:260)
11-22 18:32:06.707: E/WindowManager(19687):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:148)
11-22 18:32:06.707: E/WindowManager(19687):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
11-22 18:32:06.707: E/WindowManager(19687):     at android.view.Window$LocalWindowManager.addView(Window.java:424)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.Dialog.show(Dialog.java:241)
11-22 18:32:06.707: E/WindowManager(19687):     at com.facebook.android.Facebook.dialog(Facebook.java:839)
11-22 18:32:06.707: E/WindowManager(19687):     at com.facebook.android.Facebook.startDialogAuth(Facebook.java:368)
11-22 18:32:06.707: E/WindowManager(19687):     at com.facebook.android.Facebook.authorize(Facebook.java:231)
11-22 18:32:06.707: E/WindowManager(19687):     at com.inturnex.allaround.Login.facebookLogin(Login.java:147)
11-22 18:32:06.707: E/WindowManager(19687):     at com.inturnex.allaround.Login.onCreate(Login.java:55)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1628)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1680)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
11-22 18:32:06.707: E/WindowManager(19687):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-22 18:32:06.707: E/WindowManager(19687):     at android.os.Looper.loop(Looper.java:130)
11-22 18:32:06.707: E/WindowManager(19687):     at android.app.ActivityThread.main(ActivityThread.java:3703)
11-22 18:32:06.707: E/WindowManager(19687):     at java.lang.reflect.Method.invokeNative(Native Method)
11-22 18:32:06.707: E/WindowManager(19687):     at java.lang.reflect.Method.invoke(Method.java:507)
11-22 18:32:06.707: E/WindowManager(19687):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
11-22 18:32:06.707: E/WindowManager(19687):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
11-22 18:32:06.707: E/WindowManager(19687):     at dalvik.system.NativeStart.main(Native Method)
11-22 18:32:07.402: D/PhoneWindow(19687): couldn't save which view has focus because the focused view android.widget.RelativeLayout@40593b28 has no id.
11-22 18:32:07.402: D/PhoneWindow(19687): couldn't save which view has focus because the focused view android.widget.RelativeLayout@40593b28 has no id. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T16:46:07.557

当您的会话无效时，您将输入该 if 语句并执行一些 Facebook 登录代码，这将打开一个对话框。您不会停止代码的进度，因此该块仍将运行，即使它不应该在 Facebook 身份验证完成之前运行。

```
 new AccessKeyTask().execute("someURL");
 Intent intent = new Intent(this,MainActivity.class);
 Log.d("MyTag", "starting activity");
 startActivity(intent); 
```

I'd suggest putting this code into a function called `completeLogin` or something and adding the call to your `onComplete` and also add an `else` to your session conditional which calls `completeLogin` also.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:45:25.433

第 147 行发生了什么？`11-22 18:32:06.707: E/WindowManager(19687): at com.inturnex.allaround.Login.facebookLogin(Login.java:147)`

我怀疑其中一个错误正在被调用，并且您试图`Toast`在 UI 线程关闭后显示。

尝试使用`runOnUIThread()`

# codeigniter - 使用 CodeIgniter ActiveRecord 进行 NULL 比较

> ID：13516971
> 
> 赞同：7
> 
> 时间：2012-11-22T16:41:36.913
> 
> 标签：codeigniter

我有一张这样的桌子。

```
[id]     [name]     [age]
1        foo        20
2        bar        NULL 
```

如果我需要在年龄字段为 NULL 时返回所有行，我执行以下操作，它工作正常。

```
$this->db->from('person')->where('age', null); 
```

问题是我需要做相反的事情，我的意思是，当年龄字段不是空值时返回所有行。
在 SQL 我做这样的事情

```
SELECT * FROM person WHERE age is not null 
```

我如何使用 CodeIgniter ActiveRecord 做到这一点？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-22T17:07:13.923

您可以使用：

```
$this->db->from('person')->where('age is not null'); 
```

如果你好奇这是怎么发生的，请看`system/database/DB_active_rec.php`

```
protected function _where($key, $value = NULL, $type = 'AND ', $escape = NULL)
{
    ...

        if (is_null($v) && ! $this->_has_operator($k))
        {
            // value appears not to have been set, assign the test to IS NULL
            $k .= ' IS NULL';
        }

        ...
} 
```

和`system/database/DB_driver.php`

```
/**
 * Tests whether the string has an SQL operator
 *
 * @access  private
 * @param   string
 * @return  bool
 */
function _has_operator($str)
{
    $str = trim($str);
    if ( ! preg_match("/(\s|<|>|!|=|is null|is not null)/i", $str))
    {
        return FALSE;
    }

    return TRUE;
} 
```

因此，您可以只将第一个参数传递给`where()`方法，如果此方法的第一个运算符有一个子字符串`is not null`，它将保持不变。

阅读更多 - [CodeIgniter 论坛](http://codeigniter.com/forums/viewthread/119444/P15)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-22T16:45:02.293

这一定是这样的：

```
 $this->db->from('person')->where('age IS NOT NULL', null); 
```

# javascript - -webkit-transform-origin-z 在 Chrome、Safari 和 Mobile Safari 中

> ID：13516973
> 
> 赞同：3
> 
> 时间：2012-11-22T16:41:49.690
> 
> 标签：javascript, google-chrome, css, safari, mobile-safari

![在此处输入图像描述](../Images/d04b98821e05a22842c0bf26da14a287.png)

上图准确描述了我在使用 Chrome、Safari 和 Mobile Safari 时遇到的问题。似乎 Chrome 正在正确处理 -webkit-transform-origin-z 而其他两个浏览器呈现不同的结果。请仔细查看红色框及其在所有浏览器中的位置。

用于重现这一点的代码是：

```
<!DOCTYPE html>
<html>
<head>
<style>
#div1
{
position: relative;
height: 200px;
width: 200px;
margin: 100px;
padding: 10px;
border: 1px solid black;
-webkit-transform-style: preserve-3d;
}

#div2
{
-webkit-perspective: 500;
}

#div3
{
padding:50px;
position: absolute;
border: 1px solid black;
background-color: red;
-webkit-transform: rotateY(45deg);
-webkit-transform-origin: 20% 40% 200px;
}
</style>
</head>

<body>

<div id="div1">
  <div id="div2"><div id="div3">HELLO</div></div>
</div>

</body>
</html> 
```

欢迎您提出任何有助于统一解决方案的线索！

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-15T21:18:03.433

因为您的 Safari 窗口大小不同，这会改变网站的参数。由于同样的原因，我意识到白色方块在 Safari 移动设备上也不是 200x200。

# algorithm - 具有多个约束的多维背包

> ID：13516974
> 
> 赞同：0
> 
> 时间：2012-11-22T16:42:01.470
> 
> 标签：algorithm, greedy, knapsack-problem

我不确定我是否正确地确定了问题，但阅读背包问题似乎最接近我试图解决的问题：

厨师有几种不同数量的成分。例如：

8 个鸡蛋 3 根香肠 500 毫升牛奶 12 个草莓

有一个有限的食谱列表，每一个都包含不同数量的不同成分。成分的范围是有限的，所有食谱中每种成分的数量也是有限的。

每个食谱可能包含也可能不包含厨师所拥有的任何成分。

厨师希望尽可能多地用完他所有的原料，以尽量减少一份食谱的浪费。

有一种情况是，厨师想在 2 或 3 种不同的食谱中使用他的所有食材，而剩菜最少。

他的*优化*方案是什么？

编辑：我的问题是以下背包问题的更复杂版本 [http://www.g12.cs.mu.oz.au/wiki/doku.php?id=simple_knapsack](http://www.g12.cs.mu.oz.au/wiki/doku.php?id=simple_knapsack)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T03:00:31.730

如果我在您的 Q 中没有遗漏任何内容，这听起来不像是背包问题。每个配方中每种成分的数量是已知的，因此您的插槽大小不是变量。

如果我正确地阅读了您的 Q，您需要做的就是通过每个食谱运行成分，查看数量是否足够，如果是，计算要在该食谱中遗漏的成分的价值。具有最小这种正值的配方就是您的答案。直接访问成分列表需要 \theta(m*n) 时间 - m & n 成分和食谱的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T13:09:30.253

让我重写你的 Q 看看我是否理解正确：你有一组食谱 S，每一个都包含一个成分要求列表。厨师有一套配料，其中一些成分甚至可能为零。您想要确定 S 的一个子集，以便 S 中的每个食谱都可以通过厨师所拥有的成分来满足，同时最小化所谓的剩菜。

假设你有 1 个鸡蛋，5 根香肠；两个食谱： A. 香肠鸡蛋 - 1E1S；B. 巨型香肠-0E5S。所以可能的解决方案是 {A}.{B},{A,B}。{A}，剩下 4 根香肠；用 {B}，剩下 1 个鸡蛋，用 {A,B}，它实际上是非法或不可行的解决方案。

我的问题是：你如何评价剩下的？如果发生禽流感，鸡蛋可能价格过高，{B} 可能是首选。所以也许可以通过定价每种成分来定义一些加权和函数，比如**f**。

如果使用加权和，则可以将其视为多维 KP。这些项目是那些收据，具有多个“指标”，例如# of ingredients1（或说长度），# of ingredients2（或说宽度）......并且它们将被装进一个碰巧有多个维度（长度, width,...) 所以可行的包装必须满足其对每个维度的约束，即成分*k*的总使用量必须小于厨师所拥有的总成分 k。obj 是最小化*f*（重量）或 max *f*（用完的成分数量的价格）-互联网的总价格，或者只是第一部分。

据我所知，只要维度的数量（在你的情况下，成分）不高，这个问题是可以解决的。这有点像削减库存。

# jsf-2 - primefaces p：selectManyMenu 听众不听

> ID：13516976
> 
> 赞同：-1
> 
> 时间：2012-11-22T16:42:02.337
> 
> 标签：jsf-2, primefaces

当用户从`selectManyMenu`.

```
<p:selectManyMenu value="#{radicadoOficioBean.localidadesSeleccionadas}">
    <p:ajax event="click" listener="#{radicadoOficioBean.listenerdt}" process="@this"/>
    <f:selectItems value="#{radicadoOficioBean.localidadSIs}"/>
</p:selectManyMenu> 
```

和

```
public void listenerdt(AjaxBehaviorEvent e) {
    System.out.println("oh!");
} 
```

不工作。但是，如果我使用`selectOneMenu`而不是`selectManyMenu`，听众会听。我尝试使用默认事件，也使用“更改”，但没有任何效果。

有什么建议我可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T15:15:52.577

下载了最新的 primefaces 的 jar，重新启动了服务器，现在一切正常。

# vb.net - VB.Net 内存问题

> ID：13516980
> 
> 赞同：2
> 
> 时间：2012-11-22T16:42:05.893
> 
> 标签：vb.net

我们有一个应用程序存在一些有趣的内存使用问题。首次打开时，该程序使用大约 50-60MB 的内存。这在 32 位机器上保持一致。然而，在 64 位机器上，以任何方式（单击、拖动、alt-tabbing 等）重新激活表单都会增加大约 50MB 的内存使用量。它会重复此过程几次，然后重置回 45MB 左右，此时循环再次开始。

我做了一些研究，很多人都说 VB 的垃圾收集能力很差，这可能会以某种方式影响软件。但是，我还没有找到解决方案。激活应用程序时不会触发任何事件（如 32 位使用所示） - 应用程序只是等待用户的操作。

在加载时，系统将一些数据拉入树视图，但这是唯一的外部连接，并且仅当用户对某些内容进行更改并保存更改时才会重新启动例程。

有没有其他人经历过这种奇怪的事情，如果是这样，有人知道什么可以解决吗？似乎很奇怪，它只发生在 x64 系统下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T22:57:26.377

开始寻找导致泄漏的原因的最佳方法之一是使用分析工具。

[http://www.jetbrains.com/profiler/](http://www.jetbrains.com/profiler/)

这些人有 10 天的免费试用期，通常足以找出导致您的问题的代码区域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T02:05:40.497

这听起来根本不是问题。正如评论中提到的，64 位程序将使用更多内存。该应用程序不会使用太多内存，并且会在一段时间后恢复。VB.net 没有“非常糟糕的垃圾收集”，它使用与 C# 相同的收集器，即 CLR 的收集器。

# c# - 在 VBA 中使用 XML-RPC 将附件添加到 Bugzilla

> ID：13516982
> 
> 赞同：0
> 
> 时间：2012-11-22T16:42:26.847
> 
> 标签：c#, vba, com-interop, xml-rpc, bugzilla

我目前正在开发一个 Excel 宏，它允许在 Bugzilla 实例中创建错误。经过一些试验和错误，现在证明可以正常工作。我想增强客户端，以便还可以将屏幕截图添加到新创建的错误中。

我使用的环境有点棘手：我必须使用 MS Excel 来完成我的任务。由于 Excel 不理解 XML-RPC，我下载了一个接口 DLL（来自 xml-rpc.net 的 CookComputing.XmlRpcV2.dll），它使 XML-RPC 接口可以从 .NET 访问。然后我创建了一个额外的 DLL，可以从 Excel 宏中调用（使用 COM 互操作）。

如前所述，这对于浏览或添加新错误等任务非常有效。但是在给bug添加附件时，必须将图片转换成base64数据类型。尽管这似乎工作正常，并且虽然屏幕截图的创建似乎成功，但图像似乎已损坏并且无法显示。

这是我添加图像的方法：Bugzilla add_attachment 方法接受一个结构作为输入： [http](http://www.bugzilla.org/docs/4.0/en/html/api/Bugzilla/WebService/Bug.html#add_attachment) ://www.bugzilla.org/docs/4.0/en/html/api/Bugzilla/WebService/Bug.html#add_attachment 。此类型在 C# 中定义，在 VBA 中也可见。

这是结构定义：

```
[ClassInterface(ClassInterfaceType.AutoDual)]
public class TAttachmentInputData
{
    public string[] ids;
    public string data; // base64-encoded data
    public string file_name;
    public string summary;
    public string content_type;
    public string comment;
    public bool is_patch;
    public bool is_private;

    public void addId(int id)
    {
        ids = new string[1];
        ids[0] = id.ToString();
    }

    public void addData(string strData)
    {
        try
        {
            byte[] encData_byte = new byte[strData.Length];
            encData_byte = System.Text.Encoding.ASCII.GetBytes(strData);
            string encodedData = Convert.ToBase64String(encData_byte);
            data = new Byte[System.Text.Encoding.ASCII.GetBytes(encodedData).Length];
            data = System.Text.Encoding.ASCII.GetBytes(encodedData);
        }
        catch (Exception e)
        {
            throw new Exception("Error in base64Encode" + e.Message);
        }
    } 
```

这是我的宏中我想添加附件的部分：

```
 Dim attachmentsStruct As New TAttachmentInputData
    fname = attachmentFileName

    attachmentsStruct.file_name = GetFilenameFromPath(fname)
    attachmentsStruct.is_patch = False
    attachmentsStruct.is_private = False
    'multiple other definitions

    Open fname For Binary As #1
    attachmentsStruct.addData (Input(LOF(1), #1))
    Close #1
    attachmentsStruct.file_name = GetFilenameFromPath(fname)
    Call BugzillaClass.add_attachment(attachmentsStruct) 
```

其中 BugzillaClass 是从我的 DLL 向 Excel VBA 公开的接口。该方法`add_attachment`是指 XML-RPC 方法`add_attachment`。

我认为我的问题是从二进制文件转换为 base64。这是使用`addData`我的 C# DLL 中的方法完成的。转换是否在那里正确完成？知道为什么图像损坏了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T04:14:45.070

我认为问题在于您正在宏中读取二进制数据，但 addData 方法需要一个字符串。尝试将 addData 中的参数声明为 byte[]。

# ios - 如何使用导航控制器作为我的 UIWebView [Xcode] 的导航？

> ID：13516983
> 
> 赞同：2
> 
> 时间：2012-11-22T16:42:34.103
> 
> 标签：ios, xcode, uiwebview, uinavigationcontroller, storyboard

我正在为我的 iOS 应用程序进行更新。目前，您可以使用静态后退按钮（在我的故事板中创建并链接）返回，但我希望通过导航控制器重定向到新的 WebView。这是目前的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURL *url = [NSURL URLWithString:@"http://example.com"];

    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [self.navigationController pushViewController:url animated:YES];

    [webView loadRequest:request];
} 
```

我怎样才能做到这一点 ？非常感谢您提前！！

最大限度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T17:34:03.670

显然，这段代码没有意义（例如`url`不是`UIViewController`所要求的`pushViewController`，等等），但我们可以对您尝试执行的操作做出明智的猜测。我猜你是说你想让后退按钮像网络浏览器上的后退按钮一样，但你希望标准导航控制器为你处理这个问题。这意味着您还建议每次单击页面上的链接时，您都希望推送到另一个视图控制器以显示下一个网页（以便后退按钮可以带您回到上一个使用前一个网页查看控制器）。

如果这就是您要问的，那可能不是一个好主意。这意味着每次您单击 Web 浏览器中的链接时，您都需要使用您的`UIWebViewDelegate`方法`shouldStartLoadWithRequest`，拦截该请求，而不是让当前`UIWebView`满足该请求，而是使用 UIWebView 推送到另一个视图控制器那个页面。可悲的是，这是大量的工作并且非常浪费内存资源。它也不适用于很多网页。归根结底，这不是一个好主意。

只需将按钮添加到`UIWebView`托管`UIWebView`. 然后，您可以添加用户在 iOS 网络浏览器上期望的所有其他按钮（不仅是后退按钮，还有前进按钮，可能是主页按钮，可能是“操作”按钮，可让您在 safari 中打开页面，在 fb 上分享, 等等. 无论你想要什么. 但用户期望的不仅仅是一个“后退”按钮。

* * *

**更新：**

如果您真的想在用户单击链接时推送到另一个视图控制器，您可以`shouldStartLoadWithRequest`像我之前提到的那样进行拦截。但是，以下代码示例假定：

*   您已将视图控制器定义为 Web 视图的委托；和
*   您已经定义了一个`BOOL`实例变量`loadFinished`.

无论如何，您可能需要这三种[`UIWebViewDelegate`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)方法：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    if (!initialLoadFinished)
    {
        // if we're still loading this web view for the first time, then let's let
        // it do it's job

        return YES;
    }
    else
    {
        // otherwise, let's intercept the webview from going to the next
        // html link that the user tapped on, and create the new view controller.

        // I'm making the next controller by instantiating a scene from the
        // storyboard. Because you may be using NIBs or because you have different
        // class names and storyboard ids, you will have to change the following
        // line.

        ViewController *controller = [self.storyboard instantiateViewControllerWithIdentifier:@"webview"];

        // I don't know how you're passing the URL to your view controller. I'm
        // just setting a (NSString*)urlString property.

        controller.urlString = request.URL.absoluteString;

        // push to that next controller

        [self.navigationController pushViewController:controller animated:YES];

        // and stop this web view from navigating to the next page

        return NO;
    }
}

// UIWebView calls this when the page load is done

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    initialLoadFinished = YES;
}

// UIWebView calls this if the page load failed. Note, though, that
// NSURLErrorCancelled is a well error that some web servers erroneously
// generate

- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error
{
    if (error.code != NSURLErrorCancelled)
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Web Loading Error"
                                                        message:nil // error.localizedDescription
                                                       delegate:nil
                                              cancelButtonTitle:@"OK"
                                              otherButtonTitles:nil];
        [alert show];

        initialLoadFinished = YES;
    }
} 
```

就个人而言，我可能会坚持使用标准`UIWebView`，但如果你想跳转到导航控制器，这会做到。顺便说一句，上述黑客可能无法很好地处理重定向，因此请确保您获得正确的 URL。

# asp.net - 如何查看以 KB 为单位的 Web 服务器 http 响应大小？

> ID：13516984
> 
> 赞同：2
> 
> 时间：2012-11-22T16:42:34.653
> 
> 标签：asp.net, html, firefox, google-chrome, scalability

我在我的网站中包含 jquery、jquery-UI 和一些 jquery 插件，我想知道每个响应的大小（以 kb 为单位），特别是第一个响应。如何在 Firefox、Chrome 和 IE8 中看到它？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T16:45:48.440

## 谷歌浏览器

`F12`按下并选择**Network**打开 Chrome 开发者工具。
*尺寸*栏是您感兴趣的栏目。

## 火狐

安装[Firebug](http://getfirebug.com/)并通过按下`F12`并选择**Net**选项卡打开它。
*尺寸*栏是您感兴趣的栏目。

## IE浏览器

> *当您已经从其他两个浏览器获得该信息时，为什么还要在 IE 中查看服务器响应大小？* **;-)**

IE8（或更早版本）中没有直接支持。当您无法使用其他浏览器时，请使用[Fiddler本地代理工具。](http://www.fiddler2.com/fiddler2/)

### 提琴手

它实际上是一个非常强大的工具（独立于浏览器），因此您可以将它用于从您的机器到某个 Web 服务器的任何请求。这些请求可能由浏览器（任何）或向某些 Web 服务器发出请求的桌面应用程序发起。这就是为什么这个工具对任何开发人员来说都是无价的，因为它提供了许多功能。您甚至可以直接从它发出请求。

# mysql - 如果我更新一个表的行，它也是视图中的一行，视图的行也会更新吗？

> ID：13516987
> 
> 赞同：-1
> 
> 时间：2012-11-22T16:42:50.923
> 
> 标签：mysql, sql, views, sql-update

如果我更新一个表的行，它也是视图中的一行，视图的行也会更新吗？我使用 MySQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:46:18.270

**是**的。好吧，a`VIEW`只是一个模拟表的存储查询。因此，表上的任何更改也将在视图上进行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:46:51.340

是的，视图本质上应该被视为存储的 SELECT 语句。基础表上数据的任何更改都将直接反映在视图中。

如果您考虑一下，如果不是，那么视图将需要在创建视图时存储数据的复制。

# java - 覆盖 DateFormat.getDateTimeInstance() 的可能性？

> ID：13516989
> 
> 赞同：2
> 
> 时间：2012-11-22T16:42:58.083
> 
> 标签：java, date, scjp

我只是想知道，是否有可能告诉我们的 JVM 使用默认的 DateFormat，它不是为当前语言环境配置的，例如？

我知道我可以提供语言环境，但我不想。

实际上，我希望能够指定要为特定语言环境返回的 DateFormat。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T18:36:28.117

我想到的唯一解决方案是“劫持” java.text.DateFormat 类。为此，您需要编写自己的具有相同包和名称的类，将其编译成 jar 并将该 jar 放入 JRE 的 lib\endorsed 文件夹中。

免责声明：我没有测试过这个，我很确定它违反了某些规则，它可能不起作用，它可能会删除你磁盘的全部内容。

除此之外：你为什么要这样做？如果您想更改系统区域设置的日期格式，请转到系统的控制中心并针对您喜欢的每个区域设置进行更改；-)

# javascript - 在 Threejs 平面上渲染 TMX 地图

> ID：13516990
> 
> 赞同：3
> 
> 时间：2012-11-22T16:42:58.717
> 
> 标签：javascript, shader, webgl, three.js

> 使用新代码更新问题

我正在尝试编写一个 WebGL 着色器来绘制一个[TMX 层](https://github.com/bjorn/tiled/wiki/TMX-Map-Format)（从平铺编辑器中导出）。我正在使用 THREE.js 来创建一个`Plane`网格，并让材质成为在`ShaderMaterial`其上绘制地图的材质。

对于那些不知道[Tiled 编辑器](https://www.mapeditor.org/)导出为 json的 tilemap 的人，`data`将为每个图层提供一个属性；它包含一个数值数组，每个数值都是图块集中的图块索引，例如：

```
"data": [5438, 5436, 5437, 5438, 5436, 5437, 5438, 5436, 5437, 5438, 845, ...] 
```

由于我的 tilemap 是 256 x 256 个图块，因此数组的长度为 65536 个元素。每个元素的值都指向 tilemap 中的一个 tile，其中索引的定义如下：

[![瓷砖套装](../Images/7c799439176a466e7a5cbecd2269b394.png)](https://i.stack.imgur.com/b7n4O.png)
[（来源：[melonjs.org](http://www.melonjs.org/docs/symbols/spritesheet_grid.png)）]

因此，tilemap 的索引 0 指的是 tile 5438，它们像上面一样被计算在内。索引表示 tilemap 中的哪个图块具有来自图块集中的图块，它们以相同的方式计算。

以下是我创建材质、平面和网格的方式：

```
this.size = new THREE.Vector2(256, 256);
this.tileSize = new THREE.Vector2(16, 16);

this._material = new THREE.ShaderMaterial({
    uniforms: this._uniforms,
    vertexShader: this.vShader,
    fragmentShader: this.fShader,
    transparent: (this.opacity === 0)
});

this._plane = new THREE.PlaneGeometry(
    this.size.x * this.tileSize.x,
    this.size.y * this.tileSize.y
);

this._mesh = new THREE.Mesh(this._plane, this._material); 
```

最后是制服和着色器。基本上我需要将数据元素映射到图块集中的实际图块并绘制它。为了将`data`数组放入着色器中，我将其加载为 a`THREE.DataTexture`并将其视为纹理。

这是我的第二次尝试：

```
//Shaders
var vShader = [
    'varying vec2 pixelCoord;',
    'varying vec2 texCoord;',

    'uniform vec2 layerSize;',
    'uniform vec2 tilesetSize;',
    'uniform vec2 inverseTilesetSize;',

    'uniform vec2 tileSize;',
    'uniform vec2 inverseTileSize;',
    'uniform float scale;',

    'void main(void) {',
    '   pixelCoord = (uv * layerSize) * tileSize * scale;', //pixel we are at
    '   texCoord = pixelCoord * inverseTilesetSize * inverseTileSize;', //calculate the coord on this map
    '   gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);',
    '}'
].join('\n');

var fShader = [
    //"precision highp float;",

    'varying vec2 pixelCoord;',         
    'varying vec2 texCoord;',

    'uniform vec2 tilesetSize;',
    'uniform vec2 inverseTilesetSize;',

    'uniform vec2 tileSize;',
    'uniform vec2 inverseTileSize;',
    'uniform vec2 numTiles;',
    'uniform float scale;',

    'uniform sampler2D tileset;',
    'uniform sampler2D tileIds;',

    //I store the tile IDs as a texture (1 float value = rgba)
    //this will decode the rgba values back into a float ID
    'highp float decode32(highp vec4 rgba) {',
    '   const vec4 bit_shift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);',
    '   float depth = dot(rgba, bit_shift);',
    '   return depth;',
    '}',

    'void main(void) {',
    '   vec4 tileId = texture2D(tileIds, texCoord);', //grab this tileId from the layer data
    '   tileId.rgba = tileId.abgr;', //flip flop due to endianess
    //I find that this value is always `0 < tileValue < 1`, I think my `decode32` sucks...
    '   float tileValue = decode32(tileId);', //decode the vec4 into the float ID
    '   vec2 tileLoc = vec2(mod(tileValue, numTiles.y), floor(tileValue / numTiles.y));', //convert the ID into x, y coords
    '   vec2 coord = floor(tileLoc * 256.0) * tileSize;', //coord in the tileset
    '   vec2 offset = mod(pixelCoord, tileSize);', //how much to draw
    '   gl_FragColor = texture2D(tileset, (coord + offset) * inverseTilesetSize);', //grab tile from tilset
    '}'
].join('\n'); 
```

还有制服和数据纹理：

```
//tried making this 256 x 256 like it is conceptually,
//and also tried 65536 x 1 like the data structure
this.dataTex = new THREE.DataTexture(
                this.data,
                this.data.length, //width (65536)
                1, //height (1)
                THREE.RGBAFormat, //format
                THREE.UnsignedByteType, //type
                THREE.UVMapping, //mapping
                THREE.ClampToEdgeWrapping, //wrapS
                THREE.ClampToEdgeWrapping, //wrapT
                THREE.NearestFilter, //magFilter
                THREE.NearestMipMapNearestFilter //minFilter
            );
this.dataTex.needsUpdate = true;

this._uniforms = window._uniforms = {
    layerSize:          { type: 'v2', value: this.size },
    tilesetSize:        { type: 'v2', value: new THREE.Vector2(this.tileset.image.width, this.tileset.image.height) },
    inverseTilesetSize: { type: 'v2', value: new THREE.Vector2(1 / this.tileset.image.width, 1 / this.tileset.image.height) },

    tileSize:           { type: 'v2', value: this.tileSize },
    inverseTileSize:    { type: 'v2', value: new THREE.Vector2(1 / this.tileSize.x, 1 / this.tileSize.y) },
    numTiles:           { type: 'v2', value: new THREE.Vector2(this.tileset.image.width / this.tileSize.x, this.tileset.image.height / this.tileSize.y) },
    scale:              { type: 'f', value: 1 / this.scale },

    tileset:            { type: 't', value: this.tileset },
    tileIds:            { type: 't', value: this.dataTex },
    repeatTiles:        { type: 'i', value: this.repeat ? 1 : 0 }
}; 
```

所以当这个渲染我只是一遍又一遍地重复tileset的第一个tile：

![重复的瓷砖](../Images/11671fda9e912eba682bb8b0515e9c1f.png)

不知道是什么原因造成的，但由于它在位置上，`0, 0`我想我在某个地方有一个零搞砸了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T18:11:29.343

终于有了一个可行的解决方案，我最大的问题是将我的浮点数组打包到纹理中，然后再解码。我忘记了当从数据纹理加载字节时，它们被“标准化”。这意味着每个值除以 255 以将其钳制为 [0, 1]。移位后，我需要乘以 255.0 以进行非规范化。

我还在某处读到 webgl 浮点数是 24 位而不是 32 位，因此我将编码和解码算法更改为仅使用 RGB 通道。

现在它成功地将一个整数（或浮点数）数组打包到 a`Uint8Array`中，将其作为纹理传递给 webgl 并正确使用它：

**数组包装**：

```
var array = [5438, 5436, 5437, 5438, 5436, 5437, ...],
    arrayBuff = new ArrayBuffer(array.length * 3),
    array8 = new Uint8Array(arrayBuff);

for(var i = 0, y = 0, il = array.length; i < il; ++i, y += 3) {
    var value = array[i];

    array8[y + 0] = (value & 0x000000ff);
    array8[y + 1] = (value & 0x0000ff00) >> 8;
    array8[y + 2] = (value & 0x00ff0000) >> 16;
}

dataTex = new THREE.DataTexture(
                            array8,
                            this.size.x, //width
                            this.size.y, //height
                            THREE.RGBFormat, //format
                            THREE.UnsignedByteType, //type
                            THREE.UVMapping, //mapping
                            THREE.ClampToEdgeWrapping, //wrapS
                            THREE.ClampToEdgeWrapping, //wrapT
                            THREE.NearestFilter, //magFilter
                            THREE.NearestMipMapNearestFilter //minFilter
                        );
dataTex.needsUpdate = true; 
```

**着色器**：

```
var vShader = [
    'varying vec2 pixelCoord;',
    'varying vec2 texCoord;',

    'uniform vec2 mapSize;',
    'uniform vec2 inverseLayerSize;',

    'uniform vec2 inverseTileSize;',

    'void main(void) {',
    '   pixelCoord = (uv * mapSize);',
    '   texCoord = pixelCoord * inverseLayerSize * inverseTileSize;',
    '   gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);', //hand this position to WebGL
    '}'
].join('\n');

var fShader = [
    'varying vec2 pixelCoord;',         
    'varying vec2 texCoord;',

    'uniform vec2 inverseTilesetSize;',

    'uniform vec2 tileSize;',
    'uniform vec2 numTiles;',

    'uniform sampler2D tileset;',
    'uniform sampler2D tileIds;',

    'float decode24(const in vec3 rgb) {',
    '   const vec3 bit_shift = vec3((256.0*256.0), 256.0, 1.0);',
    '   float fl = dot(rgb, bit_shift);', //shift the values appropriately
    '   return fl * 255.0;', //denormalize the value
    '}',

    'void main(void) {',
    '   vec3 tileId = texture2D(tileIds, texCoord).rgb;', //grab this tileId from the layer data
    '   tileId.rgb = tileId.bgr;', //flip flop due to endianess
    '   float tileValue = decode24(tileId);', //decode the normalized vec3 into the float ID
    '   vec2 tileLoc = vec2(mod(tileValue, numTiles.x) - 1.0, floor(tileValue / numTiles.x));', //convert the ID into x, y coords;
    '   tileLoc.y = numTiles.y - 1.0 - tileLoc.y;', //convert the coord from bottomleft to topleft

    '   vec2 offset = floor(tileLoc) * tileSize;', //offset in the tileset
    '   vec2 coord = mod(pixelCoord, tileSize);', //coord of the tile.

    '   gl_FragColor = texture2D(tileset, (offset + coord) * inverseTilesetSize);', //grab tile from tileset
    '}'
].join('\n'); 
```

**制服**：

```
this._uniforms = window._uniforms = {
    mapSize:            { type: 'v2', value: new THREE.Vector2(this.size.x * this.tileSize.x, this.size.y * this.tileSize.y) },
    inverseLayerSize:   { type: 'v2', value: new THREE.Vector2(1 / this.size.x, 1 / this.size.y) },
    inverseTilesetSize: { type: 'v2', value: new THREE.Vector2(1 / this.tileset.image.width, 1 / this.tileset.image.height) },

    tileSize:           { type: 'v2', value: this.tileSize },
    inverseTileSize:    { type: 'v2', value: new THREE.Vector2(1 / this.tileSize.x, 1 / this.tileSize.y) },
    numTiles:           { type: 'v2', value: new THREE.Vector2(this.tileset.image.width / this.tileSize.x, this.tileset.image.height / this.tileSize.y) },

    tileset:            { type: 't', value: this.tileset },
    tileIds:            { type: 't', value: this.dataTex }
}; 
```

# c# - 如何使用 Asp.net 将一个应用程序重定向到另一个应用程序？

> ID：13516992
> 
> 赞同：0
> 
> 时间：2012-11-22T16:43:00.490
> 
> 标签：c#, asp.net, redirect

我有两个 Asp.net 应用程序，第一个应用程序 asp 页面有 Iframe，当页面加载时重定向另一个应用程序 asp 页面（基于 iss 中的端口位置），Iframe 波纹管页面有链接按钮，当我必须单击该按钮时重定向第一个应用程序（主应用程序）但现在在 iframe 中显示第一个应用程序页面，如何重定向主应用程序。

```
 Code
    ------------
   (82) Main Application:(first)(192.***.*.***:82/Rate.aspx)-->This Application have Two pages Rate.aspx, Default.aspx.
    -----------------
 Click -->  (82) Rate.aspx:(have one Iframe)

Page Load() method to load the another application Default.aspx page like    
     ifrm.Attributes["src"] ="http://192.***.*.***:83/default.aspx";

  Second Appliction --> (83) Default page : have one button , button click  event fired to redirect Main Application (82) default page have to display. code
    -----------------
    protected void lblWWPremiumRate_Click(object sender, EventArgs e)
            {
                Response.Redirect("http://192.***.*.***:82/default.aspx");         

            } 
```

# ruby-on-rails - ActiveRecord 查询查找过去 3 个月内未购买的所有用户

> ID：13516999
> 
> 赞同：1
> 
> 时间：2012-11-22T16:44:20.453
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, arel

我有一个具有关联购物车的用户模型。每个购物车都有一个 purchase_at 日期时间列。我想选择过去 3 个月内没有购买购物车的所有用户。

我虽然很简单：

```
User.joins(:carts).where('not carts.purchased_at < ?', 3.months.ago) 
```

会做的伎俩，但情况似乎并非如此。我被退回过去 3 个月内购买过东西的用户记录。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T17:27:01.110

您应该能够在普通的活动记录中做到这一点：

```
User.joins(:carts)
  .group("users.id")
  .having("MAX(carts.purchased_at) < ?", 3.months.ago) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T16:54:08.097

我建议您执行原始 SQL。

```
User.find_by_sql('
  SELECT users.* FROM users WHERE id NOT IN 
  (SELECT users.id FROM users LEFT JOIN carts ON users.id = carts.user_id
  WHERE carts.purchased_at < ?)
', 3.months.ago) 
```

请记住，这只是一个建议。（而且我认为代码需要一些重构，但你明白了。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T17:02:49.347

将[squeel](https://github.com/ernie/squeel) gem 用于此类复杂的查询：

```
User.where{id.not_in User.joins{carts}.where{carts.purchased_at > 3.months.ago}} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T17:09:28.330

如果您使用的是 AR3（和 ARel）：

```
User.joins(:carts).where(Cart.arel_table[:purchased_at].gt(3.months.ago)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T19:14:30.927

如果您的购物车很大，使用`MAX`and可能会很慢。`GROUP BY`我会使用这种方法。

```
nq = Cart.where("carts.user_id = users.id AND carts.purchased_at >= ?", 3.months.ago)
User.where("NOT EXISTS (#{nq.to_sql})") 
```

更好的是，我会添加一个名为模型的列`last_purchase_at`，`User`以使此查询高效。

```
class User
  # add a new column called last_purchase_at
  # index the last_purchase_at column

  def self.dormant_users(period=3.months)
    User.where("last_purchase_at <= ?", period.ago)
  end
end 
```

向模型添加 after_create 回调以`Cart`更新`User`模型。

```
class Cart
  after_create :update_user_last_purchase_at

  def update_user_last_purchase_at
    user.update_attribute(:last_purchase_at, purchased_at)
  end
end 
```

将此代码添加到您的迁移脚本以设置`last_purchase_at`现有`User`模型的列。

```
User.connection.execute("
  UPDATE users 
  JOIN (
    SELECT a.user_id, MAX(a.purchased_at) purchased_at 
    FROM carts a 
    GROUP BY a.user_id
  ) carts ON carts.user_id= users.id
  SET users.last_purchase_at = cards.purchased_at") 
```

现在您可以按如下方式获取休眠用户：

```
User.dormant_users # dormant for last 6 months
User.dormant_users(6.months) # dormant for last 6 months 
```