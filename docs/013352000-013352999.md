# StackOverflow 问答 13352000-13352999

# entity-framework - 如何防止实体框架缓存标记为：NotMapped 的属性？

> ID：13352001
> 
> 赞同：1
> 
> 时间：2012-11-12T21:39:51.780
> 
> 标签：entity-framework

我有一个具有多个属性的模型。其中一个属性用 [NotMapped] 修饰，因为它是一个计算字段。每次都必须计算该字段。EF (5) 正在缓存计算结果，并在下次请求相同 ID 时将其缓存。如果计算确定它无法计算任何东西并且模型中的值应该为空，它会失败，除非它不会因为它只会具有之前计算的任何值。

我可以阻止 DBContext 尝试命中非映射属性的缓存吗？

# google-chrome - Chromium 如何使用 XUL Runner SDK？

> ID：13352009
> 
> 赞同：1
> 
> 时间：2012-11-12T21:40:26.527
> 
> 标签：google-chrome, chromium, xulrunner

在 Chromium 和 Chrome (chrome://credits/) 的学分部分，您可以找到**XUL Runner SDK**。

我在 chromium 网站上进行了一些搜索，没有找到任何迹象，也没有找到它的用途。

我试图在使用[chromiumembedded](http://code.google.com/p/chromiumembedded/)、[Awesomium](http://awesomium.com/)、 WebKit、 XUL Runner、 libRocket 等东西之间做出决定，因此发现结果令人困惑。

所以我的问题是：为什么 XUL Runner SDK 在 chrome://credits/ 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T07:30:16.100

您应该[搜索源代码](http://code.google.com/p/chromium/source/search?q=xulrunner)以检查。XULRunner SDK 的唯一实际用途似乎`mock_ie_event_sink_test.h`是包含与可访问性相关的文件。该文件中的常量（如`IA2_EVENT_DOCUMENT_LOAD_COMPLETE`）然后被用于`mock_ie_event_sink_test.cc`- 单元测试文件。因此，对 XULRunner 的依赖似乎不适用于 Google Chrome 实际附带的任何代码。

# java - Java 客户端线程池已满

> ID：13352012
> 
> 赞同：0
> 
> 时间：2012-11-12T21:40:40.080
> 
> 标签：java

我们遇到了这个问题，它说客户端线程池已满。客户端 JVM 上创建的线程数是否有限制

```
2012-11-12 10:09:54,206 [AWT-EventQueue-0] ERROR com.splwg.oms.client.util.ClientThreadPool:  The client thread pool is full
java.lang.Exception: Stack Trace:
                at com.splwg.oms.client.util.ClientThreadPool.dumpExtendedStack(ClientThreadPool.java:49)
                at com.splwg.oms.client.util.ClientThreadPool$MyRejectedHandler.rejectedExecution(ClientThreadPool.java:169)
                at java.util.concurrent.ThreadPoolExecutor.reject(Unknown Source)
                at java.util.concurrent.ThreadPoolExecutor.execute(Unknown Source)
                at java.util.concurrent.AbstractExecutorService.submit(Unknown Source)
                at com.splwg.oms.jbot.adapter.JBotAdapter.processCommands(JBotAdapter.java:652)
                at com.splwg.oms.jbot.adapter.JBotAdapter.processEvent(JBotAdapter.java:591)
                at com.splwg.oms.jbot.listener.JTableAdapterListener.valueChanged(JTableAdapterListener.java:106)
                at com.splwg.oms.jbot.listener.JTableAdapterListener.selected(JTableAdapterListener.java:41)
                at com.splwg.oms.jbot.component.JBotTable.fireJBotSelection(JBotTable.java:376)
                at com.splwg.oms.jbot.component.JBotTable.changeSelection(JBotTable.java:240)
                at javax.swing.plaf.basic.BasicTableUI$Handler.mouseDragged(Unknown Source)
                at java.awt.AWTEventMulticaster.mouseDragged(Unknown Source)
                at java.awt.Component.processMouseMotionEvent(Unknown Source)
                at javax.swing.JComponent.processMouseMotionEvent(Unknown Source)
                at java.awt.Component.processEvent(Unknown Source)
                at java.awt.Container.processEvent(Unknown Source)
                at java.awt.Component.dispatchEventImpl(Unknown Source)
                at java.awt.Container.dispatchEventImpl(Unknown Source)
                at java.awt.Component.dispatchEvent(Unknown Source)
                at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
                at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
                at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
                at java.awt.Container.dispatchEventImpl(Unknown Source)
                at java.awt.Window.dispatchEventImpl(Unknown Source)
                at java.awt.Component.dispatchEvent(Unknown Source)
                at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
                at java.awt.EventQueue.access$000(Unknown Source)
                at java.awt.EventQueue$1.run(Unknown Source)
                at java.awt.EventQueue$1.run(Unknown Source)
                at java.security.AccessController.doPrivileged(Native Method)
                at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
                at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
                at java.awt.EventQueue$2.run(Unknown Source)
                at java.awt.EventQueue$2.run(Unknown Source)
                at java.security.AccessController.doPrivileged(Native Method)
                at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
                at java.awt.EventQueue.dispatchEvent(Unknown Source)
                at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
                at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
                at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
                at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
                at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
                at java.awt.EventDispatchThread.run(Unknown Source)
2012-11-12 10:09:54,206 [AWT-EventQueue-0] ERROR com.splwg.oms.jbot.adapter.JDialogAdapter:  eventID = SelectPerform
java.util.concurrent.RejectedExecutionException
                at com.splwg.oms.client.util.ClientThreadPool$MyRejectedHandler.rejectedExecution(ClientThreadPool.java:170)
                at java.util.concurrent.ThreadPoolExecutor.reject(Unknown Source)
                at java.util.concurrent.ThreadPoolExecutor.execute(Unknown Source)
                at java.util.concurrent.AbstractExecutorService.submit(Unknown Source)
                at com.splwg.oms.jbot.adapter.JBotAdapter.processCommands(JBotAdapter.java:652)
                at com.splwg.oms.jbot.adapter.JBotAdapter.processEvent(JBotAdapter.java:591)
                at com.splwg.oms.jbot.listener.JTableAdapterListener.valueChanged(JTableAdapterListener.java:106)
                at com.splwg.oms.jbot.listener.JTableAdapterListener.selected(JTableAdapterListener.java:41)
                at com.splwg.oms.jbot.component.JBotTable.fireJBotSelection(JBotTable.java:376)
                at com.splwg.oms.jbot.component.JBotTable.changeSelection(JBotTable.java:240)
                at javax.swing.plaf.basic.BasicTableUI$Handler.mouseDragged(Unknown Source)
                at java.awt.AWTEventMulticaster.mouseDragged(Unknown Source)
                at java.awt.Component.processMouseMotionEvent(Unknown Source)
                at javax.swing.JComponent.processMouseMotionEvent(Unknown Source)
                at java.awt.Component.processEvent(Unknown Source)
                at java.awt.Container.processEvent(Unknown Source)
                at java.awt.Component.dispatchEventImpl(Unknown Source)
                at java.awt.Container.dispatchEventImpl(Unknown Source)
                at java.awt.Component.dispatchEvent(Unknown Source)
                at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
                at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
                at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
                at java.awt.Container.dispatchEventImpl(Unknown Source)
                at java.awt.Window.dispatchEventImpl(Unknown Source)
                at java.awt.Component.dispatchEvent(Unknown Source)
                at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
                at java.awt.EventQueue.access$000(Unknown Source)
                at java.awt.EventQueue$1.run(Unknown Source)
                at java.awt.EventQueue$1.run(Unknown Source)
                at java.security.AccessController.doPrivileged(Native Method)
                at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
                at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
                at java.awt.EventQueue$2.run(Unknown Source)
                at java.awt.EventQueue$2.run(Unknown Source)
                at java.security.AccessController.doPrivileged(Native Method)
                at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
                at java.awt.EventQueue.dispatchEvent(Unknown Source)
                at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
                at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
                at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
                at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
                at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
                at java.awt.EventDispatchThread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:44:56.037

这意味着您的线程池无法像添加任务一样快地完成任务 - 队列会不断增长，直到您用完空间。解决方案：

*   更多线程（有一个限制，您将不会有任何改进）
*   更大或无限的队列（部分解决，只会延迟问题）
*   较小的任务（你最好的选择）

# ajax - ajaxSubmit 到当前的 jQuery 选项卡

> ID：13352022
> 
> 赞同：0
> 
> 时间：2012-11-12T21:41:24.110
> 
> 标签：ajax, jquery-ui, jquery

我知道如何获取索引，但这似乎不是我需要发布到标签本身的内容。

这是我上一篇文章的延续，但不同的问题： [将 jQuery 表单结果提交回动态选项卡](https://stackoverflow.com/questions/13349005/submiting-jquery-form-results-back-into-dynamic-tab/13349754#13349754)

我的选项卡表单现在以 100% 的成功提交，在我的 jQuery 验证内部，但我希望我的回复出现在它来自的选项卡中。

在我的 jQuery 验证结束时，我有：

```
 submitHandler: function(form) {

 var thisTab = $tabs.tabs('option', 'selected'); // what index are we?

 var options = {
     target: '#thisTab',

 };
 $(form).ajaxSubmit(options);
 return false;
 } 
```

它很接近，但我正在做的实际上是抓取所选选项卡的索引，这似乎不是我需要 ajaxSubmit 发布到的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:48:26.917

据我了解，您想将目标设置为 thisTab，但您将目标设置为 jQuery 选择字符串`#thisTab`，

这意味着目标是 id 为“thisTab”的元素。

[来自 Jquery 表单插件 API](http://www.malsup.com/jquery/form/#options-object)

> **目标**
> 
> 标识页面中要使用服务器响应更新的元素。该值可以指定为 jQuery 选择字符串、jQuery 对象或 DOM 元素。默认值：空

所以你应该设置`thisTab`为目标。

# 更新 ：

主要问题是您试图将选项卡设置为目标元素，您应该将 selectedPanel 设置为目标。

```
 submitHandler: function(form) {

 var thisPanel = $tabs.tabs('option', 'selectedPanel'); // what index are we?

 var options = {
     target: thisPanel,

 };
 $(form).ajaxSubmit(options);
 return false;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:11:39.470

嗯，也许我不清楚，我没有解释它。

我想要的是 update.cfm 的输出显示在包含我刚刚更新的详细信息的同一动态选项卡正文中。我尝试了你的建议，当我点击提交时它所做的只是眨眼。它确实提交了，我可以使用 firebug 查看帖子和回复，但没有显示回复。所以我确实希望标签作为目标。

然而，您所做的是向我展示了一个我不知道的新术语“selectedPanel”，这使我看到了我以前从未见过的这篇文章： [如何在 Jquery UI 选项卡中获取选定的选项卡面板元素？](https://stackoverflow.com/questions/1331335/how-to-get-the-selected-tab-panel-element-in-jquery-ui-tabs)

这导致我进行了以下更改：

```
 submitHandler: function(form) {

 var selectedPanel = $("#tabs div.ui-tabs-panel:not(.ui-tabs-hide)");

 var options = {
 target: selectedPanel

 };
 $(form).ajaxSubmit(options);
 return false;
 } 
```

# perl - 我的 Perl 5.14 缺少 NDBM_File

> ID：13352036
> 
> 赞同：0
> 
> 时间：2012-11-12T21:42:11.737
> 
> 标签：perl

我有一些旧的 Perl 代码，我正在尝试使用我构建的 Perl 5.14.1 构建。但由于某种原因，我没有 Perl 模块 NDBM_File。

```
$ perl -MNDBM_File -e1;
Can't locate NDBM_File.pm in @INC (@INC contains: /apps/perl-5.14.1/lib/dev_perl/x86_64-linux-thread-multi /apps/perl-5.14.1/lib/dev_perl /apps/perl-5.14.1/lib/vendor_perl/5.14.1/x86_64-linux-thread-multi /apps/perl-5.14.1/lib/vendor_perl/5.14.1 /apps/perl-5.14.1/lib/5.14.1/x86_64-linux-thread-multi /apps/perl-5.14.1/lib/5.14.1 /apps/perl-5.14.1/lib/site_perl .).
BEGIN failed--compilation aborted. 
```

这是我得到的 perl -V 输出...

```
Summary of my perl5 (revision 5 version 14 subversion 1) configuration:
Platform:
    osname=linux, osvers=2.6.32-220.17.1.el6.x86_64, archname=x86_64-linux-thread-multi
    uname='linux myhost.mydomain 2.6.32-220.17.1.el6.x86_64 #1 smp thu apr 26 13:37:13 edt 2012 x86_64 x86_64 x86_64 gnulinux '
config_args='-Dcc=gcc -A ccflags=-fPIC -Dprefix=/apps/perl-5.14.1 -Dsitelib=/apps/perl-5.14.1/lib/dev_perl -Dvendorprefix=/apps/perl-5.14.1 -Dotherlibdirs=/apps/perl-5.14.1/lib/site_perl -Duseithreads=define -de'
hint=recommended, useposix=true, d_sigaction=define
useithreads=define, usemultiplicity=define
useperlio=define, d_sfio=undef, uselargefiles=define, usesocks=undef
use64bitint=define, use64bitall=define, uselongdouble=undef
usemymalloc=n, bincompat5005=undef
Compiler:
cc='gcc', ccflags ='-D_REENTRANT -D_GNU_SOURCE -fPIC -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64',
optimize='-O2',
cppflags='-D_REENTRANT -D_GNU_SOURCE -fPIC -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include'
ccversion='', gccversion='4.4.6 20110731 (Red Hat 4.4.6-3)', gccosandvers=''
intsize=4, longsize=8, ptrsize=8, doublesize=8, byteorder=12345678
d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=16
ivtype='long', ivsize=8, nvtype='double', nvsize=8, Off_t='off_t', lseeksize=8
alignbytes=8, prototype=define
Linker and Libraries:
ld='gcc', ldflags =' -fstack-protector -L/usr/local/lib'
libpth=/usr/local/lib /lib/../lib64 /usr/lib/../lib64 /lib /usr/lib /lib64 /usr/lib64 /usr/local/lib64
libs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
perllibs=-lnsl -ldl -lm -lcrypt -lutil -lpthread -lc
libc=/lib/libc-2.12.so, so=so, useshrplib=false, libperl=libperl.a
gnulibc_version='2.12'
Dynamic Linking:
dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags='-Wl,-E'
cccdlflags='-fPIC', lddlflags='-shared -O2 -L/usr/local/lib -fstack-protector'

Characteristics of this binary (from libperl): 
  Compile-time options: MULTIPLICITY PERL_DONT_CREATE_GVSV
                    PERL_IMPLICIT_CONTEXT PERL_MALLOC_WRAP
                    PERL_PRESERVE_IVUV USE_64_BIT_ALL USE_64_BIT_INT
                    USE_ITHREADS USE_LARGE_FILES USE_PERLIO USE_PERL_ATOF
                    USE_REENTRANT_API
Built under linux
Compiled at Aug 27 2012 14:20:48
@INC:
/apps/perl-5.14.1/lib/dev_perl/x86_64-linux-thread-multi
/apps/perl-5.14.1/lib/dev_perl
/apps/perl-5.14.1/lib/vendor_perl/5.14.1/x86_64-linux-thread-multi
/apps/perl-5.14.1/lib/vendor_perl/5.14.1
/apps/perl-5.14.1/lib/5.14.1/x86_64-linux-thread-multi
/apps/perl-5.14.1/lib/5.14.1
/apps/perl-5.14.1/lib/site_perl
. 
```

我确实有这个文件...

```
/apps/perl-5.14.1/lib/5.14.1/Memoize/NDBM_File.pm 
```

...但是在“使用NDBM_File”中失败了。

我的 Perl 构建错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:49:58.957

从[https://metacpan.org/module/AnyDBM_File](https://metacpan.org/module/AnyDBM_File)：

```
odbm    ndbm    sdbm    gdbm    bsd-db
                        ----    ----    ----    ----    ------
Linkage comes w/ perl   yes     yes     yes     yes     yes
Src comes w/ perl       no      no      yes     no      no
... 
```

这意味着唯一支持“开箱即用”的 DBM 后端是 SDBM_File。我猜你必须安装`libgdbm-dev`软件包并重新编译你的 Perl。

# biztalk - 在 Biztalk 中，如何拆分带有额外元素的信封？

> ID：13352040
> 
> 赞同：2
> 
> 时间：2012-11-12T21:42:27.163
> 
> 标签：biztalk, pipeline, orchestration

我正在尝试以以下形式拆分传入的消息：

```
 <Items>
    <BatchID>123</BatchID>
    <Item>...</Item>
    <Item>...</Item>
    <Item>...</Item>
  </Items> 
```

我有一个带有 XML 反汇编器的管道，它采用 Items 模式并输出 Item 模式。在 Items 架构上，Envelope 属性设置为`true`，并且“Body XPath”属性指向 Items 元素。

但是，当我尝试处理文件时，我收到错误：`Finding the document specification by message type "BatchID" failed. Verify the schema deployed properly.`，大概是因为它只需要 Item 元素，并且它不知道如何处理 BatchID 元素。

如果我将 BatchID 设置为 Items 元素的属性（就像一个明智的人会拥有的那样），那么一切正常。不幸的是，我坚持布局。

这时候，我不在乎 BatchID 的值是多少。

我如何让它拆分消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T06:21:36.283

AFAIK Xml 反汇编程序总是提取指定元素的*所有子节点*`body_xpath`- 能够指定 Item Xpath 本来是一个不错的功能:(。

您可以通过以下任一方法解决此限制：

*   为不需要的`<BatchID>`元素创建一个模式，然后只吃它的实例，例如使用 TomasR 的[Null 适配器创建一个订阅发送端口](http://winterdom.com/dev/bts/)
*   或者，在对包络进行分批之前，在接收端口上的映射中转换包络，其中转换会去除不需要的`Batch`元素

以下 XSLT 应该可以解决问题：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:var="http://schemas.microsoft.com/BizTalk/2003/var" exclude-result-prefixes="msxsl var" version="1.0" xmlns:ns0="http://BizTalk_Server_Project3.Envelope">
    <xsl:output omit-xml-declaration="yes" method="xml" version="1.0" />
    <xsl:template match="/">
        <xsl:apply-templates select="/ns0:Items" />
    </xsl:template>
    <xsl:template match="/ns0:Items">
        <ns0:Items>
            <!--i.e. Copy all Item elements and discard the Batch elements-->
            <xsl:copy-of select="ns0:Item"/>
        </ns0:Items>
    </xsl:template>
</xsl:stylesheet> 
```

请参阅[此处](https://stackoverflow.com/questions/3716608/biztalk-2010-mapping-an-xsd-with-a-lot-of-elements-with-the-same-name/3718014#3718014)了解如何将 btm 从可视地图转换为 xslt

# c++ - 如何将指向静态分配对象的指针存储在向量中？

> ID：13352047
> 
> 赞同：0
> 
> 时间：2012-11-12T21:42:42.297
> 
> 标签：c++, pointers, reference

假设我想创建一个对象向量和另一个指向这些对象的指针向量（我不能使用动态内存）。我会这样做的方式是在下面的例子中。

```
#include <iostream>
#include <vector>

using namespace std;

class Foo {
public:
  int bar;
  Foo(int x) : bar(x) {
  }
};

int main () {
  vector<Foo> foos;
  vector<Foo*> pFoos;
  for (int i = 0; i < 10; i++) {
    Foo foo(i);
    foos.push_back(foo);
    pFoos.push_back(&foos.back());
  }

  for (int i = 0; i < 10; i++) {
    cout << foos[i].bar << endl;
    cout << pFoos[i]->bar << endl;
  }
} 
```

我认为这应该可行，因为`foos`存储了对象的副本，然后我存储了对副本的引用（因为原始文件`foo`将是未定义的，所以我不应该存储对它的引用）。但这就是我得到的：

```
0
36741184
1
0
2
2
3
3
4
4
5
5
6
6
7
7
8
8
9
9 
```

第一个数字`pFoos`是错误的。此外，大数字每次都在变化。我没有看到任何会导致这种未定义行为的东西。有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T21:45:37.493

将项目添加到向量会使所有先前的迭代器无效。如果向量需要重新分配其内部存储，则在向量上调用 push_back 可能会使您之前从它获得的指针无效。

如果您*知道*您永远不会再次增长向量，那么这将起作用：

```
for (int i = 0; i < 10; i++) {
  foos.push_back(Foo(i));
}

for (int i = 0; i < 10; i++) {
  pFoos.push_back(&foos[i]);
} 
```

或如rodrigo所说：

```
foos.reserve(10)

for (int i = 0; i < 10; i++) {
  Foo foo(i);
  foos.push_back(foo);
  pFoos.push_back(&foos.back());
}

for (int i = 0; i < 10; i++) {
  cout << foos[i].bar << endl;
  cout << pFoos[i]->bar << endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:47:04.790

我想这不是一个好的编程方法。该向量负责存储对象，它可能会重新分配内存以获得更大的内存块......所以，你的指针不再有效......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T21:48:54.553

`vector::push_back`可以移动元素，这就是地址无效的原因。您可以在开始将内容推入向量之前通过调用将向量的内存预加载到其最终大小`reserve`，或者您可以等到完成推入内容后再获取它们的地址。

但是你说你“不能使用动态内存”。`vector`使用动态内存。

# javascript - 在铁路 js 的应用程序范围内使变量可用

> ID：13352050
> 
> 赞同：0
> 
> 时间：2012-11-12T21:42:54.370
> 
> 标签：javascript, node.js, railway.js

我正在为我的新项目使用railwayjs，该项目使用护照框架进行身份验证。在`environment.js`文件中，我正在`require`配置护照详细信息。我有一个`auth`可以登录的控制器。因此，在 auth 控制器的操作中，我需要访问我在`environment.js`. 我怎么做？我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:10:37.050

您可以简单地创建一个全球性的，但可能存在特定于 railjs 的替代方案。

```
// environment.js
global.Auth = {user: "123"};

// Another file;
console.log(Auth); // {user: "123}; 
```

# java - 在 Google App Engine 1.7.3 中运行修改后的 Drools 5.5.0

> ID：13352051
> 
> 赞同：3
> 
> 时间：2012-11-12T21:43:02.880
> 
> 标签：java, google-app-engine, exception, drools, accesscontrolexception

我在 GAE 上运行 drools 5.5.0 的修改版本。**我使用了[red piranha 项目](http://code.google.com/p/red-piranha/wiki/ModifyDroolsRunInGoogleAppEngine)中的说明并将它们应用到 5.5.0 版本而不是 5.1.1 版本。**只要我在本地运行 GAE，我就可以毫无问题地使用 drools。但是，一旦部署了我的应用程序，每次我想运行规则时都会收到**AccessControlException 。**

```
Error processing rules: {0}
java.security.AccessControlException: access denied (java.lang.RuntimePermission getClassLoader)
at com.google.appengine.runtime.Request.process-cb8c197a61b3cb9b(Request.java)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:355)
at java.security.AccessController.checkPermission(AccessController.java:567)
at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
at java.lang.ClassLoader.getParent(ClassLoader.java:1224)
at org.drools.rule.JavaDialectRuntimeData$PackageClassLoader.loadClass(JavaDialectRuntimeData.java:581)
at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClass(ClassLoader.java:174)
at org.drools.rule.JavaDialectRuntimeData$PackageClassLoader.fastFindClass(JavaDialectRuntimeData.java:613)
at org.drools.util.CompositeClassLoader$CachingLoader.load(CompositeClassLoader.java:254)
at org.drools.util.CompositeClassLoader$CachingLoader.load(CompositeClassLoader.java:237)
at org.drools.util.CompositeClassLoader.loadClass(CompositeClassLoader.java:88)
at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
at org.drools.rule.JavaDialectRuntimeData.wire(JavaDialectRuntimeData.java:433)
at org.drools.rule.JavaDialectRuntimeData.reload(JavaDialectRuntimeData.java:481)
at org.drools.rule.JavaDialectRuntimeData.onBeforeExecute(JavaDialectRuntimeData.java:251)
at org.drools.rule.DialectRuntimeRegistry.onBeforeExecute(DialectRuntimeRegistry.java:138)
at org.drools.common.AbstractRuleBase.readExternal(AbstractRuleBase.java:328)
at org.drools.reteoo.ReteooRuleBase.readExternal(ReteooRuleBase.java:225)
at org.drools.impl.KnowledgeBaseImpl.readExternal(KnowledgeBaseImpl.java:116)
at java.io.ObjectInputStream.readExternalData(ObjectInputStream.java:1857)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1816)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1394)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:395)
at  AbstractRuleLoader.loadKnowledgeBase(AbstractRuleLoader.java:159)
at AbstractRuleLoader.loadRules(AbstractRuleLoader.java:40)
at RuleRunner.runStatelessRules(RuleRunner.java:48) 
```

有人在 GAE 上成功运行此版本的 drools 吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:20:07.377

好的，我可以通过返回由 red-piranha 定制的 5.1.1 版本的 Drools 来解决这个问题（请参阅[http://code.google.com/p/red-piranha/wiki/ModifyDroolsRunInGoogleAppEngine](http://code.google.com/p/red-piranha/wiki/ModifyDroolsRunInGoogleAppEngine)）。使用他们的 drools-{api,core}.jar 文件，只要我在本地将规则文件从 .drl 编译到 base64 并将生成的文件包含到 GAE 应用程序中，我就可以在本地和 GAE 上成功运行规则。这一切都在他们的维基页面上进行了描述。

**更新**：

我自己尝试实现规则代码。我的自定义解决方案比 drools 实现要快得多，并且使用的内存更少。使用 drools 可能会使您在最小的 GAE 实例类型上超过 128MB。在其他项目上，花更多的钱购买 256MB 的实例可能是值得的。特别是考虑到如果规则代码不必手写的话，可能会节省开发时间。不过，我运行规则代码的频率如此之高，以至于它变成了一个无法接受的性能问题，我不得不花时间自己编写规则代码。

# eclipse - Hibernate buildSessionFactory() 不适用于参数 (ServiceRegistry)

> ID：13352053
> 
> 赞同：4
> 
> 时间：2012-11-12T21:43:19.653
> 
> 标签：eclipse, hibernate, compiler-errors

我是 Hibernate 的新手，我正在尝试创建一个会话管理器。下面是创建`SessionFactory`实例的代码：

```
Configuration configuration = new Configuration().configure(config);
ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(
    configuration.getProperties()
).buildServiceRegistry();

SessionFactory sessionFactory = configuration.buildSessionFactory(serviceRegistry);
return sessionFactory; 
```

当我在 Eclipse 中运行它时，我得到以下编译错误：`The method buildSessionFactory() in the type Configuration is not applicable for the arguments (ServiceRegistry).`

使用最新的 Hibernate 版本，不应该`buildSessionFactory`接受`ServiceRegistry`参数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:51:46.527

确保您使用的是最新版本。您可以按照以下代码行检查 Hibernate 的版本。

```
System.out.println(org.hibernate.Version.getVersionString()); 
```

# performance - MongoLab 上用于地理空间查询的 MongoDB 性能

> ID：13352058
> 
> 赞同：3
> 
> 时间：2012-11-12T21:43:45.800
> 
> 标签：performance, mongodb, geospatial, mlab

我有一个包含超过 400,000 个文档的地方集合。我正在尝试进行地理空间查询，但它们似乎总是超时。从 MongoLab 界面我进行搜索：

```
{ "location": {"$near": [ 38, -122 ] } } 
```

页面只是超时。

还通过我的控制台运行了这个命令：

```
db.runCommand({geoNear: "places", near: [50,50], num:10}) 
```

它确实成功了，但需要大约 5 分钟才能完成。

我确实有一个地理空间索引。

```
location    { "location" : "2d"} 
```

对如此大的集合进行地理空间查询是不可能的（毕竟对于 MongoDB 集合来说非常小）？

编辑：MongoLab 就这个问题亲自联系了我。我的数据库似乎存在一些问题，例如许多地方还没有任何坐标。我还发现使用 maxDistance 可以显着加快查询速度，这让我回到了今天早上的问题：[so question](https://stackoverflow.com/questions/13349430/yii-emongodocuments-near-queries-ignoring-maxdistance)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:42:48.030

Mongolabs 技术人员向我指出，将很多经度纬度设置为 0,0 并且不使用 maxDistance 会减慢速度。添加 maxDistance 就像一个魅力..

因此，再次感谢 Mongolabs 的那个人。

# django - cv.CaptureFromCAM(0) 中的 Django 应用程序挂起

> ID：13352060
> 
> 赞同：1
> 
> 时间：2012-11-12T21:44:10.500
> 
> 标签：django, opencv

我正在尝试使用一个简单的 Django 应用程序从我的网络摄像头中获取图像。这是我的看法：

```
def show_home_page(request, template_name="content/homepage.html"):
""" show page """

    capture = cv.CaptureFromCAM(0)
    img = cv.QueryFrame(capture)
    cv.SaveImage("test.jpg",img) 

    return render_to_response(template_name, locals(), context_instance=RequestContext(request)) 
```

代码挂在行：capture = cv.CaptureFromCAM(0)

我尝试在一个简单的 python 应用程序中使用相同的代码并且有效：

```
import cv
from Tkinter import *     

def main():
    root = Tk() 
    capture = cv.CaptureFromCAM(0)
    img = cv.QueryFrame(capture)
    cv.SaveImage("test.jpg",img) 
    cv.ShowImage('Raw', img)
    root.mainloop()

if __name__ == '__main__':
    main() 
```

在这两种情况下，我都在 Eclipse 4.2.0、Mac OSx 山狮上的 Python 2.7 中运行程序。我使用 opencv-2.4.2

有什么线索吗？

提前致谢， 弗兰斯

# java - 在java中使用鼠标按下的ActionListener

> ID：13352062
> 
> 赞同：0
> 
> 时间：2012-11-12T21:44:14.797
> 
> 标签：java

我正在尝试在按下鼠标时激活执行的操作方法。这可能吗。我只能找到像这样的例子：

```
if(e.getsource() == button1){
....
} 
```

这个方法可以通过鼠标点击激活吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:46:51.710

您可以将[MouseListener](http://docs.oracle.com/javase/6/docs/api/java/awt/event/MouseListener.html)用于您的组件（然后从其鼠标单击事件中调用 actionListener。

请参阅：[http ://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html](http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html)

您可能希望创建第三个函数，该函数采用 a`JComponent source`并包含您的 actionlistener 代码并由 mouselistener 和 actionlistener 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:51:28.750

你可以试试下面的代码...

每次单击鼠标监听器放置的任何内容时，这只会在终端上打印“Hi”。将 contentPane 替换为您所称的任何内容，并且不要忘记您的导入语句。

```
contentPane.addMouseListener(new MouseAdapter() {
  @Override
  public void mouseClicked(MouseEvent arg0) {
    System.out.println("Hi");
  }
}); 
```

# javascript - jQuery Validate - 每个元素有多个规则？

> ID：13352077
> 
> 赞同：1
> 
> 时间：2012-11-12T21:45:10.397
> 
> 标签：javascript, jquery, html, validation, jquery-validate

我有一个表格，我想验证某些字段是必需的还是数字的。我无法弄清楚如何将这两个规则应用于所述字段。

目前，这是我仅应用所需规则的方式，在我已内置到表单中的范围内显示消息。

```
 if (jQuery.validator) {
    jQuery.validator.setDefaults({
        errorPlacement: function (error, element) {
            error.appendTo('#invalid-' + element.attr('id'));
        }
    });
}

$("#UserInputs").validate();

<label for="AvgGroupSize">Average Group Size:</label><br />
<span id="invalid-AvgGroupSize"></span>
<input type='text' id='AvgGroupSize' class='required' size='4' value='15'/> EEA's 
```

我如何能够向该字段添加第二个验证规则（数字）？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:57:01.160

您只需要在输入中添加一个类：
`<input type='text' id='AvgGroupSize' class='required digits' size='4' value='15'/>`EEA's

如果尚不存在数字验证类，则需要通过以下方式添加 i：[添加类规则](http://docs.jquery.com/Plugins/Validation/Validator/addClassRules#rules)

另一种选择可能只是向您的输入添加规则。

像这样的东西：

```
$("#AvgGroupSize").rules("add", {
 minlength: 2
}); 
```

阅读有关如何[添加规则的更多信息](http://docs.jquery.com/Plugins/Validation/rules#.22add.22rules)

# c - 如何设置动态内存和临时缓冲区？

> ID：13352078
> 
> 赞同：1
> 
> 时间：2012-11-12T21:45:12.190
> 
> 标签：c, memory, dynamic, malloc

我一直在尝试完成这段代码，但我一直在创建一个临时缓冲区。我以前从未学过这个，但不知何故我需要在我的程序中使用它。

从[这个网站](http://ctips.pbworks.com/w/page/7277635/TempReturnBuffer)我认为最好的选择是

```
char * func1() {
     char *buffer = (char *)malloc(1000);
     buffer[0] = '\0'; // Initialize buffer
     // Do processing to fill buffer
     return buffer;
} 
```

以下是我的代码

```
 #include <stdio.h>
#include <stdlib.h>
#define LUNCHES 5
#define ARRAY 2

int main(void)
{
    int x;
    struct Food
    {
        char *name;                                                            /* “name” attribute of food */
        int weight, calories;                                                  /* “weight” and “calories” attributes of food */
    }lunch[LUNCHES] = { [0] = {"apple", 4, 100}, [1] = {"salad", 2, 80} };

    for(x = ARRAY; x < LUNCHES; ++x)
    {
        char *buff = malloc(sizeof(lunch[x].name));

        printf("Please input \"food\", weight, calories: ");
        scanf("%s", buff);
        scanf("%d %d", &lunch[x].weight, &lunch[x].calories);
        printf("The %s weighs %doz. and contains %d calories.\n", lunch[x].name, lunch[x].weight, lunch[x].calories);

    }

    return 0;
} 
```

好的改变了。但现在的输出是

NULL 称重并包含 . 为什么为空？

已更正

```
#include <stdio.h>
#include <stdlib.h>
#define LUNCHES 5
#define ARRAY 2

int main(void)
{
    int x;
    struct Food
    {
        char *name;                                                            /* “name” attribute of food */
        int weight, calories;                                                  /* “weight” and “calories” attributes of food */
    }lunch[LUNCHES] = { [0] = {"apple", 4, 100}, [1] = {"salad", 2, 80} };

    for(x = ARRAY; x < LUNCHES; x++)
    {
        lunch[x].name = malloc(25 * sizeof(char));

        printf("Please input \"food\", weight, calories: ");
        scanf("%s", lunch[x].name);
        scanf("%d %d", &lunch[x].weight, &lunch[x].calories);
        printf("The %s weighs %doz. and contains %d calories.\n\n", lunch[x].name, lunch[x].weight, lunch[x].calories);

        free(lunch[x].name);

    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:07:07.123

首先，它是`for(x = ARRAY; x < LUNCHES; ++x)`- 注意`<`不是`<=`，否则你会溢出数组（索引是从零开始的，它从`0`to运行`LUNCHES-1`）。

至于分配：

*   you need to create buffer for every entry in the `lunch[]` array, hence in the for loop you need something like `lunch[x].name = malloc(SIZE)`, where `SIZE` is a reasonable value - for the purpose of meal name ~80 characters would seem more than enough;
*   next you **must** to check, that the pointer assigned to `lunch[x].name` is not `NULL`, which would signal out of memory condition - otherwise you might happen to cause a segmentation fault by dereferencing it;
*   then you can use the pointer (to the newly allocated buffer) as the argument to `scanf()`, but remember to specify the maximum width (i.e. `SIZE-1`), so that you don't overrun into unallocated memory.

Remember to use `free()` on the pointers to allocated memory when you don't need the data any more or at the end of the program - while in your simple example it's technically not necessary, it could easily start a very bad habit.

# css - 匹配类名以特定字符串开头的所有元素

> ID：13352080
> 
> 赞同：285
> 
> 时间：2012-11-12T21:45:23.437
> 
> 标签：css

是否可以对类名以 CSS3 中的特定字符串开头的元素使用“通配符”？

例子：

```
<div class="myclass-one"></div>
<div class="myclass-two"></div>
<div class="myclass-three"></div> 
```

然后神奇地将上述所有`div`s 一次性设置为红色：

```
.myclass* { color: #f00; } 
```

* * *

## 回答 #1

> 赞同：564
> 
> 时间：2012-11-12T21:46:56.137

以下应该可以解决问题：

```
div[class^='myclass'], div[class*=' myclass']{
    color: #F00;
} 
```

* * *

`*`编辑：按照大卫的建议添加了通配符 ( )

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-12T21:48:20.983

这不是问题的直接答案，但是我建议在大多数情况下简单地为每个元素设置多个类：

```
<div class="myclass one"></div>
<div class="myclass two></div>
<div class="myclass three"></div> 
```

通过这种方式，您可以为所有`myclass`元素设置规则，然后为`one`,`two`和设置更具体的规则`three`。

```
.myclass { color: #f00; }

.two { font-weight: bold; }

etc. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-12T21:48:46.090

您可以轻松地将多个类添加到 div... 所以：

```
<div class="myclass myclass-one"></div>
<div class="myclass myclass-two"></div>
<div class="myclass myclass-three"></div> 
```

然后在对共享类的 CSS 调用中应用相同的样式：

```
.myclass {...} 
```

你仍然可以像这样使用你的其他类：

```
.myclass-three {...} 
```

或者，如果您想在 CSS 中更具体，如下所示：

```
.myclass.myclass-three {...} 
```

# hibernate - Hibernate：在 HQL 查询中使用嵌入时出现异常

> ID：13352083
> 
> 赞同：4
> 
> 时间：2012-11-12T21:45:30.197
> 
> 标签：hibernate, jpa, hql, embeddable

我有一个客户购物应用程序。这些客户有一个包含产品的购物车。这是我使用的带有嵌入的（简化的）映射：

```
@Entity
class Customer {

  @Embedded
  private Cart cart;

  // Constructors, setters, equals... omitted
}

@Embeddable
class Cart {

  @ElementCollection
  @JoinTable(name = ...)
  private Set<Product> products = new HashSet<>();

  ...   
}

@Embeddable
class Product {

  private String name;

  ...
} 
```

现在，我正在尝试使用 HQL 获取客户的购物车。我知道我不能直接查询嵌入，但没有什么能阻止我选择它作为一个字段：

```
select c.cart from Customer c where c.id = 1 
```

但这会导致以下异常：

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: 0
    at org.hibernate.hql.ast.util.ColumnHelper.generateScalarColumns(ColumnHelper.java:62)
    at org.hibernate.hql.ast.tree.DotNode.setScalarColumnText(DotNode.java:661)
    at org.hibernate.hql.ast.tree.SelectClause.renderScalarSelects(SelectClause.java:359)
... 
```

我可以通过检索客户并遍历其 getCart() 方法来克服这个问题，但我想知道这个问题是否是由不正确的映射或类似的东西引起的。非常感谢！

# c# - JS 中未定义 HiddenField.value

> ID：13352085
> 
> 赞同：1
> 
> 时间：2012-11-12T21:45:36.207
> 
> 标签：c#, jquery, asp.net

在我的 aspx 标记中，我定义了以下内容：

```
<asp:HiddenField runat="server" ClientIDMode="Static" ID="hidField" /> 
```

我有如下 C# 代码，它为我的隐藏字段提供了一个值：

```
hidField.value = check().ToString(); 
```

为简单起见，假设 check 是一个返回 true 的函数。

我制作了 JS 代码来执行以下操作：

```
_myBool = $("#hidField");
alert(_myBool.value); 
```

这警告未定义。

出于调试目的，我单步执行并看到在 C# 中，hidField.value 确实是真的。我尝试警告返回 1 的 _myBool.length 和返回 [Object object] 的 _myBool，所以我不会在未定义时调用未定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:47:24.853

缺少**$**符号..

```
var  _myBool = $("#hidField");

alert(_myBool[0].value); // DOM Object 

alert(_myBool.val() );  // jQuery Object 
```

另请注意，选择器可能不适用于`runat="server"`属性，因为它预先添加了内容占位符..

这是一个更好的选择器

```
 var _myBool = $('[id*="hidField"]'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:48:12.940

试试这个

```
_myBool = $("#hidField");  //my bool is a jQuery Object
alert(_myBool.val());   //can only get value with .val() 
```

或者

```
_myBool = $("#hidField")[0];  //[0] gets the element in the object
alert(_myBool.value);  //can use the javascript .value 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T21:49:02.197

您忘记了美元符号，还使用了 val() 函数

```
alert($("#hidField").val()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:15:16.500

确保您使用的是正确的 ID：

```
_myBool = $("#<%= hidField.ClientID %>").val(); 
```

在页面加载时查看您的源代码并检查该字段。ID 可能不是“hidField”。上面的代码是正确的。

# svn - 颠覆：如何管理调整文件

> ID：13352088
> 
> 赞同：2
> 
> 时间：2012-11-12T21:45:37.730
> 
> 标签：svn

我们小组正在考虑迁移到 SVN。但是，我似乎无法找到执行以下操作的方法：

我需要在本地对存储库中的大约 20 个文件进行细微调整，而 SVN 认为它们“已更改”并包含在提交中。（通信超时和日志记录级别等更改。）

理想情况下，我希望将调整后的文件合并到存储库中的较新版本。（通过其他用户提交的更改使调整后的本地文件保持最新。）

我无法想象我们在想要/需要这个方面是独一无二的。

是否有围绕此类用例的最佳实践？

我正在考虑的一件事是将所有调整后的文件放入分支的“调整后”工作副本中。

然后将我调整过的文件合并到我的“官方”工作副本中。

然后使用比较“调整”和“官方”工作副本的脚本来更新我的忽略列表。该脚本还将取消忽略并提醒我注意任何可能需要提交到存储库的调整*和其他更改的文件。*

这似乎有点hacky，我无法想象没有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T00:24:28.743

每当您在存储库中有文件但您不想更改时，您最终都会更改这些文件。您使用什么版本控制系统并不重要。有人会不小心更改这些文件。

有几件事可以提供帮助：

1.  我有一个[预提交挂钩](https://github.com/qazwart/SVN-Precommit-Kitchen-Sink-Hook)，可以防止意外更改特定文件。你说它们是只读的，如果有人试图对它们提交更改，提交将被拒绝。
2.  也可以使用更改列表。您可以创建要修改的文件的更改列表，然后使用更改列表。当然，可能会发生意外更改（请参阅第 1 点中的预提交挂钩）。
3.  要考虑的一件事是改变你的工作方式。如果这些*调整文件*有可替换的参数怎么办。然后使用您的构建系统来调整这些文件。我使用 Ant 并设置了一个`build.template.properties`允许人们调整构建的文件。该文件已签入，但假设开发人员将其复制到`build.properties`并按照他们想要的方式对其进行调整。我使用`svn:ignore`和我的预提交钩子来确保没有人检查实际`build.properties`文件。
4.  在 Subversion 中，分支既便宜又容易。将文件放在分支上并在那里进行更改。您可以通过定期将原始分支合并回此分支来使分支保持最新。从 1.5 版开始，Subversion 具有出色的合并跟踪方法，可以防止重复合并。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:51:47.653

根据您使用的语言，您是否可以不从定义值的单个文件中加载这些调整，并拥有一组提交给源代码控制的默认值，并允许每个开发人员创建自己的“调整”文件，这些文件被忽略?

这样，源代码中的版本是一致且稳定的，具有合理合理的默认值，但是开发人员可以在本地副本上调整他们的内心内容。

听起来不像是版本控制问题，更像是“我们如何获取值来覆盖可调整设置”的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T04:19:08.607

旁注：如果

> 我需要在本地对存储库中的大约 20 个文件进行细微调整，而 SVN 认为它们“已更改”并包含在提交中。

在您的工作流程中是相当普遍的要求，那么您可以考虑不使用 Subversion，而是使用 fe、带有 MQ+mqcollab 扩展的 Mercurial 或 hg commit 中的 -X 选项

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T04:29:13.170

只是不要提交包含设置的文件。提交作为设置的“待配置模板”的文件。然后（如果你很友好）删除一个“readme.txt”文件，解释复制模板文件，在编辑器中打开它，并设置适当的值作为文件在其注释中描述的值。

你并不是唯一需要每次安装“调整”的，但你为什么要首先提交它们。源代码控制不是“系统备份”，它是源代码控制。

PS。如果你真的需要像上面那样配置 20 个不同的文件，考虑改进你的配置控制的集中化。

# python - 脚本执行在 os.execlpe() 处停止

> ID：13352092
> 
> 赞同：1
> 
> 时间：2012-11-12T21:45:51.563
> 
> 标签：python

我在 Python 上有点新手，但正在测试我在 Ubuntu 上学到的一些东西。基本上，该脚本应该设置您的 TCP/IP 配置，然后重新启动网络守护程序并显示更改。

这是整个脚本：

```
#!/usr/bin/env python
import commands
import os
import sys

euid = os.geteuid()
if euid != 0:
    print "Script not started as root. Running sudo.."
    args = ['sudo', sys.executable] + sys.argv + [os.environ]
    # the next line replaces the currently-running process with the sudo
    os.execlpe('sudo', *args)

print 'Running. Your euid is', euid

print "IP"
IP = raw_input(">>")
print "Gateway"
PE = raw_input(">>")

ifconfig = commands.getoutput("ifconfig")
interfaz = ifconfig[0:5]

ArchivoInterfaces = open("/etc/network/interfaces", "w")
ArchivoInterfaces.write("#auto lo\n#iface lo inet loopback\nauto %s\niface %sinet static\naddress %s\ngateway %s\nnetmask 255.255.255.0"%(interfaz, interfaz, IP, PE))
ArchivoInterfaces.close()

ArchivoResolv = open("/etc/resolv.conf", "w")
ArchivoResolv.write("# Generated by NetworkManager\ndomain localdomain\nsearch localdomain\nnameserver 8.8.8.8\nnameserver 8.8.4.4")
ArchivoResolv.close()
os.execlpe('/etc/init.d/networking', "test","restart", os.environ)
print "Todo esta correcto, su IP ahora es %s" %(IP)
fin = raw_input("write d and press enter to show the changes, or press enter to exit.")

if fin == "d":
    ArchivoResolv = open("/etc/resolv.conf")
    ArchivoInterfaces = open("/etc/network/interfaces")
    ifconfig2 = commands.getoutput("ifconfig")
    print "ARCHIVO resolv.conf\n"+ArchivoResolv.read()+"\n\n"+"ARCHIVO interfaces\n"+ArchivoInterfaces.read()+"\n\n"+"RESULTADO DE \"ifconfig\"\n"+ifconfig2
    fin = raw_input("Presiona ENTER para salir.") 
```

不幸的是，它一直停在这条线上——我不知道为什么：

```
os.execlpe('/etc/init.d/networking', "test","restart", os.environ) 
```

到达此位置后，脚本运行重新启动，然后退出。

我很想让它运行脚本的最后一部分，这样我就可以看到发生了什么变化，但我做不到。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:47:42.923

因为所有`exec`功能系列都是通过将当前流程替换为您执行的流程来工作的。

如果您只想运行外部命令，请改用这些`spawn`函数。（在这种情况下，`os.spawnlpe`几乎是直接替代品。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:48:57.717

[`os.execlpe`](http://docs.python.org/2/library/os.html#os.execlpe)（以及类似的 os.exec* 函数）替换当前进程：

> 这些函数都执行一个新程序，**替换**当前进程；**他们不回来。**

# matlab - 反复按 ctrl+c 有什么意义吗？

> ID：13352094
> 
> 赞同：2
> 
> 时间：2012-11-12T21:45:54.037
> 
> 标签：matlab, kill, sigint

经常（例如使用matlab）我不小心执行了一些程序。我尝试通过按 CTRL+C 来中断它。有时这有效，有时则无效，我一直疯狂地点击它，直到程序最终停止。这些额外的 ctrl+c 是在做什么，还是只是一场雨舞？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:50:31.720

这完全取决于如何[`SIGINT`](http://en.wikipedia.org/wiki/SIGINT_%28POSIX%29#SIGINT)处理。很可能您的后续`CTRL+C`按下没有做任何事情，而您只是在程序尝试自行清理时不耐烦，尽管程序员可能决定忽略前*n* `CTRL+C`次按下然后允许*n + 1*退出程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:50:57.097

该`^C`信号可以作为异常捕获。您可能会在捕获该异常的一段代码中点击`Ctrl`+ ，但它没有结果。`C`这可能是故意的，也可能只是一个过于宽泛的捕获块。下一次，您可能会按下这些键，它们会产生预期的效果。

虽然敲击这些键可以在单次按下无法工作的情况下工作，但它可能更能说明软件需要一些改进，而不是真正的解决方案。

# java - oracle sql排序规则

> ID：13352095
> 
> 赞同：0
> 
> 时间：2012-11-12T21:46:09.740
> 
> 标签：java, sql, oracle, collate

我有一个关于 sql 的问题。我使用 jDeveloper 和 oracle sql developer。

我想让搜索大小写不敏感，我这样写：

```
 String word = jTextField5.getText();
        ResultSet rs = statement.executeQuery("SELECT NAMES, AUTHOR, ID FROM BOOKS WHERE NAMES LIKE '%"+word+"%' OR AUTHOR LIKE '%"+word+"%' COLLATE Latin1_General_CS_AS "); 
```

但我收到错误：java.sql.SQLException: ORA-00933: SQL 命令未正确结束

我应该怎么做才能解决这个问题。顺便说一句，我是 SQL 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:53:49.180

`COLLATE Latin1_General_CS_AS`不是 oracle 语法的东西，它看起来像 sql server 的东西

您的基本 sql 可能是：

```
ResultSet rs = statement.executeQuery("SELECT NAMES, AUTHOR, ID FROM BOOKS WHERE upper(NAMES) LIKE upper('%"+word+"%') OR upper(AUTHOR) LIKE upper('%"+word+"%') "); 
```

但无论如何，这是一个全表/全索引扫描，所以不会很快。对于快速字符串搜索，Oracle 有[oracle text](http://docs.oracle.com/cd/B19306_01/text.102/b14217/quicktour.htm#sthref59)。如果您需要执行这些类型的无界搜索（在大表上），我建议您阅读并实施文本索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:50:47.643

另一种选择是切换会话以使用语言字符比较：

```
ALTER SESSION SET nls_comp = Linguistic;
ALTER SESSION SET nls_sort = XGerman_CI;

SELECT NAMES, AUTHOR, ID 
FROM BOOKS 
WHERE NAMES LIKE '%foo%' 
  OR AUTHOR LIKE '%bar%' 
```

这比“仅仅”对值进行 UPPER 更高级一些，因为它考虑了语言的规则（例如在德语`ß`中相当于`ss`

它将像使用 的解决方案一样使用全表扫描`UPPER`，但这是因为`%`在搜索值的开头 - 而不是因为 NLS 设置（或应用`upper`函数。两个表达式都可以由索引支持。不像 PostgreSQL Oracle永远不能将索引用于`%foo%`条件，只能用于`foo%`.

有关可用 NLS_SORT 值的列表，请参见[此处](http://docs.oracle.com/cd/B28359_01/server.111/b28298/applocaledata.htm#i637232)

有关语言搜索和排序如何工作的详细说明，请参见[此处](http://docs.oracle.com/cd/B28359_01/server.111/b28298/ch5lingsort.htm)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-12T21:53:12.863

你需要：

WHERE NAMES COLLATE Latin1_General_CS_AS LIKE '%"+word+"'% OR AUTHOR COLLATE Latin1_General_CS_AS LIKE '%"+word+"%', etc....

# spring - 如何使用maven将依赖项打包到jar中？

> ID：13352098
> 
> 赞同：0
> 
> 时间：2012-11-12T21:46:14.793
> 
> 标签：spring, maven, plugins, jar, executable-jar

背景：我正在使用 Spring 和 Maven 开发一个独立的应用程序。我想从我的应用程序创建一个 jar，以便我可以将它部署在远程服务器上并对其进行测试。

我面临以下问题，

(1) 当我通过 Eclipse 将此 jar 导出为可执行 jar 时，我遇到了异常。

```
Exception in thread "main" 

org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Unable to locate Spring NamespaceHan
dler for XML schema namespace [http://www.springframework.org/schema/context]
Offending resource: class path resource [applicationContext.xml] 
```

由于上述与 spring.handlers 文件命名空间冲突的问题，因此，我想在 Maven 中使用插件创建一个 jar，如下所示。

```
 <plugin>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.2</version>
            <configuration>
            <archive>
                <manifest>
                  <addClasspath>true</addClasspath>
                  <mainClass>com.comcast.start.Application</mainClass>
                </manifest>
        </archive>
            <shadedArtifactAttached>true</shadedArtifactAttached>
            <shadedClassifierName>jar-with-dependencies</shadedClassifierName>
            <finalName>ds</finalName>
            <transformers>
                <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                    <resource>META-INF/spring.handlers</resource>
                </transformer>
                <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                    <resource>META-INF/spring.schemas</resource>
                </transformer>
                <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                    <resource>META-INF/spring.tooling</resource>
                </transformer>
            </transformers>
        </configuration>
        </plugin>

        <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <executions>
                  <execution>
                    <id>copy-dependencies</id>
                    <phase>package</phase>
                    <goals>
                      <goal>copy-dependencies</goal>
                    </goals>
                    <configuration>
                      <outputDirectory>${project.build.directory}/alternateLocation</outputDirectory>
                      <overWriteReleases>false</overWriteReleases>
                      <overWriteSnapshots>false</overWriteSnapshots>
                      <overWriteIfNewer>true</overWriteIfNewer>
                    </configuration>
                  </execution>
                </executions>
         </plugin> 
```

但这里的问题是我找不到将依赖库复制到我的 jar 文件中的插件。复制依赖插件会将文件复制到我的工作区，但不会将库放入我的 jar 文件中。

因为，我必须在远程机器上运行这个独立的 jar，所以在创建 jar 时，所有依赖库都应该打包在这个 jar 中。

如果您有一些想法，请提出建议。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:27:40.817

您似乎正在尝试创建独立的可执行 jar。 *（或者，您的主要目标是将依赖项放在一个文件中吗？ - 请让这个更干净）*

有几种方法可以做到这一点，让我列出一些：

1.  只需将[依赖项解压缩](https://maven.apache.org/plugins/maven-dependency-plugin/examples/unpacking-project-dependencies.html)到`${project.build.outputDirectory}`- 仅适用于简单情况
2.  使用[maven-shade-plugin](http://maven.apache.org/plugins/maven-shade-plugin/examples/executable-jar.html)大致相同，但解决资源冲突
3.  使用[onejar-maven-plugin](http://code.google.com/p/onejar-maven-plugin/)将依赖 jar 嵌入到主 jar 中，并使用自定义类加载器创建启动器来运行它

您的片段似乎是前两种方法的无效混合*（因为`maven-jar-plugin`不支持`shaded*`和`transformers`属性）*

请注意，在某些情况下，您不能使用前两个 - 因为某些框架会扫描类路径以列出正在使用的库，而这些会将许多清单简化为一个。

大多数情况下，第三个工作正常。它也是我最喜欢的，因为它包含未经修改的原始 jar，这让我对结果更有信心，尤其是在尝试不稳定的库时。

# android - Android中的多普勒/合成效果？

> ID：13352099
> 
> 赞同：1
> 
> 时间：2012-11-12T21:46:27.157
> 
> 标签：android, soundpool, sound-synthesis

在 Android 中，`SoundPool.play`API 允许播放音效。我想知道如何更改参数以实现多普勒效应：

```
public final int  play (
    int soundID,
    float leftVolume,
    float rightVolume,
    int priority,
    int loop,
    float rate) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:06:24.550

多普勒频移公式为：`f = f0 * (c + vr) / (c + vs)`，其中 vs/vr - 发送器和接收器的速度，c 是声音的速度（空气为 300m/s），您可以将`(c+vr)/(c+vs)`其用作您的`rate`参数`play()`。

如果您需要，这里是有关[多普勒频移](http://en.wikipedia.org/wiki/Doppler_effect)的附加信息。

# c++ - 有效合并两个排序的链接列表

> ID：13352101
> 
> 赞同：0
> 
> 时间：2012-11-12T21:46:43.380
> 
> 标签：c++, algorithm, merge, linked-list

> **可能重复：**
> [合并两个排序的链接列表](https://stackoverflow.com/questions/13345262/merge-two-sorted-link-lists)

我想通过指针操作合并两个排序的链接列表，并达到了这一点。无法弄清楚这是否是最有效的程序（内存方面以及时间方面）。请帮帮我。我想让它变得高效，不想再列出一个清单。

也许在两个链接列表中输入数据值的另一种方式......可能是。：） 帮我。我想不通。

```
#include<iostream>
#include<conio.h>
using namespace std;
struct s
{
   int info;
   s *next;
};

int main()
{
int i;
char choice = 'y';
s *ptr1, *ptr2, *start1, *start2, *reversedHead, *temp;
ptr1= new s;
start1=ptr1;
cout<<"SIZE OF A NODE IS "<<sizeof(s)<<" BYTES"<<endl<<endl;
while(choice=='y')
{
                  cout<<"Enter info for node: ";
                  cin>>i;
                  ptr1->info = i;
                  cout<<"Do you wish to enter more nodes.? 'y'/'n'"<<endl;
                  cin>>choice;

                  if(choice=='y')
                  {
                                 ptr1->next = new s;
                                 ptr1 = ptr1->next;
                  }
                  else
                  {
                      ptr1->next = NULL;
                  }
}
choice = 'y';
ptr2= new s;
start2=ptr2;
cout<<"SIZE OF A NODE IS "<<sizeof(s)<<" BYTES"<<endl<<endl;
while(choice=='y')
{
                  cout<<"Enter info for node: ";
                  cin>>i;
                  ptr2->info = i;
                  cout<<"Do you wish to enter more nodes.? 'y'/'n'"<<endl;
                  cin>>choice;

                  if(choice=='y')
                  {
                                 ptr2->next = new s;
                                 ptr2 = ptr2->next;
                  }
                  else
                  {
                      ptr2->next = NULL;
                  }
}

if(start1->info<start2->info)
{
                             ptr1=start1;
                             ptr2=start2;
}
else
{
    ptr1=start2;
    ptr2=start1;
}
while(ptr1 != NULL && ptr2 != NULL)
{
           if(ptr1->next==NULL)
           {
                ptr1->next=ptr2;
                while(ptr2!=NULL)
                ptr2=ptr2->next;
           }
           else if(ptr1->next->info >= ptr2->info)
           {
                temp=ptr2;
                ptr2=ptr2->next;
                temp->next=ptr1->next;
                ptr1->next=temp;
           } 
           else if(ptr1->next->info < ptr2->info)
                ptr1=ptr1->next;                       
}
cout<<"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n \n";                    
if(start1->info>=start2->info)
{                            ptr2=start2;
                             while(ptr2!=NULL){
                                              cout<<ptr2->info<<"\t";
                                              ptr2=ptr2->next;}
} 
else
{
                             ptr1=start1;
                             while(ptr1!=NULL){
                                              cout<<ptr1->info<<"\t";
                                              ptr1=ptr1->next;}
}          
getch();
} 
```

# regex - 正则表达式验证具有重复的字母范围

> ID：13352104
> 
> 赞同：2
> 
> 时间：2012-11-12T21:46:58.723
> 
> 标签：regex

我想使用正则表达式验证字母`A-Z`、、`AA-ZZ`等的字符串。`AAA-ZZZ`我知道`[A-Z]`将验证第一个案例，但其他案例呢。

```
A, B, C, D, E, .... Z 
```

或者

```
AA, BB, CC, DD, EE, .... ZZ 
```

或者

```
AAA, BBB, CCC, DDD, EEE, ... ZZZ 
```

等等...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T21:54:20.367

这写起来很痛苦，但是如果你想匹配任意数量的字母并要求它们都是同一个字母，你可以使用这样的东西：

```
^(A+|B+|C+|D+ ...)$ 
```

依此类推，直到字母表的其余部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T22:06:31.080

尝试

```
^(\w)\1*$ 
```

您匹配任何单词字符。如果超过一个字符，则必须相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T21:53:59.723

如果您的正则表达式引擎支持，您可以使用反向引用：

```
^([A-Z])\1*$ 
```

# python - python中的列表赋值行为

> ID：13352110
> 
> 赞同：3
> 
> 时间：2012-11-12T21:47:24.157
> 
> 标签：python, list, sorting, variable-assignment

来自其他语言，我对列表中 Python 变量赋值的方式有点困惑。例如，假设：

```
x = [4, 5, 2, 70, 1]
y = x
y.sort() 
```

如果打印 x 和 y，则两个变量的结果相同：

```
x = [1, 2, 4, 5, 70]
y = [1, 2, 4, 5, 70] 
```

我不太期待这种行为。我认为 x 的顺序不会改变，因为我只对列表 y 应用了排序方法。

另一方面，如果我使用切片运算符将列表 x 的内容分配给列表 y，那么我将实现预期的（至少在我的情况下）行为：

```
x = [4, 5, 2, 70, 1]
y = x[:]
y.sort() 
```

如果打印 x 和 y，我看到列表 x 保持不变。

```
x = [4, 5, 2, 70, 1]
y = [1, 2, 4, 5, 70] 
```

有人可以解释背后的逻辑吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T21:49:13.580

切片制作副本，而分配将两个标签指向同一个列表实例。排序`y`对列表实例进行排序，该实例与 指向的实例相同`x`。或者，您可以使用`y = sorted(x)`来获得您想要的结果。

# android - 如何判断 2 个片段是否具有来自同一类的实例

> ID：13352112
> 
> 赞同：7
> 
> 时间：2012-11-12T21:47:25.090
> 
> 标签：android, class, instance, fragment

假设我在容器中有一个片段，我应该用另一个片段替换它。

代码很简单：

```
getSupportFragmentManager().beginTransaction().
replace(R.id.content_frame,fragmentToAdd).addToBackStack(null).commit(); 
```

现在的问题是我想确保 fragmentToAdd 与我将替换的片段不相似。

如果是这种情况，应用程序应该什么都不做。

所以，我可以得到原来的片段：

```
Fragment originalFragment=(Fragment) getSupportFragmentManager().findFragmentById(R.id.content_frame); 
```

最终代码将类似于：

```
if (haveDifferentInstance(originalFragment,fragmentToAdd)){
    getSupportFragmentManager().beginTransaction().
    replace(R.id.content_frame,fragmentToAdd).addToBackStack(null).commit();}
else
    // Do nothing 
```

那么，haveDifferentInstance(Fragment fragmentA, Fragment fragmentB) 的代码可能是什么？

感谢您的帮助。

**编辑**

我知道我可以做类似的事情：

```
if (fragmentToAdd instanceof FragmentA) 
```

但是我有 FragmentA、FragmentB、.... Fragment F，我不想对每种类型的 Fragment 使用“if”。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-12T21:49:42.273

检查类是否相等：`if(origianalFragment.getClass().equals(fragmentToAdd.getClass()))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-19T14:33:39.683

您可以检查简单名称。

```
if (fragmentToAdd.class.getSimpleName().equals(originalFragment.getClass().getSimpleName()))
{
...
} 
```

# java - 为什么不打印到 Eclipse 中的控制台？

> ID：13352115
> 
> 赞同：1
> 
> 时间：2012-11-12T21:47:41.940
> 
> 标签：java, eclipse, io

鉴于此代码，我对为什么它不打印到控制台感到困惑......

```
 engine.compileTemplate(new PrintWriter(System.err));
    System.err.flush(); 
```

我在控制台上什么也没看到。System.out 也有同样的问题。是的，我通过成功打印到文件来验证代码是否有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:50:33.400

尝试使用[带有 autoflush 的构造函数](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html#PrintWriter%28java.io.OutputStream,%20boolean%29)。您正在刷新 System.err，而不是 PrintWriter。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T06:58:29.070

这段代码是在什么上下文中执行的？真的需要更多信息来确定发生了什么。

您的代码是否在您正在调试的插件中运行？如果是这样，那么使用“打印到控制台” - 您是指与您的插件相同的 Eclipse 实例的控制台吗？

为此，您需要执行以下操作：

```
MessageConsole console = new MessageConsole("My Console", null);
console.activate();
ConsolePlugin.getDefault().getConsoleManager().addConsoles(new IConsole[]{ console });
MessageConsoleStream consoleStream = console.newMessageStream();
consoleStream.println("Hello, world!"); 
```

否则，它会转到启动 Eclipse 的控制台。

在这里阅读更多：http: [//wiki.eclipse.org/FAQ_How_do_I_write_to_the_console_from_a_plug-in%3F](http://wiki.eclipse.org/FAQ_How_do_I_write_to_the_console_from_a_plug-in%3F)

# jquery - 删除样式 jQuery UI 手风琴

> ID：13352121
> 
> 赞同：0
> 
> 时间：2012-11-12T21:48:06.847
> 
> 标签：jquery, jquery-ui

我的问题是我是否可以在特定情况下清除样式（在这种情况下是手风琴放置我自己的样式），但是如果我想显示他们的样式，则调用 jquery ui css 来影响其他人。

```
clearStyle: true 
```

示例：http: [//jsfiddle.net/x9N3P/](http://jsfiddle.net/x9N3P/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:01:31.183

假设您的目标是仅在某些条件下覆盖默认样式（这个问题有点神秘），您可以尝试在您希望它们被覆盖时动态地将 CSS 类添加到容器元素中。然后，您可以使用以下内容应用您的样式：

```
.ui-accordion.override ul {
    background-color: yellow;
} 
```

以及添加类的某种事件：

```
$('#magicButton').click(function() { $('.ui-accordion').addClass('override'); }); 
```

# c# - 通过将给定数字添加到列表中所有元素的总和或其补码来找到最大结果的有效算法

> ID：13352122
> 
> 赞同：-3
> 
> 时间：2012-11-12T21:48:11.270
> 
> 标签：c#, java, algorithm, math

假设我有 number `x`、 list of numbers 和 max number `y`。我需要找到可以通过添加`x`列表中每个元素的加法或减法获得的最大结果，以使总和不超过`y`也不低于 0。

注意：您必须添加或减去列表中的每个元素，这意味着您不能跳过数字。

**例子：**

```
x= 3 y=10  list={2,6,1} 
```

Max i can get : `3 - 2 + 6 +1 = 8` which is less than 10 and >0
**failure case** for this will `3+2+6+1= 12` is which is > y so is invalid solution。
**另一个失败案例** `3-2-6 = -5` （这里不需要检查 6 之后的元素，因为你得到了 -ve number 被拒绝）

我怎样才能找到这个最大值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T21:56:15.653

所以，你基本上有一个 list`l`和一个 number `y-x`（如果你必须 add`x`和 get `y`，很容易看出它等同于 get `y-x`）并且你想要添加/减去每个元素`l`并尽可能接近 value `y-x`。

请注意，该问题等价于[Partition Problem](http://en.wikipedia.org/wiki/Partition_problem)，即[NP-Complete](http://en.wikipedia.org/wiki/NP-complete)，因为如果您有一个 list`l`和这样的值`y-x == 0`- 您需要找到两个`l1,l2`这样的子列表`sum(l1) - sum(l2) == 0`, 而`l1 union l2 = l`这正是分区问题。

因此 - 该问题没有已知的多项式解决方案。

我会看一下指数（例如回溯）解决方案，或[相关子集和问题的伪多项式 DP 解决方案](http://en.wikipedia.org/wiki/Subset_sum_problem#Pseudo-polynomial_time_dynamic_programming_solution)的变体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:18:06.243

这是解决方案：

```
 int x = 3, y = 10;
    var lst = new List<int>{ 1, 2, 3, 4 };
    int n = (int)Math.Pow(2, lst.Count);
    var lst2 = new List<List<int>>();
    for (int i = 0; i < n; i++)
    {
        var lstCopy = new int[lst.Count];
        lst.CopyTo(lstCopy);
        for (int j = 1; j <= i; j *= 2)
            if ((j & i) != 0)
                lstCopy[(int)Math.Log(j, 2)] *= -1;
        lst2.Add(lstCopy.ToList());
    }
    bool yes = lst2.Select(l=>x + l.Sum()).Any(l=>l > 0 && l < y);
    if (yes)
        Console.WriteLine(lst2.Select(l => x + l.Sum()).Where(l => l > 0 && l < y).First()); 
```

请注意，您需要检查 2^n 整数数组，其中 n 是原始数组的长度（它是您的 {2, 6, 1}）

# php - 如果 Chrome 或 Firefox 浏览器 (PHP)

> ID：13352128
> 
> 赞同：0
> 
> 时间：2012-11-12T21:48:24.233
> 
> 标签：php

我正在使用下面的代码来检查访问者是否正在使用 Chrome 浏览器：

```
<?php
function is_chrome()
{
return(eregi("chrome", $_SERVER['HTTP_USER_AGENT']));
}
if(is_chrome())
{
echo 'You are using Google Chrome Browser.';
}
?> 
```

还

```
<?php
function is_firefox()
{
return(eregi("firefox", $_SERVER['HTTP_USER_AGENT']));
}
if(is_chrome())
{
echo 'You are using Firefox Browser.';
}
?> 
```

工作正常，但我如何组合或如何使用“或”功能，以便检查 httpuseragent 是否包含“chrome”或“firefox”？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:51:46.397

[http://php.net/manual/en/language.operators.logical.php](http://php.net/manual/en/language.operators.logical.php)

> `$a or $b` 如果其中一个`$a`或为 TRUE，`$b`则为 TRUE。
> 
> `$a || $b` 如果其中一个`$a`或为 TRUE，`$b`则为 TRUE。

该页面还包括示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T21:52:30.713

只需使用：

```
if (is_chrome() || is_firefox()) {
echo 'you are using either Chrome or Firefox';
} 
```

因为我认为您的问题是：如果我有两个布尔函数，我如何测试一个或另一个是否为真，对吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T21:51:23.840

尝试这个：

```
function whatBr()
{
    $currentBr = '';
    if(eregi("firefox", $_SERVER['HTTP_USER_AGENT'])): $currentBr = 'firefox';
    elseif(eregi("chrome", $_SERVER['HTTP_USER_AGENT'])) $currentBr = 'chrome';
    endif;
    return $currentBr;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T21:52:39.043

```
if (stripos( $_SERVER['HTTP_USER_AGENT'], "chrome")>0){
 echo "Chromes";
}else if (stripos( $_SERVER['HTTP_USER_AGENT'], "firefox")>0){
 echo "Firefox: please install Chrome";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-12T21:54:00.343

查看[http://php.net/manual/en/function.get-browser.php](http://php.net/manual/en/function.get-browser.php)，我自己没有使用它，但它似乎没问题或[http://www.phpclasses.org/package/2827-PHP-检测用户浏览器类型和版本.html](http://www.phpclasses.org/package/2827-PHP-Detects-the-user-browser-type-and-version.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T21:52:25.953

```
if (preg_match('/(chrome|firefox)/', $_SERVER['HTTP_USER_AGENT'])) {
    echo 'Hello FF or Chrome!';
} 
```

# javascript - 检索不正确的表坐标

> ID：13352130
> 
> 赞同：0
> 
> 时间：2012-11-12T21:48:30.090
> 
> 标签：javascript, html

我使用表格创建了一个棋盘。我想检索单元格的 x 和 y 坐标。但是，`this.parentNode.rowIndex`一直给我-1。我花了无数个小时寻找错误。谁能帮我找到它？

```
var board = [[1, 0, 1, 0, 1, 0, 1, 0],
         [0, 1, 0, 1, 0, 1, 0, 1],
         [1, 0, 1, 0, 1, 0, 1, 0],
         [0, 0, 0, 0, 0, 0, 0, 0],
         [0, 0, 0, 0, 0, 0, 0, 0],
         [0, -1, 0, -1, 0, -1, 0, -1],
         [-1, 0, -1, 0, -1, 0, -1, 0],
         [0, -1, 0, -1, 0, -1, 0, -1]];

var gray = -1; //distinguishing players
var red = 1;

function makeBoard() {
//create a table
var tbl = document.createElement("table");
//create a <tr> for each row
for (var i = 0; i < 8; i++) {
    var tr = document.createElement("tr");

    //create a <td> for each column
    for (var j = 0; j < 8; j++) {
        var td = document.createElement("td");
        //setting the attributes of a square
        td.setAttribute("width", "50");
        td.setAttribute("height", "50");
        if ((i % 2 == 0 && j % 2 != 0) || (i % 2 !=0 && j % 2 == 0)) {
            td.style.backgroundColor = "black";
        }
        else if (board[i][j] == red) {
            td.style.backgroundColor = "red";
        }
        else if (board[i][j] == gray) {
            td.style.backgroundColor = "gray";
        }
        td.onclick = function() {
            alert(this.cellIndex + ", " + this.parentNode.rowIndex); //RETRIEVING WRONG COORDINATES
        }
        tr.appendChild(td);
    }
    tbl.appendChild(tr);
}
tbl.setAttribute("border", "10");
return tbl;
} 
```

如果您觉得缺少什么，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:13:58.977

尝试使用

`sectionRowIndex`而不仅仅是`index`..

似乎在 chrome 和 Firefox 中都可以正常工作

```
this.parentNode.sectionRowIndex 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/vsBpC/6/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:19:55.383

在这种情况下，缺少的 tbody 似乎并不是问题。看起来这与添加行和单元格的方式有关。

而不是使用 appendChild 你应该使用 table.insertRow 和 row.insertCell 方法

所以当添加一行时，而不是

```
var tr = document.createElement("tr"); 
```

利用

```
var tr = tbl.insertRow(0); 
```

同样适用于细胞，使用

```
var td = tr.insertCell(j); 
```

还要删除块末尾对 tr 和 td 的 appendChild 调用

在这里工作修复[http://jsfiddle.net/nBbd2/30/](http://jsfiddle.net/nBbd2/30/)

# zend-framework - 删除 302 重定向上的片段标识符

> ID：13352132
> 
> 赞同：0
> 
> 时间：2012-11-12T21:48:34.170
> 
> 标签：zend-framework, fragment-identifier, http-redirect

我有一个页面底部有一个表单。我在表单操作中使用了片段标识符，因为当出现错误时表单会在帖子中重新显示，并且我不希望用户必须向下滚动到它才能进行更正。

成功处理表单后，我执行重定向到同一页面并显示确认消息。我遇到的问题是浏览器[在 302 重定向时保留了片段标识符](https://stackoverflow.com/questions/2286402/url-fragment-and-302-redirects)。是否有强制浏览器清除/删除片段标识符的技巧？

* * *

假设我正在查看用户个人资料页面，页面上有一个地址表单。表单动作将是`/user/profile#AddressForm`. 如果表单提交时出错，页面会自动滚动到地址表单，以便用户更正错误。如果没有错误，我想重定向到`/user/profile`没有片段标识符的 。我遇到的问题是浏览器保留了片段标识符，并且页面向下滚动到表单，而不是停留在顶部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T18:09:21.100

**更新**

现在我看到了实际问题是什么，我建议重定向到不存在的锚点

```
header ('Location: /user/profile#top'); 
```

* * *

有。

```
$form->setAction ($this->getRequest ()->getRequestUri ()); 
```

# ruby - Ruby Datamapper 模型在 sql 查询中的表名中包裹了模块前缀模块名

> ID：13352137
> 
> 赞同：0
> 
> 时间：2012-11-12T21:48:53.167
> 
> 标签：ruby, datamapper, ruby-datamapper

我有一个数据映射器模型：

```
module abc
    class Post
         include DataMapper::Resource
         property :title, String
         property :body,  Text
    end
end 
```

请注意，我的课程围绕模块 abc

## 在其他文件中

我有：

```
abc::Post.all 
```

这应该调用查询：

```
select * from posts 
```

但它调用

```
select * from abc_posts 
```

表名加了前缀`abc_`。我怎样才能删除它。我不在模块周围保留模型，然后它按预期工作。但是我的代码库需要模型在模块内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T00:47:28.603

我在[http://rubydoc.info/github/datamapper/dm-core/master/DataMapper/NamingConventions/Resource/UnderscoredAndPluralizedWithoutModule找到了解决方案](http://rubydoc.info/github/datamapper/dm-core/master/DataMapper/NamingConventions/Resource/UnderscoredAndPluralizedWithoutModule)

```
repository(:myreponame).adapter.resource_naming_convention = DataMapper::NamingConventions::Resource::UnderscoredAndPluralizedWithoutModule 
```

更改：myreponame

也在[http://datamapper.rubyforge.org/dm-core/DataMapper/NamingConventions.html](http://datamapper.rubyforge.org/dm-core/DataMapper/NamingConventions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:24:37.483

您还可以明确设置存储名称：

[http://datamapper.org/docs/legacy.html](http://datamapper.org/docs/legacy.html)

# c++ - C++ cin.get(), cin.peek() 暂停，与 stdio 相同

> ID：13352141
> 
> 赞同：2
> 
> 时间：2012-11-12T21:49:03.123
> 
> 标签：c++, get, wait, cin, istream

这是我目前的代码。这段代码咳出了 cin.get() 上的错误。我知道这不是好的代码，它不应该是，我只是在测试一些 cin 的东西。

```
#include <string>
#include <iostream>
#include <stdio.h>

using namespace std;

int main(){
    char c[1000];
    cin.setstate(cin.eofbit);
    cout << cin.good() << endl;
    cout << cin.eof() <<endl;
    cout << cin.get() << endl;
    cin.putback('c');
    cout << cin.get() << endl;
    cout << "Do we ever reach this?" << endl;
    while(1){
    };
    return 0;
} 
```

反正。我的问题是 cin.get()、cin.peek()、cin.ignore()、getchar() 或几乎任何您可以命名的 cin 或 stdio 函数，当流为空时暂停我的程序的执行，无需设置EOF 位或任何东西。这对我来说很烦人，因为我想检查流中是否有任何东西以便我可以清除它，因为 ignore() 总是暂停。

我可以开始工作的唯一方法是“istream::readsome”。我已经将它加载到一个 char 数组中并使用 cout 打印它。它打印一长串我不认识的符号（每个符号都是一个单独的符号）。

[http://gyazo.com/e3ee65cdad7ed5cc7b2ce2307ca58c90](http://gyazo.com/e3ee65cdad7ed5cc7b2ce2307ca58c90)

转换为整数，结果为 -52，这不等于 ASCII 或 Unicode 中的任何内容。

我正在使用 Visual C++ Express 2010 进行编译。

请帮忙，在这一点上我完全被难住了。我只是想读取字符/刷新我的流，如果没有任何内容，则无需暂停。我花了 3 个小时试图解决这个问题。叹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:00:01.170

要摆脱所有已知可用的字符，您可以`std::istream::ignore()`结合使用`std::streambuf::in_avail()`：

```
std::cin.ignore(std::cin.rdbuf()->in_avail()); 
```

但是，我想这并没有真正做到你想要的：标准流对象只是读取操作系统提供给它们的任何东西。通常，连接到某种控制台窗口的输入的默认模式是对输入进行行缓冲。真正传递给流的字符数量几乎是未定义的。

要检查输入流上是否有可用的输入，您需要使用平台特定的方法。标准 C++ 库不提供任何非阻塞检查以查看新数据是否到达`std::cin`. 在 POSIX 系统上，您可以只使用`poll()`文件描述符`0`来查看是否`std::cin`有任何数据。我不知道非 POSIX 系统需要什么。

# regex - 匹配任何逗号分隔值的正则表达式

> ID：13352142
> 
> 赞同：1
> 
> 时间：2012-11-12T21:49:04.113
> 
> 标签：regex, csv

我正在尝试将正则表达式发送到将匹配逗号分隔值的 mongo db。

例如 'aaa' 应该匹配：

```
aaa, ancient, pattern, discipleship, faithful, followers         matches
lowers,aaa, gospel, righteousness, strengthen, family       matches
lowers, aaa , gospel, righteousness, strengthen, family     matches
lowers, goaaaspel, righteousness, strengthen, family        no match
lowers, aaaspel, righteousness, strengthen, family          no match
lowers, gospel aaa truth, righteousness, strengthen         no match
lowers, gospel aaa, righteousness, strengthen, family       no match
lowers, gospel, righteousness, strengthen, family aaa        no match
lowers, gospel, righteousness, strengthen, family, aaa       matches 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:03:55.310

这似乎适用于附加的示例：

```
(?<=,|^)(\s*)aaa(?=\s*,|\s*$) 
```

它基本上意味着'aaa'，它前面有行开始或逗号，后面有行结束或逗号。虽然它会捕获前导空格，但您可以通过分组来解决这个问题。

# php - 如何使用 MacPorts 切换到 PHP 5.4？

> ID：13352144
> 
> 赞同：9
> 
> 时间：2012-11-12T21:49:14.003
> 
> 标签：php, macports

我需要安装 PHP 5.4，为此我认为我可以升级我以前的 php 端口，但没有列出 5.4 版，所以我所做的是：

```
sudo port install php54 php54-apache2handler 
```

然后为了切换到 5.4 版，我做了：

```
sudo port select php php54 
```

之后，我使用以下命令重新启动了 apache：

```
sudo /usr/sbin/apachectl restart 
```

但是当`php -v`我得到：

```
PHP 5.3.15 with Suhosin-Patch (cli) (built: Aug 24 2012 17:45:44) 
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies 
```

我错过了什么？如何开始使用 PHP 5.4？非常感谢任何正确方向的提示！谢谢！

# coffeescript - 如何在 ElasticSearch 中组合多个查询

> ID：13352146
> 
> 赞同：13
> 
> 时间：2012-11-12T21:49:25.780
> 
> 标签：coffeescript, elasticsearch, hubot

这里是代码供参考。我正在尝试制作一个hubot插件，该插件记录到elasticsearch，然后使用hubot命令搜索这些日志。

[https://gist.github.com/4050748](https://gist.github.com/4050748)

我正在尝试检索匹配两个查询的记录。

```
{ 
  query: { 
        match: {
          user: "SomeUsername" 
        }, 
        range: {
          date: {
            from: (Date.now() - 3600) 
          }
        }
  },
  size: 50 
} 
```

我期待：

*   最多 50 条记录
*   具有给定用户的记录
*   最近一小时的记录

我有：

*   最多 10 条记录
*   具有给定用户的记录
*   从任何时候

如何在过去一小时内使用某个用户名获取所有记录？我需要将 match_all 与过滤器一起使用吗？我正在尝试的内容不受支持吗？

在 SQL 中，它类似于：

```
Select (*) from messages where user_name = ? and time > ? 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-01-12T17:26:13.953

对于任何偶然发现这个问题并想知道在 ElasticSearch 中结合匹配和范围查询是什么样子的人，这个例子看起来像

```
curl 'localhost:9200/<index>/_search?pretty=true' -d '{
  "query" : {
    "bool": {
      "must": [
        {
          "match": {
            "user": "SomeUsername"
          }
        },
        {
          "range" : {
            "date": {
              "gt": "now-1h"
            }
          }
        }
      ]
    }
  }
}' 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-13T08:51:31.963

您需要使用[bool 查询](http://www.elasticsearch.org/guide/reference/query-dsl/bool-query.html)将不同的查询组合在一起。然后，您可以选择每个单个查询是必须匹配、应该匹配（可选）还是不能匹配。

# mysql - 在插入期间从其他表中选择数据？

> ID：13352147
> 
> 赞同：1
> 
> 时间：2012-11-12T21:49:26.420
> 
> 标签：mysql, sql, database

我将数据插入到如下所示的数据库中： `(1, 'blue'), (2,'large'), (3, 'round')`

那里的数字对应于另一个表中的 ID。看起来像：`id | value`

插入此数据时，我想插入数字对应的实际值，而不是 id。

有什么查询可以做到这一点吗？还是在将其发送到数据库之前需要匹配这些值？

虽然我知道它不会起作用，但我希望有类似的东西：
`insert into table2 (table1.value[id=1], 'blue'), (table1.value[id=2],'large'), (table1.value[id=3], 'round') join table1`

我想我可以使用：

```
insert into table2 
    ((select value from table1 where id=1), 'blue'), 
    ((select value from table1 where id=2),'large'), 
    ((select value from table1 where id=3), 'round') 
```

但是说，40 个不同的属性会产生 41 个查询！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:54:37.783

首先使用要插入的值（id，值）虚拟组成一个表，然后将派生表连接到 table1 并将结果插入 table2。

```
insert into table2
     select t.value, madeup.other
       from (select 1 id, 'blue' other union all
             select 2, 'large' union all
             select 3, 'round') madeup
       join table1 t on t.id = madeup.id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:54:52.837

您可以使用临时表将 id 映射到值。我真的不会说 MySQL，但像这样：

```
create table #mapping (id int, description varchar)
insert into #mapping values (1, 'blue')
insert into #mapping values (2, 'large')
insert into #mapping values (3, 'round')

insert into table2 
select table1.value, #mapping.description
from #mapping
join table1 on table1.id = #mapping.id

drop table #mapping 
```

# visual-c++ - 两位数

> ID：13352149
> 
> 赞同：0
> 
> 时间：2012-11-12T21:49:36.850
> 
> 标签：visual-c++

我需要一个程序，它需要一个两位数，例如“22”并返回“22”。我为 main 方法启动了以下内容，但对 string 方法没有任何内容

```
 static string TwoDigit(int n)
    {

    }
    static void Main(string[] args)
    {
        for (int i = 0; i <= 19; i++)
            Console.WriteLine("{0}: {1}", i, TwoDigit(i));
        for (int i = 20; i <= 110; i += 7)
            Console.WriteLine("{0}: {1}", i, TwoDigit(i));
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:57:28.893

我不知道现有的程序，但编写函数很容易。
我会将 int 转换为字符串，然后对每个字符执行 switch 语句。
第一个开关将处理“二十”、“三十”等
。第二个开关将处理一、二、三等。
您需要为青少年设置一个特殊情况，只为每个人吐出单词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:43:16.270

1.  初始化这个函数

    ```
    function Ones_String(number1) {

        if (number1 == 1) {
            string1 = "One";
        } elseif (number2 == 9) {
            string1 = "Nine";
        } elseif (number2 == 10) {
            string1 = "Ten";
        } elseif (number2 == 0)  {
            string1 = "Zero";
        } else {
            string1 = ""; // empty value
        }

        return string1;
    }

    function Tens_String(number2) {

        if (number2 == 2) {
            string2 = "Twenty";
        } elseif (number2 == 3) {
            string2 = "Thirty";
        } elseif (number2 == 9) {
            string2 = "Ninety";
        } else {
            string2 = ""; // emtpy value

        }
        return string2;
    }

    function teens_string(number3) {

        if (number3 == 11) {
            string3 = "Eleven";
        } elseif (number3 == 12) {
            string3 = "Tweleve";
        } else {
            string3 = "Nineteen";
        }

        return string3;
    } 
    ```

如果给定数字 < 11，则调用`Ones_string()`

如果它是数字 >= 11 则执行以下逻辑

1.  第一：获取秒数并调用`Tens_String();`

2.  第二：获取第一个数字值并调用`Ones_string();`

这个算法一直适用到 99 .. 最后一次使用是在 2006 年在 C++ 大学..

无论我提到的是一种算法/逻辑来检测..不是完美的代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:58:58.663

只需花时间进行研究。如果您不知道该怎么做，我建议您将 int 数字解析为一个数字，然后通过大小写格式化文本。

```
switch (int)
case 1:
cout << "one";
switch (int)
case 2:
cout << "two"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T21:59:09.627

最简单的方法是分别评估两个数字并将它们与存储在两个数组中的字符串值匹配。

因此，例如，您可能有这两个数组...

```
tens[0] = ""
tens[1] = ""
tens[2] = "Twenty"
tens[3] = "Thirty"
tens[4] = "Forty"
tens[5] = "Fifty"
tens[6] = "Sixty" 
```

ETC...

```
ones[0] = ""
ones[1] = "One"
ones[2] = "Two"
ones[3] = "Three" 
```

ETC...

然后，如果数字 >= 20，您可以简单地取第一个数字并将其用作您的 tens 数组的索引，并将您的第二个数字用作您的 one 数组的索引。如果数字在 10 到 19 之间，您将需要一些特殊的逻辑来处理它。

# iphone - 提交 ios5 或更高版本的应用程序？

> ID：13352153
> 
> 赞同：2
> 
> 时间：2012-11-12T21:49:48.697
> 
> 标签：iphone, xcode, ios5, ios6

我最近向应用商店提交了一个仅适用于 ios6 的应用程序，自从上线以来，我现在有人要求支持 ios5！有人可以建议如何做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:02:09.393

将部署目标更改为 iOS 5 并为其构建。假设您没有针对任何仅适用于 iOS 6 的 API 进行构建，那么您应该一切顺利。如果您只使用 iOS 6 的任何内容（自动布局等），您必须在提交之前还原这些内容。

# java - java-获取数字数据库值

> ID：13352154
> 
> 赞同：1
> 
> 时间：2012-11-12T21:49:48.817
> 
> 标签：java, sql, database

您好，我正在编写一个 java 代码，该代码旨在获取我正在处理的用户配置文件表中用户总数的计数。现在我确定我的 sql 语句是正确的，但由于某种原因，我不知道如何从中获取数值。非常感谢和欢迎任何帮助。我确信我试图获得价值的方式不起作用，但我不知道如何获得价值，下面是代码，谢谢：

```
 public int getUserCount() throws SQLException {    

    Connection conn = null;
    Statement stmt = null;
    ResultSet rs = null;
    double encinfo;
    conn = DAOFactory.getDatabaseDAO().getConnection();
        StringBuffer query = new StringBuffer();
        query.append( "Select COUNT (DISTINCT record_id)");
        query.append( "From USER_PROFILE");
        stmt = conn.createStatement();
        rs = stmt.executeQuery( query.toString());
        if (!rs.next())
           throw new SQLException( SQLException.User_NOT_FOUND,"No User Count found.");

        // Should be able to get the user amount or value or total users in DB.
        userInfo = rs.getDouble( "USER_VALUE");

        m_userCount = (int) userInfo;
   } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T21:52:07.843

这可能有效：

为记录计数添加别名：

```
 query.append( "Select COUNT (DISTINCT record_id) AS USER_VALUE");
        query.append( " From USER_PROFILE"); 
```

另一种方法可能是：

```
rs.getDouble(1); 
```

这里 1 是列的索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T21:56:32.200

```
rs.getDouble(1); 
```

由于您有 1 列，它将返回当前行和第 1 列的值

# java - Jetty 映射到同一个处理程序的 2 个 url？

> ID：13352164
> 
> 赞同：1
> 
> 时间：2012-11-12T21:50:54.160
> 
> 标签：java, jetty

在创建嵌入式码头实例并将 url 模式映射到特定处理程序时，是否可以将多个 url 映射到同一个 servlet 处理程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T07:19:30.943

是的，这应该是可能的（因为它也可以使用 webapps）。

当您创建 a`ServletHandler`时，您可以将多个`ServletMapping`s via添加`addServletMapping()`到此处理程序。

# uipickerview - 在 Xcode 4.5.2 & iOS 6 下编译时，UIPickerView 无法自动选择最后一行

> ID：13352166
> 
> 赞同：18
> 
> 时间：2012-11-12T21:50:59.137
> 
> 标签：uipickerview, xcode4.5, ios6

我一直在努力诊断我的应用程序无法使用在旧版本 XCode 下成功运行的代码自动预选 UIPickerView 的最后一行。我认为这是 Xcode 而不是 iOS 6 中的错误，因为我在 iOS 6 设备上运行的旧应用程序可以正常工作，但是在 Xcode 4.5.2 下重新编译代码不能正常运行。我整理了以下示例来演示该问题，但在我提交错误报告之前，我想从这个论坛上的其他人那里获得意见，以确定问题是出在我的代码上还是确实是 Xcode/iOS 中的错误。

我创建了一个单视图应用程序并使用导航控制器和两个 IBOutlet 设置故事板，一个用于显示所选行的 UILabel，一个用于 UIPickerView。

这是我的自定义视图控制器的头文件：

```
#import <UIKit/UIKit.h>

@interface DisposableViewController : UIViewController
    <UIPickerViewDataSource, UIPickerViewDelegate>
@end 
```

这是我的自定义视图控制器的实现文件：

```
#import "DisposableViewController.h"

const NSInteger MAX_VALUE = 10;

@interface DisposableViewController ()

@property (weak, nonatomic) IBOutlet UIPickerView *pickerView;
@property (weak, nonatomic) IBOutlet UILabel *selectedValueLabel;

@end

@implementation DisposableViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)viewWillAppear:(BOOL)animated
{
    [self.pickerView reloadAllComponents];
    [self.pickerView selectRow:MAX_VALUE inComponent:0 animated:NO];
    self.selectedValueLabel.text = [NSString stringWithFormat:@"%d", [self.pickerView selectedRowInComponent:0]];
}

//**
//** UIPickerViewDataSource methods
//**

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 1;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
    return MAX_VALUE + 1;
}

//**
//** UIPickerViewDelegate methods
//**

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{
    return [NSString stringWithFormat:@"%d", row];
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    self.selectedValueLabel.text = [NSString stringWithFormat:@"%d", row];
}

@end 
```

这是演示问题的屏幕截图：

![截屏](../Images/bd3d185f34c2ca899b452df3128879da.png)

请注意，我的代码尝试在 viewWillAppear: 方法中自动选择 UIPickerView 中的最后一行，但是当程序运行时，值标签在调用 [self.pickerView selectedRowInComponent:0] 时获取该行为 10，但 UIPickerView 本身在视觉上出现已选择 9\. 我认为这是一个错误，但希望有其他意见或建议来解决此问题。感谢您的关注。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-15T03:16:08.187

这个错误是由情节提要中的使用自动布局选项引起的，但我找到了一种解决方法，可以让我继续使用自动布局：

如果我调用[pickerview selectrow：pickerview selectrow：pickone选择正确的一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T21:23:57.417

绝对看起来像是与 iOS 6 中新的自动布局功能相关的错误。我遇到了同样的事情，但是当试图查看它是否发生在 iOS 5.1 中时，我注意到它开始工作了。

试试这个：在有问题的故事板或 nib 文件中，关闭**auto-layout**。

# jquery - jQuery Tools Overlay 和 Facebook Like 按钮

> ID：13352175
> 
> 赞同：2
> 
> 时间：2012-11-12T21:51:48.000
> 
> 标签：jquery, facebook-like

使用 jQuery 工具覆盖在覆盖中打开新闻文章。最近为 Like/Send 按钮添加了 Facebook JS 代码，它只适用于第一次点击。不运行第二次和后续点击？有任何想法吗？

您可以在 www.wiser.pitt.edu 主页的“近期新闻”栏中看到它。

# actionscript-3 - 自定义 AS3 类未更新

> ID：13352176
> 
> 赞同：0
> 
> 时间：2012-11-12T21:51:48.093
> 
> 标签：actionscript-3, air, flash-cs5.5, document-class

我遇到了类似的问题，但是我解决最后一个问题的方法在这里不起作用。

我有一个由 12 个单独的 .as 模块组成的自定义类。它们在文档类中声明如下：

```
import trailcrest.v1.s3.averta;
import trailcrest.v1.s3.chronos;
import trailcrest.v1.s3.eripio;
import trailcrest.v1.s3.fabrilla;
import trailcrest.v1.s3.gradua;
import trailcrest.v1.s3.lingua;
import trailcrest.v1.s3.navigare;
import trailcrest.v1.s3.pedem;
import trailcrest.v1.s3.praeferre;
import trailcrest.v1.s3.scriba;
import trailcrest.v1.s3.securos;
import trailcrest.v1.s3.sonus;

public static var Averta:averta = new averta();
public static var Chronos:chronos = new chronos();
public static var Eripio:eripio = new eripio();
public static var Fabrilla:fabrilla = new fabrilla();
public static var Gradua:gradua = new gradua();
public static var Lingua:lingua = new lingua();
public static var Navigare:navigare = new navigare();
public static var Pedem:pedem = new pedem();
public static var Praeferre:praeferre = new praeferre();
public static var Scriba:scriba = new scriba();
public static var Securos:securos = new securos();
public static var Sonus:sonus = new sonus(); 
```

这是代码的新版本。我能够成功地引用所有这些类以及“osr.as”文档类中的公共变量和函数。我还可以从另一个模块中看到一个模块（即 Sonus 可以使用“osr.Scriba”看到 Scriba。

我遇到的问题是，虽然各种模块过去能够完美地访问彼此的所有公共函数和变量，但在我添加了一些新的模块和变量并删除了一些旧的之后，**Flash Professional 仍然在字面上使用旧版。在任何模块内部，代码提示都显示了所有旧的公共函数和变量，而没有显示新的。**

我猜这与某种我无法访问的临时文件有关。这周我绝对需要这个工作！

我的 .fla 是“Tester.fla”，文档类是“osr.as”。它们都在同一个目录中。同样在同一目录中的是文件夹结构“/trailcrest/v1/s3/”，其中包含所有 Trailcrest 模块。

帮助？？

编辑：**每当我尝试从另一个 Trailcrest 类（即`osr.Sonus.foo`）中引用一个 Trailcrest 类时，我得到...**

> TypeError：错误 #1009：无法访问空对象引用的属性或方法。

我毫无疑问地确认了所有参考资料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:10:09.133

这是一个古老的问题，最终归结为验证错误。当您在一个或多个应用程序、模块、swf 等中嵌入“A 类”时，就会发生这种情况。最终，当“A 类”更改时，必须重新编译使用“A 类”的每个输出 swf。否则，您最终会遇到 1 个模块具有较新实现而其他模块没有的情况。当应用程序域遇到同名/包的类时，应用程序域被定义为“第一个获胜”，这使这个问题变得更加复杂——这意味着如果首先引用旧的，那么稍后加载的新的将被忽略。

更持久的解决方案是对 RSL 使用类提升，最终允许 RSL 控制实际的“A 类”引用，其中它还实现**所有**模块使用的“IClassAImpl”接口。这允许编译器将引用与它知道的签名交叉链接，而无需实际嵌入实际的类本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:04:35.403

好吧，我终于想通了。这是正在发生的事情的简要说明：

#1：Flash 显然是在拉取旧版本的 Trailcrest 模块。为了解决这个问题，我备份了所有内容，然后从我的整个计算机中删除了所有旧的 Trailcrest 实例。然后，我只放回新模块。这解决了代码提示显示旧模块和变量的问题。

#2：每当一个 Trailcrest 类尝试访问另一个 Trailcrest 类的任何组件时，我都会遇到错误 #1009，即使引用都是正确的。

原因是我在函数之外直接从文档类 osr.as 调用各种模块上的函数。当然，这在程序启动时执行。

但是，一个 Trailcrest 类中调用另一个 Trailcrest 类（即`osr.Sonus.foo`）的所有代码都无法访问“foo”，因为 osr.as 出于某种原因在运行调用它们的代码之前还没有完成初始化这些类. 即使问题代码远低于初始化类的代码（请参阅我的问题），也会发生这种情况。

为了解决这个问题，我只需将问题代码包装到文档类中的公共静态函数中，然后从时间轴中调用它。这确保了所有类在尝试相互引用之前都已初始化。

不用说，现在一切都像一台运转良好的机器一样运转。多么奇怪。

我欢迎任何解释为什么这解决了这个问题。

# javascript - 如何仅使用它的链接在另一个网页上触发 javascript

> ID：13352178
> 
> 赞同：-1
> 
> 时间：2012-11-12T21:52:08.787
> 
> 标签：javascript, html, hyperlink

标题可能有点不清楚，我会尝试用一个例子来解释这个问题。

在[http://imgur.com](http://imgur.com)有一个用于上传图片的上传按钮。当它被点击时，url 不会改变。相反，会出现一个弹出窗口，它是由 javascript 触发的。现在，如果我想为默认情况下自动打开弹出窗口的网页提供一个链接，而不需要用户单击上传按钮，该怎么办。

这有点棘手，因为主页/上传页面的 url 完全相同，但其中一个是弹出窗口。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:54:49.677

一般来说，不可能在另一个网站上调用脚本，这是有充分理由的。对“跨站点脚本”进行一些研究以获得深入的解释。

但是，如果您想连接网站的功能，可以使用[Imgur API 。](http://api.imgur.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:54:39.073

**编辑：**

没有单击目标不在您的控制范围内抱歉，此答案与您的具体问题无关，但我会留下它，以防它对同样误解您的问题并通过搜索到达的人有所帮助。

**原答案：**

您可以使用`hash`URL 的部分来触发弹出窗口：

```
if (window.location.hash == '#new') {
    window.location.hash = '';

    $('#create-link').trigger('click');
} 
```

当您转到“http://mysite.com/item/#new”时，我们使用它来触发**创建**对话框

# r - 对 data.frame 中的不同列求和

> ID：13352180
> 
> 赞同：6
> 
> 时间：2012-11-12T21:52:22.197
> 
> 标签：r, dataframe

我有一个非常大的 data.frame 并且想要对每一列中的值求和。

所以我使用了以下代码：

```
sum(production[,4],na.rm=TRUE) 
```

或者

```
sum(production$X1961,na.rm=TRUE) 
```

问题是 data.frame 非常大。而且我只想将 40 个具有不同名称的 data.frame 列相加。而且我不想列出每一列。有更聪明的解决方案吗？

最后，我还想将每列的总和存储在一个新的 data.frame 中。

提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-12T22:28:32.747

尝试这个：

```
colSums(df[sapply(df, is.numeric)], na.rm = TRUE) 
```

where`sapply(df, is.numeric)`用于检测所有数字列。

如果您只想对几列求和，请执行以下操作：

```
colSums(df[c("X1961", "X1962", "X1999")], na.rm = TRUE) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T21:56:15.060

```
res <- unlist(lapply(production, function(x) if(is.numeric(x)) sum(x, na.rm=T))) 
```

将返回每个数字列的总和。

您可以根据结果创建一个新的数据框

```
data.frame(t(res)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-12T22:52:17.473

如果您不想包含每一列，则必须以某种方式指出要包含哪些列（或者，要排除哪些列）

```
colsInclude <- c("X1961", "X1962", "X1963") # by name
    # or # 
colsInclude <- paste0("X", 1961:2003)  # by name
    # or # 
colsInclude <- c(10:19, 23, 55, 147)   # by column number 
```

要将这些列放入新的数据框中，只需`[ ]`按照您所做的那样使用：'

```
newDF <- oldDF[, colsInclude] 
```

要总结每一列，只需使用 colSums

```
sums <- colSums(newDF, na.rm=T)
    # or # 
sums <- colSums(oldDF[, colsInclude], na.rm=T) 
```

请注意，这`sums`将是一个向量，而不是一个数据框。您可以使用使其成为数据框`as.data.frame`

```
sums <- as.data.frame(sums)
    # or, to include the data frame from which it came #
sums <- rbind(newDF, "totals"=sums) 
```

# grails - 如果 createTable 则阻止 createIndex

> ID：13352181
> 
> 赞同：1
> 
> 时间：2012-11-12T21:52:23.697
> 
> 标签：grails, database-migration, liquibase

*   圣杯 2.1.1
*   数据库迁移 1.2

执行 a 时`dbm-gorm-diff`，新表使用 a 定义`createTable`。所述表的索引是使用该`CREATE`语句创建的。Liquibase 还`createIndex`为由于索引已经存在而出错的表添加了一个。只需从变更日志中删除这些即可解决问题。

有没有办法告诉插件/ liquibase`createIndex`在`createTable`存在时不生成变更集？还是我只需要继续删除它们？

# python - 有序的http请求参数

> ID：13352185
> 
> 赞同：2
> 
> 时间：2012-11-12T21:52:33.490
> 
> 标签：python, httprequest, python-requests

我需要向其发出请求的 API 需要指定顺序的参数。起初我用过`requests`lib

```
payload = {'key1': 'value1', 'key2': 'value2'}
r = requests.get("http://httpbin.org/get", params=payload) 
```

就像[文件](http://docs.python-requests.org/en/latest/user/quickstart/#passing-parameters-in-urls)中所说的那样。`requests`不采用显式参数

```
r = requests.get("http://httpbin.org/get", param1=payload1, param2=payload2) 
```

在我直接尝试了 urllib3 之后，它返回了我上面的错误。从错误：

```
def request_encode_body(self, method, url, fields=None, headers=None, 
```

如何在 Python 中按指定顺序设置 http 请求参数，任何库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T21:56:25.307

改为使用一系列二值元组：

```
payload = (('key1', 'value1'), ('key2', 'value2'))
r = requests.get("http://httpbin.org/get", params=payload) 
```

使用字典时不保留顺序的原因`requests`是因为 python 字典没有顺序。另一方面，元组或列表确实如此，因此可以保留顺序。

演示：

```
>>> payload = (('key1', 'value1'), ('key2', 'value2'), ('key3', 'value3'))
>>> r = requests.get("http://httpbin.org/get", params=payload)
>>> print r.json
{u'url': u'http://httpbin.org/get?key1=value1&key2=value2&key3=value3', u'headers': {u'Content-Length': u'', u'Accept-Encoding': u'gzip, deflate, compress', u'Connection': u'keep-alive', u'Accept': u'*/*', u'User-Agent': u'python-requests/0.14.1 CPython/2.7.3 Darwin/11.4.2', u'Host': u'httpbin.org', u'Content-Type': u''}, u'args': {u'key3': u'value3', u'key2': u'value2', u'key1': u'value1'}, u'origin': u'109.247.40.35'} 
```

# c# - 使用所有依赖项编译 .NET

> ID：13352186
> 
> 赞同：2
> 
> 时间：2012-11-12T21:52:34.470
> 
> 标签：c#, .net

> **可能重复：**
> [您可以编译 C#，使其在运行时不需要 .NET Framework？](https://stackoverflow.com/questions/551554/can-you-compile-c-sharp-so-it-doesnt-need-the-net-framework-at-runtime)

我正在开发一个依赖于.NET的应用程序是C#。运行应用程序的计算机是运行 Windows XP 的标准用户帐户。

我的问题是我可以用 .NET 编译我的应用程序，而客户端计算机没有 .NET 框架吗？目前该应用程序没有运行，并且在运行时它告诉我它不是一个有效的 Win32 应用程序。它将在 .NET 计算机上正常运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T21:55:15.920

您需要在客户端机器上安装 .net，它不能作为应用程序的一部分进行部署。

可能您可以在需要 .net 的情况下制作安装程序，但无论如何仍需要安装 .Net

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:55:13.973

简短的回答。不。

一些看起来很狡猾的第 3 方声称能够让 .net 应用程序在没有 .net 的情况下运行，但坦率地说（尽管是 IANAL）我认为他们的立场是不稳定的。解决此问题的最佳方法是编写一个安装程序，以确保在安装应用程序时安装 .net 依赖项。

有时会在 .net 中发现错误。因为这些库是由 Microsoft 通过 Windows 更新维护的，所以这些错误会为您修复，而无需重新发布您的应用程序，并使用其中的固定库重新编译。这对您非常有利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:58:50.097

我过去曾使用过一个名为 XenoCode 的工具来执行此操作。

在大多数情况下，这可能是矫枉过正，但这种类型的工具是必要的，因为 WindowsPE 支持/不支持 .NET。

# windows - 打印监视器修改和重定向到另一个打印机端口

> ID：13352189
> 
> 赞同：2
> 
> 时间：2012-11-12T21:52:46.940
> 
> 标签：windows, printing, driver, monitor

我正在尝试在打印之前修改正在打印到**Epson POS**打印机的数据。我目前正在通过使用*打印监视器*而不是打印机端口配置中的*Epson 端口来执行此操作。*在`WritePort()`监视器的例程中，我将修改后的数据`COM1`直接写入。这确实将数据发送到打印机，但如果选择*Epson 端口*而不是端口监视器，它不会与打印机进行协商。

有没有办法通过*Epson 端口*从我的显示器发送数据，以便让真正的驱动程序启动？它似乎是一个监视器，并且它显示在从返回的列表中`EnumMonitors()`。

我看到过类似的问题，但我无法在任何论坛上找到答案。

谢谢！

# javascript - How can I add graphs/data to Rickshaw with d3.js?

> ID：13352190
> 
> 赞同：4
> 
> 时间：2012-11-12T21:52:50.383
> 
> 标签：javascript, svg, d3.js, rickshaw

Here's what I have:

[http://jsfiddle.net/bozdoz/Q6A3L/](http://jsfiddle.net/bozdoz/Q6A3L/)

![rickshaw d3.js graph](../Images/e4718edc354365a540a264117d15e9d4.png)

Code for the background bars:

```
maxData = 80000000;
maxHeight = 250;
var yScale = d3.scale.linear().
  domain([0, maxData]). // your data minimum and maximum
  range([0, maxHeight]); // the pixels to map to, e.g., the height of the diagram.

var riskpoints = [62000000,48000000,30000000];
var rectDemo = d3.select("#chart").
    append("svg:svg").
    attr("width", 400).
    attr("height", maxHeight).
    attr('class','risk');

rectDemo.append("svg:rect").
    attr("x",0).
    attr("y", maxHeight - yScale(riskpoints[0])).
    attr("height", yScale(riskpoints[0]) - yScale(riskpoints[1])).
    attr("width", '100%').
    attr("fill", "rgba(0,100,0,.3)");

rectDemo.append("svg:rect").
    attr("x",0).
    attr("y", maxHeight - yScale(riskpoints[1])).
    attr("height", yScale(riskpoints[1]) - yScale(riskpoints[2])).
    attr("width", '100%').
    attr("fill", "rgba(100,100,0,.3)");

rectDemo.append("svg:rect").
    attr("x",0).
    attr("y", maxHeight - yScale(riskpoints[2])).
    attr("height", yScale(riskpoints[2])).
    attr("width", '100%').
    attr("fill", "rgba(100,0,0,.3)"); 
```

This is exactly what I want, ***except*** that I have made the red, yellow, green background bars a fixed height.

When you use the slider, or, more importantly, when the graph is regenerated (which it will with the actual data), I want the background bars to adjust to the correct height.

For example, in the image, the green bar is somewhere between 300M and 200M. If you remove all the graph data except for the red (vertical) bars, the green bar (horizontal) is just above 40M. This is because the position/height of the background bars are not regenerated, whereas the position/height of the graph data are regenerated, via the rickshaw javascript.

How could I put this data into the rickshaw graph so that it is regenerated?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T00:50:11.500

The solution is to setup update function to calculate new heights of the background bars, to get displayed bars you can use graph.series.active(); you also may like to keep vars in same scope....

so the solution itself:

```
var maxHeight;
var background_update = function(graph) {
    //skip 1st time;
    if (maxHeight === undefined) {return;}
    var series=graph.series.active();
    maxHeight=yScale(get_maximum_all(series));
    //console.log(maxHeight);
    var red_riskpoint=get_maximum("y",series[0]);
    var yellow_riskpoint=get_maximum("y",series[1]);
    var green_riskpoint=get_maximum("y",series[2]);
    //console.log(graph.series.active());
    console.log(yScale(red_riskpoint),yScale(yellow_riskpoint),yScale(green_riskpoint));

   // return;

    b_red.attr("y", maxHeight - yScale(red_riskpoint)).attr("height", yScale(red_riskpoint));
    b_yellow.attr("y", maxHeight - yScale(yellow_riskpoint)).attr("height", Math.abs(yScale(yellow_riskpoint) - yScale(red_riskpoint)));
    b_green.attr("y", maxHeight - yScale(green_riskpoint)).attr("height", Math.abs(yScale(green_riskpoint) - yScale(yellow_riskpoint)));
    console.log(maxHeight-yScale(green_riskpoint));
};
var get_maximum_all=function(series) {
    var max=0;
    for (var i in series) {
        var stack=series[i].stack;
        for (n in stack) {
            if (stack[n].y>max) {max=stack[n].y;}
            if (stack[n].y0>max) {max=stack[n].y0;}
        }
    }
    return max;
}
    var get_maximum=function(tag,object){
    var max=0;
    for (var i in object.stack) {
        if (object.stack[i][tag]>max) {max=object.stack[i][tag];}
    }
return max;
    }
Rickshaw.Graph.RangeSlider = function(args) {

    var element = this.element = args.element;
    var graph = this.graph = args.graph;

    $(element).slider({

        range: true,
        min: graph.dataDomain()[0],
        max: graph.dataDomain()[1],
        values: [
            graph.dataDomain()[0],
            graph.dataDomain()[1]
            ],
        slide: function(event, ui) {

            graph.window.xMin = ui.values[0];
            graph.window.xMax = ui.values[1];
            graph.update();

            // if we're at an extreme, stick there
            if (graph.dataDomain()[0] == ui.values[0]) {
                graph.window.xMin = undefined;
            }
            if (graph.dataDomain()[1] == ui.values[1]) {
                graph.window.xMax = undefined;
            }
        }
    });

    element.style.width = graph.width + 'px';

    graph.onUpdate(function() {

        var values = $(element).slider('option', 'values');

        $(element).slider('option', 'min', graph.dataDomain()[0]);
        $(element).slider('option', 'max', graph.dataDomain()[1]);

        if (graph.window.xMin == undefined) {
            values[0] = graph.dataDomain()[0];
        }
        if (graph.window.xMax == undefined) {
            values[1] = graph.dataDomain()[1];
        }

        $(element).slider('option', 'values', values);
        background_update(graph);
    });
} 
```

other code is almost same you placed to fiddle,

my fiddle [here](http://jsfiddle.net/oceog/AWHCV/)

please note, that i not sure how calculate riskpoints, i just tried to get a maximums. I sure you can make riskpoint calculations from viewing the `console.log(series)`

b_red,b_green,b_yellow it is d3 selections of initialised background bars.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:49:48.317

I found somewhat of a solution, with the help of @eicto's answer.

```
var maxHeight = 250;
var theSVG = d3.select("#chart svg");

//from @eicto: get the maximum value on the current chart
function get_maximum_all(series) { 
    var max=0;
    for (var i in series) {
        var stack=series[i].stack;
        for (n in stack) {
            if (stack[n].y>max) {max=stack[n].y;}
            if (stack[n].y0>max) {max=stack[n].y0;}
        }
    }
    return parseInt(max);
}

//create a function to call on graph update event
function createRiskPoints(riskpoints){
//these variables need to change on each graph update
   var series = graph.series.active();
//this variable should be get_max_y_axis, but I don't know how to do that
   var maxData = get_maximum_all(series);
   var yScale = d3.scale.linear().
  domain([0, maxData]).
  range([0, maxHeight]);

//using dummy values for now
   var riskpoints = (riskpoints) ? riskpoints : [300000000,200000000,100000000];

//insert the bars so they go behind the data values
theSVG.insert("svg:rect", ":first-child").
    attr("x",0).
    attr("y", maxHeight - yScale(riskpoints[0])).
    attr("height", yScale(riskpoints[0]) - yScale(riskpoints[1])).
    attr("width", '100%').
    attr("fill", "rgba(0,100,0,.2)");

theSVG.insert("svg:rect", ":first-child").
    attr("x",0).
    attr("y", maxHeight - yScale(riskpoints[1])).
    attr("height", yScale(riskpoints[1]) - yScale(riskpoints[2])).
    attr("width", '100%').
    attr("fill", "rgba(100,100,0,.2)");

theSVG.insert("svg:rect", ":first-child").
    attr("x",0).
    attr("y", maxHeight - yScale(riskpoints[2])).
    attr("height", yScale(riskpoints[2])).
    attr("width", '100%').
    attr("fill", "rgba(100,0,0,.2)");
}
//call the function
   createRiskPoints();
//call the function on graph update: thanks to @eicto
   graph.onUpdate( createRiskPoints );​ 
```

Now the bars change when the graph changes; however, they are not to scale. This will be my next task.

[http://jsfiddle.net/bozdoz/Q6A3L/](http://jsfiddle.net/bozdoz/Q6A3L/)

# php - MySQL 表单的前端（Windows 或 OSX）

> ID：13352191
> 
> 赞同：5
> 
> 时间：2012-11-12T21:52:52.150
> 
> 标签：php, mysql, forms, user-interface, crud

[编辑：我已授予赏金但未授予问题，因为我觉得仍有机会获得更好的答案。]

我通常用 php 编写我的 MySQL 数据输入接口。

但是对于我想专注于 Web 端（从数据库中提取数据）的快速项目，我正在寻找**MySQL 的表单前端。**理想情况下，这将是一个现成的 Win 或 OSX 程序，我可以将其交给朋友或客户，以便她可以将数据输入表单。

**一个例子**

上面的几行总结了这个问题，但这里有一个典型的情况来展示为什么“只给他们 phpMyAdmin”或 MySQL 的其他一些 Web 界面通常不起作用。

我们有两个主要表格：图像和相册。第三个是将图像与相册相关联的关联表。

**图片：** id (PK)、文件名

**专辑：** id（PK），专辑

**Album_Image：** id (PK), imageid, albumid（这些是外键：Images 和 Albums 表中的两个 id PK）

对于大型项目，我不介意编写一个不错的“后端”界面 (CRUD)，它可以让我以非常舒适的自定义方式编辑数据。

对于小型项目，例如朋友的图片库，我希望能够只对“前端”进行编程：从数据库中提取数据的 Web 界面。对于后端，理想情况下，我想给我的朋友一个现成的解决方案，这样她就可以输入图像、相册以及图像和相册之间的关联。在过去（我想到的是 DBaseIII），提供接口来做这方面的事情真的很容易。

这是我尝试过的粗略方法。我已经设置了一个关联表的视图，该关联表连接到父表，因此它使用以下查询显示了专辑、imageid（PK）和专辑、文件名（父表中的关联字段）：

```
SELECT albumid, imageid, album, filename FROM album_image axi
JOIN albums a ON a.`id` = axi.`albumid`
JOIN images i ON i.`id` = axi.`imageid` 
```

这种粗略方法的想法是，我的朋友将通过视图在关联表中输入父 PK（albumid 和 imageid），并且在点击插入后，完整的父字段（文件名和专辑）将在视图中可见视觉反馈。我在三个 GUI 工具中尝试过这个视图：SQLyog (Win)、HeidiSQL (Win) 和 Sequel Pro (OSX)。

1.  在 Heidi 和 Sequel Pro 中，我还没有找到编辑视图的方法。

2.  在 SQLyog 中，我可以在视图中编辑 PK 字段（albumid 和 imageid），当我点击“刷新”时，父字段（专辑和文件名）会正确显示。那太棒了。它之所以有效，是因为即使视图显示了三个表，我们也只是从一个表中进行编辑。**但是我不能删除**一行，因为 SQLyog 不知道我们要从三个表中的哪一个表中删除。另一方面，在 SQLyog 中，我能够在包含创建视图的相同查询的查询选项卡中插入和删除，因为在这种选项卡中 SQLyog 允许我选择正在编辑的表。这样可行，但是对于我的朋友来说，这个工作流程可能开始有点复杂：她必须打开 SQLyog、连接、打开保存的查询、选择要在查询中编辑的正确表，然后进行所有其他正确的操作。

想知道是否有人知道一个非常擅长为 MySQL 制作表单的现有工具——最好是 Windows 或 OSX 二进制文件。我会考虑一个 web 解决方案，但我对框架不感兴趣——关键是部署速度，如果我们走框架路线，我最好用我自己的 CRUD 库制作接口。同样，我可以编写代码，但我对这类“快速项目”的目标是将工作量集中在前端（数据库的 Web 界面），而将后端留给现成的工具。

提前感谢您的任何见解。:)

编辑：我看到没有人提到 Navicat 或 MySQL Workbench。我也没有尝试过，想知道是否有人知道他们是否会这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T20:51:36.727

我认为您正在寻找的是 MySQL 的**表单前端**。

由于听起来您对二进制文件比对 Web 应用程序更感兴趣，因此您是否研究过 Microsoft Access？它可以与 MySQL 对话，可能正是您所需要的。

Open Office Base 可能没有您正在寻找的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:11:36.147

你已经有了解决方案，你试图让事情变得更简单是在制造复杂性。

如果您的朋友在输入 ID 并单击“插入”后仅显示文件名和专辑标题，则在视图中添加专辑图像对您的朋友没有任何好处。

在添加图片之前，您的朋友需要知道相册 ID 和图片 ID。此信息可能不在视图中。因此，她将查看专辑表并查看图像表以查找此信息，并将文件名与她自己的上传图像列表进行交叉引用。

然后，写下这两个数字后，她可以直接在专辑图像中插入一行。

对于视觉反馈，她可以查看前端网站。

确实，显示专辑名称和文件名的视图会使删除条目更容易，但我认为添加图像和专辑的频率要比删除它们的频率高得多。

因此，在显示链接信息的视图中编辑关联表的能力不应极大地影响您对工具的选择。我可以推荐一些工具，而 phpMyAdmin 是一个合乎逻辑的选择，特别是如果希望向您的朋友传授广泛适用的计算机技能时。看来您已经确定了一些可执行工具。

我想您可以添加一些额外的隐藏前端视图，以简化您朋友的工作流程，例如不在相册中的图像和 ID 列表、相册 ID 列表或显示 ID 的视图。我确实建议您考虑使用您的 CRUD 库通过简单的登录和编辑选项来扩展前端，而不是设计一个单独的后端 GUI。

我很欣赏这不是对确切问题的答案，但它确实解决了您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T15:23:49.477

我不确定这是否会有所帮助。我希望找到一个带有一些眼睛糖果/样式的用户界面，但是在搜索时我偶然发现了这个：

[https://blogs.oracle.com/MySqlOnWindows/entry/introducing_mysql_for_excel](https://blogs.oracle.com/MySqlOnWindows/entry/introducing_mysql_for_excel)

> 作为 MySQL on Windows 小组的新产品计划的一部分，我们发布了一个工具，该工具使将数据输入和输出 MySQL 数据库的任务变得非常友好和直观，我们将它与数据分析和数据分析的首选应用程序之一配对在 Windows 平台、MS Excel 中进行操作。

就像我说的，不确定它是否会有所帮助。我处于类似的情况 - 低技术，低预算的客户。不同之处在于我在 MySQL 方面的弱点，但对我来说，我只需要一个表，所以我认为这会起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:15:28.990

没有工具可以让您从此类视图中删除此类值，而不是用于 mysql，因为`For a multiple-table updatable view ... DELETE is not supported`，请参阅[可更新和可插入视图](http://dev.mysql.com/doc/refman/5.1/en/view-updatability.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T15:30:10.337

我猜你正在寻找基于 Python 的 Django 管理系统的等价物，它实际上是通过对数据结构的分析来构建自己的。

Symfony、Cake 和 Yii 等框架内置了其中的一些内容，但我猜测您的数据库架构可能不兼容，因为这些类型的系统通常要求您遵守严格的命名约定，但它当然值得一看。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T17:26:51.197

俏皮，

我已经发布了一个答案，但这个答案不同，值得单独回应，IMO。

既然您正在寻找一个简单、对客户友好的解决方案，我可以建议 Adminer 吗？ [http://www.adminer.org/en/](http://www.adminer.org/en/)？

具体来说，我最近在一个网站上使用了 Wordpress 插件： [http ://wordpress.org/extend/plugins/adminer/](http://wordpress.org/extend/plugins/adminer/)

它提供了几乎完整的 phpMyAdmin 功能。对客户来说非常容易，如果他们愿意，他们可以将数据库导出为 .csv 并在 excel 中编辑，然后重新上传。几乎每个人都熟悉 Excel 中的编辑，他们可以定期进行备份。

希望这可以帮助！

Ĵ

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-04T20:52:13.930

您可以使用 Xataface 快速轻松地为此类使用创建前端。我发现它非常快速和有用。我很乐意帮助您开始使用它。

www.xataface.com

# java - Spring MVC：允许的默认日期格式是什么？

> ID：13352196
> 
> 赞同：2
> 
> 时间：2012-11-12T21:53:18.647
> 
> 标签：java, spring, spring-mvc

在我的 Spring Web MVC 应用程序中，我在 s 中有一堆方法，`@Controller`它们接受 a`Date`作为输入参数，带有`@RequestParam`. 在没有定义任何自定义数据绑定器或属性编辑器的情况下（我承认我仍然不清楚这两者之间的区别），默认情况下支持哪些日期格式？例如，我注意到像 '11/12/2012 16:50 PM' 这样的东西可以正常工作，但是像 '1352815200000' 这样的普通 milis 值会被拒绝。

编辑：我得到的具体异常是：“无法将'java.lang.String'类型的值转换为所需类型'java.util.Date'；嵌套异常是java.lang.IllegalStateException：无法转换类型的值[java .lang.String] 到所需类型 [java.util.Date]：找不到匹配的编辑器或转换策略”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T06:35:51.037

我相信如果没有指定转换器，Spring 转换系统最终将调用已弃用的`Date`构造函数，该构造函数将 String 作为参数。

```
/**
 * Allocates a <code>Date</code> object and initializes it so that
 * it represents the date and time indicated by the string
 * <code>s</code>, which is interpreted as if by the
 * {@link Date#parse} method.
 *
 * @param   s   a string representation of the date.
 * @see     java.text.DateFormat
 * @see     java.util.Date#parse(java.lang.String)
 * @deprecated As of JDK version 1.1,
 * replaced by <code>DateFormat.parse(String s)</code>.
 */
@Deprecated
public Date(String s) {
    this(parse(s));
} 
```

通常应用程序有不同的要求 - 有些使用本地时间（浏览器特定的东西和用户时区设置可能会起作用），有些不需要存储日期 - 所以最好同时实施日期转换策略在客户端和服务器端。

PS请注意，这`Date.parse()`也已弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:23:22.787

允许的日期格式可能取决于您当前的语言环境。

您可以添加一个处理程序，将日期转换为您喜欢的格式。

我不确定是哪一个。[*@InitBinder*](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-webdatabinder)显示了从任何格式转换日期的示例..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T08:12:20.687

希望这对你有用。

创建课程 为您的约会对象注册一个编辑器。

```
import org.springframework.beans.PropertyEditorRegistrar
import org.springframework.beans.PropertyEditorRegistry
import org.springframework.beans.propertyeditors.CustomDateEditor
import java.text.SimpleDateFormat

public class CustomDateEditorRegistrar implements PropertyEditorRegistrar {

public void registerCustomEditors(PropertyEditorRegistry registry) {

    String dateFormat = 'yyyy/MM/dd'
    registry.registerCustomEditor(Date, new CustomDateEditor(new SimpleDateFormat(dateFormat), true))
}
} 
```

# c# - 产量返回缓慢的数据库调用

> ID：13352197
> 
> 赞同：2
> 
> 时间：2012-11-12T21:53:22.173
> 
> 标签：c#, asp.net, yield-return

在我的 ASP 项目中有这样的代码，用于`rr`填充`RegulationGroups`

```
private IEnumerable<RegulationGroup> LoadRegulations(string moduleName)  
{
    // database calls
    yield return subLrg;
} 
```

在单独的类中，代码循环多次

```
foreach (RegulationGroup rg in rr.RegulationGroups)     
{

} 
```

每次代码循环`RegulationGroups`数据库调用时都会发生。如何避免数据库调用？

我觉得我可以

1.  取消`yield return`并使用`List`
2.  将其缓存`IEnumerable`在列表中并在我的模块中使用它，这样它就不会影响使用该`LoadRegulations`方法的任何其他代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T21:56:43.020

*您可以通过使用以下方法实现*查询 fe来避免它`ToList()`：

```
var regulations = LoadRegulations("moduleName").ToList(); 
```

这是由于`deferred execution` .`yield return`

[在 C# 中使用 yield return 迭代器的目的/优势是什么？](https://stackoverflow.com/questions/1088442/what-is-the-purpose-advantage-of-using-yield-return-iterators-in-c)

# ruby-on-rails - Rails 中的 Rapid-Fire AJAX 请求导致 Apache 上的数据覆盖

> ID：13352198
> 
> 赞同：0
> 
> 时间：2012-11-12T21:53:21.903
> 
> 标签：ruby-on-rails, ajax, apache, fastcgi

### 问题

在使用 FCGI 将 rails 3.2.8 应用程序从 WEBrick 移动到 Apache 后，我遇到了问题。

该应用程序包含一个用 javascript 编写的游戏，它发送大量 AJAX 请求以更新服务器上的游戏统计信息。

使用 WEBrick 可以正常工作，但是现在我已经切换到 Apache，如果我对同一记录进行多次快速更新，它们似乎相互之间写得太多了。例如，如果我有 15 个 ajax 调用大致同时发送，每次请求将 'points' 值更新 5 分，则总分不会加起来为 75，我想要它，而是会有所不同较低的数字介于 5 到 45 之间。

我相信这是因为 apache 能够一次处理多个请求。

### 我认为正在发生的事情

*   StatisticsController 收到添加点的请求。
*   控制器从数据库中打开统计记录的副本。
*   该模型将当前记录的点数增加 5。
    *   ***在保存记录之前，***控制器收到另一个添加点的请求。
    *   它打开了仍然保持旧积分总数的记录。
    *   它在旧的总分上增加了 5 分。
*   第一个请求的记录保存。
    *   第二个请求的记录保存。

*总点数只增加了 5 而不是 10。*

### 我试过的

我尝试了各种“锁定”记录的方法，以防止在使用 ActiveRecord 回调编写的过程中打开它，但到目前为止还没有成功。

我已经尝试了几次网络搜索，但我还没有想出神奇的关键字来给我正在寻找的答案。

### 问题

有没有办法防止这些请求相互覆盖，或者有其他方法可以在服务器上处理吗？（我知道我可以将 javascript 统计信息编码为在发送另一个请求之前等待或合并请求，但在我看来，服务器应该能够处理尽可能多的请求。）

我完全有可能在我的方法上也走得很远，并且很乐意提出任何建议。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:11:29.847

我设法使用与[悲观锁定一致的](http://api.rubyonrails.org/classes/ActiveRecord/Locking/Pessimistic.html)[事务块](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)来完成这项工作。

代码现在如下所示：

```
 # GET /statistics/request.json
  def request
    # Begin a transaction
    Statistic.transaction do

      stat = Statistic.find(params[:id], lock: true) # Lock the record until we're done with the transaction.

      stat.total_points += 5

      stat.save!

      respond_to do |format|
        format.json { render json: stat }
      end
    end
  end 
```

您还必须确保使用支持锁定的数据库引擎，在我的例子中 MySQL 运行 InnoDB。

特别感谢这篇文章让我明白了：[悲观锁定似乎不适用于 mysql？](http://www.ruby-forum.com/topic/365151)

# matlab - 着色 MATLAB 曲面图中的特定点

> ID：13352199
> 
> 赞同：4
> 
> 时间：2012-11-12T21:53:31.670
> 
> 标签：matlab, geometry-surface

我有一个我打算分析的 3 维数据集。在分析数据集之后，基本上运行一个算法来找到一个点范围，我这个范围内的点有一个特定的颜色，这样当有人看到表面图时，他们就知道哪些是兴趣点。如何做到这一点？

我试图在 mathworks 论坛上寻求一些帮助，但到目前为止我还没有找到令人满意的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:03:32.550

如果您使用的是表面功能，您可以使用 4 参数版本`surf(x,y,z,c)`，其中`c`允许您根据当前使用的颜色图指定颜色。有关更多详细信息，请参见 mathworks 网站上的此链接[http://www.mathworks.co.uk/help/matlab/ref/surf.html](http://www.mathworks.co.uk/help/matlab/ref/surf.html)

# ruby-on-rails - Backbone 想要包含 created_at、updated_at 等，但我不希望它包含

> ID：13352201
> 
> 赞同：2
> 
> 时间：2012-11-12T21:53:38.643
> 
> 标签：ruby-on-rails, backbone.js

我正在使用带有 Rails 的 Backbone。我有一个可以很好地创建和销毁的模型。但是，当我编辑时，我收到此错误：

```
Can't mass-assign protected attributes: created_at, id, updated_at 
```

那讲得通。这些属性受到保护，它们应该受到保护。Backbone 不应该尝试更新这些属性，但 Backbone 并不知道更好。

当然，一种选择是`params[:created_at]`在我的 Rails 控制器中删除等，但我可以想象很快就会变得非常不干燥，而且这样做似乎是错误的。

有没有办法告诉 Backbone 不要在其表单中包含这些属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:34:29.987

要么不将它们发送给客户端，以便您的 Backbone 模型永远不会知道它们，要么[`toJSON`](http://backbonejs.org/#Model-toJSON)在您的模型中覆盖以排除它们。

默认`toJSON`实现非常简单：

```
toJSON: function() {
    return _.clone(this.attributes);
} 
```

所以你可以用这个替换它：

```
toJSON: function() {
    var attrs = _(this.attributes).clone();
    delete attrs.created_at;
    delete attrs.updated_at;
    return attrs;
} 
```

`Backbone.Model.prototype`如果这对您有意义，您甚至可以将其直接修补。

更改的缺点`toJSON`是`toJSON`往往在 Backbone 中执行双重任务：

1.  `toJSON`用于为服务器序列化模型和集合。
2.  `toJSON`用于序列化视图的模型和集合。

如果您仍想在视图中使用`updated_at`and `created_at`，那么我建议您添加另一种方法，例如`serialize_for_view`，它可以满足标准的`toJSON`作用：

```
serialize_for_view: function() {
    return _(this.attributes).clone();
} 
```

然后使用诸如`var html = this.template({m: this.model.serialize_for_view()})`构建视图的 HTML 之类的东西。如果你想在任何地方使用它，`serialize_for_view`你也可以猴子补丁。`Backbone.Model.prototype`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:02:03.367

我发现把

```
model.unset("created_at");
model.unset("updated_at");
model.save() 
```

解决了这个问题。如果您需要这些属性，这将不起作用，但如果不需要它们，这将起作用。

# haskell - 什么是自由单子？

> ID：13352205
> 
> 赞同：402
> 
> 时间：2012-11-12T21:53:52.253
> 
> 标签：haskell, monads, category-theory, free-monad

我已经看到*Free Monad*这个词时不时出现[了一段时间](http://www.haskell.org/haskellwiki/Free_monad)[，](http://www.haskell.org/pipermail/haskell-cafe/2010-January/072454.html)[但](http://comonad.com/reader/2011/free-monads-for-less/)[每个](http://www.haskellforall.com/2012/07/purify-code-using-free-monads.html) 人似乎只是在使用/讨论它们而没有解释它们是什么。那么：什么是自由单子？（我想说我熟悉 monad 和 Haskell 基础知识，但对范畴论只有非常粗略的了解。）

* * *

## 回答 #1

> 赞同：464
> 
> 时间：2012-11-14T23:08:32.857

这是一个更简单的答案：Monad 是在 monadic 上下文被折叠时“计算”的东西`join :: m (m a) -> m a`（回忆一下`>>=`可以定义为`x >>= y = join (fmap y x)`）。这就是 Monads 通过连续的计算链携带上下文的方式：因为在系列中的每一点，来自前一个调用的上下文与下一个调用折叠。

一个**自由的 monad**满足所有的 Monad 定律，但不做任何折叠（即计算）。它只是建立了一系列嵌套的上下文。创建这样一个自由单子值的用户负责对这些嵌套上下文执行某些操作，以便可以将此类组合的*含义*推迟到创建单子值之后。

* * *

## 回答 #2

> 赞同：316
> 
> 时间：2012-11-13T08:11:33.717

Edward Kmett 的回答显然很棒。但是，它有点技术性。这是一个可能更容易理解的解释。

自由单子只是将函子变成单子的一般方法。也就是说，给定任何函子`f` `Free f`都是单子。这不会很有用，除非你得到一对功能

```
liftFree :: Functor f => f a -> Free f a
foldFree :: Functor f => (f r -> r) -> Free f r -> r 
```

其中第一个让你“进入”你的 monad，第二个让你有一种“离开”它的方法。

更一般地说，如果 X 是带有一些额外东西 P 的 Y，那么“免费 X”是一种从 Y 到 X 而不获得任何额外东西的方式。

示例：幺半群 (X) 是具有额外结构 (P) 的集合 (Y)，它基本上表示它具有操作（您可以考虑加法）和一些恒等式（例如零）。

所以

```
class Monoid m where
   mempty  :: m
   mappend :: m -> m -> m 
```

现在，我们都知道列表

```
data [a] = [] | a : [a] 
```

好吧，给定任何`t`我们知道`[t]`的幺半群类型

```
instance Monoid [t] where
  mempty   = []
  mappend = (++) 
```

所以列表是集合上的“自由幺半群”（或在 Haskell 类型中）。

好的，所以免费的单子是相同的想法。我们取一个函子，并返回一个单子。事实上，由于 monad 可以被看作是内函子范畴中的 monoid，所以列表的定义

```
data [a] = [] | a : [a] 
```

看起来很像自由单子的定义

```
data Free f a = Pure a | Roll (f (Free f a)) 
```

并且该实例与列表的`Monad`实例具有相似性`Monoid`

```
--it needs to be a functor
instance Functor f => Functor (Free f) where
  fmap f (Pure a) = Pure (f a)
  fmap f (Roll x) = Roll (fmap (fmap f) x)

--this is the same thing as (++) basically
concatFree :: Functor f => Free f (Free f a) -> Free f a
concatFree (Pure x) = x
concatFree (Roll y) = Roll (fmap concatFree y)

instance Functor f => Monad (Free f) where
  return = Pure -- just like []
  x >>= f = concatFree (fmap f x)  --this is the standard concatMap definition of bind 
```

现在，我们得到了两个操作

```
-- this is essentially the same as \x -> [x]
liftFree :: Functor f => f a -> Free f a
liftFree x = Roll (fmap Pure x)

-- this is essentially the same as folding a list
foldFree :: Functor f => (f r -> r) -> Free f r -> r
foldFree _ (Pure a) = a
foldFree f (Roll x) = f (fmap (foldFree f) x) 
```

* * *

## 回答 #3

> 赞同：152
> 
> 时间：2012-11-12T22:25:07.490

免费的 foo 恰好是满足所有“foo”法则的最简单的东西。也就是说，它完全满足成为 foo 所必需的法律，仅此而已。

健忘函子是在结构从一个类别转移到另一个类别时“忘记”部分结构的函子。

给定函子`F : D -> C`, 和`G : C -> D`, 与 ,左邻接`F -| G`，或右邻接，只要 a, b:同构于，其中箭头来自适当的类别。`F``G``G``F``F a -> b``a -> G b`

形式上，一个自由函子伴随着一个健忘函子。

***自由的 Monoid***

让我们从一个更简单的例子开始，自由幺半群。

取一个由一些载体集合定义的幺半群，`T`一个将一对元素混合在一起的二元函数`f :: T → T → T`，和一个`unit :: T`，这样你就有一个结合律和一个恒等律：`f(unit,x) = x = f(x,unit)`。

您可以`U`从幺半群（其中箭头是幺半群同态，即它们确保它们映射`unit`到`unit`另一个幺半群，并且您可以在映射到另一个幺半群之前或之后组合而不改变含义）到类别的集合（其中箭头只是功能箭头）“忘记”操作 和`unit`，而只是为您提供载体集合。

然后，您可以定义一个函子`F`，从集合类别回到与该函子相伴的幺半群类别。该函子是将一个集合映射`a`到幺半群`[a]`、 where`unit = []`和的函子`mappend = (++)`。

因此，回顾一下到目前为止的示例，在伪 Haskell 中：

```
U : Mon → Set -- is our forgetful functor
U (a,mappend,mempty) = a

F : Set → Mon -- is our free functor
F a = ([a],(++),[]) 
```

那么要显示`F`是自由的，我们需要证明它是伴随着`U`一个健忘函子的，也就是说，正如我们上面提到的，我们需要证明

`F a → b`同构于`a → U b`

现在，记住 的目标`F`是幺半群的范畴`Mon`，其中箭头是幺半群同态，所以我们需要 a 来证明一个幺半群同态 from`[a] → b`可以用函数 from 精确描述`a → b`。

在 Haskell 中，我们称其存在于`Set`（呃，`Hask`我们假装是 Set 的 Haskell 类型的类别）中的一侧，只是`foldMap`，当特化 from`Data.Foldable`到 Lists 时，它具有 type `Monoid m => (a → m) → [a] → m`。

这是一个附加的后果。值得注意的是，如果你忘记了然后用 free 建立，然后又忘记了，就像你忘记了一次一样，我们可以用它来建立 monadic join。因为`UFUF`~ `U(FUF)`~ `UF`，我们可以通过定义我们的附加的同构传递恒等幺半群同态 from `[a]`to `[a]`，得到列表同构 from`[a] → [a]`是类型的函数`a -> [a]`，这只是列表的返回。

您可以通过以下术语描述列表来更直接地组合所有这些：

```
newtype List a = List (forall b. Monoid b => (a -> b) -> b) 
```

***自由单子***

那么什么是*Free Monad*呢？

好吧，我们做和之前一样的事情，我们从一个遗忘函子 U 开始，从箭头是单子同态的单子类别到箭头是自然变换的内函子类别，我们寻找一个左伴随的函子到那个。

那么，这与通常使用的自由单子的概念有什么关系呢？

知道某物是一个自由单子，`Free f`告诉你从 给一个单子同态与从`Free f -> m`给一个自然变换（函子同态）是同一件事（同构）`f -> m`。请记住，F`F a -> b`必须与 U 同构`a -> U b`。U 在这里将单子映射到函子。

F 至少与`Free`我`free`在 hackage 包中使用的类型同构。

我们也可以更紧密地类比上面的自由列表代码，通过定义

```
class Algebra f x where
  phi :: f x -> x

newtype Free f a = Free (forall x. Algebra f x => (a -> x) -> x) 
```

***Cofree Comonads***

假设它存在，我们可以通过查看一个健忘函子的右伴随物来构造类似的东西。cofree 函子与遗忘函子简单地/右伴随/，并且通过对称性，知道某物是 cofree 共单子与知道给出共单子同态 from`w -> Cofree f`与给出自然变换 from 相同`w -> f`。

* * *

## 回答 #4

> 赞同：84
> 
> 时间：2012-11-22T14:34:42.600

Free Monad（数据结构）之于 Monad（类）就像 List（数据结构）之于 Monoid（类）：这是一个简单的实现，您可以在其中决定如何组合内容。

* * *

您可能知道 Monad 是什么，并且每个 Monad 都需要`fmap`+ `join`+`return`或`bind`+的特定（遵守 Monad-law）实现`return`。

让我们假设您有一个 Functor（ 的实现`fmap`），但其余的取决于在运行时所做的值和选择，这意味着您希望能够使用 Monad 属性，但之后想选择 Monad 函数。

这可以使用 Free Monad（数据结构）来完成，它以这样的方式包装 Functor（类型），因此`join`与其说是归约，不如说是这些 functor 的堆叠。

现在可以将真实的`return`和`join`您想要使用的参数作为归约函数的参数给出[`foldFree`](http://hackage.haskell.org/packages/archive/control-monad-free/0.5.3/doc/html/Control-Monad-Free.html#v%3afoldFree)：

```
foldFree :: Functor f => (a -> b) -> (f b -> b) -> Free f a -> b
foldFree return join :: Monad m => Free m a -> m a 
```

为了解释这些类型，我们可以`Functor f`用`Monad m`和`b`替换`(m a)`：

```
foldFree :: Monad m => (a -> (m a)) -> (m (m a) -> (m a)) -> Free m a -> (m a) 
```

* * *

## 回答 #5

> 赞同：67
> 
> 时间：2012-11-13T16:09:54.797

Haskell free monad 是一个函子列表。相比：

```
data List a   = Nil    | Cons  a (List a  )

data Free f r = Pure r | Free (f (Free f r)) 
```

`Pure`类似于`Nil`并且`Free`类似于`Cons`。一个自由的 monad 存储一个仿函数列表而不是一个值列表。从技术上讲，您可以使用不同的数据类型实现自由 monad，但任何实现都应该与上述实现同构。

每当您需要抽象语法树时，您都可以使用免费的 monad。自由单子的基本函子是语法树每一步的形状。

[有人已经链接了我的帖子](http://www.haskellforall.com/2012/06/you-could-have-invented-free-monads.html)，给出了几个如何使用免费 monad 构建抽象语法树的示例

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2012-11-17T17:10:22.193

我认为一个简单的具体例子会有所帮助。假设我们有一个函子

```
data F a = One a | Two a a | Two' a a | Three Int a a a 
```

与明显的`fmap`。然后`Free F a`是树的类型，其叶子具有类型，`a`其节点用`One`、`Two`和标记。 -nodes 有一个子节点，-nodes 有两个子节点，-nodes 有三个子节点，并且还标有.`Two'``Three``One``Two``Two'``Three``Int`

`Free F`是一个单子。 `return`映射`x`到只是具有 value 的叶子的树`x`。 `t >>= f`查看每一片叶子并用树木代替它们。当叶子有值`y`时，它用树替换那个叶子`f y`。

图表使这一点更清楚，但我没有轻松绘制图表的设施！

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-10-11T12:43:21.920

试图在此处的超简单答案和完整答案之间提供“桥梁”答案。

所以“自由单子”从任何“函子”中构建了一个“单子”，所以让我们按顺序来看看。

# 函子详解

有些东西是类型级别的**形容词**，这意味着它们接受一个类型名词，比如“整数”，然后给你一个不同的类型名词，比如“整数列表”或“带有整数的字符串对”，甚至是“用整数制作字符串的函数”。整数。” 为了表示任意形容词，让我使用替代词“蓝色”。

但随后我们注意到其中一些形容词在它们修饰的名词中是*输入式*或*输出式*的模式。例如，“用 __ 制作字符串的函数”是输入式的，“将字符串变成 __ 的函数”是输出式的。这里的规则涉及我有一个函数*X* → *Y*，一些形容词“蓝色”是输出的，或者一个**函子**，如果我可以使用这样的函数将蓝色*X*转换为蓝色*Y*。想想“喷*X* s 的消防水带”，然后你拧上这个*X* → *Y*功能，现在你的消防水管喷*Y* s。或者它是输入的或*逆变的*如果是相反的，真空吸尘器会吸起*Y* s，当我把它拧上时，我会得到吸尘器吸起*X* s。有些东西既不是输出也不是输入。事实证明*两者*都是*幻影*：它们与它们所描述的名词完全无关，因为您可以定义一个函数“coerce”，它接受一个蓝色*X*并生成一个蓝色*Y*，但 * 不知道*X*或*Y*类型的详细信息”，甚至不需要它们之间的函数。

所以“__ 的列表”是输出式的，您可以将*X* → *Y映射到**X*的列表上以获得*Y*的列表。类似地，“一对字符串和一个__”是输出的。同时，“从 __ 到自身的函数”既不是输出也不是输入，而“一个字符串和一个正好为零的 __s 列表”可能是“幻像”情况。

但是，是的，这就是编程中的函子的全部内容，它们只是可映射的东西。如果某物是函子，则它是**唯一**的函子，最多只有一种方法可以将函数映射到数据结构上。

# 单子

一个**monad**是一个函子，它同时是

1.  普遍适用，给定任何*X*，我可以构造一个蓝色*X*，
2.  可以重复而不会改变太多意思。所以*blue* -blue *X*在某种意义上与蓝色*X*相同。

所以这意味着有一个规范函数将任何 *蓝色*-blue __ 折叠成一个蓝色 __。（我们当然会添加一些法则来让一切都变得理智：如果其中一层蓝色来自通用应用程序，那么我们只想删除该通用应用程序；此外，如果我们将蓝-蓝-蓝 X 扁平化为blue X，不管我们先折叠前两个*blue*还是先折叠后两个都应该没有区别。）

第一个例子是“一个可以为空的__”。因此，如果我给你一个可为空的可为空的 int，从某种意义上说，我给你的不仅仅是一个可为空的 int。或者“一个整数列表的列表”，如果要点只是包含 0 个或多个整数，那么“整数列表”可以正常工作，正确的折叠是将所有列表连接到一个超级列表中。

Monads 在 Haskell 中变得很大，因为 Haskell 需要一种在现实世界中做事的方法，而不会违反它的数学纯世界，那里什么都没有发生。解决方案是添加一种淡化的*元编程*形式，我们在其中引入“产生__的程序”的形容词。那么如何获取当前日期呢？好吧，Haskell 不能直接这样做，`unsafePerformIO`但它会让你描述和编写产生当前日期的程序。在这个愿景中，您应该描述一个不产生任何内容的程序，称为“Main.main”，并且编译器应该接受您的描述并将该程序作为二进制可执行文件交给您，以便您随时运行。

无论如何，“一个产生一个产生一个 int 的程序的程序”并没有比“一个产生一个 int 的程序”买多少，所以这结果是一个 monad。

# 免费单子

与函子不同，单子不是唯一的单子。给定函子不仅有一个 monad 实例。例如“一对 int 和一个 __”，你用这个 int 做什么？你可以加它，你可以乘它。如果将其设为可为空的 int，则可以保留最小的非空值或最大的非空值，或者最左边的非空值或最右边的非空值。

给定函子的自由单子是“最无聊”的结构，它只是“对于任何*n* = 0, 1, 2, ...，一个自由的蓝色*X*是一个蓝色的^(*n*) *X ”。*

 *它是通用的，因为 blue⁰ *X*只是一个*X*。自由蓝色自由蓝色*X*是蓝色^(*m*) blue ^(*n*) *X*，它只是蓝色^(*m* + *n*) *X*。它实现了“折叠”，因此根本不实现折叠，内部蓝调是任意嵌套的。

这也意味着您可以将您选择的 monad 推迟到以后的日期，稍后您可以定义一个函数，将*蓝色*-blue *X*减少为蓝色*X*并将所有这些折叠为蓝色^(0,1) *X*，然后从*X*到蓝色*X*始终为您提供蓝色¹ *X。**

# python - Python - 使用 Websocket 设置服务器

> ID：13352208
> 
> 赞同：2
> 
> 时间：2012-11-12T21:54:07.993
> 
> 标签：python, apache, nginx, websocket

我对这些东西很陌生，但我已经了解了一些 Python 基础知识。我想用一些框架和 websocket 创建一些高级脚本，但实际上我对此知之甚少。我读过必须有两台服务器（nginx、apache）来专门服务系统文件（例如 django）和媒体文件。这个脚本现在允许与其他人聊天，但是在我对一些框架有一些经验之后，我会扩展可用性。

所以我有几个问题要问你：

*   我应该选择哪个框架来运行 Websocket 并且它很轻？
*   是否可以在后台运行 websocket 而不仅仅是从控制台运行？
*   我真的需要两台服务器来在 Python 上运行一些框架吗？
*   如何设置 apache 来运行 [插入框架] 驱动的网站？
*   PHP MVC框架和[插入框架]结构有什么区别？

# .net - Windows 服务如何通过 WCF 与 Winforms 应用程序交互？

> ID：13352210
> 
> 赞同：0
> 
> 时间：2012-11-12T21:54:10.063
> 
> 标签：.net, winforms, wcf, windows-services

我有一个运行自托管 WCF 服务的 Windows 服务，该服务从串行端口返回调用客户端数据。

现在我需要通过推送模型在 Winforms 应用程序中显示此串行数据 - 我的服务必须将此串行数据推送到 winforms，也许通过事件？

任何指向正确方向的指针将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T13:53:23.460

有两种方法可以做到这一点： (1) 在您的 WinForms 应用程序中实现一个服务，您的 Windows 服务连接到该服务；(2) 回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T11:53:22.000

您可以使用 WCF 回调

*   [http://idunno.org/archive/2008/05/29/wcf-callbacks-a-beginners-guide.aspx](http://idunno.org/archive/2008/05/29/wcf-callbacks-a-beginners-guide.aspx)
*   [http://www.dotnetcurry.com/ShowArticle.aspx?ID=721](http://www.dotnetcurry.com/ShowArticle.aspx?ID=721)
*   [http://www.devx.com/dotnet/Article/38814](http://www.devx.com/dotnet/Article/38814)

或者，如果您想将其作为 Web 方法，您可以使用 SignalR：

*   [http://signalr.net/](http://signalr.net/)

# 3d - 如何使用 SceneJS 在场景中分布随机立方体？

> ID：13352213
> 
> 赞同：0
> 
> 时间：2012-11-12T21:54:29.337
> 
> 标签：3d, webgl, scenejs

```
<head>
    <title> SceneJS Test</title>
    <script type="text/javascript" src="resources/scenejs.js"></script>
</head> 
```

我想使用 SceneJS 在画布场景上随机分布立方体。由于这个库有很大的学习曲线，我自己检查了几个例子并开始编码。我做了一些代码，无法说服自己错误在哪里：

```
<body onload = "main()" bgcolor="white">
        <canvas id="theCanvas" width="720" height="405">
        </canvas>
         <script type="text/javascript">

       main = function({

         N = 10;
         var canvas = document.getElementById("theCanvas");
         var sceneName = "theScene";

         SceneJS.createScene({
          id: sceneName,
          canvasId: canvas,
          nodes: [{
            type:"library",
              id:"mylib",
              nodes:[]
            },
            // Viewing transform specifies eye position, looking at the origin by default
            {
              id:"lookat",
              type: "lookAt",
              eye : { x: 0.0, y: 1.0, z: 80.0 },
              up : { z: 1.0 },
              look:{x:0,y:0,z:0},
              nodes: [
                  /* Camera describes the projection*/
                  {
                type: "camera",
                optics: {
                type: "perspective",
                fovy : 45.0,
                aspect : 720/405,
                near : 0.10,
                far : 10000.0
                  },
                  nodes: [
                   {
                    type: "rotate",
                    id: "pitch",
                    angle: 0.0,
                    x : 1.0,    
                    nodes: [
                        {
                          type: "rotate",
                          id: "yaw",
                          angle: 0.0,
                          y : 1.0,
                         }
                        ]
                      }
                      ]
                  }
                  ]
            }
            ]
        });
         var scale = 100;
         var scene = SceneJS.scene(sceneName);
         for(var i=0; i<N; i++)
         {
           scene.add("node",{
          type:"translate",
            x:(Math.random()-0.5)* scale,
            y:(Math.random()-0.5)* scale,
            z:(Math.random()-0.5)* scale,
            nodes:[{
              type: "cube",
            id: "cube"+i
            }]
            });
         }
       });

         </script>
     </body> 
```

我请求有人指出我的错误在哪里，我会非常感谢你。我只能在浏览器中看到空白屏幕:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T02:23:39.573

将您的节点添加到最里面的旋转节点——这样它们将“继承”由查看、相机和旋转节点设置的视图、投影和建模转换。

因此，给该旋转节点一个 ID，如“myYawRotate”，然后在场景之外获取对该节点的引用：

```
var myRotate = scene.getNode("myYawRotate"); 
```

并将您的多维数据集分支添加到该节点：

```
myYawRotate.add("node", { ... 
```

这是一个场景图概念，称为“状态继承”。它符合 API 的数据驱动方法，有助于场景图的简洁性和可插拔性，但也有助于提高性能，因为变换矩阵将为每一帧上的所有立方体设置一次（“状态排序”的一个方面）。

您还需要在更高的变换中插入灯光，以及一个材质节点。然后，您就拥有了 SceneJS 以您可以看到的方式渲染立方体所需的所有状态。

在您的示例中，可能发生的情况是您确实进行了立方体渲染，但没有照明，也没有转换为视图空间和投影。

# jakarta-ee - 解决服务器容器上插件实现的类加载问题

> ID：13352221
> 
> 赞同：0
> 
> 时间：2012-11-12T21:54:53.657
> 
> 标签：jakarta-ee, plugins, jetty, classloader

我正在尝试在 OpenIG 上实现我自己的[过滤器/处理程序版本。](http://openig.forgerock.org/doc/gateway-guide/index.html#chap-customizing)

我在 Eclipse 上创建了它自己的 maven 项目，编译了示例并将其打包到一个 jar 中。

我在 Jetty 8 上运行 OpenIG 2.1.0。

openig 战争部署在 $JETTY_HOME/webapps 下，而我创建的 jar 在 $JETTY_HOME/lib/ext 下。

我面临的例外是 NoClassDefFound 我的过滤器扩展的 GenericFilter 类。GenericFilter 存在于 openig 战争中，作为“内联”jar

我知道这是类加载的问题。Plugin Jar 和 OpenIG 战争不共享同一个类加载器。

我的问题是：什么形式的包装适合这种情况？

1.  我可以用我的新班级重建战争 - 似乎不合逻辑，应该将战争和插件脱钩
2.  我可以将插件包装为战争 - 仍然没有意义。
3.  使用 OSGI - 方式过大，openIG 不是 OSGI 包

有任何想法吗 ？

```
java.lang.NoClassDefFoundError: org/forgerock/openig/filter/GenericFilter
 at java.lang.ClassLoader.defineClass1(Native Method)
 at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
 at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
 at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
 at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
 at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
 at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
 at java.security.AccessController.doPrivileged(Native Method)
 at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
 at org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:424)
 at org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:377)
 at java.lang.Class.forName0(Native Method)
 at java.lang.Class.forName(Class.java:264)
 at org.forgerock.openig.util.JsonValueUtil.classForName(JsonValueUtil.java:80)
 at org.forgerock.openig.util.JsonValueUtil.asClass(JsonValueUtil.java:94)
 at org.forgerock.openig.heap.HeapImpl.init(HeapImpl.java:64)
 at org.forgerock.openig.federation.FederationGatewayServlet.init(FederationGatewayServlet.java:67)
 at javax.servlet.GenericServlet.init(GenericServlet.java:244)
 at org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:456)
 at org.eclipse.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:347)
 at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:535)
 at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:489)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
 at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:483)
 at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
 at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:972)
 at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
 at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
 at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:906)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
 at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
 at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
 at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
 at org.eclipse.jetty.server.Server.handle(Server.java:350)
 at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:442)
 at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:910)
 at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)
 at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)
 at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:46)
 at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:545)
 at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:43)
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
 at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
 at java.lang.Thread.run(Thread.java:722)
Caused by:
java.lang.ClassNotFoundException: org.forgerock.openig.filter.GenericFilter
 at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
 at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
 at java.security.AccessController.doPrivileged(Native Method)
 at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
 at java.lang.ClassLoader.defineClass1(Native Method)
 at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
 at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
 at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
 at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
 at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
 at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
 at java.security.AccessController.doPrivileged(Native Method)
 at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
 at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
 at org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:424)
 at org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:377)
 at java.lang.Class.forName0(Native Method)
 at java.lang.Class.forName(Class.java:264)
 at org.forgerock.openig.util.JsonValueUtil.classForName(JsonValueUtil.java:80)
 at org.forgerock.openig.util.JsonValueUtil.asClass(JsonValueUtil.java:94)
 at org.forgerock.openig.heap.HeapImpl.init(HeapImpl.java:64)
 at org.forgerock.openig.federation.FederationGatewayServlet.init(FederationGatewayServlet.java:67)
 at javax.servlet.GenericServlet.init(GenericServlet.java:244)
 at org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:456)
 at org.eclipse.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:347)
 at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:535)
 at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:489)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
 at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:483)
 at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
 at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:972)
 at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417)
 at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
 at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:906)
 at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
 at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
 at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
 at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110)
 at org.eclipse.jetty.server.Server.handle(Server.java:350)
 at org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:442)
 at org.eclipse.jetty.server.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:910)
 at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:565)
 at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:217)
 at org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:46)
 at org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:545)
 at org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:43)
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598)
 at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533)
 at java.lang.Thread.run(Thread.java:722)C 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T22:24:45.510

战争中的类在加载时对 lib 目录中的类不可用。听起来您想运行 OpenIG 并在他们的 WAR 中包含一些自定义部分。如果您使用的是 Maven，则可以使用[Maven WAR Plugin 和 Overlays](http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html#overlays)来执行此操作。覆盖允许您将代码添加到现有的 WAR 以创建新的战争。

# intervals - 指数平滑预测的置信区间

> ID：13352227
> 
> 赞同：2
> 
> 时间：2012-11-12T21:55:27.760
> 
> 标签：intervals, smoothing, exponential, forecasting

我正在使用指数平滑（布朗方法）进行预测。可以计算一个或多个步骤（时间间隔）的预测。有没有办法计算这种预后的置信区间（事前）？

# jquery - jQuery和表单值onchange函数调用？

> ID：13352230
> 
> 赞同：0
> 
> 时间：2012-11-12T21:55:37.117
> 
> 标签：jquery, forms, function, option

我需要一个表单选择来触发一个 jquery 函数并启动链接。

```
<form>
<select onchange="drop_down(this.value)">
    <option value="http:google.com">Google</option>
    <option value="http:yahoo.com">Yahoo</option>
    <option value="http:bing.com">Bing</option>
    <option value="http:msn.com">MSN</option>
</select> 
```

```
<script>
function drop_down(value){
    document.location = this.value;
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:00:20.040

将您的标记更改为：

```
<select onchange="drop_down(this.value)">
    <option value="http://www.google.com">Google</option>
    <option value="http://www.yahoo.com">Yahoo</option>
    <option value="http://www.bing.com">Bing</option>
    <option value="http://www.msn.com">MSN</option>
</select> 
```

和你的脚本：

```
function drop_down(value) {
   location.href = value;
} 
```

[http://jsfiddle.net/ZF9gF/](http://jsfiddle.net/ZF9gF/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T21:57:29.137

window.location 将重定向访问者：

```
function drop_down(value){
    window.location = value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:06:43.967

**[DEMO](http://jsfiddle.net/MNEzk/)** — 下面是在**jQuery**中的操作方法。

```
<script>
$(function(){
    $('select').on('change', function(){
        location.href = $(this).val();
    });
});
</script>

<select>
    <option value="http://www.google.com">Google</option>
    <option value="http://www.yahoo.com">Yahoo</option>
    <option value="http://www.bing.com">Bing</option>
    <option value="http://www.msn.com">MSN</option>
</select> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:12:26.390

```
<script type="text/javascript">
function drop_down(value) {
 window.location.replace(value);
 }
 </script>

<select onchange="drop_down(this.value)">
<option value="https://www.google.com/">Google</option>
<option value="https://www.yahoo.com/">Yahoo</option>
<option value="http://www.bing.com/">Bing</option>
<option value="http://www.msn.com/">MSN</option>
</select> 
```

这对我有用。让我知道它是否对你有用.......

# performance - 确定线段接触的常规二维网格中所有单元格的最快方法是什么

> ID：13352236
> 
> 赞同：3
> 
> 时间：2012-11-12T21:55:56.617
> 
> 标签：performance, algorithm, grid, graphics2d

我想找到所有接触或包含给定有限线段部分的网格图块。网格是 2d 规则网格，因此我可以从瓦片位置（行、列）推断出任何瓦片的中心，反之亦然，我可以使用两个快速整数除法从给定浮点坐标计算瓦片位置。瓦片是二次方的，例如 0.25x0.25，其中 0.25 定义为瓦片宽度。现在我需要确定给定线段接触的所有图块（浮点数中给出的两个 2d 点定义一个线段）。我目前的方法是将线段分成等距点，距离为平铺宽度的一半（向香农致敬）。比我收集包含给定点的所有图块并删除重复的图块。

编辑：正如 Patricia 所指出的，我目前的方法不会产生完整的图块集，因为不会包含仅被线触及的一小部分的图块。这对我来说是可以接受的，因为在我的情况下，速度比准确性更重要，但仍应注意。

为了更清楚：我想要图像中的所有红色瓷砖，但如果我获得速度，我可以节省例如玫瑰色瓷砖。

![带有找到的瓷砖的网格](../Images/d9426c81439e655c79573392eeff4e60.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:23:49.010

您的问题基本上归结为在光栅图像上绘制线段。

如果您可以节省粉红色瓷砖，请使用 Bresenham 算法。否则，使用与绘制抗锯齿线类似的技术：

您从包含段一端的图块开始，并将其放入队列中。然后使用常规的 BFS 算法，仅将与该段相交的图块放入队列：

在一次迭代中，从队列的一端取一个图块，这是您找到的下一个相交图块。然后找到它的所有邻居，并将与线段相交的那些（在这种情况下测试与一条线相交就足够了）到队列的另一端。必须根据线的方向选择邻居。如果它向右下方，则使用向下、向右和向右下方的瓷砖作为邻居，如果向上，则仅使用向上的邻居，依此类推。

当您到达包含该段另一端的图块时，您就结束了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:31:28.323

给定线段的端点，您可以轻松计算线的方程，`y = mx + b`。给定段的长度，您可以计算参数形式：

```
x = x0 + ft
y = y0 + gt 
```

给定这些方程中的任何一个，您都可以计算线上`y`任何给定坐标的坐标。`x`所以 ...

从线的第一个端点开始，您知道包含该点的单元格在集合中。您知道`x`每个单元格的坐标，因此您可以快速确定`y`线段穿过单元格边界的坐标。如果该`y`坐标高于单元格的顶部`y`坐标，则线段与起始单元格上方的单元格相交。（如果线的斜率是“向下”，则替换为“下方”。）

如果您对沿`x`轴的每个单元格边界重复该测试，您将获得该段穿过的所有单元格的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:20:42.783

测试线的渐变，与具有相同渐变符号的瓷砖对角线相对。**如果它比平铺对角线更陡，则在下面交换 x 和 y 坐标。**

如果渐变比瓦片对角线浅，线接触或穿过给定瓦片，并且瓦片不包含端点，则其与瓦片边缘的至少一个交点必须在瓦片的 x 边界上.

对于每条线的末端，收集包含或接触端点的瓷砖。

对于作为两个端点 x 坐标之间的平铺边缘的每个 x 坐标，计算线的 y 坐标。收集接触该点的瓷砖。

我认为这一切都可以通过最多几个部门进行梯度检查来完成。主要过程是所有的乘法、加法和比较。

# java - jMonkey 优化类似于 Java3D 的

> ID：13352237
> 
> 赞同：35
> 
> 时间：2012-11-12T21:55:57.767
> 
> 标签：java, opengl, java-3d, jmonkeyengine, aparapi

**编辑：为了进行实时绘图，开始使用 lwjgl，它是 jmonkeyengine 和 jocl 在 opengl 和 opencl 之间的“互操作性”中的基础，现在可以实时计算和绘制 100k 个粒子。也许地幔版本的 jmonkey 引擎可以解决这个 drawcall 开销问题。**

几天来，我一直在 Eclipse（java 64 位）中学习 jMonkey 引擎（ver：3.0），并尝试如何使用`GeometryBatchFactory.optimize(rootNode);`命令优化场景。

**没有优化（具有改变球体位置的能力）：**

![在此处输入图像描述](../Images/9c67a620217b6e1173157dd762608eb8.png)

好的，只有 1-fps 来自 pci-express 带宽+jvm 开销。

**通过优化（无法改变球体的位置）：**

![在此处输入图像描述](../Images/df7ec2c709d2b4ab8ce6ce3b9f08164a.png)

现在即使增加了三角形数，它也是 29 fps。

Java3D 有一种`setCapability()`方法可以使场景对象即使以优化的形式也可以被读取/写入。jMonkey 引擎 3.0 必须能够处理这个主题，但我找不到它的任何痕迹（搜索教程和示例，失败）。

**问：** jMonkey 3.0如何设置场景节点的`read/write position/rotation/scale`能力？`optimized`如果您不能回答第一个问题，您能告诉我为什么使用优化命令时三角形数会增加吗？我是否必须创建一个新方法来访问显卡并自己更改变量（可能是jogl？）？

场景信息：16k 个粒子（16x16 res 的球体）+ 1 个点光源（及其 4096 分辨率的阴影）。

我确信我们可以通过 pci-express 轻松地在一毫秒内发送数千个浮点数。

*   附加信息：我正在使用 Aparapi-kernels 更新粒子位置，这需要 10 毫秒（16k * 16k 相互作用来计算力）。（在优化模式下不会改变任何东西:(）aparapi 可以访问那些优化的数据吗？

对于`batchNode.batch();`优化的情况，这里又是 1 fps，对象数减少：

![在此处输入图像描述](../Images/7508e9a9b1f35653fdae317690ce5b21.png)

对象数量现在只有几百，但 fps 仍然是 1！

仅将球体位置发送到 gpu 并让它计算顶点位置可能比在 cpu 上计算顶点并将大量数据发送到 gpu 更好。

没人来帮忙吗？已经尝试过 batchNode 但没有提供足够的帮助。

我不想更改 3d api，因为 jMonkey 人已经重新发明了轮子，我对目前的情况感到满意。只是想提高一点性能（取消阴影可以提高 %100 的速度，但质量也很重要！）。

这个java程序将成为一个小行星撞击场景模拟器（可以选择小行星的大小、质量、速度、角度），带有LOD的行进立方体算法（将是数百万个粒子）。

**Marching-cubes算法会大大减少三角形数。如果您不能给出任何答案，那么任何用于 java 的行进立方体（或任何 O(n) 凸包）算法都将被接受！数据：x、y、z 阵列作为源，三角带阵列作为目标（等表面网格点）**

谢谢。

以下是有关流的一些示例（分辨率低得多）：

1) 一个立方体形岩群在引力作用下的坍塌： ![在此处输入图像描述](../Images/a16ab41341eddb27cfe950f33dd87086.png)

2）排斥力开始显现： ![在此处输入图像描述](../Images/99b821ed3900a2ace9dc800977fcee62.png)

3）排斥力+万有引力使团形成更光滑的形状： ![在此处输入图像描述](../Images/03b2262794eac36c9419c49cea4a2a75.png)

4）组形成一个球体（如预期的那样）： ![在此处输入图像描述](../Images/64766eaf79e6c68923d51bd26685a7a3.png)

5）然后，一个巨大的星体接近： ![在此处输入图像描述](../Images/556941eec46da5baba5127ea3739c3d6.png)

6）即将触摸： ![在此处输入图像描述](../Images/8b754e116afaf724be2e3244c555e811.png)

7) 撞击时刻： ![在此处输入图像描述](../Images/f4a43cdc553f44d6eb24f34a0a2e4bbf.png)

在 Barnes-Hutt 算法和截断势的帮助下，粒子数将增加 10 倍（可能是 100 倍）。

而不是 Marching-Cubes 算法，包裹 nbody 的幽灵布可以提供低分辨率的船体（比 BH 更容易但需要更多计算）

鬼布会受到nbody（重力+排斥）的影响，但nbody不会受到包裹它的布的影响。Nbody 不会被渲染，但布料网格将以较低的三角形计数渲染。

![在此处输入图像描述](../Images/3ecff60f3721f518f31ca54628745c02.png) ![在此处输入图像描述](../Images/66d5497490e3ff860de751c2af5b605f.png)

如果 MC 或更高版本有效，这将让程序为大约 200 倍以上的粒子渲染包裹布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:13:08.843

JMonkeyEngine wiki 中有一组非常可靠的文档，其中讨论了很多关于如何利用您所指的转换的内容，可以在此处找到：[高级空间概念](http://jmonkeyengine.org/wiki/doku.php/jme3%3aadvanced%3aspatial?s%5B%5D=position&s%5B%5D=rotation&s%5B%5D=scale)。

此外，还有很多关于网格及其渲染的信息，您可以在此处查看：[多边形](http://jmonkeyengine.org/wiki/doku.php/jme3%3aadvanced%3amesh?s%5b%5d=position&s%5b%5d=rotation&s%5b%5d=scale)网格。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T19:01:26.273

非常抱歉....

**您可以批处理场景（或子节点）中保持为 static**的所有几何图形。

批处理意味着具有相同材质的所有几何图形组合成一个网格。仅当您总共只使用少量（大约最多 32 种）材质时，此优化才有效。回报是在游戏初始化时批处理需要额外的时间

因此，三角形的变化是因为它们已经全部组装成一个网格......如果有必要，唯一的建议是尝试获取网格并改变其上的点，但在这一点上，我认为它不会感觉。

也许尝试不同的优化方法。

祝你好运，有一段时间没有使用过 JMonkey，但很高兴看到其他人使用它并且它的持续增长！

*编辑*

顺便说一句，最小化数学的一种方法可能是使用半个立方体球体，对地球的影响可能不会影响另一侧（除非球体不是地球，而是地球的一小部分样本）一个球体）...

也许尝试使用 2d 形状作为冲击面，虽然我知道这不是您的最佳选择，但它可能会让您了解形状的数量如何产生影响以及影响的程度。如果确实如此，那么一种途径可能是考虑如何去除一些颗粒，如果没有，您不必担心。我几乎可以肯定它会的。

最后：

也许不实时渲染？花一分钟时间将帧绘制到缓冲区然后播放，当你播放时，你将有另外 40 帧左右的帧等......也许你只需要大约 30 秒的时间。

# php - $this->filter in controller - 在哪里设置

> ID：13352238
> 
> 赞同：2
> 
> 时间：2012-11-12T21:55:57.530
> 
> 标签：php, phalcon

我已经搜索了类`\Phalcon\Mvc\Controller`& `\Phalcon\DI\Injectable`，但无法理解该`filter`属性的来源。

如果在控制器中我使用

```
$this->filter 
```

它从何而来？接口不会在任何地方反映此属性。

谢谢

与（[https://stackoverflow.com/questions/13303141/controllers-attr-this-filter-where-from](https://stackoverflow.com/questions/13303141/controllers-attr-this-filter-where-from)）相关，不幸的是由于原始海报的英语而关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T21:55:57.530

在 Phalcon Dependency Injection ( `\Phalcon\DI`) 容器中，服务被注册并相互交互。

`\Phalcon\Mvc\Controller`自动允许使用魔术方法访问在 DI 容器中注册的服务。

所以假设你已经`filter`在你的 DI 容器中注册了一个服务：

```
$di->set(
    'filter',
    function () 
    {
        return new \Phalcon\Filter();
    }
} 
```

该服务现在可以通过以下方式在您的控制器中使用：

```
$filter = $this->filter; 
```

或者

```
$filter = \Phalcon\DI::getDefault()->get('filter'); 
```

存储在 DI 容器中的任何内容也是如此。

# javascript - 我有一个包含多个跨度元素的弹出 div 如何显示另一个跨度

> ID：13352244
> 
> 赞同：-4
> 
> 时间：2012-11-12T21:56:16.850
> 
> 标签：javascript, jquery, popup, html

我有一个包含多个跨度元素的弹出 div 如何显示另一个跨度

**javascript**

```
$(document).ready(function() {
$(".levert").click(function () {
$("#popUpDiv").show("slow");
});

}); 
```

**HTML**

```
<div id="popUpDiv" style="display:none">
<img src="logo_klein.png" width="117" height="33" class="logoklein1" ><p
id="headertextbox">is</p></img>

<span class="textbox1"></span>
<span class="textbox2"></span>
<span class="textbox3"></span>
</div>
</div> 
```

**带有链接的图像地图**

```
<img id="logo" src="./logo.png" alt="Phlox" usemap="#links"></img>

<map name="links">
<area shape="circle" coords="291,46,46" href="#" class="levert"></area>
<area shape="circle" coords="55,245,46" href="#" class="is"></area>
</map> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:29:24.583

当您想清除`popupDiv`并添加类跨度时，请执行此操作`textbox2`

```
$("#popUpDiv").empty().append('.textbox2').show("slow"); 
```

# php - Twitter 使用 API 获取用户状态值，有限制吗？

> ID：13352251
> 
> 赞同：0
> 
> 时间：2012-11-12T21:56:37.103
> 
> 标签：php, twitter

总而言之，我有以下代码来获取 twitter 状态并将其显示给用户：

```
if( ! $tweet ) {
    //$format = 'json';
    //$contents = file_get_contents( "http://api.twitter.com/1/statuses/user_timeline/{$username}.{$format}", 0, $context );
    //$contents = file_get_contents("   https://api.twitter.com/1/statuses/user_timeline.json?screen_name={$username}&count={$how_many}", 0, $context );
    $url = "http://api.twitter.com/1/statuses/user_timeline.json?screen_name={$username}&count={$how_many}";
    $curl = curl_init();
    curl_setopt( $curl, CURLOPT_URL, $url );
    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );
    $contents = curl_exec( $curl );
    curl_close( $curl );
    if ( ! empty( $contents ) ) {
        // Decode it.
        $tweet = json_decode( $contents );
        // Cache it for next time.
        //set_transient( $id.'-'.$username, $tweet, 60*60*3 ); // 3 hour cache
    }
}

// Check to make sure we have a tweet and display it.
if ( is_array($tweet) && isset($tweet[0]->id_str)) {
    do_action( 'themeblvd_twitter_slider', $tweet, $options, $username, $slider_id );
} else {
    $output = '<span class="tweet-icon '.$options['icon'].'"></span>';
    $output .= 'We experienced an error with Twitter! Please check back soon for our reviews!';
}
return $output; 
```

所以基本上我试图确定我是否已经获取了一些推文，如果没有获取它们，然后将它们传递回下面的循环以将它们显示给用户。

```
<?php
foreach($tweet as $t){
?>
<li class="slide tight <?php echo $classes; ?>">
    <div class="slide-body">
        <div class="grid-protection">
        <?php
        echo '<span class="tweet-icon '.$options['icon'].'"></span>';
        echo '<a href="http://twitter.com/'.$username.'/status/'.$t->id_str.'" target="_blank">';
        echo $t->text;
        echo '</a>';
        ?>

        </div><!-- .grid-protection (end) -->
    </div><!-- .slide-body (end) -->
</li>
<?php
}
?> 
```

出于某种原因，我收到一条错误消息，指出它们无法显示。如果我将限制保持在 10 左右，它会相当一致地显示而不会出现错误。如果我将限制增加到 50 或 85，我会收到错误消息，说 twitter 有问题。API 最近有变化吗？他们有新的限制吗？关于为什么我不能显示 85 条推文的任何想法？

提前感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T22:42:32.403

我发现您实际上可以确定您是否已达到限制，但调用以下 URL：

[https://api.twitter.com//1/account/rate_limit_status.json](https://api.twitter.com//1/account/rate_limit_status.json)

我所做的是在实际尝试调用用户状态 API 之前检查其中的响应。我检查速率限制的代码如下所示：

```
$url_check_limit = "https://api.twitter.com//1/account/rate_limit_status.json";
$curl_limit = curl_init();
curl_setopt( $curl_limit, CURLOPT_URL, $url_check_limit );
curl_setopt( $curl_limit, CURLOPT_RETURNTRANSFER, 1 );
$contents_limit = curl_exec( $curl_limit );
curl_close( $curl_limit );
if ( ! empty( $contents_limit ) ) {
    // Decode it.
    $tweet_limit = json_decode( $contents_limit );
}

if ( $tweet_limit->remaining_hits == "0" ){
    $no_tweets = true;
    echo "We've reached out rate limit";
}else{
    //Execute the Twitter user_status API from my original question
} 
```

如果我已经达到我的限制，这使我可以避免继续调用 twitter API。如果我没有达到我的限制，我会调用原始问题中的代码并向用户显示推文。希望这对某人有帮助！

# mysql - MySQL：计算两个日期列之间的工作日差异

> ID：13352254
> 
> 赞同：2
> 
> 时间：2012-11-12T21:56:47.840
> 
> 标签：mysql, sql

我的 sql 查询返回两列，第一列是“创建日期”，第二列是“更新日期”，第一列相对于第二列具有先前的时间戳。

我需要添加第三列，它可以显示工作日时间（上午 9:00 到下午 5:00）响应，即如果创建日期是 2012-01-04 09:00:20 并且“更新日期”是同一天下午 4:00第三列应显示 7 小时

如果创建的日期是 2012-01-04 16:00:20（下午 4:00）并且“更新日期”是 2012:01:05（1 月 2 日）的 10:00，那么第三列应该显示 2 小时。

它应该排除周六和周日。

您能否为此建议适当的 SQL 查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:57:50.100

正如[@Gordon Linoff 评论](https://stackoverflow.com/questions/13352254/mysql-calculate-business-day-difference-between-two-dates-column#comment18224999_13352254)的那样，您需要创建一个包含您的营业时间的表格：

```
CREATE TABLE business_days (
  start DATETIME NOT NULL,
  end   DATETIME NOT NULL
);

INSERT INTO `business_days`
  (start, end)
VALUES
  ('2011-12-30 09:00', '2011-12-30 15:00'),  -- short day
  ('2012-01-03 09:00', '2012-01-03 17:00'),  -- 31st, 1st were Sat/Sun
  ('2012-01-04 09:00', '2012-01-04 17:00'),  -- 2nd was a public holiday
  ('2012-01-05 09:00', '2012-01-05 17:00'),
  -- etc. 
```

然后你可以这样做：

```
SELECT   m.*,
         SEC_TO_TIME(SUM(TIME_TO_SEC(TIMEDIFF(
           LEAST(m.updated, b.end),
           GREATEST(m.created, b.start)
         ))))
FROM     my_table m JOIN business_days b
           ON b.start < m.updated AND m.created < b.end
GROUP BY m.created, m.updated  -- or some other key into my_table 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/c5d59/1/0)上查看。

# oracle - Oracle：在包中创建对象类型数组

> ID：13352257
> 
> 赞同：2
> 
> 时间：2012-11-12T21:57:08.923
> 
> 标签：oracle, plsql

我想在 10gR2 中实现一个堆栈数据结构。

但是，当我尝试这样做时：

创建或替换 TYPE Con​​tainerArray AS VARRAY(25) OF XDB.DBMS_XMLDOM.DOMNODE ；

我明白了

> “模式级类型对 XDB.DBMS_XMLDOM 有非法引用。”

所以我发现这是因为 Oracle 不允许您创建引用包级别类型的模式级别类型。

我可以通过在包内创建类型来解决这个问题：

```
TYPE ContainerArray AS VARRAY(25) OF XDB.DBMS_XMLDOM.DOMNODE; 
```

但是，当我尝试创建我的对象时，我无法引用包级类型：

```
CREATE TYPE DOMNode_Stack AS OBJECT ( 
   max_size INTEGER, 
   top      INTEGER,
   position ContainerArray,
   MEMBER PROCEDURE initialize,
   MEMBER FUNCTION full RETURN BOOLEAN,
   MEMBER FUNCTION empty RETURN BOOLEAN,
   MEMBER PROCEDURE push (n IN INTEGER),
   MEMBER PROCEDURE pop (n OUT INTEGER)
); 
```

而且我无法在包内创建对象类型，因为我得到了

> “在此上下文中不支持对象。”

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:06:40.053

像 OBJECT 这样的 sql 级对象只能在其属性中引用 SQL 类型。

如果您看到包装规格：

```
TYPE DOMNode IS RECORD (id RAW(13)); 
```

所以你可以创建一个 sql 数组

```
SQL> CREATE or replace TYPE ContainerArray AS VARRAY(25) OF raw(13);
  2  /

Type created. 
```

然后在你的对象中

```
position ContainerArray 
```

这将起作用。当你引用它时，只需分配一个局部变量 v_dom xml_dom.domnode; begin v_dom.id := 您当时正在处理的数组索引值；

请注意，在任何 Oracle 升级中，您都需要验证 DOMNODE 的结构没有改变。

编辑：这是一个示例：

```
SQL> set serverout on
SQL> create or replace type containerarray as varray(25) of raw(13);
  2  /

Type created.

SQL> create type domnode_stack as object (
  2     position containerarray,
  3     member procedure initialize,
  4     member procedure print_node_names
  5  );
  6  /

Type created.

SQL> CREATE TYPE body DOMNode_Stack
  2  as
  3    member procedure initialize
  4    is
  5      v_dom dbms_xmldom.DOMNode;
  6      v_doc dbms_xmldom.domdocument;
  7      v_nl  dbms_xmldom.DOMNodeList;
  8    begin
  9      position := containerarray();
 10      v_doc := dbms_xmldom.newDOMDocument(xmltype('<root><foo>test</foo><foo2>test2</foo2></root>')); -- just some summy data.
 11      v_nl  := dbms_xmldom.getElementsByTagName(v_doc, '*');
 12      for idx in 0..dbms_xmldom.getLength(v_nl)-1 loop
 13        v_dom := DBMS_XMLDOM.item(v_nl, idx);
 14        position.extend;
 15        position(position.last) := v_dom.id;
 16      end loop;
 17    end;
 18
 19    member procedure print_node_names
 20    is
 21      v_dom dbms_xmldom.DOMNode;
 22    begin
 23      for idx in 1..position.count
 24      loop
 25        v_dom.id := position(idx);
 26        dbms_output.put_line(dbms_xmldom.getnodename(v_dom)||'='||dbms_xmldom.getnodevalue(dbms_xmldom.getfirstchild(v_dom)));
 27      end loop;
 28    end;
 29  end;
 30  /

Type body created.

SQL> show errors type body DOMNode_Stack
No errors.
SQL> declare
  2    o_domnode DOMNode_Stack := DOMNode_Stack(null);
  3  begin
  4    o_domnode.initialize();
  5    o_domnode.print_node_names();
  6  end;
  7  /
root=
foo=test
foo2=test2

PL/SQL procedure successfully completed. 
```

重要的是：

从 DBMS_XMLDOM 分配给我们采用 v_dom.id 的 sql 类型。

13 v_dom := DBMS_XMLDOM.item(v_nl, idx); 14个位置。扩展；15 位置（位置.last）：= v_dom.id；

倒车时：

23 for idx in 1..position.count 24 循环 25 v_dom.id := position(idx);

即分配ID部分（不是记录本身..这会出错）回来。

# android - 自定义 Lint 规则：如何处理修复按钮单击

> ID：13352258
> 
> 赞同：5
> 
> 时间：2012-11-12T21:57:18.917
> 
> 标签：android, eclipse, android-lint

我按照[本](http://tools.android.com/tips/lint-custom-rules)教程进行操作，它对我来说非常完美。现在我想添加修复问题功能。我正在使用 Eclipse。

在**Lint 警告**视图中，我们有**修复**按钮，我可以处理它吗？

例如，当您单击**CTRL + 1时，我们在****TextView中有硬编码字符串（** *android:text="Test"*），帮助弹出窗口可能会打开**Extract String**。我想要做的是添加提取硬编码 dp 值功能。

 ******如果你能指出我在哪里可以找到已经实现的 lint 问题的源代码，那也很棒。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-21T07:09:59.103

**Lint 检查可以独立编写：**

*   编写 Lint 检查：[http ://tools.android.com/tips/lint/writing-a-lint-check](http://tools.android.com/tips/lint/writing-a-lint-check)
*   皮棉检查来源：[https ://android.googlesource.com/platform/tools/base/+/master/lint/libs/lint-checks/src/main/java/com/android/tools/lint/checks](https://android.googlesource.com/platform/tools/base/+/master/lint/libs/lint-checks/src/main/java/com/android/tools/lint/checks)

**Lint 修复是 ADT 插件的一部分：** [http ://tools.android.com/tips/lint](http://tools.android.com/tips/lint)

> Lint 与 ADT 16 及更高版本集成。该集成在 lint 的命令行版本之上提供了一些功能：
> 
> *   **自动修复许多警告**
> *   Lint 在各种编辑操作中自动运行
> *   能够抑制错误类型以及特定错误实例
> *   配置问题严重性的能力
> *   从 lint 视图直接跳转到问题源

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-01T11:48:50.000

**考虑在IntelliJ Idea Community** **edition**中为您的自定义 lint 检查制作一个插件，从[https://www.jetbrains.com/idea/download/](https://www.jetbrains.com/idea/download/)下载，并按照[http://www.jetbrains.org/intellij/sdk上的教程进行操作/docs/index.html](http://www.jetbrains.org/intellij/sdk/docs/index.html)。

之后，您将知道要处理灯泡以修复自定义 Lint 警告，您必须特别扩展**IntentionAction**类。

然后在教程中搜索部署插件，最后你就会知道将这样创建的插件的jar放在Android Studio/Contents/plugins文件夹中。******

# sql-server - 如何在团队中共享 Analysis Services 数据源

> ID：13352259
> 
> 赞同：1
> 
> 时间：2012-11-12T21:57:24.297
> 
> 标签：sql-server, visual-studio-2010, visual-studio

我们开发了一个使用 MSSQL Server 的应用程序。出于开发目的，每个人都使用本地服务器。

我创建了一个新的 Analysis Services 项目，并在 Data Sources 文件夹中添加了数据源。我选择了名为**MYNAME-KOMPUTER\MSSQLSRV 的**本地服务器，它对我有用。

在我提交之后，我的同事拉了它（我们使用 git），在他的 Data Sources 文件夹下没有数据源。顺便说一句，这是可以预见的。

问题是如何让它适用于所有人？

# php - 使用 SimpleXML 抓取嵌套代码

> ID：13352269
> 
> 赞同：0
> 
> 时间：2012-11-12T21:57:46.967
> 
> 标签：php, xml, simplexml

> **可能重复：**
> [读取名称中包含“列 - ：”的属性时出现 php simplexml 问题](https://stackoverflow.com/questions/8912256/php-simplexml-issue-in-reading-an-attribute-that-has-a-column-in-its-name)

我正在学习 PHP，所以我正在制作一个天气应用程序来根据天气显示图像。我正在使用雅虎天气 API。

我的问题是我正在寻找一种方法来获取[位于 yweather:condition 旁边的天气代码](http://weather.yahooapis.com/forecastrss?w=12793465&u=f)。我找到[了simpleXML](http://php.net/manual/en/simplexml.examples-basic.php)，但不知道如何抓取位于雅虎以以下形式处理其xml的方式的东西

```
<yweather:condition text="Fair" code="34" temp="37" 
```

所以我的问题是如何获取 Yahoo 天气的**code="34"**部分并将其显示为变量，例如`$weathercode = 34;`？

感谢您提供的所有帮助，如果您需要，我会在这里提供更多详细信息！

另外，我不确定这篇文章的标题是否正确，如果不对，请见谅！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:07:20.543

您可以按照与下面类似的方式使用 SimpleXMLElement::attributes 调用。

```
$string = {Yahoo Weather Feed}

$xml = simplexml_load_string($string);

$weathercode = $xml->channel->item->children('yweather', true)->condition[0]->attributes()->code; 
```

您可能需要修补以使其正确，但这只是一个指南。

参考： http: [//php.net/manual/en/simplexmlelement.attributes.php](http://php.net/manual/en/simplexmlelement.attributes.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:05:17.987

您可以尝试以下方法：

```
$xml = simplexml_load_file('http://weather.yahooapis.com/forecastrss?w=12793465&u=f');
var_dump($xml); 
```

这将加载 URL 并转储 SimpleXML 对象。

[更多关于 simplexml_load_file 这里](http://php.net/manual/en/function.simplexml-load-file.php)

# ruby-on-rails-3 - Rails 3 - 具有连接和计数的复杂查询，可能的子查询？

> ID：13352273
> 
> 赞同：0
> 
> 时间：2012-11-12T21:57:58.650
> 
> 标签：ruby-on-rails-3, controller, subquery

好的，所以我想在我的 Rails 应用程序中提出一些复杂的查询。我有四个表：Clients、Projects、Invoices、Invoice_Line_Items。我正在尝试从所有这些表中获取某些数据位，并将其显示在我的应用程序的“报告”类型视图中。这是四个表的结构：

**客户**

```
 |  id  |  name           |  archive  |
----------------------------------------
 |   1  |  Client 1       |     0     |
 |   2  |  Client 2       |     0     | 
```

**项目**

```
 |  id  |  client_id  |  name           |  archive  |
------------------------------------------------------
 |   1  |      1      |  Project 1      |     0     |
 |   2  |      1      |  Project 2      |     1     |
 |   3  |      2      |  Project 3      |     0     |
 |   4  |      2      |  Project 4      |     1     | 
```

**发票**

```
 |  id   |  client_id  |  project_id  |  name           |  archive  |
----------------------------------------------------------------------
 |   1   |      1      |      1       |  Invoice 1      |     0     |
 |   2   |      1      |      1       |  Invoice 2      |     0     |
 |   3   |      1      |      2       |  Invoice 3      |     1     |
 |   4   |      1      |      2       |  Invoice 4      |     1     |
 |   5   |      2      |      3       |  Invoice 5      |     0     |
 |   6   |      2      |      3       |  Invoice 6      |     0     |
 |   7   |      2      |      4       |  Invoice 7      |     1     |
 |   8   |      2      |      4       |  Invoice 8      |     1     | 
```

**Invoice_Line_Items**

```
 |  id   |  invoice_id  |  name         |  amount_due  |
---------------------------------------------------------
 |   1   |       1      |  Item 1       |     500      |
 |   2   |       1      |  Item 2       |     500      |
 |   3   |       2      |  Item 3       |     500      |
 |   4   |       2      |  Item 4       |     500      |
 |   5   |       3      |  Item 5       |     500      |
 |   6   |       3      |  Item 6       |     500      |
 |   7   |       4      |  Item 7       |     500      |
 |   8   |       4      |  Item 8       |     500      |
 |   9   |       5      |  Item 9       |     500      |
 |   10  |       5      |  Item 10      |     500      |
 |   11  |       6      |  Item 11      |     500      |
 |   12  |       6      |  Item 12      |     500      |
 |   13  |       7      |  Item 13      |     500      |
 |   14  |       7      |  Item 14      |     500      |
 |   15  |       8      |  Item 15      |     500      |
 |   16  |       8      |  Item 16      |     500      | 
```

好的，希望这些图表足够有意义。我正在寻找的结果集是这个（示例数据集取自上述示例数据）：

```
 |  clients.name   |  current_projects  |  archived_projects  |  total_amount_due  |  total_amount_paid  |
-----------------------------------------------------------------------------------------------------------
 |  Client 1       |  1                 |  1                  |  2000              |  2000               |
 |  Client 2       |  1                 |  1                  |  2000              |  2000               | 
```

好的，这就是那里发生的事情：

1.  获取所有*未归档的*客户端
2.  获取所有*未归档*项目的计数
3.  获取所有*存档*项目的计数
4.  从 invoice_line_items 表中获取 total_amount_due，它是所有*未归档*发票的总和
5.  从 invoice_line_items 表中获取 total_amount_paid，它是所有*存档*发票的总和

我对 Rails 比较陌生，这是一个相当复杂的查询（至少在我的脑海中）。请让我知道是否有一个我忽略的更简单的解决方案，或者我是否过于复杂。如果我需要在我的控制器中执行多个查询，那很好，我只是想看看我是否可以通过一个 sql 调用逃脱。我很确定我可以用一些子查询很容易地做到这一点，但我不确定如何在 Rails 的控制器中编写这些子查询。

感谢您提供的任何帮助或指导，如果这个问题只是令人发指或只是让我知道，我会删除它并去搜索更多谷歌（已经尝试无济于事）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:08:30.950

好的，我最终自己想出了一个解决方案。不太确定这是最好的解决方案....感觉很重很乱，但我只是在控制器中创建了很多对象来获取从数据库中提取数据所需的 sql 语句。我基本上每列都有一个对象（**column**，*而不是*每一行）。让我知道是否有人能找到更好的解决方案。

# jenkins - 詹金斯从服务器

> ID：13352274
> 
> 赞同：0
> 
> 时间：2012-11-12T21:57:59.240
> 
> 标签：jenkins, jenkins-plugins

我有一个网络问题，因为我有 2 个地理位置。每个位置都有一个 ESX 环境，我必须从管理网络桥接到每个生产网络 - 我不能使用路由。位置 A 无法连接到位置 B 的生产网络。但是，位置 A 的管理网络可以连接到位置 B 的管理网络。

我在位置 A 运行 Jenkins，但我还需要让 Jenkins 在位置 B 的生产网络中运行作业。所以我在想我是否可以设置一个主从 Jenkins 服务器解决方案。Jenkins Master 将在位置 A，而 Jenkins Slave 将在位置 B。

我希望通过一台 Jenkins 服务器来管理所有方面，并且由于 2 台 Jenkins 服务器可以在管理网络上进行通信，我可以让主服务器在从服务器上启动作业，以便在位置 B 的生产网络上运行作业。

那行得通吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:05:34.523

只要您可以从主从服务器获得 TCP/IP 连接，这应该可以正常工作。您可以设置从属设备，使其始终在同一端口上与主设备通信，因此如果您在防火墙中打开该端口，您应该没问题。

查看[Jenkins Wiki](https://wiki.jenkins-ci.org/display/JENKINS/Distributed+builds)以获取有关如何设置 slave 的完整详细信息。

# django - 带有抽象模型的 django 内联给出错误

> ID：13352275
> 
> 赞同：1
> 
> 时间：2012-11-12T21:57:59.943
> 
> 标签：django, django-models, django-admin

我在 Django models.py 中有以下内容（模型被剥离到只有必要的字段）

```
class Product(BaseProduct):
    price       = models.IntegerField()
    productfoto = models.ManyToManyField("ProductFoto", related_name="%(app_label)s_%(class)s_related")

    class Meta:
        abstract = True
        ordering = ['name']

# Inherits Product class
class ConsumerProduct(Product):
    categorie= models.ForeignKey(Categorie)
    class Meta:
        verbose_name_plural = "ConsumerProducten"

class ProductFoto(models.Model):
    myimage= FileBrowseField("Image", max_length=200, directory='producten') 
```

这在 admins.py 中：

```
class ProductFotoInline(admin.TabularInline):
    extra = 1
    model = Product.productfoto.through

class ConsumerProductAdmin(admin.ModelAdmin):
    prepopulated_fields = {"slug": ("name",)}
    inlines= [ProductFotoInline]
admin.site.register(ConsumerProduct, ConsumerProductAdmin) 
```

请注意以下几点：

*   产品类是抽象的
*   ConsumerProduct 继承 Product

我会说这应该可行，但是在尝试添加新的 ConsumerProduct 时出现以下 ImproperlyConfigured 错误：

```
'model' is a required attribute of 'ConsumerProductAdmin.inlines[0]'. 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T09:30:17.390

我决定让我的 Product 类成为非抽象类。通过使用管理员删除此类的注册（删除行`admin.site.register(Product)`）您将不会在后端看到它，但是在您的数据库中，它会有点混乱，因为您将同时拥有 a`Product`和`ConsumerProduct`table

# curl - Elasticsearch 使用搜索查询来删除结果

> ID：13352276
> 
> 赞同：0
> 
> 时间：2012-11-12T21:58:01.160
> 
> 标签：curl, elasticsearch, dsl

下面是一个布尔搜索查询。我想删除此查询匹配的所有文档结果。怎么做？

我尝试[通过查询接口删除](https://www.elastic.co/guide/en/elasticsearch/reference/1.7/docs-delete-by-query.html)（新的 api 在[这里](https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete-by-query.html)）

```
CURL -XDELETE /index/doc/_query/routing=abc -d '{
  "query": {
    "bool": {
      "must": [
        {
          "term": {
            "_ua_family": "Firefox"
          }
        },
        {
          "range": {
            "created_at": {
              "gte": 1352147225,
              "lte": 1352752025
            }
          }
        }
      ],
      "should": [],
      "must_not": []
    }
  },
  "sort": {
    "created_at": "desc"
  },
  "facets": {
    "_message": {
      "histogram": {
        "field": "created_at",
        "interval": 3600
      }
    }
  },
  "from": 0,
  "size": 10
}' 
```

弹性搜索响应包含

```
{
  "_shards": {
    "total": 1,
    "successful": 0,
    "failed": 1
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T23:09:13.780

得到它的工作，查询应该是

```
{
    "bool": {
        "must": [{
            "term": {
                "_ua_family": "Firefox"
            }
        }, {
            "range": {
                "created_at": {
                    "gte": 1352147225,
                    "lte": 1352752025
                }
            }
        }],
        "should": [],
        "must_not": []
    }
} 
```

# javascript - 动画后在 d3.js 中获取画布位置 (cx/cy) 以供将来参考？

> ID：13352277
> 
> 赞同：1
> 
> 时间：2012-11-12T21:58:11.433
> 
> 标签：javascript, d3.js

如何在动画之后访问和存储 D3 对象的画布位置 (cx/cy)，以便我可以将其用作下一个动画的起点？

我有以下输入转换：

```
var enterTransition = enter.transition()
    .duration(duration)
    .delay(function(d, i) { return i * delay; })
    .attr("cx", function(d, i) { return Math.random()*width; })
    .attr("cy", function(d, i) { return Math.random()*height; }); 
```

结果我真的不知道我的节点在哪里结束。

一个节点可能有子节点和一个“点击”事件作为结果。如果用户单击节点，我希望新一批节点从父节点开始并从那里随机化。我像这样定义我的节点（“气泡”）......

```
var bubbles = vis.insert("svg:g")
    .attr("class", "enter")
  .selectAll("g")
    .data(d.children)
  .enter().append("svg:circle")
    .attr("stroke", "black")
    .attr("fill", function(d, i) { return colors(i); })
    .attr("cx", function(d, i) { return d.cx0; })  // for illustration purposes
    .attr("cy", function(d, i) { return d.cy0; })  // for illustration purposes
    .attr("r", function(d, i) { return rScaled(d.duration); })
    .style("cursor", function(d) { return !d.children ? null : "pointer"; })
    .on("click", down); 
```

我的`d.cx0`和`d.cy0`代表父节点的cx/cy。

如何在动画后抓取这些信息并保存以供参考？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:35:13.353

在您具有设置`"cx"`和的功能中`"cy"`：

```
.attr("cx", function(d, i) { 
  // In here, the "this" keyword refers to the svg circle. So:
  var parent = this.parentNode;// That's the parent you're interested in
  return d3.select(parent).attr('cx');
}) 
```

（对你所拥有的和你想要达到的目标不够熟悉，很可能有一种更合适的方法来实现这一点，它不依赖于读取父母的属性，我认为这有点贵）。

# python - 在 Scipy 中切片稀疏矩阵——哪种类型效果最好？

> ID：13352280
> 
> 赞同：29
> 
> 时间：2012-11-12T21:58:56.993
> 
> 标签：python, indexing, scipy, sparse-matrix, slice

SciPy[稀疏矩阵教程](http://www.scipy.org/SciPyPackages/Sparse)非常好——但它实际上留下了未开发的切片部分（仍处于大纲形式——请参阅“处理稀疏矩阵”部分）。

一旦回答了这个问题，我将尝试更新教程。

我有一个大的稀疏矩阵——目前是 dok_matrix 格式。

```
import numpy as np
from scipy import sparse
M = sparse.dok_matrix((10**6, 10**6)) 
```

对于各种方法，我希望能够对列进行切片，而对于其他方法，我希望对行进行切片。理想情况下，我会使用高级索引（即布尔向量`bool_vect`）来分割稀疏矩阵`M`——如：

```
bool_vect = np.arange(10**6)%2  # every even index
out = M[bool_vect,:]            # Want to select every even row 
```

或者

```
out = M[:,bool_vect] # Want to select every even column 
```

首先， dok_matrices 不支持这一点 - 但我认为如果我首先转换为 lil_matrices，它会（缓慢）通过`sparse.lil_matrix(M)`

据我从教程中收集到的信息 - 对我想使用 CSC 的列进行切片，对我想对 CSR 进行切片的行进行切片。这是否意味着我应该`M`通过以下方式转换矩阵：

```
M.tocsc()[:,bool_vect] 
```

或者

```
M.tocsr()[bool_vect,:] 
```

我在这里有点猜测，因此我的代码很慢。任何了解其工作原理的人的帮助将不胜感激。提前致谢。

如果事实证明我不应该用一个布尔数组来索引我的矩阵，而是一个整数列表（索引）——这也是我很乐意发现的。哪个更有效率。

最后 - 这是一个很大的矩阵，所以如果这可以发生在适当的位置/通过广播，那么可以加分。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-12T22:22:14.660

好的，所以我很确定这样做的“正确”方法是：如果要对列进行切片，请使用 tocsc() 并使用整数列表/数组进行切片。布尔向量似乎对稀疏矩阵不起作用——就像它在 numpy 中对 ndarray 所做的那样。这意味着答案是。

```
indices = np.where(bool_vect)[0]
out1 = M.tocsc()[:,indices]
out2 = M.tocsr()[indices,:] 
```

但问题是：这是最好的方法吗？这是到位了吗？

在实践中，这似乎确实发生了——而且它比以前的尝试（使用 lil_matrix）要快得多。

# r - 如何防止零在 R 的熔化表中变为 NULL？

> ID：13352282
> 
> 赞同：1
> 
> 时间：2012-11-12T21:59:04.193
> 
> 标签：r, ggplot2

目标是使用 ggplot() 绘制堆积条形图。首先，我需要融化数据表。但是，x8.p 中的零值在我将表融化到 x8.pm 后变成了 NULL (x8.pm$Var.1)，我丢失了作为数据一部分的零。

```
x8.p <-structure(c(70, 20, 7, 2, 2, 54, 33, 8, 0, 4, 37, 29, 23, 11, 
0, 46, 29, 18, 4, 2, 16, 29, 26, 20, 10, 37, 20, 9, 13, 22, 66, 
18, 14, 2, 0, 65, 20, 12, 3, 0, 47, 29, 18, 4, 3, 48, 32, 16, 
3, 1, 24, 25, 19, 22, 10, 41, 14, 18, 9, 18, 66, 25, 6, 3, 0, 
62, 23, 14, 1, 0, 47, 30, 14, 8, 1, 46, 31, 16, 6, 1, 19, 27, 
25, 22, 7, 34, 15, 17, 13, 21, 68, 22, 7, 2, 1, 62, 21, 16, 1, 
0, 45, 30, 18, 5, 1, 43, 28, 22, 5, 2, 20, 23, 25, 23, 10, 36, 
20, 12, 14, 19, 60, 25, 13, 2, 0, 62, 23, 10, 6, 0, 41, 24, 26, 
9, 0, 47, 31, 16, 5, 1, 13, 29, 22, 24, 13, 28, 16, 20, 18, 18
), class = "table", .Dim = c(5L, 6L, 5L), .Dimnames = structure(list(
    c("Highly Satisfied", "Moderately Satisfied", "Satisfied", 
    "Moderately Dis-Satisfied", "Extremely Dis-Satistfied"), 
    c("I've changed for work/ a new job/ gone on a work plan", 
    "I want a phone that 2degrees doesn't offer", "I want Best Mates/ Favourites", 
    "I was offered or saw a better offer on another network", 
    "Issues with the 2degrees network (poor coverage)", "Other"
    ), YearQuarter = c("2011-09-01", "2011-12-01", "2012-03-01", 
    "2012-06-01", "2012-09-01")), .Names = c("", "", "YearQuarter"
)))

x8.p.m <- melt(x8.p, id="var");x8.p.m

ggplot(data=x8.p.m, aes(x=as.factor(YearQuarter), y=value, fill=Var.1,na.rm=TRUE))+ geom_bar(stat="identity")+facet_wrap(~Var.2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T12:58:22.243

看起来你的问题从裂缝中溜走了。我有几个建议：

1) 您在展示您拥有的数据方面做得很好，但您可能会考虑更明确地说明最终数据的结构。2）您可能希望在您的帖子中添加一个 ggplot2 标签——这里的很多用户都喜欢回答 ggplots。

![堆叠条示例](../Images/427cf7d803341ad8c08cf9368d53423f.png)

也就是说，我采取了几个步骤表明您可能一直在思考。我将其创建为一个数组，然后将其融合为一个二维矩阵，为您提供一些不错的图形选项：

```
library(reshape2)
library(ggplot2)
x8.New <-c(70, 20, 7, 2, 2, 54, 33, 8, 0, 4, 37, 29, 23, 11, 
                   0, 46, 29, 18, 4, 2, 16, 29, 26, 20, 10, 37, 20, 9, 13, 22, 66, 
                   18, 14, 2, 0, 65, 20, 12, 3, 0, 47, 29, 18, 4, 3, 48, 32, 16, 
                   3, 1, 24, 25, 19, 22, 10, 41, 14, 18, 9, 18, 66, 25, 6, 3, 0, 
                   62, 23, 14, 1, 0, 47, 30, 14, 8, 1, 46, 31, 16, 6, 1, 19, 27, 
                   25, 22, 7, 34, 15, 17, 13, 21, 68, 22, 7, 2, 1, 62, 21, 16, 1, 
                   0, 45, 30, 18, 5, 1, 43, 28, 22, 5, 2, 20, 23, 25, 23, 10, 36, 
                   20, 12, 14, 19, 60, 25, 13, 2, 0, 62, 23, 10, 6, 0, 41, 24, 26, 
                   9, 0, 47, 31, 16, 5, 1, 13, 29, 22, 24, 13, 28, 16, 20, 18, 18)

length(x8.New)

# names and structures your values
Exit.Survey <- array(x8.New, c(5, 6, 5), dimnames = list(
  Rating = c("Highly Satisfied", "Moderately Satisfied", "Satisfied", "Moderately Dis-Satisfied", "Extremely Dis-Satistfied"), 
  Churn.Reason = c("work change", "diff phone", "Best Mates/ Favourites", "better offer", "poor coverage", "Other"), 
  YearQuarter = c("2011-09-01", "2011-12-01", "2012-03-01", "2012-06-01", "2012-09-01") 
  ))

#please note - 3d array- just like a cube of data - 3 matrices (including 0's!)
dim(Exit.Survey)
Exit.Survey[,,1]

#melts the 3d array into a 2d structure by adding a YearQuarter variable
df1<- melt(Exit.Survey, id=names(Exit.Survey), measured="YearQuarter")
df1$Rating<- factor(c("Highly Satisfied", "Moderately Satisfied", "Satisfied", "Moderately Dis-Satisfied", "Extremely Dis-Satistfied"))
ggplot(data=df1, aes(x=factor(Rating), y=value, fill=Churn.Reason)) +
  geom_bar(colour="black", stat="identity") +
  facet_grid(. ~ YearQuarter) + ylab(c("# of Churned Customers")) + 
  xlab(c("Satisfaction Level")) + scale_fill_brewer(palette="Set1") + 
  theme(axis.text.x  = element_text(angle=90, vjust=0.5)) + 
  scale_x_discrete(limits= c("Highly Satisfied", "Moderately Satisfied", "Satisfied", 
                     "Moderately Dis-Satisfied", "Extremely Dis-Satistfied")) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:05:44.847

我似乎无法复制您的问题，但无论如何，这可能比任何事情都更像是一种黑客攻击，只是使用 is.null 函数。

# java - Android PayPalActivity 不是全屏

> ID：13352286
> 
> 赞同：10
> 
> 时间：2012-11-12T21:59:24.080
> 
> 标签：java, android, paypal, popup, android-activity

我正在尝试在我的应用程序中包含一个 PayPal 捐赠按钮（从操作栏按钮启动它），它确实可以正常工作，但是......它只是将 PayPalActivity 显示为一个非常小的弹出窗口，而它应该几乎是全屏的默认！

让我更好地解释一下...我使用通常的代码来启动付款活动：

```
Intent checkoutIntent = PayPal.getInstance().checkout(payment, this, new ResultDelegate());
startActivityForResult(checkoutIntent, 1); 
```

好吧，它按预期启动了活动，但它似乎在一个非常小的弹出窗口中“窗口化”，而它应该是一个几乎全屏的大弹出窗口。在清单中，我声明了 PayPalActivity 通常需要的参数：

```
<activity android:name="com.paypal.android.MEP.PayPalActivity"
        android:theme="@android:style/Theme.Translucent.NoTitleBar"
        android:configChanges="keyboardHidden|orientation" /> 
```

我还添加了所需的权限...

我究竟做错了什么？

我正在 Galaxy S3 上进行测试并使用 Android 4.0.3 API（但在手机上运行 4.1.1）

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:07:47.357

这绝对是 PayPal 库中的一个错误。尝试设置

```
android:targetSdkVersion="3" 
```

在您的清单文件中，您将获得全屏弹出窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-08T12:47:25.293

这为我解决了这个问题：

```
<uses-sdk android:minSdkVersion="3" /> 
```

希望能帮助到你 ;-）

# iphone - 在另一个类中更改 NSString 时更新 UILabel 文本

> ID：13352288
> 
> 赞同：1
> 
> 时间：2012-11-12T21:59:39.127
> 
> 标签：iphone, ios, nsstring, uilabel, nsobject

我有一`NSObject`堂课`NSStrings`和`UIImages`。我通过从服务器下载数据来填充它们。我在管理器类中所做的，我下载一个 JSON 并将其解析`NSObject`为填充基本`NSString`& `UIImages`。然后我在`NSObject`的类中启动一个方法，从另一台服务器下载更复杂的数据并将其`NSObject`放入`NSMutableDictionary`. 所以我最终得到的是一本充满我的字典`NSObjects`，其中一些数据已经下载，一些数据仍在下载。

然后我尝试将 in 的数据输入到`NSObject`另一个类（视图控制器）中。但是，某些数据可能仍在加载，因此 UILabels 将显示为空，例如，如果应该填充的数据尚未下载。`UILabels``UIImageViews``NSString`

现在我的问题是，一旦在它的类中下载（重新设置），我怎样才能`UILabels`再次更改 's 的文本？基本上我需要从' 类中“观察” '的值。我发现了这样的东西：`NSString``NSObject``NSObject``NSString``UILabel`

```
observeValueForKeyPath:ofObject:change:context 
```

但我不知道如何使用它。我知道我必须在 ' 类中实现它，但是当它观察到' 的变化时`UILabel`，如何以及如何设置它以更新`UILabel`' 文本？`NSObject``NSString`

我也读过一些关于`NSObjectController`类的东西，它适用于这里吗？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:08:29.513

你已经很接近了——你想要的叫做**key-value observing**，它在[Key-Value Observing Programming Guide](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)中有详细描述。为此，您不需要 NSObjectController - 相反，让管理 UILabel 视图的视图控制器将自己添加为其他类的观察者，然后在收到`observeValueForKeyPath:ofObject:change:context`消息时更新 UILabel 文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:19:55.057

基本上你需要在你的`UILabel`子类中实现以下内容：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
    if ([keyPath isEqualToString:@"nameOfThePropertyInYourNSObjectSubclass"]) {
        id changedValue = [object valueForKeyPath:keyPath];
        //do what ever you want with it
    }
} 
```

此外，要为 KVO 注册您的`NSObject`子类，您需要实现：

```
[self addObserver:yourUILabel forKeyPath:@"nameOfThePropertyOfYourString" options:NSKeyValueObservingOptionNew context:NULL]; 
```

请注意，您还必须在适当的时间取消注册观察者（取决于您的设计）：

```
[self removeObserver:yourUILabel forKeyPath:@"nameOfThePropertyOfYourString" context:NULL]; 
```

另请注意，虽然 KVO 是一个简洁的东西，并且在某些情况下非常有用，但选择它并不是一件容易的事。特别是在您的情况下，我建议您改用回调。从网络获取数据最好在后台线程中完成，在这种情况下，我会使用委托模式来通知您的视图控制器，新数据可用并让视图控制器负责更新您的标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:24:38.793

KVO 是可能的，但也可以查看*委托*模式。我相信这里会更简单。

# ios - 无法修改自定义表格视图单元格属性

> ID：13352289
> 
> 赞同：0
> 
> 时间：2012-11-12T21:59:48.673
> 
> 标签：ios, uitableview

我已经尝试了所有方法，当我在 didSelectRowForIndexPath 中设置时 UIActivityMonitorView 不会旋转。我访问自定义表格视图单元格

`CustomCell *cell = (CustomCell *) [tableview cellForRowAtIndexPath];`

我可以看到在调试器中初始化的单元格及其属性，但是当我尝试修改单元格上的任何内容时，没有任何变化。我将单元格 activityMonitor IBOutlet 设置为在没有运气的 performSelectorAfterDelay 中开始旋转。当我尝试将单元格 alpha 设置为 0 时，也没有任何反应。

但是，如果我将微调器设置为通过 IB 旋转，它会在单元加载时工作。

我也尝试通过标签访问它，但它没有工作。

如何在自定义 tableview 单元格上设置属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T04:12:12.940

查看*Table View Programming Guide*中的[自定义单元格。](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html#//apple_ref/doc/uid/TP40007451-CH7-SW18)但是，故事板、NIB 或以编程方式创建的单元格之间的细节有所不同。您必须分享您的和您的，以便我们诊断正在发生的事情。下面，我将向您展示一个使用旋转活动指示器的示例，但这里没有什么特别之处。我怀疑您的应用程序发生了一些简单的事情，但除非我们能看到您的代码，否则我们无法为您提供帮助。*`UITableViewCell``tableView:cellForRowAtIndexPath:``tableView:didSelectRowAtIndexPath:`*

 *但是，为了向您展示一个示例，假设您已`UITableViewCell`使用 Interface Builder 中定义的接口进行子类化。`didSelectRowAtIndexPath`这是一个启动旋转活动指示器并在 15 秒后将其关闭的示例。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    TestCell *cell = (TestCell *)[tableView cellForRowAtIndexPath:indexPath];

    // I have a model in my app for the sections of the tableview, as well as the rows,
    // so let's get the pointer to the appropriate model information. Your implementation
    // may differ, but hopefully you get the idea.

    Section *section = self.sections[indexPath.section];
    Row *row = section.rows[indexPath.row];

    // because we selected this row, start the activity indicator

    [cell addActivityIndicator];

    // let's flag the row in our model to indicate that we're busy here (so if and when
    // we represent this row, we'll know if we're busy or not)

    row.loading = YES;

    // and let's asynchronously dispatch a "stop activity indicator" in 15 seconds

    int64_t delayInSeconds = 15.0;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        // because this is happening asynchronously, let's re-retrieve the cell
        // pointer, just in case it might have scrolled off of the visible screen
        // as is no longer visible or the pointer to the cell might have changed

        TestCell *currentCell = (TestCell *)[tableView cellForRowAtIndexPath:indexPath];

        // let's remove the activity indicator

        [currentCell removeActivityIndicator];

        // let's flag our model to indicate that this row is no longer loading

        row.loading = NO;
    });
} 
```

在这种情况下，我需要确保`tableView:cellForRowAtIndexPath:`查看模型数据以确定它是否也需要显示旋转活动指示器：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"TestCell";
    TestCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    // if I'm using storyboards, the following isn't needed, but if not, I might use something
    // like the following to load the custom cell from a NIB

    //if (cell == nil)
    //{
    //    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"TestCell" owner:self options:nil];
    //    cell = (TestCell *)[nib objectAtIndex:0];
    //}

    // this happens to be my model structure, where I have an array of sections,
    // and each section has its array of Row objects for that section

    Section *section = self.sections[indexPath.section];
    Row *row = section.rows[indexPath.row];

    // each "Row" object has two text fields, which I use to update the
    // two labels in my TestCell subclass of UITableViewCell

    cell.label1.text = row.text1;
    cell.label2.text = row.text2;

    // for this row of this section, figure out whether I need to start animating
    // the UIActivityIndicator

    if (row.loading)
        [cell addActivityIndicator];
    else
        [cell removeActivityIndicator];

    return cell;
} 
```

在我的子类`UITableViewCell`中是添加和删除活动指示器的代码：

```
@interface TestCell ()

@property (strong, nonatomic) UIActivityIndicatorView *activity;

@end

@implementation TestCell

- (void)addActivityIndicator
{
    if (!self.activity)
    {
        self.activity = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
        self.activity.center = self.contentView.center;
    }
    [self.contentView addSubview:self.activity];
    [self.activity startAnimating];
}

- (void)removeActivityIndicator
{
    if (self.activity)
    {
        [self.activity stopAnimating];
        [self.activity removeFromSuperview];
        self.activity = nil;
    }
}

@end 
```

这只是它如何工作的一个简单示例，但实现可能会有很大差异（取决于 NIB、故事板、以编程方式创建控件、应用程序模型的性质等）。与其尝试为您的应用修改上述代码，不如与我们共享您的代码可能会更容易，我们希望能够很快发现问题。问题可能很简单。*

# java - Java String：用多个值替换字符串

> ID：13352291
> 
> 赞同：4
> 
> 时间：2012-11-12T21:59:55.687
> 
> 标签：java, regex, replace

我目前正在构建一个配置文件，它将用多个变量替换给定的字符串，我很难解释它，所以也许最好向你展示我的意思：

以下方法将与字符串一起使用：您好~欢迎来到~！

```
private static String REPLACE_CHAR = "~";

public static String parse(String key, String... inputs) {
    int cache = matchCache.get(key, -1);
    String value = customConfig.getString(key);
    if (cache == -1) {
        cache = StringUtils.countMatches(value, REPLACE_CHAR);
        matchCache.put(key, cache);
    }
    for (int i = 0; i < cache; i++) {
        value = value.replaceFirst(REPLACE_CHAR, inputs[i]);
    }
    return value;
} 
```

用第一个输入替换〜的最快方法是什么，然后移至第二个〜等等......

现在我没有使用其他人的代码的主要原因：理想情况下，我想创建一个不同可替换字符的列表，这将反过来自动替换变量，所以在同一个代码中我可以不给它输入但是它将检查列表中的可替换字符并执行诸如 getYourName() 之类的方法。此列表不需要每次都检查，因此仍然可以编译模式？

我这样做是为了提高效率，我在正则表达式方面缺乏能力！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:28:13.860

如果您正在寻找效率，您可以`Matcher`使用正则表达式实例化 a，然后使用该`find()`方法查找出现，将每个出现的替换附加到 a`StringBuffer`中。

```
private Matcher matcher = Pattern.compile("([~])").matcher("");

public String parse(String key, String... inputs) {
    String value = customConfig.getString(key);
    matcher.reset(value);
    StringBuffer sb = new StringBuffer();
    int i = 0;
    while (matcher.find()) {
      String text = matcher.group(1);
      matcher.appendReplacement(sb, inputs[i++]);
    }
    matcher.appendTail(sb);
    return sb.toString();
}

System.out.println(parse("foo", "T F C", "James Bond"));
// prints "Hello T F C, my name is James Bond" 
// if customConfig.getString("foo") returns "Hello ~, my name is ~" 
```

这样，您可以避免在涉及的每个循环期间从字符串开头查找`String.replaceFirst`。`~`但是，如果您想验证的长度`input[]`确实等于它，您仍然可以缓存找到的数量。

上面的示例确实忽略了正确数量的条目存储在`inputs[]`.

可运行的示例可以在这里找到：http: [//ideone.com/QfE03a](http://ideone.com/QfE03a)

# search - 带有 Yelp 搜索覆盖的 Google 地图

> ID：13352292
> 
> 赞同：2
> 
> 时间：2012-11-12T21:59:56.890
> 
> 标签：search, yelp

## 原始问题：我正在尝试在我的网站中嵌入一张地图，上面覆盖有搜索结果，例如附近的所有酒吧或医院。我知道这是很常见的事情 - 但我很难找到示例代码或有关如何执行此操作的教程。谁能给我一些指示？

我最终做的是使用谷歌地图搜索地址，然后“搜索附近”并复制谷歌提供的嵌入代码。然后我使用 innerHtml 根据单击的复选框（无论是通过酒吧、商店等）交换嵌入代码 - 例如：

```
 var bars       = 'embed map code from Google Maps';

            if(document.getElementById('ChkBar').checked) {
        document.getElementById('MapBlock').innerHTML = bars;
    } 
```

这是试图找出 Yelp API 并在 Google 地图 API 提供的地图上手动放置标记的解决方法。

此解决方案的唯一问题是提供的嵌入代码会去除您在“附近搜索”的位置的标记 - 即使它出现在您进行“附近搜索”时显示的地图中。我尝试使用自定义谷歌地图 - 你应该能够添加自定义标记，如下所示：（http://insideout.com/blog/2012/02/26/create-a-custom-google-map-for -your-blog-post-imw/) 但 Google 提供的嵌入代码不起作用 - 实际上它给您的信息是：“无法嵌入此地图” - 我认为这是由于许可问题。我尝试过其他地图站点，结果相同...

这给我留下了两个问题：是否有人知道提供嵌入代码的站点，该代码将显示周围位置搜索的标记以及从搜索返回的位置的标记？根据我过去一天所做的事情，我认为这不太可能 - 但可能值得一问。

如果不是 - 那么我只能使用 yelp API 并在 google map API 提供的 google map 上手动放置标记。我已经弄清楚了google api。我遇到问题的 Yelp API。有谁知道一个好的教程或有通过 yelp api 从 yelp 搜索中提取位置信息的示例代码？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T09:45:57.920

您可以使用 Google Place Library 进行本地搜索。Google Place 搜索非常简单且运行良好。以下是 Google 文档的链接。看看吧，我想你会得到你的答案。

[http://code.google.com/apis/maps/documentation/javascript/places.html#place_searches](http://code.google.com/apis/maps/documentation/javascript/places.html#place_searches)

# python - ldapsearch 工作，但 python-ldap 没有

> ID：13352296
> 
> 赞同：1
> 
> 时间：2012-11-12T22:00:13.130
> 
> 标签：python, ldap, python-ldap

以下工作并返回所有用户的列表

```
ldapsearch -x -b "ou=lunchbox,dc=office,dc=lbox,dc=com" -D "OFFICE\Administrator" -h ad.office.lbox.com -p 389 -W "(&(objectcategory=person)(objectclass=user))" 
```

我正在尝试在 Python 中做同样的事情，我得到了`Invalid credentials`

```
#!/usr/bin/env python

import ldap

dn = "cn=Administrator,dc=office,dc=lbox,dc=com"
pw = "**password**"

con = ldap.initialize('ldap://ad.office.lbox.com')
con.simple_bind_s( dn, pw )

base_dn = 'ou=lunchbox,dc=office,dc=lbox,dc=com'
filter = '(objectclass=person)'
attrs = ['sn']

con.search_s( base_dn, ldap.SCOPE_SUBTREE, filter, attrs ) 
```

任何使这项工作的建议都会很棒。我正在努力学习`python-ldap`谢谢

编辑

这是我得到的完整错误：

```
`ldap.INVALID_CREDENTIALS: {'info': '80090308: LdapErr: DSID-0C0903A9, comment: AcceptSecurityContext error, data 52e, v1db1', 'desc': 'Invalid credentials'}` 
```

`LDAP`服务器是 Windows Server 2008 R2 上的 Active Directory

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-06T17:09:04.690

您使用不同的凭据从命令行和 python 脚本进行绑定。

命令行使用的是绑定 dn，`OFFICE\Administrator`而脚本使用的是绑定 dn`cn=Administrator,dc=office,dc=lbox,dc=com`

在 Active Directory 上，内置帐户`Administrator`不位于林的顶层`AD`，它通常至少位于 . 之下，因此您*可能*应该使用`Users` `OU`的 dn是：*`CN=Administrator,CN=Users,dc=office,dc=lbox,dc=com`*

 *为用户找到正确条目的最简单方法是在命令行搜索中实际使用帐户名，例如

```
ldapsearch -x -b "ou=lunchbox,dc=office,dc=lbox,dc=com" -D "OFFICE\Administrator" -h ad.office.lbox.com -p 389 -W '(samaccountname=Administrator)' dn 
```

并`dn`在 python 代码中使用从命令行查询返回的作为`dn`绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-30T13:18:58.550

python-ldap 库不解析用户名，ldapsearch 也不解析。在您的代码中，只需使用相同的用户名`OFFICE\Administrator`并让 Active Directory 处理它。

此外，ActiveDirectory 拒绝通过 ldap 进行简单绑定的情况并不少见。您必须使用 LDAPS。添加此行以绕过证书检查：

```
ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER) 
```

所以整个代码可能如下所示：

```
#!/usr/bin/env python

import ldap

dn = "OFFICE\Administrator"
pw = "**password**"

ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)

con = ldap.initialize('ldaps://ad.office.lbox.com')
con.simple_bind_s( dn, pw )

base_dn = 'ou=lunchbox,dc=office,dc=lbox,dc=com'
filter = '(objectclass=person)'
attrs = ['sn']

con.search_s( base_dn, ldap.SCOPE_SUBTREE, filter, attrs ) 
```*

# android - 在我的 android 项目中使用 android box 2d

> ID：13352297
> 
> 赞同：1
> 
> 时间：2012-11-12T22:00:12.823
> 
> 标签：android, box2d, jbox2d

我正在尝试查找 android box 2d 的 .jar 文件，但没有成功。到目前为止，我已经找到了一个据称带有它的 apk，但不知道我将如何使用它。假设您可以将 apk 转换为 jar，但这就是我要找的吗？

第二个问题是仅使用 jbox2d 而不是 android 版本是否存在问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:15:00.573

您可以查看一个 SVN 路径。我看了看，它似乎包含一个带有您正在寻找的 .jar 文件的 Android 项目。

结帐此路径：[http ://androidbox2d.googlecode.com/svn/trunk/](http://androidbox2d.googlecode.com/svn/trunk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:59:50.727

甚至不要为 box2d 烦恼，试试[AndEngine](http://www.andengine.org/)，它是专门为 Android 设计和优化的，它不仅包含 box2d 引擎，还包含声音、精灵、openGL 支持以及许多你可以直接使用的游戏相关的东西。我提到样品了吗？是的，有很多！

# php - 是否可以通过两次 crypt(rounds=Y/2) 获得 PHP crypt(rounds=Y) 的结果

> ID：13352300
> 
> 赞同：0
> 
> 时间：2012-11-12T22:00:20.057
> 
> 标签：php, cryptography, md5, password-protection, password-encryption

我想做的是有这样的事情

```
$res_5a = crypt($password, '$6$rounds=5000$'.$salt.'$');
$res_25 = crypt($password, '$6$rounds=2500$'.$salt.'$');
$res_5b = crypt($res_25, '$6$rounds=2500$'.$salt.'$');
echo ($res_5a==$res_5b); //should be true 
```

我尝试使用 $res_25 字符串，但仍然无法获得我想要的结果。我假设 crypt() 用它做了一些不平凡的事情，并想知道是否有一种简单的方法可以做到这一点。

我打算通过以下方式使用它。当用户注册时，密码使用 5k 轮加密，结果存储在 DB 中（5k 只是一个例子，我们假设它足够安全）。盐帮助我们确保不能使用彩虹桌，而圆形可以保护我们免受蛮力攻击。如果数据库被盗，则无法解密密码，并且攻击者将无法在用户可能使用相同密码的其他地方使用这些密码。

我们的网站本身在登录表单上有“记住我”功能。不使用时，一切正常 - 我们将用户的状态存储在最终死掉的服务器会话中。但是，当用户想要使用“记住我”时，我们需要使用 cookie 来存储可用于对用户进行身份验证的数据。无论我们在 cookie 中存储什么 - 无论是原始密码还是 md5($res_5a) 之类的东西，如果攻击者窃取了 $res_5a 值并窃取了 cookie 创建背后的算法，他们将能够使用这些数据来伪造 cookie这将对用户进行身份验证。

我想做的是让登录表单创建 $res_25 cookie。然后每当加载页面时，服务器将添加 2.5k 更多迭代并检查该值是否与存储在数据库中的 $res_5a 匹配。这样，如果 $res_5a 被盗，攻击者将无法计算验证用户所需的 $res_25 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:13:13.277

**介绍**

`string`它永远不会相同...因为您在第二次通话后不再对原始内容进行哈希处理`crypt`...我是什么意思

```
$salt = "salt";
$password = "password";
$res_5a = crypt($password, '$6$rounds=5000$'.$salt.'$');
$res_25 = crypt($password, '$6$rounds=2500$' . $salt . '$');
$res_5b = crypt($res_25, '$6$rounds=2500$'.$salt.'$');

var_dump($password,$res_5a,$res_25,$res_5b); 
```

输出

```
string 'password' (length=8) <----------- Original Text

string '$6$rounds=5000$salt$IxDD3jeSOb5eB1CX5LBsqZFVkJdido3OUILO5Ifz5iwMuTS4XMS130MTSuDDl3aCI6WouIL9AjRbLCelDCy.g.' (length=106)
       |------------------|
         Custom Header for 500 rounds 

string '$6$rounds=2500$salt$e9Ui0CoNFtgwugogNU.uUwCKW8hAeW4td1ySwKf34FqEwMf2Gpk3zu5Y43R5a2AaI/5lpPigk1rSTme.uotYL1' (length=106)
       |------------------|
          Custom header would be added .. you are no onder encoding password

string '$6$rounds=2500$salt$JAq/IG3jH6w7r6S/AT/UhMpgLopLOWLbilJWY9z39s6To109QJvLxZJUkV99arSOSumFbS3Fy00CRAYrAd9Pp1' (length=106)
       |------------------|
         Even Final output would not be same as $6$rounds=5000$salt 
```

**解决方案**

更好的方法是使用安全**令牌哈希**并且永远不要在系统上存储用户名和密码

令牌可能在哈希组合中有`User Agent`, `OS`,`Screen Resolution`只是为了确保您处于相同的环境中

也尝试使用[Http_only](http://php.net/manual/en/function.session-set-cookie-params.php) cookie[安全含义的示例](http://www.codinghorror.com/blog/2008/08/protecting-your-cookies-httponly.html)

```
 session_set_cookie_params(0, NULL, NULL, NULL, TRUE);
                                                   ^----- Http Only 
```

# android - Android NFC Transmit without Android Beam，模拟谷歌钱包

> ID：13352301
> 
> 赞同：1
> 
> 时间：2012-11-12T22:00:29.220
> 
> 标签：android, nfc

我目前正在做一个需要我模拟 Google Wallet 功能的项目。经过初步调查，我了解到 Google Wallet 做了一种叫做 Card Emulation 模式的东西。在此模式下，您可以像写入 NFC 卡一样写入 NFC 数据，只有您可以在卡上进行回调。由于卡模拟模式被锁定，我一直在试图找到一种方法来模拟这个功能。我想要一个显示“点击付款”的按钮，然后出现一个屏幕显示付款信息正在等待发送。信息一经发送，屏幕将消失。所有这些都是模拟的，不会发送任何真实或重要的数据。这基本上是用于模拟显示。

任何帮助将不胜感激。

提前致谢。

# php - 使用日期范围和另一个条件进行 MongoDB 搜索

> ID：13352302
> 
> 赞同：4
> 
> 时间：2012-11-12T22:00:47.237
> 
> 标签：php, mongodb

我正在尝试在 mongodb 中查询具有特定日期范围内的“日期”属性的文档，这就是我的做法。

Q1。

```
$searchCriteria = array('$and' => 
        array(
            'date' => array('$gt' => $start, '$lte' => $end),
            'lid' => $lid
            )); 
```

Q2。

```
$results = $collection->find($searchCriteria); 
```

它不会返回任何内容，但如果我分别运行每个搜索条件，它们就会起作用。

Q3。

```
$searchCriteria = array(
            'date' => array('$gt' => $start, '$lte' => $end)
            ); 
```

这有效，它返回与此日期范围匹配的文档

```
 $searchCriteria = array(
            'lid' => $lid
            ); 
```

这也有效，返回所有盖子等于我要求的。

但是当我想将这些与条件相结合时，它不起作用，这是搜索条件 Q1 的 var_dump：

```
array(1) { '$and' => array(2) { 'date' => array(2) { '$gt' => string(10) "2010-11-10" '$lte' => string(10) "2010-11-12" } 'lid' => int(6209) } } 
```

这是同一查询的 json_encoded 输出：

```
{"$and":{"date":{"$gt":"2010-11-10","$lte":"2010-11-12"},"lid":6209}} 
```

在 mongo shell 中运行查询的 json 输出会导致错误

```
db.largedaily.find({"$and":{"date":{"$gt":"2010-01-01","$lte":"2010-01-02"},"lid":6209}});

error: { "$err" : "$and expression must be a nonempty array", "code" : 14816 } 
```

我究竟做错了什么？我想我设置的 searchCriteria 不正确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T22:07:17.113

A1/A2：你不需要 $and 这样的，而是使用：

```
$searchCriteria = array(
    'date' => array('$gt' => $start, '$lte' => $end),
    'lid' => $lid
); 
```

在 shell 上，这`{"$and":{"date":{"$gt":"2010-11-10","$lte":"2010-11-12"},"lid":6209}}`是不正确的，因为您需要使用数组（带有 []）而不是对象（即 {}）。正确的是：

```
{"$and":[ {"date":{"$gt":"2010-11-10","$lte":"2010-11-12"} }, {"lid":6209} ]} 
```

但是你不需要`$and`，你可以使用：

```
db.largedaily.find( {"date":{ "$gt":"2010-11-10","$lte":"2010-11-12"}, {"lid":6209 } ); 
```

# java - 立面模式的优缺点

> ID：13352303
> 
> 赞同：4
> 
> 时间：2012-11-12T22:00:50.013
> 
> 标签：java, design-patterns, facade

嗨，我正在阅读关于外观模式的“应用 Java 模式”一书

我试图找出它的优点和缺点，它说......

“Facade 模式的好处是它为复杂系统提供了一个简单的接口，而不会减少整个系统提供的选项。这个接口可以保护客户端免受过多选项的影响。

Facade 将客户端请求转换为可以满足这些请求的子系统。大多数时候，一个请求将被委托给多个子系统。因为客户端只与Facade交互，所以系统内部的工作可以改变，而Facade的客户端可以保持不变。

Facade 促进了客户端和子系统之间的低耦合。它也可以用来减少子系统之间的耦合。每个子系统都可以有自己的 Facade，系统的其他部分使用 Facade 与子系统通信。”

客户端和子系统之间的低耦合不好？？？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T22:02:58.387

耦合也不错。

无用的耦合是不好的，因为：

*   它导致需要维护的 API 更大
*   将重要信息隐藏在无用信息中

外观允许您在两个实体之间准确地进行所需的耦合

# list - 递归 Haskell 函数，将一个列表分成一对列表，然后遍历这对列表

> ID：13352305
> 
> 赞同：0
> 
> 时间：2012-11-12T22:01:00.903
> 
> 标签：list, haskell, recursion, tuples

我有一个函数，让我们调用它`fct1`，它接受任何列表并在一个列表中获取所有相等的一个，在第二个列表中获取所有其余的，它们在一个元组中。

`data sale : ( sale string int)` `fct1 [sale,sale..sale]`将仅返回在第一个列表中具有相同字符串且在第二个列表中具有所有其他字符串的销售）

ex 上的数字（更容易理解）：`fct1 [1,2,3,4,6,7,1,3,4]= ([1,1],[2,3,4,6,7,3,4])`

我还有第二个功能，我们称之为`fct2`。

`fct2`总是在 fst(tuple) 上应用，我需要将结果累积到一个列表中。列表将是返回值

我需要`fct2`在 fst(tuple) 上应用 a 然后在 snd(tuple) 上应用相同`fct1`的，所以它与其余部分重新创建一个元组，直到我达到 fct1 =[]

我知道我必须递归地做，只是不知道从哪里开始......`fct1`也是`fct2`如此。

这是我的伪代码...

```
type Qty = Integer                                                        
type Product =string                                    
data Sales = Sales Product Qty`

as  is a list

fct1 = (fct1 (\(Sales product qty) -> product == product(head as)) as)
it return a tuple (list1,list2) 
```

fct2：

fct1 需要在 snd(tuple) 上运行，因此我以 snd(tuple) 的身份到达 []，同时我需要在 fst(tuple) fct2 上运行，它获取列表并将其汇总为一个元素，我需要保存并累积到一个列表中。

我希望我这次更明确..

在这里找到解决方案是代码：

```
 fct2 as = accSales [] as

   where accSales n as =

            if as == []

            then sortBy compareSale n

            else let x =sumQty(fst(fct1(as)))
                     xs = snd(fct1(as)) 
                 in  accSales (x:n) xs` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:44:16.403

```
FOUND THE SOLUTION HERE IS THE CODE:

 fct2 as = accSales [] as

   where accSales n as =

            if as == []

            then sortBy compareSale n

            else let x =sumQty(fst(fct1(as)))
                     xs = snd(fct1(as)) 
                 in  accSales (x:n) xs` 
```

# c# - C# 复选框选中计数

> ID：13352308
> 
> 赞同：2
> 
> 时间：2012-11-12T22:01:11.960
> 
> 标签：c#, winforms, checkbox, count

我在一个面板内有几个复选框和一个按钮，在一个 tabPage 内，在一个 WinForm C# 应用程序内。

我要做的是确保至少选中一个复选框，以便使按钮可点击，否则按钮将被禁用（灰色显示不可点击）。

我试过这个（在`Form_Load`事件中）但它没有用：

```
int counter = 0;
        foreach (Control p in tabPage1.Controls)
        {
            if (p is Panel)
            {
                foreach (Control c in panel1.Controls)
                {
                    if (c is CheckBox)
                    {
                        if (((CheckBox)c).Checked)
                        {
                            counter++;
                        }
                        if (counter < 1)
                        {
                            button1.Enabled = false;
                        }
                        else
                        {
                            button1.Enabled = true;
                        }
                    }
                }
            }
        } 
```

要么是因为我使用了错误的事件或错误的放置代码的位置，要么是代码本身不正确，有人可以看看吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T22:06:39.253

您可以这样做（注意..您的特定循环是多余的..您知道容器的名称..为什么要循环搜索它？）

```
if (panel1.Controls.OfType<CheckBox>().Any(x => x.Checked)) {
    // at least one is checked.. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:06:56.637

这段代码应该在两个地方运行：

*   表单的`Load`事件，在您使用任何保存的值加载复选框后
*   复选框的`CheckedChanged`事件处理程序，因此按钮状态会随着复选框被选中而更新

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-16T05:08:09.987

删除这部分，您永远不会在下面的代码中使用“p”变量...

```
foreach(Control p in tabPage1.Controls)
{
  if (p is Panel)
  { 
```

```
int counter = 0;
foreach(Control c in panel1.Controls)
{
  if (c is CheckBox)
  {
    if (((CheckBox)c).Checked)
    {
      counter++;
    }
    if (counter < 1) {
      button1.Enabled = false;
    }
    else {
      button1.Enabled = true;
    }
  }
} 
```

# windows - matplotlib 和 wxpython 的透明度问题

> ID：13352311
> 
> 赞同：2
> 
> 时间：2012-11-12T22:01:23.210
> 
> 标签：windows, matplotlib, wxpython, transparency

我正在为 Windows 开发基于 matplotlib 和 wxpython 的 GUI。当使用“Windows XP”主题（绿色开始按钮、蓝色任务栏）时，我遇到了一个可见的问题。我很确定同样的问题也会出现在 Vista 上。我知道一个不完美的解决方法，但我无法正确解决此问题。

我的 matplotlib 绘图嵌入在 wxPanels 中，wxPanels 嵌入在 wxNotebook（选项卡，如果您愿意的话）中。对于某些主题，选项卡的背景颜色实际上是渐变色，wx 会尝试将其与接近它的颜色匹配。这是不完美的解决方法：窗口顶部的颜色匹配，但底部不匹配。

这就是为什么我想实际使用具有透明背景的 matplotlib 图。当我将图形的 facecolor 设置为透明时，它实际上采用桌面的“颜色”或位于后面的任何窗口，而不是 wxPanel/wxNotebook。如果我调整窗口大小，透明部分会累积绘制数据。最后一个问题不再是特定于主题的，我也在“Windows Classic”上观察到它。

在下面的示例代码中，我希望图形的透明部分显示嵌入绘图的面板上设置的蓝色。

```
import wx
import matplotlib
matplotlib.use('WXAgg')
from matplotlib.figure import Figure
from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg
import wxversion
import sys

class MyFrame ( wx.Frame ):

    def __init__( self, parent ):
        wx.Frame.__init__ ( self, parent, id = wx.ID_ANY, title = wx.EmptyString, pos = wx.DefaultPosition, size = wx.Size( 300,650 ), style = wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )

        self.SetSizeHintsSz( wx.DefaultSize, wx.DefaultSize )

        bSizer3 = wx.BoxSizer( wx.VERTICAL )

        self.m_notebook2 = wx.Notebook( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, 0 )
        self.m_panel1 = wx.Panel( self.m_notebook2, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        bSizer4 = wx.BoxSizer( wx.VERTICAL )

        self.m_panel2 = wx.Panel( self.m_panel1, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel2.SetBackgroundColour( wx.SystemSettings.GetColour( wx.SYS_COLOUR_ACTIVECAPTION ) )

        bSizer4.Add( self.m_panel2, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel1.SetSizer( bSizer4 )
        self.m_panel1.Layout()
        bSizer4.Fit( self.m_panel1 )
        self.m_notebook2.AddPage( self.m_panel1, u"a page", False )

        bSizer3.Add( self.m_notebook2, 1, wx.EXPAND |wx.ALL, 0 )

        self.SetSizer( bSizer3 )
        self.Layout()

        self.Centre( wx.BOTH )

    def __del__( self ):
        pass

class MyPlot:
    def __init__(self, panel, notebook):
        self.panel = panel
        self.panel.figure = Figure(None, dpi=None)
        self.panel.canvas = FigureCanvasWxAgg(self.panel, -1, self.panel.figure)
        self.panel.axes = self.panel.figure.add_subplot(111)
        self.panel.Bind(wx.EVT_SIZE, self.onSize)

        # I want this code to work whatever the theme. It works fine on WinXP "Windows Classic" theme, but not on WinXP "Windows XP" theme (with green Start menu button and blue taskbar)
        self.setColor(None)
        # The problem here is that SYS_COLOUR_BTNFACE does not match the notebook background for the Windows XP theme

        # Solution 1: get background gradient from notebook
        # Source: http://wxpython-users.1045709.n5.nabble.com/wxTextCtrl-doesn-t-show-background-as-expected-on-a-notebook-panel-td2359680.html
        # Problem: match is perfect at top, not at bottom (not much difference, though)
        #
        # # # Uncomment below
        # rgbtuple = notebook.GetThemeBackgroundColour()
        # clr = [c / 255\. for c in rgbtuple]
        # self.panel.figure.set_facecolor(clr)
        # self.panel.figure.set_edgecolor(clr)

        # Solution 2: set transparent figure facecolor to capture color from panel
        # Problem 1: it takes the color from behind the frame (ie desktop, any other window behind...), not the color of the panel
        # Problem 2 (linked to problem 1): it gets worse when resizing as it doesn't repaint but accumulates
        #
        # http://matplotlib.1069221.n5.nabble.com/redrawing-plot-with-transparent-background-in-wx-tt26694.html seems related but did not receive any answer
        # # # Recomment above, uncomment below
        #self.panel.figure.set_facecolor('None')

        self.setSize()

    def setSize(self):
        pixels = tuple(self.panel.GetClientSize())
        self.panel.SetSize(pixels)
        self.panel.canvas.SetSize(pixels)
        self.panel.figure.set_size_inches(float(pixels[0]) / self.panel.figure.get_dpi(),
                                    float(pixels[1]) / self.panel.figure.get_dpi())

    def onSize(self, event):
        self.setSize()

    def setColor(self, rgbtuple=None):
        if rgbtuple is None:
            rgbtuple = wx.SystemSettings.GetColour(wx.SYS_COLOUR_BTNFACE).Get()
        clr = [c / 255\. for c in rgbtuple]
        self.panel.figure.set_facecolor(clr)
        self.panel.figure.set_edgecolor(clr)
        self.panel.canvas.SetBackgroundColour(wx.Colour(*rgbtuple))

print "python " + str(sys.version_info)
print "wx " + str(wxversion.getInstalled())
print "matplotlib " + matplotlib.__version__ 

app = wx.App(0)
window = MyFrame(None)
plot = MyPlot(window.m_panel2, window.m_notebook2)
window.Show()
app.MainLoop() 
```

如果您抓住窗口的一角并摇晃它几次以调整其大小，则通常可以看到蓝色。我会立即故意调整大小，而不是等待窗口空闲。

请取消注释代码中指示的行，以查看我可能没有清楚解释的内容。

我的配置：Python 2.7.3、wx 2.9.4-msw、matplotlib 1.1.1

**编辑**

我没有取得太大进展：

*   我注意到 matplotlib 1.2.0 已经发布，所以尝试了一下，但没有任何变化
*   我简化了示例以摆脱 wxNotebook，问题仍然存在，只有 wxPanel
*   我发现[http://wxpython-users.1045709.n5.nabble.com/advice-on-filling-squares-tp4475117p4479387.html](http://wxpython-users.1045709.n5.nabble.com/advice-on-filling-squares-tp4475117p4479387.html)这可能会提示正在发生的事情

我还开发了另一个示例，其中我覆盖了两个图形，以查看透明度“停止”的位置。有趣的是，下图停止了顶部图形的透明度，但 wxPanel 没有。

```
import wx
import matplotlib
matplotlib.use('WXAgg')
from matplotlib.patches import Rectangle
from matplotlib.figure import Figure
from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg
import wxversion
import sys

class MyFrame ( wx.Frame ):

    def __init__( self, parent ):
        wx.Frame.__init__ ( self, parent, id = wx.ID_ANY, title = wx.EmptyString, pos = wx.DefaultPosition, size = wx.Size( 300,650 ), style = wx.DEFAULT_FRAME_STYLE|wx.TAB_TRAVERSAL )

        self.SetSizeHintsSz( wx.DefaultSize, wx.DefaultSize )

        bSizer4 = wx.BoxSizer( wx.VERTICAL )

        self.m_panel2 = wx.Panel( self, wx.ID_ANY, wx.DefaultPosition, wx.DefaultSize, wx.TAB_TRAVERSAL )
        self.m_panel2.SetBackgroundColour( wx.SystemSettings.GetColour( wx.SYS_COLOUR_ACTIVECAPTION ) )

        bSizer4.Add( self.m_panel2, 1, wx.EXPAND |wx.ALL, 5 )

        self.m_panel2.Layout()

        self.SetSizer( bSizer4 )
        self.Layout()

        self.Centre( wx.BOTH )

    def __del__( self ):
        pass

class MyPlot:
    def __init__(self, panel):
        self.panel = panel

        # This figure is behind
        self.panel.figure = Figure(figsize=(2,2), dpi=None)
        self.panel.canvas = FigureCanvasWxAgg(self.panel, -1, self.panel.figure)
        self.panel.axes = self.panel.figure.add_axes([0.3,0.3,0.5,0.5])
        patch = Rectangle((0,0), 0.3, 0.2, facecolor='red')
        self.panel.axes.add_patch(patch)

        # This figure is on top
        self.panel.figure2 = Figure(figsize=(3,3), dpi=None)
        self.panel.canvas2 = FigureCanvasWxAgg(self.panel, -1, self.panel.figure2)
        self.panel.axes2 = self.panel.figure2.add_axes([0.3,0.3,0.5,0.5])
        patch2 = Rectangle((0.5,0.5), 0.4, 0.1, facecolor='blue')
        self.panel.axes2.add_patch(patch2)

        # Make the top figure transparent
        # self.panel.figure2.set_facecolor('None') # equivalent to self.panel.figure2.patch.set_alpha(0)

        # By default, leave figure on bottom opaque
        # Uncomment to see effect of transparency
        #self.panel.figure.patch.set_alpha(0.5)
        self.panel.figure2.patch.set_alpha(0.5)

        # Draw everything
        self.panel.canvas.draw()

print "python " + str(sys.version_info)
print "wx " + str(wxversion.getInstalled())
print "matplotlib " + matplotlib.__version__ 

app = wx.App(0)
window = MyFrame(None)
plot = MyPlot(window.m_panel2)
window.Show()
app.MainLoop() 
```

谢谢你的帮助 ：）

# java - Tar.gz 使用 commons.net FTPClient 下载后损坏

> ID：13352312
> 
> 赞同：2
> 
> 时间：2012-11-12T22:01:25.817
> 
> 标签：java, ftp, gzip, ftp-client, apache-commons-net

我正在尝试从 FTP 服务器（通过 HTTP 代理）下载 tar.gz 文件。虽然已经处理了通过代理连接的麻烦（我能够从 FTP 站点读取常规文件），但我能够将文件下载到我的桌​​面（显然是开发人员机器）。但是当我尝试膨胀该文件时，我遇到了一个异常。以下是我的代码片段

```
if (CollectionUtils.isNotEmpty(filesList)) {
    for (String fileName : filesList) {
        if (fileName.endsWith(getArchiveFileType())) {
            // File is a tar.gz file.
            // Download this file to a local directory
            FtpDownloadMethod downloadMethod = new FtpDownloadMethod();
            OutputStream output = new FileOutputStream(getOutputDirectory() + fileName);
            downloadMethod.setFileTransferMode(FTPClient.COMPRESSED_TRANSFER_MODE);
            downloadMethod.setOutput(output);
            downloadMethod.setUri(fileName);
            isDownloaded = isDownloaded && getServiceProxy().executeMethod(downloadMethod).isSuccess();
            output.close();
        }
    }
} 
```

这是进行传输的实际方法。

```
String uri; //method arguements
OutputStream output; //method arguements

DefaultFtpResponse response = null;

try {
    response = new DefaultFtpResponse();

    boolean success = false;

    if (StringUtils.isBlank(getUri())) {
        response.setStatusCode(FTPReply.FILE_UNAVAILABLE);
    } else {
        aFtpClient.connect();
        aFtpClient.enterLocalPassiveMode();
        aFtpClient.setFileType(FTPClient.BINARY_FILE_TYPE);
        aFtpClient.setFileTransferMode(getFileTransferMode());
        success = aFtpClient.retrieveFile(uri, output);
        response.setSuccess(success);
        response.setStatusCode(FTPReply.COMMAND_OK);
    }
} catch (Exception exp) {
    LOGGER.error(exp);
}

return response; 
```

此代码创建一个文件，我可以看到在所需的输出文件夹中创建了一个文件。下载后，当我尝试解压缩下载的文件时，我看到了这个错误。

```
 java.util.zip.ZipException: oversubscribed literal/length tree 
```

我也尝试了 BLOCK_TRANSFERR_MODE 和 BINARY_TRANSFER_MODE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T23:18:06.687

上传的文件已损坏。我试图以二进制传输模式上传。将其更改为压缩传输模式后，我可以处理该文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T00:26:15.093

我可以知道您如何“解压缩”下载的文件吗？正如您所提到的，下载的文件是 .tar.gz，它不是 zip 格式，所以我认为您正在尝试将 .tar.gz 提取为 .zip 文件，这应该不起作用。如果要解压 .tar.gz 文件，可以参考这个问题： [How do I extract a tar file in Java?](https://stackoverflow.com/questions/315618/how-do-i-extract-a-tar-file-in-java)

# jquery - 带有 jquery $.ajax 的 Rails

> ID：13352313
> 
> 赞同：1
> 
> 时间：2012-11-12T22:01:28.720
> 
> 标签：jquery, ruby-on-rails, ruby, ajax, append

我是 Rails 新手（来自 PHP），并且在使用 ajax 提交表单时遇到问题。基本上，我有一个任务列表，当添加新任务时，我希望将新任务附加到列表中。表单本身正在提交，但我不知道如何附加新条目。提前致谢！

**表格**

```
<%= simple_form_for(Task.new) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :name %>
    <%= f.input :date_due %>
    <%= f.input :phase_id, :as => :hidden, :input_html => { :value => @phase.id } %>
    <%= f.input :status, :as => :hidden, :input_html => { :value => "0" } %>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %> 
```

**JS**

```
$('form#new_task').submit(function() {  
    var valuesToSubmit = $(this).serialize();
    $.ajax({
        type: "POST",
        url: $(this).attr('action'), //sumbits it to the given url of the form
        data: valuesToSubmit,
        dataType: "JSON" 
    }).success(function(data){
          // disaply new charge in the table 
          $('body').append(data);

          // clear the form
          $("input#task_name").val('');

          //focus on the input again
          $("input#task_name").focus();
    });
    return false; // prevents normal behaviour
}); 
```

**编辑** 还值得一提的是，这发生在“阶段”的视图中。每个阶段都有_许多任务，每个任务都属于_一个阶段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:24:17.497

看起来 JSON 正在从控制器返回。您需要将返回的 JSON 包装在 html 中，语法与要附加到的表中的其他行相同（也许`<tr><td>..</td></tr>`），然后将该 html 附加到表中。或者您可以为表中的每一行创建一个部分，当您添加一个新任务时，从控制器返回部分的 html，然后将其附加到表中。

```
<table id="tasks">
    <% @phase.tasks.each do |task| %>
      <%= render :partial => 'task_row', :locals => {:task => task} %>
    <% end %>
  </table> 
```

将 js 更改为：

```
$('form#new_task').submit(function() {  
    var valuesToSubmit = $(this).serialize();
    $.ajax({
        type: "POST",
        url: $(this).attr('action'), //sumbits it to the given url of the form
        data: valuesToSubmit,
        dataType: "HTML" 
    }).success(function(data){
          // disaply new charge in the table 
          $('#tasks').append(data);

          // clear the form
          $("input#task_name").val('');

          //focus on the input again
          $("input#task_name").focus();
    });
    return false; // prevents normal behaviour
}); 
```

在你的控制器中是这样的

```
def create
  @task = Task.new(params[:task])
  respond_to do |format|
    if @task.save
     format.js{render :partial => 'tasks', :locals => {:task > @task} }
    else
     #handle validation error
    end
  end
end 
```

这一切都未经测试，但我希望它能让你走上正轨

# wordpress - 自定义帖子类型的 WordPress 条件语句

> ID：13352316
> 
> 赞同：1
> 
> 时间：2012-11-12T22:01:51.477
> 
> 标签：wordpress, custom-post-type, conditional-statements

我一直在尝试创建一个条件行，允许我为特定的自定义帖子类型添加多个 ID。我对单个 ID 使用类似以下的内容，但我不知道如何为多个 ID 执行此操作：

```
<?php if ('people' == get_post_type() && get_the_ID() == 107) {  ?> 
```

我一直在尝试这样说：如果自定义帖子类型是人员并且 ID 是 107、109 或 111，则执行此操作。否则，这样做……</p>

这可能与自定义帖子类型有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:11:51.020

你可以这样做

```
$arr=array(107, 109, 111); // keep all ids in an array that you want check
<?php if ('people' == get_post_type() && in_array(get_the_ID(), $arr))  { ?>
    ...
<?php } ?> 
```

# ruby - 作为 Google Apps 管理员，我如何为使用 Ruby 的用户创建 Google 电子表格？

> ID：13352317
> 
> 赞同：3
> 
> 时间：2012-11-12T22:01:54.110
> 
> 标签：ruby, google-api, google-drive-api, google-sheets, google-apps

我想为我们的 Google Apps 服务的用户自动创建文档。
注意事项：

*   无法为用户启用 OAuth
*   我有超级管理员 API 访问令牌
*   我只知道用户的电子邮件地址

这可以通过现有的 Ruby 库实现吗？（大多数使用 2-legged auth 作为用户而不是管理员来完成此操作。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:33:09.910

我能够通过“服务帐户”和 Google 的 (alpha) gem 来实现这一点[`google-api-client`](https://code.google.com/p/google-api-ruby-client/)。这是一个 Ruby 类，从不同的 Google 文档中抽样，在实例化时接收用户的电子邮件（来自您管理的 Google Apps 域）。

```
require 'google/api_client'

class GoogleDriveConnection
  def initialize(user_email=nil)
    @client = Google::APIClient.new
    @drive = @client.discovered_api('drive', 'v2')

    key_file_name = '<DOWNLOADED WHEN CREATING A SERVICE ACCOUNT>.p12'
    key = Google::APIClient::PKCS12.load_key("#{Rails.root.to_s}/config/#{key_file_name}", 'notasecret')

    asserter = Google::APIClient::JWTAsserter.new(
      '<THE EMAIL ADDRESS OF YOUR SERVICE ACCOUNT>',
      'https://www.googleapis.com/auth/drive',
    key)

    @client.authorization = asserter.authorize(user_email)
  end

  def insert_file(title, description, parent_id, mime_type, file_name)
    file = @drive.files.insert.request_schema.new({
      'title' => title,
      'description' => description,
      'mimeType' => mime_type
    })
    # Set the parent folder.
    if parent_id
      file.parents = [{'id' => parent_id}]
    end
    media = Google::APIClient::UploadIO.new(file_name, mime_type)
    result = @client.execute(
      :api_method => @drive.files.insert,
      :body_object => file,
      :media => media,
      :parameters => {
        'uploadType' => 'multipart',
        'convert' => true,
        'alt' => 'json'})
    if result.status == 200
      return result.data
    else
      puts "An error occurred: #{result.data['error']['message']}"
      return nil
    end
  end

  def list_files
    result = @client.execute!(:api_method => @drive.files.list)
    result.data.to_hash
  end

  def get_file(file_id)
    result = @client.execute!(
      :api_method => @drive.files.get,
      :parameters => { 'fileId' => file_id })
    result.data.to_hash
  end

  private

    def token
      @client.authorization.access_token
    end
end 
```

用法很简单：

```
g = GoogleDriveConnection.new('me@mycompany.com')
g.insert_file('My file', 'File stuff', nil, 'text/csv', "#{Rails.root}/tmp/test.csv") 
```

* 创建服务帐户和管理“API 项目”很棘手。[这个指南](https://developers.google.com/drive/delegation)似乎是最有用的。

# c - 如何在循环链表中添加节点？

> ID：13352318
> 
> 赞同：0
> 
> 时间：2012-11-12T22:02:06.530
> 
> 标签：c, linked-list

我的目标是使用动态数组从文件中读取文本，并在最后打印出带有参数“numline”的任何行。我必须使用循环单链表来完成这项工作。当我运行函数时，我只得到第一行 X numline。我很困惑，我是不是在添加节点分区或遍历和打印输出分区时做错了什么？

EDiT：我编辑了文件...

```
 void last(char* numline,char* fileptr)
{

  struct node *start,*newnode,*lastnode;
  struct node *ptr=start;
  char *linebuffer;
  int maxlinelen=512;
  int i=0;
  int j;

  FILE *fp;
  linebuffer=(char*)malloc(maxlinelen * sizeof(char*));
  if(linebuffer==NULL)
    {
      fprintf(stderr,"Command: last:Memory allocating failed for linebuffer\n");
      exit(1);
    }

      if((fp=fopen(fileptr,"r"))!=NULL)
    {
      start=NULL;

      while((fgets(linebuffer,maxlinelen,fp))!=NULL)
         {
           while(strlen(linebuffer)==maxlinelen-1)
         {
           maxlinelen*=2;
           linebuffer=realloc(linebuffer,maxlinelen * sizeof(char));
           if(linebuffer==NULL)
             {
               fprintf(stderr,"Command: last: Memory reallocating failed for linebuffer\n");
               exit(1);
             }
           fgets(linebuffer+(maxlinelen/2-1),(maxlinelen/2)+1,fp);
         } 

           if(start==NULL)
         {
           newnode=(struct node *)malloc(sizeof(struct node));

               strcpy(newnode->data,linebuffer);
               printf("linebuffer newnoda kopyalandi\n");

               start=newnode;
           newnode->next=newnode;
           // start=newnode;
           i++;
           printf("ikinciburda");
         }
           else{
         newnode=(struct node *)malloc(sizeof(struct node));
         strcpy(newnode->data,linebuffer);
         lastnode=start;
         while(lastnode->next!=start)
           {
             lastnode=lastnode->next;
           }
         lastnode->next=newnode;
         newnode->next=start;
         i++;
           }
         }
      printf("toplam line sayisi :%d\n",i);
         ptr=start;                           //<----- i added this line
      for(j=i-(atoi(numline));j<i;j++)
        {
          ptr=ptr->next;
        }
      while(ptr!=start)
        {
          printf("%s\n",ptr->data);
          ptr=ptr->next;
        }
      fclose(fp);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:37:29.173

这些行

```
 while(start->next!=start)
  {
      printf("%s\n",start->data);
      /// especially this one
      start=start->next;
  } 
```

看起来很可疑。

在第一次迭代中，您分配了`start->next`to`start`并立即退出循环（因为，显然，`start == start->next`）。

您应该做的就是创建一个`struct node* ptr`，为其分配 start ，然后进行`ptr = ptr->next`“totallines” - “numline” 次：

```
 struct node* ptr = start;

 for(j = atoi(numline) ; j < i ; j++) { ptr = ptr->next; }

 while(ptr != start)
 {
     printf("%s\n", ptr->data);
     ptr = ptr->next;
 } 
```

当然，您应该检查`numline <= totaline`- 为了简洁起见，我省略了此检查。

重要编辑：

插入后

```
 for(j = i - atoi(numline) ; j < i ; j++)
   {
       // debug statement
       printf("skip %s\n", ptr->data);
       ptr = ptr->next;
   } 
```

我注意到，链表的构造不正确——上面的迭代只给出了第一行。

EDIT2（一些注释）：

您的错误处理代码很好，不确定行长的动态缓冲区也很好，因为代码变得相当冗长并且查找问题并不容易。我想很多人都来了这个答案只是因为写了这么多，而且大部分都与链表无关，顺便说一句，链表*没有*在代码中定义。我的猜测是

```
 struct node
 {
     struct node* next;
     char data[SomeBigNumber];
 }; 
```

EDIT3：列表构造

“add-last-node”部分的代码更加棘手，应该澄清 lastnode/newnode 的混乱。

错误在这里：

```
 /// once again, here lastnode->next IS start, as you want it to be
        lastnode->next=start;
        /// and this condition is always false (see the previous line)
        while(lastnode->next!=start)
        {
            lastnode=lastnode->next;
        } 
```

您已经注释掉了 line `//lastnode = start;`，但它应该在循环之前到达最后一个元素。

`// add additional nodes`必须是：

```
 else {  //add additional nodes
        newnode=(struct node *)malloc(sizeof(struct node));
        strcpy(newnode->data,linebuffer);

        lastnode=start;
        while(lastnode->next!=start) { lastnode=lastnode->next; }

        lastnode->next=newnode;
        newnode->next=start;
        i++;
    } 
```

而且，当然，每次插入节点时都查找最后一个元素是多余的。您应该只保留`lastnode`始终指向最后一个元素（或 NULL，当列表最初为空时）。

# ruby-on-rails - RSpec load_missing_constant，期望 X 定义 Y（确实如此）

> ID：13352320
> 
> 赞同：8
> 
> 时间：2012-11-12T22:02:14.077
> 
> 标签：ruby-on-rails, ruby, rspec

当我们跑

`bundle exec rake spec`

尝试加载带有错误的环境时出错：

```
...gems/activesupport-3.2.8/lib/active_support/dependencies.rb:503:in `load_missing_constant': Expected ...app/models/links/category.rb to define Links::Category (LoadError) 
```

该文件`app/models/links/Category.rb`确实定义了`Links::Category`. 更奇怪的是，在 guard 和 spork（我们运行测试的标准方式）下运行时不会发生错误：

`bundle exec guard -i`

按预期运行测试套件，没有问题。

Spork 被配置为运行 rspec，所以我有点困惑为什么`rake spec`手动运行会导致这种情况。

我已经看到了类似的问题，这些问题似乎可以通过查看来解决`autoload_paths`，并检查它是否包括在内`lib`，`lib/**`但是我们的 autoload_paths 并没有做任何我能看到的时髦的事情。我们`autoload_paths`看起来像这样（在 application.rb 中定义）：

```
config.autoload_paths += %W(#{Rails.root}/app/src #{config.root}/app/api #{Rails.root}/app/products) 
```

（我们`bundle exec rake spec`在 CI 服务器中使用来运行测试，而不是我们在开发机器上使用的守卫）。

**category.rb 是否被加载**

添加`puts 'Hey'`在 category.rb 的顶部和`puts 'Yo'`底部，当运行规范时，输出包括它：

```
DEPRECATION WARNING: ActiveAdmin::Dashboard is deprecated and will be removed in the next version
Hey
Yo
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:503:in `load_missing_constant': Expected /Users/shimms/Development/lexim/app/models/links/category.rb to define Links::Category (LoadError) 
```

**应用程序/模型/链接/link.rb**：

```
class Links::Link < ActiveRecord::Base
  self.table_name = 'links_category_links'
  attr_accessible :description, :name, :url, :category_id

  acts_as_paranoid

  belongs_to :category, :class_name => 'Links::Category'

  validates_presence_of :url
  validates_presence_of :name
end 
```

**应用程序/模型/链接/category.rb**：

```
class Links::Category < ActiveRecord::Base
  self.table_name = 'links_categories'
  attr_accessible :description, :name, :space_id

  acts_as_paranoid

  extend FriendlyId
  friendly_id :name, :use => :scoped, :scope => :space

  belongs_to :space
  belongs_to_space(:space)
  has_many :links, :class_name => 'Links::Link'

  validates_presence_of :name
end 
```

**spec_helper.rb**

```
require File.expand_path('../../config/environment', __FILE__)
require 'rubygems'
require 'rails/all'
require 'rspec/rails'
require 'factory_girl'

system "#{Rails.root.to_s}/db/test.db"

ENV['RAILS_ENV'] ||= 'test'

load_schema = lambda {
  load "#{Rails.root.to_s}/db/schema.rb" # use db agnostic schema by default
                                         # ActiveRecord::Migrator.up('db/migrate') # use migrations
}
silence_stream(STDOUT, &load_schema)

Dir[Rails.root.join('spec/support/**/*.rb')].each { |f| require f }

RSpec.configure do |config|
  config.include FactoryGirl::Syntax::Methods

  config.mock_with :rspec
  config.fixture_path = "#{Rails.root}/spec/fixtures"
  config.use_transactional_fixtures = true

  ActiveSupport::Dependencies.clear
end 
```

**导致错误的最简单 category_spec.rb*：

```
require 'spec_helper'

describe Links::Category do
  pending "add some examples to (or delete) #{__FILE__}"
end 
```

**耙执行**：

```
➜  lexim git:(deveop) ✗ RAILS_ENV=test be rake spec --trace
** Invoke spec (first_time)
** Invoke db:test:prepare (first_time)
** Invoke db:abort_if_pending_migrations (first_time)
** Invoke environment (first_time)
** Execute environment
Agent is configured to send raw SQL to the service
Agent is configured to send raw SQL to the service
DEPRECATION WARNING: Passing :tag, :class and others to use is deprecated. Please invoke b.use :input, :wrap_with => {:class=>"span4"} instead. (called from block (2 levels) in <top (required)> at /Users/shimms/Development/lexim/config/initializers/simple_form.rb:47)
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:abort_if_pending_migrations
** Execute db:test:prepare
** Invoke db:test:load (first_time)
** Invoke db:test:purge (first_time)
** Invoke environment
** Invoke db:load_config
** Execute db:test:purge
** Execute db:test:load
** Invoke db:test:load_schema (first_time)
** Invoke db:test:purge
** Execute db:test:load_schema
** Invoke db:schema:load (first_time)
** Invoke environment
** Invoke db:load_config
** Execute db:schema:load
** Execute spec
/Users/shimms/.rvm/rubies/ruby-1.9.3-p125/bin/ruby -S rspec ./spec/product_features_spec.rb ./spec/controllers/lexim/logo_controller_spec.rb ./spec/mailers/enterprise_enquiry_mailer_spec.rb ./spec/mailers/new_account_mailer_spec.rb ./spec/mailers/user_mailer_spec.rb ./spec/models/account_boltons_spec.rb ./spec/models/account_spec.rb ./spec/models/account_status_spec.rb ./spec/models/address_spec.rb ./spec/models/admin/import_spec.rb ./spec/models/admin_user_spec.rb ./spec/models/assignment_materials_spec.rb ./spec/models/assignment_submission_rubric_selection_spec.rb ./spec/models/assignments/submission_files_spec.rb ./spec/models/assignments/submission_spec.rb ./spec/models/bolton_screenshot_spec.rb ./spec/models/bolton_spec.rb ./spec/models/bolton_status_spec.rb ./spec/models/calendar/entry_spec.rb ./spec/models/calendar/event_sharing_spec.rb ./spec/models/calendar_spec.rb ./spec/models/cancellation_reason_spec.rb ./spec/models/charge_spec.rb ./spec/models/client_application_spec.rb ./spec/models/common_cartridge/export_spec.rb ./spec/models/credit_card_spec.rb ./spec/models/discussions/reply_spec.rb ./spec/models/discussions/tag_spec.rb ./spec/models/education_domain_name_spec.rb ./spec/models/email_address_validation_spec.rb ./spec/models/gradebook/column_spec.rb ./spec/models/gradebook/value_spec.rb ./spec/models/gradebook_column_type_spec.rb ./spec/models/importer/user_spec.rb ./spec/models/invitation_spec.rb ./spec/models/invoice_spec.rb ./spec/models/links/category_spec.rb ./spec/models/links/link_spec.rb ./spec/models/mailing_list_spec.rb ./spec/models/material_item_spec.rb ./spec/models/materials/folder_spec.rb ./spec/models/materials/page_details_spec.rb ./spec/models/materials/page_spec.rb ./spec/models/materials/youtube_details_spec.rb ./spec/models/mobile_phone_country_carrier_spec.rb ./spec/models/mobile_phone_country_spec.rb ./spec/models/net_promoter_score_spec.rb ./spec/models/network_spec.rb ./spec/models/notification_channel_spec.rb ./spec/models/notification_event_spec.rb ./spec/models/notification_spec.rb ./spec/models/open_graph_object_authorization_spec.rb ./spec/models/plan_pool_spec.rb ./spec/models/plan_spec.rb ./spec/models/privacy_setting_spec.rb ./spec/models/product_bolton_spec.rb ./spec/models/product_spec.rb ./spec/models/quiz_spec.rb ./spec/models/quizzes/question_option_spec.rb ./spec/models/quizzes/question_spec.rb ./spec/models/quizzes/question_type_spec.rb ./spec/models/quizzes/submission_answer_option_spec.rb ./spec/models/quizzes/submission_answer_spec.rb ./spec/models/quizzes/submission_spec.rb ./spec/models/referrer_campaign_spec.rb ./spec/models/registration_spec.rb ./spec/models/rubric_spec.rb ./spec/models/rubrics/criterion_spec.rb ./spec/models/rubrics/descriptor_spec.rb ./spec/models/rubrics/level_spec.rb ./spec/models/sanitized_text_spec.rb ./spec/models/scheduled_mail_spec.rb ./spec/models/space_spec.rb ./spec/models/subscription_spec.rb ./spec/models/subscription_status_spec.rb ./spec/models/system_announcement_spec.rb ./spec/models/system_announcement_views_spec.rb ./spec/models/tip_spec.rb ./spec/models/tour_activity_spec.rb ./spec/models/unauthorized_access_spec.rb ./spec/models/unavailable_feature_request_spec.rb ./spec/models/user_activity_spec.rb ./spec/models/user_authentication_tokens_spec.rb ./spec/models/user_creation_type_spec.rb ./spec/models/user_notification_spec.rb ./spec/models/user_spec.rb ./spec/models/wall_post_likes_spec.rb ./spec/models/wallpost_spec.rb
Agent is configured to send raw SQL to the service
Agent is configured to send raw SQL to the service
DEPRECATION WARNING: Passing :tag, :class and others to use is deprecated. Please invoke b.use :input, :wrap_with => {:class=>"span4"} instead. (called from block (2 levels) in <top (required)> at /Users/shimms/Development/lexim/config/initializers/simple_form.rb:47)
DEPRECATION WARNING: ActiveAdmin::Dashboard is deprecated and will be removed in the next version
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:503:in `load_missing_constant': Expected /Users/shimms/Development/lexim/app/models/links/category.rb to define Links::Category (LoadError)
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:192:in `block in const_missing'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `each'
from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `const_missing'
    from /Users/shimms/Development/lexim/spec/models/links/category_spec.rb:4:in `<top (required)>'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `block in load'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `block in load_spec_files'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `map'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/configuration.rb:746:in `load_spec_files'
from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/command_line.rb:22:in `run'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:69:in `run'
    from /Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/runner.rb:10:in `block in autorun'
rake aborted!
/Users/shimms/.rvm/rubies/ruby-1.9.3-p125/bin/ruby -S rspec ./spec/product_features_spec.rb ./spec/controllers/lexim/logo_controller_spec.rb ./spec/mailers/enterprise_enquiry_mailer_spec.rb ./spec/mailers/new_account_mailer_spec.rb ./spec/mailers/user_mailer_spec.rb ./spec/models/account_boltons_spec.rb ./spec/models/account_spec.rb ./spec/models/account_status_spec.rb ./spec/models/address_spec.rb ./spec/models/admin/import_spec.rb ./spec/models/admin_user_spec.rb ./spec/models/assignment_materials_spec.rb ./spec/models/assignment_submission_rubric_selection_spec.rb ./spec/models/assignments/submission_files_spec.rb ./spec/models/assignments/submission_spec.rb ./spec/models/bolton_screenshot_spec.rb ./spec/models/bolton_spec.rb ./spec/models/bolton_status_spec.rb ./spec/models/calendar/entry_spec.rb ./spec/models/calendar/event_sharing_spec.rb ./spec/models/calendar_spec.rb ./spec/models/cancellation_reason_spec.rb ./spec/models/charge_spec.rb ./spec/models/client_application_spec.rb ./spec/models/common_cartridge/export_spec.rb ./spec/models/credit_card_spec.rb ./spec/models/discussions/reply_spec.rb ./spec/models/discussions/tag_spec.rb ./spec/models/education_domain_name_spec.rb ./spec/models/email_address_validation_spec.rb ./spec/models/gradebook/column_spec.rb ./spec/models/gradebook/value_spec.rb ./spec/models/gradebook_column_type_spec.rb ./spec/models/importer/user_spec.rb ./spec/models/invitation_spec.rb ./spec/models/invoice_spec.rb ./spec/models/links/category_spec.rb ./spec/models/links/link_spec.rb ./spec/models/mailing_list_spec.rb ./spec/models/material_item_spec.rb ./spec/models/materials/folder_spec.rb ./spec/models/materials/page_details_spec.rb ./spec/models/materials/page_spec.rb ./spec/models/materials/youtube_details_spec.rb ./spec/models/mobile_phone_country_carrier_spec.rb ./spec/models/mobile_phone_country_spec.rb ./spec/models/net_promoter_score_spec.rb ./spec/models/network_spec.rb ./spec/models/notification_channel_spec.rb ./spec/models/notification_event_spec.rb ./spec/models/notification_spec.rb ./spec/models/open_graph_object_authorization_spec.rb ./spec/models/plan_pool_spec.rb ./spec/models/plan_spec.rb ./spec/models/privacy_setting_spec.rb ./spec/models/product_bolton_spec.rb ./spec/models/product_spec.rb ./spec/models/quiz_spec.rb ./spec/models/quizzes/question_option_spec.rb ./spec/models/quizzes/question_spec.rb ./spec/models/quizzes/question_type_spec.rb ./spec/models/quizzes/submission_answer_option_spec.rb ./spec/models/quizzes/submission_answer_spec.rb ./spec/models/quizzes/submission_spec.rb ./spec/models/referrer_campaign_spec.rb ./spec/models/registration_spec.rb ./spec/models/rubric_spec.rb ./spec/models/rubrics/criterion_spec.rb ./spec/models/rubrics/descriptor_spec.rb ./spec/models/rubrics/level_spec.rb ./spec/models/sanitized_text_spec.rb ./spec/models/scheduled_mail_spec.rb ./spec/models/space_spec.rb ./spec/models/subscription_spec.rb ./spec/models/subscription_status_spec.rb ./spec/models/system_announcement_spec.rb ./spec/models/system_announcement_views_spec.rb ./spec/models/tip_spec.rb ./spec/models/tour_activity_spec.rb ./spec/models/unauthorized_access_spec.rb ./spec/models/unavailable_feature_request_spec.rb ./spec/models/user_activity_spec.rb ./spec/models/user_authentication_tokens_spec.rb ./spec/models/user_creation_type_spec.rb ./spec/models/user_notification_spec.rb ./spec/models/user_spec.rb ./spec/models/wall_post_likes_spec.rb ./spec/models/wallpost_spec.rb failed
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/rake_task.rb:137:in `block (2 levels) in initialize'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:60:in `verbose'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rspec-core-2.10.1/lib/rspec/core/rake_task.rb:127:in `block in initialize'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/Users/shimms/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/bin/rake:23:in `load'
/Users/shimms/.rvm/gems/ruby-1.9.3-p125@lexim/bin/rake:23:in `<main>'
Tasks: TOP => spec 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T07:58:47.287

当您在规范中编写 Links::Category 时，Rails 可能会自动加载`Links`模块和`Links::Category`类。

显然，如果您没有正确定义`Links`模块，可能会发生这种奇怪的错误。有关我们如何调试它的更多详细信息，请参阅上面的评论。

# linux - 无法理解简单的 shell 脚本

> ID：13352321
> 
> 赞同：9
> 
> 时间：2012-11-12T22:02:17.010
> 
> 标签：linux, debugging, shell, gcc

我已经很久没有使用过 shell 脚本了。我在网上搜索了帮助，但没有找到足够的指南..

这是我试图理解的代码：

```
#!/bin/sh
# -*-sh-*-
if gcc $1 &> cmp_out; then
    if ! ./a.out &> run_out; then
        exit 0;                 # Success.
    fi
fi
exit 1;                         # Failure. 
```

cmp_out 和 run_out 是什么？这些是标准输出吗？

我知道 &> 是一个重定向指令。但我一点也不明白这个脚本语法中的含义。

我正在寻找这个脚本正在做什么的高级概述。如果您需要有关我为什么使用此脚本的更多信息，请告诉我。我将包括更多关于原因的信息。

简而言之，它是一个包含增量调试的示例 (//www.st.cs.uni-saarland.de/dd/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T03:24:06.660

该脚本采用一个参数，即源文件的名称。它编译该源文件，`gcc`如果编译成功，则执行结果。（默认情况下，`gcc`将可执行文件写入名为`a.out`.）的文件。）

如果编译失败，你很幸运，因为脚本将输出（标准输出和标准错误）保存到一个名为`cmp_out`. 如果执行结果产生任何输出，它会将其保存在`run_out`. 脚本本身不会向 stderr 或 stdout 写入任何内容。即使`gcc`未找到，该错误也会以`cmp_out`.

该脚本最奇怪的是它反转了执行的退出状态，使用`if`. 如果执行`a.out`失败，脚本以 0 退出，成功。如果`a.out`成功，则脚本以 1, failure 退出，这也是编译失败时执行的操作。也许感叹号是一个错误？整数后的分号是不必要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T22:06:41.517

`>`将前面命令的标准输出重定向到一个命名文件。 `&>`重定向标准输出和标准错误。

`cmp_out`将从编译器接收标准输出和标准错误输出的文件名也是 如此。从（可能是命令构建的二进制文件）`run_out`接收标准输出和标准错误。`a.out``gcc`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-03T01:36:08.147

程序中还有一个错误，因为“&>”的简写语法是 bash 的东西，在常规的 sh shell 中不起作用。第一行应该是“#!/bin/bash”。

# python - Python RegEx 匹配多行子字符串，但不会替换它

> ID：13352322
> 
> 赞同：2
> 
> 时间：2012-11-12T22:02:20.977
> 
> 标签：python, regex

这似乎是一个简单的问题，但显然我缺少一些东西。

我有一个 Python 函数，旨在用 HTML 格式的代码替换自定义标记之间出现的代码块：

```
def subCode(text):
    tags = re.findall('<<<mytag>>>.+?<<</mytag>>>', text, re.S)
    for tag in tags:
        match = re.search('>>>(.+?)<<<', tag, re.S)
        replaced_code = replaceCode(match.group(1))
        text = re.sub(tag, replaced_code, text, re.S|re.M)
    return text 
```

这将匹配标签之间的代码，如下所示：

```
this is some 
random text
<<<mytag>>>now this
   is some
   random code<<</mytag>>>
and this is text again 
```

但它不是用格式化的替换替换代码，返回的字符串与输入相同。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:23:38.410

我认为您想使用将`re.sub()`函数作为第二个参数的变体，它要简单得多：

```
def subCode(text):
    return re.sub('<<<mytag>>>(.+?)<<</mytag>>>', replaceFunc, text, flags=re.S)

def replaceFunc(match):
    return replaceCode(match.group(1)) 
```

如果 to 的第二个参数`re.sub()`是一个函数，它将一个匹配对象作为输入，并期望返回替换字符串。

# php - Zend框架确保数据已成功插入mysql

> ID：13352325
> 
> 赞同：0
> 
> 时间：2012-11-12T22:02:47.607
> 
> 标签：php, zend-framework

所以通常你会这样做`mysql_affected_rows()`，但你如何在 ZF 中做到这一点？这是我的模块片段：

```
/**
 *
 * Inserts new user to the dabase
 * @return string|bool
 */
public function addUser($data)
{
    $newUser = $this->insert($data);
    if( $newUser ){
        return $newUser;
    }else{
        return false;
    }
} 
```

我认为 If 语句不起作用，还是我错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:05:37.413

我认为如果成功它会返回 true，否则它会抛出异常，此线程上的以下信息是正确的[http://zend-framework-community.634137.n4.nabble.com/How-to-test-the-success -of-Db-Table-insert-td674869.html](http://zend-framework-community.634137.n4.nabble.com/How-to-test-the-success-of-Db-Table-insert-td674869.html)。尝试模拟异常，必填字段为空或smth ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:17:33.350

洛克在这里[http://framework.zend.com/manual/1.12/en/zend.db.adapter.html#zend.db.adapter.write.lastinsertid](http://framework.zend.com/manual/1.12/en/zend.db.adapter.html#zend.db.adapter.write.lastinsertid)

Zend insert 方法返回受影响的行数（通常为 1）。

# ajax - 角度请求中断

> ID：13352327
> 
> 赞同：0
> 
> 时间：2012-11-12T22:03:01.117
> 
> 标签：ajax, json, angularjs

为什么 Angular 会在需要时返回请求数据，而大多数时候根本不会。当我测试时，在我的本地机器上运行 web 服务器运行良好，部署到服务器后停止工作。

```
$scope.request = $resource('/FooData/getData', {
            ajaxCall: true,
            callback: 'JSON_CALLBACK'
        }, {
            get: {
                isArray: true
            }
        }); 
```

Fiddler 说请求 url 没有任何问题，当您从浏览器的地址栏中手动发送相同的查询时 - 它可以工作并返回 JSON，尽管当它从 javascript 调用时它会进行调用，但不会返回任何结果（你可以看到它在 Chrome 控制台的网络选项卡中）。有时虽然它得到了结果，但我注意到这只发生在应用程序的第一次运行时。之后，无论您刷新页面多少次，它都不会获取任何数据。

这不是跨域调用，但即使我设置`method:'JSONP'`了仍然不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:57:06.603

不确定您的项目中发生了什么。但这里是工作 plunker：[http ://plnkr.co/edit/ClUYpH](http://plnkr.co/edit/ClUYpH)

`get`即使是第二次通话，它似乎也能正常工作。

我注意到的一件事是您需要`method = 'GET'`在您的操作属性中指定，否则方法将变为`undefined`.

# php - 在 PHP 和 MySQL 中使用日期查询

> ID：13352329
> 
> 赞同：1
> 
> 时间：2012-11-12T22:03:06.447
> 
> 标签：php, mysql

我正在编写一个脚本，该脚本将使用 PHP 和 MySQL 显示员工日程安排。我正在使用 php 5.3.13 和 MySQL 5.5.24

我要做的是填充一个表格，该表格将包含日期和工作人员开始时间（如果状态为 ACTV），或者如果工作人员处于休假或休假状态则显示状态。

代码如下：

```
<body>
<center>
<?php
include "../../scripts/php/dbcon/dbcon.php";
$schedule_table = "cc_schedule";

$date_query="SELECT DISTINCT DATE(schedule_date) FROM `$schedule_table`";
$date_result= mysql_query($date_query);
$datenum = mysql_numrows($date_result);

?>

<!-- Table Head -->

<center>
<table cellpadding="0" cellspacing="0">
    <tr>
        <th><center>No.</center></th>
        <th><center>Name</center></th>
        <th><center>Employee ID</center></th>
        <?php
        $d =0;
        while ($d < $datenum){

        $dt = mysql_result($date_result,$d,"DATE(schedule_date)");
        $date = date_create($dt);
        $dd = $date;

        echo "<th><center>". date_format($dd, 'd-M-Y')."</th><center>";
        $d++;
        }
?>  
    </tr>

<!-- Table Body -->

<?php

$names_query="SELECT StaffName, ID 
                from users 
                WHERE groupname = 'call center'";

$name_result = mysql_query($names_query);
$namenum = mysql_numrows($name_result);

$schedule_query="SELECT * 
                FROM `$schedule_table` 
                ORDER BY `schedule_date` ASC,`sstatus` ASC,`start_time` ASC,`employee_id` ASC";

$schedule_result=mysql_query($schedule_query);
$schedule_num = mysql_numrows($schedule_result);

$n = 1;
while ($n < $namenum){
    ?>
    <tr>
    <?php
    echo"<td><center>".($n)."</td></center>";
    echo"<td><center>".mysql_result($name_result,$n,"StaffName")."</td></center>";
    echo"<td><center>".mysql_result($name_result,$n,"ID")."</td></center>";

    $d=1;
    {
        $emp_id = mysql_result($name_result,$n,"ID");
        $dt = mysql_result($date_result,$d,"DATE(schedule_date)");
        $date = date_create($dt);
        $dd = date_format($date, 'Y-m-d');

        echo $emp_id;
        echo DATE($dd);

        while ($d < $datenum) {
            $schedule_query ="SELECT *  
                            from $schedule_table 
                            WHERE `employee_id` = $emp_id AND `schedule_date`='$dd'";
            $schedule_result = mysql_query($schedule_query);
            $schedule = mysql_result($schedule_result,0,"start_time");
            $status = mysql_result($schedule_result,0,"sstatus");

                if ($status =="ACTV"){
                '<td class="'.$status.'"><center>'.$schedule.'</td></center>';
                }
                else {
                echo '<td class="'.$status.'"><center>'.$status."</td></center>";
                }
                }

    $d++;       
    }

    ?>
    </tr>
<?php
$n++;
}
?>
</table>
</center>
</body> 
```

该代码不返回任何内容。它每次运行时都会返回不同的错误。我怀疑查询有问题。我就是想不通。。

任何帮助表示赞赏。

谢谢你。

穆罕默德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:38:08.393

Jeremy Smyth、Geek Num 88 和 awenkhh

感谢您的意见。

我切换到 PDO 并获得了我想要的结果。

解决上述问题的新代码是：

```
<body>
<center>
<?php
include "../../scripts/php/dbcon/dbcon.php";
$schedule_table = "cc_schedule";
$dates= $db->query("SELECT DISTINCT DATE(schedule_date) FROM `$schedule_table`");
$dates_num = $dates->rowCount();
$ids = $db->query("SELECT DISTINCT employee_id FROM `$schedule_table` ORDER BY `employee_id`");
$staffcount = $ids->rowCount();
$records = $db->query("SELECT * FROM `$schedule_table`");
$record_num = $records->rowCount();
?>
<center>
<!--- Table Head -->

    <table cellpadding="0" cellspacing="0">
        <tr>
            <th><center>No.</center></th>
            <th><center>Employee Name</center></th>
            <th><center>Employee ID</center></th>
            <?php
                while($row = $dates->fetch()) {
            {
                $d =  $row['DATE(schedule_date)'];
            }
            ?>
                <th><center><?php echo date_format(date_create($d), 'd-M-Y'); ?></center></th>
            <?php
            }
            ?>
        </tr>

    <?php
        $i=1;
        while($row = $ids->fetch()){

            $employee_id =  $row['employee_id'];

                    $equery = $db->query("SELECT StaffName FROM users where ID=$employee_id");
                    while($row = $equery->fetch(PDO::FETCH_ASSOC)) {
                    $empname =  $row['StaffName'];
                    }

    ?>
<!--- Table Body --->

                    <tr class="class<?php echo ($i%2); ?>">
                        <td  width="20"><font face="Arial, Helvetica, sans-serif" size="1"><b><?php echo $i ; ?></b></font></td>
                        <td  width="200"><font face="Arial, Helvetica, sans-serif" size="1"><?php echo $empname ; ?></font></td>
                        <td  width="80"><font face="Arial, Helvetica, sans-serif" size="1"><center><?php echo $employee_id; ?></center></font></td>

                        <?PHP
                        $sschedule = $db-> query("SELECT start_time, sstatus FROM $schedule_table WHERE employee_id =$employee_id");

                        while($row = $sschedule->fetch()) {
                        {
                            $sstatus =  $row['sstatus'];
                            $start_time =  $row['start_time'];

                            if ($sstatus=="ACTV"){
                            $staffSchdule = date_format(date_create($start_time), 'h:i');
                            }
                            else{
                            $staffSchdule = $sstatus;
                            }

                        }
                            ?>
                            <td  width="20" class="<?php echo $staffSchdule; ?>"><font face="Arial, Helvetica, sans-serif" size="1"><center><?php echo $staffSchdule; ?></center></font></td>
                        <?php

                    }

                $i++;
                }
                    ?> 
                </tr>
<td colspan="<?php echo $dates_num + 3 ?>"><font face="Arial, Helvetica, sans-serif" size="1"><b><i>Found a total of <?php echo $record_num; ?> records matching your criteria.</i></b></font></td>
</tr>
    </table>
</center>
</body> 
```

最终结果是一个适当的时间表： ![在此处输入图像描述](../Images/4f448a8d705c72edfb62989de2b9d1f7.png)

谢谢你。

# php - 使用 php/curl 登录具有 csrf 保护的站点

> ID：13352330
> 
> 赞同：0
> 
> 时间：2012-11-12T22:03:11.690
> 
> 标签：php, curl, csrf

我正在尝试使用我自己的凭据（而不是试图劫持会话）登录到一个使用 csrf 保护的站点。我有一些用python编写的代码来扫描页面，提取csrf字符串并将其与用户名和密码一起发送，以便能够访问受限页面。我尝试在 php/curl 中搜索类似的东西，但找不到任何东西。

到目前为止，所有谷歌搜索都只为我提供了有关如何将 csrf 保护集成到您的登录页面的链接，而不是如何登录到使用它的站点的链接。

如果有人能指出我正确的方向或一些基本的代码让我开始，那就太好了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:11:12.477

我不认为这是一个很好的问题，因为你没有展示你的研究。但是为了让你制定一个计划：

1.  获取带有令牌的页面（使用 curl 并确保启用 cookiejar）
2.  提取令牌（使用explode或preg_？）
3.  使用您的凭据和使用 curl 的“撕裂”令牌发布到页面
4.  完毕 ？

当您的代码准备好但无法正常工作时，请发布另一个问题，我们愿意全心全意地提供帮助 :-)

# python - 使用 Python&HTML 单击按钮时如何在网页上显示“请稍候....”

> ID：13352332
> 
> 赞同：0
> 
> 时间：2012-11-12T22:03:14.940
> 
> 标签：python, html, web-applications, textbox, reload

当我单击 ON 按钮直到 guvcview 打开时，我需要显示文本“请稍候.....”，然后显示“guvcview 正在运行”。当我关闭 guvcview 时，同样的事情？在下面的 python代码，我试图显示“请稍候.....”，但我做不到。有人说需要重新加载页面。这只是示例，在我的代码中，我对页面登录和注销进行了身份验证。我需要最简单的方法，谢谢。

```
import cherrypy
import os.path
import struct
import time
import subprocess
import commands

class Server(object):
    led_on=1 
    led_off=1 
    def index(self,  on='', off=''):
        html = """
         <html>
           <body>
             <br>
             <p>{htmlText}
             <p>
             <a href="?on=1"><img src="images/on.png"></a>
             <a href="?off=1"><img src="images/off.png"></a>
           </body>
          </html>
                """
        myText = ''
        if on:
            self.led_on = int(on)             
            myText = "Please wait ....."
            html.format(htmlText=myText)
            subprocess.call(['guvcview &'], shell=True)
            time.sleep(2)
            output = commands.getoutput('ps -A')
            if 'guvcview' in output:
                myText = "guvcview is running"

        if off:
            self.led_off = int(off)             
            myText = "Please wait ....."
            html.format(htmlText=myText)
            subprocess.call(['sudo pkill guvcview'], shell=True)
            time.sleep(2)
            output = commands.getoutput('ps -A')
            if 'guvcview' in output:
                myText = "Please wait ....."
            else:
                myText = "guvcview closed"

        return html.format(htmlText=myText)
    index.exposed = True
conf = {
        'global' : { 
            'server.socket_host': '0.0.0.0', 
            'server.socket_port': 8085 
        },

        '/images': {
            'tools.staticdir.on': True,
            'tools.staticdir.dir': os.path.abspath('images')
        }
    }
cherrypy.quickstart(Server(), config=conf) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:03:54.460

就像其他人建议的那样，您将需要客户端脚本才能使其正常工作。但是，如果您实施 ajax 解决方案，则不需要重定向到另一个页面。试试这个，看看这是否是你所追求的。

```
import cherrypy
import os.path
import struct
import time
import subprocess
import commands

class Server(object):
    led_on=1 
    led_off=1 
    def index(self):
        html = """
         <html>
           <body>
           <script language="javascript" type="text/javascript">
           function Activate(CurrentState)
           {
               // code for IE7+, Firefox, Chrome, Opera, Safari
               if(window.XMLHttpRequest)
                   xmlhttp=new XMLHttpRequest();
               else// code for IE6, IE5
                   xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

               xmlhttp.onreadystatechange=function()
               {
                   if (xmlhttp.readyState==4 && xmlhttp.status==200)
                   {
                       document.getElementById("UserMessage").innerHTML = xmlhttp.responseText;
                   }
               }

               xmlhttp.open("GET","/Process?on=" + CurrentState, true);
               xmlhttp.send();
           }
           </script>
             <br>
             <p id="UserMessage"><p>
             <a onclick="document.getElementById('UserMessage').innerHTML = 'Please wait .....';Activate('1');"><img src="images/on.png"></a>
             <a onclick="document.getElementById('UserMessage').innerHTML = 'Please wait .....';Activate('0');"><img src="images/off.png"></a>
           </body>
          </html>
                """
        return html
    index.exposed = True

    def Process(self,  on='0'):
        if on == '1':
            self.led_on = int(on)             
            subprocess.call(['guvcview &'], shell=True)
            time.sleep(2)
            output = commands.getoutput('ps -A')
            if 'guvcview' in output:
                return "guvcview is running"

        if on == '0':
            self.led_off = int(on)
            subprocess.call(['sudo pkill guvcview'], shell=True)
            time.sleep(2)
            output = commands.getoutput('ps -A')
            if 'guvcview' in output:
                return "Please wait ....."
            else:
                return "guvcview closed"

        return "Please wait ....."
    Process.exposed = True

conf = {
        'global' : { 
            'server.socket_host': '0.0.0.0', 
            'server.socket_port': 8085 
        },

        '/images': {
            'tools.staticdir.on': True,
            'tools.staticdir.dir': os.path.abspath('images')
        }
    }
cherrypy.quickstart(Server(), config=conf) 
```

希望这可以帮助！

安德鲁

# java - 无法为 Eclipse 项目创建可运行的 jar

> ID：13352333
> 
> 赞同：1
> 
> 时间：2012-11-12T22:03:24.440
> 
> 标签：java, eclipse, shell, terminal, executable-jar

我在 Eclipse 中创建了小型 Java 应用程序。当我从 IDE 创建可运行的 jar 时，一切正常。但不知何故，我无法通过终端创建它（仅供参考，我使用的是 Mac）。

以下是我的项目目录结构

```
./bin (Contains all compiled classes)
./lib (Contains all the third party lib I am using lib1.jar,lib2.jr, lib3.jar)
./src (Contains my java class = myProject.java)
manifest.txt (Contains 2 line, first line is Main-Class:myProject and second line is empty) 
```

以下是我用于编译类的命令

```
javac -d bin -sourcepath src -cp lib/lib1.jar:lib/lib2.jar:lib/lib3.jar src/myProject.java 
```

要创建 jar 文件，我使用以下命令

```
jar cvfm myProject.jar manifest.txt bin/*.class lib/*.jar 
```

当我运行此命令时，我得到无效的标题字段。以下是完整的错误消息。

```
java.io.IOException: invalid header field
    at java.util.jar.Attributes.read(Attributes.java:393)
    at java.util.jar.Manifest.read(Manifest.java:180)
    at java.util.jar.Manifest.<init>(Manifest.java:50)
    at sun.tools.jar.Main.run(Main.java:149)
    at sun.tools.jar.Main.main(Main.java:1147) 
```

我不确定我哪里出错了。谁能指出我犯了什么错误，或者我是否需要更多的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:12:05.933

[JAR 文件规范](http://docs.oracle.com/javase/7/docs/technotes/guides/jar/jar.html)在这里可以提供帮助。

我认为“无效标头字段”消息背后的问题是标头字段的值必须以空格开头；尝试`manifest.txt`包含

```
Main-Class: myProject 
```

反而。

至于访问文件中的类`lib/*.jar`，Java 不会在 jar 文件中找到 jar 文件中的类——您实际上可以跳过`lib/*.jar`在`jar`命令行中指定。

这里有两种可能性：

*   添加

    ```
    Class-Path: lib/lib1.jar lib/lib2.jar lib/lib3.jar 
    ```

    到`manifest.txt`. 这样做的缺点是，如果您分发 jar 并且库 jar 不在正确的相对路径中，则会出现 ClassNotFoundError。

*   将里面的所有`.class`文件解压缩`lib/*.jar`到一个临时目录中，并将它们添加到`myProject.jar`. 这样做的好处是罐子是完全独立的；缺点是它是一个更大的文件，更复杂，需要更多的时间来创建。您可以按照以下方式使用 shell 脚本：

    ```
    mkdir lib/expanded
    cd lib/expanded
    for J in ../*.jar; do
        unzip "${J}"
        rm -rf META-INF
    done
    zip -R ../../myProject.jar *
    cd .. && rm -rf expanded 
    ```

    `META-INF`每个文件解压后都会删除该目录`lib/*.jar`，这样`unzip`就不会询问是否覆盖，也不会覆盖`myProject.jar`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:15:53.053

阅读 jar 文件，我想你可以尝试这样的事情：

`jar cvmfe manifest.txt myProjecy.jar myProject bin/*.class lib/*.jar`

`myProject`您的条目类名称在哪里。如果这不起作用，请尝试完全删除该`-m`选项`manifest.txt`，我猜该`-e`选项无论如何都应该采用 MainClass 条目。

# c# - ASP.NET MVC 2 异步操作和反向 Ajax

> ID：13352339
> 
> 赞同：0
> 
> 时间：2012-11-12T22:03:56.550
> 
> 标签：c#, jquery, asp.net-mvc-2

我正在使用 ASP.NET MVC 2 和 .NET 框架 3.5。我的视图中有一个数据表，单击按钮，我在服务器端逐行处理表中的所有信息。每行操作都需要一些时间才能完成。

所以我想在处理完每一行后更新视图，比如将每一行的状态设置为待处理、进行中或完成。

我尝试使用任务并行库来处理长时间运行的进程并在处理每一行后更新会话。然后长轮询另一个 Action 方法并定期检索会话数据。如下图所示。

但我无法在此处更新会话。

```
public ActionResult ProcessData()
    {
        ModelData model = HttpContext.Session["ModelData "] as ModelData ;

        Task.Factory.StartNew(() =>
        {
            foreach (Info item in model.DataInfo)
            {
                ProcessRow(item);
                Session["ModelData"] = model;
            }
        });

        return View(model);
    }

 public ActionResult GetLatestModel()
        {
            ModelData model = HttpContext.Session["ModelData"] as ModelData;
            return View(model);
        }

<script type="text/javascript">
    $(document).ready(function() {
        $("#btnSubmit").live("click", function() {
            $.ajax({
                url: '<%= Url.Content( "~/Process/ProcessData" ) %>',
                success: function() {
                    setInterval(UpdateView, 5000);
                }
            });
        });
    });

    function UpdateView() {
        $.ajax({
            url: '<%= Url.Content( "~/Process/GetLatestModel" ) %>'
        });
    }
</script> 
```

我不确定如何继续进行。任何建议将不胜感激。谢谢。

# encoding - 程序实际上是如何接收字符输入的？从扫描码到最终的原始输入位

> ID：13352340
> 
> 赞同：1
> 
> 时间：2012-11-12T22:03:56.950
> 
> 标签：encoding, character-encoding, scancodes, low-level-io

所以，我的问题很简单：在用户“输入”（从物理键盘或任何其他方式）字符键之后，程序如何接收原始输入位？

我的意思是我知道字符编码在程序将其作为原始位接收*后*如何工作，但我不清楚该位序列最初是如何出现的。

我一直在阅读一些内容，但结果证明这对我的 Google-fu 来说是一个艰难的搜索。似乎操作系统从输入设备（通常是键盘）接收扫描代码，使用字符映射和键盘布局将其映射到编码，然后将生成的位序列传递给程序。我对吗？如果是这样，对我来说唯一缺少的部分是：

1.  键盘布局如何定义扫描码对应的字符？使用 Unicode 代码点？操作系统特定的内部表？

2.  其次，程序是否在编译时定义了它期望输入（来自操作系统）的字符编码？有吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:22:24.307

作为汇编课程的一部分，有一个非常好的关于如何从键盘读取的低级描述。它涵盖了从按键到 CPU 的整个管道。[你可以在这里](http://flint.cs.yale.edu/cs422/doc/art-of-asm/pdf/)找到整个课程和关于键盘输入的章节[在这里](http://flint.cs.yale.edu/cs422/doc/art-of-asm/pdf/CH20.PDF)。

# php - 使用 cookie 动态排序表

> ID：13352341
> 
> 赞同：0
> 
> 时间：2012-11-12T22:04:03.307
> 
> 标签：php, javascript, jquery, mysql, ajax

我正在尝试使用 javaScript (jquery) / PHP 和 coockies 对表进行动态排序。

mi代码是这样的：

```
 <script type="text/javascript" src="jquery-1.8.2.js"></script>
    <script type="text/javascript">

        function setCookie(c_name,value,exdays) {
            var exdate=new Date();
            exdate.setDate(exdate.getDate() + exdays);
            var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
            document.cookie=c_name + "=" + c_value;
        }

        function getCookie(c_name) {
            var i,x,y,ARRcookies=document.cookie.split(";");
            for (i=0;i<ARRcookies.length;i++) {
                x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
                y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
                x=x.replace(/^\s+|\s+$/g,"");
                if (x==c_name) {
                    return unescape(y);
                }
            }
        }

        $(document).ready(function(){

            $("a").toggle(function(){
                setCookie("orden","ASC",100);
            }, function() {
                setCookie("orden","DESC",100);
            });

            $("a").click(function(){
                setCookie("campo",$(this).html(),100);

                $.ajax({
                    type: "POST",
                    url: "ordenaTabla.php",
                    //data: ,
                    success:function(data) {
                        //alert(data);
                    }
                });

            });

        });
    </script>
</head>
<body>
    <div id="tabla">
        <table border="1" align="center" width="300">
            <tr>
                <td align="center"><a href="#">ID</a></td>
                <td align="center"><a href="#">nombre</a></td>
                <td align="center"><a href="#">edad</a></td>
            </tr>
            <?php
                include_once ("mySqlConexion.inc.php");

                $tabla    = "tablaPruebas";

                if(isset($_COOKIE["consulta"])){
                    $consulta = $_COOKIE["consulta"];
                    $consulta = str_replace("+", " ", $consulta);
                }
                else{
                    $consulta = "SELECT * from ".$tabla;
                }

                echo $consulta;
                echo print_r($_COOKIE);

                //En la variable resultado se mete el resultado de la ejecución de la consulta que se ejecuta gracias a la funcion mysql_query
                $resultado = mysql_query($consulta, $link);

                while($fila = mysql_fetch_array($resultado)) {
                    echo "<tr>";
                        echo "<td>".$fila["ID"]."</td>";
                        echo "<td>".$fila["nombre"]."</td>";
                        echo "<td>".$fila["edad"]."</td>";
                    echo "</tr>";
                };
            ?>
        </table>
    </div>
</body> 
```

我在使用 AJAX 调用的 php 文件上使用的代码是这样的：

```
$tabla    = "tablaPruebas";
$consulta = "SELECT+*+FROM+".$tabla."+ORDER+BY+".$_COOKIE["campo"]."+".$_COOKIE["orden"];

//I create this cookie by using the value of the other 2 cookies I already have
     $_COOKIE["consulta"] = $consulta; 
```

我想知道你能不能告诉我为什么它不起作用:(

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:24:18.510

Cookie 存储在客户端计算机上。

在客户端计算机上存储 sql 查询是个坏主意，因为客户端可以通过编辑 cookie 对数据库执行随机 sql，例如删除所有表。

您将改为使用所需排序的简写，并在 switch 控制语句中设置 order by 子句。

此外，我根本不会使用 cookie，而只是将参数中所需的顺序交给 ajax POST。

以下是一些片段：

```
//javascript
$("a").click(function(){
            var campo= "name asc";

            $.ajax({
                type: "POST",
                url: "ordenaTabla.php",
                data: {campo: campo},
                success:function(data) {
                    //alert(data);
                }
            });

});

//PHP
switch($_POST['campo']){
     case "name asc": $orderby= "ORDER BY name ASC"; break;
     default: $orderby= "";
} 
```

# javascript - 找不到 Ti.cloudpush 模块

> ID：13352342
> 
> 赞同：2
> 
> 时间：2012-11-12T22:04:11.130
> 
> 标签：javascript, android, cloud, appcelerator, titanium-mobile

嗨，我正在使用 ACS 在我的应用程序中实现推送通知。我在 tiapp.xml 中添加了 Ti.cloud 推送，如下所示。

```
 <module platform="android">ti.cloudpush</module> 
```

我正在使用此代码实现它，但它给出了找不到 Ti.cloudpush 模块的错误。

```
var HomeWin = Titanium.UI.createWindow({
    backgroundColor : '#f00'
});
var CloudPush = require('ti.cloudpush');
CloudPush.debug = true;
CloudPush.enabled = true;
CloudPush.showTrayNotificationsWhenFocused = true;
CloudPush.focusAppOnPush = false;

var deviceToken;

var Cloud = require('ti.cloud');
Cloud.debug = true;

var submit = Ti.UI.createButton({
    title : 'Register For Push Notification',
    color:'#000',
    height : 53,
    width : 200,
    top : 100,
});

HomeWin.add(submit);

submit.addEventListener('click', function(e) {
    CloudPush.retrieveDeviceToken({
       success: function deviceTokenSuccess(e) {
                    alert('Device Token: ' + e.deviceToken);
                    deviceToken = e.deviceToken
                    loginDefault();
                },
       error  : function deviceTokenError(e) {
                    alert('Failed to register for push! ' + e.error);
           }
    });
});

function loginDefault(e){
    //Create a Default User in Cloud Console, and login
    Cloud.Users.login({
        login: 'push123',
        password: 'push123'
    }, function (e) {
        if (e.success) {
            alert("login success");
            defaultSubscribe();
        } else {
              alert('Error: ' +((e.error && e.message) || JSON.stringify(e)));
        }
    });
}

function defaultSubscribe(){
    Cloud.PushNotifications.subscribe({
            channel: 'alert',
            device_token: deviceToken,
            type: 'android'
    }, function (e){
            if (e.success) {
               alert('Subscribed for Push Notification!');
            } else{
                alert('Error:' +((e.error && e.message) || JSON.stringify(e)));
            }
    });
}

CloudPush.addEventListener('callback', function (evt) {
    alert(evt);
    alert(evt.payload);
});

CloudPush.addEventListener('trayClickLaunchedApp', function (evt) {
    Ti.API.info('Tray Click Launched App (app was not running)');
    //alert('Tray Click Launched App (app was not running');
});

CloudPush.addEventListener('trayClickFocusedApp', function (evt) {
    Ti.API.info('Tray Click Focused App (app was already running)');
    //alert('Tray Click Focused App (app was already running)');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T08:22:02.147

即使我添加，我也遇到同样的问题

```
<module platform="android">ti.cloudpush</module> 
```

我删除了所有项目并使用延期包名称在钛上创建新项目现在它正在工作但我找不到我以前的代码不起作用的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T04:12:20.060

瓦哈布，

如下修改 tiapp.xml 并运行您的代码。我已经复制了你的代码，它运行良好。

```
<modules>
        <module platform="commonjs" version="2.3.0">ti.cloud</module>
        <module platform="android" version="2.0.7">ti.cloudpush</module>
</modules> 
```

# c++ - 错误 C2065：在另一个头文件中使用变量时未声明的标识符

> ID：13352343
> 
> 赞同：1
> 
> 时间：2012-11-12T22:04:11.597
> 
> 标签：c++

第一个头文件

```
 //status.h file
    static int A[2] = {1,2}; 
```

还有一个头文件

```
//anotherfile.h file
#include "status.h"

int GETID()
{
  return A[1];
} 
```

当我编译说 A 是未声明的标识符时，我不断收到错误消息。我试图将 A 定义为 extern const int ，但它仍然没有帮助。在我的 IDE (VS2010) 中，当我将鼠标悬停在 GETID() 下的 A 值上时，我实际上可以看到 A 的内容。

我想使用 A 作为全局数组，因为在我的真实程序中，A 是一个包含 250 个元素的数组，我不想在我的程序中将其声明为多个位置。在这种情况下，我该怎么做才能在另一个头文件中使用数组 A？

编辑： A 不属于 GETID() 是类函数的任何类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:12:22.413

命名空间范围`static`不是全局的 - 它是一个具有内部链接的变量 - 将为包含标题的每个翻译单元创建它的副本。您必须将其声明为`extern`并在标头中使用包含防护：

```
//status.h file
#ifndef STATUS_H
#define STATUS_H
extern int A[2];
#endif

//status.cpp
#include "status.h"
int A[2] = {1,2} 
```

无论你想在哪里使用`A`，你现在就可以了`#include "status.h"`。

请注意，这`int A[2] = {1,2,3};`是非法的，因为您说`A`只有 2 个值，但您给了它 3 个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:41:23.820

您的设置存在不止一个问题。

首先，如果事情真的像你说的那样，你就不会从你的代码中得到这个错误。您的代码，您发布它的方式，是完全可编译的，并且那里没有“未声明的标识符”问题。您实际收到此错误的原因是*循环包含*头文件。直接或间接地，您设法将其`status.h`纳入`anotherfile.h`并同时`anotherfile.h`纳入`status.h`. 循环标题包含永远不会起作用。即使您解决了全局数组的主要问题，您仍然必须摆脱循环头包含，因为它稍后会以其他方式抬头。

Secondly, if you need a truly *global* array, i.e. one array accessible to the entire program, you have to declare it with external linkage, not as `static`. `static` declaration will produce a myriad of completely independent arrays, one for each translation unit.

# c++ - 为什么 select() 总是超时？（视窗）

> ID：13352345
> 
> 赞同：0
> 
> 时间：2012-11-12T22:04:30.503
> 
> 标签：c++, c, udp, winsock, select-function

我正在使用 select 尝试等待来自网络上另一台主机的确认，但它总是返回 0。我见过其他有类似问题的线程，他们的问题总是要么他们没有重置 fd_set，要么他们没有为 select() 的第一个参数传递正确的值。这不可能是导致我的问题的原因，因为我正在重置 fd_set，并且显然，根据 msdn 的说法，第一个参数在 windows 中被忽略了。

```
while(!done)
{
    //send acknowledgment and sequence number
    sendto(_clientSocket, buff, 2, 0, (LPSOCKADDR)&_sockAddr, sizeof(SOCKADDR));

    //wait for acknowledgment
    struct timeval timeout;
    timeout.tv_sec = _rttInfo.timeout/1000;
    timeout.tv_usec = _rttInfo.timeout * 1000;

    fd_set fds;
    FD_ZERO(&fds);
    FD_SET(_clientSocket, &fds);

    //wait for client to send an acknowledgement
    //wait for the socket to be ready for reading
    int res = select(0, &fds, NULL, NULL, &timeout);
    int err = WSAGetLastError();

    if(res == 0) //if timed out, retry
    {
        timedOutCount++;
        if(timedOutCount >= MAX_TIMEOUTS)
        {
            cout << "Handshaking complete _" << endl;
            return true;
        }
        else
        {
            cout << "Acknowledgement timed out, resending sequence number and acknowledgement" << endl;
            continue;
        }
    } 
```

//下面还有更多 else if 语句，但它永远不会出现在那里

无论如何，此时它返回0。我已经看到客户端和服务器通过套接字相互发送信息，所以我认为我没有发送到客户端的错误地址。这是发送 select() 正在等待的数据包的客户端代码：

```
buff[0] = _seqNum;
res = sendto(_socket, buff, 2, 0, (LPSOCKADDR) &sa_in, sizeof(SOCKADDR)); 
```

我不可能是唯一一个遇到过这个问题的人，有人知道如何解决这个问题吗？

编辑：有人问 _sockAddr 是在哪里填写的，所以我将在此处包括：在某处实例化了一个 ClienThread 类，您可以看到传入的 sockaddr_in。

```
while(true)
{
    try
    {
        // Wait for connection
        cout << "Waiting for incoming connection... ";

        sockaddr_in clientSockAddr;
        //  int clientSockSize = sizeof(clientSockAddr);

        // Listen in on the bound socket:
        //  hClientSocket = accept(hSocket,
        //  reinterpret_cast<sockaddr*>(&clientSockAddr),
        //  &clientSockSize);
        unsigned char seqNum = 0; 

        int addrSize = sizeof(clientSockAddr);
        //wait for a connection
        int res=0;

        //loop until we get a packet that's from someone new
        bool blocking = true;

        while(blocking)
        {
            res = recvfrom(hSocket, buff, strlen(buff), 0, (LPSOCKADDR)&clientSockAddr, &addrSize);         
            bool foundMatch = false;
            //check if we're already handling this client. If so, keep blocking. Otherwise, break out of the loop
            for(list<ClientThread*>::iterator it = clientList.begin(); it != clientList.end(); it++)
            {
                //compare network addresses
                if((*it)->GetSockAddr().sin_addr.S_un.S_addr == clientSockAddr.sin_addr.S_un.S_addr)
                {
                    foundMatch = true; 
                    break;
                }
            }
            if(!foundMatch)
            {
                blocking = false;
            }
        }
        err =  WSAGetLastError();  

        // Check if we can create a new client thread
        if(res != SOCKET_ERROR && res != 0)
        {
            seqNum = (unsigned char) buff[0]; //get the sequence number for handshaking
            cout << "accepted connection from: " << GetHostDescription(clientSockAddr) << endl;
            //start a client thread, to handle requests from this client.
            ClientThread* pThread = new ClientThread(hSocket, clientSockAddr, this, seqNum);
            clientList.push_back(pThread);
            pThread->start(); 
        }
    //  if (hClientSocket==INVALID_SOCKET)
    //      throw "accept function failed.";
    }
    catch(char* ex)
    {
        cerr << "\nError: " << ex << endl;
        bSuccess = false; 
    }

} 
```

Edit2：经过进一步调试，我发现对 sendto 的调用达到了预期的目标，因为消息是通过调用 recvfrom 接收的，而不是通过 select。但是，我需要能够使用非阻塞调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:00:00.843

`sendto()`可能会失败，但您没有检查它是否有任何错误。 `sizeof(SOCKADDR)`在最后一个参数中使用是错误的。改用`sizeof(_sockAddr)`：

```
if (sendto(_clientSocket, buff, 2, 0, (LPSOCKADDR)&_sockAddr, sizeof(_sockAddr)) == SOCKET_ERROR)
{
    cout << "Handshaking failed, error " << WSAGetLastError() << endl;
    return false;
} 
```

确保您的变量`_sockAddr`是有效`sockaddr_in`的`sockaddr_in6`, 或`sockaddr_storage`, 而**不是**`sockaddr`.

在单独的说明中，假设`_rttInfo.timeout`以毫秒为单位，您的`timeout.tv_usec`值被计算错误。它应该是这样的：

```
struct timeval timeout;
timeout.tv_sec = _rttInfo.timeout / 1000;
timeout.tv_usec = (_rttInfo.timeout % 1000) * 1000; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:45:07.077

可以预见，选择超时是因为您要求超时（基于 rttInfo 包含的任何值）。如果您想等待更长的时间，请调整 rttInfo，或者如果您想等到某些事情发生，请为超时指定一个空值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:41:49.877

选择超时，因为您设置了超时。如果您想要阻止操作，您需要超时为空： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms740141 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740141(v=vs.85).aspx)

正如你所说，第一个参数似乎被忽略了。线上的东西：

```
int res = select(0, &fds, NULL, NULL, NULL); 
```

# jquery - JQueryMobile 包装 data-role="content" div

> ID：13352347
> 
> 赞同：2
> 
> 时间：2012-11-12T22:04:31.470
> 
> 标签：jquery, css, jquery-mobile

我想在`data-role="content"`元素周围显示一些静态边框。

```
<div data-role="page" id="moodle" data-add-back-btn="true">
    <div data-role="header"><h1>MyPage</h1></div>
    <div data-role="content">
        Some Content
    </div>
</div> 
```

为了实现这一点，我目前将我的页面内容包装在一堆 div 中，这些 div 通过 css 创建边框。这些 div 仅在顶部和左侧有边框。

```
$(document).bind("ready",function(){
$('div[data-role="content"]').each(function(k,v){
    $(v).wrap('<div class="b1"/>');
    $(v).wrap('<div class="b2"/>');
    $(v).wrap('<div class="b3"/>');
    $(v).wrap('<div class="b4"/>');
    $(v).wrap('<div class="content"/>');
}); 
```

问题是，当滚动内容时，顶部边框在滚动出视口/标题后面时消失。那么如何将`data-role="content"`-div “包装”到我的其他 div 中以确保在内容滚动时边框保持固定？

编辑：内容 div 左上角的示例（就在标题下方）。滚动时，此边框应保持固定： ![示例图片](../Images/c9ae8509e90d90ce310036b7a019add7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:31:45.453

您可以为内容在其后面滚动时保留在其位置上的元素添加边框。

对于这样的示例伪页面：

```
<div data-role="page">
    <div data-position="fixed" data-role="header">
        <h1>Header</h1>
    </div>
    <div data-role="content">
        <p>Content</p>
    </div>
    <div data-position="fixed" data-role="footer">
        <h2>Footer</h2>
    </div>
</div>​ 
```

可以应用这样的 CSS：

```
.ui-page .ui-header {
    box-sizing    : border-box;
    border-bottom : 4px solid red;
}
.ui-page .ui-footer {
    box-sizing : border-box;
    border-top : 4px solid red;
}
.ui-mobile .ui-page {
    box-sizing   : border-box;
    border-left  : 4px solid red !important;
    border-right : 4px solid red !important;
} 
```

它在页眉底部、页脚顶部和内容区域的左侧/右侧放置边框。

声明是为了`box-sizing : border-box;`使计算不那么复杂（它包括元素的高度/宽度尺寸内的边框/填充）。

这是一个演示：http: [//jsfiddle.net/2M5Jc/](http://jsfiddle.net/2M5Jc/)

文档`box-sizing`：[https ://developer.mozilla.org/en-US/docs/CSS/box-sizing](https://developer.mozilla.org/en-US/docs/CSS/box-sizing)

如果您不想要一个固定位置的页眉或页脚，您可以在其位置放置一个零高度和边框的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:19:02.703

您需要使#content 中的内容可滚动

[http://outof.me/native-scrolling-in-jquery-mobilephonegap-applications](http://outof.me/native-scrolling-in-jquery-mobilephonegap-applications)

这样您的边框将保持原位，但里面的内容会滚动

**更新 - 示例：**

```
<div data-role="page" id="moodle" data-add-back-btn="true">
    <div data-role="header"><h1>MyPage</h1></div>
    <div data-role="content" class="scrollable">
        Some Content
    </div>
</div>

div[data-role="content"] {
    position: absolute;
    top: 41px;
    bottom: 0;
    left: 0;
    right: 0;
}

.scrollable {
    overflow-y: scroll;
    -webkit-overflow-scrolling: touch;
}

/* iOS specific fix, don't use it on Android devices */
.scrollable > * {
    -webkit-transform: translateZ(0px);
} 
```

# cloudbees - Git 分支/标签作为参数化构建中的下拉菜单

> ID：13352352
> 
> 赞同：2
> 
> 时间：2012-11-12T22:05:06.127
> 
> 标签：cloudbees

我们有一个参数化的构建，我们希望 git 存储库的分支和/或标签在下拉列表中列出。我们发现这个插件[https://wiki.jenkins-ci.org/display/JENKINS/Git+Parameter+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Git+Parameter+Plugin)似乎可以满足我们的需求，但由于我们使用 cloudbees，我们无法对其进行测试。有人用过这个插件吗？关于如何实现这一点的任何其他想法？

我也看过这篇文章：[Dynamicly Fill Jenkins Choice Parameter With Git Branches In a Specified Repo](https://stackoverflow.com/questions/10433105/dynamically-fill-jenkins-choice-parameter-with-git-branches-in-a-specified-repo) 这可能是另一种方法，但我们无法测试它，因为它默认不在 cloudbees 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:45:32.033

Git Parameter Plugin 看起来几乎是您想要的，尽管它目前似乎只提供修订 ID 和标签，而您可能希望提供分支名称（另一种 ref）。我认为这样的改变很容易做到。

DEV@cloud Jenkins 实例中可供您使用的插件集取决于您的订阅级别。如果您需要安装特定插件，请打开支持票。

# javascript - Ajax 调用后使用 knockoutJS 绑定到 ASP 网格模板字段

> ID：13352356
> 
> 赞同：1
> 
> 时间：2012-11-12T22:05:27.740
> 
> 标签：javascript, asp.net, jquery, knockout-mapping-plugin

我正在做一个项目，我成功地通过 ajax 进行 Web 服务调用，返回数据，并将单行结果绑定到文本框。但是，在某些情况下，诸如帐户之类的字段可能具有多个值，并且在我的情况下已被索引。我可以对返回的结果进行硬编码并绑定它，但我需要动态地进行而不是硬编码，因为 Web 服务调用可能会根据提供给它的数据返回不同数量的行。这是一些代码：

```
 function RetrieveEntity() {
 var pageUrl1 = "ajaxwebservicecalls.asmx/RetrieveEntity";
    $.ajax({
        type: "POST",
        url: pageUrl1,
        data: {},
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        async: false,
        success: OnretrieveSuccessCall,
        error: onretrieveFail
    });

}
function OnretrieveSuccessCall(msg) {
    var defaultdata = msg.d.Data;
    invoiceModel = defaultdata;
    var x = JSON.stringify(defaultdata);
    MyProject.viewModel = ko.mapping.fromJS(invoiceModel);
    ko.applyBindings(MyProject.viewModel)
alert("hello");
} 
```

（无需显示 webservice asmx 文件，因为该部分工作正常）返回的结果类似于以下内容：

```
 header1.value = "abc"
  header2.value = "efg" 
```

所以当我将它绑定到文本框时，我所要做的就是调用 data-bind="value: header1.value" 并且效果很好

但是，多行结果以索引格式返回，如下所示：

```
Header1[(value1=xxx,value2=yyyy,value3=zzz),(value1=ddd,value2=fff,value3=fgghg)] 
```

所以当我对它进行数据绑定（硬编码值）时，我使用了

```
data-bind="value:header1()[0].value1" 
```

并返回“xxx”

我的问题是如果我想返回 value1 (xxx, ddd) 的所有答案并将它们绑定在网格上。我使用了一个模板字段网格，并在其中放置了一个文本框，并尝试使用它工作的硬编码索引来检索该值。但是当我想返回所有可能的值时（使用 #index 或 $data0 它不起作用。我不知道如何使用它，如果 ASP 甚至可以使用 knokcoutjs 绑定 gridview。请帮帮我. 下面是 HTMl 代码（我将只显示一个 gridview 字段，并且我正在使用有效的硬编码索引）。

```
 <asp:GridView ID="GridView2" runat="server"AllowPaging="True"AutoGenerateColumns="False">    
 <Columns>
 <asp:TemplateField HeaderText="Account" SortExpression="Account" >
  <ItemTemplate>
    <asp:TextBox ID="Account" runat="server" MaxLength="60" ReadOnly="true" 
     TabIndex="-1" Style="width: 250px" data-bind="value:APInvoiceItems()[0].Accountnumber"/>
                </ItemTemplate>
         </asp:TemplateField>
  </Columns>
    </asp:GridView>
<button onclick=" RetrieveEntity()"> Update </button> 
```

从上面的代码返回索引零处的帐号。如何返回索引1、2等？非常感谢所有帮助。先感谢您！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:21:00.287

那是不可能的。GridVew 是一个服务器控件，因此您只能在服务器上将数据绑定到它。考虑使用一些 JavaScript 模板引擎，如 jsRender、doT、Underscore 等，从服务响应创建布局。

# php - 在 joomla 中，如何将模块位置放置在类别视图覆盖中？

> ID：13352357
> 
> 赞同：3
> 
> 时间：2012-11-12T22:05:28.067
> 
> 标签：php, joomla

我正在为类别博客视图创建一个覆盖，我希望在此布局中有一个模块位置。那么，是否可以放置

```
<jdoc:include type="modules" name="modName" style="none" /> 
```

在模板/模板/html/com_content/category/blog.php 中还是我需要不同的代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-02T00:17:49.040

利用：

```
<?php
$document = JFactory::getDocument();
$renderer = $document->loadRenderer('modules');
$position = "YOURPOSITIONNAME";
$options = array('style' => 'raw');
echo $renderer->render($position, $options, null);
?> 
```

资料来源： http: [//www.jeepstone.co.uk/2012/07/26/load-module-position-in-template-override-in-joomla-2-5/](http://www.jeepstone.co.uk/2012/07/26/load-module-position-in-template-override-in-joomla-2-5/)

这篇文章是关于 Joomla 2.5 的，但我已经在 J​​oomla 的文章视图覆盖中对其进行了测试！3.3.6，它也有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-12T03:03:46.590

jdoc:include 标记在您的覆盖中不起作用。您需要的是以下代码（将 MODULEPOSITION 替换为职位名称）。

```
<?php
jimport('joomla.application.module.helper');
$modules = JModuleHelper::getModules('MODULEPOSITION'); 
foreach($modules as $module) {
    echo JModuleHelper::renderModule($module);
} 
?> 
```

要将模块发布到该位置，您只需在位置字段中徒手键入它并按 Enter，您无需在 XML 文件中指定它。

# html - 悬停在css中时背景图像不会显示

> ID：13352368
> 
> 赞同：0
> 
> 时间：2012-11-12T22:06:23.643
> 
> 标签：html, css

得到这个代码工作：

```
<style type="text/css">
        body {
            margin: 0px;
        }

        #hallo {
            width: 960px;
            height: 600px;
            position: relative;
            margin: auto;
            border: solid 1px yellow;
        }
        #bg {
            width: 960px;
            height: 600px;
            position: absolute;
            background-image:url(torres.jpg);
            background-size: 960px 600px;
        }

        #t1 {
            width: 100px;
            height: 100px;
            position: absolute; 
            background-size: 100px 100px;
            border: solid 1px white;
        }

        #t1  {
            top: 100px;
            left: 600px;
            background-image:url(torres1.jpg);
        }

        #t1:hover ~ #bg {
            position: absolute;
            background-image:url(torres1.jpg);
            background-size: 960px 600px;
        }

    </style>

<section id="hallo">

    <div id="bg"></div>
    <div id="t1"></div>

</section> 
```

但我有一个问题。当我将鼠标悬停在 t1 div 上时，没有任何反应。背景图像不会更改为“torres1.jpg”。有什么解决办法吗？

我不能为此使用java。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:09:03.000

您尚未为元素定义`:hover`状态：`#t1`

```
#t1  { /* non-hovered */
    top: 100px;
    left: 600px;
}

#t1:hover { /* hovered-over */
    background-image:url(torres1.jpg);
} 
```

针对 OP 的评论进行了编辑：

> 啊，你不明白我的问题。我正在寻找的是当将鼠标悬停在div上时要更改的`background-image`in 。`#bg``#t1`

这*不可能*发生（[还](http://dev.w3.org/csswg/selectors4/#subject)），CSS*只能*影响出现在 DOM 中的元素，该元素*晚*于您尝试为其交互设置样式的当前元素。

因此，虽然您*可以*`#t1`根据 设置样式`#bg:hover`，但*不能*`:hover`根据孩子或后来的兄弟姐妹设置父母或前兄弟姐妹的样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:17:04.117

交换`#bg`和`#t1`你的兄弟选择器应该工作：

```
<section id="hallo">
    <div id="t1"></div>
    <div id="bg"></div>
</section> 
```

# python - 熊猫重新索引仅对具有唯一值的索引对象有效

> ID：13352369
> 
> 赞同：4
> 
> 时间：2012-11-12T22:06:27.540
> 
> 标签：python, pandas

安装最新版本的 pandas 0.9.0 以防出现错误。编辑：忘了说这是 Python 2.7。试图读取 Excel 文件。那部分似乎还可以。最初，我正在为 pandas 数据帧的每一行尝试 iteritems()，因为 id_company 必须针对 mysql 数据库进行验证（不包括代码）。将其放入元组的相同/相似错误消息（代码如下）。错误信息如下。

请注意，有一个 .reindex() 但它以前也不起作用。reindex() 有点像冰雹。

作为一种解决方法，我可能会简单地从我的目标 sql 导入并进行连接。由于数据集的大小，我很担心。

```
 import pandas as pd
def runNow():
    #identify sheet
    source = 'C:\Users\jlalonde\Desktop\startup_geno\startupgenome_w_id_xl_20121109.xlsx'
    xls_file = pd.ExcelFile(source)
    sd = xls_file.parse('Sheet1')
    source_u = sd.drop_duplicates(cols = 'id_company', take_last=False)
    source_r = source_u[['id_company','id_good','description', 'website','keyword', 'company_name','founded_month', 'founded_year', 'description']]
    source_i = source_r.reindex() #hail mary
    tup_r = [tuple(x) for x in source_i.values] 
```

这是错误：

```
Traceback (most recent call last):
  File "<pyshell#10>", line 1, in <module>
    sg_sql_2.runNow()
  File "sg_sql_2.py", line 31, in runNow
    tup_r = [tuple(x) for x in source_r.values]
  File "C:\Python27\lib\site-packages\pandas\core\frame.py", line 1443, in as_matrix
    return self._data.as_matrix(columns).T
  File "C:\Python27\lib\site-packages\pandas\core\internals.py", line 723, in as_matrix
    mat = self._interleave(self.items)
  File "C:\Python27\lib\site-packages\pandas\core\internals.py", line 743, in _interleave
    indexer = items.get_indexer(block.items)
  File "C:\Python27\lib\site-packages\pandas\core\index.py", line 748, in get_indexer
    raise Exception('Reindexing only valid with uniquely valued Index '
Exception: Reindexing only valid with uniquely valued Index objects 
```

所以，在一天的大部分时间里，我的头撞在墙上之后，谁能告诉我这是一个错误还是我错过了一些非常明显的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T23:20:53.303

今天在 GitHub 上修复了底层错误：[https ://github.com/pydata/pandas/issues/2236](https://github.com/pydata/pandas/issues/2236)

# google-maps - 来自 ac# windows 程序的 KML/KMZ 谷歌地图

> ID：13352371
> 
> 赞同：1
> 
> 时间：2012-11-12T22:06:34.797
> 
> 标签：google-maps

可以将非托管 KML/KMZ 文件从 C# Windows 程序发送到 Google 地图吗？本质上，我想将 KML/KMZ 文件直接发送到 Google 地图，而不是发送指向包含 KML 文件的公共服务器的 URL。

提前感谢您的反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:21:09.887

不适用于 Google Maps 或 Google Maps API v3 本机[KmlLayer](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)，因为 URL 需要“托管在可公开访问的 Web 服务器上”。

如果您使用第三方解析器，例如[geoxml3](http://code.google.com/p/geoxml3/) [可能还有[geoxml-v3](http://code.google.com/p/geoxml-v3/)），您可以使用本地文件（取决于浏览器安全策略），甚至可以使用包含有效 KML 的字符串。

geoxml3 支持 KMZ，但它是否可以从本地文件系统工作取决于浏览器。

使用第三方解析器的缺点是您失去了使用 KmlLayer 获得的平铺渲染的性能优势。

您也可以使用 Google 地球进行调查（但您没有将其包含在标签中）

# c# - 如何使用 WinRT 将 json 发布到网站？

> ID：13352380
> 
> 赞同：2
> 
> 时间：2012-11-12T22:06:56.923
> 
> 标签：c#, json, microsoft-metro, windows-runtime

我正在尝试将此 JSON 数据字符串发布到我的 php 站点：

```
{
    "tag":"login"
    "email":"email@email.com"
    "password":"P@ssw0rd"
} 
```

这是我拥有的 C# 代码：

```
 HttpClient client = new HttpClient();
        client.BaseAddress = new Uri("http://localhost/login/");
        string link = "http://localhost/login/";

        UserCredentials cred = new UserCredentials(email.Text, pass.Password.ToString());
        var data = new Dictionary<string, List<UserCredentials>>();
        string json = JsonConvert.SerializeObject(data, Formatting.Indented);

        HttpResponseMessage re = await client.PostAsync(link, new StringContent(json)); 
```

用户凭证类：

```
public class UserCredentials
{
    public UserCredentials(string user, string pass)
    {
        User = user;
        Pass = pass;
        Tag = "login";
    }

    internal string User;
    internal string Pass;
    internal string Tag;
} 
```

在我的 php 脚本中：

```
<?php

if (isset($_POST['tag']) && $_POST['tag'] != '') {
  echo "got tags";
else 
  echo "didn't get anything";
?> 
```

有谁知道我应该如何通过 postasync 方法发送标签？我得到'没有得到任何东西'..请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T16:36:34.697

### 首先，修复您的 UserCredentials 类。让您的成员公开，而不是内部。

```
public class UserCredentials
{
    public UserCredentials(string user, string pass)
    {
        User = user;
        Pass = pass;
        Tag = "login";
    }

    public string User;
    public string Pass;
    public string Tag;
} 
```

### 其次，仅序列化您的凭据。

```
UserCredentials cred = new UserCredentials(email.Text, pass.Password.ToString());
string json = JsonConvert.SerializeObject(cred, Formatting.Indented);
System.Diagnostics.Debug.WriteLine(json); 
```

您将在“输出”窗口中看到如下内容：

```
{
  "User": "me@hotmail.com",
  "Pass": "ILoveToEatGrapes",
  "Tag": "login"
} 
```

### 三、替换`StringContent`为`FormUrlEncodedContent`

如果您使用的是 PHP `$_POST`，那么您必须`key1=value1&key2=value2`在 HTTP 请求中发送类似的内容。这被调用`x-www-form-urlencoded`并且 HttpClient 包含正确的类：`FormUrlEncodedContent`。

`FormUrlEncodedContent`接收键/值对的字典。

```
// Create the list of keys and values.
var data = new Dictionary<string, string>();
data["tag"] = json;

// Send my keys and values.
HttpClient client = new HttpClient();
string link = "http://localhost/login/";
HttpResponseMessage re = await client.PostAsync(link, new FormUrlEncodedContent(data)); 
```

这将通过连接发送：

```
POST /login/ HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Host: localhost
Content-Length: 142
Expect: 100-continue
Connection: Keep-Alive

tag=%7B%0D%0A++%22User%22%3A+%22me%40hotmail.com%22%2C%0D%0A++%22Pass%22%3A+%22I
LoveToEatGrapes%22%2C%0D%0A++%22Tag%22%3A+%22login%22%0D%0A%7D 
```

## 四、在PHP中使用你的数据

正如你在上面看到的，数据是用很多百分号编码的。PHP 会自动为您解码数据，因此您无需担心。

要将凭证从 json 转换为数组，您可以使用[json_decode](http://www.php.net/manual/en/function.json-decode.php)

```
$cred = json_decode($_POST['tag']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:54:14.517

创建了 cred，但未添加到`data`可能会导致一个空集

```
UserCredentials cred = new UserCredentials(email.Text, pass.Password.ToString());
var data = new Dictionary<string, List<UserCredentials>>();
data["key"] = new List<UserCredentials>{cred};
string json = JsonConvert.SerializeObject(data, Formatting.Indented); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T00:49:11.063

为什么您使用字典（嗯，您实际上创建它但不填充它）而不是立即使用对象的任何原因？

```
 UserCredentials cred = new UserCredentials(email.Text, pass.Password.ToString());
    string json = JsonConvert.SerializeObject(cred, Formatting.Indented); 
```

# javascript - KnockoutJS 在模型之外添加动画？

> ID：13352387
> 
> 赞同：0
> 
> 时间：2012-11-12T22:07:42.903
> 
> 标签：javascript, knockout.js

好吧，我正在开发一个 knockout.js 应用程序，如果我不想将动画功能保留在模型中，我想知道将它们放在哪里（这似乎不是放置它们的正确位置）...

[http://knockoutjs.com/examples/animatedTransitions.html](http://knockoutjs.com/examples/animatedTransitions.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:33:30.753

没有什么能阻止您引用模型之外的函数。Knockout 首先查看视图模型，但如果找不到任何内容，则会查看全局上下文。

HTML：

```
<ul data-bind="template: { foreach: labels, afterAdd: app.animations.afterAdd}">
    <ol data-bind="text: $data"></ol>
</ul> 
```

JS：

```
app = {};    
app.animations = {};    
app.animations.afterAdd = function(elem){
    $(elem).hide().slideDown('slow');
}; 
```

这是一个证明这有效[的小提琴。](http://jsfiddle.net/tyrsius/SpZJs/)

# php - 将 php 脚本作为 cron 作业运行 - 超时问题？

> ID：13352388
> 
> 赞同：17
> 
> 时间：2012-11-12T22:07:42.277
> 
> 标签：php, cron

我正在编写一个 php 脚本，它做一些后端工作，需要每 8 小时左右运行一次。该脚本需要一段时间才能执行。对于它的地狱，我从我的浏览器尝试了它，与服务器的连接在脚本终止之前就被重置了。我的问题是 - 如果我直接运行它，即。php -a file.php 作为 cron 作业，执行是否有任何内部时间限制？此脚本可能需要 2-5 分钟才能完成，并且不能被中断。我以前从未这样做过，所以我不确定 php 在运行繁重的脚本时是否有怪癖。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-12T22:34:32.493

如前所述，默认情况下 CLI 脚本没有时间限制。

但我还想提一下您的 cron 作业方法的替代方法：
您可以在 Web 服务器控制下从 PHP 脚本派生 CLI PHP 脚本。我已经做过很多次了。如果您有一个执行时间较长的脚本，该脚本必须由某些网站用户操作触发（例如，构建一个非常大的存档文件并在文件完成后通过电子邮件发送下载链接），这将特别有用。我通常使用 popen() 函数从网络服务器 PHP 脚本派生 CLI 脚本。这允许很好地将参数传输到新的脚本实例，如下所示：

```
$bgproc = popen('php "/my/path/my-bckgrnd-proc.php"', 'w');
if($bgproc===false){
  die('Could not open bgrnd process');
}else{
  // send params through stdin pipe to bgrnd process:
  $p1 = serialize($param1);
  $p2 = serialize($param2);
  $p3 = serialize($param3);
  fwrite($bgproc, $p1 . "\n" . $p2 . "\n" . $p3 . "\n");
  pclose($bgproc);
} 
```

在 CLI 脚本中，您将收到这些参数，如下所示...

```
$fp = fopen('php://stdin', 'r');
$param1 = unserialize(fgets($fp));
$param2 = unserialize(fgets($fp));
$param3 = unserialize(fgets($fp));
fclose($fp); 
```

...并与他们做任何在网络服务器控制下需要很长时间的事情。

这种技术在 *nix 和 Windows 环境中同样适用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T22:15:04.090

不，从命令行执行 php 时，php 本身没有时间限制。

但可能还有其他超时，例如与 mysql 的连接。因此，如果您的代码中有 mysql 连接，请确保使其保持活动状态或将您的 mysql 超时设置为足够高以运行您的代码。另一件事：我看到一些虚拟主机提供商杀死了运行超过几分钟的 php 应用程序。因此，请确保您的提供商不这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T22:16:27.240

默认情况下，PHP 脚本在 30 秒后超时，可以通过编辑 PHP.ini 或将其添加到脚本顶部来覆盖。

```
set_time_limit(0); 
```

这为您的脚本设置了无限的执行时间，也就是说，除非脚本完成执行，或者服务器关闭，或者文件被删除或出现任何致命错误，否则它永远不会结束。

此外，

您可以将此添加到您的脚本并在浏览器中打开它以启动脚本，它会像您在浏览器中打开它并保持浏览器打开一样运行。

```
ignore_user_abort(); 
```

它只是在后台运行脚本。这两个都会对你有用。

**ADD：当脚本从命令行运行时，Cli，默认超时为0。（无超时）**

# java - 每个 python 对象一个 int

> ID：13352389
> 
> 赞同：3
> 
> 时间：2012-11-12T22:07:43.070
> 
> 标签：java, python, static, int

> **可能重复：**
> [类实例的自动递增 ID](https://stackoverflow.com/questions/8319910/auto-incrementing-ids-for-class-instances)

我想要 Python 中的以下 Java 类：

```
public class MyObject {
    private static int ID = 0;
    private final int id;
    public MyObject() {
        id = ID++;
    }
} 
```

在这段 Java 代码中，每个对象`myObject`都有`id`并且不可能有两个对象具有相同的 ID（这是一个单线程应用程序）。

我可以在 Python 中做这样的事情吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T22:10:00.780

在 Python 中，您可以直接引用类属性：

```
class MyObject(object):
    ID = 0

    def __init__(self):
       self.id = MyObject.ID = MyObject.ID + 1 
```

演示：

```
>>> class MyObject(object):
...     ID = 0
...     def __init__(self):
...        self.id = MyObject.ID = MyObject.ID + 1
... 
>>> MyObject().id
1
>>> MyObject().id
2
>>> MyObject().id
3
>>> MyObject.ID
3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:23:12.717

正如我在对@Martjin Pieters 回答的评论中提到的那样，[`id()`](http://docs.python.org/2/library/functions.html#id)内置可能足以满足您的需求。 `id(obj)`返回系统中任何在访问时唯一的对象的 id（本质上，在某些解释器中，字面意思是对象的内存地址）。除非您的对象经常被销毁，但您的 id 引用即使在销毁后也需要保持有效，`id()`否则应该可以满足您独特的 id 需求。

来自文档：

> [id() 返回的值] 是一个整数（或长整数），保证在其生命周期内对于该对象是唯一且恒定的。具有非重叠生命周期的两个对象可能具有相同的 id() 值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:39:15.080

@Martjin Pieters 有正确的想法，但我建议使用[`itertools.count`](http://docs.python.org/2/library/itertools.html#itertools.count)这个：

```
class MyObject(object):
    ID = itertools.count()

    def __init__(self):
       self.id = MyObject.ID.next()

>>> MyObject().id
0
>>> MyObject().id
1
>>> MyObject().id
2
>>> MyObject.ID
count(3) 
```

希望这可以帮助

# sql - 在数据库列中查找和匹配

> ID：13352394
> 
> 赞同：1
> 
> 时间：2012-11-12T22:08:07.383
> 
> 标签：sql, database, match, lookup

我在表格中有一个列（A-COL），如下所示，A-COL 有许多不同的组合，每个组合最多 25 位。

```
A-COL      B-COL  
018         xxx  
01812       xxx    
0199        xxx  
019232      xxx    
00452       xxx    
00323       xxx    
00651       xxx    
019287      xxx    
*121        xxx    
N22321      xxx    
XN43155     xxx 
```

我需要：

1.  查找此列 (A-COL) 并找到最佳行匹配。
2.  获取此表中的相应列 (B-COL)。
3.  将其作为单个值输入到sql中，例如0181233445将匹配01812，第二行，同样，00323455387将匹配第6行，N22321将匹配第10行。

我确实根据右侧的数字条写了很多，但由于输入的数量以百万为单位，而查找表本身以数千为单位，因此性能受到了影响。

任何优化的解决方案或建议都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:49:06.567

如果 Acol 被索引，这应该很快：

```
Select
  *
From (
  Select Top 1
    *
  From 
    Test
  Where 
    Acol <= @Input
  Order By 
    ACol Desc
  ) a
Where
  @Input Like Acol + '%' 
```

[http://sqlfiddle.com/#!3/910b3/1](http://sqlfiddle.com/#!3/910b3/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:18:14.160

我不喜欢 SQL 中的循环，但这可能是最有效的方式 if(!) A-Col 有一个索引并且表相当长：

```
declare @n int
set @n = datalength(@SearchText)
while @n>0 and @aCol is null begin
  select @acol = [A-Col] from table where substring(@SearchText,1,@n)=[A-Col]
  set @n = @n - 1
end
select @acol 
```

如果 A-Col 没有被索引，那么这应该可以解决问题（但速度很慢）：

```
select top 1 ACol
from table 
where @Searchtext like ACol+'%' 
order by DataLength(ACol) desc 
```

注意：未经测试。

更新：我刚刚读到您很可能实施了第一种方法。

想法：假设您的数百万个输入表称为“输入”。要匹配的列称为“数字”。然后在“数字”列上放置一个索引并执行此操作

```
WITH cte AS (
  select input.number, 
         lookup.ACOL, 
         ROW_NUMBER() OVER (
           PARTITION BY input.number, lookup.ACOL 
           ORDER BY DataLength(lookup.ACOL)
           ) as rowNumber
  from   input 
         join lookup on lookup.ACOL like input.number+'%'
)
SELECT *
FROM cte
WHERE rowNumber = 1 
```

# c++ - C++ MoveFile 在 Windows Server 上为目录移动提供不一致的 ERROR_ACCESS_DENIED

> ID：13352396
> 
> 赞同：0
> 
> 时间：2012-11-12T22:08:39.463
> 
> 标签：c++, directory, windows-server-2003

我在将目录移动到新位置时遇到问题，特别是我使用`CreateDirectory`. 这是代码：

```
if (FALSE == CreateDirectory(strDestination, NULL))
{
    dwError = GetLastError();
    if (ERROR_ALREADY_EXISTS != dwError)
    {
        strError.Format("Error creating %s: %i", strDestination, dwError);
        LogIt(strError);
    }
}
if (FALSE == MoveFile(strSource, strDestination + strID))
{
    dwError = GetLastError();
    strError.Format("Error moving %s to %s: %i", strSource, strDestination + strID, dwError);
    LogIt(strError);
} 
```

但是，如果我手动创建一个目录，我可以将该路径输入此代码并且它可以工作。我已经比较了这两个目录的安全设置，并确保它们相同，但它仍然无法正常工作。我的创建代码有什么问题吗？如果我将第二个参数保留为`NULL`，它是否应该授予与手动创建目录时相同的权限？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:41:09.547

如果您在计算机上运行防病毒软件，它可能会在验证新文件夹/将其添加到其干净缓存时锁定新文件夹。例如，如果 AV 驱动程序陷入其他活动，这可能会导致间歇性计时问题。

要检查是否发生了这种情况，您可以禁用 AV 的按访问扫描仪。您的代码中的一种解决方法是重试（比如说）2-3 次，两者之间有一点延迟。

编辑：由于 OP 已经确认它无法移动到不同的卷，答案是使用带有 MOVEFILE_COPY_ALLOWED 标志的 MoveFileEx() 。

# asp.net-mvc - MVC 4 模块化

> ID：13352398
> 
> 赞同：0
> 
> 时间：2012-11-12T22:08:47.240
> 
> 标签：asp.net-mvc, asp.net-mvc-4, mef

我正在尝试为 MVC 4 站点创建模块化机制。我的大多数事情都是通过自定义 ViewEngine（基于 Razor）进行的，但是在 FindView 返回后，我收到一个错误，即无法解析视图中列出的模型。

模型和控制器位于模块的 DLL 中，并且此 DLL 加载到 MEF 容器中。控制器执行正常，但在解析视图中的 @model 时显然缺少一些东西。

有人知道我在这里缺少什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:14:54.033

每个需要在视图中解析的命名空间都必须在视图文件夹的 web.config 中声明。你这样做了吗？

另一种方法是在视图中使用完整的命名空间来指定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:45:59.490

解决了。

我正在将模块 dll 复制到 bin\modules 中，因此 .cshtml.cs 文件的编译找不到引用的模型。我现在只是将 dll 复制到 bin 文件夹中，它工作得很好。

干杯

# objective-c - 使用 inset of bounds 设置视图

> ID：13352406
> 
> 赞同：0
> 
> 时间：2012-11-12T22:09:38.547
> 
> 标签：objective-c, ios, cocoa-touch, uiviewcontroller, ios-simulator

我使用“单一视图”应用程序模板启动了一个 Xcode 项目，并在模板创建的 ViewController 类中添加了两行`viewDidLoad`：

```
UITextView *textView = [[UITextView alloc] initWithFrame:CGRectInset(self.view.bounds, 10, 10)];
[self.view addSubview:textView]; 
```

当我在**3.5 英寸**iPhone 模拟器中运行它时，textview 会延伸到屏幕底部。我打算将它放置在屏幕中央，边框为 10 点。

我错过了一些基本的东西吗？它似乎在 4" 模拟器中工作正常。它是模拟器错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:15:22.300

这不是模拟器中的错误。

Xcode 模板包含一个 xib，其中 xib 是视图控制器的顶级视图 ( `self.view`)，该视图的大小适合 iPhone 5 屏幕。

当系统发送`viewDidLoad`到您的视图控制器时，它还没有根据当前设备的屏幕大小调整该视图的大小。因此，您的文本视图框架基于 iPhone 5 屏幕的大小。

您可以通过在视图上设置自动调整大小标志来解决此问题：

```
UITextView *textView = [[UITextView alloc] initWithFrame:CGRectInset(self.view.bounds, 10, 10)];
[self.view addSubview:textView];
textView.autoresizingMask = UIViewAutoresizingFlexibleHeight
    | UIViewAutoresizingFlexibleWidth; 
```

默认情况下，您的 xib 设置为使用自动布局，因此您还可以通过在文本视图和顶级视图之间设置约束来让系统调整文本视图的大小：

```
UITextView *textView = [[UITextView alloc] initWithFrame:CGRectInset(self.view.bounds, 10, 10)];
[self.view addSubview:textView];
textView.translatesAutoresizingMaskIntoConstraints = NO;
[self.view addConstraints:[NSLayoutConstraint
    constraintsWithVisualFormat:@"H:|-10-[textView]-10-|" options:0 metrics:nil
    views:NSDictionaryOfVariableBindings(textView)]];
[self.view addConstraints:[NSLayoutConstraint
    constraintsWithVisualFormat:@"V:|-10-[textView]-10-|" options:0 metrics:nil
    views:NSDictionaryOfVariableBindings(textView)]]; 
```

如果您将文本视图放在 xib 中而不是在代码中创建它，则可以使用 xib 编辑器（又名“Interface Builder”或“IB”）来设置约束。我强烈推荐观看[WWDC 2012](https://developer.apple.com/videos/wwdc/2012/)的自动布局视频：

*   第 202 课 - iOS 和 OS X 的自动布局简介
*   会话 228 - 掌握自动布局的最佳实践
*   会话 232 - 示例自动布局

# javascript - 在 Rails 3.2 Ajaxified 应用程序中是否有管理状态的标准方法？

> ID：13352407
> 
> 赞同：1
> 
> 时间：2012-11-12T22:09:43.090
> 
> 标签：javascript, ruby-on-rails-3.2, state

我有一个应用程序，我在其中“滚动了我自己的”状态设备，其中包含一个大的隐藏形式。我会捕获某些点击事件，更改表单，序列化数据，并使用 jQuery BBQ 插件推送它。

我*一直不*明白我在做什么。它工作了一小会儿，但它太笨重了，以至于它在我周围掉下来了。

该应用程序本身非常简单。想象一个平面表，其中一些列以分层方式布局：

```
category
subcategory
product 
```

屏幕首先列出类别，然后向下钻取子类别等。我的问题是，是否有新的标准或“Rails Way”来完成这种状态持久化？当然，我希望后退按钮也能正常工作。我的方法似乎笨拙且难以管理。而破碎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:49:34.563

恕我直言，这可以通过[骨干](http://backbonejs.org/)优雅地解决。[如果您通过主干导轨](https://github.com/codebrew/backbone-rails)gem包含它，这将直接与导轨兼容。

如果您不太确定自己在做什么，也许您最好花一些时间阅读如何使用 rails 主干 api 制作一个好的前端应用程序。[railscasts](http://railscasts.com)上有几个截屏视频，[主干网页](http://backbonejs.org/)上有一些很好的例子。

我希望这有帮助。最好的祝福。

# python - 在 Python 中使用 BeautifulSoup 查找字符串

> ID：13352411
> 
> 赞同：0
> 
> 时间：2012-11-12T22:09:50.023
> 
> 标签：python, beautifulsoup

我需要从这样的字符串中提取“/html/path”：

```
generic/html/path/generic/generic/generic 
```

我只需要“路径”，它总是在“html/”之后。那么有没有一种方法可以搜索“html/”并获取它之后的字符串，直到出现“/”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T22:21:10.080

另一个要添加到组合中：

```
In [1]: s = 'generic/html/path/generic/generic/generic'

In [2]: s.split('html/')[1].split('/')[0]
Out[2]: 'path' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:14:42.673

这只是基本的字符串操作

```
s="generic/html/path/generic/generic/generic"
i1= s.index("html/") + 5
i2= s.index("/", i1)
print s[i1:i2] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:14:53.130

您可以使用正则表达式：

```
>>> regex = re.compile(".+html/(.+?)/")
>>> r = regex.search("generic/html/path/generic/generic/generic")
>>> r.groups()
(u'path',) 
```

Python 文档：http: [//docs.python.org/3.3/library/re.html](http://docs.python.org/3.3/library/re.html)

# android - 为什么 RingtoneManager.setActualDefaultRingtoneUri 不能工作？[安卓 API-8]

> ID：13352416
> 
> 赞同：8
> 
> 时间：2012-11-12T22:10:36.153
> 
> 标签：android, ringtone

这个问题可能与[这个问题](https://stackoverflow.com/questions/12801908/android-change-notification-ringtone)重复，但我发现代码有所不同，所以我提出了一个新问题。

问题是我无法在 RingtonePicker 中设置选择的铃声。我使用[Support Library](http://developer.android.com/tools/extras/support-library.html)和[AndroidAnnotations](https://github.com/excilys/androidannotations/wiki)，也许它会导致这样的问题（尽管我对此表示怀疑）。

我有一个带有按钮的片段。单击按钮时，会触发 RingtonePicker。用户选择铃声，应用程序将其保存在 SharedPreference 中。下次用户打开 RingtonePicker 时，应该检查之前选择的铃声，我不能这样做。

这是我的片段

```
@EFragment(R.layout.pref_page)
public class PrefPage extends Fragment {

    @Pref
    MyPrefs_ myPrefs;

    @Click(R.id.ringtone_button)
    public void onClick() {
        Intent intent = new Intent(RingtoneManager.ACTION_RINGTONE_PICKER);
        intent.putExtra(RingtoneManager.EXTRA_RINGTONE_TYPE,
                RingtoneManager.TYPE_NOTIFICATION);

        String uri = myPrefs.beepUri().get();    

        if (uri != "") {      
                    Log.i("Log", "uri is " + uri);              
                    RingtoneManager.setActualDefaultRingtoneUri(
                            getActivity(),
                            RingtoneManager.TYPE_NOTIFICATION,
                            Uri.parse(uri));
        }

        startActivityForResult(intent, 1);
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (resultCode == -1) {
            Uri uri = data.getParcelableExtra(RingtoneManager.EXTRA_RINGTONE_PICKED_URI);
            if (uri != null) {
                String uriString = uri.toString();
                Log.i("Log", "uriString is " + uriString);
                myPrefs.edit().beepUri().put(uriString).apply();
            }
        }
    }
} 
```

两个词的问题是 -**为什么 RingtoneManager.setActualDefaultRingtoneUri 在这里不起作用？**

**更新：**

我的清单中有 WRITE_SETTINGS 权限。

```
<uses-permission android:name="android.permission.WRITE_SETTINGS" ></uses-permission> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-27T17:36:29.253

好的，所以我和你有同样的问题。我假设您传入的 Uri 是您的资产中的一个文件，或者来自您存储在首选项文件中的磁盘。在这种假设下工作，问题是您不能将 Uri 推入 RingtoneManager 并期望它接受它。文件 uri 应该来自内容解析器。

如果有人能告诉我为什么会这样，我会很高兴，但我不是专家，所以我现在接受它。话虽如此，此代码将让您获取 Uri 并将其设置为默认铃声。

```
 //We get the Uri here fro ma file's absolute path.
    Uri ringtoneUri = Uri.parse(file.getAbsolutePath());

    //We now create a new content values object to store all the information 
    //about the ringtone.
    ContentValues values = new ContentValues();
    values.put(MediaStore.MediaColumns.DATA, chosenFile.getAbsolutePath());
    values.put(MediaStore.MediaColumns.TITLE, chosenFile.getName());
    values.put(MediaStore.MediaColumns.SIZE, chosenFile.length());
    values.put(MediaStore.MediaColumns.MIME_TYPE, "audio/mp3");
    values.put(AudioColumns.ARTIST, context.getString(R.string.app_name));
    values.put(AudioColumns.IS_RINGTONE, true);
    values.put(AudioColumns.IS_NOTIFICATION, false);
    values.put(AudioColumns.IS_ALARM, false);
    values.put(AudioColumns.IS_MUSIC, false);

    //Work with the content resolver now
    //First get the file we may have added previously and delete it, 
    //otherwise we will fill up the ringtone manager with a bunch of copies over time.
    Uri uri = MediaStore.Audio.Media.getContentUriForPath(chosenFile.getAbsolutePath());
    context.getContentResolver().delete(uri, MediaStore.MediaColumns.DATA + "=\"" + chosenFile.getAbsolutePath() + "\"", null);

    //Ok now insert it
    Uri newUri = context.getContentResolver().insert(uri, values);

    //Ok now set the ringtone from the content manager's uri, NOT the file's uri
    RingtoneManager.setActualDefaultRingtoneUri(
      context,
      RingtoneManager.TYPE_RINGTONE,
      newUri
    ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T23:27:58.433

您需要指定写入清单文件中设置的权限。

```
<uses-permission android:name="android.permission.WRITE_SETTINGS" ></uses-permission> 
```

还要发布您的 logcat 输出。

# jquery - 在引导日期选择器中突出显示整周

> ID：13352418
> 
> 赞同：1
> 
> 时间：2012-11-12T22:10:50.560
> 
> 标签：jquery, css, twitter-bootstrap, datepicker, hover

[与这篇文章](https://stackoverflow.com/questions/7187796/highlight-tr-entire-week-datepicker)类似，其中一个答案提供了[这个 jsfiddle](http://jsfiddle.net/william/YQ2Zw/2/)，我想突出显示我的引导日期选择器的整个一周，而不是 jQuery UI。

我的代码目前是这样的：

```
$('.datepicker-days tbody tr').live('mousemove', function () {
    $(this).find('td day').addClass('highlight');
});
$('.datepicker-days tbody tr').live('mouseleave', function () {
    $(this).find('td day').removeClass('highlight');
}); 
```

据我所知，“突出显示”不是要添加和删除的正确类。

datepicker CSS 文件中悬停单元格的选择器是：

```
.datepicker td.day:hover { background: #eeeeee; cursor: pointer; } 
```

有没有办法将“悬停”添加为“类”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:23:24.423

您可以添加任何您想要的课程。如果您想要与显示的悬停规则相同的 css，只需为您的类添加一个新规则并使其足够具体，以使其他 css 规则不会超过它的排名。您可以检查适用于浏览器控制台中任何元素的所有规则

示例 CSS：

```
 .datepicker td.highlight { background: #eeeeee; cursor: pointer; } 
```

使用`mousemove`不太合适，改为`mouseenter`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:25:22.943

我认为你应该使用`mouseenter`而不是`mousemove`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-23T07:25:13.780

如果您只想在一个日期选择器上应用一个星期选择器突出显示，不幸的是，它通过使用这个应用到项目内的所有日期选择器上：

```
 .datepicker td.highlight { background: #eeeeee; cursor: pointer; } 
```

它发生在我身上，因为我这样做了。

**脚本**

```
$('#weeklyDatePicker').on('click', function () {

        if ($('.datepicker').hasClass('one') == false) {
            $('.datepicker').addClass('one');
        }           
    }); 
```

**风格**

```
 .one{
}

.one tr:hover{
  background-color: #a8a8a8;
} 
```

# sql - visual basic 2010 - 对表的多个查询

> ID：13352419
> 
> 赞同：1
> 
> 时间：2012-11-12T22:11:11.003
> 
> 标签：sql, vb.net, visual-studio-2010, ms-access

我正在设置一个包含生啤酒、瓶装啤酒和食物的订单菜单。

我将项目拖放到菜单中，并将它们连接到我已连接到项目的数据库。我已经告诉 VB，使用查询生成器，根据下拉框是什么来运行不同的查询。每个投递箱都是一个单独的类别（瓶装、草稿和食品），但从同一张表中提取。我确实让它在 3 个下拉菜单中显示项目，但是当我不断告诉查询生成器分别获取 Category_ID 2 或 3 用于 Draft 和 Food 时，它们都恢复到类别 ID 1（瓶装啤酒）。

难道我做错了什么？对于同一个表，我只想要 3 个单独的查询，每个下拉列表一个。我可以在 VB 源代码中运行查询而不是使用 GUI 菜单，因为它显然不合作吗？该数据库是一个 MS Access 2010 数据库。

任何指导将不胜感激，

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:21:19.167

你可以试试这样的

```
 sub UsingSQLFromCode()
         Dim dbSource As String = "Data Source = Path to your database"
         Dim dbProvider As String = "Provider=Microsoft.ACE.OLEDB.12.0;"
         Dim con As New OleDb.OleDbConnection(dbProvider & dbSource)
         Dim cmd As New OleDb.OleDbCommand
         Try
                    sql = "Whatever your sql is"
                    cmd.CommandText = sql
                    cmd.Connection = con
                    con.Open()
                    cmd.ExecuteNonQuery()
                    con.Close()
                Catch ex As OleDbException
                    con.Close()
                    MsgBox("An Error Occured")
                    Exit Sub
                End Try

            End Sub 
```

参考 [http://www.connectionstrings.com/access-2007](http://www.connectionstrings.com/access-2007)

# java - 如何使车轮摇摆到某个角度？

> ID：13352421
> 
> 赞同：2
> 
> 时间：2012-11-12T22:11:23.073
> 
> 标签：java, math

我需要让一个轮子落在五个角度中的一个上，我希望它在达到这个角度时摇摆不定。用户转动轮子后，我通过将旋转速度乘以每滴答声 0.98 来减慢速度。我通过找到最接近的角度并将其方向上的一个小值添加到速度来让它工作。然而，这看起来不切实际，并且可能会出现故障。

我正在考虑实现一个阻尼正弦波，但我不确定我会如何做到这一点。

当前伪代码：

```
var rotation, rotationVelocity, stoppingPoints[5];
update(deltaT) {
    velocity -= rotationVelocity * 0.5 * dt;
    closestAngle = findClosestAngle().angle;
    rotationVelocity += (closestAngle - rotation) / 36 * dt;
    rotation += rotationVelocity; 
} 
```

编辑：

摇摆不定：移动或平衡不稳；前后摇摆：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:16:44.367

每次迭代从它的速度中减去一个常数，直到它达到零

这不仅实际上代表了摩擦在现实生活中的运作方式，而且也更容易。

如果您希望它像连接到弹簧一样移动：

胡克的弹簧定律`F = -kx`是`k`常数，如果你想让它像在弹簧上一样来回摆动，x 是到原点的距离。跟踪它从原点的旋转，并添加它从原点的旋转距离（或角度）在 `-kx`哪里。`x`

现在，如果您将摩擦力和胡克定律应用于弹簧，它应该看起来很逼真。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:20:48.390

我认为您想要的最接近的角度是最接近它将停止的位置。您可以模拟它将在哪里结束，结束需要多长时间，并使用它来确定您需要多少额外（或更少）的速度。

不知道你说的摇摇晃晃到底是什么意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:22:07.943

听起来您想为一个带有重物的轮子建模`stoppingPoints`。我的意思是，从物理学的角度来看。存在现有的旋转速度，然后是摩擦减速，以及由重力对这些点的影响引起的未知加速/减速（根据重物的位置转换为旋转速度）。无论如何，这是我的解释，并且可能是我的方法（模拟重力）。

我认为当重量引起的加速度超过现有的旋转速度时，就会实现你所说的摇摆不定。

# actionscript-3 - AS3 前端代码和 AS2 服务器端脚本如何来回发送对象，同时保留它们的方法？

> ID：13352424
> 
> 赞同：0
> 
> 时间：2012-11-12T22:11:37.197
> 
> 标签：actionscript-3, actionscript-2, server-side, flash

给定以下 AS3 前端代码：

```
m_nc.connect("rtmp://" + pPrimaryIP + "/appname/"+ pVID, pUID, pConfig); 
```

以及以下 AS2 服务器端脚本代码：

```
application.onConnect = function(pClientObj, pUID, pConfig)
{
    // do stuff
} 
```

其中 pConfig 是配置类型的对象，如 AS3 代码中所定义，具有以下方法：

```
public function copy(pConfig:Configuration):void 
```

显然，当您尝试在连接时发送对象时，它会丢失该方法和任何其他方法。然而，它的字段基本保持不变，至少如果它们是原始的。我可以理解为什么会这样，但是没有什么办法可以防止这种损失发生吗？我真的希望不仅能够将它发送到 AS2 而不丢失任何东西，而且还能够将它发送回 AS3 而不会丢失任何东西。这可能吗？如果有怎么办？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:38:47.227

你应该看看 LocalConnection，一个对 AS2 和 AS3（甚至 AS1）都可用的类 [clicky](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/LocalConnection.html)

# c - 将浮点值存储到无符号字符数组

> ID：13352427
> 
> 赞同：3
> 
> 时间：2012-11-12T22:12:03.540
> 
> 标签：c, floating-point, unsigned-char

很抱歉问这个问题，但我已经搜索了这个小东西，并在下面的链接中找到了相关的东西，但无法得到任何想法

1.  [如何将浮点数存储在数组中以供以后使用？](https://stackoverflow.com/questions/5011861/how-to-store-floats-in-array-to-be-used-later)

2.  [存储在无符号字符数组中](https://stackoverflow.com/questions/2437849/storing-in-unsigned-char-array/2442670#2442670)

如何存储一个浮点值假设 0.00895 到一个无符号字符，该字符稍后用于存储在内存缓冲区中。

后来我需要读回数组并想从内存中读回它。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T23:18:27.663

你不需要`memcpy`这个......如果你将一个浮点数组复制到内存中其他地方的缓冲区中，这将很有用。您真正需要的是使用不同的指针类型来查看字符数组。

```
const size_t BUFSIZE = 4096;
char buffer[BUFSIZE];
float *f_buf = (float*)buffer; 
```

如果您只想在缓冲区的开头插入一个浮点数，则以下两行中的任何一行都可以：

```
*f_buf = 0.00895;

f_buf[0] = 0.00895; 
```

它真正做的就是让您将缓冲区视为浮点数组。

```
int i;

/* Put a bunch of floats into the buffer */
for( i = 0; i < 10; i++ ) {
    f_buf[i] = i / 2;
}

/* Display contents of buffer in hex */
for( i = 0; i < 10 * sizeof(float); i++ ) {
    printf( "%02x", (int)buffer[i] );
}
printf( "\n" );

/* Sanity-test the buffer contents */
for( i = 0; i < 10; i++ ) {
    printf( "%d: %f\n", i, f_buf[i] );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:15:01.217

您可以将浮点数的内存复制到字符缓冲区中。

```
float a;
char buffer[sizeof(float)];
memcpy(buffer,&a,sizeof(float)); 
```

# bash - Bash Sed 替换

> ID：13352432
> 
> 赞同：0
> 
> 时间：2012-11-12T22:12:57.627
> 
> 标签：bash, sed

我正在使用 Zend CRUD 生成器，我必须用每个字段的表单代码替换 $targetForm 文件中的单词“test”。

```
field[0]="foo"
field[1]="bar"

textareafield='$'"acme_en = new Utils_Form_Element_Textarea('acme_en',array('langblock'=>'en', 'isWysiwyg' => true));
    "'$'"this->addElement("'$'"acme_en);
    "'$'"this->addElement('textarea','acme_fr', array( 'label'=>__('acme'), 'langblock'=>'fr', 'isWysiwyg' => true, 'altLangElem' => "'$'"acme_en));"    

for ((i=0; i<${#field[@]}; i++));
do
    formfield[$i]=$textareafield
    formfield[$i]=${formfield[$i]//acme/${field[$i]}}
    echo ${formfield[$i]}
    sed -i "s/test/test\n        ${formfield[$i]}/" $targetForm
done 
```

命令行说：

```
$foo_en = new Utils_Form_Element_Textarea('foo_en', array('langblock'=>'en', 'isWysiwyg' => true)); $this->addElement($foo_en); $this->addElement('textarea','foo_fr', array( 'label'=>__('foo'), 'langblock'=>'fr', 'isWysiwyg' => true, 'altLangElem' => $foo_en));
sed: -e expression #1, char 120: unterminated `s' command
$bar_en = new Utils_Form_Element_Textarea('bar_en', array('langblock'=>'en', 'isWysiwyg' => true)); $this->addElement($bar_en); $this->addElement('textarea','bar_fr', array( 'label'=>__('bar'), 'langblock'=>'fr', 'isWysiwyg' => true, 'altLangElem' => $bar_en));
sed: -e expression #1, char 120: unterminated `s' command 
```

也许特殊字符有问题，但我不知道如何解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T10:36:58.067

`\n`您得到的这个错误很可能与使用in replacement无关`sed`（特别是因为您在评论中提到您正在使用`GNU sed version 4.2.1`）。

* * *

真正的罪魁祸首是`textareafield`它包含一个多行字符串。

发生的情况是，当`${formfield[$i]}`扩展时，您的`sed`命令如下所示

```
sed -i "s/test/test\n        line1
line2
line3/" 
```

这是有问题的，因为在这种情况下，如果不使用文字来终止行`\`，`sed`则会将每一行本身解释为一个完整的命令

```
s/test/test\n        line1 
```

最后缺少 a `/`，因此出现错误“ **unterminated `s' command** ”。

为了解决这个问题，我们想要的是在`\`除最后一行之外的每一行的末尾插入 a，即

```
sed -i "s/test/test\n        line1\
line2\
line3/" 
```

我通过添加两行让您的示例生效

```
for ((i=0; i<${#field[@]}; i++));
do
    formfield[$i]=$textareafield
    formfield[$i]=${formfield[$i]//acme/${field[$i]}}
    formfield[$i]=${formfield[$i]//\;/\;\\}
    formfield[$i]=${formfield[$i]%\\}
    echo ${formfield[$i]}
    sed -i "s/test/test\n        ${formfield[$i]}/" $targetForm
done 
```

由于以`textareafield`结尾的所有行`;`，我都用 替换了所有`;`行`;\`，然后从最后一行中删除了`\`最后一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:23:09.487

`sed` [不支持`\n`替换](https://stackoverflow.com/questions/9473060/how-to-insert-newline-character-after-comma-in-with-sed)，但是如果您对其进行转义，则可以使用文字换行符。此外，您需要引用`'`字符。这是一种方法：

```
for ((i=0; i<${#field[@]}; i++));
do
    formfield[$i]=$textareafield
    formfield[$i]=${formfield[$i]//acme/${field[$i]}}
    sedexpr="${formfield[$i]}"
    sedexpr="${sedexpr//\'/\'}"
    sedexpr="${sedexpr//
/\\
}"
    sed -i "s/test/test\
        ${sedexpr}/" $targetForm
done 
```

但是在这种复杂程度下，您最好切换到 Python 之类的东西。

# coldfusion - 更新到 v1.1 时 Twitter API 状态更新不起作用

> ID：13352433
> 
> 赞同：0
> 
> 时间：2012-11-12T22:13:00.617
> 
> 标签：coldfusion, twitter, http-status-code-401

我有一个 twitter 应用程序，每当他们发布新的博客项目时，它都会自动发送推文以供我们的博客应用程序使用。

此应用程序现在返回错误

> HTTP/1.1 401 未经授权的内容类型：应用程序/json；charset=utf-8 日期：星期一，2012 年 11 月 12 日 22:05:27 UTC 服务器：tfe
> 
> {"errors":[{"message":"Could not authenticate you","code":32}]}

我的coldfusion代码如下发布推文：

```
<cfset var tweetURL = "https://api.twitter.com/1.1/statuses/update.json">
<cfhttp url="#tweetURL#" method="post" result="result">
    <cfhttpparam type="header" name="Authorization" value="#oauth.header#" encoded="no">
    <cfhttpparam type="formfield" name="status" value="#tweet#" encoded="no">
</cfhttp> 
```

我已经转储了所有的 oauth 标头值，它们都是应有的，它们根本没有返回任何错误。它只是返回未授权错误的状态更新。

我还需要检查哪些其他事项？我以为我的应用程序可能已被阻止或其他原因，但它一切正常。我已经测试了他们授权该应用程序的用户帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T02:16:30.330

我解决了。我正忙于验证我忽略了状态的标头和身份验证令牌等的输入。它不是 urlencoded。尽管这显然在旧版本中有效。它没有通过新的。

# android - Android小部件加声音

> ID：13352436
> 
> 赞同：-2
> 
> 时间：2012-11-12T22:13:10.897
> 
> 标签：android, android-widget

我有一个小部件，按下时会打开活动。我这样做：

一段代码：

```
 try {
            Intent defineIntent2 = new Intent(context,
                    Setting.class);
            PendingIntent pendingIntent2 = PendingIntent
                    .getActivity(context, 0 /* no requestCode */,
                            defineIntent2, 0 /* no flags */);
            updateViews
                    .setOnClickPendingIntent(R.id.widget, pendingIntent2);
        } catch (Exception e) {
            Log.e(LOG_TAG, "", e);
        }
        return updateViews;
    } 
```

我希望通过按小部件音乐开始。我试着在活动中做玩。这可行，但问题是我需要“手动”关闭活动。

按下时还有另一种释放音乐的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:33:00.513

您希望在从小部件打开 Activity 时播放音乐？

尝试这个：

```
 MediaPlayer player = new MediaPlayer();
    player = MediaPlayer.create(YourClass.this, R.raw.yoursoundfile);
    player.start();

    //Your intent code here to launch activity 
```

编辑：您需要使用服务。此处示例：http://stackoverflow.com/questions/4298888/android-music-player-widget

# jquery - 单击 JQuery 打开/关闭

> ID：13352438
> 
> 赞同：2
> 
> 时间：2012-11-12T22:13:26.837
> 
> 标签：jquery

在下面的例子中，当点击 ID 'Home' 时，会出现 div.panel，然后如果再次点击 ID 'Home'，则会隐藏 div.panel。目前我有这个：

```
$(document).ready(function() {
$('#home').on('click', function() {
    $('div.panel').animate({
        'width': 'show'
    }, 1000, function() {
        $('div.home').fadeIn(500);
    });
});

$('#home').on('click', function() {
    $('div.home').fadeOut(500, function() {
        $('div.panel').animate({
            'width': 'hide'
        }, 1000);
    });
});
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:20:37.083

通过按原样复制事件处理程序，无论何时`#home`单击，这两个函数都将尝试同时运行。您需要使用条件来决定是否运行其中一个。

```
$(document).ready(function () {
    $('#home').on('click', function () {
        if ($('div.home').is(':visible')) {
            $('div.home').fadeOut(500, function () {
                $('div.panel').animate({
                    'width': 'hide'
                }, 1000);
            });
        } else {
            $('div.panel').animate({
                'width': 'show'
            }, 1000, function () {
                $('div.home').fadeIn(500);
            });
        };
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:34:50.363

您的代码在某一点是多余的（ 的双重定义`$('#home').on('click', function()...`），您只需要其中一个。要实现您的描述，jqueries 的“[切换](http://api.jquery.com/toggle/)”是您的朋友。可以这样做：

```
$('#home').on('click', function() {
    $('div.panel').animate({
        'width': 'toggle'
    }, 1000); }); 
```

有关工作示例，请参阅此[Fiddle 。](http://jsfiddle.net/uUcua/)

# android - Mono for Android，代码混淆

> ID：13352440
> 
> 赞同：6
> 
> 时间：2012-11-12T22:13:42.203
> 
> 标签：android, mono, xamarin.android, xamarin, obfuscation

众所周知，盗版在Android上成为一个非常严重的问题。Mono for Android 在编译为本机代码时是否提供代码混淆？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T22:39:29.240

Mono for Android 不提供此功能，但您仍然可以使用第三方工具进行混淆处理。由于 Mono for Android 生成由 Android 设备上的 Mono 运行时 JIT 的 CIL 程序集，因此您需要对这些 .NET 程序集进行模糊处理。因此，像 Android 混淆器 Proguard 这样的工具对您没有帮助。据报道，以下 .NET 混淆器可与 Mono for Android 一起使用。

*   [Xenocode 后期构建](http://download.cnet.com/Xenocode-Postbuild/3000-10250_4-10506240.html)
*   [加密混淆器](http://www.ssware.com/cryptoobfuscator/obfuscator-net.htm)

如果您使用 Xenocode Postbuild，请确保禁用“元数据缩减”，以便类名称在 Java 中保持有效。

**更新**

Xamarin.Android 允许您打包 APK 文件，而无需编译的 .NET DLL。这意味着您不需要从 .NET 的角度应用混淆。我可以提取我的发布 APK 文件并发现只包含 classes.dex 文件和 .so 库文件。要启用此功能，请勾选“在本机代码中嵌入程序集”框（这可能仅适用于企业订阅者）。

# c++ - 初始化不正确的值错误样式后是否引发异常？

> ID：13352452
> 
> 赞同：3
> 
> 时间：2012-11-12T22:15:00.283
> 
> 标签：c++, exception, initialization

以下定义是不好的风格还是完全错误的？也就是说，在初始化一个被认为不正确的值*之后抛出是错误的吗？*

```
myClass::myClass(int arg) : value(arg)
   {
    if (value < 0)
       throw (myException("Negative value not allowed!"));
   } 
```

*似乎最好使用初始化器列表而不是在正文中分配值，据我所知，如果我在分配值之后*或*之前*抛出并不重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:42:51.390

如果参数不在有效范围内，则允许使用初始化器列表并在初始化值之前抛出的替代方法：

```
inline int RequirePositive(int value)
{    
    if (value < 0) throw (myException("Negative value not allowed!"));
    return value;
}

class myClass {
    myClass(int arg) : value(RequirePositive(arg)) {}
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T22:21:09.157

如果`value`>= 0 是类不变量，那么您实际上只有几种可能性。一种是编写 ctor 来接受`unsigned`参数，因此值 <0 根本不可能。另一种是抛出异常。

但是，是的，如果用户传递了一个您无法从中创建有效对象的值，那么抛出异常是完全可以接受的（而且通常是正确的做法）。构造函数的职责是创建一个有效的对象。如果它传递了一个无法从中创建有效对象的值，那么异常通常是正确的响应。

至于*何时*抛出异常：至少在这种情况下，这并不重要。该异常将回滚当前对象的创建，因此它永远不会存在。如果首先测试值要快得多，而不是复制值然后在它无效时销毁它，它可能会有所作为。这样的事情`int`几乎无关紧要。例如，如果您有一棵大树，并且可以通过仅查看树的根节点来判断它是否有效，那么最好先检查该节点，然后只复制三个如果它是有效的。

后者显然是一种优化，但它可以是一个足够大和足够简单的优化，即使没有分析也可能是值得的（可以说，它只是避免悲观化而不是优化）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T22:21:14.243

您正在为内置类型使用初始化列表，您没有获得任何性能优势，所以为什么不在构造函数体内检查后对成员变量进行赋值。在您的情况下，您创建了一半的非法对象而不是创建了一半的合法对象。那么为什么要给对象任何无效状态，只是为了稍后被销毁。

从构造函数抛出异常是可以的（在大多数情况下，析构函数不是这样）。如果您不能对它们传入的值做任何有意义的事情，即将任何负值变为 0，那么抛出异常似乎是应该做的事情，毕竟您无法创建合法对象。

您可以使用无符号整数吗？0 到 4,294,967,295。使调用者更明确地知道该值必须大于 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:23:01.507

除非该类在紧密循环中多次初始化，否则额外功能的性能损失可以忽略不计。与未正确初始化的类所能造成的损害相比，这是一个非常小的代价！特别是考虑到“坏值”可能是用户输入的结果，因此产生的问题可能难以报告/故障排除

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-12T23:38:38.497

我不会这样做。只需使用使用您的课程的人会理解这是使用它的合理原因的方法。

# c# - 构建错误，警告 MSB3258

> ID：13352456
> 
> 赞同：6
> 
> 时间：2012-11-12T22:15:07.907
> 
> 标签：c#, msbuild, build-error

我最近将我的解决方案从使用 vs2010 pro sp1 的主开发机器移到了新机器上。除了构建失败之外，设置应该是相同的。

它给出的错误像

> c:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1360,9)：警告 MSB3258：主要参考“C:\rep\hms\trunk\ikassystemv3\ikasDAL\bin\Debug\ ikasDAL.dll”无法解析，因为它间接依赖于 .NET Framework 程序集“mscorlib，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”，其版本“4.0.0.0”高于版本当前目标框架中的“2.0.0.0”。

然而，所有有问题的库都设置为使用 .net 2 框架，我需要这种方式，否则它会破坏使用它们的东西。

但是由于某种原因，它似乎认为我的 .net 2 系统库以某种方式引用了 .net 4 的东西。所有引用的库都是 .net 2

你可以在这里看到我的构建输出

> [http://tinyurl.com/bnugru4](http://tinyurl.com/bnugru4)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:38:13.330

我在使用 CopyLocal 项目引用并在依赖项目（即 ikasDAL.dll）上更改目标框架（即 .NET 4 到 2）时看到了这个问题。

如果是这种情况，删除输出文件夹（即 C:\rep\hms\trunk\ikassystemv3\ikasDAL\bin\Debug）并重建应该可以解决整个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:56:57.407

从日志来看，确实有人在 4.0 中编写了 ikasDAL.dll，因为它依赖于 System.Xml.Linq 等 2.0 框架中不存在的东西。

从表面上看，我会说有人人为地将 ikasDAL.dll 设置为 2.0，而没有意识到它依赖于什么。如果是这种情况，那么我认为你有一个更大的问题。

或者，ikasDAL 最近设置为 4.0，您已将其重置回 2.0，但未修复它的依赖项。

* * *

我首先手动清理所有 bin 目录（基本上删除它们）。然后我会查看每个单独的项目以确保它确实设置为 2.0。最后，我会一次构建每个项目，直到遇到问题。

# coldfusion - 如何检索 enablecfoutputonly 的当前值？

> ID：13352459
> 
> 赞同：5
> 
> 时间：2012-11-12T22:15:14.450
> 
> 标签：coldfusion, coldfusion-9

我们正在使用 Coldfusion 9。

是否有一种简单的方法可以知道在特定请求期间 enablecfoutputonly 是否已设置为 true？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T00:55:14.270

我现在无法使用 CF9 进行测试，但在 CF10 中，可以`getPageContext()`通过检查输出对象来访问它：

```
<cfscript>
   out = getPageContext().getOut();
   // Is the cfsetting enablecfoutputonly value currently true?
   isSettingEnabled = out.getDisableCount() >  0;
   WriteOutput("isSettingEnabled="& isSettingEnabled &"<br>");
   // Is output currently allowed?
   isOuputtingEnabled = out.getDisableCount() == 0 || out.getOutputCount() > 0;
   WriteOutput("isOuputtingEnabled="& isOuputtingEnabled &"<br>");
</cfscript> 
```

..或使用反射：

```
<cfscript>
    out = getPageContext().getOut();
    internalMethod = out.getClass().getDeclaredMethod("isOutputEnabled", []);
    internalMethod.setAccessible( true );
    isOuputtingEnabled = internalMethod.invoke( out, [] );
   // is output currently allowed?
    WriteOutput("isOuputtingEnabled="& isOuputtingEnabled);
</cfscript> 
```

# asynchronous - F# 异步工作流中的 TcpClient.ConnectAsync 或 BeginConnect/EndConnect

> ID：13352464
> 
> 赞同：3
> 
> 时间：2012-11-12T22:15:33.720
> 
> 标签：asynchronous, f#

[TcpClient.ConnectAsync](http://msdn.microsoft.com/en-us/library/hh194211.aspx)是一个任务，它不适用于 F# 异步工作流。

我想我在这里遗漏了一些非常简单的东西——有没有一种通用的方法来使用工作流中的 Async 或 Begin/End 函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T22:17:32.503

看看[`Async.AwaitTask`](http://msdn.microsoft.com/en-us/library/ee837067.aspx)和[`Async.FromBeginEnd`](http://msdn.microsoft.com/en-us/library/ee370564.aspx)。

通常这会起作用：

```
async {
  ...
  do! client.ConnectAsync(address, port) |> Async.AwaitTask
} 
```

但是，由于该`Async`模块只能直接使用`Task<'T>`并`ConnectAsync`返回`Task`，因此在这种特殊情况下所需的代码会稍长一些：

```
do! client.ConnectAsync(address, port) |> Async.AwaitIAsyncResult |> Async.Ignore 
```

或者

```
let! _ = client.ConnectAsync(address, port) |> Async.AwaitIAsyncResult 
```

# c++ - Intellisense“切换完成模式”不适用于 Visual Studio 2010 Professional 中的 C++

> ID：13352466
> 
> 赞同：13
> 
> 时间：2012-11-12T22:15:43.853
> 
> 标签：c++, visual-studio, intellisense

我在 Visual Studio 2010 Professional 的“编辑”->“智能感知”选项卡下的“切换完成模式”出现问题。图片很好地描述了它。

![](../Images/97fad4ecba806e0b1aba77485b2e2bc8.png)

完成模式在 C# 中运行良好。请帮忙。

先感谢您！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-23T18:44:30.013

无法在 C++ IntelliSense 上打开建议模式（在 VS 2010 和 2012 中）。

[MSDN 库](http://msdn.microsoft.com/en-us/library/exbffbc2%28v=VS.100%29.aspx)（适用于 VS 2010）说：

> 建议模式在 Visual Basic 和 C# 中可用。

据报道（[链接](http://connect.microsoft.com/VisualStudio/feedback/details/764172/vs-2012-rtm-intellisense-bug-in-c)）作为 VS 2012 RTM 中的一个错误，微软的回答是：

> C++ Intellisense 只有一种完成模式，而 VB 和 C# Intellisense 有两种不同的完成模式。因此，此用于在完成模式之间切换的命令不适用于 C++ Intellisense。

如果您在忘记按 ESC 时按空格后插入不需要的代码而感到恼火，您可以使成员列表仅在按 ctrl+空格（或 alt+右箭头）后显示。为此，请转到`Tools -> Options -> Text Editor -> C/C++ -> General`并取消选中`Auto list members`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-10T02:57:33.487

我知道这是很久以前发布的，但我想我会提供我的解决方案。我将快捷方式更改为不像 ctrl + 空格那么烦人的东西。您可以在选项 -> 键盘 -> Edit.CompleteWord 中执行此操作。

希望这可以帮助某人。

# php - 创建 PHP 脚本以接收 ID 并返回信息

> ID：13352468
> 
> 赞同：0
> 
> 时间：2012-11-12T22:16:14.620
> 
> 标签：php, xml, return

我有一个客户端，他需要能够在我的服务器上运行一个脚本，为脚本提供一个 ID 号，然后接收一个包含有关该 ID 信息的 XML 字符串。例如，他会向“www.mywebsite.com?uid=424”发送一个请求，然后收到一个可能看起来像这样的 xml 字符串：

```
<client>
    <clientID>424</clientID>
    <clientName>ABC123</clientName>
    <contact>Joe Schmoe</contact>
</client> 
```

我以前从未这样做过，所以我想知道它是否像获取 ID 号、运行查询以获取所有信息然后打印 xml 数据一样简单，或者是否有某种数据返回功能像这样的事情。我试图用谷歌搜索它，但找不到任何东西......可能是因为我没有在寻找正确的东西。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:17:47.033

获取 url 参数`$_GET`：

```
<?php
$id = $_GET['uid'];
?>
<client>
    <clientID><?php echo $id; ?></clientID>
    <clientName>ABC123</clientName>
    <contact>Joe Schmoe</contact>
</client> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:18:28.680

简单地说——是的。

更复杂 - 取决于对方正在寻找什么样的请求。如果他们可以接受 html，那么是的，你就完成了。如果他们需要另一种类型的输出 - 您可能需要更改您的内容类型标头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:25:06.500

您可以根据需要使其变得简单。我会这样做：

```
<?php
 //Your sql connection
 $db = new PDO("mysql:dbname=testdb;host=127.0.0.1", "user", "pass");

 //Get the id from the url and cast it to an integer
 $id = (int) $_GET['id'];

 //select the stuff from your database
 $q = $db->prepare("SELECT `name`,`id`,`contact` FROM `blabla` WHERE id = ?");
 $q->execute( array( $id ) );
 $client = $q->fetch(2);

 //Output as xml
 header("Content-type: text/xml; charset=utf-8");
 echo 
"<?xml version="1.0"?>
  <client>
    <clientID>{$client['id']}</clientID>
    <clientName>{$client['name']}</clientName>
    <contact>{$client['contact']}</contact>
</client>"; 
 exit; 
```

# c# - 在 HttpHandler 中写为构建表？

> ID：13352469
> 
> 赞同：0
> 
> 时间：2012-11-12T22:16:19.470
> 
> 标签：c#, memory-leaks, httphandler, export-to-excel, large-files

我必须将非常大的文件导出为“excel 导出”。由于 .NET 无法导出 excel 文件，所以我使用了简单的 html 表。

它工作正常，但速度很慢。

是否可以在创建每一行时对每一行进行 context.response.write，而不是构建一些超大的字符串并在完成后尝试导出整个内容？

我不太关心使用什么函数来执行此操作，但我希望你知道我的意思。我不想将一个字符串构建到内存中，然后尝试一次全部发送。我宁愿在建表时导出。

这可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:58:30.823

是的，在每一行上使用 context.Response.Write 就可以了。如果不想构建大字符串的原因是服务器内存使用，那么您需要像这样关闭响应缓冲：

```
context.Response.BufferOutput = false; 
```

否则，无论如何，.NET 只会将您的写入缓冲到内存中，直到最后。

如果原因是执行时间，那么您可能会遇到来自多个字符串连接的性能影响。在这种情况下，您可以改用 StringBuilder 类来构造表。

例如...

```
StringBuilder sb = new StringBuilder();
for each (<row in database>) {
    sb.AppendLine(<current table row>);
}
context.Response.Write(sb.ToString()); 
```

有关响应缓冲的更多信息：http: [//msdn.microsoft.com/en-us/library/system.web.httpresponse.bufferoutput.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.bufferoutput.aspx)

有关 StringBuilder 类的更多信息：http: [//msdn.microsoft.com/en-us/library/system.text.stringbuilder (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx)

# c# - 在 WinRT 中使用触控绘图

> ID：13352475
> 
> 赞同：1
> 
> 时间：2012-11-12T22:16:56.617
> 
> 标签：c#, .net, vb.net, touch, windows-runtime

我正在使用以下示例。[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.input.pointereventhandler?cs-save-lang=1&cs-lang=vb#code-snippet-1](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.input.pointereventhandler?cs-save-lang=1&cs-lang=vb#code-snippet-1)

我尝试用几种不同的方式对其进行修改，但无法使触摸工作在屏幕上进行绘制。

程序在此功能上失败

```
Public Function InkCanvas_PointerPressed(sender As Object, e As PointerRoutedEventArgs)

    'Get information about the pointer location
    Dim pt As PointerPoint = e.GetCurrentPoint(panelcanvas)
    _previousContactPt = pt.Position

    'Accept input only from a pen or mouse with a left button pressed
    Dim pointerDevType As PointerDeviceType = e.Pointer.PointerDeviceType

    If ((pointerDevType = PointerDeviceType.Pen Or pointerDevType = PointerDeviceType.Mouse) And pt.Properties.IsLeftButtonPressed) Then
        'Pass the point information to the inkmanager

        _inkManager.ProcessPointerDown(pt)
        _penID = pt.PointerId
        e.Handled = True

    ElseIf (pointerDevType = PointerDeviceType.Touch) Then

        _touchID = pt.PointerId
        _inkManager.ProcessPointerDown(pt) '<-- error happens here

        e.Handled = True

    End If

    Return Nothing
End Function 
```

我收到以下错误消息 = TabletPC 墨迹错误代码。_inkManager.ProcessPointerDown(pt) 行上的初始化失败（HRESULT 异常：0x80040223）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:58:05.253

我在以下位置找到了一个解决方案：[http](http://www.c-sharpcorner.com/uploadfile/269510/metro-style-paint-application/) ://www.c-sharpcorner.com/uploadfile/269510/metro-style-paint-application/ 在这个例子中，他刚开始画画。所以我修改了上述程序并删除了 inkManager 选项，现在我可以用手指绘图了。

```
Public Function InkCanvas_PointerPressed(sender As Object, e As PointerRoutedEventArgs)

    'Get information about the pointer location
    Dim pt As PointerPoint = e.GetCurrentPoint(panelcanvas)
    _previousContactPt = pt.Position

    'Accept input only from a pen or mouse with a left button pressed
    Dim pointerDevType As PointerDeviceType = e.Pointer.PointerDeviceType

    If ((pointerDevType = PointerDeviceType.Pen Or pointerDevType = PointerDeviceType.Mouse) And pt.Properties.IsLeftButtonPressed) Then
        'Pass the point information to the inkmanager

        _inkManager.ProcessPointerDown(pt)
        _penID = pt.PointerId
        e.Handled = True

    ElseIf (pointerDevType = PointerDeviceType.Touch) Then
        '_inkManager.ProcessPointerDown(pt)

        Dim NewLine As Line = New Line
        NewLine.X1 = e.GetCurrentPoint(panelcanvas).Position.X
        NewLine.Y1 = e.GetCurrentPoint(panelcanvas).Position.Y
        NewLine.X2 = NewLine.X1 + 1
        NewLine.Y2 = NewLine.Y1 + 1
        NewLine.StrokeThickness = 4.0
        NewLine.Stroke = New SolidColorBrush(Colors.Red)
        panelcanvas.Children.Add(NewLine)
        _touchID = pt.PointerId
        e.Handled = True

    End If

    Return Nothing
End Function 
```

# c - 数组 - 错误：赋值中的类型不兼容

> ID：13352479
> 
> 赞同：2
> 
> 时间：2012-11-12T22:17:16.590
> 
> 标签：c

我有一个问题，我认为可能有一个简单的答案，但我没有在任何地方找到任何文件来证实我的怀疑。

我的程序是将两个方阵相乘，整个代码有点长，所以我只是将相关部分粘贴在下面。编译代码时，我不断收到“错误：分配中的类型不兼容”消息。我正在尝试用 a、b 和 c 的相应部分分配子矩阵 suba、subb、subc。这是因为我使用变量 v 和 w int 第 28 - 32 行吗？另外，为了确保我有正确的概念，如果我将矩阵的左上角分配给“子矩阵”，那么我只是分配一个指针（例如 subb）从大的指定位置开始矩阵，对吧？

在此先感谢您的帮助！非常感谢

```
struct threads
{
  pthread_t id; //The thread id to use in functions
  int n; //size of block
  float **suba; //Sub-matrix a
  float **subb; //Sub-matrix b
  float **subc; //Sub-matrix c
};

int main( int argc, char* argv[ ] )
{
  int n; // dimension of the matrix
  int p; // number of threads in the program
  float *sa, *sb, *sc; // storage for matrix A, B, and C
  float **a, **b, **c; // 2-d array to access matrix A, B, and C
  int i, j;
  struct threads* t;

  t = ( struct threads* ) malloc( p * sizeof( struct threads ) );

  int x = -1;
  int z;
  for( z = 0; z < p; z++ )
  {
    t[ z ].n = n / sqrt( p );
    if( fmod( z, sqrt( p ) ) == 0 )
      x++;
    int w = ( int )( x * n / sqrt( p ) );
    int v = ( int )( fmod( z, sqrt( p ) ) * n / sqrt( p ) );
    t[z].suba = a[ w ][ v ];
    t[z].subb = b[ w ][ v ];
    t[z].subc = c[ w ][ v ];

    //pthread_create( &t[ z ].id, 0, threadWork, &t[ z ] );
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:20:10.573

`t[z].suba`是类型`float **`

`a[w][v]`是类型`float`。

你的意思是

```
t[z].suba[w][v] = a[w][v]; ? 
```

# c# - 逆向工程串行命令

> ID：13352485
> 
> 赞同：8
> 
> 时间：2012-11-12T22:17:45.813
> 
> 标签：c#, serial-port, hex, reverse-engineering, x10

# tl;博士;

我需要做的是对串行命令进行逆向工程，这样我就可以弄清楚**人类可读**值或**二进制**值是如何被序列化为原始串行命令的。

IE：

```
if
   66 = 'A1' or '0110 1'
   6e = 'A2' or '0110 2'
   e6 = 'B1' or '1110 1'
   ee = 'B2' or '1110 2'
then
   what is A3 or B3, etc. 
```

* * *

我正在为一个开源自动化项目做一个包装器。

有一种发送`raw`命令的方法，理论上可以将多个命令串在一起。
我已经嗅探了一些串行命令，这就是它们的样子。

```
[init] [HouseCode | DeviceCode] [ready] [HouseCode | FunctionCode]   

04 66 06 62       // A1 ON
04 6e 06 62       // A2 ON 
04 62 06 62       // A3 ON
04 6a 06 62       // A4 ON
04 61 06 62       // A5 ON
04 69 06 62       // A6 ON
04 65 06 62       // A7 ON
04 6d 06 62       // A8 ON
04 67 06 62       // A9 ON
04 6f 06 62       // A10 ON
04 63 06 62       // A11 ON
04 6b 06 62       // A12 ON
04 60 06 62       // A13 ON
04 68 06 62       // A14 ON
04 64 06 62       // A15 ON
04 6c 06 62       // A16 ON

04 e6 06 e2       // B1 ON 
04 ee 06 e2       // B2 ON  
04 e2 06 e2       // B3 ON 
04 ea 06 e2       // B4 ON 
....
04 ec 06 e2       // B16 ON
04 66 06 63       // A1 Off
04 e6 06 e3       // B1 Off

04 66 06 61       // All A lights On (using A1 as the starting point)
04 e6 06 e1       // All B lights On (using B1 as the starting point)
04 66 06 66       // All A lights Off (using A1 as the starting point)
04 e6 06 66       // All B lights Off (using A1 as the starting point)

04 66 06 64 2a    // A1 Dim 20
04 66 06 64 2c    // A1 Dim 21
04 66 06 64 2e    // A1 Dim 22

04 66 06 65 2a    // A1 Bright 20
04 66 06 65 69    // A1 Bright 50 
```

我需要做的是对此进行逆向工程，以便我可以通过编程方式进行串行调用，或者更好的是，弄清楚**人类可读**值或**二进制**值是如何被序列化为原始串行命令的。

*是的，我可以嗅探所有命令并分别存储每个值，但我想知道这是如何完成的。*

这是我目前的观察。

1.  通话分为两个。
    *   `04`启动并告诉设备要查找的内容
    *   `**`告诉系统哪个设备正在被控制 [ `HouseCode`& `DeviceCode`]
    *   返回十六进制`55`以告诉您它已准备好
    *   `06`被启动并告诉设备会发生什么
    *   `**`告诉系统房屋代码和命令 [ `HouseCode`& `FunctionCode`]
        *   `**`是可选发送的，并且是一个介于 0 和 100 之间的值，用于参考暗淡级别
    *   hex`55`被再次发送回来告诉你它已经准备好了
2.  第二对使用第一个字符作为字母代码（`HouseCode`= A、B、C 等），第二个字符是地址（`DeviceCode`= 1、2、3 等）
    *   有了这些信息，我个人的猜测是......
        *   `6`必须直接对应`A`
        *   `e`必须直接对应`B`
3.  第四对开头与`HouseCode`第二对相同
4.  第四对以`FunctionCode`
    *   1 = 全部开启
    *   2 = 开
    *   3 = 关闭
    *   4 = 暗淡
    *   5 = 明亮
    *   6 = 全部关闭
    *   ETC..
5.  第五对仅显示在亮/暗命令上，代表 0 到 100 之间的数字

最后，在文档中，每个命令都与二进制数据相关，因此可能**不是**转换`A1`为`hex`，而是转换`binary`为`hex`。

```
HouseCode       DeviceCode      Binary Value
    A               1               0110
    B               2               1110
    C               3               0010
    D               4               1010
    E               5               0001
    F               6               1001
    G               7               0101
    H               8               1101
    I               9               0111
    J               10              1111
    K               11              0011
    L               12              1011
    M               13              0000
    N               14              1000
    O               15              0100
    P               16              1100

FunctionCode                    Binary Value
All Units Off                   0000
All Lights On                   0001
On                              0010
Off                             0011
Dim                             0100
Bright                          0101
All Lights Off                  0110
Extended Code                   0111
Hail Request                    1000
Hail Acknowledge                1001
Pre-set Dim (1)                 1010
Pre-set Dim (2)                 1011
Extended Data Transfer          1100
Status On                       1101    
Status Off                      1110
Status Request                  1111 
```

* * *

有谁知道我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T14:21:30.920

[Heyu](http://www.heyu.org/)是一款出色的开源应用程序，可用于 X10 设备。他们基于 X10 的原始文档发布了一个非常全面的[X10 协议规范。](http://www.heyu.org/docs/protocol.txt)

这应该可以消除您的工作中的猜测工作。重要的是 housecode 和 unitcode 是静态映射，无法计算。协议规范准确地指定了比特流是如何形成的。例如

```
PC      Interface   Description
0x04,0x66           Address A1
        0x6a        Checksum ((0x04 + 0x66)&0xff)
0x00                OK for transmission.
        0x55        Interface ready.

0x86,0x64           Function: A Dim 16/22*100%
        0xea        Checksum ((0x86 + 0x64)&0xff)
0x00                OK for transmission.
        0x55        Interface ready. 
```

# objective-c - 将今天的日期设置为 NSDate

> ID：13352488
> 
> 赞同：1
> 
> 时间：2012-11-12T22:17:55.270
> 
> 标签：objective-c, ios, nsdate

我有一个 NSDate 属性，如下所示，我希望将其设置为今天的日期。

```
@property (nonatomic, copy, readwrite) NSDate *todayDate; 
```

我尝试了以下方法，但出现错误：

```
NSDate *date = [[NSDate alloc] init];
self.todayDate = [date isToday]; 
```

我猜，isToday 只是检查日期是否是今天的日期，并没有设置日期。

我收到以下 2 个错误：

```
Implicit conversion of 'BOOL' (aka 'signed char') to 'NSDate *' is disallowed with ARC
Incompatible integer to pointer conversion assigning to 'NSDate *' from 'BOOL' (aka 'signed char'); 
```

如何在 Objective C 中将 NSDate 设置为今天的日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:22:04.573

[NSDate](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/doc/uid/20000188-date)为您提供：

```
NSDate *today = [NSDate date]; 
```

这是 Apple 框架中的常见模式：语义“工厂”类方法。此调用取代了您对 alloc 和 init 的调用，并且是处理公共对象的首选方式。在你自己的类中模拟也是一个很好的模式:-)

应该阐明“为什么”的核心概念之一是不变性。许多对象（NSString、NSNumber 等）被认为（至少在实践中）是不可变的。这意味着它们只获得一次值：在初始化期间。这导致“其他”答案也是一种实例化时间技术：[自定义初始化程序](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/doc/uid/20000188--initWithTimeIntervalSinceNow_)。

```
NSDate *today = [[NSDate alloc] initWithTimeIntervalSinceNow: 0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:21:40.433

这会将您的财产设置为今天的日期。正如您所怀疑的，该错误是因为您正在为指针分配一个布尔值。

```
self.todayDate = [NSDate date]; 
```

# objective-c - iOS Wifi 信号强度

> ID：13352496
> 
> 赞同：3
> 
> 时间：2012-11-12T22:18:51.677
> 
> 标签：objective-c, ios, ios5, ios6, wifi

我有一个企业应用程序（没有应用程序商店评论），我想获取 wifi 信号的当前强度。这是出于故障排除目的，我想在我们记录消息或错误时确定实际的 wifi 信号强度。

我可以使用私有 API，但更喜欢受支持的方法。我发现了一些指向 Stumbler 的例子，但这似乎已经过时了。

# delphi - Delphi - 从 TImageList 获取位图

> ID：13352497
> 
> 赞同：4
> 
> 时间：2012-11-12T22:18:53.470
> 
> 标签：delphi, delphi-xe

我正在将图像添加到像这里这样的图像列表 -[使用 Delphi XE 在运行时将 png 图像添加到图像列表](https://stackoverflow.com/questions/4221597/add-a-png-image-to-a-imagelist-in-runtime-using-delphi-xe/4618630#4618630)。从此列表中获取位图并将其保存到硬盘驱动器时会出现问题。

```
bmp:=tbitmap.create;
imagelist.getbitmap(0,bmp);
bmp.savetofile() 
```

这发生在很多白色 bmp 文件和几个带有“图像”的文件中。它应该非常容易，但我不明白出了什么问题。

LE：这个例子更像是伪代码。代码如下：

填写清单

```
 FImageList := TImageList.Create(nil);
   FImageList.Masked:=false;
   FImageList.ColorDepth:=cd32bit;
   FImageList.SetSize(32,32);//I am sure that all images are 32x32
   while not dsTemp.eof do//dstemp is a Tdatasetdescendant
    begin
     ststream := dsTemp.CreateBlobStream(dsTemp.FieldByName('FLAG'), bmRead);

     pngImage := TPngImage.Create;
     pngImage.LoadFromStream(ststream);

     btBitmap := TBitmap.Create;
     btBitmap.PixelFormat := pf32bit;
     btBitmap.Width := pngImage.Width ;
     btBitmap.Height := pngImage.Height ;
     pngImage.AssignTo(btBitmap);
     btBitmap.AlphaFormat:=afIgnored;

     res := FImageList.Add(btBitmap,nil);
//     pngImage.savetofile('C:\a\'+inttostr(res)+'.png');-works. image is ok
//     btBitmap.savetofile('C:\a\'+inttostr(res)+'.bmp');-works. image is ok
     dsTemp.Next;
     freeandnil(btBitmap);
     freeandnil(pngImage);
    end; 
```

加载位图的问题

```
 for iPos := 0 to FImageList.Count-1 do
  begin
     btBitmap := tbitmap.create;
     FImageList.GetBitmap(iPos,btBitmap);
     btBitmap.savetofile('C:\a\'+inttostr(iPos)+'thr.bmp');//creates the bitmap, but it is white
  end; 
```

问题结束后编辑：请多投反对票！谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T08:02:20.530

根据[Uwe Raabe 的](https://stackoverflow.com/users/26833/uwe-raabe)回答，我让它工作。解决方案：

```
 for iPos := 0 to FImageList.Count-1 do
  begin
     btBitmap := tbitmap.create;
     btBitmap.PixelFormat := pf32bit;
     btBitmap.AlphaFormat := afIgnored;
     FImageList.GetBitmap(iPos,btBitmap);
     btBitmap.savetofile('C:\a\'+inttostr(iPos)+'thr.bmp');
  end; 
```

现在位图已正确保存。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T22:39:26.433

如果您可以举例说明不起作用的图像，那肯定会有所帮助。同时，您可以尝试使用以下代码：

```
bmp.PixelFormat := pf32bit;
bmp.AlphaFormat := afDefined;
ImageList.GetBitmap(0, bmp); 
```

# eclipse - m2e 和 Maven 配置文件

> ID：13352498
> 
> 赞同：1
> 
> 时间：2012-11-12T22:18:56.053
> 
> 标签：eclipse, maven, m2eclipse

[我已经按照Maven 站点](http://maven.apache.org/guides/mini/guide-multiple-repositories.html)上的建议设置了一个 Maven 配置文件

```
<activeProfiles>
     <activeProfile>awayFromArchiva</activeProfile>
</activeProfiles> 
```

现在，当 Maven 尝试从不可用的 Archiva 存储库下载时，我可以使用此配置文件在构建期间停止错误。我可以在命令行上成功编译。使用命令行我得到

```
[INFO] Unable to find resource 'xyz' in repository central (http://repo1.maven.org/maven2) 
```

在成功构建期间。Eclipse 中给出了类似的消息，但作为错误抛出。

该配置文件确实按预期工作，因为我`settings.xml`为不同配置文件指定的 Archiva 实例被忽略，但相同的目标会产生非常不同的结果。

您如何确保其`m2e`行为与`mvn`命令行相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:29:18.143

在 Eclipse 中，转到`Windows -> Preferences -> Maven -> User Settings`并更改您的用户设置以指向`settings.xml`您的命令提示符 maven 使用的本地。

Eclipse m2e 使用嵌入式maven 安装，你可以点你的eclipse 使用你本地的maven 安装。

希望能帮助到你。

# php - 将所选月份与数据库中保存的日期进行比较

> ID：13352499
> 
> 赞同：1
> 
> 时间：2012-11-12T22:18:59.263
> 
> 标签：php, mysql, codeigniter

我的代码的想法是获取表中发生在特定月份和年份的所有更新行，例如更新发生在：2012 年 5 月。因为我有 2 个显示月份和年份的下拉菜单，我希望当我选择月份和年份时，将显示在选定月份和年份发生的所有更新行。有没有人可以帮助我解决这个问题的想法，我会很高兴。提示：数据库中存储的日期格式为（Ymd）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:40:47.680

提示：不要给我们提示，但要讲整个故事。

您的问题的可能解决方案（适用于 php 5.3+）：

```
<?php
  $startDate = date("Y-m-d", strtotime("first day of the month", strtotime( (int) $_POST['year']."-".(int)$_POST['month'].-"01 00:00")));
  $endDate = date("Y-m-d", strtotime("last day of the month", strtotime( (int) $_POST['year']."-".(int)$_POST['month'].-"01 23:59")));

  $db = ; //your PDO connection

  $q = $db->prepare("SELECT `thingstoselect` FROM `yourtable` WHERE `date` > ? && `date` < ?");
  $q->execute( array( $startDate, $endDate));

  $yourResults = $q->fetchAll(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:42:23.293

您是将其存储为 varchar 还是日期？

如果将其存储为日期列，则可以将 $year 和 $month 变量与：

`select * from TABLE where year(datecol) > $year or (year(datecol) = $year and month(datecol) >= $month);`

如果它是子字符串，您将不得不为大于做一​​些有趣的转换，但您可以使用子字符串来查找完全匹配：

`select * from TABLE where substring_index(stringcol,'-',1) > $year or ( substring_index(stringcol,'-',1) = $year and substring_index(substring_index(stringcol,'-',2),'-',-1) >= $month );`

问题是 MySQL 没有内置字符串拆分功能。

# objective-c - 使用带有 UITextView 的特定键盘的错误

> ID：13352501
> 
> 赞同：2
> 
> 时间：2012-11-12T22:19:08.380
> 
> 标签：objective-c, ios, cocoa-touch, uitextfield, uitextview

我使用“单一视图”应用程序模板启动了一个 Xcode 项目，并在 viewDidLoad 中的模板创建的 ViewController 类中添加了两行：

```
UITextView *textView = [[UITextView alloc] initWithFrame:CGRectInset(self.view.bounds, 10, 10)];
[self.view addSubview:textView]; 
```

在模拟器中，我启用了“简体中文”“笔画”键盘。

当我使用 UITextView，切换到这个键盘，并触摸`^_^`按键时，控制台出现以下错误：

```
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextDrawLinearGradient: invalid context 0x0
<Error>: CGContextSetFillColorWithColor: invalid context 0x0
<Error>: CGContextFillRects: invalid context 0x0
<Error>: CGContextFillRects: invalid context 0x0
<Error>: CGContextSetFillColorWithColor: invalid context 0x0
<Error>: CGContextFillRects: invalid context 0x0
<Error>: CGContextSaveGState: invalid context 0x0
<Error>: CGContextDrawLinearGradient: invalid context 0x0
<Error>: CGContextSetFillColorWithColor: invalid context 0x0
<Error>: CGContextFillRects: invalid context 0x0
<Error>: CGContextFillRects: invalid context 0x0
<Error>: CGContextSetFillColorWithColor: invalid context 0x0
<Error>: CGContextFillRects: invalid context 0x0 
```

这是一个错误吗？我应该担心吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:40:00.880

我已经在 iOS 6.0 模拟器和运行 iOS 6.0.1 的 iPhone 4S 上重现了该错误，但在 iOS 5.0 模拟器中并没有发生。这是 iOS 6 中的一个错误。您应该在[http://bugreport.apple.com](http://bugreport.apple.com)上打开一个错误报告。

也就是说，它似乎并没有特别有害，所以我不会担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T07:12:29.693

当我启用“简体中文”键盘时，它也发生在 iOS 7.0.3 模拟器中。

但在iOS 7.1 模拟器和iOS 8 模拟器中消失了。

# iphone - 从 UITableViewController 切换到新的 UITabBarController

> ID：13352503
> 
> 赞同：0
> 
> 时间：2012-11-12T22:19:18.957
> 
> 标签：iphone, uitabbarcontroller, uitableview

我知道要从一个 TableViewController 转到一个新的 TabBarController，您可以使用 Storyboard 中的“segue”并添加以下代码：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    UITabBarController *tabController = (UITabBarController *) segue.destinationViewController;
    ViewController *vc = (ViewController *) [[tabController viewControllers] objectAtIndex:0];
} 
```

但我的问题是我不能使用“segue”、情节提要或方法 -prepareForSegue:sender:

我的问题是，如何通过代码从 TableViewController 传递到我的新 TabBarController？

**解决**

我使用了方法 -performSegueWithIdentifier:sender:

在情节提要中，我从源 viewController（网格视图）控制拖动到目标 TabBarController。

在我的 Grid 的 -didSelectRow 方法中，我调用 -performSegueWithIdentifier:sender: thats trigger -prepareForSegue:sender: 等来实现完成该过程所需的代码

# apache-flex - IE 8.0.7601 中的组合框未填充到 flex 中

> ID：13352504
> 
> 赞同：3
> 
> 时间：2012-11-12T22:19:33.047
> 
> 标签：apache-flex, combobox

我们一直面临在 IE 的下拉/组合框中显示状态列表的问题。我们确实有 1 个 REST Web 服务，它从 Constant.java 文件中读取状态字符串值列表并返回到 Flex命令; 这又是组合框的数据提供者。弹性代码如下；在 callback() 中，我们只是将响应列表中的元素推送到对象中。

```
private function loadStates():void
{
    model.stateCode=new Array();
    model.statesArr=new Array();
    var obj:Object=new Object();
    var objOne:Object=new Object();
    obj={label: "Select", tip: "Select the state"};
    objOne={label: "Select State", data: "Select State"};
    model.stateCode.push(obj);
    model.statesArr.push(objOne);
    for (var i:int=0; i < model.stateDetail.length; i++)
    {
        obj={"label": model.stateDetail[i].stateCode, "tip":                                                                        
            model.stateDetail[i].stateDecsription};
        objOne={"label": model.stateDetail[i].stateCode + '-' + 
            model.stateDetail[i].stateDecsription, "data":  
            model.stateDetail[i].stateCode};
        model.stateCode.push(obj);
        model.statesArr.push(objOne);
    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T11:14:30.787

可能是一个简单的答案，但由于 Array 没有刷新选项，我有时注意到最好先完全填充 Array，然后将其作为 dataProvider 应用到您正在工作的任何列表/组合框和。有时每次更新 Array 时都必须这样做。

否则，也许尝试使用 ArrayCollection，然后在填充后使用 .refresh()

布赖恩

# sql - 如何将数据库中两个表中的数据放在一起？

> ID：13352511
> 
> 赞同：0
> 
> 时间：2012-11-12T22:19:53.963
> 
> 标签：sql, select

我在数据库中有两个表，就像这样（为了问题而简化）：

![我有两张桌子](../Images/b40616ed2bcdfe8a1ff0fa7fb4546e67.png)

我不想修改现有表或创建新表，但我想将所有这些数据放入我的代码中的合并对象中，如下所示：

![我想要的数据](../Images/df13b38577af5ed9f2bb032baa861be1.png)

TABLE2 实际上有更多属性，但我只对食物和颜色感兴趣。

我对数据库完全陌生，所以请耐心等待 - 有没有简单的方法可以做到这一点？到目前为止我在想什么

```
SELECT * FROM TABLE1

SELECT PROPERTY_VALUE, UNIQUE_IDENTIFIER 
FROM TABLE2 
WHERE PROPERTY_NAME = 'Favorite Color'

SELECT PROPERTY_VALUE, UNIQUE IDENTIFIER 
FROM TABLE2 
WHERE PROPERTY_NAME = 'Favorite Food' 
```

然后以某种方式将它们放在一起......有更好的方法吗？或者如果没有，我从这里去哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T22:26:51.810

有几种方法可以做到这一点，但无论您使用哪一种，*您通常都需要在编写查询时知道结果集中列的数量和名称*。我可以给你最喜欢的食物和最喜欢的颜色，但如果该表中有任何其他属性，你将看不到它们。没有办法用 vanilla sql 来自动化它；如果您想从这种模式中获取任意属性，则必须使用动态 sql 或客户端语言。

排除了这种限制，让我们看一下可以做到这一点的一种方法：

```
SELECT m.unique, m.last_name, m.first_Name, s1.property_Value As Favorite_Food, s2.property_Value As Favorite_Color
FROM Table_1 m
LEFT JOIN Table_2 s1 ON s1.unique = m.unique and s1.property_Name = 'Favorite Food'
LEFT JOIN Table_2 s2 ON s2.unique = m.unique and s2.property_Name = 'Favorite Color' 
```

另一种选择是使用[PIVOT 关键字](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)，但在我们了解您的实际数据的更多详细信息之前，上面的连接就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:29:53.923

这是创建两个现有表的新表TABLE3的代码，如果您不需要创建新表，只需将第一行（INSERT）扔掉。

```
INSERT INTO TABLE3 
SELECT 
    TABLE1.`UNIQUE IDENTIFIER`, 
    TABLE1.`First Name`, 
    TABLE1.`Last Name`, 
    TABLE2a.`Property Value`, 
    TABLE2b.`Property Value` 
 FROM TABLE1
 INNER JOIN TABLE2 AS TABLE2a 
     ON TABLE2a.`UNIQUE IDENTIFIER`=TABLE1.`UNIQUE IDENTIFIER`
 INNER JOIN TABLE2 AS TABLE2b 
     ON TABLE2b.`UNIQUE IDENTIFIER`=TABLE1.`UNIQUE IDENTIFIER` 
 WHERE 
     TABLE2a.`Property Name`='Favorite Food' 
 AND
     TABLE2b.`Propery Name`='Favorite Color'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:25:54.713

加盟怎么样？

```
select * from TABLE1 join TABLE2 on TABLE1.UNIQUE_IDENTIFIER = TABLE2.UNIQUE_IDENTIFIER; 
```

使用两个单个表的所有表创建连接表。如果您只需要特定列，请将 * 替换为您选择的列。

# php - 查询中的时间戳问题

> ID：13352514
> 
> 赞同：0
> 
> 时间：2012-11-12T22:20:29.587
> 
> 标签：php, mysql

我有这段代码，我用它来比较时间戳字段和我之前选择的日期！但是我在语法上遇到错误..怎么办？

```
$query = sprintf( 'SELECT * FROM coupon WHERE date("Y-m-d", "time") = $date' ); 
```

错误是：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' "time") = $date' at line 1 
```

同时，我正在比较一个时间戳，即现场时间，以及一个`$date` 提前感谢的日期..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:28:39.833

`time`不应引用，因为它是字段引用，而不是[字符串文字](http://dev.mysql.com/doc/refman/5.0/en/string-literals.html)。

```
$query = sprintf('SELECT * FROM coupon WHERE DATE(time) = $date'); 
```

**注意：**您容易受到[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:52:53.137

你把 PHP 函数弄混了

```
date ( string $format [, int $timestamp = time() ] ) 
```

和 MySQL 函数。

```
DATE( expr ) 
```

分别见手册条目：

[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date)

# javascript - 使用 javascript 将 URL 作为参数发送

> ID：13352515
> 
> 赞同：4
> 
> 时间：2012-11-12T22:20:32.847
> 
> 标签：javascript, ajax, urlencode, url-parameters

我必须从客户端向服务器发送名称和链接。我想过使用 Javascript 调用的 AJAX 来执行此操作。

这就是我的意思。我希望使用参数向名为 abc.php 的文件发出 ajax 请求：-

```
1\. http://thumbs2.ebaystatic.com/m/m7dFgOtLUUUSpktHRspjhXw/140.jpg

2\. Apple iPod touch, 3rd generation, 32GB 
```

首先，我对 URL 进行了编码并尝试发送它。但是服务器说状态禁止

有什么解决办法吗？

更新 ：：

它最终打电话给

```
http://abc.com/addToWishlist.php?rand=506075547542422&image=http://thumbs1.ebaystatic.com/m/mO64jQrMqam2jde9aKiXC9A/140.jpg&prod=Flat%20USB%20Data%20Sync%20Charging%20Charger%20Cable%20Apple%20iPhone%204G%204S%20iPod%20Touch%20Nano 
```

Javascript代码::

```
function addToWishlist(num) {
var myurl = "addToWishlist.php";
var myurl1 = myurl;
myRand = parseInt(Math.random()*999999999999999);

var rand  = "?rand="+myRand ;
var modurl = myurl1+ rand + "&image=" + encodeURI(storeArray[num][1]) + "&prod=" + encodeURI(storeArray[num][0]);
httpq2.open("GET", modurl, true);
httpq2.onreadystatechange = useHttpResponseq2;
httpq2.send(null);
}
function useHttpResponseq2() {
if (httpq2.readyState == 4) {
if(httpq2.status == 200) {
var mytext = httpq2.responseText;
document.getElementById('wish' + num).innerHTML = "Added to your wishlist.";
}
}
} 
```

服务器代码

```
<?php
include('/home/ankit/public_html/connect_db.php');

$image = $_GET['image'];
$prod = $_GET['prod'];
$id = $_GET['id'];

echo $prod;
echo $image;
?> 
```

正如我所提到的，它非常基础

更多更新：

在尝试通过 AJAX 向服务器发送 POST 请求时，它说：-

```
Refused to set unsafe header "Content-length"
Refused to set unsafe header "Connection" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T04:04:16.687

2 件事。

1.  使用`encodeURIComponent()`而不是`encodeURI()`.

    这里有一个详细的讨论：[你什么时候应该使用escape而不是encodeURI / encodeURIComponent？](https://stackoverflow.com/questions/75980/best-practice-escape-or-encodeuri-encodeuricomponent)

2.  如果您是 JavaScript 新手，请使用一些库来帮助您完成 AJAX 工作。像 mootools、jQuery 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T04:57:12.540

使用 POST 请求解决了我的问题:)

```
function addToWishlist(num) {
var url = "trial.php";
var parameters = "prod=" + encodeURIComponent(storeArray[num][0]) + "&image=" + encodeURIComponent(storeArray[num][1]);
httpq2.open("POST", url, true);
httpq2.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
httpq2.onreadystatechange = function(){
if (httpq2.readyState == 4) {
if(httpq2.status == 200) {
var mytext = httpq2.responseText;
document.getElementById('wish' + num).innerHTML = "Added to your wishlist.";
}
}
};
httpq2.send(parameters);
} 
```

# c# - 制作一堆逗号

> ID：13352520
> 
> 赞同：1
> 
> 时间：2012-11-12T22:20:48.383
> 
> 标签：c#, string, linq, csv

> **可能重复：**
> [在 C# 中重复字符的最佳方式](https://stackoverflow.com/questions/411752/best-way-to-repeat-a-character-in-c-sharp)

我正在制作一个以逗号分隔的大 CSV 文件。大多数文件字段都是空的，稍后会提供，所以我只需要插入一个逗号。我做了一个简单的方法：

```
 private string MakeComma(int CommaNumber)
{
    StringBuilder sb = new StringBuilder(string.Empty);
    for (int i = 0; i < CommaNumber; i++)
    {
        sb.Append(",");
    }
    return sb.ToString();
} 
```

我想知道是否有更好的方法使用 Linq、Join 等。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-12T22:22:51.930

```
new string(',', 42); 
```

请参阅[文档](http://msdn.microsoft.com/en-us/library/aa331867%28v=vs.71%29.aspx)

# php - 在 url 中获取产品名称而不是 id php

> ID：13352525
> 
> 赞同：0
> 
> 时间：2012-11-12T22:21:03.417
> 
> 标签：php, mysql, url

我正在为一个大学项目开发​​一个购物车网站，需要一些帮助。

该网站目前正在制作中，网址为[http://www.cutecupcak.es](http://www.cutecupcak.es)。

目前，每个产品都有一个类似[http://cutecupcak.es/product.php?id=11](http://cutecupcak.es/product.php?id=11)的网址，但我希望它是类似[http://cutecupcak.es/product.php?id=巧克力蛋糕](http://cutecupcak.es/product.php?id=chocolate_cupcake)。

这是我们为完成这项工作而获得的代码。

```
if(isset($_GET['id'])) {
$id = $_GET['id'];
$result = mysql_query("SELECT * FROM `CAKE` WHERE `cake_id`=($id)");    
} 
```

我需要改变什么才能让`cake_name`to 显示而不是`cake_id`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:29:24.693

您可以将名称放在 url 中，这应该很简单，因为您的数据库中有名称和 id，您可以搜索并使用两者。

**name 和 id**
但我建议不要这样做。产品名称可以稍作更改，更改它意味着旧链接将不再起作用。

我会创建一个这样的网址：

```
http://cutecupcak.es/product.php?id=11&name=chocolate_cupcake 
```

或者更确切地说：

```
http://cutecupcak.es/product/11/chocolate_cupcake 
```

这些 url 可以被安全地编入索引。您保留数字 id，您可以使用它来查找数字。名称也在 url 中，有利于可读性和 SEO（搜索引擎优化），但名称没有实际意义。你可以放心地忽略它，因为你得到了这个号码。因此，在您更改名称后，所有以前索引和链接的 url 都将保持有效。

我会选择在产品名称中使用破折号而不是下划线。我相信`chocolate-cupcake`并且`chocolate+cupcake`都比 索引好`chocolate_cupcake`，但我关于这个主题的信息可能有点陈旧。

**mysql？参数！**
我也建议您不要再使用`mysql_*`，并开始使用`PDO`or `mysqli`。两者都允许使用参数化查询。这允许您以安全透明的方法将 id 或名称传递给查询。比使用`mysql_real_escape_string`或类似的功能更安全、更清洁、性能更好。它特别安全，因为一旦你习惯了使用参数，你就会开始将所有变量作为参数传递。虽然您可以忘记在当前查询中转义变量，但您不可能忘记转义变量，因为它不需要转义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:30:58.527

通常，如果您想通过名称而不是 id 来引用您的产品 - 您应该添加一个带有 UNIQUE 键的新列（我总是将其命名为“slug”）。然后，当添加或编辑产品时，根据其名称为 slug 列生成新值。例如 - 从“巧克力蛋糕”中，您将创建“巧克力蛋糕”。然后你必须检查蛞蝓是否是唯一的——如果不是——以某种方式解决冲突（例如“chocolate_cake_1”）。

如果您已完成所有这些设置 - 只需通过独特的 slug 选择合适的产品：

```
$result = mysql_query("SELECT * FROM `CAKE` WHERE `slug`='" . mysql_real_escape_string($_GET['id']) . "'"); 
```

并且 - 显然 - 使用 mysqli 而不是不推荐使用的 mysql 函数。

[http://php.net/manual/en/mysqli.query.php](http://php.net/manual/en/mysqli.query.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:28:48.013

尝试这样的事情：

```
if(isset($_GET['id'])) {
   $id = $_GET['id'];
   $result = mysql_query("SELECT * FROM `CAKE` WHERE `cake_name`=(". mysql_real_escape_string($id). ")");    
} 
```

注意：我还添加了`mysql_real_escape_string`，因为不这样做会带来巨大的 SQL 注入风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:25:18.227

我认为这只是更改为：

```
$result = mysql_query("SELECT * FROM `CAKE` WHERE `cake_name`=($id)"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T22:32:17.700

以下是您必须做的蓝图： 1- 在您的表中，您应该将 cake_name 字段设置为唯一。2-您的 sql 查询应该是：

```
$result = mysql_query("SELECT * FROM `CAKE` WHERE `cake_name`=($id)"); 
```

3-更改您的产品列表中找到的链接以获取 cake_name 值而不是数字 id。

# ios - 视图的简单拖放？

> ID：13352526
> 
> 赞同：7
> 
> 时间：2012-11-12T22:21:08.330
> 
> 标签：ios

我正在学习 iOS，但找不到如何将拖放行为添加到`UIView`.

我试过：

```
[_view addTarget:self action:@selector(moved:withEvent:) forControlEvents:UIControlEventTouchDragInside]; 
```

`UIView`它说“声明选择器没有可见界面`addTarget (etc)`”

我也尝试添加一个平移手势识别器，但不确定这是否是我需要的

```
- (IBAction)test:(id)sender {
       NSLog(@"dfsdfsf");
  } 
```

它被调用，但不知道如何获取事件的坐标。iOS中为移动事件注册回调/进行拖放的标准简单方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-12T22:31:09.320

A`UIPanGestureRecognizer`绝对是要走的路。如果您希望用户拖动视图，您需要在超级视图的坐标系中“平移”（移动）手势：

```
- (IBAction)panWasRecognized:(UIPanGestureRecognizer *)recognizer {
    CGPoint translation = [recognizer translationInView:_view.superview]; 
```

一旦你有了翻译，你可以通过改变它来移动（“拖动”）视图`center`：

```
 CGPoint center = _view.center;
    center.x += translation.x;
    center.y += translation.y;
    _view.center = center; 
```

最后，您希望将平移手势识别器的平移设置回零，因此下次收到消息时，它只会告诉您自上一条消息以来手势移动了多少：

```
 [recognizer setTranslation:CGPointZero inView:_view.superview];
} 
```

在这里，所有这些都可以轻松复制/粘贴：

```
- (IBAction)panWasRecognized:(UIPanGestureRecognizer *)recognizer {
    CGPoint translation = [recognizer translationInView:_view.superview];

    CGPoint center = _view.center;
    center.x += translation.x;
    center.y += translation.y;
    _view.center = center;

    [recognizer setTranslation:CGPointZero inView:_view.superview];
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T22:25:49.333

`touchesBegan`从, `touchesMoved`,开始`touchesEnded`。在你的 UIView 子类中覆盖这些，你就可以开始学习事件系统了。您可以像这样获取事件坐标：

```
- (void) touchesBegan:(NSSet *) touches withEvent:(UIEvent *) event
{
    float x = [[touches anyObject] locationInView:self].x;
    float y = [[touches anyObject] locationInView:self].y;
} 
```

然后有很多东西可以在不同视图之间转换坐标等等。一旦你理解了这一点，你就可以使用`UIGestureRecognizer`你已经找到的那些你需要的东西。

您将需要一个平移手势识别器来进行拖放。您可以使用`locationInView:`选择器`UIPanGestureRecognizer`在任何给定时刻找出您所在的位置。

你像这样添加你的手势识别器，而不是你尝试的目标动作：

```
UIPanGestureRecognizer *dragDropRecog = [[UIPanGestureRecognizer alloc] initWithTarget:yourView action:@selector(thingDragged:)];
[yourView addGestureRecognizer:dragDropRecog]; 
```

`thingDragged:`然后你必须在你的视图中实现选择器：

```
- (void) thingDragged:(UIPanGestureRecognizer *) gesture
{
    CGPoint location = [gesture locationInView:self];
    if ([gesture state] == UIGestureRecognizerStateBegan) {
        // Drag started
    } else if ([gesture state] == UIGestureRecognizerStateChanged) {
        // Drag moved
    } else if ([gesture state] == UIGestureRecognizerStateEnded) {
        // Drag completed
    }
} 
```

您将翻译被拖动到更改位中的视图，并处理结束部分中的放置。

# visualization - 科学计算中的离线（可视化）渲染

> ID：13352530
> 
> 赞同：0
> 
> 时间：2012-11-12T22:21:11.487
> 
> 标签：visualization, hpc

我已经问过这个关于科学计算的问题，并想知道这个论坛是否可以提供替代方案。

我需要模拟大量经历软体变形的代理的运动。控制代理移动的过程很复杂，因此整个过程需要并行化。

模拟需要在 3D 中可视化。因为我将在许多不同的节点（MPI 甚至 MPI+GPGPU）上运行这个模拟，所以我不希望可视化实时运行，而是模拟应该在完成后输出一个视频文件。

（我不是在寻找令人敬畏的 AAA 视频游戏质量的图形，此外，移动代码会占用足够的 CPU 时间，所以我不想通过添加重量级的渲染代码来进一步减慢应用程序的速度）

我认为制作这样的视频有三种方法：

*   将原始像素信息写入 BMP 并将它们拼接在一起 - 我已经在 2D 中完成了此操作，但我不知道这将如何在 3D 中工作......
*   使用 OpenGL/Direct3D 的离线模拟，渲染到缓冲区而不是屏幕。
*   将某种遥测数据写入文件，指示每个代理的位置、每个时间间隔的变形等，然后在模拟完成后将其用作 OpenGL/Direct3D 程序的输入。

这个问题之前必须解决 - HPC 中有大量的可视化

**总结：如何以离线方式轻松渲染视频（非常基本的图形而不是玩具故事 - 我只需要 3D blob）而不会对性能产生很大影响？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:36:13.213

我的想法是将**顶点的不同状态/位置存储为适当文件格式的顶点动画的单帧**。合适的格式是[COLLADA](http://en.wikipedia.org/wiki/COLLADA)，它是基于 XML 的 3D 场景的中间格式，因此可以使用通用 XML 库轻松解析和编写。还有一些用于 COLLADA 的专用库，例如**​​ COLLADA DOM**和**pycollada**。然后可以使用您选择的渲染软件（3D Studio Max、Blender、Maya ...）将包含顶点动画的 COLLADA 文件**直接渲染为视频文件**

# java - Android 如何将字符串转换为可编辑

> ID：13352531
> 
> 赞同：39
> 
> 时间：2012-11-12T22:21:11.113
> 
> 标签：java, android

我们都知道我们可以 setText(String) 到一个 editText 框，但是如果你想从一个字符串变量中获取一个可编辑的变量，你怎么做呢？

对于 Temp，我制作了一个不可见的 editText 框来设置，然后从中获取将字符串变为可编辑的。

回复：再次供我自己参考 String = editablevariable.getText().toString()

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-11-12T22:26:29.457

正如您可能发现的那样， Editable 是一个接口，因此您不能调用`new Editable()`.
然而，一个 Editable 只不过是一个带有 Spannables 的字符串，所以使用[SpannableStringBuilder](http://developer.android.com/reference/android/text/SpannableStringBuilder.html)：

```
Editable editable = new SpannableStringBuilder("Pass a string here"); 
```

如果您只想更改 Spannables，而*不是*文本本身，则可以使用基本的[SpannableString](http://developer.android.com/reference/android/text/SpannableString.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-02-19T01:36:57.120

使用`Editable.Factory.getInstance().newEditable(str)` 来自[android 文档：](https://developer.android.com/reference/android/text/Editable.Factory.html#newEditable(java.lang.CharSequence))

> 从指定的 CharSequence 返回一个新的 SpannedStringBuilder。您可以覆盖它以提供不同类型的跨区。

# android - 动画 Android 布局的问题；元素快速回到起始位置

> ID：13352534
> 
> 赞同：1
> 
> 时间：2012-11-12T22:21:19.843
> 
> 标签：android, animation, android-relativelayout

几天来我一直在寻找这个问题的答案，虽然有些事情*有点*工作（而且大多数都没有），但我希望我能找到我正在尝试做的事情的最佳实践。

我正在尝试让通知栏显示在我的应用程序中。理想情况下，它会从顶部向下滑动，同时移动布局中的其他元素以适应。这里有一个插图来帮助：[插图](http://i.stack.imgur.com/5X64a.jpg)

这是布局的结构（为简洁起见，我取出了一点）：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:baselineAligned="false">

    <!-- notification -->
    <RelativeLayout
        android:id="@+id/notification_bar"
        android:layout_width="match_parent"
        android:layout_height="40dip"
        android:background="@drawable/notification_background"
        android:visibility="visible">

    <!-- end notifcation -->    
    </RelativeLayout> 

    <!-- header -->
    <RelativeLayout
        android:id="@+id/header"
        android:layout_width="match_parent"
        android:layout_height="47dip"
        android:layout_alignParentTop="true" >

        <ImageView
            android:id="@+id/header_bg"
            android:layout_width="match_parent"
            android:layout_height="47dip"
            android:src="@drawable/home_header" />

    <!-- end header -->    
    </RelativeLayout>

    <!-- buttons -->
    <LinearLayout
        android:id="@+id/buttons"
        android:orientation="vertical"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_above="@+id/footer"
        android:layout_below="@id/notification_bar"
        android:layout_gravity="center_horizontal">

        <ImageButton 
        android:id="@+id/button1"
        android:src="@drawable/button1"
        android:layout_width="86dip"
        android:layout_height="65dip"
        android:layout_weight=".4" />
    <ImageButton 
        android:id="@+id/button2"
        android:src="@drawable/button2"
        android:layout_width="98dip"
        android:layout_height="73dip"
        android:layout_weight=".2" />
    <ImageButton 
        android:id="@+id/button3"
        android:src="@drawable/button3"
        android:layout_width="86dip"
        android:layout_height="71dip"
            android:layout_weight=".4" />

<!-- end buttons -->
    </LinearLayout>

    <!-- footer -->

    <LinearLayout
        android:id="@id/footer"
        android:layout_width="match_parent"
        android:layout_height="76dip"
        android:layout_alignParentBottom="true"
        android:background="@drawable/home_footer" >

    <!-- end footer -->
    </LinearLayout>
</RelativeLayout> 
```

主要问题：首先，我为通知栏设置了动画。它移动，并在动画结束时*弹回原位*。是的，我将 fillAfter 设置为 true。这没什么区别。无论如何，应该移动的 3 个项目是可点击的，从我读过的内容来看，这些元素*实际上*并没有移动，它们只是*看起来*像已经移动了。

第二个问题：整个视图是一个RelativeLayout，但是三个元素在一个LinearLayout 中，通过XML 设置为layout_below 通知栏。我曾希望移动通知栏会*挤压*这个 LinearLayout，移动按钮以适应，但没有这样的运气。如果我必须将三个元素转换为单独的动画，那很好。我已经尝试过了，但是它们遇到了通知栏所遇到的同样的“回弹”问题。然而，我希望会有一种更简单、更合乎逻辑的方法。

我发现了很多关于这个快速恢复问题的帖子，但是没有一个解决方案非常有效（或者对我来说有意义，有点菜鸟）。听起来好像需要在 onAnimationEnd 处理程序中发生一些事情。我认为这是调整 LayoutParams 的问题，但我不确定在那里如何或做什么。

我的目标是 API 8 (2.2)，所以 Honeycomb 动画 API 无济于事。我研究了 NineOldAndroids，它看起来很有希望，但我认为*必须*有一种方法可以使用本机 API 来做到这一点。

** 如果我们可以让通知栏被关闭，并且一切都回到原来的位置，那么奖励积分。

** 更新：以下代码类型的作品 **

下面是滑出通知栏的动画方法：

```
private void showNotification() {

    mNotificationBar.setVisibility(View.VISIBLE);

    Animation slideOut = AnimationUtils.loadAnimation(this,  R.anim.slide_notification_out);

    slideOut.setAnimationListener(new Animation.AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {
            // do nothing
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
            // do nothing
        }

        @Override
        public void onAnimationEnd(Animation animation) {
             // do SOMETHING
            RelativeLayout.LayoutParams params = (RelativeLayout.LayoutParams) mNotificationBar.getLayoutParams();
            params.addRule(RelativeLayout.BELOW, mHeader.getId());

            mNotificationBar.setLayoutParams(params);
            mNotificationBar.clearAnimation();

        }
    });

    mNotificationBar.startAnimation(slideOut);  
} 
```

更改 AnimationEnd 上的 LayoutParams 可使通知栏保持在原位。而且，当动画完成时，按钮布局会挤压以适应！但是，按钮布局不像通知栏那样流畅地动画，它只是在动画结束时卡入到位。此外，通知栏在动画的最后也会跳动一点，我猜是因为布局正在重绘。如此接近，但到目前为止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:42:43.323

`Snap back problem`

您需要在您希望它出现在布局中的最终位置定义通知。`LinearLayout`对你来说，它可能是你上面提到的第一项。然后你设置`visibility`为`gone`.

最后你使用一段类似于下面的代码（我用它来动画按钮进入屏幕）：

```
private void buttonFadeOut() {
        linear_layout_buttons.startAnimation(AnimationUtils.loadAnimation(MyMapActivity.this, android.R.anim.slide_out_right));
        linear_layout_buttons.setVisibility(View.GONE);
}

private void buttonFadeIn() {
    if(linear_layout_buttons.getVisibility() == View.GONE){
        linear_layout_buttons.startAnimation(AnimationUtils.loadAnimation(MyMapActivity.this, R.anim.slide_in_right));
        linear_layout_buttons.setVisibility(View.VISIBLE);
    }
} 
```

`Squeeze problem`

我从未尝试过使用动画，但是您可以`android:layout_weight="1.0"`在相对布局中的每个项目中设置 ，以在它们之间平均分配可用空间（或使用值来为每个项目分配不同的空间）。

问候。

# google-apps-script - 防止更改谷歌电子表格中的单元格

> ID：13352543
> 
> 赞同：1
> 
> 时间：2012-11-12T21:31:55.383
> 
> 标签：google-apps-script, spreadsheet

我想防止更改谷歌电子表格中的 K 列。无论有什么价值，我都不希望它改变。我不喜欢保护功能，因为它使我认为丑陋的显示。

我的代码。不幸的是，它完全没有任何作用。目的是获取单元格中的任何当前值，保存它，然后在退出单元格时将其写回，而不是保存可能对单元格所做的任何更改。该单元格开始时要么是空白的，要么已经被修改为包含日期和时间。无论当前内容是否为空白，离开单元格后它都应保持相同的值。

```
function onEdit() {
  var s = SpreadsheetApp.getActiveSheet();
  var r = s.getActiveCell();
  var columnNum=r.getColumn() 

  // if column is K then prevent any changes
  if (columnNum == 11) {
    var dateCell = s.getRange(r.getRow(), 11);
    var v=dateCell.getValue();
    dateCell.setValue(v);
  }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T12:47:52.833

这可能会帮助你。在谷歌有一个适当的脚本 API 来保护范围之前，我想出了一个解决你的问题的方法。这个正在使用验证功能，并且可以正常工作。

```
function setRangeProtection(rangeToProtect) {

  var firstRow = rangeToProtect.getRow();
  var noOfRows = rangeToProtect.getHeight();
  var firstColumn = rangeToProtect.getColumn();
  var noOfColumns = rangeToProtect.getWidth();

  var rangeToProtectValues = rangeToProtect.getValues();
  var rangeToProtectFormulas = rangeToProtect.getFormulas();

  var cellRow = firstRow;

  for (var i=0 ; i<noOfRows ; ++i) {

    var cellColumn = firstColumn;

    for (var j=0 ; j<noOfColumns ; ++j) {         

      var cell = sheet.getRange(cellRow, cellColumn);

      if (rangeToProtectFormulas[i][j] == "") {
        var rangeToProtectContent = rangeToProtectValues[i][j]; 
      } else {
        var rangeToProtectContent = rangeToProtectFormulas[i][j];
      }

      var rules = SpreadsheetApp.newDataValidation()
                  .requireTextEqualTo(rangeToProtectContent)
                  .setAllowInvalid(false)
                  .setHelpText('Don\'t mess with the DJ!')
                  .build();
      cell.setDataValidation(rules);

      ++cellColumn;

    }

    ++cellRow;

  }

} 
```

唯一的小问题是，对于包含公式的单元格，会出现一个小的红色三角形，并且当您将鼠标悬停在它上面时会显示一条消息。摆脱不了那个。如果您找到解决方案，请告诉我。删除帮助文本无济于事，因为它会返回到默认模式。

# c - 从 C 中的文本文件中读取整数时的错误

> ID：13352544
> 
> 赞同：3
> 
> 时间：2012-11-12T22:22:09.567
> 
> 标签：c, file, tabs, integer, space

我有点绝望，因为我浪费了最后 4 个小时来寻找简单/愚蠢的事情的解决方案。我在学校有一个项目，我必须从文本文件中读取整数，然后计算它们的最大值。问题是这些数字不一定用空格分隔，也可以用制表符 (\t) 或换行符 (\n) 分隔。我使用 fscanf 函数读取我的整数，但问题是在最后一个数字之后我的文件中有一个空格，所以它读取最后一个数字的 2 倍（我不知道为什么）。通常人们会说“删除那个空格”，但我的老师会以几种方式测试程序，他警告我们程序必须是健壮的（我们必须能够管理空格，\t，\n所以我们可以正确读取数字，所以这就是他故意在最后一个数字后面留一个空格的原因）。

```
FILE* file = NULL;
int *t = NULL, *new_size = NULL;
int temp, count;

file = fopen(argv[1],"r");
do
{
    fscanf(file,"%d",&temp);
    count++;

    new_size = (int*) realloc (t, count * sizeof(int));

    if (new_size != NULL)
    {
        t = new_size;
        t[count-1] = temp;
    }
    else
    {
        free(t);
        puts("Erreur d\'allocation memoire!\n");
        exit(1);
    }
} while(!feof(file));

fclose(file);

printf ("Numbers read\n:");
for(i = 0; i < count; i++)
{
    printf ("%d ", t[i]);
} 
```

我的论点是一个名为 data.txt 的文件，其中包含： 3 1 7 0 4 9 6 150 和末尾的 \n 。所以基本上，我的程序读取前 8 个整数，之后，由于它不是 EndOfFile，它仍然再次读取最后一个（150）。所以我的输出是：数字读取： `3 1 7 0 4 9 6 150 150`

谁能告诉我应该怎么做才能使我的程序更健壮？如果末尾有空格，甚至是制表符 ( `\t`)，我需要管理相同类型的 os 错误。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:24:48.727

检查返回值`fscanf`

```
if (fscanf(file,"%d",&temp) != 1) break; 
```

如果找不到数字，则跳出循环。`fscanf`返回成功转换的次数，应该用于错误检查和处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:24:59.990

使用[`fscanf()`](http://en.cppreference.com/w/c/io/fscanf)返回赋值数的结果作为循环的终止条件。在循环检查到达 EOF 之后，由于其他一些故障，循环没有终止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:43:02.727

如果数字之间用空格隔开，那么您可以先用 fscanf 读取一个空格，然后再读取一个整数。为了使程序健壮，请始终查看 fscanf 是否失败。如果失败则停止读取整数，否则继续。

```
bool good=true;
while(good)
{
    char separator;
    if(fscanf(file,"%c",&separator)==1)
    {
        if(separator!=' ' && separator!='\t' && separator!='\n')
        {
            fprintf(stderr,"Illegal character found in file");
            // You can choose if break the loop setting good to false, or
            // if to continue, this depends on your assignment
        }
        if(fscanf(file,"%d",&temp)==1)
        {
            < Push temp to your list/array >
        }
        else
        {
            good=false;
        }
    }
    else
    {
        good=false;
    }
} 
```

# tfsbuild - TFS 构建定义未将 mvc 应用程序部署到 IIS

> ID：13352546
> 
> 赞同：2
> 
> 时间：2012-11-12T22:22:17.443
> 
> 标签：tfsbuild

我正在尝试使用 Visual Studio 的团队资源管理器和 TFS 创建构建定义以将 MVC 站点部署到 IIS。

我遵循了名为“使用 Team Foundation Server 2010 进行持续部署”的 Pluralsight 教程。

我从教程中遵循的步骤包括：

*   安装的 IIS 管理脚本和工具
*   安装管理服务
*   在管理服务上，我允许远程连接并仅启用 Windows 凭据
*   已安装的 Web 部署
*   创建了部署域帐户
*   允许域帐户权限修改 IIS 文件系统
*   使用此域帐户设置委派规则
*   使用域帐户设置 IIS 权限

我在构建定义中设置的 MSBuild 争论是：

```
/p:DeployOnBuild=true 
/p:DeployTarget=MSDeployPublish 
/p:CreatePackageOnPublish=False 
/p:MSDeployPublishMethod=WMSVC 
/p:SkipExtraFilesOnServer=True 
/p:AllowUntrustedCertificate=True 
/p:MSDeployServiceUrl="https://<iis server name>:8172/msdeploy.axd"
/p:Username="<domain>\<user>" 
/p:Password="<password>" 
/p:DeployIISAppPath="Default Web Site/<site name>" 
```

我将构建排队并通过，写入放置文件夹但未写入 IIS。

我使用相同的属性值从解决方案资源管理器发布了 MVC 应用程序，它已成功部署到 IIS。

有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T03:24:25.653

I solved the problem by examining the contents on my local machine and the comparing it with the build server.

I found that the 'Web' and 'WebApplication' folders on my local machine at 'C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0' were not present in the same location on the build server.

Once I copied and pasted them across my build worked and the mvc site was deployed to IIS as expected.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T15:14:24.157

这是对我有用的设置。尝试更改 CreatePackageOnPublish=True 并查看它是否有效。

/p:DeployOnBuild=True
/p:DeployTarget=MsDeployPublish
/p:CreatePackageOnPublish= **True**
/p:MSDeployPublishMethod=WMSVC
/p:MSDeployServiceUrl=https://ServerName:8172/MSDeploy.axd /p:DeployIisAppPath="NameofWebsiteOnIISServer"
/p :AllowUntrustedCertificate=True
/p:UserName="domain\serviceaccount"
/p:Password="AwesomeSecurePassword"

首先，我建议检查您是否能够通过 webdeploy 直接通过 Visual Studio 发布。下面列出了在 Visual Studio 中找出正确的 Web 部署设置的最佳方法。我推荐这种方法，因为它会给你错误消息v / s“**每次都排队一个新的构建**”来查看网站是否已发布。

1.  右键单击 IIS7 里面的网站 --> WebDeploy --> 点击 Configure Web Deploy Publishing
2.  单击设置，然后获取生成的发布设置文件，并在您右键单击网站并单击 Visual Studio 中的发布网站时导入这些发布设置。
3.  尝试先使用 Visual Studio 发布一键发布，因为在 Visual Studio 中使用 Web 部署发布更容易发现错误。

如果您收到错误，则此站点 ( [http://www.iis.net/learn/publish/troubleshooting-web-deploy/web-deploy-error-codes](http://www.iis.net/learn/publish/troubleshooting-web-deploy/web-deploy-error-codes) ) 包含与之相关的所有错误消息。

确保您指定的服务帐户是否列在“管理”下的“IIS 管理器权限”部分中。

还要检查“ **Web 管理服务**”和“ **Web 部署代理服务**”服务是否正在运行。

# c# - 如何在 MonoTouch 中将 bool 转换为 NSObject

> ID：13352551
> 
> 赞同：6
> 
> 时间：2012-11-12T22:22:27.220
> 
> 标签：c#, mono, xamarin.ios, nsuserdefaults

这让我有点疯狂。我正在尝试在我的 MonoTouch 应用程序中注册一些 NSUserDefaults。

```
var defaultsToRegister = new NSMutableDictionary();
defaultsToRegister.SetValueForKey(true, IS_REMINDING);
NSUserDefaults.StandardUserDefaults.RegisterDefaults(defaultsToRegister); 
```

显然这不是编译，因为*bool*不能转换为*NSObject*。但是当我想从*NSUserDefaults*设置或检索布尔值时，我可以使用：

```
public bool IsReminding {
    get {
        return NSUserDefaults.StandardUserDefaults.BoolForKey(IS_REMINDING);
    }

    set {
        NSUserDefaults.StandardUserDefaults.SetBool(value, IS_REMINDING);
    }
} 
```

在设置 plist 文件中，布尔值按照`<key>ReminderTimeOfDay</key><true/>`我的预期写入。那么如何注册一个默认的布尔值呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-02T21:04:22.390

以下对我有用：

```
 bool someValue;
 NSObject objValue = NSObject.FromObject(someValue); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T23:54:03.830

我就是这样做的：

```
using (var defaults = NSDictionary.FromObjectsAndKeys (new object[] {
        true,
    }, new object [] {
        "AllowInternetAccess",
    })) {

    settings.RegisterDefaults (defaults);
} 
```

当然，我有不止一个键/值对，这使我可以避免多次调用`NSMutableDictionary`.

# c++ - g++ 不再找到标准库 OSX 10.6.8

> ID：13352558
> 
> 赞同：2
> 
> 时间：2012-11-12T22:23:22.450
> 
> 标签：c++, shell, command-line

到目前为止，我在互联网上找不到任何解决方案。

我正在运行 OSX 10.6.8。我以前一直在为 C/C++ 使用 gnu 编译器。我切换到 XCode 并没有问题，但我想使用命令行。但是，在擦除我的计算机并从备份恢复后，我收到错误 bash: g++ command not found。

首先，我认为我的 $PATH 有点不稳定，所以我尝试将正确的路径添加到 Path 变量中，现在它可以识别 g++ 并尝试编译。但是，我现在收到此错误：

```
hello.cpp:3:20: error: iostream: No such file or directory
hello.cpp: In function ‘int main()’:
hello.cpp:8: error: ‘cout’ is not a member of ‘std’ 
```

这里是你好世界！代码：

```
#include <iostream>

int main ()
{
std::cout << "Hello World!";
return 0;
} 
```

在线发布的解决方案主要是命名空间和#include 语句的问题，但我不认为这是目前的错误。

当我在终端中输入“which g++”时，我得到：/Developer/usr/bin/g++，当我输入 g++ -v 时，我得到：

```
Using built-in specs.
Target: i686-apple-darwin10
Configured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1
Thread model: posix
gcc version 4.2.1 (Apple Inc. build 5666) (dot 3) 
```

4.2.1 是一个较旧的版本，所以如果我可以更改一件事，它将切换到我在 usr/local/Cellar/gcc 中找到的 4.7.2。当我尝试使用自制软件安装 gcc 时，我不确定 Cellar 可能是什么，正如我在其他论坛上发现的那样。

在此先感谢，这超出了我的范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:07:48.603

当您安装 XCode 时，您只是忘记选中“安装 Unix 命令行实用程序”的小复选框。当你这样做时，你将在 /usr/ 中安装一个完全工作的 GCC。/Developer/ 中安装的那个不用于命令行。它仅适用于 XCode 图形 IDE。

# ruby-on-rails - 在 Rails 中 send_file 之后删除文件夹

> ID：13352570
> 
> 赞同：4
> 
> 时间：2012-11-12T22:24:18.463
> 
> 标签：ruby-on-rails, sendfile

我`file.txt`从我的 Rails 控制器使用发送文件`send_file`，然后删除包含它的文件夹。

```
send_file("#{Rails.root}/public/folder/file.txt")
FileUtils.remove_dir "#{Rails.root}/public/folder", true 
```

当我这样做时，`file.txt`被发送并删除。但是，`folder`没有被删除。但是如果我删除该`send_file`行，那么`folder`将被删除。

如何让它删除`folder`？

编辑：有趣的是，我发现里面`folder`有一个名为 的隐藏文件`.__afs2B0C`，可能会阻止删除。我不知道这个文件是如何创建的！该文件在消失之前仅保留大约 15 分钟。

EDIT2：我试过用 来检查临时文件的内容`vi`，但它是不可读的乱码。当我仅删除该`send_file`行时，该文件夹已正确删除。当我仅删除该`FileUtils.remove_dir`行时，该文件夹不包含临时文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T22:26:52.540

您确定在删除目录时 send_file 仍然没有发送文件，如果它使用 X-SendFile 可能是异步的？尝试删除目录时会导致错误。

因此，您可能应该将此删除操作排队，或者稍后使用清扫器执行此操作，而不是在将文件发送到流媒体后立即尝试执行此操作。

我不完全清楚您要发送哪个文件，因此包含文件路径和文件类型的实际示例以及如何在您的问题中创建它会很有用。

调试的可能帮助：

在执行以下操作时登录并监视文件夹：

*   写出一个非常大的文件（> 60MB 说），并检查在您的文件创建过程中没有创建不可见的文件 - 我不清楚您实际发送的是哪个文件
*   在慢速连接上设置大文件传输，并注意该文件的创建和可能的增长（例如，它可能与压缩动态提供的文件有关）。

鉴于当您尝试删除时 sendfile 可能仍在通过 Web 服务器发送（对于大文件）（x-send-file 现在是默认设置），我会尝试研究延迟的解决方案。

可能的解决方案：

*   使用 send_data 而不是 send_file（如果文件很小）
*   使用延迟作业等安排删除文件夹以供以后使用
*   设置一个清扫器，在每天结束时删除文件夹

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T08:31:21.027

不知道为什么隐藏文件在那里，它可能是 X-send-file 甚至 wget 的分支（部分进度或其他东西）。

理想情况下，您应该使用 Tempfile 来执行此类操作。该代码基于您对您正在做的事情的评论。另外，我使用了两个 gem，一个用于下载，另一个用于压缩。这样，您根本不需要创建文件夹，只需一个 zip 文件即可。zip 的所有内容文件将自行删除。下载 zip 后，只需将其删除。在这里我还要提一下，您可能会在某处遇到故障，因为 send_file 会将传输移交给网络服务器，因此您不会在文件仍在提供服务时删除 rails 进程。因此，即使这样，并且它在 localhost 上运行良好，我强烈建议在生产中使用自定义的预定后台垃圾收集器。

```
require 'open-uri'
require 'zip/zip'
zip_path = "#{Rails.root}/public/test.zip"
urls_to_fetch = ['abc.com', 'xyz.com']

Zip::ZipFile.open(zip_path, Zip::ZipFile::CREATE) do |zipfile|
    urls_to_fetch.each_with_index do |url, index|
        # intialize new temp file
        file = Tempfile.new(index.to_s)
        # fetch the file using open-uri or wget and save it as a tmpfile
        open(url, 'rb') do |read_file|
            file.write(read_file.read)
        end
    end
    # add the temp file to the list of files to zip
    zipfile.add(File.basename(file), file.path)
end
# send the zipfile for download
send_file zip_path
# delete the zipfile
FileUtils.rm zip_path 
```

但是，这不应该是强制性的。如果你在没有 Tempfiles 的情况下做事，请检查 rails runner 对目标目录的权限。

FileUtils 文档包含有关尝试删除文件/文件夹时的本地安全漏洞的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-16T08:59:05.963

[看这里...对我有用](https://stackoverflow.com/a/27276579)

```
 file = File.open(Rails.root.join('public', 'uploads', filename), "rb")
contents = file.read
file.close

File.delete(filepath) if File.exist?(filepath)

send_data(contents, :filename => filename) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T22:43:36.077

也许你可以试试这个解决方案：http: [//info.michael-simons.eu/2008/01/21/using-rubyzip-to-create-zip-files-on-the-fly/](http://info.michael-simons.eu/2008/01/21/using-rubyzip-to-create-zip-files-on-the-fly/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-21T14:34:37.390

它是如此简单但危险。使用shell命令来实现它。放进去`send_file`之后`Controller`

```
system ("rm -rf public/folder") 
```

# android - 在 Android 中，从 SQLite 表的特定范围中抓取两个随机行

> ID：13352573
> 
> 赞同：1
> 
> 时间：2012-11-12T22:24:25.343
> 
> 标签：android, sqlite

我正在android中创建一个简单的多项选择琐事游戏。我将有三个选择，A、B 或 C。我创建了一个 SQLite 数据库，其中包含琐事问题的三个可能答案。我已经让它显示正确的答案。如何编写 SQL 以便从指定范围内选择两个随机的唯一答案？这段代码：

```
 // ---Grabs RANDOM Event ---
    public String getRandomEvent() {
    Cursor cursor = this.db.query("thetable Order BY RANDOM() LIMIT 1", 
            new String[] { KEY_EVENT }, null, null, null, null, null);
        String result = "";

        for (cursor.moveToFirst(); !cursor.isAfterLast(); cursor.moveToNext()){
            result = result
            + cursor.getString(0);
        }

        return result;

    }

// --- END Grabs Event --- 
```

从整张桌子上随机抽取一个答案。此外，使用此代码，特别`thetable Order BY RANDOM() LIMIT 1`是它可以显示相同的答案两次。我想做的是让它从正确答案上方的 10 行和正确答案下方的 10 行中获取两个唯一答案。所以基本上我希望光标转到正确答案`cursor.moveToFirst();`，然后从正确答案上方和下方的 20 行中选择两个随机答案。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:39:01.987

对于随机顺序，“上方”和“下方”并没有真正的意义。

只需使用 . 抓取三个随机答案`LIMIT 3`。

# php - 除了 SQL 注入和 XSS 攻击之外，我还有什么需要担心的吗？

> ID：13352584
> 
> 赞同：3
> 
> 时间：2012-11-12T22:25:29.240
> 
> 标签：php, mysql, security, xss, sql-injection

我正在完成我的第一个“真正的”PHP 应用程序，并且正在努力确保它是安全的。我有点担心，因为我不是“专家” PHP 程序员，所以我可能会遗漏一些重要的东西，所以我想给你一些关于我的应用程序的信息，希望你能告诉我这是否是案子。所以我们开始：

*   我正在使用 CMS 来处理用户身份验证，所以我不必担心。
*   在开始处理我的应用程序后不久发现 PDO 后，我将所有代码移植到使用 PDO 的预准备语句。
*   我正在*转义*使用`htmlentities()`.
*   我的应用程序确实使用了会话变量和 cookie 变量，但两者的功能都非常不重要。
*   我已经设计了我的表单处理功能，无论表单是否以某种方式被更改或从服务器外提交（即我总是检查提交的数据以确保其有效）都无关紧要。
*   我已尽力使所有错误消息和异常消息变得礼貌但非常晦涩。
*   我正在强制通过 https 提供包含敏感信息的页面（例如登录页面）。

当我第一次开始编写我的应用程序时，我不知道准备好的语句，这是一个很大的问题。我还有什么遗漏吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:30:59.230

OWASP 维护了一个[最重要的 10 个 Web 应用程序安全风险](http://owasptop10.googlecode.com/files/OWASP%20Top%2010%20-%202010.pdf)列表（警告，PDF 下载）。这是从 2010 年开始的，但我认为它仍然适用，也许现在更是如此。

注入和 XSS 是前两个，但您当然应该注意其他 8 个。如果您使用的是现有的 CMS，可能已经考虑了其中的许多，但是 CMS 越流行，您遇到漏洞的风险就越大，因为黑帽试图在其中找到漏洞。

如果您不存储信用卡、订单历史记录、地址甚至电子邮件等关键数据，那么只要您采取基本的预防措施，我就不会*太*担心您的网站会受到影响（听起来您是）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T22:29:32.667

如果您担心安全问题，一个很好的资源是[OWASP - 十大应用程序安全风险](https://www.owasp.org/index.php/Top_10_2010-Main)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-19T04:09:52.563

在 Web 应用程序（特别是 PHP）中要注意的最重要的事情是对用户输入的所有输入进行***[数据验证，这些输入会进一步保存在您的数据库中。](https://www.owasp.org/index.php/Data_Validation)***

对于安全的应用程序，所有事务都应在 HTTPS 上完成。对于安全的 cookie 管理，应该实现***[Secure 和 HTTPOnly cookie。](http://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly)***

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T22:46:04.937

还有一些我还没有提到的观点。其中大部分与代码无关——我不确定您是否只希望与代码相关的东西，但我还是会提到它们。

*   备份（用户数据）。应该是不言而喻的
*   版本控制。如果你有一个大错误，你想访问以前的版本。
*   审计跟踪、警报和日志记录。如果你真的遇到麻烦，你将如何发现？你能追查到底发生了什么吗？如果您知道有问题但不完全知道是什么，您是否能够诊断问题？
*   托管。你在哪里托管？你有足够的带宽和监控吗？如果你得到 DOSed 会发生什么？你能阻止不需要的流量吗？
*   缓存。如果需要，您可以更改它吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-13T00:19:06.047

总是剩下一件事。可用性:) 安全性包括三个方面：

*   **机密**性（没有人可以阅读他们无权访问的内容）
*   **完整性**（没有人可以更改他们应该更改的任何数据，即使如此，您也必须能够检测到它是否发生）
*   **可用性**（数据、应用程序必须可用）

您做得非常好，并且处理了前两个（凭证、准备好的声明、htmlentities ......），但它们都不能帮助抵御 DoS 攻击。您应该能够检测到是否有人拍打您的网站并禁止攻击者访问您的服务器。虽然这可以在 PHP 中完成（在 php 的第一行踢出攻击者比让他们初始化框架、数据库连接等要好得多），但它可以在较低层中更有效地完成（例如：nginx/apache， iptables，打鼾）。

但是，您所要求的通常涉及风险管理。在实际应用中，您无法为所有可能的攻击、边缘情况等做好准备。您需要做的是按概率和影响对所有风险进行分类（[http://www.jiscinfonet.ac.uk /InfoKits/infokit-related-files/Resources/Images/risk-matrix](http://www.jiscinfonet.ac.uk/InfoKits/infokit-related-files/Resources/Images/risk-matrix)）。有了这个，您可以首先关注最重要（最高）的风险，并且可能您可以完全忽略底部的下部。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T22:30:00.057

SQL 注入和 XSS 是最突出的 Hacking 方法。

如果您使用准备好的语句，您将受到 SQL 注入的影响。

此外，如果 htmlentities() 在您显示 HTML 的所有位置上，您应该是安全的。

# svn - SVN文件系统结构？

> ID：13352587
> 
> 赞同：1
> 
> 时间：2012-11-12T22:25:37.447
> 
> 标签：svn, version-control

我想了解 SVN 存储库的默认布局。我的理解是这是布局：

```
/trunk
     /Project1
     /Project2
/branches
     /Project1
     /Project2
/tags
     /Project1
     /Project2 
```

但是回购不一定要遵循这种布局。如何确定现有 svn repo 的布局？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:32:05.860

SVN 中的存储库布局完全取决于其用户 - 它不必遵循任何约定，除非使用复杂的钩子明确强制执行（这不是很典型）。

您可以使用该`svn list`命令远程探索 svn，即无需检查：

```
svn list http://myserver/svn/repo 
```

它也可以递归使用，或产生 XML 输出：

```
-R [--recursive]         : descend recursively, same as --depth=infinity
--depth ARG              : limit operation by depth ARG ('empty', 'files',
                          'immediates', or 'infinity')
--xml                    : output in XML 
```

除此之外，您还可以查看指定修订版的状态。以下命令为您提供了完整的选项列表：

```
svn list --help 
```

# embedded-linux - 设备上没有剩余空间？

> ID：13352594
> 
> 赞同：5
> 
> 时间：2012-11-12T22:26:14.243
> 
> 标签：embedded-linux, glib, vala, fileutils

根据 df 的说法，设备上有足够的空间（大约 50G）。

```
/ # df db
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/mmcblk0p3        61812032  11308736  50503296  18% /db 
```

为什么这个 vala 代码可能另有说明？

```
try 
{
    FileUtils.set_data(bmp_path, bmp);
} 
catch (Error e)
{
    printf("Error! FileUtils.set_data %s\n%s\n", bmp_path, e.message);
} 
```

当然，代码会打印出来

```
Error! FileUtils.set_data /db/20121112/165206.0.bmp
Failed to create file '/db/20121112/165206.0.bmp.9X8PNW': No space left on device 
```

GLib.FileUtils 在一个目录中可以处理的文件数量是否有限制？/db/20121112 包含 27220 个文件（一半 jpeg 和一半 bmp）。

mmcblk0p3 是这样创建的

```
echo -e "n\np\n3\n66\n\nt\n3\nc\nw" | fdisk /dev/mmcblk0 
```

并像这样格式化

```
mkfs.vfat -n DB -F 32 /dev/mmcblk0p3 
```

这可能无关紧要，但该设备是 64G SD 卡，mmcblk0p1 和 mmcblk0p2 用于引导和 rootfs。

像 Barmar 在这样的评论中建议的那样检查 inode 会导致

```
df: invalid option -- 'i'
BusyBox v1.18.2 (2012-11-09 13:08:26 EST) multi-call binary. 
```

这很奇怪，因为根据[BusyBox 文档](http://www.busybox.net/downloads/BusyBox.html)， df -i 是有效的

```
df [-Pkmhai] [-B SIZE] [FILESYSTEM...]
-i Inodes 
```

还有另一种检查inode的方法吗？

更新 [11-15-2012]：我认为问题可能是每个文件夹中的文件太多，所以我修改了代码以每小时而不是每天打开一个新文件夹，但是在使用 16.7 保存大约均匀分布在 7 个文件夹中的 44354 张图像后它仍然死机64 GB SD 卡。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T20:43:56.720

df 只有在busybox 中有-i，如果`FEATURE_DF_FANCY`在编译时启用。

对于 FAT32 卷，一个文件夹中可以存储的最大文件数为 65,534。

一个 FAT32 目录可以有 65,536 个目录条目。

FAT32 没有 inode，而是由内核不稳定地生成/模拟并缓存。

按照提供的代码和错误消息。

[首先，](http://www.kernel.org/doc/man-pages/online/pages/man3/errno.3.html)与您看到的消息相关的错误是 `ENOSPC No space left on device`这里。

`FileUtils.set_data`调用 glib fileutils 函数`g_file_set_contents`（源代码位于[此处](http://git.gnome.org/browse/glib/tree/glib/gfileutils.c)，Vala 提交消息位于[此处](https://mail.gnome.org/archives/commits-list/2010-April/msg09091.html)）

在 Linux 上（Windows 具有基于 ifdef 遵循的附加逻辑）

`g_file_set_contents`在同一源文件 gfileutils.c 中调用以下函数

*   `write_to_temp_file`
*   `rename_file`
*   `g_unlink`

正如您的错误消息中提到`db/20121112/165206.0.bmp.9X8PNW`的那样`/db/20121112/165206.0.bmp`，返回的函数`ENOSPC`是`write_to_temp_file`。

从错误消息的另一部分 ( `Failed to create file`) 我们知道导致错误的函数调用`g_mkstemp_full`是响应设置文件描述符 fd 的初始值的函数调用。

这个调用`get_tmp_file`，这个调用`wrap_g_open`，也就是GTmpFileCallback，用来判断文件描述符的值`fd`。

`wrap_g_open`调用`g_open`（位于[gstdio.c](http://git.gnome.org/browse/glib/tree/glib/gstdio.c)中）与其名称相符。

`g_open`[此处](http://linux.die.net/man/2/open)`open`记录的调用以及 ENOSPC 描述为.`pathname was to be created but the device containing pathname has no room for the new file`

在 FAT 的内核源代码中，只有两个源文件返回`ENOSPC`,`/source/fs/fat/dir.c`和`/source/fs/fat/fatent.c`.

在通过处于某种错误状态`/source/fs/fat/dir.c` 返回的函数中，当目录条目的数量大于 FAT32 的最大目录大小时，它会执行此操作，该大小被评估为 2097152。`ENOSPC``fat_add_entries`

在直接`/source/fs/fat/fatent.c`返回的函数中是，当根据超级块信息的空闲簇数小于请求分配的簇数时执行此操作。`ENOSPC``fat_alloc_clusters`

[根据此处](http://support.microsoft.com/kb/184006)，使用 FAT32 文件系统的卷上的最大可能簇数为 268,435,445 。

您发布的 format 命令使用 mkdosfs 默认值，即每个集群 2 个扇区。指定包括 -s 、 -R 在内的各种选项可能会改变可用集群的数量，尽管我看到它的唯一用途是与 128KB 块对齐以增加磁盘吞吐量。

我不知道你的SD卡有多少个扇区，我无法计算出簇的总数。

我不相信你已经超过了最大目录大小（虽然我不能确定），所以我相信这与 SD 卡上的空闲集群数量有关。

要么您的 SD 卡合法地不在集群中，要么文件系统只是认为它不在集群中。在文件系统上运行 fsck（文件系统检查）可能会有所帮助。

不同的 SD 卡的行为方式是否相同？

# java - Quartz 调度器，知道作业何时完成

> ID：13352595
> 
> 赞同：3
> 
> 时间：2012-11-12T22:26:22.420
> 
> 标签：java, quartz-scheduler

我的情况依赖于知道工作何时完成。

基本上，单身经理会跟踪一堆工作及其日程安排。假设 B 跟随 A，当 A 执行调度程序时删除 B 的作业并重新调度它以在时间上更接近 A。

我遇到的问题是在工作完成时通知经理

```
public class Action extends ScheduledEvent implements Job {

    public Action() {
    }

    protected Action(String name, MomentInTime momentInTime, FireEventFrequency repeatFrequency) throws SchedulerException {
        super(momentInTime, repeatFrequency);
    }

    @Override
    public void execute(JobExecutionContext jobExecutionContext) throws JobExecutionException {
        // Do some work
        EventScheduleManager.getInstance().eventComplete(this);

    }
} 
```

我意识到为什么会发生这种情况是由于反射，并且在调度时`this`重新初始化并且现在由经理知道。

有办法解决吗？您将如何通知经理实体其安排的工作已完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T22:13:12.893

我最终将工作名称传回给经理

```
 EventScheduleManager.getInstance().eventComplete
        (jobExecutionContext.getJobDetail().getName()); 
```

经理自己坚持`Map<String,ScheduledEvent>`从那里拿走它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T23:02:34.867

您可以创建一个包装器，如下所示：

```
public class DoubleAction extends ScheduledEvent implements Job {
    private final Job job1,job2;

    public DoubleAction(Job job1, Job job2) {
       this.job1=job1;
       this.job2=job2;
    }

    @Override
    public void execute(JobExecutionContext jobExecutionContext) throws JobExecutionException {
       job1.execute(jobExecutionContext);
       job2.execute(jobExecutionContext);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:31:07.963

据我了解，他们对基于工作流的作业（您必须保证一个跟随另一个）的建议是让第一个作业为其继任者创建一个条目，以便在完成后立即执行。

# typo3 - TYPO3 mod.php 无需登录即可访问（Extbase）

> ID：13352597
> 
> 赞同：0
> 
> 时间：2012-11-12T22:26:24.650
> 
> 标签：typo3, fluid, google-cloud-messaging, extbase

我正在编写一个带有*extbase 和流体*的 TYPO3 扩展，它应该能够向 android 设备发送推送通知。

为此，我需要从 google 捕获包含*registerID*作为*字符串的***POST**请求。所以，我有了将 POST 发送到**mod.php**的想法，包括参数“ *controller* ”和“ *action* ”。喜欢：[http](http://mywebsite.com/typo3/mod.php?M_web_myextension&action=register&controller=Register) ://mywebsite.com/typo3/mod.php?M_web_myextension&action=register&controller=Register ....类似的东西。因为我需要在我的控制器中处理registrationID。

 *****但是 mod.php 只能被登录的用户或管理员访问，如果有人没有登录，它会重定向到登录公式。所以我的 Android-App 回复：FileNotFoundException。

如何从 TYPO3 外部将 POST 数据发送到我的 extbase 控制器？

或者我怎样才能让 TYPO3 之外的每个人都可以访问 mod.php？

欢迎任何其他建议！

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:42:46.457

操作`typo3/mod.php`似乎是一个错误的想法，因为它**需要**一个活跃的后端登录用户。而且你**不能**让任何人都可以访问它。

相反，您需要构建一个`Front-end`插件，该插件允许在没有身份验证的情况下进行连接，然后通过隐藏在表单中的一些令牌`authenticate`和您的用户进行连接。`authorize`

当然，您应该对表单中传递的凭据使用 Android 和 TYPO3 级别的加密，否则每个人都可以伪造它。*****

# iphone - NSURLConnectionDelegate 没有被调用

> ID：13352599
> 
> 赞同：0
> 
> 时间：2012-11-12T22:26:32.560
> 
> 标签：iphone, ios, nsurlconnection, nsurlconnectiondelegate

我是 iOS 世界的另一个新手，并且一直试图弄清楚 NSURLConnection 如何与它的委托一起工作。我运气不太好。在网上浏览了几个例子后，我创建了以下测试类。我遇到的问题是我的委托方法都没有被调用过。我的超时循环存在，每个都显示没有跟踪消息。我已经通过 tcpmon 运行了这个，可以看到请求发出并发送回响应，但没有任何东西传递给我的代表。

谁能告诉我我做错了什么。

谢谢。

这是我的代码：

```
TestRequest.h

#import <Foundation/Foundation.h>

@interface TestRequester : NSObject <NSURLConnectionDataDelegate>

@property BOOL finished;

-(void)testRequest;
@end 
```

和实施：

```
#import "TestRequester.h"

@implementation TestRequester

-(void)testRequest {

    NSString *url = @"<your favourite URL>";
    NSMutableURLRequest *theRequest=[NSMutableURLRequest requestWithURL:[NSURL URLWithString:url]
                                cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                                timeoutInterval:60.0];
    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self startImmediately:YES];
    if (theConnection) {
        NSLog(@"Connection created.  Waiting....");
        int count = 20;
        while (!_finished && count-- > 0)
            [NSThread sleepForTimeInterval:0.5];
        if (_finished)
            NSLog(@"Request completed");
        else
            NSLog(@"Request did not complete");
    } else {
        NSLog(@"Connection was not created!");
    }

}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    NSLog(@"-------------> Received data");
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    NSLog(@"-------------> Received response");
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    NSLog(@"-------------> connectionDidFinishLoading");
    _finished = YES;
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    NSLog(@"-------------> Received error");
    _finished = YES;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:48:20.197

看起来您的连接超出了范围。您可能正在使用ARC。

```
TestRequest.h

#import <Foundation/Foundation.h>

@interface TestRequester : NSObject <NSURLConnectionDelegate>
{
    NSURLConnection *theConnection;
}
@property BOOL finished;

-(void)testRequest;
@end

-(void)testRequest {

NSString *url = @"<your favourite URL>";
NSMutableURLRequest *theRequest=[NSMutableURLRequest requestWithURL:[NSURL URLWithString:url]
                            cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                            timeoutInterval:60.0];
theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self startImmediately:YES];
if (theConnection) {
    NSLog(@"Connection created.  Waiting....");
    /*int count = 20;
    while (!_finished && count-- > 0)
        [NSThread sleepForTimeInterval:0.5];
    if (_finished)
        NSLog(@"Request completed");
    else
        NSLog(@"Request did not complete");*/
} else {
    NSLog(@"Connection was not created!");
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:29:31.587

您需要在标题中将连接委托设置为 NSURLConnectionDelegate 而不是 NSURLConnectionDataDelegate 类型。据我所知。

```
@interface TestRequester : NSObject <NSURLConnectionDelegate> 
```

请参阅本页连接协议下的部分:) [https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/doc /c_ref/NSURLConnection](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSURLConnection)

# sql - 如果记录为空，则添加值

> ID：13352600
> 
> 赞同：1
> 
> 时间：2012-11-12T22:26:33.087
> 
> 标签：sql, sql-server, sql-server-2005

我有一个包含以下数据的表：

```
CUSIP   SEDOL   DESC
1111    NULL    ABC Corp
1234    NULL    ABCD Corp
NULL    12      ABCDE Corp 
```

现在我在不同的数据库服务器上有另一个表：

```
CUSIP   SEDOL   DESC
1111    18      ABC Corp
1234    19      ABCD Corp
1246    12      ABCDE Corp 
```

如何根据不同数据库服务器中表中提供的值填充第一个表中的 NULL 值？（我使用的是 SQL Server 2005）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:29:16.367

```
update table1 set
sedol = (select sedol from database2.table2 where desc = table1.desc)
where sedol is null; 
```

从您的问题`cusip`中不清楚是否重要，因此您可能需要：

```
update table1 set
sedol = (select sedol from database2.table2 where cusip = table1.cusip)
where sedol is null; 
```

要更新 cusip，请使用以下命令：

```
update table1 set
cusip = (select cusip from database2.table2
         where desc = table1.desc
         and sedol = table2.sedol)
where cusip is null; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T13:57:44.830

添加链接服务器后，您的脚本将如下所示

```
MERGE dbo.your_table AS target
USING [AnotherServer].dbo.your_table AS source
ON (target.[DESC] = source.[DESC])
WHEN MATCHED AND (target.CUSIP IS NULL OR target.SEDOL IS NULL)
  THEN UPDATE SET target.CUSIP = source.CUSIP,
                  target.SEDOL = source.SEDOL; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:30:55.903

```
Update BadTable set BadTable.SEDOL=Coalesce(BadTable.SEDOL,GoodTable.SEDOL) from GoodTable where GoodTable.[DESC]=BadTable.[DESC] 
```

也许

```
where GoodTable.[CUSID]=BadTable.[CUSID] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:32:10.553

```
update table1 t1
set t1.sedol 
   = coalesce (t1.sedol,(select top 1 sedol 
                     from table2 
                     where t1.cusip = cusip
                     and t1.desc = desc)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T22:33:34.760

首先根据蒂姆的评论添加一个链接服务器。

然后像这样的一些查询依赖于匹配规则。

```
Update
  table1
Set
  Sedol = t2.Sedol
From
  table1 t1
    Inner Join
  server2.db2.schema2.table2 t2
    On t1.CusIP = t2.CusIP and t1.[Desc] = t2.[Desc] And t1.Sedol Is Null 
```

# java - 将代码点附加到 java.lang.Appendable

> ID：13352601
> 
> 赞同：3
> 
> 时间：2012-11-12T22:26:44.770
> 
> 标签：java, standard-library

[`java.lang.Appendable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Appendable.html)支持`append(char)`但不支持`appendCodepoint(int)`。

是否有任何有效的方法（不创建对象）使用标准库将代码点附加到`Appendable`与补充代码点一起使用的代码点？

我宁愿不推出自己的 UTF-16 编码函数，而且其中的所有内容都`java.lang.Character`需要使用`char[]`s.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:31:10.540

我的意思是，听起来你想要的只是`Character.toChars(int)`没有阵列开销，对吧？这是[`Character.toChars`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/Character.java#Character.toChars%28int%29);的来源 复制自己并不是特别复杂。

# java - java.lang.ClassNotFoundException: com.sun.faces.config.ConfigureListener

> ID：13352606
> 
> 赞同：5
> 
> 时间：2012-11-12T22:27:01.093
> 
> 标签：java, spring-mvc, listener, classnotfoundexception, jspx

我正在学习 Java、Spring MVC 和 Eclipse。我现在正在阅读一本书，并试图让第一个 Spring MVC 示例运行。当我从 Eclipse 运行它时，我收到此错误：

```
INFO: TLD skipped. URI: http://java.sun.com/jsp/jstl/xml is already defined
Nov 12, 2012 5:12:21 PM org.apache.catalina.core.ApplicationContext log
INFO: No Spring WebApplicationInitializer types detected on classpath
Nov 12, 2012 5:12:22 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Error configuring application listener of class com.sun.faces.config.ConfigureListener
java.lang.ClassNotFoundException: com.sun.faces.config.ConfigureListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1714)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1559)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:532)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:514)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:133)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4727)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:650)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1582)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Nov 12, 2012 5:12:22 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Skipped installing application listeners due to previous error(s)
Nov 12, 2012 5:12:22 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Error listenerStart
Nov 12, 2012 5:12:22 PM org.apache.catalina.core.StandardContext startInternal
SEVERE: Context [/TestAppOne] startup failed due to previous errors
Nov 12, 2012 5:12:22 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory C:\Apps\springsource\vfabric-tc-server-developer-2.7.2.RELEASE\base-instance\webapps\manager
Nov 12, 2012 5:12:22 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory C:\Apps\springsource\vfabric-tc-server-developer-2.7.2.RELEASE\base-instance\webapps\ROOT
Nov 12, 2012 5:12:22 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
Nov 12, 2012 5:12:22 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 2537 ms 
```

我看到另一篇关于包含该元素的 web.xml 文件的帖子，而我的不是使用 sun 版本，而是 spring 版本：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

    <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/root-context.xml</param-value>
    </context-param>

    <!-- Spring Security Configuration -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Spring MVC filters -->
    <filter>
        <filter-name>CharacterEncodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>

    <filter>
        <filter-name>HttpMethodFilter</filter-name>
        <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
    </filter>

    <filter>
        <filter-name>Spring OpenEntityManagerInViewFilter</filter-name>
        <filter-class>org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>CharacterEncodingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter-mapping>
        <filter-name>HttpMethodFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter-mapping>
        <filter-name>Spring OpenEntityManagerInViewFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Creates the Spring Container shared by all Servlets and Filters -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- Processes application requests -->
<!--    
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
 -->

</web-app> 
```

我不知道去哪里寻找项目中的错误，有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-09T07:33:17.737

我有同样的错误，但找到了解决我们问题的方法，我猜你正在使用 maven 和 tomcat 7。我部署在 Glassfish 4 中并且工作得很好，所以对我来说这似乎很陌生。

**解决方案**：

修复您的 pom.xml 以在 Tomcat 7 中工作。

1.  javaee-api 应该有范围：提供。
2.  将 jstl-api 依赖 1.2 添加到您的 pom.xml，范围：编译。

例子：

```
<!-- Tomcat 7 Deploy -->
<dependency>
    <groupId>javax.servlet.jsp.jstl</groupId>
    <artifactId>jstl-api</artifactId>
    <version>1.2</version>
    <scope>provided</scope>
</dependency>
<!-- JavaEE -->
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0</version>
    <scope>compile</scope>
</dependency> 
```

**解释：**

您正在添加 JEE 6：

```
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0</version>
    <scope>compile</scope>
</dependency> 
```

你得到了错误：

```
Dec 08, 2013 9:54:37 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Error configuring application listener of class com.sun.faces.config.ConfigureListener
java.lang.ClassNotFoundException: com.sun.faces.config.ConfigureListener
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1702)
... 
```

不知何故，将 javaee-api.jar 添加到 WEB-INF/lib 会尝试搜索或加载 jsf 配置文件，即使我们没有使用它。然后将范围更改为提供，我开始收到缺少 JSTL 库的新错误。

```
 Dec 09, 2013 1:23:49 AM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [controllerServlet] in context with path [/util-webapp] threw exception [Handler processing failed; nested exception is java.lang.NoClassDefFoundError: javax/servlet/jsp/jstl/core/Config] with root cause
java.lang.ClassNotFoundException: javax.servlet.jsp.jstl.core.Config
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1702)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1547)
    at org.springframework.web.servlet.support.JstlUtils.exposeLocalizationContext(JstlUtils.java:97)
    at org.springframework.web.servlet.view.JstlView.exposeHelpers(JstlView.java:135)
    at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:211)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:263)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1208)
    at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:992)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:939)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:856)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:936)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:827)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:812)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:953)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1041)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:603)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

所以我结束了添加 jstl-api 库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-07T07:29:11.957

我遇到了同样的问题，只需将依赖范围更改为提供即可解决！

```
<dependency>
    <groupId>javax</groupId>
    <artifactId>javaee-api</artifactId>
    <version>6.0</version>
    <scope>provided</scope>
</dependency> 
```

# php - PHP 混合格式日期/时间 - 星期几和时间

> ID：13352614
> 
> 赞同：0
> 
> 时间：2012-11-12T22:27:57.647
> 
> 标签：php, mysql, sql, datetime

所以，我正在为研讨会开发一个 PHP 调度程序。基本上我有一个研讨会列表，每个研讨会每周在同一天的同一时间开会一次，并运行固定的周数。

现在，在我的数据库中，我有 pkey、开始日期、结束日期、研讨会名称以及表示日期和时间的字符串。

现在，我有一个页面显示当前正在运行的所有研讨会，基于将今天的日期与所有研讨会的开始和结束日期进行比较。现在我只想展示今天的研讨会会议。

我假设我需要将日程表变量设为 DATE。varchar 字符串是一个 dect 磁带修复，因为我什至不知道从哪里开始这部分。

如何格式化 SQL 变量以将日期和时间存储在格式为 [weekday] [time] 的 DATE 类型变量中？这可能吗？

编辑

能理解我在问什么的人可以帮我改写我的问题吗？似乎我无法明确我的要求。

例如，假设有 MySQL 研讨会，时间是星期三晚上 7 点，从 11 月 14 日开始，到 12 月 26 日结束。我将星期三晚上 7 点保存为 VARCHAR 字符串，并将 StartDate 和 EndDate 保存为日期。现在，我可以毫无问题地列出当前正在进行的所有研讨会，但我想仅通过与当前工作日对应的一周中的某一天开会来过滤这些研讨会。为此，我需要将 'Wednesday 7pm' 转换为 DATE 变量，同时仍保持完全相同的格式以在日程表中回显。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:32:40.253

不鼓励将日期存储为字符串。MySQL 包括许多[日期/时间函数](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)。您应该将此数据存储为[DateTime 数据类型](http://dev.mysql.com/doc/refman/5.1/en/datetime.html)并使用这些函数之一对其进行操作。

例如：

```
-- returns 1 for Monday
SELECT DATE_FORMAT(CURDATE(), '%w'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:33:24.837

MySQL 使用 'YYYY-MM-DD HH:MM:SS' 作为日期时间，使用 'YYYY-MM-DD' 作为日期格式。

根据您要如何存储它，您可以添加 DATE 列，然后进行更新：

更新表设置 datecolumn = 'date_string_col';

只要您现在拥有的 varchar col 以适当的格式存储，否则，您将不得不将格式更改为指定的格式。

欲了解更多信息：[http ://dev.mysql.com/doc/refman/5.1/en/datetime.html](http://dev.mysql.com/doc/refman/5.1/en/datetime.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:38:34.793

由于这里没有人能够理解我的问题，我将自己回答。在与我认识的一些专业人士和讲师交谈后（他们理解我想要的东西没有问题......），我发现这在技术上是不可能的，但一种解决方法是选择那个工作日的任意日期，并使用它作为替身，则始终以工作日格式呈现。

# macos - 如何从 OSX 中的自定义工作表中获取信息

> ID：13352616
> 
> 赞同：1
> 
> 时间：2012-11-12T22:28:09.770
> 
> 标签：macos, cocoa, customization, cocoa-sheet

我创建了一个自定义工作表，其中有一个表格。该表中包含用户名列表：

[![带有用户名的自定义工作表](../Images/3d83c87c034bd1b3eb6280e61df638e3.png)](https://i.stack.imgur.com/hnEy7.png)

我想获取选定的行值并在应用程序中使用它。我可以通过以下方式获得该行：

```
-(void)tableViewSelectionDidChange:(NSNotification *)notification{
    NSInteger selectedRow = [[notification object] selectedRow];
    if(selectedRow != -1){
        self.selectedRowDict = [self.usersArray objectAtIndex:selectedRow];
    }
} 
```

但现在我的问题是我想将数据传递回启动此工作表的主窗口。

以下是相同的代码：

```
if(!self.accountSheet){
    [NSBundle loadNibNamed:@"AccountSheet" owner:self];
}
[NSApp beginSheet:self.accountSheet
   modalForWindow:[mainWindowView window]
    modalDelegate:self
   didEndSelector:@selector(sheetDidEnd:returnCode:contextInfo:)
      contextInfo:NULL]; 
```

这个怎么做？

请注意：工作表是在与主窗口笔尖不同的笔尖中创建的。每个 nib 都有自己的 NSObject 扩展类来实现动作和其他与窗口相关的工作。工作表笔尖作为文件所有者与主窗口相关，并且在主笔尖 NSObject 类中有一个 IBOutlet

如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T05:43:08.807

让您的工作表将信息存储在一个实例变量中，就像您正在做的那样，然后在您的 中`didEndSelector`，只需从工作表中获取值：`self.accountSheet.selectedRowDict`或 what-have-you。

# scala - 如何在 Play Framework（2.0 版，使用 Scala）中测试需要上传文件的操作？

> ID：13352618
> 
> 赞同：6
> 
> 时间：2012-11-12T22:28:18.867
> 
> 标签：scala, playframework, playframework-2.0, functional-testing

文档的[编写功能测试](http://scala.playframework.org/documentation/2.0.4/ScalaFunctionalTest)部分非常少，并且缺少完整提交模拟表单值的详细信息。我以某种方式（不记得如何/在哪里）确定您可以通过传递 a`Map`来提交基本表单值（模拟 POST 请求），`FakeRequest`如下所示：

```
val Some(result) = routeAndCall(FakeRequest(POST, "/path/to/test", FakeHeaders(),
                                Map("postedVariable" -> Seq("and a value")))) 
```

但是，这似乎不允许“上传”文件的情况。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-16T08:05:46.573

我们的文件上传测试如下所示：

```
val tempFile = TemporaryFile(new java.io.File("/tmp/the.file"))
val part = FilePart[TemporaryFile](key = "image", filename = "the.file", contentType = Some("image/jpeg"), ref = tempFile)
val formData = MultipartFormData(dataParts = Map(), files = Seq(part), badParts = Seq(), missingFileParts = Seq())
val result = routeAndCall(FakeRequest(POST, "/path/to/test", FakeHeaders(), formData)) 
```

`"image"`您希望在其中找到文件内容的 HTML 表单元素的名称在哪里。

如果您`BodyParsers.maxLength`用于限制上传的大小，则可以替换`formData`为`Right(formData)`

# tsql - 包括实际查询计划会增加执行时间

> ID：13352620
> 
> 赞同：0
> 
> 时间：2012-11-12T22:28:30.543
> 
> 标签：tsql, sql-server-2005, sql-execution-plan, cross-apply

我使用的是 SQL Server 2005，我有一个相当复杂的查询，需要一两秒才能执行。

我想使用查询计划来调试性能，但是当我在输出中包含实际的执行计划时，查询从需要 2 秒到近 2 分钟 - 有时更长。

此查询中唯一有点有趣的代码是针对表值函数的几个交叉应用。有趣的是，当我删除这些交叉应用时，查询会在大约 100 毫秒内执行。

这是一个已知的问题？

# sql-server - 命名显式和隐式事务

> ID：13352623
> 
> 赞同：1
> 
> 时间：2012-11-12T22:28:38.110
> 
> 标签：sql-server, sql-server-2008

我在 SQL Server 2008 中遇到了一个小错误（功能）。

我有一个存储过程，我在其中以名称 @tran 开始显式事务

.... 声明 @tran varchar(30) = 'exp_trans';

BEGIN TRAN @tran IF @p_param 为空 ROLLBACK TRAN @tran ....

问题是，当我将 IMPLICIT_TRANSACTIONS 设置为 ON 并调用存储过程时，流程到达回滚部分，我将收到错误

“消息 6401，级别 16，状态 1，第 10 行无法回滚 exp_tran。找不到该名称的事务或保存点。”

这是某种功能，还是实际发生了什么？先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:42:59.837

[我相信这是因为嵌套事务而发生的，并且 SQL Server 2008 不支持在事务嵌套](http://msdn.microsoft.com/en-us/library/ms188929%28v=sql.100%29.aspx)时回滚到内部事务：

> 在一系列嵌套事务中用一个事务名命名多个事务对事务影响不大。只有第一个（最外面的）事务名称在系统中注册。回滚到任何其他名称（有效的保存点名称除外）都会产生错误。事实上，在回滚之前执行的所有语句都不会在发生此错误时回滚。仅当回滚外部事务时才回滚语句。

您的事务是嵌套的，因为隐式事务设置开始一个，begin trans 开始第二个（嵌套）事务。这使得回滚到命名事务失败。

# javascript - 使用基于元素的 AddMethod 动态 jQuery Validate 错误消息

> ID：13352626
> 
> 赞同：40
> 
> 时间：2012-11-12T22:28:51.087
> 
> 标签：javascript, jquery, jquery-validate

假设我有一个自定义 AddMethod 到 jQuery Validate，例如：

```
$.validator.addMethod('min-length', function (val, element) {
    // do stuff

// the error message here needs to be dynamic
}, 'The field cannot be less than than '
     + element.attr('data-min') + // it is within the closure, but it can't grab it
   ' length.'); 
```

我想不出一种方法来获取有问题的*元素*变量，并从中获取任何值。我在这里想念什么？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-11-12T22:57:25.173

通过查看验证器源代码，我认为应该这样做：

```
$.validator.addMethod('min-length', function (val, element) {
    return this.optional(element) || val.length >= $(element).data('min');
}, function(params, element) {
    return 'The field cannot be less than than ' + $(element).data('min') + ' length.';
}); 
```

在您的原始代码中，消息字符串不在闭包内；闭包是 的第二个参数`addMethod`，错误消息是第三个参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-15T18:41:26.250

首先，我很欣赏 Barmar 的回答。

如果您只是想，您可以使用任何带有参数值的 jquery 验证消息，您可以简单地调用消息实例。

这是代码

```
 jQuery.validator.addMethod("custom_min", function(value, element, param) {
                value = replaceAll(value, ',' , '');
                return this.optional( element ) || value >= param;
            },jQuery.validator.messages.min ); 
```

在 jquery 验证中

```
jQuery('#form_id').validate({
   rules: {
    'field_name': {
       required: true,
       number: true,
       custom_min: 1000
   }
}); 
```

因此，如果您输入小于 1000 的值。它会抛出错误消息，“请输入大于 1000 的值（您在验证中输入的数量）”。如果您的验证需要对任何当前方法进行任何修改或你正在用多种语言开发它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-05T12:18:11.633

如果 Barmar 的回答对您不起作用，可能是因为您对元素的设置已经包含错误消息（例如，在 asp.net MVC 中从服务器设置）

因此 jQuery.validate 代码将忽略第二个参数为 $.validator.addMethod 设置的新默认值

一种解决方法是执行以下操作：

```
$.validator.addMethod('min-length', function (val, element) {
   this.settings.messages[element.name]['min-length'] = function () { return 'put your custom message here'; };

   return this.optional(element) || val.length >= $(element).data('min');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-12T18:18:31.140

偶然发现了这个半成品。根据结果​​，我的消息非常动态。所以就在我调用 validate 之前，我向元素添加了一个属性 data-msg="My custom message"。验证者将接受：

```
err_msg = 'My custom message';
$('#my_element_id').attr('data-msg', err_msg);
$('#my_form_id').validate().element('input[name=\'my_element_name\''); 
```

在 jquery.validate.js 中的 customDataMessage 下找到了一些代码引用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-20T19:03:00.713

在这里聚会迟到了，但这似乎对我有用：

```
jQuery.validator.addMethod("minDate", function(value, element, param) {
    var inputDate = new Date(value);
    return (inputDate >= param)
    }, function(param, element) {
        return 'Enter a date greater than or equal to ' + $.datepicker.formatDate("M d, yy", new Date(param));
}); 
```

其中 minDate 值先前已在控件上设置以验证如下内容：

```
$('form:first').validate({
    rules: {
        "date-filed": {
            minDate: new Date(2000,0,0)
        },
... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-30T17:24:34.080

**代码：**

```
 $.validator.addMethod("strongePassword", function(value) {
        return /^[A-Za-z0-9\d=!\-@._*]*$/.test(value) && /[a-z]/.test(value) && /\d/.test(value) && /[A-Z]/.test(value);
    },"The password must contain at least 1 number, at least 1 lower case letter, and at least 1 upper case letter"); 
```

**用于：**

```
 rules: { 
        password: {
                    required: !0,
                    strongePassword: true
                 },
     } 
```

# ios - Sharekit + Facebook OpenGraph

> ID：13352627
> 
> 赞同：0
> 
> 时间：2012-11-12T22:29:04.270
> 
> 标签：ios, facebook-graph-api, sharekit

我一直在寻找一个使用 Facebook OpenGraph 和 ShareKit 2.0 的教程，但我从来没有找到过，而且我无法让它工作。我已经成功安装了这里提到的 Sharekit： [https ://github.com/ShareKit/ShareKit/wiki/Installing-sharekit](https://github.com/ShareKit/ShareKit/wiki/Installing-sharekit)

我还可以将我的 iOS 应用程序中的某些内容分享到用户的 Facebook Wall，但我不能使用 OpenGraph...（我想分享一个带有描述和图像以及其他信息的对象）我尝试按照 Scrumptious 示例（[https ://github.com/facebook/facebook-ios-sdk/blob/master/samples/Scrumptious/scrumptious/SCViewController.m](https://github.com/facebook/facebook-ios-sdk/blob/master/samples/Scrumptious/scrumptious/SCViewController.m)），但他们在该示例中不使用 ShareKit（正常...），我可以' t 弄清楚如何同时使用 Sharekit 和 OpenGraph。有什么特别要进口的吗？

提前感谢您的建议:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:38:46.277

如果您想分享带有描述的图像，您可以使用 Sharekit 来实现。

```
SHKItem *item = [SHKItem image:myUIImage title:@"My Title"];
[SHKFacebook shareItem:item]; 
```

# objective-c - 使用 Cocoa 控制路径栏

> ID：13352632
> 
> 赞同：0
> 
> 时间：2012-11-12T22:29:19.697
> 
> 标签：objective-c, xcode, macos, cocoa, nsview

不久前，我为我的应用[Significator for iTunes](https://itunes.apple.com/app/significator-for-itunes/id511708837)编写了一个路径栏控件。

顺便提一句。没有广告，仅用于测试目的；）您可以免费下载它以查看我在说什么。

Pathbar 是一个 NSView，并且有子子项，也就是 NSViews。问题出现在动画上。如果路径栏项目无法以全尺寸显示，则将鼠标悬停在其上时，它会以全尺寸动画显示。

我使用动画代理为项目的大小设置动画。所以例如`[item.animator setFrame:frame];`。现在，我必须对右边的所有子项做同样的事情，所以它们不会重叠。

这通常会产生意想不到的行为，尤其是从一个路径栏项目更改为另一个时。而且也不是很顺利。

我认为这可能不是正确的方法。有没有其他的动画方式？最好只设置项目的宽度，并且定位将是自动的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:46:00.630

我找到了解决方案并将其发布在[github 上](https://github.com/iluuu1994/Pathbar)。我从 NSPathControl 继承。其实很简单。

# javascript - 拉端的 Iscroll Javascript Ajax 请求？

> ID：13352633
> 
> 赞同：0
> 
> 时间：2012-11-12T22:29:20.330
> 
> 标签：javascript, ajax, javascript-framework, iscroll, pull-request

我在这里得到的几乎和这个例子一样：[iScroll教程](http://mobile.tutsplus.com/tutorials/mobile-web-apps/introduction-to-iscroll/)

我想要的是在滚动结束时执行 Ajax 请求，例如 Facebook 所做的。我可以用这个 iscroll 框架做到这一点吗？

如果我能做到这一点。如何？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:56:27.663

在构建 iScroll 时，您应该提供一个函数作为`onBeforeScrollEnd(that, event)`or`onScrollEnd(that)`选项（我现在不知道哪个是最好的）。

在该函数中，您检查`that.y == that.maxScrollY`在哪种情况下您是否处于垂直滚动的末尾。

# c++ - 返回标准::向量 退回垃圾

> ID：13352636
> 
> 赞同：-2
> 
> 时间：2012-11-12T22:29:30.420
> 
> 标签：c++, string

我今天在windows下有一段代码的奇怪行为

```
std::vector<std::string> getMACs() {
  std::vector<std::string> macs;
  for(/*something*/) {
    char buffer[100];
    sprintf_s(buffer, size, "get the mac address here");
    std::string s = "";
    s.append(buffer);
    printf("mac=%s\n", s.c_str();  //print the mac address correctly
    macs.push_back(s);
  }
  return macs;
}

int main(int, char**) {
  std::vector<std::string> macs = getMACs();
  for (size_t i = 0; i < mac.size(); i++) {
    printf("mac=%s\n", macs[i]);   //prints garbage
  }
} 
```

虽然函数内部的mac地址已经正确打印，但主要是打印垃圾，我唯一的解释是macs向量充满了垃圾字符串，但怎么会发生这种情况；对 string.append(const char*) 的调用，虽然通过引用传递，但 push_back() 函数应该调用 string 的复制构造函数，因此它不应该再指向一个在离开后会变成垃圾的字符串引用范围，对吧？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T22:36:42.037

```
printf("mac=%s\n", macs[i]);   //prints garbage 
```

因为`macs[i]`是 type `std::string`，`printf`不知道如何处理。尝试这个：

```
printf("mac=%s\n", macs[i].c_str()); 
```

或这个：

```
std::cout << "mac=" << macs[i] << '\n'; 
```

类型安全，FTW

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T22:30:55.737

您正在返回一个字符串：

```
 return s; 
```

你需要返回向量：

```
return macs; 
```

**编辑**后编辑，问题的可能原因是误用`printf`. 您可以遍历向量并打印如下内容：

```
std::vector<std::string> macs = getMACs();
for (std::vector<std::string>::const_iterator it = macs.begin(); it != mac.end(); ++it) {
  std::cout << *it << "\n";
} 
```

或者，在 C++11 中，

```
for (const auto& s : macs) {
  std::cout << s << "\n";
} 
```

# java - 没有系统调用的 *nix sync() 的 Java 实现

> ID：13352638
> 
> 赞同：5
> 
> 时间：2012-11-12T22:29:31.227
> 
> 标签：java, system-calls

我正在努力从现有的 Java 代码库中删除所有系统调用。我们在商业提供的闭源 JVM 中运行我们的应用程序。当 JVM 通过 getRuntime.exec() 进行系统调用时，java 调用整个 JVM 进程分叉，这会导致严重的性能损失。我们在 linux 平台上运行，但理想情况下尽量保持可移植性。

我在替换我们当前通过 getRuntime.exec() 方法使用的 sync() 调用时遇到了问题。我知道还有[这个](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileDescriptor.html#sync%28%29)sync() 方法和[flush()](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/OutputStream.html#flush%28%29)。根据[这篇文章](https://stackoverflow.com/questions/4072878/i-o-concept-flush-vs-sync)，我希望对所有打开的文件流进行同步和刷新。

我的问题是我不直接知道那里有哪些文件流和描述符。我认为解决这个问题的一种方法是检查 /proc/(jvm 进程号)/fd 文件夹，但我找不到使用纯 java 可靠地获取 JVM 进程号的好方法。我认为我可能能够获取某个类（FileDescriptor 类）的所有对象，但从我正在阅读的内容来看，这也是不可行的。

有没有人有关于如何在纯 java 中复制 *nix sync() 调用的建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T23:10:06.863

你所做的不仅仅是*一个*电话`sync`。您正在尝试执行“刷新所有文件缓冲区和`sync`”操作。你在 C / C++ 中也很难做到这一点。

除了查找所有打开文件的问题（您可能可以解决......）之外，还有一个更大的问题；即是否是刷新缓冲区*的正确时间。*

假设您的应用程序是多线程的，并且一个线程负责调用`sync`. 该线程如何知道正在写入文件的其他线程已达到文件的一致点？即，如果应用程序被杀死并重新启动，（假设）刷新的文件将包含应用程序的逻辑一致状态？答案是（很可能）它*不*知道。所以......事实上......如果应用程序在同步之前刷新，它并没有处于明显更好的位置。

还有另一个问题。假设线程 A 负责刷新/同步，而线程 B 正在愉快地写入某个输出流。考虑这个时间序列：

1.  线程 A 刷新文件
2.  线程 B 写入文件
3.  线程 A 调用同步

避免这种情况的唯一方法是让线程 A 同步并阻止所有其他正在写入文件的线程......*在*它执行刷新和同步之前。

我的建议是只进行同步，而忘记冲洗。以经典方式处理文件不一致的问题（通过让应用程序写入临时文件，并进行原子重命名），或者让同步线程与写入文件的线程协调......以便它仅在关键文件一致时“同步”。

# javascript - 向函数对象添加新属性

> ID：13352643
> 
> 赞同：2
> 
> 时间：2012-11-12T22:29:55.570
> 
> 标签：javascript

我试图理解以下模式：

```
// https://github.com/twitter/bootstrap/blob/master/js/bootstrap-collapse.js

  $.fn.collapse = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('collapse')
        , options = typeof option == 'object' && option
      if (!data) $this.data('collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.collapse.defaults = {
    toggle: true
  } 
```

它看起来像`collapse`一个函数对象。那么，为什么`defaults`可以作为属性添加到`collapse`?

以下[(jsFiddle) 片段](http://jsfiddle.net/sikusikucom/KTzUw/)尝试向函数对象添加新属性，但无济于事。它是什么？

```
var my_object = function () {
    alert('Hello World!');
};
my_object.name = 'my_object';

console.log(my_object.name);  // prints an empty string 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:32:34.683

是的，它是一个函数*对象*。`$.fn.collapse`javascript 中的所有对象都可以有属性，`defaults`.

你的小提琴不起作用，因为每个函数 [object] 都有一个不可写的[`name`属性](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/name)，其中包含函数的名称 - 如果它被命名的话。`my_object`您正在为具有空名称的变量分配一个匿名函数。请注意，它*是*一个字符串，而不是`undefined`! 看看[http://jsfiddle.net/KTzUw/3/](http://jsfiddle.net/KTzUw/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:32:43.983

`.name`是特殊的，大多数其他属性名称都有效：

```
var my_object = function () {
    alert('Hello World!');
};
my_object.someprop = 'my_object';
console.log(my_object.someprop);  // prints an empty string 
```

函数的`name`属性是保留的。

```
function foo() {};
console.log(foo.name); // "foo" 
```

在您的情况下，它是一个空字符串，因为它被声明为匿名函数：

```
var foo = function() {};
console.log(foo.name); // "" 
```

但是除了一些保留的属性名称之外，是的，您可以像分配任何对象一样分配函数的属性。这可能非常强大，因为它可以让您以一种非常干净的方式将数据与需要该数据的代码联系起来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:33:39.257

`name`*是函数实例*的保留*属性*，具有*不可配置*和*不可写*标志，您不能覆盖它。除此之外，*函数*也确实继承自*Object*并且可能具有属性。

 ***```
var my_fnc = function() { };

my_fnc.foobar = 42;

console.log( my_fnc_foobar ); // 42 
```***

# php - 使用变量时：致命错误：不能将字符串偏移量用作数组

> ID：13352646
> 
> 赞同：2
> 
> 时间：2012-11-12T22:30:21.853
> 
> 标签：php

下面的一段代码：

```
$field = 'field_total_comments_added';
$current_user_count = $user_data->$field['und']['0']['value']; 
```

返回错误：致命错误：不能将字符串偏移量用作数组

如果我只是使用：

```
$current_user_count = $user_data->field_total_comments_added['und']['0']['value']; 
```

代码工作得很好。为了使用一些自定义功能，我必须使用第一个代码块中显示的变量。我该如何解决这个问题？

如果您不清楚问题，请告诉我。

提前感谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T22:37:34.903

您可以使用这种常见的解决方法：

```
$current_user_count = $user_data->{$field}['und']['0']['value']; 
```

这基本上强制变量属性名称优先于数组访问运算符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:33:50.910

尝试：

```
$field = 'field_total_comments_added';
$current_user_count = ($user_data->$field)['und']['0']['value']; 
```

它可能只适用于 PHP 5.4。对于早期版本，还可以尝试：

```
$field = 'field_total_comments_added';
$item = $user_data->$field;
$current_user_count = $item['und']['0']['value']; 
```

# azure - 由于分配给 msdn 高级订阅的缓存超过 128 MB，Windows azure 被禁用

> ID：13352647
> 
> 赞同：1
> 
> 时间：2012-11-12T22:30:41.397
> 
> 标签：azure

我刚开始学习 Windows azure，本月我的 MSDN Premium 订阅超过了 128 MB 的缓存限制，我的帐户已被禁用。我试图找出默认情况下哪些服务使用缓存，因为我查看了使用日志并看到每天使用大约 8 MB 的东西。我没有做任何具体的事情，只是创建了一个网站，两个云服务（但没有部署任何包），一个服务总线命名空间，一个 sql 数据库，一个虚拟机（但经过一些测试后取消部署，磁盘仍然在存储中帐户）。

我的问题是导致缓存空间不断使用的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T10:14:10.410

我也对此感到困惑，并写了一篇关于[Azure 缓存计费](http://www.britishdeveloper.co.uk/2012/01/azure-appfabric-cache-billing.html)的帖子，但总结如下：

您已经分配了一个 128MB 的缓存供每个月使用，但由于它以百分比形式显示使用量，50% 意味着您还有 64MB 可用，但它不会像那样累积。认为 50% 意味着您还有半个月的时间使用缓存。

因为您已经设置了一个 128MB 的缓存，所以您正在使用它——无论您是否*实际*使用它。这就像在这方面的计算时间。

# java - executeUpdate() 调用后超时

> ID：13352648
> 
> 赞同：1
> 
> 时间：2012-11-12T22:30:42.820
> 
> 标签：java, jdbc, timeout, connection-timeout

我在 Java 程序中有以下场景：

```
...
try

   // 1
   PreparedStatement pstmt1 = conn.getPreparedStatement("SQL QUERY");
   pstmt1.setQueryTimeout(1);
   pstm.executeUpdate();
   System.out.println("1 executed");

   // 2
   PreparedStatement pstmt2 = conn.getPreparedStatement("SQL QUERY");
   pstmt2.setQueryTimeout(1);
   pstmt2.executeUpdate();
   System.out.println("2 executed");

   // 3
   PreparedStatement pstmt3 = conn.getPreparedStatement("SQL QUERY");
   pstmt3.setQueryTimeout(1);
   pstmt3.executeUpdate();
   System.out.println("3 executed");

catch(Exception e){

     e.printStackTrace();

}
... 
```

如果我“拔下电缆”并且在第一次 executeUpdate() 调用后与数据库的连接丢失。我如何告诉程序只等待 1 秒，如果没有响应立即进入 catch？

现在发生的事情是程序在该点之后卡住了（第一个 executeUpdate()，在输出“1已执行”处）。

pstmt.setQueryTimeout(1) 方法似乎不起作用。

我在服务器的连接池属性中设置了 10 秒后的连接超时。

很多分钟（半小时）后，我收到以下错误（预期错误）：

```
The Connection Manager received a fatal connection error from the Resource Adapter for resource jdbc/JNDI_BD1\.  The exception which was received is com.ibm.websphere.ce.cm.StaleConnectionException: [jcc][t4][2030][11211][3.58.82] A communication error occurred during operations on the connection's underlying socket, socket input stream, or socket output stream.  Error location: Reply.fill().  Message: No route to host. ERRORCODE=-4499, SQLSTATE=08001:com.ibm.db2.jcc.am.io: [jcc][t4][2030][11211][3.58.82] A communication error occurred during operations on the connection's underlying socket, socket input stream, or socket output stream.  Error location: Reply.fill().  Message: No route to host. ERRORCODE=-4499, SQLSTATE=08001:java.net.SocketException: No route to host 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:37:35.733

并非所有驱动程序都支持查询超时。但即使他们这样做了：查询超时并不是为了检测网络超时。查询超时等最有可能的选项将由数据库服务器处理（即：驱动程序询问服务器：如果查询时间超过 xxx，则中止查询），或者驱动程序和/或服务器根本不支持它。

套接字超时是一个更低级别的超时，大多数驱动程序都会为此设置连接属性（so_timeout、套接字超时等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:56:47.487

如果您可以将代码包装成`Callable`，我建议使用[番石榴的 TimeLimiter::callWithTimeout](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/util/concurrent/TimeLimiter.html)。它正是为此目的而设计的。

# jquery - jQuery切换复选框

> ID：13352649
> 
> 赞同：0
> 
> 时间：2012-11-12T22:30:44.550
> 
> 标签：jquery, checked

在过去的 2 个小时里，我一直在做这件事，但无法弄清楚这一点。

我有一个列表项，单击 jquery 时会拉出 li 项的类，它是一种颜色。然后它将第一个字母大写，然后找到具有颜色匹配的复选框值并将其标记为选中。

只有我想要它，这样如果有人再次单击 li 项目，它将取消选中该复选框

有人可以帮忙吗？

```
$('#colours li').live('click', function (){
    var color = $(this).attr('class');
    color = color[0].toUpperCase() + color.slice(1);
    console.log($('input[value="'+color+'"]'));
    $(this).css('opacity','0.5');

    if($('input[value="'+color+'"]:checked').length) {
        $('input[value="'+color+'"]').attr('checked', true);
        console.log("checked");
    } else {
        $('input[value="'+color+'"]').removeAttr('checked');
        console.log("not checked");
    }    
});

<ul id="colours">
        <li class="black"></li>
        <li class="brown"></li>
</ul>

<input type="checkbox" name="color" value="Black" class="hidden" />
<input type="checkbox" name="color" value="Brown" class="hidden" /> 
```

忘记添加 ul 并使用 jquery .load() 加载输入

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:35:02.700

从字面上看，当您删除该属性时，您就是将其从 DOM 中取出。您只想切换选中的属性。需要注意的一些变化。

`.live()`已弃用；我已经用正确的`.on()`电话代替了它。

`.attr()`*在几乎*所有情况下都被弃用，而赞成`.prop()`. 这个我也换了。

我们不需要检查长度，我们需要检查元素是否被检查。jQuery 提供了一个`.is()`带有`psuedo-selector`.`:checked`

```
$(document).on('click', '#colours li',  function() {
    var color = $(this).prop('class');
    color = color[0].toUpperCase() + color.slice(1);
    $(this).css('opacity', '0.5');

    $('input[value="' + color + '"]').prop('checked', function(i,oldVal){
        return !oldVal;
    });

});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:36:45.300

这应该做

```
$('#colours').on('click', 'li', function (){
  var th = $(this);
  var color = th.attr('class');
  color = color[0].toUpperCase() + color.slice(1);
  var input = $('input[value="'+color+'"]')
  console.log(input);
  th.css('opacity','0.5');

  if(input.length == 1) {
    if (input.is(':checked')) {
      input.prop('checked', false);  
      console.log("not checked");
    } else {
      input.prop('checked', true); 
      console.log("checked");
    }
  }

}); 
```

# c# - 如何通过果园中多对多的代理记录获取媒体选择器字段

> ID：13352657
> 
> 赞同：1
> 
> 时间：2012-11-12T22:31:16.110
> 
> 标签：c#, many-to-many, orchardcms, manytomanyfield

我需要在小部件视图中访问 mediapickerfield。该字段与“ActionPart”相关。

当我创建多对多关系以在小部件中显示我的“ActionPart”时，我遇到了问题。

当我映射多对多时，我采用了“ActionPart”，但无法访问 mediapicker 字段。

**记录类**

```
public class ActionPartRecord : ContentPartRecord
{
    public virtual string Text { get; set; }
    public virtual double Price { get; set; }
    public virtual int TextPosX { get; set; }
    public virtual int TextPosY { get; set; }
    public virtual String TextSale { get; set; }
    public virtual int Color { get; set; }
}

public class ActionListRecord
{
    public virtual int Id { get; set; }
    public virtual ActionPartRecord ActionPartRecord { get; set; }
    public virtual ActionWidgetPartRecord ActionWidgetPartRecord { get; set; }
}

public class ActionWidgetPartRecord : ContentPartRecord
{
    public ActionWidgetPartRecord()
    {
        ActionList = new List<ActionListRecord>();
    }
    public virtual IList<ActionListRecord> ActionList { get; set; }
}

public class ActionWidgetPart : ContentPart<ActionWidgetPartRecord>
{
    public IEnumerable<ActionPartRecord> ActionList
    {
        get
        {
            return Record.ActionList.Select(x => x.ActionPartRecord);
        }
    }
} 
```

**ActionPart 类**

```
public class ActionPart : ContentPart<ActionPartRecord>
{
    public String Text
    {
        get { return Record.Text; }
        set { Record.Text = value; }
    }
    /*other field*/
} 
```

**迁移**

```
public int Create()
{
    SchemaBuilder.CreateTable("ActionPartRecord", table => table
        .ContentPartRecord()
        .Column<string>("Text")
        .Column<double>("Price")
        .Column<int>("TextPosX")
        .Column<int>("TextPosY")
        .Column<string>("TextSale")
        .Column<int>("Color")
        );

    ContentDefinitionManager.AlterPartDefinition("ActionPart",
     builder => builder
         .WithField("BaseImage", fieldBuilder => fieldBuilder.OfType("MediaPickerField").WithDisplayName("Action Image"))
         .WithField("PatternImage", fieldBuilder => fieldBuilder.OfType("MediaPickerField").WithDisplayName("Pattern Image"))
         .WithField("TimeExp", fieldBuilder => fieldBuilder.OfType("DateTimeField").WithDisplayName("Expecting date"))
    .Attachable());

    ContentDefinitionManager.AlterTypeDefinition("Action", cfg => cfg
      .WithPart("CommonPart")
      .WithPart("TitlePart")
      .WithPart("RoutePart")
      .WithPart("BodyPart")
      .WithPart("ActionPart")
      .Creatable()
      .Indexed());

    SchemaBuilder.CreateTable("ActionListRecord",
       table => table
           .Column<int>("Id", column => column.PrimaryKey().Identity())
           .Column<int>("ActionPartRecord_Id")
           .Column<int>("ActionWidgetPartRecord_Id")
       );

    SchemaBuilder.CreateTable("ActionWidgetPartRecord", table => table
      .ContentPartRecord()
      );

    ContentDefinitionManager.AlterPartDefinition(
        "ActionWidgetPart",
        builder => builder.Attachable());

    ContentDefinitionManager.AlterTypeDefinition("ActionWidget", cfg => cfg
        .WithPart("ActionWidgetPart")
        .WithPart("WidgetPart")
        .WithPart("CommonPart")
        .WithSetting("Stereotype", "Widget"));
    return 1;
} 
```

**驱动显示方式**

```
protected override DriverResult Display(
    ActionWidgetPart part,
    string displayType,
    dynamic shapeHelper)
{
    return ContentShape("Parts_ActionWidget",
                    () => shapeHelper.Parts_ActionWidget(
                        ContentPart: part,
                        ActionList: part.ActionList));
} 
```

**小部件视图**

```
@foreach (var action in Model.ActionList)
{
    <div class="item">

        *How to access BaseImage Field in this row*

        <div class="sale-pattern"></div>
        <div class="container">
            <div class="carousel-caption">
                <h1>@action.Text</h1>
                <h1 class="price">@action.Price</h1>
            </div>
        </div>
    </div>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:32:38.463

我很喜欢下一部分代码的问题：

```
@foreach (var action in Model.ActionList)
{
var contentId = (int)action.Id;
var contentManager = WorkContext.Resolve<IContentManager>();
dynamic contentItem = contentManager.Get(contentId).As<ActionPart>();

    <div class="item">
    <img src="@(((string)contentItem.BaseImage.Url).Replace("~/",""))" alt="">
    <div class="sale-pattern"></div>
    <div class="container">
        <div class="carousel-caption">
            <h1>@action.Text</h1>
            <h1 class="price">@action.Price</h1>
        </div>
    </div>
</div>
} 
```

# jquery - Reveal Modal with cookie 只显示一次

> ID：13352658
> 
> 赞同：15
> 
> 时间：2012-11-12T22:31:22.053
> 
> 标签：jquery, modal-dialog

我正在使用（[Reveal Modal](http://www.zurb.com/playground/reveal-modal-plugin "显示模态")）并使用以下代码将其加载到页面上：

```
$(document).ready(function() {
    $('#myModal').reveal();
}); 
```

我该如何修改它，我相信使用 cookie（还有其他方法吗？），这样它只会在 1 周内为用户弹出一次？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-12T22:42:25.367

使用 carhartl 的[jquery-cookie](https://github.com/carhartl/jquery-cookie)插件。

在显示模式之前检查 cookie。如果存在，请不要显示它。如果不是，请存储一个新的 cookie 并显示模式。

```
$(document).ready(function() {
    if ($.cookie('modal_shown') == null) {
        $.cookie('modal_shown', 'yes', { expires: 7, path: '/' });
        $('#myModal').reveal();
    }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-04T14:38:03.810

受`mreq`我使用 Foundation 5 创建的自动加载代码的启发，该代码仅在 3 秒后出现：

```
$(document).ready(function() {
  if ($.cookie('modal_shown') == null) {
      $.cookie('modal_shown', 'yes', { expires: 7, path: '/' });
      setTimeout(function(){
         $("#myModal").foundation('reveal', 'open');
      }, 3000);
   }
}); 
```

是相同的代码，但有 3 秒的延迟。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-19T20:48:09.107

我有一个类似的场景，只显示一个依赖于星期几的 jquery 模式。我使用了[dateJS](http://www.datejs.com/2007/11/27/getting-started-with-datejs/)插件和 jquery cookie 插件。

这是我的代码：

```
$(document).ready(function () {
/* We first check if the cookie is equal to null (doesn't exist), if so, we set the cookie to the current site path */
    if($.cookie('modal') == null){
        // Set the cookie
        $.cookie('modal', 'yes', { path: '/' });

        /* Now that the cookie is set once, load the specials */
        // Load Monday's Specials
        if( Date.today().is().monday() ){
            $('#myModal-Monday').reveal();
        }
        // Load Tuesday's Specials
        else if ( Date.today().is().tuesday() ){
            $('#myModal-Tuesday').reveal();
        }
        else if( Date.today().is().wednesday() ){
            $('#myModal-Wednesday').reveal();
        }
        else if( Date.today().is().thursday() ){
            $('#myModal-Thursday').reveal();
        }
        else if( Date.today().is().friday() ){
            $('#myModal-Friday').reveal();
        }
        else if( Date.today().is().sunday() ){
            $('#myModal-Sunday').reveal();
        }
    }
    // The cookie will delete when the browser-closes. Thus only displaying once on the site until the browser is closed
}); 
```

因此，这种方式仅在用户浏览器会话期间显示一次，并且仅在用户关闭/重新打开浏览器时重新显示。

任何关于如何优化的反馈都会很棒！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-27T20:28:26.227

这就是我使用 jQuery 和纯 Js 的方式。这里解释得很好：http: [//www.w3schools.com/js/js_cookies.asp](http://www.w3schools.com/js/js_cookies.asp)

```
//  Set the Cookie
function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    var expires = "expires=" + d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
}

// Get the Cookie
function getCookie(cname) {
    var name = cname + "=";
    var ca   = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var  c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if ( c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

// Check if Cookie exists
function checkCookie() {

    // Get the cookie called "visited"
    var visited = getCookie("visited");

    // If it exists, print the Cookie to the Console
    if (visited == "true") {
        console.log(document.cookie);
    }
    else {
        // If not, add the class 'is-visible' to my modal called '.mhc-intro-modal'
        // and create a the cookie "visited=true" expiring in 15 days.
        $('.mhc-intro-modal').addClass('is-visible');
        $('body').addClass('hide-overflow');
        setCookie("visited", "true", 15);
    }
}

// When document is ready check for the cookie
$(document).ready(function() {
    checkCookie();
});

// Close the modal
$('.mhc-intro-modal').on('click', function(event) {
    if ( $(event.target).is('.mhc-intro-modal-close') || $(event.target).is('.mhc-intro-modal') ) {
        event.preventDefault();
        $(this).removeClass('is-visible');
        $('body').removeClass('hide-overflow');
    }
}); 
```

css

```
body {
    background-color: #fbfbfb;

    &.hide-overflow {
        overflow: hidden;
    }
}

.mhc-intro-modal {
    position: fixed;
    left: 0;
    top: 0;
    height: 100%;
    width: 100%;
    background-color: rgba(21, 21, 21, 0.55);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s 0s, visibility 0s 0.3s;

    &.is-visible {
        opacity: 1;
        visibility: visible;
        z-index: 11;
        transition: opacity 0.3s 0s, visibility 0s 0s;
    }
} 
```

html

```
<div class="mhc-modal mhc-intro-modal" role="alert">
    <div class="mhc-modal-inner">
        <div class="mhc-modal-info-container">
            <a href="#0" class="mhc-intro-modal-close">Close</a>
            <div class="mhc-copy-container" style="background-image: url('your-image-path.jpg');">
                <h3 class="mhc-title">The Title</h3>
                <p class="mhc-description">The description bla bla bla</p>
            </div>
        </div>
    </div>
</div> 
```

# c# - 确定 wpf 调整大小图像的正确偏移量的公式

> ID：13352659
> 
> 赞同：0
> 
> 时间：2012-11-12T22:31:25.313
> 
> 标签：c#, wpf, image

我在使用 WPF 调整图像大小时遇到​​了一些问题，因为图像在某些分辨率下变得模糊。我实际上是将这些写到文件中，所以`SnapToDevicePixels`无济于事（我什至不在 WPF 应用程序中，我只是在引用`System.Windows`）。

我知道这与 WPF 中像素的设备独立性有关，但我现在需要知道如何计算像素的偏移量以获得清晰的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:58:18.310

有没有必要使用WPF？我们使用的这个基于 GDI 的代码产生了出色的调整大小的能力：

```
 public static Size ResizeImage(
       string fileName, 
       string targetFileName, 
       Size boundingSize, 
       string targetMimeType, 
       long quality)
    {
        ImageCodecInfo imageCodecInfo = 
            ImageCodecInfo
               .GetImageEncoders()
               .Single(i => i.MimeType == targetMimeType);
        EncoderParameters encoderParams = new EncoderParameters(1);
        encoderParams.Param[0] = 
            new EncoderParameter(Encoder.Quality, quality);
        using (FileStream fs = File.OpenRead(fileName))
        {
            Image img ;
            try
            {
                img = Image.FromStream(fs, true, true);
            }
            catch (ArgumentException ex)
            {
                throw new FileFormatException("cannot decode image",ex);
            } 
            using (img)
            {
                double targetAspectRatio = 
                    ((double)boundingSize.Width) / boundingSize.Height;
                double srcAspectRatio = ((double)img.Width) / img.Height;
                int targetWidth = boundingSize.Width;
                int targetHeight = boundingSize.Height;
                if (srcAspectRatio > targetAspectRatio)
                {
                    double h = targetWidth / srcAspectRatio;
                    targetHeight = Convert.ToInt32(Math.Round(h));
                }
                else
                {
                    double w = targetHeight * srcAspectRatio;
                    targetWidth = Convert.ToInt32(Math.Round(w));
                }
                using (Image thumbNail = new Bitmap(targetWidth, targetHeight))
                using (Graphics g = Graphics.FromImage(thumbNail))
                {
                    g.CompositingQuality = CompositingQuality.HighQuality;
                    g.SmoothingMode = SmoothingMode.HighQuality;
                    g.InterpolationMode = InterpolationMode.HighQualityBicubic;
                    g.PixelOffsetMode = PixelOffsetMode.HighQuality;
                    Rectangle rect = 
                        new Rectangle(0, 0, targetWidth, targetHeight);
                    g.DrawImage(img, rect);
                    thumbNail.Save(
                        targetFileName, imageCodecInfo, encoderParams);
                }
                return new Size(targetWidth, targetHeight);
            }

        }
    } 
```

# ios - “保护伪流” mp4 视频（flash、html5、pc、iOS ......）的最佳方式是什么？

> ID：13352661
> 
> 赞同：2
> 
> 时间：2012-11-12T22:31:29.163
> 
> 标签：ios, html, streaming, mp4, jwplayer

我正在寻找一种方法让我的客户（登录）在我的网站上观看 mp4 视频。

*   我不希望他们能够下载视频，或者至少让它变得非常困难。
*   服务器是 linux / 应用程序是 PHP
*   我希望我的客户能够在计算机网络浏览器或 iOS/Safari 设备上观看视频（这意味着没有闪存）。
*   我需要它是免费的或非常便宜的（例如，不要在云基础提供商上以每月数千美元的价格托管视频）。

到目前为止，我正在执行以下操作：

*   flv 文件的 php 伪流（称为 xmoov）。使用 php，我能够在返回流的内容（会话变量、令牌……）之前执行安全验证，但它不适用于 iOS，因为 flv 视频需要播放 flash。它也不是很安全，因为像 Video Download Helper 这样的简单 Firefox 扩展程序可以下载它们。
*   所以我在 mp4 中编码了我的视频，这在 html5/iOS 上运行良好，但使得该过程的“安全”方面变得更加困难：制作 php 伪流似乎非常困难。我还没有找到任何可行的解决方案，似乎每个人都远离它，因为它需要太多的资源（在整个文件内容的流式传输期间，每个视频都有 1 个 php 进程）。

所以我找到的最好的解决方案是 2 个经典的 Apache 插件：“H264 Streaming Module”和“Mod Auth Token”。好的，这更好，但它似乎是一个死胡同，因为要有效，身份验证令牌的超时需要非常短（少于 5 秒，很难在 html 源代码中找到混淆的 url 并将其复制/粘贴到下载应用程序或启动脚本或...），但这意味着客户必须在此时间范围内启动视频（在 iOS 上无法自动启动视频）。这也意味着客户无法在视频的“尚未下载”部分中搜索，因为播放器（我使用 JWplayer）对 url 进行了新的 http 调用，这显然不再起作用，因为暂停。

我在考虑一个视频 Flash 播放器，它可以自己生成混淆的 url（而不是 php 在 html 源中输出它），但它不能在 iOS 上工作，因为它是基于 Flash 的。如果我在计算机上使用它并在 iOS 上使用 html5/auth_token（基于用户代理），则很容易欺骗用户代理并下载视频。

另一种解决方案似乎使用“真正的”视频流服务器，例如 Red5，但我发现的几乎所有教程都是关于直播、电视、网络摄像头，而不是放在硬盘上的简单 mp4 文件。它似乎也不是针对此类需求的应用程序。

所以我愿意接受每一个建议！

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T03:28:08.777

我发现自己处于同样的境地。

我正在使用 flowplayer，并且我使用类似于 xmoov 的服务器端 (PHP) 脚本将 FLV 转换为伪流，并带有您提到的所有验证。

**我有 1 个提示：** 我正在使用，**如果 $start 是 0**，令牌只能工作*3 秒*（所以不能发出新请求），但**如果 $start 是 > 0**，那么它工作 10 分钟，或更多。

这样，人们将能够搜索到视频的其他部分，但不能提出完整的请求。您还可以使此 $start 限制大于 X 字节，而不是 >0，以确保聪明人不会跳过您的验证。

现在，关于使用相同脚本的 MP4 伪流，我仍然有麻烦。由于 $start 值以秒的形式发送（即：?start=32.125），而不是字节位置，我似乎无法制作视频伪流。

如果您找到了解决方案（不超过 mod_h264_streaming），我会很高兴听到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:41:26.303

我使用 Amazon 的 S3 对 FLV 文件进行了整理：

[http://evolt.org/s3secure](http://evolt.org/s3secure)

我正在为 MP4 做这件事，但我的专长是网络的东西，而不是视频的东西。

# android - 更改 AutoCompleteTextView 焦点边框颜色

> ID：13352662
> 
> 赞同：0
> 
> 时间：2012-11-12T22:31:43.207
> 
> 标签：android, colors, textview, autocompletetextview

在我的项目中，我有几个 AutoCompleteTextView。当他们中的一些人集中注意力时，我想改变这个恼人的橙色边框，但不知道该怎么做。 ![在此处输入图像描述](../Images/9d160987198bf6b4c813704e32ec832f.png)

我已经为 textcolor 和 background 尝试了一些不同的选择器，但我没有效果。也许我做错了什么..

请帮我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:58:44.630

您需要使用“选择器”背景更改 EditText 的背景（视图的每个状态都可以绘制一个）。

有关详细信息，请参阅[http://www.androidworks.com/chang-the-android-edittext-ui-widget](http://www.androidworks.com/changing-the-android-edittext-ui-widget)

# java - 在运行时使用清单文件加载 jar

> ID：13352664
> 
> 赞同：0
> 
> 时间：2012-11-12T22:31:47.093
> 
> 标签：java, jar, classpath

我继承了一个旨在成为多代理开发平台的 Java 项目。这个想法是您可以创建在平台上运行的“应用程序”。我正在寻找一种分发基础平台的方法，以便最终用户可以将应用程序（可能打包在 jar 中）添加到预定义的文件夹中，将对所述 jar 存在的引用添加到平台读取的某个清单文件中，以及因此可以从中访问文件。

我查看了以下答案，但这些似乎要求平台代码在设计时知道类的名称：

*   [在 Java 小程序中读取 .jar 文件](https://stackoverflow.com/questions/4094863/read-jar-file-in-java-applet)

*   [有没有办法在运行时加载类 jar 和包？](https://stackoverflow.com/questions/2244050/is-there-a-way-to-load-classes-jars-and-packages-on-run-time)

理想情况下，我希望以下结构起作用：

*   主目录：platform.jar、apps.manifest、Apps（目录）
*   Apps/App1/app1.jar, Apps/App2/app2.jar, ..., Apps/AppN/appN.jar

apps.manifest 将包含每个应用程序的条目，其中将包括 jar 的路径，以及作为主要应用程序（实现公共接口）对象的类的名称。

在我的 platform.jar 中的主要代码中，我想阅读清单，注意有 N 个应用程序，并且能够调用`ApplicationOne appOne = new ApplicationOne(this)`where`ApplicationOne`是主要应用程序对象的名称 in `app1.jar`，并且是对保存`this`的对象的引用`platform.jar`对应用程序的引用。

如果所有 jars（`platform.jar`和应用程序 jars）都在用户的类路径中，它会像上面那样工作吗？如果是这样，有没有办法临时将一个目录（和所有子目录）添加到 Java 中的用户类路径中，我可以在运行时运行它`platform.jar`？我临时询问，因为封闭文件夹应该可以在文件系统上移动。

任何关于这个问题的建议，以及关于改进问题的任何建议都表示赞赏，因此它更清晰、更容易阅读。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:39:45.460

听起来[ServiceLoader](http://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html) API 可能有用。

> 服务是一组众所周知的接口和（通常是抽象的）类。服务提供者是服务的具体实现。提供者中的类通常实现服务本身中定义的类的接口和子类。服务提供者可以以扩展的形式安装在 Java 平台的实现中，即将 jar 文件放置在任何常用的扩展目录中。

请参阅[此博客条目](http://solitarygeek.com/java/a-simple-pluggable-java-application)以了解其用法

# excel - Excel Solver - 使用更改“ValueOf”输入进行优化

> ID：13352666
> 
> 赞同：2
> 
> 时间：2012-11-12T22:31:59.053
> 
> 标签：excel

我正在尝试设置一个宏，该宏可以在给定 2 个输入的情况下参数化方程。我想不出一种方法让 Solver 使用单元格的值作为“值”。我现在得到的宏如下：

```
Sub Macro2()

   SolverReset
   SolverAdd CellRef:="$G$2", Relation:=1, FormulaText:="100"
   SolverAdd CellRef:="$G$2", Relation:=3, FormulaText:="0"
   SolverOk SetCell:="$M$6", MaxMinVal:=3, ValueOf:="$B$2", ByChange:="$G$2", Engine:= _
       3, EngineDesc:="Evolutionary"
   SolverSolve

End Sub 
```

执行宏时，会弹出 Solver Results 框说`Error in model. Please verify that all cells and Constraints are valid.`

有什么办法可以完成我想要的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T05:10:30.477

纳特。

不要直接为“ValueOf”参数引用单元格，而是使用引用单元格的变量。例如：

```
Sub Macro2()

    Dim target As Double
    target = Range("B2")

    SolverReset
    SolverAdd CellRef:="$G$2", Relation:=1, FormulaText:="100"
    SolverAdd CellRef:="$G$2", Relation:=3, FormulaText:="0"
    SolverOk SetCell:="$M$6", MaxMinVal:=3, ValueOf:=target, ByChange:="$G$2", _
      Engine:= 3, EngineDesc:="Evolutionary"
    SolverSolve

End Sub 
```

希望能解决您的问题。

问候， 萨尔

# jquery - 更新我的 jQuery 破坏了我的显示/隐藏

> ID：13352667
> 
> 赞同：0
> 
> 时间：2012-11-12T22:32:01.943
> 
> 标签：jquery

我有一个更改电话号码的脚本，但这个脚本只能与 jquery 1.6.4 一起使用——一旦我更新到 1.7.2，它就会停止运行。我错过了什么？

```
<script type="text/javascript">// <![CDATA[

$('a#reno-trigger').click(function(){
$('#toggle-lv').show();
$('#toggle-reno').hide();
});

$('a#lv-trigger').click(function(){
$('#toggle-reno').show();
$('#toggle-lv').hide();
});

// ]]></script> 
```

HTML：

```
<div id="toggle-reno"><div class="toggle-switch" >
<span class="active">Las Vegas</span> | <a id="reno-trigger" href="#">Reno</a></div>
<div class="toggle-phone">702.555.5555</div>
</div>

<div id="toggle-lv" style="display: none"><div class="toggle-switch" >
<a id="lv-trigger" href="#">Las Vegas</a> | <span class="active">Reno</span></div>
<div class="toggle-phone">555.555.5555</div>
</div> 
```

我将删除这一行，脚本将不再工作：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script> 
```

我也取出了 CDATA。

我的 wordpress 正在加载 1.7.2 的本地版本。

```
<script type='text/javascript' src='http://xxx.com/wp-includes/js/jquery/jquery.js?ver=1.7.2'></script> 
```

我已经添加：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

它又可以工作了，但是我正在加载两个看起来很奇怪的 jQueries。

我想这毕竟不是jQuery的更新......

document.ready 现在实现了：

```
<script type="text/javascript">
$(document).ready(
$('a#reno-trigger').click(function(){
$('#toggle-lv').show();
$('#toggle-reno').hide();
});

$('a#lv-trigger').click(function(){
$('#toggle-reno').show();
$('#toggle-lv').hide();
});

);
</script> 
```

那个脚本没有工作期间，我一定搞砸了 document.ready 部分......我现在把它放回去了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:12:48.083

这行得通，我不知道为什么。但它有效:)

```
<script type="text/javascript">// <![CDATA[

jQuery(document).ready(function($){

    $('a#reno-trigger').click(function(){
$('#toggle-lv').show();
$('#toggle-reno').hide();
});

$('a#lv-trigger').click(function(){
$('#toggle-reno').show();
$('#toggle-lv').hide();
});

 });

// ]]></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:45:21.210

尝试这个：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<script type="text/javascript">
$(function(){

    $('a#reno-trigger').click(function(){
        $('#toggle-lv').show();
        $('#toggle-reno').hide();
    });

    $('a#lv-trigger').click(function(){
        $('#toggle-reno').show();
        $('#toggle-lv').hide();
    });

});
</script> 
```

# python - #ifdef DEBUG 的 Python 等效项

> ID：13352677
> 
> 赞同：55
> 
> 时间：2012-11-12T22:33:08.160
> 
> 标签：python, debugging

在 C 中，我们编写如下代码

```
#ifdef DEBUG
printf("Some debug log... This could probably be achieved by python logging.Logger");
/* Do some sanity check code */
assert someCondition
/* More complex sanitycheck */
while(list->next){
assert fooCheck(list)
}

#endif 
```

有没有办法在python中做到这一点？

编辑：我得到了答案，还有更多 :) Paolo、Steven Rumbalski 和 J Sebastian 给了我我正在寻找的信息。感谢 das 的详细回答，尽管我现在可能不会使用预处理器。

J Sebastian，他的评论被删除了，因为他发表评论的答案，我认为删除了他的答案。他说我可以使用 Logger 中的 isEnabledFor() 方法来提供条件。

感谢大家的投入。这是我的第一个问题。我希望我能接受 paolo 或 j sebastian 的回答。但由于这些是作为评论提供的，我会接受 das 的回答。

我可能会使用[http://nestedinfiniteloops.wordpress.com/2012/01/15/if-debug-python-flavored/](http://nestedinfiniteloops.wordpress.com/2012/01/15/if-debug-python-flavoured/)或 Logger.isEnabledFor()

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2014-12-13T04:05:52.203

`__debug__`在您的代码中使用：

```
if __debug__:
    print 'Debug ON'
else:
    print 'Debug OFF' 
```

使用上面的代码创建一个脚本`abc.py`，然后

1.  运行`python -O abc.py`
2.  运行`python abc.py`

观察差异。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2017-08-22T15:35:58.570

[Mohammad 的回答](https://stackoverflow.com/a/27455446/1752050)是正确的方法：使用`if __debug__`.

事实上，`if`如果表达式是静态常量（例如`True`、`False`、`None`、`__debug__`、`0`和`0.0`），Python 会完全删除该语句，从而`if __debug__`生成编译时指令而不是运行时检查：

```
>>> def test():
...     if __debug__:
...         return 'debug'
...     return 'not debug'
...
>>> import dis
>>> dis.dis(test)
  3           0 LOAD_CONST               1 ('debug')
              2 RETURN_VALUE 
```

该选项在[命令行选项](https://docs.python.org/3/using/cmdline.html#cmdoption-o)`-O`的 python 文档中有详细说明，并且对[assert 语句](https://docs.python.org/3.7/reference/simple_stmts.html#the-assert-statement)也有类似的优化。

所以不要使用外部预处理器——为此，你有一个内置的！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-11-12T22:45:38.820

您正在寻找的是 python 的**预处理器**。通常你有三种选择：

1.  编写一个**自制的脚本/程序**，在将结果传递给解释器之前根据某些模板替换部分源代码（可能很困难）
2.  使用特殊用途的 Python 预处理器，例如[pppp - Poor's Python Pre-Processor](https://github.com/pinard/Pymacs/blob/master/pppp)
3.  使用通用预处理器，如[GPP](http://en.nothingisreal.com/wiki/GPP)

我建议先尝试 pppp ;)

`DEBUG`与设置标志和运行代码相比，预处理器的主要优点`if (DEBUG == True)`是条件检查也会消耗 CPU 周期，因此最好删除不需要运行的代码（如果 python 解释器无论如何都不这样做），而不是跳过它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-12T22:40:02.077

如果您正在寻找 Python 中的断言，`assert`则它是一个实际有效的 Python 语句。 [http://docs.python.org/2/reference/simple_stmts.html#assert](http://docs.python.org/2/reference/simple_stmts.html#assert)

# android - 为什么使用 Android SurfaceView 会出现黑屏？

> ID：13352688
> 
> 赞同：0
> 
> 时间：2012-11-12T22:34:09.320
> 
> 标签：android, android-layout, surfaceview

我正在使用 SurfaceView 来保存 Camera 对象，并将视图包装在 FrameLayout 中。我还在持有相机视图的同一活动中添加了一个输入文本框。当我点击它时，软键盘打开并覆盖了设备屏幕的一半（Galaxy S2），在这种情况下我能够看到一个非黑屏。我想知道为什么打开软键盘时，相机开始工作，而当我关闭软键盘时，它又变黑了

```
public class CameraActivity extends Activity {

private Camera myCamera;
private MyCameraSurfaceView myCameraSurfaceView;
private MediaRecorder mediaRecorder;
private EditText editTextServerIP;

Button myButton;
Button btnUpload;
SurfaceHolder surfaceHolder;
boolean recording;
Button btnConnectVideo;
EditText savePath;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //policy to prevent exception when stop record
    //android.os.NetworkOnMainThreadException
    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
    /////////////////////////////////////////////////////////////////////////////////////////////

    recording = false;

    setContentView(R.layout.activity_camera);

    // Get Camera for preview
    myCamera = getCameraInstance();
    if (myCamera == null) {
        Toast.makeText(CameraActivity.this, "Fail to get Camera",
                Toast.LENGTH_LONG).show();
    }

    myCameraSurfaceView = new MyCameraSurfaceView(this, myCamera);
    FrameLayout myCameraPreview = (FrameLayout) findViewById(R.id.videoview);
    myCameraPreview.addView(myCameraSurfaceView);

    myButton = (Button) findViewById(R.id.btnRecord);
    myButton.setOnClickListener(myButtonOnClickListener);

    btnUpload = (Button) findViewById(R.id.btnUpload);
    btnUpload.setOnClickListener(btnUploadOnClickListener);

    editTextServerIP = (EditText) findViewById(R.id.editTextServerIP);

    btnConnectVideo = (Button) findViewById(R.id.btnConnectVideo);
    btnConnectVideo.setOnClickListener(askServerToConvertAndConnectAllVideos);

    savePath = (EditText) findViewById(R.id.editTextPath); 
} 
```

公共类 MyCameraSurfaceView 扩展 SurfaceView 实现 SurfaceHolder.Callback {

```
 private SurfaceHolder mHolder;
    private Camera mCamera;

    public MyCameraSurfaceView(Context context, Camera camera) {
        super(context);
        mCamera = camera;

        // Install a SurfaceHolder.Callback so we get notified when the
        // underlying surface is created and destroyed.
        mHolder = getHolder();
        mHolder.addCallback(this);
        // deprecated setting, but required on Android versions prior to 3.0
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    public void surfaceChanged(SurfaceHolder holder, int format,
            int weight, int height) {
        // If your preview can change or rotate, take care of those events
        // here.
        // Make sure to stop the preview before resizing or reformatting it.

        if (mHolder.getSurface() == null) {
            // preview surface does not exist
            return;
        }

        // stop preview before making changes
        try {
            mCamera.stopPreview();
        } catch (Exception e) {
            // ignore: tried to stop a non-existent preview
        }

        // make any resize, rotate or reformatting changes here

        // start preview with new settings
        try {
            mCamera.setPreviewDisplay(mHolder);
            mCamera.startPreview();

        } catch (Exception e) {
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:03:33.743

问题出现在 Android 4.0.4 内核（自定义 ROM）中，问题和修复可以在下面找到：
[XDA - android ROM 4.0.4 camera fix](http://forum.xda-developers.com/showthread.php?t=1772931)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:41:14.227

你在 SurfaceHolder.Callback 中做什么？当软键盘打开时，它应该调整 SurfaceView 的大小，这会触发 surfaceChanged 回调。如果您查看[此处](http://developer.android.com/guide/topics/media/camera.html#custom-camera)的示例代码，您需要在 Surface 配置更改时停止预览并使用新的 SurfaceHolder 重新启动它，因为它可能与您开始使用的尺寸不同。

# php - 在 Magento 类别页面上检测多个相同类型的过滤器

> ID：13352689
> 
> 赞同：2
> 
> 时间：2012-11-12T22:34:10.217
> 
> 标签：php, magento, filter, categories

我希望根据正在应用的过滤器从 Magento 站点添加或删除内容。具体来说，检测何时应用了相同类型的过滤器。

例如，如果体育用品商店的商品可以按联赛排序，我希望检测 NBA 和 NFL 是否是选定的过滤器。我可以成功地检测到一个联赛是否因为使用这样的东西而被过滤：

```
$_filters = Mage::getSingleton('catalog/layer')->getState()->getFilters();

if (is_array($_filters)) {
   foreach ($_filters as $_filter) {
      $filterName = $_filter->getName();
      $filterLabel = $_filter->getLabel();
   }
} 
```

我无法遍历并检测来自同一类别（在本例中为 League）的多个过滤器，因为它似乎只为每种类型添加一个过滤器。是否有另一种检测应用过滤器的方法可以帮助解决这种情况？

感谢您的帮助，非常感谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-13T11:44:27.990

插件法力过滤器将允许你做你想做的事，

您可以使用法力过滤器模块，它允许您拥有多个相同类型的过滤器，然后您可以循环等..！

[http://www.manadev.com/advanced-layered-navigation-ce](http://www.manadev.com/advanced-layered-navigation-ce)

谢谢

# mongodb - mongodb findAndModify每个文档

> ID：13352690
> 
> 赞同：3
> 
> 时间：2012-11-12T22:34:21.340
> 
> 标签：mongodb

我有一个包含许多文档的集合，每个文档都包含一个数组，我想从这个数组中删除每个文档的最小值。

实现这一目标的最有效方法是什么？findAndModify 是否能够执行此类操作？

我需要使用 forEach 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T20:26:15.497

JohnnyHK 的评论是正确的。这样做的唯一方法是对`find()`所有文档进行单独更新，然后重新保存它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T23:27:47.553

这不是 FindAndModify 命令的目的，就像[文档](http://docs.mongodb.org/manual/reference/command/findAndModify/)中所述：

> findAndModify 命令以原子方式修改并返回单个文档。

您可能应该使用将标志设置为 true的常规`update`方法。`multi`查看[更新文档](http://www.mongodb.org/display/DOCS/Updating)。

# c# - 如何使用 GSON 将 JSON 值映射到不同的类

> ID：13352695
> 
> 赞同：2
> 
> 时间：2012-11-12T22:34:44.777
> 
> 标签：c#, java, json, gson

好的，我发现我原来的问题是一个微不足道的命名问题，所以我将把这个问题重新用于实际问题。

我在 C# 中有一堂课：

```
class Test
{
    public string Foo { get; set; }
} 
```

当我使用 System.Web.Script.Serialization.JavaScriptSerializer 序列化类时，我得到：

```
{"Foo":"Bar"} 
```

在java中我有一个类：

```
class Test
{
    private String foo;
    public String getFoo() {
        return foo;
    }

    public void setFoo(String foo) {
        this.foo = foo;
    } 
```

我正在尝试使用 GSON 来解析 JSON：

```
Gson gson = new Gson();
Test test = gson.fromJson(getJson(), Test.class); 
```

但我得到空值。

如何将 JSON 值映射到稍微不同的类，以便我仍然可以在每种语言中使用最佳实践命名约定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:38:40.983

我一直在使用@SerializedName 注释，例如：

```
@SerializedName("Foo")
private String foo; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:51:34.480

Gson 默认使用字段名称，因此您的字段需要命名为`UpTime`,`ComputerName`等。不过，从 Java 命名的角度来看，这将是亵渎神明的。

保持你的字段以 Java 风格正确命名为小写驼峰式，并告诉 Gson[`FieldNamingPolicy.UPPER_CAMEL_CASE`](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/FieldNamingPolicy.html#UPPER_CAMEL_CASE)改用：

```
Gson gson = new GsonBuilder()
    .setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE)
    .create();
Statistics stats = gson.fromJson(response.getJson(), Statistics.class); 
```

或者，您当然可以调整 C# 端以输出小驼峰大小写`{"upTime" : ... }`。

# netty - 为 Netty 4.0 提升 UDP 服务器？

> ID：13352697
> 
> 赞同：6
> 
> 时间：2012-11-12T22:34:53.497
> 
> 标签：netty

有人可以用 Netty 4.0 的 UDP 服务器引导我吗？我看到很多 3.x 示例，但即使在 netty 源示例中也没有 4.x 的迹象。（注意我对 Netty 很陌生）

基本上，它是[https://netty.io/Documentation/New+and+Noteworthy#HNewbootstrapAPI](https://netty.io/Documentation/New+and+Noteworthy#HNewbootstrapAPI)上的示例，但用于 UDP。非常感谢帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-05-13T10:14:07.260

包包括`netty-example`类[`QuoteOfTheMomentServer`](https://github.com/netty/netty/blob/4.1/example/src/main/java/io/netty/example/qotm/QuoteOfTheMomentServer.java)、[`QuoteOfTheMomentServerHandler`](https://github.com/netty/netty/blob/4.1/example/src/main/java/io/netty/example/qotm/QuoteOfTheMomentServerHandler.java)和[`QuoteOfTheMomentClient`](https://github.com/netty/netty/blob/4.1/example/src/main/java/io/netty/example/qotm/QuoteOfTheMomentClient.java)。[`QuoteOfTheMomentClientHandler`](https://github.com/netty/netty/blob/4.1/example/src/main/java/io/netty/example/qotm/QuoteOfTheMomentClientHandler.java)这些演示了如何创建一个简单的 UDP 服务器。

我正在粘贴*Netty 4.1.24*中存在的代码。我建议为您正在使用的 Netty 版本找到这些类。

QuoteOfTheMomentServer：

```
public final class QuoteOfTheMomentServer {

private static final int PORT = Integer.parseInt(System.getProperty("port", "7686"));

public static void main(String[] args) throws Exception {
    EventLoopGroup group = new NioEventLoopGroup();
    try {
        Bootstrap b = new Bootstrap();
        b.group(group)
         .channel(NioDatagramChannel.class)
         .option(ChannelOption.SO_BROADCAST, true)
         .handler(new QuoteOfTheMomentServerHandler());

        b.bind(PORT).sync().channel().closeFuture().await();
    } finally {
        group.shutdownGracefully();
    }
}
} 
```

QuoteOfTheMomentServerHandler:

```
public class QuoteOfTheMomentServerHandler extends SimpleChannelInboundHandler<DatagramPacket> {

private static final Random random = new Random();

// Quotes from Mohandas K. Gandhi:
private static final String[] quotes = {
    "Where there is love there is life.",
    "First they ignore you, then they laugh at you, then they fight you, then you win.",
    "Be the change you want to see in the world.",
    "The weak can never forgive. Forgiveness is the attribute of the strong.",
};

private static String nextQuote() {
    int quoteId;
    synchronized (random) {
        quoteId = random.nextInt(quotes.length);
    }
    return quotes[quoteId];
}

@Override
public void channelRead0(ChannelHandlerContext ctx, DatagramPacket packet) throws Exception {
    System.err.println(packet);
    if ("QOTM?".equals(packet.content().toString(CharsetUtil.UTF_8))) {
        ctx.write(new DatagramPacket(
                Unpooled.copiedBuffer("QOTM: " + nextQuote(), CharsetUtil.UTF_8), packet.sender()));
    }
}

@Override
public void channelReadComplete(ChannelHandlerContext ctx) {
    ctx.flush();
}

@Override
public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {
    cause.printStackTrace();
    // We don't close the channel because we can keep serving requests.
}
} 
```

# d3.js - 绑定到以缩放行为结束的缩放

> ID：13352699
> 
> 赞同：5
> 
> 时间：2012-11-12T22:35:10.947
> 
> 标签：d3.js, zooming

如果有一种方法可以方便地在缩放行为转换结束时绑定到事件 - 当用户 mouseup 或 touchend 移动图表的东西时。这是否可以通过仅绑定所有 up 事件来实现，或者这是人们以其他方式完成的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-03-14T13:12:29.240

在 d3 v4 中，zoom.on 类型名称已更改。它们现在是“开始”、“缩放”和“结束”。

```
 var d3zoom = d3.zoom()
    .on("start", zoomStartFunction)
    .on("zoom", zoomFunction)
    .on("end", zoomEndFunction);

  svg.call(d3zoom); 
```

查看非常有用的[文档](https://github.com/d3/d3-zoom/blob/master/README.md#zoom_on)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-05T09:49:02.923

我正在寻找同样的东西，我找到[了这篇文章](https://truongtx.me/2014/03/13/working-with-zoom-behavior-in-d3js-and-some-notes)。

你可以这样写：

```
var svg = outer.append("svg:g")
            .call(d3.behavior.zoom()
                    .on("zoom", rescale)
                    .on("zoomstart", zoomStart)
                    .on("zoomend", zoomEnd))
            .on("dblclick.zoom", null)
            .append("svg:g");

function zoomStart(){
    console.log("ZOOM START");
}

function zoomEnd(){
    console.log("ZOOM END");
} 
```

希望能帮助到你。

# c - 半立方体旋转失败

> ID：13352701
> 
> 赞同：0
> 
> 时间：2012-11-12T22:35:18.613
> 
> 标签：c, opengl, glut

我在这里使用半立方体这个词，它不是真正的立方体，它只有 3 个面。我执行以下操作：

**1.**用蓝色画一个立方体的三个面，第一个面是蓝色的，另外两个是红色的； **2.**将半立方体旋转 45 度，使我应该看到一半的红脸。

但是然后我只显示立方体，只有蓝色的脸在那里，我应该看到一半蓝色和一半红色。
也许我无法启用深度（我使用 glEnable()），我的印象是深度尺寸在我的绘图中被忽略了。

```
#import <OpenGL/OpenGL.h>
#import <GLUT/GLUT.h>

int width=500, height=500, depth=500;

void init()
{
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glEnable(GL_DEPTH_TEST);
    glViewport(0, 0, width, height);
    glOrtho(0, width, height, 0, 0, 1);
}

void display()
{
    glClearColor(0.9, 0.9, 0.9, 0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glColor4f(0, 0, 1, 0);
    glBegin(GL_QUADS);

    // First face
    glVertex3i(100, 100,0);
    glVertex3i(300, 100,0);
    glVertex3i(300, 300,0);
    glVertex3i(100, 300,0);

    glColor4f(1, 0, 0, 0);
    // Second face
    glVertex3i(300,100,0);
    glVertex3i(300,300,0);
    glVertex3i(300,100,300);
    glVertex3i(300,100,300);

    // Third face
    glVertex3i(100, 100,300);
    glVertex3i(300, 100,300);
    glVertex3i(300, 300,300);
    glVertex3i(100, 300,300);

    glEnd();
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glRotatef(45, 1, 0, 0);

    glFlush();
}

int main(int argc, char * argv[])
{
    glutInit(&argc, argv);
    glutInitWindowPosition(100, 100);
    glutInitWindowSize(width, height);
    glutCreateWindow("Test");
    glutDisplayFunc(display);
    init();
    glutMainLoop();
    return 0;
} 
```

这是我得到的图像：

![Image](../Images/a3f6848e6bf54910ff26e3c8e15c5759.png)

*编辑*：我有点解决改变视口：

```
glOrtho(0, width, height, 0, -depth, depth); 
```

但是我仍然缺少基础知识，现在我会继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:38:40.833

Rotation only effects objects that are drawn after the rotation. When you call `glBegin`, whatever you draw is immediately drawn using the current modelview matrix on the stack.

Modifying the matrix after drawing has no effect. You should move the rotation before the draw call.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:44:15.347

Rotation updates the current matrix, which will affect all object drawn after the rotation.

In order to see the rotation just move it above your draw lines.

# view - 模型视图演示者 - 被动视图 - 谁加载模型？

> ID：13352704
> 
> 赞同：3
> 
> 时间：2012-11-12T22:35:24.677
> 
> 标签：view, model, loading, mvp, presenter

我很好奇使用 MVP 模式来提高可测试性。我有使用 MVC 的经验，但 MVP 似乎不同。

我有一个在“项目”文件上运行的应用程序，该文件实际上是几个文件和文件夹的压缩存档。这个项目应该是我的模型。

我将把加载模型的代码放在哪里？我也在考虑另一个抽象层：某种 BackEndConnection。它将能够读取项目文件。它可以是 FileBackEndConnection 或 FTPConnection 或其他任何东西（这应该是可能的）。

这属于 Presenter 吗？

```
View ---- Presenter ---- Project (Model)
              |
              |
       BackEndConnection 
```

初始化是这样的：

```
Presenter presenter = new Presenter(BackEndConnection e); 
```

将触发演示者呼叫

```
Project project = backEndConnection.getProject(); 
```

它将能够初始化模型。

```
this.model=project; 
```

接着

```
View v = new View(presenter); 
```

不知何故，这听起来是错误的。我更喜欢模型中的 BackEndConnection：

```
Project --- BackEndconnection 
```

在这种情况下，Presenter 将简单地将模型与 BackEnd 结合起来，然后模型完成它的业务。

当然这意味着模型必须提供 model.persist() 和 model.loadFrom(BackEndConnection) 等等。这个对吗？我找不到太多关于处理 MVP 模型加载的资源。

# javascript - 如何在 html 和 javascript 中声明全局变量

> ID：13352705
> 
> 赞同：0
> 
> 时间：2012-11-12T22:35:42.420
> 
> 标签：javascript, python, ajax, django

如何在 html 和 javascript 中为 django 模板页面声明全局变量。我想让 display_language 成为全局变量。

```
<script>
  function onChange(){
    if (xmlHttp.readyState==4 && xmlHttp.status==200) {
        //request is successful. So retrieve the values in the response
        display_language = xmlHttp.responseText.split(';');
        alert("response: " + display_language);
   }
}
 </script> 
```

* * *

```
<html>
  <body>
     {% ifequal item.lang display_language %}
           {{item.text.strip}}
     {% endifequal %}
   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:38:46.870

JavaScript 中的变量是隐式全局的，因此除非它们在函数中并且以 var 关键字为前缀，否则它们将是全局可访问的

这是全球

```
<script type='text/javascript'>
    foobar = 'hello';
</script> 
```

这也是全球性的

```
<script type='text/javascript'>
   function test() {
       foobar = 'hi';
   }
</script> 
```

这是本地的

```
function test() {
    var foobar = 'world'; 
} 
```

# entity-framework - 是否可以在不往返实体框架中的数据库的情况下更新导航属性？

> ID：13352708
> 
> 赞同：1
> 
> 时间：2012-11-12T22:35:54.423
> 
> 标签：entity-framework

我有一个包含角色导航属性的用户对象。

```
 public partial class User
  {
    public int UserId { get; set; }
    public string UserName { get; set; }
    public string UserEmail { get; set; }
    public string GivenName { get; set; }
    public byte[] RowVersion { get; set; }
    public Nullable<int> ServiceAreaId { get; set; }

    public virtual ICollection<Role> Roles { get; set; }
  } 
```

我可以更新简单的属性，而无需从数据库中读取实体，如[http://www.shawnmclean.com/blog/2011/04/entity-framework-deleteupdate-without-round-trip-to-the-database/中所述](http://www.shawnmclean.com/blog/2011/04/entity-framework-deleteupdate-without-round-trip-to-the-database/)

```
 public User UpdateUser(User user, IEnumerable<Expression<Func<User, object>>> properties)
    {

            context.Configuration.ValidateOnSaveEnabled = false;
            context.Users.Attach(user);
            foreach (var selector in properties)
            {
                string propertyName = Utils.GetMemberInfoFromExpression(selector.Body);
                context.Entry(user).Property(propertyName).IsModified = true;   
            }
            context.SaveChanges();

        return user;
    } 
```

但是，我不确定如何或是否可以为角色导航属性执行此操作。当我尝试得到“实体类型 Collection`1 不是当前上下文模型的一部分”时。例外。谢谢。

# python - bash 在向量元素上执行函数

> ID：13352710
> 
> 赞同：0
> 
> 时间：2012-11-12T22:36:03.527
> 
> 标签：python, bash, vector

我有一个 bash 脚本，它生成一个在集群上运行的作业的向量。例子：

```
Vector = [1.cluster 2.cluster 3.cluster] 
```

我需要更新此脚本以记录此作业。通常我会这样做：

```
qstat jobnumber.cluster 
```

我的背景是 python，在 python 中我可以做类似的事情：

```
map(qstat, Vector) 
```

这将返回一个向量，其中包含所有向量条目的函数返回值。所以问题是：我可以将函数应用于 bash 中的向量并取回向量吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:46:12.937

这是 Pythonic 代码的 bash 等价物`result = [qstat(cluster) for cluster in Vector]`。

如果您使用的是 bash 数组：

```
result=() # or declare -a result
for cluster in ${Vector[@]}; do
  result=("${result[@]}" "$(qstat $cluster)") # or result+=($(qstat $cluster))
done 
```

两种追加到数组的方式的区别在于，第一种显式扩展数组以添加新元素，而第二种使用新元素创建一个新数组以将其添加到末尾。那是因为 bash 没有与 Python 的方法等效的`extend`方法。

如果您使用的是 IFS 分隔的字符串：

```
result=""
for cluster in $Vector; do
  result="${result} $(qstat cluster)"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:46:23.253

不，Bash 没有将`map`函数应用于数组中的每个元素的函数，从而返回一个数组。`for`您可以使用循环手动执行此操作：

```
declare -a results
for job in "${jobs[@]}"
do
    results+=($(qstat $job))
done 
```

# windows - ETW 提供者的频道名称

> ID：13352717
> 
> 赞同：2
> 
> 时间：2012-11-12T22:36:37.413
> 
> 标签：windows, winapi, event-log, etw

我正在尝试让我的 Windows 事件跟踪 (ETW) 提供程序清单来注册正确的通道名称。当我使用清单（包括在下面）时，我得到以下结果。但是，当我检查我的清单与注册表中 All-User-Install-Agent 清单（存储在 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT 中）的结果之间的差异时，我没有看到为什么我的键以 Foo-Bat-TestApp/ 前缀显示。如何摆脱前缀？我无法从名称属性中删除它们，因为已经有一个使用“操作”名称的操作系统组件（它是注册表中的一个平面列表）。

![事件查看器快照](../Images/eb1bd8a2f802ef09abbbf61090ff2854.png)

我的示例清单如下所示：

```
<?xml version="1.0" encoding="utf-16"?>
<instrumentationManifest
    xmlns="http://schemas.microsoft.com/win/2004/08/events"
    xmlns:win="http://manifests.microsoft.com/win/2004/08/windows/events"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <instrumentation>
    <events>
      <provider name="Foo-Bar-TestApp"
                guid="{C5C633DC-FB7E-4EA0-80EC-C683FA52561C}"
                symbol="EtwProvider"
                resourceFileName="C:\Projects\ETWTest\bin\Debug\ETWTest..dll"
                messageFileName="C:\Projects\ETWTest\bin\Debug\ETWTest.dll">
        <channels>
          <channel name="Foo-Bar-TestApp/Admin"
                   chid="Admin"
                   type="Admin"
                   enabled="true" />
          <channel name="Foo-Bar-TestApp/Operational"
                   chid="Operational"
                   type="Operational"
                   enabled="true" />
          <channel name="Foo-Bar-TestApp/Debug"
                   chid="Debug"
                   type="Debug"
                   enabled="false" />
        </channels>
        <keywords>
          <keyword name="KeywordA" symbol="READ_KEYWORD" mask="0x1" />
          <keyword name="KeywordB" symbol="WRITE_KEYWORD" mask="0x2" />
        </keywords>
       <events>
          <event version="1"
                 value="1"
                 symbol="SampleEvent"
                 channel="Operational"
                 level="win:Informational"
                 message="$(string.Event.SampleEvent)"
                 keywords="KeywordA" />
        </events>
      </provider>
    </events>
  </instrumentation>
  <localization>
    <resources culture="en-US">
      <stringTable>
        <string id="Event.SampleEvent" value="This is a sample event"/>
      </stringTable>
    </resources>
  </localization>
</instrumentationManifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:17:25.843

为了实现所需的功能，您必须在通道定义上使用符号属性。请参见下面的示例：
`<channel name="**Admin**" symbol="**Foo-Bar-TestApp-Admin**" chid="Admin" type="Admin" enabled="true" />`

# mvvm - View-model 与 Model 和 View 的关系

> ID：13352724
> 
> 赞同：1
> 
> 时间：2012-11-12T22:36:51.250
> 
> 标签：mvvm

我正在阅读有关 MVVM 的信息，似乎视图模型和模型类之间存在一对多的关系。

1.  可以说一个模型视图必须用于项目中的不同模型类吗？

2.  View 到 View-Model 的关系如何？使用一个 View-Model 来处理多个 View 是否有意义？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:09:12.213

“Model -View -ViewModel”中的模型是您的数据结构，您可以在其中创建将在视图和 viewModel 中使用的对象。模型可以在任何地方使用。您将在许多不同的视图模型上使用许多模型。

View 使用一个 ViewModel。视图负责外观。视图通过 DataContext 属性引用其一个视图模型。它可以在 XAML 或视图后面代码的构造函数中设置。

ViewModel 封装了表示逻辑并且没有直接引用视图。

# azure - 我可以在 Azure 服务总线中为仅限于命名空间部分的帐户列出队列吗？

> ID：13352728
> 
> 赞同：1
> 
> 时间：2012-11-12T22:37:15.253
> 
> 标签：azure, azureservicebus

我在我们的主要 Azure 服务总线帐户上有几个帐户（服务标识），它们仅限于命名空间的一部分，因此它们不会相互干扰。例如，帐户 foo1 对 /foo1 具有 Send、Listen、Manage 权限，而 foo2 对 /foo2 具有 Send、Listen、Manage 权限。这样 foo1 就无法读取/写入/删除 foo2 定义的任何队列。

foo1 有没有办法获取它可以访问的所有队列的列表？调用列表队列 API 似乎使所有队列都以 / 为根，而 foo1 无权访问，因此调用失败并出现错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:58:34.877

因为**服务总线**和**ACS**是独立的组件 - 您必须自己进行 ACS 查找以确定 ACS 帐户可以访问哪些 SB 命名空间。查看用于查询[规则组的](http://msdn.microsoft.com/en-us/library/windowsazure/hh180763)[ACS API](http://msdn.microsoft.com/en-us/library/windowsazure/hh278947)和用于[快速集成](http://msdn.microsoft.com/en-us/library/hh868045.aspx#sec23)[的 SBAzTool](http://code.msdn.microsoft.com/windowsazure/Authorization-SBAzTool-6fd76d93/view/SourceCode)。[`Microsoft.ServiceBus.AccessControlExtensions`](http://code.msdn.microsoft.com/windowsazure/Authorization-SBAzTool-6fd76d93/view/SourceCode)

# java - Java中的数组列表

> ID：13352733
> 
> 赞同：3
> 
> 时间：2012-11-12T22:37:41.473
> 
> 标签：java, arrays, for-loop, arraylist

我需要创建我的温度类的 3 个实例。我可以通过键入三遍来做到这一点，但我确信这不是一个好方法。因此，我在网上搜索并找到了 ArrayList。

我不明白如何使用 ArrayList 所以它可以在循环中创建类的实例，我想在我的循环之外访问它。

例如现在我有

```
Temperature t1 = new Temperature ();
t1.setDegrees(input.nextDouble()); 
```

我如何循环上面的整个内容，所以我不必输入三遍。我在网上搜索了示例，但我只能找到已经存储在 ArrayList 中的值，而不是创建新实例并将其存储在 ArrayList 中。所以基本上这就是我想要做的

```
Temperature t1 = new Temperature ()
for ( 3 loops ) 
{

t1.setDegrees(user input) ;
ArrayList ( << this is the part i need help on. How do i store the temperature here so i can access it outside the scope of the for loop) 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:41:04.297

```
List<Temperature> temperatures = new ArrayList<Temperature>();
for (int i = 0; i < 3; ++i) {
    Temperature t = new Temperature();
    t.setDegrees(user input) ;
    temperatures.add(t);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:39:58.383

您正在寻找[`ArrayList.add()`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#add%28E%29)方法和[for 循环](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/for.html)：

```
List<Temprature> list = new ArrayList<Temprature>();
for (int i = 0; i < 3; i++) { 
   Temprature t = new Temprature();
   t.setDegrees(input.nextDouble());
   list.add(t);
} 
```

稍后要获取可以使用的元素[`ArrayList.get()`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#get%28int%29)，如果需要迭代所有对象，可以使用[for-each 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:40:12.810

```
 List<Temparature> templist = new ArrayList<>();
    for(int i=0; i<3; i++){
     Temparature t = new Temparature();
     t.setDegrees(input.nextDouble());
    tempList.add(t);
    } 
```

上面的代码将在一个循环中创建 3 个**Temparature**对象，并在每次迭代中添加它们。

检查[ArrayList API](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T22:40:46.847

```
List<Temperature> temperatures = new ArrayList<Temperature>();
for (int i = 0; i < 3; ++i) {
    Temperature t = new Temperature();
    t.setDegrees(userInput);
    temperatures.add(t);
}
// here you go 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T22:41:36.180

```
List<Temperature> temps= new ArrayList<Temperature>();

for (int i=0;i<3;i++){
    Temperature t = new Temperature ()
    t.setDegrees(user input) ;
    temps.add(t)
}
System.out.println(temps); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T22:52:53.733

拥有一个 ArrayList 甚至一个温度数组不会比仅仅声明 3 个温度在内存/速度方面更好。

而且，根据您要执行的操作，您最好单独声明它们，以便您可以按名称引用它们。

```
Temperature fahrenheit = new Temperature();
Temperature celsius = new Temperature(); 
```

通过这种方式，您可以按名称访问它们，而如果它们在数组中，则必须记住哪个在数组中的哪个位置。

也就是说，这只有在您事先知道需要多少温度时才有效。如果你不知道你需要多少，那就是你需要使用数组或列表的时候。

# installation - 安装程序将文件复制到现有目录

> ID：13352734
> 
> 赞同：0
> 
> 时间：2012-11-12T22:37:45.687
> 
> 标签：installation, wix, windows-installer

我需要创建一个安装程序文件，它将一组 XML 文件复制到现有应用程序的目录中，该应用程序已经假定安装在计算机上。安装程序为流行的 CASE 工具包装了一个插件（由一组 XML 文件组成）。

如果可以使用 WiX 与 MSI 包的组合作为输出来完成此操作，我更愿意这样做，以便可以轻松地将其部署到企业环境中。

安装程序必须执行以下操作：

1.  询问用户安装现有应用程序的目标目录（默认为`C:\Program Files\AppName`）。
2.  将两个 XML 文件复制到`C:\Program Files\AppName\SubDir`中，如果 SubDir 尚不存在，则创建它
3.  完成安装。

这可能吗？

谢谢。

安德斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:53:45.507

看看这些帖子，它会对你有所帮助。

[在注册表项中搜索](https://stackoverflow.com/questions/1439442/how-to-determine-if-a-registry-key-exists-in-wix)已安装的应用程序

[自定义目录搜索](https://stackoverflow.com/questions/7354619/wix-how-to-do-a-directorysearch-in-a-custom-installation-location)

[基本安装程序](https://stackoverflow.com/questions/200743/wix-script-with-only-welcome-and-completed-screens/259685#259685)

祝你好运

# mongodb - 猫鼬文档更新错误

> ID：13352735
> 
> 赞同：2
> 
> 时间：2012-11-12T22:37:52.287
> 
> 标签：mongodb, coffeescript, mongoose

最近一直在使用它`node`，`mongoose`我很喜欢它，直到我不得不更新模型。

这是我正在做的事情：

```
module.exports.update = (post, cb) ->
  Post.update _id: post._id, post, (err, data) ->
    cb(err, data) 
```

所以我认为保存新帖子会很容易，但它抱怨错误：

> 错误：'不允许修改 _id'

在将它传递给我的更新方法之前，我尝试删除`post._id`它，但它不起作用，我找不到任何关于如何执行它的好例子，除了一个看起来有点奇怪的例子，你首先找到`Post`的是`_id`，然后手动更新每个键并再次保存帖子...

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T23:17:04.670

在`post._id`将其传递给`update`. 假设`post`是一个普通的 JS 对象，这应该可以工作：

```
module.exports.update = (post, cb) ->
  id = post._id
  delete post._id
  Post.update _id: id, post, (err, data) ->
    cb(err, data) 
```

# kendo-ui - 在 kendo dataviz 区域图中指定主要网格线之间的步长

> ID：13352736
> 
> 赞同：1
> 
> 时间：2012-11-12T22:38:02.473
> 
> 标签：kendo-ui, kendo-dataviz

我创建了一个面积图，展示了一天内许多媒体播放器的状态。

我希望每小时有一条主要网格线，每半小时有一条次要网格线。我看不到您可以在哪里设置网格线的“步长”。

这是我目前的设置方式：

```
$("#chart").kendoChart({
    theme: "blueOpal",
    title: {
        visible:false
    },
    chartArea: {
        height: 800
    },
    legend: {
        position: "bottom"
    },
    seriesDefaults: {
        type: "area",
        stack: true
    },
    series: [],
    valueAxis: {
        labels: {
            format: "{0}",
            visible: true
        }
    },
    categoryAxis: {
        categories: [],
        labels: {
            visible: true,
            step:60
        },
        minorGridLines: {
            visible: false
        },
        majorGridLines: {
            visible: true,
        },
        majorTicks: {
            visible: false,
            size: 2
        }
    },
    tooltip: {
        visible: true,
        format: "{0}"
    },
    seriesColors: [
            '#336699',
            '#EBAD60',
            '#FF0000',
            '#9582BB',
            '#028482'
    ]
}); 
```

它看起来像这样。这个缩小的图像显示了更少的实际显示的网格线，但是这个图像仍然表明有太多的线，它们不再起作用。

![在此处输入图像描述](../Images/26d85ba2851948a55de53ea10f507cf1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T21:55:31.567

我在 Telerik 论坛上发布了同样的问题：

[http://www.kendoui.c​​om/forums/dataviz/chart/specify-the-step-between-major-gridlines-in-a-datetime-series.aspx#2378855](http://www.kendoui.com/forums/dataviz/chart/specify-the-step-between-major-gridlines-in-a-datetime-series.aspx#2378855)

答案是：不能在 Kendo UI DataViz 中设置网格线步长。

希望我有理由在 2013 年回来更新这个答案。

* * *

**稍后编辑**

最后，在 2014.1 版本的 Kendo UI 中，您可以指定垂直网格线的频率。这是通过配置属性`categoryAxis.majorGridLines.step`和`categoryAxis.minorGridLines.step`

```
 categoryAxis: {
        categories: [],
        labels: {
            visible: true,
            step: 60
        },
        minorGridLines: {
            visible: true,
            step: 30
        },
        majorGridLines: {
            visible: true,
            step: 60
        },
        majorTicks: {
            visible: false,
            size: 2
        }
    }, 
```

# c# - 使用 WPF 耗尽系统句柄来调整图像大小

> ID：13352737
> 
> 赞同：1
> 
> 时间：2012-11-12T22:38:08.510
> 
> 标签：c#, wpf, image-processing

我在 ASP.Net 进程的上下文中使用 WPF 调整图像大小，我发现在我的调整大小过程中施加大量负载后，我最终得到异常“操作成功完成”和我的图像转换失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:38:08.510

这是由 WPF 要求在 HWND（窗口句柄）的上下文中运行引起的。如果 WPF 操作在窗口或应用程序的上下文之外运行，它将创建一个新的`Dispatcher`并在进程中使用一个窗口句柄。这些句柄不一定会在 .net GC 运行的同时被收集，因此这会导致泄漏。

对此的解决方案是引用单个调度程序，例如`Dispatcher.CurrentDispatcher`，并将其传递给需要运行 WPF 操作的所有方法。然后调度程序可以接受一个动作来运行，所以你可以用类似的东西来调用它`_dispatcher.Invoke(() => ClassResizeMethod(image, size))`

# asp.net - 将 Excel 文件从 ASP.NET 应用程序上传到 MySQL 时出错

> ID：13352739
> 
> 赞同：15
> 
> 时间：2012-11-12T22:38:11.210
> 
> 标签：asp.net, mysql, vb.net, excel-interop

我正在开发一个带有**MySQL**数据库的 Web 应用程序 ( **ASP.NET )。**当我尝试通过此应用程序上传 Excel 文件 ( **.xlsx** ) 时，我没有任何问题。当文件超过 24904 条记录时，问题就开始了。

 ****那时我收到以下错误：

> 此表包含超出此电子表格中定义的单元格范围的单元格。

它写入前 24904 条记录。

我试图将负载分成多批，但没有奏效。

有什么想法吗？

```
Dim connExcel As New System.Data.OleDb.OleDbConnection(conStr)
Dim cmdExcel As New System.Data.OleDb.OleDbCommand()
Dim dt As New DataTable()
Dim dataset As New DataSet
Dim x As Integer = 2
Dim y As Integer = 20001
Dim range As String = "A" + x.ToString + ":" + "I" + y.ToString

cmdExcel.Connection = connExcel

If erro = 0 Then
    Try

        For i As Integer = 0 To 50
            connExcel.Open()

            dataset.Reset()
            dataset.Clear()

            Dim oda As New System.Data.OleDb.OleDbDataAdapter("SELECT * FROM [Sheet1$" & range.ToString & "]", connExcel)
            oda.TableMappings.Add("Table", "ExcelTest")

            oda.Fill(dataset)
            connExcel.Close()

            If dataset.Tables(0).Rows.Count > 0 Then
                SendToDB(dataset)
            Else
                i = 50
            End If

            x = x + 20000
            y = y + 20000

            range = "A" + x.ToString + ":" + "I" + y.ToString
        Next

        Label7.Visible = True
        Label7.Text = "The information has been written successfully from 0 to " + y.ToString

    Catch ex As Exception
        Label9.Visible = True
        Label9.Text = "Database Error 2:" + ex.Message
        connExcel.Close()
    End Try
End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-22T13:54:49.087

我不使用 OLDB 或 excel，因为它在阅读 excel 时会产生很多问题

我使用 ExcelDataReader [https://github.com/ExcelDataReader/ExcelDataReader](https://github.com/ExcelDataReader/ExcelDataReader)

***尝试这个***

安装包 ExcelDataReader

```
public static DataSet GetExcelDataSet(string filePath)
    {
        FileStream stream = File.Open(filePath, FileMode.Open, FileAccess.Read);

        IExcelDataReader excelReader;
        if (Path.GetExtension(filePath) == ".xls")
        {
            //Choose one of either 1 or 2
            //1\. Reading from a binary Excel file ('97-2003 format; *.xls)
            excelReader = ExcelReaderFactory.CreateBinaryReader(stream);
        }
        else
        {
            //2\. Reading from a OpenXml Excel file (2007 format; *.xlsx)
            excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);
        }
        //Choose one of either 3, 4, or 5
        //3\. DataSet - The result of each spreadsheet will be created in the result.Tables

        ////////DataSet result = excelReader.AsDataSet();

        //4\. DataSet - Create column names from first row
        excelReader.IsFirstRowAsColumnNames = true;
        DataSet result = excelReader.AsDataSet();

        //5\. Data Reader methods
        //while (excelReader.Read())
        //{
        //    //excelReader.GetInt32(0);
        //}

        //6\. Free resources (IExcelDataReader is IDisposable)
        excelReader.Close();
        return result;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:06:33.503

我怀疑您已达到 Excel 限制（例如您可以添加的表映射数量）

尝试以更高的数字开始循环计数，看看它是否是您执行此操作的次数而不是导致问题的数据。也许是这样的：

```
Dim x As Integer = 40002
Dim y As Integer = 60001 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T10:36:27.947

你可以重置你的范围......通过添加计数器变量......为特定范围增加它......并重置它......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-02T09:24:58.970

您还可以在文件查询中使用 LOAD DATA 将 excel 文件加载到数据库中。查询的语法是：

```
LOAD DATA [LOW_PRIORITY | CONCURRENT] [LOCAL] INFILE 'file_name'
    [REPLACE | IGNORE]
    INTO TABLE tbl_name
    [CHARACTER SET charset_name]
    [{FIELDS | COLUMNS}
        [TERMINATED BY 'string']
        [[OPTIONALLY] ENCLOSED BY 'char']
        [ESCAPED BY 'char']
    ]
    [LINES
        [STARTING BY 'string']
        [TERMINATED BY 'string']
    ]
    [IGNORE number LINES]
    [(col_name_or_user_var,...)]
    [SET col_name = expr,...] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-13T11:21:44.740

Excel 的限制比这更大。您的单元格包含超出指定范围的隐藏字符或空格（如错误消息所述），请检查错误行上“最后一个”列右侧的列。我想你会发现它们包含一些东西。

一种简单的测试方法，创建一个包含 50 000 条记录的全新文件，其中填充了新数据。我想你会发现它有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-28T05:17:29.580

删除范围使用 Sheet1 ...并重新测试 Dim oda As New System.Data.OleDb.OleDbDataAdapter("SELECT * FROM [Sheet1$]", connExcel)****

# batch-file - 延迟执行目录中的文件

> ID：13352742
> 
> 赞同：-1
> 
> 时间：2012-11-12T22:38:15.750
> 
> 标签：batch-file

我需要运行一个批处理文件，该文件遍历一个目录中的 700 多个文件并一个接一个地执行它们……但有 3 分钟的延迟。所有文件具有相同的扩展名，但文件名不同。所以它会执行第一个文件.....睡眠3分钟......然后运行目录中的下一个文件。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:40:14.857

只需使用普通循环并使用`timeout`等待：

```
for %%x in (*.extension) do (
  start %%x
  timeout /t 180 /nobreak >nul
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:46:38.893

你得到那个手册页是什么。一种带有向前笔划的有趣指定选项（用于路径名）......

我想你的意思是；

```
for x in (*.extension); do 
  ./$(x);
  timeout 180 > /dev/null;
done 
```

# html - 谁能告诉我页脚和社交链接条纹之间出现了什么空白？

> ID：13352744
> 
> 赞同：2
> 
> 时间：2012-11-12T22:38:31.617
> 
> 标签：html, css, alignment

我想知道这个问题在这里是否足够......但我遇到了这个我无法解决的问题。

一切都可以在我的网站上找到......但由于某种原因，我无法摆脱页脚和社交按钮条纹之间的白色条纹。任何想法为什么会这样？

这是网站： http: [//gaberivers.com/prueba/](http://gaberivers.com/prueba/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:43:35.423

检查你的 CSS 是否有 #socialfooter 并将其高度降低到 30 像素；

# shopify - 有什么方法可以根据客户标签自定义 shopify 结帐页面？

> ID：13352748
> 
> 赞同：0
> 
> 时间：2012-11-12T22:39:00.397
> 
> 标签：shopify

到目前为止，我发现定义的唯一液体变量是设置。shop、customer 和 order 都没有定义，令人失望。

有没有办法根据客户拥有的标签来隐藏/显示元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T16:06:34.727

如果您正在谈论客户输入其信息的两个结帐页面，那么不是。我相信出于安全原因等等，没有任何第三方可以在那里运行。

我很确定您只能更改结帐页面的样式表。

# sql - 请求嵌套选择/子查询的一个很好的例子

> ID：13352759
> 
> 赞同：0
> 
> 时间：2012-11-12T22:39:30.833
> 
> 标签：sql, sql-server-2005

我必须学习如何创建嵌套的选择/子查询（它们是一样的吗？？）而且我很难找到一个很好的学习点......任何有用的教程/解释的链接？

我希望我可以学习，所以我不必依赖这里的天才。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T00:23:48.287

检查这两个链接，这是一篇关于 T-sql 子查询的好文章

> [http://www.databasejournal.com/features/mssql/article.php/3485291/Using-a-Correlated-Subquery-in-aT-SQL-Statement.htm](http://www.databasejournal.com/features/mssql/article.php/3485291/Using-a-Correlated-Subquery-in-a-T-SQL-Statement.htm)
> 
> [http://www.akadia.com/services/sqlsrv_subqueries.html](http://www.akadia.com/services/sqlsrv_subqueries.html)

# java - 似乎无法使用 UrlClassLoader 加载我的课程

> ID：13352761
> 
> 赞同：0
> 
> 时间：2012-11-12T22:39:39.877
> 
> 标签：java, urlclassloader

所以我做了一个超级简单的文件，然后把它上传到我的服务器上：

```
http://myServer:8080/testApp/ 
```

其中有 testApp.jar 和一个充当 bin 的文件夹。我已经尝试了一些方法来解决这个问题，但我不断收到：线程“main”中的异常 java.lang.ClassNotFoundException: com.testApp.Main

```
The full path to Main.Class is http://myserver:8080/testApp/com/myCom/Main.Class 
```

我找到这个的代码是

```
 URLClassLoader loader = new URLClassLoader(new URL[]{new File("http://myserver04:8080/testApp/").toURI().toURL()});

    Class<?> mainClass = loader.loadClass("com.myCom.Main");
    Method mainMethod = mainClass.getMethod("main", String[].class);
    mainMethod.invoke(null, new String[]{});
} 
```

我的最终目标只是运行该文件的主要方法，并且正在启动的文件将有一个简单的“Hello World”摆动窗口。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T05:38:41.070

从只是浏览[URLClassLoader](http://docs.oracle.com/javase/7/docs/api/java/net/URLClassLoader.html#URLClassLoader%28java.net.URL%5b%5d%29)的 javadocs ：

> 假设任何以“/”结尾的 URL 都指向一个目录。否则，假定 URL 指向将根据需要下载和打开的 JAR 文件。

您指定的 URL 以斜杠结尾，因此类加载器希望看到`.class`该目录中的文件。尝试在 URL 中指定 JAR 的完整路径

# wordpress - wordpress主页的博客类别特定滑块？

> ID：13352762
> 
> 赞同：1
> 
> 时间：2012-11-12T22:39:54.173
> 
> 标签：wordpress, slider, responsive-design

我希望有人能指出我正确的方向或提供一些指导。我目前正在为我的主页滑块使用响应式幻灯片插件。它工作得很好，但它创建了一个自定义的帖子类型。这很好，但我想通过它运行我的博客文章。本质上，我想创建一个类别并将其命名为“滑块”，并让该类别中的博客文章使用滑块。我使用这个特定滑块的原因是因为它适合响应式主题。使用我当前的设置（下面的代码）有什么简单的方法可以做到这一点，或者有人可以为我指出如何实现这一目标的正确方向吗？提前致谢！（网站不在现场，它在我电脑的本地主机上）

**在主题首页使用简码**

```
 {<div id="flexfix" class="span11"> 
           <?php do_shortcode( '[responsive_slider]' ); ?>
           </div><!-- End Flexslider -->} 
```

**响应式滑块查询**

{函数响应滑块（）{

```
$slides = new WP_Query( array( 'post_type' => 'slides', 'order' => 'ASC', 'orderby' => 'menu_order' ) );

if ( $slides->have_posts() ) : ?>

    <div class="responsive-slider flexslider">

        <ul class="slides">

        <?php while ( $slides->have_posts() ) : $slides->the_post(); ?>

            <li>

                <div id="slide-<?php the_ID(); ?>" class="slide">

                    <?php global $post; ?>

                        <?php if ( has_post_thumbnail() ) : ?>

                        <!--edited by david crothers 11/8/12-->
                            <!--<?php echo get_post_meta( $post->ID, "_slide_link_url", true ); ?><?php the_title_attribute(); ?>-->
                            <a href="<?php the_permalink(); ?>" title="<?php the_title_attribute(); ?>" >
                                <?php the_post_thumbnail( 'slide-thumbnail', array( 'class' => 'slide-thumbnail' ) ); ?>
                            </a>

                                <h2 class="slide-title"><?php the_title()?></h2>

                        <?php endif; ?>

                </div><!-- #slide-x -->

            </li>

        <?php endwhile; ?>

        </ul>

    </div><!-- #featured-content -->} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:49:17.147

只需更改 WP_Query 中的参数即可。将 post_type 更改为标准“post”，然后将其设置为您的新类别；

```
 $slides = new WP_Query( array( 'post_type' => 'post', 'category_name' => 'slider', 'order' => 'ASC', 'orderby' => 'menu_order' ) ); 
```

[http://codex.wordpress.org/Class_Reference/WP_Query#Category_Parameters](http://codex.wordpress.org/Class_Reference/WP_Query#Category_Parameters)

# iphone - MPMediaQuery 搜索艺术家、专辑和歌曲

> ID：13352767
> 
> 赞同：11
> 
> 时间：2012-11-12T22:40:07.650
> 
> 标签：iphone, objective-c, ios, mpmediaitem, mpmediaquery

如何以与 iOS 音乐应用程序相同的方式搜索 iPod 库？我想进行一般查询，返回每个艺术家、专辑和歌曲的结果。例如，如果我搜索 Kenny Chesney，我希望歌曲查询返回所有 Kenny Chesney 歌曲（以及其中包含 Kenny Chesney 的任何歌曲标题或专辑。）当我进行此查询和每个属性的谓词（歌曲标题、专辑标题，艺术家姓名），返回一个空数组。

**这是一些代码，可以让您更好地了解我正在尝试完成的工作：**

```
MPMediaPropertyPredicate *songPredicate =
[MPMediaPropertyPredicate predicateWithValue:searchText
                                 forProperty:MPMediaItemPropertyTitle
                              comparisonType:MPMediaPredicateComparisonContains];

MPMediaPropertyPredicate *albumPredicate =
[MPMediaPropertyPredicate predicateWithValue:searchText
                                 forProperty:MPMediaItemPropertyAlbumTitle
                              comparisonType:MPMediaPredicateComparisonContains];

MPMediaPropertyPredicate *artistPredicate =
[MPMediaPropertyPredicate predicateWithValue:searchText
                                 forProperty:MPMediaItemPropertyArtist
                              comparisonType:MPMediaPredicateComparisonContains];

MPMediaQuery *songsQuery = [MPMediaQuery songsQuery];
[songsQuery addFilterPredicate:songNamePredicate];
[songsQuery addFilterPredicate:artistNamePredicate];
[songsQuery addFilterPredicate:albumNamePredicate];

NSLog(@"%@", [songsQuery items]); 
```

我通过分别对每个谓词运行查询来实现这一点，但这似乎非常低效！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-06T12:31:54.610

以这种方式组合您的谓词使其类似于“AND”关系。这意味着您正在查询的歌曲的标题、专辑和名称都与搜索文本匹配。

为了实现您想要做的事情，您应该运行 3 个查询并以适当的方式组合结果。

如果你运行：

```
MPMediaPropertyPredicate *artistPredicate =
[MPMediaPropertyPredicate predicateWithValue:searchText
                                 forProperty:MPMediaItemPropertyArtist
                              comparisonType:MPMediaPredicateComparisonContains];

NSSet *predicates = [NSSet setWithObjects: artistPredicate, nil];

MPMediaQuery *songsQuery =  [[MPMediaQuery alloc] initWithFilterPredicates: predicates];

NSLog(@"%@", [songsQuery items]); 
```

这将为您返回与您的搜索匹配的艺术家。你应该对歌曲和专辑做同样的事情。

如果您这样做很慢，您可以一次检索所有媒体并手动过滤：

```
MPMediaQuery *everything = [[MPMediaQuery alloc] init];

NSLog(@"Logging items from a generic query...");
NSArray *itemsFromGenericQuery = [everything items];
for (MPMediaItem *song in itemsFromGenericQuery) {
    NSString *songTitle = [song valueForProperty: MPMediaItemPropertyTitle];
    /* Filter found songs here manually */
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-06T15:26:21.337

这对我有用：

```
MPMediaQuery *searchQuery = [[MPMediaQuery alloc] init];
NSPredicate *test = [NSPredicate predicateWithFormat:@"title contains[cd] %@ OR albumTitle contains[cd] %@ OR artist contains[cd] %@", searchString, searchString, searchString];
NSArray *filteredArray = [[searchQuery items] filteredArrayUsingPredicate:test];

//NSLog(@"%@", [filteredArray valueForKeyPath:@"title"]);

for (MPMediaItem *song in filteredArray) 
{
    [arrayOfSongItems addObject:song];
} 
```

我基本上在从媒体查询中获取所有项目*后进行过滤。*我认为我的解决方案并不比首先过滤查询更好，但绝对比单独搜索三次更好。或者多次遍历数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T05:34:25.617

这里有两种方法：

1.  使用多个 MPMediaPropertyPredicates 来使用查询获取所有内容。使用这种方法，您将需要执行多个查询并自己汇总结果。NSSet 是你的朋友！

2.  从库中获取所有内容（或接近它），然后进行搜索或过滤。

在旧设备或操作系统版本上访问音乐库可能非常慢。根据我自己实现与您所描述的内容非常相似的经验，我使用方法 2 获得了最佳结果。一旦我拥有了几乎所有内容，然后我使用分散/收集方法迭代这些项目（我的需求不允许为此使用 NSPredicate）。对我来说，这实际上比方法 1 的性能要好得多，尽管我知道在 iOS 6 中这个差距已经缩小了一些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-06T09:58:20.230

运行查询后过滤项目的 Swift 3+ 解决方案，类似于[Mohammed Habib 的回答](https://stackoverflow.com/a/14729177/3151675)：

```
let searchString = “string to search”
let query = MPMediaQuery()

let filteredItems = query.items?.filter { item -> Bool in
    let properties = [item.songTitle,
                      item.artist,
                      item.albumTitle]

    let lowercasedProperties = properties.compactMap { $0.lowercased() }

    return lowercasedProperties.contains(searchString.lowercased())
}

print(filteredItems ?? []) 
```

# sql - 在 SQL Server 中聚合用户定义的功能步骤图

> ID：13352768
> 
> 赞同：1
> 
> 时间：2012-11-12T22:40:10.460
> 
> 标签：sql, sql-server-2008, user-defined-functions

我知道聚合用户定义函数涉及步骤

*   初始化
*   累积（此步骤涉及线程）
*   合并
*   终止

任何人都可以建议一个图表或绘图，比如这个样子吗？我找到了某种示例（map-reduce Paradigm），但我想将其概括为 SQL 术语

![在此处输入图像描述](../Images/8152a3db3cf602d3bc38338c6df35253.png)

所以你会问自己为什么我想做一个图表。我找到了关于他们解释的[用户定义聚合的 msdn](http://msdn.microsoft.com/en-us/library/ee842720.aspx) 解释：

> 在窗口规范之上使用用户定义的聚合来聚合该窗口中的事件并生成单个结果值。UDA 将 CEP 窗口（即跳跃、快照窗口或基于计数的窗口运算符的结果）作为其输入，该窗口包含一组 CEP 事件并输出单个返回值（映射到StreamInsight 原始类型）。有关窗口的更多信息，请参阅使用事件窗口。
> 
> 与 StreamInsight 提供的类似于 count、sum 和 average 的简单聚合相比，您可以实现功能更复杂的 UDA。一个这样的例子，计算时间加权平均值，将在后面的章节中讨论。

但是我在 SQL Server 中制作关于它的一般绘图时遇到问题，搜索更多我发现了 oracles： ![在此处输入图像描述](../Images/6637eaf49953cf92c43644c901b97059.png) ![在此处输入图像描述](../Images/ce6fbd4909543d513747286f2a71ce61.png)

# java - 在 Android 上使用 klio-mobile-dataservice 的 NoClassDefFoundError

> ID：13352773
> 
> 赞同：1
> 
> 时间：2012-11-12T22:40:17.117
> 
> 标签：java, android, noclassdeffounderror

我正在尝试实现[klio's library](http://code.google.com/p/klio-mobile-dataservice/wiki/HOWTOSample)，但即使按照教程进行操作，我也会不断收到此异常。

这是日志猫：

```
 11-12 23:34:30.979: E/AndroidRuntime(27299): FATAL EXCEPTION: main
    11-12 23:34:30.979: E/AndroidRuntime(27299): java.lang.NoClassDefFoundError: flex.messaging.io.amf.client.AMFConnection
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at tiwiz.connection.test.ConnectionActivity.retrieveNetData(ConnectionActivity.java:72)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at tiwiz.connection.test.ConnectionActivity.onCreate(ConnectionActivity.java:32)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.Activity.performCreate(Activity.java:5008)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2139)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2210)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.ActivityThread.access$600(ActivityThread.java:142)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1208)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.os.Handler.dispatchMessage(Handler.java:99)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.os.Looper.loop(Looper.java:137)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at android.app.ActivityThread.main(ActivityThread.java:4931)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at java.lang.reflect.Method.invokeNative(Native Method)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at java.lang.reflect.Method.invoke(Method.java:511)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
    11-12 23:34:30.979: E/AndroidRuntime(27299):    at dalvik.system.NativeStart.main(Native Method) 
```

编译顺利，所以看起来它在编译过程中找到了类......有人可以帮助我吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:28:10.877

问题是由于从版本 17 开始在 ADT 中管理库的方式发生了变化。

[这](http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17)是解决方案，本质上是：

1.  从您的 Java 构建路径中删除*KlioMobileDS项目*
2.  将其导出到 .jar
3.  将该 .jar 放入您的项目**库**文件夹中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T02:01:39.830

检查项目中是否有 libs 文件夹。如果不创建它并将所有外部库添加到它。然后将这些库从这个 libs 文件夹导入到您的构建路径中。就是这样。如果问题仍然存在，请转到 Build Path 中的 Order and Export 选项卡，并将您导入的所有库移动到顶部。

# java - 将 HEX 字符串转换回 AES

> ID：13352777
> 
> 赞同：0
> 
> 时间：2012-11-12T22:40:38.003
> 
> 标签：java, encryption, hex, aes

这是我面临的问题。服务器 A（即 IBM i740 主机）上运行着一种机制，它获取安全数据并使用 AES 对其进行加密。现在我，我想得到那个加密数据（AES 加密字符串），但由于它使用乱码，它不能通过 http 传输。因此，为了让我得到它，有一个 Web 服务公开，它发现 AES 加密字符串 HEX'es 并返回一个 HEX 字符串，如 F51A751CC72124EE95518BECBA1F47C4。我的问题是，有什么方法可以让我将 HEX 值（最好在 Java 中）转换回 AES 加密字符串（我不想解密字符串，只需将其恢复为原始加密值）？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:46:51.037

总而言之，您面临的问题是您希望通过 HTTP传输*二进制数据。*（这与加密无关；这只会使问题复杂化。）有趣的是，我们一直在通过 HTTP 传输二进制数据！（图片等）

您需要明确您计划*如何*传输数据。您是否将其包含在 HTTP POST 中？如果是这样，那么您需要对数据进行*编码*。Base64 在这里是理想的。

否则，您可能可以以二进制形式传输它，这只是解释您需要*如何*传输它的问题，因此可以设置正确的东西（例如 Mime 类型？），这样数据就不会在传输中损坏。

# code-coverage - xcode 4.5 的代码覆盖率 - 没有生成 gcda

> ID：13352786
> 
> 赞同：2
> 
> 时间：2012-11-12T22:41:13.263
> 
> 标签：code-coverage, xcode4.5

我有一个使用 Apple LLVM 4.1 编译器在 Xcode 4.5 上运行的简单项目。

我在构建设置中设置了以下标志：

1.  生成分析代码：是
2.  仪器程序流程：是 生成
3.  测试覆盖率文件：是

我在 iPad 6.0 Simulator 上运行该应用程序，一旦应用程序启动，我将单击几个按钮并使用它。

我没有对此进行单元测试，而是手动单击按钮。在派生数据...下，我看到的只是 .gcov 文件。但是没有 .gcda 文件正在生成。

真的很感激你可能有的任何指示！

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T11:29:40.883

我试过和你一样的设置。只需在 iPad 5.1 模拟器上运行该应用程序，我就能够生成代码覆盖率文件。它不适用于 iPad 6.0 模拟器。

我采取的步骤：

在 Xcode 项目的主要目标中，在构建设置中设置以下标志：

生成测试覆盖文件：是仪器程序流程：是

仅为调试设置这些标志。

在应用程序的 info.plist 中，设置“应用程序不在后台运行”：是

仅当应用程序正确关闭时才会生成 .gcda 文件。设置上述标志将在您按下 HOME 按钮时关闭您的应用程序。它不会在后台运行。不知何故，这个标志不适用于 iPad 6.0 模拟器。

# java - Mac os x JMenuItem 加速器不显示

> ID：13352789
> 
> 赞同：1
> 
> 时间：2012-11-12T22:41:19.550
> 
> 标签：java, macos, swing, jmenuitem, jmenubar

设置 JMenuBar 并将其添加到 JFrame 后，我有普通菜单（在 JFrame 的顶部），并且键盘快捷键（加速器）很好地显示在每个 JMenuItem 旁边（因此 JMenuBar 工作正常）。然而问题是，在使用以下代码行在屏幕顶部显示 JMenuItem 后，快捷方式将不再显示在 JMenuItems 旁边。

```
if((System.getProperty("os.name").startsWith("Mac OS X"))) {
    System.setProperty("apple.laf.useScreenMenuBar", "true");
} 
```

更奇怪的是，JCheckBoxMenuItems 确实显示了快捷方式。有谁知道这怎么可能？

可能有用的信息：

*   软件：Mac OS X Lion 10.7.5
*   Java：版本 7 更新 9，JDK 1.9

此外，我仍然不完全清楚助记键的作用。如果 JMenuItem alrady 有加速器，JMenuItem 的助记键是否会添加任何功能？

如果有任何问题，请不要犹豫。

提前致谢

# perl - 用于替换列中字符的脚本

> ID：13352790
> 
> 赞同：0
> 
> 时间：2012-11-12T22:41:20.800
> 
> 标签：perl, shell

如果基于一行的前 10 个字符，我正在寻找一些帮助来替换特定字符。例如：

如果线路是

```
test  (    2 ) [123456789] 
```

我想用

```
test  (    2 ) [123MMM789] 
```

即，如果该行以将第`test ( 2 )`19、20、21 列替换为 M

如果该行以其他任何内容开头，则可以保持原样。先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:51:01.497

您可以使用匹配和[`substr`](http://perldoc.perl.org/functions/substr.html)：

```
while (<>) {
  substr($_, 19, 3) = 'MMM' if /^test  \(    2 \)/;
  print;
} 
```

这也可以直接应用于命令行，因为它非常简单：

```
$ perl -pe 'substr($_, 19, 3) = "MMM" if /^test  \(    2 \)/' file.txt 
```

# python - 什么返回值用于显示方法在python中成功或失败

> ID：13352792
> 
> 赞同：0
> 
> 时间：2012-11-12T22:41:32.700
> 
> 标签：python, python-2.7, boolean

在 python 中显示操作失败的正确方法是什么。在这段代码中，返回值应该是什么？

```
def compare(y,x):
     if y ==  x:
         return 'true'
     return 'false' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T23:12:20.990

Python 有文字值`True`，`False`你可以使用它。但是，很少需要显式使用它们，因为在大多数情况下，比较操作将返回一个或另一个值。例如，您可以将您的功能重做为：

```
def compare(y, x):
    return y == x 
```

还值得注意的是，如果需要，非布尔值可以被认为是“真”或“假”。“假”值是`None`,`0`和所有空容器（例如空字符串`''`、空列表`[]`、空元组`()`、空字典`{}`等）。默认情况下，其他所有内容都是“真实的”，包括大多数对象的所有实例。

自定义类可以通过实现神奇的方法[`__nonzero__`](http://docs.python.org/2/reference/datamodel.html#object.__nonzero__)（[`__bool__`](http://docs.python.org/3/reference/datamodel.html#object.__bool__)在 Python 3 中重命名为）来定义布尔转换。如果不存在，Python 将检查`__len__`，如果不存在则放弃并假设所有实例都为真。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T23:03:33.763

```
def compare(y,x):
     if y == x:
         return True
     return False 
```

或隐含的：

```
def compare(y,x):
    return x == y 
```

这里是python布尔类型的更详细介绍：http: [//docs.python.org/release/2.3.5/whatsnew/section-bool.html](http://docs.python.org/release/2.3.5/whatsnew/section-bool.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T23:40:35.320

您的`compare()`示例对这个问题有问题，原因有两个：

*   在 Python 中，您通常只使用一个 bare`==`来获得布尔比较结果，而不是调用一个函数。
*   这里的结果都不是“成功”或“失败”，因此它们并没有真正解决标题问题。

在 Python 中，函数通常不是通过返回值来指示成功或失败，而是通过假设它们成功，除非它们引发异常。出于三个原因，例外情况比返回指示更可取：

*   他们更难被意外忽略。
*   它们不要求您保留原本有效的返回值。
*   它们可以在调用树中最方便的位置直接处理，而无需通过多个函数返回显式传递错误值。

这是一个更 Pythonic 的示例：

```
def doThing(x,low,high):        
    """
    Do a thing if x is between the low and high values, inclusive. 
    If x is out of bounds, the thing fails.
    """
    if x < low or x > high:
         raise ValueError( "x is out of bounds" )
    return (x-low)/(high-low) 
```

# python - 从数据库中查询 twitter 流 api 关键字

> ID：13352796
> 
> 赞同：1
> 
> 时间：2012-11-12T22:42:05.177
> 
> 标签：python, mongodb, twitter, tweepy

我正在通过跟踪几个关键字来过滤 twitter 流 API。

例如，如果我只想查询并从我的数据库中返回通过跟踪关键字 = 'BBC' 过滤的推文信息，该怎么做？

收集的推文信息是否具有与过滤它的关键字相关的键：值？

我正在使用 python、tweepy 和 MongoDB。

是否可以在返回的 json 'text' 字段中搜索关键字？因此生成一个查询，它在返回的 json 数据的文本字段中搜索该关键字 = 'BBC'？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-13T19:21:37.163

不幸的是，Twitter API 没有提供这样做的方法。您可以尝试通过接收推文搜索您指定的关键字，但它可能不完全匹配。

# html - 容器中的 HTML CheckBox 标签未按预期显示

> ID：13352797
> 
> 赞同：0
> 
> 时间：2012-11-12T22:42:06.397
> 
> 标签：html, css

以下 HTML 代码尝试在`<div></div>`容器内显示复选框。

```
<div style="overflow: auto; width: auto; display:block; max-height:130px; max-width:200px; background-color: #FFF; height: auto; border: 1px double #336699; padding-left: 2px;">

    <label for="chk12" style='white-space: nowrap;'>
        <input type='checkbox' id="chk12" name='chk_colours' value="12" class='validate[required] text-input text'>
        <div style='background-color:#FF8C00; width: 180px;' title="darkorange">&nbsp;&nbsp;</div>
    </label>    

    <label for="chk11" style='white-space: nowrap;'>
        <input type='checkbox' id="chk11" name='chk_colours' value="11" class='validate[required] text-input text'>
        <div style='background-color:#D9D919; width: 180px;' title="brightgold">&nbsp;&nbsp;</div>
    </label>

    <label for="chk10" style='white-space: nowrap;'>
        <input type='checkbox' id="chk10" name='chk_colours' value="10" class='validate[required] text-input text'>
        <div style='background-color:#76EE00; width: 180px;' title="chartreuse2">&nbsp;&nbsp;</div>
    </label>

    <label for="chk9" style='white-space: nowrap;'>
        <input type='checkbox' id="chk9" name='chk_colours' value="9" class='validate[required] text-input text'>
        <div style='background-color:#2E0854; width: 180px;' title="indigo">&nbsp;&nbsp;</div>
    </label>

    <label for="chk8" style='white-space: nowrap;'>
        <input type='checkbox' id="chk8" name='chk_colours' value="8" class='validate[required] text-input text'>
        <div style='background-color:#292929; width: 180px;' title="gray16">&nbsp;&nbsp;</div>
    </label>                    
</div>
```

它显示的内容可以在以下[快照](https://i.stack.imgur.com/42Wmb.png)中看到。

[![在此处输入图像描述](../Images/db6014a876d00862844397c96a9de9bf.png)](https://i.stack.imgur.com/42Wmb.png)

可以看出，使用以下`<div>`标签显示的各种颜色条纹

```
<div style='background-color:#FF8C00; width: 180px;' title="darkorange">&nbsp;&nbsp</div> 
```

`white-space: nowrap;`显示在它们各自的复选框下方，即使我使用的是样式属性，它们也应该以直线显示。

如何以直线显示每个条纹及其各自的复选框？

* * *

我的一个问题本身对此进行了解释，但在那个问题中，每个复选框都有一个文本标签来代替这种彩色条纹。[在这里](https://stackoverflow.com/q/12884046/1391249)。我尝试按照该问题的已接受答案中所述进行操作，但在这种情况下无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:48:12.543

你已经习惯`DIV`了标记标签。默认情况下`DIV`显示为块元素。只需将其设置为`display: inline;`或`display: inline-block;`。或者使用其他元素——例如`SPAN`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:47:47.917

不要使用`<div>`s，它们是块元素，导致它们与复选框不对齐。尝试使用`<span>`s 代替

**编辑**

或者添加`float:right`到有色`<div>`s的CSS

**编辑 2**

使用一点 CSS：

```
label div{
   display: inline-block;
} 
```

​ 此处示例：http: [//jsfiddle.net/koenpunt/Ca22j/](http://jsfiddle.net/koenpunt/Ca22j/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T22:53:29.450

干得好 ：）

[http://jsfiddle.net/Uaq85/](http://jsfiddle.net/Uaq85/)

```
<div style="overflow: auto; width: auto; display:block; max-height:130px; max-width:200px; background-color: #FFF; height: auto; border: 1px double #336699; padding-left: 2px;">

    <label for="chk12" style='white-space: nowrap;'>
        <input type='checkbox' id="chk12" name='chk_colours' value="12" class='validate[required] text-input text'>
        <div style='background-color:#FF8C00; width: 180px;display:inline-block;' title="darkorange">&nbsp;&nbsp;</div>
    </label>    

    <label for="chk11" style='white-space: nowrap;'>
        <input type='checkbox' id="chk11" name='chk_colours' value="11" class='validate[required] text-input text'>
        <div style='background-color:#D9D919; width: 180px;display:inline-block;' title="brightgold">&nbsp;&nbsp;</div>
    </label>

    <label for="chk10" style='white-space: nowrap;'>
        <input type='checkbox' id="chk10" name='chk_colours' value="10" class='validate[required] text-input text'>
        <div style='background-color:#76EE00; width: 180px;display:inline-block;' title="chartreuse2">&nbsp;&nbsp;</div>
    </label>

    <label for="chk9" style='white-space: nowrap;'>
        <input type='checkbox' id="chk9" name='chk_colours' value="9" class='validate[required] text-input text'>
        <div style='background-color:#2E0854; width: 180px;display:inline-block;' title="indigo">&nbsp;&nbsp;</div>
    </label>

    <label for="chk8" style='white-space: nowrap;'>
        <input type='checkbox' id="chk8" name='chk_colours' value="8" class='validate[required] text-input text'>
        <div style='background-color:#292929; width: 180px;display:inline-block;' title="gray16">&nbsp;&nbsp;</div>
    </label>                    
</div>
```

# magento - Magento - 在产品页面上选择一个选项不会刷新

> ID：13352802
> 
> 赞同：0
> 
> 时间：2012-11-12T22:42:33.320
> 
> 标签：magento

我可能遗漏了一些东西，但我们会在“附加信息”选项卡上显示我们的 SKU 和物品重量。在设置可配置项目时，我们将为相关产品设置一个唯一的 sku。例如，当客户选择“大”时，显示的 sku 是原始 sku，而不是更新后的 sku。与重量相同。由于可配置产品没有重量并且重量仅适用于相关产品，因此当客户选择他们的选项时，它不会将附加信息刷新到自定义属性。

从下拉选项中选择选项时如何刷新产品视图有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:55:47.437

我很确定 Magento 默认情况下不会这样做。我唯一一次看到可配置选项动态更新页面上的值是当可配置选项提高价格时。

如果您想用 Prototype 让自己发疯，请检查模板`/catalog/product/view/type/options/configurable.phtml`- Product.Config() 处理更新价格。如果你喜欢你的理智，做一些 jQuery voodoo 并自己更新这些值。

# iphone - 在键盘顶部显示 TextField

> ID：13352805
> 
> 赞同：1
> 
> 时间：2012-11-12T22:42:51.090
> 
> 标签：iphone, objective-c, ios

这就是我的 ViewController 在 Storyboard 中的样子：

![在此处输入图像描述](../Images/fad24116a440addeeb147988234de9c4.png)

```
@interface SettingViewController : UIViewController <UITableViewDelegate, UITableViewDataSource, NSURLConnectionDelegate> { } 
```

[我在这个链接](https://stackoverflow.com/questions/1126726/how-to-make-a-uitextfield-move-up-when-keyboard-is-present)中找到了 Shiun 的答案。但这并不是我想要的。

有时这个文本字段会消失在键盘后面。

当我单击 textField 并弹出键盘时：

我希望 TextField 在键盘顶部可见。

直到现在我都找不到任何合适的解决方案。你可以帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:48:11.927

没有直接的方法可以做到这一点。您将不得不收听键盘通知，然后通过查找键盘的高度来移动键盘上方的文本字段。

```
// Call this method somewhere in your view controller setup code.
- (void)registerForKeyboardNotifications
{
    [[NSNotificationCenter defaultCenter] addObserver:self
            selector:@selector(keyboardWasShown:)
            name:UIKeyboardDidShowNotification object:nil];

   [[NSNotificationCenter defaultCenter] addObserver:self
             selector:@selector(keyboardWillBeHidden:)
             name:UIKeyboardWillHideNotification object:nil];

}

// Called when the UIKeyboardDidShowNotification is sent.
- (void)keyboardWasShown:(NSNotification*)aNotification
{
    NSDictionary* info = [aNotification userInfo];
    CGSize kbSize = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    UIEdgeInsets contentInsets = UIEdgeInsetsMake(0.0, 0.0, kbSize.height, 0.0);
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;

    // If active text field is hidden by keyboard, scroll it so it's visible
    // Your application might not need or want this behavior.
    CGRect aRect = self.view.frame;
    aRect.size.height -= kbSize.height;
    if (!CGRectContainsPoint(aRect, activeField.frame.origin) ) {
        CGPoint scrollPoint = CGPointMake(0.0, activeField.frame.origin.y-kbSize.height);
        [scrollView setContentOffset:scrollPoint animated:YES];
    }
}

// Called when the UIKeyboardWillHideNotification is sent
- (void)keyboardWillBeHidden:(NSNotification*)aNotification
{
    UIEdgeInsets contentInsets = UIEdgeInsetsZero;
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;
} 
```

# javascript - tinyMCE 删除/禁用调整大小切换

> ID：13352810
> 
> 赞同：7
> 
> 时间：2012-11-12T22:43:14.587
> 
> 标签：javascript, wordpress, tinymce

tinyMCE 将这些添加`move and resize handles`到我的一些元素（不仅仅是图像）中。

**我很想一起摆脱它们，**但我没有成功。

这些对我不起作用

```
tinyMCE.init({

   object_resizing : false

}); 
```

看起来应该很容易。

好的，所以看起来它正在将调整大小的 js 添加到任何绝对定位的元素中。如果这可以帮助任何人回答。

我只是试图删除它，但我需要定位它来做我需要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-21T19:30:10.957

删除 jQuery，并使 cheez la weez 的答案适用于 TinyMCE 版本 4。在插件、初始化代码或实例化编辑器后仅在页面中使用它

```
// var editor = your tinyMCE editor instance (e.g. tinymce.activeEditor)

editor.on('mousedown', function(e) {

        var element = e.target,
            body = editor.dom.doc.body;

        if (editor.dom.hasClass( element, 'your-class')) {
            editor.dom.setAttrib(body,'contenteditable',false);
        } else {
            editor.dom.setAttrib(body,'contenteditable',true);
        }
}); 
```

唯一不幸的是，您的用户必须点击返回编辑器才能继续编辑（箭头键不起作用）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T01:34:19.880

在你的编辑器的 body 标签中是一个属性`contenteditable="true"`。这就是添加那些讨厌的调整大小元素的原因。

**如果您将该属性设置为`false`您将无法编辑任何内容。**

你需要做的是设置一个`onMouseDown`监听器。如果用户单击有问题的元素...将其设置为`contenteditable="false"`. 如果有任何其他元素，请将其设置为`contenteditable="true"`.

尝试这个...

```
(function() {  

    tinymce.create('tinymce.plugins.yourplugin', {  

        init : function(ed, url) { 

            ed.onMouseDown.add(function(ed, e) {    

                var body = ed.getBody();

                if(jQuery(e.target).hasClass('target-in-question')) {

                    jQuery(body).attr({'contenteditable': false})

                    // and whatever else you want to do when clicking on that element

                }else {
                    jQuery(body).attr({'contenteditable': true})
                }

            }); 

        },  

        createControl : function(n, cm) {  

            return null;  

        },  

    });  

    tinymce.PluginManager.add('yourplugin', tinymce.plugins.yourpluginl);  

})(); 
```

# python - 从字符串中删除前缀为# 或@ 的单词？

> ID：13352812
> 
> 赞同：0
> 
> 时间：2012-11-12T22:43:15.600
> 
> 标签：python

我有一个这样的文本块：

```
Hello @Simon, I had a great day today. #StackOverflow 
```

我想找到最优雅的解决方案来剥离它看起来像这样：

```
Hello, I had a great day today. 
```

即我想去掉所有前缀为# 和@ 的单词。（是的，我正在检查推文）

我是 python 新手，我可以在单个单词上执行此操作，但不确定在包含多个单词的字符串上实现此目的的最佳方法。

我的第一个想法是使用替换，但这只会去掉实际的 @ 和 # 符号。 **寻找去除前缀为 # 或 @ 的任何单词的最佳方法。**

-编辑-不确定这是否会使给出的答案无效，但为了接受，我还需要去掉多个单词包含#或$前缀的位置。例如你好#hiya #ello

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:48:22.293

您可以使用[正则表达式](http://docs.python.org/3/library/re.html)：

```
>>> import re
>>> s = 'Hello @Simon, I had a great day today. #StackOverflow'
>>> re.sub(r'(?:^|\s)[@#].*?(?=[,;:.!?]|\s|$)', r'', s)
'Hello, I had a great day today.' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:47:14.700

就像编写一个匿名函数并将其放入过滤器语句中一样简单

```
' '.join(filter(lambda x: x[0] not in ['@','#'], tweet.split())) 
```

这将丢失@users 或#topics 上的逗号，但如果您只是处理推文，您可能不会错过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:49:25.563

```
' '.join([w for w in s.split() if len(w)>1 and w[0] not in ['@','#']]) 
```

`s`你的推文在哪里。

# javascript - 将 javascript 变量传递给 html。jQuery

> ID：13352813
> 
> 赞同：0
> 
> 时间：2012-11-12T22:43:21.667
> 
> 标签：javascript, jquery

我在 Javascript 中有一个变量：

```
var test ="whatever" 
```

我只想在隐藏的输入中传递这个变量：

```
<input type="hidden" class="myinput" value=""> 
```

我试过了：

```
$('.myinput').attr('test'); 
```

但这似乎不起作用。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T22:43:55.487

1.  使用[**`.val`**](http://api.jquery.com/val/)函数设置隐藏输入的值。
2.  删除引号以将其视为变量而不是字符串文字。

见下面的代码：

```
$('.myinput').val(test); 
```

# r - svd(x, nu = 0) 中的错误：0 范围维度

> ID：13352815
> 
> 赞同：8
> 
> 时间：2012-11-12T22:43:45.340
> 
> 标签：r

我正在尝试对具有 5000 列和 30 行的数据框进行 PCA

```
Sample <- read.table(file.choose(), header=F,sep="\t")
Sample.scaled <- data.frame(apply(Sample,2,scale))
pca.Sample <- prcomp(Sample.scaled,retx=TRUE)` 
```

得到错误

```
Error in svd(x, nu = 0) : infinite or missing values in 'x'

sum(is.na(Sample))
[1] 0

sum(is.na(Sample.scaled))
[1] 90 
```

尝试使用以下方法忽略所有 na 值

```
pca.Sample <- prcomp(na.omit(Sample.scaled),retx=TRUE) 
```

这给出了以下错误

```
Error in svd(x, nu = 0) : 0 extent dimensions 
```

有报道称 na.action 需要给出公式，因此尝试了以下方法

```
pca.Sample <- prcomp(~.,center=TRUE,scale=TRUE,Sample, na.action=na.omit) 
```

现在收到以下错误

```
Error in prcomp.default(x, ...) :
  cannot rescale a constant/zero column to unit variance 
```

认为问题可能是因为“我的一个数据列是常数。常数的方差为 0，然后缩放将除以 0，这是不可能的。”

但不确定如何解决这个问题。非常感谢任何帮助....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T00:35:02.430

从作为, when was`sum(is.na(Sample.scaled))`出来的事实来看，看起来你有三个常量列。`90``sum(is.na(Sample))``0`

这是一个随机生成（可重现）的示例，它给出了相同的错误消息：

```
Sample <- matrix(rnorm(30 * 5000), 30)
Sample[, c(128, 256, 512)] <- 1

Sample <- data.frame(Sample)
Sample.scaled <- data.frame(apply(Sample, 2, scale))

> sum(is.na(Sample))
[1] 0

> sum(is.na(Sample.scaled))
[1] 90

# constant columns are "scaled" to NA.
> pca.Sample <- prcomp(Sample.scaled,retx=TRUE)
Error in svd(x, nu = 0) : infinite or missing values in 'x'

# 3 entire columns are entirely NA, so na.omit omits every row
> pca.Sample <- prcomp(na.omit(Sample.scaled),retx=TRUE)
Error in svd(x, nu = 0) : 0 extent dimensions

# can't scale the 3 constant columns
> pca.Sample <- prcomp(~.,center=TRUE,scale=TRUE,Sample, na.action=na.omit)
Error in prcomp.default(x, ...) : 
  cannot rescale a constant/zero column to unit variance 
```

您可以尝试以下方法：

```
Sample.scaled.2 <- data.frame(t(na.omit(t(Sample.scaled))))
pca.Sample.2 <- prcomp(Sample.scaled.2, retx=TRUE) 
```

即`na.omit`在转置上使用以摆脱`NA`列而不是行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-10T19:31:44.083

负无穷大值可以在对数变换后替换，如下所示。

```
log_features <- log(data_matrix[,1:8])
log_features[is.infinite(log_features)] <- -99999 
```

# java - Java：使用方法实现多维数组时出现一些错误

> ID：13352816
> 
> 赞同：0
> 
> 时间：2012-11-12T22:43:47.430
> 
> 标签：java, for-loop, multidimensional-array

我尝试用方法制作一个多维数组。但我卡在这里；我的打印方法无法正常工作。它什么也没有显示，也没有错误。

```
public void bas() { // ========> print method
for (int a = 0; a < dizi.length; a++) {
    for (int b = 0; b < dizi[a].length; b++) {
        System.out.println(" dizi[" + n + "][" + m + "] = "
        + dizi[n][m]);
    }}} 
```

* * *

它修复了。

```
public int[][] doldur() { // ========> fill method
for (int i = 0; i < dizi.length; i++) {
    for (int j = 0; j < dizi.length[i]; j++) { //problem in here: The type of the expression must be an array type but it resolved to int

    }
}
return dizi; 
```

}

dizi.length[i] => dizi[i].length

* * *

我的其余代码：

```
public class ikiBoyutluDizi {
int n, m;
int[][] dizi = new int[n][m];

public int[][] diziBoyutu(int a, int b) {
    return dizi;
}

public int[][] doldur() { // ========> fill method
    for (int i = 0; i < dizi.length; i++) {
        for (int j = 0; j < dizi.length[i]; j++) {

        }
    }
    return dizi;
}

public void bas() { // ========> print method
    for (int a = 0; a < dizi.length; a++) {

        for (int b = 0; b < dizi[a].length; b++) {

            System.out.println(" dizi[" + n + "][" + m + "] = "

            + dizi[n][m]);

        }
    }
}

public static void main(String[] args) {
    ikiBoyutluDizi dizi2x = new ikiBoyutluDizi();
    dizi2x.diziBoyutu(2, 3);
    dizi2x.doldur();
    dizi2x.bas();
} 
```

}

还有一件事; 你能检查我的打印方法吗？您认为修复填充方法后它是否正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:45:06.220

在有问题的行中 - 您应该使用`dizi[i].length`而不是`dizi.length[i]`.

原因 is`dizi`是类型`int[][]`，因此`dizi[i]`是类型`int[]`- 这是一个数组，但是`dizi.length`是一个`int`，并且您实际上试图访问 int 中的元素 - 这是不可能的！

您可能还想`dizi[i] != null`在这样做之前确保

```
public int[][] doldur() { // ========> fill method
for (int i = 0; i < dizi.length; i++) {
    for (int j = 0; dizi[i] != null && j < dizi[i].length; j++) { 
      //               ^                         ^
      //           not null                   dizi[i].length 
      //                                         instead of
      //                                      dizi.length[i]
      // Do domething

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:45:37.320

```
for (int j = 0; j < dizi[i].length; j++) 
```

dizi[i] 将在**i**索引处获取数组。和长度属性将得到它的长度。

# oracle - 使用 eclipselink 时避免 CHAR-trimming

> ID：13352818
> 
> 赞同：1
> 
> 时间：2012-11-12T22:43:50.807
> 
> 标签：oracle, jpa, char, eclipselink, trim

我有一些 Oracle 表，其中一些 PK 字段定义为 CHAR(9)，并且所有值都使用填充存储。

因此，我必须在关键字段中检索所有带有空格填充的对象。但是，当 EclipseLink 将数据读入对象时，空格会被剪掉。由于这发生在 ID 值上，因此我无法使用 @PostLoad 来“修复”密钥，使其包含空格。

我无法删除/更新对象，因为键值已更改为修剪后的值，并且键值上的任何更新/删除都会丢失。

如何配置我的持久性单元，使其不会修剪 CHAR-columns 的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:19:44.313

您可以使用 SessionCustomizer 来配置它，

```
public MyCustomizer implements SessionCustomizer {
  public customize(Session session) {
    session.getLogin().setShouldTrimStrings(false);
  }
} 
```

但总的来说，使用 CHAR 而不是 VARCHAR 通常是一个非常糟糕的主意。

# java - 为什么 groovy 大多被称为动态语言？

> ID：13352820
> 
> 赞同：-1
> 
> 时间：2012-11-12T22:44:04.457
> 
> 标签：java, groovy, dynamic-languages

在查看 Paul King 的 Groovy 幻灯片分享时，我发现 groovy 主要被称为动态。我一直认为 groovy 是鸭式的动态语言。难道groovy的某些部分没有那么动态？

[http://www.slideshare.net/paulk_asert/groovy-tutorial](http://www.slideshare.net/paulk_asert/groovy-tutorial)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:55:00.747

由于 2.0 中引入了静态类型检查，它被称为主要是动态语言。

请参阅：[Groovy 2.0 中有哪些新功能？](http://www.infoq.com/articles/new-groovy-20)

# extjs - ExtJS 3.* 折线图轴标签旋转

> ID：13352821
> 
> 赞同：0
> 
> 时间：2012-11-12T22:44:07.843
> 
> 标签：extjs, linechart

如何旋转 ExtJS 折线图 x 轴标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T20:17:56.210

```
extraStyle: {
     xAxis: {
         labelRotation: 45         //-90 through 90 
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T05:55:25.453

标签有一个显示属性，它指定每个饼图的标签的存在和位置。“rotate”、“middle”、“insideStart”、“insideEnd”、“outside”、“over”、“under”或“none”以防止标签呈现。默认值：“无”。

参考链接：[Sencha Docs](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.chart.series.Line)

# c# - 如何在 C# 中使用 if 条件检查空值

> ID：13352822
> 
> 赞同：0
> 
> 时间：2012-11-12T22:44:12.240
> 
> 标签：c#, asp.net

我的 IF 语句中有多个条件，但只有第二个条件有效，换句话说，未检测到空值。我知道这些字段是空白或空的，但它没有检测到它。仅当保留第二个条件并删除第一个条件时才会触发电子邮件，但我想在发送电子邮件之前检查这两个条件。谢谢这是我的代码

```
string k = gr.Cells[9].Text;
DateTime strExpectedSubDate = DateTime.Parse(gr.Cells[3].Text);
DateTime strDate = DateTime.Now.Date;

if (k == null && strExpectedSubDate < strDate)
{
    send email(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T22:46:13.250

试试`if (string.IsNullOrEmpty(k) && strExpectedSubDate < strDate)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T22:46:35.247

您可能希望更改为：

```
if (string.IsNullOrWhiteSpace(k) && strExpectedSubDate < strDate) 
```

或者：

```
if (string.IsNullOrEmpty(k) && strExpectedSubDate < strDate) 
```

这等于：

```
if ((k == null || k == string.Empty) && strExpectedSubDate < strDate) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T01:45:57.643

我想这就是我解决问题的方法

```
if (K == ("&nbsp;") && strExpectedSubDate < strDate)
and it worked fine.  thanks 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T22:47:26.423

尝试

```
if (String.IsNullOrEmpty(k) && strExpectedSubDate < strDate)
{
 // send email

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-12T22:47:32.083

您所拥有的可以检查 k 是否为空。如果您还想检查它是否为空，请尝试：

```
if (string.IsNullOrEmpty(k) && strExpectedSubDate < strDate)
{
    SendEmail();
} 
```

# c# - 使用带有 SqlBulkCopy 的实体框架运行插入/更新时数据库表无响应

> ID：13352823
> 
> 赞同：0
> 
> 时间：2012-11-12T22:44:13.687
> 
> 标签：c#, asp.net, sql-server, wcf, entity-framework

我在带有 SQL Server 2012 的 .NET 4.5 上使用 Entity Framework 5。我有一个函数可以从第三方源下载大量数据并将其解析到我的数据库中。它以 2,500 条记录为单位下载、解析到我的实体并插入/更新到我的数据库。

对于我的数据库的插入/更新，我正在使用 SqlBulkCopy 类。当它对我的数据库进行插入/更新时，它正在插入/更新到的表似乎部分没有响应。如果我从 SSMS 运行一个简单的选择查询，它将提取一些记录，然后挂起，直到应用程序完成批量插入/更新。我的数据库中的这些数据通过 WCF 服务馈送到多个源，如果我尝试在其中一个源加载数据，由于数据库没有响应数据，它会超时。插入/更新完成后，WCF 服务和 SSMS 查询都将继续正常运行。

我认为这可能是由于 SqlBulkCopy 造成的，所以我删除了该类的使用，只调用了一个 context.SaveChanges() ，它产生了完全相同的结果。然后，我进行了一项测试，将 EF 完全排除在外，并使用经典的 ADO.NET（没有 SqlBulkCopy），一切正常。我重新插入了 SqlBulkCopy，将 EF 排除在外，然后表似乎被锁定，直到它完成。

所以我假设这里的罪魁祸首是 EF 和 SqlBulkCopy。关于如何解决这个问题并仍然使用 EF 和 SqlBulkCopy 的任何想法？或者是什么可能导致这种情况发生？

我认为这里不需要我的代码示例，但是如果您想查看，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:00:45.020

我想这是因为交易。当您使用 SqlBukCopy 或 context.SaveChanges() 时，插入发生在事务中。当您用经典的 ADO.NET 替换该代码时，您是将插入包装在事务中还是让每个插入发生在它自己的隐式事务中？

当事务处于挂起状态时，它会锁定正在更新的表的部分。如果它插入足够多的数据，它可能会锁定表或整个表中的很多页（这称为[锁升级](http://msdn.microsoft.com/en-us/library/ms184286%28v=sql.105%29.aspx)）。

解决此问题的最佳方法是将更新拆分为更小的块。还有一些其他选项（例如读取未提交的数据等），但这些选项有很大的缺点，通常应该避免。

# xcode - 来自 URLS 而不是本地文件的 Xcode 动画

> ID：13352827
> 
> 赞同：0
> 
> 时间：2012-11-12T22:44:42.937
> 
> 标签：xcode, image, url, animation, imageview

我正在尝试从一些 URLS 制作动画。

我知道代码

```
animation.animationImages = [NSArray arrayWithObjects:
                             [UIImage imageNamed:@"img-1.gif"],
                             [UIImage imageNamed:@"img-2.gif"],
                             [UIImage imageNamed:@"img-3.gif"],
                             [UIImage imageNamed:@"img-4.gif"],nil];
[animation setAnimationRepeatCount:3];
animation.animationDuration = 2;
[animation startAnimating]; 
```

但是如何从服务器加载多张图片并使它们具有动画效果？我有一个名为动画的图像视图有人可以帮我举个例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T16:19:29.237

这是我用来做我的

我用我的`viewDidLoad`方法做了我的

```
//use your URL
NSData *picOne = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://sumptin.com/images/sumptin.jpg"]];
NSData *picTwo = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://sumptin.com/images/sumptin.jpg"]];
NSData *picThree = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://sumptin.com/images/sumptin.jpg"]];
NSData *picFour = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://sumptin.com/images/sumptin.jpg"]];
NSData *picFive = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://sumptin.com/images/sumptin.jpg"]];

//then convert data to actual pictures  
UIImage *onePic = [UIImage imageWithData:picOne];
UIImage *twoPic = [UIImage imageWithData:picTwo];
UIImage *threePic = [UIImage imageWithData:picThree];
UIImage *fourPic = [UIImage imageWithData:picFour];
UIImage *fivePic = [UIImage imageWithData:picFive];

//then SHABAM!
 slideShow.animationImages = [NSArray arrayWithObjects:
                             onePic,
                             twoPic,
                             threePic,
                             fourPic,
                             fivePic,
                             nil];
slideShow.animationDuration = 60.00f;
slideShow.animationRepeatCount = 0;

[slideShow startAnimating]; 
```

希望这会有所帮助...看到这个问题是在一年前发布的:)

# php - PHP simplexml 子级转换为小写

> ID：13352832
> 
> 赞同：0
> 
> 时间：2012-11-12T22:45:07.810
> 
> 标签：php, simplexml, lowercase

我有这个作为XML：

```
...
<product>
<id>1</id>
<defaultImage>test.jpg</defaultImage>
</product>
... 
```

我有这个作为php：

```
$testcase = 'defaultimage';
$xml = simplexml_load_file('./temp/'.$i.'.xml');
foreach ($xml->children() as $child) {
    $child->$testcase;
} 
```

现在的问题是，我被迫以`$testcase`小写形式（defaultimage）但在XML文件中孩子的名字是：（`defaultImage`注意大写的I）

问题：如何将所有孩子都处理为小写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:11:03.457

您可以使用该`->getName()`方法在遍历内部`->children()`数组时找出节点的名称。

为清楚起见，我`product`在外循环的所有节点上使用了更明确的循环

```
$testcase = 'defaultimage';
$xml = simplexml_load_file('./temp/'.$i.'.xml');
foreach ( $xml->product as $product )
{
   foreach ( $product->children as $child )
   {
      if ( strtolower($child->getName()) == $testcase )
      {
         // Do whatever it is you need to do with the <defaultImage> node
      }
   }
} 
```

# sql - 在 SQL Server 中使用级联删除对 N 级树进行建模

> ID：13352834
> 
> 赞同：2
> 
> 时间：2012-11-12T22:45:12.583
> 
> 标签：sql, sql-server, foreign-key-relationship, cascading-deletes, self-referencing-table

我需要在 SQL Server 中建模一个 n 级树。我最初做了这样的事情来创建一个`Node`表：

```
[Id] [bigint] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[ParentId] [bigint] NULL 
```

这是一个自引用表，其中`ParentID`引用回另一个`Node`实体（根有一个`null` `ParentID`）。但是当我尝试向级联删除添加约束时，我得到了这个：

```
Introducing FOREIGN KEY constraint 'FK_dbo.Nodes_dbo.Nodes_ParentId' on table 'Nodes' may cause cycles or multiple cascade paths. Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, or modify other FOREIGN KEY constraints. 
```

根据我的阅读，这似乎是 SQL Server 中一个众所周知且合理的限制。有些人建议使用触发器来完成此操作，但如果可能的话，我更愿意避免这种情况。

所以我的问题是 - 如何在 SQL 中对 n 级层次结构或树进行建模以允许级联删除？

我正在使用 SQL Server 2012。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:50:58.110

我见过的更有效的技术之一是使集群主键成为节点的**可变长度完整树路径（** [Richard Henderson 的帽子提示](http://c2.com/cgi/wiki?TreeInSql)）；要删除子树，只需删除一系列值。

# haskell - 如何为几种类型的类型构造函数简化我的“产品”类型类？

> ID：13352839
> 
> 赞同：2
> 
> 时间：2012-11-12T22:45:45.477
> 
> 标签：haskell

请原谅我可能误用了下面的范畴论术语。如果我似乎有半点线索，我会判断自己非常成功。

我发现自己编写了一系列类来处理多种类型的构造函数的产品。像这样的东西：

```
import Control.Applicative

-- | RWS monad.
newtype RWS r w s a = RWS {runRWS :: r -> s -> (a, s, w)}

-- | A class for unary type constructors that support a Cartesian
-- product operation.
class ProductObject f where
    (***) :: f a -> f b -> f (a, b)
infixr ***

-- | Example instance of 'ProductObject'.
instance ProductObject [] where
    (***) = liftA2 (,)

-- | A class for binary type constructors (read as morphisms
-- between their type parameters) that support a product morphism
-- operation.
class ProductMorphism arrow where
    (****) :: arrow a b -> arrow c d -> arrow (a, c) (b, d)
infixr ****

-- | Example instance of 'ProductMorphism'.  
instance ProductMorphism (->) where
    f **** g = \(a, c) -> (f a, g c)

-- | A class for ternary type constructors (read as two-place
-- multiarrows @a, b -> c@) with products.
class ProductMultimorphism2 arr2 where
    (*****) :: arr2 a b c -> arr2 d e f -> arr2 (a, d) (b, e) (c, f)
infixr *****

-- | A class for ternary type constructors (read as two-place
-- multiarrows @a, b -> c@) with products.
class ProductMultimorphism3 arr3 where
    (******) :: arr3 a b c d -> arr3 e f g h -> arr3 (a, e) (b, f) (c, g) (d, h)
infixr ******

-- | Let's pretend that the 'RWS' monad was not a type synonym
-- for 'RWST'.  Then an example of 'ProductMorphism3' would be:
instance ProductMultimorphism3 RWS where
    f ****** g = RWS $ \(fr, gr) (fs, gs) ->
        let (fa, fs', fw) = runRWS f fr fs
            (ga, gs', gw) = runRWS g gr gs
        in ((fa, ga), (fs', gs'), (fw, gw)) 
```

现在，这很烦人，原因有几个。最大的问题是我必须修改我的应用程序中的一种类型以添加​​第三个参数，这意味着现在我必须找到`****`该类型的所有用途并将它们更改为`*****`.

我可以应用一些技巧来缓解这种情况吗？我试图了解`PolyKinds`GHC 中是否适用于此，但是（a）进展缓慢，（b）我听说`PolyKinds`GHC 7.4.x 中有错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T22:03:21.077

好吧，我自己想通了：

```
{-# LANGUAGE MultiParamTypeClasses, TypeFamilies #-}

import Control.Applicative

class Product f g where
    type Prod a b :: *
    (***) :: f -> g -> Prod f g

instance Product [a] [b] where
    type Prod [a] [b] = [(a, b)]
    (***) = liftA2 (,)

instance Product (a -> b) (c -> d) where
    type Prod (a -> b) (c -> d) = (a, c) -> (b, d)
    f *** g = \(a, c) -> (f a, g c) 
```

# javascript - 在多个文件中拆分 javascript

> ID：13352845
> 
> 赞同：0
> 
> 时间：2012-11-12T22:46:20.147
> 
> 标签：javascript, jquery, workflow

所以，我正在做一个需要 JS 基调的大项目，所以我不想把所有东西都写在一个文件中，因为它会让人感到困惑，而且随着时间的推移更难跟踪一切。

所以我的计划是拆分为多个文件和文件夹，例如。

```
js/home/register.js
js/home/login.js 
```

但我希望所有东西都编译在一个文件中，我想使用像 SASS 有 @import 的样式，或者将文件自动编译到一个文件中。

你推荐的最好的工具是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:48:27.940

为此，您可以使用多种工具中的任何一种，包括`cat`（在 *nix 系统上）或`copy`（在 Windows 系统上）。

[使用像Closure Compiler](https://developers.google.com/closure/compiler/)、[YUI Compressor](http://developer.yahoo.com/yui/compressor/)或[packer3](http://dean.edwards.name/packer/3/)这样的编译/压缩/压缩/打包工具可能是有意义[`jsmin`](http://www.crockford.com/javascript/jsmin.html)的。但是你使用哪一个真的取决于你，你的项目的需求等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:49:58.147

请看[这个 SO question](https://stackoverflow.com/q/5511989/1313143)。

> 在 linux 上，您可以使用简单的 shell 脚本[https://github.com/dfsq/compressJS.sh](https://github.com/dfsq/compressJS.sh)将多个 javascript 文件组合成一个文件。它利用 Closure Compiler 在线服务，因此生成的脚本也被有效压缩。

解决方案是在将 JS 文件上传到网络服务器之前，使用您喜欢的任何工具来组合它们。开发环境！= 生产环境。唯一可能的问题是您创建了具有相同名称的函数/变量，但是我再次认为有工具可以在将它们连接在一起时处理这些问题。

# php - 使用搜索功能动态删除 div 元素而无需重新加载页面

> ID：13352852
> 
> 赞同：0
> 
> 时间：2012-11-12T22:46:54.280
> 
> 标签：php, css, search, html

到目前为止，这就是我的代码所做的。这将有助于理解我的问题。

[研究页面](http://i.imgur.com/xanXD.png)

当您单击父 div（股票名称所在的整个栏）时，子 div 会降低（我是手风琴 1）。

我对 HMTL 和 CSS 还很陌生（两天前学过），并且已经成功实现了某人的 JavaScript 来创建动画效果。

我的问题是这个。有没有一种方法可以使用搜索功能动态删除 div？换句话说，我可以根据搜索字符串删除 div，而不重新加载页面吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:18:29.163

无需在 Javascript 中重新加载页面。

完全可以的。。

例如，如果您安装了 jQuery：

假设您有一个搜索字段（提交时）删除与其 NAME 属性中的搜索匹配的所有 div ：

```
HTML :
<input type="text" id="search" />
<input type="button" onclick="delete()" />

JS :
function delete() {
    search = jQuery('#search').val(); //retrieve the searched string
    jQuery('div[name="' + search + '"]').remove(); //search for DIV(s) with that NAME and removes it
} 
```

# php - AJAX 联系表单未发布时的错误消息

> ID：13352854
> 
> 赞同：0
> 
> 时间：2012-11-12T22:47:01.710
> 
> 标签：php, ajax, contact-form

我有几个使用相同的通用 AJAX 代码的联系表格：

```
$(document).ready(function() {
    $('#mainMail').submit( function() {
        $.ajax({
            type: "POST",

            url : "<?php echo home_url(); ?>/wp-content/themes/retlehs-roots-f45f4f5/assets/bin/process.php",
            data: $(this).serialize(),
            success: function() {
                    $('#enquiryBox #submitSuccess').removeClass('hidden');
                    setTimeout(function() { $("#enquiryBox #submitSuccess").addClass('hidden'); }, 15000);       
                },
            error: function() {
                $('#enquiryBox #submitFail').removeClass('hidden');
                setTimeout(function() { $("#enquiryBox #submitFail").addClass('hidden'); }, 15000);
            }
            });
        return false;
    });
}); 
```

简而言之，当它成功提交表单并向我发送电子邮件（通过 process.php）时，`#submitSuccess`div 会按应有的方式显示出来。问题是，当它失败时，div**也会**出现（`#submitFail`div 保持隐藏状态）。

我猜这是因为只有在没有成功调用 process.php 时才会发生 ajax 发布失败？有没有办法调整它，以便如果电子邮件不是通过 process.php 发送给我，用户会收到错误消息？

这是我的 process.php 代码：

```
<?php 

$robotest = $_POST['robotest']; //just testin' for robots

$recipient = "info@mydomain.com"; //recipient 
$email = ($_POST['email']); //senders e-mail adress 

if((filter_var($email, FILTER_VALIDATE_EMAIL)) && ($robotest == "")) { 

$Name = ($_POST['name']); //senders name 

$mail_body  = "Hello, \r\n \r\n";
$mail_body .= "You have received a new booking with the following details: \r\n\r\n";
$mail_body .= "{$_POST['comments']}; \r\n \r\n";
$mail_body .= "Please respond to the customer within 30 minutes on the following phone number: {$_POST['phone']} \r\n";
$mail_body .= "Warm regards, \r\n";
$mail_body .= "Robot. \r\n";

$subject = "Free Consult Inquiry"; //subject 
$header = "From: ". $Name . " <" . $email . ">\r\n"; //optional headerfields 

mail($recipient, $subject, $mail_body, $header); //mail command :) 

} else {
  print "You've entered an invalid email address!";
 }
?> 
```

（这`print "you've entered an invalid email address!"`是我对错误消息的尝试，但这也不起作用......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:53:46.337

将此行也添加`$("#enquiryBox #submitSuccess").addClass('hidden');`到错误块中，

```
 $.ajax({
        type: "POST",

        url : "<?php echo home_url(); ?>/wp-content/themes/retlehs-roots-f45f4f5/assets/bin/process.php",
        data: $(this).serialize(),
        success: function() {
                $('#enquiryBox #submitSuccess').removeClass('hidden');
                setTimeout(function() { $("#enquiryBox #submitSuccess").addClass('hidden'); }, 15000);       
            },
        error: function() {
            $('#enquiryBox #submitFail').removeClass('hidden'); //why do you remove class 'hidden' and add it later too ??
            $("#enquiryBox #submitSuccess").addClass('hidden'); //added line here
            setTimeout(function() { $("#enquiryBox #submitFail").addClass('hidden'); }, 15000);
        }
        }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T23:23:56.267

您可以通过返回 HTTP 错误代码来指示错误，例如

```
} else {
  header("HTTP/1.1 500 Internal error");
  print "You've entered an invalid email address!";
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:56:34.473

如果您阅读 上的[手册条目`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/#callback-functions)，您会发现错误事件发生在发生协议或网络错误时。如果您的脚本 return或类似的东西`false`，`null`它仍然被认为是有效的响应，因此您的问题。

在这种情况下，我会编写它，以便所有调用最终都调用一个方法，如果调用错误事件，它将调用相同的方法并显示重建的错误消息。

# node.js - Node.js + mocha + webdriverjs：失败的测试杀死套件

> ID：13352860
> 
> 赞同：12
> 
> 时间：2012-11-12T22:47:21.343
> 
> 标签：node.js, webdriver, mocha.js

我正在使用 Mocha 和[WebDriverJS](https://github.com/Camme/webdriverjs)测试一个 Web 应用程序，或多或少如此[处](http://unexpectedliteral.com/2012/05/09/automated-functional-testing-with-javascript-using-mocha-and-selenium-part-2/)所述。当测试通过时，一切都很好。但是，如果一个测试失败，套件中的其余测试将超时，并且运行器将在套件结束时退出，而不关闭 Webdriver 实例。示例测试用例：

```
var assert = require('assert'),
    client = require("webdriverjs").remote({
        logLevel: 'silent'
    });

describe('Self-test', function() {

    before(function(done) {
        client
            .init()
            .url('http://www.wikipedia.org/', function() {
                done();
            });
    });

    after(function(done) {
        client.end(function() {
            done();
        });
    });

    // tests

    it('should fail properly', function(done) {
        client.getTitle(function(result) {
            assert(false, 'This should fail');
            done();
        });
    });

    it('should pass afterwards', function(done) {
        client.getTitle(function(result) {
            assert(true, 'This should still pass');
            done();
        });
    });

}); 
```

输出：

```
~> mocha  test/self-test.js

    Self-test
  1) should fail properly
  2) should pass afterwards
  3) "after all" hook

✖ 3 of 2 tests failed:

1) Self-test should fail properly:
   AssertionError: This should fail
    at null.<anonymous> (./test/self-test.js:24:17)
    at QueueItem (./node_modules/webdriverjs/lib/webdriverjs.js:242:15)
    at null.<anonymous> (./node_modules/webdriverjs/lib/commands/getTitle.js:12:6)
    at QueueItem (./node_modules/webdriverjs/lib/webdriverjs.js:242:15)
    at IncomingMessage.WebdriverJs.proxyResponse (./node_modules/webdriverjs/lib/webdriverjs.js:782:6)
    at IncomingMessage.EventEmitter.emit (events.js:115:20)
    at IncomingMessage._emitEnd (http.js:366:10)
    at HTTPParser.parserOnMessageComplete [as onMessageComplete] (http.js:149:23)
    at Socket.socketOnData [as ondata] (http.js:1366:20)
    at TCP.onread (net.js:402:27)

2) Self-test should pass afterwards:
   Error: timeout of 10000ms exceeded
    at Object.<anonymous> (./node_modules/mocha/lib/runnable.js:158:14)
    at Timer.list.ontimeout (timers.js:101:19)

3) Self-test "after all" hook:
   Error: timeout of 10000ms exceeded
    at Object.<anonymous> (./node_modules/mocha/lib/runnable.js:158:14)
    at Timer.list.ontimeout (timers.js:101:19) 
```

据我所知，这是因为 WebDriverJS 队列在测试失败时会停止。**有没有什么办法解决这一问题？**即使对于本地命令行测试，它也不是最理想的，并且它使自动运行测试和/或在后台运行测试变得难以实现。

**更新：**我认为我可以通过为每个测试实例化一个新客户端来修复队列故障，但这会使事情变得更慢（因为 WebDriver 实例每次都需要从头开始启动）并且会使 WebDriver 进程在未杀死的情况下挂起测试失败。理想情况下，我想要类似[Soda](https://github.com/LearnBoost/soda)提供的结构，其中队列中某处的失败会跳到队列的末尾，然后抛出错误以供测试框架捕获。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T08:04:19.817

编写 webdriverjs 的方式每个测试应该是一个单独的会话，因此以 init() 开始并以 end() 结束。测试中的异常将冒泡到 mocha 并弄乱 webdriverjs 队列。因此，您正在尝试以不受支持的方式使用我们的 webdriverjs。

查看 soda 的源代码似乎也是如此。在[client.js:223](https://github.com/LearnBoost/soda/blob/master/lib/soda/client.js#L223)中处理异常并将错误传递回回调。此回调是使用[.end()](https://github.com/LearnBoost/soda/blob/master/lib/soda/client.js#L197)设置的函数，因此没有为每个测试设置 .end() 将简单地跳过同一会话的所有后续测试，直到调用最后一个测试的 .end() 回调。

这就是您所说的“队列中某处的故障跳到队列末尾”的意思吗？如果这是您想要的行为，则必须将[webdriver.js:244](https://github.com/Camme/webdriverjs/blob/master/node_modules/webdriverjs/lib/webdriverjs.js#L244)包含在 try catch 中，当捕获到异常时，调用[.end()](https://github.com/Camme/webdriverjs/blob/master/node_modules/webdriverjs/lib/commands/end.js)命令。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T18:16:03.627

如果每个测试都依赖于 WebDriverJS 队列的状态，您应该使用`beforeEach()`and`afterEach()`而不是设置`before()`和拆除。`after()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-16T13:57:17.357

Selenium 有自己的官方 webdriverjs 绑定，现在可以在节点上运行

[http://code.google.com/p/selenium/wiki/WebDriverJs](http://code.google.com/p/selenium/wiki/WebDriverJs)

在 npm [https://npmjs.org/package/selenium-webdriver](https://npmjs.org/package/selenium-webdriver)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-26T00:45:14.760

您需要一个侦听器来捕获未捕获的异常

```
webdriver.promise.controlFlow().on('uncaughtException', function(e) {
     console.error('Unhandled error: ' + e);
     driver.quit();
}); 
```

这就是我正在做的。唯一的问题是它也会捕获断言错误。希望这可以帮助。

# html - 设置超时顺序

> ID：13352861
> 
> 赞同：3
> 
> 时间：2012-11-12T22:47:24.300
> 
> 标签：html, css, settimeout

我想我遇到了麻烦`setTimeout()`。

您可以访问我的网页以查看我的位置：[http://verbum.xtrweb/soon.php](http://verbum.xtrweb/soon.php)

问题是我有 2 个文本字段。

1.  “动词”与`id="Verbum"`
2.  “忘记单一搜索”与`id="forget"`

我想在小字典掉落后应用淡入效果（请参阅上面的我的网站链接，以便您理解）。我也更改了函数的名称和变量，但唯一发生的事情是只有一个文本淡入，这取决于一个在另一个之下的顺序。不淡入的那个甚至都没有出现。希望你能理解并找到答案。谢谢。

```
<script type="text/javascript">
  var opac = 0.0;
  var alpha = 0;

  function init() {
    var elem = document.getElementById("Verbum");
    elem.style.display = 'inline';
    elem.style.filter = "alpha(opacity = " + alpha + ")";
    elem.style.opacity = opac;

    setTimeout("fadein()", 8500);
  }

  function fadein() {
    var elem = document.getElementById("Verbum");

    opac = opac + 0.1;
    alpha = parseInt(opac * 100);
    elem.style.opacity = opac;
    elem.style.filter = "alpha(opacity = " + alpha + ")";

    if (opac < 1.0) {
      //Change the 50 to adjust the speed. The higher the number, the slower the fade
      setTimeout("fadein()", 30);
    }

  }
  window.onload=init;
</script> 
```

这是第二个`<script>`块：

```
<script type="text/javascript">
  var opac = 0.0;
  var alpha = 0;

  function init() {
    var eleme = document.getElementById("forget");
    eleme.style.display = 'inline';
    eleme.style.filter = "alpha(opacity = " + alpha + ")";
    eleme.style.opacity = opac;

    setTimeout("fadein()", 7500);
  }

  function fadein() {
    var eleme = document.getElementById("forget");

    opac = opac + 0.1;
    alpha = parseInt(opac * 100);
    eleme.style.opacity = opac;
    eleme.style.filter = "alpha(opacity = " + alpha + ")";

    if (opac < 1.0) {
      // Change the 50 to adjust the speed. The higher the number, the slower the fade
      setTimeout("fadein()", 30);
    }

  }

  window.onload = init;
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:48:45.797

问题是您一次只能分配一个功能`window.onload`。最后一个总是优先于第一个。

代替 using `window.onload`，您可以使用`window.addEventListener`告诉浏览器在页面加载时运行您的代码。你可以像这样使用它。

```
window.addEventListener('load', function(){
    var eleme = document.getElementById("forget");
    eleme.style.display = 'inline';
    eleme.style.filter = "alpha(opacity = " + alpha + ")";
    eleme.style.opacity = opac;

    setTimeout("fadein()", 7500);
}, false); 
```

您需要复制并粘贴两次，一次用于“忘记”，一次用于“Verbum”。

另外，我建议更改`fadein`函数的名称，或者将要淡出的元素作为参数传递。否则，您的代码将简单地运行最后一个淡入淡出函数，并且“忘记”或“Verbum”将正常工作，而另一个则不会。

# vba - Excel VBA 函数仅在更改时更新

> ID：13352865
> 
> 赞同：4
> 
> 时间：2012-11-12T22:47:32.427
> 
> 标签：vba, excel, excel-formula, excel-2010

我有一个作为 VBA 模块实现的函数，它将一个单元格作为参数并查询 Web 服务以返回结果。由于数据的来源是远程的，这个函数可能需要几秒钟才能返回。

问题是某些操作，例如删除任何列，似乎会导致每个公式重新计算，即使不需要更改。当我的工作表有数百行时，这可能需要几分钟，在此期间 Excel 没有响应。

我想找到一些方法来检测不需要更改并跳过此步骤。我尝试过的一些事情：

*   确定要更改的单元格的当前值，我可以从中确定是否需要更新。但是 ActiveCell.Value 是空白的，并且尝试将单元格本身作为第二个参数传递会遇到循环引用警告。
*   创建第二列来保存旧输入值，然后将其传递给函数并与新值进行比较。但是，函数无法在成功时更新此旧值，并且尝试仅使用公式进行更新总是会遇到循环引用警告。此外，函数似乎不能返回“无变化”，所以我需要存储和使用旧结果。

有什么方法可以防止某些操作更新工作表上的每个公式？

其他需求：

*   可能有一种方法可以禁用所有公式自动计算，但我绝对希望在输入参数单元格后立即更新每一行。我也不想强迫用户按下按钮来更新功能。
*   我尝试在 Visual Studio 中制作自定义电子表格，但发现部署对于我的用户群来说难以维护。解决方案必须完全包含在启用宏的工作簿中。
*   使用工作表的 Excel 版本将是 2007 和 2010。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:00:45.527

我会

1.  通过将文件/选项/公式/工作簿计算设置为“手动”并关闭“保存时重新计算”来系统地阻止重新计算

2.  创建一个`Private Sub Worksheet_Change(ByVal Target As Range)`并确定在什么条件下应该进行重新计算（`Target.Worksheet.Calculate`） - 例如确定目标的坐标（使用`Target.Column`and `Target.Row`），并从 Worksheet_Change 触发器内部调用查询。

3.  最终，我会将重新计算指令放在它自己的 Sub 中，并在工作表中制作一个按钮，以便用户可以 - 根据他/她的意愿 - 手动触发重新计算（以防用户不知道 F9 键）

4.  也可以考虑使用`need_Query`由 Worksheet_Change 触发器`If Target.Row = X And Target.Column = Y`（= 参数）设置的全局布尔变量，并让查询函数检查（并重置）该布尔变量，然后仅进入查询`If need_Query Then`，否则不执行任何操作退出。确保在工作表加载时也将 need_Query 设置为 FALSE。

5.  最后，您可以将查询函数转换为 a`Sub`并在 Worksheet_Change 触发器中制定一些更复杂的条件来触发它（例如，如果某个列发生更改等）。

# replication - 格里特复制

> ID：13352867
> 
> 赞同：1
> 
> 时间：2012-11-12T22:47:41.117
> 
> 标签：replication, gerrit

是什么触发了gerrit中的复制？我推送更改以供审核、审核并点击“提交并发布”，但没有进行复制？我什至将复制延迟设置为 0。如果我重新加载复制插件，那么复制就会发生，或者如果我重新启动 gerrit。所以不确定是什么应该触发它。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T08:07:04.220

像这样手动触发复制： ssh -p 29419 user@localhost replication start --all

# java - 我将如何从 B 类执行 A 类的运行方法

> ID：13352868
> 
> 赞同：0
> 
> 时间：2012-11-12T22:47:39.643
> 
> 标签：java, class, swt

```
public class AplotPdfPrintLocal extends ApplicationWindow {
private String userSelectedFile;

public AplotPdfPrintLocal(String pdfFilePath) {
   super(null);
   this.userSelectedFile = pdfFilePath;
}

public void run() {
   setBlockOnOpen(true);
   open();
   Display.getCurrent().dispose();
}

etc........ 
```

我想从 B 类执行上述类

方法是 B 类 - 下面

```
public void startPDFPrint() throws Exception {
      AplotPdfPrintLocal pdfPrint = new AplotPdfPrintLocal(getPDFFileName()).run();
} 
```

我收到一个错误，我需要将 run 的返回类型从 void 更改为 plotPdfPrintLocal

我是不是要叫错班级？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:50:26.363

将其更改为：

```
public void startPDFPrint() throws Exception {
      AplotPdfPrintLocal pdfPrint = new AplotPdfPrintLocal(getPDFFileName());
      pdfPrint.run();
} 
```

或者

```
public void startPDFPrint() throws Exception {
      new AplotPdfPrintLocal(getPDFFileName()).run();
} 
```

编译器的意思是您试图将运行方法（**void**）的结果分配给表达式的左成员，即**AplotPdfPrintLocal pdfPrint**变量。

因此，由于**run**是“返回” **void**，因此存在错误，预期**AplotPdfPrintLocal**类型（在左侧声明）与实际返回类型：**void**之间存在差异。

# c# - WPF listview 不随 ItemSource 改变

> ID：13352869
> 
> 赞同：1
> 
> 时间：2012-11-12T22:47:43.143
> 
> 标签：c#, .net, wpf

我正在尝试在 WPF 中创建一个简单的 2 列列表视图，但我遇到了障碍。

我有 Xaml：

```
<ListView x:Name="asas" Height="220" Margin="10,90,10,0" VerticalAlignment="Top" ItemsSource="{Binding Path=missionCollection}">
    <ListView.View>
        <GridView>
            <GridViewColumn Width="140" Header="Name" DisplayMemberBinding="{Binding Path=name}"/>
            <GridViewColumn Width="140" Header="Folder" DisplayMemberBinding="{Binding Path=id}"/>
        </GridView>
    </ListView.View>
</ListView> 
```

和 C# 代码：

```
public readonly ICollection<Mission> missionCollection = new ObservableCollection<Mission>();
foreach (var campaign in campaigns)
{
    if(campaign.id != "c1")
        continue;
    foreach(Mission mission in campaign.missionList)
        missionCollection.Add(mission);
} 
```

此 C# 代码位于同一窗口中。

我的问题是，当我向绑定添加内容时，列表视图似乎确定不更新。

我已经阅读了很多关于此的其他问题，但我找到的解决方案似乎都没有帮助我。

我在关注这个页面：[http ://www.switchonthecode.com/tutorials/wpf-tutorial-using-the-listview-part-1](http://www.switchonthecode.com/tutorials/wpf-tutorial-using-the-listview-part-1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:03:03.320

我找到了答案。

出于沮丧，我试图完全复制我链接到的页面所做的事情。

我需要添加

```
DataContext="{Binding RelativeSource={RelativeSource Self}}" 
```

到窗口 Xaml 元素

但这还不够，您尝试从 a 访问的所有元素都`DisplayMemberBinding`必须有一个`{ get; set; }`（即使它是空的）在将其添加到`Mission`类的所有属性并添加之后

```
private ObservableCollection<Mission> _missionCollection = new ObservableCollection<Mission>();
public ObservableCollection<Mission> MissionList
    {
        get { return _missionCollection; }
    } 
```

到窗口代码，一切正常

# drag - 无法拖动道场浮 动窗格

> ID：13352872
> 
> 赞同：0
> 
> 时间：2012-11-12T22:48:00.367
> 
> 标签：drag, dojo

我有两个 dojo 按钮，单击它们可以创建浮动窗格。现在“搜索”按钮创建了一个不会移动的浮动窗格，但“映射数据”按钮的浮动窗格工作正常。直到我不拖动“映射数据”创建的浮动窗格之前，我都无法拖动“搜索”创建的浮动窗格。

这是我的[应用程序](http://msgist2011.grd.arizona.edu/project/tp_dock.html)。

知道问题是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T11:19:22.497

这是问题`z-index`，*搜索*位于您的地图下方（因为没有`z-index`指定）。当您打开并拖动*“映射数据”*时，它`z-index:104`也会设置为“*搜索*”，使其可移动。

![在此处输入图像描述](../Images/6f4e45226820ef7adee0782d5fe47c9c.png)

# objective-c - 为 MKMapKitView 动画设置自定义持续时间

> ID：13352875
> 
> 赞同：2
> 
> 时间：2012-11-12T22:48:18.733
> 
> 标签：objective-c, ios, animation, mkmapview

我想从左到右慢慢平移 MKMapkitView 世界地图。在大多数 MapKit 地图移动功能中，您可以设置一个布尔值来打开或关闭动画，但据我所知，您无法设置持续时间。例如

```
[worldmap setCenterCoordinate:av.annotation.coordinate animated:YES]; 
```

如何减慢速度并为这种地图移动动画设置自定义持续时间？

# c++ - 无法在 Microsoft VC++ Inline ASM 中选择位

> ID：13352881
> 
> 赞同：1
> 
> 时间：2012-11-12T22:48:53.370
> 
> 标签：c++, visual-c++, inline-assembly

很简单，真的。我尝试`EAX[31:26]`在我的代码中使用，并出现以下错误：

`error C2400: inline assembler syntax error in 'second operand'; found ':'`

这是我的代码：

```
unsigned _EAX, _EBX, _ECX, _EDX ;
//LoadCPUID(EAX_CACHECONFIG, _EAX, _EBX, _ECX, _EDX);

__asm {
    mov EAX, EAX_CACHECONFIG ;
    mov ECX, 0x00000001 ;
    cpuid ;
    mov _EAX, EAX[31:26] ;
}

return _EAX; 
```

是否可以在 MSVC 的内联汇编器中以上面显示的方式选择位？我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:12:59.240

假设您使用的是基于 0 的位数，其中 0 是最低有效位，您只需右移`eax`26 位即可获得前六位。

这为您提供了低位位置的高六位。如果您希望结果位于*相同*的位位置，只需`and`使用`0xfc000000`.

如果我误解了您的位位置，您仍然可以使用移位和按位运算符来获得您想要的东西，尽管值（您想要`and`使用或移位的值）可能会有所不同。

根据您的评论：

> 执行 CPUID 指令后，(EAX[31:26] + 1) 包含内核数。

获取核心数的方法如下：

```
...                  ; load up cpuid registers first
cpuid
shr    eax, 26       ; move bits 31:26 down to 5:0
inc    eax
...                  ; eax now contains the core count (1 thru 64). 
```

# ruby - 尝试从多种类型的项目中生成所有可能性的段错误

> ID：13352882
> 
> 赞同：0
> 
> 时间：2012-11-12T22:48:54.540
> 
> 标签：ruby, arrays, hash, segmentation-fault, permutation

所以我让这种方法在数据集很小的情况下也能正常工作。然而，当它变得更大一点时......

此脚本的目的是找到每个可能的集合组合，而不会重复。这样我就可以将它们存储在数据库表中。

```
set 1: [701,744,410,646,723,434]
set 2: [701,744,410,646,723,435]
set 3: etc.. 
```

我还应该注意，我需要保持与原始键的关系。因此 type1 中的项目不能移动到任何其他类型。希望这是有道理的。

```
Collecting pieces...
  pieces[type1] = [701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722]
  pieces[type2] = [744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765]
  pieces[type3] = [410, 412, 413, 414, 415, 419, 422, 424, 426, 427, 429, 372, 374, 376, 378, 380, 382, 385, 395, 397, 399, 401]
  pieces[type4] = [646, 647, 649, 651, 653, 655, 657, 671, 672, 673, 674, 679, 681, 684, 686, 688, 691, 695, 697, 698, 699, 700]
  pieces[type5] = [723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743]
  pieces[type6] = [434, 435, 438, 440, 443, 446, 447, 462, 464, 467, 469, 484, 485, 486, 487, 488, 489, 490, 491, 492, 494, 496]
Took 0.4265 seconds to collect.

Generating possibilities...
/Projects/my_project/lib/tasks/possibilities.rake:109: [BUG] Segmentation fault
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0] 
```

是的，段错误。

这是我用来实现它的代码。

```
def permutations!(input)
  permutations_start = Time.now
  puts "Generating possibilities..."
  input.each do |key, possibilities|
    possibilities.map!{|p| {key => p} }
  end

  digits = input.keys.map!{|key| input[key] }

  # This is the line that seems to want to cry.
  result = digits.shift.product(*digits)

  puts "# of generated possibilities: #{result.length}"
  puts "Took #{(Time.now - permutations_start).round(4)} seconds to generate.\n\n"

  return result
end

pieces = {}
pieces['type1'] = [701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722]
pieces['type2'] = [744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765]
pieces['type3'] = [410, 412, 413, 414, 415, 419, 422, 424, 426, 427, 429, 372, 374, 376, 378, 380, 382, 385, 395, 397, 399, 401]
pieces['type4'] = [646, 647, 649, 651, 653, 655, 657, 671, 672, 673, 674, 679, 681, 684, 686, 688, 691, 695, 697, 698, 699, 700]
pieces['type5'] = [723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743]
pieces['type6'] = [434, 435, 438, 440, 443, 446, 447, 462, 464, 467, 469, 484, 485, 486, 487, 488, 489, 490, 491, 492, 494, 496]
possibilities = permutations!(pieces) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:30:57.867

就内存而言，它看起来还不错。尽管我预料到了，但 CPU 就像以前一样固定。

现在大部分时间都在将记录存储在数据库中。我希望我可以使用 activerecord-import 或批量插入来更快地完成它，但我必须在保存之前对组进行计算。所以我将它设置为 before_save 钩子，以便在模型中处理它。

按照目前的速度，获取数据库中的所有数据大约需要几个月的时间。

```
def generate(input)
  input.each do |key, possibilities|
    possibilities.map!{|p| {key => p} }
  end

  digits = input.keys.map!{ |key| input[key] }

  i = 1
  shifted = digits.shift
  shifted.each do |item|
    puts "Generating groups #{i} of #{shifted.length}..."
    permutations_start = Time.now
    results = [item].product(*digits)
    puts "# of generated groups in the set number - #{i}: #{results.length}"
    puts "Took #{(Time.now - permutations_start).round(4)} seconds to generate.\n\n"

    # Storing the groups
    puts "Storing groups..."
    storing_start = Time.now
    results.each { |item| Group.create!(item.reduce({}, :update)) }
    puts "Took #{(Time.now - storing_start).round(4)} seconds to store.\n\n"

    i = i + 1
  end
end 
```

示例输出：

```
Collecting pieces...
  possibilities['type1'] = [701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722]
  possibilities['type2'] = [744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765]
  possibilities['type3'] = [410, 412, 413, 414, 415, 419, 422, 424, 426, 427, 429, 372, 374, 376, 378, 380, 382, 385, 395, 397, 399, 401]
  possibilities['type4'] = [646, 647, 649, 651, 653, 655, 657, 671, 672, 673, 674, 679, 681, 684, 686, 688, 691, 695, 697, 698, 699, 700]
  possibilities['type5'] = [723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743]
  possibilities['type6'] = [434, 435, 438, 440, 443, 446, 447, 462, 464, 467, 469, 484, 485, 486, 487, 488, 489, 490, 491, 492, 494, 496]
Took 0.4248 seconds to collect.

Generating groups 1 of 22...
There were 4,919,376 groups in the set number 1.
Took 1.819 seconds to generate.

Storing Groups...
250 items took 11.7158 seconds
250 items took 11.5094 seconds
250 items took 11.6994 seconds
250 items took 11.5678 seconds
250 items took 11.5529 seconds 
```

# python - 从多个文件中提取数据

> ID：13352885
> 
> 赞同：2
> 
> 时间：2012-11-12T22:49:03.817
> 
> 标签：python

我正在使用 python（特别是 numpy、scipy 和 matplotlib）从多个文件中读取数据。具体来说，我正在尝试提取 Z 值 9 个不同的点云数据集（.ply 格式：X、Y、Z、R、G、B）。

使用提取的 Z（或高度值），我试图制作高度的相对频率直方图，其中包含 9 个文件中每个 bin 的平均相对频率、标准偏差和置信区间。

我有一个为单个文件执行此操作的工作代码，但在尝试将其扩展为处理 9 个文件时遇到了困难。我可以简单地使用多行冗余代码进行暴力破解，但我正在努力提高效率。

我有一些代码的效果：

```
filelist = os.listdir('path to 9 ply files')
   for files in filelist:
   CAM_XYZ = loadtxt(files,skiprows = 14, usecols = (0,1,2))
   CAMt    = transpose(CAM_XYZ)
   CAM_Z   = CAMt[2] 
```

我想从每个文件中提取 Z 值/列，然后将它们附加到另一个数组。理想情况下，这个最终数组将有 9 列，每个文件的 Z 值。我只是坚持我将如何实际执行此操作，我当前代码的设置方式只是覆盖了值。

任何建议/看的地方将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:55:49.383

有什么理由不能将所有值附加到一个列表中？

```
filelist = os.listdir('path to 9 ply files')
z_values = []
for files in filelist:
  CAM_XYZ = loadtxt(files,skiprows = 14, usecols = (0,1,2))
  CAMt = transpose(CAM_XYZ)
  z_values.append(CAMt[2]) 
```

这似乎是最简单的解决方案。

# java - Spring 3.1 中的属性占位符继承

> ID：13352887
> 
> 赞同：2
> 
> 时间：2012-11-12T22:49:08.937
> 
> 标签：java, spring, spring-environment

我正在尝试使用 Spring 的新`Environment`支持移植我们的自定义属性占位符，但我不知道如何获得我们当前的占位符魔法。

我想要的是从类路径中读取一组默认的属性文件，然后让这些属性被其他地方的一堆属性文件覆盖（覆盖）。**我不希望所有属性都只替换在另一组文件中设置的属性。**

**在 Spring 3.1 之前**

```
<bean class="com.snaphop.spring.ConfigResourcesFactoryBean" id="customConfig">
    <property name="parameterName" value="customConfig"/>
    <property name="defaultResources" value="classpath*:META-INF/spring/*.properties"/>
</bean>

<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" id="customPropertyPlaceholder">
    <property name="systemPropertiesModeName" value="SYSTEM_PROPERTIES_MODE_OVERRIDE"/>
    <property name="locations" ref="customConfig"/>
</bean> 
```

现在 ConfigResourcesFactoryBean 只是一个神奇的 FactoryBean，它可以找到要提供给占位符配置的资源列表：

```
public class ConfigResourcesFactoryBean implements FactoryBean<Resource[]> {
// Loads a bunch of Resources (property files) 
// based on System.property/Environment variable "customConfig"
} 
```

现在 customConfig 可能设置为`-DcustomConfig=file://blah/*.properties`或`export customConfig=file://blah/*.properties`。

目录中的属性`blah`仅覆盖`classpath*:META-INF/spring/*.properties`. 因此，`Resource[]`从工厂返回的将是一个 union ，分别`classpath*:META-INF/spring*.properties`跟随`file://blah/*.properties`。

现在它出现了，而不是我的`Resource[]`工厂，我可以进行自定义`PropertySources`并将其连接到 PlaceholderConfig 中，但这似乎与上述相比没有任何价值。

我不能使用[`ApplicationContextInitializer`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/context/ApplicationContextInitializer.html)，因为我发誓它只适用于 Servlet 环境，因此不适用于集成测试（我不想在我的每一个单元测试上添加一个注释来告诉它什么时候我可以只是像以前一样设置系统属性）。

**如何使用自定义源覆盖来自硬编码源的属性，而不必覆盖/实现一堆类？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-02T14:40:54.663

加班慢慢把原来的配置解析代码移植到新的 Spring Environment 处事方式上。

我在这个 StackOverflow 问题上谈到它：[如何使用 IntelliJ 在特定于环境的运行时配置之间轻松切换？](https://stackoverflow.com/questions/21557545/how-can-i-easily-switch-between-environment-specific-runtime-configuration-with/21567545#21567545)

您可以将[代码视为 Gist](https://gist.github.com/agentgt/8870316)，并使用我在大多数 Spring 项目中使用的相同配置逻辑。

遗憾的是，对于单元测试，Context Initializer 仅适用于 Spring 3.2。请参阅[更新的`@ContextConfiguration`注释](http://docs.spring.io/spring/docs/3.2.x/spring-framework-reference/html/testing.html#integration-testing-annotations)。对于使用 Spring 3.1 及更早版本的项目，我不得不使用旧的自定义属性占位符。

# abap - 以编程方式从 BW 检索 BAdI。如何？

> ID：13352889
> 
> 赞同：2
> 
> 时间：2012-11-12T22:49:15.337
> 
> 标签：abap, sap-bw, badi

我想以编程方式检索使用 BW 生成的 ABAP 程序的源代码。

我想要一个 ABAP 程序，它可以使用名称作为参数检索 BADI 源，然后将源保存在本地磁盘上，将每个 BADI 保存在具有程序名称的文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:19:46.787

如果您知道实现的名称，则必须查找实现类的名称。根据 BAdI 类型（经典或快速内核），您必须使用不同的例程来读取类名（尝试功能模块`SXO_IMPL_FOR_BADI_READ`并阅读类`CL_ENH_BADI_RUNTIME_FUNCTIONS`方法的编码`GET_BADI_SHORTTEXT`以了解如何使用各种 BAdI 类型） . 然后，看看命名的功能模块`SEO*`——你会发现所有你需要的东西来阅读一个类的结构、它的超类和它的方法（仅仅导出源代码是不够的，对吧？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-08T22:35:55.937

您可以通过以下方式实现此目的：

```
SELECT class_name
  INTO TABLE @DATA(lt_badi)
  FROM badi_impl
 WHERE badi_name = 'value'. " <- your badi name

LOOP AT lt_badi ASSIGNING FIELD-SYMBOL(<badi_class>).

  DATA(lo_instance) =  cl_oo_factory=>create_instance( ).
  DATA(lo_source) = lo_instance->create_clif_source( clif_name = CONV string( <badi_class> )
                                                     version   = 'A' ).
  lo_source->get_source( IMPORTING source = DATA(rt_source) ).

ENDLOOP. 
```

将带有源的内部表保存到文件是微不足道的。

# hibernate - 如何让 JPA 实体管理器忘记以前的异常？

> ID：13352891
> 
> 赞同：0
> 
> 时间：2012-11-12T22:49:21.417
> 
> 标签：hibernate, exception, jpa, entitymanager, many-to-one

我正在使用 Hibernate 4.1.0.Final 和 hibernate-jpa-2.0-api。我遇到了一个问题，一旦我保存一个包含错误的实体，重复保存其他实体会给我与第一个实体报告的错误相同的错误，即使后续实体没有错误也是如此。这是我的实体：

```
@GenericGenerator(name = "uuid-strategy", strategy = "uuid.hex")
@Entity
@Table(name = "cb_organization", uniqueConstraints = {@UniqueConstraint(columnNames={"organization_id"})})
public class Organization implements Serializable
{

    …
    @ManyToOne(optional = false) 
    @JoinColumn(name = "country_id", nullable = false, updatable = false)
    /* The country the Organization is in */
    private Country country; 
```

如果我尝试保存国家为空的实体，然后保存国家不为空的第二个实体，则第二次保存会引发 ConstraintViolationException 抱怨国家字段为空。

```
Organization org1 = new Organization();
…
org.setCountry(null);
orgDao.save(org1);      // We expect exception to be thrown, which it is.

Organization org2 = new Organization();
…
orgDao.setCountry(country); // set a valid Country object
orgDao.save(org2); 
```

这是相关的DAO代码......

```
@Autowired
private EntityManager entityManager;

@Override
public Organization save(Organization organization)
{
    if(StringUtils.isEmpty(organization.getId()))
    {
        entityManager.persist(organization);
    }
    else 
    {
        organization = entityManager.merge(organization);
    }
    entityManager.flush();

    return organization;
} 
```

任何人都知道为什么第二次调用也会引发异常以及如何第二次修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T12:12:33.217

我有完全相同的问题。在第一个异常发生后，每个后续 JPA 查询结果都会出现相同的异常。事件简单选择查询。

问题是我没有在交易之间关闭我的实体管理器。

我通过调用`entityManager.clear()`我的`catch (PersistenceException e)`块来解决它。我不确定这是否是正确的方法。

编辑：更好的是，将`clear()`呼叫移至`finally`块。否则可能会导致内存泄漏。

在此期间您是否找到了另一种解决方案？

# javascript - js.coffee.erb - 同步问题？

> ID：13352892
> 
> 赞同：0
> 
> 时间：2012-11-12T22:49:23.380
> 
> 标签：javascript, ruby-on-rails-3, google-maps-api-3, coffeescript, erb

我正在尝试将数据库中的纬度和经度值插入到我的谷歌地图咖啡脚本中。

```
jQuery ->
  initialize()

initialize = ->
  myOptions =
    center: new google.maps.LatLng(<%= @location.latitude %>, <%= @location.longitude %>)
    zoom: 12
    mapTypeControlOptions: {mapTypeIds: ["OSM", "OCM", "MQ", google.maps.MapTypeId.HYBRID]}
  map = new google.maps.Map $('#map_canvas')[0], myOptions 
```

[...]

我收到以下错误消息：

```
 undefined method `latitude' for nil:NilClass
   (in /Users/sg/rails-projects/geo_rails_test/app/assets/javascripts/gmap.js.coffee.erb) 
```

建议我的位置对象

```
@location = Location.find(params[:id]) 
```

在解析 js.coffee.erb 文件的时候还没有被实例化。（？？）

我已经用硬编码值测试了咖啡脚本，@location.latitude 在我看来非常有效。任何想法出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T23:11:46.763

您的 (Java|Coffee)Script 资产将在控制器运行*之前*被处理并发送到浏览器。这意味着它`@location`不会来自您的控制器，它将来自您转换为 JavaScript`self`时发生的任何事情。`.js.coffee.erb`在部署到生产环境时，资产将（或至少应该）在任何东西到达您的生产系统之前进行编译，因此`@location`没有希望成为任何有用的东西。

您应该在控制器的 ERB 而不是资产中构建数据：

```
<!-- Somewhere in the appropriate app/views/... file... -->
<script type="text/javascript">
    window.global_location = { lat: <%= @location.latitude %>, lng: <%= @location.longitude %> }; 
</script> 
```

然后您的资产可以通过`this_location`全局获取数据：

```
center: new google.maps.LatLng(global_loc.lat, global_loc.lng) 
```

或者您可以尝试通过 AJAX 调用加载位置。

Only use ERB in your assets for per-application constants and configuration values, don't try to use ERB in your assets for anything that will change while your application is running.

# c# - 按大写字母拆分字符串（不包括连字符）

> ID：13352896
> 
> 赞同：3
> 
> 时间：2012-11-12T22:49:50.297
> 
> 标签：c#, string, xpath, split, watin

我正在使用 WatiN 根据我从网站上提取的字符串单击浏览器中的链接。

问题是它提取的一些文本是多行的，因此它将字符串组合成 1 个单词。示例：“超耐腐蚀涂层合金钢”变为“超耐腐蚀涂层合金钢”

我试图用除连字符以外的所有大写字母来分割字符串，这样我就可以开始按部分字符串搜索链接。

这就是我到目前为止所拥有的

```
 types = doc.DocumentNode.SelectNodes("//h3[@class='AbbrPrsnttn_PrsnttnNm']");
                foreach (HtmlNode type in types)
                {
                    desc = type.InnerText.CleanText();

                    if (browser.Div(Find.ById("ProdPrsnttnGrpCntnr")).Element(Find.ByText(desc)).Exists)
                    {
                        browser.Div(Find.ById("ProdPrsnttnGrpCntnr")).Element(Find.ByText(desc)).Click();
                        System.Threading.Thread.Sleep(5000);
                        types = doc.DocumentNode.SelectNodes("//h3[@class='AbbrPrsnttn_PrsnttnNm']");
                        doc2.LoadHtml(browser.Html);
                        partTable = doc2.DocumentNode.SelectSingleNode("//div[@class='ItmTblGrp']");

                        MineNext(doc, doc2, browser, typeUrl, types, desc, partTable);
                    }

                    else
                    {
                        split = desc.Split(new Char[] { ' ' });

                    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T23:24:26.267

这是一个如何实现它的示例：

**更新**为也单独的数字。

```
using System;
using System.Text;

namespace SplitOnUppercase
{
    class Program
    {
        static void Main()
        {
            const string text = "Test42-10 UltraCorrosion-ResistantCoated Alloy-SteelNumberTest42";
            var result = new StringBuilder(text.Length);
            for (var i = 0; i < text.Length - 1; i++)
            {
                result.Append(text[i]);
                if (text[i] != ' ' && text[i] != '-' && (char.IsUpper(text[i + 1]) || !char.IsDigit(text[i]) && char.IsDigit(text[i + 1])))
                    result.Append(' ');
            }
            result.Append(text[text.Length - 1]);

            Console.WriteLine(result);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:54:31.520

您可以使用`Char.IsUpper("C")`来查找要拆分的索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T23:30:01.347

我很确定 String.Split(Char[]) 区分大小写，但我目前无法测试。我不在可以测试或编写 c# 的计算机上，但这应该合乎逻辑。这可能有很多语法错误。

```
Char[] splitChars = {'A', 'B', etc....}; //what the string will be split by
string desc = inputString; // input string
string[] splitByCapital = desc.Split(splitChars);
string[] output = new string[splitByCapital.length];
for (int i = 0; i < splitByCapital.length; i++)
{
    if (splitByCapital[i].Contais("-"))
    {
        output = splitByCapital[i] + splitByCapital[i-1];
    }
    else
    {
        output = splitByCapital[i];
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T18:47:04.763

这是我使用 Linq 整理的一个示例。可能有很多方法可以改善这一点。

```
public static string TransformLinqExample(this string toTransform)
        {
            string answer = toTransform
                .ToCharArray()
                .Select(c => new string(c, 1))
                .Aggregate((a, c) => a += (CapitalLetters.Contains(c) && c.IsUpper() && !a.EndsWith("-") && !a.EndsWith(" ")) ? " " + c : "" + c);
            return answer;
        } 
```

这是一个完整的例子。

```
using System;
using System.Linq;

namespace SplitProblem
{
    public static class StringAndCharExtensions
    {
        const string CapitalLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        public static bool IsUpper(this string theChar)
        {
            return theChar.ToUpper() == theChar;
        }
        public static string TransformLinqExample(this string toTransform)
        {
            string answer = toTransform
                .ToCharArray()
                .Select(c => new string(c, 1))
                .Aggregate((a, c) => a += (CapitalLetters.Contains(c) && c.IsUpper() && !a.EndsWith("-") && !a.EndsWith(" ")) ? " " + c : "" + c);
            return answer;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            string toSplit = "Ultra12.4 34.2 Corrosion-ResistantCoated 18-6 AlloySteel";
            string tranformed = toSplit.TransformLinqExample();
            Console.WriteLine("{0}\n\n", tranformed);

            foreach (var part in tranformed.Split(' '))
            {
                Console.WriteLine(part);
            }
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-16T05:34:59.790

最简单的方法是使用正则表达式拆分大写字母（以下代码不会将字符串拆分为特殊字符或数字，为此，请更新正则表达式模式以包含特殊字符和数字）。

```
 var inputString = "AnyStringThatYouWantToSplitOnCap";
    var pattern = "[A-Z][a-z]+";
    Regex regex = new Regex(pattern);
    var matches = regex.Matches(inputString);
    StringBuilder value = new StringBuilder();
    foreach (Match item in matches)
    {
        value.AppendFormat("{0} ", item.Value);
    } 
```

# django - Django - 在视图中检测移动设备

> ID：13352897
> 
> 赞同：8
> 
> 时间：2012-11-12T22:49:54.823
> 
> 标签：django

我已经在我的模板中使用了设备检测（[http://djangosnippets.org/snippets/2228/](http://djangosnippets.org/snippets/2228/)），并试图让它在视图中工作，所以如果用户来自 iPhone，我可以重定向到应用商店。

所以我已经有了：

```
import re

def mobile(request):

    device = {}

    ua = request.META.get('HTTP_USER_AGENT', '').lower()

    if ua.find("iphone") > 0:
        device['iphone'] = "iphone" + re.search("iphone os (\d)", ua).groups(0)[0]

    if ua.find("ipad") > 0:
        device['ipad'] = "ipad"

    if ua.find("android") > 0:
        device['android'] = "android" + re.search("android (\d\.\d)", ua).groups(0)[0].translate(None, '.')

    # spits out device names for CSS targeting, to be applied to <html> or <body>.
    device['classes'] = " ".join(v for (k,v) in device.items())

    return {'device': device } 
```

然后在 tools/middleware.py 中创建了一个类：

```
from tools.context_processor import mobile

class detect_device(object):

    def process_request(self, request):
        device = mobile(request)

        request.device = device 
```

在 settings.py 的 MIDDLEWARE_CLASSES 中添加了以下内容：

```
'tools.middleware.detect_device' 
```

在views.py中我创建了：

```
def get_link(request):
    if request.device.iphone:
        app_store_link = settings.APP_STORE_LINK
        return HttpResponseRedirect(app_store_link)
    else:
        return HttpResponseRedirect('/') 
```

但我收到错误：

> 'dict' 对象没有属性 'iphone'

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T22:53:48.673

它是一本字典，而不是一门课。

完整视图：

```
def get_link(request):
    if 'iphone' in request.device['device']:
        app_store_link = settings.APP_STORE_LINK
        return HttpResponseRedirect(app_store_link)
    else:
        return HttpResponseRedirect('/') 
```

# objective-c - 你会如何感觉到一个按住的按钮？

> ID：13352899
> 
> 赞同：0
> 
> 时间：2012-11-12T22:49:58.647
> 
> 标签：objective-c, xcode, button, timer, uibutton

如果某个按钮被按住，我将如何编写代码来感知？以及如何将计时器添加到我的应用程序中？

问候，尼基塔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:00:33.073

听起来您正在寻找[UILongPressGestureRecognizer](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UILongPressGestureRecognizer_Class/Reference/Reference.html#//apple_ref/occ/cl/UILongPressGestureRecognizer)。有了它，您可以配置一个 minimumPressDuration，它可以满足您对计时器的需求，如果没有，那么[NSTimer](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html)很容易使用。

# c# - 如何向 DataGridView 文本框添加隐藏值？（C＃）

> ID：13352901
> 
> 赞同：1
> 
> 时间：2012-11-12T22:50:20.857
> 
> 标签：c#

我正在使用现有的 GridView，我想知道是否有一种方法可以为 TextBoxColumn 提供不同的值和显示，类似于 ComboBoxColumn（显示成员、值成员）。

```
private System.Windows.Forms.DataGridViewTextBoxColumn PATH;

 this.PATH.DataPropertyName = "Path";
 this.PATH.HeaderText = "PATH";
 this.PATH.Name = "Path";
 this.PATH.ReadOnly = true;
 this.PATH.Width = 186; 
```

现在我有一个带有 ID 的隐藏列，但我想知道是否有更好的解决方案。

ETA：我放了 PATH.DataPropertyName = "PathId" （我想用于更新的隐藏值）和 this.PATH.Name = "Path" （我想显示的字符串值）

当我获取列的值时，仍会返回 Name 值。

this.mySampleGridView.Rows[i].Cells["Path"].Value

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:04:21.413

如果我正确理解了这个问题，DataPropertyName 应该在这里有所帮助。

从有关 DataGridViewColumn.DataPropertyName 的 MSDN 文档中：

```
// Initialize and add a text box column.
DataGridViewColumn column = new DataGridViewTextBoxColumn();
column.DataPropertyName = "Name";
column.Name = "Knight";
dataGridView1.Columns.Add(column); 
```

该列现在绑定到具有多条信息但仅显示一条的项目。其余部分被有效隐藏。

编辑：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.datapropertyname.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcolumn.datapropertyname.aspx)

# javascript - 浏览器的快速 IPC 方法

> ID：13352906
> 
> 赞同：1
> 
> 时间：2012-11-12T22:50:31.617
> 
> 标签：javascript, c++, winapi, ipc

我编写了一个应用程序来累积数据（几 MB/秒，但每秒更新 10 次）并通过 javascript 在浏览器中显示当前进程。

问题是目前我将数据写入文件并使用 javascript 加载它，但这使得应用程序非常滞后，人们抱怨他们的硬盘工作量很大。

我很想使用像“FILE_ATTRIBUTE_TEMPORARY”这样的标志来告诉我的操作系统实际上不要将文件写入磁盘，但是javascript要求我首先关闭文件句柄（否则firefox无法打开它）。因此，它将在那时被写入磁盘，在最初使用该标志时终止该点。

我考虑过使用 mysql 数据库之类的东西，但我真的想让它尽可能简单，而且我更喜欢不强制用户设置一些 http 或 mysql 服务器的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:10:01.027

在您的独立 C++ 应用程序中包含一个网络服务器，并直接从内存中提供数据。

我认为这是避免您现在面临的 I/O 开销的唯一选择。JS 中没有 IPC、消息队列或类似的接口。TCP（或带有 websocket 的 UDP）似乎是避免磁盘 I/O 的唯一可能方法。另一种选择是将您的 JavaScript 替换为浏览器插件，该插件可以使用本机代码访问您的操作系统的功能。

注意：在 UNIX 环境中，您可以在文件系统中创建一个 FIFO 套接字，这也可能（或可能不会）满足您的目的。不过，我不认为 Windows 支持这样的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T23:10:19.793

听起来您的累积数据的应用程序正在用户机器上本地运行，并且加载到浏览器中的页面也是本地的。正如您所说，您不希望用户必须配置（或者我假设运行）HTTP 服务器，您希望避免出于性能原因将数据写入磁盘，并且您的标题包括“IPC”，我相信剩下的就是创建浏览器插件或在页面中包含 ActiveX 控件。

页面中的 ActiveX 控件可以将平台上可用的任何 IPC 机制用于本地代码（例如共享内存）。

另一种选择是让您的应用程序成为 HTTP 服务器，因此不需要单独的服务器，但这可能属于必须配置 HTTP 服务器的用户类别（例如，他们可能需要在软件防火墙上打开端口）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T23:00:01.777

我会研究如何为您选择的网络服务器制作插件或 CGI 程序，以便您的 Javascript 可以访问服务器上的某个 URL，并且返回的数据不是来自真实文件，而是由您的程序处理网络请求。（这在大多数 Web 服务器上都是可能的。它可以像将 C++ 程序写入标准控制台一样简单。）

# c++ - 赋值运算符和条件语句

> ID：13352907
> 
> 赞同：0
> 
> 时间：2012-11-12T22:50:32.603
> 
> 标签：c++, dynamic, if-statement

我很难理解下面的代码`buffer[i] = arr ? arr[i] : 0;`。这是否意味着如果`arr`包含任何东西，则它等于`buffer[i]`，如果不包含，则等于`0`？

```
#include <iostream>
using namespace std;
int main ()
{
    int arr[5]={11,22,33,44,55};
    int * buffer;
    buffer = new int [5];

    for(int i=0;i<5;i++){
        buffer[i] = arr ? arr[i] : 0;//true/falls
        cout<<buffer[i]<<",";
    }
    cout<<endl;

    int arr2[5]={};
    int * buffer2;
    buffer2 = new int [5];

    for(int i=0;i<5;i++){
        buffer2[i] = arr2 ? arr2[i] : 0;//true/falls
        cout<<buffer2[i]<<",";
    }
    cout<<endl;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T22:52:23.073

似乎代码可能是从`arr`动态分配时移植的。现在它在堆栈上，所以`arr`永远不可能`NULL`，所以检查没用

# vb.net - VB循环复杂化

> ID：13352909
> 
> 赞同：1
> 
> 时间：2012-11-12T22:50:41.117
> 
> 标签：vb.net, visual-studio-2010, visual-studio, loops, messagebox

我必须想出一个程序来随机改变文本框中的名称。我已经把所有的东西都弄到了名字随机变化的地步。它只移动一次，但我的消息框在代码中出现的次数与单击确定后名称应移动的次数一样多。有谁知道为什么循环不适用于名称转换。我在想也许消息框需要控制循环，但我无休止地搜索，找不到怎么做。任何建议或推荐到其他网站将非常感谢。我的代码如下。

公开课形式1

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim RandomNumber As Integer
    Dim min, max As Integer
    Dim temp, temp2, temp3, temp4, temp5, temp6 As String
    Dim i As Integer

    min = 3
    max = 11

    Randomize()
    RandomNumber = Int((max - min + 1) * Rnd() + min)

    temp = n1.Text
    temp2 = n2.Text
    temp3 = n3.Text
    temp4 = n4.Text
    temp5 = n5.Text
    temp6 = n6.Text

    For i = 0 To RandomNumber - 1
        n1.Text = temp6
        n2.Text = temp
        n3.Text = temp2
        n4.Text = temp3
        n5.Text = temp4
        n6.Text = temp5
        MessageBox.Show("Shift " & i & " of " & RandomNumber & " complete")
    Next

End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:55:53.093

认为临时变量也应该在循环中

```
For i = 0 To RandomNumber - 1

temp = n1.Text
temp2 = n2.Text
temp3 = n3.Text
temp4 = n4.Text
temp5 = n5.Text
temp6 = n6.Text  

    n1.Text = temp6
    n2.Text = temp
    n3.Text = temp2
    n4.Text = temp3
    n5.Text = temp4
    n6.Text = temp5
    //MessageBox.Show("Shift " & i & " of " & RandomNumber & " complete")
Next 
```

## 更新

**您也可以使用一个临时变量以这种方式执行此操作**

```
For i = 0 To RandomNumber - 1

  temp = n6.Text

  n6.Text = n5.Text
  n5.Text = n4.Text
  n4.Text = n3.Text
  n3.Text = n2.Text
  n2.Text = n1.Text
  n1.Text = temp

Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:56:52.493

在 MessageBox 之前或之后添加这一行：

```
Application.DoEvents 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T23:01:01.070

像codingbiz建议的那样将临时变量的赋值放在循环中会使其工作，但您根本不需要循环。如果将字符串放入数组中，则可以计算它们的位置：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
  Dim RandomNumber As Integer
  Dim min, max As Integer
  Dim temp As New String(5)

  min = 3
  max = 11

  Randomize()
  RandomNumber = Int((max - min + 1) * Rnd() + min)

  temp(0) = n1.Text
  temp(1) = n2.Text
  temp(2) = n3.Text
  temp(3) = n4.Text
  temp(4) = n5.Text
  temp(5) = n6.Text

  n1.Text = temp((0 + RandomNumber) Mod 6)
  n2.Text = temp((1 + RandomNumber) Mod 6)
  n3.Text = temp((2 + RandomNumber) Mod 6)
  n4.Text = temp((3 + RandomNumber) Mod 6)
  n5.Text = temp((4 + RandomNumber) Mod 6)
  n6.Text = temp((5 + RandomNumber) Mod 6)

End Sub 
```

# javascript - 插入到带有动态 ID javascript 的表中

> ID：13352910
> 
> 赞同：0
> 
> 时间：2012-11-12T22:50:41.003
> 
> 标签：javascript, sql, database

我有一个创建表并返回名称列表的 javascript 函数。每个名称都是移动网站的一个 href。我为每个 a href 标签添加了一个 id。id 标签是`id="player + counter"`. 结果`player1` `player2`等。在每个名称旁边的列中会出现一个添加按钮。该按钮具有将名称添加到数据库的功能。我这样称呼它：

```
addName(document.getElementById('player + counter').value); 
```

我没有错误。一切似乎都很好，除了当我在数据库中查看附加值时，它不是名称，它说未定义。我想不通。一切看起来都很好。我假设它是因为 id 的元素是动态创建的，并且不在页面上开始。这有意义吗？？？如果需要，我可以详细说明，但一切似乎都很好。为什么它会插入一个未定义的值？

抱歉，我在写问题时分心了。我看不到任何语法错误。我实际上是如何写的如下：

```
onclick("addPlayer(document.getElementById(' + "'txtListName').value, document.getElementById('player" + counter + "').value)") 
```

如果报价有问题或我不相信它会以它的方式工作。我的意思是当我检查元素时，它完美地工作了一个标签 id 的增量，player1 player 2 etc. player 就是这样，这个词 player，它不是一个变量

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:11:16.807

这可能是你的错误：

改变：

```
addName(document.getElementById('player + counter').value); 
```

至：

```
addName(document.getElementById('player' + counter).value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:25:15.453

如果 gdoron 的好建议不起作用，请尝试...

```
 addName(document.getElementById(player + counter).value); 
```

因为我们看不到您的代码。祝你好运。

# bash - 在 bash 中，如何通过参数替换获得没有最终扩展名的文件名？

> ID：13352911
> 
> 赞同：2
> 
> 时间：2012-11-12T22:50:46.193
> 
> 标签：bash

我正在遍历`*.info`目录中的所有文件，并检查是否存在相应`*.gz`的文件（如果没有则删除该`.info`文件）。但要做到这一点，我需要`.info`去掉`$file`. 我一直在摆弄参数替换，`bash`但似乎没有任何效果。我可以很容易地获得扩展（就像下面的代码一样），但除了扩展之外，我不是所有*的*东西。我尝试了各种我认为可能有用的东西；没有。

```
for file in *.info; do
  gz_file="${file:(-4)}"                        # wrong... what is right?
  # gz_file=`echo "$file" | sed -e 's/.info//'` # easy alternative I'm trying to avoid
  if [[ ! -f "${gz_file}" ]]; then
    rm "${file}"
  fi
done 
```

我意识到这可以很容易地完成`sed`，如注释掉的行中所示，但如果可能的话，我想使用 bash 内置的变量操作功能来完成它，因为我认为它会很方便弄清楚如何让它以这种方式工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:56:40.763

你试过了`${file%.*}`吗？这应该删除扩展名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T22:53:20.280

```
$ x=/foo/bar.info
$ echo ${x%.info}
/foo/bar
$ 
```

# php - func_get_args 检测上下文

> ID：13352917
> 
> 赞同：0
> 
> 时间：2012-11-12T22:51:07.973
> 
> 标签：php, function

我有一个脚本，它接受不同数量的参数。

我想使用 func_get_args 对所述参数执行操作。如果我有一个这样的功能：

```
function Something() {
   foreach(func_get_args($this) as $functions) {
       // Do something
   }

   // Return..
} 
```

例如，我希望能够在另一个函数中调用这个函数来添加/保存条目。添加/保存函数将有参数“标题”、“描述”等。

我基本上想知道是否有办法检测函数调用的上下文。我可以将一些东西传递给 func_get_args 让它知道它在某个函数中被调用吗？所以如果我这样做：

```
function Save($title, $desc) {
$vars = $this->Something();
} 
```

我想`$vars`包含`$title`并`$desc`在修改它们之后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:09:24.057

您的函数没有参数，因此无法使用`func_get_args`.

您可以通过检查[backtrace](http://php.net/manual/en/function.debug-backtrace.php)并提取`args`零件来获得它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:37:33.077

想通了.. 不漂亮，但它做了我想要的。

```
private function Handle($Function, $Values) {
        $Method = new ReflectionMethod($this, $Function);
        $Result = array();
        $Inc = 0;

        foreach($Method->getParameters() as $Args) {
            $Result[$Args->getName()] = $this->DB->real_escape_string($Values[$Inc]);
            $Inc++;
        }

        return $Result;
}

function Test($a, $b, $c) {
    $Vars = $this->Handle(__FUNCTION__, func_get_args());
    print_r($Vars);
}

print_r(Test(1, 2, 3));

Array
(
    [a] => 1
    [b] => 2
    [c] => 3
) 
```

我有另一种方法，但必须使用`$Vars[0], $Vars[1]`等访问数组，我想这样做，这样我就可以使用`$Vars['something'], $Vars['something_else']`.

# html - Flash - 如何关闭“启用硬件加速”窗口？

> ID：13352918
> 
> 赞同：1
> 
> 时间：2012-11-12T22:51:09.477
> 
> 标签：html, flash, wmode

我们嵌入了一段用于录制的 swf（[wami-recorder](http://code.google.com/p/wami-recorder/)）。问题是一些客户体验到启用硬件加速的窗口*总是*弹出。

![在此处输入图像描述](../Images/1f95c87a075232ef058007b4adacf7e9.png)

取而代之的是，应该有一个用于启用录音的弹出窗口（隐私选项卡），这本来可以的-但这不是显示的窗口（此处的麦克风选项卡仅用于音量，而不是我需要的）

你对这里发生的事情有任何线索吗？为什么显示“启用硬件加速”以及如何隐藏它？

swf 的嵌入有点像这样（精简）：

```
var flashVars = {
        visible : false,
        loadedCallback : initfn
    }
var params = {
        allowScriptAccess : "always"
    }
params.wmode = "transparent";
var version = '10.0.0';

Wami.swfobject.embedSWF(_options.swfUrl, id, 
       214, 137, version, null, flashVars, params); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-05T01:09:43.817

当您在 Safari / Mac OS X 上的 iframe 中使用 wami swf 时，这似乎是一个问题。不幸的是，Safari 在这种情况下禁用了某些功能。

一种解决方法是将 Safari 用户重定向到 iframe 之外和/或显示一个弹出窗口（它也在 iframe 之外）。

# javascript - 无法从 jquery 选项卡小部件中删除 tabIndex

> ID：13352919
> 
> 赞同：3
> 
> 时间：2012-11-12T22:51:17.697
> 
> 标签：javascript, jquery, tabwidget, tabindex

我设置了一个简单的 jquery 选项卡小部件。它从两个选项卡开始，一个是错误 1，一个是加号。单击加号会添加错误 2 选项卡。再次单击它会添加错误 3 选项卡。问题是单击加号后，我无法从选项卡中删除选项卡索引。RemoveAttr('tabIndex') 适用于页面加载以防止第一个选项卡具有索引，但是在单击加号后，我还没有找到从其余选项卡中删除选项卡索引的方法。我将 removeAttr() 放在 .show() 之后。我把它放在那行之前。我试着把它放在激活、加载、前加载和创建中。我尝试设置 tabindex=-1 而不是 removeattr()。我还尝试摆脱隐藏/显示并使用 css 显示/不显示。

```
$(document).ready(function(){    
$("#tabs").tabs({
        beforeActivate: function (event, ui) {
            if (ui.newTab.attr('id') == 'liTabsPlus') {
                event.preventDefault();
                errorTabsShowing += 1;
                $('#liTabs' + errorTabsShowing).show();
                $(this).tabs('option', 'active', errorTabsShowing - 1);
                if (errorTabsShowing == MAX_NUMBER_OF_ERRORS)
                    ui.newTab.hide();
            }
        }
    });

    $("#liTabs1").removeAttr("tabIndex");
    $("#liTabs2").hide();
    $("#liTabs3").hide();
    $("#liTabs4").hide();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T03:25:54.213

没有看到你的标记很难说，但我通过循环遍历我的元素并将选项卡索引设置为 -1 来做到这一点。这将是一个示例，所有选项卡都以“liTabs”的 id 开头，因此 liTabs1、liTabs23 等。

```
$('[id^=liTabs]').each(function(){ this.tabIndex = -1; }); 
```

希望这可以帮助

# python - 在 OS X Lion 上强制 Python 为 32 位

> ID：13352926
> 
> 赞同：4
> 
> 时间：2012-11-12T22:52:14.403
> 
> 标签：python, osx-lion, 32-bit, cplex

我正在尝试在 Mac OS 10.7.5 上的 Python 中使用 CPLEX。CPLEX 似乎只支持 32 位 python。我在 python shell 中使用它来检查它是否是 32 位的：

```
import sys,platform; print platform.architecture()[0], sys.maxsize > 2**32 
```

我已经按照 man 1 python 中的建议尝试了这两个命令，但似乎都没有强制 32 位：

```
export VERSIONER_PYTHON_PREFER_32_BIT=yes
defaults write com.apple.versioner.python Prefer-32-Bit -bool yes 
```

唯一似乎有效的是：

```
arch -i386 python 
```

但是，如果我使用调用其他脚本的 arch 运行脚本，它们似乎都以 64 位模式启动。是否有另一个系统范围的变量强制它进入 32 位模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T22:57:38.813

您可以使用该`lipo`命令创建仅`i386`支持的 Python 解释器的副本。

```
:; file /usr/bin/python2.7
/usr/bin/python2.7: Mach-O universal binary with 2 architectures
/usr/bin/python2.7 (for architecture i386): Mach-O executable i386
/usr/bin/python2.7 (for architecture x86_64):   Mach-O 64-bit executable x86_64

:; lipo -thin i386 -output python-i386 /usr/bin/python2.7

:; file python-i386 
python-i386: Mach-O executable i386

:; ./python-i386
Python 2.7.2 (default, Jun 20 2012, 16:23:33) 
[GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

然后安排您现有的脚本调用`python-i386`，或者（如果他们使用`/usr/bin/env`技巧）将其重命名为`python`并将其放在您`PATH`之前某处的目录中`/usr/bin`。

请注意，查看`platform.architecture()`甚至`platform.machine()`不会真正告诉您当前进程是 32 位还是 64 位。那些总是为我提供 64 位的答案。但是当我检查活动监视器时，我可以看到我剥离的二进制文件没有标记为“（64 位）”，而其他进程则有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-01T17:37:01.293

有关如何在每个用户或系统范围内选择解释器的信息，请参阅 Apple 开发人员库中的官方信息。

### 设置系统版本

% 默认写入 com.apple.versioner.python 版本 2.7

### 将默认系统版本设置为 32 位

% 默认写入 com.apple.versioner.python Prefer-32-Bit -bool 是

### 使用特定版本

可以直接使用特定版本，而不是使用 python 命令。例如，从命令行运行 python2.7 将运行 2.7 版本的 Python，与 Python 的默认版本无关。

可以在 #! 上使用特定版本的 Python。脚本行，但这可能存在可移植性和未来兼容性问题。

请注意，适用于 python 命令的首选项文件和环境变量在运行特定版本的 Python 时不适用。特别是，运行 python2.6 将始终默认为 64 位执行（除非使用 arch(1) 命令专门选择 32 位架构）。

[https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/python.1.html](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/python.1.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-15T16:02:17.893

经过大量的反复试验，我自己尝试了上面的一些建议，以及在[这里](https://stackoverflow.com/questions/2088569/how-do-i-force-python-to-be-32-bit-on-snow-leopard-and-other-32-bit-64-bit-quest)，我偶然发现了以下符号链接：

```
/usr/local/bin/python2-32 
```

指向：

```
/Library/Frameworks/Python.framework/Versions/2.7/bin/python2-32 
```

我观察到，当我运行这个 Python 时，它以 32 位模式启动（与 相比`/Library/Frameworks/Python.framework/Versions/2.7/bin/python2`）。这可以在活动监视器中观察到。

**注意：正如其他人在其他地方指出的那样，`platform.architecture()`并不总是一个好的指标。它显示此 32 位进程的“64 位”。**

# c# - 我需要从 List<> 中删除重复项

> ID：13352929
> 
> 赞同：1
> 
> 时间：2012-11-12T22:52:29.847
> 
> 标签：c#, list

我有一个`List<CreditCard>`, 信用卡的一个属性是`CreditCardNumber`, 它是一个字符串。不幸的是，它可以是`1234 1234 1234 1234`或`1234123412341234`，它们都是相同的数字。

我需要检查并删除这些重复的项目。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T22:57:14.073

```
using System.Linq;

public List<string> GetUniqueCardNumbers(List<string> cardNumbers)
{
    // First replace the spaces with empty strings
    return cardNumbers.Select(cc => cc.Replace(" ", ""))
                      .Distinct()
                      .ToList();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T23:04:10.650

最好的选择是在输入时从卡号中删除空格，这样您只需执行一次清洁操作：

```
 public class CreditCard: IComparable<CreditCard>
    {
        string creditCardNumberClean;
        string creditCardNumberOriginal;
        public string CreditCardNumber
        {
            get 
            { 
                return this.creditCardNumberOriginal; 
            }
            set
            {
                this.creditCardNumberOriginal = value;
                this.creditCardNumberClean = value.Replace(" ", "");
            }
        }
        public CreditCard(string creditCardNumber)
        {
            this.CreditCardNumber = creditCardNumber;
        }

        public int CompareTo(CreditCard other)
        {
            return this.creditCardNumberClean.CompareTo(other.creditCardNumberClean);
        }
    } 
```

但是，如果这不可能，您基本上想对卡号执行字符串比较，只需在比较之前改变数字以删除所有空格：

```
 class Program
    {
        public static void Main(string[] args) 
        {
            List<string> list = new List<string>(new string[]{"1234 1234 1234 1234", "1234123412341234","9999 9999 9999 9999"});
            SortedSet<string> set = new SortedSet<string>(list, new CreditCardNoComparer());
            foreach (string s in set)
            {
                Console.WriteLine(s);
            }
            Console.ReadKey();
        }
    }
    public class CreditCardNoComparer : IComparer<string>
    {
        public int Compare(string x, string y)
        {
            return x.Replace(" ", "").CompareTo(y.Replace(" ", ""));
        }

    } 
```

**编辑**

```
//version using overridden GetHashCode and Equals methods as per @lazyberezovsky's comments 
public class CreditCard
{
    long creditCardNumberClean; //given the card number is numeric this is the most efficient way of storing it
    string creditCardNumberOriginal;
    public string CreditCardNumber
    {
        get
        {
            return this.creditCardNumberOriginal;
        }
        set
        {
            this.creditCardNumberOriginal = value;
            this.creditCardNumberClean = long.Parse(value.Replace(" ", "")); 
        }
    }
    public CreditCard(string creditCardNumber)
    {
        this.CreditCardNumber = creditCardNumber;
    }
    public override bool Equals(object obj)
    {
        CreditCard other = obj as CreditCard;
        return 
            other == null 
            ? false 
            : this.creditCardNumberClean.Equals(other.creditCardNumberClean);
    }
    public override int GetHashCode()
    {
        return this.creditCardNumberClean.GetHashCode();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T22:57:40.957

1.  删除每个空格
2.  采用`Distinct();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:57:41.630

您可以创建自己`EqualityComparer`的`CreditCard`删除空格并用于`Enumerable.Distinct`删除重复项：

```
public class CardComparer : IEqualityComparer<CreditCard>
{
    private readonly Regex re = new Regex(@"\s+");

    public bool Equals(CreditCard x, CreditCard y)
    {
        return re.Replace(x.Number, "") == re.Replace(y.Number, "");
    }

    public int GetHashCode(CreditCard obj)
    {
        return re.Replace(obj.Number, "").GetHashCode();
    }
} 
```

然后：

```
IEnumerable<CreditCard> unique = sourceList.Distinct(new CardComparer()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T22:59:53.523

首先，您必须确定什么构成“相等”。如果它像删除嵌入空格一样简单，那么您可以使用以前的解决方案之一来删除空格并调用`Distinct`. 否则，您必须创建一个相等比较器并将其传递给[Distinct 重载](http://msdn.microsoft.com/en-us/library/bb338049.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T23:05:27.793

```
IEnumerable<CreditCard> distinctCards = cards
  .Select(card => new {
     card, 
     ccn = card.CreditCardNumber.Replace(" ", string.Empty)
  })
  .GroupBy(x => x.ccn)
  .Select(g => g.First().card) //group has at least 1 member, so First() is safe
  //.ToList()   ??? 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-13T00:27:21.163

您只能从任何字符串中提取数字，在您的情况下，您只能将空格字符替换为空字符，对于更复杂的字符串格式，您可以使用下一个代码仅获取数字。您可以检查此答案：[仅获取数字](https://stackoverflow.com/a/844479/1819490)

```
string justNumbers = new String("asd123 f3 4.34-3 ".Where(Char.IsDigit).ToArray()); 
```

然后你将只有你的数字，`CreditCardNumber`你可以搜索重复的值。

# jquery - Jquery SimpleModal 在保存时关闭

> ID：13352930
> 
> 赞同：0
> 
> 时间：2012-11-12T22:52:33.327
> 
> 标签：jquery, ruby-on-rails, simplemodal

我有一个日历，您可以在其中单击一天以通过简单的模式弹出表单添加事件。我正在使用 Eric Martin 的 jquery 插件，我似乎无法在不停止 ajax 响应的情况下关闭表单。

这是我的代码：

```
function simple_dialog_link(request, title) {
  $.get(request, function(data) { 
    $.modal("<div class='modal'><div class='bar' >"+title+"</div><div class='inside'>"+data+"</div></div>");

    $(".modal").draggable({ handle: ".bar" }); 

    $("input.save").live("click", function(){
           $.modal.close();
    }); 
  });
}; 
```

这会完美地加载表单并关闭窗口，然后重定向到我的控制器下的 html 路径：

```
def update
  @log_entry = LogEntry.find(params[:id])
  @athlete = User.find_by_id(@log_entry.athlete_id)
  @log_entry.update_attributes(params[:log_entry])
  @date = @log_entry.date.to_s
  @cal_class = LogEntry.get_class_name(@date)
  @entries = LogEntry.cal_entry(@date, @athlete.id)
  respond_to do |format|
    format.html { redirect_to coaches_path }
    format.js
  end
end 
```

到目前为止，我尝试的是`return: false`在模态关闭功能下添加一个，这会关闭模态窗口但无法更新日历或数据库，从而在表单提交给控制器之前将其剪切。我需要一些函数来关闭窗口而不中断我的 ajax 函数。奇怪的是，当我删除该`$.modal.close();`功能时，表单提交得很好并更新了日历，只是让模式窗口保持打开状态。我需要这个功能，但要关闭窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:07:04.330

好的，我想通了，表明我对这一切了解多少！我所要做的就是将 close 函数放入 ajax:complete 回调中。

```
$(".edit_log_entry").bind('ajax:complete', function() {$.modal.close();}); 
```

# javascript - 清除草图仍然在 html5 的画布上

> ID：13352932
> 
> 赞同：1
> 
> 时间：2012-11-12T22:52:42.553
> 
> 标签：javascript, html, canvas, drawing

我只是对画布清晰的东西感到困惑——草图已经从画布上清除了，但是当我单击画布绘制新的东西时，清除的草图又回到了相同的位置。看起来草图已保存到一些“cookies”中，当下次单击画布或将鼠标悬停在画布上时，它们已被重新加载。

```
clear.click(function()){
var canvas = document,getElementById('mycanvas');
var context = canvas.getContext('2d');
context.clearRect(0,0,width,height);
}); 
```

我使用sketch.js 进行绘图： http: [//intridea.github.com/sketch.js/](http://intridea.github.com/sketch.js/) 实际上，sketch.js 中的代码也确实清理了画布：canvas.width = canvas.width。关于如何彻底清除它的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T01:18:23.063

请尝试以下问题的第二种解决方案。它说在清除画布之前重置转换矩阵。

```
// Use the identity matrix while clearing the canvas
ctx.setTransform(1, 0, 0, 1, 0, 0);
ctx.clearRect(0, 0, canvas.width, canvas.height); 
```

[如何清除画布以进行重绘](https://stackoverflow.com/questions/2142535/how-to-clear-the-canvas-for-redrawing)

请参阅以下有关重置转换矩阵的教程。

[HTML5 Canvas 重置变换教程](http://www.html5canvastutorials.com/advanced/html5-canvas-reset-transform-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T19:08:38.313

这是代码的另一部分给出了问题，我已经修复了它。看起来以前的草图已保存在数组中，每次我将当前草图添加到数组中，并在那里绘制所有内容。谢谢！很抱歉打扰了。

# android - 使用 HTMLCleaner 解析文本的问题 - 文本开头的空格

> ID：13352938
> 
> 赞同：0
> 
> 时间：2012-11-12T22:52:57.227
> 
> 标签：android, htmlcleaner

我可以使用 HTMLCleaner 从网站获取文本。问题是，当我将文本设置为 TextView 时，它会显示文本的开头，上面有很大的空格。[![截屏](../Images/5bfeb6a1a43287788656e08354e77fe1.png)](https://i.stack.imgur.com/tOxB5.png)

我试过`android:gravity`了，但什么也没发生。

请帮忙。

这是我的代码：

```
 private class SiteParser extends AsyncTask<String, Void, String> {

    protected String doInBackground(String... arg) {
        String output = null;

        try {
            HtmlHelper hh = new HtmlHelper(new URL(arg[0]));
            List<TagNode> news = hh.getnewsByClass("TextoPrint");

            for (Iterator<TagNode> iterator = newss.iterator(); iterator
                    .hasNext();) {
                TagNode divElement = (TagNode) iterator.next();
                output = divElement.getText().toString();
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        return output;
    }

    protected void onPostExecute(String output) {

        Bundle bundle=new Bundle();
        bundle.putString("body",output);
        Intent mainIntent = new Intent(act, MyView.class);
        mainIntent.putExtras(bundle);
                startActivity(mainIntent);
        act.finish();

    }
}

public class HtmlHelper {
    TagNode rootNode;

    public HtmlHelper(URL htmlPage) throws IOException, XPatherException {
        HtmlCleaner cleaner = new HtmlCleaner();
        rootNode = cleaner.clean(htmlPage);

    }

    List<TagNode> getnewsByClass(String Classname){
        List<TagNode> newsList = new ArrayList<TagNode>();

        TagNode divElements[] = rootNode.getElementsByName("div", true);
        for (int i = 0; divElements != null && i < divElements.length; i++) {
            String classType =  divElements[i].getAttributeByName("id");
            if (classType != null && classType.equals(Classname)) {
                newsList.add(divElements[i]);
            }
        }

        return newsList;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:57:56.220

尝试使用以下命令删除任何前导（和尾随）空格`trim()`：

```
output = divElement.getText().toString().trim(); 
```

# postgresql - 如何从 Heroku 上托管的 PostgreSQL 数据库下载 Schema？

> ID：13352939
> 
> 赞同：4
> 
> 时间：2012-11-12T22:53:02.793
> 
> 标签：postgresql, heroku, backup, database-schema

我想从托管在 heroku 上的 PostgreSQL 数据库创建一个 ERM-Diagram。数据库本身几乎 20 GB 大，这使得下载整个转储不是一种选择。

有没有办法简单地备份和下载包含外键的模式，以及数据库中每个表的 10 行，随后可以通过`psql`-command 将其恢复到本地数据库中？

我启用了[PG Backups Plus](https://devcenter.heroku.com/articles/pgbackups)插件，但这似乎只能让我用完整的数据集转储整个数据库。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T00:37:29.117

请改用 pg_dump。该`--schema-only|-s`选项可以满足您的需求。

```
pg_dump --schema-only -h host -U user -f schema_dump_file dbname 
```

然后只需手动获取一些您想要的数据。没有简单的方法，我知道或看到，围绕它。

# append - 使一个表单将许多记录附加到一个表中，一个查询中的每条记录？

> ID：13352944
> 
> 赞同：1
> 
> 时间：2012-11-12T22:53:42.617
> 
> 标签：append, cycle

我在这里的第一篇文章，已经潜伏了一段时间，并获得了许多提示。

我有一个足球队的数据库，其中存储了球员的个人记录和财务记录。球员父母（这是一支青年队）必须支付费用才能参加比赛。

我有一张包含球员详细信息的表格，例如姓名、联系方式、加入日期，还有一张包含财务详细信息的表格：他们已支付的金额、他们应支付的金额。这张财务表可能看起来很乱，但我创建的报告把它整理好了，它是一个简单的收入/支出表。

用户必须在每个月的 1 日为每位球员使用一次收入/支出表格，并说明该球员的 20 英镑月费到期，考虑到俱乐部大约有 100 名球员，这很耗时。

我想要一个基于所有玩家查询的表格（或者我可以调整查询以将其过滤到某些组以适应和复制更多表格），用户可以输入日期和金额，这会附加一个财务表中每个玩家的不同记录。

我不知道如何创建 VBA，但如果需要，我可以复制/粘贴代码。

谢谢你的帮助！

标记。

# schema - 数据仓库：动态维度的维度建模？

> ID：13352947
> 
> 赞同：2
> 
> 时间：2012-11-12T22:54:09.517
> 
> 标签：schema, data-warehouse, etl, datamart

我们有一个名为 user_preferences 的表。它们是名称值对，每个用户都可以自定义定义任意数量的偏好。我们想要在我们的数据仓库/数据集市中提供关于这些偏好的报告，就好像它们是维度一样。例如，用户偏好可以是性别、位置等。我们希望找到男性用户在特定时间范围内执行的操作数量。

人们通常如何做到这一点？在不爆炸他们的数据集市的情况下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:37:02.237

这就是所谓的实体-属性-值数据模型，也称为[“每个人都发明它，使用它一次，然后再也不使用它”](http://tkyte.blogspot.com/2009/01/this-should-be-fun-to-watch.html)的数据模型。

不应该使用它的原因有很多，并且应该使用它的一些极端情况。但是，假设您无法将模型更改为更好的模型，那么我[对这个 SO 问题的回答](https://stackoverflow.com/questions/12358709/how-to-build-a-data-warehouse-based-on-an-entity-attribute-value-database/12373599#12373599)应该足以满足您的情况。

# java - 在 AWS 中找不到 Servlet

> ID：13352949
> 
> 赞同：1
> 
> 时间：2012-11-12T22:54:19.123
> 
> 标签：java, gwt, tomcat, amazon-web-services, amazon-elastic-beanstalk

1.  我有一个 GWT 动态 Web 项目，我生成了 .war 文件
2.  我在本地主机的 Tomcat 上测试它，工作正常。
3.  我将它上传到 Amazon Web Services，运行 Apache Tomcat 6 的 Elastic Beanstalk
4.  当我在 AWS 中运行已部署的版本时，它找不到 servlet，就像它们不存在一样
5.  尝试了一个新的 GWT 项目，仍然无法工作：“未找到 Servlet”

我有点卡住了。我不确定这是 GWT 问题还是我对 AWS-Elastic Beanstalk 做错了什么。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T23:38:34.257

所以我在做了很多测试和东西后找到了解决方案：

Tomcat 6 是在弹性 beanstalk 引擎盖下运行的，默认情况下，当您将 XYZ.war 文件上传到 Tomcat 时，上下文 URL 是 (context-root)/XYZ。我正在上传一个名为 MyWebProject.war 的战争，所以对于 Tomcat，它部署在 (context-root)/XYZ 上，但对于弹性 beanstalk，它部署到 YOUR_URL.elasticbeanstalk.com

这显然会导致 web.xml 以一种非常奇怪的方式混淆，所以你总结一下：

**将您的 XYZ.war 重命名为 ROOT.war 并上传。那应该可以解决问题。**

# bash - 用 bash 对逗号分隔的文件进行排序

> ID：13352950
> 
> 赞同：1
> 
> 时间：2012-11-12T22:54:28.810
> 
> 标签：bash, sorting

我有以下内容：

```
 http://www.google.com/site,11/30/2012 6:51:30 PM
    http://www.google.com/site,10/1/2012 6:51:30 PM
    http://www.google.com/site,11/16/2012 6:51:30 PM
    http://www.google.com/site,8/1/2012 6:51:30 PM 
```

我希望它按 MM/DD/YYYY 排序

```
 http://www.google.com/site,8/1/2012 6:51:30 PM
    http://www.google.com/site,10/1/2012 6:51:30 PM
    http://www.google.com/site,11/16/2012 6:51:30 PM
    http://www.google.com/site,11/30/2012 6:51:30 PM 
```

我可以使用 sort 命令、uniq 命令、tr、sed 等。我无法访问 awk。有任何想法吗 ？ `sort -t "," -k1` 有点工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T22:56:28.933

尝试这样做：

```
sort -n -t "," -k 2 file.txt 
```

看

```
man sort 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T23:26:08.820

```
while read line; do
    s=$(date -d "${line#*,}" +%s)
    echo $s $line
done < input.txt | sort -n | cut -d ' ' -f2- 
```

因此，对于每一行，从日期字符串（在逗号之后）创建自 Epoch 以来的秒数，将其用作排序键并将其从结果输出中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T00:04:38.377

我使用 sort 命令做了一些工作，发现了我的问题，这似乎有效：

```
 cat s.txt | sort -n -t"/" -k 4,4n -k 5,5n
    https://www.virustotal.com/,9/16/2012 8:19:00 AM
    https://www.virustotal.com/,10/6/2012 9:20:59 AM
    https://www.virustotal.com/,11/1/2012 9:20:22 AM
    https://www.virustotal.com/,11/4/2012 9:11:02 AM
    https://www.virustotal.com/,11/6/2012 8:50:27 AM
    https://www.virustotal.com/,11/12/2012 6:51:32 PM 
```

反转：

```
 cat s.txt | sort -n -t"/" -k 4,4nr -k 5,5nr
    https://www.virustotal.com/,11/12/2012 6:51:32 PM
    https://www.virustotal.com/,11/6/2012 8:50:27 AM
    https://www.virustotal.com/,11/4/2012 9:11:02 AM
    https://www.virustotal.com/,11/1/2012 9:20:22 AM
    https://www.virustotal.com/,10/6/2012 9:20:59 AM
    https://www.virustotal.com/,9/16/2012 8:19:00 AM 
```

但是，我需要在逗号之后执行此操作，因为带有更多“/”的网站不会像`http://site.com/go/to/somelink,9/16/2012 8:19:00 AM`

# php - Symfony 2 自定义表单验证的好方法，两个选择字段

> ID：13352953
> 
> 赞同：1
> 
> 时间：2012-11-12T22:54:53.790
> 
> 标签：php, forms, symfony, doctrine

在 Symfony2 中，我添加和编辑带有两个选择字段作为下拉列表的表单。第一个包含年份，第二个包含周。所以我想检查选定的年份和星期是否不是过去的时间。我的意思是如果年份：2013\. 和第 5 周，它很好选择并希望坚持下去，但如果年份：2012\. 和第 5 周，那就不好了，这里想对它发出警告。

基本上我现在使用理论实体管理器和 isValid() 来验证表单，然后我将对象保存到数据库中。

我对我在网上找到的许多方法感到有点不安。

所以我想知道哪种方式最适合我验证这些？我的意思是实体验证、非实体以及在哪里搜索它的位置。:)

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T08:01:08.863

我会去CallbackValidation：

[http://symfony.com/doc/2.0/reference/constraints/Callback.html](http://symfony.com/doc/2.0/reference/constraints/Callback.html)

在通话期间会触发验证，`isValid()`因此您将知道它何时失败。

至于验证代码，我认为这应该做的事情（我还没有运行它）：

```
/**
 * @Assert\Callback(methods={"isYearWeekValid"})
 */
class YourEntity
{
     ... here go $year and $week

    public function isYearWeekValid(ExecutionContext $context)
    {
        $firstInYear = \DateTime:createFromFormat('Y-m-d', $this->year . '-01-01');
        $interval = new \DateInterval(sprintf('P%dW', $this->week * 7));
        $firstDayOfWeek = $firstInYear->add($interval); # beware, $firstInYear object     was modified hear as well

        $now = new \DateTime();
        if ( $firstInWeek < $now ){
            $context->addViolation('Invalid year/week combination!', array(), null);
        }else{
            // IT'S OK
        }
    }
} 
```

我使用注释来指定验证，但为此您也可以使用`XML`or `YAML`... 基本上都是一样的...

希望这可以帮助....

# c# - SWIG：如何包装 byte[] 结构成员

> ID：13352957
> 
> 赞同：3
> 
> 时间：2012-11-12T22:55:34.557
> 
> 标签：c#, c, mono, swig

我正在使用 Swig 2.0.7 并尝试使用 SWIG 包装 C 库以从 C# 访问它。这个 C 库通过 USB 与一些自定义硬件通信，因此我需要能够向/从这个库发送/接收原始字节 [] 数据。我可以完全控制这个 C 库，并且可以以任何我需要的方式对其进行修改，以使我的生活更轻松。

我的 Swig 包装器已经取得了很好的进展，我认为我已经得到了它可以很好地编译输入/输出字符串，以及将 byte[] 数据发送到库中。但是，我在尝试读取数据时遇到了问题。

我的数据包采用自定义 C 结构，如下所示：

```
typedef struct message_in message_in;
struct message_in {
    unsigned char* msg_data;    // Pointer to the data buffer received.
    int data_len;               // The total length of the data buffer received.
    char* dev_path;             // The device that sent us this message.
    message_in*  next;          // Used for the linked list
}; 
```

从 C 库中检索此消息的函数如下所示：

```
message_in* hhcPopIncomingMessage(); 
```

我用我的 .i 文件包装它，如下所示：

```
%include "arrays_csharp.i"
// Attempt to use byte[] instead of SWIGTYPE_p_unsigned_char
%apply unsigned char OUTPUT[]  { unsigned char* msg_data }

// Mark this function as owning the memory that it receives, 
//   so that it knows to deallocate
%newobject hhcPopIncomingMessage;

// Mark this structure to use a custom destructor
%extend device_message_in {
    ~device_message_in() {
       hhcFreeMessageIn($self);
    }
}

// Ignore the Linked List member in the data strucutre
%ignore next; 
```

我遇到的主要问题是——虽然它似乎可以很好地生成这个结构——但对于`msg_data`成员来说，它使用的是自动生成的 SWIGTYPE_p_unsigned_char，而不是 byte[]。我应用的类型映射改变了 msg_data 访问器的返回值，但它仍然在内部使用 SWIGTYPE_p_unsigned_char，自然不会编译：

```
 public byte[] msg_data {
    set {
      hiqusbPINVOKE.message_in_msg_data_set(swigCPtr, value);
    } 
    get {
      IntPtr cPtr = hiqusbPINVOKE.message_in_msg_data_get(swigCPtr);
      SWIGTYPE_p_unsigned_char ret = (cPtr == IntPtr.Zero) ? null : new SWIGTYPE_p_unsigned_char(cPtr, false);
      return ret;
    } 
  } 
```

（以上编译失败，出现错误：

```
error CS0029: Cannot implicitly convert type `byte[]' to `System.IntPtr'
error CS0029: Cannot implicitly convert type `SWIGTYPE_p_unsigned_char' to `byte[]' 
```

从我的数据结构中读取缓冲区作为字节 [] 的正确方法是什么？

在此先感谢您的帮助！

**编辑更新：** 我想我想出了我希望它生成的代码——现在我只是不知道如何让 SWIG 生成该代码。

它当前生成的内容：

```
 public byte[] msg_data {
    set {
      hiqusbPINVOKE.hiq_hid_device_message_in_msg_data_set(swigCPtr, value);
    } 
    get {
      IntPtr cPtr = hiqusbPINVOKE.hiq_hid_device_message_in_msg_data_get(swigCPtr);
      SWIGTYPE_p_unsigned_char ret = (cPtr == IntPtr.Zero) ? null : new SWIGTYPE_p_unsigned_char(cPtr, false);
      return ret;
    } 
  } 
```

我希望它产生什么：

```
 public byte[] msg_data {
    // No 'set' member is needed, as this value is only ever read from this structure.
    get {
      int len = this.data_len;
      byte[] managedArray = new byte[len];
  IntPtr cPtr = hiqusbPINVOKE.hiq_hid_device_message_in_msg_data_get(swigCPtr);
      System.Runtime.InteropServices.Marshal.Copy(cPtr, managedArray, 0, len);
      return managedArray;
    } 
  } 
```

# javascript - AJAX 返回响应为 0，本地调用状态为 4

> ID：13352958
> 
> 赞同：1
> 
> 时间：2012-11-12T22:55:39.703
> 
> 标签：javascript, ajax, xmlhttprequest

我正在尝试实现一个通过 XMLHttpRequest 调用本地 php 文件以获取 json 数据的网站。从 HTML 表单调用登录函数。文件 /var/www/picnit/api/member.api 确实存在并且具有足够的权限，并且已经使用 Chrome 的 Postman 应用程序进行了测试。

```
//URL for member functions
var memberurl='/picnit/api/member.php';

//Request to be sent to the middleware
var request;

function login() {
    //Get and validate user inputs
    var username = $("input#Username").val();
    var password = $("input#Password").val();
    //Validation code omitted

    //Getting here means that the inputs validated

    //Request to be sent to the middleware
    request = new XMLHttpRequest();

    //Create function that handles response
    request.onreadystatechange = function () {
        //Make sure request is ready, we only care about when done
        if(request.readyState === 4) {
            //Good data, proceed to login
            if(request.status === 200) {
                alert('200');
            }

            //Invalid username/password combo
            else if(request.status === 204) {
                alert('204');
            }

            //Our request messed up
            else if(request.status === 400) {
                alert('400');
            }

            //Something else went wrong
            else {
                alert('Unknown error: ' + request.status);
            }
        }
    };

    //Open request
    request.open('POST', memberurl, true);

    //Send request
    request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    var parms = 'username='+username+'&password='+password;
    request.send(parms);

    return false;
} 
```

这总是返回一个带有“未知错误：0”的警报，我不知道为什么。我认为它不能跨域，因为它位于同一服务器（AWS EC2 实例）上。而且我不完全确定相同域策略是什么......

我一直在这里搜索其他帖子，但尚未找到答案。感谢您在高级方面的帮助。

# javascript - 悬停过渡不起作用

> ID：13352959
> 
> 赞同：0
> 
> 时间：2012-11-12T22:55:42.700
> 
> 标签：javascript, html, css

这是我的 jsfiddle 代码 [http://jsfiddle.net/jspence29/VqZSw/](http://jsfiddle.net/jspence29/VqZSw/) 但似乎它不起作用所以我会给你我的代码

```
#links ul

{
  margin-left: auto;
  position: fixed;
  margin-right: auto;
}

#links ul li

{
  margin-left: 200px;
  font-family: sans-serif:
  background-color: #fff;
  display: inline;
  width: 25px;
}

#links ul li a 

{
  background-color: #fff;
  opacity: 0.8;
  filter: alpha(opacity=80);
  color: #ffffff;
  text-align: center;
  width: 25px;
  padding: 10px;
  font-family: sans-serif;
  text-decoration: none;
  position: relative;
  top: 180px;
  overflow: hidden;
  transition:width .5s;
  -moz-transition:width .5s; /* Firefox 4 */
  -webkit-transition:width .5s; /* Safari and Chrome */
  -o-transition:width .5s; /* Opera */
}

#links ul li a:hover

{
  color: #000;
  width: 50px;
}
</style>

<head>
<body>

<div id="background" >
<div id="menuButton" onclick="showMenu()" >
<p><span style="cursor:pointer">Menu </span></p>
</div>
<div id="menu" style="display: none;">
<h1> Singapore </h1>
<p>ever onward, singapore </p>
<ul>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" > Gallery <span class="show"> 
Click to see pictures of the most elegant city in the world </span> </a> </li>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" > Tour <span class="show">
Click to take a tour of the one of a kind singapore</span> </a> </li>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" > Facts <span class="show"> 
Click to learn astounding facts of the one and only singapore</span> </a> </li>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" > Author <span class="show"> 
Click to learn about me, and see my works cited page </span></a> </li>
</ul>
</div><!--Menu-->
<div id="links" >
<ul>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" >  Gallery </a></li>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" > Tour </a></li>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" >  Facts </a></li>
<li> <a href="http://www.spencedesign.netau.net/singapore.html" >  Author </a></li>
</ul>
</div>
</div><!--Background-->

</body>
</html> 
```

以及指向我的页面的链接[http://www.spencedesign.netau.net/singaporehomemenu.html](http://www.spencedesign.netau.net/singaporehomemenu.html)

所以，我的问题是，当您将鼠标悬停在顶部的按钮上时，宽度会发生变化。但是当你在底部链接上这样做时，它不会。它应该改变，因为我使用了相对相同的代码。所以我不知道问题是什么。我已经仔细检查了大约半小时的代码，但找不到修复程序。我知道我的 CSS/HTML 编码很粗略，但我是初学者，我认为我通过你们学习得越多，我就会越好。谢谢你的时间，如果你看过我的其他帖子，我很抱歉发了这么多，我想你可以说我在我的网站计划中超出了我的头脑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T01:26:50.813

过渡效果很好。但是，`A`元素是内联元素。宽度被忽略了。添加`display: block;`就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:12:13.420

你在哪里：

```
 #links ul li a:hover 
```

如果您还添加一个...

```
 #links ul a:hover 
```

当然有相同的样式。

# php - 安全性：使用 ssh 部署 API - PHP & Linux

> ID：13352969
> 
> 赞同：0
> 
> 时间：2012-11-12T22:56:28.293
> 
> 标签：php, security, api, ssh

我计划部署一个使用 PHP 开发并在 Centos Linux 系统上运行的 REST API。应用程序不断发展，API 现在提供对潜在敏感数据的访问。我不想使用像 oAuth 这样的复杂解决方案，并且想知道是否有更简单的解决方案涉及 ssh 证书。访问此 API 的客户端包括标准桌面以及 iPhone 和 Android 设备。我意识到这不完全是一个编程问题，但在某种程度上它是，因为它是关于安全地访问我正在开发的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T02:55:25.060

您可能是指客户端 SSL 证书。它将起作用，您未来唯一可能遇到的麻烦是管理证书 - 颁发、撤销、分发等。显然，只有当用户群很大或经历了很多变化时才会出现这种情况。OAuth 没有这个问题。

检查有关如何设置的任何 Google 结果，例如[http://www.impetus.us/~rjmooney/projects/misc/clientcertauth.html](http://www.impetus.us/~rjmooney/projects/misc/clientcertauth.html)看起来不错。

# c# - ASP.NET 数据绑定字段 -> 如何检查复选框字段

> ID：13352970
> 
> 赞同：1
> 
> 时间：2012-11-12T22:56:31.480
> 
> 标签：c#, asp.net, gridview, sqldatasource, databound

我有一个问题，我找不到答案。在 VS2012 中，我用**C#**创建了一个 ASP.NET 网站。

我有我的会员提供程序设置和工作，现在我想创建一个管理页面，管理员可以在其中编辑角色并阻止用户。从服务器资源管理器中，我将 asp_membership 表拖到页面上，它自己创建了。

我删除了一些不相关的列，并添加了一个带有两个按钮**的 itemtemplatefield 。**先看一下代码：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
    DataKeyNames="UserId" DataSourceID="SqlDataSource1" 
    EmptyDataText="There are no data records to display." 
    OnSelectedIndexChanged="GridView1_SelectedIndexChanged" >
    <Columns>
        <asp:CommandField ShowDeleteButton="True" />
        <asp:TemplateField HeaderText="Block users">
            <ItemTemplate>
                <asp:Button runat="server" ID="btnBlock" CommandName="Block"
                    Text="Block" OnClick="btnBlock_Click" Visible='<%# Convert.ToBoolean(Eval("IsLockedOut").ToString()) %>'/>
                <asp:Button runat="server" ID="btnDeblock" CommandName="Deblock"
                    Text="Deblock" OnClick="bntDeblock_Click" Visible='<%# Convert.ToBoolean(Eval("IsLockedOut").ToString()) %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:BoundField DataField="UserId" HeaderText="User id" ReadOnly="True" 
            SortExpression="UserId" />
        <asp:BoundField DataField="Email" HeaderText="Email" SortExpression="Email" />
        <asp:CheckBoxField DataField="IsApproved" HeaderText="Confirmed" 
            SortExpression="IsApproved" />
        <asp:BoundField DataField="CreateDate" HeaderText="Created" 
            SortExpression="CreateDate" />
        <asp:BoundField DataField="LastLoginDate" HeaderText="Last login" 
            SortExpression="LastLoginDate" />
        <asp:CheckBoxField DataField="IsLockedOut" HeaderText="Locked" 
            SortExpression="IsLockedOut" />
        <asp:BoundField DataField="LastLockoutDate" HeaderText="Last lockout" 
            SortExpression="LastLockoutDate" />
        <asp:BoundField DataField="FailedPasswordAttemptCount" 
            HeaderText="Failed logins" 
            SortExpression="FailedPasswordAttemptCount" />
        <asp:BoundField DataField="Comment" HeaderText="Comments" 
            SortExpression="Comment" />
    </Columns>
</asp:GridView> 
```

我正在尝试制作两个按钮（阻止和解除阻止），如果复选框字段“IsLockedOut”被禁用并且不可见，如果......你明白了这一点。

当我加载页面时，按钮都消失了。我假设错误在这里： <%# Convert.ToBoolean(Eval("IsLockedOut").ToString()) %>? 有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:01:12.927

你不应该需要`.ToString()`或`Convert.ToBoolean()`; .NET 几乎可以在后台为您做到这一点。

```
Visible='<%# Eval("IsLockedOut") %>' 
```

如果您将 a 添加`<asp:Label />`到您的`ItemTemplate`并按上述方式绑定`Text`属性，您会看到什么？你的`IsLockedOut`财产是`Nullable<Boolean>`? 如果是，你可以试试这个：

```
Visible = '<%# Eval("IsLockedOut") ?? true %>' 
```

或者

```
Visible = '<%# ((Nullable<bool>)Eval("IsLockedOut")).GetValueOrDefault(true) %>' 
```

# java - 将文件转换为字节数组，反之亦然

> ID：13352972
> 
> 赞同：37
> 
> 时间：2012-11-12T22:56:34.173
> 
> 标签：java, arrays

我发现了许多将文件转换为字节数组并将字节数组写入存储文件的方法。

我想要的是转换`java.io.File`为字节数组，然后将字节数组转换回`java.io.File`.

我不想把它写到存储中，如下所示：

```
//convert array of bytes into file
FileOutputStream fileOuputStream = new FileOutputStream("C:\\testing2.txt"); 
fileOuputStream.write(bFile);
fileOuputStream.close(); 
```

我想以某种方式执行以下操作：

```
File myFile = ConvertfromByteArray(bytes); 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-11-12T23:17:28.197

否则试试这个：

## 将文件转换为字节

```
 import java.io.File;
  import java.io.FileInputStream;
  import java.io.FileNotFoundException;
  import java.io.IOException;

   public class Temp {

        public static void main(String[] args) {

         File file = new File("c:/EventItemBroker.java");

         byte[] b = new byte[(int) file.length()];
         try {
               FileInputStream fileInputStream = new FileInputStream(file);
               fileInputStream.read(b);
               for (int i = 0; i < b.length; i++) {
                           System.out.print((char)b[i]);
                }
          } catch (FileNotFoundException e) {
                      System.out.println("File Not Found.");
                      e.printStackTrace();
          }
          catch (IOException e1) {
                   System.out.println("Error Reading The File.");
                    e1.printStackTrace();
          }

       }
    } 
```

## 将字节转换为文件

```
 public class WriteByteArrayToFile {

         public static void main(String[] args) {

            String strFilePath = "Your path";
            try {
                 FileOutputStream fos = new FileOutputStream(strFilePath);
                 String strContent = "Write File using Java ";

                 fos.write(strContent.getBytes());
                 fos.close();
           }
          catch(FileNotFoundException ex)   {
                 System.out.println("FileNotFoundException : " + ex);
          }
         catch(IOException ioe)  {
                 System.out.println("IOException : " + ioe);
          }

       }
     } 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-12T23:14:28.920

我认为您误解了`java.io.File`该类的真正含义。它只是系统上文件的一种表示，即它的名称、它的路径等。

您甚至查看过该`java.io.File`课程的 Javadoc 吗？看看[这里](http://docs.oracle.com/javase/7/docs/api/java/io/File.html) 如果您检查它具有的字段或方法或构造函数参数，您会立即得到提示，它只是 URL/路径的表示。

[Oracle 在其Java 文件 I/O 教程](http://docs.oracle.com/javase/tutorial/essential/io/file.html)中提供了相当广泛的教程，其中也包含最新的 NIO.2 功能。

[使用 NIO.2，您可以使用java.nio.file.Files.readAllBytes()](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#readAllBytes%28java.nio.file.Path%29)在一行中读取它。

同样，您可以使用[java.nio.file.Files.write()](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#write%28java.nio.file.Path,%20byte%5B%5D,%20java.nio.file.OpenOption...%29)将所有字节写入字节数组中。

**更新**

由于该问题被标记为 Android，因此更传统的方法是将其包装`FileInputStream`在 a 中`BufferedInputStream`，然后将其包装在 a 中`ByteArrayInputStream`。这将允许您阅读`byte[]`. 同样，它们的对应物存在于`OutputStream`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-12T23:00:56.127

你不能这样做。A`File`只是在文件系统中引用文件的一种抽象方式。它本身不包含任何文件内容。

如果您尝试创建一个可以使用`File`对象引用的内存中文件，那么您将无法做到这一点，正[如此线程](https://stackoverflow.com/questions/4777753/java-in-memory-file-structure)、[此线程](https://stackoverflow.com/questions/7083698/create-a-file-object-in-memory-from-a-string-in-java)和许多其他地方所解释的那样。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-12-10T21:05:33.640

Apache FileUtil 提供了非常方便的方法来进行转换

```
try {
    File file = new File(imagefilePath);
    byte[] byteArray = new byte[file.length()]();
    byteArray = FileUtils.readFileToByteArray(file);  
 }catch(Exception e){
     e.printStackTrace();

 } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-12T23:06:24.177

没有这样的功能，但您可以通过[File.createTempFile()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html)使用临时文件。

```
File temp = File.createTempFile(prefix, suffix);
// tell system to delete it when vm terminates.
temp.deleteOnExit(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-14T03:11:30.550

您不能对主要是智能文件路径的 File 执行此操作。你能重构你的代码，让它声明变量，并传递参数，类型为OutputStream而不是FileOutputStream吗？如果是这样，请参阅类[java.io.ByteArrayOutputStream](http://docs.oracle.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html)和[java.io.ByteArrayInputStream](http://docs.oracle.com/javase/6/docs/api/java/io/ByteArrayInputStream.html)

```
OutputStream outStream = new ByteArrayOutputStream();
outStream.write(whatever);
outStream.close();
byte[] data = outStream.toByteArray();
InputStream inStream = new ByteArrayInputStream(data);
... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-28T19:07:23.460

**1- 传统方式**

传统的转换方式是通过使用 InputStream 的 read() 方法，如下所示：

```
public static byte[] convertUsingTraditionalWay(File file)
{
    byte[] fileBytes = new byte[(int) file.length()]; 
    try(FileInputStream inputStream = new FileInputStream(file))
    {
        inputStream.read(fileBytes);
    }
    catch (Exception ex) 
    {
        ex.printStackTrace();
    }
    return fileBytes;
} 
```

**2-Java NIO**

在 Java 7 中，您可以使用 nio 包的 Files 实用程序类进行转换：

```
public static byte[] convertUsingJavaNIO(File file)
{
    byte[] fileBytes = null;
    try
    {
        fileBytes = Files.readAllBytes(file.toPath());
    }
    catch (Exception ex) 
    {
        ex.printStackTrace();
    }
    return fileBytes;
} 
```

**3- Apache Commons IO**

除了 JDK，您还可以通过 2 种方式使用 Apache Commons IO 库进行转换：

3.1。IOUtils.toByteArray()

```
public static byte[] convertUsingIOUtils(File file)
{
    byte[] fileBytes = null;
    try(FileInputStream inputStream = new FileInputStream(file))
    {
        fileBytes = IOUtils.toByteArray(inputStream);
    }
    catch (Exception ex) 
    {
        ex.printStackTrace();
    }
    return fileBytes;
} 
```

3.2\. FileUtils.readFileToByteArray()

```
public static byte[] convertUsingFileUtils(File file)
{
    byte[] fileBytes = null;
    try
    {
        fileBytes = FileUtils.readFileToByteArray(file);
    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
    return fileBytes;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-29T14:18:47.030

## 服务器端

```
@RequestMapping("/download")
public byte[] download() throws Exception {
    File f = new File("C:\\WorkSpace\\Text\\myDoc.txt");
     byte[] byteArray = new byte[(int) f.length()];
        byteArray = FileUtils.readFileToByteArray(f);
        return byteArray;
} 
```

## 客户端

```
private ResponseEntity<byte[]> getDownload(){
    URI end = URI.create(your url which server has exposed i.e. bla 
              bla/download);
    return rest.getForEntity(end,byte[].class);

}

public static void main(String[] args) throws Exception {

    byte[] byteArray = new TestClient().getDownload().getBody();
    FileOutputStream fos = new 
    FileOutputStream("C:\\WorkSpace\\testClient\\abc.txt");

     fos.write(byteArray);
     fos.close(); 
     System.out.println("file written successfully..");

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-14T05:01:50.403

```
//The file that you wanna convert into byte[]
File file=new File("/storage/0CE2-EA3D/DCIM/Camera/VID_20190822_205931.mp4"); 

FileInputStream fileInputStream=new FileInputStream(file);
byte[] data=new byte[(int) file.length()];
BufferedInputStream bufferedInputStream=new BufferedInputStream(fileInputStream);
bufferedInputStream.read(data,0,data.length);

//Now the bytes of the file are contain in the "byte[] data"
/*If you want to convert these bytes into a file, you have to write these bytes to a 
certain location, then it will make a new file at that location if same named file is 
not available at that location*/
FileOutputStream fileOutputStream =new FileOutputStream(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).toString()+"/Video.mp4");
fileOutputStream.write(data);
 /* It will write or make a new file named Video.mp4 in the "Download" directory of 
    the External Storage */ 
```

# php - 创建新实例失败 PHP

> ID：13352975
> 
> 赞同：0
> 
> 时间：2012-11-12T22:56:41.397
> 
> 标签：php, oop, serialization, constructor, amfphp

我对 PHP 比较陌生并且取得了一些不错的成功，但是我遇到了这个问题：

如果我尝试创建 GenericEntryVO 类的新实例，我会收到 500 错误，几乎没有有用的错误信息。但是，如果我使用通用对象作为结果，则不会出现错误。我希望能够将此对象转换为 GenericEntryVO，因为我正在使用 AMFPHP 与 Flex 客户端通信序列化数据。

我已经阅读了几种在 PHP 中创建构造函数的不同方法，但是对于 PHP 5.4.4，建议使用类 Foo 的典型“公共函数 Foo()”

```
//in my EntryService.php class
public function getEntryByID($id)
{
    $link = mysqli_connect("localhost", "root", "root", "BabyTrackingAppDB");

    if (mysqli_connect_errno())
    {
        printf("Connect failed: %s\n", mysqli_connect_error());
        exit();
    }

    $query = "SELECT * FROM Entries WHERE id = '$id' LIMIT 1";

    if ($result = mysqli_query($link, $query))
    {
        // $entry = new GenericEntryVO(); this is where the problem lies!

        while ($row = mysqli_fetch_row($result))
        {
            $entry->id = $row[0];
            $entry->entryType = $row[1];
            $entry->title = $row[2];
            $entry->description = $row[3];
            $entry->value = $row[4];
            $entry->created = $row[5];
            $entry->updated = $row[6];
        }
    }

    mysqli_free_result($result);
    mysqli_close($link);

    return $entry;
}

//my GenericEntryVO.php class 
<?php

class GenericEntryVO
{
    public function __construct()
    {
    }

    public $id; 
    public $title;
    public $entryType;
    public $description;
    public $value;

    public $created;
    public $updated;

    // public $properties;
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:23:54.630

再次感谢@eis 的领导。我没有意识到您可以访问 PHP 中的错误日志。作为 as3/Flex 开发人员，我习惯于使用带断点的调试器。不确定 PHP 开发人员是否有类似 Flash Builder 的 IDE。

在看到通用 500 错误是找到正确的类来实例化的问题后，我自己做了一些调查。我需要输入 require_once realpath(dirname( **FILE** ).'/vo/GenericEntryVO.php'); 在班级的顶部。我使用 as3 语法并期望文件路径相对于正在处理的当前文件。这是我找到此解决方案的地方：

[如何格式化 PHP include() 绝对（而不是相对）路径？](https://stackoverflow.com/questions/344823/how-do-i-format-a-php-include-absolute-rather-than-relative-path)这是关于一个名为@Zoredache 的人发表的第 4 或第 5 条评论

我不确定这是否是最好的解决方案，但它让我重新启动并运行，我的数据对象被序列化以在 Flex 中使用。

# python - 在双向链表中间插入 - Python

> ID：13352976
> 
> 赞同：0
> 
> 时间：2012-11-12T22:56:42.430
> 
> 标签：python, list, linked-list

我是 stackoverflow 和 Python 语言的新手，有一个问题。我知道如何在 Python 中实现单链表，但是在使用双链表时遇到了问题，更具体地说是插入到双链表的中间。谁能帮我写代码来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T23:54:16.863

我也是，我是 Python 新手，但我希望我能帮到你。因此，如果我正确地回答了您的问题，假设您有一些（经典）链表实现，如下所示：

```
# Simple LinkedList class
class LinkedList:
    def __init__(self, data, prev=None, next=None):
        self.data = data
        self.prev = prev
        self.next = next

    # Just a string representation
    def __str__(self):
        if self.next:
            return '%s %s' % (str(self.data), self.next.__str__())
        else:
            return '%s' % str(self.data) 
```

通过同时从末端迭代到中间，您可以轻松地将元素插入到中间，知道链表的末端。当迭代器相交时，添加元素：

```
# Insert to middle logic
def insertToMiddle(data, left, right):
    # Iterate
    while True:
        # Test for intersection
        if left.next is right:
            node = LinkedList(data, left, right)
            left.next = node
            right.prev = node
            return
        elif left is right:
            node = LinkedList(data, left.prev, right.next)
            left.next = node
            right.next.prev = node
            return

        # Next iteration
        left = left.next
        right = right.prev

        # This doesn't actually execute for a right call
        if not left or not right:
            return 
```

下面，您可以看到插入前后的链表创建及其表示：

```
# Sample list creation
node1 = LinkedList(1)
node2 = LinkedList(2,node1)
node3 = LinkedList(3,node2)
node4 = LinkedList(4,node3)
node1.next = node2
node2.next = node3
node3.next = node4

# Test
print node1 
insertToMiddle(5, node1, node4)
print node1
insertToMiddle(6, node1, node4)
print node1
insertToMiddle(7, node1, node4)
print node1 
```

输出：

```
1 2 3 4                #initial
1 2 5 3 4              #inserted 5
1 2 5 6 3 4            #inserted 6, notice it's right to middle
1 2 5 7 6 3 4          #inserted 7 
```

备注：如果你的列表有奇数个元素（比如 2 3 4），插入到中间是不确定的，所以上面的函数将立即添加到中间的右边（2 3 elem 4）

# php - 用随机替换替换字符串的随机单词

> ID：13352982
> 
> 赞同：1
> 
> 时间：2012-11-12T22:57:02.773
> 
> 标签：php, arrays, string, function, preg-match-all

我正在开发一个脚本，它需要一篇文章，在文章中搜索“关键字”，然后用锚链接随机替换该关键字。

我让脚本正常工作，但是我需要能够为函数循环并插入随机位置的“替换”数组。

所以第一个随机位置将获得锚链接#1。第二个随机位置将获得锚链接#2。第三个随机位置将获得锚链接#3。ETC...

我在这里找到了我的问题的一半答案： [PHP replace a random word of a string](https://stackoverflow.com/questions/10704460/php-replace-a-random-word-of-a-string)

```
public function replace_random ($str, $search, $replace, $n) {

    // Get all occurences of $search and their offsets within the string
    $count = preg_match_all('/\b'.preg_quote($search, '/').'\b/', $str, $matches, PREG_OFFSET_CAPTURE);

    // Get string length information so we can account for replacement strings that are of a different length to the search string
    $searchLen = strlen($search);
    $diff = strlen($replace) - $searchLen;
    $offset = 0;

    // Loop $n random matches and replace them, if $n < 1 || $n > $count, replace all matches
    $toReplace = ($n < 1 || $n > $count) ? array_keys($matches[0]) : (array) array_rand($matches[0], $n);
    foreach ($toReplace as $match) {
        $str = substr($str, 0, $matches[0][$match][1] + $offset).$replace.substr($str, $matches[0][$match][1] + $searchLen + $offset);
        $offset += $diff;
    }

    return $str;

} 
```

所以我的问题是，如何更改此函数以接受 $replace 变量的数组？

**编辑** 我还尝试从 mt_rand 获取随机数组键，它从替换数组中输出我的替换，但它仍然只在整个内容中添加一个替换。我希望该函数为它找到的 $search 变量的每个实例选择一个“关键字”。

```
public function replace_random ($str, $search, $replace, $n) {

    // Get all occurences of $search and their offsets within the string
    $count = preg_match_all('/\b'.preg_quote($search, '/').'\b/', $str, $matches, PREG_OFFSET_CAPTURE);

    // Get string length information so we can account for replacement strings that are of a different length to the search string
    $searchLen = strlen($search);
    $diff = strlen($replace) - $searchLen;
    $offset = 0;

    $searchCount = count($replace);
    $arrayNum = mt_rand(0, 4);

    // Loop $n random matches and replace them, if $n < 1 || $n > $count, replace all matches
    $toReplace = ($n < 1 || $n > $count) ? array_keys($matches[0]) : (array) array_rand($matches[0], $n);
    foreach ($toReplace as $match) {
        $str = substr($str, 0, $matches[0][$match][1] + $offset).$replace[$arrayNum].substr($str, $matches[0][$match][1] + $searchLen + $offset);
        $offset += $diff;
    }

    return $str;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:50:18.630

解决方案原来我需要在 foreach 循环中添加一个变量：

```
$replaceRand    =   $replace[array_rand($replace)]; 
```

并在 $str 变量中调用它：

```
$str = substr($str, 0, $matches[0][$match][1] + $offset).$replaceRand.substr($str, $matches[0][$match][1] + $searchLen + $offset); 
```

整个代码最终是：

```
public function replace_random ($str, $search, $replace, $n) {

    // Get all occurences of $search and their offsets within the string
    $count = preg_match_all('/\b'.preg_quote($search, '/').'\b/', $str, $matches, PREG_OFFSET_CAPTURE);

    // Get string length information so we can account for replacement strings that are of a different length to the search string
    $searchLen = strlen($search);
    $diff = strlen($replace) - $searchLen;
    $offset = 0;

    // Loop $n random matches and replace them, if $n < 1 || $n > $count, replace all matches
    $toReplace = ($n < 1 || $n > $count) ? array_keys($matches[0]) : (array) array_rand($matches[0], $n);
    foreach ($toReplace as $match) {
        $replaceRand    =   $replace[array_rand($replace)];
        $str = substr($str, 0, $matches[0][$match][1] + $offset).$replaceRand.substr($str, $matches[0][$match][1] + $searchLen + $offset);
        $offset += $diff;
    }

    return $str;

} 
```

# php - 会话劫持预防...我的脚本能走多远？额外的预防程序？

> ID：13352988
> 
> 赞同：1
> 
> 时间：2012-11-12T22:57:29.183
> 
> 标签：php, session, session-hijacking

当用户登录当前会话时，设置了变量

```
$_SESSION['user']['timeout'] = time();
$_SESSION['user']['ip'] = $_SERVER['REMOTE_ADDR'];
$_SESSION['user']['agent'] = $_SERVER['HTTP_USER_AGENT']; 
```

在我的 common.php 页面（所有 php 页面都需要）中，我使用了以下脚本，每次用户处于活动状态时都会重置一个 15 分钟的计时器，此外还会检查 IP 地址并检查 user_agent，如果它们不匹配的话当他们第一次登录/第一次设置会话时，会话被取消，并且不活动长达 15 分钟，会话也被取消。

...我所做的是防止会话劫持的好方法，而且它是否安全，或者是否足够？如果没有，还能做什么？

```
if(!empty($_SESSION['user'])){  
    if ($_SESSION['user']['timeout'] + 15 * 60 < time()) {
        unset($_SESSION['user']); 
        } else {
        $_SESSION['user']['timeout'] = time();
        if($_SESSION['user']['ip'] != $_SERVER['REMOTE_ADDR']){
            unset($_SESSION['user']); 
        }
        if($_SESSION['user']['agent'] != $_SERVER['HTTP_USER_AGENT']){
            unset($_SESSION['user']); 
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:35:52.000

通过 15 个缩影的限制，您可以确保如果会话被劫持，攻击者无法长时间使用它，而用户离开他/她的机器或关闭它（并且没有注销）。但是用户工作的时间和攻击者劫持了会话的时间呢？检查 ip 地址是个好主意，但它有一个小限制。而用户没有静态IP地址并且他/她已经从网络断开并重新连接。将为其分配一个新的 IP 地址。这种情况迫使他的会话过期，而他是有效用户。此外，这个技巧对于与有效用户位于同一个私有 LAN 中并且他们都位于具有公共 IP 地址的网关后面的攻击者没有任何作用。因为它们在您的服务器中都具有相同的 IP 地址（NAT 或网关的 IP 地址）。在我看来，你所做的很好。但最好使网站免受 XSS 和 CSRF 攻击。防止客户端中的 javascript 注入。如果防止任何此类攻击非常重要，那么还可以使用 ssl 来保护网络嗅探器的安全。

# php - 子目录中的 CodeIgniter 站点，htaccess 文件可能会干扰主目录中的 htaccess 文件？

> ID：13352995
> 
> 赞同：4
> 
> 时间：2012-11-12T22:57:41.147
> 
> 标签：php, .htaccess, codeigniter, routing, rewrite

在我的 CodeIgniter 站点（托管在 GoDaddy 上）中，导航到任何页面，但索引给了我这个错误：

> 未指定输入文件。

谷歌搜索，似乎原因必须与我的 .htaccess 情况有关。设置的方式，也许这最终会改变，是我的 CI 站点位于主域的子目录中。CI 站点和主域都有自己的 .htaccess 文件。CI htacess 文件位于应用程序文件夹中：

```
<IfModule mod_rewrite.c>
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /SubDomain/index.php?$1 [L]
</IfModule> 
```

这是主要的 htaccess 文件，它比 CI 高两级，因此读取：

```
RewriteEngine on
RewriteCond %{SERVER_PORT} 80
rewriterule ^(.*)$ https://www.MainDomain.org/$1 [r=301,nc] 
```

恐怕这两组重写规则相互冲突，我真的不知道该怎么办。我可以更改任何一个 htaccess 文件，并且真的很想让他们和平与和谐地一起工作。然而，这也可能与 htaccess 无关。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T14:03:59.223

CI`.htaccess`不应该在应用程序文件夹中；它应该在文件夹的根`SubDomain`目录中。例如`/public_html/SubDomain/.htaccess`

此外，在这方面`.htaccess`，您需要设置`RewriteBase`：

```
<IfModule mod_rewrite.c>
    Options +FollowSymLinks
    RewriteEngine on
    RewriteBase /SubDomain
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?$1 [L]
</IfModule> 
```