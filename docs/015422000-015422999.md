# StackOverflow 问答 15422000-15422999

# angularjs - AngularJs e2e 测试：如何让 expect() 处理非未来对象？

> ID：15422003
> 
> 赞同：0
> 
> 时间：2013-03-14T23:19:21.863
> 
> 标签：angularjs, functional-testing, karma-runner

# 问题

我想`expect()`在我的 e2e 测试中使用断言某些东西，但只`expect()`在`Future`'s 上运行。我怎样才能让它工作：

```
expect(true).toBe(true); 
```

# 细节

上面的`expect()`调用在单元测试中工作正常，但`expect()`在 e2e 测试中是不同的野兽。在我的情况下，我需要验证是否未选中所有单选按钮。这是代码：

```
 //first grab all radios in my DOM
    element('.hhmInHousehold div > input[type="radio"]', 'member status').query(function(radios,doneFn){
            //cycle through each radio to check if it is checked
            angular.forEach(radios, function(radio, key)
            {
                if(radio.checked !== false) {
                    //in my perfect world this if check, then throw 
                    //statement should just be:  expect(radio.checked).toBe(false);
                    throw "expected radio checked to not be checked";
                }

            });

            doneFn();
        }); 
```

在上面，我做了一个不优雅的 if 语句，然后抛出一个异常。有一个更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T04:18:28.880

我不知道使用未来作为输入的简单方法，`expect`但您可以执行以下操作以确保未选中所有复选框：

```
expect(element('input:checked').count()).toBe(0); 
```

如果您还没有在[这里](http://docs.angularjs.org/guide/dev_guide.e2e-testing)看到它，请参阅 E2E API 的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T12:43:15.683

我设法执行以下操作来检查元素是否隐藏：

```
expect(element("#id_element").css("display")).toBe("none"); 
```

并检查此元素是否可见：

```
expect(element("#id_element").css("display")).not().toBe("none"); 
```

我相信这不是最好的方法。但这很简单，它对我有用。

干杯!

# macos - 点击正在发送到另一个应用程序的 AppleEvents

> ID：15422004
> 
> 赞同：1
> 
> 时间：2013-03-14T23:19:24.307
> 
> 标签：macos, applescript, macos-carbon, appleevents

是否可以像点击 Quartz Events 一样监控或点击发送到进程的 Apple 事件流？

我有一个应用程序与另一个应用程序对话以强制它导入文件，但它以通过菜单或 UI 脚本无法使用的方式执行此操作，我正在尝试追踪它是如何做到这一点的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T06:59:59.637

您需要以编程方式执行此操作还是手动/交互式可以？如果手动可以，这里有一些方法：

尝试使用 AppleScript Editor 录制目标应用程序。

[尝试使用Technical Note TN2124: Mac OS X Debugging Magic](https://developer.apple.com/library/mac/#technotes/tn2124/_index.html) under [Apple Events](https://developer.apple.com/library/mac/technotes/tn2124/_index.html#//apple_ref/doc/uid/DTS10003391-CH1-SECAE)中列出的技术。例如，将环境变量设置`AEDebugReceives`为`1`并在该环境下运行目标应用程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-17T01:16:30.047

AE事件没有这样的水龙头AFAIK*我很高兴被证明是错误的*

您可以点击 NSDistributed 通知！

# git - 如何在使用 PowerGen 构建的 PowerBuilder 项目中设置可执行文件的 Productverion 和 Fileversion 属性

> ID：15422006
> 
> 赞同：1
> 
> 时间：2013-03-14T23:19:28.497
> 
> 标签：git, automation, powerbuilder, powerbuilder-build-deploy

我即将将我们的 PowerBuilder 应用程序的 Continues Integration 构建环境从 OrcaScript 11 更改为 PowerGen 8.5，因为在将源代码控制从 TFS 更改为 Git 之后，完整的 Bootstrap 导入似乎是唯一的解决方案。

应用程序会构建，但它始终会生成版本为 1.0.0.1 的可执行文件。

在 OrcaScript 中，可以通过添加以下内容在 Orca 文件中进行设置：

```
set exeinfo property productversion EXE_VER
set exeinfo property fileversion EXE_VER 
```

其中 EXE_VER 是通过命令行发送的输入参数：

```
orcascr110.exe /D EXE_VER="10.3.2" 
```

但我现在的问题是，在使用 E. Crane Computing 的 PowerGen 8.5 进行构建时如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:00:12.663

更简单，涵盖更多属性，但它使用单独的应用程序 VersionEdit。它有一个 GUI，但在您的批处理文件中，类似于：

```
"C:\Program Files\E. Crane Computing\PowerGen Professional\VECli.exe" %ExeFile% /f=%ProductVer%.%Build%
IF ERRORLEVEL 1 goto veerror
"C:\Program Files\E. Crane Computing\PowerGen Professional\VECli.exe" %ExeFile% /p=%ProductVer%.%Build%
IF ERRORLEVEL 1 goto veerror
"C:\Program Files\E. Crane Computing\PowerGen Professional\VECli.exe" %ExeFile% /sa=Release,%ProductVer%
IF ERRORLEVEL 1 goto veerror
"C:\Program Files\E. Crane Computing\PowerGen Professional\VECli.exe" %ExeFile% /sa=Build,%Build%
IF ERRORLEVEL 1 goto veerror 
```

祝你好运，

特里。

# jquery - 数据表 jquery，base64 字符串

> ID：15422014
> 
> 赞同：1
> 
> 时间：2013-03-14T23:19:54.010
> 
> 标签：jquery, base64, datatables, decoding

我从外部数据源获取一个 json，其中所有字符串（值）都使用 base64url 编码（使用 AZ、az、0-9、-、_ 字符）。有没有办法在客户端解码这些字符串，以便它们显示正常？可能我需要在解析 json 的数据表中挂钩函数，但是如何？

这是示例 json：

```
"aaData": [
[
  "dGVzdDEy",
  "Zm9v"
],
...
] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:27:54.203

大多数主流浏览器都支持几乎标准化的 base64 编码和解码功能，`atob`(decode) 和`btoa`(encode)：

```
atob("dGVzdDEy");
// -> test12 
```

但是，正如我所说，这些函数是非标准的，您必须实现自己的函数（或在 ol'sextuple-u 上实现一个函数―<a href="https://gist.github.com/sevir/3946819 " rel="nofollow">like this) 在某些浏览器中解码，例如 IE 9 及更低版本。

至于 JSON 问题，您可以将*reviver*函数作为第二个参数传递给 JSON.parse，它将针对每个字段执行：

```
JSON.parse('{"aaData":[["dGVzdDEy","Zm9v"]]}', function (k, v) { 
    if (typeof(v) == "string") 
        return atob(v); 
    else 
        return v;
});
/* -> {
    "aaData": [
        [
            "test12",
            "foo"
        ]
    ]
} */ 
```

# android - ACTION_CALL_BUTTON 意图在输入法中使用时崩溃

> ID：15422015
> 
> 赞同：0
> 
> 时间：2013-03-14T23:19:59.180
> 
> 标签：android

当我在活动中使用它时，它可以工作。

```
intent = new Intent(Intent.ACTION_CALL_BUTTON);
startActivity(intent); 
```

但是当我在输入法中使用它时（我使用的是 anySoftKeyboard 源代码），它会崩溃。

知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:39:55.607

除了一些可以工作的意图和 AnySoftKeyboard 源代码之外，没有更多的代码。

[https://github.com/AnySoftKeyboard/AnySoftKeyboard](https://github.com/AnySoftKeyboard/AnySoftKeyboard)

最终我想通了。

我失踪了：

```
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

# ruby-on-rails - 在 Rails 3.2 中更新多行

> ID：15422021
> 
> 赞同：37
> 
> 时间：2013-03-14T23:20:28.823
> 
> 标签：ruby-on-rails, activerecord

我正在尝试这样做

```
User.find([23,45,68,123]).update_all(:is_active => true) 
```

但我得到：

```
NoMethodError: undefined method `update_all' for #<Array:0x00000007493778> 
```

什么是正确的语法？如果不需要，我宁愿不遍历每一个。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-03-14T23:39:50.387

`find`返回一个数组，因此您不能使用`update_all`.

为了解决这个问题，我认为你可以使用`where`，它返回一个`ActiveRecord::Relation`，所以`update_all`应该工作：

```
User.where(:id =>[23,45,68,123]).update_all(:is_active => true) 
```

[http://apidock.com/rails/ActiveRecord/Relation/update_all](http://apidock.com/rails/ActiveRecord/Relation/update_all)

我希望它有帮助...

# php - 计算php中sql查询后值的实例数

> ID：15422025
> 
> 赞同：0
> 
> 时间：2013-03-14T23:20:51.560
> 
> 标签：php, sql-server

我已经为此工作了一段时间。我查询数据库以获取以下信息。

然后我想计算这些值（Servicepack 3、2 和 1）并将每个计数分配给一个单独的变量。我不希望使用 sql 查询进行单独的 sql 查询或计数。

谢谢

```
//-----------------------------------------------
// Perform operations with connection.
//-----------------------------------------------

$sql = "SELECT Name, DomainName, OperatingSystem, ServicePack FROM Computers";

$stmt = sqlsrv_query( $conn, $sql );

// Check for 0 results

if( $stmt === false) {
die( print_r( sqlsrv_errors(), true) );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:03:38.517

如果你想用php来计算它，你可以这样做..（在你的代码之后）

```
$counts = array(
    'Servicepack 3' => 0,
    'Servicepack 2' => 0,
    'Servicepack 1' => 0,
);
while($row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)) {
    if (isset($counts[$row['ServicePack']])) {
        ++$counts[$row['ServicePack']];
    }
} 
```

但是你知道你可以用 SQL 和 group by in 来做到这一点......类似......

`$sql = "SELECT COUNT(*) AS ServicePackCounts, OperatingSystem, ServicePack FROM Computers GROUP BY OperatingSystem, ServicePack";`

# charts - 如何在动态的谷歌图表表中居中数据

> ID：15422026
> 
> 赞同：2
> 
> 时间：2013-03-14T23:20:58.713
> 
> 标签：charts, google-visualization

我正在使用谷歌图表中的表格。表中的所有数据都右对齐。我需要在中心对齐文本。我正在动态构建表格，因此无法应用设置单元格方法：

```
 data.setCell(1, 1, 25000, '$25,000', {'className': 'bold-font center-text'}); 
```

我想应用类名而不应用 25000 和 $25000 值。类似于：
data.setCell(1, 1, '', '', {'className': 'bold-font center-text'});

我也不想将其仅应用于第一个单元格，而是应用于整个表格。

**总之**，我如何将所有文本集中在一个表格中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-06-11T04:36:46.890

添加自定义css

将此代码添加到您的页面

```
<style>
.google-visualization-table-td {
text-align: center !important;
}
</style> 
```

“！important”对于覆盖谷歌的数字/文本左/右对齐是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-01T04:22:01.867

对于那些试图完成同样事情但使用 Angular 和 Ionic 的人来说，这只是一个替代答案。

我必须将这段 css 放在 *.scss 文件中，该文件与要呈现图表的 *.html 文件相关联：

```
::ng-deep td[class^='google-visualization-table'] {
    text-align: center !important;
    } 
```

“类”之后的奇怪插入符号用于将样式仅应用于以字符串“google-visualization-table”开头的 td 元素。根据您的 td 包含的数据类型，类名可能只是“ **google-visualization-table-td** ”，也可能是“ **google-visualization-table-type-number google-visualization-table-td** ”等，因此需要像这样灵活的 css 语句。

另外，我听说 ng:deep 已被弃用，但这仍然有效（截至 2021 年底）。不过，将来以不同的方式做这件事可能会很好。

# mysql - SQL 语句 INERT INTO SELECT FROM WHERE 的问题

> ID：15422031
> 
> 赞同：-1
> 
> 时间：2013-03-14T23:21:30.070
> 
> 标签：mysql, sql

这有什么问题？

```
mysqli_query($con, "
        INSERT INTO members (`ip`) VALUES ('$localIP') 
        SELECT * FROM members 
        WHERE username = '$uname' AND password = '$pword'"); 
```

没有插入任何内容，我也没有收到错误消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:28:57.940

I do not have enough points to leave a comment on this but if you insert this into script you should be able to provide more information.

```
error_reporting(E_ALL);
ini_set('display_errors', '1'); 
```

# ios - 为什么我的 ibtool 失败，退出代码为 255？

> ID：15422033
> 
> 赞同：130
> 
> 时间：2013-03-14T23:22:03.703
> 
> 标签：ios, xcode

突然之间我无法构建我的项目。我收到以下编译器错误：

> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/ibtool 失败，退出代码为 255

我的一大堆 xib 文件出现此错误。任何想法正在发生什么，以及解决方案是什么？

使用 Xcode 4.6、iOS 6.1。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2013-03-14T23:42:56.977

我最近在使用 Xcode 4.6 和 iOS 6.1 时发生了类似的事情。

我所做的只是在模拟器上切换到不同的设备版本（5.1）并运行。切换回6.1并自行修复。

Xcode 有时可能无济于事。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-07-21T07:10:53.463

这发生在我们身上，我们清理缓存，删除派生数据文件夹..等什么都没有发生。

以下步骤使其修复，

1.  打开 xib(nib) 作为源代码（右键单击 xib`Open As > Source Code`或`Xcode`使用打开它`TextEdit`）
2.  删除这个**`appearanceType="aqua"`**
3.  使用 Xcode 保存和打开

如需更多解释，请使用[本文](http://www.tyreeapps.com/blog/tools/2014/06/10/Xcode-Crash-with-xib-Files.html)，它可以帮助我们解决问题。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-03-14T23:31:56.073

尝试清理应用程序。Cmd-Shift-K。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-01-14T08:34:39.860

尝试在项目中找到所有 XIB 文件并打开它。其中之一很可能会使您的 Xcode 崩溃。

我的问题是某些 XIB 文件中的自定义字体。

我不得不在我的电脑上安装缺少的字体，问题就解决了。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-12-30T23:19:54.797

1.  重新启动 Xcode - 不起作用
2.  清理应用程序 - 无效
3.  删除派生数据 - 不起作用
4.  重置模拟器内容和设置 - 无效
5.  更改模拟器版本 - 无效
6.  重新启动操作系统 -**神奇地工作**

我不确定哪个部分发挥了作用，是的，它浪费了很多时间。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2018-04-02T23:16:01.347

就我而言，我正在使用 Visual Studio。一切都很好。突然之间，我遇到了同样的问题。然后我打开 XCode，我看到了可用的更新。然后我更新了 Xcode 更新。然后它起作用了:)

所以原因是：XCode 预计会完成一些更新。在那之前，它无法正常工作。

[![在此处输入图像描述](../Images/80f0b4e044235f47f363d16b019d3445.png)](https://i.stack.imgur.com/ieSVA.png)

[![在此处输入图像描述](../Images/a2a20ffeccd70501644a308604299d53.png)](https://i.stack.imgur.com/JFPxW.png)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2014-04-25T16:24:27.140

如果你被卡住了，你应该做的是，在一个 shell 中： ibtool --warnings --errors --notices yourfile.xib > alerts.plist

这会崩溃，但现在你有了崩溃日志，在我的情况下，这是模拟指标的问题：

> localhost:Classes me$ ibtool --warnings --errors --notices CodeViewController.xib > alerts.plist 2014-04-25 17:40:48.625 ibtoold[11691:507] [MT] DVTAssertions: ASSERTION FAILURE in /SourceCache/IDEInterfaceBuilderCocoaTouch /IDEInterfaceBuilderCocoaTouch-5038/InterfaceBuilder/WidgetIntegration/SimulatedMetrics/IBUISimulatedSizeMetrics.m:33 详细信息：（initialTargetRuntime）不应为 nil。对象：方法：-initWithTargetRuntime：线程：{name = (null), num = 1} 提示：无

因此，在我的情况下，我通过上下文菜单将 xib 作为源打开并删除了指标对象。这取决于错误要删除或更改的内容。再次尝试 ibtool，如果它没有崩溃，那你就很好。

背景：这个错误的原因是通用的，它总是会发生在不同的规格从 iOS xcode 版本到版本的变化中，主要是如果你没有定期检查你的项目是否有 xcode 更新。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-03-12T08:15:24.507

这对于那些过去遇到过这个问题的人来说是无关紧要的......但是使用 WatchKit 框架，我遇到了这个错误。我所做的只是删除了我在两个 WKInterface 控制器之间链接的 segue，构建成功。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-08-20T17:42:00.280

我遇到了这个错误，在扫描崩溃日志后，我注意到我的 Xcode-7 构建正在尝试使用 Xcode-8 Beta 中的构建工具。我以前使用**xcode-select**来更改我想使用的构建工具的版本。如果您安装了 xcode-beta，请使用以下命令检查您的设置：

显示设置了哪个构建工具路径：

```
xcode-select -p 
```

选择标准的 Xcode 路径：

```
sudo xcode-select -s /Applications/Xcode.app/ 
```

如果您尝试使用不同安装路径的 Xcode 进行构建，请确保上面的路径反映了这一点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-05-16T21:43:07.500

刚刚用 XCode 8.3 得到了这个。

对我来说，我只是退出了 XCode，然后清理了应用程序并重新构建。之后就好了。

我的原因是为本地化故事板添加新的字符串文件。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-10-24T20:19:34.790

我刚刚经历了同样的事情，这里没有其他答案可以为我解决这个问题。由于 git 合并，它原来是情节提要中的重复 UILabel。显然，如果两个 UI 元素具有相同的内部 ID，Xcode 将会崩溃。

我找到负责任问题的方法是：

*   迭代地向后退一步查看 git 历史记录，检查每个提交，直到找到第一个不会使 Xcode 崩溃的故事板。
*   一旦您的提交开始崩溃，请检查 HEAD 并迭代地还原问题提交中的情节提要更改。继续缩小范围，直到有一个 UI 元素或一行会导致崩溃。
*   永久还原负责的更改并重新启动 Xcode。再次打开情节提要，您可能会收到有关内部不一致的警告。同意 Xcode 提出的更改建议，但请查看它们。
*   如有必要，您现在可以尝试重新创建以前导致问题的 UI 元素或从头开始的更改。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-06-17T19:14:56.537

当我遇到“255”问题时，我正在辅助 git 分支中工作。

我只是切换回我的主 git 分支，清理项目并运行。没有我预期的问题。

然后我切换回“问题”git分支并成功重建它。

小精灵。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-01-06T13:13:31.917

使用 Xcode 8.2.1 和 iOS 10.2 时，我也遇到过类似的事情。

我在模拟器上切换到较早的设备版本并且它工作。然后我切换回来，它被修复了。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-07-14T09:08:21.303

**我发现如果你使用 Xcode 太久而不关闭它，Xcode 最终会变得毫无帮助并给你随机的神秘错误。所以每次出现可疑错误时，我都会定期重启 Xcode 和我在 Mac 上运行的所有应用程序。**

> **Xcode Cache**
> **第一次**尝试检查你所有的 segue/outlet/storyboard 控制器类。有时情节提要会与已设置的视图控制器类断开连接。（这可能会导致运行时错误）。
> 
> **第二次**尝试清理您的项目并转到（~/Library/Developer/Xcode/DerivedData）并删除您的项目缓存。然后强制关闭 Xcode 然后重新启动它。
> 
> **第三次**尝试检查你所有的 segue/outlet/storyboard 控制器类。有时情节提要会与已设置的视图控制器类断开连接。（这可能会导致运行时错误）。
> 
> **第四次**尝试检查（复制捆绑资源，编译源 - 项目>构建阶段）确保列出的文件存在正确的地址和文件夹。有时创建组会导致创建文件夹并导致编译器找不到文件
> 
> **第五**，这也可能是由于移动的文件 + Xcode 最终变得无用并给你随机的神秘错误。并在文件更改目录后更新（复制捆绑资源，编译源 - 项目>构建阶段）
> 
> **个人错误。意外删除**
> **它也可能是调用已删除的 ViewController 或插座造成的**

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-04-08T09:21:22.397

在操作系统更新（macOS High Sierra 10.13.4）之后，我在使用 Visual Studio for Mac（社区，7.4.2（内部版本 12））时遇到了同样的问题。

在这种情况下，您似乎只需要更新 Visual Studio 和 Xcode。

请注意，当然，Visual Studio 不会带来 Xcode 更新，因此“诀窍”是打开后者并让它运行更新。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-01-18T08:06:24.060

我在 Xcode 8 中也遇到了同样的问题。删除派生数据解决了我的问题。

1.  转到文件夹 ~/Library/Developer/Xcode/DerivedData/ 并清除其中的文件夹
2.  重新启动 Xcode 和模拟器并运行您的项目....！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-11-22T02:06:31.463

在故事板中做了一些工作后才发生这种情况。我做了一些撤消操作，结果是一个简单的 UIButton 添加到视图中。删除它并且它没有错误地构建。刚刚添加了一个新按钮，它工作。

更多解释... 按钮已从一个 TVCell 原型复制到另一个原型。我猜副本中发生了一些混乱。很高兴在尝试构建之前我没有改变太多。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-01-30T13:00:04.740

在我的情况下，它发生在重命名一些命名空间之后，我解决了同样的问题，进入项目属性 > 应用程序选项卡 > 默认命名空间：提供新的正确命名空间。

当然，我也在类内部更改了命名空间，但这会有所帮助，因为它将修复所有自动生成的文件。建议清理并构建，并最终关闭并重新打开解决方案。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-02-16T14:57:50.203

当我将代码形式 git 与其他开发人员代码合并时，我遇到了同样的问题。我尝试了很多时间来清理我的项目。但没有什么能帮助我。

我在源代码中打开故事板。开始与上一个工作存储库故事板进行比较。然后我发现同一个标签在同一个屏幕上出现了两次。然后我删除其中一个并保存。它帮助到我。

你可以检查你的xib或故事板。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-03-02T12:55:45.120

我有这个错误是因为我在将情节提要作为源代码编辑时重写了一个`<view>`to 。`<imageView>`

我认为这个快速而肮脏的解决方案可以`UIView`用 s 替换一些自定义类（ 的子类）`UIImageView`。

* * *

所有人都称赞 GIT。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-03-18T09:48:48.970

这就是我遇到问题的原因：我曾尝试将 iOS 8.0 模拟器与 Xcode 5.0.2 一起使用。我在以下路径中粘贴了 iOS 8.0 模拟器 - **/Applications/Xcode\ 2.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs**这样做 的结果是我能够看到 iOS 8.1 模拟器在Xcode 5.0.2 中的下拉列表，但这导致 libtool 的编译错误。我从路径中删除了模拟器，它在我重新启动 Xcode 后工作。现在为了使用 iOS 8.0 模拟器，我使用的是 Xcode 6.1

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-05-14T14:48:18.070

我用这个命令修复了错误，关闭模拟器和 Xcode：

```
codesign -vv /A*/Xc* | open -ef 
```

希望有帮助。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-08-09T18:28:48.257

在为 10.9 构建在 XCode 6.4 (10.10) 中创建的 .XIB 时，我遇到了这个错误。

看到[这个答案](https://stackoverflow.com/questions/27507727/invalid-color-system-labelcolor-warning-given-only-once)。XIB 正在调用 10.10 中引入的“labelColor”，但在 10.9 中是未知的。

将 XIB 作为源打开可防止 XCode 崩溃，并允许我将“labelColor”实例更改为“textColor”，错误已解决。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-09-01T16:49:36.857

正如Logan Geefs 上面提到的，它似乎是由接口控制器segues（即循环）引起的。删除“坏”的 segues 并不能真正解决导航问题。需要的是策略性地将一些按钮操作放置到[弹出控制器]。

这是对我有用的代码：

```
 - (IBAction)backToStart {

   [self popToRootController];
 }

 - (IBAction)backToPrevious {

   [self popController];
 } 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-04-10T08:12:11.887

很少有人提到这个问题与segue有关，我的也是，虽然在我添加新的segue之后它没有立即弹出并且我能够运行应用程序几次进行一些更改，在它发生之前添加新的视图，所以不要忽视这一点。我去删除一些控制器并撤消它以防它没有帮助。如果 segue 是您可能构建的问题，但您将无法添加该 segue，因此如果它是一个可行的选项，请重新创建整个视图控制器。复制和粘贴似乎不起作用，尽管我没有尝试删除 IBOutlet 连接。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-07-16T18:00:30.723

当我安装并开始使用 XCode 9 测试版时，这开始发生在我身上。当我在 8.3 中开始修改好的项目时，故事板被这个错误破坏了，XCode 崩溃了。我的电脑上安装了 XCode 7.x、8.3 和 9。我卸载了所有这些（并删除了所有相关文件），然后从 App Store 重新安装了 8.3。我的项目情节提要仍然损坏，但我能够从备份中恢复，现在一切都很好，因为我继续进行。
不确定这是否与 9 beta 相关。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-07-27T05:16:28.423

就我而言，在我手动解决了“project.pbxproj”文件中的合并冲突后，我遇到了这个问题。在 XCode 中，选择 project->target->BuildPhases->CopyBundleResources。在那里，我删除了一些以空白图标显示的重复文件（与 XIB 文件图标不同）。在此之后，构建顺利，没有问题。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-11-20T11:31:27.940

我今天在一个新项目中遇到了这个错误，通过“增强现实应用程序”项目模板测试 iOS 的 ARKit。

将一些 .scn 文件从根项目移动到 art.scnassets 文件夹后，我开始收到代码签名错误，但我所做的一切都无法解决。

我尝试了这个线程中的所有建议（干净，干净的派生数据，重新启动 Xcode，重新启动 Mac，在情节提要文件中查找重复的 ID）......但它对我有用的是：

*   提交并将我的更改推送到我的 git 项目
*   硬重置到上一次提交
*   清理派生数据，并成功运行
*   硬重置回最近的提交

...现在它起作用了...所以我猜这是 XCode 的 git 处理中的一些错误？？？

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-12-11T05:04:06.343

在 XCODE 9 上，造成这种情况的一个原因是 XCODE 9.1 中带有旧的 .XIB 文件的错误。

使固定：

1.  升级到 XCODE 9.2

2.  您所有的 .XIB 文件都应设置为 iOS 8.1 或更高版本。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-05-11T02:25:53.347

只需**干净地构建**您的项目。你会得到**解决！**

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2018-06-10T15:37:57.727

如果这个答案对您没有任何帮助，并且您正在使用 pod，并且您可能在不同的 Xcode 版本中打开同一个项目，那么您必须

1.  转到项目的根文件夹。
2.  从 Podfile 复制并保存数据。
3.  删除 4 个文件和文件夹 - Podfile、Podfile.lock、Pods(folder)、your_workspase_name.xcodeproject
4.  打开终端并导航到根文件夹。
5.  运行命令`pod init`
6.  打开 Podfile 并粘贴上一个 Podfile 中保存的数据
7.  运行命令`pod install`
8.  打开你的工作区，你的问题就会消失。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-10-23T14:35:01.213

我使用 xCode 9.4 并出现此错误。我尝试重新启动 xCode，清理应用程序并删除派生数据，

> 我重新启动了我的mac

它的工作就像一个魅力。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2018-12-13T06:44:48.057

如果它发生在最新的**Xcode 10**中，请尝试清理派生数据。

> ~/库/开发者/Xcode/DerivedData

# active-directory - 活动目录身份验证获取无效的属性描述

> ID：15422034
> 
> 赞同：2
> 
> 时间：2013-03-14T23:22:05.343
> 
> 标签：active-directory, ldap

如果我只使用 sAMAccountName，身份验证工作正常。当我尝试使用过滤时

> 'memberOf=(&(objectClass=user)(sAMAccountName=*)(|(department=861)(department=945)))'

作为我登录的 ldap 属性名称，我得到

> javax.naming.directory.InvalidSearchFilterException：无效的属性描述；

我试过有/没有 memberOf= 位。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T09:35:22.527

大多数使用的服务器`memberOf`都有一个属性定义，该属性将其定义为具有`DN`语法 ( `1.3.6.1.4.1.1466.115.121.1.12`)。如果您的服务器是这种情况，则过滤器中的断言无法成功，因为断言中的属性值不是 DN。

# javascript - jQuery - 在按钮单击时淡入和淡出不同的元素

> ID：15422035
> 
> 赞同：5
> 
> 时间：2013-03-14T23:22:06.007
> 
> 标签：javascript, jquery, onclick, fadeout

我正在尝试创建几个按钮，根据单击的按钮显示一个框。我这样做是通过给每个盒子自己的类并将参数传递给函数来识别哪个盒子是目标。然后，我将此函数分配给页面上每个按钮的 onclick 属性（我知道我可能应该将事件处理程序附加到单独的文件中）。这是功能：

```
var show = function(boxNumber){
    if($(this).hasClass('shown')){
       $(this).removeClass('shown');
       $(this).html('Show');
       $('.box'+boxNumber).fadeOut(1000);
      }
    else{
       $(this).html('Hide');
       $(this).addClass('shown');
       $('.box'+boxNumber).fadeIn(1000);
      }
 }; 
```

的HTML：

```
<span onclick="show(1)">Box 1</span>
<div class="box1"></div>

etc. for more boxes 
```

但是这个功能不起作用。首先， this 关键字似乎没有针对按钮，因为按钮的 html 在单击时不会更改。但是，当我用按钮的类替换 this 关键字时，它可以正常工作。

其次，该功能可以很好地淡化这些框，但如果我再次单击该按钮，则不会隐藏它们。

我被卡住了，所以任何帮助将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:41:53.533

## 解决方案1（所有jQuery）：

最简洁的方法是坚持使用 jQuery 进行点击处理。您已经在使用 jQuery 进行渐变，为什么不使用它来绑定点击？试试这个：

## [jsFiddle](http://jsfiddle.net/fVENv/)

```
<span>Box 1</span>
<div class="box1"></div><br/>
<span>Box 2</span>
<div class="box2"></div><br/>
<span>Box 3</span> 
```

```
$('span').click(function () {
    var boxNumber = $(this).index('span') + 1;
    if ($(this).hasClass('shown')) {
        $(this).removeClass('shown');
        $(this).html('Show');
        $('.box' + boxNumber).fadeIn(1000);
    } else {
        $(this).html('Hide');
        $(this).addClass('shown');
        $('.box' + boxNumber).fadeOut(1000);
    }
}); 
```

**注意：**如果您希望淡出的框在文档中保留其位置，请尝试[`fadeTo()`](http://api.jquery.com/fadeTo/)改用。

## 解决方案 2（混合）：

但是，如果您确实需要使用该`onclick`属性来绑定单击处理程序，如您在示例中所示，您可以这样做：

[jsFiddle](http://jsfiddle.net/fVENv/2/)

```
<span onclick="show(1,this)">Box 1</span>
<div class="box1"></div><br/>
<span onclick="show(2,this)">Box 2</span>
<div class="box2"></div><br/>
<span onclick="show(3,this)">Box 3</span> 
```

```
function show(boxNumber, elem) {
    $this = $(elem);

    if ($this.hasClass('shown')) {
        $this.removeClass('shown');
        $this.html('Show');
        $('.box' + boxNumber).fadeIn(1000);
    } else {
        $this.html('Hide');
        $this.addClass('shown');
        $('.box' + boxNumber).fadeOut(1000);
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:18:59.010

[http://jsfiddle.net/fVENv/5/](http://jsfiddle.net/fVENv/5/)

我能看到的最好方法是在页面加载时使用 jquery 添加一些隐藏文本，然后在单击时切换一个类（以及淡入淡出切换）。

的HTML：

```
<p>Box 1</p>
<div></div><br/>
<p>Box 2</p>
<div></div><br/>
<p>Box 3</p>
<div></div><br/> 
```

jQuery：

```
$('p').append('<span class="show">Show</span><span class="hide">Hide</span>');
$('div').hide();
$('p').click(function () {
    $('p').click(false);
    $(this).toggleClass('hidden').next('div').fadeToggle(function(){
    $('p').click(true);
    });
}); 
```

的CSS：

```
div {
    width:50px;
    height : 50px;
    background: red;
}
p {cursor:pointer;}
span { padding: 5px; margin-left:5px;}
p.hidden > .hide, p > .show  { display:inline }
p > .hide, p.hidden > .show { display: none; } 
```

# ios - 无法保留 NSMutableArray 对象（我正在使用 ARC）

> ID：15422037
> 
> 赞同：0
> 
> 时间：2013-03-14T23:22:16.350
> 
> 标签：ios, objective-c, nsmutablearray, automatic-ref-counting, retain

我试图在表格视图中显示在 Twitter 应用程序的搜索字段中搜索的关键字，以及为此搜索返回的推文数量。从主 ViewController，我试图以编程方式创建另一个表视图。并且每当我将一个对象添加到 NSMutableArray（这是我要显示的表的数据）时，该对象就会存储在其中，但对于下一个函数调用，该数组不会保留其值。由于我使用的是 ARC，因此我也不能使用“保留”和“释放”语句。

我该如何解决这个问题？

请帮忙。

```
@interface AppViewController : UIViewController <UITableViewDataSource,UITableViewDelegate>

@property (strong,nonatomic) NSMutableArray *searchWords;
@property (strong,nonatomic) NSMutableArray *searchCount;
@property (strong,nonatomic) NSString *count;
@property (strong,nonatomic) UITableView *historyTable;

@property (strong, nonatomic) IBOutlet UITextField *searchTextField;
- (IBAction)showHistory:(id)sender;

@end

@implementation TwitterSearchViewController
@synthesize searchTextField;

@synthesize searchCount,searchWords,count,historyTable; 

- (void)viewDidLoad
{

    count=[[NSString alloc] init];
    searchWords=[[NSMutableArray alloc] init];
    searchCount=[[NSMutableArray alloc] init];
    historyTable=[[UITableView alloc] init];

    [super viewDidLoad];
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender 
{
    if ([[segue identifier] isEqualToString:@"transitionToSearchResults"]) 
    {
        NSLog(@"Count of searchWords before:%lu",(unsigned long)[searchCount count]);
        //This prints 0 every time 

        [searchWords addObject:[searchTextField text]];

        NSLog(@"Count of searchWords:%lu",(unsigned long)[searchWords count]);
        //This prints 1 every time              

        TWRequest *requestError = [[TWRequest alloc] initWithURL:[NSURL URLWithString:searchURL] parameters:nil requestMethod:TWRequestMethodGET];
        //searchURL is used to get the tweets using Twitter API

        // Send the Twitter Search request and create a handler to handle the Search response
        [requestError performRequestWithHandler:^(NSData *searchResponse, NSHTTPURLResponse *requestResponse, NSError *error) 
         {

                 // Extract the Twitter messages from search response
                 NSArray *tweetMessages = [searchResultsDict objectForKey:@"results"];

                 // Set the Data Source for the Table in TwitterSearchResultsViewController
                 // which displays the search results nicely
                 [searchViewController setTweetMessages:tweetMessages];
                 // Update the table view
                 [searchViewController updateTableView];
                 count=[[NSString alloc] initWithFormat:@"%lu",(unsigned long)[tweetMessages count]];

             }
         }];
        [searchCount addObject:count];
    }
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return [searchWords count];
}

-(NSInteger) numberOfSectionsInTableView:(UITableView *)tableView{
    return 1;
}

// Row display. Implementers should *always* try to reuse cells by setting each cell's reuseIdentifier and querying for available reusable cells with dequeueReusableCellWithIdentifier:
// Cell gets various attributes set automatically based on table (separators) and data source (accessory views, editing controls)

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    NSString *cellIdentifier=@"HistoryCell";
    UITableViewCell *newCell=[tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if(newCell==nil){
        newCell=[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue2 reuseIdentifier:cellIdentifier];
    }

    [[newCell textLabel] setText:[searchWords objectAtIndex:[indexPath row]]];
    [[newCell detailTextLabel] setText:[searchCount objectAtIndex:[indexPath row]]];

    return newCell;

}

- (IBAction)showHistory:(id)sender {
    //historyTable=[[UITableView alloc] init];
    historyTable.dataSource=self;
    historyTable.delegate=self;
    NSLog(@"Histroy count:%ld",(long)[historyTable numberOfRowsInSection:0]);
    //Since the mutable arrays are not retaining their values, the number of rows in my     table is always zero
    self.view=historyTable;
    self.title=@"Search History";
}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:31:37.090

`[searchCount addObject:count];`在计算计数后放置您的代码。

```
[requestError performRequestWithHandler:^(NSData *searchResponse, NSHTTPURLResponse *requestResponse, NSError *error) 
             {

                     // Extract the Twitter messages from search response
                     NSArray *tweetMessages = [searchResultsDict objectForKey:@"results"];

                     // Set the Data Source for the Table in TwitterSearchResultsViewController
                     // which displays the search results nicely
                     [searchViewController setTweetMessages:tweetMessages];
                     // Update the table view
                     [searchViewController updateTableView];
                     count=[[NSString alloc] initWithFormat:@"%lu",(unsigned long)[tweetMessages count]];

                     [searchCount addObject:count];
                 }
             }]; 
```

# python - Numpy：给定标量 condlist 的一维数组的 np.select

> ID：15422038
> 
> 赞同：1
> 
> 时间：2013-03-14T23:22:16.393
> 
> 标签：python, performance, numpy

我试图得到这样的东西：

```
def choozer(my_1D_array):
    newArray = np.zeros((len(my_1D_array), 5))
    for x in enumerate(my_1D_array):
        if x[1]<3:
            y = np.array([1,1,1,1,1]) #the y's can be any array of random values
        elif 3<=x[1]<=5:
            y = np.array([2,2,2,2,2])# don't need to be repeated
        elif x[1]>5:
            y = np.array([3,3,3,3,3])
        newArray[x[0]] = y
    return newArray 
```

这*行得通*……但对我来说似乎很迂回，效率对我的应用程序很重要。所以我有了将它与[np.select](http://docs.scipy.org/doc/numpy/reference/generated/numpy.select.html)进行比较的想法：

```
def np_choozer(my_1D_array):
    condlist = [my_1D_array<3, 
                np.logical_and((3<=my_1D_array),(my_1D_array<=5)), 
                my_1D_array>5]
    choicelist = [np.array([1,1,1,1,1]),
                  np.array([2,2,2,2,2]),
                  np.array([3,3,3,3,3])]
    return np.select(condlist, choicelist) 
```

...但没有骰子。它返回轴 1 上的选择列表值。有没有更好的方法来解决上述问题的一般版本？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:33:16.640

也许它可以用 写得更好`np.select`，但你总是可以这样做：

```
newArray = np.zeros(my_1D_array.shape + (5,))
newArray[np.where(my_1D_array < 3)] = 1
newArray[np.where((my_1D_array >= 3) & (my_1D_array <= 5)] = 2
newArray[np.where(my_1D_array > 5)] = 3 
```

一个例子：

```
>>> a = np.random.rand(10) * 10
>>> b = np.empty(a.shape + (5,))
>>> b[np.where(a < 3)] = 1
>>> b[np.where((a >= 3) & (a <= 5))] = 2
>>> b[np.where(a > 5)] = 3
>>> b
array([[ 1.,  1.,  1.,  1.,  1.],
       [ 3.,  3.,  3.,  3.,  3.],
       [ 2.,  2.,  2.,  2.,  2.],
       [ 3.,  3.,  3.,  3.,  3.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 3.,  3.,  3.,  3.,  3.],
       [ 3.,  3.,  3.,  3.,  3.],
       [ 3.,  3.,  3.,  3.,  3.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 3.,  3.,  3.,  3.,  3.]]) 
```

* * *

**编辑**上面的代码利用了分配中的广播，但是`1`,`2`和`3`可以用 5 元素列表或数组替换。`a`与`b`上面的示例相同：

```
>>> b[np.where(a < 3)] = np.arange(5)
>>> b[np.where((a >= 3) & (a <= 5))] = np.arange(5) + 10
>>> b[np.where(a > 5)] = np.arange(5) + 20
>>> b
array([[  0.,   1.,   2.,   3.,   4.],
       [ 20.,  21.,  22.,  23.,  24.],
       [ 10.,  11.,  12.,  13.,  14.],
       [ 20.,  21.,  22.,  23.,  24.],
       [  0.,   1.,   2.,   3.,   4.],
       [ 20.,  21.,  22.,  23.,  24.],
       [ 20.,  21.,  22.,  23.,  24.],
       [ 20.,  21.,  22.,  23.,  24.],
       [  0.,   1.,   2.,   3.,   4.],
       [ 20.,  21.,  22.,  23.,  24.]]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:00:06.753

这个，

```
import numpy as np

a = np.arange(10)

one = np.ones((5,a.shape[0]))
two = 2 * one
thr = 3 * one

def choozer(a):
    condlist = [a<3, np.logical_and((3<=a),(a<=5)), a>5]
    choicelist = [one,two,thr]
    return np.select(condlist, choicelist).T

print choozer(a) 
```

给出这个，

```
[[ 1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1.]
 [ 1\.  1\.  1\.  1\.  1.]
 [ 2\.  2\.  2\.  2\.  2.]
 [ 2\.  2\.  2\.  2\.  2.]
 [ 2\.  2\.  2\.  2\.  2.]
 [ 3\.  3\.  3\.  3\.  3.]
 [ 3\.  3\.  3\.  3\.  3.]
 [ 3\.  3\.  3\.  3\.  3.]
 [ 3\.  3\.  3\.  3\.  3.]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T01:20:04.080

`np_choozer`给出正确的结果`my_1D_array.reshape(-1,1)`。感谢您的帮助，伙计们......虽然我仍然很想知道是否有其他人能想出更好的方法。

# ruby-on-rails - 使用 ThoughtBot 高压的自定义错误页面

> ID：15422040
> 
> 赞同：1
> 
> 时间：2013-03-14T23:22:38.447
> 
> 标签：ruby-on-rails, ruby, high-voltage

我在 rails 3.2.2 应用程序上使用 1.2.2 的高压，并且似乎无法让我的应用程序在找不到页面时触发自定义 404 - 我只是收到“路由错误，没有这样的页面：“错误页面。

路线.rb：

```
...

match '/signup',  to: 'users#new'

root :to => 'high_voltage/pages#show', :id => 'home'

match '/404', :to => 'errors#not_found'
match '/422', :to => 'errors#server_error'
match '/500', :to => 'errors#server_error'

match '/:id' => 'high_voltage/pages#show', :as => :static, :via => :get 
```

我还在 application.rb 中设置了以下内容（我相信这是 Rails 3.2 启动路由错误的方式）：

```
config.exceptions_app = self.routes 
```

但我仍然得到默认的路由错误页面。

我也尝试在我的应用控制器中使用它：

```
unless config.consider_all_requests_local
        rescue_from Exception, :with => :render_500
        rescue_from ActiveRecord::RecordNotFound, :with => :render_404
        rescue_from ActionController::RoutingError, :with => :render_404
        rescue_from ActionController::UnknownController, :with => :render_404
        rescue_from ActionController::UnknownAction, :with => :render_404
    end

    protected

    def render_500 exception
      logger.error exception.inspect
      render :template => "/errors/server_error.html.haml", :status => 500, :layout => 'application'
    end

    def render_404 exception
      logger.error exception.inspect
      render :template => "/errors/not_found.html.haml", :status => 404, :layout => 'application'
    end 
```

但它仍然不起作用。

我难住了！任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-07T01:46:16.187

通过以下修改，我可以获得使用高压的自定义 404 页面：

注意：如果您在本地进行测试，则需要运行`RAILS_ENV=production rails s`，因为开发模式会显示不同的 404 错误页面。

```
# config/application.rb
config.exceptions_app = self.routes

# config/routes.rb
get '/404', to: 'errors#not_found' 
```

然后我们只需要`ErrorsController`为`errors/not_found.html.erb`

# tcp - 如何在套接字编程中获取接收到的数据包的 tcp 标头？

> ID：15422041
> 
> 赞同：0
> 
> 时间：2013-03-14T23:22:50.607
> 
> 标签：tcp, network-programming, raw-sockets

我想获取每个接收到的 TCP 数据包（发往特定程序，即端口）的 TCP 标头，似乎无法使用 recv() 或 recvfrom() 使用常规套接字获取 TCP 标头。

所以，我想使用原始套接字和原始套接字，如果主机接收到很多数据包，我可以使用 recvfrom() 接收所有发往主机的 IP 数据包，我需要检查每个数据包的端口号，看看它是否是需要的。那么它可能是非常耗时和 CPU 消耗？

```
while（）
{
recvfrom();
check_port_number(); 
} 
```

有什么好方法可以获取收到的 tcp 数据包的 tcp 标头？我正在使用 linux c，所以解决方案应该是基于 linux c 的。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:39:33.553

您想使用[libpcap](http://www.tcpdump.org/manpages/pcap.3pcap.html) API，而不是套接字 API。libpcap 让您可以直接从网络上读取数据包。

另一个可以用来简化数据包解析的库是 libnet。

# javascript - FabricJS - 锁定高度并仅调整宽度？

> ID：15422042
> 
> 赞同：1
> 
> 时间：2013-03-14T23:22:53.193
> 
> 标签：javascript, html, fabricjs

我正在使用 FabricJS，我想让用户仅按其宽度调整形状的大小，并以某种方式隐藏或锁定高度手柄，以便它们无法使用。

有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T05:21:46.830

您可以像这样锁定高度缩放： myObject.lockScalingY = true;

高度缩放手柄将可见，但不可用。

# java - 休眠 createQuery 与获取

> ID：15422043
> 
> 赞同：4
> 
> 时间：2013-03-14T23:22:55.143
> 
> 标签：java, hibernate

`get`有什么优势`createQuery`呢？

我可以看到不必解析 HQL 可能会稍微提高性能，但是使用 get over createQuery 还有其他主要优势吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T23:27:13.440

First, it's much quicker to type, is much more readable, and expresses the intent clearly: get an entity by its ID. And it's basically impossible to make an error, whereas you could have a typo in your HQL query.

Regarding performance, the main advantage is that it executes a select statement only if the entity is not in the session cache yet. An HQL query will be executed every time. And if you have a second-level cache, `get()` will avoid executing a query completely if the entity is already in the second-level cache.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-17T11:35:05.603

`get()`直接使用会话来检索对象。

*   get() 仅在您要加载对象时有用，即 SQL SELECT。
*   就像 save() 和 persist() 会导致 SQL INSERT，delete() 会导致 SQL DELETE 和 update() 或 merge() 会导致 SQL UPDATE。
*   有限的控制，我们需要指定一个我们需要提取的实体。

`createQuery()` 使用 HQL

*   使用 HQL，我们可以编写所有 CRUD 查询。
*   给予更多控制，我们可以指定 HQL(SQL like) 子句。
*   HQL 是 hibernate 自己的查询语言，用于对 hibernate 程序执行批量操作
*   面向对象的 SQL 形式称为 HQL。
*   在这里，我们将用 POJO 类变量名替换表列名，用 POJO 类名替换表名，以获取 HQL 命令
*   有时很难用其他替代方案编写。使用 HQL 我们可以更快地实现。

# php - Zend Validate Int 删除逗号

> ID：15422044
> 
> 赞同：0
> 
> 时间：2013-03-14T23:22:55.227
> 
> 标签：php, zend-framework, zend-form

我正在使用 Zend_Validate_Int 类来验证表单中的整数。当数字类似于 1,000 时，它会通过验证，但随后会删除逗号。有谁知道我可以让它保留逗号的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:25:41.220

的目的`Zend_Validate_Int`是确保您获得的最终数字是整数而不是浮点数，您可能需要使用另一个验证器或正则表达式，或者只是尝试`Zend_Validate_Float`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T13:07:57.493

`Zend_Validate_Int`不是你的问题。

这个验证器接受一个值来验证并简单地返回一个布尔值并且只返回一个布尔值。它将验证一个带逗号的整数为真。逗号被 str_replaced 为空，但该值永远不会返回。

您的问题可能与您设置的任何语言环境或您正在使用的任何类型转换有关。

您可以在每一步转储变量值以查找实际更改发生的位置。

解决此问题的最佳方法可能是使用视图助手来格式化输出值。

# python - 在 Python 中按第 n 个元素搜索元组列表

> ID：15422047
> 
> 赞同：0
> 
> 时间：2013-03-14T23:23:05.817
> 
> 标签：python

所以我有一个元组列表，每个元组有 3 个元素。第二个和第三个元素都是整数。对于值 n，我需要返回所有包含 n 作为第二个或第三个元素的元组。

不幸的是，我不完全确定如何做到这一点。我敢肯定它并不太复杂，但是尽管有一些类似的问题，但我找不到任何适合这个确切问题的问题。有谁知道该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:28:00.433

您应该能够通过简单的列表理解来做到这一点。就像是：

```
[t for t in list_of_tuples if t[1] == n or t[2] == n] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:27:43.987

使用具有简单`if`条件的列表推导：

```
>>> lis=[('a',1,2),('b',2,2),('c',3,3),('d',3,1)]

>>> n=1

>>> [x for x in lis if n in x[1:3]]  #[1:3] returns a sublist containing 
                                     # 2 & 3 element of each tuple
[('a', 1, 2), ('d', 3, 1)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T23:51:52.600

```
blist = [tup for tup in alist if n in tup[1:]] 
```

上面的行使用[列表推导](http://docs.python.org/3.3/tutorial/datastructures.html#list-comprehensions)，相当于：

```
blist = []
for tup in alist:
    if n in tup[1:]:
        blist.append(tup) 
```

`tup[1:]`返回一个新元组，由三项元组中的第二项和第三项组成`tup`。

事后看来， [James Henstridge 的](https://stackoverflow.com/users/721283/james-henstridge)例子似乎更可取，因为`t[1] == n or t[2] == n`使用了现有的元组。

# python - 当我有两个以太网卡时如何发送 UDP 广播？

> ID：15422049
> 
> 赞同：3
> 
> 时间：2013-03-14T23:23:18.967
> 
> 标签：python, udp

我有两个以太网卡，我想在本地网络（192.168.0.255）上发送 UDP 广播消息，但是 UDP 消息只发送第一个以太网卡。

```
ip ="255.255.255.255"
UDPSocket = socket.socket( socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP )
UDPSocket.setsockopt( socket.SOL_SOCKET, socket.SO_BROADCAST, True )
UDPSocket.settimeout( timeout )
UDPSocket.sendto( msg.xmlmsg, ( ip, UDPport ) )

UDPSocket.close() 
```

如何指定要发送消息的女巫子网？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:37:15.293

您必须`bind`将套接字连接到本地地址。

对于非广播 UDP 套接字，您通常绑定到*任意*地址 (0.0.0.0)。您还可以选择特定端口或让系统为您选择一个（端口 0）。如果您没有明确绑定套接字，它将自动绑定到第一个 0.0.0.0:0 `send`。

总是建议做广播明确地做绑定，并指定你自己的所选接口的本地地址。如果您不需要特定端口，则可以使用端口 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-12T12:02:25.337

接受的答案对我不起作用，试图在原始套接字上发送 ICMP ECHO 请求。我不得不这样做：

```
target = '8.8.8.8'
packet = bytearray(...)
sock = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_ICMP)
sock.setsockopt(socket.SOL_SOCKET, 25, 'eth0') # or whatever the name of the interface is
                                               # 25 = SO_BINDTODEVICE
                                               # Some Python installations will have the constant IN.SO_BINDTODEVICE which you can use here, YMMV
sock.sendto(packet, (target, 1)) 
```

# jquery - 未通过 JSON 发送未标记为“[DataMember(IsRequired = true)]”的属性

> ID：15422050
> 
> 赞同：0
> 
> 时间：2013-03-14T23:23:19.513
> 
> 标签：jquery, asp.net-mvc, json, web-applications, asp.net-web-api

这是我的代码：

```
[DataContract]
public class SideDto
{
    public SideDto() { }

    public SideDto(Side side)
    {
        SideId = side.SideId;
        Stage = side.Stage;
    }

    [Key]
    [DataMember(IsRequired = true)]
    public int SideId { get; set; }

    public Stage Stage { get; set; }

} 
```

当我调用它时，我得到 SideId，但我没有得到 Stage。如果我将 Stage 标记为 IsRequired，我会得到它，但是当我发布一个没有定义 Stage 的新 Side 时（因为我实际上并不需要它用于数据模型，只是表示层），我得到一个错误。知道如何在没有如此严格的验证的情况下在线获取这些属性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:08:58.403

您只需要使用 DataMember 属性来装饰“Stage”属性，*而不*需要 IsRequired。

# java - CORBA 区分服务器 ip 上的服务行为（传入请求）

> ID：15422053
> 
> 赞同：0
> 
> 时间：2013-03-14T23:23:33.280
> 
> 标签：java, interface, corba

我想用 1 个或多个仆人（例如 HelloWorld）创建 CORBA 服务器应用程序。服务器将在具有许多 IP 地址的机器上运行。例如，我在对象 HelloWorld -> sayHello() 中只有 1 个方法。

但是，我想根据客户端到达的 ip 返回不同的结果（例如不同语言的 Hello）。

示例：带有两个 ip 的 SERVER1：IP 1.1.1.1、IP 2.2.2.2。

*   客户端调用 ip 1.1.1.1 上的方法应该得到响应“Hello”。
*   客户端调用 ip 2.2.2.2 上的方法应该得到响应“Hi”。

如何将接口 ip 提升为我可以响应相关的 HelloWorld sayHello() 方法？

我没有改变客户端实现的可能性。我的目标是在一台机器上模拟大量的 CORBA 服务器。当然，所有 CORBA 服务器都有不同的状态（不同的 helloworld 答案）。是否可以？如何？

请帮忙！先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:49:09.367

我知道，没有可移植的方式知道这一点。请记住，CORBA 非常努力地对应用程序隐藏传输，并且 CORBA 可以运行在各种传输上，而不仅仅是 TCP/IP。您服务器中的 ORB 将监听这两个 IP 地址并将客户端请求发送到 POA。我不认为IP地址传播得那么远。如果对此有任何支持，那将是特定于您的 ORB 的。

# jquery - 检查元素子元素内的特定文本

> ID：15422054
> 
> 赞同：-1
> 
> 时间：2013-03-14T23:23:35.430
> 
> 标签：jquery, contains

我正在尝试根据满足的特定条件执行某些操作。但是 jquery 代码似乎不起作用。

HTML：

```
 <p class="Mycondition">
           <span><b>»</b></span>&nbsp;
           <span id="nav"><a href="#" id="lnkMycondition">Overview</a> 
              <span class="separator">
                 <b>»</b>
              </span>
           </span>
           <span><b>MyName</b></span>
        </p>

     <div class="prepend-1 span-22">
     <table class="hor" title="">
       <tbody>

             <tr>
                <td>abc</td><td>1</td>
            </tr>
     </tbody></table>
    </div> 
```

查询：

```
$('table').each(function () {

        if ($('#Mycondition').children(':contains("MyName")')) {
            // do stuff
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:28:09.180

您正在使用 ID 选择器按类名选择元素，还`children`返回一个始终为 `true`.

尝试使用`has`方法：

```
$('table')
     .has('.Mycondition:has(:contains(MyName))') // filtering tables
     .find('tr:last') // finding last tr descendants 
     .addClass('Myclass'); // and adding classes 
```

或者：

```
$('table').filter(function () {
    return $('.Mycondition', this)
                .children(':contains("MyName")').length;
}).find('tr:last').addClass('Myclass'); 
```

更新：

如果您有多个`Mycondition`元素并且想要将类添加到它们的下一个兄弟姐妹中，您可以尝试：

```
$('p.Mycondition:has(:contains(MyName))') 
     .next('table') 
     .find('tr:last') // finding last tr descendants 
     .addClass('Myclass'); // and adding classes 
```

* * *

```
$(function() {
    if ( $('p.Mycondition').children(':contains("MyName")').length ) {
        $('table').find('tr:last').addClass('myclass');
    }
}); 
```

[http://jsfiddle.net/AH5KY/](http://jsfiddle.net/AH5KY/)

# jquery - 文字输入问题？jQuery/HTML？

> ID：15422056
> 
> 赞同：-4
> 
> 时间：2013-03-14T23:23:44.123
> 
> 标签：jquery, html

我希望我可以发布关于什么是错误的代码，但坦率地说，我不知道。我的网页可以正常工作，但联系面板中的输入元素不允许我输入任何内容。知道为什么吗？

[http://s1527.mtchs.org](http://s1527.mtchs.org)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:27:07.020

In your CSS [http://s1527.mtchs.org/techmuffins.css](http://s1527.mtchs.org/techmuffins.css)

The first rule contains declarations that will render everything (`*`) "unselectable", specifically the collection of (cross-browser) variants of the [`user-select` property](https://developer.mozilla.org/en-US/docs/CSS/user-select).

```
* {
    margin: 0;
    padding: 0;
    -webkit-touch-callout: none; /****************************/
    -webkit-user-select: none;   /* Remove these lines       */
    -khtml-user-select: none;    /* or make the CSS selector */
    -moz-user-select: none;      /* more specific to avoid   */
    -ms-user-select: none;       /* the <input/> elements    */
    user-select: none;           /****************************/
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:27:28.400

These rules are the reason you can't select the inputs.

```
* {
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} 
```

# mysql - MySQL - 加入同一个表 4 次，列 2,3 和 4 随机且完全不同

> ID：15422058
> 
> 赞同：0
> 
> 时间：2013-03-14T23:24:04.773
> 
> 标签：mysql, random

为简单起见，假设它只有 1 个字段。ID。

在 MySQL 中，我想在结果的第一列中仅列出一次（并按顺序）所有 ID，但在第 2、第 3 和第 4 列中，我想显示来自同一个表的随机 ID - 所有 4 个 ID 都需要每一行都不一样。

我会从视觉上解释。例如有 5 行的表：

ID：

一个

乙

C

D

乙

结果应如下所示：

ABDC

公元前

民航局

德银

EACB

我对 MySQL 很陌生——尽管对其他 SQL 有丰富的经验。我尝试使用 RAND() 和 LIMIT，但得到的结果不正确 - 第 1 列有重复项，或者第 2,3 和 4 列一直向下仅返回一个结果。

请帮忙

=)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:34:10.300

这似乎有效：

```
SELECT
    t1.id id1,
    t2.id id2,
    t3.id id3,
    t4.id id4
FROM
    test t1, test t2, test t3, test t4
WHERE
    t1.id NOT IN (t2.id, t3.id, t4.id)
    AND
    t2.id NOT IN (t3.id, t4.id)
    AND
    t3.id != t4.id
GROUP BY
    t1.id
ORDER BY
    RAND() 
```

这是小提琴：[http ://sqlfiddle.com/#!2/d9adc/5](http://sqlfiddle.com/#!2/d9adc/5)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:31:16.397

```
MichaelRushton's method can optimize to
SELECT id1, id2, id3, id4 FROM (
SELECT t1.id id1, t2.id id2, t3.id id3, t4.id id4
FROM tt t1
    INNER JOIN tt t2 ON t2.id !=t1.id
    INNER JOIN tt t3 ON t3.id !=t1.id AND t3.id !=t2.id
    INNER JOIN tt t4 ON t4.id !=t1.id AND t4.id !=t2.id AND t4.id !=t3.id
ORDER BY RAND()) AS t
GROUP BY t.id1
ORDER BY NULL;

other method:
SELECT (@a:=`id`) AS a
 ,(@b:=(SELECT `id` FROM `tt` WHERE id NOT IN (@a) ORDER BY RAND() LIMIT 1)) AS b
 ,(@c:=(SELECT `id` FROM `tt` WHERE id NOT IN (@a,@b) ORDER BY RAND() LIMIT 1)) AS c
 ,(@d:=(SELECT `id` FROM `tt` WHERE id NOT IN (@a,@b,@c) ORDER BY RAND() LIMIT 1)) AS d
FROM `tt` AS t,(SELECT @a,@b,@c,@d) AS t2
ORDER BY t.id;

or

SELECT a, b, c,(SELECT `id` FROM `tt` AS td WHERE id NOT IN (a,b,c) ORDER BY RAND() LIMIT 1) AS d 
FROM (SELECT a, b,(SELECT `id` FROM `tt` AS tc WHERE id NOT IN (a,b) ORDER BY RAND() LIMIT 1) AS c 
    FROM (SELECT a,(SELECT `id` FROM `tt` AS tb WHERE id NOT IN (a) ORDER BY RAND() LIMIT 1) AS b 
        FROM (SELECT `id` AS a FROM `tt` AS ta) AS tt1
         ) AS tt2
      ) AS tt3
 ORDER BY a;

but its efficiency is very low! 
```

# windows-8 - Windows 8 store package fails on WACK when login to developer account

> ID：15422060
> 
> 赞同：1
> 
> 时间：2013-03-14T23:24:17.083
> 
> 标签：windows-8, visual-studio-2012, package, windows-store-apps, app-certification-kit

I'm trying to put a simple app on windows store. I made a fail attempt once, I submitted an app which failed to pass WACK, eventually it failed on submission too. Even then, when I try to package an app with my developer account logged in, I get a performance launch error.

Even on a blank app. also right after I create package logged in, my app's package name and provider fields on appmanifest are changes too. app's package name changes to the first app I submitted, and the provider changes to I guess my developer account's key.

I deleted my failed submission on dashboard, deleted all the names I reserved, including the failed one. But even when I reserve a new name and package my app with that name, my package name still changes to the very first one and fails on wack.

BUT, when I create package of my app WITHOUT logging in, I mean without associate with windows store, I can package my app with the name I want and pass the WACK. I hope anyone can help me with this.

Edit: C# application.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:41:12.727

我不完全确定我理解你的问题，但让我试试......

首先，您在提交到 Store 和运行 WACK 时遇到的失败是什么？您提到了“性能启动错误”。如果您未通过性能测试，请查看[本文](http://blogs.msdn.com/b/jennifer/archive/2012/11/14/common-windows-store-certification-errors-3-8-app-must-meet-the-basic-performance-criteria-on-a-low-power-computer.aspx)以获取帮助提示。一些例子：

*   尽可能在本地打包内容（或缓存它），这样您就不必在启动期间从网络中提取资源。
*   加载并仅在启动时执行您需要的操作。您可以在后台或实际需要时异步加载其他数据并执行其他工作。
*   在挂起时保存数据时使用“脏位”，因此您只保存已更改的数据。（与其在数据未更改的情况下重新序列化您的应用程序的状态，不如创建一个布尔标志变量（或“脏位”）来表示您的数据已被修改，并且仅在数据发生更改时重新序列化。）
*   如果您使用 JavaScript 进行开发，请使用字节码缓存，因此每个 JS 文件都会创建一次字节码，而不是每次应用程序启动时都创建。要启用此功能，请确保所有 JavaScript 文件都使用字节顺序标记 (BOM) 进行 UTF8 编码，并且在 HTML 起始页的根目录中静态引用。

如果这不是 WACK 和您的商店认证失败的错误，请查看[此博客文章](http://blogs.msdn.com/b/jennifer/archive/2012/11/12/common-certification-errors-when-submitting-to-the-windows-store.aspx)及其链接到的相关博客文章，以查看您的失败是否已涵盖其中。

其次，将代码与 Windows 应用商店中的保留名称相关联的问题：

> 同样在我创建包登录后，我的应用程序包名称和 appmanifest 上的提供程序字段也发生了变化。

这种行为是预期的。当您将您的应用程序包与 Windows 应用商店关联时，它将更改“程序包名称”和您的 appxmanifest 中的发布者。不过没关系！“包名称”正是 Windows 应用商店用作应用包的内部标识符的名称，而“包显示名称”（位于 appxmanifest 中的正下方）是最终用户将看到的内容。将“包显示名称”设置为您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T16:54:40.450

我也遇到过这种情况，看起来 WACK 很困惑，一直在尝试验证错误的版本。以下步骤为我解决了这个问题：

1.  从您的开发 PC 上卸载应用程序（如，转到开始页面，右键单击应用程序并选择卸载）。
2.  重新启动开发 PC。
3.  选择“本地机器”和“发布”。
4.  开始调试等待它完全启动然后停止调试。

很确定实际上只需要其中的一两个步骤，但不确定哪些步骤。

# sql - How to join rows in the same table by a shared column id with a where clause?

> ID：15422066
> 
> 赞同：0
> 
> 时间：2013-03-14T23:24:51.040
> 
> 标签：sql, select, join, where, rows

I'm trying to write a SQL query that looks at a single MySQL DB table (`exp_playa_relationships`) which stores relationship data of CMS' posts and which data structure looks like this:

```
rel_id  |  parent_entry_id  |  parent_field_id  |  child_entry_id
-----------------------------------------------------------------
55      |  3                |  2                |  1
56      |  3                |  2                |  4
58      |  1                |  2                |  4
59      |  8                |  4                |  2
60      |  8                |  5                |  1
63      |  4                |  2                |  3
64      |  9                |  4                |  6
65      |  9                |  5                |  3 
```

`rel_id` is unique, other columns are not.

I would like to generate the following out of the data above:

```
event_data_id  |  user_id  |  event_id
--------------------------------------
8              |  1        |  2
9              |  3        |  6 
```

The `parent_field_id` value itself is discarded in the final output but is needed to figure out if the row's `child_entry_id` signifies a `user_id` or `event_id`.

`parent_entry_id` is the `event_data_id`.

So in plain english I would like to:

1.  Filter rows that have a `parent_field_id` value of either `4` or `5`
2.  Out of those rows, I want to join all those that share the same `parent_entry_id`.
3.  Return the `parent_entry_id` as `event_data_id`.
4.  Return the `child_entry_id` as a `user_id` if `parent_field_id` of the same row is `5`.
5.  Return the `child_entry_id` as a `event_id` if `parent_field_id` of the same row is `4`.

My current SQL query (not working) is this:

```
SELECT
    t1.`parent_entry_id` AS event_data_id,
    t1.`child_entry_id` AS user_id,
    t1.`child_entry_id` AS event_id

FROM `exp_playa_relationships` AS t1
INNER JOIN `exp_playa_relationships` AS t2
ON t1.`parent_entry_id` = t2.`parent_entry_id`
WHERE t1.`parent_field_id` = 4 OR t1.`parent_field_id` = 5 
```

What I cannot figure out specifically is how to avoid creating duplicates on the `parent_entry_id` (SQL creates 2 new rows per row) and how to return `child_entry_id` as either `user_id` or `event_id` based on the `parent_field_id` value.

Any ideas would be much appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:34:28.613

你*太*接近了：

```
SELECT t1.`parent_entry_id` AS event_data_id,
       t1.`child_entry_id` AS user_id,
       t2.`child_entry_id` AS event_id
FROM `exp_playa_relationships` AS t1
INNER JOIN `exp_playa_relationships` AS t2
        ON t2.`parent_entry_id` = t1.`parent_entry_id`
           AND t2.`parent_field_id` = 4
WHERE  t1.`parent_field_id` = 5 
```

具体来说，您必须告诉它从哪个行集中提取相关数据。

顺便说一句，您当前的数据库设计会让您更加头疼……我建议将信息提取到“结果”表中（除非这是为了什么？）。

# if-statement - Lua 'end' 预计会关闭 'if'

> ID：15422071
> 
> 赞同：2
> 
> 时间：2013-03-14T23:25:41.047
> 
> 标签：if-statement, lua

我在lua中有这个代码

```
function onMouseDown(event)
    print(event.x, event.y)
    if event.x>160 then
        print("what")
        return 1
        print("whatwhat") 
    else 
        return 0
        print("WhatWhatWhat")
    end

    fruit:setX(event.x)
    fruit:setY(event.y)
end 
```

但它正在抱怨 main.lua:59: 'end' 预期（在第 56 行关闭 'if'）在 'print' 附近，所以它期待在我的 if 下面 print("whatwhat") 的末尾结束。但是我在那里结束了，如果我这样做，它仍然会抱怨我。

我对 lua 很陌生，我有点困惑，我通常用 c# 编程

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-14T23:35:51.980

请参阅 Lua 手册[§3.3.4](http://www.lua.org/manual/5.2/manual.html#3.3.4)：

> **return**语句只能写为块的最后一条语句。如果确实需要在块的中间**返回**，那么可以使用显式的内部块，就像在 idiom 中一样`do return end`，因为现在**return**是其（内部）块中的最后一条语句。

您的代码`print`在`return`语句之后调用了该调用，因此无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:29:02.743

我怀疑你的问题是退货后的打印。那是死代码；Lua 希望在一个块的末尾返回。

# javascript - 使用javascript中的变量将字符串转换为动态数组

> ID：15422074
> 
> 赞同：1
> 
> 时间：2013-03-14T23:25:55.600
> 
> 标签：javascript, jquery

我将如何获取一个字符串（我从使用 jQuery 的 text() 的页面中获得），例如：

```
var myData = "[{name:'xxx',data:[1,2,3,4,5]},{name:'yyy',data:[5,4,3,2,1]}]"; //this is a string :( 
```

并将其转换为我需要的实际 javascript 对象，例如：

```
var myObject = [{name:'xxx',data:[1,2,3,4,5]},{name:'yyy',data:[5,4,3,2,1]}]; 
```

所以'name'和'data'将是非动态变量，但是names值、数据数组和myObject的长度将是动态的。

不知道从哪里开始。我猜我将不得不做很多拆分和循环，但我愿意接受建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T23:31:06.187

好吧，它可以很容易地完成：

```
var myObject = eval(myData); 
```

但是，您应该意识到该`eval`功能的风险。由于它将值作为 Javascript 表达式运行，它还会运行字符串中的任何有害代码，因此只有在完全控制字符串中的内容时才应该使用它。

如果您可以将格式更改为 JSON，则可以安全地解析它而没有代码注入的风险：

```
var myData = '[{"name":"xxx","data":[1,2,3,4,5]},{"name":"yyy","data":[5,4,3,2,1]}]';

var myObject = $.parseJSON(myData); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:28:08.483

你的意思是，

```
var myObject = eval('(' + myData + ')'); 
```

?

**编辑**

它的主要缺点是您可以将任何 javascript 代码（不仅是 JSON）放入 eval（Chrome 的 F12 允许任何人利用它）。当您使用 jQuery 时，最好的选择是

```
var myObject = $.parseJSON(myData); 
```

用于跨浏览器兼容性。

**`$.parseJSON`**

> 采用格式良好的 JSON 字符串并返回结果 JavaScript 对象。传入格式错误的 JSON 字符串可能会导致抛出异常。例如，以下都是格式错误的 JSON 字符串：
> 
> `{test: 1} (test does not have double quotes around it).`
> 
> `{'test': 1} ('test' is using single quotes instead of double quotes).`

# ruby-on-rails - 为什么查询日期不返回任何内容？

> ID：15422077
> 
> 赞同：0
> 
> 时间：2013-03-14T23:26:26.903
> 
> 标签：ruby-on-rails, ruby-on-rails-3, date, activerecord

我有一个带有 dep_date 字段的模型，它是一个日期（不是日期时间）。在模型中查询具有给定日期的记录时，不会返回任何内容。将 RoR 3.2 与 SQLite 一起使用

```
1.9.3-p327 :019 > Flight.find(62)
  Flight Load (0.4ms)  SELECT "flights".* FROM "flights" WHERE "flights"."id" = ? LIMIT 1  [["id", 62]]
 => #<Flight id: 62, dep_city_id: 3, arr_city_id: 15, dep_date: "2013-03-28", dep_time: nil, price_per_adult: #<BigDecimal:b7e3c94,'-0.0',9(9)>, price_per_child: #<BigDecimal:b7e3c30,'-0.0',9(9)>, free_seats: nil, flight_status: nil, created_at: "2013-03-14 22:15:48", updated_at: "2013-03-14 22:15:48", arr_date: "2013-04-15", arr_time: nil, c_flight_time: 0, c_flight_distance: 0> 

1.9.3-p327 :020 > Flight.where(:dep_date => "2013-03-28")
  Flight Load (0.5ms)  SELECT "flights".* FROM "flights" WHERE "flights"."dep_date" = '2013-03-28'
 => [] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:39:23.043

我的第一个猜测是 Rails 将“2013-03-28”作为字符串而不是日期中断。我建议试试这个：

```
Flight.where(:dep_date => "2013-03-28".to_date) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:49:43.057

这是由 SQLite3 引起的。在 PostgreSQL 上查询日期可以正常工作。

# c# - 使用 C# 排列多个字典值

> ID：15422084
> 
> 赞同：3
> 
> 时间：2013-03-14T23:27:12.943
> 
> 标签：c#, dictionary, permutation

有没有办法使用`IEnumerable` `For Each`-Loop 来解析 a 中的多个定义`SortedDictionary`？我想基本上将它用作我猜的简单数据库结构。例如，假设我的字典用于旋转文章，如下所示。对于句子中的每个单词（我的字符串），我会使用同义词（我的定义）创建该字符串的新版本。这甚至是最好的选择吗？这是我到目前为止所拥有的：

```
string testSentence = "Take it or beat it.";

List<string> allSynonyms = SynonymUtility.AlternativesOf(testSentence).ToList();
variations.AddRange(allSynonyms);

public class SynonymUtility
{
    private static readonly SortedDictionary<char, string> synonymList = new SortedDictionary<char, string>
    {
        {'but', "however"},
        {'take', "abduct, abstract, accroach"},
        {'beat', "hit, lash, punch, shake"},
        {'end', " butt, confine, cusp"};
    }

    public static IEnumerable<string> AlternativesOf(string arg)
    {
        arg = arg.ToLower();
        string[] words = arg.Split(" "));
        //END HERE I AM STUCK...
    } 
```

如您所见，我正在寻找解决方案，但我不知道如何获取每个拆分词并将它们替换为字典中的每个同义词。每次尝试只会替换一个项目......所以最后会有9个句子串的排列。

无论如何，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T23:34:29.280

这解决了你的问题：

我已经修改了同义词字典的结构，以便值是列表：

```
 private static readonly SortedDictionary<string, List<string>> synonymList 
            = new SortedDictionary<string, List<string>>
            {
                {"but", new List<string> { "however" }},
                {"take", new List<string> { "abduct", "abstract", "accroach"}},
                {"beat", new List<string> {"hit", "lash", "punch", "shake"}},
                {"end",  new List<string> {"butt", "confine", "cusp"}}
            }; 
```

输出所有替代句子的功能：

```
 public static IEnumerable<string> AlternativesOf(string arg)
    {
        //First of all, build up a 2d array of all your options
        var words = arg.Split(' ').Select(w=> w.ToLower()).ToList();
        var options = new List<List<string>>();

        foreach (var word in words)
        {
            if (synonymList.ContainsKey(word))
            {
                //Add the original word to the list of synonyms
                options.Add(synonymList[word]
                               .Concat(new List<string> { word }).ToList());
            }
            else
            {
                //Just use the original word only
                options.Add(new List<string> { word });
            }
        }

        //Now return all permutations of the 2d options array
        return AllPermutationsOf("", options, 0);
    } 
```

获取所有排列的函数：

```
 public static IEnumerable<string> AllPermutationsOf
           (string sentence, List<List<string>> options, int count)
    {
        if (count == options.Count)
        {
            yield return sentence;
        }
        else
        {
            foreach (string option in options[count])
            {
                foreach (var childOption in AllPermutationsOf
                             (sentence + " " + option, options, count + 1))
                {
                    yield return childOption;
                }
            }
        }
    } 
```

示例用法：

```
 string testSentence = "Take it or beat it.";
 var alternatives = AlternativesOf(testSentence).ToList();

        /*  Output:

            abduct it or hit it.
            abduct it or lash it.
            abduct it or punch it.
            abduct it or shake it.
            abduct it or beat it.
            abstract it or hit it.
            abstract it or lash it.
            abstract it or punch it.
            abstract it or shake it.
            abstract it or beat it.
            accroach it or hit it.
            accroach it or lash it.
            accroach it or punch it.
            accroach it or shake it.
            accroach it or beat it.
            take it or hit it.
            take it or lash it.
            take it or punch it.
            take it or shake it.
            take it or beat it. */ 
```

# java - Sort a 2-dimensional array

> ID：15422091
> 
> 赞同：0
> 
> 时间：2013-03-14T23:27:41.003
> 
> 标签：java, sorting, type-2-dimension

I have a 2-dimensional double array and I want to sort it based on the second column. I wrote this code, but I got this error in the last line "double can not be dereferenced". It seems it works with string but not for array. any help appreciated.

```
import java.util.Arrays;
import java.util.Comparator;

public class Sort { 
    public static void main(String args[]){
        //Array to sort
        double[][] X = new double[][]{
                {1.2,2,1,3.1},
                {1,2.7,3.3},
                {1,2.3,3.1},
                {1.5,3.2,2.4};

        //Sort the array by column 2
        Arrays.sort(X, new ColumnComparator(2));
    }
}

//Class that extends Comparator
class ColumnComparator implements Comparator {
    int columnToSort;
    ColumnComparator(int columnToSort) {
        this.columnToSort = columnToSort;
    }
//overriding compare method
    public int compare(Object o1, Object o2) {
        double[] row1 = (double[]) o1;
    double[] row2 = (double[]) o2;
    //compare the columns to sort
    return row1[columnToSort].compareTo(row2[columnToSort]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:36:56.090

我想你忘记了，在你写的代码中，在你的比较器中切换回 double ......（我的意思是，正如你所说，你尝试使用 String 并且它有效，我想这就是为什么仍然有一些奇怪的 String[]显然不应该在那里）

如果我假设我应该阅读 double[] row1 = (double[])o1，那么问题是您不能在 double 上调用 .compareTo。您应该只减去这些值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:40:14.963

```
public class SecondColumnComparator implements Comparator<double[]> {
    @Override
    public int compare(double[] row1, double[] row2) {
        return Double.compare(row1[1], row2[1]);
        // or, before Java 7:
        // return Double.valueOf(row1[1]).compareTo(Double.valueOf(row2[1]));
    }    
} 
```

# php - Integrating WHMCS login with my SaaS applications

> ID：15422094
> 
> 赞同：0
> 
> 时间：2013-03-14T23:27:55.363
> 
> 标签：php, login, saas, whmcs

I am offering an online cart solutions as a SaaS model. Each customer can register and get an online cart for himself to sell his products.

I have also WHMCS as a billing system for my clients. I want to integrate the login of WHMCS with my SaaS application.

Means, if any customer logs in to the SaaS application, it automatically become logged in to WHMCS, so that when he clicks on the WHMCS member link in his SaaS application, he logs in automatically, and vice verse.

I know there is a login module integration in WHMCS but it must redirect to the WHMCS login page to work!!, which is the thing I don't want. I Want to do the login process myself.

Please advice.

Thanks,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T00:04:02.960

我认为您正在寻找 WHMCS 的单点登录属性。WHMCS 支持单点登录，你可以自己做，或者购买一个插件。欲了解更多信息：[http ://app.onelogin.com/connector/whmcs-single-sign-on](http://app.onelogin.com/connector/whmcs-single-sign-on)

# wpf - Is redundant Binding Source needed in this example? It didn't work without it

> ID：15422096
> 
> 赞同：0
> 
> 时间：2013-03-14T23:28:00.607
> 
> 标签：wpf, data-binding

Why does the app:ucPathSelection control Visibility binding below work...

```
<UserControl.Resources>
    <loc:VM_ucPathSelect x:Key="PathSelectVM" />
</UserControl.Resources>

...

<Grid Name="SelectionGrid">
  <Grid.DataContext>
     <Binding Source= "{StaticResource PathSelectVM}" />
  </Grid.DataContext>
  <Grid.ColumnDefinitions>
    <ColumnDefinition Width="288*" />
    <ColumnDefinition Width="1" />
    <ColumnDefinition Width="288*" />
    <ColumnDefinition Width="1" />
    <ColumnDefinition Width="288*" />
    <ColumnDefinition Width="1" />
    <ColumnDefinition Width="288*" />
   </Grid.ColumnDefinitions>
   <GridSplitter Grid.Row="0" Grid.Column="1"
                 BorderThickness="1" BorderBrush="Gray" IsTabStop="False" />
   <GridSplitter Grid.Row="0" Grid.Column="3" 
                 BorderThickness="1" BorderBrush="Gray" IsTabStop="False" />
   <GridSplitter Grid.Row="0" Grid.Column="5" 
                 BorderThickness="1" BorderBrush="Gray" IsTabStop="False" />

   <app:ucPathSelectColumn Grid.Row="0" Grid.Column="0" 
       x:Name="ucPathSelectColumn1"
       Visibility="{Binding Source={StaticResource PathSelectVM}, Path=ColumnVisible1}"                    
       DataContext="{Binding Path=VM1}" />

    <app:ucPathSelectColumn Grid.Row="0" Grid.Column="2"
       x:Name="ucPathSelectColumn2"
       Visibility="{Binding Source={StaticResource PathSelectVM},Path=ColumnVisible2}"             
       DataContext="{Binding Path=VM2}" />

    <app:ucPathSelectColumn Grid.Row="0" Grid.Column="4"
       x:Name="ucPathSelectColumn3"
       Visibility="{Binding Source={StaticResource PathSelectVM},Path=ColumnVisible3}"
       DataContext="{Binding Path=VM3}"  />

     <app:ucPathSelectColumn Grid.Row="0" Grid.Column="6"
       x:Name="ucPathSelectColumn4"
       Visibility="{Binding Source={StaticResource PathSelectVM},Path=ColumnVisible4}"     
       DataContext="{Binding Path=VM4}"  />
</Grid> 
```

...while removing the Source attribute causes it to fail?

```
 <app:ucPathSelectColumn Grid.Row="0" Grid.Column="0" 
       x:Name="ucPathSelectColumn1"
       Visibility="{Binding ColumnVisible1}"                    
       DataContext="{Binding Path=VM1}" />

    <app:ucPathSelectColumn Grid.Row="0" Grid.Column="2"
       x:Name="ucPathSelectColumn2"
       Visibility="{Binding Path=ColumnVisible2}"             
       DataContext="{Binding Path=VM2}" />

    <app:ucPathSelectColumn Grid.Row="0" Grid.Column="4"
       x:Name="ucPathSelectColumn3"
       Visibility="{Binding Path=ColumnVisible3}"
       DataContext="{Binding Path=VM3}"  />

     <app:ucPathSelectColumn Grid.Row="0" Grid.Column="6"
       x:Name="ucPathSelectColumn4"
       Visibility="{Binding Path=ColumnVisible4}"     
       DataContext="{Binding Path=VM4}"  /> 
```

The Source seems redundant, and yet it fails without it. The DataContext of the Grid element is set above as this control's VM. The DataContext of each app:ucPathSelectColumn is delivered as a property of the same VM... and this works without the same qualification. Only the Visibility was failing(Debug message, could not find Property on object...and the reported object was of type of the intended VM (PathSelectVM).

One property of the same VM is being used to bind to Visibility of the ucPathSelectColumn control, the other is property is the DataContext of the ucPathSelectColumn control. (EDIT: no, it isn't; it is reporting the type of the VM set via the same scope DataContext assignment. The answer below is correct.)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:37:28.917

```
 ...Visibility="{Binding Path=ColumnVisible1}"                    
   DataContext="{Binding Path=VM1}"... 
```

删除 DataContext 绑定并检查。我的猜测是这个绑定隐藏了网格的绑定。

# sass - 为什么我在 Compass 中得到“未定义的 mixin 'border-radius'”？

> ID：15422098
> 
> 赞同：14
> 
> 时间：2013-03-14T23:28:01.893
> 
> 标签：sass, compass-sass

在我的 Compass 中，顶部文件的行包含必要的插件：

```
@import "compass";
@import "rgbapng";
@import "compass/css3";
@import "config";    // file that has my variables 
```

但是在编译一个有`@include border-radius($box-radius-small);`错误的文件时，说`Undefined mixin 'border-radius'`和`Undefined variable: "$box-radius-small".`- 这两个都应该已经包含了！

有人可以帮忙解决这个问题吗？

**PS我的包裹是：**

Compass 0.12.2 (Alnilam) Sass 3.2.7 (Media Mark)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-08-09T20:57:10.027

只需将以下导入放在 scss 文件的顶部

```
@import "compass/css3"; 
```

css3 的特点 :: [http://compass-style.org/examples/compass/css3/](http://compass-style.org/examples/compass/css3/)

还有许多其他可用的导入......如果您发现自己经常重复使用 css 块以保证额外的努力，您可以创建自己的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-15T14:20:59.297

尝试`@import`在每个使用混入或变量的样式表中“罗盘”和“配置”变量表。

# java - Animating Graphical Sort

> ID：15422100
> 
> 赞同：2
> 
> 时间：2013-03-14T23:28:07.563
> 
> 标签：java, algorithm, sorting, bubble-sort

I am working on an assignment called "Graphical Sort", which is basically animating sort algorithm graphically.

I just need help on animating the sorting process.

I tried using Thread, but the program hangs till the threading process is completed, then it shows the final result.

Below are the picture of how my program looks like:

![enter image description here](../Images/e276d1d2dee002a771f1e6cd294c7aaf.png)

![enter image description here](../Images/f83b0f90691c756171fb055a7a07e32d.png)

Below is the class of the panel I use to paint on

```
import javax.swing.*;
import java.awt.*;
import java.util.*;

public class PaintPanel extends JPanel
{
    // Create an array of 34 element size
    int[] Arr = new int [34];
    // Set default X pointer to 20
    int x = 50;
    // Declare Y pointer to 660
    int y = 660;
    // Set the length of array to n variable
    int n = Arr.length;

    /*
     * main method
     * @param none
     * @return none
     */
    public PaintPanel ()
    {
        randomNums ();
    }

    /*
     * Generates random numbers between 50 and 750 and stores it into the Arr variable
     * @param none
     * @return none
     */
    public void randomNums ()
    {
        // call randomGenerator object
        Random randomGenerator = new Random ();
        // Loop 33 times = Generates 33 random integers
        for (int i = 0 ; i <= 33 ; ++i)
        {
            // Generate random Number
            int randomInt = randomGenerator.nextInt (700);
            // Conditional statement, if any number is less than 50, then discard it and generate new number
            if (randomInt > 50)
            // Assign each random number into Arr Element
            Arr [i] = randomInt;
        else
        {
            // Regenerate Random Number
            randomInt = randomGenerator.nextInt (700);
            // Assign it again
            Arr [i] = randomInt;
            }
        }
    }

/*
 * Bubble Sort Algorithm
 * @param none
 * @return none
 */
public void bubble ()
{ //Pre: a is an array with values. It is of size n
    //Post: the values in a are put in ascending order
    int temp;
    int a[] = Arr;
    for (int i = 0 ; i < n - 1 ; i++)
    {
        for (int j = 0 ; j < n - 1 - i ; j++)
        { // compare the two neighbours
            if (a [j + 1] < a [j])
            { //swap the neighbours if necessary
                temp = a [j];
                a [j] = a [j + 1];
                a [j + 1] = temp;
            }
        }
    }
}

/*
 * Paints 33 rectangle Strips to the screen
 * @param Graphics g
 * @return none
 */
public void paintComponent (Graphics g)
{
    super.paintComponent (g);
    // Call Graphics2D Object
    Graphics2D g2 = (Graphics2D) g.create ();
    // Create Paint Object with gradient Fill
    Paint p = new GradientPaint (
            0, 0, new Color (0x44A2FF),
            getWidth (), 0, new Color (0x0CBEAE),
            true
            );
    // Set the gradient fill to the Graphics2D Object
    g2.setPaint (p);

    // Loop through the Array and display series of Rectangular Strips
    for (int i = 0 ; i < Arr.length ; ++i)
    {
        // Fill out the Rectangle
        g2.fillRect (x, y, Arr [i], 8);
        y = y - 15;
    }
    g2.dispose ();
}
} 
```

What should I use to animate the process. I also want to show which rectangular strips are being compared during the process of sorting.

Thank You

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:30:30.297

当我写一个类似的程序时，我`SortListener`用两个方法创建了一个接口：`onCompare()`和`onSwap()`. 我使用突出`onCompare()`显示与不同颜色进行比较的两个元素，并`onSwap()`通知 GUI 重新绘制 istelf。

我还为特定的排序算法创建了一个“SortingAlgorithm”抽象类和几个子类。`addSortListener()`定义为允许其他类注册侦听器的超类。然后在排序算法期间，我`onCompare()`在比较`onSwap()`后立即调用，并在交换两个元素后立即调用。

最后，我在其中进行绘画的 JPanel 实现了`SortListener`界面`onCompare()`并`onSwap()`通过重新绘制动画来响应和响应。

# ruby - 如何遍历字符串以将 nagios_service 检查构造为导出资源？

> ID：15422103
> 
> 赞同：0
> 
> 时间：2013-03-14T23:28:21.440
> 
> 标签：ruby, erb, puppet, nagios

我写了一个自定义事实，它返回一个逗号分隔的列表`addr:port`，如下所示：

```
sb_intl_conn => sbcms-t:22,sbsql05-wvuk-inst5:1434,sborc07-uk-t:1533,..,..,.. 
```

字符串中的元素数量因节点而异。我需要对它们中的每一个进行 Nagios tcp-port-check。我认为`sb_intl_conn.split(",")`会将这个字符串变成一个数组，然后我如何迭代它来做这样的事情？

```
@@nagios_service { "check_stat_${::fqdn}_${addr}_${port}":
    use                 => 'generic-service',
    check_command       => "remote-nrpe-tcp-check!${addr}!${port}",
    service_description => "V2::CON: ${addr} [Palms]",
    display_name        => "Connection check: ${addr}:${port}",
    servicegroups       => 'batch-worker',
    hostgroup_name      => 'batch-job',
} 
```

任何帮助将不胜感激。干杯！！

* * *

**更新：1**

我与模拟器 iamauser 的建议联系在一起，但还没有完全理解它。这就是我所做的：在我的 foo.pp 中：

```
class test::foo {

    define bar {
        $var1 = inline_template("<%= scope.lookupvar($name).split(':').first.to_s.chomp %>")
        $var2 = inline_template("<%= scope.lookupvar($name).split(':').last.to_s.chomp %>")
        notify {"${var1}_${var2}": }
    }
} 
```

然后在我的 node.pp 中：

```
$ifs = ['abc.com:80','xyz.co.uk:1512']
test::foo::bar {$ifs:} 
```

这会在节点上引发这些错误：

```
err: Could not retrieve catalog from remote server: Error 400 on SERVER: Failed to parse inline template: Could not find value for 'abc' in 65 at /etc/puppet/services/test/manifests/foo.pp:4 on node jobserver-01.local.cloud.uk
warning: Not using cache on failed catalog
err: Could not retrieve catalog; skipping run 
```

不明白我做错了什么。为什么是`Could not find value for 'abc'`；不是`abc.com`吗？任何的想法？？干杯！！

* * *

**更新：2**

我最终使用了 heira 并决定尝试最初的“哈希数组”想法并且在实现时遇到了一些问题：

这就是我在 heira 中所拥有的：

```
hiera -d -c /etc/puppet/hiera.yaml nag_chk m_env=talend s_env=local
[ ... ]
DEBUG: Thu Mar 21 12:28:02 +0000 2013: Got answer for key nagi_chk, final answer
DEBUG: Thu Mar 21 12:28:02 +0000 2013: Answer after outer loop = archimedes-db-02.svc.ft.com:1521 ftftp01-uvln-uk-p:22 www.google.com:80 ftaps01-lvpr-uk-local:8080
archimedes-db-02:1521 ftftp01-uvln-uk-p:22 google.com:80 
```

然后，在我的 foo.pp

```
class test::foo {

    define bar2 () {
        $var1 = $name['addr']
        $var2 = $name['port']
        notify {"*** ${var1}_${var2} *********": }
    }
} 
```

和我的node.pp：

```
$array_chk = hiera('nag_chk')
$urls = inline_template("<%= '$array_chk'.split(' ').map{|kv| v1,v2 = kv.split(':'); {'addr' => v1, 'port' => v2}} -%>")
test::foo::bar2 {$urls:} 
```

和往常一样，我收到一个错误：

> 错误：无法从远程服务器检索目录：服务器上的错误 400：在节点 talend 上的 /etc/puppet/services/talend/talend/manifests/foo.pp:10 上使用 0 访问名称时，名称不是哈希或数组- jobserver-01.local.cloud.ft.com 警告：未在失败的目录上使用缓存错误：无法检索目录；跳过跑步

我做错了什么？据我所见，`irb`控制台中正确格式的“哈希数组”：

```
irb(main):001:0> STRING = "archimedes-db-02:1521 ftftp01-uvln-uk-p:22 google.com:80"
=> "archimedes-db-02:1521 ftftp01-uvln-uk-p:22 google.com:80"
irb(main):003:0>
irb(main):002:0> STRING.split(' ').map{|kv| v1,v2 = kv.split(':'); {'addr' => v1, 'port' => v2}}
=> [{"addr"=>"archimedes-db-02", "port"=>"1521"}, {"addr"=>"ftftp01-uvln-uk-p", "port"=>"22"}, {"addr"=>"google.com", "port"=>"80"}] 
```

任何进一步的想法？干杯！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:46:43.863

此示例可能有助于解决您的特定情况。

```
 $foo = [{"addr" => "bar", "port" => "1"},                                     
          {"addr" => "bat", "port" => "2"}]                                     
  testmod::bar {$foo:}                                                          
  define testmod::bar () {                                                      
    $var1 = $name["addr"]                                                       
    $var2 = $name["port"]                                                       
    notify {"${var1}_${var2}": }                                                
  } 
```

将 nagios 类型放在定义类型中。您可能必须将 csv 更改为哈希。

更新：@MacUsers 更新后添加。以下对我有用：

```
 $foo = ["abc.com:80","xyz.co.uk:1512"]
  testmod::bar {$foo:}
  define testmod::bar () {
    $var1 = inline_template("<%= '$name'.split(':').first.to_s.chomp %>")
    $var2 = inline_template("<%= '$name'.split(':').last.to_s.chomp %>")
    notify {"${var1}_${var2}": }
  } 
```

运行 puppet agent 给了我这个：

```
Notice:     /Stage[main]/Testmodule/Testmodule::Testmod::Bar[abc.com:80]/Notify[abc.com_80]/message: defined 'message' as 'abc.com_80'
Notice: xyz.co.uk_1512
Notice:    /Stage[main]/Testmodule/Testmodule::Testmod::Bar[xyz.co.uk:1512]/Notify[xyz.co.uk_1512]/message: defined 'message' as 'xyz.co.uk_1512' 
```

# c# - Deserialization XML elements which are References (RDF Resources)

> ID：15422105
> 
> 赞同：0
> 
> 时间：2013-03-14T23:28:22.617
> 
> 标签：c#, xml, serialization, rdf

I have XML file where some elements are resources inside. like

```
<cim:BusbarSection rdf:ID="Busbar_05" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"       xmlns:cim="http://iec.ch/TC57/2001/CIM-schema-cim10#">
<cim:Naming.name>30189P0205_Busbar_01</cim:Naming.name>
<cim:Equipment.MemberOf_EquipmentContainter rdf:resource="#VL_05" />
</cim:BusbarSection> 
```

See the Equipment.Equipment.MemberOf_EquipmentContainter is a resource define in a same XML file but somewhere else like

```
<cim:VoltageLevel rdf:ID="VL_05" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"  xmlns:cim="http://iec.ch/TC57/2001/CIM-schema-cim10#">
<cim:Naming.name>VL_0.22_1</cim:Naming.name>
<cim:VoltageLevel.MemberOf_Substation rdf:resource="#Substation_01" />
<cim:VoltageLevel.BaseVoltage rdf:resource="#BaseVoltage_02" /></cim:VoltageLevel> 
```

In my C# code, i have class structure Like

```
 [XmlType("BusbarSection", Namespace = "http://iec.ch/TC57/2001/CIM-schema-cim10#")] 
   public class BusbarSection:Connector 
   {
       public BusbarSection()
       {
       }

   }
    public class Connector:Core.ConductingEquipment
   {

      public Connector()
      {
      }

   }
   public class ConductingEquipment:Equipment 
    {
        //functions and constcturess...
    }
    public class Equipment:PowerSystemResource
   {
       [XmlElement("Equipment.MemberOf_EquipmentContainer")]
       public EquipmentContainer MemberOf_EquipmentContainer; 

       public Equipment()
       {
       }

   }

public class EquipmentContainer:PowerSystemResource
{

    public Topology.ConnectivityNode[] ConnectivityNodes;
    public Equipment[] Contains_Equipments; 

    public EquipmentContainer()
    {

    }

} 
```

I am trying to serialize the xml file, it is working good but the elements with as resource EquipmentContainer is coming null.

I am not sure how to serialize xml elements that are as resources in xml. I am missing some concepts in serialization of xmls in c# , i couldn't find how to look for help / Google this question.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T09:29:06.173

如果您正在使用 RDF，为什么不使用 RDF 库呢？RDF 可以被序列化为 XML，但正如例如[this](https://stackoverflow.com/a/4182777/1445526)中所描述的，有几种方法可以做到这一点。例如，`rdf:ID`属性可以替换为`rdf:about`- 这可能会破坏您的解析器。

[您可能会对使用 RDF dotnetRDF](http://www.dotnetrdf.org/)的 .Net 库感兴趣。

# xcode - 当两个视图同时可见时，从不同的视图更新 UITableview

> ID：15422111
> 
> 赞同：0
> 
> 时间：2013-03-14T23:28:53.703
> 
> 标签：xcode, ipad, uitableview

查看我的**iPad**应用程序，我有几个容器视图。Containerviews 使我能够**在一个 iPad 屏幕上同时显示所有四个 iphone 视图**。一个名为 TrackingViewController 的视图上有一个 UITableView （称为**table**），我想从第二个视图控制器 (MainViewController) 上的按钮刷新它，这在同一个 iPad 屏幕上也可见。我调用代码

```
 TrackingViewController *trackView = [[TrackingViewController alloc] init];
    [trackView.view setNeedsDisplay];
    [trackView.table reloadData]; 
```

在 MainViewController 中按钮的 IBAction 结束时，数据传输完美，但 TrackingViewController 上的表本身并没有在**视觉上**更新以显示此数据。

如果我随后手动启动一个完全不同的模态视图控制器并在应用程序在 iPad 上运行时在 TrackingViewController 上将其关闭，那么数据就会显示出来。当按下 MainViewController 上的按钮时， **如何**使 TrackingViewController 上的视图或数据自动更新？![在此处输入图像描述](../Images/911af58c4c7c9b8bcb3c6bebbb14d732.png)

iPad 模拟器可能会有所帮助。 ![在此处输入图像描述](../Images/b7368770112203ae778acd702d2e7757.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:42:51.543

我也不明白你的问题。。

我唯一看到的是，你想更新两个 UITableViews 但在你的代码中你只是重新加载一个 TableView 的数据？！？

[trackView.table reloadData]; [其他表重载数据];

但是我真的不明白你的问题......

如果您的其他 TableView 在另一个班级，请尝试这样的事情......

在 TrackingViewController.h 中：

```
- (void)refreshMyTable; 
```

在 TrackingViewController.m 中：

```
- (void)refreshMyTable{
      [table reloadData];
} 
```

在您的 MainViewController.m 操作中，这应该刷新两个表：

```
- (IBAction)theRefreshingAction{
     TrackingViewController *trackView = [[TrackingViewController alloc] init];
     [trackView refreshMyTable]; //This refreshes Table in trackView
     [mainViewTable reloadData]; //This in MainView
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T03:07:16.797

通过使用以下帖子最终使用 NSNotificationCenter：

[从 iphone 的不同视图控制器调用函数](https://stackoverflow.com/questions/2388990/calling-a-function-from-a-different-view-controller-for-iphone)

就我而言，调用仅包含 [table reloadData]; 的函数 不会工作，但调用我的 performFetch 函数确实（它也称为 [table reloadData]; 在它的末尾）。

# knockout.js - 为计算的 Observable Knockout.js 设置默认值

> ID：15422118
> 
> 赞同：0
> 
> 时间：2013-03-14T23:29:12.883
> 
> 标签：knockout.js

我是 Knockout.js 的新手，我在 UI 中有 3 个字段。产品价值。数量总计

计算出的 observable 一切正常，并且可以保存数据。出于某些业务原因，总数将在后端更改。

在检索数据时，我需要将数据库中的总数显示为初始值，但是当用户更改产品和值时，应该使用原始计算函数。

我尝试了 bindingHandlers 但无法正确处理..

帮助将是非常可观的。

```
var TsFoundationDeviceModel = function(product,qty,total) {
    var self = this;
    self.product = ko.observable(product);
    self.quantity= ko.observable(qty);
    self.computedExample = ko.computed(function() {
        return self.product() * self.quantity() ;
    });
}

<input name="product" data-bind="value:product">
<input name="value" data-bind="value:value">
<input name="total" data-bind="value:computedExample"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T13:47:50.220

您可以做到这一点的唯一方法是跟踪初始化程序。因此，第一次调用视图模型时，将初始化设置为 true 并检查总数是否未定义。如果是，则返回总计，重置初始化。从那里开始，它将始终根据其他两个字段更新计算值。

这是相同的小提琴（顺便说一下，您的绑定中有错误，没有名称为“值”的属性，我认为它是数量

[http://jsfiddle.net/sujesharukil/YTDZ9/](http://jsfiddle.net/sujesharukil/YTDZ9/)

```
var TsFoundationDeviceModel = function(product,qty,total) {
    var 
    self = this;
    self.initialize = ko.observable(true);
    self.product = ko.observable(product);
    self.quantity= ko.observable(qty);
    self.computedExample = ko.computed(function() {
        var value = self.product() * self.quantity();
        if(self.initialize())
        {
            self.initialize(false);
            if(total != undefined && total != null)
                return total;
        }
        return value ;
    });
}

ko.applyBindings(new TsFoundationDeviceModel(1, 1, 3)); 
```

本质上，您将只返回一次总计，这是您第一次创建视图模型的实例。

希望这可以帮助！

-苏杰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:50:11.313

据我所知，您存储了 3 个输入，您可以从数据库中获得它的值。

当用户单击某个保存按钮时，应将数据发送到服务器以更新或插入 DB，并且当加载表单时，应使用 DB 中的用户数据填充输入。

因此，您应该为此使用[KnockoutJS 映射插件](http://knockoutjs.com/documentation/plugins-mapping.html)。

使用该插件，您只需要对您的服务器进行 ajax 调用以获取数据并将其转换为然后在您的 html 上`ViewModel`使用它。`ViewModel`

通过使用相同的插件，您可以将其转换`ViewModel`为 JSON 格式并将其发送回您的服务器以将其保存在数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T12:39:13.973

如果我正确理解您想要什么，您可以让 Computed 本身返回初始值，除非可观察值发生变化。

```
self.product = ko.observable(product);
self.quantity= ko.observable(qty);
self.orig_product = ko.observable(product);
self.orig_quantity= ko.observable(qty);

self.computedExample = ko.computed(function() {
    if (self.product() !== self.orig_product
        || self.quantity() !== self.orig_quantity()) {
        return self.product() * self.quantity() ;
    } else {
        // return the initial value
    }
}); 
```

# android - notifyDataSetChange 不适用于自定义适配器

> ID：15422120
> 
> 赞同：144
> 
> 时间：2013-03-14T23:29:19.460
> 
> 标签：android, listview, baseadapter, notifydatasetchanged

当我重新填充我`ListView`的`Adapter`.

**问题**：

当我`updateReceiptsList`从 my调用时`Adapter`，数据会刷新，但 my`ListView`不会反映更改。

**问题**：

为什么`ListView`我打电话时不显示新数据`notifyDataSetChanged`？

**适配器**：

```
public class ReceiptListAdapter extends BaseAdapter {

    public List<Receipt> receiptlist;
    private Context context;
    private LayoutInflater inflater;
    private DateHelpers dateH;

    public ReceiptListAdapter(Activity activity, Context mcontext, List<Receipt> rl) {
        context = mcontext;
        receiptlist = rl;
        Collections.reverse(receiptlist);
        inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        dateH = new DateHelpers();
    }

    @Override
    public int getCount() {
        try {
            int size = receiptlist.size();
            return size;
        } catch(NullPointerException ex) {
            return 0;
        }
    }

    public void updateReceiptsList(List<Receipt> newlist) {
        receiptlist = newlist;
        this.notifyDataSetChanged();
    }

    @Override
    public Receipt getItem(int i) {
        return receiptlist.get(i);
    }

    @Override
    public long getItemId(int i) {
        return receiptlist.get(i).getReceiptId() ;
    }

    private String getPuntenString(Receipt r) {
        if(r.getPoints().equals("1")) {
            return "1 punt";
        }
        return r.getPoints()+" punten";
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View vi=convertView;

        final Receipt receipt = receiptlist.get(position);
        ReceiptViewHolder receiptviewholder;
        Typeface tf_hn = Typeface.createFromAsset(context.getAssets(), "helveticaneue.ttf");        
        Typeface tf_hn_bold = Typeface.createFromAsset(context.getAssets(), "helveticaneuebd.ttf");

        if (vi == null) { //convertview==null
            receiptviewholder = new ReceiptViewHolder();
            vi = inflater.inflate(R.layout.view_listitem_receipt, null);
            vi.setOnClickListener(null);
            vi.setOnLongClickListener(null);
            vi.setLongClickable(false);
            receiptviewholder.shop = (TextView) vi.findViewById(R.id.tv_listitemreceipt_shop);
            receiptviewholder.date = (TextView) vi.findViewById(R.id.tv_listitemreceipt_date);
            receiptviewholder.price = (TextView) vi.findViewById(R.id.tv_listitemreceipt_price);
            receiptviewholder.points = (TextView) vi.findViewById(R.id.tv_listitemreceipt_points);
            receiptviewholder.shop.setTypeface(tf_hn_bold);
            receiptviewholder.price.setTypeface(tf_hn_bold);
            vi.setTag(receiptviewholder);
        }else{//convertview is not null
            receiptviewholder = (ReceiptViewHolder)vi.getTag();
        }

        receiptviewholder.shop.setText(receipt.getShop());
        receiptviewholder.date.setText(dateH.timestampToDateString(Long.parseLong(receipt.getPurchaseDate())));
        receiptviewholder.price.setText("€ "+receipt.getPrice());
        receiptviewholder.points.setText(getPuntenString(receipt));

        vi.setClickable(false);
        return vi;
    }

    public static class ReceiptViewHolder {
        public TextView shop;
        public TextView date;
        public TextView price;
        public TextView points;
    }

    public Object getFilter() {
        // XXX Auto-generated method stub
        return null;
    }

} 
```

- 编辑：

**找到解决方法**

只是为了有一些我现在做的功能代码：

```
listview.setAdapter( new ReceiptListAdapter(activity,mcontext, -new dataset-); 
```

工作，但不是它应该如何工作。

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2013-03-15T08:28:01.897

改变你的方法

```
public void updateReceiptsList(List<Receipt> newlist) {
    receiptlist = newlist;
    this.notifyDataSetChanged();
} 
```

到

```
public void updateReceiptsList(List<Receipt> newlist) {
    receiptlist.clear();
    receiptlist.addAll(newlist);
    this.notifyDataSetChanged();
} 
```

因此，您在适配器中保留与 DataSet 相同的对象。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-04-21T10:31:19.793

我有同样的问题，我意识到这一点。当我们创建适配器并将其设置为列表视图时，列表视图将指向适配器保存的内存中某处的对象，该对象中的数据将显示在列表视图中。

```
adapter = new CustomAdapter(data);
listview.setadapter(adapter); 
```

如果我们再次使用另一个数据为适配器创建一个对象并 notifydatasetchanged()：

```
adapter = new CustomAdapter(anotherdata);
adapter.notifyDataSetChanged(); 
```

这不会影响列表视图中的数据，因为列表指向不同的对象，该对象对适配器中的新对象一无所知，并且 notifyDataSetChanged() 没有任何影响。所以我们应该改变对象中的数据，避免再次为适配器创建一个新对象

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-08-01T06:37:34.553

正如我已经解释了这个问题背后的原因以及如何在不同的答案线程中处理[它](https://stackoverflow.com/a/20479071/1084174)。我仍然在这里分享解决方案摘要。

`notifyDataSetChanged()`对您不起作用的主要原因之一是，

**您的适配器失去了对您的列表的引用**。

在创建新列表并将其添加到`Adapter`. 始终遵循以下准则：

1.  `arrayList`在全局声明时初始化。
2.  直接将 List 添加到适配器，而不检查 null 和空值。直接将适配器设置到列表中（不检查任何条件）。适配器向您保证，无论您对数据进行更改，`arrayList`它都会处理它，但永远不会丢失引用。
3.  始终修改 arrayList 本身中的数据（如果您的数据是全新的，而不是您可以调用`adapter.clear()`并且`arrayList.clear()`在实际将数据添加到列表之前），但不要设置适配器，即如果新数据填充`arrayList`在 `adapter.notifyDataSetChanged()`

希望这可以帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-15T00:18:37.180

也许尝试刷新您的 ListView：

`receiptsListView.invalidate()`.

编辑：另一个想法出现在我的脑海中。只是为了记录，尝试禁用列表视图缓存：

```
<ListView
    ...
    android:scrollingCache="false"
    android:cacheColorHint="@android:color/transparent"
    ... /> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-12-22T10:10:22.647

我有同样的问题使用`ListAdapter`

我让 Android Studio 为我实现方法，这就是我得到的：

```
public class CustomAdapter implements ListAdapter {
    ...
    @Override
    public void registerDataSetObserver(DataSetObserver observer) {

    }

    @Override
    public void unregisterDataSetObserver(DataSetObserver observer) {

    }
    ...
} 
```

问题是这些方法不会调用`super`实现，因此`notifyDataSetChange`永远不会被调用。

手动删除这些覆盖或添加超级调用，它应该再次工作。

```
@Override
public void registerDataSetObserver(DataSetObserver observer) {
    super.registerDataSetObserver(observer);
}

@Override
public void unregisterDataSetObserver(DataSetObserver observer) {
    super.unregisterDataSetObserver(observer);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-27T17:32:44.773

```
class StudentAdapter extends BaseAdapter {
    ArrayList<LichHocDTO> studentList;

    private void capNhatDuLieu(ArrayList<LichHocDTO> list){
        this.studentList.clear();
        this.studentList.addAll(list);
        this.notifyDataSetChanged();
    }
} 
```

你可以试试。它对我有用

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-13T09:26:24.513

如果`adapter`设置为`AutoCompleteTextView`则`notifyDataSetChanged()`不起作用。

需要这个来更新适配器：

```
myAutoCompleteAdapter = new ArrayAdapter<String>(MainActivity.this, 
        android.R.layout.simple_dropdown_item_1line, myList);

myAutoComplete.setAdapter(myAutoCompleteAdapter); 
```

参考：[http ://android-er.blogspot.in/2012/10/autocompletetextview-with-dynamic.html](http://android-er.blogspot.in/2012/10/autocompletetextview-with-dynamic.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-05-30T11:37:12.040

如果您有任何机会登陆该线程并想知道为什么`adapter.invaidate()`或`adapter.clear()`方法不存在于您的案例中，那么可能是因为您可能正在使用该问题的提问者使用的`RecyclerView.Adapter`而不是使用的方法。`BaseAdapter`如果清除`list`或`arraylist`没有解决您的问题，那么您可能正在制作*两个或多个*for `adapter`ex. 实例：

*主要活动*

```
...

adapter = new CustomAdapter(list);
adapter.notifyDataSetChanged();
recyclerView.setAdapter(adapter);

... 
```

和
*一些片段*

```
...

adapter = new CustomAdapter(newList);
adapter.notifyDataSetChanged();

... 
```

如果在第二种情况下，您期望回收器视图中的膨胀视图列表发生变化，那么它不会发生，因为在第二次`adapter`创建未附加到回收器视图的新实例时。第二个适配器中的设置`notifyDataSetChanged`不会改变回收站视图的内容。为此，在*SomeFragment*中创建一个回收器视图的新实例并将其附加到适配器的新实例。

*一些片段*

```
...

recyclerView = new RecyclerView();
adapter = new CustomAdapter();
recyclerView.setAdapter(adapter);

... 
```

虽然，我不建议创建同一个适配器和回收器视图的多个实例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-22T21:00:01.253

就我而言，我只是忘记添加我的片段`mRecyclerView.setAdapter(adapter)`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-01T22:01:11.027

我犯了一个非常菜鸟的错误，我在像这样初始化适配器本身之前设置了 RecyclerView 的适配器。

```
 // Assuume oneOffJobTasksListRVAdapter is declared already 
    recyclerView.setAdapter(oneOffJobTasksListRVAdapter);        
    oneOffJobTasksListRVAdapter = new OneOffJobTasksListRVAdapter(); 
```

换行解决了我的问题。

```
 oneOffJobTasksListRVAdapter = new OneOffJobTasksListRVAdapter();
    recyclerView.setAdapter(oneOffJobTasksListRVAdapter); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-03-22T10:32:17.070

**添加此代码**

```
runOnUiThread(new Runnable() { public void run() {
               adapter = new CustomAdapter(anotherdata);
            adapter.notifyDataSetChanged();
            }
        }); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-05-16T08:24:05.740

我有同样的问题，但我刚刚完成它！

你应该改为

```
public class ReceiptListAdapter extends BaseAdapter {

    public List<Receipt> receiptlist;
    private Context context;
    private LayoutInflater inflater;
    private DateHelpers dateH;
    private List<ReceiptViewHolder> receiptviewlist;

    public ReceiptListAdapter(Activity activity, Context mcontext, List<Receipt> rl) {
        context = mcontext;
        receiptlist = rl;
        receiptviewlist = new ArrayList<>();
        receiptviewlist.clear();
        for(int i = 0; i < receiptlist.size(); i++){
          ReceiptViewHolder receiptviewholder = new ReceiptViewHolder();
          receiptviewlist.add(receiptviewholder);
        }
        Collections.reverse(receiptlist);
        inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        dateH = new DateHelpers();
    }

    @Override
    public int getCount() {
        try {
            int size = receiptlist.size();
            return size;
        } catch(NullPointerException ex) {
            return 0;
        }
    }

    public void updateReceiptsList(List<Receipt> newlist) {
        receiptlist = newlist;
        this.notifyDataSetChanged();
    }

    @Override
    public Receipt getItem(int i) {
        return receiptlist.get(i);
    }

    @Override
    public long getItemId(int i) {
        return receiptlist.get(i).getReceiptId() ;
    }

    private String getPuntenString(Receipt r) {
        if(r.getPoints().equals("1")) {
            return "1 punt";
        }
        return r.getPoints()+" punten";
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View vi=convertView;

        final Receipt receipt = receiptlist.get(position);
        ReceiptViewHolder receiptviewholder;
        Typeface tf_hn = Typeface.createFromAsset(context.getAssets(), "helveticaneue.ttf");        
        Typeface tf_hn_bold = Typeface.createFromAsset(context.getAssets(), "helveticaneuebd.ttf");

        if (vi == null) { //convertview==null
            ReceiptViewHolder receiptviewholder = receiptviewlist.get(position);
            vi = inflater.inflate(R.layout.view_listitem_receipt, null);
            vi.setOnClickListener(null);
            vi.setOnLongClickListener(null);
            vi.setLongClickable(false);
            receiptviewholder.shop = (TextView) vi.findViewById(R.id.tv_listitemreceipt_shop);
            receiptviewholder.date = (TextView) vi.findViewById(R.id.tv_listitemreceipt_date);
            receiptviewholder.price = (TextView) vi.findViewById(R.id.tv_listitemreceipt_price);
            receiptviewholder.points = (TextView) vi.findViewById(R.id.tv_listitemreceipt_points);
            receiptviewholder.shop.setTypeface(tf_hn_bold);
            receiptviewholder.price.setTypeface(tf_hn_bold);
            vi.setTag(receiptviewholder);
        }else{//convertview is not null
            receiptviewholder = (ReceiptViewHolder)vi.getTag();
        }

        receiptviewholder.shop.setText(receipt.getShop());
        receiptviewholder.date.setText(dateH.timestampToDateString(Long.parseLong(receipt.getPurchaseDate())));
        receiptviewholder.price.setText("€ "+receipt.getPrice());
        receiptviewholder.points.setText(getPuntenString(receipt));

        vi.setClickable(false);
        return vi;
    }

    public static class ReceiptViewHolder {
        public TextView shop;
        public TextView date;
        public TextView price;
        public TextView points;
    }

    public Object getFilter() {
        // XXX Auto-generated method stub
        return null;
    }

} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2020-04-24T13:56:03.003

我的情况不同，但其他人的情况可能相同

对于那些仍然找不到解决方案并尝试了上述所有方法的人，如果您在片段中使用适配器，那么它无法正常工作的原因`fragment could be recreating so the adapter is recreating everytime the fragment recreate`

您应该在初始化之前验证适配器和对象列表是否为空

```
if(adapter == null){
  adapter = new CustomListAdapter(...);
}
...

if(objects == null){
  objects = new ArrayList<>();
}
```

# asp.net-mvc-4 - 如何在 MVC4 中呈现远程 ReportViewer aspx 页面？

> ID：15422124
> 
> 赞同：11
> 
> 时间：2013-03-14T23:29:31.877
> 
> 标签：asp.net-mvc-4, reporting-services, webforms, reportviewer

我正在开发一个需要使用 ReportViewer 从 SSRS 呈现远程报告的 MVC4 应用程序。在这个论坛的帮助下，我设法让页面在 MVC 下呈现，但回调不起作用（加载初始页面）。导出报告工作正常（并提供所有页面）。当我检查页面时，我注意到更改页面后出现以下错误：

> 未捕获的 Sys.WebForms.PageRequestManagerParserErrorException：Sys.WebForms.PageRequestManagerParserErrorException：无法解析从服务器接收到的消息。

我发现[这篇](http://weblogs.asp.net/rajbk/archive/2010/05/11/running-asp-net-webforms-and-asp-net-mvc-side-by-side.aspx)关于结合 MVC 和 Web 表单的文章，但由于没有更多的主布局页面，它看起来已经过时了。这与[How can I use a reportviewer control in an asp.net mvc 3 razor view？](https://stackoverflow.com/questions/6144513/how-can-i-use-a-reportviewer-control-in-an-asp-net-mvc-3-razor-view)因为该文章仅适用于本地报告。我尝试将 AsyncRendering 更改为 true 和 false。如果为真，则根本不加载。任何建议将不胜感激。

更新：AsyncRendering 行为[似乎](https://connect.microsoft.com/VisualStudio/feedback/details/541538/webforms-ssrs-viewer-hangs-when-using-asyncrendering-true)在 Visual Studio 的早期版本之间发生了变化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T19:29:49.533

最后，由于不可接受的安全风险，我最终不得不放弃我的原始答案和回调标准。在我的例子中，我编写了控制器代码，将报告作为 HTML 呈现为一个字节数组，然后从那里到一个 FileContentResult，MVC 可以很好地呈现为静态 HTML 页面。导出为 PDF、Excel 或任何其他选项最终将以类似的方法实现，方法是将 Render 参数从 HTML4.0 更改为任何合适的（PDF、XLS）和 MIME 类型。此方法适用于 SQL Server 2008R2 及更高版本。我还没有尝试过使用以前版本的 SQL Server。

```
[OutputCache(Duration = 120, VaryByParam = "id")]
public ActionResult ExportHTML(int id)
{
    // we need to add code to check the user's access to the preliminary report.
    // Also need to consolidate code between ExportHTML and ExportPDF.
    var userid = <userid>;
    var password = <password>;
    var domain = <domain>;
    IReportServerCredentials irsc = new myApp.Models.CustomReportCredentials(userid,
        password, domain);
    var parametersCollection = new List<ReportParameter>();
    parametersCollection.Add(new ReportParameter("Snapshot", id.ToString(), false));
    ReportViewer rv = new Microsoft.Reporting.WebForms.ReportViewer();
    rv.ProcessingMode = ProcessingMode.Remote;
    rv.ServerReport.ReportServerCredentials = irsc;
    rv.ServerReport.ReportPath = <reportpath>;
    rv.ServerReport.ReportServerUrl = new Uri("http://localhost/ReportServer");
    rv.ServerReport.SetParameters(parametersCollection);

    rv.ServerReport.Refresh();
    byte[] streamBytes = null;
    string mimeType = "";
    string encoding = "";
    string filenameExtension = "";
    string[] streamids = null;
    Warning[] warnings = null;

    streamBytes = rv.ServerReport.Render("HTML4.0", null, out mimeType, out encoding,
                                         out filenameExtension, out stream ids,
                                         out warnings);
    var HTMLReport = File(streamBytes, "text/html");
    return HTMLReport;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T18:13:48.837

我仍然希望得到更好的答案，但与此同时，我的解决方案似乎满足标准。它利用了 Kendo Web Window（所以我想你理论上可以使用 jQuery 编写自己的）。我还没有修改它来传递参数，但这是一个开始。我还没有确保重定向操作，因此用户目前可以查看源，从 jQuery 加载中获取 URL，转到该地址并从那里获取基础报告 URL。我将考虑将其标记为 ChildActionOnly 或其他确保该操作仅适用于我的窗口的方法。我还发现我可以将报告呈现为 HTML4.0，在 FileResult 中填充内容并以这种方式加载内容 - 但报告是静态 HTML。

看法：

```
 @(Html.Kendo().Grid(Model)
    .Name("IndexGrid")
    .Columns(col => 
    {
        col.Bound(c => c.SchoolYear);
        col.Bound(c => c.SubmissionTypeDesc);
        col.Bound(c => c.EntityDesc);
        col.Bound(c => c.SubmissionDate);
        col.Bound(c => c.UserName);
        col.Bound(c => c.Certified);
        col.Command(c => 
            {
                c.Custom("Edit")
                    .Text("View")
                    .Action("Edit", "Draft");
                c.Custom("Preview")
                    .Click("windowOpen");
                c.Custom("Certify")
                    .Action("Certify", "Draft");
                c.Custom("Download")
                    .Action("DumpExcel", "Draft");
            }
            ).Title("<b>Actions</b>")
            .HtmlAttributes(new { style = "width:200px;" });
    })
    .DataSource(ds => ds.Server()
        .Model(model => model.Id(pk => pk.snapshot_id))
        )
    .Sortable(sort => sort.Enabled(true).SortMode(GridSortMode.MultipleColumn).AllowUnsort(true))
    .Reorderable(reorder => reorder.Columns(true))
    .Groupable(group => group.Enabled(true))
    )
</article>

@(Html.Kendo().Window()
      .Name("window") //The name of the window is mandatory. It specifies the "id" attribute of the widget.
      .Title("Preliminary Report") //set the title of the window
      .LoadContentFrom("Redir", "Reports") //define the Action and Controller name
      .Visible(false)
      .Iframe(true)
      .Resizable()
      .Width(750)
      .Height(500)
      .Scrollable(false)
      .Draggable()
          .Actions(a =>
          {
              a.Refresh();
              a.Minimize();
              a.Maximize();
              a.Close();
          })

)
<script>
    function windowOpen(e) {
        e.preventDefault();
        var window = $("#window").data("kendoWindow");
        window.open();
    }
</script> 
```

报告控制器片段：

```
public ActionResult Redir()
{
    return RedirectPermanent("../ASPReports/ReportForm.aspx");
} 
```

报告表格.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="~/ASPReports/ReportForm.aspx.cs" Inherits="MyApp.Reports.ReportForm"%>

<%@ Register assembly="Microsoft.ReportViewer.WebForms, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" namespace="Microsoft.Reporting.WebForms" tagprefix="rsweb" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title></title>
</head>
<body>
    <form id="reportForm" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <div>
        <rsweb:ReportViewer ID="mainReportViewer" runat="server"  SizeToReportContent="true">
        </rsweb:ReportViewer>
    </div>
    </form>
</body>
</html> 
```

ReportForm.aspx.cs（代码隐藏）：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        // credentials - could pull from config
        var userid = ""; 
        var password = "";
        var domain = "";

        IReportServerCredentials irsc = new CustomReportCredentials(userid, password, domain);
        mainReportViewer.ServerReport.ReportServerCredentials = irsc;

        //mainReportViewer.ServerReport.ReportServerUrl =
        //    new Uri(ConfigurationManager.AppSettings["ReportServerUrl"]);
        mainReportViewer.ServerReport.ReportServerUrl =
            new Uri("http://localhost/ReportServer");
        mainReportViewer.ServerReport.ReportPath = "Path";

        mainReportViewer.ProcessingMode = ProcessingMode.Remote;
        mainReportViewer.ShowParameterPrompts = false;
        mainReportViewer.ShowRefreshButton = false;
        mainReportViewer.ShowWaitControlCancelLink = false;
        mainReportViewer.ShowBackButton = false;
        mainReportViewer.ShowCredentialPrompts = false;
        var parametersCollection = new List<ReportParameter>();
        //parametersCollection.Add(new ReportParameter("Snapshot", "##", false));
        mainReportViewer.ServerReport.SetParameters(parametersCollection);
        mainReportViewer.ServerReport.Refresh();
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T07:46:39.593

只需使用 IFRAME。创建另一个网站或虚拟目录，使用 Web 窗体创建应用程序，然后在 MVC 应用程序的 IFRAME 中显示他的报表查看器页面。您可以使用查询字符串设置报告参数。我曾多次使用这种方式将报表查看器放入不同的系统中。

# c# - ASP.NET C# 代码中的互斥锁发布问题

> ID：15422125
> 
> 赞同：3
> 
> 时间：2013-03-14T23:29:32.890
> 
> 标签：c#, asp.net, locking, mutex

我不确定如何解决这个问题。我有一个这样声明的互斥锁：

```
public class MyNamedLock
{
    private Mutex mtx;
    private string _strLkName;

    public MyNamedLock(string strLockName)
    {
        _strLkName = strLockName;
        //...

        mtx = new Mutex(false, _strLkName, out bCreatedNew, mSec);
    }

    public bool enterLockWithTimeout(int nmsWait = 30 * 1000)
    {
        _nmsWaitLock = nmsWait;

        //Wait
        return mtx.WaitOne(nmsWait);
    }

    public void leaveLock()
    {
        _nmsWaitLock = 0;

        //Release it
        mtx.ReleaseMutex();
    }
} 
```

然后在 ASP.NET 页面中使用它：

```
public class MyClass
{
    private MyNamedLock gl;

    public MyClass()
    {
        gl = new MyNamedLock("lock name");

    }

    public void funct()
    {
        try
        {
            //Enter lock
            if (gl.enterLockWithTimeout())
            {
                //Do work
            }
            else
                throw new Exception("Failed to enter lock");
        }
        finally
        {
            //Leave lock
            gl.leaveLock();
        }
    }
} 
```

这段代码在我的开发环境中没有给我任何麻烦，但在生产中它有时会抛出这个异常：

> 对象同步方法是从未同步的代码块中调用的。

描述有点模糊，但只是进行跟踪我发现该`mtx.ReleaseMutex();`部分引发了异常。这是什么意思以及如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:33:13.327

在您的 finally 块中，您将释放互斥锁，无论您是否在 try 块中实际获得了它。

在

```
try
{
    //Enter lock
    if (gl.enterLockWithTimeout())
    {
        //Do work
    }
    else throw new Exception("Failed to enter lock");
}
finally
{
    //Leave lock
    gl.leaveLock();
} 
```

如果`gl.enterLockWithTimeout`返回 false，您将抛出异常，然后尝试释放 finally 块中的锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:22:27.297

您的课程以及使用它的方式存在一些问题。

1.  仅当您先前已锁定时才必须释放互斥锁（这是您的错误）
2.  您需要关闭并处置您打开的互斥锁
3.  最好在您使用它之前创建它，而不是在您创建类时创建它`MyClass`。

因此，我建议首先将您的课程更改为：

```
public class MyNamedLock
{
    private Mutex mtx = null;
    private string _strLkName;

    // to know if finally we get lock
    bool cNeedToBeRelease = false;

    public MyNamedLock(string strLockName)
    {
        _strLkName = strLockName;
        //...

        mtx = new Mutex(false, _strLkName, out bCreatedNew, mSec);
    }

    public bool enterLockWithTimeout(int nmsWait = 30 * 1000)
    {
        _nmsWaitLock = nmsWait;
        bool cLock = false;
        try
        {
            cLock = mtx.WaitOne(nmsWait, false);
            cNeedToBeRelease = cLock;    
        }
        catch (AbandonedMutexException)
        {
            // http://stackoverflow.com/questions/654166/wanted-cross-process-synch-that-doesnt-suffer-from-abandonedmutexexception
            // http://msdn.microsoft.com/en-us/library/system.threading.abandonedmutexexception.aspx
            cNeedToBeRelease = true;
        }
        catch (Exception x)
        {
            // log the error
            Debug.Fail("Check the reason of fail:" + x.ToString());
        }            

        return cLock;        
    }

    public void leaveLock()
    {
        _nmsWaitLock = 0;

        if (mtx != null)
        {
            if (cNeedToBeRelease)
            {
                try
                {
                    mtx.ReleaseMutex();
                    cNeedToBeRelease = false;    
                }
                catch (Exception x)
                {
                    Debug.Fail("Check the reason of fail:" + x.ToString());
                }
            }

            mtx.Close();
            mtx.Dispose();
            mtx = null;
        }
    }
} 
```

这是您必须调用该类的方式：

```
public class MyClass
{
    public MyClass()
    {
    }

    public void funct()
    {
        var gl = new MyNamedLock("lock name");
        try
        {
            //Enter lock
            if (gl.enterLockWithTimeout())
            {
                //Do work
            }
            else
                throw new Exception("Failed to enter lock");
        }
        finally
        {
            //Leave lock
            gl.leaveLock();
        }
    }
} 
```

# objective-c - 我们如何使用 [[NSOperationQueue new]addOperationWithBlock: 设置优先级？

> ID：15422129
> 
> 赞同：2
> 
> 时间：2013-03-14T23:30:02.940
> 
> 标签：objective-c, xcode4.5

```
NSDate *dateStartAutoComplete = [NSDate date];

[[NSOperationQueue new]addOperationWithBlock:^{
    NSTimeInterval startFetching = [NSDate.date timeIntervalSinceDate:dateStartAutoComplete];
    PO(@(startFetching)); 
```

...

结果：

```
2013-03-15 06:00:12.413 BadgerNew[4120:907] @(tiTotalTime): 0.353954017162323
2013-03-15 06:00:13.476 BadgerNew[4120:8d23] @(startFetching): 0.106734037399292
2013-03-15 06:00:13.502 BadgerNew[4120:8d23] @(finishFetching): 0.1373000144958496
2013-03-15 06:00:13.717 BadgerNew[4120:907] @(tiTotalTime): 0.3521299958229065
2013-03-15 06:00:13.869 BadgerNew[4120:675b] @(startFetching): 0.3048880100250244
2013-03-15 06:00:13.918 BadgerNew[4120:675b] @(finishFetching): 0.3537369966506958
2013-03-15 06:00:14.018 BadgerNew[4120:907] @(tiTotalTime): 0.454010009765625
2013-03-15 06:00:16.317 BadgerNew[4120:8847] @(startFetching): 1.014970004558563
2013-03-15 06:00:16.375 BadgerNew[4120:8847] @(finishFetching): 1.072436988353729
2013-03-15 06:00:16.661 BadgerNew[4120:8d23] @(startFetching): 1.045746028423309
2013-03-15 06:00:16.691 BadgerNew[4120:8d23] @(finishFetching): 1.07514101266861
2013-03-15 06:00:16.721 BadgerNew[4120:907] @(tiTotalTime): 1.419299006462097
2013-03-15 06:00:16.759 BadgerNew[4120:907] @(tiTotalTime): 1.142507016658783
2013-03-15 06:00:19.709 BadgerNew[4120:8847] @(startFetching): 1.773845970630646
2013-03-15 06:00:19.795 BadgerNew[4120:8847] @(finishFetching): 1.860616981983185
2013-03-15 06:00:19.900 BadgerNew[4120:907] @(tiTotalTime): 1.965098977088928 
```

从我们启动计数器到执行 NSOperationQueue 中的操作花了 1.4 秒。

它甚至不是一个单线程队列。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T00:11:52.263

NSOperation 类包含设置操作优先级的方法。您应该能够使用操作`setQueuePriority:(NSOperationQueuePriority)priority`上的方法设置操作优先级。该[文档](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html#//apple_ref/doc/uid/TP40004591)可以为您提供有关该方法采用的常量的更多详细信息。

由于您正在向队列添加操作，因此您实际上无法设置优先级，并且无论如何您都无法获得对为队列创建的对象的引用。相反，您应该提前创建一个[NSBlockOperation](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSBlockOperation_class/Reference/Reference.html#//apple_ref/occ/cl/NSBlockOperation)并将其添加到队列中。

# jquery - 奇怪的 jQuery UI - 拖放而不是克隆

> ID：15422132
> 
> 赞同：0
> 
> 时间：2013-03-14T23:30:23.567
> 
> 标签：jquery, jquery-ui, jquery-draggable

我是 jQuery 和 UI 的新手。

我无法理解使用 jQuery 和 jQuery UI 的整个拖放、克隆和保存到 DOM 对象的数据库过程。

我遇到了一些奇怪的情况：

助手克隆根本不起作用。

使用以下代码，原始`div`拖动，而不是克隆。

```
<!doctype html>
<html lang="en">
<head>

<style>
#makeMeDraggable { float: left; width: 100px; height: 100px; background: red; }
#makeMeDroppable { float: left; left: 0px; width: 300px; height: 300px; border: 1px solid #999; }
</style>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>

<script type="text/javascript">

$( init );

function init() {
  $('#makeMeDraggable').draggable( {
    revert:"invalid", 
    help:'clone',
    containment:"#makeMeDroppable"
  });

  $('#makeMeDroppable').droppable( {

    drop: handleDropEvent
  } );
}

function handleDropEvent( event, ui ) {
  var draggable = ui.draggable;

//  console.log( 'The square with ID "' + draggable.attr('id') + '" was dropped onto me!' );
}

</script>

</head>
<body>

<div id="content" style="height: 400px;">

  <div id="makeMeDraggable"> </div>
  <div id="makeMeDroppable"> </div>

</div>

</body>
</html> 
```

甚至它是 **“help:'clone'”** 而不是 **“helper:'clone'”**

**“助手：'克隆'”不起作用......**

您可以在[http://jsfiddle.net/JEdtX/6/查看](http://jsfiddle.net/JEdtX/6/)

我的代码中发生了什么？（其实我是从网上找的..）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T11:53:01.467

使用`helper: 'clone'`，它实际上是在创建`<div>`元素的克隆。你可以在你最喜欢的 DOM 检查器（Firebug、Chrome 开发工具或其他）中看到它。尝试向您的元素添加一些内容，您会看到它。

`.ui-draggable-dragging`如果你想看到它，即使克隆是空的，你也可以在类中添加一些 css（如背景颜色） 。

# android - 使用 Android 提高定位精度

> ID：15422133
> 
> 赞同：1
> 
> 时间：2013-03-14T23:30:23.830
> 
> 标签：android, gps, position

我正在尝试创建一个应用程序，该应用程序将能够通过兴趣点引导城市中的人们。为此，我需要获得更好的准确性，以免将 POI 放置在没有任何东西的地方......

为此，我使用 droidAR（它给了我一个雷达，我可以根据它们的坐标放置我的 POI）。但是准确性太差了，我看不出它是如何使用的。

例如，要确定我是否靠近 POI，我会计算它与我的 GPS 位置之间的距离。可能是，当我放置 POI 时，Android 给出了 10 米的精度，而当我试图找到它时，它是 80 米的距离。

所以我期待找到另一个职位系统，我发现：

*   天钩，它应该提供更准确的位置。有了这个，我拿了 1000 个点并检查了它们到最后一个点的距离，它总是在移动，有时是 300m，所以看起来更不精确。也许任何人都可以成功使用它？

    *   有人告诉我使用 DCM 算法（直接余弦矩阵），它可以给我一个准确的相对位置（对于我的用例来说，相对于起点做每个 positioninf 没有问题）。一些无人机正在使用它，它可以达到1米的精度。但我找不到任何关于 Android 的实现或帮助。

有没有人成功准确地使用了安卓 GPS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:51:21.833

要么你的安卓手机有一个坏的 GPS 设备，要么你做错了什么。您可以在城市 aprox 中设置 POI。5m精度，有时20m。这就足够了。使用另一个允许设置航点的 GPS 应用程序检查它。

在您的应用程序中，您可以专注于 95% 的 GPS 准确度。没有什么比 GPS 更好的了（尤其是手机），您描述的其他方法是对 GPS 的短时间辅助，但它们对行人不起作用，它们是为车辆设计的（车辆大部分时间直线行驶，他们不能像人类那样快速改变方向）。

您的问题不是 GPS 定位精度，而是 droidAR 的增强现实投影。

# html - 如何使用 twitter bootstrap 右对齐元素？

> ID：15422134
> 
> 赞同：35
> 
> 时间：2013-03-14T23:30:26.400
> 
> 标签：html, css, twitter-bootstrap

我有 3 个元素，我正在尝试将按钮与屏幕右侧对齐，但这样做时遇到了麻烦。

```
<div class="container">
  <div class="row-fluid">
    <h4>
      <img src="img.png" style="width:50px;">
      Title
      <a href="link_to_img.html" class="btn btn-success">Grab it!</a>
    </h4>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-03-14T23:45:09.243

试试“pul-right”类。

```
<div class="pull-right">...</div> 
```

请参阅[http://getbootstrap.com/css/#helper-classes-floats](http://getbootstrap.com/css/#helper-classes-floats)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-14T23:46:31.753

尝试这样的事情

```
<a href = "link_to_img.html" class = 'btn btn-success pull-right'>Grab it!</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-01T08:33:54.380

利用**justify-content-end**

从引导文档中，它说：

**Bootstrap 3 使用 .navbar-left 和 .navbar-right 进行导航栏对齐。**

**Bootstrap 4 使用各种帮助类。**

（对齐部分） [https://www.quackit.com/bootstrap/bootstrap_4/tutorial/bootstrap_navbars.cfm](https://www.quackit.com/bootstrap/bootstrap_4/tutorial/bootstrap_navbars.cfm)

以及有关新对齐方式的更多信息 [https://www.quackit.com/css/flexbox/tutorial/flexbox_alignment.cfm](https://www.quackit.com/css/flexbox/tutorial/flexbox_alignment.cfm)

```
<!DOCTYPE html>
<html>

<head>
<link rel="stylesheet" href="style.css">
<script src="script.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
</head>

<body>

  <style>
    .wrapper {
      display: flex;
      align-items: center;
      background-color: beige;
      height: 100vh;
    }

    .wrapper > div {
      padding: 20px;
      font-size: 4vw;
      color: white;
    }

    .red {
      background: orangered;
    }

    .green {
      background: yellowgreen;
    }

    .blue {
      background: steelblue;
    }

    body {
      margin: 0;
    }
  </style>
  <div class="wrapper justify-content-end">
    <div class="red">1</div>
    <div class="green">2</div>
    <div class="blue">3</div>
  </div>
</body>

</html> 
```

[https://plnkr.co/edit/LtfW2fj9f3E9Ehj1M8jN?p=catalogue](https://plnkr.co/edit/LtfW2fj9f3E9Ehj1M8jN?p=catalogue)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-14T20:17:14.270

在引导 v4 中：

```
<div class="float-right">Float right on all viewport sizes</div> 
```

[引导 v4 文档](https://getbootstrap.com/docs/4.0/utilities/float/)

在引导 v5 中：

```
<div class="float-end">Float end on all viewport sizes</div> 
```

[引导 v5 文档](https://getbootstrap.com/docs/5.0/utilities/float/)

# ios - 连接到 UDP 服务器

> ID：15422135
> 
> 赞同：-2
> 
> 时间：2013-03-14T23:30:34.193
> 
> 标签：ios, sockets, udp

我正在尝试为 iOS 创建一个应用程序，我可以在其中连接到 UDP 服务器并从中接收数据。我的情况：

1.  我在 Windows 机器上有一个 UDP 服务器（IP = 192.168.1.6）。
2.  我有 iPad（IP = 192.168.1.5）；
3.  UDP 服务器向虚拟地址 (IP = 239.254.1.2) 和端口 (7125) 发送消息，例如“HELLO!!!!!!我在这里！！！”

我需要为 iOS 应用程序添加一些逻辑，我可以在其中连接到虚拟 IP 地址 (IP = 239.254.1.2) 和端口 (7125) 并接收消息“你好！！！！！我在这里！！！” 来自 UDP 服务器。

有没有人有什么建议？

**更新1：**

对于 UDP 连接，我使用**GCDAsyncUdpSocket**

这是我的代码：

```
@interface ViewController () {
    GCDAsyncUdpSocket *udpSocket;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    udpSocket = [[GCDAsyncUdpSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_main_queue()];
}

- (IBAction)startStop:(id)sender {
    if (isRunning) {
        // STOP udp echo server
        [udpSocket close];

        [self logInfo:@"Stopped Udp Echo server"];
        isRunning = false;

        [portField setEnabled:YES];
        [startStopButton setTitle:@"Start" forState:UIControlStateNormal];
    } else {
        // START udp echo server

        int port = [portField.text intValue];
        if (port < 0 || port > 65535) {
            portField.text = @"";
            port = 0;
        }

        NSError *error = nil;

        if (![udpSocket bindToPort:7125 error:&error]) {
            [self logError:FORMAT(@"Error starting server (bind): %@", error)];
            return;
        }

        if (![udpSocket joinMulticastGroup:@"239.254.1.2" error:&error]) {
            [self logError:FORMAT(@"Error join Multicast Group: %@", error)];
            return;
        }

        if (![udpSocket beginReceiving:&error])
        {
            [udpSocket close];

            [self logError:FORMAT(@"Error starting server (recv): %@", error)];
            return;
        }

        [self logInfo:FORMAT(@"Udp Echo server started on port %hu", [udpSocket localPort])];
        isRunning = YES;

        [portField setEnabled:NO];
        [startStopButton setTitle:@"Stop" forState:UIControlStateNormal];
    }
}

- (void)udpSocket:(GCDAsyncUdpSocket *)sock didReceiveData:(NSData *)data
                                               fromAddress:(NSData *)address
                                         withFilterContext:(id)filterContext
{
    if (!isRunning) return;

    NSString *msg = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    if (msg)
    {
        /* If you want to get a display friendly version of the IPv4 or IPv6 address, you could do this:

        NSString *host = nil;
        uint16_t port = 0;
        [GCDAsyncUdpSocket getHost:&host port:&port fromAddress:address];

        */

        [self logMessage:msg];
    }
    else
    {
        [self logError:@"Error converting received data into UTF-8 String"];
    }

    [udpSocket sendData:data toAddress:address withTimeout:-1 tag:0];
} 
```

当我在日志中按“开始”按钮时，我看到消息“Udp Echo 服务器在端口 7125 上启动”，但委托方法

```
- (void)udpSocket:(GCDAsyncUdpSocket *)sock didReceiveData:(NSData *)data
                                                   fromAddress:(NSData *)address
                                             withFilterContext:(id)filterContext 
```

从未触发，应用程序不会收到来自虚拟 IP 地址的任何消息。你能帮我解决这个问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:39:22.753

239.254.1.2 是 UDP 服务器向其发送数据包的多播地址。任何监听该地址的人都会收到数据包。所以：

*   创建一个 UDP 套接字
*   将您的套接字绑定到端口 7125
*   加入组播组 239.254.1.2
*   您的应用将开始接收 udp 数据包

可能应该只提到UDP 是无连接协议，即您无法连接到UDP 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T14:40:55.020

RichardBrock 是对的，UPDATE1 中的示例代码运行良好。问题出在我的家庭网络上，当我在工作网络中尝试此代码时，一切正常！！！

谢谢

# php - 将滚动条添加到 html

> ID：15422138
> 
> 赞同：4
> 
> 时间：2013-03-14T23:30:41.270
> 
> 标签：php, html

我有一个带有以下源代码（“likes.php”）的弹出窗口：

```
<!DOCTYPE html>
<html>
<head>
    <title>Like</title>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
</head>
<body>
<ol>
    <?php for($i=0;$i<500;$i++){ ?>
    <li><p><?php echo $i ?></p></li>
    <?php } ?>
</ol>
</body>
</html> 
```

现在的问题是，虽然所有的段落都创建了，但我看不到它们，因为没有滚动条。如何将滚动条附加到我的页面？

[链接到打印屏幕](http://snag.gy/xDK7l.jpg)

它在 chrome 上工作，但不是在 firefox 中，**如果**它出现在弹出窗口中（其他文件调用 window.open（“likes.php”）。在常规窗口中的两种浏览器中都可以使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T23:32:31.607

使用 css`overflow`属性。将此添加到您的`<head>`标签中：

```
<style type="text/css">
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
  } 
  .scroller {
    overflow: scroll;
    padding: 5px;
    height: 100%;
  }
</style> 
```

要专门添加水平或垂直滚动​​条，请分别使用`overflow-x`或`overflow-y`。

您还需要修复`<li>`元素的关闭标记，并将其包装在适当的容器中，如下所示

```
<div class="scroller">
  <ul>
    <?php for($i=0;$i<500;$i++)
              echo "<li>".$i."</li>";
    ?>
  </ul>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:38:16.090

要控制溢出，一般需要使用 CSS 的溢出属性

```
overflow: scroll 
```

正如 pswg 所说，**但您永远不需要像他建议的那样将其应用于整个身体**。如果您的代码格式正确，浏览器应自行将滚动条添加到整个页面。

当前问题可能是由于您没有关闭第二个`<li>`标签和 PHP 格式不正确引起的。您不需要在每行的末尾休息。线条没有中断的原因是您没有将`<li>`元素包含在`<ol>`or`<ul>`中。此外，将 if 语句的开头、填充符和结尾放在单独的 php 标记中只会使计算机感到困惑。而是使用：

```
 <?php 
    echo "<ul>";
    for( $i=0; $i<500; $i++) { 
      echo "<li>" .  $i . "</li>";
    } 
    echo "</ul>";
  ?> 
```

# python - 如何在python中逐行读取长的多行字符串

> ID：15422144
> 
> 赞同：107
> 
> 时间：2013-03-14T23:31:07.750
> 
> 标签：python

我有很多行的字符串。如何使用`for`子句逐行阅读？这是我正在尝试做的事情，我在该`for line in textData`行中引用的 textData var 上收到错误。

```
for line in textData
    print line
    lineResult = libLAPFF.parseLine(line) 
```

textData 变量确实存在，我在关闭之前打印它，但我认为预编译器正在引发错误。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2013-03-14T23:32:36.427

怎么用[`.splitlines()`](http://docs.python.org/2/library/stdtypes.html#str.splitlines)？

```
for line in textData.splitlines():
    print(line)
    lineResult = libLAPFF.parseLine(line) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-14T23:32:32.523

通过换行符拆分。

```
for line in wallop_of_a_string_with_many_lines.split('\n'):
  #do_something.. 
```

如果您遍历一个字符串，您将在该字符串中逐个字符地迭代字符，而不是逐行。

```
>>>string = 'abc'
>>>for line in string:
    print line

a
b
c 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T23:35:40.273

这个答案在几个边缘情况下失败了（见评论）。上面接受的解决方案将处理这些问题。`str.splitlines()`是要走的路。尽管如此，我还是会留下这个答案作为参考。

旧（不正确）答案：

```
s =  \
"""line1
line2
line3
"""

lines = s.split('\n')
print(lines)
for line in lines:
    print(line) 
```

# c++ - 在布局 DirectX 和 Windows 时遇到了巨大的困难

> ID：15422150
> 
> 赞同：0
> 
> 时间：2013-03-14T23:32:04.190
> 
> 标签：c++, windows, winapi, directx

我设法让这个例子工作：

[http://msdn.microsoft.com/en-us/library/windows/desktop/dd370994(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd370994(v=vs.85).aspx)

我的问题是我试图将那里的代码构造成更容易理解的东西......

我的第一步是删除所有对使用直接 x 表面启动窗口不是绝对必要的东西......但是一旦我开始弄乱代码，我就会非常困惑哪些组件是核心，哪些不是...

您是否知道一种样板项目，其中包含用于窗口中的 directx 表面的最基础知识。

D2D 很好，除非你建议我直接在 D3D 中编写代码......即使我只会绘制 2d 的东西。

我已经阅读了很多关于 directX 的资源和教程，但是每一个开花的都有不同的位和鲍勃，而且很难仅仅了解“必须”位是什么！...

只是为了帮助您解决问题。

我首先尝试创建一个 Gfx 对象，该对象将启动并为直接 X 创建表面和资源，我还尝试分离我的 Windows 代码，但当然也有点迷失在那里......最后我结束了我的 Game 类，以便windows 循环刚刚运行开始绘制、渲染和结束绘制。在上面的教程中，你有 2 个刷子，因为我不熟悉 directX，我不确定我是否可以将它们完全甩掉还是什么？

我想朝着正确方向迈出的一步正是我正在寻找的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T08:00:10.917

我强烈建议你拿一本体面的书来指导你完成以下步骤：

例如 -[尝试获取此副本](https://rads.stackoverflow.com/amzn/click/com/1936420228)

# r - 按行连接数据帧

> ID：15422156
> 
> 赞同：0
> 
> 时间：2013-03-14T23:32:36.977
> 
> 标签：r, join, row, dataframe, bind

我有不同`data.frames`的 1 行，我想加入以形成一个大`data.frame`的。问题是我希望 my`colnames`从`jan 2002`to `dic 2011`，并用 my 填充这些列，`data frames`即使对于一列没有价值。data.frames 上的示例（可以有“离散”日期）：

df1：

```
ene 2002 ene 2002 feb 2002 feb 2002 mar 2002 mar 2002 
    69       MA       38       MA     38       MA 
```

df2:

```
ago 2004 ago 2004 sep 2004 sep 2004 oct 2004 oct 2004 
   114       MB      102       MB       49       M 
```

df3:

```
oct 2011 oct 2011 nov 2011 nov 2011 dic 2011 dic 2011
10       A        9     A           20       MA 
```

df4("离散数据.frame"):

```
jan 2008 jan 2008  jul 2009 jul 2009 dic 2010  dic 2010
20          MA       200       B       100       MB 
```

Data.frame 想要（希望输出）：

```
ene 2002 ene 2002 feb 2002 feb 2002 mar 2002 mar 2002...ago 2004 ago 2004 sep 2004 sep 2004 oct 2004 oct 2004...jan 2008 jan 2008...jul 2009 jul 2009...dic 2010  dic 2010... oct 2011 oct 2011 nov 2011 nov 2011 dic 2011 dic 2011
    69       MA       38       MA     38       MA          NA       NA       NA       NA       NA       NA        NA       NA         NA       NA         NA        NA          NA       NA       NA       NA       NA       NA                             
    NA       NA       NA       NA     NA       NA          114      MB       102      MB       49       M         NA       NA         NA       NA         NA        NA          NA       NA       NA       NA       NA       NA
    NA       NA       NA       NA     NA       NA          NA       NA       NA       NA       NA       NA        NA       NA         NA       NA         NA        NA          10       A        9        A        20       MA
    NA       NA       NA       NA     NA       NA          NA       NA       NA       NA       NA       NA        20       MA         200      B          100       MB          NA       NA       NA       NA       NA       NA 
```

在此示例中，所有其他没有值的列将是`NA`：例如 ene 2003 feb 2003 ..... nov 2005 dic 2005 ...... 2006 年或 2007 年的所有月份（只是说随机月份不在示例，但我希望它们出现在我的输出中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:42:20.927

使用`plyr`的`rbind.fill`

```
rbind.fill(list(df1,df2,df3,df4)) 
```

注意：重复的列名（例如：2002 年 2 月）将更改为`feb 2002.1`.

**编辑：**这就是我得到的：

```
#   ene2002 ene2002.1 feb2002 feb2002.1 mar2002 mar2002.1 ago2004 ago2004.1 sep2004
# 1      69        MA      38        MA      38        MA      NA      <NA>      NA
# 2      NA      <NA>      NA      <NA>      NA      <NA>     114        MB     102
# 3      NA      <NA>      NA      <NA>      NA      <NA>      NA      <NA>      NA
# 4      NA      <NA>      NA      <NA>      NA      <NA>      NA      <NA>      NA
#   sep2004.1 oct2004 oct2004.1 oct2011 oct2011.1 nov2011 nov2011.1 dic2011 dic2011.1
# 1      <NA>      NA      <NA>      NA      <NA>      NA      <NA>      NA      <NA>
# 2        MB      49         M      NA      <NA>      NA      <NA>      NA      <NA>
# 3      <NA>      NA      <NA>      10         A       9         A      20        MA
# 4      <NA>      NA      <NA>      NA      <NA>      NA      <NA>      NA      <NA>
#   jan2008 jan2008.1 jul2009 jul2009.1 dic2010 dic2010.1
# 1      NA      <NA>      NA      <NA>      NA      <NA>
# 2      NA      <NA>      NA      <NA>      NA      <NA>
# 3      NA      <NA>      NA      <NA>      NA      <NA>
# 4      20        MA     200         B     100        MB 
```

# validation - W3C 验证错误：没有属性 X

> ID：15422158
> 
> 赞同：2
> 
> 时间：2013-03-14T23:30:39.007
> 
> 标签：validation

我编辑了帖子，对于许多更改，我有 1error：没有属性 X

> 您已在文档中使用了上述属性，但您使用的文档类型不支持该元素的该属性。此错误通常是由于对使用框架的文档错误使用“严格”文档类型（例如，您必须使用“过渡”文档类型来获取“目标”属性），或使用供应商专有扩展，例如“ marginheight”（这通常通过使用 CSS 来解决，以实现所需的效果）。
> 
> 如果您使用的文档类型不支持元素本身，也可能会导致此错误，因为未定义的元素将没有支持的属性；在这种情况下，请参阅 element-undefined 错误消息以获取更多信息。
> 
> 如何修复：检查元素和属性的拼写和大小写，（记住 XHTML 都是小写的）和/或检查它们在所选文档类型中是否都允许，和/或使用 CSS 代替此属性。如果您在使用该元素将 Flash 媒体合并到网页中时收到此错误，请参阅有关有效 Flash 的常见问题解答项目。
> 
> ```
> Line 71, column 16: there is no attribute "property"
> 
> <meta property='og:locale' content='en_US'/> 
> ```

我怎样才能解决这个问题？

先谢谢了。

* * *

**1 更新：** 我更换

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

和 ：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

错误不再出现，但我还有其他错误。

* * *

**2 更新**

我在 header.php 中替换

```
<meta http-equiv="content-language" content="en_US" /> 
```

至：

```
<meta http-equiv="content-language" content="en_us" /> 
```

我所做的第二件事：在`opengraph.php`（Yoast 插件）中，我替换了：

```
if ( $echo )
            echo "<meta property='og:locale' content='" . esc_attr( $locale ) . "'/>\n";
        else
            return $locale; 
```

至：

```
if ( $echo )
            echo "<meta property='og:locale' content='en_us'/>\n";
        else
            return $locale; 
```

但结果是一样的。1 个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:49:38.300

该`<meta>`标签没有名为“property”的属性。您似乎正在使用 W3C 的 HTML 验证器验证 Open Graph 协议标记。这几乎可以保证不起作用。看看[Facebook 的调试器工具](https://developers.facebook.com/tools/debug)可能会有好处。它应该提供有关 OG 标记的反馈。

# java - Java 列表 T[] toArray(T[] a) 实现

> ID：15422161
> 
> 赞同：38
> 
> 时间：2013-03-14T23:33:14.553
> 
> 标签：java, list, generics, toarray

我只是在查看 List 接口中定义的方法：`<T> T[] toArray(T[] a)` ，我有一个问题。为什么是通用的？由于这个事实，方法不是完全类型安全的。以下代码片段编译但导致`ArrayStoreException`：

```
List<Integer> list = new ArrayList<Integer>();
list.add(1);
list.add(2);

String[] stringArray = list.toArray(new String[]{}); 
```

在我看来，如果 toArray 不是通用的并且采用 List 类型参数，那会更好。

我已经编写了玩具示例，没有通用的也可以：

```
package test;

import java.util.Arrays;

public class TestGenerics<E> {
    private Object[] elementData = new Object[10];
private int size = 0;

    public void add(E e) {
    elementData[size++] = e;
}

@SuppressWarnings("unchecked")
    //I took this code from ArrayList but it is not generic
public E[] toArray(E[] a) {
    if (a.length < size)
        // Make a new array of a's runtime type, but my contents:
        return (E[]) Arrays.copyOf(elementData, size, a.getClass());
    System.arraycopy(elementData, 0, a, 0, size);
    if (a.length > size)
        a[size] = null;
    return a;
}

    public static void main(String[] args) {

    TestGenerics<Integer> list = new TestGenerics<Integer>();
    list.add(1);
    list.add(2);
    list.add(3);
    //You don't have to do any casting
    Integer[] n = new Integer[10];
    n = list.toArray(n);
}
} 
```

有什么理由这样声明吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-03-14T23:44:13.970

从[javadocs](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#toArray%28T%5B%5D%29)：

> 与 toArray() 方法一样，此方法充当基于数组的 API 和基于集合的 API 之间的桥梁。此外，此方法允许对输出数组的运行时类型进行精确控制，并且在某些情况下可用于节省分配成本。

这意味着程序员可以控制它应该是什么类型的数组。

例如，对于您的`ArrayList<Integer>`而不是`Integer[]`数组，您可能需要一个`Number[]`or`Object[]`数组。

此外，该方法还检查传入的数组。如果传入的数组对所有元素都有足够的空间，则该`toArray`方法会重新使用该数组。这表示：

```
Integer[] myArray = new Integer[myList.size()];
myList.toArray(myArray); 
```

或者

```
Integer[] myArray = myList.toArray(new Integer[myList.size()]); 
```

具有相同的效果

```
Integer[] myArray = myList.toArray(new Integer[0]); 
```

请注意，在旧版本的 Java 中，后一种操作使用反射来检查数组类型，然后动态构造正确类型的数组。通过首先传入正确大小的数组，不必使用反射在`toArray`方法内分配新数组。情况不再如此，两个版本可以互换使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-14T23:37:01.947

它是通用声明的，以便您可以编写代码，例如

```
Integer[] intArray = list.toArray(new Integer[0]); 
```

没有铸造阵列回来。

它使用以下注释声明：

```
@SuppressWarnings("unchecked") 
```

换句话说，Java 信任*您*传递相同类型的数组参数，因此您的错误不会发生。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-14T23:39:31.697

方法之所以有这个签名是因为`toArray`API 早于泛型：方法

```
 public Object[] toArray(Object[] a) 
```

早在 Java 1.2 就已经引入。

`Object`替换为的相应泛型`T`已作为 100% 向后兼容的选项引入：

```
public <T> T[] toArray(T[] a) 
```

将签名更改为泛型可以让调用者避免强制转换：在 Java 5 之前，调用者需要这样做：

```
String[] arr = (String[])stringList.toArray(new String[stringList.size()]); 
```

现在他们可以在没有演员表的情况下进行相同的调用：

```
String[] arr = stringList.toArray(new String[stringList.size()]); 
```

**编辑 ：**

该方法的更“现代”签名`toArray`将是一对重载：

```
public <T> T[] toArray(Class<T> elementType)
public <T> T[] toArray(Class<T> elementType, int count) 
```

这将为当前方法签名提供更具表现力且同样通用的替代方案。使用适当的方法也可以有效地实现这一点[`Array.newInstance(Class<T>,int)`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Array.html#newInstance%28java.lang.Class,%20int%29)。但是，以这种方式更改签名不会向后兼容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-15T03:44:37.180

它*是*类型安全的——它不会导致`ClassCastException`. 这通常是类型安全的意思。

`ArrayStoreException`是不同的。如果包含`ArrayStoreException`在“非类型安全”中，那么 Java 中的所有*数组*都不是类型安全的。

您发布的代码也会产生`ArrayStoreException`. 你试一试：

```
TestGenerics<Object> list = new TestGenerics<Object>();
list.add(1);
String[] n = new String[10];
list.toArray(n); // ArrayStoreException 
```

事实上，根本不可能让用户传入他们想要获取的类型的数组，同时又没有`ArrayStoreException`. 因为任何接受某种类型数组的方法签名也允许子类型数组。

所以既然无法避免`ArrayStoreException`，*为什么不*让它尽可能通用呢？如果用户以某种方式知道所有元素都将是该类型的实例，那么用户可以使用某种不相关类型的数组吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-18T20:40:55.410

这种方法之所以如此，主要是历史性的。

泛型类和数组类型之间存在区别：泛型类的类型参数在运行时会被擦除，而数组元素的类型不会。因此，在运行时，JVM 看不到`List<Integer>`and之间的区别，但它确实看到了and`List<String>`之间的区别！造成这种差异的原因是数组一直存在，从 Java 1.0 开始，而泛型仅在 Java 1.5 中添加（以向后兼容的方式）。`Integer[]``String[]`

在引入泛型之前，集合 API 是在 Java 1.2 中添加的。那时`List`接口已经包含了一个方法

```
Object[] toArray(Object[] a); 
```

（请参阅[1.2 JavaDoc 的此副本](http://www.cs.mun.ca/~michael/java/jdk1.2-docs/api/)）。这是创建具有用户指定的运行时类型的数组的唯一方法：参数`a`用作类型标记，也就是说，它确定返回数组的运行时类型（请注意，如果`A`是 的子类`B`，`A[]`则被视为子类型of`B[]`虽然`List<A>`不是)*的*子类型`List<B>`。

当 Java 1.5 中引入泛型时，许多现有的方法都变成了泛型，并且`toArray`方法变成了

```
<T> T[] toArray(T[] a); 
```

在类型擦除之后，它与原始的非泛型方法具有相同的签名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T02:09:54.183

我认为*dasblinkenlight*可能是正确的，这与泛化现有方法有关，完全兼容是一件微妙的事情。

*beny23*的观点也很好——方法应该接受超类型的`E[]`。一个人可能会尝试

```
 <T super E> T[] toArray(T[] a) 
```

但是Java不允许`super`使用类型变量，因为缺少用例:)

（编辑：不，这不是一个好的用例`super`，请参阅[https://stackoverflow.com/a/2800425/2158288](https://stackoverflow.com/a/2800425/2158288)）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-06T17:40:58.777

这段代码是从 java.util.LinkedList 类的源代码中粗暴复制的：

```
public <T> T[] toArray(T[] a) {
    if (a.length < size)
        a = (T[])java.lang.reflect.Array.newInstance(
                            a.getClass().getComponentType(), size)
     // actual code for copying
     return a;
} 
```

这应该是诀窍

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-16T19:31:51.463

最后，在 Java 11 中，我们有一个很好的折衷方案：

```
// Class Collection

default <T> T[] toArray(IntFunction<T[]> generator) {
    return toArray(generator.apply(0));
} 
```

因此，如果您提供数组构造函数，它将实例化并将数据从集合复制到原始数组：

```
Set.of("a", "b").toArray(String[]::new);
List.of(1L, 2L).toArray(Long[]::new); 
```

# modx - modx 减少电视以获得 0

> ID：15422163
> 
> 赞同：0
> 
> 时间：2013-03-14T23:33:17.877
> 
> 标签：modx, modx-revolution, modx-templates

我需要我的`[[+idx]]`电视从 0 而不是 1 开始，所以我尝试了这个： `[[+idx:decr]]`或`[[+idx:substract=`1 `]]`，但它给了我 -1（减一）。有谁知道另一种获得0的方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-06T15:32:53.627

在 getImageList 的块中使用它（至少对我来说）：

```
[[+idx:decr]] 
```

它给出：0,1,2,3 ....

PS 使用 modx revo 2.3.1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:05:20.807

创建变量时，将模板变量默认设置为 0。

你想做什么，你的问题充其量是模糊的。

**更新**

好的 - 我认为对你有用的是写一个片段来做数学......无论你在哪里调用 [[+idx]] 代替写一个片段

```
 [[!FixIDX? &itemindex=`[[+idx]]`]] 
```

然后在您的 FixIDX 代码段中，只需使用 php 进行数学运算并返回更正后的索引。虽然也许自定义输出修饰符会是更好的方法：[http://rtfm.modx.com/display/revolution20/Input+and+Output+Filters+(Output+Modifiers)](http://rtfm.modx.com/display/revolution20/Input+and+Output+Filters+(Output+Modifiers))

虽然查看文档，但您的代码肯定可以工作 - 我认为没有理由不这样做。

# ruby - 在ruby中反转数组（矩阵）

> ID：15422167
> 
> 赞同：0
> 
> 时间：2013-03-14T23:33:59.440
> 
> 标签：ruby, arrays, for-loop, matrix, transpose

我有“文本”，它是一个数组数组，比方说：

```
1 2 3

4 5 6

7 8 9 
```

我只想创建另一个数组数组，但像这样：

```
1 4 7

2 5 8

3 6 9 
```

我无法让它工作。它说：`undefined method '[]=' for nil:NilClass`

```
vect = Array.new()
3.times{|i|
    3.times{|j|
        vect[j][i] = text[i][j]
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T23:45:41.943

对于包含整数的数组数组，“文本”不是一个很好的名称。也就是说，您可能想查看 [array.transpose](http://ruby-doc.org/core-2.0/Array.html#method-i-transpose)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T23:41:44.390

你声明了一个空数组，但你没有用空数组填充它。

因为您使用的数组是空的，所以`vect[j]`将始终返回`nil`而不是您期望的数组。

这是更正后的代码：

```
vect = [[], [], [], []]
4.times do |i|
    4.times do |j|
        vect[j][i] = text[i][j]
    end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T23:54:55.210

您也可以为这些目的使用[Matrix](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/matrix/rdoc/Matrix.html)类，例如：

```
require 'matrix'
m1 = Matrix[[1,2,3], [4,5,6],[7,8,9]]

m1.to_a.each {|r| puts r.inspect}  #=> This is just print the matrix in that format.
[1, 2, 3]
[4, 5, 6]
[7, 8, 9]

- Transposed Version -

m1.transpose.to_a.each {|r| puts r.inspect} #=> Note the method `transpose` called. The rest is just for printin.

[1, 4, 7]
[2, 5, 8]
[3, 6, 9] 
```

# php - 为什么我的 PHP / MySQL 是插入而不是更新？

> ID：15422169
> 
> 赞同：0
> 
> 时间：2013-03-14T23:34:17.397
> 
> 标签：php, mysql, insert, sql-update

```
if ($Funct == "BUILD" AND $Mode == "GROUND")
{
    $sql = "SELECT * FROM $landCon WHERE North = '" . $North . "' AND West = '" . $West ."'" ;
    $result = mysql_query($sql) or die("Error occurred in [$sql]: " . mysql_error());
    $count = mysql_num_rows($result);

    If ($Count == 0 )
    {
        $sql = "INSERT INTO $landCon (West,North,Type1) VALUES ($West,$North,'$Char')";
        mysql_query($sql) or die("Error occurred in RootA as:[$sql]: " . mysql_error());

    }
    else
    {
        $result=mysql_query("UPDATE $landCon SET Type1= '$Char' WHERE North = $North AND West=$West") or die( "Database Error: ".mysql_error());
    }
    echo "SUCCESS";
} 
```

而不是更新它插入的条目所在的位置。我的意图是如果已经有指定`$North`和`$South`条目，则更新它，以便每个地图网格只有一个北/南值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T23:35:35.897

```
$count = mysql_num_rows($result);

If ($Count == 0 ) 
```

是`$count` `$Count`吗？

验证码：当你打错字时默默初始化新变量的语言

# reporting-services - SSRS - 日期时间格式的表达式警告

> ID：15422170
> 
> 赞同：1
> 
> 时间：2013-03-14T23:34:25.550
> 
> 标签：reporting-services, parameters, ssrs-2008, ssrs-expression

我需要从报告的 2 个日期/时间参数（开始日期和结束日期）中获取月份和年份信息到文本框中。

我使用了以下表达式 -

```
=MonthName(Month(Parameters!StartDate.Value)) & Format(Year(Parameters!EndDate.Value)) & " to " & MonthName(Month(Parameters!EndDate.Value)) & Format(Year(Parameters!EndDate.Value)) 
```

把它变成像 2012 年 3 月到 2012 年 8 月这样的时间。

它有效，但是我不断收到以下警告：

```
[rsRuntimeErrorInExpression] The Value expression for the textrun ‘Textbox18.Paragraphs[0].TextRuns[0]’ contains an error: Conversion from type 'Date' to type 'Integer' is not valid. 
```

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:30:54.070

那是您使用的确切表达方式吗？好像不是因为：

*   该表达式在没有警告的情况下有效（在我的系统上）
*   它没有给出您指示的输出
*   表达式错误（它列出了 EndDate 的年份两次，而不是 StartDate 的年份和 StartDate 的月份）

所以我猜想实际表达式中的函数之一是`MonthName(Parameters!StartDate.Value)`而不是`MonthName(Month(Parameters!StartDate.Value))`会给出指示的错误。

这也有效：

```
=MonthName(Month(Parameters!StartDate.Value)) & " " & Year(Parameters!StartDate.Value).ToString() & " to " & MonthName(Month(Parameters!EndDate.Value)) & " " & Year(Parameters!EndDate.Value).ToString() 
```

要么那个要么这不是表达`Textbox18`

# php - 即使它位于我要查找的位置，也找不到类

> ID：15422173
> 
> 赞同：4
> 
> 时间：2013-03-14T23:34:32.800
> 
> 标签：php, class, elasticsearch, elastica

我正在尝试加载一个类，以便我在类文档的帮助下编写的 PHP 脚本能够工作。

由于我的服务器运行的是 PHP 5.3，文档建议像这样加载类：

```
spl_autoload_register(function($class){
    if (file_exists('/webgit/webroot/home/myUsername/www/elastica/lib/' . $class . '.php')) {
       echo " found \n ";
       require_once('/webgit/webroot/home/myUsername/www/elastica/lib/' . $class . '.php');
    }
    else {
       echo " not found! ";
    }
}); 
```

唯一不同的是我在 if 和 else 套件中包含了 echo。另外 myUsername 实际上是我在服务器文件系统路径中的用户名。

然后，它（文档）建议我像这样创建一个类的新实例：

```
$elasticaClient = new \Elastica\Client(); 
```

但是，我收到一个错误，即找不到该类。这正是打印的内容，包括错误和我的 if-else 套件：

未找到！致命错误：在第 17 行的 /webgit/webroot/home/myUsername/www/elastica/index.php 中找不到类“Elastica\Client”

第 17 行是我尝试创建类实例的行。

现在，index.php 是上述代码所在的位置，它位于我的服务器上的 /webgit/webroot/home/myUsername/www/elastica/

并且所有的类文件都在 /webgit/webroot/home/myUsername/www/elastica/lib/

所以，我不明白为什么它无法找到/加载类。

我将不胜感激任何帮助解决这个问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:15:31.353

`not found!`- 这意味着找不到文件。文件，而不是类。

变量 $class 包含带有命名空间的完整类名`Elastica\Client`。你确定你有`/webgit/webroot/home/myUsername/www/elastica/lib/Elastica\Client.php`文件吗？

检查[如何将 PHP 命名空间与自动加载一起使用？](https://stackoverflow.com/questions/1830917/how-do-i-use-php-namespaces-with-autoload)并了解[PSR-0](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:50:25.563

因错误过多而删减。然而，迈克在评论中有一个链接值得保留。

# java - 尝试实现两个 ArrayStacks -Java 时出错

> ID：15422176
> 
> 赞同：1
> 
> 时间：2013-03-14T23:34:48.497
> 
> 标签：java, arrays, stack

所以我正在开发一个程序，它将以字符串 EG 的形式读取数学方程：1 + 2 * 3

我需要有两个不同的堆栈，一个用于数字，另一个用于操作数。将数字压入数字堆栈并将运算符压入字符堆栈，然后在满足某些条件时处理等式。我们正在使用我已导入环境的 ArrayStacks。但是，在尝试编译堆栈时，我不断收到错误消息。

这是我所拥有的：

```
public static String test = new String("2 * 3 + 6 ");
public static ArrayStack<Double> numbers = new ArrayStack<Double>[20];
public static ArrayStack<Character> operands = new ArrayStack<Character>[20]; 
```

它一直给我这个错误（用-Xlint运行）：

```
infixNotation.java:7: error: generic array creation
public static ArrayStack<Double> numbers = new ArrayStack<Double>[20];
                                           ^
infixNotation.java:8: error: generic array creation
    public static ArrayStack<Character> operands = new ArrayStack<Character>[20];
                                                   ^
/home/tyler/CSC223/bookFiles/ch03/stacks/ArrayStack.java:22: warning: [unchecked] unchecked cast
    stack = (T[]) new Object[DEFCAP];
                  ^
  required: T[]
  found:    Object[]
  where T is a type-variable:
    T extends Object declared in class ArrayStack
/home/tyler/CSC223/bookFiles/ch03/stacks/ArrayStack.java:27: warning: [unchecked] unchecked cast
    stack = (T[]) new Object[maxSize];
                  ^
  required: T[]
  found:    Object[]
  where T is a type-variable:
    T extends Object declared in class ArrayStack
/home/tyler/CSC223/bookFiles/ch03/stacks/StackOverflowException.java:3: warning: [serial] serializable class StackOverflowException has no definition of serialVersionUID
public class StackOverflowException extends RuntimeException
       ^
2 errors
3 warnings 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:39:49.203

`public static ArrayStack<Double> numbers = new ArrayStack<Double>[20];`

[20] 表示您正在创建一个包含 20 个 ArrayStack 的数组。但这显然是无稽之谈，因为您甚至没有将字段声明为数组（除其他外）。

你可能打算用 20 调用它的构造函数，所以`(20)`

`public static ArrayStack<Double> numbers = new ArrayStack<Double>(20);`

# javascript - 如果条件始终为真（js），为什么会这样？

> ID：15422179
> 
> 赞同：1
> 
> 时间：2013-03-14T23:35:12.883
> 
> 标签：javascript, jquery, if-statement, append, conditional-statements

当满足第一个 if 条件时，其中的 if 条件总是返回 true。我知道这一点，因为每次满足第一个 if 条件时，它都会附加相同的 div。我的JS知识有限；这可能是我想念的明显东西。但是，在我看来，在满足并执行了第二个 if 语句之后，它的条件不应该再次满足。有谁知道是什么原因造成的？任何帮助，将不胜感激。

```
if (portfolioImg.attr('src') == 'image.png') 
{
    if (zoomImgHolder.width() != '300px') 
    {
        zoomImgHolder.append('<div id="myContent"></div>');
        zoomImgHolder.css(
        {
            'width' : '300px',
            'height' : '120px'
        });

        swfobject.embedSWF(
            "swfobject/test.swf", 
            "myContent", 
            "300", 
            "120", 
            "9.0.0", 
            "expressInstall.swf");

        zoomImgHolder.vAlign();
    } 
    else 
    {
        $('#myContent').css(
        {
            'visibilty' : 'visible'
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T23:37:13.697

[正如文档所解释的：](http://api.jquery.com/width/)

> `.css(width)`和之间的区别在于`.width()`后者返回一个无单位的像素值（例如，`400`），而前者返回一个具有完整单位的值（例如，`400px`）。

**`.width()`总是返回一个数字**，并且`<any number>`永远不会相等`300px`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T23:36:53.937

jQuery 中的 width() 函数返回一个整数值。因此，它永远不会等于字符串“300px”。

只需稍微修改您的代码：

```
if (zoomImgHolder.width() != 300) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-14T23:36:56.077

`.width()`返回一个数字，而不是字符串：

```
> 300 == '300px'
false 
```

只需将其与`300`：

```
if (zoomImgHolder.width() != 300) { 
```

# jsp - JSTL 使用动态变量名检索值

> ID：15422180
> 
> 赞同：2
> 
> 时间：2013-03-14T23:35:23.603
> 
> 标签：jsp, jstl

我有一种情况，我正在将会话中的图像链接设置为一个页面以在另一页面上访问，这是设置的位置：

```
<c:set var="<%item.getCatalogEntryId()%>FTImage" value="${item.field5}" scope="session"/> 
```

我在提取此信息以在第二页上使用时遇到问题，我想做这样的事情，但语法显然不正确，我不确定如何正确执行此操作

```
<c:set var="CartImage" value="${sessionScope.${itemCatentryId}FTImage}"></c:set> 
```

catalogEntryId 在两个页面之间是通用的，我只需要知道在从会话中检索变量时如何包含它

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:25:20.827

试试这个。我认为它会工作

```
 <c:set var="CartImage" value="${sessionScope.[itemCatentryId]FTImage}"></c:set> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-31T10:34:36.283

这是不可能的。我认为解决您的问题的方法是使用包含`catalogEntryId`as 键和`item`as 值的 Map。如果您`itemList`的 servlet/控制器中有一个，您可以使用以下方法将其转换为映射：

```
// Servlet.
request.setAttribute("itemMap", itemList.stream().collect(Collectors.toMap(i-> String.valueOf(i.getCatalogEntryId()) + "FTImage", Function.identity())));
// Spring MVC Controller.
modelAndView.addObject("itemMap", itemList.stream().collect(Collectors.toMap(i-> String.valueOf(i.getCatalogEntryId()) + "FTImage", Function.identity()))); 
```

因此，您将能够在您的视图中使用此映射并从您的映射中获取动态键，如下所示：

```
<c:set var="CartImage" value="${itemMap.get(item.getCatalogEntryId()+'FTImage')}" value="${your value}"></c:set> 
```

# c++ - 如何将类对象分配给指针？

> ID：15422181
> 
> 赞同：-2
> 
> 时间：2013-03-14T23:35:29.367
> 
> 标签：c++, pointers

如何使指针指向同一类的真实对象的内存位置？

```
Class A
{
    int num = 0;
    A(int n) {
        this->num = n;
    }
}

int main()
{
    A a(10);
    A * aPtr;

    // How do I make "aPtr" point at "a"?

    // something like
    // aPtr = a; (I know this wont work but what instead)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:36:10.850

> 如何使“aPtr”指向“a”？

使用`&`(address-of) 运算符：

```
aPtr = &a; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:36:23.500

使用地址运算符：

```
A * aPtr = &a;                 // assume that & is not overloaded 
```

```
#include <memory>

A * aPtr = std::addressof(a);  // more general 
```

# cordova - 如何删除phonegap中的第一个空白页？

> ID：15422186
> 
> 赞同：3
> 
> 时间：2013-03-14T23:35:55.843
> 
> 标签：cordova, splash-screen

我不确定它是否被称为“闪屏”？请问我怎样才能避免当我打开应用程序时，它会在那个空白屏幕上加载 0.5-1 秒，然后重定向到我的 indext.html？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T05:53:47.810

如果您看到以下文档，它详细说明了如何设置自定义启动屏幕以显示应用程序何时加载。

[http://docs.phonegap.com/en/2.5.0/cordova_splashscreen_splashscreen.md.html#Splashscreen](http://docs.phonegap.com/en/2.5.0/cordova_splashscreen_splashscreen.md.html#Splashscreen)

如果你使用“navigator.splashscreen.hide();” 功能您可以确保在隐藏启动屏幕之前您的应用程序已完全加载。（如果您这样做，请不要忘记更改 iOS 上的 AutoHideSplashScreen 设置）

# java - 动态创建字段java

> ID：15422192
> 
> 赞同：3
> 
> 时间：2013-03-14T23:36:36.840
> 
> 标签：java, dynamic, reflection

我想知道他们是否有任何方法可以在运行时使用反射或相关 API 为类动态创建静态字段。如果需要，如果有人可以告诉我适当的步骤，我可以使用 java 本机接口来完成此任务。我不想使用任何数据结构，例如哈希映射，因为我这样做完全是为了好玩。请不要建议使用地图，因为我没有将其用于任何实际程序，这是完全理论上的情况。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T23:38:19.940

您可以在类加载期间[使用字节码操作来执行此操作](https://stackoverflow.com/questions/2532215/java-bytecode-manipulation-library-suggestions)。

这是一个非常复杂的解决方案，所以我会考虑其他选择。

拥有一个在编译时未知的新字段也没有太大帮助，因为您无法针对它编译任何内容。如果您打算使用反射来访问它，那么您不妨首先使用 Map。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:51:50.940

Java 不以特别好的或有效的方式支持元编程或运行时编程。

您可以使用装饰器模式。您可以将要添加静态字段的对象传递到包装器对象中。该包装器将具有静态字段，并且对包装器对象的调用将与被包装对象相关。

如果您可以提供有关您正在寻找的功能的更多详细信息，我可以尝试提供更好的解决方案。如果您绝对需要以这种方式完成，那么您最好研究另一种支持运行时编程的语言。

# php - DOMPDF 检查它是否是一个新页面

> ID：15422193
> 
> 赞同：1
> 
> 时间：2013-03-14T23:36:44.827
> 
> 标签：php, dompdf

有没有办法在生成 PDF 时判断您是否在新页面上？有点像`<thead>`在下一页上呈现表格时所做的事情。我检查了内联 PHP 脚本，但它不支持 HTML。任何可能的选择？

# javascript - 传递变量 VS 传递值

> ID：15422200
> 
> 赞同：0
> 
> 时间：2013-03-14T23:37:05.567
> 
> 标签：javascript, variables, timeout

我很想了解以下之间的区别：

```
var the_timeout = setTimeout("alert(the_string);", 60000); 
```

和：

```
 var the_timeout = setTimeout("alert(" + the_string + ");",60000); 
```

我知道第一个传递变量，第二个传递值-但这到底是什么意思，为什么重要？为什么在第二个示例中传递了值？

另外（我希望这是同一个主题），为什么会这样：

```
var timeout=setTimeout("someFunction();", 3000) 
```

虽然这不是：

```
var timeout=setTimeout(someFunction(),3000); 
```

调用函数时，`someFunction()`有效，那么为什么我必须在使用时添加引号`setTimeout()?`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T23:40:11.230

我认为您将按值传递和按引用传递之间的区别与此混淆了。在您提到的示例中，没有区别。

然而，

```
var timeout=setTimeout("someFunction();", 3000) 
```

工作和：

```
var timeout=setTimeout(someFunction(),3000); 
```

不是因为在第二种情况下，`someFunction()`它会运行以便它可以将结果/返回值传递给`setTimeout`. 这就是为什么你将它作为一个字符串传递，以便它自己`setTimeout`可以。[`eval`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/eval)当然，除非 if`someFunction()`本身返回一个`setTimeout`可以用作回调的函数。

但是，正如 zerkms 在评论中指出的那样，您应该改为传递回调：

```
var timeout = setTimeout(function() { someFunction(); }, 3000); 
```

这也具有`setTimeout`随后可以随时调用回调的效果。一个主要的好处是您可以传递任何常规函数，这样您就可以从您可能正在使用的编辑器中受益，而不是将其全部打包成一个字符串：

```
var myTrigger = function() {
  someFunction();
};

var timeout = setTimeout(myTrigger, 3000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:55:20.810

这将在 60 秒后解析执行字符串中的代码。

```
var the_string = "Hello";
setTimeout("alert(the_string);", 60000);
the_string = "Goodbye"; 
```

这意味着`alert(the_string)`被执行，就像它是常规代码一样。所以它会提醒“再见”。这是因为当最终执行代码时，`the_string`会使用更新后的值，因为您正在传递变量。

但这做了一些微妙的不同。

```
var the_string = "Hello";
setTimeout("alert(" + the_string + ");",60000);
the_string = "Goodbye"; 
```

现在我们正在动态创建一个新的代码片段。我们正在创建的片段是`alert(Hello);`. 但是`Hello`是一个没有价值的变量，因为你没有得到正确的引号。

但是可以说你的意思是：

```
var the_string = "Hello";
setTimeout("alert('" + the_string + "');",60000);
the_string = "Goodbye"; 
```

现在这将起作用，因为它生成的代码是`alert('Hello');`. 乍一看似乎做同样的事情。但是因为生成的代码现在实际上包含一个硬编码的字符串，所以当`the_string`更改时，更改不会将其变为生成的代码，因为它已被硬编码到代码段中。

基于此，这很简单：

```
setTimeout("someFunction();", 3000) 
```

字符串中的代码在延迟后执行。在这种情况下，`someFunction()`执行。

但这是*完全*不同的：

```
setTimeout(someFunction(),3000); 
```

在这种情况下，`someFunction()`立即*执行*，它的*返回值*作为第一个参数传递给`setTimeout()`函数。所以它根本不会做你所期望的。

* * *

其中大部分`eval`与生成代码的怪癖有关，`setTimeout(string,delay)`就像`eval`. 如果您不使用`eval`，并且没有将字符串传递给 ，这一切都不是问题`setTimeout()`。

传递一个字符串会`setTimeout`导致`eval`，`eval`导致奇怪的疯狂虫子，奇怪的疯狂虫子导致痛苦，痛苦导致*痛苦*。

相反，您传递一个函数。它在每一个方面都更好。

```
// pass an anonymous function to run some code later
var the_string = "Hello";
setTimeout(function() {
  alert(the_string);
}, 60000);
the_string = "Goodbye";
// alerts "Goodbye" 60 seconds later

// pass an anonymous function to run some code
setTimeout(function() {
  someFunction();
}, 3000);

// or pass a reference to a function to execute, note lack of ()
setTimeout(someFunction, 3000); 
```

# node.js - 是否有将 Google Analytics 图表嵌入网页的 node.js 包

> ID：15422201
> 
> 赞同：0
> 
> 时间：2013-03-14T23:37:12.013
> 
> 标签：node.js, google-analytics, google-analytics-api

我正在构建一个包含内部生成数据的 Node.js 分析仪表板，并希望从我们的 Google Analytics 中添加图表。1/ 这样做的正确 Google Analytics API 是什么 2/ 是否有一个 node.js 包来嵌入图表本身（而不是从 GA 检索数据然后必须自己构建图表）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-06T15:12:13.527

虽然不是专门为 Node.js，但现在可以通过客户端 JavaScript 和 Google 的[Embed API](https://ga-dev-tools.appspot.com/embed-api/)实现。该页面还包含用于构建[基本仪表板](https://ga-dev-tools.appspot.com/embed-api/basic-dashboard/)、[交互式图表](https://ga-dev-tools.appspot.com/embed-api/interactive-charts/)等的详细文档教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T02:38:31.173

查看[嵌入式分析](http://www.embeddedanalytics.com)。

*虽然不是 node.js 解决方案，但我们是专门设计的第 3 方解决方案（使用核心报告），这样您就可以避免“从 GA 检索数据然后必须自己构建图表*”的繁重工作，正如您所说你自己。

过程非常简单。

1.  授权我们通过 API 访问您的 GA 数据。
2.  设计您的图表（可以使用各种格式）。
3.  在要显示图表的位置嵌入`<iframe>`标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T14:15:20.917

您需要使用[**Core Reporting API**](https://developers.google.com/analytics/devguides/reporting/core/v3/)来提取数据，并且可以尝试使用[**Google Chart Tools**](https://developers.google.com/chart/)来创建图表。

# html - 无法使用 css 生成水平滚动

> ID：15422202
> 
> 赞同：0
> 
> 时间：2013-03-14T23:37:12.820
> 
> 标签：html, css

我有这样的 HTML 结构：

```
<div class="wrapper">
   <div class="fixed_column"></div>
   <div class="fixed_column"></div>
   <div class="fixed_column"></div>
</div> 
```

这是我的 CSS ：

```
.wrapper{
  width:500px;
  float:left;
  /*overflow-y:scroll;*/
  overflow-x:scroll;
}

.fixed_column{
  float: left;
  height: 600px;
  position: relative;
  width: 250px;
} 
```

所以我只希望两列适合我的`wrapper`. 因此，如果没有第三列，它就可以放在里面。

一旦我像上面的 HTML 一样添加第三列，第三列就不会留在同一行，而是下降到下一行，我~~最终得到的是垂直滚动条而不是水平滚动条~~。添加`overflow-x`到我的css中，我没有得到水平滚动条，但第三列仍然下降到下一行。

但是我试图增加`wrapper`，`750px`这次所有三列都在同一行，所以我认为我的 css 没有任何问题，或者我认为错了吗？

为什么没有水平滚动一旦我`wrapper`是`500px`并且我在每个里面都有三列`width:250px`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T23:46:18.177

添加空格：nowrap；对于容器，使用 inline-block 代替 float，并使用 overflow-x 而不是 overflow-y。

这有效：

[http://jsfiddle.net/vXqY2/](http://jsfiddle.net/vXqY2/)

```
.wrapper {
    width: 600px;
    white-space: nowrap;
    overflow:scroll;
}
.fixed_column {
    display: inline-block;
    height: 100px;
    width: 250px;
    background-color: red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:01:54.780

如果浮动元素开始离开父容器的右侧，它们将自动回绕到下一个级别。这就是花车的工作原理。为了使它们保持在同一条线上，您有几个选择：

*   使父容器更宽（就像你做的那样），但你需要一个额外的滚动条元素
*   从切换`float: left;`到`display: inline-block;`（如@Alex 建议的那样），但您需要为 IE7 做出让步。
*   从 切换`float: left;`到`display: table-cell;`。不推荐这个，我试过了，结果有点痛苦:-p

查看**[jsFiddle 演示中的所有技术](http://jsfiddle.net/kAqmN/)**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-14T23:58:58.487

这是因为您的固定列`divs`只有 250px，所以它们永远不会破坏它们当前所在的 505px 容器。

这里试试这个。

例子：

```
<div class="wrapper">
    <div class="scroll-container">
        <div class="fixed_column">A</div>
        <div class="fixed_column">B</div>
        <div class="fixed_column">C</div>
    </div>
</div>

.wrapper {
    width: 505px;
    position:relative;
    overflow-y: scroll;
    overflow-x: scroll;
}
.scroll-container {
    width:1000px;
}
.fixed_column {
    float: left;
    height: 600px;
    position: relative;
    width: 250px;
    background-color: green;
} 
```

# autocomplete - 如何禁用/覆盖自动完成的回车键？

> ID：15422203
> 
> 赞同：47
> 
> 时间：2013-03-14T23:37:13.070
> 
> 标签：autocomplete, sublimetext3, keyboard-shortcuts, sublimetext

在 Sublime Text 3 中，我想禁用`enter`从自动完成下拉菜单中选择项目的键，并且只允许`tab`键这样做。

我在内置`Default (OSX).sublime-keymap`文件中找到了这一部分：

```
{ "keys": ["enter"], "command": "commit_completion", "context":
    [
        { "key": "auto_complete_visible" },
        { "key": "setting.auto_complete_commit_on_tab", "operand": false }
    ]
}, 
```

似乎如果我从配置中删除它`enter`不会在下拉列表中选择一个项目。不幸的是，不建议更改此文件，而仅在我的`User`文件中覆盖它。我不认为我实际上可以在不修改`.app`内容的情况下对其进行编辑。

我试图通过删除不同的部分来覆盖它，并删除除 之外的所有内容`"keys": ["enter"]`，但似乎没有任何效果。

`Default (OSX).sublime-keymap`在不修改内置文件且仅修改文件的情况下，我将如何实现这一目标`User/Default (OSX).sublime-keymap`？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-04-10T10:59:51.363

**我从未使用过 Sublime Text 3，**但我认为自 Sublime Text 2 以来以下内容没有改变。

你想要实现的其实是 Sublime Text 中的一个标准特性。你只需要打开它。

您引用的代码中的这一行……​​</p>

```
{ "key": "setting.auto_complete_commit_on_tab", "operand": false } 
```

... 表示“仅当名为 'auto_complete_commit_on_tab' 的设置设置为 false 时才执行命令”。所以只需打开该设置。

在 Default/Preferences.sublime-settings 中：

```
// By default, auto complete will commit the current completion on enter.
// This setting can be used to make it complete on tab instead.
// Completing on tab is generally a superior option, as it removes
// ambiguity between committing the completion and inserting a newline.
"auto_complete_commit_on_tab": false, 
```

放入`"auto_complete_commit_on_tab": true`User/Preferences.sublime-settings。这两个文件都可以通过首选项菜单访问。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-15T00:54:04.240

您可以将其分配给不存在的命令。尝试将以下内容添加到`User/Default (OSX).sublime-keymap`

```
{ "keys": ["enter"], "command": "noop", "context":
    [
        { "key": "auto_complete_visible" },
        { "key": "setting.auto_complete_commit_on_tab", "operand": false }
    ]
} 
```

如果您安装/编写具有命令的插件，`noop`则需要更改此命令。

**编辑**

Lydell 的解决方案更好:) 忘记了那个设置（虽然它是在上下文中，所以我应该知道......）。猜猜我的答案是更通用的“如何禁用键绑定”。

# c++ - 如何在可变参数模板上生成递归数据结构？

> ID：15422210
> 
> 赞同：4
> 
> 时间：2013-03-14T23:37:38.727
> 
> 标签：c++, templates, c++11, variadic-templates, recursive-datastructures

*我试图通过这个问题掌握使用 TMP**生成递归数据结构的技术。***

**问题**

假设我有一个**可变参数模板** `template<typename... Ts> struct my_sets { };`。

*在`my_sets`我想生成一个新类型，其数据成员依赖于`Ts`.*

例如，我想为其中的每个元素/类型`my_sets`拥有一个数据成员`std::set<T>``Ts...`

```
using x_t = my_sets<int,char,std::string>;
x_t x;

x.insert<0>(   5   );  // into a std::set<int> member in my_sets<>
x.insert<1>(  'z'  );  // into a std::set<char> member in my_sets<>
x.insert<2>( "foo" );  // into a std::set<std::string> member in my_sets<> 
```

我认为实现这一点的一种方法可能是通过使用子类化和递归，但我不确定。

fwiw，如果通过自由函数或普通函数重载来实现 mutator 更直接，那也没关系：

```
insert<0>( x,   5   );  // into a std::set<int> member in my_sets<>
insert<1>( x,  'z'  );  // into a std::set<char> member in my_sets<>
insert<2>( x, "foo" );  // into a std::set<std::string> member in my_sets<> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-14T23:42:16.690

这里有什么问题`std::tuple`？

```
#include <tuple>
#include <set>

template<class... Ts>
using my_sets = std::tuple<std::set<Ts>...>;

// ...

auto x = my_sets<int, char, std::string>;

std::get<0>(x).insert(5);
std::get<1>(x).insert('z');
std::get<2>(x).insert("foo"); 
```

对于外观，添加一个免费`insert`功能：

```
#include <utility>

template<std::size_t I, class SetTuple, class Arg>
auto insert(SetTuple& st, Arg&& arg)
  -> decltype(std::get<I>(st).insert(std::forward<Arg>(arg)))
{
  return std::get<I>(st).insert(std::forward<Arg>(arg));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:13:46.590

@Xeo 有一个优雅而简单的解决方案。但是，如果您想将其`insert<>`作为成员函数，则可以使用以下方法：

```
#include <set>
#include <tuple>

template<typename... Ts>
struct my_sets : protected std::set<Ts>...
{
    using types = std::tuple<Ts...>;

    template<int I, typename T>
    typename std::pair<
        typename std::set<typename std::tuple_element<I, types>::type>::iterator,
        bool> insert(T&& t)
    {
        return std::set<typename std::tuple_element<I, types>::type>::insert(
               std::forward<T>(t)
               );
    }

    // ...

    // Function for retrieving each set...
    template<int I>
    typename std::set<typename std::tuple_element<I, types>::type>& get()
    {
        return *this;
    }
}; 
```

这就是你将如何使用它

```
#include <string>

int main()
{
    my_sets<int, double, std::string> s;
    s.insert<0>(42);
    s.insert<1>(3.14);
    s.insert<2>("Hello World!");

    s.get<0>().insert(42);
} 
```

请注意，上述解决方案不允许在类型列表中多次出现同一类型（可能需要也可能不需要），尽管它可以很容易地扩展以允许它们：

```
#include <set>
#include <tuple>

namespace detail
{
    template<int... Is>
    struct indices
    {
        typedef indices<Is..., sizeof...(Is)> next;
    };

    template<int I>
    struct index_range
    {
        using type = typename index_range<I - 1>::type::next;
    };

    template<>
    struct index_range<0>
    {
        using type = indices<>;
    };

    template<int I, typename T>
    struct dummy : T { };

    template<typename, typename... Ts>
    struct my_sets { };

    template<int... Is, typename... Ts>
    struct my_sets<indices<Is...>, Ts...> : protected dummy<Is, std::set<Ts>>...
    {
        using types = std::tuple<Ts...>;

        template<int I, typename T>
        typename std::pair<
            typename std::set<typename std::tuple_element<I, types>::type>::iterator,
            bool
            > insert(T&& t)
        {
            return dummy<I, std::set<typename std::tuple_element<I, types>::type>>::
                insert(std::forward<T>(t));
        }

        template<int I>
        dummy<I, std::set<typename std::tuple_element<I, types>::type>>& get()
        {
            return *this;
        }
    };
}

template<typename... Ts>
using my_sets = detail::my_sets<
    typename detail::index_range<sizeof...(Ts)>::type,
    Ts...
    >; 
```

这就是你将如何使用它：

```
#include <string>

int main()
{
    my_sets<int, double, int, std::string> s;

    s.insert<0>(42);
    s.insert<1>(3.14);
    s.insert<2>(1729);
    s.insert<3>("Hello World!");

    s.get<0>().insert(42);
} 
```

# c# - Win'7 UART 蓝牙在四千字节后静音

> ID：15422213
> 
> 赞同：1
> 
> 时间：2013-03-14T23:37:54.060
> 
> 标签：c#, bluetooth, uart

我有一个小型嵌入式系统，我用调试例程安装了它，通过蓝牙连接将完全相同的字节一遍又一遍地发送到 PC。

有问题的速度是 921600 bps

在成功接收到大约四千字节（给或取几百）后，我的应用程序不再从 Win7 中看到

我完全有信心在流从我的应用程序中消失后继续发送字节（即超过四千）

我非常怀疑 Windows 出于某种原因没有提供蓝牙接收的内容。

我可以满怀信心地说...

*   该应用程序确实正确显示了前四千个奇怪的字节
*   之后该应用程序不显示任何内容
*   外部盒子继续发送字节

我对 Win'7 的怀疑越来越深，因为

*   停止应用程序后，我的外部发射盒继续。
*   两分钟后，我停止了外接发射盒
*   那一刻，PC和小盒子都没有互动
*   两个系统都停止后，（几分钟）我重新启动了 PC 应用程序
*   没有传输字节，应用程序收到了 941 个字节，我真的不知道是从哪里来的
*   这些字节来自上一个会话（我一遍又一遍地发送单个字节 0x37，这就是我在数据流中看到的）

然后我们再次启动小盒子生成数据，并看到相同的行为：看到 4435 个字节，之后我们没有从 UART 获得任何字节，尽管在 921600 bps 有两分钟的字节泛滥。

这是接收线程

```
 void RecieveThread()
  {
      int n;

      while (continueRecieving)
      {
          n = connectorPort.BytesToRead;

          byte[] bits = new byte[n];

          if (n > 0)
          {
              connectorPort.Read(bits, 0, n);
          }

          Write(bits);
      }
  } 
```

以防万一有人觉得它很重要，这里是 Write(bits) 例程

```
 public void Write(byte[] b)
 {
     if (writting)
     {
         for (int i = 0; i < b.Length; i++)
         {
             storage[sPlace++] = b[i];

             pass += b[i].ToString("X2") + " ";

             if (sPlace % numericUpDown1.Value == 0)
             {
                 pass += "\r\n";
             }
         }
     }
 } 
```

以前有没有人在装有 C# 应用程序的 Win7 机器上经历过蓝牙字节消失？

任何人都可以看到可能导致这种情况的明显（或晦涩）错误吗？

# assembly - 地址中不允许比例因子，x86_64 Xcode 4.6

> ID：15422214
> 
> 赞同：0
> 
> 时间：2013-03-14T23:38:02.167
> 
> 标签：assembly, x86, x86-64, memory-address

我真的很想使用这种地址构造，它根据遥远的记忆以及我所看到的任何地方都受到支持，但由于某种原因它扰乱了我的编译器/汇编器。

```
mov rax, [rsi+rcx*8] 
```

编译器在 * 上抛出一个错误，说

```
error: unknown token in expression mov rax, [rsi+rcx*8]
                                                    ^ 
```

这些说明是完全可以接受的：

```
mov rax, [rsi+rcx]; 
mov rax, [rsi+rcx+8] 
```

因此，要么编译器不支持缩放（好像？），要么在 64 位模式下不支持缩放？

这是在 Xcode 4.6 中，使用我推测的 LLVM，虽然这是我自软盘驱动器时代以来的第一个汇编程序项目，所以我不确定是谁在进行解析。我确实指定了 .intel_syntax。asm 位于 .s 文件中，而不是内联文件中。

那么 x86_64 模式是问题所在吗？从英特尔文档中，“64 位寻址使用现有的 32 位 ModR/M 和 SIB 编码”，但它只是忽略 SIB 字节中的比例位吗？

非常感谢

# asp.net - 来自未预编译的 ASP.NET 网站的预编译相关错误

> ID：15422217
> 
> 赞同：4
> 
> 时间：2013-03-14T23:38:28.510
> 
> 标签：asp.net, iis, iis-7.5

我有一个 XCOPIED 到生产环境的 ASP.NET 网站。我不使用 Visual Studio 发布此网站。我只是将页面后面的所有 aspx 和代码复制到生产环境中。没有发布配置文件。我的生产服务器正在运行 IIS 7.5，集成管道。如果我将 App_Code 目录添加到网站的根目录，则会收到以下错误：

> 目录 /App_Code 不允许，因为应用程序是预编译的

我注意到的另一个问题是我的 global.asax 文件的 Application_Start 没有被调用。（我肯定知道这一点，因为我从中抛出异常）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-15T20:51:33.087

不知何故，一个 precompiled.config 文件已经投入生产。不知道如何但删除该文件解决了 App_Code 目录错误和未调用 Application_Start 方法。

# c++ - 查找终端中打印的内容

> ID：15422219
> 
> 赞同：0
> 
> 时间：2013-03-14T23:38:37.297
> 
> 标签：c++, dll, printing, terminal, terminal-emulator

无论如何要检查终端（Linux和Windows）的某些位置的字符吗？我通过显式加载的 dll 加载了外部方法，该 dll 将某些字符打印到屏幕上。我需要看看这些功能是否打印了它们应该打印的内容，并且插件之间的串扰最小。所以在核心我想知道C++是否有任何从终端/命令行中提取字符的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:46:36.193

这在类似 VT100 的终端（Linux 中流行的那种）上是不可能的。

对于 Windows，我不能说，但如果您使用的是 cygwin 终端（不是 power shell 或“DOS shell”），答案又是否定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:51:07.843

您可以使用 tmux 或 screen 来设置虚拟终端。然后可以捕获显示状态，这似乎是您想要的。但我脑子里的一些东西告诉我，无论你想做什么，这可能都不是正确的解决方案。你的问题到底是什么？

# java - 利用 JNI 库：查找类

> ID：15422221
> 
> 赞同：1
> 
> 时间：2013-03-14T23:38:50.673
> 
> 标签：java, opencv, java-native-interface, javacv

我正在尝试在 Eclipse Java 项目（通过 javaCv）中使用 OpenCv，但我遇到了运行时`java.lang.ClassNotFoundExpection`和`java.lang.NoClassDefFoundError`错误。导入看起来不错，一切都运行良好，直到执行到这一行：

```
IplImage img = cvLoadImage(file.getAbsolutePath()); 
```

类加载器似乎无法找到`com.googlecode.javacpp.Pointer`.

这是我尝试过的：

*   我已将三个 jar 文件复制到 `[project_root]\lib`：javacv-windows-x86.jar、javacv.jar 和 opencv-2.4.4-windows-x86.jar。
*   我使用 Eclipse gui 将所有三个 jar 添加到我的构建路径中。
*   我将 `[...]\opencv\build\x86\vc11\bin` 添加到我的系统路径中。
*   我在 Eclipse 运行配置中添加了以下参数：`-Djava.library.path=[...]\opencv\build\x86\vc11\bin\*`

编辑：我只是错过了 javacpp jar。我已经从 javacv 项目下载了 javacv-0.4-cppjars 并在其中导入了相关的 jar（opencv-2.4.4-windows-x86.jar），但我需要[从单独的谷歌代码项目中获取 javacpp.jar](https://code.google.com/p/javacpp/)。

# windows - Git 我应该在项目文件夹中创建 repo 文件吗？

> ID：15422222
> 
> 赞同：1
> 
> 时间：2013-03-14T23:38:51.817
> 
> 标签：windows, git

当我设置 Git 时，我有点困惑。我在我的本地存储库`C:\Repository`和根我的项目位于`C:\Projects`。我想问我应该将 repo 文件创建到工作项目文件夹中还是不应用于提交和推送到本地 repo？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:52:04.883

如果我猜对了，您在 C:/Projects 中有一个项目，在 c:/Repository 中有一个存储库，并且您希望将更改从项目存储库推送到 c:/Repository。

在这里您可以如何设置所有这些（我假设您在 Windows 上使用 Git 而不是 Cygwin git）：

```
$ mkdir -p /c/Repository/MyProject.git
$ cd /c/Repository/MyProject.git
$ git init --bar                   # Create "server" (bar) repository

$ mkdir -p /c/Projects/MyProject
$ git init                         # Create project repository
$ git config user.name "My Name"
$ git config user.email "My@e-mail"

$ # set more properties...

$ # create some files
$ # ...

$ git add -A .                     # Add new files to the index
$ git commit -m "Initial commit"
$ git remote add origin /c/Projects/MyProject
$ git push origin master:master 
```

# asp.net-mvc-4 - 信号器是否适用于 IE 9？

> ID：15422223
> 
> 赞同：0
> 
> 时间：2013-03-14T23:38:53.350
> 
> 标签：asp.net-mvc-4, signalr

我有一个网站 MVC4c#。我安装了 signalr 1.0.1 它在 Firefox 上运行良好。但在 IE9 上无法连接我的代码：

```
var myHub= $.connection.myHub;
    $.connection.hub.error(function () {
        alert("error connect");
    });

 $.connection.hub.start(function () {
    }).fail(function () {
        alert("error connect");
    }).done(function () {
        alert("connect");
    }); 
```

使用 Firefox 可以正常工作。即 9 号 它曾经与以前版本的 SignalR 一起工作。因为我从 nuget 1.0.1 安装了包，它停止在 IE 上工作。

在 IE 开发人员工具中我没有看到 javascript 错误，在网络捕获中我看到：每 10 秒它执行 2 个请求：键值请求 GET

```
localhost:51090/signalr/ping?_=1363305928522 
```

HTTP/1.1 响应 {"Response":"pong"} 和立即另一个请求：

```
http://localhost:51090/signalr/reconnect?transport=longPolling&connectionToken=pKuceZE_v-uecAzzq4rgj4Gz6AY1KagOgnzwqtG197hftvZOfK_LDqMo9VI5iRnkX4f2K9Wno7tBzVTxrLi4Xs7doGsChAkL6ejRykvTtDMHMdNR-FlScXPT4wwNeD7Y-AZa1Rb5XVpDUsv2S2qXs3ZSWjxJg9uGiq1QYLG1FUfMVMVDQq8aoDWLjkUGk2CR0&connectionData=%5B%7B%22name%22%3A%22tradehub%22%7D%5D&messageId=B%2C2%7CL%2C2%7CM%2C0%7CN%2C0&tid=3&_=1363305928541 
```

没有回应

# oauth-2.0 - 使用不同的用户/资源所有者登录

> ID：15422227
> 
> 赞同：0
> 
> 时间：2013-03-14T23:39:17.367
> 
> 标签：oauth-2.0, google-api-dotnet-client

我正在尝试编写一个在谷歌日历中创建条目的工具。在遵循谷歌文档并在 api 控制台中创建客户端标识符/秘密之后，我设法将一个客户端组合在一起，该客户端可以正确验证并显示我注册的谷歌日历。现在对我来说，我的谷歌帐户似乎以某种方式与我的客户标识符/秘密相关联。我想知道的是：如何更改身份验证过程，以便该工具的其他用户可以输入他的 google-id 并访问他的日历？

编辑：换句话说（在 RFC 中使用）：我想让资源所有者部分可编辑，同时保持客户端部分不变。但我的示例虽然有效，但将客户和资源所有者联系在一起。

这是我到目前为止运行良好的应用程序：

```
 public void Connect()
    {
        var provider = new NativeApplicationClient(GoogleAuthenticationServer.Description);
        provider.ClientIdentifier = "123456123456.apps.googleusercontent.com";
        provider.ClientSecret = "nASdjKlhnaxEkasDhhdfLklr";
        var auth = new OAuth2Authenticator<NativeApplicationClient>(provider, GetAuthorization);
        var service = new CalendarService(auth);

        //Events instances = service.Events.Instances("primary", "recurringEventId").Fetch();
        var list = service.CalendarList.List().Fetch();

        foreach (var itm in list.Items)
            Console.WriteLine(itm.Summary);
    }

    private static readonly byte[] AditionalEntropy = { 1, 2, 3, 4, 5 };

    private static IAuthorizationState GetAuthorization(NativeApplicationClient arg)
    {
        var state = new AuthorizationState(new[] { CalendarService.Scopes.Calendar.GetStringValue() });
        state.Callback = new Uri(NativeApplicationClient.OutOfBandCallbackUrl);

        var refreshToken = LoadRefreshToken();
        if (!String.IsNullOrWhiteSpace(refreshToken))
        {
            state.RefreshToken = refreshToken;

            if (arg.RefreshToken(state))
                return state;
        }

        var authUri = arg.RequestUserAuthorization(state);

        // Request authorization from the user (by opening a browser window):
        Process.Start(authUri.ToString());
        var frm = new FormAuthCodeInput();
        frm.ShowDialog();

        // Retrieve the access token by using the authorization code:
        var auth = arg.ProcessUserAuthorization(frm.txtAuthCode.Text, state);
        StoreRefreshToken(state);
        return auth;
    }

    private static string LoadRefreshToken()
    {
        try
        {
            return Encoding.Unicode.GetString(ProtectedData.Unprotect(Convert.FromBase64String(Properties.Settings.Default.RefreshToken), AditionalEntropy, DataProtectionScope.CurrentUser));
        }
        catch
        {
            return null;
        }
    }

    private static void StoreRefreshToken(IAuthorizationState state)
    {
        Properties.Settings.Default.RefreshToken = Convert.ToBase64String(ProtectedData.Protect(Encoding.Unicode.GetBytes(state.RefreshToken), AditionalEntropy, DataProtectionScope.CurrentUser));
        Properties.Settings.Default.Save();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T03:03:14.543

提示用户输入他们的 ClientIdentifier 和 ClientSecret，然后将这些值传递给您的 Connect 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T13:29:16.487

我自己解决了这个问题。

问题是，我通常总是连接到谷歌，因为在我的应用程序重定向到谷歌以获取访问令牌之前我没有从谷歌注销，谷歌自动为我的帐户生成访问令牌 - 跳过部分出现输入表单的地方，任何人都可以输入他/她的用户凭据，让谷歌为他/她的帐户生成访问令牌。

# unit-testing - 在维护一个测试套件时，所有的“错误”最终都应该变成“失败”吗？

> ID：15422228
> 
> 赞同：0
> 
> 时间：2013-03-14T23:39:22.170
> 
> 标签：unit-testing, testing, tdd

我是 python unittest 的用户，但这跨越了所有语言。

Senario：我发现了“functionBeingTested”中的一个缺陷。
缺陷是在有效输入时代码会崩溃（抛出异常）

在编写测试用例时，我可以很简单地：

```
def testThis(self):
    self.assertEqual( functionBeingTested("valid input"), "expected output") 
```

在 TDD 术语中，这应该是“失败”，但相反，它会引发异常，并且您会得到一个“错误”：

```
 Ran 1 tests with 0 failures and 1 errors 
```

有人会假设您想要：

```
 Ran 1 tests with 1 failures and 0 errors 
```

[这个Python](https://stackoverflow.com/questions/12510412/python-unittest-reporting-exception-as-failure)单元测试有解决方案：将异常报告为失败

还有一个类似的讨论：[如果没有抛出异常，则通过单元测试](https://stackoverflow.com/questions/6181555/pass-a-unit-test-if-an-exception-isnt-thrown)

但这不是问题。

问题是“维护测试套件的最佳实践”

在纯测试驱动开发中编写“错误测试用例”[如果有这样的事情]在哲学上是否可以接受，或者是否应该编写此单元测试来捕获异常并引发断言错误以证明“失败”而不是'错误'。

更多阅读未能阐明这个问题： http: [//www.computer.org/portal/web/swebok/html/ch5#Ref1.1.2](http://www.computer.org/portal/web/swebok/html/ch5#Ref1.1.2)
“IEEE软件工程术语标准词汇表”（谷歌它）

并查看 Python 2 和 Python 3 单元测试文档之间的编辑：http: [//docs.python.org/2/library/unittest.html#organizing-test-code](http://docs.python.org/3/library/unittest.html#organizing-test-code) [http://docs.python.org/3/library](http://docs.python.org/2/library/unittest.html#organizing-test-code) [/unittest.html#organizing-test-code](http://docs.python.org/3/library/unittest.html#organizing-test-code)

似乎在 Python 3 中省略了这个短语：

> [error] 帮助您确定问题出在哪里：失败是由不正确的结果引起的 - 5，而您期望得到 6。错误是由不正确的代码引起的 - 例如，由不正确的函数调用引起的 TypeError。

* * *

正在考虑这个问题的其他标题：
“为什么单元测试会出现‘失败’和‘错误’案例？”
或
“'失败'和'错误'之间的哲学区别是什么
或
“在 TDD 中，是否应该编写所有“失败测试”以抛出“失败”或“错误”可接受”

仍然试图准确地确定我在这里要问的内容，而没有得到像“一个是断言错误而另一个不是”这样的简单答案，我很乐意投反对票。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:57:01.587

抛出异常是指示失败的一种方式。这意味着不满足测试的前提条件之一。问“这个调用是否没有抛出异常”通常并不有趣——这是一个我们必须对所有代码提出的问题。

发现“这个名义上有效的输入导致抛出异常”的错误这一事实表明测试套件中存在错误——某些输入类别没有被覆盖。导致抛出异常的输入类通常需要关于预期输出应该是什么的稍微专门的规则，因此在将新发现的错误的测试措辞作为缺乏覆盖错误的修复时几乎总是有文献价值.

这是一种冗长的说法，是的，您编写的测试测试了两件事。但是它测试的东西之一是我们不应该明确测试的东西，因为它并不有趣。无聊的测试是糟糕的测试。

# actionscript-3 - As3 RotationX 和 RotationY 模糊原始图像

> ID：15422231
> 
> 赞同：1
> 
> 时间：2013-03-14T23:39:31.093
> 
> 标签：actionscript-3

我有一个关于 RorationX、Y、Z 的快速问题

每当我应用它时，我的图像就会变得模糊

_eventParent.getChildAt(1) 是一个精灵。

有什么理由吗？我该如何阻止呢？

```
 _eventParent.getChildAt(1).rotationY = _differentX; 
        _eventParent.getChildAt(1).rotationX = _differentY; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T08:37:51.350

当您旋转精灵时，它会自动获得关联的位图缓冲区，以便使用渲染引擎进行快速操作。有一些解决方案，虽然不是很有效，但这里是 [迄今为止最好的方法的链接。](http://www.flashandmath.com/flashcs4/blursol/)

# image - 如何在 Delphi 中用 alpha 透明度绘制透明？

> ID：15422237
> 
> 赞同：9
> 
> 时间：2013-03-14T23:40:03.440
> 
> 标签：image, delphi, graphics, gdi+

我想用 alpha 透明矩形和 alpha 透明图像绘制相当复杂的图像。 [Mitov 有 GDI+ 包装器](http://www.mitov.com/products/igdi+)，但它似乎不支持 32 位 BMP 文件，而且它会重新缩放它们，而且文档很糟糕。BMP 比 PNG 快得多，所以我想使用它们。 [有 GDI+ 的 SynGDI 包装器](http://synopse.info/fossil/wiki?name=Downloads)，但它看起来非常基本，并且没有相关文档。GDI 也有这个技巧：

```
procedure DrawAlphaAPI(Source: TBitmap; Destination: TCanvas;
  const X, Y: Integer; const Opacity: Byte = 255);
var  BlendFunc: TBlendFunction;
begin
  BlendFunc.BlendOp := AC_SRC_OVER;
  BlendFunc.BlendFlags := 0;
  BlendFunc.SourceConstantAlpha := Opacity;

  if Source.PixelFormat = pf32bit then
    BlendFunc.AlphaFormat := AC_SRC_ALPHA
  else
    BlendFunc.AlphaFormat := 0;

  Windows.AlphaBlend(Destination.Handle, X, Y, Source.Width, Source.Height,
  Source.Canvas.Handle, 0, 0, Source.Width, Source.Height, BlendFunc);
end; 
```

但是当我用 Opacity = 255 调用它时，它会不正确地绘制 32 位位图（就像它们在应该完全透明的地方是半透明的）。我不想使用 Scanline 使像素透明，因为这样绘制所有透明矩形太复杂了。此外，我认为 GDI+ 在现代计算机上应该更快，对吗？

所以问题是：如何轻松绘制 alpha 透明矩形和位图（无需大量代码）？

首选 Delphi：7。我也有 2005 和 XE3，但由于 7 是速度恶魔，我最希望从 7 开始工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-15T07:05:48.727

如果您准备普通的 TBitmap，则可以使用任何 GDI+ 实现，只需分配 bmp.Canvas.Handle。您的编译问题可能是由文件夹中的旧 DirctDraw-Version 引起的，只需将其删除即可。

```
implementation

uses GDIPAPI, GDIPOBJ;
{$R *.dfm}

Procedure PrepareBMP(bmp: TBitmap; Width, Height: Integer);
var
  p: Pointer;
begin
  bmp.PixelFormat := pf32Bit;
  bmp.Width := Width;
  bmp.Height := Height;
  bmp.HandleType := bmDIB;
  bmp.ignorepalette := true;
  bmp.alphaformat := afPremultiplied;
  // clear all Scanlines
  p := bmp.ScanLine[Height - 1];
  ZeroMemory(p, Width * Height * 4);
end;

procedure TForm2.Button1Click(Sender: TObject);
var
  bmp: TBitmap;
  G: TGPGRaphics;
  B: TGPSolidBrush;
begin
  bmp := TBitmap.Create;
  try
    PrepareBMP(bmp, 300, 300);
    G := TGPGRaphics.Create(bmp.Canvas.Handle);
    B := TGPSolidBrush.Create(MakeColor(100, 255, 0, 0));
    try
      G.SetSmoothingMode(SmoothingModeHighQuality);
      G.FillEllipse(B, MakeRect(0.0, 0, 300, 300));
      B.SetColor(MakeColor(100, 0, 255, 128));
      G.FillEllipse(B, MakeRect(40.0, 40, 260, 260));
    finally
      B.Free;
      G.Free;
    end;
    // draw overlapping in Form Canvas to display transparency
    Canvas.Draw(0, 0, bmp);
    Canvas.Draw(100, 100, bmp);
  finally
    bmp.Free;
  end;
end; 
```

![演示](../Images/72b16faed832a6416c404513cf304f42.png)

# python - 类继承和__new__

> ID：15422241
> 
> 赞同：1
> 
> 时间：2013-03-14T23:40:25.960
> 
> 标签：python

我在`__metaclass__`类的属性和实际继承之间有很多混淆，以及`__new__`在这两种情况下如何调用。我的问题来自于挖掘 django 框架中的一些模型代码。

假设我想将一个属性附加到一个类，因为它是在孩子的`Meta`子类中定义的：

```
class Parent(type):

    def __new__(cls, name, base, attrs):
        meta = attrs.pop('Meta', None)
        new_class = super(Parent, cls).__new__(cls, name, base, attrs)
        new_class.fun = getattr(meta, 'funtime', None)
        return new_class 
```

我不明白为什么`__new__`在 django 的代码中调用实际方法，但是当我尝试编写类似的代码时它不起作用。

根据我的经验，以下实际上并没有调用`__new__`父级的方法：

```
class Child(Parent):
    class Meta:
       funtime = 'yaaay'

C = Child() 
```

当我尝试这样做时，它会抱怨 TypeError：

`TypeError: __new__() takes exactly 4 arguments (1 given)`

但是，我一直在查看的源代码似乎以这种方式工作。

我知道可以使用元类来完成：

```
class Child(object):
    __metaclass__ = Parent 
```

但我不明白为什么他们的方式适用于他们而不适用于我，因为非`__metaclass___`用于制作可分发模块会更清洁。

有人可以指出我所缺少的正确方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:44:06.690

在扩展的元类中`type`，`__new__`用于创建一个类。

在一个类中，`__new__`用于创建一个实例。

元类是创建类的类。你对类继承和元类感到困惑。

你的`Child`类继承`Parent`，你想创建一个`Child`. 但是，`Parent`作为元类意味着`Parent.__new__`不应该用于创建类的实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:02:01.650

在 django 中，`Model`不是元类。实际上元类是`ModelBase`. 这就是为什么他们的方式行得通而你的方式行不通的原因。
此外，最新的 django 使用辅助函数[`six.with_metaclass`](https://github.com/django/django/blob/1.5c2/django/utils/six.py#L364), 来包装“ModelBase”。

如果我们想遵循 django 的风格，`Parent`class`Child`看起来像

```
def with_metaclass(meta, base=object):
    """Create a base class with a metaclass."""
    return meta("NewBase", (base,), {})

class ParentBase(type):
    def __new__(cls, name, base, attrs):
        meta = attrs.pop('Meta', None)
        new_class = super(ParentBase, cls).__new__(cls, name, base, attrs)
        new_class.fun = getattr(meta, 'funtime', None)
        return new_class

class Parent(with_metaclass(ParentBase)):
    pass

class Child(Parent):
    class Meta:
       funtime = 'yaaay'

c = Child()

>>> c.fun
'yaaay' 
```

让我们专注于`Parent`。它几乎等同于

```
NewBase = ParentBase("NewBase", (object,), {})
class Parent(NewBase):
    pass 
```

关键是怎么理解`ParentBase("NewBase", (object,), {})`。
让我们回忆一下[`type()`](http://docs.python.org/2/library/functions.html#type)。

> 类型（名称、基数、字典）
> 
> > 使用三个参数，返回一个新的类型对象。这本质上是类语句的动态形式。name字符串是类名，成为**name**属性；基元组逐项列出基类并成为**基**属性；并且 dict 字典是包含类主体定义的命名空间，并成为**dict**属性。例如，以下两个语句创建相同的类型对象：

由于`ParentBase`是元类，是 的子类`type`。因此，`ParentBase("NewBase", (object,), {})`与 非常相似`type("NewBase", (object,), {})`。在这种情况下，唯一的区别是动态创建的类不是 的实例`type`，而是`ParentBase`。换句话说，元类`NewBase`是`ParentBase`。`Parent`相当于

```
class NewBase(object):
    __metaclass__ = ParentBase

class Parent(NewBase):
    pass 
```

最后，我们得到了一个`__metaclass__`.

# performance - javascript shell 与 pymongo 中 db.eval() 的 MongoDB 性能

> ID：15422243
> 
> 赞同：16
> 
> 时间：2013-03-14T23:40:43.903
> 
> 标签：performance, mongodb, profiling, eval, pymongo

我需要对需要在数组中旋转一些值的文档执行更新操作。MongoDB 更新查询目前不允许您`$pop`再`$push`对同一字段进行更新。在网上搜索了建议后，我决定这`db.eval()`将最适合我的使用，因为它确保了原子性并且我正在执行的操作非常短，因此它不会锁定数据库太久。

这是我正在尝试做的事情的一个例子：

```
db.eval(function (id, newVal) {
    doc = db.collection.findOne({_id: id});
    doc.values.shift();
    doc.values.push(newVal);
    db.collection.save(doc);
}, id, newVal); 
```

这非常有效！然后我启用了 mongoDB 分析以查看命令花费了多少毫秒，`eval()`并且我总是得到少于 1 毫秒的结果：

```
 > db.system.profile.find({op: "command"}, {"millis": 1}) 
 { "millis" : 0 }
 { "millis" : 0 }
 ... 
```

这对我来说是个好消息，除了我的应用程序是在 python 中，所以我使用 pymongo 客户端来执行`eval()`命令。（上面的数据来自 mongo shell）但是现在，当我`eval()`使用 pymongo 运行相同的命令时：

```
conn = pymongo.Connection(mongo_server_hostname)
db = conn.my_db

db.eval("""function (id, newVal) {
    doc = db.collection.findOne({_id: id});
    doc.values.shift();
    doc.values.push(newVal);
    db.collection.save(doc);
}""", id, new_val) 
```

我得到了非常不同的分析结果：

```
> db.system.profile.find({op: "command"}, {"millis": 1}) 
{ "millis" : 13 }
{ "millis" : 14 }
{ "millis" : 14 }
... 
```

从 mongo shell 和 pymongo 中运行相同的命令是否有根本的不同`eval()`，导致服务器从 pymongo 运行相同的命令要多花 14 毫秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T08:39:44.937

您看到的差异的一个可能原因（但不一定*是*`mongo`原因）是shell 和`mongod`服务器默认[使用 Google 的 v8 Javascript 引擎](https://github.com/mongodb/mongo/tree/master/src/third_party/v8)（尽管它可以配置为使用 Spidermonkey 作为替代）来解释命令你给。

Google 的 v8 在 Javascript 代码中看到了热点，并且很可能是经常使用的 JIT 代码。

另一方面，vanilla PyMongo 是[用纯 Python 编写的](https://github.com/mongodb/mongo-python-driver#readme)，这意味着它总是会被解释，这是一个相当大的开销。

如果您还没有这样做，一种可能性是使用[用 C 编写的 PyMongo 扩展](http://api.mongodb.org/python/current/installation.html#dependencies-for-installing-c-extensions-on-unix)而不是默认扩展，或者，如果您的应用程序的其余部分兼容，则使用 Python 的 PyPy JIT 解释器。

如果您使用任何从 Debian 派生的发行版（如 Ubuntu），[python-pymongo-ext](http://packages.debian.org/sid/python-pymongo-ext)包会为您提供 PyMongo C 版本的预编译版本。

# android - Android textchange 监听器

> ID：15422245
> 
> 赞同：0
> 
> 时间：2013-03-14T23:41:00.973
> 
> 标签：android

我想要做的是，如果文本为空，那么不要调用文本更改侦听器。

```
public void afterTextChanged(Editable s) {
                if(et1.getText().toString().length() == 0){
                    et1.removeTextChangedListener(watcher);
                    et1.setText("");
                }
            } 
```

这不起作用为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:54:28.530

Editable 由方法签名声明为 's' 而不是 'et1'

```
 public void afterTextChanged(Editable s) { ... } 
```

# jquery - 颜色代码最接近可用的颜色

> ID：15422247
> 
> 赞同：0
> 
> 时间：2013-03-14T23:41:15.327
> 
> 标签：jquery, color-picker, color-codes

我正在尝试使用任何可用的 jquery 颜色选择器。当用户选择一种颜色时，我必须将其与最接近的可用颜色匹配并查询数据库。问题是，对于给定的颜色代码，我如何将它与可用颜色列表中最接近的颜色代码匹配？

# java - Soundcloud Flash 小部件，尝试在页面上播放下一首歌曲

> ID：15422248
> 
> 赞同：0
> 
> 时间：2013-03-14T23:41:23.487
> 
> 标签：java, javascript, soundcloud

我正在和我的朋友创建一个个人博客，我们在其中通过 soundcloud 上传我们最喜欢的歌曲，并希望歌曲一个接一个地播放。

这是每首歌曲将在页面上列出的总体思路。[http://jsfiddle.net/PJWQZ/](http://jsfiddle.net/PJWQZ/)

```
<div class="item">
<object height="200" width="200"> <param name="movie" value=        "https://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F60974071&amp;auto_play=false&amp;player_type=artwork&amp;color=0066cc"> 
<param name="allowscriptaccess" value="always"> <embed allowscriptaccess="always" height="200" width="200" src="https://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F60974071&amp;auto_play=false&amp;player_type=artwork&amp;color=0066cc" type="application/x-shockwave-flash">          </object> 
</div> 
```

唯一的问题是，一旦歌曲完成，什么都不会发生。我正在寻找是否可以使用 Javascript 来查找歌曲何时结束（使用 onMediaEnd）并自动播放下一首歌曲，而无需使用播放列表 API。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T16:15:11.367

这是一个基于[自定义播放器 API](http://developers.soundcloud.com/docs/custom-player)的示例。

[http://jsfiddle.net/8mWXq/](http://jsfiddle.net/8mWXq/)

我无法在 JSFiddle 上加载图形，但单击第一首曲目开始播放，然后在接近尾声时 FF（单击），当第一首曲目停止时，第二首曲目将开始播放。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>SC player example: Artwork Skin</title>
    <link rel="stylesheet" href="../css/sc-player-artwork.css" type="text/css">
  </head>
  <body>
    <h1>I Love Cover-Art</h1>
    <div class="post">  
      <h2>2012</h2>
      <div class="sc-player">
        <a href="http://soundcloud.com/kreek/you-know-it" class="sc-player">Track 1</a>
        <a href="http://soundcloud.com/kreek/amnesia" class="sc-player">Track 2</a>
      </div>
    </div>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript" src="../js/soundcloud.player.api.js"></script>
    <script type="text/javascript" src="../js/sc-player.js"></script>
  </body>
</html> 
```

# c# - 什么是 ADO.NET 输出参数

> ID：15422249
> 
> 赞同：0
> 
> 时间：2013-03-14T23:41:27.390
> 
> 标签：c#, ado.net

我正在阅读 Murachs ADO.NET 4 数据库编程书。在第 7 章中，他们讨论了输出参数。我在编写数据阅读器时从未见过这种情况。这本书对这个话题很感兴趣，互联网也是如此。我的问题是什么是输出参数，你会在什么情况下使用输出参数。

这是书中的例子：

```
SELECT @Name = Name, @Address = Address1, @Address2 = Address2, @City = City
FROM Vendors
WHERE VendorID = @VendorID 
```

如您所见，此查询的选择区域中有参数。这是如何运作的？我以前从未在那里见过他们。我总是在 where 子句中看到它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:45:24.793

如果您有一个存储过程，您希望返回多个标量值而不必将它们放入结果表中，您可以使用多个输出参数。

T-SQL 上下文（无论是存储过程还是直接执行 SQL）接受参数，并返回以下任何或所有内容：

1.  结果集（由零个或多个表组成）
2.  返回码或值
3.  输出参数
4.  留言

在您发布的 T-SQL 中，这意味着代码不是在结果集中返回表，而是将单数标量字段值存储在 T-SQL 变量中（因为`VendorID`是主键，只会返回 1 行），并且大概这些变量被绑定为输出参数，因此可以由调用 SQL 客户端访问。

在某种程度上，可以将 T-SQL 脚本的输出与 C# 函数进行比较，该函数可以通过设置`out`方法参数、提供返回值以及写入`stdout`or `stderr`（或任何其他非本地、范围内的资源）来输出.

# ios6 - 来自 XIB 的 UINavigationcontroller 的 iOS 6 旋转问题

> ID：15422253
> 
> 赞同：0
> 
> 时间：2013-03-14T23:41:36.287
> 
> 标签：ios6, uinavigationcontroller, rotation

我试图让一些视图在我的应用程序中旋转（只有两个），我之前已经成功地做到了这一点，继承 UINavigationcontroller 并覆盖相应的方法。这次的问题是我正在使用第三方项目，该项目从 .xib 文件（不是以编程方式）创建导航控制器。我更改了 .xib 文件中的类以使用我的自定义导航控制器，它确实如此，但由于某种原因忽略了像 shouldAutorotate 和supportedInterfaceOrientations 这样的覆盖方法

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:31:50.460

我仍在寻找一种更优雅的方式来处理这个问题，但我将分享一个对我有用的小技巧。如果你发现更好的东西，请告诉我。

在具有复杂导航树的应用程序中，一种对我来说效果不错的方法是，如果您的应用程序中没有导航控制器，则为第一个导航控制器或第一个视图控制器安装自定义子类。那就是将接收 shouldAutoRotate 调用的那个。

听起来你已经这样做了。

现在您需要在 shouldAutoRotate 部分插入您自己的逻辑。我所做的是在 appDelegate 中使用 BOOL 作为存储视图控制器是否应该自动旋转的地方。基本上它是这样工作的：

应用删除：

```
@property (nonatomic,assign) BOOL allowAutoRotationForThisViewController; 
```

堆栈顶部的自定义导航控制器：

```
- (BOOL)shouldAutorotate {
     AppDelegate *a = [[UIApplication sharedApplication] delegate];
     return a.allowAutoRotationForThisViewController;
} 
```

可旋转视图控制器：

```
-(void) viewWillAppear:(BOOL)animated {
     [super viewWillAppear:animated];
     AppDelegate *a = [[UIApplication sharedApplication] delegate];
     a.allowAutoRotationForThisViewController = YES:

}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];
     AppDelegate *a = [[UIApplication sharedApplication] delegate];
     a.allowAutoRotationForThisViewController = NO:
} 
```

我不确定他们为什么在 ios6 中改变了这一点，这似乎要困难得多，尤其是当你有复杂的导航结构时。我在堆栈顶部有一个带有“幻灯片”类型控制器的应用程序，一个标签栏控制器和一堆导航控制器。试图通过所有这些来获得堆栈底部的 Web 视图以进行旋转，或者让它们响应顶级控制器是非常复杂的。所以我使用了这种方法。

现在，您必须考虑的一件事 - 如果 BOOL 变为 NO，则不会发生旋转 - 所以一个问题是，如果您的可旋转视图控制器在旋转时弹回其父级。然后父级将被旋转，可旋转视图控制器将旋转值设置回 no。我在我的方法中解决了这个问题，除非它处于纵向模式，否则我会阻止它关闭 - 基本上我在横向模式下禁用了“后退”按钮。

它的工作原理如下： - 视图出现在屏幕上 - 将旋转设置为 YES - 发生旋转 - 此时，正在旋转的视图将获得以下选择器调用：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration 
```

因此，在该调用中，您将配置本地视图并执行您需要做的任何事情来设置视图以更改方向 - 例如 self.navigationController.hidesBackButton = YES;

希望这会有所帮助，就像我说的那样，它有点像黑客，我正在寻找更优雅的东西。

祝你好运

# linux - Bash 重新着色目录中的所有 svg 文件

> ID：15422260
> 
> 赞同：1
> 
> 时间：2013-03-14T23:42:07.307
> 
> 标签：linux, bash, map, svg

有谁知道如何为这个项目中找到的所有 svg 文件重新着色？

[https://github.com/twain47/Open-SVG-Map-Icons/blob/master/tools/recolour.sh](https://github.com/twain47/Open-SVG-Map-Icons/blob/master/tools/recolour.sh)

我对 bash 没有经验，对 linux 的经验也很少，但在我看来，你只需要遍历 svg 目录并运行 recolour.sh ，但这对我来说都是希腊语。

如果这个问题太具体，请删除它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:03:20.997

您可以从项目根目录运行它。随意根据需要切换颜色。

```
find . -name '*.svg' | while read filename; do
    tools/recolour.sh $filename '#FF0000' '#00FF00' '#0000FF' | sponge $filename
done 
```

或者，如果您不知道如何获取海绵命令：

```
find . -name '*.svg' | while read filename; do
    tmpfile=$(mktemp -t temp)
    tools/recolour.sh $filename '#FF0000' '#00FF00' '#0000FF' > $tmpfile
    mv $tmpfile $filename
done 
```

# sql - 从表中选择不同的前 4 条记录

> ID：15422267
> 
> 赞同：3
> 
> 时间：2013-03-14T23:42:25.317
> 
> 标签：sql, sql-server

我有以下 SQL Server 表

我想要下表中最新的所有前 4 个不同代码
请记住，我希望返回所有列，而不仅仅是代码列。

```
sno  city      state  country  code  date
1    new york  NY      US      1234  1/1/2013
2    Houston   TX      US      2234  1/6/2013 
3    LA        CA      US      1123  1/2/2013
4    Chicago   IL      US      1244  1/3/2013
5    Brooklyn  NY      US      1234  1/4/2013
6    Dallas    TX      US      2234  1/5/2013 
```

我的以下选择查询返回重复代码，但我想要不同的最新代码。

```
select top 4 * from table1 where code in (select distinct code from table1) 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T00:02:48.217

```
WITH topList
AS
(
    SELECT  sno, city, state, country, code, date,
            ROW_NUMBER() OVER(PARTITION BY code ORDER BY DATE DESC) rn
    FROM    TableName
)
SELECT  TOP 4 sno, city, state, country, code, date
FROM    topList
WHERE   rn = 1
ORDER   BY DATE DESC 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/e337c/2)

输出

```
╔═════╦══════════╦═══════╦═════════╦══════╦════════════╗
║ SNO ║   CITY   ║ STATE ║ COUNTRY ║ CODE ║    DATE    ║
╠═════╬══════════╬═══════╬═════════╬══════╬════════════╣
║   2 ║ Houston  ║ TX    ║ US      ║ 2234 ║ 1/6/2013   ║
║   5 ║ Brooklyn ║ NY    ║ US      ║ 1234 ║ 1/4/2013   ║
║   4 ║ Chicago  ║ IL    ║ US      ║ 1244 ║ 1/3/2013   ║
║   3 ║ LA       ║ CA    ║ US      ║ 1123 ║ 1/2/2013   ║
╚═════╩══════════╩═══════╩═════════╩══════╩════════════╝ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:06:31.243

这很简单`GROUP BY`

```
SELECT TOP 4 * FROM table1
WHERE sno IN (SELECT MAX(sno) FROM table1 GROUP BY code)
ORDER BY date DESC; 
```

虽然，这是最近的 (?) group by `sno`，而不是 date。

# facebook - Facebook 自动从网站发帖

> ID：15422269
> 
> 赞同：0
> 
> 时间：2013-03-14T23:42:50.690
> 
> 标签：facebook, facebook-graph-api, facebook-like, facebook-javascript-sdk

我需要在这里制作这样的脚本：http: [//onion.mk/konecno-objaveno-domasnoto-video-na-nasata-voditelka/ ?ref=top](http://onion.mk/konecno-objaveno-domasnoto-video-na-nasata-voditelka/?ref=top)

查看帖子几秒钟后，会自动将您重定向到 facebook APP 并要求您登录以查看帖子。首次登录后，每次您看到任何其他帖子都会自动发布到您的时间线。

它的 javascript 可以在网站的源代码中找到，但无法正常工作......那里缺少一些东西......有人可以帮助我吗？

```
<div
id="fb-root"></div><script>
  var app_id = '467647329957056';   var cookie_prefix = 'onion_mk_';
  var appdomain = 'onion.mk';
  var appdomain_formatted = appdomain.charAt(0).toUpperCase() + appdomain.substring(1);
        function setCookie(c_name, value, exdays, time) {
            var exdate = new Date();
            if(time!='')
            {
                exdate.setTime( exdate.getTime() + (time*60*1000));
            }else{
                exdate.setDate(exdate.getDate() + exdays);
            }            
            var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString()) + ";path=/;domain=" + appdomain;
            document.cookie = cookie_prefix + c_name + "=" + c_value;
        }
        function getCookie(c_name) {
            var i, x, y, ARRcookies = document.cookie.split(";");
            for (i = ARRcookies.length - 1; i >= 0; i--) {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x == cookie_prefix + c_name) {
                    return unescape(y);
                }
            }
        }

function isEmpty(obj) {
    for(var prop in obj) {
        if(obj.hasOwnProperty(prop))
            return false;
    }

    return true;
}
  window.fbAsyncInit = function() {
    FB.init({
      appId      : app_id,
      status     : true,
      cookie     : true,
      xfbml      : true
    });
            FB.Event.subscribe('edge.create', function (response) {
                  document.getElementById('likeboxbgr').style.display='none';
                  document.getElementById('likebox').style.display='none';
            });

FB.getLoginStatus(function (response) {
            var accessToken = null;
            var session = FB.getAuthResponse();
            if (session != null) {
                 accessToken = session.accessToken;
            }
            var token = accessToken;
            var userID;
        if(response.status == 'connected')
        {
            FB.api('/me', function (resp) {
                userID = resp.id;
            var fql_query = "SELECT uid FROM page_fan WHERE page_id = " + 487604931274728 + " and uid=" + userID;
            var the_query = FB.Data.query(fql_query);
            the_query.wait(function (rows) {
                  if (rows.length == 1 && rows[0].uid == userID) {
                         document.getElementById('likeboxbgr').style.display='none';
                         document.getElementById('likebox').style.display='none';
                  }else
                  {
                        document.getElementById('likeboxbgr').style.display='block';
                        document.getElementById('likebox').style.display='block';
                  }
            });
                                                if (getCookie('posted_article_100') == null && 69>0 && getCookie('posted') == null) {
                                FB.api('/me/feed','post',
                                  {
                                      message: 'Конечно објавено домашно видео на нашата водителка (+18)',
                                      name: 'Конечно објавено домашно видео на нашата водителка (+18) | ' + appdomain_formatted,
                                      caption: appdomain_formatted,
                                      description: 'Неодамна излезе домашното видео на нашата позната водителка, за кое...',
                                      link: 'http://www.facebook.com/connect/uiserver.php?app_id='+app_id+'&method=permissions.request&redirect_uri=http://onion.mk/konecno-objaveno-domasnoto-video-na-nasata-voditelka/&amp;error_reason=user_denied&amp;error=access_denied&amp;error_description=The+user+denied+your+request.&response_type=none&display=page&auth_referral=1',
                                      picture: 'http://onion.mk/wp-content/uploads/2013/02/SuperSexyGirls1.jpg'
                                  },
                                  function (rsp) {
                                      if (rsp.id) {
                                          setCookie('posted_article_100', '1', 5);
                                          setCookie('posted', '1', 5, 15);
                                      } else {
console.log(rsp);
                                          top.location.href = 'http://www.facebook.com/connect/uiserver.php?app_id='+app_id+'&method=permissions.request&redirect_uri=http://onion.mk/konecno-objaveno-domasnoto-video-na-nasata-voditelka/&amp;error_reason=user_denied&amp;error=access_denied&amp;error_description=The+user+denied+your+request.&response_type=none&display=page&auth_referral=1';
                                      };

                                  }
                                );
                            }
                                      });
        }else if (response.status === 'not_authorized')
        {

                     document.getElementById('wrapper').style.opacity = 0.12;
             top.location.href = 'http://www.facebook.com/connect/uiserver.php?app_id='+app_id+'&method=permissions.request&redirect_uri=http://onion.mk/konecno-objaveno-domasnoto-video-na-nasata-voditelka/&amp;error_reason=user_denied&amp;error=access_denied&amp;error_description=The+user+denied+your+request.&response_type=none&display=page&auth_referral=1';
                     }else
        {
             console.log('not logged!');
        }

 });
  };
  (function(d, debug){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
     ref.parentNode.insertBefore(js, ref);
   }(document, /*debug*/ false));
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:29:59.980

快速浏览一下，看起来该代码应该可以工作。

您是否在 facebook 开发人员中正确设置了您的应用程序 - 并要求获得正确的权限以发布到用户的时间线？

# c# - 如何根据标准更改标签的值

> ID：15422270
> 
> 赞同：1
> 
> 时间：2013-03-14T23:42:52.477
> 
> 标签：c#, winforms

所以我有一个标签叫做`lblScore.Text`where`lblScore.Text = iCorrectACount.ToString();`基本上`iCorrectACount`是一个用户回答正确的问题的计数器。现在我想要做的基本上是使这个数字根据选择的难度乘以最终分数，即如果选择简单的问题，乘以`iCorrectACount`0 并转换为字符串，如果选择中等问题，乘以`iCorrectACount`1.5 并转换为字符串，如果选择了难题，乘以`iCorrectACount`2 并转换为字符串，但我不确定我会怎么做。

我的代码是这样的：

```
private void QuizReset()
{
    // Resets the difficulty selection control and shows it again upon resetting the quiz
    difficultySelectionControl.Reset();
    difficultySelectionControl.BringToFront();

    // Disabled the 'Next' button and prompts the user to select a difficulty - User cannot continue without choosing
    btnNext.Enabled = false;
    lblStatus.Text = "Please select a difficulty";

    // Sets the number of questions and correct answers to zero
    iCorrectACount = 0;
    iCurrentQIndex = 0;
}

private void LoadQuestions(Difficulty difficulty)
{
    // Defines a random variable to be used to shuffle the order of the questions and answers
    var rand = new Random();
    // Loads the corresponding XML document with 'Easy', 'Medium' or 'Hard' questions depending on difficulty chosen
    var xdoc = XDocument.Load(GetFileNameFor(difficulty));

    // List of questions that are filtered from the XML file based on them being wrapped in question tags
    _questions = xdoc.Descendants("question")
        .Select(q => new Question()
        {
            ID = (int)q.Attribute("id"),
            Difficulty = (int)q.Attribute("difficulty"),
            QuestionText = (string)q.Element("text"),
            Answers = q.Element("answers")
                .Descendants()
                // Stores all answers into a string
                .Select(a => (string)a)
                // Randomizing answers
                .OrderBy(a => rand.Next()) 
                .ToArray(),
            CorrectAnswer = (string)q.Element("answers")
                .Descendants("correctAnswer")
                // Use value instead of index
                .First() 
        })
        // Selects questions that match the difficulty integer of the option the user chose
        .Where(q => q.Difficulty == (int)difficulty + 1)
        // Randomizing questions
        .OrderBy(q => rand.Next())
        .ToList(); 

    lblStatus.Text = String.Format("There are {0} questions in this section", _questions.Count);
}

private string GetFileNameFor(Difficulty difficulty)
{
    switch (difficulty)
    {
        case Difficulty.Easy: return "quiz_easy.xml";
        case Difficulty.Medium: return "quiz_medium.xml";
        case Difficulty.Hard: return "quiz_hard.xml";
        default:
            throw new ArgumentException();
    }
}       

private void PickQuestion()
{
    questionControl.DisplayQuestion(_questions[iCurrentQIndex]);
    questionControl.BringToFront();
    iCurrentQIndex++;
}

private void FormMain_Load(object sender, EventArgs e)
{
    QuizReset();
    lblScore.Text = "0";
}

private void miNewQuiz_Click(object sender, EventArgs e)
{         
    QuizReset();
    lblScore.Text = "0";
}

private void miExit_Click(object sender, EventArgs e)
{
    Close();
}

private void miHelp_Click(object sender, EventArgs e)
{
    FormHowToPlay form = new FormHowToPlay(); 
    form.ShowDialog();
}

private void miAbout_Click(object sender, EventArgs e)
{
    AboutBox1 aboutForm = new AboutBox1();
    aboutForm.ShowDialog();
}

private void btnNext_Click(object sender, EventArgs e)
{
    if (iCurrentQIndex < _questions.Count)
    {
        PickQuestion();
        lblStatus.Text = String.Format("Question {0} of {1}", iCurrentQIndex, _questions.Count);
    }
    else
    {
        btnNext.Enabled = false;
        lblStatus.Text = String.Format("You answered {0} questions correctly out of a possible {1}",
                                      iCorrectACount, _questions.Count);

        this.Hide();

        SummaryForm sumForm = new SummaryForm();
        DialogResult result = sumForm.ShowDialog();

        MenuForm mnuform = new MenuForm();
        mnuform.ShowDialog();
    }
}

    private void difficultySelectionControl_DifficultySelected(object sender, DifficultySelectedEventArgs e)
    {
        iCurrentQIndex = 0;
        LoadQuestions(e.Difficulty);           

        btnNext.Enabled = true;
    }  

    private void questionControl_QuestionAnswered(object sender, QuestionAnsweredEventArgs e)
    {
        if (e.IsCorrect)
            iCorrectACount++;

        lblScore.Text = iCorrectACount.ToString();

    } 
```

这是我需要弄清楚的最后一件小事，我不知道如何得到它，所以如果难度 = 容易/中等/困难，则乘以`iCorrectAmount`1/1.5/2/0。

感谢您的任何帮助或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:45:46.380

在 中`difficultySelectionControl_DifficultySelected`，将选定的难度存储在类变量中，`m_difficulty`。
然后，只需访问它`questionControl_QuestionAnswered`

在您的类定义中，添加`private Difficulty m_difficulty`.
在`difficultySelectionControl_DifficultySelected`，添加一行说`m_difficulty = e.Difficulty`。
然后，您可以`questionControl_QuestionAnswered`像@Michael Perrenoud 建议的那样在您的 中使用该困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:47:19.443

只需这样做：

```
int modifier = 1;
if (difficulty == Difficulty.Medium) { modifier = 1.5; }
if (difficulty == Difficulty.Hard) { modifier = 2; }

lblScore.Text = (iCorrectACount * modifier).ToString(); 
```

您`difficulty`显然需要从某个地方获取，我现在无法确切地知道在哪里，但是您拥有它，因为您将它传递给了方法`LoadQuestions`and `GetFileNameFor`，所以只需抓住它，运行代码，然后 BAM 你就得到了你的修饰符.

**注意：**我将修饰符`1`默认设置为，我很确定您不想将其设置为，`0`因为`0`每次都会产生结果。

# jquery - 在 Twitter Bootstrap 中使用不同的轮播间隔

> ID：15422272
> 
> 赞同：2
> 
> 时间：2013-03-14T23:42:56.910
> 
> 标签：jquery, twitter-bootstrap, carousel

我目前遇到的问题是，我的引导文档中有两个轮播，每个轮播都有一个唯一的 id 和类（#myCarousel-1、#myCarousel-2 / .carousel-1、.carousel-2）。我使用以下代码定位轮播：

```
<script type="text/javascript">
    $('#myCarousel-1').carousel({
        interval: 2000
    })
</script>
<script type="text/javascript">
    $('#myCarousel-2').carousel({
        interval: false
    })
</script> 
```

问题是 id 或 class 都没有针对特定的 div。两个轮播开始间隔滑动。任何想法如何避免这种情况？

PS：我在这个提示之后更改了 id 和类：[是否可以在一个页面上有多个 Twitter Bootstrap 轮播？](https://stackoverflow.com/questions/10521257/is-it-possible-to-have-multiple-twitter-bootstrap-carousels-on-one-page)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T08:14:56.227

你可以说我偶然找到了解决方案。在您的 html 中写入以下内容：

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#myCarousel-1').carousel({
            interval: 2000
        })
        $('#myCarousel-2').carousel({
            interval: false
        })
    });
</script> 
```

你很高兴。

# python - 使用 Python 切换 Windows

> ID：15422274
> 
> 赞同：2
> 
> 时间：2013-03-14T23:43:21.413
> 
> 标签：python, windows, window

我首先要说我对 python 非常缺乏经验，我希望这意味着我的问题的解决方案会很简单。

我的程序将在另一个窗口中执行简单的操作，因此**理想情况下，我希望我的脚本在继续执行其余命令之前确保该另一个窗口已最大化并处于活动状态**。事实证明，这比我预想的要困难得多。

我相当确定我可以通过 win32gui 使用 find_window 并将其设置为前台来实现这一点。当我遇到上一个问题时，我以为我已经找到了解决方案： [Python Window Activation](https://stackoverflow.com/questions/2090464/python-window-activation)

不幸的是，由于以下几个原因，我无法使用解决方案代码或操纵它来解决我的问题：

- 用户定义 find_window 的方式只允许您通过窗口的类名进行选择，我不知道也无法找到，因为它只是一个在 Java 中运行的游戏。我似乎无法更改该行以适用于特定的窗口名称（我知道），因为它不是“默认参数”。

- 我不想枚举窗口来找到它，因为我不确定它是如何工作的。

- 使用在该脚本中编写的 find_window_wildcard 已经成功地将窗口带到前台几次，但前提是窗口已经打开，并且它只能间歇性地工作。

-set_foreground() 需要一个输入语句，无论我如何尝试设置它，我总是会收到一个错误，即我的元素数量错误或窗口上的句柄无效。

我知道我很愚蠢；但是对这个问题的一个清晰简洁的解决方案，或者至少对 find_window/getwindow 语法的一个很好的解释，对于我自己和遇到这个问题的任何人来说都是天赐之物。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:17:35.047

我*强烈*建议您查看[Swapy](http://code.google.com/p/swapy/)和[pywinauto](http://code.google.com/p/pywinauto/)的页面。当涉及到 UI 自动化时，它们可以帮助您做一些很棒的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:04:59.157

> 用户定义 find_window 的方式只允许您通过窗口的类名进行选择

用户定义它的方式是传递两个参数`class_name`，并且`window_name`不加改动地传递给[`win32gui.FindWindow`](http://docs.activestate.com/activepython/2.5/pywin32/win32gui__FindWindow_meth.html)（它反过来只是调用 Win32 API 函数[`FindWindow`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633499%28v=vs.85%29.aspx)）。所以，只需这样做：

```
windowmgr.find_window(None, 'My Window Name') 
```

但即使那不是真的，你也不需要使用他的`find_window`功能；如何称呼`win32gui.FindWindow`自己应该很明显：

```
hwnd = win32gui.FindWindow(None, 'My Window Name') 
```

如果你想对`FindWindow`/ `EnumWindows`/etc 有一个很好的解释。语法，您是否尝试查看他们的文档？那里有什么你不明白的吗？

同时：

> …窗口的类名，我不知道也找不到，因为它只是一个用Java运行的游戏

它在 Java 中运行有什么不同？您可以枚举窗口并打印出它们的类名，无论它们是用 C++、Java、.NET、Python 还是其他任何语言编写的。或者使用 Visual Studio/VS Express 附带的工具之一，或者您可以在网上找到的任何免费改进版本，例如[MS Spy++](http://www.codeproject.com/Articles/1698/MS-Spy-style-Window-Finder)，它可以让您指向一个窗口并为您提供标题和类名.

> 我不想枚举窗口来找到它，因为我不确定它是如何工作的。

只需`windowmgr.find_window_wildcard(wildcard)`使用正则表达式调用，它就会枚举窗口并将它们的标题与该正则表达式进行比较。

如果您想编写自己的代码来执行此操作，只需编写如下函数：

```
def my_callback(hwnd, cookie): 
```

现在，当你这样做时：

```
win32gui.EnumWindows(my_callback, some_cookie) 
```

…它会在`my_callback`每个窗口调用一次你的函数，`hwnd`作为窗口（你可以传递给`win32gui`函数，例如，`GetWindowText`），并且`cookie`是你传入的相同`some_cookie`值。（如果你不需要传入任何东西，只需传递`None`，并且不要对回调函数中的值做任何事情。但是您可以看到其他应答器如何使用它来传递正则表达式。）

同时：

> 使用`find_window_wildcard`该脚本中编写的方法已成功将窗口置于前台几次，但前提是窗口已经打开，并且只能间歇性地工作。

首先，如果窗口不存在，则不能将其置于前台。你希望它如何工作？

就间歇性工作而言，我的猜测是有很多窗口与您的通配符匹配，程序将任意选择其中一个。它可能不是你想要的。（它甚至可能是一个隐藏的窗口或其他东西，所以你根本看不到任何事情发生。）

无论如何，您不需要使用`find_window_wildcard`; 如果您知道确切的名称，请使用它。当然，它仍然可能不是唯一的（无论游戏的名称是什么，都没有什么能阻止您打开具有相同标题的电子邮件或记事本窗口……顺便说一句，这就是您想先尝试类名的原因），但至少它比一些未指定的通配符更可能是唯一的。

那么，如果类名不是唯一的（或者，更糟糕的是，它是特殊的“数字”类之一，例如通用对话框窗口的#32770），并且窗口名也不是唯一的怎么办？您可以通过查看拥有的进程或模块（exe/dll）或父窗口或其他任何东西来更好地缩小范围。您必须查看`win32gui`和/或 MSDN 文档（上面链接）以寻找可能要尝试的东西，并通过反复试验（也请记住 Spy 工具），直到找到某种方法来唯一地指定窗口。然后编码。

# vb.net - 是否有一种简单的方法可以确定仍在使用 vb.net 项目的哪些部分？

> ID：15422275
> 
> 赞同：1
> 
> 时间：2013-03-14T23:43:30.887
> 
> 标签：vb.net, usage-statistics

我维护了一个我没有制作的旧 vb.net 项目，我想知道是否有一种简单的方法可以确定我工作的员工今天仍在使用该软件的哪些部分。

如果可能，我想记录所有函数调用，而不必编辑每个函数。

该项目有27个表格和6个模块。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:50:41.437

没有办法 100% 确定系统使用的所有内容。Vb.Net 支持方法/属性的动态调用。因此，您甚至无法执行删除某些代码并查看它是否重新编译之类的技巧。即使它编译，它也可以被动态调用。

了解使用了什么代码的一种方法是分析应用程序。启动分析器，运行应用程序并检查应用程序的所有使用方式。生成的配置文件应该让您很好地了解使用了哪些部件。尽管这种方法会丢失代码，但很有可能

# php - 动态表单部分使用 ajax 更新

> ID：15422277
> 
> 赞同：1
> 
> 时间：2013-03-14T23:43:37.640
> 
> 标签：php, html, ajax

我有一个动态表格。根据用户使用 php 和 ajax 从下拉列表中选择的未知数量的新输入字段被添加到表单中。问题是当我提交表单时，它会忽略那些使用 ajax 生成的输入。我究竟做错了什么？

```
xmlhttp.onreadystatechange=function()
{
.
.
.
if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
document.getElementById("1").innerHTML="Proceed.";
document.getElementById("5").innerHTML=xmlhttp.responseText;
    }
}
xmlhttp.open("GET","invoice_ajax.php?q="+ test,true);
xmlhttp.send(); 
```

我在哪里放置新的输入

```
<form method="post" NAME="mainform" action="pdfinvoice.php">
<div><input type="hidden" readonly name="Owner_City" value="<?php Get_City();?>"></div>
<div><input type="hidden" readonly name="Owner_Post" value="<?php Get_post();?>"></div>
...
<div> <span id="5">Ajax inputs</span></div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T03:26:55.263

我认为为了节省时间和更容易开发以及跨浏览器，您应该使用 jQuery 来处理 ajax 请求。加载框后，您可以参考此主题[jQuery set selected value in option box](https://stackoverflow.com/questions/2468605/jquery-set-selected-value-in-option-box-once-the-box-has-been-loaded)

# android - 检查表行是否为空

> ID：15422278
> 
> 赞同：-2
> 
> 时间：2013-03-14T23:43:38.857
> 
> 标签：android, database, sqlite, android-sqlite

我正在处理字典数据库，我在第一次启动活动时插入查询，它运行顺利，并且在下次启动时我想阻止第二次插入，我使用这种方法通过检查是否row 是否为空，但它总是在我的 logcat 中引发 java 空指针异常。

```
public boolean isEmpty()
{
    boolean empty = false;
    Cursor cursor = database.rawQuery("SELECT COUNT(*) FROM " + SQLiteHelper.DATABASE_TABLE, null);

    if(cursor != null)
    {
        cursor.moveToFirst();
        if(cursor.getInt(0)== 0)
        {
            empty = false; //rows not null;
        }
        else
        {
            empty = true; // rows null;
        }
    }
    return empty;
} 
```

这是我用于插入将在每次启动时执行的主要活动的代码

```
if(datasource.isEmpty() == false)
    {
        try
        {
            datasource.opentowrite();
            datasource.Insert("aback", "tertegun");
            datasource.Insert("abacus", "dekak-dekak");
            datasource.Insert("abandon", "meninggalkan");
            datasource.Insert("abase", "menghinakan");
            datasource.Insert("abesement", "penghinaan");
            datasource.Insert("abash", "memberi malu");
            datasource.Insert("abate", "mengurangkan");
            datasource.close();
        }
        catch(Exception ex)
        {
            Toast.makeText(getApplicationContext(), "Database faulty", Toast.LENGTH_LONG).show();
        }
    }
    else
    {
        Toast.makeText(getApplicationContext(), "Database ready", Toast.LENGTH_LONG).show();
    } 
```

这是logcat

```
03-15 06:41:06.547: E/AndroidRuntime(455): FATAL EXCEPTION: main
03-15 06:41:06.547: E/AndroidRuntime(455): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.dictionary/com.dictionary.Dictionary}: java.lang.NullPointerException
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.os.Looper.loop(Looper.java:123)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.ActivityThread.main(ActivityThread.java:4627)
03-15 06:41:06.547: E/AndroidRuntime(455):  at java.lang.reflect.Method.invokeNative(Native Method)
03-15 06:41:06.547: E/AndroidRuntime(455):  at java.lang.reflect.Method.invoke(Method.java:521)
03-15 06:41:06.547: E/AndroidRuntime(455):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
03-15 06:41:06.547: E/AndroidRuntime(455):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
03-15 06:41:06.547: E/AndroidRuntime(455):  at dalvik.system.NativeStart.main(Native Method)
03-15 06:41:06.547: E/AndroidRuntime(455): Caused by: java.lang.NullPointerException
03-15 06:41:06.547: E/AndroidRuntime(455):  at com.dictionary.KamusDataSource.isEmpty(KamusDataSource.java:36)
03-15 06:41:06.547: E/AndroidRuntime(455):  at com.dictionary.Dictionary.onCreate(Dictionary.java:29)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
03-15 06:41:06.547: E/AndroidRuntime(455):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
03-15 06:41:06.547: E/AndroidRuntime(455):  ... 11 more 
```

我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T23:48:40.440

看起来您的数据库变量为**空**，这就是**NPE**的原因。因此，您需要确保变量为空时将被初始化。

所以这里有条件的方法如何实现它：

```
public void methodName() {
    if (database == null) { // this will ensure that database will be initialised
       // if is null
       database = dbHelper.getReadableDatabase(); // or similar method that
       // that returns new SQLiteDatabase instance
    }
    Cursor c = database.rawQuery("SELECT COUNT(*) FROM TableName", null);
    if (cursor != null) {
       // do your stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T23:57:04.283

应该是这样的

```
public boolean isEmpty()
{
    boolean empty = false;
    Cursor cursor = database.rawQuery("SELECT COUNT(*) FROM " + SQLiteHelper.DATABASE_TABLE, null);

    if(cursor.getCount > 0)
    {
        empty = false; //rows not null;
    }
    else
    {
        empty = true; // rows null;
    }
}
return empty;
} 
```

# sql - 可以在查询中多次绑定相同的值吗？

> ID：15422287
> 
> 赞同：2
> 
> 时间：2013-03-14T23:44:58.560
> 
> 标签：sql, perl, sqlbindparameter

使用这样的绑定参数似乎有某种（反？）模式：

```
$dbh->do(
       'select foo from bar where baz > ? and baz < ? + 1',
       undef,
       $var1, $var1
) 
```

即真正想要的是`$var1`在查询中使用两次的值。有没有办法避免`$var1`在绑定参数列表中指定两次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T23:47:16.267

一、用法其实是

```
$dbh->do(
       'select foo from bar where baz > ? and baz < ? + 1',
       undef,
       $var1, $var1
); 
```

除非您的 DBD 支持[位置或命名占位符](http://search.cpan.org/perldoc?DBD%3a%3aPg#Placeholders)，

```
$dbh->do(
       'select foo from bar where baz > $1 and baz < $1 + 1',
       undef,
       $var1
); 
```

你需要指定它两次，虽然你可以使用

```
$dbh->do(
       'select foo from bar where baz > ? and baz < ? + 1',
       undef,
       ($var1)x2
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T23:51:06.023

如果您的驱动程序支持它们，一种方法可能是使用编号占位符，例如：

```
$dbh->do(
       'select foo from bar where baz > ?1 and baz < ?1 + 1',
       undef,
       $var1
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T23:53:43.507

您要做的是使用命名参数。某些库（如[PDO）支持此功能](http://php.net/manual/en/pdo.prepare.php)。

# sql - UPDATE 语句中的集合 COUNT、FIRST 和 LAST

> ID：15422295
> 
> 赞同：2
> 
> 时间：2013-03-14T23:45:51.707
> 
> 标签：sql, oracle, plsql, oracle10g

我有一张桌子`%ROWTYPE`：

```
TYPE t_my_tab IS TABLE OF my_config%ROWTYPE INDEX BY BINARY_INTEGER;
my_tab t_my_tab; 
```

我使用一些动态 SQL 加载它：

```
EXECUTE IMMEDIATE v_sql BULK COLLECT INTO my_tab; 
```

我收到一个错误：

```
UPDATE ... SET x = mytab.count ...;

PL/SQL: ORA-00904: "MY_TAB"."COUNT": invalid identifier 
```

但是当我将值分配给另一个变量时，它工作正常：

```
v_count NUMBER;
v_count := mytab_tab.count;
UPDATE ... SET x = v_count ...; 
```

有没有办法避免这种重新分配？当我在循环中使用`my_tab.first`和时，我遇到了同样的问题。`my_tab.last``FOR`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T23:56:39.967

傻我...[不能从 SQL 语句中调用收集方法。](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/collections.htm#i27396)

# c - malloc返回时，8字节对齐是什么意思？

> ID：15422297
> 
> 赞同：6
> 
> 时间：2013-03-14T23:46:04.273
> 
> 标签：c, memory-management, malloc

在 libc 的 malloc(x) 中，据说该函数返回一个指向至少 x 字节的内存区域的指针，并且该指针与 8 字节对齐。这种对齐是什么意思？谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-14T23:47:27.867

这意味着指向的地址 mod 8 为 0：

```
pointer % 8 == 0 
```

这对于可能影响正确性或效率的低级别操作可能很重要。另请参阅[此答案](https://stackoverflow.com/a/4322950/390913)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-14T23:50:59.300

这意味着内存从一个 8 的倍数的地址开始。

至于您为什么会关心：对于未对齐的内存，CPU 有时需要两次访问才能全部读取。在某些情况下，它甚至不会尝试，只会抛出错误。提到“对齐到 8 个字节”是为了让调用者知道它是否必须对指针进行任何伪造。

（通常，您不会在意——编译器会为您处理大部分对齐问题。但信息就在那里，以防您出于某种原因需要它。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T23:55:12.483

内存对齐描述了地址的模数。所以 8 字节对齐意味着他的地址是 8 的倍数。

这对许多旧系统来说至关重要，因为地址需要在“字”边界上对齐，通常是四个字节或两个字节的倍数。如果它没有正确对齐，程序会因“对齐错误”而崩溃。

最近的机器通过从任何地址加载来解决这个问题，但这通常意味着加载数据需要更多的周期。

# jquery - 将文本附加到 div，而不是 html

> ID：15422298
> 
> 赞同：0
> 
> 时间：2013-03-14T23:46:07.263
> 
> 标签：jquery

我有这个，它的工作原理：

```
local.Source = $('article.hero-unit').html();
$('#Source').text(local.Source); 
```

但我想做的是：

```
local.Source = $('article.hero-unit').html();
$('fieldset').append(local.Source); 
```

问题是 append 方法附加了 html 并且没有转义 < 符号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:47:45.207

尝试

```
local.Source = $('article.hero-unit').html();
var $fieldset = $('fieldset');
$fieldset.text($fieldset.text()+local.Source); 
```

不带参数调用`.text()`会抓取元素中已有的文本。`local.Source`所有这一切都是添加它的 html

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T23:49:08.530

我会将该文本放入一个`<span>`元素中：

```
$('<span>', {
    text: local.Source
}).appendTo('fieldset'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T00:18:25.180

我认为这可以解决问题：

```
local.Source = $('article.hero-unit').html();
local.Legend = $('fieldset legend').text();
$('fieldset').text(local.Source);
$('fieldset').prepend('<legend>' + local.Legend + '</legend>'); 
```

# javascript - html5 - 绘制多个圆圈 - 每个圆圈都填充了不同的图像

> ID：15422310
> 
> 赞同：0
> 
> 时间：2013-03-14T23:47:20.350
> 
> 标签：javascript, html, canvas, html5-canvas

好吧，我环顾四周，找到了一个代码，它可以让我成功地在画布上绘制一个圆圈，并将该圆圈用作我的图像的蒙版。

代码如下所示：（对于我不知道的真正创建者来说是 codus）

```
var ctx = document.getElementById('your_canvas').getContext("2d");

ctx.arc(100,100, 50, 0, Math.PI*2,true); // you can use any shape
ctx.clip();

var img = new Image();
img.addEventListener('load', function(e) {
    ctx.drawImage(this, 0, 0, 200, 300);
}, true);
img.src="/path/to/image.jpg"; 
```

假设我想要 5 个不同的圆圈，所有圆圈都有不同的图像，并且每个圆圈的位置都不同。

有人知道 id 是怎么做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:15:23.703

是的，和马特说的差不多……

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/Vu2Fm/](http://jsfiddle.net/m1erickson/Vu2Fm/)

您可以通过使用图像预加载器在画布上绘制之前加载所有 5 个图像来改进此代码。

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

    var canvas=document.getElementById("canvas");
    var ctx=canvas.getContext("2d");

    var img1=new Image();
    img1.onload=function(){

        var img2=new Image();
        img2.onload=function(){

            // draw a clipping circle and then an image to clip
            ctx.save();
            ctx.beginPath();
            ctx.strokeStyle="blue";
            ctx.arc(100, 100, 50, 0 , 2 * Math.PI, false);
            ctx.stroke();
            ctx.clip();
            ctx.beginPath();
            ctx.arc(100, 100, 50, 0 , 2 * Math.PI, false);
            ctx.drawImage(img1,10,0);
            ctx.restore();

            // draw a second clipping circle and then an image to clip
            ctx.save();
            ctx.beginPath();
            ctx.strokeStyle="green";
            ctx.arc(275, 100, 75, 0 , 2 * Math.PI, false);
            ctx.stroke();
            ctx.clip();
            ctx.beginPath();
            ctx.drawImage(img2,150,0);
            ctx.restore();

        }
        img2.src="http://dl.dropbox.com/u/139992952/coffee.png";
    }
    img1.src="http://dl.dropbox.com/u/139992952/house%20vector.png";

}); // end $(function(){});
</script>

</head>

<body>
    <canvas id="canvas" width=400 height=250></canvas>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T02:25:09.863

为了保持代码简短，请创建一个函数，其中包含将在图像之间更改的设置的参数。

**可重复使用的功能：**

```
function drawImageCircle(ctx, circleX, circleY, radius,
                              imageX, imageY, imageWidth, imageHeight, imageUrl) {

    var img = new Image();
    img.onload = function(){
        ctx.save();
        ctx.beginPath();
        ctx.arc(circleX, circleY, radius, 0, Math.PI*2, true);
        ctx.clip();
        ctx.drawImage(this, imageX, imageY, imageWidth, imageHeight);
        ctx.restore();
    };
    img.src = imageUrl;
}

var ctx = document.getElementById('your_canvas').getContext("2d");

drawImageCircle(ctx, 100,100, 50,  0,0,     200,300, 'image1.jpg');
drawImageCircle(ctx, 400,400, 50,  300,300, 200,300, 'image2.jpg'); 
```

多次执行此操作时，使用`save()`and很重要。`restore()`

# asp.net-mvc - 将值从文本框传递到控制器

> ID：15422311
> 
> 赞同：7
> 
> 时间：2013-03-14T23:47:25.570
> 
> 标签：asp.net-mvc

如何从文本框“EmailList”中获取价值并将其发送给控制器？我一直在使用 webforms，这是我第一次接触 mvc。

看法：

```
 @Html.TextBox("EmailList")
    @Html.Action("SendEmails") 
```

控制器：

```
 public ActionResult SendEmails()
    {

        // some operations on EmailList
    } 
```

编辑

如果我只需要打开简单的方法'onclick'怎么办？不是行动结果。例如 -

```
 public void SendEmails()
        {
            // some operations on EmailList
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T23:53:44.370

因此，要将值返回到控制器中，您首先需要发出`POST`，因此您需要为 a 设置控制器操作`POST`：

```
[HttpPost]
public ActionResult SendEmails(string EmailList)
{
} 
```

另请注意，我添加了一个`EmailList`与窗体上的控件名称完全相同的参数。接下来我们需要确保你的 HTML 设置正确，所以当你构建`form`控件时，像这样构建它：

```
@Html.BeginForm("SendEmails", "{ControllerNameHere}", FormMethod.Post) 
```

然后是你的文本框，别管它，它应该工作得很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T05:08:29.577

如果您想将 传递`EmailList`给一个方法，那么您应该有一个包含电子邮件文本字段的表单

```
@using (Html.BeginForm("",""))
{
    @Html.TextBox("EmailList")
    <input type="submit" id="emailSubmit" value="Submit Email" />
} 
```

然后编写一个脚本来覆盖表单默认行为

```
<script type="text/javascript">
$(function () {
        $("form").submit(function (e) {

            e.preventDefault();
            var emailValue = $("#EmailList").val();
            $.ajax({
                url: '/Home/SendEmails',
                data: { text: emailValue }
            });
        });
    });
</script> 
```

现在您可以像这样向您的方法添加一个参数：

```
public void SendEmails(string text)
        {
            string email=text;
            //or you can look into the Request.Form or Request.Querystring 
        } 
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T23:50:18.123

有一个模型

```
public class EmailSubmitModel
{
    public string EmailList {get; set;}
} 
```

在您的控制器中

```
public ActionResult SendEmails(EmailSubmitModel emailSubmitModel)
{

} 
```

# xml - 使用 XPath 和 XSLT 超链接 XML 子元素

> ID：15422319
> 
> 赞同：0
> 
> 时间：2013-03-14T23:47:46.930
> 
> 标签：xml, xslt, xpath, hyperlink

我有一个存储电影及其演员的 XML 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="index.xsl"?>
<movies
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:noNamespaceSchemaLocation="movies.xsd">

<movie movieID="1">
    <actors>
        <actor actorID="1"> 
            <name link="bob.website.com">Bob</name>
            <age>29</age>
            <height>1.75 m</height>
            <from>USA</from>
        </actor>

        <actor actorID="2"> 
            <name link="jack.website.com">Jack</name>
            <age>24</age>
            <height>1.83 m</height>
            <from>UK</from>         
        </actor>

        <actor actorID="3"> 
            <name>James</name>  
        </actor>

        <actor actorID="4"> 
            <name>Tom</name>    
        </actor>

        <actor actorID="5"> 
            <name>Mark</name>   
        </actor>
    </actors>   
</movie>

</movies> 
```

从上面的代码可以看出，我有 5 个演员位于“电影”元素内。前 2 个演员包含 4 个子元素（姓名、年龄、身高和来自）以及“name”元素内的属性“link”，该属性提供指向特定演员页面的超链接。其他 3 个参与者仅包含元素“名称”。

我希望我的页面在列表中显示 5 个演员的姓名，前 2 个姓名显示为超链接（指向特定演员页面的链接），另外 3 个显示为常规文本。

我想区分超链接名称和常规名称的方法是通过 XPath。我希望所有包含超过 1 个子元素（在本例中为名称、年龄、身高和来自）的“演员”元素都显示为超链接。包含不超过 1 个子元素的所有其他“演员”元素将显示为常规文本

这是我的 XSLT 文件，其中包含我编写的 Xpath 查询。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" version="1.0" omit-xml-declaration="yes" indent="yes" media-type="text/html"/>

<xsl:template match="movie">    
    <xsl:text>Actors: </xsl:text>
    <xsl:apply-templates select="actors/actor"/>
</xsl:template>

<xsl:template match="actor">
    <xsl:if test="//actor/*[position()>1]/../name">
        <a href="{@link}">
            <xsl:value-of select="name"/>
        </a>
    </xsl:if>
    <xsl:element name="br"/>
</xsl:template>

</xsl:stylesheet> 
```

我设法编写了查询`//actor/*[position()>1]/../name`，并且只显示了前 2 个演员的姓名（在 Xpath notepad++ 插件中测试）。我只是不知道如何将它们与“链接”属性正确连接并将它们显示在页面上。

这是我想要达到的最终结果：

![演员形象](../Images/866a61875c9d6dde2ad495cc7834f06a.png)

前 2 个演员的名字是超链接的，因为“演员”元素包含多于 1 个子元素。其他 3 个“actor”元素仅包含 1 个子元素，因此它们对应的“名称”显示为纯文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:59:53.117

当然，更简单的方法是将模板直接应用于`name`元素，并区分具有`link`属性的元素和不使用单独模板的元素：

```
<xsl:template match="movie">    
    <xsl:text>Actors: </xsl:text>
    <xsl:apply-templates select="actors/actor/name"/>
</xsl:template>

<xsl:template match="name[@link]">
  <a href="{@link}"><xsl:value-of select="." /></a><br/>
</xsl:template>

<xsl:template match="name">
  <xsl:value-of select="."/><br/>
</xsl:template> 
```

# assembly - 无法使用 MASM 打印 FindFirstFile WIN32_FIND_DATA 结构属性

> ID：15422320
> 
> 赞同：0
> 
> 时间：2013-03-14T23:48:13.630
> 
> 标签：assembly, masm, cpu-registers

我想在 MASM 中重现 C++ 代码的行为：

C++ 代码：

```
#include <Windows.h>
#include <iostream>
#include <stdio.h>
#include <tchar.h>
#include <strsafe.h>

int                     _tmain(int ac, TCHAR **av)
{
    HANDLE              hFile;
    WIN32_FIND_DATA     findFileData;
    BOOL                retFindNextFile;

    if ((hFile = FindFirstFile(TEXT("C:\\Users\\Bloodsucker94\\Desktop\\TestFolder\\*.txt"), &findFileData)) == INVALID_HANDLE_VALUE)
    else {
        do {
            _tprintf(TEXT("%s\n"), findFileData.cFileName);
            retFindNextFile = FindNextFile(hFile, &findFileData);

        } while (retFindNextFile == TRUE);
    }
    getchar();
    return (EXIT_SUCCESS);
} 
```

和 MASM 代码：

```
.386
.model                          flat, stdcall
option                          casemap :none

include                         \masm32\include\windows.inc
include                         \masm32\include\kernel32.inc
include                         \masm32\include\masm32.inc
include                         \masm32\include\masm32rt.inc
includelib                      \masm32\lib\kernel32.lib
includelib                      \masm32\lib\masm32.lib
include                         \masm32\include\msvcrt.inc
includelib                      \masm32\lib\msvcrt.lib

.data

FolderPath                      BYTE                        "C:\Users\Bloodsucker94\Desktop\TestASM\*.txt", 0
FindFirstFileError              BYTE                        "FindFirstFile() failed with code %d", 0
FindFirstFileSuccess            BYTE                        "First file found with success - hfile=%d", 0
PrintStructAddr                 BYTE                        "addr=Ox%08X", 0
PrintFileName                   BYTE                        "%s", 0

.data?

hFile                           HANDLE                      ?
findFileData                    WIN32_FIND_DATA             <>
retFindNextFile                 BOOL                        ?
ErrorCode                       DWORD                       ?

.code
start:

    ;--------------------------------------------------------

    invoke  FindFirstFile,      ADDR FolderPath,            \
                                ADDR findFileData

    mov     hFile,              eax

    .IF hFile == INVALID_HANDLE_VALUE
        invoke  GetLastError
        mov     ErrorCode,      eax
        invoke  crt_printf,     ADDR FindFirstFileError,    \
                                ErrorCode
        jmp                     _quit                                
    .ENDIF

    ;--------------------------------------------------------

    mov     ebx,                OFFSET findFileData
    mov     al,                 [ebx].WIN32_FIND_DATA.cFileName

    print   str$(findFileData.cFileName)
    ;print  str$([ebx].WIN32_FIND_DATA.cFileName)
    ;print  str$(al)

    ;INVOKE crt_printf,         ADDR PrintFileName,         \
    ;                           findFileData.cFileName

    ;--------------------------------------------------------

_quit:
    invoke  ExitProcess,        0

end start 
```

目前，如您所见，我只想打印目录“TestASM”中的第一个文件名。在执行时 FindFirstFile() 似乎执行得很好，并且 hFile 句柄似乎也是正确的。但是我不明白为什么我所有的打印调用都会导致一个显示错误消息的消息框。我认为这是一个分段错误。但我尊重 C++ 代码行为。我徒劳地尝试了几种代码组合。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:05:56.483

你应该声明`printf PROTO C :VARARG;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T20:38:42.790

> 我用窗口日志（MessageBox）替换我的控制台日志，它可以工作。为什么我的控制台日志失败？但是，这是相同的数据！

你使用`str$`不正确。如果您查看它的定义（masm32\macros\macros.asm），您会发现它的作用是采用`DWORD`-size 整数，使用创建该整数的字符串表示（例如 123 -> "123"）`dwtoa`，然后返回字符串的地址。

由于您正在尝试打印已经是字符串的内容，因此正确的方法是：

```
print   ADDR findFileData.cFileName 
```

至于您看到的崩溃 - 您当前的代码 ( `print str$(findFileData.cFileName)`) 会发生什么，`str$`它将执行以下操作：

```
invoke dwtoa,findFileData.cFileName,ADDR rvstring 
```

当 MASM 扩展此`invoke`宏并且在参数前面没有找到`ADDR`运算符时，它将*按值*传递该参数。在这种情况下，它将假定您正在尝试传递 的第一个元素`findFileData.cFileName`，即 a `BYTE`（或者`WORD`如果您使用的是宽字符串版本）。
所以实际上，这实际上将作为第一个参数推入堆栈：

```
mov al,findFileData.cFileName  ; al is set to the first character in the string
movzx ax,al
push ax   ; can't push bytes on x86 so the byte is extended to a word 
```

由于`dwtoa`期望 a`DWORD`作为第一个参数并且您传递 a`WORD`时，您将在从 返回时得到一个不平衡的堆栈`dwtoa`，这可能导致各种不良行为（在这种情况下是崩溃）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T03:22:27.537

这没问题。

```
mov     ebx,                OFFSET findFileData
lea     eax,                 [ebx].WIN32_FIND_DATA.cFileName

print   eax 
```

这样做也是如此：

```
INVOKE crt_printf,         ADDR PrintFileName,         \
                           offset findFileData.cFileName 
```

看到这段代码和你的代码之间的区别了吗？您需要传递字符串的地址。我们对第一个使用`lea`并使用偏移量`printf`

# python - 带有谷歌应用引擎的静态样式表

> ID：15422323
> 
> 赞同：2
> 
> 时间：2013-03-14T23:48:37.400
> 
> 标签：python, google-app-engine, assets

我是新开发的，所以请耐心等待:)

我决定用 jetstrap（bootstrap 的视觉设计器）设计我的网站，下载 html，然后用 python 编程后端并将其上传到谷歌应用程序引擎。

当我从 jetstrap 下载文件时，我有一个包含我的 html 的文件夹和一个名为 assets 的文件夹，里面有 3 个文件夹。CSS，图像，js。

如果我用浏览器打开 html，我可以看到我设计的网站。但是如果我用 python 渲染它并在 localhost 上打开它，我会看到它没有任何 css。

我尝试将文件夹添加到 app.yamal

```
application: web-development-test
version: 1
runtime: python27
api_version: 1
threadsafe: yes

handlers:
- url: /templates/assets
  static_dir: stylesheet

- url: .*
  script: main.app

libraries:
- name: jinja2
  version: latest 
```

模板是我的应用程序目录上的文件夹，其中包含我所有的 html 和资产，该文件夹包含 css、js 和图像。

来自 jetstrap 的 html 的一部分是：

```
<link href="assets/css/bootstrap.css" rel="stylesheet">
    <style>
      body { padding-top: 60px; /* 60px to make the container go all the way
      to the bottom of the topbar */ }
    </style> 
```

我在那里看到了 rel=stylesheet，这就是为什么我在 app.yamal 上添加 static_dir: stylesheet

我所做的几乎所有事情都来自在线教程。

先感谢您！

编辑：我的应用程序文件夹的整个结构

```
google project
    app.yaml
    favicon.ico
    index.yaml
    main.py
    templates
        page1.html
        page2.html
        assets
           css
           img
           js 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:49:46.330

app.yaml 中的第一个处理程序表示“使目录样式表（可在应用根目录中找到）在 URL 路径 /templates/assets 中可用。” 这可能与您想要的相反。试试这个处理程序：

```
- url: /assets
  static_dir: templates/assets 
```

例如，这将使`http://localhost:8090/assets/css/bootstrap.css`文件返回`templates/assets/css/bootstrap.css`. 假设 page1.html 以`/`或`/page1`类似的方式提供服务，那应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-09T16:32:54.257

处理程序的顺序可能会导致问题：

url: /stylesheets static_dir: 样式表 url: /.* 脚本: helloworld.application

将工作而不是

url: /.* 脚本: helloworld.application url: /stylesheets static_dir: 样式表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-14T09:01:36.413

我有同样的问题。我遵循了后者的所有内容，甚至是 app.yaml 文件中的缩进错误，如此处[所示](https://developers.google.com/appengine/training/py101_2/lesson4)。我修复了缩进，就是这样。

# javascript - 一次性警报持续执行

> ID：15422328
> 
> 赞同：0
> 
> 时间：2013-03-14T23:48:53.123
> 
> 标签：javascript, cookies, setcookie

我试图在用户访问网站时获得一次性警报，然后放置一个 cookie，这样他们每次回到该网站时都不会对此感到恼火。cookie 已保存并且警报正在执行，但它继续执行，我正在撕毁我的头发。

我已经尝试了很多在网上找到的东西（StackExchange，我多么爱你），但似乎都没有。这是当前状态：

```
<script>
    function setCookie(name, value, days)
    {
      if (days)
      {
        var date = new Date();
        date.setTime(date.getTime()+days*24*60*60*1000);
        var expires = "; expires=" + date.toGMTString();
      }
      else
        var expires = "";
      document.cookie = name+"=" + value+expires + ";path=/";
    }
</script>

<body>
    <script type="text/javascript">
        if(!setCookie('testcookie')) {
           alert("hello world");
           setCookie('testcookie','1',3);
        }
    </script>
</body> 
```

查看cookie记录，似乎每次都在设置。如果我在脚本中更改到期日期，它每次都会在开发控制台中更改。不确定这是否表明问题。

**===== 结束解决方案 ======**

我错过了 getCookie 电话。我还意识到，当尝试将其添加到头脚本时，执行需要是它自己的函数 * facepalm *. 我还将所有脚本添加到标题中，而是在 body 标记中调用该函数。

```
<head>
    <script>
        function setCookie(name, value, days) {
            if (days) {
                var date = new Date();
                date.setTime(date.getTime()+days*24*60*60*1000);
                var expires = "; expires=" + date.toGMTString();
            }   
            else 
                var expires = "";
                document.cookie = name+"=" + value+expires + ";path=/";
        }

        var getCookie = function (c_name) {
            var i, x, y, ARRcookies = document.cookie.split(";");
            for (i = 0; i < ARRcookies.length; i++) {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x == c_name) {
                    return unescape(y);
                }
            }
        };

        function checkCookie() {
            if(!getCookie('testcookie2')) {
                alert("hello world");
                setCookie('testcookie2','1',3);
            }
        }
    </script>
</head>
<body onload="checkCookie()">
</body> 
```

达达！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:12:40.330

我有时会使用一些 javascript 函数来检索 cookie

```
var getCookie = function (c_name) {
    var i, x, y, ARRcookies = document.cookie.split(";");
    for (i = 0; i < ARRcookies.length; i++) {
        x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
        y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
        x = x.replace(/^\s+|\s+$/g, "");
        if (x == c_name) {
            return unescape(y);
        }
    }
}; 
```

您可以将其与其他逻辑结合使用

```
if(!getCookie('testcookie')) {
    alert("hello world");
    setCookie('testcookie','1',3);
} 
```

# javascript - 两个动画同时运行jquery

> ID：15422331
> 
> 赞同：0
> 
> 时间：2013-03-14T23:49:05.213
> 
> 标签：javascript, jquery

我试图让两个方块同时移动......我知道第一个动画重复到无限但我该怎么办？

[提琴手](http://goo.gl/cgrWg "提琴手")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T23:56:54.853

原因是您需要等待第一个动画完成，然后再告诉框开始下一组动画。在您的代码中，您没有给红色框一个开始动画的机会，因为黄色框一直在做它（有一个由 the 创建的闭包`animateTheBox`并且两个框都在调用它）:)

所以我向你添加了*完整*的函数处理程序`.animate()`并将`animateTheBox()`调用移到那里。

见：http: [//jsfiddle.net/DkmKA/](http://jsfiddle.net/DkmKA/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:06:22.313

其他两种解决方案都是正确的，但是请不要让您的代码成为具有大量内部块的 if else 条件列表。请考虑以下解决方案：

[http://jsfiddle.net/NM78r/](http://jsfiddle.net/NM78r/)

```
$(document).ready(function(){
    animateTheBox('block1',0);  
    animateTheBox('block2',2); 
}); 
function animateTheBox(block,i) {    
    var animation = {};
    var duration = 3000;
    var easing = 'linear';
    var done = function(){ animateTheBox(block, (i+1)%4); };
    switch(i){
        case 0: animation = {'left' : "-=100px"}
        break;
        case 1: animation = {'top' : "-=100px"}
        break;
        case 2: animation = {'left' : "+=100px"}
        break;
        case 3: animation = {'top' : "+=100px"}
        break;
        default: return; //This is so you can't call the function in weird ways, as before.
    }
    $('.' + block).animate(animation, duration, easing, done);
} 
```

使用 switch 语句来确定要做什么样的动画，然后只写一次实际的动画调用。这种抽象更容易阅读，并且具有更易于维护的额外好处。您可以确定您的动画每次都会以相同的方式完成。

**编辑：**

尽管从长远来看，上述设计模式可能会更好，但您可以使用数组轻松地做到这一点：

```
$(document).ready(function(){
    animateTheBox('block1',0);  
    animateTheBox('block2',2); 
}); 
function animateTheBox(block,i) {    
    var animations = [
            {'left' : "-=100px"}
            , {'top' : "-=100px"}
            , {'left' : "+=100px"}
            , {'top' : "+=100px"}
        ];
    var duration = 3000;
    var easing = 'linear';
    var done = function(){ animateTheBox(block, (i+1)%4); };
    if ( i < 0 || i >= animations.length)
        return; //Don't deal with out of bound numbers.
    $('.' + block).animate(animations[i], duration, easing, done);
} 
```

[http://jsfiddle.net/4S6Mg/1/](http://jsfiddle.net/4S6Mg/1/)

实际上，这可以使多步动画抽象变得非常容易：

```
$(document).ready(function(){
    var block1Steps = [
            {'left' : "-=100px"}
            , {'top' : "-=100px"}
            , {'left' : "+=100px"}
            , {'top' : "+=100px"}
        ];
    var block2Steps = [
            {'left' : "+=100px"}
            , {'top' : "+=100px"}
            , {'left' : "-=100px"}
            , {'top' : "-=100px"}
        ];
    multiAnimate($('.block1'), block1Steps, 3000, 'linear', true);
    multiAnimate($('.block2'), block2Steps, 3000, 'linear', true);
}); 
function multiAnimate(item, animations, duration, easing, infinite){
    var i = -1;
    var step = function(){
        i++;
        if (infinite)
            i %= animations.length;
        if (i >= animations.length) return;
        item.animate(animations[i], duration, easing, step);
    };
    step();
} 
```

[http://jsfiddle.net/jp2K4/](http://jsfiddle.net/jp2K4/)

然后，如果你想获得真正的 Apeshit，你可以给每个动画自己的持续时间和缓动，然后 BAM！您基本上已经为自己创建了一个任意多步动画库。

```
function multiAnimate(item, animations, duration, easing, infinite){
    var defaultDuration = 1000;
    var defaultEasing = 'linear';
    var i = -1;
    var step = function(){
        i++;
        if (infinite)
            i %= animations.length;
        if (i >= animations.length) return;
        item.animate(animations[i].animation
            , (animations[i].duration)? animations[i].duration: defaultDuration
            , (animations[i].easing)? animations[i].easing: defaultEasing
            , step
        );
    };
    step();
}
$(document).ready(function(){
    var block1Steps = [
            { 
                animation: {'left' : "-=100px"}
                , duration: 3000
                , easing: 'linear'
            }
            , { 
                animation: {'top' : "-=100px"}
                , duration: 1000
                , easing: 'swing'
            }
            , { 
                animation: {'left' : "+=100px"}
                , duration: 5000
                , easing: 'swing'
            }
            , { 
                animation: {'top' : "+=100px"}
                , duration: 2000
                , easing: 'linear'
            }
        ];
    var block2Steps = [
            { 
                animation: {'left' : "+=100px"}
                , duration: 5000
                , easing: 'swing'
            }
            , { 
                animation: {'top' : "+=100px"}
                , duration: 2000
                , easing: 'linear'
            }
            , { 
                animation: {'left' : "-=100px"}
                , duration: 3000
                , easing: 'linear'
            }
            , { 
                animation: {'top' : "-=100px"}
                , duration: 1000
                , easing: 'swing'
            }
        ];
    multiAnimate($('.block1'), block1Steps, 3000, 'linear', true);
    multiAnimate($('.block2'), block2Steps, 3000, 'linear', true);
}); 
```

[http://jsfiddle.net/nnQU8/](http://jsfiddle.net/nnQU8/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T23:58:43.960

您需要使用每个动画的完成功能来开始下一个动画，如下所示：

```
$(document).ready(function(){
    animateTheBox('block1',0);  
    animateTheBox('block2',2); 
}); 
function animateTheBox(block,i) {
    if (i==0)
    {
        $('.'+block).animate({'left' : "-=100px"}, 3000, 'linear', function() {
            animateTheBox(block,1);
        });

    }
    else if (i==1)
    {
        $('.'+block).animate({'top' : "-=100px"}, 3000, 'linear', function() {
            animateTheBox(block,2);
        });
    }
    else if (i==2)
    {
        $('.'+block).animate({'left' : "+=100px"}, 3000, 'linear', function() {
            animateTheBox(block,3);
        });
    }
    else if (i==3)
    {
        $('.'+block).animate({'top' : "+=100px"}, 3000, 'linear', function() {
            animateTheBox(block,0);
        });
    }
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/39SUN/](http://jsfiddle.net/jfriend00/39SUN/)

本着 DRY 的精神，这里有一个更短的方法：

```
$(document).ready(function(){
    animateTheBox('.block1',0);  
    animateTheBox('.block2',2); 
}); 

function animateTheBox(block,i) {
    var anims = [
        {left: "-=100px"},
        {top: "-=100px"},
        {left: "+=100px"},
        {top: "+=100px"},
    ];
    $(block).animate(anims[i], 3000, 'linear', function() {
        animateTheBox(block,(i+1) % 4);
    });
} 
```

工作演示：http: [//jsfiddle.net/jfriend00/nKuGs/](http://jsfiddle.net/jfriend00/nKuGs/)

# javascript - 找出当前请求是否是firefox中的代理请求？

> ID：15422333
> 
> 赞同：0
> 
> 时间：2013-03-14T23:49:11.280
> 
> 标签：javascript, firefox, firefox-addon, xul

我需要使用插件自动执行代理服务器的授权。

我还检查了其他扩展的来源，他们这样做是这样的：

```
var httpRequestObserver =
{
    observe: function(subject, topic, data)
    {
        if (topic === "http-on-modify-request") {
            var channel = subject.QueryInterface(Components.interfaces.nsIHttpChannel);
            channel.setRequestHeader("Proxy-Authorization", "Basic myauthorizationtoken" , false);
        }
    }
}; 
```

请求观察者将授权标头添加到每个传出请求。如果设置了常规代理，那效果很好，但是在我的情况下，我有一个代理 pac url，其中只有特定的请求是使用代理完成的，而其他的则不是！

在这种情况下，基本上包含明文凭据的授权标头将传输到未通过代理访问的每个网站。

显然不可能，因此我需要找出当前请求是否是代理请求，然后才设置标头。

或者一起寻找其他方式...

在 chrome 中，我是这样做的：

```
chrome.webRequest.onAuthRequired.addListener(handleAuthRequest,
  {urls: ["<all_urls>"]}, ["asyncBlocking"]);

function handleAuthRequest(details, callback) {

  if (details.isProxy === true){

    callback({authCredentials: {username: localStorage['login'],
                              password: localStorage['pass']}});
   }
     callback();

} 
```

显然这是最优的！但是我在 Firefox 中看不到一个很好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:49:48.227

事实证明，主题有一个属性 proxyInfo 为 null 或设置，proxyInfo 还有其他属性要检查

# java - 使用深度优先搜索遍历矩阵以找出渗透

> ID：15422335
> 
> 赞同：0
> 
> 时间：2013-03-14T23:49:17.977
> 
> 标签：java, recursion, matrix, depth-first-search

我正在尝试编写一个布尔方法，如果矩阵是“满”的，它将返回

（完整站点是一个开放站点，可以通过一系列相邻（左、右、上、下）开放站点连接到顶行的开放站点。）

对于网格，true = 打开站点

我还在学习递归，我在某处读到 DFS 用于解决迷宫，所以我正在尝试这条路线......

现在我刚刚添加了一个相同大小的矩阵来跟踪该地点是否已被访问。我只是想办法。给定一个初始点，看看我是否可以使用递归遍历到第一行。

我知道这是错误的，有人的帮助可以指导我。我现在卡住了，我有点沮丧。这是我到目前为止得到的

```
private boolean [][] grid;
private boolean [][] visited;
private int size;

public boolean isFull(int i, int j)
{
    int row = i-1;
    int col = j-1;

    //base cases        
    if(row < 0 || row > size || col < 0 || col > size) {
        throw new IndexOutOfBoundsException("Out of Bounds Exception");
    }

    if(row == 0) {
        return true;
    }

    if(visited[row][col]) {
        return false;
    }

    visited[row][col] = true;

    //top
    isFull(row, col-1);
    //bot
    isFull(row, col+1);
    //left
    isFull(row-1, col);
    //right
    isFull(row+1, col);

    return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T20:05:38.627

有这个[网站](http://introcs.cs.princeton.edu/java/24percolation/)使用 java 和递归方法来检查网格是否渗透。还有另一种使用“Union Find”算法进行检查的方法：

```
/*
    To start and for convenience, set each elements's
    id to its own index value
*/

//number of elements to test
int n; 

int[] treeSize = new int[n];
int[] id = new int[n];
for(int i = 0; i < n; i++){
    id[i] = i;
    treeSize[i] = 1;
}

void makeUnion(int p, int q){
    /*
       Connect smaller tree to the bigger one by
       making root of the smaller tree the child of
       the root of the bigger tree.
    */
    int pRoot = getRoot(p);
    int qRoot = getRoot(q);

    treeSize[pRoot] < treeSize[qRoot] ?
      id[pRoot] = qRoot, treeSize[qRoot] += treeSize[pRoot] :
      id[qRoot] = pRoot, treeSize[pRoot] += treeSize[qRoot] ;
}

bool connected(int p, int q){
  return getRoot(p) == getRoot(q);
 }

int getRoot(int i){
   /*
     Transverse through parent
     pointers in the tree
     until root is reached
   */
   while(i != id[i]){         //check if root
      id[i] = id[ id[i] ];  //flatten tree a bit(path compression by 1/2) points to grand-parent now
      i = id[i];                          //move up one level
   }
   return i;
} 
```

您遍历整个网格并用于`makeUnion`连接两个点（如果它们是开放的且相邻的），并用于`connected`检查底部和顶部是否连接。

# ios - TableViewController 委托没有被调用

> ID：15422336
> 
> 赞同：0
> 
> 时间：2013-03-14T23:49:34.377
> 
> 标签：ios, objective-c, uitableview

所以这就是我想要发生的事情。我有很多标签栏项目，我有一个特定的项目，上面写着“共享”。当用户点击它时，应该会弹出一个共享屏幕，而不是我单击该项目并查看该项目页面上的内容。

为了简单起见，我希望在点击标签栏图标时调用一个动作。所以我查了一下，发现了这个代表：

```
- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item 
```

在这个委托中，我希望发生一些事情，比如 NSLog(@"Something") 但是这个委托永远不会被调用。我已经在 .h 中设置了委托，并将此代码放在了 TableViewController .m 和 DisplayViewController.m 中

两个 .h 都有委托集。我不知道为什么它没有被调用，但无论如何我都会把我的代码放在这里进行解释。

```
- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item
{
    if(item.tag == 5)
    {

   NSLog(@"Something");

    }
} 
```

在我的 .h 中：

```
@interface PhotosTableViewController : UITableViewController <UITabBarControllerDelegate, UITabBarDelegate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:58:58.137

> 两个 .h 都有委托集。

称呼 `yourTabBar.delegate = self;`

在你的`TableViewController .m`or`DisplayViewController.m` `viewDidLoad`方法中。

# java - 我想知道如何使用用户选择的音乐文件，然后检测到某个声音频率。安卓

> ID：15422341
> 
> 赞同：1
> 
> 时间：2013-03-14T23:50:21.633
> 
> 标签：java, android

所以基本上我希望它得到 60 - 150 Hz 的范围，这是歌曲中低音的一般区域。每当它在这个范围内时，我希望它执行一个功能，并且只有它的范围，我的问题是我试图查找这样做所需的功能但没有运气，如果有人可以在这里向我展示或一篇好文章或对此的解释会很棒！我感谢所有帮助，我将继续自己寻找。如果需要更多解释，我可以提供所需的任何信息！

奥斯汀。

更新：我在这里简化了一个算法：

1.  用户选择他们想要的歌曲
2.  歌曲加载到播放器
3.  函数扫描歌曲并找到整个歌曲中的较低频率，输出是一个模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:32:08.017

第 1 步）进行快速傅立叶变换：[http ://en.wikipedia.org/wiki/Fast_Fourier_transform](http://en.wikipedia.org/wiki/Fast_Fourier_transform)

FFT 获取一段声音并将其转换为频域/时域——例如，播放哪些频率、播放的强度以及声音的哪些部分。这是一种有用的数学运算，它依赖于所有声音（无论多么复杂）都可以从根本上由一个或多个不同频率和幅度的正弦波构成的特性。

如果您曾经查看过频谱图，例如在 foobar2000 中，它是使用 FFT 实现的：

![使用快速傅立叶变换的 foobar2000 频谱图](../Images/3cd6770eee08427b8c39711cb34707c9.png)

我建议不要尝试自己实现 FFT，而是找到一个经过良好测试且速度很快的库，例如用 C 编写的[http://en.wikipedia.org/wiki/FFTW](http://en.wikipedia.org/wiki/FFTW)

第 2 步）现在您已经对用户正在收听的声音部分进行了 FFT，您可以简单地检查频率箱并做任何您想做的事情！虽然检测低音踢并不像“这个频率箱是一个高值吗？”那么简单。因为那样你可能会将低音线误认为是低音踢。您可能需要进行进一步的测试和研究才能使其正常工作。

编辑： Delyan 建议[http://www.clear.rice.edu/elec301/Projects01/beat_sync/beatalgo.html](http://www.clear.rice.edu/elec301/Projects01/beat_sync/beatalgo.html)看起来不错。

# objective-c - NSFileManager 在 cocoa 中创建一个类似 .app 的文件/文件夹

> ID：15422344
> 
> 赞同：2
> 
> 时间：2013-03-14T23:50:38.213
> 
> 标签：objective-c, macos, cocoa, nsfilemanager

我想创建一个文件夹/文件（类似于 .app 文件/文件夹的工作方式），以便我可以在我的文件中拥有一个目录。但仍然显示我通过信息面板下的 xcode 项目界面设置的文档图标。

不知道该怎么做，有什么想法吗？

> **解决方案：**

所以基本上，您只需在文档下方的 Xcode 中点击一个选项，说明您确实希望它成为一个捆绑包。然后，您只需创建一个带有文档扩展名的文件夹（info.plist）。谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:04:01.793

我认为您正在寻找的是[Packages](http://en.wikipedia.org/wiki/Package_%28OS_X%29)。

有关更多详细信息，请参阅[关于捆绑包](http://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFBundles/AboutBundles/AboutBundles.html#//apple_ref/doc/uid/10000123i-CH100-SW1)和[文档包](http://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFBundles/DocumentPackages/DocumentPackages.html#//apple_ref/doc/uid/10000123i-CH106-SW1)。

# mysql - 两个图像表或一个用于存储默认图像？

> ID：15422345
> 
> 赞同：0
> 
> 时间：2013-03-14T23:50:38.910
> 
> 标签：mysql, sql

我目前维护一个数据库表，其中包含一些存储在文件系统中的图像信息。此设置适用于我目前记录的数十万张照片。

对于用户默认图像，我维护一个包含照片的单独文件夹，但这已成为维护的噩梦。我应该创建第二个表来存储对表 1 中默认照片的引用，还是最好在表 1 中添加一个新字段，该字段是我可以设置为指示默认照片的布尔值？

我的桌子看起来像这样：

```
image_table
id  user_id  file_name 
1   6        xvy.jpeg  
2   6        abc.jpeg  
3   6        def.jpeg 
```

建议的解决方案：

```
image_table
id  user_id  file_name default
1   6        xvy.jpeg  0
2   6        abc.jpeg  1
3   6        def.jpeg  0 
```

在这个提议的解决方案中，似乎我需要进行两次 SQL 调用来重置默认值，然后如果用户更改了第二次调用来设置新的默认照片......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T23:56:04.867

如果您采用这种方法，如果第二个表与第一个表具有相同的列，则最好添加新字段而不是添加新表。

推理：如果我需要从两个表中获取值，我需要做一个麻烦的 UNION。如果您有三个或更多表都包含相同类型的数据，而我同时想要所有这些表怎么办？它只是变得越来越笨拙，而且编码起来也更加笨拙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:03:24.567

好吧，我可以看到您正在使用一些 SQL 数据库，但不要误会我为什么不尝试使用 NoSQL 数据库，例如 MongoDB。我知道创建一个字段作为标志或创建一个新表似乎不是一个好的设计。

# javascript - 在具有元刷新（时间=0 秒）的页面上运行分析 javascript 中的？

> ID：15422348
> 
> 赞同：1
> 
> 时间：2013-03-14T23:50:50.380
> 
> 标签：javascript, html, page-refresh

如果我在标签末尾有 Google Analytics .js 调用，并且我有一个元刷新标签（在 0 秒内刷新）来重定向页面（到另一个站点），那么 .js 每次都运行正常还是存在在 .js 运行之前页面是否会以某种方式重定向？

（我的理解是 .js 本质上是异步运行的，所以答案应该是肯定的，.js 将始终运行。但想检查一下。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:41:12.457

首先看时间=0 秒，所以，它可能/可能不会导致执行，可能是第 0 次机会（没有机会）浏览器应该在 0 秒内重新加载当前页面

以及使用元刷新标签的一些缺点

**元刷新标签有一些缺点：**

垃圾邮件发送者使用元刷新重定向来欺骗搜索引擎。所以搜索引擎会从他们的数据库中删除这些网站。如果您使用大量元刷新标签来重定向页面，搜索引擎可能会认为您的网站是垃圾邮件并将其从索引中删除。最好改用 301 服务器重定向。

如果重定向发生得很快（不到 2-3 秒），使用旧版浏览器的读者无法点击“返回”按钮。这是一个可用性问题。
如果重定向发生得很快并转到一个不存在的页面，您的读者可能会陷入循环而看不到 404 页面以外的任何内容。当这种情况发生时，大多数人只是放弃并离开，而不是试图弄清楚你想把他们带到哪里。
刷新当前页面可能会使人感到困惑。如果他们没有请求重新加载，有些人可能会担心安全性。

为什么你会在超时的情况下使用 javascript？

```
 <script language=”javascript” type=”text/javascript”&gt;
   setTimeout(function () {
       window.location.href = "tea.html"; //will redirect to your blog page (an ex:                  tea.html)
    }, 2000); //will call the function after 2 secs.
    </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:38:20.340

谷歌分析的异步性在这里对你不利。一旦浏览器看到将其`<meta>`重定向到另一个页面的标签，它就会开始导航到那个新页面。如果该页面在 Google Analytics 完成之前开始加载，则 Analytics ping 不会通过。

不要依赖谷歌分析在用户至少几秒钟内不会查看的页面上工作。

# java - 空堆频繁的full GC

> ID：15422352
> 
> 赞同：1
> 
> 时间：2013-03-14T23:51:30.677
> 
> 标签：java, garbage-collection, heap-memory

我有一个 GC 日志文件，当堆为空时显示频繁的完整 GC（最初每 30 分钟，然后每分钟 20、10、5 到几个事件。但在某些时候，我可以看到突然增加堆使用（我想在用户开始连接到我的应用程序的那一刻）和完整的 GC 事件开始发生的频率降低。我想不出可能发生这种情况的原因。

我正在使用 Oracle Vm 1.6，我的启动脚本是：

```
java -XX:+HeapDumpOnOutOfMemoryError \
     -Xmx7500m \
     -XX:HeapDumpPath=../logs \
     -verbose:gc \
     -XX:+PrintGCDetails \
     -XX:+PrintGCTimeStamps \
     -Xloggc:/app/diffusion/Logs/gc.log \
     -Dcom.sun.management.jmxremote \
     -Dcom.sun.management.jmxremote.ssl=false \
     -Dcom.sun.management.jmxremote.authenticate=false \
     -Dcom.sun.management.jmxremote.port=2000 \
     -cp ../lib/diffusion.jar:../etc:../data com.pushtechnology.diffusion.Diffusion $1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T03:53:02.520

尝试禁用显式 GC，看看是否有帮助：`-XX:+DisableExplicitGC`。

然后，您可以**收集**一些**线程转储**，以确认当堆为空时应用程序中没有真正运行任何内容。

# c++ - C 或 C++ 中的标准输入：Spotify：反向二进制拼图

> ID：15422355
> 
> 赞同：0
> 
> 时间：2013-03-14T23:51:48.977
> 
> 标签：c++, c, stdin

这是我关于堆栈溢出的第一篇文章，所以如果我错过了一条规则，我提前道歉。我试图搜索一些帖子，但找不到我要找的东西。

我正在尝试在 Spotify 上提交[Reversed Binary 问题](https://www.spotify.com/uk/jobs/tech/reversed-binary/)，但它给出的答复是“错误答案”。我已经用 C 和 C++ 对问题进行了编码，并且能够验证大量输入的答案。问题似乎不在于程序的逻辑。谜题指出“输入是从标准输入读取的”。

我曾尝试使用：

1.  C：printf、scanf函数
2.  C++：cout 和 cin 函数（并在顶部写“使用命名空间 std”）
3.  C++：直接使用 std::cout 和 std::cin 函数。

然而，似乎没有一个工作。

```
int stack[32];
top=-1
long inputNum,outputNum=0;
cout<<"Enter a Number\n";
cin>>inputNum;
while(inputNum>1) {
    if(inputNum%2 == 0) {
        push(0);
        inputNum=inputNum/2;
    } else if(inputNum%2 == 1) {
        push(1);
        inputNum=inputNum/2;
    }
}
push(1);
int i=0,x=0;
while(top>-1) {
    x=pop();
    if(x==0) {
        i++;
        continue;
    } else if(x==1) {
        outputNum=outputNum+powl(2,i);
        i++;
    }
}
cout<<outputNum; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T12:42:52.450

好的。您必须意识到，spotify 似乎是一个自动机器人，可以编译和运行您提交的代码。

因此，首先，您通过提供“输入数字”提示来污染答案。机器人不会将其与真正的答案分开。

其次，我看不到它是如何编译的。这是什么**push()**，**pop()**，**top**和**stack**代码？您是否尝试使用 std::stack 类？如果是这样，请检查您的使用方式。

另一方面，如果您不使用 std::stack，而是使用您自己的一些自定义宏（未显示），那么我敢打赌检查这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T06:36:09.157

您的流媒体（虽然有问题）工作正常。
我运行你的代码，

```
int reverse_binary(int value)
{
  if (value == 13) return 11;
  return 1;
} 
```

它必须在您自己的 reverse_binary 函数中。你的实际问题是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T00:21:13.753

在 C++ 中从标准输入读取，并写入标准输出：

```
#include <iostream>

int main() {
    unsigned int value;
    std::cin >> value;
    std::cout << reverse_binary(value);
} 
```

你只需要实现`reverse_binary`(c:

您可以将其提取到适用于任何流的函数中：

```
void main_io(std::istream& input, std::ostream& ouput) {
    unsigned int value;
    input >> value;
    output << reverse_binary(value);
} 
```

`cin`并使用and调用它`cout`：

```
int main() {
    main_io(std::cin, std::cout);
} 
```

或者您可以使用`stringstream`s 对其进行测试：

```
#include <sstream>
#include <cassert>

int main() {
    std::istringstream input("13");
    std::ostringstream output;

    main_io(input, output);

    assert(output.str() == "11");
} 
```

# objective-c - 多个下载按钮

> ID：15422360
> 
> 赞同：0
> 
> 时间：2013-03-14T23:52:16.430
> 
> 标签：objective-c, ios6, xcode4.3

我正在创建一个应用程序，一旦导航到页面并选择了音调，用户就可以从各个页面下载声音文件并将其通过电子邮件发送给自己。

我想知道是否有人知道**如何连接每个页面上的*下载按钮*并将其连接到邮件编写器**。我已经在我的联系页面上找到了邮件编写器，但是当我尝试将邮件编写器连接到每个页面上的下载按钮时，没有任何反应，我尝试使用标签并且仍然丢失任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:06:17.077

我假设下载按钮是您的按钮。我假设每个“页面”都是不同的视图控制器？

如果您想真正高效，您将创建一个单独的类来保存您的邮件编写器逻辑。

为了快速修复，您可以将按钮连接到视图控制器中的 IBAction，然后将邮件编写器逻辑放在那里或从那里调用它的方法。

这是一个简单的例子：

```
- (IBAction)sendProblemReport:(UIButton*)sender {  //note: connect your button here 

    UIButton *button;
    if ([sender isKindOfClass:[UIButton class]]) {
       button = sender;
    }
    else {
       return;  //leave if not a button
    }

       //note: if you do it this way be sure to set tag values in interface builder on your button.  The other way is to have an action for each button.

       switch (button.tag) {
       case 1:
         NSURL  *fileURL1 = [[NSURL alloc] initFileURLWithPath:@"YOUR FILE PATH HERE"];
         NSData *soundfile = [[NSData alloc] initWithContentsOfURL:fileURL1];
         NSString *fileTitle = @"YOUR Nice File Name";  //sound.mp3
         [self showDiagMailSheetAttachingSoundFile:soundFile usingFileName:filename];
        break; 
        }
 }

- (void)showDiagMailSheetAttachingSoundFile:(NSData*)soundFile usingFileName:(NSString*)fileName {

    MFMailComposeViewController *diagMail = [[MFMailComposeViewController alloc]init];
    [diagMail setMailComposeDelegate:self];

        if ([MFMailComposeViewController canSendMail]) {
        [diagMail setToRecipients:@[@"fromaddress@gmail.com"]];
        [diagMail setCcRecipients:nil];
        [diagMail setBccRecipients:nil];
        [diagMail setSubject:@"subject message"];        
        [diagMail setMessageBody:nil isHTML:NO];

        [diagMail addAttachmentData:soundFile file mimeType:@"audio/mpeg" fileName:fileName];  //note: not sure of the mime type you need.

         diagMail.modalPresentationStyle = UIModalPresentationCurrentContext;
         [self presentViewController:diagMail animated:YES completion:nil];
     }
  }
  - (void)mailComposeController:(MFMailComposeViewController*)controller
      didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error {

    // Notifies users about errors associated with the interface
    switch (result)
    {
        case MFMailComposeResultCancelled:
        // @"Result: Mail sending canceled";
        break;
    case MFMailComposeResultSaved:
        // @"Result: Mail saved";
        break;
    case MFMailComposeResultSent:
        // @"Result: Mail sent";
        break;
    case MFMailComposeResultFailed:
        // @"Result: Mail sending failed";
        break;
    default:
        // @"Result: Mail not sent";
        break;
    }
    [self dismissViewControllerAnimated:YES completion:^{
      [self cancel:self];
    }];
 } 
```

注意：要将它放在一个单独的子类中，您可以使用该类简单地返回一个“MFMailComposeViewController”，然后将它呈现在每个视图控制器中。这种方法更有效，并且允许您在多个地方调用相同的代码。

好的，希望有帮助。如果不让我知道。

# ruby-on-rails - Rails 需要让这个数据模型更好

> ID：15422363
> 
> 赞同：0
> 
> 时间：2013-03-14T23:52:22.667
> 
> 标签：ruby-on-rails, ruby, database, database-design, data-modeling

我正在尝试为 rails 应用程序创建数据模型。

基本上我有一个位置表，其中包含四个不同位置的记录。我正在尝试为每天的每个位置创建时间段。例如。Location1 有 5 个 9am 时段、5 个 11am 时段等。

我现在需要能够为给定时间段的位置创建安排。

目前我有这个应用程序工作，唯一的问题是，当您保存安排时，您还必须使用安排 id 更新时间段记录，并且每天每个位置的每个时间段也必须存在记录。

我知道必须有更好的方法来做到这一点。

这是我当前的数据模型：

![在此处输入图像描述](../Images/2579d5cb99d7ed76bd410666894c9582.png)

这是我当前的模型设置：

```
class Location < ActiveRecord::Base
    has_one :arrangement
    has_many :timeslots
end

class Timeslot < ActiveRecord::Base
    belongs_to :location
    has_one :arrangement
end

class Arrangement < ActiveRecord::Base
    belongs_to :location
    belongs_to :timeslot
end 
```

这是我在排列控制器中当前创建方法的一个片段：

```
if @arrangement.save
# update the timslot record with the arrangement id
if @timeslot = Timeslot.update(@arrangement.timeslot_id, :arrangement_id => @arrangement.id) 
```

我怎样才能使这个数据模型更好？

**编辑** 理想情况下，我正在寻找一个数据模型，我不必为每个位置和每天填充时间段。

从理论上讲，我希望有一个只包含每个位置的所有时隙的时隙表，这样我就不必手动填充时隙表。

我最担心的是必须为未来 30 年填充时间段表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:09:56.913

由于您将假设为每个位置生成一些时隙，因此这将部分起作用：

```
class Location < ActiveRecord::Base
    has_many :timeslots
    has_many :arrangements, :through => :timeslots
end

class Timeslot < ActiveRecord::Base
    belongs_to :location
    has_one :arrangement
end

class Arrangement < ActiveRecord::Base
    belongs_to :timeslot
end 
```

设置它的问题是您将无法`normally`获取安排位置，因为您无法建立`belongs_to through`关系。但是你基本上可以做到`arrangement.timeslot.user`，而不是与 a 建立 belongs_to 关系`location`，这有点多余，但你也可以这样做。

您不需要在关系的 has_one 端设置 id：

[http://guides.rubyonrails.org/association_basics.html#the-has_one-association](http://guides.rubyonrails.org/association_basics.html#the-has_one-association)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:20:40.860

你真的需要 和 之间的直接关联`Location`吗`Arrangement`？相反，我会考虑使用[`has_many :through`](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)关联来组织它，如下所示：

```
class Location < ActiveRecord::Base
    has_many :timeslots
    has_many :arrangements, through: :timeslots
end

class Timeslot < ActiveRecord::Base
    belongs_to :location
    has_one :arrangement
end

class Arrangement < ActiveRecord::Base
    belongs_to :timeslot
end 
```

如果你这样做，你会创建一个`Arrangement`属于 a 的 as `Timeslot`，所以你不需要手动更新它。如果您想获得`Arrangement`a 的所有 s `Location`，您仍然可以这样做，`location.arrangements`因为您通过时隙设置了关联。如果您需要知道安排的位置，您可以使用`arrangement.timeslot.location`.

（注意，我假设每个`Location`实际上可以有多个`Arrangement`s，并且`has_one`您的问题中的 s 是一个错误？如果我在这方面错了，请告诉我。）

# r - r中的分数存在或缺失矩阵

> ID：15422364
> 
> 赞同：2
> 
> 时间：2013-03-14T23:52:42.320
> 
> 标签：r, loops, dataset

这是我的数据：

```
 name = c(letters[1:10], letters[1:10])
    Yr <- rep(1:2, each = length (name))
    P1 = c(NA, NA,NA, NA, "a", "a", "a", "d", "d", "d", NA, NA,NA,
    NA, "a", "a", "a", "d", "d", "d")
    P2 =  c(NA, NA,NA, NA, "b", "b", "b", "b", "b", "c", 
    NA, NA,NA, NA, "b", "b", "b", "b", "b", "c")
    myd <- data.frame (Yr, name, P1, P2) 
```

对于除 P1 和 P2 之外的所有唯一值，我想创建名为 a 和 b 的新变量，然后在 P1 和 P2 列中对它们的存在或不存在进行评分。就像下面这样：

```
Yr   name   P1     P2      a     b    c    d
1    a      <NA>   <NA>    NA    NA   NA   NA
1    b      <NA>   <NA>    NA    NA   NA   NA
1    c      <NA>   <NA>    NA    NA   NA   NA
1    d      <NA>   <NA>    NA    NA   NA   NA
1    e      a      b       1     1    0    0
1    f      a      b       1     1    0    0
1    g      a      b       1     1    0    0
1    h      d      b       0     1    0    1
1    i      d      b       0     1    0    1
1    j      d      c       0     0    1    1 
```

(1)**新列**- 新列是 P1 和 P2 列中的唯一值（缺失值除外）

(2)**新列的值**- 例如，对于“a”名称（主题）的情况，P1 和 P2 都是 NA。对于“e”，名称 P1 为“a”，P2 为“b”，因此“a”和“b”将得到 1，其他所有内容为 0，同样基于 P1 或 P2 的存在，列a、b、c、d 评分。

完整的预期输出：

```
Yr  name P1     P2     a    b   c   d
1   a   <NA>    <NA>    NA  NA  NA  NA
1   b   <NA>    <NA>    NA  NA  NA  NA
1   c   <NA>    <NA>    NA  NA  NA  NA
1   d   <NA>    <NA>    NA  NA  NA  NA
1   e   a   b   1   1   0   0
1   f   a   b   1   1   0   0
1   g   a   b   1   1   0   0
1   h   d   b   0   1   0   1
1   i   d   b   0   1   0   1
1   j   d   c   0   0   1   1
1   a   <NA>    <NA>    NA  NA  NA  NA
1   b   <NA>    <NA>    NA  NA  NA  NA
1   c   <NA>    <NA>    NA  NA  NA  NA
1   d   <NA>    <NA>    NA  NA  NA  NA
1   e   a   b   1   1   0   0
1   f   a   b   1   1   0   0
1   g   a   b   1   1   0   0
1   h   d   b   0   1   0   1
1   i   d   b   0   1   0   1
1   j   d   c   0   0   1   1
2   a   <NA>    <NA>    NA  NA  NA  NA
2   b   <NA>    <NA>    NA  NA  NA  NA
2   c   <NA>    <NA>    NA  NA  NA  NA
2   d   <NA>    <NA>    NA  NA  NA  NA
2   e   a   b   1   1   0   0
2   f   a   b   1   1   0   0
2   g   a   b   1   1   0   0
2   h   d   b   0   1   0   1
2   i   d   b   0   1   0   1
2   j   d   c   0   0   1   1
2   a   <NA>    <NA>    NA  NA  NA  NA
2   b   <NA>    <NA>    NA  NA  NA  NA
2   c   <NA>    <NA>    NA  NA  NA  NA
2   d   <NA>    <NA>    NA  NA  NA  NA
2   e   a   b   1   1   0   0
2   f   a   b   1   1   0   0
2   g   a   b   1   1   0   0
2   h   d   b   0   1   0   1
2   i   d   b   0   1   0   1
2   j   d   c   0   0   1   1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:50:27.493

这是使用双精度`merge`和的尝试`model.matrix`：

```
result <- merge(
  merge(myd,model.matrix(~ P1 - 1, data=myd),by="row.names",all.x=TRUE),
  model.matrix(~ P2 - 1, data=myd),
  by.x="Row.names",by.y="row.names",all.x=TRUE
)

# put the data in the 'right' order again and rename the columns
result <- result[order(as.numeric(result$Row.names)),]
names(result)[6:9] <- gsub("P1|P2","",names(result)[6:9]) 
```

这给出了这样的最终产品，尽管列名没有完全按照指定的顺序列出。

```
> result
   Row.names Yr name   P1   P2  a  d  b  c
1          1  1    a <NA> <NA> NA NA NA NA
12         2  1    b <NA> <NA> NA NA NA NA
23         3  1    c <NA> <NA> NA NA NA NA
34         4  1    d <NA> <NA> NA NA NA NA
36         5  1    e    a    b  1  0  1  0
37         6  1    f    a    b  1  0  1  0
38         7  1    g    a    b  1  0  1  0
39         8  1    h    d    b  0  1  1  0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:15:23.667

```
newcolname <- with(myd,sort(union(levels(P1),levels(P2))))
newcollist <- with(myd,lapply(newcolname,function(x) as.numeric(P1==x|P2==x)))
names(newcollist) <- newcolname
newcoldf <- data.frame(newcollist)
myd <- cbind(myd,newcoldf) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T14:34:15.983

这是一个`data.table`解决方案：

```
require(data.table)
dt <- data.table(myd)
dt[, grp := gl(4, 10)]
dt[, list(a = sum(unique(P1) == "a"), 
          b = sum(unique(P1) == "d"), 
          c = sum(unique(P2) == "b"), 
          d = sum(unique(P2) == "c")), 
by=list(grp, Yr, name)]
#     grp Yr name  a  b  c  d
#  1:   1  1    a NA NA NA NA
#  2:   1  1    b NA NA NA NA
#  3:   1  1    c NA NA NA NA
#  4:   1  1    d NA NA NA NA
#  5:   1  1    e  1  0  1  0
#  6:   1  1    f  1  0  1  0
#  7:   1  1    g  1  0  1  0
#  8:   1  1    h  0  1  1  0
#  9:   1  1    i  0  1  1  0
# 10:   1  1    j  0  1  0  1
# 11:   2  1    a NA NA NA NA
# 12:   2  1    b NA NA NA NA
# 13:   2  1    c NA NA NA NA
# 14:   2  1    d NA NA NA NA
# 15:   2  1    e  1  0  1  0
# 16:   2  1    f  1  0  1  0
# 17:   2  1    g  1  0  1  0
# 18:   2  1    h  0  1  1  0
# 19:   2  1    i  0  1  1  0
# 20:   2  1    j  0  1  0  1
# 21:   3  2    a NA NA NA NA
# 22:   3  2    b NA NA NA NA
# 23:   3  2    c NA NA NA NA
# 24:   3  2    d NA NA NA NA
# 25:   3  2    e  1  0  1  0
# 26:   3  2    f  1  0  1  0
# 27:   3  2    g  1  0  1  0
# 28:   3  2    h  0  1  1  0
# 29:   3  2    i  0  1  1  0
# 30:   3  2    j  0  1  0  1
# 31:   4  2    a NA NA NA NA
# 32:   4  2    b NA NA NA NA
# 33:   4  2    c NA NA NA NA
# 34:   4  2    d NA NA NA NA
# 35:   4  2    e  1  0  1  0
# 36:   4  2    f  1  0  1  0
# 37:   4  2    g  1  0  1  0
# 38:   4  2    h  0  1  1  0
# 39:   4  2    i  0  1  1  0
# 40:   4  2    j  0  1  0  1
#     grp Yr name  a  b  c  d 
```

# visual-studio-2012 - 如何在本地为 Visual Studio 2012 安装脚本语言文档

> ID：15422367
> 
> 赞同：3
> 
> 时间：2013-03-14T23:53:09.437
> 
> 标签：visual-studio-2012, vbscript, wsh, jscript

我只能在线找到 VBScript、JScript 和 Windows API 脚本支持（WScript 等）的文档。无论我在本地安装什么，显然不是包含上述主题的文档集。我需要做什么？

![在此处输入图像描述](../Images/aaaf9635a9aba6b0cb94c8ad4bc35f15.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T07:29:26.223

Microsoft 下载中心提供了有关 Windows Script 5.6 的独立文档：
[Windows Script 5.6 文档](http://www.microsoft.com/en-us/download/details.aspx?id=2764)

~~至于 VS 2012 文档，我相信 Windows 脚本文档是**Web 开发**文档的一部分，就像在线 MSDN 库中一样。~~

> (1) 文档适用于 WSH 5.6 版，而适用于 Windows7 的 WSH 已经在 5.8 版中

WSH 5.8 与 5.6 几乎相同。根据这些主题：

*   [VBScript 版本信息](http://msdn.microsoft.com/en-us/library/4y5y7bh5(v=vs.84).aspx)
*   [JScript 版本信息](http://msdn.microsoft.com/en-us/library/s4esdbwz(v=vs.84).aspx)

VBScript 自 5.6 版以来没有获得任何新的语言功能。JScript 5.8 引入了一些新的语言特性（例如`JSON`对象），但它们仅用于 Internet Explorer 中的 JavaScript 执行，而不用于 WSH：

> 从 JScript 5.8 开始，默认情况下，JScript 脚本引擎支持 5.7 版中存在的语言功能集。这是为了保持与早期版本引擎的兼容性。

因此，独立的 WSH 5.6 文档与在线 MSDN 版本基本相同。

# ruby-on-rails - 在序列化列上保存和更新

> ID：15422368
> 
> 赞同：0
> 
> 时间：2013-03-14T23:53:17.280
> 
> 标签：ruby-on-rails, ruby

提前为丑陋的代码道歉（除了它不起作用）。

我有一个 Rails 应用程序，其中有许多用户玩不同的问答游戏，这些游戏是由不同的用户创建的。用户和测验之间没有 Rails 样式的关联，除了每个测验都是由特定用户完成的。应用程序中实际上甚至没有“测验”模型（测验由问答模型组成）。

出于显而易见的原因，用户只能尝试每个测验一次；因此，我必须记录特定用户尝试了哪些用户的测验。因此，我在用户模型上创建了一个“测验”属性，并将其序列化，这样`['2','4','10']`如果我玩过 ID 为 2,4 和 10 的用户所做的测验，我希望有一个这样的数据库列。

在用户模型中，创建 :quiz 作为“字符串”后，我这样做是为了将字符串转换为数据库中的数组

```
 attr_accessible :quiz
  serialize :quiz 
```

但是，我在编写执行以下所有操作的代码时遇到了很多麻烦

a) 检查该列是否不为空（也许玩家还没有参加过测验）：我做`player.quiz?`了测试。

b）检查数组是否包含特定的 user.id（即，如果玩家已经玩过那个测验）我做 `player.quiz.include?(user.id.to_s)`测试

c) 如果用户尚未进行任何测验，则创建第一个条目。我做了`quiz = user.id.to_s`

d）一旦用户玩了第二个用户的游戏（即玩家的测验列是 ['2'] 并且现在他们按 user.id 4 进行测验），就将其添加到游戏数组中。

使用下面代码的各种组合，当我尝试更新时，我会一直擦除/重置测验列，或者当我想要 ['6','8'] 时，我正在创建像 '68' 这样的字符串。

如果您能给我一些解决此问题的建议，我将不胜感激。

**代码不工作**

```
 if player && player.quiz? && player.quiz.include?(user.id.to_s) #checks if signed in (if player), if the player.quiz column isn't empty, and if it includes a user id

          alreadyplayedthisquiz = true
       else
           if player.quiz?            #it might be that no quizzes are registered on db

            quiz = player.quiz     #this is a string
            quiz.push(user.id.to_s)  #can't push onto a string
            quiz += user.id.to_s    #this is wrong, because if I've played quiz 6 and 8, it'll be '68' in the db
           else 
            quiz = user.id.to_s     #if no quiz on player's db, create first one

           end

          alreadyplayedthisquiz = false
      end

      player.update_attributes({quiz: quiz}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:18:06.493

首先，我会将值存储在数据库中，`"2","4","6"`而不是`["2","4","6"]`. `[`和`]`不是必需的。

我将使用`String#split`将数据库中的字符串转换为可在代码中使用的数组。我会使用`Array#join`将代码中使用的数组转换回字符串以存储在数据库中。

```
quiz = player.quiz? ? player.quiz.split(",") : []
alreadyplayedthisquiz = quiz.include? user.id.to_s
if (!alreadyplayedthisquiz)
  quiz.push user.id.to_s
  player.update_attributes({:quiz => quiz.join(",")})
end 
```

# vb.net - 在 razor 代码后使用句号会导致 MVC4 中出现“预期标识符”错误，但不会导致 MVC3

> ID：15422374
> 
> 赞同：4
> 
> 时间：2013-03-14T23:54:00.357
> 
> 标签：vb.net, asp.net-mvc-3, razor, asp.net-mvc-4

`Test.vbhtml`

```
<span>The time is @DateTime.Now.</span>

@Helper Time()
    @<p>The time is @DateTime.Now.</p>
End Helper 
```

**`.`注意句号末尾的句号 ( )`@DateTime.Now`**

MVC3 接受`Test.vbhtml`. 行`<span>`和`@Helper`编译。

MVC4 仅在帮助程序中出现编译错误：

```
Compiler Error Message: BC30203: Identifier expected. 
```

MVC4`<span>`中的 有效，但`@Helper`无效。

解决方案很简单，例如将句号替换为`&#46;`. **但是为什么会这样呢？**

为澄清而编辑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T12:31:34.020

使用这样放置的点，编译器会查找属性或方法名称。改为这样做：

```
@<p>The time is @(DateTime.Now).</p> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T00:14:33.620

如果您真的想使用@ 符号，请使用如下所示。它解决了这个问题。razor 会在渲染之前尝试寻找 @sign，因此会产生问题。

```
<text>&#64;</text><p> 
```

# php - 如何在 PHP 和 Nginx（或 Lighttpd）中使用符号链接？

> ID：15422375
> 
> 赞同：1
> 
> 时间：2013-03-14T23:54:08.847
> 
> 标签：php, nginx, fastcgi, symlink-traversal

我已经在 Debian 和 ArchLinux 下安装了 Nginx + FPM-PHP。两者都工作正常。但是，我不知道如何让 PHP 部分遵循符号链接。我也尝试过使用 Lighttpd，但无济于事。

这是我想做的事情：

1.  像往常一样配置的根目录：/srv/http
2.  从每个项目到 /srv/http 的符号链接（例如：/home/user/projects/site1 到 /srv/http/@site1），为了测试本地开发，我只需要添加名称站点到 URL:`"http://localhost/site1/xyz"`或`"http://localhost/site2/abc"`, 等等;

我可以使用 html 和其他静态文件使其工作（在修复权限后），但是每当有 PHP 脚本时，我都会收到著名的“主脚本未知”错误。在“真正的根”目录 (/srv/http) 内没有这样的错误。但是当我试图将一个子目录复制到另一个位置（即/home/user/projects/xyz）并将其符号链接到/srv/http/时，我得到了那个错误。

我学习了很多教程，包括一个丹麦人的优秀帖子。但我不能让它工作。我尝试使用“fastcgi_param SCRIPT_FILENAME”、ALIAS 等的所有组合，包括将另一个目录硬编码到其中以确保这是（或不是）问题的原因。

所以，这里有几个问题：

1.  是否可以在 nginx 或 lighttpd 下使用符号链接执行 PHP？
2.  此设置仅用于开发，有理由不使用它吗？
3.  需要什么样的魔法才能让它发挥作用？

由于目标环境将是 nginx（还有其他项目已经在工作），如果可能的话，我想坚持使用 nginx 进行开发。为了速度，我也会使用 lighttpd。如果可行，我想避免使用 Apache（仅因为资源）。

# javascript - 响应：从节点服务器请求令牌时的 Invalid_request

> ID：15422376
> 
> 赞同：0
> 
> 时间：2013-03-14T23:54:09.853
> 
> 标签：javascript, node.js, oauth-2.0

我正在尝试使用本[指南](https://developers.google.com/accounts/docs/OAuth2WebServer#handlingtheresponse)的 Google 授权服务。我无法将代码换成来自服务器的令牌。

```
var token_request='?code='+code+
    '&client_id='+client_id+
    '&client_secret='+client_secret+
    '&redirect_uri='+redirect_uri+
    '&grant_type=authorization_code';

options = {
    host: "accounts.google.com",
    path: '/o/oauth2/token'+token_request,
    method: "POST"
}

var tokenRequest = https.request(options, function(res){
    var resp = "";
    res.on('data', function(data){
        resp+= data;
    })
    res.on('end', function(){
        console.log(resp);
    })
    res.on('error', function(err){
        console.log("\033[;33mIt's an Error.\033[0;39m");
        console.log(err);
    })
}).end(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T03:31:00.950

我会从[这个](http://www.w3schools.com/tags/ref_httpmethods.asp)网站说你应该使用'method：“GET”'而不是'method：“POST”'，因为你的值在查询字符串中。

**编辑：**

根据评论，我会说您必须重新编写代码才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T20:14:33.310

老实说，我正在努力做同样的事情。尽管如此，还是值得尝试 googleapis。

您需要使用 npm 来安装 google api

npm 安装 googleapis

见[https://npmjs.org/package/googleapis](https://npmjs.org/package/googleapis)

对于文档

# android - HttpPost 请求返回错误响应

> ID：15422379
> 
> 赞同：1
> 
> 时间：2013-03-14T23:54:28.957
> 
> 标签：android, http, android-asynctask, http-post, httprequest

我正在尝试将 a 发送`HttpRequest`到位于 Web 服务器上的 php 脚本。我想检索特定类别的所有菜肴。菜肴以我的班级解析数据的`JSON`格式返回。`JSONParser`

以下是我`doInBackground`提出文件请求的方法：

```
 @Override
    protected Boolean doInBackground(String... params) {
        // location of file to retrieve
        String url = "http://www.jdiadt.com/getAllDishes.php";
        JSONObject json = jParser.makeHttpRequest(url, "POST", cat);
        // For testing purposes - Ensure all data was received.
        Log.d("SINGLE DISH DETAILS: ", json.toString());

        try {
            int success = json.getInt(TAG_SUCCESS);
            if (success == 1) {
                dishes = json.getJSONArray(TAG_DISHES);
                for (int i = 0; i < dishes.length(); i++) {
                    JSONObject d = dishes.getJSONObject(i);
                    MenuItem m = new MenuItem();
                    m.setName(d.getString(TAG_NAME));
                    m.setPrice(Double.parseDouble(d.getString(TAG_PRICE)));
                    Log.d("MENUITEM " + i + ":", " NAME:" + m.getName()
                            + " PRICE:" + m.getPrice());
                    starters.add(m);
                }
            } else {
                return false;
            }

            return true;

        } catch (JSONException e) {
            e.printStackTrace();
        }
        return null;
    } 
```

这是该类的`makeHttpRequest()`方法`JSONParser`：

```
public JSONObject makeHttpRequest(String url, String method, String cat) {

    // Making HTTP request
    try {
        // check for request method
        if(method == "POST"){
            // request method is POST
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);

            List <NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
            nameValuePairs.add(new BasicNameValuePair("cat", cat));
            try {
                httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            }

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();

        } 
```

这是我试图检索的脚本：

```
$response = array();

   //Variables for connecting to your database.
            //These variable values come from your hosting account.
            $hostname = "xxx.xxx.xxx.xxx";
            $username = "xxxxxx";
            $dbname = "xxxxxxx";

            //These variable values need to be changed by you before deploying
            $password = "xxxxxxxxxxx";
            $usertable = "dishes";
            $yourfield = "dish_name";

            //Connecting to your database
            mysql_connect($hostname, $username, $password) OR DIE ("Unable to 
            connect to database! Please try again later.");
            mysql_select_db($dbname);

            $cat = $_POST['cat'];

// get all dishes from dishes table
$result = mysql_query("SELECT * FROM $usertable where dish_cat = '$cat' ") or die(mysql_error());

// check for empty result
if (mysql_num_rows($result) > 0) {
    // looping through all results
    // dishes node
    $response["dishes"] = array();

    while ($row = mysql_fetch_array($result)) {
        // temp user array
        $dishes = array();
        $dishes["dish_id"] = $row["dish_id"];
        $dishes["dish_name"] = $row["dish_name"];
        $dishes["dish_desc"] = $row["dish_desc"];
        $dishes["dish_price"] = $row["dish_price"];

        // push single dish into final response array
        array_push($response["dishes"], $dishes);
    }
    // success
    $response["success"] = 1;

    // echoing JSON response
    echo json_encode($response);
} else {
    // no dishes found
    $response["success"] = 0;
    $response["message"] = "No dishes found";

    // echo no users JSON
    echo json_encode($response);
} 
```

注意这一行：

`$cat = $_POST['cat']`

那应该是检索菜肴类别，并且 sql 语句应该成功执行....目前我收到一条消息，说“没有找到菜肴”。

任何帮助将非常感激。我不知道我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:03:12.983

我认为问题是你的情况：

```
if (method == "POST") {
  // execute request
} 
```

在这里，您正在`Strings`与 == 进行比较，这将始终返回 false（并且永远不会执行正文），因为它比较的是引用而不是值。你必须使用`equals()`方法。

```
if (method.equals("POST") {
   // do your work
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:12:21.443

嘿尝试打印 $cat 以确保您首先正确接收它。

# maven - 在 pom.xml 中添加新标签的方法

> ID：15422380
> 
> 赞同：3
> 
> 时间：2013-03-14T23:54:33.410
> 
> 标签：maven, pom.xml

我正在开发一个使用 Maven 和 Eclipse 的项目。在这个项目中，我有一些工件（如 jar、war 等）并希望为这些工件添加一些特性（或“属性”）。（简单的字符串字段）

其中一些属性可能类似于“问题描述”标签。我想知道将这些属性添加到他们自己的 pom.xml 相关文件中的可能性。

所以，这是我的问题：有一种方法可以在 pom.xml 中添加自定义标签吗？

如果没有，我是否可以修改 maven 配置以指向我修改的其他 XML 模式（以添加对我创建的属性的验证）？

我正在使用 Maven 3.0.5

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T21:25:31.843

您可以像这样在 pom.xml 中定义属性：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.domain.example</groupId>
    <artifactId>example-artifact</artifactId>
    <version>1.0.0-SNAPSHOT</version>

    <name>${project.artifactId}</name>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.build.compiler.version>1.6</project.build.compiler.version>
        <myProperty>myValue</myProperty>
    </properties>

</project> 
```

因此在 pom.xml 或过滤文件中，您可以使用 ${myProperty} 让 maven 填写“myValue”

如果您想使用插件，本指南可能会有所帮助：[http](http://maven.apache.org/guides/mini/guide-configuring-plugins.html) ://maven.apache.org/guides/mini/guide-configuring-plugins.html - 在配置部分中，您几乎可以做任何事情。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-12T00:31:26.547

感谢所有帮助您的答案和时间的人。=D 下面是我决定使用的解决方案。我在这里发布，这样可以帮助其他人解决我遇到的同样问题。

在@wemu 建议的“属性”字段（在 pom.xml 文件中）中，我将路径（链接）放入我创建的 xml 文件中。

谢谢@wemu！

# asp.net - IIS Web 应用程序和类库配置 - 配置文件在部署时丢失

> ID：15422382
> 
> 赞同：3
> 
> 时间：2013-03-14T23:54:50.873
> 
> 标签：asp.net, configuration

我有一个用 C# 4.0 编写的 ASP.NET Web 应用程序。应用程序引用了一个带有自己的配置文件的类库。在运行时，类库使用类似于下面的代码来加载这个特定的配置：

```
var exeConfigPath = this.GetType().Assembly.Location;
var config = ConfigurationManager.OpenExeConfiguration(exeConfigPath); 
```

这样做是因为库必须加载其捆绑配置而不是应用程序配置。应用程序配置不应该关心库的设置，也不应该改变它们。

现在，要让这个概念发挥作用，还需要做一些其他的事情。我必须在属性窗口中将库的配置文件构建操作设置为 Content 并将 Copy 设置为`Copy Always`or `Copy If Newer`。到目前为止一切顺利 - 该文件自动进入类库的 bin 目录和 Web 应用程序的 bin 目录，并正确地从`App.config`to重命名`CustomLibrary.dll.config`（假设，库的 dll 是 CustomLibrary.dll）。

现在我面临两个问题。

1) 当我将 Web 应用程序发布到文件系统位置（在 IIS 中映射）时，它会`CustomLibrary.dll.config`显示`App.config`在已发布应用程序的 bin 文件夹中。好的 - 我将在类库项目中重命名它以匹配预期的约定 - 问题解决了。

2) 即使发布后，IIS 也会再次编译应用程序并将其存储在 ASP.NET 临时文件中。有一个花哨的目录结构，其中包含一个专用于每个引用的程序集的文件夹。CustomLibrary.dll 对应的文件夹中不包含配置文件。由于`this.GetType().Assembly.Location`将返回临时文件夹的路径，因此应用程序无法加载配置并崩溃。

我需要保留在类库中进行配置的模式，并使其能够在 Web 应用程序中工作。当手动将 .config 复制到临时文件夹时，该应用程序可以工作，但是请看，我真的很讨厌手动复制到随机命名的文件夹。

有没有办法阻止 IIS 使用临时文件夹，或者让它沿着配置文件复制？我相信我面临的问题与配置相关而不是概念性的，因为当配置文件到位时应用程序按预期工作。我也不想在配置文件中使用硬编码的物理路径。

* * *

**编辑：**

为了更清楚，我将指出我想要实现的目标和原因。这个想法是库和 web 项目将作为单独的产品开发 - 在库的配置中不会有用户或应用程序特定的信息，因此它不会因不同的使用场景而改变。它也相当特定于类库功能而不是最终应用程序。将库的配置信息捆绑在其中对我来说是有意义的（类似于 Java，其中 spring 上下文 xml 文件或属性文件与库的 jar 捆绑在一起）。我想避免在消费者应用程序的每个应用程序/网络配置中复制配置。在某些情况下，消费者应用程序是由第三方开发的，而且我不想依赖他们为我的东西做正确的配置。同样，这里唯一的问题是没有将配置文件复制到正确的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T23:20:28.643

如果这些是没有人应该看到或更改的静态内部设置，那么将类库中包含的配置文件作为嵌入式资源是否会更好？或者只是一个带有设置的静态类。

这样你就可以确定没有人改变它，在你的场景中这似乎是一个加号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T23:06:42.837

我已经采取了一种方法来解决所描述的问题，但对于我的要求来说仍然不是一个非常愉快的问题。

解决方案是利用始终可用的应用程序配置（Web 应用程序中的 web.config 或 app.config）。我已将每个库的配置文件的绝对路径添加为设置。所以我最终得到：

```
<!--
THIS IS IN THE WEB.CONFIG FILE
-->
<appSettings>
    <add key ="ClassLibrary_ConfigPath"
         value ="{My Publish Output Folder}\ClassLibrary.dll.config"/>
</appSettings> 
```

并且类库现在使用以下代码来加载其配置：

```
Configuration config = null;
try 
{
    var exeConfigPath = this.GetType().Assembly.Location;
    config = ConfigurationManager.OpenExeConfiguration(exeConfigPath);
}
catch (Exception e)
{
    if (!IsConfigurationNotFoundError(e)) 
    {
        // IsConfigurationNotFoundError logic skipped for brevity
        var exeConfigPath = 
            ConfigurationManager.AppSettings["ClassLibrary_ConfigPath"];
        if (exeConfigPath != null) 
        {
            config = ConfigurationManager.OpenExeConfiguration(exeConfigPath);
        }
    }
    else
    {
        throw;
    }
} 
```

虽然这可行，但如果可能的话，我会等待更好的解决方案。尽管如此，我不必将整个 ClassLibrary.dll.config 复制到 web.config 文件中，但现在我必须管理文件系统位置并注意应用程序设置名称。我真正想要的是 ClassLibrary.dll 的消费者应用程序不以任何方式处理其配置。如果它是一个桌面应用程序，我已经涵盖了这一点，因为 Visual Studio 会适当地复制 ClassLibary.dll.config。我希望有一种方法可以让它在 Web 应用程序中顺利运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T01:36:53.950

简短的回答是：你不能。您必须合并两个配置部分并将所有设置放在应用程序的主配置文件中。如果是 Web 应用程序，它将是`web.config`. 读[这个](https://stackoverflow.com/questions/13045958/unable-read-app-config-values-from-class-library)

# visual-studio-2012 - 发布 Web 应用程序在 Visual Studio 中工作，但生成的包 cmd 文件因权限不足而失败

> ID：15422386
> 
> 赞同：2
> 
> 时间：2013-03-14T23:55:06.640
> 
> 标签：visual-studio-2012, msdeploy

我正在尝试从命令行部署 Web 应用程序。最终，我将从我的构建服务器（运行 Jenkins）中执行此操作，但现在我正在从我的桌面执行此操作。

我的 Web 服务器运行 Windows Server 2012。我在桌面上使用 Visual Studio 2012。在 Visual Studio 中，使用 Web Deploy 方法直接发布可以正常工作。相反，如果我使用 Web Deploy Package 方法，然后运行生成的 .cmd 文件，它会失败并显示

`Error: (3/14/2013 7:35:49 PM) An error occurred when the request was processed on the remote computer. Error: An error occurred when reading the IIS Configuration File 'MACHINE/REDIRECTION'. The identity performing the operation was 'WEB\uoedeploy'.Error: Filename: \\?\C:\Windows\system32\inetsrv\config\redirection.config Error: Cannot read configuration file due to insufficient permissions`

按照 Microsoft 和其他地方的指示，我在 Web 服务器上创建了一个用于发布的帐户，并且我对两种发布方法都使用了相同的帐户凭据。我将该用户添加到 Web 服务器上的组 MSDepSvcUsers。我在 上检查了该帐户的有效权限`redirection.config`，它显示了读取权限。

我讨厌 MSDeploy。

# windows - 如何创建托管在不同数据中心的 Windows Azure 应用程序

> ID：15422387
> 
> 赞同：1
> 
> 时间：2013-03-14T23:55:09.313
> 
> 标签：windows, azure, storage, scalability

我试图弄清楚如何扩展 Windows Azure 应用程序，其中有一些 Web 角色和一些工作角色。

目标是在美国数据中心拥有一些实例，在欧洲数据中心拥有一些实例，以便美国和欧洲的不同用户有更好的响应时间。我的问题是复制我所有的存储（针对前往美国的欧洲用户，反之亦然），甚至针对一个数据中心的问题。

到目前为止，我知道可以使用[流量管理器](http://www.windowsazure.com/en-us/manage/services/networking/traffic-manager/)让 Azure 知道哪个数据中心离用户更近。

我知道我可以使用[SQL Data Sync](http://www.windowsazure.com/en-us/manage/services/sql-databases/getting-started-w-sql-data-sync/)在数据库之间复制数据。

也可以使用[Copy Blob API 复制 Blob](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-asynchronous-cross-account-copy-blob.aspx)存储。

我知道队列无法自动复制，但我对此没有太大问题。

我的问题是我找不到复制表存储的方法。

事实上，我真的不知道这是否是解决我问题的最佳策略......

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:38:10.800

DX - 使用流量管理器和数据同步您就对了。这些是角色和 SQL 的最佳选择。但是，BLOB 更容易 - 启用 CDN，您的 BLOB 会自动复制到 24 个数据中心。阅读[为 Windows Azure 使用 CDN，](http://www.windowsazure.com/en-us/develop/net/common-tasks/cdn/)了解如何从您的主存储帐户设置 CDN。

对于表存储，我将以编程方式处理此问题，保留表连接列表，然后使用并行 foreach 插入不同的数据中心。

我们为每个数据中心维护不同的服务配置文件以简化部署。

# matlab - 如何获得矩阵的唯一切片？

> ID：15422392
> 
> 赞同：5
> 
> 时间：2013-03-14T23:55:21.070
> 
> 标签：matlab, matrix, language-features, built-in

在matlab中，如果你有一个矩阵`A`，你可以找到`B`包含所有唯一行的矩阵`A`，如下所示：

```
B = unique(A,'rows'); 
```

我所拥有的是一个 3d 矩阵，其中行和列作为前两个维度，以及一个附加维度（“切片”）。

如何获得包含矩阵中所有唯一切片的 3d 矩阵`A`？这是我想要的那种功能的例子：

```
>> A % print out A
A(:,:,1) =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1

A(:,:,2) =

     1     0     0     0
     0     1     0     0
     0     0     1     0
     0     0     0     1

A(:,:,3) =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1

A(:,:,4) =

     0     0     0     1
     0     0     1     0
     0     1     0     0
     1     0     0     0

>> unique(A,'slices'); % get unique slices

A(:,:,1) =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1

A(:,:,2) =

     1     0     0     0
     0     1     0     0
     0     0     1     0
     0     0     0     1

A(:,:,3) =

     0     0     0     1
     0     0     1     0
     0     1     0     0
     1     0     0     0 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T00:02:07.717

我将从重塑 A 开始，因此每个切片都变成一行（使用`reshape`命令）。然后使用`unique(A, 'rows')`. 最后，将独特的行重新整形为与切片相同的形状。

例如：

```
% transforming so each row is a slice in row form
reshaped_A = reshape(A, [], size(A, 3))';

% getting unique rows
unique_rows = unique(reshaped_A, 'rows');

% reshaping back
unique_slices = reshape(unique_rows', size(A, 1), size(A, 2), []); 
```

或全部在一行中：

```
reshape(unique(reshape(A, [], size(A, 3))', 'rows')', size(A, 1), size(A, 2), []) 
```

我还没有检查过上面的代码，所以请谨慎使用！但它应该给出这个想法。

* * *

**编辑**

它正在处理您的数据（也修复了上面代码中的小错误）：

```
>> reshaped_A = reshape(A, [], size(A, 3))'

reshaped_A =

Columns 1 through 11

16     5     9     4     2    11     7    14     3    10     6
 1     0     0     0     0     1     0     0     0     0     1
16     5     9     4     2    11     7    14     3    10     6
 0     0     0     1     0     0     1     0     0     1     0

Columns 12 through 16

15    13     8    12     1
 0     0     0     0     1
15    13     8    12     1
 0     1     0     0     0 
```

这些 ^^ 行中的每一行都是原始切片之一

```
>> unique_rows = unique(reshaped_A, 'rows')

unique_rows =

Columns 1 through 11

 0     0     0     1     0     0     1     0     0     1     0
 1     0     0     0     0     1     0     0     0     0     1
16     5     9     4     2    11     7    14     3    10     6

Columns 12 through 16

 0     1     0     0     0
 0     0     0     0     1
15    13     8    12     1 
```

这些 ^^ 是独特的切片，但形状错误。

```
>> unique_slices = reshape(unique_rows', size(A, 1), size(A, 2), [])

unique_slices(:,:,1) =

 0     0     0     1
 0     0     1     0
 0     1     0     0
 1     0     0     0

unique_slices(:,:,2) =

 1     0     0     0
 0     1     0     0
 0     0     1     0
 0     0     0     1

unique_slices(:,:,3) =

16     2     3    13
 5    11    10     8
 9     7     6    12
 4    14    15     1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T03:48:03.420

一个非常简单且可扩展的解决方案是：

```
A = cat(3, [16 2 3 13;5 11 10 8;9 7 6 12;4 14 15 1], [1 0 0 0;0 1 0 0;0 0 1 0;0 0 0 1], [16 2 3 13;5 11 10 8;9 7 6 12;4 14 15 1], [0 0 0 1;0 0 1 0;0 1 0 0;1 0 0 0])
[n,m,p] = size(A);
a = reshape(A,n,[],1);
b = reshape(a(:),n*m,[])';
c = unique(b,'rows', 'stable')';    %If the 'stable' option is supported by your version.
%If the 'stable' option is not supported, but it's still required, use the index vector option, as required. 
%i.e.,
%[c,I,J] = unique(b,'rows');
unique_A = reshape(c,n,m,[]) 
```

**结果：**

```
A(:,:,1) =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1

A(:,:,2) =

     1     0     0     0
     0     1     0     0
     0     0     1     0
     0     0     0     1

A(:,:,3) =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1

A(:,:,4) =

     0     0     0     1
     0     0     1     0
     0     1     0     0
     1     0     0     0

unique_A(:,:,1) =

     0     0     0     1
     0     0     1     0
     0     1     0     0
     1     0     0     0

unique_A(:,:,2) =

     1     0     0     0
     0     1     0     0
     0     0     1     0
     0     0     0     1

unique_A(:,:,3) =

    16     2     3    13
     5    11    10     8
     9     7     6    12
     4    14    15     1 
```

资料来源：[如何在 3d 矩阵中找到唯一页面？](http://www.mathworks.in/matlabcentral/answers/63229)

# ajax - 传递 JavaScript 参数时，如何使用 Symfony2 在 AJAX 中执行方法？

> ID：15422393
> 
> 赞同：0
> 
> 时间：2013-03-14T23:55:24.553
> 
> 标签：ajax, json, jquery, symfony

当我需要将使用 JavaScript 检索到的一些参数传递给控制器​​中的方法时，我对 AJAX/S2 感到困惑。

在我的脚本中，我得到了位置变量：

```
function handle_geolocation_query(position){ 

    alert('Lat: ' + position.coords.latitude + ' ' +  
          'Lon: ' + position.coords.longitude);

    $.when( getLakes(position.coords.latitude, position.coords.longitude)).done(function(result1) {
        console.log(result1);
    });

};

function getLakes(lat, long) {
    return $.ajax({
            url: "{{ path('getLakes') }}",
            data: { lat:lat, lng: lng },
            dataType: 'jsonp'
        });
}; 
```

那么路由器就是这样设置的：

```
getLakes:
    pattern:  /lakes
    defaults: { _controller: PondipGeolocBundle:Default:getLakesSurrounding } 
```

在我的控制器中，我应该返回一个数组：

```
public function getLakesSurrounding($lat=0, $lng=0, $limit = 50, $distance = 50, $unit = 'km')
    {

            $lat = $this->getRequest()->get('lat'); 
    $lng = $this->getRequest()->get('lont');

        $return= array( '1'=>   array(  'title' => 'lake1',
                                        'venue' => 'lake2',
                                        'dist' => 'lake3',
                                        'species' => 'lake4',
                                        'stock' => 'lake4'),

                        '2'=>   array(  'title' => 'lake1',
                                        'venue' => 'lake2',
                                        'dist' => 'lake3',
                                        'species' => 'lake4',
                                        'stock' => 'lake4'),

                        '3'=>   array(  'title' => 'lake1',
                                        'venue' => 'lake2',
                                        'dist' => 'lake3',
                                        'species' => 'lake4',
                                        'stock' => 'lake4'),

                        '4'=>   array(  'title' => 'lake1',
                                        'venue' => 'lake2',
                                        'dist' => 'lake3',
                                        'species' => 'lake4', 
                                        'stock' => 'lake4'),

                        '5'=>   array(  'title' => 'lake1',
                                        'venue' => 'lake2',
                                        'dist' => 'lake3',
                                        'species' => 'lake4',
                                        'stock' => 'lake4')
                        );

        $return=json_encode($return); //jscon encode the array
        return new Response($return,200,array('Content-Type'=>'application/json')); //make sure it has the correct content type

    } 
```

然后我想将它传递给另一个函数，该函数将设置带有小胡子的模板以在视图中打印它（我还没有在这里..）

我的问题是：我无法将所需的经纬度数据传递给我的函数。路由器发疯了，控制器没有得到任何东西，我也没有从那个脚本中得到任何东西。编辑：我找到了传递变量的方法，但我仍然无法从我的控制器得到任何响应，没有发生任何事情并且 $.when 不执行任何回调

我对 AJAX 还很陌生，请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:03:10.650

看看[FOSJsRoutingBundle](https://github.com/FriendsOfSymfony/FOSJsRoutingBundle)。有了它，您可以使用 JS 中的路由器：

```
Routing.generate('my_route_to_expose', { "id": 10, "foo": "bar" }); 
```

# jquery - 显示 3 张图片（如 Carousel）的幻灯片，其中包含一些指定的细节

> ID：15422395
> 
> 赞同：0
> 
> 时间：2013-03-14T23:55:38.570
> 
> 标签：jquery, slideshow, center, carousel, caption

我需要制作一个幻灯片，它会显示三个图像，并像[本网站](http://www.frameweb.com/)中的那样滑动它们。

唯一的区别是我需要第一张和第三张幻灯片是透明的，所以只有中间（活动）的一张会完全可见并改变标题的设计。

无论如何，我尝试了具有一些功能的“Cycle2”插件，但我不能像我想要的那样使用它（始终居中并切掉其他幻灯片的侧面）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:06:58.857

MovingBoxes 插件可能会对您有所帮助。

```
$(window).load(function() {
    var slideShowDelay = 4000, // 4000 millisecond = 4 seconds
            timer,
            mb = $('#slider').data('movingBoxes'),
            loop = function() {
        // if wrap is true, check for last slide, then stop slideshow
        if (mb.options.wrap !== true && mb.curPanel >= mb.totalPanels) {
            // click the button to pause
            $('button.slideshow').trigger('click');
            return;
        }
        // next slide, use mb.goBack(); to reverse direction
        mb.goForward();
        // run loop again
        timer = setTimeout(function() {
            loop();
        }, slideShowDelay);
    };
    // toggle slideshow button
    $('button.slideshow')
            .attr('data-mode', "false") // slideshow paused
            .click(function() {
        clearTimeout(timer);
        // slide show mode
        var mode = $(this).attr('data-mode') === "false",
                // button text, replace with <img> if desired
                button = mode ? "Pause" : "Play";
        if (mode) {
            loop();
        }
        $(this).attr('data-mode', mode).html(button);
    });
}); 
```

[演示](http://jsfiddle.net/jMXx3/3030/)

# jquery - Html 视频播放列表

> ID：15422396
> 
> 赞同：0
> 
> 时间：2013-03-14T23:55:49.777
> 
> 标签：jquery, video, playlist

我的页面上有一个视频播放器，可以根据按下的链接播放视频。

我正在尝试创建它，以便它也能够基于另一个按钮跳到视频的某个部分。

到目前为止，我让他们都在不同的页面上工作。这是我到目前为止所拥有的：

```
<div id="video-player"> 

       <img src="images/videoplayer/screen680.png" id="video-screen"/>    
      <video id="videoarea" poster="" src=""></video>

      <ul id="playlist">
        <li movieurl="video/1.Adele Gillies_short_compressed.mp4" id="myvideo">

            <button class="video-button left-menu"  id="education-jump">vid1 education</button>
            <button class="video-button left-menu" id="education-jump2">vid2 eductaion</button>
        </li>

        <li movieurl="video/1.William Morrison_short-comp.mp4" id="myvideo2">
            <button class="video-button left-menu"  id="relationship-jump">vid1 relationships</button>
            <button class="video-button left-menu" id="relationship-jump2">vid2 relationships</button>
        </li>

      </ul>
  </div> 

 <script> 
            var myvideo = document.getElementById("myvideo"),
            playbutton = document.getElementById('playme'),
            jumplink1 = document.getElementById('education-jump');
            jumplink2 = document.getElementById('education-jump2');

        jumplink1.addEventListener("click", function (event) {
            event.preventDefault();
            myvideo.play();
            myvideo.pause();
            myvideo.currentTime = 200;
            myvideo.play();
        }, false);

         jumplink2.addEventListener("click", function (event) {
            event.preventDefault();
            myvideo.play();
            myvideo.pause();
            myvideo.currentTime = 170.1;
            myvideo.play();
        }, false);

    </script>

<script type="text/javascript">
          $(function() {
    $("#playlist li").on("click", function() {
        $("#videoarea").attr({
            "src": $(this).attr("movieurl"),
            "poster": "",
            "autoplay": "autoplay"
        })
    })
    $("#videoarea").attr({
        "src": $("#playlist li").eq(0).attr("movieurl"),
        "poster": $("#playlist li").eq(0).attr("moviesposter")
    })
})
        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T03:55:39.857

这会将事件附加到按钮（而不是`<li>`），但仍会从父组读取 URL，但会从用于触发加载的按钮设置假时间属性

为了避免过多的闪烁，它还会检查视频是否正在更改（在这种情况下，它会重新加载整个视频）或者视频是否相同，它所做的只是改变当前时间的一个新位置。

我想这就是你所追求的...

```
 <div id="video-player"> 

      <video id="videoarea" poster="" src="" proload="auto" controls></video>

      <ul id="playlist">
        <li movieurl="video.mp4" id="myvideo">
            <button class="video-button left-menu"  id="education-jump" time="20">vid1 education</button>
            <button class="video-button left-menu" id="education-jump2" time="30">vid2 eductaion</button>
        </li>

        <li movieurl="video2.mp4" id="myvideo2">
            <button class="video-button left-menu" id="relationship-jump" time="10">vid1 relationships</button>
            <button class="video-button left-menu" id="relationship-jump2" time="50">vid2 relationships</button>
        </li>

      </ul>
  </div> 

<script> 
    var myvideo = document.getElementById("videoarea")

    $(".video-button").on("click", function() {
        // if we need to load a new video do so
        if ($("#videoarea").attr("src") != $(this).parent().attr("movieurl")) {
            $("#videoarea").attr({
                "src": $(this).parent().attr("movieurl"),
                "poster": "",
                // load a fake attribute with the desired start time
                "starttime": $(this).attr("time")})
            $("#videoarea").on("canplay",function() {
                // set the current time to the fake attribute
                myvideo.currentTime=$(this).attr("starttime")
                myvideo.play();
                // remove the event to stop it triggering multiple times
                $("#videoarea").off("canplay")
            })
        } else {
            // if the video URL didn't change, just adjust the time
            myvideo.currentTime=$(this).attr("time")
        }
    })

 </script> 
```

# javascript - Ajax从行中删除单元格，重新计算将单元格移动到下一行的行

> ID：15422397
> 
> 赞同：1
> 
> 时间：2013-03-14T23:55:55.623
> 
> 标签：javascript, jquery

使用具有动态单元格宽度的 twitter 引导行/表结构，我有一个 ajax 脚本，它从数据库中删除一条记录并删除 HTML。

但是我将如何在删除后重新计算行？这是我无法理解逻辑过程的部分。

例如：如果我从中间行删除一个单元格，它会计算删除后是否有足够的可用空间并将单元格移动到下一行。然后循环到下一行/等

理想情况下，如果它使用动态宽度会非常酷，因此所有跨度加起来为 12。如果肯定有空间，它只会将一个项目移动到下一行。

如果我删除一个大/宽跨度，并且下一行有 2 个小跨度可以替换。等等我想你明白了。

```
<div class="row">
   <div class="span4">...<a href="">Delete</a></div>
   <div class="span4">...<a href="">Delete</a></div>
   <div class="span4">...<a href="">Delete</a></div>
</div>
<div class="row">
   <div class="span6">...<a href="">Delete</a></div>
   <div class="span2">...<a href="">Delete</a></div>
   <div class="span4">...<a href="">Delete</a></div>
</div>
<div class="row">
   <div class="span2">...<a href="">Delete</a></div>
   <div class="span8">...<a href="">Delete</a></div>
   <div class="span2">...<a href="">Delete</a></div>
</div>

    $('a').click(function(e){    
    e.preventDefault();
    var $self = $(this);

    $.ajax({
        type: 'POST',
        url: ajaxAction,
        data: obj,
        dataType: 'json',
        success: function(data, status, jqXHR){
            if(data && data.ok){
                $self.parent().slideUp("slow", function(){
                    if(delete_container.substring(0,5) == ".span"){

                        // get parent row
                        var row = $(this).parent();
                        if(row.hasClass("row") || row.hasClass("row-fluid")){
                            var count = 0;
                            row.children("[class*='span']").each(function(){

                                count = $(this).attr('class').match(/\d+/);                                     

                            });

                            if(count < 12){
                                // check next line and move item up if it fits
                                // then loop over everything again on the next row
                            }
                        }                               
                    }
                    $(this).remove(); 
                })
            }   
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T10:59:01.113

最简单的方法：更改表格的结构，然后删除`<div class="row">`，然后添加`float: left`到您的单元格中。浏览器会照顾一切。:)

但如果它不可接受，让我们调用函数`rearrangeTable( fromRow )`：

```
rearrangeTable( fromRow ) { //from row is a number of row, where you have deleted cell.
var $actualRow = $('div.row:eq('+fromRow+')');
var $nextRow = $actualRow.next(div.row);

//getting free space in actual row
var freeSpace = $actualRow.width(); //IMPORTANT: width() not outerWidth()
$actualRow.find('cell_selector :)').each( function(i) {
    freeSpace -= $(this).outerWidth();
})

var $nextCell;
while( $nextCell = getFirstCell( $nextRow ) ) { //ill not show this function its trivial, just returns first cell or false if there are no more cells
    var cellWidth = $nextCell.outerWidth();
    if( freeSpace >= cellWidth ) {
        letsMoveThisCell( $nextCell, $actualRow);
        freeSpace -= cellWidth;
    } else {
        break; //no more space, we can end there
    }
} 
```

它只是元代码，未经测试，展示了如何归档它的想法。现在，您应该`rearrangeTable( fromRow )`从已删除单元格的行调用到表的末尾，它应该可以工作。

# c# - 如何从不同的程序集中检索类的接口？

> ID：15422400
> 
> 赞同：2
> 
> 时间：2013-03-14T23:56:16.250
> 
> 标签：c#, reflection

在 WCF 中，通常将接口和实现类放在单独的程序集中。我正在构建一个基于配置创建 WCF 代理类的类（无论是来自我的 web.config 中的服务或 serviceActivations 还是来自 svc 文件中的 Service 属性）。在我的类中，我想检索可从服务类分配的接口 - 在类和接口位于同一程序集中的情况下，这很容易：

```
Type type = Type.GetType("MyNamespace.MyClass, MyAssembly");
if (type != null)
{
    var interfaces =
    Assembly.GetAssembly(type)
            .GetTypes()
            .Where(t => t.IsInterface && t.IsAssignableFrom(type));               
} 
```

没有通过获取所有程序集（使用 CurrentDomain.GetAssemblies()）并以这种方式查找接口来使用一些蛮力反射解决方案，是否有规定的方法从不同的（未知）程序集获取接口？

另外，我知道使用 WCF 发现而不是自己做这项工作 - 不幸的是，在我的情况下，这不是一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T12:27:53.967

原来有一个方便的反射方法叫做“GetInterfaces()”，可以提供这个信息：

```
Type type = Type.GetType(activation.Service);
if (type != null)
   Type[] interfaces = type.GetInterfaces(); 
```

# json - 如何从 extjs 更新 json 文件

> ID：15422403
> 
> 赞同：-1
> 
> 时间：2013-03-14T23:56:47.373
> 
> 标签：json, extjs

你能告诉我如何将数据从我的 extjs 数据网格更新到 JSON 文件吗？我的代码适用于从 JSON 文件加载静态数据。此外，当我编辑数据时，数据会更新。但我不知道如何将更新的数据存储到 JSON 文件中，以便即使在我刷新页面或退回服务器时也会反映出来。

谢谢

穆拉利小号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:03:13.257

您不能只更新 json 文件，服务器上的某些东西（PHP、Java、C# 等）需要这样做。如果您可以直接从客户端更新静态文件，那将是一个巨大的安全漏洞。

Ext JS SDK 中有一些示例向您展示如何将数据发送到服务器并将其持久化。

# c# - InvalidOperationException 更新 TextBlock

> ID：15422404
> 
> 赞同：0
> 
> 时间：2013-03-14T23:56:47.533
> 
> 标签：c#, wpf

我尝试按照其他问题通过使用 Dispatcher 将一些内容从工作线程添加到 WPF 文本块。我正在使用以下方法：

```
private void AppendLineToChatBox(Inline message)
{        
    chatBox.Dispatcher.BeginInvoke(new Action(() =>
    {
        chatBox.Inlines.Add(message);
        chatBox.Inlines.Add("\n");
        scroller.ScrollToBottom();
    }));
} 
```

使用 XAML：

```
<Grid Height="200" Width="300" HorizontalAlignment="Left">
    <ScrollViewer Name ="scroller">
        <TextBlock TextWrapping="Wrap" Background="White" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Name="chatBox" />
    </ScrollViewer>
</Grid> 
```

当我从后台线程调用 AppendLineToChatBox() 时，我仍然收到以下异常：

> System.InvalidOperationException 未处理 HResult=-2146233079
> Message=调用线程无法访问此对象，因为不同的线程拥有它。

正确的方法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:16:55.550

Inline 类继承自 DispatcherObject，这意味着由此类创建的任何对象都与创建它们的线程相关联。通过查看您的代码，看起来 AppendLineToChatBox 方法正在由工作线程调用，并且工作线程还拥有 Inline 对象。

要解决这个问题，您需要在 UI 线程中构造 Inline 对象（例如 BeginInvoke 中的代码块）

# javascript - html5应用缓存强制更新

> ID：15422406
> 
> 赞同：0
> 
> 时间：2013-03-14T23:56:55.177
> 
> 标签：javascript, html5-appcache

***window.applicationCache***有一个名为***update***的方法。我假设此函数获取 html 元素中指定的***manifest.appcache***文件，并检查差异。

这一切都很好，但据我了解，每当加载页面时，浏览器都会请求***manifest.appcache***文件并运行相同的“检查差异”过程。

所以我的问题是（请注意统计数据）：

*“如果平均更新发布周期是2周，页面平均停留时间是30秒，为什么会有更新功能？”*

对我来说，这没有意义，我认为我遗漏了一些东西，因此提出了 SO 问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T21:46:23.327

众所周知，一些公司（例如：IMVU）每天会推送多次更新。它通常被称为“持续部署”。在页面上花费的平均时间很大程度上取决于应用程序的体系结构。

我认为 HTML5 Appcache 主要用于缓存“单页应用程序”的代码，即所有用户交互都发生在单个页面视图中的应用程序 - 就浏览器而言。Gmail 是单页应用程序的一个很好的例子。虽然它不使用 appcache，但它可以。

用户可能不会将其视为单个页面视图，因为（实际上）整个可见文档可以被从服务器下载的其他内容替换。用户甚至可以在使用 HTML5 History API 在应用程序内部“浏览”时看到他的位置栏发生变化。

用户可能连续数小时使用单页应用程序（想想 gmail），如果他不关闭计算机（或关闭浏览器），甚至可能数天。

按照设计，要求加载具有 appcache-cache 的页面的浏览器（这与普通浏览器缓存的工作方式不同）将始终从磁盘加载缓存版本，这不一定是最新版本。从缓存加载意味着应用程序在没有任何网络延迟的情况下启动。只有在加载应用程序后，浏览器才会检查更新的缓存清单。默认情况下，不会通知用户任何此类更新。他只有在浏览器中重新加载应用程序后才能看到更新。

如果用户有一个应用程序打开了几个小时，那么在此期间肯定会有更新。因此，为了最大限度地提高用户在下次启动应用程序时看到最新版本的机会，应用程序应间歇性地检查更新。如果 appcache 清单已更改，则缓存将被更新。下次用户启动应用程序时，浏览器将加载它在用户之前使用该应用程序时加载的最新版本。轮询间隔可以调整为新版本之间的预期间隔。

也可以提醒用户有可用的更新。可能会出现一条不显眼的消息“应用程序更新可用，现在加载它吗？（好的）（关闭）”由于所有资源都已预先获取，因此重新加载几乎是瞬时的（全部来自磁盘）。更困难的是确保保留所有用户的数据（和“会话状态”）。

# playframework - GAE中的Play框架不走路线

> ID：15422407
> 
> 赞同：1
> 
> 时间：2013-03-14T23:56:59.513
> 
> 标签：playframework

我创建了一个简单的播放应用程序。我计划在 Google App Engine 中托管该应用程序。我已经在我的本地机器上完成了应用程序的测试。我成功部署（没有任何部署错误）到谷歌云。

问题：部署到 Google 的云后，我的请求没有通过 Play 的路由文件处理。我需要一些建议

我正在使用 Play 1.2.5、gae 模块 1.6.0、appengine-java-sdk-1.7.5

这是我的路线文件：

```
# 路线
# 这个文件定义了所有的应用路由（优先级高的路由优先）
#~~~~

＃ 主页
#GET / 应用程序.index

# 将 /app/public 文件夹中的静态资源映射到 /public 路径

GET /v1/items com.github.mygrocery.controller.MyGroceryController.listItems()
POST /v1/items com.github.mygrocery.controller.MyGroceryController.createItem()
PUT /v1/items com.github.mygrocery.controller.MyGroceryController.updateItems()
删除 /v1/items com.github.mygrocery.controller.MyGroceryController.deleteItems()

GET /v1/items/{pId} com.github.mygrocery.controller.MyGroceryController.getItem
POST /v1/items/{pId} com.github.mygrocery.controller.MyGroceryController.unsupportedRequest
PUT /v1/items/{pId} com.github.mygrocery.controller.MyGroceryController.updateItem
删除 /v1/items/{pId} com.github.mygrocery.controller.MyGroceryController.deleteItem

获取 /v1/requirements com.github.mygrocery.controller.MyGroceryController.listRequirements()
POST /v1/requirements com.github.mygrocery.controller.MyGroceryController.createRequirement()
PUT /v1/requirements com.github.mygrocery.controller.MyGroceryController.updateRequirement()
删除 /v1/requirements com.github.mygrocery.controller.MyGroceryController.deleteRequirements()

# 抓住所有
获取/静态目录：公共

* /{controller}/{action} {controller}.{action}

```

如果您需要更多信息，请告诉我。

# performance - Node.JS 响应时间

> ID：15422411
> 
> 赞同：13
> 
> 时间：2013-03-14T23:57:05.633
> 
> 标签：performance, node.js, amazon-web-services

在 AWS 实例上抛出 Node.JS 并测试请求时间，得到了一些有趣的结果。

我为服务器使用了以下内容：

```
var http = require('http');

http.createServer(function(req, res) {
  res.writeHead(200, {'Content-Type': 'text/html'});
  res.write('Hello World');
  res.end();
}).listen(8080); 
```

我对该服务器的平均延迟为 90 毫秒，但总请求需要约 350 毫秒。显然很多时间都浪费在了盒子上。我确保在测试之前缓存了 DNS。

我在服务器上做了一个 Apache bench，并发为 1000 - 它在 4.3 秒内完成了 10,000 个请求......这意味着平均 4.3 毫秒。

**更新：只是为了笑，我在同一台机器上安装了 Apache + PHP，并做了一个简单的“Hello World”回显，平均响应时间为 92 毫秒（两次以上 ping）。**

有没有我想念的地方？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-15T09:35:02.290

虽然 Chrome 开发人员工具是研究前端性能的好方法，但它可以让您非常粗略地估计实际服务器时间/cpu 负载。如果您在开发工具中的总请求时间约为 350 毫秒，请从这个数字中减去 DNS 查找 + 连接 + 发送 + 接收，然后减去往返时间（90 毫秒？），然后您就有了第一个估计值。在您的情况下，我希望实际请求时间为亚毫秒。尝试在服务器上运行此代码：

```
var http = require('http');
function hrdiff(t1, t2) {
    var s = t2[0] - t1[0];
    var mms = t2[1] - t1[1];
    return s*1e9 + mms;
}
http.createServer(function(req, res) {
  var t1 = process.hrtime();
  res.writeHead(200, {'Content-Type': 'text/html'});
  res.write('Hello World');
  res.end();
  var t2 = process.hrtime();
  console.log(hrdiff(t1, t2));
}).listen(8080); 
```

根据`ab`结果​​，您应该估计平均发送+请求+接收时间最多为 4.2 毫秒（4200 毫秒/10000 请求）（您是否在服务器上运行它？什么并发？）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-22T06:47:29.547

我绝对讨厌回答自己的问题，但我想将我的发现与未来的读者分享。

**tl；博士：res.write() 有问题。使用 express.js 或 res.end()**

我刚刚通过了一系列测试。我设置了多种类型的节点服务器，并混合了 PHP 和 Nginx 之类的东西。这是我的发现。

如前所述，使用上面包含的代码段，我每请求丢失了大约 250 毫秒，但 Apache 基准测试并没有复制这些问题。然后我开始进行 PHP 测试，结果在 2 毫秒到 20 毫秒之间通过 ping... 有很大的不同。

这引发了更多的研究，我启动了一个 Nginx 服务器并通过它代理节点，不知何故，这神奇地将响应从 250 毫秒更改为 15 毫秒。我与那个 PHP 脚本相当，但这是一个非常令人困惑的结果。通常额外的跳跃会减慢速度。

很感兴趣，我也做了一个 express.js 服务器——更有趣的事情发生了，ping 本身就超过了 2 毫秒。我在源代码中挖掘了很长时间，发现它缺少`res.write()`命令，而是直接进入`res.end()`. 我启动了另一台服务器，从中删除了“Hello World”，`res.write`并将其添加到了`res.end`，令人惊讶的是，ping 比 ping 慢了 0 毫秒。

我对此进行了一些搜索，想看看这是否是一个众所周知的问题，并遇到了这个 SO question，他遇到了完全相同的问题。[nodejs响应速度和nginx](https://stackoverflow.com/questions/11335510/nodejs-response-speed-and-nginx)

总的来说，有趣的东西。确保优化您的回复并一次性发送。

祝大家好运！

# django - 将模型引用到 django-userena 中的表单字段

> ID：15422413
> 
> 赞同：0
> 
> 时间：2013-03-14T23:57:15.040
> 
> 标签：django, forms, python-2.7, models

我正在使用 django-userena 身份验证。我正在尝试将模型中的性别定义模型引用到 forms.py 中以显示在用户注册中，但它在关键字 arg 之后的非关键字 arg 处显示 SyntaxError（forms.py，第 23 行）。我不知道如何正确引用它。请帮忙！！！

模型.py：

```
class Profile(UserenaLanguageBaseProfile):
    GENDER_CHOICES = (
        (1, _('Male')),
        (2, _('Female')),
    )

    gender = models.PositiveSmallIntegerField(_('gender'),
                                              choices=GENDER_CHOICES,
                                              blank=False,
                                              null=False) 
```

表格.py：

```
from django import forms
from userena.models import UserenaLanguageBaseProfile
from accounts.models import Profile
from userena.forms import SignupForm

class SignupFormExtra(SignupForm):
    gender = forms.PositiveSmallIntegerField(label=_(u'Gender'),
                                             'gender',
                                             required=True)

    first_name = forms.CharField(label=_(u'First name'),
                                 max_length=30,
                                 required=True)

    last_name = forms.CharField(label=_(u'Last name'),
                                max_length=30,
                                required=True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:15:19.437

尝试 forms.ChoiceField [https://docs.djangoproject.com/en/dev/ref/forms/fields/#django.forms.ChoiceField](https://docs.djangoproject.com/en/dev/ref/forms/fields/#django.forms.ChoiceField)

```
class SignupFormExtra(SignupForm):
    gender = forms.ChoiceField(label=_(u'Gender'), choices=GENDER_CHOICES, default=1
                                         required=True) 
```

# javascript - 重新设计好的上传器？

> ID：15422417
> 
> 赞同：-1
> 
> 时间：2013-03-14T23:57:52.163
> 
> 标签：javascript, jquery, fine-uploader

我正在尝试使用[精细上传](https://github.com/Widen/fine-uploader)器来处理我拥有的 Web 应用程序中的一些文件上传。我想做一些重新设计，但我被困在了一些事情上。在有关重新样式化的[文档中，](http://docs.fineuploader.com/integrating/styling.html)它们具有以下行：

> **默认情况下，默认**放置区域、按钮和文件列表元素也包含在此选项中。

用 class 引用父 div `qq-uploader`。

我的问题是我是否可以将某些部分移出此 div（在本例中为文件列表元素）。他们说“默认情况下”这一事实似乎表明它可以做到，但我还没有看到任何关于如何做到这一点的文档。有没有人这样做过？有人可以指出我正确的方向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:11:51.503

我以前做过这个..但它的样式很小..

我要做的是`qq.FileUploader`在这些属性中稍作改动：

1.  `template`它定义了整个上传者的模板。
2.  `fileTemplate`它为文件列表中的一项定义模板。

我使用的是旧版本（我认为是 2.1）..

我对你的建议是打开 js 文件并查看它。它的评论很好，并且会教这个上传器是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T16:01:39.583

您可以定义一个新容器来保存文件列表，并将其放置在您想要的任何位置。查看`listElement`选项。在这种情况下可能不需要修改模板。

# java - 从表单中的 JSTL 部分检索参数

> ID：15422418
> 
> 赞同：0
> 
> 时间：2013-03-14T23:57:52.430
> 
> 标签：java, jsp, jstl

我在 JSP 中的表单中有以下代码：

```
Feedbackverantwoordelijke : 
<select name="feedbackverantwoordelijken">
    <c:forEach items="${feedbackverantwoordelijken}" var="feedbackverantwoordelijke">
        <option value="$(feedbackverantwoordelijke.id}">
        <c:out value="${feedbackverantwoordelijke.userName}" />
        </option>
    </c:forEach>
</select><br> 
```

如何从此列表中检索参数？

如果我使用：`request.getParameter("feedbackverantwoordelijke")`我得到一个 HTTP STATUS **405** – 这个 URL 不支持 HTTP 方法 POST ？？？（没有理由）

如果我使用：`request.getParameter("feedbackverantwoordelijken")`我得到字符串：`$(feedbackverantwoordelijke.id}`

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:02:26.173

通常这个错误信息意味着你的 servlet 没有`doPost()`被覆盖。

请参阅[doPost](http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpServlet.html#doPost%28javax.servlet.http.HttpServletRequest,%20javax.servlet.http.HttpServletResponse%29)文档。

仔细看看你的代码，应该

```
<option value="$(feedbackverantwoordelijke.id}">
be              |
                |
<option value="${feedbackverantwoordelijke.id}"> 
```

?

# javascript - Javascript 类中的递归调用（requestanimationframe）

> ID：15422422
> 
> 赞同：7
> 
> 时间：2013-03-14T23:58:47.500
> 
> 标签：javascript, three.js, this

我有一个简单的类，我用它来管理three.js 中的场景。我在使用 requestAnimationFrame 循环查找函数参考时遇到问题。我知道我在这里遗漏了一些基本的东西，被困在*这个*噩梦中。我是否需要使用绑定或调用将 this 引用传递给 requestAnimationFrame？

```
var THREE = THREE || {};
var SceneBuddy = SceneBuddy || {};

SceneBuddy = function(scene, camera) {
    this.scene = scene;
    this.camera = camera;
    this.sceneClock = new THREE.Clock();
    this.renderer = {};
    this.resolution = {};
    this.controls = {};
};
//Start Animate
SceneBuddy.prototype.startAnimate = function() {
    requestAnimationFrame(this.startAnimate); //this does not work, type error
    this.render.call(this);
};
//Render Function
SceneBuddy.prototype.render = function() {
    var delta = this.sceneClock.getDelta();
    this.controls.update(delta);
    this.renderer.render(this.scene,this.camera);
};

//Setup Renderer
SceneBuddy.prototype.initRenderer = function(resolution) {
    if (!Detector.webgl) {
        Detector.addGetWebGLMessage();
        return;
    }
    else {
        var renderer = new THREE.WebGLRenderer({
            antialias: true,
            preserveDrawingBuffer: true
        });
        renderer.setSize(resolution.x, resolution.y);
        renderer.shadowMapEnabled = true;
        this.resolution = resolution;
        this.renderer = renderer;
    }
}; 
```

我目前正在使用这样的 SceneBuddy：

```
 var camera = new THREE.PerspectiveCamera(75, SCREEN_WIDTH / SCREEN_HEIGHT, 1, 100000);
  var scene = new THREE.Scene();
  var sceneBuddy = new SceneBuddy(scene, camera);
  sceneBuddy.initRenderer({x: 940, y: 400});
  sceneBuddy.attachRenderer(container); //attaches renderer to dom element
  sceneBuddy.initControls();
  sceneBuddy.startAnimate(); // broken. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-15T01:29:33.733

`bind`在传递函数时使用以指定`this`调用函数时的内容：

```
SceneBuddy.prototype.startAnimate = function() {
    requestAnimationFrame(this.startAnimate.bind(this));
    this.render();
}; 
```

# c# - 带有 UI 的全局键/鼠标钩子

> ID：15422424
> 
> 赞同：0
> 
> 时间：2013-03-14T23:58:48.750
> 
> 标签：c#, user-interface, global, mouse-hook, keyhook

我想在屏幕上制作一个带有键盘和鼠标的 C# 应用程序。
每个被点击的键或按钮都应该在这个应用程序中看到，例如为其中一个键着色（我知道怎么做）。如果应用程序没有聚焦，这也应该有效。
目前我正在使用一个工作正常的全局键和鼠标钩。
问题是，Keyhook 一次只能拦截一个 Key，这意味着我一次只能在 Key 上显示。我希望能够在屏幕上一次显示多个键。不幸的是，KeyListeners 是没有选择的，因为它们不能在应用程序之外工作。有谁知道如何使这成为可能？

这是我正在使用的 KeyHook：

```
public class KeyHook
{
    private delegate int HookProc(int nCode, IntPtr wParam, IntPtr lParam);

    static int hHook = 0;

    public static List<Keys> KeyCodes = new List<Keys>();

    const int WH_KEYBOARD_LL = 13;

    HookProc KeyboardHookProcedure;

    [StructLayout(LayoutKind.Sequential)]
    private class keyboardHookStruct
    {
        public int vkCode;
        public int scanCode;
        public int flags;
        public int time;
        public int dwExtraInfo;
    }

    [DllImport("user32.dll", CharSet = CharSet.Auto,
     CallingConvention = CallingConvention.StdCall)]
    private static extern int SetWindowsHookEx(int idHook, HookProc lpfn,
    IntPtr hInstance, int threadId);

    [DllImport("user32.dll", CharSet = CharSet.Auto,
     CallingConvention = CallingConvention.StdCall)]
    private static extern bool UnhookWindowsHookEx(int idHook);

    [DllImport("user32.dll", CharSet = CharSet.Auto,
     CallingConvention = CallingConvention.StdCall)]
    private static extern int CallNextHookEx(int idHook, int nCode,
    IntPtr wParam, IntPtr lParam);

    [DllImport("kernel32.dll")]
    static extern IntPtr LoadLibrary(string lpFileName);

    public KeyHook()
    {
        Hook();
    }

    ~KeyHook()
    {
        UnHook();
    }

    public int Hook()
    {
        KeyboardHookProcedure = new HookProc(KeyHook.KeyboardHookProc);

        hHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, (IntPtr)LoadLibrary("User32"), 0);
        return hHook;
    }

    public bool UnHook()
    {
        bool ret = UnhookWindowsHookEx(hHook);
        if (ret)
            hHook = 0;
        return ret;
    }

    private static int KeyboardHookProc(int nCode, IntPtr wParam, IntPtr lParam)
    {
        if (nCode < 0)
        {
            return CallNextHookEx(hHook, nCode, wParam, lParam);
        }
        else
        {

            if (((int)wParam == 256) || ((int)wParam == 260))
            {
                keyboardHookStruct MyKeyboardHookStruct = (keyboardHookStruct)Marshal.PtrToStructure(lParam, typeof(keyboardHookStruct));
                //Adding Key to a log i use for other stuff
                KeyCodes.Add((Keys)MyKeyboardHookStruct.vkCode);
                //Code for coloring Key in the UI for pressed Key
            }
            return CallNextHookEx(hHook, nCode, wParam, lParam);
        }
    }

} 
```

# java - Java中HashMap的迭代器

> ID：15422428
> 
> 赞同：20
> 
> 时间：2013-03-14T23:59:08.163
> 
> 标签：java, map, iterator

我尝试在 Java 中迭代 hashmap，这应该是一件相当容易的事情。但是，以下代码给我带来了一些问题：

```
HashMap hm = new HashMap();

hm.put(0, "zero");
hm.put(1, "one");

Iterator iter = (Iterator) hm.keySet().iterator();

while(iter.hasNext()) {

    Map.Entry entry = (Map.Entry) iter.next();
    System.out.println(entry.getKey() + " - " + entry.getValue());

} 
```

首先，我需要在 hm.keySet().iterator() 上强制转换 Iterator，否则会显示“类型不匹配：无法从 java.util.Iterator 转换为 Iterator”。但后来我得到“方法 hasNext() 对于迭代器类型未定义”，并且“方法 hasNext() 对于迭代器类型未定义”。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-03-15T00:05:58.790

我们可以看看你的`import`街区吗？因为您似乎导入了错误的`Iterator`类。

你应该使用的是`java.util.Iterator`

为确保，请尝试：

```
java.util.Iterator iter = hm.keySet().iterator(); 
```

* * *

**我个人建议如下：**

[`Generics`](http://docs.oracle.com/javase/tutorial/extra/generics/index.html)使用接口的映射声明和声明使用`Map<K,V>`所需的实现创建实例`HashMap<K,V>`

```
Map<Integer, String> hm = new HashMap<>(); 
```

和循环：

```
for (Integer key : hm.keySet()) {
    System.out.println("Key = " + key + " - " + hm.get(key));
} 
```

**2015 年 3 月 5 日**更新****

 **发现迭代 Entry 集将获得更好的性能：

```
for (Map.Entry<Integer, String> entry : hm.entrySet()) {
    Integer key = entry.getKey();
    String value = entry.getValue();

} 
```

**2017 年 10 月 3 日**更新****

 **对于 Java8 和流，您的解决方案将是（感谢@Shihe Zhang）

```
 hm.forEach((key, value) -> System.out.println(key + ": " + value)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-15T00:05:03.130

你真的应该为此使用泛型和增强的 for 循环：

```
Map<Integer, String> hm = new HashMap<>();
hm.put(0, "zero");
hm.put(1, "one");

for (Integer key : hm.keySet()) {
    System.out.println(key);
    System.out.println(hm.get(key));
} 
```

[http://ideone.com/sx3F0K](http://ideone.com/sx3F0K)

或`entrySet()`版本：

```
Map<Integer, String> hm = new HashMap<>();
hm.put(0, "zero");
hm.put(1, "one");

for (Map.Entry<Integer, String> e : hm.entrySet()) {
    System.out.println(e.getKey());
    System.out.println(e.getValue());
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-02T20:10:09.563

使用 Java 8：

```
hm.forEach((k, v) -> {
    System.out.println("Key = " + k + " - " + v);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T00:09:12.077

最干净的方法是根本不（直接）使用迭代器：

*   用泛型输入你的地图
*   使用 foreach 循环遍历条目：

像这样：

```
Map<Integer, String> hm = new HashMap<Integer, String>();

hm.put(0, "zero");
hm.put(1, "one");

for (Map.Entry<Integer, String> entry : hm.entrySet()) {
    // do something with the entry
    System.out.println(entry.getKey() + " - " + entry.getValue());
    // the getters are typed:
    Integer key = entry.getKey();
    String value = entry.getValue();
} 
```

这比遍历键更有效，因为您避免了 n 次调用`get(key)`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T00:10:13.370

这里有几个问题：

*   您可能没有使用正确的迭代器类。正如其他人所说，使用`import java.util.Iterator`
*   如果你想使用，`Map.Entry entry = (Map.Entry) iter.next();`那么你需要使用`hm.entrySet().iterator()`，而不是`hm.keySet().iterator()`。要么迭代键，要么迭代条目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T00:44:15.013

```
Map<String, Car> carMap = new HashMap<String, Car>(16, (float) 0.75); 
```

// Maps 没有迭代器，但是有方法可以做到这一点。

```
 Set<String> keys = carMap.keySet(); // returns a set containing all the keys
        for(String c : keys)
        {

            System.out.println(c);
        }

        Collection<Car> values = carMap.values(); // returns a Collection with all the objects
        for(Car c : values)
        {
            System.out.println(c.getDiscription());
        }
        /*keySet and the values methods serve as “views” into the Map.
          The elements in the set and collection are merely references to the entries in the map, 
          so any changes made to the elements in the set or collection are reflected in the map, and vice versa.*/

        //////////////////////////////////////////////////////////
        /*The entrySet method returns a Set of Map.Entry objects. 
          Entry is an inner interface in the Map interface.
          Two of the methods specified by Map.Entry are getKey and getValue.
          The getKey method returns the key and getValue returns the value.*/

        Set<Map.Entry<String, Car>> cars = carMap.entrySet(); 
        for(Map.Entry<String, Car> e : cars)
        {
            System.out.println("Keys = " + e.getKey());
            System.out.println("Values = " + e.getValue().getDiscription() + "\n");

        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-21T15:33:23.580

您在 HashMap 上获得了一个 keySet 迭代器，并期望迭代条目。

**正确代码：**

```
 HashMap hm = new HashMap();

    hm.put(0, "zero");
    hm.put(1, "one");

    //Here we get the keyset iterator not the Entry iterator
    Iterator iter = (Iterator) hm.keySet().iterator();

    while(iter.hasNext()) {

        //iterator's next() return an Integer that is the key
        Integer key = (Integer) iter.next();
        //already have the key, now get the value using get() method
        System.out.println(key + " - " + hm.get(key));

    } 
```

**使用 EntrySet 遍历 HashMap：**

```
 HashMap hm = new HashMap();
     hm.put(0, "zero");
     hm.put(1, "one");
     //Here we get the iterator on the entrySet
     Iterator iter = (Iterator) hm.entrySet().iterator();

     //Traversing using iterator on entry set  
     while (iter.hasNext()) {  
         Entry<Integer,String> entry = (Entry<Integer,String>) iter.next();  
         System.out.println("Key = " + entry.getKey() + ", Value = " + entry.getValue());  
     }  

     System.out.println();

    //Iterating using for-each construct on Entry Set
    Set<Entry<Integer, String>> entrySet = hm.entrySet();
    for (Entry<Integer, String> entry : entrySet) {  
        System.out.println("Key = " + entry.getKey() + ", Value = " + entry.getValue());  
    } 
```

查看以下链接中的部分 -**遍历 HashMap**。 [java-collection-internal-hashmap和遍历HashMap](http://www.techmastertutorial.in/java-collection-internal-hashmap.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-27T17:01:47.527

1.  使用 EntrySet() 并为每个循环

    ```
     for(Map.Entry<String, String> entry: hashMap.entrySet()) {
         System.out.println("Key Of map = "+ entry.getKey() + 
                          " , value of map = " + entry.getValue() );
     } 
    ```

2.  使用 keyset() 并为每个循环

    ```
     for(String key : hashMap.keySet()) {
                System.out.println("Key Of map = "+ key + " , 
                          value of map = " + hashMap.get(key) );
               } 
    ```

3.  使用 EntrySet() 和 java 迭代器

    ```
     for(String key : hashMap.keySet()) {
            System.out.println("Key Of map = "+ key + " , 
                          value of map = " + hashMap.get(key) );
            } 
    ```

4.  使用 keyset() 和 java 迭代器

    ```
     Iterator<String> keysIterator = keySet.iterator();
        while (keysIterator.hasNext()) {
            String key = keysIterator.next();
            System.out.println("Key Of map = "+ key + " , value of map = " + hashMap.get(key) );
       } 
    ```

**参考**： **[如何在 Java 中迭代 Map 或 HashMap](https://www.javavogue.com/2015/06/how-to-iterate-through-hashmap.html/)**

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-08-25T14:48:55.920

迭代器通过`keySet`将为您提供密钥。`entrySet`如果你想迭代条目，你应该使用。

```
HashMap hm = new HashMap();

hm.put(0, "zero");
hm.put(1, "one");

Iterator iter = (Iterator) hm.entrySet().iterator();

while(iter.hasNext()) {

    Map.Entry entry = (Map.Entry) iter.next();
    System.out.println(entry.getKey() + " - " + entry.getValue());

} 
```****

# ios - 获取当前在“设置”中启用的键盘？

> ID：15422433
> 
> 赞同：4
> 
> 时间：2013-03-14T23:59:48.930
> 
> 标签：ios, cocoa-touch, social-networking, weibo, sinaweibo

有什么方法可以识别在“设置”中启用了哪些键盘？

只有在启用了中文键盘的情况下才能分享到新浪微博，所以我只想在有中文键盘的情况下显示“新浪微博”操作表按钮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T01:04:27.983

感谢 Guy 的评论，有更好的方法来做到这一点。我已经更新了自己的代码以使用以下内容：

```
NSArray *keyboards = [UITextInputMode activeInputModes];
for (UITextInputMode *mode in keyboards) {
    NSString *name = mode.primaryLanguage;
    if ([name hasPrefix:@"zh-Han"]) {
        // One of the Chinese keyboards is installed
        break;
    }
} 
```

斯威夫特：（**注意**：在 iOS 9.x[下](https://stackoverflow.com/a/32708052/1226963)由于`UITextInputMode activeInputModes`.

```
let keyboards = UITextInputMode.activeInputModes()
for var mode in keyboards  {
    var primary = mode.primaryLanguage
    if let lang = primary {
        if lang.hasPrefix("zh") {
            // One of the Chinese keyboards is installed
            break
        }
    }
} 
```

* * *

旧方法：

我不知道在 App Store 应用程序中是否允许这样做，但你可以这样做：

```
NSArray *keyboards = [[NSUserDefaults standardUserDefaults] objectForKey:@"AppleKeyboards"];
for (NSString *keyboard in keyboards) {
    if ([keyboard hasPrefix:@"zh_Han"]) {
        // One of the Chinese keyboards is installed
    }
} 
```

如果用户只有其语言环境的默认键盘，则可能没有该`AppleKeyboards`键的条目。在这种情况下，您可能需要检查用户的语言环境。如果语言环境是针对中国的，那么您应该假设他们有中文键盘。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-12-14T13:04:36.813

**此代码对我在父应用程序本身的设备设置中识别键盘扩展是否已激活非常有帮助：**

```
 //Put below function in app delegate...

    public func isKeyboardExtensionEnabled() -> Bool {
        guard let appBundleIdentifier = NSBundle.mainBundle().bundleIdentifier else {
            fatalError("isKeyboardExtensionEnabled(): Cannot retrieve bundle identifier.")
        }

        guard let keyboards = NSUserDefaults.standardUserDefaults().dictionaryRepresentation()["AppleKeyboards"] as? [String] else {
            // There is no key `AppleKeyboards` in NSUserDefaults. That happens sometimes.
            return false
        }

        let keyboardExtensionBundleIdentifierPrefix = appBundleIdentifier + "."
        for keyboard in keyboards {
            if keyboard.hasPrefix(keyboardExtensionBundleIdentifierPrefix) {
                return true
            }
        }

        return false
    }

    // Call it from below delegate method to identify...

    func applicationWillEnterForeground(_ application: UIApplication) {

            if(isKeyboardExtensionEnabled()){            
                showAlert(message: "Hurrey! My-Keyboard is activated");
            }
            else{
                showAlert(message: "Please activate My-Keyboard!");
            }

        }

    func applicationDidBecomeActive(_ application: UIApplication) {

            if(isKeyboardExtensionEnabled()){            
                showAlert(message: "Hurrey! My-Keyboard is activated");
            }
            else{
                showAlert(message: "Please activate My-Keyboard!");
            }
        } 
```

# c# - 我无法将序列化的字符串粘贴到 .txt 并取消序列化以检索原始值

> ID：15422436
> 
> 赞同：0
> 
> 时间：2013-03-15T00:00:10.887
> 
> 标签：c#, serialization, deserialization

由于我以前从未进行过序列化，因此在弄清楚如何执行此操作时遇到了一些麻烦。我能够将字符串转换为 byte[]s，然后将它们序列化为新字符串，但无法将该序列化字符串保存到文本文件中，重新导入并将其转换回原始值。请记住，这是一个学习项目。这就是我到目前为止所做的

```
private string SerializeToString(string obj)
    {
        if (obj == null)
            return null;

        System.Runtime.Serialization.Formatters.Binary.BinaryFormatter bf = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
        MemoryStream ms = new MemoryStream();
        bf.Serialize(ms, obj);
        byte[] Array = ms.ToArray();
//This is where I create the txt file and write to it
            File.OpenWrite(Environment.GetFolderPath(Environment.SpecialFolder.Desktop)     + "\\Text.txt")
            .Write(Array, 0, Array.Length);

        ms.Close();
        return Convert.ToBase64String(Array);
    }

        private void txtCheck_Click(object sender, RoutedEventArgs e)
    {
//I uploaded the file to drop box and can successfully download it but can not figure out
//how to get the original value out of it..
        string Url = "http://dl.dropbox.com/u/62170850/Text.txt";
        WebClient webClient = new WebClient();
        //webClient.DownloadFileCompleted += new AsyncCompletedEventHandler(Completed);
        //webClient.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChanged);
        byte[] myDataBuffer = webClient.DownloadData(new Uri(Url));
        string s = Convert.ToBase64String(myDataBuffer);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:02:20.597

使用[webClient.DownloadString](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadstring.aspx)并且不要忘记`FromBase64String`在反序列化之前通过调用将下载的字符串转换回字节数组。

# qt - 更改按钮文本时如何自动更改 QPushButton 宽度和 QMenuBar 角小部件宽度？

> ID：15422439
> 
> 赞同：1
> 
> 时间：2013-03-15T00:00:35.433
> 
> 标签：qt, qt5, qpushbutton, qmenubar

我将角小部件设置为具有两个 QPushButtons 的 QMenuBar。但是当我通过按钮的 setText 设置长文本时，按钮不会改变它的权重，因此，图标和部分文本隐藏。那么，如何在设置文本时更改按钮的宽度和角小部件的宽度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-12T23:01:01.603

`menuBar()->adjustSize();`设置按钮上的文字后调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:21:00.560

我通过在更改按钮文本后再次将相同的角小部件设置到 QMenuBar 来解决它。

# javascript - 正确构建我的 jquery/javascript

> ID：15422442
> 
> 赞同：0
> 
> 时间：2013-03-15T00:00:52.430
> 
> 标签：javascript, jquery, asp.net-mvc

这些天来，我发现自己将很多代码放在我觉得`$(document).ready()`不干净的地方。例如，如果我正在创建将通过 ajax 查询我的数据库并将其返回并将其附加到我的列表的内容，我会执行以下操作：

```
$(function(){
   //Initialize my DOM elements
   $MyList = $("#MyList"),
   $MyButton = $("#MyButton");

   //Add my Click event
   $MyButton.click(function(){
      $.ajax({
         type: 'POST',
         url: "/lists/getmylist",
         contentType: "application/json",
         success: function(results){
            //Parse my results and append them using my favorite templating helper
            var jsonResults = $.parseJSON(result);
            $MyList.mustache("my-template", jsonResults);
         }
      });
   })
}); 
```

现在我知道这是一个小例子，但是当我有多个点击事件、ajax 请求等时它开始变得非常大和混乱。这一切最终都在我的文档中准备好了。我知道我可以将我所有的 ajax 请求放在一个外部 javascript 文件中以帮助使其更干净，但是这种架构通常可以吗？看起来它真的很乱。我见过其他人使用插件架构或初始化函数。我通常在我所有页面的底部准备好这个文档，然后放入使我的页面正常工作所需的任何内容。这是构建我的js的好方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:07:45.253

我认为添加一些模型对象和一般的面向对象编程原则可能会在这里大有帮助。如果您将数据获取和存储中断到模型类中，它应该会有很大帮助。

这里有一些链接可以让你开始思考 OO 与 Javascript。

[编写面向对象的 JavaScript](http://www.codeproject.com/Articles/5608/Writing-Object-Oriented-JavaScript-Part-1)

[Javascript 设计模式](http://addyosmani.com/resources/essentialjsdesignpatterns/book/)

[Javascript：原型继承](http://beej.us/blog/data/javascript-prototypes-inheritance/) [Javascript：原型继承 2](https://stackoverflow.com/questions/892595/javascript-prototypal-inheritance)

另一件可能会有所帮助的事情是将 Javascript 分解为多个文件。一个用于全局脚本，可能通过附加到所有页面的标题和需要它的每个页面的脚本包含在内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T14:42:55.273

也许[Backbone.js](http://backbonejs.org/)（或其他[框架](http://addyosmani.github.com/todomvc/)之一）可能是您正在寻找的救援的一部分。

我发现 Backbone 对组织一些继承的意大利面非常有帮助。您的出发点可能是将准备好的大量文档转换为主干视图（或多个）

通过将视图、集合、模型分离到单独的文件中来组织脚本，然后将它们捆绑并压缩到一个文件中，这样浏览器只需要发出一个请求而不是多个请求。

ASP.NET MVC4 可以为你做[捆绑](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)，它也可以在 MVC3 上类似地工作

这只是一个简单起点的示例，还有更高级的技术（例如 AMD、require.js）来减少每页的脚本大小，但是通过缓存和 gzip，我发现单个 Everything 脚本包非常适合的案例。

至于您的示例，这是一个可能的主干实现

请记住命名您的代码...

```
var app = app || {};

$(function ($) {

// depending on your server setup you might be able to just override the url
// and get away with what you want. Otherwise you might look into overriding
// the save/fetch or sync methods of the collection
app.MyListCollection = Backbone.Collection.extend({
    url: '/lists/getmylist'

});

app.MyListView = Backbone.View.extend({

//bind the view to the existing element in the HTML.
    el: '#MyList',

    // your mustache template 
    template:$('#list-template').html(),

    // hook up your event handlers to page components
//(within the context of your el)
    events: {
        'click #MyButton': 'onMyButtonClick'
    },

    //called on object creation.
    initialize: function () {

//you could create a collection here or pass it into the init function
        this.collection = new app.MyListCollection();

        //when the collection is changes, call the render method
        this.listenTo(this.collection, 'reset', this.render);
    },
    // render is named by convention, but its where you would "redraw" your view and apply your template
    render: function () {

    this.$el.html(
        Mustache.render(
            this.template(this.collection.toJSON())));

        return this;
    },

    //your click handler
    onMyButtonClick: function(e){
        this.collection.fetch();
    }

});
}); 
```

使用您的文档准备好启动您需要的任何主干功能，并使用它使用您可能拥有的任何服务器端数据引导您的 JavaScript。

```
$(function () {

// create an instance of your view
new app.MyListView();

//example bootstrap using razor
app.title = @Model.Title;
}); 
```

# ruby-on-rails-3.2 - ElasticSearch 与 ThinkingSphinx 的替代语法

> ID：15422443
> 
> 赞同：0
> 
> 时间：2013-03-15T00:00:52.523
> 
> 标签：ruby-on-rails-3.2, elasticsearch, thinking-sphinx, tire

请看下面的代码，它是正常的索引语句`thinking sphinx`

```
indexes owned_tags.name, :as => :owned_tag_names
has owned_tags.id, :as => :owned_tag_ids, :facet => true 
```

任何人都可以指导在中具有相同索引的语法是`ElasticSearch`什么？

我试过了。

```
tire.mapping do
  indexes :owned_tag_names, type: 'array', analyzer: :ngram_analyzer, index_name: 'tag'
  indexes :owned_tag_ids,   type: 'array'
end

def to_indexed_json
{
    owned_tag_names: owned_tags.collect(&:name),
    owned_tag_ids: owned_tags.collect(&:id)
}.to_json
end 
```

它给了我错误：

```
400 : {"error":"MapperParsingException[mapping [user]]; nested: MapperParsingException[No handler for type [array] declared on field [owned_tag_ids]]; ","status":400} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T08:08:49.310

[正如文档](http://www.elasticsearch.org/guide/reference/mapping/array-type.html)所建议的，使用该`string`类型来定义数组的映射：

```
tire.mapping do
  indexes :owned_tag_names, type: 'string', analyzer: :ngram_analyzer, index_name: 'tag'
  indexes :owned_tag_ids,   type: 'string'
end 
```

请注意，您可以使用以下选项在`mapping`块中定义 JSON 序列化：`as`

```
tire.mapping do
  indexes :owned_tag_names,
          type: 'array',
          analyzer: :ngram_analyzer,
          index_name: 'tag',
          as: proc { owned_tags.collect(&:name) }

  indexes :owned_tag_ids,
          type: 'array',
          as: proc { owned_tags.collect(&:id) }
end 
```

# javascript - 父宽度的左动画帐户

> ID：15422447
> 
> 赞同：0
> 
> 时间：2013-03-15T00:01:06.177
> 
> 标签：javascript, jquery, animation, jquery-animate

我正在玩一个简单的动画，它从父元素后面滑动内容。问题是我不确定在哪里解释父母的宽度。我试图把它放在语句的 else 部分，但如果我这样做了，那么动画只运行一次，我在哪里制作它，所以当动画完成时，孩子不会躲在父母身后？

[JSFiddle](http://jsfiddle.net/NwJTU/1/)

HTML

```
<div id="slideContainer">
    <a href="#">Start Slide</a>
    <div id="slide">
        This is More Content!
    </div>
</div> 
```

CSS

```
#slideContainer{
    position: relative;
    width: 500px;
    overflow:hidden;
}
#slideContainer a{
    display:block;
    background-color: beige;
    width:50px;
    height: 50px;
    float: left;
    position: relative;
    z-index: 1;
}
#slide{
    width: 200px;
    height: 50px;
    background-color: beige;
    position: absolute;
    left: -500px;
} 
```

jQuery

```
$(document).ready(function(){
    $('#slideContainer a').click(function() {
        var lefty = $(this).next();
        lefty.animate({
          left: parseInt(lefty.css('left'),10) == 0 ?
            -lefty.width() :
            100
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T05:13:08.750

只需将比较值更改为`0`您想要使用的任何值（例如 100 或 50）。

```
left: parseInt(lefty.css('left'),10) == 50 ?
-lefty.width() :
50 
```

[http://jsfiddle.net/ExplosionPIlls/NwJTU/2/](http://jsfiddle.net/ExplosionPIlls/NwJTU/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T08:30:26.763

试试这个[小提琴](http://jsfiddle.net/NwJTU/5/)。

我曾经`.toggleClass`添加/删除类“关闭”。并使用jQuery`.hasClass`来决定动画。

# c++ - 我的 boolinq .orderBy 有什么问题？

> ID：15422449
> 
> 赞同：1
> 
> 时间：2013-03-15T00:01:14.263
> 
> 标签：c++, linq, stl, c++11

所以我尝试下一个可编译的代码：

```
#include <math.h> 
#include <iostream> 
#include <algorithm>
#include <vector>   
#include "boolinq.h"

float dtSqrt(float x)
{
    return sqrtf(x);
}

/// Returns the distance between two points.
///  @param[in]     v1  A point. [(x, y, z)]
///  @param[in]     v2  A point. [(x, y, z)]
/// @return The distance between the two points.
inline float dtVdist(const float* v1, const float* v2)
{
    const float dx = v2[0] - v1[0];
    const float dy = v2[1] - v1[1];
    const float dz = v2[2] - v1[2];
    return dtSqrt(dx*dx + dy*dy + dz*dz);
}

int main () {
    float target[] = {1,2,3};

    float floats1[] = {1.321f,2.123f,3.333f};
    float floats2[] = {1.011f,2.234f,3.555f};
    float floats3[] = {1.9f,2.9f,3.9f};
    float floats4[] = {1,2,3};
    float floats5[] = {1,2,3.123f};

    std::vector<const float *> floatsVector;
    floatsVector.push_back(floats1);
    floatsVector.push_back(floats2);
    floatsVector.push_back(floats3);
    floatsVector.push_back(floats4);
    floatsVector.push_back(floats5);

    //stl way
    //std::sort(floatsVector.begin(), floatsVector.end(),  [&](const float* pointA, const float* pointB) -> bool{
    //  auto distA =  dtVdist(pointA, target);
    //  auto distB =  dtVdist(pointB, target);
    //  return distA < distB;
    //});
    // auto stl_point = floatsVector.front();

    try {
        auto point = boolinq::from( floatsVector )
            .orderBy([&](const float* point) -> float{
                auto dist =  dtVdist(point, target);
                return dist;
        })
            .reverse()
            .toVector()
            .front();

        std::cout << point[0] << " " << point[1] << " " << point[2] << ";" << std::endl;

    } catch (std::exception &e) {
        std::cout << e.what() << std::endl;
    }
    std::cin.get();
    return 0;
} 
```

有[boolinq 头](https://code.google.com/p/boolinq/)这个程序编译得非常快。然而，它失败***了！***在运行时出现一些内部向量断言错误：

![在此处输入图像描述](../Images/ba5283f70041ea138d79b6e1b506c4fd.png)

问题是：

```
 boolinq::from( floatsVector )
                .orderBy([&](const float* point) -> float{
                    auto dist =  dtVdist(point, target);
                    return dist;
            }).toVector(); 
```

是空向量。

取消注释 stl 代码使程序按预期工作！

更简单的点重新排序使其按预期工作：

```
float floats1[] = {1,2,3};
float floats2[] = {1,2,3.123f};
float floats3[] = {1.321f,2.123f,3.333f};
float floats4[] = {1.011f,2.234f,3.555f};
float floats5[] = {1.9f,2.9f,3.9f}; 
```

一个非常奇怪的错误...

顺便说一句，下一个代码：

```
#include <math.h> 
#include <iostream> 
#include <algorithm>
#include <vector>   
#include "boolinq/boolinq.h"

struct Point {
    float X;
    float Y;
    float Z;
    Point() : X(0), Y(0), Z(0) {}
    Point(float X, float Y, float Z) : X(X), Y(Y), Z(Z) {}
};

float dtSqrt(float x)
{
    return sqrtf(x);
}

inline float dtVdist(const float* v1, const float* v2)
{
    const float dx = v2[0] - v1[0];
    const float dy = v2[1] - v1[1];
    const float dz = v2[2] - v1[2];
    return dtSqrt(dx*dx + dy*dy + dz*dz);
}

inline float dtVSqrDist(const Point & v1, const Point & v2)
{
    const float dx = v2.X - v1.X;
    const float dy = v2.Y - v1.Y;
    const float dz = v2.Z - v1.Z;
    return dx*dx + dy*dy + dz*dz;
}

int main () {
    auto target = Point(1,2,3);
    auto pointA = Point(1,-2,3);
    auto pointB = Point(1,2,3);

    std::vector<Point> pointsVector;
    pointsVector.push_back(pointA);
    pointsVector.push_back(pointB);

    //stl way
    std::sort(pointsVector.begin(), pointsVector.end(),
        [&](const Point & pointA, const Point & pointB) -> bool{
            auto distA =  dtVSqrDist(pointA, target);
            auto distB =  dtVSqrDist(pointB, target);
            return distA < distB;
    });
    std::reverse(pointsVector.begin(), pointsVector.end());
    auto stl_point = pointsVector.front();

    std::cout << "stl point: " << stl_point.X << " " << stl_point.Y << " " << stl_point.Z << ";" << std::endl;

    //try {

    auto points = boolinq::from( pointsVector )
        .orderBy([&](const Point & point) -> float{
            auto dist =  dtVSqrDist(point, target);
            return dist;
    })
        .reverse()
        .toVector();

    auto point = points.empty() ? Point() : points.front();

    std::cout << "boolinq point: " << point.X << " " << point.Y << " " << point.Z << ";" << std::endl;

    //} catch (std::exception &e) {
    //  std::cout << e.what() << std::endl;
    //}
    std::cin.get();
    return 0;
} 
```

产生：

```
stl point: 1 -2 3;
boolinq point: 0 0 0; 
```

我的代码有什么问题？它看起来像在[主 boolinq 页面](https://code.google.com/p/boolinq/)上提供的 orderBy 示例...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T20:47:15.730

显然 boolinq 不支持 .orderBy().reverse() - 这有点令人担忧，当然。如果您按负距离排序（没有反向），它可以工作。

对我来说，这看起来像 boolinq 还没有准备好认真使用。

# jquery - 自定义 jQuery UI 日期选择器以限制日期

> ID：15422450
> 
> 赞同：0
> 
> 时间：2013-03-15T00:01:16.393
> 
> 标签：jquery, jquery-ui

我使用 jQuery UI 制作了一个自定义日期选择器：http: [//jsfiddle.net/u8fVj/](http://jsfiddle.net/u8fVj/)

```
$("#input_custom_date").datepicker({
numberOfMonths: 2,
beforeShowDay: function(date) {
    //Get today's date
    var today = new Date();
    today.setHours(0,0,0,0);

    if (today.getDay() == 4 || today.getDay() == 5 || today.getDay() == 6) {
        //If today is Wednesday, Thursday, Friday don't allow Sunday to be selectable until the next week on Sunday.
        var disabledDate = new Date(today||new Date());
        disabledDate.setDate(disabledDate.getDate() + (0 - 1 - disabledDate.getDay() + 7) % 7 + 1);
        return [(date > today && date.getDay() == 0 && date.toString() != disabledDate.toString()), ''];
    }else if(today.getDay() == 0){
        //If today is Sunday, don't allow today to be selectable.
        var disabledDate = today;
        var curr_date = date.getDate();
        var curr_month = date.getMonth();
        var curr_year = date.getFullYear();
        var dDate = new Date(curr_year, curr_month, curr_date);
        return [(date > today && date.getDay() == 0 && dDate.toString() != disabledDate.toString()), ''];
    }else{
        //Everything is fine, allow all Sundays to be selectable
        var day = date.getDay();
        return [(date > today && day == 0), ''];
    }
}

}); 
```

现在用户应该只能选择星期天的日期。它需要检查今天的日期是否是即将到来的星期日之前的星期三、星期四或星期五，如果是，则日期选择器应禁用即将到来的星期日。同样，如果今天的日期是星期天，它应该在日期选择器中禁用今天。

但是，我需要更改日期选择器以仅允许选择星期一和星期二，而不是只选择星期日。如果今天的日期是星期四、星期五或星期六，它应该禁用即将到来的星期一和星期二。如果今天是星期一，则应禁用本周的星期一和星期二。如果今天的日期是星期二，它应该只禁用今天的日期。

此外，我需要能够输入要禁用的假期的特定日期，这可能是硬编码的。

不知道如何超越我现在所拥有的，并希望得到任何帮助。我一直在努力让它发挥作用，但无法解决逻辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:20:37.360

您基本上只需将`.getDay() == 0`支票移至`.getDay() == 1 || .getDay() == 2`, 1 和 2 即为星期一和星期二。需要进行类似的比较`disableDate`

```
disabledDate.setDate(disabledDate.getDate() + (1 - 1 - disabledDate.getDay() + 7) % 7 + 1); 
```

`0 - 1`更改为（`1 - 1`不需要，但为了清楚起见）以获取星期一。 `2 - 1`周二收益率。

至于处理特殊日期，您可以将它们存储在`<ul hidden>`DOM 中并首先检查它们：

```
beforeShowDay: function(date) {
    //Get today's date
    var today = new Date(), specialDate = false;
    today.setHours(0,0,0,0);

    $(".special-dates li").each(function () {
        if ($(this).text() == today.toString()) {
            specialDate = true;
            return false;
        }
    });
    if (specialDate) {
        return [true, ''];
    } 
```

[http://jsfiddle.net/ExplosionPIlls/u8fVj/1/](http://jsfiddle.net/ExplosionPIlls/u8fVj/1/)

# meteor - 检测触发了哪个响应式查询

> ID：15422456
> 
> 赞同：13
> 
> 时间：2013-03-15T00:01:45.487
> 
> 标签：meteor

我有一个复杂的流星应用程序可能不是那么独特的问题。

我有几个操作会导致页面的某些部分刷新，而这些操作实际上是不需要的。但是我很难找到哪个 find() （或多个 find()'s ）是被触发的。我知道有问题的集合，只是不知道哪个 find()。

我可以在我使用的每个查找上使用 observeChanges，但这将是很多额外的代码。

有没有一种简单的方法可以查看触发了什么以及触发了什么？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-16T01:30:25.860

Here is a render logging function you might find useful. It logs the number of times each template is rendered to the console. You know if a template is re-rendered after initial page load, it's because a reactive data source that it relies on has changed. Either this reactive data source could have been accessed in a helper method, or the template is a list item (i.e. inside an `{{#each ...}}` block helper) and a list item was added/moved/removed/changed. Also keep in mind that child templates call their parent's rendered callback when the child is rendered or re-rendered. So, this might confuse you into thinking the parent has actually been taken off the DOM and put back, but that's not true.

So, you can call this function at the end of your client code to see the render counts:

```
 function logRenders () {
    _.each(Template, function (template, name) {
      var oldRender = template.rendered;
      var counter = 0;

      template.rendered = function () {
        console.log(name, "render count: ", ++counter);
        oldRender && oldRender.apply(this, arguments);
      };
    });
  } 
```

**EDIT**: Here is a way to wrap the find cursor to log all changes to a cursor to the console. I just wrote a similar function to this for a new package I'm working on called reactive-vision. Hopefully released soon.

```
var wrappedFind = Meteor.Collection.prototype.find;

Meteor.Collection.prototype.find = function () {
  var cursor = wrappedFind.apply(this, arguments);
  var collectionName = this._name;

  cursor.observeChanges({
    added: function (id, fields) {
      console.log(collectionName, 'added', id, fields);
    },

    changed: function (id, fields) {
      console.log(collectionName, 'changed', id, fields);
    },

    movedBefore: function (id, before) {
      console.log(collectionName, 'movedBefore', id, before);
    },

    removed: function (id) {
      console.log(collectionName, 'removed', id);
    }
  });

  return cursor;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-08T00:43:41.173

谢谢@cmather 的想法。

她是`Meteor 1.3`改编和更高级的版本`logRenders`

```
// Log all rendered templates
// If filter is set, only templates in filter will be logged
// @params filter - name or names of template to filter
logRenders = function logRenders (filter) {
  for (name in Object(Template)){
    if (filter && !Array.isArray(filter)) filter = [filter];
    var template = Template[name];
    if (!template) continue;
    if (filter && filter.indexOf(name) == -1){
      // Clear previous logRenders
      if ('oldRender' in template) template.rendered = template.oldRender;
      delete template.oldRender;
      continue;
    }
    var t = function(name, template){
      if (!('oldRender' in template)) template.oldRender = template.rendered;
      var counter = 0;
      template.rendered = function () {
        console.log(name, ++counter, this);
        this.oldRender && this.oldRender.apply(this, arguments);
      };
    }(name, template);
  };
}; 
```

# ios - UITextField 不会将文本保存到 CoreData

> ID：15422457
> 
> 赞同：0
> 
> 时间：2013-03-15T00:01:56.283
> 
> 标签：ios, objective-c, core-data, uitextfield

此 UITextField 以编程方式创建并驻留在自定义 UITableViewCell 中。UITableViewCell 也是 UITextField 的委托并实现`<UITextFieldDelegate>`协议。一切似乎都工作正常，除了当我重新加载应用程序时，CoreData 中没有保存任何文本。我试图让 TableViewController 成为这个类的委托，但它似乎不起作用，事实上，应用程序崩溃了一个无法识别的选择器发送到实例错误。

这是我的`textFieldDidEndEditing`方法的代码：

```
- (void)textFieldDidEndEditing:(UITextField *)textField {

    Parts *item ; // the NSManagedObject

    item.itemTitle = _itemLabel.text; //_itemLabel is a custom UITextField Class, and itemTitle is a string attribute of the NSManagedObject

    NSError *error;
    [item.managedObjectContext save:&error];
    if (error) {
        // Replace this implementation with code to handle the error appropriately.
        // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development.
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

} 
```

`init`这是创建 UITextField的自定义方法的一部分：

```
_itemLabel = [[TehdaLabel alloc] initWithFrame:CGRectNull];
    _itemLabel.textColor = [UIColor blackColor];
    _itemLabel.font = [UIFont fontWithName:@"Helvetica" size:12];
    _itemLabel.backgroundColor = [UIColor clearColor];
    _itemLabel.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
    _itemLabel.returnKeyType = UIReturnKeyDone;
    _itemLabel.placeholder = @"Type some stuff here!";
    _itemLabel.delegate = self;
    [self addSubview:_itemLabel]; 
```

其他一切正常，将文本保存在 CoreData 中只是拒绝为我工作。

编辑：`insertObject`我的 TableViewController 中的方法

```
NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];
Parts *item = [NSEntityDescription insertNewObjectForEntityForName:@"Parts" inManagedObjectContext:context];

    MCSwipeTableViewCell *editCell;
    for (MCSwipeTableViewCell *cell in [self.tableView visibleCells]){
        if (cell.itemLabel.text == item.itemTitle) {
        //if (cell.itemLabel.text == item.itemTitle) {
            editCell = cell;
            break;
        }
    }
    editCell.itemLabel.text = item.itemTitle;
    [editCell.itemLabel becomeFirstResponder];

    [item setValue:[NSDate date] forKey:@"itemDate"];

    // Save the context.
    NSError *error = nil;
    if (![context save:&error]) {
         // Replace this implementation with code to handle the error appropriately.
         // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:14:43.110

您没有将实体“零件”插入 CoreData。

```
Parts *item = [NSEntityDescription insertNewObjectForEntityForName:@"Parts"
                                              inManagedObjectContext:managedObjectContext]; 
```

现在它将保存它...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:10:56.693

您没有初始化项目，它是一个 nil 对象。

# c# - 使用 DI 创建带有上下文的插件实例

> ID：15422461
> 
> 赞同：2
> 
> 时间：2013-03-15T00:02:22.990
> 
> 标签：c#, plugins, dependency-injection, simple-injector

我正在重构我们的应用程序以包含依赖注入（通过构造函数注入）并且遇到了一个棘手的极端情况：

我们目前有一些`ImageViewer`对象，在实例化时会在程序集中搜索`ImageViewerPlugin`（抽象基类）实例，并使用反射实例化它们。这是在`ImageViewer`使用方法的构造函数中完成的（在所有具体插件类型的循环中调用），类似于：

```
private ImageViewerPlugin LoadPlugin(Type concretePluginType)
{
  var pluginConstructor = concretePluginType.GetConstructor(
    BindingFlags.Instance | BindingFlags.DeclaredOnly | BindingFlags.Public,
    null,
    new[] { typeof(ImageViewer) },
    null);

  return (ImageViewerPlugin) pluginConstructor.Invoke(
    new object[] { constructorParameter });
} 
```

ImageViewerPlugin 类大致如下所示：

```
internal ImageViewerPlugin
{
  protected ImageViewer _viewer;
  protected ImageViewerPlugin(ImageViewer viewer)
  {
    _viewer = viewer;
  }
} 
```

一个具体的实现大致是这样的：

```
internal AnImageViewerPlugin
{
  public AnImageViewerPlugin(ImageViewer viewer) : base(viewer)
  {
  }
} 
```

每个`ImageViewer`实例都有自己的`ImageViewerPlugin`实例集合。

现在应用程序被重构为使用 DI 容器和构造函数注入，我发现这些插件具有需要由 DI 容器解决的依赖项（以前通过使用全局静态类隐藏），但我不知道如何在不使用服务定位器（反模式）的情况下做到这一点。

最明智的解决方案似乎是使用 DI 创建这些插件实例。这将允许我添加额外的构造函数参数，以通过构造函数注入注入它们所依赖的依赖项。但是如果我这样做，我如何`viewer`在注入其余参数值的同时传递特定的参数值？

我认为 an`ImageViewerPluginFactory`将有助于实现这一点，但看不到如何实现这样的工厂，因为每个插件都可能具有不同的构造函数签名。

我该如何解决这种情况？还是我以完全错误的方式接近这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:38:15.550

因此，您有一个`ImageViewer`依赖于实例集合的`ImageViewerPlugin`实例，每个实例都依赖于 n`ImageViewer`依赖于实例集合`ImageViewerPlugin`，每个实例都依赖于 n依赖于实例`ImageViewer`集合`ImageViewerPlugin`，每个实例都依赖于...图片 ：-）

这是一个循环引用。将整个 DI 容器放在一边，手动执行此操作时将如何创建此层次结构？使用构造函数注入你不能。从下面的例子可以看出：

```
var plugin = new ImageViewerPlugin( [what goes here?] );
var viewer = new ImageViewer(plugin); 
```

您将不得不以某种方式打破这个依赖循环，一般建议是在这种情况下使用属性注入：

```
var plugin = new ImageViewerPlugin();
var viewer = new ImageViewer(plugin);

// Property injection
plugin.Viewer = viewer; 
```

但更重要的是，您应该仔细查看应用程序的设计，因为循环引用通常表明设计存在问题。例如，仔细看看插件需要查看器的哪些行为以及查看器需要插件的哪些行为。您也许可以将其提取到另一个类，如下所示：

```
var imageServices = new ImageServices();
var plugin = new ImageViewerPlugin(imageServices);
var viewer = new ImageViewer(imageServices, plugin); 
```

这样就彻底解决了问题，但是这是否可行还要看你的情况。

使用最后一个解决方案，使用 Simple Injector 注册将相当简单。使用属性注入打破依赖关系时，可以使用[RegisterInitializer(Action)](http://simpleinjector.cuttingedge.it/ReferenceLibrary/?topic=html/M_SimpleInjector_Container_RegisterInitializer__1.htm)方法。它允许您打破依赖循环。例如：

```
container.RegisterInitializer<ImageViewer>(viewer =>
{
    foreach (var plugin in viewer.Plugins)
    {
        plugin.Viewer = viewer;
    }
}); 
```

# wix - 如何使用 WiX 的 Heat 工具创建伴随文件

> ID：15422463
> 
> 赞同：1
> 
> 时间：2013-03-15T00:02:30.410
> 
> 标签：wix, heat

我们的构建过程引入 .dll 并从中创建“policy.*.dll”文件和伴随的“policy.*.config”文件。在查看我们的 MSI 的 WiX 的“暗”输出时，我发现策略和相应的配置文件位于由 CompanionFile 标签链接的同一个组件中。

有没有办法让 Heat 同时在同一个组件标签中收集“policy.*.dll”文件和伴随的“policy.*.config”文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:01:54.907

您需要编写一个 XSLT 来转换输出以将两个文件合二为一，并在其中一个元素上`Component`标记`CompanionFile`属性。`File`XSLT 基本上是所有热量输出的终极通用转换（即使 XSL 有点复杂）。

# erlang - Erlang计数器表达式相当于C++，while循环？

> ID：15422465
> 
> 赞同：0
> 
> 时间：2013-03-15T00:02:33.400
> 
> 标签：erlang, while-loop, counter, increment

增量/减量运算符是否有等效表达式，例如`counter++`？我也想知道如何正确地做到这一点？

```
-module(whileloop).
-export([call/0, while_loop/2]).

call() ->
    while_loop(10,0).

while_loop(Var,Counter) ->  
    case Var =:= Counter of
        false ->
            Counter += 1,
            whileloop(Var);
    end. 
```

编辑：

```
 -module(whileloop).
-export([call/0, while_loop/2]).

call() ->
    while_loop(10,0).

while_loop(Var, Counter) -> 
    case Var =:= Counter of
        false ->            
            while_loop(Var,Counter + 1)
    end. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T05:47:47.187

C += 1 的意思是修改C的值。在Erlang中是没有意义的，因为它只能给出如下结果：

```
1> C = C+1.
* 1: variable 'C' is unbound
C = 1.
1
3> C = C+1.
** exception error: no match of right hand side value 2 
```

请记住，“A = B”并不意味着将 B 的值分配给 A，而是“模式匹配”A 与 B，

*   如果 A 未绑定，则它将 B 的值绑定到 A；
*   如果 A =:= B 什么都没做，则过程继续；
*   如果 A =/= B 则进程崩溃。

所以是的，如果你想要一个计数器或任何改变的信息，你必须使用一个状态变量，它作为递归循环的参数传递。从这个角度来看，您的最后一个代码是正确的，但是让我们看看当您在 shell 中调用“call()”时会发生什么。

首先它在同一个进程中调用 - 外壳 - 函数 while_loop(10,0)。

10 不等于 0，因此它立即调用 while_loop(10,1)。

10 不等于 1，所以它立即调用 while_loop(10,2)。

依此类推，直到它调用 while_loop(10,10)。现在 10 =:= 10 为真，并且这个结果与 case 的任何子句都不匹配，所以你得到一个错误并且进程崩溃。

由于您的代码不包含任何消息接收并且只是循环循环直到它崩溃，整个过程只需要几微秒，所以看起来它立即失败了。

根据您的期望，您可以想象几种类型的计数器，这里有 2 个示例：

```
-module(counter).

-compile(export_all).

% one counter that help you to count some events

% interface

start_c1(End) when is_integer(End) ->
    spawn(?MODULE,counter1,[End]).

start_link_c1(End) when is_integer(End) ->
    spawn_link(?MODULE,counter1,[End]).

inc_c1(Pid) when is_pid(Pid) ->
    Ref = make_ref(),
    Pid ! {inc,self(),Ref},
    receive
        {Ref,done} -> done;
        {Ref,V} -> V
    after 1000 ->
        {error,no_response}
    end.

value_c1(Pid) when is_pid(Pid)  ->
    Ref = make_ref(),
    Pid ! {get_value,self(),Ref},
    receive
        {Ref,V} -> V
    after 1000 ->
        {error,no_response}
    end.

stop_c1(Pid)  when is_pid(Pid) ->
    Pid ! stop.

% the counter

counter1(End) -> counter1_loop(End,0).

counter1_loop(End,V) ->
    receive
        {inc,Pid,Ref} when V =/= done -> 
            NewV = case V+1 of
                End -> done;
                Nv -> Nv
            end,
            Pid ! {Ref,NewV},
            counter1_loop(End,NewV);
        {inc,Pid,Ref} ->
            Pid ! {Ref,done},
            counter1_loop(End,done);         
        {get_value,Pid,Ref} ->
            Pid ! {Ref,V},
            counter1_loop(End,V);
        stop ->
            ok
    end.

% One kind of timeout that execute something after a while - 
% note it exists a similar one in the library

start_after(T,M,F,A) when is_integer(T), is_list(A) ->
    Ref = make_ref(),
    {Ref,spawn(?MODULE,after_receive,[T,M,F,A,self(),Ref])}.

cancel_after(P) when is_pid(P) ->
    P ! cancel.

% the counter
after_receive(T,M,F,A,Pid,Ref) ->
    receive
        {cancel,Ref} -> Pid ! {after_receive,Ref,cancelled}
    after T ->
        Pid ! {after_receive,Ref,done},
        apply(M,F,A)
    end. 
```

以及如何使用它们：

```
1> c("../src/counter").
{ok,counter}
2> {Ref,P} = counter:start_after(5000,io,format,["This is the end!" ]).
{#Ref<0.0.0.29>,<0.33.0>}
This is the end!3> 
3> {Refa,Pa} = counter:start_after(50000,io,format,["This is the end!" ]).
{#Ref<0.0.0.34>,<0.35.0>}
4> Pa ! {cancel,Refa}.
{cancel,#Ref<0.0.0.34>}
5> flush().
Shell got {after_receive,#Ref<0.0.0.29>,done}
Shell got {after_receive,#Ref<0.0.0.34>,cancelled}
ok
6> P1 = counter:start_c1(5).
<0.52.0>
7> counter:inc_c1(P1).
1
8> counter:inc_c1(P). 
{error,no_response}
9> counter:inc_c1(P1).
2
10> counter:inc_c1(P1).
3
11> counter:value_c1(P1).
3
12> counter:inc_c1(P1).  
4
13> counter:inc_c1(P1).
done
14> counter:value_c1(P1).
done
15> counter:inc_c1(P1).  
done
16> counter:stop_c1(P1).
stop
17> counter:inc_c1(P1). 
{error,no_response}
18> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T07:55:46.363

您编辑的版本没有子句 when`Var =:= Counter`并因此崩溃。你最好在函数子句中使用模式匹配。

```
-module(whileloop).
-export([call/0, while_loop/2]).

call() ->
    while_loop(10,0).

while_loop(Var, Var) ->
    ok;
while_loop(Var, Counter) -> 
    while_loop(Var, Counter + 1). 
```

当然，您需要在循环内做一些事情。您可以为此使用 lambda：

```
-module(whileloop).
-export([call/0, while_loop/2]).

call() ->
    while_loop(10, 0, fun(Counter) -> io:format("Counter: ~p~n", [Counter]) end).

while_loop(Var, Var, _) ->
    ok;
while_loop(Var, Counter, Fun) ->
    Fun(Counter),
    while_loop(Var, Counter + 1). 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T00:16:07.073

只需递归调用`while_loop`，`Counter`参数加一：

```
while_loop(Var, Counter + 1) 
```

# javascript - 使用 .load 从导航栏加载页面

> ID：15422467
> 
> 赞同：0
> 
> 时间：2013-03-15T00:02:38.670
> 
> 标签：javascript, ajax, jquery

我正在使用引导程序的模式，我想在模式的顶部有一个导航栏，它使用 jquery 的 .load 在单击时更改模式的视图。我可以使用要显示的默认视图来显示模式，但单击时我无法触发其余按钮。下面是我想要的简化版本。谢谢你的帮助。

```
<div class="modal-header">
    <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>X</button>
    <h3 id="myModalLabel">Account Settings</h3>
</div>
<div class="modal-body">
    <div class="btn-group">
        <button id="account" class="btn">Account</button>
        <button id="edit-account-users" class="btn">Users</button>
    </div>
    <div class="wrapper">
    <!-- Content -->
    </div>
</div>
<div class="modal-footer">
    <button class="btn" data-dismiss='modal' aria-hidden='true'>Close</button>
</div>

$(document).ready(function () {
    accountData.init();
});

var accountData = {
    'init' : function() {
        $('.account-settings, #account-settings #account').click(function() {
            $('#account-settings').load('/partials/account/index.html', function() {
            $('#account-settings .wrapper').load('/partials/account/account_data.html');
        });
    });

    $('#edit-account-users').click(function() {
        $('#account-info .wrapper').load('/partials/account/account_users.html');
    });
}

}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:05:25.623

您的按钮未触发的原因是您的事件绑定可能附加到不再存在的元素。

假设您要使用 替换内容`.load()`，则元素的原始事件处理程序将丢失。这就是为什么事件委托在这里非常有用，将事件绑定到文档而不是单个元素。（您不会替换`document`）因此，当用户单击页面内的任何内容时，该事件将被拾取`document`并根据提供的*选择器**委托*给子元素，例如。.*`#edit-account-users`*

 *使用事件委托`.on()`而不是`.click()`.

```
$(document).on('click', '#edit-account-users', function() {
        $('#account-info .wrapper').load('/partials/account/account_users.html');
}); 
```

阅读更多关于`.on()`：[http ://api.jquery.com/on/](http://api.jquery.com/on/)*

# python - 在 Python 中转换字符串以插入 MySQL DB 日期列日期

> ID：15422470
> 
> 赞同：5
> 
> 时间：2013-03-15T00:02:55.140
> 
> 标签：python, mysql, date

我有一个不寻常的日期字符串，我想将它插入 MySQL 数据库。

```
date = 'Thu, 14 Mar 2013 13:33:07 -0400' 
```

这是插入语句

```
self.cursor.execute("INSERT INTO table1 (`DATE`)VALUES (%s);",(date)) 
```

当我这样做时，它会显示在数据库中，如下所示：

```
0000-00-00 00:00:00 
```

即使我手动输入 SQL，它也会以相同的方式显示。

如何将日期字符串转换为 mysql 可读日期以进行插入？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T00:17:37.560

点安装 python-dateutil

```
from dateutil.parser import parse
date = 'Thu, 14 Mar 2013 13:33:07 -0400'
parse(date).strftime("%Y-%m-%d %H:%M:%S") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T00:28:29.003

此日期字符串采用[RFC 2822 日期格式](https://www.rfc-editor.org/rfc/rfc2822.html#page-14)，可以使用[email.utils.parsedate](http://docs.python.org/2/library/email.util.html#email.utils.parsedate)（它是标准库的一部分）进行解析：

```
In [428]: import email.utils as eu

In [429]: eu.parsedate('Thu, 14 Mar 2013 13:33:07 -0400')
Out[429]: (2013, 3, 14, 13, 33, 7, 0, 1, -1) 
```

一旦你有了一个 datetime 对象，你就可以将它以那种形式（没有格式化）插入到 MySQL 中：

```
date = eu.parsedate('Thu, 14 Mar 2013 13:33:07 -0400')
self.cursor.execute("INSERT INTO table1 (`DATE`) VALUES (%s)",(date,)) 
```

* * *

注意： to 的第二个参数`cursor.execute`必须是一个序列。所以使用元组`(date,)`而不是日期时间对象`(date)`。

此外，您的 SQL 字符串中不需要分号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-31T17:18:41.423

我没有足够的声誉来评论上面的问题，所以我会把答案放在这里。

如果在运行时遇到 ImportError，则需要安装该模块：

```
from dateutil.parser import parse 
```

去这里下载解析器： http: [//labix.org/python-dateutil#head-2f49784d6b27bae60cde1cff6a535663cf87497b](http://labix.org/python-dateutil#head-2f49784d6b27bae60cde1cff6a535663cf87497b)

接下来，解压缩文件夹并以管理员权限打开 cmd。导航到文件夹并键入以下内容：

```
python setup.py install 
```

# excel - Excel 验证 - 有间接列表需要列表和/或数字

> ID：15422477
> 
> 赞同：0
> 
> 时间：2013-03-15T00:03:17.043
> 
> 标签：excel, vba

我有两个具有依赖列表验证的单元格 - 我正在使用 INDIRECT 根据第一个单元格的值获取第二个单元格的列表/选择框。

我需要做的更复杂，我正在努力寻找解决方案。

在 cellA 中，如果选择了 value1，则 cellB 应该有 list1（我现在可以这样做）但是如果在 cellA 中选择了 value2 或 value3，则 cellB 应该需要任何数字 - 而不是列表值。

基本上，在一个实例中，我需要在 cellB 中进行列表验证，但在另一个实例中，我需要一个数字验证 - 任何数字。

有人能帮忙吗 ？欣赏它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:31:21.560

我认为他们自动执行此操作的唯一方法是使用 VBA 应用正确类型的验证。

以下示例（您不能按原样插入）应该为您提供一些关于您需要做什么的线索。此代码将放置在您正在使用的工作表的工作表代码模块中。

您可以使用宏记录器获取代码以生成所需的验证。

如果您可以使用您的代码和公式更新您的问题，我也许可以根据您的需要对其进行更多修改。

```
Private Sub Worksheet_Change(ByVal Target As Range)
' Target is a reference to the Cell(s) that have changed.

    If Target.Address = "$A$1" Then
    ' We only care about this cell (CellA)
        Select Case Target.Value
        Case "needalist"
            ' remove any existing validation and add the list validation to $B$1 (CellB)
            With Sheet1.Range("$B$1").Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=$C$1:$C$7" ' Formula1 Can contain a formula
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End With
        Case "needanumber"
            ' remove any existing validation and add the number validation to $B$1 (CellB)
            With Sheet1.Range("$B$1").Validation
                .Delete
                .Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="1", Formula2:="10" ' Formula1 is min, Formula2 is max
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End With
        Case Else
            ' Catch Everything
            Sheet1.Range("$B$1").Validation.Delete
        End Select
    End If

End Sub 
```

# java - Lucene Porter Stemmer 未公开

> ID：15422485
> 
> 赞同：4
> 
> 时间：2013-03-15T00:04:46.780
> 
> 标签：java, lucene, porter-stemmer

如何在 Lucene 3.6.2 中使用 Porter Stemmber 类？这是我所拥有的：

```
import org.apache.lucene.analysis.PorterStemmer;
...
PorterStemmer stemmer = new PorterStemmer();
term = stemmer.stem(term); 
```

有人告诉我： PorterStemmer 在 org.apache.lucene.analysis 中不公开；无法从外部包访问。

编辑：我还广泛阅读了有关使用 Snowball 的信息，但不鼓励这样做。在 Java 中使用 Lucene 的正确方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T00:11:34.493

1) 如果您想使用 PorterStemmer 作为 Lucene 令牌分析过程的一部分，请使用 [PorterStemFilter](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/PorterStemFilter.html)

示例代码

```
 class MyAnalyzer extends Analyzer {
  public final TokenStream tokenStream(String fieldName, Reader reader) {
    return new PorterStemFilter(new LowerCaseTokenizer(reader));
  }
 } 
```

* * *

2) 如果您只想将 PorterStemmer 用于任何其他应用程序，这里是作者自己的源代码：[Java 中的 PorterStemmer](http://tartarus.org/martin/PorterStemmer/java.txt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-21T06:14:21.783

在 Lucene 之后的版本中，PorterStemmer 不再公开。所以

```
 class MyAnalyzer extends Analyzer {
   public final TokenStream tokenStream(String fieldName, Reader reader) {
    return new PorterStemFilter(new LowerCaseTokenizer(reader));
   }
   } 
```

或者，您可以使用 SnowballAnalyzer Stemmer。[链接](https://lucene.apache.org/core/4_0_0/analyzers-common/org/tartarus/snowball/ext/PorterStemmer.html)（SnowballAnalyzer 已弃用）

```
import org.tartarus.snowball.ext.PorterStemmer;
.
.
public static  String applyPorterStemmer(String input) throws IOException {

        PorterStemmer stemmer = new PorterStemmer();
        stemmer.setCurrent(input);
        stemmer.stem();
        return stemmer.getCurrent();
    } 
```

# python - scikits-learn pca 降维问题

> ID：15422487
> 
> 赞同：3
> 
> 时间：2013-03-15T00:04:51.987
> 
> 标签：python, numpy, scikit-learn, pca

我在使用 scikit-learn 和 PCA 进行降维时遇到问题。

我有两个 numpy 矩阵，一个大小为 (1050,4096)，另一个大小为 (50,4096)。我试图减少两者的尺寸以产生 (1050, 399) 和 (50,399) 但是，在做 pca 之后，我得到了 (1050,399) 和 (50,50) 矩阵。一个矩阵用于 knn 训练，另一个用于 knn 测试。我下面的代码有什么问题？

```
pca = decomposition.PCA()
pca.fit(train)
pca.n_components = 399
train_reduced = pca.fit_transform(train)
pca.n_components = 399
pca.fit(test)
test_reduced = pca.fit_transform(test) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-15T00:22:49.453

`fit_transform()`在火车上打电话，`transform()`在测试中：

```
from sklearn import decomposition

train = np.random.rand(1050, 4096)
test = np.random.rand(50, 4096)

pca = decomposition.PCA()
pca.n_components = 399
train_reduced = pca.fit_transform(train)
test_reduced = pca.transform(test) 
```

# java - Java 键绑定

> ID：15422488
> 
> 赞同：0
> 
> 时间：2013-03-15T00:04:58.463
> 
> 标签：java, key-bindings

我需要绑定所有箭头键以执行相同的功能，但每次都按下哪个键。目前我只有通过以下方式按下右箭头键时

```
DoneImg.getInputMap(JLabel.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0), "UpArrow");

Action MvRight = new AbstractAction()
{
     public void actionPerformed(ActionEvent e)
     {
           //Do whatever here
     }
};
DoneImg.getActionMap().put("RightArrow", MvRight); 
```

但我需要类似的东西

```
DoneImg.getInputMap(JLabel.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0), "RightArrow");
     DoneImg.getInputMap(JLabel.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, 0), "LeftArrow");
     DoneImg.getInputMap(JLabel.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0), "DownArrow");
     DoneImg.getInputMap(JLabel.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0), "UpArrow");

     Action MvAll = new AbstractAction()
         {
                 public void actionPerformed(ActionEvent e)
              {
                  if (e.keypressed == "LeftArrow")
                         {System.out.println("The left arrow was pressed!");}
                  if (e.keypressed == "RightArrow")
                         {System.out.println("The right arrow was pressed!");}
                  //and so forth
              }
                 };
     DoneImg.getActionMap().put("RightArrow", MvAll);
     DoneImg.getActionMap().put("LeftArrow", MvAll);
     DoneImg.getActionMap().put("UpArrow", MvAll);
     DoneImg.getActionMap().put("DownArrow", MvAll); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-15T00:23:07.053

您要问的实际上是违反直觉的，并且与键绑定 API 的设计背道而驰。

目的是为每个击键提供一个单一的工作单元。在我看来，这表明您应该对每个箭头键进行单独的操作。

它使遵循逻辑、进行更改、根据需要规避操作变得更加容易。

但我是谁说什么是对的：P

如果您看不到它，一种简单的方法是为每个动作分配一个“命令”，然后在`actionPerformed`触发时询问您。

```
public TestKeyBindings02() {
    JPanel panel = new JPanel();
    InputMap im = panel.getInputMap(JPanel.WHEN_IN_FOCUSED_WINDOW);
    ActionMap am = panel.getActionMap();

    im.put(KeyStroke.getKeyStroke(KeyEvent.VK_RIGHT, 0), "RightArrow");
    im.put(KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, 0), "LeftArrow");
    im.put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0), "UpArrow");
    im.put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0), "DownArrow");

    am.put("RightArrow", new ArrowAction("RightArrow"));
    am.put("LeftArrow", new ArrowAction("LeftArrow"));
    am.put("UpArrow", new ArrowAction("UpArrow"));
    am.put("DownArrow", new ArrowAction("DownArrow"));
}

public class ArrowAction extends AbstractAction {

    private String cmd;

    public ArrowAction(String cmd) {
        this.cmd = cmd;
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if (cmd.equalsIgnoreCase("LeftArrow")) {
            System.out.println("The left arrow was pressed!");
        } else if (cmd.equalsIgnoreCase("RightArrow")) {
            System.out.println("The right arrow was pressed!");
        } else if (cmd.equalsIgnoreCase("UpArrow")) {
            System.out.println("The up arrow was pressed!");
        } else if (cmd.equalsIgnoreCase("DownArrow")) {
            System.out.println("The down arrow was pressed!");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:29:08.463

您无权访问导致执行操作的 KeyStroke。所以需要创建4个Action，并传入一个参数给Action。就像是：

```
class SomeAction extends AbstractAction
{
    public SomeAction(String name)
    {
        putValue(Action.NAME, name);
        putValue(ACTION_COMMAND_KEY, "Command: " + name);
    }

    public void actionPerformed(ActionEvent e)
    {
        System.out.println("Name: " + getValue(Action.NAME) );
        System.out.println(e.getActionCommand());
    }
} 
```

您将动作添加到 ActionMap 中，例如：

```
DoneImg.getActionMap().put("RightArrow", new SomeAction("RightArrow"));
DoneImg.getActionMap().put("LeftArrow", new SomeAction("LeftArrow"));
DoneImg.getActionMap().put("UpArrow", new SomeAction("UpArrow"));
DoneImg.getActionMap().put("DownArrow", new SomeAction("DownArrow")); 
```

因此，您共享相同的基本功能，但只需使用标识符标识每个操作。

# javascript - innerHTML：如何避免

> ID：15422494
> 
> 赞同：7
> 
> 时间：2013-03-15T00:05:55.893
> 
> 标签：javascript, xml-serialization, firefox-addon

我正在编写一个插件，它将表情符号转换为特定站点的文本块中的图像。简单的答案是使用正则表达式检测 innerHTML 上的触发文本并插入 img 标签，然后将字符串通过管道返回到*innerHTML*部分中的 dom 元素。DOM 元素块可能已经在 innerHTML 部分中具有锚`<a>`和/或文本格式。`<b>,<i>,<u>`

例如

```
 var textBlock = pItems[i].innerHTML;
    var kissSource = 'https://mail.google.com/mail/e/35D';
    textBlock = textBlock.replace(/(^|[^&lt;]|[^&gt;]):\*/g, "<img class='emoticon' src='" + kissSource + "' />");
 -->      pItems[i].innerHTML = textBlock;  //<-can I avoid this to be in compliance with Mozilla addons reqmnts 
```

我搜索了好几个小时关于如何将 DOM（或 HTML 字符串）转换为 XML（我知道：HTML！=XLM[如何将 HTML 读取为 XML？](https://stackoverflow.com/questions/5472162/how-to-read-html-as-xml)但也许是 div 的一部分？）这反过来可能是转换为 JSON 反过来 .. 可以转换回 DOM 如下： [https://developer.mozilla.org/en-US/docs/XUL/School_tutorial/DOM_Building_and_HTML_Insertion?redirectlocale=en-US&redirectslug=XUL_School%2FDOM_Building_and_HTML_Insertion#JSON_Templating](https://developer.mozilla.org/en-US/docs/XUL/School_tutorial/DOM_Building_and_HTML_Insertion?redirectlocale=en-US&redirectslug=XUL_School%2FDOM_Building_and_HTML_Insertion#JSON_Templating)

我不知道 jQuery，所以如果有可能使用 javascript，那将是理想的。

我是否应该在不对 innerHTML 运行正则表达式的情况下解决这个问题，从而避免问题？

非常感谢，珍娜

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:24:04.497

如果我理解正确，您想将说“:)”转换为表情符号。为此，您需要解析文本并将这些字符替换为 img 元素。所以你想做这样的事情：

```
<script>

function toArray(collection) {
  var arr = [];
  for (var i=0, iLen=collection.length; i<iLen; i++) {
    arr[i] = collection[i];
  }
  return arr;
}

function replaceTextWithEmoticon(el) {
  var re0 = /\:\)/g;
  var emo0 = document.createElement('img');
  emo0.src = 'https://mail.google.com/mail/e/35D'; 
  var node, txt, frag;
  var nodes = toArray(el.childNodes);

  for (var i=0, iLen=nodes.length; i<iLen; i++) {
    node = nodes[i];

    // If it's an element node, process the content
    if (node.nodeType == 1) {
      replaceTextWithEmoticon(node);

    // If it's a text node, look for matching text and replace with emoticon
    } else if (node.nodeType == 3 && re0.test(node.data)) {
      txt = node.data.split(re0);
      frag = document.createDocumentFragment();

      for (var j=0, jLen=txt.length - 1; j<jLen; j++) {

        frag.appendChild(document.createTextNode(txt[j]));
        frag.appendChild(emo0.cloneNode(false));
      }

      if (txt[j] && txt[j].length) {
        frag.appendChild(document.createTextNode(txt[j]));
      }
    }
    node.parentNode.replaceChild(frag, node);
  }
}

</script>

<p id="p0">here is a smily:) and another two:):)</p>
<button onclick="
  replaceTextWithEmoticon(document.getElementById('p0'));
">Replace with emoticon</button> 
```

上面需要修改以处理每个文本节点中的多个不同的表情符号，但我想你明白了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T22:11:13.880

# 工作解决方案

根据您最近对@Giuseppe 的评论，以及您从我的帖子中借用的格式错误的样式，唯一的解决方案是避免递归或遍历文本字符串，为您的正则表达式寻找匹配的元素。

1.  按照您的提议将正则表达式应用于您的字符串。
2.  完成后，使用 HTMLify 字符串解析器从该字符串构建 DOM
3.  将节点替换为从字符串构建的新 DOM 节点。

注意：这在拉入 AJAX HTML 页面时也很有用，您需要将 HTML 结果解析为临时 DOM 对象，但不想仅仅将内容转储到新创建元素的 innerHTML 中。另请注意，不适合使用 createDocumentFragment，因为您无法像 DOM 树一样导航片段。

这些步骤听起来很难，但 Stackoverflow 上有一些很棒的帖子让这很容易！
在为您进行研究并遇到[一个现在已经过时的解决方案](https://developer.mozilla.org/en-US/docs/Code_snippets/HTML_to_DOM#Using_a_hidden_browser_element_to_parse_HTML_to_a_window.27s_DOM)和[对您不起作用的 dom 解析器](https://stackoverflow.com/questions/2579666/getelementsbytagname-equivalent-for-textnodes)之后，我遇到了来自 @rob-w 的解决方案：[一个 dom 解析器](https://stackoverflow.com/questions/9250545/javascript-domparser-access-innerhtml-and-other-properties/9251106#9251106)

您的代码将包括来自 @rob-w 链接的 DOM 解析器以及：

```
 /* 
      * DOMParser HTML extension 
      * 2012-02-02 
      * 
      * By Eli Grey, http://eligrey.com 
      * Public domain. 
      * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK. 
      */
     /*! @source https://gist.github.com/1129031 */
     /*global document, DOMParser*/ 
             (function (DOMParser) {
         "use strict";
         var DOMParser_proto = DOMParser.prototype;
         var real_parseFromString = DOMParser_proto.parseFromString;

         // Firefox/Opera/IE throw errors on unsupported types  
         try {
             // WebKit returns null on unsupported types  
             if ((new DOMParser).parseFromString("", "text/html")) {
                 // text/html parsing is natively supported  
                 return;
             }
         } catch (ex) {}

         DOMParser_proto.parseFromString = function (markup, type) {
             if (/^\s*text\/html\s*(?:;|$)/i.test(type)) {
                 var doc = document.implementation.createHTMLDocument("");
                 var doc_elt = doc.documentElement;
                 var first_elt;

                 doc_elt.innerHTML = markup;
                 first_elt = doc_elt.firstElementChild;

                 if (doc_elt.childElementCount === 1 && first_elt.localName.toLowerCase() === "html") {
                     doc.replaceChild(first_elt, doc_elt);
                 }

                 return doc;
             } else {
                 return real_parseFromString.apply(this, arguments);
             }
         };
     }(DOMParser));

     autostyle = function (str) {
         var boldPattern = /(?![^<]*<\/a>)(^|<.>|[\s\W_])\*(\S.*?\S)\*($|<\/.>|[\s\W_])/g;
         var italicsPattern = /(?![^<]*<\/a>)(^|<.>|[\s\W])_(\S.*?\S)_($|<\/.>|[\s\W])/g;
         var strikethroughPattern = /(?![^<]*<\/a>)(^|<.>|[\s\W_])-(\S.*?\S)-($|<\/.>|[\s\W_])/gi;
         var underlinePattern = /(?![^<]*<\/a>)(^|<.>|[\s\W_])!(\S.*?\S)!($|<\/.>|[\s\W_])/gi;
         str = str.replace(strikethroughPattern, '$1<s>$2</s>$3');
         str = str.replace(italicsPattern, '$1<i>$2</i>$3');
         str = str.replace(boldPattern, '$1<b>$2</b>$3');
         str = str.replace(underlinePattern, '$1<u>$2</u>$3');
         return str;
     };

     emoticonRegexFunction = function(str) {
         //do something
         return str;
     }

     RegexWithoutInnerHTML = function () {
         pItems = document.getElementsByTagName('p');
         for (var k = 0; k < pItems.length; k++) {
             var str = pItems[k].textContent;
             str = autostyle(str);
             str = emoticonRegexFunction(str);
             var doc = new DOMParser().parseFromString('<p>' + str + '</p>', 'text/html');
             pItems[k].parentNode.replaceChild(doc.getElementsByTagName('p')[0], pItems[k]);
             //       pItems[k].innerHTML = str;  //<-now do not need innerHTML
         }
     }; 
```

jsbin 的完整工作示例：http: [//jsbin.com/itiwek/12/edit](http://jsbin.com/itiwek/12/edit)

享受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T00:44:02.963

**[jsFiddle 演示](http://jsfiddle.net/jEqEv/1/)**

利用可用的工具。您可以从已存储在 pItems 中的元素向下导航 DOM。第一个图像标签，您将更改 src。这将起作用：

```
pItems[i].getElementsByTagName("img")[0].src = kissSource; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T04:03:35.973

我不知道如何评论其他人的帖子，但如果你在@RobG 回复中添加过滤器，它会让你到达那里。（PS：我确实提交了代码编辑建议）

```
....
var nodes = toArray(el.childNodes);

if (node.nodeName != "#text") //will allow embedded <b> <img> <a> etc to work.
   continue;

for (var i=0, iLen=nodes.length; i<iLen; i++) {
   ....

<p id="p0">here is a smily:) and <b>another</b> <a href="www.google.com">google</a> two:):) <i>italics</i></p>
    .... 
```

或者，如果您想明确查找某些要跳过的元素，例如`<B>`or`<IMG>`或`<A>`等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-18T09:22:41.717

这与我必须获得对我的插件 ( [ImageZone](https://addons.mozilla.org/en-US/firefox/addon/imagezone/) ) 的完整评论相同的问题。

我认为使用 innerHTML 对您来说不是一个好主意，因为您将丢失在目标节点上注册的所有事件侦听器。我认为你可以使用这样的代码：

```
var treeWalker = document.createTreeWalker(
 node,
 NodeFilter.SHOW_ALL,
 { acceptNode:function (node) {
         return node.nodeType == Node.TEXT_NODE ? 
                  NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
 }},false);

 or just

var treeWalker = document.createTreeWalker(
 node,
 NodeFilter.SHOW_TEXT,
 { acceptNode:function (node) {return NodeFilter.FILTER_ACCEPT; }},false);

 while(treeWalker.nextNode()) {
     var n=walker.currentNode;
     var text=n.nodeValue;
     var a= text.split(/(--- your emoticon regexp code ---))/g);
     if (a.length > 1){
         n.insertAfter(document.createTextNode(a[0]));
         var img=document.createElement("img");
         switch (a[1]){
             case '...': img.setAttribute('src','...'); break;
         } 
         // or img.setAttribute('src',emos_srcs[a[1]]);

         n.insertAfter(img);
         n.insertAfter(document.createTextNode(a[2]));
         n.parentNode.removeChild(n);
     }

 } 
```

# javascript - 如何在 ruby 中使用 javascript 变量

> ID：15422497
> 
> 赞同：1
> 
> 时间：2013-03-15T00:06:02.300
> 
> 标签：javascript, ruby-on-rails, ruby, variables

我是 rails 新手，我想在 ruby​​ 嵌入式代码中使用 javascript 变量来在数据库中进行查询，

这是我的代码

```
function modify(){
    var select = document.getElementById("special_id").value;
    var select2 = document.getElementById("target_area_id");
    select2.options.length = 1;

    <% @values = TargetArea.where(:special_id => select) %>

    select2.options[select2.options.length] = new Option(<%= @values.count %>,"1");
} 
```

我想将从我的选择中获得的值与字段的 id 进行比较。

你能告诉我如何在Ruby中做到这一点吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:52:25.723

一种可能是我所知道的最简单的方法，也是处理此问题的传统方法，是执行 Ajax 请求。JavaScript 是客户端，而 Ruby 通常是服务器端。

您可以在您的路由文件中创建一个路由，然后在相应的控制器中创建响应 JavaScript 而不是 HTML 的操作。在该 JavaScript 文件中，您可以更改或修改页面上的内容，并可以访问您更改的变量，重新渲染页面的某些部分，等等。我将在这里使用 jQuery，因为它更简洁。

在您的路线文件中：

```
post 'some_controller/make_a_change', to: 'some_controller#make_a_change' 
```

然后，在您上面定义的函数中：

```
$.ajax({
   url:'/some_controller/make_a_change', //Defined in your routes file
   data:(
     'special_id=' + $('#special_id').val() + '&' +
     'target_area_id=' + $('#target_area_id').val()
   )
}) 
```

在 SomeController.rb 中，您可以通过以下方式访问您的 JavaScript 值`params`：

```
def make_a_change
   some_special_id = params[:special_id]
   taid = params[:target_area_id]
   @values = TargetArea.where(:special_id => some_special_id)

   respond_to do |format|
      format.js { render 'make_a_change' } #make_a_change.js.erb
   end
end 
```

然后，我认为您可以在 make_a_change.js.erb 中完成其余的工作，每次您调用其他函数并且您的 Ajax 请求成功时都会运行它。

```
var select2 = document.getElementById("target_area_id");
select2.options.length = 1;
select2.options[select2.options.length] = new Option(<%= @values.count %>,"1"); 
```

根据您的需要进行调整。希望这可以帮助！

* * *

更新：

我刚刚意识到这一行：

```
select2.options[select2.options.length] = new Option(<%= @values.count %>,"1"); 
```

可能行不通。如果它是一个 HTML 选择框或类似的东西，你可以把它放在它自己的视图中，然后在 make_a_change.js.erb 中的适当位置重新渲染它。

像这样：

```
 $('#some_div').html('<%= j render 'select2_list', values:@values %>') 
```

大多数情况下，我的回答背后的主题是：如果你想与你的 Ruby 代码或来自 JavaScript 函数的服务器数据进行交互，这是当你点击一个按钮或选中一个框或类似的东西时调用的一些函数，你将拥有将 Ajax 请求发送到您的服务器并在您的控制器中处理该请求。然后，这将使您更接近 Rails，并且远离尝试将两个不同的语言变量与`=`符号联系起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:14:33.627

由于 Ruby 是一种基于服务器的语言，如 php 或 asp/asp.net，因此在页面中使用来自服务器的代码非常容易，就像打印它一样，因此如果您想使用服务器端值更改 javascript 变量很容易。然而，做相反的事情是另一回事。我会使用代理调用（最有可能是 jQuery）将这些值发送到服务器。您要求的解决方案要求使用像 jQuery 这样的 javascript 框架，而不是我知道的 rails。

尝试使用 jQuery ajax 代理并根据服务器的响应在客户端刷新数据，这样就可以了。

检查[http://www.jquery.com](http://www.jquery.com)，使用 rails 创建服务，用 JSON 响应您的查询。

我希望这会有所帮助。

# jodatime - 将字符串验证为日期并转换为 Joda DateTime

> ID：15422502
> 
> 赞同：3
> 
> 时间：2013-03-15T00:06:33.023
> 
> 标签：jodatime

我想以“yyyy-MM-dd HH:mm:ss”的形式将字符串转换为 joda DateTime。字符串应该是两种格式之一，“yyyy-MM-dd HH:mm:ss”或“yyyy-MM-dd”，虽然它是用户输入，所以如果不是，我可能需要把它踢回来任何一种格式。如何检查不存在时间戳并将 00:00:00 附加到它的情况？下面是我给出完整日期和时间的情况下的代码。

```
 DateTimeFormatter formatter = DateTimeFormat.forPattern("yyyy-MM-dd HH:mm:ss");
    DateTime formattedDate= formatter.parseDateTime(dateString); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:10:19.143

你不能检查字符串的长度吗？

```
if ( dateString.length() == "yyyy-MM-dd".length() )
    dateString += "00:00:00"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-30T22:50:59.783

# perl - Perl system() 命令即使在退出循环后也会运行

> ID：15422503
> 
> 赞同：0
> 
> 时间：2013-03-15T00:06:34.503
> 
> 标签：perl

这是一个简单的 Perl 脚本，它接受 2 个参数 - 一个字符串（它是一个 URL）和一个整数值。

我要做的就是在给定的时间段内（以秒为单位）在传递的 URL 上运行 curl 请求。

当 URL 很简单时，一切都很好，`http://admin:admin@localhost:5074/?q=james`但是当 URL 中有问题时，问题就来`&`了。

问题是`system()`即使在退出循环后也使 curl 请求继续运行。

这是怎么回事？

```
use strict;
use warnings;
use URI::Escape;

my $url = uri_escape($ARGV[0]);
print "URL=".$url."\n"; 
my $duration = $ARGV[1];
print $duration;
my $start = time(); 
my $end = $start + $duration;
my $request = 0;

while(time() <= $end ){ 
    system("curl --user admin:admin --digest ".uri_unescape($url)); 
    $request++;
}

print "------------------------ END ----------------------------------\n";
print "URL = ".uri_unescape($url)." \n";
print "Total requests made = ".$request."\n";
print "Reqs/sec = ".($request/$duration)."/sec \n";
#print $start."\n";
#print $end."\n";
print "Duration = ".$duration." sec \n";
print "-------------------------------------------------------------------\n"; 
```

命令是：

```
perl curl.pl "http://admin:admin@localhost:5074/?q=james&format=xml" 5 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T00:51:16.070

您的 URL 中有一个`&`字符被 shell 解释为“在后台运行此命令”。您需要通过以下方式`&`正确转义元字符，以避免让 shell 解释它们：

```
use String::ShellQuote qw( shell_quote );
system("curl --user admin:admin --digest " . shell_quote($url)); 
```

或首选：

```
system('curl', '--user', 'admin:admin', '--digest', $url); 
```

后者完全避免创建外壳，并直接使用给定的参数进行分叉/执行`curl`，这些参数会自动转义。它更快、更安全。有关详细信息，请参阅[系统 perldoc](http://perldoc.perl.org/functions/system.html)。

顺便说一句，您应该考虑使用[LWP](http://search.cpan.org/perldoc?LWP%3a%3aUserAgent)。它是较新 Perls 的 Perl 核心的一部分（无需安装），您无需担心转义任何内容。

# android - Android ActionBar：带有操作按钮的可折叠 SearchView

> ID：15422505
> 
> 赞同：20
> 
> 时间：2013-03-15T00:07:08.387
> 
> 标签：android, android-actionbar, searchview

展开搜索视图时，如何构建`ActionBar`具有可见单个操作项的可折叠搜索视图？为了更具描述性，这就是我需要的：

![在此处输入图像描述](../Images/7cccaa5b132ea9af61612cacb229b47a.png) 请注意，还有其他菜单项并`android:uiOptions="splitActionBarWhenNarrow"`在 中定义`AndroidManifest.xml`。

我尝试设置自定义搜索项布局：

> 菜单.xml

```
<item
    android:id="@+id/menu_search"
    android:actionLayout="@layout/actionbar_search"
    android:icon="@drawable/action_search"
    android:showAsAction="always|collapseActionView"
    android:title="@string/search" /> 
```

> actionbar_search.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="right"
    android:orientation="horizontal" >

    <com.actionbarsherlock.widget.SearchView
        android:id="@+id/search_view"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:iconifiedByDefault="false"
        android:queryHint="@string/search_hint" />

    <ImageButton
        android:id="@+id/add_item"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        style="@style/Widget.Sherlock.ActionButton"
        android:src="@drawable/content_new"/>

</LinearLayout> 
```

但默认情况下，搜索视图采用所有可用宽度并且按钮不可见。我不知道如何强制`SearchView`填充应用程序图标和菜单项之间的所有可用空间。我发现的只是`android:maxWidth`属性，但这只允许硬编码维度，我正在寻找一些更灵活的解决方案。我也尝试过`RelativeLayout`，`android:layout_toRightOf="@id/search_view"`但没有运气。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-17T13:20:39.963

在考虑了评论中的建议后，许多谷歌搜索和测试成功地获得了预期的效果。我对这个解决方案并不感到自豪，但它有效，它并不太复杂，对于这种情况应该足够了。

在简历中我做了什么：

1.  在中放置`SearchView`自定义“添加项目”按钮`customView`。`ActionBar`
2.  已从搜索项`collapseActionView`中删除`android:actionLayout``menu.xml`
3.  `SearchView`以编程方式折叠/展开。

一些代码可以更好地理解我做了什么。也许这对某人有用。

> 菜单.xml

```
<item
    android:id="@+id/menu_search"
    android:icon="@drawable/action_search"
    android:showAsAction="always"
    android:title="@string/search" />

// ... other menu items 
```

> actionbar_search.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="right"
    android:orientation="horizontal">

    <com.actionbarsherlock.widget.SearchView
        android:id="@+id/search_view"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:iconifiedByDefault="false"
        android:queryHint="@string/search_hint"
        android:visibility="invisible" />

    <ImageButton
        android:id="@+id/add_item"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        style="@style/Widget.Sherlock.ActionButton"
        android:src="@drawable/content_new"
        android:title="@string/add_item" />

</LinearLayout> 
```

> MainActivity.java

```
@Override
public void onCreate(Bundle savedInstanceState) {
    // ...
    actionBar.setCustomView(R.layout.actionbar_search);
    actionBarCustomView = ab.getCustomView();
    searchView = ((SearchView) actionBarCustomView.findViewById(R.id.search_view));
    searchView.setOnCloseListener(new SearchView.OnCloseListener() {
        @Override
        public boolean onClose() {
            searchView.setVisibility(View.INVISIBLE);
            return false;
        }
    });
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        // ...
        case R.id.menu_search:
            if (searchView.getVisibility() == View.VISIBLE) {
                searchView.setIconified(true);
                searchView.setVisibility(View.INVISIBLE);
            } else {
                searchView.setMaxWidth(abCustomView.getWidth() - addButton.getWidth());
                searchView.setVisibility(View.VISIBLE);
                searchView.setIconified(false);
            }
            break;
        // ...
    }
    return true;
}

@Override
public void onBackPressed() {

    if (searchView.getVisibility() == View.VISIBLE) {
        searchView.setIconified(true);
        searchView.setVisibility(View.INVISIBLE);
        return;
    }

    // ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T05:12:19.743

您只能使用 yourmenu.xml 来执行此操作。

将您的其他菜单图标设置为始终显示为操作。您的 menu.xml 应如下所示：

```
<item
    android:id="@+id/menu_search"
    android:actionLayout="@layout/actionbar_search"
    android:icon="@drawable/action_search"
    android:showAsAction="always|collapseActionView"
    android:title="@string/search"
/>
<item
    android:id="@+id/your_other_menu_id"
    android:showAsAction="always"
    android:icon="@android:drawable/your_other_menu_ic"
 /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-11T11:12:10.817

只需您可以这样做

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
     getMenuInflater().inflate(R.menu.main, menu);
     MenuItem searchItem = menu.findItem(R.id.action_search);
     searchView = (SearchView) MenuItemCompat.getActionView(searchItem);
     searchView.setIconified(true); //to be opened collapsed
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch(item.getItemId()){

        case R.id.action_search:
            searchView.setIconified(false);// to Expand the SearchView when clicked
            return true;
    }    
    return false;
} 
```

并在 menu.xml 中的搜索项制作

**showAsAction="总是"**

注意：我正在使用 android.support.v7.widget.SearchView 但在你的情况下没关系

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-11T06:27:58.103

只是一个更改菜单xml。应用名称的 showaction 前缀

```
<menu xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto" >

<item
    android:id="@+id/menu_search"
    android:actionLayout="@layout/actionbar_search"
    android:icon="@drawable/action_search"
    app:showAsAction="always|collapseActionView"
    android:title="@string/search"
/>

</menu> 
```

# wix - 在禁用 WIXUI_EXITDIALOGOPTIONALCHECKBOX 的设置后，Wix 和运行应用程序

> ID：15422509
> 
> 赞同：0
> 
> 时间：2013-03-15T00:07:43.007
> 
> 标签：wix

[我使用以下文档](http://wix.sourceforge.net/manual-wix3/run_program_after_install.htm)找到了如何在安装后运行应用程序。

我知道使用该`WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT`属性可以调整复选框文本。

我知道使用该`WIXUI_EXITDIALOGOPTIONALCHECKBOX`属性，我可以将复选框设置为默认选中。

我的问题是有谁知道是否可以显示复选框但已禁用（不可编辑）？

基本上我想让复选框显示并被选中，但我不希望用户能够取消选中它。

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:04:37.337

您需要覆盖`Dialog`并`Control`使用[自定义内置 WixUI 对话框集中](http://wix.sourceforge.net/manual-wix3/WixUI_customizations.htm)描述的技术来添加`Disabled='true'`属性。这需要一些工作，但应该是可能的。

# jquery - 特殊情况：固定/浮动侧边栏元素

> ID：15422512
> 
> 赞同：0
> 
> 时间：2013-03-15T00:08:04.127
> 
> 标签：jquery, scroll, css-position, floating

## 情况：

我的网站上有一个非常常规的侧边栏。

作为侧边栏中的最后一个元素，您可以看到 Blogroll。

在此之下，我需要创建**一个类似的容器**，它只包含一个**滚动到顶部按钮**。

到目前为止很容易。

* * *

## 问题：

我需要 Button 的行为方式如下：

*   如果你**向下滚动并且这个容器（只有这个）接近**可见区域的上边缘，我需要它**留在那里** （位置：固定？）并与你一起向下移动。（顶部有一点偏移）

*   如果您再次向上滚动，它会与您一​​起向上移动。但是**当它到达它的旧位置时它必须停止。**

*   它需要在页脚开始**之前停止。**

* * *

## 我有多远？

我知道一点jquery，但不是大师。

这样的事情真的可能吗？

我很高兴将特殊类附加到容器以使其工作。目前我只是不确定如何处理这个问题。

有任何想法吗？

# sql - 查询查询结果

> ID：15422516
> 
> 赞同：0
> 
> 时间：2013-03-15T00:08:26.497
> 
> 标签：sql, subquery

我是 sql 新手，看过很多例子，但不知道如何让我的查询工作。我运行了以下查询：

> 选择名称，（选择人口/地区）作为国家/地区的密度

其中列出了我国所有国家及其人口密度（人口除以面积）。但是，我想对我在这里得到的结果进行查询，只给我一行，它将返回具有 MAX 密度的国家/地区。这可能吗，如果可以，你能告诉我我所做的一切都是怎么做的吗？

谢谢你的帮助！

特里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:13:37.287

尝试这个：

```
select top 1 name, (select population/area) as density from country
order by 2 
```

# java - 为什么我的 Java 迷宫不起作用？

> ID：15422517
> 
> 赞同：3
> 
> 时间：2013-03-15T00:08:32.903
> 
> 标签：java

编码：

```
public void generateMaze(boolean Array[][], int val) 
{
    Stack<Integer> StackX = new Stack<Integer>();
    Stack<Integer> StackY = new Stack<Integer>();
    int x = val / 2; // Start in the middle
    int y = val / 2; // Start in the middle
    StackX.push(x);
    StackY.push(y);

    while(!StackX.isEmpty())
    {
        Array[x][y] = true; // is Visited
        x = StackX.peek();
        y = StackY.peek();

        if(Array[x][y+1] == false)
        {
            StackX.push(x);
            StackY.push(y+1);
            y = y + 1;
        }
        else if(Array[x][y-1] == false)
        {
            StackX.push(x);
            StackY.push(y-1);
            y = y - 1;
        } 
        else if(Array[x+1][y] == false)
        {
            StackX.push(x+1);
            StackY.push(y);
            x = x+1;
        } 
        else if(Array[x-1][y] == false)
        {
            StackX.push(x-1);
            StackY.push(y);
            x = x-1;
        } 
        else
        {
            StackX.pop();
            StackY.pop();
        }
    }
} 
```

每当我打印我的迷宫时，似乎迷宫中的每个点都返回为真值，因此用星号标记。有什么我做错了，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:20:14.610

问题是您使用布尔数组来指示两个不同的事物：

1）那里有一堵墙（最初在数组中设置为true）

2）您访问过该图块（在迷宫求解器中设置为 true）

相反，您需要保留两个阵列，并检查两者 - 不要走到墙上或选中的瓷砖上，但是当您走到新瓷砖上时，只需将其设置为已检查，而不是墙壁。然后，您将能够将 -wall -reached by solver -unreached by solver 打印为不同的字符。

（我假设 generateMaze() 命名错误，实际上是通过了一个在其他地方制作的生成迷宫。如果它通过了一个空迷宫，那么问题是你需要先制作一个迷宫；））

# css - 如何使用 CSS 获得类似样式的 Google 菜单按钮

> ID：15422518
> 
> 赞同：-1
> 
> 时间：2013-03-15T00:08:34.003
> 
> 标签：css

谷歌实现了一个非常简洁优雅的标签系统来在他们的网络服务中导航的方式给我留下了深刻的印象。下面是一张来自谷歌日历的图片。

![菜单](../Images/d0adfdaeabc1cdcc40a0f482697135f8.png)

我认为这可以使用纯 CSS 来实现。例如，假设我有这样的菜单；

```
<div class="menu">
  <div class="item">item1</div>
  <div class="item">item2</div>
  <div class="item">item3</div>
  <div class="item">item4</div>
</div> 
```

如何使用 CSS（带/不带图像）实现类似的外观。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:13:44.593

您可以使用开发人员工具（Firefox 中的 Chrome / IE / Firebug）来检查页面并准确了解他们是如何做到的。

我从 jsFiddle 开始，只需从那些特定按钮复制代码并获取 CSS 规则即可。显然我遗漏了一些，因为它看起来并不完全相同，但是当您添加更多规则时，您可以准确地看到他们为实现该结果所做的工作。

您可以直接从 Chrome 右侧的样式选项卡中复制整个 CSS 规则。

[http://jsfiddle.net/XLd3R/](http://jsfiddle.net/XLd3R/)

```
.goog-inline-block {
    position: relative;
    display: -moz-inline-box;
    display: inline-block;
}
.trans-strip {
    background: -webkit-linear-gradient(right, rgba(255, 255, 255, 1.0), rgba(255, 255, 255, .5));
    background: -moz-linear-gradient(right, rgba(255, 255, 255, 1.0), rgba(255, 255, 255, .5));
}
.button-strip {
    white-space: nowrap;
}
.goog-imageless-button-collapse-right {
    border-bottom-right-radius: 0;
    border-top-right-radius: 0;
    margin-right: -1px;
    -webkit-border-bottom-right-radius: 0;
    -webkit-border-top-right-radius: 0;
    -moz-border-radius-bottomright: 0;
    -moz-border-radius-topright: 0;
}
.goog-imageless-button, .navbuttonouter {
    background: #f5f5f5;
    background-image: -webkit-gradient(linear, left top, left bottom, from(#f5f5f5), to(#f1f1f1));
    background-image: -webkit-linear-gradient(top, #f5f5f5, #f1f1f1);
    background-image: -moz-linear-gradient(top, #f5f5f5, #f1f1f1);
    background-image: -ms-linear-gradient(top, #f5f5f5, #f1f1f1);
    background-image: -o-linear-gradient(top, #f5f5f5, #f1f1f1);
    background-image: linear-gradient(top, #f5f5f5, #f1f1f1);
    border: 1px solid #dcdcdc;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 2px;
    color: #444;
    cursor: pointer;
    font-size: 11px;
    font-weight: bold;
    height: 27px;
    line-height: 27px;
    min-width: 54px;
    outline: none;
    padding: 0 8px;
    text-align: center;
    transition: all .218s;
    -moz-border-radius: 2px;
    -moz-transition: all .218s;
    -moz-user-select: none;
    -o-transition: all .218s;
    -webkit-border-radius: 2px;
    -webkit-transition: all .218s;
    -webkit-user-select: none;
}
.goog-imageless-button, .navbuttonouter {
    color: #444;
    cursor: pointer;
    font-size: 11px;
    font-weight: bold;
    line-height: 27px;
    text-align: center;
} 
```

# regex - 在 Google AppEngine 上对不同文档类型进行模式匹配搜索

> ID：15422520
> 
> 赞同：0
> 
> 时间：2013-03-15T00:08:50.413
> 
> 标签：regex, google-app-engine, full-text-search

我有一个问题，如果你能回答我，我将不胜感激。

我需要为不同类型的文档（包括 Google Docs、PDF、DOC 等）实现模式匹配搜索。从我在这方面的研究来看，这种模式匹配在 GAE 上似乎不能直截了当。

我可以请您指导我如何在 GAE 上实现模式匹配吗？您是否推荐任何开源搜索引擎或本地 Google 搜索 API 来定制用于 GAE 上的模式匹配搜索？

如果你能回答我，我将不胜感激。非常感谢。

问候， 萨尔戈尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:29:42.643

AFAIK AppEngine 的设计目的是在将数据写入数据库之前强烈倾向于数据处理，而不是在读回期间/之后。虽然这通常会导致存储更多数据，但通常可以显着提高应用程序性能。

应用于您的案例，我会说您应该尝试想出一种方法，在将文档写入数据存储区时为您的文档构建和存储某种索引。然后使用此索引进行模式匹配。

由于您的问题尚不清楚您在谈论哪种模式匹配，因此很难提供更具体的建议。但是，例如，如果您只是在谈论关键字搜索，那么对于每个文档，您可以在数据存储区中拥有第二个实体，该实体存储文档的数据存储区键并包含具有多个值的属性（[App Engine 数据存储区：如何设置属性上有多个值？](https://stackoverflow.com/questions/1974243/app-engine-datastore-hot-to-set-multiple-values-on-properties)）列出文档中存在的所有关键字。然后，您可以对这些“索引对象”进行简单的等式查询，以查找与您的搜索词匹配的所有文档。

# javascript - 为什么我的 jquery load 语句没有将变量传递给 php？

> ID：15422523
> 
> 赞同：0
> 
> 时间：2013-03-15T00:09:01.063
> 
> 标签：javascript, jquery, function, load

在使用 load 语句传递 jquery 变量的文档中，我似乎找不到任何示例。我尝试使用和不使用引号，将整个变量语句放入，但没有运气。调试时其他一切似乎都可以工作，但没有传递变量，请看一下：编辑：我还应该说清楚我尝试了 {term: d} 和 {term: var d} 但都不起作用。

```
<script>
function callMe() {
    for (var i = 1; i< 2; i++){
        var b = $('#song'+i).val();
        var c = $('#artist'+i).val();
        var d = b +" "+ c; 
        // alert(d);
        //$('#results').load('getWeb.php', {term: d});
        $('#results').load('getWeb.php', {term: 'd'});
    }
    // var b = $('#song1').val();
    // alert(b);
}
$(document).ready(function(){
    callMe();
});
</script>

<form>
Song <input type ="text" name ="song1" id ="song1">
Artist <input type ="text"  name ="artist1" id ="artist1"><br />
<input type ='submit' value ='Submit' onClick="callMe();">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:18:08.903

我为你做了一个工作示例。一个起点。

```
<?php
if (isset($_POST['term'])) {
    echo $_POST['term'];
    exit;
}
?><!DOCTYPE html>
<html>
    <head>
        <title>Info</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script type="text/javascript">
            function callMe() {
                var b = $('#song1').val();
                var c = $('#artist1').val();
                var d = b + ":" + c;
                $('#results').load('', {term: d});
            }
            $(function() {
                $('form').submit(function() {
                    callMe();
                    return false;
                });
            });
        </script>
    </head>
    <body>

        <form action="" method="post">
            Song <input type ="text" name ="song1" id ="song1">
            Artist <input type ="text"  name ="artist1" id ="artist1"><br />
            <input type ='submit' name="info" value ='Submit'>
        </form>
        <div id="results">

        </div>

    </body>
</html> 
```

# java - 网络收获 - 抓取一个网址

> ID：15422524
> 
> 赞同：2
> 
> 时间：2013-03-15T00:09:11.077
> 
> 标签：java, eclipse, web, web-scraping, webharvest

我正在使用网络收获。但是，我想从 URL 中抓取数据：

> [http://derstandard.at/anzeiger/immoweb/Suchergebnis.aspx?Regionen=9&Bezirke=&Arten=&AngebotTyp=×tamp=1363305908912](http://derstandard.at/anzeiger/immoweb/Suchergebnis.aspx?Regionen=9&Bezirke=&Arten=&AngebotTyp=&timestamp=1363305908912)

我的代码是：

```
<?xml version="1.0" encoding="UTF-8"?>

<config>
    <var-def name="google">
    <html-to-xml>
    <http url="http://derstandard.at/anzeiger/immoweb/Suchergebnis.aspx?Regionen=9&Bezirke=&Arten=&AngebotTyp=&timestamp=1363305908912"></http>
    </html-to-xml>
    </var-def>
</config> 
```

但是我得到：

> 对实体 Bezirke 的引用必须以“;”结尾

我不明白网络收获是什么意思，带有';'？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T11:04:09.630

您应该在您的网址中编码与符号，即。改变每`&`一个`&amp;`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:17:03.507

我不太了解网络收集，但他们的例子有：

```
<xpath expression="//a[@shape='rect']/@href">
    <html-to-xml>
        <http url="http://www.somesite.com/"/>
    </html-to-xml>
</xpath>

<http url =".." /> 
```

而你的代码有

```
<http url = ".."></http> 
```

也许这是你的问题？不需要结束标签

# android - 使用意图配置特定小部件

> ID：15422526
> 
> 赞同：0
> 
> 时间：2013-03-15T00:09:13.050
> 
> 标签：android, android-widget

我有自动添加到启动器的小部件，但其中一些小部件需要配置，所以我设置了一个 onClick 侦听器来获取 id 并获取小部件信息以启动 Activity 以配置小部件，但我遇到的问题是当我从天气小部件的 Activity 返回时，它失败的部分在 create 方法中，当我尝试通过小部件 id 获取 appWidgetInfo 时，但 id 带着意图返回。我不知道出了什么问题，有人可以帮我解决这个问题吗？

```
 AppWidgetManager mAppWidgetManager;
    AppWidgetHost mAppWidgetHost;
    LinearLayout mainlayout;
    ComponentName cn = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mainlayout = (LinearLayout) findViewById(R.id.mylauncher);
    mainlayout.setOnClickListener(this);

    mAppWidgetManager = AppWidgetManager.getInstance(this);
    mAppWidgetHost = new AppWidgetHost(this, R.id.APPWIDGET_HOST_ID);

    // search widgets
    searchWidgets();

}

public void searchWidgets() {
    String widget = "com.weather.Weather.widgets.WeatherWidgetProvider4x1";
    try {

        mAppWidgetManager = AppWidgetManager.getInstance(getBaseContext());
        final List<AppWidgetProviderInfo> infos = mAppWidgetManager
                .getInstalledProviders();
        AppWidgetProviderInfo appWidgetInfo = null;
        for (final AppWidgetProviderInfo info : infos) {
            Log.v("Available Widgets", "label " + info.label + " ::"
                    + info.provider.getPackageName() + " / "
                    + info.provider.getClassName());
        }

        for (final AppWidgetProviderInfo info : infos) {
            Log.v("Searching for Widget class",
                    info.provider.getPackageName() + " / "
                            + info.provider.getClassName());

            if (widget.equals(info.provider.getClassName())) {
                String packageName = info.provider.getPackageName()
                        .toString();
                cn = new ComponentName(packageName, widget);
                // found it
                appWidgetInfo = info;
                Log.d("FOUND !!!!!!!!!", "Widget class " + packageName);

                break;
            }

        }

        mAppWidgetHost = new AppWidgetHost(getBaseContext(),
                R.id.APPWIDGET_HOST_ID);

        if (appWidgetInfo == null) {
            Log.d(TAG, cn + " No such widget available returning view");

            // return; // stop here
        } else {

            int appWidgetId = mAppWidgetHost.allocateAppWidgetId();

            AppWidgetHostView hostView = mAppWidgetHost.createView(this,
                    appWidgetId, appWidgetInfo);
            hostView.setAppWidget(appWidgetId, appWidgetInfo);

            AppWidgetHostView hostViewsecond = mAppWidgetHost.createView(
                    this, appWidgetId, appWidgetInfo);
            hostView.setAppWidget(appWidgetId, appWidgetInfo);

            hostView.setId(appWidgetInfo.previewImage);

            Drawable draw = null;
            String packageName = appWidgetInfo.provider.getPackageName();
            try {
                draw = this.getPackageManager().getDrawable(packageName,
                        appWidgetInfo.previewImage,
                        this.getPackageManager().getApplicationInfo(packageName,
                                0));
            } catch (NameNotFoundException e) {
                Log.d(TAG, "drawable not found",e);
            }

            ImageView preViewWigdet = new ImageView(this);
            preViewWigdet.setImageDrawable(draw);
            preViewWigdet.setId(appWidgetInfo.previewImage);

            mainlayout.addView(preViewWigdet);

        }

    } catch (SecurityException securityEx) {
        Log.e("Bind Widget",
                "Error device not rooted,  returning view, Security exception:- ",
                securityEx);

    }
}

@Override
public void onClick(View v) {
    AppWidgetProviderInfo widgetItem = null;
    mAppWidgetHost = new AppWidgetHost(this, R.id.APPWIDGET_HOST_ID);
    int appWidgetId = mAppWidgetHost.allocateAppWidgetId();

    if (view.getClass().equals(ImageView.class)){
    // putting installed Providers in a list
    final List<AppWidgetProviderInfo> infos = mAppWidgetManager
            .getInstalledProviders();
    for (int i = 0; i < infos.size(); i++) {
        if (infos.get(i).previewImage == view.getId()) {
            widgetItem = (AppWidgetProviderInfo) infos.get(i);
        }
    }
    ComponentName cn = new ComponentName(
            widgetItem.provider.getPackageName(),
            widgetItem.provider.getClassName());

    int[] ids;
    ids = mAppWidgetManager.getAppWidgetIds(cn);
    Intent intent = new Intent(AppWidgetManager.ACTION_APPWIDGET_CONFIGURE);

    intent.setComponent(widgetItem.configure);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);

    if (widgetItem.configure != null) {
        Log.d(TAG, "widget to be configured " + widgetItem.label);
        ((Activity) this).startActivityForResult(intent,
                R.id.REQUEST_CREATE_APPWIDGET);
    }

}
}

/**
 * If the user has selected an widget, the result will be in the 'data' when
 * this function is called.
 */
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    Log.d(TAG, "" + resultCode);
    if (resultCode == RESULT_OK) {
        if (requestCode == R.id.REQUEST_PICK_APPWIDGET) {
            configureWidget(data);
        }
        if (requestCode == R.id.REQUEST_CREATE_APPWIDGET) {
            mAppWidgetManager = AppWidgetManager.getInstance(this);
            createWidget(data);
        }
    } else if (resultCode == RESULT_CANCELED && data != null) {
        int appWidgetId = data.getIntExtra(
                AppWidgetManager.EXTRA_APPWIDGET_ID, -1);
        if (appWidgetId != -1) {
            mAppWidgetHost.deleteAppWidgetId(appWidgetId);
        }
    }
}

/**
 * Checks if the widget needs any configuration. If it needs, launches the
 * configuration activity.
 */
private void configureWidget(Intent data) {
    Bundle extras = data.getExtras();
    int appWidgetId = extras
            .getInt(AppWidgetManager.EXTRA_APPWIDGET_ID, -1);
    AppWidgetProviderInfo appWidgetInfo = mAppWidgetManager
            .getAppWidgetInfo(appWidgetId);
    if (appWidgetInfo.configure != null) {
        Intent intent = new Intent(
                AppWidgetManager.ACTION_APPWIDGET_CONFIGURE);
        intent.setComponent(appWidgetInfo.configure);
        intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);
        startActivityForResult(intent, R.id.REQUEST_CREATE_APPWIDGET);
    } else {
        createWidget(data);
    }
}

/**
 * Creates the widget and adds to our view layout.
 */
public void createWidget(Intent data) {
    Bundle extras = data.getExtras();
    int appWidgetId = extras
            .getInt(AppWidgetManager.EXTRA_APPWIDGET_ID, -1);

  //this is where I am having the problem, appWidgetInfo returns null
    AppWidgetProviderInfo appWidgetInfo = this.mAppWidgetManager
            .getAppWidgetInfo(appWidgetId);

    AppWidgetHostView hostView = mAppWidgetHost.createView(this,
            appWidgetId, appWidgetInfo);
    hostView.setAppWidget(appWidgetId, appWidgetInfo);
    mainlayout.addView(hostView);

    Log.i(TAG, "The widget size is: " + appWidgetInfo.minWidth + "*"
            + appWidgetInfo.minHeight);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T22:49:16.557

我猜“this.mAppWidgetManager.getAppWidgetInfo(appWidgetId)”行返回 null，因为我无法在代码中将 Appwidget id 绑定到 AppwidgethostInfo 提供程序的任何地方看到

尝试用谷歌搜索 bindAppWidgetIdIfAllowed 函数以查看它是如何工作的，您可能需要对 ACTION_APPWIDGET_BIND 进行另一个 Activity 调用

# python - 最佳实践：如何在 setup.py 中列出所需的依赖项？

> ID：15422527
> 
> 赞同：56
> 
> 时间：2013-03-15T00:09:33.307
> 
> 标签：python

这就是我目前的做法：

```
import os
from setuptools import setup, find_packages
here = os.path.abspath(os.path.dirname(__file__))

requires = [
    'pyramid',
    'pyramid_debugtoolbar',
    'waitress',
    'requests',
    'mock',
    'gunicorn',
    'mongoengine',
    ]

setup(name='repoapi',
      version='0.0',
      description='repoapi',
      packages=find_packages(),
      include_package_data=True,
      zip_safe=False,
      install_requires=requires,
      tests_require=requires,
      test_suite="repoapi",
      entry_points="""\
      [paste.app_factory]
      main = repoapi:main
      """,
      ) 
```

这是一个好的方法吗？我有一些麻烦。例如，对于金字塔，我不能使用系统范围的 nosetests 插件来运行测试。我需要安装`pyramid`在全局 python 站点包中！

但我不想那样。所以我必须在这个项目的virtualenv中安装nose。但我不希望它成为依赖项。我觉得它不应该属于`requires`. 它不是。然而，我也不想一直手动安装。是的，我知道我有很多我不想做这个和那个...

但是你会怎么解决呢？我不想篡改全局 python 站点包，但我想将鼻子安装为 virtualenv 的一部分。

此外，pip install 要求文件。它稍微准确一点，因为我不需要手动指定版本，也不需要害怕手动更新 setup.py。扔就`pip freeze > file.txt`完成了。

但是，pip 可以返回垃圾，因为我们将垃圾包扔到 virtualenv 中。

这么多刀片。最佳做法是什么？你如何处理这些问题？

也许我错过了，但是[https://github.com/django/django/blob/master/setup.py](https://github.com/django/django/blob/master/setup.py)，Django 是怎么做到的？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-03-15T00:31:57.997

您可以将您的需求拆分为“安装”依赖项和“测试”依赖项，如下所示：

```
import os
from setuptools import setup, find_packages
here = os.path.abspath(os.path.dirname(__file__))

install_requires = [
    'pyramid',
    'pyramid_debugtoolbar',
    'waitress',
    'requests',
    'gunicorn',
    'mongoengine',
    ]

tests_require = [
    'mock',
    'nose',
    ]

setup(name='repoapi',
      ...
      install_requires=install_requires,
      tests_require=tests_require,
      test_suite="nose.collector",
      ...
      ) 
```

这样，当有人安装包时，只安装“安装”依赖项。因此，如果有人只想使用该包（并且他们对运行测试不感兴趣），那么他们不必安装测试依赖项。

当你确实想运行测试时，你可以使用这个：

```
$ python setup.py test 
```

根据[文档](https://setuptools.readthedocs.io/en/latest/setuptools.html?highlight=tests_require#new-and-changed-setup-keywords)：

> 请注意，这些必需的项目不会安装在运行测试的系统上，如果它们尚未在本地安装，则只会下载到项目的安装目录。

一旦“test”依赖项就位，它将运行“test_suite”命令。由于您提到鼻子是您首选的测试运行器，所以我展示了您如何[使用“nose.collector”](https://nose.readthedocs.org/en/latest/setuptools_integration.html)来配置它。

顺便说一句，Django setup.py 并不是了解 setuptools 基础知识的最简洁示例。我认为[Sentry setup.py](https://github.com/getsentry/sentry/blob/master/setup.py)是一个更好的学习示例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-04-16T11:09:16.363

如果您使用的是需求文件，那么另一种方法是读取它们的内容而不是复制它：

```
import pathlib
from setuptools import setup, find_packages

HERE = pathlib.Path(__file__).parent
INSTALL_REQUIRES = (HERE / "requirements.txt").read_text().splitlines()
TESTS_REQUIRE = (HERE / "test-requirements.txt").read_text().splitlines()[1:]

setup(...,
      install_requires=INSTALL_REQUIRES,
      tests_require=TESTS_REQUIRE,
      ...
      ) 
```

我发现这种方法更稳定，更不容易出错，因为需求有时会发生变化，而且人们经常忘记更新两个地方。

注意：注意`TESTS_REQUIRE`从第二行开始，这是因为第一行`test-requirements.txt`经常是`-r requirements.txt`. 如果您的情况不同，请随时更改它。

# asp-classic - UIAutomation 在 CodeCharge 4.3 中自动化软件构建/发布 - SendKeys 的简单健壮替代方案？

> ID：15422533
> 
> 赞同：1
> 
> 时间：2013-03-15T00:10:06.330
> 
> 标签：asp-classic, microsoft-ui-automation, codecharge

我正在尝试使用 CodeCharge 4.3 自动化在 Classic ASP 中实现的大型项目的构建/发布。

我知道 Classic ASP 是一种脚本语言，我们的应用程序本身并没有真正“编译”，但在发布过程中，CodeCharge ID 可以检测到已损坏的页面，不幸的是，这对我们来说是一个常见事件。我想将它连接到 TeamCity for CI。

CodeCharge 没有命令行界面，因此需要自动化 UI，

我一直在使用 .NET UIAutomation 类，并成功地让 IDE 加载、触发发布、从输出窗口捕获输出，然后退出。

为了触发发布，我使用[http://inputsimulator.codeplex.com/](http://inputsimulator.codeplex.com/)发送 F9 按键。我对此并不完全满意，因为如果 CodeCharge 失去焦点，它就会倒下。有没有办法使用 UIAutomation 将 F9 按键发送到窗口，而不管它是否具有焦点？

发布也可以从工具栏、菜单或附加到树视图的上下文菜单中触发。我对这些中的任何一个都没有太多运气，因为这些元素似乎没有暴露出来。例如，使用inspect.exe，我可以找到工具栏（Name="Standard", Classname="CCSToolbarWindow"），但inspect.exe 或我的UIAutomation 应用程序都看不到它下面的任何内容。工具栏元素上唯一可用的模式 inspect.exe 是“IsLegacyIAccessiblePatternAvailable = True。我想我可能会在特定坐标处向工具栏发送左键单击事件，但这超出了我的范围。

我认为因为这个应用程序已经很老了，如果我要继续追求，我可能不得不看看非托管 UIAutomation 的东西，或者更深入地了解 Win32 API 或其他东西，但我希望有一个更简单的解决方案。

# c - 选择要实现的压缩算法

> ID：15422537
> 
> 赞同：4
> 
> 时间：2013-03-15T00:10:23.043
> 
> 标签：c, encoding, compression, information-theory

我已经获得了一些课程来实现我选择的压缩算法。它可以是任何语言，但我最了解的语言是 Java，其次是 C。它将基于 -

1.  解压后的输出必须和原始输入匹配，所以只能看lossless的算法。

2.  运行时间必须与消息的长度成比例。

3.  内存要求必须与消息的长度无关。

我们的实现将按如下方式进行测试 -

1.  标准文本文件

2.  字节值范围为 0-255 的二进制文件

3.  一个约 10mb 的未指定内容的大文件。

我最初的想法是使用动态算术编码，但我想知道是否有更适合上述约束的算法？其次，用 C 语言而不是 Java 语言是更好的主意吗？我问这个是因为我认为 C 的内存占用会更小，但我不确定是否真的如此。

我花了一些时间在谷歌上搜索这个问题，一些网站提到 LZW 编码与动态霍夫曼编码相结合。这会是一个明智的追求途径吗？我们的讲师确实警告我们，多年来尝试动态霍夫曼编码的提交中有 90% 没有正确实施。

也就是说，我不害怕尝试一下，但在开始之前我会重视一些意见。

任何反馈将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T04:29:48.553

只是 LZW，没有其他编码，非常简单，而且工作得非常好。现在没有人会真正使用 LZW，因为还有其他算法可以更快地压缩。然而，对于一个任务，你无法击败 LZW 的简单性。没有霍夫曼，动态或其他。没有香农-法诺。没有算术或范围编码。是的，内存使用量与消息的长度无关。Mark Nelson 写了一个[很好的解释](http://marknelson.us/1989/10/01/lzw-data-compression/)。

您可以在 C 或 Java 中执行此操作，尽管 C 可能不太容易出错，因为它具有无符号类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:52:10.107

内存限制建议使用某种自适应编码。算术编码很好。但是您没有指定任何有关性能的内容。该算法是否必须达到特定类别文件的任何性能目标？仅复制文件的算法满足上述要求，（但不会教你太多）。

对于语言的选择，请使用您更熟悉的语言。将要执行很多位操作，因此 C 或 Java 都适合。您应该编写一些代码来处理将文件转换为比特流并再次返回，并将其作为一个单独的模块。我可以看到在 C 或 Java 中这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T00:23:59.717

为了回答我自己的问题，Shannon-Fano 对于这样的任务应该“足够好”。如果您从未在数据压缩领域做过任何事情，我建议您远离霍夫曼编码（或算术编码的专门版本）。

据此[，](http://www.stringology.org/DataCompression/sf/index_en.html)顺丰满足您的空间/时间要求。我建议**先**实施类似的东西。伪代码由下式给出：

```
 1:  begin
 2:     count source units
 3:     sort source units to non-decreasing order
 4:     SF-SplitS
 5:     output(count of symbols, encoded tree, symbols)
 6:     write output
 7:   end
 8:  
 9:  procedure SF-Split(S)
10:  begin
11:     if (|S|>1) then
12:      begin
13:        divide S to S1 and S2 with about same count of units
14:        add 1 to codes in S1
15:        add 0 to codes in S2
16:        SF-Split(S1)
17:        SF-Split(S2)
18:      end
19:  end 
```

只有当您彻底了解 SF（或者您之前已经实现过类似的算法）时，我才会建议您采用更严格的算术编码方法。我最近为一门*信息理论*课实施了 SF，但在我理解它之前，它的某些部分似乎不直观且奇怪。在纸面上，它看起来很简单，但是（像许多其他算法一样）可能具有欺骗性。

除非你获得额外的“风格点数”，否则我个人会选择 Shannon-Fano。

# android - 加载时在 textview 中填充数据

> ID：15422540
> 
> 赞同：0
> 
> 时间：2013-03-15T00:10:46.307
> 
> 标签：android, tabs

我正在尝试在加载时将数据加载到文本视图中。我的应用程序使用片段并具有三个选项卡。我能够将数据加载到前两个选项卡中，但是当我尝试将数据加载到第三个选项卡时出现空指针异常。这是代码：

```
public void readAndLoadDataFromFile()
{
    String[] fieldNamesInFile = new String[50];
    double[] valuesInFile = new double[50];
    // read all the data from file
    readAllDataFromFile(fieldNamesInFile, valuesInFile);

    // Tab 1
    double value1 = valuesInFile[Arrays.asList(fieldNamesInFile).indexOf("Field1")];
    // copy the data into the fields
    ((EditText) findViewById(R.id.editText1)).setText(String.valueOf(value1)); // OK

    // Tab 2
    double value2 = valuesInFile[Arrays.asList(fieldNamesInFile).indexOf("Field2")];
    // copy the data into the fields
    ((EditText) findViewById(R.id.editText2)).setText(String.valueOf(value2)); // OK

    // Tab 3
    double value3 = valuesInFile[Arrays.asList(fieldNamesInFile).indexOf("Field3")];
    // copy the data into the fields
    ((EditText) findViewById(R.id.editText3)).setText("123"); // null pointer exception

} 
```

选项卡 3 的布局 XML 文件如下（前两个选项卡类似）：

```
<ScrollView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/myScrollView"
android:layout_width="fill_parent" 
android:layout_height="wrap_content">

<TableLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<TableRow
        android:id="@+id/tableRow3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp" >

        <TextView
            android:id="@+id/textView3"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:text="Text 3:"
            android:clickable="true"
            android:gravity="right"
            android:layout_weight="2"
            android:layout_marginRight="2dp"
            android:textAppearance="?android:attr/textAppearanceSmall" />

        <EditText
            android:id="@+id/editText3"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:gravity="right"
            android:layout_weight="1"
            android:layout_marginLeft="2dp"
            android:ems="10"
            android:text="25"
            android:inputType="numberDecimal"
            android:textAppearance="?android:attr/textAppearanceSmall" />

</TableRow>
</TableLayout>

</ScrollView> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:53:35.623

有时项目只需要重建 R 文件。您可以尝试 Eclipse 中的“Clean”选项（选择 Project -> Clean 并选择您的项目）。您还可以检查 R 文件以查看该条目是否存在。R 文件位于`gen`目录中。如果不是，您可以尝试删除 R 文件并在再次编译时让它重建，然后查看它是否出现。

要检查的另一件事是确保正在访问的 R 文件不是 Android R 文件。检查您的导入，或通过将您的行更改为设置为您的包名称`((EditText) findViewById(com.yourproject.app.R.id.editText3)).setText("123");`的部分来强制它。`com.yourproject.app`这样做将确保您获得正确的 R 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T20:53:10.270

通过强制导航转到特定选项卡并加载视图来修复（破解）问题。

```
ActionBar actionBar = getActionBar();
actionBar.setSelectedNavigationItem(2); // go to Tab 3

double value3 = valuesInFile[Arrays.asList(fieldNamesInFile).indexOf("Field3")];
// copy the data into the fields
((EditText) findViewById(R.id.editText3)).setText("123"); // no more null pointer exception 
```

不为自己感到骄傲，但至少它现在解决了问题。

# c# - 文本框对象参考

> ID：15422542
> 
> 赞同：0
> 
> 时间：2013-03-15T00:11:24.853
> 
> 标签：c#, winforms, textbox

如何`TextBox`在 form1.cs 文件的另一个自定义类中引用对象（比如 textBox1）？

在`myclass`，我写过`textBox1`，但智能感知没有向我建议。将私有更改为公共并不能解决问题。

这是form1.cs的示例代码

```
namespace Calculator {
    public partial class Form1: Form {
        public Form1() {
            // InitializeComponent(); 
        }

        class myclass {
            // What can I do to make texbox1 show up in intelliSense here? 
            // textBox1
        }

        public System.Windows.Forms.TextBox textBox1;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:40:54.207

如果你想直接在 的范围内引用它`myClass`，那么将它声明为静态。

或者您需要一个 的实例`Form1`，但这不允许您在类定义范围内声明对它的引用，您需要`Form1`在构造函数（或类型初始化程序）中实例化实例，您可以将其分配给`myClass`.

```
namespace Calculator {
    public partial class Form1: Form {
        public Form1() {
            InitializeComponent(); 
        }

        class myclass {
            TextBox textBox3=Form1.textBox1;
            TextBox textBox4;
            Form1 form1;

            public myclass() {
                form1=new Form1();
                textBox4=form1.textBox2;
            }
        }

        static public System.Windows.Forms.TextBox textBox1;
        public System.Windows.Forms.TextBox textBox2;
    }
} 
```

* * *

更新：

对于 的当前实例`Form1`，以下是实例化时传递当前实例**的各种方法之一**`myclass`

```
namespace Calculator {
    public partial class Form1: Form {
        public Form1() {
            InitializeComponent();

            textBox1=textBox2; // demonstration for "static make sense"

            var x=new Form1.myclass {
                form1=this
            };

            // now x.textBox3 is reference to textBox2
        }

        public class myclass {
            TextBox textBox3=Form1.textBox1;
            TextBox textBox4;
            internal Form1 form1;

            public myclass() {
                // form1=new Form1();
                textBox4=form1.textBox2;
            }
        }

        static public System.Windows.Forms.TextBox textBox1;
        public System.Windows.Forms.TextBox textBox2;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T00:46:47.177

嵌套类型与其包含类型具有静态关系。这意味着默认情况下，它们无权访问包含类型的任何特定实例。如果您希望内部类型从包含类型访问某些字段，则必须将一个实例传递给内部类型。最常见的方法是将实例传递给嵌套类型的构造函数。

```
public partial class Form1: Form {
    public Form1() {
        // InitializeComponent(); 
    }

    class myclass {
        private Form1 parent;

        public myclass(Form1 parent) {
            this.parent = parent;
        }

        public void DoSomething() {
            parent.textBox1.Text = "Hello, World!";
        }
    }

    public System.Windows.Forms.TextBox textBox1;
} 
```

# javascript - 如何使用 jQuery 从 Web Worker 线程中解析 XML

> ID：15422551
> 
> 赞同：3
> 
> 时间：2013-03-15T00:12:33.293
> 
> 标签：javascript, jquery, performance, xml-parsing, web-worker

***略读？只需阅读粗体字即可。***

朋友们好！我正在构建一个需要进行一些严肃的 XML 处理的**Web 应用程序。**

我目前有一个**使用 jQuery 来解析和操作大量 XML 文档的函数。**这**会将浏览器的 UI 锁定长达 60 秒**，这显然是非常糟糕的。

我一直在研究[*Web Workers*](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers)，因为**我想在 Web Worker 线程中运行此操作以减轻浏览器的 UI。**

我**希望我可以使用 Web Worker`self.importScripts()`来导入 jQuery 库，从 Web Worker 线程中解析和操作 XML。**
   **不能做：** Web **Worker 会抛出错误，例如`window is not defined`，**因为 jQuery 库引用了 window 和 Friends，它们不是线程安全的，因此不存在于 Web Worker 的全局命名空间中。

我做了很多谷歌搜索，但**很难找到有关此主题的任何最新信息。**我发现了一些 hacky 变通办法和 jQuery 插件，但它们都已经有好几年的历史了，我一直希望我错过了针对这种相对较新的技术的更新解决方案。
   **是否存在（半）官方的*“Web Worker jQuery”*？**

我找到[*了 XMLforScript*](http://xmljs.sourceforge.net/index.html)，它是 jQuery 的替代品，应该在 Web Worker 中运行——但**我专门寻找 jQuery 解决方案，**因为我不想重写我的代码。

在调用之前，我很想尝试创建一系列假元素来缓解 Web Worker 中 jQuery 的错误`importScripts()`，如下所示：

```
window={
    document:{
        createElement:function(){
            return {
                setAttribute:function(){} } } } };
    /* ... much more fake DOM */
    importScripts('jquery.js'); 
```

但是，我意识到我必须非常深入地创建一个巨大的人工 DOM 来满足 jQuery，并且认为这可能是一条通向失败和浪费时间的道路，因为 jQuery 可能依赖于其中一些对象来进行 XML 解析（我对 jQuery 的工作原理知之甚少）。

**有没有人有任何可爱的解决方案？**

如果没有，我将制作一个脂肪静态加载指示器，以警告用户恶作剧需要时间，他们必须信任并希望网络应用程序没有崩溃或停止工作：D

感谢您的思考。
  //追赶。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-24T12:20:08.510

您应该能够使用此方法中的想法，[该方法](http://www.html5gamedev.de/2013/07/19/a-start-on-multi-threading-using-web-workers/)使用[Blob](https://developer.mozilla.org/en-US/docs/Web/API/Blob)为 web worker 提供对原始 dom 的访问权限。

**更新**

~~`DOM`正如[这个](http://jsfiddle.net/unKCK/)玩具示例应该演示的那样，工人确实可以访问~~。

上述声明是一个公然的谎言（感谢OP）。见更新二

**更新二**

正如 OP 在下面的评论中正确指出的那样，给出的示例是作弊。如果您能够从 JQuery 中解放出来，我有一个示例，它使用功能强大的[xml for <script>](http://xmljs.sourceforge.net/)库对 xml 文档进行一些 SAX 处理。我已将示例发布到[github](https://github.com/manniche/js-webworkers)。执行时，将结果写入`console`，因此打开一个。

我在[这里](http://things.manniche.net/)上传了代码用于演示目的。

[此外，在这个 SO question](https://stackoverflow.com/q/18056922/1448983)中还提供了对 web 工作者和 DOM 不可访问性的深入讨论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-01T02:08:31.780

只是为了添加一个可能的替代方案，您可能需要查看[Hive](https://github.com/rwaldron/jquery-hive)，或者特别是子项目 Pollen.js，它为工作人员提供了 jQuery 的许多功能（尽管显然没有直接操作 DOM）。

# ios - 如何将 CCTexture2D 添加到 CCTextureCache cocos2d

> ID：15422552
> 
> 赞同：0
> 
> 时间：2013-03-15T00:12:37.907
> 
> 标签：ios, cocos2d-iphone, cctexturecache

我有一些加密的图像。它们很重，所以我想通过将它们添加到 CCTextureCache 来预加载它们。但是 CCTextureCache 不接受 CCTexture2D 作为参数。我该怎么办？

```
CCTexture2D *img = [[[CCTexture2D alloc] initWithImage:[UIImage imageWithContentsOfEncryptedFile:path]] autorelease];

        [[CCTextureCache sharedTextureCache] addImage:img]; // not accepted!! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:20:43.130

两种选择：

*   添加一个方法来缓存 CCTexture2D* 带有键的对象（唯一字符串）
*   将 UIImage 保存到磁盘（在 Application Support 目录中），然后使用 cocos2d 正常加载它

由于保存和加载过程，后一个选项将导致明显的延迟。我推荐第一种方法。您编写该函数所需的大部分代码已经在 CCTextureCache 中，我相信甚至可能只有您需要的方法只需要在接口中公开。

# sql - 将 SQL Server 数据库迁移到多个文件

> ID：15422555
> 
> 赞同：3
> 
> 时间：2013-03-15T00:12:54.603
> 
> 标签：sql, sql-server, database-migration, solid-state-drive, dbcc

我有一个生产中的 SQL Server 2008 数据库，我们正在将其转移到新服务器上。当前数据库有一个约 400GB 的`.MDF`文件。新服务器将运行 SQL Server 2012，我们正在运行镜像 Intel 910 SSD。这些驱动器将为我们提供 4 个 200GB 分区。

为了完成这项工作，我们需要`.MDF`使用`DBCC SHIRNKFILE with EMPTYFILE`. 我们已经在测试中这样做了，但仍然需要大约 3.5 小时才能完成，这太长了。现有的数据库是OLTP，365/24/7，我知道在这个过程中会发生阻塞，所以我们不能先在生产上做。

我的问题，有没有办法将数据库备份和恢复到临时位置的新服务器，创建新文件，`EMPTY`临时`.MDF`到新位置，然后应用事务日志？这样我们就可以在当前旧生产启动并运行时移动数据，然后短暂关闭，应用日志并启动新数据库？

或者是否有任何其他选项可以从服务器 A 获取一个文件，服务器 B 在不同驱动器上获取 4 个文件，并且停机时间最短？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:35:23.173

如果您有磁盘空间，您可以做的一种方法是：

*   在新服务器上恢复数据库
*   创建一个新的文件组
*   `DROP_EXISTING=ON`使用（并指定新文件组）在新文件组上创建所有索引
*   删除旧文件组

这不适用于大对象数据，您需要手动将其移动到新表中。

语法类似于：

```
CREATE CLUSTERED INDEX [index]  
ON [schema].[table]([columns)
WITH (DROP_EXISTING = ON, ONLINE = ON) 
ON [filegroup] 
```

在创建新索引时，索引可能会保持在线。不过，这将导致 tempdb 使用更多空间。

# linux - snmptranslate 在使用 snmp 和 snmpd 的 ubuntu 中不起作用

> ID：15422556
> 
> 赞同：1
> 
> 时间：2013-03-15T00:13:09.973
> 
> 标签：linux, ubuntu, snmp, snmpd

![在此处输入图像描述](../Images/da959a25bfccdacac53df37b8a59c167.png)[来自网址http://manpages.ubuntu.com/manpages/natty/man1/snmptranslate.1.html](http://manpages.ubuntu.com/manpages/natty/man1/snmptranslate.1.html) 的所有 cmd

或者

人 snmptranslate

* * *

snmptranslate - 到

snmptranslate -Ts

并且所有命令都没有在我的 ubuntu 12.10 Linux 上运行。

我已经安装了 snmp 和 snmpd 使用

sudo apt-get install snmpd

sudo apt-get 安装 snmp

我在安装这些后发现的 snmptranslate cmd。请帮助我，如果我忘记安装某些软件包，请告诉我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:39:19.637

看起来你错过了 mibs。它们不存在（sudo apt-get install snmp-mibs-downloader）或 /etc/snmp/snmp.conf 设置不正确。我会尝试 get 然后查看 snmp.conf 以查看它是否正确设置了 mibdirs 或错误地设置了 mibs。

我做了一个快速的网络搜索，看起来 Ubuntu 没有安装 mib，所以以上是必要的（无法确认，因为我的 linux 机器是 Centos）。

# android - Android：如何找到不会导致应用崩溃的位图范围？

> ID：15422559
> 
> 赞同：0
> 
> 时间：2013-03-15T00:13:19.407
> 
> 标签：android, bitmap, crash

在尝试从网络流中解码位图时，我偶尔会导致应用程序崩溃，以防位图范围超过允许的内存大小。

为了克服这个问题，我使用了这里解释的策略：

[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

由于我使用宽度和高度为 500x500 的谨慎方法作为 calculateInSampleSize 的输入，因此我不再遇到内存问题，但客户抱怨缩小图像的图像质量差。

因为我似乎没有明显的方法来确定不会崩溃*的*位图范围，所以不幸的是，我不得不尝试使用相当低的值（此处为 500x500），而在具体情况下 1000x1000 也可以正常工作。

有没有办法找出作为calculateInSampleSize 输入的位图范围是最大范围，这不会在后续调用例如decodeByteArray 时使应用程序崩溃？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T09:37:04.420

好的，我找到了方法。我喜欢在这里分享，也许有一些优点和缺点。

1）首先（这与我的原始代码没有改变）我正在确定位图的原始范围，它在函数的 byte[] 中可用：

```
 BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeByteArray(byteArray, 0, byteArray.length, options);

    /* Here we have the original dimensions of the bitmap */
    int iH = options.outHeight;
    int iW = options.outWidth;
    String iT = options.outMimeType; 
```

2）然后我试图找到最好的缩放值，最终会产生一个不大于 2048x2048 的位图，因为这似乎是 OpenGL 的限制（至少痕迹告诉我类似的东西）

```
 int rh = iH;
    int rw = iW;
    int sz = 1;

    while (true) {
        rh = Math.round((float)iH/(float)(sz));
        rw = Math.round((float)iW/(float)(sz));
        if (rh <= 2048 && rw <= 2048)
            break;
        sz++;
    } 
```

3）最后我正在创建新的（可能是缩小的图像）并尝试在这里捕获可能的内存溢出错误。然后我可以用一个增加的正增量重新迭代到 sz，但我决定只返回 null。

```
 options.inJustDecodeBounds = false;
    options.inSampleSize = sz;
    Bitmap bm = null;
    try {
        bm = BitmapFactory.decodeByteArray(byteArray, 0, byteArray.length, options);
    }
    catch (OutOfMemoryError e) {
    }
    return bm; 
```

这对我来说很好。

# animation - 无法为子视图的框架设置动画

> ID：15422560
> 
> 赞同：0
> 
> 时间：2013-03-15T00:13:34.010
> 
> 标签：animation, uiimageview, frame, subview

我正在尝试为子视图的框架设置动画，但它不起作用：

```
[UIView animateWithDuration:0.5
                   animations:^{
                   NSLog(@"BIIIM %@", [_subView subviews]);
                   UIImageView *imageView1 = (UIImageView *)[self.view viewWithTag:(1)];{
                             imageView1.frame = CGRectMake(76.8 , -100, 33.4, 164);
                             imageView1.alpha = 0.5;   
                                                              } 
```

alpha 的动画工作得很好，但帧的动画不是......知道吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:36:35.327

我做了一个简单的测试如下，发现它工作正常。alpha 和 frame 都发生了变化。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UIImageView *imageView1  = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 30, 30)];
    imageView1.backgroundColor = [UIColor redColor];
    [self.view addSubview:imageView1];

    [UIView animateWithDuration:2 animations:^{
        imageView1.frame = CGRectMake(20, 20, 100, 100);
        imageView1.alpha = 0.5;
    }];

} 
```

# java - 有些参数可以在方法中更改，但有些参数不能在 java 中更改

> ID：15422562
> 
> 赞同：2
> 
> 时间：2013-03-15T00:13:44.010
> 
> 标签：java

```
public class test {
    public static void main(String[] args) {
        boolean flag=false;
        char[] c=new char[5];
        c[0]='e';
        read(flag, c);

        System.out.println(c[0]);
        System.out.println(flag);
    }

   public static void read(boolean flag, char[] c){
        flag=true;
        c[0]='a';
   }
} 
```

在上面的代码中，我发现了一个有趣的问题：`char[] c`已更改并打印结果正确，但布尔标志没有更改！我不知道这是怎么回事？现在，我也想更改标志，如何做到这一点？感谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T00:15:49.327

`boolean`是按值传递的。如果您在`read`方法中更改它，那么只会更改本地副本，而不是外部值。

但是，对的*引用*是按`c`值传递的，有效地使引用的数组`c`通过引用传递。因此，更改`c`此处的元素确实会影响外部数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:20:52.530

不同之处在于 Java 处理数组和原语的方式。

# 数组

Java 将数组（以及其他对象）作为引用类型来处理。这意味着 Java 并没有为方法提供数组本身。相反，该方法接收一个数字（**引用**），告诉它数组的存储位置。

因此，任何接收数组的方法都不会获取数组的副本；它正在改变原始数组。如果您通过 a) 调用对象上的方法或 b) 下标`[]`数组来修改对象，它将更改原始对象。

# 基元（`boolean`等）

基元的工作方式与数组不同。方法不接收对原语的引用；他们收到原语的副本。这是因为原语比对象更简单，并且与复制对象相关的性能损失不适用于最多约 8 字节的原语。

因此，您将收到传递给该方法的布尔值的副本。因此，更改副本不会影响原件。

希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T00:23:28.127

你对这两个论点做了不同的事情。您只需分配给布尔值，它只会更改您的布尔值副本。

另一方面，您使用数组引用参数的副本来修改它指向的数组。相反，如果你做了一个简单的赋值：`c = null;`或者`c = new char[30];`你会改变你的参数副本，但不会影响调用者的副本，就像布尔值一样。

当然，与布尔表达式相比，您可以使用引用表达式做更多的事情。

# jquery - jQuery：显示和隐藏菜单

> ID：15422569
> 
> 赞同：1
> 
> 时间：2013-03-15T00:14:45.610
> 
> 标签：jquery, menu, toggle, show, preventdefault

我有这个代码：

```
$('.skaftetopmenu-li > a').click(function(e) {
   e.preventDefault();
   var subid = $(this.parentNode).attr('id');
   if (subid !="forsidemenu"){
      var str = $('#submenu-content-'+subid).html();
      if ($.trim(str) == ""){
         $('.submenu-content', this.parentNode).load('http://' + skafte.base_url + '/inc/top-menu-subs/'+subid+'_submenu.html');
      }

   }
}); 
```

这将禁用顶部链接。并在按下时加载子元素。但是，我只能让子元素显示，但当我再次按下顶部链接或按下另一个链接时，我无法让它们消失。

* * *

编辑：

这是顶部菜单的 HTML 片段：

```
<div id="header-menu">
   <ul id="mainmenu" style="overflow: hidden;">
      <li class="skaftetopmenu-li" id="forsidemenu" >
         <a href="http://<?php echo DOMAIN?>/">Forside</a>
      </li>
      <li class="skaftetopmenu-li" id="priser">
         <a href="http://<?php echo DOMAIN?>/priser.php">Priser &amp; Sortiment</a>
         <div class="submenu-content" id="submenu-content-priser"></div>
      </li>
  <li class="skaftetopmenu-li" id="onlinebestilling">
     <a href="http://<?php echo DOMAIN?>/bestil.php">Onlinebestilling</a>
         <div class="submenu-content" id="submenu-content-onlinebestilling"></div>
  </li>
  <li class="skaftetopmenu-li" id="levering-top">
     <a href="http://<?php echo DOMAIN?>/levering-fadoel.php">Fad&oslash;l til Fest</a>
     <div class="submenu-content" id="submenu-content-levering"></div>
  </li>
   </ul>
</div> 
```

上面的 div (submenu-content-priser) 加载文件 /inc/top-menu-subs/priser_submenu.html，看起来像这样：

```
<ul class="submenu-item-ul">
   <li class="li-content">
      <div class="menucontent">
         <div>
            <b>Priser på Sodavand & Vand mm.</b>
            <ul>
               <li><a href="http://skafte.dk/priser.php?moms=1">Kassevarer med moms</a></li>
               <li><a href="http://skafte.dk/priser.php?moms=0">Kassevarer uden moms</a></li>
            </ul>
         </div>
         <div class="last">
            <b>Priser på Fadøl</b>
            <ul>
               <li><a href="http://skafte.dk/priser-fadoel.php">Fad&oslash;l, leje & udstyr til fest</a></li>
            </ul>
         </div>
      </div>
   </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:04:32.383

我认为您应该在document.ready中预先加载子菜单内容，然后在您编写的点击事件中显示然后将它们隐藏在下面的事件中。

你可以试试这个：

```
$('body').click(function(evt){
   if(evt.target.id == "menu_content")
      return;

   $('#menu_content').hide();
}); 
```

您必须使用子菜单 div 的 ID 更改“menu_content”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T08:41:41.573

显示或隐藏匹配的元素。

**切换**

```
$('.target').toggle(); 
```

[http://api.jquery.com/toggle/](http://api.jquery.com/toggle/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T01:12:37.187

我认为您需要将菜单的所有子元素设置为隐藏，然后显示被选中的元素。

例如，在 click 函数中添加如下内容：

```
$('.submenu-content').hide();
$(this).find('.submenu-content').show() 
```

（如果没有一些 HTML 就很难说。）

# java - java JFrame没有出现

> ID：15422570
> 
> 赞同：-2
> 
> 时间：2013-03-15T00:14:49.100
> 
> 标签：java, swing, jframe

我正在尝试制作国际象棋游戏，但没有任何显示。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T00:18:23.497

您在 ChessSquare JPanel 的什么位置添加任何内容？换句话说，您在 ChessSquare 课程中看到`this.add(...)`或只是在哪里看到？`add(...)`

答案：没有——你没有向它添加*任何东西*，所以什么也没有出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:43:45.103

除了@ Hovercraft Full Of Eels 已经说过的内容之外，由于这个`for`循环，什么都没有出现：

```
for (d = 0; d < 7; b++) { 
```

你永远不会增加，所以你*永远*`d`停留在这个循环中，所以你永远不会显示. 你可能想要*`JFrame`*

 *```
for (d = 0; d < 7; d++) { 
```

除此之外，还有很多案例`ArrayIndexOutOfBoundsException`，最明显的是这个：

```
for (int x = 0; x < 9; x++) {
   for (int y = 0; y < 9; y++) {
      panel.add(pad[x][y]);
   }
} 
```

当您只有 7 x 7 时，如何迭代 9 x 9 按钮？*

# button - 未登录时点赞按钮不起作用

> ID：15422571
> 
> 赞同：0
> 
> 时间：2013-03-15T00:14:58.870
> 
> 标签：button, facebook-like, invisible

我正在尝试在网页上放置一个赞按钮。点赞按钮是指 Facebook 页面。脸书页面是：

[http://www.facebook.com/pages/Passie4Flora-uw-tuin-onze-passie/122272884516200](http://www.facebook.com/pages/Passie4Flora-uw-tuin-onze-passie/122272884516200)

当我在开发人员页面上创建赞按钮并且我没有登录到 Facebook 时，我看不到该按钮。当我登录时，我可以看到按钮。我尝试了其他几个似乎工作正常的网址，但我想使用上面的链接。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T09:02:46.540

这通常发生在您的网页以任何方式受到限制*（按年龄、位置、酒精相关内容限制）时。（凯尔在他的评论中说他无法查看该页面[我也没有]，似乎支持这种情况。）

由于未登录 Facebook 的用户无法知道他们是否符合这些限制 - 在这种情况下不会显示“赞”按钮。

# javascript - 您可以将变量作为 JSON 链的一部分传递吗

> ID：15422581
> 
> 赞同：0
> 
> 时间：2013-03-15T00:16:24.767
> 
> 标签：javascript, jquery, json

我一直在寻找 Stack Overflow 和 Google 并没有找到答案。我有一个 JSON 文件，其中总统是一级键（对不起，如果这是错误的术语，我主要使用 Python）。每个总统都有一堆与之相关的数据。但是，我只想返回用户输入的总统的信息。我曾尝试执行以下操作，但无济于事：

```
var foo = json.presidents[pres]foo 
```

和

```
var foo = json.presidents. + pres + .foo 
```

其中“pres”是我存储用户输入的总统姓名的变量。我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T00:18:44.853

您的第一种方法是缺少点。

```
var foo = json.presidents[pres].foo; 
```

那应该行得通。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:18:14.857

使用这种方式：

```
var foo = json.presidents[pres].foo; 
```

顺便说一句，它不是 json 文件，实际上它甚至不是 json，它只是一个 javascript 对象。

# r - 在 RStudio 中构建二进制文件后将二进制文件移动到本地存储库

> ID：15422583
> 
> 赞同：0
> 
> 时间：2013-03-15T00:16:57.650
> 
> 标签：r, rstudio

我正在为我的同事使用 RStudio 构建一个 R 包，并在网络驱动器上为该包创建了一个存储库。因此，当我`build binary`在 RStudio 中时，二进制文件会进入我的工作目录。

我怎样才能自动化以下...

1.  将我的二进制文件移动到 repo 文件夹中
2.  `tools::write_PACKAGES`在 repo 文件夹中运行

最好的方法是编写一个脚本来完成所有这些并由 RStudio 在`Build Binary Package - R CMD INSTALL additional options`?

如果没有，我应该怎么做才能简化它？

![工作室](../Images/9debae0354d60206b5e2b7ef17e10e55.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:09:27.743

[编写 R 扩展](http://cran.r-project.org/doc/manuals/r-release/R-exts.html#Building-binary-packages)手册中的相关部分指出

> 为了防止更改当前的工作安装或提供具有写访问权限的安装位置，请创建一个具有写访问权限的适当位置的目录，并使用 -l 选项在所选位置构建包。那么用法就是
> 
> ```
> R CMD INSTALL -l location --build pkg 
> ```

# c# - 为对象数组中的对象赋值时出现空引用异常

> ID：15422588
> 
> 赞同：0
> 
> 时间：2013-03-15T00:17:30.340
> 
> 标签：c#, null, nullreferenceexception

我得到了一个`null reference exception`，我不知道如何解决它或者它为什么会发生。

```
private void editThisToolStripMenuItem_Click(object sender, EventArgs e)
{
    if (dataGridView1.SelectedRows.Count <= 1)
    {
        Form2 f2 = new Form2(dataGridView1.SelectedRows[0].Cells[1].Value.ToString(), Convert.ToInt32(dataGridView1.SelectedRows[0].Cells[2].Value));
        f2.ShowDialog();
        textBox2.Text = textBox1.Text.Replace(f2.oldtext, f2.newtext);
        this.dataGridView1.SelectedRows[0].Cells[3].Value = f2.newtext;
        this.dataGridView1.SelectedRows[0].Cells[3].Style.BackColor = Color.IndianRed;
    }
    else
    {
        ONOType[] ono = new ONOType[this.dataGridView1.SelectedRows.Count];
        int indexerr = 0;
        foreach (DataGridViewRow r in dataGridView1.SelectedRows)
        {
            ono[indexerr].newtext = this.dataGridView1.SelectedRows[indexerr].Cells[3].Value.ToString(); //null expection at ono[indexerr].newtext
            ono[indexerr].oldtext = this.dataGridView1.SelectedRows[indexerr].Cells[1].Value.ToString();
            ono[indexerr].offset = Convert.ToInt32(dataGridView1.SelectedRows[indexerr].Cells[0].Value);
            indexerr++;
        }
        Form3 f3 = new Form3(ono);
        f3.ShowDialog();
        indexerr = 0;
        for (int i = 0; i < dataGridView1.SelectedRows.Count; i++)
        {
            textBox2.Text = textBox1.Text.Replace(f3.nt[i].oldtext, f3.nt[i].newtext);
            this.dataGridView1.SelectedRows[i].Cells[3].Value = f3.nt[i].newtext;
            this.dataGridView1.SelectedRows[i].Cells[3].Style.BackColor = Color.IndianRed;
        }
    }
} 
```

这是小野课

```
namespace IEditor
{
    public class ONOType
    {
        public string oldtext { get; set; }
        public string newtext { get; set; }
        public int offset { get; set; }
    }
} 
```

问题开始于：

```
ONOType[] ono = new ONOType[this.dataGridView1.SelectedRows.Count]; 
```

它将此类类型的新数组全部定义为 null，这是我不想要的，可能是由关键字“new”引起的，没有“new”关键字，我得到了 comp。为该数组中的对象分配值时出错。

我所做的尝试是在这个类中添加一个 ctor，以便在减速时为每个成员的数组成员分配默认值（也就是为 oldtext/newtext/offset 分配值），但是这个对象数组中的对象仍然是空的，我确实尝试过在获取/设置属性上做同样的事情，但我仍然失败了。

请在解决方案中添加说明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T02:03:17.817

您正在创建一个新的`ONOType`引用数组：

```
 ONOType[] ono = new ONOType[this.dataGridView1.SelectedRows.Count]; 
```

但是没有创建任何实际`ONOType`对象。它只是一个尚未引用任何内容的变量数组。

当您尝试将`ono[indexerr].newtext`元素分配`ono[indexerr]`为空引用时。

如果你这样做了：

```
 ono[indexerr] = new ONOType();
    ono[indexerr].newtext = this.dataGridView1.SelectedRows[indexerr].Cells[3].Value.ToString(); 
```

我认为它会起作用。

# jquery - HTML5 音频重新加载文件

> ID：15422592
> 
> 赞同：2
> 
> 时间：2013-03-15T00:17:39.223
> 
> 标签：jquery, html5-audio

我正在使用 AJAX 从我的数据库中加载一些行，在所有数据中，最重要的是音频文件的路径，例如`uploads/song.mp3`.

我通过数据清除内容 div，`$('#content').html('');`然后循环（使用 jQuery.each） - 创建带有文本和`<audio>`元素的容器，这些容器将歌曲路径加载到`src`属性中。

问题是并不是所有的歌曲都能播放——在第一次加载时，有些会播放，有些不会；然后在下一个 AJAX 请求中，当我获取新数据并从中删除所有内容时`#content`- 没有一个`<audio>`元素播放歌曲。

这是一些代码：

```
$.ajax({
                type: 'POST',
                url: 'xxx.php',
                data: {fr : fraza, ajax : true},
                dataType: 'json'
           }).success(function(retData) {
                //console.log(retData);
                $('#container').html('');
                $.each(retData, function(index, value) {
                    var unos = value;
                    $('#glavni').append('<div class="pesma-item" id="pesma-id-'+ unos.id +'"><h2>' + unos.naziv + '</h2><img src="' + unos.note + '" alt="" /><div><p><pre>' + unos.temp + '</pre></p><br style="clear: both" /><audio controls preload="auto"><source src="' + unos.audio + '" type="audio/mpeg"></audio></div><br style="clear:both" /></div>');
                    $('#pesma-id-' + unos.id + ' audio')[0].load();
                });

           }); 
```

如何强制每个`audio`元素重新加载文件，以便可以播放？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-18T18:28:36.087

我相信有几个问题是可以解决的。对于初学者，我相信至少您的一些问题与垃圾收集有关。[Mozilla Docs](https://developer.mozilla.org/en-US/docs/HTML/Using_HTML5_audio_and_video)建议了一种方法，该方法首先调用相关元素的`pause()`方法，*然后*将 设置为空字符串。我认为正在发生的事情是因为被设置——它指示（阅读：建议）浏览器在页面加载时加载整个流——这个过程继续进行，即使你已经通过清空容器来清除元素`<audio>`*`src``preload="auto"``<audio>``$('#container').html('')`*

 *我已经修改了你的一些代码来做一些事情。第一个是首先循环`pause()`所有`<audio>`元素，然后将它们设置`src`为空字符串：

```
...
$('audio').each(function(){
    $(this).pause().attr('src', '');
});
$('#container').empty();
... 
```

我做的下一件事是重新格式化你附加到`$("#glavni")`（main）的标记，主要是为了我自己的理智，但更重要的是我从你的元素中删除了`<source>`标签。`<audio>`使用元素`src`上的属性`<audio>`，我们可以确定正在播放*哪个*源，以及知道我们的`pause()`方法是直接在相关元素上调用的。

## JS

```
$.ajax({
    type: 'POST',
    url: 'xxx.php',
    data: {
        fr: fraza,
        ajax: true
    },
    dataType: 'json'
}).success(function (retData) {
    //console.log(retData);
    $('audio').each(function(){
        $(this).pause().attr('src', '');
    });
    $('#container').html('');
    $.each(retData, function (index, value) {
        var unos = value, markup;   
        markup += '<div class="pesma-item" id="pesma-id-' + unos.id + '">';
        markup +=     '<h2>' + unos.naziv + '</h2>';
        markup +=     '<img src="' + unos.note + '" alt="" />';
        markup +=     '<div>';
        markup +=         '<p>';
        markup +=             '<pre>' + unos.temp + '</pre>';
        markup +=         '</p>';
        markup +=         '<br style="clear: both" />';
        markup +=         '<audio controls preload="auto" src="' + unos.audio + '">';
        markup +=         '</audio>';
        markup +=     '</div>';
        markup +=     '<br style="clear:both" />';
        markup += '</div>';
        $('#glavni').append(markup);
       // $('#pesma-id-' + unos.id + ' audio')[0].load();
    });
}); 
```

另一件事——我注释掉了你的`load()`方法。

> load() 方法用于在更改源或其他设置后更新音频/视频元素 - [Source](http://www.w3schools.com/tags/av_met_load.asp)

这更像是一种预防措施——理论上，它不应该伤害你，但由于所描述的问题与加载/卸载问题有关，我认为最好将其删除。

## 其他选项

在对您的问题的评论中，我提到了使用**一个** `<audio>`基本上是可回收对象的元素的可能性，并在运行中进行了返工。如果你仍然有问题，这种方法可能值得探索，因为它更容易调试一个实例的行为——更不用说它的标记更少，[如果你问我]这几乎总是一件好事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:09:39.757

也许试试这个..

`HTML:`

```
<div id="audio_player_container">

</div> 
```

`JS :`

```
$.ajax({
   type: 'POST',
   url: 'xxx.php',
   data: {fr : fraza, ajax : true},
   dataType: 'json'
}).success(function(retData) {
//$('#container').html('');
// Maybe instead of removing html from #container you should do this
$('#glavni').empty();
$.each(retData, function(index, value) {
    // store audio source in anchor href
    var unos = value, markup;   
    markup += '<div class="pesma-item" id="pesma-id-' + unos.id + '">';
    markup +=     '<h2>' + unos.naziv + '</h2>';
    markup +=     '<img src="' + unos.note + '" alt="" />';
    markup +=     '<div>';
    markup +=         '<p>';
    markup +=             '<pre>' + unos.temp + '</pre>';
    markup +=         '</p>';
    markup +=         '<br style="clear: both" />';
    markup +=         '<a class="trigger" href="' + unos.audio + '">Play This';
    markup +=         '</a>';
    markup +=     '</div>';
    markup +=     '<br style="clear:both" />';
    markup += '</div>';
    $('#glavni').append(markup);
    });
});

$(".trigger").on("click", function(e) {
   e.preventDefault();
   var sourceUrl = $(this).attr("href"), audio_markup;
   audio_markup += '<audio id="audio_player" controls preload="auto">';
   audio_markup += '<source id="audio_src" src="' + sourceUrl + '" type="audio/mpeg">';
   audio_markup += '</audio>';
   $("#audio_player_container").html(audio_markup);
   var player = $("#audio_player"); 
   // maybe then do something
   player[0].load();
   player[0].play();
}); 
```*

# javascript - 单击收音机时如何隐藏li

> ID：15422605
> 
> 赞同：0
> 
> 时间：2013-03-15T00:19:46.470
> 
> 标签：javascript, jquery, radio-button, radiobuttonlist

一旦单击该对象并显示包含带有单选按钮的 div 的 li，它不会隐藏，单击时的收音机也不会关闭 li。

请参阅下面的代码示例。认为我没有针对正确的对象/类来做我想做的事。我应该使用id而不是css类名吗？

```
//click to show li (in css i have put display to none)
        $('div.ribbonBoxarrow').click(function() {
        $('.ribbonBoxarrow li').show('medium');
        return false;
      });
// once you leave the div (works thanks kevin. selctor missing
        $('.ribbonBoxtab').mouseleave(function() {
        $('ribbonBoxarrow li').hide('slow');
        return false;
      });
//if a radio buttn is clicked the hide li still not working
        $("input[name='domain_ext']").each(function() {
        $('.ribbonBoxarrow li').hide('slow');
        return false;
      }); 
```

css-----

```
/* Ribbon radio drop box */
.ribbontableBox {
    width: 62px;
    height: 50px;
    float: left;
    margin-left: 7px;
    margin-top: 7px;
    border: 1px solid #f1f1f1;
    border-radius: 2px;
}
.ribbontableBox:hover {
    width: 62px;
    height: 50px;
    float: left;
    margin-left: 7px;
    margin-top: 7px;
    border: 1px solid #72B8E2;
    background: #AED5F4;
}

.ribbonBoxtext {
    width:52px;
    height:50px;
    float: left;
}

.ribbonBoxtext ul {
    display: block;
    list-style: none;
}

.ribbonBoxarrow {
    width: 10px;
    height: 50px;
    float: left;
 }
.ribbonBoxarrow ul {
    width: 10px;
    display: block;
    height: 50px;
    background: #ffffff;
}
.ribbonBoxarrow ul:hover {
    background: #AED5F4;
}

.ribbonBoxarrow li  {
    background: #ffffff;
    height: 110px;
    width: 120px;
    display: none;
    position: relative;
    top:45px;
    left: -57px;
    border: 1px solid #72B8E2;
}
/*.ribbonBoxarrow ul:hover > li {
    background: #ffffff;
    height: 110px;
    width: 120px;
    display: block;
    position: relative;
    top:45px;
    left: -57px;
    border: 1px solid #72B8E2;
}*/

.ribbonBoxtab {
    background: #555555;
    border: 1px solid #eeeeee;
    height: 0px;
    width: 180px;
    position: relative;
    display:inherit;
}

</style> 
```

html-----------------

```
<div class="ribbonBoxarrow">
  <ul class="ribbonBoxarrow">
        <li> 

        <div class="ribbonBoxtab">
          <table class="domain_ext_table">
            <tr>
              <td><label>
                <input type="radio" name="domain_ext" value="all"/>
                <span>All</span></label></td>
              <td><label>
                <input type="radio" name="domain_ext" value=".co.uk"/>
                <span>.co.uk</span></label></td>
              </tr>
             <tr>
             <td><label>
                <input type="radio" name="domain_ext" value=".com"/>
               <span>.com</span></label></td>
              <td><label>
                <input type="radio" name="domain_ext" value=".rnet"/>
                <span>.net</span></label></td> 
              </tr>
              <tr>
              <td><label>
                <input type="radio" name="domain_ext" value=".briz"/>
                <span>.biz</span></label></td>
              <td><label>
                <input type="radio" name="domain_ext" value=".orrg"/>
               <span>.rorg</span></label></td>
              </tr>
              <tr>
              <td><label>
                <input type="radio" name="domain_ext" value=".trr"/>
                <span>.org.ruk</span></label></td> 
               <td><label>
                <input type="radio" name="domain_ext" value=".rrrt"/>
                <span>.thh</span></label></td>
            </tr>
          </table>
        </div>
  </li>
  </ul>        
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:21:19.967

`.`代码在类选择器中丢失。我也更改`.each`为`.click`无线电事件处理程序。如果您在页面加载时加载此代码，则应将其包装为`document.ready`

```
$(document).ready(function(){
    //click to show li (in css i have put display to none)
            $('div.ribbonBoxarrow').click(function() {
                $('.ribbonBoxarrow li').show('medium');
                return false;
            });
    // once you leave the div (which is contained in the above li hide.
            $('.ribbonBoxtab').mouseleave(function() {
                $('.ribbonBoxarrow li').hide('slow'); //missing .
                return false;
            });
    //if a radio buttn is clicked the hide li
            $("input[name='domain_ext']").click(function() { //changed .each to .click
                $('.ribbonBoxarrow li').hide('slow'); //missing .
                return false;
            });
}); 
```

**工作示例：http:** [//jsfiddle.net/3wkpZ/](http://jsfiddle.net/3wkpZ/)

# python - Django模型：如果不是空/空白，则电子邮件字段是唯一的

> ID：15422606
> 
> 赞同：17
> 
> 时间：2013-03-15T00:19:50.530
> 
> 标签：python, django

假设您有一个简单的模型：

```
Class Contact(models.Model):
    email = models.EmailField(max_length=70,blank=True)
    first = models.CharField(max_length=25,blank=True)
    last = models.CharField(max_length=25,blank=True) 
```

我想做的是将电子邮件设置为唯一的，但是，这样做我必须排除空白电子邮件地址 - 我不希望这样。

我正在考虑这样的事情，但我想知道是否有更好的方法来处理它。

```
from django.core.validators import email_re
from django.core.exceptions import ValidationError

def save(self, *args, **kwargs):
    # ... other things not important here
    self.email = self.email.lower().strip() # Hopefully reduces junk to ""
    if self.email != "": # If it's not blank
        if not email_re.match(self.email) # If it's not an email address
            raise ValidationError(u'%s is not an email address, dummy!' % self.email)
        if Contact.objects.filter(email = self.email) # If it already exists
            raise ValidationError(u'%s already exists in database, jerk' % self.email) 
    super(Contact, self).save(*args, **kwargs) 
```

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-20T20:54:46.037

不幸的是，它并不像设置 null=True、unique=True、blank=True 那样简单。每当您尝试使用 csv 或其他基于文本的源进行导入时，Django 的某些部分出于唯一性的目的将“”视为不应重复的内容。

解决方法是覆盖保存方法，如下所示：

```
def save(self, *args, **kwargs):
    # ... other things not important here
    self.email = self.email.lower().strip() # Hopefully reduces junk to ""
    if self.email != "": # If it's not blank
        if not email_re.match(self.email) # If it's not an email address
            raise ValidationError(u'%s is not an email address, dummy!' % self.email)
    if self.email == "":
        self.email = None
    super(Contact, self).save(*args, **kwargs) 
```

然后，使用 unique、null 和 blank 将按预期工作。

```
Class Contact(models.Model):
    email = models.EmailField(max_length=70,blank=True, null= True, unique= True) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-15T00:38:26.623

只需这样做：

```
class Contact(models.Model):
    email = models.EmailField(max_length=70, null=True, blank=True, unique=True) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-11-19T16:25:42.933

我尝试使用 save ，但仍然没有用，因为在 clean 方法中已经引发了错误，所以我改写了它，而不是为我的模型，它看起来像这样：

```
Class MyModel(models.Model):
    email = models.EmailField(max_length=70,blank=True)
    first = models.CharField(max_length=25,blank=True)
    last = models.CharField(max_length=25,blank=True)
    phase_id = models.CharField('The Phase', max_length=255, null=True, blank=True, unique=True)

    ...

    def clean(self):
        """
        Clean up blank fields to null
        """
        if self.phase_id == "":
            self.phase_id = None 
```

这对我很有用，并且使用保存的答案可能适用于某些情况，这里应该通过将“”重置为 None 来工作，然后在基类 clean 中进行其余的验证。干杯:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-18T16:14:59.850

允许 CharField 为空并将其默认为无。只要您没有多个空白字段（“”），就不会引发完整性错误。

```
#models.py
Class Contact(models.Model):
    email = models.EmailField(max_length=70, blank=True, null=True, unique=True, default=None)
# protect the db from saving any blank fields (from admin or your app form)
def save(self, *args, **kwargs):
    if self.email is not None and self.email.strip() == "":
        self.email = None
    models.Model.save(self, *args, **kwargs) 
```

# mysql - MySql - 创建视图时遇到问题

> ID：15422608
> 
> 赞同：1
> 
> 时间：2013-03-15T00:20:08.527
> 
> 标签：mysql, views

尝试在 MySql 中创建视图时收到此消息。我也尝试为每一列赋予别名，但仍然收到错误消息。怎么回事！？提前致谢。

**错误信息**

> 错误 1060：重复的列名“ID”

**代码**

```
CREATE VIEW contactnotes AS
SELECT contact.ID, log.ID, contact.Name, log.notes
FROM log 
JOIN contact 
ON log.ID = contact.ID 
```

**别名尝试**

```
CREATE VIEW contactnotes AS
SELECT contact.ID as id1, log.ID as id2, contact.Name, log.notes
FROM log 
JOIN contact 
ON id1 = id2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:23:28.183

```
CREATE VIEW contactnotes AS
SELECT contact.ID as id1, log.ID as id2, contact.Name, log.notes
FROM log 
JOIN contact 
ON log.ID = contact.ID 
```

或者

```
CREATE VIEW contactnotes AS
SELECT contact.ID as id1, log.ID as id2, contact.Name, log.notes
FROM log 
INNER JOIN contact USING (ID) 
```

# html - Internet Explorer 的 HTML 解析器会添加非结束标记吗？

> ID：15422611
> 
> 赞同：0
> 
> 时间：2013-03-15T00:20:24.813
> 
> 标签：html, internet-explorer, internet-explorer-8, internet-explorer-9

当我遇到一个奇怪的错误时，我正在修复 IE8 和 IE9 中的错误。HTML 中有一个`<section class="create">`标签，但在页面加载后，在页面下方稍远处有完全相同的标签。起初，我认为有一些糟糕的 javascript 克隆了`section`某种方式，但我禁用了 javascript，并且在页面加载后它仍然存在。这必须是创建此标签的 HTML 解析器，对吧？呈现的 HTML 与 HTML 文件完全不匹配。

**我知道 HTML 解析器会添加`</div>`标签或`</html>`标签等，当它们丢失时，但是 IE 会因为某种原因*重新打开*或*添加标签吗？*如果是这样，是什么原因造成的？如果不是这种情况，当禁用 javascript 时，什么可能导致 HTML 中不存在的标签被添加到 DOM 中？**

~~我正在处理的 HTML 页面超过 20,000 行，而且肯定到处都是格式错误的 HTML，其中任何一个都可能导致 DOM 渲染不正确。如果有一个片段我可以添加到这个问题中会有所帮助，请在评论中告诉我。~~

这是复制此问题的最小 HTML。请注意，它只发生在`form`标签内，而不是`div`标签内。`section`表单元素关闭后，标签在 IE8 和 IE9 中重新打开，因此创建了 2 个元素`section`。

```
<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <form>
            <section class="create">
                CREATE SECTION
        </form>
    </body>
</html> 
```

这是一个小提琴：http: [//jsfiddle.net/VurE6/](http://jsfiddle.net/VurE6/)

作为记录，IE10、Chrome、Firefox 和 Safari 没有显示这种行为（据我所知）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:58:21.113

在某种程度上，所有的浏览器都会做这种事情。例如，试试这个

```
<b>1<i class="create">2</b>3</i> 
```

在任何浏览器中，您都应该看到两个 i 元素都使用“create”类创建。

关于何时发生这种情况的规则非常复杂，但是当关闭标签没有结束其元素后代的影响时，就会发生这种情况。在 IE9 中，表单结束标记不会关闭该部分，因此要保持该部分继续运行，浏览器必须创建第二个部分元素。

虽然这在 b 和 i 元素的情况下有一定的意义，但对于 section 没有意义，因此在任何实现 HTML5 解析算法的浏览器（如 IE10 和现代 Firefox 和 Chrome）中都不会发生这种情况，但确实如此，显然，在 IE9 中。

请参阅[http://www.w3.org/html/wg/drafts/html/master/syntax.html#misnested-tags:-bi-/b-/i](http://www.w3.org/html/wg/drafts/html/master/syntax.html#misnested-tags:-b-i-/b-/i)了解 HTML5 如何处理错误嵌套的 b 和 i 标签问题。

# jquery - Rails 表单提交处理程序未执行

> ID：15422618
> 
> 赞同：0
> 
> 时间：2013-03-15T00:20:57.503
> 
> 标签：jquery, ruby-on-rails, balanced-payments

我正在尝试集成 Balanced Payments 以允许用户保存他们的信用卡信息以供以后使用。相关的视图代码和 javascript 文件如下，但是我在使用 javascript 文件中定义的提交处理程序时遇到了问题。

**平衡卡.js**

```
var marketplaceUri = '{MY MARKETPLACE URI}';
var requestBinUrl = '{FORM SUBMISSION PATH}'

var debug = function(tag, content) {
    $('<' + tag + '>' + content + '</' + tag + '>').appendTo('#result');
};

try {
    balanced.init(marketplaceUri);
} catch (e) {
    debug('code', 'balanced.init error!');
}

function balancedCallback(response) {
    var tag = (response.status < 300) ? 'pre' : 'code';
    debug(tag, JSON.stringify(response));
    switch(response.status) {
        case 201:
            console.log(response.data);
            var $form = $("#credit-card-form");
            var card_token_uri = response.data['uri'];
            $('<input>').attr({
                type: 'hidden',
                value: card_token_uri,
                name: 'balancedCreditCardURI'
            }).appendTo($form);
            $form.attr({action: requestBinUrl});
            $form.get(0).submit();
        case 400:
            console.log(response.error);
        case 404:
            console.log(response.error);
            break;
    }
}

var tokenizeCreditCard = function(e) {
    e.preventDefault();

    var $form = $('#credit-card-form');
    var creditCardData = {
        card_number: $form.find('.cc-number').val(),
        expiration_month: $form.find('.cc-em').val(),
        expiration_year: $form.find('.cc-ey').val(),
        security_code: $form.find('.cc-csc').val()
    }

    balanced.card.create(creditCardData, balancedCallback);
};

$('#credit-card-form').submit(tokenizeCreditCard); 
```

**credit_card.html.haml**

```
= javascript_include_tag 'https://js.balancedpayments.com/v1/balanced.js'

= javascript_include_tag 'balanced_card'

= render :partial => 'crdtcard' 
```

**_crdtcard.html.haml**

```
%h3 Credit Card
= form_tag '#', :method => :post, :id => "credit-card-form" do
  = label_tag "Card Number"
  = text_field_tag "cc-number", nil, :placeholder => "Enter Credit Card Number", :class => "cc-number", :autocomplete => "off"
  = label_tag "Expiration"
  = text_field_tag "cc-em", nil, :placeholder => "Expiration Month", :class => "cc-em", :autocomplete => "off"
  = text_field_tag "cc-em", nil, :placeholder => "Expiration Year", :class => "cc-ey", :autocomplete => "off"
  = label_tag "Security Code"
  = text_field_tag "cc-csc", nil, :placeholder => "Security Code", :class => "cc-csc", :autocomplete => "off"
  = submit_tag "Submit", :name => "submit" 
```

当我使用 Firebug 进行调试时，tokenizeCreditCard 似乎从未被调用过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:25:04.203

您错过了将绑定包装在`onDomready`事件中：

```
$(function(){
  $('#credit-card-form').submit(tokenizeCreditCard);
}) 
```

# google-app-engine - Google App Engine 频道状态处理程序抛出异常

> ID：15422619
> 
> 赞同：0
> 
> 时间：2013-03-15T00:21:00.267
> 
> 标签：google-app-engine, channel-api

我在 Mac 上本地运行 SDK 时遇到了这种情况。我正在尝试建立存在处理。我创建了一个简单的 servlet，它只做日志记录。但是，我在任何连接和断开连接事件上都会遇到以下异常（尽管 Channels 似乎工作正常）...

```
Mar 14, 2013 8:04:25 PM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: /_ah/channel/disconnected/: javax.servlet.UnavailableException: java.lang.InstantiationException
Mar 14, 2013 8:04:38 PM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: /_ah/channel/connected/: javax.servlet.UnavailableException: java.lang.InstantiationException 
```

我已经在我的 web.xml 中注册了用于连接和断开通道的 servlet ...

```
 <servlet>
    <servlet-name>ChannelPresence</servlet-name>
    <servlet-class>com.readyposition.gaetestbed.ChannelPresenceServlet          
    </servlet-class>
  </servlet>

  <servlet-mapping>
    <servlet-name>ChannelPresence</servlet-name>
    <url-pattern>/_ah/channel/connected/</url-pattern>
  </servlet-mapping>

  <servlet-mapping>
    <servlet-name>ChannelPresence</servlet-name>
    <url-pattern>/_ah/channel/disconnected/</url-pattern>
  </servlet-mapping> 
```

处理程序（servlet）本身非常基本......

```
package com.readyposition.gaetestbed;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.google.appengine.api.channel.ChannelPresence;
import com.google.appengine.api.channel.ChannelService;
import com.google.appengine.api.channel.ChannelServiceFactory;

@SuppressWarnings("serial")
public abstract class ChannelPresenceServlet extends HttpServlet {
    final static Logger logger =
            LoggerFactory.getLogger(ChannelPresenceServlet.class);

    @Override
    public void doGet(final HttpServletRequest req,
            final HttpServletResponse resp)
                    throws IOException, ServletException
    {
        processCommand(req, resp);
    }

    @Override
    public void doPost(final HttpServletRequest req,
            final HttpServletResponse resp)
                    throws IOException, ServletException
    {
        processCommand(req, resp);
    }

    public void processCommand(final HttpServletRequest req,
            final HttpServletResponse resp)
                    throws IOException, ServletException
    {
        final ChannelService channelService =
                ChannelServiceFactory.getChannelService();
        final ChannelPresence presence = channelService.parsePresence(req);

        logger.info("Channel Presence - clientId={}, isConnected={}",
                presence.clientId(), presence.isConnected());
    }
} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:34:57.540

多么尴尬。剪切和粘贴错误。我的 servlet 类错误地抽象了。叹。固定的。

我看到其他几个人在不同情况下抱怨相同的异常，并且至少有一个与 Channel 存在有关。如果另一个人意识到他们错误地将 servlet 类保留为抽象类，那么我认为这将是有益的。

感谢任何试图跟随我进入老鼠洞的人。

# android - 点击按钮的声音

> ID：15422621
> 
> 赞同：0
> 
> 时间：2013-03-15T00:21:10.563
> 
> 标签：android, button, click, effects, audio

我已经查看了所有可见的线程，我试图让它工作，但它只是没有。

我见过的所有线程都涉及某种我以前从未见过的 .raw 文件......有一个线程很有意义，但是当我按照他们所做的（即复制+粘贴）时，它仍然没有工作。

你能看看我的代码并告诉我问题是什么吗？我敢肯定这是很多人的常见问题：只需添加简单的点击按钮声音（如内置的 java 声音）。当我加载我的模拟器时，onClick 没有声音播放。

```
package com.example.attempt;

import android.app.Activity;
import android.os.Bundle;
import android.view.SoundEffectConstants;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class MainActivity extends Activity implements OnClickListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button=(Button) findViewById(R.id.muteButton);
        button.setOnClickListener(this);

    }

    public void onClick(View v) {
     v.playSoundEffect(SoundEffectConstants.CLICK);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:55:11.660

确保启用有声选择：

```
Settings -> Sounds & display -> Audible Selection 
```

顺便说一句，`raw`您在其他线程中看到的不是文件。这是一个特殊的文件夹。如果您`res\raw`在项目根目录下创建文件夹，则可以使用`R.res.raw`

# django - Django 电子邮件客户端

> ID：15422627
> 
> 赞同：3
> 
> 时间：2013-03-15T00:21:38.863
> 
> 标签：django, email

我一直觉得 Django 电子邮件的行为就像一个电子邮件客户端，这就是为什么你必须指定一个 EMAIL_HOST、一个 EMAIL_HOST_PASSWORD 和一个 EMAIL_HOST_USER。然后，Django 应用程序的行为就像一个普通的电子邮件客户端，就像 Outlook 或 Apple 邮件一样......

我正在测试一个必须不时发送电子邮件的应用程序。但是当我在我的应用程序中执行这些语句时：

```
subject, from_email, to = 'hello', 'noreply@dummy.com', 'dummy@gmail.com'
text_content = 'This is an important message.'
html_content = '<p>This is an <strong>important</strong> message.</p>'
msg = EmailMultiAlternatives(subject, text_content, from_email, [to])
msg.send() 
```

我正进入（状态...

```
Traceback (most recent call last):
File "<console>", line 1, in <module>
.
.
SMTPRecipientsRefused: {'dummy@gmail.com': (504, '5.5.2 <wmsdesktop>: Helo command rejected: need fully-qualified hostname')} 
```

其中 wmsdesktop 是我的开发系统的名称。从这个错误我得到的印象是 Django 应用程序的行为就像一个 smtp 服务器。

或者我在这里错过了什么。请对此有所了解...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T05:39:35.070

**在你的settings.py**文件中写下这段代码

```
 EMAIL_USE_TLS = True
 EMAIL_HOST = 'smtp.gmail.com'
 EMAIL_PORT = 587
 EMAIL_HOST_USER = 'email@gmail.com'
 EMAIL_HOST_PASSWORD = 'email password' 
```

然后在您的**view.py**文件中使用此代码

```
def sendEmail(request):
    subject, from_email, to = 'Hello', 'noreply@dummy.com', 'dummy@gmail.com'
    text_content = 'Dear Sir,'
    html_content = '<html><body><p>Hello World</p></body></html>'
    msg = EmailMultiAlternatives(subject, text_content, from_email, [to])
    msg.attach_alternative(html_content, "text/html")
    msg.send() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:57:15.483

每个电子邮件“客户端”在发送电子邮件时都使用 SMTP。

SMTP 是发送电子邮件的方式。

所以是的，Django 在发送电子邮件时充当 SMTP 客户端，而不是电子邮件（POP 或 IMAP）客户端。

看起来您正在使用的 STMP 服务器仅限制对具有完全限定域名 (example.com) 的其他 SMTP 服务器的访问，该域名可以通过反向 DNS 查找进行验证。

这是 SMTP 服务器的一种非常常见的做法，因为它有助于消除匿名 SMTP 服务器，这些服务器通常用于发送垃圾邮件。

一般来说，此限制不适用于经过身份验证的用户，尽管这取决于 SMTP 服务器。

# c++ - C ++继承不继承祖父文件

> ID：15422630
> 
> 赞同：3
> 
> 时间：2013-03-15T00:21:46.280
> 
> 标签：c++, inheritance, polymorphism

最近我尝试解决 C++ 继承和多态性，但我遇到了一些对我来说毫无意义的问题。我在单独的文件中有 2 个标头和一个带有实现的 cpp 文件。我的代码的简短摘要如下：

```
#ifndef MANDEL_H_
#define MANDEL_H_

class Mandel{

public:
    virtual void compute("various arguments") = 0;

    //dummy destructor, I must have one or compile is sad and I dunno why
    virtual ~Mandel();
private:
    virtual int compute_point("various arguments") = 0;
};

#endif 
```

这是我的“祖父”标题，名为“Mandel.h”。现在转到“父亲”标题。下一个标题指定了一些特定于 Mandel 的白色和黑色实现的变量，称为“Black_White_Mandel.h”：

```
#ifndef BLACK_WHITE_MANDEL_H_
#define BLACK_WHITE_MANDEL_H_

#include "Mandel.h"

class Black_White_Mandel: public Mandel {

protected:
    int max_iterations; //a specific variable of this Black_White Version
};

#endif 
```

现在遵循 Black_White_Mandel 标头的实现，在一个名为 White_Black_Mandel_Imp1.cpp 的单独文件中：

```
#include <iostream>
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

#include "Mandel.h"
#include "Black_White_Mandel.h"

using namespace std;

//constructor
Black_White_Mandel::Black_White_Mandel(){
    max_iterations = 255;
}

//destructor
Black_White_Mandel::~Black_White_Mandel(){}

int Black_White_Mandel::compute_point("various arguments") {
    //code and stuff
    return 0;
}

void Black_White_Mandel::compute("various arguments") {
     //code and stuff
} 
```

因此，Mandel.h 有两个必须实现的功能，因为它们是虚拟的并且“=0”。在 White_Black_Mandel_Imp1.cpp 中，当我实现编译器发疯的那些函数时。它说函数没有在 White_Black_Mandel.h 中定义，虽然这是真的，但它们是在 Mandel.h 中定义的。因此，通过继承，White_Black_Mandel_Imp1.cpp 应该知道它有义务从 Mandel.h 实现这些功能。

我不明白，我的一个朋友说我的 White_Black_Mandel.h 文件应该是 Mandel.h 的精确副本，但还有一些额外的东西，但这对我来说真的很愚蠢，没有任何意义。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T00:26:10.947

尽管您的祖先类中有 2 个纯虚方法，但这并不意味着它们的原型已准备好在子类中使用。

即使在您的子类中，您也必须声明原型：

```
class Black_White_Mandel: public Mandel {

public:
    virtual void compute("various arguments")

protected:
    int max_iterations; //a specific variable of this Black_White Version

private:
    virtual int compute_point("various arguments");
}; 
```

关键字是可选的`virtual`，但知道该方法确实是虚拟的很有用。你不必在这个特定的子类中实现它们，你可以避免指定任何东西，但你仍然有两个必须实现的纯虚方法，所以你将无法实例化这个子类的任何对象（你将有无论如何都要在层次结构树中实现它们）。

虚拟析构函数是必需的，否则在类似情况下：

```
Base *derived = new Derived();
delete derived; 
```

编译器无法调用正确的析构函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T00:24:21.063

`compute`为和`compute_point`to添加原型`Black_White_Mandel`。

在某些情况下，您从具有纯虚函数的基类继承并且不实现所有这些：您的派生类将保持抽象，并且需要从另一个类继承等，直到实现所有纯虚函数。

例如

```
class A {
    virtual void foo() = 0;
    virtual void bar() = 0;
};

class B : public A {
    virtual void foo() {};
};

class C : public B {
    virtual void bar() {};
};

class D : public A {
    virtual void foo() {};
    virtual void bar() {};
}; 
```

上面唯一可实例化的类是`C`和`D`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-15T00:25:58.763

> White_Black_Mandel_Imp1.cpp 应该知道它有义务

它没有也不应该。它也可以决定成为一个抽象类，在这种情况下，它可以不理会这些功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-15T00:29:28.713

*必须*在实现类中提供声明的原因是派生类使用不同的返回类型覆盖虚函数是合法的，只要新的返回类型与原始返回类型是*协变的。*例如，您的基类可以返回`BaseReturnedObject&`，但您的派生类可以选择返回`DerivedReturnObject&`。如果在派生类中没有声明，编译器不知道方法的返回类型是什么。它不能假设它与基础中的相同，因此编译器需要一个原型。

有关使用协变返回类型覆盖的规则，请参阅[此问题](https://stackoverflow.com/q/4665117/335858)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T14:26:21.493

想象一下，您的“祖父”类中有 4 个方法，它们都是纯虚拟的。现在您打算在“父亲”类中实现两个，在“子”类中实现两个。顺便说一句，这个特定的术语并不理想，但我坚持使用它，因为你是从它开始的。

当您定义类时（在 .h 文件之间`class whatever {`，并`};`告诉编译器您打算覆盖基类（术语中的祖父类）中的哪些函数。您可以将实现放在标题中，或者您可以将它放在 .cpp 文件中。但是您必须指定要覆盖的 4 个函数（如果有）中的哪一个。

如果您没有在类定义中（如您所说的在头文件中）提到特定的继承函数，那么当编译实现（.cpp 文件）时，编译器会说***“什么？你从来没有告诉我你打算覆盖这个功能！”*** 您的回答似乎是***“伙计，它是纯虚拟的，如果我不覆盖它，我就无法实例化对象！”*** 但你知道吗？编译器对此毫不在意。它不知道您是否要创建可实例化的对象，是否打算进一步继承，甚至不知道该函数在基类中是纯虚拟的。它所知道的是，它正在编译一个实现文件，它遇到了一个你没有在类定义中告诉它的函数。

因此，当您编写`class something {`...`};`类定义时，请务必列出您打算为该类实现的所有功能，无论您是否继承了它们。不要列出您继承的未更改且不会实现的函数。如果您继承的是一个接口（所有函数都是纯虚拟的），那么是的，如果您要全部实现它们，则必须在类中列出它们。那是因为语言没有为这种情况留出特殊情况。这根本不等同于“我的头文件必须是祖父类头文件的精确副本”，我认为如果您在祖父类中有更多函数并且没有实现它们，您会更清楚地看到这一点都在孩子班。

# java - 在类之间打印一个布尔值

> ID：15422631
> 
> 赞同：1
> 
> 时间：2013-03-15T00:22:12.200
> 
> 标签：java, class, object, boolean, boolean-operations

我对 Java 比较陌生。我得到了一个任务，我必须输出一个显示其属性的类的对象并打开它。该对象是一个“风扇”，我可以从我创建的 FAB 类中打印它的所有属性，除了打开它。这是我的一些代码

```
public class Fan {
private boolean on = false;

public Fan ( int newSpeed, boolean newOn, double newRadius, String newColor ) {

            setSpeed(newSpeed);    
            setRadius(newRadius);
            setColor(newColor);
            }

            public boolean isOn () { 
            return true;

            }
           public void setOn ( boolean newOn ) {
                    if (on) {
                        on=newOn;

                    } 
                    }
         public String toString ( ) {                
            {
               if (on)
               {
                  return "Fan is Turned on";
               }
               else
               {
                  return "Fan is Turned off";
               }
                  }
                    } 
```

这是我的粉丝课对象

```
public class TestApplication {
public static void main (String[] args) {

    Fan testfan1 = new Fan(5, false, 10, "blue");

    System.out.println(testfan1.getSpeed() + "   " + testfan1.getColor() + " " 
            + testfan1.getRadius() + " " + testfan1.isOn());

 }
} 
```

尝试了很多方法，但我得到输出“真”而不是风扇打开

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T00:25:36.440

我看到的一些错误的地方：

您正在使用`=`运算符在您的`if`语句中进行比较。`=`运算符是 Java 中的赋值运算符。用来`==`比较。

```
if (on == true) 
```

如果您要比较的是布尔值（这里就是这种情况），只需提供布尔值：

```
if (on) 
```

另外，在您的`isOn`方法中，您总是`true`在 return ，我认为您的意思是 return `on`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T00:24:49.973

`if (on = true) {`

我想你的意思是

`if (on == true) {`

这简化为

`if (on) {`

验证码：尽管看起来像 ==，但将 = 用作赋值而不是 := 的语言，并且在 if 正文中使用 = 并不是警告

编辑：另外：

```
 public boolean isOn () { 
        return true;

        } 
```

为什么不`return on`呢？

还：

如果您在设置变量时打印“风扇已打开”“风扇已关闭”等，当您 1）通过 isOn 获取变量 2）连接一个字符串以发送到 println 时，它不会发生。

编辑

```
public string ToString()
{
   if (on)
   {
      return "Fan is Turned on";
   }
   else
   {
      return "Fan is Turned off";
   }
}

System.out.println(testfan1); 
```

# paypal - IPN 模拟器“无法提取响应：找不到 Content-Type”

> ID：15422636
> 
> 赞同：4
> 
> 时间：2013-03-15T00:22:32.427
> 
> 标签：paypal, paypal-ipn, paypal-sandbox

由于 PayPal 在过去几周内对其开发人员 API 进行了一些更改，我注意到开发人员中心的 IPN 模拟器不再像我预期的那样响应测试 IPN。现在，它正在吐出消息：

*“IPN 传递失败：无法提取响应：找不到 Content-Type”*

测试 IPN 本身*似乎*实际上执行得很好——我的 IPN 控制器（在 ASP 中）正在接收 IPN，将其回显，并且 PayPal 正在响应“已验证”，正如我所期望的那样。

这只是一个模拟器前端错误，还是我在这里遗漏了什么？我的代码（据我所知）肯定会发送 ContentType 标头，就像往常一样：

```
req.Method = "POST";
req.ContentType = "application/x-www-form-urlencoded"; <-- ## HEADER IS PRESENT ##
byte[] param = Request.BinaryRead(HttpContext.Request.ContentLength);
string strRequest = Encoding.ASCII.GetString(param);
strRequest += "&cmd=_notify-validate";
req.ContentLength = strRequest.Length; 
```

值得注意的是，我使用 nginx 作为代理将 IPN 请求转发到我的本地开发服务器，因为微软的开发测试服务器（非常愚蠢）只能在本地访问。我不知道这是否会影响结果，但在 PayPal 更改前一周左右，它*确实运行良好。*

提前谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T05:01:59.160

否 - 这看起来您的 IPN 处理程序本身在收到来自 PayPal 的 IPN 消息后没有返回正确的 HTTP 200 响应。这是顺序：

1.  PayPal 发送 IPN 消息
2.  您的 IPN 处理程序接收 IPN 消息并返回 HTTP 200（无响应数据）
3.  您的 IPN 处理程序向 PayPal 发送一条 POST 消息以进行验证。

看起来＃2是失败的地方。我建议检查您的 IPN 脚本，以确保它在收到 IPN 消息后立即返回成功响应（甚至在发送 IPN 进行验证之前）。

# ruby-on-rails - 无法读取未定义的属性“asSorting” - DataTables

> ID：15422638
> 
> 赞同：4
> 
> 时间：2013-03-15T00:22:35.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3, datatables

`for ( j=0, jLen=oColumn.asSorting.length ; j<jLen ; j++ )`在数据表的第 6706 行...

我几乎一字不差地复制了有关该主题的[railscast 。](http://railscasts.com/episodes/340-datatables)所以`oColumn`是未定义的。互联网告诉我，我需要拥有`<thead>`和`<th>`价值观......

看法：

```
<table id="companyBoxList" class="display" data-source="<%= comp_boxes_path(format: "json") %>"
  <thead>
    <tr>
      <th>uid</th>
      <th>length</th>
      <th>width</th>
      <th>height</th>
      <th>weight</th>
      <th>trips</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table> 
```

这是新课程的副本。同样，几乎复制了 railscast

box_database.rb

```
class BoxesDatatable
  delegate :params, :h, :link_to, :number_to_currency, to: :@view

  def initialize(view)
    @view = view
  end

  def as_json(options = {})
    {
      sEcho: params[:sEcho].to_i,
      iTotalRecords: Box.count,
      iTotalDisplayRecords: boxes.count,
      aaData: data
    }
  end

private

  def data
    boxes.map do |box|
      [
        box.uid,
        box.length,
        box.width,
        box.height,
        box.weight,
        box.trips
      ]
    end
  end

  def boxes
    @boxes ||= fetch_boxes
  end

  def fetch_boxes
    boxes = Box.order("#{sort_column} #{sort_direction}")
    boxes = boxes.page(page).per(per_page)
    if params[:sSearch].present?
      boxes = boxes.where("uid like :search or trips like :search", search: "%#{params[:sSearch]}%")
    end
    boxes
  end

  def page
    params[:iDisplayStart].to_i/per_page + 1
  end

  def per_page
    params[:iDisplayLength].to_i > 0 ? params[:iDisplayLength].to_i : 10
  end

  def sort_column
    columns = %w[uid length width height weight trips]
    columns[params[:iSortCol_0].to_i]
  end

  def sort_direction
    params[:sSortDir_0] == "desc" ? "desc" : "asc"
  end
end 
```

javascript（咖啡）：

```
jQuery ->
  $('#companyBoxList').dataTable
    sPaginationType: "full_numbers"
    bJQueryUI: true
    bProcessing: true
    bServerSide: true
    sAjaxSource: $('#companyBoxList').data('source') 
```

通过添加`"aoColumns": [null, null, null, null, null, null]`. 但是，这会使标题无效，这违背了目的。这表明读取的标题存在问题，而不是 json，因为数据返回得很好。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-04T00:14:49.247

语法错误...在我的初始表调用中缺少结束 >。检查我的代码的第一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:04:21.027

如果您想将列数据绑定到 json 没有错，那么您应该将代码更改为：

```
$('#companyBoxList').dataTable
    sPaginationType: "full_numbers",
    bJQueryUI: true,
    bProcessing: true,
    bServerSide: true,
    sAjaxSource: $('#companyBoxList').data('source'),
    aoColumns: [{"mDataProp": "uId"},
                 .....the other data that you want to add such as length and width
               ] 
```

# ruby - Gosu 的 Ruby 人生游戏 - 更新操作不起作用

> ID：15422642
> 
> 赞同：4
> 
> 时间：2013-03-15T00:23:09.307
> 
> 标签：ruby

**我正在使用 Gosu 在 Ruby 中创建生命游戏。**我的代码如下。现在，当我运行“ruby gosu.rb”时，它会打开具有适当尺寸和预填充世界的窗口。

**但是一旦我取消注释'@game.tick！' 在 gosu 文件更新操作中，运行“ruby gosu.rb”后，我得到黑屏，没有预填充的世界，我无法关闭。**为什么会这样以及如何解决这个问题？

[您可以在此处找到包含其余代码的 github 存储库。](https://github.com/ofcan/game-of-life-ruby)任何帮助都很棒。

**这是我的 game_of_life.rb**

```
class Game
  attr_accessor :world

  def initialize(world=World.new, seeds=[])
    @world = world
    seeds.each do |seed|
      world.cell_board[seed[0]][seed[1]].alive = true
    end
  end

  def tick!
    next_round_live_cells = []
    next_round_dead_cells = []

    world.cells.each do |cell|
      # Rule 1: 
      # Any live cell with fewer than two live neighbours dies
      if cell.alive? && world.live_neighbours_around_cell(cell).count < 2
        next_round_dead_cells << cell
      end
      # Rule 2:
      # Any live cell with two or three live neighbours lives on to the next generation
      if cell.alive? && world.live_neighbours_around_cell(cell).count == (2 || 3)
        next_round_live_cells << cell
      end
      # Rule 3:
      # Any live cell with more than three live neighbours dies
      if cell.alive? && world.live_neighbours_around_cell(cell).count > 3
        next_round_dead_cells << cell
      end
      # Rule 4:
      # Any dead cell with exactly three live neighbours becomes a live cell
      if cell.dead? && world.live_neighbours_around_cell(cell).count == 3
        next_round_live_cells << cell
      end
    end

    next_round_live_cells.each do |cell|
      cell.revive!
    end
    next_round_dead_cells.each do |cell|
      cell.die!
    end
  end
end

class World
  attr_accessor :rows, :cols, :cell_board, :cells

  # Scheme of default initialized world matrix
  #------------------------
  #     0     1     2
  # 0 [ dead, dead, dead ]
  # 1 [ dead, alive, dead ]
  # 2 [ dead, dead, dead ]
  #-----------------------

  def initialize(rows=3, cols=3)
    @rows = rows
    @cols = cols
    @cells = []

    @cell_board = Array.new(rows) do |row|
      Array.new(cols) do |col|
        Cell.new(col, row) # note col is 1st, than is row
      end
    end

    cell_board.each do |row|
      row.each do |element|
        if element.is_a?(Cell)
          cells << element
        end
      end
    end
  end

  def live_cells
    cells.select { |cell| cell.alive }
  end

  def dead_cells
    cells.select { |cell| cell.alive == false }
  end

  def live_neighbours_around_cell(cell)
    live_neighbours = []
    live_cells.each do |live_cell|
      # Neighbour to the North
      if live_cell.x == cell.x - 1 && live_cell.y == cell.y
        live_neighbours << live_cell
      end
      # Neighbour to the North-East
      if live_cell.x == cell.x - 1 && live_cell.y == cell.y + 1
        live_neighbours << live_cell
      end
      # Neighbour to the East
      if live_cell.x == cell.x && live_cell.y == cell.y + 1
        live_neighbours << live_cell
      end
      # Neighbour to the South-East
      if live_cell.x == cell.x + 1 && live_cell.y == cell.y + 1
        live_neighbours << live_cell
      end
      # Neighbour to the South
      if live_cell.x == cell.x + 1 && live_cell.y == cell.y
        live_neighbours << live_cell
      end
      # Neighbour to the South-West
      if live_cell.x == cell.x + 1 && live_cell.y == cell.y - 1
        live_neighbours << live_cell
      end
      # Neighbour to the West
      if live_cell.x == cell.x && live_cell.y == cell.y - 1
        live_neighbours << live_cell
      end
      # Neighbour to the North-West
      if live_cell.x == cell.x - 1 && live_cell.y == cell.y - 1
        live_neighbours << live_cell
      end
    end
    live_neighbours
  end

  def randomly_populate
    cells.each do |cell|
      cell.alive = [true, false].sample
    end
  end

end

class Cell
  attr_accessor :x, :y, :alive #, :height, :width

  def initialize(x=0, y=0)
    @x = x
    @y = y
    @alive = false

    # Gosu
    # @height = height
    # @width = width
  end

  def alive?
    alive
  end

  def dead?
    !alive
  end

  def die!
    @alive = false
  end

  def revive!
    @alive = true # same as > self.alive = true
  end
end 
```

**这是我的gosu代码**

```
require 'gosu'
require_relative 'gol.rb'

class GameOfLifeWindow < Gosu::Window

  def initialize(height=800, width=600)

    # Basics
    @height = height
    @width = width
    super height, width, false, 500
    self.caption = 'My Game of Life'

    # Colors
    @white = Gosu::Color.new(0xffededed)
    @black = Gosu::Color.new(0xff121212)

    # Game world
    @rows = height/10
    @cols = width/10
    world = World.new(@cols, @rows)
    @game = Game.new(world)
    @row_height = height/@rows
    @col_width = width/@cols
    @game.world.randomly_populate

    @generation = 0
  end

  def update
#    unless @game.world.live_cells.count == 0
#      @game.tick!
      @generation += 1
#    end
  end

  def draw
    @game.world.cells.each do |cell|
      if cell.alive?
        draw_quad(cell.x * @col_width, cell.y * @row_height, @black,
                  cell.x * @col_width + @col_width, cell.y * @row_height, @black,
                  cell.x * @col_width + @col_width, cell.y * @row_height + @row_height, @black,
                  cell.x * @col_width, cell.y * @row_height + @row_height, @black)
      end
    end
  end

  def button_down(id)
    case id
    when Gosu::KbSpace
      @game.world.randomly_populate
    when Gosu::KbEscape
      close
    end
  end

  def draw_background
    draw_quad(0, 0, @white,
              width, 0, @white,
              width, height, @white,
              0, height, @white)
  end

end

window = GameOfLifeWindow.new
window.show 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T23:30:27.753

好的，我现在知道代码是正确的，只是循环该`tick!`方法需要很多时间。

**我制作了视频教程，涵盖了使用 TDD 和 Rspec 和 Gosu 游戏库在 Ruby 中制作生命游戏，你可以在这里查看它们 >** [http://svenduplic.com/2013/03/25/conways-game-of-life-在-ruby.html](http://svenduplic.com/2013/03/25/conways-game-of-life-in-ruby.html)

它们包含从头到尾的游戏制作，我解释每一行。最后我解释了为什么这里的代码需要很长时间才能正确完成和优化。

# json - Breeze js 是否关心您使用的是什么版本的 Json OData？

> ID：15422654
> 
> 赞同：0
> 
> 时间：2013-03-15T00:24:35.083
> 
> 标签：json, breeze

我想知道 Breeze js 是否需要使用 Json 详细（2.0 版）或轻（3.0 版），或者是否可以除了这两个 Odata 版本的 Json。使用另一个更安全吗？此外，是否可以使用 Atom OData（只是好奇，不在我的应用程序中使用它）？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T19:56:26.633

Breeze 当前使用[datajs](http://datajs.codeplex.com/documentation)库为任何 OData 服务提供支持。所以我们受到这个库理解的任何格式的限制。（我也不确定这个库如何处理 Atom OData）

请注意，这仅适用于 OData 服务，对于任何 Web Api 控制器提供的服务，JSON.NET 提供的序列化格式与 OData 轻格式非常相似。

我们已经研究过提供一个绕过 datajs 库并直接处理 OData 有效负载的处理选项，但我们还没有。

# javascript - 单击按钮时使用Jquery创建隐藏元素

> ID：15422655
> 
> 赞同：0
> 
> 时间：2013-03-15T00:24:42.687
> 
> 标签：javascript, jquery, html

我有一个使用 jscript 提交到服务器的表单，但是我需要发布提交按钮的值。这不能以传统方式完成，我必须使用 jscript 发布表单。我正在做的是当单击按钮时，我想创建一个带有按钮值的隐藏文本项并将其发布到服务器。我在创建元素并将其附加到表单时遇到了一些问题：

**脚本**

```
 $(document).ready(function(){      

    $('#query').click(function(e){

         var form = $('citizenRegistration');

          var self= $("#query"),newElement = $("<input type='hidden'/>");

          alert("self value is : "+self.val());

                 //create a new element and copy attributes             
                newElement
                    .attr("name", 'user_request2')
                    .val(self.val())
                    .appendTo('.buttons');

            alert(newElement.attr("name"));

        e.preventDefault();
        //alert($(this).val());
        //submitPage();

    });

}); 
```

**HTML**

```
 <div class="buttons">  
    <ol>
    <li><input id="save" type="submit" name= "user_request" value="Save"/>
    <input id="update" type="submit" name= "user_request" value="Update"/>
    <input id="query" type="submit" name= "user_request" value="Query"/>
    </li>       
    </ol>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:28:56.427

`type`在调用中指定属性，而`attr()`不是在元素的构造中。此外，选择器`citizenRegistration`缺少 a`.`或 a`#`取决于它是 id 还是 class。

```
 $(document).ready(function(){
        $("#query").click(function(e){
             var form = $("#citizenRegistration"); //Added # may need .

              //removed type=hidden, you can just use $(this)
              var self= $(this),newElement = $("<input/>");
                     //create a new element and copy attributes             
                    newElement.attr({
                            "name":"user_request2",
                            "type":"hidden" //added new attribute
                     }).val(self.val()).appendTo(".buttons");

            e.preventDefault();
        });
    }); 
```

**工作示例：http:** [//jsfiddle.net/BXqVP/1/](http://jsfiddle.net/BXqVP/1/)

使用 firebug 检查页面时可以看到隐藏元素：

![在此处输入图像描述](../Images/72d5531fd04a5e1df6b6a86d4f3156f4.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:31:18.760

如果没有看到您的 HTML，我无法确定，但我看到了两个可能的问题：

```
var form = $('citizenRegistration'); 
```

这不是一个有效的选择器。它可能应该以`#`or开头`.`。不过，您似乎并没有最终使用它。

```
.appendTo('.buttons'); 
```

如果`.buttons`是输入元素，则不能附加到它。`.buttons`如果有多个元素，您也不应该附加到多个元素。相反，您可能应该将其附加到`form`. 只会`.appendTo(form)`工作正常。

# entity-framework - 当所有代码更改都由 DBA 完成时，是否有替代使用 EF 进行代码优先迁移的方法？

> ID：15422664
> 
> 赞同：10
> 
> 时间：2013-03-15T00:26:23.717
> 
> 标签：entity-framework

我已经阅读了有关 Code First Migrations 的信息，但似乎这并不适合企业。

我们有一个 DBA 来完成我们所有的数据库更改，我们不需要将这些更改放入类中并由应用程序执行数据库迁移。

如果我们更改我们的类和我们的 fluent API，然后让我们的 DBA 对数据库进行更改，那么我们如何同步到我们的 EF 模型？对于企业规模的应用程序，这通常是如何完成的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-12-14T18:20:02.677

对我来说，这些其他答案似乎还不够。

您可以关闭 EF 初始化程序：

```
public ApplicationContext : DbContext
{
    public ApplicationContext()
        : base("ConnectionStringName")
    {
        Database.SetInitializer<ApplicationContext>(null);
    }

    // DbSets here
    public DbSet<Part> Parts {get; set;}

    // override OnModelCreating below ...
} 
```

然后使用 Fluent API/数据注释，但是您通常会设置您的 POCO/模型以匹配现有数据库。

此博客的详细信息：http: [//cpratt.co/entity-framework-code-first-with-existing-database/](http://cpratt.co/entity-framework-code-first-with-existing-database/)

**万一该 URL 将来不起作用 - 这就是我的意思：**

在上面设置了 Initializer 之后，配置与表对应的 POCO：

```
public class Part
{
    public string PartID {get; set;}
    public string Description {get; set;}
    public decimal Weightlbs {get; set;}
    public decimal Price {get; set;}
} 
```

然后通过在您的类中覆盖此方法将您的 POCO 映射到现有的数据库表`Application Context`：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    // Code First will assume a lot, but if you need to override things:

    modelBuilder.Entity<Part>().ToTable("db_PartTable");
    modelBuilder.Entity<Part>().Property(p => p.PartID) 
        .HasColumnName("Part_ID");
    modelBuilder.Entity<Part>().Property(p => p.Description)
        .HasMaxLength(100)
} 
```

另一个很好的博客，由 Scott Guthrie 撰写：[http ://weblogs.asp.net/scottgu/using-ef-code-first-with-an-existing-database](http://weblogs.asp.net/scottgu/using-ef-code-first-with-an-existing-database)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-15T01:37:06.657

即使我使用 EF Code First 样式（与 EDMX 相对），我仍然在技术上使用数据库优先方法，因为我从不让 EF 为我生成数据库。相反，我创建类来为数据库建模。这听起来像你需要做的事情。

至于 DBA 改变的东西.. 你是否需要更新你的域实体类取决于 DBA 改变的是什么。例如，如果他正在增加 a `varchar(100)`to`varchar(200)`或类似的长度，那么该更改不应真正破坏您的代码（但仍然建议您更新代码以匹配此内容）。如果他正在删除或重命名某些列，那么您肯定需要更新您的域实体类，因为这显然会导致底层模型不同步的异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T02:00:57.517

回复有点晚，但这里有：

如果您使用 Visual Studio 的 EF Power Tools 扩展，它使您能够执行 Rowan Miller 所说的“代码第二”。看看[这篇文章](http://romiller.com/2012/05/09/customizing-reverse-engineer-code-first-in-the-ef-power-tools/)。

它可以让你指向一个现有的数据库，它会生成漂亮的 POCO 类，并且`DbContext`就像你通过 Code First 完成它一样使用。没有更多`ObjectContext`或`edmx`文件。流畅的配置也为您完全生成。

展望未来，EF 团队将把这个功能整合到主要的 EF 工具中，这样您就不必下载 EF Power Tools 扩展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T10:44:05.370

通常在这种情况下人们使用数据库优先的方法。

当有人已经为您设计了数据库并且您可以通过几次点击生成或更新模型时，手动编写实体代码是没有意义的。当然，如果您的团队熟悉其他一些 ORM（其中它是主要方法）并且还不太熟悉 Entity Framework，或者如果您的团队非常小并且没有人可以编写 SQL 脚本，那么 Code First 可能会很方便，但是如果您有熟练的 DBA，为什么您需要 Code First？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T02:06:57.687

只是对此添加一些想法-看看这两个帖子（我不久前发布的）： [https ://stackoverflow.com/a/10164815/417747](https://stackoverflow.com/a/10164815/417747)
[https://stackoverflow.com/a/10255051/417747](https://stackoverflow.com/a/10255051/417747)

简而言之，根据我的经验：

*   您无法在真正的企业级数据库中轻松“维护”这样的解决方案。“两个世界”迟早会发生冲突，同步事情可能会很痛苦（尽管可行）
*   但是你不应该因此而放弃它。它有利于快速启动并经过仔细计划，同步您可以使这项工作持续一段时间，
*   您可以转储脚本和/或调整迁移代码，调整“播种” - 取消一些更改（仍然有一些限制是痛苦的，我怀疑它会“模仿” DBA 可以做什么），
*   您可以跳过 CF 的“生成”，一旦它走得太远（实际上很快，只要 DBA 接管）- 并且只是（使用脚本并在帖子中部分解释）确保您的 Db-s 匹配（真实和“代码' 蓝图一）。这仍然意味着您已经设置了大部分表格等，并且您需要调整一些东西，
*   这是一个“经验法则”，在很多情况下 CF 是不合理的 - 所以只需将其用于原型设计，
*   对于您所描述的场景，一个好的“数据库生成器”可能是一个更好的解决方案（但它也有一些缺点），但我仍然没有看到两个世界的一个好的“组合”

希望这个对你有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-31T15:32:55.750

几天前我遇到了同样的问题，

旧数据库，__MigrationHistory 表是 ![在此处输入图像描述](../Images/e7e3d521984e2cb28eb9185103d28a49.png)

在数据库中进行更改并在本地计算机上重新创建它 ![在此处输入图像描述](../Images/1dfdfe6fdfb6b264196847fa657edac6.png)

将当前创建数据库的 __MigrationHistory 表中的 ContextKey、Model 和 ProductVersion 添加到旧数据库的 __MigrationHistory 表中。 ![在此处输入图像描述](../Images/5a67cb68d4660f27d980271700c39ff7.png)

哦，不要忘记对旧数据库使用更改脚本。如需更多信息，请查看

[http://www.codeproject.com/Tips/800936/Entity-Framework-code-first-migrations-alternative](http://www.codeproject.com/Tips/800936/Entity-Framework-code-first-migrations-alternative)

# javascript - 如何在 JavaScript 中创建高级倒数计时器？

> ID：15422665
> 
> 赞同：2
> 
> 时间：2013-03-15T00:26:43.660
> 
> 标签：javascript, timer, countdown, gmt

我对 JavaScript 有点陌生，但我确实有一些基本的了解。我想创建一个可以接受日期和时间的倒数计时器，但我不确定如何或从哪里开始。

我希望倒数计时器是这样的：[http ://www.timeanddate.com/clocks/freecountdown.html](http://www.timeanddate.com/clocks/freecountdown.html)

那么如何确保它在指定的时区、闰年和 DST 设置内工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:34:21.030

欢迎来到 Stackoverflow！

我不会透露所有内容，但是如果您希望时间明确正确（即使客户的计算机设置为错误的日期），您也必须使用类似[TimeAPI](http://www.timeapi.org/)的东西。

如果您想确保它在指定的[时区](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)、闰年等情况下工作，[Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)对象应该可以解决问题：

```
var x = new Date();
var currentTimeZoneOffsetInHours = x.getTimezoneOffset() / 60; 
```

处理 DST 比较复杂，但一般的共识就是使用[Date 对象的 UTC 方法](http://www.w3schools.com/jsref/jsref_utc.asp)：

```
 var d=Date.UTC(2012,02,30); 
```

这将确保您没有跨越任何时区边界。SO上有几个与此类似的问题，请随意搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:03:27.137

坦率地说，你需要更多地学习 javascript。

查看：

*   [JavaScript 日期和时间教程](http://www.tutorialized.com/tutorials/Javascript/Date-and-Time/1)
*   [日期/时间函数](http://javascript.info/tutorial/datetime-functions)
*   [JavaScript 日期和时间函数](http://www.quackit.com/javascript/javascript_date_and_time_functions.cfm)
*   [日期方法或函数](http://www.hscripts.com/tutorials/javascript/date-methods.php)

基本上，您可以使用函数设置日期的各个时间部分。然后计算当前日期和所需结束日期之间的差异（获取毫秒差异，然后计算时间字符串以显示剩余时间）。

一旦您生成了一些实际代码，请用它更新您的问题，我们可能会为您提供更多帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-20T15:52:49.017

这不是很先进，但它是一个好的开始。示例将打印到 2015 年还有多少天、多少小时和多少分钟。

```
// NewYearCalculator
// Written by Riku Viitanen
// 2014

today = new Date();

BigDay = new Date("1, 1, 2015");
msPerDay = 24 * 60 * 60 * 1000 ;
timeLeft = (BigDay.getTime() - today.getTime());
e_daysLeft = timeLeft / msPerDay;
daysLeft = Math.floor(e_daysLeft);
e_hrsLeft = (e_daysLeft - daysLeft)*24;
hrsLeft = Math.floor(e_hrsLeft);
minsLeft = Math.floor((e_hrsLeft - hrsLeft)*60);

document.write("Only  " + daysLeft + " days,  " + hrsLeft +" hours and " + minsLeft + " minutes left to year 2015!"); 
```

对不起我的英语不好，如果是：3

# multithreading - QT 线程从不运行

> ID：15422667
> 
> 赞同：1
> 
> 时间：2013-03-15T00:27:04.513
> 
> 标签：multithreading, qt

我正在尝试使用 Qthread，但似乎无法弄清楚线程何时实际执行。我只能在创建线程的函数退出时看到它的执行，但我不希望我当前的函数在单次执行后退出。我想在这个函数的循环中多次运行线程。

///////////////////////////////////////// ///////////////////

```
// --- PROCESS ---
// Start processing data.
void GrayDisplay::process() 
{
    std::cout << "Thread context!" << std::endl;  //I never see this print

    emit finished();
}

void gig::OnPlay()
{
    //Create thread and assign selected
    QThread* thread = new QThread;

    if(ui->colorBox->currentIndex() == 0 )
    {
        GrayDisplay* display = new GrayDisplay();
        display->moveToThread(thread);
        connect(display, SIGNAL(error(QString)), this, SLOT(errorString(QString)));
        connect(thread, SIGNAL(started()), display, SLOT(process()));
        connect(display, SIGNAL(finished()), thread, SLOT(quit()));
        connect(display, SIGNAL(finished()), display, SLOT(deleteLater()));
        connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));

        std::cout << "Creating Thread!" << std::endl;
    }
    else
    {
        cout << "\nInvalid mode selected";
        return;
    }

    pSemaphore->acquire();
    run = true;
    pSemaphore->release();

    //Read data
    while(run)  //set false by click event
    {
        QCoreApplication::processEvents();
        Sleep(33);
        if (thread->isRunning())  //Always prints and I expect just the first loop iteration to print, not infinitely as it does
            cout << "Worker is-STILL-Running\n";

        thread->start();
        QApplication::exec();
        QCoreApplication::processEvents();
//      while (!thread->isFinished())
//      {
//          QApplication::exec();
//          QCoreApplication::processEvents();
//      }   //Never returns
    }   //WHILE RUN LOOP

    return;
} 
```

我在这里看到过类似的线程，但解决方案似乎总是： QCoreApplication::processEvents(); 这似乎对我没有帮助。如果我创建并启动线程，它似乎总是在运行，但从不做任何事情（永远看不到我的 print 语句）并且永远不会完成。我添加了睡眠来模拟每个循环在需要启动新线程之前完成每个循环所需的时间。我希望上一个线程到那时已经完成。我试图让一个简单的版本正常工作，但不知道我错过了什么。我只想在离开 OnPlay() 函数时删除线程，但多次执行线程直到我决定退出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T13:27:32.880

我认为您在以下线程中遇到了与我相同的问题：[为什么我的线程不能正常退出？](https://stackoverflow.com/questions/15632868/why-do-my-threads-not-exit-gracefully).

问题是线程的事件循环仅**在**process() 返回后建立。这意味着在此时间之前发送到您的线程的所有退出事件都将被删除。

qeventloop.cpp：

```
// remove posted quit events when entering a new event loop
QCoreApplication *app = QCoreApplication::instance();
if (app && app->thread() == thread())
    QCoreApplication::removePostedEvents(app, QEvent::Quit); 
```

就我而言，一个简单的

```
QThread::currentThread()->quit(); 
```

在 process() 结束时成功了。

# php - CakePHP 关联错误？不会保存关联表

> ID：15422670
> 
> 赞同：0
> 
> 时间：2013-03-15T00:28:05.947
> 
> 标签：php, sql, cakephp, associations, model-associations

我创建了一个用户配置文件，用户可以在其中添加他们的信息。因此，在 URL 部分，我希望他们放置其他链接，例如 Facebook、www.facebook.com/user 等。

但是当我单击不保存任何更新时？

这是用户模型：Models/User.php

```
<?php
class User extends AppModel {

    public $name = 'User';

    public $hasMany = array (
    'UserWeb'=>array(
        'className'=>'UserWeb',
        'foreignKey'=>'user_id'
        )
    );
}
?> 
```

UserWeb 的模型：Models/UserWeb.php

```
<?php
class UserWeb extends AppModel {

public $name = 'UserWeb';

public $belongsTo = array('User' =>
    array('className'  => 'User',
        'conditions' => '',
    'order'      => '',
    'foreignKey' => 'user_id'
    )
    );
}
?> 
```

用户控制器：

```
$this->User->id = $this->Auth->user('id');
if ($this->request->is('post')) {
    if ($this->User->save($this->request->data, array('validate' => false))) {
        $this->Session->setFlash('Profile updated succsessefully!',
                                     'default', array('class' => 'okmsg'));

    $this->redirect($this->request->here);
    } else {
      $this->Session->setFlash('Profile could not be saved. Please, try again.',
                                       'default', array('class' => 'errormsg'));
    }
} 
```

和视图形式：

```
<?php
    echo $this->Form->create();
echo $this->Form->input('UserWeb.title',
         array('label'=>false,'placeholder'=>'Title'));
echo $this->Form->input('UserWeb.url',
         array('label'=>false,'placeholder'=>'Enter URL'));
echo $this->Form->end('Save');
?> 
```

有人可以帮忙吗？我试图找到解决方案很多时间。当我提交表单时，它不会在 user_webs 表中存储新信息。

顺便说一句，这里是表格：

```
CREATE TABLE `user_webs` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) DEFAULT '0',
  `title` varchar(128) DEFAULT NULL,
  `url` varchar(128) DEFAULT NULL,
  `created` datetime DEFAULT NULL,
  `modified` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `web` (`user_id`),
  CONSTRAINT `web` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T02:46:41.787

您正在尝试关联模型的数据。并且您的主模型没有要保存的数据。

你可以在这里采取两种方法，

1.  您现在的方式，获取`User`信息并让他们提供`UserWeb`来自同一表格的信息。使用将提供信息作为注册的一部分。为此，您应该参考[保存关联模型数据 - saveAll()](http://book.cakephp.org/2.0/en/models/saving-your-data.html#model-saveall-array-data-null-array-options-array)

2.  第二种方式，让用户在注册期间提供他们的信息，然后让他们`UsersWeb`稍后添加。（稍后我的意思是用户也可以在注册期间更新它，但不能以相同的形式）。对于这个用途`UserWeb`。从 中出现相同的表格`/yourapp/UsersWebs/add`。您必须提供`user_id`. 这样会更精致。

P.S: I strongly recommend you to go through [Saving your data](http://book.cakephp.org/2.0/en/models/saving-your-data.html#saving-your-data) again. It will hardly take you 10 mins, I am sure you have done this before but sparing another 10 mins after having encountered the issue will help you understand these things as back of your hand.

# backbone.js - 骨干模型是 DTO 还是 POCO (POJO)？

> ID：15422672
> 
> 赞同：1
> 
> 时间：2013-03-15T00:28:15.937
> 
> 标签：backbone.js

我正在为我的 Web 项目使用带有 .NET WCF 服务的 Backbone，我真的希望您对以下内容提出意见。
在编写 .NET WCF 服务时，我有一个包含许多属性和多个数据传输对象 (DTO) 的大模型，每个服务返回我的模型的一部分。我正在使用这些 DTO 将数据返回到 Backbone 客户端。
我想知道，我是否应该为每个 DTO 创建一个 Backbone 模型（它的 url 将是服务 url）？
或者也许我应该创建一个大的主干模型并只填充我拥有的数据（调用服务 A 时用 A 的结果填充模型，调用服务 B 时，继续用 B 的结果填充模型）？
使用 DTO 模型方法，当一个模型包含其他模型中存在的属性时，更改第一个模型将需要我同步另一个模型的数据。
使用一个大模型将需要我覆盖 fetch 和 save 方法，以便该模型能够与多个服务交互，而不仅仅是一个。

您认为 Backbone 应该如何工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:49:27.390

正如 WiredPrairie 建议的 Backbone 方法（我认为，“智能程序员”方法）是将事物分解为单独的组件。

每个程序员，作为一个人，一次只能围绕这么多代码。如果您尝试在代码中创建大量类，则基本上可以保证您不会一次将所有相关部分“保存在内存中”。此外，几乎每个人都同意测试是代码可维护性的关键部分，而大类抑制了测试。

最终，你不想要几个大类，你想要很多很多小类一起工作来创建你的应用程序。使用这种方法，您可以轻松地理解您正在处理的类，因为它的大小是可管理的，并且您可能也可以同时将与其交互的每个类的一般工作方式保持在您的脑海中。此外，您可以轻松编写单元测试，因为每个类只有一个目的和一组（合理大小的）要测试的操作。

Backbone 很好地支持了这一点；我不能肯定地说，但我很确定 Jeremy Ashkenas 从来没有期望任何人`View`在他们的整个网站上都只有一个。相反，我很确定他期望站点（至少是正常站点）将许多站点组合`Views`在一起来创建站点。同样，试图用一个巨人做所有事情`Model`确实违背了 Backbone 的设计用途。

有许多方法可以使用 Backbone 在较小的组件之间“连接点”。例如，如果您确实需要一次保存所有数据，这并不意味着您应该只有一个`Model`. 您可以创建一个`Model`处理同步的“主”，然后给它一堆属性或属性，它们是`Collections`或其他`Models`. 然后，您可以覆盖该`initialize`方法以填充这些`Models`/ `Collections`，并覆盖该`toJSON`主设备的方法`Model`以使用其子模块和子集合的 toJSON 结果。

或者，您可以覆盖子类上的`sync`方法（或单个 CRUD 方法，如`save`and `fetch`），这样当他们尝试`fetch`/ `save`/whatever 时，它们实际上会触发主对象的保存。或者，您可以覆盖`Backbone.sync`以监视发生的每个操作并阻止来自子对象的操作。或者你可以...

关键是，对于任何环境中的几乎所有程序员来说，将许多小部件连接在一起而不是试图在一个地方一次完成所有事情是一种很好的做法。因为 Backbone 是一个非常强大和灵活的库，它为您提供了很多方法来做到这一点。

# c# - 按钮双击事件

> ID：15422675
> 
> 赞同：2
> 
> 时间：2013-03-15T00:29:05.167
> 
> 标签：c#, winforms, visual-studio-2010

我正在尝试将双击事件添加到 winforms 中的按钮，但它永远不会在运行时执行。我的按钮是在运行时动态创建的

这就是我目前正在尝试的：

```
buttons[r][c].MouseDoubleClick += new MouseEventHandler(mouseDBL_Click); 

private void mouseDBL_Click(object sender, EventArgs e)
{
    // do something
} 
```

我也试过：

```
buttons[r][c].DoubleClick += new EventHandler(gridDBL_Click);

private void gridDBL_Click(object sender, EventArgs e)
{
    // do something
} 
```

我真的不明白为什么这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:08:32.140

使用`MouseClick`事件并检查`Clicks`属性

```
private void button1_MouseClick(object sender, MouseEventArgs e)
{
    if (e.Clicks >= 2)
    {
    }
} 
```

**更新**

抱歉，我刚刚尝试过，它似乎不起作用。我查了更多关于为什么会这样。你可以在这里找到答案：

[WinForms如何调用一个Button的双击事件？](https://stackoverflow.com/questions/13486245/winforms-how-to-call-a-double-click-event-on-a-button)

很奇怪，如果它不起作用，它就会被包括在内。实际上，该事件甚至似乎都没有触发。

# .net - 创建系统定义的对象（枚举）

> ID：15422682
> 
> 赞同：0
> 
> 时间：2013-03-15T00:30:02.300
> 
> 标签：.net, vb.net, visual-studio-2010

是否可以在 VS2010 上的 VB.Net 中创建我最能描述为系统定义的对象？我已经包含了来自颜色类的图片，描述了我想知道的功能。

![在此处输入图像描述](../Images/40d345de8ec1ae08eb4bf7dc99812147.png)

另外，如果有更好的名称，请告诉我，以便我可以重命名问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:54:04.597

An`Enum`或多或少是一个类型声明，其成员是数值的别名。

在您问题的示例中，`Color`类型是`Structure`（值类型），您看到的可用颜色的不同选项实际上是`Shared`在`Structure`. 这样做而不是作为 an`Enum`的原因是因为该`Color`类型不是数字类型。

例如，如果您想创建自己的 Color 类，它看起来像：

```
Public Structure MyColor
    Property Red as Byte
    Property Green as Byte
    Property Blue as Byte

    Sub New(r as Byte, g as Byte, b as Byte)
        Red = r
        Green = g
        Blue = b
    End Sub

    Shared ReadOnly Property BrightRed as MyColor
        Get
            Return New Color(255,0,0)
        End Get
    End Property
End Structure 
```

`MyColor.`在上面的示例中，当您在代码编辑器中键入“”时，BrightRed 将显示为一个选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:38:11.973

```
Enum Color
    Red
    Orange
    Yellow
    Green
    Blue
    Purple
End Enum 
```

# php - 检查时将数据保存在数据库中并在取消选中时删除

> ID：15422683
> 
> 赞同：0
> 
> 时间：2013-03-15T00:30:03.300
> 
> 标签：php, javascript, jquery, mysql, checkbox

我正在尝试做的是分别在复选框选中/取消选中时保存/删除（mysql）数据库中的数据。我已经动态生成了复选框，我想将特定复选框的数据保存在数据库中。同时，如果取消选中该特定复选框数据将从数据库中删除。谁能告诉我这可能在 php 中使用 jquery 或任何其他脚本语言。提前致谢。

我正在添加一些代码我试过这个我的“table_edit_ajax.php”代码

```
<?php
$mysql_hostname = "localhost";
$mysql_user = "root";
$mysql_password = "";
$mysql_database = "test";
$bd = mysql_connect($mysql_hostname, $mysql_user, $mysql_password) 
or die("Opps some thing went wrong");
mysql_select_db($mysql_database, $bd) or die("Opps some thing went wrong");

if($_POST[first_input_.$i])
{
$firstname=mysql_escape_String($_POST[first_input_.$i]);
$sql = "INSERT INTO fullnames(firstname)VALUES('$firstname')";
mysql_query($sql);
}
?> 
```

这是我在其中生成名为“test.php”的复选框的主文件

```
<?php
$mysql_hostname = "localhost";
$mysql_user = "root";
$mysql_password = "";
$mysql_database = "test";
$bd = mysql_connect($mysql_hostname, $mysql_user, $mysql_password) 
or die("Opps some thing went wrong");
mysql_select_db($mysql_database, $bd) or die("Opps some thing went wrong");
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script type="text/javascript">
$('.edit_tr').on('change', function(){
    // saving or deleting?
    var savedelete;
    if ($(this).is(':checked')) savedelete='save';
    alert ("save test");
    else savedelete='delete';
    alert ("delete test");
    // what am I changing?
    var name=$(this).attr('first_input_<?php echo $i; ?>');

    // call the server
    $.ajax({
      type: "POST",
      url: 'table_edit_ajax.php'
      data: {"do": "saveordelete", "whichone": savedelete,  "name": name   },
      success: function(data){
        if (data=='true'){ // is string not boolean
            // it worked
            alert ("true");
        }else{
            // didn't work
            alert ("false");
        }
      }
    });

});
</script>
<style>
body
{
font-family:Arial, Helvetica, sans-serif;
font-size:14px;
}

td
{
padding:7px;
}
.editbox
{
font-size:14px;
width:270px;
/*background-color:#ffffcc;*/

border:solid 1px #000;
padding:4px;
}

th
{
font-weight:bold;
text-align:left;
padding:4px;
}
.head
{
background-color:#333;
color:#FFFFFF

}

</style>
</head>

<body bgcolor="#dedede">
<div style="margin:0 auto; width:750px; padding:10px; background-color:#fff; height:800px;">

<table width="100%">
<tr class="head">
<th>First Name</th>
</tr>
<?php
$i=1;
while($i<=5)
{
if($i%2)
{
?>
<tr id="lovetr<?php echo $i; ?>" class="edit_tr">
<?php } else { ?>
<tr id="trlove<?php echo $i; ?>" bgcolor="#f2f2f2" class="edit_tr">
<?php } ?>
<td width="50%" class="edit_td">
<input type="checkbox" value="firstname<?php echo $i; ?>" class="editbox" name="first_input_<?php echo $i; ?>" />
</td>
</tr>

<?php
$i++;
}
?>

</table>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:36:05.160

JQuery 将使用 $.ajax 与服务器对话，最好是 POST。

服务器将尝试使用 PHP 和 MySQLi 删除数据库行。
如果成功或不成功，PHP 会回显并死掉一个有用的响应，供 jQuery 解释。这可能只是`true`和`false`

ajax 等待该响应，当它到达时将使复选框保持原样，或者在删除失败时将其切换到原来的状态。您可能想确认操作是否成功。

SO 不是供人们编写您的代码的，您需要深入研究它。对于经验丰富的开发人员来说，这很容易，但如果您不尝试，您将无法学习。如果您遇到编程问题，请随时提出更多问题。

**示例 jQuery**未选中

```
<label><input type="checkbox" value="1" name="apples" class="savedelete" />Save/Delete</label>
<label><input type="checkbox" value="1" name="pears" class="savedelete" />Save/Delete</label> 
```

jQuery

```
$('.savedelete').on('change', function(){
    // saving or deleting?
    var savedelete;
    if ($(this).is(':checked')) savedelete='save';
    else savedelete='delete';
    // what am I changing?
    var name=$(this).attr('name');

    // call the server
    $.ajax({
      type: "POST",
      url: 'index.php'
      data: {"do": "saveordelete", 
        "whichone": savedelete,
        "name": name
      },
      success: function(data){
        if (data=='true'){ // is string not boolean
            // it worked
        }else{
            // didn't work
        }
      }
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-07T18:56:53.383

```
 <?php
 include('../dbcon.php');
 $id = $_POST['id'];
 mysql_query("delete from files where file_id = '$id' ")or die(mysql_error());
 ?> 
```

您可以使用复选框制作 id 选择器并添加到 $_POST['selector'];

```
 <?php
        include('../dbcon.php');
        if (isset($_POST['backup_delete'])){
        $id=$_POST['selector'];
        $N = count($id);
        for($i=0; $i < $N; $i++)
        {
            $result = mysql_query("DELETE FROM teacher_backpack where file_id='$id[$i]'");
        }
        header("location: backack.php");
        }
        ?> 
```

# arrays - TypeError：错误＃1010：术语未定义且没有属性。

> ID：15422685
> 
> 赞同：1
> 
> 时间：2013-03-15T00:30:20.257
> 
> 标签：arrays, actionscript-3

```
 TypeError: Error #1010: A term is undefined and has no properties. 
at SchoolBookV2_fla::MainTimeline/dragObject1()[SchoolBookV2_fla.MainTimeline::frame18:50] 
```

我正在尝试一些简单的拖放操作。但它似乎给了我这个错误。有人可以帮我解决吗？看起来它正在将变量 v 作为空引用。是不是应该有不同的排序？

代码：

```
import flash.sampler.NewObjectSample;
import flash.display.Sprite;

var bag : Sprite = new Sprite ();
var book1: Sprite = new Sprite ();
var book2: Sprite = new Sprite ();
var book3: Sprite = new Sprite ();
var book4: Sprite = new Sprite ();
var totalArray: Array = new Array ();
var v:int = 0;

bag.graphics.beginFill(0xFF6666);
bag.graphics.drawRect( 30,30, 100, 150);
bag.graphics.endFill();
addChild(bag);

book1.graphics.beginFill(0xCC6666);
book1.graphics.drawRect(300,300, 100, 150);
book1.graphics.endFill();
addChild(book1);

book2.graphics.beginFill(0xCC6666);
book2.graphics.drawRect( 150,150, 100, 150);
book2.graphics.endFill();
addChild(book2);

book3.graphics.beginFill(0xCC6666);
book3.graphics.drawRect( 200,200, 100, 150);
book3.graphics.endFill();
addChild(book3);

book4.graphics.beginFill(0xCC6666);
book4.graphics.drawRect( 80,80, 100, 150);
book4.graphics.endFill();
addChild(book4);

totalArray[totalArray.length] = book1;
totalArray[totalArray.length] = book2;
totalArray[totalArray.length] = book3;
totalArray[totalArray.length] = book4;

for (v; v < totalArray.length; v++)
{
    trace(totalArray.length);
    totalArray[v].addEventListener(MouseEvent.MOUSE_UP, stopdragObject1);
    totalArray[v].addEventListener(MouseEvent.MOUSE_DOWN, dragObject1);
    function dragObject1(e:MouseEvent)
    {

        totalArray[v].startDrag();
    }

    function stopdragObject1(l:MouseEvent)
    {
        totalArray[v].startDrag(false);
        trace("exists");
        if (totalArray[v].hitTestObject(bag))
        {

            totalArray[v].removeEventListener(MouseEvent.MOUSE_UP, stopdragObject1);
            totalArray[v].removeEventListener(MouseEvent.MOUSE_DOWN, dragObject1);
            trace("itworks");
            totalArray[v].x = xPos;
            totalArray[v].y = yPos;
            trace("it doesn'twork");
        }
        else
        {
            totalArray[v].x = xPos;
            totalArray[v].y = yPos;
            trace("it doesn'twork");
        }

        totalArray[v].stopDrag();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:01:59.780

for 循环内的闭包是不好的魔力。当事件处理程序被调用时，它将使用 v 的值进行循环的最后一次迭代。

使`dragObject1`and`stioDragObject1`函数正常功能并通过`event.target`

```
for (v; v < totalArray.length; v++)
{
    trace(totalArray.length);
    totalArray[v].addEventListener(MouseEvent.MOUSE_UP, stopdragObject1);
    totalArray[v].addEventListener(MouseEvent.MOUSE_DOWN, dragObject1);
}

private function dragObject1(e:MouseEvent)
{
    e.target.startDrag();
}

private function stopdragObject1(l:MouseEvent)
{
    var sprite:Sprite = l.target as Sprite;

    if (sprite.hitTestObject(bag))
    {
        sprite.removeEventListener(MouseEvent.MOUSE_UP, stopdragObject1);
        sprite.removeEventListener(MouseEvent.MOUSE_DOWN, dragObject1);

        sprite.x = xPos;
        sprite.y = yPos;
    }
    else
    {
        sprite.x = xPos;
        sprite.y = yPos;
    }

    sprite.stopDrag();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:04:14.530

这里有一些问题，尽管我无法确定究竟是什么导致了错误。

首先，你不应该在这样的循环中实例化函数。请阅读我对[AS3 循环不起作用](https://stackoverflow.com/questions/14617223/as3-loop-doent-work/14618960#14618960)的答案，以更好地理解原因。基本上：这是一场记忆噩梦。

其次，这实际上可能是您的问题，`v`并不是指拖动时选择的对象。您会看到，在循环运行后（可能会在几毫秒内发生）， v 等于`totalArray.length`。`totalArray[ totalArray.length ]`不可能存在，因为数组索引从 0 开始，但长度从 1 开始。所以这可能是问题所在。

这是你应该做的：

1.  将函数移出循环。这是不必要的，浪费内存，你不能在循环之外调用它们
2.  在函数中，不要`totalArray[v]`像现在这样调用，而是这样做`var cur:Sprite = e.currentTarget as Sprite;`然后引用`cur`。这将检索实际选择的对象。

除此之外，我真的建议您阅读范围的工作原理。您似乎对它的工作原理和方式有一个非常基本的了解，但这还远远不够。

# css - 中心导航栏 css

> ID：15422686
> 
> 赞同：1
> 
> 时间：2013-03-15T00:30:20.177
> 
> 标签：css, menu, center

我想在页面中间有我的导航栏，但我不知道该怎么做。这是我的代码。

CSS

```
ul {
  list-style-type:none;
  margin:0;
  padding:0;
  overflow:hidden;
}
li {
  float:left;
}
a {
  display:block;
  width:80px;
  background-color:#000000
} 
```

HTML

```
<ul>
  <li><a href="http://kevril.site40.net/">Home</a></li>
  <li><a href="http://www.youtube.com/user/SuperKevril">Youtube</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T00:37:05.347

居中块级元素很容易，只需定义 a`width`和 set `margin:0 auto;`，但如果您不知道固定宽度怎么办？您可以使用`text-align:center;`，但这也不适用于`width:100%`块级元素……仅适用于文本级元素。

定义明确`width`的并且`height`应该尽可能避免，因为这样做会使文档的面向未来、灵活和可扩展性大大降低。假设您的导航菜单中有四个项目。您可以解决`width`这些问题并使用`margin:0 auto;`它们来居中。添加五分之一会增加宽度，这意味着您也需要更改 CSS。这远非理想，使用 CMS 为网站提供动力更是如此（客户端可以添加页面，但可能无法编辑 CSS）。

但是，有一种方法可以在不知道明确宽度且不添加 CSS 的情况下实现居中的水平导航。这也非常容易。尝试这个：

HTML：

```
<ul class="nav">
  <li><a href="/">Home</a></li>
  <li><a href="/about/">About</a></li>
  <li><a href="/work/">Work</a></li>
  <li><a href="/clients/">Clients</a></li>
  <li><a href="/contact/">Contact</a></li>
</ul> 
```

CSS：

```
.nav{
    border:1px solid #ccc;
    border-width:1px 0;
    list-style:none;
    margin:0;
    padding:0;
    text-align:center;
}
.nav li{
    display:inline;
}
.nav a{
    display:inline-block;
    padding:10px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:33:04.690

尝试这个：

```
position: relative;
margin: auto; 
```

# android - LinearLayout 未以编程方式使用 TableLayout 更新

> ID：15422687
> 
> 赞同：0
> 
> 时间：2013-03-15T00:30:22.930
> 
> 标签：android, android-layout, android-linearlayout

我有一个 LinearLayout，我使用以下代码以编程方式使用 TableLayout 进行更新：

```
public void updateTableView(MyData data){
  DataTable dataTable = new DataTable(getApplicationContext(), data);
  LinearLayout placeHolder = (LinearLayout) findViewById(R.id.rel_view);
  placeHolder.addView(dataTable);
} 
```

（有关更多背景信息，请参阅[基于以编程方式添加的 View 的 Android RelativeLayout 对齐](https://stackoverflow.com/questions/15421709/android-relativelayout-alignment-based-on-view-added-programmatically/15421832?noredirect=1#15421832)。）

第一次`updateTableView`调用该方法时，它工作正常。但是 LinearLayout 似乎忽略了所有后续调用。我知道这是因为`data`每次都不同，但应用程序只显示第一次调用的结果`updateTableView`，即视图没有改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:45:20.397

可能是因为您没有删除以前添加`DataTable`的视图。尝试调用`removeView()`：

```
private DataTable dataTable;

public void updateTableView(MyData data) {
  if (dataTable != null) {
      placeHolder.removeView(dataTable);
  }
  dataTable = new DataTable(getApplicationContext(), data);
  LinearLayout placeHolder = (LinearLayout) findViewById(R.id.rel_view);
  placeHolder.addView(dataTable);
} 
```

# ruby-on-rails - 如何将时间戳插入到 Rails 数据库列中

> ID：15422695
> 
> 赞同：7
> 
> 时间：2013-03-15T00:31:28.563
> 
> 标签：ruby-on-rails

我刚开始使用 RoR 并且有一个问题：如何将当前时间戳（或任何类型的时间）插入模型中？下面你会看到日志函数 create。

```
def create
    @log = Log.new(params[:log])

    respond_to do |format|
      if @log.save
        format.html { redirect_to @log, notice: 'Log was successfully created.' }
        format.json { render json: @log, status: :created, location: @log }
      else
        format.html { render action: "new" }
        format.json { render json: @log.errors, status: :unprocessable_entity }
      end
    end
  end 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-15T00:36:29.513

Rails 模型生成器会自动为您在数据库中创建 `created_at`和`updated_at` `datetime`字段。这些字段分别在创建或更新记录时自动更新。

如果您想手动创建时间戳，请将日期时间列（例如`timestamp_field`）添加到数据库并在模型中使用`before_save`回调。

```
class Log < ActiveRecord::Base
  before_save :generate_timestamp

  def generate_timestamp
    self.timestamp_field = DateTime.now
  end
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-15T00:37:47.823

使用 rails 生成器，例如`rails generate model Log`rails 会自动为您创建两个时间戳字段。

`created_at`当您在该记录上创建新记录时，`updated_at`Rails 将填充这两个字段`Log.new`，`save`或者仅当您更新记录的属性或在模型实例上 使用该方法时，`Log.create`该字段才会更新。`updated_at``touch`

现在，如果您想创建另一个具有时间戳类型的字段，您可以进行迁移，向您的模型添加一列，如下所示

```
rails generate migration add_some_timestamp_field_to_logs my_timestamp_field:timestamp 
```

这将生成一个迁移，它将添加一个以类型命名的列`my_timestamp_field`，`timestamp`就像`created_at`和`updated_at`

# java - 您可以在使用 Selenium Webdriver 启动 Firefox 后延迟测试启动吗？

> ID：15422697
> 
> 赞同：0
> 
> 时间：2013-03-15T00:31:33.230
> 
> 标签：java, selenium, webdriver

我试图让 Selenium 在 Firefox 加载后等待 5 秒钟，以便加载我的所有配置文件更改。目前，WebDriver 在配置文件更改之前开始测试，因此失败。WebDriver 中是否有任何内置函数可以延迟测试开始？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T05:41:14.857

如果您只是在启动浏览器后使用 java

```
Thread.sleep(5000); 
```

# perl - 如何使用 Perl 计算代表金钱的数字？

> ID：15422700
> 
> 赞同：0
> 
> 时间：2013-03-15T00:31:44.577
> 
> 标签：perl

我如何计算 10 美元中有多少 25 美分硬币、硬币、镍币和便士？

我知道我需要一段时间，但我不知道一段时间后会是什么情况。

然后我这样做了：

```
while(#read from a file)
print $cents
$left = $cents %25 #i did this since quarter is the largest change we have. 
```

在那之后，我不知道如何继续写下有多少 25 美分硬币、硬币、五分钱和便士。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T01:09:20.113

如果您想找出零钱，请以美分金额（而不是美元金额）计算，然后减去最大硬币的最大数量，然后减去下一个最大硬币的最大数量，等等。硬币值为 1,5， 10,25，我认为这总是会得出使用最少硬币的答案（尽管对于不同的可用硬币情况并非如此）。

```
my $amount_in_cents = 1000;  # $10 * 100¢/$

my @coins = (25, 10, 5, 1);
my @change;
for my $coin (@coins) { 
   push @change, int($amount_in_cents / $coin);
   $amount_in_cents -= $change[-1] * $coin;
}

say join ', ', map "$change[$_]x$coins[$_]¢", grep $change[$_], 0..$#coins; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:42:04.500

你可以先看看如何使用一枚硬币：

```
my $break_apart = 1000; # ten dollars, in pennies
my $break_into = 25; # a quarter
my $remainder = $break_apart % $break_into;
my $count = ($break_apart - $remainder) / $break_into; 
```

然后扩展它以使用多个硬币：

```
my @coins = (1, 5, 10, 25);
my $break_apart = 1000; # ten dollars, in pennies
for my $break_into (@coins)
{
    my $remainder = $break_apart % $break_into;
    my $count = ($break_apart - $remainder) / $break_into;
} 
```

# ios - 2 iad 横幅错误

> ID：15422706
> 
> 赞同：0
> 
> 时间：2013-03-15T00:32:10.263
> 
> 标签：ios

如果只有一个 iAd 横幅，一切都很好。它可以获取广告横幅。但是如果我将 iAd 横幅视图放在两个视图/视图控制器中，它将显示

```
[AppDeveloper]: ADBannerView: Unhandled error 
(no delegate or delegate does not implement didFailToReceiveAdWithError:): Error     
Domain=ADErrorDomain Code=2 "The operation couldn’t be completed. 

Loading throttled" UserInfo=0xab6ec20 {ADInternalErrorCode=2,    
ADInternalErrorDomain=ADErrorDomain, NSLocalizedFailureReason=Loading throttled} 
```

欢迎您的评论

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T00:41:44.847

首先，您的问题是您没有`delegate`为每个 iAd 横幅设置一个。

**其次**，您的应用程序中存在**严重的实现问题**。您绝不应该制作多个 iAd 横幅，只是为了在两个不同的屏幕上显示。您需要使用由中心对象管理的共享横幅，例如您的委托。谷歌`shared iAd banner`寻求帮助。

# php - 选择已经从MYSQL拉取的数据

> ID：15422708
> 
> 赞同：1
> 
> 时间：2013-03-15T00:32:35.043
> 
> 标签：php, mysql

如果标题不清楚，我很抱歉，我真的不知道这会是一个什么样的标题。我将从我正在做的事情开始。我正在尝试帮助我的公司存储数据并将它们从一个非常大的 excel 文件中提取出来。我有一个网页，它使用 PHP 显示来自 MYSQL 的数据并将其放入表中。我已将其设置为您可以更新和删除用户信息的位置。我现在需要做的是，他们需要从他们看到的列表中打印选定的少数人。所以我想用已经提取的数据，我可以有一个带有复选框的表单，让他们选择他们想要发送到另一个页面的用户以供他们打印。我正在考虑让我选择

```
echo $rows['id']; 
```

这是为该用户发布的。我似乎无法找到如何获取已经发布的 id。我看到我是如何更新用户的

```
<td align="center"><a href="update.php?id=<?php echo $rows['id']; ?>"><font color="Blue">Update</font></a></td> 
```

但这只会选择那个用户。这是我正在使用的代码。

```
<?php
$host="localhost"; // Host name
$username=""; // Mysql username
$password=""; // Mysql password
$db_name=""; // Database name
$tbl_name=""; // Table name

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$sql="SELECT * FROM $tbl_name ORDER BY lname";
$result=mysql_query($sql);

?>

<html>
<head>
<link rel="stylesheet" type="text/css" href="mysite.css">

</head>

<body>

<div id="title">
<center>
<img src="Logo.jpg" />
</center>

<p class="intitle"><font size="3"><a href="form.html" title="Add New Client"><font     color="blue">New Client</font></a></p>
</div>

<br />
<br />

<center>

<table width="600" border="1" cellspacing="0" >
<th>Print</th>
<th>                    <strong>PRG</strong>        </th>
<th class="name">       <strong>NAME</strong>       </th>
<th class="sex">        <strong>SEX</strong>        </th>
<th>                    <strong>PHASE</strong>      </th>
<th>                    <strong>DOCKET</strong>     </th>
<th class="date">       <strong>INTAKE</strong>     </th>
<th class="address">    <strong>ADDRESS</strong>    </th>
<th class="phone">      <strong>PHONE</strong>      </th>
<th class="phone">      <strong>ALT PHONE</strong>  </th>
<th class="date">       <strong>LAST OV</strong>    </th>
<th class="date">       <strong>LAST HV</strong>    </th>
<th class="date2">      <strong>OV</strong>         </th>
<th class="date2">      <strong>HV</strong>         </th>
<th>                    <strong>UPDATE</strong>     </th>
<th>                    <strong>DELETE</strong>     </th>

<?php
while($rows=mysql_fetch_array($result)){
?>
<form id="sendtoprint" class="appnitro"  method="post" action="printview.php">
<tr>
<td align="center" >        <input type="checkbox" id="" name="id"    value="printview.php?id=<?php echo $rows['id']; ?>" ></td>
<td align="center">         <?php echo $rows['program'];     ?>                  </td>
<td align="center">         <?php echo $rows['lname']; ?>,         <?php echo $rows['fname']; ?>    </td>
<td align="center">         <?php echo $rows['sex']; ?>         </td>
<td align="center">         <?php echo $rows['phase']; ?>       </td>
<td align="center">         <?php echo $rows['docket']; ?>      </td>
<td align="center">         <?php echo $rows['intake']; ?>      </td>
<td align="center">         <?php echo $rows['address']; ?>     </td>
<td align="center">         <?php echo $rows['phone']; ?>       </td>
<td align="center">         <?php echo $rows['altphone']; ?>    </td>
<td align="center">         <?php echo $rows['lastov']; ?>      </td>
<td align="center">         <?php echo $rows['lasthv']; ?>      </td>
<td align="center">         <?php echo $rows['hv']; ?>          </td>
<td align="center">         <?php echo $rows['ov']; ?>          </td>
<td align="center"><a href="update.php?id=<?php echo $rows['id']; ?>"><font color="Blue">Update</font></a></td>
<td align="center"><a href="delete_ac.php?id=<?php echo $rows['id']; ?>"><font color="Blue">Delete</font></a></td>
</tr>

<?php
}
?>

</table>
<input style='position:relative; left:-630px; top: -200px;' id="saveForm"  class="button_text" type="submit" name="submit" value="Print Selected" />
</form>
</center>
<?php
mysql_close();
?> 
```

那是显示信息的页面。现在我需要一个带有复选框的表单，让他们选择用户发送到其他页面进行打印。

有没有办法让它工作，或者这比我想要做的更复杂。

如果你能帮忙就好了

谢谢

阿德里安

# sql - 使用 SQL Server 匹配/分组几个键值对

> ID：15422710
> 
> 赞同：2
> 
> 时间：2013-03-15T00:33:09.863
> 
> 标签：sql, sql-server-2008, tsql, select

我正在构建一个将配置文件“匹配”在一起的应用程序。例如，这是我的架构的简化版本：：

**用户** ID
名字
姓氏

**UserProfile** Id
UserId
SomeOtherFields

**UserProfileFields** Id
UserProfileId
键值
_

UserProfile 存在以保存一些标准信息（出生日期等......）

UserProfileFields 基本上是一个键及其值的列表，以便建立一个看起来有点像这样的字典（再次，为了这个问题的目的而简化）

```
UserProfileID | Key       | Value       
123           | food      | Pizza
123           | food      | Indian
4453          | drink     | Coke
44850         | drink     | Orange Juice
88493         | food      | Pizza
448382        | food      | Chinese 
```

所以，从上面，我们可以看到配置文件 123 与 food 上的 88493 匹配 - 他们都有 food|pizza

有没有一种方法可以有效地查询该表以获取“匹配项”列表

我设想它每天运行一次，结果存储在一个单独的表中

例如：

**火柴**

```
MatchID | ProfileID
1       | 123
1       | 88493 
```

我在猜测类似的东西

```
SELECT * FROM UserProfileFields
GROUP BY Key 
```

查询类型...但不确定这对 100 万行的效率有多高？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T06:03:15.927

这应该会为您解决。

```
-- ============================================================================
-- BEGIN: SETUP TEST DATA
-- ============================================================================
CREATE TABLE UserProfileFields (
    UserProfileID   int
   ,[Key]           varchar(5)
   ,Value           varchar(12)
);

INSERT UserProfileFields (UserProfileID, [Key], Value)
SELECT A.*
  FROM (
        SELECT * FROM UserProfileFields WHERE 1=2
        UNION ALL SELECT 123,       'food',     'Pizza'
        UNION ALL SELECT 123,       'food',     'Indian'
        UNION ALL SELECT 4453,      'drink',    'Coke'
        UNION ALL SELECT 44850,     'drink',    'Orange Juice'
        UNION ALL SELECT 88493,     'food',     'Pizza'
        UNION ALL SELECT 448382,    'food',     'Chinese'
        UNION ALL SELECT 88493,     'drink',    'Coke'
        UNION ALL SELECT 88493,     'drink',    'Orange Juice'
       ) A;

--/*
-- Turn 8 records into 1,048,576
DECLARE @Count int; SELECT @Count = 0;
WHILE @Count < 17
  BEGIN
    INSERT UserProfileFields
    SELECT * FROM UserProfileFields

    SELECT @Count = (@Count + 1)
END
--*/
-- SELECT COUNT(*) FROM UserProfileFields WITH (NOLOCK)
-- ============================================================================
-- END: SETUP TEST DATA
-- ============================================================================

-- ============================================================================
-- BEGIN: Solution if Key, Value, and UserProfileID do NOT make up a unique key
-- ============================================================================
SET NOCOUNT ON
IF OBJECT_ID('tempdb..#DistinctValues', 'U') IS NOT NULL DROP TABLE #DistinctValues;
IF OBJECT_ID('tempdb..#Matches', 'U') IS NOT NULL DROP TABLE #Matches;

SELECT [Key], UserProfileID, Value 
  INTO #DistinctValues
  FROM UserProfileFields WITH (NOLOCK)
 GROUP BY [Key], UserProfileID, Value;

SELECT A.[Key], A.Value, A.UserProfileID
  INTO #Matches
  FROM #DistinctValues A
  JOIN #DistinctValues B
    ON A.[Key]           = B.[Key]
   AND A.Value           = B.Value
   AND A.UserProfileID  <> B.UserProfileID;

SELECT DENSE_RANK() OVER(ORDER BY A.[Key], A.Value) [MatchID]
      ,A.UserProfileID
      ,A.[Key]
      ,A.Value
  FROM #Matches A;
-- ============================================================================
-- END: Solution if Key, Value, and UserProfileID do NOT make up a unique key
-- ============================================================================

-- ============================================================================
-- BEGIN: Solution if Key, Value, and UserProfileID make up a unique key
-- ============================================================================
IF OBJECT_ID('tempdb..#Matches', 'U') IS NOT NULL DROP TABLE #Matches;

SELECT A.[Key], A.Value, A.UserProfileID
  INTO #Matches
  FROM UserProfileFields A WITH (NOLOCK)
  JOIN UserProfileFields B WITH (NOLOCK)
    ON A.[Key]           = B.[Key]
   AND A.Value           = B.Value
   AND A.UserProfileID  <> B.UserProfileID;

SELECT DENSE_RANK() OVER(ORDER BY A.[Key], A.Value) [MatchID]
      ,A.UserProfileID
      ,A.[Key]
      ,A.Value
  FROM #Matches A;
-- ============================================================================
-- END: Solution if Key, Value, and UserProfileID make up a unique key
-- ============================================================================ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T08:25:27.910

将选项与 EXISTS() 运算符和覆盖索引一起使用。这将有助于避免过度的数据排序。

```
CREATE INDEX ix_Key_Value_UserProfileFields ON dbo.UserProfileFields([Key], Value) INCLUDE(UserProfileID)

SELECT DENSE_RANK() OVER(ORDER BY t.[Key], t.Value) AS MatchID, t.UserProfileID
FROM dbo.UserProfileFields t
WHERE EXISTS (
              SELECT 1
              FROM dbo.UserProfileFields t2
              WHERE t.[Key] = t2.[Key]
                AND t.Value = t2.Value
              HAVING COUNT(*) > 1  
              ) 
```

![在此处输入图像描述](../Images/a9e48cee8c37ecbf0518b62f63a06222.png)

[**SQLFiddle**](http://sqlfiddle.com/#!3/45c8f/1)上的演示[](http://sqlfiddle.com/#!3/45c8f/1)

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T01:10:37.827

```
WITH Matches
AS
(
    SELECT  a.UserProfileID,
            a.[Key],
            a.Value,
            DENSE_RANK() OVER(ORDER BY a.[Key]) MatchID
    FROM    UserProfileFields a
            INNER JOIN
            (
                SELECT  [Key], Value
                FROM    UserProfileFields 
                GROUP   BY [Key], Value
                HAVING  COUNT(DISTINCT UserProfileID) > 1
            ) b ON  a.[Key] = b.[Key] AND
                    a.Value = b.Value
)
SELECT  MatchID, UserProfileID
FROM    Matches 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/247a9/6)
*   [SQLFiddle Demo（*更新：与另外两个matchingID*）](http://www.sqlfiddle.com/#!6/d9bfe/2)**

# c# - 如何引用由 Desginer 创建的对象

> ID：15422711
> 
> 赞同：-2
> 
> 时间：2013-03-15T00:33:27.900
> 
> 标签：c#, oop, designer

（我使用默认的 Visual Studio 名称）如何在 form1.cs 文件的另一个自定义类中引用 texbox 对象（texbox1）（“公共部分类 Form1：Form”中的类）

这是我的代码。在 myclass 我写了 textBox1，但 intelisense 并没有向我建议。我是说。在这种情况下，我该怎么做才能使 texbox1 出现在智能中？在 form1.Desginer.cs 中将 private 更改为 public 并不能解决它。请回答。

```
namespace Calculator
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent(); 
        }

        class myclass 
        {

           textBox1

        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:39:15.400

您不能只在嵌套类中引用它作为类的一部分`Form1`，您必须传入一个引用

例子：

```
class myclass 
{
    public TextBox MyTextBox { get; set; }

    public MyClass(TextBox textbox)
    {
        MyTextBox = textbox;
    }
} 
```

然后在`Form1`你创建`MyClass`实例的类中，你可以传入你的`TextBox`

```
MyClass myClass = new MyClass(this.textBox1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:36:53.457

WinForms 设计器默认将组件设为私有，理想情况下您不应直接公开组件（例如控件），因为它会破坏封装。您应该代理要共享的字段，如下所示：

```
public partial class MyForm : Form {

    private TextBox _textbox1; // this field exists in the MyForm.designer.cs file

    // this property should be in your MyForm.cs file
    public String TextBox1Value {
        get { return _textbox1.Text; }
        set { _textbox1.Text = value; }
    }
} 
```

这样，您可以在表单之间共享数据，但也可以保持封装（尽管您应该选择一个比`TextBox1Value`我选择的更具描述性的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T00:37:02.397

在您的嵌套类`myclass`中，您没有指定您所指的类的哪个*实例。*`Form1`添加对 的特定实例的引用`Form1`，然后您将能够访问其`textBox1`成员。

通常，可以这样做：

```
class myclass
{
    public myclass(Form1 owner)
    {
        if (owner == null) {
            throw new ArgumentNullException("owner");
        }

        this.owner = owner;
    }

    private readonly Form1 owner;

    public void DoSomething()
    {
        owner.textBox1.Text = "Hello, world!";
    }
} 
```

此代码使用在这种情况下使用的各种模式：

*   `owner`在构造函数中设置，从而确保它*永远不会* `null`
*   除此之外，`null`被构造函数拒绝
*   该`owner`成员是`readonly`，因此可以肯定地说它在给定`myclass`实例的生命周期内不会改变

在 的方法中，您可以通过调用来`Form1`创建`myclass`链接到当前实例的实例。`Form1``new myclass(this)`

# core-animation - 检测 CAShapeLayer（线）上的触摸

> ID：15422713
> 
> 赞同：0
> 
> 时间：2013-03-15T00:33:32.933
> 
> 标签：core-animation

使用我在互联网上看到的标准代码，我无法检测到对单个 `CAShapeLayer 的触摸。

```
CGPoint p = [[touches anyObject] locationInView:self.view];

    CGPathRef path = ((CAShapeLayer *)[lettersArray objectAtIndex:1]).path;

    if(CGPathContainsPoint(path, nil, p, NO))
    {
        ((CAShapeLayer *)[lettersArray objectAtIndex:0]).position = p;
        NSLog(@"Touched");
    } 
```

我是否需要至少有一些区域而不仅仅是一个部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-20T10:03:18.953

哥们试试这个代码它对我有用

```
CGPathRef originalPath = shapeView.path;  //The single-line path

//Use the values you use to draw the path onscreen,
//or use a width representing how far the user can touch
//for it to be recognized by the path.
//For example, for an error tolerance of 4px, use a width of 8px.
CGPathRef strokedPath = CGPathCreateCopyByStrokingPath(originalPath, NULL, path.lineWidth, path.lineCapStyle, path.lineJoinStyle, path.miterLimit);
BOOL pathContainsPoint = CGPathContainsPoint(strokedPath, NULL, touchLocation, NO);

NSLog(pathContainsPoint ? @"Yes" : @"No"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:42:58.227

是的，您的路径需要有一些区域供 CGPathContainsPoint 测试一个点是否在其中。您可能想要做的是[找到从点到线的距离](http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line)并测试它是否在某个阈值内。

请注意，该文章中的公式为您提供了到*直线*而不是*线段*的距离；如果线上的最近点超出线段的边界，您还需要计算从您的点到线段端点的距离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-25T11:38:42.037

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
```

{

```
for (UITouch *touch in touches) {
    CGPoint touchLocation = [touch locationInView:self.view];
    for (id sublayer in self.view.layer.sublayers) {
        BOOL touchInLayer = NO;
        if ([sublayer isKindOfClass:[CAShapeLayer class]]) {
            CAShapeLayer *shapeLayer = sublayer;
            if (CGPathContainsPoint(shapeLayer.path, 0, touchLocation, YES)) {
                // This touch is in this shape layer
                touchInLayer = YES;
            }
        } else {
            CALayer *layer = sublayer;
            if (CGRectContainsPoint(layer.frame, touchLocation)) {
                // Touch is in this rectangular layer
                touchInLayer = YES;
            }
        }
    }
} 
```

}

# php - 如何在 PDF.js 中隐藏文件路径

> ID：15422714
> 
> 赞同：2
> 
> 时间：2013-03-15T00:33:38.470
> 
> 标签：php, pdf.js

我有 PDF.js 在我的服务器上工作，但我正在努力解决如何在不暴露我的文件路径的情况下实现它（或者理想情况下，将我的文件移动到 Web 根目录之外）。

[例如，我可以在我调用http://example.com/view?file=yyy.pdf&subdir=zzz](http://example.com/view?file=yyy.pdf&subdir=zzz)的地方实现一个传递 PHP

然后我可以使用 PDF.js 打开位于[http://example.com/obscure/zzz/yyy.pdf](http://example.com/obscure/zzz/yyy.pdf)的文件 （而不是调用[http://example.com/viewer?file=http:/ /example.com/obscure/zzz/yyy.pdf](http://example.com/viewer?file=http://example.com/obscure/zzz/yyy.pdf)）

或者，更好的是，webfoot 之外的文件：/absolute/path/zzz/yyy.pdf

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T04:48:55.143

NB 2013 年 3 月 26 日 - 抱歉，因为我将不得不撤回原始答案。

事实证明，HTTP_REFERER（总是拼写错误）在安全方面并不可靠，因为它很容易被欺骗。

我将在下面留下一些最初的想法，因为它显示了不应该做什么，相信它会是安全的，但首先会提出一个替代方案。

任何基于密钥的替代方案的基本挑战是，为了解锁非网站文件访问而来回发送的任何内容都将通过浏览器以各种方式可见，这是 PDF.js 实际运行并请求访问的地方。即使身份验证机制避开了主屏幕，或者如果使用 SSL 来保护通道，这也是正确的。

目前我能想到的最好的方法是一个有时间限制的密钥，接受这有一些实际困难。然而，即使我们看到的网络偶尔会变慢，时间窗口也可能相当短，因为密钥访问发生在下载文档的开始。

SSL 将是任何高安全性安排的要求，否则网络连接可能会被窥探并在超时内重新使用密钥。启动 PDF.js 的身份验证系统需要与文档网关协调，以获取 PDF.js 用来回调和获取访问权限的密钥。这可以使用 CMS 数据库可能实现的服务器上消息传递来完成。

因此，这看起来像是一种可能的设计，即使不是一个小时内完成的设计。如果 SSL 用于原始用户登录以及基于时间的密钥，它可能被认为与在线银行一样安全，包括现实生活中的人员因素。

以下是原始有缺陷的想法的感觉，供参考：

通过使用 .htaccess 条件仅允许本地提供的 pdf.js 文件对保存 pdf 的目录的权限，似乎有一个简单但现在看到的错误答案来保护文件。该目录需要在网站内，因为 pdf.js 访问的是网络空间而不是文件空间。这是条件和响应的形式，您可以针对您的 url 和 pdf.js 位置进行调整：

```
Options -Indexes
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^(http|https)://(www.)?yourdomain\.com/yourfolder/s/pdf\.js$
RewriteRule .* - [F] 
```

# wordpress - wordpress 安装 LEMP 服务器上的错误 500

> ID：15422717
> 
> 赞同：0
> 
> 时间：2013-03-15T00:33:59.320
> 
> 标签：wordpress, nginx

我刚刚按照 howtoforge 的说明用 Nginx 和 ISPconfig 设置了一个新的 linode，当我去设置我的新 wordpress 站点 www.timberwright.net 时，我收到错误 500。

这个问题的原因可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T21:57:18.623

使用 aps 系统，如上面的评论中所述，我能够使用 Ubuntu 12.04 LTS 服务器、nginx 和 ISPconfig 3 设置我的 wordpress 站点。

# python - 你能在 python 中返回表达式的值吗，就像在 C++ 中一样？或不

> ID：15422721
> 
> 赞同：1
> 
> 时间：2013-03-15T00:34:28.810
> 
> 标签：python

我有点困惑，我会很感激 SO 非常适合的那种立即解决方案。由于某种原因，此代码...

```
def process(self, command):
    return (command == "Quit" or "quit" or "Q" or "q") 
```

...在我的程序中产生相同的输出...

```
def process(self, command):
    return True 
```

什么？？但是，此代码按我的预期执行：

```
def process(self, command):
    return (command == "Quit") 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T00:35:59.357

让我们把它分开一点：

```
>>> command = 'foo'
>>> command == "Quit" or "quit" or "Q" or "q"
'quit' 
```

这是因为`or`操作员的工作方式。它查找第一个类似 True 的值并返回它。如果找不到，则返回`False`。

您在此处的命令被解析为：

```
((((command == "Quit") or "quit") or "Q") or "q") 
```

所以，从左到右解析，如果`command`不等于`"Quit"`，你有：

```
(((False or "quit") or "Q") or "q") 
```

但是这里，`"quit"`是一个非空字符串，所以 python 认为它是“True-like”，所以它是返回的。

* * *

现在我们知道它*为什么*不起作用了，让我们看看如何修复它：

执行此类操作的规范方法是`in`在支持它的某个对象上使用运算符：

```
def process(self, command):
    return command in ("Quit","quit","Q","q") 
```

元组很好（它们的性能会比列表好）。但是，如果您要一遍又一遍地使用它，`set`只要您可以避免一遍又一遍地构建它，a 将执行得最快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:39:47.667

```
def process(self, command):
    return command in ("Quit" , "quit" , "Q" , "q") 
```

# ios - 将 youtube v3 与 apikey 一起使用

> ID：15422722
> 
> 赞同：2
> 
> 时间：2013-03-15T00:34:28.983
> 
> 标签：ios, objective-c, youtube-api, api-key

我正在尝试使用 YouTube v3 API 使用 APIKey 而不是 oAuth2 执行搜索。

我的问题是，当我使用 APIKey 时，查询总是返回错误。

这是初始化服务的代码

```
_service = [[GTLServiceYouTube alloc] init];
[_service setRetryEnabled:YES];
[_service setAPIKey:kAPIKey]; 
```

这是查询的代码

```
GTLQueryYouTube *query = [GTLQueryYouTube queryForSearchListWithPart:@"snippet"];
query.q = filter;
query.type = type;
query.maxResults = maxResults;

[_service executeQuery:query completionHandler:
 ^(GTLServiceTicket *ticket, GTLYouTubeSearchListResponse *searchListResponse, NSError *error)
{
//-- do stuff
 }]; 
```

使用 APIKey 时返回的错误如下。如果我使用 oAuth，一切都会按预期进行。

```
error: Error Domain=com.google.GTLJSONRPCErrorDomain Code=403 "The operation couldn’t be completed. (Access Not Configured)" UserInfo=0x13d10ac0 {error=Access Not Configured, GTLStructuredError=GTLErrorObject 0x13d0c770: {message:"Access Not Configured" code:403 data:[1]}, NSLocalizedFailureReason=(Access Not Configured)} 
```

我已在 Google API 控制台上创建了 APIKey，并且该服务已启用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T16:59:42.560

不是理想的解决方案......但我在这篇文章中找到了一种解决方法： [google-youtube-api-v3-ios-app-key-403-error-code](https://stackoverflow.com/questions/15440285/google-youtube-api-v3-ios-app-key-403-error-code)

基本上，如果我们使用“浏览器应用程序密钥”而不是“iOS 应用程序密钥”，它将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T10:13:17.277

您是否从 google-console 的服务面板打开了 youtube api？

# sql - 是否可以为找到的每个不同记录获得第一个值？

> ID：15422723
> 
> 赞同：1
> 
> 时间：2013-03-15T00:34:46.673
> 
> 标签：sql, sql-server, tsql

是否可以创建一个查询，为每个不同的文件名提供第一个值？下面是我正在使用的一些示例数据。

```
 Filename                        Ticket
--------------------------------------|-----------
WMSORD_201302271225_72929031818357.txt| 0802228291          
WMSORD_201302271225_72929031818357.txt| 0802228294          
WMSORD_201302271225_72929031818357.txt| 0802228298          
WMSORD_201302271225_72929031818357.txt| 0802228299          
WMSORD_201302271225_72929031818357.txt| 0802228302          
WMSORD_201302271225_72929031818357.txt| 0802228303          
WMSORD_201302271225_72929031818357.txt| 0802228306          
WMSORD_201303051754_35529747798357.txt| 0802265977          
WMSORD_201303051754_35529747798357.txt| 0802265978          
WMSORD_201303051754_35529747798357.txt| 0802265979          
WMSORD_201303080927_83230090638357.txt| 0802284105          
WMSORD_201303080948_90430092648357.txt| 0802284233          
WMSORD_201303080948_90430092648357.txt| 0802284234          
WMSORD_201303080948_90430092648357.txt| 0802284235          
WMSORD_201303080948_90430092648357.txt| 0802284236          
WMSORD_201303080957_67930093468357.txt| 0802284303          
WMSORD_201303080957_67930093468357.txt| 0802284305          
WMSORD_201303081038_42730097848357.txt| 0802286362          
WMSORD_201303081038_42730097848357.txt| 0802286364          
WMSORD_201303081038_42730097848357.txt| 0802286366          
WMSORD_201303081038_42730097848357.txt| 0802286367 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:35:59.927

您可以使用`GROUP BY`和`MIN()`

```
SELECT  FileName, MIN(Ticket) Ticket
FROM    TableName
GROUP   BY FileName 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/cae89/1)

输出

```
╔════════════════════════════════════════╦═══════════╗
║                FILENAME                ║  TICKET   ║
╠════════════════════════════════════════╬═══════════╣
║ WMSORD_201302271225_72929031818357.txt ║ 802228291 ║
║ WMSORD_201303051754_35529747798357.txt ║ 802265977 ║
║ WMSORD_201303080927_83230090638357.txt ║ 802284105 ║
║ WMSORD_201303080948_90430092648357.txt ║ 802284233 ║
║ WMSORD_201303080957_67930093468357.txt ║ 802284303 ║
║ WMSORD_201303081038_42730097848357.txt ║ 802286362 ║
╚════════════════════════════════════════╩═══════════╝ 
```

# javascript - 可以相互访问的节点的有效分组

> ID：15422725
> 
> 赞同：1
> 
> 时间：2013-03-15T00:34:56.220
> 
> 标签：javascript, jquery, algorithm, d3.js, underscore.js

我有一些图形数据，节点之间的边在这种形式上：

```
var edges = [
    ["A","B"], ["B","C"], ["B","D"], ["E","F"], ["E","G"]
]; 
```

对可以相互访问的节点进行分组的最有效（运行时间）方法是什么？就我而言：

```
[["A","B","C","D"],["E","F","G"]] 
```

我正在寻找纯 javascript 中的解决方案，或者可能使用 d3.js、underscore.js 或 jQuery。伪代码也很好:)

* * *

**更新：**因为有些人提出这是[这个问题](https://stackoverflow.com/questions/15394534/java-algorithm-to-find-most-connected-numbers)的副本，所以我将解释我使用它的目的。

我有许多 2D 点（可能少于 500 个），我想对彼此靠近的点进行分组。首先，我在得到一个平面图的地方进行[delaunay 三角剖分，我将](http://en.wikipedia.org/wiki/Delaunay_triangulation)[欧几里德距离](http://en.wikipedia.org/wiki/Euclidean_distance)添加为边上的权重，并使用[Kruskal 算法](http://en.wikipedia.org/wiki/Kruskal%27s_algorithm)制作[最小生成树](http://en.wikipedia.org/wiki/Minimum_spanning_tree)(MST)。我从 MST 中删除了所有过长的边。现在我最终得到了一些我想要处理并找到集群的边（如上所述）。当我有集群时，我会制作它们的凸包来可视化它。

所以它是一个无向图。边缘唯一告诉我的是，它连接的两个顶点将在同一个簇中。

即使点数可能很低，运行时间也很重要，因为这将在每次鼠标移动时计算。

* * *

**解决方案：**感谢您的建议。为了完整起见，这是我提出的解决方案：

```
// Make a cluster for each vertex
var clusters = _.map(vertices, function(node) { return [node]; });

while(edges.length > 0) {

    var edge = edges.pop();
    var vertexA = edge[0],
        vertexB = edge[1];

    var cA = _.filter(clusters, function(cluster) {
        return _.contains(cluster, vertexA);
    });

    var cB = _.filter(clusters, function(cluster) {
        return _.contains(cluster, vertexB);
    });

    if(_.union(_.difference(cA,cB) , _.difference(cB,cA) ).length > 0) {
        clusters = _.without(clusters, cA[0], cB[0]);
        clusters.push(_.union(cA[0], cB[0]));
    }
}

return clusters; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:49:21.017

这是我要做的：

1.  制作节点列表。将每个标记为未访问（白色）
2.  从第一个节点开始将其标记为灰色。仅处理白色节点进行[广度优先](http://en.wikipedia.org/wiki/Breadth-first_search)或[深度优先搜索。](http://en.wikipedia.org/wiki/Depth-first_search)当您与父母结束时，将其标记为黑色。
3.  列表中的所有黑色节点都已连接。您可以将它们从您在 (1) 中创建的列表中删除，然后再次执行此操作以查找下一组连接的节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:27:51.490

这是有向图吗？还是无向图？

如果它的无向图，您可以使用 bfs/dfs。

1.  遍历未访问的顶点列表。
2.  从一个顶点开始，该顶点有一条边，而另一个顶点尚未访问。做 bfs/dfs。跟踪当前遍历中访问的节点
3.  对当前遍历中访问的节点进行分组。
4.  转到 1。

复杂性将与 BFS/DFS 相同。

# c - 服务器的线程与客户端实现通信

> ID：15422737
> 
> 赞同：1
> 
> 时间：2013-03-15T00:36:22.920
> 
> 标签：c, multithreading, client-server

我不确定如何使用线程实现服务器，以便线程与客户端通信，同时服务器能够设置新连接。我应该将什么传递给新线程？

如果有人有一段代码作为概念证明，那将非常有帮助。我的客户端在连接时必须传递一个参数，线程必须使用该参数来实现某些操作并将结果返回给客户端。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:42:20.790

“我应该将什么传递给新线程？” - 由 accept() 调用返回的服务器<>客户端套接字。

# url - 使用 Monotouch 在 UILabel 中显示可点击链接的最佳方式

> ID：15422738
> 
> 赞同：2
> 
> 时间：2013-03-15T00:36:23.827
> 
> 标签：url, xamarin.ios, uilabel, hyperlink, detection

在使用 Objective-C 语言进行开发时，我能够使用以下解决方案之一（这两种解决方案均不适用于 Monotouch）：

*   [TTT属性标签](https://github.com/mattt/TTTAttributedLabel)
*   [花式UILabels](http://furbo.org/2008/10/07/fancy-uilabels/)

在研究一些信息时，我可以在 TweetStation 应用程序中找到 Miguel 的实现：

*   [推特视图](https://github.com/migueldeicaza/TweetStation/blob/master/TweetStation/UI/TweetView.cs)

但当时，他写了一个用于检测链接的小解析器。由于我没有为 Monotouch 找到任何特殊的 UILabel 实现，我想从你这里知道：

使用 Monotouch 在 UITableViewCell 的 UILabel 文本中呈现可点击链接的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-14T14:58:20.337

我已经为 MonoTouch 开源了我的 TTTAttributedLabel 绑定，您可以使用它来获取标签中的链接。

*   [https://github.com/lipka/MonoTouch.TTTAttributedLabel](https://github.com/lipka/MonoTouch.TTTAttributedLabel)

例子：

```
TTTAttributedLabel label = new TTTAttributedLabel ();
label.Text = new NSString ("I love Tink");
label.AddLinkToURL (new NSUrl ("http://tinkapp.com/"), new NSRange (7, 4));
label.Delegate = new LabelDelegate ();

...

class LabelDelegate : TTTAttributedLabelDelegate {
    public override void DidSelectLinkWithURL (TTTAttributedLabel label, NSUrl url)
    {
        Console.WriteLine ("Clicked URL: {0}", url.ToString ());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T07:45:54.637

在我的项目中，我已经实现了这样的控制，但由于 NDA，不可能将其作为开源发布。

制作您自己的 MonoTouch 原生子类，`UILabel`社区会认可您的工作。的来源`TTTAttributedLabel`和类`NSMutableAttributedString`,将对您有所帮助。`CTStringAttributes``CTParagraphStyleSettings`

# android - 从 Android 应用程序发布到 Nodejs 服务器的编码问题，解码后的空格加号？

> ID：15422739
> 
> 赞同：1
> 
> 时间：2013-03-15T00:36:27.560
> 
> 标签：android, forms, node.js, post, encoding

我是编码问题的新手，我不确定我所做的是否不正确，或者我需要解决我得到的结果。

在我的 android 应用程序中，假设有人添加了一些文本“3 Ë Æ Œ Ø Ī”

在将其以多部分形式发布到我的节点服务器之前，我执行以下操作：

```
 textOneUTF = URLEncoder.encode(textFieldText, "UTF-8"); 
```

我将它们注销，这是文本在编码前后的样子：

```
BEFORE ENCODE: 3 Ë Æ Œ Ø Ī
3+%C3%8B+%C3%86+%C5%92+%C3%98+%C4%AA 
```

这已发布到我的节点服务器。

在服务器上，我这样做：

```
 if(req.body.textone) {
  textOne = decodeURIComponent(req.body.textone);
 } 
```

（我也试过 decodeURI。）

但是一切都以空格为加号，例如：

Œ+Ü+È+Æ+M+Ū

*   所以特殊字符是可以的，但是空格的加号是什么？

我不想在不了解是否有更好的方法或可能遇到的其他问题的情况下手动将“+”替换为“”？

** 编辑： **

我正在尝试查看是否可以处理这个问题，在萤火虫控制台中进行试验。

```
>>> boop = "%2B%2B%C3%86%40%23%C2%A3%25%26+%C5%92SS%C3%83%2B++%2B++++%2B%23%C5%92";

"%2B%2B%C3%86%40%23%C2%A3%25%26+%C5%92SS%C3%83%2B++%2B++++%2B%23%C5%92"

>>> boop.replace(/\+%2B/g," " );

"%2B%2B%C3%86%40%23%C2%A3%25%26+%C5%92SS%C3%83%2B+ +++ %23%C5%92"

>>> console.log(decodeURIComponent(boop));

++Æ@#£%&+ŒSSÃ+++++++++#Œ 
```

...你不能先用字符串替换 +%2B 空格，然后再解码字符串的其余部分，你也不能先解码。有什么建议么？

** /结束编辑 **

** 编辑 2**

现在我正在用这个函数解决这个问题：

```
function decodeTextSring(text) {

  var textfinished = "";
if(text.indexOf("+") != -1) {
  textSplit = text.split("+");

  for(i=0; i < textSplit.length; i++) {
    if(textSplit[i+1] != null) {
    textfinished += decodeURIComponent(textSplit[i]) + " ";
  }
  else {
    textfinished += decodeURIComponent(textSplit[i]);
  }
  }
}
else {
  textfinished = decodeURIComponent(text);
}

return textfinished;

} 
```

*   所以在Java编码添加的+上拆分，解码字符串的每一位，如果有的话，用空格重新组合。

***** 结束编辑 2****

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T00:12:58.137

使用`+`空格字符只是空格的简写符号，否则将被编码为`%20`. 这是我所知道的唯一简写符号，奇怪的是没有直接的方法来恢复编码的 URI 组件，但是您可以通过以下方式实现：

```
decodeURI(text.split('+').join('%20')) 
```

因为`decodeURI('3+%C3%8B+%C3%86+%C5%92+%C3%98+%C4%AA'.split('+').join('%20'))`结果是`3 Ë Æ Œ Ø Ī`；我假设这是您正在寻找的。**

# makefile - 由于zsh，Makefile没有扩展glob？

> ID：15422745
> 
> 赞同：1
> 
> 时间：2013-03-15T00:36:48.610
> 
> 标签：makefile, zsh

我的 Makefile 中有一行是这样的：

`prog /something/f.{one,two,three}`

但是运行我从 prog 获得的 make 文件

`/something/f.{one,two,three}`不存在。这让我相信 make 并没有扩大全球范围。通常这在 Bash 中对我有用，但我现在正在运行 zshell，所以我认为这就是问题所在。任何人都知道如何可移植地指定该模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:16:54.983

是否必须进行外壳扩展？Make 可以为您做类似的事情。这只是一种方法：

```
EXPANDED_POSTFIX := one two three
BASE_FILE := f.

PROG_FILE_LIST := $(foreach post,${EXPANDED_POSTFIX},${BASE_FILE}${post})

exec_prog:
    prog ${PROG_FILE_LIST} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T02:37:05.070

[ThePosey](https://stackoverflow.com/users/67455/theposey)建议的替代方法是使用[`addprefix`](http://www.gnu.org/software/make/manual/make.html#File-Name-Functions)：

```
FILE_SUFFIXES := one two three
FILE_BASE := /something/f

FILES := $(addprefix $(FILE_BASE).,$(FILE_SUFFIXES))

my_rule:
    prog $(FILES) 
```

# ember.js - ember.js 路由器是否同时支持来自不同路由的多个参数？

> ID：15422752
> 
> 赞同：1
> 
> 时间：2013-03-15T00:37:09.573
> 
> 标签：ember.js

[http://jsfiddle.net/BBt2h/1/](http://jsfiddle.net/BBt2h/1/)

上面的 jsfiddle 展示了一个简单的 ember.js 应用程序，它允许您

*   对您的内容进行分页
*   按列排序
*   通过键入过滤您的内容

> 分页路由 url 看起来像这样 /foo/#/page/2
> 
> 排序路由 url 看起来像这样 /foo/#/sort/id
> 
> 过滤路由 url 看起来像这样 /foo/#/search/text

TL;DR => 这是一个简单的 mixin，可以帮助您筛选在 ArrayController 中找到的大量数据

路线设置看起来像这样

```
PersonApp.Router.map(function(match) {
    this.resource("person", { path: "/" }, function() {
        this.route("page", { path: "/page/:page_id" });
        this.route("search", { path: "/search/:page_term" });
        this.route("sort", { path: "/sort/:page_column" });
    });
});

PersonApp.PersonSortRoute = Ember.Route.extend({
  setupController: function(controller, model) {
    this.controllerFor('person').set('sortBy', model);
  },
  model: function(params) {
    return PersonApp.Page.create({column: params.page_column});
  }
});

PersonApp.PersonSearchRoute = Ember.Route.extend({
  setupController: function(controller, model) {
    this.controllerFor('person').set('filterBy', model.get('term'));
  },
  model: function(params) {
    return PersonApp.Page.create({term: params.page_term});
  },
  serialize: function(model) {
    return { page_term: model.term };
  }
});

PersonApp.PersonPageRoute = Ember.Route.extend({
    model: function(params) {
        return PersonApp.Person.find(params.page_id);
    },
    setupController: function(controller, model) {
        this.controllerFor('person').set('selectedPage', model.get('id'));
    }
});

PersonApp.PersonRoute = Ember.Route.extend({
    model: function(params) {
        return PersonApp.Person.find();
    }
}); 
```

我的问题的基础

1.) 用户点击第 2 页链接，网址更改为

/foo/#/page/2

2.) 然后同一用户决定按用户名而不是默认 id 排序，因此他们单击用户名

/foo/#/排序/用户名

**现在我丢失了页面，但我的内容仍然有一个 selectedPage 2（来自分页）

3.）最后他们决定使用搜索/过滤器过滤列表

/foo/#/search/dave（在他们输入 4 个字母之后）

**现在我丢失了排序参数和页面参数（但状态是在控制器上设置的）

这里的问题是，在我决定按用户名排序并通过工作“dave”过滤所有内容之后，我需要能够复制第 2 页的 url - 并将其粘贴到电子邮件中给同事，以便他们可以看到我现在看到的确切结果......但你可以告诉我，我的网址不再反映所有状态。

此外，后退按钮按预期执行，因为每次 url 更改后我都丢失了一些上下文。

我如何构建我的路由来实现这一点（假设 RC1 路由器 api 完全支持这个）？

在新路由器合并之前（2013 年 1 月上旬），我有类似的工作

**更新**

看起来[alexspeller](https://twitter.com/alexspeller)有一个自定义的 mixin 可以在今天完成这个任务

这是[项目](https://github.com/alexspeller/ember-query)github 页面，[这里](https://github.com/emberjs/ember.js/issues/1773)是 github 上 emberjs 项目的未解决问题

# iconv - iconv：从 CP1252 转换为 UTF-8

> ID：15422753
> 
> 赞同：13
> 
> 时间：2013-03-15T00:37:10.727
> 
> 标签：iconv

我正在尝试将 CP1252 编码的字符串 Çàïèñêè ýêñïåäèòîðà 转换为 UTF-8。我试过这个命令：

```
iconv -c -f=WINDOWS-1252 -t=UTF-8 test.txt 
```

不走运，得到一些奇怪的结果：

ÃŠÃ€Ã‡Ã€ÃÃœ ÃŽÃ‚Ã›Ã‰ Ã‚Ã…ÃŠ</p>

我尝试在这里输入相同的字符串（Çàïèñêè ýêñïåäèòîðà），他们能够毫无问题地进行转换： [http ://www.artlebedev.ru/tools/decoder/](http://www.artlebedev.ru/tools/decoder/)

出了什么问题？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-09-16T10:48:29.140

当您`Çàïèñêè ýêñïåäèòîðà`使用命令将 CP1252 编码字符串转换为 UTF-8 时`iconv.exe -f CP1252 -t UTF-8 test.txt >testout.txt`，源文件`test.txt`（十六进制视图：

![在此处输入图像描述](../Images/f8b46dcef9c22fc7da9486e0c68ac578.png)

) 将被转换为目标文件`testout.txt`（十六进制视图：

![在此处输入图像描述](../Images/16954734d2350b27d12e0d5ad180825c.png)

) 这是 UTF-8 代码`Çàïèñêè ýêñïåäèòîðà`。

你放入的同样的垃圾会从另一端出来。iconv 的行为是正确的并且符合预期。

您感到困惑的是您看不到您的期望，那是因为您输入的 8 位字符串实际上是在[Windows-1251 (Cyrillic) Codepage](http://www.unicodetools.com/unicode/codepages.php?codepage=windows-1251)中编码的。

→ 所以正确的代码页不是 CP125**~~2~~**但是CP125 **1** ←</p>

![在此处输入图像描述](../Images/bc7d1037791cbde49ca840c4e4d09cd9.png)

命令`iconv.exe -f CP1251 -t UTF-8 test.txt >testout2.txt`将源文件`test.txt`转换为目标文件`testout2.txt`（十六进制视图：

![在此处输入图像描述](../Images/a252ae995cfdf63bc6da4ccdc01e64aa.png)

`Записки экспедитора`) 这是用户期望看到的UTF-8 代码

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-12T16:39:46.953

你需要使用这个：

```
$ echo "Çàïèñêè ýêñïåäèòîðà" | iconv -t latin1 | iconv -f cp1251
Записки экспедитора 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-09T11:26:49.573

我的解决方案：

```
iconv -f windows-1252 -t utf-8 in.file -o out.file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-14T22:09:22.330

如果你使用的是 linux，你应该使用[enconv](http://github.com/thiagoh/enconv "enconv.sh")

```
./enconv.sh -d /home/foo/example/directory -e ".java" -f "iso-8859-1" -t "utf-8" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-05T10:47:31.063

```
iconv -f utf8 -t cp1252 file.php | iconv -f cp1251 -t utf8 > file-utf8.php 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-05-07T13:58:23.390

尝试相反

```
 iconv -c -f=UTF-8 -t=WINDOWS-1252 test.txt 
```

# javascript - 根据 id 对多个 div 使用相同的功能

> ID：15422756
> 
> 赞同：2
> 
> 时间：2013-03-15T00:37:38.743
> 
> 标签：javascript, jquery, html, css

我有一个适用于某些 div 的函数，每 2 秒一次，在其中我想等待 1 秒来调用相同的方法，但给出其他 div，效果是，问题是我如何等待那一秒（目前每 2 秒一次） divs 执行效果，我想在 1 秒行中执行）。

```
$(function () {
    index = 0;
    window.setInterval(function () {
        if (index > 10){ 
            index = 0;
        }    
        myFunction("so1", "flipping-right");
        //setTimeout(funcx, 1000);
        myFunction("so2", "flipping-left");        
        //setTimeout(funcx, 1000);
        myFunction("so3", "flipping-top");
        //setTimeout(funcx, 1000);
        myFunction("so4", "flipping-bottom");
        //setTimeout(funcx, 1000);
        myFunction("so5", "flipping-right");

        i++;
    }, 2000); 
});

myFunction = function (id, effect ) { 
    $('#' + id).toggleClass(effect);
} 
```

请看一下[我的代码](http://jsfiddle.net/v2wxX/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:40:15.937

你几乎做对了，问题是你有函数调用，你需要传递函数本身。[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)接受一个函数参数，因此您需要将一个函数传递给它。

试试（在里面`setInterval`）

```
setTimeout(function(){
    myFunction("so1", "flipping-right");
    myFunction("so2", "flipping-left");        
    myFunction("so3", "flipping-top");
    myFunction("so4", "flipping-bottom");
    myFunction("so5", "flipping-right");
}, 1000); 
```

如果您想一个接一个地执行它们，您可以执行类似的操作

```
 setTimeout(function(){
        myFunction("so1", "flipping-right");
 }, 1000);
 setTimeout(function(){
        myFunction("so2", "flipping-left");  
 }, 2000);
 setTimeout(function(){
        myFunction("so1", "flipping-right");
 }, 3000);
 setTimeout(function(){
       myFunction("so3", "flipping-top");
 }, 4000);
 setTimeout(function(){
        myFunction("so5", "flipping-right");
 }, 5000); 
```

假设第二种行为是您想要的，这是[更新的小提琴。](http://jsfiddle.net/ncdWT/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:45:51.690

我不确定您是否要循环动画，但无论哪种方式，您都应该使用`setTimeout`并调用链中的每个元素：

```
myFunction = function (id, effect ) { 
    var $elem = $('#' + id);

    if ($elem.length) {
        setTimeout(function () {
            $elem.toggle(effect);
            myFunction(nextID, nextFlippint);
        }, 2000);
    }
} 
```

我建议将效果存储在元素本身上，`data-effect="flipping-right"`因为似乎没有任何其他类型的可计算顺序。至于`nextID`，您可以使用该`.next()`元素代替，也可以将 1 添加到当前 id。`$elem.length`如果你想让它循环，那么如果 id为零，则将 id 重置为 1 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T00:54:20.677

```
$(function () {
index = 0;
var datas = [
["so1", "flipping-right"],
["so2", "flipping-left"],
["so3", "flipping-top"],
["so4", "flipping-bottom"],
["so5", "flipping-right"]
];
// 2sec to start animate
setTimeout(function  () {
    // 1sec loop
    window.setInterval(function () {
        if (index > 10){ 
            index = 0;
        }    
        myFunction( data[i][0], data[i][1]);
        i++;
    }, 1000); 
},2000)
});

myFunction = function (id, effect ) { 
  $('#' + id).toggleClass(effect);
} 
```

可能看起来像这样

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T01:05:54.753

如果您想对时序进行更多控制，您可以将元素之间的延迟传递给函数。通过这种方式，您可以调整集合迭代之间的时间。

```
myFunction = function ($flip, delay) { 
    setTimeout(function(){
        var effect = "flipping-" + $flip.attr('data-direction');
        $flip.toggleClass(effect);
    },delay);
} 

$(function () {
    var timer = 0;
    $("[data-direction]").each(function(){
        myFunction($(this),timer);
        timer += 1000;
    });
}); 
```

# bash - 如何将变量从 shell 脚本传递到期望脚本？

> ID：15422757
> 
> 赞同：8
> 
> 时间：2013-03-15T00:37:43.393
> 
> 标签：bash, shell, expect

我的shell脚本如下：

```
#!/bin/bash

echo "Select the Gateway Server:"
echo "   1\. Gateway 1"
echo "   2\. Gateway 2"
echo "   3\. Gateway 3"

read gatewayHost

case $gatewayHost in
    1) gateway="abc.com" ;;
    2) gateway="pqr.com" ;;
    3) gateway="xyz.com" ;;
    *) echo "Invalid choice" ;;
esac

/mypath/abc 
```

在上面的脚本中，我从用户输入选择中获取网关并尝试传递给我的 abc.sh 脚本，该脚本期望如下所示：

```
#!/usr/bin/expect

set timeout 3
spawn ssh "james@$gateway"
expect "password:"
send "TSfdsHhtfs\r";
interact 
```

但我无法将网关变量从 shell 脚本传递给期望脚本。谁能告诉我如何实现这一目标？请注意，由于遗留原因，我只需要使用 shell 脚本（不能使用 tcl 脚本或不能在期望脚本本身中执行所有操作）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-15T00:45:02.193

从您的 shell 脚本中：

```
/mypath/abc $gateway 
```

从您的期望脚本中：

```
#!/usr/bin/expect

set gateway [lindex $argv 0]; # Grab the first command line parameter

set timeout 3
spawn ssh "james@$gateway"
expect "password:"
send "TSfdsHhtfs\r";
interact 
```

# r - 参数回收似乎不起作用

> ID：15422762
> 
> 赞同：0
> 
> 时间：2013-03-15T00:38:23.300
> 
> 标签：r

以下是产生以下错误的 A 数据框和 A 函数的重新创建：

```
Error in Ops.data.frame(sF1(x1, x2, x3, x4), sF1(x1, x2, 0, x4)) (from #2) : 
          - only defined for equally-sized data frames" 
```

数据框

```
S <- rep(c(1,2), each=1536)
D <- rep(c(0,2,4,6,8,10,15,20,30,40,45,50,55,60,65,70,80,85,90,92,94,96,98,100), each=16,times=16)
K <- rep(c("K", "Y","M","C"), each= 384, times=4)
I <- rep(c("A", "S"), each=3072)
Data <- rnorm(6144)
DataFrame <- cbind.data.frame(S,D,K,I,Data) 
```

我创建了两个函数，每个函数都有相同的四个参数

```
sF1 <-  function(x1,x2,x3,x4) subset(DataFrame, I == x1 & K == x2 & D == x3 & S==x4, select = "Data")

sF2 <- function(x1,x2,x3,x4){
    (100* (1-10^-(sF1(x1,x2,x3,x4) - sF1(x1,x2,0,x4))) /
     (1-10^-(sF1(x1,x2,100,x4)- sF1(x1,x2,0,x4)))) - x3} 
```

函数 'sF1' 运行没有问题

```
sF1(I,K,D,S) 
```

在第二个函数 'sF2' 产生上述错误

```
sF2(I,K,D,S) 
```

以下是“sF2”组件的细分：

*   sF1(x1,x2,x3,x4) 有 5632 行
*   sF1(x1,x2,0,x4) 有 256 行，我预计它会回收 22 次
*   sF1(x1,x2,100,x4) 也有 256 行，我预计它会回收 22 次

我猜这个错误是由于缺乏回收。我需要以不同的方式格式化我的数据框吗？我需要重写函数'sF2'吗？我整天都在旋转我的轮子，但没有成功。请帮助纠正这个错误。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:56:19.570

`subset`不推荐用于程序化使用。改为使用`[`。

话虽这么说，假设您想从 data.frame 返回单列，如果您不保留`data.frame`该类（哪个子集确实或`[..., ,drop = FALSE]`将要保留，那么回收将按您的预期工作。

我不清楚你真的想要`==`，不是`I%in%(unique(x1)`或类似的（但会留作练习

你可以重新定义

```
sF1 <-  function(x1,x2,x3,x4) with(DataFrame, Data[I == x1 & K == x2 & D == x3 & S==x4]) 
```

这将返回一个将回收的向量

# arrays - 在线性时间内迭代嵌套数组

> ID：15422764
> 
> 赞同：1
> 
> 时间：2013-03-15T00:38:50.303
> 
> 标签：arrays, algorithm, big-o

我知道如何做到这一点的唯一方法是嵌套循环。但这在 O(n^2) 时间内运行。我的导师告诉我，如果在一次采访中，我被要求解决一个问题，而我开始通过嵌套循环来解决问题，我应该停下来重新思考这个问题。显然，总有比 O(n^2) 更好的路线。我一直在考虑这个问题，无论我如何在 Google 上重新表述我的问题，我都找不到答案。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:41:58.370

*显然，总有比 O(n^2) 更好的路线*

我认为这显然是错误的。有些问题确实是 O(n^2)。除非有某种特定的语言特性可以以某种方式使问题更有效，否则 O(n^2) 是嵌套数组的最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:41:08.183

这是最快的方法。

如果您检查与整个嵌套数组结构中的条目一样多的条目......那么，您显然不能做得更好，不是吗？;)

您的困惑是您认为 n = 结构的维度，但实际上 n = 结构中的条目总数。所以使用嵌套循环是 O(n)

# django - reverse() 调用中的 Django NoReverseMatch

> ID：15422766
> 
> 赞同：2
> 
> 时间：2013-03-15T00:39:03.167
> 
> 标签：django, python-2.7

我已经在这个问题上度过了另一个晚上......有人可以帮忙吗？

我正在尝试复制[http://lightbird.net/dbe/todo_list.html](http://lightbird.net/dbe/todo_list.html)上的 kickstart 示例，该示例似乎是为早期版本的 Django 开发的（并且没有全面描述操作方法）

无论如何，我管理任务直到“将任务标记为完成”。然后我的问题开始了。

需要明确的是，在我将“mark_done”添加到我的 ItemAdmin 类的 list_display 属性之前，一切都很好。然后似乎无法解析 truc.todo.views.mark_done 我尝试了完整的绝对模块引用以及您在下面看到的部分引用，但无济于事。我更喜欢部分的（从“todo”开始），因为它意味着易于移植到其他项目。

提前感谢您的帮助。

我有一个文件树如下：

```
truc/ (my project)
|-todo/ (my app)
| |-__init__.py
| |-views.py
| |-urls.py  (module urls)
| |-models.py
| |-templates/admin/todo/item/change_list.html
|-truc/
| |-urls.py  (main urls)
| |-settings.py
| |-etc. 
```

# 我的主要网址包含：

```
from django.conf.urls import patterns, include, url
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^todo/$', include('todo.urls')),
    url(r'^admin/doc/', include('django.contrib.admindocs.urls')),
    url(r'^admin/', include(admin.site.urls)),
) 
```

# 我的模块网址包含：

```
from django.conf.urls import patterns, include, url

urlpatterns = patterns('todo.views',
    url(r'^mark_done/(\d*)/$', 'mark_done'),
) 
```

# 在models.py我有：

```
from django.db import models
from django.contrib.auth.models import User
from django.contrib import admin

from django.utils.translation import ugettext as _
from django.utils.encoding import force_text
from django.http import Http404, HttpResponse, HttpResponseRedirect
from django.core.urlresolvers import reverse

[...]
class Item(models.Model):
    name = models.CharField(max_length=60)
    created = models.ForeignKey(DateTime)
    priority = models.IntegerField(default=0)
    difficulty = models.IntegerField(default=0)
    done = models.BooleanField(default=False)

    def mark_done(self):
### The below is THE line which I cannot have work...
        return "<a href='%s'>Done</a>" % reverse("todo.views.mark_done", args=[self.pk])
    mark_done.allow_tags = True

class ItemAdmin(admin.ModelAdmin):
    list_display = ["name", "priority", "difficulty", "created", "mark_done", "done"]
    search_fields = ["name"]
[...] 
```

# 错误和回溯：

```
NoReverseMatch at /admin/todo/item/
Reverse for 'todo.views.mark_done' with arguments '(5,)' and keyword arguments '{}' not found.
Request Method: GET
Request URL:    http://127.0.0.1:8000/admin/todo/item/
Django Version: 1.5
Exception Type: NoReverseMatch
Exception Value:    
Reverse for 'todo.views.mark_done' with arguments '(5,)' and keyword arguments '{}' not found.
Exception Location: /Library/Python/2.7/site-packages/django/core/urlresolvers.py in _reverse_with_prefix, line 416
Python Executable:  /usr/bin/python
Python Version: 2.7.1

[...]
Template error:
In template /Users/arnaud/Documents/truc/todo/templates/admin/todo/item/change_list.html, error at line 92
   Reverse for 'todo.views.mark_done' with arguments '(5,)' and keyword arguments '{}' not found.
   82 :         {% endif %}

   83 :       {% endblock %}

   84 : 

   85 :       <form id="changelist-form" action="" method="post"{% if cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %}>{% csrf_token %}

   86 :       {% if cl.formset %}

   87 :         <div>{{ cl.formset.management_form }}</div>

   88 :       {% endif %}

   89 : 

   90 :       {% block result_list %}

   91 :           {% if action_form and actions_on_top and cl.full_result_count %}{% admin_actions %}{% endif %}

   92 :            {% result_list cl %} 

   93 :           {% if action_form and actions_on_bottom and cl.full_result_count %}{% admin_actions %}{% endif %}

   94 :       {% endblock %}

   95 :       {% block pagination %}{% pagination cl %}{% endblock %}

   96 :       </form>

   97 :     </div>

   98 :   </div>

   99 : {% endblock %}

   100 : 

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  140\.                     response = response.render()
File "/Library/Python/2.7/site-packages/django/template/response.py" in render
  105\.             self.content = self.rendered_content
File "/Library/Python/2.7/site-packages/django/template/response.py" in rendered_content
  82\.         content = template.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  140\.             return self._render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in _render
  134\.         return self.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  830\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  124\.         return compiled_parent._render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in _render
  134\.         return self.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  830\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  124\.         return compiled_parent._render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in _render
  134\.         return self.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  830\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  63\.             result = block.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  830\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  63\.             result = block.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  830\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  1185\.                     _dict = func(*resolved_args, **resolved_kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in result_list
  286\.             'results': list(results(cl))}
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in results
  264\.             yield ResultList(None, items_for_result(cl, res, None))
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in __init__
  256\.         super(ResultList, self).__init__(*items)
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in items_for_result
  184\.             f, attr, value = lookup_field(field_name, result, cl.model_admin)
File "/Library/Python/2.7/site-packages/django/contrib/admin/util.py" in lookup_field
  258\.                 value = attr()
File "/Users/arnaud/Documents/truc/todo/models.py" in mark_done
  76\.         return "<a href='%s'>Done</a>" % reverse("todo.views.mark_done", args=[self.pk])
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in reverse
  496\.     return iri_to_uri(resolver._reverse_with_prefix(view, prefix, *args, **kwargs))
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in _reverse_with_prefix
  416\.                 "arguments '%s' not found." % (lookup_view_s, args, kwargs))

Exception Type: NoReverseMatch at /admin/todo/item/
Exception Value: Reverse for 'todo.views.mark_done' with arguments '(5,)' and keyword arguments '{}' not found. 
```

## urlresolvers.py 的 _reverse_with_prefix 中的本地变量：

```
candidate   u'/todo/mark_done/5/'
val 5
pattern 'todo/$mark_done/(\\d*)/$'
self    <RegexURLResolver 'truc.urls' (None:None) ^/>
args    (5,)
_prefix u'/'
m   'todo.views'
possibility [(u'todo/mark_done/%(_0)s/', [u'_0'])]
lookup_view_s   u'todo.views.mark_done'
possibilities   [([(u'todo/mark_done/%(_0)s/', [u'_0'])], 'todo/$mark_done/(\\d*)/$', {})]
lookup_view <function mark_done at 0x10da242a8>
prefix_norm u'/'
prefix_args []
params  [u'_0']
result  u'todo/mark_done/%(_0)s/'
defaults    {}
kwargs  {}
n   'mark_done'
unicode_args    [u'5'] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T00:45:59.580

这一行：

```
url(r'^todo/$', include('todo.urls')) 
```

您不想要终止符`$`，它会阻止包含工作。我不小心一直这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T00:47:50.577

您需要为您的 url 模式提供一个名称，如下所示：

```
urlpatterns = patterns('todo.views',
    url(r'^mark_done/(\d+)/$', 'mark_done', name='mark_done'),
) 
```

并从“todo”模式中删除结束模式`$`，这会导致它停止：

```
urlpatterns = patterns('',
    (r'^todo/', include('todo.urls')),
    (r'^admin/doc/', include('django.contrib.admindocs.urls')),
    (r'^admin/', include(admin.site.urls)),
) 
```

然后你可以使用反向，传入名称和参数：

```
def mark_done(self):
    return "<a href='{0}'>Done</a>".format(reverse("mark_done", args=(self.pk,)))
mark_done.allow_tags = True 
```

我假设您`mark_done`在代码示例中未显示的某处调用了一个视图函数。

# css - @font-face svg 在 Chrome 中无法正常工作？

> ID：15422770
> 
> 赞同：18
> 
> 时间：2013-03-15T00:39:14.453
> 
> 标签：css, google-chrome, svg, font-face, truetype

我对特定字体及其在 Chrome 中的呈现方式有疑问。

由于使用 ttf，Firefox 可以正确显示字体。

Chrome 不使用抗锯齿，字体太“尖锐”且丑陋。

这是我使用的 css 声明

```
@font-face {
    font-family: 'HelveticaNeueLT Std Thin';
    src: url(../fonts/h2.eot);
    src: url(../fonts/h2.svg#test) format('svg'),
         url(../fonts/h2.woff) format('woff'),
         url(../fonts/h2.ttf) format('truetype');
font-weight: normal;
font-style: normal;
} 
```

我得出的结论是，问题出在 svg 声明/字体文件上。如果我根本不使用散列标签并将其保留为仅 .svg，它会呈现抗锯齿但在不同的行高处，位置略有偏离。如果我添加 .svg#anything，它根本不会抗锯齿并且看起来很丑。

欢迎任何建议来帮助我解决这个相当烦人的问题。

PS：Windows 抗锯齿没问题，我对此进行了测试。我也只尝试了`@media screen and (-webkit-min-device-pixel-ratio:0)`svg 字体的声明，但没有成功。我意识到这可能是一个转贴，但在尝试了相关问题的所有解决方案后，我有点绝望。![在此处输入图像描述](../Images/90414b237a41a44ff42b77ecc2c8c20f.png)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-10-08T12:13:11.330

要使 webfonts 在 Windows 上的 Chrome 中以良好的抗锯齿呈现，您需要在字体声明中使用此格式：

```
@font-face {
    font-family: 'Futura';
    src: url('futura.eot');
    src: url('futura.eot?#iefix') format('embedded-opentype'),
         url('futura.woff') format('woff'),
         url('futura.ttf') format('truetype'),
         url('futura.svg#futura') format('svg');

    font-weight: normal;
    font-style: normal;
}

@media screen and (-webkit-min-device-pixel-ratio:0) {
    @font-face {
        font-family: 'Futura';
        src: url('futura.svg#futura') format('svg');
    }
} 
```

基本上，您需要强制 Chrome 使用 SVG 字体格式。您可以通过将 .svg 版本的 url 移到顶部来做到这一点，但是 Windows 上的 Chrome 在执行此操作时会出现布局混乱的问题（直到并包括版本 30）。通过使用媒体查询覆盖字体声明，这些问题得到解决。

另外：有时基线位置在 OpenType 字体和 SVG 字体之间不匹配，但您可以通过简单地编辑 SVG 字体文件来调整它。SVG 字体是基于 xml 的，如果你看一下声明

```
<font-face units-per-em="2048" ascent="1900" descent="-510" /> 
```

您可以更改 ascent 的值并使其与其他字体格式版本匹配。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-14T22:08:11.903

正如 Lily 和字体松鼠所建议的，你的 SVG 字体应该几乎总是在你的**源****列表的底部`@font-face`**。您不希望浏览器使用 SVG 字体，除非它不能使用其他任何字体。

造成这种情况的原因是**SVG 字体的支持非常差**，并且支持正在减少。截至本文 (2015)，[Chrome (38) 不再支持](https://www.chromestatus.com/feature/5930075908210688)SVG 字体，仅 Safari 8、iOS Safari 8.1 和 Android 浏览器 37 支持。[http://caniuse.com/#feat=svg-fonts](http://caniuse.com/#feat=svg-fonts)

**编辑：**截至 2016 年 2 月，Android 浏览器 47 不再支持 SVG 字体。Safari 和 iOS Safari 仍然支持它们，并且似乎是唯一支持它们的浏览器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-14T22:45:14.747

在 @font-face 中引用 SVG 文件时，文件路径中的 id (#) 指定 .svg 文件中的元素。要找到正确的 id，您可以在编辑器中打开它并检查`<font>`标签。

例如：

```
@font-face {
    font-family: 'latobold';
    src: url('../fonts/lato/lato-bold-webfont.eot');
    src: url('../fonts/lato/lato-bold-webfont.svg#latobold') format('svg'),
         url('../fonts/lato/lato-bold-webfont.eot?#iefix') format('embedded-opentype'),
         url('../fonts/lato/lato-bold-webfont.woff') format('woff'),
         url('../fonts/lato/lato-bold-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

涉及到：

`<font id="latobold" horiz-adv-x="1187" >`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-01T17:24:00.493

[Font Squirrel 的 webfont 生成器](http://www.fontsquirrel.com/tools/webfont-generator)是这样排列`@font-face`CSS 的：

```
@font-face {
    font-family: 'HelveticaNeueLT Std Thin';
    src: url('../fonts/h2.eot');
    src: url('../fonts/h2.eot?#iefix') format('embedded-opentype'),
         url('../fonts/h2.woff') format('woff'),
         url('../fonts/h2.ttf') format('truetype'),
         url('../fonts/h2.svg#h2') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

有关订单为何如此重要的更多信息：http: [//paulirish.com/2009/bulletproof-font-face-implementation-syntax/](http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/)

如果它仍然给您带来麻烦，请尝试使用上述生成器，选择专家选项，然后使用不同的设置（尤其是在渲染和 X 高度下）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-27T12:53:06.547

试试这个@font-face 实现

```
@font-face {
    font-family: 'OpenSans';
    src: url('fonts/OpenSans-Regular-webfont.eot');
    src: url('fonts/OpenSans-Regular-webfont.eot?#iefix') format('embedded-opentype'),
         url('fonts/OpenSans-Regular-webfont.woff') format('woff'),
         url('fonts/OpenSans-Regular-webfont.ttf') format('truetype'),
         url('fonts/OpenSans-Regular-webfont.svg#open_sansregular') format('svg');
    font-weight: normal;
    font-style: normal;
}

h1 {
  font-family: 'OpenSans';
  font-weight: 300%;
} 
```

有关更多信息，请查看此示例[https://github.com/ttibensky/BulletProof-font-face-implementation](https://github.com/ttibensky/BulletProof-font-face-implementation)

# c++ - 令人困惑的 (*this) 指针转换

> ID：15422774
> 
> 赞同：3
> 
> 时间：2013-03-15T00:39:25.887
> 
> 标签：c++, casting, ros

这是 Transform 类中 ROS（[链接](http://ros.org/rosdoclite/fuerte/api/tf/html/c++/classtf_1_1Transform.html)）中 Transform.h 的代码。

```
/**@brief Return the transform of the vector */
TFSIMD_FORCE_INLINE Vector3 operator*(const Vector3& x) const
{
    return (*this)(x);
} 
```

有人可以解释这段代码在做什么吗？这是我的想法（作为上下文，我有几年 C 程序员的经验，第一次用 C++ 开发。）

调用以下函数时调用该函数

```
object_of_type_Transform * object_of_type_Vector3 
```

然后它将 Vector3 对象转换为 Transform 对象并返回结果（我很不清楚这怎么可能，因为这两种类型似乎不兼容）。

但是返回的结果是 Vector3... 这就是我的心理模型崩溃的地方。

此外，该函数应该是基于 Transform 类转换 Vector3 点......所以我的理解肯定在某个地方存在缺陷。

我将不胜感激任何见解。

谢谢

编辑

谢谢回复！上面的函数是：

```
/**@brief Return the transform of the vector */
TFSIMD_FORCE_INLINE Vector3 operator()(const Vector3& x) const
{
    return Vector3(m_basis[0].dot(x) + m_origin.x(), 
    m_basis[1].dot(x) + m_origin.y(), 
    m_basis[2].dot(x) + m_origin.z());
}

/**@brief Return the transform of the vector */
TFSIMD_FORCE_INLINE Vector3 operator*(const Vector3& x) const
{
    return (*this)(x);
} 
```

我明白了，现在，发生了什么事。再次感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T00:42:01.630

> 然后它将 Vector3 对象转换为 Transform 对象并作为结果返回

没有。没有演员阵容；这：

```
return (*this)(x); 
```

相当于：

```
return this->operator()(x); 
```

在这两种情况下，代码都在调用`Transform::operator()`并传递`x`给它。第一个代码中的括号是必要的，因为在代码周围没有括号的情况下`()`绑定比`*`这样更强，`*this`这将等同于`return *(this(x));`- 编译错误。

顺便说一句，这是非常惯用的 C++ 代码，但我可以看到语法如何让 C 程序员感到困惑（毕竟，你不能重载运算符，更不用说`operator()`）。

# email - 确定用户是否来自电子邮件，如果是，则来自哪个客户端

> ID：15422776
> 
> 赞同：1
> 
> 时间：2013-03-15T00:39:55.687
> 
> 标签：email, ssl, https, referrer

在我收到垃圾评论说不应该这样做之前，我将它用作“很高兴拥有”，如果我错误地嗅探引荐来源，我会考虑让他们进入正确的页面。

无论如何，我有以下问题：

## 你能通过https（主要是gmail）嗅探吗？如果您自己也有 ssl，您是否能够从 https 域中获得推荐人？

## 当用户单击链接时，本地客户端（例如 Outlook 2013 和 Thunderbird）是否会提供引荐来源网址？

-引领

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:42:19.633

这是不可能的。Web 客户端（如 gmail.com 等）都是通过 HTTPS 完成的，它不发送引荐来源网址。专用客户端也不提供推荐人，因为他们只是告诉您的网络浏览器打开具有特定地址的新选项卡或窗口。

# sql - 如何将 2 列相乘？

> ID：15422777
> 
> 赞同：0
> 
> 时间：2013-03-15T00:40:06.590
> 
> 标签：sql, tsql, dataexplorer

我正在对[数据资源管理器](http://data.stackexchange.com)进行查询：

```
SELECT
  Name,
  COUNT(*) Qty,
  Points = CASE Name
    WHEN 'Altruist' THEN 5
    WHEN 'Analytical' THEN 5
    WHEN 'Announcer' THEN 5
    WHEN 'Autobiographer' THEN 5
    WHEN 'Benefactor' THEN 5
    WHEN 'Caucus' THEN 5
    WHEN 'Citizen Patrol' THEN 5
    WHEN 'Cleanup' THEN 5
    WHEN 'Commentator' THEN 5
    WHEN 'Critic' THEN 5
    WHEN 'Custodian' THEN 5
    WHEN 'Disciplined' THEN 5
    WHEN 'Editor' THEN 5
    WHEN 'Excavator' THEN 5
    WHEN 'Informed' THEN 5
    WHEN 'Investor' THEN 5
    WHEN 'Mortarboard' THEN 5
    WHEN 'Nice Answer' THEN 5
    WHEN 'Nice Question' THEN 5
    WHEN 'Organizer' THEN 5
    WHEN 'Peer Pressure' THEN 5
    WHEN 'Popular Question' THEN 5
    WHEN 'Precognitive' THEN 5
    WHEN 'Promotor' THEN 5
    WHEN 'Proofreader' THEN 5
    WHEN 'Quorum' THEN 5
    WHEN 'Revival' THEN 5
    WHEN 'Scholar' THEN 5
    WHEN 'Self-Learner' THEN 5
    WHEN 'Student' THEN 5
    WHEN 'Suffrage' THEN 5
    WHEN 'Supporter' THEN 5
    WHEN 'Synonymizer' THEN 5
    WHEN 'Tag Editor' THEN 5
    WHEN 'Talkative' THEN 5
    WHEN 'Teacher' THEN 5
    WHEN 'Tumbleweed' THEN 5
    WHEN 'Vox Populi' THEN 5
    WHEN 'Archaeologist' THEN 10
    WHEN 'Beta' THEN 10
    WHEN 'Booster' THEN 10
    WHEN 'Civic Duty' THEN 10
    WHEN 'Constituent' THEN 10
    WHEN 'Convention' THEN 10
    WHEN 'Deputy' THEN 10
    WHEN 'Enlightened' THEN 10
    WHEN 'Enthusiast' THEN 10
    WHEN 'Epic' THEN 10
    WHEN 'Favorite Question' THEN 10
    WHEN 'Generalist' THEN 10
    WHEN 'Good Answer' THEN 10
    WHEN 'Good Question' THEN 10
    WHEN 'Guru' THEN 10
    WHEN 'Necromancer' THEN 10
    WHEN 'Notable Question' THEN 10
    WHEN 'Outspoken' THEN 10
    WHEN 'Pundit' THEN 10
    WHEN 'Research Assistant' THEN 10
    WHEN 'Reviewer' THEN 10
    WHEN 'Sportsmanship' THEN 10
    WHEN 'Strunk & White' THEN 10
    WHEN 'Taxonomist' THEN 10
    WHEN 'Tenacious' THEN 10
    WHEN 'Yearling' THEN 10
    WHEN 'Copy Editor' THEN 20
    WHEN 'Electorate' THEN 20
    WHEN 'Famous Question' THEN 20
    WHEN 'Fanatic' THEN 20
    WHEN 'Great Answer' THEN 20
    WHEN 'Great Question' THEN 20
    WHEN 'Legendary' THEN 20
    WHEN 'Marshal' THEN 20
    WHEN 'Populist' THEN 20
    WHEN 'Publicist' THEN 20
    WHEN 'Reversal' THEN 20
    WHEN 'Stellar Question' THEN 20
    WHEN 'Steward' THEN 20
    WHEN 'Unsung Hero' THEN 20
    ELSE 0
  END,
  Qty * Points AS Total
FROM Badges
WHERE UserId = 1563422
GROUP BY Name
ORDER BY COUNT(*) DESC 
```

这一切都有效，除了何时`, Qty * Points AS Total`添加（从上面的查询中删除以成功[运行查询](https://data.stackexchange.com/stackoverflow/query/103329/top-users-with-the-most-weighted-badges)）。

我得到的错误是：

> 列名“ ”无效`Qty`。
> 
> 列名“ ”无效`Points`。

我怎样才能乘以`Qty`和`Points`作为`Total`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:42:46.243

使用子查询或像这样的*CTE*：

```
WITH CTE
AS
(
  SELECT
    Name,
    COUNT(*) Qty,
    Points = CASE Name
      WHEN 'Altruist' THEN 5
      WHEN 'Analytical' THEN 5
      WHEN 'Announcer' THEN 5
      WHEN 'Autobiographer' THEN 5
      WHEN 'Benefactor' THEN 5
      WHEN 'Caucus' THEN 5
      WHEN 'Citizen Patrol' THEN 5
      WHEN 'Cleanup' THEN 5
      WHEN 'Commentator' THEN 5
      WHEN 'Critic' THEN 5
      WHEN 'Custodian' THEN 5
      WHEN 'Disciplined' THEN 5
      WHEN 'Editor' THEN 5
      WHEN 'Excavator' THEN 5
      WHEN 'Informed' THEN 5
      WHEN 'Investor' THEN 5
      WHEN 'Mortarboard' THEN 5
      WHEN 'Nice Answer' THEN 5
      WHEN 'Nice Question' THEN 5
      WHEN 'Organizer' THEN 5
      WHEN 'Peer Pressure' THEN 5
      WHEN 'Popular Question' THEN 5
      WHEN 'Precognitive' THEN 5
      WHEN 'Promotor' THEN 5
      WHEN 'Proofreader' THEN 5
      WHEN 'Quorum' THEN 5
      WHEN 'Revival' THEN 5
      WHEN 'Scholar' THEN 5
      WHEN 'Self-Learner' THEN 5
      WHEN 'Student' THEN 5
      WHEN 'Suffrage' THEN 5
      WHEN 'Supporter' THEN 5
      WHEN 'Synonymizer' THEN 5
      WHEN 'Tag Editor' THEN 5
      WHEN 'Talkative' THEN 5
      WHEN 'Teacher' THEN 5
      WHEN 'Tumbleweed' THEN 5
      WHEN 'Vox Populi' THEN 5
      WHEN 'Archaeologist' THEN 10
      WHEN 'Beta' THEN 10
      WHEN 'Booster' THEN 10
      WHEN 'Civic Duty' THEN 10
      WHEN 'Constituent' THEN 10
      WHEN 'Convention' THEN 10
      WHEN 'Deputy' THEN 10
      WHEN 'Enlightened' THEN 10
      WHEN 'Enthusiast' THEN 10
      WHEN 'Epic' THEN 10
      WHEN 'Favorite Question' THEN 10
      WHEN 'Generalist' THEN 10
      WHEN 'Good Answer' THEN 10
      WHEN 'Good Question' THEN 10
      WHEN 'Guru' THEN 10
      WHEN 'Necromancer' THEN 10
      WHEN 'Notable Question' THEN 10
      WHEN 'Outspoken' THEN 10
      WHEN 'Pundit' THEN 10
      WHEN 'Research Assistant' THEN 10
      WHEN 'Reviewer' THEN 10
      WHEN 'Sportsmanship' THEN 10
      WHEN 'Strunk & White' THEN 10
      WHEN 'Taxonomist' THEN 10
      WHEN 'Tenacious' THEN 10
      WHEN 'Yearling' THEN 10
      WHEN 'Copy Editor' THEN 20
      WHEN 'Electorate' THEN 20
      WHEN 'Famous Question' THEN 20
      WHEN 'Fanatic' THEN 20
      WHEN 'Great Answer' THEN 20
      WHEN 'Great Question' THEN 20
      WHEN 'Legendary' THEN 20
      WHEN 'Marshal' THEN 20
      WHEN 'Populist' THEN 20
      WHEN 'Publicist' THEN 20
      WHEN 'Reversal' THEN 20
      WHEN 'Stellar Question' THEN 20
      WHEN 'Steward' THEN 20
      WHEN 'Unsung Hero' THEN 20
      ELSE 0
    END
  FROM Badges
  WHERE UserId = 1563422
  GROUP BY Name
  )
  SELECT *, QTY * Points AS Total
  FROM CTE; 
```

[**更新了数据资源管理器上的演示**](https://data.stackexchange.com/stackoverflow/query/103330/top-users-with-the-most-weighted-badges)

# regex - R获取子字符串和正则表达式？

> ID：15422778
> 
> 赞同：9
> 
> 时间：2013-03-15T00:40:12.427
> 
> 标签：regex, string, r

我有一组作为文件名的字符串。我想提取 # 符号之后但文件扩展名之前的所有字符。例如，其中一个文件名是：

```
HelloWorld#you.txt 
```

我想返回字符串`you`

这是我的代码：

```
 hashPos = grep("#", name, fixed=TRUE)
    dotPos = length(name)-3
    finalText = substring(name, hashPos, dotPos) 
```

我在网上读到`grep`应该返回第一个参数出现的索引（在这种情况下是 # 符号）。所以，我期待上述工作，但它没有。

或者我将如何使用正则表达式来提取这个字符串？另外，当字符串没有# 符号时会发生什么？该函数是否会返回一个特殊的值，例如 -1？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-15T00:47:07.997

这是一个单行解决方案

```
gsub(".*\\#(.*)\\..*", "\\1", c("HelloWorld#you.txt")) 
```

输出：

```
you 
```

为了解释代码，它将匹配所有内容`#`，然后提取所有*单词*字符`.`，因此最终输出将是您正在寻找的中间字符串。

**编辑**：

上述解决方案将文件名匹配到最后一个，`.`即允许文件名有多个点。如果要将名称提取到第一个名称，`.`则可以改用正则表达式`.*\\#(\\w*)\\..*`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-15T00:51:11.440

**strapplyc**要在`#`尝试使用[gsubfn](http://www.inside-r.org/packages/cran/gsubfn/docs/strapply)[包](http://gsubfn.googlecode.com)中的strapplyc 后立即提取单词：

```
> library(gsubfn)
>
> strapplyc("HelloWorld#you.txt", "#(\\w+)")[[1]]
[1] "you" 
```

或者这允许文件名包含点：

```
> strapplyc("HelloWorld#you.txt", "#(.*)\\.")[[1]]
[1] "you" 
```

**file_path_sans_ext** 使用工具包（与 R 捆绑在一起，因此不需要安装额外的包）的另一种更面向文件名的方法如下：

```
> library(tools)
>
> file_path_sans_ext(sub(".*#", "", "HelloWorld#you.txt")) 
[1] "you" 
```

添加：其他解决方案

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-15T00:49:17.023

您可以使用`gsub`. 这样做的好处是您可以匹配多个`.`s 直到最后一个。

```
> s <- 'HelloWorld#you.and.me.txt'
> gsub('.*#(.*)\\.+.*','\\1', s)
[1] "you.and.me" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-15T00:44:02.463

`grep`根据项目编号返回索引，而不是字符位置（HelloWorld#you.txt 只有一项，所以它应该返回 1）。

相反，您希望`regexpr`它计算字符而不是项目。

```
hashPos = regexpr("#", name, fixed=TRUE) + 1
dotPos = length(name)-3
finalText = substring(name, hashPos, dotPos) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-15T01:56:00.830

对于那些不想学习正则表达式但不符合发布者意图的人来说，这个解决方案很容易（对于未来的搜索者来说更多）。这种方法涵盖了您没有的情况，`#`因为函数将返回`character(0)`。

```
library(qdap)
x <- c("HelloWorld#you.txt", "HelloWorldyou.txt")
genXtract(x, "#", ".") 
```

产量：

```
> genXtract(x, "#", ".")
$`#  :  right1`
[1] "you"

$`#  :  right2`
character(0) 
```

虽然我认为标签中存在错误，但实际返回值没有。

**编辑：**这确实是一个已在开发版本中修复的错误。输出与发展。版本：

```
> genXtract(x, "#", ".")
$`#  :  .1`
[1] "you"

$`#  :  .2`
character(0) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-18T09:20:42.453

到目前为止，我不喜欢这里的大多数解决方案。他们要么使用过于复杂的正则表达式，要么使用额外的软件包，恕我直言，这是不必要的。我认为这里更重要，更可重用

```
# Function that finds a match and returns the matched string
getMatch = function(rexp, str) regmatches(str, regexpr(rexp, str))

filename = "HelloWorld#you.txt"

# The regexp here is simply the hash sign plus everything 
# following that is not a dot
getMatch("#[^.]*", filename) 
```

`#you`按原样返回（您可以`#`使用`substr`函数删除）。如果文件名不包含井号，则返回空字符串。

# c++ - c++ 具有相同类名的头文件

> ID：15422781
> 
> 赞同：0
> 
> 时间：2013-03-15T00:40:31.720
> 
> 标签：c++, header

我是一名工科学生，而不是一个非常强大的程序员。我的一项任务包括使用 openGL 创建一个 VR 程序。[我得到了一个广泛使用gmtl](http://ggt.sourceforge.net/)标头的模板（我真的不想重写）。该任务需要在模拟中实现一些[Sixense](http://sixense.com/developers)位置跟踪器硬件，但是，sixense 硬件和 gmtl 的标头都有许多具有相同名称的类（Plane、Line 等）。我可以做些什么来使用不涉及大量代码和重命名的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:02:47.710

正如评论者所说，它们位于不同的命名空间中，所以只要您完全限定命名空间，它们应该没问题，这也是一种很好的做法：

```
namespace foo { int value; }
namespace bar { int value; }

int main()
{
    foo::value = 1;
    bar::value = 2;
    return 0;
} 
```

`using namespace`如果你鲁莽使用，你只会遇到麻烦：

```
namespace foo { int value; }
namespace bar { int value; }

using namespace foo;
using namespace bar;

int main()
{
    value = 1; // which value is this???
    return 0;
} 
```

在实践中，如果你有结构良好的模块化代码，在同一个源文件中使用两个同名的类是非常罕见的，而且通常这些类做同样的事情，这意味着你可以隔离“转换”源文件中的详细、完全限定的类型名称，并继续`using namespace`在您的其他源文件中使用。

# javascript - JQuery .each 为此给予 Object{}

> ID：15422784
> 
> 赞同：1
> 
> 时间：2013-03-15T00:40:49.817
> 
> 标签：javascript, jquery, jquery-ui

我刚刚遇到了一个困扰我一段时间的问题，当我搜索时我没有看到一个 SO 问题，所以我将把它贴在这里以帮助那些做同样事情的人（真的很愚蠢但很难见）错误。如果一个小时内没有人得到它，我会发布答案。

我的错误是什么？

```
 $('.myEndDate').each(new function (index) {
    $(this).datepicker(
      {
        changeMonth: true,
        numberOfMonths: 1,
        onClose: function (selectedDate) {
          $('.myStartDate').datepicker("option", "maxDate", selectedDate);
        }
      });
  }); 
```

结果是 Firefox 从缩小的 jqueryUI javascript 内部抛出了这个可爱的错误：

```
TypeError: e.nodeName is undefined
http://localhost:8080/MyUI/scripts/jquery-ui-1.10.2.custom.min.js Line
1322 
```

当我在萤火虫中调试时，似乎`this`是

```
this    Object {} 
```

有可能我是唯一一个找不到这个错误的人，这就是为什么我没有找到问题的原因。以防万一其他人有类似的大脑放屁，也许我可以为他们节省一些时间:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T01:09:14.600

错误在于，通过`new`在函数声明之前包含关键字，您实际上是在将一个空对象作为参数传递给 jQuery，`each`而不是在每次迭代时回调它的函数。正如您所指出的，结果是`this`指空对象，因此您用于实例化 jQuery UI datePicker 的选择器不会返回导致您在控制台中看到的错误的 DOM 节点。

请参阅[此 stackoverflow 线程](https://stackoverflow.com/questions/2274695/new-function-with-lower-case-f-in-javascript)，它解释了您错误使用的构造是在 JavaScript 中创建新对象的完全有效的方法，在这种情况下它对您没有任何用处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:51:16.573

您不需要使用每个只需使用日期选择器的选择器

```
$('.myEndDate').datepicker(
  {
    changeMonth: true,
    numberOfMonths: 1,
    onClose: function (selectedDate) {
      $('.myStartDate').datepicker("option", "maxDate", selectedDate);
    }
  }); 
```

并且在使用时`each`你不需要说`new function`

我希望这可以帮助:)

# erlang - erlang 中是否有任何库或函数可以生成术语或字符串的哈希码？

> ID：15422786
> 
> 赞同：2
> 
> 时间：2013-03-15T00:41:00.887
> 
> 标签：erlang

在 Java 中，您可以为字符串生成整数哈希码，例如：

```
Java:
int hc = "My Phrase".hashCode(); 
```

是否有任何库能够生成字符串散列甚至更好的术语散列？

我要解决的问题是我想缓存从另一个系统生成的术语。该术语将被字符串化并与哈希码一起传输，该哈希码将用于未来的比较，以确定术语/字符串是否已更改。我没有为此目的使用时间戳。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T00:54:20.557

[`erlang:phash/2`](http://erlang.org/doc/man/erlang.html#phash-2)或者怎么样[`erlang:phash2/1`](http://erlang.org/doc/man/erlang.html#phash2-1)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:51:25.637

对于加密哈希，您可以使用 SHA 系列查看此人的代码：

[http://steve.vinoski.net/blog/2009/01/03/more-sha-in-erlang/](http://steve.vinoski.net/blog/2009/01/03/more-sha-in-erlang/)

您还可以查看记录 ( [http://20bits.com/article/erlang-an-introduction-to-records](http://20bits.com/article/erlang-an-introduction-to-records) )，因为如果这是您的目标，它们将允许您创建关联数组功能来开始创建哈希图。

但是，根据您的需要，最好的解决方案是查看此 pdf 中的散列和散列图。

[http://www.erlang-factory.com/upload/presentations/468/EUC_Hashes2011.pdf](http://www.erlang-factory.com/upload/presentations/468/EUC_Hashes2011.pdf)

对于创建自己的不可变哈希库的简单示例，您可以查看

[http://www.trapexit.org/Hash_with_Immutable_Keys_or_Values](http://www.trapexit.org/Hash_with_Immutable_Keys_or_Values)

如果您能解释为什么需要哈希值，那将会很有帮助。你想解决什么问题？

# php - Laravel - 第一次设置路由器

> ID：15422790
> 
> 赞同：1
> 
> 时间：2013-03-15T00:41:21.583
> 
> 标签：php, laravel

我设置了我的第一个 Laravel 项目，我遇到了第一个麻烦。

路由器.php：

```
Route::get('/', function()
{
    return View::make('home.index');
});

Route::any('home', function ()
{
    return View::make('home.index');
}); 
```

当我访问时，`http://localhost/laravel/public/home`我得到一个“未找到”错误，即使简单的`http://localhost/laravel/public/`工作正常。我究竟做错了什么？mod_rewrite 已启用并且`'index' => ''`.

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T17:11:22.207

在`application/config/application.php`中，尝试将您的索引 url 更改为`http://localhost/laravel/public/`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T20:24:01.867

发现错误！我的 VirtualHost 有`AllowOverride None`. 我将其更改为`AllowOverride All`并已修复

# c# - Integrated Security=SSPI 是否需要管理员组中的 Windows 用户？

> ID：15422791
> 
> 赞同：2
> 
> 时间：2013-03-15T00:41:28.747
> 
> 标签：c#, sql-server-2008

我在使用普通用户和 sql express 数据库测试我的 c# WinForms 应用程序时遇到问题。我认为连接字符串中的 SSPI 是问题所在。

编辑：问题是连接不会打开。这是我以普通用户身份登录时遇到的异常（我没有以管理员身份正确打开它）。

> 用户“AsusWin7-64\SomeUser”登录失败。在 System.Data.SqlClient.SqlInternalConnection.OnError（SqlException 异常，布尔型 breakConnection） 在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() 在 System.Data.SqlClient.TdsParser.Run（RunBehavior runBehavior，SqlCommand cmdHandler，SqlDataReader dataStream，BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) 在 System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK) 在 System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, SqlConnection owningObject) 在 System.Data。 SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance,

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:44:47.027

标题中提出的问题的答案是否定的，SSPI 不需要管理员组中的 Windows 用户。您遇到的故障/错误的确切性质是什么？

**编辑：**您需要确保您的 SQL Express 数据库配置为接受 Windows 集成身份验证，然后将该本地计算机用户定义到具有相应数据库、表和程序。

# wordpress - 我是否需要使用 Wordpress 手动编码强制图像下载？

> ID：15422793
> 
> 赞同：0
> 
> 时间：2013-03-15T00:41:53.533
> 
> 标签：wordpress

我想让用户在点击缩略图时能够下载我的设计的高分辨率图像。只需左键单击。

问题：这可能使用 Wordpress 插件吗？还是我需要编写[自己的版本](https://stackoverflow.com/questions/11090272/how-can-i-force-a-image-download)才能做到这一点？我可以只修改一个像colorbox这样的插件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T05:19:29.413

可以通过使用插件：

[http://wordpress.org/extend/plugins/download-shortcode/](http://wordpress.org/extend/plugins/download-shortcode/)

我在这里为您提供帮助，因为我在我的网站上使用了相同的功能（强制下载帖子附件）

# python - 在 OS X 上使用 python 导入 gtk 时出错

> ID：15422800
> 
> 赞同：0
> 
> 时间：2013-03-15T00:42:21.763
> 
> 标签：python, gtk, pygtk, homebrew

我刚刚通过 Homebrew（很棒的工具）及其依赖项（包括 gtk+）安装了 pygtk；问题是当我尝试在 python 解释器上导入 gtk 时，它会抛出一个 ImportError，在将 pygtk 或任何其他模块导入解释器时不会发生这种情况，我不知道出了什么问题。:S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:04:51.383

在OP澄清之后，原始答案没有描述他的问题......虽然我认为它是相关的，它可能会帮助其他人，所以我会离开它。但首先，相关部分。

在您可以之前`import gtk`，您需要调用`pygtk.require`，如教程的[入门](http://www.pygtk.org/pygtk2tutorial/ch-GettingStarted.html)部分所示。（有关更多详细信息，请参阅[PyGTK 常见问题解答](http://faq.pygtk.org/index.py?req=show&file=faq02.006.htp)。）

那应该可以解决您的问题……但是您只是在崩溃`Fatal Python error: PyThreadState_Get: no current thread`. 有很多原因可以得到这个，但在这种情况下，最有可能的是你正在运行一个 C 扩展（`pygtk`// `gtk`whatever），它是为一个版本的 Python 针对不同版本的 Python 而构建的。（这实际上也[包含在 PyGTK FAQ](http://faq.pygtk.org/index.py?req=show&file=faq01.010.htp)中，但在这种情况下，它是 CPython C 扩展模块的一个更普遍的问题，而不是 PyGTK 特定的问题。）

如果你有多个 Python 2.7 版本（如果你有 2.7.3，你肯定有两个，因为 Apple 是 2.7.2），你必须弄清楚你有哪些，以及你曾经构建的那个`pygtk`，并制作确保你从同一个使用它。

这使我们回到了我留在下面的原始答案。

* * *

出现此问题的原因有两个。

* * *

首先，如果除了 OS X 附带的 Python 版本之外，您还没有安装任何额外的 Python 版本，那么您可能没有阅读安装时`brew`打印出来的说明`pygtk`或信息等：

例如：

```
$ brew info pygtk
pygtk: stable 2.24.0
...
==> Caveats
For non-Homebrew Python, you need to amend your PYTHONPATH like so:
  export PYTHONPATH=/usr/local/lib/python2.7/site-packages:$PYTHONPATH 
```

Homebrew 将 Python 包安装到 /usr/local/lib/pythonX.Y 中——即使它是为 Apple 的 Python 安装而安装的。但是 Apple 的 Python 安装默认不会在那里寻找包。所以，你需要按照上面所说的去做。

只需在终端上键入此行即可用于该终端会话的其余部分。如果你想让它永久化……嗯，有很多选择，具体取决于你想要什么。有关详细信息，请参阅[此答案](https://stackoverflow.com/questions/603785/environment-variables-in-mac-os-x/4567308#4567308)。

[这在Gems、Eggs 和 Perl 模块](https://github.com/mxcl/homebrew/wiki/Gems,-Eggs-and-Perl-Modules)以及[Homebrew 和 Python](https://github.com/mxcl/homebrew/wiki/Homebrew-and-Python)中有更详细的解释。

（这是 Homebrew 通常建议`pip`尽可能使用而不是在`brew`.

* * *

其次，如果您安装了 Homebrew 的 Python，您可能没有正确设置 PATH，因此您将包安装到 Homebrew Python 的站点包中，然后运行 ​​Apple Python 安装。

如果您只是在打字`python`并且不知道您在运行哪一个，`which python`应该告诉您。如果`/usr/bin/python`是苹果的；如果是`/usr/local/bin/python`，那就是 Homebrew 的。

您也可以从 Python 启动横幅中看出，因为 Mountain Lion 附带 2.7.2，而 Homebrew 将安装 2.7.3。（此外，IIRC，Apple 使用预发布 clang 来构建他们的 Python，而您使用 Homebrew 构建的任何东西都将使用您拥有的任何 clang/gcc/llvm-gcc 构建，这不会是预发布版本......）

**注意：仅仅因为您在横幅的某处看到“Apple”一词并不意味着它是 Apple 的 Python！**如果你构建一个 Homebrew Python，或者安装一个 python.org Python，它几乎肯定会使用 Apple GCC、Apple Clang 或 Apple LLVM-GCC 构建。它也在 Apple 操作系统上运行。*因此，“Apple”或“apple”将在任何*Python的横幅中最多出现 3 次，无论是否为 Apple。

解决此问题的方法是运行您要运行的 Python。例如：

*   用于`virtualenv`基于一个或两个安装创建一个或多个虚拟环境，并使用 venv 工具进行选择。
*   始终使用完整路径——例如，键入`/usr/local/bin/python`运行 Homebrew 的 Python，`/usr/bin/python`运行 Apple 的。（并修改任何脚本中的 shebang 行以执行相同的操作。）
*   更改您的`PATH`变量以确保您想要的第一个出现在第一位。对于 Homebrew，您需要 /usr/local/Cellar/python/2.7.3/bin（仅适用于 Python）或 /usr/local/bin（适用于所有内容）在 /usr/bin 之前；对于苹果来说，反过来。
*   将 Python 框架 bin 目录添加到 PATH，这样您就可以将它们的顺序与通用二进制文件分开操作。（这与 Homebrew Python 并不真正相关，因为 Cellar 目录具有相同的目的。但它对于其他第三方 Python 安装很有用。）

所有这些都适用于其他工具。许多人遇到麻烦，例如，一个安装`pip`或`idle`在路径中排在第一位，而另一个安装`python`则...</p>

* * *

If you've installed a *different* Python, e.g., by using the installers from python.org, you could easily have *both* of the above problems. For example, you could be installing stuff for python.org Python, but running Apple Python, and on top of that, neither one may be configured to look in the Homebrew site-packages directory.

# php - 缩放图片

> ID：15422802
> 
> 赞同：1
> 
> 时间：2013-03-15T00:42:39.507
> 
> 标签：php, mysql, image

我在 350px x 350px 大的 div 中显示图片。人们可以将图片上传到我的文件服务器，并在数据库中创建指向该图片的目标链接以及一个 ID。获取链接的 php 文档位于根文件夹中，所有图片都保存在名为 Pictures 的子文件夹中。我使用这样的东西显示图片：

```
$piclink = "SELECT `link` FROM `pictures` WHERE `id=`.$id.`"; 
```

`$id`单击上一页中的链接时会存储该变量。

**我的问题：**并非所有图片的格式都相同。我想显示它们，使*最大*尺寸为 350px，另一个尺寸根据比例。我该怎么做呢？只需这样做：

```
echo "<img href=" . $piclink . " height='350px' width='350px'/>" 
```

会将图片拉伸到 350x350，从而破坏比例。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:45:02.130

要保留纵横比，您可以检索图像尺寸并使用 350 像素的最大值应用该比率。

这是一个例子：

**HTML**

```
<div id="img-holder"></div> 
```

**代码**

```
var img = new Image();
img.onload = function () {
    alert('Orignal width:'+img.width+', height:'+img.height);
    var width, height;
    if (img.width > img.height) {
        width = (img.width > 350 ? 350 : img.width);
        height = img.height * (350 / img.width);
    } else {
        height = (img.height > 350 ? 350 : img.height);
        width = img.width * (350 / img.height);
    }
    img.width=width;
    img.height=height;
    $("#img-holder").append(img);
}
img.src = "http://mps.thebeautyquotient.com/images/val4a.jpeg" 
```

这是 jsfiddle：http: [//jsfiddle.net/aN6Ec/](http://jsfiddle.net/aN6Ec/)

# sqlite - 异步 SQLite 计时的问题

> ID：15422807
> 
> 赞同：0
> 
> 时间：2013-03-15T00:42:50.997
> 
> 标签：sqlite, asynchronous, windows-phone-8

原谅我的无知，但我是异步编程的新手，我似乎无法弄清楚这一点。

我有一个包含许多 SQLite 操作的 Windows Phone 8 应用程序。

我遇到了一些问题，有时会在数据库中设置一个值，但显然没有及时设置它被检索到的时间。但这并不会始终如一地发生，这就是为什么我想知道这是否是线程问题。

我有一种插入记录的方法，如下所示：

```
public async Task<string> getSetting(Settings setting)
    {
        string returnString = "";
        string setName = setting.getName();

        try
        {
            SQLiteAsyncConnection conn = new SQLiteAsyncConnection(Path.Combine(ApplicationData.Current.LocalFolder.Path, "newDatabase"), true);
            var query = conn.Table<ClientSettings>().Where(x => x.ID == setName);
            var result = await query.ToListAsync().ConfigureAwait(false);

            foreach (var item in result)
            {

                returnString = item.Value;
            }
        }
        catch (Exception e)
        {
            System.Diagnostics.Debug.WriteLine("\nERROR: " + e);

        }
        return ret;
    } 
```

我还有一种检索这些的方法：

```
public async Task<string> getSetting(Settings setting)
    {
        string returnString = "";
        string setName = setting.getName();

        try
        {
            SQLiteAsyncConnection conn = new SQLiteAsyncConnection(Path.Combine(ApplicationData.Current.LocalFolder.Path, "newDatabase"), true);
            var query = conn.Table<MySettings>().Where(x => x.ID == setName);
            var result = await query.ToListAsync().ConfigureAwait(false);

            foreach (var item in result)
            {
                returnString = item.Value;
            }
        }
        catch (Exception e)
        {
            System.Diagnostics.Debug.WriteLine("\nERROR: " + e);

        }
        return returnString;
    } 
```

如果我在主页中这样称呼它：

```
var insert = Constants.getData().setSetting(ExampleSetting, "userIDtest", false).Result;
string retrieving = Constants.getData().getSetting(ExampleSetting).Result; 
```

它工作正常，“检索”下一行的控制台打印是正确的值。但是，在许多其他场景中——如果 setSetting 没有返回值而是为 void，则设置似乎没有及时设置，getSetting 也没有返回设置的值。

此外，在应用程序的一部分中，会提示用户输入一些信息，然后将其设置到数据库中并立即在 xml web 服务中使用。尽管代码看起来与上面完全一样，但这似乎永远不会及时设置。

这是这样做的正确方法吗？有没有更好的方法来设置 SQLite 记录，以确保它们被设置，而不锁定 UI 线程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T00:47:18.800

您应该使用`await`而不是`Task.Result`：

```
var insert = await Constants.getData().setSetting(ExampleSetting, "userIDtest", false);
string retrieving = await Constants.getData().getSetting(ExampleSetting); 
```

上面的代码将等待您的 db 调用完成，但不会阻塞 UI。请注意，这在控制台应用程序中不起作用 - 它仅适用于 GUI 应用程序。

除此之外，您的`getSetting`代码看起来还不错。我无法评论，`setSetting`因为它没有在您的问题中显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:20:18.523

> 如果 setSetting 不返回值而是 void

如果`setSetting`返回`void`，则您无法知道`async`操作何时完成。一个`async`方法*永远不*应该返回`void`（除非它是一个事件处理程序）。

如果您不想从`async`方法返回值，请将方法返回值设为 a `Task`。这样，您仍然可以在继续之前`await`确保返回的任务完成。`setSetting`

# iphone - 继续添加到 NSMutable 数组

> ID：15422811
> 
> 赞同：0
> 
> 时间：2013-03-15T00:43:26.857
> 
> 标签：iphone, ios, objective-c, nsmutablearray

我对 Objective-C 很陌生，并试图创建一个带有表格视图的待办事项列表应用程序。当按下按钮时，我试图继续向我的可变数组添加字符串。但是每次我按下按钮时，只有最后一个字符串被添加到数组中。

```
- (IBAction)notebutton:(UIButton *)sender {

   NSMutableArray *mystr = [[NSMutableArray alloc] init];
   NSString *name = _noteField.text;
   [mystr addObject:name];
   [self.tableView reloadData];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T00:44:46.970

不要`NSMutableArray`每次都声明。只声明一次。

将其设为`NSMutableArray *mystr;`属性并`viewDidLoad()`一次性分配。

在**.h**或**.m**文件中

```
@property(nonatomic,strong) NSMutableArray *mystr; 
```

**viewDidLoad()**

```
self.mystr = [[NSMutableArray alloc] init];

- (IBAction)notebutton:(UIButton *)sender {

   NSString *name = _noteField.text;
   [self.mystr addObject:name];
   [self.tableView reloadData];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T03:38:21.973

您正在方法上创建可变数组。所以每次它分配和制作新数组。

只需在 viewdidload/viewdidappear 中分配 nsmutable 数组并在您的方法中添加对象。

# razor - @Code 的 Razor 语法简写

> ID：15422818
> 
> 赞同：1
> 
> 时间：2013-03-15T00:44:31.167
> 
> 标签：razor, razor-2

是否有 VB Razor (.vbhtml) 语法的简写`@Code ... End Code`，
例如 C# `@{ }`？

这将适用于 MVC 4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:31:58.353

不，C# 版本看起来更短的原因是 C# 通常比 VB 更简洁，并且大括号`{ }`是其语法的一部分。

大多数打开代码完成选项的 IDE 都可以为您省去打字的麻烦`End Code`，但如果您真的想要“更短”，最好的答案是学习/使用 C#。

# maven - 在 Tomcat 中部署 Maven 项目

> ID：15422819
> 
> 赞同：2
> 
> 时间：2013-03-15T00:44:33.610
> 
> 标签：maven, tomcat, pom.xml

当我不想用 tomcat 部署我的 maven 项目时，我遇到了问题。我只得到一个 404。当我用码头尝试它时，它工作正常。

我认为 pom.xml 有问题

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.shoot.tail</groupId>
<artifactId>shootout</artifactId>
<packaging>war</packaging>
<version>1.2</version>
<name>Shootout</name>

<repositories>
    <repository>
        <id>java.net</id>
        <url>https://maven.java.net/content/repositories/releases</url>
    </repository>
</repositories>

<properties>
    <myfaces.version>2.1.8</myfaces.version>
    <mojarra.version>2.1.11</mojarra.version>
    <jetty.version>8.1.5.v20120716</jetty.version>
    <tomcat.version>7.0.12</tomcat.version>
</properties>

<profiles>
    <profile>
        <id>mojarra</id>
        <activation>
            <activeByDefault>false</activeByDefault>
        </activation>
        <dependencies>
            <dependency>
                <groupId>com.sun.faces</groupId>
                <artifactId>jsf-api</artifactId>
                <version>${mojarra.version}</version>
                <scope>compile</scope>
            </dependency>
            <dependency>
                <groupId>com.sun.faces</groupId>
                <artifactId>jsf-impl</artifactId>
                <version>${mojarra.version}</version>
                <scope>compile</scope>
            </dependency>
            <dependency>
                <groupId>org.apache.tomcat</groupId>
                <artifactId>jdbc-pool</artifactId>
                <version>${jdbc-pool.version}</version>
                <scope>system</scope>
                <systemPath>${basedir}/../${web.project}/WebContent/WEB-INF/lib/tomcat-jdbc.jar</systemPath>
            </dependency>
            <dependency>
                <groupId>org.apache.tomcat</groupId>
                <artifactId>juli</artifactId>
                <version>${tomcat.version}</version>
            </dependency>
        </dependencies>
        <properties>
            <override-web-xml>src/main/jetty/override-mojarra-web.xml</override-web-xml>
        </properties>
    </profile>
    <profile>
        <id>myfaces</id>
        <activation>
            <activeByDefault>true</activeByDefault>
        </activation>
        <dependencies>
            <dependency>
                <groupId>org.apache.myfaces.core</groupId>
                <artifactId>myfaces-api</artifactId>
                <version>${myfaces.version}</version>
                <scope>compile</scope>
            </dependency>
            <dependency>
                <groupId>org.apache.myfaces.core</groupId>
                <artifactId>myfaces-impl</artifactId>
                <version>${myfaces.version}</version>
                <scope>compile</scope>
            </dependency>
        </dependencies>
        <properties>
            <override-web-xml>src/main/jetty/override-myfaces-web.xml</override-web-xml>
        </properties>
    </profile>
</profiles>

<!-- Project dependencies -->
<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.0</version>
        <scope>test</scope>
    </dependency>

    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.14</version>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>org.apache.geronimo.specs</groupId>
        <artifactId>geronimo-servlet_3.0_spec</artifactId>
        <version>1.0</version>
        <scope>provided</scope>
    </dependency>

</dependencies>

<build>
    <finalName>shootout</finalName>
    <defaultGoal>install</defaultGoal>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>tomcat-maven-plugin</artifactId>
            <version>${tomcat.version}</version>
            <configuration>
                 <webAppConfig>
                    <contextPath>/${project.artifactId}</contextPath>
                    <overrideDescriptor>${override-web-xml}</overrideDescriptor>
                </webAppConfig>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>jetty-maven-plugin</artifactId>
            <version>${jetty.version}</version>
            <configuration>
                <webAppConfig>
                    <contextPath>/${project.artifactId}</contextPath>
                    <overrideDescriptor>${override-web-xml}</overrideDescriptor>
                </webAppConfig>
            </configuration>
        </plugin>
    </plugins>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-eclipse-plugin</artifactId>
                <version>2.9</version>
                <configuration>
                    <wtpversion>2.0</wtpversion>
                    <downloadSources>true</downloadSources>
                    <additionalProjectFacets>
                        <jst.jsf>2.0</jst.jsf>
                    </additionalProjectFacets>
                </configuration>
            </plugin>
            <plugin>
              <groupId>org.apache.tomcat.maven</groupId>
              <artifactId>tomcat7-maven-plugin</artifactId>
              <version>2.1</version>
            </plugin>
        </plugins>
    </pluginManagement>
</build>
</project> 
```

版本 Eclipse：Juno Tomcat：7.0.12 Maven：3.0.5

和错误：

```
 [ERROR] Plugin org.codehaus.mojo:tomcat-maven-plugin:7.0.12 or one of its depend
encies could not be resolved: Failed to read artifact descriptor for org.codehau
s.mojo:tomcat-maven-plugin:jar:7.0.12: Failure to find org.codehaus.mojo:tomcat-
maven-plugin:pom:7.0.12 in http://repo.maven.apache.org/maven2 was cached in the
 local repository, resolution will not be reattempted until the update interval
of central has elapsed or updates are forced -> [Help 1]
org.apache.maven.plugin.PluginResolutionException: Plugin org.codehaus.mojo:tomc
at-maven-plugin:7.0.12 or one of its dependencies could not be resolved: Failed
to read artifact descriptor for org.codehaus.mojo:tomcat-maven-plugin:jar:7.0.12

        at org.apache.maven.plugin.internal.DefaultPluginDependenciesResolver.re
solve(DefaultPluginDependenciesResolver.java:129)
        at org.apache.maven.plugin.internal.DefaultMavenPluginManager.getPluginD
escriptor(DefaultMavenPluginManager.java:142)
        at org.apache.maven.plugin.internal.DefaultMavenPluginManager.getMojoDes
criptor(DefaultMavenPluginManager.java:261)
        at org.apache.maven.plugin.DefaultBuildPluginManager.getMojoDescriptor(D
efaultBuildPluginManager.java:185)
        at org.apache.maven.lifecycle.internal.MojoDescriptorCreator.getMojoDesc
riptor(MojoDescriptorCreator.java:235)
        at org.apache.maven.lifecycle.internal.DefaultLifecycleTaskSegmentCalcul
ator.calculateTaskSegments(DefaultLifecycleTaskSegmentCalculator.java:106)
        at org.apache.maven.lifecycle.internal.DefaultLifecycleTaskSegmentCalcul
ator.calculateTaskSegments(DefaultLifecycleTaskSegmentCalculator.java:86)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(Lifecycl
eStarter.java:98)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Laun
cher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.jav
a:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(La
uncher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:
352)
Caused by: org.sonatype.aether.resolution.ArtifactDescriptorException: Failed to
 read artifact descriptor for org.codehaus.mojo:tomcat-maven-plugin:jar:7.0.12
        at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.
loadPom(DefaultArtifactDescriptorReader.java:296)
        at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.
readArtifactDescriptor(DefaultArtifactDescriptorReader.java:186)
        at org.sonatype.aether.impl.internal.DefaultRepositorySystem.readArtifac
tDescriptor(DefaultRepositorySystem.java:279)
        at org.apache.maven.plugin.internal.DefaultPluginDependenciesResolver.re
solve(DefaultPluginDependenciesResolver.java:115)
        ... 20 more
Caused by: org.sonatype.aether.resolution.ArtifactResolutionException: Failure t
o find org.codehaus.mojo:tomcat-maven-plugin:pom:7.0.12 in http://repo.maven.apa
che.org/maven2 was cached in the local repository, resolution will not be reatte
mpted until the update interval of central has elapsed or updates are forced
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolve(Def
aultArtifactResolver.java:538)
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArti
facts(DefaultArtifactResolver.java:216)
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolveArti
fact(DefaultArtifactResolver.java:193)
        at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.
loadPom(DefaultArtifactDescriptorReader.java:281)
        ... 23 more
Caused by: org.sonatype.aether.transfer.ArtifactNotFoundException: Failure to fi
nd org.codehaus.mojo:tomcat-maven-plugin:pom:7.0.12 in http://repo.maven.apache.
org/maven2 was cached in the local repository, resolution will not be reattempte
d until the update interval of central has elapsed or updates are forced
        at org.sonatype.aether.impl.internal.DefaultUpdateCheckManager.newExcept
ion(DefaultUpdateCheckManager.java:230)
        at org.sonatype.aether.impl.internal.DefaultUpdateCheckManager.checkArti
fact(DefaultUpdateCheckManager.java:204)
        at org.sonatype.aether.impl.internal.DefaultArtifactResolver.resolve(Def
aultArtifactResolver.java:427)
        ... 26 more
[ERROR]
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please rea
d the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginResoluti
onException 
```

非常感谢你的帮助。最好的祝愿罗伯特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T12:20:51.183

解决了。

这是我最后的 pom.xml：

```
[...]
     <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>tomcat-maven-plugin</artifactId>
      <configuration>
         <server>tomcat</server>  
         <url>http://localhost:8080/manager/text</url>  
      </configuration>
     </plugin>
[...] 
```

感谢guido的帮助（：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-26T14:52:58.137

这有效：

[https://stackoverflow.com/a/16592276/503601](https://stackoverflow.com/a/16592276/503601)

插件中有一个错误。此插件不读取标签网址。

```
<configuration>
    <url>http://localhost:8080/manager/html</url>
</configuration> 
```

设置属性使用

```
<properties>
   <maven.tomcat.url>http://localhost:8080/manager/text</maven.tomcat.url>
</properties> 
```

全文在 [http://jvm-java.blogspot.com.es/2013/06/publish-with-maven-in-tomcat7.html](http://jvm-java.blogspot.com.es/2013/06/publish-with-maven-in-tomcat7.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T09:43:34.767

是的，看起来更好。

我认为它尝试部署项目，但构建失败。

```
[INFO] Error stacktraces are turned on.
[WARNING]
[WARNING] Some problems were encountered while building the effective settings
[WARNING] Unrecognised tag: 'id' (position: START_TAG seen ...<servers>\n  \t<id
>... @112:8)  @ C:\Software\maven\conf\settings.xml, line 112, column 8
[WARNING]
[INFO] Scanning for projects...
[WARNING] The POM for org.codehaus.mojo:tomcat7-maven-plugin:jar:2.0-SNAPSHOT is
 missing, no dependency information available
[WARNING] Failed to retrieve plugin descriptor for org.codehaus.mojo:tomcat7-mav
en-plugin:2.0-SNAPSHOT: Plugin org.codehaus.mojo:tomcat7-maven-plugin:2.0-SNAPSH
OT or one of its dependencies could not be resolved: Failed to read artifact des
criptor for org.codehaus.mojo:tomcat7-maven-plugin:jar:2.0-SNAPSHOT
Downloading: http://repository.apache.org/content/groups/snapshots-group/org/apa
che/maven/plugins/maven-metadata.xml
[WARNING] Could not transfer metadata org.apache.maven.plugins/maven-metadata.xm
l from/to apache.snapshots (http://repository.apache.org/content/groups/snapshot
s-group/): Failed to transfer file: http://repository.apache.org/content/groups/
snapshots-group/org/apache/maven/plugins/maven-metadata.xml. Return code is: 500
 , ReasonPhrase:Server Error.
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building Shootout 1.2
[INFO] ------------------------------------------------------------------------
[WARNING] The POM for org.codehaus.mojo:tomcat7-maven-plugin:jar:2.0-SNAPSHOT is
 missing, no dependency information available
[WARNING] Failed to retrieve plugin descriptor for org.codehaus.mojo:tomcat7-mav
en-plugin:2.0-SNAPSHOT: Plugin org.codehaus.mojo:tomcat7-maven-plugin:2.0-SNAPSH
OT or one of its dependencies could not be resolved: Failed to read artifact des
criptor for org.codehaus.mojo:tomcat7-maven-plugin:jar:2.0-SNAPSHOT
[WARNING] Failure to transfer org.apache.maven.plugins/maven-metadata.xml from h
ttp://repository.apache.org/content/groups/snapshots-group/ was cached in the lo
cal repository, resolution will not be reattempted until the update interval of
apache.snapshots has elapsed or updates are forced. Original error: Could not tr
ansfer metadata org.apache.maven.plugins/maven-metadata.xml from/to apache.snaps
hots (http://repository.apache.org/content/groups/snapshots-group/): Failed to t
ransfer file: http://repository.apache.org/content/groups/snapshots-group/org/ap
ache/maven/plugins/maven-metadata.xml. Return code is: 500 , ReasonPhrase:Server
 Error.
[INFO]
[INFO] >>> tomcat-maven-plugin:1.1:deploy (default-cli) @ shootout >>>
[INFO]
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ shootout -
--
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources,
i.e. build is platform dependent!
[INFO] Copying 1 resource
[INFO]
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ shootout ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-resources-plugin:2.5:testResources (default-testResources) @ sh
ootout ---
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources,
i.e. build is platform dependent!
[INFO] Copying 0 resource
[INFO]
[INFO] --- maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ shoot
out ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-surefire-plugin:2.10:test (default-test) @ shootout ---
[INFO] Surefire report directory: C:\Software\workspace\shootout\target\suref
ire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[INFO]
[INFO] --- maven-war-plugin:2.1.1:war (default-war) @ shootout ---
[INFO] Packaging webapp
[INFO] Assembling webapp [shootout] in [C:\Software\workspace\shootout\target
\shootout]
[INFO] Processing war project
[INFO] Copying webapp resources [C:\Software\workspace\shootout\src\main\weba
pp]
[INFO] Webapp assembled in [47 msecs]
[INFO] Building war: C:\Software\workspace\shootout\target\shootout.war
[WARNING] Warning: selected war files include a WEB-INF/web.xml which will be ig
nored
(webxml attribute is missing from war task, or ignoreWebxml attribute is specifi
ed as 'true')
[INFO]
[INFO] <<< tomcat-maven-plugin:1.1:deploy (default-cli) @ shootout <<<
[INFO]
[INFO] --- tomcat-maven-plugin:1.1:deploy (default-cli) @ shootout ---
[INFO] Deploying war to http://localhost:8080/shootout
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 3.682s
[INFO] Finished at: Fri Mar 15 10:21:19 CET 2013
[INFO] Final Memory: 10M/24M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy
(default-cli) on project shootout: Cannot invoke Tomcat manager: Connection refu
sed: connect -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal o
rg.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli) on project shootou
t: Cannot invoke Tomcat manager
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor
.java:217)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor
.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor
.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProje
ct(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProje
ct(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBu
ild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(Lifecycl
eStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.
java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Laun
cher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.jav
a:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(La
uncher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:
352)
Caused by: org.apache.maven.plugin.MojoExecutionException: Cannot invoke Tomcat
manager
        at org.codehaus.mojo.tomcat.AbstractCatalinaMojo.execute(AbstractCatalin
aMojo.java:149)
        at org.codehaus.mojo.tomcat.AbstractWarCatalinaMojo.execute(AbstractWarC
atalinaMojo.java:70)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(Default
BuildPluginManager.java:101)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor
.java:209)
        ... 19 more
Caused by: java.net.ConnectException: Connection refused: connect
        at java.net.DualStackPlainSocketImpl.connect0(Native Method)
        at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketI
mpl.java:69)
        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.ja
va:339)
        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocket
Impl.java:200)
        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java
:182)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
        at java.net.Socket.connect(Socket.java:579)
        at java.net.Socket.connect(Socket.java:528)
        at sun.net.NetworkClient.doConnect(NetworkClient.java:180)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:378)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:473)
        at sun.net.www.http.HttpClient.<init>(HttpClient.java:203)
        at sun.net.www.http.HttpClient.New(HttpClient.java:290)
        at sun.net.www.http.HttpClient.New(HttpClient.java:306)
        at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLC
onnection.java:995)
        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConne
ction.java:931)
        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection
.java:849)
        at org.codehaus.mojo.tomcat.TomcatManager.invoke(TomcatManager.java:597)

        at org.codehaus.mojo.tomcat.TomcatManager.deployImpl(TomcatManager.java:
662)
        at org.codehaus.mojo.tomcat.TomcatManager.deploy(TomcatManager.java:295)

        at org.codehaus.mojo.tomcat.AbstractDeployWarMojo.deployWar(AbstractDepl
oyWarMojo.java:85)
        at org.codehaus.mojo.tomcat.AbstractDeployMojo.invokeManager(AbstractDep
loyMojo.java:85)
        at org.codehaus.mojo.tomcat.AbstractCatalinaMojo.execute(AbstractCatalin
aMojo.java:141)
        ... 22 more
[ERROR]
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please rea
d the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionE
xception 
```

C:\Software\maven\conf\settings.xml：第 111-115 行

```
 <servers>
    <id>tomcat</id>
    <username>admin</username>
    <password>admin</password>
  </servers> 
```

pom.xml

```
 <repositories>
[...]
        <repository>
            <id>people.apache.snapshots</id>
            <url>http://repository.apache.org/content/groups/snapshots-group/</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
    </repositories>
[...]
    <pluginRepositories>
        <pluginRepository>
            <id>apache.snapshots</id>
            <name>Apache Snapshots</name>
            <url>http://repository.apache.org/content/groups/snapshots-group/</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </pluginRepository>
    </pluginRepositories>
[...]
    <build>
        <finalName>shootout</finalName>
        <defaultGoal>install</defaultGoal>
        <plugins>
            <plugin>
                <groupId>org.mortbay.jetty</groupId>
                <artifactId>jetty-maven-plugin</artifactId>
                <version>${jetty.version}</version>
                <configuration>
                    <webAppConfig>
                        <contextPath>/${project.artifactId}</contextPath>
                        <overrideDescriptor>${override-web-xml}</overrideDescriptor>
                    </webAppConfig>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>tomcat7-maven-plugin</artifactId>
                <version>2.0-SNAPSHOT</version>
                <configuration>
                    <url>http://localhost:8080/manager/html</url>
                    <server>tomcat</server>
                    <username>admin</username>
                    <password>admin</password>
                </configuration>
            </plugin>
        </plugins>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <configuration>
                        <source>1.6</source>
                        <target>1.6</target>
                        <encoding>UTF-8</encoding>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-eclipse-plugin</artifactId>
                    <version>2.9</version>
                    <configuration>
                        <wtpversion>2.0</wtpversion>
                        <downloadSources>true</downloadSources>
                        <additionalProjectFacets>
                            <jst.jsf>2.0</jst.jsf>
                        </additionalProjectFacets>
                    </configuration>
                </plugin>

            </plugins>
        </pluginManagement>
    </build> 
```

感谢您的帮助，并对问题数量感到抱歉。罗伯特

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T01:22:49.957

您指定的是 tomcat 版本而不是 tomcat-maven-plugin 版本，导致 maven 找不到插件（实际上阅读错误消息应该对您有所帮助）；这里：

```
<properties>
    <tomcat.version>7.0.12</tomcat.version>
</properties>
[...]
<build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>tomcat-maven-plugin</artifactId>
            <version>${tomcat.version}</version>
            [...] 
```

对 ${tomcat.version} 使用 1.2-SNAPSHOT（例如），或者如果在其他地方使用 tomcat 版本，则声明另一个变量。

另外，tomcat 7.0 需要[额外的配置](http://mojo.codehaus.org/tomcat-maven-plugin/examples/deployment-tomcat7.html)来与 manager webapp 交互，如下所示：

```
<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>tomcat-maven-plugin</artifactId>
  <version>1.2-SNAPSHOT</version>
  <configuration>
    <url>http://localhost:8080/manager/html</url>
  </configuration>
</plugin> 
```

或者，您可以使用已在 apache 下[移动](http://tomcat.apache.org/maven-plugin-2.1/)的 2.x 版本，其中 mojos 已重命名为具有相同目标的 tomcat6 和 tomcat7。

```
<pluginManagement>
  <plugins>
    <plugin>
      <groupId>org.apache.tomcat.maven</groupId>
      <artifactId>tomcat6-maven-plugin</artifactId>
      <version>2.1</version>
    </plugin>
    <plugin>
      <groupId>org.apache.tomcat.maven</groupId>
      <artifactId>tomcat7-maven-plugin</artifactId>
      <version>2.1</version>
    </plugin>
  </plugins>
</pluginManagement> 
```

# wordpress - Wordpress：用于简单用户个人资料页面的插件

> ID：15422829
> 
> 赞同：1
> 
> 时间：2013-03-15T00:45:39.257
> 
> 标签：wordpress

在 WordPress 中，我知道 tld.com/author/username 存在于作者，但我正在寻找非作者的公共用户个人资料页面。我想为我网站上的成员设置一个简单的“收藏夹列表”。用户将创建一个帐户，并添加他们喜欢的帖子。他们不需要访问 wp-admin。

我正在寻找像 tld.com/user/username 这样简单的东西——而不是 /user/?uid=1。漂亮又“漂亮”。就像 WordPress 如何处理 /author/admin 或 /author/username 一样。

我还想保留 /authors 以便它也可以访问。

我尝试了很多插件，比如 WordPress-Users，但它不是一个“漂亮”的 URL，还尝试了一些复杂的插件，比如 Members、profile-builder、wp-user-frontend。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T22:44:41.720

我从这里找到的@bybloggers 答案中找到了答案。[https://wordpress.stackexchange.com/a/58793/12920](https://wordpress.stackexchange.com/a/58793/12920)

我稍微修改了他的代码以适应我的需要，但这是对我有用的代码，正是我正在寻找的：

```
// Create the query var so that WP catches the custom /member/username url
function userpage_rewrite_add_var( $vars ) {
    $vars[] = 'member';
    return $vars;
}
add_filter( 'query_vars', 'userpage_rewrite_add_var' );

// Create the rewrites
function userpage_rewrite_rule() {
    add_rewrite_tag( '%member%', '([^&]+)' );
    add_rewrite_rule(
        '^member/([^/]*)/?',
        'index.php?member=$matches[1]',
        'top'
    );
}
add_action('init','userpage_rewrite_rule');

// Catch the URL and redirect it to a template file
function userpage_rewrite_catch() {
    global $wp_query;

    if ( array_key_exists( 'member', $wp_query->query_vars ) ) {
        include (TEMPLATEPATH . '/user-profile.php');
        exit;
    }
}
add_action( 'template_redirect', 'userpage_rewrite_catch' ); 
```

在我的`functions.php`文件中之后，我不得不重新保存我的永久链接。

有时重新保存永久链接并不能 100% 完成工作，浏览 www.mysite.com/member/username 会出现 404，因此我不得不手动刷新规则，将其放入`functions.php`我的网站并加载我的网站一次。然后删除它，这样我就不会在每次站点加载时都运行它，因为这是不必要的开销。

```
// Code needed to finish the member page setup
function memberpage_rewrite() {
     global $wp_rewrite;
     $wp_rewrite->flush_rules();
}
add_action('init','author_rewrite'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T00:52:46.297

我不知道你是否会找到这个，至少不是免费的。你检查过WPMU吗？几个月前我开始编写会员插件，但从未完成，现在正在 Symfony 中完成。大多数 WordPress 会员插件要么太复杂而无法使用，要么无法提供您需要的功能。

你应该明确你需要什么，让当地的开发商为你建造它，如果你做得好，你甚至可以卖掉它。

# jms - WSO2 Axis2 JMS 传输无法在 Websphere MQ 队列上设置 JMS_DESTINATION

> ID：15422830
> 
> 赞同：1
> 
> 时间：2013-03-15T00:45:46.907
> 
> 标签：jms, axis2, wso2, ibm-mq, wso2esb

我有一个简单的 WSO2 ESB Axis2 JMS 传输从 ActiveMQ 队列中提取消息并将其推送到 Websphere MQ 队列。

发送消息时，我收到以下错误

```
com.ibm.msg.client.jms.DetailedMessageFormatException: JMSCC0050: The property name 'JMS_DESTINATION' is reserved and cannot be set 
```

我没有明确设置任何属性，但我想知道这是否是 WSO2 ESB Axis2 JMS 传输向 Websphere MQ 发送消息的方式？

这与 Websphere MQ 到 ActiveMQ 的另一种方式效果很好。

我在 JNDI Websphere MQ 连接工厂上使用客户端模式，并通过 LDAP 服务器连接到它，也使用默认的 SYSTEM.DEF.SVRCONN 通道。

这可能是 Websphere MQ 中的权限问题吗？

我运行了 ALTER QMGR CHLAUTH(DISABLED) 以排除任何权限问题（我希望如此）。

代理服务

```
<proxy xmlns="http://ws.apache.org/ns/synapse" name="ACTIVETOIBM" transports="jms" statistics="enable" trace="enable" startOnLoad="true">
   <target>
      <inSequence>
         <log level="full" separator=","/>
         <property name="OUT_ONLY" value="true" scope="default" type="STRING"/>
         <send>
            <endpoint>
               <address uri="jms:/cn=QUEUE.OUT?transport.jms.ConnectionFactory=ibmMQQueueConnectionFactory&transport.jms.Destination=cn=QUEUE.OUT">
                  <markForSuspension>
                     <retryDelay>5</retryDelay>
                  </markForSuspension>
               </address>
            </endpoint>
         </send>
      </inSequence>
      <outSequence/>
      <faultSequence>
         <log level="full" category="ERROR" separator=","/>
      </faultSequence>
   </target>
   <parameter name="transport.jms.ConnectionFactory">activeMQQueueConnectionFactory</parameter>
   <parameter name="transport.jms.Destination">QUEUE.IN</parameter>
   <description></description>
</proxy> 
```

axis2 jms transportReceiver 配置

```
 <transportReceiver name="jms" class="org.apache.axis2.transport.jms.JMSListener">
        <parameter name="activeMQQueueConnectionFactory" locked="false">
            <parameter name="java.naming.factory.initial" locked="false">org.apache.activemq.jndi.ActiveMQInitialContextFactory</parameter>
            <parameter name="java.naming.provider.url" locked="false">tcp://localhost:61616</parameter>
            <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">QueueConnectionFactory</parameter>
            <parameter name="transport.jms.ConnectionFactoryType" locked="false">queue</parameter>
        </parameter>

        <parameter name="ibmMQQueueConnectionFactory" locked="false">
            <parameter name="java.naming.factory.initial" locked="false">com.sun.jndi.ldap.LdapCtxFactory</parameter>
            <parameter name="java.naming.provider.url" locked="false">ldap://localhost:7777/dc=example,dc=com</parameter>
            <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">cn=ConnectionFactoryLdap</parameter>
            <parameter name="transport.jms.ConnectionFactoryType" locked="false">queue</parameter>
        </parameter>
    </transportReceiver> 
```

axis2 jms transportSender 配置

```
 <transportSender name="jms" class="org.apache.axis2.transport.jms.JMSSender">
     <parameter name="activeMQQueueConnectionFactory" locked="false">
        <parameter name="java.naming.factory.initial" locked="false">org.apache.activemq.jndi.ActiveMQInitialContextFactory</parameter>
        <parameter name="java.naming.provider.url" locked="false">tcp://localhost:61616</parameter>
        <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">QueueConnectionFactory</parameter>
        <parameter name="transport.jms.ConnectionFactoryType" locked="false">queue</parameter>
    </parameter>

    <parameter name="ibmMQQueueConnectionFactory" locked="false">
        <parameter name="java.naming.factory.initial" locked="false">com.sun.jndi.ldap.LdapCtxFactory</parameter>
        <parameter name="java.naming.provider.url" locked="false">ldap://localhost:7777/dc=example,dc=com</parameter>
        <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">cn=ConnectionFactoryLdapCM</parameter>
        <parameter name="transport.jms.ConnectionFactoryType" locked="false">queue</parameter>
    </parameter>        
 </transportSender> 
```

全栈跟踪

```
com.ibm.msg.client.jms.DetailedMessageFormatException: JMSCC0050: The property name 'JMS_DESTINATION' is reserved and cannot be set.
The supplied property name begins with the JMS prefix, but is not one of the supported, settable properties.
Check the property name and correct errors.
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at com.ibm.msg.client.commonservices.j2se.NLSServices.createException(NLSServices.java:319)
        at com.ibm.msg.client.commonservices.nls.NLSServices.createException(NLSServices.java:233)
        at com.ibm.msg.client.jms.internal.JmsErrorUtils.createException(JmsErrorUtils.java:109)
        at com.ibm.msg.client.jms.internal.JmsMessageImpl.checkSettablePropertyName(JmsMessageImpl.java:2125)
        at com.ibm.msg.client.jms.internal.JmsMessageImpl.setStringProperty(JmsMessageImpl.java:1560)
        at com.ibm.jms.JMSMessage.setStringProperty(JMSMessage.java:1496)
        at org.apache.axis2.transport.jms.JMSUtils.setTransportHeaders(JMSUtils.java:278)
        at org.apache.axis2.transport.jms.JMSSender.createJMSMessage(JMSSender.java:441)
        at org.apache.axis2.transport.jms.JMSSender.sendOverJMS(JMSSender.java:172)
        at org.apache.axis2.transport.jms.JMSSender.sendMessage(JMSSender.java:154)
        at org.apache.axis2.transport.base.AbstractTransportSender.invoke(AbstractTransportSender.java:112)
        at org.apache.axis2.engine.AxisEngine$TransportNonBlockingInvocationWorker.run(AxisEngine.java:626)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
[2013-03-15 10:25:35,306] ERROR - AsyncCallback Error creating a JMS message from the message context
org.apache.axis2.AxisFault: Error creating a JMS message from the message context
        at org.apache.axis2.transport.base.AbstractTransportSender.handleException(AbstractTransportSender.java:226)
        at org.apache.axis2.transport.jms.JMSSender.sendOverJMS(JMSSender.java:174)
        at org.apache.axis2.transport.jms.JMSSender.sendMessage(JMSSender.java:154)
        at org.apache.axis2.transport.base.AbstractTransportSender.invoke(AbstractTransportSender.java:112)
        at org.apache.axis2.engine.AxisEngine$TransportNonBlockingInvocationWorker.run(AxisEngine.java:626)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
Caused by: com.ibm.msg.client.jms.DetailedMessageFormatException: JMSCC0050: The property name 'JMS_DESTINATION' is reserved and cannot be set.
The supplied property name begins with the JMS prefix, but is not one of the supported, settable properties.
Check the property name and correct errors.
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at com.ibm.msg.client.commonservices.j2se.NLSServices.createException(NLSServices.java:319)
        at com.ibm.msg.client.commonservices.nls.NLSServices.createException(NLSServices.java:233)
        at com.ibm.msg.client.jms.internal.JmsErrorUtils.createException(JmsErrorUtils.java:109)
        at com.ibm.msg.client.jms.internal.JmsMessageImpl.checkSettablePropertyName(JmsMessageImpl.java:2125)
        at com.ibm.msg.client.jms.internal.JmsMessageImpl.setStringProperty(JmsMessageImpl.java:1560)
        at com.ibm.jms.JMSMessage.setStringProperty(JMSMessage.java:1496)
        at org.apache.axis2.transport.jms.JMSUtils.setTransportHeaders(JMSUtils.java:278)
        at org.apache.axis2.transport.jms.JMSSender.createJMSMessage(JMSSender.java:441)
        at org.apache.axis2.transport.jms.JMSSender.sendOverJMS(JMSSender.java:172)
        ... 6 more
[2013-03-15 10:25:35,310]  WARN - AsyncCallback Executing fault handler due to exception encountered
[2013-03-15 10:25:35,311]  WARN - FaultHandler ERROR_CODE : 0
[2013-03-15 10:25:35,311]  WARN - FaultHandler ERROR_MESSAGE : Error creating a JMS message from the message context
[2013-03-15 10:25:35,311]  WARN - FaultHandler ERROR_DETAIL : org.apache.synapse.SynapseException: Error creating a JMS message from the message context
        at org.apache.synapse.core.axis2.AsyncCallback.onError(AsyncCallback.java:67)
        at org.apache.axis2.engine.AxisEngine$TransportNonBlockingInvocationWorker.run(AxisEngine.java:643)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
Caused by: org.apache.axis2.AxisFault: Error creating a JMS message from the message context
        at org.apache.axis2.transport.base.AbstractTransportSender.handleException(AbstractTransportSender.java:226)
        at org.apache.axis2.transport.jms.JMSSender.sendOverJMS(JMSSender.java:174)
        at org.apache.axis2.transport.jms.JMSSender.sendMessage(JMSSender.java:154)
        at org.apache.axis2.transport.base.AbstractTransportSender.invoke(AbstractTransportSender.java:112)
        at org.apache.axis2.engine.AxisEngine$TransportNonBlockingInvocationWorker.run(AxisEngine.java:626)
        ... 3 more
Caused by: com.ibm.msg.client.jms.DetailedMessageFormatException: JMSCC0050: The property name 'JMS_DESTINATION' is reserved and cannot be set.
The supplied property name begins with the JMS prefix, but is not one of the supported, settable properties.
Check the property name and correct errors.
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at com.ibm.msg.client.commonservices.j2se.NLSServices.createException(NLSServices.java:319)
        at com.ibm.msg.client.commonservices.nls.NLSServices.createException(NLSServices.java:233)
        at com.ibm.msg.client.jms.internal.JmsErrorUtils.createException(JmsErrorUtils.java:109)
        at com.ibm.msg.client.jms.internal.JmsMessageImpl.checkSettablePropertyName(JmsMessageImpl.java:2125)
        at com.ibm.msg.client.jms.internal.JmsMessageImpl.setStringProperty(JmsMessageImpl.java:1560)
        at com.ibm.jms.JMSMessage.setStringProperty(JMSMessage.java:1496)
        at org.apache.axis2.transport.jms.JMSUtils.setTransportHeaders(JMSUtils.java:278)
        at org.apache.axis2.transport.jms.JMSSender.createJMSMessage(JMSSender.java:441)
        at org.apache.axis2.transport.jms.JMSSender.sendOverJMS(JMSSender.java:172)
        ... 6 more

[2013-03-15 10:25:35,313]  WARN - FaultHandler ERROR_EXCEPTION : org.apache.synapse.SynapseException: Error creating a JMS message from the message context 
```

干杯史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T03:49:41.980

WebSphere MQ JMS 库不允许设置大多数传输范围属性。

因此，您必须在发送到 JMS 队列之前删除它们。

我们需要在之前添加以下属性。

```
<property name="JMS_DESTINATION" scope="transport" action="remove"/>
<property name="JMS_REDELIVERED" scope="transport" action="remove" />
<property name="JMS_TYPE" scope="transport" action="remove" /> 
<property name="Accept-Encoding" scope="transport" action="remove"/>
<property name="Content-Length" scope="transport" action="remove"/>
<property name="Content-Type" scope="transport" action="remove"/>
<property name="User-Agent" scope="transport" action="remove"/>
<property name="Transfer-Encoding" scope="transport" action="remove"/>
<property name="X-Forwarded-For" scope="transport" action="remove"/>
<property name="X-Forwarded-Host" scope="transport" action="remove"/>
<property name="X-Forwarded-Server" scope="transport" action="remove"/> 
```

但我想你已经找到了解决方案！:)

# c# - Web API OData V3 `$inlinecount` 失败

> ID：15422831
> 
> 赞同：27
> 
> 时间：2013-03-15T00:45:48.940
> 
> 标签：c#, asp.net-web-api, odata

我在 ASP.NET Web API 应用程序中使用开箱即用的 ValuesController

```
 public class ValuesController : ApiController
 {
     // GET api/values
     [Queryable(PageSize = 1)]
     public IQueryable<string> Get()
     {
         return new string[] { "value1", "value2", "value3", "value4", "value5" }.AsQueryable();
     }
 } 
```

当我`get http://localhost/api/values?$inlinecount=allpages`

这是回应

```
<ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<string>value1</string>
</ArrayOfString> 
```

我已取消注释`config.EnableQuerySupport();`

过滤，排序工作正常。

如果我尝试`get http://localhost/api/values?$inlinecount=XXXXX`出现异常，那么 Web API 应用程序似乎知道`inlinecount`

```
<Message>The query specified in the URI is not valid.</Message>
<ExceptionMessage>'xxx' is not a valid value for $inlinecount.</ExceptionMessage> 
<ExceptionType>Microsoft.Data.OData.ODataException</ExceptionType> 
```

我肯定有 Microsoft.AspNet.WebApi.OData 包 - 这是包管理器控制台的输出

```
PM> Install-Package Microsoft.AspNet.WebApi.OData 
Attempting to resolve dependency 'Microsoft.Net.Http (= 2.0.20710.0 && < 2.1)'.
Attempting to resolve dependency 'Microsoft.AspNet.WebApi.Client (= 4.0.20710.0 && < 4.1)'.
Attempting to resolve dependency 'Newtonsoft.Json (= 4.5.6)'.
Attempting to resolve dependency 'Microsoft.AspNet.WebApi.Core (= 4.0.20710.0 && < 4.1)'.
Attempting to resolve dependency 'Microsoft.Data.OData (= 5.2.0 && < 5.3.0)'.
Attempting to resolve dependency 'System.Spatial (= 5.2.0)'.
Attempting to resolve dependency 'Microsoft.Data.Edm (= 5.2.0)'.
'Microsoft.AspNet.WebApi.OData 4.0.0' already installed.
WebServicesProject already has a reference to 'Microsoft.AspNet.WebApi.OData 4.0.0'. 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-15T01:00:32.027

好问题。

开箱即用的 $inlinecount 仅在您发回 OData 响应时才有效。原因是 OData 在数据中定义了 XML 和 JSON 未定义的特殊字段。因此，在 OData 中，响应可能如下所示：

```
{
  "odata.metadata":"http://localhost:12345/odata/$metadata#Customers",
  "odata.count":"4",
  "value":[ ... ]
} 
```

注意带有“odata.count”属性的包装器。这与默认 XML 和 JSON 格式化程序写出数据的方式不同，因为它们没有针对这些附加信息的包装器。所以其他格式化程序默认不变。

现在你有几个选择：

您可以选择使用 OData 格式。为此，您需要按照此博客文章中的说明进行操作：

[http://blogs.msdn.com/b/webdev/archive/2013/01/29/getting-started-with-asp-net-webapi-odata-in-3-simple-steps.aspx](http://blogs.msdn.com/b/webdev/archive/2013/01/29/getting-started-with-asp-net-webapi-odata-in-3-simple-steps.aspx)

您也可以选择返回一个`PageResult<T>`. 这看起来像这样：

```
public PageResult<Customer> Get(ODataQueryOptions<Customer> queryOptions)
{
    IQueryable results = queryOptions.ApplyTo(_customers.AsQueryable());
    return new PageResult<Customer>(results as IEnumerable<Customer>, Request.GetNextPageLink(), Request.GetInlineCount());
} 
```

通过为 XML 和 JSON 添加一个可以包含计数和下一页链接的包装器对象，这应该适用于 OData、JSON 和 XML。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-08-29T20:05:39.070

在 OData v4 中，$inlinecount=allpages 已替换为 $count=true。

$count 仅适用于在最新版本的 aspnet mvc 中返回 IQueryable。

# xslt - 如何使用 XSLT 1.0 从此 XML 中提取字段？

> ID：15422834
> 
> 赞同：0
> 
> 时间：2013-03-15T00:46:02.290
> 
> 标签：xslt, namespaces

我是 XSLT 新手，需要使用 XSLT 从美国专利商标局的商标文件中提取一些字段。这是一个典型文件的非常简化的副本：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Transaction xmlns:ns2="urn:us:gov:doc:uspto:trademark:status" xmlns="http://www.wipo.int/standards/XMLSchema/trademarks">
  <TradeMarkTransactionBody>
    <TransactionContentDetails>
      <TransactionCode>National Trademark Information</TransactionCode>
      <TransactionData>
        <TradeMarkDetails>
          <TradeMark>
            <RegistrationOfficeCode>US</RegistrationOfficeCode>
            <ApplicationNumber>74631225</ApplicationNumber>
            <ApplicationDate>1995-02-07-05:00</ApplicationDate>
            <RegistrationNumber>2178784</RegistrationNumber>
            <RegistrationDate>1998-08-04-04:00</RegistrationDate>
            <FilingPlace>US</FilingPlace>
            <MarkCurrentStatusDate>2008-08-11-04:00</MarkCurrentStatusDate>
            <WordMarkSpecification>
              <MarkVerbalElementText>JAVA </MarkVerbalElementText>
            </WordMarkSpecification>
          </TradeMark>
        </TradeMarkDetails>
      </TransactionData>
    </TransactionContentDetails>
  </TradeMarkTransactionBody>
</Transaction> 
```

我希望能够生产：

```
App number: 74631225 
```

这是我的几次失败尝试；尝试#1：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="text" encoding="utf-8" />
    <xsl:template match="/">
    App number: <xsl:value-of select="/Transaction/TradeMarkTransactionBody/TransactionContentDetails/TransactionData/TradeMarkDetails/TradeMark/ApplicationNumber"/>
    </xsl:template>
</xsl:stylesheet> 
```

只生产：

```
App number: 
```

尝试#2：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text" encoding="utf-8" />
    <xsl:template match="/Transaction/TradeMarkTransactionBody/TransactionContentDetails/TransactionData/TradeMarkDetails/TradeMark">
    App number: <xsl:value-of select="ApplicationNumber"/>
    </xsl:template>
</xsl:stylesheet> 
```

产生：

```
 National Trademark Information

        US
        74631225
        1995-02-07-05:00
        2178784
        1998-08-04-04:00
        US
        2008-08-11-04:00

          JAVA 
```

任何帮助，将不胜感激。一旦我通过这道门并至少有一个领域工作，我希望我能进入我项目的真正实质。如果重要的话，我将同时使用 MSXSL 和 Treebeard（我认为它使用 Saxon）进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:50:10.693

您的 XSLT 代码缺少名称空间声明。检查您的 Xml 文档中的根元素，它是这样说的：

```
xmlns="http://www.wipo.int/standards/XMLSchema/trademarks" 
```

这意味着，您的 Xml 文档中的任何元素都在该名称空间中。

另一方面，在 XSLT 中，您没有指定任何名称空间，这意味着您的 XSLT 处理器查找在 XSLT 中使用“空白名称空间”指定的元素名称 - 因此，例如`Transaction`，您的 XSLT 中提到的元素与`Transaction`(来自`http://www.wipo.int/standards/XMLSchema/trademarks`命名空间）在您的 Xml 文档中提到。

XSLT，或者更确切地说是 XPath，不知道“默认”（无前缀）命名空间的概念，这就是为什么您必须分配一些任意前缀 - 比如说`tm`：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:tm="http://www.wipo.int/standards/XMLSchema/trademarks">
<xsl:output method="text" encoding="utf-8" />
    <xsl:template match="/">
    App number: <xsl:value-of select="/tm:Transaction/tm:TradeMarkTransactionBody/tm:TransactionContentDetails/tm:TransactionData/tm:TradeMarkDetails/tm:TradeMark/tm:ApplicationNumber"/>
    </xsl:template>
</xsl:stylesheet> 
```

*这应该让你更接近你正在寻找的东西。我只能在几个小时后尝试这个；如果您需要进一步的帮助，请发表评论，我会检查这个问题。*

# events - 在用户窗体中引发时未找到 VBA 自定义事件

> ID：15422836
> 
> 赞同：1
> 
> 时间：2013-03-15T00:46:35.593
> 
> 标签：events, vba, userform

我正在按照[这个 MSDN 指南](http://msdn.microsoft.com/en-us/library/office/aa140931%28v=office.10%29.aspx)创建自定义事件。我觉得我现在理解了这个过程，但我不知道为什么我会得到一个`Compile Error: Event Not Found`for `RaiseEvent ItemAdded`。奇怪的是，IDE 可以识别 ItemAdded 事件（我可以全部输入小写，然后自动正确格式化），所以我*知道*它可以被 VB 识别。

## DataComboBox 类模块代码：

```
Public Event ItemAdded(sItem As String, fCancel As Boolean)

Private pComboBox As Control

Public Property Set oComboBox(cControl As Control)
    Set pComboBox = cControl
End Property

Public Property Get oComboBox() As Control
    oComboBox = pComboBox
End Property

Private Sub Class_Initialize()

End Sub

Private Sub Class_Terminate()

End Sub 
```

UserForm 包含两个控件 - 一个名为 btnAdd 的 CommandButton 和一个名为 cboData 的 ComboBox。

## 用户表单代码：

```
Private WithEvents mdcbCombo As DataComboBox

Private Sub UserForm_Initialize()
    Set mdcbCombo = New DataComboBox
    Set mdcbCombo.oComboBox = Me.cboData
End Sub

Private Sub mdcbCombo_ItemAdded(sItem As String, fCancel As Boolean)
    Dim iItem As Long
    If LenB(sItem) = 0 Then
        fCancel = True
        Exit Sub
    End If
    For iItem = 1 To Me.cboData.ListCount
        If Me.cboData.List(iItem) = sItem Then
            fCancel = True
            Exit Sub
        End If
    Next iItem
End Sub

Private Sub btnAdd_Click()
    Dim sItem As String
    sItem = Me.cboData.Text
    AddDataItem sItem
End Sub

Private Sub AddDataItem(sItem As String)
    Dim fCancel As Boolean
    fCancel = False

    RaiseEvent ItemAdded(sItem, fCancel)

    If Not fCancel Then Me.cboData.AddItem (sItem)

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:02:45.380

您不能在类文件级别之外引发事件。

在“DataComboBox1”中添加这样的例程，以允许您在外部引发事件。

```
Public Sub OnItemAdded(sItem As String, fCancel As Boolean)
    RaiseEvent ItemAdded(sItem, fCancel)
End Sub 
```

然后用当前对象调用 OnItemAdded。

例子...

```
Private WithEvents mdcbCombo As DataComboBox
...
mdcbCombo.OnItemAdded(sItem, fCancel) 
```

# rest - JsonMappingException：ID 已经有 POJO

> ID：15422838
> 
> 赞同：23
> 
> 时间：2013-03-15T00:46:42.767
> 
> 标签：rest, spring-mvc, data-binding, jackson, json

尝试使用 @JsonIdentityInfo jackson 注释时出现错误。当我尝试反序列化对象时，出现以下异常：

> 无法读取 JSON：已经有 POJO for id (java.lang.Integer) [1]（通过参考链：eu.cobiz.web.domain.Site["operators"]->eu.yavix.web.domain.Account ["image"]->eu.cobiz.web.domain.Image["@Image"]);嵌套异常是**com.fasterxml.jackson.databind.JsonMappingException** :***已经有 POJO for id*** (java.lang.Integer) [ 1]（通过引用链：eu.yavix.web.domain.Site["operators"]->eu.cobiz.web.domain.Account["image"]->eu.cobiz.web.domain.Image[" @图片”]）

我试图反序列化的 JSON 看起来像：

```
{
"@Site": 1,
"siteId": 1,
"name": "0",
"address": {
    "@Address": 2,
    "addressId": 4,
    "number": "22"
},
"operators": [
    {
        "accountId": 1,
        "email": "user982701361@yavix.eu",
        "image": {
            "@Image": 1,
            "imageId": 1,
            "uri": "http://icons.iconarchive.com/icons/deleket/purple-monsters/128/Alien-awake-icon.png"
        }
    },
    {
        "accountId": 2,
        "email": "user174967957@yavix.eu",
        "image": {
            "@Image": 2,
            "imageId": 2,
            "uri": "http://icons.iconarchive.com/icons/deleket/purple-monsters/128/Alien-awake-icon.png"
        }
    }
]
} 
```

我的域对象带有注释

```
@JsonIdentityInfo(generator = ObjectIdGenerators.IntSequenceGenerator.class, property = "@Image") 
```

问题出现在@Id 注释上，因为如果我删除注释，问题就会消失（就像我为帐户所做的那样），但据我了解，新功能对循环依赖很有用，这在其他情况下对我很有用。两张图片之间不应该有冲突，因为它们是不同的对象。

我该如何解决这个问题或问题是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2014-05-27T01:48:06.467

`scope`注释 id 时应该使用参数。然后反序列化器将确保 id 在范围内是唯一的。

从注释类型`JsonIdentityInfo`：

> Scope 用于定义 Object Id 的适用性：所有 id 在其范围内必须是唯一的；其中范围定义为此值和生成器类型的组合。

例如

```
@JsonIdentityInfo(generator=ObjectIdGenerators.IntSequenceGenerator.class,property="@id", scope = Account.class) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-03T19:57:50.850

为避免 id 冲突，请尝试使用`ObjectIdGenerators.PropertyGenerator.class`or`ObjectIdGenerators.UUIDGenerator.class`代替`ObjectIdGenerators.IntSequenceGenerator.class`

# iphone - 使用 PhoneGap 在 iPhone 的照片库中创建一个新目录

> ID：15422841
> 
> 赞同：0
> 
> 时间：2013-03-15T00:47:04.137
> 
> 标签：iphone, cordova, camera, directory, photo

我目前正在使用 PhoneGap 框架开发一个移动应用程序。我只是想知道是否有任何 PhoneGap API 或插件可以让我们在 iPhone 的照片库中创建一个新目录。因此，每次当用户使用我的应用程序捕获图片时，我都可以将其保存到该目录中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:05:39.137

据我所知，目前您无法使用 phoneGap 在 iPhone 的照片库中创建新目录

但是，您可以将图像保存到 iPhone 的照片库中。

请参阅下面的代码

```
<a href="#" onclick="runImageTest('/www/underboob.png');">save image</a> 

function runImageTest(img) 
{ 
   PhoneGap.exec("ImageHelper.saveToUserLibrary",img); 
} 
```

请在[此处查看讨论](https://groups.google.com/forum/?fromgroups=#!topic/phonegap/6n7jGIey9hA)

# android - 锁定为纵向时在 Activity 中伪造横向

> ID：15422845
> 
> 赞同：2
> 
> 时间：2013-03-15T00:47:30.577
> 
> 标签：android, screen-orientation, orientation-changes

Android 上的相机应用程序将其方向锁定为纵向，并在您转向横向时伪造方向更改。屏幕永远不会重新定向（您根本看不到屏幕重新加载或移动），但图标会转动以使其看起来像是改变了方向。他们是如何实现这一目标的？

假设我这样做了。所以我被锁定在横向模式，我旋转手机，所以我是纵向的（至少这对用户来说是这样的）。现在，如果我在此 Activity 顶部弹出任何对话框，我希望它们以纵向弹出。我将如何实现这一目标？

# ant - ANT 从文件集创建文件集

> ID：15422846
> 
> 赞同：1
> 
> 时间：2013-03-15T00:47:31.103
> 
> 标签：ant

我知道这一定很容易，但我不知道该怎么做。我有一个现有的文件集（来自 3rdparty 任务）。我现在想创建一个新的文件集，其中包括从第一个开始的所有内容，其中一些被排除在外。我应该能够做到

```
<fileset refid"origFileset">
<exclude name="foobar/>
</fileset> 
```

由于某种原因，ant 抱怨这种基本操作。

# objective-c - 如何让套接字成为非阻塞的

> ID：15422847
> 
> 赞同：0
> 
> 时间：2013-03-15T00:47:36.637
> 
> 标签：objective-c, macos, sockets, redis, libssh2

我正在用 Objective-C 编写一个简单的 Redis 客户端应用程序。为了与服务器上的 Redis 通信，我需要通过 SSH 连接到服务器，然后打开 TCP 套接字来来回发送数据。我正在尝试遵循[libssh2.org 中的一个示例，`direct_tcpip.c`](http://www.libssh2.org/examples/direct_tcpip.html)并且我已经让它运行良好。我可以运行代码，它会说：

```
Waiting for TCP connection on... 0.0.0.0:6379 
```

所以我然后尝试使用 telnet 与它通信：

```
telnet 0.0.0.0 6379 
```

我可以通过这种方式成功地与 Redis 连接和交互，是的！

现在下一步是让我能够以编程方式与服务器对话并从我的应用程序的 UI 向它发送命令，但是当我调用时程序被阻塞`accept()`并卡住等待连接进入。这是一个问题，因为我需要以编程方式连接到它，我似乎无法弄清楚如何做到这一点。

`libssh2_session_set_blocking(session, 0);`我之前试过打电话`accept()`，但这似乎并没有改变任何事情。

我的目标是设置转发，以便我的应用程序可以尽可能轻松地与远程 Redis 服务器通信，而且**我对套接字编程完全陌生**。我需要一个 SSH 隧道，因为 Redis 没有内置的安全性，建议您在内部与其通信。

感谢任何可以为我指明正确方向的人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T03:41:24.523

@Danack 发表的评论为我解决了这个问题。我正在使用后台线程进行监听，现在我不再被阻塞并且连接得很好。

# objective-c - 获取系统的日期和时间戳

> ID：15422848
> 
> 赞同：5
> 
> 时间：2013-03-15T00:47:49.760
> 
> 标签：objective-c, datetime, xcode4.5

我创建了一种将数据字符串写入文本文件的方法。我想知道如何获取系统日期和时间并将其发送到文本文件？这是方法：

```
 -(void) writeToTextFile{

//get the documents dir
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

//file name to write the data to using the documents directory:
NSString *fileName = [NSString stringWithFormat:@"%@/movbandlog.txt",
                      documentsDirectory];
//create content 
NSString *content = @"Data received from device\n \n \n \n \nData sent to Portal\n \n \n \n \nData received to Portal";

//save to documents directory
[content writeToFile:fileName
          atomically:NO
            encoding:NSStringEncodingConversionAllowLossy
               error:nil];

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-15T00:55:38.620

**纯可可**

使用[`NSDate`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html)并可选择[`NSDateFormatter`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDateFormatter)格式化它：

```
NSDate *currentDate = [NSDate date];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"dd.MM.YY HH:mm:ss"];
NSString *dateString = [dateFormatter stringFromDate:currentDate];
// NSLog(@"%@",dateString);

// Adding your dateString to your content string
NSString *content = [NSString stringWithFormat:@"Data received from device\n \n \n \n \nData sent to Portal\n \n \n \n \nData received to Portal\n \n \n \n \nData received at %@", dateString]; 
```

**使用 Unix 函数**

您也可以考虑[将 unix 函数用于未本地化的](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW12)日期（时间戳）

```
struct tm  sometime;
const char *formatString = "%Y-%m-%d %H:%M:%S %z";
(void) strptime_l("2005-07-01 12:00:00 -0700", formatString, &sometime, NULL);
NSLog(@"NSDate is %@", [NSDate dateWithTimeIntervalSince1970: mktime(&sometime)]);
// Output: NSDate is 2005-07-01 12:00:00 -0700 
```

# javascript - 在模糊功能Jquery中检测Mousemove

> ID：15422850
> 
> 赞同：0
> 
> 时间：2013-03-15T00:48:02.123
> 
> 标签：javascript, jquery, settimeout, mousemove

我正在尝试创建一种巧妙的方法来停止基于浏览器是否处于焦点以及鼠标移动的 AJAX 调用。所以这就是我想要它做的事情：

如果用户在浏览器中转到其他选项卡、最小化窗口或转到 Web 应用程序以外的其他位置，我希望它在 1 分钟内终止 AJAX 调用。如果用户在 Web 应用程序中的任何位置移动鼠标，它应该认为用户“专注”在应用程序上，从而继续 ajax 调用。我在其中放置了一个称为“st”的超时来处理“超时”部分，但是添加鼠标检测器要先进一些。这是我所拥有的：

```
var window_focus = true;
$(document).ready(function () {    

    $('#alertbox').click(function () {
        $('#alertbox').slideUp("slow");
    });

    // Check focal point
    $(window).focus(function () {
        if (window_focus) {
            return
        }
        window_focus = true;
        waitForMsg();

    }).blur(function () {
        if (!window_focus) {
            return
        }
        console.log('Init Suspension...');
        // Set Timeout
        $(function () {
            st = setTimeout(function () {
                clearTimeout(setTimeoutConst);
                window_focus = false;
                document.title = 'Timed Out | WEBSITE';
                console.log('Suspended');
            }, 60000);    
        });
    });

    waitForMsg();
}); 
```

我打算尝试添加这样的东西：

```
$(function () {
    $().mousemove(function () {
        console.log('Reinitialize');
        clearTimeout(st);
        waitForMsg();
    });
}); 
```

但它没有用。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T00:54:44.020

[http://jsfiddle.net/popnoodles/5mqMm/](http://jsfiddle.net/popnoodles/5mqMm/)

您可能希望使用`.one()`. 这将看到鼠标移动，运行您的程序并且不再运行它，直到重新加载窗口或它在另一个页面上。

将它放在模糊中意味着模糊再次设置它。

```
}).blur(function () {
    $(document).one('mousemove', function(){
       // i react ONCE to the mouse being moved
         console.log('Reinitialize');
         clearTimeout(st);
         waitForMsg();
         // focus the window again as desired
         $(window).trigger('focus');
    });
    if (!window_focus) {
        return
    }
    console.log('Init Suspension...');
    // Set Timeout
    $(function () {
        st = setTimeout(function () {
            clearTimeout(setTimeoutConst);
            window_focus = false;
            document.title = 'Timed Out | WEBSITE';
            console.log('Suspended');
        }, 60000);    
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T20:09:09.410

试试这个[jsfiddle](http://jsfiddle.net/GpjGY/)

```
var window_focus = true, lastMouseMoveTime;
$(document).ready(function () {    
    lastMouseMoveTime = new Date().getTime();
    $('#alertbox').click(function () {
        $('#alertbox').slideUp("slow");
    });

    // Check focal point
    $(window).focus(function () {
        if (window_focus) {
            return
        }
        window_focus = true;
        waitForMsg();

    }).blur(function () {
        if (!window_focus) {
            return
        }
        window_focus = false;
        console.log('Init Suspension...');
        // Set Timeout
    });

    waitForMsg();
    $(document).mousemove(function(){
        lastMouseMoveTime = new Date().getTime();
        if(!window_focus ){
            waitForMsg(); // restarting ajax if it stopped because of mousemove.
        }

    });

}); 
```

在您的 ajax 调用方法中

```
if( !window_focus){
     if( new Date().getTime() - lastMouseMoveTime   > 60*1000 ){
            return;
     }
} 
```

# c - c 上下文切换段错误

> ID：15422853
> 
> 赞同：1
> 
> 时间：2013-03-15T00:48:26.217
> 
> 标签：c, concurrency

我需要使用上下文切换和中断来模拟线程。我偶尔（1/25 次运行）在我的程序中遇到段错误。我不确定它的原因是什么。我怀疑这与我进行上下文切换的方式有关。我试过用 gdb 和 valgrind 确定段错误的原因，但没有成功。

GDB 结果：

```
0x0000007b in ?? ()
(gdb) bt
#0  0x0000007b in ?? ()
(gdb) 
```

Valgrind 结果（不完整）：

```
 ==6343== Conditional jump or move depends on uninitialised value(s)
      8 ==6343==    at 0x808F8CA: __linkin_atfork (in my-test)
      9 ==6343==    by 0x809046B: _dl_non_dynamic_init (in my-test)
     10 ==6343==    by 0x8090C31: __libc_init_first (in my-test)
     11 ==6343==    by 0x805EEB0: (below main) (in my-test)
     12 ==6343==  Uninitialised value was created
     13 ==6343==    at 0x80900E2: _dl_sysinfo_int80 (in my-test)
     14 ==6343==    by 0x80C056F: brk (in my-test)
     15 ==6343==    by 0x808D6C9: sbrk (in my-test)
     16 ==6343==    by 0x805F1CB: __libc_setup_tls (in my-test)
     17 ==6343==    by 0x805F3C6: __pthread_initialize_minimal (in my-test)
     18 ==6343==    by 0x805EE5C: (below main) (in my-test)
     19 ==6343==
     20 ==6343== Conditional jump or move depends on uninitialised value(s)
     21 ==6343==    at 0x806C015: malloc (in my-test)
     22 ==6343==    by 0x809046B: _dl_non_dynamic_init (in my-test)
     23 ==6343==    by 0x8090C31: __libc_init_first (in my-test)
     24 ==6343==    by 0x805EEB0: (below main) (in my-test)
     25 ==6343==  Uninitialised value was created
     26 ==6343==    at 0x80900E2: _dl_sysinfo_int80 (in my-test)
     27 ==6343==    by 0x80C056F: brk (in my-test)
     28 ==6343==    by 0x808D6C9: sbrk (in my-test)
     29 ==6343==    by 0x805F1CB: __libc_setup_tls (in my-test)
     30 ==6343==    by 0x805F3C6: __pthread_initialize_minimal (in my-test)
     31 ==6343==    by 0x805EE5C: (below main) (in my-test)
...    
    ==6343== Warning: client switching stacks?  SP change: 0xbee18ea0 --> 0x8135e08
    281 ==6343==          to suppress, use: --max-stackframe=1228001128 or greater
    282 ==6343== Conditional jump or move depends on uninitialised value(s)
    283 ==6343==    at 0x806C015: malloc (in my-test)
    284 ==6343==    by 0x804E5D4: mem_resize_fn (in my-test)
    285 ==6343==    by 0x804A5D1: expand (iin my-test)
    286 ==6343==    by 0x804B0C4: list_insert (in my-test)
    287 ==6343==    by 0x804BE7E: list_append_int (in my-test)
    288 ==6343==    by 0x8049B4D: handler (in my-test)
    289 ==6343==    by 0x8060B42: makecontext (in my-test)
    290 ==6343==    by 0x8049AB0: main (in my-test)
    291 ==6343==  Uninitialised value was created
    292 ==6343==    at 0x80900E2: _dl_sysinfo_int80 (in my-test)
    293 ==6343==    by 0x80C056F: brk (in my-test)
    294 ==6343==    by 0x808D6C9: sbrk (in my-test)
    295 ==6343==    by 0x805F1CB: __libc_setup_tls (in my-test)
    296 ==6343==    by 0x805F3C6: __pthread_initialize_minimal (in my-test)
    297 ==6343==    by 0x805EE5C: (below main) (in my-test)
 ...   

==6343== Warning: client switching stacks?  SP change: 0x813da60 --> 0xbee18ea0
385 ==6343==          to suppress, use: --max-stackframe=1228032960 or greater
386 ==6343== Use of uninitialised value of size 4
387 ==6343==    at 0x804A1E9: scheduler (in my-test)
388 ==6343==    by 0x809F617: ??? (in my-test)
389 ==6343==    by 0x809F617: ??? (in my-test)
390 ==6343==  Uninitialised value was created by a stack allocation
391 ==6343==    at 0x8060BD8: swapcontext (in my-test)
...
 ==6343== Use of uninitialised value of size 4
434 ==6343==    at 0x805F644: sigprocmask (in my-test)
435 ==6343==    by 0x1FFF: ???
436 ==6343==    by 0x8049B4D: handler (in my-test)
437 ==6343==    by 0x8060B42: makecontext (in my-test)
438 ==6343==    by 0x8049AB0: main (in my-test)
439 ==6343==  Uninitialised value was created by a stack allocation
440 ==6343==    at 0x8060BD8: swapcontext (in my-test)
441 ==6343==
442 ==6343== Jump to the invalid address stated on the next line
443 ==6343==    at 0x2000: ???
444 ==6343==    by 0x8049B4D: handler (in my-test)
445 ==6343==    by 0x8060B42: makecontext (in my-test)
446 ==6343==    by 0x8049AB0: main (in my-test)
447 ==6343==  Address 0x2000 is not stack'd, malloc'd or (recently) free'd
448 ==6343==
449 ==6343==
450 ==6343== Process terminating with default action of signal 11 (SIGSEGV)
451 ==6343==  Bad permissions for mapped region at address 0x2000
452 ==6343==    at 0x2000: ???
453 ==6343==    by 0x8049B4D: handler (in my-test)
454 ==6343==    by 0x8060B42: makecontext (in my-test)
455 ==6343==    by 0x8049AB0: main (in my-test)
456 ==6343==
457 ==6343== HEAP SUMMARY:
458 ==6343==     in use at exit: 0 bytes in 0 blocks
459 ==6343==   total heap usage: 0 allocs, 0 frees, 0 bytes allocated
460 ==6343==
461 ==6343== All heap blocks were freed -- no leaks are possible
462 ==6343==
463 ==6343== For counts of detected and suppressed errors, rerun with: -v
464 ==6343== ERROR SUMMARY: 114 errors from 38 contexts (suppressed: 0 from 0) 
```

我的-test.c：

```
/* Includes */
#include <stdio.h>      /* Input/Output */
#include <stdlib.h>     /* General Utilities */
#include <math.h>

#include "mythreads.h"

/* prototype for thread routine */
void handler ( );

/* global vars */

/* semaphores are declared global so they can be accessed 
   in main() and in thread routine,
   here, the semaphore is used as a mutex */

int counter_mutex;

/* shared variables */
int counter; 
double result = 0.0;

int main()
{
    int thread_num = 10;
    int j;
    char* thread_names[] = {
        "thread 0",
        "thread 1",
        "thread 2",
        "thread 3",
        "thread 4",
        "thread 5",
        "thread 6",
        "thread 7",
        "thread 8",
        "thread 9"
    };

    /* Initialize MyThreads library. */
    mythread_init();

    /* 250 ms */
    set_quantum_size(500);

    counter_mutex = create_semaphore(1);

     for(j=0; j<thread_num; j++)
     {
        mythread_create(thread_names[j], (void *) &handler, 6004);
     }

    /* Print threads informations before run */
    //mythread_state();

     /* When this function returns, all threads should have exited. */
     runthreads();

    destroy_semaphore(counter_mutex);

    // /* Print threads informations after run */
    mythread_state();

     printf("The counter is %d\n", counter);
    printf("The result is %f\n", result);

   if (counter == 50 &&
     (result - 151402.656521) < 0.000001)
       printf(">>> Thread library PASSED the Test 1\n");

    exit(0);
}

void handler ()
{
    int i;
    for(i=0; i < 5; i++)
    {
        /* If you remove this protection, you should be able to see different
         * out of every time you run this program.  With this protection, you
         * should always be able to see result to be 151402.656521 */
        semaphore_wait(counter_mutex);       /* down semaphore */

        /* START CRITICAL REGION */
        int j;
        for (j = 0; j < 1000; j++) {
            result = result + sin(counter) * tan(counter);
        }
        counter++;
        /* END CRITICAL REGION */    

        semaphore_signal(counter_mutex);       /* up semaphore */
    }
    mythread_exit(); /* exit thread */
} 
```

我的线程.h

```
#ifndef __MY_THREADS_H__
#define __MY_THREADS_H__

#include <signal.h>
#include <string.h>
#include <time.h>
#include <sys/time.h>
#include <sys/timeb.h>
#include <ucontext.h>
#include <slack/std.h>
#include <slack/list.h>

#define THREAD_NAME_LEN 32
#define THREAD_MAX 128
#define SEMAPHORE_MAX 128
#define THREAD_STACK_SIZE 4096
#define QUANTUM_N_SIZE 60000

enum ThreadState {
  NOTCREATED,
  RUNNING,
  RUNNABLE,
  BLOCKED,
  EXIT
};

typedef struct ControlBlock_t {
  ucontext_t context;
  char thread_name[THREAD_NAME_LEN];
  int thread_id;
  enum ThreadState state;
  struct timespec start;
  struct timespec end;
  double run_time;
  void *stack;
} ControlBlock;

typedef struct Semaphore_t {
  List * thread_queue;
  int value;
  int initial;
  int active;
} Semaphore;

int mythreads_init();
int mythread_create(char *threadname, void (*threadfunc)(), int stacksize);
void mythread_exit();
int mythread_id();
void runthreads();
void set_quantum_size(int quantum);
int create_semaphore(int value);
void semaphore_wait(int semaphore);
void semaphore_signal(int semaphore);
void destroy_semaphore(int semaphore);
void mythread_state();
void evict_thread();
void scheduler();

#endif /* __MY_THREADS_H__ */ 
```

我的线程.c

```
#include <stdio.h>
#include <signal.h>
#include <unistd.h>
#include <slack/std.h>
#include <slack/list.h>
#include "mythreads.h"

static ControlBlock tcbTable[THREAD_MAX];
static Semaphore semTable[SEMAPHORE_MAX];
static List * runqueue;
static ControlBlock * current_thread;
static int threadId = 0;
static int runningThreadId = 0;
static ucontext_t uctx_main;
static int quantum_size;
struct itimerval timer;
static int current_threads;
static int my_threads_init;
static int current_semaphores;
static int done = 0;
static int totalThreadsCreated = 0;
static int totalThreadsExited = 0;
long long int switch_ctr;
int i=0;

/*
This function initializes all the globa data structures for the thread system
*/
int mythread_init(){
  int i=0;

  //Initialize the run queue.
  runqueue = list_create(NULL);

  //Initialize the thread control table.
  for(i = 0;i < THREAD_MAX;i++){
    tcbTable[i].state = NOTCREATED;
  }

  //Initialize the semaphore table.
  for(i = 0;i < SEMAPHORE_MAX;i++){
    semTable[i].active = 0;
  }
}

int mythread_create(char *threadName, void(*threadfunc)(), int stacksize){
  //Set basic information about the thread.
  strcpy(tcbTable[threadId].thread_name, threadName);
  tcbTable[threadId].thread_id = threadId;
  tcbTable[threadId].state = RUNNABLE;

  //Set the context information about the thread.
  getcontext(&tcbTable[threadId].context); //Save the current context.
  tcbTable[threadId].context.uc_link = &uctx_main; //The context that will be resumed when the current context exits.
  tcbTable[threadId].stack = malloc(stacksize);
  tcbTable[threadId].context.uc_stack.ss_sp = tcbTable[threadId].stack; //Allocate the stack and make it point to the beginning of the stack.
  tcbTable[threadId].context.uc_stack.ss_size = stacksize; //Set the signal stack size.
  makecontext(&tcbTable[threadId].context,threadfunc,0); //Creates the context with the information set above.

  //Add thread to the runqueue.
  runqueue = list_append_int(runqueue,threadId);
  totalThreadsCreated++;

  //If an error occured, return -1\. Otherwise, return the  thread id.
  if(!tcbTable[threadId].context.uc_stack.ss_sp){
    //We failed to allocate memory for the stack
    printf("Failed to allocate memory for the stack\n");
    fflush(stdout);
    return -1;
  }else{
    int tmp = threadId;
    threadId++;
    return tmp;
  }
}

/*
This function is called at the end of the function that was 
invoked by the thread.
*/
void mythread_exit(){
  sigset_t x;
  sigemptyset(&x);
  sigaddset(&x, SIGALRM);
  sigprocmask(SIG_BLOCK, &x, NULL);
  printf("Setting state of thread %d to EXIT.\n",runningThreadId);
  fflush(stdout);
  tcbTable[runningThreadId].state = EXIT; //Set the state of the thread to EXIT.
  totalThreadsExited++;
  if(totalThreadsCreated == totalThreadsExited){
    done = 1;
  }
  sigprocmask(SIG_UNBLOCK, &x, NULL);
}

/*
Starts running one of the threads in the runqueue.
*/
void runthreads(){
   /* Block Signals */
    sigset_t x;
    sigemptyset(&x);
    sigaddset(&x, SIGALRM);
    sigprocmask(SIG_BLOCK, &x, NULL);

    struct itimerval timer;
    timer.it_interval.tv_sec = 0;
    timer.it_interval.tv_usec = quantum_size;
    timer.it_value.tv_sec = 0;
    timer.it_value.tv_usec = quantum_size;
    setitimer(ITIMER_REAL, &timer, 0);

    sigset(SIGALRM, &scheduler);
    runningThreadId = list_shift_int(runqueue);

    tcbTable[runningThreadId].state = RUNNING;

    //begin_time(running_thread);

    /* Unblock signal */
    sigprocmask(SIG_UNBLOCK, &x, NULL);

    if(swapcontext(&uctx_main, &tcbTable[runningThreadId].context) == -1) {
        perror("swapcontext error");
        exit(1);
    }

    while(!list_empty(semTable[0].thread_queue) || (totalThreadsExited<totalThreadsCreated));

    sigprocmask(SIG_BLOCK, &x, NULL);
    for(i = 0; i < 10 ; i++) {
        tcbTable[i].state = EXIT;
    }
    printf("Back in main\n");
    fflush(stdout);
}

void set_quantum_size(int size){
  quantum_size = size;
}

/*
  Called when the ALRM signal fires
*/
void scheduler(){
    switch_ctr++;
   if (list_empty(runqueue) && tcbTable[runningThreadId].state == EXIT) {
        printf("returning to main");
        fflush(stdout);
        setcontext(&uctx_main);
    }

    if (!list_empty(runqueue) ) {
      sigset_t x;
      sigemptyset(&x);
      sigaddset(&x, SIGALRM);
      sigprocmask(SIG_BLOCK, &x, NULL);

      int old_running_thread = runningThreadId;
      runningThreadId = list_shift_int(runqueue);

      if (tcbTable[old_running_thread].state == RUNNABLE || tcbTable[old_running_thread].state == RUNNING) {
          runqueue = list_append_int(runqueue, old_running_thread);
      }

      sigprocmask(SIG_UNBLOCK, &x, NULL);

      if (swapcontext(&tcbTable[old_running_thread].context, &tcbTable[runningThreadId].context) == -1) {
          printf("swapcontext error");
          fflush(stdout);
      }
    }
}

int create_semaphore(int val){
  if (current_semaphores == SEMAPHORE_MAX){
    //We already have the maximum number of semphores allowed 
    //so we cannot create new ones.
    return -1;
  }else{
    semTable[current_semaphores].initial = val;
    semTable[current_semaphores].value = val;
    semTable[current_semaphores].thread_queue = list_create(NULL);
    int tmp = current_semaphores;
    current_semaphores++;
    return tmp;
  }
}

/*
  Called by the handler() funcion in my-test.c
*/
void semaphore_wait(int semaphore){
    sigset_t x;
    sigemptyset(&x);
    sigaddset(&x, SIGALRM);
    sigprocmask(SIG_BLOCK, &x, NULL);

    long long int old_switch_ctr = switch_ctr; 
    (semTable[semaphore]).value--;

    if((semTable[semaphore]).value<0) {
        (tcbTable[runningThreadId]).state = BLOCKED;
        (semTable[semaphore]).thread_queue = list_append_int((semTable[semaphore]).thread_queue,runningThreadId);
    }

    sigprocmask(SIG_UNBLOCK,&x,NULL);
    while(old_switch_ctr==switch_ctr);
}

/*
  Called by the handler() funcion in my-test.c
*/
void semaphore_signal(int semaphore){
    // Block Signals
    sigset_t x;
    sigemptyset (&x);
    sigaddset(&x, SIGALRM);
    sigprocmask(SIG_BLOCK, &x, NULL);

    /* Increase Semaphore value */
    semTable[semaphore].value = semTable[semaphore].value + 1;

    if (semTable[semaphore].value < 1) {
        int should_run;
        should_run = list_shift_int(semTable[semaphore].thread_queue);
        tcbTable[should_run].state = RUNNABLE;
        runqueue = list_append_int(runqueue, should_run);
    } 

    // Unblock Signals
    sigprocmask(SIG_UNBLOCK, &x, NULL);
    scheduler();
}

void destroy_semaphore(int semaphore){
  if(!list_empty(semTable[semaphore].thread_queue)){
    fprintf(stderr, "There are threads waiting on this semaphore. Thus, it cannot be destroyed\n");
    return;
  }
}

void mythread_state()
{
    printf("\nTHREADNAME\tTHREAD\tTHREAD STATE\tCPU TIME(ns)\n"); 
    fflush(stdout);
    int i;
    for(i = 0; (tcbTable[i].state != NOTCREATED) && (i < THREAD_MAX); ++i) {
        char * state_i;
        switch(tcbTable[i].state) {
            case 0:
                state_i = "NOTCREATED";
                break;
            case 1:
                state_i = "RUNNING";
                break;
            case 2:
                state_i = "RUNNABLE";
                break;
            case 3:
                state_i = "RUNNABLE";
                break;
            case 4:
                state_i = "EXIT";
                break;
            default:
                state_i = "UNDEFINED";
                break;
        }
        printf("\n%s\t%d\t%s\t\t%la\n", tcbTable[i].thread_name, i, state_i, tcbTable[i].run_time); 
    }
} 
```

# java - 具有透明背景和内容的 JScrollPane

> ID：15422854
> 
> 赞同：5
> 
> 时间：2013-03-15T00:48:35.893
> 
> 标签：java, swing, transparency, paint

在我的应用程序中，我显示了一个弹出对话框以显示大量卡片。我将它们显示为子类中许多`JLabel`组件中的图像`JPanel`。然后我把那个对象放在一个`JScrollPane`允许水平滚动卡片的地方。

我希望未使用的空间在深色背景下是透明的，以显示其背后的内容已被禁用。我`setBackground(new Color(50, 50, 50, 200))`以前实现了我想要的样子，但是后面的内容没有重绘，所以我得到了神器。

这是它的样子：

![滚动时出现伪影](../Images/d4f7cab87a840f3d2a77b848261ba1a4.png)

我将如何解决这个问题？当我滚动时，如何让它后面的内容重绘？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T01:06:27.483

暂时将窗口排除在等式之外。

`JScrollPane`包含一个然后`JViewport`包含您的内容。因此，您需要将内容窗格设置为透明，将视口设置为透明，然后将滚动窗格设置为透明。

您可以通过`setOpaque(false)`在每个容器上使用来实现这一点。

这将确保重绘管理器现在将通过背景进行绘制。

下一个问题是，Swing 实际上并不支持“半透明”组件（也就是说，它要么是不透明的，要么是透明的）。

您可以通过覆盖`paintComponent`主要组件的方法来实现这一点（视口上的那个可能就足够了）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:54:57.847

尝试以下...可能会让您在滚动过程中有所缓解。当主框架最大化或恢复时，您可能也会遇到问题。您将需要这些事件的侦听器和类似的修复程序。

```
 jScrollPane.getVerticalScrollBar().addAdjustmentListener(new AdjustmentListener() {
        @Override
        public void adjustmentValueChanged(final AdjustmentEvent e) {
            sevenWondersframe.repaint();
        }
    });
    jScrollPane.getHorizontalScrollBar().addAdjustmentListener(new AdjustmentListener() {
        @Override
        public void adjustmentValueChanged(final AdjustmentEvent e) {
            sevenWondersframe.repaint();
        }
    }); 
```

# python - Python：使用代码编写代码 - 适合初学者

> ID：15422858
> 
> 赞同：2
> 
> 时间：2013-03-15T00:49:17.563
> 
> 标签：python, pygame, getattr

我现在遇到的问题是将一堆声音文件作为它们自己的对象加载到 Pygame 中。您可以使用以下语法加载声音：

```
sound1 = pygame.mixer.Sound('file.wav') 
```

假设我有七个文件，我希望将它们加载并命名为 sound1 - sound7。而且我不想单独加载它们。如果我不知道它有缺陷，我会尝试这样的事情：

```
for i in range(1, 8):
    new = 'sound' + str(i)
    new = pygame.mixer.Sound(str(new) + 'wav') 
```

我将如何着手使“新”成为自己的变量，而不是字符串？我读过关于 getattr 的文章，但它令人困惑。我真的很想知道如何使用函数和循环来动态创建代码，但到目前为止，我找不到对像我这样的初学者有用的东西。以此为例，有人愿意以简单的方式解释在代码中创建代码并将字符串转换为可用变量/对象的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T00:51:50.840

```
sounds = [] # list
for i in range(1, 8):
    sounds.append(pygame.mixer.Sound('sound' + str(i) + 'wav')) 
```

或者

```
sounds = {} # dictionary
for i in range(1, 8):
    sounds[i] = pygame.mixer.Sound('sound' + str(i) + 'wav') 
```

起初，您似乎使用与列表方法相同的字典方法，例如声音[1] 声音[2] 等等，但您也可以这样做：

```
sounds = {} # dictionary
for i in range(1, 8):
    sounds['sound' + str(i)] = pygame.mixer.Sound('sound' + str(i) + 'wav') 
```

例如，现在 sound["sound1"] 等工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T00:52:04.937

您可以为此使用数组：

```
sound = []
for i in range(1,8):
    sound.append (pygame.mixer.Sound("sound%d.wav" % i))
# Now use sound[0..6] to reference sound[1..7].wav 
```

这将加载文件- 如果您`sound1.wav`的`sound8.wav`文件命名不同，您只需更改范围和/或字符串格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T06:17:03.780

python中有两种循环，for循环和while循环。for 循环用于重复某件事 n 次。while循环用于重复直到发生某些事情。For-loops 对于游戏编程很有用，因为它们经常处理游戏显示的帧。每一帧通过一个循环运行一次。存储 for 循环的方式是使用列表。这是您可以熟悉的基本循环的示例：

```
he_count = [1, 2, 3, 4, 5]
fruits = ['apples', 'oranges', 'pears', 'apricots']
change = [1, 'pennies', 2, 'dimes', 3, 'quarters']

# this first kind of for-loop goes through a list
for number in the_count:
    print "This is count %d" % number

# same as above
for fruit in fruits:
    print "A fruit of type: %s" % fruit

# also we can go through mixed lists too
# notice we have to use %r since we don't know what's in it
for i in change:
    print "I got %r" % i

# we can also build lists, first start with an empty one
elements = []

# then use the range function to do 0 to 5 counts
for i in range(0, 6):
    print "Adding %d to the list." % i
    # append is a function that lists understand
    elements.append(i)

# now we can print them out too
for i in elements:
    print "Element was: %d" % i 
```

您可以在此处了解有关 Python 循环和游戏编程的更多信息： [programarcadegames.com/index.php ?lang=en&chapter=loops](http://programarcadegames.com/index.php?lang=en&chapter=loops)

# windows-8 - 为什么 GetBasicPropertiesAsync() 有时会抛出异常？

> ID：15422870
> 
> 赞同：1
> 
> 时间：2013-03-15T00:50:45.203
> 
> 标签：windows-8, windows-runtime, dotnetzip

在 Windows8 中，我正在尝试使用 GetBasicPropertiesAsync() 来获取新创建文件的大小。 *有时*，但并非总是（约 25% 的时间），此调用会给出以下例外：

```
"Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED))". 
```

该文件是使用 DotNetZip 创建的。我正在将数千个文件添加到需要几分钟才能运行的存档中：

```
using (ZipFile zip = new ZipFile())
{
    zip.AddFile(...); // for thousands of files
    zip.Save(cr.ArchiveName);
}
var storageFile = await subFolder.GetFileAsync(cr.ArchiveName);  
// storageFile is valid at this point
var basicProperties = await storageFile.GetBasicPropertiesAsync(); // BOOM! 
```

一些明显随机的事情似乎降低了异常的可能性：

1.  在循环开始之前删除 cr.ArchiveName 的现有副本。
2.  不使用文件资源管理器查看目录

很奇怪吧？闻起来可能是与[文件系统隧道](https://stackoverflow.com/questions/14133560/replacing-or-recreating-a-file-in-windows-8-rt-keeps-the-old-datecreated-value/14141829#14141829)有关的错误，或者可能是 DotNetZip 正在执行并保留资源（可能重命名 TEMP 文件）的一些内部缓存，即使在 ZipFile 被处置后？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T15:07:17.297

试图（不成功）回答我自己的问题。

起初，我认为这是一个已知问题，因为 DotNetZip 在下一次垃圾回收之前一直保留文件句柄。我正在使用来自[http://slsharpziplib.codeplex.com/](http://slsharpziplib.codeplex.com/)的 DotNetZip 的 SL/WP7 端口，它可能不包括此工作项修复的错误：

[http://dotnetzip.codeplex.com/workitem/12727](http://dotnetzip.codeplex.com/workitem/12727)

但是，根据那个理论，做：

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

应该提供一种解决方法，但它没有。

接下来我尝试使用**handle**，它没有在失败的 StorageFile 上显示任何其他活动。

所以现在，我仍然很难过。

# java - 我应该使用哪种 java swing 布局

> ID：15422871
> 
> 赞同：2
> 
> 时间：2013-03-15T00:50:49.460
> 
> 标签：java, swing, layout, layout-manager

我需要创建这个框架：

![](../Images/b3b6a8f664dca7ea5becfd4f9ef92de4.png)

我应该使用哪种布局？我正在考虑框或网格布局，但右侧的菜单将是一个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-15T01:31:39.517

您的代码中有很多重复。我会分解每个部分并使其成为一个单独的组件，并专注于它的个别布局需求。

![在此处输入图像描述](../Images/1072aa224afebaf5bebb7fbaeef1ac7c.png)

在您的主屏幕中，您有 4 个主要区域（不包括菜单）。

我会使用类似的东西`GridBagLayout`来布局这 4 个部分。这允许每个部分都能够增长到所需的高度，而不会影响其他部分。您还可以根据需要为每个部分提供单独的成长提示。

第一部分是 a `JLabel`，所以很简单

![在此处输入图像描述](../Images/536bb3f6735a85ac50ed1d7b1dfa0232.png)

这部分基本上是三个标签，对齐方式略有不同。我仍然会使用 a `GridBagLayout`，因为它提供了最大的灵活性以允许单个单元格对齐，同时允许您提供大小调整提示（例如，我可能会在屏幕大小更改时将时间行设为宽度）。

![在此处输入图像描述](../Images/4531575ee64374a8d0e1070df0da95ac.png)

这部分有点复杂。基本上，它是左右相同的组件，具有一些巧妙的属性，您可以更改标签的位置而不会出现太大问题。

单个点/标签可以使用`GridLayout`. 我可能会谨慎行事并使用 a `GridBagLayout`，因为它允许标签与点的大小不同

然后我会使用类似 a 的东西`GridLayout`将每一面放置到一个组件上（然后将其放置在主屏幕上）

![在此处输入图像描述](../Images/d9c30c2652a97793e6066f6bd1296900.png)

再次，这个简单的相同组件镜像。我只需创建一个可以通过属性调整的单个组件来更改对齐方式。

然后我会简单地使用 a`GridBagLayout`来根据需要布置每个标签。我会这样做，因为它允许每一行都有自己的高度。

我在空手道方面也有 15 年的转介经验。我可以来为你工作吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:11:36.847

如果您使用`AWT`布局，[`GridBagLayout`](http://docs.oracle.com/javase/6/docs/api/java/awt/GridBagLayout.html)则可以为您提供最大的控制权。

![在此处输入图像描述](../Images/7109a373b6a54c59051e36fba9d7d67c.png)

[我从 java2s.com](http://www.java2s.com/Tutorial/Java/0240__Swing/UsingGridBagConstraints.htm)的示例中采用了以下功能。

```
/**  
 * A helper method to add Components to a Container
 * using GridBagLayout  
 */  
private static void addComponent(Container container,
  Component component, int gridX, int gridY,
  int gridWidth, int gridHeight, int anchor, int fill)
{
  Insets insets = new Insets(0, 0, 0, 0);
  GridBagConstraints gbc = new GridBagConstraints(
    gridX, gridY, gridWidth, gridHeight, 1.0, 1.0,
    anchor, fill, insets, 0, 0
  );
  container.add(component, gbc);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-15T09:12:11.987

忘记基本布局，尤其是`GridBagLayout`，看看[MigLayout](http://www.miglayout.com)，这将为您省去很多麻烦。

# c - GTK+ 使用前景色将位图绘制为蒙版

> ID：15422873
> 
> 赞同：0
> 
> 时间：2013-03-15T00:51:03.087
> 
> 标签：c, gtk, gdkpixbuf

我已经制作了一个自定义字体作为存储在 XPM 图像中的位图，并且希望能够使用可更改的前景色将其绘制到 GdkDrawable 对象。基本上，我想要的是使用图像作为字体并能够更改颜色。任何建议如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T04:02:05.177

这并不完全是我最初想要的解决方案，但它是一个解决方案，它必须这样做，直到出现更好的解决方案。

```
/* XPM-image containing font consist of 96 (16x6) ASCII-characters starting with space. */
#include "font.xpm"

typedef struct Font {
    GdkPixbuf *image[16]; /* Image of font for each colour. */
    const int width; /* Grid-width. */
    const int height; /* Grid-height */
    const int ascent; /* Font ascent from baseline. */
    const int char_width[96]; /* Width of each character. */
} Font;

typedef enum TextColor { FONT_BLACK,FONT_BROWN,FONT_YELLOW,FONT_CYAN,FONT_RED,FONT_WHITE } TextColor;
typedef enum TextAlign { ALIGN_LEFT,ALIGN_RIGHT,ALIGN_CENTER } TextAlign;

Font font = {
    {0},
    7,9,9,
    {
        5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
        5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
        5,5,5,5,5,5,5,5,5,5,5,5,5,6,5,5,
        5,5,5,5,5,5,5,6,5,5,5,5,5,5,5,5,
        5,5,5,5,5,5,5,5,5,5,5,5,5,6,5,5,
        5,5,5,5,5,5,5,6,5,5,5,5,5,5,5,5,
    }
};

void load_font(Font *font,const char **font_xpm) {
    const char *colors[] = { /* It's not complicated to adjust for more elaborate colour schemes. */
        ".  c #000000", /* Black */
        ".  c #3A2613", /* Brown */
        ".  c #FFFF00", /* Yellow */
        ".  c #00FFFF", /* Cyan */
        ".  c #FF0000", /* Red */
        ".  c #FFFFFF", /* White */
    NULL};
    int i;
    memset(font->image,0,sizeof(GdkPixbuf *)*16);
    for(i=0; colors[i]!=NULL; ++i) {
        font_xpm[2] = colors[i]; /* Second colour is assumed to be font colour. */
        font->image[i] = gdk_pixbuf_new_from_xpm_data(font_xpm);
    }
}

int draw_string(Font *font,int x,int y,TextAlign align,TextColor color,const char *str) {
    int i,w = 0;
    const char *p;
    for(p=str; *p; ++p) i = *p-' ',w += i>=0 && i<96? font->char_width[i] : 0;
    if(align==ALIGN_RIGHT) x -= w;
    else if(align==ALIGN_CENTER) x -= w/2;
    for(p=str; *p; ++p) {
        i = *p-' ';
        if(i>=0 && i<96) {
            gdk_draw_pixbuf(pixmap,gc,font->image[(int)color],(i%16)*font->width,(i/16)*font->height,x,y,font->char_width[i],font->height,GDK_RGB_DITHER_NONE,0,0);
            x += font->metrics[i];
        }
    }
    return x;
} 
```

# android - android 应用程序无法获取连接工厂客户端

> ID：15422880
> 
> 赞同：1
> 
> 时间：2013-03-15T00:51:28.723
> 
> 标签：android, google-maps, mapactivity

我正在为 android 开发应用程序并将 MapActivity 用于谷歌地图。但我收到错误 "Couldnt get connection factory client" 。我为此错误探索了几个线程，但无法得到任何令人满意的答案。这是我的代码：

清单.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="wsu.cs558.roadmonitoring.view"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="10"
    android:targetSdkVersion="17" />

<!--
      <permission
        android:name="wsu.cs558.roadmonitoring.view.permission.MAPS_RECEIVE"
        android:protectionLevel="signature"/>
-->

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
<!-- <uses-permission android:name="wsu.cs558.roadmonitoring.view.permission.MAPS_RECEIVE"/> -->

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MapViewActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <uses-library android:name="com.google.android.maps" />

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="AIzaSyCyT7IoMyt5iqRAd2mhO2m50dBecCc59YI" />
</application> 
```

主要的.xml

```
<RelativeLayout 
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:orientation="vertical" 
 android:layout_width="fill_parent"
 android:layout_height="fill_parent">

 <com.google.android.maps.MapView
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map_view"
 android:layout_width="fill_parent" 
 android:layout_height="fill_parent"
 android:clickable="true" 
  android:enabled="true" 
  android:apiKey="AIzaSyCyT7IoMyt5iqRAd2mhO2m50dBecCc59YI" />

 </RelativeLayout> 
```

MapViewActivity.java

```
 package wsu.cs558.roadmonitoring.view;

 public class MapViewActivity extends MapActivity {

private MapView mapView;
private static final int latitudeE6 = 37985339;
private static final int longitudeE6 = 23716735;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    mapView = (MapView) findViewById(R.id.map_view);
    mapView.setBuiltInZoomControls(true);

}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

} 
```

我在模拟器中使用时遇到了同样的错误，所以现在我正在使用我的移动设备来运行该应用程序。我得到同样的错误。我正在使用 Google API (2.3.3) 作为构建目标。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-16T00:52:39.030

好的，我自己得到了答案。但我真的不得不挖掘很多。问题是因为 Google Map Api 版本。我使用的代码仅适用于已弃用的 Api V1。因此，您必须在版本 1 下注册您的应用并在 android manifest 中使用该密钥或使用 Fragment（版本 2 android 地图代码）来解决此问题。我希望其他人在之前或任何其他线程中回答过这个问题。

无论如何享受。

# c# - 如何在 Web 应用程序中获取和设置持久变量服务器端

> ID：15422881
> 
> 赞同：0
> 
> 时间：2013-03-15T00:51:30.720
> 
> 标签：c#, asp.net, visual-studio-2010

我试图在服务器端保存一个简单的 int 然后任何用户都可以登录并更新它。我认为这将是一项简单的任务，并开始尝试使用设置设计器，但是我无法将范围从“应用程序”更改为“用户”，因为应用程序设置是只读的。

我知道我可以保存和更改 XML 文件中的变量，但我认为必须有更简单的方法。

我曾尝试使用用户配置文件，但它没有任何想法？（我也使用了 Context.Profile。）

```
<profile>
  <providers>
    <clear/>
    <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/"/>
  </providers>
  <properties>
    <add name="FilmNumber" type="int" allowAnonymous="true" defaultValue="2"/>
  </properties>
</profile> 
```

代码：

```
//********Get poster Number*******
int LastPosterNumber=0;
LastPosterNumber = (int)HttpContext.Current.Profile.GetPropertyValue("FilmNumber");

string strFileName;
strFileName = FileField.PostedFile.FileName;
string c = (LastPosterNumber + 1).ToString();
string dirPath = System.Web.HttpContext.Current.Server.MapPath("~") + "/Images/FilmPosters/" + c + ".jpg";
FileField.PostedFile.SaveAs(dirPath);

//******Save new poster number*******
HttpContext.Current.Profile.SetPropertyValue("FilmNumber", int.Parse(c));
HttpContext.Current.Profile.Save(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:02:23.023

尽量避免设置，因为它们要求您的配置文件是可修改的，而且 ASP.NET 中的“用户设置”概念也不存在，因为应用程序始终在 W3C 工作进程的用户上下文下运行 - .NET 设置 API 不是了解 ASP.NET 成员资格或“用户”的其他概念。

您最好的选择是在您的应用程序中使用 DBMS、`Application`状态或静态字段（如果它不需要在生命周期之外持久化`w3wp.exe`）或磁盘上的文件，您不必使用 XML 序列化，您可以手动写出来（一定要先锁定文件，因为 ASP.NET 应用程序是多线程的）。

在我的应用程序中，我只将连接字符串和最少的初始化设置`web.config`存储在每个用户的设置中，我存储在数据库表中并为此编写一个简单的 API 层（通常使用应用程序设置和继承或“ `EffectiveSettings`”）。请注意，这与 .NET 的 Settings API 完全不同（就实现而言），出于各种原因，我完全避免使用它，包括已在此答案中公布的那些。

### 关于 IIS w3wp.exe 生命周期的注意事项：

由于各种原因，IIS 将随时终止或“回收”w3wp.exe，这就是为什么您的 ASP.NET 应用程序必须在最近的机会持久保存到长期存储，并且任何内存中的状态都将丢失。原因包括：

*   不活动。如果应用程序池工作进程在至少 45 分钟（左右）内未处理请求，IIS 将关闭该进程。
*   回收。IIS 通过每 90 分钟左右（或者可能是 29 小时，我不确定）终止并重新启动它们来对泄漏资源的工作进程采取先发制人的措施。
*   反应迟钝。IIS 为工作进程提供了一个严格的超时来响应传入的请求，我认为默认值为 60 秒。如果没有向客户端发送响应，则该过程将重新启动。
*   达到内存限制。与上述基于时间的自动回收类似，如果工作进程达到内存限制（这就是管理资源很重要的原因），IIS 将重新启动工作进程。
*   达到请求限制。同样，类似于基于时间的自动回收，IIS 将在其里程表读取 X 多个请求后重新启动工作进程。默认情况下禁用此功能，但您的 ISP 可能已启用它。

# android - Android Beta 的远程日志记录

> ID：15422890
> 
> 赞同：2
> 
> 时间：2013-03-15T00:53:17.453
> 
> 标签：android, logging, testflight

有没有一种工具可以为 Android 应用程序进行 android 远程日志记录，有点像 Testflight 的[IO](http://help.testflightapp.com/customer/portal/articles/840057-how-do-i-implement-remote-logging-)工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T01:19:47.960

我发现[Deploy Gate](https://deploygate.com)对我很有帮助。

您可以进行远程登录，还可以跟踪应用程序启动、崩溃报告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T01:01:46.927

此外，TestFlight 即将推出对 Android 的支持：[https](https://testflightapp.com/android/) ://testflightapp.com/android/因此您可能希望注册以在他们这样做时得到通知。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T00:57:47.570

我在我的项目中使用了 ACRA，并取得了巨大的成功。您可以在以下网址找到它：[http](http://acra.ch/) ://acra.ch/ 它在调试过程中使用时效果很好，但我在发布之前将其删除。

它可以配置为自动发送崩溃报告，如果应用程序进入特定状态，通过触发器（如用户可以按下的按钮）或你有什么。出于我的目的，我通常让它在崩溃时触发，如果测试人员觉得应用程序在做一些奇怪的事情，但没有崩溃，我会在菜单中添加一个选项来发送强制调试报告。

# python - numpy -- 将不连续的数据原地转换为连续的数据

> ID：15422895
> 
> 赞同：6
> 
> 时间：2013-03-15T00:54:05.147
> 
> 标签：python, numpy

考虑以下代码：

```
import numpy as np
a = np.zeros(50)
a[10:20:2] = 1
b = c = a[10:40:4]
print b.flags  # You'll see that b and c are not C_CONTIGUOUS or F_CONTIGUOUS 
```

我的问题：

有没有办法（仅参考`b`）使两者都`b`连续`c`？如果在此操作后`np.may_share_memory(b,a)`返回完全可以。`False`

接近但不太成功的事情是： `np.ascontiguousarray`/`np.asfortranarray`因为它们将返回一个*新*数组。

* * *

我的用例是我有非常大的 3D 字段存储在`numpy.ndarray`. 为了节省内存，我想将这些字段分解为我真正感兴趣的域部分：

```
a = a[ix1:ix2,iy1:iy2,iz1:iz2] 
```

对子类的切片比对`ndarray`对象的切片更受限制，但这应该可以工作并且它会“做正确的事情”——附加在子类上的各种自定义元数据将按预期进行转换/保存。不幸的是，由于这返回 a `view`， numpy 之后不会释放大数组，所以我实际上并没有在这里保存任何内存。

为了完全清楚，我希望完成两件事：

*   保留我的类实例上的元数据。切片会起作用，但我不确定其他形式的复制。
*   使原始数组可以自由地被垃圾收集

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-15T00:59:29.647

[根据 Alex Martelli 的说法](https://stackoverflow.com/questions/1316767/how-can-i-explicitly-free-memory-in-python/1316799#1316799)：

> “确保大量但临时使用内存在完成后将所有资源返回给系统的唯一真正可靠的方法是让这种使用发生在子进程中，该子进程会执行需要内存的工作然后终止。”

但是，以下内容*似乎*至少释放了一些内存：警告：我测量可用内存的方法是 Linux 特定的：

```
import time
import numpy as np

def free_memory():
    """
    Return free memory available, including buffer and cached memory
    """
    total = 0
    with open('/proc/meminfo', 'r') as f:
        for line in f:
            line = line.strip()
            if any(line.startswith(field) for field in ('MemFree', 'Buffers', 'Cached')):
                field, amount, unit = line.split()
                amount = int(amount)
                if unit != 'kB':
                    raise ValueError(
                        'Unknown unit {u!r} in /proc/meminfo'.format(u=unit))
                total += amount
    return total

def gen_change_in_memory():
    """
    https://stackoverflow.com/a/14446011/190597 (unutbu)
    """
    f = free_memory()
    diff = 0
    while True:
        yield diff
        f2 = free_memory()
        diff = f - f2
        f = f2
change_in_memory = gen_change_in_memory().next 
```

在分配大数组之前：

```
print(change_in_memory())
# 0

a = np.zeros(500000)
a[10:20:2] = 1
b = c = a[10:40:4] 
```

分配大数组后：

```
print(change_in_memory())
# 3844 # KiB

a[:len(b)] = b
b = a[:len(b)]
a.resize(len(b), refcheck=0)
time.sleep(1) 
```

调整大小后可用内存增加：

```
print(change_in_memory())
# -3708 # KiB 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T02:41:10.540

您可以在 cython 中执行此操作：

```
In [1]:
%load_ext cythonmagic

In [2]:
%%cython
cimport numpy as np

np.import_array()

def to_c_contiguous(np.ndarray a):
    cdef np.ndarray new
    cdef int dim, i
    new = a.copy()
    dim = np.PyArray_NDIM(new)
    for i in range(dim):
        np.PyArray_STRIDES(a)[i] = np.PyArray_STRIDES(new)[i]
    a.data = new.data
    np.PyArray_UpdateFlags(a, np.NPY_C_CONTIGUOUS)
    np.set_array_base(a, new)

In [8]:
import sys
import numpy as np
a = np.random.rand(10, 10, 10)
b = c = a[::2, 1::3, 2::4]
d = a[::2, 1::3, 2::4]
print sys.getrefcount(a)
to_c_contiguous(b)
print sys.getrefcount(a)
print np.all(b==d) 
```

输出是：

```
4
3
True 
```

`to_c_contiguous(a)`将创建 的 c_contiguous 副本`a`，并将其作为`a`.

调用后`to_c_contiguous(b)`，a 的 refcount 会减少，当 a 的 refcount 变为 0 时，它会被释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T09:10:47.430

我会声称完成您列出的两件事的正确方法是通过`np.copy`您创建的切片。

当然，为了使其正常工作，您需要定义一个适当的`__array_finalize__`. 你不是很清楚为什么你决定首先避免它，但我的感觉是你应该定义它。（你是如何在`bx**2`不使用的情况下解决问题的`__array_finalize__`？）

# c++ - 此代码在我的计算机上编译并运行但不在服务器上

> ID：15422897
> 
> 赞同：0
> 
> 时间：2013-03-15T00:54:09.740
> 
> 标签：c++, unix, syntax, compiler-construction

我使用代码块编写了一个 C++ 程序，在最后一刻我决定使用 empress，这是我们用来做实验室的学校服务器，结果发现它不起作用！这意味着什么？我的程序不对吗？还是可能是编译器问题？我通常使用 linux ubuntu 使用代码块来进行编程。我使用 Windows 测试了该程序，它也可以工作。为什么它不在服务器上运行？

这是我认为导致问题的代码：

```
bool dictionary::insertWordsIntoDict(string fileName)
{

   ifstream inp;
   string word;
   vector<string> vec;
   inp.open(fileName.data());

   if(inp.good())
   {

     while(!inp.eof())
     {
      inp>>word;
      vec.push_back(word);

     }
    string temp;
    string temp2= "#.txt";

     for(int i=0 ; i<vec.size() ; i++)
     {
          temp = vec[i];
          temp2[0] = tolower(temp[0]);
          cout<<temp<<endl;
          AddWord(temp.data(), temp2);
     }

   }//end of if statement

  else
  {
     cout<<":(  File does not exist! "<<endl;
     return failure;
  }

}// end of function insert words 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:17:44.890

`while(!inp.eof())`不是从文件中读取的好方法。*特别是，如果它由于 EOF 以外的其他*原因无法读取，则条件永远不会为假，并且您的循环将永远运行。

编写这种循环的正确方法是：

```
while(inp >> word)
 {
  vec.push_back(word);
 } 
```

在这里，如果由于任何原因无法从输入流中读取，`inp >> word`将评估为 false 。`word`

如果没有更多细节，我不能确定这是你的问题，但它不会受到伤害。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:17:56.800

好吧，至少有一个问题，您`eof`在循环条件中使用，您应该像这样修改：

```
while( inp >> word)
 {
  vec.push_back(word);

 } 
```

这个先前的线程涵盖了[为什么循环条件内的 iostream::eof 被认为是错误的？](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong).

# ios - 如何在键盘上但在 UIAlertView 下显示 UIWindow

> ID：15422898
> 
> 赞同：1
> 
> 时间：2013-03-15T00:54:14.053
> 
> 标签：ios, uiwindow

我想`UIWindow`在键盘上显示一个，然后`UIAlertView`在请求“使用您当前位置”的权限时允许显示在窗口上方显示。

将窗口设置为`windowLevel`在`UIWindowLevelAlert`键盘上方显示它，然后警报视图显示在窗口下方。因此，`UIWindowLevelAlert`必须是比警报视图更高的窗口级别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T00:55:21.557

在 iOS 6.1中将窗口设置为`windowLevel`我`UIWindowLevelStatusBar`想要的。但是，这很奇怪，因为根据 Apple 的文档，`UIWindowLevelStatusBar`应该高于`UIWindowLevelAlert.`这是否也适用于 5.0、5.1 和 6.0？我无法在模拟器上测试这些，因为我的互联网*真的很*慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:50:18.863

UIWindowLevel 是一个 CGFloat，因此您可以像这样分配一个中间值：首先从数组 [UIApplication sharedApplication].windows 中确定哪个窗口是键盘窗口。然后，

```
window.windowLevel=(keyboardWindow.windowLevel+UIWindowLevelAlert)/2.f; 
```

# python - 二叉树和链表：

> ID：15422903
> 
> 赞同：1
> 
> 时间：2013-03-15T00:54:49.413
> 
> 标签：python, binary-search-tree

假设我有节点类：

```
class Node:

    def __init__(self, data, link=None):
        self.data = data
        self.link = link

class BTNode:

    def __init__(self, item, left=None, right=None):
        self.item = item
        self.left = left
        self.right = right 
```

我想创建一个二叉搜索树中序遍历的链表。

到目前为止，我所拥有的是：

```
def inorder(root):

    root = _inorder(root)[0] # return head of linked list

# helper function that returns the head and tail of the linked list. 
def _inorder(root):

    if root is None:
        return None, None

    else:
        temp = Node(root.item)
        if root.left:
            left_head, left_tail = _inorder(root.left)
            left_tail.link = temp
        if root.right:
            right_head, right_tail = _inorder(root.right)
            temp.link = right_head

        return left_head, right_tail 
```

测试：

```
if __name__ == '__main__':
    a1 = BTNode('A')
    a2 = BTNode('B')
    a3 = BTNode('C')
    a4 = BTNode('D')
    a5 = BTNode('G')
    a6 = BTNode('E')
    a7 = BTNode('F')
    a1.left = a2
    a1.right = a3
    a2.right = a4
    a4.left = a5
    a3.left = a6
    a3.right = a7
    x = inorder(a1) 
```

但是我得到了错误：

UnboundLocalError：分配前引用的局部变量“left_head”

相反，如果我做类似的事情：

```
def _inorder(root):

    if root is None:
        return None, None

    else:
        temp = Node(root.item)
        #if root.left:
        left_head, left_tail = _inorder(root.left)
        left_tail.link = temp
        #if root.right:
        right_head, right_tail = _inorder(root.right)
        temp.link = right_head

        return left_head, right_tail 
```

然后错误变为： NoneType' object has no attribute 'link' 任何人都可以看到问题，因为我认为我的逻辑是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:11:07.223

在第一种情况下：

```
 if root.left:
        left_head, left_tail = _inorder(root.left)
        left_tail.link = temp
    if root.right:
        right_head, right_tail = _inorder(root.right)
        temp.link = right_head

    return left_head, right_tail 
```

如果您不输入任何一个 if，您将永远不会分配 left_head 或 right_tail。

第二个错误是由于您的第一次检查：

```
if root is None:
    return None, None 
```

给定了这个任务：

```
 left_head, left_tail = _inorder(root.left) 
```

将使 left_head 和 left_tail 都为 None。这会导致您在下一行看到的爆炸。

# php - codeigniter ajax 加载表

> ID：15422904
> 
> 赞同：0
> 
> 时间：2013-03-15T00:54:50.080
> 
> 标签：php, codeigniter

我写了一些codeigniter代码，当我单击按钮添加数据时，表格将重新加载ajax，而不是重新加载页面。如何修改我的代码？谢谢

这是我的控制器

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Big_category extends CI_Controller {

  function __construct() {
     ...
  }

  function index() {
    if($this->session->userdata('logged_in')) {
      $this->page(0);
    } else {
      show_404('page');
    }
  }

  function page($page) {
     ....
    $data['pagelist']=$this->pagination->create_links();
    $data["main_content"] = "big_category_view";
    $this->load->view('template', $data);
  } 
```

这是我的模型

```
class Big_category_model extends CI_Model
{
  ...
  function get_big_category($limit, $start)
  {
    $this->db->limit($limit, $start);
    $query = $this->db->get_where('category1', array('c1_status' => 1)); //SELECT * FROM category1
    return json_encode($query->result());
  } 
```

这是我的看法

```
...
    <? $data = json_decode($all_big_category); ?>
    <? foreach($data as $key => $value): ?>
    <tr class="modify_tr">
      <td><?=($key+1)?></td>
      <td id="td_id_<?=$value->c1_id?>" class="modify_td">

        <span id="c1_id_<?=$value->c1_id?>"><?=$value->c1_name?></span>
        <form class="form-search td_id_<?=$value->c1_id?>">
          <input type="text" name="input_c1_id" id="input_c1_id_<?=$value->c1_id?>">
          <button class="btn modify" id="button_c1_id_<?=$value->c1_id?>" c1-id="<?=$value->c1_id?>" type="button"><i class="icon-edit"></i></button></td>
        </form>
      <td><button class="btn btn-danger"><i class="icon-remove-sign"></i></button></td>
    </tr>
    <? endforeach ?>
  </table>
  <?=$pagelist?>
... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T06:46:58.273

这是一个简单的技术，您可以如何实现这一点。

布局（模板）

```
<html>
<body>
    <div><!--other stuff here--></div>
    <div id = 'form_id'>
    <?php echo $content?>
    </div>
</body>
</html> 
```

控制器

```
function index() 
{
    if($this->input->is_ajax_request()){
        //load form here
        $this->load->view('form');      
    }else{
        //this will load the form for the first time
        //pass third parameter as TRUE so it will returned as string
        //assigned to index content which will be displayed in layout
        $data['content']    =   $this->load->view('form',$data , TRUE);     

        //load template here
        $this->load->view('template', $data);       
    }
} 
```

jQuery

```
$.ajax({
    type : 'POST',
    url : '<?php echo site_url('controllername/index')?>',
    data : '' // query string
    success : function(formagain){
        $('#form_id').html(formagain);
        //this will replace the content of div with new form
    } 
}); 
```

# ruby-on-rails - 我想查看所有帖子并在同一视图中创建新帖子

> ID：15422905
> 
> 赞同：-1
> 
> 时间：2013-03-15T00:54:56.563
> 
> 标签：ruby-on-rails

我刚开始学习 Ruby on Rails。我希望用户可以在显示所有帖子的同一页面上创建新帖子。如果用户可以更新它们，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T00:57:18.527

尝试阅读本教程：

[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

或者

[http://railsforzombies.org/](http://railsforzombies.org/)

从视图中获取表单`new`，将其放入您的视图中，然后将操作中的and`index`更改为指向页面。`redirect_to``render``create``index`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:26:54.430

学习语言或框架需要阅读或研究。

在最一般的意义上，在列表底部为您的帖子索引操作创建一个链接（假设您正在使用脚手架）。如果您所说的“在同一页面上”的意思是您不必重新加载新页面，那么这必须是一个 ajax 请求链接。

该请求将映射到一个控制器函数，然后您将使用不显眼的 javascript 重新呈现或添加到您的帖子列表中，可能使用 JQuery。

如果这些都没有意义：您需要阅读一本书或更多关于 Ruby on Rails with Ajax 和 Unobtrusive Javascript 的在线教程。

在 railscasts.com 上的 Bates 先生有一些关于 RoR 的令人难以置信的视频。是不可缺少的资源。

# android - Openx Android 布局问题

> ID：15422906
> 
> 赞同：1
> 
> 时间：2013-03-15T00:55:10.050
> 
> 标签：android, ads, openx

我正在尝试在 Android 应用程序中显示 OpenX 广告。我已安装 SDK 并按照[此处](http://www.youtube.com/watch?v=7z7BdjLnb7s&feature=youtu.be)找到的视频进行操作。一切都很顺利，除非我编辑布局。我经常在错误日志中收到这条友好的错误消息。

```
eclipse.buildId=M20120914-1800
java.version=1.7.0_11
java.vendor=Oracle Corporation
BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_US
Command-line arguments:  -os win32 -ws win32 -arch x86_64

Error
Thu Mar 14 17:40:44 PDT 2013
com.openx.ad.mobile.sdk.views.OXMAdBanner failed to instantiate.

java.lang.NullPointerException
    at com.openx.ad.mobile.sdk.controllers.OXMAdBaseController.<init>(OXMAdBaseController.java:130)
    at com.openx.ad.mobile.sdk.controllers.OXMAdController.<init>(OXMAdController.java:37)
    at com.openx.ad.mobile.sdk.views.OXMAdBanner.init(OXMAdBanner.java:141)
    at com.openx.ad.mobile.sdk.views.OXMAdBanner.reflectAttrs(OXMAdBanner.java:136)
    at com.openx.ad.mobile.sdk.views.OXMAdBanner.<init>(OXMAdBanner.java:86)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
    at java.lang.reflect.Constructor.newInstance(Unknown Source)
    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.instantiateClass(ProjectCallback.java:422)
    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.loadView(ProjectCallback.java:179)
    at android.view.BridgeInflater.loadCustomView(BridgeInflater.java:207)
    at android.view.BridgeInflater.createViewFromTag(BridgeInflater.java:135)
    at android.view.LayoutInflater.rInflate_Original(LayoutInflater.java:746)
    at android.view.LayoutInflater_Delegate.rInflate(LayoutInflater_Delegate.java:64)
    at android.view.LayoutInflater.rInflate(LayoutInflater.java:718)
    at android.view.LayoutInflater.rInflate_Original(LayoutInflater.java:749)
    at android.view.LayoutInflater_Delegate.rInflate(LayoutInflater_Delegate.java:64)
    at android.view.LayoutInflater.rInflate(LayoutInflater.java:718)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:372)
    at com.android.layoutlib.bridge.impl.RenderSessionImpl.inflate(RenderSessionImpl.java:385)
    at com.android.layoutlib.bridge.Bridge.createSession(Bridge.java:332)
    at com.android.ide.common.rendering.LayoutLibrary.createSession(LayoutLibrary.java:325)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderService.createRenderSession(RenderService.java:440)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.renderWithBridge(GraphicalEditorPart.java:1545)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.recomputeLayout(GraphicalEditorPart.java:1302)
    at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.activated(GraphicalEditorPart.java:1059)
    at com.android.ide.eclipse.adt.internal.editors.layout.LayoutEditorDelegate.delegatePageChange(LayoutEditorDelegate.java:686)
    at com.android.ide.eclipse.adt.internal.editors.common.CommonXmlEditor.pageChange(CommonXmlEditor.java:360)
    at org.eclipse.ui.part.MultiPageEditorPart$2.widgetSelected(MultiPageEditorPart.java:292)
    at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:248)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1077)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1062)
    at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:774)
    at org.eclipse.swt.custom.CTabFolder.setSelection(CTabFolder.java:3023)
    at org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:1730)
    at org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:270)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4169)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3758)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1029)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:923)
    at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86)
    at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:588)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:543)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1414) 
```

我在谷歌上找不到任何帮助，我想知道是否有人以前遇到过这个问题。我的清单设置正确，并且正在运行 android:targetSdkVersion="17"

```
<activity
android:name="com.openx.ad.mobile.sdk.OXMAdBrowser"
android:theme="@android:style/Theme.NoTitleBar">
</activity> 
```

因此，由于没有构建错误，我可以启动我的应用程序，但它很快就会崩溃并引发一些错误。

```
03-14 17:45:35.517: E/AndroidRuntime(23227): FATAL EXCEPTION: main
03-14 17:45:35.517: E/AndroidRuntime(23227): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.portlandtribune.pamplinmedia_beta/com.portlandtribune.pamplinmedia_beta.PM_section}: android.view.InflateException: Binary XML file line #97: Error inflating class com.openx.ad.mobile.sdk.views.OXMAdBanner
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.ActivityThread.access$600(ActivityThread.java:130)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.os.Looper.loop(Looper.java:137)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.ActivityThread.main(ActivityThread.java:4745)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at java.lang.reflect.Method.invokeNative(Native Method)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at java.lang.reflect.Method.invoke(Method.java:511)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at dalvik.system.NativeStart.main(Native Method)
03-14 17:45:35.517: E/AndroidRuntime(23227): Caused by: android.view.InflateException: Binary XML file line #97: Error inflating class com.openx.ad.mobile.sdk.views.OXMAdBanner
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.createView(LayoutInflater.java:613)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:687)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:749)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:256)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.actionbarsherlock.internal.ActionBarSherlockNative.setContentView(ActionBarSherlockNative.java:119)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.actionbarsherlock.app.SherlockActivity.setContentView(SherlockActivity.java:229)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.portlandtribune.pamplinmedia_beta.PM_section.onCreate(PM_section.java:145)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.Activity.performCreate(Activity.java:5008)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
03-14 17:45:35.517: E/AndroidRuntime(23227):    ... 11 more
03-14 17:45:35.517: E/AndroidRuntime(23227): Caused by: java.lang.reflect.InvocationTargetException
03-14 17:45:35.517: E/AndroidRuntime(23227):    at java.lang.reflect.Constructor.constructNative(Native Method)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at android.view.LayoutInflater.createView(LayoutInflater.java:587)
03-14 17:45:35.517: E/AndroidRuntime(23227):    ... 24 more
03-14 17:45:35.517: E/AndroidRuntime(23227): Caused by: java.lang.NullPointerException
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.openx.ad.mobile.sdk.controllers.OXMAdBaseController.<init>(OXMAdBaseController.java:161)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.openx.ad.mobile.sdk.controllers.OXMAdController.<init>(OXMAdController.java:37)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.openx.ad.mobile.sdk.views.OXMAdBanner.init(OXMAdBanner.java:141)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.openx.ad.mobile.sdk.views.OXMAdBanner.reflectAttrs(OXMAdBanner.java:136)
03-14 17:45:35.517: E/AndroidRuntime(23227):    at com.openx.ad.mobile.sdk.views.OXMAdBanner.<init>(OXMAdBanner.java:86) 
```

其他人遇到过这个问题吗？

其他信息

我正在使用 xml 布局文件的标准代码。我知道我没有指定任何详细信息，但它不应该返回 com.openx.ad.mobile.sdk.views.OXMAdBanner 未能实例化错误。正确的？

```
<com.openx.ad.mobile.sdk.views.OXMAdBanner
    android:id="@+id/banner"
    android:layout_width="10dp"
    android:layout_height="10dp"
    android:layout_gravity="center_horizontal|center_vertical"
    domain="d.example.com"
    portrait_id="1234"
    landscape_id="4321"
    change_interval="30000" /> 
```

# zepto - 构建zepto时的错误

> ID：15422911
> 
> 赞同：4
> 
> 时间：2013-03-15T00:55:51.413
> 
> 标签：zepto

当我尝试构建 zepto 时，出现以下错误：

```
MODULES="zepto event polyfill detect fx fx_methods ajax form selector touch gesture" ./make dist
Error: Cannot find module 'shelljs/make'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/Users/kevin/etcgit/zepto/make:4:3)
    at Object.<anonymous> (/Users/kevin/etcgit/zepto/make:153:4)
    at Module._compile (module.js:449:26)
    at Object.exports.run (/usr/local/lib/node_modules/coffee-script/lib/coffee-script/coffee-script.js:124:25)
    at compileScript (/usr/local/lib/node_modules/coffee-script/lib/coffee-script/command.js:166:29)
    at fs.stat.notSources.(anonymous function) (/usr/local/lib/node_modules/coffee-script/lib/coffee-script/command.js:141:18)
    at fs.readFile (fs.js:176:14)
    at Object.oncomplete (fs.js:297:15) 
```

不知道发生了什么......我确实安装了shell js，但没有摆脱错误......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T14:38:17.043

确保你先跑`npm install`。所以...

```
cd src/js/libs/zepto
npm install
MODULES="zepto event polyfill detect fx fx_methods ajax form selector touch gesture" ./make dist 
```

来自[https://github.com/madrobby/zepto#building](https://github.com/madrobby/zepto#building)

我自己也遇到了同样的问题...

祝你好运，罗伯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T02:17:28.663

如果你想自定义包，请打开zepto根目录中的'make'文件，找到第42行。然后你会看到：

```
modules = (env['MODULES'] || 'zepto event ajax form ie touch').split(' ') 
```

修改用空格分割的包，保存后。跑过

```
npm run-script dist 
```

以前，你必须安装所有依赖的包。

# memory-management - 从 linux 内核访问用户空间数据

> ID：15422912
> 
> 赞同：1
> 
> 时间：2013-03-15T00:55:57.747
> 
> 标签：memory-management, linux-kernel

这是一个分配问题，要求部分实现进程检查点：

测试程序分配一个数组，进行系统调用并将数组的开始和结束地址传递给调用。在系统调用函数中，我必须将给定范围内的内容保存到文件中。

据我了解，我可以简单地使用**copy_from_usr**函数来保存给定范围内的内容。但是，由于分配基于主题“进程地址空间”，我可能需要遍历页表。假设我设法获得与给定范围相对应的**结构页面。**如何获取页面对应的数据？

我可以只使用**page_to_virt**函数并直接访问数据吗？由于数组在虚拟空间中是连续的，我想我只需要将起始地址转换为页面，然后再转换回虚拟地址，然后只需将数据的范围大小复制到文件即可。是对的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:49:32.870

我认为 copy_from_user() 没问题，不需要其他任何东西。在执行系统调用时，虽然会陷入内核空间，但上下文仍然是进行系统调用的进程上下文。内核仍然使用进程的页表。所以只需使用 copy_from_user()，不需要其他任何东西。

Okey，如果你想做这个实验，我想你可以使用 void __user *vaddr 来遍历 mm->pgd(page table)，使用 pgd_offset/pud_offset/pmd_offset/pte_offset 来获取页面物理地址(page size alignment) ）。然后在内核空间中，使用ioremap()创建内核空间映射，然后使用内核虚拟地址（页大小）+偏移量（页内），得到数组的起始虚拟地址。现在在内核中，您可以使用虚拟地址来访问数组。

# linux - poll() 系统调用中 POLLIN 和 POLLPRI 的区别

> ID：15422919
> 
> 赞同：2
> 
> 时间：2013-03-15T00:57:31.180
> 
> 标签：linux, polling, system-calls

poll() 的文档没有详细解释这一点。在 fd 上轮询时，什么时候应该使用 POLLIN，什么时候应该使用 POLLPRI？任何见解都会很有用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-15T02:00:59.913

poll() 文档中有一些描述。

POLLIN 有数据要读取。POLLPRI 有紧急数据要读取。

如果仅使用 POLLIN，则 poll() 将在有数据或紧急数据要读取时返回。如果只使用 POLLPRI，poll() 将仅在有紧急数据要读取时返回，而忽略正常数据。

什么是紧急数据？比如tcp的带外数据。在 TCP 帧头中，有一个名为 urg_data 的标志。Urg_data 表示此帧具有更高的传递优先级。一旦内核接收到一个 urg_data 生成的帧，它就会设置一个 POLLPRI 标志！看下面的代码：

```
...
if (tp->urg_data & TCP_URG_VALID)
   mask |= POLLPRI;
....
return mask; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-06T19:57:12.733

根据 UNIX Network Programming, 第 3 版，`POLLPRI`STREAMS 独有，在 POSIX 兼容系统上使用 TCP 或 UDP 时永远不会触发。

[https://books.google.dk/books?id=ptSC4LpwGA0C&pg=PA183&lpg=PA183&dq=POLLRDNORM+POLLRDBAND+POLLPRI&source=bl&ots=Ks7CSockOv&sig=nqzhameGpvzi_TSq1-2qi9gqdaY&hl=en&sa=X&ved=0ahUKEwjjqaOh9cbPAhWGjCwKHWjxCdw4ChDoAQg_MAc#v=onepage&q=POLLRDNORM%20POLLRDBAND%20POLLPRI&f=错误的](https://books.google.dk/books?id=ptSC4LpwGA0C&pg=PA183&lpg=PA183&dq=POLLRDNORM+POLLRDBAND+POLLPRI&source=bl&ots=Ks7CSockOv&sig=nqzhameGpvzi_TSq1-2qi9gqdaY&hl=en&sa=X&ved=0ahUKEwjjqaOh9cbPAhWGjCwKHWjxCdw4ChDoAQg_MAc#v=onepage&q=POLLRDNORM%20POLLRDBAND%20POLLPRI&f=false)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T01:07:12.407

我总是使用它们，这是可能的，因为它们是位掩码（所以你可以使用`POLLIN | POLLPRI`）。

优先级条目用于被认为比常规信息更重要的信息。理想情况下，您会要求两种类型，然后首先检查/处理优先级。

# email - 在响应式电子邮件中对齐表格元素

> ID：15422920
> 
> 赞同：0
> 
> 时间：2013-03-15T00:57:36.570
> 
> 标签：email, alignment, responsive-design

我正在设计一个响应式电子邮件，我有两个表合二为一`<td>`。在 Outlook 2007 和 2010 中，第二个表不是顶部对齐的：

![在此处输入图像描述](../Images/14047114725794eb7dfa795137795ef8.png)

a 中的两个表`td`都有一个像素宽度，但是这两个表中的其余表都有`width=%`.

我尝试了左右对齐，`style="mso-table-lspace:0;mso-table-rspace:0;"`但它仍然无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T19:17:35.487

我遇到了同样的问题。我怀疑这是由于 Outlook 使用 Word 来呈现 HTML，而 Word 变得混乱并出现分页符。

我建议将每个表格放在父表格的单元格中。然后将您的样式应用于父表的单元格。请注意，“float”通常不适合在 HTML 中用于电子邮件，但由于它在媒体查询中意味着它可以安全使用。

CSS：

```
@media only screen and (max-width: 500px) {  
  .floatLeftResponse{
    width:100% !important;
    float:left;
  }
} 
```

HTML：

```
<table width="800" border="0" cellpadding="0" cellspacing="0" align="center" bgcolor="#FFFFFF">
  <tr>
    <td width="50%" valign="top" class="floatLeftResponse">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#ffffff">
        <tr>
          <td> <!---bla bla bla this is your left column content-->
          </td>
        </tr>
      </table>
    </td>
    <td width="50%" valign="top" class="floatLeftResponse">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#ffffff">
        <tr>
          <td> <!---bla bla bla this is your right column content-->
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table> 
```

# sql - 限制数据库内字段的类型和大小是否足以保证安全？

> ID：15422925
> 
> 赞同：1
> 
> 时间：2013-03-15T00:58:29.347
> 
> 标签：sql, sql-server-2008, security

**MS SQL 2008：**我尝试搜索此内容，但并没有真正找到答案。我知道在保存到数据库之前应该对所有用户输入进行清理和验证，但我想知道对于数据库中受大小和类型限制的字段是否也需要这样做。

例如，我有几个 BIT 类型的字段，并且只允许 1 个字符，或者具有外键名称的 INT 字段，因此只能将外键保存到其中。

所以现在，在我让一个用户向另一个用户发送消息的表单上，我可以

1.  单选按钮 BIT（联系我是/否）
2.  隐藏字段（发送到#userid#），因此这会将用户的 ID 放入表中
3.  *DateTime 字段（在此*日期发送的消息）将由我自动填充，但我将其扔在这里，假设我让用户设置时间。
4.  VarChar（最大尺寸 2），我想知道这个，我猜即使仅限于 2，一个人也可以向其中注入恶意内容？

我需要在将这些字段发送到数据库之前对其进行清理，还是数据库会处理并拒绝输入？

我问所有这些的原因是为了找出普遍接受的内容以及出于性能原因。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:01:17.250

您需要清理您的输入，以防止恶意用户通过数据修改您的 SQL 查询来做坏事。我认为更改类型或大小不会有助于您系统的安全性。您的 DBMS 将拒绝任何数据大小或类型错误的插入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T02:16:05.853

数据类型不是安全的答案。数据类型应该适合您的业务需求。例如，如果您要求允许人们使用富文本段落，例如我现在正在做的（参见***富文本***），那么去掉 html 的 char(10) 字段可能是安全的，但没用。

您已经了解了一些关于 sql 注入的内容。您还必须注意恶意 html 和 javascript。只是为了好玩，插入这个：

```
<script>alert("oh dear");</script> 
```

进入你的数据库。然后编写一个简单的 .net/php/coldfusion/whatever 应用程序来选择它并将其显示在网页上。美元兑它执行的甜甜圈。

您的问题已经得到解答。这只是要考虑的更多内容。

# javascript - 同时运行两个jQuery函数

> ID：15422927
> 
> 赞同：4
> 
> 时间：2013-03-15T00:59:13.103
> 
> 标签：javascript, jquery

我正在使用 jQuery 将某些内容向下滑动并淡出其他内容，但是在测试它时，我注意到在滑动发生后淡出出现的时间过长。换句话说，有足够明显的滞后。

只是为了让自己清楚，这两个项目，我正在滑动和淡化另一个是不同的元素，我不能使用链接。

有没有办法让这些功能同时运行或更紧密地结合在一起，使它们看起来同时运行？

这是我正在使用的 jQuery 代码：

```
$(document).ready(function(){
    $('#trigger').click( function(){         
        $(this).animate({ opacity: 0.0 });        // fade
        $('#carousel').animate({ top: '100px' }); // slide
        $('#pullrefresh').css('top', '-490px');   // line 5
        $('#detector').hide();                    // line 6
    });
}); 
```

淡入淡出和滑动发生在不同的时间，第 5 行和滑动似乎同时发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:13:45.173

如果你这样做，它们应该一起运行：

```
$('#element1').animate({
    opacity: 0.25,
    }, 1000, function() {
        // complete
});

$('#element2').animate({
    opacity: 0,
    }, 1000, function() {
        // complete
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:16:45.763

试试这个

```
 $(document).ready(function(){
        $('#trigger').click( function(){         
            $(this).animate({ opacity: 0.0 },1000);        // fade
            $('#carousel').animate({ top: '100px' }); // slide
            $('#pullrefresh').css('top', '-490px');   // line 5
            $('#detector').hide();                    // line 6
        });
    }); 
```

为动画指定时间 1000

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T01:30:45.163

```
 $(document).ready(function(){

       $('#trigger').click( function(){

           $.Deferred(function(dfr) {

              dfr.pipe(function() {
                  return  $(this).animate({ opacity: 0.0 }); // fade
              }).
              pipe(function() {
                  return $('#carousel').animate({ top: '100px' }); // slide
              })
              pipe(function() {
                  return $('#pullrefresh').css('top', '-490px'); // line 5
              }).
              pipe(function() {
                  return $('#detector').hide(); // line 6
              });

          }).resolve();

       });
  }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T01:30:45.647

如果你设置一个小提琴会更好。如果您的 DOM 很大，您可以通过提前进行查找来最小化减少延迟：

```
$(document).ready(function(){
    $('#trigger').click( function(){
        var vars = { $this        : $(this),
                     $carousel    : $('#carousel'),
                     $pullrefresh : $('#pullrefresh'),
                     $detector    : $('#detector')
                   };

        vars.$this.animate({ opacity: 0.0 },1000);  // fade
        vars.$carousel.animate({ top: '100px' });   // slide
        vars.$pullrefresh.css('top', '-490px');     // line 5
        vars.$detector.hide();                      // line 6
    });
}); 
```

# c++ - GLSL 制服没有得到定义

> ID：15422930
> 
> 赞同：1
> 
> 时间：2013-03-15T00:59:29.907
> 
> 标签：c++, opengl, glsl

我正在为多灯设计一个着色器，以及一个处理灯光创建的函数。灯光保存在一个 struct uniform 数组中，灯光的数量保存在一个名为“light_quantity”的 int uniform 中。

这是创建光的函数：

```
int Game::AllocLight(LIGHT_TYPE mylight,float radius,glm::vec3 position,glm::vec3 direction,glm::vec4 ambient,glm::vec4 specular,glm::vec4 diffuse,bool status,int in_pos){

if(number_lights + 1 > MAX_LIGHTS || in_pos > MAX_LIGHTS){
    return -1;
}
int newindex;
if(in_pos==-1){
    newindex = number_lights++;
}else{
    newindex=in_pos;
}

std::string as = std::to_string((unsigned long long)newindex);
// LightBase name
string light_base_name = "lights_a[" + as + "]";

GLint renderit_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".renderit")).c_str());

GLint ambient_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".ambient_light")).c_str());
GLint diffuse_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".diffuse_light")).c_str());
GLint specular_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".specular_light")).c_str());

GLint radius_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".radius")).c_str());

GLint position_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".light_position")).c_str());
GLint direction_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".light_direction")).c_str());

GLint type_uniform = glGetUniformLocation(main_program.GetId(),string(light_base_name + string(".light_type")).c_str());

int light_type;
switch(mylight){
    case POINT_TYPE:
        light_type=1;
    break;
    case DIRECTIONAL_TYPE:
        light_type=2;
    break;
    case AREA_TYPE:
        light_type=3;
    break;
    case SUN_TYPE:
        light_type=4;
    break;
}

glUniform1i(renderit_uniform,status);

glUniform4f(ambient_uniform,ambient.w,ambient.x,ambient.y,ambient.z);
glUniform4f(diffuse_uniform,diffuse.w,diffuse.x,diffuse.y,diffuse.z);
glUniform4f(specular_uniform,specular.w,specular.x,specular.y,specular.z);

glUniform1f(radius_uniform,radius);

glUniform3f(position_uniform,position.x,position.y,position.z);
glUniform3f(direction_uniform,direction.x,direction.y,direction.z);

glUniform1i(type_uniform,light_type);

glUniform1i(glGetUniformLocation(main_program.GetId(),"light_quantity"),number_lights);

return newindex;
} 
```

MAX_LIGHTS：一个用#defined 定义的宏，它是一个int...
问题是，制服没有像他们应该的那样被定义。

这是我的片段着色器（顶点着色器在这个问题中并不重要，我认为......）

```
#version 330 core
struct LightBase{
int renderit;

vec4 ambient_light;
vec4 specular_light;
vec4 diffuse_light;

float radius;

vec3 light_position;
vec3 light_direction;

int light_type;
};
struct MaterialBase{
vec4 ambient_affect;
vec4 specular_affect;
vec4 diffuse_affect;
float shining;

float mirror;

int light_affect;
};
in vec3 VertexPos;
in vec3 Normal;
uniform int light_quantity;
uniform LightBase lights_a[50];
uniform MaterialBase material;
uniform float usingTex;
uniform sampler2D texturemap;
in vec2 UVs;
in vec4 Colors;
out vec4 color;
void main(){

vec4 texture_u = texture(texturemap,UVs).rgba * usingTex;
vec4 color_u = Colors * (1.0f-usingTex);

vec4 final_color = color_u+texture_u;
for(int i=0;i<light_quantity;i++){
//if(lights_a[i].renderit==1){ // This is commented for test if the "light_quantity" is getting defined.
    //if(lights_a[i].light_type==1){ // This is commented for test if the "light_quantity" is getting defined.
        // Point Type
        float attenuation = max(0.0,1.0-dot(lights_a[i].light_direction,lights_a[i].light_direction));

        vec3 L = normalize(lights_a[i].light_direction);
        vec3 N = normalize(Normal);
        vec3 V = normalize(-VertexPos);
        vec3 R = normalize(-reflect(L,N));

        float nDotL = max(0.0,dot(N,L));
        float rDotV = max(0.0,dot(R,V));

        vec4 ambient_result = lights_a[i].ambient_light * material.ambient_affect * attenuation;
        vec4 diffuse_result = lights_a[i].diffuse_light * material.diffuse_affect * nDotL * attenuation;
        vec4 specular_result = lights_a[i].specular_light * material.specular_affect * pow(rDotV,material.shining) * attenuation;

        vec4 this_colour = (ambient_result + diffuse_result + specular_result) * final_color;
        final_color = vec4(0,0,0,0); // this_colour; // vec4(0,0,0,0) for test if the "light_quantity" is getting defined.
    //} // This is commented for test if the "light_quantity" is getting defined.
//} // This is commented for test if the "light_quantity" is getting defined.

}

color = final_color;
} 
```

关于为什么会发生这种情况的任何想法？我已经测试了很多次，我得出的结论是问题出在制服上，发生了什么？制服不工作吗？

# php - 如何从查询中提取数据库信息？

> ID：15422931
> 
> 赞同：0
> 
> 时间：2013-03-15T00:59:31.050
> 
> 标签：php, codeigniter

我似乎找不到清楚说明这一点的文档。

```
public function get_user_id_from_username($username){

    $this->db->where('username', $username);
    $this->db->select('id');
    $query = $this->db->get('users');

} 
```

很简单，我想返回我刚刚从数据库中选择的 id。无论如何可以告诉我如何访问该ID吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:01:24.733

[该手册](http://ellislab.com/codeigniter/user-guide/database/results.html)非常有启发性

```
$row = $query->row();
echo $row->id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:06:51.227

```
public function get_user_id_from_username($username){
   $query='select id from users where username=?';
   $params=array();
   $params[]=$username;

   $result=$this->db->query($query, $params);
   $result=$result->row_array();
   return $result['id'];
} 
```

如果您期望多行 result_array 有效：

```
$result=$this->db->query($query, $params);
$result=$result->result_array();

//uses the form $result[0]['id'] 
//try a print_r
print_r($result); 
```

# javascript - 使用 Javascript 让表格数据在表格下方显示描述

> ID：15422937
> 
> 赞同：-1
> 
> 时间：2013-03-15T01:00:40.283
> 
> 标签：javascript, html-table

`div`当查看者单击表格数据时，我希望在表格下方显示描述。这似乎在 Dreamweaver 和 IE 中运行良好，但在 Firefox 或 Chrome 中不起作用。

剧本：

```
<script>
    function changeDiv() {
        var txt = "This is some text";
        document.getElementById("textArea").textContent = txt;
    }
</script> 
```

表数据：

```
 <td onClick="changeDiv()" class="amHours";> 
```

任何想法我做错了什么以及如何让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:40:57.030

尝试这个 ：）

```
document.getElementById('textArea').innerHTML = txt; 
```

JsFiddle好像有点问题，用wc3schools测试了一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:06:37.177

您正在尝试获取 id “textArea”，而 td 元素根本没有 id，请用以下代码替换您的 td（注意：它添加了一个 id “textArea”）：

```
<td onClick="changeDiv()" id="textArea" class="amHours";> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T01:32:34.423

尝试这个

```
 document.getElementById("textArea").html= txt; 
```

# python-3.x - 关于删除重复项的查询

> ID：15422940
> 
> 赞同：2
> 
> 时间：2013-03-15T01:01:06.017
> 
> 标签：python-3.x, duplicate-removal

好的，所以我需要消除列表中的空格和重复值（只有数字）。这是我的代码：

```
def eliminateDuplicates(lst):
    i=0
    while i<len(lst):
       while lst.count(lst[i])!=1:
            lst.remove(lst[i])
       i=i+1
    print(lst)

def main():
    a=input("Enter numbers: ")
    lst=list(a)
    while ' ' in lst:
        lst.remove(' ')
    eliminateDuplicates(lst)

main() 
```

虽然这种方法有效且有效，但当输入说

```
Enter numbers: 1 2 3 4 5   3 2 1    1  22 
```

输出结果为

```
['4', '5', '3', '1', '2'] 
```

我需要我的程序将 22 和 2 识别为不同的项目，这样它就不会删除最后的 2 和 22 中的 2。有什么建议吗？

**编辑：**很抱歉已经给了我答案的两张海报。我不允许使用 set 功能，顺序无关紧要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:19:12.003

这不会像您认为的那样做：

```
b="".join(a)  # doesn't do anything useful since `a` is already a string
lst=list(b)   # this is converting the string to a list of characters 
```

试试这个：

```
lst = a.split()  # automatically cleans up the whitespace for you
print(list(set(lst))) 
```

将列表转换为集合并再次返回是删除重复项的便捷方法。`list`与一遍又一遍扫描的方式相比，它也非常有效

如果您真的想保留该`eliminateDuplicates`功能，则可以

```
def eliminate_duplicates(lst):
    return list(set(lst))

def main():
    a=input("Enter numbers: ")
    lst = a.split()               # split automatically cleans up the whitespace
    print(eliminate_duplicates(lst))

if __name__ == "__main__":
    main() 
```

编辑：由于您不允许使用`set`,`Collections`是另一种相当*有效*的删除重复项的方法

```
from collections import Counter
def eliminate_duplicates(lst):
    return list(Counter(lst)) 
```

这不是很有效，但仍然比两个嵌套循环好得多

```
from itertools import groupby
def eliminate_duplicates(lst):
    [k for k,g in groupby(sorted(lst))] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T02:17:28.573

顺序重要吗？如果不将其转换为集合，然后将其转换回列表。

```
lst = [1,2,3,3,6,4,5,6, 3, 22]
lst2 = list(set(lst)) 
```

此外，您可能应该使用`lst = a.split(' ')`而不是加入

```
def main():
    a=input("Enter numbers: ") # Input the numbers
    clean_a = a.strip(); #Cleans trailing white space.
    lst=list(set(clean_a.split(' '))) #Split into tokens, and remove duplicates 
```

# ruby-on-rails-3 - 在 Rails 3 中，如何创建包含仅由特定视图使用的 css 的布局

> ID：15422944
> 
> 赞同：2
> 
> 时间：2013-03-15T01:01:27.377
> 
> 标签：ruby-on-rails-3, asset-pipeline

我有一个名为 admin 的视图，我想使用仅在此页面中使用的 css 文件 admin.css。我在布局中创建了一个新的布局 admin.html.erb。我在其中放了什么以及如何编辑 application.css 以便 admin.css 仅在管理视图中使用，但所有其他样式表也包含在管理视图中？

谢谢！到目前为止，这就是我在 application.css 中所拥有的

```
/*
 * This is a manifest file that'll automatically include all the stylesheets available in this directory
 * and any sub-directories. You're free to add application-wide styles to this file and they'll appear at
 * the top of the compiled file, but it's generally better to create a new file per   style scope.
 *= require bootstrap_and_overrides
 *= require custom
 *= require admin
 *= require_self
*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T03:52:42.633

不要`require admin`在你的`application.css`，否则你会在你处理的 css 文件中包含这个文件的内容。

保持`admin.css`原样（此文件将包含您所有的管理 css 资源，如果需要，您甚至可以引用其他文件），`require admin`从 中删除该行`application.css`，并在您的 中添加以下内容`application.rb`：

```
config.assets.precompile += ['admin.css'] 
```

这将指示资产管道预编译`admin.css`为单独的文件。

然后在您的管理布局中包括：

```
<%= stylesheet_link_tag "application" %>
<%= stylesheet_link_tag "admin" %> 
```

在您的非管理员布局中只包含应用程序。

# macos - mac osx上的haproxy登录

> ID：15422945
> 
> 赞同：5
> 
> 时间：2013-03-15T01:01:35.537
> 
> 标签：macos, logging, haproxy

有谁知道haproxy在mac osx上的哪里写日志？我想使用`capture cookie _secure len 32`.

我检查了 Console.app，但那里没有显示日志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-19T15:17:07.733

HAProxy 将日志记录到 syslog，因此您检查 Console.app 以查看输出是正确的。

问题是在 OSX 上，您首先需要设置 syslog 以包含它的网络侦听器。

以下是对我有用的说明[[来源]](https://gist.github.com/frazerh/2586877)：

```
 HA Proxy Logging on Lion
 -------------------------

 # To enable haproxy logging we need to change syslogd
 # startup procedure to include its network listener.

 # Backup syslogd start up file
 sudo cp /System/Library/LaunchDaemons/com.apple.syslogd.plist   /System/Library/LaunchDaemons/com.apple.syslogd.plist.bakup

 # Convert binary file to xml to be human readable / editable
 sudo plutil -convert xml1 /System/Library/LaunchDaemons/com.apple.syslogd.plist

 # Edit /System/Library/LaunchDaemons/com.apple.syslogd.plist 
 # and add the following snippet under the sockets  node

 <key>NetworkListener</key>
 <dict>
   <key>SockServiceName</key>
   <string>syslog</string>
   <key>SockType</key>
   <string>dgram</string>
 </dict>

 # Should read like this now
 <key>Sockets</key>
 <dict>
    <key>AppleSystemLogger</key>
    <dict>
        <key>SockPathMode</key>
        <integer>438</integer>
        <key>SockPathName</key>
        <string>/var/run/asl_input</string>
    </dict>
    <key>BSDSystemLogger</key>
    <dict>
        <key>SockPathMode</key>
        <integer>438</integer>
        <key>SockPathName</key>
        <string>/var/run/syslog</string>
        <key>SockType</key>
        <string>dgram</string>
    </dict>
    <key>NetworkListener</key>
    <dict>
        <key>SockServiceName</key>
        <string>syslog</string>
        <key>SockType</key>
        <string>dgram</string>
    </dict>
 </dict>

 # Save the file

 # Convert back to binary file
 sudo plutil -convert binary1 /System/Library/LaunchDaemons/com.apple.syslogd.plist

 # Restart syslogd
 sudo launchctl unload /System/Library/LaunchDaemons/com.apple.syslogd.plist
 sudo launchctl load /System/Library/LaunchDaemons/com.apple.syslogd.plist

 # I added the following entry to /etc/syslog.conf
 local2.*                       /var/log/haproxy.log

 # Include logging options in haproxy.cfg
 global
    log 127.0.0.1   local2 debug

 defaults
    mode http
    option httplog
    log global

 # Restart HAproxy 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-07T13:05:54.580

鉴于我无法发表评论（嘘，声誉），我想在 alanning 中添加以下内容：

如果您运行的是 OS X 10.11+（El Capitan 或更新版本）并且无法复制 plist 文件（即使使用 sudo），您可能会遇到 Apple 新的系统完整性保护。

要禁用 SIP：

1.  重新启动进入恢复模式（重新启动并按住 Cmd-R）
2.  打开终端
3.  使用这个命令：`csrutil disable`
4.  重新启动并运行在 El Capitan 之前有效的命令

强烈建议您按照相同的步骤重新启用 SIP，但`csrutil enable`在步骤 3 中使用。

参考：

[如何在 Stack Overflow 上禁用无根模式](https://stackoverflow.com/a/32590885/2407143)

[Apple.com 上的系统完整性保护](https://developer.apple.com/library/mac/documentation/Security/Conceptual/System_Integrity_Protection_Guide/ConfiguringSystemIntegrityProtection/ConfiguringSystemIntegrityProtection.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T01:10:23.167

在 haproxy 上使用 dtruss 来查看它们的写入位置。您应该在观看时看到文件 I/O 系统调用通过。

更好的是，它是开源的。只看代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-11T17:04:04.510

在使用 macOS Catalina 时，我无法通过描述的其他 syslogd 策略进行日志记录，但我找到了两种捕获日志的方法：

策略1：从配置中**注释掉*守护进程***，并手动运行进程（在停止任何服务实例之后）：`sudo haproxy -f /usr/local/etc/haproxy.cfg`

策略 2：登录到**远程 rsyslog 服务器**，该服务器设置为接受传入的日志：`log "rsyslogserver:514" local0`，其中*`rsyslogserver`*是服务器名称或 ip。您可以查看“配置远程 rsyslog 日志记录<*您的操作系统/版本在此处*>”以获取有关服务器设置的详细信息。

# git - 远程分支出现在 GitHub 上，但当我执行 git branch -r 时没有

> ID：15422947
> 
> 赞同：1
> 
> 时间：2013-03-15T01:01:42.803
> 
> 标签：git, github-api

我正在与一个远程团队合作一个项目。他们创建了一个分支（r_branch），当我在 GitHub 中时可以看到：

```
master
r_branch (and it tells me that it's 6 ahead) 
```

当我执行 git branch -r 时，我得到的是：

```
origin/HEAD -> origin/master
origin/master 
```

没有提到r_branch。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T01:47:57.350

你做过`git fetch`吗？

说什么`git remote show origin`？

# javascript - 使用 AJAX 执行 Javascript

> ID：15422955
> 
> 赞同：0
> 
> 时间：2013-03-15T01:02:17.503
> 
> 标签：javascript, ajax

我知道那里已经有很多类似的问题，但我仍然无法理解发生了什么。我对 AJAX 不是很熟悉，并且对 javascript 有非常基本的了解。

设想：

我有一个运行 ajax 的 index.html 页面和一个包含 javascript（不包含 js 文件）的文件（sub.html），它是 sub.html 中手动编码的 javascript。

例子：

(index.html)

```
$('#content').load(pageurl + '#inner_content', function(){

//some code

}); 
```

（子.html）

```
<script type="text/javascript">
    (function($){
      var interactive_chart_config = {
        zoom_historical_default: [% chart_config.chart.chart_interactive.zoom_historical_default %],
        zoom_intraday_default: [% chart_config.chart.chart_interactive.zoom_intraday_default %],
        quotes_delay: [% ir.var.Config.format.quotes_delay %],
        news_on_chart: {
          [% news_types = chart_config.chart.chart_interactive.news_on_chart.keys %]
          [% FOREACH news_type = news_types %]
            [% news_type %]: {
              [% news_options = chart_config.chart.chart_interactive.news_on_chart.${news_type}.keys %]
              [% FOREACH news_option = news_options %]
                [% news_option %]: [% chart_config.chart.chart_interactive.news_on_chart.${news_type}.${news_option} ? 'true' : 'false' %][% IF news_option != news_options.last %],[% END %]
              [% END %]
            }[% IF news_type != news_types.last %],[% END %]
          [% END %]
        },
        modify_news: [
          [% FOREACH news = chart_config.chart.chart_interactive.modify_news.news %]
            {
              [% FOREACH key = news.keys %]
                [% key %]: '[% news.${key} %]'[% IF key != news.keys.last %],[% END %]
              [% END %]
            }[% IF news != chart_config.chart.chart_interactive.modify_news.news.last %],[% END %]
          [% END %]
        ]
      };

      $(document).ready(function(){
        $('#content_container').web_chart($.extend({}, {
          theme : Highcharts.theme,
          counter_code : "[%= stock_ids.first %]",
          plot_on_load : true,
          always_reload : true,
              loading_indicator_id  : 'loading_indicator',
              chart_setting_id      : 'chart_setting',
              counter_list_form_id  : 'counter_list_form',
              chart_container_id    : 'chart_container',
              css_class_for_flags    : {'N' : 'news_tooltip', 'I' : 'insider_trades_tooltip', 'C' : 'corporate_actions_tooltip'}
        }, interactive_chart_config));
      });
    })(jQuery);

  </script> 
```

如何在 index.html 中使用 AJAX 为 sub.html 执行 javascript？

希望你们能帮帮我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:04:15.773

使用`function`.

```
<script type="text/javascript>
    function stuffFromSub() {
        var foo = "I do stuff";
        return foo;
    }
</script> 
```

然后在`load()`

```
$('#content').load(pageurl + '#inner_content', function(){
    stuffFromSub()
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T01:17:06.593

如果您尝试使用 AJAX 检索包含 javascript 的页面，则需要您在其上运行 eval() ，这将是一个很大的禁忌。

最好的解决方案是创建一个 .js 文件而不是一个 .html 文件并链接到它。将您想要运行的代码放入一个函数中，以便您可以在需要时调用它。

# java - Java 从 oracle 返回过时的数据

> ID：15422959
> 
> 赞同：2
> 
> 时间：2013-03-15T01:02:27.220
> 
> 标签：java, oracle, tomcat, jdbc

我有一个从 oracle 数据库中提取数据的 java web 应用程序，前几天我使用 oracle sql developer 修改了一些数据行。

现在的问题是 Java 一直返回旧数据，就好像它从未改变过一样，但是如果我在 sql developer 中运行完全相同的查询，它会返回当前（修改后的）数据。

我没有启用任何缓存，我检查了 OracleDataSource.getImplicitCachingEnabled() 和 OracleDataSource.getExplicitCachingEnabled() 两者都是错误的。

Oracle 本身是否有某种缓存需要清除？这两天我一直在绞尽脑汁。

我尝试启动/停止和取消部署/重新部署应用程序而没有任何变化。我什至尝试重新启动tomcat本身，但没有帮助。有什么建议么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T01:06:02.133

您很可能没有`autocommit`在 SQLDeveloper 中打开，因此数据尚未提交并且在 SQLDeveloper 会话之外不可见。

# html - 列出项目或表格？

> ID：15422964
> 
> 赞同：0
> 
> 时间：2013-03-15T01:03:19.203
> 
> 标签：html, css, html-table, html-lists

我正在创建两列。第一列是一张图片，第二列是一个与点击图片的次数相关的数字（基本上）。所以我需要两个对齐，但我也希望图像彼此对齐以及数字彼此对齐。所以我的问题是最好在一个表中执行此操作还是创建两个 div，将列表项放在每个 div 中，然后将它们彼此相邻浮动？

如果有更好的方法我是开放的。

选项1

```
<div>
    <div style="float:left">
        <ul>
            <li><img></li>
            <li><img></li>
            <li><img></li>
        </ul>
    </div>
    <div style="float:left">
        <ul>
            <li><value></li>
            <li><value></li>
            <li><value></li>
        </ul>
    </div>
</div> 
```

选项 2

```
<table>
    <tr>
       <td><img></td>
       <td><value></td>
    </tr>
    <tr>
       <td><img></td>
       <td><value></td>
    </tr>
    <tr>
       <td><img></td>
       <td><value></td>
    </tr>
</table> 
```

我确信有更好的方法来做到这一点。我认为这两者都会起作用，但似乎应该有更好的东西。尤其是因为我将不得不使用一堆 CSS 来将它们全部排列起来并使其具有功能性。

最终结果：CSS

```
img{
float:left;
clear:left;
}

 span{
  clear:right;
  float:right;
} 
```

HTML

```
<ul>
    <li><img /><span>value</span></li>
<li><img /><span>value</span></li>
<li><img /><span>value</span></li>
    <li><img /><span>value</span></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:07:10.837

我会在同一个列表项中只保留一个包含图像和值的列表，即：

```
<li><img /><span>value</span></li>
<li><img /><span>value</span></li>
<li><img /><span>value</span></li> 
```

这样，值将始终在图像旁边，并且可以直接使用 span 设置样式。

不应为此使用表。如果上面的方法不合适，我可以给你写一些 jquery 来排列两个列表，但是使用上面的方法 imo 会更整洁。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-15T01:12:31.707

使用表。它更易于理解和维护。如果您的图像具有不同的高度，则可以更轻松地垂直对齐项目。

# php - 致命错误：在非对象上调用成员函数 query()；使用全局

> ID：15422970
> 
> 赞同：0
> 
> 时间：2013-03-15T01:03:57.370
> 
> 标签：php

我有问题的代码：

```
function get_installed_languages()
{
    global $sql;

    $languages = Array();

    $sql->query("SELECT short_name FROM languages ORDER BY short_name");

    if($sql->getNumRows()==1)
    {
        $languages[0] = "default"; 
        return $languages;
    }
    else
    {
        for ($i=0; $i<$sql->getNumRows(); $i++)
        {
            $get = $sql->getRow($i);

            if(trim($get['short_name'])=='')
                $languages[$i]='default';
            else
                $languages[$i] = strtolower($get['short_name']);
        }

        return $languages;
    }
} 
```

它总是返回：

```
Fatal  error: Call to a member function query() on a non-object 
```

有问题的行是：

```
(742): $sql->query("SELECT short_name FROM languages ORDER BY short_name"); 
```

这是[完整的文件](https://docs.google.com/file/d/0B4ftVHajHv3NQVc2dXpjb2M2TDA/edit?usp=sharing)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T08:41:46.097

谢谢你的帮助。原来是数据库中的无效路径。我真的很感激你努力帮助我！

否则，您可以检查整个文件（如果仍然感兴趣）。它的链接已发布在我原始评论的末尾。

干杯!

# bash - Bash 变量包含一组值中的一个值

> ID：15422971
> 
> 赞同：0
> 
> 时间：2013-03-15T01:04:04.823
> 
> 标签：bash

我正在开发一个“包装脚本”以在 Bash 中用作“日志记录辅助”。

它应该在调用它时打印出有关调用堆栈的信息。

我已经完成了这方面的工作，但仍有几个问题/疑问，我想从这里的专家那里得到最好的答案。

* * *

### 我的代码：

```
################################################################################
# Formats a logging message.                                                    

function my_function_format_logging_message() {                                 

  local -r TIMESTAMP="$(date '+%H:%M:%S')"                                      
  local -r PROCESS="$$" # Deliberately not using $BASHPID, focus: parent process

  local -r CALLER="${FUNCNAME[1]}"                                              

  local -i call_stack_position=1                                                
  if [[ "${CALLER}" == 'my_function_log_trace' ||                               
        "${CALLER}" == 'my_function_log_debug' ||                               
        "${CALLER}" == 'my_function_log_info' ||                                
        "${CALLER}" == 'my_function_log_warning' ||                             
        "${CALLER}" == 'my_function_log_error' ||                               
        "${CALLER}" == 'my_function_log_critical' ]]                            
  then                                                                          
    call_stack_position=$((call_stack_position++))                              
  fi                                                                            

  local -r SOURCE="$(basename "${BASH_SOURCE[$call_stack_position]}")"          
  local -r FUNCTION="${FUNCNAME[$call_stack_position]}"                         
  local -r LINE="${BASH_LINENO[$call_stack_position-1]}" # Previous function    

  local -r SEVERITY="$1"                                                        
  local -r MESSAGE="$2"                                                         

  # TODO: perform argument validation                                           

  printf '%s [PID %s] %s %s %s:%s - %s\n' \                                     
         "${TIMESTAMP}" \                                                       
         "${PROCESS}" \                                                         
         "${SEVERITY}" \                                                        
         "${SOURCE}" \                                                          
         "${FUNCTION}" \                                                        
         "${LINE}" \                                                            
         "${MESSAGE}"                                                           

}                                                                               
################################################################################ 
```

* * *

### 使用示例：

```
my_function_format_logging_message CRITICAL Temporarily increasing energy level to 9001 
```

或者：

```
my_function_log_info Dropping back to power level 42 
```

* * *

### 我的疑惑：

*   call_stack_position=$((call_stack_position++))

我想不出更好的方法来增加这个变量，有没有更好/更易读的形式？

*   我可以使用更好的构造来检测调用是否是由日志记录方法进行的吗？（例如跟踪、调试、信息......）。所有这些`if`陈述都让我的眼睛受伤。

*   我是在重新发明轮子/滥用我想学习的工具吗？（即shell脚本）

当然，我可能是在重新发明轮子，但这是自我训练……有一天不再是收费站的夜班工人。

* * *

### 笔记

我正在寻找与指定的 my_function_log_* 名称匹配的名称，而*没有其他*名称。假设我有那种自由度是不对的（很多`if`s 正是出于这个原因，我正在寻找一些语法糖或更好地使用语言特性来进行那种类型的“集合成员资格”测试）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T01:12:42.350

我可以为你的前两个问题提出这个建议：

```
if [[ "${CALLER}" == my_function_log_* ]]
then 
  let call_stack_position++
fi 
```

如果您只想要 log_ 之后的一组值：

```
if [[ "${CALLER}" =~ my_function_log_(trace|debug|info|warning|error|critical) ]]
then 
  let call_stack_position++
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T01:17:18.913

一种更易读的增量方法是在数字上下文中递增它：

```
(( call_stack_position++ )) 
```

对于匹配，您可以在 bash 中使用 glob：

```
[[ $CALLER == my_function_log_* ]] 
```

至于重新发明轮子，您可以使用`logger`命令从 bash 中使用 syslog 日志记录。本地 syslog 守护进程将处理格式化日志消息并将其写入文件。

```
logger -p local0.info "CRITICAL Temporarily increasing energy level to 9001" 
```

更新，基于评论。您可以使用关联数组更明确地说明您要查找的内容。它需要 bash v4 或更高版本。

```
declare -A arr=(
    ['my_function_log_trace']=1
    ['my_function_log_debug']=1
    ['my_function_log_info']=1
    ['my_function_log_warning']=1
    ['my_function_log_error']=1
    ['my_function_log_critical']=1
);

if [[ ${arr[CALLER]} ]]; then
    ...
fi 
```

您还可以使用扩展通配符进行模式匹配，类似于 perreal 答案中的正则表达式，但没有正则表达式：

```
shopt -s extglob
if [[ $CALLER == my_function_log_@(trace|debug|info|warning|error|critical) ]]; then
    ...
fi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T04:04:26.917

Bash 的类型系统，如果你甚至想这么称呼它，它是非常初级的：字符串和整数是它唯一的一等公民，数组是事后才想到的，其功能远不及 Python 集合或 Ruby 数组。`in`话虽如此，对于依赖字符串匹配的数组来说，有一个穷人的运算符。给定一个函数名数组：

```
log_functions=(my_function_log_trace my_function_log_debug my_function_log_info my_function_log_warning my_function_log_error my_function_log_critical) 
```

这：

```
[[ ${log_functions[*]} =~ \\b$CALLER\\b ]] 
```

将仅匹配数组的成员。当我们谈论穷人的构造时，您可以将上述模式与布尔控制运算符结合到穷人的三元赋值中，以完全跳过数值评估：

```
local -i call_stack_position=$([[ ${log_functions[*]} =~ \\b$CALLER\\b ]] && echo 1 || echo 2) 
```

*警告：*在[不支持 GNU 扩展的系统上`regcomp()`（特别是 OS X 和 Cygwin）](http://www.mail-archive.com/cygwin@cygwin.com/msg101871.html)，字边界匹配需要使用更详细的字符类形式，即

```
[[ ${log_functions[*]} =~ [[:\<:]]$CALLER[[:\>:]] ]] 
```

*注意：*看到你的代码并注意到你提到你正在学习 shell 脚本，我会提供两个与问题无关的观察：

1.  变量扩展的大括号符号仅在数组访问、扩展操作和消除字符串连接中的变量名称歧义时需要。在其他情况下不需要它，即在您的测试和您的`printf`命令中。
2.  使用扩展字符串操作比使用外部操作要快得多，因此建议尽可能使用。而不是使用`basename`，使用`${var##*/}`。

# twitter - 搜索 Twitter 提要

> ID：15422972
> 
> 赞同：-2
> 
> 时间：2013-03-15T01:04:12.270
> 
> 标签：twitter, arduino, processing

我希望从[Twitter](http://en.wikipedia.org/wiki/Twitter)提要中获取信息，例如已删除的帖子。是否可以通过某种字符串匹配搜索通过查找关键字来做到这一点，即“此帖子已删除”？

这是一个[Arduino](http://en.wikipedia.org/wiki/Arduino)项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:49:36.380

它应该是。不过，Twitter 刚刚关闭了他们的旧 API，因此只要您愿意获得 API 密钥，就可以了（[https://dev.twitter.com](https://dev.twitter.com)）。使用 API URL 上调用的 loadBytes 或 loadStrings 获取数据，然后开始浏览您返回的数据 ( [http://processing.org/reference/loadStrings_.htm](http://processing.org/reference/loadStrings_.htm) ) - 在新 API 中将是 JSON。您可以使用 JSON 库将其转换为实际对象，但坦率地说，如果您想进行文本匹配，那么您确实不需要重新打包对象。

# go - Golang 文本突出显示对 Kate 的支持

> ID：15422975
> 
> 赞同：1
> 
> 时间：2013-03-15T01:04:15.987
> 
> 标签：go, debian, kate

如何在 Debian 中向**Kate Editor**添加 golang 文本突出显示支持？我将`go.xml`文件存储在 path 中`$GOROOT/misc/kate`。我不知道如何将所需的亮点添加到我的 Kate 安装中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T04:14:56.467

你可以把 go.xml 放到

```
~/.kde/share/apps/katepart/syntax/ (user config) 
```

或者

```
/usr/share/kde4/apps/katepart/syntax/ (system config) 
```

如果此文件夹不存在，请创建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-07T08:16:16.997

在我的 SUSE 上，路径是：$HOME/.kde4/share/apps/kate（注意：不是 katepart），我必须添加最后一个“语法”目录。

# ios - iO 注册接收来自相机胶卷的通知

> ID：15422982
> 
> 赞同：3
> 
> 时间：2013-03-15T01:04:49.297
> 
> 标签：ios, objective-c, camera

当用户拍摄添加到相机胶卷的照片或视频时，有没有办法注册通知？我知道您可以注册联系人通知，但我需要知道用户是否已将图像或视频添加到相机胶卷。我看到 Google+ 声称他们在您拍照后“立即”上传您的图片，但我想知道他们是否一直在线程中的 assetsLibrary enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos 循环中运行...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T01:12:47.547

ALAAssetsLibraryChangedNotification

当资产库的内容从使用数据的应用程序下发生更改时发送。

来自[ALAssetsLibrary](http://developer.apple.com/library/ios/ipad/#documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html)

# apache - htaccess - 选项 FollowSymLinks 或 SymLinksIfOwnerMatch 已关闭问题

> ID：15422985
> 
> 赞同：1
> 
> 时间：2013-03-15T01:05:03.923
> 
> 标签：apache, .htaccess, plesk

我使用 plesk 来托管我的网页。每当我打开根域（例如：“xxxxxx.xx”）时，我的虚拟服务器都会记录以下错误：

选项 FollowSymLinks 或 SymLinksIfOwnerMatch 关闭，这意味着禁止 RewriteRule 指令：/var/www/vhosts/xxxxxx.xx/httpdocs/index.pl

我在 httpdocs 中没有 index.pl 文件。当我调用“xxxxxx.xx/index.php”或其他页面时，**不会**发生此错误。

我的 htaccess：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l

RewriteRule ^products/(.*)/(.*)/$ products.php?id=$1&p=$2 [QSA,L]
RewriteRule ^static/(.*)/(.*)/$ static.php?id=$1 [QSA,L]
RewriteRule ^index\.php$ - [L] 
```

任何想法，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T10:03:08.160

我知道这听起来可能不对，但在您的 plesk 域设置中确保选中 cgi 支持但未选中 perl 支持。使用 mod_rewrite 规则时，即使使用修改后的 Apache conf 文件，我也无法让我的 403 禁止错误消失。一旦我取消选中域 perl 重写工作的 plesk 配置中的 perl 选项。

# java - 计算二叉树中的节点

> ID：15422988
> 
> 赞同：0
> 
> 时间：2013-03-15T01:05:36.537
> 
> 标签：java, count, binary-tree, nodes

我在计算二叉树中的节点时遇到问题。这是一棵真正简单的树，如下图所示。

```
 (5)
                       (3)-------^-------(7)
                  (2)---^---(6)           ^-------(9)
                       (5)---^---(8) 
```

我添加了八个节点，所以应该有 8 个。但是，当我运行我的代码时，它计算了 7 个节点。我认为它只是计算所有左节点和右节点而不计算根，但我将节点数设置为 1 以在计算左右节点之前计算根。请参阅下面的代码

```
private int getNumNodes(Node<E> root){
        numNodes = 1; // starts by counting the root

        // counts the left nodes
        if(root.left != null){
            numNodes += getNumNodes(root.getLeft());
        }

        // counts the right nodes
        if(root.right != null){
            numNodes += getNumNodes(root.getRight());
        }               
    return numNodes;
}

public int getNumNodes(){
    return root == null ? 0 : getNumNodes(root);
} 
```

它必须在某处丢失计数，但我不确定它发生在哪里。你们能不能帮帮我。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-15T01:08:46.577

我认为问题在于`numNodes`它应该是方法的局部变量时是类成员。

# html - 如何在 Dreamweaver 中自动更改多个页面的页眉？

> ID：15422990
> 
> 赞同：0
> 
> 时间：2013-03-15T01:05:45.047
> 
> 标签：html, web, dreamweaver

请问如何自动修改多个文件的header部分（元标签、标题、CSS文件的导入信息）？

当然，我会手动完成，但这需要很长时间才能完成。

我使用的软件是 Dreamweaver

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:18:23.833

使用查找和替换 (ctrl + f)，您可以选择它来运行整个文件夹的文件。

# r - 在导出到 pdf 文件的绘图的 R 主标题中换行

> ID：15422991
> 
> 赞同：0
> 
> 时间：2013-03-15T01:05:46.373
> 
> 标签：r, pdf, plot, rstudio

当我在 RStudio 中生成带有长“主要”标题的绘图时，标题~~似乎自动环绕，~~通常在 RStudio 生成时保持在可见的页边距内。但是当我使用 R 的 pdf() 函数将绘图导出到文件时，文本~~换行消失~~了，超出了页边距并且看起来很糟糕。有什么方法可以让 PDF 导出的图看起来和在 RStudio 中一样好？我知道我可以`\n`在标题字符串中手动插入字符，或者（我还没有尝试过）我可以玩`strwrap`，但如果我只知道切换到什么，这似乎应该是开箱即用的功能翻动。有没有一种简单的方法，或者只是繁琐的一次性方法？

```
# Demo code for long plot title
plot(density(rnorm(10000,0,1))
     ,main="Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor"
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:43:25.167

## 绘图查看窗口和 pdf() 等文件输出设备之间的差异

有时在绘图窗口中绘图看起来与在文件输出设备中不同。根据我的经验，这是因为它们具有不同的几何形状。试试这些...

```
pdf("Desktop/testSmall.pdf",width=4,height=4)
plot(1:10,1:10,main="This is a fairly long plot title with no line breaks")
dev.off() 
```

和更大的第二个情节

```
pdf("Desktop/testLarge.pdf",width=8,height=8)
plot(1:10,1:10,main="This is a fairly long plot title with no line breaks")
dev.off() 
```

## 换行

以下链接表明这不是一个简单的问题要解决（但并非不可能）：

[https://stat.ethz.ch/pipermail/r-help/2008-June/164458.html](https://stat.ethz.ch/pipermail/r-help/2008-June/164458.html)

关于您在 RStudio 中看到的内容，我不知道“好”是什么意思，但这会在主标题中拆分行并将它们居中。

```
pdf("test.pdf")
plot(1:10,1:10,main=paste("Line one","Line two",sep="\n"))
dev.off() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T03:18:04.743

在我的系统下，我需要做的就是确保将方向设置为`portrait`（而横向是默认设置）

当您导出为 pdf 时，RStudio 将根据 Rstudio 设备的大小给出适当的 pdf 高度和宽度。

# cassandra - 如何使用 astyanax 和复合列在 cassandra 中执行范围查询

> ID：15422993
> 
> 赞同：1
> 
> 时间：2013-03-15T01:05:54.947
> 
> 标签：cassandra, composite-key, astyanax

我正在使用 cassandra 和 astyanax 开发一个博客。当然，这只是一个练习。

我以这种方式对 CF_POST_INFO 列族进行了建模：

```
private static class PostAttribute {

    @Component(ordinal = 0)
    UUID postId;

    @Component(ordinal = 1)
    String category;

    @Component
    String name;

    public PostAttribute() {}

    private PostAttribute(UUID postId, String category, String name) {
        this.postId = postId;
        this.category = category;
        this.name = name;
    }

    public static PostAttribute of(UUID postId, String category, String name) {
        return new PostAttribute(postId, category, name);
    }
}

    private static AnnotatedCompositeSerializer<PostAttribute> postSerializer = new AnnotatedCompositeSerializer<>(PostAttribute.class);

private static final ColumnFamily<String, PostAttribute> CF_POST_INFO =
        ColumnFamily.newColumnFamily("post_info", StringSerializer.get(), postSerializer); 
```

并以这种方式保存帖子：

```
 MutationBatch m = keyspace().prepareMutationBatch();

    ColumnListMutation<PostAttribute> clm = m.withRow(CF_POST_INFO, "posts")
            .putColumn(PostAttribute.of(post.getId(), "author", "id"), post.getAuthor().getId().get())
            .putColumn(PostAttribute.of(post.getId(), "author", "name"), post.getAuthor().getName())
            .putColumn(PostAttribute.of(post.getId(), "meta", "title"), post.getTitle())
            .putColumn(PostAttribute.of(post.getId(), "meta", "pubDate"), post.getPublishingDate().toDate());

    for(String tag : post.getTags()) {
        clm.putColumn(PostAttribute.of(post.getId(), "tags", tag), (String) null);
    }

    for(String category : post.getCategories()) {
        clm.putColumn(PostAttribute.of(post.getId(), "categories", category), (String)null);
    } 
```

这个想法是有一些像一段时间桶一样的行（例如，每月或每年一行）。

现在，例如，如果我想获得最后 5 个帖子，我该如何进行愤怒查询？我可以根据帖子 ID (UUID) 执行愤怒查询，但如果不执行另一个查询来获取它们，我不知道可用的帖子 ID。这里的 cassandra 最佳实践是什么？

当然，欢迎任何关于数据模型的建议，我是 cassandra 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-04T17:43:40.793

如果您的用例按照我认为的方式工作，您可以修改您的 PostAttribute 以便第一个组件是 TimeUUID，这样您就可以将其存储为时间序列数据，并且您可以轻松地使用最旧的 5 或最新的 5标准技术。无论如何...这里有一个对我来说看起来像的示例，因为如果您已经在使用复合材料，那么您实际上并不需要制作多个列。

```
public class PostInfo {
    @Component(ordinal = 0)
    protected UUID timeUuid;

    @Component(ordinal = 1)
    protected UUID postId;

    @Component(ordinal = 2)
    protected String category;

    @Component(ordinal = 3)
    protected String name;

    @Component(ordinal = 4)
    protected UUID authorId;

    @Component(ordinal = 5)
    protected String authorName;

    @Component(ordinal = 6)
    protected String title;

    @Component(ordinal = 7)
    protected Date published;

    public PostInfo() {}

    private PostInfo(final UUID postId, final String category, final String name, final UUID authorId, final String authorName, final String title, final Date published) {
        this.timeUuid = TimeUUIDUtils.getUniqueTimeUUIDinMillis();
        this.postId = postId;
        this.category = category;
        this.name = name;
        this.authorId = authorId;
        this.authorName = authorName;
        this.title = title;
        this.published = published;
    }

    public static PostInfo of(final UUID postId, final String category, final String name, final UUID authorId, final String authorName, final String title, final Date published) {
        return new PostInfo(postId, category, name, authorId, authorName, title, published);
    }
}

    private static AnnotatedCompositeSerializer<PostInfo> postInfoSerializer = new AnnotatedCompositeSerializer<>(PostInfo.class);

private static final ColumnFamily<String, PostInfo> CF_POSTS_TIMELINE =
        ColumnFamily.newColumnFamily("post_info", StringSerializer.get(), postInfoSerializer); 
```

你应该像这样保存它：

```
MutationBatch m = keyspace().prepareMutationBatch();

ColumnListMutation<PostInfo> clm = m.withRow(CF_POSTS_TIMELINE, "all" /* or whatever makes sense for you such as year or month or whatever */)
        .putColumn(PostInfo.of(post.getId(), post.getCategory(), post.getName(), post.getAuthor().getId(), post.getAuthor().getName(), post.getTitle(), post.getPublishedOn()), /* maybe just null bytes as column value */)
m.execute(); 
```

然后你可以这样查询：

```
OperationResult<ColumnList<PostInfo>> result = getKeyspace()
    .prepareQuery(CF_POSTS_TIMELINE)
    .getKey("all" /* or whatever makes sense like month, year, etc */)
    .withColumnRange(new RangeBuilder()
        .setLimit(5)
        .setReversed(true)
        .build())
    .execute();
ColumnList<PostInfo> columns = result.getResult();
for (Column<PostInfo> column : columns) {
    // do what you need here
} 
```

# objective-c - 我的 ios 应用程序启动时如何播放音频？

> ID：15422997
> 
> 赞同：0
> 
> 时间：2013-03-15T01:06:04.267
> 
> 标签：objective-c, cocoa-touch, avfoundation

我一直在关注教程并查看其他帖子，但是当我的应用程序启动时，我似乎无法让音频开始自动播放。

我希望 wav 文件在后台继续播放并循环播放。我不想启动和停止控制等...

下面是我在 ViewController.m 文件中的代码（这是正确的位置吗？），我添加了 AVFoundation.frameowrk 并将其导入到我的 .m 文件中。此外，我已将名为 AlienRoom 的 wav 文件添加到我的支持文件中。任何帮助都是极好的！我是新来的，所以请一步一步来，或者如果可以的话，把它说清楚。谢谢！！！

ps 我还没有添加代码让它循环，所以任何帮助都会很棒！

```
//play background sound upon opening app

-(void) awakeFromNib

{

NSString *path = [[NSBundle mainBundle] pathForResource: @"AlienRoom" ofType: @"wav"];
AVAudioPlayer* theAudio = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];
[theAudio play];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T01:11:14.367

在**ViewController.h**中实现**AVAudioPlayerDelegate**

 **```
@interface ViewController : UIViewController <AVAudioPlayerDelegate>

@property(nonatomic,strong)AVAudioPlayer *theAudio; 
```

**ViewController.m 文件**

```
-(void)viewWillAppear:(BOOL)animated
{
   NSString *path = [[NSBundle mainBundle] pathForResource: @"AlienRoom" ofType: @"wav"];
   if(!self.theAudio)
       self.theAudio = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];
   self.theAudio.delegate = self;
   [self.theAudio play];
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)data successfully:(BOOL)flag{

    [NSThread detachNewThreadSelector:@selector(playAudioAgain) toTarget:self withObject:nil];

}

- (void)playAudioAgain{

   [self.theAudio play];
}

-(void)viewWillDisappear:(BOOL)animated
{
   if(self.theAudio.isPlaying)
   {
        self.theAudio.delegate = nil;
        [self.theAudio stop];
    }
} 
```**

# javascript - 根据其父容器检查文本元素的宽度（基于字体大小）

> ID：15422999
> 
> 赞同：8
> 
> 时间：2013-03-15T01:06:27.077
> 
> 标签：javascript, jquery, css, font-size

我带着一个棘手的问题来找你：

假设您有以下基本结构：

```
<div><p>hello</p></div> 
```

现在假设 div 有`display:block; and width:200px;`. 使用 javascript，你将如何检查什么字体大小给你一个尽可能大的“你好”，而不会水平溢出（在一个单词的情况下）或在一个句子或一组单词的情况下跳转到第二行？

我想不出一种方法来测量文本占用的空间，以便随后可以对照父容器的空间来检查它，更不用说检查元素是否溢出或跳线了。

如果有办法，我相信这是正确的地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T01:14:03.427

看看[FitText](http://fittextjs.com/)

它在 github 上也是开源的。

如果您对排版感兴趣，您可能想查看他们的另一个名为[Lettering.js的项目](http://letteringjs.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T01:16:48.233

可能有一种方法不那么疯狂，但这应该尽可能精确。本质上，您有一个 div 用于测量其宽度并逐渐增加文本内容，直到它超过目标 div 的宽度。然后，将目标 div 的`<p>`字体大小更改为测量 div 的负 1：

[http://jsfiddle.net/ExplosionPIlls/VUfAw/](http://jsfiddle.net/ExplosionPIlls/VUfAw/)

```
var $measurer = $("<div>").css({
    position: 'fixed',
    top: '100%'
}).attr('id', 'measurer');
$measurer.append($("<p>").text($("p").text()));
$measurer.appendTo("body");

while ($measurer.width() <= $("#content").width()) {
    $("#measurer p").css('font-size', '+=1px');
    console.log($("#measurer").width());
}
$("#measurer p").css('font-size', '-=1px');
$("#content p").css('font-size', $("#measurer p").css('font-size'));
$measurer.remove(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T01:22:39.287

## 又快又脏

[小提琴](http://jsfiddle.net/Pe9T6/1/)

Set`p`的样式`display: inline`然后运行它

```
var dWidth = $("div").width();
var pWidth = $("p").width();
var starting = 1;
while (pWidth < dWidth) {
    $("p").css("font-size",starting+"em");
    pWidth = $("p").width();
    starting = starting + .1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T01:15:22.290

试试这个：

[自动调整大小的动态文本以填充固定大小的容器](https://stackoverflow.com/questions/687998/auto-size-dynamic-text-to-fill-fixed-size-container)

```
(function($) {
    $.fn.textfill = function(options) {
        var fontSize = options.maxFontPixels;
        var ourText = $('span:visible:first', this);
        var maxHeight = $(this).height();
        var maxWidth = $(this).width();
        var textHeight;
        var textWidth;
        do {
            ourText.css('font-size', fontSize);
            textHeight = ourText.height();
            textWidth = ourText.width();
            fontSize = fontSize - 1;
        } while ((textHeight > maxHeight || textWidth > maxWidth) && fontSize > 3);
        return this;
    }
})(jQuery);

$(document).ready(function() {
    $('.jtextfill').textfill({ maxFontPixels: 36 });
});

<div class='jtextfill' style='width:100px;height:50px;'>
    <span>My Text Here</span>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T01:18:17.900

**[新的 jsFiddle 演示](http://jsfiddle.net/vHGBF/1)**（*更新*3/22/13）

我会一直增加字体大小，直到 clientWidth 或 clientHeight 改变。但是，当使用实际元素本身时，这变得不可靠。为了处理这种情况，可以动态创建跨度，然后监控跨度的尺寸，以便正确保留实际元素的原始尺寸。

js

```
var adjuster = document.getElementById("adjust");
adjuster.onclick = function(){
 var p = document.getElementById("p");
 var text = p.innerText;
 var s = document.createElement("span");
 s.innerText = text;
 p.innerHTML = "";
 p.appendChild(s);
 var h = p.clientHeight;
 var w = p.clientWidth;
 var size = 10;
 while(true){
  size++;
  s.style.fontSize = size + "px";
  if($(s).height() > h || $(s).width() > w){
   size-=2;//rollback to no height change
   s.style.fontSize = size + "px";
   break;
  }
 }
 p.style.fontSize = s.style.fontSize;
 p.removeChild(s);
 p.innerText = text;
}; 
```