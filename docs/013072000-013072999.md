# StackOverflow 问答 13072000-13072999

# iphone - 旋转 iOS 6 兼容 iOS 5

> ID：13072000
> 
> 赞同：4
> 
> 时间：2012-10-25T15:28:18.470
> 
> 标签：iphone, ios5, rotation, ios6

我正在开发一个应用程序（Xcode 4.5 iOS 6），它必须与已安装软件版本的设备兼容，从 4.5 和默认 iPhone 5 开始。    

我知道新的 iOS 6 更改带有自动旋转模式。

当您打开设备时，“iPhone Simulator 6.0”应用程序运行正常，但是当我运行“iPhone Simulator 5.0”时出现旋转问题。

我输入了代码，以及从 iOS 6 和旧方法（已弃用）到 iOS 5 的新方法。

所以寻找旋转方法：

```
#pragma mark - Rotate Methods

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAllButUpsideDown;
}

- (BOOL) shouldAutorotate
{
   return YES;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationPortrait;
}

#pragma mark - Rotate Methods iOS 5

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if (UIInterfaceOrientationIsPortrait(interfaceOrientation))
    {
        [menuPortrait setHidden:NO];
        [menuLandscape setHidden:YES];
    }

    if (UIInterfaceOrientationIsLandscape(interfaceOrientation))
    {
        [menuPortrait setHidden:YES];
        [menuLandscape setHidden:NO];
    }
    return YES;
}

- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
        if (UIInterfaceOrientationIsPortrait(toInterfaceOrientation))
        {
            [self.menuLandscape setHidden:YES];
            [self.menuPortrait  setHidden:NO];
        }
        if (UIInterfaceOrientationIsLandscape(toInterfaceOrientation))
        {
            [self.menuLandscape setHidden:NO];
            [self.menuPortrait setHidden:YES];
        }

    [super willRotateToInterfaceOrientation:toInterfaceOrientation duration:duration];
} 
```

你能帮我就这个问题提供一些建议吗！提前感谢您的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T17:12:46.430

我通过像这样子类化所有视图控制器来实现它：

//.h #导入

```
@interface ITViewController : UIViewController

@end 
```

//.m

```
#import "ITViewController.h"

@interface ITViewController ()

@end

@implementation ITViewController

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
} 
```

这强制横向模式。您可以更新这两种方法的内容以符合您想要的行为

# linux - Tomcat、Microsoft JDBC 4、Linux 和集成安全性

> ID：13072003
> 
> 赞同：2
> 
> 时间：2012-10-25T15:28:21.280
> 
> 标签：linux, jdbc, tomcat7, integrated-security

我目前在 Windows Server 2008 上运行 Java Spring 服务的 Tomcat 7。Tomcat 在有权访问我们的 SQL Server 数据库的 Windows 帐户下运行。我们使用具有集成安全性的 Microsoft SQL JDBC 4 (sqljdbc4.jar) 来访问 SQL Server 数据库（始终使用 Tomcat 帐户）。

我正在尝试在 linux 服务器（Ubuntu 服务器）上设置相同的进程。我知道 sqljdbc4.jar 允许通过纯 Java Kerberos 直接使用 Windows 活动的 SSO。但是，我可以找到的小文档显示了对客户端进行访问的身份验证。

我们的服务用于不属于我们活动目录（网站和 iOS 应用程序）的移动客户端。是否可以使用带有 sqljdbc4 的纯 Java Kerberos 和 tomcat 用户（通过我们的 Active Directory 进行身份验证的 Linux 用户）而不是客户端？

任何帮助表示赞赏。

# mysql - 如何在 Mysql 索引中查询

> ID：13072004
> 
> 赞同：0
> 
> 时间：2012-10-25T15:28:21.473
> 
> 标签：mysql, sql, indexing

我创建了我的员工姓名的索引。但是知道我不知道如何查询该索引，我如何查询索引？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:30:11.513

从员工中选择 *

或者如果您使用的是 PHP

mysql_query("SELECT * FROM 员工");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:48:37.653

你的问题很模糊，但是一旦你创建了索引，mySQL 应该尽可能地自动查询它。如果您`EXPLAIN`在查询的开头添加关键字，mySQL 将输出它*计划*如何执行您的语句，包括它将使用哪些索引。

绝大多数时候你不需要明确告诉 mySQL 使用哪个索引，但是你*可以*使用[索引提示](http://dev.mysql.com/doc/refman/5.1/en/index-hints.html)。

例如：

```
mysql> explain select * from derp_users where user_name LIKE 'user';
+----+-------------+------------+-------+---------------+-----------+---------+------+------+-------------+
| id | select_type | table      | type  | possible_keys | key       | key_len | ref  | rows | Extra       |
+----+-------------+------------+-------+---------------+-----------+---------+------+------+-------------+
|  1 | SIMPLE      | derp_users | range | user_name     | user_name | 98      | NULL |    1 | Using where |
+----+-------------+------------+-------+---------------+-----------+---------+------+------+-------------+
1 row in set (0.00 sec) 
```

# c# - 如何在将文本发送到服务器之前对文本进行 html 编码？

> ID：13072010
> 
> 赞同：1
> 
> 时间：2012-10-25T15:28:34.447
> 
> 标签：c#, asp.net-mvc, url.action

我的 MVC 视图中有以下代码，它获取 TextArea 控件的内容并向 url（操作）发出请求，然后在另一个文本框中显示结果：

```
var input = $('#tbInput').val(); // it can have some invalid characters such as +, #, etc

        var encodedInput = // how?; 

        $.ajax({
            url: url,
            success: function (data) {
                alert(data);
                $('#tbResult').html(data);
            },
            error: function (request, status, error) {
                alert('An error occured: ' + error);
            },
            cache: false
        }); 
```

如果我只发送输入数据，那么无效字符就会被删除，所以我需要对文本进行 html 编码然后发送它？

输入应如下所示：

[http://www.mydomain.com/?i=](http://www.mydomain.com/?i=)

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:31:29.283

让 jQuery 这样做：

```
 $.ajax({
        url: url,
        data: { something: input }, 
```

# php - 在mysql中选择不同并计数不同

> ID：13072011
> 
> 赞同：0
> 
> 时间：2012-10-25T15:28:36.513
> 
> 标签：php, mysql

这是否可能从表列中选择不同的行并计算单个查询中每个不同字段的重复行

```
$sql = "SELECT DISTINCT location and COUNT(DISTINCT location) 
        FROM ".$db_name.".$table_name 
        ORDER BY location ASC 
        LIMIT ". $start_page.",". $recordPer_page.""; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T21:10:41.870

您好，此查询可以帮助您：

[**SQLFIDDLE 示例**](http://sqlfiddle.com/#!2/35005/5)

```
SELECT   `location`, COUNT(`location`) 
    FROM     tbl   
    GROUP BY `location`
    ORDER BY `location` 
```

数据：

```
 ('Africa'),
    ('Viena'),
    ('Mexico'),
    ('Chicago'),
    ('Miami'),
    ('Chicago'),
    ('Viena'),
    ('London'),
    ('Viena'); 
```

结果：

```
| LOCATION | COUNT(`LOCATION`) |
--------------------------------
|   Africa |                 1 |
|  Chicago |                 2 |
|   London |                 1 |
|   Mexico |                 1 |
|    Miami |                 1 |
|    Viena |                 3 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:29:59.090

尝试，

```
SELECT   `location`, COUNT(DISTINCT `location`) 
FROM     ....   
GROUP BY `Location`
ORDER BY ....
LIMIT    .... 
```

# php - 确保浏览器一次显示所有内容

> ID：13072013
> 
> 赞同：2
> 
> 时间：2012-10-25T15:28:49.580
> 
> 标签：php, javascript, jquery, html, dom

我的网站包含大量图像和文本，并且连接速度较慢，互联网浏览器或内存较低的计算机首先加载文本，然后加载图像需要一段时间。如何确保同时显示所有内容？

我想到的解决方案：

1.  输出缓冲 - 在我的 PHP 脚本的顶部`ob_start`和`ob_end_flush`底部，以确保在处理脚本之前没有发送任何内容。
2.  将整个 DOM 加载到 Javascript 变量中，然后在全部加载后将其回显。

您认为哪种方式适用于所有浏览器，甚至适用于速度较慢的计算机？我还没有在具有不同速度和 RAM 的各种平台和计算机上对其进行测试。如果您有媒体重网站的经验或有更好的方法，请告诉我要走哪条路。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T16:23:22.513

如果您有能力依赖 JavaScrip，那么有一个简单有效的解决方案**可以一次显示所有内容**。

1.  在整个窗口的顶部放置一个白色层。这隐藏了所有内容。
2.  使用事件`window.onload`隐藏/移除覆盖层。
3.  使用事件`window.onunload`再次显示隐藏层。

图层：

```
 ...
    <style>
        html, body{ height: 100%; }
        #hiding {
            display:    block;
            width:      100%;
            height:     100%;
            position:   absolute;
            top:        0;
            left:       0;
            background: #fff;
        }
    </style>
</head>
<body>
    <div id="hiding"></div>
    ... 
```

JavaScript 事件：

```
 ...
        <script>
            window.onload = function () {
                document.getElementById('hiding').style.display = 'none';
            };
            window.onunload = function () {
                document.getElementById('hiding').style.display = 'block';
            };
        </scritp>
    </body>
</html> 
```

**注意：**不要将这些样式或 JavaScript 代码放入外部文件中。

**注意 2：**最好在隐藏层的中间放置一个加载微调器。您可以将其添加到`#hiding { ... }`样式块：`background: #fff url(/images/spinner.gif) center center;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:33:02.933

1.  在 CDN 中托管您的图像
2.  使用图像或页面缓存，如 timthumb
3.  使用 javascript 或 jquery 预加载图像
4.  使用 div 或 section 而不是表格进行布局。（我记得那些旧学校网站以及它们是如何加载的）
5.  使用渐进式图像格式
6.  GZIP 压缩

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:37:53.027

当浏览器请求一个 HTML 文档时，它会触发一个 HTTP 调用。然后它开始检查页面内容，当它找到外部资源（css文件、脚本、图像）时，它会**异步发出其他HTTP请求**（通常不超过2个到同一服务器），当资源被成功检索（甚至之前，如果它是一个 CSS 例如），它开始检查它。

所以在 PHP 端你无能为力（缓冲输出？为什么你认为它应该工作？）

如果您的应用程序需要在启动前加载资源（例如，它就像一个带有加载屏幕的游戏），您必须自己管理它。例如，您的主 HTML 文档将仅包含一个 JS 文件，该文件又将下载资源。当所有资源（本例中的图像，加上一些文本文件）都已加载后，脚本将*构建*页面（同样，您可能会发现一些技巧来回收现有技术，例如 DOM，但这绝对取决于您）。

为了加快图像的检索速度，您可以使用高速服务器 (CDN)，或者（如果合适的话甚至更好），您可以将**所有图像**组合成一个大图像，然后在客户端将其拆分。如果您的应用程序确实是游戏，这通常会使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-25T15:40:38.517

当 php 结束时，它会输出 HTML 代码，并在其中输出图像源路径（以及 css、js 等文件）。然后，浏览器将开始新的请求以获取页面所需的外部内容。

如果您尝试一次打印所有内容（一旦图像和其他资源完全加载），那么您可以使用 css 和 js 执行此操作。

使用 css，您可以使用 display: none 规则隐藏页面的“主包装”。如果您愿意，您可以使用“正在加载”文本或基于 gif 的图像来向最终用户显示页面当前正在加载。 .

然后，在 javascript 中实现 window.onload 回调（不是 jquery 就绪事件）。一旦 dom 准备好并且所有资源都已完全加载，Window.onload 事件将触发。[您可以在第二段中看到这一点](http://dean.edwards.name/weblog/2005/09/busted/)

然后，在那个 onload 回调中，您只需要显示：阻止隐藏的“主包装”内容，并删除或隐藏“加载”消息。

# sql-server - 仅在我的机器上运行缓慢的查询

> ID：13072021
> 
> 赞同：1
> 
> 时间：2012-10-25T15:29:06.343
> 
> 标签：sql-server, sql-server-2005, sql-server-2008-r2

我正在**`select * from table`**对 Microsoft SQL Server 2005 运行一个简单的查询。该表有大约 41000 条带有 PK 聚集索引的记录，并且我正在使用 Windows 集成身份验证。

*   当我使用 Microsoft SQL Server Management Studio 在我的机器上运行它时，查询在大约 1 小时 45 分钟内完成。我试过从网格切换到文本输出，从命令行运行它，`SQLCMD`也试过 ececuting `DBCC USEROPTIONS`, `DBCC DROPCLEANBUFFERS`,`DBCC FREEPROCCACHE`在查询之前......没有任何改变查询的速度。

*   当我使用我的凭据从同事的工作站运行它时，查询很快就会正常完成。如果同事使用他们的凭据在我的工作站上运行查询，则查询会非常慢，如上所述。

我已经没有办法解决这个问题了。不知何故，这个问题似乎与我的机器有关，但我无法理解它。还请考虑以下事项：

*   我检查并确保我的机器（Win7-64 位）上未启用 ODBC 跟踪。我已经使用 Microsoft Management Studio 2008 R2 安装了 SQL Server 客户端工具，这就是我用来查询数据库的工具。
*   我也用VS2010运行了同样的sql查询，结果是一样的。
*   我针对同一个表/数据库的副本但在不同的服务器上运行查询，问题仍然存在。
*   当我运行时**`select count(*) from table`**- 查询正常完成，没有延迟。
*   当我使用 SQL Server Profiler 运行跟踪时，查询只是一个长时间运行的查询 - 我看不到任何异常。
*   当我在 MS SQL Server Management Studio 中使用文本输出运行查询时，我可以看到在大约 85 条记录的初始缓冲区之后，后续记录一次大量到达大约 400 条记录。例如 85 -> 407 -> 804 -> 1210 -> 1605 -> 1897 -> 2161 -> 2753 -> 3051 -> 3342 -> 3676 -> 4002 等。与同事工作站相比，您可以在其中查看记录数据到达时被绘制为连续流！？？？
*   我还比较了我机器上的实际查询执行计划和查询正常运行的另一台机器上的实际查询执行计划——它们看起来是相同的。

谁能理解这里可能出了什么问题？为什么从我的机器上运行它很慢，但它从另一个工作站正常执行？...任何建议的操作步骤来解决这个问题？

提前感谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T11:06:06.243

I found the problem - it was a network adapter driver update. Once I rolled back the driver the query executed as expected no delays! ![enter image description here](../Images/6a100154c6f114ce9548eddaa7bab02a.png)

It took me quite a while to nail this down. For the record my network card is "Intel(R) 82579LM Gigabit Network Connection" the rogue network driver came through windows update. My workstation is HP 8200 Elite. After the driver roll back, I downloaded installed the latest network driver from the HP support site and it seems this is the solution - so far I do not have issues with slow running SQL queries :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:32:37.913

你是硬连线到局域网吗？无线上网？检查您的网络延迟，您提供的一切似乎都正常。ping 您的数据库服务器以检查这一点。

我要检查的下一件事是确保当时服务器或数据库上没有其他任何东西在运行。防病毒软件，测试，任何可能减慢数据库速度的东西。另外，您是否通过虚拟框运行此查询？从本地服务器和远程服务器获取执行计划并并排比较它们。他们应该是一样的。如果不是，你就知道有问题。

还要检查每个连接执行查询时使用的用户 SET 选项。这可以产生影响。如果这些都不是问题，我的下一个猜测将是硬件或配置故障

# c++ - OpenCV：假设背景简单，快速删除主题周围的背景？

> ID：13072029
> 
> 赞同：0
> 
> 时间：2012-10-25T15:29:27.297
> 
> 标签：c++, objective-c, image-processing, opencv

我想做一些类似背景去除的事情，有点像斑点检测......

基本上，我的想法是，我希望能够在相当均匀的背景（例如墙壁或铺有地毯的地板）前拍摄人或其他物体的照片。然后，通过尽可能少的用户交互和参数，我想完全移除该背景，让我的主题处于纯白色背景上。

我意识到如果主题有任何与背景相似的颜色，但没有完全被其他颜色包围（例如，一个穿着白衬衫站在白墙前的人），我可能不走运。没关系。我只是希望它在*大多数*情况下都能正常工作。

由于我需要在 C、C++ 和/或 Obj-C 中工作，我希望 OpenCV 是在这里使用的正确工具包，但如果我真的错了，请插话……假设它确实是使用 OpenCV 的好计划，什么可能是做我想做的事情的最佳方式？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T20:56:01.403

您应该使用**OpenCV 的 Grabcut 分割**来提取前景，在您的情况下是一个人

# gradle - 避免类似 Gradle 任务之间的重复？

> ID：13072034
> 
> 赞同：26
> 
> 时间：2012-10-25T15:29:35.033
> 
> 标签：gradle

有什么方法可以避免相同类型的两个类似任务之间的配置重复？

例如，我想创建一个`debugSomething`任务，其配置与`runSomething`以下相同，但在 jvmArgs 中添加了远程调试器参数：

```
task runSomething(dependsOn: jar, type: JavaExec, group: "Run") {
    jvmArgs "-Xmx1024m", "-XX:MaxPermSize=128m"
    main = "com.some.Main"
    classpath = sourceSets.main.runtimeClasspath
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-28T16:51:32.610

我发现使用该`Task.configure`方法对于集中这样的逻辑非常有帮助。

我尚未对其进行测试，但在您的情况下，这可能如下所示：

```
def commonSomething = {
    main = "com.some.Main"
    classpath = sourceSets.main.runtimeClasspath
    jvmArgs "-Xmx1024m", "-XX:MaxPermSize=128m"
}

task runSomething(dependsOn: jar, type: JavaExec, group: "Run") {
    configure commonSomething
}

task debugSomething(dependsOn: jar, type: JavaExec, group: "Run") {
    configure commonSomething
    jvmArgs ...add debug arguments...
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-06T15:47:13.500

这可以使用普通的 Groovy 解决：

```
task runSomething(dependsOn: jar, type: JavaExec, group: "Run") {
}

task debugSomething(dependsOn: jar, type: JavaExec, group: "Run") {
    jvmArgs "-agentlib:jdwp=transport=dt_socket,server=y,address=8000,suspend=y"
}

[runSomething, debugSomething].each { task ->
    task.main = "com.some.Main"
    task.classpath = sourceSets.main.runtimeClasspath
    task.jvmArgs "-Xmx1024m", "-XX:MaxPermSize=128m"
} 
```

即使`debugSomething.jvmArgs`被调用两次，所有三个参数都提供给 JVM。

可以使用 Groovy 的[Spread 运算符](http://groovy.codehaus.org/Operators#Operators-SpreadOperator)设置单个参数：

```
[runSomething, debugSomething]*.main = "com.some.Main" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-17T15:10:51.620

我一直在寻找类似的东西，但**我不想在****所有**相同类型的任务之间共享配置，而只是为了其中一些任务。

我已经尝试过类似接受的答案中所述的方法，但效果不佳。那我再试一次。

当我来到这里时，我不介意分享，（至少现在）有一种更好的 Gradle 内置方式来实现这里提出的问题。它是这样的：

```
tasks.withType(JavaExec) {
    jvmArgs "-Xmx1024m", "-XX:MaxPermSize=128m"
    main = "com.some.Main"
    classpath = sourceSets.main.runtimeClasspath
} 
```

这样，所有`JavaExec`类型的任务都将接收默认配置，显然可以通过相同类型的任何特定任务来更改该配置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T15:54:05.140

请参阅[手册第 51.2 节](http://gradle.org/docs/current/userguide/custom_tasks.html)。AFAICT，它准确地显示了你想要的。

# linux - HID回调函数 - linux等效？

> ID：13072035
> 
> 赞同：0
> 
> 时间：2012-10-25T15:29:40.137
> 
> 标签：linux, usb, hid

我有一个带有 Windows DLL 的 HID 电话监视器。我想把它移植到linux。

该软件依靠回调函数来报告事件。

鉴于此设备不支持 Linux，我不得不依赖 libusb 和 hidapi 等低级 API 进行通信。我不清楚如何使用其中任何一个来实现事件回调。

会是非阻塞读取吗？相似的东西？

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:33:37.210

阻塞读取，只要它位于专用文件描述符上，就应该没问题。然后应用程序可以使用`select()`（或顶部的适当抽象）来等待事件，同时等待其他描述符上的其他事件。

似乎[libusb](http://libusb.sourceforge.net/api-1.0/group__poll.html)对处理设备的同步和异步读取有很多支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:45:46.310

HID 设备已经暴露在 /dev/input 下，大概你的设备会生成关键事件。一般来说，您使用 lsusb 或遍历 sysfs 找到您的设备，打开 /dev/input/eventN（或者可能是 udev 创建的 by-id 或 by-path 链接之一）以获取文件描述符，并读出事件。有关界面上的文档，请参见`Documentation/input/input.txt`内核树。这很简单。

如果没有有关您设备的更多信息，很难为您提供更具体的建议。

# c# - ASP.NET 多线程

> ID：13072036
> 
> 赞同：1
> 
> 时间：2012-10-25T15:29:40.883
> 
> 标签：c#, asp.net, multithreading

我有一个 ASP.NET 页面，它向用户列表发送电子邮件 - 这个列表可能相当大，我们发现 ASP.NET 页面经常会超时。

我们想要做的是在一个新线程中发送这些电子邮件，因此当电子邮件进程在后台工作时，ASP.NET 页面会刷新给用户。

不过，我有点难以理解我需要做的事情。这是当前我的 ASP.NET 页面上的按钮单击事件：

```
 protected void btnSend_Click(object sender, EventArgs e)
    {    
        //Populate form data session
        _FormInfo = new Dictionary<string, string>();
        _FormInfo.Add("Name", txtName.Text);
        _FormInfo.Add("Postcode", txtPostcodeDone.Text);

        PostcodeSearcher.PostcodeEmailer(_Companies, _FormInfo);
        mv.ActiveViewIndex = 3;
    } 
```

这是我要调用的方法（在 PostcodeSearcher 类中）

```
 public static void PostcodeEmailer(List<Company> companies, Dictionary<string, string> quote)
        {
            ...
        } 
```

如您所见，我需要在新线程中调用的方法需要接受参数——我在网上只能找到用于调用不带参数的新线程。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:51:00.167

注意 IIS 杀死 ASP.NET 应用程序进程的问题，如果应用程序没有活动的用户请求，IIS 可以做到这一点（经过一些延迟，默认为 20 分钟）。这意味着您的后台线程可以在完成发送电子邮件的工作之前被杀死，而用户不会知道这一点。

为了克服这个问题，您可以模拟用户请求，这样运行时就不会杀死应用程序。其他选项（更好但更多工作）是创建一个单独的进程（例如 Windows '后台'服务），它将从 ASP.NET 应用程序（使用例如 WCF 服务）获取命令并将电子邮件发送给用户。要轻松创建 Windows 服务，请参见[http://topshelf-project.com/](http://topshelf-project.com/)

查看有关此问题的更多信息：[如何选择性地在后台线程上运行一些代码？](https://stackoverflow.com/questions/7221302/how-to-optionally-run-some-code-on-a-background-thread)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:33:37.643

使用[此处](http://www.codeproject.com/Articles/189374/The-Basics-of-Task-Parallelism-via-C)找到的 C# 的任务功能。这些对于执行异步命令非常有用（并且实现起来非常简单）。

编辑：

```
Task postcodeTask = new Task(() => PostcodeSearcher.PostcodeEmailer(_Companies, _FormInfo));
postcodeTask.Start(); 
```

# jquery - 计算负百分比保证金时，Safari 中可能存在错误

> ID：13072038
> 
> 赞同：0
> 
> 时间：2012-10-25T15:29:44.807
> 
> 标签：jquery, animation, safari

请考虑这段 js 代码：

```
function scroll(){
    $('.container').css('marginLeft', '-50%');
    $('.container').animate({'marginLeft': 0}, 300);
}​ 
```

示例：http: [//jsfiddle.net/aSXBL/3/](http://jsfiddle.net/aSXBL/3/)

Safari 中有一个奇怪的行为——动画是从“从右到左”而不是“从左到右”发生的。经过一些分析，我发现 jQuery 在这种情况下以正边距值开始动画。

你认为它应该被视为一个错误还是它只是 Safari 的一个特定“功能”？在这种情况下，什么解决方法可能会有所帮助？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T22:08:13.760

我遇到过同样的问题。修复方法是为现代浏览器使用 CSS 过渡，为其余浏览器使用 jQuery 动画。我使用modernizr 来决定提供哪些服务。这使得 Safari 5 使用 CSS，从而避免了这个问题。

```
if( !Modernizr.csstransitions ){
  $('#gallery .slides').animate({"margin-left":'-200%'}, 750);
} else {
  $('#gallery .slides').css({"margin-left":'-200%'});
}
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:57:13.910

显然这是一个错误 - 返回意外结果的百分比（实际上不仅与 animate 函数有关）。看：

```
console.log($('.container').css('marginLeft'));
// 10px as expected
$('.container').css('marginLeft', '-50%');
// object visually moved as expected
console.log($('.container').css('marginLeft'));
// this outputs 300px in Safari 
```

# python - Python 正则表达式 - 模式匹配

> ID：13072042
> 
> 赞同：1
> 
> 时间：2012-10-25T15:29:56.527
> 
> 标签：python, regex, python-2.7

这是我第一次使用正则表达式进行模式匹配的经验，因此不胜感激。

我正在尝试在字符串中搜索以下子字符串：

```
"(TPU 1-999)
http://somewebaddress.com" 
```

我想保留`TPU`,`1-999`和链接作为单独的子字符串。

这是我正在使用的模式：

```
^\s{3}\(([AEINPRSTUW]{3})\s(\d{1,3}.\d{2,5})\)$^\s{3}(http+\s{1,100})$ 
```

我会分解它来解释我的推理

`^\s{3}`- 字符串开头（或本例中的行），后跟 3 个空格

`\(`- 左括号

`([AEINPRSTUW]{3})`- 括号中任何字母的 3 个实例，TPU 是一个例子

`\s(\d{1,3}.\d{2,5})`- 一个空格，然后是 1-3 个数字，由 2-5 个数字中的任意字符分隔

`\)$`- 右括号，行尾

`^\s{3}`- 下一行的开头后跟三个空格

`(http+\s{1,100})$`- 字符“http”后跟 1 到 100 个非空白字符以及行尾。

这种模式现在不起作用，但我是否朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:44:56.870

`$^`这行不通。`$`是行尾（在换行之前），`^`是行的开头（在换行之后）。但是换行符是一个字符（或两个），同时不推进正则表达式引擎的位置。因此`$`，并`^`尝试匹配相同的位置，这只有在它们是空行的结尾和开头时才会发生 - 即使这样将它们按此顺序排列也会产生很大的误导。如果您想确保它们之间恰好有一个换行符，请尝试以下操作：

```
^\s{3}\(([AEINPRSTUW]{3})\s(\d{1,3}.\d{2,5})\)$(\r\n?|\n)^\s{3}(http+\S{1,100})$ 
```

但是，正如 ridgerunner 指出的评论，以下`\s{3}`可以匹配（最多 3 个）更多的换行符，因为它们也是空格。

另请注意，`.`作为数字的分隔符可能不是最好的主意。至少，使用非数字字符：

```
^\s{3}\(([AEINPRSTUW]{3})\s(\d{1,3}\D\d{2,5})\)$(\r\n?|\n)^\s{3}(http+\S{1,100})$ 
```

另请注意，我已将您的最后一个更改`\s`为`\S`（因为`\s`是空格，`\S`是非空格）。

另请注意，您向我们展示的字符串不包含您尝试匹配的那三个空格。因此，将它们设为可选（正如 CaptainMurphy 建议的那样）也可能会有所帮助：

```
^\s*\(([AEINPRSTUW]{3})\s(\d{1,3}\D\d{2,5})\)$(\r\n?|\n)^\s*(http+\S{1,100})$ 
```

由于我们已经匹配了换行符，我们也可以完全删除那里的锚点，它们不再有帮助：

```
^\s*\(([AEINPRSTUW]{3})\s(\d{1,3}\D\d{2,5})\)(\r\n?|\n)\s*(http+\S{1,100})$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:49:02.760

我认为您对大写字母和特定数量的空格等内容过于具体（您的示例字符串开头甚至没有空格）。我大多只是坚持 * 和 + 除非我正在寻找非常具体的东西。正如另一个答案指出的那样， $ 是整个记录（字符串）的结尾，而不是行尾。换行符或 CRLF 只是空格。不要将 \s 甚至 [^\s] 用于非空白，使用 \S。

```
ss="(TPU 1-999)\nhttp://something.com"
rr="^\s*\(([A-Z]+)\s+(\d+.\d+)\)\s+(http\S{1,100})$"
re.match(rr,ss).groups()
('TPU', '1-999', 'http://something.com') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T18:11:27.470

这个我真的是想多了。这是我根据提供的答案提出的解决方案：

这是我正在解析的字符串的示例（从电子邮件的内容中提取）：

`'The writeboard named "10/26 newsletters (Pat)" has been created:\r\n\r\n (TPU 1000+)\r\n\r\n http://www.techproductupdate.com/resources/2313/splunk-app-for-vmware-delivers-insight-into-the-cloud\r\n\r\n (TIN 250+)\r\n\r\n http://www.techproductupdate.com/resources/2369/securing-mysql-databases\r\n\r\n (TPU 500+)\r\n\r\n http://www.techproductupdate.com/resources/2333/designing-a-data-protection-strategy-with-hp-lefthand-hp-storeonce-and-hp-tape\r\n\r\n- - -\r\nYou can visit the writeboard at:\r\n http://somewebsite.com\r\n'`

所以首先我只是使用`re.findall`模式来定位括号之间的所有内容`'\((?P<list>[A-Z]*)\s(?P<segments>.+)\)'`

然后我使用`re.findall`该模式定位所有 URL - 这将返回我想要的所有结果以及列表末尾的`'http\S*'`额外结果。`'http://somewebsite.com'`

然后我只是将这些列表压缩在一起，不包括最后一个列表的最后一个元素，我基本上得到了我首先要寻找的结果。

# wpf - 在同一个应用程序中使用 Prism 和 GalaSoft MVVM 工具包是多余的吗？

> ID：13072047
> 
> 赞同：3
> 
> 时间：2012-10-25T15:30:01.280
> 
> 标签：wpf, mvvm, prism, toolkit

我刚刚接到任务，开始支持使用 Prism 和 GalaSoft 工具包的 WPF 应用程序。在审查了这两个框架的技术之后，在我看来，应用程序的设计者是多余的，因为 Prism 提供了一个促进 MVVM 的框架，以及一个允许集成模块的容器。我看到的方式是每个模块都可以实现自己的Model-View-VIewModel。Prism 可以提供所需的一切，以及模块之间的通信和导航。我还注意到该应用程序正在使用的 GalaSoft 版本在工具包的官方下载页面中不存在。莫非这个版本是官方下载版修改的？

这是我第一次处理 WPF 技术。即初学者，我将不胜感激有关此问题的任何评论，以及有关处理此实现的最佳方法的建议。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:51:50.810

它们在某种程度上是多余的：**Prism**几乎提供了**MVVMLight**中的所有内容。

几乎，因为我确信 Prism 中没有一些特定于 MVVMLight 的功能。Prism 要大得多，它提供了一个完整的框架和方法来构建您的 MVVM 应用程序，而 MVVMLight 只是为您提供工具（不必塑造您的架构）来更​​轻松地处理 MVVM 问题。

我认为一个应用程序不需要它们两者，但也许是谁使用了 MVVMLight 的特定功能。如果代码构建时考虑到一致性，这显然不是一件坏事，*例如*，所有 ViewModel 都使用 Prism 基础，但对于消息传递（中介模式），它使用 MVVMLight，因为我知道很多人喜欢 MVVMLight Messenger 而不是 Prism 的 EventAggregator。但可能背后有更好的理由，这只是一个例子，我没有看到你的代码。

无论如何，我认为只使用其中一个会更清洁。如果此应用程序需要 Prism 的强大功能，则仅使用它，但如果这是一个轻量级应用程序，那么我建议使用 MVVMLight（因此是此库的名称 :)）。

对于 MVVMLight 版本：也许它只是你拥有的旧版本，但你应该询问这个应用程序的作者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:51:15.737

两人有不同的目标。Prism 旨在促进复合应用程序，而 MVVMLight 旨在提供准系统 MVVM 支持。Prism 必然包括它自己的 MVVM 支持，所以我同意同时使用两者是多余的。我还要补充一点，在非复合应用程序中使用 Prism 可能是矫枉过正。

# c# - C# ASP.NET 中 DataTable 中的动态单选按钮

> ID：13072055
> 
> 赞同：-1
> 
> 时间：2012-10-25T15:30:31.263
> 
> 标签：c#, asp.net

我正在创建动态数据表并将其分配给 gridview。我需要为表格的每一行添加一个单选按钮。但我试过了，但无法让它工作。

```
if (dt == null)
{
    dt = new DataTable("Shedules");
    DataColumn c0 = new DataColumn("Radio", typeof(RadioButton));
    DataColumn c1 = new DataColumn("SID", typeof(System.Int32));
    DataColumn c2 = new DataColumn("FID", typeof(System.Int32));
    DataColumn c3 = new DataColumn("FROM", typeof(System.String));

    dt.Columns.Add(c0);
    dt.Columns.Add(c1);
    dt.Columns.Add(c2);
    dt.Columns.Add(c3);

    dt.PrimaryKey = new DataColumn[] { c1 };
}

foreach (AgentPortal.SriLankanWebService.Shedule shedule in air1Response)
{
    DataRow dr = dt.NewRow();

    RadioButton rb1 = new RadioButton();
    rb1.GroupName = "depart";
    rb1.ID = shedule.Sid.ToString();
    dr["Radio"] = rb1;

    dr["SID"] = (int)shedule.Sid;
    dr["FID"] = (int)shedule.Fid;
    dr["FROM"] = (String)shedule.FromLocation;
    dt.Rows.Add(dr);
}

GridView1.DataSource = dt;
GridView1.DataBind(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:35:25.217

尝试查看以下链接

[http://www.devasp.net/net/articles/display/549.html](http://www.devasp.net/net/articles/display/549.html)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:07:10.633

将单选按钮组作为 RadioButtonList 包含在您的 GridView 中

```
<asp:GridView ID="GridView1" runat="server">  
<Columns>

   <asp:TemplateField>

      <asp:RadioButtonList runat="server" ID="scheduleList" DataTextField="ScheduleName"
          DataValueField="ScheduleID" />

      </asp:TemplateField>

   <asp:BoundField DataField="SId" HeaderText="SID" />
   <asp:BoundField DataField="FId" HeaderText="FID" />
   <asp:BoundField DataField="FROMLocation" HeaderText="FROM" />
</Columns>
</asp:GridView> 
```

在后面的代码中

```
 protected void Page_Load(object sender, EventArgs e)
 {
   GridView1.DataSource = air1Response; //bind your airResponse directly to GridView
   GridView1.DataBind();

 }

 protected void gvSchoolClasses_RowDataBound(object sender, GridViewRowEventArgs e)
 {
    RadioButtonList scheduleList = (RadioButtonList) e.Row.FindControl("scheduleList");
    scheduleList = air1Response;
    scheduleList.DataBind();
 } 
```

阅读有关[GridView 事件的更多信息](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview_events.aspx)

# css - 使用 css 设置表单样式

> ID：13072064
> 
> 赞同：0
> 
> 时间：2012-10-25T15:30:58.423
> 
> 标签：css

第一次来这里。我想使用 css 设置表单的样式，但完全失败了。表格位于[http://opm.nulep.org/2012-10-17-04-17-46/alrep.html](http://opm.nulep.org/2012-10-17-04-17-46/alrep.html)

我希望这些字段位于垂直列中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:40:47.930

好吧，在这种情况下，我建议使用`<div>`宽度为 25% 的 s 或表格。桌子通常比较笨重，**不推荐使用**，尽管我提到它们纯粹是为了给你一个选择。

如果您想使用`<div>`s 的四列布局，请尝试以下操作：

```
<form>
    <div style="width: 25%; float: left;">Contractor options here...</div>
    <div style="width: 25%; float: left;">District options here...</div>
    <div style="width: 25%; float: left;">Subcounty options here...</div>
    <div style="width: 25%; float: left;">End date options here...</div>
</form> 
```

我建议将`style`选项移动到外部样式表或内部样式表（因此要么是 stylesheet.css 文件，要么只是在`<style>`标签之间的文件顶部）。

对于表格，请遵循以下内容：

```
<form>
    <table>
        <tr>
            <td>Contractor options here...</td>
            <td>District options here...</td>
            <td>Subcounty options here...</td>
            <td>End date here...</td>
        </tr>
    </table>
</form> 
```

同样，我不建议使用表格进行布局，因为将它们用于实际[表格数据](http://webdesign.about.com/od/tables/a/aa122605.htm)是一种更好的做法，但初学者通常会发现表格更易于使用。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:47:34.103

您应该将每个 h3 和下拉 div 放在一个宽度为 200px 的浮动 div 中。6px 的右边距（对于前两个 div 包装器）在它们三个之间保持一点距离。

html（4次）：

```
<div class="dropdown_wrapper">
  <h3 ...>
  <div>...</div>
</div> 
```

在 CSS 样式表中：

```
.dropdown_wrapper { float: left; width: 200px; margin-right: 6px; }
.dropdown_wrapper:last-child { margin-right: 0 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:37:49.440

你的意思是让三个在一条线上彼此相邻？

在这种情况下，您可以将每个字段的 h3 和 div 包装在另一个 div 中，这将有一个近似值。一个 300px 的宽度和一个浮点数。

html

```
<form>
   <div class="column">
      <h3>...</h3>
      <div>form item</div>
   </div>
   <div class="column">
      <h3>...</h3>
      <div>form item</div>
   </div>
   <div class="column last">
      <h3>...</h3>
      <div>form item</div>
   </div>
</form> 
```

css

```
.column {float: left; width : 300px; margin-right : 10px;}
.last {margin-right: 0;} 
```

然后你调整宽度和边距以适合你的母亲 div！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:38:21.657

您可以使用表格或一些浮动 div。每个解决方案都有优点和缺点。

分区解决方案：

```
<style type="text/css">
    .column { width: 200px; float: left; }
    .clear { clear: both }
</style>
<form>
    <div class="column">
        <input />
        ...
    </div>
    <div class="column">
        <input />
        ...
    </div>
    <div class="clear"></div>
</form> 
```

桌子：

```
<form>
    <table>
        <td>
            <input />
            ...
        </td>
        <td>
            <input />
            ...
        </td>
    </table>
</form> 
```

# .net - 使用 x-www-form-urlencoded 而非 application/json 发布时绑定 JSON

> ID：13072067
> 
> 赞同：3
> 
> 时间：2012-10-25T15:31:22.113
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-4

`DefaultModelBinder`当使用`x-www-form-urlencoded`而不是POST 数据时，有没有办法让POST 工作`application/json`，但值的实际有效负载是 JSON 编码的？

例如，我收到一个键值对：

```
key: 'events' 
value: '[{"event":"inbound","ts":1350928095,"msg":{"raw_msg":"Received"}}]' 
```

在这种情况下，该值包含 JSON 数组。

**注意：POST 来自第 3 方，因此我无法控制它。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:35:30.430

*如果您在单个操作中需要此行为，请*使用`JavaScriptSerializer`将 JSON 内容反序列化为集合并使用`UpdateModel`/`TryUpdateModel`方法验证集合。

*如果您需要许多操作*，那么您必须通过继承`DefaultModelBinder`并覆盖该`CreateModel`方法来使用自定义模型绑定器。在该`CreateModel`方法中，使用`JavaScriptSerializer`POST 值创建对象。

```
public class CustomModelBinder: DefaultModelBinder
{
   protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType)
  {
     // JavaScriptSerializer serializer = new JavaScriptSerializer();
     // return serializer.DeserializeObject(read the value from request);
  }
} 
```

现在您可以使用该属性重用`CustomModelBinder`跨操作。`Bind`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:34:27.493

一般来说，答案是“当然。只需使用'NAME=VALUE'（例如'data=MYJSON'），并且不要忘记在发送之前进行编码。”

这是一个例子：

*   [“application/x-www-form-urlencoded”类型的 C# HttpWebRequest - 如何在内容正文中发送“&”字符？](https://stackoverflow.com/questions/5665558/c-sharp-httpwebrequest-of-type-application-x-www-form-urlencoded-how-to-send)

但是，重新阅读您的问题，您正在使用 MVC4。这可能会对简单的 C# 或 Java 程序施加限制:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:36:02.247

我不这么认为。您可以更改客户端以发布应用程序/json 内容类型或编写自定义模型绑定器。

# php - 带有codeigniter的MySQL DISTINCT ...非常奇怪的行为

> ID：13072073
> 
> 赞同：1
> 
> 时间：2012-10-25T15:31:39.833
> 
> 标签：php, mysql, codeigniter, activerecord, mysqli

好的，为了简单起见，我需要遍历`DISTINCT`这个表中每一列的结果，`PRINTS`现在这里是奇怪的部分......

```
$this->db->distinct();
$this->db->select('PRINTS.COLOR');
$q = $this->db->get('PRINTS');
return $q->result(); 
```

好的`COLOR`是表中的一个 COL`SIZE`并且`PAPER` --- 好的准备好，因为这是它变得奇怪的地方......

如果我这样做`$this->db->select('PRINTS.SIZE');`，我可以遍历表中的`DISTINCT`值`SIZE`。

**然而**

如果我这样做，`$this->db->select('COLOR');`我会收到错误：发生数据库错误/错误号：1054 / 未知列`'COLOR' in 'field list'`

同样的事情也发生`PAPER`了——似乎只能`SIZE`按应有的方式工作。根据 CODEIGNITER DOCS，我需要做：`$this->db->select('COLOR, PAPER, SIZE');`但我收到一个未知`COL`错误。拼写正确。任何人都可以阐明这一点吗？到底是怎么回事？泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T20:38:54.800

如果您只需要每种类型的不同行，则只能单独使用这些特定列。

```
$this->db->distinct();
$this->db->select('COLOR');
$q = $this->db->get('PRINTS');
$q_color = $q->result();

$this->db->distinct();
$this->db->select('SIZE');
$q = $this->db->get('PRINTS');
$q_size = $q->result();

$this->db->distinct();
$this->db->select('PAPER');
$q = $this->db->get('PRINTS');
$q_paper = $q->result(); 
```

正如@Rocket Hazmat 指出的那样，如果您有任何混合结果，它们将被视为不同的行。我的建议是 a) 创建额外的表来保存这些值（首选），或者 b) 用可用的不同值修改表列。

示例 COLORS 表如下所示：

```
Colors
id    | name
----------------------
1     | red
2     | blue
3     | green 
```

然后对此的查询很容易获得所有可用的颜色：

```
$q = $this->db->get('COLORS'); 
```

既然您提到这是从 CSV 文件导入的，我想说您可以在导入 CSV 后执行必要的处理以获取不同的值，如上所示，然后将它们放入 COLORS 表中。

最后，我认为最好的方法是在获取数据后进行一些[简单的规范化](http://searchbusinessintelligence.techtarget.in/tutorial/Database-normalization-in-MySQL-Four-quick-and-easy-steps)，以便更好地查询数据，并提高应用程序的性能。

# cakephp - CakePHP 在所有控制器中读取 cookie

> ID：13072076
> 
> 赞同：0
> 
> 时间：2012-10-25T15:31:47.410
> 
> 标签：cakephp, cookies

今天我有一个关于 cakePHP cookie 的问题。如何告诉 cake php 记住所有应用程序控制器中的 cookie？

我想做简单的协议接受。

例如，我有 2 个控制器。协议和信息页。用户必须接受协议才能在我的应用程序上查看信息页和其他内容。

这是我的协议控制器（仅示例）：

```
class AgreementController extends AppController {
    var $components = array('Cookie'); 

    public function acceptAgreement(){
        $this->Cookie->write('agreements', 'accepted');
    }
} 
```

这是我的页面控制器（仅示例）：

```
class InfopagesController extends AppController {
public function showPage(){
    $cookie = $this->Cookie->read('agreements');
    if($cookie=="accepted"){
        /* CODE TO SHOW PAGE */
    }
    else{
        /* REDIRECT TO AGREEMENTS */
    }
} 
```

如果 cookie 为空，我想将我的应用程序的所有控制器重定向到协议控制器。我尝试这样做，但 cakephp 仅在协议控制器的操作中记住 cookie。

我的 cookie 组件的定义（在协议控制器中）

```
function beforeFilter() {
  $this->Cookie->name = 'regulamin';
  $this->Cookie->time =  3600;
} 
```

有谁能够帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:30:15.093

将检查添加到您 AppController::beforeFilter()

```
 $cookie = $this->Cookie->read('agreements');
   if ($cookie != "accepted" && (get_class($this) != 'YOUR-AGREEMENTS-CONTROLLER' && $this->action != 'AGREEMENTS-ACTION')) {
        /* REDIRECT TO AGREEMENTS */
   } 
```

如果您访问它，请确保您没有重定向到协议页面，如果您不这样做，您最终会出现重定向循环。将我的示例中的条件更改为您需要检查用户是否尝试访问协议页面的任何条件。

还要确保在控制器 beforeFilter() 调用中调用 parent::beforeFilter()。如果您不知道调用父方法或如何正确使用它，请阅读有关 phps OOP 的信息。[http://php.net/manual/en/language.oop5.php](http://php.net/manual/en/language.oop5.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:41:20.840

使用会话。Cakephp 网站有一些关于阅读和写作的好信息。见[http://book.cakephp.org/2.0/en/development/sessions.html](http://book.cakephp.org/2.0/en/development/sessions.html)

如果会话为空，还将会话检查放在 beforeFilter() 回调中的 app_controller.php 中以转发所有内容。[http://book.cakephp.org/2.0/en/controllers.html](http://book.cakephp.org/2.0/en/controllers.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:17:23.903

也许在 InfopagesController 中不起作用，因为您忘记加载 Cookie 组件，正如您在 AgreementController 中所做的那样。

在此之后，在您的 AppController::beforeFilter() 检查：

1）什么是控制器；

2）如果控制器不等于“AgreementController”，则检查用户是否有cookie。

您需要检查是否不等于“AgreementController”，否则会创建无限重定向。

# c# - c# 从 chlid 实例中获取父级

> ID：13072077
> 
> 赞同：2
> 
> 时间：2012-10-25T15:31:58.337
> 
> 标签：c#, class, reflection, types, instance

我尝试获取实例的父类型。我能怎么做 ？

例子 ：

```
public class a
{
     public b { get; set; }
}

public class b
{

}

var a = new a();
a.b = new b();

var parentType = a.b.??GetParentInstanceType()?? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:39:49.203

你不能。

您需要手动向子级添加一个属性以跟踪父级：

这是一种方法：

```
public class A
{
    public B<A> Child { get; set; }
}

public class B<T>
{
    public T Parent { get; set; }
}

A a = new A();
a.Child = new B<A>();
a.Child.Parent = a;

Type parentType = a.Child.Parent.GetType(); 
```

当然这里的问题是没有什么能阻止你忘记设置`Parent`或设置错误`Parent`。

# javascript - 使用 jQuery.on() 将事件附加到空数组

> ID：13072079
> 
> 赞同：1
> 
> 时间：2012-10-25T15:32:04.900
> 
> 标签：javascript, jquery, jquery-events, jquery-on

另一个我要谋杀巴里的问题。

您可以使用 jQuery 将事件附加到空数组`.on()`吗？

```
var barry = new Person();
var steve = new Person();
var paul = new Person();

var people = [];

function Person() {

}

Person.prototype.murder = function() {
    $(this).triggerHandler("murder");
}

/*
    If I apply .on to an empty array the event is never triggered why?
            $(people).on("murder", function(){
       console.log("call the police");
    })

 */

people.push(barry)
people.push(steve)
people.push(paul)

$(people).on("murder", function() {
    console.log("call the police");
})

barry.murder();​ 
```

这是一个暗示你不能[的小提琴；](http://jsfiddle.net/ashanova/ZYkQm/2/)但为什么不呢？我会假设数组是委托对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:41:07.050

您没有将事件绑定到数组。`$`在数组上调用函数`[a,b,c]`与`$(a).add(b).add(c)`. 和`$([])`just 一样`$()`（一个空的 jQuery 对象）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:34:55.693

可以，但是 jQuery 不会神奇地为您合成触发方法。

```
people.trigger("murder"); 
```

它也不会触发恰好在数组中的值的事件；没有从数组元素冒泡到包含数组的事件。事件冒泡在 DOM 中起作用，而不是在 JavaScript 数据结构中。

*编辑*——哦，对不起，我现在看到您已经创建了自己的`.murder()`API。好吧，但是您仍然遇到事件冒泡的问题。

对象和碰巧包含对它的引用的任何数组之间没有牢固的关系。您可以扩展您的 API，以便您的“Person”对象可以知道将事件发送到哪里。

*再次编辑*——哦，我现在感觉很蠢——这真的与将数组作为对象没有任何关系。当您将 jQuery 对象包装在数组实例周围时，库会将其解释为将数组*元素*视为 jQuery 对象成员的请求。因此，当您添加事件处理程序时，数组实际上与它没有任何关系：您将处理程序添加到各个元素。

# z3 - 通过 C/C++ API 在 Z3 中消除 LIA 的量词

> ID：13072081
> 
> 赞同：3
> 
> 时间：2012-10-25T15:32:09.083
> 
> 标签：z3, quantifiers

我想使用 Z3 通过 C/C++ API 消除线性整数算术公式中的量词。考虑一个简单的例子：Exists (x) (x <= y & y <= 2*x)。具有相同模型的无量词公式是 y >= 0。

我试着这样做：

```
 context ctx;
   ctx.set("ELIM_QUANTIFIERS", "true");
   expr x = ctx.int_const("x"); 
   expr y = ctx.int_const("y"); 
   expr sub_expr = (x <= y)  && (y <= 2*x);

   Z3_ast qf = Z3_mk_exists_const(ctx, 0, 1, (Z3_app[]) {x}, 
                                  0, {}, // patterns don't seem to make sense here.
                                  sub_expr); //No C++ API for quantifiers :(
   qf = Z3_simplify(ctx, qf);
   cout << Z3_ast_to_string(ctx, qf); 
```

我得到的是

> (存在 ((x Int) (and (<= xy) (<= y (* 2 x))))

而我想获得类似的东西

> (<= 0 年)

Z3有可能获得它吗？提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:34:56.373

Nikolaj 已经指出可以使用策略来执行量词消除。在这篇文章中，我想强调如何安全地混合 C++ 和 C API。Z3 C++ API 使用引用计数来管理内存。`expr`本质上是一个“智能指针”，它为我们自动管理引用计数器。我在以下帖子中讨论了这个问题：[Array select and store using the C++ API](https://stackoverflow.com/questions/12995317/array-select-and-store-using-the-c-api)。

因此，当我们调用返回 Z3_ast 的 C API 时，我们应该使用函数`to_expr`或`to_sort`包装结果`to_func_decl`。的签名`to_expr`是：

```
inline expr to_expr(context & c, Z3_ast a); 
```

通过使用此功能，我们避免了内存泄漏和崩溃（当访问已被 Z3 垃圾回收的对象时）。这是使用`to_expr()`. 您可以通过将此功能复制到 Z3 发行版文件夹中的`example.cpp`文件中来测试它。`c++`

```
void tst_quantifier() {
    context ctx;
    expr x = ctx.int_const("x"); 
    expr y = ctx.int_const("y"); 
    expr sub_expr = (x <= y) && (y <= 2*x);
    Z3_app vars[] = {(Z3_app) x};

    expr qf = to_expr(ctx, Z3_mk_exists_const(ctx, 0, 1, vars,
                                              0, 0, // patterns don't seem to make sense here.
                                              sub_expr)); //No C++ API for quantifiers :(
    tactic qe(ctx, "qe");
    goal g(ctx);
    g.add(qf);
    std::cout << qe.apply(g);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T00:21:21.820

简化器不再调用量词消除过程。量词消除和许多其他特殊目的的简化重写可通过策略获得。

C++ 包装器 z3++.h 公开了创建策略对象的方法。您必须为“qe”策略创建一个策略对象。Z3 发行版附带了几个示例，用于使用 z3++.h API 中的策略。例如：

```
void tactic_example1() {
/*
  Z3 implements a methodology for orchestrating reasoning engines where "big" symbolic
  reasoning steps are represented as functions known as tactics, and tactics are composed
  using combinators known as tacticals. Tactics process sets of formulas called Goals.

  When a tactic is applied to some goal G, four different outcomes are possible. The tactic succeeds
  in showing G to be satisfiable (i.e., feasible); succeeds in showing G to be unsatisfiable (i.e., infeasible); 
  produces a sequence of subgoals; or fails. When reducing a goal G to a sequence of subgoals G1, ..., Gn, 
  we face the problem of model conversion. A model converter construct a model for G using a model for some subgoal Gi.

  In this example, we create a goal g consisting of three formulas, and a tactic t composed of two built-in tactics: 
  simplify and solve-eqs. The tactic simplify apply transformations equivalent to the ones found in the command simplify. 
  The tactic solver-eqs eliminate variables using Gaussian elimination. Actually, solve-eqs is not restricted 
  only to linear arithmetic. It can also eliminate arbitrary variables. 
  Then, sequential composition combinator & applies simplify to the input goal and solve-eqs to each subgoal produced by simplify. 
  In this example, only one subgoal is produced.
*/
std::cout << "tactic example 1\n";
context c;
expr x = c.real_const("x");
expr y = c.real_const("y");
goal g(c);
g.add(x > 0);
g.add(y > 0);
g.add(x == y + 2);
std::cout << g << "\n";
tactic t1(c, "simplify");
tactic t2(c, "solve-eqs");
tactic t = t1 & t2;
apply_result r = t(g);
std::cout << r << "\n"; 
```

}

在您的情况下，您需要以下内容：

```
context ctx;
expr x = ctx.int_const("x"); 
expr y = ctx.int_const("y"); 
expr sub_expr = (x <= y)  && (y <= 2*x);

Z3_ast qf = Z3_mk_exists_const(ctx, 0, 1, (Z3_app[]) {x}, 
                              0, {}, // patterns don't seem to make sense here.
                              sub_expr); //No C++ API for quantifiers :(
tactic qe(ctx, "qe");
goal g(ctx);
g.add(qf);
cout << qe.apply(g); 
```

# postgresql - 新系统但遗留依赖的数据库设计

> ID：13072084
> 
> 赞同：0
> 
> 时间：2012-10-25T15:32:19.567
> 
> 标签：postgresql, database-design, legacy

我们计划在 PHP（Symfony 2）和 PostgreSQL 中创建一个 Web 应用程序的新项目（完全重新启动）。目前我们使用 PHP 和 MySQL (MyISAM)。**-> 网络应用程序**

当前和新的 webapp 依赖于另一个系统 (.NET)，包括一个数据库 (MS SQL 8 / 2000)，它不会很快被修改（更改或合并数据库），因为整个 megillah 有一个复杂的工作流程 **-> 遗留系统**
BTW：最大的表总共有 2700 万行

大多数数据/表格每天都会多次从遗留数据库**传输**到 webapp 数据库。对于新的 webapp，我们已经重新设计了大部分数据库模式，所以我们现在几乎有一个规范化的模式（遗留数据库的模式是大量冗余并且非常混乱）

当前，**传输**作业尝试**插入**数据。当特定代码出现异常时，我们知道该行已经存在，然后进行**更新**。这是因为性能（更新前没有选择）。

对于新的 webapp 模式，我们仍然希望使用与旧数据库中相同的主 ID。但是有一些问题，其中之一：一些表的主键看起来像一个整数，但它们不是。大多数行都有整数，例如`123456`，但是，有些行的字符像`123456P32`。

现在新模式有两个选项：

1.  对 PK 和风险性能问题使用字符串类型
2.  PK 使用整数类型并进行转换 转换可能如下所示（基于字符）

    ```
    legacy      new
    --------------------------
    0           10
    1           11
    2           12
    .           ..
    9           19
    a           20
    b           21
    .           ..
    y           45    
    z           46
    A           50 (not 47, because the arity of the second digit is 'clean' with 50)
    B           51
    .           ..
    Z           76 
    ```

旧版 pk **123**将转换为**111213**，因此长度是原始长度的两倍。另一个例子**123A9** -> **1112135019**。因为每个字符都有两位数字，所以它也可以转换回来。

我的第一个疑问是稀疏的 PK 会带来一些性能问题，但是当使用 b-tree（自平衡）作为 Postgres 的默认索引系统的索引时，应该没问题。

你怎么看？您对具有遗留依赖项的类似系统有一些经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:54:59.530

*   带有文本 PK 的 PostgreSQL 性能还不错——为了简单起见，我会选择它。

*   你没有告诉我们这些钥匙能有多长。使用您的转换，普通整数仅适用于 4 个字符键，而 bigint 仅适用于 9。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:11:04.277

使用 CREATE DOMAIN 隔离建议的数据类型。然后构建并测试原型。你很幸运；您不乏有效的测试数据。

```
create domain legacy_key as varchar(15) not null;

create table your_first_table (
  new_key_name legacy_key primary key,
  -- other columns go here.
); 
```

要使用整数键测试第二个数据库，请转储模式，更改那一行（如果您想同时拥有它们，请更改数据库的名称），然后重新加载。

```
create domain legacy_key as bigint not null; 
```

您应该认真考虑完全按原样存储遗留系统的主键。无需调试 - 非常安心。如果您*必须*转换，请小心使用“1234P45”之类的值。如果该字母恰好是*E*或*D*，则某些应用程序会将其解释为表示指数。

如果您使用 10 或 15 个字符的 varchar() 键，尤其是在 9.2 版中，您不应该因为键长度而出现性能问题。在开始之前阅读有关索引的文档。[PostgreSQL 支持的索引种类](http://www.postgresql.org/docs/current/static/sql-createindex.html)比大多数人意识到的要多。

# ruby-on-rails - 在保存之前使用 Rails Paperclip gem 预处理文件

> ID：13072087
> 
> 赞同：3
> 
> 时间：2012-10-25T15:32:27.337
> 
> 标签：ruby-on-rails, paperclip

我在 Rails 3.2 应用程序上使用 Paperclip gem，用户可以在其中上传包含图像和其他信息的专用文件类型（我们称之为“.elf”文件）。

我已经编写了通过一个名为 ElfObject 的类从 elf 文件中提取图像所需的所有代码，并且在应用程序的控制台中进行测试时效果很好。我想要做的是在 Paperclip 将其保存到 AWS S3 之前从 .elf 文件中提取图像和其他数据，将其他数据存储在模型中，然后仅将图像对象保存为 S3 上的 Paperclip 附件。这是模型中的相关代码：

```
class Photo < ActiveRecord::Base

  validates_attachment :attachment,
        :presence => true

  has_attached_file :attachment,
    :storage => :s3,
    [[S3 credentials removed]]

  before_attachment_post_process :import_photo

  attr_accessible :name, :attachment, :properties

  def import_photo
    if attachment_file_name =~ %r{^*\.elf$}
      origfile = attachment.queued_for_write
      elf = ElfObject.read(origfile)
      properties = elf.get_properties 
      attachment = elf.image.write "image_for_#{attachment_file_name}.png"
      save!      
    end
  end 
```

当我尝试在应用程序上以这种方式上传时，它会从*elf = ElfObject.read(origfile)行引发错误***ArgumentError (Invalid argument 'file'. Expected String, got Hash.** ) 。如果我尝试类似*elf = ElfObject.read(origfile.path)*的方法，我会得到**NoMethodError (undefined method `path' for #)**。

 ****显然，我不完全了解如何在文件发布之前从 Paperclip 访问文件——关于我哪里出错以及如何修复它的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:50:50.650

似乎问题正是错误所说的……那`origfile`是 a `Hash`，而不是 a `String`。

如果是这种情况，则`attachment.queued_for_write`返回 a `Hash`，这意味着您需要找到保存文件路径字符串的键。

```
origfile = attachment.queued_for_write
p origfile.inspect #print it out so you can figure out what key holds the path 
```

编辑答案试试这个：

```
def import_photo
  if attachment_file_name =~ %r{^*\.elf$}
    origfile = attachment.queued_for_write[:original]
    elf = ElfObject.read(origfile.path)
    properties = elf.get_properties 
    attachment = elf.image.write "image_for_#{attachment_file_name}.png"
    save!      
  end
end 
```****

# symfony - Doctrine2 不生成 getter/setter

> ID：13072090
> 
> 赞同：0
> 
> 时间：2012-10-25T15:32:35.260
> 
> 标签：symfony, doctrine-orm

我正在尝试使用 Doctrine 对数据库模式进行逆向工程。

如果我做

```
php app/console doctrine:generate:entities NS/MyBundle/Entity/MyClassName 
```

它成功地创建了一个具有从 DB 获取的私有属性的类，但没有 getter/setter 方法，因此我无法使用它。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T07:01:30.133

请关注[如何从现有数据库生成实体？](http://symfony.com/doc/current/cookbook/doctrine/reverse_engineering.html)因为我不认为你正在做的事情真的会奏效。

# clojure - 在clojure中结合2个列表

> ID：13072094
> 
> 赞同：6
> 
> 时间：2012-10-25T15:32:45.560
> 
> 标签：clojure

我正在尝试制作一个由 2 个预先存在的列表组成的新列表。基本上，如果`a`是一个列表并且`b`是一个列表，我想制作 List `c`，它是 的元素，`a`后跟 . 的元素`b`。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T15:36:54.937

您正在寻找[concat](http://clojuredocs.org/clojure_core/1.3.0/clojure.core/concat)功能：

```
(concat a b) 
```

例如：

```
(concat '(1 2) '(2 3 4))
:> (1 2 2 3 4) 
```

# vba - Excel 2010 VBA - 使用变量定义的范围更新图表

> ID：13072096
> 
> 赞同：3
> 
> 时间：2012-10-25T15:32:49.943
> 
> 标签：vba, excel

我有一张每天更新的 Excel 表格。我正在尝试使用每天添加的新数据（1 行）自动更新图表。

到目前为止，我有：

```
Sub UpdateGraphs()

    Dim latestRow As Integer

    Sheets("DailyJourneyProcessing").Select

    Range("A500").Select

    Do Until ActiveCell.Value = ""
        If ActiveCell.Value <> "" Then
            ActiveCell.Offset(1, 0).Select
        End If
    Loop

    ActiveCell.Offset(-1, 0).Select
    Application.CutCopyMode = False
    ActiveCell.EntireRow.Copy

    ActiveCell.Offset(1, 0).Select
    ActiveCell.EntireRow.PasteSpecial (xlPasteAll)

    Application.CutCopyMode = False

    latestRow = ActiveCell.row

    Dim str1 As String
    Dim rng1 As Range

    str1 = "=DailyJourneyProcessing!$F$180:$F$" & latestRow
    Set rng1 = Range(str1)

    Debug.Print "Got this far..."

    Set ActiveChart.SeriesCollection(1).Values = Range(str1) 
```

我知道这看起来就像我只是复制了前一行，但公式中包含了数据的变化。

目前的整数/行在520左右，所以我想做：

```
ActiveChart.SeriesCollection(1).Values = "=DailyJourneyProcessing!$F$180:$F$520" 
```

行号每天变化的地方。这是我需要自动化的大约 20 个范围更新之一，但是一旦我解决了一个，其他的应该是相同的。

我已经尝试了所有可以在网上找到的方法，但没有任何效果。

目前，我得到一个运行时错误 91: Object or With block variable not set。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:49:22.303

实际上不需要 VBA 来实现这一点。您会发现[此链接](http://chandoo.org/wp/2009/10/15/dynamic-chart-data-series/)中的方法比 VBA 代码更易于管理和维护。此外，最好不要在不需要时使用 VBA！

但是，为了让您可以看到一种更有效的方式来编写您想要做的事情，我提供了下面的代码。它很可能需要一些调整以适应您的实际数据集。

```
Sub UpdateGraphs()

    Dim wks As Worksheet, rng1 As Range
    Dim latestRow As Long ' changed to long to handle rows over 32,000 (whatever number Integer stops at)

    Set wks = Sheets("DailyJourneyProcessing")

    With wks

        latestRow = .Range("F" & .Rows.Count).End(xlUp).Row

        str1 = "=DailyJourneyProcessing!$F$180:$F$" & latestRow

        Set rng1 = Range(str1)

        Dim myChart As Chart
        Set myChart = .ChartObjects("myChartName")

        myChart.SeriesCollection(1).Values = rng1

    End With

End Sub 
```

# php - Symfony2 - 如何执行外部请求

> ID：13072097
> 
> 赞同：28
> 
> 时间：2012-10-25T15:32:52.550
> 
> 标签：php, http, symfony

使用 Symfony2，我需要访问一个基于 HTTPS 的外部 API。

如何调用外部 URI 并管理响应以“播放”它。例如，呈现成功或失败消息？

我正在考虑类似的事情（注意 performRequest 是一种完全发明的方法）：

```
$response = $this -> performRequest("www.someapi.com?param1=A&param2=B");

if ($response -> getError() == 0){
    // Do something good
}else{
    // Do something too bad
} 
```

我一直在阅读有关 Buzz 和其他客户的信息。但我想 Symfony2 应该可以自己做。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-25T15:45:34.577

我建议使用 CURL：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'www.someapi.com?param1=A&param2=B');
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-type: application/json')); // Assuming you're requesting JSON
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$response = curl_exec($ch);

// If using JSON...
$data = json_decode($response); 
```

**注意：**您的 Web 服务器上的 php 必须安装该`php5-curl`库。

假设 API 请求返回 JSON 数据，[此页面](http://themekraft.com/getting-json-data-with-php-curl/)可能有用。

这不使用任何特定于 Symfony2 的代码。很可能有一个捆绑包可以为您简化此过程，但如果有我不知道。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-10-25T16:37:52.890

Symfony 没有为此提供内置服务，但这是使用依赖注入框架创建您自己的服务的绝佳机会。您可以在这里做的是编写一个服务来管理外部调用。我们将服务称为“http”。

首先，编写一个带有`performRequest()`方法的类：

```
namespace MyBundle\Service;

class Http
{    
    public function performRequest($siteUrl)
    {
        // Code to make the external request goes here
        // ...probably using cUrl
    }
} 
```

将其注册为服务`app/config/config.yml`：

```
services:
    http:
        class: MyBundle\Service\Http 
```

现在您的控制器可以访问名为“http”的服务。Symfony 在“容器”中管理此类的单个实例，您可以通过以下方式访问它`$this->get("http")`：

```
class MyController
{
    $response = $this->get("http")->performRequest("www.something.com");

    ...
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-03-22T11:18:44.397

我知道的最好的客户是：[http ://docs.guzzlephp.org/en/latest/](http://docs.guzzlephp.org/en/latest/)

已经有将它集成到 Symfony2 项目中的包： [https ://github.com/8p/GuzzleBundle](https://github.com/8p/GuzzleBundle)

```
$client   = $this->get('guzzle.client');

// send an asynchronous request.
$request = $client->createRequest('GET', 'http://httpbin.org', ['future' => true]);
// callback
$client->send($request)->then(function ($response) {
    echo 'I completed! ' . $response;
});

// optional parameters
$response = $client->get('http://httpbin.org/get', [
    'headers' => ['X-Foo-Header' => 'value'],
    'query'   => ['foo' => 'bar']
]);
$code = $response->getStatusCode();
$body = $response->getBody();

// json response
$response = $client->get('http://httpbin.org/get');
$json = $response->json();

// extra methods
$response = $client->delete('http://httpbin.org/delete');
$response = $client->head('http://httpbin.org/get');
$response = $client->options('http://httpbin.org/get');
$response = $client->patch('http://httpbin.org/patch');
$response = $client->post('http://httpbin.org/post');
$response = $client->put('http://httpbin.org/put'); 
```

可以在以下位置找到更多信息：[http ://docs.guzzlephp.org/en/latest/index.html](http://docs.guzzlephp.org/en/latest/index.html)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-10-25T17:57:09.190

[https://github.com/sensio/SensioBuzzBundle](https://github.com/sensio/SensioBuzzBundle)似乎是您正在寻找的。

它实现了 Kris Wallsmith 嗡嗡声库来执行 HTTP 请求。

我会让你阅读 github 页面上的文档，用法非常基本：

```
$buzz = $this->container->get('buzz');

$response = $buzz->get('http://google.com');

echo $response->getContent(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-22T00:03:04.007

Symfony 没有自己的 rest 客户端，但正如您已经提到的，有几个捆绑包。这是我最喜欢的一个：

[https://github.com/CircleOfNice/CiRestClientBundle](https://github.com/CircleOfNice/CiRestClientBundle)

```
$restClient = $this->container->get('ci.restclient');

$restClient->get('http://www.someUrl.com');
$restClient->post('http://www.someUrl.com', 'somePayload');
$restClient->put('http://www.someUrl.com', 'somePayload');
$restClient->delete('http://www.someUrl.com');
$restClient->patch('http://www.someUrl.com', 'somePayload');

$restClient->head('http://www.someUrl.com');
$restClient->options('http://www.someUrl.com', 'somePayload');
$restClient->trace('http://www.someUrl.com');
$restClient->connect('http://www.someUrl.com'); 
```

您通过以下方式发送请求

```
$response = $restclient->get($url); 
```

并获得一个 Symfony 响应对象。然后您可以通过以下方式获取状态码

```
$httpCode = $response-> getStatusCode(); 
```

您的代码如下所示：

```
$restClient = $this->container->get('ci.restclient');
if ($restClient->get('http://www.yourUrl.com')->getStatusCode !== 200) {
    // no error
} else {
    // error
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-14T11:06:42.493

使用[HttpClient](https://github.com/symfony/symfony/blob/5.0/src/Symfony/Component/HttpClient/HttpClient.php)类创建发出请求的低级 HTTP 客户端，如以下 GET 请求：

```
 use Symfony\Component\HttpClient\HttpClient;

$client = HttpClient::create();
$response = $client->request('GET', 'https://api.github.com/repos/symfony/symfony-docs');

$statusCode = $response->getStatusCode();
// $statusCode = 200
$contentType = $response->getHeaders()['content-type'][0];
// $contentType = 'application/json'
$content = $response->getContent();
// $content = '{"id":521583, "name":"symfony-docs", ...}'
$content = $response->toArray();
// $content = ['id' => 521583, 'name' => 'symfony-docs', ...] 
```

这与 Symfony 5 兼容。 Symfony 有关此主题[的手册：HttpClient 组件](https://symfony.com/doc/current/components/http_client.html)

# spring - 将对象注入到加载了组件扫描的@Repository - 没有自动装配

> ID：13072101
> 
> 赞同：0
> 
> 时间：2012-10-25T15:32:56.013
> 
> 标签：spring, dependency-injection, repository

我定义了以下 Dao 类：

```
@Repository
public class MyDao {

  private JdbcTemplate jdbcTemplate;

  private String myString;

  @Autowired 
  public void setDataSource(DataSource dataSource) {
    this.jdbcTemplate = new JdbcTemplate(dataSource);
  } 
```

我正在对定义 MyDao 的包使用组件扫描，因此我的 Spring 配置文件中没有 MyDao 的 bean 定义。有没有办法在不使用自动装配的情况下将 String 注入 myString ？我有什么替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:45:02.603

Spring 带有 @Value 注释，您可以使用它来注入字符串。

[http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/beans/factory/annotation/Value.html](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/beans/factory/annotation/Value.html)

[http://chrislovecnm.com/2010/03/08/spring-3-java-based-configuration-with-value/](http://chrislovecnm.com/2010/03/08/spring-3-java-based-configuration-with-value/)

还有一个名为[Constretto](https://github.com/constretto/constretto-core)的配置框架，它允许注入嵌套配置（如 json）。

# cakephp-2.2 - cakephp上传多个文件时如何对文件数据进行分组

> ID：13072109
> 
> 赞同：0
> 
> 时间：2012-10-25T15:33:03.883
> 
> 标签：cakephp-2.2

我使用 cakephp FormHelper 生成 html 表单代码。

```
echo $this->Form->create('newGallery.', array('type'=>'file'));
    echo $this->Form->input('Photos',array(
            'type'  =>  'file',
            'label' =>  'Photos (jpg,png,gif)',
            'name'  =>  'upload[]',
            'required',
            'multiple'
        ));
echo $this->Form->end('Create'); 
```

但结果是

```
Array
(
    [upload] => Array
        (
            [name] => Array
                (
                    [0] => Pic1.jpg
                    [1] => Pic2.jpg
                )
            [type] => Array
                (
                    [0] => image/jpeg
                    [1] => image/jpeg
                )
            [tmp_name] => Array
                (
                    [0] => C:\wamp\tmp\phpB073.tmp
                    [1] => C:\wamp\tmp\phpB084.tmp
                )
            [error] => Array
                (
                    [0] => 0
                    [1] => 0
                )
            [size] => Array
                (
                    [0] => 216302
                    [1] => 107102
                )
        )
) 
```

我需要对同一个文件的数据进行分组，以便我可以使用 foreach 循环来处理。这是我需要的结果

```
Array
(
    [upload] => Array
        (
            [0] => Array
                (
                    [name] => Pic1.jpg
                    [type] => image/jpeg
                    [tmp_name] => C:\wamp\tmp\phpB073.tmp
                    [error] => 0
                    [size] => 216302
                )
            [1] => Array
                (
                    [name] => Pic2.jpg
                    [type] => image/jpeg
                    [tmp_name] => C:\wamp\tmp\phpB084.tmp
                    [error] => 0
                    [size] => 107102
                )
        )
) 
```

确实感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:54:54.023

我认为这可以帮助你:)

```
/* create new empty array */
$result=array();

/* create new index */
$i=0;

/* foreach in your $upload or other array */
foreach($upload['upload'] as $key => $val){
    foreach($val as $sub_val){
        $result[$i][$key]=$sub_val;
        $i++;
    }
    $i=0;
} 
```

# git - Git的本地仓库和远程仓库——混淆概念

> ID：13072111
> 
> 赞同：81
> 
> 时间：2012-10-25T15:33:09.057
> 
> 标签：git, repository

如果我理解正确的话，Git 有两种存储库：一种称为本地存储库，另一种称为远程存储库。关于这两种类型的存储库，我的问题非常幼稚。

说的对吗

*   Git 本地存储库是我们将在其上进行本地更改的存储库，通常此本地存储库位于我们的计算机上。

*   Git 远程存储库是服务器之一，通常是位于 42 英里外的机器。

另一个问题：一些教程向我展示了这个工作流程

*   mkdir 我的项目
*   光盘我的项目
*   混帐初始化
*   触摸自述文件
*   git 添加自述文件
*   git 提交 -a -m "

我看到这`git init`创建了 myproject 一个本地存储库。我不明白的是 `git commit`命令。如果我还没有设置远程存储库，Git 怎么知道在哪里提交我的`README`文件？

我希望我很清楚。

[编辑] 我使用 Git 的方式可能与其他人不同：我使用私人 Git 存储库来备份我的代码。所以我认为我确实需要一个远程存储库。在这种情况下，本地存储库应该是无稽之谈。我对吗？感谢您的澄清。这些是我在其他任何地方都找不到答案的最幼稚的问题......

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2015-08-13T06:35:53.247

由于我遇到了与您完全相同的问题（*来自[VSS](https://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe)和[TFS](https://en.wikipedia.org/wiki/Team_Foundation_Server)思维方式*），并且在过去 3 天开始理解。我相信这些图表对于其他被困在那里的人来说更有助于理解整个画面。

来自：[https ://greenido.files.wordpress.com/2013/07/git-local-remote.png?w=696&h=570](https://greenido.files.wordpress.com/2013/07/git-local-remote.png?w=696&h=570)

[![Git流程图1](../Images/a609f43c1a53bc4202cd882f565d9283.png)](https://i.stack.imgur.com/UvZ0M.png)

另一个，来自：[https ://wiki.lsr.ei.tum.de/lib/exe/fetch.php?media=nst/programming/git_flow.jpg&w=500&tok=e87798](https://wiki.lsr.ei.tum.de/lib/exe/fetch.php?media=nst/programming/git_flow.jpg&w=500&tok=e87798)

[![Git流程图2](../Images/dff7491c5085a0a5b8959f10621e7f5b.png)](https://i.stack.imgur.com/m4L6s.jpg)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-10-25T15:46:01.817

Git 是一个*分布式*版本控制系统，它让 Git 变得很棒。您的本地存储库与任何其他 Git 存储库具有完全相同的特性和功能。因此，服务器上的 Git 存储库与 GitHub 上的 Git 存储库相同（授予 GitHub 添加其他功能，但在其核心，您正在处理 Git 存储库），这与您同事的本地存储库相同。

那为什么这么棒呢？因为没有中央仓库，您必须有权访问才能完成工作。即使没有 Internet 访问，您也可以在本地计算机上的自己的 repo 上提交、分支和聚会。然后，当您再次建立连接时，您可以将更改推送到您有权访问的任何其他 Git 存储库。因此，尽管大多数人将特定存储库视为中央存储库（存储库），但这是一个过程选择，而不是 Git 要求。

所有这一切的重点是声明（就像其他人一样）您将 README 提交到本地存储库。然后，无论何时选择，您都可以将更改从本地存储库推送到任何其他存储库。这很漂亮！

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-10-25T15:36:02.933

您引用的陈述是正确的。

您根本不需要远程存储库。
你可以拥有完整的 git 体验，包括提交、分支、合并、变基等，只需要一个本地存储库。

远程存储库（例如 GitHub）的目的是将您的代码发布到全世界（或某些人）并允许他们阅读或编写它。

仅当您`git push`将本地提交到远程存储库或`git pull`其他人从远程存储库提交时，才会涉及远程存储库。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-10-25T15:37:24.713

> 如果我还没有设置远程存储库，Git 怎么知道在哪里提交我的 README 文件？

您正在提交到您的本地存储库（这是一个具有自己的更改控制的适当存储库；它不仅仅是一个本地签出......因为您在本地创建它，它*甚至*不是一个本地签出！）。

如果您想将更改发送到远程存储库（以备份它们，使它们对团队的其他成员可用，或将它们发布到世界），您必须[推送](https://web.archive.org/web/20140208071032/http://gitref.org/remotes/#push)它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-25T13:20:32.370

例如，在 github 上需要远程存储库实例只是为了与其他程序员共享代码，因为他们只能访问您的 git 存储库（除非他们使用您的 ip 连接到您的电脑，否则他们只能访问您的更改仅但不是其他程序员的更改），这就是为什么将您的更改从本地存储库提交到远程/中央存储库，以便其他开发人员可以检查它们并最终获得相同的软件状态。但最后，如果您是唯一的开发人员，您实际上并不需要远程/中央存储库。

# mysql - 错误 1452 (23000)：无法添加或更新子行。

> ID：13072113
> 
> 赞同：-2
> 
> 时间：2012-10-25T15:33:11.440
> 
> 标签：mysql, sql

![在此处输入图像描述](../Images/486aa3da4f0382ec181909df1d67288f.png)

这里可能是什么问题？请帮帮我:)并请解释一下，谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:37:53.283

给定您的架构，您只能`category`为`ads`已经存在的一个插入一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:38:14.540

因为你已经`FOREIGN KEY`对你的表设置了约束`category`。

```
Insert into ads values (1, 'pd');        // successful
DELETE from ads                          // successful
INSERT INTO category VALUES (1,1,'a');   // failed! 
```

第三个查询失败，因为表类别中不再存在`adid`is 的值。`1`换句话说，`adid`on table category 的值取决于 on `ID`table的值`ads`。

# java - 如何使用 Spring 创建不同类型对象的列表而不是 bean

> ID：13072125
> 
> 赞同：0
> 
> 时间：2012-10-25T15:33:48.120
> 
> 标签：java, spring

我有一个类，它将有一个命令列表，它必须一个接一个地执行。命令可能会重复，我不想为每个命令创建一个 bean。

我的想法是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
<bean id="parent" class="Parent">
    <property name="commands">
        <list value-type="Command">
            <value>OneCommand</value>
            <value>OtherCommand</value>
            <value>OneCommand</value>
        </list>
    </property>
</bean>
</beans> 
```

对于每个值，都会调用类的构造函数并将新的 Command 对象添加到列表中。

问题是，当我使用该 xml 文件运行测试时，出现以下异常：

```
...

Caused by: java.lang.IllegalStateException: Cannot convert value of type [java.lang.String] to required type [org.fideliapos.middleoffice.provisioning.ProvisioningCommand] for property 'commands[0]': no matching editors or conversion strategy found
at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:231)
at org.springframework.beans.TypeConverterDelegate.convertToTypedCollection(TypeConverterDelegate.java:520)
at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:173)
at org.springframework.beans.BeanWrapperImpl.convertIfNecessary(BeanWrapperImpl.java:447)
... 42 more 
```

我究竟做错了什么？如何让 spring 调用构造函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:55:44.903

您可以创建一个实现类`PropertyEditorSupport`，以便 Spring 知道如何从 String 转换为您的自定义域对象。

例子：

```
public class CommandPropertyEditor extends PropertyEditorSupport {
  public void setAsText(String text) {
    // create a command from the given text
    Command command = Command.createFromString(text);
    setValue(command);
  }
} 
```

然后在 Spring 中引用它：

```
<bean class="org.springframework.beans.factory.config.CustomEditorConfigurer">
  <property name="customEditors">
    <map>
      <entry key="Command" value="CommandPropertyEditor"/>
    </map>
  </property>
</bean> 
```

# android - 适用于 Android 的 Facebook SDK 3

> ID：13072126
> 
> 赞同：0
> 
> 时间：2012-10-25T15:33:52.263
> 
> 标签：android, facebook, sdk, version, android-2.0-eclair

我需要将我的 android 应用程序与 facebook 集成。我想使用新的 Facebook SDK (3.0)，但在文档中它说最小 sdk 版本是 8。我想支持 api 级别 7 作为最小。

有什么办法可以使用sdk吗？

我似乎也找不到旧版本的任何文档（github中的链接指向新文档。）

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:43:09.493

恐怕只支持8及以上。

遗留文档位于[https://developers.facebook.com/docs/reference/androidsdk/](https://developers.facebook.com/docs/reference/androidsdk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T08:52:49.610

在[http://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/](http://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)

> 您需要安装 Android 2.2 (API 8) 组件才能使用 Facebook SDK。

# .htaccess - .htaccess 只在家里没有 SSL，但在其他地方没有 SSL？

> ID：13072128
> 
> 赞同：0
> 
> 时间：2012-10-25T15:34:03.033
> 
> 标签：.htaccess

我希望 .htaccess 不要在主链接上添加 SSL

> [http://domain.com](http://domain.com)

但在网站的所有其他链接上

> [https://domain.com/folder/index.html](https://domain.com/folder/index.html)

所以只有主页是不安全的。最好的 .htaccess 配置是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:38:09.563

用于`RewriteRule`匹配超出 的*任何*`/`内容，如果匹配，则重写为 SSL：

```
RewriteEngine On
# If ssl is not already active
RewriteCond %{HTTPS} !=on
# .+ matches one or more of any character... An empty string would not match
RewriteRule ^(.+)$ https://%{HTTP_HOST]}%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:38:06.490

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS} !=on
RewriteRule ^.+$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTPS} =on
RewriteRule ^$ http://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

# ssrs-2008 - 我可以使用 SSRS 2008 开发滑动仪表板吗

> ID：13072129
> 
> 赞同：1
> 
> 时间：2012-10-25T15:34:05.433
> 
> 标签：ssrs-2008, dashboard

我需要开发一个仪表板，它将显示在一个悬挂在墙上的平面屏幕上。不在 PC 上（当然，在机柜或其他东西后面有 PC，但我的意思是，没有任何用户参与）。

但是要显示的信息不适合单个屏幕，所以我需要有 4-5 个屏幕随着信息滑动/旋转。

这是可以使用 SSRS 2008 完成的吗？

如果是，如何？如果没有，您是否有好的免费/低成本建议？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-26T05:37:25.773

*   在一份报告中在自己的矩形内创建 4/5“屏幕”
*   将`AutoRefresh`报告的属性设置为您希望*轮换*发生的秒数。
*   根据您设置的 AutoRefresh 长度，根据公式设置各种矩形的可见性。

**例子**

*   将自动刷新设置为 15 秒
*   我们将假设您有 4 个矩形/“幻灯片”
*   *因此*，每张幻灯片每分钟播放一次。
*   我们使用一个函数独立设置每个矩形的可见性，并使用该函数`IIf()`测试当前时间`Now()`
*   **矩形 1**
    *   `=IIf(Second(Now()) < 15, False, True)`矩形将显示自动刷新是否在当前分钟的前 15 秒块内发生，在该分钟内的所有其他时间它将被隐藏。
*   **矩形 2**
    *   `=IIf(Second(Now()) >= 15 AND Second(Now()) < 30, False, True)`矩形将显示自动刷新是否发生在当前分钟的第二个 15 秒块内，在该分钟内的所有其他时间它将被隐藏。
*   **矩形 3**
    *   `=IIf(Second(Now()) >= 30 AND Second(Now()) < 45, False, True)`矩形将显示自动刷新是否发生在当前分钟的第三个 15 秒块内，在该分钟内的所有其他时间它将被隐藏。
*   **矩形 4**
    *   `=IIf(Second(Now()) >= 45, False, True)`矩形将显示自动刷新是否发生在当前分钟的第四个 15 秒块内，在该分钟内的所有其他时间它将被隐藏。

可以为`IIf()`查看 current`Minute()`或 current进行其他组合`Hour()`。该`Mod()`功能也可用于每隔 5 分钟显示一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T23:47:52.477

我认为您无法在 SSRS 2008 中单独执行此操作。但是，您可以简单地将报表页面呈现为图像，然后使用免费的幻灯片工具（picasa 很好，但有很多可用）来播放图像的幻灯片。

或者，您可以将网页放在一起旋转图像，但我在这里采用最简单、技术最少的路线。

如果数据需要“实时”，那么您可以创建订阅以每 xx 分钟或您需要的任何时间运行报告。将输出类型设置为 TIFF 并使用 Windows 文件共享作为传递方法。您还可以让它覆盖现有文件，因此每 xx 分钟就会覆盖 4 或 5 张图像。

当然，还有更优雅的方法可以做到这一点，但如果你想使用 SSRS 并希望它便宜又愉快，那么这至少是一种选择。

祝你好运！铝。

# jquery - 用于扩展表单元素的 jQuery：多选

> ID：13072130
> 
> 赞同：0
> 
> 时间：2012-10-25T15:34:11.310
> 
> 标签：jquery, forms, multi-select

寻找用于扩展表单元素的 jQuery 名称：下面的管理模板的多选： [http ://www.eakroko.de/neat/forms.html](http://www.eakroko.de/neat/forms.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:54:24.583

只需检查该页面的来源并尝试找出使用了哪个插件。我做了什么：

1.  滚动到感兴趣的元素，在本例中为多选字段。
2.  右键单击元素，然后选择*检查元素*选项。
3.  找出该元素的类：`<div id="select5_chzn" class="chzn-container chzn-container-multi chzn-container-active" style="width: 384px;">`
4.  猜测它是[selected.jquery.min.js](http://harvesthq.github.com/chosen/ "http://harvesthq.github.com/chosen/")，因为它是最接近`chzn`类的匹配项。

将来重复上述步骤以找出此类问题。*检查元素*选项或其等效项在大多数浏览器中都可用，如果不是本机的，那么至少与 Web 开发人员浏览器插件一起使用。

# javascript - 为什么 html 中的不同 EOL 会导致 Safari 中的 javascript 行为不同？

> ID：13072131
> 
> 赞同：11
> 
> 时间：2012-10-25T15:34:14.620
> 
> 标签：javascript, safari, xmlhttprequest, eol

我有两个相同的 html 文件（除了 EOL 字符 - 一个是`LF`，另一个是`CRLF`），我用它来加载 2 个音频文件，使用`XMLHttpRequest`. 我不使用任何网络服务器（因为目的是将它加载到 ipad 中并在没有任何网络服务器的情况下运行它） - 我只是使用 Safari（对于 Mac）打开那些。

令人难以置信的是，带有`LF`endlines 的文件能够很好地加载音频文件，但是带有get 的文件`CRLF`：

```
Cross origin requests error (XMLHttpRequest cannot load file:///directories_to_files/cheer_and_clap.mp3\. Cross origin requests are only supported for HTTP.) 
```

你可以看看[文件](http://www.mediafire.com/?0rdv2rzrv5d73p3)。我还没有在 Safari for Windows 版本上进行测试。

```
p.loadBuffer = function(url, index) {
    var request = new XMLHttpRequest();
    console.log(url);
    request.open("GET", url, true);
    request.responseType = "arraybuffer";
        console.log(request);
    }
    request.onerror = function() {
        alert('BufferLoader: XHR error');
    }
    request.send();
} 
```

为什么会发生这种情况的任何解释？

# freebase - 使用 Freebase 的 Topic API 时如何提供 API 密钥

> ID：13072135
> 
> 赞同：1
> 
> 时间：2012-10-25T15:34:23.580
> 
> 标签：freebase

我正在尝试将新的 googleapi 用于 Freebase Topic API，因为旧的将被弃用。我想在查询中使用我的 API 密钥，因为我收到 403 限制错误。

我正在尝试这样：`https://www.googleapis.com/freebase/v1/topic/m/03zf5vc&key=some_key` 但这似乎不起作用。

有人可以告诉我正确的语法是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:56:33.237

Amersands (&) 用于分隔参数，但需要一个问号 (?) 将查询与地址分隔

尝试

```
https://www.googleapis.com/freebase/v1/topic/m/03zf5vc?key=some_key 
```

# asp.net - WCF 测试客户端不支持 WCF 操作，因为它使用类型 system.object[]

> ID：13072140
> 
> 赞同：0
> 
> 时间：2012-10-25T15:34:52.483
> 
> 标签：asp.net, .net, wcf

检查 Visual Studio cmd 及其在 WCF 测试客户端中不支持的 WCF 操作，因为它使用类型 system.object[]

```
public object[] getAllClientApps(string client_name)
            {
                object[] msg = new object[2];
                try
                {
                    string sql = @"  SELECT [application]
    FROM #portal.[dbo].[ix_clientApplications] inner join #portal.[dbo].[ix_clients] on #portal.[dbo].[ix_clientApplications].clientID
    = #portal.[dbo].[ix_clients].client_id Where #portal.[dbo].[ix_clients].client_name='{client_name}' and #portal.[dbo].[ix_clientApplications].application not in('sys','dev','gsa') 
     and #portal.[dbo].[ix_clientApplications].updateAvailable=1 ; 

    SELECT [clientId], appName, [licenseType]
    ,[licenseExpiry]
    ,[isExpired]
    ,[machineId]
    ,[svr_appCustomJson]
    FROM #portal.[dbo].[ix_licensedClientApps] where clientId=( select client_id from [inxPortalV4].[dbo].[ix_clients] where client_name='{client_name}')

    ";
                    sql = tools.getQueryWithDbName(sql);
                    sql = sql.Replace("{client_name}", client_name);
                    System.Data.DataSet dsData = dbUtil.ReadDataSet(sql);

                    string arrClntApps = inx.portal.common.tools.table2Json(dsData, 0);
                    string arrClntNewAppsData = inx.portal.common.tools.table2Json(dsData, 1);
                    msg[0] = arrClntApps;
                    msg[1] = arrClntNewAppsData;
                }
                catch (Exception e)
                {
                    throw (new Exception("" + e));
                }
                return msg;
            } 
```

# mysql - 使用 SQL 检索分层数据

> ID：13072147
> 
> 赞同：1
> 
> 时间：2012-10-25T15:35:05.587
> 
> 标签：mysql, sql, recursion, hierarchy, hierarchical-data

假设我也有表“文件夹”和“文件”

让 Folder 有两个列 ID 和 FolderID

```
Folder
------
ID int primary  <-.
FolderId Int    --` 
```

folderId 是与文件夹表的 Id 列的内部关系

文件表有两列 ID 和 FolderId

```
File
-----
Id int primary
FolderID          --->Folder.ID 
```

FolderId 与文件夹表的 ID 列有外部关系

```
**Folder**
Id      FolderId
---     --------
1       NULL
2       1
3       NULL
4       2
5       2

**file**
Id      FolderID
---     ---------
1        2
2        3
3        2
4        4
5        5 
```

希望你了解情况

正如我们所知，我们可以在文件夹内和文件夹内创建许多文件夹（递归）

现在我们要获取文件夹 id=2 及其子文件夹中的所有文件（id）的列表（所需的文件 id 是 3,4,5）

使用递归函数，我们可以让它工作，但如何在 SQL 中更有效地做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:38:33.780

看看这个问题的答案。 [MySQL 的先验等价物连接](https://stackoverflow.com/questions/7631048/connect-by-prior-equivalent-for-mysql)

在其他数据库（如 Oracle）中，您可以`CONNECT BY`在 SQL 语句中使用 a，但似乎 MySQL 不支持选择中的递归。

# python - 可选参数函数

> ID：13072156
> 
> 赞同：2
> 
> 时间：2012-10-25T15:35:45.183
> 
> 标签：python

我正在寻找如何在 python 中使用可选参数。我读过[这个问题](https://stackoverflow.com/questions/1585247/python-optional-parameters)，但我不清楚。假设我有一个函数 f 可以接受 1 个或多个参数来理解时间序列。我是否有义务指定参数的数量并为每个参数设置默认值？我的目标是能够以这种方式编写函数：

简单的功能：

```
def f(x,y):
    return x + y
#f(1,2) returns 3 
```

**我想要的也是 f(1,2,3) 返回我 6 和 f(7) 返回我 7**

**是否可以在不设置预定义数量的强制/可选参数的情况下编写它？是否可以在不必将默认值设置为 0 的情况下编写它？这个函数怎么写？**

它是一个简单的数字示例，但我需要编写的函数是比较一组连续的对象。比较完成后，数据集将输入神经网络。

谢谢阅读。

**编辑**：我为函数提供的对象是这样的元组（float，float，float，bool，string）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:38:51.203

```
def f(*args):
    """
        >>> f(1, 2)
        3

        >>> f(7)
        7

        >>> f(1, 2, 3)
        6

        >>> f(1, 2, 3, 4, 5, 6)
        21
    """
    return sum(args) 
```

如果你需要做一些比 sum 更复杂的事情，你可以像这样迭代`args`：

```
def f(*args):
    r = 0
    for arg in args:
        r += arg
    return r 
```

[有关*args 和 **kwargs](https://stackoverflow.com/questions/287085/what-does-args-and-kwargs-mean)的更多信息，请参阅此问题

另请参阅 Python 教程的此部分：[Arbitray Argument List](http://docs.python.org/tutorial/controlflow.html#arbitrary-argument-lists)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T15:40:14.913

您可以放入[`*args`](http://basicpython.com/understanding-arguments-args-and-kwargs-in-python/)您的函数，然后采用任意（非关键字）参数。*args 是一个元组，因此您可以像任何 Python 元组/列表/可迭代一样对其进行迭代。IE：

```
def f(*args):
    theSum = 0
    for arg in args:
        theSum += arg
    return theSum

print f(1,2,3,4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:39:45.490

您可以使用以下语法：

```
def f(*args):
    return sum(args) 
```

前面告诉它“吞下”所有参数，制作`*`一个元组。您也可以将此形式与标准参数混合使用，只要最后进行即可。例如：`args``args``*args`

```
def g(a,b,*args):
    return a * b * sum(args) 
```

第一个示例使用内置`sum`函数来汇总参数。 `sum`为您添加一个序列：

```
>>> sum([1,3,5])
9
>>> sum(range(100))
4950 
```

该`args`名称不是强制性的，但按惯例使用，因此最好坚持使用。还有`**kwargs`未定义的关键字参数。

# python - python 子进程：如何在 OS X 上运行应用程序？

> ID：13072158
> 
> 赞同：0
> 
> 时间：2012-10-25T15:35:51.077
> 
> 标签：python, macos, osx-snow-leopard, subprocess

我正在将 Windows 应用程序移植到 OS X 10.6.8。这对我来说是一个新平台，我面临一些困难。

该应用程序是一个小型网络服务器（bottle+waitress），由于子进程调用，它正在启动一个浏览器（基于 chromium 嵌入式框架）。

浏览器是一个应用程序文件，从 gui 启动时运行正常。

我以这种方式启动它：

```
subprocess.Popen([os.getcwd()+"/cef/cefclient.app", '--url=http://127.0.0.1:8100']) 
```

不幸的是，这失败了`OSError: permission denied`。

我试图以`sudo`类似的结果运行脚本。

我可以使用以下命令从 shell 启动应用程序：

```
open -a "cef/cefclient.app" --args --url-http://127.0.0.1:8100 
```

但

```
subprocess.Popen(['open', '-a', os.getcwd()+'/cef/cefclient.app', '--args', '--url-http://127.0.0.1:8100']) 
```

失败并出现以下错误

```
FSPathMakeRef(/Users/.../cefclient.app) failed with error -43. 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:40:53.743

该文件`cefclient.app`实际上是一个目录（特别是[应用程序包](http://en.wikipedia.org/wiki/Application_bundle)），而不是应用程序可执行文件。真正的可执行文件位于包内，路径类似于`Contents/MacOS/executable_name`. 所以要启动它，你会这样做：

```
subprocess.Popen([os.getcwd()+"/cef/cefclient.app/Content/MacOS/executable_name",
                  "--url=http://127.0.0.1:8100"]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:45:38.820

或者，

```
os.system('open -a "cef/cefclient.app" --args --url-http://127.0.0.1:8100') 
```

仅取决于您是要控制标准输入/标准输出还是启动应用程序就足够了。

# javascript - 在 iframe src 上设置高度的动态参数

> ID：13072164
> 
> 赞同：0
> 
> 时间：2012-10-25T15:36:23.107
> 
> 标签：javascript, jquery

我正在尝试获取我的页面 url 以添加页面高度的参数，以便我可以将其设置为在 iframe 中加载的页面上的动态高度。

iframe 页面代码。

```
$(document).ready(function() {
var h = $("#tr").height();
var pathname = $(location).attr('href');
pathname = $(this) + "&height=" + h;
}); 
```

在 iframe 中加载的页面。

```
$(document).ready(function() {
// parse params in iframe url

var qs = (function(a) {
if (a == "") return {};
var b = {};
for (var i = 0; i < a.length; ++i)
{
    var p=a[i].split('=');
    if (p.length != 2) continue;
    b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
}
    return b;
})(window.location.search.substr(1).split('&'));

// get height param
var myheight = qs["height"]
// apply css height of the iframe parent
$("#frame").css("height", myheight)
}); 
```

问题是到目前为止 iframe 页面没有在页面加载时添加“page.html&height=800”，我试图弄清楚如何将它设置为在不刷新的情况下做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:39:38.550

使用 URL 哈希，而不是参数。

```
 "page.html#height=800" 
```

`document.location.hash`持有“height=800”，您可以对其进行解析（或设置）。

您可以更改哈希值而不影响页面加载。

# drupal - 在同一台服务器上安装两个 Drupal

> ID：13072167
> 
> 赞同：1
> 
> 时间：2012-10-25T15:36:39.673
> 
> 标签：drupal, drupal-7

我在服务器的根文件夹中安装了 Drupal 7。现在我想在子文件夹（/test）中安装另一个 Drupal 7 网站，但是当我运行 /test/install.php 脚本时，我得到：

“要重新开始，您必须清空现有数据库。要安装到不同的数据库，请编辑站点文件夹中的相应 settings.php 文件。...”

似乎它仍然在查看根文件夹中的版本数据库。

在 /test/sites/default/config.php 我设置了新的数据库。

我怀疑这都与 .htacess 和重写规则有关。有人可以帮忙吗？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-07T06:40:30.060

我意识到这篇文章已经过时了，但是在我看来，有一个比创建重写规则来解决这个问题更彻底、风险更低的选择。这种情况的替代选项是在 .htaccess 文件中使用虚拟主机条目。

为了正确执行此操作，您必须创建两个虚拟主机条目。原始 URL/Drupal 7 安装的一个条目（@站点根目录）。第二个虚拟主机条目将用于指向子目录中 Drupal 7 站点的第二个 URL。

要正确执行此操作，您必须首先输入以下行（如果该行已存在，则取消注释）：

```
NameVirtualHost *:80 
```

接下来，您必须创建两个虚拟主机条目。一个将类似于以下内容：

```
<VirtualHost *:80>
ServerName your.url.fortheroot
ServerAlias alternate.url.fortheroot
DocumentRoot "/path/to/webroot"
</VirtualHost> 
```

下一个条目将类似于以下内容

```
<VirtualHost *:80>
ServerName your.url.forthesubfoldertest
ServerAlias alternate.url.forthesubfolder
DocumentRoot "/path/to/webroot/test"
</VirtualHost> 
```

如果您不使用虚拟主机方法并选择重写方法，则可能需要修改 settings.php 以反映 /test 子目录中的 Drupal 7 安装的正确基本根目录。（尝试不使用，但如果您在单击链接时遇到问题，则会出现 404 错误，请尝试使用）。注意：我仍然绝对推荐虚拟主机路径而不是重写规则路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:46:13.493

我通过安装一个用于登台目的的 Drupal 子文件夹执行了类似的操作。

我`.htaccess`在原始的drupal 安装中添加了以下内容，告诉它忽略我的子文件夹。否则，原始安装将尝试处理对子文件夹安装的访问。

```
#Place this right below RewriteEngine on
RewriteCond %{REQUEST_URI} "/test/" 
```

# azure - 进程是否有权查看 azure 上的文件？

> ID：13072169
> 
> 赞同：0
> 
> 时间：2012-10-25T15:36:43.420
> 
> 标签：azure, fubumvc

我最近在 Windows azure 上部署了一个 fubu mvc 应用程序。除非管道试图找到要渲染的视图，否则一切正常。这一切都在我的本地机器上正常工作。

所以我想知道：Azure 盒子上的进程是否有权读取/扫描磁盘上的文件？

不过，欢迎提出任何修复它的建议。

编辑：作为部署的一部分，天蓝色经历了一个称为“准备部署文件”的阶段。我检查了日志，但我的视图不在其中

所以我将副本更改为输出为真并且它有效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:42:08.227

这在一定程度上取决于您尝试阅读的位置以及您如何配置角色。默认情况下，代码将以非常低权限的用户身份运行，该用户仅对代码目录（以及用户定义的任何 LocalResource）具有 R/W 权限。但是，您可以以 SYSTEM 身份运行您的代码，在这种情况下，您可以在任何地方进行 R/W 读写（您可能仍然需要拥有所有权，但您作为 SYSTEM 拥有强大的功能）。

如果您的视图被定义为包的一部分并上传，则代码应该有权查看它。我很好奇你为什么认为这是一个权限问题。您是否看到表明该错误的错误，或者您是否在猜测？如果我不得不猜测，我的第一个想法是您的视图没有正确打包并且不在 VM 上。您可以通过 RDP 或打开包装并四处窥探来确认它们在那里。

# ios - UISearchDisplayController - 当没有输入文本而不是覆盖时显示表格

> ID：13072174
> 
> 赞同：1
> 
> 时间：2012-10-25T15:36:56.430
> 
> 标签：ios, cocoa-touch, uisearchdisplaycontroller

当您没有在 UISearchDisplayController 的 UISearchBar 中输入文本时，它会在前一个表格上显示一个半透明的覆盖。我想加载在这种情况下搜索时出现的表格，以显示最近搜索的列表。似乎 searchDisplayController:shouldReloadTableForSearchString: 在清除文本时带有空白字符串，但返回 YES 仍会导致显示该覆盖，而不是从我的委托/数据源获取表信息以显示表。有人对此有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T20:52:24.510

我设法通过创建一个全新的表来做到这一点，该表添加到 searchDisplayControllerDidBeginSearch: 中的主表的子视图中，然后在显示/隐藏搜索表时隐藏/显示（并在显示时移动到前面）。不是最漂亮的解决方案，但它有效。

# c++ - 在opengl中移动相机时显示错误

> ID：13072178
> 
> 赞同：2
> 
> 时间：2012-10-25T15:37:14.293
> 
> 标签：c++, opengl, c++-cli

我的项目中有一个问题，当我将相机移动到图像附近的位置对我来说是完美的，但就我移动或旋转相机而言，它会给我这样的错误。我不知道我的错误在哪里。我该如何纠正？

[http://nr7.upanh.com/b5.s32.d2/b7f577d38c0b23cbb35ca367e253b716_50312137.orr.png](http://nr7.upanh.com/b5.s32.d2/b7f577d38c0b23cbb35ca367e253b716_50312137.orr.png) [http://nr9.upanh.com/b2.s11.d1/0be16f4300e3a84aba3a56e5e2bf008d_5031213.png9.](http://nr9.upanh.com/b2.s11.d1/0be16f4300e3a84aba3a56e5e2bf008d_50312139.perfec.png)

代码：

```
ButtonEndRollVV KeyPessUp;
VeKhungCanh Draw;
GLint ListDraw[100];

void glintIn()
{
    glutWarpPointer(400,300);
    KeyPessUp.lastx=400;
    KeyPessUp.lasty=300;
    KeyPessUp.xrot=ROLL_X;
    KeyPessUp.yrot=ROLL_Y;
    KeyPessUp.xpos=-DEFAUTCAMERAX;
    KeyPessUp.ypos=-DEFAUTCAMERAY;
    KeyPessUp.zpos=-DEFAUTCAMERAZ;
/////////////////////////////////set defual/////////////////////////////////////
    glShadeModel(GL_SMOOTH);
    glEnable(GL_DEPTH_TEST);// Enables Depth Testing
    glClearDepth(1.0f);                         // Depth Buffer Setup                           
    glDepthFunc(GL_LEQUAL);                             // The Type Of Depth Testing To Do
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);
    glClearStencil(0);//gia phong bo dem dat no bang 0
    glEnable(GL_STENCIL_TEST);//kich hoat bo dem stencil
////////////////////////////////create list grid///////////////////////////////
    ListDraw[0]=glGenLists(1);
    glNewList(ListDraw[0],GL_COMPILE);
    {
        Draw.CreateKhongGian();
    }
    glEndList();
/////////////////////////////////create cong hang hai//////////////////////////
    ListDraw[1]=glGenLists(1);
    glNewList(ListDraw[1],GL_COMPILE);
    {
        Draw.CreateCongHangHai();
    }
    glEndList();
/////////////////////////////create hang giao/////////////////////////////////
    ListDraw[2]=glGenLists(1);
    glNewList(ListDraw[2],GL_COMPILE);
    {
        Draw.CreateHangGiao();
    }
    glEndList();
//////////////////////////////////anh sang va thong so vat lieu////////////////////////////

    float Al[4] = {0.6f, 0.6f, 0.6f, 1.0f };
    glLightfv( GL_LIGHT0, GL_AMBIENT, Al ); 

    float Dl[4] = {1.0f, 1.0f, 1.0f, 1.0f };
    glLightfv( GL_LIGHT0, GL_DIFFUSE, Dl ); 

    float Sl[4] = {1.0f, 1.0f, 1.0f, 1.0f };
    glLightfv( GL_LIGHT0, GL_SPECULAR, Sl );

        float Am[4] = {0.6f,0.6f, 0.6f, 1.0f };
    glMaterialfv(GL_FRONT, GL_AMBIENT, Am );

    float Dm[4] = {1.0f, 1.0f, 1.0f, 1.0f };
    glMaterialfv(GL_FRONT, GL_DIFFUSE, Dm );

    float Sm[4] = {1.0f, 1.0f, 1.0f, 1.0f };
    glMaterialfv(GL_FRONT, GL_SPECULAR, Sm );

   glMaterialf(GL_FRONT, GL_SHININESS, 45);
   glColorMaterial(GL_FRONT, GL_DIFFUSE);//bo cai nay neu bumapping
   glEnable(GL_COLOR_MATERIAL);

    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
}
void display()
{
    glClearColor(0,0,0,0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT); 
    glLoadIdentity ();
    glPushMatrix();

    glRotatef(KeyPessUp.xrot,1.0,0.0,0.0);
    glRotatef(KeyPessUp.yrot,0.0,1.0,0.0);
    glTranslatef(KeyPessUp.xpos,KeyPessUp.ypos,KeyPessUp.zpos); 
    glCallList(ListDraw[0]);//draw grid
    glColor3f(1,1,0);
    glCallList(ListDraw[1]);//draw Cong Hang Hai pt parabol: 
    glCallList(ListDraw[2]);//draw Hang Giao

    glPopMatrix();

    glFinish();
    glutSwapBuffers();
}
void resize(int w,int h)
{
       glViewport (0, 0, (GLsizei) w, (GLsizei) h);
       glMatrixMode (GL_PROJECTION);
       glLoadIdentity ();
       //SIZE_KHUNG_CANH*2
       float DefaultFus=0.001f;
       glFrustum (-DefaultFus, DefaultFus, -DefaultFus, DefaultFus, DefaultFus,SIZE_KHUNG_CANH*3 );
       glMatrixMode (GL_MODELVIEW);        
       glutPostRedisplay();
       KeyPessUp.sizeH=h;
       KeyPessUp.sizeW=h;
}
void idle()
{
    if(KeyPessUp.keyStates[GLUT_KEY_UP]==true)
    {
            float xrotrad, yrotrad;
            yrotrad = (KeyPessUp.yrot / 180 * pi);
            xrotrad = (KeyPessUp.xrot / 180 * pi); 
            KeyPessUp.xpos -= float(sin(yrotrad)/SPEED) ;
            KeyPessUp.zpos += float(cos(yrotrad)/SPEED) ;
            if(DISABLEUPDOWNCAMERA==0)
                KeyPessUp.ypos += float(sin(xrotrad)/SPEED) ;//bỏ đi nếu nhập vai
    }
    if(KeyPessUp.keyStates[GLUT_KEY_LEFT]==true)
    {
            float xrotrad, yrotrad;
            yrotrad = ((KeyPessUp.yrot+90) / 180 * pi);
            xrotrad = ((KeyPessUp.xrot) / 180 * pi); 
            KeyPessUp.xpos += float(sin(yrotrad)/SPEED) ;
            KeyPessUp.zpos -= float(cos(yrotrad)/SPEED) ;
            if(DISABLEUPDOWNCAMERA==0)
                KeyPessUp.ypos -= float(sin(xrotrad)/SPEED) ;//bỏ đi nếu nhập vai
    }
    if(KeyPessUp.keyStates[GLUT_KEY_DOWN]==true)
    {

            float xrotrad, yrotrad;
            yrotrad = (KeyPessUp.yrot / 180 * pi);
            xrotrad = (KeyPessUp.xrot / 180 * pi); 
            KeyPessUp.xpos += float(sin(yrotrad)/SPEED);
            KeyPessUp.zpos -= float(cos(yrotrad)/SPEED) ;
            if(DISABLEUPDOWNCAMERA==0)
                KeyPessUp.ypos -= float(sin(xrotrad)/SPEED);    //bỏ đi nếu nhập vai
    }
    if(KeyPessUp.keyStates[GLUT_KEY_RIGHT]==true)
    {
         float xrotrad, yrotrad;
            yrotrad = ((KeyPessUp.yrot+90) / 180 * pi);
            xrotrad = ((KeyPessUp.xrot) / 180 * pi); 
            KeyPessUp.xpos -= float(sin(yrotrad)/SPEED);
            KeyPessUp.zpos += float(cos(yrotrad)/SPEED) ;
            if(DISABLEUPDOWNCAMERA==0)
                KeyPessUp.ypos += float(sin(xrotrad)/SPEED);//bỏ đi nếu nhập vai
    }
    glutPostRedisplay();
}
void KeyPess(int Key,int x,int y)
{
    if(KeyPessUp.acted==0)
    {
        glutIdleFunc(idle);
        KeyPessUp.acted=1;
    }
    KeyPessUp.keyStates[Key]=true;  
}
void KeyUp(int Key,int x,int y)
{
    int check=0;
    KeyPessUp.keyStates[Key]=false;
    for(int i=0;i<255;i++)
    {
        if(KeyPessUp.keyStates[i]==true)
        {
            check=1;
        }
    }
    if(KeyPessUp.acted==1&&check==0)
    {
        glutIdleFunc(NULL);
        KeyPessUp.acted=0;
    }

}
void KeyExit(unsigned char Key,int x,int y)
{
    if(Key==27)
    {
        exit(0);
    }
}
void MouseMove(int x,int y)
{
    int xpoint=x-KeyPessUp.lastx;
    int ypoint=y-KeyPessUp.lasty;
    KeyPessUp.lastx=x;
    KeyPessUp.lasty=y;
    KeyPessUp.yrot += xpoint*.3;
    KeyPessUp.xrot += ypoint*.3;
    if (KeyPessUp.xrot >=89) KeyPessUp.xrot = 89;
    if (KeyPessUp.xrot <= -89) KeyPessUp.xrot =-89;
    if (KeyPessUp.yrot >360) KeyPessUp.yrot -= 360;
    if (KeyPessUp.yrot < -360)KeyPessUp.yrot += 360;
    glutPostRedisplay();
    if(x>450 || x<350 ||y>350 || y<250)
    {
        glutWarpPointer(400,300);
        KeyPessUp.lastx=400;
        KeyPessUp.lasty=300;
    }
}
int main(int argc,char** argv)
{

    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE  | GLUT_DEPTH | GLUT_STENCIL);
    glutInitWindowPosition(100,100);
    glutInitWindowSize(800,600);    
    glutCreateWindow("De Tai Nghien Cuu Khoa Hoc"); 
    glintIn();
    glutDisplayFunc(display);   
    glutReshapeFunc(resize);
    glutSpecialFunc(KeyPess);
    glutSpecialUpFunc(KeyUp);
    glutKeyboardFunc(KeyExit);
    glutPassiveMotionFunc(MouseMove);
    glutMotionFunc(MouseMove);
    glutSetCursor(GLUT_CURSOR_NONE);        
    glewInit();
    if(ENDABLE_FULL_SCREEN==TRUE)
    glutFullScreen();
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T18:15:35.797

```
 float DefaultFus=0.001f;
   glFrustum (-DefaultFus, DefaultFus, -DefaultFus, DefaultFus, DefaultFus,SIZE_KHUNG_CANH*3 ); 
```

这就是您的问题所在：与场景的比例相比，剪裁附近的距离非常小。然而，“场景比例”/“近剪辑”比率越大，有效的 Z 缓冲区分辨率越低。

解决方法：选择近裁剪平面距离尽可能大，即尽可能远。理想情况下，您可以根据可见场景的内容和视点的位置动态选择值。

# jquery-ui - 根据输入字段标题设置jQuery ui datepicker tooltip

> ID：13072181
> 
> 赞同：1
> 
> 时间：2012-10-25T15:37:25.960
> 
> 标签：jquery-ui, jquery-ui-datepicker

当我使用 jquery datepicker 时，它几乎总是这样配置：

```
$('#dateFld').datepicker({ 
  dateFormat: 'mm/dd/yy', 
  showOn: 'button', 
  buttonText: 'Edit date value', 
  buttonImage: '<s:url includeParams="none" value="/images/calendar.gif"/>', 
  buttonImageOnly: true 
});

...

<p>Date: <input type="text" id="dateFld" /></p> 
```

每次我定义这样的字段时，唯一会发生变化的是`buttonText`值。我希望能够使用该`input`字段的`title`属性作为`buttonText`值，以便我可以使用**.datepicker**类选择器来配置我的所有日​​期选择器。像这样的东西：

```
$('.datepicker').datepicker({ 
  dateFormat: 'mm/dd/yy', 
  showOn: 'button', 
  buttonText: $(this).attr('title'), 
  buttonImage: '<s:url includeParams="none" value="/images/calendar.gif"/>', 
  buttonImageOnly: true 
});

...

<p>Date: <input class="datepicker" type="text" id="dateFld" title="Edit date value" /></p> 
```

这种方法几乎可行，但我最终得到的是页面的标题，而不是选定的输入字段。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:45:30.560

```
$('.datepicker').each(function() {
    $currentDatepicker = $(this);
    $currentDatepicker.datepicker({ 
       dateFormat: 'mm/dd/yy', 
       showOn: 'button', 
       buttonText: $currentDatepicker.attr('title'), 
       buttonImage: '<s:url includeParams="none" value="/images/calendar.gif"/>', 
       buttonImageOnly: true 
    });
}); 
```

这应该工作！

# .net - 在 2.0 运行时运行 .NET4 项目

> ID：13072183
> 
> 赞同：2
> 
> 时间：2012-10-25T15:37:30.750
> 
> 标签：.net, .net-4.0, .net-3.5

我们想将我们的产品从 .NET3.5 升级到 4.0。但是我们不控制 exe，我们只是一个库。应用程序由客户创建。有什么方法可以让他们继续使用他们的 .NET3.5 exe 吗？例如，我们可以创建一个 .NET3.5 的包装器并在内部调用我们的新代码吗？

编辑：这与 .NET4 的特定功能无关。我正在考虑迁移策略：我们可以升级我们的 dll 并保持与旧 exe 的兼容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:41:24.150

为了使用您的库，可执行文件（通常）也需要编译为 .NET 4。否则，他们将无法添加对您项目的引用。

您可以通过让他们通过 COM 使用您的程序集而不是直接引用它来解决此问题，但这将比强制升级到 .NET 4 更痛苦，因为您仍然需要 .NET 4 部署在机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T09:33:15.580

我会保留两个版本：3.5 和 4.0，让客户知道他们应该考虑升级。这个升级当然应该是*免费*的，以让每个人都开心（客户总是喜欢提供新功能的新东西，但他们很可能不急于支付他们没有要求的东西）。

下一步将是在未来的最后期限内确定一个合理的距离（再次让您的客户知道），在此之后 3.5 版本应该被冻结：它保持原样，现有用户仍将得到支持，但你不是将不再向新客户提供它，*而*4.0 版本是获得新功能的版本。

或者您只是简单地分叉项目并同时维护 3.5 和 4.0 版本（最终取决于决策者）。

# java - 在 Android 中，如何设置画布大小？

> ID：13072185
> 
> 赞同：0
> 
> 时间：2012-10-25T15:37:32.543
> 
> 标签：java, android, image, android-canvas

我有一个宽度为 100% 的框架，高度也是宽度的 100%。（如果屏幕是 480 像素宽，这意味着框架的宽度和高度都是 480 像素宽。）

我正在编写一个图像编辑应用程序，我需要框架是用户可以绘制的唯一位置。有没有办法可以调整画布的大小并将其定位到框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:24:11.913

您可以动态地将所需尺寸的一个`SurfaceView`（或一个）添加到您的根布局并获得它。`View``SurfaceView's` `Canvas`

# mysql - 希望通过标准文件 io 接口 Linux 设备驱动程序（使用遗留代码）使 MySQL db 记录在文本文件中作为类似 CSV 的行可读

> ID：13072193
> 
> 赞同：0
> 
> 时间：2012-10-25T15:37:56.863
> 
> 标签：mysql, file-io, device-driver, plaintext, emulation

我希望能够使用标准文件访问例程从真实的 MySQL 数据库中读取数据。我不是说读取 MySQL 数据库自己的底层私有文件。我的意思是实现一个基于文件的 linux 设备驱动程序，它将 MySQL 数据库“呈现”为一个文件。换句话说，文本文件是 MySQL 数据库的“视图”。MySQL 记录以我们自己开发的 CSV 格式的自定义变体呈现，遗留代码最初是为了理解而编写的。

**背景**

我有一些从包含非常大的数据表的文本文件中读取的遗留代码，每一行都是一个单独的记录。需要添加新记录（行），但团队之间存在文件争用，在向许多系统发布软件时，将遗留代码和此文件部署到许多系统也会产生开销。文本文件本身也需要进行版本控制。

与其修改遗留代码以直接调用这些记录的 MYSQL 数据库版本，我认为最好保持不变。这将避免修改代码的风险并简化部署，此外，修改代码会导致去风险、设计讨论、更多测试等方面的大量开销。

因此，我要做的是编写一个基于文件的设备驱动程序，以便使 MySQL 数据库在遗留代码中显示为文件，并且数据的格式符合遗留代码所期望的格式。这样遗留代码不会被更改，并且可以在文件实际上是一个底层数据库的情况下工作。消除了争用，因为现在可以单独更新/添加数据库中的各个记录（通过 MySQL，或者更好的是一个单独的 Web 管理界面，该界面可以指导和验证用户对单个记录的数据输入）并且部署工作大大减少，无需必须在所有使用它的系统上向上发布整个文件。

设备驱动程序将包含在内部将标准文件读取操作转换为对 MySQL 数据库的 MySQL 查询的例程，并包含返回 MySQL 结果并将这些结果转换为文本格式以返回文件读取操作的例程。

这是针对 Linux/Unix 平台的。

这已经完成了吗？你的想法是什么？

（清理了问题、语法、澄清、可读性。这不影响接受的答案。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T23:04:01.703

这种事情以前已经做过 - 一个明显的例子是[ClearCase](http://www-01.ibm.com/software/awdtools/clearcase/)中的动态视图归档系统，它提供（也许仍然提供？）到版本控制存储库的虚拟化视图。在幕后，它实现了对象缓存并在必要时使用 RPC 从其他主机获取对象，并广泛使用本地和远程数据库。

It's fairly clear that you are going to implement the bulk of your filing system in user-space, but you will need a (small) kernel resident portion. Unless there's a really good reason to do otherwise, [FUSE](http://fuse.sourceforge.net) is what you're looking for - it will provide the kernel-resident part for you. All you'll need to write is glue to turn file operations into SQL requests.

# c++ - 我应该使用什么数据库，需要在最终用户计算机上安装最少的软件？

> ID：13072199
> 
> 赞同：1
> 
> 时间：2012-10-25T15:38:14.290
> 
> 标签：c++, database

我正在用 C++ 创建 DVD 出租软件。我需要三个数据库，一个用于存储客户信息，一个用于存储 DVD 库存，一个用于存储 DVD 租借。

我正在一家小型杂货店为我的老板创建它，该店将 DVD 作为小型副业出租。他们不希望我在他们的计算机上安装大量的配套软件来运行它，所以我需要使用尽可能原生于 Windows 的数据库（如果这有意义的话）。

此外，如果它有所作为，我对 c++ 还比较陌生，而且 100% 自学成才，所以我还没有完全掌握复杂的编程理想。

如果您可以建议一个数据库和一个参考资料，我可以在其中阅读有关如何实现它的更多信息，那就太好了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T15:40:35.430

使用[SQLite](http://www.sqlite.org/)。它非常适合您的情况，不需要单独安装。您只需要一个库和一个包含种子数据库的文件。这两个都可以作为安装产品的一部分进行安装。

# asp.net - 可能的原因 aspx Crystal Report Viewer 在 IIS 7.5 上，在某些报表下会无限期挂起？

> ID：13072201
> 
> 赞同：4
> 
> 时间：2012-10-25T15:38:24.587
> 
> 标签：asp.net, crystal-reports, iis-7.5

这有点像在黑暗中拍摄，但我真的被困在这里。

我有一个 asp.net MVC 应用程序，它会吐出一些 PDF 报告。这适用于生产 Windows Server 2003 / IIS6、本地开发服务器和 Win 7 / IIS7

当我进入生产 IIS 7.5 / Server 2008 时，一些报告无限期挂起，没有错误或写入跟踪。他们只是继续看似永远旋转，从来没有从服务器返回失败的请求。

有些报告会这样做，有些则不会，我们已经让很多人查看了报告，但没有发现明显的差异。

有没有人有任何提示：为什么我从来没有收到错误/超时？为什么有些水晶报告会失败，而有些则很好？

这在所有其他环境中都可以 100% 正常工作。我做了一些 SQL 跟踪，数据库命令正在运行并立即终止，那里没有挂起。

我在服务器上安装了 64 位和 32 位水晶运行时。（应用程序池的允许 32 位设置为 true）。

我在其他地方有相同的设置，它在 Win 7 / IIS 7 上没有问题。

我已将应用用户临时添加到本地管理员，并授予他对两个数据库的完全访问权限

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:24:49.357

根据 dotjoe 的建议，系统上不存在的默认打印机导致了此问题。确保您 a) 在服务器上安装了打印机，或 b) 默认设置为“无打印机”。

谢谢，堆栈溢出！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-03T06:57:53.300

选择打印机“Microsoft XPS Document Writer”。为此，请转到设计器中的报告->设计->页面设置并选择。

# c++ - 添加或不添加 Qt Libs 和 Headers 到项目目录

> ID：13072203
> 
> 赞同：0
> 
> 时间：2012-10-25T15:38:31.840
> 
> 标签：c++, qt, dependency-management, project-organization

将相关的 Qt Libs 和标头（开源版本）添加到项目存储库是否有意义，或者我应该只从 sdk 目录中引用它们？

* * *

我（一个人）正在开发一个跨平台（windows/linux）c++ 应用程序，它将使用许多第三方开源库，包括 Qt、OpenCV、log4cpp 等等。

为了方便（快速创建 GUI），我开始在 Qt Creator 中进行开发。目前，我在项目目录之外的 Linux 和 Windows 上都安装了 Qt Sdk。

我计划迁移到 CMAKE 以获得更好的可配置性，例如源外构建和独立于 Qt Creator，我希望将所有依赖项包含在项目目录结构中 - 这样我或其他任何人都可以签出项目并且无需安装任何其他依赖项即可构建。

我已经将除了 Qt 之外的所有库添加到目录中，因为我有点不确定它是否值得——似乎 CMAKE 依赖于 Qt Sdk 来编译 Qt 特定文件，即 moc、ui 等......（[见这里](http://qt-project.org/quarterly/view/using_cmake_to_build_qt_projects)）这是案子 ？还是有更适合的构建工具？（最初我打算使用 Scons，但我决定不使用，因为似乎支持有限……而且自 2010 年以来就没有开发过[Qt4 工具](http://www.scons.org/wiki/Qt4Tool)，这也没有激发信心。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:42:13.493

Qt 太大而不能放在项目目录中，即使您只包含它的一个模块。此外，您在 CMake 中有一些方便的功能来使用 Qt（添加 moc、rcc、ui）。您甚至可以自己编写这些函数（很快，它们只需添加一个预构建命令）。

对于构建操作：您将需要使用 CMake 不提供的`moc`(也许`ui`, `rcc`, ...)。因此，想要构建您的应用程序的人必须安装 Qt SDK。幸运的是，这种安装非常简单。

# wireshark - wireshark 捕获局域网中其他设备的流量

> ID：13072205
> 
> 赞同：-2
> 
> 时间：2012-10-25T15:38:35.913
> 
> 标签：wireshark, packet-capture

我在 Windows 上使用wireshark 来捕获我的流量。

有没有办法捕获连接到同一 LAN 的其他计算机的流量。如果无法使用wireshark，是否有其他工具能够做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:55:01.173

如果您通过网络集线器连接到其他计算机，那么您将能够看到其他计算机的流量。但是，如果您通过网络交换机连接（这更有可能），那么您将无法看到他们的任何流量。

可能还有其他更具侵入性的工具可供使用，可能有一些使用 arp-spoofing，但我不建议您这样做，除非您在**自己的专用网络**上并且知道自己在做什么。

# sql-server - 无法让 powershell 处理 SQL Server 连接失败

> ID：13072207
> 
> 赞同：3
> 
> 时间：2012-10-25T15:38:49.237
> 
> 标签：sql-server, sql-server-2008, powershell, smo

我故意尝试登录到没有登录名的 SQL Server，以使用 SQL Server 2008 R2 测试 PowerShell 2.0 和 SMO 的一些错误处理。

这是我的脚本：

```
param ([String]$instanceName);
[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') | out-null;

$conn = new-object Microsoft.SqlServer.Management.Common.ServerConnection ; 
$conn.LoginSecure = $true; 
$conn.ServerInstance = $instanceName ; 
$conn.NonPooledConnection = $true ;  

try {
    $serverInstance = New-Object Microsoft.SqlServer.Management.Smo.Server ($conn) ; 
}

catch { 
    $err = $Error[0].Exception ; 
    write-host "Error caught: "  $err.Message ; 
    continue ; 
} ; 

Write-Output $serverInstance.Version; 
```

catch 块不会被执行。有任何想法吗？我也尝试使用该`trap`函数捕获它，但得到了相同的结果。

**更新 1**

我已将脚本更改为以下内容，并让它在线捕获异常

```
foreach($j in $serverInstance.Databases) { 
```

如果我注释掉 foreach 循环，则 foreach 循环**下面的行不会引发异常**，尽管它应该（IMO）。

```
param ([String]$instanceName);

[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') | out-null; # load the SMO assembly
clear

 $ErrorActionPreference = "Stop";
    $conn = new-object Microsoft.SqlServer.Management.Common.ServerConnection ; 
    $conn.LoginSecure = $false; 
    $conn.Login = "sa" ; 
    $conn.Password = "password" ; 
    $conn.ServerInstance = $instanceName ; 
    $conn.NonPooledConnection = $true ;  

try {
    $serverInstance = New-Object Microsoft.SqlServer.Management.Smo.Server ($conn) ; 
    foreach($j in $serverInstance.Databases) { 
        write-host $j.name ; 
    } ; 
    Write-Output $serverInstance.Databases.Count;
}

catch [Microsoft.SqlServer.Management.Common.ConnectionFailureException] {
    $err = $Error[0].Exception ; 
    write-host "Error caught: "  $err.Message ; 
    while ( $err.InnerException )    {
        $err = $err.InnerException;
        Write-Host "Inner exception:" $err.InnerException.Message;
        };      
    return;
} ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:01:13.993

我找到了解决方法。Microsoft 已确认这是 SMO 中的一个错误，他们认为目前还不够重要，无法修复。解决方法在这里详细说明：

[https://connect.microsoft.com/SQLServer/feedback/details/636401/smo-is-inconsistent-when-raising-errors-for-login-faliures#](https://connect.microsoft.com/SQLServer/feedback/details/636401/smo-is-inconsistent-when-raising-errors-for-login-faliures#)

# html - 我的 HTML 页面中的某些文本无法选择。需要使其可选择

> ID：13072209
> 
> 赞同：1
> 
> 时间：2012-10-25T15:38:59.283
> 
> 标签：html, css

我找到了一个移动网页模板，但它并不干净。1 个主要问题是某些文本无法选择。请检查[http://codepen.io/rexmizan/pen/uAwke](http://codepen.io/rexmizan/pen/uAwke)在 ul class=box 中检查“此框的所有文本均不可选择”。你会在 CSS 中找到 ul.box2 在线：230

请帮我解决我的问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:57:22.623

你只需要给`z-index: 2`你的`ul.box2`css 元素，因为有一些其他元素有相同的`z-index`重叠，所以替换你的以下 css：

```
ul.box2 {
position: relative;
z-index: 1; /* prevent shadows falling behind containers with backgrounds */
...
... 
```

对于这个：

```
ul.box2 {
position: relative;
z-index: 2; /* prevent shadows falling behind containers with backgrounds */
...
... 
```

上述更改工作正常，请参阅[**演示**](http://codepen.io/anon/pen/pwKgk)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:47:27.937

在你的 CSS 中，你`#inner:before`有`z-index:5;`. 这似乎是在 div 上放置了一个 div `box2`，导致它被选中，而不是 box2 的内容。当您右键单击文本并选择 时，您可以在 Chrome 中看到这种情况`Inspect element`。它检查的元素`#inner`不是`#box2`。

祝你好运。

# button - 对话框和后退按钮之间的潜在冲突

> ID：13072210
> 
> 赞同：0
> 
> 时间：2012-10-25T15:39:04.837
> 
> 标签：button, jquery-mobile, jquery-ui-dialog

我在 JQM 上确定了一个奇怪的行为。

由于该页面基于 JQM Boiler 板，因此此处不包括完整页面。我在[jsfiddle](http://jsfiddle.net/alain_lavoie/jEesE/)上发布了代码。

以下是行为点击操作的摘要：

![（点击之间的 Windows 序列）](../Images/6a40f2f0425e16f00c6f8e06ec1e98b7.png)

以下是相关代码的摘录：

```
<div id="oneapart" 
    data-add-back-btn="true" 
    data-back-btn-text="List" 
    data-role="page" 
    data-title="Home page"> 
```

我不明白为什么最后一次单击列表按钮（一个 jquery 移动后退按钮）需要单击 2 次才能实际作用于链接。事实上，奇怪的行为是第一次单击以蓝色突出显示按钮，但在第二次单击发生之前，它保持原样而不切换到上一页。

任何帮助将不胜感激。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T14:46:50.470

`data-rel="back"`可以通过在弹出窗口中添加按钮来解决此问题。

因此[，在 Github 上发布的问题](https://github.com/jquery/jquery-mobile/issues/5224#issuecomment-9903172)已被标记为已解决。

> 问题的发生是因为`data-rel="back"`@jerone 他的小提琴中的大取消按钮的链接中缺少。请参阅此处的“关闭对话框”：http: [//jquerymobile.com/test/docs/pages/dialog/index.html](http://jquerymobile.com/test/docs/pages/dialog/index.html)
> 
> pageTwo 上的后退按钮是动态创建的。当您不使用`data-rel="back"`将您从 dialogThree（也是一个页面）返回到 pageTwo 的链接时，它会向历史堆栈添加一个项目。这就是为什么 pageTwo 上的后退按钮需要单击两次才能真正将您带回 pageOne。活动状态从 pagehide 事件上的（后退）按钮中移除。在第一次单击时，您会停留在同一页面上，因此不会触发此事件并且按钮保持活动状态。
> 
> 我添加了`data-rel="back"`，然后一切都按预期工作：http: [//jsfiddle.net/jEesE/6/](http://jsfiddle.net/jEesE/6/)
> 
> 解决后关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T21:40:30.930

您描述的错误由两部分组成；

1.  为什么需要两次点击才能恢复？
2.  为什么保持按钮处于活动状态（蓝色）？

错误的第一部分不是错误；您打开一个弹出窗口，但没有返回（例如`data-rel='back'`，您打开一个与前一个相同的页面。因此，如果您按下后退按钮，它会重新打开实际上与您现在所在的页面相同的前一个页面（如果有意义的话）。

为什么按钮保持活动状态，我不知道...

*编辑*：我清理了你的代码：http: [//jsfiddle.net/jerone/jEesE/3/](http://jsfiddle.net/jerone/jEesE/3/)

# jquery - 如何解析转换为 JSON 的 XML

> ID：13072212
> 
> 赞同：0
> 
> 时间：2012-10-25T15:39:10.390
> 
> 标签：jquery, xml, json, xml-parsing, nodelist

我从 WebService 获得了一个 xml 文件

```
<MasterProducts> <MasterProduct> <Productcode>023DDC</Productcode> <Description>Dell CRT 17 Computer Monitor E771a</Description> <ThumbPic>NoImage.png</ThumbPic> <RRP>0.000000</RRP> <Stock>2</Stock> </MasterProduct> </MasterProducts> 
```

我使用的 Chrome IDE 会自动将其转换为 JSON，我一直在尝试解析它但没有成功，因为我对 Javascript 还很陌生。

httpResponse 返回一个错误变量和一个保存 json 文件的数据变量。

```
if(error===false)
{ 
    if(data !== '')
    { 
        objData = data.getElementsByTagName('MasterProducts');
        //returns a NodeList here
        var items = objData[0].getElementsByTagName('MasterProduct')[0].getElementsByTagName('Description')[0].firstChild.data;

    }
    else
    { 
        alert("No Data"); 
    } 
} 
```

我只获得了节点列表，但我无法从标签中获得我需要的数据。

编辑：使用在线转换器，我得到了下面的 JSON

```
{
   "MasterProducts": {
      "MasterProduct": {
  "Productcode": "023DDC",
  "Description": "Dell CRT 17 Computer Monitor E771a",
  "ThumbPic": "NoImage.png",
  "RRP": "0.000000",
  "Stock": "2"
      }
  }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:05:55.740

根据[http://jsonlint.com/](http://jsonlint.com/)，您返回的 JSON 是有效的，因此您的脚本应该能够使用点符号访问数据内容，而不必像使用 XML 那样解析节点

```
var data ={
            "MasterProducts": {
                "MasterProduct": {   
                    "Productcode": "023DDC",
                    "Description": "Dell CRT 17 Computer Monitor E771a",
                    "ThumbPic": "NoImage.png",
                    "RRP": "0.000000",
                    "Stock": "2"
                 }   
             }  
         }

 var description = data.MasterProducts.MasterProduct.Description; 
```

描述将包含“Dell CRT 17 Computer Monitor E771a”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:46:12.097

数据似乎是一种字符串。“getElementsByTagName”仅在 dom 元素和 dom 本身上可用（在某些浏览器中）。尝试将您的响应添加到隐藏的 div 并使用 jQuery 进行查询。

```
$("#hidden").html(data); 
```

然后使用 jquery 查询该 div 或者您可以直接使用 dom，因为您正在尝试这样做。

```
$("#hidden").find("MasterProducts")[0].getElementsByTagName("MasterProduct") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:06:27.313

您可以将 xml 直接存储在 jQuery obj 中，而无需将其添加到 dom 中，就像其他答案所说的那样。

```
var $xml = $(data); 
```

然后只需使用 jQuery 来定位特定元素，避免使用 getElementsByTagName，因为它仅在某些浏览器中可用。

```
var MasterProducts = [];

$xml.find('MasterProduct').each(function(){
   var $masterProduct = $(this);
   var masterProduct = {};
   $masterProduct.find('*').each(function(){
      masterProduct[$(this).get(0).tagName] = $(this).text();
   });
   MasterProducts.push(masterProduct);
}); 
```

最后，您的 MasterProducts 数组应该包含一个 JavaScript 对象，然后您可以使用以下调用将其转换为 JSON。

```
var json = JSON.stringify(MasterProducts); 
```

我把它放在 jsFiddle 上。见[http://jsfiddle.net/WRF4D/](http://jsfiddle.net/WRF4D/)

# spring - 使用 JPA + Spring 监控性能

> ID：13072220
> 
> 赞同：0
> 
> 时间：2012-10-25T15:39:36.863
> 
> 标签：spring, hibernate, caching, tomcat, jpa

您建议使用哪些工具和方法来监控性能？我的应用程序在 Tomcat、Spring 3、JPA、Hibernate 和 solr 上运行。我注意到某个页面上有一些滞后/缓慢的活动。该应用程序没有任何缓存设置代码。甚至连接池。

请原谅我的初学者式问题，我刚刚进入“性能监控”世界......

我知道有几件事要看 - 数据库调用、连接池、索引表、缓存等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:45:14.543

1.  您绝对需要连接池。这很简单，有像[Bone CP](http://jolbox.com/)、[Commons DBCP](http://commons.apache.org/dbcp/)或[c3p0](http://www.mchange.com/projects/c3p0/)这样的库可以透明地执行此操作。

2.  您必须实施自动负载/压力测试。[JMeter](http://jmeter.apache.org/)非常易于使用，其他类似的工具还有[Gatling](http://gatling-tool.org/)和[Grinder](http://grinder.sourceforge.net/)。

3.  启用 SQL 日志记录和统计信息。很可能太多或太复杂的查询会减慢您的页面速度。

4.  使用**分析器**。商业的（[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)、[YourKit](http://www.yourkit.com/)）或[JVisualVM](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jvisualvm.html)中包含的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:43:29.750

您可以使用此应用程序来监控您的应用程序：

[http://newrelic.com/](http://newrelic.com/)

他有一个免费的计划！

# prolog - Prolog - 递归函数 Abs / 创建新列表

> ID：13072226
> 
> 赞同：1
> 
> 时间：2012-10-25T15:39:55.130
> 
> 标签：prolog

我想要一个给定点的函数，以及它计算的点列表：列表中每个点的 (Point - PointofList) 的绝对值。到目前为止我有这段代码，但我似乎在递归部分失败了。

```
absL((X,Y),[],Result) :- Result.

absL((X,Y),[(X2,Y2)|Z], R) :- ABSX is abs(X-X2),
 ABSY is abs(Y-Y2),
 append([(ABSX,ABSY)], NL, R),
 absL((X,Y),Z,NL). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:47:01.387

您已经错误地定义了基本情况。当点列表中没有更多点时，结果列表应该是一个空列表，但您只是留下一个未实例化的变量：

因此，您的基本情况应为：

```
absL((_,_),[],[]). 
```

我将第一个参数留给使用未命名变量的结构，因为基本情况不需要给定点的坐标。

您的递归子句比它应该的要复杂一些。您真的不需要使用`append/3`来构建结果列表。您可以直接在子句的头部构建列表：

```
absL((X,Y),[(X2,Y2)|Z], [(ABSX,ABSY)|NL]) :- 
  ABSX is abs(X-X2), 
  ABSY is abs(Y-Y2), 
  absL((X,Y),Z,NL). 
```

递归步骤将在递归调用之前添加新距离，并在递归调用返回时统一第三个参数时插入此值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T18:06:25.527

这个子句`absL((X,Y),[],Result) :- Result.`试图**调用**Result，至少在接受这种语法的 Prologs 中是这样。

由于@gusbro 已经显示了所需的更正，我将展示一个替代方案：

```
absL((X,Y), L_In, L_Out) :-
   maplist(absPoint((X,Y), L_In, L_Out).

absPoint((X, Y), (X2,Y2), (ABSX, ABSY)) :-
   ABSX is abs(X-X2), 
   ABSY is abs(Y-Y2). 
```

# mysql - 在mysql中选择带有order by的案例

> ID：13072230
> 
> 赞同：0
> 
> 时间：2012-10-25T15:40:04.983
> 
> 标签：mysql

我正在运行以下查询以找到用户的最佳连胜纪录。

```
$sql="select sub.user_id as user_id,max(sub.streak) as streak,max(sub.units) as units
                from
                  (
                select 
                case when @x is null then @x:=user_id end,
                case 
                when awarded_unit>0 and @x=user_id then @y:=@y+1 
                when awarded_unit<0 and @x=user_id then @y:=0 
                when awarded_unit>0 and @x<>user_id then @y:=1
                when awarded_unit<0 and @x<>user_id then @y:=0
                end as streak,
                case 
                when awarded_unit>0 and @x=user_id then @z:=@z+awarded_unit 
                when awarded_unit<0 and @x=user_id then @z:=0 
                when awarded_unit>0 and @x<>user_id then @z:=awarded_unit 
                when awarded_unit<0 and @x<>user_id then @z:=0
                end as units,
                @x:=user_id as user_id,
                awarded_unit
                from $select_user_events_fights as u,$events as e,$event_fight_table as ef,$post_meta as pm where e.ID=ef.event_id
                and ef.event_fight_id=u.event_fight_id and  e.post_type='bt_events' and pm.post_id = e.ID and  e.post_status ='publish' and pm.meta_key='_event_dt_time' and u.`awarded_unit`!=0 and u.season_id=$season_id and u.user_id=".$user->ID."

                order by pm.meta_value desc,ef.fight_order desc
                  ) as sub
                group by sub.user_id";

            mysql_query("set @y=0;");
            mysql_query("set @x=null;");
            mysql_query("set @z=0;"); 
```

如果我通过 u.primary_key 下订单，它工作正常。但我希望事件按日期和战斗顺序排序。在这种情况下它给出了错误的结果。

我已经使用 order by 语句检查了内部查询。

对于 order by statement( `"order by pm.meta_value desc,ef.fight_order desc"`) ，它是在计算最佳条纹后对结果进行排序，因此它给出了错误的结果。

请解释如何获得正确答案以及我在这里缺少什么。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:55:37.940

您需要在子查询中执行 ORDER BY，然后在处理它的外部查询中执行条纹检测。

试试这个（未经测试——如果你想让我测试，请在 sqlfiddle 中提供一些数据）：

```
 $sql="select sub.user_id as user_id,max(sub.streak) as streak,max(sub.units) as units
            from
              (
            select 
            case when @x is null then @x:=user_id end,
            case 
            when awarded_unit>0 and @x=user_id then @y:=@y+1 
            when awarded_unit<0 and @x=user_id then @y:=0 
            when awarded_unit>0 and @x<>user_id then @y:=1
            when awarded_unit<0 and @x<>user_id then @y:=0
            end as streak,
            case 
            when awarded_unit>0 and @x=user_id then @z:=@z+awarded_unit 
            when awarded_unit<0 and @x=user_id then @z:=0 
            when awarded_unit>0 and @x<>user_id then @z:=awarded_unit 
            when awarded_unit<0 and @x<>user_id then @z:=0
            end as units,
            @x:=user_id as user_id,
            awarded_unit
            from (select user_id, awarded_unit
                  from $select_user_events_fights as u,$events as e,$event_fight_table as ef,$post_meta as pm where e.ID=ef.event_id
            and ef.event_fight_id=u.event_fight_id and  e.post_type='bt_events' and pm.post_id = e.ID and  e.post_status ='publish' and pm.meta_key='_event_dt_time' and u.`awarded_unit`!=0 and u.season_id=$season_id and u.user_id=".$user->ID."

                  order by pm.meta_value desc,ef.fight_order desc) as subsub
            ) as sub
            group by sub.user_id"; 
```

# ruby-on-rails - 批量分配的 ActiveAdmin 角色

> ID：13072232
> 
> 赞同：2
> 
> 时间：2012-10-25T15:40:07.050
> 
> 标签：ruby-on-rails, activeadmin, mass-assignment

在我的模型中，我为批量分配定义了不同的角色。有些字段是`attr_accessible :as => :default`. 其他字段为`attr_accessible :as => [:default, :admin]`.

如何让 ActiveAdmin 能够以管理员角色更新属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:40:07.050

您可以为 ActiveAdmin 控制器使用 with_role 选项。例如：

```
# app/admin/users.rb
ActiveAdmin.register User do
  controller { with_role :admin }
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T07:35:08.580

正如文卡特在[另一个答案](https://stackoverflow.com/a/13072234/221213)中所说，您可以使用该`with_role`选项来做到这一点。但恕我直言，将其插入`config/initializers/active_admin.rb`而不是每个控制器中是一个更好的主意：

```
module ActiveAdmin
  ResourceController.class_eval do
    with_role :admin
  end
end 
```

# mysql - 我怎样才能使这种亲子关系发挥作用？

> ID：13072233
> 
> 赞同：4
> 
> 时间：2012-10-25T15:40:07.473
> 
> 标签：mysql, parent-child, ireport

使用 MySQL 如何使这种层次结构起作用？

*   Parent 的 ID 为 100。此 Parent 的 ParentID 为 0。
*   Child 的 ID 为 101。ParentID 为 100。
*   SubEntity 的 ID 为 105。ParentID 为 100。
*   子实体的子实体的 ID 为 106。它们的 ParentID 为 105。

此查询将插入 iReport。目前，子实体及其子实体不会卷入父实体。

这就是我最终的结果：

```
`Select
case
when FC.ParentType = 'PARENT' then FC.FundCode
when FB.ParentType = 'PARENT' then FB.FundCode
when F.ParentType = 'PARENT' then F.FundCode
else 0 end as `ParentID`,
case
when FB.ParentType = 'SUBFUND' then FB.FundCode
when F.ParentType = 'SUBFUND' then F.FundCode
else 0 end as `SubfundID`,
case
when FB.ParentType = 'CHILD' then FB.FundCode
when F.ParentType = 'CHILD' then F.FundCode
else 0 end as `Children`,            
F.FundName     
From Fund F
join Fund FB on F.ParentId = FB.FundCode
join Fund FC on FB.ParentID = FC.FundCode` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:34:59.043

是否有一个静态数字来控制这种父子关系有多少级别？

**是：**使用递归`LEFT JOIN`s X 次。

```
SELECT *
FROM table t1 LEFT JOIN table t2
  ON t1.id = t2.parent_id
  LEFT JOIN table t3
  ON t2.id = t3.parent_id
  ... 
```

**否：**使用单独的查询来完成此操作，直到您根据需要充实您的父/子对象。确保您有适当的检查以避免循环，即。孩子是其父母的父母。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:42:10.157

对于这种情况，您可以使用**递归 CTE 。**看看这个链接，它给出了一个很好的例子。

[http://blog.sqlauthority.com/2012/04/24/sql-server-introduction-to-hierarchical-query-using-a-recursive-cte-a-primer/](http://blog.sqlauthority.com/2012/04/24/sql-server-introduction-to-hierarchical-query-using-a-recursive-cte-a-primer/)

# c - C在堆栈上为数组分配的空间大小

> ID：13072236
> 
> 赞同：2
> 
> 时间：2012-10-25T15:40:21.810
> 
> 标签：c, assembly, gdb

我有一个名为 demo.c 的简单程序，它为堆栈上长度为 8 的 char 数组分配空间

```
#include<stdio.h>

main()
{
        char buffer[8];

        return 0;
} 
```

我认为将从堆栈中为八个字符分配 8 个字节，但如果我在 gdb 中检查这一点，则会从堆栈中减去 10 个字节。

我在我的 Ubuntu 32 位机器上用这个命令编译程序：

**$ gcc -ggdb -o 演示 demo.c**

然后我分析程序：

**$ gdb 演示**

**$ 反汇编主程序**

```
(gdb) disassemble main
Dump of assembler code for function main:
   0x08048404 <+0>: push   %ebp
   0x08048405 <+1>: mov    %esp,%ebp
   0x08048407 <+3>: and    $0xfffffff0,%esp
   0x0804840a <+6>: sub    $0x10,%esp
   0x0804840d <+9>: mov    %gs:0x14,%eax
   0x08048413 <+15>:    mov    %eax,0xc(%esp)
   0x08048417 <+19>:    xor    %eax,%eax
   0x08048419 <+21>:    mov    $0x0,%eax
   0x0804841e <+26>:    mov    0xc(%esp),%edx
   0x08048422 <+30>:    xor    %gs:0x14,%edx
   0x08048429 <+37>:    je     0x8048430 <main+44>
   0x0804842b <+39>:    call   0x8048340 <__stack_chk_fail@plt>
   0x08048430 <+44>:    leave  
   0x08048431 <+45>:    ret    
End of assembler dump. 
```

0x0804840a <+6>: sub $0x10,%esp 说，从堆栈中分配了 10 个字节，对吗？

为什么分配了 10 个字节而不是 8 个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:42:00.920

不，`0x10`意味着它是十六进制的，即 10 [16]，即十进制的 16 [10]个字节。

可能是由于堆栈的对齐要求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:51:28.097

请注意，常量 $0x10 是十六进制的，等于 16 字节。看一下机器码：

```
0x08048404 <+0>: push   %ebp
0x08048405 <+1>: mov    %esp,%ebp
0x08048407 <+3>: and    $0xfffffff0,%esp
0x0804840a <+6>: sub    $0x10,%esp
...
0x08048430 <+44>:    leave  
0x08048431 <+45>:    ret 
```

正如你所看到的，在我们从 esp 中减去 16 之前，我们确保让 esp 首先指向一个 16 字节对齐的地址（看看`and $0xfffffff0,%esp`指令）。我猜编译器试图尊重对齐，所以他也只保留了 16 个字节。无论如何都没关系，因为 8 字节非常适合 16 字节。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T15:52:04.873

`sub $0x10, %esp`说堆栈上有 16 个字节，而不是 10，因为`0x`它是十六进制表示法。

堆栈的空间量完全取决于编译器。在这种情况下，它最像一个对齐问题，对齐是 16 个字节，而您请求了 8 个字节，所以它增加到 16 个。

如果您请求 17 个字节，它很可能是`sub $0x20, %esp`32 个字节而不是 17 个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-19T23:39:28.330

（我跳过了其他答案更详细解释的一些事情）。

你用 编译`-O0`，所以 gcc 以一种超级简单的方式运行，它告诉你一些关于编译器内部的东西，但很少告诉你如何用 C 编写好的代码。

gcc 始终保持堆栈 16B 对齐。32 位 SysV ABI 仅保证 4B 堆栈对齐，但 GNU/Linux 系统实际上假定并保持 gcc 的默认值[`-mpreferred-stack-boundary=4`（16B 对齐）](https://gcc.gnu.org/onlinedocs/gcc/x86-Options.html)。

* * *

您的 gcc 版本也默认为 using `-fstack-protector`，因此它会检查`char`具有 4 个或更多元素的本地数组的函数中的堆栈粉碎：

> `-fstack-protector`
> 发出额外的代码来检查缓冲区溢出，例如堆栈粉碎攻击。这是通过将保护变量添加到具有易受攻击对象的函数来完成的。这包括调用“alloca”的函数，以及缓冲区大于 8 字节的函数。进入函数时初始化守卫，然后在函数退出时检查。如果保护检查失败，则会打印一条错误消息并退出程序。

出于某种原因，这实际上是使用 char 数组 >= 4B，但不是整数数组。（至少，在它们未使用时不会！）。 `char`指针可以给任何东西起别名，这可能与它有关。

查看[Godbolt](http://goo.gl/rdvFxK)上的代码，带有 asm 输出。注意`main`它的特殊之处：它用于`andl $-16, %esp`在入口对齐堆栈到，但其他函数假定堆栈在调用它们`main`的指令之前是 16B 对齐的。`call`所以他们通常会`sub $24, %esp`在推后`%ebp`。（`%ebp`并且返回地址总共是 8B，所以堆栈距离 16B 对齐有 8B）。这为堆栈保护金丝雀留下了空间。

* * *

[32 位 SysV ABI](http://sco.com/developers/devspecs/abi386-4.pdf)只要求数组与其元素的自然对齐方式对齐，因此数组的这种 16B 对齐方式正是`char`编译器在这种情况下决定做的事情，而不是您可以指望的事情。

64位[ABI 不同](http://www.x86-64.org/documentation.html)：

> 数组使用与其元素相同的对齐方式，除了长度至少为 16 字节的局部或全局数组变量或 C99 可变长度数组变量始终具有至少 16 字节的对齐方式

（来自[x86](/questions/tagged/x86 "显示标记为“x86”的问题")标签 wiki 的链接）

因此，您可以指望在`char buf[1024]`SysV 上与 16B 对齐，从而允许您在其上使用 SSE 对齐的加载/存储。

# ios - 如何更改情节提要中制作的工具栏项目以显示动态日期

> ID：13072249
> 
> 赞同：0
> 
> 时间：2012-10-25T15:41:04.103
> 
> 标签：ios, toolbar, toolbaritems

昨天我有一个类似的问题，我从那里得到了部分答案。但是线程已关闭，所以这有点像我的后续问题线程:)

原文问：如何让工具栏按钮/项目更改日期`[NSDate date]`？

原答：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"MM/dd/yyyy"];
[formatter setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]];
yourToolBarItem = [NSString stringWithFormat:@"%@", [formatter stringFromDate:[NSDat date]]]; 
```

后续问：我的工具栏直接由 storyboard 中的 navigationcontroller 制作。如何以编程方式访问其项目并将索引 0 处的项目/对象更改为当前日期。

我无法理解这一点。到目前为止，我已经尝试了很多类型，`[self navigationController.ToolbarItems]` `replacObjectAtIndex`但对我来说是一个很大的问题。对任何指令和帮助都非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:38:41.950

最简单的方法是为您的按钮创建一个属性：@property IBOutlet UIBarButtonItem *myBarButton;

然后在 viewWillAppear 中初始化它： myBarButton = [[UIBarButtonItem alloc] initWithTitle:(your date string) style: UIBarButtonItemStylePlain target:self action:(some action)]; // 当然你也需要把它添加到这里的导航栏...

然后是时候更新按钮上的日期：[myBarButton setTitle:(your date string)];

希望有帮助...

# wcf - 创建基于声明的 Rest WCF

> ID：13072251
> 
> 赞同：2
> 
> 时间：2012-10-25T15:41:05.590
> 
> 标签：wcf, rest, wif, adfs

我有两个域。每个都有 ADFS。在域 BI 中有一个基于声明的 SOAP WCF 服务，在域 AI 中有一个活动客户端。客户端仅通过配置知道：

1.  转到 A 的 ADFS 并获取令牌。
2.  使用 A 的令牌转到 B 的 ADFS，并获取 SOAP WCF 服务的令牌。
3.  使用令牌访问 WS。

一切正常。现在我想用 Rest WCF 替换 SOAP WCF。

我想让客户端像现在一样通过配置进入 ADFS，而不是通过代码。这可能吗？我将如何配置客户端和服务？

# python - 转换 Pandas 数据框

> ID：13072259
> 
> 赞同：6
> 
> 时间：2012-10-25T15:41:32.277
> 
> 标签：python, pandas

我对此有点麻烦，也许有人可以在这里指导我正确的方向。

假设我有一个如下所示的数据框（实际数据集有更多条目和标识）：

```
 open ident
2011-01-01 00:00:00 -1.252090   df1
2011-01-01 01:00:00 -1.427444   df1
2011-01-01 02:00:00 -0.415251   df1
2011-01-01 03:00:00 -0.797411   df1
2011-01-01 04:00:00 -0.515046   df1
2011-01-01 00:00:00  1.107162   df2
2011-01-01 01:00:00  0.073243   df2
2011-01-01 02:00:00  0.224991   df2
2011-01-01 03:00:00 -1.269277   df2
2011-01-01 04:00:00  0.468960   df2 
```

有什么快速的方法可以重新格式化数据框以使其看起来像这样吗？

```
 df1        df2
2011-01-01 00:00:00 -1.252090   1.107162   
2011-01-01 01:00:00 -1.427444   0.073243
2011-01-01 02:00:00 -0.415251   0.224991
2011-01-01 03:00:00 -0.797411  -1.269277
2011-01-01 04:00:00 -0.515046   0.468960 
```

我玩过 groupby 并转置无济于事，任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T16:06:06.417

您可以使用以下`pivot`功能：

```
df.pivot(index='date', columns='variable', values='value') 
```

有关更多信息，请参阅： http: [//pandas.pydata.org/pandas-docs/stable/reshaping.html](http://pandas.pydata.org/pandas-docs/stable/reshaping.html)

# android - 带有 android avd 的 Yelp API

> ID：13072260
> 
> 赞同：1
> 
> 时间：2012-10-25T15:41:33.687
> 
> 标签：android, api, avd, yelp

我可以成功地将 yelp API 作为 java 项目运行。
当我在 Android 模拟器上运行它时，我得到了错误。我的所有设置都是这样的： [Android 中的 Yelp 集成](https://stackoverflow.com/questions/6676733/yelp-integration-in-android) 我的 avd 是最新的，并且我安装了 google api 包。这些是我的错误信息。

```
10-25 15:35:56.686: E/AndroidRuntime(1548): FATAL EXCEPTION: main
10-25 15:35:56.686: E/AndroidRuntime(1548): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.first/com.example.first.MainActivity}: android.os.NetworkOnMainThreadException
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.os.Looper.loop(Looper.java:137)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at java.lang.reflect.Method.invokeNative(Native Method)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at java.lang.reflect.Method.invoke(Method.java:511)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at dalvik.system.NativeStart.main(Native Method)
10-25 15:35:56.686: E/AndroidRuntime(1548): Caused by: android.os.NetworkOnMainThreadException
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at java.net.InetAddress.getAllByName(InetAddress.java:214)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:341)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpEngine.connect(HttpEngine.java:310)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at org.scribe.model.Response.<init>(Response.java:27)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at org.scribe.model.Request.doSend(Request.java:84)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at org.scribe.model.Request.send(Request.java:59)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at org.scribe.model.OAuthRequest.send(OAuthRequest.java:12)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at com.example.first.Yelp.search(Yelp.java:57)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at com.example.first.MainActivity.onCreate(MainActivity.java:29)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.Activity.performCreate(Activity.java:5008)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
10-25 15:35:56.686: E/AndroidRuntime(1548):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023) 
```

# ms-access - 如何按当前记录过滤表字段的列表框

> ID：13072265
> 
> 赞同：0
> 
> 时间：2012-10-25T15:41:52.953
> 
> 标签：ms-access, ms-access-2007

如何设置表格的字段，以便列表框被该行的数据过滤？

我有一个包含 2 个重要字段的主表（ **TblMain ）：** **Client**和**Division**。目前，Division 字段设置为从另一个表 ( **TblDiv** ) 中提取的简单列表框。

但是，这些部门是针对每个客户的，几乎没有重叠。我目前的基本设置没有区分，因此可以为任何客户选择任何部门。

如何设置 Division 以使列表框特定于该行？

我尝试在行源（即）中进行内部连接，`Select TblDiv.Div from TblMain Inner Join TblDiv on TblMain.Client=TblDiv.Client`但这似乎不起作用，可能是因为我没有引用活动行的 Client 值。

（我应该补充一点，我不是在谈论表单或报告。只是表格对象）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:45:26.440

您是否要向表中添加查找字段？这几乎从来都不是一个好主意。您是否尝试过滤连续表单上的组合框？您不能明智地这样做 - 任何更改都会影响每一行的外观，这会让用户感到困惑。有变通办法。例如，您可以显示参考的文本框和“更改参考”组合。这将避免混淆用户，因为绑定的文本框不会更新。您可以使用条件格式设置更改组合的各种属性，以使其更漂亮。或者，您可以使用两个子表单或弹出表单来编辑数据。

# javascript - 用于查找总页面高度的 Javascript 函数

> ID：13072266
> 
> 赞同：-1
> 
> 时间：2012-10-25T15:41:53.417
> 
> 标签：javascript, dynamic, background, height

我正在使用一个简单的 javascript 函数，该函数将检测动态网页的总高度并将其应用于作为页面背景的 div 的高度。有可能实施吗？div 被称为 bg ......有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:50:32.407

这就是我用来计算 iFrame 中内容高度的方法，以便正确调整它。

```
var body = document.body,
html = document.documentElement,
height = 0;

height = body.offsetHeight;
if(height === 0){
     height = html.offsetHeight;
} 
```

检查第一个的原因`body`是高度`html`实际上是 iFrame 的高度，它可能大于内容本身。但是，在某些情况下，例如当`body`没有高度时，它会回退到使用高度`html`代替。

对于您的情况，您可能想尝试类似的方案。我不确定为什么你必须使用 a`div`来设置背景，所以我真的不能提出更好的选择（如果有的话）。

* * *

基于以下评论的解决方案：

你可以做的是以下。在主容器内有一个 div，绝对位置、宽度/高度 100% 和 z-index -1。然后，无论包含增长或缩小多大，它都将始终是正确的大小。使用这种方法，您必须确保容器始终具有大小。这是一个纯 CSS 的解决方案，可能比使用 Javascript 来调整更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:53:12.400

尝试：

```
var height = body.offsetHeight ? body.offsetHeight : html.offsetHeight;
document.getElementById ('divID').style.height = height + 'px'; 
```

这是一个有用的文档：

[http://www.quirksmode.org/dom/w3c_cssom.html](http://www.quirksmode.org/dom/w3c_cssom.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:56:08.770

我正在使用以下代码来做到这一点：

```
var getBodyHeight = function () {
    var d = document,
        bd = d.body,
        dd = d.documentElement,
        max = Math.max(
            bd.scrollHeight,
            bd.offsetHeight,
            bd.clientHeight,
            dd.offsetHeight,
            dd.scrollHeight,
            dd.clientHeight
        );

    return max;

}; 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-10-25T15:43:07.617

```
var height = screen.height;
var width = screen.width;
var resolution = width+"x"+height;
alert(resolution); 
```

它给出了屏幕的分辨率。我知道你想要页面的高度和宽度，但它会在以后的 Web 开发中帮助你。我将它用作我的网络最重要的部分！

# jquery - 在 iOS 上而不是在其他地方出现 javascript 错误

> ID：13072272
> 
> 赞同：2
> 
> 时间：2012-10-25T15:42:09.920
> 
> 标签：jquery, iphone, ios, undefined

我正在使用一个简单的 jquery 脚本来隐藏一个子菜单，将一个 div 附加到一个充当按钮的顶级导航，这将在单击时滑动切换该子菜单。它适用于我尝试过的所有主要浏览器，我的安卓手机没有任何问题。但是，当我在不允许脚本运行的 iOS 设备（在两个不同的 iPhone 版本和一个 iPhone 模拟器上测试）上尝试它时出现错误。

类型错误：“未定义”不是函数

我很困惑为什么我只在 iOS 设备上看到这个错误，并且感谢他们可爱的调试控制台，我不知道这个错误发生在哪里。关于为什么会发生这种情况的任何线索？

# android - 使用意图编辑日历事件不起作用

> ID：13072275
> 
> 赞同：6
> 
> 时间：2012-10-25T15:42:15.710
> 
> 标签：android, events, android-calendar

好的，我在这里非常准确地阅读了文档：http: [//developer.android.com/guide/topics/providers/calendar-provider.html#update-event](http://developer.android.com/guide/topics/providers/calendar-provider.html#update-event)并写了这样的内容：

```
// Here is an example of an intent that sets a new title for a specified event and lets users edit the event in the Calendar.

long eventID = 208;
Uri uri = ContentUris.withAppendedId(Events.CONTENT_URI, eventID);
Intent intent = new Intent(Intent.ACTION_EDIT)
    .setData(uri)
    .putExtra(Events.TITLE, "My New Title");
startActivity(intent); 
```

对我来说它不起作用 - 它打开了正确的事件，但无法编辑它 - 所有字段都是只读的。只有我可以更改的字段是时区和提醒。其他所有内容都是只读的。难道我做错了什么？

我的 API 级别是 14 (ICS)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T21:31:52.277

因此，我认为您没有做错任何事情-我通过命令行汇总了同一事物的基本实现，并且适用相同的限制：

```
am start -a android.intent.action.EDIT --es title "New Title" content://com.android.calendar/events/1 
```

我只能编辑与您相同的字段-您最好做 a`ACTION_VIEW`并让用户决定编辑（对不起，我没有更好的答案给您，这有点烦人）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-22T10:16:47.367

此[问题](http://code.google.com/p/android/issues/detail?id=39402)的解决方法：如果您使用 Intent.ACTION_VIEW，您至少会获得一个活动，您可以在其中点击“编辑”按钮，之后您可以编辑标题和位置以及其他所有内容（无论如何在默认日历应用程序中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-21T07:39:17.023

只有在您是该活动的组织者的情况下，您才能编辑活动，因此在您的情况下，您不是组织者

# ios - iPhone 模拟器 - doc 目录在哪里？

> ID：13072276
> 
> 赞同：0
> 
> 时间：2012-10-25T15:42:24.133
> 
> 标签：ios, plist

是这个吗？

ApplicationSupport/iPhoneSimulator/6.0/Applications/.../Documents 还是在包内容中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:45:08.053

在您的主目录中，转到库文件夹（在狮子和山狮中，库文件夹是隐藏的）。你可以通过点击 Go> Goto Folder 找到它，然后输入 library，然后是 application support，iPhone sim... 等等。下面的例子

/Users/[用户名]/Library/Application Support/iPhone Simulator/6.0/Applications

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:46:05.370

请参阅[此 SO 帖子](https://stackoverflow.com/questions/8307265/physical-path-for-application-documents-directory)。它存储在 Users 文件夹中，然后在 SDK 版本标识符下存储一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T09:15:53.200

Users/User/Library 文件夹默认是隐藏的。您首先需要[使用终端取消隐藏 mac 中](http://beageek.biz/how-to-access-xcode-simulator-directory/)的隐藏文件，然后您可以通过以下 url 访问 iphone 模拟器 doc 目录 -

> /Users/YOURUSER/Library/Application Support/iPhone Simulator/IOSVERSION/Applications/APPID/Documents/file.txt

# oracle - ODP.NET TNS：无法解决错误

> ID：13072277
> 
> 赞同：0
> 
> 时间：2012-10-25T15:42:29.827
> 
> 标签：oracle, odp.net

赢 7 64 位 SP 1

从 .NET 程序中获取错误“ORA-12154：TNS：无法解析指定的连接标识符”。

我已经在我的机器上安装了 Oracle 11.2 32 位客户端。

使用 Visual Studio 2010，我包含来自 C:\oracle\Ora112\odp.net\bin\4\Oracle.DataAccess.dll 的参考。

使用连接字符串值：User Id=myid;Password=mypw;Data Source=DBNAME;pooling=false;Connection Timeout=45;

运行 TNSPING DBNAME 有效。它说它正在使用 C:\oracle\Ora112\network\ADMIN\sqlnet.ora。此文件设置为使用 ldap 而不是 tnsnames。

运行 sqlplus 有效。我可以使用 myid/dbinstance 进行连接

当所有这些其他事情都正常工作时，我想不出ODP.NET为什么会给出这个错误的任何原因。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:49:45.137

我不得不为不同的服务器处理不同的连接字符串。尝试按照以下方式建模的字符串：

```
DATA SOURCE=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=dbservername.company.com)(PORT=1542)))(CONNECT_DATA=(SID=your_sid_from_tnsnames.ora)(SERVER=DEDICATED)));USER ID=myid;Password=mypw 
```

# java - 如何在 Maven 安装期间抑制 PMD 警告

> ID：13072280
> 
> 赞同：3
> 
> 时间：2012-10-25T15:42:32.473
> 
> 标签：java, maven, maven-plugin, pmd, suppress-warnings

我有一个使用**Maven**构建的 Java 项目，因此我的构建过程是在项目的*pom.xml*文件中定义的。我的开发团队使用各种插件来检查我们源代码的质量；一个这样的插件使用**[PMD](http://pmd.sourceforge.net/)**来检查代码。该插件确保每次我们`mvn install`在项目上执行时都会运行 PMD，如果有违规，它将导致构建失败。这是我们 pom.xml 中的插件：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-pmd-plugin</artifactId>
            <version>2.7.1</version>
            <configuration>
                <targetJdk>1.6</targetJdk>
                <linkXref>false</linkXref>
                <failOnViolation>true</failOnViolation>
                <failurePriority>1</failurePriority>
                <rulesets>
                    <ruleset>config/pmd-rulesets.xml</ruleset>
                </rulesets>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>check</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

我的问题是有时——尤其是当我正在开发一项任务并且我想检查我的代码是否构建时，但在我准备将我的源代码提交给 SCM 以进行自动构建和发布之前给其他人——当我想抑制 PMD 违规导致我的构建失败时。我知道这样一种解决方案是进入代码并添加注释以抑制警告（[http://pmd.sourceforge.net/suppressing.html](http://pmd.sourceforge.net/suppressing.html)），但我相信以这种方式编辑源代码只是为了抑制这些违规行为是烦人且容易出错。我可以做的另一件事是编辑我的 pom 并注释掉 PMD 插件。但是，我再次发现，更改对我的整个应用程序至关重要的文件既烦人又容易出错。

我的团队想要的解决方案是允许我们简单地将某种标志或参数传递到我们的`mvn`命令中，以快速告诉构建过程跳过 PMD 插件。例如，每当我们在开发阶段运行安装并且我们知道集成测试可能会失败（例如，Web 服务可能未激活）时，我们`-Dskip.integration.tests=true`在`mvn install`. 这是一个比编辑我们的测试文件或更改 pom.xml 更简洁的解决方案。我正在寻找一个类似的变量来允许我们快速跳过 PMD 违规。谢谢！

**PS**：我做了功课。以下两个 Stackoverflow 问题不包含我想要的解决方案：

*   [带有 Maven 的 PMD - 如何禁用规则集中的一个规则？](https://stackoverflow.com/questions/9147938/pmd-with-maven-how-to-disable-one-rule-within-a-ruleset)
*   [PMD - 如何从违规检查中排除文件](https://stackoverflow.com/questions/9769641/pmd-how-to-exclude-files-from-violation-check)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-25T15:47:40.317

只需在 pom.xml 中将 failPmdOnViolation 属性声明为 true，在插件设置中指定该属性而不是硬编码常量，然后您可以通过从命令行激活特殊配置文件来覆盖它。或者您可以参考[failOnViolation 插件属性的默认表达式，](http://maven.apache.org/plugins/maven-pmd-plugin/check-mojo.html#failOnViolation)例如`mvn -Dpmd.failOnViolation=false install`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-03-22T22:28:12.770

我以与我们使用相同的方式使用以下命令`skipTests=true`。

```
mvn clean install -Dpmd.skip=true 
```

我们也可以使用 findbugs

```
-Dfindbugs.skip=true 
```

# ios - iOS：SharedCoreData 示例代码 (iCloud + CoreData) | 如何合并更改

> ID：13072287
> 
> 赞同：4
> 
> 时间：2012-10-25T15:43:18.057
> 
> 标签：ios, core-data, icloud

我正在尝试采用 iCloud 和 CoreData 的 WWDC 2012 示例代码（[链接到 github 示例代码](https://github.com/jab5990/TestCDiCloud)），并且需要一些帮助来理解那里发生的事情。

我有一个表格视图，它从 NSFetchedResultsController 中获取其内容，就像在示例中一样。NSFetchedResultsController 与示例提供的 CoreDataController 中的主 NSManagedObjectContext 连接。对条目的更改从一台设备同步到另一台设备，它就像一个魅力。但是没有地方将来自 iCloud 的更改实际合并到主上下文中。我见过很多使用 NSPersistentStoreDidImportUbiquitousContentChangesNotification 合并更改的示例，但在此代码中从未发生过。

但奇怪的是：我从主上下文中取出一个对象并持有它。如果我收到 NSPersistentStoreDidImportUbiquitousContentChangesNotification 我使用 objectId 并从 NSMangedObjectContext 重新加载对象：

```
NSManagedObjectID* objectId = [myObject objectID];
NSManagedObject* theNewObject = [[_coreDataController mainThreadContext] objectWithID:objectId];
myObject = theNewObject; 
```

但该对象不是最新的。即使我使用对象的唯一属性使用谓词进行提取。但是带有 NSFetchedResultsController 的表视图显示了更改。我在这里想念什么？

编辑1（阅读汤姆的回答后）：

我添加了一个观察者`NSPersistentStoreDidImportUbiquitousContentChangesNotification`：

```
- (void)iCloudupdate:(NSNotification*)note {
    NSManagedObjectContext* moc = [[CoreDataController sharedController] mainThreadContext];
    [moc performBlock:^{
        [moc mergeChangesFromContextDidSaveNotification:note];
        [self refreshObject];
    }];
} 
```

该方法`refreshObject`使用`NSManagedObjectID`来从主 MOC 获取对象，但它仍然是旧版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T06:29:59.903

这可能是一个 iOS 错误。看到这个线程：[http ://devforums.apple.com/message/735512#735512](http://devforums.apple.com/message/735512#735512)

这为我修复了它：

```
NSManagedObjectContext *moc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
moc.stalenessInterval = 0; 
```

这没有帮助：

```
[moc refreshObject:myObject mergeChanges:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T21:22:27.037

SharedCoreData 示例代码的缺失`NSPersistentStoreDidImportUbiquitousContentChangesNotification`是一个相当大的遗漏。您肯定需要观察它，而您不这样做的事实与看不到更新的值直接相关。如果您要退出应用程序并重新启动它，您可能会得到您期望的新值。

在最简单的情况下，当您收到此通知时，您需要做两件事：

1.  `-[NSManagedObjectContext mergeChangesFromContextDidSaveNotification:notification]`以传入的更改通知作为参数调用。这将通知您的 MOC 新值。如果您在内存中有未保存的更改，它们将根据 MOC 的合并策略与传入的更改合并（`NSMergePolicy`有关此处选项的更多详细信息，请参阅文档中列出的常量）。
2.  运行重复数据删除过程。示例代码*确实*有一个示例实现。您需要查看它，看看它是否适合您的数据模型——即它是否真的正确检测到重复。

# mysql - 用于数据库查询的 Coldfusion 数组

> ID：13072288
> 
> 赞同：1
> 
> 时间：2012-10-25T15:43:19.250
> 
> 标签：mysql, coldfusion

我正在尝试使用下面的 cfml(sql) 语句查询数据库，但我希望能够从数组中获取每个 stat_instance 的结果，最后一行包含循环，我认为应该为每个值生成一个查询从数组

```
select 
    <cfif monthCrossover>
        statsMinEnd2 + 
    </cfif> 
    stats_min as time_stamp, 
    <cfif structKeyExists(avgThis, arguments.key)>
        avg
    <cfelse>
        sum
    </cfif>
    (stats_value) as stats_value 
from stats_kv_table_201207 
where 
    <cfif dayStart == dayEnd>
        stats_day = <cfqueryparam value="#dayStart#">
    <cfelse> 
        stats_day >= <cfqueryparam value="#dayStart#"> 
        and stats_day <= <cfqueryparam value="#dayEnd#">
    </cfif>
    and stats_min >= <cfqueryparam value="#statsMinStart1#"> and stats_min <= <cfqueryparam value="#statsMinEnd1#">
    and stats_component = <cfqueryparam value="#arguments.component#">
    <cfset instanceList = ListToArray(arguments.instance)>
    <cfif ArrayLen(instanceList) EQ 1>
        and stats_instance = <cfqueryparam value="#arguments.instance#">
    </cfif>
    <cfif ArrayLen(instanceList) GT 1>
        and stats_instance IN (<cfqueryparam value="#arguments.instance#" list="yes"/>)
    </cfif>
    <cfif ArrayLen(instanceList) GT 1 and ArrayContains(instanceList, "multi")>
        <cfloop index = "i" from="1" to="#arrayLen(instanceList)#"  array =#instanceList#> 
            <cfset stats_instance = <cfqueryparam value= #instanceList[i]#>
        </cfloop>
    </cfif> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:59:26.013

如果我正确理解您的问题，您可能需要在查询中使用 GROUP BY 子句按 stats_instance 对总和/平均值进行分组。像这样的东西：

```
SELECT stats_instance, ...
FROM ...
WHERE
... 
<cfif len(trim(arguments.instance))>
AND stats_instance IN (<cfqueryparam value="#arguments.instance#" list="yes"/>)
</cfif>
GROUP BY stats_instance
ORDER BY stats_instance 
```

注意：语法可能因您的数据库引擎而异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T18:48:06.383

这样做有什么问题吗？

```
<cfset myArr = ArrayNew(1) />
<cfloop array="myOtherArr" index="index">
    <cfquery name="myQuery" datasource="myDataSource">...</cfquery>
    <cfset ArrayAppend(myArr, myQuery.value) />
</cfloop> 
```

# javascript - 是否有一种可移植且干净的方法来设置函数的 __proto__ 属性？

> ID：13072294
> 
> 赞同：1
> 
> 时间：2012-10-25T15:43:37.743
> 
> 标签：javascript, prototype

我知道 IE 不支持`__proto__`，但我正在考虑函数。`new Constructor`只能设置`__proto__`自动创建的对象的隐藏，如果返回一个函数它`__proto__`是不变的，ES5`Oject.create`不能创建一个函数。如何设置`__proto__`函数的？您可能会建议在 上设置属性`Function.prototype`，但这不是一个干净的方法。我还想避免直接在单个函数上设置属性，因为它既不干净也不友好，毕竟一个新属性，即使只是一个引用，在 32 平台上也可能消耗至少 4 个字节，而`__proto__`这是强制性的，因此一文不值。请忍受我的小气;）那么，有没有人知道如何做到这一点而不诉诸于`__proto__`？提前致谢！

--->8---

编辑：

我的意图是将`arguments.callee`s 用作普通对象，它们有自己的方法，我认为如果我可以将这些方法放在原型中会很时髦。

# facebook - 按动作和对象过滤朋友

> ID：13072295
> 
> 赞同：0
> 
> 时间：2012-10-25T15:43:42.183
> 
> 标签：facebook, facebook-graph-api

使用以下 Open Graph URL，我可以加载用户的朋友以及用户针对特定命名空间中的特定操作所做的一切。

> 我/朋友？字段=名称，我的命名空间：我的动作

缺点是这会加载所有朋友，即使他们没有使用该操作。有没有办法过滤结果，以便只检索使用过该操作的朋友？

另外，有没有办法只加载具有特定值的属性的操作？说，我只想加载朋友，如果他有以下评估为真的动作？

> 我的命名空间：myid == 123

*（很抱歉将问题发布在此板上，而不是[专门针对 Facebook](http://facebook.stackoverflow.com)的问题，但它不会让我在那里发布，说无论我做什么我都没有正确的标签）*

# jquery - 使用 onclick 事件将变量传递给动态创建按钮的函数

> ID：13072297
> 
> 赞同：0
> 
> 时间：2012-10-25T15:43:55.127
> 
> 标签：jquery

请在下面找到代码。当我试图将变量 tmp_lnk 从 onclick 事件传递给函数时，它会引发一个错误，即 tmp_lnk 未定义。如何将变量传递给函数？

```
if(fig_name[1]==img_name)
{
var tmp_lnk = "Supplementary Notes for Images/"+"6H-"+img_name/img_name+".pdf"
$("#notes1").append('<div><a onclick="On_Click(tmp_lnk)" id="closebutton">NOTES</a></div>')
break;
}}

function On_Click(tmp_link)
{
    window.open("tmp_lnk");
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:45:55.967

```
$("#notes1").append('<div><a onclick="On_Click(' + tmp_lnk+ ')" id="closebutton">NOTES</a></div>') 
```

和

```
function On_Click(tmp_lnk)
{
    window.open(tmp_lnk);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:45:37.807

或者，这个怎么样：

```
$("#notes1").append('<div><a onclick="On_Click('+tmp_lnk+')" id="closebutton">NOTES</a></div>') 
```

这将使变量内容写在方法调用上，解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:45:43.540

因为您在 if 中声明 tmp_lnk 使其成为全局或在 if 之外声明

```
var tmp_lnk
if(fig_name[1]==img_name)
{
tmp_lnk = "Supplementary Notes for Images/"+"6H-"+img_name/img_name+".pdf"
$("#notes1").append('<div><a onclick="On_Click(tmp_lnk)" id="closebutton">NOTES</a></div>')
break;
}}

function On_Click(tmp_link)
{
    window.open("tmp_lnk");
}
} 
```

**好读**

# [JavaScript 变量范围](https://stackoverflow.com/questions/500431/javascript-variable-scope)

# c# - 是否可以测试给定的表达式是否可以在*不*连接到 SQL 数据库的情况下转换为 SQL？

> ID：13072304
> 
> 赞同：6
> 
> 时间：2012-10-25T15:44:06.300
> 
> 标签：c#, entity-framework

例如：-

```
// This one will be converted to SQL no problem
Expression<Func<Foo, bool>> predicate = x => x.Name = "Foo";

// This one will throw a NotSupportedException because the QueryProvider
// doesn't support reference comparisons
Expression<Func<Foo, bool>> predicate = x => x == someOtherFoo;

// This one doesn't work because the query provider can't
// handle IsAwesome()
Expression<Func<Foo, bool>> predicate = x => x.IsAwesome(); 
```

我正在寻找一种在运行前测试它的方法，最好是在与数据库隔离的自动化测试中。

我花了一些时间浏览 MSDN，试图找到如何实例化我自己的 QueryProvider，但我的 Google-fu 今天似乎让我失望了。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:11:50.643

您需要一个模型来执行此操作，但您不需要数据库。您可以将模型创建为 EDMX，但使用 Code First 可能更容易。为确保创建或使用 Code First 模型不需要数据库连接，您需要提供 Code First 通常从数据库中获取的一些信息。这篇文章[http://blog.oneunicorn.com/2012/04/21/code-first-building-blocks/](http://blog.oneunicorn.com/2012/04/21/code-first-building-blocks/)展示了如何使用 DbModelBuilder 来执行此操作以及如何从模型创建 DbContext。你最终会得到一些像这样的代码：

```
var modelBuilder = new DbModelBuilder();
modelBuilder.Entity<Foo>();
var model = modelBuilder.Build(
                new DbProviderInfo("System.Data.SqlClient", "2008")).Compile(); 
```

您可能希望缓存模型对象，而不是为每个不同的测试重新创建它。

您还应该禁用数据库初始化程序以防止 DbContext 尝试连接到数据库。例如，在使用上下文之前进行如下调用：

```
Database.SetInitializer<FooContext>(null); 
```

现在您可以在任何查询上使用 ToString 来查看它将生成什么 SQL。如果 LINQ 无法处理表达式，那么您将得到一个异常。例如，这将打印查询：

```
using (var context = new FooContext(model))
{
    Expression<Func<Foo, bool>> predicate = x => x.Name == "Foo";

    Console.WriteLine(context.Foos.Where(predicate));
} 
```

这将抛出：

```
using (var context = new FooContext(model))
{
    var someOtherFoo = new Foo();
    Expression<Func<Foo, bool>> predicate = x => x == someOtherFoo;

    Console.WriteLine(context.Foos.Where(predicate));
} 
```

显然，如果您正在编写测试，您将不仅仅是打印到控制台，而是执行某种断言/检查。

# php - 如何使用 facebook php SDK 获得长期存在的访问权限

> ID：13072305
> 
> 赞同：1
> 
> 时间：2012-10-25T15:44:09.740
> 
> 标签：php, facebook, sdk, token

您好我正在使用 JSDK 通过 FB.login 登录，然后使用 PHP SDK 获取用户信息。现在我需要获得一个扩展的访问令牌，但这根本行不通：

```
$facebook->setExtendedAccessToken();
$access_token = $facebook->getAccessToken(); 
```

这会引发以下错误：

```
Fatal error: Call to undefined method Facebook::setExtendedAccessToken() in.... 
```

现在我的访问令牌只工作了几分钟，这会导致问题任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:52:39.810

更新您的 SDK，[https://github.com/facebook/facebook-php-sdk](https://github.com/facebook/facebook-php-sdk)。您正在寻找这一行[https://github.com/facebook/facebook-php-sdk/blob/master/src/base_facebook.php#L351](https://github.com/facebook/facebook-php-sdk/blob/master/src/base_facebook.php#L351)

# xsd - 如何在名称附加了计数器的架构中正确定义元素名称

> ID：13072311
> 
> 赞同：0
> 
> 时间：2012-10-25T15:44:39.333
> 
> 标签：xsd

我将如何正确定义我的元素 RandomAmount_

//当RandomAmount可以是RandomAmount_1到RandomAmount_N时

```
<xs:element name="RandomAmount">
   <xs:complexType>
       <xs:choice maxOccurs="unbounded" minOccurs="0">
            <xs:element type="xs:float" name="RandomAmount_" />
       </xs:choice>
   </xs:complexType>
 </xs:element> 
```

我觉得应该将 RandomAmount 命名为 =“ RandomAmount_* ”来解决问题，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T19:01:15.517

XSD 元素声明必须为元素指定一个名称；没有提供您显然正在寻找的那种姓名的家庭。

目前尚不清楚建议您做什么，主要是因为不清楚为什么要在元素名称中包含数字。如果您想通过`RandomAmount_1419`在随机数生成器返回值 1419 时命名元素来返回对随机数生成器的调用的值，那么我建议您只需命名元素`RandomAmount`并返回元素内容中的值，或在属性中。

另一方面，如果您想要数字以便父`RandomAmount`元素的子元素命名为`RandomAmount_1`, `RandomAmount_2`,`RandomAmount_3`等，那么我的建议仍然是相同的：只需给所有子元素取相同的名称，然后让您的数据为 (例如）：

```
<RandomAmount>
  <amount>1419</amount>
  <amount>8676</amount>
  <amount>862</amount>
  <amount>7331</amount>
  <amount>7318</amount>
  ...
</RandomAmount> 
```

没有必要给孩子起不同的名字；实际上，如果所有孩子都包含相同类型的信息（我从您的命名中猜测它们包含随机数），那么最好*不要*给他们不同的名字。（如果您需要能够引用序列中的第三个数字，XPath 有简单的方法来做到这一点；如果您要映射到一个无法处理多个同名子元素的对象系统，请获得一个更好的对象映射系统.)

# java - 在 ImageIO.read() 和 ImageIO.write() 之后，jpeg 图像颜色发生了巨大变化

> ID：13072312
> 
> 赞同：18
> 
> 时间：2012-10-25T15:44:45.567
> 
> 标签：java, image, image-processing

我一直在 javax.imageio.ImageIO 中使用 ImageIO.read() 和 ImageIO.write() 方法来读取和写入图像，我发现一些图像的颜色发生了奇怪的变化。

即使我将代码更改为只读取图像并写入它们（使用 jpeg、png、gif），所有这些新图像都有相同的问题。

我是否需要在 ImageIO.read/write 方法之前/之后添加任何其他代码？

这是我使用的代码：

```
 File f = new File("obw.jpg");
    BufferedImage bi = ImageIO.read(f);
    FileOutputStream fos2 = new FileOutputStream("obw2.jpg");
    ImageIO.write(bi, "JPG", fos2);
    FileOutputStream fos3 = new FileOutputStream("obw3.gif");
    ImageIO.write(bi, "GIF", fos3);
    FileOutputStream fos4 = new FileOutputStream("obw4.png");
    ImageIO.write(bi, "PNG", fos4); 
```

我的环境：

```
 java version "1.6.0_35"
    MacOSX 10.8.2 
```

原图： ![在此处输入图像描述](../Images/12d75faef0d3e84df9e5504f6263f98e.png)

读写后的图像之一：

![在此处输入图像描述](../Images/3761bb80a981e729fbf3d56dcc12650e.png)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-01-07T19:56:51.093

您的问题是 ImageIO 将 JPEG 中的 YCbCr 数据误解为 RBG 数据。相关的 Java 错误是[4712797](http://bugs.sun.com/view_bug.do?bug_id=4712797)和[4776576](http://bugs.sun.com/view_bug.do?bug_id=4776576)，Oracle 错误地声称这些错误已在 Java 1.4 中修复，但实际上仍然困扰着一些 Java 5、6 和 7 JVM。

在我从事的一个项目中，我们通过加载一个[带有单个黑色像素的特殊构建的测试 JPEG 来](https://sourceforge.net/p/vassalengine/svn/HEAD/tree/VASSAL-src/trunk/src/images/black.jpg)解决这个问题，以查看 ImageIO 是否正确加载它。如果像素变为绿色，则 ImageIO 误解了图像数据，因此当我们稍后加载 JPEG 并检测到导致问题的 JPEG 类型时，我们还会应用颜色校正。（在 JVM 中触发问题的 JPEG 类型具有特定类型的二次采样且没有 JFIF 标记。）

这是一些处理该问题的[LGPLv2 许可代码。](https://sourceforge.net/p/vassalengine/svn/HEAD/tree/VASSAL-src/trunk/src/VASSAL/tools/image/ImageIOImageLoader.java)当世界其他地方都设法正确加载 JPEG 时，需要这样的代码来解决数十年前的错误，这是我希望 Java 在火灾中死去的原因之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:53:05.497

似乎是色彩空间问题，imageIO 尝试对图像进行一些编码/解码，但似乎失败了。看看这里： [无法使用 ImageIO.read(File file) 读取 JPEG 图像](https://stackoverflow.com/questions/2408613/problem-reading-jpeg-image-using-imageio-readfile-file)

# python - 我在我的 python oauth2 POST 标头中放了什么？

> ID：13072317
> 
> 赞同：1
> 
> 时间：2012-10-25T15:45:12.297
> 
> 标签：python, header, request, oauth-2.0

这是我当前使用 oauth2 在 python 中进行 POST 的代码。对于我的一生，我无法克服 401 错误，我认为这可能与我的标题有关。我只是在打印时将标题粘贴在这里，因为我使用另一个例程通过 myheaders=req.to_header() 生成它们。这应该向您展示那里的真实情况。什么看起来不对劲？请帮忙！

```
def post_or_put_me(myaction,myxml,myurl):
    CONSUMER_KEY = 'my_admin_access'
    CONSUMER_SECRET = 'xxxxxxxx'
    consumer = oauth2.Consumer(key=CONSUMER_KEY, secret=CONSUMER_SECRET)
    token = oauth2.Token(key=CONSUMER_KEY, secret=CONSUMER_SECRET)
    client = oauth2.Client(consumer, token)
    myheaders = {'Authorization': 'OAuth realm="",oauth_body_hash="xxxxxxxx",oauth_nonce="84691521", oauth_timestamp="1351179163",oauth_consumer_key="my_admin_access",oauth_signature_method="HMAC-SHA1", oauth_version="1.0", oauth_signature="xxxxxxxxxx"'}
    xml_string = ElementTree.tostring(myxml)
    data = urllib.urlencode({'xml': xml_string})

    resp, content = client.request(
        myurl,
        method=myaction,
        body=data,
        headers = myheaders,
    ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:49:25.563

我终于发现 2-legged oauth2 POST/PUT 构建了自己的标头；我不必填充它们，除了 Content-Type （在我的情况下）。有关如何执行 2-legged GET 和 2-legged POST/PUT 的完整详细信息，请参阅此处提供的答案：[How do I send a POST using 2-legged oauth2 in python?](https://stackoverflow.com/questions/12977604/how-do-i-send-a-post-using-2-legged-oauth2-in-python/13167178#13167178) .

# javascript - 如何在没有事件的情况下调用 jQuery 函数

> ID：13072319
> 
> 赞同：1
> 
> 时间：2012-10-25T15:45:14.673
> 
> 标签：javascript, jquery, datatables, jquery-events

我正在尝试使数据表在单击时展开以显示更多信息。问题是我正在通过大约 1000 条记录填充表，所以我可以保留更多详细信息数据（扩展内容）的唯一方法是在循环过程中通过链接发送数据，就像这样......

```
var imgCell = '<a href="javascript:storeInfo(&quot;'+theFilePath+'&quot;,&quot;'+theWebAddress+'&quot;,&quot;'+projectStatus+'&quot;);"><img src="https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_open.png"></a>'; 
```

这样就创建了一个在单击时调用此函数的图像链接...

```
function storeInfo (filePath, webAddress, projectStatus)
{
theFilePath = filePath;
theWebAddress = webAddress;

switch(projectStatus){
case "New Work - Waiting Activation":
    controlButton("NewWork", NewWorkTable);
break;
case "Active Projects":
    controlButton("ActiveProjects", ActiveProjectsTable);
break;
case "Waiting for Assets or Approvals":
    controlButton("WaitingAssets", WaitingAssetsTable);
break;
 //AND A WHOLE LOT MORE CASES
    }   
} 
```

基本上，此函数将文件路径和网址保存到全局变量以供以后使用，然后调用`controlButton`函数...

```
function controlButton (projectStatus, theTable){
$('#'+projectStatus+' tbody td img').live('click', function () {

    var nTr = this.parentNode.parentNode.parentNode;
    if ( this.src.match('details_close') )
        {
            // This row is already open - close it 
            this.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_open.png";
            theTable.fnClose( nTr );
        }
    else
        {
            // Open this row 
            this.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_close.png";
            theTable.fnOpen( nTr, fnFormatDetails(theTable, nTr), 'details' );
        }
     });
} 
```

这样做是在 html 表中获取 img，然后找到其所在的行，然后调用一个打开或关闭可扩展数据的函数......这是通过 `fnOpen`和`fnClose`使用`fnFormatDetails`来填充可扩展行来完成的......

这一切都很好，花花公子，一切都被正确传递并加载很好，但唯一的问题是它需要两次点击来打开和关闭可扩展行......一次是图像上的链接，然后是另一个调用 jQuery 函数。我需要一种方法来解决这个问题，只需单击一下，同时仍然为每个单独的条目加载数据......我在想最好的方法是找到一种方法来调用 jQuery 函数而`.live('click', function()`无需需要第二次点击。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:52:42.057

更新您的功能如下

storeInfo() 的声明：

```
function storeInfo (filePath, webAddress, projectStatus, elem)
{ //code } 
```

调用链接：

```
<a href="javascript:storeInfo("'+theFilePath+'","'+theWebAddress+'","'+projectStatus+'", this);"><img src="..."></a> 
```

内部对 controlButton() 的调用：

```
controlButton("ActiveProjects", ActiveProjectsTable, elem); 
```

并更新了 controlButton() 函数：

```
function controlButton (projectStatus, theTable, elem){
    img = elem.getElementsByTagName("img")[0]; //alternatively: $(elem).find('img');
    var nTr = elem.parentNode.parentNode;
    if ( img.src.match('details_close') )
    {
        // This row is already open - close it 
        img.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_open.png";
        theTable.fnClose( nTr );
    }
    else
    {
        // Open this row 
        img.src = "https://cubistmediagroup.sharepoint.com/sites/canvas/PublishingImages/details_close.png";
        theTable.fnOpen( nTr, fnFormatDetails(theTable, nTr), 'details' );
    }
} 
```

无法测试，但应该可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:02:15.387

我不确定我是否正确理解了您的问题，但是如果仅从 storeInfo（由单击触发）调用 controlButton，我不明白为什么您需要在 controlButton 中进行实时绑定。如果只是为了获取 nTr，则可以将其作为参数从 storeInfo 传递给 controlButton。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:49:03.490

我不知道我是否理解你的问题，但你能简单地在你的`storeInfo`函数结束时调用`controlButton`函数吗？

# mysql - MySQL 子查询返回错误数据

> ID：13072320
> 
> 赞同：1
> 
> 时间：2012-10-25T15:45:18.940
> 
> 标签：mysql, database

我遇到了子查询/联合的​​问题。

这就是我想要的：我有一个订单的“备份表”（它用于某些目的，而不仅仅是备份），我称之为 dc_all_orders。我还有另外两个表，wb_orders 和 wb_printed。订单首先进入 wb_orders，然后在工作流步骤之后进入 wb_printed。我们已经看到一些订单项丢失了，我们在备份表中有这些，但在两个主订单表中没有。我想计算受影响的 orderItems。我知道 100% 计数应该大于 0，但它一直返回零。应计入的项目示例：

```
mysql> select orderId,productId from dc_all_orders where productId = '22040247153891';
+---------------------+----------------+
| orderId             | productId      |
+---------------------+----------------+
| 20319833369460309A  | 22040247153891 |
+---------------------+----------------+
1 row in set (2.06 sec)

mysql> select * from wb_orders where productId = '22040247153891';
Empty set (0.00 sec)

mysql> select * from wb_printed where productId = '22040247153891';
Empty set (0.00 sec) 
```

所以这个productId应该出现。现在：

```
mysql> select count(*) from (select productId from wb_orders UNION select productId from wb_printed) as x;
+----------+
| count(*) |
+----------+
|  4295961 |
+----------+
1 row in set (2 min 51.80 sec) 
```

所以你知道我们有多少数据。

```
mysql> select count(*) from dc_all_orders WHERE productId NOT IN 
    -> (select productId from wb_orders UNION select productId from wb_printed);
+----------+
| count(*) |
+----------+
|        0 |
+----------+
1 row in set (11 min 9.20 sec) 
```

我无法解释。我用不同的方式尝试过，但每种方式都显示为 0。我能想到的只是子查询的大小，但我检查了日志，没有错误，如您所见，返回结果没有错误。

我缺少明显的东西吗？:)

这是另一种方式：

```
mysql> select count(productId) from dc_all_orders WHERE productId NOT IN (select productId from wb_orders) AND  productId NOT IN (select productId from wb_printed);
+------------------+
| count(productId) |
+------------------+
|                0 |
+------------------+
1 row in set (6 min 3.07 sec) 
```

编辑：MySQL 版本：CentOS 5.8 上的“服务器版本：由 IUS 社区项目分发的 5.1.65-ius”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:45:35.127

我还没有找到这个的底部，但 MySQL 似乎确实对可以与`IN (subquery)`. [参考文献中的“子查询限制”](http://dev.mysql.com/doc/refman/5.5/en/subquery-restrictions.html)中肯定没有提到，但我之前也遇到过。解决方案是以不同的方式编写查询。

例如，您可以尝试使用`EXISTS (subquery)`：

```
select count(productId) from dc_all_orders a WHERE 
   NOT EXISTS (select 1 from wb_orders o where a.productId = o.productId) 
```

或者您可以使用 a 编写查询`LEFT JOIN`，尽管这有点棘手（如果您有多个条目，`wb_orders`您`productId`将获得重复项；要删除重复项，您必须应用`group by`或`distinct`取决于您想要做什么......）

```
select count(distinct a.productId) from dc_all_orders a LEFT JOIN wb_orders o 
    ON a.productId = o.productId WHERE o.id IS NULL 
```

# java - 如何调用传递的方法？这是代表团，对吧？

> ID：13072321
> 
> 赞同：0
> 
> 时间：2012-10-25T15:45:23.447
> 
> 标签：java, reflection, delegates

好的，我*知道*这已经被问了数百次了，我知道我可能会得到“去寻找答案”的回应，但无论如何我都会尝试询问。很简单，我想传递一个方法并用它来写一个字符串。例如：

```
void writeStuff(Method method) {
    method.invoke("the string to write");
} 
```

这样，我可以将接收字符串的方法交给它，例如 System.out.print 或 LOGGER.info。哎呀，为什么不接受*任何*接受 String 作为

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:54:43.050

对于非静态方法，您需要它的对象，否则此所有者可以为空。然后是要处理的异常。

```
void writeStuff(Object owner, Method method) {
    method.invoke(owner, "the string to write");
} 
```

因此，直到下一个 java 版本，使用一个接口（使用一个方法）并传递这些实例：

```
interface Printable { void print(String s); }

void writeStuff(Printable p) {
    p.print("...");
});

writeStuff(new Printable() {
    @Override public void print(String s) { System.out.println(s); }
}); 
```

* * *

对于静态方法、函数，确实不需要`this`（所有者）。在像 Algol68（1968 年但仍然活跃！）这样的顶级终极语言中，可以这样做：

REAL y = IF c THEN sin ELSE cos FI (x);

sin 和 cos 是 PROC(REAL)REAL 类型的代码值的名称。

Java 对字段和方法做了一个可悲的区分：你可以有一个同名的字段`int x`和方法，重载方法。对于函数对象之类的东西，人们永远无法使用.`void x(boolean)``boolean x()``System.out.println`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:50:24.727

您是否阅读过调用的文档？

[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/reflect/Method.html#invoke(java.lang.Object](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/reflect/Method.html#invoke(java.lang.Object) , java.lang.Object[])

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:51:52.147

您还必须指定应该调用该方法的对象。

确实，您可以从流行的来源阅读此内容：

[用于调用的 Javadoc API 1.7](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Method.html#invoke%28java.lang.Object,%20java.lang.Object...%29)

和

[关于调用方法的 Sun/Oracle 教程](http://docs.oracle.com/javase/tutorial/reflect/member/methodInvocation.html)

--待定

# kerberos - 具有 1 路信任的多域 Kerberos 配置

> ID：13072335
> 
> 赞同：1
> 
> 时间：2012-10-25T15:45:50.810
> 
> 标签：kerberos

我已经为 documentum 客户端配置了多域 Kerberos SSO，在域之间具有 1 路信任...但是在登录客户端时，我收到以下错误...

```
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos: 重置状态...
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: principal = 'HTTP/mdk1waytrustd3.wtmdk1waydom3.com'
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos：领域 = 'WTMDK1WAYDOM3.COM'
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：使用 JNDI 找到名称服务器
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: mdk1waytrustd2.wtmdk1waydom2.com (10.31.70.183)
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: mdk1waytrustd1.wtmdk1waydom1.com (10.31.69.52)
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: MDK1WAYTRUSTD3.WTMDK1WAYDOM3.COM (10.31.70.184)
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: mdk1waytrustd4.wtmdk1waydom4.com (10.31.71.34)
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: corpinba8.corp.emc.com (10.30.48.37)
[调试] 2012 年 10 月 25 日星期四 02:56:04 PDT jcsi.kerberos: corpgefr3.corp.emc.com (152.62.196.10)
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：Windows LSA 的旧 JCSI Kerberos 代码现在默认禁用；
如果你真的想要它（而不是新的 WinSSPI 代码）你必须设置
        -Djcsi.kerberos.lsa.enable=true
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：创建 LSA 凭据缓存
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos: 找不到默认缓存: com.dstc.security.kerberos.KerberosException: 无法创建凭证存储 com.dstc.security.kerberos.KerberosException: Native in - 此平台不支持内存凭据缓存 (Windows Server 2008 R2)
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：登录成功
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：在 1351158964992 m/secs 时加载基于 InputStream 的 keytab，5 个条目
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：将主体绑定到主题
[调试] Thu Oct 25 02:56:04 PDT 2012 jcsi.kerberos：将凭据绑定到主题
```

有人可以帮助我克服这个问题吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-13T02:41:02.890

由于使用 dstc 登录模块而不是旧的 sun.security.auth 模块的 'krb5login.conf' 导致 Root。尝试如下修改您的 krb5login.conf，您会很高兴。:)

```
HTTP-mdk1waytrustd3-wtmdk1waydom3-com    
{
com.dstc.security.kerberos.jaas.KerberosLoginModule required
principal="HTTP/mdk1waytrustd3.wtmdk1waydom3.com"
noTGT=true
debug=true
refreshKrb5Config=true
useKeyTab=true
storeKey=true
doNotPrompt=true
useTicketCache=false
isInitiator=false
realm="WTMDK1WAYDOM3.COM"
keyTab="C:\\keytab location\\keytab.keytab";
}; 
```

# c# - 用 lambda 表达式替换字符串作为属性名称

> ID：13072337
> 
> 赞同：3
> 
> 时间：2012-10-25T15:45:53.857
> 
> 标签：c#, generics, reflection, types

我正在为属性构建自己的库，并且我想检查属性级别是否存在属性。目前我有这个方法很好用：

```
 public static bool HasPropertyAttribute<T>(this object instance, string propertyName)
    {
        return Attribute.GetCustomAttributes(instance.GetType().GetProperty(propertyName), typeof(T), true).Any();
    } 
```

现在我正在研究允许我将 lambda 表达式而不是字符串作为 propertyName 传递的解决方案。有没有一种优雅的方法来做到这一点，而无需添加此方法以成为依赖于两个泛型类型，即：

```
HasPropertyAttribute<T, TProperty>(...). 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T16:11:59.810

您可以使用 Lambda 表达式来解析编译时属性引用。[（从 lambda 表达式中检索属性名称](https://stackoverflow.com/questions/671968/retrieving-property-name-from-lambda-expression)修改的代码）

```
public PropertyInfo GetPropertyInfo<TProperty>(
    Expression<Func<TProperty>> propertyLambda)
{
    MemberExpression member = propertyLambda.Body as MemberExpression;
    if (member == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a method, not a property.",
            propertyLambda.ToString()));

    PropertyInfo propInfo = member.Member as PropertyInfo;
    if (propInfo == null)
        throw new ArgumentException(string.Format(
            "Expression '{0}' refers to a field, not a property.",
            propertyLambda.ToString()));

    return propInfo;
} 
```

您不需要将其用作扩展方法（尽管如果您想对其进行调整也*可以*，但是除了编写该行之外，没有必要拥有源对象实例）

```
public class Test
{
    public string Prop { get; set; }
}

Test t = new Test();
PropertyInfo propInfo = GetPropertyInfo(() => t.Prop);
Console.WriteLine(propInfo.Name + " -> " + propInfo.PropertyType); //Prop -> System.String 
```

编辑：如果你想有一些不错的语法并且必须避免对类型对象的现有引用，你可以执行以下操作：

```
public static class TypedReflection<TSource>
{
    public static PropertyInfo GetPropertyInfo<TProperty>(
        Expression<Func<TSource, TProperty>> propertyLambda)
    {
        MemberExpression member = propertyLambda.Body as MemberExpression;
        if (member == null)
            throw new ArgumentException(string.Format(
                "Expression '{0}' refers to a method, not a property.",
                propertyLambda.ToString()));

        PropertyInfo propInfo = member.Member as PropertyInfo;
        if (propInfo == null)
            throw new ArgumentException(string.Format(
                "Expression '{0}' refers to a field, not a property.",
                propertyLambda.ToString()));

        return propInfo;
    }
} 
```

并称它为：

```
PropertyInfo propInfo = TypedReflection<Test>.GetPropertyInfo(o => o.Prop); 
```

此时，很容易添加额外的类型化反射方法（get 方法、字段等）

编辑：它仍然依赖于两个泛型类型，但它通过类型推断隐藏起来。我更喜欢第二个例子；至少您需要指定声明类类型（因为您需要类型安全），但您不需要对象实例。它还有一个好处（我怀疑你在追求），如果你重命名属性，它会传播到这段代码，获取`PropertyInfo`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:29:42.810

我选择了这个解决方案，代码最少：

```
 public static bool HasPropertyAttribute<T, TProperty>(this T instance, Expression<Func<T, TProperty>> propertySelector, Type attribute)
    {
        return Attribute.GetCustomAttributes(instance.GetType().GetProperty((propertySelector.Body as MemberExpression).Member.Name), attribute, true).Any();
    } 
```

像这样调用：

```
var cc = new CustomClass();
cc.HasPropertyAttribute(x => x.Name, typeof(NullableAttribute)) 
```

# apache - 站点的文件夹从 Apache 根文件夹中消失

> ID：13072342
> 
> 赞同：0
> 
> 时间：2012-10-25T15:46:01.050
> 
> 标签：apache, root

希望这条消息在这个论坛上的位置（如果不告诉我，我会把它切换到另一个'stackexchange'）我正在本地安装一个站点，称之为'mysite'，但我仍然无法正确运行它（启动时出现 500 错误消息）。但奇怪的是：当我转到服务器的根目录时，我在浏览器中输入了 url `localhost:8888/`。所以它显示了我所有本地站点的列表，但没有出现“mysite”。奇怪的是，当我试图从控制台中找到它时，我找到了他。有人可以解释为什么它会从我的服务器的根目录中消失（也许它会解释 500 内部服务器错误）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:56:47.663

好的，这只是一个 .htaccess 文件，我没有从我从 github 导入的站点中第一次看到它！

# jquery - $('video').get(0).currentTime 在 iPhone/iPad 上不起作用

> ID：13072347
> 
> 赞同：1
> 
> 时间：2012-10-25T15:46:12.353
> 
> 标签：jquery, iphone, mobile, video

我通过将“currentTime”设置为 xxx 秒来跳过电影的不同章节。因此，我有一个屏幕，您可以在其中单击所谓的“垫” - 每章一个。

如果您单击垫，垫屏幕淡出，电影淡入并从它应该开始的地方开始（参见下面的代码）。这在任何浏览器上都能完美运行。但它不适用于 iPad/iPod/iPhone 等移动设备。我发现问题是这样的

```
$('video').get(0).currentTime = 
```

这是代码：

```
 $('.chapter_pad a').each( function(index) {
    $(this).click( function() {
        currentVid = index;
        endTime = videos[index]["end"];
        $("#startscreen").fadeOut(0, function() {
            $("#vids").fadeIn(0, function() {
                $('#video').get(0).currentTime = videos[index]["start"];
                $('#video').get(0).play();

            });
        });
    });
}); 
```

说明： ["start"] 和 ["end"] 是我之前创建的关联数组中的元素。这个关联数组包含章节名称、开始和结束时间等。

任何解决这个问题的想法都值得赞赏！

提前致谢！工厂

# c# - 传递视图状态/事件验证令牌；引起问题的特殊字符

> ID：13072351
> 
> 赞同：0
> 
> 时间：2012-10-25T15:46:21.140
> 
> 标签：c#, asp.net, .net, .net-4.0

我有一个视图状态和事件验证令牌，我试图通过我的应用程序传递。

我遇到的问题是我将这些信息传递给：

```
string.Format("__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE={0}&__EVENTVALIDATION={1}&{2}", viewstate, eventvalidation, request) 
```

eventvalidation 中有一个加号 (+)，它导致字符串的 cat，而不是显示文字字符。有什么想法可以防止这种情况发生吗？

这是我执行请求的代码：

```
WebRequest req = WebRequest.Create(url);
//Here Request is working properly; the EVENTVALIDATION token has the + sign in it.
byte[] send = Encoding.Default.GetBytes(request);
// I think after I convert it to byte[], it is doing something bad to the EVENTVALIDATION token.
req.Method = "POST";
req.ContentType = "application/x-www-form-urlencoded";
req.ContentLength = send.Length;

Stream sout = req.GetRequestStream();
sout.Write(send, 0, send.Length);
sout.Flush();
sout.Close();

WebResponse res = req.GetResponse();
StreamReader sr = new StreamReader(res.GetResponseStream());
string returnvalue = sr.ReadToEnd();

return returnvalue; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:13:51.163

我使用了 Uri.EscapeDataString 并且成功了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:51:43.973

采用`String.Concat()`

```
String.Concat("__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=", 
           viewstate,"&__EVENTVALIDATION=", eventvalidation,"&", request); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:01:15.783

尝试使用 an`HTMLEncode`去掉 +。你把它放在一个 HiddenField 中吗？

```
String.Format("__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE={0}&__EVENTVALIDATION={1}&{2}", Server.HtmlEncode(viewstate), Server.HtmlEncode(eventvalidation), Server.HtmlEncode(request))) 
```

[http://msdn.microsoft.com/en-us/library/w3te6wfz.aspx](http://msdn.microsoft.com/en-us/library/w3te6wfz.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T17:08:11.353

`HttpUtility.UrlEncode`将为您指定的内容类型正确编码值。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/questions/3208555/does-httputility-urlencode-match-the-spec-for-x-www-form-urlencoded)。

# linux - TeamCity 和 Mercurial 在 Linux 上通过 SSH

> ID：13072352
> 
> 赞同：0
> 
> 时间：2012-10-25T15:46:30.107
> 
> 标签：linux, ubuntu, mercurial, ssh, teamcity

我正在努力让我们的 Ubuntu TeamCity 服务器通过 SSH 签出 repos。基本上我的问题是，我将在哪里指定私钥密码？

在托管 teamcity 的机器上运行 shell 并以运行 teamcity 的用户身份登录时，我可以运行`hg clone ssh://hg@localhost/test`以克隆存储库“test”。但我必须输入用户的私钥密码。

我的 TeamCity 项目设置为：

*   从以下位置提取更改： hg clone ssh://hg@localhost/test
*   密码：（私钥密码）

单击“测试连接”会导致

```
Test connection failed in Test :: Test 42\. '/usr/bin/hg identify ssh://hg@localhost/test' command failed.
stdout: remote: Permission denied, please try again.
remote: Permission denied, please try again.
remote: Permission denied (publickey,password).

stderr: abort: no suitable response from remote hg! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:48:48.200

如果密钥对仅用于*TeamCity*服务器与*Mercurial存储库的交互，这是最简单且仍然安全的解决方案，前提是您使用限制性足够的访问权限保护私钥文件（即对于**TeamCity*服务器运行的用户是只读的） )，是从私钥中删除密码。具有空密码短语的私钥将不再​​提示输入密码短语，因此不需要用户交互，从而实现自动化解决方案。

# mysql - 带有多个分隔符的 sql-maven-plugin

> ID：13072354
> 
> 赞同：4
> 
> 时间：2012-10-25T15:46:35.417
> 
> 标签：mysql, maven, sql-maven-plugin

我正在使用 sql-maven-plugin 在多个数据库上执行一些 MySQL 脚本。我想在同一个 SQL 脚本中部署表、数据、触发器、事件和存储过程。

我对行分隔符有疑问，因为对于 INSERT 或 CREATE 我使用`;`，但对于我的触发器，我必须使用 更改分隔符`DELIMITER //`，例如。

我知道该插件允许更改分隔符，但它适用于所有脚本，我只想为唯一脚本的一部分更改分隔符。

这是我的 Maven 配置：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>sql-maven-plugin</artifactId>
    <version>1.5</version>
    <dependencies>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.21</version>
        </dependency>
    </dependencies>
    <configuration>
        <driver>com.mysql.jdbc.Driver</driver>
        <username>${db.user}</username>
        <password>${db.passwd}</password>
        <encoding>UTF-8</encoding>
        <orderFile>ascending</orderFile>
        <keepFormat>true</keepFormat>
        <driverProperties>characterEncoding=utf8,
                          connectionCollation=utf8_general_ci,
                          sql_mode=STRICT_TRANS_TABLES</driverProperties>
    </configuration>
    <executions>
        <execution>
            <id>execution-mysql</id>
            <phase>prepare-package</phase>
            <goals>
                <goal>execute</goal>
            </goals>
            <configuration>
                <url>jdbc:mysql://${db.url}:${db.port}</url
                <delimiterType>normal</delimiterType>
                <fileset>
                    <basedir>${project.build.directory}/sql/</basedir>
                    <includes>
                        <include>${file.sql}</include>
                    </includes>
                </fileset>
            </configuration>
        </execution>
     </executions>
</plugin> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T07:44:18.783

您可以在配置块中将 demeterType 设置为“行”。

```
<configuration>
...
   <delimiterType>row</delimiterType>
...
</configuration> 
```

* * *

## 分隔符类型

> 正常意味着任何分隔符的出现都会终止 SQL 命令，而**对于行，只有仅包含分隔符的行被识别为命令的结尾。**

[在http://mojo.codehaus.org/sql-maven-plugin/execute-mojo.html#delimiterType](http://mojo.codehaus.org/sql-maven-plugin/execute-mojo.html#delimiterType)中查看更多信息

* * *

例如：create-proc.sql

```
CREATE PROCEDURE ADD_BOOK (IN title VARCHAR(100))
BEGIN
   -- your sql code 
   INSERT INTO Book (title) VALUES (title);
END
; -- this means the end of the sql command 
```

# c++ - C++11：具有对数求值深度的编译时数组

> ID：13072359
> 
> 赞同：17
> 
> 时间：2012-10-25T15:46:58.850
> 
> 标签：c++, c++11

实现 C++11 数组的一种方法是使用模板、部分特化和constexpr 如下：

```
#include <iostream>
#include <array>
using namespace std;

constexpr int N = 1000000;
constexpr int f(int x) { return x*2; }

typedef array<int, N> A;

template<int... i> constexpr A fs() { return A{{ f(i)... }}; }

template<int...> struct S;

template<int... i> struct S<0,i...>
{ static constexpr A gs() { return fs<0,i...>(); } };

template<int i, int... j> struct S<i,j...>
{ static constexpr A gs() { return S<i-1,i,j...>::gs(); } };

constexpr auto X = S<N-1>::gs();

int main()
{
        cout << X[3] << endl;
} 
```

这不适用于较大的 N 值：

```
error: constexpr evaluation depth exceeds maximum of 512 
```

这是因为递归模板评估的头尾风格，它在 N 方面具有线性深度。

有没有办法做到这一点，使评估深度就 N 而言是对数的，而不是线性的？（因此会避免默认的深度限制）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-25T16:27:36.080

如果您在代码中使用的是一种奇怪形式的索引技巧，那么这里有一个具有`O(log N)`实例化的实现：

```
// using aliases for cleaner syntax
template<class T> using Invoke = typename T::type;

template<unsigned...> struct seq{ using type = seq; };

template<class S1, class S2> struct concat;

template<unsigned... I1, unsigned... I2>
struct concat<seq<I1...>, seq<I2...>>
  : seq<I1..., (sizeof...(I1)+I2)...>{};

template<class S1, class S2>
using Concat = Invoke<concat<S1, S2>>;

template<unsigned N> struct gen_seq;
template<unsigned N> using GenSeq = Invoke<gen_seq<N>>;

template<unsigned N>
struct gen_seq : Concat<GenSeq<N/2>, GenSeq<N - N/2>>{};

template<> struct gen_seq<0> : seq<>{};
template<> struct gen_seq<1> : seq<0>{};

// example

template<unsigned... Is>
void f(seq<Is...>);

int main(){
  f(gen_seq<6>());
} 
```

[活生生的例子。](https://ideone.com/3ttK8D)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-18T08:01:45.370

在具有通用 constexpression 函数的 c++14 中，不需要任何序列，make_sequence

```
static constexpr int f(int i) noexcept { return i * 2; }

template< int N, typename F >
static constexpr std::array<int,N> generate_array( F fo ) noexcept
{
     std::array< int, N > result{}; // init with zero
     int i = 0; 
     for( auto& x : result) x = fo(++i);

     return result;
}

// test
constexpr auto arr = generate_array<10>( f ); 
```

只有一个问题，没有编译器可以编译它:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:21:15.867

导致线性模板实例化深度的唯一尾递归模板是在模板参数列表中构造整数列表`S`。

正如您所建议的，这可以在对数实例化深度中完成：

```
template <int ... Ints> struct seq;

template <int Start, int End> 
struct range
{
  typedef concat_seq<range<Start, Start+(End-Start)/2>::type, range<Start+(End-Start)/2, End>::type>::type type;
};

template<int Singleton>
struct range<Singleton, Singleton+1>
{
  typedef seq<Singleton> type;
};

template <int NoSingleton>
struct range<NoSinleton, NoSingleton>
{
  typedef seq<> type;
}; 
```

在适当的地方添加一堆`typename`s，实现`concat_seq`（简单），从中提取参数列表，`fs`然后`range<0, N>::type`就可以了。

# java - 为什么 Intellij Idea Java IDE 无法识别我本地 maven 项目的更新

> ID：13072360
> 
> 赞同：3
> 
> 时间：2012-10-25T15:46:59.637
> 
> 标签：java, maven, ide, intellij-idea

我创建了一个基于 maven 项目的 Intellij-idea (11.1) 单模块项目，其中一些 maven 依赖项是我创建的其他项目。

所有这些其他项目都已在本地安装，`mvn install`并且一切正常。

但是，当我对其中一个本地项目（例如添加新方法）进行更改时，就会出现问题，尽管正在运行`mvn install` 和重新同步主项目 pom，但我无法让 IntelliJ 了解我添加的新方法。如果我使用 mvn 构建我的主项目，它可以正常工作，它仅在 Intellij 本身内我有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:58:16.957

我可以假设您不在版本中使用 SNAPSHOT，例如

```
 <groupId>com.my.app</groupId>
  <artifactId>my-app</artifactId>
  <version>1.0-SNAPSHOT</version> 
```

如果你只使用

```
version>1.0</version> 
```

这意味着 1.0 版本是稳定的，任何依赖它的项目都只会下载一次（第一次）。

```
SNAPSHOT - shows that current project is under development so your maven will download it each time you run install 
```

您可以在[Maven 文档中找到更多信息](http://maven.apache.org/guides/getting-started/index.html)

# python - py2app：运行生成的应用程序时出现语法错误

> ID：13072362
> 
> 赞同：0
> 
> 时间：2012-10-25T15:47:01.730
> 
> 标签：python, macos, osx-snow-leopard, py2app

我有一个从 Python 启动时运行正常的应用程序。我想使用 pyapp 在 MAC OS 10.6.8 上打包它。

该应用程序是一个使用瓶子微框架运行的小型嵌入式 Web 应用程序。已经用py2exe在windows上成功打包。

我有以下 py2app 脚本

setup.py py2app 似乎没问题。我有一个生成的应用程序文件，我可以看到它包含正确的代码。您好，我有一个从 Python 启动时运行正常的应用程序。我想使用 pyapp 在 MAC OS 10.6.8 上打包它。

该应用程序是一个使用瓶子微框架运行的小型嵌入式 Web 应用程序。已经用py2exe在windows上成功打包。

我有以下 py2app 脚本

setup.py py2app 似乎没问题。我有一个生成的应用程序文件，我可以看到它包含正确的代码。

```
from setuptools import setup
import sys, os, os.path
wapp_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

sys.path.append(wapp_path)

DATA_FILES = []

setup(
    app = [
        'nsav_ws.py',
    ],
    options={
        "py2app":{
            'argv_emulation': True, 
            "includes":["shelve", "dbhash", "sqlite3", "waitress", "runpy_imports", "bottle_sqlalchemy"],
            "packages": ["sqlalchemy.dialects.sqlite", "sqlalchemy", "nsav_wapp"],
        }
    },
   setup_requires=['py2app']
) 
```

不幸的是，该应用程序在启动时失败。这是回溯：

```
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]  argvemulator warning: fetching events failed
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]  Traceback (most recent call last):
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]    File "/Users/luc/Dev/nelly_signe_avec_vous/nsav/nsav_mac/dist/nsav_ws.app/Contents/Resources/__boot__.py", line 340, in <module>
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]      _run()
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]    File "/Users/luc/Dev/nelly_signe_avec_vous/nsav/nsav_mac/dist/nsav_ws.app/Contents/Resources/__boot__.py", line 311, in _run
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]      exec(compile(source, path, 'exec'), globals(), globals())
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]    File "/Users/luc/Dev/nelly_signe_avec_vous/nsav/nsav_mac/dist/nsav_ws.app/Contents/Resources/nsav_ws.py", line 2
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]      
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]      ^
25/10/12 16:55:53   [0x0-0x118118].org.pythonmac.unspecified.nsav_ws[5126]  SyntaxError: invalid syntax
25/10/12 16:55:53   nsav_ws[5126]   nsav_ws Error 
```

我在 py2app 项目页面上输入了一个[问题](https://bitbucket.org/ronaldoussoren/py2app/issue/70/generated-app-fails-due-to-syntax-error)，但如果你们中的一些人有任何可能有助于解决它的想法，我将不胜感激。

这是程序的开始：

```
# -*- coding: utf-8 -*-

"""
    3 text 
    lines
"""

from dewapp.utils import is_exe
import sys, os, os.path, shutil 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T23:09:58.047

该问题是由以 python 代码结尾的 windows 行引起的。将其转换为 unix 行尾解决了该问题。见[https://bitbucket.org/ronaldoussoren/py2app/issue/70/generated-app-fails-due-to-syntax-error](https://bitbucket.org/ronaldoussoren/py2app/issue/70/generated-app-fails-due-to-syntax-error)

# spring - MyBatis 很慢

> ID：13072363
> 
> 赞同：4
> 
> 时间：2012-10-25T15:47:16.627
> 
> 标签：spring, mybatis

我想知道为什么 MyBatis 在我的应用程序中运行**缓慢**。

对于 a `SELECT COUNT(*)`，所用时间为：

1.  20 秒 - 第一个请求
2.  2-3 秒 - 后续请求

缓存很可能使后续请求更快。

# 配置

*   **3 层**（WPF UI - Java 后端 - Oracle 数据库）
*   **JBoss** Server 将 Java Backed 作为 WPF UI 的 Web 服务公开
*   **请求时间**== WPF UI 发送和接收结果之间的时间
*   **正在使用的**Spring 框架****

 **# 尝试的方法

1.  **禁用日志记录**

    我不知道同时禁用日志子系统和 log4j 是否会有所不同；但是，我得到的最好成绩是 15 秒`SELECT COUNT(*)`。

2.  **禁用缓存和延迟加载**

    这也可能最多产生 5 秒的差异。

## 以下有帮助吗？

1.  使用显式**结果映射**，通过关闭自动映射。（请参阅[此处](http://www.mybatis.org/core/sqlmap-xml.html)的结果图）。
2.  使用**池化**。（请参阅[此处](http://www.mybatis.org/core/configuration.html)的环境）。
3.  **事务**是否有助于加快带有**子查询**的 SQL 语句？

此处列出了上述技术：

1.  [MyBatis 论坛](http://mybatis-user.963551.n3.nabble.com/myBatis-is-slow-td2236249.html)
2.  [JBoss 最佳实践](http://www.jboss.com/pdf/JB_JEAP4_3_PerformanceTuning_wp.pdf)（第 9 页）

### 另一个例子

对于具有 2 个连接和 1 个子查询的嵌套 SQL 语句，所用时间为：

1.  60-90 秒 - 第一次请求
2.  2-3 秒 - 后续请求

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T15:55:48.027

我解决了问题！*MyBatis*现在查询与直接针对数据库运行所需的时间相同。

这是**N+1 选择问题**（这里很好地描述[了](http://www.mybatis.org/mybatis-3/sqlmap-xml.html#Result_Maps)）。

# 解决方案

**嵌套结果**（与**嵌套选择**相反），这也在上面提到的同一页面上进行了描述。

它对我的带有 4 个连接的 SQL 查询的影响是巨大的：

*   **之前：** 38 秒
*   **之后：** 3 秒

*我通过将其隔离到MyBatis-Spring周围的***JUnit**测试用例来跟踪问题（删除了*JBoss*部分）。**

# sql - SQL 查询建议

> ID：13072365
> 
> 赞同：0
> 
> 时间：2012-10-25T15:47:20.387
> 
> 标签：sql, sql-server

我一直无法想出一个正确的查询来处理 SQL Server 中的这种情况。

有两个表，Warehouse 和 Transfer：

仓库

*   wh_id(PK)
*   wh_name

转移

*   transfer_id(PK)
*   transfer_from(FK)
*   transfer_to (FK)

我需要一个查询来返回：

*   transfer_id
*   transfer_from - 名称，而不是 id
*   transfer_to - 名称，而不是 id

到目前为止我已经尝试过：

```
SELECT T.transfer_id, WH.wh_name, T.transfer_to
FROM transfer AS T INNER JOIN warehouse AS WH
ON T.transfer_from = WH.wh_id 
```

这只给出了 transfer_from 的名称，而不是 transfer_to 的名称。我需要类似的查询，但我的 SQL 专业知识水平很低，我只是不知道如何解决这个问题。非常感谢任何指导。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:49:43.620

您需要加入表格`warehouse`两次，因为您需要从表格中的两列获取等效名称`transfer`。

```
SELECT  a.transfer_ID,
        b.wh_name AS from_name,
        c.wh_name AS to_Name
FROM        transfer a
            INNER JOIN warehouse b
                ON a.transfer_from = b.wh_id
            INNER JOIN warehouse c
                ON a.transfer_to = c.wh_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:50:05.243

```
select tr.transfer_id, wh_from.wh_name, wh_from.wh_name
from transfer tr, warehouse wh_from, warehouse wh_to
where tr.transfer_From = wh_From.wh_id
and tr.transfer_to = wh_to.wh_id 
```

# vb.net - 即使调试显示它在范围内，索引也超出范围？

> ID：13072373
> 
> 赞同：1
> 
> 时间：2012-10-25T15:47:45.010
> 
> 标签：vb.net

下面的图片可能会更好地解释它。我在树视图中有一个父节点列表，我检查每个节点以确保它们具有子节点。如果他们这样做，那么我会在 for 循环中遍历每个子节点，但即使 i = 0 它告诉我它超出了范围，即使你可以看到它们存在。

![在此处输入图像描述](../Images/2e03292ab65b1b37f62ea0ef56d58250.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:49:54.757

它们实际上是不存在的。
注意正上方`childCount: 0`。

您在私有数组中看到的是预先分配的空间来容纳任何未来的孩子。

# php - 使用 PHP 处理 XSL 文件

> ID：13072376
> 
> 赞同：1
> 
> 时间：2012-10-25T15:47:58.890
> 
> 标签：php, xml, xslt, joomla, syndication-feed

我的问题是

有人可以指出我需要搜索的正确方向，以便使用 Joomla/PHP 处理一个 XSL 文件吗？

我自己在 Google 上进行了很多搜索，所有结果都与拥有一个 XML 文件和一个 XSL 文件并从那里开始有关。

以上对我来说不是这样。编码的 XSL 文件将 XML 数据从联合提要中提取到 XSL 文件中。我需要能够处理此文件以显示结果吗？

这是有道理的还是我弄错了？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:25:16.627

XSL 是一种用于表达样式表的语言。XSL 样式表与 CSS 一样，是一个描述如何显示给定类型的 XML 文档的文件。XSL 共享功能并与 CSS2 兼容（尽管它使用不同的语法）。

# .net - 实时消息

> ID：13072377
> 
> 赞同：2
> 
> 时间：2012-10-25T15:48:01.967
> 
> 标签：.net, sockets, compact-framework

我公司有100多辆车。每辆车都有 Windows Mobile 设备，通过 3G 连接到互联网。

我的任务是编写一个能够与这些车辆实时通信的应用程序。服务器端和客户端。

这是我必须注意的清单。

*   最小带宽使用。（套接字？TCP还是UDP？？？）
*   移动时连接丢失。消息应成功传递。

是否有适合这些要求的协议或服务器应用程序？

问候

巴罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:52:11.237

只需使用 HTTP，HTTP 标头的开销不会破坏带宽库。

客户端只需轮询服务器以获取最新消息。如果最新消息与客户端记录的最后一条消息的 ID 差异大于 1，则客户端可以直接请求它丢失的特定消息 ID（可能从丢失的客户端连接等中丢失）。一个通用的 HTTP 处理程序 (ashx) 或 Web 服务 (asmx) 确实是您所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:02:54.927

对于这种类型的通信场景，socket通信将是最好的选择。为什么 ？

1）。它使用原始字节发生。

2）。有连接通信和无连接通信的选项

3）。.NET 有丰富的 API 来实现套接字通信。

4）。如果与 Rx 和/或 TPL（异步等待）结合使用，它可以以更好的方式处理。

最小带宽使用：TCP 会在实际消息中添加更多的标头字节，然后是 UDP，因为 TCP 是连接（某种）通信套接字类型，并且还具有内部校验和。UDP 将是节省 3G 带宽的最佳选择。

对于连接性和有保证的消息传递确认：我想说的是，选择哪种方法完全取决于您或您的公司。

TCP的优点：由于是连接通信，一旦失去连接，两端都可以知道断开连接并可以再次连接，并且在消息传递方面更加可靠。

UDP 的优点：它的发送和忘记协议，因此它不能保证任何可靠性或内置的连接性，但是由于在您的情况下发送的字节成本很高，因此使用 UDP 将是不错的选择，并使用某种消息协议来实现端到端通信 - 使用响应机制请求/确认。因此，可以手动完成连接和消息接收和发送确认。

# spring-data - 如何将 spring 数据排序转换为 querydsl OrderSpecifier？

> ID：13072378
> 
> 赞同：16
> 
> 时间：2012-10-25T15:48:01.190
> 
> 标签：spring-data, querydsl

这基本上与此相反： [How to do a paged QueryDSL query with Spring JPA?](https://stackoverflow.com/questions/11673213/how-to-do-a-paged-querydsl-query-with-spring-jpa)

这是针对我无法使用任何 findAll() 方法的自定义查询。

编辑：

发错链接了。现在更正了。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-27T05:46:58.653

您可以执行以下操作：但请确保修剪 o.getProperty() 以便您只传递属性而不是“别名”。+property

```
if (pageable != null) {
    query.offset(pageable.getOffset());
    query.limit(pageable.getPageSize());
    for (Sort.Order o : pageable.getSort()) {
        PathBuilder<Object> orderByExpression = new PathBuilder<Object>(Object.class, "object");

        query.orderBy(new OrderSpecifier(o.isAscending() ? com.mysema.query.types.Order.ASC
                : com.mysema.query.types.Order.DESC, orderByExpression.get(o.getProperty())));
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-03T14:32:34.460

我不知道它是否仍然相关，但是 spring data jpa 中有一个实现，用于在 data.domain.Sort (Spring JPA) 对象到 OrderSpecifier (QueryDSL) 之间进行转换。

[Spring JPA 中 Querydsl 支持的 GIT 源码](https://github.com/spring-projects/spring-data-jpa/blob/master/src/main/java/org/springframework/data/jpa/repository/support/Querydsl.java)

这是一个非常丑陋的实现，但您仍然可以将它重用于自己的目的，因为该方法是私有的：

```
public JPQLQuery applySorting(Sort sort, JPQLQuery query) 
```

但是如果您使用 Spring data JPA，在您的自定义 Repository 实现中，您只需要执行以下操作：

```
public Page<MyObject> findAll(Predicate predicate, Pageable pageable) {

    QMyObject myObject = QMyObject.myObject;
    JPQLQuery jPQLQuery = from(myObject)
            .join(myObject.user)
            .where(predicate);
    jPQLQuery = getQuerydsl().applyPagination(pageable, jPQLQuery);
    List<MyObject> myObjectList = jPQLQuery.list(myObject);
    long count =  jPQLQuery.count();
    Page<MyObject> myObjectPage = new PageImpl<MyObject>(myObjectList, pageable, count);
    return myObjectPage;  
} 
```

希望它可以帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-11-25T11:39:06.083

`org.springframework.data.domain.Sort.Order`和`com.querydsl.core.types.Order`和 非常相似，但两者之间没有直接的转换。这是[frozenfury](https://stackoverflow.com/a/13097615/432777)答案的一些改进版本：

```
PathBuilder<Entity> entityPath = new PathBuilder<>(Entity.class, "entity");
for (Order order : pageable.getSort()) {
    PathBuilder<Object> path = entityPath.get(order.getProperty());
    query.orderBy(new OrderSpecifier(com.querydsl.core.types.Order.valueOf(order.getDirection().name()), path));
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-11-27T04:57:25.517

```
private OrderSpecifier<?>[] getSortedColumn(Sort sorts){   
    return sorts.toList().stream().map(x ->{
        Order order = x.getDirection().name() == "ASC"? Order.ASC : Order.DESC;
        SimplePath<Object> filedPath = Expressions.path(Object.class, Qobject, x.getProperty());
        return new OrderSpecifier(order, filedPath);
    }).toArray(OrderSpecifier[]::new);
} 
```

那么你可以像这样使用：

```
 .where(...), 
  .orderBy(getSortedColumn(pageable.getSort())) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-02-10T01:45:55.950

或者，如果您想直接将排序应用到您的基本查询中，而不必转换为 OrderSpecifier<?>，您可以利用`org.springframework.data.jpa.repository.support.Querydsl`.

```
JPQLQuery<?> query = new JPAQuery<>(entityManager);
//prepare your base query
query.select(<YourQEntity>).from(<YourQEntity>).where(<whereClause>);

Querydsl querydsl = new Querydsl(entityManager, (new PathBuilderFactory()).create(<YourEntityClass>.class));

//apply org.springframework.data.domain.Sort
querydsl.applySorting(pageable.getSort(), query); 
```

# c++ - 将 sizeof 和 Placement new 结合起来是否安全？

> ID：13072379
> 
> 赞同：2
> 
> 时间：2012-10-25T15:48:05.333
> 
> 标签：c++, templates, c++11, placement-new

考虑以下类：

```
template <class T>
class defer {
public:
    template <class ...Args>
    void construct(Args&&...);
    T& obj();
    ~defer();
private:
    std::uint8_t memory[sizeof(T)];
    T * ptr();
};

template <class T>
template <class ...Args>
void defer<T>::construct(Args&& ...args) {
    new(static_cast<void*>(&memory[0])) T(std::forward<Args>(args)...);
}

template <class T>
T& defer<T>::obj() {
    return *(ptr());
}

template <class T>
defer<T>::~defer() {
    ptr()->~T();
}

template <class T>
T * defer<T>::ptr() {
    return static_cast<T*>(&memory[0]);
} 
```

现在我知道这有问题，但是为了使代码简短以便讨论，我们将假设 defer::construct() 总是在对象超出范围之前调用。

话虽如此，这样做是否总是安全的？或者在具有其他疯狂的多重虚拟继承的一些奇怪的极端情况下，std::uint8_t[sizeof(T)] 可以不分配足够的空间吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T15:52:24.707

R. Martinho Fernandes 打败了我！采用

```
typename std::aligned_storage<sizeof(T)>::type  memory; 
```

你可以走了。有关详细信息，请参见[此处](http://en.cppreference.com/w/cpp/types/aligned_storage)。

* * *

正如我们的评论员小组所指出的那样，默认对齐总是足够的，但可能比您的类型要求的*更*严格（因此您会浪费额外的填充空间）。您可以通过明确指定它来避免这种情况：

```
typename std::aligned_storage<sizeof(T), alignof(T)>::type memory; 
```

# c# - selenium webdriver ijavascriptexecuter executescript 参数类型

> ID：13072382
> 
> 赞同：2
> 
> 时间：2012-10-25T15:48:21.743
> 
> 标签：c#, selenium-webdriver

我正在查看[http://selenium.googlecode.com/svn/trunk/docs/api/dotnet/index.html](http://selenium.googlecode.com/svn/trunk/docs/api/dotnet/index.html)上的 .NET 的 selenium-webdriver API 。对于 IJavaScriptExecutor.ExecuteScript 上的参数，它声明“对于数字，返回 Int64”。如果我想用这种方法传递一个小数（输入/输出），我需要做什么？例如，Java 绑定当前支持十进制和非十进制类型。

任何帮助表示赞赏。

谢谢， 瓦巴夫

由于我无法回答自己的问题，因此我正在编辑问题。我运行以下代码来测试可以传递给 ExecuteScript 方法的参数类型。

```
try
{
    IWebDriver driver = new InternetExplorerDriver();
        string script = "return arguments[0];";
    double d = 15.009;
    float f = 13.2f;
    decimal dec = 0.2m;
    int i = 8;
    object value = ((IJavaScriptExecutor)driver).ExecuteScript(script, new object[] { dec });
    driver.Close();
    driver.Quit();
}
catch(Exception ex)
{} 
```

上面的代码抛出异常'Argument is of an invalid type 0.2 Parameter name: arg'。但是可以传递其他值（double/float/int），返回值与传递的相同。替身现在应该符合我的目的。我担心 webdriver 在通过该方法时会将我的双精度转换为 Int64。我认为文档需要修改。

谢谢， 瓦巴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T18:28:23.853

所以解决方案是使用`float`而不是`decimal`.

然后将`float`参数转换为并转换为`object`返回。`object``float`

# python - 在 while 循环中出现语法错误

> ID：13072384
> 
> 赞同：3
> 
> 时间：2012-10-25T15:48:23.933
> 
> 标签：python, loops, syntax, while-loop

我在 while 循环中不断收到语法错误，我不明白为什么。

```
def main():
    n=1
    i=1
    flag=True
    num1=eval(input("Enter number")
    while i<9:
        n=n+1
        num2=eval(input("Enter number", n))
        r=r+1
        if num2<num1:
            flag=False
        num1=num2
    if flag==True:
        print("yes")
    else:
        print("no")
main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:53:28.510

您的语法错误是因为 while 循环上方的表达式缺少闭合括号：

```
 num1=eval(input("Enter number") 
```

我还建议将您的代码交给[Code Review SE](https://codereview.stackexchange.com/)，以获取有关您代码的其他问题的建设性反馈。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T16:09:18.930

```
def main():
n=1
i=1
flag=True
num1=eval(input("Enter number"))
while i<9:
    n=n+1
    num2=eval(input("Enter number", n))
    i+=1
    if num2<num1:
        flag=False
    num1=num2
if flag==True:
    print("yes")
else:
    print("no")
main() 
```

您在 num1=eval(input("Enter number")) 处打开了一个参数

我还将 r = r + 1 更改为 r+=1，它们做同样的事情，但读起来更好一些。

您还可以通过将其更改为来确保该数字是整数：

num1=int(input("请输入数字："))

另外，我认为 n+=1 需要 i+=1 才能结束无限循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:18:34.917

把你的无限循环的车。最终代码可能是（包括其他同行的好答案）：

```
def main():
    n=1
    flag=True
    num1=eval(input("Enter number"))
    while n<9:
        n+=1
        num2=eval(input("Enter number", n))
        if num2<num1:
            flag=False
        num1=num2

    if flag:
        print("yes")
    else:
        print("no")
main() 
```

简单地循环变量 n： i 和 r 在这里没用。

# objective-c - 如何在 NSDictionary 中存储布尔值和零值？

> ID：13072388
> 
> 赞同：1
> 
> 时间：2012-10-25T15:48:50.690
> 
> 标签：objective-c

与 Javascript-Object 类似，我需要将布尔值和 nil 值存储在 Objective-C NSDictionary 中。（当我尝试编写通用 JSON 解析器时确实出现了这个问题）（是的，我知道那里有一些很好的即用型解析器，但我想尝试编写自己的。）

这是我想做的一个例子：

```
NSString* str = @"a string";
NSNumber* num = @123.456;
NSArray*  arr = @[@"abc",@99];
boolean   boo = true;
id        obj = nil;

NSDictionary* dict = @{
    @"key1" : str,
    @"key2" : num,
    @"key3" : arr,
    @"key4" : boo,   //will not work since boo is not an object
    @"key5" : obj    //will not work since obj is nil
};

//later in the same piece of code:

dict = @{
    @"key1" : str,
    @"key2" : num,
    @"key3" : arr,
    @"key4" : @1,  //Here we have the NSNumber 1 assigned to key4
                   //(which is not the boolean value true)
    @"key5" : @""  //an empty NSString-Object (which is not nil)
}; 
```

**boolean**
一个解决方案可能是，我这样做：

```
 ...
    @"key4" : [NSNumber numberWithBool:boo];
    ... 
```

但如果 boo 为真，结果将与

```
 ...
    @"key4" : @1;
    ... 
```

如果它是假的，那将是相同的

```
 ...
    @"key4" : @0;
    ... 
```

但我需要知道原始值是布尔值还是数字。

**nil vs. placeholder-object**
我可以使用空字符串 (@"")、某个数字 (-1) 或其他内容之类的占位符，而不是将 nil 作为值分配给字典。但后来，我没有机会知道，我是否确实存储了占位符，因为我想存储 nil，或者我是否确实存储了一个偶然与我的占位符相同的有效值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T16:13:16.353

要添加布尔值，请使用 [NSNumber numberWithBool:YES/NO]，对于 nil 值，请使用 [NSNull null]。您不应该关心最初的值是什么（布尔值或数字），使用 JSON 解析器的人应该知道会发生什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:24:05.383

如果你不能使用 NSNumber 来封装 BOOL，也不能使用 NSNull，你的下一个选择是创建你自己的包装类：

```
@interface MyBoolean : NSObject
@property (nonatomic, assign) BOOL boolVal;
@end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:10:45.577

你的问题听起来有点混乱。这个参数，你想在哪里设置这个布尔值，代表什么？为什么你需要知道它是数字还是布尔值？

如果您有这种情况，制作自己的模型总是好的。

# magento - 交叉销售一组产品中的所有简单产品。可能的？

> ID：13072389
> 
> 赞同：0
> 
> 时间：2012-10-25T15:49:00.143
> 
> 标签：magento, magento-1.7

我有一个产品的多个版本，我将它们组合成一个分组产品。当我交叉销售它们时，我希望所有简单产品都是可点击的（而不是默认情况下，Magento 选择其中一种简单产品）。基本上是这样的：

![我希望交叉销售如何出现在购物车页面上](../Images/c492b3d286e6a983601aa0ac3f3ce6cb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T15:03:56.590

复制到本地商店模板 /app/design/frontend/base/default/template/checkout/cart/crosssell.phtml

```
<?php if($this->getItemCount()): ?>
    <div class="crosssell">
      .........

      <?php foreach ($this->getItems() as $_item): ?>
        <?php if ($_item->getTypeId() == 'grouped')
        {
            $associatedProducts = $_item->getTypeInstance(true)->getAssociatedProducts($_item);

             <?php foreach ($associatedProducts as $ap): ?>
                   //display associated group products here
                   <li class="item">
                          ......
                        copy existing html structure and replace $_item with $ap
                        <?php echo $this->htmlEscape($ap->getName()) ?>
                    </li>
                <?php ?>
          <?php }
               else
               { ?>
                 <li class="item">
                     ......
                     // copy existing code here
                 </li>
          <?php } ?>

       <?php endforeach; ?>

         ................. 
```

请参阅[Magento - 我如何获得产品组的相关产品？](https://stackoverflow.com/questions/8579765/magento-how-do-i-get-associated-products-of-product-group)

# iphone - 强制转换后的 Objective-C 类类型不匹配

> ID：13072392
> 
> 赞同：0
> 
> 时间：2012-10-25T15:49:03.323
> 
> 标签：iphone, objective-c, ios, json

在使用 解析来自 web 服务的 JSON 响应后`NSJSONSerialization`，我使用`+isKindOfClass:`来确保服务器返回我期望的数据类型。使用这种方法，我遇到了一些奇怪的行为，我将用一个例子来说明。

考虑以下对象：

```
// Definitions
NSDictionary *son = @{ @"firstname" : @"James", @"lastname" : @"Appleseed" };
NSDictionary *daughter = @{ @"firstname" : @"Susan", @"lastname" : @"Appleseed"};
NSArray *children = @[son, daughter];
NSDictionary *father = @{ @"firstname" : @"John", @"lastname" : @"Appleseed" };
NSDictionary *family = @{@"children" : children, @"father" : father};
NSDictionary *pedigree = @{@"family" : family }; 
```

这些对象代表从服务器返回的反序列化 JSON。现在，如果我想使用孩子的数组来计算使用 NSArray 的孩子有多少`-count`，我需要确保孩子对象是一个 NSArray。例如，如果子对象恰好是一个字符串，而应用程序需要一个数组，它会崩溃，因为字符串没有实现`count`方法。考虑以下实现所述检查的代码序列：

```
// First test
id _family = [pedigree objectForKey:@"family"];
if ([_family isKindOfClass:[NSDictionary class]])
{
    NSDictionary *_family = (NSDictionary *)_family;
    id _children = [_family objectForKey:@"children"];

    NSLog(@"Children: %@", _children);
    NSLog(@"Children classname: %@", NSStringFromClass(children.class));

    if ([_children isKindOfClass:[NSArray class]]) {
        NSLog(@"Children is an NSArray");
    } else {
        NSLog(@"Children is not an NSArray");
    }
} else {
    NSLog(@"Family is not an NSDictionary");
} 
```

运行此代码后，控制台输出以下内容：

```
Children: (null)
Children classname: __NSArrayI
Children is not an NSArray 
```

控制台输出看起来非常显着，甚至自相矛盾。当其类名是 __NSArrayI 时，children 怎么可能*不是NSArray？*

经过一番调试，我发现有两种方法可以解决这个问题：

1.  删除此行`NSDictionary *_family = (NSDictionary *)_family;`
2.  `_family`使用与转换变量不同的名称

如何解释这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:00:14.030

在行

```
NSDictionary *_family = (NSDictionary *)_family; 
```

您在当前范围内定义了一个新变量`_family`，这使得外部变量`_family`不可见。`nil`如果您使用 ARC 编译，Objective-C 指针将被初始化。

而且输出并不矛盾，因为你打印

```
NSStringFromClass(children.class); 
```

这是`children`（不带下划线）的类，它是一个数组。但是`_children`（带下划线）是`nil`因为`_family`is nil 如上所述。

实际上，如果您需要字典，则不需要类型转换。你可以做

```
NSDictionary *_family = [pedigree objectForKey:@"family"];
if ([_family isKindOfClass:[NSDictionary class]])
{
    NSArray *_children = [_family objectForKey:@"children"];

    if ([_children isKindOfClass:[NSArray class]]) {
        NSLog(@"Children is an NSArray");
    } else {
        NSLog(@"Children is not an NSArray");
    }
} else {
    NSLog(@"Family is not an NSDictionary");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:15:31.323

您的变量`children`包含一个数组，您的变量`_children`是`nil`.

这解释了`NSLog`打印的第一个`(null)`（因为您 log `_children`，而不是`children`），但是`NSLog`打印的第二个`__NSArrayI`（因为您打印了`children`对象的类，而不是 nil`_children`变量的类。

你的第三个`NSLog`说它不是一个数组，因为你检查`[_children isKindOfClass:...]`并且`_children`是`nil`，所以`[nil isKindOfClass:...]`返回`NO`。

* * *

所以要解决你的问题，你必须弄清楚为什么你的`_children`变量是`nil`（而你的`children`变量不是）。

这显然是因为您使用了一个`_family`隐藏其父级的变量。因此，该行`NSDictionary *_family = (NSDictionary *)_family;`显然使用了内部`_family`变量，并且具有与您编写的完全相同的行为`NSDictionary *foo = (NSDictionary *)foo;`：就像这样，将其转换`foo`为`nil`您想要的任何内容仍然会成功`nil`。

为您的内部`_family`变量使用不同的名称以避免第二个`_family`变量隐藏外部`_family`变量，您的问题就会消失。`id`或者更好的是，完全删除这一行，因为在不强制转换的情况下调用方法没有问题（`id`实际上就是这样）

# php - Mysqli UPDATE查询日期类型通过代码失败，通过命令行成功

> ID：13072399
> 
> 赞同：0
> 
> 时间：2012-10-25T15:49:42.183
> 
> 标签：php, mysqli, sql-update

此查询返回 0 个受影响的行。

```
mysqli_query($conn, "UPDATE dates SET date = '$date' WHERE url = '". mysqli_real_escape_string($conn, $url) ."'") 
```

如果我打印出 sql 查询，它看起来像这样——

```
UPDATE dates SET date = '2012-10-25' WHERE url = 'http://foo.com' 
```

如果我在命令行上手动执行此操作，它就可以正常工作。

为什么我的 mysqli_query() 会失败？

**编辑：**

如果我显示警告，我会得到 -

```
Warning (1265): Data truncated for column 'date' at row 1 
```

我的日期似乎格式正确。为什么它们会被截断，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:51:48.940

尝试

```
 printf("Affected rows : %d\n", mysqli_affected_rows($conn)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:52:02.573

我认为没有必要将该连接资源传递给 mysqli_query 和 mysqli_real escape_string，只需将其传递到您的选择 mysqli_select_db 中，如 mysqli_select_db('database',$conn)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T00:02:08.370

然后，您必须检查在该查询中传递的每个变量的值：`$date`，`$conn`或者`$url`确保它们中的每一个都返回任何值。但是根据您的错误行，我认为这将是您的`$date`，可能没有返回该变量的值或日期格式错误。这就是查询返回该错误的原因。

尝试回显`$date`.

# iphone - AdMob 广告未显示在 UIView iPhone 中

> ID：13072408
> 
> 赞同：1
> 
> 时间：2012-10-25T15:49:56.050
> 
> 标签：iphone, ios, admob

我想在我的应用中加入 AdMob 横幅！我让它在 UIViewcontrollers 中工作，但不是在我的 UIView 中......横幅出现了，但是当你点击它时，什么也没有发生！如果您单击 UIViewcontrollers 中的横幅，它会起作用！

UIViewcontrollers 中的代码（有效！）

```
 - (void)viewDidLoad
 {

[super viewDidLoad];
bannerView_ = [[GADBannerView alloc] initWithFrame:CGRectMake(0.0, self.view.frame.size.height - GAD_SIZE_320x50.height-49, GAD_SIZE_320x50.width, GAD_SIZE_320x50.height)];

bannerView_.adUnitID = MY_BANNER_UNIT_ID;
bannerView_.rootViewController = self;
[self.view addSubview:bannerView_];

GADRequest *r = [[GADRequest alloc] init];
r.testing = YES;
[bannerView_ loadRequest:r];
// Do any additional setup after loading the view, typically from a nib. 
```

}

UiView 中的代码：（不起作用）

```
 - (void)drawRect:(CGRect)rect
  {

  // Create a view of the standard size at the bottom of the screen.
  bannerView_ = [[GADBannerView alloc] initWithFrame:CGRectMake(0.0, self.frame.size.height - GAD_SIZE_320x50.height, GAD_SIZE_320x50.width, GAD_SIZE_320x50.height)];
  // Specify the ad's "unit identifier." This is your AdMob Publisher ID.
  bannerView_.adUnitID = MY_BANNER_UNIT_ID;

  // Let the runtime know which UIViewController to restore after taking
  // the user wherever the ad goes and add it to the view hierarchy.
  bannerView_.rootViewController = self;
 [self addSubview:bannerView_];

  // Initiate a generic request to load it with an ad.
  [bannerView_ loadRequest:[GADRequest request]];
  // Drawing code
  } 
```

行bannerView_.rootViewController = self; 给我一个警告，但没有它就不行！警告说“不兼容的指针类型从 'blandad *const_strong' 分配给 'UIViezController *'

UIView 的 .m 和 .h 文件的名称中的 blandad！

你觉得哪里不对？

/一个菜鸟

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:05:51.157

请从方法中删除所有代码`- (void)drawRect:(CGRect)rect`，如果您想在图形上下文中绘制某些内容，则必须覆盖此方法。这个方法不会被调用一次而是调用多次，所以每次你都会分配一个新的视图并将其添加为子视图

如果您想将广告横幅添加到自定义 UIView，只需执行以下操作：

```
// in your CustomView implementation
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

        bannerView_ = [[GADBannerView alloc] initWithFrame:CGRectMake(0.0, self.view.frame.size.height - GAD_SIZE_320x50.height-49, GAD_SIZE_320x50.width, GAD_SIZE_320x50.height)];

        bannerView_.adUnitID = MY_BANNER_UNIT_ID;

        UIViewController* root = [(YOUR_APP_DELEGATE_CLASS*)[[UIApplication sharedApplication] delegate] viewController];
        bannerView_.rootViewController = root;
        [self addSubview:bannerView_];

        GADRequest *r = [[GADRequest alloc] init];
        r.testing = YES;
        [bannerView_ loadRequest:r];

    }
    return self;
} 
```

您可以`UIViewController* root`使用您拥有的任何控制器进行设置，最好在其中设置一个控制器，该控制器的视图是您的自定义视图的父级。我刚刚从应用程序委托中为根视图控制器编写了一个路径，如果您想使用它，请确保您的应用程序委托具有此`viewController`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T10:02:05.120

请参考下面的链接，它的一个例子：

[http://www.edumobile.org/iphone/iphone-programming-tutorials/how-to-admob-integrate-in-your-application-in-iphone/](http://www.edumobile.org/iphone/iphone-programming-tutorials/how-to-admob-integrate-in-your-application-in-iphone/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-13T19:59:45.943

我认为最好的方法是管理单个横幅广告并将其添加到您需要广告的所有视图中。

试试我写的这门课 - [https://github.com/jackwu95/JWGADManager](https://github.com/jackwu95/JWGADManager)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-15T09:00:00.333

我不知道你是否解决了你的问题，但从我的角度来看，我得到了同样的问题。

将 GAD 横幅视图添加到从 UIView 继承的正确视图中，然后横幅显示良好，但 Admob 链接未激活。

在我的例子中，GAD 横幅视图被添加到 GADBannerView 的 adViewDidReceiveAd 委托中。显然这不是好方法。

通过在初始化后直接添加 GAD 横幅视图，现在一切正常。

```
- (void)initGADBannerViewWithId:(NSString *)bannerId andRootController:(UIViewController *)rootController
{
    _gadBannerView = [[GADBannerView alloc] initWithFrame:self.frame];

    _gadBannerView.adUnitID = bannerId;

    // Let the runtime know which UIViewController to restore after taking
    // the user wherever the ad goes and add it to the view hierarchy.
    _gadBannerView.rootViewController = rootController;
    _gadBannerView.delegate = self;
    [self addSubview:_gadBannerView];
} 
```

而在 GADBannerView 的 adViewDidReceiveAd 委托中，现在我只是有一个动画来修改横幅位置以产生动态的视觉效果。

希望这可以帮助某人

# google-maps - 将 google.maps.Map 转换为静态地图链接

> ID：13072409
> 
> 赞同：5
> 
> 时间：2012-10-25T15:49:59.987
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

是否可以将当前查看的 google.maps.Map 转换为静态图像链接，以便我可以获取图像并将其嵌入到 PDF 中？

我在地图上添加了一些带有自定义图标的标记，所以我不确定它是否真的可行。如果没有，是否有任何解决方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:58:32.220

这不被允许。看这里：

[https://developers.google.com/maps/faq#tos_screenshots](https://developers.google.com/maps/faq#tos_screenshots)

> **在印刷材料和离线媒体**中使用 Google 地图图像须遵守发布于以下网址的许可指南：
> 
> [http://www.google.com/permissions/geoguidelines.html](http://www.google.com/permissions/geoguidelines.html)

您可以请求许可，但我认为获得许可并不容易，除非您是付费商业客户。

# android - Proguard 谷歌分析

> ID：13072411
> 
> 赞同：6
> 
> 时间：2012-10-25T15:50:12.713
> 
> 标签：android, google-analytics, proguard

有谁知道需要添加到 Proguard for Google Analytics 的 keep 语句？

我现在有这条线，但由于某种原因，没有任何报道......

```
 # google analytics, uncomment if using:
-keep class com.google.android.apps.analytics.PipelinedRequester$Callbacks 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-25T16:02:16.283

我有一个通用的

```
-keep public class com.google.** {*;} 
```

在我的 proguard.cfg 和谷歌分析工作正常。

试试这个。如果这不能解决问题，那么您的问题不是 Proguard，而是 Google Analytics 配置或连接问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-07T07:00:26.463

您可以在包中找到官方的 proguard 规则文件`aar`，位于：

> android-sdk-windows\extras\google\m2repository\com\google\android\gms\play-services-analytics\xxx\play-services-analytics-xxxaar

**proguard.txt：**

```
-keep class * extends java.util.ListResourceBundle {
    protected java.lang.Object[][] getContents();
}

# Keep SafeParcelable value, needed for reflection. This is required to support backwards
# compatibility of some classes.
-keep public class com.google.android.gms.common.internal.safeparcel.SafeParcelable {
    public static final *** NULL;
}

# Keep the names of classes/members we need for client functionality.
-keepnames @com.google.android.gms.common.annotation.KeepName class *
-keepclassmembernames class * {
    @com.google.android.gms.common.annotation.KeepName *;
}

# Needed for Parcelable/SafeParcelable Creators to not get stripped
-keepnames class * implements android.os.Parcelable {
    public static final ** CREATOR;
}

# Needed when building against the Marshmallow SDK
-dontwarn org.apache.http.**

# Needed when building against pre-Marshmallow SDK.
-dontwarn android.security.NetworkSecurityPolicy 
```

您可以在此页面中查看**创建 ProGuard 异常部分以获取更多详细信息：** [https ://developers.google.com/android/guides/setup](https://developers.google.com/android/guides/setup)

# php - jQuery PHP 回显动态数据

> ID：13072412
> 
> 赞同：0
> 
> 时间：2012-10-25T15:50:12.053
> 
> 标签：php, jquery, post, input, echo

我有一个 Jquery post 脚本，由于我无法控制的原因，必须使用 PHP 的 echo 将其放置在页面上。现在的问题是我需要将页面上的表单中的信息传递到要发布的数据中。

这是目前的工作脚本：

```
echo '<script type="text/javascript">
$(".discuss_your_report").click( function() {
    $.post(\'/layout/standard/report-action.php\', {
        form: "discuss_your_report", website: "'.$_GET['website'].'", name: "'.$_GET['name'].'", email: "'.$_GET['email'].'", phone: ""},
        function(data){
            $(".message").html(data);
    $(".message").show("slow");
        }
    );
</script>'; 
```

在上面的脚本中，电话号码是空的，这需要用户使用标准表单输入在页面中输入。我尝试了很多没有用的东西，这是最新的：

```
echo '<script type="text/javascript">
$(".discuss_your_report").click( function() {
    var phone = $(\'#phone\').val();
    $.post(\'/layout/standard/report-action.php\', {
        form: "discuss_your_report", website: "'.$_GET['website'].'", name: "'.$_GET['name'].'", email: "'.$_GET['email'].'", phone: "phone"},
        function(data){
            $(".message").html(data);
    $(".message").show("slow");
        }
    );
</script>'; 
```

为了便于阅读，这里没有 PHP 代码：

```
<script type="text/javascript">
$(".discuss_your_report").click( function() {
    var phone = $('#phone').val();
    $.post('/layout/standard/report-action.php', {
        form: "discuss_your_report", website: "www.example.com", name: "my name", email: "info@example.com", phone: "phone"},
    function(data){
    $(".message").html(data);
    $(".message").show("slow");
    }
);
</script> 
```

但这只是传递文本“电话”。有谁知道我怎样才能让它工作，任何反馈表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:54:10.520

试试这个：

```
<script type="text/javascript">
$(".discuss_your_report").click( function() {
    var phone = $('#phone').val();
    $.post('/layout/standard/report-action.php', {
        form: "discuss_your_report", 
        website: "www.example.com", 
        name: "my name", 
        email: "info@example.com", 
        phone: phone},
    function(data){
    $(".message").html(data);
    $(".message").show("slow");
    }
);
</script> 
```

“电话” - 这是文本

电话 - 是可变的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:03:37.317

已将 var phone 更改为 phone_val，已将其分配给 phone: phone_val without quote

```
echo '<script type="text/javascript">
$(".discuss_your_report").click( function() {
    var phone_val = $(\'#phone\').val();
    $.post(\'/layout/standard/report-action.php\', {
        form: "discuss_your_report", website: "'.$_GET['website'].'", name: "'.$_GET['name'].'", email: "'.$_GET['email'].'", phone: phone_val},
        function(data){
            $(".message").html(data);
    $(".message").show("slow");
        }
    );
</script>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:59:20.300

尝试在发布时使用对表单元素的动态引用：

```
echo '<script type="text/javascript">
$(".discuss_your_report").click( function() {
    var phone = $(\'#phone\').val();
    $.post(\'/layout/standard/report-action.php\', {
        form: "discuss_your_report", website: "'.$_GET['website'].'", name: "'.$_GET['name'].'", email: "'.$_GET['email'].'", phone: document.forms.discuss_your_report.phone.value },
        function(data){
            $(".message").html(data);
    $(".message").show("slow");
        }
    );
</script>'; 
```

# c# - IIS 中的匿名身份验证到 Windows 身份验证网站中的 WCF 服务路由

> ID：13072421
> 
> 赞同：1
> 
> 时间：2012-10-25T15:50:46.197
> 
> 标签：c#, wcf, iis, routes, wcf-security

我有一个 ASP.NET 网站，它需要 Windows 身份验证，但托管在应用程序中并需要匿名身份验证的 WCF 服务除外：

（比方说`FooService.svc`：）

```
[ServiceContract]
[AspNetCompatibilityRequirements( RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed )]
[ServiceBehavior( InstanceContextMode = InstanceContextMode.PerCall, IncludeExceptionDetailInFaults = true)]
public partial class FooService
{
    [WebGet( UriTemplate = "foo", ResponseFormat = WebMessageFormat.Json )]
    public string GetFoo()
    {
        return "Foo";
    }
} 
```

我已经在以下位置注册了我的路线`Global.asax`：

```
routes.Add( new ServiceRoute( "MyService", new WebServiceHostFactory(), typeof( FooService ) ) ); 
```

我的问题是使此服务及其所有路由都允许匿名身份验证（作为 Windows Authenticated 站点的其余部分的例外）。

我只能通过创建一个与路由名称（`http://MyHost/MyWebsite/`*MyService*`/`）匹配的文件夹来实现这一点，将其留空，并对 IIS 中的目录启用匿名身份验证。

是否有更好的方法允许对 IIS 中的服务路由进行匿名身份验证，而不涉及创建仅作为 IIS 配置的占位符存在的文件夹？

**附加说明：**我发现在IIS中配置空文件夹允许匿名访问后，我可以删除物理文件夹，并且仍然尊重服务路由的匿名身份验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:09:04.030

您的网站上真的不需要任何空文件夹。您可以在 IIS 中将应用程序添加到您的网站并在此应用程序上设置匿名身份验证。其他方法是使用 windows 身份验证。您的服务需要匿名身份验证的原因是什么？

# php - 在添加数据库条目时触发警报，而不是在删除它们时触发警报

> ID：13072426
> 
> 赞同：0
> 
> 时间：2012-10-25T15:51:05.553
> 
> 标签：php, javascript, jquery

我有一个 jQuery 脚本正在运行，它使用以下代码进行定期 AJAX 调用。

```
var a = moment();
var dayOfMonth = a.format("MMM Do");
var timeSubmitted = a.format("h:mm a");
var count_cases = -1;
var count_claimed = -1;

setInterval(function(){
    //check if new lead was added to the db
    $.ajax({
        type : "POST",
        url : "inc/new_lead_alerts_process.php",
        dataType: 'json',
        cache: false,
        success : function(response){

            $.getJSON("inc/new_lead_alerts_process.php", function(data) {

                if (count_cases != -1 && count_cases != data.count) {
                    window.location = "new_lead_alerts.php?id="+data.id;
                }
            count_cases = data.count;
            });
        }
    }); 
```

这是每次调用都会运行的 PHP：

```
$count = mysql_fetch_array(mysql_query("SELECT count(*) as count FROM leads"));
$client_id = mysql_fetch_array(mysql_query("SELECT id, client_id FROM leads ORDER BY id DESC LIMIT 1"));

echo json_encode(array("count" => $count['count'], "id" => $client_id['id'], "client_id" => $client_id['client_id'])); 
```

我需要更改代码，以便仅在将新条目添加到数据库时触发警报，而不是在删除现有条目时触发。就目前而言，警报会针对这两个事件触发。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T19:44:21.973

关于什么

```
var newest_id = 0;

window.setInterval(function() {
  $.ajax({
    ...
    success : function(data) {
      if (newest_id && data.id > newest_id)
         window.location = ...
      newest_id = data.id;
    }
  })
}, intervalTime); 
```

你不必再打电话`$.getJSON()`了。它是`$.ajax()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T04:57:10.013

解决方案非常简单。我`count_cases != data.count`改为`count_cases < data.count`. 这就是它的全部。

# javascript - 网址发布请求 jquery Django

> ID：13072428
> 
> 赞同：0
> 
> 时间：2012-10-25T15:51:20.873
> 
> 标签：javascript, jquery, django

这可能是一个愚蠢的问题，但我尝试使用 jquery 进行发布请求，但我不知道如何在我的发布请求中设置我的“url”。

我有一个变量“id”：

```
var url = window.location.pathname.split('/');
var id = url[3]; 
```

我希望我的帖子转到 /mysite/xxx/"id"/

这是我的发帖请求：

```
 $.post("/mysite/xxx/'id'", { 
   name: "test"
   }); 
```

我不知道如何在我的网址末尾包含变量“id”。感谢您的帮助。

PS：这个帖子请求转到我尝试实现它的完全相同的 url。我不知道是否有比再次指定整个 url 更简单的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:54:19.463

```
$.post("/mysite/xxx/"+id, { 
   name: "test"
}); 
```

您的问题是“如何连接字符串和变量”。

如果你不得不做一些`"/mysite/xxx/ID/yyy/"`你可以做的事情`"/mysite/xxx/"+id+"/yyy/"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:58:39.973

为什么不这样做呢？

```
$.post(window.location.pathname, {
    name: "test"
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T17:15:08.720

如果您在当前页面上发帖，您可以执行以下任一操作：

```
$.post(window.location.pathname, {
    name: "test"
});

$.post('.', {
    name: "test"
}); 
```

如果您在另一个页面上发布，您可以在您的 url 中使用令牌并将其作为变量传递给您的模块：

```
<script>
    var url = '{% url my-url "{token}" %}';

    $.post(url.replace('{token}', 'param'), {
        name: "test"
    });
</script> 
```

`{token}`请注意，令牌应该与正则表达式类型匹配才能成功解析（如果参数是用 定义的，则不能使用`\d+`）。

我对这个解决方案有点不满意，最后我编写了自己的应用程序来使用 django 处理 javascript：[django.js](http://pypi.python.org/pypi/django.js)。有了这个应用程序，我可以：

```
{% load js %}
{% django_js %}
<script>
    Django.onReady(function() {
        $.post(Django.url('my-url', 'param'), {
            name: "test"
        });
    });
</script> 
```

只有在`Django.onReady()`提前发布并且需要等待 Django.js 准备好时才需要包装。我是一个真实的案例，你只需要做

```
$.post(Django.url('my-url', 'param'), {
    name: "test"
}); 
```

# perl - 如何在 perl-xs 模块中嵌入 Perl 代码？

> ID：13072433
> 
> 赞同：0
> 
> 时间：2012-10-25T15:51:33.167
> 
> 标签：perl, perl-xs

我编写了一个 Perl 模块来创建一个与 h2xs 的共享库的绑定。简单易做。

但是，我现在想在这个模块中包含一些 Perl 助手。我该怎么做呢？我假设它需要进入“blah.pm”文件 - 但这个文件是由构建*生成的。*

是否有一种（简单的）方法来指定要包含在其中的代码体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:22:31.350

将帮助代码放在一个单独的模块中，例如 Blah::Helper.pm。在 Blah::Helper.pm 中使用 blah.pm

# java - 无法在 struts2 jquery json 自动完成器标签上获得自动完成功能

> ID：13072434
> 
> 赞同：0
> 
> 时间：2012-10-25T15:51:33.957
> 
> 标签：java, jquery, json, autocomplete, struts2

我目前将可能使用简单列表的自动完成器更改为 json 之一，以便能够链接它们。

我从我的操作中定义了一个 json 输出（从我的 struts.xml 中提取）：

```
<action name="listCompanies" class="web.action.SearchAction" method="getCompaniesAction">
<result type="json">
  <param name="root">companies</param>
</result>
</action> 
```

链接到代码（SearchAction 的摘录）：

```
 public String getCompaniesAction() throws Exception{
  if (term!=null && term.trim().length()>1) {
    companies=new ArrayList<KeyValuePair>();
    IServiceReferential serviceReferential = (IServiceReferential)getService(IServiceReferential.class);
    List<ICompany> listDaoCompanies =
        serviceReferential.getCompanies(getUserLoginSession(),term);

    for (Iterator<ICompany> it = listDaoCompanies.iterator(); it.hasNext();){
        ICompany company = (ICompany) it.next();
        companies.add(new KeyValuePair(company.getId().toString(), company.getCompanyname()));
    }
  }
  return SUCCESS;
} 
```

听起来效果很好：当我询问 json 操作时，它会起作用并返回： [{"key":"1","value":"Comp1"},{"key":"2","value":"比较"}]

jsp 中的自动完成标记如下所示：

```
<s:url id="url_companies" action="listCompanies" />
<sj:autocompleter size="1" name="selectCompany" href="%{url_companies}" list="companies" listKey="key" listValue="value" delay="100" loadMinimumCount="2"  onSelectTopics="/autoCompanyChange"/> 
```

它很好地触发了 json 动作，但文本框从不建议我完成。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T11:01:01.563

您需要从自动完成器中删除 list="companies" 属性

# python - INSERTS 中的 sqlalchemy 回滚

> ID：13072436
> 
> 赞同：3
> 
> 时间：2012-10-25T15:51:37.657
> 
> 标签：python, sqlite, sqlalchemy, rollback

我有一个小问题。我将一长串数据插入到数据库中，但某些新行可能会引发 IntegrityError 异常。没关系，我可以很容易地认出它们。问题是，当我回滚以撤消这个“假”插入时，之前的所有行也都被删除了。

然后我想做的是回滚到上一个状态并继续下一个插入。

```
import sqlalchemy as alc

def insert(self, specs):
    #do stuff to transfor specs in data_db

    entry = Check_Point(data_db)
    session.add(entry)

    try:
        session.flush()

    except alc.exc.IntegrityError:
        print 'int Error'
        session.rollback() 
```

所以，研究了一下，我发现了这个：

[http://docs.sqlalchemy.org/en/rel_0_7/orm/session.html#using-savepoint](http://docs.sqlalchemy.org/en/rel_0_7/orm/session.html#using-savepoint)

```
for record in records:
    try:
        with session.begin_nested():
            session.merge(record)
    except:
        print "Skipped record %s" % record
session.commit() 
```

但是，如果“记录”是要插入的对象数组（在我的情况下是 Check_Point 实例），我无法真正让它工作。我收到以下错误：

> 此 Session 的事务已被嵌套的 rollback() 调用回滚。要开始一个新事务，首先发出 Session.rollback()

我接近解决问题，但需要一些帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T05:14:55.303

由于*PySQLite*错误，目前`SAVEPOINT`事务无法与*SQLAlchemy*和*SQLite3一起正常工作。*请参阅[此 SQLAlchemy Google 小组帖子](https://groups.google.com/d/topic/sqlalchemy/XTUf_Pe4cNA/discussion)，了解 Michael Bayer 关于该错误的详细说明以及在*SQLAlchemy*中解决该问题的复杂性。

# liferay - Liferay 使用情况报告

> ID：13072437
> 
> 赞同：0
> 
> 时间：2012-10-25T15:51:37.757
> 
> 标签：liferay

我正在对一些 CMS 进行基准测试以备将来使用。我想知道 Liferay 是否有可能获得（扩展或 api 的）后台使用报告。

例子：

*   超过 X 天不创建/更新内容的用户？

*   超过 X 天没有新内容的内容区？

*   等待批准的内容数量？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T07:19:32.213

a）对于用户，您可以创建一个在创建内容时调用的侦听器，带有 serviceBuilder 的单独表可以存储这些，并且每隔 X 天您可以从该表中读取并检查哪些用户丢失

b) 内容领域？如果您的意思是 webContent，您可以获得修改后的日期，我也认为在这里创建一个侦听器会更容易（再次）。如果有更改，它会将更改保存在某处，您可以每 X 天检查一次

c）JournalArticleLocalServiceUtil 可以为您带来所有文章，您可以检查它们的状态，或者您创建一个自定义查询来加载具有特定状态的那些（即`WorkflowConstants.STATUS_PENDING`）

# sharepoint - Sharepoint 初学者问题：在哪里存储数据？

> ID：13072439
> 
> 赞同：-1
> 
> 时间：2012-10-25T15:51:39.833
> 
> 标签：sharepoint

我即将在 Sharepoint 中开发一个应用程序。我有 asp.net 和 C#、Domino、Java 等方面的经验。

现在我的 1000 美元问题：我可以在 Sharepoint 中的哪里存储数据？我知道有列表定义.. 那么使用列表将数据“本地”存储在 Sharepoint 中，还是传统上存储在外部数据容器（例如 ms sql 2008）中是一种好习惯？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:24:51.347

因为 SharePoint 本质上是一个 .NET Web 应用程序，所以对于如何存储应用程序中使用的数据，选项几乎是无限的。两种最常见的做法是使用 SharePoint 列表来存储您的数据，或者将数据存储在 SQL 数据库中。

我建议每个人都有自己的优势。SharePoint 列表是有利的，因为它可以被用户看到，并且您可以利用开箱即用的功能来允许用户执行 CRUD 操作。当数据量很大并且不能很好地适应 SharePoint 列表的构造时，SQL 数据库更有意义。在进行批量操作时，SQL 将执行得更快。

希望这可以帮助！

# android - Admob“自家广告”广告系列用于插页式广告

> ID：13072441
> 
> 赞同：0
> 
> 时间：2012-10-25T15:51:42.027
> 
> 标签：android, admob, interstitial

如何为插页式广告设置 Admob“自家广告”广告系列以始终加载？

我正进入（状态

```
onFailedToReceiveAd(Ad request successful, but no ad returned due to lack of ad inventory.) 
```

在 AdGroup 目标中，我选择“完全分配”

但消息仍在继续！

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T02:04:44.433

插页式广告（包括自家广告插页式广告）设置为每天仅向每台设备投放一次。这样做是为了让用户不会一遍又一遍地收到相同的插页式广告。您可能收到过一次插页式广告，然后就无法再收到了。

如果您设置了多个自家广告插页式广告系列，您应该能够每天在每台设备上获得每个广告系列一次。

2014 年 9 月 4 日更新：

在apps.admob.com 上的新AdMob 上，自家广告目前没有频次上限。

# android - Android Holo 主题不包含多行微调器下拉项

> ID：13072442
> 
> 赞同：10
> 
> 时间：2012-10-25T15:51:41.990
> 
> 标签：android, spinner, android-spinner

我最近刚刚在我的安卓应用中实现了全息主题。执行此操作后，我拥有的任何微调器（下拉项长多行）都不会将文本换行到多行。每个下拉项目都保留在一行上，并被截断到一定长度。

这是我的微调器下拉资源的 xml

```
<CheckedTextView xmlns:android="http://schemas.android.com/apk/res/android" 
android:id="@android:id/text1"
style="?android:attr/spinnerDropDownItemStyle"
android:singleLine="false"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:ellipsize="none" /> 
```

这适用于 ICS 和 holo 主题之前的旧版本的 android。

有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T13:31:55.010

正如我在：[Spinner 不换行中提到的那样——这是一个 Android 错误吗？](https://stackoverflow.com/questions/14139106/spinner-does-not-wrap-text-is-this-an-android-bug/14392369#14392369)

我认为android上有一个错误。你可以试试这个。从文本中删除空格，然后显示它会正常工作。如果 textview 的长度是 < 字符串的长度，它会忽略空格后面的所有字符。对于解决方法，您可以尝试以下操作：

使用示例代码将文件添加到名为 multiline_spinner_dropdown_item.xml 的 res/layout 文件夹：

```
<CheckedTextView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@android:id/sample_text"
style="?android:attr/spinnerDropDownItemStyle"
android:singleLine="false"
android:layout_width="match_parent"
android:layout_height="?android:attr/listPreferredItemHeight"
android:ellipsize="marquee" /> 
```

当你创建微调器时，从这个布局创建它。

就像是 ：

```
ArrayAdapter.createFromResource(this, items, R.layout.multiline_spinner_dropdown_item); 
```

基本上，将 android.R.layout.simple_spinner_dropdown_item 布局复制到项目中，并通过在 CheckedTextView 中将 singleLine 属性设置为 false 来修改布局。

# c# - 如何使用变量名反序列化可变大小的 JSON 字符串

> ID：13072447
> 
> 赞同：1
> 
> 时间：2012-10-25T15:51:54.397
> 
> 标签：c#, json, javascriptserializer, jsonserializer

反序列化具有固定字段名称的小型、固定大小、固定结构的 JSON 字符串很容易：只需定义一个包含所有字段的类（具有正确的类型和名称，在编译时都知道）。

反序列化可变大小的重复嵌套对更具挑战性，但可以借助类内的[List<>](https://stackoverflow.com/a/7895168)来完成。

**但是，如果在编译时字段名称**未知，我该怎么办？例如：

```
{
   "container":{
      "GD01AB491103":{
         "field_id1":11,
         "field_id2":12,
         "field_id3":13,
         "field_id4":"fourteen"
      },
      "DC01AB491103":{
         "field_id1":21,
         "field_id2":22,
         "field_id3":23,
         "field_id4":"twenty four"
      },
      "GH01AB451101":{
         "field_id1":31,
         "field_id2":32,
         "field_id3":33,
         "field_id4":"thirty four"
      }
      .
      .
      .
   },
   "terminator"
} 
```

如何反序列化这样的字符串？

（最好使用 .NET 的[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer%28v=vs.100%29.aspx)，但如果它太弱/无能，我可能需要求助于其他东西）

**编辑**：澄清挑战的性质：在上面的示例中，为了定义一个类：

```
public class ??????
{
    public int field_id1  {get;set;}
    public int field_id2  {get;set;}
    public int field_id3  {get;set;}
    public string field_id4 {get;set;}
} 
```

我需要先查询 JSON 字符串，然后在运行时构建包含这些变量名类对象的类（反射？）？看起来太麻烦了……也许有更理智的方法？

或者，类/字段名称可能与 .NET 的[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer%28v=vs.100%29.aspx)无关，而重要的是类型？（当然还有正确的结构）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:13:27.423

您可以比您想象的更简单地做到这一点..您的`??????`课程可以是任何东西..

```
public class GenericObject
{
    public int field_id1  {get;set;}
    public int field_id2  {get;set;}
    public int field_id3  {get;set;}
    public string field_id4 {get;set;}
} 
```

然后将对象图的根反序列化为一个包含`Dictionary<string,GenericObject>`...的对象

```
public class SomeContainer
{
    public Dictionary<string,GenericObject> container {get;set;}
} 
```

如果您不关心键的名称，则可以循环遍历字典的值。

# actionscript-3 - 框架脚本中绑定的“this”是什么？

> ID：13072455
> 
> 赞同：0
> 
> 时间：2012-10-25T15:52:16.067
> 
> 标签：actionscript-3, this

在 ActionScript 3 中的帧脚本上，特殊变量`this`绑定到什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:15:31.497

`this`框架脚本上的内容绑定到 MovieClip。ActionScript 3 不共享`this`JavaScript 的动态范围，它将始终绑定到类。

# linux - CSV grep 但保留标题

> ID：13072457
> 
> 赞同：3
> 
> 时间：2012-10-25T15:52:23.367
> 
> 标签：linux, csv, awk, grep

我有一个如下所示的 CSV 文件：

```
A,B,C
1,2,3
4,4,4
1,2,6
3,6,9 
```

有没有一种简单的方法可以对 B 列为 2 的所有行进行 grep，并保留标题？例如，我希望输出像

```
A,B,C
1,2,3
1,2,6 
```

我在linux下工作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T16:01:07.290

使用 awk：

```
awk -F, 'NR==1 || $2==2' file 
```

NR==1 -> 如果第一行，$2==2 -> 如果第二列等于 2。如果以上任何一个为真，则打印行。

要使用标题列名称选择列：

```
awk -F, -v col="B" 'NR==1{for(i=1;i<=NF;i++)if($i==col)break;print;next}$i==2'  file 
```

将 B 替换为要检查的列的适当名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:55:50.183

您可以使用以下地址`sed`：

```
sed -n '1p;/^[^,]*,2/p' 
```

它的意思是：

```
1p        Print the first line.
/         Start a match.
    ^     Match the beginnning of a line.
    [^,]  Match anything but a comma
    *     zero or more times.
    ,     Match a comma.
    2     Match a 2.
/p        End of match, if it matches, print. 
```

如果标头可以包含您要查找的值，则应更加小心：

```
sed -n '1p;1!{/^[^,]*,2/p}' 
```

`1!{ ... }`仅表示“对除第一行以外的行执行以下操作”。

对于列号`n>2`，您可以添加一个量词：

```
sed -n '1p;1!{/^\([^,]*,\)\{M\}2/p}' 
```

哪里`M=n-1`。量词只是意味着重复，所以*非逗号 0 或更多次逗号*的东西被重复 M 次。

对于值可以包含逗号的真正 CSV 文件，切换到 Perl 和[Text::CSV](http://p3rl.org/Text%3a%3aCSV)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:55:47.237

```
$ awk -F, 'NR==1 { for (i=1;i<=NF;i++) h[$i] = i; print; next } $h["B"] == 2' file
A,B,C
1,2,3
1,2,6 
```

顺便说一句，sed 是在单行上进行简单替换的出色工具，对于其他任何事情，只需使用 awk - 如果需要，将来代码会更清晰并且更容易增强。

# image-processing - 考虑到噪音，在泳池中与游泳者形成对比的最有效方法

> ID：13072466
> 
> 赞同：6
> 
> 时间：2012-10-25T15:52:46.323
> 
> 标签：image-processing

我想计算池中的人数，用于统计用途。我将对位于游泳池天花板上的安全摄像头生成的图像使用人工智能和图像处理。相机是静态的，所以它没有旋转轴。

对于图像处理步骤，我想专注于游泳者，并尝试移除池的其余部分。我需要在背景和游泳者之间形成良好的对比。

问题是摄像机的输出图像有很多“噪音”，如阳光、光线、水底的黑线、空中的旗帜和备用走廊的电缆。

这是图像外观的示例。真实图像的质量会更好，因为这个例子是从我用手机输出的照片中截取的。

![捕获图像](../Images/f8f47da64e15b9dc9ba146ac3558b032.png)

*   去除图像上的太阳光线/光线的最有效方法是什么？也许使用过滤器？
*   考虑到水底的黑线，我如何在游泳者和背景之间创造出高对比度？

因为相机不动，我可以获得其他图像，具有相同的背景（太阳光线除外），也许我可以利用图像上的差异来提取游泳者？

我正在寻找任何想法/过滤器/参考。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T14:16:03.837

我的建议是将图像分析到 HSV 空间中。对于信息 H（色调）对应于颜色。S（饱和度）是颜色的纯度。

如果您使用的是 matlab，请在 opencv 中使用函数 rgb2hsv() 使用 cvCvtColor() 来转换颜色空间。

这是我对您的图像所做的一个小实验。我已将图像转换为 HSV 空间。我已经发布了它的假彩色图。现在有了这个，你可以做的是聚类 k-means 之类的东西来识别人。 ![在此处输入图像描述](../Images/16741f3e08019cabba0097f93c021ba7.png)

在 octave/matlab 中重新生成它的确切命令是：

```
>> im = imread( '9Nd5s.png' );
>> hsv = rgb2hsv( im );
>> imagesc( hsv(:,:,1) ), colormap( hot ) 
```

希望这会有所帮助，如果您需要更多帮助，请告诉我。你的问题似乎很有趣。

# android - 我可以查看当前正在从服务运行的应用程序吗？

> ID：13072467
> 
> 赞同：0
> 
> 时间：2012-10-25T15:52:51.433
> 
> 标签：android, android-activity

我试图从我创建的服务中查看当前在前台/用户正在使用的应用程序或活动：

```
 ActivityManager am = (ActivityManager) getApplicationContext().getSystemService(
                        Context.ACTIVITY_SERVICE);

                List<ActivityManager.RunningAppProcessInfo> processList = am.getRunningAppProcesses();
String cProcess = processList.get(0).processName; 
```

但这有时会显示 com.android.systemui 或 com.android.buetooth 之类的服务，即使在前台有不同的活动时也是如此。

我想这是检查服务而不是活动.. 有没有更好更可靠的方法来查看当前处于前台的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:00:49.887

我认为这[`activityManager.getRunningTasks()`](http://developer.android.com/reference/android/app/ActivityManager.html#getRunningTasks%28int%29)更符合您的要求，尽管请注意 Android 开发人员警告不要`ActivityManager`为您的应用程序使用任何核心功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:09:30.897

尝试检查过程的重要性：

```
List<RunningAppProcessInfo> appProcesses= null;
appProcesses = activityManager.getRunningAppProcesses();
if (appProcesses!=null) {

    for (RunningAppProcessInfo appProcess : appProcesses) {
        if (appProcess.importance == RunningAppProcessInfo.IMPORTANCE_FOREGROUND) {
            // Log.d("MYTAG",appProcess.processName+":"+appProcess.importance+" is foreground");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:12:24.427

这就像一个魅力......感谢JRaymond：

```
ActivityManager am = (ActivityManager) getApplicationContext().getSystemService(
                    Context.ACTIVITY_SERVICE);

            List<ActivityManager.RunningTaskInfo> processList = am.getRunningTasks(3);

            String cProcess = processList.get(0).baseActivity.getPackageName(); 
```

# function - 调用不在 Matlab 路径上的函数而不添加该路径

> ID：13072470
> 
> 赞同：16
> 
> 时间：2012-10-25T15:53:07.837
> 
> 标签：function, matlab, path, call

我一直在搜索整个下午，但没有找到通过指定路径而不是将其目录添加到路径中来调用 matlab 函数的解决方案。

这个问题非常类似于[Is it possible to call a function that is not in the path in MATLAB?](https://stackoverflow.com/questions/9205627/is-it-possible-to-call-a-function-that-is-not-in-the-path-in-matlab) ，但就我而言，我不想调用内置函数，而只是调用 m 文件中定义的普通函数。

我认为句柄可能是一个解决方案（因为显然它们可以引用不在路径上的函数），但我再次发现没有办法创建句柄而不`cd`-ing 到目录，在那里创建它并`cd`返回 -ing。试图“探索”什么是函数句柄对象以及如何通过对不在路径上的特定函数的引用来制作一个对象，这让我无处可去。

因此解决方案可能来自两个角度：
1）您知道如何为特定目录中的 m 文件创建句柄。
2）您知道一种调用不在 matlab 路径上的函数的方法。

编辑：我刚刚发现了这个函数`functions(myhandle)`，它实际上可以让你看到句柄所指的文件路径。但是仍然没有办法修改它...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T16:26:43.053

这是可行的，但需要一些解析，并调用`evalin`.

我（很多年前！）在 MATLAB 中央文件交换中添加了一个函数，称为`externalFcn`

[http://www.mathworks.com/matlabcentral/fileexchange/4361-externalfcn](http://www.mathworks.com/matlabcentral/fileexchange/4361-externalfcn)

管理对非路径函数的调用。例如，我有一个调用的函数`offpathFcn`，它只返回一个带有成功消息的结构和输入的值。将该函数存储在我的 MATLAB 路径之外，我可以使用以下命令调用它：

```
externalfcn('out = C:\MFILES_OffPath\offpathFcn(''this is a test'')'); 
```

这将返回：

```
out = 
    success: 1
    input: 'this is a test' 
```

（请注意，我的实现是有限的，并且可以改进；您必须包含一个带有等号的输出才能使其工作。但它应该向您展示如何实现您想要的。）

（MathWorks 应用工程师）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-20T12:23:11.337

@Rody Oldenhuis 的 FEX 贡献很好地实现了注释[1](https://stackoverflow.com/questions/13072470/call-a-function-that-is-not-on-the-matlab-path-without-adding-that-path/16903404#comment34017362_13073060)中提到的在调用函数之前创建函数句柄的解决方案：http: [//www.mathworks.com/matlabcentral/fileexchange/45941-constructor-for-functionhandles](http://www.mathworks.com/matlabcentral/fileexchange/45941-constructor-for-functionhandles)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-03T18:29:17.960

```
function [varargout]=funeval(fun,varargin)
% INPUT:
% fun: (char) full path to function file
curdir=cd;
[fundir,funname]=fileparts(fun);
cd(fundir);
[varargout{1:nargout}] =feval(funname,varargin{:})
cd(curdir); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-07T15:39:47.180

我已经修改了 Thierry Dalon 的代码以避免使用 feval，我总是对此感到不舒服。请注意，这仍然无法绕过 cd-ing 到有问题的目录，但是，它发生在幕后，所以假装它没有发生 :-) 另请注意 Ben Voigt 上面指出的内容：对辅助函数的调用关闭路径将失败。

```
function [varargout]=funeval(FunctionHandle, FunctionPath, varargin)
% INPUT:
% FunctionHandle: handle to the function to be called; eg @MyFunction
% FunctionPath: the path to that function
% varargin: the arguments to be passed to Myfunction
curdir=cd;
cd(FunctionPath)
[varargout{1:nargout}] = FunctionHandle(varargin{:});
cd(curdir);
end 
```

并调用它看起来像

```
Output = funeval(@MyFunction, 'c:\SomeDirOffMatlabsPath\', InputArgToMyFunc) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T16:20:34.883

该[`run`](http://www.mathworks.com/help/matlab/ref/run.html)命令可以从任何目录运行脚本文件，但不能调用函数（带有输入和输出参数）。

函数字符串中既不允许`feval`也`str2func`不允许目录信息。

我建议为此编写自己的包装器`str2func`：

*   保存工作目录
*   将目录更改为脚本目录
*   创建函数句柄
*   恢复原来的工作目录

但是请注意，不在路径中的函数的句柄可能会中断，因为该函数将无法调用存储在其目录中其他文件中的任何帮助代码。

# java - 推导出数的位置

> ID：13072473
> 
> 赞同：-2
> 
> 时间：2012-10-25T15:53:14.377
> 
> 标签：java, algorithm

我想提取一个简单数字的位置数：示例：`123`是`3`位置，`12`在`2`位置，`12365`在`5`位置......什么是解决方案？有方法`Math`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T15:54:30.450

您可以使用字符串：

```
int numberOfFigures = String.valueOf(12345).length(); 
```

或取[数字的 log10](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#log10%28double%29)并将其四舍五入：

```
int numberOfFigures = Math.floor(Math.log10(12345)) + 1; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-25T15:59:04.733

可靠的方法是：`Math.floor(Math.log10(x) + 1)`

需要处理 10的`+1`完美幂的情况。实际上`Math.log10(10)`是 1，但那是 2 位数长。`Math.floor()`然后将向下舍入数字以获得位数。

# ruby-on-rails - 覆盖供应商 scss 包括

> ID：13072475
> 
> 赞同：4
> 
> 时间：2012-10-25T15:53:22.687
> 
> 标签：ruby-on-rails, asset-pipeline, sass

我在我的 Rails 应用程序中使用这个 gem： [https ://github.com/thomas-mcdonald/bootstrap-sass/](https://github.com/thomas-mcdonald/bootstrap-sass/)

我想用我自己的覆盖包含在此文件最后一行的响应式导航栏： [https ://github.com/thomas-mcdonald/bootstrap-sass/blob/master/vendor/assets/stylesheets /_bootstrap-responsive.scss](https://github.com/thomas-mcdonald/bootstrap-sass/blob/master/vendor/assets/stylesheets/_bootstrap-responsive.scss)

那可能吗？

我尝试在此位置创建一个空文件：/app/assets/stylesheets/bootstrap/_responsive-navbar.scss，但它不会从 bootstrap-sass 项目中覆盖。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T01:32:40.260

如果 CSS 包含在先前样式之后，则 CSS 会覆盖先前的行为。或者换句话说：

```
h1 {color:blue}
h1 {color:red} 
```

将渲染一个 h1 HTML 标签红色。

要覆盖响应式导航栏，您可以在之后将更改添加到 application.css.scss 文件

```
*= require_self
*= require_tree . 
```

它编译您的 rails 应用程序中的所有其他 css 文件。

对于它的价值，ruby 文档建议您“不应该依赖任何特定的顺序”首先/第二次编译 css 文件（参见 [http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and -指令](http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives)）。这可能表明您的新样式没有出现的原因。

# spring-mvc - 如何使用带有 LightCouch 的 Spring Bean Deployment 创建 CouchDB 视图

> ID：13072479
> 
> 赞同：1
> 
> 时间：2012-10-25T15:53:45.397
> 
> 标签：spring-mvc, couchdb

我正在使用 Spring-MVC LightCouch 和 CouchDB，并且我有自定义视图需要在部署时插入到数据库中。我发现 LightCouch 有一种“从办公桌上”提取文档的方法，如其网站上所述：

```
DesignDocument designDoc = dbClient.design().getFromDesk("example");  
Response response = dbClient.design().synchronizeWithDb(designDoc); 
```

这在 JAVA 代码中效果很好，但是我需要能够在 Spring ApplicationContext.xml 中做到这一点我有不止一个，所以我想模仿以下调用：

```
dbClient.dessign().synchronizeAllWithDB() 
```

我将如何在 ApplicationContext 的 bean 定义中执行此操作我已经有了这个：

```
<bean id="dbClient" class="org.lightcouch.CouchDbClient" lazy-init="false" destroy-    method="shutdown">
<constructor-arg value="couchdb.properties" />
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T04:29:02.400

看来你不能用 Spring xml 配置来做，因为 init 方法属于不同的实例；由调用`design()`工厂方法返回。也许您可以尝试 Java 代码等价，即`@PostConstruct`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:35:51.657

我最终不得不制作一个在 init 上同步数据库并在应用程序启动时创建的 bean

# php - PHPMail发送附件但它们是空的

> ID：13072482
> 
> 赞同：8
> 
> 时间：2012-10-25T15:54:05.593
> 
> 标签：php

基本上，我正在尝试通过 PHPMail 发送 PDF。电子邮件已发送，我在 Outlook 中完美接收。问题是附件坏了，打不开。我什至尝试发送 HTML 并且也是空的。

我尝试在论坛中进行研究，尝试了几个“工作代码”并且其他人使用此代码进行了工作......我不知道为什么不适合我。我正在使用最新版本的 PHPMail 5.2.2

```
$mail = new PHPMailer();
        $staffEmail = "staffemail";
        $mail->From = $staffEmail;
        $mail->FromName = "name";
        $mail->AddAddress('my@email.com');
        $mail->AddReplyTo($staffEmail, "name");

        $mail->AddAttachment('test.pdf');
        $mail->Subject = "PDF file attachment";

        $mail->Body = "message!";
        $mail->Send(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-07T12:28:19.880

这个自定义 PHP 函数将向（初级）PHP 开发人员展示如何构建带有附件功能的电子邮件脚本。请注意，邮件功能内部没有可用的验证功能。

```
<?php
function mail_attachment($filename, $path, $mailto, $from_mail, $from_name, $replyto, $subject, $message) {
    $file = $path.$filename;
    $file_size = filesize($file);
    $handle = fopen($file, "r");
    $content = fread($handle, $file_size);
    fclose($handle);
    $content = chunk_split(base64_encode($content));
    $uid = md5(uniqid(time()));
    $name = basename($file);
    $header = "From: ".$from_name." <".$from_mail.">\r\n";
    $header .= "Reply-To: ".$replyto."\r\n";
    $header .= "MIME-Version: 1.0\r\n";
    $header .= "Content-Type: multipart/mixed; boundary=\"".$uid."\"\r\n\r\n";
    $header .= "This is a multi-part message in MIME format.\r\n";
    $header .= "--".$uid."\r\n";
    $header .= "Content-type:text/plain; charset=iso-8859-1\r\n";
    $header .= "Content-Transfer-Encoding: 7bit\r\n\r\n";
    $header .= $message."\r\n\r\n";
    $header .= "--".$uid."\r\n";
    $header .= "Content-Type: application/octet-stream; name=\"".$filename."\"\r\n"; // use different content types here
    $header .= "Content-Transfer-Encoding: base64\r\n";
    $header .= "Content-Disposition: attachment; filename=\"".$filename."\"\r\n\r\n";
    $header .= $content."\r\n\r\n";
    $header .= "--".$uid."--";
    if (mail($mailto, $subject, "", $header)) {
        echo "mail send ... OK"; // or use booleans here
    } else {
        echo "mail send ... ERROR!";
    }
}
?> 
```

接下来，我们将展示一个示例，说明如何使用此功能发送带有附加 zip 文件的电子邮件：

```
<?php    $my_file = "somefile.zip";
    $my_path = $_SERVER['DOCUMENT_ROOT']."/your_path_here/";
    $my_name = "Olaf Lederer";
    $my_mail = "my@mail.com";
    $my_replyto = "my_reply_to@mail.net";
    $my_subject = "This is a mail with attachment.";
    $my_message = "Hallo,\r\ndo you like this script? I hope it will help.\r\n\r\ngr. Olaf";
    mail_attachment($my_file, $my_path, "recipient@mail.org", $my_mail, $my_name, $my_replyto, $my_subject, $my_message);
?> 
```

您是否正在寻找发送多个附件的脚本？试试我们的邮件附件类脚本。

如果您想通过 SMTP 和 Gmail 发送您的网站邮件，请查看我们的 PHPMailer 教程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T09:30:54.887

我建议您将文件上传到服务器，然后将其附加到电子邮件中。例如，您可以使用以下步骤：

1.  上传文件
2.  将其附加到电子邮件
3.  发送电子邮件
4.  从服务器中删除此临时文件

试试这个，因为我认为这就是你问题的原因。

以防万一： http: [//php.net/manual/en/features.file-upload.php](http://php.net/manual/en/features.file-upload.php)

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T12:10:47.843

可能有两个问题，附件路径不正确或 php 对该文件夹没有权限

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-05T05:59:41.873

您可以尝试使用这个使用 PHP 简单邮件功能的功能：

```
function mail_attachment ($from , $to, $subject, $message, $attachment){
$fileatt = $attachment; // Path to the file                  
$fileatt_type = 'application/octet-stream'; // File Type 
$start= strrpos($attachment, '/') == -1 ? strrpos($attachment, '//') : strrpos($attachment, '/')+1;
$fileatt_name = substr($attachment, $start, strlen($attachment)); // Filename that will be used for the file as the     attachment 

$email_from = $from; // Who the email is from 
$email_subject =  $subject; // The Subject of the email 
$email_txt = $message; // Message that the email has in it 

$email_to = $to; // Who the email is to

$headers = "From: ".$email_from;

$file = fopen($fileatt,'rb'); 
$data = fread($file,filesize($fileatt)); 
fclose($file); 
$msg_txt=""; //\n\nMail created from websiteaddress systems : http://websiteaddress.com

$semi_rand = md5(time()); 
$mime_boundary = "==Multipart_Boundary_x{$semi_rand}x"; 

$headers .= "\nwebsiteaddress-Version: 1.0\n" . 
        "Content-Type: multipart/mixed;\n" . 
        " boundary=\"{$mime_boundary}\""; 

$email_txt .= $msg_txt;

$email_message = "This is a multi-part message in websiteaddress format.\n\n" . 
            "--{$mime_boundary}\n" . 
            "Content-Type:text/html; charset=\"iso-8859-1\"\n" . 
           "Content-Transfer-Encoding: 7bit\n\n".$email_txt. "\n\n"; 
$data = chunk_split(base64_encode($data)); 
$email_message .= "--{$mime_boundary}\n" . 
              "Content-Type: {$fileatt_type};\n" . 
              " name=\"{$fileatt_name}\"\n" . 
              //"Content-Disposition: attachment;\n" . 
              //" filename=\"{$fileatt_name}\"\n" . 
              "Content-Transfer-Encoding: base64\n\n" . 
             $data . "\n\n" . 
              "--{$mime_boundary}--\n"; 

$ok = @mail($email_to, $email_subject, $email_message, $headers); 

if($ok) { 
//echo "Attachment has been mailed !";
//header("Location: index.php");
} else { 
    die("Sorry but the email could not be sent. Please go back and try again!"); 
} 
} 
```

希望这会帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-01T09:47:10.453

这个正在为我工​​作，试图发送简历在 zend 中有附件

```
 $mail = new Zend_Mail ();
            $mail->setBodyHTML ( stripslashes ($message) );

            // add attachment
            $fileContents = file_get_contents($attachemnet);
            $resume = $mail->createAttachment($fileContents);
            $resume->filename = $EmployeeDeatils['resume'];

            //$mail->createAttachment($attachemnet);
            $mail->setFrom ( $mail_template ['from_email'], $mail_template ['from_caption'] );
            $mail->addTo ( $clientemail, $employee_name );
            $mail->setSubject ($subject );
            try {
                $mail->send ();
            } catch ( Exception $e ) {
                $this->_helper->errorlog ( " Send mail to member with activation link : " . $e->getMessage () );
            } 
```

# selenium - Grails and Selenium: how to integrate the two?

> ID：13072484
> 
> 赞同：2
> 
> 时间：2012-10-25T15:54:09.063
> 
> 标签：selenium, groovy, grails-2.0

I'm looking to automate the testing of the UI part of my Grails project using Selenium. A number of options seem to exist:

*   [Grails Selenium plugin](http://grails.org/plugin/selenium): doesn't appear to support programmatic test definitions?
*   [Grails Selenium-RC plugin](http://grails.org/plugin/selenium-rc): links on the plugin page are broken, the only [Github repo](https://github.com/pivotal/selenium-rc) I can find appears to be the Ruby version...
*   [Geb](http://www.gebish.org/) (and the [Grails plugin](http://grails.org/plugin/geb)), which hasn't made a 1.0 final release yet.

Can anyone recommend one of these tools in particular, or suggest a better way? Does any decent documentation exist describing how to test Grails applications with Selenium?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:15:24.273

We have been using Geb + Geb Grails plugin (Selenium wrapper) in several projects for more then two years.

The release number might be < 1.0, but in stability (bugs & API) it can be considered + 1.0 quality IMHO.

# spring - 为 primefaces 数据列表实现 LazyModel 时出现异常

> ID：13072491
> 
> 赞同：2
> 
> 时间：2012-10-25T15:54:24.387
> 
> 标签：spring, jsf-2, primefaces, pagination, nullpointerexception

我正在尝试为 primefaces 数据列表实现类似于数据表的延迟加载模型，如下[所示](http://www.primefaces.org/showcase/ui/datatableLazy.jsf)。

我具有正常 AJAX 分页功能的初始代码工作得非常好。但是，当我尝试使用延迟加载模型时，页面加载时出现以下异常：

```
com.sun.faces.application.view.FaceletViewHandlingStrategy handleRenderException
SEVERE: Error Rendering View[/pages/index.xhtml]
java.io.NotSerializableException: java.util.ArrayList$SubList
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1180)
    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1528)
    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1493)
    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)
    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1528)
    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1493)
    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)
    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:346)
    at java.util.HashMap.writeObject(HashMap.java:1100)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:975)
    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1480)
    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)
    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1528)
    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1493)
    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)
    at java.io.ObjectOutputStream.writeArray(ObjectOutputStream.java:1362)
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1170)
    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:346)
    at java.util.HashMap.writeObject(HashMap.java:1100)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:975)
    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1480)
    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1416)
    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1174)
    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:346)
    at com.sun.faces.renderkit.ClientSideStateHelper.doWriteState(ClientSideStateHelper.java:325)
    at com.sun.faces.renderkit.ClientSideStateHelper.writeState(ClientSideStateHelper.java:173)
    at com.sun.faces.renderkit.ResponseStateManagerImpl.writeState(ResponseStateManagerImpl.java:122)
    at com.sun.faces.application.StateManagerImpl.writeState(StateManagerImpl.java:166)
    at com.sun.faces.application.view.WriteBehindStateWriter.flushToWriter(WriteBehindStateWriter.java:225)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:418)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

这是**index.html的代码**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:p="http://primefaces.org/ui">

<ui:composition template="/pages/templates/template.xhtml">
   <ui:define name="content">

      <h:form prependId="false" id="form">
         <p:dataList value="#{movies.lazyMovieModel}" var="movie" id="movies" paginator="true" rows="10"
            paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
            type="none" paginatorAlwaysVisible="false" lazy="true">

            <h:outputText value="#{movie.movieName}, #{movie.releaseYear}" style="margin-left:10px">
            </h:outputText>
            <br/>
         </p:dataList>
      </h:form>

   </ui:define>
</ui:composition>
</html> 
```

**MovieListBean.java**

```
import org.primefaces.model.LazyDataModel;

import com.clixflix.enitities.Movie;
import com.clixflix.jsf.extensions.LazyMovieDataModel;

@ManagedBean(name = "movies")
@ViewScoped
public class MovieListBean extends BaseBean implements Serializable
{
   private static final long serialVersionUID = -5719443344065177588L;

   private LazyDataModel<Movie> lazyMovieModel;

   @PostConstruct
   public void initialize() {
      lazyMovieModel = new LazyMovieDataModel();
   }

   public LazyDataModel<Movie> getLazyMovieModel() 
   {
      List<Movie> movieList = getServiceLocator().getMovieService().getMovieList();
      ((LazyMovieDataModel) lazyMovieModel).setMovieList(movieList);
      return lazyMovieModel;
   }
} 
```

**LazyMovieDataModel.java**（LazyModel 实现）

```
public class LazyMovieDataModel extends LazyDataModel<Movie>
{
   private static final long serialVersionUID = 8745562148994455749L;

   private List<Movie> movieList;

   public LazyMovieDataModel() {
      this.movieList = Collections.emptyList();
   }

   @Override
   public List<Movie> load(int first, int pageSize, String sortField, SortOrder sortOrder, Map<String, String> filters) {
      // Sorting
      if (null != sortField) {
         LazySorter sorter = new LazySorter(sortField, sortOrder);
         Collections.sort(movieList, sorter);
         sorter = null;
      }

      // RowCount
      int rowCount = movieList.size();
      this.setRowCount(rowCount);

      // Pagination
      if (rowCount > pageSize) {
         return movieList.subList(first, (first + pageSize));
      }
      else {
         return movieList;
      }
   }

   private class LazySorter implements Comparator<Movie>
   {
      private String sortField;

      private SortOrder sortOrder;

      LazySorter(String sortField, SortOrder sortOrder) {
         this.sortField = sortField;
         this.sortOrder = sortOrder;
      }

      @SuppressWarnings("unchecked")
      @Override
      public int compare(Movie movie1, Movie movie2) {
         Object value1 = null, value2 = null;

         try {
            value1 = Movie.class.getField(this.sortField).get(movie1);
            value2 = Movie.class.getField(this.sortField).get(movie2);

            int value = ((Comparable<Object>) value1).compareTo(value2);
            return SortOrder.ASCENDING.equals(sortOrder) ? value : -1 * value;
         }
         catch (IllegalArgumentException | IllegalAccessException | NoSuchFieldException | SecurityException e) {
            e.printStackTrace();
            return 0;
         }
      }
   }

   public void setMovieList(List<Movie> movieList) {
      this.movieList = movieList;
   }
} 
```

我假设例外是在这一行：

```
return movieList.subList(first, (first + pageSize)); 
```

谁能指导我我错过了什么？

另外，我在日志中观察到，当我使用惰性模型时，数据库被查询**了 3 次**，但是当我使用正常的 AJAX 分页时，数据库**只被查询一次**：|

* * *

**更新**：我弄清楚了数据库被查询 3 次的原因。这是因为我在 LazyModel 的 getter 中调用我的服务，而不仅仅是在 load 方法中。

我在类中进行了以下更改：

**LazyMovieDataModel.java**

```
public class LazyMovieDataModel extends LazyDataModel<Movie>
{
   private static final long serialVersionUID = 8745562148994455749L;

   public LazyMovieDataModel() {}

   @Override
   public List<Movie> load(int first, int pageSize, String sortField, SortOrder sortOrder, Map<String, String> filters) {

      List<Movie> movieList = getServiceLocator().getMovieService().getMovieList(first, (first + pageSize));

      // RowCount
      int rowCount = ((Number)getServiceLocator().getMovieService().getMovieCount()).intValue();
      this.setRowCount(rowCount);
   }
} 
```

**MovieListBean.java 中的 LazyModel getter**

```
/* Removed PostConstruct init method */

public LazyDataModel<Movie> getLazyMovieModel() 
{
   return lazyMovieModel;
} 
```

上述更改在初始页面加载时工作正常。但是，当我点击下一页按钮（或任何分页按钮）时，我`getServiceLocator()`在加载方法中得到了一个 NPE。

serviceLocator 是`protected`从 BaseBean 继承并使用 Spring 注入的访问修改托管属性。

getter 在后续调用中返回 null 的任何原因？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T11:01:41.413

ArrayList$SubList 是个问题。返回的 subList 没有实现可序列化。
尝试使用：

```
return new ArrayList(movieList.subList(first, (first + pageSize))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-16T11:00:44.700

Same problem in this [link](https://stackoverflow.com/questions/16892496/primefaces-lazy-loading-is-not-implemented/16892587).There are 2 load methods in LazyDataModel:

```
public List<T> load(int first, int pageSize, String sortField, SortOrder sortOrder, Map<String,String> filters) {
    throw new UnsupportedOperationException("Lazy loading is not implemented.");
}

public List<T> load(int first, int pageSize, List<SortMeta> multiSortMeta,Map<String,String> filters) {
    throw new UnsupportedOperationException("Lazy loading is not implemented.");
} 
```

This is where the error is thrown. You are using multisort, so you should override the second.Default method is the first one.

# php - 删除临时表

> ID：13072492
> 
> 赞同：1
> 
> 时间：2012-10-25T15:54:25.530
> 
> 标签：php, mysql, drop-table

我有 3 个 php 脚本：在第一个中，我创建了一个基于用户 ID 名称的临时表（在 MySQL 中），在第二个中，我使用该表并向用户发送消息，在第三个中，我使用并删除临时表和向用户发送消息。我的问题是，如果用户在第二页时关闭浏览器，我会在数据库中留下一个需要删除的临时表。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:09:07.673

这是*非常*糟糕的做法。一次创建表*并*根据用户操作插入/删除行。在每一行上使用时间戳并定期运行清理脚本以删除旧条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T18:08:58.927

如果您对所有访问使用通用数据库句柄，则可以使用“创建临时表 <contents>”，并且在句柄关闭时它会自动删除。如果会话过早关闭，这将清理混乱。

# ruby - “**/*/”和“**/”的区别？

> ID：13072494
> 
> 赞同：5
> 
> 时间：2012-10-25T15:54:34.580
> 
> 标签：ruby

`glob`以下是递归列出目录的两种方法：

`Dir.glob("**/*/")`

`Dir.glob("**/")`

输出看起来是一样的，至少对于一个小的子树来说。我错过的这两个命令之间有区别吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:02:11.533

** 匹配 0 个或多个目录。通过在末尾放置一个 *，您可以删除根目录中的目录，实质上使其成为 1 个或更多：

```
 a = Dir.glob('/tmp/**/*/').sort     
 b = Dir.glob('/tmp/**/').sort.size
 b.size => 19
 a.size => 18
 b - a =>  ["/tmp/"] 
```

但是，如果没有前导常量路径，看起来没有区别，因为 0 长度匹配并不有趣，也不会被放入结果中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:14:12.073

在那种情况下，没有。

但是，在某些情况下，这种类型的区别可能很重要。如果模式改为递归匹配文件`**/*`而`**/*/*`不是目录，则第一个将包含当前目录中的文件，而后者将仅列出比当前目录至少低一级的文件，因为`/*/`中间必须匹配某物。

# asp.net - 手动将页面 META 标记分配给 asp.net 动态页面

> ID：13072495
> 
> 赞同：2
> 
> 时间：2012-10-25T15:54:37.157
> 
> 标签：asp.net, dotnetnuke

我只想说，感谢您花时间阅读本文！

我有一个运行内容管理系统 DotNetNuke 的电子商务网站，我相信它是在 windows 服务器环境中的 asp.net 平台上构建的。当用户浏览可用产品时，为我的电子商务商店提供动力的特定模块会为每个商店类别动态生成页面。您可能知道，诸如此类的模块必须放置在特定页面上，并且模块生成的所有动态内容都必须驻留在该“父页面”上。

问题是，虽然该模块允许我在这些动态页面上添加 H1 和 H2 的 HTML 文本，但它不支持添加页面元标记，例如“标题”和“描述”。结果，该模块生成的所有动态页面都从父页面中提取了它们的元标记，这使得 Google 很难理解我要向用户展示的内容。这也导致谷歌在我的分析中将所有这些生成的页面显示为具有“重复的标题标签”。

临时修复：我已经从所有这些“父页面”中删除了标题标签，希望谷歌决定从动态页面上的 H1 和 H2 标签生成它的片段。这是明智的吗？

**现在的问题是：是否有任何可用的解决方案允许我手动将元标记分配给我在托管环境中指定的页面？如前所述，我能够将正文 HTML 代码添加到页面。有没有办法从放置在正文中的代码中强制页面标题标签？有一个更好的方法吗？您可以在 www.yandasmusic.com 查看我的问题**

感谢您的时间和耐心！亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T03:19:44.110

> 临时修复：我已经从所有这些“父页面”中删除了标题标签，希望谷歌决定从动态页面上的 H1 和 H2 标签生成它的片段。这是明智的吗？块引用

不，不是特别聪明。页面标题很重要。

您应该采取的第一条路线是与模块开发人员交谈。他们应该知道基于每个产品替换页面元信息。

您可以通过在页面加载时使用 javascript 更改页面标题/描述来获得（有限的）结果。保持js简单，使用页面上已有的DOM信息（即读取产品名称）。

我最近发布了一篇关于此的博客：[http ://www.ifinity.com.au/2012/10/04/Changing_a_Page_Title_with_Javascript_to_update_a_Google_SERP_Entry](http://www.ifinity.com.au/2012/10/04/Changing_a_Page_Title_with_Javascript_to_update_a_Google_SERP_Entry)

如果您设置正确，javascript 修复可能会起作用。但是您确实需要说服模块开发人员改变模块的工作方式，正如 bdukes 所发布的那样。

不要打扰元标签——没有一个搜索引擎真正阅读/使用它们，因为它们很容易被欺骗。只关注页面的标题和描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:05:19.687

理想情况下，您的商店模块应该设置页面标题和其他元信息。在 DotNetNuke 中，您可以通过转换类型来访问页面的`Title`、`MetaDescription`和。如果商店模块不提供此功能，则应要求开发人员添加该功能。`MetaKeywords``Page``DotNetNuke.Framework.CDefault`

# json - ATLANTBH jmeter-components：JSON 路径断言

> ID：13072497
> 
> 赞同：7
> 
> 时间：2012-10-25T15:54:43.523
> 
> 标签：json, jmeter, jsonpath, jmeter-plugins

我正在尝试使用[ATLANTBH](https://github.com/ATLANTBH/jmeter-components) jmeter JSON PATH 断言执行 JSON 断言。
但是，我似乎无法编写正确的表达式来从下面发布的 JSON 提要中获取以下字段：

1.  123456789
2.  1009
3.  一些随机消息

    ```
    {"api": {"status":"Success","callsremaining":36,"version":"x.x.x.x"}
    ,"result":{"errors":{"123456789":{"code":1009,"error":"SOME RANDOM MESSAGE"}}}
    } 
    ```

这里有人有使用这个 JMeter 插件的经验吗？
我知道我可以使用`regex`并`Beanshell`进行验证，但我宁愿使用这些 JSON 路径断言。

您能提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T11:47:16.560

看起来您可以使用 JSONPath 表达式（在 JSON Path Assertion 组件中）轻松地断言两者`1009`和`SOME RANDOM MESSAGE`值，但不确定`123456789`：这不是节点值而是波特名称，并且这些组件使用的 JSONPath 实现似乎没有表达式来获取节点名称。

假设您可以轻松地使用`123456789`jmeter 的标准[Response_Assertion](http://jmeter.apache.org/usermanual/component_reference.html#Response_Assertion)断言而不是绑定 JSON 路径提取器（来自相同的组件集合） 。

1.  将 2 个 JSON 路径断言作为子项添加到返回要处理的 json 响应的采样器中：

    ![在此处输入图像描述](../Images/07f93116157f25b0e0ac24f3d09fda6f.png)

    ![在此处输入图像描述](../Images/de0ff1011c3f18c4e3b413009417d2b5.png)

    表达式将是`$.result.errors..code`和`$.result.errors..error`相应的。

2.  将 JSON 路径提取器作为子项添加到同一采样器以提取完整的错误条目：

    ![在此处输入图像描述](../Images/e4a4b7558db5f9773752c20876ba7a0f.png)

    表达：`$.result.errors.`。
    这将提取`{"123456789":{"error":"SOME RANDOM MESSAGE","code":1009}}`并保存到指向变量 ( `${errorKey}`) 中。

3.  在先前添加 JSON 路径提取器之后，将 Response Assertion 作为子项添加到同一采样器：

    ![在此处输入图像描述](../Images/be3c9021312885bde32c7977f7795810.png)

    这将在变量的值中断言键 ( `123456789`) 的名称。`${errorKey}`

* * *

所以最终的构造可能看起来像

```
...
YOUR Sampler
    JSON Path Extractor
    JSON Path Assertion
    JSON Path Assertion
    Response Assertion
... 
```

# spring - 在 STS 3.1 的 Spring Data JpaRepository 接口中到处出现“无效的派生查询”错误

> ID：13072502
> 
> 赞同：24
> 
> 时间：2012-10-25T15:55:01.007
> 
> 标签：spring, spring-mvc, sts-springsourcetoolsuite, spring-data, spring-data-jpa

我们已经完全按照 Spring Data 文档中的演示实现了我们的存储库。在我们从 STS 2.9 升级到 STS 3.1 之前，一切都很好。所有试图让这些错误消失的尝试都失败了，在某些情况下甚至没有意义！它们与界面或使用的实体中的任何属性都不匹配！

这是一个例子：

```
public interface CreditNotesRepository extends JpaRepository<CreditNotes, Long> {

    CreditNotes findCurrentCreditNotes(Long shipmentDetailId);
} 
```

这`findCurrentCreditNotes`是我们实体中的命名查询。这段代码执行得非常好。

```
@NamedQueries({
    @NamedQuery(name = "CreditNotes.getCount", query = "SELECT COUNT(f) FROM CreditNotes f"),
    @NamedQuery(name = "CreditNotes.findCurrentCreditNotes", query =
        "SELECT creditNotes FROM CreditNotes creditNotes"
        + " WHERE creditNotes.shipmentDetail.shipmentDetailId = ?1 "
        + " AND creditNotes.notesSeqNumber =  (SELECT max(creditNotes2.notesSeqNumber) FROM CreditNotes creditNotes2"
        + " WHERE creditNotes.shipmentDetail.shipmentDetailId = creditNotes2.shipmentDetail.shipmentDetailId)")
}) 
```

我们得到的错误是：

```
Invalid derived query! No property find found for type ca.cole.freight.model.CreditNotes 
```

虽然这只是一个标志（不影响编译），但它很烦人且令人困惑。任何人都可以对此有所了解吗？像我6岁一样向我解释！;)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-04-16T16:39:07.420

在 Spring 论坛的[帖子](http://forum.spring.io/forum/spring-projects/springsource-tool-suite/128352-invalid-derived-query-no-property-delete-found-for-type-java-lang-object)中，Spring Team 宣布

> 它已经为 STS 3.3.0 修复

我还没有检查这个版本。但我正在使用 3.5.0.RELEASE 问题又回来了！我的解决方法是取消选中**Invalid Derived Query**

![无效的派生查询](../Images/d280eded757138fcd9bd18ef458acb68.png)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-08-28T19:58:55.987

这是以下帖子中解释的 IDE 错误：

[http://forum.springsource.org/showthread.php?138585-Invalid-derived-query!-No-property-delete-found-for-type-java-lang-Object](http://forum.springsource.org/showthread.php?138585-Invalid-derived-query!-No-property-delete-found-for-type-java-lang-Object)

*同时，您可以在首选项/弹簧/项目验证器/数据验证器*中关闭验证， 取消选中**无效派生查询**，STS 不会再抛出标记。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-02-01T11:56:19.200

也有解决方法。`@Query`在未定义 JPQL/SQL 查询的情况下，在您的存储库中为您的方法定义添加注释。

这是示例：

```
@Query
List<OwnerModel> findByFirstNameAndAgeNotZero(@Param(value = "firstName") String firstName); 
```

`OrderModel.findByFirstNameAndAgeNotZero`在这种情况下，将使用命名查询。您的 Eclipse 错误`Invalid derived query`也应该消失，而无需禁用验证，如@Tuan Dang 所述

在 Eclipse 4.5.1 上检查了安装了 Spring 插件的`@NamedQuery`和`@NamedNativeQuery`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T02:20:39.590

我自己刚刚经历过这个。不幸的是，Spring Data 的实现在 1.1 和 1.2 之间发生了变化。它不再支持`<repository>`XML 声明。您可以设置自定义后缀，但默认情况下，它需要一个 class name 的 bean `<InterfaceName>Impl`。如果它找不到自定义存储库实现，您就会开始遇到与您遇到的错误类似的错误。它试图创建方法来根据界面中的方法名称查询对象。

另一种方法是将 Spring Data 版本降到 1.1 并`http://www.springframework.org/schema/data/jpa/spring-jpa-1.1.xsd`在 XML 中指定模式位置。

# sql-server - 同一列上存在 PK 和 UQ 索引时 SQL Server 中的性能

> ID：13072505
> 
> 赞同：3
> 
> 时间：2012-10-25T15:55:16.783
> 
> 标签：sql-server, indexing

在 SQL Server 2005 中，我遇到了一个带有唯一 ID 列（上面有唯一索引）和主键聚集索引的表（所以这个列上有明确的 2 个索引）。这是在此表上插入/更新/删除的主要性能因素吗？

我正在尝试提高很久以前创建的数据库的性能，我想知道删除这些冗余的唯一索引是否会有所帮助。数据库是否在每次内容修改时检查/重建这两个索引？或者性能增益会不会太小以至于不能为此烦恼？

这是一个示例索引使用输出：

```
INDEX   UserSeeks    UserScans  UserLookups UserUpdates
--------------------------------------------------------
1_PK    45517046      42911     245353       0
1_UQ    45517046      42911     245353       0
1_Other 45517046      42911     245353       0   
--------------------------------------------------------
2_PK    21538111      5685      231030      1121
2_UQ    21538111      5685      231030      1121
3_other 21538111      5685      231030      1121 
```

这是我用来获取该数据的查询：

```
SELECT OBJECT_NAME(I.OBJECT_ID) AS ObjectName,
   I.NAME AS IndexName,
   S.user_seeks AS UserSeeks,
   S.user_scans AS UserScans,
   S.user_lookups AS UserLookups,
   S.user_updates AS UserUpdates
FROM sys.indexes I 
JOIN sys.dm_db_index_usage_stats S
  ON (S.OBJECT_ID = I.OBJECT_ID)
WHERE(database_id = DB_ID()) 
```

并固定加入条件：

```
SELECT OBJECT_NAME(I.OBJECT_ID) AS ObjectName,
   I.NAME AS IndexName,
   S.user_seeks AS UserSeeks,
   S.user_scans AS UserScans,
   S.user_lookups AS UserLookups,
   S.user_updates AS UserUpdates
FROM sys.indexes I 
JOIN sys.dm_db_index_usage_stats S
  ON (S.OBJECT_ID = I.OBJECT_ID)
  AND(S.index_id = I.index_id)
WHERE(database_id = DB_ID()) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:11:58.050

这可能不是冗余索引。

有一个更窄的仅包含`ID`s 的非聚集索引很可能已作为一种有意的策略放在那里，以使某些查询受益和/或使外键验证更有效。

我在这里的回答中建议采用这种方法（成功地）[解决](https://stackoverflow.com/a/7285041/73226)OP 遇到的死锁问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:10:13.663

索引通常以更新/插入/删除性能换取更好的选择性能。这几乎总是一件好事。

> 数据库是否在每次内容修改时检查/重建这两个索引？

它必须，否则索引将过期，并返回错误的结果。

> 或者性能增益会不会太小以至于不能为此烦恼？

这取决于桌子上的活动。

唯一约束也有一个功能：它使列保持唯一。由于没有索引就不能拥有唯一约束，因此在您的情况下，删除它似乎不是一个选项。

# python - 正则表达式空格、括号和括号

> ID：13072512
> 
> 赞同：0
> 
> 时间：2012-10-25T15:55:44.247
> 
> 标签：python, regex

我正在尝试匹配以下形式的字符串：

```
require([ "foo/bar", "foo2/bar2" ]) 
```

应该完全忽略空格。我正在使用以下正则表达式但收效甚微：

```
require\\(\s*\\[[.\s]*\\]\\) 
```

有什么建议么？我知道正则表达式尝试是可怕的......

**编辑：**我正在使用 Python！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:59:35.433

如果您使用带有双引号字符串或类似字符串的 Java 或 PHP，则还需要对它们进行双重转义`\s`。如果不是，那么您需要删除所有双反斜杠（并使它们成为单反斜杠）。另请注意，`[.\s]`仅匹配句点和空格（`.`在字符类中失去通配符含义）。如果您真的想匹配**任何东西**，请改用`[\s\S]`。

假设您使用的语言需要双重转义：

```
require\\(\\s*\\[[\\S\\s]*\\]\\) 
```

请注意，如果这在同一个字符串中多次发生，这将导致问题。然后你会得到一个从 first`require([`到 last的匹配`])`。为避免这种情况，`]`请在重复中禁止。`require`但是，请注意，如果您的字符串可能包含自己，这反过来可能会导致问题`]`：

```
require\\(\\s*\\[[^]]*\\]\\) 
```

# mongodb - MongoDB/PyMongo 不会 $set 属性到文档 - 但设置所有其他属性！（奇怪的错误）

> ID：13072514
> 
> 赞同：3
> 
> 时间：2012-10-25T15:55:44.797
> 
> 标签：mongodb, pymongo, defaultdict, mongodb-update

我正在尝试将 defaultdict 变量写入 MongoDB 中的文档。其他一切都很好，只是没有这个属性，它很奇怪！我正在设置一个相当大的默认字典，称为“域”，它以前曾多次工作过。查看此终端输出：

所以这是我的默认字典：

```
>>> type(domains) 
<type 'collections.defaultdict'> 
```

它相当大，大约 3mb：

```
>>> sys.getsizeof(domains)
3146008 
```

这是我们将其设置为的文档：

```
>>> db.AggregateResults.find_one({'date':'20110409'}).keys()
[u'res', u'date', u'_id'] 
```

让我们获取该文档的 ID：

```
>>> myID = db.AggregateResults.find_one({'date':'20110409'})['_id']
>>> myID
ObjectId('50870847f49a00509a000000') 
```

太好了，让我们设置属性：

```
>>> db.AggregateResults.update({'_id':myID}, {"$set": {'domains':domains}})
>>> db.AggregateResults.find_one({'date':'20110409'}).keys()
[u'res', u'date', u'_id'] 
```

诶？没救？？

嗯......有什么可以保存的吗？

```
>>> db.AggregateResults.update({'_id':myID}, {"$set": {'myTest':'hello world'}})
>>> db.AggregateResults.find_one({'date':'20110409'}).keys()
[u'myTest', u'res', u'date', u'_id'] 
```

好的...所以它可以很好地保存东西...也许是因为 MongoDB 不喜欢 defaultdicts？咱们试试吧：

```
>>> myDD = defaultdict(int)
>>> myDD['test'] = 1
>>> myDD
defaultdict(<type 'int'>, {'test': 1})
>>> db.AggregateResults.update({'_id':myID}, {"$set": {'myDD':myDD}})
>>> db.AggregateResults.find_one({'date':'20110409'}).keys()
[u'myTest', u'res', u'date', u'myDD', u'_id'] 
```

所以它可以很好地保存defaultdicts，只是不是这个？

这么奇怪！任何想法为什么？

编辑安全=真：

```
>>> db.AggregateResults.update({'_id':myID}, {"$set": {'domains':domains}}, safe=True)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib64/python2.6/site-packages/pymongo-2.1.1_-py2.6-linux-x86_64.egg/pymongo/collection.py", line 405, in update
    _check_keys, self.__uuid_subtype), safe)
  File "/usr/lib64/python2.6/site-packages/pymongo-2.1.1_-py2.6-linux-x86_64.egg/pymongo/connection.py", line 796, in _send_message
    return self.__check_response_to_last_error(response)
  File "/usr/lib64/python2.6/site-packages/pymongo-2.1.1_-py2.6-linux-x86_64.egg/pymongo/connection.py", line 746, in __check_response_to_last_error
    raise OperationFailure(error["err"], error["code"])
pymongo.errors.OperationFailure: not okForStorage 
```

[这个 GoogleGroup 讨论](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/9qUaTWHkojM)说这可能是由于键中有句号，但是：

```
>>> [x for x in domains.keys() if '.' in x]
[] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T19:22:53.717

啊哈！找到了！

MongoDB 中的键不仅不能有 '.'，它们也不能有 '$'。

看：

```
>>>[x for x in domains.keys() if '$' in x]
['$some_key_'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:05:29.997

我的猜测是您正在尝试保存太大的文档。MongoDB 对其所有文档都规定了 16MB 的最大大小。

尝试使用参数运行更新命令`safe=True`。这将在安全模式下运行，这将指示数据库发回尝试插入的结果。

# sql - 在表中查找最后一个（第一个）实例，但排除最近（最旧）日期

> ID：13072515
> 
> 赞同：1
> 
> 时间：2012-10-25T15:55:49.397
> 
> 标签：sql

我有一张表格，反映了某个人口的每月人口普查。每个月在该月初的一个不可预测的日子，都会对人口进行民意调查。在那个时候存在的任何成员都包含在该月的民意调查中，任何不存在的成员都不是。

我的任务是查看任意日期范围并确定在该时间段内添加或丢失了哪些成员。考虑样本表：

```
ID | Date
2  | 1/3/2010
3  | 1/3/2010
1  | 2/5/2010
2  | 2/5/2010
3  | 2/5/2010
1  | 3/3/2010
3  | 3/3/2010 
```

在这种情况下，ID 为“1”的成员在 1 月和 2 月之间添加，而 ID 为 2 的成员在 2 月和 3 月之间丢失。

我遇到的问题是，如果我只是轮询以尝试查找最新条目，我将捕获所有已删除的成员，以及最后日期存在的所有成员。例如，我可以运行这个查询：

```
SELECT
  ID,
  Max(Date)
FROM
  tableName
WHERE
  Date BETWEEN '1/1/2010' AND '3/27/2010'
GROUP BY
  ID 
```

这将返回：

```
ID  | Date
1   | 3/3/2010
2   | 2/5/2010
3   | 3/3/2010 
```

然而，我真正想要的只是：

```
ID  | Date
2   | 2/5/2010 
```

当然我可以手动过滤掉最后一个日期，但是由于开始和结束日期是我想概括的参数。一种方法是运行顺序查询。在第一个查询中，我会找到最后一个日期，然后在第二个查询中使用它来过滤。但是，如果我可以将此逻辑包装到单个查询中，那将真的很有帮助。

当我尝试查找成员首次添加到人口中时，我也遇到了相关问题。在这种情况下，我使用不同类型的查询：

```
SELECT
  ID,
  Date
FROM
  tableName i
WHERE
  Date BETWEEN '1/1/2010' AND '3/27/2010'
 AND
  NOT EXISTS(
    SELECT
      ID,
      Date
    FROM
      tableName ii
    WHERE
      ii.ID=i.ID
     AND
      ii.Date < i.Date
     AND
      Date BETWEEN '1/1/2010' AND '3/27/2010'
  ) 
```

这将返回：

```
ID  | Date
1   | 2/5/2010
2   | 1/1/2010
3   | 1/1/2010 
```

但我想要的是：

```
ID  | Date
1   | 2/5/2010 
```

我想知道：1.哪种方法（MAX() 或不存在的子查询）更有效，2.如何修复查询，以便它们只返回我想要的行，不包括第一个（最后一个）日期.

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:14:33.913

你可以这样做：

```
SELECT
  ID,
  Max(Date)
FROM
  tableName
WHERE
  Date BETWEEN '1/1/2010' AND '3/27/2010'
GROUP BY
  ID
having max(date) < '3/1/2010' 
```

这会过滤掉三月份接受调查的任何人。

# json - 为什么使用 GZIPContentEncodingFilter 时我的响应没有被压缩

> ID：13072519
> 
> 赞同：0
> 
> 时间：2012-10-25T15:55:54.797
> 
> 标签：json, rest, jersey, gzip

我有一个 REST 方法，我想在其中输出 gzip 压缩的内容。我已经添加了

```
 <init-param>
         <param-name>com.sun.jersey.spi.container.ContainerResponseFilters</param-name>
         <param-value>com.sun.jersey.api.container.filter.GZIPContentEncodingFilter</param-value>
     </init-param> 
```

到 web.xml 中的 servlet

我可以看到代码通过调试通过 GZIPContentEncodingFilter 类，但输出没有得到 .gzip 前缀并且内容没有被压缩，而是正常的 json。我正在使用泽西岛 1.14。

方法如下：

```
@GET
    @Path("/fundlight")
    @Produces(MediaType.APPLICATION_JSON)
    public Response getFundLightList() {

        StopWatch watch = new StopWatch();
        watch.start();

        Collection<Object> objectResults = null;

        objectResults = getCacheMap("FundLight").values();
        List<FundLight> fundLightList = new ArrayList(objectResults);

        watch.stop();

        GenericEntity<List<FundLight>> entity = new GenericEntity<List<FundLight>>(fundLightList) {
        };

         ResponseBuilder builder = Response.ok(entity);
         return builder.build();

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T10:33:47.180

我认为这取决于客户端请求标头参数。
如果请求包含**包含“gzip”的 Accept-Encoding 标头，** 则使用 gzip 压缩响应实体（如果有）并将“gzip”的 Content-Encoding 标头添加到响应中。

请参阅：http: [//jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/container/filter/GZIPContentEncodingFilter.html](http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/api/container/filter/GZIPContentEncodingFilter.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T12:15:57.023

最简单的方法是注册 GZIPEncoder 和 EncodingFilter：

```
public class MyApplication extends Application {
    @Override
    public Set<Class<?>> getClasses() {
        final Set<Class<?>> classes = new HashSet<>();

        classes.add(GZipEncoder.class); // this allows gzipped requests and responses
        classes.add(EncodingFilter.class); // this enables any registered encoders

        return classes;
    }
} 
```

现在您的服务器端可以使用“Content-Encoding:gzip”处理请求，并在客户端请求的标头具有“Accept-Encoding:gzip”时响应 gzip。

您还可以通过配置告诉您的 tomcat/apache/whatever 响应压缩。例如。在 server.xml 的连接器（Tomcat 7）中压缩 =“on”。

# r - 使用 ggplot2 使用 R 绘制各种案例

> ID：13072520
> 
> 赞同：1
> 
> 时间：2012-10-25T15:55:57.840
> 
> 标签：r, ggplot2

我正在尝试为我的公司可视化健康保险福利选项，以帮助其他人做出决定。我有一张这样的桌子：

```
| plan |        ded |  oop | exp_oop |
|------+------------+------+---------|
|    a |        400 | 2100 | 17400   |
|    b |       1300 | 2600 | 14300   |
|    c |       2600 | 5200 | 28600   | 
```

*   `ded`= 免赔额；90% 共同保险的费用水平
*   `oop`= 最高金额
*   `exp_oop``oop`=达到的医疗费用金额

我想绘制员工的成本与产生的医疗费用。健康保险的工作范围...

```
cost = expenses for 0 < expenses < ded
cost = deductible + (0.10 x (expenses - ded)) for ded <= expenses < exp_oop
cost = oop for oop <= expenses <= infinity 
```

我如何绘制每个范围？基本上，每个计划的免赔额都有一条斜率 = 1 的线，然后从 x = 免赔额到 x = oop 的斜率 = 0.1 的线，然后从 oop 向上的斜率 = 0 的线。

我不确定如何有条件地使用 ggplot2 进行绘图。如果您想使用上述内容，以下是这些截止值的可重现代码：

```
dat <- data.frame(plan = c("a", "b", "c"), ded = c(400, 1300, 2600), oop = c(2100, 2600, 5200), exp_oop = c(17400, 14300, 28600)) 
```

我必须自己创建 x/y 值吗？换句话说，像这样的中间表？

```
| plan |     x |    y |
|------+-------+------|
|    1 |     0 |    0 |
|    1 |   400 |  400 |
|    1 | 17400 | 2100 |
|    2 |     0 |    0 |
|    2 |  1300 | 1300 |
|    2 | 14300 | 2600 |
|    3 |     0 |    0 |
|    3 |  2600 | 2600 |
|    3 | 28600 | 5200 | 
```

我正在为几个变体（仅限员工，员工+配偶等）这样做，所以如果我不需要为每个计划单独的数据表，但可以使用已经定义的免赔额和自付费用最大值，那就太好了我已经在数据框中拥有的值...

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:18:00.750

编写一个向量化函数来计算员工的成本作为发生费用的函数。它必须被矢量化，以便您可以将其提供给`ddply`.

```
costFinder <- function(df, oopActual) {
  #df is your 'dat'; we will throw away exp_oop
  #oopActual should be a vector; it is the x axis of your plot
  ded <- df$ded
  oopMax <- df$oop
  cost <- rep(NA, length(oopActual)) #preallocating with NAs will help ID mistakes
  cost[oopActual<ded] <- oopActual[oopActual<ded]
  cost[ded <= oopActual & oopActual < oopMax] <- 0.1 * (oopActual[ded <= oopActual & oopActual < oopMax] - ded) + ded
  cost[oopMax <= oopActual] <- oopMax
  return(cost)
} 
```

然后定义一个`expense`序列（不要太多数据点，否则计算量会很大），并为每个计划计算每个费用值的实际自付费用：

```
expense <- seq(0, 50000, by=200)
allCosts <- ddply(dat, .(plan), costFinder, expense)
names(allCosts)[2:ncol(allCosts)] <- expense 
```

现在融化矢量，以便您可以将其与`ggplot`. 在这里，我使用了用数值重命名 allCosts 数据框的列的阴暗技巧。这可能是一个坏主意，我很想看到一个更好的方法来做到这一点。

```
costsM <- melt(allCosts, id.vars="plan") 
names(costsM)[2:3] <- c("expense", "actualOOP")
#melt() interprets the column names as a factor. We have to turn them back into numeric,
#    by turning them into characters first and then numerics.
costsM$expense <- as.character(costsM$expense)
costsM$expense <- as.numeric(costsM$expense)

#Plot the data
p <- ggplot() + geom_line(data=costsM, aes(x=expense, y=actualOOP, colour=plan))
print(p) 
```

![在此处输入图像描述](../Images/df16ca3205e88f8c7e37d9c7a83d0b06.png)

```
#Add vertical lines for the expected OOP, if you like - arguably it makes things more confusing.
p + geom_vline(data=dat, aes(xintercept=exp_oop, colour=plan)) 
```

![在此处输入图像描述](../Images/1db432526b1d20673e07183469035b35.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T19:08:58.750

我的方法基本上遵循[Drew 的](https://stackoverflow.com/a/13074716/892313)方法，只是步骤不同。我从一个函数开始，它接受`plan`、`ded`、`oop`和`exp_oop`并返回一个函数，该函数给出给定费用的成本（基于这些参数）。[注意：我假设第二层和第三层之间的中断是`exp_oop`，而不是`oop`问题中最初说明的那样。]

```
cost_generator <- function(ded, oop, exp_oop, ...) {
  function(expenses) {
    ifelse(expenses < ded, 
           expenses, 
           ifelse(expenses < exp_oop, 
                  ded + (0.1 * (expenses-ded)),
                  oop))
  }
} 
```

现在使用`plyr`，我可以创建一个函数列表，将费用映射到成本，每个计划一个

```
library("plyr")
funs <- mlply(dat, cost_generator) 
```

对于每个功能，确定给定费用范围的成本。在这里，我选择了从 0 到 50,000 美元的范围，以 100 美元为增量。

```
pts <- ldply(funs, function(f) {
  expenses <- seq(0, 50000, 100)
  data.frame(expenses=expenses, cost=f(expenses))
}) 
```

这给出了一个易于绘制的长格式数据框。

```
library("ggplot2")
ggplot(pts, aes(expenses, cost, colour=plan)) +
  geom_line() 
```

![在此处输入图像描述](../Images/c96c6fe516984eca929ae267ef52790f.png)

当然，这并不是真正的成本，而是为给定的费用水平自掏腰包支付的金额。总成本将包括额外的东西（至少保费）。

编辑：

如果您想确保包含每个更改点（不依赖四舍五入到最接近的 100 美元），您可以从中提取点`dat`并使用这些点：

```
library("reshape2")
exps <- melt(dat, id.var="plan")$value
exps <- c(0, exps, 1.1*max(exps))

pts <- ldply(funs, function(f) {
  data.frame(expenses=exps, cost=f(exps))
}) 
```

我添加了 0 和大于表中最大值的值，以使结果合理。

![在此处输入图像描述](../Images/a0708eab507fe68d6a1e9c6fb5b978db.png)

# jquery - Bootstrap 将 jQuery addClass/removeClass 折叠到仅被点击的那个

> ID：13072521
> 
> 赞同：0
> 
> 时间：2012-10-25T15:55:58.387
> 
> 标签：jquery, twitter-bootstrap

部分问题是我不确定如何表达我想要的......

这是我的 jQuery

```
$(".view-bio").click(function(){
if($("h2 a").hasClass("collapsed")) {
    $("h2 a").removeClass("collapsed");
} else {
    $("h2 a").addClass("collapsed");
}
}); 
```

我有一个在 WordPress 中生成的无序列表。一切正常，除了单击时，它正在从所有列表项中添加/删除类 - 而不仅仅是单击的那个。

请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:54:07.943

在这里试试这个 jsFiddle：http: [//jsfiddle.net/kakashi/FsLax/](http://jsfiddle.net/kakashi/FsLax/)

问题是您正在选择所有链接，而不是单击的链接。

在 jsFiddle 中查看我的示例代码；我`$(this)`用来引用触发点击事件的元素，并`collapsed`仅在该特定元素上切换类。

编辑：这是我使用的代码：

```
$('h2 a').click(function() {
    $(this).toggleClass('collapsed');
}); 
```

希望这可以帮助。

# sas - 使用SAS在字符串中添加连字符？

> ID：13072523
> 
> 赞同：1
> 
> 时间：2012-10-25T15:56:00.903
> 
> 标签：sas

当我将数字变量转换为字符变量时，我想在电话号码之间添加连字符。

例如：原来是**7819601330（数字）**，需要是**781-960-1330（字符）**

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T16:03:08.927

图片格式！

```
proc format;
picture phone
low-high="000-000-0000";
quit;

data test;
x=1234567890;
y=put(x,PHONE.);
put x= y=;
run; 
```

# c++ - 对包含对象的向量的元素进行排序

> ID：13072530
> 
> 赞同：0
> 
> 时间：2012-10-25T15:56:33.860
> 
> 标签：c++, sorting, vector

我有课，这个课包含一个数字。我有一个向量包含类的对象指针。我想根据它们的数量对这些对象进行排序。我怎样才能做到这一点？感谢您的回答。

```
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

class Course
{
public:
    Course (int code, string const& name) : name(n), code(c) {}
    int getCourseCode() const { return code; }
    string const& getName() const { return name; }

private:
    string name;
    int code;
};

int main()
{
    vector<Course*> cor;
    vector<Course*>::iterator itcor;

    cor.push_back(new Course(3,"first"));
    cor.push_back(new Course(2,"sekond"));
    cor.push_back(new Course(4,"third"));
    cor.push_back(new Course(1,"fourth"));
    cor.push_back(new Course(5,"fifth"));  
    sort (cor.begin(), cor.end());
    for (itcor=cor.begin(); itcor!=cor.end(); ++itcor) {
        cout << *itcor << ' ';
    }
} 
```

例如，当我想要根据它们的地址对对象进行排序时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:57:48.330

您需要为该`std::sort`方法提供一个自定义比较器类或函数，以使其不按地址排序。

```
template <class RandomAccessIterator, class Compare>
void sort ( RandomAccessIterator first, RandomAccessIterator last, Compare comp ); 
```

其中`comp`可以定义为：

```
bool comparer(const Course* x, const Course* y) { /*compare*/ }
//or
struct comparer {
  bool operator() (const Course* x, const Course* y) { /*compare*/ }
} comparerObject; 
```

并将排序称为：

```
std::sort(cor.begin(), cor.end(), comparer);   //method alternative 
```

或者

```
std::sort(cor.begin(), cor.end(), comparerObject);   //class alternative 
```

那，或者不要在`vector`. 从您发布的代码中，尚不清楚您是否真的需要指针：

```
vector<Course> cor; 
```

应该足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:05:06.207

您可以通过三种方式做到这一点：

~~1) 重载 < 运算符，并调用 std::sort 算法。代码将如下所示：~~

```
bool operator<(Course *a, Course *b) const {
  // do comparison
  return A_BOOL_VALUE;
}

std::sort(array_of_courses.begin(),array_of_courses.end()); 
```

第一种方法是错误的，因为您不能在指针中重载 < 运算符。

2) 创建一个比较函数，然后调用第二个版本的`std::sort`. 代码如下所示：

```
bool compare(Course *a,Course *b) {
  // do comparison
  return A_BOOL_VALUE;
}

std::sort(array_of_courses.begin(),array_of_courses.end(),compare); 
```

3）创建一个比较类，它的`()`运算符重载，然后调用`std::sort`. 编码：

```
struct Compare {
  bool operator()(Course *a, Course *b) {
    // do comparison
    return A_BOOL_VALUE;
  }
};

std::sort(array_of_courses.begin(),array_of_courses.end(),Compare); 
```

*注意：*排序函数在`algorithm`头文件中。

# java - Eclipse Juno 中的缓慢 (4.2)

> ID：13072532
> 
> 赞同：6
> 
> 时间：2012-10-25T15:56:38.557
> 
> 标签：java, eclipse, eclipse-pdt, eclipse-juno

我在 Eclipse 4.2 Juno 中遇到了一些切换选项卡速度缓慢的问题，希望有人能得到一些答案。最初的延迟大约是 10 秒，一旦我在 eclipse.ini 文件中指定了 java vm，它就会下降到 2-4 秒，但这仍然比我认为的要慢。我已经卸载了所有我认为可能有问题的插件，并在下面列出了活动的插件，我相信系统已经足够了，但还是列出了规格。感谢您能给我的任何帮助。

**系统：**
Windows 7x64
1.73 Ghz i7
8 GB RAM

**Eclipse 插件：**
Eclipse 颜色主题
PHP 开发工具 (PDT)

**Eclipse.ini：**

```
-vm  
C:\Program Files\Java\jre7\bin\javaw.exe  
-startup  
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar  
--launcher.library  
plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120522-1813  
-showsplash  
org.eclipse.platform  
--launcher.XXMaxPermSize  
512m  
--launcher.defaultAction  
openFile  
-vmargs  
-server  
-Dosgi.requiredJavaVersion=1.7  
-Xmn256m  
-Xms4196m  
-Xmx4196m  
-Xss4m  
-XX:PermSize=256m  
-XX:MaxPermSize=256m  
-XX:+UseParallelGC 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T11:37:49.003

您可以按照此链接上的说明安装 Eclipse UI Juno SR1 优化补丁，前提是您使用的是 Eclipse Juno SR1 版本并且面临这个缓慢问题： [http ://wiki.eclipse.org/Platform_UI/Juno_Performance_Investigation](http://wiki.eclipse.org/Platform_UI/Juno_Performance_Investigation)

由于以上链接内容已更新，不再提供补丁下载部分。因此，对于寻找下载详细信息的其他人，您需要做的就是从更新站点安装 Juno SR1 补丁--Eclipse UI Juno SR1 优化：http: [//download.eclipse.org/eclipse/updates/4.2](http://download.eclipse.org/eclipse/updates/4.2) -using帮助菜单 -> 安装新软件的过程

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T16:07:37.000

Juno 中的 UI 性能存在一些已知问题。[请参阅https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272](https://bugs.eclipse.org/bugs/show_bug.cgi?id=385272)上的冗长讨论

Juno Service Release 2 (SR2) 已经发布，它解决了许多 UI 性能问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T16:03:28.420

更改 java 内存堆大小。查看 -XX:PermSize=256m -XX:MaxPermSize=256m 并更改为 1024m。你去一个链接：[http ://www.jguru.com/faq/view.jsp?EID=424214](http://www.jguru.com/faq/view.jsp?EID=424214)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-25T16:07:26.950

尝试将主题更改为`Classic`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-04T09:38:31.103

我遇到了同样的问题，我升级到**Eclipse Juno 4.2.2**和我的系统：Intel Core 2 Quad Q9550 2.83Ghz 8,00 GB RAM Windows 7 Ultimate x64。我也使用**GIT**。

当我*在我的项目上按下鼠标右键时，我*花了很多时间（约 40 秒）才能做任何事情。

直到我在我的 Linux 服务器（不同的系统）上运行*“git gc” ，结果如下：*

*   *计数对象：6454，完成。*
*   *使用多达 8 个线程的 Delta 压缩。*
*   *压缩对象：100% (5983/5983)，完成。*
*   *写入对象：100% (6454/6454)，完成。*
*   *总计 6454（增量 1785），重复使用 0（增量 0）。*

之后我刷新了我的项目，从那时起*鼠标右键动作*响应是即时的。

我希望这对任何人都有帮助，我只需要与您分享。

我的 Eclipse ini：

```
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.200.v20120913-144807
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-server
-Xmn128m
-Xms2048m
-Xmx2048m 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-07T09:52:26.633

*   禁用不需要的验证 ( `Window -> Preferences -> Validations`)。
*   限制可见验证的数量 ( `Problems View -> Configure Content`)
*   像你一样在 eclipse.ini 中增加 eclipse 的内存
*   [为 git 启用虚拟内存映射](https://stackoverflow.com/a/12120167/510711)
*   [使用经典主题](https://stackoverflow.com/a/13072715/510711)

一起给了我的朱诺一个很大的速度提升:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-18T21:30:42.993

打开 Eclipse，转到 Windows>Close All Perspective 然后确认并让 Eclipse 重新启动。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-19T15:02:23.413

当我尝试在选项卡之间切换时（时间约为 2-3 秒），我的日食非常慢。我以这种方式修改了我的 eclipse.ini，但它不再发生（我的 RAM 是 2GB）：

```
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.1.200.v20120522-1813
-product
com.android.ide.eclipse.adt.package.product
--launcher.XXMaxPermSize
256m
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256M
--launcher.defaultAction
openFile
-vmargs
-Dosgi.requiredJavaVersion=1.6
-Declipse.buildId=v21.0.1-543035
-Xms1024m 
-Xmx1024m 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-27T12:01:06.833

升级到 Eclipse 4.3 给了我巨大的性能提升。

似乎他们在新版本中修复了很多性能错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-20T12:17:14.713

另一个占用过多 CPU 的 Eclipse 错误是由控制台中的正则表达式解析很长的行引起的，请参阅[https://bugs.eclipse.org/bugs/show_bug.cgi?id=175888](https://bugs.eclipse.org/bugs/show_bug.cgi?id=175888)解决方法是不要在 System. 中编写很长的行。出/错。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-10T11:33:31.007

安装 4.3M4 - 他们在那里显着提高了速度，现在我终于从 3.8 切换了 :)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-01-15T16:45:25.973

当我的 Eclipse Juno 导入了很多 Java 项目时，我的 Eclipse Juno 速度非常慢（我说的是 45-50 左右）。我最终做的是：

1.  创建“工作集”以根据“组件”划分项目。
2.  使用“工作集”来确定哪些 Java 项目不需要“打开”。
3.  关闭不必要的项目。

最终结果是 Eclipse 与它应有的一样快速和敏捷。性能接近3.8。

此外，在 Java 或 Debug 透视图中的“Package Explorer”视图中，我将“Top Level Elements”设置为“Working Sets”，以便更清楚地了解我在应用程序中的编码位置。

这种方式搜索结果和“查找类型/查找资源”结果也更快捷。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-20T10:06:40.043

我无法使用维护版本更新我的 Eclipse，但我在 Eclipse 问题跟踪器中找到了一个非官方补丁，这使我的 Eclipse 速度更快。看到这个答案：[https ://stackoverflow.com/a/13470794/337621](https://stackoverflow.com/a/13470794/337621)

# javascript - Facebook登录，重定向到服务器然后应用程序

> ID：13072536
> 
> 赞同：0
> 
> 时间：2012-10-25T15:56:53.917
> 
> 标签：javascript, python, facebook, jquery-mobile

我正在尝试在我的应用程序中通过 FB 登录（使用 jQuery Mobile 编写并使用 phonegap 构建包装）。当我点击链接时，应用程序打开

myserver.com/login

此时服务器（python）调用FB登录函数。用户登录后，FB 将再次重定向到我的服务器，我将在那里做一些事情。

现在，如何从我的服务器重定向回我的应用程序？我试图通过

```
文档.URL
```

到服务器并重定向到那里，但我的手机说我没有权限访问 file://android_asset/www/index.html

感谢任何愿意/能够提供帮助的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T12:18:24.103

使用 childbrowser 插件解决。

在phonegap构建中

[https://build.phonegap.com/docs/plugins](https://build.phonegap.com/docs/plugins)

# c# - 从 arrayList 中获取值

> ID：13072538
> 
> 赞同：3
> 
> 时间：2012-10-25T15:56:58.740
> 
> 标签：c#, arraylist

我正在使用 C#，我正在创建一个名为“importControlKeys”的 ArrayList，它创建得很好。但是，我终其一生都无法找到一种循环遍历 arrayList 并挑选出 ArrayList 中的值以供以后代码使用的方法。

我知道我遗漏了一些简单的东西，但是从 ArrayList 中提取值的语法是什么。我希望它在下面的代码中类似于 importControlKeys[ii].value ，但这不起作用。

我已经在这些板上进行了搜索，但找不到确切的解决方案，尽管我确信这很容易。msot 的解决方案说要重写为 List，但我必须相信有一种方法可以从数组列表中获取数据而无需重写为 List

```
private void button1_Click(object sender, EventArgs e)
        {
            ArrayList importKeyList = new ArrayList();
            List<DataGridViewRow> rows_with_checked_column = new List<DataGridViewRow>();
            foreach (DataGridViewRow row in grd1.Rows) 
            { 
                if (Convert.ToBoolean(row.Cells[Del2.Name].Value) == true)
                { 
                    rows_with_checked_column.Add(row);
                    importKeyList.Add(row.Cells[colImportControlKey.Name].Value);

                    //string importKey = grd1.Rows[grd1.SelectedCells[0].RowIndex].Cells[0].Value.ToString();
                    //grd1.ClearSelection();
                    //if (DeleteImport(importKey))
                    //    LoadGrid();
                }                
            }
            for (int ii = 0; ii < rows_with_checked_column.Count; ii++)
            {
                //grd1.ClearSelection();
                string importKey = importKeyList[ii].value;  //ERRORS OUT

                if (DeleteImport(importKey))
                    LoadGrid();

                // Do what you want with the check rows  
            }

        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T16:02:17.317

不知道你为什么要使用 ArrayList 但如果你需要循环通过它你可以做这样的事情

如果一个元素不能转换为类型，你会得到一个 InvalidCastException。在您的情况下，您不能将 boxed int 转换为导致引发异常的字符串。

```
foreach (object obj in importKeyList ) 
{
    string s = (string)obj;
    // loop body
} 
```

或者你做一个 for 循环

```
for (int intCounter = 0; intCounter < importKeyList.Count; intCounter++)
{
    object obj = importKeyList[intCounter];
    // Something...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:02:08.733

你真的不应该`ArrayList`首先使用 a ，如果你有选择，你应该使用 a `List<T>`。 `ArrayList`自 .NET 2.0 以来已被有效弃用。`List`除了不能或尚未更新的遗留应用程序之外，使用它没有任何优势。首选的原因`List`是，当您将数据存储在 an 中时，`ArrayList`它只是存储为 an `object`，因此 an`object`就是您得到的。您需要将其转换为真正的样子，以便您可以使用它。

在不知道您存储在其中的实际类型的情况下，`ArrayList`我无法告诉您`List`它应该是什么类型，或者您需要将结果转换成什么。

另请注意，您可以使用`foreach`循环而不是`for`循环来遍历列表/数组列表中的所有项目，这通常在语法上更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:01:50.263

你不能调用`.value`你的字符串列表......

所以这：

```
string importKey = importKeyList[ii].value; 
```

应该：

```
string importKey = importKeyList[ii]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T16:00:25.663

好吧，你可以做的是

```
foreach(object o in importKeyList)
{ 
    string importKey = (string)o;
    // ...

} 
```

你可以用`(string)`你需要的任何类型替换

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T16:00:33.897

```
foreach (object o in importKeyList)
{ 
    // Something...
} 
```

或者

```
for (int i = 0; i < importKeyList.Count; i++)
{
    object o = importKeyList[i];
    // Something...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-25T16:03:52.243

只需放下`.value`：

```
string importKey = (string)importKeyList[ii]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-11T09:33:01.993

> for (int Counter = 0; Counter < Key.Count; Counter++)
> 
> {
> 
> 对象 obj = Key[Counter];
> }

# javascript - 从 WinRT JavaScript 应用程序中的文件导入文本

> ID：13072539
> 
> 赞同：0
> 
> 时间：2012-10-25T15:56:59.410
> 
> 标签：javascript, windows-runtime

我正在使用 Visual Studio Express 2012 中的 JavaScript Grid App 模板来构建适用于 Windows 8 的应用程序。在模板中，应用程序中的不同“页面”由名为 groupedItems.html 和 itemDetail.html 的页面模板创建，并且每个页面的内容取自`WinJS.Binding.List`存储在 data.js 文件本身中的 lorem ipsum 文本。

我想做的是用将存储在应用程序包中的文件中的 HTML 内容填充每个列表项，以便导入的内容显示在所选页面模板中，就像现在的示例内容一样。我知道有多种方法可以异步读取文件中的内容，但如果可能的话，我更愿意同步读取，因为所有内容都将存储在应用程序包本身中，我不应该有任何理由应该等待它。

也许最简单的说法是，我正在寻找 PHP`include`语句或 CSS`@import`语句的等效项来将我的内容动态导入模板文件，但我没有找到任何可行的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:22:59.467

找到了：

[WinJS.UI.Fragments.renderCopy 函数](http://msdn.microsoft.com/en-us/library/windows/apps/hh701595.aspx)

[加载 HTML 片段示例](http://code.msdn.microsoft.com/windowsapps/Fragments-91f66b07)

# solr - Solr 多值字段。返回错误值 [B@6ad21538

> ID：13072540
> 
> 赞同：0
> 
> 时间：2012-10-25T15:57:00.393
> 
> 标签：solr

当 solr 在字段中输入一些意想不到的值时，我遇到了问题。

**在 schema.xml**

```
<field name="country_ids" type="string" multiValued="true" stored="true" indexed="true" /> 
```

**在媒体-jdbc.xml**

```
<field column="country_ids" splitBy="\|" /> 
```

并且查询为此字段返回**NULL**或**2|3|8|9|3 。**（所有查询都很大并且运行良好）

当我在浏览器中查询时。

该字段具有奇怪的值：

```
<arr name="country_ids">
    <str>[B@6ad21538</str>
</arr> 
```

我错过了什么？

Solr 3.5 版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:40:24.960

好的！所以我使用这个查询来导入：

```
(select group_concat(distinct mmpc.mediacountry_id separator '|') from media_media_production_countries mmpc where mmpc.media_id=m.id) as country_ids 
```

稍微编辑后，我得到了正确的结果。将其更改为：

```
convert((select group_concat(distinct mmpc.mediacountry_id separator '|') from media_media_production_countries mmpc where mmpc.media_id=m.id) USING latin1) as country_ids 
```

如果你注意到我添加了`conver(**MY_STATEMENT** USING latin1)`

但钢铁无法解释原因。如果有人给我一个解释，我将不胜感激。

# winapi - 如何在 GDI+ 中存储鼠标坐标？

> ID：13072549
> 
> 赞同：0
> 
> 时间：2012-10-25T15:57:27.970
> 
> 标签：winapi, gdi+

我想问一下 POINT 结构是否是存储鼠标坐标的唯一方法？我对这种方式的问题是，当您声明时：

```
POINT ps[20]; 
```

你需要有一个固定大小的数组。如果我需要存储更多积分怎么办？有没有办法让它动态化（当它达到限制时调整自身大小）。我想使用这个数组来获取鼠标坐标，然后在 WM_PAINT: 消息中画线。谢谢

```
case WM_MOUSEMOVE:
{
   pt[i].x=LOWORD(lparam);
   pt[i++].y=HIWORD(lparam);
 --------
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:13:53.303

您将使用 POINT 结构数组。

# jquery - 如何让 jQuery 点击函数在 jPlayer 中播放歌曲？

> ID：13072550
> 
> 赞同：1
> 
> 时间：2012-10-25T15:57:30.683
> 
> 标签：jquery, click, jplayer

是否可以创建一个 jQuery 单击函数来播放 jPlayer 播放列表中的第一首歌曲？

我一直在参考这里的文档：

[http://www.jplayer.org/latest/demo-02-jPlayerPlaylist/](http://www.jplayer.org/latest/demo-02-jPlayerPlaylist/)

并且有一个显示“播放”的链接示例，单击该链接会播放播放列表中的第一首曲目，但我不确定这是如何触发的。

文档稍后引用：

> **play([index:Number]) : 无效**
> 
> 播放播放列表中的项目。如果没有给出参数，则播放当前项目。正索引从播放列表的开头播放项目，而负索引从结尾播放项目。

```
// Examples of usage:
myPlaylist.play(); // Plays the currently selected item
myPlaylist.play(0); // Plays the 1st item
myPlaylist.play(1); // Plays the 2nd item
myPlaylist.play(-1); // Plays the last item 
```

所以我的问题是，这个功能可以通过 jQuery 中的点击功能触发吗？如果可以的话，有人可以就所需的基本语法提出建议吗？

谢谢你。

更新：

为了提供更多上下文和我正在尝试的示例，在头部区域有现有的点击功能，我正在尝试在此处添加播放曲目的指令，例如：

```
<script>
$(document).ready(function(){
$(".open_doors").click(function(){
$("#leftdoor_inner").animate({"left": "-=164px"}, 'slow');
// etc ....
// here is attempt to trigger jPlayer
myPlaylist.play(0); 
});
</script> 
```

这是头部区域中定义的播放列表：

```
<script type="text/javascript">
//<![CDATA[
$(document).ready(function(){
var myPlaylist = new jPlayerPlaylist({
jPlayer: "#jquery_jplayer_1",
cssSelectorAncestor: "#jp_container_1",
verticalVolume: "true",
}, [
{
title:"Cro Magnon Man",
mp3:"http://www.jplayer.org/audio/mp3/TSP-01-Cro_magnon_man.mp3",
oga:"http://www.jplayer.org/audio/ogg/TSP-01-Cro_magnon_man.ogg"
},
{
title:"Your Face",
mp3:"http://www.jplayer.org/audio/mp3/TSP-05-Your_face.mp3",
oga:"http://www.jplayer.org/audio/ogg/TSP-05-Your_face.ogg"
}
], {
swfPath: "js",
supplied: "oga, mp3",
wmode: "window"
});
});
//]]>
</script> 
```

所以这个设置目前不起作用，我不确定我是否在 jQuery click 函数中正确引用了播放列表。

谢谢你。

**更新，解决方案：**

好的，我想出了一个解决方案，我必须在脚本区域中添加代码，以下列方式定义播放列表（见上文）：

```
{
swfPath: "js",
supplied: "oga, mp3",
wmode: "window"
});
$(".open_doors").click(function() {
myPlaylist.play(0);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:02:53.147

这似乎是一个太简单的答案，所以如果我遗漏了什么，请原谅我，但你有没有尝试过这种事情？（用适合您用例的选择器替换“元素”。）

```
$("element").click(function(){
    myPlaylist.play(0);
}); 
```

# javascript - JavaScript 获取 HTML 表格对象的边框样式

> ID：13072551
> 
> 赞同：0
> 
> 时间：2012-10-25T15:57:45.083
> 
> 标签：javascript, css

我正在编写一些将表格包装在 div 中的 JavaScript。我想为 div 元素赋予与源表相同的边框样式。

我应该能够以编程方式查询 DOM 中的表格并获取它的边框设置，但是当我在运行时检查表格样式对象的属性时，它们是空字符串。

我将如何复制现有元素的样式设置？

提前致谢。

编辑：源代码

* * *

HTML 测试代码

```
 <table id="tbWorking" class="tbTest">
            <tr class="trTest">
                <th class="tdTest">Col1</th>
                <th class="tdTest">Col2</th>
            </tr>  
            <tr class="trTest">
                <td class="tdTest">a</td>
                <td class="tdTest">b</td>
            </tr>
            <tr class="trTest">
                <td class="tdTest">c</td>
                <td class="tdTest">d</td>
            </tr>
            <tr class="trTest">
                <td class="tdTest">e</td>
            </tr>        
        </table>

        <script type="text/javascript" src="TempTestingTables.js"></script> 
```

* * *

CSS 类

```
 .tbTest
    {
        empty-cells: show;    
        border-collapse:separate; /* Table and Cell borders are unique */

        border-width:1px;
        border-style:solid;
        border-color:Navy;

        background-color:#DDDDDD; /* Colour of gaps between cells */
        color:Black; /* Text colour */
    }

    .trTest
    {
        background-color:#DAD7FA;
    }

    .tdTest
    {
        padding:150px;

        border-color:#7D72FC;
        border-width:1px;
        border-style:solid;    
    } 
```

* * *

页面本地的 JavaScript

```
 // Set a custom flag to indicate that the document has not yet loaded
    onLoad.loaded = false;
    // Register a function on the window object that sets the flag true when the document is loaded
    onLoad(function () { onLoad.loaded = true; });
    // This should then allow the FC function addEvent() to browser-agnostically 
    // register handlers for controls on startup

    // Once the page has loaded, set the background colour of the order ticket
    // based on the Buy/Sell selection
    onLoad(prepareTables());

    function prepareTables() {
        // Function to prepare the tables are scrollable
        prepTable("tbWorking",2);
    }

    function prepTable(sTable, rowsToShow) {

        // Pass in a table, and the number of data rows, not including the header, to display

        var tableSource = document.getElementById(sTable);
        if (tableSource == null) { return; }

        var rowHeight = GetTableRowHeight(sTable);

        var countRows = tableSource.rows.length;
        if (countRows == null || countRows == 0)
            return;

        // There is at least one row

        // Copy the table
        var tableCopy = tableSource.cloneNode(true);
        tableCopy.id = sTable + "_header";

        // Delete all except the first row
        var i = 1;
        for(;i < countRows;++i)
        { tableCopy.deleteRow(1); }

        // Insert the copy above the source table
        (tableSource.parentNode).insertBefore(tableCopy, tableSource);

        // Get the height of the header for later when we need to account for it in the wrapper tableDiv element
        var heightHeader = tableCopy.offsetHeight;

        // Move top row to the end of the table
        var rowHeaderCopy = tableCopy.rows[0].cloneNode(true); // copy the row
        rowHeaderCopy.style.visibility = "hidden"; // stop the row being displayed, but still let it contribute to layout
        tableSource.appendChild(rowHeaderCopy);

        // Hide the first row of the source table
        //tableSource.rows[0].style.display = "none"; 
        // Re-think: Delete the first row of the source table to stop it jiggering the sorting
        tableSource.deleteRow(0);

        // Wrap the source table in a div tag that is fixed size, to give us vertical scrolling on the body only   

        var bodywrapper = document.createElement("div");
        bodywrapper.id = "divBody_" + sTable;
        bodywrapper.style.overflow = "auto";

        var heightRequired = rowsToShow * rowHeight;
        bodywrapper.style.height = heightRequired + "px";

        var widthTableSource = tableSource.offsetWidth;
        var widthRequired = widthTableSource + getScrollBarWidth();
        bodywrapper.style.width = widthRequired + "px";

        // Get the border style of the table and make the div have the same style,
        // And then turn off the border style of the body (maybe, still designing).
        //var border = tableSource.style.getAttribute("border-width"); // Attempt to read style FAILED
        //var style = document.defaultView.getComputedStyle(tableSource, ""); // Attempt to read Computed Style FAILED
        //bodywrapper.style.border = "black 1px solid"; // Hard coded bodge

        // The node to wrap is the tableSource
        tableSource.parentNode.insertBefore(bodywrapper, tableSource);
        tableSource.parentNode.removeChild(tableSource);
        bodywrapper.appendChild(tableSource);

        // Wrap the whole lot in another DIV element to give us horizontal scrolling for header and body
        var tablewrapper = document.createElement("div");
        tablewrapper.id = "divTable_" + sTable;
        tablewrapper.style.overflow = "auto";

        // Height of the outer wrapping DIV is the header height, plus body height, plus one scrollbar
        tablewrapper.style.height = 1 + getScrollBarHeight() + heightHeader + heightRequired + "px"; 

        // Width of the out DIV is default, 100%, so that scrollbar only appears 
        // if table is wider than available screen real estate.

        tableCopy.parentNode.insertBefore(tablewrapper, tableCopy); // Put the tablewrapper DIV in front of the header
        tableCopy.parentNode.removeChild(tableCopy); // Cut the header out
        bodywrapper.parentNode.removeChild(bodywrapper); // Cut the table body out
        tablewrapper.appendChild(tableCopy); // Add the header to the contents of the tablewrapper DIV
        tablewrapper.appendChild(bodywrapper); // Add the table body to the contents of the tablewrapper DIV
    }

    function GetTableRowHeight(sTable) {
        var table = document.getElementById(sTable);
        if (table == null) { return 32; }
        var countRows = table.rows.length;
        var heightTable = table.offsetHeight+1;
        return (heightTable / countRows);
    } 
```

* * *

常见的 JavaScript

```
 ///////////////////////////////////////////////////////////////////////////////
    // Invoke functions once the document is loaded
    // 
    // Usage: 
    // Start by setting a flag to indicate that the document is not yet loaded...
    //     onLoad.loaded = false;
    // Then register a function to set the flag when the document loads...
    //     onLoad(function(){ onLoad.loaded=true; });
    //
    function onLoad(f) {
        if (onLoad.loaded)
            window.setTimeout(f, 0);
        else if (window.addEventListener)
            window.addEventListener("load", f, false);
        else if (window.attachEvent)
            window.attachEvent("onload", f);
    }
    //
    ///////////////////////////////////////////////////////////////////////////////

    ///////////////////////////////////////////////////////////////////////////////
    //
    // Graphics Functions

    // Sometimes you have to account for scrollbar widths etc.  
    function getScrollBarWidth() {
        var inner = document.createElement('p');
        inner.style.width = "100%";
        inner.style.height = "200px";

        var outer = document.createElement('div');
        outer.style.position = "absolute";
        outer.style.top = "0px";
        outer.style.left = "0px";
        outer.style.visibility = "hidden";
        outer.style.width = "200px";
        outer.style.height = "150px";
        outer.style.overflow = "hidden";
        outer.appendChild(inner);

        document.body.appendChild(outer);
        var w1 = inner.offsetWidth;
        outer.style.overflow = 'scroll';
        var w2 = inner.offsetWidth;
        if (w1 == w2) w2 = outer.clientWidth;

        document.body.removeChild(outer);

        return (w1 - w2);
    };

    // Sometimes you have to account for scrollbar widths etc.  
    function getScrollBarHeight() {
        var inner = document.createElement('p');
        inner.style.height = "100%";
        inner.style.width = "200px";

        var outer = document.createElement('div');
        outer.style.position = "absolute";
        outer.style.top = "0px";
        outer.style.left = "0px";
        outer.style.visibility = "hidden";
        outer.style.width = "150px";
        outer.style.height = "200px";
        outer.style.overflow = "hidden";
        outer.appendChild(inner);

        document.body.appendChild(outer);
        var h1 = inner.offsetHeight;
        outer.style.overflow = 'scroll';
        var h2 = inner.offsetHeight;
        if (h1 == h2) h2 = outer.clientHeight;

        document.body.removeChild(outer);

        return (h1 - h2);
    };

    //
    /////////////////////////////////////////////////////////////////////////////// 
```

* * *

解决方案：

下面的函数应该不可知地查询元素的样式对象并返回所需的内容。当然，JQuery 会更可靠，毫无疑问。我决定不尝试借用表格的边框，因为它使整个操作非常复杂且容易出错，因为这实际上只是一个很好的优势。但是，下面的功能很有用，其他人也可能会觉得它有帮助。请记住，如果样式是这样设置的，IE 会返回 em 和百分比，它不会为您转换为 px。毕竟，你为什么要这样？（哈哈抱歉）。

```
 // Custom version, reverses the if-clause logic to test for IE9 first, 
    // as IE9 does not return null for getComputedStyle.
    // CREDIT: Robert Nyman (search using getStyle,oElm,strCssRule)
    function getStyle(oElm, strCssRule) {
        var strValue = "";
        if (oElm.currentStyle) {
            strCssRule = strCssRule.replace(/\-(\w)/g, function (strMatch, p1) {
                return p1.toUpperCase();
            });
            strValue = oElm.currentStyle[strCssRule];
        }
        else if (document.defaultView && document.defaultView.getComputedStyle) {
            var style = document.defaultView.getComputedStyle(oElm, "");
            strValue = style.getPropertyValue(strCssRule);
        }

        return strValue;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:02:43.303

如果 dom 尝试“重组”/“修复”您的代码，请使用 firebug 或类似的东西来检查表：

```
<table>
    <tbody>
    </tbody>
</table> 
```

并且 tbody 包含边框属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:00:25.887

你为什么要这样做，而不是给 table 和 div 同一个类，然后将边框样式放在那个类中，而不是在 table 上内联？

另外，你什么时候检查样式对象的属性？如何？需要看你的代码。如果您试图在 DOM 准备好之前获取这些样式（例如在某些情况下触发 DOM.onload 之前），那么对象将不会准备好并且您将不会获得任何值。

已编辑

好的，鉴于上面的代码，我可以对你的 CSS 进行轻微的重构感兴趣吗？:)

让我们来看看：

```
.tbTest
{
    empty-cells: show;    
    border-collapse:separate; /* Table and Cell borders are unique */

    border-width:1px;
    border-style:solid;
    border-color:Navy;

    background-color:#DDDDDD; /* Colour of gaps between cells */
    color:Black; /* Text colour */
} 
```

并将其分开，以便您的表格特定样式与边框样式分开：

```
.tbTest
{
    empty-cells: show;    
    border-collapse:separate; /* Table and Cell borders are unique */
    background-color:#DDDDDD; /* Colour of gaps between cells */
    color:Black; /* Text colour */
}

.borderSpec 
{
    border:1px solid Navy;
} 
```

将 .borderSpec 添加到您的表格中：

```
 <table id="tbWorking" class="tbTest borderSpec">
        <tr class="trTest">
            <th class="tdTest">Col1</th>
            <th class="tdTest">Col2</th>
        </tr> 
```

现在，在您的 Javascript 中，进行一些小修改：

```
function prepTable(sTable, rowsToShow) {
    var tableSource = document.getElementById(sTable);
    if (tableSource == null) { return; }

    // clear off the borderSpec from your tableSource
    tableSource.setAttribute("class","tbTest");

    /* ... snip ... */

    // Wrap the whole lot in another DIV element to give 
    // us horizontal scrolling for header and body
    var tablewrapper = document.createElement("div");
    tablewrapper.id = "divTable_" + sTable;
    tablewrapper.style.overflow = "auto";

    // Now, add borderSpec to your wrapper-div
    tablewrapper.setAttribute("class","borderSpec"); 
```

这样做是从表中删除borderSpec，并将borderSpec 添加到您的包装器div，以便包装器获取边框，而表没有。

jsFiddle，这里：http: [//jsfiddle.net/mori57/35e6B/](http://jsfiddle.net/mori57/35e6B/)

# dictionary - 已指定 Eclipse Juno 无法识别用户定义的字典

> ID：13072554
> 
> 赞同：16
> 
> 时间：2012-10-25T15:57:50.940
> 
> 标签：dictionary, eclipse-juno, suse

我是使用 SUSE 11 Linux 的 Eclipse (Juno) 的新用户，我正在寻找指定用户定义的字典，以便我可以停止 Qt 项目中所有“Trolltech”和“Qt”引用显示为拼写错误，无需关闭所有拼写检查。

我在网上找到了以下说明，我选择了**Window | 偏好 | 编辑 | 文本编辑器 | 拼写**并获取一个面板，其中包含一个用于指定用户定义字典的字段。我收集所有需要的，是一个文本文件。我为此尝试了两种变体：

作为根，

1.  创建了一个**/opt/eclipse/dictionary/dictionary.txt**文件，文件权限设置为 777 但更高级别的目录为 755s
2.  创建了一个**/dictionary/dictionary.txt**文件，目录和文件权限都设置为 777。

在这一点上，在每种情况下，我都有，

1.  在“用户定义的字典”字段中指定这些文件之一的完整（绝对）路径，
2.  单击**应用 | OK**设置路径，或者只是**OK**，退出对话框
3.  在 Eclipse 编辑器中没有看到任何变化，仍然将这些术语显示为拼写错误
4.  在项目级别，尝试从鼠标右键弹出菜单中**刷新项目**
5.  **尝试使用Index |**在项目级别重新建立索引 从鼠标右键弹出菜单**重建**
6.  **尝试使用Index |**在项目级别刷新文件 **从鼠标右键弹出菜单中刷新所有文件**（没有理由相信第 5 步或第 6 步会有所帮助，但我基本上在尝试所有似乎可以尝试的东西）
7.  关闭并重新打开项目
8.  关闭并重新打开IDE。

当我重新启动 IDE 并返回**Window | Preferences**等，面板显示了我指定 AS 指定的字典文本文件，但 IDE 似乎没有对此进行功能识别。

更令人高兴的是，当我将鼠标悬停在我不想看到的任何一个“错误”上方时，我没有得到将错误词添加到字典中的快速修复选项，因为上周我勾选了那个选项“如果不存在字典，请不要提示添加到字典”。似乎没有任何字典被识别为存在。

谁能告诉我我在这里错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-03-15T15:46:39.470

我只是在这里添加这个，因为即使在 3 年后，多萝西也没有回答他自己的问题。这将阻止问题出现在未回答的类别中，并为新问题提供空间。

多萝西·怀特：

> 好的，我想通了。我读过的所有说明都没有提到，在 Windows | 首选项等面板，您必须从“默认拼写引擎”更改为“C/C++ 拼写引擎”。然后你重新指定字典，它就可以工作了。

# c# - 如何处理多个xml标准？

> ID：13072555
> 
> 赞同：1
> 
> 时间：2012-10-25T15:57:55.337
> 
> 标签：c#, xml, xml-parsing

我正在尝试将一组本地包装类编写到我们的机构 API 中（我在一所高等教育机构工作）。这些类的目的是安全地从远程服务中提取脚本，并允许抽象从该服务如何工作到我们的程序员。该服务的工作方式是保密的，但我也需要回答的问题是：

**当每个成绩单响应以不同的 xml 格式出现时，如何处理这个问题，具体取决于它来自哪所学校。有30多个。**

例如：机构 A 在靠近根的文档顶部有一个标签，学生的 GPA 为 |GPA|4.0|/GPA| 而另一个机构可能将它放在 XML 的完全不同的部分，靠近底部，可能有 3 个孩子深，并将标签命名为 |GradePointAverage|4.0|/GradePointAverage| （假装|是xml尖括号）

有什么建议可以解决这种缺乏标准化的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:13:00.143

听起来您应该针对一种通用数据模型，然后是 30 个能够从 XML 反序列化到该数据模型的不同类。根据它们的不同之处，*可能*存在重用的重要方面，您甚至可以参数化一些差异。使用 LINQ to XML 可以相当容易地解析任何一种格式。

我的目标是大量简单的代码而不是少量的“聪明”代码：解析每种单独的格式应该相当简单，并且希望易于测试。是的，编写这段代码会很乏味，但最终应该很容易理解，并且如果需要，可以轻松添加更多格式。

当然，您可以使用 XSLT 执行转换为单一格式，但我个人更愿意编写 C# :)

这假设您*可以*创建一个通用数据模型 - 如果格式非常不同，您可能会发现如果没有可怕的最低公分母，就无法准确表示每个文件中的数据。想出一个好的数据模型可能和编写每个单独的解析器一样困难。

# c# - 使用 xElement 将 C# 字符串的特殊字符（<、>、&）转换为 XML

> ID：13072558
> 
> 赞同：1
> 
> 时间：2012-10-25T15:58:04.000
> 
> 标签：c#, xml, special-characters

C＃

```
noticia.Add(new XElement("Imagem", <BR>)); 
```

我需要 ：

```
<Imagem><BR></Imagem> 
```

并不是：

```
<Imagem>&lt;BR&gt;</Imagem> 
```

谢谢大家

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:59:19.177

就这样做

```
noticia.Add(new XElement("Imagem", new XElement("BR"))); 
```

但是，这将为您提供您需要的额外`/`内容，否则它不是有效的 XML。

```
<Imagem><BR/></Imagem> 
```

其他选项是使用 CDATA

```
noticia.Add(new XElement("Imagem", new XCData("<BR>"))); 
```

哪个会让你

```
<Imagem><![CDATA[<BR>]]></Imagem> 
```

仅仅生成`<Imagem><BR></Imagem>`是不可能的，因为它不是有效的 xml。

**编辑**：如果你有其他文本的字符串，在一个变量中，你唯一的选择是 CDATA，像这样

```
var OutClass = "xpto. <BR>";
noticia.Add(new XElement("Imagem", new XCData(OutClass))); 
```

这导致

```
<Imagem><![CDATA[xpto. <BR>]]></Imagem> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T08:27:10.267

我真的使用类：

我从课堂上收到了字符串：

```
string OutClass = "xpto. <BR>"; 
```

我`XElement()`在另一个班级中使用。

# html - 空白而不是重复背景图像

> ID：13072563
> 
> 赞同：3
> 
> 时间：2012-10-25T15:58:22.003
> 
> 标签：html, css, background

我目前重新设计了我的投资组合网站，位于[http://www.jn-design.co.uk](http://www.jn-design.co.uk)

调整窗口大小（以模拟较小的分辨率）时，我的网站右侧有一个很大的白色间隙。我尝试了各种解决方案，但没有一个解决问题而不产生其他问题。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:26:24.290

你可以试试这个，应该可以的。

```
body {
    display: table;
    width: 100%;
} 
```

# javascript - javascript代码填充html段落

> ID：13072568
> 
> 赞同：1
> 
> 时间：2012-10-25T15:58:37.950
> 
> 标签：javascript, html

最好的问候，我想编写一个 javascript 代码来写入`<P><br data-mce-bogus="1"></P>`其中存在的 Paragraph

```
<html><head>
</head>
<body>
<table id="contentMessage_tbl" class="mceLayout" cellspacing="0" cellpadding="0" role="presentation" style="width: 100%; height: 260px;">
<tbody>
<td class="mceIframeContainer mceFirst mceLast">
<iframe id="contentMessage_ifr" frameborder="0" src="javascript:""" allowtransparency="true" title="Rich Text AreaPress ALT-F10 for toolbar. Press ALT-0 for help" style="width: 100%; height: 216px; display: block;">
<head xmlns="http://www.w3.org/1999/xhtml">
<meta content="IE=7" http-equiv="X-UA-Compatible">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
</head>
<body id="tinymce" class="mceContentBody " contenteditable="true" spellcheck="false" dir="ltr" style="font-size: 12px; font-family: arial,helvetica,sans-serif;">
<p>
<br data-mce-bogus="1">
</p>
</body>
</html>
</iframe>
</td>
</tbody>
</table>
</body>
</html> 
```

我试过这段代码

```
javascript:document.getElementById('contentMessage_ifr').contentDocument.body.innerHTML="it works"; 
```

我的代码有问题吗，它在[w3schools javascript 编辑器上运行良好](http://www.w3schools.com/js/tryit.asp?filename=tryjs_text)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:07:02.553

您的代码正在获取 iframe 的 ID。试着抓住段落。这是一个应该可以工作的 jsfiddle 示例：http: [//jsfiddle.net/kakashi/QR9N8/](http://jsfiddle.net/kakashi/QR9N8/)

如果你想使用 jQuery，你想要的相关代码是：

```
$('p:has(br[data-mce-bogus=1])').append("<p>Hi There</p>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:17:13.663

也许您的 html 代码不是很干净，您缺少一些 html 标签，例如“html”和“tr”，试试这个 html：

```
<html>
<head>
</head>
<body>
<table id="contentMessage_tbl" class="mceLayout" cellspacing="0" cellpadding="0" role="presentation" style="width: 100%; height: 260px;">
<tbody><tr>
<td class="mceIframeContainer mceFirst mceLast">
<iframe id="contentMessage_ifr" frameborder="0" src="javascript:"""   allowtransparency="true" title="Rich Text AreaPress ALT-F10 for toolbar. Press ALT-0 for  help" style="width: 100%; height: 216px; display: block;">
<html>
<head xmlns="http://www.w3.org/1999/xhtml">
<meta content="IE=7" http-equiv="X-UA-Compatible">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
</head>
<body id="tinymce" class="mceContentBody " contenteditable="true" spellcheck="false" dir="ltr" style="font-size: 12px; font-family: arial,helvetica,sans-serif;">
<p>
<br data-mce-bogus="1">
</p>
</body>
</html>
</iframe>
</td></tr>
</tbody>
</table>
</body>
</html>​ 
```

# r - 在 R 中绘制世界地图上的时区

> ID：13072571
> 
> 赞同：5
> 
> 时间：2012-10-25T15:58:41.507
> 
> 标签：r, timezone, maps

大家好：谁能给我一些关于在 R 中使用多边形在世界地图上绘制时区网格的提示？我使用地图来获取世界布局，但是在哪里获取时区多边形的坐标？

最终，我很想得到这样的东西[，](http://www.timeanddate.com/time/map/about.html)根据我的分析中的一些值对时区进行着色。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T19:23:55.597

如果您的问题只是*在哪里*获取用于绘图的时区 shapefile，那么您可以从[http://efele.net/maps/tz/world/](http://efele.net/maps/tz/world/)获得一些。

# java - 打开新框架时如何关闭前一个框架

> ID：13072575
> 
> 赞同：2
> 
> 时间：2012-10-25T15:59:11.160
> 
> 标签：java, swing, model-view-controller, jframe

我正在编码 MVC。在我的控制器中，我正在收听动作，如果用户单击“SHOW-LIST”按钮，我正在创建从 JFrame 扩展的视图类的实例，并且在其中我创建一个新的 JFrame 视图类。我的问题是，如果我多次单击 SHOW-LIST 按钮，我会多次打开框架。有人可以告诉我我该怎么做才能在新框架即将打开时关闭旧框架..

控制器

```
public void actionPerformed(ActionEvent event) {
  String viewAction = event.getActionCommand();
  ...
    if (viewAction.equals("SHOW-LIST")) {
      showListUI = new ShowListDialogUI(displayedCustomerList);
    }
} 
```

看法

```
class ShowListDialogUI extends JFrame{
  public ShowListDialogUI (List<Customer> customerList) {
    ..
    // I am drawing it here
    ..
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:28:54.127

> 有人可以告诉我我该怎么做才能在新框架即将打开时关闭旧框架..

*   使用`CardLayout`，然后没有理由玩`Top-Level Container`s，放在那里需要的数量`JPanels`，然后只是在 JPanel 视图之间切换

*   如`@trashgod`通知，真的不是好主意，方式

*   否则必须清理（删除所有内容）无用的容器，[因为顶级容器永远不会被 GC'ed](https://stackoverflow.com/questions/6309407/remove-top-level-container-on-runtime)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:12:38.110

好吧，取决于用例，但不是关闭旧的并创建新的，您可以关注现有的（并且可能更新数据？）。

您的控制器可以管理帧并跟踪它。以最简单（但不推荐）的方式，您有一个布尔值“isFrameOpen”。如果您打开框架，则将其设置为 true，如果您关闭框架，则将其设置为 false（然后您的框架必须与控制器通信，或者控制器必须至少知道框架的状态）。如果 boolean 为真，则聚焦/重新创建它。如果为假，则创建一个新的。

在更高级的解决方案中，您可以使用地图跟踪所有帧，并且必须小心处理并发访问。

--待定

# jquery - 将鼠标悬停在表格行上时如何放大表格行？

> ID：13072577
> 
> 赞同：1
> 
> 时间：2012-10-25T15:59:16.673
> 
> 标签：jquery, jquery-plugins, html-table

我正在尝试构建一个类似于鼠标悬停放大图像的 jQuery 插件 - 但在表格行上：

```
var trEnlargedCssMap = 
{
    position: 'absolute',
    left: '50px',
    top: '50px',
    'font-size': '14px'
}

$('table tr').hover(
    function()
    {
        $(this).clone().css(trEnlargedCssMap).show();
    },
    function()
    {
        $(this).hide();
    }) 
```

它不接近工作，任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:08:18.397

您必须将其附加到 DOM/表（无论您想要什么）。我将它附加到现有表中。当您悬停时，您还应该`.remove()`使用任何克隆的元素，而不是隐藏它们。请根据您的应用程序的需要更改属性。

[jsFiddle](http://jsfiddle.net/TheJoeFletch/uQEUz/1/)

```
var trEnlargedCssMap = {
    position: 'absolute',
    left: '50px',
    top: '50px',
    'font-size': '20px'
}

    $('table tr').hover(

function() {
    $(this).closest("table").append(
    $(this).clone().addClass("cloned-element").css(trEnlargedCssMap).show())
}, function() {
    $(this).closest("table").find(".cloned-element").remove();
})​

<table>
<tr>
    <td>Row 1</td>
    <td>Row 1</td>
    <td>Row 1</td>
</tr>
<tr>
    <td>Row 2</td>
    <td>Row 2</td>
    <td>Row 2</td>
</tr>
<tr>
    <td>Row 3</td>
    <td>Row 3</td>
    <td>Row 3</td>
</tr>
</table>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:06:27.803

你需要在`append()`某个地方。在这里你只是克隆它，什么都不做......

所以`$(this).clone().css(trEnlargedCssMap).appendTo('#myZoomedRow');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:11:16.940

您必须将该克隆元素附加到 DOM，并隐藏（或删除它以防止冲突）从您克隆的实际行中插入的“新”元素。

```
var trEnlargedCssMap = {
        position: 'absolute',
        left: '50px',
        top: '50px',
        'font-size': '14px'
    }
$('table tr').hover(
                    function(){
                        $(this).clone().css(trEnlargedCssMap).appendTo("#newRow").show();
                    },
                    function(){
                         $("#newRow").hide();
                    }
                    ) 
```

# ios - MPMoviePlayerController 模拟器崩溃

> ID：13072580
> 
> 赞同：15
> 
> 时间：2012-10-25T15:59:24.920
> 
> 标签：ios, xcode, ios-simulator, mpmovieplayercontroller

当我尝试播放任何视频时，我的 MPMoviePlayerController 崩溃。

这只发生在模拟器上，在设备上运行良好。

错误如下：

```
2012-10-25 16:46:24.033 TheFasterChef[8529:14303] [MPAVController] Autoplay: Disabling autoplay for pause
2012-10-25 16:46:24.035 TheFasterChef[8529:14303] [MPAVController] Autoplay: Disabling autoplay
2012-10-25 16:46:24.172 TheFasterChef[8529:14303] [MPAVController] Autoplay: Skipping autoplay, disabled (for current item: 1, on player: 0)
2012-10-25 16:46:24.190 TheFasterChef[8529:14303] [MPAVController] Autoplay: Enabling autoplay
2012-10-25 16:46:24.227 TheFasterChef[8529:14303] [MPAVController] Autoplay: Likely to keep up or full buffer: 0
2012-10-25 16:46:24.227 TheFasterChef[8529:14303] [MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
2012-10-25 16:46:24.232 TheFasterChef[8529:14303] [MPAVController] Autoplay: Enabling autoplay
2012-10-25 16:46:24.238 TheFasterChef[8529:14303] [MPCloudAssetDownloadController] Prioritization requested for media item ID: 0 
```

我的代码是调用 MPMoviePlayerController 的沼泽标准方法：

在 .h 文件中：

```
@property (retain) MPMoviePlayerController *videoPlayer; 
```

在 .m 文件中：

```
NSBundle *appBundle = [NSBundle mainBundle];
//NSString *contentURLString = [appBundle pathForResource:videoIdentifier ofType:@"mp4"];
NSString *contentURLString = [appBundle pathForResource:@"test" ofType:@".mp4"];
NSURL *contentURL = [NSURL fileURLWithPath:contentURLString];

self.videoPlayer = [[MPMoviePlayerController alloc] initWithContentURL:contentURL];
[self.videoPlayer prepareToPlay];
[self.videoPlayer.view setFrame: self.view.bounds];
[self.view addSubview:self.videoPlayer.view];
[self.videoPlayer prepareToPlay];
[self.videoPlayer play]; 
```

我在不同的视图控制器中尝试了这段代码，错误结果相同。

我在一个新项目中尝试了这个代码段，它工作正常。

还有什么可能导致此错误？

[这里](https://stackoverflow.com/questions/12414717/ios-6-streaming-player-com-apple-coremedia-networkbuffering-bug)的答案并没有为我解决。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-05-16T02:40:14.913

解决方案：从断点选项卡中删除“所有异常”。
这个答案来自 Till 上面的评论。我遇到了这个问题，我几乎错过了答案，因为它是一个评论。直到的回答帮助了我，所以我希望这可以帮助像我这样的其他人。

![例外](../Images/c9e772360f60127533c13390acdec6db.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-03T17:33:37.963

你自己已经给出了答案。这纯粹是一个模拟器问题。一般来说，与媒体相关的 API 在设备上运行得更好（有时，只是）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-22T11:47:38.813

更好的是，如果您需要其他事情，请禁用（而不是删除）“所有例外”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-11T07:10:03.053

模拟器似乎不支持mp4，但支持mov。我遇到了同样的问题，将视频转换为mov后，它在模拟器上运行良好。

# linux-kernel - 如何在内核 2.6.26 中实现一个简单的系统调用？

> ID：13072584
> 
> 赞同：0
> 
> 时间：2012-10-25T16:00:00.823
> 
> 标签：linux-kernel, system-calls

我在这里遇到了很多问题，在其他网站上我仍然有以下问题。

我正在实现一个简单的系统调用，为此我更改了如下文件

```
 1\. /arch/x86/kernel/syscal_table_32_S
 2\. /include/asm-x86/unistd_32.h
 3\. /include/linux/syscalls.h 
```

我对第二个文件有疑问，因为这个，我不确定这个文件（/include/asm-x86/unistd_32.h）要修改还是任何其他文件，因为我知道包含系统调用号的文件，我们必须添加我们的系统调用和最后一个数字+ 1，这里的疑问是这个文件（`/include/asm-x86/unistd_32.h)`不包含限制线（`#define NR_syscalls <last syscall no + 1>`）但还有另一个文件（`/include/asm-sh/unistd_32.h`），其中包含系统调用号和限制线。

所以，请用一个简单的例子告诉我要修改哪些文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:39:08.530

我在 linux-kernel 3.2 上实现了新的系统调用并修改了以下文件：

```
1\. /arch/x86/kernel/syscal_table_32.S
2\. /arch/x86/kernel/syscal_table_64.S
3\. /arch/x86/include/asm/unistd_32.h - contains NR_syscalls for ia32
4\. /arch/x86/include/asm/unistd_64.h
5\. /arch/x86/include/asm/<new_file_with_syscall>
6\. /arch/x86/include/asm/Makefile 
```

`syscall(NUMBER_OF_SYSCALL)`我用函数调用的系统调用本身。

# android - Ksoap2-Android：从 2.6 更新到 3.0 中断了复杂对象的上传

> ID：13072585
> 
> 赞同：0
> 
> 时间：2012-10-25T16:00:03.227
> 
> 标签：android, ksoap2, android-ksoap2

我正在尝试更新我的 Android 应用程序以使用 Ksoap2-Android 版本 3，从版本 2.6 开始，以利用新的 SSL/自签名证书功能。

该应用程序似乎没有问题发送简单的参数和接收复杂的对象。但是，当尝试使用我的请求发送复杂对象时，它以 null 形式到达服务器。

我从来没有在 ksoap 中对复杂类型进行任何编组/解组工作，所以基本上有很多 SoapObjects 和 PropertyInfo 对象在进行，还有很多 .getProperty("propertyname") 等通过层次结构逐步下降。没关系，编写代码有点乏味，但效果很好，所以一切都很好。但是现在当我尝试发送一个复杂对象时，服务器上的请求没有收到任何数据。

我通过创建一个 SoapObject 来组合我的请求对象，然后将更多的 SoapObjects 分配为原始对象的属性，并从它们中分配更多的 SoapObjects，等等，PropertyInfo 对象位于树的末尾。由于某种原因，这在使用 ksoap2 版本 3 时似乎不再起作用。我已经对此进行了测试，唯一的区别是我正在使用的 ksoap 版本。适用于 2.6，不适用于 3.0。

是否有任何已知的原因会发生这种情况？如有必要，我可以在这里发布代码，但我想我会问，以防我遗漏了一些基本的东西。我在 News 或 Coding Tips & Tricks 中没有看到任何内容来说明为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T11:12:17.623

我已经解决了这个问题，但我不确定是什么原因造成的。

我重构了我的代码以使用更新的方法来上传复杂对象，如 Ksoap2-android “编码提示和技巧”页面中所述[。](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks#sending/receiving_array_of_complex_types_or_primitives)

似乎在 Ksoap2-Android 的较新版本中，您不能再在树的末尾使用 PropertyInfo 对象嵌套 SoapObjects，这是我之前所做的。在新版本中，顶层只有一个 SoapObject，它具有 PropertyInfo 对象，并且这些 PropertyInfo 对象中的每一个都可以是复杂类型。如何做到这一点在上面的链接中有详细说明。

# installation - 配置 msi 文件以卸载已安装的版本

> ID：13072588
> 
> 赞同：1
> 
> 时间：2012-10-25T16:00:17.040
> 
> 标签：installation, windows-installer, setup-project, uninstallation

我有一个在系统上安装 Windows 服务的 msi 安装文件。现在每次我安装更新版本的设置时，我希望它首先完全卸载以前安装的版本，然后安装当前版本。我对这些配置很陌生，所以对此一无所知。

任何帮助将非常感激。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T21:05:34.227

您必须确保当您在应用程序的第一个版本上运行卸载时，它确实使您的系统处于您期望的原始状态。不幸的是，根据您的设置和应用程序，无法自动保证完全卸载，因为您在用于安装应用程序的同一个 Windows Installer 程序包上运行了卸载。您需要[彻底测试原始安装包](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/ff48d995-fe6f-4d1b-898d-67574ed3c5b7#test_thoroughly)，以确保[卸载使用户的计算机处于干净状态](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/ff48d995-fe6f-4d1b-898d-67574ed3c5b7#uninstall_clean)。例如，如果您的应用程序必须注册，则必须编写安装包以在卸载应用程序时清理注册表。

如果您的安装包确实总是让用户的计算机处于干净状态，那么您可以通过使用带有 /uninstall 选项的[标准命令行选项或 Windows Installer 之一来删除使用 Windows Installer 包安装的应用程序](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/b1707c88-1cca-45ab-bb23-6002bfd5204e)[MsiInstallProduct](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/ec8d6710-ecfe-432c-ba1d-2e3532a25988)等 API 。

如果您想在已安装的旧版本上安装较新版本的应用程序，最好开发一个更新包来更新应用程序。有几种类型的更新：小更新、次要升级和主要升级。请参阅文档中的[修补和升级](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/da946739-9efc-4bf0-8a9a-6f6ead3c4a34)，以确定您需要向应用程序的用户提供哪种类型的更新包。

Windows Installer 的目的之一是支持这样的应用程序服务，其中可能存在共享组件和用户系统上的多个更新。这可能是一种更有弹性的维修方法，因为与拆除和更换的方法相比，它可能需要更少的用户计算机先验知识。

# python - 如何在 python 中从 BaseHTTPServer 加载 SVG？

> ID：13072589
> 
> 赞同：1
> 
> 时间：2012-10-25T16:00:18.723
> 
> 标签：python, svg, httpserver

我用python创建了一个服务器。

现在我有一个网页cgi 来筛选我的结果，还有一个 svg 文件。我测试了 3 种方法： 解决方案 1 一种快速加载 svg 的 javascript 方法（在服务器之外工作-> 但不在本地服务器中） 解决方案2 一个简单的对象导入（在服务器之外工作 - > 但不在本地服务器中） 解决方案3 内部 svg html（在服务器中运行）

我想使用解决方案 1 或 2，因为 3 对我来说既不舒服又脏……为什么解决方案 1 和 2 不起作用？我认为他们没有找到 svg 文件，但我不明白为什么......

```
 os.system("cp %s WEBSERVER/toto.svg"%(svg))
    print 'Content-type: text/html' #application/xhtml+xml'# image/svg+xml'
    print '''    
    <html>
    <head>
    <script language="javascript">
    function loadSVG(id, svg) {
            var element = document.getElementById(id);
            var object = document.createElement("object");
            object.type = "image/svg+xml";
            object.data = svg;
            element.appendChild(object);
            }
    </script>
    </head>

    <body>

        SOLUTION1<br/>
        <script type="text/javascript">
            loadSVG('hca', 'WEBSERVER/toto.svg');
        </script>

        SOLUTION2<br/>
        <object type='image/svg+xml' data ='WEBSERVER/toto.svg'></object>

        SOLUTIONT3<br/>
        <svg xmlns="http://www.w3.org/2000/svg"
        width="800" height="800" >
            <rect x="50" y="200" width="250" height="40" />
        </svg>
    </body>

</html>
    ''' 
```

这是我在 python 中启动的网络服务器：

```
#!/usr/bin/python

import BaseHTTPServer
import CGIHTTPServer
import cgitb; cgitb.enable() 

server = BaseHTTPServer.HTTPServer
handler = CGIHTTPServer.CGIHTTPRequestHandler
server_address = ("0.0.0.0", 8123)
handler.cgi_directories = ['/WEBSERVER']

httpd = server(server_address, handler)

try:    
    print "Running HTTP server"
    httpd.serve_forever()
except KeyboardInterrupt:
    print "Server Stoped" 
```

# python - OBIEE 的 nqquery.log 文件是否有一个好的日志解析器？

> ID：13072593
> 
> 赞同：0
> 
> 时间：2012-10-25T16:00:36.867
> 
> 标签：python, sql, performance, parsing, obiee

我想提取由 OBIEE 执行的所有逻辑 SQL 的列表。此信息存在于 OBIEE 的 nqquery.log 日志文件中。我正在寻找一个可以解析此日志文件并在 CSV 文件中为每个逻辑 SQL 提供以下信息的脚本

*   逻辑 SQL 的哈希 ID 和完整的查询
*   执行逻辑sql所用的时间
*   能够按主题区域对相关的逻辑 SQL 进行分组

在我提高日志级别并禁用缓存后，它应该能够收集给定逻辑 SQL 的所有物理 SQL。

额外的好处，如果我提供数据库连接信息，请提供物理 SQL 的解释计划。

这样的脚本是否存在或要求太多？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T14:24:45.563

[ListOBIStats](http://code.google.com/p/listobistats/)是一个可以做到这一点的工具。

```
python listobistats.py --help 
```

它为每个逻辑 SQL 收集以下信息

*   逻辑 SQL 哈希 ID
*   物理 SQL 及其哈希 id
*   经过时间
*   提取的行数
*   如果数据源是 OTBI (Oracle Transactional Business Intelligence)，则 ADFQuery XML 标记
*   包含上述数据的 CSV 文件

每个逻辑或物理 SQL 的格式和缩进都正确。它们被写入单独的文件，并且可以从浏览器中的 HTML 结果访问。

如果数据源是 Oracle 数据库，则可以自动生成解释计划。

```
Usage: python listobistats.py [options] $OBIEE_HOME/.../coreapplication_obis1/nqquery*.log 
```

# mongodb - 如何使用 ZF2 Doctrine MongoDb 模块打开日志记录（分析）

> ID：13072595
> 
> 赞同：0
> 
> 时间：2012-10-25T16:00:37.917
> 
> 标签：mongodb, zend-framework2, doctrine-odm, doctrine-mongodb

我已经成功地将 Doctrine MongoDB 模块集成到 Zend Framework 2 中，现在我需要跟踪对 MongoDB 的每个查询。有人知道如何打开日志吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T18:48:50.470

[您可以使用MongoDB Database Profiler](http://www.mongodb.org/display/DOCS/Database+Profiler#DatabaseProfiler-EnablingProfiling)记录每个查询。使用配置文件级别 2。所有查询都将记录到`system.profile`集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T17:59:53.997

我刚刚在[DoctrineMongoODMModule上提出了一个](https://github.com/doctrine/DoctrineMongoODMModule)[拉取请求](https://github.com/doctrine/DoctrineMongoODMModule/pull/51)，以集成 MongoDB ODM 的[日志记录配置选项](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/logging.html)。希望它会尽快合并。

然后，您只需将其添加到`doctrine-mongo-odm.global.php`文件中：

```
'doctrine' => array(
    // [...]
    'configuration' => array(
        'odm_default' => array(
            // [...]
            'logger_callable'    => function(array $log, \Zend\ServiceManager\ServiceLocatorInterface $sl) {
               print_r($log);
            }
        )
    )
) 
```

logger_callable 将被调用以记录所有内容。

# mysql - 在rails中避免mysql查询的策略

> ID：13072598
> 
> 赞同：0
> 
> 时间：2012-10-25T16:01:02.403
> 
> 标签：mysql, ruby-on-rails-3

我有一个应用程序（rails 3），它基本上是一个用于电视节目的社交网络。因此，用户可以彼此互动并与 tv_shows 互动。

每次显示 users/tv_shows 个人资料页面时，避免查询数据库（mysql）的最佳策略是什么？

例如：在电视节目简介页面中，我需要加载很多信息，例如季节、剧集、演员等。为此，需要加入多个表格，并且每天都在变慢。

我的第一个想法是将有关任何电视节目和存储的所有信息收集在一张桌子上，所以我不需要每次都进行这些连接。

我肯定会有更好的表现，但不是最好的。我知道有很多替代品，比如 memcache、redis 甚至 mongodb，但这种情况下最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T19:18:44.643

在我看来，您最好的选择是为每个`Show`包含呈现页面所需的所有关系的预取数据的编组对象缓存。我使用 Redis 作为我的缓存，但您也可以使用 Memcache 或类似的东西。

```
shows = user.tv_shows.map do |show|
  if cached_show = $redis.get("shows:#{show.id}")
    # use the cached object
    Marshal.load(cached_show)
  else
    # cache has expired or was never created
    show.prefetch!
    # set the cache for the next visit and have it expire after +TIMEOUT+
    $redis.setnx("shows:#{show.id}", TIMEOUT, Marshal.dump(show))
    show
  end
end 
```

在转储对象之前预取所有关系很重要，否则在解组缓存对象后会访问数据库。

下面是一个预取的例子：

```
class Show
  def prefetch!
    @actors ||= actors
    self
  end

  def actors
    @actors || 1.upto(10).map do |n|
      Actor.new(n)
    end
  end
end

class Actor
  def initialize(n)
    puts "initialize actor #{n}"
  end
end

show = Show.new.prefetch!
cache = Marshal.dump(show)
Marshal.load(cache).actors.length  # uses value stored in @actors

show2 = Show.new
cache2 = Marshal.dump(show2)
Marshal.load(cache2).actors.length  # calls database 
```

# sql-server-2008 - 通过使用 osql.exe 运行 .sql 脚本来生成 .csv 文件

> ID：13072607
> 
> 赞同：1
> 
> 时间：2012-10-25T16:01:49.267
> 
> 标签：sql-server-2008, tsql, ssis, ssms, osql

我在文件夹中有一个脚本文件。我想使用 TSQL 运行此脚本而不在 SSMS 中打开它，因为我将使用 SSIS 运行此脚本以生成 CSV。

我已经使用 OSQL 通过使用 Execute Process Task 来实现这一点，但它并没有给我我正在寻找的确切结果。它在 csv 中生成空间。当我使用 OSQL 代码执行时，我通过右键单击导出为 CSV 选项的 17 mb 文件变成了 1gb。我使用的 OSQL 是：

`-E -S CCCMSDSQL20,1819 -d SHARE_SCRUB -q "SET NOCOUNT ON" -i "C:\Scripts\.SQL" -o "C:\Scripts\.csv" -n -h-1 -s"," -w 700`

我更喜欢可以实现相同功能的 TSQL 脚本，这样我就可以在执行 SQL 任务中使用它并获得结果。

编辑：我正在努力从一个文件夹中的多个 .sql 文件生成多个 csv。我正在使用每个循环容器并执行流程任务。我想更改执行流程任务以执行 sql 任务并使用此脚本生成多个文件。

如果可以编写一个 TSQL 代码，它可以在一个脚本中循环和生成 CSV 文件，我可以在不使用包的情况下使用它。

感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:54:41.450

你的 osql 参数是我所期望的，我只是做了一个小演示来做类似的事情，它可以正常工作。

我会检查您的实际 sql 脚本及其在 SSMS 中的结果，以确保它不会返回超出您想要的内容。

此外，它可能不是您想要的，因为您还打算将它与 Execute SQL 任务一起使用，但我会指出 bcp 是专门为将数据复制进和复制出 SQL 而设计的，您可以使用纯 T-SQL使用 opendatasource 制作 CSV 文件，而不使用 -o 将 OSQL 的结果转储到文件中。

# css - RGBA CSS3 16 位渐变？

> ID：13072610
> 
> 赞同：2
> 
> 时间：2012-10-25T16:01:54.697
> 
> 标签：css, webkit, gradient

我现在使用 CSS3 渐变，我注意到从几个版本的 Webkit 和 Gecko 中，当您在颜色值中使用 RGBA 时，渐变上会出现一些线条，就像它只有 16 位一样。

A做了一个JSBin，用Chrome检查一下：http: [//jsbin.com/ojadan/4/edit](http://jsbin.com/ojadan/4/edit)

有人找到解决这个问题的方法吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:36:41.857

我找到了这个资源。这个对我有用。

[http://css-tricks.com/examples/CSS3Gradient/](http://css-tricks.com/examples/CSS3Gradient/)

至于屏幕上颜色渐变的平滑程度，您可能需要检查图形加速器/显示设置。确保它们设置为 16 位或更好的 32 位。即使是 16 位，有时也会显示一些颜色分级。当然，这可能因浏览器而异。您几乎无法从代码中解决此问题。

祝你好运

# mysql - 如何从列或字段中获取记录？

> ID：13072611
> 
> 赞同：0
> 
> 时间：2012-10-25T16:01:53.680
> 
> 标签：mysql

我有一个表，其中有一列名为 balance。

```
if(mysqli_num_rows($get_bank_check_res) > 0){
    $display_block = "<p>your autho code is:</p>";
    $account_check = mysql_fetch_array($get_bank_check_res);
    $balance= $account_check > $grand_total_safe ? (balance - $grand_total_safe) : 0;
    $display_block .= "<p>your balance is: '".$balance."' </p>"; 
```

我收到警告：未定义的变量余额。尝试 mysql_fetch_assoc() 也没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:05:03.553

你会得到一行`mysql_fetch_array`，它不会自动为你创建新变量。即您的专栏位于此处。此外，由于您使用的是 MySQLi 扩展而不是 mysql，它看起来像这样：

```
$row = $get_bank_check_res->fetch_assoc();
$balance = $row["balance"]; 
```

然后你可以使用`$row`数组中的值来做任何数学运算。

# asp.net-mvc-4 - 如何使用soapui测试asp.net webapi

> ID：13072612
> 
> 赞同：2
> 
> 时间：2012-10-25T16:01:59.347
> 
> 标签：asp.net-mvc-4, asp.net-web-api

如何使用 SoapUI 应用程序测试 MVC 4 的 ASP.net WebAPI。？

# javascript - 如何使用 JQuery 获取 HTML 表单数据并写入 XML？

> ID：13072613
> 
> 赞同：0
> 
> 时间：2012-10-25T16:02:01.217
> 
> 标签：javascript, jquery, html, xml

我有一个看起来像这样的表格：

```
<form method="post" id="aodform">
<label for="a">Animal:</label>
<input class="input" type="text" name="a"/>
<label for="s">Sausage:</label>
<input class="input" type="text" name="s"/>
<label for="g">Bird:</label>
<input class="input" type="text" name="g"/>
<label for="d">Dessert:</label>
<input class="input" type="text" name="d"/>
<input id="submitter" type="submit"/>
</form> 
```

我需要在表单中输入值并覆盖（替换）EXISTING XML 文件中相应节点的文本值，如下所示：

```
<aod>
<animal>x</animal>
<sausage>x</sausage>
<bird>x</bird>
<dessert>x</dessert>
</aod> 
```

现在，我知道我可以使用

```
$("#aodform").submit(); 
```

在Jquery中实现表单提交，但在此之后我迷路了！我试图弄清楚如何获取这些表单值，将它们作为变量存储在一个函数中，然后写入 XML 文件（全部在 Jquery 中）。

我搜索了整个谷歌框，发现了类似的主题，但不太相似，不足以帮助我的情况。有人可以帮助我吗？谢谢！

PS 我不能使用任何服务器端语言，比如 PHP，否则我会。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:39:24.447

出于安全考虑，您将无法使用 javascript/jquery 创建或编辑本地 XML 文件。想象一下，去一个网站，网站管理员写了一些代码做谁知道什么，然后把它放在你电脑上的一个文件中......

使用 javascript 写入本地文件的唯一方法是使用 cookie 或 HTML5 [localStorage](http://coding.smashingmagazine.com/2010/10/11/local-storage-and-how-to-use-it/)。

localStorage 将允许您存储字符串键和数组的值和/或对象的属性名称和值。

如果您需要 XML 文件，则必须调用有权在服务器上写入文件的服务器端脚本，然后您可以通过其 url 访问该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:06:12.640

客户端的 jQuery 和 Javascript 不能持久化到服务器端。它无权写入代码。您将必须获得对服务器端语言的访问权限，或使用一些基于云的服务（例如，您可以通过 Javascript API 调用在云服务）。

虽然您可以使用 Javascript/jQuery 在客户端构建 XML 对象，但您必须将其提交给某些服务器端脚本以将其保存到文件中。

很抱歉成为坏消息的承担者，但如果您希望能够完成这项工作，您将需要进入功能更全面的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:10:44.787

您必须在隐藏输入等中发送标签：

```
<form method="post" id="aodform">
<label for="a">Animal:</label>
<input type="hidden" name="a_label" value="Animal"/>
<input class="input" type="text" name="a"/>
<label for="s">Sausage:</label>
<input type="hidden" name="s_label" value="sausage"/>
<input class="input" type="text" name="s"/>
<label for="g">Bird:</label>
<input type="hidden" name="g_label" value="bird"/>
<input class="input" type="text" name="g"/>
<label for="d">Dessert:</label>
<input type="hidden" name="d_label" value="dessert"/>
<input class="input" type="text" name="d"/>
<input id="submitter" type="submit"/>
</form> 
```

然后在 PHP 中访问对：

```
$name = "a";  // "s", "g", "d"

$tag = $_POST[$name.'_label'];
$value = $_POST[$name];
$xml_element = "<$tag>$value</$tag>"; 
```

或者

使用与标签相同的名称，然后使用：

```
foreach($_POST as $key => $value)    
{
    $xml_element = "<$key>$value</$key>";
    ...
} 
```

# vb.net - vb.net：listbox.items.add() 在同一个类中抛出异常

> ID：13072621
> 
> 赞同：0
> 
> 时间：2012-10-25T16:02:22.437
> 
> 标签：vb.net, multithreading, visual-studio-2010, delegates, invoke

我什至不确定我是否足够了解这种情况来想出一个合适的标题。我来自对 VB6 的适度了解，并且不得不为 VB 2010 攀登陡峭的学习曲线。

我正在尝试创建一个与我的 Enterprise iPhone 应用程序通信的多客户端服务器程序。我在这里找到了一个相对简单的示例：http: [//www.strokenine.com/blog/](http://www.strokenine.com/blog/?p=218) ?p=218 。我已经能够修改代码以使其与我的应用程序一起工作，但有一个小故障：我无法访问表单上的控件以添加项目，即使该方法是在表单的类中调用的。（我也在原始代码上试过这个，它做同样的事情。我不知道作者是如何让它工作的。）

这是有问题的代码段：

```
Public Class Server 'The form with the controls is on/in this class.
Dim clients As New Hashtable 'new database (hashtable) to hold the clients

    Sub recieved(ByVal msg As String, ByVal client As ConnectedClient)
    Dim message() As String = msg.Split("|") 'make an array with elements of the message recieved
    Select Case message(0) 'process by the first element in the array
        Case "CHAT" 'if it's CHAT
            TextBox3.Text &= client.name & " says: " & " " & message(1) & vbNewLine 'add the message to the chatbox
            sendallbutone(message(1), client.name) 'this will update all clients with the new message
            '                                       and it will not send the message to the client it recieved it from :)
        Case "LOGIN" 'A client has connected
            clients.Add(client, client.name) 'add the client to our database (a hashtable)
            ListBox1.Items.Add(client.name) 'add the client to the listbox to display the new user
    End Select

End Sub 
```

在案例“LOGIN”下，代码尝试将登录 ID 添加到列表框。它抛出一个异常：“System.Windows.Forms.dll 中发生'System.InvalidOperationException'类型的第一次机会异常”列表框（所有控件，就此而言）在同一个类中，Server.vb 和 Server.vb [设计]。

数据来自客户端登录时创建的另一个类，这会引发切换回 Server 类的事件：

```
Public Class ConnectedClient

Public Event gotmessage(ByVal message As String, ByVal client As ConnectedClient)    'this is raised when we get a message from the client
Public Event disconnected(ByVal client As ConnectedClient)    'this is raised when we get the client disconnects

Sub read(ByVal ar As IAsyncResult) 'this will process all messages being recieved
    Try
        Dim sr As New StreamReader(cli.GetStream) 'initialize a new streamreader which will read from the client's stream
        Dim msg As String = sr.ReadLine() 'create a new variable which will be used to hold the message being read
        RaiseEvent gotmessage(msg, Me) 'tell the server a message has been recieved. Me is passed as an argument which represents 
        '                               the current client which it has recieved the message from to perform any client specific
        '                               tasks if needed
        cli.GetStream.BeginRead(New Byte() {0}, 0, 0, AddressOf read, Nothing) 'continue reading from the stream
    Catch ex As Exception
        Try 'if an error occurs in the reading purpose, we will try to read again to see if we still can read
            Dim sr As New StreamReader(cli.GetStream) 'initialize a new streamreader which will read from the client's stream
            Dim msg As String = sr.ReadLine() 'create a new variable which will be used to hold the message being read
            RaiseEvent gotmessage(msg, Me) 'tell the server a message has been recieved. Me is passed as an argument which represents 
            '                               the current client which it has recieved the message from to perform any client specific
            '                               tasks if needed
            cli.GetStream.BeginRead(New Byte() {0}, 0, 0, AddressOf read, Nothing) 'continue reading from the stream
        Catch ' IF WE STILL CANNOT READ
            RaiseEvent disconnected(Me)  'WE CAN ASSUME THE CLIENT HAS DISCONNECTED
        End Try

    End Try
End Sub 
```

我希望我能理解这一切。这一切似乎来回反弹，似乎如此曲折。

我试过使用 Me.listbox1 和 Server.listbox1 以及其他几个类似的结构，但无济于事。

我正在阅读很多有关 Invoke 和 Delegates 的内容，但是如果方法和控件在同一个类中，那是否有必要？还是我对什么是类有基本的误解？

非常感谢我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:04:45.893

```
 Private Delegate Sub UpdateListDelegate(byval itemName as string)
    Private Sub UpdateList(byval itemName as string)
    If Me.InvokeRequired Then
        Me.Invoke(New UpdateListDelegate(AddressOf UpdateList), itemName)
    Else
        ' UpdateList
        ' add list add code
        ListBox1.Items.Add(itemName)
    End If
    End Sub 
```

添加上面，然后替换：

```
 ListBox1.Items.Add(client.name) 
```

到

```
 UpdateList(client.name) 
```

它有效吗？检查语法，我输入时可能有错字。

# cuda - 内核中的新运算符..奇怪的行为

> ID：13072624
> 
> 赞同：2
> 
> 时间：2012-10-25T16:02:35.310
> 
> 标签：cuda

我想知道是否有人可以通过内核中的 new 运算符阐明这种行为。以下是代码

```
#include <stdio.h>
#include "cuda_runtime.h"
#include "cuComplex.h"
using namespace std;
__global__ void test()
{

    cuComplex *store;
    store= new cuComplex[30000];
    if (store==NULL) printf("Unable to allocate %i\n",blockIdx.y);
    delete store;
    if (threadIdx.x==10000) store->x=0.0;
}

int main(int argc, char *argv[])
{
    float timestamp;
    cudaEvent_t event_start,event_stop;
    // Initialise

    cudaEventCreate(&event_start);
    cudaEventCreate(&event_stop);
    cudaEventRecord(event_start, 0);
    dim3 threadsPerBlock;
    dim3 blocks;
    threadsPerBlock.x=1;
    threadsPerBlock.y=1;
    threadsPerBlock.z=1;
    blocks.x=1;
    blocks.y=500;
    blocks.z=1;

    cudaEventRecord(event_start);
    test<<<blocks,threadsPerBlock,0>>>();
    cudaEventRecord(event_stop, 0);
    cudaEventSynchronize(event_stop);
    cudaEventElapsedTime(&timestamp, event_start, event_stop);
    printf("test took  %fms \n", timestamp);
} 
```

在 GTX680 Cuda 5 上运行此程序并调查输出会注意到未分配随机内存 :( 我在想可能是因为所有全局内存都已完成但我有 2GB 内存并且因为活动块的最大数量是16 使用这种方法分配的内存量最大应该是 16*30000*8=38.4x10e6.. 即大约 38Mb。那我还应该考虑什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:06:04.077

该问题与 malloc() 和 free() 设备系统调用所使用的堆大小有关。`section 3.2.9 Call Stack`有关更多详细信息，请参阅`appendix B.16.1 Heap Memory Allocation`NVIDIA CUDA C 编程指南。

如果您将堆大小设置为适合您的内核要求，您的测试将起作用

```
 cudaDeviceSetLimit(cudaLimitMallocHeapSize, 500*30000*sizeof(cuComplex)); 
```

# .net - 创建一个文件夹，该文件夹将链接到多个其他文件夹中的文件

> ID：13072625
> 
> 赞同：0
> 
> 时间：2012-10-25T16:02:37.753
> 
> 标签：.net, winapi

我可能有点超出我的深度，但我认为这应该是可能的，我想知道是否有一种方法可以创建一个文件夹，该文件夹可以查看许多其他文件夹并创建指向这些文件夹中某些文件的链接。本质上，这个想法是一个部门有很多文件分散在很多文件夹中，另一个部门需要访问这些文件，但不想浏览不熟悉、相对复杂的目录，所以我想创建一个文件夹，为他们需要的一切创建快捷方式，并在添加新文件时更新其中包含的快捷方式。

我应该使用 Win32 API 还是 .NET 框架？或者这些都不适合我正在尝试的东西？非常感谢任何建议。

谢谢，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:17:14.260

您可以在文件夹中创建指向另一个文件夹中的文件的[硬链接/连接点](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365006.aspx)或[符号链接。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365680.aspx)

# php - 将php链接变量放在javascript中？

> ID：13072627
> 
> 赞同：0
> 
> 时间：2012-10-25T16:02:47.020
> 
> 标签：php, javascript, hyperlink

有谁知道这是否可能？

我有一个 javascript，当用户将鼠标悬停在表格行下方时，它会突出显示表格行。现在，当您单击它时，它还会链接到一个页面。但我想将 php 添加到我的链接中。可以做到吗？

我自己尝试过，但它给了我这个错误：解析错误：语法错误，意外'"'，期待 T_STRING

```
<script>
     $(function() {
        $('tr').hover(function() {
            $(this).css('background-color', '#eee');
            $(this).contents('td').css({'border': '0px solid red', 'border-left': 'none', 'border-right': 'none'});
            $(this).contents('td:first').css('border-left', '0px solid red');
            $(this).contents('td:last').css('border-right', '0px solid red');
        },
        function() {
            $(this).css('background-color', '#FFFFFF');
            $(this).contents('td').css('border', 'none');
            $('tr').click(function() { 
    document.location = <?php \"read_message.php?msg={$inbox[0]}\">{$inbox['subject']}"; ?>';
} );
        });
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:09:33.273

您收到解析器错误，因为`$inbox['subject']`可能包含一些会破坏字符串开头和结尾撇号的撇号。

尝试使用以下内容：

```
document.location = "<?php echo "read_message.php?msg={$inbox[0]}>{$inbox['subject']}" ?>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:03:56.050

尝试

```
document.location = <?php echo '"read_message.php?msg='.$inbox[0].'">'.$inbox['subject']  ; ?> 
```

或者

```
 document.location = "read_message.php?msg=<?php echo $inbox[0]; ?>"><?php echo $inbox['subject'].'"'; ?>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:04:36.533

`document.location = '<?php echo \"read_message.php?msg={$inbox[0]}\">{$inbox['subject']}"; ?>';`

# crystal-reports - 子报表中的变量能否用于对主报表中的信息进行分组（水晶 10）

> ID：13072628
> 
> 赞同：2
> 
> 时间：2012-10-25T16:02:47.100
> 
> 标签：crystal-reports, subreports

我已经建立了一个主报告，其中包含 2 个子报告。
主报告包含一个表：ROOM 和两个参数：STARTDATE 和 ENDDATE。日期范围仅在主报告中，因此可以显示在标题区域中。更重要的是，它链接到 2 个子报表。

现在，主要报告按设施分组，然后按房间名称分组。一切都很好，直到我尝试运行它超过一天。我想要的是主报告也按日期分组，但我不知道这是否可能，因为 ROOM 表不包含将参数链接到的日期字段，以便我可以在分组中使用它.

是否可以在子报表中创建一个 Date 变量，然后可以将其传递回主报表以用于分组？如果这是一个愚蠢的问题，我深表歉意，但我不经常使用变量，共享变量甚至比其他任何变量都少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:28:19.260

简短的回答：不。您永远不能将主报表与子报表中的变量分组。Crystal 在评估过程的早期确定报告的组，在它查看任何子报告之前。

一般来说，您可能首先要问自己如何避免使用子报表。在我看来，当根本没有其他方法可以在单个报告中完成您想要的事情时，使用子报告是最后的努力。在您的情况下，如果您的主报表仅由一个表 (ROOM) 组成，那么您只需将表从子报表移动到主报表，然后将它们连接到 ROOM。这样做可以让您自由地轻松分组您想要的任何字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T05:25:27.360

从技术上讲，您可以将这些值从子报告获取到主报告。

此简介描述了“共享”范围变量。

> 共享变量（Crystal 语法）
> 
> 共享变量使用相同的内存块来存储整个主报表及其所有子报表中的变量值。因此，共享变量甚至比全局变量更通用。要使用共享变量，请在主报表的公式中声明它，如下例所示：
> 
> 共享 NumberVar x := 1000;
> 
> 并在子报表的公式中声明它，如下例所示：
> 
> 共享号码变量 x;
> 
> 为了使用共享变量，必须先声明变量并为其赋值，然后才能在主报表和子报表之间传递。

*共享*变量非常适合跨越主报告和一个或多个子报告的聚合（总和等）。

**更多信息**可以在这里找到：http: [//publib.boulder.ibm.com/infocenter/radhelp/v6r0m1/index.jsp](http://publib.boulder.ibm.com/infocenter/radhelp/v6r0m1/index.jsp?noscript=1) ?noscript= 1 通过搜索“可变范围”

# c# - Excel 互操作工作表副本引发异常 HRESULT：0x800A03EC

> ID：13072629
> 
> 赞同：4
> 
> 时间：2012-10-25T16:02:49.703
> 
> 标签：c#, excel, interop, excel-interop

我在使用 Interop 在 Excel 2003 中复制工作表时遇到问题。该代码适用于 30-40 个副本，然后抛出异常“HRESULT 异常：0x800A03EC”。[以下测试代码已包含http://support.microsoft.com/kb/210684/en-us](http://support.microsoft.com/kb/210684/en-us)中建议的补丁，但没有成功。有谁知道任何解决方法？提前致谢

```
using Excel = Microsoft.Office.Interop.Excel;

private void button2_Click(object sender, EventArgs e)
    {
        string template_path = @"c:\temp\template.xlt";
        string filename = @"c:\temp\testxl1.xls";
        if (File.Exists(filename))
            File.Delete(filename);

        object missing = System.Reflection.Missing.Value;

        System.Globalization.CultureInfo my_culture = System.Threading.Thread.CurrentThread.CurrentCulture;
        System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo("en-US");

        Excel.ApplicationClass xlapp = new Excel.ApplicationClass();
        xlapp.Visible = true;
        xlapp.UserControl = true;

        Excel.Workbook xlwb = xlapp.Workbooks.Add(template_path);

        xlwb.SaveAs(@filename,
            missing, missing, missing, missing, missing,
            Excel.XlSaveAsAccessMode.xlNoChange,
            missing, missing, missing, missing, missing);

        Excel.Worksheet xlws = xlwb.Worksheets["diario"] as Excel.Worksheet;

        int copies = 200;

        for (int i = 0; i < copies; i++)
        {
            #region Patch kb/210684

            if (copies % 10 == 0)
            {                    
                xlwb.Close(true, missing, missing);
                System.Runtime.InteropServices.Marshal.ReleaseComObject(xlwb);
                xlwb = null;

                System.Runtime.InteropServices.Marshal.ReleaseComObject(xlws);
                xlws = null;

                Application.DoEvents();

                xlwb = xlapp.Workbooks.Open(@filename, 0,
                    missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);
                xlws = xlwb.Worksheets["diario"] as Excel.Worksheet;

            }

            #endregion

            xlws.Copy(System.Reflection.Missing.Value, xlwb.Worksheets.Count);
        }

        System.Runtime.InteropServices.Marshal.ReleaseComObject(xlws);
        xlws = null;

        xlwb.Close(true, missing, missing);
        System.Runtime.InteropServices.Marshal.ReleaseComObject(xlwb);
        xlwb = null;

        xlapp.Quit();
        System.Runtime.InteropServices.Marshal.ReleaseComObject(xlapp);
        xlapp = null;

        System.Threading.Thread.CurrentThread.CurrentCulture = my_culture;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:25:48.047

我唯一能找到的是，当本地计算机未设置为美国英语时，异常可能是 Excel LCID 问题。

[http://www.made4dotnet.com/Default.aspx?tabid=141&aid=15](http://www.made4dotnet.com/Default.aspx?tabid=141&aid=15)

或者

[http://support.microsoft.com/kb/320369/en-us](http://support.microsoft.com/kb/320369/en-us)

# netty - 使用 in-vm 通道与短路进行本地 java 对象-对象调用有什么好处吗？

> ID：13072633
> 
> 赞同：3
> 
> 时间：2012-10-25T16:03:02.137
> 
> 标签：netty

背景：我正在设计一个联邦/分布式解决方案的原型，该解决方案将使用 Netty 作为通信基础设施。

我知道我将不得不围绕 Netty 创建一些功能来实现我们所需要的，但我想了解 Netty 提供了什么，所以我不会重新发明轮子。

目标：我需要提供一个通用的通信调度层，它将根据正在与之通信的目标端点自动选择适当的通信通道。

如果目标是本地的，我们要在-vm中进行通信。如果它是远程的，我们计划在 websockets 上使用我们自己的二进制格式。我们会知道它是本地的还是远程的，所以这是创建/选择正确频道的问题。

我希望每个服务器实例都有某种通道缓存/映射。这将包括：

*   1 个（虚拟机内）通道
*   0+ (websocket) 通道：每个服务器-服务器通道 1

问题：鉴于我们的目标，对于本地（虚拟机内）通信，我们是否应该：

*   使用本地频道？
*   使用嵌入式频道？- 不确定这是为了什么
*   不使用官方频道，直接通话和通话？

使用 LocalChannel 与短路本地呼叫有很大的性能差异吗？如果我们可以在本地情况下消除编码/解码，那将是首选。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T03:45:19.230

[我在以下多人游戏服务器](https://github.com/menacher/java-game-server)中使用 Jetlang 和 Netty 进行虚拟机内消息传递。您可能想查看[代码的 UDP 部分](https://github.com/menacher/java-game-server/blob/master/jetserver/src/main/java/org/menacheri/jetserver/handlers/netty/UDPUpstreamHandler.java)以了解我如何进行会话查找等。这似乎与您的用例有点相似。
`EmbeddedChannel`用于测试目的。请查看 jetserver 的测试用例以查看其使用示例。它不适用于主流用途。
不知道不使用频道你会怎么做，所以我无法回答那篇文章。

# python - python脚本和C应用程序之间不断通信

> ID：13072634
> 
> 赞同：3
> 
> 时间：2012-10-25T16:03:03.867
> 
> 标签：python, c

我有一个 python 脚本，它与一些网络池连接以从中读取数据，即连续 320 位。这 320 位应该转发给某个 C 应用程序，该应用程序会不断地从 python 脚本中读取这 320 位并将它们放入一个 int 数组[8]。老实说，我根本不知道这是否可能，并且会感谢这个问题的起点。

我试图配合你的一些想法，试图通过标准输入从 python 发送数据到 C 应用程序：

测试.exe：

```
#include <stdio.h>
int main(void)
{
    int ch;
    /* read character by character from stdin */
    do {
    ch = fgetc(stdin);
    putchar(ch);
    } while (ch != EOF);

    return 0;
} 
```

测试.py：

```
def run(self):

    while True:           
        payload = 'some data'
        sys.stdout.write(payload)
        time.sleep(5) 
```

然后我使用管道开始这整个事情：python test.py | 测试程序

不幸的是，在 test.exe 端没有收到数据，这个数据不应该在标准输入上可用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T17:08:39.967

有几种可能的方式。

[`subprocess`](http://docs.python.org/library/subprocess.html)您可以使用该模块从 python 程序启动 C 程序。在这种情况下，您可以从 python 程序写入 C 程序的标准输入。这可能是最简单的方法。

```
import subprocess

network_data = 'data from the network goes here'
p = subprocess.Popen(['the_C_program', 'optional', 'arguments'], 
                     stdin=subprocess.PIPE)
p.stdin.write(network_data) 
```

注意如果你想多次发送数据，那么你不*应该*使用`Popen.communicate()`.

或者，您可以使用[socket](http://docs.python.org/library/socket.html)。但是您必须修改这两个程序才能做到这一点。

**编辑**：JF Sebatian 关于在命令行上使用管道的评论非常真实，我忘记了！但是上述技术仍然有用，因为它是一个需要记住的命令，特别是如果你想在 python 和 C 程序之间进行双向通信（在这种情况下，你必须添加`stdout=subprocess.PIPE`到`subprocess.Popen`调用中，然后你的 python 程序可以读自`p.stdout`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T18:59:26.677

已经提到：

1.  插座（小心取景）
2.  消息队列

新建议：

1.  ctypes（将 C 代码打包为共享对象，并使用 ctypes 从 python 调用它）
2.  Cython/Pyrex（一种类似 Python 的语言，可让您非常自由地混合 Python 和 C 数据）
3.  SWIG（一种语言接口系统）

事实上，套接字和消息队列可能是一种更安全的方法。但它们也可能意味着更多的代码更改。

# spring - Spring 3.1 + Hibernate 4.1 - 在 webapp 完成部署之前运行代码

> ID：13072638
> 
> 赞同：0
> 
> 时间：2012-10-25T16:03:20.327
> 
> 标签：spring, hibernate

我有一个基于 Spring 的 webapp，它使用 Hibernate 保存数据。部署服务时出现的默认网页会立即对数据发出 ajax 请求。因此，如果数据尚不存在，则需要对其进行提取和持久化。我想确保在部署服务时，在春天来临之前，tomcat 提供我的网页，我可以执行代码来获取和保存我的数据。

我认为常规上下文侦听器可能会解决问题，但我不知道是否有任何保证它会在其他所有内容初始化之前完成。春天有什么东西可以做到这一点吗？或者上下文侦听器会解决问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:36:16.613

您可以使用spring的应用程序事件（上下文事件），请参阅[文档](http://static.springsource.org/spring/docs/2.5.x/reference/beans.html#context-functionality-events)`ContextStartedEvent`

# c# - 以编程方式在运行时的 gridview 中显示图像

> ID：13072640
> 
> 赞同：0
> 
> 时间：2012-10-25T16:03:30.643
> 
> 标签：c#, asp.net, gridview

我正在使用表单来插入数据。这个表单有一个文件上传控件，我用它来上传图像。我已经使用 DataAdapter 和 Dataset 来显示使用关键字搜索后将显示的数据。因此，我将数据集分配给了gridview。现在，问题是我想显示图像，而分配给 gridview 的数据集不能有图像。如何将图像与数据集中的数据一起显示？这是我的代码：

```
public string getConString()
{
    return System.Configuration.ConfigurationManager.ConnectionStrings["ConString"].ConnectionString;
}

protected void Page_Load(object sender, EventArgs e)
{
    SqlConnection con = new SqlConnection(getConString());
    string inp = Request.QueryString["srch"].ToString();
    string qry = "select Category,Title,Make,Model,Condition,Price from product WHERE Category like '%" + inp + "%' OR title like '%" + inp + "%' OR make like '%" + inp + "%'OR city like '%" + inp + "%'OR state like '%" + inp + "%'";
    SqlDataAdapter da = new SqlDataAdapter(qry, con);
    DataSet ds = new DataSet();
    con.Open();
    da.Fill(ds);
    con.Close();
    GridView1.DataSource = ds;
    GridView1.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:16:49.453

将 GridView 的 AutoGenerateColumns 属性设置为 false，然后手动将列放入网格的源代码中。

图像可以通过这种方式显示：

```
<Columns>
<asp:ImageField DataImageUrlField="image field of your dataset"></asp:ImageField>
</Columns> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:13:02.873

您可以在 gridview 中使用模板字段。这允许您编辑每列的显示方式。这代替了您的绑定字段。

```
<asp:TemplateField HeaderText="FirstName" SortExpression="FirstName"> 
<ItemTemplate>
     <%# Bind("FirstName") %> <img src="..." />
     or <img src='<%# Bind("ImageLocation_db_column") %>' />
</ItemTemplate> 
</asp:TemplateField> 
```

# ssh - 在 sh 脚本中触摸 htaccess 文件

> ID：13072644
> 
> 赞同：0
> 
> 时间：2012-10-25T16:03:46.973
> 
> 标签：ssh, touch, sh

我正在尝试通过 ssh 使用 .sh 脚本修改/触摸 .htaccess 文件。当前的代码是我所拥有的，但是由于语法不正确，我肯定会遇到错误。我假设必须在第 18 行正确配置撇号、引号或反斜杠。如果您看到我在哪里出错，请告诉我。

这是代码：

```
#!/bin/sh

touch /home/hessyste/public_html/.htaccess
echo "<IfModule mod_php5.c>
  php_value upload_max_filesize 30M
  php_value post_max_size 30M
  php_value max_execution_time 1200
  php_value max_input_time 1200
  php_value display_errors On
  php_value error_reporting E_ALL

</IfModule>

LimitRequestBody 31457280

<IfModule mod_setenvif.c>
  <IfDefine SSL>
    SetEnvIf User-Agent ".*MSIE.*" \
             nokeepalive ssl-unclean-shutdown \
             downgrade-1.0 force-response-1.0
  </IfDefine>
</IfModule>

RewriteEngine On
RewriteBase /${dir}
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php
RewriteRule ^(.*)-p-(.*).html$ product_info.php?products_id=$2&%{QUERY_STRING}
RewriteRule ^(.*)-c-(.*).html$ index.php?cPath=$2&%{QUERY_STRING}
RewriteRule ^(.*)-m-(.*).html$ index.php?manufacturers_id=$2&%{QUERY_STRING}
RewriteCond %{REQUEST_URI} !^/cpanel
RewriteRule ^([A-Z0-9\-\_]+)/?$ index.php?ref_name=$1 [NC,L]
RewriteRule contact_page contact_us.php

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*).php$ index.php [NC,L]" > /home/hessyste/public_html/.htaccess 
```

这是错误：/touch.sh: line 19: nokeepalive: command not found

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:06:23.087

脚本中的这一行用双引号引起来，从而关闭 echo 命令中的引号。您需要将回显引号更改为单引号或将该行周围的引号更改为单引号。如果我是你，我会选择第一个。

```
 SetEnvIf User-Agent ".*MSIE.*" \ 
```

**更新。以下 echo 命令对我来说很好。复制并粘贴它。

```
echo '<IfModule mod_php5.c>
  php_value upload_max_filesize 30M
  php_value post_max_size 30M
  php_value max_execution_time 1200
  php_value max_input_time 1200
  php_value display_errors On
  php_value error_reporting E_ALL

</IfModule>

LimitRequestBody 31457280

<IfModule mod_setenvif.c>
  <IfDefine SSL>
    SetEnvIf User-Agent ".*MSIE.*" \
             nokeepalive ssl-unclean-shutdown \
             downgrade-1.0 force-response-1.0
  </IfDefine>
</IfModule>

RewriteEngine On
RewriteBase /${dir}
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php
RewriteRule ^(.*)-p-(.*).html$ product_info.php?products_id=$2&%{QUERY_STRING}
RewriteRule ^(.*)-c-(.*).html$ index.php?cPath=$2&%{QUERY_STRING}
RewriteRule ^(.*)-m-(.*).html$ index.php?manufacturers_id=$2&%{QUERY_STRING}
RewriteCond %{REQUEST_URI} !^/cpanel
RewriteRule ^([A-Z0-9\-\_]+)/?$ index.php?ref_name=$1 [NC,L]
RewriteRule contact_page contact_us.php

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*).php$ index.php [NC,L]' 
```

# html - POST 表单并阻止响应

> ID：13072648
> 
> 赞同：0
> 
> 时间：2012-10-25T16:03:52.433
> 
> 标签：html, forms, post

我有以下表格：

```
<form method="post" action="http://domain.com/api.json?param=value"></form> 
```

提交此表格后，这将用来自的回复替换我的文档`http://domain.com/api.json`。

是否可以发布此表单，但阻止接收响应，并将现有的 HTML 与`form`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:11:36.537

发送 HTTP 204 No Content[响应](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)而不是通常的 200 OK 响应。

> 10.2.5 204 无内容
> 
> 服务器已完成请求，但不需要返回实体主体，并且可能希望返回更新的元信息。响应可能包括实体头形式的新的或更新的元信息，如果存在，应该与请求的变体相关联。
> 
> 如果客户端是用户代理，它不应该改变导致请求被发送的文档视图。这个响应主要是为了允许输入动作发生而不导致用户代理的活动文档视图发生变化，尽管任何新的或更新的元信息应该应用于当前在用户代理的活动视图中的文档。
> 
> 204 响应不能包含消息体，因此总是由头字段之后的第一个空行终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:08:57.273

您可以只使用 AJAX（本例中为 XMLHttpRequest）提交帖子

```
var xmlhttp = new XMLHttpRequest();
xmlhttp.open("POST", "http://domain.com/api.json?param=value", true);
xmlhttp.send(null); 
```

手头，如果你需要。您可以获取参数值并对其进行编码：

```
var val = encodeURIComponent(document.getElementById("param").value); 
```

那么第二行会更像：

```
xmlhttp.open("POST", "http://domain.com/api.json?param="+val, true); 
```

否则，来自 a 的任何类型的提交`form`都会加载一个页面。一个技巧是将其放入隐藏的 iframe 中，并在完成后删除 iframe。

# c# - GridView allowPaging=true 不显示页码 2 和 3。显示 14567

> ID：13072649
> 
> 赞同：0
> 
> 时间：2012-10-25T16:03:55.760
> 
> 标签：c#, gridview, paging

我有一个需要分页的gridview。当我allowPaging = true时，它显示145678910 ....它不会显示第2页和第3页。如果我尝试将模式更改为NextPreviousFirstLast，它只会在第一页显示“Next”，如果我点击它，它只在第二页显示“第一”和“最后”。这是代码：

```
<asp:GridView ID="GridView1" runat="server" CellPadding="4" ForeColor="Black" AutoGenerateColumns="False" BackColor="#CCCCCC" 
            BorderColor="#666666"    OnRowDataBound  = "HandleRowDataBound" BorderStyle="Solid" BorderWidth="1px" CellSpacing="2" Width ="942px"
            Font-Names="Arial" Font-Size="8pt" ShowHeaderWhenEmpty="True"  CSSClass="mytable" AllowPaging="true" OnPageIndexChanging="GridView1_PageIndexChanging" 
             PageSize="25">
                <PagerSettings  Mode="NextPreviousFirstLast" FirstPageText="First" PreviousPageText="Previous" NextPageText="Next" LastPageText="Last" />
                <Columns>
                    <asp:TemplateField HeaderText="Select" ControlStyle-Width = "30px">
                        <ItemTemplate>
                              <asp:CheckBox runat="server" ID="DiscontinuedCheckBox" CssClass="SelectCheckBox" />
                        </ItemTemplate>
                        <ControlStyle Width="30px"></ControlStyle>
                        <ItemStyle Wrap="False" />
                    </asp:TemplateField>
                    <asp:TemplateField HeaderText="Recall Qty"  ItemStyle-Wrap="true"  ItemStyle-Width="100px"   >
                        <ItemTemplate >
                            <img id="star1" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/>
                            <asp:TextBox runat ="server" ID="textBoxQty" Width = "50px"  Text ="1" ReadOnly="false" />
                        </ItemTemplate>
                        <HeaderStyle Width = "100px" />
                        <ItemStyle Width="100px" />
                        <ItemStyle Wrap="False" Width="60px"></ItemStyle>
                    </asp:TemplateField>

                    <asp:TemplateField HeaderText="Delivery Location"     >
                        <ItemTemplate >
                            <div style="width:200px">
                                <div style ="float : left; ">
                                    <asp:CheckBox runat="server" ID="packShipCB" Text ="Pack Ship &nbsp;&nbsp;&nbsp; or " CssClass="SendToShip"  AutoPostBack="false" />
                                </div> 
                                <asp:TextBox runat ="server" ID="deliveryLocationTB"  CssClass="AllDelivery"  ReadOnly ="false" Width="80px"   />
                            </div>
                        </ItemTemplate>
                        <HeaderStyle Width = "200px" />
                        <ItemStyle Width="200px" />
                        <ItemStyle Width ="160px" />
                    </asp:TemplateField>

                    <%-- <asp:BoundField  HeaderText="Data"  />--%>
                    <asp:BoundField HeaderText="Request Number"  DataField="requestNumber"  ItemStyle-Width = "50px">
                        <HeaderStyle Wrap="True" Width="50px" />
                        <ItemStyle Wrap="True" Width="50px" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Item Number"  DataField="materialLineItemID"  />
                    <asp:BoundField HeaderText="Program" DataField="programName" >
                        <ItemStyle Wrap="False" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Program POC" DataField="programPOC" >
                        <ItemStyle Wrap="False" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Material Number" DataField="materialNumber" ItemStyle-Width="100px">
                        <HeaderStyle Wrap="False" />
                    </asp:BoundField >
                    <asp:BoundField HeaderText="Qty in Storage" DataField="availableQty" ItemStyle-Width="100px">
                        <ItemStyle Width="100px" Wrap="False"></ItemStyle>
                    </asp:BoundField >
                    <asp:BoundField HeaderText="Description" DataField="Description" ItemStyle-Width="300px" >
                        <ItemStyle Width="300px" Wrap="False"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Serialized" DataField="Serialized" ItemStyle-Width="100px">
                        <ItemStyle Width="100px"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Serial Number" DataField="serialNumber" ItemStyle-Width="200px">
                        <ItemStyle Width="200px" Wrap="False"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Shelf Life" DataField="shelfLIfe" DataFormatString="{0:d}" HtmlEncode="false" ItemStyle-Width="100px" >
                        <ItemStyle Width="100px"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Cost Center" DataField="costCenter" ItemStyle-Width="200px">
                        <ItemStyle Width="200px" Wrap="False"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Charge Number" DataField="chargeNumber" ItemStyle-Width="200px">
                        <ItemStyle Width="200px" Wrap="False"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField DataField="contractNumber" HeaderText="Contract Number" ItemStyle-Width="200px">
                        <HeaderStyle Wrap="False" />
                        <ItemStyle Width="200px" />
                    </asp:BoundField>

                    <asp:BoundField DataField="assetTagNumber" HeaderText="Asset Tag Number" ItemStyle-Width="200px">
                        <HeaderStyle Wrap="False" />
                        <ItemStyle Width="200px" />
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Storage Duration" DataField="Duration" ItemStyle-Width="200px">
                        <ItemStyle Width="200px" Wrap="False"></ItemStyle>
                    </asp:BoundField>
                    <asp:BoundField HeaderText="Handling Unit Number" DataField="handlingUnitNumber" ItemStyle-Width="100px">
                        <ItemStyle Width="100px" Wrap="False"></ItemStyle>
                    </asp:BoundField >
                    <asp:BoundField HeaderText="Storage Location" DataField="storageLocation" ItemStyle-Width="100px">
                        <ItemStyle Width="100px" Wrap="False"></ItemStyle>
                    </asp:BoundField >
                    <asp:BoundField HeaderText="Time in Storage" DataField="storageTime" ItemStyle-Width="200px">
                        <ItemStyle Width="200px" Wrap="False"></ItemStyle>
                    </asp:BoundField>
                </Columns>
            <FooterStyle BackColor="#CCCCCC" />
            <HeaderStyle  BackColor="#999999" Font-Bold="True" ForeColor="#880C1B" 
                HorizontalAlign="Center" Font-Size="9pt" Wrap="true" BorderStyle="Solid"  VerticalAlign="Middle"
                BorderWidth="1px"/>
            <PagerStyle BackColor="#CCCCCC" ForeColor="Black" HorizontalAlign="Left"  />
            <RowStyle BackColor="White" HorizontalAlign="Center" CssClass="Unselected" 
                Wrap="false" />
            <SelectedRowStyle BackColor="#000099" Font-Bold="True" ForeColor="White" />
            <SortedAscendingCellStyle BackColor="#F1F1F1" />
            <SortedAscendingHeaderStyle BackColor="#808080" />
            <SortedDescendingCellStyle BackColor="#CAC9C9" />
            <SortedDescendingHeaderStyle BackColor="#383838" />
        </asp:GridView> 
```

这是背后的代码：

```
protected void Page_Load(object sender, EventArgs e)
    {

        siteID = int.Parse(Request.QueryString["s"].ToString());
        FillDetails(); 
    }

    //Pulls data from database for items to be recalled based on site, and user rights and enables to functions of the controls 
    private void FillDetails()
    {
        DataSet materials = RequestDB2.GetStoredMaterialsView(siteID);

        GridView1.DataSource = materials;
        GridView1.DataBind();

        if (GridView1.Rows.Count >= 9) 
            paneling.Style["height"] = "300px";
        //if not items exit
        if (materials == null || materials.Tables[0].Rows.Count == 0)
        {
            Error.InnerText = "You have no materials to be recalled from this site.";
        }
        else
        {
            //Adds thead and tbody tags
            GridView1.HeaderRow.TableSection = TableRowSection.TableHeader;
        }
    }

    protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GridView1.PageIndex = e.NewPageIndex;
        GridView1.DataBind();
    }

    protected void HandleRowDataBound(object sender, GridViewRowEventArgs e)
    {

    } 
```

这是我看到的：![在此处输入图像描述](../Images/1f3104d362850387e359d2bc86ddd421.png)

当我查看萤火虫时，我看到第 2 页和第 3 页有显示：无。关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:15:32.403

尝试使用 PagerSetting 作为..

```
 <PagerSettings  FirstPageText="First Page"  LastPageText="Last Page" 
                   Mode="NumericFirstLast" Position="TopAndBottom" />  

protected void grdView_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    GridView1.DataSource  = RequestDB2.GetStoredMaterialsView(siteID);
    GridView1.PageIndex = e.NewPageIndex;
    GridView1.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:07:05.370

您没有在 GridView1_PageIndexChanging 中分配数据源。您需要在绑定之前分配数据源。你最好尝试调用 FillDetails() 更改

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    GridView1.PageIndex = e.NewPageIndex;
    GridView1.DataBind();
} 
```

至

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    GridView1.PageIndex = e.NewPageIndex;
    FillDetails();       
} 
```

# java - 用于检查模式是否存在的 Java 正则表达式

> ID：13072652
> 
> 赞同：3
> 
> 时间：2012-10-25T16:04:22.650
> 
> 标签：java, regex

我正在尝试查找字符串中是否存在模式。

我要检查的模式是：

> 以空格或“#”开头的字符串，
> 然后是特定字符串“value1”，后跟空格或制表符，
> 然后是“value2”，然后是空格或制表符，
> 以“value3”结尾。

这是一个要检查的示例字符串：

```
String str = "#  value1   values2 value3"; 
```

我尝试了以下*正则表达式*，但它不起作用：

```
str.matches("^\\s+#\\s+value1\\s+value2\\s+value3"); 
```

上述模式总是返回 me `false`。请帮助正则表达式。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:06:25.397

试试这个： -

```
str.matches("^[ #]value1\\s+value2\\s+value3$"); 
```

`[ #]`- 匹配空格或#

`\\s+`- 匹配 1 个或多个空格。因此，它将匹配空格或制表符

**注意**： - 你有`values2`而不是`value2`在你的字符串中。

此外，您发布的示例字符串在开头同时具有 a`space`和 a 。`#`但是您说字符串以 a`space`或 a开头`#`。`#`因此，如果您在第一个之后删除该空格，或者在您的空格之前删除该空格，它将匹配您的字符串，`#`这取决于您所写的内容。

如果您想在字符串的开头匹配 a`space`和 a ，就像您当前发布的那样。你需要使用这个正则表达式： -`#``String`

```
str.matches("^[ #]\\svalue1\\s+value2\\s+value3$"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:07:00.007

好吧，我现在可以告诉你，那个正则表达式会因为那个输入而失败，因为它在`#`

尝试

```
str.matches("^#?\\s+value1\\s+value2\\s+value3$"); 
```

该正则表达式应匹配`"# value1 value2 value3"`或`" value1 value2 value3"`具有可变数量的空格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-13T09:38:12.233

试试这个正则表达式`(\s+|\s?#\s?).*value1.*(\s+|\t).*value2.*(\s+|\t).*value3.*` 即使你在任何地方都有空格它也能工作。

# html - html 标签中的 Grails i18n 消息

> ID：13072653
> 
> 赞同：0
> 
> 时间：2012-10-25T16:04:29.160
> 
> 标签：html, grails, internationalization

我如何在 html 的输入标签中使用 i18n 消息？例如：

```
<input type="text" name="username" placeholder="${message(code:'placeholder.username')}" 
```

以多种语言显示占位符文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:13:18.140

```
<input type="text" name="username" placeholder="${message(code: 'placeholder.username')}"> 
```

# android - 如何设置壁纸（viewpager）

> ID：13072657
> 
> 赞同：0
> 
> 时间：2012-10-25T16:04:35.147
> 
> 标签：android, android-layout, android-viewpager, wallpaper

我想从 viewpager 设置壁纸（选定的图像）。我有不同的图片（R.drawable.a1,R.drawable.a2,R.drawable.a3,R.drawable.a4,R.drawable.a5,R.drawable.a6 ...... ..) 我该怎么办，我想要动态，请帮助我，谢谢

应用程序类；

```
public class App extends Activity  implements OnPageChangeListener {
protected static final Context Context = null;

private Integer[] ListOfID = {
        R.drawable.a1, R.drawable.a2, R.drawable.a3, R.drawable.a4, R.drawable.a5,     R.drawable.a6, R.drawable.a7,
        R.drawable.a8, R.drawable.a9, R.drawable.a10, R.drawable.a11, R.drawable.a12, R.drawable.a13, R.drawable.a14, R.drawable.a15,
        R.drawable.a16, R.drawable.a17, R.drawable.a18, R.drawable.a19, R.drawable.a20};
private static final int count = 22;

//private AdController myController;
View view=null;
Integer imageId;
final Activity act = this;  
private int indexOfImage = 0;
public LinearLayout layout;

public void onCreate(Bundle savedInstanceState)
{       
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

     MyPagerAdapter adapter = new MyPagerAdapter();
       final ViewPager myPager = (ViewPager) findViewById(R.id.myfivepanelpager);
         myPager.setAdapter(adapter);
         myPager.setCurrentItem(12); 
         myPager.setOnPageChangeListener(this);

         Button next = (Button) findViewById(R.id.buttonnext);
         next.setOnClickListener(new View.OnClickListener(){

             public void onClick(View v) {
                 myPager.setCurrentItem(myPager.getCurrentItem()+1);
             }
         }); 

         Button previous = (Button) findViewById(R.id.buttonprevious);
         previous.setOnClickListener(new View.OnClickListener(){

             public void onClick(View v) {
                 myPager.setCurrentItem(myPager.getCurrentItem()-1);
             }
         }); 

         Button duvarbtn = (Button) findViewById(R.id.button1);
         duvarbtn.setOnClickListener(new View.OnClickListener(){
            int id=ListOfID[indexOfImage];
             public void onClick(View v) {

                WallpaperManager myWallpaperManager
                 = WallpaperManager.getInstance(getApplicationContext());
                try {                                                                      
                    myWallpaperManager.setResource(id);                       
                } catch (IOException e) {
                 // TODO Auto-generated catch block
                 e.printStackTrace();
                }
             }          
         }); 
}

public void onPageScrollStateChanged(int arg0) {
    // TODO Auto-generated method stub

}

public void onPageScrolled(int position, float arg1, int arg2) {
    // TODO Auto-generated method stub

        }

public void onPageSelected(int position) {
    // TODO Auto-generated method stub

    indexOfImage = position;
    switch (position) {
    case 0://
   firstpage(position);
   indexOfImage = position;
        break;
    case 1:     
        indexOfImage = position;
        break;
    case 2:
        indexOfImage = position;
        break;
    case 3:
        indexOfImage = position;
        break;
    case 4:
        indexOfImage = position;
        break;
    case 5:
        indexOfImage = position;
        break;
    case 6:
        indexOfImage = position;
        break;
    case 7:
        indexOfImage = position;
        break;
    case 8:
        indexOfImage = position;
        break;
    case 9:
        indexOfImage = position;
        break;
    case 10:
        indexOfImage = position;
        break;
    case 11:
        indexOfImage = position;
        break;
    case 12:
        indexOfImage = position;
        break;
    case 13:
        indexOfImage = position;
        break;
    case 14:
        indexOfImage = position;
        break;
    case 15:
        indexOfImage = position;
        break;
    case 16:
        indexOfImage = position;
        break;
    case 17:
        indexOfImage = position;
        break;
    case 18:
        indexOfImage = position;
        break;
    case 19:
        indexOfImage = position;
        break;
    case 20:
        indexOfImage = position;
        break;
    case 21:
        firstpage(position);
        indexOfImage = position;
        break;
    }

}

public void firstpage(int position) {
    // TODO Auto-generated method stub
    ViewPager myPager = (ViewPager) findViewById(R.id.myfivepanelpager);
     int pageCount = getCount();
     if (position == 0){
         //
         myPager.setCurrentItem(pageCount-2,false);
     } else if (position == pageCount-1){
        //ViewPager myPager = (ViewPager) findViewById(R.id.myfivepanelpager);
         myPager.setCurrentItem(1,false);
     }
}

private int getCount() {
    // TODO Auto-generated method stub
     return count;
}
public void onClick(View v) {
    // TODO Auto-generated method stub
    //Filter f = (Filter) v.getTag();
   // MyPagerAdapter.show(this, input, f);
}
 public void onDestroy()
    {
     super.onDestroy();
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:14:24.130

```
pager.setOnPageChangeListener(new MyPageChangeListener()); 
private int indexOfImage = 0;
private class MyPageChangeListener extends ViewPager.SimpleOnPageChangeListener {
    @Override
    public void onPageSelected(int position) {
        indexOfImage = position;
    }
} 
```

**将其设置为墙纸**

```
int id=ListOfID[indexOfImage];
WallpaperManager myWallpaperManager
     = WallpaperManager.getInstance(getApplicationContext());
myWallpaperManager.setResource(id); 
```

# cakephp - Cakephp：使用`saveAssociated()`时如何将`parent_id`保存到基于树的模型中？

> ID：13072660
> 
> 赞同：1
> 
> 时间：2012-10-25T16:04:40.043
> 
> 标签：cakephp, model, tree, save

我的数据库结构：

```
CREATE TABLE IF NOT EXISTS `pos` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `alias` varchar(255) NOT NULL,
  `model` varchar(255) NOT NULL,
  `foreign_key` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `alias` (`alias`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `psos` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `parent_id` int(11) NOT NULL DEFAULT '0',
  `po_id` int(11) NOT NULL,
  `lft` int(11) NOT NULL DEFAULT '0',
  `rght` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; 
```

我的模型结构：

```
class Po extends Model {
    public $name = 'Po';
    public $useTable = 'pos';
    public $cacheQueries = false;
    public $hasMany = array(
        'Pso' => array(
            'className' => 'Pso',
            'foreignKey' => 'po_id',
            'dependent' => true,
        ),
        'Puso' => array(
            'className' => 'Puso',
            'foreignKey' => 'po_id',
            'dependent' => true,
        ),
    );
}

class Pso extends Model {
    public $name = 'Pso';
    public $useTable = 'psos';
    public $cacheQueries = false;
    public $actsAs = array(
        'Tree',
    );

    public $belongsTo = array(
        'Parent' => array(
            'className' => 'Pso',
            'foreignKey' => 'parent_id',
        ),
        'Po' => array(
            'className' => 'Po',
            'foreignKey' => 'po_id',
        ),
    );

    public $hasMany = array(
        'Children' => array(
            'className' => 'Pso',
            'foreignKey' => 'parent_id',
        ),
    );

} 
```

我的保存相关测试代码：

```
$Po->saveAssociated(array(
    'Po' => array(
        'alias' => 'teste'.uniqid(),
    ),
    'Pso' => array(
        'parent_id' => 2,
    ),
)); 
```

生成的 PSO 保存行：

```
array('id'=>4,'parent_id'=>0,'po_id'=>4,'lft'=>7,'rght'=>8) 
```

预期 PSO 已保存行：

```
array('id'=>4,'parent_id'=>2,'po_id'=>4,'lft'=>7,'rght'=>8) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:42:27.737

像这样解决：

```
$Po->saveAssociated(array(
    'Po' => array(
        'alias' => 'teste'.uniqid(),
    ),
    'Pso' => array(
        'parent_id' => array(
            'parent_id' => 2,
        ),
    ),
)); 
```

# mongodb-java - 从 Spring Java 执行 MongoDB 存储的 JavaScript/过程

> ID：13072662
> 
> 赞同：5
> 
> 时间：2012-10-25T16:04:42.797
> 
> 标签：mongodb-java, spring-data-mongodb

我在 mongodb 中存储的 Javascript 很少。我正在使用 spring springframework.data.mongodb 来访问 mongodb。我如何从中执行存储的 JavaScript/程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T17:27:18.013

找到了解决方案。

```
BasicDBObject obj = new BasicDBObject();
obj.append( "$eval" , "stored_javascript_name()" );

CommandResult t=mongoTemplate.executeCommand(obj);
Object obj1=t.get("retval"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-28T08:31:44.673

```
BasicDBObject obj = new BasicDBObject();
String menu="湖南卫视";
String program="天路啦：东方不亮西方亮";
obj.append( "$eval" , "keyword_store('"+menu+"','"+program+"')" ); 
```

您应该知道的另一件事是在传输字符串参数时添加单引号。

# hibernate - Hibernate 中的非法参数异常

> ID：13072668
> 
> 赞同：0
> 
> 时间：2012-10-25T16:05:05.480
> 
> 标签：hibernate

我想执行 Hibernate 查询以获取组内“协调员”的数量。“协调员”具有类似管理员的组角色。

在更高的层次上，我有两个表：domaingroup 和 group_coordinators。后一个表有 2 列：coordinators_id 和 domaingroup_id。我想检查特定用户（显示在 coordinators_id 中）和组（显示在 domaingroup_id 中）的行数。

我得到错误，

> java.lang.IllegalArgumentException: org.hibernate.hql.ast.QuerySyntaxException: DomainGroup.Group_Coordinators 未映射

对于查询，

```
SELECT Coordinators_Id=:followerId FROM DomainGroup.Group_Coordinators 
WHERE Coordinators_Id=:followerId and DomainGroup_id=:followingId 
```

对于代码，

```
 class DomainGroup ... {

                /**
                 * List of coordinators for this group.
                 */
                @Size(min = 1, message = MIN_COORDINATORS_MESSAGE)
                @ManyToMany(fetch = FetchType.EAGER, cascade = 
        { CascadeType.PERSIST })
                @JoinTable(name = "Group_Coordinators")
                private Set<Person> coordinators; 
```

请告诉我如何正确执行此查询。

谢谢，凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:28:56.813

你有两个大错误： 你必须在 HQL 查询中使用 Java 类和成员名，而不是表名。然后你不能从java集合中选择；相反，您必须指定类。

在您的示例中，它将是某事。喜欢

```
FROM Person WHERE Id=:followerId and DomainGroupId=:followingId 
```

或者

```
SELECT count(Id) FROM Person WHERE DomainGroupId=:followingId 
```

（对于我猜在您没有提供的 Person 类中的示例，有映射的成员变量 Id 和 DomainGroupId）

# java - 使用 JAVA SDK 的普遍的、打开的 DAT 文件 - 适用于 Windows 的 JCL SDK

> ID：13072675
> 
> 赞同：0
> 
> 时间：2012-10-25T16:05:26.680
> 
> 标签：java, database, pervasive

JAVA 有什么方法可以**直接使用 SDK 打开 Pervasive DAT 文件**- 请参阅附件 - [https://docs.google.com/open?id=0B1lhSNdHpbprc1FrSGlMOWNVWnM](https://docs.google.com/open?id=0B1lhSNdHpbprc1FrSGlMOWNVWnM) - 使用该 SDK？

[来自http://www.pervasivedb.com/support/Pages/PSQLSDK-Archives.aspx](http://www.pervasivedb.com/support/Pages/PSQLSDK-Archives.aspx)的适用于 Windows 的 JCL SDK

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T00:15:48.467

是的，您可以使用 JCL 界面访问 DAT 文件，但您需要做一些事情。JCL 驱动程序本身无法访问该文件。驱动程序需要一个引擎来打开文件。您还需要知道文件的**确切**记录布局。
一旦你有了这些东西，你就可以使用 JCL 驱动程序来访问 Btrieve 文件。看看[http://docs.pervasive.com/products/database/psqlv11/wwhelp/wwhimpl/js/html/wwhelp.htm#href=jcl/java_api.2.4.html#23324](http://docs.pervasive.com/products/database/psqlv11/wwhelp/wwhimpl/js/html/wwhelp.htm#href=jcl/java_api.2.4.html#23324)。它描述了如何访问没有 DDF 的“松散耦合”数据库。我在某处有一个样品。如果我能找到它，我会寻找它并发布它。

# c# - 如何在 C# 中创建动态 ISBN 13 条形码图像

> ID：13072676
> 
> 赞同：0
> 
> 时间：2012-10-25T16:05:27.617
> 
> 标签：c#, winforms, asp.net-mvc-3, barcode, isbn

我需要能够传入一个 13 位的 ISBN 并将条形码作为图像动态显示在网站上。我在 maschup.com 上尝试了一些 Web 服务，但目前无法正确呈现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:05:27.617

您可以使用以下类生成 ISBN-13 条码：

```
public class Bookland : IDisposable {

  public Image BarCode { get; private set; }
  public byte[] BinaryImage {
    get {
      return ms.ToArray();
    } 
  }
  private StringBuilder BinaryText { get; set; }
  private int LineBuffer { get; set; }

private MemoryStream ms = new MemoryStream();

public Bookland(string ISBN) {
  // TODO: Regular Expression Replace all but 0-9
  // TODO: Check Length and Convert 10 to 13 if necessary
  this.BinaryText = new StringBuilder();
  this.LineBuffer = 21;

  char[] isbn = ISBN.ToArray();

  this.BinaryText.Append("101");
  this.CalculateFirstSet(isbn);
  this.BinaryText.Append("01010");
  this.CalculateSecondSet(isbn);
  this.BinaryText.Append("101");

  using (Bitmap bmp = new Bitmap(135, 105, PixelFormat.Format32bppRgb)) {
    using (Pen pen = new Pen(Color.White)) {
      using (Graphics g = Graphics.FromImage(bmp)) {
        g.Clear(Color.White);

        Rectangle r = new Rectangle(10, 72, 10, 15);
        g.SmoothingMode = SmoothingMode.AntiAlias;
        g.InterpolationMode = InterpolationMode.HighQualityBicubic;
        g.PixelOffsetMode = PixelOffsetMode.HighQuality;
        g.DrawString("9", new Font("Courier", 8), Brushes.Black, r);

        r = new Rectangle(26, 72, 42, 15);
        g.DrawString(ISBN.Substring(1, 6), new Font("Courier", 8), Brushes.Black, r);

        r = new Rectangle(72, 72, 42, 15);
        g.DrawString(ISBN.Substring(7, 6), new Font("Courier", 8), Brushes.Black, r);

        g.Flush();

        char[] binary = this.BinaryText.ToString().ToCharArray();

        int[] delim = new int[] { 0, 1, 2, 45, 46, 47, 48, 49, 92, 93, 94 };

        for (int i = 0; i < binary.Length; i++) {
          pen.Color = binary[i] == '1' ? Color.Black : Color.White;

          if (delim.Contains(i)) {
            g.DrawLine(pen, this.LineBuffer, 20, this.LineBuffer, 85);
          }
          else {
            g.DrawLine(pen, this.LineBuffer, 20, this.LineBuffer, 70);
          }

          this.LineBuffer++;
        }

      }
    }

    bmp.Save(ms, ImageFormat.Png);
    this.BarCode = Image.FromStream(ms);
  }
}

private void CalculateFirstSet(char[] set) {
  for (int i = 1; i <= 6; i++) {
    switch (set[i]) {
      case '0':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0001101");
        }
        else {
          this.BinaryText.Append("0100111");
        }
        break;
      case '1':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0011001");
        }
        else {
          this.BinaryText.Append("0110011");
        }
        break;
      case '2':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0010011");
        }
        else {
          this.BinaryText.Append("0011011");
        }
        break;
      case '3':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0111101");
        }
        else {
          this.BinaryText.Append("0100001");
        }
        break;
      case '4':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0100011");
        }
        else {
          this.BinaryText.Append("0011101");
        }
        break;
      case '5':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0110001");
        }
        else {
          this.BinaryText.Append("0111001");
        }
        break;
      case '6':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0101111");
        }
        else {
          this.BinaryText.Append("0000101");
        }
        break;
      case '7':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0111011");
        }
        else {
          this.BinaryText.Append("0010001");
        }
        break;
      case '8':
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0110111");
        }
        else {
          this.BinaryText.Append("0001001");
        }
        break;
      default:
        if (i == 1 || i == 4 || i == 6) {
          this.BinaryText.Append("0001011");
        }
        else {
          this.BinaryText.Append("0010111");
        }
        break;
    }
  }
}
private void CalculateSecondSet(char[] set) {
  for (int i = 7; i < set.Length; i++) {
    switch (set[i]) {
      case '0':
        this.BinaryText.Append("1110010");
        break;
      case '1':
        this.BinaryText.Append("1100110");
        break;
      case '2':
        this.BinaryText.Append("1101100");
        break;
      case '3':
        this.BinaryText.Append("1000010");
        break;
      case '4':
        this.BinaryText.Append("1011100");
        break;
      case '5':
        this.BinaryText.Append("1001110");
        break;
      case '6':
        this.BinaryText.Append("1010000");
        break;
      case '7':
        this.BinaryText.Append("1000100");
        break;
      case '8':
        this.BinaryText.Append("1001000");
        break;
      default:
        this.BinaryText.Append("1110100");
        break;
    }
  }
}

public void Dispose() {
  this.BarCode.Dispose();
  this.ms.Dispose();
  this.BinaryText = null;
} 
```

以下是其使用的两个示例：

## 对于 Windows 窗体

```
using (Bookland isbn = new Bookland(9780495806431) {
  PictureBox.Image = isbn.BarCode();
} 
```

## 对于 MVC 3

```
public ActionResult barcode(string id) {
 byte[] isbn = null;

  using (Bookland bookland = new Bookland(id)) {
    isbn = bookland.BinaryImage;
    return File(bookland.BinaryImage, "image/png");
  }
} 
```

# spring-mvc - Spring 3 MVC - 无法读取候选组件类

> ID：13072677
> 
> 赞同：3
> 
> 时间：2012-10-25T16:05:28.147
> 
> 标签：spring-mvc, weblogic

我在 weblogic 服务器上部署我的应用程序时遇到问题。

我尝试在“struts 2”项目中添加 spring 3 MVC，但是当我指定组件扫描时，我得到了那个错误：

```
<Warning> <HTTP> <wks000fq> <AdminServer> <[ACTIVE] ExecuteThread: '42' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1351179993124> <BEA-101162> <User defined listener org.springframework.web.context.ContextLoaderListener failed: 
org.springframework.beans.factory.BeanDefinitionStoreException: Failed to read candidate component class: URL [zip:D:/Projets/XXX/ZZZ/servers/AdminServer/tmp/_WL_user/YYY/x8a4s2/war/WEB-INF/lib/YYY-pres.jar!/fcdq/epepar/WWW/controleur/cdcais/AbstractActionWebET.class]; nested exception is java.lang.AbstractMethodError: org.springframework.core.type.classreading.AnnotationMetadataReadingVisitor.visit(IILjava/lang/String;Ljava/lang/String;[Ljava/lang/String;Ljava/lang/String;)V
    at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:237) 
```

我不知道该怎么办。我检查了班级，我用一个空班级更改了它，问题不是来自班级。

# java - BigDecimal 中的 setscal

> ID：13072679
> 
> 赞同：0
> 
> 时间：2012-10-25T16:05:31.220
> 
> 标签：java, bigdecimal

我有这个程序：

```
BigDecimal a = new BigDecimal("0.21556788990002");
        System.out.println(a.setScale(2)); 
```

我有结果`0.21`但是当我想提取只是`0.2`我尝试

> for(int i=1; i<10; i++) System.out.println(a.setScale(i));

当 i = 1 时出现此错误：

> 在 java.math.BigDecimal.divideAndRound(BigDecimal.java:1439) 在 java.math.BigDecimal.setScale(BigDecimal.java:2390) 在 java.math.BigDecimal.setScale(BigDecimal.java:2437) 在 NewClass.main(新类.java:30)

我可以做什么来提取 i = 1 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T16:09:53.990

您需要使用舍入模式进行缩放，对于您的情况，它将如下：

```
System.out.println(a.setScale(1, RoundingMode.FLOOR)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:16:41.133

顺便说一句，这类似于

```
double a = 0.21556788990002;

for (int i = 1; i < 10; i++)
    System.out.printf("%." + i + "f%n", a); 
```

印刷

```
0.2
0.22
0.216
0.2156
0.21557
0.215568
0.2155679
0.21556789
0.215567890 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:11:33.693

您必须使用将舍入作为第二个参数的`overloaded` **setScale 方法。**参考[这里](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html#setScale%28int,int%29)

```
 BigDecimal a = new BigDecimal("0.21556788990002");
    System.out.println(a.setScale(1,1)); //result 0.2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T16:17:00.127

我认为您也可以使用十进制格式：

```
 BigDecimal a = new BigDecimal("0.21556788990002");

        //change any desired format using 0 or #
        DecimalFormat dFormat = new DecimalFormat("0.0");
        System.out.println(dFormat.format(a)); //< - print 0.2

        DecimalFormat dFormat = new DecimalFormat("#.0");
        System.out.println(dFormat.format(a)); //< - print .2

        DecimalFormat dFormat = new DecimalFormat("0.00");
        System.out.println(dFormat.format(a)); //< - print 0.21 
```

# knockout.js - 如何在按下回车键时将数据从文本框中推送到可观察对象而不进行模糊处理？

> ID：13072683
> 
> 赞同：0
> 
> 时间：2012-10-25T16:05:55.730
> 
> 标签：knockout.js

这是设置：

我有一个绑定到可观察对象的文本框。

可观察对象在文本框的更改事件上从文本框中获取值，而该更改事件又发生在模糊（或我们不考虑的少数其他事件，例如“valueUpdate：afterkeydown”）。

我需要的是让它在点击 Enter 时也发生，也就是说，通过点击 Enter，文本框的当前值被获取并推送到 observable。

所以我写了一个绑定，它监听文本框的 keydown 事件，如果扫描码是 13，它确实.. 什么？这是我不确定的地方。让我解释：

此时我需要更改事件以某种方式发生，但我无法直接控制它，因为我无法明确触发元素上的更改事件。所以我所做的是模糊并重新关注文本框，导致更改事件自然发生。这种模糊/聚焦的东西有效，但会引入难以抑制的不良副作用。

所以我最终要寻找的是**一种开始将当前值从文本框传播到**我的“输入”绑定内部的可观察对象的方法。**这是为了有效地模拟失去焦点但不失去焦点（做模糊）**时发生的变化事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:11:01.590

尝试这个。

```
ko.bindingHandlers.returnKey = {
   init: function(element, valueAccessor, allBindingsAccessor, viewModel) {
      ko.utils.registerEventHandler(element, 'keydown', function(evt) {
        if (evt.keyCode === 13) {
           //evt.preventDefault();
           //evt.target.blur();
           valueAccessor(element.value);
        }
      });
    }
}; 
```

那么你的html应该

```
<input type="text" data-bind="value:message, returnKey:message" /> 
```

检查**[演示](http://jsfiddle.net/cDT5A/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T21:31:51.470

似乎您应该直接更新值绑定而不是可观察值。

```
ko.bindingHandlers.value.update(element, valueAccessor, allBindingsAccessor); 
```

那应该做你想要的。

# jquery - 使用 Spritely 动画精灵

> ID：13072688
> 
> 赞同：2
> 
> 时间：2012-10-25T16:06:13.070
> 
> 标签：jquery, html, sprite, spritely

我正在使用[Spritely](http://www.spritely.net)为精灵设置动画。我已经成功平移，但我的最后一项工作是创建淡入淡出的“明星”。我创建了一个精灵表：

![精灵](../Images/fcde80b92d077b45dfcfd7375fba030f.png)

我按照[此处](http://www.spritely.net/documentation/)找到的文档更改了帧数和每秒帧数。

```
$('#star').sprite({fps: 24, no_of_frames: 12}); 
```

我的问题是精灵的动画既生涩又似乎没有跟随精灵图像，它应该淡入然后淡出。目前它在半可见和完全可见之间摇摆不定。

我使用 Chrome 的控制台来记录帧，我似乎只得到帧 0,1 和 2。我原本预计会有 12 帧（精灵中的每个图像一个），但我是新手，所以我可能会弄错。根据日志，它似乎也没有到达最后一帧。

![在此处输入图像描述](../Images/1c352ad6f993ea6d5f184a8a53c20e84.png)

这是我的完整代码：

```
(function($) {
        $(document).ready(function() {           
           $('.purplestar').sprite({
                fps: 24, 
                no_of_frames: 12,
                start_at_frame: 0,
                        on_first_frame: function(obj) {
                            if (window.console) {
                                console.log('first frame');
                            }
                        },
                        on_last_frame: function(obj) {
                            if (window.console) {
                                console.log('last frame');
                            }
                        },
                        on_frame: {
                            2: function(obj) {
                                if (window.console) {
                                    console.log('frame 2');
                                }
                            },
                            1: function(obj) {
                                if (window.console) {
                                    console.log('frame 1');
                                }
                            },
                            0: function(obj) {
                                if (window.console) {
                                    console.log('frame 0');
                                }
                            },
                            3: function(obj) {
                                if (window.console) {
                                    console.log('frame 3');
                                }
                            }
                        }
            });

           $('#balloonleft').pan({fps: 30, speed: 4, dir: 'up', depth: 70});
           $('#balloonright').pan({fps: 30, speed: 3, dir: 'up', depth: 70});
           $('#bird')
                    .sprite({
                        fps: 9, 
                        no_of_frames: 3,
                        // the following are optional: new in version 0.6...
                        start_at_frame: 2
                    })
                    .spRandom({top: 50, bottom: 200, left: 300, right: 320})
                    .activeOnClick()
                    .active();

    });
    })(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:32:39.907

我知道这不能回答你的问题，但我不会使用精灵来为这个特定的精灵设置动画；除了不透明度之外，您的精灵图像不会改变，因此您只需使用诸如[fadeToggle](http://api.jquery.com/fadeToggle/)之类的东西（它是标准 jQuery 库的一部分）来改变对象的不透明度，就可以获得更平滑的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T10:44:19.883

首先感谢 Rohaq 的回答，它确实提供了一种替代方法，但它没有直接回答我的问题，我设法弄清楚了。

Spritely 有效地更改了`background-position`a 上的属性`div`。我发现我的问题是由于精灵的宽度除以帧数时没有产生整数。当我更改精灵的宽度时，宽度为 1200 像素，在 12 帧时，这意味着每帧为 100 像素。在我有 57.5px 之前，这是行不通的。

生涩的性质是我自己做的，因为其中一帧的精灵比其他帧向左 1px。

# spring - java.lang.NoClassDefFoundError：来自 Spring 3.1.2/Hibernate 4.1.7 和 Shards 3.0.0.Beta2 的 org/hibernate/engine/SessionFactoryImplementor

> ID：13072690
> 
> 赞同：2
> 
> 时间：2012-10-25T16:06:18.990
> 
> 标签：spring, hibernate, exception, maven, sharding

我正在使用 Hibernate Core 4.1.7 和 Spring 3.1.2 尝试一个简单的 Hibernate 分片示例（是的，奇怪，4 年前发布的 3.0.0.Beta2），并在会话工厂初始化期间遇到了这个问题：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'mySessionFactory' defined in class path resource [shardedspring-config.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Factory method [public org.hibernate.SessionFactory it.sella.lab.crm.sys.persistence.ShardedSessionFactoryBuilder.createSessionFactory()] threw exception; nested exception is java.lang.NoClassDefFoundError: org/hibernate/engine/SessionFactoryImplementor
    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:581)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1015)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:911)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:469)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:139)
    at org.springframework.context.support.ClassPathXmlApplicationContext.<init>(ClassPathXmlApplicationContext.java:83)
    at in.rixx.crm.model.Activity.<clinit>(Activity.java:17) 
```

这就是我选择 Spring 和 Hibernate 的方式：

```
<dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.7.Final</version>
 </dependency>
 <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>3.1.2.RELEASE</version>
 </dependency> 
```

这似乎不是分片库的问题 - 它看起来像是由重构的 SessionFactoryImplementor 类引起的一般问题。参考[https://jira.springsource.org/browse/SPR-8885](https://jira.springsource.org/browse/SPR-8885)，我还切换到 org.springframework.orm.hibernate4.HibernateTransactionManager 用于 bean 'transactionmanager' - 它没有帮助。

Spring 3.x 和 Hibernate 4.x 现在有什么功能解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-12-22T12:46:31.750

> 我也遇到了同样的问题，我搜索了一些其他站点，它帮助我解决了这个问题。我做错的是休眠版本我在 maven 中使用 4 作为事务管理器，但在 maven 中我正在配置版本 3 的休眠事务管理器，那是不兼容。我像这样更改了spring配置文件。

```
<bean id="hibernateTransactionManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>
    <!-- <bean id="hibernateTransactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean> --> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T12:59:56.680

我看到您正在使用带有弹簧的 HIbernate 4。所以似乎是 spring & hibernate 的相互兼容性问题。因此，请访问以下站点以了解 Hibernate 4 与 Spring 的兼容性。

[http://blog.springsource.org/2012/04/06/migrating-to-spring-3-1-and-hibernate-4-1/](http://blog.springsource.org/2012/04/06/migrating-to-spring-3-1-and-hibernate-4-1/)

否则作为另一种选择尝试以下版本。

```
<dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>3.3.1.GA</version>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-23T06:34:57.280

Hibernate 核心不需要任何注释的依赖，一些确保你的 pom 没有任何 hibernate-annotation 或 hibernate-common-annotation 的依赖。

**我的工作pom如下。**

```
<properties>
    <spring.version>4.0.5.RELEASE</spring.version>
    <junit.version>4.11</junit.version>
    <jdk.version>1.6</jdk.version>
</properties>

<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>

    <!-- Spring dependencies -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>${spring.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${spring.version}</version>
    </dependency>

    <!-- Servlet -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>3.0-alpha-1</version>
    </dependency>

    <!-- JSTL -->
    <dependency>
        <groupId>jstl</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>

    <!-- Apache Commons Upload -->
    <dependency>
        <groupId>commons-fileupload</groupId>
        <artifactId>commons-fileupload</artifactId>
        <version>1.2.2</version>
    </dependency>

    <!-- Apache Commons Upload -->
    <dependency>
        <groupId>commons-io</groupId>
        <artifactId>commons-io</artifactId>
        <version>1.3.2</version>
    </dependency>

    <!-- MYSQL dependency -->
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.6</version>
    </dependency>

    <!-- Hibernate -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.3.5.Final</version>
    </dependency>

    <!-- If using JPA (2), add: -->

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.5.6</version>
    </dependency>

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.5.6</version>
    </dependency>

    <dependency>
        <groupId>c3p0</groupId>
        <artifactId>c3p0</artifactId>
        <version>0.9.1.2</version>
    </dependency>

    <dependency>
        <groupId>org.javassist</groupId>
        <artifactId>javassist</artifactId>
        <version>3.18.1-GA</version>
    </dependency>

</dependencies> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T17:04:20.730

通过删除 hibernate-common-annotations 我得到了不同的错误 java.lang.ClassNotFoundException: org.hibernate.engine.SessionFactoryImplementor

这是会话工厂和事务管理器之间的版本差异

这是解决方案的链接 [ [http://devjav.com/spring-java-lang-classnotfoundexception-org-hibernate-engine-sessionfactoryimplementor/][1]](http://devjav.com/spring-java-lang-classnotfoundexception-org-hibernate-engine-sessionfactoryimplementor/][1])

来自上述链接的解决方案：对事务管理器和本地会话工厂 bean 使用正确版本的 Hibernate

```
org.springframework.orm.hibernate3.HibernateTransactionManager
org.springframework.orm.hibernate3.LocalSessionFactoryBean 
```

```
 <beans:bean id="sessionFactory" name="sessionFactory"
        class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
        <beans:property name="configLocation">
           <beans:value>classpath:hibernate.cfg.xml</beans:value>
        </beans:property>
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
            </beans:props>
        </beans:property>
    </beans:bean>
<beans:bean id="transactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <beans:property name="sessionFactory" ref="sessionFactory" />
    </beans:bean> 
```

# php - PHP/Wordpress - 在 Echo 中包含一个 IF 函数

> ID：13072691
> 
> 赞同：0
> 
> 时间：2012-10-25T16:06:19.957
> 
> 标签：php, wordpress, if-statement, echo

我有以下 WordPress 查询：

```
$my_query = new WP_Query($args);
if ($my_query->have_posts()) {
    echo '<div class="' . $tax_term->slug . '" style="display:none; background:url(' . $whatdoiputhere . ');">';
    while ($my_query->have_posts()) : $my_query->the_post(); 
```

在后台 URL 中，我需要包含由以下代码生成的图像 URL：

```
<?php if (function_exists('z_taxonomy_image_url')) echo z_taxonomy_image_url(); ?> 
```

我如何在后台 URL 中包含这个 IF 函数？

我试过这个，但你可以猜到它没有用：

```
background:url(' . if (function_exists('z_taxonomy_image_url')) echo z_taxonomy_image_url(); . '); 
```

对于我将如何做到这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:08:12.197

三元运算符：

```
background:url(' . (function_exists('z_taxonomy_image_url') ? z_taxonomy_image_url() : '') . '); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:10:52.650

我会做这样的事情：

```
<?php 
    if (function_exists('z_taxonomy_image_url')) {
        echo "background:url('" . z_taxonomy_image_url() . "');";
    }
?> 
```

如果需要，可以通过 else 子句设置默认背景图像，否则 CSS 中将不存在背景定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:11:37.067

```
<?php
    if (function_exists('z_taxonomy_image_url')) $background_url = 'background:url(' . z_taxonomy_image_url() . ')';
    echo '<div class="' . $tax_term->slug . '" style="display:none; ' . $background_url . '">';
?> 
```

# linux - Git 服务器 - 自动（重新）推送

> ID：13072699
> 
> 赞同：0
> 
> 时间：2012-10-25T16:06:36.457
> 
> 标签：linux, git, push, bitbucket

我们有自己的 linux 服务器，带有 git 服务器。但由于某些原因，我们创建了 bitbucket 帐户（私人仓库），现在我们想将其用作“备份”。

现在我想设置当有人在自己的服务器上推送代码时-> 服务器在 bitbucket 上进行其他推送。

有可能的？有人为此编写脚本或一些想法.....？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:08:25.853

我相信你可以通过[git post-receive hook](http://git-scm.com/book/en/Customizing-Git-Git-Hooks#Server-Side-Hooks)做到这一点。

# scala - 在 Scala 中连接 TraversableOnce 对象？

> ID：13072700
> 
> 赞同：4
> 
> 时间：2012-10-25T16:06:41.720
> 
> 标签：scala, iterator, concatenation

我想将一个可遍历的一次连接到一个可遍历的一次而不解析。这是我提出的隐含解决方案，但我不知道我是否缺少本机解决方案......

```
object ImplicitTraversableOnce {
  implicit def extendTraversableOnce[T](t : TraversableOnce[T]) = new TraversableOnceExtension(t)
}

class TraversableOnceExtension[T <: Any](t : TraversableOnce[T]) {

  def ++ (t2:TraversableOnce[T]):TraversableOnce[T] = new concat(t.toIterator, t2.toIterator)

  private class concat(i1:Iterator[T], i2:Iterator[T]) extends Iterator[T] {
    private var isOnSecond = false

    def hasNext:Boolean =
      if (isOnSecond) i2.hasNext
      else if (!i1.hasNext) {
        isOnSecond = true
        hasNext
      }
    else true

    def next():T = if (isOnSecond) i2.next() else i1.next()
  }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T16:18:27.173

您可以使用 ++ 加入迭代器。因此，如果您仍然要使用迭代器，只需

```
def ++(t2: TraversableOnce[T]): TraversableOnce[T] = t.toIterator ++ t2.toIterator 
```

不这样做的原因是为不是/`foreach`的s提供有效的，但是您需要填写所有抽象方法。`Traversable``Iterable``Iterator``TraversableOnce`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T00:55:01.720

怎么样：

```
 def ++(t2: TraversableOnce[T]) = new Traversable[T] {
    def foreach[U](f: (T) => U) {
      t.foreach(f)
      t2.foreach(f)
    }
  } 
```

# vim - 为什么这个 .vimrc 映射在终端中不起作用（但在 MacVim 中起作用）：map ○

> ID：13072701
> 
> 赞同：8
> 
> 时间：2012-10-25T16:06:56.477
> 
> 标签：vim

我的 .vimrc 文件中有两行：

```
map <S-Enter> O<Esc>
map <CR> o<Esc> 
```

第二行按预期工作，但第一行没有。

这个想法是，如果我按 Enter 键，那么 vim 应该在光标位置下方插入一个新行并将光标向下移动到该行。如果我按 Shift-Enter，vim 应该在光标位置上方插入一个新行并将光标向上移动到该行。这种映射应该起作用，因为普通模式下的大写`O`键将在光标所在行上方插入换行符，将光标放在该行的开头，然后将用户置于插入模式。大写`O`后面`<Esc>`应该简单地将 vim 恢复为命令模式。

我已经`O`按照我的预期进行了检查和资本运作。那么为什么我的映射不起作用？我尝试过使用`map <Shift-CR>`and `map <Shift-Enter>`，但这些都不起作用。

**编辑**原来它在 MacVim 中有效，但在 iTerm 中无效。如果有人能解释原因并提出解决方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T16:27:07.053

你在使用控制台 Vim 吗？某些组合键只能在 GVIM 中映射。在所有/大多数 Linux 终端中，`Enter`不能与`Shift`或结合使用`Ctrl`。您的映射本身是正确的，但您必须在映射中使用不同的*LHS*。

由于键盘输入在内部处理的方式，即使在 GVIM 中也无法使用某些组合键。某些组合键，如`Ctrl`+ 非字母无法映射，`Ctrl`+ 字母与`Ctrl`+ `Shift`+ 字母无法区分。这是一个已知的痛点，也是 vim_dev 和 #vim IRC 频道上各种讨论的主题。

一些人（最重要的是 Paul LeoNerd Evans）想要解决这个问题（即使是支持这个的终端中的控制台 Vim），并提出了各种建议，cp。[http://groups.google.com/group/vim_dev/browse_thread/thread/626e83fa4588b32a/bfbcb22f37a8a1f8](http://groups.google.com/group/vim_dev/browse_thread/thread/626e83fa4588b32a/bfbcb22f37a8a1f8)

但是截至今天，还没有补丁或志愿者出现，尽管许多人表示希望在未来的 Vim 8 主要版本中拥有它。

# c++ - Boost property_tree：每个键有多个值

> ID：13072704
> 
> 赞同：3
> 
> 时间：2012-10-25T16:07:04.620
> 
> 标签：c++, boost, configuration-files, boost-propertytree

Boost 属性树似乎是一个用于解析配置文件的优秀库。但是，我不知道如何处理每个键有多个值的情况。例如，假设我正在指定一个这样的框：

```
box
{
    x -1 1
    y -1 1
    z -1 1
} 
```

其中`x`、`y`和`z`分别是框在 、 和 轴上的`x`边界`y`，`z`使用 property_tree 的 INFO 格式指定。我在手册中看到使用引号对使用空格的值进行了提及，但是我看不到我可以将这些值作为数字导入。我必须将字符串解析为数字，这似乎首先违背了使用 property_tree 的目的。我当然可以给每个数字一个键：

```
box 
{
    xlo -1
    xhi 1
    ylo -1
    yhi 1
    zlo -1
    zhi 1
} 
```

但这似乎很麻烦，并且会膨胀我的配置文件。我还注意到我可以在 program_options 中处理这种情况，但是我失去了嵌套配置文件的功能（是的，我知道我可以使用点符号来“嵌套”，但它不一样）。

有没有办法将例如 x 作为这样的数字列表导入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T23:44:00.480

标准的 property_tree 每个键只处理一个字符串值，因为它被定义为：

```
typedef basic_ptree<std::string, std::string> ptree; 
```

因此，唯一的选择是使用字符串并解析它们。我认为最好的方法是定义一个新的类来存储低值和高值，然后为 get 和 set 方法创建一个转换器类。例如：

```
struct low_high_value
{
  low_high_value() : m_low(0), m_high(0) { }
  low_high_value(double low, double high) : m_low(low), m_high(high) { }
  double m_low;
  double m_high;
}; 
```

翻译者将是：

```
struct low_high_value_translator
{
  typedef std::string    internal_type;
  typedef low_high_value external_type;
  // Get a low_high_value from a string
  boost::optional<external_type> get_value(const internal_type& str)
  {
    if (!str.empty())
    {
      low_high_value val;
      std::stringstream s(str);
      s >> val.m_high >> val.m_low;
      return boost::optional<external_type>(val);
    }
    else
      return boost::optional<external_type>(boost::none);
  }

  // Create a string from a low_high_value
  boost::optional<internal_type> put_value(const external_type& b)
  {
    std::stringstream ss;
    ss << b.m_low << " " << b.m_high;
    return boost::optional<internal_type>(ss.str());
  }
}; 
```

前面的get_value方法很简单。如果文件可以由用户写入，则应该改进。

此类应使用以下方式注册：

```
namespace boost { namespace property_tree 
{
  template<typename Ch, typename Traits, typename Alloc> 
  struct translator_between<std::basic_string< Ch, Traits, Alloc >, low_high_value>
  {
    typedef low_high_value_translator type;
  };
} } 
```

包含前面的代码后，您可以将 property_tree 用作：

```
 pt.get<low_high_value>("box.x")
  pt.put("box.u", low_high_value(-110, 200)); 
```

# c# - 使用 Graphics.DrawImage() 缩小某些图像时图像丢失

> ID：13072709
> 
> 赞同：4
> 
> 时间：2012-10-25T16:07:11.093
> 
> 标签：c#, asp.net

> **可能重复：**
> [缩小图像时如何获得更好的结果](https://stackoverflow.com/questions/6170912/how-can-i-get-better-results-when-shrinking-an-image)

我正在尝试使用下面的代码生成大小为 200 x 200px 的缩略图。它适用于某些图像，但不适用于其他图像。当它不起作用时，会生成具有该大小的缩略图，但只能看到部分图像，而另一部分是灰色的（就像您使用了灰色画笔并涂抹在缩略图上一样）。当它失败时，我无法看到趋势。例如，对于 400 像素 x 400 像素大小的 JPEG 图像，它会失败。如果我尝试生成大小为 150 像素 x 150 像素的缩略图，则不会丢失图像。如果这有帮助，这里是一张导致问题的图像 - [http://s11.postimage.org/sse5zhpqr/Drawing_8.jpg](http://s11.postimage.org/sse5zhpqr/Drawing_8.jpg)

珍惜你的时间。

```
 public Bitmap GenerateThumbnail(Bitmap sourceBitmap, int thumbnailWidth, int thumbnailHeight)
    {
        Bitmap thumbnailBitmap = null;

        decimal ratio;
        int newWidth = 0;
        int newHeight = 0;

        // If the image is smaller than the requested thumbnail size just return it
        if (sourceBitmap.Width < thumbnailWidth &&
            sourceBitmap.Height < thumbnailHeight)
        {
            newWidth = sourceBitmap.Width;
            newHeight = sourceBitmap.Height; 
        }
        else if (sourceBitmap.Width > sourceBitmap.Height)
        {
            ratio = (decimal)thumbnailWidth / sourceBitmap.Width;
            newWidth = thumbnailWidth;
            decimal tempDecimalHeight = sourceBitmap.Height * ratio;
            newHeight = (int)tempDecimalHeight;
        }
        else
        {
            ratio = (decimal)thumbnailHeight / sourceBitmap.Height;
            newHeight = thumbnailHeight;
            decimal tempDecimalHeight = sourceBitmap.Width * ratio;
            newWidth = (int)tempDecimalHeight;
        }

        thumbnailBitmap = new Bitmap(newWidth, newHeight);

        Graphics g = Graphics.FromImage(thumbnailBitmap);
        g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;
        g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
        g.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;
        g.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighQuality;

        g.FillRectangle(Brushes.White, 0, 0, newWidth, newHeight);
        g.DrawImage(sourceBitmap, 0, 0, newWidth, newHeight);
        g.Dispose();

        return thumbnailBitmap;
    } 
```

更新：

我做了更多分析，似乎问题在于将缩略图保存到 SQL Server 数据库的 varbinary 列中。我正在使用 MemoryStream 来执行此操作，如下所示。如果我将它保存到磁盘，它看起来就好了。这是我数据库中的缩略图 - [http://s12.postimage.org/a7j50vr8d/Generated_Thumbnail.jpg](http://s12.postimage.org/a7j50vr8d/Generated_Thumbnail.jpg)

```
 using (MemoryStream thumbnailStream = new MemoryStream())
{             
          thumbnailBitmap.Save(thumbnailStream, System.Drawing.Imaging.ImageFormat.Jpeg);               
          return thumbnailStream.ToArray();

} 
```

更新 - 此问题已解决。问题是我用于 varbinary 列的 NHibernate 映射。我必须将类型指定为“BinaryBlob”，以确保不会对大于 8KB 的数据进行静默截断。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:28:33.723

我很感激，这可能应该是评论而不是答案，但是对于我作为答案发布的额外格式。

这是我用来缩小图像的代码，我从来没有遇到过这个问题：

```
private byte[] ResizeImage(System.Drawing.Image image, double scaleFactor)
        {
            //a holder for the result
            int newWidth = (int)(image.Width * scaleFactor);
            int newHeight = (int)(image.Height * scaleFactor);

            Bitmap result = new Bitmap(newWidth, newHeight);

            //use a graphics object to draw the resized image into the bitmap
            using (Graphics graphics = Graphics.FromImage(result))
            {
                //set the resize quality modes to high quality
                graphics.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;
                graphics.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;
                graphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
                //draw the image into the target bitmap
                graphics.DrawImage(image, 0, 0, result.Width, result.Height);
            }

            //return the resulting bitmap
            ImageConverter converter = new ImageConverter();
            return (byte[])converter.ConvertTo(result, typeof(byte[]));            
        } 
```

当然，我返回 a`byte[]`而不是 a `Bitmap`，然后将其保存到数据库中。

我真正能看到的唯一区别是`Bitmap`用高度和宽度实例化我的结果，我没有调用该`FillRectangle`方法，也没有设置`PixelOffsetMode`. 我也从`Image`a 而不是 a`Bitmap`

希望这对您有所帮助。

# visual-studio-2010 - CMFCToolbar ReplaceButton() 导致按钮消失

> ID：13072713
> 
> 赞同：6
> 
> 时间：2012-10-25T16:07:25.473
> 
> 标签：visual-studio-2010, mfc, cmfctoolbar

使用**Visual Studio 2010**并使用**MFC SDI 应用程序**。我有一个主框架拥有的**CMFCToolbar对象。**

创建此应用程序中的文档时，MainFrame 调用一个函数以将 CMFCToolbar 对象中的一个按钮替换为**CMFCToolbarMenuButton**。菜单按钮的内容由文档中的信息填充。菜单创建始终有效。对 ReplaceButton 的调用总是成功的。但是我还没有弄清楚这个电话的视觉症状。

任何时候调用 ReplaceButton，按钮都会消失。它不仅不被绘制，而且不可点击。暂时没了。我认为这是因为有一个对旧按钮的悬空引用，我刚刚通过调用 ReplaceButton 将其销毁。

我试过调用 Invalidate()、RecalcLayout() 来触发重绘，但都没有奏效。我让按钮显示的唯一可靠方法是手动或通过取消停靠/重新停靠工具栏来重新调整应用程序窗口的大小。我假设在这些情况下会发生某种较低级别的刷新，但我不知道如何手动触发它。

有没有办法确保我的按钮立即被绘制？

编辑：代码示例

```
Count = m_Doc->...->GetCount();
for (Index = 0; Index < Count; ++Index)
{
    Caption.Format(L"%s", m_Doc->...->GetName());
        m_pLayerMenu->AppendMenu(MF_ENABLED | MF_STRING, LAYER_DROP_SEED+Index, Caption.GetData());
}
m_wndBrushBar.ReplaceButton(ID_BRUSH_TERRAIN,
    CMFCToolBarMenuButton(ID_BRUSH_TERRAIN, *m_pLayerMenu, GetCmdMgr()->GetCmdImage(ID_BRUSH_TERRAIN))); 
```

更新：

调用`m_wndBrushBar.AdjustLayout()`似乎可以稳定这些 CMFCToolbar 按钮的视觉行为。所以这是一个部分解决方案。部分原因如下：

很难说出真正的视觉行为是什么。事实证明，所有视觉设置/状态都与这些 MFC 对象一起存储在注册表中，并且它可以保持动态创建的对象的状态，这些对象真正改变了应用程序的启动行为。

我已经进去删除了下面的注册表值

`Current User -> "Local App-Wizard Generated Applications" -> [My App Name]`. 这样做了很多次，只是为了找出我的应用程序的真实行为是什么。感觉好像我缺少当前版本的 MFC 的一些基础知识。注册表交易引起的许多错误。

有没有办法阻止某些对象的注册表设置，或者完全关闭这种行为？否则，我想我的关机过程必须更加彻底地重置所有视觉元素。注册表值似乎忽略、覆盖或绕过我的启动代码。我可以编写我希望对象如何看待启动的代码，但是如果注册表中有值，那就没有用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-10T20:04:15.003

您发现了 CMFC 代码有时令人讨厌的方面。也就是 Workspace 的概念。工作区管理应用程序状态的概念。我也遇到过你描述的问题。但是，您可以通过重写 LoadState () 和 SaveState () 方法灵活地管理如何重新创建这些对象。

# android - Cordova/PhoneGap 2.1.0 Android 应用程序中对自签名 HTTPS 资源的 AJAX 请求

> ID：13072717
> 
> 赞同：4
> 
> 时间：2012-10-25T16:07:34.847
> 
> 标签：android, cordova, https, self-signed

我正在尝试实施由 Chris 提供的解决方法，在[此处](https://stackoverflow.com/questions/10969043/phonegap-cordova-whitelisted-cross-domain-ssl-request-not-working-after-exportin/11856758)找到，以允许 PhoneGap/Cordova 构建的 Android 应用程序向具有自签名 SSL 证书的服务器发出 AJAX HTTPS 请求。我使用的是 PhoneGap/Cordova 2.1.0，而 Chris 使用的是 1.7.0。我可以毫无问题地创建 MyWebViewClient 类。但是，当我添加这行代码时......

```
this.setWebViewClient(this.appView, new MyWebViewClient(this)); 
```

...对于 MainActivity 类的重写 init() 方法，我收到此错误：

> 未为 MainActivity 类型定义方法 setWebViewClient(CordovaWebView, MyWebViewClient)

这是我的 MyWebViewClient.java 代码：

```
package [packagename];

import android.net.http.SslError;
import android.webkit.SslErrorHandler;
import android.webkit.WebView;
import org.apache.cordova.CordovaWebViewClient;
import org.apache.cordova.DroidGap;

public class MyWebViewClient extends CordovaWebViewClient {

    public class MyWebViewClient(DroidGap ctx) {
        super(ctx);
    }

    @Override
    public void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {
        handler.proceed();
    }
} 
```

这是我的 MainActivity.java 代码：

```
package [packagename];

import android.os.Bundle;
import org.apache.cordova.*;

public class MainActivity extends DroidGap {

    @Override
    public void init() {
        super.init();
        this.setWebViewClient(this.appView, new MyWebViewClient(this)); // Error occurs here
    }

    @Override
    public void onCreate(bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        super.setBooleanProperty("keeprunning", false);
        super.loadUrl("file:///android_asset/www/index.html");
    }
} 
```

我没有足够的声誉，否则我只会评论克里斯的回答。另外，我不是在寻找 jQuery 解决方案（我已经知道我可以调用 $.ajax() 来避免这个问题，但我试图让 jQuery 远离我的应用程序）。

有任何想法吗？非常感谢您的帮助！

**编辑：**请在回复之前查看我的评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T09:33:43.907

这可以在以后的 Cordova 版本（我使用的是 2.2）上修复如下。如前所述，它失败了`onPageStarted()`- 这是因为它需要一个 appView，它是 null 所以你得到一个 NullPointerException。设置 appView 似乎可以修复它，例如

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    super.init();

    CordovaWebViewClient webViewClient = new CustomWebViewClient(this);
    webViewClient.setWebView(this.appView);
    this.appView.setWebViewClient(webViewClient);

    super.loadUrl("file:///android_asset/www/index.html");

} 
```

请注意，`super.init()`也需要

# c - 尝试将结构传递给函数时出错

> ID：13072718
> 
> 赞同：1
> 
> 时间：2012-10-25T16:07:35.467
> 
> 标签：c, linux, gcc, compiler-errors, structure

在下面的程序中，我尝试将结构传递给函数。但我得到错误，我不明白为什么。我在这个程序中犯了什么错误？

我`gcc`用来编译这个`c`程序。

```
#include <stdio.h>

struct tester {
  int x;
  int *ptr;
};

void function(tester t);

int main() {
 tester t;
 t.x = 10;
 t.ptr = & t.x;
 function(t);
}

void function(tester t) {
   printf("%d\n%p\n",t.x,t.ptr);
} 
```

* * *

错误：

```
gcc tester.c -o tester

tester.c:8:15: error: unknown type name ‘tester’
tester.c: In function ‘main’:
tester.c:12:2: error: unknown type name ‘tester’
tester.c:13:3: error: request for member ‘x’ in something not a structure or union
tester.c:14:3: error: request for member ‘ptr’ in something not a structure or union
tester.c:14:13: error: request for member ‘x’ in something not a structure or union
tester.c: At top level:
tester.c:18:15: error: unknown type name ‘tester’ 
```

***注意*：** 如果我`printf`用`cout`和`stdio`替换`iostream`并将扩展名命名为`.cpp`(!)，我不会收到任何错误。这是为什么 ？难怪我用它编译它`g++`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T16:09:43.227

如果您不 typedef 结构，则必须在结构名称前面指定结构，同时声明它，如下所示：

```
struct tester t; 
```

您要么这样做，要么执行以下操作：

```
typedef struct {
  int x;
  int *ptr;
}tester; 
```

**更新**

以下是来自 Adam Rosenfield 的引述[。C++ 中“struct”和“typedef struct”的区别？](https://stackoverflow.com/questions/612328/difference-between-struct-and-typedef-struct-in-c)：

> 在 C++ 中，所有 struct/union/enum/class 声明的行为就像它们是隐式类型定义的，只要名称没有被另一个具有相同名称的声明隐藏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:09:06.343

你的结构没有命名。使用`struct tester t;`或使用 typedef

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-22T04:35:09.367

问题是您正在尝试使用 gcc 进行编译，这是一种“c 语言”编译器，并且您正在遵循 C++ 代码风格。
可以通过**structname variablename 创建一个 struct 变量；**
但是在 C++ 中，你必须明确地告诉编译器它是一个类似于
**struct structname variablename 的结构；** 只要这样做，你会没事的，否则你可以使用 typedef 基本上你现在告诉编译器表单你将调用 struct tester 到只有 tester，这将更适合你，因为你只需要一个次要的改变。

# mysql - SQL：加入表，结果在其中一列上具有唯一值？

> ID：13072723
> 
> 赞同：1
> 
> 时间：2012-10-25T16:07:45.937
> 
> 标签：mysql, sql

我想连接两个表，但要指定结果应该在其中一列上具有唯一值。

[http://sqlfiddle.com/#!2/70ded/4](http://sqlfiddle.com/#!2/70ded/4)

代替

```
URLID DOMAINID
13    5
9     3
10    3
11    4
12    4
6     2
7     2
8     2
1     1
2     1
3     1
4     1
5     1 
```

我想得到：

```
URLID DOMAINID
13    5
9     3
11    4
6     2
1     1 
```

是否有可能这样做并通过创建**更快**的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:11:28.300

这个怎么样？我刚刚将聚合应用于`urlid`并添加了一个`group by`：

```
SELECT min(urlid) urlid, domain_stack.domainid 
FROM  domain_stack
INNER JOIN url_stack
  ON url_stack.domainid = domain_stack.domainid
group by domain_stack.domainid 
order by domain_stack.domainid desc 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/70ded/10)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:12:10.043

您的查询不会更快，因为您必须删除重复项。这是一种MySQL方式：

```
select urlID, domainID
from (<your query>) as t
group by domainID 
```

这使用称为隐藏列的 MySQL 错误（功能）。在大多数数据库中，您将使用：

```
select min(urlID), domainID
from (<your query>) as t
group by domainID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:13:38.560

```
SELECT urlid,domain_stack.domainid
FROM  domain_stack
INNER JOIN url_stack
ON url_stack.domainid = domain_stack.domainid
GROUP BY domainid 
```

# c# - 将数据适配器的结果填充到我自己的数据集？

> ID：13072724
> 
> 赞同：0
> 
> 时间：2012-10-25T16:07:50.597
> 
> 标签：c#, dataset

在开始我的问题之前，我需要提到我是 c++ 程序员而不是 c#，所以也许我的代码语法似乎错误。我是业余爱好者，需要改进！;)

我有一个关于处理数据适配器输出结果的问题（也许是一个想法而不是问题）。让我们看一下这些行：

```
public DataSet CollectData()
{
    DataSet result = new DataSet();
    using (SqlConnection conn = new SqlConnection(connectionString))
    using (SqlCommand cmd = new SqlCommand("dbo.StoredProc1", conn))
    {
        cmd.CommandType = CommandType.StoredProcedure;
        IDataAdapter adapter = new SqlDataAdapter(cmd);

        adapter.Fill(result);/// filling a dataset

        return result;
    }
} 
```

如您所见，此函数填充数据集并将其返回。任何我想使用这个对象的地方，我都应该像这样循环遍历它：

```
 DataSet dataSet = DataObj.CollectData(); /// above function!

    string token;
    string lemma;
    foreach (DataRow row in dataSet.Tables[0].Rows)
    {
        token = ((string)row["Token"]);
        lemma = ((string)row["Lemma"]);
        ...

        //// TODO: ex. write to file 
    } 
```

但是，我有一个类来演示这个存储的对象。

像这样的课程：

```
public class Lexeme
{
private int tokenId = -1;
private string token;
private string lemma;
/// some get and set functions!
} 
```

如您所见，该类包含一个对象（它类似于数据库表中存储对象的包装器）

所以我想知道是否有返回这个对象的列表（这里的 Lexeme）而不是数据集？我的意思是具有高效内存使用的东西。因为我处理大量数据。

例如这样的：

```
public MYDATASET CollectData()
{
    MYDATASET result = new MYDATASET ();
    using (SqlConnection conn = new SqlConnection(connectionString))
    using (SqlCommand cmd = new SqlCommand("dbo.StoredProc1", conn))
    {
        cmd.CommandType = CommandType.StoredProcedure;
        IDataAdapter adapter = new SqlDataAdapter(cmd);

        adapter.Fill(result);/// filling a dataset

        return result;
    }
} 
```

数据集可以继承吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:05:44.260

您可以使用 a`Typed Dataset`而不是您自己的对象。这使您可以轻松地填充数据集，而且还具有强类型列，并且能够轻松地访问一行中的每个属性。转到`Add New Item`Visual Studio 的窗口并添加一个数据集。使用设计器添加一个新表，并添加从您的 sql 查询返回的列。转到每一列的属性窗口并指定类型（int、string 等）。

从那里，当您加载数据集时，创建一个数据集类型的新对象，并像以前一样填充它：

```
public MyTypedDataset GetMyDataSet()
{
    MyTypedDataset ds = new MyTypedDataset();
    using (SqlConnection conn = new SqlConnection(connectionString))
    using (SqlCommand cmd = new SqlCommand("dbo.StoredProc1", conn))
    {
        cmd.CommandType = CommandType.StoredProcedure;
        IDataAdapter adapter = new SqlDataAdapter(cmd);

        adapter.Fill(ds.Table1);

        return result;
    }
} 
```

对于类型化的数据集，您在设计器中创建的每个表项都有一个属性。（默认情况下我相信它被命名为`Table1`？）

现在，在访问您的数据时，您可以这样做

```
MyTypedDataset ds = GetMyDataSet();
string myToken = ds.Table1.Rows[0].Token;
string myLemma = ds.Table1.Rows[0].Lemma; 
```

或在 foreach 中：

```
MyTypedDataset ds = GetMyDataSet();
foreach(var row in ds.Table1)
{
    string myToken = row.Token;
    string myLemma = row.Lemma;
} 
```

这不如获取对象列表好，但它几乎就在那里。如果您想要一个您自己的对象的列表，您很可能需要使用`Object Relational Mapper`Entity Framework 或 NHibernate 等。

# c# - 如何正确伪造 IQueryable 从使用 Moq 的存储库？

> ID：13072725
> 
> 赞同：13
> 
> 时间：2012-10-25T16:07:52.397
> 
> 标签：c#, unit-testing, nunit, moq

我有一个类，它在它的构造函数中使用一个 IRepository 像这样......

```
 public class UserService
    {
       public IRepository<User> _repo { get; set; }
       public UserService(IRepository<User> repo = null)
       {
        _repo = repo ?? new UserRepository();
       } 
```

并有一个看起来像这样的方法......

```
public bool IsUserActive(email string)
{
   //The method actually does more but to keep it simple lets imagine 
   // it does this
   User user = _repo.Find(u => u.Email == email).First();
   return user.IsActive;
} 
```

IRepository 看起来像这样。

```
public interface IRepository<T> : IDisposable where T : IEntity
{
    void InsertOrUpdate(T entity);
    void Delete(T entity);
    IQueryable<T> Find(Func<T, bool> query);
    T Find(int id);
    void Save();
} 
```

我想测试该`IsUserActive`方法并确保如果`IsActive`用户的字段为 false 则返回 false，反之亦然。

我正在尝试以下...

```
 [Test]
    public void IsUserActive_EmailThatWillReturnInactiveUser_ReturnsFalse()
    {
        //Arrange
        var fakeUserRepo = new Mock<IRepository<User>>();
        var query = new Func<User, bool>(u => u.Email == "AnyString");
        var listOfMatchingUsers = new List<User>() 
        {
                    new User 
                    { 
                        Email = "AnyString", 
                        IsActive = False 
                    }
        };
        IQueryable<User> queryableUsers = listOfMatchingUsers.AsQueryable();
        fakeUserRepo.Setup(r => r.Find(query)).Returns(queryableUsers);
        var userService = new UserService(fakeUserRepo.Object);

        //Act
        var result = userService.IsUserActive("AnyString");

        //Assert
        Assert.IsFalse(result);
    } 
```

当我在 NUnit 中运行时，我在这一行收到错误“序列不包含元素”

```
var result = userService.IsUserActive("AnyString"); 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T16:17:03.787

将模拟设置更改为

```
fakeUserRepo.Setup(r => r.Find(It.IsAny<Func<User, bool>>()))
            .Returns(queryableUsers); 
```

# javascript - 如何使用重定向 URL 中的对象结果进行重定向？

> ID：13072726
> 
> 赞同：1
> 
> 时间：2012-10-25T16:07:55.463
> 
> 标签：javascript, url, redirect, replace

我正在从服务器 A 上的用户那里收集数据，

我需要将 URL 中的数据发送到服务器 B（单独的建筑物和公司）

在服务器 A 上，它是一个预先构建的 CRM 系统，我不能简单地使用参数，因为我无法对参数进行哈希处理，因为系统是由第三方预先构建的，他们会为此收费。

所以我设法构建了一些 JS 来替换我可以收集的 PARAMETER 中的某些字符。

这是我必须制作的 HASH 的一小部分。

```
<script type="text/javascript">
// Collect USERID
var m = 'XX784188';

// HASH USERID
m = m.replace(/7/g, 'M');
m = m.replace(/4/g, 'S');

// Set up Object n as Location name.
var n = 'Cumbria';

// Rename Location to correct code
n = n.replace(/[Cumbria]/g, '01');

// Test Object m & n
alert(n);
alert(m);​​ 
```

[这](http://jsfiddle.net/LXMTM/)是上面的测试。

现在我似乎无法找到的是如何将结果插入 url 并将用户重定向到该 URL。

例如：`http://google.com/?n=&m=`

我可以插入我知道的用于重定向的这一行：

```
window.location = "http://google.com/?n=&m=" 
```

我只需要知道如何使该 URL 看起来像这样`google.com/?n=01&m=XXM8S188`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:14:22.323

有趣的是，我在 1 分钟前刚刚回答了同样的问题：

```
window.location = "http://google.com/?n="+n+"&m="+m 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:18:26.847

您的代码段代码和 JS Fiddle 代码是不同的。

对于**代码片段**，您只需插入您的值，例如，

```
window.location = "http://google.com/?n="+n+"&m="+m; 
```

对于**JSFiddle 代码**，那么，

```
window.location = "http://google.com/?"+serialiseObject(obj);​ 
```

# php - PHP PDO INPUT SQLSTATE[HY093]：参数号无效：参数未定义错误

> ID：13072728
> 
> 赞同：0
> 
> 时间：2012-10-25T16:08:11.157
> 
> 标签：php, mysql, pdo

我对使用数据库非常陌生，我已经研究了几天，但我无法通过无效参数编号。我已经削减了代码和选项，只是试图使用 PHP 5.2 将两个数据导入 MySQL 5.1 db 我可以很好地连接到 db，并且基于 echo 语句，我确信我可以进入 prepare 语句。

完整代码如下

```
 $DBHandle= new PDO('mysql:localhost;dbname=nameishere','userishere','passishere');

//* $DBHandle->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION ); --for USE
//* below is what I am currently using for debugging

$DBHandle->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING );

//*next bit is to insure that if connection is lost database is not partially updated-I think- right now commented out
//* $DBHandle->beginTransaction();

    $mainIncrement= NULL;
    $firstnameOBS= $_POST['touristfirstname'];
    $todaysdateOBS= $_POST['touristdatetoday'];
    //*$picturenow= $_POST['picturesubmitted'];

    $JSONfirstname = json_encode($firstnameOBS);
    $JSONtodaysdate = json_encode($todaysdateOBS);
    //*$JSONpicturenow = json_encode($picturenow);

    echo ($JSONfirstname);

    $senditin = $DBHandle->prepare("INSERT INTO 'fkarnd'('firstname','datetoday') VALUES(:field1,:field2)", array(PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY));

    $senditin->bindValue(':firstname', $JSONfirstname, PDO::PARAM_STR);
    $senditin->bindValue(':datetoday', $JSONtodaysdate, PDO::PARAM_STR);

    //* $myinputarray = array('firstname'=> $JSONfirstname, 'datetoday' => $JSONtodaysdate );

    $senditin->execute();

    //* commit allows transaction begun to complete
    //* $DBHandle->commit();

  //*  catch ( PDOException $e ) 
     echo "I'm sorry, I can't do that Dave......";
  //*file_put_contents( 'dbErrors.txt', $e->getMessage(),FILE_APPEND);  

  //*  echo "successful submission for the preservation of JohnsPass";
    $DBHandle = null; 
```

我尝试将数据放入数组中然后执行，我尝试了几种不同格式的 prepare 语句，包括`INPUT ()INTO table WHERE()...`. 我试过没有绑定。我真的只是想从我创建的 HTML5 表单中将数据放入数据库中。表单数据基于 echo statments 可以正常处理，并且大多数 PHP 示例似乎处理的是 SELECT 而不是 INPUT。

下面是输出和我无法弄清楚的错误

```
"Dread"
Warning: PDOStatement::execute() [pdostatement.execute]: SQLSTATE[HY093]: Invalid parameter number: parameter was not defined in /home/mabelsbi/public_html/johnspass.org/Science/FirstTry.php on line 46

Warning: PDOStatement::execute() [pdostatement.execute]: SQLSTATE[HY093]: Invalid parameter number in /home/mabelsbi/public_html/johnspass.org/Science/FirstTry.php on line 46 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:09:23.663

```
$senditin = $DBHandle->prepare("INSERT INTO 'fkarnd'('firstname','datetoday') VALUES(:field1,:field2)", array(PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY));

$senditin->bindValue(':firstname', $JSONfirstname, PDO::PARAM_STR);
$senditin->bindValue(':datetoday', $JSONtodaysdate, PDO::PARAM_STR); 
```

您在查询中使用`:field1`and `:field2`，然后将`:firstname`and设置`:datetoday`为参数；你只需要在你设置的内容上保持一致：

```
$senditin = $DBHandle->prepare("INSERT INTO `fkarnd` (`firstname`,`datetoday`) VALUES(:firstname,:datetoday)", array(PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY));

$senditin->bindValue(':firstname', $JSONfirstname, PDO::PARAM_STR);
$senditin->bindValue(':datetoday', $JSONtodaysdate, PDO::PARAM_STR); 
```

（编辑为在 SQL 中围绕字段和表名使用反引号）

# java - 如何知道图像在每个像素中是 32 位、24 位、8 位、1 位

> ID：13072736
> 
> 赞同：1
> 
> 时间：2012-10-25T16:08:41.983
> 
> 标签：java, image, image-processing, pixel, pixels

经过大量谷歌搜索后，我发布了这个问题，
我想将图像转换为位数组，但我的研究指南知道，对于每个图像，其中的像素可能是 32 位或 24 位......等等所以如何知道每个图像中像素的位数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:13:48.657

你需要使用 javax.ImageIO API

```
ColorModel color = ImageIO.read(new File("test.jpg")).getColorModel();
color.getPixelSize(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:14:44.683

如果您有[`java.awt.image.RenderedImage`](http://java.sun.com/j2se/1.3/docs/api/java/awt/image/RenderedImage.html)，您可以调用`getData`以获取该图像的[光栅化数据](http://docs.oracle.com/javase/1.3/docs/api/java/awt/image/Raster.html)。

这本质上是数据的逐像素图，实际上您可以调用`getPixel(int x, int y, double[] dArray)`以获取单个给定像素的数据数组。

# cakephp-1.3 - 使用另一个模型进行 cakephp 验证

> ID：13072738
> 
> 赞同：0
> 
> 时间：2012-10-25T16:08:51.260
> 
> 标签：cakephp-1.3

我是 cakephp 新手，正在开发 1.3 版。我正在尝试从控制器验证表单，但它不起作用。这是我的控制器的操作代码：控制器是 cards_controller.php

```
class CardsController extends AppController {

            var $name = 'Cards';
            var $uses = array('Customfield','Customer','Parameter','Merchant','Merchantcard','Merchantcustomfield','Cardexist','Country','State','Customercontacts','Cardrenew');
            var $helpers =  array('Html','Form','Ajax','Javascript');
            var $components = array('Session','RequestHandler','RequestHandler','Auth');

    function index()
    {

    }

 function renewCard()
        {

         if($_SESSION['Auth']['User']['id'] == "")
                    {
                       $this->redirect("../users/login");
                    }

            $this->loadModel('Cardrenew');  

            $this->Cardrenew->set(array(
                      "customer_id" =>$id,
                       "merchant_id" =>$this->data['Card']['merchant_id'],
                       "merchant_card_id" =>$this->data['Card']
                                        ));                                  

                       if($this->Cardrenew->save())
                       {

                       }  
        }
    }

and here is the model code : 

class Cardrenew extends AppModel
    {
     public $name = "prc_renewal_cards";
     var $validate = array(
     'merchant_id' => array(
     'nameRule2'=>array(
     'rule'=> array('check'),
     'required' => true,
     'message'=>'Card already exists.'
     )),

    'nameOnCard' => array(
    'alphaNumeric' => array(
    'rule' => '/^[a-z0-9 ]*$/i',  // only 3 char (int or char  , no spaces in string)
    'required' => true,
    'allowEmpty'    => false,
    'message' => 'Please enter alphabets and numbers only.'
    ))

    ); 
```

控制器不保存任何值，因为 nameOnCard 是必需的。意味着验证发生，但它不显示任何错误消息。我在具有不同型号名称的同一控制器中的另一个动作上应用了相同的东西，它在那里工作正常。那么这个动作会发生什么？

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:53:49.737

几个建议

*   var $uses 很糟糕，使用模型关联（belongsTo、hasMany 等）
*   使用 Auth 进行会话管理，您可以使用 $this->Session->read() [http://book.cakephp.org/1.3/en/view/1250/Authentication读取会话](http://book.cakephp.org/1.3/en/view/1250/Authentication)

公共 $name = "prc_renewal_cards"; 实际上应该是 public $name = "Cardrenew";

显示您的视图代码会很有帮助。

# php - 如何按数组中的特定值对数组进行排序？

> ID：13072739
> 
> 赞同：-2
> 
> 时间：2012-10-25T16:08:55.360
> 
> 标签：php, arrays, sorting

> **可能重复：**
> [根据数组的值对数组进行排序](https://stackoverflow.com/questions/4716526/sorting-an-array-based-on-its-value)

我想按其中的值对数组进行排序。我试过`usort`了，但它导致了一些意想不到的结果，实际上改变了输出的值，而不仅仅是移动数组中的元素。

下面是我要排序的数组：

```
Array
(
[element1] => Array
    (
        [Total] => 1
        [paTotal] => 0
        [totalPreregistrations] => 7
        [totalPreregistrationsToDate] => 26
        [pas] => Array
            (
                [0] => Array
                    (
                        [id] => 119
                    )

            )

    )

[element2] => Array
    (
        [Total] => 1
        [paTotal] => 0
        [totalPreregistrations] => 0
        [totalPreregistrationsToDate] => 58
        [pas] => Array
            (
                [0] => Array
                    (
                        [id] => 107
                    )

            )

    )
... element3, 4, etc... 
```

我想按“totalPreregistrations”数字排序，如果 element2 的 totalPreregistrations 计数高于 element1，则 element2 高于 element1。

当然，我也希望保留子数组。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:12:44.820

[文档：`uasort()`](http://ca2.php.net/manual/en/function.uasort.php)

```
function mySort($a, $b) {
  if( $a['totalPreregistrations'] == $b['totalPreregistrations'] ) {
    return 0;
  } else if( $a['totalPreregistrations'] > $b['totalPreregistrations'] ) {
    return 1;
  } else {
    return -1;
  }
}

uasort($array, 'mySort'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:20:40.703

您可以使用`uasort`而不是`usort`

```
uasort($array, function ($a, $b) {
    $a = $a['totalPreregistrations'];
    $b = $b['totalPreregistrations'];
    return ($a == $b) ? 0 : (($a < $b) ? -1 : 1);
});

echo "<pre>";
print_r($array); 
```

输出

```
Array
(
    [element2] => Array <-------------------------- element key remains intact 
        (
            [Total] => 1
            [paTotal] => 0
            [totalPreregistrations] => 0
            [totalPreregistrationsToDate] => 58
            [pas] => Array
                (
                    [0] => Array
                        (
                            [id] => 107
                        )

                )

        )

    [element1] => Array
        (
            [Total] => 1
            [paTotal] => 0
            [totalPreregistrations] => 7
            [totalPreregistrationsToDate] => 26
            [pas] => Array
                (
                    [0] => Array
                        (
                            [id] => 119
                        )

                )

        )

) 
```

# sql - 具有多个 X 轴列的 SQL Server PIVOT

> ID：13072744
> 
> 赞同：3
> 
> 时间：2012-10-25T16:09:07.970
> 
> 标签：sql, sql-server, sql-server-2008, tsql, pivot

以以下示例数据为例：

```
Payroll Forname Surname Month   Year    Amount
0000001 James   Bond    3       2011    144.00
0000001 James   Bond    6       2012    672.00
0000001 James   Bond    7       2012    240.00
0000001 James   Bond    8       2012    1744.50
0000002 Elvis   Presley 3       2011    1491.00
0000002 Elvis   Presley 6       2012    189.00
0000002 Elvis   Presley 7       2012    1816.50
0000002 Elvis   Presley 8       2012    1383.00 
```

我将如何在年 + 月（例如：201210）上对此进行 PIVOT，但将工资单、姓名和姓氏保留为单独的列，例如，上面将变为：

```
Payroll Forename    Surname 201103  201206  201207  201208
0000001 James       Bond    144.00  672.00  240.00  1744.50
0000002 Elvis       Presley 1491.00 189.00  1816.50 1383.00 
```

我假设因为年份 + 月份名称可以更改，所以我将需要使用动态 SQL + PIVOT - 我试了一下，但甚至无法解析代码，没关系运行 - 任何帮助将不胜感激！

编辑：到目前为止我有什么：

```
 INSERT  INTO #tbl_RawDateBuffer
            ( PayrollNumber ,
              Surname ,
              Forename ,
              [Month] ,
              [Year] ,
              AmountPayable
            )
            SELECT  PayrollNumber ,
                    Surname ,
                    Forename ,
                    [Month] ,
                    [Year] ,
                    AmountPayable
            FROM    RawData
            WHERE   [Max] > 1500

DECLARE @Columns AS NVARCHAR(MAX)
DECLARE @StrSQL AS NVARCHAR(MAX) 

SET @Columns = STUFF((SELECT DISTINCT
                                ',' + QUOTENAME(CONVERT(VARCHAR(4), c.[Year]) + RIGHT('00' + CONVERT(VARCHAR(2), c.[Month]), 2))
                      FROM      #tbl_RawDateBuffer c
    FOR              XML PATH('') ,
                         TYPE 
            ).value('.', 'NVARCHAR(MAX)'), 1, 1, '') 

SET @StrSQL = 'SELECT PayrollNumber, ' + @Columns + ' from 
            (
                select PayrollNumber
                    , CONVERT(VARCHAR(4), [Year]) + RIGHT(''00'' + CONVERT(VARCHAR(2), [Month]), 2) dt
                from #tbl_RawDateBuffer
           ) x
            pivot 
            (
                sum(AmountPayable)
                for dt in (' + @Columns + ')
            ) p '

EXECUTE(@StrSQL)

DROP TABLE #tbl_RawDateBuffer 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:18:01.683

好的，正如您所说，您将需要动态 SQL，所以首先转到[此链接](http://www.sommarskog.se/dynamic_sql.html)。阅读后，请尝试以下操作：

**更新后的代码评论：**

```
DECLARE @cols AS NVARCHAR(MAX), @cols2 AS NVARCHAR(MAX), @query AS NVARCHAR(MAX);

WITH CTE AS
(
    SELECT *, CAST([Year] AS NVARCHAR(4))+RIGHT('00'+CAST([Month] AS NVARCHAR(2)),2) YearMonth
    FROM YourTable
)

SELECT @cols = STUFF((  SELECT DISTINCT ',' + QUOTENAME(YearMonth) 
                        FROM CTE 
                        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'),1,1,''),
       @cols2 = STUFF(( SELECT DISTINCT ',ISNULL(' + QUOTENAME(YearMonth) + ',0) AS ' + QUOTENAME(YearMonth)
                        FROM CTE 
                        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'),1,1,'')

SET @query = '
SELECT Payroll, Forname, Surname, ' + @cols2 + '
FROM (  SELECT  Payroll, Forname, Surname, 
                CAST([Year] AS NVARCHAR(4))+RIGHT(''00''+CAST([Month] AS NVARCHAR(2)),2) YearMonth,
                Amount
        FROM YourTable ) T
PIVOT(SUM(Amount) FOR YearMonth IN ('+@cols+')) PT'

EXEC(@Query) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T16:57:19.217

![在此处输入图像描述](../Images/c12c3a7ac27b4808d6614ce59c09b0cb.png) 选择工资单、姓名、姓氏、[20113] 作为 [201103]、[20126] 作为 [201206]、[20127] 作为 [201207]、[20128] 作为 [201208] 从（选择工资单、姓名、姓氏、年+月as d, 来自 pivot1) 的金额 up pivot(sum(up.Amount) for up.d in ([20113], [20126], [20127], [20128])) as pvt

# python - Python 条件 XML 编写

> ID：13072749
> 
> 赞同：1
> 
> 时间：2012-10-25T16:09:24.660
> 
> 标签：python, xml

我正在使用 Python 将 CSV 文件转换为 XML 格式。CSV 文件有不同数量的行，范围从 2（包括标题）到无穷大。（实际上是 10-15，但除非有一些重大的性能问题，否则我想覆盖我的基础）为了转换文件，我有以下代码：

```
for row in csvData:
    if rowNum == 0:
        xmlData.write('    <'+csvFile[:-4]+'-1>' + "\n")
        tags = row
        # replace spaces w/ underscores in tag names
        for i in range(len(tags)):
            tags[i] = tags[i].replace(' ', '_')
    if rowNum == 1: 
        for i in range(len(tags)):
            xmlData.write('        ' + '<' + tags[i] + '>' \
                          + row[i] + '</' + tags[i] + '>' + "\n")
        xmlData.write('    </'+csvFile[:-4]+'-1>' + "\n" + '    <' +csvFile[:-4]+'-2>' + "\n")
    if rowNum == 2:
        for i in range(len(tags)):
            xmlData.write('        ' + '<' + tags[i] + '>' \
                          + row[i] + '</' + tags[i] + '>' + "\n")
        xmlData.write('    </'+csvFile[:-4]+'-2>' + "\n")
    if rowNum == 3:
        for i in range(len(tags)):
            xmlData.write('<'+csvFile[:-4]+'-3>' + "\n" + '        ' + '<' + tags[i] + '>' \
                          + row[i] + '</' + tags[i] + '>' + "\n")
        xmlData.write('    </'+csvFile[:-4]+'-3>' + "\n")

    rowNum +=1
xmlData.write('</csv_data>' + "\n")
xmlData.close() 
```

如您所见，如果行存在，我将上层标签设置为手动创建。有没有更有效的方法来实现我创建`<csvFile-*></csvFile-*>`标签的目标，而不是重复我的代码 15 次以上？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:38:06.287

我会使用[xml.etree.ElementTree](http://docs.python.org/library/xml.etree.elementtree.html)或[lxml.etree](http://lxml.de/)来编写 XML。xml.etree.ElementTree 在标准库中，但没有内置的漂亮打印。[（但是，您可以从这里](http://effbot.org/zone/element-lib.htm#prettyprint)使用 indent 函数）。

lxml.etree 是一个第三方模块，但它的`tostring`方法中内置了漂亮的打印功能。

使用 lxml.etree，您可以执行以下操作：

```
import lxml.etree as ET

csvData = [['foo bar', 'baz quux'],['bing bang', 'bim bop', 'bip burp'],]
csvFile = 'rowboat'
name = csvFile[:-4]
root = ET.Element('csv_data')
for num, tags in enumerate(csvData):
    row = ET.SubElement(root, '{f}-{n}'.format(f = name, n = num))
    for text in tags:
        text = text.replace(' ', '_')
        tag = ET.SubElement(row, text)
        tag.text = text

print(ET.tostring(root, pretty_print = True)) 
```

产量

```
<csv_data>
  <row-0>
    <foo_bar>foo_bar</foo_bar>
    <baz_quux>baz_quux</baz_quux>
  </row-0>
  <row-1>
    <bing_bang>bing_bang</bing_bang>
    <bim_bop>bim_bop</bim_bop>
    <bip_burp>bip_burp</bip_burp>
  </row-1>
</csv_data> 
```

* * *

一些建议：

*   在 Python 中，你几乎不需要说

    ```
    for i in range(len(tags)):
        # do stuff with tags[i] 
    ```

    而是说

    ```
    for tag in tags: 
    ```

    循环遍历`tags`.

*   也不是通过循环手动计算时间

    ```
    num = 0
    for tags in csvData:
        num += 1 
    ```

    而是使用[枚举](http://docs.python.org/library/functions.html#enumerate)函数：

    ```
    for num, tags in enumerate(csvData): 
    ```

*   像这样的字符串

    ```
    '        ' + '<' + tags[i] + '>' \
                             + row[i] + '</' + tags[i] + '>' + "\n" 
    ```

    非常难以阅读。它将缩进逻辑、标签的 XML 语法以及行尾字符的细节混合在一起。这就是`xml.etree.ElementTree`或`lxml.etree` 会帮助你的地方。它将为您处理 XML 的序列化；您需要提供的只是 XML 元素之间的关系。代码将更具可读性和更易于维护。

# android - 使用支持 Objective-C 的 gcc 错误编译 Android NDK

> ID：13072751
> 
> 赞同：1
> 
> 时间：2012-10-25T16:09:30.533
> 
> 标签：android, objective-c, macos, gcc, toolchain

我正在研究[Jackie Gleason](https://docs.google.com/present/view?id=dfj692w3_351gq89x8fv&pli=1)关于让 Objective-c 在 Android 上编译的演示文稿以及[Michael f1337](http://michael.f1337.us/2011/11/19/rebuilding-the-android-ndk-for-objective-c-support/)关于同一主题的博客文章（加上在 Mac OS X 上工作，我就是这样）。他们的帖子和我的主要区别在于我正在努力使用最新的 NDK (r8b)。我已按照以下步骤操作：

1）在这里下载最新的NDK：http: [//developer.android.com/tools/sdk/ndk/index.html](http://developer.android.com/tools/sdk/ndk/index.html)

2）创建一个名为NDK的目录，并在此处解压下载。

3）在NDK目录下，创建文件夹toolchain-src。cd 到这个目录。

4）下载工具链：

```
git clone https://android.googlesource.com/toolchain/build.git
git clone https://android.googlesource.com/toolchain/gmp.git
git clone https://android.googlesource.com/toolchain/gdb.git
git clone https://android.googlesource.com/toolchain/mpc.git
git clone https://android.googlesource.com/toolchain/mpfr.git 
```

5) 创建目录 binutils。cd 到这个目录。

6) 在此处下载最新的 binutils tar 包：http: [//ftp.gnu.org/gnu/binutils/](http://ftp.gnu.org/gnu/binutils/)

7) 解压文件到当前目录。

8）回到toolchain-src目录，创建目录gcc。

9）下载支持objective c的gcc（用gcc-4.6.1测试）[http://ftp.gnu.org/gnu/gcc/](http://ftp.gnu.org/gnu/gcc/)

10) 将此文件解压到 gcc 文件夹中，然后导航回 toolchain-src 目录

11) cd 到构建目录，并编辑 Makefile.in 文件，更改行：

```
--with-gnu-as --with-gnu-ld --enable-languages=c,c++

to 

--with-gnu-as --with-gnu-ld --enable-languages=c,c++,objc 
```

12) 从 gcc 目录，下载并安装 gcc 补丁：

```
curl http://gcc.gnu.org/bugzilla/attachment.cgi?id=24879 > gcc.patch

cd gcc-4.6.1
patch -p1 < ../gcc-4.6.1.patch 
```

13）在ndk中找到这个文件：build/tools/build-mingw64-toolchain.sh。在此文件中，更改以下行：

```
var_append GCC_CONFIGURE_OPTIONS "--enable-languages=c,c++"
to
var_append GCC_CONFIGURE_OPTIONS "--enable-languages=c,c++,objc" 
```

14）接下来，在ndk中找到这个文件：build/tools/build-host-gcc.sh。在这里，换行：

```
ARGS=$ARGS" --enable-languages=c,c++"
to
ARGS=$ARGS" --enable-languages=c,c++,objc" 
```

15) 进入 bash 终端（通过键入 bash），然后输入这些行（将 <...> 替换为实际路径：

```
LOC="<path to NDK folder>/android-ndk-r8b/build/tools/build-gcc.sh"
SRC="<path to NDK folder>/toolchain-src"
NDK="<path to NDK folder>/android-ndk-r8b"
TOOL="arm-linux-androideabi-4.6.1"

sh $LOC --gmp-version=4.2.4 --mpfr-version=2.4.1 --mpc-version=0.8.1 --binutils-version=2.23 --try-64  $SRC $NDK $TOOL 
```

这开始工作，但失败并显示以下消息（在输出 config.log 文件中找到）：

```
build-gcc.sh:1771: error: cannot find install-sh, install.sh, or shtool in "<path to NDK>/android-ndk-r8b/build/tools" "<path to NDK>/android-ndk-r8b/build/tools/.." "<path to NDK>/android-ndk-r8b/build/tools/../.." 
```

查看 build-gcc.sh 文件，它的行数远少于 1771。进一步的调查使我相信这个错误发生在 /toolchain-src/gcc/gcc-4.6.1/configure 文件中，但我不知道要解决什么。

有谁知道我该如何解决这个问题？我不是在寻找外部链接或预构建的解决方案（例如 CrystaX 的自定义 ndk-r7），因为我已经阅读并尝试了很多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T21:39:42.090

奇怪的是，我不得不删除我现有的 NDK 并重新解压缩它。之后它起作用了。我最初安装了 NDK 作为第一步，但是它应该移到第 15 步之前。

# android - 在 Android 上重命名帐户 (AccountManager)

> ID：13072754
> 
> 赞同：5
> 
> 时间：2012-10-25T16:09:34.370
> 
> 标签：android, android-contacts, accountmanager, batch-rename

我正在更改已发布应用程序的名称。

是否有一种快速安全的方法来更改通过创建的帐户名称，`AccountManager.addAccountExplicitly`以便现有用户的现有信息保持不变。

如果没有，如何在保留所有数据的同时手动更改帐户名称？

我将发布我复制所有内容然后删除旧的天真的方法的答案，但我相信有人会想出一个更好的方法（或者在我的方法中发现一些错误）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-18T09:40:36.963

API v21 向 . 添加了一个[`renameAccount()`](https://developer.android.com/reference/android/accounts/AccountManager.html#renameAccount(android.accounts.Account,%20java.lang.String,%20android.accounts.AccountManagerCallback%3Candroid.accounts.Account%3E,%20android.os.Handler))方法`AccountManager`，如果有帮助的话。

从文档：

> 这相当于删除现有帐户并使用旧帐户的用户数据添加新的重命名帐户。

这意味着为了向后兼容，您必须手动删除该帐户并运行与创建新帐户相同的过程（`AccountManager.addAccountExplicitly()`和`AccountManager.setUserData()`）。

**编辑：** 如果您想在之后更新您的联系人以显示正确的帐户名称，请尝试以下（未经测试）代码：

```
ContentValues contentValues = new ContentValues();
contentValues.put(ContactsContract.RawContacts.ACCOUNT_NAME, "new account name");
getContext().getContentResolver().update(ContactsContract.RawContacts.CONTENT_URI,
        contentValues,
        ContactsContract.RawContacts.ACCOUNT_TYPE + " = ? AND " + ContactsContract.RawContacts.ACCOUNT_NAME + " = ?",
        new String[]{"your account type", "old account name"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:09:34.370

一种幼稚的方法，遍历所有记录，一个接一个地复制它们，然后删除所有旧的东西......

我真的担心这种方法可能会在现实世界的用户身上失败。

```
private void naiveRename(ContentResolver resolver) {
    ArrayList<ContentProviderOperation> operationList = new ArrayList<ContentProviderOperation>();
    Cursor cur = resolver.query(RawContacts.CONTENT_URI, null, RawContacts.ACCOUNT_NAME + "='"
            + "OLD NAME" + "'", null, null);
    if (cur != null) {

        // copy all data
        while (cur.moveToNext()) {
            Uri curUri = RawContacts.CONTENT_URI.buildUpon()
                    .appendQueryParameter(ContactsContract.CALLER_IS_SYNCADAPTER, "true")
                    .build();
            ContentProviderOperation.Builder builder = ContentProviderOperation
                    .newInsert(curUri);

            for (int i = 0; i < cur.getColumnCount(); i++) {
                String colName = cur.getColumnName(i);

                if (RawContacts._ID.equals(colName) || RawContacts.VERSION.equals(colName)
                        || RawContacts.CONTACT_ID.equals(colName)) {
                    // Skip - read only
                } else if (RawContacts.ACCOUNT_NAME.equals(colName)) {
                    builder.withValue(RawContacts.ACCOUNT_NAME, "NEW NAME");
                } else {
                    builder.withValue(colName, cur.getString(i));
                }
            }
            operationList.add(builder.build());
        }

        // delete all old data
        ContentProviderOperation.Builder builder = ContentProviderOperation
                .newDelete(RawContacts.CONTENT_URI);
        builder.withSelection(RawContacts.ACCOUNT_NAME + "='" + "OLD NAME" + "'", null);

            try {
                resolver.applyBatch(ContactsContract.AUTHORITY, operationList);
            } catch (RemoteException e) {
                // PANIC!
            } catch (OperationApplicationException e) {
                // OMG! WHAT TO DO?!
            }
        } else {
            // LORDI!
        }
    } 
```

# php - 使用 Codeigniter 的国际化 URL

> ID：13072759
> 
> 赞同：2
> 
> 时间：2012-10-25T16:09:49.233
> 
> 标签：php, codeigniter

我正在尝试将选定的*语言代码*添加到 URL，而不是将其存储在*session*或*cookie*中。

我下面的第一个示例手动设置语言，但我想根据用户选择使其动态化。如何在下面生成链接？

我知道 Codeigniter URL 的工作原理是`base_url/class_name/function_name/parametters`

**注意：** *我的基本网址是：`http://localhost/internationalisation/`*

```
http://localhost/internationalisation/en/
http://localhost/internationalisation/en/welcome
http://localhost/internationalisation/en/products/1
http://localhost/internationalisation/en/products/2
http://localhost/internationalisation/en/aboutus
http://localhost/internationalisation/en/contactus
OR spanish version 
```

**控制器**

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Welcome extends CI_Controller
{
    public function __construct()
    {
        parent::__construct();

        $this->load->helper('url');

        //$this->lang->load('en', 'english');
        $this->lang->load('es', 'spanish');
    }

    public function index()
    {
        $this->load->view('welcome_message');
    }
}

/* EoF */ 
```

**看法**

```
<a href="<?php echo site_url('en'); ?>">English</a>
<br />
<a href="<?php echo site_url(); ?>es">Spanish</a>

<br /><br /><br /><br />

<h1><?php echo $this->lang->line('welcome'); ?></h1> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:30:12.200

您应该在[Wiki](https://github.com/EllisLab/CodeIgniter/wiki/)上搜索此类内容，例如此库[URI 语言标识符](https://github.com/EllisLab/CodeIgniter/wiki/URI-Language-Identifier)可以满足您的需求。

# c# - 查询两个 DataTable 以查找重复行

> ID：13072770
> 
> 赞同：0
> 
> 时间：2012-10-25T16:10:29.020
> 
> 标签：c#, asp.net, sql-server, linq

我有一个 Excel 表，我正在使用 sqlbulkcopy 将其上传到 sqlserver 表，我在数据库表上应用了一个索引，以便忽略重复的条目，但我也想显示在网格视图中被忽略的重复条目。

```
 protected void Button1_Click(object sender, EventArgs e)
{
    string strFileType = System.IO.Path.GetExtension(FileUpload1.FileName).ToString().ToLower();
    string strFileName = FileUpload1.PostedFile.FileName.ToString();

    FileUpload1.SaveAs(Server.MapPath("~/Import/" + strFileName + strFileType));
    string strNewPath = Server.MapPath("~/Import/" + strFileName + strFileType);

        string excelConnectionString = String.Format(@"Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source="+strNewPath +"; Extended Properties=Excel 8.0;");

    //string excelConnectionString = String.Format(@"Provider=Microsoft.Jet.OLEDB.4.0;" + "Data Source=C:\\myFolder\\Book1.xls;" + "Extended Properties=Excel 8.0;"); 

        // Create Connection to Excel Workbook
        using (OleDbConnection connection = new OleDbConnection(excelConnectionString))
        {
            connection.Open();
            OleDbCommand command = new OleDbCommand("Select ID,Data FROM [Sheet1$]", connection);
            OleDbCommand command1 = new OleDbCommand("select count(*) from [Sheet1$]",connection);

            //Sql Server Table DataTable
            DataTable dt4=new DataTable();
            SqlCommand cmd4 = new SqlCommand("select id,data from ExcelTable", con);
            try 
                { 
                    SqlDataAdapter da4 = new SqlDataAdapter(cmd4); 
                    da4.Fill(dt4);//sql table datatable
                 }
                catch { }

            //excelsheet datatable
            DataTable oltlb = new DataTable();
          OleDbCommand olcmd = new OleDbCommand("select id,data from [Sheet1$]", connection);
          try
          {
              OleDbDataAdapter olda = new OleDbDataAdapter(olcmd);
              olda.Fill(oltlb); //excel table datatable
          }
          catch { }

    var matched = (from table1 in dt4.AsEnumerable()
                         join table2 in oltlb.AsEnumerable() on
                       table1.Field<int>("ID") equals table2.Field<int>("ID")
                         where table1.Field<string>("Data") == table2.Field<string>("Data")
                         select table1);
          DataTable dthi5 = new DataTable();
          dthi5 = matched.CopyToDataTable();

          GridView1.DataSource = dthi5;
          GridView1.DataBind();
            GridView1.DataSource = matched.ToList(); 
```

错误：指定的强制转换无效。table1.Field("ID") 等于 table2.Field("ID")

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:16:29.727

您的一个表中的 ID 字段似乎不是 int。

与其一个或两个人猜测，不如尝试检查两个表（oltlb 和 dt4）中第一列的数据类型，看看哪个具有非整数数据类型。实际上可能两者兼而有之。

事情是这样的：即使字符串的值是数字文字，也不能将字符串强制转换为 int。您必须使用`Int32.Parse`或`Convert.ToInt32`转换。因此，如果您的一个表的 ID 列具有字符串类型，您可以这样表示：

```
table1.Field<int>("ID") equals Convert.ToInt32(table2.Field<string>("ID")) 
```

如果两个表都有一个字符串 ID 字段，你可以这样表达：

```
table1.Field<string>("ID") equals table2.Field<string>("ID") 
```

# algorithm - 如何验证一个单词是否有有效的音节？

> ID：13072774
> 
> 赞同：3
> 
> 时间：2012-10-25T16:10:44.670
> 
> 标签：algorithm

我需要能够处理一个或多个单词并验证它是否具有有效的音节。有一些可以使用的音节规则：

```
V CV VC CVC CCV CCCV CVCC 
```

其中V是元音，C是辅音。例如，

```
pronunciation (5 Pro-nun-ci-a-tion; CCV-CVC-CV-V-CVC) 
```

或者有没有可以使用的简单代码，或者c++中的库？在课堂上，我们谈论的是二叉搜索树、哈希表等，但我看不出它们之间的关系。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:30:45.743

每当我们收集到一个完整的模式串时，我们可以丢弃它并开始收集到一个新的模式串，或者保留它并尝试获得更长的模式串。我们事先不知道（不检查输入字符串的其余部分），我们应该保留还是丢弃当前字符串，因此我们需要牢记这两种可能性。

我们可以构建一个状态机来为我们跟踪这一点。基本状态是由我们迄今为止检查过的字符序列识别的：

```
State   C           V
""      {"C"}       {"V",""}
"C"     {"CC"}      {"CV",""}
"CC"    {"CCC"}     {""}
"CCC"   {}          {""}
"CV"    {"CVC",""}  {}
"CVC"   {""}        {}
"V"     {""}        {} 
```

由于我们并不总是知道要采取什么行动，因此我们可以同时处于几种可能的状态。这些可能的状态集形成了超状态：

```
Index   Super-state        C    V
    0   {}                 0    0   Fail 
    1   {""}               2    9   Accept 
    2   {"C"}              3    8
    3   {"CC"}             4    1
    4   {"CCC"}            0    1
    5   {"","C"}           6   13   Accept
    6   {"C","CC"}         7    8
    7   {"CC","CCC"}       4    1
    8   {"","CV"}         12    9   Accept
    9   {"","V"}           5    9   Accept
   10   {"","C","CC"}     11   13   Accept
   11   {"C","CC","CCC"}   7    8
   12   {"","C","CVC"}    10   13   Accept
   13   {"","CV","V"}     12    9   Accept 
```

过渡是在超状态之间进行的。超级国家的每个成员都以相同的符号前进。没有这种转换的所有成员都将被丢弃。如果一个成员有两个可能的目的地，则两个都被添加到新的超级状态中。

您可能会注意到有些行非常相似。超状态 3 和 7 具有相同的转换。与 6 和 11，以及 8 和 13 一样。您可以将它们分别折叠成一个状态，然后更新索引。我不打算在这里证明这一点。

这可以很容易地编码成编程语言：

```
//                    index = 0  1  2  3  4   5  6  7   8  9  10  11  12  13
int[] consonant = new int[] { 0, 2, 3, 4, 0,  6, 7, 4, 12, 5, 11,  7, 10, 12 };
int[] vocal = new int[] {     0, 9, 8, 1, 1, 13, 8, 1,  9, 9, 13,  8, 13,  9 };
int[] accept = new int[] {    0, 1, 0, 0, 0,  1, 0, 0,  1, 1,  1,  0,  1,  1 };
int startState = 1;
int failState = 0;

bool CheckWord(string word)
{
    int state = startState;
    foreach (char c in word)
    {
        if (IsVocal(c))
        {
            state = vocal[state];
        }
        else if (IsConsonant(c))
        {
            state = consonant[state];
        }
        if (state == failState) return false;
    }
    return accept[state] != 0;
} 
```

**例子：**

```
> CheckWord("pronunciation")
true

> CheckWord("pronunciationn")
false 
```

# python - 安装bottlepy并运行python脚本

> ID：13072776
> 
> 赞同：1
> 
> 时间：2012-10-25T16:11:00.120
> 
> 标签：python, macos, easy-install, bottle

我正在尝试通过我的终端窗口运行这个简单的 python 脚本：（它是 Bottlepy 网站上的示例）

```
from bottle import route, run, template

@route('/hello/:name')
def index(name='World'):
    return template('<b>Hello {{name}}</b>!', name=name)

run(host='localhost', port=8080) 
```

为了做到这一点，我从终端安装了 Bottlepy 使用

```
easy_install bottle 
```

将其安装在 /Library/Frameworks/Python.framework/Versions/4.2.30201/bin

当我尝试在终端窗口中运行我的 python 文档时：

```
cd ~/Dropbox/Work/MongoDB/
python hello.py 
```

它返回：

```
ImportError: No module named bottle 
```

我不确定该怎么做才能将瓶子放在正确的位置以使其正常工作。我确定这一定很愚蠢，但我想不出该怎么做。谢谢！！xx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T20:02:31.373

看看[文档](http://bottlepy.org/docs/dev/tutorial.html#installation)。您可以将bottle.py 直接下载到包含其余程序的文件夹中，或者按照显示的方式安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-26T12:01:39.123

为了主要运行该文件，您需要首先创建应用程序：

```
app = bottle.Bottle() 
```

然后运行它或由外部网络服务器（如女服务员）提供服务

# javascript - 初始化一个索引分散在整数范围内的数组

> ID：13072779
> 
> 赞同：4
> 
> 时间：2012-10-25T16:11:04.153
> 
> 标签：javascript, jquery

如何在 javascript 中使用数据项初始化其索引分散在整个整数范围内的字符串数组（大小<100 项）。

如果我这样做：

```
array1 = ["string1","string2","string3","string4"]; 
```

然后我得到长度为 4 的数组，索引范围为 0 到 3

但在我的情况下，我想保留自己的索引，以便可以将数组用作高性能 int-string 哈希表。

*我最好寻找单个语句初始化。*

数组的项目应该可以像这样访问：`array1[23454]`

### 从评论更新

我仅限于将数组初始化为单个语句，因为动态准备的数组初始化字符串是从服务器端附加的，如下所示：`var array = <string from server here>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:27:34.300

在分配给它之前，您不必预先定义数组的大小。例如：

```
var _array = [];
    _array[0] = "foo";
    _array[1000] = "bar"; // _array.length => 1001 

_array[1] //undefined 
```

在分配给它们之前无需初始化适当数量的数组元素。

## 更新

已经指出，您可以使用对象而不是数组。但是，如果您想利用数组方法，那么这仍然是可能的。让我给你举个例子：

```
var obj = {
    0: 15,
    1: 10,
    2: 5,
    length: 3
}; 
```

如果对象包含**长度**属性，则可以将其视为类似数组的对象。虽然您不能直接从这些对象调用数组方法，但您可以使用数组方法。

```
Array.prototype.join.call( obj ); // 15,10,5 
```

事实上，使用 ECMAScript 5 的 map 函数，您可以轻松地将上述对象转换为数组。

```
var _array = Array.prototype.map.call( obj, function( x ) { return x; } ); 
```

地图功能并非在所有浏览器中都存在，但如果不存在，您可以使用以下功能。

```
Array.map = Array.map || function(a, f, thisArg) {
    return Array.prototype.map.call(a, f, thisArg); 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:13:20.640

要创建具有一定数量索引的数组，您可以使用

```
// Creates an array with 12 indexes
var myArray = new Array(12); 
```

由于其数组的工作方式，在 javascript 中不需要这样做。数组没有上限。如果您尝试引用数组中不存在的项目索引，`undefined`则返回但不会引发错误

要创建具有规定索引的数组，您可以使用类似的东西，`array['index'] = value`尽管这会迫使您使用多个语句。Javascript 没有数组初始化器来允许您在单个语句中指定索引和值，尽管您可以创建一个函数来执行此操作

```
function indexArray(param) {
    var a = [], i;
    for (i=0; i<param.length; i+=1) {
        a[param[i].index] = param[i].value;
    }
    return a;
}

var myArray = indexArray([
    { index: 123456, value : "bananas" },
    { index: 12, value : "grapes" },
    { index: 564, value : "monkeys" }
]); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T16:20:30.153

```
var array1 = []
array1[23454] = 2 
```

只是这样做应该没问题。没有像 java 那样为 javascript 设置数组大小。

如果你真的想在一个语句中完成这一切，你可以像这样创建一个对象：

```
var object1 = {
    "23454":2,
    "123":1,
    "50":3
}; 
```

然后像这样检索数字：

```
object1["23454"]  //2 
```

不过我真的不推荐这个。数组方法是一种更简洁的方法，即使它需要多行，因为它不需要字符串转换。我不太了解这些是如何在浏览器中实现的，无法评论性能影响。

## 更新

由于 1 行要求是基于传递给服务器的东西，我建议以以下形式将 JSON 对象传递给服务器：

```
"{"23454":2,"123":1,"50":3}" 
```

然后这段代码会将其解析为一个对象：

```
var object1 = JSON.parse(jsonstringfromserver); 
```

如果您愿意，您可以随时通过使用 for in 循环枚举属性将其转换为数组：

```
var array1 = []
for ( num in object1){
    array1[num] = object1[num]; 
```

这可能是不必要的，因为 object1[123] 已经返回 1。只有在计划执行特定于数组的操作时才需要它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T16:30:22.057

您可以通过以下方式对 Object 执行您想要的操作：

```
var o = {23454: 'aaaa', 23473: 'bbb'}; 
```

您将丢失数组方法/字段，例如长度，但您将获得您所说的您正在寻找的内容，并且您将能够轻松添加/删除成员。

# mysql - 忽略搜索查询中的特殊字符

> ID：13072780
> 
> 赞同：3
> 
> 时间：2012-10-25T16:11:08.377
> 
> 标签：mysql, escaping

几天来，我一直在绞尽脑汁试图找到解决方案。我正在尝试制作一个可以处理各种搜索词的“智能”查询。查询运行良好，直到涉及特殊字符，并且我在逗号和破折号等某些字符上使用 REPLACE 方法取得了一些成功。引号和 & 号等其他字符将导致空查询。

这里有几个例子：

我正在搜索的原始名称是“French Is Fun, Book 1 - 1 Year Option”，通过下面的查询，我得到了带有以下搜索词的结果：

```
1\.  "French Is Fun"
2\.  "French Is Fun, book"
3\.  "French Is Fun, book"
4\.  "French Is Fun, Book 1"

SELECT * FROM `products` WHERE ( (LOWER(name) LIKE '%french is fun book%' OR
LOWER(replace(name, '  ','')) LIKE '%french is fun book%' OR
LOWER(replace(name, ' ','')) LIKE '%french is fun book%' OR
LOWER(replace(name, '-','')) LIKE '%french is fun book%') 
```

但是，当原始标题中有一个与号，如下所示：“全球历史和地理：文明的发展 - 1 年选项” - 当我尝试这些不同的搜索词时，我得到一个空查询：

```
1\.  "Global History & Geography"
2\.  "Global History Geography" 
```

我试过这个无济于事

```
SELECT * FROM `products` WHERE  
(LOWER(name) LIKE '%global history geograph%' OR  
    LOWER(replace(name, '  ','')) LIKE '%global history geography%' OR  
    LOWER(replace(name, ' ','')) LIKE '%global history geography%' OR 
    LOWER(replace(name, ',','')) LIKE '%global history geography%' OR 
    LOWER(replace(name, '&','')) LIKE '%global history geography%' OR  
    LOWER(replace(name, '-','')) LIKE '%global history geography%'); 
```

我还尝试在＆符号中添加转义字符，但没有帮助：

```
SELECT * FROM `products` WHERE  
(LOWER(name) LIKE '%global history geography%' OR  
    LOWER(replace(name, '  ','')) LIKE '%global history geography%' OR  
    LOWER(replace(name, ' ','')) LIKE '%global history geography%' OR 
    LOWER(replace(name, ',','')) LIKE '%global history geography%' OR 
    LOWER(replace(name, '\&','')) LIKE '%global history geography%' OR  
    LOWER(replace(name, '-','')) LIKE '%global history geography%'); 
```

名称中的逗号也会返回空结果。作为演示，原名是这样的：

“Amsco 的 AP 微积分 AB/BC 为大学先修考试做准备 - 1 年选项”

此尝试始终返回空查询：

```
SELECT * FROM `products` WHERE 
( (LOWER(name) LIKE '%amscos ap calculus%' OR
     LOWER(replace(name, ' ','')) LIKE '%amscos ap calculus%' OR
     LOWER(replace(name, '\'','')) LIKE '%amscos ap calculus%' OR
     LOWER(replace(name, ',','')) LIKE '%amscos ap calculus%' OR
     LOWER(replace(name, '-','')) LIKE '%amscos ap calculus%')
    ) AND ( (`products`.`type` = 'Rental' ) ); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:26:15.560

按照你的方式，你会让你的数据库服务器一遍又一遍地做同样的工作，直到它因资源耗尽而死。

**精简版：**

将另一列添加到包含已去除特殊字符和小写的标题的表中。以此为依据进行选择。

**中等版本：**

使用[全文索引/搜索](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)。

**长版**

创建一个单独的表结构来跟踪单个单词及其与各种标题的关联，并创建查询/程序逻辑以使用它进行搜索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-10-09T08:46:30.550

您可以尝试这样做：

```
SELECT part_no, nomenclature FROM store_info WHERE 
REPLACE(
REPLACE(
  REPLACE(part_no,'/',''),'-',''),'.',''
) LIKE '%LWR0492%' 
```

# android - 以编程方式清除我自己的应用默认值

> ID：13072781
> 
> 赞同：4
> 
> 时间：2012-10-25T16:11:10.107
> 
> 标签：android

是否可以在 android 4.0 及更高版本中以编程方式清除您自己的应用程序的默认值？如果可能的话，有人能指出我正确的方向吗

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T16:16:15.347

您不能在任何版本的 Android 中以编程方式将您的应用设置为操作的默认值。

这是出于安全原因，因为恶意应用程序可以利用它成为任何用户操作的默认设置，并窃取个人信息或使设备无用等。

充其量，在您第一次运行时，您可以使用虚拟数据启动选择器意图，并要求用户将您的应用程序设置为默认值。

编辑：

我的错。我以为你想设置默认值。

[clearPackagePreferredActivities()](http://developer.android.com/reference/android/content/pm/PackageManager.html#clearPackagePreferredActivities%28java.lang.String%29) in`PackageManager`将清除特定应用程序的默认值，无论您传递的是哪个包名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T17:01:33.517

```
PreferenceManager.getDefaultSharedPreferences(context).edit().clear().commit(); 
```

# .net - 确定哪些可移植类库配置文件可以相互引用

> ID：13072785
> 
> 赞同：3
> 
> 时间：2012-10-25T16:11:14.277
> 
> 标签：.net, visual-studio, portable-class-library

有没有办法以编程方式（所以不在 Visual Studio 中尝试）各种可移植类库配置文件中的哪些可以相互引用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T22:21:10.180

是的，但它有点令人费解。在参考程序集文件夹下，例如`C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETPortable\v4.0\Profile\Profile158\SupportedFrameworks`，有指示支持哪些平台的文件。从那里，您可以确定给定的可移植项目是否与另一个兼容。

为了节省时间，NuGet 编写了一堆逻辑来解决这个问题，并在此签入中添加了这些逻辑：http: [//nuget.codeplex.com/SourceControl/changeset/e6a7dad9ceb8](http://nuget.codeplex.com/SourceControl/changeset/e6a7dad9ceb8)

# ruby-on-rails - 在我的表 sqlite3 表中找不到一行

> ID：13072791
> 
> 赞同：0
> 
> 时间：2012-10-25T16:11:30.857
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sql-update, replace

我正在尝试为我的一个表中的对象设置一个简单的编辑功能。这是我在网上和书中看到的当前代码，但它不起作用

```
def edit
    @fire_chief = FireChief.find(params[:id])
 end 
```

我所要做的就是弄清楚如何在列表视图中编辑特定的消防队长，我可以继续编程，但我被卡住了。

我收到的错误是“找不到没有 ID 的 FireChief”

如果我使用这段代码，它会发现编辑表单很好

```
def edit
    @fire_chief = FireChief.last
 end 
```

但它总是拉出最后一个要编辑的条目。我需要它来提取我单击的条目...可能是第 1、第 3 或第 5 等等。我知道其中很多是多余的，但我只想清楚我正在尝试做什么。

这是我的路线文件：

```
resource :timesheet do
    resource :command_officer
    resources :fire_chief
    resources :fire_fighters
    resource :safety_officer
    resources :emts
    resources :hazmat_specialists
    resources :command_vehicles
    resources :engines
    resources :emergency_supports
    resources :hazmat_units
    resources :field_units
    resources :pumpers
    resources :tankers
    resources :rescue_units
end
end 
```

我刚刚将资源 :fire_chief 更改为复数，所以现在它的资源 :fire_chief

但我现在收到此错误：

路由错误

未初始化的常量 FireChiefController

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:34:26.780

要从您那里获取所需的`id`数据或任何其他数据，您必须`params`像以下示例一样在 url 中传递数据：

`/firechief/2/edit`

这样，您的`edit`方法将知道 id 并且该方法将起作用。您可以在您的路线中手动设置它，制作这样的路线：

```
get  "/firechief/:firechief_id/edit" => "firechiefs#edit", as => :edit_firechief 
```

或者，如果您`resources`在路线内使用，则默认情况下它应该工作。

如果您实际上不想在 url 中传递任何数据，则可以实施基于会话的解决方案。创建一个方法来存储适合您需要`id`的`firechief`控制器内部的 ，或者如果您想在`firechief#create`您已经拥有的方法（如 ）中创建会话，则只需添加此行：

```
session[:firechief] = #here you add the id of the firechief you want to store 
```

现在在您的控制器上，您可以执行以下操作：

```
def edit
    @fire_chief = FireChief.find(session[:firechief])
end 
```

# php - 如何在运行测试之前启动 PHP 内置 Web 服务器并在测试运行后关闭它

> ID：13072795
> 
> 赞同：7
> 
> 时间：2012-10-25T16:11:40.250
> 
> 标签：php, jenkins, behat

我正在尝试使用 Behat 进行 BDD 测试。在 Jenkins 上运行构建时，我希望 Behat 在 Web 服务器中打开 PHP 构建，然后在运行测试后将其关闭。怎么做？

基本上我需要运行：

```
php -S localhost:8000 
```

在我的 BDD 测试中，我尝试过：

```
/**
 * @Given /^I call "([^"]*)" with email and password$/
 */
public function iCallWithPostData($uri)
{
    echo exec('php -S localhost:8000');
    $client = new Guzzle\Service\Client();
    $request = $client->post('http://localhost:8000' . $uri, array(), '{"email":"a","password":"a"}')->send();
    $this->response = $request->getBody(true);
} 
```

但是当运行 Behat 时，它会卡住而没有任何消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-30T11:21:48.903

Solved this myself. I have create two methods. I call the first one before running my BDD tests and the second one after I ran the tests:

```
private function _startDevelopmentServer($pidfile)
{
    $cmd = 'cd ../../public && php -S 127.0.0.1:8027 index.php';
    $outputfile = '/dev/null';
    shell_exec(sprintf("%s > %s 2>&1 & echo $! >> %s", $cmd, $outputfile, $pidfile));
    sleep(1);
}

private function _killDevelopmentServer($pidfile)
{
    if (file_exists($pidfile)) {
        $pids = file($pidfile);
        foreach ($pids as $pid) {
            shell_exec('kill -9 ' . $pid);
        }
        unlink($pidfile);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T11:04:10.913

只需将服务器作为构建过程的一部分启动即可。创建一个 ant 任务，它将在运行 behat 之前启动服务器，并在 behat 完成后将其杀死。

我已经成功地使用这种方法来启动和停止 selenium 服务器。

# c# - 从数据库中读取数据并显示在一个txt文件中

> ID：13072797
> 
> 赞同：0
> 
> 时间：2012-10-25T16:11:51.830
> 
> 标签：c#, asp.net, sql-server-2005

我有一个在 SQL Server 2005 中制作的表，其中包含以下列：

```
Fname (char (50)),
MailFrom (char (50)),
MailTo (char (50)),
Subject (char (50)),
MBody (char (100)),
MailID (int) 
```

在表格中输入行后，我想将它们提取并存储在文本文件/文档文件/窗口表单中，每列都有文本字段。

获得从数据库中提取数据并将其保存在文件中的最佳方法的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T16:14:48.050

```
using (SqlConnection conn = new SqlConnection(connectionString))
{
    SqlCommand com = new SqlCommand("Select * from mytable", conn);
    DataReader reader = com.ExecuteReader();

    using (TextWriter writer = new TextWriter("myFile.txt"))
    {
        while (reader.Read())
        {
            StringBuilder myData = new StringBuilder();
            myData.Append(reader["Fname"].ToString();
            //etc - see how you want to format it

            writer.WriteLine(myData.ToString());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-27T10:52:38.797

第一个解决方案：如果您只想使用 sql sever，则需要使用 bcp 命令。

您需要了解 bcp 的一些事实：

1.  默认情况下，它连接到默认的 sql 实例，因此如果盒子上有多个 sql server 实例并且您希望从其他实例获取数据，则需要指定 server。
2.  如果您使用存储过程来检索数据，则不能在其中使用临时表，只能使用变量表。
3.  输出将以 UTF 16 格式输出，遗憾的是无法以 UTF 8 格式输出。

在这里您可以获得有关 bcp 的更多信息：http: [//msdn.microsoft.com/en-us/library/ms162802 (v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms162802(v=sql.90).aspx)

```
 ....

    SET @SQLQuery='bcp "EXEC storedprocedure  " queryout C:\SomeFolder\'+@FileName+ ' -w -r " " -t -T -C1252 -S '+@ServerName
    PRINT @SQLQuery

    EXEC @RC = master..xp_cmdShell @SQLQuery

    .... 
```

第二种解决方案是使用 SSIS 包将其导出到文件中。

您将需要使用 DataFlowTask 并使用数据库源和平面文件目标。

SQL 2008 R2 的示例在这里，但我相信 2005 应该不会有太大不同：

[http://www.kodyaz.com/ssis/export-to-text-file-using-ssis-package.aspx](http://www.kodyaz.com/ssis/export-to-text-file-using-ssis-package.aspx)

Haedrian 建议使用编程语言的第三个解决方案。

# ftp - 使用 MS DOS 循环浏览 FTP 中的文件

> ID：13072798
> 
> 赞同：0
> 
> 时间：2012-10-25T16:11:56.457
> 
> 标签：ftp, dos

有没有办法从 MS DOS 循环浏览 FTP 中的文件？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-10T15:27:21.920

我使用的技术是有两个 FTP 脚本。我用它来捕获 DIR 命令的输出。捕获 DIR 后，我将其解析为要下载的文件的名称。然后我使用第二个脚本和第一个脚本的信息来下载文件。

# android - 如何在 SherlockPreference 活动屏幕中使用 Holo.Light 主题

> ID：13072799
> 
> 赞同：0
> 
> 时间：2012-10-25T16:11:56.460
> 
> 标签：android, actionbarsherlock, preferenceactivity

我试图让我的对话框在我的偏好屏幕中使用 Holo.Light 主题。我也在使用 ActionBarSherlock。任何想法如何做到这一点？

这是我的一些xml：

```
<ListPreference
    android:defaultValue="@string/default_metric"
    android:entries="@array/pref_wind_speed"
    android:entryValues="@array/pref_wind_speed_values"
    android:key="pref_wind_speed"
    android:title="@string/speed" />
<ListPreference
    android:defaultValue="@string/default_metric"
    android:entries="@array/pref_wind_direction"
    android:entryValues="@array/pref_wind_direction_values"
    android:key="pref_wind_direction"
    android:title="@string/wind_direction" />
<ListPreference
    android:defaultValue="@string/default_metric"
    android:entries="@array/pref_wind_direction"
    android:entryValues="@array/pref_wind_direction_values"
    android:key="pref_wind_direction"
    android:title="@string/wind_direction" /> 
```

...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T15:53:26.413

我不确定 ABS 是否有轻量级的 AlertDialog 主题供您使用。[不过， HoloEverywhere](https://github.com/ChristopheVersieux/HoloEverywhere)确实如此。

使用 HoloEverywhere 时，只需将这些添加到您的主题中：

```
<item name="android:alertDialogStyle">@style/Holo.AlertDialog.Light</item>
<item name="android:alertDialogTheme">@style/Holo.Theme.Dialog.Alert.Light</item>

<item name="alertDialogStyle">@style/Holo.AlertDialog.Light</item>
<item name="alertDialogTheme">@style/Holo.Theme.Dialog.Alert.Light</item> 
```

如果不使用 HoloEverywhere，您可以在此处找到这些声明：[https ://github.com/ChristopheVersieux/HoloEverywhere/blob/master/library/res/values/styles.xml](https://github.com/ChristopheVersieux/HoloEverywhere/blob/master/library/res/values/styles.xml)

# c# - 声明 DataContract 命名空间时，WCF DataMember 显示默认命名空间

> ID：13072804
> 
> 赞同：1
> 
> 时间：2012-10-25T16:12:09.300
> 
> 标签：c#, .net, wcf, .net-4.0

只是想首先感谢社区以前的帮助。我有一个关于 WCF 中默认命名空间的新问题。我已经为我的 DataContract 明确设置了一个命名空间，如下所示：

```
[DataContract(Namespace="http://www.mydomain.com")] 
```

我在 DataContract 下的一个 DataMembers 是一个派生自我项目中的引用的类

```
[DataMember]
public MyClass MyClassName 
```

我的问题是我得到了这个 DataMember 的默认命名空间：

```
http://schemas.datacontract.org/2004/07/MyClass 
```

我希望它属于 DataContract 的命名空间。我怎样才能改变这个

# ruby-on-rails - 通过 has_many 和 multiple 关联

> ID：13072805
> 
> 赞同：0
> 
> 时间：2012-10-25T16:12:19.270
> 
> 标签：ruby-on-rails, ruby, database, associations

我有以下模型和关联：

```
class User < ActiveRecord::Base   
    has_and_belongs_to_many :songs
end

class Song < ActiveRecord::Base 
    has_and_belongs_to_many :users
    belongs_to :album
    delegate :artist, :to => :album, :allow_nil => true
end

class Album < ActiveRecord::Base
    has_many :songs
    belongs_to :artist
end

class Artist < ActiveRecord::Base
    has_many :albums
    has_many :songs, :through => :albums
end 
```

我需要能够定期调用 user.albums 和 user.artists。在 User 和 Artist/Album 之间创建 has_and_belongs_to_many 关联是最有效的选择吗？

似乎应该有更好的方法，但我还没有找到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:32:59.823

您可以在用户对象上使用 has_many :albums, :through => :songs 。Arel(AR) 将自动为您创建连接，从而产生一个查询，并且只会获取与属于用户的歌曲相关的专辑。User 对象上的艺术家也是如此。

# ruby-on-rails - Rails：从带有参数的前置过滤器调用函数

> ID：13072808
> 
> 赞同：0
> 
> 时间：2012-10-25T16:12:36.347
> 
> 标签：ruby-on-rails, before-filter

我正在尝试使用 before 过滤器来防止未经批准的用户访问页面。

为了检查未经批准的用户，我在 /lib 文件夹中的 .rb 文件中定义了一个方法（我有几个方法，我在各种控制器和视图中）。方法是 check_user_for_current_approval(user_id)。

在我的控制器中，我尝试了以下变体（请注意，我使用 RubyMine 作为 IDE，它并没有提示我有语法错误）：

```
before_filter(:only => [:new]) do |c|
    c.check_user_for_current_approval current_user.id
end 
```

这给了我以下错误消息：

```
NoMethodError in PaymentsController#new

private method `check_user_for_current_approval' called for #<PaymentsController:0x007ff06784f148> 
```

以下语法：

```
before_filter(:only => [:new]) do |c|
    c.send (:check_user_for_current_approval, current_user.id)
end 
```

产生此错误：

```
SyntaxError in PaymentsController#new

/app/controllers/payments_controller.rb:9: syntax error, unexpected ',', expecting ')'
c.send (:check_user_for_current_approval, current_user.id)
                                         ^
/app/controllers/payments_controller.rb:9: syntax error, unexpected ')', expecting keyword_end
/app/controllers/payments_controller.rb:130: syntax error, unexpected $end, expecting keyword_end 
```

使用此语法：

```
before_filter(:only => [:new]) { check_user_for_current_approval(current_user.id) } 
```

将我直接带到页面（过滤器无效）。不同的陈述来自我在 StackOverflow 上看到的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:23:25.830

使用您的第一种方法，但要`check_user_for_current_approval`公开。

还：

我认为共享`before_filter`将更适合应用程序控制器，而不是 lib 文件。这将使扩展应用程序控制器的所有控制器都可以访问它，通常所有其他控制器都会这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:22:20.353

为什么不用符号来定义要调用的方法呢？

例如支付控制器：

```
before_filter :check_user_for_current_approval, :only => :new

def check_user_for_current_approval; raise "Called"; end 
```

# drupal - 带有节点链接的 Drupal 搜索

> ID：13072811
> 
> 赞同：0
> 
> 时间：2012-10-25T16:12:42.697
> 
> 标签：drupal, search, module

我在我的网站上安装了 drupal，并且启用了搜索模块。但是，当我搜索关键术语时，它会显示带有关键字的节点，但没有指向返回的节点的链接。

如何提供返回结果的链接？我希望他们能够搜索一个节点，然后单击结果以查看该特定节点，但我找不到这样做的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T12:47:20.347

`search-result.tpl.php`用于显示单个搜索结果的默认主题实现。

# php - 在 PHP 中动态导航到页面的最佳方式是什么？

> ID：13072812
> 
> 赞同：0
> 
> 时间：2012-10-25T16:12:42.553
> 
> 标签：php

例如，我有一个表格。根据表单的答案，我想在提交后将它们带到我网站上的不同页面。假设表单的 action 属性是 submit.php，这就是我的想法：

在 submit.php 中，根据表单的答案执行脚本需要执行的操作，然后通过在 php 中设置 header 来指导它们。

我问这个问题是因为我听到很多人说你不应该使用标题来反弹人们。

那么，如果不是我的解决方案，那么最好的方法是什么，反对使用 header('location:'); 的论点是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:17:02.810

我不知道有任何反对`header()`在 PHP 中使用 -redirects 的论据。只要确保你不要夸大并从一个重定向重定向到另一个重定向......</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:18:08.390

发送 Location 标头正是您应该做的。执行以下操作并没有错：

```
header('Location: http://www.site.com/?answer=' . rawurlencode($_POST['answer'])); 
```

*除了输入验证，这是另一个讨论的主题。*

# javascript - jQuery偏移，将元素定位在另一个元素下，其中右边框接触对齐的元素

> ID：13072815
> 
> 赞同：0
> 
> 时间：2012-10-25T16:12:49.437
> 
> 标签：javascript, jquery, dom

好的，这个主题并不是我想要解决的整体需求。所以我有这个在给定元素上调用的函数，它是触发元素旁边的隐藏子菜单。页面呈现的方式，并保持样式优化，我不能只通过 css 设置位置样式。所以我需要 javascript/jquerys 帮助。

有了这个，我想出了一个可以根据需要重用的功能，并且可以正常工作。然而，我的关键问题是，我有几种情况，其中子菜单将`<section>`与其所在元素的边缘重叠。元素溢出设置为隐藏，并且它也距离页面底部大约 30 像素。总而言之，子菜单元素被隐藏了一点，要么在元素中途完全掉出页面视图，要么被部分标签溢出状态隐藏。

接着就，随即。在发生这种情况的情况下，我不想让元素与触发元素的底部对齐，而是让它与顶部对齐，以便在这种情况下菜单位于触发元素上方而不是下方。

问题是我不确定如何弥补这一点。

这是我想出的功能来做我需要的事情，现在我只需要一些帮助，可以说是在菜单元素从页面上掉下来时捕捉到，所以我可以在它发生时进行调整。

```
function openSubOrgMenu(triggerID, elem)
{
    orgSubOpenID = triggerID;
    orgSubShowing = true;

    elemOffset = elem.offset(); //trigger element
    elemWidth = elem.width();
    elemHeight = elem.height();

    elemWrap = elem.siblings('.org_group_wrapper');//menu element
    elemWrapWidth = elemWrap.width();
    elemWrapHeight = elemWrap.height();

    moveTop = elemHeight + elemOffset.top + 4;
    moveLeft = elemOffset.left - (elemWrapWidth-elemWidth-15);

    elemWrap.show().offset({top:moveTop, left:moveLeft});
} 
```

那么这里是一个 JS Fiddle，不一定显示我想要的工作逻辑，但当它是页面/部分底部的元素时展示所需的效果：http: [//jsfiddle.net/4zwEr/](http://jsfiddle.net/4zwEr/)

# c# - .NET 程序集加载

> ID：13072818
> 
> 赞同：1
> 
> 时间：2012-10-25T16:12:54.463
> 
> 标签：c#, .net, wpf, assemblies

我想通过在初始屏幕后面加载我的应用程序逻辑程序集来制作 WPF 应用程序，例如带有进度条的 NetBeans IDE。我知道我的应用程序很小并且没有任何意义，但是如果可以在 .NET 中完成，我想做这样的事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:18:47.920

看看[http://msdn.microsoft.com/en-us/library/cc656886.aspx](http://msdn.microsoft.com/en-us/library/cc656886.aspx)

这确实允许 .NET 运行时在加载程序集时显示静态初始屏幕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:21:45.843

是的，我同意“fsimonazzi”的想法。但是，如果您认为您需要与前端启动屏幕加载同步执行很多长流程以显示流程进度和更酷的东西，您可以使用以下文章作为参考来做到这一点：[WPF 中的启动屏幕使用自定义应用程序启动升级班](http://www.jsinh.in/2012/04/how-to-create-animated-splash-screen-using-custom-application-startup-class-in-wpf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-19T21:36:09.920

为了显示程序集加载进度信息，我们首先确定哪些程序集没有被加载。因此，我们需要知道将加载到 AppDomain 的程序集的完整列表（来自引用的程序集），并将它们与已加载的程序集进行比较。

```
AppDomain.CurrentDomain.GetAssemblies() 
```

比我们可以强制加载错过的程序集并显示进度信息。

```
foreach (AssemblyName assembly in assembliesToLoad)
{
    ShowAssemblyLoadingInformation(assembly);

    AppDomain.CurrentDomain.Load(assembly);

    ReportProgress();
} 
```

# sql - 根据另一行中的值查找一组相关记录中的第一个

> ID：13072834
> 
> 赞同：-1
> 
> 时间：2012-10-25T16:13:53.213
> 
> 标签：sql

我有一个表，其中一行表示较大数据块的一个子部分。

给定一个标识这些行之一的输入参数，我想返回一个代表根记录的不同行。

具体来说，我想检索该集合中的第一条记录。

例如：

1.  查找列 X 值为 Y 的行。
2.  获取 Z 列的值 A。
3.  返回 Z 列值为 A 的第一行。

这样做的最佳方法是什么？

*   原始表上的两个单独的查询？
*   对原始表的单个查询？
*   构建一个启用单个查询的新视图？
*   还有什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:22:50.970

如果您不按某列对行进行排序，您可以获得相同的行，但一般答案是

```
select top 1 *
from table
where Z = (select Z from table where X = @parameter)
order by ??? 
```

# c++ - wxWidgets：显示在 XRC 中标记为隐藏的窗口

> ID：13072836
> 
> 赞同：1
> 
> 时间：2012-10-25T16:14:07.317
> 
> 标签：c++, wxwidgets, xrc

我是`wxWidgets`和的新手`DialogBlocks`。我有一个使用 DialogBlocks 创建并保存为 XRC 文件的表单。表单的一部分有一个垂直方向`wxStaticBoxSizer`，其中放置了两个`wxScrolledWindow`元素。我想根据要向用户显示的数据一次只显示一个，因此我将一个标记为隐藏，而将另一个标记为可见。当我尝试切换显示并显示隐藏在 XRC 中的小部件并隐藏未隐藏的小部件时，我隐藏的小部件消失得很好，但我想要显示的小部件不可见。但是，如果我调整窗口大小，它会出现。一旦它出现，我就可以毫无问题地来回切换。我尝试了许多显示、启用、无效、获取大小和调用的组合`RecalcSizes`、刷新、布局等。我也尝试了不同的组合。简单地调用`Show`将允许我在两者之间切换，但只有在我切换到最初不显示的那个并调整窗口大小之后。从我在文档中看到的。问题是它`wxSizer`没有为隐藏窗口分配空间，但是可以设置一个标志来覆盖该行为。我的问题是 DialogBlocks 没有公开该功能，因此如果我手动编辑 XRC 文件，当我或其他开发人员之一保存一些更改时，修改将丢失。我可以进行一系列调用来告诉 sizer 分配空间吗？默认`OnResize`处理程序会执行某些操作以使 sizer 分配空间，但我不知道那是什么，也不知道该怎么做。

这是我在文档中找到的标志：

> wxRESERVE_SPACE_EVEN_IF_HIDDEN 通常 wxSizer 不会为隐藏窗口或其他项目分配空间。此标志覆盖此行为，以便为窗口分配足够的空间，即使它不可见。例如，这使得动态显示和隐藏控件成为可能，而无需调整父对话框的大小。此功能是 wxWidgets 2.8.8 版本以来的新功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T22:55:48.880

不幸的是，DialogBlocks 确实不允许您指定此标志。没有它，您需要`Layout()`在显示以前隐藏的控件后调用。这将起作用，前提是您在具有足够空间的父级上调用它以容纳现在需要更多空间的子级（例如，在顶级父级上调用它总是有效），但会导致控件明显转移，这可能不是您所需要的想。

# php - php正则表达式验证生日

> ID：13072846
> 
> 赞同：0
> 
> 时间：2012-10-25T16:14:39.237
> 
> 标签：php, regex, preg-match

我很难弄清楚如何`preg_match`在 php 中执行以下操作。我有一个 HTML 表单，用户可以在其中按日、月和年输入他或她的生日。

我如何验证下一天：确保它是 1 到 31 之间的数字，实际上是 01 到 31 月：确保它是 1 到 12 之间的数字，实际上是 01 到 12 年：确保它是 1800 到 1800 之间的数字2012 年，实际上介于 1800 和 2012 年之间

```
if (preg_match( ????? )) {
     echo " SUCCESS";
} else { 
     echo " ERROR";
} 
```

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:19:52.213

Checkdate 需要 3 个不同的参数，使用 preg_match 验证一个输入，使用模式：

```
(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.]((?|19|20)\d\d) 
```

它以 dd-mm-yyy 和 dd.mm.yyyy 和 dd/mm/yyyy 样式验证正确的日期，如果需要，它还会解析每个参数的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:19:04.880

你可以通过[`checkdate()`](http://php.net/manual/en/function.checkdate.php)功能做到这一点

# iphone - 等待 UIAlertView 按钮

> ID：13072851
> 
> 赞同：1
> 
> 时间：2012-10-25T16:14:58.490
> 
> 标签：iphone, objective-c, location, uialertview, wait

我的应用程序中有此代码：

```
if (self.uiSwtichState == TRUE)
        {
            if ([CLLocationManager locationServicesEnabled])
            {
                [self.textString stringByAppendingString:[[[SMSLocationModel alloc] init] getLocation]];

            }
        }
            MFMessageComposeViewController *sms = [[MFMessageComposeViewController alloc] init];
sms.messageComposeDelegate = self;
sms.body = self.textString;
sms.recipients = self.arrayOfNumbers;
[self presentModalViewController:sms animated:YES]; 
```

这段代码被放入一个名为“send”的方法中。可以想象，**getLocation**方法获取当前用户位置，并且在应用程序第一次运行时，屏幕上会出现一个 UIAlertView，询问用户是否允许应用程序获取他的位置。问题是当这个 UIAlertView 出现时，她立即被短信 Vie 控制器 (MFMessageComposeViewController) 取代，这样用户就没有足够的时间在 UIAlertView 中回答“是”或“否”。

有一种方法可以等待用户按下 UIAlertView 中的按钮然后呈现 ModalViewController？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:19:48.927

您可以使用 CLLocationManagers 委托方法等到授权状态​​更改。如果您无权使用位置服务，请将 sms viewController 保存到实例变量中。然后请位置经理授权您。如果授权状态发生更改，则显示该视图控制器。

```
// somewhere else
self.locationManager.delegate = self;

- (void)locationManager:(CLLocationManager *)manager didChangeAuthorizationStatus:(CLAuthorizationStatus)status {
    NSLog(@"New Authorization State: %d", status);
    if (self.viewControllerToPresentAfterLocationDidChange) {
        if (status == kCLAuthorizationStatusAuthorized) {
            // set location of viewController
            [self presentViewController:self.viewControllerToPresentAfterLocationDidChange animated:YES completion:NULL];
        }
        else {
            // user did not authorize you to use location services
        }
        self.viewControllerToPresentAfterLocationDidChange = nil;
    }
}

- (IBAction)buttonPressed:(id)sender {
    UIViewController *vc = [[UIViewController alloc] init];
    if ([CLLocationManager authorizationStatus] == kCLAuthorizationStatusAuthorized) {
        // authorized already, no alert will appear.

        // set location of vc
        [self presentViewController:vc animated:YES completion:NULL];
    }
    else if ([CLLocationManager authorizationStatus] == kCLAuthorizationStatusNotDetermined){
        self.viewControllerToPresentAfterLocationDidChange = vc;
        // access location so alert will show
    }
    else {
        // not authorized or restricted.
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T17:44:17.377

也许你可以使用这个委托：

```
- (void)didPresentAlertView:(UIAlertView *)alertView{
} 
```

例如，初始化一个布尔值，它可以防止显示这个模态视图控制器。然后，如果关闭，则更改布尔值以允许呈现此视图控制器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-25T16:19:34.167

是的，您可以实施`AlertViewDelegate`.
有关详细信息，请参阅[UIAlertViewDelegate 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAlertViewDelegate_Protocol/UIAlertViewDelegate/UIAlertViewDelegate.html)。

然后您可以使用该`alertView:clickedButtonAtIndex:`方法并`MessageComposer`在用户单击警报视图时显示您的。

# php - 数组在 foreach 中丢失值

> ID：13072853
> 
> 赞同：1
> 
> 时间：2012-10-25T16:15:14.273
> 
> 标签：php, arrays, codeigniter

这让我很难过。我可以 print_r 调用的数组`$item_pages`，它会正确输出所有键和值。但是，一旦在 foreach 中使用了该数组，它似乎就变成了空的。这是我在 foreach 之外 print_r 时的数组：

```
Array ( [0] => 1 [1] => 6 [2] => 12 [3] => 15 [4] => 16 [5] => 17 [6] => 18 [7] => 19 [8] => 78 [9] => 79 [10] => 87 [11] => 90 [12] => 94 [13] => 95 [14] => 98 [15] => 99 [16] => 102 [17] => 103 [18] => 105 [19] => 107 [20] => 108 [21] => 110 [22] => 111 [23] => 112 [24] => 113 [25] => 114 [26] => 119 [27] => 120 [28] => 121 [29] => 125 [30] => 126 [31] => 134 [32] => 135 [33] => 136 [34] => 138 [35] => 142 [36] => 186 [37] => 193 [38] => 197 [39] => 198 [40] => 199 [41] => 206 [42] => 327 [43] => 452 [44] => 470 [45] => 487 [46] => 601 [47] => 614 [48] => 630 [49] => 684 [50] => 726 [51] => 727 [52] => 789 [53] => 871 ) 
```

这是控制器：

```
 public function view_item_pages() {

    if ($this->input->is_ajax_request()) {

      $item_id = $this->input->post('item_id');
      $this->data['item_id'] = $item_id;
      $this->data['pages'] = $this->affiliate_model->get_all_affiliates();
      $this->data['item_pages'] = $this->item_model->get_item_pages($item_id);

      $this->load->view('/admin/item/pages', $this->data);

    }

  } 
```

这是视图：

```
<fieldset>
    <table id="all-pages" class="table table-striped table-bordered">
        <thead>
          <tr>
            <th><input type="checkbox" class="checkbox" id="select_all"></th>
            <th>ID</th>
            <th>Name</th>
          </tr>
        </thead>
        <tbody>

        <?php foreach ($pages as $page): 

            $checked = FALSE;

            if (!empty($item_pages)) {
                if (in_array($page['aff_id'], $item_pages)) {
                    $checked = TRUE;
                }
            }
        ?>
              <tr>
                <td><?php echo form_checkbox('page', $page['aff_id'], $checked); ?></td>
                <td><?php echo $page['aff_id']; ?></td>
                <td><?php echo $page['name']; ?></td>
              </tr>

        <?php endforeach; ?>

        </tbody>
    </table>
</fieldset> 
```

因此，如果我执行以下操作，该数组将起作用：

```
 <?php print_r($item_pages); ?>

    <?php foreach ($pages as $page):

        $checked = FALSE;

        if (!empty($item_pages)) {
            if (in_array($page['aff_id'], $item_pages)) {
                $checked = TRUE;
            }
        }
    ?> 
```

如果我这样做，它不会返回任何东西，就像这样做`echo '';`：

```
 <?php foreach ($pages as $page):

        print_r($item_pages);

        $checked = FALSE;

        if (!empty($item_pages)) {
            if (in_array($page['aff_id'], $item_pages)) {
                $checked = TRUE;
            }
        }
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:21:14.537

在您的控制器中打印`$pages`。如果`$pages`为空，则执行不会进入`foreach`视图内的循环。

```
$this->data['pages'] = $this->affiliate_model->get_all_affiliates();
print_r($this->data['pages']); 
```

# java - 在android中删除SQLite数据库中的条目

> ID：13072854
> 
> 赞同：3
> 
> 时间：2012-10-25T16:15:15.490
> 
> 标签：java, android, database, eclipse, sqlite

我的名字是迈克尔，我正在编写一个 android 应用程序，它将作为一个非常基本的课程安排应用程序。到目前为止，我已经能够编写程序，以便能够创建新类并将其添加到数据库中，但是我似乎无法弄清楚如何从数据库中删除选定的条目。保存条目的按钮定义如下：

```
<Button
        android:id="@+id/save"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Save" /> 
```

它激活的监听器是：

```
private View.OnClickListener onSave=new View.OnClickListener() {
        public void onClick(View v) {
            String type=null;

            switch (types.getCheckedRadioButtonId()) {
                case R.id.math:
                    type="math";
                    break;
                case R.id.cs:
                    type="cs";
                    break;
                case R.id.pe:
                    type="pe";
                    break;
                case R.id.elective:
                    type="elective";
                    break;
            }

            if (restaurantId==null) {
                helper.insert(name.getText().toString(),
                                            address.getText().toString(), type,
                                            notes.getText().toString());
            }
            else {
                helper.update(restaurantId, name.getText().toString(),
                                            address.getText().toString(), type,
                                            notes.getText().toString());
            }

            finish();
        }
    }; 
```

'insert()' 方法是我的助手类中添加条目的函数。

具体问题是我在帮助类中编写“remove()”函数时遇到了麻烦。我曾尝试使用 getWritableDatabase.delete() 函数，但是找不到正确的参数。朝着正确方向的任何一点都会对我有很大帮助。先感谢您。

如果它有帮助，这就是 insert() 函数：

```
public void insert(String name, String address,
            String type, String notes) {
        ContentValues cv=new ContentValues();

        cv.put("name", name);
        cv.put("address", address);
        cv.put("type", type);
        cv.put("notes", notes);

        getWritableDatabase().insert("restaurants", "name", cv);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:31:19.117

你对这样的事情感兴趣吗？

```
public void deleteValue(String value)
    {
         SQLiteDatabase db = getWritableDatabase();

         String whereClause = "name"+"=?";
         String[]whereArgs = new String[] {String.valueOf(value)};
          db.delete(TABLE_NAME, whereClause, whereArgs);
          db.close();
          Log.v("done","deleted  row ");
    } 
```

这里 deleteValue() 的参数值是我们愿意删除行的基础（如根据名称删除行），因此我们将其用作 where 子句。

看线

```
String whereClause = "name"+"=?";
             String[]whereArgs = new String[] {String.valueOf(value)}; 
```

这可以假设为带有 where 子句的 delete 语句`where name = value;`

# entity-framework - 您如何使用 moq 模拟将项目添加到存储库或 DbContext？

> ID：13072860
> 
> 赞同：1
> 
> 时间：2012-10-25T16:15:23.960
> 
> 标签：entity-framework, unit-testing, moq

我看到的将 moq 用于存储库的示例仅显示了如何模拟返回的内容。我有一个有点奇怪的要求：执行查询时，如果存在条件，则应该将某个项目添加到存储库中。我想知道如何在不查询数据库的情况下进行测试。我知道如何模拟现有的条件，但是如何设置模拟以便测试是否添加了某个项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:22:03.427

您不会模拟存储库；您将拥有一个备用存储库，该存储库将使用内存存储而不是数据库，然后使用 IoC 为测试/代码选择正确的存储库实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:58:22.190

尝试在内存存储库中使用 fake 而不是 moq，例如所有实体的通用通用存储库：

```
public interface IInMemoryRepository<T> where T : class
{
    IQueryable<T> GetAll();
    void Create(T item);
    void Update(T item);
    T GetItem(Expression<Func<T, bool>> expression);
    void Delete(T item);
}

public class InMemoryRepository<T> : IInMemoryRepository<T> where T : class
{
    private int _incrementer = 0;
    public Dictionary<int, T> List = new Dictionary<int, T>();

    public IQueryable<T> GetAll()
    {
        return List.Select(x => x.Value).AsQueryable();
    }

    public void Create(T item)
    {
        _incrementer++;
        item.GetType().GetProperties().First(p => p.Name == "Id").SetValue(item, _incrementer, null);
        List.Add(_incrementer, item);
    }

    public void Update(T item)
    {
        var key = (int)item.GetType().GetProperties().First(p => p.Name == "Id").GetValue(item, null);
        List[key] = item;
    }

    public T GetItem(Expression<Func<T, bool>> expression)
    {
        return List.Select(x => x.Value).SingleOrDefault(expression.Compile());
    }

    public void Delete(T item)
    {
        var key = (int)item.GetType().GetProperties().First(p => p.Name == "Id").GetValue(item, null);
        List.Remove(key);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T13:45:16.100

[这篇博客文章可能有用](http://www.tigranetworks.co.uk/blogs/electricdreams/grokking-the-repository-and-unit-of-work-patterns/)，尽管自从我写这篇文章后我的设计发生了一些变化，我真的需要更新它。我以一种能够模拟 DbContext 的方式使用了通用存储库模式。这允许“直到边缘”对数据访问层进行测试。 ![通用存储库和工作单元](../Images/a628aa1b5e69939a153e9807992ba906.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-29T14:53:33.953

时代变了——自从[Entity Framework 6](https://docs.microsoft.com/en-us/ef/ef6/)发布以来，模拟数据库上下文和数据集变得更加容易。 [这篇文章概述了细节](https://msdn.microsoft.com/en-us/data/dn314429.aspx)。

**测试非查询场景**

```
using Microsoft.VisualStudio.TestTools.UnitTesting; 
using Moq; 
using System.Data.Entity; 

namespace TestingDemo 
{ 
    [TestClass] 
    public class NonQueryTests 
    { 
        [TestMethod] 
        public void CreateBlog_saves_a_blog_via_context() 
        { 
            var mockSet = new Mock<DbSet<Blog>>(); 

            var mockContext = new Mock<BloggingContext>(); 
            mockContext.Setup(m => m.Blogs).Returns(mockSet.Object); 

            var service = new BlogService(mockContext.Object); 
            service.AddBlog("ADO.NET Blog", "http://blogs.msdn.com/adonet"); 

            mockSet.Verify(m => m.Add(It.IsAny<Blog>()), Times.Once()); 
            mockContext.Verify(m => m.SaveChanges(), Times.Once()); 
        } 
    } 
} 
```

**测试查询场景** 查询测试现在非常好，因为您可以在代码中构建测试数据集，然后针对它们执行测试：

```
using Microsoft.VisualStudio.TestTools.UnitTesting; 
using Moq; 
using System.Collections.Generic; 
using System.Data.Entity; 
using System.Linq; 

namespace TestingDemo 
{ 
    [TestClass] 
    public class QueryTests 
    { 
        [TestMethod] 
        public void GetAllBlogs_orders_by_name() 
        { 
            var data = new List<Blog> 
            { 
                new Blog { Name = "BBB" }, 
                new Blog { Name = "ZZZ" }, 
                new Blog { Name = "AAA" }, 
            }.AsQueryable(); 

            var mockSet = new Mock<DbSet<Blog>>(); 
            mockSet.As<IQueryable<Blog>>().Setup(m => m.Provider).Returns(data.Provider); 
            mockSet.As<IQueryable<Blog>>().Setup(m => m.Expression).Returns(data.Expression); 
            mockSet.As<IQueryable<Blog>>().Setup(m => m.ElementType).Returns(data.ElementType); 
            mockSet.As<IQueryable<Blog>>().Setup(m => m.GetEnumerator()).Returns(0 => data.GetEnumerator()); 

            var mockContext = new Mock<BloggingContext>(); 
            mockContext.Setup(c => c.Blogs).Returns(mockSet.Object); 

            var service = new BlogService(mockContext.Object); 
            var blogs = service.GetAllBlogs(); 

            Assert.AreEqual(3, blogs.Count); 
            Assert.AreEqual("AAA", blogs[0].Name); 
            Assert.AreEqual("BBB", blogs[1].Name); 
            Assert.AreEqual("ZZZ", blogs[2].Name); 
        } 
    } 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-21T01:39:31.083

您可以通过模拟该`DbSet.Add()`方法来做到这一点，如下所示：

```
[Fact]
public void CreateBlog_saves_a_blog_via_context()
{
  var data = new List<Blog>
  {
    new Blog { Name = "BBB" },
    new Blog { Name = "ZZZ" },
    new Blog { Name = "AAA" },
  };

  var mockSet = new Mock<DbSet<Blog>>();
  mockSet.Setup(blogs => blogs.Add(It.IsAny<Blog>)).Returns<Blog>(blog =>
  {
    data.Add(blog);
    return blog;
  });

  var mockContext = new Mock<BloggingContext>();
  mockContext.Setup(m => m.Blogs).Returns(mockSet.Object);

  var service = new BlogService(mockContext.Object);
  var blog = service.AddBlog("_ADO.NET Blog", "http://blogs.msdn.com/adonet");
  var blogs = service.GetAllBlogs();

  mockSet.Verify(m => m.Add(It.IsAny<Blog>()), Times.Once());
  mockContext.Verify(m => m.SaveChanges(), Times.Once());

  Assert.NotNull(blog)
  Assert.Equal(4, blogs.Count);
  Assert.Equal("AAA", blogs(1).Name);
  Assert.Equal("BBB", blogs(2).Name);
  Assert.Equal("ZZZ", blogs(3).Name);
} 
```

这改编自[此处](https://docs.microsoft.com/en-us/ef/ef6/fundamentals/testing/mocking)找到的文档。

# c# - 将裸空文字与用户定义的运算符一起使用时的奇怪重载解决方案

> ID：13072864
> 
> 赞同：5
> 
> 时间：2012-10-25T16:15:31.837
> 
> 标签：c#, null, operator-overloading, overload-resolution, lifted-operators

（标题中的“用户定义”是指加减法`TimeSpan`和`DateTime`不是C#标准的一部分。它们在BCL中定义。）

在可空值`TimeSpan`和`DateTime`值上使用提升运算符，我编写了以下代码。请注意，该框架在`TimeSpan`和上提供了不同的操作`DateTime`。

有一个对称的（和可交换的）加法，你取两个`TimeSpan`并返回 sum `TimeSpan`。这种加法的“逆”是两个相减`TimeSpan`得到 a `TimeSpan`。

然后是另一种加法，不对称，你需要一个`DateTime`（左操作数）和一个`TimeSpan`（右操作数）来产生一个`DateTime`. 由于此操作的不对称性，它有两种“逆”：一种是您将两个相减`DateTime`以获得`TimeSpan`差异，另一种是您有一个`DateTime`并从中减去一个`TimeSpan`以产生结果`DateTime`。

```
static void Main()
{
  DateTime? n_dt = new DateTime(2012, 12, 25);
  TimeSpan? n_ts = TimeSpan.FromDays(62.0);

  var a = n_dt + n_ts;   // OK
  var b = n_ts + n_ts;   // OK

  var c = null + n_dt;   // OK, string concatenation! Type of expression is String
  var d = null + n_ts;   // OK, compiler prefers TS+TS, not DT+TS
  var e = n_dt + null;   // OK, DT+TS
  var f = n_ts + null;   // OK, TS+TS
  var g = null + null;   // error, type of expression is undetermined

  var h = n_dt - n_dt;   // OK
  var i = n_dt - n_ts;   // OK
  var j = n_ts - n_ts;   // OK

  var k = null - n_dt;   // OK, DT-DT
  var l = null - n_ts;   // compiler prefers TS-TS, not DT-TS
  var m = n_dt - null;   // error, compiler won't choose between DT-DT amd DT-TS, type of expression is undetermined
  var n = n_ts - null;   // OK, TS-TS
  var o = null - null;   // OK, integer subtraction! Type of expression is Nullable<Int32>

  // illegal:
//var p = n_dt + n_dt;
//var q = n_ts + n_dt;
//var r = n_ts - n_dt;
} 
```

有些问题自然而然地出现。

`o`允许并给出一个`int?`（为什么不是`long?`顺便说一句？）虽然是不允许的，这有点奇怪`g`。这在规范中吗？`c`此外，通过字符串连接解决“不可能”有点奇怪。显然编译器决定`null`in`c`是一个`(string)null`. 另一方面，将显式类型的表达式添加`object`到 a将不会编译。`DateTime`

但我的主要问题是：**为什么编译器可以为`d`and选择重载`l`，但`m`它抱怨歧义？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:15:31.837

原因似乎是，`m`两个可能的操作被**定义**在同一个类型中，即`System.DateTime`。没有办法在它们之间做出选择。

另一方面，使用`d`和`l`，一个操作定义在 中，另一个操作定义`System.TimeSpan`在 中`System.DateTime`。但是在 and 的行中`d`，`l`我们看到了，但是在and的分配中`TimeSpan`没有提到任何类型。然后编译器似乎只搜索 type 中定义的运算符，而忘记搜索所有其他类型中定义的用户定义运算符（顺便说一句，要搜索的类型非常多）。这样，在解析and期间，编译器永远不会发现类型内部定义的运算符。`DateTime``d``l``System.TimeSpan``d``l``DateTime`

# ruby-on-rails - 在 Mongoid 中 find_or_create_by 线程安全吗？

> ID：13072866
> 
> 赞同：3
> 
> 时间：2012-10-25T16:15:38.063
> 
> 标签：ruby-on-rails, thread-safety, mongoid

我有一个使用 Mongoid 的 find_or_create_by 方法的网络应用程序。

```
poll = Poll.find_or_create_by(fields) 
```

在我们投入生产之前，我正在尝试运行失败场景，我突然想到多个用户可以尝试使用此方法访问此资源。它是否有可能创建同一对象的多个实例？我能做些什么来防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T08:17:41.817

免责声明：我是 Mongoid 和 Rails 的新手，所以我可能完全错了。

查看[modifiable.rb](https://github.com/mongoid/mongoid/blob/7ac104ce42401602b829ebee939bb2f9944b8411/lib/mongoid/criterion/modifiable.rb)和[many.rb](https://github.com/mongoid/mongoid/blob/165b4c6e1c2e53fe705c74444ea054ffa7602c72/lib/mongoid/relations/many.rb)它似乎没有锁定任何资源。

在我看来，它只是执行“where().first”查询，然后如果没有返回任何内容，则执行“create”查询：

```
 def find_or(method, attrs = {}, &block)
    where(attrs).first || send(method, attrs, &block)
  end 
```

对于 find_or_create_by，“send”会调用“create_document”：

```
def create_document(method, attrs = nil, &block)
    klass.__send__(method,
      selector.reduce(attrs || {}) do |hash, (key, value)|
        unless key.to_s =~ /\$/ || value.is_a?(Hash)
          hash[key] = value
        end
        hash
      end, &block)
  end 
```

结论：对我来说，这似乎是一种方便的方法，不要指望它是“线程安全的”。我希望有更多关于这种方法的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-15T16:17:29.097

有时在 MRI 中实现线程安全代码是不值得的。因为大多数时候我们必须进行多进程部署。所以最简单的解决方案是数据库级别的唯一性验证。

```
class Person
  include Mongoid::Document
  field :ssn
  index({ ssn: 1 }, { unique: true })
end 
```

所以当保存失败时回滚[事务](https://docs.mongodb.com/mongoid/master/tutorials/mongoid-transactions/)。请记住，模型级别的唯一性验证也容易出错。

# ruby-on-rails - ruby 的 `create!` 有什么方法可以一次创建多个对象？

> ID：13072867
> 
> 赞同：2
> 
> 时间：2012-10-25T16:15:38.770
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个偶尔会吐出 2 个对象的系统。有什么魔法`create!`可以让它创建两个对象吗？EG 如果我说

```
self.class.create! make_up_attributes 
```

并`make_up_attributes`传递一个 2 项哈希，这可以创建 2 个类型的对象`self`吗？

（注意，`create`可能是 Rails 中的 ActiveRecord 方法）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T16:21:07.563

是的，只需传入一个属性哈希数组，如下所示：

```
self.class.create!([{:name => "John", :age => 26},
                    {:name => "Fred", :age => 50}]) 
```

查看[文档](http://apidock.com/rails/ActiveRecord/Persistence/ClassMethods/create)

# asp-classic - Google Docs 嵌入式查看器 IE 9 不显示，使用 ASP 经典

> ID：13072868
> 
> 赞同：1
> 
> 时间：2012-10-25T16:15:46.847
> 
> 标签：asp-classic, google-docs-api

在 ASP 经典网站上使用 Google 文档查看器。
我遇到的问题是它没有在 Internet Explorer 9 中显示文档。我还没有看到任何人从开发人员的角度解决这个问题。

我假设的问题与 IE9 安全设置有关，但我的 IE8 可以很好地呈现它。

有没有办法在不让用户做某事的情况下解决这个问题？

它在 Firefox 和 Chrome 中运行良好。

我的嵌入式查看器如下所示：

```
<iframe src="http://docs.google.com/viewer?url=http%3A%2F%2F<%=linkToDoc%>&embedded=true" width="663" height="938" style="border: none;"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T11:06:34.537

因为我在谷歌文档查看器上有一个快速查看。它没有可下载的插件来修补您的脚本。有两种使用方法。用于`<%=link from source(db or request function)%>`获取文件并使用 iframe

```
<iframe src="http://docs.google.com/gview?url=(LINKforDOCUMENT)&embedded=true" style="width:600px; height:500px;" frameborder="0"></iframe> 
```

或者您可以使用此插件 [Google Docs Viewer-Jquery 插件](http://www.jawish.org/blog/archives/394-Google-Docs-Viewer-plugin-for-jQuery.html)。

它似乎都适用于所有浏览器。

# python - python中的并行编程

> ID：13072874
> 
> 赞同：15
> 
> 时间：2012-10-25T16:16:07.163
> 
> 标签：python, parallel-processing

我的项目是使用 OpenMP 在 C 中做一些并行算法。现在我想用 Python 做同样的项目。有没有类似 openmp for python 的东西？

# java - 调用 connection.rollback() 抛出 NullPointerException

> ID：13072876
> 
> 赞同：0
> 
> 时间：2012-10-25T16:16:12.277
> 
> 标签：java, mysql, nullpointerexception

运行项目会抛出这个错误：

```
java.lang.NullPointerException
    com.myproject.crud.EmployeesJDBCImpl.withDB(EmployeesJDBCImpl.java:157)
    com.myproject.crud.EmployeesJDBCImpl.doList(EmployeesJDBCImpl.java:119)
    com.myproject.crud.EmployeesJDBCImpl.listEmployees(EmployeesJDBCImpl.java:111)
    com.myproject.crud.EmployeesJDBCImpl$Proxy$_$$_WeldClientProxy.listEmployees(EmployeesJDBCImpl$Proxy$_$$_WeldClientProxy.java)
    com.myproject.crud.EmployeesListServlet.doGet(EmployeesListServlet.java:36)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

块失败，`try`它跳转到块，当被调用时对象`catch`似乎`connection`是空的。`connection.rollback()`很难理解为什么会发生这种情况。中提供的用户名和密码`context.xml`正确。

**雇员JDBCImpl.java**

```
package com.myproject.crud;

import java.util.ArrayList;
import java.util.List;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import javax.enterprise.context.ApplicationScoped;
import javax.annotation.Resource;
import javax.sql.DataSource;

@ApplicationScoped @JDBC
public class EmployeesJDBCImpl implements EmployeesRepository {

    @Resource(name="jdbc/EmployeesDB")
    private DataSource dS;

    @Override
    public Employee viewEmployee(final String id) {
        return withDB(new JDBCRunner<Employee>(){
            @Override
            public Employee run(Connection connection) throws Exception{
                PreparedStatement preparedStatement = connection.prepareStatement("SELECT * FROM employees WHERE id = ?");

                preparedStatement.setString(1, id);

                ResultSet rs = preparedStatement.executeQuery();
                if(rs.next()){
                    Employee employee = new Employee();
                    employee.setId(rs.getString("id"));
                    employee.setName(rs.getString("name"));
                    employee.setPhone(rs.getString("phone"));
                    employee.setEmail(rs.getString("email"));                   
                    return employee;
                }else{
                    return null;
                }
        }});
    }

    private <T> T withDB(JDBCRunner<T> runner){
        Connection connection = null;

        try{
            connection = dS.getConnection();
            boolean auto = connection.getAutoCommit();
            connection.setAutoCommit(false);
            T result = runner.run(connection);
            connection.commit();
            connection.setAutoCommit(auto);
            return result;
        }catch(Exception e){
            try{
                connection.rollback(); // Nullpointer exception here
            }catch(SQLException ex){
            }
            //throw new EmployeesException(e);
        }finally{
            if(connection != null){
                try{
                    connection.close();
                }catch(Exception ex){
                }
            }
        }
        return null;
    }
} 
```

**META-INF/context.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<Context>
    <Resource name="jdbc/EmployeesDB" auth="Container" type="javax.sql.DataSource"
               maxActive="100" maxIdle="30" maxWait="10000"
               username="root" password="secret" driverClassName="com.mysql.jdbc.Driver"
               url="jdbc:mysql://localhost:3306/javatest"/>
</Context> 
```

**WEB-INF/web.xml**

```
...
    <description>MySQL Employees App</description>
    <resource-ref>
      <description>db connection</description>
      <res-ref-name>jdbc/EmployeesDB</res-ref-name>
      <res-type>javax.sql.DataSource</res-type>
      <res-auth>Container</res-auth>
    </resource-ref>
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:34:58.243

**两个可能的原因：**

*   `dS.getConnection()`正在引发异常。可以是**任何**例外，因为您的 catch 块捕获了所有内容。你`NullPointerException` *进入*了 catch 块，因为`connection`它正`null`处于回滚点。
*   `dS.getConnection()`正在返回`null`导致`connection.getAutoCommit()`抛出 a 的 a `NullPointerException`。这是因为`connection`已设置为`null`via `dS.getConnection()`。

在你的 catch 块中，从一个开始`e.printStackTrace()`以确定真正的问题：

```
 ...
    }catch(Exception e){
        e.printStackTrace(); //This should show you what the real problem is
        try{
            connection.rollback();
        }catch(SQLException ex){
        }
        //throw new EmployeesException(e);
    }finally{
    ... 
```

**解决方案：**

*   在 catch 块中，在回滚之前检查是否`connection`不是。`null`如果从未创建数据库连接，则不必回滚。*我每天在大型项目中处理这种设置，这就是我们所做的。*
*   次优解决方案：一旦`dS.getConnection()`完成，**仅**当`connection`is not时才继续`null`。您可以使用`if (connection != null) { /* rest of code */ }`或`if (connection == null) throw new NullPointerException();`根据您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:24:53.963

我看不到您在哪里初始化了 DataSource

```
 connection = dS.getConnection(); 
```

您必须有一些 dS 的查找代码

类似于：

```
Context ctx=new InitialContext();                        
DataSource dS=(DataSource)ctx.lookup("jdbc/sampledb");   
Connection con=dS.getConnection(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:18:11.667

可能是因为您的连接没有正确创建。您应该`connection`在执行回滚之前检查是否不为空。

此外，您至少应该记录错误，这样您就能够弄清楚发生了什么。

我怀疑您的`dS`对象为空，可能由于名称不匹配而未正确注入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T16:21:19.013

尝试从 try 块记录异常。

最有可能的是，这行代码会抛出异常：connection = dS.getConnection();

一般来说，如果可能，您应该避免捕获所有异常。并记录异常，以便您了解发生了什么。因为正如名字所暗示的那样，例外是不想要的。

--待定

# jquery-mobile - ipad safari 浏览器不清除cookies

> ID：13072885
> 
> 赞同：2
> 
> 时间：2012-10-25T16:16:41.540
> 
> 标签：jquery-mobile, mobile-safari, ipad-2

我正在使用 Jquery Mobile 和 MVC 3 开发移动 Web 应用程序。我正在使用 FormsAuthentication 进行用户身份验证。这是我的登录按钮点击代码

```
AuthenticationResult authResult = this.membershipService.Authenticate(username, password, remoteAddress);
if (authResult.IsAuthenticated)
            {
                FormsAuthentication.SetAuthCookie(username, false);
            } 
```

authResult.RedirectAction + "到 JSON 对象"); return Json(new { action = "Index", });

在注销按钮上，我已经编写了代码

```
public ActionResult LogOff()
    {
        FormsAuthentication.SignOut();
        Response.Cookies.Clear();            
        return RedirectToAction("Index", "Home");
    } 
```

这在 Windows 机器 safari 浏览器上运行良好

当我在 iPad Safari 浏览器上打开我的应用程序时：

1.  提供登录凭据并单击确定，它会将我重定向到相应的屏幕。
2.  注销并关闭 iPad 上的 Safari 浏览器
3.  重新打开 Safari 浏览器并执行第 1 步，这次它会将我重定向到登录屏幕。
4.  我必须清除浏览器 cookie，然后它才会将我重定向到适当的屏幕

我还清除了登录屏幕上的 cookie，但它不起作用。有人可以帮我吗？

# codeigniter - CodeIgniter：图像处理类不能工作两次

> ID：13072891
> 
> 赞同：4
> 
> 时间：2012-10-25T16:16:59.520
> 
> 标签：codeigniter, image-processing

我在尝试调整图像大小然后创建拇指时遇到问题。

这两个函数是分开工作的，但是当试图同时调用它们时，只有第一个调用有效。没有创建拇指，为什么？

这是我的控制器：

```
if($this->upload->do_upload()){

                // Si oui, tout va bien

                //Update DB
                $pictureData = $this->upload->data();
                if($pictureData['file_name']!=''){
                    //On resize l'immage
                        //On charge la librarie
                        $this->load->library('thumbs');

                        $this->thumbs->resize($pictureData['full_path'], 300, 600);

                    $News['image']=$pictureData['file_name'];

                    //On crée un Thumbnail:
                        // on envoi le full path
                        if($this->thumbs->create($pictureData['full_path']))

                        // on stock le path recu
                    $News['thumb'] = $pictureData['raw_name'].'_thumb'.$pictureData['file_ext'];
                }
            } 
```

这是我为这两个函数创建的库：

```
 <?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Thumbs
{

    function __construct()
    {
        $CI =& get_instance();
        $this->load->library('image_lib');
    }

    public function create($picPath) {

        $CI =& get_instance();

        $config['image_library'] = 'gd2';
        $config['source_image'] = $picPath;
        $config['maintain_ratio'] = TRUE;
        $config['create_thumb'] = TRUE;
        $config['width']     = 100;
        $config['height']   = 100;

        $CI->image_lib->clear();
        $CI->image_lib->initialize($config); 

        if(!$CI->image_lib->resize()){
            $CI->session->set_flashdata('flashError',  $CI->image_lib->display_errors());
            return False;
        }
        $CI->image_lib->clear();
        Return True;

    }

    public function resize($picPath, $x, $y) {

        $CI =& get_instance();

        $config1['image_library'] = 'gd2';
        $config1['source_image']    = $picPath;
        $config1['maintain_ratio'] = TRUE;

        if($x!=0)
            $config1['width']    = $x;

        if($y!=0)
            $config1['height']  = $y;

        $CI->image_lib->clear();
        $CI->image_lib->initialize($config1); 

        if(!$CI->image_lib->resize()){
            $CI->session->set_flashdata('flashError',  $CI->image_lib->display_errors());
            return False;
        }
        $CI->image_lib->clear();
        Return True;
    }
} 
```

因此，如果我只调用一个，它可以正常工作，无论是创建还是调整大小功能。否则，如果我尝试同时调用它们，则只有已调用的第一个函数有效。

编辑：感谢 fccotech，我做到了。这是他带来的解决方案：

```
<?php if (!defined('BASEPATH')) exit('No direct script access allowed');

class Thumbs
{

    function __construct()
    {
        $this->CI =& get_instance();
        $this->CI->load->library('image_lib');
    }

    public function create($picPath, $picName) {

        $config =array();

        $config['image_library'] = 'gd2';
        $config['source_image'] = $picPath;
        $config['maintain_ratio'] = TRUE;
        $config['create_thumb'] = TRUE;
        $config['width']     = 100;
        $config['height']   = 100;
        $config['new_image'] =  $picName;

        // $CI->image_lib->clear();
        $this->CI->image_lib->initialize($config); 

        if(!$this->CI->image_lib->resize()){
            $this->CI->session->set_flashdata('flashError',  $this->CI->image_lib->display_errors());
            return False;
        }
        $this->CI->image_lib->clear();
        Return True;

    }

    public function resize($picPath, $x, $y) {

        $config1 = Array();

        $config1['image_library'] = 'gd2';
        $config1['source_image']    = $picPath;
        $config1['maintain_ratio'] = TRUE;

        if($x!=0)
            $config1['width']    = $x;

        if($y!=0)
            $config1['height']  = $y;

        // $CI->image_lib->clear();
        $this->CI->image_lib->initialize($config1); 

        if(!$this->CI->image_lib->resize()){
            $this->CI->session->set_flashdata('flashError',  $this->CI->image_lib->display_errors());
            $this->CI->image_lib->clear();
            return False;
        }
        $this->CI->image_lib->clear();
        Return True;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T17:07:17.807

调整大小后添加

```
$this->image_lib->clear(); 
```

所以在你做一个新的 $CI->image_lib->initialize($config); 之前也要清楚。

# java - 在Java代码完成之前Dojo ajax调用返回？

> ID：13072896
> 
> 赞同：0
> 
> 时间：2012-10-25T16:17:16.440
> 
> 标签：java, javascript, ajax, google-chrome, dojo

我继承的 Struts2 + dojo Web 应用程序有问题。该应用程序适用于 IE9 和 Firefox，但不适用于 Chrome。

这是提交按钮代码：

```
<button dojoType="dijit.form.Button" 
        type="submit" 
        onclick="sendRuleForm('requestSubmitForm', 'resultDiv', 'RequestSubmit.action');">Submit</button> 
```

这是上面 sendRuleForm 函数的 javascript 代码：

```
function sendRuleForm(formId, id, actionNm) {
    var bindArgs = {
        url: actionNm,
        form: document.getElementById(formId),
        handleAs: "text",
        load: function(data) {
            document.getElementById(id).innerHTML = data;            
        },
        error: function(data) {
            alert(data);
            return;
        }
    }
    dojo.xhrPost(bindArgs);
    document.getElementById(id).innerHTML = ajaxLoader;
} 
```

**我注意到，如果我在 Java 代码中设置断点，甚至在**操作完成 之前，网页就会返回错误。

Chrome 开发人员工具指示操作/请求的已取消状态（[在 Chrome 开发人员工具中，资源的 status=canceled 是什么意思？](https://stackoverflow.com/questions/12009423/what-does-status-canceled-for-a-resource-mean-in-chrome-developer-tools)）

我使用的是旧版本的 dojo 1.3.1，但将其更新到最新版本并没有解决问题。

谁能解释这种行为并让我知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T14:16:20.223

您可以排除此错误的 ajax / javascript 位。它是

1.  chrome 中的错误（不太可能）
2.  您正在调用的 struts 页面中的错误，可能会发回奇怪的 HTTP 响应（检查服务器日志）
3.  表单提交中有一个“抖动”，其中发送了多个请求。我猜，但也许在 chrome 中的处理方式`<button type="submit"`不同`<input type="submit"`

您在重定向到不同页面时遇到的情况可能是由于当您手动刷新新选项卡中的 URL 字段时 Struts 应用程序接收到 GET。也可能是由于缺少登录cookie等。

要获得应用程序的真实响应，请尝试`target`使用您的属性输入`form`，然后以正常方式提交（不使用 XHR）。

```
<form action="RequestSubmit.action" method="POST" target="_debugwin">
    <input type="submit" value="DebugSubmit" name="debugbutton" />
     ... remainder of form code 
```

此外，您的 dijit Button 有一个可覆盖的函数“onClick”，请注意 camelCasing。您正在设置 DOM onclick 事件。在这种情况下，您的 click 事件可能会在 dojo.xhr 触发后（函数返回时）立即由浏览器处理。请参阅此问题：[使用 Dojo 阻止表单提交](https://stackoverflow.com/questions/3844995/preventing-form-submission-with-dojo)

但是，唯一的方法是，如果表单是在 (i) 框架中加载的，那么您在调试窗口中看到的“已取消”错误是这种情况。否则，整个页面将刷新，网络监控将重置。作为一种简单、双赢的解决方法，请按如下方式调整 onclick 属性：

```
<button dojoType="dijit.form.Button" 
        type="submit" 
        onClick="sendRuleForm('requestSubmitForm', 'resultDiv', 'RequestSubmit.action'); /* NOTE */ return false;">Submit</button> 
```

# iphone - 用户单击主页按钮时如何显示退出确认对话框？

> ID：13072903
> 
> 赞同：1
> 
> 时间：2012-10-25T16:17:58.187
> 
> 标签：iphone, objective-c, ios, exit

当用户按下主页按钮时，我需要显示退出确认对话框。如果是，需要退出应用程序。

按下主页按钮时是否可以显示？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T16:25:35.603

这可能会导致您的应用被拒绝

来自[Apple HIG](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/UEBestPractices/UEBestPractices.html#//apple_ref/doc/uid/TP40006556-CH20-SW1)：

**随时准备停止**

当人们按下主页按钮打开不同的应用程序或使用设备功能（如手机）时，iOS 应用程序会停止。特别是，人们不会点击应用程序关闭按钮或从菜单中选择退出。为了提供良好的停止体验，iOS 应用应该：

尽快并尽可能多地保存用户数据，因为退出或终止通知可能随时到达。停止时保存当前状态，尽可能详细地保存，以便人们在再次启动应用程序时不会丢失上下文。例如，如果您的应用显示滚动数据，请保存当前滚动位置。要了解有关保存和恢复应用程序状态的有效方法的更多信息，请参阅“状态保存和恢复”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T16:22:02.260

我不确定您是否可以阻止应用程序终止或进入后台。您可以通过应用程序委托 applicationWilResignActive 告诉它即将进入后台或被 applicationWillTerminate 终止。

# css - 布局定位问题：不需要的动作标题 div 应该会影响可滚动内容 div 的位置

> ID：13072904
> 
> 赞同：-2
> 
> 时间：2012-10-25T16:17:59.607
> 
> 标签：css, position, css-position

好的，有两种情况：

我有这样的布局：

```
----------------
button header
----------------
Contents
Contents
Contents
Contents (with scrollbar)
Contents
------------
footer
------------ 
```

我想要实现的是：按钮页眉和页脚必须始终保持在视图中 - 内容必须是可滚动的。 **buttonheader 可以是空的——因此可滚动的内容应该移动到 buttonheader 上方——如果没有按钮，那么丢失空间是没有意义的**。

所以绝对/固定定位似乎不是一个选择，所以我尝试了相对。（绝对没有解决方案的原因是因为如果内容绝对放置在那里，如果按钮标题为空，它们将永远不会移动。）

我将高度设置为百分比 - 但如果有人调整窗口大小，它当然看起来很糟糕。

看这里并调整输出窗口的大小：

[关于如何获得工作相对定位的可滚动内容的悲伤尝试](http://jsfiddle.net/6HbSN/)

第二个版本：

[是显示它的行为（在顶部） - 内容应该贴在页面顶部 - 页脚在这里是错误的](http://jsfiddle.net/6HbSN/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:24:23.540

灵活的行为听起来很像表格行，所以我在 CSS 中采用了这种方式。添加了一些额外的 div 以使 firefox 在主单元格内很好地播放。

见[http://jsfiddle.net/willemvb/XMEcC/](http://jsfiddle.net/willemvb/XMEcC/)

```
#container{
    position: relative;
    width: 300px;
    display: table;
    height: 100%;
}

#header, #footer{
    width: 100%;
    height: auto;
    display: table-row;
}

#main{
   height: 100%;
   display: table-row;    
}

#cell{
   display: table-cell;    
}

#wrapper{
    position: relative;
    width: 100%;
    height: 100%;   
}

#overflow{
    overflow-y: scroll;
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width:100%;
} 
```

编辑：仅在 FF 和 Safari 中测试

# javascript - 检测是否使用javascript打开新窗口

> ID：13072907
> 
> 赞同：0
> 
> 时间：2012-10-25T16:18:07.327
> 
> 标签：javascript, jquery

创建一个小型聊天应用程序，用户可以通过单击用户个人资料旁边的聊天按钮开始聊天。

一旦有人点击聊天按钮，就会出现一个弹出窗口。现在我想动态检测这个popus是否仍然打开或关闭。

如果弹出窗口打开=在通知中显示新消息警报。

如果弹出窗口关闭 = 不要在通知中提醒新消息（因为聊天窗口已经打开）

这是我尝试过的：

```
 <a href="#" onclick="popitup("http://domain.com/chat/2")">Chat with user 2</a>
    <a href="#" onclick="popitup("http://domain.com/chat/1")">Chat with user 1</a> 
```

```
// on document ready
setInterval(function(){
    chkAlerts();
}, 10000);

var newwindow = null;

function popitup(url) {
    if ((newwindow == null) || (newwindow.closed)) {
        newwindow = window.open(url,'Buy','width=950,height=650,scrollbars=yes,resizable=yes');
        newwindow.focus();
    } 
    else {
        newwindow.location.href = url;
        newwindow.focus();    
    }
}  

function chkAlerts(){
    if ((newwindow == null) || (newwindow.closed)) {
        //Do something
        alert('now window is closed show alerts');
    }
} 
```

有了这段代码，我总是得到

```
alert('now window is closed show alerts'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:34:02.117

`chkAlerts`将始终将警报显示为 is 的初始`newwindow`值`null`。

假设您只希望在聊天窗口关闭后发出警报，调整逻辑以忽略初始 `null`状态；

```
function chkAlerts(){
    if ((newwindow != null) && (newwindow.closed)) {
        //Do something
        alert('now window is closed show alerts');
    }
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T18:29:06.460

续评论：

> 请注意，当重新加载或离开窗口打开器页面时，对 newwindow 的引用将丢失。
> 
> 是的，jan，这是实际的问题，你认为 javascript 中有什么函数可以做到这一点......还是我需要玩 session 或其他什么？

甚至无法使用会话或任何其他服务器巫术。

如果您确实需要跟踪聊天窗口，您的选择是将聊天包含在“打开器”页面上，并使其成为内联 AJAX 聊天。

您可以在所有页面上都有一个 AJAX 侦听器，并在您网站的所有打开的选项卡/窗口上“打开”该聊天窗口，这样用户就不会忘记它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:58:32.443

您的错误不在 javascript 代码中，在锚点中，您正在关闭函数调用中的双引号，它们必须是这样的：

```
<a href="#" onclick="popitup('http://domain.com/chat/2')">Chat with user 2</a> 
```

无论如何，而且，正如您所看到的，您只存储最后打开的窗口，如果您有兴趣知道两者都已打开，您应该将 newwindow 创建为数组。

干杯，

# angularjs - 执行操作后的 AngularJS 表单验证

> ID：13072909
> 
> 赞同：2
> 
> 时间：2012-10-25T16:18:08.640
> 
> 标签：angularjs

仅在用户单击某些按钮后才显示验证错误的最佳做法是什么？$.pristine 和 $.dirty 会立即反映，所以做这样的事情是行不通的......

```
<input name="email" id="email" type="email" required ng-model="user.email" placeholder="email">

<div ng-show="form.$dirty && form.email.$invalid">
    <span class="error" ng-show="form.email.$error.required">Required!</span>
    <span class="error" ng-show="form.email.$error.email">This is not a valid email.</span>
</div> 
```

我想我可以编写一些可以做到这一点的指令，但只是想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:17:46.953

我会调用一个自定义变量`$scope.showErrors`，当用户执行操作（如按下按钮）然后设置`$scope.showErrors`为`false`. 然后，您的外部 div 将`showErrors`作为`ng-show`您正在执行的其他检查的补充进行检查。

# python - 命令窗口仅在使用 os.system 时闪烁

> ID：13072915
> 
> 赞同：1
> 
> 时间：2012-10-25T16:18:35.800
> 
> 标签：python, command-window

我在朋友的机器上遇到了一个奇怪的问题，当他们运行我的脚本时，它只会在遇到与 os.system 执行某些操作的行时才会闪烁命令窗口。否则它似乎根本不显示命令窗口。不显示很好，但我的脚本做了一个很大的过程，它会导致窗口闪烁很多。

通常在我的机器上，当我打开脚本（使用 tkinter 启动 gui）时，命令窗口也会在后面打开。这就是我想让我的朋友们做的事情，但我不知道什么会导致命令窗口不显示。python中是否有一个设置不显示命令窗口（当然，除非它需要在其中运行一个进程）？

编辑：好的，我做了一个非常蹩脚的黑客来解决这个问题。显然他所有的 .py 文件都与 pythonw 相关联。我无法改变这个关联（甚至通过命令提示符 ASSOC）所以我只是将 pythonw 重命名为 old_pythonw，并将 python.exe 重命名为 pythonw.exe。是的，真的很傻，但没有时间与 windows 争论文件关联。

# excel - Excel VBA - 将字符串作为代码执行

> ID：13072918
> 
> 赞同：1
> 
> 时间：2012-10-25T16:19:01.093
> 
> 标签：excel, vba

我正在尝试使用 Evaluate 将以下字符串作为代码执行，但出现错误 2029。有人知道为什么吗？

非常感谢帮助。

```
Calculation = "Format(""21/08/2012"", ""MMM"")"
Value = Evaluate(Calculation) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:21:40.917

试试吧

```
Calculation = "TEXT(""21/08/2012"", ""MMM"")" 
```

EVALUATE 将公式转换为结果，FORMAT 是 VBA 函数。等效的公式是 TEXT。

您也可以跳过评估并直接在日期上使用 FORMAT 函数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T18:23:28.110

您可以直接在 VBA 中使用大多数工作表函数`Application.WorksheetFunction.`- 例如 - 试试这个：

```
Sub DateExample()

Dim StringTest As String
StringTest = Application.WorksheetFunction.Text("12/08/2012", "MMM")

Cells(1, 1).Value = StringTest

End Sub 
```

祝你好运

# c# - C# .Net 在一段时间后更改变量的值

> ID：13072919
> 
> 赞同：-4
> 
> 时间：2012-10-25T16:19:01.963
> 
> 标签：c#, asp.net

我试图让 ASP.Net 的 C# 中的一个函数工作.. 情况就是这样，

我有一个生成字符串的代码，我希望该字符串仅在 1 分钟内有效。

1 分钟后，该字符串应被我们硬编码的另一个字符串替换。

有没有办法在不与数据库交互的情况下做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:23:40.570

这是我的建议。您显然需要更新前端，但它应该很容易插入。

```
public class MagicString()
{
    DateTime creationDate;
    private string _text;

    public MagicString(string text)
    {
        this.text = _text;
        creationDate = dateTime.
    }

    public override string ToString()
    {
        if (creationDate.AddMinutes(1) > DateTime.Now)
        {
            return HARDCODEDSTRING;
        }
        else 
        {
            return _text;
        }    
    }
} 
```

# haskell - 具有更大域的 Euler #4

> ID：13072923
> 
> 赞同：6
> 
> 时间：2012-10-25T16:19:21.447
> 
> 标签：haskell, ghc

考虑修改后的欧拉问题 #4——“找到最大回文数，它是 100 到 9999 之间的两个数字的乘积。”

```
rev :: Int -> Int
rev x = rev' x 0

rev' :: Int -> Int -> Int
rev' n r
    | n == 0 = r
    | otherwise = rev' (n `div` 10) (r * 10 + n `mod` 10)

pali :: Int -> Bool
pali x = x == rev x

main :: IO ()
main = print . maximum $ [ x*y | x <- nums, y <- nums, pali (x*y)]
    where
        nums = [9999,9998..100] 
```

*   这个 Haskell 解决方案使用`-O2`和`ghc 7.4.1`大约需要**18 秒**。
*   类似的`C`解决方案需要**0.1 秒**。

所以 Haskell 慢了 180 倍。我的解决方案有什么问题？我认为 Haskell 可以很好地解决这类问题。

**附录 - 模拟 C 解决方案：**

```
#define A   100
#define B   9999
int ispali(int n)
{
    int n0=n, k=0;
    while (n>0) {
        k = 10*k + n%10;
        n /= 10;
    }
    return n0 == k;
}
int main(void)
{
    int max = 0;
    for (int i=B; i>=A; i--)
        for (int j=B; j>=A; j--) {
            if (i*j > max && ispali(i*j))
                max = i*j;      }
    printf("%d\n", max);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T19:02:49.887

> 类似的C解决方案

这是一个普遍的误解。

# 列表不是循环！

除非编译器能够从代码中消除列表，否则使用列表来模拟循环会影响性能。

如果你想比较苹果和苹果，编写 Haskell 结构或多或少相当于一个循环，一个尾递归工作程序（使用严格累加器，尽管编译器通常足够聪明，可以自己找出严格性）。

现在让我们更详细地看一下。相比之下，使用 gcc -O3 编译的 C 在这里需要 ~0.08 秒，使用 ghc -O2 编译的原始 Haskell 需要 ~20.3 秒，使用 ghc -O2 -fllvm ~19.9 秒。相当可怕。

原始代码中的一个错误是使用`div`and `mod`。`quot`C 代码使用and的等价物`rem`，它映射到机器除法指令并且比`div`and更快`mod`。对于正参数，语义是相同的，所以当你知道参数总是非负时，永远不要使用`div`and `mod`。

改变这一点，使用本机代码生成器编译时运行时间变为 ~15.4 秒，使用 LLVM 后端编译时运行时间变为 ~2.9 秒。

不同之处在于即使机器除法运算也很慢，LLVM 用乘法和移位运算代替了除法/余数。为本地后端手动做同样的事情（实际上，利用我知道参数总是非负的事实，一个稍微更好的替代品）将其时间缩短到约 2.2 秒。

我们越来越近了，但离 C 还差得很远。

那是由于列表。该代码仍然构建一个回文列表（并遍历`Int`两个因子的 s 列表）。

由于列表不能包含未装箱的元素，这意味着代码中有很多装箱和拆箱，这需要时间。

因此，让我们消除列表，看看将 C 转换为 Haskell 的结果：

```
module Main (main) where

a :: Int
a = 100

b :: Int
b = 9999

ispali :: Int -> Bool
ispali n = go n 0
  where
    go 0 acc = acc == n
    go m acc = go (m `quot` 10) (acc * 10 + (m `rem` 10))

maxpal :: Int
maxpal = go 0 b
  where
    go mx i
        | i < a = mx
        | otherwise = go (inner mx b) (i-1)
          where
            inner m j
                | j < a = m
                | p > m && ispali p = inner p (j-1)
                | otherwise = inner m (j-1)
                  where
                    p = i*j

main :: IO ()
main = print maxpal 
```

嵌套循环被翻译成两个嵌套的工作函数，我们使用一个累加器来存储迄今为止发现的最大回文。使用 ghc -O2 编译，运行时间约为 0.18 秒，使用 ghc -O2 -fllvm 运行时间约为 0.14 秒（是的，LLVM 比本机代码生成器更擅长优化循环）。

仍然不完全在那里，但大约 2 的一个因素还不错。

也许有些人发现以下循环被抽象出来更具可读性，生成的核心对于所有意图和目的都是相同的（以参数顺序的切换为模），并且性能当然相同：

```
module Main (main) where

a :: Int
a = 100

b :: Int
b = 9999

ispali :: Int -> Bool
ispali n = go n 0
  where
    go 0 acc = acc == n
    go m acc = go (m `quot` 10) (acc * 10 + (m `rem` 10))

downto :: Int -> Int -> a -> (a -> Int -> a) -> a
downto high low acc fun = go high acc
  where
    go i acc
        | i < low   = acc
        | otherwise = go (i-1) (fun acc i)

maxpal :: Int
maxpal = downto b a 0 $ \m i ->
            downto b a m $ \mx j ->
                let p = i*j
                in if mx < p && ispali p then p else mx

main :: IO ()
main = print maxpal 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:47:28.713

@axblount 至少部分正确；以下修改使程序运行速度几乎是原来的三倍：

```
maxPalindrome = foldl f 0
  where f a x | x > a && pali x = x
              | otherwise       = a

main :: IO ()
main = print . maxPalindrome $ [x * y | x <- nums, y <- nums]
  where nums = [9999,9998..100] 
```

不过，这仍然会导致 60 倍的减速。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T16:31:00.980

~~Haskell 可能正在存储整个列表 [ x*y | x <- nums, y <- nums, pali (x*y)] 其中 C 解决方案即时计算最大值。我不确定。~~

此外，如果产品超过之前的最大值，C 解决方案只会计算 ispali。我敢打赌，无论 x*y 是否是可能的最大值，Haskell 计算的都是回文乘积。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T16:58:36.050

这更符合 C 代码正在做的事情：

```
maxpali :: [Int] -> Int
maxpali xs = go xs 0
  where
    go [] m     = m
    go (x:xs) m = if x > m && pali(x) then go xs x else go xs m

main :: IO()
main = print . maxpali $ [ x*y | x <- nums, y <- nums ]
  where nums = [9999,9998..100] 
```

在我的盒子上，这需要 2 秒，而 C 版本需要 0.5 秒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T17:21:38.470

在我看来，您遇到了分支预测问题。在 C 代码中，您有两个嵌套循环，一旦在内循环中看到回文，内循环的其余部分就会被快速跳过。

您提供此产品列表而不是嵌套循环的方式我不确定 ghc 是否正在执行任何此预测。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-27T07:31:15.597

另一种写法是使用*两个*折叠，而不是扁平列表上的一个折叠：

```
-- foldl g0 0 [x*y | x<-[b-1,b-2..a], y<-[b-1,b-2..a], pali(x*y)]      (A)
-- foldl g1 0 [x*y | x<-[b-1,b-2..a], y<-[b-1,b-2..a]]                 (B)
-- foldl g2 0 [ [x*y | y<-[b-1,b-2..a]] | x<-[b-1,b-2..a]]             (C)

maxpal b a = foldl f1 0 [b-1,b-2..a]                              --   (D)
  where
    f1 m x = foldl f2 m [b-1,b-2..a]
      where
        f2 m y | p>m && pali p = p
               | otherwise     = m  
           where p = x*y

main = print $ maxpal 10000 100 
```

似乎运行速度也比`(B)`（如 larsmans 的回答）快得多（仅比以下基于循环的代码*慢 3 倍 - 4 倍）。*融合`foldl`和`enumFromThenTo`定义为我们提供了“功能循环”代码（如 DanielFischer 的回答），

```
maxpal_loops b a = f (b-1) 0                                      --   (E)
  where               
    f x m | x < a     = m 
          | otherwise = g (b-1) m 
      where
        g y m | y < a         = f (x-1) m
              | p>m && pali p = g (y-1) p 
              | otherwise     = g (y-1) m
           where p = x*y 
```

该`(C)`变体非常暗示进一步的*算法*改进（当然，这超出了原始 Q 的范围），利用列表中的隐藏顺序，被扁平化破坏：

```
{- foldl g2 0 [ [x*y | y<-[b-1,b-2..a]] | x<-[b-1,b-2..a]]             (C)
   foldl g2 0 [ [x*y | y<-[x,  x-1..a]] | x<-[b-1,b-2..a]]             (C1)
   foldl g0 0 [ safehead 0 . filter pali $
                [x*y | y<-[x,  x-1..a]] | x<-[b-1,b-2..a]]             (C2)
   fst $ until ... (\(m,s)-> (max m .
                safehead 0 . filter pali . takeWhile (> m) $
                                                   head s, tail s))          
           (0,[ [x*y | y<-[x,  x-1..a]] | x<-[b-1,b-2..a]])            (C3)
   safehead 0 $ filter pali $ mergeAllDescending
              [ [x*y | y<-[x,  x-1..a]] | x<-[b-1,b-2..a]]             (C4)
-} 
```

`(C3)`只要`x*y`子列表中的头部小于当前找到的最大值，就可以停止。这是快捷功能循环代码可以实现的，但不是`(C4)`，它保证首先找到最大回文*数*。另外，对于基于列表的代码，它的算法性质在视觉上更加明显，IMO。

# c - Shell Pipes 和重定向帮助。错误：必须设置个性才能获得 -x 选项/垃圾选项

> ID：13072926
> 
> 赞同：1
> 
> 时间：2012-10-25T16:19:29.683
> 
> 标签：c, redirect, pipe

我正在创建自己的 shell，它执行以下重定向选项 ">、>>、<、|" 使用管道。但我不断收到这个奇怪的错误。当我尝试命令 ps -ax > processes.txt 我得到这个：

```
 Error: Must set personality to get -x option 
```

或者

```
 Error: Garbage option 
```

这是我到目前为止编写的代码。

```
for (i=0; i<nargs; i++)
{

    //> redirect output to output file
    if((strcmp(args[i], ">")==0))
    {   //printf("Forking.\n");
        pid = fork();
        //printf("Forked\n");
        if(pid == 0) 
            { /* child process */
                const char* file = args[i+1];
                printf("entered child process\n");
                int fd;

                if((fd=creat(file,O_WRONLY| O_TRUNC | O_CREAT ))==-1)
                {
                    fprintf(stderr,"Couldn't open %s\n", args[i+1]);
                    exit(-1);
                }//this works
                else
                    {fd=creat(file,O_WRONLY | O_TRUNC | O_CREAT);
                    dup2(fd,1);
                    close(fd);                  
                    args[i]= 0;                 
                    execvp(args[0], args);
                    perror("exec failed\n");
                    exit(-1);}
            }

        else if(pid > 0) 
            { /* parent process */
                if(!async) waitpid(pid, NULL, 0);
                else printf("this is an async call\n");
                //execvp(args[i+1], args);

              } 
        else { /* error occurred */
                perror("fork failed\n");
                exit(1);
              }

        printf("Child complete\n");

    }//>> redirect output to output file does not overwrite just writes to the end of the file
    else if((strcmp(args[i], ">>")==0))
    {
        printf("Forking.\n");
        pid = fork();
        printf("Forked\n");
        if(pid == 0) 
            { /* child process */
                const char* file = args[i+1];
                printf("entered child process\n");
                int fd;
                if((fd=open(file,O_WRONLY | O_CREAT | O_APPEND))==-1)
                {
                    fprintf(stderr,"Couldn't open %s\n", args[i+1]);
                    exit(-1);
                }

                    fd=open(file,O_WRONLY | O_CREAT | O_APPEND);
                    dup2(fd,1);
                    close(fd);
                    args[i]=NULL;
                //printf("%d", fd);
                execvp(args[0], args);
                /* return only when exec fails */
                perror("exec failed\n");
                exit(-1);
            }
        else if(pid > 0) 
            { /* parent process */
                if(!async) waitpid(pid, NULL, 0);
                else printf("this is an async call\n");
              } 
        else { /* error occurred */
                perror("fork failed\n");
                exit(1);
              }

        printf("Child complete\n");
    }//input comes from a file
    else if((strcmp(args[i], "<")==0))
    {
        printf("Forking.\n");
        pid = fork();
        printf("Forked\n");
        if(pid == 0) 
            { /* child process */
                const char* file = args[i+1];
                printf("entered child process\n");
                int fd;
                if((fd=open(file,O_RDONLY)==-1))
                {
                    fprintf(stderr,"File does not exist %s\n", args[i+1]);
                    exit(-1);
                }

                    fd=open(file,O_RDONLY);
                    dup2(fd,0);
                    close(fd);
                    args[i]=NULL;
                execvp(args[0], args);
                /* return only when exec fails */
                perror("exec failed\n");
                exit(-1);
            }
        else if(pid > 0) 
            { /* parent process */
                if(!async) waitpid(pid, NULL, 0);
                else printf("this is an async call\n");
              } 
        else { /* error occurred */
                perror("fork failed\n");
                exit(1);
              }

        printf("Child complete\n");
    }//| output is input for another command
    else if((strcmp(args[i], "|")==0))
    {//the mypipe code edited
        printf("Forking.\n");
        pid = fork();
        printf("Forked\n");
        if(pid == 0)            
        {       const char* file = args[i+1];
                printf("entered child process\n");
                int fd;
                if((fd=open(file,O_WRONLY | O_CREAT | O_TRUNC))==-1)
                {
                    fprintf(stderr,"Couldn't open %s\n", args[i+1]);
                    exit(-1);
                }//this works

                    fd=open(file,O_WRONLY | O_CREAT | O_TRUNC);
                    dup2(fd,1);
                    close(fd);
                    //close(fd);

                args[i]=NULL;
                execvp(args[0], args);
                /* return only when exec fails */
                perror("exec failed\n");
                exit(-1);
            }
        else if(pid > 0) 
            { /* parent process */
                if(!async) waitpid(pid, NULL, 0);
                else printf("this is an async call\n");
              } 
        else { /* error occurred */
                perror("fork failed\n");
                exit(1);
              }

        printf("Child complete\n");

    }// 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-25T16:50:40.137

你试过用gdb调试吗？我认为 gdb 会提供更好的图片或尝试使用 strace 运行您的二进制文件，它将为您提供系统级图片，您的程序究竟在哪里遇到问题。还有一件事，这是完整的程序吗，如果是，我也会在我的系统上尝试

# c# - 从 DataTable 创建 XML

> ID：13072927
> 
> 赞同：7
> 
> 时间：2012-10-25T16:19:32.337
> 
> 标签：c#, xml, linq, datatable, dataset

![以下格式的 C# 中的 DataTable](../Images/c850115a21aa975026ab18757f990018.png)

使用 C#：我想将此表转换为 XML。**请忽略行名中的错误**。这是测试数据。我已经给出了两列转换为 xml 的示例，并将相应的行作为属性。但我实际上想要所有列。这是一个数据表。

```
 <ListDataCollateralDials>
                                <DataCollateralDials Type="Conv">
                                    <Multiplier>1</Multiplier>
                                    <Seasoning>1</Seasoning>
                                    <Lockin>1</Lockin>
                                    <Multiplier>1</Multiplier>
                                    <ElbowShift>0</ElbowShift>
                                    <Steepness>1</Steepness>
                                    <Burnout>1</Burnout>
                                    <Adjustment >1</Adjustment>
                                    <Effect>1</Effect>
                                    <Decay>1</Decay>
                                    <Outs>1</Outs>
                                    <Base>700</Base>
                                    <Slope>1</Slope>
                                    <Base>80</Base>
                                    <Slope2>1</Slope2>
                                    <Base2>200</Base2>
                                    <Slope3>1</Slope3>
                                    <Height>0</Height>
                                    <Length>0</Length>
                                    <Height2>0</Height2>
                                    <Length2>0</Length2>
                                    <Elbow>0</Elbow>
                                                 <Multiplier2>1</Multiplier2>
                                    <Multiplier3>1</Multiplier3>

                                </DataCollateralDials>
<DataCollateralDials Type="Conv">
                                <Multiplier>1</Multiplier>
                                <Seasoning>1</Seasoning>
                                <Lockin>1</Lockin>
                                <Multiplier>1</Multiplier>
                                <ElbowShift>0</ElbowShift>
                                <Steepness>1</Steepness>
                                <Burnout>1</Burnout>
                                <Adjustment >1</Adjustment>
                                <Effect>1</Effect>
                                <Decay>1</Decay>
                                <Outs>1</Outs>
                                <Base>700</Base>
                                <Slope>1</Slope>
                                <Base>80</Base>
                                <Slope2>1</Slope2>
                                <Base2>200</Base2>
                                <Slope3>1</Slope3>
                                <Height>0</Height>
                                <Length>0</Length>
                                <Height2>0</Height2>
                                <Length2>0</Length2>
                                <Elbow>0</Elbow>
                                <Multiplier2>1</Multiplier2>
                                <Multiplier3>1</Multiplier3>

                            </DataCollateralDials>
</ListDataCollateralDials> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T01:59:43.530

```
public static string ToXml(this DataTable table, int metaIndex = 0)
{
    XDocument xdoc = new XDocument(
        new XElement(table.TableName,
            from column in table.Columns.Cast<DataColumn>()
            where column != table.Columns[metaIndex]
            select new XElement(column.ColumnName,
                from row in table.AsEnumerable()
                select new XElement(row.Field<string>(metaIndex), row[column])
                )
            )
        );

    return xdoc.ToString();
} 
```

这对我很有用。感谢堆栈溢出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T16:28:35.783

`DataTable`s 旨在遍历行，而不是像您拥有的列。没有内置的东西可以保持`DataTable`列主要顺序。您将使用自定义代码。伪代码将类似于：

```
foeeach(DataColumn)
  if(name != "Name")
    output column header
    foreach(DataRow) 
      output row value 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T16:36:53.703

你可以尝试使用这个

[http://msdn.microsoft.com/en-us/library/system.data.datatable.writexml.aspx](http://msdn.microsoft.com/en-us/library/system.data.datatable.writexml.aspx)

```
DataTable youdatatable = GetData();
System.IO.StringWriter writer = new System.IO.StringWriter();
 youdatatable.WriteXml(writer, XmlWriteMode.WriteSchema, true);
 PrintOutput(writer); 
```

# git - git 没有更新主分支 - 任何线索为什么或如何解决它？

> ID：13072930
> 
> 赞同：0
> 
> 时间：2012-10-25T16:19:50.480
> 
> 标签：git

如果我做

```
git checkout master 
```

`git push`

我明白了

> 一切都是最新的

如果我走

```
git pull 
```

我明白了

> 已经是最新的了。

如果我远程 ssh 到我的服务器并且我这样做：

```
 git status 
```

我得到：

> 在分支 master
> 上没有提交（工作目录干净）

然而，事实是，与远程文件相比，我在本地确实有不同版本的文件。

我该如何解决这个问题，以便将我的本地文件放入主远程分支？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:06:59.420

> 我已经完成`git pull hub master`并且它“捕获了未更新的文件”这是什么意思？

这意味着您在本地计算机上正确执行了所有操作。您正确地提交了更改，并且正确地推送了它。不工作的事情是更改从中央（裸）存储库到具有工作目录的另一个（非裸）存储库。你说一个钩子对此负责，所以这似乎不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:23:16.063

您可能在本地有一个未提交的文件。在您当地的工作目录中，尝试：

```
git add -A
git commit -m "commit message"
git push 
```

# tridion - 在 Tridion 中实现脚注

> ID：13072932
> 
> 赞同：6
> 
> 时间：2012-10-25T16:19:53.710
> 
> 标签：tridion

我想知道是否有人想出了一个很好的脚注解决方案。我希望在具有多个组件的页面上在 Tridion 中实现脚注，并且我希望所有脚注都显示在页面底部，并带有在内容部分中生成的正确脚注编号。

[http://i.stack.imgur.com/dAxeh.png](http://i.stack.imgur.com/dAxeh.png)

## 在内容中

"orem ipsum dolor sit amet, consectetur* *1* * adipiscing elit. Vivamus blandit, ligula pharetra laoreet porta, nibh augue* *2* * fringilla tellus, et aliquet quam lacus mattis risus. Praesent rutrum, leo eu ornare sagittis,tellus ante blandit arcu。 "

## 页面结束

1 脚注信息

* * *

例如，用户将创建带有内容的组件，并且该组件将具有指向脚注组件的组件链接，并且在发布时它应该收集所有脚注并呈现。它应该与放置在内容本身中的数字相匹配。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T18:44:05.387

一种选择是使用支持锚`tridion:anchor`链接的链接，锚链接也是 Tridion RTF 提供的 OOTB。

围绕锚链接的文档：

[http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/task_INSHYP2DDAFF2CF95E4430AA0F27AD7A91B5F8](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/task_INSHYP2DDAFF2CF95E4430AA0F27AD7A91B5F8)

[http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/idheading-359728360](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/idheading-359728360)

其他选项，可能是编写一个自定义 TBB，它在页面末尾处理并生成锚标记。如果您有动态 CT，则此方法可能效果不佳，因为您可以独立发布它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T21:58:13.797

如果您能够依赖可用的 JavaScript，那可能是解决此问题的最直接方法。您可以简单地在隐藏元素中“在线”发布脚注，并在浏览器中编写所需的输出。

如果您想在 Tridion 中执行此操作，我建议您的页面模板可以先正常呈现组件演示文稿，然后使用“脚注”组件模板再次呈现相关组件。最难的部分是使数字正确，但您可以通过确保每次运行组件按照它们在页面中的顺序处理它们，然后使用上下文变量管理计数器来做到这一点。

标准的上下文变量技术在这种情况下不起作用，因为您依赖一个组件渲染能够“通知”下一个组件的位置。（当然，在脚注中重复整件事）。我[在 Tridion Practice 上写了一个简单的技术说明来解决这个问题](http://code.google.com/p/tridion-practice/wiki/PassContextFromOneComponentRenderToAnother)。这应该指明了方向，但我想您的实现将需要更加复杂。

编辑：我的回答假设您的脚注数据与其所指的文本位于同一组件中，但是在重新阅读您的问题时，我发现您有单独的组件。仍然 - 一些技术可能仍然适用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-26T13:20:25.233

根据您的实现模型（静态/动态/混合），您还可以选择在渲染时使用自定义控件生成这些：

```
Lorem ipsum dolor sit amet, consectetur<dominic:FootNote>Footnote text goes here</dominic:FootNote> adipiscing elit. 
Vivamus blandit, ligula pharetra laoreet porta, nibh augue<dominic:FootNote>Footnote text goes here</dominic:FootNote> fringilla tellus, 
et aliquet quam lacus mattis risus. Praesent rutrum, leo eu ornare sagittis, tellus ante blandit arcu. 
```

您将使用 FootnoteContainer 的页尾：

```
<dominic:FootNoteContainer /> 
```

脚注控件将为自己分配一个自动增量编号并呈现为

```
<sup><a href="#footnotes">number</a></sup> 
```

或任何您喜欢的脚注链接的呈现形式。

然后容器会找到页面上的所有脚注控件，并在列表中写出每个脚注的内部文本：

```
<ul>
  <li>number 1 footnote info</li>
  <li>...</li>
</ul> 
```

或类似的演示文稿表格。

这种方法的优点是它不依赖于静态的组件表示，它会大大简化您的模板化解决方案。缺点显然是你牺牲了一些请求性能......

# android - 在 Flex 中，如何访问 apk 中的打包文件？

> ID：13072933
> 
> 赞同：3
> 
> 时间：2012-10-25T16:19:55.283
> 
> 标签：android, actionscript-3, apache-flex, file, flash-builder

我正在使用 FlashBuilder 构建一个 android 应用程序，并且正在使用 sqlite 数据库，并且初始数据库应打包到 apk（Android 包）中。应用程序首次运行时，应将打包的数据库复制到“applicationDirectory”。

然而，问题来了。

使用 File.copyTo() 函数时，我可以使用 File.applicationStorageDirectory.resolvePath("xx.db") 作为目的地。但是，要复制的文件（从 apk 包中）怎么样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T16:04:45.513

您能否更具体地说明问题。当您尝试将文件（db）从应用程序目录复制到应用程序存储目录时，您是否收到了 IOError？你检查过打包的apk的内容吗？为什么不考虑在应用程序启动时在 app-storage 目录中创建数据库，因为该应用程序目录非常保护其内容。

你真正想要达到什么目的？

PS 请记住，应用程序目录是只读的。因此，您的代码无法写入驻留在该目录中的文件。

# java - 我应该继续在 JSP 中打开和关闭连接吗

> ID：13072935
> 
> 赞同：0
> 
> 时间：2012-10-25T16:20:12.570
> 
> 标签：java, sql, jsp

我创建了一个名为 MySQL 的类。

这个类只包含 1 个方法，它将我连接到我的数据库。

```
public static void Connect() {
    try {
        Class.forName("com.mysql.jdbc.Driver");
    } catch (ClassNotFoundException ex) {
        System.out.println(ex.getMessage());
    }
    try {

        connection = (Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/"+database,username,password);

    } catch (SQLException ex) {
        System.out.println(ex.getMessage());
    }
} 
```

所以现在，当我需要在 JSP 页面内部进行连接时，我会写这个。

```
<% MySQL.Connect();
   Statement stmt = MySQL.getConnection().createStatement();
   ResultSet rset = stmt.executeQuery("....");
   //Some codes here
   //Then I close both rset and stmt
   rset.close();
   stmt.close();
%> 
```

我也应该关闭连接吗？请注意，加载页面时会执行更多查询，我应该为所有查询处理 1 个连接还是为每个查询处理 1 个连接然后关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:24:19.933

理想情况下，您只需在呈现页面期间使用一个连接，然后在页面末尾关闭它。

这样做的效果是确保一旦您开始呈现页面，您就可以完成，因为您不会由于连接池耗尽而在中途丢失连接（并且您应该使用连接池而不是直接建立连接，如果您重视您的页面性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:56:26.643

**1、**直接在jsp中获取连接不是个好主意。

**2，**无需为要在同一页面中执行的每个查询创建单独的连接。这也基于您对该连接执行的操作。

**3，**无论你在哪里打开连接，连接都必须关闭。否则会出现泄漏问题。

**4，**在关闭连接之前确保它们不为空。所以空值检查很重要，否则你可能会得到空指针异常。

**5，**在finally块中关闭连接，这样当对象被垃圾收集时，就不会再有基于连接的操作了。在 finally 块中完成关闭连接工作。*

# multithreading - matlab多线程函数

> ID：13072936
> 
> 赞同：1
> 
> 时间：2012-10-25T16:20:14.987
> 
> 标签：multithreading, matlab

“排序”是 matlab(R2010a) 中利用多线程的内置函数之一。当我在大型矩阵上使用“排序”时，在具有 8 个内核的机器上，我可以看到所有内核都已激活，但每个内核报告的 cpu 使用率从未超过 25%。虽然我自己的 openmp “mex” 完全使用了所有内核。有没有办法强制 matlab 使用 all ？

提前致谢，

卡姆兰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T06:19:43.600

这并不意味着您的代码中的线程一直都在工作，而在 MATLAB 中的线程并没有那么多工作。您可以在代码 ( ) 内的某些锁/互斥锁上旋转（主动等待）`#pragma omp barrier`，而 matlab 的线程可能正在休眠。效果是一样的 - 线程等待，但在您的情况下，您将看到 100% 的 cpu 使用率。

MATLAB 没有显示“使用 100% 的 cpu”的开关。这是由操作系统决定的。如果线程有工作，它们就会运行。根据您的描述，我会说matlabs中的线程经常对睡眠进行排序。

所以无论 MATLAB 做什么，它至少会尽力做到最好。如果你的速度几乎和 matlab 一样快 - 恭喜！对你有益 ：）

# javascript - 在 ajax 成功和内联 datepicker 的 beforeShowDay 上使用 datepicker('refresh')？

> ID：13072937
> 
> 赞同：0
> 
> 时间：2012-10-25T16:20:21.593
> 
> 标签：javascript, ajax, jquery-ui, jquery

我正在使用 jquery 和 jquery ui 1.8.7。我在页面加载时创建了一个内联日期选择器，然后在我的 ajax 成功函数中，我调用 $('#mydiv').datepicker('refresh'); （我将在下面发布代码）。

如果数据已从 ajax 返回（例如在刷新时），则 beforeShowDay 调用 highlightDays() 函数。我知道在一切崩溃停止之前，我用正确的数据两次点击 highlightDays，我收到错误“TypeError：无法读取未定义的属性 0”。

似乎事件数组在一段时间后被破坏了，但我对 ajax 的了解还不够，无法真正说出发生了什么。谁能指出我正确的方向来解决这个问题？

```
 function highlightDays(date) {
                var day = date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate();
                console.log(typeof(events)); // This will return as an object twice before throwing an the above mentioned error
                if($.inArray(day, events) !== -1) {
                    return new Array(true, '');
                } else {
                    return new Array(false, '');
                }   
        }    
        function getEventData() {
                return $.ajax({
                    url: Drupal.settings.basePath + 'correct_path', 
                    data: search+'&path='+window.location.pathname,
                    dataType: 'json',
                    type: 'POST',
                    success: function(data, textStatus, jqXHR) {        
                        // save our returned data
                        events = new Object();
                        events = data;
                        $('#mydiv').datepicker("refresh");
                    }
                });
            }   

        function createDatepicker() {

            // Attach datepicker to the parent div so it returns as 
            // inline.
            $('#mydiv').datepicker({
                dateFormat: 'yy-mm-dd',
                speed: 'immediate',
                altField: '#edit-date-filter-value-datepicker-popup-1',
                beforeShowDay: function(date) {
                      if(typeof (_event_days) === 'undefined') {
                        return new Array(true, '');
                      } else {
                            highlightDays(date);
                        }
                    },
            });
            $('#myinput').hide();
        }   
getEventData();
createDatepicker(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T18:49:49.090

以下代码最终为我工作。两个很大的区别。重新设计 highlightDays 函数并将所有从 ajax 调用返回的数据添加到全局事件数组中，以便稍后在 highlightDays 中使用。

```
var events = [];
function highlightDays(date) {
        var dayClass = [true, ''];
          var date = $.datepicker.formatDate('yy-mm-dd', new Date(date));                     
                  $.each(events, function(key, value) { 
                    if (date === value[0])  {
                       dayClass = [true, "ui-state-highlight"];
                       return dayClass;

                    } else {
                        return dayClass;
                    }
                 });
              return dayClass;
          }

        function getEventData() {
            return $.ajax({
                url: 'myurl', 
                data: search+'&path='+window.location.pathname,
                dataType: 'json',
                type: 'POST',
                success: function(data, textStatus, jqXHR) {        
                    $.each(data, function (index, value) {
                       events.push([value]);
                    });
                          // popup is the date input field
                          // attaching datepicker to the parent div makes 
                          // it an inline picker    
                          popup.parent().datepicker('refresh');
                }
            });
        }

        function createDatepicker() {

           popup.parent().datepicker({
                dateFormat: 'yy-mm-dd',
                 beforeShowDay: highlightDays

            });
            popup.hide();
        }

        function getSearchString() {
            // Return a search string to pass to the ajax call
            var search = window.location.search;
            if(search !== '') {
                while(search.charAt(0) === '?') {
                    // remove the leading question mark in the search string
                    search = search.substr(1);
                }
            }
            return search;
        }

        // If our popup selector exists, create the datepicker and get event data
        if (popup.length) {     
            var search = getSearchString();
            getEventData();
            createDatepicker();
        } 
```

# javascript - 定义和访问 jQuery 插件的变量

> ID：13072946
> 
> 赞同：0
> 
> 时间：2012-10-25T16:20:45.970
> 
> 标签：javascript, jquery

我想知道是否有一种方法可以为 jQuery 插件定义变量并使其可以从外部查看。（用于调试目的）

我希望这个插件可能在多个 DOM 元素上被调用，所以我的想法是每次调用都会维护自己的一组变量。

我希望像这样检查 Firebug 中的变量值：

```
$('#hp-feat-promo').featuredPromo.moduleValues.totalNumSlides 
```

但这不起作用。任何想法这将如何工作，或者我的理解是错误的？

```
(function($){
$.fn.featuredPromo = function (options) {

    /* Inside a jQuery plugin this refers to the jQuery object
     * Inside of the nested function declarations, this refers to the local object, so if 
     * you still want to refer to the original DOM object, you need to hhave a pointer to the top-level this 
     */
    var self = this;

    /* Create some defaults, extending them with any options that were provided */
    var defaults = {
        targetElement: self.find('.window ul li'),
        isAuto: true
    },
    settings = '';

    /* settings is all the configurable parameters, defaults + options (overrides) */
    settings = $.extend(defaults, options);

    this.moduleValues = {
        totalNumSlides: settings.targetElement.length,
        autoRotate: settings.isAuto,
        currentSlide: 0,
        nextSlide: function() {
        },
        prevSlide: function() {
        }       
    };

    return this.each(function() {

    });
};

jQuery(function(){
    $('#hp-feat-promo').featuredPromo();
});
 })(jQuery); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:38:29.313

您需要创建一个全局变量或作为任何全局可访问对象（例如 jQuery）的成员的变量。

```
/* inside plugin */
jQuery.debugMessage = this.moduleValues = {};

/* outside plugin */
console.log( jQuery.debugMessage ); 
```

[或者你可以在你的插件中](https://stackoverflow.com/questions/1204822/jquery-plugin-public-method-function)设置一个公共的 getter 函数。

但是您不能仅`console.log()`用于从函数内部进行调试吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T14:30:11.607

我发现在本文的“轻量级开始”中描述了完成我想要的最佳方法。 [http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/](http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/)

基本上，创建一个包含我的变量的类，然后添加到使用插件的 HTML 元素的 $.data() 中。

# java - 集合添加方法问题的无序拖车链表实现

> ID：13072947
> 
> 赞同：1
> 
> 时间：2012-10-25T16:20:53.693
> 
> 标签：java

我有一个添加方法来创建一个无序的链表，并且有一个由定义的拖车节点

```
 ListNode<E> front = new ListNode<E>(null,null); 
```

据我了解，我可以继续将值添加到列表的前面，但是因为这是 Set 的 Linked List 实现并且我不能有重复的值，所以我需要检查集合（从前面到拖车的每个 listnode节点）以确保它没有我要添加到列表中的新值。这是我的添加方法。

```
public boolean add(E e) {

  ListNode<E> newNode = new ListNode<E>(e, null);

      //point to trailer      
      newNode.next = front.next;
      //front now points to newNode
      front.next = newNode;
      //front->newNode->trailer

       objectCount++;

        return true; 
```

}

现在，要检查 newNode 是否不在链接列表中，我需要实现一个 contains 方法，该方法检查列表中的每个元素，如果它在链接列表中则返回 true。如果它返回 true，那么我不执行上面的 add 方法，如果不执行，那么我成功添加了值。所以，我在想一些事情：

```
 if(this.contains(newNode))
   return false;
 else {
   newNode.next = front.next;
   front.next = newNode;
  } 
```

但我不知道如何成功实现我的 contains 方法。这是我所拥有的：

```
public boolean contains(Object o) {
   ListNode<E> o1 = (ListNode<E>) o;
  if (o1.value == front.next.value)
          return true;
      else
          return false;
} 
```

我不确定如何使方法包含，检查每个节点的 Object o，如果它在链表中则返回 true，否则返回 false。那么，展望未来，我对如何实现这一点的理解是否正确？以及如何修复我的 contains 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:28:46.710

每个节点都知道它之前和之后是什么。因此：

遍历所有以前的节点，直到没有人为止，检查它们。

遍历所有以下节点，直到没有人为止，检查它们。

（因为这听起来像是一个练习，没有代码。但你只需要将书面文字“翻译”成代码）

--待定

# java - 多个 Hibernate 数据源

> ID：13072948
> 
> 赞同：1
> 
> 时间：2012-10-25T16:20:54.350
> 
> 标签：java, database, spring, hibernate, sessionfactory

我有一个项目，目前在同一数据库服务器上使用 3 个数据库。一个数据库现在已移动到另一台物理服务器，我正在尝试让休眠状态来处理这个问题，但很难确定从哪里开始 - 我应该复制数据源、会话工厂、休眠模板和事务管理器，然后尝试管理这个在代码中？我正在使用 Spring 3 和 Hibernate 3.5。这是常见的事情吗？任何建议将不胜感激。

如果它有助于我的配置当前如下所示：

```
<bean id="datasource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
    <property name="url" value="jdbc:mysql://localhost:3306/DatabaseOne"/>
    <property name="username" value="username"/>
    <property name="password" value="password"/>
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="datasource"/>
    <property name="exposeTransactionAwareSessionFactory"><value>true</value></property>
    <property name="annotatedClasses">
        <list>
            <value>domain.DatabaseOneObject</value>
            <value>domain.DatabaseTwoObject</value>
            <value>domain.DatabaseThreeObject</value>
        </list>
    </property>
</bean>

<bean id="hibernateTemplate" class="org.springframework.orm.hibernate3.HibernateTemplate">
    <property name="sessionFactory" ref="sessionFactory"/>
</bean>

<bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T18:57:27.333

也许您可以使用 Sequoia（以前称为[C-JDBC](http://c-jdbc.ow2.org/howdoesitwork.html)）将您的模式从不同的数据库聚集到一个逻辑数据库中。

# python - 在 python 中从 SQLite 数据库中检索值的一些错误

> ID：13072952
> 
> 赞同：2
> 
> 时间：2012-10-25T16:21:03.023
> 
> 标签：python, sqlite

我正在尝试在数据库中插入元组。它不会在代码中给出任何错误。但是在打印整行时输出包含一些虚拟字符。输出也复制到帖子中。请帮助我找出代码中的错误。这是一个大型项目的虚拟代码。

代码：

```
import sqlite3 as sql

def foo():
    db = sql.connect('test.db')
    db.execute('drop table if exists test')
    db.execute('create table test (t1 text, i1 int)')

    str = """insert into test(t1,i1) values ('one',1 ) """
    db.execute(str)
    db.execute('insert into test(t1,i1) values (?, ?)', ('two',2))

    db.commit()

    cursor = db.execute('select * from test')

    for row in cursor:
        print row 
```

输出：

```
(u'one', 1)
(u'two', 2) 
```

如输出所示，代码的预期输出是两个元素的元组。相反，输出中有一些字符“u”。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:22:51.790

字符串上的`u`前缀意味着它是一个[Unicode 字符串](http://docs.python.org/howto/unicode.html)，你仍然有一个预期的两元素元组。

By default the sqlite3 module returns text as Unicode strings. If you want to receive byte strings encoded in utf-8 instead, you can set the connection's [`text_factory`](http://docs.python.org/library/sqlite3.html#sqlite3.Connection.text_factory) attribute to `str`.

# java - 搜索索引函数不返回值

> ID：13072954
> 
> 赞同：0
> 
> 时间：2012-10-25T16:21:07.380
> 
> 标签：java, actionscript-3

我想从列表/数组中搜索或选择特定项目。所以在构建Flash中的AS3搜索功能时，我卡住了..请帮忙解决这个问题...提前谢谢

```
var ar:Array = new Array();
ar=[ "bhati", "malav", "vinod"];

//Searching Function
function findIndexOfValue( array:Array, _value:* ):int {
    var _length:uint = array.length;
    for(var i:uint=0; i < _length; i++) {
        if(array[i] == _value) {
            return i;
        }
        else{
            return -1;
        }
    }
}

trace(findInndexOfValue( ar, "bhati" )); // it should output 0 .
//compiler error:- 1170:Function doesn't return a value., I tried my best, but unable to solve this. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:28:58.067

为什么要为此烦恼？此功能内置于 AS3 中的 Array 类中（以及大多数，如果不是全部的话，OOP 语言）。

```
trace( this.ar.indexOf( "bhati" ) ); //will output 0 
```

[数组#indexOf()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Array.html#indexOf%28%29)

至于为什么你的脚本不起作用，你必须返回一个值。您不能在条件或循环中获得所有回报。在函数的基本级别内必须有一个返回。

编辑：只是仔细看看你的函数，它有更多的错误，而不仅仅是返回。您永远不会超出数组中的第一项，因为它总是会返回一个值（感谢 else 条件）。只需删除 else 位并将其中的 return 移到 for 循环运行后，您将大致了解 indexOf 的工作方式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:29:31.270

怎么样

```
function findIndexOfValue( array:Array, _value:* ):int {
    var _length:uint = array.length;
    for(var i:uint=0; i < _length; i++) {
        if(array[i] == _value) {
            return i;
        }
    }
    return -1;
} 
```

# jquery - 有没有办法检查链接是否被点击？

> ID：13072956
> 
> 赞同：0
> 
> 时间：2012-10-25T16:21:15.127
> 
> 标签：jquery, click, focus, if-statement

我想使用 .focus() 将滑块推进到下一个屏幕。我有下一步和后退按钮。如果用户单击下一个按钮，**我不希望**.focus() 函数推进滑块。但是，如果焦点在下一个按钮上，我希望焦点触发下一个按钮 .click() 功能。

这就是我现在的方式。当我将焦点放在下一个按钮上时，滑块会前进。当我单击下一个按钮时，滑块会前进两次。

```
$(".nextbutton4").focus(function() {
     $(".nextbutton4").click();
}); 
```

我想出了另一个带有 if-else 语句的 focus() 函数版本，但它不起作用。

```
// This allows a tab advancement to trigger the next action
$(".nextbutton4").focus(function() {
    if (//This is where I would like to check whether the button was clicked) {
          alert('Next Button is Clicked');
          // Do Nothing
    }
    else {
          alert('Next Button Not Clicked');
          $(".nextbutton4").click();
     }  
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:23:24.573

当用户单击链接时，您可以尝试添加一个类：

```
$('.nextbutton4').click(function() { $(this).addClass('clicked'); }); 
```

然后简单地检查它是否有类：

```
// This allows a tab advancement to trigger the next action
$(".nextbutton4").focus(function() 
{
    if ($(this).hasClass('clicked')) 
    {
          alert('Next Button is Clicked');
          // Do Nothing
    }
    else 
    {
          alert('Next Button Not Clicked');
          $(this).click();
     }  
}); 
```

# android - Webview shouldoverrideurlloading 不起作用

> ID：13072960
> 
> 赞同：2
> 
> 时间：2012-10-25T16:21:28.963
> 
> 标签：android, hyperlink, android-webview, webviewclient

我的应用程序中有此代码：

```
public class Home extends Activity{
@Override 
public void onCreate(Bundle savedInstanceState){ 
    super.onCreate(savedInstanceState); 
    setContentView(R.layout.home);
    final ProgressDialog progressBar;
    if(isOnline()){
        WebView webView = (WebView) findViewById(R.id.home_web);
        webView.setBackgroundColor(Color.parseColor(getString(R.color.colore_bg)));
        webView.getSettings().setJavaScriptEnabled(true);
        webView.getSettings().setBuiltInZoomControls(true);
        webView.getSettings().setPluginsEnabled(true);
        webView.setWebViewClient(new MyWebViewClient());
        progressBar = ProgressDialog.show(this,getString(R.string.caricamento),getString(R.string.attendere));
        webView.setWebViewClient(new WebViewClient(){
            public void onPageFinished(WebView view, String url) {
                if (progressBar.isShowing()) {
                    progressBar.dismiss();
                }
            }
        });
        webView.loadUrl("http://www.mysite.com/android.php");
    }else{
        Toast.makeText(this,getString(R.string.no_connessione),Toast.LENGTH_LONG).show();
    }
}
private class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
            System.out.println("here");
        if (Uri.parse(url).getHost().equals("mysite.com")) {
            // This is my web site, so do not override; let my WebView load the page
            return false;
        }
        // Otherwise, the link is not for a page on my site, so launch another Activity that handles URLs
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
        startActivity(intent);
        return true;
    }
}
public boolean isOnline(){
    ConnectivityManager cm=(ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo ni = cm.getActiveNetworkInfo();
    if(ni==null){
        return false;
    }
    return ni.isConnected();
}
} 
```

shouldOverrideUrlLoading 不起作用，也不打印 system.out，它似乎从未被调用过。我该如何修复这个？我需要在默认浏览器中打开所有链接（除了主页 www.mysite.com/iphone.php）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T16:29:42.277

您已设置 WebViewClient 两次，因此将第一个 (shouldOverrideUrlLoading) 替换为第二个 (onPageFinished)。将两者结合起来使其工作：

```
public class Home extends Activity{
private ProgressDialog progressBar;

@Override 
public void onCreate(Bundle savedInstanceState){ 
    super.onCreate(savedInstanceState); 
    setContentView(R.layout.home);
    if(isOnline()){
        progressBar = ProgressDialog.show(this,getString(R.string.caricamento),getString(R.string.attendere));
        WebView webView = (WebView) findViewById(R.id.home_web);
        webView.setBackgroundColor(Color.parseColor(getString(R.color.colore_bg)));
        webView.getSettings().setJavaScriptEnabled(true);
        webView.getSettings().setBuiltInZoomControls(true);
        webView.getSettings().setPluginsEnabled(true);
        webView.setWebViewClient(new MyWebViewClient());
        webView.loadUrl("http://www.mysite.com/android.php");
    }else{
        Toast.makeText(this,getString(R.string.no_connessione),Toast.LENGTH_LONG).show();
    }
}

private class MyWebViewClient extends WebViewClient {

    @Override
    public void onPageFinished(WebView view, String url) {
        if (progressBar != null && progressBar.isShowing()) {
            progressBar.dismiss();
        }
    }

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
            System.out.println("here");
        if (Uri.parse(url).getHost().equals("mysite.com")) {
            // This is my web site, so do not override; let my WebView load the page
            return false;
        }
        // Otherwise, the link is not for a page on my site, so launch another Activity that handles URLs
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
        startActivity(intent);
        return true;
    }
}
} 
```

（请忽略错误的格式：p）

# html - HTML5 视频上的容器（画布）

> ID：13072965
> 
> 赞同：2
> 
> 时间：2012-10-25T16:21:46.563
> 
> 标签：html, video, canvas, containers, kineticjs

使用 HTML5 Canvas 时，我可以使用以下内容在我的 HTML5 视频上设置 Canvas。

```
<video id ="video1" width="320" height="300"  controls="controls" style="position:absolute; top: 10; left: 10;" >

<canvas id="canvas3" width="320" height="240" style="position:absolute; top: 10; left: 10;" >
</canvas> 
```

我怎样才能使用 KineticJS 做同样的事情？我没有看到使用 KinetcJS 设置容器（画布）位置的选项。

我有以下内容：

```
var myStage = new Kinetic.Stage(canvas3, 100);
        var stage = new Kinetic.Stage({
          container: "container",
          width: 320,
          height: 240
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T16:23:23.100

从 KineticJS 文档中，[`Kinetic.Stage`](http://www.kineticjs.com/docs/symbols/Kinetic.Stage.php)借用了[`setAbsolutePosition`](http://www.kineticjs.com/docs/symbols/Kinetic.Node.php#setAbsolutePosition)from `Kinetic.Node`。您可以使用它来设置节点的 x 和 y 位置。

[测试演示](http://jsfiddle.net/wGbxc/)。使用 WebKit 控制台查看视频元素和画布在同一个位置。

# css - 更少的 CSS IE 定位？

> ID：13072967
> 
> 赞同：5
> 
> 时间：2012-10-25T16:21:51.383
> 
> 标签：css, less

在 LESS 中定位 IE7、8 等的最佳方法是什么？

是否有针对它们的方法，或者我理想情况下是否需要加载单独的样式表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T16:26:52.497

据我所知，LESS 不允许您针对特定浏览器，仅针对媒体大小。

您需要执行以下操作：

```
<!--[if IE]>
<link rel="stylesheet/less" type="text/css" href="ie.less" />
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T17:21:20.340

使用 Paul Irish 的 IE 定位方法可以让您的 IE 规则充分利用嵌套在您的 main less 文件中。[http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/](http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T02:11:53.193

使用 Scott Simpson 也链接的 Paul Irish 的技术，您可以非常轻松地在 CSS 的其余部分旁边包含目标选择器。例如：

```
div {
  display: inline-block;

  .ie-8 & {
    zoom: 1;
    display: inline;
  }
} 
```

您编译的 CSS 将是：

```
div { display: inline-block; }
.ie-8 div { display: inline; zoom: 1; } 
```

我发现这种技术比分离样式表更可取，因为它更容易跟踪您的 IE 特定 CSS。

# html - HTML：在单元格的顶部和底部对齐图像

> ID：13072972
> 
> 赞同：1
> 
> 时间：2012-10-25T16:22:06.343
> 
> 标签：html, html-table

我需要创建一个包含 2 个单元格（或 2 个 div。没关系）的表格，它将包含在 TD 标记中，如下所示：

```
<td style="height:200px;">
    <table>
         <tr>
              <td>Top Cell</td>                  
         </tr>
         <tr>
              <td>Bottom Cell</td>
         </tr>
    </table>
</td> 
```

每个单元格将包含 1 张图像（见下图）。然而，我的问题是，无论父 TD 标签的高度如何，顶部单元格中的图像始终需要位于最顶部，而底部单元格中的图像始终需要位于最底部。因此，在下面的示例中，假设示例 #1 的父 TD 标记为 200 像素高度。图像与其单元格的顶部和底部对齐。如果我将 TD 标签的高度切换为 800 像素（示例 #2），那么图像仍应正确对齐。

[对齐示例 http://functionalevaluations.com/images/imagealignment.jpg](http://functionalevaluations.com/images/imagealignment.jpg)

我还应该提到，我不能将高度硬编码到表格本身中。表格的高度总是需要是父 TD 标签的 100%，我可以手动调整高度值的唯一值是在父 TD 中。

我怎样才能做到这一点？哦，这也无关紧要，如果这是一个表或 div 或其他什么。唯一需要的是父 TD 标签。

最后，这是我当前的 HTML。我的父母 TD 调整得很好，但是我的桌子的高度总是不超过我的 2 张图像的高度。我似乎无法让它与父 TD 的高度相同：

```
 <td width="155" valign="top" rowspan="2" style="border:solid 1px #000;height:200px; ">
        <table border="1" cellspacing="0" cellpadding="0" style="height: 100%;">
            <tr>
                <td valign="top" style="height:50%;">

                        <img src='includes/images/itemImages/TopImage.jpg' border="0" 
                            style="vertical-align: top">
                </td>
            </tr>
            <tr>
                <td valign="bottom" style="height:50%;">
                    <img src='includes/images/itemImages/bottomImage.jpg' border="0" style="vertical-align: bottom">
                </td>
            </tr>
        </table>

    </td> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-25T16:30:11.077

试试这个 -[**演示**](http://jsfiddle.net/LHbNp/2/)

***HTML***

```
<table border="1" cellspacing="0" cellpadding="0">
    <tr>
        <td class="top">
            <img src='http://lorempixel.com/100/100' />
        </td>
    </tr>
    <tr>
        <td class="bottom">
            <img src='http://lorempixel.com/100/100' />
        </td>
    </tr>
</table> 
```

***CSS***

```
img {
    display: block;
    margin: auto;
}

.top { vertical-align: top; }
.bottom { vertical-align: bottom; } 
```

# tridion - 如何获取核心服务的用户列表？

> ID：13072974
> 
> 赞同：8
> 
> 时间：2012-10-25T16:22:08.873
> 
> 标签：tridion, tridion-2011

我正在尝试从核心服务中获取可用用户的列表。我花了很多时间研究可用的服务方法，最明显的似乎是：

```
TrusteesFilterData trusteesFilterData = new TrusteesFilterData
                                        {
                                            BaseColumns = ListBaseColumns.IdAndTitle,
                                            IsPredefined = false,
                                            ItemType = ItemType.User
                                        };
XElement listTrustees = client.GetSystemWideListXml(trusteesFilterData); 
```

但是，代码在调用 GetSystemWideListXml - 时会引发错误`Unable to create Abstract Class`。我是否使用了正确的方法，如果是，我做错了什么？如果没有，我应该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T16:42:06.197

查看开源项目中的示例以获取工作流通知

[http://code.google.com/p/tridion-notification-framework/source/browse/NotificationService/NotificationService/Worker.cs](http://code.google.com/p/tridion-notification-framework/source/browse/NotificationService/NotificationService/Worker.cs)

DoWork() 方法中的第 22 - 26 行应该做你需要的 - 我认为需要使用`UsersFilterData`而不是`TrusteesFilterData`

```
var users = client.GetSystemWideList(new UsersFilterData { BaseColumns = ListBaseColumns.IdAndTitle, IsPredefined = false }); 
```

# php - 仅适用于某些字符的正则表达式

> ID：13072975
> 
> 赞同：-2
> 
> 时间：2012-10-25T16:22:12.333
> 
> 标签：php, regex

我想知道是否有人知道一个有很多正则表达式示例的网站？

我该如何修改这个声明白色，以我的理解只允许字母数字和空格，还包括：,.?! `'" ;: -_=+ /| @#$%^&*

```
$output = preg_replace("/[^A-Za-z0-9 ]/", "", $input); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T18:49:51.573

This website - www.regular-expressions.info/tutorial.html provides systematic way of learning RegExp. You can also use expresso to practice regex....however the usablity of regex defers from language to language. This website - www.regular-expressions.info/tutorial.html provides you a good base.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:26:27.490

该模式本身**不允许**字母、数字和空格，但该命令会删除任何“允许”的内容，因此该命令只留下这些字符。无论如何，这也将包括其他字符：

```
$output = preg_replace('/[^A-Za-z0-9 ,.?!`\'";:_=+\/|@#$%^&*-]/', "", $input); 
```

查看[本网站](http://www.regular-expressions.info/)的教程和示例部分！

# python - python循环查询

> ID：13072976
> 
> 赞同：0
> 
> 时间：2012-10-25T16:22:12.850
> 
> 标签：python, loops, while-loop

```
i= 1
while (i<=3):
    print("i",i)
    j=1
    while (j<3):
        print("j",j)
        j=j+1
    i=i+1
print("Done!") 
```

现在我想知道？为什么输出不是：i1 j1 j2 i2 i3

而是：i1 j1 j2 i2 j1 j2 i3 j1 j2

为什么最右边的 while 循环会不断重复，即使 j 的值最终已经被它满足了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:24:46.923

那是因为。您正在外部 while 循环中重新初始化您的`j`to `1`。所以，每次你的外循环开始时，你的内循环都会运行两次。

```
while (i<=3):
    print("i",i)
    j=1 <-- This re-initializes the value of `j`
    while (j<3):
        print("j",j)
        j=j+1
    i=i+1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:24:51.690

这最好通过使用跟踪表来解释

1）所有变量和条件都沿顶部排列

2）每次变量/条件发生变化时，您向下一行并输入表格

![在此处输入图像描述](../Images/67f3891c08adf4c2a9ac82036a7d85fb.png)

第 1 行： i 被初始化为 1

第 2 行：条件 i <=3 为真，因此将跟踪表向下添加一行

第 3 行： j 初始化为 1

第 4-8 行，内部 while 循环运行直到 j<3 变为 false

发生的事情是 out while 循环运行一次，它遇到另一个缩进的 while 循环，该循环必须在 i 下一次递增之前运行它的过程。

算法复杂性的一个副作用或有趣的一点是，内部 while 循环将运行外部 while 循环运行的次数。这是 N * N 的顺序。您可以从真值表中看到这是正确的。内部 while 运行了三次（实际上不是 n 次，而是 N-1），因为 j 在第三次迭代之前停止。

# ms-access - 为访问计算引入计划

> ID：13072978
> 
> 赞同：2
> 
> 时间：2012-10-25T16:22:22.257
> 
> 标签：ms-access, schedule

我真的不知道如何问这个问题或给它命名，但我走了。我在学校系统工作，我为一些心理学家创建了一个数据库，用于跟踪他们的推荐。根据州规定，他们有 60 天的时间从第一次会议之日起完成该过程。周末仍然算数，但假期不算数。我真的不知道如何使用我们拥有的日历，以便我们进行准确的计算。例如，考虑到假期，如果一个孩子今天开始，他需要在 2013 年 1 月 18 日完成所有事情，即根据我们的日程安排从现在起 60 天。有谁知道我应该从哪里开始？

编辑

好的，所以我现在有一个日历表。这是我的问题。我有我的专栏，我曾经指出在计算我的 60 天时使用了哪些天。周末可用于该计算。但是，它们不能在结果中使用。如果第 60 天是星期日或星期六，则日期需要提前到星期五。我想我的第一个问题真的是，如何将我的计算限制在日历表中的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:25:24.067

使用日历表可以很容易地做到这一点。

```
PARAMETERS start_date DateTime;
SELECT TOP 1 sub.the_date
FROM
    (
        SELECT TOP 60 the_date
        FROM tblCalendar
        WHERE
                the_date>=[start_date]
            AND work_day=True
        ORDER BY the_date
    ) AS sub
ORDER BY sub.the_date DESC; 
```

该查询基于您为要评估的日期设置的`work_day`假设`True`。IOW，`work_day`仅`False`适用于您组织的假期。

有关创建和加载日历表的示例代码，请参阅[在 Access 查询中使用开始日期和结束日期中](https://stackoverflow.com/a/9303628/77335)`CreateTable_calendar()`的和`LoadCalendar()`过程。要最初将包括周末在内的所有日期分配为工作日，请在.`LoadCalendar()`

```
'rs!work_day = Not (Weekday(dte) = vbSunday Or _
'    Weekday(dte) = vbSaturday)
rs!work_day = True 
```

最后，手动编辑表格以更改`work_day`为`False`您的假期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:26:41.983

您可以检查工作日以确保您没有选择周末：

```
SELECT TOP 1 CalDate, WDay 
FROM (SELECT Top 60 c.CalDate,Weekday([Caldate]) AS WDay
      FROM Calendar c
      WHERE c.Holiday=False) a
WHERE WDay Not In (1,7)
ORDER BY CalDate DESC 
```

# c++ - 当 msimg32.dll 的 loadlibrary 和 GetProcAddress 时，变量“libName”周围的堆栈已损坏

> ID：13072980
> 
> 赞同：1
> 
> 时间：2012-10-25T16:22:31.560
> 
> 标签：c++, com, visual-c++

我正在开发像 MSN Plus 这样的实时信使插件。我将使用代理连接到 MSN `msimg32.dll`。与 Internet 中的其他代理示例不同`msimg32.dll`，其中导出的函数在 中检索`DLLMain`，因为 MSDN 表示`LoadLibrary`在`DLLMain`. 这已通过测试确认，在自定义`msimg32.dll`范围内加载系统将导致访问冲突。`DllMain``msimg32.dll`

我的方法是加载`c:\windows\system32\msimg32.dll`一个导出的函数，我在 MSN plus 的`msimg32.dll`. 但是我在函数中面临一个严重错误，返回时`GetMsimg32FnAddr`变量`libName`已损坏`GetMsimg32FnAddr`。

我的问题是如何避免我的源代码中的堆栈损坏。此外，我关于代理的想法可以`msimg32.dll`吗？

我的开发环境是：VS2005，win7企业版，32位。最新版本的 Live Messenger。最新版本的 MSN 加。

VS2005 报告：

> 运行时检查失败 #2 - 变量“libName”周围的堆栈已损坏。

`GetMsimg32FnAddr`返回时

以下是我的代理源代码`msimg32.dll`。

`msimgproxy.h`：

```
/*****************************************************************************/
#ifndef MSIMGPROXY_H
#define MSIMGPROXY_H
#include <windows.h>
#pragma warning( disable:4273 ) // Silence compiler

//
// Function pointer typedefs for exports we are forwarding              
//
typedef BOOL (WINAPI *PFNTRANSPARENTBLT) (HDC,int,int,int,int,HDC,int,int,int,int,UINT);
typedef VOID (WINAPI *PFNVSETDDRAWFLAG)  (VOID);
typedef BOOL (WINAPI *PFNALPHABLEND)    (HDC,int,int,int,int,HDC,int,int,int,int,BLENDFUNCTION);
typedef BOOL (WINAPI *PFNGRADIENTFILL)  (HDC,PTRIVERTEX,ULONG,PVOID,ULONG,ULONG);
typedef BOOL (WINAPI *PFNDLLINITIALIZE)(HINSTANCE, DWORD, LPVOID);

// Function pointer typedef to injected-DLL initialization
typedef void (*PFNINIT) (void); 

#ifdef __cplusplus
extern "C" 
{
#endif 
    //
    // Function protoypes
    //
    BOOL WINAPI TransparentBlt(HDC, int, int, int, int, HDC, int, int, int, int, UINT);
    BOOL WINAPI AlphaBlend    (HDC, int , int, int, int, HDC, int , int, int, int, BLENDFUNCTION);
    BOOL WINAPI GradientFill  (HDC, PTRIVERTEX, ULONG, PVOID, ULONG, ULONG);
    BOOL WINAPI DllInitialize (HINSTANCE, DWORD, LPVOID);
    VOID WINAPI vSetDdrawflag (VOID);

#ifdef __cplusplus
}
#endif // __CPLUSPLUS
#endif // MSIMGPROXY_H 
```

`DllMain.cpp`：

```
#include "msimgproxy.h"
#include <tchar.h>

PFNTRANSPARENTBLT   pfnTransparentBlt   = NULL;
PFNALPHABLEND       pfnAlphaBlend       = NULL;
PFNDLLINITIALIZE    pfnDllInitialize    = NULL;
PFNGRADIENTFILL     pfnGradientFill     = NULL;
PFNVSETDDRAWFLAG    pfnVSetDdrawFlag    = NULL;
PFNINIT             pfnInit             = NULL;

bool        GetMsimg32FnAddr();
HMODULE     hMsimg32 = NULL;
HMODULE     hPlugDll = NULL;

TCHAR pszInjDllName[] = TEXT("msg_plugin.dll");

/************************************************************************/
/*                                                                      */
/* Proxy DLL Entry point                                                */
/*                                                                      */
/************************************************************************/

BOOL APIENTRY DllMain( HMODULE hModule, DWORD ul_reason_for_call, 
                      LPVOID lpReserved )
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:        
        {
            /*
            if (!GetMsimg32FnAddr())
            {
                OutputDebugString (TEXT("MSIMG32 Proxy: GetMsimg32FnAddr() failed\n"));
                return FALSE;
            }
            */

            OutputDebugString(TEXT("MSIMG32 Proxy: DLL attached\n"));

            // Load injected DLL and execute it's initialization function           
            if (! (hPlugDll = LoadLibrary(pszInjDllName)))
            {
                OutputDebugString (TEXT("MSIMG32 Proxy: Cannot load inject-DLL\n"));
                //return FALSE;
            }

            if (! (pfnInit = (PFNINIT) GetProcAddress (hPlugDll, "Init")))
            {
                OutputDebugString (TEXT("MSIMG32 Proxy: No valid address for executing Init\n"));
                //return FALSE;
            }

            if (pfnInit)
            {
                (*pfnInit)();
            }
            break;
        }

    case DLL_PROCESS_DETACH:
        {
            if (hMsimg32)
                if (FreeLibrary(hMsimg32))
                    OutputDebugString (TEXT("MSIMG32 Proxy: DLL detached.\n"));
            break;
        }
    }
    return TRUE;
}

// 
// Get original MSIMG32.DLL functions virtual addresses
//////////////////////////////////////////////////////////////////////////
bool GetMsimg32FnAddr()
{
    TCHAR libName[MAX_PATH];
    GetSystemDirectory (libName, MAX_PATH);
    _tcscat_s (libName, MAX_PATH*sizeof(TCHAR), TEXT("\\msimg32.dll"));
    hMsimg32 = LoadLibrary (libName);

    if (!hMsimg32)
        return false;

    if ( (pfnVSetDdrawFlag = (PFNVSETDDRAWFLAG) GetProcAddress(hMsimg32, "vSetDdrawflag")) == NULL)
        return false;

    if ( (pfnAlphaBlend = (PFNALPHABLEND) GetProcAddress(hMsimg32, "AlphaBlend")) == NULL)
        return false;

    if ( (pfnDllInitialize = (PFNDLLINITIALIZE) GetProcAddress(hMsimg32, "DllInitialize")) == NULL)
        return false;

    if ( (pfnGradientFill = (PFNGRADIENTFILL) GetProcAddress(hMsimg32, "GradientFill")) == NULL)
        return false;

    if ( (pfnTransparentBlt = (PFNTRANSPARENTBLT) GetProcAddress(hMsimg32, "TransparentBlt")) == NULL)
        return false;

    return true;
}

//
// Exported function definition
//////////////////////////////////////////////////////////////////////////
BOOL WINAPI TransparentBlt(HDC p1, int p2, int p3, int p4, int p5, HDC p6, int p7, int p8, 
                                   int p9, int p10, UINT p11)
{   
    return pfnTransparentBlt (p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11);
}

BOOL WINAPI AlphaBlend(HDC p1, int p2, int p3, int p4, int p5, HDC p6, int p7 , int p8,
                               int p9, int p10, BLENDFUNCTION dw)
{
    return pfnAlphaBlend (p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,dw);
}

BOOL WINAPI GradientFill (HDC p1, PTRIVERTEX p2, ULONG p3, PVOID p4, ULONG p5, ULONG p6)
{
    return pfnGradientFill (p1, p2, p3, p4, p5, p6);
}

BOOL WINAPI DllInitialize (HINSTANCE d1,DWORD d2, LPVOID d3)
{
    if (pfnDllInitialize == NULL)
    {
        GetMsimg32FnAddr();
    }

    return pfnDllInitialize (d1, d2, d3);
}

VOID WINAPI vSetDdrawflag (VOID)
{
    (*pfnVSetDdrawFlag)();
} 
```

# javascript - How to compare partial strings and change link color in Javascript

> ID：13072981
> 
> 赞同：0
> 
> 时间：2012-10-25T16:22:35.657
> 
> 标签：javascript, web

I am trying to write a JS code to change color of the current link. For example, if page one address is www.abc.com/abc, and page 2 is www.abc.com/abc/product, then page one will turn red.Basically if page 2 is subpage of page1, then page 1 will turn red. Here is my idea:

```
compare char one by one in page1 and page2
if(currentpage.href!=one of a.href)
flag=false;
if(flag==true)
then turn red
else
then turn blue 
```

Here are my codes below:

```
<div  id="changeColor" class="horizontalcssmenu" style="padding-left:7px;">
<a href="linkeadress" >HOME</a>
<a href="linkaddress" >SHOP</a>
</div>

<script type="text/javascript">
var links = document.getElementById("changeColor");
var a = links.getElementsByTagName("a");
var thisLocationHref = window.location.href;
var counter=0;

for(var i=0;i<a.length;i++){
var flag="true";
var tempLink=a[i];
while(counter<=a[i].length){

    if(thisLocationHref[counter]!=tempLink.href[counter])
    {flag="false";}
    counter++;

}
  if(flag=="true")
  {tempLink.style.color=red";
  }
  else
      {
      tempLink.style.color="blue";
  }

} 
```

Thank you for time!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:39:48.910

While on the surface of it, the answer is trivial, it appears that it is fairly common to do this kind of comparison wrong.

**DO NOT DO:**

```
// compare at most `haystack.length - needle.length' characters
// haystack is usually the longest string
haystack.indexOf(needle) == 0 
```

**DO:**

```
// compare at most `needle.length' characters
// but never compare any characters, if the haystack is
// smaller then the needle
haystack.length >= needle.length && 
    haystack.substr(0, needle.length) == needle 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T17:24:51.323

It is really not possible to determine if a link actually IS pointing to a "parentpage" or a "subpage", but according to the examples given you can try to evaluate if the current page is a "subpage" of a link by their lengths and the current page prepends the link.

```
<div id="changeColor" class="horizontalcssmenu" style="padding-left:7px;">
<a href="http://localhost">HOME</a> <!-- www.abc.com/abc -->
<a href="http://localhost/products/">SHOP</a> <!-- www.abc.com/abc/prodct -->
</div>

<script type="text/javascript">
var links=document.getElementsByTagName('a');
for (var i=0;i<links.length;i++) {
    //is length of the link less than current page?
    if ((parseInt(links[i].href.length)<parseInt(window.location.href.length)) && 
            //does the link prepending the current page?
            (window.location.href.indexOf(links[i].href)>-1)) { 
                //probably this is a link to the "parentpage", eg "page 1"
                links[i].style.color='#ff0000';
    }
}
</script> 
```

Please - i really dont want to be downvoted for this. It does what the question angles for, strange questions gives strange answers :)

# visual-studio-2010 - vsto 2010 Outlook 插件已安装但不可见

> ID：13072985
> 
> 赞同：2
> 
> 时间：2012-10-25T16:22:49.590
> 
> 标签：visual-studio-2010, outlook, vsto, office-2007

我正在开发从 Click-Once 部署的 VSTO 2010 Office 2007 Outlook 加载项。在我开发它的计算机上，运行 Visual Studio，一切正常，但是当尝试在另一台计算机上安装它时，插件已安装，并且在启动屏幕期间，它位于**Inactive Applications Add-in**下。

在加载行为中，它显示`Not Loaded.A Runtime error Occured during the loading of the COM-Add-in`。我已在注册表编辑器下将 HKCU 中的加载行为从 2 更改为 3。但它再次恢复为 2。不确定如何找到特定错误，以便我可以修复它。

有没有人对可能导致这种情况的原因有任何想法？

任何人可能有的任何想法都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T15:10:10.387

最后我自己找到了一个解决方案。我所做的是在发布解决方案之前，我在安装设置下的先决条件中检查了**.Net Framework 3.5 SP1 客户端配置文件，它现在对我有用。**

![看这里](../Images/6594256b1d25a9697739430f653c2126.png)

# sql-server - SSIS派生列中的日期格式

> ID：13072990
> 
> 赞同：0
> 
> 时间：2012-10-25T16:23:01.910
> 
> 标签：sql-server, sql-server-2008, ssis

我有 2 个问题，我有一个包含所有数据的文本文件，例如在文本文件中`Sply_DT`和`Imprt_DT`.

因为`Sply_Dt`我必须创建`getdate()`并且我将它格式化为`2012-10-25 12:04:16.09900000`using`(DT_DBTIMESTAMP)(DT_DBDATE)GETDATE()`但我希望它格式化为`MM-DD-YY`.

对于`Impt_DT`，它是`5/16/2011`dataviewer 中的格式，但是当我将它放入表格时，它看起来像`2011-05-16 00:00:00.000`并且我想要它的`MM-DD-YY`格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:29:36.760

我认为您对[datetime](http://msdn.microsoft.com/en-us/library/ms187819%28v=sql.100%29.aspx)数据类型有些困惑。它不关心您的语言环境是美国 (mm/dd/yyyy)、日本 (yy/mm/dd) 还是英国 (dd/mm/yyyy)，它将始终以内部格式存储。

如果您不喜欢默认演示文稿，您可以调查[SET DATEFORMAT](http://msdn.microsoft.com/en-us/library/ms189491%28v=sql.100%29.aspx)，这可能对您的查询有意义。

您还可以在查询数据时应用适当的 CONVERT 格式以使其成为您想要的格式。

```
DECLARE @datevar datetime = '2012-10-25'
SELECT CONVERT(char(10), @datevar, 10) AS YourFomat, @datevar AS defaultFormat 
```

如果我误解了你的问题，请澄清。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:13:51.130

使用派生列组件的更简单方法如下（对于 MM-DD-YY 格式）：

LEN((DT_WSTR, 2)MONTH(GETDATE())) == 1 ？"0" + (DT_WSTR, 2)MONTH(GETDATE())) : (DT_WSTR, 2)MONTH(GETDATE())) + "-" + LEN((DT_WSTR, 2)DAY(GETDATE())) == 1 ? "0" + (DT_WSTR, 2)DAY(GETDATE())) : (DT_WSTR, 2)DAY(GETDATE())) + "-" + RIGHT((DT_WSTR, 2)YEAR(GETDATE()), 2)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-25T18:18:16.070

据我了解，您的目标是更改来自文本文件的数据的日期时间格式。我建议您在数据流任务中使用派生列转换来添加列或替换现有列，然后您可以在派生列中使用更常见的 .NET 日期运算符和格式字符串首先解析日期，然后进行转换将其转换为具有给定格式的字符串。如果这不起作用，您可以改用数据流任务中的脚本组件来执行我所描述的操作，在这种情况下，您可以访问 .NET 来执行修改。

# sql - 避免在查询中使用“SELECT TOP 1”和“ORDER BY”

> ID：13072992
> 
> 赞同：4
> 
> 时间：2012-10-25T16:23:12.133
> 
> 标签：sql, sql-server, database, sql-server-2008

我在 sql server 2008 中有一张包含大量数据的表

```
|ID|Name|Column_1|Column_2|
|..|....|........|........| 
```

超过 18,000 条记录。所以我需要具有最低值的行`Column_1`是日期，但可以是任何数据类型（未排序）所以我使用这些句子

```
SELECT TOP 1 ID, Name from table ORDER BY Column_1 ASC 
```

但这非常非常慢。而且我认为我不需要对整个表格进行排序。我的问题是如何在不使用`TOP 1`and的情况下获得相同的日期`ORDER BY`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T16:30:40.370

我不明白为什么 18,000 行信息会导致速度过慢，但这显然是看不到您存储的数据是什么。

如果您经常使用该`Column_1`字段，那么我建议您在其上放置一个非聚集索引......这将加快您的查询速度。

您可以通过 Sql Server Management Studio 或直接通过 TSQL 来“设计”您的表...

```
CREATE INDEX IX_myTable_Column_1 ON myTable (Column_1 ASC) 
```

[有关在此处创建索引](http://msdn.microsoft.com/en-us/library/ms188783.aspx)的 MSDN 上的更多信息

* * *

**感谢@GarethD 的评论帮助我**更新，因为我实际上并没有意识到这一点。****

 **作为上述 TSQL 语句的额外部分，如果包含将在索引中使用的其他列的名称，它将提高查询速度。...

```
CREATE INDEX IX_myTable_Column_1 ON myTable (Column_1 ASC) INCLUDE (ID, Name) 
```

正如 GarethD 指出的那样，[使用这个 SQLFiddle 作为证明](http://www.sqlfiddle.com/#!3/a412b/1)，执行计划要快得多，因为它避免了“RID”（或行标识符）查找。

有关[MSDN 上有关使用包含列创建索引的更多信息，请单击此处](http://msdn.microsoft.com/en-us/library/ms190806.aspx)

谢谢@GarethD

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T16:55:29.467

这会更快吗？当我阅读这个问题时，这是我想到的代码：

```
Select top 1 ID, Name 
from table 
where Column_1 = (Select min(Column_1) from table) 
```**

# ruby-on-rails - 登录时没有被设计修剪的空白

> ID：13072998
> 
> 赞同：2
> 
> 时间：2012-10-25T16:23:23.137
> 
> 标签：ruby-on-rails, devise

我有一个在 rails 2.3.14 上运行的应用程序，并且我的 gem 文件中有“设计”、“1.0.10”。Devise 在身份验证时似乎没有修剪空白字符。

假设我有一个“admin”用户，如果我尝试使用“admin”登录，它会说无法验证您的身份......

有什么解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T10:05:35.420

自 1.4.0 版以来，Devise 添加了去除空格的功能（默认情况下会这样做）。不幸的是，我们不再支持此类版本的 Rails 2.3。因此，最好的解决方案是覆盖模型中的`email=`or`login=`方法以去除给定值或直接在控制器中执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T21:41:37.530

在调用 super 之前，您始终可以尝试使用[自定义控制器](https://github.com/plataformatec/devise#configuring-controllers)并[修剪自己的参数](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-strip)