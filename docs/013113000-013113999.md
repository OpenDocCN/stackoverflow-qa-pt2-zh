# StackOverflow 问答 13113000-13113999

# c# - 根据列表的不同值迭代列表的有效方法是什么？

> ID：13113005
> 
> 赞同：1
> 
> 时间：2012-10-28T21:03:27.580
> 
> 标签：c#, linq

```
string sStoreStockFeed = "";
string sSeparator = "";

var distinctStoreIDList = skuStoreStockLevels.Select(x => x.Item1).Distinct();

    foreach (var storeID in distinctStoreIDList)
    {
        foreach (var item in skuStoreStockLevels)
        {
            if (item.Item1 == storeID)
            {
               // add this one to a job for this store
                       sStoreStockFeed += sSeparator + item.Item1.ToString() + "," + item.Item2.ToString() + "," + item.Item3.ToString();
                       sSeparator = "|";
            }
        }
      // some code to process the string before moving on
      sStoreStockFeed = "";
      sSeparator = "";
    } 
```

在上面的代码片段中，skuStoreStockLevels 恰好是一个 Tuple 类型的 List，而 Item1 是 StoreID。得到一个不同的列表后，它会遍历（非不同的）列表以获取每个适用的项目。效率低下是（大）内部列表为每个不同的项目（StoreID）重复迭代。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T21:13:27.907

更新：纯 LINQ 解决方案。这将为您提供为每组项目创建的字符串列表。

```
var query = skuStoreStockLevel.GroupBy(x => x.Item1)
                .Select(g => g.Aggregate(new StringBuilder(),
                                         (sb, x) => sb.AppendFormat("{0}{1},{2},{3}", sSeparator, x.Item1, x.Item2, x.Item3),
                                         (sb) => sb.ToString()));

foreach(var feed in query)
    // some code to process the string before moving on 
```

还有其他选项 - 顺序排序。相同的项目将一个接一个。

```
int storeID = -1;
StringBuilder builder = new StringBuilder();

foreach (var item in skuStoreStockLevel.OrderBy(x => x.Item1))
{
    builder.AppendFormat("{0}{1},{2},{3}", sSeparator, item.Item1, item.Item2, item.Item3);
    if (item.Item1 != storeID)
    {
        // some code to process the string before moving on
        storeID = item.Item1;
    }       
} 
```

或者你可以使用分组

```
StringBuilder builder = new StringBuilder();

foreach (var storeGroup in skuStoreStockLevel.GroupBy(x => x.Item1))
{
    foreach (var item in storeGroup)
          builder.AppendFormat("{0}{1},{2},{3}", sSeparator, item.Item1, item.Item2, item.Item3);        

    // some code to process the string before moving on
} 
```

当然，最好`StringBuilder`用于创建字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:16:41.307

使用 Linq [GroupBy](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.groupby.aspx)它将为您构建一个分组项目列表：

```
string sStoreStockFeed = "";
string sSeparator = "";

var itemsByStore = skuStoreStockLevels.GroupBy(x => x.Item1);
foreach (var storeItems in itemsByStore )
{
    // storeItems.Key is the storeId, that is x.Item1
    foreach(var item in storeItems)
    {
        sStoreStockFeed += sSeparator + item.Item1.ToString() + "," + item.Item2.ToString() + "," + item.Item3.ToString();
        sSeparator = "|";
    }

     // some code to process the string before moving on
    sStoreStockFeed = "";
    sSeparator = "";
} 
```

# scala - 将 Iterable[Either[A,B]] 减少为 Either[A, Iterable[B]]

> ID：13113006
> 
> 赞同：8
> 
> 时间：2012-10-28T21:04:03.033
> 
> 标签：scala, functional-programming, iterable, either

我需要将 Iterable[Either[Throwable, String]] 减少为 Either[Throwable, Iterable[String]]。我不知道这个操作是否很常见，在 Iterable 特征上没有发现任何东西。所以我写了这个函数：

```
def reduce[A, B](xs: Iterable[Either[A, B]]): Either[A, Iterable[B]] = 
  xs.collectFirst {
    case Left(x) => x
  } match {
    case Some(x) => Left(x)
    case None => Right(xs.collect{case Right(y)=> y})
  } 
```

如果不是这样，任何人都可以帮助我找到更好的方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-28T21:48:57.363

此操作通常称为*排序*，并且在某些函数式语言（例如 Haskell）的标准库中可用。在 Scala 中，您可以实现自己的，也可以使用像[Scalaz](http://code.google.com/p/scalaz/)这样的外部库。假设我们有以下内容，例如：

```
val xs: List[Either[String, Int]] = List(Right(1), Right(2))
val ys: List[Either[String, Int]] = List(Right(1), Left("1st!"), Left("2nd!")) 
```

现在我们可以编写（使用 Scalaz 7）：

```
scala> import scalaz._, Scalaz._
import scalaz._
import Scalaz._

scala> xs.sequenceU
res0: Either[String,List[Int]] = Right(List(1, 2))

scala> ys.sequenceU
res1: Either[String,List[Int]] = Left(1st!) 
```

如预期的。

* * *

作为旁注，此操作只要求外部容器是可遍历的，并且内部容器是应用函子。Scalaz 还提供了`ValidationNEL`一个很像`Either`并且也符合这些要求的类，但是在 s`sequence`列表上使用会`ValidationNEL`收集多个错误，而不是在第一个停止：

```
val zs: List[ValidationNEL[String, Int]] =
  List(1.successNel, "1st".failNel, "2nd".failNel) 
```

现在我们得到：

```
scala> print(zs.sequenceU)
Failure(NonEmptyList(1st, 2nd)) 
```

您还可以在s、s 等`sequence`列表中使用。`Option``Promise`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T21:43:26.463

如果您不喜欢显式返回并希望在稍微缩短代码的同时消除模式匹配，这里是另一个版本：

```
def reduce[A, B](xs: Iterable[Either[A, B]]): Either[A, Iterable[B]] =
  xs collectFirst {
    case Left(x) => Left(x)
  } getOrElse Right(xs.flatMap(_.right.toOption)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T21:24:24.997

我总是觉得`return`陈述有点尴尬，但以下内容有效：

```
def reduce[A, B](xs: Iterable[Either[A, B]]): Either[A, Iterable[B]] =
  Right(xs.collect {
    case Left(x) => return Left(x)
    case Right(x) => x
  }) 
```

# javascript - 如何使用 jquery 读取 json 值？

> ID：13113008
> 
> 赞同：0
> 
> 时间：2012-10-28T21:04:22.393
> 
> 标签：javascript, jquery, json

> **可能重复：**
> [我有一个嵌套数据结构/JSON，如何访问特定值？](https://stackoverflow.com/questions/11922383/i-have-a-nested-data-structure-json-how-can-access-a-specific-value)

我正在尝试读取一些 json 并显示它们的值。

我在下面有以下 JSON 提要，我希望能够读取和输出 name、caption、type、id、email 值等的所有值，我对所有这些值都没有定义

```
///html 
<div id="results"></div> 
```

我的 json 看起来像这样

```
{
    "action":"index.html",
    "method":"post",
    "html":[
        {
            "type":"fieldset",
            "caption":"User information",
            "html":[
                {
                    "name":"email",
                    "caption":"Email address",
                    "type":"text",
                    "placeholder":"E.g. user@example.com",
                    "validate":{
                        "email":true
                    }
                },
                {
                    "name":"password",
                    "caption":"Password",
                    "type":"password",
                    "id":"registration-password",
                    "validate":{
                        "required":true,
                        "minlength":5,
                        "messages":{
                            "required":"Please enter a password",
                            "minlength":"At least {0} characters long"
                        }
                    }
                },
                {
                    "name":"password-repeat",
                    "caption":"Repeat password",
                    "type":"password",
                    "validate":{
                        "equalTo":"#registration-password",
                        "messages":{
                            "equalTo":"Please repeat your password"
                        }
                    }
                },
                {
                    "type":"radiobuttons",
                    "caption":"Sex",
                    "name":"sex",
                    "class":"labellist",
                    "options":{
                        "f":"Female",
                        "m":"Male"
                    }
                },
                {
                    "type":"checkboxes",
                    "name":"test",
                    "caption":"Receive newsletter about",
                    "class":"labellist",
                    "options":{
                        "updates":"Product updates",
                        "errors":{
                            "value":"security",
                            "caption":"Security warnings",
                            "checked":"checked"
                        }
                    }
                }
            ]
        },
        {
            "type":"fieldset",
            "caption":"Address information",
            "html":[
                {
                    "name":"name",
                    "caption":"Your name",
                    "type":"text",
                    "placeholder":"E.g. John Doe"
                },
                {
                    "name":"address",
                    "caption":"Address",
                    "type":"text",
                    "validate":{ "required":true }
                },
                {
                    "name":"zip",
                    "caption":"ZIP code",
                    "type":"text",
                    "size":5,
                    "validate":{ "required":true }
                },
                {
                    "name":"city",
                    "caption":"City",
                    "type":"text",
                    "validate":{ "required":true }
                },
                {
                    "type":"select",
                    "name":"continent",
                    "caption":"Choose a continent",
                    "options":{
                        "america":"America",
                        "europe":{
                            "selected":"true",
                            "id":"europe-option",
                            "value":"europe",
                            "html":"Europe"
                        },
                        "asia":"Asia",
                        "africa":"Africa",
                        "australia":"Australia"
                    }
                }
            ]
        },
        {
            "type":"submit",
            "value":"Signup"
        }
    ] 
```

}

我的代码如下所示：

```
$(document).ready(function() {
  $('#letter-b a').click(function() {
    $.getJSON('dformexternal.json', function(data) {
      $('#results').empty();
      $.each(data, function(entryIndex, entry) {
        var html = '<div class="entry">';
        html += '<h3 class="html">' + entry['html'] + '</h3>';
        html += '<div class="name">' + entry['name'] + '</div>';
         html += '<div class="caption">' + entry['caption'] + '</div>';
          html += '<div class="type">' + entry['type'] + '</div>';
        html += '<div class="definition">';
        html += entry['definition'];
        if (entry['name']) {
          html += '<div class="name">';
          $.each(entry['name'], function(lineIndex, line) {
            html += '<div class="name">' + line + '</div>';
          });
          if (entry['caption']) {
            html += '<div class="caption">' + entry['caption'] + '</div>';
          }
          html += '</div>';
        }
        html += '</div>';
        html += '</div>';
        $('#results').append(html);
      });
    });
    return false;
  });
}); 
```

我似乎无法访问任何值。我做错了什么？任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:06:48.523

您可以将 json 值作为常规属性访问。

json.property.nestedProperty.value

# java - 如何使用 charAt 方法将大写变为小写？

> ID：13113010
> 
> 赞同：10
> 
> 时间：2012-10-28T21:04:31.980
> 
> 标签：java

我需要创建一个函数，使用该`charAt`方法将所有大写字符变为小写。我尝试使用类型转换将`int`值更改为，`char`但之后就迷路了。

```
/********************************************************************************
  This function will calculate the integer average of characters in the array
********************************************************************************/
public static void lowerCase(char[] letter) {
    char mean;
    mean = (char) ((int) ch + 32);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T21:13:01.117

哦，其实你不需要使用 charAt 来检查它。只需将所有内容转换为小写即可。这不会影响已经是小写的字符，并将大写字符转换为小写。这就是你需要的。

您不需要将您的转换`character array`为`string object`然后使用`String.toLowerCase`方法，因为它`Character.toLowerCase`仅在内部使用方法。

```
public static void average( char [] letter ) {

    for (int i = 0; i < letter.length; i++) {
        letter[i] = Character.toLowerCase(letter);
    }

    System.out.println(Arrays.toString(letter));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T21:18:47.297

如果你喜欢只使用 charAt，你可以尝试：

```
String test = "fasdWADFASD242134";
StringBuilder result = new StringBuilder(test);
for (int i = 0; i < test.length(); i++) {
    char ch = test.charAt(i);
    result.setCharAt(i, ch >= 'A' && ch <= 'Z' ? (char) (ch + 'a' - 'A') : ch);
}
System.out.println("result = " + result); 
```

如果你有一个 char 数组，你可以使用：

```
public static void toLower(char[] letter){
     for (int i = 0; i < letter.length; i++) {
         char ch= letter[i];
         letter[i]= ch >= 'A' && ch <= 'Z' ? (char) (ch + 'a' - 'A') : ch;
     }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T21:08:12.627

如果您不必使用 charAt()...

```
public static void average( char [] letter )
{
 String str = new String(letter);
 System.out.println("The value is "+str.toUpperCase());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T21:22:04.530

假设您要单独处理字符（如 charAt）：

```
char c = letter[i]; // i = 0...len(letter-1)
char upperC = Character.toLowerCase(c); 
```

如果您实际上不想使用 charAt：

```
String lowerCaseVersion = (new String(letter)).toLowerCase(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-28T21:09:22.473

“abcdefghijklmnopqrstuvwxyz”.charAt（字符 - 'A'）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-28T21:10:54.567

试试这个，看起来像一个工作方法

[http://www.techlabs4u.com/2011/07/java-code-to-convert-string-to-lower.html](http://www.techlabs4u.com/2011/07/java-code-to-convert-string-to-lower.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-28T21:16:25.800

这样做：

```
String string = "some string";
System.out.println(string.toUpperCase()); 
```

`String`类有一个方法[toUpperCase()](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#toUpperCase%28%29)和[toLowerCase()](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#toLowerCase%28%29)，您可以使用它来将您`String`转换为大写或小写字母，您不需要使用`charAt`方法（以防您需要转换特定字母）。

# algorithm - 假设整数遵循均匀分布，对随机整数数组进行排序的最快方法是什么？

> ID：13113014
> 
> 赞同：2
> 
> 时间：2012-10-28T21:04:43.080
> 
> 标签：algorithm

就像标题所说的那样。整数是 <0, 10^18>

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T21:45:09.583

[Flashsort](http://en.wikipedia.org/wiki/Flashsort)是一种利用已知均匀分布的数据的排序算法`O(n)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:18:52.703

如果键总是整数，则基数排序比普通的基于比较的排序（例如快速排序）更有效，缩放为 O(kN)，其中 N 是项目数，k 是平均键长度（以位为单位）。因此，这与您要排序的整数数量呈线性关系，并且随着 N 变得足够大，它将胜过快速排序。有关解释和示例 C++ 实现，请参见[http://en.wikipedia.org/wiki/Radix_sort 。](http://en.wikipedia.org/wiki/Radix_sort)

# html - 在页面中间居中背景图像

> ID：13113017
> 
> 赞同：0
> 
> 时间：2012-10-28T21:05:46.563
> 
> 标签：html, css

不知道为什么我不能让它工作。我要做的只是：1）放置一个100％的屏幕背景，但最小尺寸为784px，然后我想在页面中间居中另一个图像。

JsFiddle - [http://jsfiddle.net/lep128/TbSfB/](http://jsfiddle.net/lep128/TbSfB/)

**HTML**

```
<body>
    <div class="container"></div>
</body> 
```

**CSS**

```
body {
  font-family: 'Open Sans', sans-serif !important;
  background-image: url('https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcS-ETyIzR8JeSwXRYpHDijfM4g5vIR8RcpzMmSE3AvCdnHPmrje');
  background-size: 100%;
  min-height: 784px;
}
.container {
    background: transparent url('https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSRfXpcWInB-fB96WuQLAR2JPlhAwyssVbVetadWWXXYgh5ZV22yQ') center center no-repeat;
    width: 455px;
    margin: 0 auto;
    clear: both;
    height: 525px;
}​ 
```

如您所见，地球停留在页面顶部而不是中心。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:15:36.357

你的 .container 对象中间将是 height:784px 试试这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:15:52.757

```
body {
      font-family: 'Open Sans', sans-serif !important;
      background-image: url('https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcS-ETyIzR8JeSwXRYpHDijfM4g5vIR8RcpzMmSE3AvCdnHPmrje');
      background-size: 100%;
      height: 100%;
   }

.container {
    background: transparent url('https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSRfXpcWInB-fB96WuQLAR2JPlhAwyssVbVetadWWXXYgh5ZV22yQ') 50% 50% no-repeat;
    width: 455px;
    margin: 0 auto;
    height: 525px;
}​ 
```

这应该够了吧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-29T01:47:35.130

[提琴手演示](http://jsfiddle.net/TbSfB/19/)

```
.body {
  font-family: 'Open Sans', sans-serif !important;
  background-image: url('https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcS-ETyIzR8JeSwXRYpHDijfM4g5vIR8RcpzMmSE3AvCdnHPmrje');
  background-size: 100%;
  height: 100%;
}

.container {
  background: transparent url('https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSRfXpcWInB-fB96WuQLAR2JPlhAwyssVbVetadWWXXYgh5ZV22yQ') center no-repeat;
  width: 455px;
  margin: 0 auto;
  height: 784px;
}​ 
```

# php - 在 Magento 中创建产品的完整性约束违规

> ID：13113019
> 
> 赞同：3
> 
> 时间：2012-10-28T21:05:53.790
> 
> 标签：php, sql, magento, exception, product

我正在尝试从 magento 前端创建产品，但是在执行 php 代码时我收到此错误：

```
SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`magento`.`catalog_product_entity`, CONSTRAINT `FK_CAT_PRD_ENTT_ATTR_SET_ID_EAV_ATTR_SET_ATTR_SET_ID` FOREIGN KEY (`attribute_set_id`) REFERENCES `eav_attribute_set` (`attribute_set_id`) ON DE) 
```

我在这里找到：[Create a product from PHP - Magento](https://stackoverflow.com/questions/11759937/create-a-product-from-php-magento)这应该是属性集 ID 的问题，但我尝试从 eav_attribute_set 表中强制 ID，然后使用函数：

```
Mage::getModel('catalog/config')->getAttributeSetId('catalog_product','Set_evento') 
```

并使用上面的此功能，但具有“默认”值。没变化。所以也许问题不在于属性集 ID？

这是我的代码：

```
$product = Mage::getModel('catalog/product');

$product->setSku(time());
$product->setName("Evento senza nome");
$product->setDescription("123");
$product->setShortDescription("1234");
$product->setPrice(0.00);
$product->setTypeId('virtual');
$attributeSetId = Mage::getModel('catalog/config')->getAttributeSetId('catalog_product','Set_evento');
$product->setAttributeSetId($attributeSetId); 
$product->setCategoryIds(array($cat_id)); 
$product->setVisibility(4); // catalog, search
$product->setStatus(1); // enabled

// assign product to the default website
$product->setWebsiteIds(array(Mage::app()->getStore(true)->getWebsite()->getId()));

// for stock
$stockData = $product->getStockData();
$stockData['qty'] = 1;
$stockData['is_in_stock'] = 1;
$product->setStockData($stockData);

$product->setCreatedAt(strtotime('now'));

Mage::app()->getStore()->setId(Mage_Core_Model_App::ADMIN_STORE_ID);

$product->save(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-28T10:50:43.993

请检查您是否设置了一个有效的`$attributeSetId`，如果`Mage::getModel('catalog/config')->getAttributeSetId('catalog_product','Set_evento')`成功返回一个有效的ID。

我遇到了同样的错误，设置一个有效的属性集 ID 为我解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-22T00:36:48.463

我在运行导入程序时遇到了同样的问题，我发现问题是我尝试更新的某些产品不存在添加此代码对我有用。

```
$productid = Mage::getModel('catalog/product')
            ->getIdBySku(trim($sku));
        if(!$productid){
            Mage::Log('Failed to load product with Sku:'.$sku,null,'cron.log');
            return;
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T21:52:12.357

基本上，外键约束错误是由于您尝试在引用表中不存在的该列中输入值引起的。在这种情况下 - 我会检查您尝试插入主表的值是否允许在辅助表中。

# android - Android ActionBarSherlock 片段

> ID：13113021
> 
> 赞同：0
> 
> 时间：2012-10-28T21:06:06.450
> 
> 标签：android, android-fragments, actionbarsherlock, android-support-library

我一直在尝试让 ActionBarSherlock 与 Google 的片段教程一起工作，并在尝试将“内容”片段添加到视图时遇到问题。此行产生以下异常

```
getFragmentManager().beginTransaction().add(android.R.id.content, content).commit();

The method add(int, Fragment) in the type FragmentTransaction 
is not applicable for the arguments (int, ContentFragment) 
```

该代码与 Google 的 (http://developer.android.com/guide/components/fragments.html) 相同，只是我在需要的地方扩展到了 SherlockActivity。ContentFragment/Activity 只是我所说的 Details 活动。

即使我去掉所有的 ABS 引用以使其成为一个正常的例子，我也会遇到同样的问题。我感觉它与 android 支持库有关，但我一辈子都想不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:48:33.170

使用`getSupportFragmentManager()`而不是`getFragmentManager()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:48:18.987

您的片段类看起来如何？这段代码对我来说很好：

```
android.support.v4.app.FragmentTransaction ft = getFragmentManager().beginTransaction();
    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_OPEN);
    FragmentADetail frag = new FragmentADetail();
    ft.replace(android.R.id.content, frag);
    ft.addToBackStack(null);
    ft.commit(); 
```

我的 FragmentADetail 类看起来像这样：

```
public class FragmentADetail extends SherlockFragment {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    getSherlockActivity().getSupportActionBar().setDisplayHomeAsUpEnabled(true);

    View v = inflater.inflate(R.layout.fragment_a_detail_layout, container, false);
    v.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            //left empty on purpose to capture the onClick event. 
        }
    });

    return v;
}

@Override
public void onStop()
{
    super.onStop();
    getSherlockActivity().getSupportActionBar().setDisplayHomeAsUpEnabled(false);
} 
```

}

# javascript - jquery scrollto不适用于所有链接

> ID：13113022
> 
> 赞同：0
> 
> 时间：2012-10-28T21:06:35.380
> 
> 标签：javascript, jquery, scroll, href, move

在此页面上：http: [//klanten.noxxie.nl/msbc/news.php](http://klanten.noxxie.nl/msbc/news.php?id=1) ?id= 1 我在让 jquery 处理所有链接时遇到问题

只有当您单击第一个超链接“reageer op deze reactie”时，您才会移动到底部以形成，

虽然其他人没有回应，但知道是什么原因造成的吗？链接到 jquery：[http](http://klanten.noxxie.nl/msbc/js/anchor-scroll/jquery.anchorScroll.js) ://klanten.noxxie.nl/msbc/js/anchor-scroll/jquery.anchorScroll.js 如何使用 jquery 激活：klanten.noxxie.nl/msbc/js/custom.js（在底部)

有人知道为什么 jquery 不能全部识别吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:17:54.133

尝试将滚动功能分配给类而不是 id

(custom.js(564): $("#movescroll").anchorScroll();

另一件事，id 应该是唯一的。

# resque - 如何将作业重新排队到 Resque？

> ID：13113025
> 
> 赞同：0
> 
> 时间：2012-10-28T21:07:09.600
> 
> 标签：resque, resque-retry

我是 Resque 的新手，过去 2 个月我一直在生产中使用它，我现在遇到一个问题，如果出现异常，我希望我的作业在队列中重新排队。我的工作进行了大约 50 次外部 HTTP 调用，其中一些调用由于延迟而失败，有时服务中断。我正在探索[https://github.com/lantins/resque-retry](https://github.com/lantins/resque-retry)但我试图了解 resque-retry 是否重试作业或重新排队，我不希望失败的作业优先于另一个此队列中的作业，我希望它再次添加到队列中。此外，我所有的 HTTP 调用都有一个救援块，在使用 resque-retry 时，我必须对这个类（从 Resque 执行调用）进行一些更改，以便它被重试/重新排队。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T11:07:50.080

I dont think the failed job get any higher precedence over the other jobs in same queues

since in resque term it only a message in the queues the only precedence

it can get is perhaps if the queues from from which the failed job message was consumed

is of higher precedence over the other queues but if the same queue has some message in it

and failed job message arrive then it will function just as normal queue fashion i.e **FIFO**

order

# php - 如何获取字符串开头的所有数字？

> ID：13113026
> 
> 赞同：2
> 
> 时间：2012-10-28T21:07:15.450
> 
> 标签：php, regex, string, preg-match, digits

如何获取字符串开头的所有数字？

这是一个示例字符串：`1&amp;days=800&amp;trans=9aq8ojjfka24qnl10ohktibfs1`

在上面的示例中，我需要提取`1`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T21:09:15.430

```
preg_match('(^\d+)', $str, $matches);
echo 'Leading digits are: ' . (count($matches) ? $matches[0] : ''); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-28T21:12:00.170

如果数字总是在字符串的开头，你可以只转换为一个 int，PHP 会处理剩下的事情。

```
var_dump((int)'1&amp;days=800&amp;trans=9aq8ojjfka24qnl10ohktibfs1'); 
```

输出：-

```
int 1 
```

将证明我的观点。随心所欲

```
var_dump((int)'7891&amp;days=800&amp;trans=9aq8ojjfka24qnl10ohktibfs1'); 
```

输出：-

```
int 7891 
```

要利用这个： -

```
$myInt = (int)'1&amp;days=800&amp;trans=9aq8ojjfka24qnl10ohktibfs1'; 
```

看到它在这里工作[http://codepad.viper-7.com/aih2x3](http://codepad.viper-7.com/aih2x3)

如果您需要前导零，那么您应该[按照 Hakre 的建议进行操作](https://stackoverflow.com/a/13113315/212940)。我认为这是未来的证明；）

[http://php.net/manual/en/language.types.type-juggling.php](http://php.net/manual/en/language.types.type-juggling.php)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-28T21:44:20.067

如果您需要前导数字 - 包括多个零 - 您可以[扫描字符串](http://php.net/sscanf)以查找它。如果不存在，则值为`NULL`：

```
$subject = '1&amp;days=800&amp;trans=9aq8ojjfka24qnl10ohktibfs1';   

sscanf($subject, '%[0-9]', $leadingDigits);

echo 'Leading digits are: ', var_dump($leadingDigits); 
```

输出（[演示](http://codepad.viper-7.com/JIlGuQ)）：

```
Leading digits are: string(1) "1" 
```

如果您不需要前导零，[请执行 vascowhite 建议](https://stackoverflow.com/a/13113062/367456)的操作，这非常简单。除此以外：

```
sscanf($subject, '%d', $leadingDigits); 
```

也返回一个整数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T22:26:23.463

使用 PHP 内置 FAST 函数 [http://www.php.net/manual/en/function.strspn.php](http://www.php.net/manual/en/function.strspn.php)

```
// int strspn ( string $subject , string $mask [, ...])

$digits=substr($str,0,strspn($str,'0123456789')-1); 
```

# java - View Pager 中的按钮

> ID：13113030
> 
> 赞同：1
> 
> 时间：2012-10-28T21:07:50.163
> 
> 标签：java, android, button, android-viewpager

我正在尝试在 PageView 的片段中添加按钮。

请在附件中找到我用于此应用程序的代码：

xml的具体代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">
    <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
            <Button
            android:id="@+id/banner_name"
            android:layout_width="fill_parent"
            android:layout_height="30dp"
            android:background="@drawable/button_banner"
            android:gravity="center_vertical"
            android:paddingLeft="10dip"
            android:text="@string/equations"
            android:textStyle="bold"
            android:textColor="#ffffff" />
    </LinearLayout>
    <ScrollView 
        android:id="@+id/ScrollViewEquations"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
        <LinearLayout 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical">
            <Button
                android:id="@+id/Button"
                android:layout_width="fill_parent"
                android:layout_height="25dip"
                android:background="@drawable/custom_button"
                android:gravity="center_vertical"
                        android:paddingLeft="25dip"
                android:textColor="#516CE2"
                android:text="@string/button" />
        </LinearLayout>
    </ScrollView>
</LinearLayout 
```

这是相关的片段代码

```
package com.example.app;

import com.example.app![enter image description here][1].R;

import android.content.Intent;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;

public class EquationsMain extends Fragment {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }
    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
    }
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.equations, container, false);
        return view;
    }
} 
```

这是主要代码：

```
package com.example.app;

import com.example.app.R;
import com.google.ads.AdRequest;
import com.google.ads.AdView;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;
import android.view.Window;
import android.view.WindowManager;

public class Main extends FragmentActivity {
    private MyAdapter mAdapter;
    private ViewPager mPager;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);
        this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setContentView(R.layout.main);
        mAdapter = new MyAdapter(getSupportFragmentManager());

        AdView adView = (AdView)this.findViewById(R.id.adView);
        adView.loadAd(new AdRequest()); 

        mPager = (ViewPager) findViewById(R.id.pager);
        mPager.setAdapter(mAdapter);
    }

    public static class MyAdapter extends FragmentPagerAdapter {
        public MyAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public int getCount() {
            return 3;
        }

        @Override
        public Fragment getItem(int position) {
            switch (position) {
            case 0:
                return new EquationsMain();
            case 1:
                return new MaterialsMain();
            case 2:
                return new AboutMain();
            default:
                return null;
            }
        }
    }
} 
```

# assembly - 使用 LC-3 的 16 位字反转

> ID：13113034
> 
> 赞同：1
> 
> 时间：2012-10-28T21:08:18.553
> 
> 标签：assembly, bit-shift, lc3

我正在处理任务，我将以二进制形式输入，并将其反向存储在另一个地址中。我正在使用一个 4 位字，直到我能够降低逻辑，然后一旦一切正常，就可以将其扩展为 16 位字。

例如：1010100101001011 ==> 1101001010010101

到目前为止，这是我的方法：

字：1010 掩码：0001 结果：0000

1) 1010 & 0001 - 和这个一起

```
 result is: 0000 
```

（我希望只能将最低有效位存储为我的结果中的最高有效位）

2) 1010 & 0010 - 增加我的掩码，并将它与我的单词进行 ANDing

结果是：0010

现在我将把位放在 2 的位置，并将其存储在我的结果寄存器中的 4 的位置。

这就是我在尝试提出逻辑来隔离一位然后将其存储在另一个位置时遇到的问题。

任何提示或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:17:13.857

假设您的意思是最小的 LC-3，它没有移位或除法指令：

*   ADD 可用于向左移动掩码
*   ADD 可用于将结果左移
*   您可以测试掩码和输入的 AND 是否为零
*   使用测试的结果将结果向左移动后添加 0 或 1

这里是 C 版本

```
uint16_t reverse16 (uint16_t input)
{
    uint16_t result = 0u;
    uint16_t mask = 1u;
    int i;

    for (i= 0; i < 16; i++)
    {
        result = result + result;
        if (0u != (input & mask))
        {
            result += 1u;
        }
        mask = mask + mask;
    }
    return result;
} 
```

bithacks网站有很多有趣的方法来解决这个和其他位级别的问题[。](http://graphics.stanford.edu/~seander/bithacks.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:17:27.040

以下是 C 语言中 16 位字的位反​​转的简单（但易于理解）实现的逻辑：

```
uint16_t w = 0xb2e3;         // our 16 bit word
uint16_t mask0 = 0x0001;     // mask for LS bit
uint16_t mask1 = 0x8000;     // mask for MS bit
uint16_t shift = 15;         // distance between high and low bit positions

for (int b = 0; b < 8; ++b)  // for each pair of low/high bits
{
    uint16_t b0 = w & mask0; // get low bit
    uint16_t b1 = w & mask1; // get high bit
    w &= ~(mask0 | mask1);   // clear low/high bit in word
    b0 <<= shift;            // swap bit positions
    b1 >>= shift;
    w |= (b0 | b1);          // insert swapped bits back into word
    mask0 <<= 1;             // update masks for next pair of bits
    mask1 >>= 1;
    shift -= 2;              // update distance for next pair of bits 
}

printf("%#x\n", w);          // w should now contain 0xc74d 
```

测试代码：http: [//ideone.com/GgbzHw](http://ideone.com/GgbzHw)

将上述循环转换为 LC3 应该相当简单，尽管综合起来可能`|`具有挑战性，因为指令集非常有限。`<<``>>`

# python - Python 类属性 vs 元类 vs 类变量

> ID：13113036
> 
> 赞同：1
> 
> 时间：2012-10-28T21:08:23.793
> 
> 标签：python

我有一个带有计时器类挂钩的 mongo 包装器，基本上，每次更新或保存集合时，它都会生成一个计时器，该计时器在到期时依次执行给定的函数。我的问题是，指定这些函数的pythonic方法是什么？我的想法是像这样简单地将它们添加到集合包装器中：

```
class TestCollection(Collection):
    __name__ = 'test_collection'
    __database__ = 'test'
    __primary_key__ = 'field_1'

    post_delete = 'call_this_func_with_getattr_after_delete'
    expire = 'also_call_this_with_getattr_when_timer_expires'

    field_1 = Key()
    field_2 = Key()
    field_3 = Key() 
```

然后我可以在我的计时器类上添加逻辑以在过期时运行指定的函数，对于我的 mongo 包装器也是如此。这也可以通过不同的方式来实现（元类、损坏的属性名称等），但我只是想知道在做这样的事情时的普遍共识。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:16:22.980

当您直接存储对可调用对象的引用时，不要存储您必须查找的名称。任何函数、方法或具有`__call__`方法的类的实例，与其他任何事物一样都是对象，并且可以存储在您的`expired`属性中。

# android - Android编程如何获取XML字符串有序标签

> ID：13113041
> 
> 赞同：2
> 
> 时间：2012-10-28T21:08:37.117
> 
> 标签：android, tags, xmlserializer, stringwriter

我写了这段代码。它很好用。但我的输出字符串有问题。

```
 public static String CreateIndexForImage() 
   throws IllegalArgumentException, IllegalStateException, IOException
{
   String Image_Name = "Bla BLa";

   static XmlSerializer xmlSerializer = Xml.newSerializer();
   static StringWriter writer = new StringWriter();
   xmlSerializer.setOutput(writer);

   xmlSerializer.startDocument("UTF-8", true);

   xmlSerializer.startTag("", "imagefile");
   xmlSerializer.startTag("", "image");
   xmlSerializer.startTag("", "name");

   xmlSerializer.text(Image_Name);

   xmlSerializer.endTag("", "name");
   xmlSerializer.endTag("", "image");
   xmlSerializer.endTag("", "imagefile"); 

   xmlSerializer.endDocument();

   return writer.toString();
 } 
```

输出如下：

```
 <?xml version='1.0' encoding='UTF-8' standalone='yes' ?><imagefile><image><name>Bla Bla</name></image></imagefile> 
```

但我希望输出是这样排序的：

```
 <?xml version='1.0' encoding='UTF-8' standalone='yes' ?>
 <imagefile>
      <image>
         <name>Bla BLa</name>
      </image>
 </imagefile> 
```

在 XmlSerializer 类或 StringWriter 类中有这样的方法或东西吗？否则我可以用另一种方式来订购上面的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:21:32.167

你有没有尝试过这样的事情？

```
serializer.setProperty(
"http://xmlpull.org/v1/doc/properties.html#serializer-indentation", "   ");

serializer.setProperty(
"http://xmlpull.org/v1/doc/properties.html#serializer-line-separator", "\n"); 
```

我不知道这是否仍然有效。否则你可以尝试这样的事情：

```
serializer.setFeature("http://xmlpull.org/v1/doc/features.html#indent-output", true); 
```

# android - 无法从 onOptionsItemSelected 中调用函数

> ID：13113051
> 
> 赞同：0
> 
> 时间：2012-10-28T21:09:27.333
> 
> 标签：android, options-menu

```
public boolean onOptionsItemSelected(MenuItem item)
{
    //check selected menu item
    switch (item.getItemId()) { 
    case R.id.exit:
        this.finish();
        return true;
    case R.id.basic: 
        Difficulty = DIFFICULTY_BASIC;
        Toast.makeText(YogaPosesActivity.this, "Difficulty is Basic", Toast.LENGTH_SHORT).show();
        SetImageView(myDbHelper);
        return true;
    case R.id.advanced: 
        Toast.makeText(YogaPosesActivity.this, "Difficulty is Advanced", Toast.LENGTH_SHORT).show();
        Difficulty = DIFFICULTY_ADVANCED;
        SetImageView(myDbHelper);
        return true;
    case R.id.allPoses:
        Toast.makeText(YogaPosesActivity.this, "All Poses Will Be Displayed", Toast.LENGTH_SHORT).show();
        Difficulty = DIFFICULTY_ADVANCED_AND_BASIC;
        SetImageView(myDbHelper);
        return true;
    default: 
       return super.onOptionsItemSelected(item);
    }
} 
```

调用 SetImageView 函数时出现错误，该函数是在 OnCreate Activity 之外定义的。除非在 OnCreate 中定义，否则不能调用函数吗？

调用函数时出现 nullPointer 异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:21:25.387

如果您在 Activity 内（以及在 onCreate() 之外）定义 SetImageView (myDbHelper)，则可以像您一样调用它。

如果您收到 nullPointer 异常，原因可能是 myDbHelper 仍然为空。**检查这是否属实。**

顺便说一句，Java 建议我们对方法或变量的第一个字母使用小写字母，而对 Class 使用大写字母。

对不起，我无法评论，因为我没有足够的观点，所以即使我没有所有信息，我也必须直接回答。如果您发布更多代码和 logcat 信息。我会修改我的答案。

# ios - UIPopoverController 在内部触摸时会关闭

> ID：13113055
> 
> 赞同：0
> 
> 时间：2012-10-28T21:09:43.747
> 
> 标签：ios, uipopovercontroller

我有一个简单的 UIPopoverController 加载一个 Youtube 页面。一切正常，除了在其边界*内*进行触摸时弹出框似乎随机关闭。

这似乎并不一致（关于哪些触摸导致解雇，尽管它从来不是第一个），有没有其他人看到过这种行为？

我在下面使用的代码，正在加载的 URL 仅用于测试。

```
-(void)showWebPopover
{
    UIWebView * webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, WEBVIEW_POPOVER_WIDTH, WEBVIEW_POPOVER_HEIGHT)];
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://en.wikipedia.org/wiki/M"]]];
webView.backgroundColor = [UIColor blackColor];
//webView.scrollView.scrollEnabled = NO;

UIViewController *popOver = [[UIViewController alloc] init];
popOver.view.frame = CGRectMake(0, 0, WEBVIEW_POPOVER_WIDTH, WEBVIEW_POPOVER_HEIGHT);
popOver.view.backgroundColor = [UIColor blackColor];
popOver.contentSizeForViewInPopover = CGSizeMake(WEBVIEW_POPOVER_WIDTH, WEBVIEW_POPOVER_HEIGHT);
[popOver.view addSubview:webView];

self.webViewPopoverController = [[UIPopoverController alloc] initWithContentViewController:popOver];

CGRect rect = CGRectMake(self.view.frame.size.width/2, self.view.frame.size.width/2, 1, 1);
[self.webViewPopoverController presentPopoverFromRect:rect inView:self.view permittedArrowDirections:0 animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-22T23:23:25.323

可能为时已晚，但我只是遇到了这个问题并通过将 UITapGestureRecognizer 附加到视图控制器来解决它。（不是 PopoverController，而是 PopoverController 使用的控制器。）

IE

```
 func present (title:String, body:String, footer:String, sourceRect:CGRect) {
    if let fPopup = self.storyBoard.instantiateViewControllerWithIdentifier("GuideViewController") as? GuideViewController {
        popoverController = UIPopoverController(contentViewController: fPopup)
        fPopup.titleLabel.text = title
        fPopup.bodyTextField.text = body
        fPopup.footerLabel.text = footer

        //these 4 lines to set it up
        var touchRecognizer = UITapGestureRecognizer( target: self, action: Selector("handleTap:"))
        touchRecognizer.numberOfTapsRequired = 1
        touchRecognizer.numberOfTouchesRequired = 1
        fPopup.view.addGestureRecognizer(touchRecognizer)

        popoverController?.presentPopoverFromRect(sourceRect, inView: parentView, permittedArrowDirections: UIPopoverArrowDirection.Any, animated: true)
    }
}

func handleTap(sender: UITapGestureRecognizer) {
    if sender.state == .Ended {
        popoverController?.dismissPopoverAnimated(true)
    }
} 
```

# backbone.js - require.js i18n 模块 - 如何从服务器加载语言？

> ID：13113057
> 
> 赞同：3
> 
> 时间：2012-10-28T21:10:39.560
> 
> 标签：backbone.js, internationalization, requirejs

我的应用程序设置需要带有主干 js 的 js。

我有一种情况，我希望能够从浏览器导航器对象中为未知用户获取适当的语言，但如果存在此信息，我也可以从服务器加载已知用户的首选语言。

有没有办法做到这一点？我能找到的唯一访问点是在 require.config 中，但通常这是在任何数据从服务器到达之前加载的。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-23T07:30:57.770

您是否为用户设置了任何默认语言？首先登录时从服务器获取用户信息

你可以使用这种代码

```
setLanguage: function(languageCode){
enter code here
        this.set("languageCode",languageCode);
        if(this.isAvailable(i18n)){`enter code here`
            i18n.userSelected(languageCode);
        }else{`enter code here`
            this.showErrorMsg(window.i18n.msgStore['default_language_is_set_to'] + " " + constants.language[languageCode]);
        }
    },

set:function(key, value){
         localStorage.setItem(key, value);`enter code here`
    }, 
```

在这里，语言也被设置到本地存储中，以便稍后您可以访问它

# google-apps-script - 如何在谷歌电子表格中添加一行并引用另一个单元格？

> ID：13113061
> 
> 赞同：3
> 
> 时间：2012-10-28T21:11:40.157
> 
> 标签：google-apps-script, google-sheets

我正在尝试创建一个函数来从谷歌财务中提取数据并让它自动将数据记录到文档的多张纸上。我似乎无法让它添加一个函数作为一个函数它总是将它添加为文本，直到我编辑单元格

```
function addLog() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var rows = sheet.getDataRange();
  var numRows = rows.getNumRows();
  var numLastRows = rows.getLastRow();

  sheet.appendRow(['2012/10/28','=b92','=c92','Log (auto)','','=index(GoogleFinance(C92,"price",A92);2;2)','','=h92','=i92','=j92','=k92']);

}; 
```

我也不知道如何让它引用上面的单元格（在这种情况下为第 92 行）:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:38:22.347

您将需要使用`setFormula()`方法而不是`appendRow()`. 也许是这样的：

```
function addLog() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var numLastRow = sheet.getLastRow();

  //add a row at end if necessary
  if (sheet.getMaxRows() == numLastRow) sheet.insertRowAfter(numLastRow);

  sheet.getRange(numLastRow + 1, 2, 1, 10)
    .setFormulas([['=b' + numLastRow,
                  '=c' + numLastRow,
                  '',
                  '',
                  '=index(GoogleFinance(C' + numLastRow + ',"price",A' + numLastRow + ');2;2)',
                  '',
                  '=h' + numLastRow,
                  '=i' + numLastRow,
                  '=j' + numLastRow,
                  '=k' + numLastRow]]);
  sheet.getRange(numLastRow + 1, 1).setValue('2012/10/28');
  sheet.getRange(numLastRow + 1, 4).setValue('Log (auto)');
} 
```

* * *

要从第 x 个工作表到第 y 个工作表执行此操作（使用从零开始的索引），我认为最有效的方法是：

```
function addAllLog() {
  var sheets = SpreadsheetApp.getActive().getSheets();
  var x = 1;
  var y = 34;
  for (var i = x; i <= y; i++) {
    addLog(sheets[i]);
  }
}

function addLog(sheet) {
  var numLastRow = sheet.getLastRow();

  //add a row at end if necessary
  if (sheet.getMaxRows() == numLastRow) sheet.insertRowAfter(numLastRow);

  sheet.getRange(numLastRow + 1, 2, 1, 10)
    .setFormulas([['=b' + numLastRow,
                  '=c' + numLastRow,
                  '',
                  '',
                  '=index(GoogleFinance(C' + numLastRow + ',"price",A' + numLastRow + ');2;2)',
                  '',
                  '=h' + numLastRow,
                  '=i' + numLastRow,
                  '=j' + numLastRow,
                  '=k' + numLastRow]]);
  sheet.getRange(numLastRow + 1, 1).setValue('2012/10/28');
  sheet.getRange(numLastRow + 1, 4).setValue('Log (auto)');
} 
```

# ruby-on-rails - “如果”条件有问题

> ID：13113064
> 
> 赞同：2
> 
> 时间：2012-10-28T21:12:03.033
> 
> 标签：ruby-on-rails, ruby

我有一个索引视图，其中一个人输入两个玩家和一个分数，我的应用程序应该返回两者的获胜者。我通过参数哈希获取输入并尝试处理它，但似乎 if 中提供的第一个条件总是评估为真。下面是我的控制器操作中的代码，以及呈现响应的视图：

```
def find_winner
    @player_1 = params[:player_1]
    @player_2 = params[:player_2]
    @set_1 = params[:set_1]
    @set_2 = params[:set_2]
    @set_3 = params[:set_3]

      a = @set_1[0].to_i
      b = @set_1[1].to_i
      c = @set_2[0].to_i
      d = @set_2[1].to_i
      e = @set_3[0].to_i
      f = @set_3[1].to_i

      if ((a + c + e) > (b + d + f)) then 
        @winner = @player_1
      elsif ((a + c + e) < (b + d + f)) then 
        @winner = @player_2
      else
        @winner = "winner"
      end
  end 
```

以及来自 .erb 模板的代码：

```
<%= @player_1 %>
<%= @a %>
<%= @player_2 %>
<%= @set_1.class %>
<%= @set_2 %>
<%= @set_3 %>
<%= @b %>
<blockquote> the winner is <%= @winner %> 
```

@winner 总是评估为 player_1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T21:24:53.350

啊，最后，问题出**在**你的代码上。您的代码与数据格式不对应。在评论中，您显示您发送的示例数据。看：

```
set_1 = '3,6'

a = set_1[0].to_i # => 3
b = set_1[1].to_i # => 0 
```

`set_1`这是一个字符串，而不是您可能认为的数组。因此，它的第二个元素是逗号。并且将逗号转换为整数会产生 0。因此，(a, c, e) 的总和将始终大于零的总和 (b, d, f)。

你可能想做这样的事情：

```
a, b = params[:set_1].split(',').map(&:to_i)
c, d = params[:set_2].split(',').map(&:to_i)
e, f = params[:set_3].split(',').map(&:to_i) 
```

# hibernate - 一侧选项有限的多对多映射

> ID：13113065
> 
> 赞同：0
> 
> 时间：2012-10-28T21:12:06.940
> 
> 标签：hibernate, orm, mapping

我正在实现一个模拟电影院举行的 Java 应用程序。其中一个实体是 a `Film`，这个实体可以有很多`Genres`，但显然只有有限的数量`Genres`。我不确定我应该如何在 Hibernate 中实现它。

首先，我创建了一个枚举类`Genre`并给`Film`实体一个`Set<Genre> genres = new HashSet<>();`属性。

这样做的问题是，它`Genre`作为 a 存储`BLOB`在数据库中，在 Hibernate 创建的名为的表中`film_genres`，我将无法要求特定的所有电影`Genre`。（至少在我有限的 Hibernate 经验中）。

然后我想我可以在启动时填充数据库，`Genres`类`Genre`看起来像这样：

```
public class Genre {
    private Integer id;
    private String name;

    private Genre() {}

    public Genre(String name) {
        this.name = name;
    }

    public Integer getId() {
        return id;
    }

    private void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    private void setName(String name) {
        this.name= name;
    }
} 
```

很基础的一门课。但是现在说我想将 a 添加`Genre`到 a `Film`，我不能这样做：

```
Film film = new Film("The Terminal");
film.addGenre(new Genre("Drama")); 
```

看到这将为`Genre`每部类型剧的电影创建一个新对象。然后我是否必须先去数据库获取具有`Genre`“戏剧”价值的对象，然后添加该对象？

如果那是应该做的，那么我仍然想使用这样的枚举：

```
public enum GenreEnum {
    DRAMA("Drama"),
    ADVENTURE("Adventure"),
    ACTION("Action"),
    ...

    private String value;

    GenreEnum(String value) {
        this.value = value;
    }

    public String getValue() {
        return value;
    }
} 
```

这样做的原因是我可以完全控制进入数据库的初始值（预填充）和枚举值的拼写，所以我现在可以这样做：

```
Film film = new Film("The Terminal");
film.addGenre(GenreEnum.DRAMA); 
```

然后在`addGenre`我可以做的方法中：

```
public void addGenre(GenreEnum ge) {
    Query query = session.createQuery("from Genre g where g.name = " + ge.getValue());
    Genre genre = (Genre)query.list().get(0);
    this.genres.add(genre);
} 
```

我不会将事务代码放入模型中，但我只是为了简化而将其放在那里。我也意识到使用连接是不安全的。

这是一个不错的解决方案还是我错过了一些更简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T14:55:47.017

要么将流派作为一个整体作为主键

```
public enum Genre {
    DRAMA("Drama"),
    ADVENTURE("Adventure"),
    ACTION("Action"),
    ...

    private String value;

    GenreEnum(String value) {
        this.value = value;
    }

    public int getId() {
        return id;
    }

    public String getValue() {
        return value;
    }
}

<compositeId>
  <key-property name="value" />
</compositeId>

Film film = new Film("The Terminal");
film.addGenre(session.load<GenreEnum>(Genre.DRAMA));

// or
for(Genre g : GetAllGenre)
    session.attach(g);

Film film = new Film("The Terminal");
film.addGenre(Genre.DRAMA); 
```

或者在枚举中引入一个固定的Id

```
public enum Genre {
    DRAMA(1, "Drama"),
    ADVENTURE(2, "Adventure"),
    ACTION(3, "Action"),
    ...

    private int id;
    private String value;

    GenreEnum(int id, String value) {
        this.id = id;
        this.value = value;
    }

    public int getId() {
        return id;
    }

    public String getValue() {
        return value;
    }
}

Film film = new Film("The Terminal");
film.addGenre(session.load<GenreEnum>(Genre.DRAMA.getId())); 
```

# background - 代号一 - 如何将自定义背景应用于命令菜单选项卡

> ID：13113066
> 
> 赞同：3
> 
> 时间：2012-10-28T21:12:12.367
> 
> 标签：background, tabs, command, codenameone

我是使用 Codename One 的新手，我不知道如何将自定义背景（最好是平铺的 .png，但即使是自定义颜色也可以）应用到“命令”菜单选项卡。

我可以通过转到“属性”>“命令”>“编辑”在 GUI Builder 中设置每个选项卡的标题和图标，但是没有应用背景的选项，它们在模拟器中以白色背景显示。

不确定这是否会有所不同，但以防万一，在我的“主题”>“常量”中，我有以下设置：

```
'commandBehavior' = 'bar'
'dialogButtonCommandsBool' = 'true'
'includeNativeBool' = 'false' 
```

感谢您对此的任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T08:44:21.040

您需要在主题中添加“TouchCommand”条目并自定义其外观。

# php - 我可以将字符串文字添加到我的表中，但如果我将字符串作为变量传递，它仅适用于数字

> ID：13113068
> 
> 赞同：1
> 
> 时间：2012-10-28T21:12:21.797
> 
> 标签：php, mysqli

我有一个简单的 mysql 表![在此处输入图像描述](../Images/48890318a6cac2992d176e0d2f4156d8.png)

这是连接数据库并插入测试表的代码：

```
$mysqli = mysqli_connect($dbhost, $dbuser, $dbpass, $dbname);
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
} else {
    $sql = "INSERT INTO testtable
     VALUES (NULL, $forename)";

    $res = mysqli_query($mysqli, $sql);

    if($res === TRUE) {
        echo "data successfully inserted.";
    } else {
        printf("Could not insert data: %s\n", mysqli_error($mysqli));
    }

    mysqli_close($mysqli);
} 
```

在这种情况下，我尝试插入`$forename`到我的表中。如果我使用类似的字符串文字，`'Jim'`或者`'123'`它被插入。如果`$forename`给定值`123`或它被插入的任何其他数字。如果`$forename = 'Jim'`我收到一条错误消息，告诉我没有列`'Jim'`，就好像我在表中指定了一列一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:18:08.033

使用准备好的语句

```
$db= mysqli_connect($dbhost, $dbuser, $dbpass, $dbname);

 $sql = "INSERT INTO testtable (testfield)  VALUES (?)";

        if ($statement =$db->prepare($sql)){

        $statement->bind_param("s",$forename);
        msqi_stmt_execute($statement);
        }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:21:04.960

当 forename 为 'Jim' 时，查询扩展为“.... VALUES(NULL, Jim)”，但您想要“... VALUES(NULL, 'Jim')”。您的查询应为“...VALUES(NULL, 'Jim')”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T21:22:25.047

它以前发生在我身上，您在查询中缺少引号。尝试：

```
$sql = "INSERT INTO testtable VALUES ('{$forename}')"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T21:18:00.880

由于您的`id`字段是自动编号，因此您无需插入任何内容。您还应该真正养成指定要插入的列的习惯：

代替 ：

```
INSERT INTO testtable VALUES (NULL, $forename) 
```

采用：

```
INSERT INTO testtable 
(
    `testfield`
)
VALUES 
(
    '$forename'
) 
```

请注意，字段名称周围的“引号”是反引号，而不是单引号。

当然，像这样使用字符串插入是一种安全风险，所以你真的应该使用[准备好的语句](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)，正如 case1352 在他的回答中所展示的那样。

# google-contacts-api - 当联系人具有“已连接个人资料”时，联系人 API 调用将联系人姓名返回为空白

> ID：13113069
> 
> 赞同：2
> 
> 时间：2012-10-28T21:12:25.417
> 
> 标签：google-contacts-api

这个问题在google联系人官方论坛上没有得到回答，希望stackoverflow的人能给我一些帮助。我正在使用谷歌联系人 API 3.0 和网址：https://www.google.com/m8/feeds/contacts/default/full。如果用户有“关联个人资料”（Google+ 帐户），getName() 方法将为该联系人返回空白值。有什么解决方法吗？

# android - IntelliJ Idea 两个APK文件

> ID：13113073
> 
> 赞同：0
> 
> 时间：2012-10-28T21:13:02.027
> 
> 标签：android, intellij-idea, apk

我正在使用 IntelliJ Idea 进行 Android 开发。我想发布应用程序进行 Beta 测试，但是在构建应用程序后，应用程序文件夹中有两个 apk，另一个在 app 文件夹/bin 目录中的大小不同，bin 文件夹中的一个比 app 文件夹中的大.

**我的问题**

1.  为什么有两个apk？
2.  为什么两个apk的大小不同？
3.  哪一个应该用于通过电子邮件分发测试版？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T22:12:28.673

@cracycoder 的建议奏效了

*“检查 Android 方面设置和输出目录配置的模块设置。- CrazyCoder 10 月 28 日 21:54”*

# javascript - jQuery height() 没有返回值

> ID：13113074
> 
> 赞同：4
> 
> 时间：2012-10-28T21:13:10.887
> 
> 标签：javascript, jquery

我想制作一个当用户悬停另一个 div 时向下滚动的可滚动 div。可滚动 div 中的内容会发生变化（它只是文本），所以我无法为该 DIV 设置绝对高度值，这就是为什么 div 的高度为“自动”的原因。

当我在 '.post-right' div 的 CSS 上设置绝对高度值时，我找到了一个可行的解决方案，但如果 div 的高度是“自动”，它不会返回任何值，只是我喜欢我需要它。

我也尝试将 jQuery 代码块放在 (document).ready 函数上，结果完全相同。

有任何想法吗？提前致谢。

**HTML 代码：**

```
<div class="post-right-cont">
    <div class="post-right">
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut aliquam libero ut nisi consectetur pretium. Donec auctor auctor mauris, in tempor mauris blandit et. Aliquam nibh felis, tincidunt a auctor vel, feugiat at enim. Duis faucibus porta mi ut fringilla. Pellentesque eleifend erat a tellus aliquam sodales. Nullam lorem tellus, accumsan quis laoreet id, luctus et urna. Curabitur eleifend tellus non orci ullamcorper adipiscing. Integer est tellus, bibendum at ultricies a, viverra at orci. Curabitur porta tincidunt nunc, at placerat ipsum malesuada et. Vivamus et est purus, id suscipit tortor. Curabitur turpis metus, dapibus et consectetur non, tincidunt in est. Vestibulum nisl libero, sodales sit amet auctor eu, congue at velit. Vivamus et erat massa, nec viverra risus. Fusce iaculis dolor vel augue ornare accumsan.<br/><br/>

    Quisque a metus arcu. Suspendisse hendrerit commodo justo in sagittis. Phasellus a scelerisque quam. Fusce lacinia lacinia justo. Duis id hendrerit enim. Sed eleifend eros et turpis rutrum consectetur. Maecenas pulvinar volutpat odio, non imperdiet augue pretium quis. Proin rutrum, est vitae auctor dapibus, diam dolor rutrum libero, sed feugiat metus turpis sed mauris. Sed eleifend dolor arcu. Cras laoreet nibh convallis magna congue sit amet consequat tortor porttitor. Duis et mauris non lorem consectetur luctus. Aliquam mollis sem sit amet tortor iaculis egestas. Duis tincidunt pellentesque leo, nec vulputate turpis dapibus sit amet. Aliquam rhoncus luctus orci, et aliquet eros porttitor in. Etiam arcu eros, viverra tristique tincidunt vel, facilisis et mauris.<br/><br/>

        Morbi congue auctor luctus. Sed nisl dui, varius id ornare et, tincidunt sit amet enim. Aliquam egestas ultricies nisl, id condimentum erat fermentum quis. Morbi lectus nunc, aliquam volutpat egestas quis, iaculis a nulla. Pellentesque fermentum mauris at libero pulvinar viverra. Aliquam a ante orci, a luctus purus. Vivamus ut est ut mauris pulvinar mattis ac et magna. Aenean congue dictum lectus at suscipit. Suspendisse interdum, erat pulvinar gravida vulputate, mi mauris feugiat justo, at euismod augue sapien eu sapien. Praesent at quam purus. In hac habitasse platea dictumst. Fusce vel tellus a massa tempor volutpat a at magna. In eu enim odio. Quisque bibendum tortor est. Phasellus a scelerisque quam. Fusce lacinia lacinia justo. Duis id hendrerit enim. Sed eleifend eros et turpis rutrum consectetur. Maecenas pulvinar volutpat odio, non imperdiet augue pretium quis. Proin rutrum, est vitae auctor dapibus, diam dolor rutrum libero, sed feugiat metus turpis sed mauris. Sed eleifend dolor arcu.
    </div>
    <div class="scroll-down"></div>
    <div class="scroll-up"></div>
</div> 
```

**CSS：**

```
.post-right-cont {
    width: 540px;
    height: auto;
    overflow: hidden;
    position: relative;
}

.post-right {
    position: absolute;
    top: 0;
    left: 20px;
    height: auto;
    width: 480px;
    padding-top: 40px;
} 
```

**jQuery：**

```
$(window).load(function() {
// SCROLL POST

            // EDIT - post-right-cont height was set up before. I just past it here now.
    var wHeight = $(window).height();
            $('.post-right-cont').css('height', wHeight - 36);

    if ($('div.post-right').height() > $('.post-right-cont').height()) {

        $('div.scroll-down').hover(function() {animateContent('down');}, function() {
            $('div.post-right').stop();
        });

        $('div.scroll-up').hover(function() {animateContent('up');}, function() {
            $('div.post-right').stop(); 
        });
    }

    function animateContent(direction) {

        var containerHeight =  $('.post-right-cont').height();

        var textHeight = $('div.post-right').height();

        var animationOffset = textHeight - containerHeight;

        if (direction == "up") {
            animationOffset = 0;
        }

        $('div.post-right').animate({"top" : -animationOffset + "px" }, 8500);

    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T21:31:43.190

`$('.post-right-cont').height()`将返回一个值`0`，因为您只在其中包装了一个具有`absolute`定位的项目，因此绝对定位的元素不会增加`.post-right-cont`. 所以 jQuery 返回正确的值 - `0`. 的高度`.post-right`不会增加的高度，`.post-right-cont`因为绝对定位的元素不会增加其包装标签的高度或宽度。

# matlab - Matlab textscan 出错了：cellfun 从某些行中选择数据

> ID：13113077
> 
> 赞同：2
> 
> 时间：2012-10-28T21:13:24.230
> 
> 标签：matlab, textscan

嗨，我正在使用以下代码从 data.txt 中包含“GPGGA”的行中读取一些值

```
fid = fopen('D:\data.txt','r');
A=textscan(fid,'%s %*s %f %s %f %s %*s %*s %*s %*s %*s %*s %*s %*s %*s,'Delimiter',',');
fclose(fid);
Loc = [A{[2, 4]}];
row_idxs = cellfun( @(s) strcmp(s, '$GPGGA'), A{1});
Loc = Loc(row_idxs, :);
display(Loc); 
```

如果删除 data.txt 中的最后一行，该代码将完美运行。当最后一行包含在文本文件中时，不确定为什么会引发此错误。是什么原因？我很困惑！

“？？？错误使用 ==> horzcat CAT 参数尺寸不一致。==> 4 Loc = [A{[2, 4]}] 测试中的错误；”

数据.txt

```
$GPGSV,4,1,16,05,15,046,23,29,47,071,21,16,31,291,18,31,39,202,18*73
$GPGSV,4,1,16,05,15,046,23,29,47,071,21,16,31,291,18,31,39,202,18*73
$GPGSV,4,1,16,05,15,046,23,29,47,071,21,16,31,291,18,31,39,202,18*73
$GPGSV,4,1,16,05,15,046,23,29,47,071,21,16,31,291,18,31,39,202,18*73
$GPGSV,4,2,16,23,13,298,17,25,15,119,17,06,22,247,16,03,04,251,14*75
$GPGSV,4,2,16,23,13,298,17,25,15,119,17,06,22,247,16,03,04,251,14*75
$GPGSV,4,2,16,23,13,298,17,25,15,119,17,06,22,247,16,03,04,251,14*75
$GPGSV,4,2,16,23,13,298,17,25,15,119,17,06,22,247,16,03,04,251,14*75

$GPGGA,1.8,98.90,S,18.0014,E,1,04,1.0,87.8,M,48.0,M,,*76
$GPGGA,1.3,98.91,S,18.0015,E,1,04,1.0,100.7,M,48.0,M,,*40
$GPGGA,1.3,98.92,S,18.0016,E,1,04,1.0,105.4,M,48.0,M,,*4F
$GPGGA,1.8,98.93,S,18.0017,E,1,04,1.0,87.8,M,48.0,M,,*76
$GPGGA,1.8,98.94,S,18.0018,E,1,04,1.0,87.8,M,48.0,M,,*76
$GPGSV,4,4,16,27,,,,26,,,,24,,,,22,,,*79 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T05:38:13.513

你的格式字符串不好。它仅表示 15 列。您发布的示例数据有 20 列。我建议改用以下代码（在我的机器上运行没有错误）：

```
fid = fopen('D:\data.txt','r');
A=textscan(fid,'%s %*s %f %s %f %s %*[^\n]', 'Delimiter',',');
fclose(fid);
Loc = [A{[2, 4]}];
row_idxs = cellfun( @(s) strcmp(s, '$GPGGA'), A{1});
Loc = Loc(row_idxs, :);
display(Loc); 
```

请注意`%*[^\n]`我的格式字符串中的构造。这告诉`textscan`从此时开始忽略所有列。`%*s`它比一遍又一遍地写出来要整洁得多。此外，这意味着您在构建格式字符串时不太可能误算列数:-)

# javascript - 包含 Javascript 的奇怪行为

> ID：13113084
> 
> 赞同：0
> 
> 时间：2012-10-28T21:13:43.227
> 
> 标签：javascript, inclusion

您好我遇到了一些问题，包括我的 html 项目中的 javascript 文件。当我在正文标记之前像这样包含它时，我的网站无法正常工作。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    </body> 
```

但是，如果我删除最后的标签使其看起来像这样

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"/>
</body> 
```

一切正常。

如果我将它包含在头部，它也可以工作，与语法无关。为什么它会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:22:44.853

为了浏览器兼容性，您*必须*使用第一种形式：

```
<script src="https://..."></script> 
```

带有明确的结束标签`</script>`。如果这是您的代码无法正常工作的情况，那么您真正的问题在于其他地方，而不是您关闭标签的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:45:39.537

1.  做其他人所说的，关于`<script src="..."></script>`
2.  使用 just `src="//..."`，而不是`src="https://..."`或在非加密页面（http 与 https）上，您的访问者将收到混合两种协议的安全警告
3.  如果您在页面上的*任何位置*编写了 jQuery 代码，在实际包含该文件之前，您将收到引用错误，其中 JS 将无法找到`$`您尝试使用的函数 ( )。

如果您使用 Chrome，则可以使用调试器，然后按***:***`CTRL+SHIFT+J`它将带您进入开发者控制台，我相信您会在其中看到各种参考错误。

在 Firefox`CTRL+SHIFT+K`中是`F12`.

This works under the same premise as writing in other languages where you try to use libraries or other classes, but don't actually import them until the bottom of your program.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T21:24:43.870

您可能会遇到一些竞争情况...如果您可以提供完整的代码会很好...如果您将其附加在标题中...那么您的 jquery 将成功加载然后执行您的正文部分...如果您将其附加在正文中...然后关闭脚本会带来一些问题...尝试在更改正文标记中的脚本代码位置时播放。

`</script>`在跨浏览器中关闭是强制性的

这可能会帮助您进行调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T21:43:58.553

为什么要在代码末尾加载 jquery？如果您有其他一些需要 jquery 的脚本，那么它们应该在它之后加载。因此，要么将所有脚本标签放在头部或主体的末尾——jquery 应该在其他依赖它的文件之前加载。

# sql-server-2008 - 创建包含视图的视图 - 性能影响？

> ID：13113085
> 
> 赞同：2
> 
> 时间：2012-10-28T21:14:07.543
> 
> 标签：sql-server-2008, database-design, view, database-performance, rdbms

编写视图时 - 我应该坚持使用基表还是我可以确信在视图中包含视图不会损害性能。我想包含该视图，因为如果我对表设计进行更改而不是更新依赖于已更改表的每个视图，它将允许我更改一个基本视图。这似乎是更明智的做法，但要确保我没有做被认为是不好的做法或损害性能的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T21:19:34.883

在 SQL Server 中，视图在编译时得到解析。编译期间对性能的影响非常小。对实际查询执行没有影响。然而，这假设将选择相同的计划。如果嵌套包含复杂连接的视图，您可能会遇到访问表的频率超出必要的情况。优化器无法解决这个问题，系统最终会做很多不必要的工作。因此，请注意仅将视图放入不包含比通过编写没有视图的查询所访问的更多表的查询中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T11:19:55.227

从历史上看，一些平台在优化包含多个级别视图的查询时遇到了“麻烦”。我说“麻烦”，因为*大多数*时候即使是优化不佳的查询对我来说也足够快。（几乎一直都是。但我尽量不要生活在最前沿。）

几年前，我决定在有意义的时候使用视图。用心使用视图可以大大简化复杂的数据库；我们*都*知道。但我决定相信优化器会做得*足够好*，并相信开发人员会在我的查询埋没服务器之前发布升级，使优化器变得更好。

因此，如果我认为视图可以减轻我的精神负担*，*我就创建了一个视图。如果我需要查询视图的视图，我只是这样做了。

到目前为止，事实证明，这个决定对我来说是一个很好的决定。我从来没有用查询杀死过服务器，我仍然理解我的表和视图。（不过，在将查询转移到生产环境之前，我仍然会查看执行计划并测试性能。）

# php - 按位~运算符

> ID：13113093
> 
> 赞同：1
> 
> 时间：2012-10-28T21:14:59.853
> 
> 标签：php, bitwise-operators

我今天一直在尝试更多地了解 PHP 的按位运算符，但我在使用 ~ 运算符时遇到了一些麻烦。按照在线教程，我看到它反转了数字中的设置位。例如，如果您有一个等于 7 的字节：

```
 |------------------------------------|
    | 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    |------------------------------------|
    |  0  | 0  | 0  | 0  | 0 | 1 | 1 | 1 |
    |------------------------------------| 
```

并使用〜7反转它：

```
 |------------------------------------|
    | 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    |------------------------------------|
    |  1  | 1  | 1  | 1  | 1 | 0 | 0 | 0 |
    |------------------------------------| 
```

那不等于248而不是-8吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:18:23.283

不，原因是[二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)。

每个数字的第一位都有一个*负值*（PHP 中的 -2 ^(32)，因为 PHP 使用 32 位（= 4 字节）数字）。当该位设置为 1 时，整数将变为负数。因此，当使用非运算符 ( `~`) 时，该位将发生变化，数字将变为负数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:30:50.697

最左边的位表示符号是**二进制补码，0 表示正数，1 表示负数。**二进制补码是通过反转位并加 1 来计算的。在这种情况下，它是 1111000（除了符号位），然后减去 1（1110111）并反转它（0001000，负），所以它是 -8。在 C 中，带符号整数的范围是从 -2^15-1 到 2^15。

# ruby-on-rails - 为什么 Declarative_Authorization 中的 :attribute_check 找不到 ID

> ID：13113094
> 
> 赞同：0
> 
> 时间：2012-10-28T21:15:09.163
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, declarative-authorization

自从在 Ruby on Rails 3.1 上使用 Declarative_Authorization 以来，我一直遇到问题。我在每个控制器的顶部添加了这个：

```
class UsersController < ApplicationController

    # Verifies that the user is connected and/or authorized to access the methods
    filter_access_to :all, :attribute_check => true

    (...)
end 
```

它允许我在我的`authorization_rules.rb`:

```
has_permission_on [:albums], :to => [:adding] do
    if_attribute :group => { :user => is { user } }
end 
```

但是当我添加`:attribute_check => true`我得到这个错误：

```
Couldn't find {Model} without an ID 
```

我完全迷路了，我是从这个宝石开始的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:08:53.300

您的用户变量可能为 null，因此请找出错误原因为 null

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T21:09:14.107

I found the trick, just add this on the top of the controller :

```
class Group
    before_filter :set_group
    (...)
    protected
    def set_group
        @group = Group.find_by_slug(params[:slug])
    end
end 
```

# javascript - ms:XSLT 中的脚本标签

> ID：13113095
> 
> 赞同：0
> 
> 时间：2012-10-28T21:15:10.617
> 
> 标签：javascript, .net, xslt

我正在尝试将 ASP Classic 应用程序迁移到 .Net 4.0（4.5 也可以接受）。该应用程序负责使用 Javascript 扩展函数执行 XSL 转换。ASP Classic 应用程序当前使用 MSXML 4.0 来执行转换。

当我尝试使用 XslCompiledTransform 类来处理包含 javascript 扩展的转换时，我在 .Net 中遇到了问题。它适用于简单的示例，但我们有一个相当广泛的 javascript 库，随着测试用例变得越来越复杂，我看到了错误。这些错误中最令人沮丧的是语法错误，例如 .Net 解析器似乎不喜欢函数之外的语句。

谁能告诉我哪个类用于解析和编译 javascript 扩展以及是否有完整的文档。也可以将 javascript 处理器对象替换为自定义对象（以类似于 UriResolver 的方式）。

此外，是否可以使用解析器规则让 Visual Studio 在查看文件时突出显示 javascript 语法错误。我很确定它已经为网页等中使用的 javascript 代码做到了这一点，但是 XSLT 中的语法规则似乎有所不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T04:02:24.557

AFAIR XslCompiledTransform 使用 CodeDom 编译嵌入式脚本。它的工作方式是 XslCompiledTransform 创建一个代码文件，然后将其传递给 CodeDom 进行编译。我相信 MSXML 使用的 JavaScript 引擎与 CodeDom 使用的引擎不同。因此编译问题。此外（自从我查看它已经有一段时间了）可能会发生一些额外的处理以使脚本可编译（我记得对于 C# 中的脚本，创建了一个类，并且所有函数都放在了这个类中）。请注意，由 CodeDom 创建的程序集会加载到执行转换的 appdomain 中。这可能会导致 OutOfMemory 异常，因为 CLR 不允许卸载程序集 - 我前段时间在这里写过：[http://blogs.msdn.com/b/xmlteam/archive/2011/09/26/effective-xml-part-5-something-went-really-wrong-outofmemoryexception-and-stackoverflowexception-throw-when-using- xslcompiledtransform.aspx](http://blogs.msdn.com/b/xmlteam/archive/2011/09/26/effective-xml-part-5-something-went-really-wrong-outofmemoryexception-and-stackoverflowexception-thrown-when-using-xslcompiledtransform.aspx)

# sql - 如何在 PostgreSQL 中将平均值舍入到小数点后 2 位？

> ID：13113096
> 
> 赞同：258
> 
> 时间：2012-10-28T21:15:11.910
> 
> 标签：sql, ruby, postgresql, sequel

我通过 Ruby gem 'sequel' 使用 PostgreSQL。

我正在尝试四舍五入到小数点后两位。

这是我的代码：

```
SELECT ROUND(AVG(some_column),2)    
FROM table 
```

我收到以下错误：

```
PG::Error: ERROR:  function round(double precision, integer) does 
not exist (Sequel::DatabaseError) 
```

运行以下代码时没有错误：

```
SELECT ROUND(AVG(some_column))
FROM table 
```

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2012-10-28T22:25:30.680

PostgreSQL 没有定义`round(double precision, integer)`. 由于*@Mike Sherrill 'Cat Recall'*在评论中解释的原因，需要精度的 round 版本仅适用于`numeric`.

```
regress=> SELECT round( float8 '3.1415927', 2 );
ERROR:  function round(double precision, integer) does not exist

regress=> \df *round*
                           List of functions
   Schema   |  Name  | Result data type | Argument data types |  Type  
------------+--------+------------------+---------------------+--------
 pg_catalog | dround | double precision | double precision    | normal
 pg_catalog | round  | double precision | double precision    | normal
 pg_catalog | round  | numeric          | numeric             | normal
 pg_catalog | round  | numeric          | numeric, integer    | normal
(4 rows)

regress=> SELECT round( CAST(float8 '3.1415927' as numeric), 2);
 round 
-------
  3.14
(1 row) 
```

（在上面，请注意这`float8`只是 . 的简写别名`double precision`。您可以看到 PostgreSQL 在输出中扩展它）。

您必须将要四舍五入的值转换`numeric`为使用 的两个参数形式`round`。只需附加`::numeric`速记演员表，例如`round(val::numeric,2)`.

* * *

如果您正在格式化以向用户显示，请不要使用`round`. 使用`to_char`（请参阅：手册中的[数据类型格式化函数](http://www.postgresql.org/docs/current/static/functions-formatting.html)），它允许您指定格式并为您提供`text`不受客户端语言可能对`numeric`值造成的任何怪异影响的结果。例如：

```
regress=> SELECT to_char(float8 '3.1415927', 'FM999999999.00');
    to_char    
---------------
 3.14
(1 row) 
```

`to_char`作为格式化的一部分，将为您四舍五入。`FM`前缀告诉`to_char`您不想要任何带有前导空格的填充。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2014-01-05T13:28:45.203

        （（（这是一个 Wiki！请编辑以增强！））

还可以尝试使用旧语法进行转换，

```
SELECT ROUND( AVG(some_column)::numeric, 2 ) FROM table; 
```

适用于任何版本的 PostgreSQL。
...但是，作为最终解决方案，您可以[重载](https://en.wikipedia.org/wiki/Function_overloading)ROUND 函数。

## 重载作为铸造策略

```
CREATE FUNCTION ROUND(float,int) RETURNS NUMERIC AS $f$
  SELECT ROUND( CAST($1 AS numeric), $2 )
$f$ language SQL IMMUTABLE; 
```

现在你的指令可以正常工作了，试试这个完整的比较：

```
SELECT trunc(n,3), round(n,3) n_round, round(f,3) f_round,
       pg_typeof(n) n_type, pg_typeof(f) f_type, pg_typeof(round(f,3)) f_round_type
FROM (SELECT 2.0/3.0, 2/3::float) t(n,f); 
```

| 截断 | n_round | f_round | n_type | f_type | f_round_type |
| --- | --- | --- | --- | --- | --- |
| 0.666 | 0.667 | 0.667 | 数字 | 双精度 | 数字 |

ROUND(float , *int)*函数是`f_round`，它返回一个（十进制）NUMERIC 数据类型，这对于某些应用程序来说很好：问题解决了！

在另一个应用程序中，我们也需要一个浮点数。另一种方法是使用`round(f,3)::float` 或创建一个`round_tofloat()`函数。另一种选择，`ROUND`再次重载函数，并使用浮点数的所有精度范围[**，**](https://en.wikipedia.org/wiki/Accuracy_and_precision)是在定义精度时返回一个浮点数（参见[IanKenney 的答案](https://stackoverflow.com/a/16246957/287948)），

```
CREATE FUNCTION ROUND(
  input float,     -- the input number
  accuracy float   -- accuracy, the "counting unit"
) RETURNS float AS $f$
   SELECT ROUND($1/accuracy)*accuracy
$f$ language SQL IMMUTABLE; 
```

尝试

```
 SELECT round(21.04, 0.05);     -- 21.05 float!
  SELECT round(21.04, 5::float); -- 20
  SELECT round(1/3., 0.0001);    -- 0.3333
  SELECT round(2.8+1/3., 0.5);   -- 3.15
  SELECT round(pi(), 0.0001);    -- 3.1416 
```

PS：命令`\df round`，在`psql` 重载后，将显示类似这个表的内容

```
架构 | 姓名 | 结果 | 争论  
------------+-------+------------+------------------
 架构 | 圆| 数字 | 浮点数，整数
 架构 | 圆| 浮动 | 漂浮，漂浮
 pg_catalog | 圆| 浮动 | 漂浮            
 pg_catalog | 圆| 数字 | 数字   
 pg_catalog | 圆| 数字 | 数字，整数          

```

其中*float*是同义词，`double precision`而*myschema*是`public`当您不使用模式时。这些`pg_catalog`函数是默认函数，请参阅指南[内置数学函数](https://www.postgresql.org/docs/current/functions-math.html)。

## 舍入和成型

该`to_char`函数在内部应用*循环*过程，因此，当您的目标只是在终端中显示最终结果时，您可以使用[`FM`修饰符](https://www.postgresql.org/docs/current/functions-formatting.html#FUNCTIONS-FORMATTING-NUMERIC-TABLE)作为数字格式模式的前缀：

```
SELECT round(x::numeric,2), trunc(x::numeric,2), to_char(x, 'FM99.99')
FROM (SELECT 2.0/3) t(x); 
```

| 圆形的 | 截断 | to_char |
| --- | --- | --- |
| 0.67 | 0.66 | .67 |

* * *

## 笔记

### 问题的原因

**某些 PostgreSQL 函数缺少重载**，为什么（？？？）：我认为“这是一个不足”（！），但 @CraigRinger、@Catcall 和 PostgreSQL 团队同意*“pg 的历史理由”*。

### 关于性能和重用的注意事项

与直接强制转换编码相比，内置函数（例如 pg_catalog 的 ROUND）可以重载而不会造成性能损失。**在实现高性能的**用户定义转换函数时，必须采取两个预防措施：

*   该`IMMUTABLE`子句对于这样的代码片段非常重要，因为正如指南中所说：*“允许优化器在查询使用常量参数调用函数时预先评估函数”*

*   PLpgSQL 是首选语言，“纯 SQL”除外。对于[JIT 优化](https://www.postgresql.org/docs/current/jit-reason.html)（有时对于并行性）`language SQL`可以获得更好的优化。类似于复制/粘贴一小段代码而不是使用函数调用。

结论：上面的`ROUND(float,int)`函数，经过优化，**比**@CraigRinger的回答快多了；它将编译为（完全）**相同的内部表示**。因此，虽然它不是 PostgreSQL 的标准，但它可以成为您的项目的标准，通过一个集中且可重用的“片段库”，如 [pg_pubLib](https://github.com/AddressForAll/pg_pubLib-v1)。

* * *

### 四舍五入到第 n 位或其他数字表示

有些人认为 PostgreSQL 对 float 数据类型进行四舍五入是没有意义的，因为**float 是二进制表示**，它需要对位数或其十六进制表示进行四舍五入。

好吧，让我们解决这个问题，添加一个奇特的建议......这里的目的是在另一个重载函数中返回一个*浮点*
  `ROUND(float, text, int) RETURNS float`
类型，即`text`提供一个选择

*   `'dec'`对于“十进制表示”，
*   `'bin'`对于“二进制”表示和
*   `'hex'`用于十六进制表示。

因此，在不同的表示中，我们对要四舍五入**的位数有不同的解释。***当d*计算二进制数字而不是十进制或十六进制时，将数字*x*用一个近似较短的值舍入，用较少的“小数位”（tham 其原始*d*数字）将更短。

 *没有 C++，使用“纯 SQL”并不容易，但是这段代码片段将说明并且可以用作解决方法：

```
-- Looking for a round_bin() function! this is only a workaround:
CREATE FUNCTION trunc_bin(x bigint, t int) RETURNS bigint AS $f$
    SELECT ((x::bit(64) >> t) << t)::bigint;
$f$ language SQL IMMUTABLE;

CREATE FUNCTION ROUND(
   x float, 
   xtype text,  -- 'bin', 'dec' or 'hex'
   xdigits int DEFAULT 0
) 
RETURNS FLOAT AS $f$
    SELECT CASE
       WHEN xtype NOT IN ('dec','bin','hex') THEN 'NaN'::float
       WHEN xdigits=0 THEN ROUND(x)
       WHEN xtype='dec' THEN ROUND(x::numeric,xdigits)
       ELSE (s1 ||'.'|| s2)::float
      END
    FROM (
      SELECT s1,
             lpad( 
               trunc_bin( s2::bigint, CASE WHEN xd<bin_bits THEN bin_bits - xd ELSE 0 END )::text,
               l2,
               '0'
             ) AS s2
      FROM (
        SELECT *, 
             (floor( log(2,s2::numeric) ) +1)::int AS bin_bits, -- most significant bit position
             CASE WHEN xtype='hex' THEN xdigits*4 ELSE xdigits END AS xd
        FROM (
          SELECT s[1] AS s1, s[2] AS s2, length(s[2]) AS l2
          FROM (SELECT regexp_split_to_array(x::text,'\.')) t1a(s)
        ) t1b
      ) t1c
    ) t2
$f$ language SQL IMMUTABLE; 
```

尝试

```
 SELECT round(1/3.,'dec',4);     -- 0.3333 float!
 SELECT round(2.8+1/3.,'dec',1); -- 3.1 float!
 SELECT round(2.8+1/3.,'dec');   -- ERROR, need to cast string 
 SELECT round(2.8+1/3.,'dec'::text); -- 3 float
 SELECT round(2.8+1/3.,'dec',0); -- 3 float

 SELECT round(2.8+1/3.,'hex',0); -- 3 float (no change)
 SELECT round(2.8+1/3.,'hex',1); -- 3.1266
 SELECT round(2.8+1/3.,'hex',3); -- 3.13331578486784

 SELECT round(2.8+1/3.,'bin',1);  -- 3.1125899906842625
 SELECT round(2.8+1/3.,'bin',6);  -- 3.1301821767286784
 SELECT round(2.8+1/3.,'bin',12); -- 3.13331578486784 
```

并且`\df round`还有：

```
 Schema     |  Name | Result  | Argument  
------------+-------+---------+---------------
 myschema   | round | float   | x float, xtype text, xdigits int DEFAULT 0 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2016-05-25T21:33:29.730

试试这个：

```
SELECT to_char (2/3::float, 'FM999999990.00');
-- RESULT: 0.67 
```

或者简单地说：

```
SELECT round (2/3::DECIMAL, 2)::TEXT
-- RESULT: 0.67 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2019-06-10T09:51:36.130

你可以使用下面的功能

```
 SELECT TRUNC(14.568,2); 
```

结果将显示：

```
14.56 
```

您还可以将变量转换为所需类型：

```
 SELECT TRUNC(YOUR_VAR::numeric,2) 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-12-10T21:48:52.507

尝试将您的列转换为数字，例如：

```
SELECT ROUND(cast(some_column as numeric),2) FROM table 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2020-05-21T08:45:21.977

```
SELECT ROUND(SUM(amount)::numeric, 2) AS total_amount
FROM transactions 
```

给：200234.08

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-02-20T13:56:33.623

根据[Bryan 的](http://postgresql.nabble.com/float-to-numeric-7-3-td5552098.html)回复，您可以这样做以限制查询中的小数。我将 km/h 转换为 m/s 并将其显示在 dygraphs 中，但是当我在 dygraphs 中进行转换时，它看起来很奇怪。在查询中进行计算时看起来不错。这是在 postgresql 9.5.1 上。

```
select date,(wind_speed/3.6)::numeric(7,1) from readings; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-12-21T10:23:47.287

> 错误：函数回合（双精度，整数）不存在

**解决方案**：您需要添加类型转换然后它才会起作用

前任： `round(extract(second from job_end_time_t)::integer,0)`*

# android - Android Smb目录列表强制关闭

> ID：13113099
> 
> 赞同：0
> 
> 时间：2012-10-28T21:15:25.377
> 
> 标签：android, directory, share, smb, jcifs

这是我在这里遇到的一个奇怪的问题。我在我的 android 应用程序中使用来自 jcifs 套件的 SmbFile。我已经做过很多次了。我目前使用 Droid X 调试我的大部分应用程序，但最近才获得了新的 Droid Razr HD。我使用以下代码构建了一些新的应用程序，它们通过 SmbFile 连接到 PC 共享：

```
 SmbFile dir = null;
    try {
        dir = new SmbFile(smbFile, auth);
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    try {
            Log.i("Debug", "Authenticated...");
            if(dir.list() != null){
                shares2 = dir.list();
                fa2 = dir.listFiles();
            }
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

我在我的一个应用程序中使用这个完全相同的代码，由于它在市场上，它与 Droid X 和 Droid RAZR HD 以及许多其他应用程序配合得很好。但是在我正在研究的当前版本中，它不起作用。权限设置得很好，它会进行身份验证，但每次都会强制关闭：

```
 shares2 = dir.list(); 
```

它不会强制关闭其他设备。我不明白。相同的代码在我的另一个适用于 Droid RAZR HD 的应用程序中，但不是这个应用程序。我已经测试并检查了凭据和输入。万事皆安。我试图捕捉错误，但它没有打印出什么错误，只是强行关闭并告诉我这是问题所在。任何人都知道问题可能是什么？同样，我认为它是我的代码，但该代码适用于另一台设备。然后我认为它是设备，但完全相同的代码在我的另一个应用程序中，并且可以在这个设备上运行。

编辑 这是我来自 Droid razorbacks HD 的日志

V/RecentsPanelView（838）：开始活动意图{act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10304000 cmp=com.getmyitunes.project/。GetMyiTunes } I/ActivityManager（535）：开始 {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10304000 cmp=com.getmyitunes.project/。GetMyiTunes} from pid 838 I/ActivityManager(535): 为活动 com.getmyitunes.project/.GetMyiTunes 启动 proc com.getmyitunes.project: pid=1365 uid=10149 gids={3003, 1015} I/ActivityManager(535):显示 com.getmyitunes.project/.GetMyiTunes: +382ms I/GetMyiTunes(1365): 更新凭据 I/ActivityManager(535): START {cmp=com.getmyitunes.project/.ListFiles (has extras)} from pid 1365 I/ GetMyiTunes（1365）：用户/弗吉尼亚/音乐/iTunes/iTunes Media/Music/I/GetMyiTunes（1365）：192.168.1.136 I/GetMyiTunes（1365）：Virginia I/GetMyiTunes（1365）：corneta I/GetMyiTunes（1365）：已认证... E/AndroidRuntime（1365）：在 com.getmyitunes.project。ListFiles.getiTunes(ListFiles.java:131) E/AndroidRuntime(1365)：在 com.getmyitunes.project。ListFiles.onCreate(ListFiles.java:82) W/ActivityManager(535)：强制完成活动 com.getmyitunes.project/.ListFiles W/ActivityManager(535)：强制完成活动 com.getmyitunes.project/.GetMyiTunes W/ActivityManager( 535): ActivityRecord{42653f68 com.getmyitunes.project/.ListFiles} I/WindowManager(535): WIN DEATH: Window{41f45e78 com.getmyitunes.project/com. getmyitunes.project.GetMyiTunes paused=true} I/ActivityManager(535)：进程 com.getmyitunes.project (pid 1365) 已终止。W/ActivityManager（535）：ActivityRecord{425f5a70 com.getmyitunes.project/ 的活动销毁超时。

# ruby-on-rails-3 - Rails：实现多步骤注册流程（使用 OmniAuth）

> ID：13113100
> 
> 赞同：0
> 
> 时间：2012-10-28T21:15:29.190
> 
> 标签：ruby-on-rails-3, omniauth, state-machine

我正在尝试实施多步骤注册过程。此特定实现涉及 OmniAuth，但出于本讨论的目的，它很可能是任何 OAuth 提供者。

以下是我们可能实施的注册步骤：

**步骤 1.**用户*点击*Connect with ***_* __ *_* __ *_* __**。

**步骤 2.通过*****_* __ *_* __ *_* __**授权并重定向到回调。从提供者那里提取相关数据并保存到您的`User`模型中。

**第 3 步**：选择用户名、填写电子邮件地址以及注册您的应用所需的任何其他数据。也将其保存到您的`User`模型中。

**对我来说，问题**在于从第 2 步到第 3 步的过渡。例如，**我可以**根据状态设置数据验证，例如使用[**state_machine 之**](https://github.com/pluginaweek/state_machine)类的东西。

**但是**，对于某些基本数据片段，我必须在列级别删除非空约束，例如`username`在我的情况下（用于用户路由），或者`email`. 我不太愿意移除另一层数据完整性。

我确信这个问题之前已经解决了一千次。你是如何处理它的，你会建议我如何处理它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:18:58.403

您能否将来自提供商的数据添加为表单中的隐藏字段，以便第 3 步选择用户名、电子邮件地址等？这样，在您拥有所有可用数据之前，您不会创建`User`实例。

# php - 定义将使用 $_POST 中的数组作为参数的 PHP 函数？

> ID：13113103
> 
> 赞同：-4
> 
> 时间：2012-10-28T21:15:53.333
> 
> 标签：php, function, post

我正在尝试定义一个函数，它将使用 $_POST 中的数组作为参数，但有些东西不起作用。这就是我所拥有的：任何想法为什么不起作用？谢谢。

```
function variables_set ($Array1, $Array2, $DayOfWeek) {
    if (isset($Array2)) {
        $DayOfWeek=array_unique($Array2); //Remove duplicate values in the array
    } else {
        $DayOfWeek=$Array1;                             
    }
}

variables_set ($_POST['selectM'], $_POST['hiddenM'], $Monday); //Call the function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:20:18.870

对我来说，使用`isset()`似乎模棱两可，因为一旦你尝试传递一个未设置的变量，就会抛出一个通知。考虑下面的代码：

```
function test($a){
    echo '$a is' . (isset($a) ? '' : 'not').' set';
}

echo '$b is' . (isset($b) ? '' : 'not').' set';
test($b); // Notice: Undefined variable: b 
```

另请注意，这与索引相同，就像您的情况一样。

* * *

**编辑：**下面的代码应该是这样的：

```
function test($a){
    if(!is_null($a)){
        // do something with $a
    }
}

test(isset($_POST['selectM']) ? $_POST['selectM'] : null); 
```

# java - 使用准备好的语句查询列表 (JDBC)

> ID：13113105
> 
> 赞同：3
> 
> 时间：2012-10-28T21:16:14.693
> 
> 标签：java, sql, database, jdbc, prepared-statement

我目前有一个方法，如下所示：

```
public void foo(Date date) {
    PreparedStatement stmt; 
    ResultSet rs;
    java.sql.Date sDate = new java.sql.Date(date.getTime());

    try {
        String sql = "select * from some_table p where p.start_date <=? and ?<= p.end_date";
        stmt = getConnection().preparedStatement(sql);
        stmt.setDate(1, sDate);
        stmt.setDate(2, sDate);
        rs = stmt.executeQuery();
        //... 
    } finally {
        if (rs != null) { rs.close(); }
        if (stmt != null) { stmt.close(); }
    }
} 
```

现在，我不想传递一个 Date 对象，而是传递日期列表 ( `List<Date> dates`)。我想我在技术上可以多次调用 foo ，同时遍历列表，但是有没有一种方法可以实现这一点而不必多次调用 foo ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:23:40.253

与其传递单个 Date 对象，不如考虑将 Date 对象的 ArrayList 传递给您的`foo(...)`方法并使用它。

您有几个选项可以使用。

**选项 1：**通过更改参数多次执行 PreparedStatement

```
public void foo(ArrayList<Date> dateList) {
    if(dateList == null)
        return;

    PreparedStatement stmt = null;
    ResultSet rs = null;    
    java.sql.Date sDate = null;
    try{
        stmt = getConnection().preparedStatement("select * from some_table p where p.start_date <=? and ?<= p.end_date");

        for(Date date: dateList){
            try{
                sDate = new java.sql.Date(date.getTime());
                stmt.clearParameters(); //Clear current parameter values
                stmt.setDate(1, sDate);
                stmt.setDate(2, sDate);
                rs = stmt.executeQuery();

                //perform your operations
            }finally{
                sDate = null;
                //mange your resultset closing
            }
        }
    }finally{
        //your resource management code
    }  
} 
```

**选项 2**：创建一个 SQL 查询，考虑到您在列表中的日期数，执行此语句，然后使用结果集。

```
public void foo(ArrayList<Date> dateList) {
    if(dateList == null)
        return;

    PreparedStatement stmt = null;
    ResultSet rs = null;    
    java.sql.Date sDate = null;
    StringBuilder builder = new StringBuilder();

    try{
        //1\. Create your dynamic statement
        builder.append("SELECT * FROM some_table p WHERE \n");
        for(int index = 0; index < dateList.length; index++){
            if(index > 0)
                builder.append(" OR \n");
            builder.append("(p.start_date <=? and ?<= p.end_date)");
        }

        stmt = getConnection().preparedStatement(builder.toString());

        //2\. Set the parameters
        int index = 1;
        for(Date date: dateList){
            try{
                sDate = new java.sql.Date(date.getTime());
                stmt.setDate(index, sDate);
                stmt.setDate(index+1, sDate);
                index += 2;
            }finally{
                sDate = null;
                //mange your resultset closing
            }
        }

        //3\. execute your query
        rs = stmt.executeQuery();

        //4\. perform your operations
    }finally{
        builder = null;
        //your resource management code
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:31:01.090

这是一种仅使用一个数据库调用的解决方案。这不会检查 null 或 empty `dateList`，相反它假定至少有一个元素。

```
public void foo(List<Date> dateList) {
    PreparedStatement stmt; 
    ResultSet rs;

    try {
        // Step 1 : build the query string, based on the number of elements in the list
        StringBuilder sql = new StringBuilder("select * from some_table p where (p.start_date <=? and ?<= p.end_date)");
        if (dateList.size() > 1) {
            for (int i = 1; i < dateList.size(); i++) {
                sql.append(" or (p.start_date <=? and ?<= p.end_date)");
            }
        }

        stmt = getConnection().preparedStatement(sql.toString());

        // Step 2 : pass the actual list of dates to the query
        for (int i = 0; i < dateList.size(); i++) {
            java.sql.Date date = new java.sql.Date(dateList.get(i).getTime());
            stmt.setDate((i * 2) + 1, date);
            stmt.setDate((i * 2) + 2, date);
        }

        rs = stmt.executeQuery();
        //... 
    } finally {
        if (rs != null) { rs.close(); }
        if (stmt != null) { stmt.close(); }
    }
} 
```

# javascript - animate 函数在 chrome 中有效，但在 Firefox 中无效

> ID：13113107
> 
> 赞同：3
> 
> 时间：2012-10-28T21:16:23.690
> 
> 标签：javascript, jquery, html, css, slide

我有一个居中的 div 和 4 个其他 div - 在居中的 div 的每一侧都有一个。当我单击一个按钮时，每个 div 都会滑入框架并将居中的 div 推出。

它在 chrome 中运行良好，但使用 firefox 失败，让我没有任何来自 firebug 的错误。

[这](http://www.uvm.edu/~areid/homesite/index.html)是我的实现，目前在 Firefox 中无法正常工作。

如您所见，在 Firefox 中，居中的 div 只是消失了，而不是滑出屏幕。使用 chrome，居中的 div 按预期滑出。

有人可以看看萤火虫并告诉我他们认为可能导致问题的原因吗？

此代码基于 jsfiddle，可使用 chrome 或 firefox 正常工作。

这是jsfiddle的代码：

这是**html**

```
<div id="fullContainer">
    <div id="right">

    </div>
    <div id="left">

    </div>
    <div id="top">

    </div>
    <div id="bottom">

    </div>
</div>
<div id="centerContainer">
    <div id="relativeContainer">
        <div id="content">
            This is where your face should go.  Notice that I placed it within a centering div.  
            This will enable the face to be absolutely positioned, and allow for you to modify 
            it's position when the side-bars slide in.
            <div data-move="left">Open Left</div>
            <div data-move="right">Open Right</div>
            <div data-move="top">Open Top</div>
            <div data-move="bottom">Open Bottom</div>
        </div>
    </div>
</div> 
```

这是**CSS**

```
#centerContainer {
    position:fixed;
    top:50%;
    left:50%;
    width:0;
    height:0;
}
#relativeContainer {
    position:relative;
}
#fullContainer {
    position:fixed;
    width:100%;
    height:100%;
    top:0;
    left:0;
}
#content {
    position:absolute;
    width:300px;
    height:400px;
    top:-200px;
    left:-150px;
    background:#BADA55;
    border:1px solid #444;
    padding:10px;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s ease;
}
#content.right {
    left:-250px;
}
#content.left {
    left:-50px;
}
#content.bottom {
    top:-300px;
}
#content.top {
    top:-100px;
}

#content div {
    cursor:pointer;
    color:blue;
    text-decoration:underline;
    margin-top:15px;
    text-align:center;
}
#left {
    position:absolute;
    top:0;
    left:-125px;
    height:100%;
    width:100px;
    background:blue;
    border:1px solid #444;
    padding:10px;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s ease;
}

#left.opened {
    left:0;
}

#right {
    position:absolute;
    top:0;
    right:-125px;
    height:100%;
    width:100px;
    background:green;
    border:1px solid #444;
    padding:10px;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s ease;
}

#right.opened {
    right:0;
}

#top {
    position:absolute;
    left:0;
    top:-125px;
    width:100%;
    height:100px;
    background:yellow;
    border:1px solid #444;
    padding:10px;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s ease;
}

#top.opened {
    top:0;
}

#bottom {
    position:absolute;
    left:0;
    bottom:-125px;
    width:100%;
    height:100px;
    background:red;
    border:1px solid #444;
    padding:10px;
    -webkit-transition: all 0.5s ease;
    -moz-transition: all 0.5s ease;
    -o-transition: all 0.5s ease;
    transition: all 0.5s ease;
}

#bottom.opened {
    bottom:0;
} 
```

这是**javascript**：

```
function SlideOut(element){

    $(".opened").removeClass("opened");
    $("#"+element).addClass("opened");
    $("#content").removeClass().addClass(element);

}
$("#content div").click(function(){

    var move = $(this).attr('data-move');

    SlideOut(move);

}); 
```

这是[小提琴](http://jsfiddle.net/WVPDH/2/)

谢谢

凯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:10:13.273

我做了一些测试，发现发生了什么。出于说明和演示目的，在此[小提琴中对此进行了复制。](http://jsfiddle.net/4GRSM/)

在 Firefox 中，如果您正在转换 CSS 属性`left`，它需要有一个初始值才能开始。如果没有，那么它不会转换，它只会将值分配给属性。

在 Chrome 中，如果您没有设置初始值，它显然只是从它所在的任何地方开始，不用担心它。

如果您在 Firefox 中查看上述小提琴并单击第一行，它只会出现在更远的位置，而第二行则过渡到上方。唯一的区别是第二行有一个`left: 0`初始设置。在 Chrome 上，两者的工作方式相同。

如果你把 a`left: 0`放在你的`#content div`上面，它会像在 Firefox 中一样滑动。（在 Firebug 中测试并且确实修复了它）。

# c++ - 在 Arduino 中使用 SD.remove() 和 SD 库

> ID：13113113
> 
> 赞同：1
> 
> 时间：2012-10-28T21:17:37.613
> 
> 标签：c++, c, arduino

我正在构建一个程序，它对模拟电压进行 10 次测量`pin0`并将其打印到日志文件中。当我尝试确保文件为空白时，我遇到了问题。我正在使用`SD.remove()`以删除以前的日志文件。当我这样做时，新的日志文件永远不会被真正写入。当我删除对 的调用时`SD.remove()`，程序正常工作。这是 SD 库中的一些已知错误，还是有一些鬼鬼祟祟的方法？

代码如下。

```
#include <SD.h>
#define OUTPUT_PIN 9 //Using SparkFun MP3 shield
#define DEFAULT_OUTPUT 10
#define VOLTAGE_REF (5)

//Reads a voltage on pin0\. by default, the reference voltage is set to 5 V, but
//it can be changed by changing VOLTAGE_REF.

void setup() {
    Serial.begin(9600);
    Serial.println("Program Initialized");

    pinMode(DEFAULT_OUTPUT ,OUTPUT); //Needs to be on to use the library
    pinMode(0, INPUT);

    if (!SD.begin(OUTPUT_PIN)) {
        //init error
        Serial.println("Error initializing SD card. Reset the Arduino and try again");
        return;
    }

    Serial.println("Card sucessfully initialized");

    if (SD.exists("LOGFILE.LOG") {
        SD.remove("LOGFILE.LOG"); //We don't want to use the same file <<THIS IS THE BUG?
    }

    delay(10); //Make sure changes are applied

    File logFile = SD.open("ANALOG.LOG", FILE_WRITE); //Create a new one every time
    if (!SD.exists("LOGFILE.LOG")) {
        Serial.println("There was some error making a new instance of the logfile?");
        delay(1000);
        SD.open("ANALOG.LOG", FILE_WRITE);
    }
    int i;

    if (logFile) {
        for(i=0;i<10;i++) {
            int j = 0;
            char str[64];

            Serial.print("Reading analog sensor value");
            for(j=0;j<=i;j++) {
                Serial.print(".");
            }
            Serial.println();

            logFile.print("Read #");
            logFile.print(i+1);
            logFile.print(" : ");
            logFile.print(doVoltageRead(0));
             unsigned char l = logFile.println(" V");
             if (!l)
                 Serial.println("No data written");
             delay(500);
        }
        Serial.println("Done.");
        logFile.close(); //Close the logfile
        Serial.println("Data sucessfully written");
    }
    else {
        //Couldn't create file
        Serial.println("There was an error creating the logfile");
    }
}

void loop() {
    //We don't really need to do anything here
}

float doVoltageRead(int pin) {
    int voltageRead = analogRead(pin);
    double divisor = (voltageRead * 0.00097752);
    float finalVoltage =(VOLTAGE_REF * divisor);
    Serial.println(finalVoltage);
    return finalVoltage;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T08:52:28.850

所以.. 首先你看看 LOGFILE.LOG 是否存在，如果存在则删除 ANALOG.LOG。然后创建 ANALOG.LOG。之后，您检查 LOGFILE.LOG 是否存在。如果没有，则打印错误并打开 ANALOG.LOG。

LOGFILE.LOG 的目的究竟是什么？您不应该将LOGFILE更改为ANALOG吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T20:12:31.017

我找到了错误的根源。当我`if(SD.exists())`打开一个新的日志文件后打电话时，图书馆不喜欢那样。我假设`SD.exists()`只是检查 open 返回的地址或对象是否为 NULL。但是，在文件已经打开时调用它会导致一些奇怪的行为。在打开内部删除该调用后，一切都很好。感谢所有的建议！

# spring - Maven + Spring + Hibernate：hibernate3-maven-plugin hbm2ddl 失败，原因是“Caused by: java.lang.NullPointerException”

> ID：13113115
> 
> 赞同：3
> 
> 时间：2012-10-28T21:17:49.770
> 
> 标签：spring, hibernate, maven, hbm2ddl, hibernate3-maven-plugin

由于当前在 Spring 中缺乏对 Hibernate 4 的支持，我不得不将 Hibernate 从版本 4 降级到版本 3（具体来说是 3.3.2.GA），现在项目在尝试使用 hbm2ddl 生成模式时无法构建。这个错误太模糊了，谷歌搜索它并没有产生太多效果。

这是我的 pom.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="
         http://maven.apache.org/POM/4.0.0
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>example</artifactId>
    <version>1.0-SNAPSHOT</version>
    <name>Spring + Hibernate Example</name>
    <packaging>jar</packaging>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <spring.version>3.1.2.RELEASE</spring.version>
        <hibernate.version>3.3.2.GA</hibernate.version>
        <java.version>1.6</java.version>
    </properties>

    <build>
        <extensions>
            <extension>
                <groupId>org.hsqldb</groupId>
                <artifactId>hsqldb</artifactId>
                <version>2.0.0</version>
            </extension>
            <extension>
                <groupId>log4j</groupId>
                <artifactId>log4j</artifactId>
                <version>1.2.17</version>
            </extension>
        </extensions>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.0.2</version>
                <configuration>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                </configuration>
            </plugin>
            <plugin>
                <!-- Run "mvn hibernate3:hbm2ddl" to generate schema -->
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>hibernate3-maven-plugin</artifactId>
                <version>3.0</version>

                <executions>
                    <execution>
                        <id>generate-ddl</id>
                        <phase>process-classes</phase>
                        <goals>
                            <goal>hbm2ddl</goal>
                        </goals>
                    </execution>
                </executions>

                <configuration>
                    <hibernatetool destdir="${project.build.directory}/generated">
                        <annotationConfiguration configurationfile="hibernate.cfg.xml"/>

                        <hbm2ddl export="false" create="true" update="true"
                                 format="format" outputfilename="schemaDiff.ddl"/>

                    </hibernatetool>
                </configuration>

            </plugin>
        </plugins>
    </build>

    <dependencies>
        <!-- Inversion of Control: Spring Dependencies -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
            <exclusions>
                <!-- Exclude the problematic commons-logging -->
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${spring.version}</version>
        </dependency>
        <dependency>
            <groupId>commons-dbcp</groupId>
            <artifactId>commons-dbcp</artifactId>
            <version>1.4</version>
        </dependency>

        <!-- Object Relational Mapping: Hibernate -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate.javax.persistence</groupId>
            <artifactId>hibernate-jpa-2.0-api</artifactId>
            <version>1.0.1.Final</version>
        </dependency>

        <!-- Hibernate Annotations Dependencies -->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>3.5.6-Final</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-commons-annotations</artifactId>
            <version>3.3.0.ga</version>
        </dependency>

        <!-- Database: HSQLDB -->
        <dependency>
            <groupId>org.hsqldb</groupId>
            <artifactId>hsqldb</artifactId>
            <version>2.0.0</version>
        </dependency>

        <!-- Connection Pool: C3P0 -->
        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>

        <!-- Second-level caching: Ehcache -->
        <dependency>
            <groupId>ehcache</groupId>
            <artifactId>ehcache</artifactId>
            <version>1.2.3</version>
        </dependency>

        <!-- Logging: SLF4j & Log4J -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>1.6.6</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.6.6</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>1.6.6</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.17</version>
            <scope>runtime</scope>
        </dependency>

        <!-- Testing: JUnit -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
        </dependency>

        <!-- Testing: Spring -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${spring.version}</version>
        </dependency>

    </dependencies>

</project> 
```

跑步

```
mvn hibernate3:hbm2ddl 
```

失败了

```
[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl
(default-cli) on project example: There was an error creating the AntRun task.
NullPointerException -> [Help 1] 
```

完整的堆栈跟踪是：

```
[ERROR] Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project example: There was an error creating the AntRun task. NullPointerException -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:3.0:hbm2ddl (default-cli) on project example: There was an error creating the AntRun task.
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.apache.maven.plugin.MojoExecutionException: There was an error creating the AntRun task.
    at org.codehaus.mojo.hibernate3.AbstractHibernateMojo.execute(AbstractHibernateMojo.java:84)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    ... 19 more
Caused by: java.lang.NullPointerException
    at org.codehaus.plexus.configuration.DefaultPlexusConfiguration.add(DefaultPlexusConfiguration.java:174)
    at org.codehaus.plexus.configuration.DefaultPlexusConfiguration.addChild(DefaultPlexusConfiguration.java:150)
    at org.codehaus.mojo.hibernate3.util.PlexusConfigurationUtils.setHibernateConfiguration(PlexusConfigurationUtils.java:289)
    at org.codehaus.mojo.hibernate3.util.PlexusConfigurationUtils.parseHibernateTool(PlexusConfigurationUtils.java:67)
    at org.codehaus.mojo.hibernate3.AbstractHibernateToolMojo.getConfiguration(AbstractHibernateToolMojo.java:60)
    at org.codehaus.mojo.hibernate3.AbstractHibernateMojo.execute(AbstractHibernateMojo.java:76)
    ... 21 more 
```

希望有人可以对此有所了解！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T21:46:19.107

我在尝试使 maven 从休眠模型引导数据库时遇到了同样的问题[（在 maven test 上的 Generate database schema (Hibernate) 中](https://stackoverflow.com/questions/14886025/generate-database-schema-hibernate-on-maven-test/15327856#15327856)描述的问题）。

我让 hbm2ddl 在以下版本组合中运行良好： Hibernate (runtime): 4.1.7.Final hibernate3-maven-plugin: 3.6.10.Final, 指定插件版本 2.2 hibernate3-maven-plugin 的 hibernate-validator 依赖项：4.2 .0.Final

在pom的相关部分下方：

版本：

```
<properties>

    <org.hibernate.version>4.1.7.Final</org.hibernate.version>
    <hibernate.maven.plugin.version>3.6.10.Final</hibernate.maven.plugin.version>

</properties> 
```

hibernate3-maven-plugin 的定义：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>hibernate3-maven-plugin</artifactId>
            <version>2.2</version>
            <configuration>
                <components>
                    <component>
                        <name>hbm2ddl</name>
                        <implementation>jpaconfiguration</implementation>
                    </component>

                </components>

                <componentProperties>
                    <outputfilename>schema.ddl</outputfilename>
                    <create>true</create>
                    <export>false</export>
                    <format>true</format>
                    <drop>false</drop>
                    <jdk5>true</jdk5>
                    <propertyfile>target/test-classes/application.properties</propertyfile>
                    <skip>${skipTests}</skip>
                </componentProperties>
            </configuration>
            <executions>
                <execution>
                    <phase>process-classes</phase>
                    <goals>
                        <goal>hbm2ddl</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>org.hibernate</groupId>
                    <artifactId>hibernate-entitymanager</artifactId>
                    <version>${hibernate.maven.plugin.version}</version>
                    <exclusions>
                        <exclusion>
                            <groupId>cglib</groupId>
                            <artifactId>cglib</artifactId>
                        </exclusion>
                        <exclusion>
                            <groupId>commons-logging</groupId>
                            <artifactId>commons-logging</artifactId>
                        </exclusion>
                    </exclusions>
                </dependency>
                <dependency>
                    <groupId>org.hibernate</groupId>
                    <artifactId>hibernate-core</artifactId>
                    <version>${hibernate.maven.plugin.version}</version>
                    <exclusions>
                        <exclusion>
                            <groupId>cglib</groupId>
                            <artifactId>cglib</artifactId>
                        </exclusion>
                        <exclusion>
                            <groupId>commons-logging</groupId>
                            <artifactId>commons-logging</artifactId>
                        </exclusion>
                    </exclusions>
                </dependency>
                <dependency>
                    <groupId>org.hibernate</groupId>
                    <artifactId>hibernate-validator</artifactId>
                    <version>4.2.0.Final</version>
                </dependency>

            </dependencies>
        </plugin>

    </plugins>
</build> 
```

运行时依赖项：

```
<dependencies>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>${org.hibernate.version}</version>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>${org.hibernate.version}</version>
    </dependency>
</dependencies> 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T09:32:22.403

对于一个大型项目（超过 250 个实体），我使用以下 pom.xml 可以正常工作并在编译阶段生成架构。注意：persistence.xml 指定数据库方言。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>

<groupId>test</groupId>
<artifactId>jpa</artifactId>
<version>1.0-SNAPSHOT</version>

<dependencies>
    <!-- java EE (for annotations) -->
    <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency>
</dependencies>

<build>
    <plugins>

        <!-- hibernate hmb2ddl plugin configuration -->
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>hibernate3-maven-plugin</artifactId>
            <version>3.0</version>
            <executions>
                <execution>
                    <id>generate.database.schema.from.ejb.annotation</id>
                    <phase>compile</phase>
                    <goals>
                        <goal>run</goal>
                    </goals>
                    <configuration>
                        <hibernatetool>
                            <classpath><path location="src/main/java"/></classpath>
                            <hbm2ddl console="false" export="false" update="false"
                                drop="false" create="true" outputfilename="create.sql" format="false"
                                haltonerror="true">
                                <jpaconfiguration persistenceunit="persist" />
                            </hbm2ddl>
                        </hibernatetool>
                    </configuration>
                </execution>
            </executions>
            <dependencies>
                <!-- hibernate tools -->
                <dependency>
                    <groupId>org.hibernate</groupId>
                    <artifactId>hibernate-core</artifactId>
                    <version>3.6.10.Final</version>
                </dependency>
                <dependency>
                    <groupId>org.hibernate</groupId>
                    <artifactId>hibernate-entitymanager</artifactId>
                    <version>3.6.10.Final</version>
                </dependency>
                <dependency>
                    <groupId>org.hibernate</groupId>
                    <artifactId>hibernate-validator</artifactId>
                    <version>4.1.0.Final</version>
                </dependency>
                <dependency>
                    <groupId>javassist</groupId>
                    <artifactId>javassist</artifactId>
                    <version>3.4.GA</version>
                </dependency>
            </dependencies>
        </plugin>

    </plugins>
</build> 
```

# cakephp-2.0 - 深度关联 findAll() 与 CakePHP 2 模型

> ID：13113120
> 
> 赞同：0
> 
> 时间：2012-10-28T21:18:10.493
> 
> 标签：cakephp-2.0, one-to-many, cakephp-model

我有模型`Trip`、`Investment`和`Person`。一次旅行有很多投资，每一项投资都属于一个人。当我说`$this->Trip->find('all');`我得到：

```
Array (
    [0] => Array (
            [Trip] => Array (                  
                    [id] => 1
                    [date] => 2012-10-25 13:00:00
                )
            [Investments] => Array (
                    [0] => Array (
                            [id] => 1
                            [person_id] => 1
                            [investment_type_id] => 2
                            [trip_id] => 1
                            [investment] => 55
                        )
                    [1] => Array (
                            [id] => 2
                            [person_id] => 2
                            [investment_type_id] => 1
                            [trip_id] => 1
                            [investment] => 40
                        )
                )            
        )
) 
```

我希望每项投资都包含有关由`person_id`(So their `id`, their`name`等) 代表的人的信息。我已经在`find('all')`查找中尝试了所有级别的递归，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T09:31:12.743

您是否在所有模型中定义了两种关联方式？

例如。旅行有很多投资和投资属于旅行

Investment belongsTo Person AND Person hasMany Investments 也查询应该是

```
$this->Trip->find->("all", array("recursive" => 2)); 
```

另一件事可能是问题是如果所有必要的模型都加载到您的控制器中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-12T13:33:25.717

有关替代解决方案，请参见[cakePHP 模型关联（更深入地检索数据） ：使用](https://stackoverflow.com/questions/12515706/cakephp-model-associations-retrieving-data-deeper)

```
$this->YourModelname->recursive = 3; 
```

在查询之前。

# android-maps - Android双击幻灯片缩放

> ID：13113122
> 
> 赞同：0
> 
> 时间：2012-10-28T21:18:12.443
> 
> 标签：android-maps, zooming

谷歌地图通过双击具有单指缩放功能，无需抬起手指滑动即可放大，向下滑动可缩小。

这对其他地图类型的应用程序是否可行？有没有这方面的代码示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T15:17:28.217

我在 iOS 上创建了一些东西来做到这一点，并在[GitHub 上](https://github.com/bddckr/BDDROneFingerZoomGestureRecognizer)发布了它。

实际的点击识别很容易，计算“正确”（感觉“正确”）`zoomScale`是问题......看看[这个](https://github.com/bddckr/BDDRScrollViewAdditions/blob/master/BDDRScrollViewAdditions/UIScrollView+BDDRScrollViewAdditions.m)看看它是如何使用的。

您可能可以在 Android 上使用相同的逻辑（我没有使用 Android 的经验）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-11T18:47:41.563

`Tap, hold + up/down`zoom 是在[Google Maps Android API v2](https://developers.google.com/maps/documentation/android/index)中实现的，因此它适用于任何使用它的应用程序。

需要零行代码。

# jquery - 我在做什么错，严重吗？jQuery砌体

> ID：13113124
> 
> 赞同：0
> 
> 时间：2012-10-28T21:18:24.900
> 
> 标签：jquery

您可以查看代码[http://jsfiddle.net/2eyzm/](http://jsfiddle.net/2eyzm/)。我不知道我做错了什么，但它不起作用。盒子应该向上滑动以填补空白。这是正确的吗？

```
$(function(){
$('#container').masonry({
itemSelector : '.item',
});
});​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T21:21:59.033

这是由不正确的脚本加载顺序引起的。你应该在加载它的插件之前加载 jQuery：

```
<script type="text/javascript" src="http://www.mattjamesrogers.com/scripts/javascript/jquery.imagesloaded.min.js"></script>
<script type="text/javascript" src="http://www.mattjamesrogers.com/scripts/javascript/jquery.masonry.min.js"></script>
<script type="text/javascript" src="http://raw.github.com/desandro/masonry/master/jquery.masonry.js"></script>
<script type="text/javascript" src="http://raw.github.com/desandro/imagesloaded/master/jquery.imagesloaded.js"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script> 
```

尝试这个：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="http://www.mattjamesrogers.com/scripts/javascript/jquery.masonry.min.js"></script>    
<script type="text/javascript" src="http://raw.github.com/desandro/imagesloaded/master/jquery.imagesloaded.js"></script> 
```

[http://jsfiddle.net/9wGUj/](http://jsfiddle.net/9wGUj/)

# python - 在python循环中计算数字

> ID：13113128
> 
> 赞同：2
> 
> 时间：2012-10-28T21:19:00.100
> 
> 标签：python, loops, for-loop, while-loop

我试图得到一个循环，它将告诉我从 0 到 2（不包括 2）的 50 个随机整数数组中 0 的数量。然后它将再次为获得的零数计算随机整数。

我尝试过这样做，但我在初级阶段陷入困境并且变得令人沮丧，所以任何帮助将不胜感激。

```
from numpy.random import randint

n = 50

R = randint(0,2,n)

for i in R:
    True = 0
    print array(True) 
```

但它不返回一个数组，我不知道如何计算 0 的数量，因为我不能像往常一样使用 len 函数。

我也尝试使用 while 循环，但遇到了类似的问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T21:29:42.427

由于您的数组仅包含一和零，因此零的计数显然是

```
num_zeroes = len(R) - sum(R) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T21:23:58.703

要计算`0`s`R`你可以这样做

```
sum(not n for n in R) 
```

这样做的好处是，即使数组中只有`1`s 和`0`s 以外的数字，它也可以工作。

* * *

感谢 eryksun 指出这一点：你也可以这样做

```
numpy.sum(R == 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:04:54.847

也许这是您正在寻找的东西：

```
from numpy.random import randint

n = 50

R = randint(0,2,n)

def get_number_of_zeros(x):
    return sum(0 == ele for ele in x)

while(len(R) > 0):
    number_of_zeros = get_number_of_zeros(R)
    print 'number of zeros is {}'.format(number_of_zeros)
    R = randint(0, 2, number_of_zeros) 
```

结果：

```
number of zeros is 25
number of zeros is 11
number of zeros is 7
number of zeros is 4
number of zeros is 1
number of zeros is 1
number of zeros is 1
number of zeros is 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T21:43:41.457

生成数组：

```
random_list = [random.randint(0,2) for x in xrange(50)] 
```

0 的个数：

```
num_zeros = sum( 1 for x in random_list if x==0 ) 
```

再次生成数组：

```
random_list = [random.randint(0,2) for x in xrange(num_zeros)] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-09T20:54:45.960

嗯，不需要循环和求和。如果您有一个整数数组，则可以像这样计算零（或任何其他单个数字）的数量：

```
>>> R = [ 0, 1, 5, 0, 0]
>>> print("There are", R.count(0), "zeros")
There are 3 zeros 
```

# c# - 使用 assemblyresolve 处理 C# 中缺少的程序集

> ID：13113131
> 
> 赞同：0
> 
> 时间：2012-10-28T21:19:48.463
> 
> 标签：c#, interop, assemblyresolve

我正在按照[http://support.microsoft.com/kb/837908](http://support.microsoft.com/kb/837908)中的方法 3 在 C# 中动态加载程序集。但是，代码对我不起作用。在以下代码部分中，作者仅在缺失程序集的名称是应用程序引用的程序集之一时才加载缺失的程序集。

当我在调试下运行它时，该函数被调用，但缺少的程序集不在任何这些引用的程序集中，因此在我的情况下没有设置它。任何想法为什么会发生这种情况？我不确定该 DLL 是 C# 还是本机 C++。这可能是因为 C++ dll 无法以这种方式加载吗？那么，为什么会为缺少的 C++ 程序集调用此函数？任何解释表示赞赏。如果这不适用于从 C# 引用的 C++ 程序集，还有哪些替代方法？

```
private Assembly MyResolveEventHandler(object sender,ResolveEventArgs args)
{
    //This handler is called only when the common language runtime tries to bind to the assembly and fails.

    //Retrieve the list of referenced assemblies in an array of AssemblyName.
    Assembly MyAssembly,objExecutingAssemblies;
    string strTempAssmbPath="";

    objExecutingAssemblies=Assembly.GetExecutingAssembly();
    AssemblyName [] arrReferencedAssmbNames=objExecutingAssemblies.GetReferencedAssemblies();

    //Loop through the array of referenced assembly names.
    foreach(AssemblyName strAssmbName in arrReferencedAssmbNames)
    {
        //Check for the assembly names that have raised the "AssemblyResolve" event.
        if(strAssmbName.FullName.Substring(0, strAssmbName.FullName.IndexOf(","))==args.Name.Substring(0, args.Name.IndexOf(",")))
        {
            //Build the path of the assembly from where it has to be loaded.                
            strTempAssmbPath="C:\\Myassemblies\\"+args.Name.Substring(0,args.Name.IndexOf(","))+".dll";
            break;
        }

    }
    //Load the assembly from the specified path.                    
    MyAssembly = Assembly.LoadFrom(strTempAssmbPath);                   

    //Return the loaded assembly.
    return MyAssembly;          
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:46:56.927

术语“程序集”不仅仅指任何 DLL；这意味着使用 .NET 和为 .NET 创建的 DLL。它通常也被称为“托管代码”，这大致意味着您使用 .NET 垃圾收集器而不是传统的 C++ 堆来管理内存。（我正在简化。还有一些“混合模式程序集”确实可以通过这种方式解决，尽管它们混合使用托管和非托管代码。而且“托管”不仅仅意味着内存管理。）

引用的程序集是用 C++/CLI 还是用 C# 编写的并不重要。C++/CLI 经常与 C++ 混淆，但它实际上是另一种语言，具有利用托管环境的额外设施。如果您使用`/clr`开关编译 C++'ish，它是 C++/CLI 而不是 C++。

您需要了解所引用的知识库文章的三个问题。

1.  文章中的“方法 3”没有考虑*间接引用的程序集*。也就是说，从主程序集引用的程序集引用的程序集。这可能正在咬你。

2.  这篇文章没有提到*在注册处理程序的方法主体中尽可能少做*是至关重要的，否则抖动将在注册处理程序之前解析一些程序集——即使负责该处理的代码行如下。用同样的方法注册。这是因为 JIT 编译先于执行。

3.  如果您处理 C++/CLI 代码，很可能您还需要加载一些之前链接的非托管 C++ DLL。它是使用传统的 Windows DLL 搜索顺序并在您的解析器之外完成的。但这不是您的问题，只要您看到为特定 DLL 输入的处理程序。在处理程序中根本看不到与 .NET 无关的普通类型的 C 或 C++ DLL。

# android - Android RemoteControlClient 位图缩放

> ID：13113139
> 
> 赞同：4
> 
> 时间：2012-10-28T21:21:38.337
> 
> 标签：android, bitmap, scale

我已成功包含`RemoteControlClient`在我的应用程序中。但是，我想知道是否有任何方法可以防止抛出的位图在各个方面进行缩放。我可以在我的活动中执行此操作，缩放垂直并保留方面，但是将缩放的位图扔给客户端没有任何效果。它总是缩放为正方形，填充视图。
有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-17T18:35:40.077

我想，创建一个黑色（或透明？）方形位图背景并将您的专辑插图或任何它放在中心...然后将方形图像发送到 RemoteControlClient。

# java - GMaven 构建失败并显示“遇到 API 不兼容”

> ID：13113142
> 
> 赞同：9
> 
> 时间：2012-10-28T21:21:56.100
> 
> 标签：java, maven, groovy, gmaven

尝试使用 Maven`Gmaven`插件编译我的项目时，出现以下错误：

> `[ERROR] Failed to execute goal org.codehaus.gmaven:gmaven-plugin:1.4:compile (default) on project concorde-web: Execution default of goal org.codehaus.gmaven:gmaven-plugin:1.4:compile failed: An API incompatibility was encountered while executing org.codehaus.gmaven:gmaven-plugin:1.4:compile: java.lang.NoSuchMethodError: org.codehaus.groovy.ast.ModuleNode.getStarImports()Ljava/util/List;`

谷歌搜索表明这是因为多个 groovy 版本最终出现在我的依赖链中。但是，在检查了完整的依赖树之后，我发现完整的树中只有一个依赖。

这是我的 pom.xml 的摘录：

```
 <!-- Groovy dependencies -->
    <dependency>
        <groupId>org.codehaus.groovy</groupId>
        <artifactId>groovy-all</artifactId>
        <version>1.8.5</version>
    </dependency>
    <!-- ... snip ... -->

        <plugin>
            <groupId>org.codehaus.gmaven</groupId>
            <artifactId>gmaven-plugin</artifactId>
            <version>1.4</version>
            <executions>
                <execution>
                    <goals>
                        <goal>generateStubs</goal>
                        <goal>compile</goal>
                        <goal>generateTestStubs</goal>
                        <goal>testCompile</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-28T21:21:56.100

这是由`providerSelection`GMaven 插件定义中缺少的元素引起的。

正确的 GMaven 定义如下所示：

```
 <plugin>
            <groupId>org.codehaus.gmaven</groupId>
            <artifactId>gmaven-plugin</artifactId>
            <version>1.4</version>
            <configuration>
                <providerSelection>1.8</providerSelection>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>generateStubs</goal>
                        <goal>compile</goal>
                        <goal>generateTestStubs</goal>
                        <goal>testCompile</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T22:37:50.347

通过对 Marty 的解决方案进行小的修改，我能够让它工作：

```
<plugin>
        <groupId>org.codehaus.gmaven</groupId>
        <artifactId>gmaven-plugin</artifactId>
        <version>1.5</version>

        <executions>
            <execution>
                <configuration>
                    <providerSelection>2.0</providerSelection>
                </configuration>
                <goals>
                    <goal>generateStubs</goal>
                    <goal>compile</goal>
                    <goal>generateTestStubs</goal>
                    <goal>testCompile</goal>
                </goals>
            </execution>
        </executions>
</plugin> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-09T13:09:02.567

我在我的项目中遇到了同样的错误，但经过长时间的诊断后发现与以下依赖项关联的 jar 已损坏。

```
<dependency>
    <groupId>org.codehaus.groovy</groupId>
    <artifactId>groovy-all</artifactId>
    <version>1.8.5</version>
</dependency> 
```

# asp.net-mvc-4 - 如何在 ASP.NET MVC4 中扩展 SimpleMembership 身份验证

> ID：13113145
> 
> 赞同：1
> 
> 时间：2012-10-28T21:22:01.870
> 
> 标签：asp.net-mvc-4, simplemembership

我已经完成了几个 ASP.NET MVC 1 和 2 站点。不知何故，我设法跳过了 v3。我现在正在创建一个新的 ASP.NET MVC 4 站点，并且我看到所有的 Membership 内容已经完全改变了。

一开始我很高兴。它看起来很容易设置和使用，并且 Internet 项目模板附带了我开始所需的所有类和视图。

不幸的是，我现在完全卡住了。我需要扩展验证用户的代码。基本上，我需要根据 Web 服务对一些用户进行身份验证，并根据本地数据库对其他用户进行身份验证。两种类型的用户都将在本地数据库中存储配置文件数据。

我的问题是我找不到任何扩展 SimpleMembership 的方法。

在旧的 Membership 提供程序模型下，我会尝试从 SqlMembership 继承并覆盖 ValidateUser() 并调用基类或调用 Web 服务。

我确实尝试做类似的事情，在我的项目中创建一个继承自 SimpleMembership 的类，然后将其配置为 web.config 中的默认成员资格提供程序，但这只是给了我错误

```
Parser Error Message: This method cannot be called during the application's pre-start initialization phase.

Line 32:     <membership defaultProvider="ssund">
Line 33:       <providers>
Line 34:         <add name="ssund" type="Ssund.Web.Providers.SsundSimpleMembershipProvider"/>
Line 35:       </providers>
Line 36:     </membership> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:18:10.613

`SimpleMembership`中没有配置，`web.config`在`InitializeSimpleMembershipAttribute.cs`文件中完成。

不幸的是，所使用的 WebSecurity 类的实现无法扩展，它对 SimpleMembershipProvider 的使用进行了硬编码。

您不必使用 SimpleMembership。您可以回退到使用旧的会员提供者基础设施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-03T22:32:44.817

您可以扩展`SimpleMembershipProvider`，但由于初始化提供程序的方式不寻常且限制性，这不是一个愉快的体验。

尽管提供程序是通过调用初始化的`WebSecurity.InitializeDatabaseConnection`，但通过显式设置提供程序`Web.Config`同样有效。如果它们扩展自`SimpleMembershipProvider`它们将在初始化期间正确配置。

实际上，您可以只实现自己的 API`ExtendedMembershipProvider`以使用`WebSecurity`API，而根本不调用`WebSecurity.InitializeDatabaseConnection`（它仅用于`SimpleMembershipProvider`基于实现）。缺点是从头开始构建它需要做很多工作。

您遇到的错误可能是由于在管道早期与提供程序的交互引起的，可能是因为您在`Initialize`提供程序的例程中执行了某些操作。

See [SimpleMembershipProvider vs MembershipProvider](http://www.thecodeking.co.uk/2013/08/simplemembershipprovider-vs.html) for more information of the differences between `SimpleMembershipProvider` and `MembershipProvider`. And take a look at [BetterMembership.Net](https://github.com/TheCodeKing/BetterMembership.Net) for an example of extending the `SimpleMembershipProvider`.

# javascript - 如何在字符串中搜索一个字符并输出该字符出现的每个位置的索引？(Javascript)

> ID：13113147
> 
> 赞同：1
> 
> 时间：2012-10-28T21:22:06.787
> 
> 标签：javascript, string, character, document, indexof

我想通了，谢谢。我需要将正文移动到 html。更改了正文部分的一些标签。

```
 }

            else
            {
                window.alert ("You entered an invalid character (" + enterLetter + ") please re-enter");
                secondPrompt();
            }

        }

</script>

<body onload = "firstPrompt();">

    <h2>
        Word Checker
    </h2>

    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:46:02.093

每次找到匹配项时，您都可以增加 indexOf -

```
function indexFind(string, charac){
    var i= 0, found= [];
    while((i= string.indexOf(charac, i))!= -1) found.push(i++);
    return found;
} 
```

**indexFind('今天比以前更像','o');**

/* 返回值：（数组）6,22,48 */

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:46:06.023

[`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)递归使用：

```
function findMatches(str, char) {
    var i = 0,
        ret = [];
    while ((i = str.indexOf(char, i)) !== -1) {
        ret.push(i);
        i += char.length; //can use i++ too if char is always 1 character
    };
    return ret;
} 
```

代码中的用法：

```
var matches = findMatches(enterWord, enterLetter);
if (!matches.length) { //no matches
    document.write ("String '" + enterWord + "' does not contain the letter '" + enterLetter + ".<br />");
} else {
    for (var i = 0; i < matches.length; i++) {
        document.write ("String '" + enterWord + "' contains the letter '" + enterLetter + "' at position " + matches[i] + ".<br />");
    }
} 
```

[**现场演示**](http://jsbin.com/udevay/1)

[**完整源代码**](http://jsbin.com/udevay/1/edit)（对您的上一个问题进行了一些调整）

# python - 使用 Networkx 绘制带边的图

> ID：13113155
> 
> 赞同：2
> 
> 时间：2012-10-28T21:23:12.347
> 
> 标签：python, graph, networkx, graph-theory

我一直被一些非常简单的事情困扰。我正在尝试绘制并显示具有 2 个节点和 1 条边的图形。但我得到这个错误：

```
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "/usr/local/lib/python2.7/site-packages/networkx/drawing/nx_pylab.py", line 133, in      draw
draw_networkx(G,pos=pos,ax=ax,**kwds)
File "/usr/local/lib/python2.7/site-packages/networkx/drawing/nx_pylab.py", line 267, in draw_networkx
edge_collection=draw_networkx_edges(G, pos, **kwds)
File "/usr/local/lib/python2.7/site-packages/networkx/drawing/nx_pylab.py", line 546, in draw_networkx_edges
ax.add_collection(edge_collection)
File "/usr/local/lib/python2.7/site-packages/matplotlib/axes.py", line 1445, in add_collection
self.update_datalim(collection.get_datalim(self.transData))
File "/usr/local/lib/python2.7/site-packages/matplotlib/collections.py", line 167, in get_datalim
offsets.shape = (-1, 2)                     # Make it Nx2
AttributeError: incompatible shape for a non-contiguous array 
```

这很简单，我只需添加 2 个节点

```
add_node(1) 
add_node(2)
add_edge(1,2) 
```

然后画出来并展示出来。但我就是不能让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-09T08:57:14.650

这是一个有效的解决方案。

```
import matplotlib.pyplot as plt
import networkx as nx

# Create a basic Graph
g=nx.Graph()
g.add_node(1)
g.add_node(2)
g.add_edge(1,2)

# Output the result
nx.draw(g)
plt.show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T21:56:06.197

```
import networkx as nx
g=nx.Graph()
g.add_node(1)
g.add_node(2)
g.add_edge(1,2)
nx.draw(g) 
```

# php - 选择查询中的多个where条件

> ID：13113157
> 
> 赞同：0
> 
> 时间：2012-10-28T21:23:16.940
> 
> 标签：php, mysql, pdo, conditional, where-clause

我正在编写一个小项目，其中一部分涉及根据用户输入创建 MySQL 查询。用户有很多选项可供选择来构建对数据库的动态查询。我一直在疯狂地寻找我的问题的任何现有答案，但它们似乎都是与我所遇到的不同的问题。

用户可以指定修改查询的选项：

*   IP 地址（他们可以输入整个 IP 或部分 IP，它将搜索整个范围）
*   类型（类型 1 / 类型 2）
*   状态（活动/非活动）
*   载体

选择查询将根据他们是否选择上述任何选项而改变。如果他们选择了两种类型，则不需要指定类型条件，同样如果两种状态都选择，则不需要使用状态作为条件。如果用户输入 IP，则应搜索 IP 地址，如果输入运营商，则应搜索该运营商。

我正在尝试使用 PDO 和 Prepare 语句来执行此操作，但我想知道如何使用 PDO 设置准备和执行语句，同时有这么多潜在选项（如果他们只选择一种类型和一种状态，或者两种类型和一个承运人等）。

是否有任何现有的 PDO 功能/方法可以使这更容易？还是我需要创建一堆 if/else 语句来检查每个选项并附加一个 $sql 语句变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:51:28.827

输入：

```
<form method='post' action='queryresults.php'><br/>
    IP: <input type='string' name='ip_address'/>
    Carrier: <select name='carrier'>
        <option value='-1'>Any</option>
        <option value='1'>1</option>
        <option value='2'>2</option>
    </select><br/>
    Status: <select name='status'>
    <option value='-1'>Any</option>
    <option value='1'>Active</option>
    <option value='2'>Inactive</option>
    </select>
    <input type='text' name='carrier'/>
    (some submit button or more ajax/js stuff)
    </form> 
```

查询结果：（所有输入都已清理，是吗？）

```
$sql="select [some fields] from [some complex join]<br/>
      where <br/>
      (ip_address like '$ip_address' or $ip_address='') and<br/>
      (carrier=$carrier or $carrier=-1) and<br/>
      (status=$status or $status=-1) and<br/>
      (carrier like $carrier or $carrier='')<br>
     ...";
    $stmt=mysql_prepare.... 
```

# python - Postgres 不适用于 django eclipse

> ID：13113168
> 
> 赞同：0
> 
> 时间：2012-10-28T21:25:03.990
> 
> 标签：python, django, eclipse, postgresql

我安装了django并在eclipse下安装了pydev插件。然后我下载了 postgres(1.16.0) sql 工具并安装了它。这是我的设置：

![在此处输入图像描述](../Images/dc4b470876c66fb1ef93863234f70cdd.png)

然后我想在django下配置设置文件：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2' , 
        'NAME': 'django',                   
        'USER': 'postgres',                 
        'PASSWORD': 'admin',                
        'HOST': '',        
        'PORT': '',                     
    }
} 
```

但是当我做syncdb时，我得到：

```
 backend = load_backend(db['ENGINE'])
  File "C:\Python27\lib\site-packages\django\db\utils.py", line 24, in load_backend
    return import_module('.base', backend_name)
  File "C:\Python27\lib\site-packages\django\utils\importlib.py", line 35, in import_module
    __import__(name)
  File "C:\Python27\lib\site-packages\django\db\backends\postgresql_psycopg2\base.py", line 13, in <module>
    from django.db.backends.postgresql_psycopg2.creation import DatabaseCreation
  File "C:\Python27\lib\site-packages\django\db\backends\postgresql_psycopg2\creation.py", line 1, in <module>
    import psycopg2.extensions
ImportError: No module named psycopg2.extensions 
```

我做错了什么？

PS.：我在win7和eclipse juno下开发

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:26:35.940

安装[psycopg2](http://www.initd.org/psycopg/)

```
pip install psycopg2 
```

> Psycopg 是 Python 编程语言最流行的 PostgreSQL 适配器。它的核心完全实现了 Python DB API 2.0 规范。

# java - Java：在 Trie 中存储子字符串

> ID：13113170
> 
> 赞同：0
> 
> 时间：2012-10-28T21:25:33.407
> 
> 标签：java, string, recursion, trie

我正在实现一个trie，它将子字符串及其出现次数存储在一个字符串中。我的 trie 中的每个节点都有一个名为 children 的 Map，它将存储主节点的任何子节点。

我的问题是，最终，这些子节点将拥有自己的子节点，我不知道如何能够从“地图中的地图中的地图......”可以这么说。

这是我到目前为止所拥有的：

```
private class TrieNode
{
    private T data; //will hold the substring
    int count; //how many occurrences of it were in the string
    private Map<TrieNode, Integer> children; //will hold subnodes
    private boolean isWord; //marks the end of a word if a substring is the last substring of a String

    private TrieNode(T data)
    {
        this.data = data;
        count = 1;
        children = new HashMap<TrieNode, Integer>();
        isWord = false;
    }
} 
```

我如何从子节点中检索数据，这些子节点下可能有其他子节点？

PS如果我不能清楚地解释它，我很抱歉 - 我遇到了递归问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:40:30.077

我不明白为什么要将字符串存储在名为 T 的类型中。这听起来像是泛型类型，但您还没有在类中声明它。

无论如何，我认为您需要一个`Map<T, TrieNode>`将每个子字符串保存为键的子字符串。这样，您会再次出现另一个`TrieNode`，它又具有另一张相同类型的地图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:23:24.790

你需要一些东西。首先，您想要`Map<T, TrieNode>`因为您正在将一条数据映射到一个子 Trie。

其次，您需要知道如何将数据拆分为头尾，以及稍后如何重新组合它们。在字符串的标准情况下，您使用子字符串和连接。例如：

```
private TrieNode(String currChar, String rest) {
   this.data = currChar;
   this.children = new HashMap<String, TrieNode>();
   if(rest.isEmpty()) {
      this.isWord = true;
   } else {
      String head = rest.substring(0, 1);
      String tail = rest.substring(1, rest.length());
      this.children.add(head, new TrieNode(head, tail);
   }
} 
```

您`T`需要能够做类似的事情，或者首先使用 Trie 是没有意义的。

此外，您很少需要从 Trie 重新编译字符串。通常，您只是检查 Trie 中是否存在字符串，或者某个字符串是多少个字符串的子字符串。

# c - C中的结构，编译器错误

> ID：13113171
> 
> 赞同：0
> 
> 时间：2012-10-28T21:25:37.123
> 
> 标签：c, struct

我收到此错误：

```
str.c:5:19: error: expected identifier or '(' before 'struct' 
```

编译以下代码时。它有什么问题？

```
#include <stdio.h>

struct addpoints (struct point p1, struct point p2){
    p1.x += p2.x;
    p1.y += p2.y;
    return p1;
}

int main(){
    struct point{
        int x;
        int y;
    };

    struct point p1 = { 13, 22 };
    struct point p2 = { 10, 10 };

    addpoints (p1,p2);

    printf("%d\n", p1.x);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:29:01.867

看起来您想`addpoints`返回 a `struct point`，但忘记在`point`after中输入`struct`：

```
struct point addpoints (struct point p1, // ... 
```

`struct point`但是，除非您将定义从以下内容中提取出来，否则这仍然不起作用`main`：

```
#include <stdio.h>

struct point{
    int x;
    int y;
};

struct point addpoints (struct point p1, struct point p2){
    p1.x += p2.x;
    // ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:26:22.880

```
struct addpoints (struct point p1, struct point p2){ 
```

`struct`不是类型。`struct point`是一种类型。

`struct point`在使用它之前还要声明你的类型，在这里你是`struct point`在 `main`函数中声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T21:41:20.363

很多问题：

```
struct addpoints (struct point p1, struct point p2){
    p1.x += p2.x;
    p1.y += p2.y;
    return p1;
} 
```

乍一看，我很惊讶，我不记得 C 有这种语法吗？我一定又傻了。然后我看，它是一个函数，返回类型是struct，这显然是错误的。

struct 是声明结构的关键字，而不是类型。如果要返回结构类型，则需要结构名称。在您的情况下，您应该使用：

```
struct point addpoints(struct point p1, struct point p2){//...} 
```

你也在你`struct point`的主要功能中，而不是全局的。所以像这样的全局函数`addpoints`无法访问它。你必须把它带到外面，并且必须在函数添加点之前。因为 C 解析器使用 up-to-down 来解析代码。如果你有一些在使用前从未出现过的东西，它会告诉你，`first declaration of something`

# vb.net - 使字体粗体/斜体/下划线 Visual Basic

> ID：13113173
> 
> 赞同：2
> 
> 时间：2012-10-28T21:25:42.027
> 
> 标签：vb.net

好的，我已经有一个字体对话框，可以更改richtextbox 的字体并且它可以工作（虽然我不知道如何使对话框的应用按钮工作）

我还为粗体、下划线、删除线和斜体制作了 4 个按钮。

我发现大多数人使用的方法是

```
Dim boldf as NewFont(....) 
```

然后将其应用于选定的文本。

问题在于它将字体更改为仅粗体，它不会将其添加到现有样式中。

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:15:52.490

```
Private Sub andlowitwasbold_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles andlowitwasbold.Click
    If RichTextBox1.SelectionFont.Bold Then 'its already bold, so set it to regular
        RichTextBox1.SelectionFont = New Font(RichTextBox1.Font.FontFamily, RichTextBox1.Font.Size, FontStyle.Regular)
    Else 'make it bold
        RichTextBox1.SelectionFont = New Font(RichTextBox1.Font.FontFamily, RichTextBox1.Font.Size, FontStyle.Bold)
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-14T12:41:00.810

另一种方法是：

```
RichTextBox1.SelectionFont.Bold = Not(RichTextBox1.SelectionFont.Bold) 
```

# facebook - facebook分享对话框被裁剪

> ID：13113175
> 
> 赞同：1
> 
> 时间：2012-10-28T21:26:16.730
> 
> 标签：facebook, facebook-like, facebook-javascript-sdk

问题是我的like按钮在页面底部，

当有人点击喜欢按钮时，对话框就会被裁剪，

而我对此无能为力。

有没有人有类似的问题？

![在此处输入图像描述](../Images/ce4393626b9319a47ae04e2f55b6da23.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:34:24.103

解决此问题的唯一方法是在页面中使用一些 CSS 来移动对话框。这是一种 hack，但它是真正做你想做的事的唯一方法。唯一的缺点是对话框左上角的小三角形看起来不合适。

另一个不涉及移动对话框的选项是使您的页面稍长一些。

# c++ - 在类的成员函数定义中使用 (::)

> ID：13113179
> 
> 赞同：1
> 
> 时间：2012-10-28T21:26:29.060
> 
> 标签：c++, oop, class, function

我正在测试课程，我做了这个课程

```
class Point
{
private:
    int x,y;
public:
    void setit(int new_x,int new_y);
    void set_x(int new_x);
    void set_y(int new_y);
    int get_x();
    int get_y();
}; 
```

现在我继续为所有公共函数编写函数定义，但是，

在我写`void set(int new_x,int new_y);` 函数定义的时候，有些事情让我很困惑

```
void Point::setit(int new_x, int new_y){
    Point::set_x(new_x);
    Point::set_y(new_y);
}

void Point::setit(int new_x, int new_y){
    set_x(new_x);
    set_y(new_y);
} 
```

我注意到前面的两个函数定义具有完全相同的效果。

我认为没有 :: 运算符它不会工作，因为它会搜索类外的函数，因为我不再表示它们在 Point 类中

谁能解释为什么它们都有相同的效果？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T21:30:21.100

`::`是范围解析运算符；它可以准确地告诉编译器在哪里查找名称。

这`Point::set_x`只是调用成员函数的扩展语法。

```
set_x(new_x); 
```

简称

```
this->set_x(new_x); 
```

和

```
Point::set_x(new_x); 
```

相当于

```
this->Point::set_x(new_x); 
```

它允许您选择在类隐藏父类中的函数时调用哪个函数。例如：

```
struct A {
    void f();
};

struct B : public A {
    void f(); // Hides A::f
};

B binst;

binst.f(); // Calls B::f

binst.A::f(); // Calls A::f 
```

您可以使用此语法做的一件事是从基类的重写虚函数调用父类的成员函数，从而允许您使用基类提供的“默认实现”。你也可以在类外进行，类似于隐藏函数：

```
struct A {
    virtual void f() {
        cout << "A::f" << endl;
    }
};

struct B : public A {
    virtual void f() override {
        cout << "B::f" << endl;

        A::f(); // if we just did f(), it would call B::f, and we
                // would get infinite recursion
    }
};

B b;

b.f();    // prints B::f A::f
b.A::f(); // prints B::f 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T21:36:17.720

在类成员函数内部，所有的类成员名称都在范围内，因此`set_x`可以找到。

此外，类名本身在类成员函数中是可见的（据说是被*注入*的），因此`Point::set_x`也可以找到。但出于同样的原因，`Point::Point::set_x`也`Point::Point::Point::Point::set_x`有给函数命名的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T21:33:40.117

`::`是范围解析运算符。要在类的命名空间范围内访问函数，`Point`您可以使用`::`运算符，但由于该函数`setit(int new_x, int new_y)`已经与 and 在同一范围内`set_x`，`set_y`因此不需要定义这些函数的整体范围。该程序将在最本地范围内调用具有匹配符号`set_x`的函数。`set_y`

# c# - 通过 FTP 传输加密文件，解密时损坏

> ID：13113180
> 
> 赞同：0
> 
> 时间：2012-10-28T21:26:31.327
> 
> 标签：c#, ftp

使用下面的代码，我正在尝试将加密文件上传到 FTP 服务器。从 ftp 服务器下载文件时，它们都已损坏。

```
FtpWebRequest request = (FtpWebRequest)WebRequest.Create(url);
request.Method = WebRequestMethods.Ftp.UploadFile;
request.Credentials = new NetworkCredential(
    user, 
    pass);

StreamReader sourceStream = new StreamReader(tempfilepath);
byte[] fileContents = ASCIIEncoding.ASCII.GetBytes(sourceStream.ReadToEnd()); // uploads corrupted files
//byte[] fileContents = File.ReadAllBytes(tempfilepath);
sourceStream.Close();
request.ContentLength = fileContents.Length;

Stream requestStream = request.GetRequestStream();
requestStream.Write(fileContents, 0, fileContents.Length);
requestStream.Close();

// Shows confirm message
FtpWebResponse response = (FtpWebResponse)request.GetResponse();
response.Close(); 
```

任何线索可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:32:06.387

看起来您正在将任意二进制数据读入`StreamReader`.
不要那样做。

`StreamReader`阅读文本；将原始二进制数据传递到 StreamReader 将删除所有无效的代码点。

相反，您应该纯粹使用`Stream`or `byte[]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T17:52:18.827

问题解决了......不幸的是，这是一个非常愚蠢的问题，所以它不会真正帮助任何人。我实际上是在上传未加密的文件，所以当我解密它时，显然它是行不通的。

# linux - Linux 上的端口镜像

> ID：13113181
> 
> 赞同：1
> 
> 时间：2012-10-28T21:26:34.410
> 
> 标签：linux, iptables, honeypot

我在我的 VPS 上运行了 Kippo，但由于 Linux 中的限制不允许普通帐户使用 1024 下的端口，我无法让它在端口 1024 下运行。如果我尝试，它会给出一些关于不被使用的 Python 胡言乱语的错误能够监听1024以下的端口。

我宁愿不以 root 身份运行 Kippo，以防万一他们如何摆脱 Kippo 环境。

所以我正在做的是使用 IPTables 来“镜像”所有到 22 端口 2222 的流量，以便“机器人”可以看到 SSH 在端口 22 上运行并执行它的操作。

这可行吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:39:25.050

使用 DNAT 规则：

```
iptables -t nat -A PREROUTING -m tcp -p tcp --dport 22 -j REDIRECT --to-port 2222 
```

您可能希望使用特定的 IP 地址过滤器进一步锁定

# jquery - jquery加载错误的版本

> ID：13113183
> 
> 赞同：0
> 
> 时间：2012-10-28T21:27:01.197
> 
> 标签：jquery, asp.net

问题 #1 以下代码在我的母版页中

```
<html lang="en">
<head id="Head1" runat="server">
    <meta charset="utf-8" />

    <title>Enerteck, industry leading performance catalysts for diesel fuels</title>
    <link href="Styles/Site.css" rel="stylesheet" type="text/css" />
    <link href="Styles/nav.css" rel="stylesheet" type="text/css" />
    <script src="Scripts/jquery-1.8.2.min.js"></script>
    <script src="Scripts/modernizr-2.6.2.js"></script>
    <link href="Content/jquery.lightbox.css" rel="stylesheet" type="text/css" />
    <script src="Scripts/jquery.lightbox.min.js" ></script>
    <asp:ContentPlaceHolder id="HeaderContent" runat="server">
    </asp:ContentPlaceHolder>
</head>

<body>
<form id="form1" runat="server">
     <asp:ScriptManager ID="ScriptManager1" runat="server">
    <Scripts>
        <asp:ScriptReference Name="MsAjaxBundle" />
        <asp:ScriptReference Name="jquery" />
        <asp:ScriptReference Name="jquery.ui.combined" />
        <asp:ScriptReference Name="WebForms.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebForms.js" />
        <asp:ScriptReference Name="WebUIValidation.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebUIValidation.js" />
        <asp:ScriptReference Name="MenuStandards.js" Assembly="System.Web" Path="~/Scripts/WebForms/MenuStandards.js" />
        <asp:ScriptReference Name="GridView.js" Assembly="System.Web" Path="~/Scripts/WebForms/GridView.js" />
        <asp:ScriptReference Name="DetailsView.js" Assembly="System.Web" Path="~/Scripts/WebForms/DetailsView.js" />
        <asp:ScriptReference Name="TreeView.js" Assembly="System.Web" Path="~/Scripts/WebForms/TreeView.js" />
        <asp:ScriptReference Name="WebParts.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebParts.js" />
        <asp:ScriptReference Name="Focus.js" Assembly="System.Web" Path="~/Scripts/WebForms/Focus.js" />
        <asp:ScriptReference Name="WebFormsBundle" />

    </Scripts>
</asp:ScriptManager> 
```

控制台中的错误是“加载资源失败：服务器响应状态为 404（未找到）blahblahblah/Scripts/jquery-1.8.1.js”

我没有引用 jquery 1.8.1 版本，我显然正在加载 1.8.2，这就是 VS2012 项目中的内容，通过 nuget 包安装。该文件最终位于脚本文件夹中

我的脚本没有运行，我假设这就是原因，因为它们在 jsfiddle 中工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-15T06:00:46.570

我试图在这里回答一个类似的问题 - [https://stackoverflow.com/a/35402418/1945517](https://stackoverflow.com/a/35402418/1945517)

这是它的要点，一次采取一步。

```
1\. Print the version that the system is loading like so:
    console.log( "You are running jQuery version: " + $.fn.jquery);
2\. View the source of the html page rendered.
3\. Look for all the jquery source added, checking at <script> imports.
4\. Then look for your source code where this is getting added.
5\. Fix that, build, and repeat step 2 until you get the right version. 
```

祝你好运。

# python - 如何使用字符串执行布尔 if 语句？

> ID：13113186
> 
> 赞同：-1
> 
> 时间：2012-10-28T21:27:38.717
> 
> 标签：python, if-statement, boolean, nameerror

我有一大段代码如下：

```
maybeYes = input("Please enter Yes to start.")
if maybeYes == "Yes":
    pass
else:
    print "Wrong answer." 
```

它给出了以下错误：

```
NameError: name 'Yes' is not defined 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:31:51.823

假设这是 python，请使用 raw_input 而不是 input。输入被认为是危险的，因为它会评估您输入的任何内容，所以如果您这样做：

```
 x = input() 
```

并输入 2+4，x 将等于 6。 raw_input 只是给你输入的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:33:02.150

使用`raw_input()`代替`input()`：

```
>>> maybeYes = raw_input("Please enter Yes to start ")
Please enter Yes to start yes
>>> maybeYes
'yes' 
```

想象一下，`input()`如果您要直接在解释器中输入，那么python`yes`需要`'yes'`知道您的意思是 string `yes`。

**编辑：**

您需要使用`while`循环。

```
while raw_input("Please enter Yes to start: ") != 'Yes':
       print 'Wrong'

print 'Correct'

print 'Doing something else...'

#Carry on here 
```

输出：

```
Please enter Yes to start: nowg
Wrong
Please enter Yes to start: wggwe
Wrong
Please enter Yes to start: Yes
Correct
Doing something else... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:20:41.250

此版本将接受“是”的任何变体，例如“是”、“是”、“是”、“是”等。

```
answer = raw_input('Please enter Yes to start: ')
while answer.upper() != 'YES':
   print 'Sorry, your entered something else'
   answer = raw_input('Please enter Yes to start: ')
print "Thank you, you entered ", answer 
```

# c++ - 为什么我得到错误 no match for operator= in 'a = x'？

> ID：13113189
> 
> 赞同：0
> 
> 时间：2012-10-28T21:28:25.553
> 
> 标签：c++, c++11

我正在尝试了解新的 C++ 11 功能；更具体地说，引用限定符（其中之一）将赋值限制为右值。但由于某种原因，我无法让这段代码工作。当我将`A`对象分配`a`给左值`x`（`a = x`）时，会出现错误。

> prog.cpp:5:47：错误：`'&'`令牌
> prog.cpp 之前的预期初始化程序：在函数中`'int main()'`： prog.cpp:15:9：错误：在prog.cpp:3:10 中
> 不匹配 ：注意：候选人是：`'operator='``'a = x'`
> `A& A::operator=(const A&)`

```
struct A {

   template <typename T> auto operator = (T) & -> A & {
       return *this;
   }

};

int main() {

   A a;

   int x = 4;

   a = x;

} 
```

当我取出参考限定符时，代码有效。我可能做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T21:37:48.110

看来您正在使用 GCC。目前仅 Clang 3.1+ 支持 Ref-qualifiers。你的代码编译得很好。

# .net - .NET MVC3 更新数据库

> ID：13113192
> 
> 赞同：0
> 
> 时间：2012-10-28T21:29:03.087
> 
> 标签：.net, database, asp.net-mvc-3, http-post

通过调试，我可以看到它用我的新模型条目更新了旧条目。但是它不保存更改，尽管我调用了提交更改方法。

```
 public ActionResult EditGameDetails(artikel model){

        artikel old = myShop.artikels.Single(m => m.artikelnummer == model.artikelnummer);
        old = model;

        myShop.SubmitChanges();
        return RedirectToAction("Games","Game");
    } 
```

我忘记了任何代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:35:10.493

您不能简单地将 old 设置为模型，因为这是对象的两个不同实例。您的 ORM 未跟踪与 actionresult 绑定的那个。以下应该工作。

```
public ActionResult EditGameDetails(artikel model){

    artikel old = myShop.artikels.Single(m => m.artikelnummer == model.artikelnummer);
    old.prop1 = model.prop1;
    old.prop2 = model.prop2;

    myShop.SubmitChanges();
    return RedirectToAction("Games","Game");
} 
```

如果您不想手动键入所有属性分配，也可以使用诸如 automapper 之类的工具。

# jfreechart - 使用 jfreechart 绘制心电图图形

> ID：13113199
> 
> 赞同：3
> 
> 时间：2012-10-28T21:29:51.457
> 
> 标签：jfreechart, graphic

这是交易，我创建了一个从微控制器读取数据的 java 程序，微控制器发送应用程序的心率（所以我有一个包含数据的列表），一切正常，但是现在，我想知道我该怎么做在 jfreechart 图形中绘制数据？

那么你们有什么推荐的呢？

# c++ - C++ 简单程序 - 为什么我的“res”没有进入我的向量？创建一个接受输入 (4+44-67+235) 并输出结果的程序

> ID：13113202
> 
> 赞同：0
> 
> 时间：2012-10-28T21:30:13.097
> 
> 标签：c++

我修复了 -'0' 错误，现在我的输出与我的输入有些相关。我相信它将我的第一个“c”值乘以 10，而不是其他值。如何获得像 143 这样的数字的正确值以计算到我的输出中？

```
#include <vector>
#include <string>
#include <iostream>

using namespace std;
class token { 
    public: char kind;
            char value;
};

int main(){
    vector<token> vt;
    char c;
    token t;
    int res = 0;
    while (cin>>c){
        if(c!= '+' && c!= '-' && c!= '='){

            res = res*10+c-'0';
        }
        else {
            t.kind = c;
            t.value = res;

            vt.push_back(t);
            res = 0;

        }
        if (c=='=')
            break;
    }
    int num = vt[0].value-'0';
    for(int i=0; i<vt.size(); i++){
        if (vt[i].kind=='+')
            num+=vt[i+1].value-'0';
        if (vt[i].kind=='-')
            num-=vt[i+1].value-'0';
    }
    cout<<num;
    system("pause");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:35:56.393

读取输入时减去“0”就足够了，迭代元素时不必再次减去它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:39:43.017

除了其他答案之外，标题中的测试数据不会给您预期的结果，因为对于介于 -128 和 127 之间`235`的有符号来说太大了。您应该选择一个来代替更大的操作数。`char``int`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:03:02.920

在最后一个循环中减法`'0'`是第一个问题，您已经在第一个循环中减去了它。

另一个问题是，正如其他人指出的那样，您应该为`token::value` (`int`或`unsigned char`) 使用其他类型。（如果您将 235 存储在 中`char`，它将最终为 -21...）

最后，您迭代最后一个循环`vt.size()`时间，然后使用 vt[i+1].value - 所以您在向量结束后读取。循环应该只是

```
for (int i=0; i<vt.size()-1;++i) { 
```

另外，不要忘记您的程序需要终止输出`'='`（并且它不在您的问题的标题中）

编辑：我将编辑合并到下面的代码中。对于输入`4+44-67+235=`，它会产生 result `216`。但是您必须使用 last `'='`，否则您不会存储最后一个值，结果将是`-19`.

```
using namespace std;
class token { 
public: 
    char kind;
    int value;
};

int main(){
vector<token> vt;
char c;
token t;
int res = 0;
while (cin>>c){
    if(c!= '+' && c!= '-' && c!= '='){
        res = res*10+c-'0'; 
    }
    else {
        t.kind = c;
        t.value = res;

        vt.push_back(t);
        res = 0;
    }
    if (c=='=')
        break; 
}

int num = vt[0].value;
    for(int i=0; i<vt.size()-1; i++){
        if (vt[i].kind=='+')
                    num+=vt[i+1].value;
        if (vt[i].kind=='-')
            num-=vt[i+1].value;
    }
cout<<num <<endl;
system("pause");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T21:35:55.250

您已经将输入转换为数字，`res = res * 10 - '0'`然后使用 and 再次执行此操作`vt[0].value - '0'`，`vt[i].value - '0'`这会导致无效输出

# ruby-on-rails - form_for 验证它不起作用

> ID：13113205
> 
> 赞同：3
> 
> 时间：2012-10-28T21:30:56.800
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我有以下 form_for 来重置密码。

```
<% provide(:title, "Reiniciar Password") %>

<%= form_for(@user, :url => password_reset_path(params[:id]) ) do |f| %>
    <%= render 'shared/error_messages'%>
    <div class="row">
        <div class="span4">
            &nbsp
        </div>
        <div class="span4" id="login-box">  
            <div id="login-controls">
                <%= link_to(image_tag("logo.png"), root_path) %>
                <br>
                <br>
                    <%= f.password_field :password, :placeholder => "Contrasena", :tabindex => 1, :style => "height:25px;" %>
                    <%= f.password_field :password_confirmation, :placeholder => "Contrasena", :tabindex => 2, :style => "height:25px;" %>
                    <%= f.button "<i class=\"icon-lock icon-white\"></i> Actualizar Password".html_safe, :tabindex => 2,  class: "btn btn-warning", :style => "width:220px;margin-bottom:5px;" %>
<% end %>
          </div>
        </div>
        <div class="span4">
        </div>
    </div> 
```

一切正常，执行验证，如果您按下按钮而没有在密码和密码确认字段中输入任何内容，控制器将使用空白密码重置密码。在我的模型中，我对密码和密码确认进行了验证，并且在您创建新用户时它可以工作，但我不知道为什么在这种形式中重置密码它不起作用。

这是模型

```
class User < ActiveRecord::Base
  attr_accessible :email, :password, :password_confirmation
  has_secure_password

  before_save { |user| user.email = email.downcase }
  before_save :create_remember_token

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX }, uniqueness: { case_sensitive: false }
  validates :password, presence: true, length: { minimum: 6 }, confirmation: true, unless: Proc.new { |a| !a.new_record? && a.password.blank? }

    def send_password_reset
        self.password_reset_token = SecureRandom.urlsafe_base64
        self.password_reset_at = Time.zone.now
        save!
        UserMailer.password_reset(self).deliver
    end

    def reset_password_token
        self.password_reset_token = nil
        self.password_reset_at = nil
        save!
    end

  private

    def create_remember_token
        self.remember_token = SecureRandom.urlsafe_base64
    end

end 
```

感谢您的帮助。

* * *

更新

这是控制器

```
class PasswordResetsController < ApplicationController

    layout "sessions"

  def new
  end

  def create
    user = User.find_by_email!(params[:password_resets][:email] )
    user.send_password_reset if user
    redirect_to root_url, :notice => "Las instrucciones para reestrablecer la contrasena fueron enviadas."
  end

  def edit
    @user = User.find_by_password_reset_token!(params[:id])
  end

  def update
    @user = User.find_by_password_reset_token!(params[:id])
    if @user.password_reset_at < (2.hours.ago).to_date
        redirect_to new_password_reset_path, :alert => "El link para actualizar la contrasena ha expirado."
    elsif @user.update_attributes(params[:user])
        @user.reset_password_token
        redirect_to root_url, :notice => "La contrasena ha sido cambiada."
    else
        render :edit
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:05:01.460

好的，我想我找到了问题的原因：

```
validates :password, presence: true, length: { minimum: 6 }, confirmation: true, unless: Proc.new { |a| !a.new_record? && a.password.blank? } 
```

如果密码为空，此行将跳过验证，因此这就是您的用户在没有任何密码的情况下被保存的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:06:49.983

我认为您的 proc 在更新时会跳过密码验证：

```
validates :password, presence: true, length: { minimum: 6 }, confirmation: true, 
    unless: Proc.new { |a| !a.new_record? && a.password.blank? } 
```

除非记录不是新的（更新）并且密码为空（未在该字段中提交任何内容），否则将进行验证。您可以尝试将 proc 注释掉，看看会发生什么？

例如

```
validates :password, presence: true, length: { minimum: 6 }, confirmation: true 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:11:11.100

它可能是您的 Proc Block 来检查模型是否不是新记录以及密码是否为空。在这种情况下，验证不会发生。

```
unless: Proc.new { |a| !a.new_record? && a.password.blank? } 
```

因此，如果您已经创建了用户：

```
!a.new_record? = true 
```

并且由于密码不是直接保存的，而是作为加密密码（password_digest）也将为零，因此：

```
a.password.blank? = true 
```

因此使用此验证编辑现有用户不会验证密码/密码确认

至少我是这么认为的；）

也许您可以将其更改为：

```
validates :password, presence: true, length: { minimum: 6 }, confirmation: true, :if => :password? 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T00:16:16.737

伙计们，问题出在模型上。这是新的验证。

```
validates :password, presence: true, length: { minimum: 6 }, confirmation: true, unless: Proc.new { |a| !a.new_record? && a.password.blank? && a.password_reset_token.blank? } 
```

感谢您的帮助和时间！

# mongoid - 在 mongoid 中使用 create 时如何定义数组字段？

> ID：13113208
> 
> 赞同：2
> 
> 时间：2012-10-28T21:31:32.423
> 
> 标签：mongoid

我正在尝试创建一个种子文件来填充我的 mongo 数据库。`nil`当我尝试定义数组字段值时，以下语法会创建一个值。我正在使用 mongoid v3.0.9。我究竟做错了什么？

以下示例在我将它们放入种子文件时不起作用：

```
User.create(name:'name', test_array_field:'[123,123]')
User.create(name:'name', test_array_field:[123,123])
User.create(name:'name', test_array_field:[123,123].to_a) 
```

我已经在我的类中定义了该字段，如下所示：

```
field :test_array_field, type: Array 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T21:35:52.940

你的第二种语法对我有用。

```
class User
  field :roles, type: Array, default: []
end

u = User.create roles: ['superadmin']
u.new_record? # => false
u.roles # => ["superadmin"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-09T12:35:10.103

试试这个：

```
class Foo
  include Mongoid::Document

  field :bar, :type => Array, :default => []
  field :baz, :type => Hash, :default => {}
end 
```

# jsf - PrimeFaces Push：订阅多个动态频道

> ID：13113220
> 
> 赞同：3
> 
> 时间：2012-10-28T21:32:19.623
> 
> 标签：jsf, primefaces, push

我`p:dataTable`在每一行中显示了一种金融工具和实时价格，我想使用 设置广播频道`p:socket`，每行一个频道。目标是当单一仪器的新价格到来时，我只能更新其单元以获得更好的性能。

首先，我尝试从[展示的聊天示例](http://www.primefaces.org/showcase/push/chat.jsf)中复制聊天示例，并从服务器端订阅动态频道，但是这样客户端无法获取消息所在的频道（并且确实`p:socket`处理多个频道？）。

然后，我尝试插入`p:socket`数据表：

```
<p:dataTable var="instrument"  … >
    <p:socket onMessage="handleMessage(#{instrument.id})" channel="/price" autoConnect="false" 
                                      widgetVar="subscriber_#{instrument.id}" /> 
    …
</p:dataTable> 
```

在服务器端：

```
for (Instrument instrument : instruments) {
    RequestContext.getCurrentInstance().execute("subscriber_" +instrument.getId() + ".connect('/" + instrument.getId() + "')");
} 
```

但这会在客户端引发错误：

```
ReferenceError: subscriber_123 is not defined 
```

还有其他方法吗？我在客户端或服务器端管理订阅都没有问题，唯一重要的是我不想将所有价格推给所有客户端。

使用 PrimeFaces 3.4.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-02T09:12:03.853

如果您仍然无法使其工作，以下是您可以动态订阅/连接到频道的方法。

`RequestContext.getCurrentInstance().execute("subscriber.connect('/" + instrument.getId() + "')");`

您不需要在数据表中有多个`<p:socket>`。单个套接字足以处理您的所有 pub/sub。

# c++ - send() 和 recv() 套接字参数

> ID：13113224
> 
> 赞同：-1
> 
> 时间：2012-10-28T21:32:57.483
> 
> 标签：c++, sockets

我的程序发生了一些奇怪的事情，我不确定我应该做什么。这是到目前为止我的代码的伪代码版本：

服务器：

```
//Set up Server sockets

int maximum;

// Collect the maximum
cout << "\nEnter a Maximum:";
cin >> maximum;
cout << "\n";

int *array = new int[maximum + 1];

memset(array, 0, sizeof(array));

while(array[0] < anInt){

    //receive the array from the client
    if(recv(newsockfd, array, maximum, 0) < 0){
        perror("ERROR receiving from socket");
    }

    mathFunction(array);  //A function that alters the contents of array
    array[0]++;

    //If array[0] isn't too big
    if(array[0] < anInt){
        // Send the array to the client
        if(send(newsockfd, array, maximum, 0) < 0){
            perror("ERROR sending to socket");
        }
    }
} 
```

客户：

```
//Set up Client sockets

//The maximum was already sent over earlier
int *array = new int[maximum + 1];

while(array[0] < anInt){

    //receive the array from the server
    if(recv(sockfd, array, maximum, 0) < 0){
        perror("ERROR receiving from socket");
    }

    mathFunction(array);  //A function that alters the contents of array
    array[0]++;

    if(send(sockfd, array, maximum, 0) < 0){
        perror("ERROR sending to socket");
    }
} 
```

我的问题是我不断收到“对等连接重置”错误，这导致分段错误，使我的程序崩溃。此外，在使用 send/recv 函数的第三个参数（当前设置为**maximum**）时，我的程序的行为不同。如果用户输入最多 100 个，它实际上会完美运行，但除此之外的任何东西都搞砸了。

我知道这是一个很长的镜头，但是任何人都可以看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:37:35.083

似乎显然不正确的一件事是：

```
mathFunction(array); 
```

不告诉`mathFunction()`数组中有多少元素。实际上，当您调用时，您通过不在任何地方存储它来丢弃此信息`recv()`（您的代码所做的只是检查它是否小于零，但如果它是正数则不使用它）。调用时`recv()`，您的代码必须准备好接收从 1 到*的任意数量的字节*`maximum`。如果你没有得到你要求的所有字节，那么你需要`recv()`再次调用以获得更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:35:57.967

首先，您发布的代码有一个逻辑错误：

服务器首先从客户端接收数据，对其进行处理，然后将其结果发送回客户端。

在另一端，客户端也从服务器接收数据，对其进行处理，然后将其发送回服务器。

这显然是一种竞争条件，没有人向另一方发送数据以开始通信。

除了逻辑错误之外，您还有一些 C++ 错误：

1）`memset(array, 0, sizeof(array))`只有 0 初始化`sizeof(int*)`数组中的字节而不是整个数组，因为`sizeof(array)`如果`sizeof(int*)`你想 0 初始化整个数组（我认为你想要它），你应该调用：

```
memset(array, 0, (maximum + 1) * sizeof(int)); 
```

甚至更好：

```
std::fill( array, array + maximum + 1, 0 ); 
```

在 C++ 中，使用类`std::vector`代替原始指针要好得多：

```
std::vector<int> array( maximum + 1 ); // automatically initialize to 0 
```

2）您的数组类型是`int*`并按`send/recv`字节计算其输入，因此，如果您想要`send/recv`整个数组，则必须具有以下内容：

```
send(sockfd, (char*)array, maximum * sizeof(int), 0); 
```

3）您应该检查的返回值`send/recv`，特别`recv`是因为它可能会`recv`在每次调用中减少数据，例如您发送 8K 数据并且`recv`只接收前 1K 并且其余部分保留在网络缓冲区中，因此您应该重复调用它直到您阅读您的完全缓冲。

# windows-8 - 软“重启”Windows 8 应用程序

> ID：13113226
> 
> 赞同：2
> 
> 时间：2012-10-28T21:33:15.027
> 
> 标签：windows-8, visual-studio-2012, winjs, windows-store-apps

我将首先说我了解新的 Windows 8 应用程序生命周期以及现在如何 100% 由用户决定是否要终止应用程序。所以，我想我正在寻找的是一种伪重启我的应用程序的方法，尽管我对其他建议持开放态度，因为我对设计现代 UI 应用程序还很陌生。

我正在构建一个与需要通过 OAuth 进行身份验证的 Web 2.0 服务交互的应用程序。幸运的是，Windows 8 WebAuthenticationBroker 使这变得简单：它显示了一个异步模式窗口，其中包含 Web 框架以允许用户登录，并且在完成后我可以提供一个回调方法。

现在，很明显，如果我还没有在 roamingSettings.values 中为用户存储会话密钥，我只想显示这个登录屏幕。我在 Visual Studio 中使用了 Grid App 模板，并在激活应用程序后立即在 default.js 中执行这些功能（检查 roamingStorage、调用 WebAuthBroker 等）。现在，Grid App 模板提供了一个 data.js，允许我定义一些我想要获取的 REST 端点。主要问题是在用户通过身份验证之前我无法获取这些 REST 端点！然而，它们仍然必须（至少，我认为）提前在 data.js 中声明。因此，我现在正在做的事情是避免在用户未登录的情况下出现错误，如下所示：

```
if (roamingSettings.values[sessionKey]){
   list = getFeedItems(); // my function that issues all the REST calls
} else {
   list = new WinJS.Binding.List();
} 
```

如果在身份验证完成后手动重新启动应用程序，这可以正常工作，但我真的希望有一种在身份验证完成后完全异步重新加载应用程序的方法。我已经在这方面花费了大量时间，而且我非常恼火，因为我已经看到其他应用程序这样做（例如 Instametrogram）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:14:53.650

要回答这里的核心问题，你如何软重启：`window.location.reload()`这就是你所需要的。这只是就地刷新。

*但是*，您实际上要做的是重置 ListView 实例上的数据源——您需要做的就是在运行时获取该控件，并将数据源重新分配给它。例如：

```
var lv = document.getElementById("myListView");
lv.winControl.itemSource = list; 
```

这方面的一个例子也应该在你拥有的应用程序中，当它当前将列表分配给列表视图时。

# javascript - JavaScript 中的布隆过滤器算法

> ID：13113228
> 
> 赞同：0
> 
> 时间：2012-10-28T21:33:53.320
> 
> 标签：javascript, algorithm, bloom-filter, spelling

我需要 JavaScript 中的布隆过滤器算法来进行拼写检查> 我有一大堆单词。有没有算法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T21:37:02.300

在问这里之前尝试在谷歌上搜索.. 显示的第一页是[http://www.jasondavies.com/bloomfilter/](http://www.jasondavies.com/bloomfilter/)所以试试吧..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:36:57.027

你可以从这个网站得到它： http: [//la.ma.la/misc/js/bloomfilter/](http://la.ma.la/misc/js/bloomfilter/)具体来说：http : [//la.ma.la/misc/js/bloomfilter/bloomfilter.js](http://la.ma.la/misc/js/bloomfilter/bloomfilter.js)

# solid-state-drive - 可以将IDE的目录（工作区）强制包含到缓存SSD中吗？

> ID：13113236
> 
> 赞同：0
> 
> 时间：2012-10-28T21:35:33.050
> 
> 标签：solid-state-drive

我有混合存储驱动器（HDD 500 GB+ 和**SSD 32 GB**）。我可以强制将 Eclipse IDE 和 Eclipse 的工作目录（Workspace）包含到 SSD 驱动器（默认用于缓存）中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T22:04:13.293

不会。混合驱动器以完全无缝的方式工作。虽然您可能知道它是您的计算机不知道的混合磁盘。SATA 规范中没有任何内容告诉硬盘驱动器在 SSD 缓存中存储什么。它类似于 CPU 缓存。它在那里，它使您的计算机更快，但处理器控制它，而不是程序员。

幸运的是，您无需强制硬盘驱动器将这些内容放入缓存中。如果您经常使用它们，它们会自动缓存。这就是混合动力驱动的美妙之处。

# python - PyGame Timer 没有以预期的速度发布事件

> ID：13113241
> 
> 赞同：1
> 
> 时间：2012-10-28T21:36:07.760
> 
> 标签：python, pygame

我`pygame.time.set_timer(event,milliseconds)`用来将 2 个 USEREVENT 添加到队列中；USEREVENT+1 每秒（1000 毫秒），USEREVENT 每 5 毫秒。这应该意味着我得到的每个 USEREVENT+1 都会得到 200 个 USEREVENT。我只收到 100 个事件。

似乎 10ms 是计时器可以有的最小延迟。我正在尝试使用它来控制我的 FPS，并且 USEREVENT+1 发出信号以通过滴答声“更新”游戏逻辑，但是如果计时器的上限为 10 毫秒，那么这意味着我不能超过100 帧/秒。有谁知道为什么？

另外，对于加分，毫秒必须是整数，这意味着我只能有一个 1000 的倍数的 fps（例如 10、20、25、50、100）。你认为我怎样才能用这种方法达到 60fps？最初，我一直在睡觉直到下一帧的时间，但我希望它对 CPU 有好处，所以我想在滴答声之间闲置。这就是我使用 pygame.time.set_timer 的原因，因为 pygame.event.wait 在队列中出现事件之前一直处于空闲状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T03:21:26.370

要限制 FPS，请使用：`Clock.tick(fps_cap)`

> [http://www.pygame.org/docs/ref/time.html#Clock.tick](http://www.pygame.org/docs/ref/time.html#Clock.tick) 这个方法应该每帧调用一次。它将计算自上次调用以来经过了多少毫秒。
> 
> 如果您传递可选的帧速率参数，该函数将延迟以使游戏运行速度低于给定的每秒滴答数。这可以用来帮助限制游戏的运行速度。通过每帧调用一次 Clock.tick(40)，程序将永远不会以每秒超过 40 帧的速度运行。
> 
> 请注意，此函数使用 SDL_Delay 函数，该函数并非在每个平台上都准确，但不会使用太多 cpu。如果您想要一个准确的计时器，请使用 tick_busy_loop，并且不介意咀嚼 cpu。

# javascript - JS 正则表达式仅查找 1 或 2 个长数字

> ID：13113244
> 
> 赞同：0
> 
> 时间：2012-10-28T21:36:24.937
> 
> 标签：javascript, regex, web, digits

这是我的代码：

```
var dayRegX      = new RegExp("\\b" + "\\d{1, 2}" + "\\b", "g");
if(!dayRegX.test(day.value)){
    alert('not good');
} 
```

测试方法总是返回false，所以我得到了警报，这是为什么？如果我输入 1 或 2 个长数字，它应该返回 true。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T21:41:27.560

`1,`请注意正则表达式中的空格， and之间不应有空格，而且`2`您似乎不需要 RegExp 构造函数：

```
var regex = /\b\d{1,2}\b/g;
if ( !regex.test(day.value) ) { ... } 
```

# javascript - 与我的 Django 模板一起使用的正确 Javascript 范围是什么？

> ID：13113245
> 
> 赞同：0
> 
> 时间：2012-10-28T21:36:31.740
> 
> 标签：javascript, django, forms

我在 Django 中有一个带有 foo 循环的模板，大致如下所示：

```
{% if items %}

<form method="post" name="managerform" id="managerform" action="">{% csrf_token %}
{{ managerform }}
</form> 

{% for item in items %}

<script type='text/javascript'>
var yes = function yes() { manager(function(response) {
if(response && response.status == 'user') {        
var object = '{{ item }}'
document.managerform.item.value = object;
document.managerform.preferences.value = "Yes";
document.managerform.submit();
} 
else{ 
authUser(); } });}
</script>
...
<button onclick=yes()>Yes</button>
...
{% endfor %} 
```

哪个提交表单，问题是它总是提交最后一个`item`from `items`。我尝试过提出`yes`一个论点，`aitem`但这没有帮助，因为使用`<button onclick=yes("{{item}}")>`完全失败并且正在做：

```
<script>
aitem="{{ item }}"
</script>
<button onclick=yes(aitem)> 
```

只是再次使用最后`item`一个`items`。

对任何人来说，有一个明显的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:47:35.043

将按钮的 HTML 更改为：

```
<button onclick='yes("{{item}}");'>Text</button> 
```

并在您的 django 条件和循环之外完全取出`<script>`代码，使其始终可用，但将其更改为：

```
var yes = function (item) {
    manager(function (response) {
        if (response && response.status == 'user') {
            var object = item;
            document.managerform.item.value = object;  // You could combine this and the previous line
            document.managerform.preferences.value = "Yes";
            document.managerform.submit();
        } else {
            authUser();
        }
    });
} 
```

这样，您的 django`for`循环中唯一的东西就是按钮，每个按钮最终都有一个不同的`yes`函数参数。该`yes`函数现在接受一个参数并按照您的需要使用它。不过，您可能必须修改它以满足您的需求，因为您的代码片段看起来像一个示例，而不是您所拥有的。

# c# - 将模型传递给视图时，您可以放下吗？

> ID：13113249
> 
> 赞同：2
> 
> 时间：2012-10-28T21:37:38.483
> 
> 标签：c#, asp.net-mvc

可以说我有两个类一个基类：

```
public class BaseModel {

} 
```

还有几个孩子：

```
public class FooModel : BaseModel {

}

public class BarModel : BaseModel {

} 
```

现在我的观点是，我希望有这样的模型：

```
@model IList<BaseModel> 
```

这样我就可以在一页上编辑这些模型。

但是，当我在操作中传递这些模型的集合时，我得到一个异常说：

> 传入字典的模型项的类型为“System.Collections.Generic.List `1[BarModel]', but this dictionary requires a model item of type 'System.Collections.Generic.IList`1[BaseModel]”。

像这样：

```
var models = new List<BaseModel>(){ new BarModel(), new FooModel ()}
return View(models); 
```

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:40:50.677

假设您没有修改页面上的模型集合，您的页面不应该采用`IList<T>`. 而是应该采取`IEnumerable<T>`：

```
@model IEnumerable<BaseModel> 
```

那应该处理好事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:50:01.553

您还可以使用 KnownType：

```
[Serilizable]
[KnownType(typeof(FooModel))]
[KnownType(typeof(BarModel))]
public class BaseModel 
{
} 
```

希望这可以帮助。

# benchmarking - Meteor 在许多客户之间共享大量收藏时的效率如何？

> ID：13113256
> 
> 赞同：100
> 
> 时间：2012-10-28T21:38:41.190
> 
> 标签：benchmarking, meteor

想象以下情况：

*   1,000 个客户端连接到显示“Somestuff”集合内容的 Meteor 页面。

*   “Somestuff”是一个包含 1,000 个项目的集合。

*   有人在“Somestuff”集合中插入了一个新项目

会发生什么：

*   客户端上的所有`Meteor.Collection`s 都将被更新，即插入转发给所有客户端（这意味着一条插入消息发送给 1,000 个客户端）

服务器确定需要更新哪个客户端的 CPU 成本是多少？

仅将插入的值转发给客户端而不是整个列表是否准确？

这在现实生活中如何运作？有没有这种规模的基准或实验可用？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2012-12-13T19:37:01.560

简短的回答是只有新数据才能通过网络发送。这是它的工作原理。

Meteor 服务器管理订阅的三个重要部分：*发布函数*，它定义订阅提供哪些数据的逻辑；*Mongo 驱动程序*，它监视数据库的变化；和*合并框*，它结合了客户端的所有活动订阅，并通过网络将它们发送给客户端。

### 发布功能

每次 Meteor 客户端订阅一个集合时，服务器都会运行一个 *发布函数*。发布功能的工作是找出其客户端应该拥有的文档集，并将每个文档属性发送到合并框。它为每个新的订阅客户端运行一次。你可以在发布函数中放入任何你想要的 JavaScript，比如使用`this.userId`. `this.added`发布函数通过调用和将数据发送`this.changed`到 合并框中`this.removed`。有关更多详细信息，请参阅 [完整的发布文档](http://docs.meteor.com/#meteor_publish)。

不过，大多数发布函数不必乱用低级 `added`,`changed`和`removed`API。如果发布函数返回一个 Mongo 游标，Meteor 服务器会自动将 Mongo 驱动程序的输出（`insert`、`update`和`removed`回调）连接到合并框的输入（`this.added`、`this.changed`和`this.removed`）。您可以在发布函数中预先进行所有权限检查，然后直接将数据库驱动程序连接到合并框，而无需任何用户代码，这非常简洁。并且当自动发布打开时，即使是这一点也被隐藏了：服务器会自动为每个集合中的所有文档设置一个查询，并将它们推送到合并框中。

另一方面，您不仅限于发布数据库查询。例如，您可以编写一个发布函数，该函数从 中的设备读取 GPS 位置`Meteor.setInterval`，或从另一个 Web 服务轮询旧版 REST API。在这些情况下，您将通过调用低级和 DDP API 来对合并框进行`added`更改。`changed``removed`

### 蒙哥司机

*Mongo 驱动程序的*工作是监视 Mongo 数据库中实时查询的更改。这些查询连续运行，并随着结果的变化通过调用`added`、`removed`和`changed`回调返回更新。

Mongo 不是实时数据库。所以司机投票。它为每个活动的实时查询保留最后一个查询结果的内存副本。在每个轮询周期中，它将新结果与之前保存的结果进行比较，计算描述差异的最小集合`added`、`removed`和`changed` 事件。如果多个调用者为同一个实时查询注册回调，驱动程序只观察查询的一个副本，调用每个注册的回调并返回相同的结果。

每次服务器更新集合时，驱动程序都会重新计算该集合上的每个实时查询（Meteor 的未来版本将公开一个缩放 API，用于限制哪些实时查询在更新时重新计算。）驱动程序还以 10 秒的计时器轮询每个实时查询以捕获绕过 Meteor 服务器的带外数据库更新。

### 合并框

*合并框*的工作是将客户端所有活动发布函数的结果（`added`和`changed`调用`removed` ）合并到单个数据流中。每个连接的客户端都有一个合并框。它拥有客户端 minimongo 缓存的完整副本。

在您只有一个订阅的示例中，合并框本质上是一个传递。但更复杂的应用程序可能有多个可能重叠的订阅。如果两个订阅都在同一个文档上设置了相同的属性，则合并框会决定哪个值具有优先权并仅将其发送给客户端。我们还没有公开设置订阅优先级的 API。目前，优先级由客户端订阅数据集的顺序决定。客户端进行的第一个订阅具有最高优先级，第二个订阅次之，依此类推。

因为合并框保存客户端的状态，所以它可以发送最少的数据量以使每个客户端保持最新状态，无论发布函数为其提供什么。

### 更新会发生什么

所以现在我们已经为你的场景做好了准备。

我们有 1,000 个连接的客户。每个都订阅了相同的实时 Mongo 查询 ( `Somestuff.find({})`)。由于每个客户端的查询都是相同的，因此驱动程序只运行一个实时查询。有 1,000 个活动的合并框。并且每个客户端的发布功能都在该实时查询上注册了一个`added`, `changed`, 和 `removed`，该实时查询会馈送到一个合并框。没有其他东西连接到合并框。

首先是 Mongo 驱动程序。当其中一个客户端将新文档插入`Somestuff`时，它会触发重新计算。Mongo 驱动程序对 中的所有文档重新运行查询`Somestuff`，将结果与内存中的先前结果进行比较，发现有一个新文档，并调用 1,000 个注册的`insert`回调中的每一个。

接下来是发布功能。这里几乎没有发生什么：1000 个`insert`回调中的每一个都通过调用`added`.

最后，每个合并框都会根据其客户端缓存的内存副本检查这些新属性。在每种情况下，它都会发现这些值尚未在客户端上，并且不会影响现有值。因此，合并框在 SockJS 与其客户端的连接上发出 DDP`DATA`消息，并更新其服务器端内存中的副本。

总 CPU 成本是 diff 一个 Mongo 查询的成本，加上 1,000 个合并框检查其客户端状态并构建新的 DDP 消息有效负载的成本。通过网络传输的唯一数据是发送到 1,000 个客户端中的每一个的单个 JSON 对象，对应于数据库中的新文档，以及从进行原始插入的客户端到*服务器的一条 RPC 消息。*

### 优化

这是我们绝对计划好的。

*   更高效的 Mongo 驱动程序。我们 在 0.5.1 中[优化了驱动程序](http://meteor.com/blog/2012/11/20/meteor-051-database-scaling) ，使每个不同的查询只运行一个观察者。

*   并非每个数据库更改都应该触发重新计算查询。我们可以进行一些自动化改进，但最好的方法是使用 API，让开发人员指定哪些查询需要重新运行。例如，开发人员很明显，将消息插入一个聊天室不应使对第二个聊天室中消息的实时查询无效。

*   Mongo驱动、发布函数和合并框不需要运行在同一个进程中，甚至不需要运行在同一台机器上。一些应用程序运行复杂的实时查询并且需要更多 CPU 来监视数据库。其他的只有几个不同的查询（想象一个博客引擎），但可能有很多连接的客户端——这些需要更多的 CPU 用于合并框。分离这些组件将使我们能够独立地缩放每个部分。

*   许多数据库支持在更新行时触发的触发器并提供旧行和新行。使用该功能，数据库驱动程序可以注册触发器而不是轮询更改。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-02-17T17:28:32.087

根据我的经验，从 0.7.0.1 版本开始，在 Meteor 中共享大量集合的同时使用许多客户端基本上是不可行的。我将尝试解释原因。

如上述帖子以及[https://github.com/meteor/meteor/issues/1821中所述，meteor 服务器必须在](https://github.com/meteor/meteor/issues/1821)**合并框中**为每个客户端保留一份已发布数据的副本。这就是 Meteor 魔法发生的原因，但也导致任何大型共享数据库被重复保存在节点进程的内存中。即使对静态集合使用可能的优化，例如（**[Is there a way to tell meteor a collection is static (will never change)？](https://stackoverflow.com/q/17699022/586086)**），我们在节点进程的 CPU 和内存使用方面遇到了一个巨大的问题。

在我们的案例中，我们向每个客户端发布了 15k 个完全静态的文档集合。问题是，在连接时将这些文档复制到客户端的合并框（在内存中）基本上会使 Node 进程在几乎一秒钟内达到 100% CPU，并导致大量额外的内存使用。这本质上是不可扩展的，因为任何连接的客户端都会使服务器瘫痪（同时连接会相互阻塞），并且内存使用量会随着客户端的数量线性增加。在我们的例子中，每个客户端导致额外的**大约 60MB**内存使用，即使传输的原始数据只有大约 5MB。

在我们的例子中，因为集合是静态的，我们通过将所有文档作为`.json`文件发送来解决这个问题，该文件由 nginx gzip 压缩，然后将它们加载到匿名集合中，导致只有约 1MB 的数据传输而无需额外的 CPU或节点进程中的内存和更快的加载时间。对这个集合的所有操作都是通过使用`_id`服务器上小得多的出版物中的 s 来完成的，从而保留了 Meteor 的大部分好处。这使该应用程序可以扩展到更多客户。此外，由于我们的应用程序大部分是只读的，我们通过在 nginx 后面运行多个 Meteor 实例并进行负载平衡（尽管使用单个 Mongo）进一步提高了可伸缩性，因为每个 Node 实例都是单线程的。

然而，在多个客户端之间共享大型可写集合的问题是一个需要 Meteor 解决的工程问题。可能有比为每个客户端保留所有内容的副本更好的方法，但这需要认真考虑作为分布式系统问题。当前的大量 CPU 和内存使用问题无法扩展。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-18T02:59:23.603

您可以用来回答这个问题的实验：

1.  安装测试流星：`meteor create --example todos`
2.  在 Webkit 检查器 (WKI) 下运行它。
3.  检查通过网络传输的[XHR](http://en.wikipedia.org/wiki/XMLHttpRequest)消息的内容。
4.  观察到整个集合没有跨线移动。

有关如何使用 WKI 的提示，请查看这篇[文章](http://jtaby.com/2012/04/23/modern-web-development-part-1.html)。它有点过时了，但大部分仍然有效，尤其是对于这个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-05T00:10:23.583

这仍然是一岁，因此我认为“流星1.0”之前的知识，所以事情可能再次改变？我还在调查这个。 [http://meteorhacks.com/does-meteor-scale.html](http://meteorhacks.com/does-meteor-scale.html) 导致“如何缩放 Meteor？” 文章 [http://meteorhacks.com/how-to-scale-meteor.html](http://meteorhacks.com/how-to-scale-meteor.html)

# sql - 返回不同的列，按重复数排序

> ID：13113260
> 
> 赞同：0
> 
> 时间：2012-10-28T21:39:33.723
> 
> 标签：sql, join, count, sql-order-by

这是我的三个相关 sql 表及其相关属性：

1.  具有属性的 OrderType`ID`
2.  RestaurantVisit，与财产`OrderTypeID`和`RestaurantID`
3.  餐厅，有财产`ID`

当给定一个订单类型（例如饮料、配菜、主菜）时，我需要返回之前订购过该订单类型的所有餐厅，按该类型订单**最多**的餐厅订购。

例如，给定 type `side`，我返回 Restaurants `r1, r2, r3`，其中 r1 是所有餐厅中订单**最多**`side`的餐厅，`r2`是第二多的餐厅，等等。

这是我到目前为止所拥有的（请记住，我已经获得了一个 OrderTypeID）：

```
SELECT DISTINCT r.ID
FROM Restaurant r
  JOIN RestaurantVisit rv
    ON rv.OrderTypeID = ?
WHERE rv.ID = r.ID 
```

这目前可以返回所有曾经收到给定类型订单的餐厅。我现在需要做的是由具有给定类型订单最多的餐厅订购这些。

我在想的是在某处添加这样的东西，但我完全不确定：

`ORDER BY COUNT(rv.OrderTypeID = ?)`

有人有想法么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:45:10.707

您将要添加一个`GROUP BY`：

```
SELECT r.ID, rv.OrderTypeId
   , COUNT(1) AS CountOfOrdersAtRestaurant
FROM Restaurant AS r
INNER JOIN RestaurantVisit AS rv ON r.RestaurantId = rv.RestaurantId
GROUP BY r.ID, tv.OrderTypeID
ORDER BY COUNT(1) DESC 
```

这将按餐厅和 orderType 对结果进行分组。然后你可以添加一个`ORDER BY`以你想要的顺序显示结果。

如果您不添加 a `WHERE`，它将返回此查询中的所有餐厅和订单类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T21:58:26.367

```
 SELECT R.ID, R.Name, Count(V.OrderTypeID) NumVisits
    FROM OrderType T
    JOIN RestaurantVisit V on V.OrderTypeID = T.ID
    JOIN Restaurant R on R.ID = V.RestaurantID
   WHERE T.name = 'side'
GROUP BY R.ID, R.Name
ORDER BY NumVisits DESC; 
```

ORDER BY 的 ANSI/ISO 标准是使用`column alias`. (INNER) JOIN 将确保该类型之前已由餐厅订购。

# windows-runtime - 是否可以将 Windows RT 应用程序移植到 Windows Phone 应用程序？

> ID：13113262
> 
> 赞同：1
> 
> 时间：2012-10-28T21:39:42.097
> 
> 标签：windows-runtime, windows-phone, async-await, winrt-async

最近刚刚向 Windows 应用商店发布了一个应用程序，我想知道是否可以将其“降级”到 Windows Phone 7.1 - 直到 Windows Phone 8 到来。

真正的问题是异步的东西，我找到了“异步目标包”，但它需要 Visual Studio 2012；但是 VS2012 不适用于 Phone SDK 7.0、7.1。

我没有心情在我全新的 Windows 8 机器上安装又旧又丑的 Visual Studio 2010 :)

有谁知道解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T11:31:42.193

Windows Phone 8 已经到来，不幸的是，如果代码使用 async/await，它不允许您为 Windows Phone 7.1 编译应用程序。您可以尝试将代码移植到支持 async/await 开箱即用的 Windows Phone 8。

如果你仍然想要你的应用程序的 WP7.1 端口并且仍然使用 async/await 功能，那么除了为 WP7 + async ctp 3 安装 VS2010 express 之外，你别无选择。

尽管[适用于 Visual Studio 2012 的异步目标包](https://www.microsoft.com/en-us/download/details.aspx?id=29576)已经到来，但由于 WP7 是 Silverlight 4，并且目标包适用于 Silverlight 5，因此您无法定位 WP7 项目。

更新：有一种方法可以使用这个漂亮的[NuGet 包](https://nuget.org/packages/Microsoft.Bcl.Async)在 Visual Studio 2012 Express for Windows Phone 上编译 WP7 应用程序。但是，请注意，它目前处于预发布版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:56:36.977

好吧，Windows Phone 8 假设明天推出，那么您为什么需要将您的应用程序降级到 Windows Phone 7.1？

[本文](http://blogs.windows.com/windows_phone/b/wpdev/archive/2012/09/12/windows-phone-8-sdk-preview-program-is-now-open.aspx)可能会回答您的问题。

> 今天您可能还看到了 Visual Studio 2012 的在线发布活动。Windows Phone SDK 8.0 构建在 Visual Studio 2012 之上，使您能够构建面向 Windows Phone 8 和 Windows 的应用程序和游戏电话 7.5。Windows Phone SDK 7.1 可以与 Visual Studio 2012 并行安装并在 Windows 8 上运行。

# java - 基于数组的堆栈实现问题（java）

> ID：13113267
> 
> 赞同：0
> 
> 时间：2012-10-28T21:39:54.580
> 
> 标签：java

我无法在 java 中将堆栈实现为数组。当我尝试使用该数组时，我得到了 nullPointerExceptions。我知道我的其余代码可以工作，因为我能够使用我创建的堆栈的链表实现来运行程序。代码如下：

编辑：堆栈跟踪是

```
Exception in thread "main" java.lang.NullPointerException
    at LispEvaluator.evaluate(LispEvaluator.java:238)
    at LispEvaluator.fileLoader(LispEvaluator.java:67)
    at Driver.main(Driver.java:16) 
```

这是 lispEvaluator 类的代码

```
//code starts here
         import java.util.*;
         import java.io.*;

        public class LispEvaluator {

        // Current input Lisp expression
        private String inputExpr;
        private Scanner sc;
        private StackList exprStack;
        private StackList tempStack;

        // default constructor
        // set inputExpr to "" 
        // create stack objects
        public LispEvaluator()
        {
        inputExpr = "";
        }

        // default constructor
        // set inputExpr to inputExpression 
        // create stack objects
        public LispEvaluator(String inputExpression) 
        {
            inputExpr = inputExpression;
            }

        // set inputExpr to inputExpression 
        // clear stack objects
        public void reset(String inputExpression) 
        {
        inputExpr = inputExpression;
        StackList exprStack=new StackList(50);
        StackList tempStack=new StackList(50);

        }

        private boolean checkifNumber() {
            return false;
        }
        public void fileLoader(String mode,String file){
            //Validate the user entered mode
            if(mode.equals("0")){
                exprStack=new StackList(50);
                tempStack=new StackList(50);}
            else{
                    ArrayStack exprStack=new ArrayStack(50);
                    ArrayStack tempStack=new ArrayStack(50);

                }
                try{
                //Try to read the array from file
                sc = new Scanner(new File(file));
                while (sc.hasNextLine()) {
                    double result=0;
                    inputExpr=sc.nextLine();
                    reset(inputExpr);

                    result=evaluate();
                    System.out.println(result);
                }
                }

                catch (FileNotFoundException e){
                    System.out.println("Cannot find requested input file");
                    }
                catch(IOException io){
                    System.out.println("General file io error occured. Try again");
                    }

        }

        // This function evaluate current operator with its operands
        // See complete algorithm in evaluate()
        //
        // Main Steps:
        //      Pop operands from expressionStack and push them onto 
        //          tempStack until you find an operator
        //      Apply the operator to the operands on tempStack
        //          Push the result into expressionStack
        //

       private double add() {
          double op1 = (Double) tempStack.pop();
          double temp=op1;
          while (tempStack.size()>0){
          double op2 = (Double) tempStack.pop();
          temp = temp + op2;}
            return temp;
        }

        private double multiply() {
            double op1 = (Double) tempStack.pop();
          double temp=op1;
          while (tempStack.size()>0){
            double op2 = (Double) tempStack.pop();
            temp = temp * op2;}
              return temp;
        }

        private double subtract() {
            if (tempStack.size() == 1) {
                            double temp = -1*(Double) tempStack.pop();
                       return temp;
                } else {

                    double op1 = (Double) tempStack.pop();
                  double temp=op1;
                  while (tempStack.size()>0){
                    double op2 = (Double) tempStack.pop();
                    temp = temp - op2;}
                      return temp;
        }
        }

        private double divide() {
            double temp;
            if (tempStack.size() == 1) {
                             temp = 1 / (Double) tempStack.pop();
                return temp;
                            }
                 else if (tempStack.size() >=1) {
                    double op1 = (Double) tempStack.pop();
                    temp=op1;

                  while (tempStack.size()>0){
                    double op2 = (Double) tempStack.pop();
                    temp = temp / op2;}
                      return temp;
                }
                return 0;
        }

        private void evaluateCurrentOperation()
        {

        while( exprStack.top().getClass().getName().equals("java.lang.Double") ) {
                tempStack.push( (Double)exprStack.pop() );
            }
            Character operator = (Character)exprStack.pop();
            Double result = null;
            switch( operator ) {
                case '+':
                    result = add();
                    break;
                case '*':
                    result = multiply();
                    break;
                case '-':
                    result = subtract();
                    break;
                case '/':
                    result = divide();
                    break;
            }
            exprStack.push( result );
                    }

        /**
         * This function evaluates Lisp expression in inputExpr
         * It return result of the expression 
         *
         * The algorithm:  
         *
         * Step 1   Scan the tokens in the expression string.
         * Step 2       If you see an operand, push operand object onto the expressionStack
         * Step 3           If you see "(", next token should be an operator
         * Step 4       If you see an operator, push operator object onto the expressionStack
         * Step 5       If you see ")"  // steps in evaluateCurrentOperation() :
         * Step 6           Pop operands and push them onto tempStack 
         *                  until you find an operator
         * Step 7           Apply the operator to the operands on tempStack
         * Step 8           Push the result into expressionStack
         * Step 9    If you run out of tokens, the value on the top of expressionStack is
         *           is the result of the expression.
         */
        public double evaluate()
        {
        // only outline is given...
        // you need to add statements
        // you may delete or modify  any statements in this method

            // use scanner to tokenize inputExpr
            Scanner inputExprScanner = new Scanner(inputExpr);

            // Use zero or more white space as delimiter,
            // which breaks the string into single character tokens
            inputExprScanner = inputExprScanner.useDelimiter("\\s*");

            // Step 1: Scan the tokens in the string.
            while (inputExprScanner.hasNext())
            {

                // Step 2: If you see an operand, push operand object onto the expressionStack
                if (inputExprScanner.hasNextInt())
                {
                    // This force scanner to grab all of the digits
                    // Otherwise, it will just get one char
                    String dataString = inputExprScanner.findInLine("\\d+");
            exprStack.push(new Double(dataString));

            // more ...
                }
                else
                {
            // Get next token, only one char in string token
                    String aToken = inputExprScanner.next();
                    char item = aToken.charAt(0);
                    String nextToken;
            char nextItem;
                    switch (item)
                    {
                    // Step 3: If you see "(", next token should be an operator
                case '(':
                    nextToken = inputExprScanner.next();
                    nextItem = nextToken.charAt(0);
                    // Step 4: If you see an operator, push operator object onto the expressionStack
                if (nextItem == '+') {
                                exprStack.push(nextItem);
                            } else if (nextItem == '-') {
                                exprStack.push(nextItem);
                            } else if (nextItem == '*') {
                                exprStack.push(nextItem);
                              }else if (nextItem == '/'){
                                    exprStack.push(nextItem);
                                }
                             else {
                                exprStack.push(nextItem);
                            }

                break;
                    // Step 5: If you see ")"  // steps 6,7,8 in evaluateCurrentOperation() 
                case ')':

                    try {
                    evaluateCurrentOperation();
                } catch (EmptyStackException e) {
                    break;
                }

                break;
                        default:  // error
                            throw new RuntimeException(item + " is not a legal expression operator");
                    } // end switch
                } // end else
            } // end while

            // Step 9: If you run out of tokens, the value on the top of expressionStack is
            //         is the result of the expression.
            //
            //         return result
            double result = (Double) exprStack.pop();
        return  result;   
        }
    }

        /*
        // This static method is used by main() only
        private static void evaluateExprt(String s, SimpleLispExpressionEvaluator expr) 
        {
            Double result;
            System.out.println("Expression " + s);
        expr.reset(s);
            result = expr.evaluate();
            System.out.printf("Result %.2f\n", result);
            System.out.println("-----------------------------");
        }

        // simple tests 
        public static void main (String args[])
        {
            SimpleLispExpressionEvaluator expr= new SimpleLispExpressionEvaluator();
            String test1 = "(+ (- 6) (* 2 3 4) (/ (+ 3) (* 1) (- 2 3 1)))";
            String test2 = "(+ (- 632) (* 21 3 4) (/ (+ 32) (* 1) (- 21 3 1)))";
            String test3 = "(+ (/ 2) (* 2) (/ (+ 1) (+ 1) (- 2 1 )))";
            String test4 = "(+ (/2))";
            String test5 = "(+ (/2 3 0))";
            String test6 = "(+ (/ 2) (* 2) (/ (+ 1) (+ 3) (- 2 1 ))))";
        evaluateExprt(test1, expr);
        evaluateExprt(test2, expr);
        evaluateExprt(test3, expr);
        evaluateExprt(test4, expr);
        evaluateExprt(test5, expr);
        evaluateExprt(test6, expr);
        } }
        */ 
```

这是数组堆栈：

```
public class ArrayStack implements BoundedStack
{
    private int top;
    private Object stk[];
    private int size;
    private int capacity;

    public ArrayStack(){
        top=-1;
        capacity=50;
        stk=new Object[capacity];
    }
    public ArrayStack(int cap)
    {
        top=-1;
        size=0;
        capacity=cap;
        stk=new Object[capacity];
    }

    public void push(Object item) throws FullStackException
    {
        if(isFull()){
            throw new FullStackException("The stack is full. Cannot push more elements onto the stack");}
        else
        {
            stk[++top]=item;
        }
    }

    public Object pop() throws EmptyStackException
    {
        if(isEmpty()==true)
        {
            throw new EmptyStackException("The stack is empty. Cannot pop another element from the stack");
        }
        else{
            Object e=stk[top];
            stk [top]=null;
            --top;
            return e;
        }
    }
    public Object top() throws EmptyStackException{
        if(isEmpty()==true){
            throw new EmptyStackException("The stack is empty. Thus, it has no top");
                }
        return stk[top];
            }
    public int size(){
        return (top+1);
    }

    public boolean isFull(){
        if (size()==capacity){
            return true;}
        return false;
    }
    public boolean isEmpty(){
        if(size()==0){
            return true;}
        return false;
    }
    public int capacity(){
        return capacity;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:47:36.777

最明显的原因是您在使用之前没有初始化数组元素。

如果您正在创建一个数组，例如： -

```
SomeClass[] arr = new SomeClass[5]; 
```

然后在使用你的数组之前，你需要像这样初始化每个数组元素： -

```
for (int i = 0; i < arr.length; i++) {
    arr[i] = new SomeClass();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:40:27.347

如果导致 NullPointerException 的行是该行

```
exprStack.push(nextItem); 
```

那么问题不在堆栈类中。问题是它`exprStack`是空的（可能是因为它在这一行之前从未被分配过任何东西）。

您在代码中多次出现与以下错误相同的错误：

```
public void reset(String inputExpression) {
    inputExpr = inputExpression;
    StackList exprStack=new StackList(50);
    StackList tempStack=new StackList(50);
} 
```

最后两行完全没用：它们将一个新的 StackList 分配给一个**局部**变量。因此，堆栈被创建，并且立即有资格进行垃圾回收，因为除了超出范围的局部变量之外没有任何东西引用它。

这是发生这种情况的另一个地方：

```
if (mode.equals("0")){
    exprStack=new StackList(50); 
    tempStack=new StackList(50);
}
else {
    ArrayStack exprStack=new ArrayStack(50);
    ArrayStack tempStack=new ArrayStack(50);
} 
```

# xcode - 在标签上显示数字，等待并显示另一个。Xcode 工具

> ID：13113270
> 
> 赞同：1
> 
> 时间：2012-10-28T21:40:06.203
> 
> 标签：xcode, label, delay, wait, xcode4.5

我需要一些关于 xcode 的帮助...我需要在标签上显示一个值，用 [label1 setIntValue: someInt] 等待几秒钟，然后再做一次 [label1 setIntValue: otherInt]。我尝试使用 sleep() 但 ui 卡住了，只显示了第二个 int。我需要做什么？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T21:47:48.147

您需要做的是设置一个计时器。在标签上设置第一个值后，使用以下命令：

```
NSTimer* t = [NSTimer scheduledTimerWithTimeInterval:1 target: self selector:@selector(timerEnded) userInfo: nil repeats:NO]; 
```

在这种情况下，您在触发前等待 1 秒`timerEnded`。因此，在此之后，创建`timerEnded`方法。这是 1 秒后调用的方法。

```
-(void)timerEnded{
    //set value to label
} 
```

# jquery - Jquery单击元素而不影响其他元素

> ID：13113272
> 
> 赞同：1
> 
> 时间：2012-10-28T21:40:15.060
> 
> 标签：jquery, click

如果我想单击“ **.img”**类，那么**div class="hide pane pane_right"**将显示出来而不会影响其他类。这是我的代码

```
<ul class="admin-list">
    <li>
    <!--IOS Start-->
    <div class="wrapper">
        <div class="pane pane_left" style="display:none;">
            <a class="img ios-delete icon-minus" href="#"></a>
        </div>
        <div class="hide pane pane_right">
            <button class="ios-buttons btn btn-danger" href="#">delete</button>
        </div>
        <div class="pane pane_center">
            <div class="pane__content">
                <a href="#">[module]_setup_mysql.sql</a>
            </div>
        </div>
    </div>
    <!--IOS  End-->
    </li>
    <li>
    <!--IOS Start-->
    <div class="wrapper">
        <div class="pane pane_left" style="display:none;">
            <a class="img ios-delete icon-minus" href="#"></a>
        </div>
        <div class="hide pane pane_right">
            <button class="ios-buttons btn btn-danger" href="#">delete</button>
        </div>
        <div class="pane pane_center">
            <div class="pane__content">
                <a href="#">labels_en.po</a>
            </div>
        </div>
    </div>
    <!--IOS  End-->
    </li>
    <li>
    <!--IOS Start-->
    <div class="wrapper">
        <div class="pane pane_left" style="display:none;">
            <a class="img ios-delete icon-minus" href="#"></a>
        </div>
        <div class="hide pane pane_right">
            <button class="ios-buttons btn btn-danger" href="#">delete</button>
        </div>
        <div class="pane pane_center">
            <div class="pane__content">
                <a href="#">labels_zh-hans.po</a>
            </div>
        </div>
    </div>
    <!--IOS  End-->
    </li>
    <li>
    <!--IOS Start-->
    <div class="wrapper">
        <div class="pane pane_left" style="display:none;">
            <a class="img ios-delete icon-minus" href="#"></a>
        </div>
        <div class="hide pane pane_right">
            <button class="ios-buttons btn btn-danger" href="#">delete</button>
        </div>
        <div class="pane pane_center">
            <div class="pane__content">
                <a href="#">labels_zhhans.po</a>
            </div>
        </div>
    </div>
    <!--IOS  End-->
    </li>
</ul> 
```

这是我的jQuery

```
 //create an array to store the header id's
    tableTitle = new Array();
    //iterate through each h2 header element
    $('.img').each( function(index) {
        //store each h2 id in the array
        tableTitle[index] = $(this).attr('id');
    });

$(document).ready(function(){
    //when user clicks on a header
    $(".img").click(

        function(){
                //create a loop to close all of the paragraphs after user click
                for (var i=0; i<3; i++) {
                    $('#'+tableTitle[i]).find(".pane_right").hide();

                }

        $(".wrapper").ready(function(){     
            //check the css of the paragraph associated with the clicked header
             if($(this).find(".pane_right").css('display') == 'none'){
                //if display is set to none in css, show the paragraph
                $(this).find(".pane_right").show();
                $(this).width('56%');
            }else{
                //if the display is not set to none, hide the paragraph
                $(this).find(".pane_right").hide();
            }
            });
        }

    );

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:14:15.793

根据你的小提琴和你的评论，我有一些建议给你。首先，这个：

```
//create an array to store the header id's
tableTitle = new Array();
//iterate through each h2 header element
$('.img').each( function(index) {
    //store each h2 id in the array
    tableTitle[index] = $(this).attr('id');
}); 
```

没有真正做任何事情，因为没有为任何包含 class 的元素分配 ID `img`。换句话说，您可以将之前的这段代码一起划掉。此外，一些基础知识的快速规则，之前的任何东西都`$(document).ready(function(){`被认为是“全局的”，并且像您的 .each 语句这样的功能不会以这种方式在您的脑海中运行。它将在 jsfiddle 中工作，但那是因为 fiddle 将 js 包装在 doc ready 函数中。

此外，在较新的 jQuery 中，您当然可以`$(document).ready(function(){ /* do work */ })`用`$(function(){ /* do work */ })`更短且更容易记住的替代。

其次，当你需要更多细节时，我注意到很多类的使用。没问题，我可以在不使用 ID 的情况下向您展示一些很棒的 jQuery。不过，您必须了解，使用 jQuery 选择器，它们就像 CSS 一样。a`#`在元素 ID 前面使用以获取确切的第一个匹配元素。

例如：

```
// HTML
<a id="bob" href="javascript:void()">click 1</a>
<a id="bob" href="javascript:void()">click 2</a>
<a id="bob" href="javascript:void()">click 3</a>

// Some Script
console.log( $("#bob").text() ); //  will result in "click 1"
// There reason only "click 1" will display is because it is the FIRST MATCHING ID 
```

另一方面，诸如此类的类选择器`$(".img")`当然会抓取包含该类的每个单个元素，无论它是从什么调用的。因此，在您的示例中，在`.img").click(...`（顺便说一句，您做得正确），`.wrapper`内部调用正在获取具有 class 的***所有内容***`wrapper`。根据您的评论，这是不希望的。

因此，重写如下：

> 第一次重写，不知道为什么要在单击时调整中心列的宽度，因为它从未调整回来，因此可以从一开始就进行调整。并使用单击来简单地切换删除按钮，如下所示：

```
//  simple breakdown
$(".pane_center").width('56%');
$(".img").click(function(e){
    //  calls for the parent wrapper so we can grab anything within
    var wrapper = $(this).parents(".wrapper").first();
    //  grab the child that needs hidden
    wrapper.find(".pane_right").toggle();
}); 
```

> ***或者***可以写成

```
$(".pane_center").width('56%');
$(".img").click(function(e){
    //  This only works with the html sequence as you have it
    //  simply grabs the img parent and then its sibling that needs hidden
    $(this).parent().siblings(".pane_right").toggle();
}); 
```

但是，如果您想在隐藏列后执行某些操作，则可以使用切换的回调函数：

```
$(".img").click(function(e){
    $(this).parent().siblings(".pane_right").toggle(function(e) {
        if ($(this).is(":visible")) {
            $(this).siblings(".pane_center").width('56%');
        }
        else {
            $(this).siblings(".pane_center").width('');
        };
    });
}); 
```

在你的小提琴中尝试每一个，你会发现它们都有效，问题是你的真实意图。

jQuery 参考资料：

*   [**选择器**](http://api.jquery.com/category/selectors/)
*   [**父母（）**](http://api.jquery.com/parent/)
*   [**父母（）**](http://api.jquery.com/parents/)
*   [**第一的（）**](http://api.jquery.com/first/)
*   [**兄弟姐妹（）**](http://api.jquery.com/siblings/)
*   [**切换（）**](http://api.jquery.com/toggle/)

# java - java中的初学者词法分析器

> ID：13113274
> 
> 赞同：0
> 
> 时间：2012-10-28T21:40:23.830
> 
> 标签：java, analyzer, lexical

我正在写一个词法分析器。我知道这非常简单。它会运行，但无论何时输入输入，程序都会将其视为无效字符（即使它们应该是有效的）。我做错了什么？

```
import java.util.*;
import java.util.Scanner;

public class LAnalyze{

    public static int i;

    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);
        String s;

        System.out.println("Input something to lexically analyze:  ");
        s = input.next( );
        int j = 1;

        if( s.charAt(i)!='a'||s.charAt(i)!='b'||s.charAt(i)!='c'||s.charAt(i)!='d'||s.charAt(i)!='e'||s.charAt(i)!='f'||
            s.charAt(i)!='g'||s.charAt(i)!='h'||s.charAt(i)!='i'||s.charAt(i)!='j'||s.charAt(i)!='k'||s.charAt(i)!='l'||
            s.charAt(i)!='m'||s.charAt(i)!='n'||s.charAt(i)!='o'||s.charAt(i)!='p'||s.charAt(i)!='q'||s.charAt(i)!='r'||
            s.charAt(i)!='s'||s.charAt(i)!='t'||s.charAt(i)!='u'||s.charAt(i)!='v'||s.charAt(i)!='w'||s.charAt(i)!='x'||
            s.charAt(i)!='y'||s.charAt(i)!='z'||s.charAt(i)!='A'||s.charAt(i)!='B'||s.charAt(i)!='C'||s.charAt(i)!='D'||
            s.charAt(i)!='E'||s.charAt(i)!='F'||s.charAt(i)!='G'||s.charAt(i)!='H'||s.charAt(i)!='I'||s.charAt(i)!='J'||
            s.charAt(i)!='K'||s.charAt(i)!='L'||s.charAt(i)!='M'||s.charAt(i)!='N'||s.charAt(i)!='O'||s.charAt(i)!='P'||
            s.charAt(i)!='Q'||s.charAt(i)!='R'||s.charAt(i)!='S'||s.charAt(i)!='T'||s.charAt(i)!='U'||s.charAt(i)!='V'||
            s.charAt(i)!='W'||s.charAt(i)!='X'||s.charAt(i)!='Y'||s.charAt(i)!='Z'||s.charAt(i)!='0'||s.charAt(i)!='1'||
            s.charAt(i)!='2'||s.charAt(i)!='3'||s.charAt(i)!='4'||s.charAt(i)!='5'||s.charAt(i)!='6'||s.charAt(i)!='7'||
            s.charAt(i)!='8'||s.charAt(i)!='9'||s.charAt(i)!='-'||s.charAt(i)!='_'||s.charAt(i)!=' ') {

            for (int i = 0; i < s.length(); i++) {  
                System.out.println("Token " + j + " = " + (s.charAt(i)));
                j++;
            }
        }
        else {
            System.out.println("Invalid character(s) entered.. Program terminated!\n");
            System.exit(0);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:03:41.150

似乎不可能得到你说你从这段代码中得到的结果。你的 if 语句是错误的。就目前而言，它将永远是正确的。一个字符总是不等于某个字符或不等于另一个字符。所有的 != 都应该是 ==。我还将在报告它的 else 部分中打印出坏字符：

```
System.out.println("bad character " + s.charAt(i) +
     " decimal value: " + (int) s.charAt(i)); 
```

Scanner 自己进行词法分析，也就是说，它返回标记，而不是整个字符串。我认为您应该使用 Console 并获取输入的所有内容：

```
Console console = System.console();
s = console.readLine("Input something to lexically analyze:  "); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-28T22:23:34.590

```
import java.util.*;

public class Main {
    static int i;

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        String s = "";
        while (true) {
            System.out.println("Input something to lexically analyze: ");
            s = input.nextLine();
            analize(s);
        }
    }

    public static void analize(String s) {
        String t = "-1234567890_ abcdefjhijklmnopqrstuvwxyzABCDEFJHIJKLMNOPQRSTUVWXYZ";
        char[] tt = t.toCharArray();
        char[] cc = s.toCharArray();
        int z = 1, i = 0, j = 0;
        for (i = 0; i < cc.length; i++) {
            for (j = 0; j < tt.length; j++) {
                if (cc[i] == tt[j]) {
                    System.out.println("Token " + z + " = '" + cc[i] + "'");
                    z++;
                    break;
                }
            }
            if (j > tt.length - 1) {
                System.out.println("Invalid character " + (i + 1) + " ('" + cc[i] + "') entered...");
            }
        }
    }
} 
```

# android - 未能创建部件的控件

> ID：13113281
> 
> 赞同：5
> 
> 时间：2012-10-28T21:40:56.760
> 
> 标签：android, android-layout, nullpointerexception, android-xml

在我的布局目录中打开大约一半的 android XML 文件时出现空指针异常。为什么有些文件打开而有些文件不打开似乎没有模式。

我将eclipse升级到Juno。重新安装所有插件（ADT），重新安装 android SDK。我带来了我的旧工作区并调整了我的项目以指向新的 android SDK。

堆

> java.lang.NullPointerException 在 com.android.ide.eclipse.adt.internal.editors.layout.configuration.ConfigurationComposite.setLocaleCombo(ConfigurationComposite.java:1566) 在 com.android.ide.eclipse.adt.internal.editors.layout .configuration.ConfigurationComposite.syncRenderState(ConfigurationComposite.java:3049) 在 com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.activated(GraphicalEditorPart.java:1158) 在 com.android.ide.eclipse .adt.internal.editors.layout.LayoutEditorDelegate.delegatePageChange(LayoutEditorDelegate.java:679) 在 com.android.ide.eclipse.adt.internal.editors.common.CommonXmlEditor.pageChange(CommonXmlEditor.java:359) 在 org.eclipse .ui.part.MultiPageEditorPart.setActivePage(MultiPageEditorPart.java:1081) 在 org.eclipse.ui.forms.editor.FormEditor。setActivePage(FormEditor.java:607)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T16:23:34.097

我找到了解决这个问题的一种方法。由于不相关的原因，我的日食最近崩溃了（并且不会再次开始）。为了让它重新开始，我删除了 ${workspace}/.metadata/.plugins 中的大部分文件。这些文件会重新生成（但会擦除您保存的一些插件和设置）。解决了我的启动问题和我的 xml 编辑器问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-23T06:24:38.740

只需关闭所有 xml 文件并重新启动 Eclipse SDK

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T05:42:39.093

另一个对我有用并且可能对其他人有用的解决方案：

创建一个新工作区并将现有项目导入其中。与在现有工作区中吹走或移动我的 .plugins 目录相比，尝试这个感觉要好一些。在我创建新工作区并导入给我神秘的“无法创建部件控件”消息的项目后，它工作正常。我很确定 .plugins 或旧工作区的其他地方有问题，但我会继续使用这个新的，直到它开始对我产生影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-29T21:22:53.803

请注意，如果包含的文件夹包含太高的分辨率，也会发生这种情况

示例：layout-sw500dp（此文件夹可以正常工作） layout-sw1000dp（此文件夹导致“无法创建部件的控件”错误）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-11T10:39:23.527

我终于发现了......即使在删除并设置了新的 eclipse 副本后，我也遇到了问题。问题是因为错误的 Java 版本。您应该为您的 Eclipse 找到正确的 Java 版本。就我而言，我有一个使用 Java 8 的项目，为此我使用了 eclipse Luna。但是我开发的另一个项目 vie eclipse kepler 使用 java 6（有问题的项目！）。由于 Kepler 和 Java 8 不兼容，我从开普勒那里得到了这种奇怪的行为。一旦我通过 Java 6 运行 Kepler，一切都恢复正常。如果您想知道如何设置不同的环境变量并设置您的 Windows 路径，而无需每次都为每个项目设置环境变量，请告诉我，我很乐意分享如何编写批处理文件来执行此操作...

# c++ - VS2010、DirectX 和 Intellisense 的麻烦

> ID：13113282
> 
> 赞同：1
> 
> 时间：2012-10-28T21:41:02.460
> 
> 标签：c++, visual-studio-2010, visual-studio, directx, intellisense

我同时安装了 VS2010 和 VS2012，但只有在 VS2012 中突出显示和自动完成似乎才能正常工作。同时 Intellisense 似乎适用于 VS2010，但不适用于 DirectX ......这是一个例子：

VS2012 - 一切顺利。还要注意如何突出显示所有 Windows/DirectX 类型。

![VS2012](../Images/88e368b67096532c7226866c1164d668.png)

* * *

VS2010 - 没有突出显示，没有自动完成。

![VS2010](../Images/abb7b83a1cabb28183785890eb909c90.png)

* * *

VS2010 - 但在这里我们可以看到 IntelliSense 确实有效，只是有选择性。

![VS2010-2](../Images/7624dc86a4c65a1dc9b3d912ddd0f8f7.png)

* * *

我必须使用 VS2010，所以我需要解决这个问题。我对 Visual Studio 有点陌生，所以很明显我错过了一些东西。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:39:03.033

[您可以在文档](http://msdn.microsoft.com/en-us/library/hcw1s69b%28v=vs.100%29.aspx)中阅读有关 VS2010 中的 IntelliSense 的信息。完整的[单词](http://msdn.microsoft.com/en-us/library/1thxcsd9%28v=vs.100%29.aspx)选项也可用：

“要打开完成列表，请键入名称的前几个字母，或按 ALT+向右键或 CTRL+空格键。”

您还应该注意[何时 IntelliSense 不可用](http://msdn.microsoft.com/en-us/library/ks1ka3t6%28v=vs.100%29.aspx)。确保您在项目选项中正确指定了 DirectX 标头的包含目录。重建解决方案有时也有帮助。

# php - PHP 根据日期和时间范围显示内容

> ID：13113283
> 
> 赞同：1
> 
> 时间：2012-10-28T21:41:03.863
> 
> 标签：php, wordpress, date, time

我需要在每周五晚上 9 点显示 ON AIR CONTENT，然后在上午 12 点停止并恢复为 OFF AIR CONTENT。 

以下是我手动更改以使其成为可能的 2 组代码。如果我得到正确的代码，我可以自动执行此操作。

谁能帮我？

```
/* ON AIR CONTENT*/

    function banner_rotator() {
    if (is_home()) { ?>
    <div id="rotator"><iframe width="630" height="386" src="http://www.ustream.tv/embed/8805257?v=3&amp;wmode=direct?autoplay=true" scrolling="no" frameborder="0" style="border: 0px none transparent;"> </iframe> <?php if(function_exists('vslider')){ vslider('frontpage'); } ?></div>
    <div class="main">
                <!-- FIFTH EXAMPLE -->
                <div class="view view-fifth">
                    <img src="../1.jpg" />
                    <div class="mask">
                        <h2>FULLY LOADED 2012</h2>
                        <p>This event has been cancelled.</p>
                        <a href="#" class="info">Details</a>
                    </div>
                </div>
                <div class="view view-fifth">
                    <img src="../2.jpg" />
                    <div class="mask">
                        <h2>KAFINAL - FALLING IN LOVE</h2>
                        <p>"The feedback to Falling in Love has been tremendous all over. I am getting calls from people in Jamaica, the Caribbean and even in the States...</p>
                        <a href="#" class="info">Read More</a>
                    </div>
                </div>  
 </div>
<?php }
}

    add_action('thesis_hook_before_content', 'banner_rotator');

    _____________________________________________________________________________________

    /* OFF AIR CONTENT */

    function banner_rotator() {
    if (is_home()) { ?>
    <div id="rotator"> <?php if(function_exists('vslider')){ vslider('frontpage'); } ?></div>
    <div class="main">
                <!-- FIFTH EXAMPLE -->
                <div class="view view-fifth">
                    <img src="../1.jpg" alt="FULLY LOADED 2012" title="FULLY LOADED 2012" />
                    <div class="mask">
                        <h2>FULLY LOADED 2012</h2>
                        <p>This event has been cancelled.</p>
                        <a href="#" class="info">Details</a>
                    </div>
                </div>
                <div class="view view-fifth">
                    <img src="../2.jpg" alt="KAFINAL - FALLING IN LOVE" title="FULLY LOADED 2012" />
                    <div class="mask">
                        <h2>KAFINAL - FALLING IN LOVE</h2>
                        <p>"The feedback to Falling in Love has been tremendous all over. I am getting calls from people in Jamaica, the Caribbean and even in the States...</p>
                        <a href="#" class="info">Read More</a>
                    </div>
                </div>  
 </div>
<?php }
}

    add_action('thesis_hook_before_content', 'banner_rotator'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:55:12.817

PHP date("G") 函数将以字符串形式提供 24 小时格式的时间。然后，您可以对其进行测试并做出您想要的任何决定。

# c++ - C ++文件输入/输出将输出存储在目录中

> ID：13113286
> 
> 赞同：1
> 
> 时间：2012-10-28T21:41:24.093
> 
> 标签：c++, file, output

我正在处理处理文件 I/O 的 C++ 硬件分配。我以前从未这样做过，可能很明显，但我想问一个关于包含输出和输入文件的路径的快速问题。在示例中，我将它存储在临时目录的 c 驱动器中，尽管它没有出现在任何地方。我是在解决这个问题，还是我没有在我的 c 驱动器中寻找正确的位置？感谢您的帮助，这里是我的代码的一个小副本

```
ifstream in;
ofstream out;

 in.open("c:/temp/gradeBook.txt");
 if(in.fail());
 {
      cout << "Input file opening failed.\n";
      exit(1);

 }    

 out.open("c:/temp/gradeBook2.txt");
 if (out.fail());
 {
       cout << "Out put file opening failed. \n";
       exit(1);
 }  

 cout << "A new gradefile has been comepleted" << endl;

 calculate(in,out);

 out.close();
 in.close();

 system("PAUSE");
 return 0; 
```

}

# java - 以前启动的应用程序现在没有

> ID：13113289
> 
> 赞同：2
> 
> 时间：2012-10-28T21:41:26.807
> 
> 标签：java, android, logcat

我不确定这里发生了什么。我正在添加一个声明以使手机在长按时振动。我把声明放错了位置，手机一直在振动。于是我拔掉了手机，关机了。然后我删除了导致我的手机执行此操作的代码。然后尝试重新启动应用程序，就像我添加代码之前一样，我现在得到了这个。我不确定发生了什么，因为代码与它工作时完全相同。缓存文件会导致这种情况吗？

这是我的日志：

```
10-28 17:34:51.381: W/dalvikvm(718): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
10-28 17:34:51.389: E/AndroidRuntime(718): FATAL EXCEPTION: main
10-28 17:34:51.389: E/AndroidRuntime(718): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.almyz125.stamp/com.almyz125.stamp.Map}: java.lang.NullPointerException
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.os.Handler.dispatchMessage(Handler.java:99)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.os.Looper.loop(Looper.java:137)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.ActivityThread.main(ActivityThread.java:4745)
10-28 17:34:51.389: E/AndroidRuntime(718):  at java.lang.reflect.Method.invokeNative(Native Method)
10-28 17:34:51.389: E/AndroidRuntime(718):  at java.lang.reflect.Method.invoke(Method.java:511)
10-28 17:34:51.389: E/AndroidRuntime(718):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-28 17:34:51.389: E/AndroidRuntime(718):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-28 17:34:51.389: E/AndroidRuntime(718):  at dalvik.system.NativeStart.main(Native Method)
10-28 17:34:51.389: E/AndroidRuntime(718): Caused by: java.lang.NullPointerException
10-28 17:34:51.389: E/AndroidRuntime(718):  at com.almyz125.stamp.Map.onCreate(Map.java:88)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.Activity.performCreate(Activity.java:5008)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
10-28 17:34:51.389: E/AndroidRuntime(718):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
10-28 17:34:51.389: E/AndroidRuntime(718):  ... 11 more 
```

这也是我的代码：

```
public class Map extends MapActivity implements LocationListener {

// variable for determining long press and then automatically adding a pin
// to the map
private int minMillisecondThresholdForLongClick = 800;
private long startTimeForLongClick = 0;
private float xScreenCoordinateForLongClick;
private float yScreenCoordinateForLongClick;
private float xtolerance = 10;// x pixels that your finger can be off but
                                // still constitute    a long press
private float ytolerance = 10;// y pixels that your finger can be off but
                                // still constitute a long press
private float xlow; // actual screen coordinate when you subtract the
                    // tolerance
private float xhigh; // actual screen coordinate when you add the tolerance
private float ylow; // actual screen coordinate when you subtract the
                    // tolerance
private float yhigh; // actual screen coordinate when you add the tolerance

// Variables
MapView mapView;
MapController mc;
long start;
long stop;
int x, y, longTemp, latTemp;
GeoPoint touchPoint;
LocationManager lm;
Drawable d;
Location lastKnownLoc;
List<Overlay> mapoverlays;
GeoPoint gp;
private MyLocationOverlay myLocOverlay, compass;

// Auto Generated Methods
@Override
protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    // sets view to map
    setContentView(R.layout.main);
    mapView = (MapView) findViewById(R.id.mvMain);
    mc = mapView.getController();
    compass = new MyLocationOverlay(Map.this, mapView);
    d = getResources().getDrawable(R.drawable.icon);
    mapoverlays = mapView.getOverlays();
    myLocOverlay = new MyLocationOverlay(this, mapView);

    mapoverlays = mapView.getOverlays();

    lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    lastKnownLoc = lm.getLastKnownLocation(LocationManager.GPS_PROVIDER);

    longTemp = (int) (lastKnownLoc.getLongitude() * 1e6);
    latTemp = (int) (lastKnownLoc.getLatitude() * 1e6);
    gp = new GeoPoint(latTemp, longTemp);

    // enables on screen zoom buttons
    mapView.setBuiltInZoomControls(true);

    // create overlay that shows our location

    // add this overlay to the map and refresh it
    mapView.getOverlays().add(myLocOverlay);
    mapView.invalidate();

    mapoverlays.add(compass);
    compass.enableMyLocation();
    compass.enableCompass();

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // TODO Auto-generated method stub
    // return super.onCreateOptionsMenu(menu);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.options, menu);
    return true;
}

@Override
public boolean onMenuItemSelected(int featureId, MenuItem item) {
    // handle on menu item selected here
    super.onMenuItemSelected(featureId, item);

    // if item is selected satellite view is toggled
    if (item.getItemId() == R.id.opt_tog_view) {
        toggleSat();
    }

    return true;
}

// method to toggles satellite view called in option menu
public void toggleSat() {
    if (mapView.isSatellite()) {

        mapView.setSatellite(false);
    } else {
        mapView.setSatellite(true);
    }
}

// Volume keys zoom in and out.
public boolean onKeyDown(int keyCode, KeyEvent event) {

    mc = mapView.getController();
    switch (keyCode) {
    case KeyEvent.KEYCODE_VOLUME_UP:
        mc.zoomIn();
        break;
    case KeyEvent.KEYCODE_VOLUME_DOWN:
        mc.zoomOut();
        break;
    }
    return super.onKeyDown(keyCode, event);
}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    super.onPause();
    compass.disableMyLocation();
    compass.disableCompass();
    myLocOverlay.disableMyLocation();

}

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
    gp = new GeoPoint(latTemp, longTemp);
    myLocOverlay.enableMyLocation();
    compass.enableMyLocation();
    compass.enableCompass();
    mapoverlays.add(compass);
}

@Override
public void onLocationChanged(Location location) {
    // TODO Auto-generated method stub

}

@Override
public void onProviderDisabled(String arg0) {
    // TODO Auto-generated method stub

}

@Override
public void onProviderEnabled(String arg0) {
    // TODO Auto-generated method stub

}

@Override
public void onStatusChanged(String arg0, int arg1, Bundle arg2) {
    // TODO Auto-generated method stub

}

@Override
public boolean dispatchTouchEvent(MotionEvent ev) {
    /*
     * We want to capture the place the user long pressed on the map and add
     * a marker (pin) on the map at that lat/long. This solution: 1\. Allows
     * you to set the time threshold for what constitutes a long press 2.
     * Doesn't get fooled by scrolling, multi-touch, or non-multi-touch
     * events
     * 
     * Thank you Roger Kind Kristiansen for the main idea
     */

    // get the action from the MotionEvent: down, move, or up
    int actionType = ev.getAction();

    if (actionType == MotionEvent.ACTION_DOWN) {
        // user pressed the button down so let's initialize the main
        // variables that we care about:
        // later on when the "Action Up" event fires, the "DownTime" should
        // match the "startTimeForLongClick" that we set here
        // the coordinate on the screen should not change much during the
        // long press

        startTimeForLongClick = ev.getEventTime();
        xScreenCoordinateForLongClick = ev.getX();
        yScreenCoordinateForLongClick = ev.getY();

    } else if (actionType == MotionEvent.ACTION_MOVE) {
        // For non-long press actions, the move action can happen a lot
        // between ACTION_DOWN and ACTION_UP
        if (ev.getPointerCount() > 1) {
            // easiest way to detect a multi-touch even is if the pointer
            // count is greater than 1
            // next thing to look at is if the x and y coordinates of the
            // person's finger change.
            startTimeForLongClick = 0; // instead of a timer, just reset
                                        // this class variable and in our
                                        // ACTION_UP event, the DownTime
                                        // value will not match and so we
                                        // can reset.
        } else {
            // I know that I am getting to the same action as above,
            // startTimeForLongClick=0, but I want the processor
            // to quickly skip over this step if it detects the pointer
            // count > 1 above
            float xmove = ev.getX(); // where is their finger now?
            float ymove = ev.getY();
            // these next four values allow you set a tiny box around their
            // finger in case
            // they don't perfectly keep their finger still on a long click.
            xlow = xScreenCoordinateForLongClick - xtolerance;
            xhigh = xScreenCoordinateForLongClick + xtolerance;
            ylow = yScreenCoordinateForLongClick - ytolerance;
            yhigh = yScreenCoordinateForLongClick + ytolerance;
            if ((xmove < xlow || xmove > xhigh)
                    || (ymove < ylow || ymove > yhigh)) {
                // out of the range of an acceptable long press, reset the
                // whole process
                startTimeForLongClick = 0;

            }

        }

    } else if (actionType == MotionEvent.ACTION_UP) {
        // determine if this was a long click:
        long eventTime = ev.getEventTime();
        long downTime = ev.getDownTime(); // this value will match the
                                            // startTimeForLongClick
                                            // variable as long as we didn't
                                            // reset the
                                            // startTimeForLongClick
                                            // variable because we detected
                                            // nonsense that invalidated a
                                            // long press in the ACTION_MOVE
                                            // block

        // make sure the start time for the original "down event" is the
        // same as this event's "downTime"
        if (startTimeForLongClick == downTime) {
            // see if the event time minus the start time is within the
            // threshold
            if ((eventTime - startTimeForLongClick) > minMillisecondThresholdForLongClick) {
                // make sure we are at the same spot where we started the
                // long click
                float xup = ev.getX();
                float yup = ev.getY();
                // I don't want the overhead of a function call:
                xlow = xScreenCoordinateForLongClick - xtolerance;
                xhigh = xScreenCoordinateForLongClick + xtolerance;
                ylow = yScreenCoordinateForLongClick - ytolerance;
                yhigh = yScreenCoordinateForLongClick + ytolerance;
                if ((xup > xlow && xup < xhigh)
                        && (yup > ylow && yup < yhigh)) {

                    // **** safe to process your code for an actual long
                    // press ****
                    // comment out these next rows after you confirm in
                    // logcat that the long press works
                    long totaltime = eventTime - startTimeForLongClick;
                    String strtotaltime = Long.toString(totaltime);
                    Log.d("long press detected: ", strtotaltime);

                    // Below is code from my touchy class

                    x = (int) ev.getX();
                    y = (int) ev.getY();
                    touchPoint = mapView.getProjection().fromPixels(x, y);

                    Builder alert = new AlertDialog.Builder(Map.this);
                    alert.setTitle("Pick an option.");
                    alert.setNeutralButton("Place a marker",
                            new DialogInterface.OnClickListener() {

                                public void onClick(DialogInterface dialog,
                                        int which) {

                                    OverlayItem overlayItem = new OverlayItem(
                                            touchPoint, "What's up",
                                            "2nd String");
                                    Mark custom = new Mark(d, Map.this);
                                    custom.dropMarker(overlayItem);
                                    mapoverlays.add(custom);

                                }
                            });
                    alert.setPositiveButton("Get Address",
                            new DialogInterface.OnClickListener() {

                                public void onClick(DialogInterface dialog,
                                        int which) {

                                    Geocoder geocoder = new Geocoder(
                                            getBaseContext(), Locale
                                                    .getDefault());

                                    try {

                                        List<Address> address = geocoder.getFromLocation(
                                                touchPoint.getLatitudeE6() / 1E6,
                                                touchPoint.getLongitudeE6() / 1E6,
                                                1);
                                        if (address.size() > 0) {
                                            String display = "";
                                            for (int i = 0; i < address
                                                    .get(0)
                                                    .getMaxAddressLineIndex(); i++) {

                                                display += address.get(0)
                                                        .getAddressLine(i)
                                                        + "\n";
                                            }

                                            Toast t = Toast.makeText(
                                                    getBaseContext(),
                                                    display,
                                                    Toast.LENGTH_LONG);
                                            t.show();
                                        }
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    } finally {

                                    }

                                }
                            });
                    alert.show();

                }

            }
        }

    }

    return super.dispatchTouchEvent(ev) && true;
}
} 
```

这是我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.almyz125.stamp" >

<uses-permission android:name="android.permission.INTERNET" />

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<application
    android:icon="@drawable/icon"
    android:label="@string/activity_main_map" >
    <uses-library android:name="com.google.android.maps" />

    <activity
        android:name="com.almyz125.stamp.Map"
        android:label="STAMP" >
        <intent-filter>
            <category android:name="android.intent.category.LAUNCHER" >
            </category>

            <action android:name="android.intent.action.MAIN" >
            </action>
        </intent-filter>
    </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:35:15.550

在您创建包含 MyLocationOverlay 的活动时，您无法确定 getLastKnownLocation 不会为空，因此您必须像下面的代码片段一样考虑它：

```
if(lastKnownLoc != null){
    longTemp = (int) (lastKnownLoc.getLongitude() * 1e6);
    latTemp = (int) (lastKnownLoc.getLatitude() * 1e6);
    gp = new GeoPoint(latTemp, longTemp);
} 
```

它在您重新启动手机之前工作的事实仅仅是因为 android 对您的位置进行了先前的修复，但情况可能并非总是如此。

您可能还想尝试使用 runOnFirstFix 方法来更好地解决您的问题。

```
compass.runOnFirstFix(new Runnable() {

        @Override
        public void run() {
            Location location = compass.getLastFix();
            //do your location code here
        }
    }); 
```

# html - 如何将现有的静态 HTML 网站转换为 Joomla？

> ID：13113293
> 
> 赞同：-3
> 
> 时间：2012-10-28T21:41:51.907
> 
> 标签：html, joomla

将我现有的基于 HTML 的网页转换为 Joomla 时，我遇到了一个巨大的问题。在过去的 36 小时里，我一直试图弄清楚这个 Cms 是如何工作的，这一切似乎都是在浪费时间。我想知道在我的情况下是否有更快的解决方案？还是我必须调整我的全部内容并重写大量代码？仅添加我拥有的 HTML 并使用我已有的 HTML 似乎不是任何简单的方法。我真的很满意我的网页，我只想发布它并为管理员和较低级别的管理员启用一些登录面板......

这里有一些指导谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T02:10:40.407

关闭编辑器（编辑您的个人资料并将编辑器设置为无），然后通过粘贴 html（而不是 head 或 body 标签）为每个 html 页面创建一篇文章。

你看过初学者的材料吗？ [http://docs.joomla.org/Beginners](http://docs.joomla.org/Beginners)

# java - 在android中绘制像素会导致错误

> ID：13113295
> 
> 赞同：0
> 
> 时间：2012-10-28T21:42:04.173
> 
> 标签：java, android, pixel

我是 android 游戏开发的初学者，我目前在使用位图和画布在屏幕上绘制像素时遇到了一些麻烦。

这是我的代码：

```
package com.example.arkanoid;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.MotionEvent;
import android.widget.TextView;
import android.graphics.*;

public class MainActivity extends Activity {
    Bitmap  bitmap;
    Canvas canvas;
    int lastx=0, lasty=0;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        bitmap = Bitmap.createBitmap(400,400,Bitmap.Config.ARGB_8888);
        canvas = new Canvas(bitmap);
        bitmap.prepareToDraw();
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void drawPixel(int x, int y) {
        if(bitmap.isMutable()) {
            bitmap.setPixel(x,y,Color.rgb(100,100,100));
        }
        canvas.drawBitmap(bitmap,0,0,null);
    }

    public boolean onTouchEvent(MotionEvent event) {
        int x = (int)event.getX();
        int y = (int)event.getY();
        TextView texto = (TextView)findViewById(R.id.textView1); 
        texto.setText("X: "+x+", Y: "+y);
        if(lastx !=x || lasty !=y){
            lastx=x;
            lasty=y;
            drawPixel(x,y);
        }
    return false;
    }
} 
```

当函数 drawPixel(int x, int y) 被多次调用时，应用程序停止运行：

![错误](../Images/3af9cfc97ee8ce9fea3cc0ec952b39da.png)

并且没有绘制像素，那么这里的错误是什么？谢谢你的时间。

我忘记了 LogCat 的日志，抱歉：

[http://txtup.co/eISOF](http://txtup.co/eISoF)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:22:45.637

根据您上传的logcat，您需要检查是否在位`x & y`图大小之间。

# android - 在 onCreate() 方法中向未绑定的服务发送消息

> ID：13113296
> 
> 赞同：2
> 
> 时间：2012-10-28T21:42:13.300
> 
> 标签：android, service, callback, ipc, oncreate

我正在开发一个应用程序，我需要在离开应用程序时（onPause（））向服务发送消息，使用捆绑包保存我的应用程序的一些数据。它工作得很好。我的问题是，当应用程序启动时，它执行了onCreate()方法，在这个方法中我使用下面的代码来建立应用程序和服务之间的连接：

我的活动.java

```
// This takes care of make the connection
this.getApplicationContext().startService(intent);
this.bindService(intent, mConnectionCallback, Context.BIND_AUTO_CREATE);
/** I need restore the bundle that is in the service, thus i'm sending a message */
Message msg = Message.obtain();
try {
    Bundle bundle = new Bundle();
    msg.setData(bundle);
    msg.what = MyService.REQUEST_BUNDLE;
    msg.replyTo = mMessageDispatcher;
    mServiceConnection.send(msg);
} catch (RemoteException e) {
    e.printStackTrace();
} 
```

问题是当你发送消息时，连接仍然不会建立，因此这会抛出 NullPointerException。而且我不知道如何管理这个。需要明确的是，我的应用程序只是一个简单的时间跟踪器，当用户退出应用程序时，我希望将时间保存在服务的捆绑包中。有没有办法在建立连接后立即发送消息？

你们中的一些人会说：“只需在回调 ServiceConnection 的方法 onServiceConnected (ComponentName className, IBinder service) 中建立连接后发送消息”。但问题是我已经将活动与服务的 API 实现分开了。这是我的课程的完整代码：

服务管理器.java

```
public class ServiceManager extends Service {
private NotificationManager mNM;

protected HashMap<Integer, Method> magicSwitch = new HashMap<Integer, Method>();

public ServiceManager() {
    try {
        for (Method method : Class
                .forName(getClass().getCanonicalName())
                .getMethods()) {
            if (method.isAnnotationPresent(ExecutesWhen.class)) {
                try {
                        ExecutesWhen a = method.getAnnotation(ExecutesWhen.class);
                        magicSwitch.put(a.what(), method);
                        Log.d("AkrasiaService","AkrasiaService now knows how handle a "+method.getName()+" with id="+a.what());
                } catch (Throwable ex) {
                    ex.printStackTrace();
                }
            }
        }
    } catch (SecurityException e) {
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }
}

class ServiceHandler extends Handler {
    @Override
    public void handleMessage(Message msg) {
        Log.d("AkrasiaService","The service is going to manage a message from the client with what="+msg.what);
        try {
            Method met = magicSwitch.get(msg.what);
            if (met == null) {
                throw new NonExistingWhatException();
            } else {
                met.invoke(ServiceManager.this, msg);
            }
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }
    }
}

/**
 * Target we publish for clients to send messages to IncomingHandler.
 */
final Messenger mMessageInBox = new Messenger(new ServiceHandler());

/**
 * Sends a message to the replyTo client.
 * @param replyTo: The <code>Messenger</code> to reply the message.
 * @param what: The what (subject).
 * @param bundle: A data bundle that will go attached to the message.
 */
protected void sendMessageToClient(Messenger replyTo, int what, Bundle bundle) {
    try {
        Message msg = Message.obtain(null,
                what, 0, 0);
        msg.setData(bundle);
        replyTo.send(msg);
    } catch (RemoteException e) {
        e.printStackTrace();
    }
}

@Override
public IBinder onBind(Intent intent) {
    return mMessageInBox.getBinder();
}

@Override
public void onCreate() {
    mNM = (NotificationManager)getSystemService(NOTIFICATION_SERVICE);
    showNotification();
}

/**
 * Show a notification while this service is running.
 */
private void showNotification() {
    //Here we immplement the notification
} 
```

}

AkrasiaService.java（我的具体服务）

```
public class AkrasiaService extends ServiceManager {
public final static int TRACKER_APP_BACKUP_REFRESH = 0;
public final static int TRACKER_APP_BACKUP_RETRIVE = 1;

public Bundle mTrackerBackupBundle;

public AkrasiaService() {
    super();
}

/** This are the handlers of the request from the client application. The
 *  annotation ExecuteWhen specifies which method must handle one determined request. 
 *  It uses the "what" annotation attribute like discriminative. */

@ExecutesWhen(what = AkrasiaService.TRACKER_APP_BACKUP_REFRESH)
public void trackerBundleRefresh(Message msg) {
    mTrackerBackupBundle = msg.getData();
}

@ExecutesWhen(what = AkrasiaService.TRACKER_APP_BACKUP_RETRIVE)
public void trackerBundleRetrive(Message msg) {
    sendMessageToClient(msg.replyTo, AkrasiaService.TRACKER_APP_BACKUP_RETRIVE, mTrackerBackupBundle);
}

//Test
@ExecutesWhen(what = AkrasiaService.FOO)
public void fooResponse(Message msg) {
    Bundle bundle = new Bundle();
    bundle.putString("test", "Test value");
    sendMessageToClient(msg.replyTo, AkrasiaService.FOO, bundle);
} 
```

}

AnnotatedHandler.java

```
public class AnnotatedHandler extends Handler {

protected HashMap<Integer, Method> magicSwitch = new HashMap<Integer, Method>();

public AnnotatedHandler() {
    try {
        for (Method method : this.getClass().getMethods() ) {
            if (method.isAnnotationPresent(ExecutesWhen.class)) {
                try {
                    ExecutesWhen a = method
                            .getAnnotation(ExecutesWhen.class);
                    magicSwitch.put(a.what(), method);
                    Log.d("AnnotatedHandler","AnnotatedHandler now knows how handle a "+method.getName()+" and id"+a.what());
                } catch (Throwable ex) {
                    ex.printStackTrace();
                }
            }
        }
    } catch (SecurityException e) {
        e.printStackTrace();
    }
}

@Override
public void handleMessage(Message msg) {
    try {
        Log.d("AnnotatedHandler","The service is going to manage a message from the client with what="+msg.what);
        Method met = magicSwitch.get(msg.what);
        if (met == null) {
            throw new NonExistingWhatException();
        } else {
            met.invoke(AnnotatedHandler.this, msg);
        }
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    } catch (InvocationTargetException e) {
        e.printStackTrace();
    }
} 
```

}

ServiceClient.java（我的服务 api 实现）

```
public class ServiceClient {
/** Messenger for communicating with service. */
Messenger mServiceConnection = null;

/** Flag indicating whether we have called bind on the service. */
private boolean mIsBound = false;

private Messenger mMessageDispatcher;

/**
 * Class for interacting with the main interface of the service. This callback
 * takes care of setup <code>mServiceConnection</code> and therefore, start to 
 * talk with the service.
 */
private ServiceConnection mConnectionCallback = new ServiceConnection() {
    public void onServiceConnected(ComponentName className,
            IBinder service) {
        mServiceConnection = new Messenger(service);
        Log.d("AkrasiaService","The application is connected to the service now!");
        mIsBound = true;
    }

    public void onServiceDisconnected(ComponentName className) {
        mServiceConnection = null;
    }
};

/**
 * This method makes the binding between the service and the client application.
 * @param intent: An intent of the concrete implementation of the <code>ServiceManager</code>
 * @param activity: The Activity thats want communicate with the service.
 */ 
public void doBindService(Intent intent, Activity activity) { 
    Log.d("AkrasiaService","The application is trying to bind to the service...");
    activity.getApplicationContext().startService(intent);
    activity.bindService(intent, mConnectionCallback, Context.BIND_AUTO_CREATE);
}

public void doUnbindService(Activity activity) {
    if (mIsBound) {
        activity.unbindService(mConnectionCallback);
        mIsBound = false;
    }
}

/**
 * This method sends a single message to the service.
 * @param what: The what (subject) of the message.
 */
public void sendMessage(int what) {
    Message msg = Message.obtain();
    try {
      Bundle bundle = new Bundle();
      msg.setData(bundle);
      msg.what = what;
      msg.replyTo = mMessageDispatcher;
      Log.d("AkrasiaService","The application is going to send a message to the service");
      mServiceConnection.send(msg);
    } catch (RemoteException e) {
      e.printStackTrace();
    }
}

/**
 * This method sends a message to the service with a bundle attached.
 * @param what: The what (subject) of the message.
 * @param bundle: The data bundle attached to the message.
 */
public void sendMessage(int what, Bundle bundle) {
    Message msg = Message.obtain();
    try {
      msg.setData(bundle);
      msg.what = what;
      msg.replyTo = mMessageDispatcher;
      mServiceConnection.send(msg);
    } catch (RemoteException e) {
      e.printStackTrace();
    }
}

public void setIncomingHandler(Handler handler) {
    mMessageDispatcher = new Messenger(handler);
}

public boolean isConnected() {
    return mIsBound;
} 
```

}

MainActivity.java（我的 Tracker 应用的 Activity）

```
public class MainActivity extends SherlockFragmentActivity {
private ActionBar mActionBar;

private Tab mStatTab;

private Tab mTrackerTab;

private ServiceClient mClientServiceAPI;

/**
 * Handler of incoming messages from service.
 */
public class  MyHandler  extends AnnotatedHandler {
    @ExecutesWhen(what = AkrasiaService.TRACKER_APP_BACKUP_RETRIVE)
    public void handleBackupRestore(Message msg) {
        Log.d("Client","Handling a message");
        Bundle bundle = msg.getData();
        if ((bundle != null) && (!bundle.isEmpty())) {
            Long timeStamp = bundle.getLong("last-time");
            Long chrometerTime = bundle.getLong("chrometer-time");
            Chronometer chrometer = (Chronometer) findViewById(R.id.chronometer);
            //We add the time between the timestamp and now to the chorometer base
            Long now = Calendar.getInstance().getTimeInMillis();
            chrometerTime = now - timeStamp + chrometerTime; 
            chrometer.setBase(chrometerTime);
        }
    }
};

@Override
public void onCreate(Bundle savedInstanceState) {
    setTheme(com.actionbarsherlock.R.style.Sherlock___Theme);
    super.onCreate(savedInstanceState);
    // Notice that setContentView() is not used, because we use the root
    // android.R.id.content as the container for each fragment
    // try {
    // DatabaseFixture.populateDatabase();
    // } catch (NumberFormatException e) {
    // // TODO Auto-generated catch block
    // e.printStackTrace();
    // } catch (ParseException e) {
    // // TODO Auto-generated catch block
    // e.printStackTrace();
    // }
    ApplicationContext.getInstance().setMainActivity(this);
    ApplicationContext.getInstance().setupPreferences();
    sherlockActionBarSetup();
}

private void sherlockActionBarSetup() {
    mActionBar = getSupportActionBar();
    mActionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    mActionBar.setDisplayShowTitleEnabled(false);
    mActionBar.setDisplayShowHomeEnabled(false);

    TabListener<TrackerFragment> trackerTabListener = new TabListener<TrackerFragment>(this,
            "tracker", TrackerFragment.class);
    mTrackerTab = mActionBar.newTab().setText("Track").setTabListener(trackerTabListener);
    mActionBar.addTab(mTrackerTab);

    TabListener<StatFragment> statTabListener = new TabListener<StatFragment>(this, "stats",
            StatFragment.class);
    mStatTab = mActionBar.newTab().setText("Stats").setTabListener(statTabListener);
    mActionBar.addTab(mStatTab);
}

public void sendBackupToTheService() {
    Log.d("Client","We are going to make a backup of the chromnometer");
    Chronometer chrometer = (Chronometer) findViewById(R.id.chronometer);
    Bundle bundle = new Bundle();
    bundle.putLong("last-time", Calendar.getInstance().getTimeInMillis());
    bundle.putLong("chrometer-time", chrometer.getBase());
    bundle.putBoolean("deprecated", false);
    mClientServiceAPI.sendMessage(AkrasiaService.TRACKER_APP_BACKUP_REFRESH, bundle);
}

@Override
protected void onPause() {
    super.onPause();
    sendBackupToTheService();
    mClientServiceAPI.doUnbindService(this);
}

@Override
protected void onStop() {
    super.onStop();
    mClientServiceAPI.doUnbindService(this);
}

public void restarBackupFromService(View view) {
    mClientServiceAPI.sendMessage(AkrasiaService.TRACKER_APP_BACKUP_RETRIVE);
}

@Override
protected void onDestroy() {
    super.onDestroy();
    mClientServiceAPI.doUnbindService(this);
}

@Override
public void onResume() {
    super.onResume();
    //Sadly this behavior can't be exported to ServiceClient.
    //This from below used to be in onResume method
    Log.d("Client","We are going to connect to the service");
    mClientServiceAPI = new ServiceClient();
    mClientServiceAPI.setIncomingHandler(new MyHandler());
    Intent intent = new Intent(AkrasiaService.class.getName());

    mClientServiceAPI.doBindService(intent,this);
}

/*
 * Apparently you can't just tie the callback to the fragment from:
 * http://stackoverflow.com/a/6271637/147072
 */
public void triggerClick(View view) {
    TrackerFragment fragment = (TrackerFragment)getSupportFragmentManager().findFragmentByTag(
            "tracker");
    fragment.triggerClick(view);
}

public void saveTimeClick(View view) {
    TrackerFragment fragment = (TrackerFragment)getSupportFragmentManager().findFragmentByTag(
            "tracker");
    try {
        fragment.saveTimeClick(view);
    } catch (ParseException e) {
        e.printStackTrace();
    }
    // We reload the StatFragment this is to refresh the Graph of the
    // StatFragment
    mActionBar.removeTab(mStatTab);
    TabListener<StatFragment> statTabListener = new TabListener<StatFragment>(this, "stats",
            StatFragment.class);
    mStatTab = mActionBar.newTab().setText("Stats").setTabListener(statTabListener);
    mActionBar.addTab(mStatTab);

}

public void discardTimeClick(View view) {
    TrackerFragment fragment = (TrackerFragment)getSupportFragmentManager().findFragmentByTag(
            "tracker");
    fragment.discardTimeClick(view);
} 
```

您如何在 onResume 方法中的 MainActivity.java 中看到我正在做应用程序和服务之间的绑定，这调用了 ServiceClient.java 的 doBindService(Intent,Activity) 方法，而这个做的是真正的绑定。

我一直在考虑在类 Method 的实例中保存将消息发送到服务的代码块，并将其发送到 api 以便在您的 onServiceConnected 方法上运行它，但我认为必须有更好的方法.

任何建议将不胜感激。

# flash - Flash 忽略提供的策略文件

> ID：13113298
> 
> 赞同：1
> 
> 时间：2012-10-28T21:42:27.960
> 
> 标签：flash, actionscript, cross-domain, policy

我正在开发一个需要套接字的 Flash 和 AS3 项目，但在调试模式（又名 Ctrl+Shift+Enter 模式）下测试它时遇到问题。连接到服务器时，Flash 发出策略请求

```
<policy-file-request/> 
```

正如预期的那样，所以我的程序提供了一个应该作为策略文件的字符串：

```
elif "<policy-file-request/>" in data:
    return '<cross-domain-policy><allow-access-from domain="*" to-ports="843"/></cross-domain-policy>' 
```

我可以在我的输出窗口中看到该字符串已成功发送：

```
Sent <cross-domain-policy><allow-access-from domain="*" to-ports="843"/></cross-domain-policy> 
```

然而，Flash 继续等待整整 3 秒，完成后，它抱怨“等待套接字策略文件时 xmlsocket://127.0.0.1:843 超时（3 秒）”，我得到了违反安全沙盒。我发送的策略文件有什么问题？

# javascript - 使用 write 或 writeString 编写 Windows 边栏小工具时无法保存设置

> ID：13113299
> 
> 赞同：1
> 
> 时间：2012-10-28T21:42:30.053
> 
> 标签：javascript, html, windows, settings, windows-desktop-gadgets

我正在编写一个简单的 Windows 小工具，但在使用此功能时似乎无法保存设置。以下是一些应该完成任务但仍然无法工作的代码：

```
var mySettings = new botanicallileo();

function botanicallileo()
{ 
    this.kitID = "";
    this.load = loadSettings;
    this.save = saveSettings;
}
function saveSettings()
{
     System.Gadget.Settings.writeString("test", "true");
     System.Gadget.Settings.writeString("kitID", this.kitID);
}

function settingsClosing(event)
{
    if (event.closeAction == event.Action.commit)
    {
        mySettings.save();
    }
} 
```

我一定错过了一些非常重要的东西，但我似乎找不到它是什么。我知道设置没有保存，因为我可以检查 .ini 文件，并且似乎没有弹出任何内容，而对于其他小工具，新变量确实出现并保存在文件中。帮助将不胜感激。

注意：设置“测试”就是这样，测试是否有任何东西被写入。不用说它没有被写出来。

# c - GCC 中的 void 指针算法是如何发生的

> ID：13113301
> 
> 赞同：3
> 
> 时间：2012-10-28T21:43:05.527
> 
> 标签：c, pointers, gcc, void-pointers, pointer-arithmetic

```
int main()  
{  
    int a;  
    void *p;  
    p = &a;  
    printf("%ld\n",(long)p);  
    p = p+1;  
    printf("%ld\n",(long)p);  
} 
```

在这个程序中，`p+1`只是将 p 的值增加 1。我知道`void pointer arithmetic`在 中是不可能的`C`，所以`GCC`隐式地这样做。如果是，那么它是否将其视为`char pointer`. 此外，如果 void 指针隐式进行指针运算，为什么`dereferencing`它不可能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T21:45:16.523

C 不允许`void *`指针类型的指针算术。

GNU C 通过考虑 is 的大小来允许`void`它`1`。

从*6.23 对 void 和 Function-Pointers 的算术*：

> 在 GNU C 中，指向 void 的指针和指向函数的指针支持加法和减法运算。这是通过将 void 或函数的大小视为 1 来完成的。

[http://gcc.gnu.org/onlinedocs/gcc/Pointer-Arith.html](http://gcc.gnu.org/onlinedocs/gcc/Pointer-Arith.html)

现在来回答这个问题：

> 此外，如果 void 指针隐式地进行指针运算，为什么不能取消引用。

GNU C 允许使用指针算术，`void *`但仍然不允许`void`声明类型的对象。

# java - Java-gzip 成员预告片

> ID：13113302
> 
> 赞同：1
> 
> 时间：2012-10-28T21:43:10.427
> 
> 标签：java, compression, format, gzip

这是一个更大的任务的一部分，除了这一部分，我已经完成了大部分任务，这有​​点尴尬，因为它在纸上听起来真的很简单。

所以基本上，我有大量的压缩数据。我一直在使用 CRC32 跟踪长度

```
CRC32 checksum = new CRC32();
...
//read input into buffer
checksum.update(buff, 0, bytesRead); 
```

因此，每次读入更多信息时它都会更新。我还使用以下方法跟踪解压缩长度

```
uncompressedLength += manage.read(buff); 
```

所以它是一个 int 值，它具有原始文件的字节数。这是一个小的 Endian 机器。

据我所知，我需要的是我使用的四字节 CRC

```
public byte[] longToBytes(long x) {
    ByteBuffer buffer = ByteBuffer.allocate(8);
    buffer.putLong(x);
    return buffer.array();
}

byte[] c = longToBytes(checksum.getValue()); 
```

但这是 8 个字节。CRC32.getValue 返回一个 long。在这种情况下，我可以将其转换为 int 而不会丢失我需要的信息吗？

然后 ISIZE 应该是......四字节压缩长度模 2^32。我有一个变量 uncompressedLength，它是一个 int。我想我只需要将它转换为字节就可以了？

我一直在对 gzip 的结果和我的程序的结果进行 hexdump，我的标题和数据是正确的，我只是错过了我的预告片。

至于我为什么要手动执行此操作，那是因为分配。相信我，如果可以的话，我很想使用 GZIPOoutputStream。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:12:07.370

`long`CRC32 有 32 位...由于超级接口，该类返回。

未压缩的长度应该是`long`，因为现在大于 2G 的文件并不少见。

所以在这两种情况下，您都需要将 long 的最低 32 位转换为 4 字节。

```
static byte[] lower4bytes(long v)
{
    return new byte[] {
            (byte)(v    ),
            (byte)(v>> 8),
            (byte)(v>>16),
            (byte)(v>>24)
    };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:52:34.733

要以 little-endian 形式写入整数，只需写入整数的低字节（即模 256 或与 0xff 与），然后将其向下移动 8 位或除以 256，然后写入得到的低字节，并重复这两个更多次。您将写入四个字节。由于您只写了四个，因此您将自动编写长度模 2 ^(32)。

# php - Restler 总是在服务器上显示 NOT FOUND，但在本地机器上却没有

> ID：13113304
> 
> 赞同：0
> 
> 时间：2012-10-28T21:43:18.723
> 
> 标签：php, api, mod-rewrite, restler

当我去

```
http://localhost/api/auth/login 
```

我得到了我所期望的......一些让我登录的数据。

然而，当我去

```
http://myurl.com/api/auth/login 
```

我只是得到

```
{
    "error": {
        "code": 404,
        "message": "Not Found"
    }
} 
```

* * *

目前我们有两个人在做这个项目，当我们从本地机器上运行它时，我们两个都没有问题。我们已经到了将应用程序放到托管服务器上的地步，这样我们就可以在我们自己的机器之外开始对其进行测试。

代码是相同的，我知道这一点是因为我们使用了一个服务器也从中提取的 git 存储库。

我的机器是mac，我的朋友是windows机器，我们的主机是linux机器。这并不重要，因为它们都应该与 mod_rewrite 一起工作，这是 Restler 3 的要求。

我能想到的唯一其他细节是服务器由 HostMonster 托管，运行 PHP 5.4.7

任何帮助将不胜感激。你需要更多信息？

=== 编辑：这是我的 .htaccess 文件。此外，服务器运行 CGI/FastCGI 而不是 mod_php

```
Options -MultiViews
DirectoryIndex index.php
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^$ index.php [QSA,L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [QSA,L]
</IfModule>
<IfModule mod_php5.c>
    php_flag display_errors Off
</IfModule> 
```

我刚刚用谷歌搜索了“fastcgi mod_rewrite”，但这些链接都没有帮助：P

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T06:04:04.157

当您遇到此类问题时，请先尝试不重写 url

代替

```
http://myurl.com/api/auth/login 
```

尝试

```
http://myurl.com/api/index.php/auth/login 
```

如果它有效，您将知道问题在于 url 重写

由于您使用的是 CGI/FastCGI，请确保您已设置

```
cgi.fix_pathinfo=0 
```

在您的 php.ini 中，它将确保将路径信息正确传递给 Restler，以便 restler 可以找到路线

如果它不适用于 url 中的 index.php，您可以尝试生成和验证`routes.php`，如下所述

## 路由.php

每次我们在调试模式下运行时，Restler 都会查看所有 api 方法及其文档注释以生成相应的路由。当我们在生产模式下运行它时，它会捕获 routes.php 中的信息并使用它而不是每次都生成路由，从而提高效率。

您可以通过在生产模式下初始化 restler 并在每次调用时刷新来检查生成的路由

```
$r = new Restler(true, true); 
```

然后检查生成的`routes.php`

如果您`routes.php`不包含任何路线，它将如下所示

```
<?php $o = array();

// ** THIS IS AN AUTO GENERATED FILE. DO NOT EDIT MANUALLY ** 
return $o; 
```

如果这是您的情况，这意味着自动加载器无法加载 api 类，您可以通过手动包含 API 类来确认它

如果它开始工作，请使用 github 问题提交一个错误，说明自动加载器因您的服务器配置失败，并给我们更多细节，以便我们可以重现并修复它。

如果仍然无法正常工作，请使用 github 问题提交一个错误，提及您的服务器配置，并提供任何可以帮助的细节，以便我们可以重现并修复它。

感谢您，我们还将根据上述内容编写故障排除指南，以帮助restler社区:)

# java - Eclipse 删除 AndroidManifest.xml 中的活动？

> ID：13113307
> 
> 赞同：0
> 
> 时间：2012-10-28T21:43:36.237
> 
> 标签：java, android, eclipse, ide, android-manifest

通过以下方式添加了新活动： [将 Activity 添加到 Eclipse 中的 Android 项目的最佳方式？](https://stackoverflow.com/questions/2337874/best-way-to-add-activity-to-an-android-project-in-eclipse)

很快，AndroidManifest.xml 中添加的新活动就消失了？

我该如何解决？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:54:53.953

您使用的是什么操作系统？这发生在我使用 Mac OS 时，这`AndroidManifest.xml`是`Read`唯一的，所以我需要将其更改为`Read/Write`

# node.js - Mongo Express 无法正确显示嵌入的文档

> ID：13113312
> 
> 赞同：0
> 
> 时间：2012-10-28T21:44:03.983
> 
> 标签：node.js, mongodb

我正在使用[Mongo Express](http://andzdroid.github.com/mongo-express/)在开发过程中查看我的 MongoDB 实例中的数据。我还使用 connect-mongo 模块将我的会话存储在 MongoDB 中。由于某种原因，Mongo Express 难以解析由 connect-mongo 创建的嵌入式文档。缩进不起作用，引号被转义。在 connect-mongo 中创建的文档以及使用 mongoose 创建的文档都可以正常工作。

![](../Images/cc633250f6757b611c958431bf9d310c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T03:26:00.080

看起来 connect-mongo 将其数据存储为字符串，而不是嵌入文档。您可以尝试使用默认的 MongoDB shell - mongo 并确认是否是这种情况。

# php - 如何将下拉选择插入 MySQL 数据库？

> ID：13113316
> 
> 赞同：0
> 
> 时间：2012-10-28T21:44:33.140
> 
> 标签：php, mysql

我正在尝试为下拉菜单选择的值发布到我的数据库表中。但由于某种原因，它没有将值输入数据库。我正在尝试发布`cat_id`到我的数据库中。所以我使用下面的代码从数据库中的值中生成我的下拉列表。然后在下面我有将信息插入数据库的功能。但由于某种原因，它不起作用。我想把什么放在`select name=""`正确的地方？

```
<select name="cat[<?=$row['pk_id']?>]">
              <?php $cat = dbConnect("SELECT * FROM category");
                    if(empty($row['cat_id'])){
                    ?>
                    <option value="">Select Category</option>
                    <?php
                    }

              ?>

              <?php while($cat_r = mysql_fetch_array($cat)){ 

              if($row['cat_id'] == $cat_r['cat_id']){
              ?>
              <option value="<?=$cat_r[cat_id]?>" selected="selected"><?=stripslashes($cat_r[cat_name])?></option>
              <?php
              continue;
              }

              ?>
             <option value="<?=$cat_r[cat_id]?>"><?=stripslashes($cat_r[cat_name])?></option>
<?php }  ?>
</select> 
```

这是我对 MySQL 的插入

```
dbConnect("INSERT INTO post_info(add_to_random, show_home, source, display_vote_page, cat_id) values(1,1,1,0,cat[.$row['pk_id'].])"); 
```

我在这里为价值做错了`cat_id`吗？我把 cat[.$row['pk_id'].]) 放在`select name=""`那个下拉列表中。

### 从评论移植的代码：

```
if($_POST and $_POST['action'] == 'submit'){ 
  foreach($_POST as $k=>$v){
    $$k = $v;
  } 
  foreach($cat as $k=>$v){
    if($v =='') continue;
    dbConnect("UPDATE twit_info set cat_id=" . $v . " where pk_id =". $k ); 
  }
  if(count($pkid)>0){
    $pid = implode(',',$pkid); 
    dbConnect("UPDATE twit_info set add_to_vote = 1, display_vote_page = 1 where pk_id in(". $pid .")"); 
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:15:34.117

因此，在您的`foreach`循环中，您将通过 variable 变量将所有 post 键提取到全局变量中`$$k`（我将在一秒钟内了解这一点）。在您的`dbConnect()`电话中，报价不正确。你应该在`$cat`.

```
dbConnect("
  INSERT INTO post_info
    (add_to_random, show_home, source, display_vote_page, cat_id) 
    values(1,1,1,0, '" . mysql_real_escape_string($cat[$row['pk_id']]) . "')" ); 
```

我已经添加了对`mysql_real_escape_string()`. *这至少*是必要的，以保护您的所有查询免受 SQL 注入。此时您的其他`UPDATE`语句也很容易受到攻击，您也*必须*对它们执行一些转义。

关于提取`$_POST`到全局变量中 - 我强烈建议不要这样做。您实际上是在模仿[`register_globals`](http://php.net/manual/en/security.globals.php)被认为非常危险的行为。危险在于，除了您实际希望收到的密钥之外，任何人都可能将*任何*`$_POST`密钥发布到您的表单中，这可能会将脚本中的另一个变量初始化为您的脚本不期望它发送的值。

虽然我真的只是建议`$_POST`直接操作，而不是提取到全局变量，如果你必须将它们提取到全局变量，我建议你使用可接受`$_POST`键的白名单：

```
// Make an array of allowed keys
$good_keys = ('action', 'cat', 'otherformkey');
foreach($cat as $k=>$v){
  // Only extract if it is one of the allowed keys
  if($v =='' || !in_array($k, $good_keys) continue;

  // Cast to an integer
  $v = intval($v);
  $k = intval($k);
  // Non-integer strings will cast to zero, so don't do the db action.
  if ($v > 0 && $k > 0) {
    dbConnect("UPDATE twit_info set cat_id=" . $v . " where pk_id =". $k ); 
  }
  // For string values which are quoted in the SQL (unlike the int values above)
  // escape them with mysql_real_escape_string()
  // $v = mysql_real_escape_string($v)
} 
```

# ruby-on-rails - rails表单中的参数未保存在数据库中

> ID：13113317
> 
> 赞同：1
> 
> 时间：2012-10-28T21:44:44.013
> 
> 标签：ruby-on-rails, database, forms

正如我的日志文件所示，当您在我的应用程序中提交表单时，参数正在正确建立，但它们没有保存在我的数据库中。这只发生在与下拉表单一起使用的两个参数上。

这是我的记录器：

```
Processing by UsersController#create as HTML
Parameters: {"utf8"=>"✓", "authenticity_token"=>"tIdsWBUB+ik8eeOOxUEQs9mSB/WiSyX2Gkw3/fAw64w=", "user"=>   {"name"=>"Jeffgo", "email"=>"JeffreyEricKatz6@gmail.com", "cell_number"=>"5554595515", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]", "day_open"=>"0", "time_open"=>"14"}, "commit"=>"Create my account"}

RecordedLesson Load (0.1ms)  SELECT "recorded_lessons".* FROM "recorded_lessons" LIMIT 1
(0.1ms)  SELECT 1 FROM "users" WHERE LOWER("users"."email") = LOWER('JeffreyEricKatz6@gmail.com') LIMIT 1

Binary data inserted for `string` type on column `password_digest`
SQL (51.2ms)  INSERT INTO "users" ("cell_number", "created_at", "day_open", "email",    "last_class", "name", "password_digest", "recorded_lesson_id", "test", "time_available", "time_open", "type", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [["cell_number", "2154997415"], ["created_at", Sun, 28 Oct 2012 16:45:50 EDT -04:00], ["day_open", nil], ["email", "jeffreyerickatz6@gmail.com"], ["last_class", 0], ["name", "Jeffgo"], ["password_digest", "$2a$10$Idl8H7tMvotqhwiFteya2eSUaNEdAPNU6dqrp5PPalEyfo7w6x5gq"], ["recorded_lesson_id", 1], ["test", nil], ["time_available", nil], ["time_open", nil], ["type", nil], ["updated_at", Sun, 28 Oct 2012 16:45:50 EDT -04:00]]' 
```

好的，现在这里是表单的一部分： <% provide(:title, "Sign up") %>

# 注册

```
<div class="row">
<div class="span6 offset3">
<%= simple_form_for @user do |f| %>
<%= render 'shared/user_error_messages' %>

<%= f.label :name %>
<%= f.text_field :name %>

<%= f.label :email %>
<%= f.text_field :email %>

<%= f.label :cell_number %>
<%= f.text_field :cell_number, :hint => '5555555555' %>

<%= f.label :password %><br />
<%= f.password_field :password %>

<%= f.label :password_confirmation, "Confirmation" %><br />
<%= f.password_field :password_confirmation %>

<%= f.label :day_open %> <br />
<%= f.select("day_open", {"Sunday" => "0", "Monday" => "1", "Tuesday" => "2", "Wednesday" => "3", "Thursday" => "4", "Friday" => "5", "Saturday" => "6"}) %>

<%= f.label :time_open %> <br />
<%= f.select("time_open", {"7:30 pm" => "14", "8:30 pm" => "15", "9:30 pm" => "16"}) %>
<div class="actions">
 <%= f.submit "Create my account" %>
 </div>

 <% end %>

 </div>
 </div> 
```

我的控制器：

```
class UsersController < ApplicationController
def new
  @title = "Sign up"
  @user = User.new 
end

def create
 @user = User.new(params[:user])
 if @user.save
   flash[:success] = "Welcome to the Sample App!"
   redirect_to @user
  else
    @title = "Sign up"
    render 'new'
  end
 end
end 
```

最后，这是我的模型：

```
class User < ActiveRecord::Base
has_many :tutoring_sessions
belongs_to :recorded_lesson
attr_accessor :day_open, :time_open
attr_accessible :name, :email, :cell_number, :password, :password_confirmation, 
    :day_open, :time_open, :tutoring_sessions_attributes, :recorded_lesson_id
has_secure_password
accepts_nested_attributes_for :tutoring_sessions, :allow_destroy => true

before_save { |user| user.email = email.downcase }

validates :name, length: { maximum: 50 }
VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
validates :email,  format: { with: VALID_EMAIL_REGEX }, 
uniqueness: { case_sensitive: false}
validates :password, presence: true, length: { minimum: 6}, on: :create
validates :password_confirmation, presence: true, on: :create
after_initialize :init

def init
  self.recorded_lesson_id ||= RecordedLesson.first.id
  self.last_class ||= 0
end

def advance
    if self[:recorded_lesson_id] == nil
        self[:recorded_lesson_id] = RecordedLesson.first.id
    else
        self[:recorded_lesson_id] += 1
    end
    #self.save
end

    def nows_weekday 
        @todays_weekday = Time.now.utc.wday
    end

    def number_of_days_from_now
        (selected_day - nows_weekday)
    end

    def is_student?
        self[:type] == 1
     end

   def is_tutor?
       self[:type] == 0
   end

   def set_day_and_time_available
      set_hour = Time.now.utc.change(:hour => selected_time)
      set_day  = set_first_day_of_session(set_hour)
      self[:time_available] ||= set_day.to_datetime
   end

   def set_first_day_of_session(set_hour)
       if selected_day > nows_weekday #(Eg. Today is Tuesday and chooses wednesday)
       first_day_of_session= set_hour.advance(:days => number_of_days_from_now)
       else #(Eg. Today is Tuesday and chooses Monday)
          first_day_of_session= set_hour.advance(:days => (number_of_days_from_now + 7))
       end
   end
 end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:48:43.063

删除行`attr_accessor :day_open, :time_open` It's overriding, existing accessors created by`ActiveRecord`

这与这个问题[相同](https://stackoverflow.com/questions/13110573/rails-attributes-headache)

# php - php - 使用嵌套循环和案例

> ID：13113319
> 
> 赞同：0
> 
> 时间：2012-10-28T21:45:03.467
> 
> 标签：php, loops, nested, switch-statement, case

首先 - 如果我的基本 PHP 技能促使我询问一些可能是基本或微不足道的问题，但我搜索了该站点但没有结果（可能是因为我不知道这种事情的技术术语..），请原谅我

我为每个循环都有一个嵌套，但基于简单的变量`($e)`，我需要使用整个循环（2 个嵌套部分）或只使用一个（内部）。

```
 $a = array(); //some array ...
   $c = array(); //some other array ...
   $e = 'yes' // or 'no'

    if ($a) {
                foreach ($a as $b) {

                    $a_1[] = 'something_quite_long'; //that would  affects $c if used

                        foreach ( $c as $d ) {

                        //do_something_very long...

                        }
                }
            } 
```

所以现在我已经通过使用`switch $e:`and解决了这个问题`case` - 但这比我的代码长度重复更多，因为我所做的是将一个情况作为整个嵌套循环，而另一种情况 - 唯一的内部循环（这是 loooong ..) 我确信在这种情况下可以使用一些忍者技术，而无需简单地将整个代码复制并粘贴到“ `case`”中 - 但我不知道如何。

任何人 ？

注意：我知道我大概可以使用外部函数，但问题是在很长的第二个（内部）循环中 - 有一个或两个小情况，其中口头输出（HTML）会略有变化..

**编辑 I** - 由于评论不明确，这里是代码（循环大大减少 - 实际循环更长） - 尽管与问题无关。该代码与wordpress相关..

```
function o99_get_image_size_links($title='',$single,$recieved_id) {

    /* If not viewing an image attachment page, return. */

    /* Set up an empty array for the links. */
    $links = array();

    /* Get the intermediate image sizes and add the full size to the array. */
    $sizes = get_intermediate_image_sizes();

    $sizes[] = 'full';

    global $post;

    switch ($single) {

    case 'FALSE':

    // this will do to all images attached to a post ..
    $attachments = get_children( array('post_parent' => $post->ID, 'post_status' => 'inherit', 'post_type' => 'attachment','post_mime_type' => $mime, 'order' => 'ASC', 'orderby' => 'menu_order ID', 'posts_per_page'=>$limit) );

    /* Loop through each of the image sizes. */

        if ($attachments) {

            foreach ($attachments as $att) { 

                $links[] = '<br>' . get_the_title($att->ID) .' || '. basename ( get_attached_file( $att->ID ) ).' || '. $att->post_name .' || ' /*. wp_get_attachment_image( $att->ID, 'tooltip' ).' || ' .'<br/>'*/  ; // k99 add

                if ($title) {
                    $links[] = '<br><b>' . $title . '</b></br>';
                    }

                    foreach ( $sizes as $size ) {

                        /* Get the image source, width, height, and whether it's intermediate. */

                        $image = wp_get_attachment_image_src( $att->ID, $size );

                        /* Add the link to the array if there's an image and if $is_intermediate (4th array value) is true or full size. */

                        if ( !empty( $image ) && ( true == $image[3] || 'full' == $size ) )

                            $links[] = "</br><a class='image-size-link_{$image[1]}&times;{$image[2]}' href='{$image[0]}'>{$image[1]} &times; {$image[2]}</a>";
                    }
            }
        }

break;

//case for single image ..

case 'TRUE':

                $links[] = '<br>' . get_the_title($recieved_id) .' || '. basename ( get_attached_file( $recieved_id ) ).' || '. $att->post_name .' || ' /*. wp_get_attachment_image( $att->ID, 'tooltip' ).' || ' .'<br/>'*/  ; // k99 add

                if ($title) {
                    $links[] = '<br><b>' . $title . '</b></br>';
                    }

                    foreach ( $sizes as $size ) {

                        /* Get the image source, width, height, and whether it's intermediate. */

                        $image = wp_get_attachment_image_src( $recieved_id, $size );

                        /* Add the link to the array if there's an image and if $is_intermediate (4th array value) is true or full size. */

                        if ( !empty( $image ) && ( true == $image[3] || 'full' == $size ) )

                            $links[] = "</br><a class='image-size-link_{$image[1]}&times;{$image[2]}' href='{$image[0]}'>{$image[1]} &times; {$image[2]}</a>";
                    }
break;
}
    /* Join the links in a string and return. */

    return join( '<span class="sep"> /</span> ', $links );

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:29:21.120

我的代码有很多问题..但这是为了让您了解如何最小化您的代码

问题

*   使用全局`global $post;`
*   `$mime`并且`$limit`没有声明
*   `basename ( get_attached_file( $recieved_id ) ).' || '. $att->post_name .' || '`在定义的循环之外`foreach ($attachments as $att)`
*   `$recieved_id`var 参数和`$post->ID`通过 post ????
*   ETC

您的脚本无法处理此错误..所以我只会为您提供有关如何改进功能的指南

```
function k99_get_image_size_links($title = '', $single ,  $recieved_id , $mime =null , $limit = null) {
    $links = array();
    $sizes = get_intermediate_image_sizes();
    $sizes[] = 'full';
    $pad = function ($ID) use(&$links,$sizes,$title) {
        $links[] = '<br>' . get_the_title($ID) . ' || ' . basename(get_attached_file($ID)) . ' || ' . $title  . ' || ' ;
        empty($title) OR $links[] = sprintf('<br><b>%s</b></br>',$title);
        foreach ( $sizes as $size ) {
            $image = wp_get_attachment_image_src($ID, $size);
            if (! empty($image) && (true == $image[3] || 'full' == $size))
                $links[] = sprintf('</br><a class="image-size-link_%s&times;%s" href="%s">%1$s &times; %2$s</a>',$image[1],$image[2],$image[0]);
        }
    };

    if ($single === true) {
        $pad($recieved_id);
    } else {
        $attachments = get_children(array('post_parent' => $recieved_id,'post_status' => 'inherit','post_type' => 'attachment',
                                          'post_mime_type' => $mime,'order' => 'ASC','orderby' => 'menu_order ID','posts_per_page' => $limit));
        if ($attachments) {
            foreach ( $attachments as $att ) {
                $pad($att->ID);
            }
        }
    }
    return join('<span class="sep"> /</span> ', $links);
} 
```

***请注意，上面的代码没有经过测试，只是为了向您展示如何`Closure`在代码中使用删除重复项***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T21:51:02.303

一些注意事项：

```
if ($a) {
            foreach ($a as $b) { 
```

由于`$a`是一个数组，并且只有一个数组在 中评估为真，所以`if`您根本不需要`if`。`foreach`将对空数组进行零次迭代，因此`if`是多余的。

```
 $d = 'yes' // or 'no'

   ...
                        foreach ( $c as $d ) {
                                        ^^^ 
```

您正在覆盖`$d`此处的变量。这可能会导致你的问题。让我们清理代码回顾一下：

```
$a = array(); //some array ...
$c = array(); //some other array ...
$e = 'yes' // or 'no'

foreach ($a as $b)
{
    $a_1[] = 'something_quite_long'; //that would  affects $c if used
    foreach ($c as $d)
    {
        // do_something_very long...
    }
} 
```

如果您现在给变量起更好的名称，循环应该会变得更清晰，从而减少出错的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T21:53:40.473

`break;`您可以使用跳出循环并继续下一步的命令跳出 foreach 循环，在您的代码中是外循环的下一次迭代。此外，您在这里的内部循环的每次迭代中都会覆盖 $d`foreach ($c as $d)`

# scala - In scala, compile error goes away when adding irrelevant line after toMap

> ID：13113327
> 
> 赞同：2
> 
> 时间：2012-10-28T21:45:22.360
> 
> 标签：scala

This is cross-posted from the coursera functional programming course because there's a lot less activity on that forum.

I wrote the following code (parts are redacted because it's homework):

```
type Occurrences = List[(Char, Int)]
def subtract(x: Occurrences, y: Occurrences): Occurrences = {
  val mx: Map[Char, Int] = x toMap
  y.foldLeft (redacted) (redacted => simple expression using updated and -)) toList
} 
```

This produces the following compile error:

```
type mismatch; found : Map[Char,Int] required: <:<[(Char, Int), (?, ?)] 
```

However if I add a copy of the third line, without the toList, in between via a val statement, the error goes away:

```
type Occurrences = List[(Char, Int)]
def subtract(x: Occurrences, y: Occurrences): Occurrences = {
  val mx: Map[Char, Int] = x toMap
  val foo: Map[Char, Int] = y.foldLeft (redacted) (redacted => simple expression using updated and -))
  y.foldLeft (redacted) (redacted => simple expression using updated and -)) toList
} 
```

I'm guessing this has something to do with giving some kind of extra hint to the type checker, but does anyone know specifically why this happens?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T23:24:49.520

Below follows a few examples and some explanations on why it happens.

First, a working and a non-working cases:

```
scala> { List('a -> 1, 'b -> 2).toMap
     | println("aaa") }
aaa

scala> { List('a -> 1, 'b -> 2) toMap
     | println("aaa") }
<console>:9: error: type mismatch;
 found   : Unit
 required: <:<[(Symbol, Int),(?, ?)]
              println("aaa") }
                     ^ 
```

This happens because the syntax "obj method arg" is considered to be "obj.method(arg)" and so is "obj method \n arg", this way the argument can be written in the next line. Notice below:

```
scala> { val x = List('a -> 1, 'b -> 2) map 
     | identity
     | 
     | println(x) }
List(('a,1), ('b,2)) 
```

It's the same as `List('a -> 1, 'b -> 2).map(identity)`.

Now for the weird error message `found : Unit, required: <:<[(Symbol, Int),(?, ?)]`. It happens that `toMap` actually takes one argument, here is it's signature:

`def toMap[T, U](implicit ev: <:<[A,(T, U)]): Map[T,U]`,

but it's an implicit argument, so doesn't need to be provided explicitly in this case. But when you use the `obj method \n arg` syntax it fills the method argument. In the above non-working example the argument is `println` which has type `Unit`, hence it is not accepted by the compiler.

One workaround is to have two `\n` to separate the lines:

```
scala> { List('a -> 1, 'b -> 2) toMap
     | 
     | println("aaa") }
aaa 
```

You can also use a `;` to separate the lines.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T23:15:36.167

@RexKerr & @DidierDupont are right, you're having issues because you called `toMap` like a binary operator, so the compiler freaked out.

My two cents: you should probably read the [Suffix Notation section of the Scala Style Guide](http://docs.scala-lang.org/style/method-invocation.html#suffix_notation).

# java - 3 Android Threads，如何构建

> ID：13113340
> 
> 赞同：3
> 
> 时间：2012-10-28T21:47:03.433
> 
> 标签：java, android, multithreading

我正在构建一个 openGL ES 2 游戏，在 Android 上使用 Java。

我目前有两个线程。Android UI 和 openGL。

据我了解，为了获得最佳性能，我需要另外一个线程来处理游戏逻辑，这样openGL线程才能尽可能快地渲染。

这将给我留下 3。Android UI、openGL 和游戏逻辑。（我们称它们为 UI、OGL 和 GL。）

如我错了请纠正我：

UI 启动，生成 OGL 和 GL。OGL 和 GL 运行，查询 UI 以获取输入。GL 将绘制调用发送到 OGL 中的队列。

这里有两种情况。如果 GL 的循环时间比 OGL 长，则 OGL 的下一个循环需要等待 GL 完成才能开始下一个循环，以避免只渲染最后一帧的一半调用。如果 OGL 花费的时间比 GL 长，则 GL 需要等到 OGL 完成才能重新开始/发送更多的绘图调用。

要做到这一点：

当 GL 完成它的循环时，它会检查 OGL 以查看它是否已完成绘制当前的绘制调用队列。如果是这样，它将启动 GL 和 OGL 的下一个循环。如果没有，它会等待。

当 OGL 完成时，它会检查 GL。如果 GL 完成，它会再次启动两个循环。如果没有，它会等待 GL，完成后将检查 OGL，然后重新启动两者。

对不起，如果这有点令人困惑的措辞..

说明我的想法：

[图 http://img840.imageshack.us/img840/2816/stackoverflowthredpictu.jpg](http://img840.imageshack.us/img840/2816/stackoverflowthredpictu.jpg)

为了澄清我的问题：-以这种方式布置事情会奏效吗？——如果没有，什么会更好？

- 我应该查看哪些*特定*主题来完成此任务？--ie 我不知道如何创建线程或在它们之间发送信息。

这是我第一次在这里提问，希望我做的正确。：） 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T23:50:25.257

> - 这样布置会奏效吗？——如果没有，什么会更好？

是的，但是这种策略可能会产生不必要的复杂性。当两个线程必须相互等待时，很容易使它们死锁。

我想你可以使用[`RENDERMODE_WHEN_DIRTY`](http://developer.android.com/reference/android/opengl/GLSurfaceView.html#RENDERMODE_WHEN_DIRTY)：

```
 setRenderMode(RENDERMODE_WHEN_DIRTY); 
```

在该模式下，您的渲染器仅在 (1) 创建表面或 (2) 您调用`requestRender()`. 因此，您的游戏逻辑线程将调用`queueEvent()`（或类似的方法）将绘图调用推送到渲染器，然后`requestRender()`在游戏逻辑循环结束时调用。

如果您仍然发现游戏逻辑线程需要等待渲染器完成，您可以`Semaphore`在游戏逻辑线程中创建一个阻塞它，直到渲染器发出信号（通过调用`release()`）`Semaphore`它已完成渲染帧。

免责声明：我不是游戏开发者，但希望这能给你一些探索的途径。

# clr - 为什么 CLR 和 JVM 使用基于堆栈的架构？

> ID：13113347
> 
> 赞同：6
> 
> 时间：2012-10-28T21:48:11.330
> 
> 标签：clr

我一直很好奇为什么 JVM 和 CLR 有一个基于堆栈的架构？他们为什么不使用基于寄存器的方法？与基于寄存器的方法相比，它有什么好处？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-06-19T04:44:21.557

我曾经思考寄存器和堆栈机器之间的差异并比较指令序列，并运行基准测试......

然后我花了几年时间在 Parrot VM 上工作，同时实现了这两种类型的机器，它是一台注册机器。我们天真地从一个固定的寄存器集开始，结合数据和寄存器堆栈，但最终得出结论，这是人为的限制，所以我们改为无限寄存器集和分配器。在某些时候，Parrot 快速核心（GCC 计算 goto）优于 Mono 和 JVM 解释器核心（非 JIT），但差异归结于 JIT。Parrot 的 JIT 从未与其他人的质量相提并论。JITter 的质量造就了最终的机器，而这通常是人们关心的。如果所有虚拟机都按照相同的规则运行（即它们有一个限制，可以在没有 JIT 的解释模式下运行），然后我的证据表明寄存器机器在等效堆栈机器上具有性能优势。更大的指令，但更少的指令 == 更高的吞吐量 (IPC)，以及更好的缓存引用局部性。Dalvik JVM 实际上支持了我的发现，Dalvik 有几年没有 JIT，并与它的解释器核心竞争。

很少有主流虚拟机专门以解释模式运行（AFAIK），它们是 JIT 编译的，这就是我们的基准测试。解释器核心的重点是在平台上建立存在，进行字节码验证，并在没有 JIT 的情况下提供故障安全执行核心。当然，这不是规则。有数十亿台设备在没有 JIT 的情况下运行 ARM 加速 JVM，但在没有内存或 CPU 限制的情况下，这适用。

我不断地调整核心、测试和调优，最终发现我们真的想要一个快速的 JIT。我得出的结论是，如果您最终要使用 JIT，那么无论您是实现堆栈还是注册机器来启动，做自己喜欢的事情都无关紧要；但是使用堆栈机器可以更快地“推向市场”。通过虚拟机内核对字节码解释进行大量伪寄存器机虚拟优化部分是浪费努力，因为它不是真正的本机优化。软核不像真正的处理器那样进行分支预测、寄存器重命名、指令重新排序、并行执行或预取。我的感觉是，一旦我们对本地二进制文件进行了高质量的 JIT，我们就会到达同一个目的地。

出于这些原因，我在技术上支持基于堆栈的机器：

1.  简单 - 更少的代码需要维护 = 更少的错误
2.  实施时间

但在视觉上和情感上，我更喜欢注册机：

1.  视觉概念模型更接近机器和我的大脑
2.  灵活性——编译器可以使用 SSA 以不同的顺序评估他们的表达式树。

请注意，我并没有说编译器可以更“轻松”地生成代码。这似乎是主要使用堆栈机器的人喜欢争论的问题。我不相信，也没有发现这是真的。我在 Parrot 和 CLR 上看到了很多爱好编译器，虽然我承认 CLR 上的编译器质量更高，但这主要是生态系统和可用工具的质量之一。我自己在这两个平台上编写了编译器，发现有一些权衡，但还不足以让我失眠。

这是一个有根据的猜测，因为我的实际经验不包括编写完整的 JITter，所以我没有第一手经验来比较 JITting 各种形式的操作码的优缺点，但我的意见是，如果你打算包括一个 JIT，然后创建一个极其复杂的虚拟机操作码核心相当于过早优化。你的时间最好花在别处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T22:50:29.220

通常只链接到一篇文章是不合适的，但这次我会例外：[Eric Lippert 的这篇文章](http://blogs.msdn.com/b/ericlippert/archive/2011/11/28/why-have-a-stack.aspx)回答了这个问题。

# jquery - 复选框在控制失去焦点之前不会启用/禁用

> ID：13113349
> 
> 赞同：0
> 
> 时间：2012-10-28T21:48:18.750
> 
> 标签：jquery, asp.net, firefox

我正在处理一个 ASP.net 页面，该页面显示一个数据网格，每行都有一个复选框和一个下拉列表。要继续下一步，每一行必须选择一个检查或一个选项，但不能同时选择两者。

如果选中该复选框，我将尝试禁用下拉列表，如果选择了“选择原因”以外的任何选项，则禁用该复选框。我正在尝试使用 jquery 1.4 做所有客户端的事情（我知道它很旧，但这是 UI 主导的决定）。

**我的代码在 Chrome 和 IE8 中运行良好，但是当我使用 Firefox 16 时，复选框不会在选择更改时禁用，直到用户在网格外单击。然后该框禁用。我想摆脱额外的点击。**

这是网格标记：

```
<asp:GridView ID="gvApps" runat="server" CssClass="sGrid"
            HorizontalAlign="Center" AutoGenerateColumns="False" 
            EmptyDataText="No Data" PageSize="3" 
            ShowHeaderWhenEmpty="True" >
    <Columns>
        <asp:TemplateField HeaderText="Select">
        <itemtemplate> 
            <asp:checkbox id = "gvCheckbox" runat="server"  onclick="RowCheckChanged(this)" />
            </itemtemplate>
        </asp:TemplateField>
        <asp:BoundField datafield="FiscalYear" HeaderText="Year"    />
        <asp:TemplateField HeaderText="Reason">
            <itemtemplate>
            <asp:DropDownList id = "ddlReason"  Viewstate="true" DataSource="<%# ReasonsList %>"  runat="server" />
            </itemtemplate>
        </asp:TemplateField>
    </Columns>
    <emptydatatemplate>
        <p class="norecords">There are currently no Records </p>
    </emptydatatemplate> 
</asp:GridView> 
```

这是我的 OnReady：

```
 <script type="text/javascript">
    $(function () {
        $("select").change(function () {
            $(IndexChanged(this));
        });
    })
</script> 
```

下面是 IndexChanged 和 RowCheckChanged 函数：

```
<script type="text/javascript">
function RowCheckChanged(objRef) {
    var row = objRef.parentNode.parentNode;
    if (objRef.checked) {
        $(row).find("select").attr("selectedIndex", 0);
        $(row).find("select")[0].disabled = true;
    }
    else {
        $(row).find("select")[0].disabled = false;
    }
}

function IndexChanged(objRef) {
    //toggle  chkb enabled-ness
    var row = objRef.parentNode.parentNode;

    if ($(row).find("select option:selected").text() == "Select a Reason") {
        //both objects should be enabled
        $(row).find(":checkbox").attr("disabled", false);
     } else {
        //a selection has been made, disable checkbox.
        $(row).find(":checkbox").attr("disabled", true);
    }
}
</script> 
```

有任何想法吗？

编辑：这是网格客户端生成的标记（每个萤火虫）：

```
<select id="MainContent_wiz_IntraAppYears1_gvApps_ddlReason_0" viewstate="true" name="ctl00$MainContent$wiz$IntraAppYears1$gvApps$ctl02$ddlReason" disabled="">
    <option value="Select a Reason" selected="selected">Select a Reason</option>
    <option value="Tax Exempt">Tax Exempt</option>
    <option value="Out of Business">Out of Business</option>
    <option value="Worked under Another Authority">Worked under Another Authority</option>
    </select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:32:28.383

尝试使用

```
 $(row).find(":checkbox").attr("disabled", "disabled"); 
```

和

```
$(row).find(":checkbox").removeAttr("disabled"); 
```

语法与较新版本的 jQuery 中可用的方法不完全相同，`prop()`并且在旧版本的 FF、IE 6-8 等中对我有用

**使用 jQuery 1.4 的演示：http:** [//jsbin.com/otuyez/1/edit](http://jsbin.com/otuyez/1/edit)

也不需要包含以下内容，`$()`因为它严格来说是一个函数调用

```
$(IndexChanged(this)); 
```

可以简单地调用该函数作为`select`更改处理程序：

```
 $(function () {
    $("select").change(IndexChanged);
}) 
```

其他一些可能有帮助的调整

```
$(row).find("select").attr("selectedIndex", 0); 
```

可以写成

```
$(row).find("select").val('') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T16:02:36.940

一位朋友向我指出了 FF 和 IE 的 .click 事件，它似乎工作得很好。在事件触发之前，我不再需要下拉列表失去焦点。似乎chrome不喜欢.click，所以我必须有条件地链接事件。

这是我的新 OnReady：

```
if ($.browser.webkit) {
        $("select").change(function () {
            $(IndexChanged(this));
        });
    } else {
        $("select").click(function () {
            $(IndexChanged(this));
        });
    } 
```

感谢 charlietfl 的帮助和建议！

# javascript - 如何将变量传递给 lambda 函数？动态 Lambda 函数

> ID：13113353
> 
> 赞同：1
> 
> 时间：2012-10-28T21:48:56.413
> 
> 标签：javascript, javascript-objects, lambda, oop

在最后一行中，如何确保我所指的“this”是实例化的 k8rModal 对象而不是运行该函数的对象？

对于未来的其他项目，我还需要动态构造 lambda 函数。如果没有全局变量，这可能吗？

```
function k8rModal(DOMnamespace){
    var _ = this._ = DOMnamespace+"_"; // for DOM namespacing

    this.tightWrap=1;

    $('body').prepend('<div id="'+_+'stage"></div>');
    this.stage = stage = $('#'+_+'stage');
    stage.css({
        'display':'none',
        'width':'100%',
        'height':'100%',
        'color':'#333'
    });

    $('body').append('<div id="'+_+'slate"></div>');
    this.slate = slate = $('#'+_+'slate');
    slate.css({
        'display':'none',
        'width':'640px',
        'height':'480px',
        'color':'#eee'
    });

    $('body').delegate('.'+_+'caller','click',function(){
        /* this... but not, this? */.appear();
    });
}

k8rModal.prototype.appear = function(){
    //make the modal box appear
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:00:46.083

虽然您可以使用变量引用来引用 @ianpgall 建议的正确对象，但另一种可能性是为此目的使用 jQuery 的事件数据。

```
$('body').delegate('.'+_+'caller','click', {k8r: this}, function(event){
    event.data.k8r.appear();
}); 
```

* * *

或者，如果您使用的是 jQuery 1.7 或更高版本，您可能应该使用`.on()`instead.j

```
$('body').on('click', '.'+_+'caller', {k8r: this}, function(event){
    event.data.k8r.appear();
}); 
```

* * *

*   [jQuery 的文档`event.data`](http://api.jquery.com/event.data/)
*   [jQuery 的文档`.on()`](http://api.jquery.com/on/)

# f# - Array.map2 对记录的类型推断

> ID：13113355
> 
> 赞同：1
> 
> 时间：2012-10-28T21:49:27.877
> 
> 标签：f#

我遇到了一些我不明白的 Array.map2。

考虑这段代码：

```
type r1 = {
    v1 : int
    X : int
}

type r2 = {
    v1 : int 
    Y : int
}

let a1 = [|{v1=1;   X=1};   {v1=2;   X=2}|]   // val a1 : r1 [] ...
let a2 = [|{v1=100; Y=100}; {v1=200; Y=200}|] // val a2 : r2 [] ...

Array.map2 (fun x1 x2 -> (x1.X, x2.Y)) a1 a2   // works as expected
Array.map2 (fun x1 x2 -> (x1.v1, x2.v1)) a1 a2  // error FS0001: Type mismatch. Expecting a r2 [] but given a r1 [] 
```

两条记录都有一个字段`v1`。在最后一行中，我尝试`v1`从不同的记录类型`r1`和中获取 的值的元组`r2`。当我尝试在不同记录上选择具有相同名称的字段时，似乎会引发错误。

不知何故，它得出了`x1`必须是 type的结论`r2`，为什么第二行不从两个参数`a1`和推断类型`a2`？

*编辑*

这修复了它，但我希望从参数中获得正确的类型。

```
Array.map2 (fun (x1:r1) x2 -> (x1.v1, x2.v1)) a1 a2  // works 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:09:44.557

类型检查器从左到右工作，因此在第二个示例中没有足够的信息来解决冲突。您的第一个示例很好，因为`.X`和分别是和`.Y`上的唯一字段。`r1``r2`

也就是说，在这种情况下，您可以在访问记录字段之前使用管道为类型检查器提供类型`a1`和可用的类型：`a2`

```
(a1, a2) ||> Array.map2 (fun x1 x2 -> (x1.v1, x2.v1)) 
```

通常，您应该使用包含唯一字段的[记录模式](http://msdn.microsoft.com/en-us/library/dd547125.aspx)来识别正确的类型：

```
Array.map2 (fun {v1 = a; X = _} {v1 = b; Y = _} -> (a, b)) a1 a2 
```

或提供完全限定的字段名称：

```
Array.map2 (fun {r1.v1 = a} {r2.v1 = b} -> (a, b)) a1 a2 
```

# ios - 离线 UIWebView 查看旧图

> ID：13113357
> 
> 赞同：2
> 
> 时间：2012-10-28T21:49:59.147
> 
> 标签：ios, objective-c, image, caching, uiwebview

我创建了一个`UIWebView`在 iOS 应用程序中离线运行的程序。我正在使用某个 javascript 库来显示虚拟游览，这就是我需要使用`UIWebView`.

我现在在运行应用程序时遇到了一个问题：大部分时间它都在显示旧图像，即使它们不在资源中或已更新。我已经尝试了很多方法来解决这个问题，包括设置缓存策略：

```
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"splash2" ofType:@"html"]isDirectory:NO];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
[request setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData];
[self.webView loadRequest:request]; 
```

在我的最上面，我`viewDidLoad`尝试设置缓存容量：

```
NSURLCache *sharedCache = [[NSURLCache alloc] initWithMemoryCapacity:0 diskCapacity:0 diskPath:nil];
    [NSURLCache setSharedURLCache:sharedCache]; 
```

这在我的应用程序 didFinishLaunchingWithOptions 上：

```
[[NSURLCache sharedURLCache] removeAllCachedResponses]; 
```

目前我在我的`viewDidLoad`

```
NSURLCache *sharedCache = [[NSURLCache alloc] initWithMemoryCapacity:0 diskCapacity:0 diskPath:nil];
    [NSURLCache setSharedURLCache:sharedCache];

    NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"splash2" ofType:@"html"]isDirectory:NO];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
    [request setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData];
    [self.webView loadRequest:request];

    webView.frame = CGRectMake(0, 0, 1024, 768);

    webView.scalesPageToFit = NO;

    webView.multipleTouchEnabled = YES;

    for (id subview in webView.subviews)
        if ([[subview class] isSubclassOfClass: [UIScrollView class]])
            ((UIScrollView *)subview).bounces = NO;

    [super viewDidLoad]; 
```

我也试过我的`viewDidLoad`：

```
NSURLRequest *request = [[NSURLRequest alloc] initWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"splash2" ofType:@"html"]isDirectory:NO]];

    webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 1024, 768)];

    NSURLCache *sharedCache = [[NSURLCache alloc] initWithMemoryCapacity:0 diskCapacity:0 diskPath:nil];
    [NSURLCache setSharedURLCache:sharedCache];

    [webView loadRequest:request];
    [self.view addSubview:webView];

    webView.scalesPageToFit = NO;

    webView.multipleTouchEnabled = YES;

    for (id subview in webView.subviews)
        if ([[subview class] isSubclassOfClass: [UIScrollView class]])
            ((UIScrollView *)subview).bounces = NO;

    [super viewDidLoad]; 
```

另外我不确定它是否与 html5 清单有关。总而言之，我只需要它来关闭缓存并始终读取我的资源中当前存在的内容。

# c++ - C++ For 循环、多维数组和指针练习

> ID：13113358
> 
> 赞同：1
> 
> 时间：2012-10-28T21:50:00.293
> 
> 标签：c++, pointers, multidimensional-array

我的主要问题是：

有没有更好（或更有效）的方法来使用指针声明多维数组？我所做的事情是否在正确的轨道上？

编程练习：

你卖*C++ for Fools*书。使用二维数组存储 3 年月销售额的输入（以书籍数量而非金钱数量计算）。报告合并年份的总销售额。该程序应该使用一个循环来按月份提示您，使用字符串对象数组，初始化为月份字符串并将输入数据存储在二维数组中。然后，程序应该找到数组内容的总和并报告 3 年的总销售额。

这是我的代码的**片段**：

```
/* Global constants */
const unsigned int YRS = 3;
const unsigned int MNTHS = 12;

/* Create 2D-Array */
int** bookSalesArrayPtr = new int*[YRS];    // Pointer-to-Array-of-Pointers
for (unsigned int i = 0; i < YRS; ++i)      // Each element of bookSalesArrayPtr
    bookSalesArrayPtr[i] = new int[MNTHS];  // In each element create new array[12] 
```

这是我完整源代码的链接：http: [//ideone.com/LcQeuj](http://ideone.com/LcQeuj)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-28T22:22:57.460

任何解决方案都应该*尽可能简单*。如果不需要指针，请避免使用指针，因为它们会使程序复杂化：

```
int  bookSales[YRS][MNTHS]; 
```

请注意阅读这篇文章是多么容易。注意没有代码来管理分配、销毁或任何其他簿记。

即使这样的结构增加了执行时间（这在这里是极不可能的），考虑一下这节省了多少人力时间（开发人员、维护人员、调试人员、文档）。电脑时间很便宜。人的时间是宝贵的。

在对解决方案进行评级时，通常会忽略人力成本。

# objective-c - 排序数组未正确显示值

> ID：13113362
> 
> 赞同：0
> 
> 时间：2012-10-28T21:50:22.167
> 
> 标签：objective-c, ios, xcode, arrays

我有一个数组，其中包含当前用户位置和一些注释引脚之间的距离。尽管第一个日志正确显示了值，但当我将它们添加到数组中时，所有值都是“0”。我究竟做错了什么？我已经提到了苹果文档。我没有任何错误。先感谢您..

```
 for (Posts *post in allPosts) {
    CLLocation *postLocation = [[CLLocation alloc] initWithLatitude:post.coordinate.latitude longitude:post.coordinate.longitude];

    CLLocation *userLoc = [[CLLocation alloc] initWithLatitude:appDelegate.currentLocation.coordinate.latitude longitude:appDelegate.currentLocation.coordinate.longitude];

    CLLocationDistance dist = [userLoc distanceFromLocation:postLocation];
    distance = [NSString stringWithFormat:@"%.2f", dist];

    NSMutableArray *array = [[NSMutableArray alloc] initWithObjects:post, nil];

    NSSortDescriptor *sort = [NSSortDescriptor sortDescriptorWithKey:distance ascending:YES];
    NSLog(@"%@", sort);
    NSArray *sor = @[sort];
    NSArray *sorted = [array sortedArrayUsingDescriptors:sor];

    float flo = [[NSString stringWithFormat:@"%@",sorted]floatValue];
    NSLog(@"%.f",flo); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:11:38.653

```
float flo = [[NSString stringWithFormat:@"%@",sorted]floatValue];
NSLog(@"%.f",flo); 
```

您正在尝试将数组放入字符串中，然后使用它的浮点值。您可能想要取而代之的是数组的一个元素。

# android - 谷歌云端硬盘 SDK 和 API

> ID：13113364
> 
> 赞同：3
> 
> 时间：2012-10-28T21:50:32.840
> 
> 标签：android, google-api, google-drive-api, google-play-services

我有一个使用新的 Google Play 服务的 Android 应用程序。我能够成功地对用户进行身份验证并取回令牌。现在我有了一个令牌，我在服务器上有一个脚本，它使用这个令牌来执行一些操作。当我尝试进行简单的 REST API 调用时，例如：GET [https://www.googleapis.com/drive/v2/about](https://www.googleapis.com/drive/v2/about)

我收到错误“未配置访问”。我检查了我的 API 控制台，并启用了 Drive API 和 Drive SDK。

这不可能吗？还是我以错误的方式解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T09:42:10.093

您可能缺少范围。这里是全套

```
"https://www.googleapis.com/auth/drive.file",
"https://www.googleapis.com/auth/drive",
"https://www.googleapis.com/auth/userinfo.email",
"https://www.googleapis.com/auth/userinfo.profile",
"https://docs.googleusercontent.com/",
"https://docs.google.com/feeds/", 
```

也许从让您的应用程序运行开始，然后删除您实际不使用的应用程序。

# c# - 为什么 Imgur API 比网站慢

> ID：13113373
> 
> 赞同：0
> 
> 时间：2012-10-28T21:52:02.240
> 
> 标签：c#, webclient, imgur

```
public sealed class ImgurUpload
{
    public event EventHandler<UploadCompleteEventArgs> UploadComplete;

    public void PostToImgur(string location, string key, string name = "", string caption = "")
    {
        try
        {
            using (var webClient = new WebClient())
            {
                NameValueCollection values = new NameValueCollection
                {
                    { "image", ConvertToBase64(location) },
                    { "key", key },
                    { "name", name },
                    { "caption", caption}
                };
                webClient.UploadValuesAsync(new Uri("http://api.imgur.com/2/upload.xml"), "POST", values);
                webClient.UploadValuesCompleted += ((sender, eventArgs) =>
                {
                    byte[] response = eventArgs.Result;
                    XDocument result = XDocument.Load(XmlReader.Create(new MemoryStream(response)));
                    if (UploadComplete != null)
                        UploadComplete(this, new UploadCompleteEventArgs(result));
                });
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);  
        }
    }

    private string ConvertToBase64(string imageLocation)
    {
        byte[] imageData = null;
        using (FileStream fileStream = File.OpenRead(imageLocation))
        {
            imageData = new byte[fileStream.Length];
            fileStream.Read(imageData, 0, imageData.Length);
        }
        return Convert.ToBase64String(imageData);
    }
}

public class UploadCompleteEventArgs : EventArgs
{
    public string Original { get; private set; }
    public string ImgurPage { get; private set; }
    public string DeletePage { get; private set; }

    public UploadCompleteEventArgs(XDocument xmlDoc)
    {
        var objLinks = from links in xmlDoc.Descendants("links")
                       select new
                       {
                           original = links.Element("original").Value,
                           imgurPage = links.Element("imgur_page").Value,
                           deletePage = links.Element("delete_page").Value
                       };

        Original = objLinks.FirstOrDefault().original;
        ImgurPage = objLinks.FirstOrDefault().imgurPage;
        DeletePage = objLinks.FirstOrDefault().deletePage;
    }
} 
```

[上面是我编写的一个类，用于使用匿名 API](http://api.imgur.com/#anonapi)将图像上传到 imgur 。我过去使用过 API，并且一直发现它比网站上传器慢得多，并且比其他使用 Web 请求有效地将数据直接发送到网站而不是使用 API 的 .NET 应用程序慢。

我在上面发布了完整的课程，因为这可能是我正在做（或不做）的事情导致了这个问题。如果有人能为我找出问题所在，我将不胜感激。

我今天早些时候做了一些公平的测试，例如，一个结果如下：

*   800kb 图片来自 imgur**网站**= 35 秒
*   800kb 图片通过使用**我的课程**= 1 分 20 秒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T06:16:49.930

您上传的那个要大约 35%，因为您将它作为 STRING 上传。

通过字节上传，它应该一样快。

# objective-c - Objective-C：覆盖超类 getter 并尝试访问 ivar 时出现编译器错误

> ID：13113374
> 
> 赞同：15
> 
> 时间：2012-10-28T21:52:02.267
> 
> 标签：objective-c, ios, properties, instance-variables

我正在构建一个 iOS 6 应用程序。

我有一个 TDBeam 类**，**它继承自超类**TDWeapon**。

超类**TDWeapon**在 TDWeapon.h 文件中声明了一个 @property：

```
@interface TDWeapon : UIView

@property (nonatomic) int damage;

@end 
```

我没有明确地@synthesize 属性，因为我让 Xcode 自动这样做。

在子类**TDBeam**中，我覆盖了 TDBeam.m 文件中的 getter：

```
#import "TDBeam.h"

@implementation TDBeam

- (int)damage {
    return _damage;
}

@end 
```

Xcode 自动完成 getter 方法名称，正如预期的那样。但是当我尝试引用 _damage 实例变量（从超类继承）时，我得到一个编译器错误：

```
Use of undeclared identifier '_damage' 
```

我在这里做错了什么？我尝试显式添加@synthesize，并更改_damage ivar 的名称，但编译器没有“看到”它或超类中的任何其他ivar。我认为 ivars 可以从子类中看到和访问？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-28T22:02:25.770

合成的 ivars 对子类*不*可见，无论它们是显式创建的还是自动创建的：[@synthesized 实例变量的可见性是什么？](https://stackoverflow.com/questions/8510464/what-is-the-visibility-of-synthesized-instance-variables/l)由于它们是在实现文件中有效声明的，因此它们的声明不包含在包含子类的“翻译单元”中。

如果您真的想直接访问该 ivar，则必须在子类可以看到它的某个地方显式声明它（以其默认的“受保护”形式），例如私有标头中超类的类扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T09:44:09.730

Stack Overflow 上有很多关于这个主题的帖子，没有一个提供简单的具体建议，但这个主题总结得最简洁，而 Josh 的回答是最好的。

他有点直截了当地说，如果这是你想做的事情，根本不要使用@property。正如他所说，在您的基类中声明您的常规受保护变量，并在需要时编写您自己的 setter 和 getter。任何可以编写自己的 setter/getter 的子类都可以看到 ivar。

至少那是我遇到的问题，尽管我对子类化完全是新手。

创建私有标头来托管您的匿名类别并在您的子类中重新@sythesizing 您的 ivars 的想法在很多层面上似乎都是错误的。我也确定我可能在某个地方错过了一些基本点。

* * *

编辑

好吧，在失眠之后，受到[斯坦福 2013 年 iTunes U 课程的](https://itunes.apple.com/au/course/coding-together-developing/id593208016)启发，我相信这里有一个解决这个问题的示例。

> MYFoo.h

```
#import <Foundation/Foundation.h>

@interface MYFoo : NSObject
// Optional, depending on your class
@property (strong, nonatomic, readonly) NSString * myProperty;
- (NSString *)makeValueForNewMyProperty; //override this in your subclass
@end 
```

> MYFoo.m

```
#import "MYFoo.h"

@interface MYFoo ()
   @property (strong, nonatomic, readwrite) NSString * myProperty;
@end

@implementation MYFoo
// Base class getter, generic
- (NSDateComponents *)myProperty {
    if (!_myProperty) {
        _myProperty = [self makeValueForNewMyProperty];
    }
    return _myProperty;
}

// Replace this method in your subclass with your logic on how to create a new myProperty
- (NSString *)makeValueForNewMyProperty {
    // If this is an abstract base class, we'd return nil and/or throw an exception
    NSString * newMyProperty = [[NSString alloc]init];
    // Do stuff to make the property the way you need it...
    return newMyProperty;
}

@end 
```

然后，您只需将子类中的 makeValueForNewMyProperty 替换为您需要的任何自定义逻辑。您的属性在基类中受到“保护”，但您可以控制它的创建方式，这基本上是您在大多数情况下想要实现的目标。

如果您的 makeValueForNewMyProperty 方法需要访问基类的其他 ivars，那么它们至少必须是公共只读属性（或只是裸 ivars）。

不完全是“超越吸气剂”，但它实现了同样的事情，稍加思考。如果在尝试使示例通用的过程中丢失了一些优雅和清晰，我深表歉意。

# html - PNG图像的奇怪pagespeed URL？

> ID：13113383
> 
> 赞同：5
> 
> 时间：2012-10-28T21:52:33.757
> 
> 标签：html, css, image, image-processing, pagespeed

我使用文件名 logo.png 将具有 alpha 透明度的 PNG 图像上传到我的服务器，但是，当在页面上使用该图像并且我去查看它的文件路径时，我得到：

```
http://example.com/i/300x300xlogo.png.pagespeed.ic.0A66xVq4G9.png 
```

该文件在服务器上无处可见。

我不知道它是否会影响它，但实际图像尺寸是 400px x 400px，我在 HTML 中显示为 300px x 300px。（不要问。）

会不会是我的网络主机这样做？似乎在文件前面加上要显示的分辨率：`300x300x`并且还有那个奇怪的后缀：`.pagespeed.ic.0A66xVq4G9.png`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T23:08:37.017

您看到的 URL 符合预期：mod_pagespeed 将图像 URL 重写为优化的名称并将大小以及内容的指纹嵌入到文件名中。

如果您将 HTML 中的图像从原始尺寸缩小.. 您正在浪费用户的带宽，这在移动设备上尤其痛苦。mod_pagespeed 的优势在于它可以即时为您调整大小 - 只需在 HTML 中指定所需的尺寸，它就会做正确的事情。

您可以在此处阅读有关 mod_pagespeed 完成的各种图像优化的更多信息： [https ://developers.google.com/speed/docs/mod_pagespeed/filter-image-optimize](https://developers.google.com/speed/docs/mod_pagespeed/filter-image-optimize)

您所描述的“加载速度较慢”听起来像“图像延迟加载”： [https ://developers.google.com/speed/docs/mod_pagespeed/filter-lazyload-images](https://developers.google.com/speed/docs/mod_pagespeed/filter-lazyload-images)

图像会延迟到 onload 触发，这有助于更快地将页面绘制到屏幕上。您还可以配置 mod_pagespeed 以在滚动时执行此操作，以便仅加载可见图像。最后，您还可以禁用此特定过滤器，但保持上述图像优化。

PS mod_pagespeed 不再是测试版，团队最近发布了 1.0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T21:58:49.413

解决了！默认情况下，在 webhosts 控制面板中启用了[Google Pagespeed 。](https://developers.google.com/speed/pagespeed/)希望这对其他人有帮助。

我注意到图像实际上会加载较慢，一旦文档完成加载，它们就会闪烁。（虽然 Google Pagespeed 是测试版。）

# linux - 问号“？”是什么意思？在 Linux 内核恐慌调用跟踪？

> ID：13113384
> 
> 赞同：30
> 
> 时间：2012-10-28T21:53:12.007
> 
> 标签：linux, linux-kernel, kernel, backtrace, panic

呼叫跟踪包含这样的条目：

```
 [<deadbeef>] FunctionName+0xAB/0xCD [module_name]
 [<f00fface>] ? AnotherFunctionName+0x12/0x40 [module_name]
 [<deaffeed>] ClearFunctionName+0x88/0x88 [module_name] 
```

“？”是什么意思？在 AnotherFunctionName 之前标记？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-29T07:18:33.353

“？” 意味着有关此堆栈条目的信息可能不可靠。

堆栈输出机制（参见[dump_trace() 函数](http://lxr.free-electrons.com/ident?i=dump_trace)的实现）无法证明它找到的地址是调用堆栈中的有效返回地址。

“？” 本身由[printk_stack_address()](http://lxr.free-electrons.com/ident?i=printk_stack_address)输出。

堆栈条目可能有效或无效。有时可能会简单地跳过它。调查相关模块的反汇编以查看在`ClearFunctionName+0x88`（或者，在 x86 上，紧接在该位置之前）调用了哪个函数可能会有所帮助。

**关于可靠性**

在 x86 上，当调用 dump_stack() 时，实际检查堆栈的函数是 print_context_stack [()](http://lxr.free-electrons.com/ident?i=print_context_stack)中定义的`arch/x86/kernel/dumpstack.c`。看一下它的代码，我将在下面尝试解释它。

我假设 DWARF2 堆栈展开工具在您的 Linux 系统中不可用（如果不是 OpenSUSE 或 SLES，它们很可能不可用）。在这种情况下，`print_context_stack()`似乎执行以下操作。

它从一个地址（代码中的“堆栈”变量）开始，该地址保证是堆栈位置的地址。它实际上是一个局部变量的地址`dump_stack()`。

该函数重复增加该地址 ( `while (valid_stack_ptr ...) { ... stack++}`) 并检查它指向的内容是否也可能是内核代码 ( `if (__kernel_text_address(addr)) ...`) 中的地址。这样，当调用这些函数时，它会尝试查找压入堆栈的函数的返回地址。

当然，并不是每个看起来像返回地址的 unsigned long 值实际上都是返回地址。所以该函数试图检查它。如果内核代码中使用了帧指针（如果设置了 CONFIG_FRAME_POINTER，则使用 %ebp/%rbp 寄存器），它们可用于遍历函数的堆栈帧。函数的返回地址位于帧指针的正上方（即 at `%ebp/%rbp + sizeof(unsigned long)`）。print_context_stack 正是检查这一点。

If there is a stack frame for which the value 'stack' points to is the return address, the value is considered a reliable stack entry. `ops->address` will be called for it with `reliable == 1`, it will eventually call `printk_stack_address()` and the value will be output as a reliable call stack entry. Otherwise the address will be considered unreliable. It will be output anyway but with '?' prepended.

[NB] If frame pointer information is not available (e.g. like it was in Debian 6 by default), all call stack entries will be marked as unreliable for this reason.

The systems with DWARF2 unwinding support (and with CONFIG_STACK_UNWIND set) is a whole another story.

# jquery - .hide() 有效，但随后显示以前的动画？

> ID：13113388
> 
> 赞同：2
> 
> 时间：2012-10-28T21:53:44.730
> 
> 标签：jquery

我有一个问题，我的动画效果很好，但是当 .hide(); 被触发它只是恢复到 slideDown(); 功能。

我正在摸索它，虽然我假设它正在运行动画，因为之前的点击仍然有效？

```
$('div.SocialShareJob').on('click', function(){
    $(this).find('p').slideUp(300).fadeOut(500);
    $(this).find('.Icons').slideDown(500).fadeIn(900);
});
$('div.CloseSharing').on('click', function(){
    $(this).parent('div.Icons').hide(); 
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T21:56:44.810

您需要[停止](http://api.jquery.com/stop/)尚未完成的动画，并清除队列：

```
$('div.CloseSharing').on('click', function(event){
    $(this).parent('div.Icons').stop(true).hide(); 
}); 
```

如果`closeSharing`div 是另一个 div 的子级，您可能还需要阻止`click`事件传播到父级。为此，请`event.stopPropagation()`在事件处理程序的开头添加：

```
$('div.CloseSharing').on('click', function(event){
    event.stopPropagation();
    $(this).parent('div.Icons').stop(true).hide(); 
}); 
```

# android - ViewPager 用于对许多 (>20) 页面进行排序并动态更新文本

> ID：13113389
> 
> 赞同：3
> 
> 时间：2012-10-28T21:54:10.570
> 
> 标签：android, dynamic, android-viewpager

我正在尝试使用 viewpager 对页面列表进行排序。对于我的程序，页数从 20 到 35 不等。这个数字是根据从 sql lite 数据库中提取的“问题”字符串数组变量的大小确定的。下面未显示此代码，但我已确认代码正确查找变量的大小以及数据库中的值

我的问题是第一页加载但是一旦我尝试滚动到下一页，程序就会崩溃。除了一个文本视图（currentQuestion）之外，每个页面都是相同的，我试图根据正在查看的当前页面动态更改它（例如，如果在第 8 页，从 questions 变量中加载第 8 个变量以显示在currentQuestion 文本视图）。

任何帮助将不胜感激！我不想单独定义每个视图...

感谢找到此解决方案的用户（以下代码来自[Android ViewPager 和 ListViews](https://stackoverflow.com/questions/7376613/android-viewpager-and-listviews)）

我猜问题出在我修改最多的代码上，即 MainActivity

主要活动：

```
public class MainActivity extends Activity {

/** Called when the activity is first created. */

private Context mContext;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mContext = this;
    setContentView(R.layout.main);
    for (int i=0; i<test.count();i++)
    {
        listview.setAdapter(new ArrayAdapter<String>(mContext, android.R.layout.simple_list_item_1, question));
        pages.add(listview);
    }
    System.out.println("test");
    ViewPager vp = (ViewPager) findViewById(R.id.milestoneViewPager);
    PageSwiper adapter = new PageSwiper(mContext,pages);
    vp.setAdapter(adapter);
    int currentPage= vp.getCurrentItem();
    TextView currentQuestion= (TextView) findViewById(R.id.milestoneText);
    currentQuestion.setText(question[currentPage]);
} 
```

}

这是 CustomViewPagerAdapter.java

```
public class CustomPagerAdapter extends PagerAdapter {

private Context mContext;
private Vector<View> pages;

public CustomPagerAdapter(Context context, Vector<View> pages) {
this.mContext=context;
this.pages=pages;
}

@Override
public Object instantiateItem(ViewGroup container, int position) {
View page = pages.get(position);
container.addView(page);
return page;
}

@Override
public int getCount() {
return pages.size();
}

@Override
public boolean isViewFromObject(View view, Object object) {
return view.equals(object);
}

@Override
public void destroyItem(ViewGroup container, int position, Object object) {
container.removeView((View) object);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T05:42:01.653

您遇到什么错误？我认为空指针？什么是 PageSwiper 类？我假设的自定义类，但为什么将其命名为适配器？

此外，您仅在 onCreate 方法中设置问题的文本一次，它应该是循环的一部分或其他东西。

要动态更改文本，请尝试使用 viewpager 函数 setOnPageListener

这是一个例子：

```
vp.setOnPageChangeListener(new OnPageChangeListener(){
        @Override
        public void onPageSelected(int position) {
            TextView txtQuestion= (TextView) findViewById(R.id.milestoneText);
            String currentQuestion = question[position]; // Question from your string array
            txtQuestion.setText(currentQuestion );

        }
        @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) {

        }

        @Override
        public void onPageScrollStateChanged(int arg0) {

        }
    }); 
```

希望对您有帮助，如果有帮助或需要其他信息，请给我留言

# mysql - 显示 90 天之前的所有记录

> ID：13113391
> 
> 赞同：1
> 
> 时间：2012-10-28T21:54:17.947
> 
> 标签：mysql, database

我正在尝试显示可以献血的献血者名单。为此，我正在计算他们的最后一次捐赠日期是否在 90 天之前。这是我的查询：

```
select *
from donar, donation
    donar.id=donation.donar_id
    and sex='female'
    and datediff(curdate(),donation_date) > 120 
```

问题是它完美地显示了捐献者的姓名，但如果捐献者现在献血，它仍然会在列表中显示他的姓名，因为他在 90 天之前有一个先前的条目。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T21:56:08.043

您在示例中缺少 where 。试一试...您需要从另一个角度查看查询...根据您在下面的评论，这里有一个简单的方法来获取不同日期限制的男性和女性。如果没有 UNION，您可能可以在一个声明中做到这一点，但我认为工会保留了男性和女性不同日子的逻辑。

```
 SELECT * from donor 
   LEFT JOIN donation ON donor.id=donation.donor_id 
        AND donation.donation_date > NOW() - INTERVAL 120 day
 WHERE donation.donation_id IS NULL  
      AND donor.sex='female' 

 UNION   

 SELECT * from donor 
   LEFT JOIN donation ON donor.id=donation.donor_id 
        AND donation.donation_date > NOW() - INTERVAL 90 day
 WHERE donation.donation_id IS NULL  
      AND donor.sex='male' 
```

基本上这个查询说“给我捐赠者表中的所有人，包括那些在 90 天内捐赠的人的信息，然后只显示那些没有捐赠细节的人（也就是 90 天内没有捐赠的人）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:30:46.237

```
select * from donar 
       left join donation 
                 on ( donar.id=donation.donar_id )
       where (
               ( sex='female' and datediff(curdate(),donation_date) > 120) 
               or 
               ( sex='male' and datediff(curdate(),donation_date) > 90) 
             )
             or donation.id is null; 
```

# c - Monty Hall Game：如何让用户选择门而不是程序自动随机选择？

> ID：13113392
> 
> 赞同：0
> 
> 时间：2012-10-28T21:54:19.057
> 
> 标签：c, random, printf, scanf

```
#include <stdio.h>
#include <time.h>
int main(void)
{
    int games = 0;
    int stayWins = 0;
    int switchWins = 0;
    int chosenDoor;
    int remainingDoor;
    int revealedDoor;
    int winningDoor;
    int option;

    srand (time(NULL));

    do
    {
    chosenDoor = rand() % 3 + 1;
    winningDoor = rand() % 3 + 1;
        do
        {
            revealedDoor = rand() % 3 + 1;
        } while (revealedDoor == chosenDoor || revealedDoor == winningDoor);

        do
        {
            remainingDoor = rand() % 3+1;
        } while (remainingDoor == chosenDoor || remainingDoor == revealedDoor);

        option = rand() % 2 + 1;
        if (option == 1)
        {
            if (chosenDoor == winningDoor)
            {
                stayWins++;
            }
        }
        if (option == 2)
        {
            chosenDoor = remainingDoor;
            if (chosenDoor == winningDoor)
            {
                    switchWins++;
            }
        }
        games++;
    } while (games < 10000);

printf("Out of 10,000 games, the contestant won %d times by staying with his/her original choice and won %d times by switching his/her choice.",stayWins,switchWins);

    return 0;
} 
```

晚安，这是一个完整的蒙蒂霍尔问题代码，它打印了 10,000 场比赛的结果。代码将为用户选择所选的门。我该如何更改它，以便程序允许用户自己选择？同样，我该如何修改它，以便程序不会为程序随机化“1”或“2”的值，而是允许我选择切换？我的进步......而不是这个：

```
chosenDoor = rand() % 3 + 1; 
```

使用这个，只有可接受的输入是 1、2 或 3 ：

```
printf("Choice:");
scanf("%d",&chosenDoor); 
```

这是正确的轨道吗？我知道此时用户需要在程序“完成”之前输入他的选择 10,000 次，那么有没有办法可以将第一选择应用于其他 9,999 次试验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T21:56:30.493

> 有没有办法可以将第一选择应用于其他 9,999 项试验？

移动

```
printf("Choice: ");
scanf("%d", &chosenDoor); 
```

循环外的部分代码。

# javascript - 使用javascript从表单中的多个复选框中读取值

> ID：13113393
> 
> 赞同：0
> 
> 时间：2012-10-28T21:54:27.710
> 
> 标签：javascript, jquery, ruby-on-rails, twitter-bootstrap

我对javascript很陌生并且有一个问题。我正在使用 twitter bootstrap、rails 和 simpleform。我在表单中使用 javascript 将复选框替换为切换。我现在尝试在编辑时使用相同的表单向用户显示正确的切换选项。

当表单显示在编辑操作中时，为复选框值（1 或 0）选择切换。下面的 JS 代码适用于单个切换元素。我想知道如果我给它们相同的ID，是否可以循环遍历所有切换？我的表单中有超过 10 个复选框，不想复制 JS。

```
var n = $('#hole_punch_buttons input[value=1]').length;
if(n === 1){
    $("#hole_punch_buttons a[data-value=1]").addClass('active')
}
else {
    $("#hole_punch_buttons a[data-value=0]").addClass('active')
} 
```

这是HTML：

```
<div id="hole_punch_buttons" class="btn-group" data-toggle="buttons-radio">
  <div class="control-group hidden">
           <div class="controls">
               <input class="hidden" id="id_card_design_hole_punch" name="id_card_design[hole_punch]" type="hidden" value="1">
           </div>
       </div>
  <a class="btn ffbtn active" data-value="1">Yes</a>
  <a class="btn sfbtn" data-value="0">No</a>
</div> 
```

也许有更好的方法来写它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:09:00.677

> 我想知道如果我给它们相同的ID，是否可以循环遍历所有切换？

不，ID 是唯一的。但是，如果您使用类，则可以遍历它们。

`hole_punch_buttons`这是一个用作类的示例：

```
<div class="btn-group hole_punch_buttons" data-toggle="buttons-radio"> 
```

还有你重写的 JS：

```
$('div.hole_punch_buttons').each(function() {
    var n = $(this).find('input[value=1]').length;
    $(this).find('a[data-value=' + n + ']').addClass('active');
}); 
```

[**小提琴**](http://jsfiddle.net/uKkq8/2/)

* * *

另一种解决方案是使用`.val()`检索隐藏输入的值并将活动类添加到相应锚点的数据值中：

```
$('div.hole_punch_buttons').each(function() {
    var n = $(this).find('input.hidden').val();
    $(this).find('a[data-value=' + n + ']').addClass('active');
}); 
```

[**小提琴**](http://jsfiddle.net/uKkq8/3/)

# c# - 如何将 EditorFor 与分组列表一起使用？

> ID：13113397
> 
> 赞同：1
> 
> 时间：2012-10-28T21:54:50.397
> 
> 标签：c#, asp.net-mvc, razor

我有一个列表，我想在剃刀视图中进行分组和编辑。

如果 POCO 是：

```
public class FooBar {

public string GroupName {get;set;}
public string SomeValue {get;set;}

// etc.

} 
```

以及视图中的模型：

```
@model IEnumerable<FooBar> 
```

Post 动作是这样的：

```
[HttpPost]
        public ActionResult FooBarPost(IEnumerable<FooBar> model) 
```

通常要编辑列表，我会在我的视图中使用以下语法：

```
@Html.EditorForModel() 
```

效果很好，它创建了可爱的小输入，例如：

```
<input id="[0].SomeValue" /> 
```

并且回邮是完美的。

现在，如果我想将我的观点改为不那么令人敬畏的：

```
<fieldset>
                        <legend>Legendary</legend>
                        @foreach (var group in Model.GroupBy(x => x.GroupName))
                        {
                            <h3>@group.Key</h3>

                            @Html.EditorFor(x => group)
                        }
                    </fieldset> 
```

然后当我发布我的列表时返回为空？

我记得有一个技巧可以解决这个问题，我只是不记得是什么？

谢谢。

编辑：

添加`[Bind(Prefix="group")]`到我的操作中，现在只带回一个输入值。

我注意到生成的 HTML 看起来像这样（都在同一页面上）：

第一组：

```
<input id="group_0__SomeValue" name="group[0].SomeValues" type="hidden" value="bla">  
<input id="group_1__SomeValue" name="group[1].SomeValues" type="hidden" value="bla"> 
```

下一组：

```
<input id="group_0__SomeValue" name="group[0].SomeValues" type="hidden" value="bla"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:55:57.617

假设您的目标是为 GroupName 的每个唯一实例呈现一个编辑器，请将您的代码更改为如下所示：

```
@model IEnumerable<PlayMvc.Models.FooBar>
<fieldset>
    <legend>Legendary</legend>
    @using(Html.BeginForm("Test","Home", FormMethod.Post)){
        var groups = Model.GroupBy(x => x.GroupName).Select(x => x.First()) .ToList();
        for (int i = 0; i < groups.Count(); i++ )
        {
            <h3>@groups[i].GroupName</h3>

            @Html.EditorFor(x => groups[i])
        }
        <input type="submit" />
    }
</fieldset> 
```

在您的控制器端执行以下操作：

```
public ActionResult Test([Bind(Prefix="groups")]List<FooBar> model) 
```

**边注**

尝试使用可枚举对象在视图中呈现项目时不要使用 foreach，否则它们的名称中将没有索引器。@Html.EditorFor(x => groups[i]) 和 @Html.EditorFor(x => group) 会在 HTML 中呈现不同的名称标签，因此模型绑定器不会将其识别为应该重构为的集合的一部分输入您的操作。

# tomcat - 单个 apache tomcat 上的多个域

> ID：13113401
> 
> 赞同：2
> 
> 时间：2012-10-28T21:55:10.583
> 
> 标签：tomcat, multiple-domains

我有两个域，但只有一个运行 tomcat 7 的虚拟服务器。我有自己的 ubuntu Linux，在虚拟服务器上运行具有完全 root 访问权限。我设置了shorewall防火墙，它将端口80上的任何请求转发到端口8080（tomcat正在监听的地方）。

所以我已经在网上搜索过，但我只找到在我的情况下不起作用的“解决方案”。这是我到目前为止所做的：

1.  我将我的 websiteA.war 作为 ROOT.war 复制到 $CATALINA_HOME/webapps/ 文件夹中
2.  我还将我的 websiteB.war 作为 WebsiteB.war 复制到 $CATALINA_HOME/webapps/ 文件夹中
3.  我通过以下方式修改了我的 $CATALINA_HOME/conf/server.xml：

    主机名="www.websiteA.com" appBase="webapps" unpackWARs="true" autoDeploy="true"

    主机名="www.websiteB.de" appBase="webapps/websiteB" unpackWARs="true" autoDeploy="true"

    主机名="localhost" appBase="webapps" unpackWARs="true" autoDeploy="true"

4.  我在文件夹 "$CATALINA_HOME/conf/Catalina/www.websiteB.com" 中创建了以下文件 ROOT.xml：

    ?xml 版本=“1.0”编码=“UTF-8”？

    上下文 displayName="www.websiteB.com" docBase="" path=""

    /语境

5.  重新启动tomcat。websiteA.com 部署在“/”下，websiteB.com 部署在“/websiteB”下

6.  输入 www.websiteB.com 到达“/”，这意味着 websiteA 实际上显示为 websiteB.com

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-09T06:27:44.713

转到您的`$CATALINA_HOME/conf/server.xml`文件。

在那里，您将找到以下部分：

```
<Engine name="Catalina" defaultHost="localhost">
    <!-- ... some other stuff ... -->
    <Host name="www.websiteA-Address" appBase="webapps" unpackWARs="true" autoDeploy="true"></Host>
    <Host name="www.websiteB-Address" appBase="directory/of/WAR-files-for-B" unpackWARs="true" autoDeploy="true"></Host>
    <Host name="websiteB-Address" appBase="directory/of/WAR-files-for-B" unpackWARs="true" autoDeploy="true"></Host>
    <Host name="www.websiteC-Address"  appBase="directory/of/WAR-files-for-C" unpackWARs="true" autoDeploy="true"></Host>
</Engine> 
```

因此，`appBase`将是您必须放置`ROOT.war`（！）的目录，并且`name`是将映射到该目录的域名。

`directory/of/WAR-files`是 中的子目录`$CATALINA_HOME`，与标准文件夹处于同一**级别**（！！！）`webapps`。所以两个目录共存！

# ios - 奇怪的 UICollectionViewFlowLayout 覆盖行为

> ID：13113403
> 
> 赞同：0
> 
> 时间：2012-10-28T21:55:27.793
> 
> 标签：ios, ios6, uicollectionview, uicollectionviewlayout

我正在尝试覆盖`UICollectionViewFlowLayout`，但我意识到一些奇怪的事情。在这里你可以看到一个小代码片段：

```
#import <UIKit/UIKit.h>

@interface SimpleFlowLayout : UICollectionViewFlowLayout 
@end

@implementation SimpleFlowLayout

- (void)prepareLayout {
    ...
}

- (void)prepareForCollectionViewUpdates:(NSArray *)updateItems {
    ...
}

- (void)finalizeCollectionViewUpdates {
    ...
}

- (UICollectionViewLayoutAttributes *)
     initialLayoutAttributesForAppearingItemAtIndexPath:
       (NSIndexPath *)itemIndexPath {
    ...
}

- (UICollectionViewLayoutAttributes *)
     finalLayoutAttributesForDisappearingItemAtIndexPath:
       (NSIndexPath *)itemIndexPath {
    ...
}

@end 
```

当一个项目被添加到 时`UICollectionView`，`reloadData`被调用。`ReloadData`总是重新初始化布局，因此它会`prepareLayout`一次又一次地调用，并且永远不会调用`prepareForCollectionViewUpdates`。

你知道如何处理它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T13:53:20.717

解决了，我不得不在 textFieldShouldReturn 方法中使用 batchUpdate 而不是 reloadData 。

# ruby - 如何为 gem 创建一个模块？

> ID：13113404
> 
> 赞同：2
> 
> 时间：2012-10-28T21:55:28.027
> 
> 标签：ruby, module, rubygems, monkeypatching

我正在创建一个图形库 gem。

创建 gem 时，确保与其他 gem 或其他代码没有冲突似乎很重要。

例如，从我的 gem 代码中调用扩展（monkeypatch）方法。

```
class Array
  def sum
    inject(0.0) { |result, el| result + el }
  end 
```

所以，解决方案似乎是一个模块。

如何创建一个模块，并保证gem被他人下载使用时不与其他代码冲突？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T04:47:47.653

你就去做吧。创建一个模块，并使用它：

```
 module MyLibrary
   class MyGraphicsClass
     # ...
   end
 end 
```

这*绝不*有助于防止您的猴子补丁踩到其他人的脚趾。无法防止您对 Array 的修改可能会破坏其他人的代码。解决办法是*不要那样做*。修补标准库的基本部分是一种可怕的做法，并且是确保没有人想要触摸您的 gem 的好方法。

# javascript - 在 Facebook 的 Chrome 扩展中使用 onpopstate

> ID：13113413
> 
> 赞同：2
> 
> 时间：2012-10-28T21:56:19.070
> 
> 标签：javascript, facebook, dom-events, browser-history, chrome-plugins

我正在尝试为 facebook 创建一个 Chrome 插件，并且我正在使用 onpopstate 事件来检查用户何时进入另一个页面。唯一的问题是 onpopstate 不会触发。

这是我正在使用的（简单）代码：

```
window.onpopstate = function() { console.log('pop'); }; 
```

这是问题的屏幕：

![控制台中的代码测试](../Images/ae94f81bb9c0468a844451386c8313f0.png)

如您所见，调用了 pushState 代码，但未调用 onpopstate 侦听器。

你知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-10-10T00:15:19.107

@enhzflep 的答案在上面的评论中，并不是很明显。来自[MDN](https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onpopstate)：

> 调用 history.pushState() 或 history.replaceState() 不会触发 popstate 事件。popstate 事件仅通过执行浏览器操作触发，例如在同一文档的两个历史条目之间导航时单击后退按钮（或在 JavaScript 中调用 history.back()）。

换句话说，在这种情况下不应触发 onpopstate 事件。

# dns - 我将名称服务器指向我的服务器 ip adreess，将 NSD3 配置为 DNS 服务器，但域无法解析。我究竟做错了什么？

> ID：13113414
> 
> 赞同：2
> 
> 时间：2012-10-28T21:56:27.123
> 
> 标签：dns, bind, zone, nameservers

我正在尝试在 hp cloud VPS 上为域“appwared.com”设置我自己的名称服务器。

我从注册商控制面板添加了 ns1.appwared.com 以指向我服务器的公共 IP 地址。

我安装了 NSD3 作为我的 DNS 软件并配置了区域文件。它已启动并正在运行，但如您所见，域未解析。

在这里你可以看到区域文件： http: [//pastebin.com/z0094kja](http://pastebin.com/z0094kja)

这是我第一次尝试设置自己的名称服务器，也许您可​​以指出我做错了什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-01T19:17:39.667

HP 阻止了 DNS 中使用的 UDP 53 端口。

# javascript - 如何为复选框调用多个图像

> ID：13113416
> 
> 赞同：1
> 
> 时间：2012-10-28T21:56:40.930
> 
> 标签：javascript, checkbox

以下代码是对去年发布的问题的回复。这是我能找到的最好的例子。我有 HTML 知识，但我的 JS 有限——感谢您的耐心等待。[您可以在此处](http://jsfiddle.net/vaWtY/)查看代码。线程可以在[这里找到。](https://stackoverflow.com/a/7691692/1781287)

```
<script>
  function toggleVisibility(id) {
    var el = document.getElementById(id);

    if (el.style.visibility=="visible") {
          el.style.visibility="hidden";
     }
     else {
          el.style.visibility="visible";
     }
 }
</script>

<label for="chkemployment">Employment</label>
<input type="checkbox" id="chkemployment" onChange="toggleVisibility('imgemployment');"     /><br/>

<label for="chkpopulation">Population</label>
<input type="checkbox" id="chkpopulation"    onChange="toggleVisibility('imgpopulation');" />
<hr />

<img id="imgemployment"    src="http://www.gravatar.com/avatar/c0d7be6d99264316574791c1e4ee4cc4?s=32&d=identicon&r=PG"  style="visibility:hidden"/> 
```

单击复选框时，如何显示多个图像？图像将相同，位置不同。显示图像时，我希望有一个 onclick 事件或 mouseover 来显示附加信息——对此，JS 或图像映射（热点）的最佳选择是什么？两者都有？我以前使用过热点，但只是单独使用，而不是 JS。对此的任何建议将不胜感激。以下链接是我正在尝试实现但规模较小的示例。[http://www.cozumel.travel/learn/map.cfm](http://www.cozumel.travel/learn/map.cfm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:13:28.947

如果您想对多个图像使用相同的代码，您可以添加一个函数来切换您为 onChange 事件定义的每个图像。

这是一个可以执行的功能：

```
 function toggleMultiVisibility (a){

for (var i = 0; i < a.length; i++){
 toggleVisibility(a[i]);
}

} 
```

这是您应该对 HTML 进行的更改：

```
onChange="toggleMultiVisibility(['imgemployment','imgpopulation']);" 
```

这是您的代码中的一个工作示例：http: [//jsfiddle.net/Pu2E7/](http://jsfiddle.net/Pu2E7/)

# c# - 我必须使用 Windows 8 才能为 Windows 应用商店开发吗？

> ID：13113417
> 
> 赞同：1
> 
> 时间：2012-10-28T21:56:43.937
> 
> 标签：c#, windows, xaml, windows-8

我真的想回滚 W8，但我想有一个为 Windows Store 开发的选项（例如，我可能会购买 Windows Surface 并将其用作测试环境，但将开发保留在 W7 上）.. 可能吗？

当我说应用程序时，我的意思是 C#/XAML。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T22:12:20.593

根据[使用 Visual Studio 2012 开发 Windows 应用商店应用程序](http://msdn.microsoft.com/en-us/library/windows/apps/br211384.aspx)，您不能这样做。

> 仅 Windows 8 支持在 Visual Studio 中进行 Windows 应用商店应用开发。不支持 Windows 7。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:25:10.187

尽管仅在 Windows 8 中支持 Windows 商店应用程序开发，但您始终可以在虚拟机（如 Virtual Box）中安装 Windows 8 以完成工作。此外，您还可以将 Windows 8 安装到一个`VHD`，这样您就不必对硬盘进行分区。[以下](http://blogs.technet.com/b/haroldwong/archive/2012/08/18/how-to-create-windows-8-vhd-for-boot-to-vhd-using-simple-easy-to-follow-steps.aspx)是相关说明。

# ios - 使用缓存中的图像设置 UIImageView

> ID：13113419
> 
> 赞同：0
> 
> 时间：2012-10-28T21:56:46.800
> 
> 标签：ios, ios5, uiimageview, uiimage

**当用户像这样登录时，我缓存了一个图像：**
这是在一个`Utility.m`

```
UIImage *image = [UIImage imageWithData:newProfilePictureData];

UIImage *mediumImage = [image thumbnailImage:280 transparentBorder:0 cornerRadius:0 interpolationQuality:kCGInterpolationHigh];
UIImage *smallRoundedImage = [image thumbnailImage:64 transparentBorder:0 cornerRadius:9 interpolationQuality:kCGInterpolationLow];

NSData *mediumImageData = UIImageJPEGRepresentation(mediumImage, 0.5); // using JPEG for larger pictures
NSData *smallRoundedImageData = UIImagePNGRepresentation(smallRoundedImage); 
```

**稍后我想将小图像加载到`UIImageView`：**
这是在`UITableView`-`cellForRowAtIndexPath`

```
[cell.leftIcon setImage: 
```

有谁知道我如何引用缓存的图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:31:27.000

您需要在 Utility.m 中使用以下方法，

```
+(NSString*)getImage {
    return smallRoundedImage;
} 
```

然后像下面这样使用它，

```
[cell.leftIcon setImage:[Utility getImage]]; 
```

PS：这只是一个例子，您可以根据您的要求做得更好！

# c++ - C ++计算整数数组中的字节数

> ID：13113420
> 
> 赞同：1
> 
> 时间：2012-10-28T21:56:58.170
> 
> 标签：c++, arrays, sockets

这可能是一个非常简单的问题，也可能不是一个非常简单的问题，但我想知道调用什么函数来确定在任何给定时间数组中有多少字节。例如，我怎么知道在下面的代码中将什么作为第三个参数放在发送命令中？

```
int *array= new int[500];
memset(array, 0, sizeof(array));

//newsockfd is declared elsewhere in the code
send(newsockfd, array, _______, 0); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T21:59:48.297

数组的大小是恒定的（它只是一大块内存）。

您需要自己在一个单独的变量中跟踪数组中有多少元素是有效的。

正如其他人所指出的，最后一个参数`memset`应该是您想要设置为 0 的字节数——但`array`它只是一个指针，因此`sizeof(array)`只会产生 4 个（或 64 位平台上的 8 个）。同样，您需要手动传入`sizeof(int) * 500`（或为 500 使用常量，这样您就不必在多个位置更新数字，如果它发生变化）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:00:59.123

您无法获取为数组动态分配的项目数，因此该行`memset(array, 0, sizeof(array))`不会用 0 填充数组中的 500 个项目，并且`sizeof(array)`始终等于`sizeof(int*)`，因此如果您想访问已分配的项目数对于数组，您应该使用包含大小的单独值或使用 C++ 存储，例如`std::vector`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T22:06:16.010

您`memset()`不会清除动态分配的内存`new int[500]`，而只是清除第一个`sizeof(int*)`字节。

如果要清除堆内存，请这样做：

```
memset(array, 0, 500 * sizeof(int)); 
```

或在初始化时：

```
int *array= new int[500](); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T22:13:12.013

另请查看[www.cplusplus.com/faq/sequences/arrays/sizeof-array/](http://www.cplusplus.com/faq/sequences/arrays/sizeof-array/)是关于该主题的好读物（不是直接关于 sizeof() 运算符，而是通常以适当的“C++ 方式”在 C++ 中处理数组）。

# php - Typo3：在扩展安装期间插入数据（创建表后）

> ID：13113424
> 
> 赞同：4
> 
> 时间：2012-10-28T21:57:38.803
> 
> 标签：php, installation, typo3

对于我正在编写的自定义扩展，我有一个在安装时加载的 ext_tables.sql 文件。

我想在安装例程期间使用 PHP 代码将一些动态数据插入到从 ext_tables.sql 创建的表中。这可能吗？如果是这样，我必须做什么，我必须在哪里做？

或者，是否可以让 PHP 代码在安装期间创建表（使用 DB 接口）而不是依赖于 ext_tables.sql？同样，如果是这样，我必须为此做什么以及我必须在哪里做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T11:54:44.207

Of course you can (with a litte trick):

1.  Add an ext_conf_template.txt to your extension
2.  Add an user-type entry to ext_conf_template.txt

    ```
    # cat=basic; type=user[EXT:<EXTNAME>/Path/To/Class.php:Tx_Path_To_Class->postInstall]; label=
    postInstallAction=0 
    ```

3.  Create to PHP-File Class.php in path /Path/To

    This method can be used to do some post install actions or more generally to modify the extension configuration page (The method could return HTML which will be included here).

    ```
    class Tx_Path_To_Class {
        /**
         * Generates and returns an message.
         *
         * @param array               $params      Name and value from ext_conf_template.txt
         * @param t3lib_tsStyleConfig $styleConfig Instance of config style editor
         *
         * @return string HTML code
         */
        public function postInstall(array $params, t3lib_tsStyleConfig $styleConfig) {
            // Do your stuff
            return '';
        } 
    ```

    }

I use this to add some user defined output to the configuration page of an extension but you can also you this to execute some initial setup actions.

After installing an extension you can now click on the button "Make updates" to execute your script.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T13:10:27.640

在旧的 EM 中至少有一个钩子（TYPO3 4.5 及以下）。我想新的也有一些。

您可以将一些字段添加到视图中，您可以在其中设置设置。

```
$TYPO3_CONF_VARS['SC_OPTIONS']['typo3/mod/tools/em/index.php']['tsStyleConfigForm'][] = "EXT:yourextension/class.yourextension.php:yourextension->main"; 
```

# php - 使用php将错误的日期插入mysql

> ID：13113425
> 
> 赞同：0
> 
> 时间：2012-10-28T21:57:59.773
> 
> 标签：php, mysql, datetime

我正在使用 php 的形式来捕获日期，将其转换为 unixtime，然后将其插入 mysql。问题是，当我尝试插入 2012 年 1 月 1 日时，插入的是 2011 年 12 月 31 日。这一定是一个简单的问题，但我可以使用一些帮助。

这是我的表单代码：

```
<select name="mo">
   <?php 
   $arrMo = array("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December");
   foreach ($arrMo as $key => $value) {
       $option_val = intval($key) + 1;
    echo "<option value='" . $option_val . "'>" . $value . "</option>"; 
}

   ?>
   </select>  / 

   <select name="day">
   <?php 
   for ($b = 1; $b < 32; $b++) {
       echo "<option value='" . $b . "'>" . $b . "</option>\n";
   }
   ?>
   </select>  / 
   <select name="year">
   <?php $thisyear = date("Y");
   $thisyear = intval($thisyear);
   for ($c = 0; $c < 6; $c++) {
       $newval = $thisyear - intval($c);
       echo "<option value='" . $newval . "'>" . $newval . "</option>\n";
   }

   ?>
   </select> 
```

然后我在php中改变它：

```
$timestamp =  $_POST['year'] . "-" .  $_POST['mo'] . "-" . $_POST['day'];
$timestamp = strtotime("Y-m-d H:i:s", $timestamp);//turn it into Unix time
$mysqldatetime = date("Y-m-d H:i:s", $timestamp); 
```

然后我尝试将其插入数据库：

```
$q_location = "Insert into markers(MarkerID, lat, lng, street, neighborhood, date) values(" . $nextLocation . ", '" . $_POST['latitude'] . "', '" . $_POST['longitude'] . "', '" . addslashes($_POST['address_public']) . "', '" .   addslashes($_POST['neighborhood']) . "', FROM_UNIXTIME(" . $mysqldatetime . "))"; 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:03:46.327

在 SQL 查询中删除 FROM_UNIXTIME。如果你的日期格式已经是 Ymd H:i:s 你可以直接使用这个变量 $mysqldatetime。

否则，您需要将时间戳传递给 FROM_UNIXTIME() 函数。

**编辑：**

实际上你的时间戳是错误的：

```
$timestamp =  $_POST['year'] . "-" .  $_POST['mo'] . "-" . $_POST['day'];
$timestamp = strtotime("Y-m-d H:i:s", $timestamp);//turn it into Unix time
$mysqldatetime = date("Y-m-d H:i:s", $timestamp); 
```

只需将其更改为：

```
$mysqldatetime = strtotime($_POST['year'] . "-" .  $_POST['mo'] . "-" . $_POST['day']); 
```

不需要 $timestamp 行，您应该能够保持 SQL 查询不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:03:53.630

day 看起来基于 0 的变化

```
$timestamp =  $_POST['year'] . "-" .  $_POST['mo'] . "-" . $_POST['day']; 
```

至

```
$timestamp =  $_POST['year'] . "-" .  $_POST['mo'] . "-" . $_POST['day']-1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:34:06.917

好的，答案原来是......我在插入语句中缺少日期周围的引号。格。谢谢大家，为了帮助我！

# algorithm - 在不使用图表的情况下有任何有效的解决方案吗？

> ID：13113426
> 
> 赞同：1
> 
> 时间：2012-10-28T21:58:03.577
> 
> 标签：algorithm, stack

给出了一个元组列表`(i,j)`，每个元组都`(i,j)`告诉你`i`并且`j`是朋友。友谊是具有传染性的，所以如果`i`和`j`是朋友，`j`并且`k`是朋友，`i`并且`k`是朋友，即使元组`(i,k)`不存在。所以问题是，对于一组从 1 到 N 的整数，以及一个元组列表，如何有效地确定所有数字之间是否是朋友。

除了天真的算法，是否有可能在不使用图表的情况下设计一种有效的算法来做到这一点？

这个问题还有另一个变体，问题是找出给定的元组是否`(m,n)`是朋友。这可以使用堆栈来实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:26:22.077

我已经学会了一种通过移除非常适用的墙壁来制作迷宫的算法。

```
int friendGroups[N];

// initially, all numbers are in a "forever alone" group.
for(i = 0; i < N; i++) {
    friendGroups[i] = i;
}

int findFriendGroup(int p) {
    int g = friendGroups[p];
    if (g != p) {
        g = friendGroups[p] = findFriendGroup(g);
    }
    return g;
}
void addFriendship(int i, int j) {
    friendGroup[findFriendGroup(i)] = findFriendGroup(j);
}
int areFriends(int i, int j) {
    return (findFriendGroup(i) == findFriendGroup(j));
} 
```

`findFriendGroup()`看起来可能效率低下，但每次调用都渐近地花费 O(A^(-1)(N))，其中 A^(-1) 是反阿克曼函数，它非常接近 O(1)，不值得担心。

```
int singleFriendGroup() {
    int g = findFriendGroup(0);
    int i;

    for(i = 1; i < N; i++) {
        if (findFriendGroup(i) != g) {
            return 0;
        }
    }
    return 1;
} 
```

每个人都“指向”另一个人或他自己。每个朋友组都有一个指向自己的主要成员 ( `friendGroups[i] == i`)。 `findFriendGroup()`沿着点链找到组的主要成员，并在返回的路上使链中的每个人直接指向主要成员。要统一两个组 ( `addFriendship()`)，使一个组的主要成员指向另一组的主要成员。

# algorithm - 如何查找图是否是树及其中心

> ID：13113430
> 
> 赞同：5
> 
> 时间：2012-10-28T21:58:49.970
> 
> 标签：algorithm, graph, tree, parent-child

`G=(V,E)`给定一个没有*父节点、叶节点和子节点*概念但只有邻域关系的通用图结构，是否有一种算法（或一系列算法）可以找到：

1）`G`是否是一棵树（检查是否足够`|V| = |E|+1`？）

2）如果图实际上是一棵树，它的叶子和中心呢？（即最小化树深度的图节点）

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T00:10:15.443

如果树的“中心”被定义为“最小化树深度的图节点”，那么找到它的方法比找到直径更容易。

```
d[] = degrees of all nodes
que = { leaves, i.e  i that d[i]==1}
while len(que) > 1:
  i=que.pop_front
  d[i]--
  for j in neighbors[i]:
    if d[j] > 0:
      d[j]--
      if d[j] == 1 :
        que.push_back(j) 
```

que中剩下的最后一个是中心。

您可以通过考虑直径路径来证明这一点。为简化起见，我们假设直径路径的长度是奇数，因此路径的中间节点是唯一的，我们称该节点为 M，

我们可以看到：

1.  在直径路径上的所有其他节点都被推入队列之前，M 不会被推到队列的后面
2.  如果在 M 已经被推入 que 之后还有另一个节点 N 被推入，则 N 必须在比直径路径更长的路径上。因此 N 不存在。M 必须是 que 中最后一个推入（并离开）的节点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:09:46.720

1.  不，这还不够——一棵树是一个有`n-1`边的连接图。未连接的图中可能有`n-1`边 - 它不会是一棵树。
    您可以运行[BFS](http://en.wikipedia.org/wiki/Breadth-first_search)来查找图是否已连接，然后计算边数，如果图是树，这将为您提供足够的信息

2.  叶子是具有由等式给出的节点`v`度数的节点（每个节点只有一个连接的顶点）`d(v)``d(v) = 1`

* * *

(1) 答案假设无向图
(2) 在这里，`n`表示顶点数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-28T22:10:33.140

对于 (1)，您所要做的就是验证 |V| = |E| + 1 并且该图是完全连接的。

对于 (2)，您需要找到一个最大直径，然后在直径路径的中间选择一个节点。我隐约记得有一种简单的方法可以对树木执行此操作。

您从一个任意节点开始`a`，然后在距离 的最大距离处找到一个节点`a`，调用它`b`。然后你搜索`b`并找到一个距离最大的节点`b`，调用它`c`。`b`从到的路径`c`是最大直径。

还有其他可能对您更方便的方法，比如[这个](http://tech-queries.blogspot.com/2010/09/diameter-of-tree-in-on.html)。 [也检查谷歌](https://www.google.com/search?q=find+maximal+diameter+of+a+tree+graph)。

# ios - iOS 上的 GCDAsyncUdpSocket 缺少多播数据报

> ID：13113435
> 
> 赞同：7
> 
> 时间：2012-10-28T21:59:41.373
> 
> 标签：ios, udp, wireshark, multicast, gcdasyncsocket

我在网络上有一个设备通过 UDP 多播一个非常小的文件。我正在开发的 iOS 应用程序负责读取这些数据包，我选择使用[GCDAsyncUdpSocket](https://github.com/robbiehanson/CocoaAsyncSocket)来执行此操作。该文件每半秒发送一次，但是我几乎没有收到它（大约每 3-10 秒接收一次）。

考虑到这可能是设备的问题，我开始使用 Wireshark 监控流量。这似乎反映了我在应用程序中看到的内容，直到我在 Wireshark 中启用“监控模式”，此时每个 UDP 数据包都被捕获。此外，iOS 模拟器开始接收所有丢失的数据包，因为它与我正在开发的 Mac 共享 NIC。

有没有办法在 iOS 设备上启用“监控模式”或我缺少的东西可以让丢失的数据包进入？我还看到 GCDAsyncUdpSocket 中有一个 readStream 方法。也许我需要使用它而不是 beginReceiving？如果是这样的话，虽然我不知道如何在 Objective-C 中设置流。

这是我现在的测试代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    NSLog(@"View Loaded");
    [self setupSocket];             
}

- (void)setupSocket
{
    udpSocket = [[GCDAsyncUdpSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_main_queue()];
    NSError *error = nil;
    if (![udpSocket bindToPort:5555 error:&error])
    {
        NSLog(@"Error binding to port: %@", error);
        return;
    }
    if(![udpSocket joinMulticastGroup:@"226.1.1.1" error:&error]){
        NSLog(@"Error connecting to multicast group: %@", error);
        return;
    }
    if (![udpSocket beginReceiving:&error])
    {
        NSLog(@"Error receiving: %@", error);
        return;
    }
    NSLog(@"Socket Ready");
}

- (void)udpSocket:(GCDAsyncUdpSocket *)sock didReceiveData:(NSData *)data
      fromAddress:(NSData *)address
withFilterContext:(id)filterContext
{
    NSString *msg = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    if (msg)
    {
        NSLog(@"RCV: %@", msg);
    }
    else
    {
        NSString *host = nil;
        uint16_t port = 0;
        [GCDAsyncUdpSocket getHost:&host port:&port fromAddress:address];
        NSLog(@"Unknown message from : %@:%hu", host, port);
    }
} 
```

* * *

**任何将来来这里的人的解决方案：**

根据 ilmiacs 的回答，我能够通过 ping 目标 iOS 设备显着减少丢失数据包的数量。使用 Mac，我在终端中运行了它 -

```
sudo ping -i 0.2 -s 4 <Target IP> 
```

既然我已经使用 Mac ping iOS 设备运行它，我将研究 Apple 的 iOS ping 示例，看看是否可以让设备 ping 自身以刺激其自己的无线适配器 (127.0.0.1)。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-17T15:27:03.450

通过我为 iOS 设备开发网络应用程序的工作，我发现它们的网络适配器有两种不同的模式，我们称它们为主动和被动。我没有找到任何关于此的文档。以下是我的发现：

1.  只要处于活动模式，适配器就会非常敏感。我的响应时间为 3-5 毫秒。

2.  经过一段时间的不活动后，iOS 的网络适配器从主动模式变为被动模式。发生这种情况的时间取决于实际的设备型号。第三代 iPad 大约是 200 毫秒。对于 iPhone 4，它更像是 50 毫秒。

3.  ping 请求或 TCP 数据包会将适配器从被动模式移动到主动模式。这可能需要 50 毫秒到 800 毫秒，平均大约 200 毫秒。

通过发出 ping 命令，这种行为是完全可重现的。例如

```
ping -i 0.2 <ios-device-ip> 
```

将 ping 间隔设置为 200 毫秒，并使我的 iPad 网络适配器保持活动状态。

如果适配器（通常）在被动模式下忽略 UDP 数据包，则此行为与您的观察完全一致。Wireshark 活动可能会使其处于活动模式，因此它将获得 UDP。

检查 ping 技巧是否有帮助。

可以通过打开和连接设备本身的两个套接字并定期向自身发送数据包来使 iDevice 的网络适配器保持活动状态。这将引入一些最小的开销。

至于为什么苹果决定实现这样的功能，我只能推测。但是，保持适配器处于活动状态可能会花费足够的电池电量来使这种设计选择合法化。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T19:09:55.810

我遇到过同样的问题。

启动网络活动指示器为我解决了这个问题：

```
UIApplication* app = [UIApplication sharedApplication];
app.networkActivityIndicatorVisible = YES; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-11T04:41:37.603

如果要在 iOS 设备上查看数据包，可以将 iOS 设备连接到 Mac 并使用[shell 命令 rvictl](https://developer.apple.com/library/mac/qa/qa1176/_index.html#//apple_ref/doc/uid/DTS10001707-CH1-SECIOSPACKETTRACING)挂载 wifi 适配器。然后你可以使用wireshark、tcpdump等来监控你iOS设备上802.11接口的流量。

直到 3 到 7 秒才接收数据 - 很可能您的设备正在进入省电模式 (IEEE PSM)，这是一种 802.11 功能，基本上使无线 NIC 进入睡眠状态。
PSM 模式[可能会在设备上产生较差的性能](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.141.6769&rep=rep1&type=pdf)- 特别是在您每 1/2 秒有周期性数据突发的情况下。您的定期 ping 正在唤醒 NIC。

# google-sheets - 是否可以在 Google 电子表格中为*以前填写过*的单元格设置自动日期戳？

> ID：13113445
> 
> 赞同：1
> 
> 时间：2012-10-28T22:00:55.700
> 
> 标签：google-sheets, datestamp

也就是说，我在 B 列中有信息，我想在 C 列中有一个日期戳，指出 B 列的填写时间。我看到一堆 onEdit 脚本，但我希望它具有追溯性——那些单元格已经被填写了。那可能吗？Google 电子表格是否存储该信息并且是否可以访问？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T04:09:05.097

不幸的是，我不相信它是。正如您所提到的，有一些方法可以让时间戳向前发展，但是关于何时填写单元格的信息不可追溯。

[API 文档](https://developers.google.com/google-apps/spreadsheets/)提供了一个`updated`关于`List`和提要的字段`Cells`，但这是一个工作表级别的属性。返回的单元格数据不包含有关日期的任何其他信息，因此（不幸的）答案是您可能只能获得该级别的信息。

# arrays - MPI 可以收集、减少、发送或接收 Fortran 派生类型吗？

> ID：13113446
> 
> 赞同：3
> 
> 时间：2012-10-28T22:00:58.160
> 
> 标签：arrays, parallel-processing, fortran, mpi, derived-types

我想将派生类型 xyzBuffer 从处理器 1 复制到处理器 0 的 xyz。我尝试使用 MPI_GATHER：

```
 call MPI_GATHERV(xyzBuffer,1,inewtype,xyz,1, dispGather,inewtype,0,icomm,ierr) 
```

但是处理器 0 将有未写入的内存位：似乎 MPI_GATHER 不允许聚集派生类型。我使用了 MPI_ISEND/MPI_IRECV，但程序挂在下面的代码行：

```
 if ( iproc == 1 ) then
       call MPI_ISEND(xyz,1,inewtype,1,itag,icomm,ireq,ierr)
       call MPI_WAIT(ireq,istatus,ierr)
    else if ( iproc == 0 ) then 
       call MPI_IRECV(xyz,1,inewtype,0,itag,icomm,ireq,ierr)
       call MPI_WAIT(ireq,istatus,ierr)
    end if 
```

这些方法不是要与派生类型一起使用吗？

以下是完整的程序。我在测试 MPI_ISEND、MPI_IRECV 块时注释掉 MPI_GATHER，反之亦然。

```
program type_derived_gather
  use nodeinfo
  implicit none
  include 'mpif.h'
  integer(4) :: ierr
  integer(4) :: istatus(MPI_STATUS_SIZE)
  integer(4) :: i
  integer(4) :: j
  integer(4) :: iblock(8)
  integer(4) :: idisp(8)
  integer(4) :: itype(8)
  integer(4) :: inewtype
  integer(4) :: iextent
  integer(4) :: itag
  integer(4) :: ireq, isend, irecv
  integer(4) :: dispGather ! for root

    TYPE :: newXYZ
        integer :: x, u
        integer :: y, v
        integer :: z, w
        integer,dimension(3) :: uvw     
    END TYPE

    TYPE (newXYZ) :: xyzBuffer
    TYPE (newXYZ) :: xyz

  call MPI_INIT(ierr)
  icomm = MPI_COMM_WORLD
  call MPI_COMM_SIZE(icomm,nproc,ierr)
  call MPI_COMM_RANK(icomm,iproc,ierr)

    if (iproc == 1) then
        xyz%x = 1
        xyz%y = 2
        xyz%z = 3
        xyz%u = 4
        xyz%v = 5
        xyz%w = 6
        xyz%uvw = (/10,10,10/)
    else
        xyz%x = 0
        xyz%y = 0       
        xyz%z = 0
        xyz%u = 0
        xyz%v = 0       
        xyz%w = 0 
        xyz%uvw = (/0,0,0/)
    endif

! Derived type
  iblock(1) = 1
  iblock(2) = 1
  iblock(3) = 1
  iblock(4) = 1
  iblock(5) = 1
  iblock(6) = 1
  iblock(7) = 3
  iblock(8) = 1

  idisp(1)  = 0  ! in bytes
  idisp(2)  = 4*1  ! in bytes
  idisp(3)  = 4*2  ! in bytes 
  idisp(4)  = 4*3  ! in bytes 
  idisp(5)  = 4*4  ! in bytes
  idisp(6)  = 4*5  ! in bytes 
  idisp(7)  = 4*6  ! in bytes 
  idisp(8)  = 4*9  ! in bytes    

  itype(1)  = MPI_INTEGER
  itype(2)  = MPI_INTEGER
  itype(3)  = MPI_INTEGER
  itype(4)  = MPI_INTEGER
  itype(5)  = MPI_INTEGER
  itype(6)  = MPI_INTEGER
  itype(7)  = MPI_INTEGER
  itype(8)  = MPI_UB  
  call MPI_TYPE_STRUCT(8,iblock,idisp,itype,inewtype,ierr)
  call MPI_TYPE_EXTENT(inewtype,iextent,ierr)
  write(6,*)'newtype extent = ',iextent  
  call MPI_TYPE_COMMIT(inewtype,ierr)

    itag = 1
    dispGather = 0

  do j = 1, 2
     if ( j == 2 ) then
! Gather
        call MPI_GATHERV(xyzBuffer,1,inewtype,xyz,1, dispGather,inewtype,0,icomm,ierr)
! Isend Irecv 
        if ( iproc == 1 ) then
           call MPI_ISEND(xyz,1,inewtype,1,itag,icomm,isend,ierr)
           write(6,*)'end send'
           call MPI_WAIT(isend,istatus,ierr)
        else if ( iproc == 0 ) then
           call MPI_IRECV(xyz,1,inewtype,0,itag,icomm,irecv,ierr)
           write(6,*)'end receive'
           call MPI_WAIT(irecv,istatus,ierr)
        end if
! Output 
     end if      
     call MPI_BARRIER(icomm,ierr)
     if ( iproc == 0 )write(6,*)'iproc = ',iproc
        if ( iproc == 0 ) write(6,*)xyz

     call MPI_BARRIER(icomm,ierr)
     if ( iproc == 1 )write(6,*)'iproc = ',iproc
        if ( iproc == 1 ) write(6,*)xyz
  end do

  call MPI_FINALIZE(ierr)
end program type_derived_gather 
```

当我使用 MPI_ISEND 和 MPI_IRECV 块运行时，程序挂起并且输出为：

```
 iproc =            0
           0           0           0           0           0           0           0           0           0
 end receive
 newtype extent =           36
 iproc =            1
           1           4           2           5           3           6          10          10          10
 end send 
```

当 MPI_GATHER 运行时，我收到带有输出的分段错误：

```
 newtype extent =           36
 iproc =            0
           0           0           0           0           0           0           0           0           0
 newtype extent =           36
 iproc =            1
           1           4           2           5           3           6          10          10          10
 newtype extent =           36
 newtype extent =           36
 newtype extent =           36
 newtype extent =           36
 newtype extent =           36
 newtype extent =           36
[west0302:17101] *** Process received signal ***
[west0302:17101] Signal: Segmentation fault (11)
[west0302:17101] Signal code: Address not mapped (1)
[west0302:17101] Failing at address: 0x7ff2c8d1ddc0
[west0302:17101] [ 0] /lib64/libpthread.so.0 [0x3d3540eb70]
[west0302:17101] [ 1] /lib64/libc.so.6(memcpy+0xe1) [0x3d3487c321]
[west0302:17101] [ 2] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi.so.0(ompi_convertor_unpack+0x153) [0x2acd5f392093]
[west0302:17101] [ 3] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib/openmpi/mca_pml_ob1.so(mca_pml_ob1_recv_request_progress+0x7d1) [0x2acd6423dd91]
[west0302:17101] [ 4] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib/openmpi/mca_pml_ob1.so [0x2acd6423a4c7]
[west0302:17101] [ 5] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib/openmpi/mca_btl_sm.so(mca_btl_sm_component_progress+0xde2) [0x2acd64ca81c2]
[west0302:17101] [ 6] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib/openmpi/mca_bml_r2.so(mca_bml_r2_progress+0x2a) [0x2acd6444504a]
[west0302:17101] [ 7] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libopen-pal.so.0(opal_progress+0x4a) [0x2acd5f84a9ba]
[west0302:17101] [ 8] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib/openmpi/mca_pml_ob1.so(mca_pml_ob1_recv+0x2b5) [0x2acd64238565]
[west0302:17101] [ 9] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib/openmpi/mca_coll_basic.so(mca_coll_basic_gatherv_intra+0x14a) [0x2acd650bb37a]
[west0302:17101] [10] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi.so.0(MPI_Gatherv+0x1b0) [0x2acd5f3a4170]
[west0302:17101] [11] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi_f77.so.0(mpi_gatherv__+0x134) [0x2acd5f142784]
[west0302:17101] [12] ./type_derived_gather.x(MAIN__+0x342) [0x401742]
[west0302:17101] [13] ./type_derived_gather.x(main+0xe) [0x403fee]
[west0302:17101] [14] /lib64/libc.so.6(__libc_start_main+0xf4) [0x3d3481d994]
[west0302:17101] [15] ./type_derived_gather.x [0x401349]
[west0302:17101] *** End of error message *** 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-19T13:51:04.920

是的，您当然可以这样做：您的代码挂在`MPI_Isend()`/上的问题`MPI_Irecv()`是您正在发送/接收错误的进程；您希望 1 发送到 0，0 发送到 1，而不是 1 发送到 1 和 0 从 0 接收。0 永远不会收到该幻像消息（因为它不存在），并且您正在挂起。

```
 if ( iproc == 1 ) then
       call MPI_ISEND(xyz,1,inewtype,1,itag,icomm,isend,ierr)
       write(6,*)'end send'
       call MPI_WAIT(isend,istatus,ierr)
    else if ( iproc == 0 ) then
       call MPI_IRECV(xyz,1,inewtype,0,itag,icomm,irecv,ierr)
       write(6,*)'end receive'
       call MPI_WAIT(irecv,istatus,ierr)
    end if 
```

应该

```
 if ( iproc == 1 ) then
       call MPI_ISEND(xyz,1,inewtype,0,itag,icomm,isend,ierr)
       call MPI_WAIT(isend,istatus,ierr)
    else if ( iproc == 0 ) then
       call MPI_IRECV(xyz,1,inewtype,1,itag,icomm,irecv,ierr)
       call MPI_WAIT(irecv,istatus,ierr)
    end if 
```

至于更大的问题，当然可以使用`MPI_Type_create_struct()`（注意，您应该使用这个更新的例程而不是`MPI_Create_struct()`Fortran 派生的数据类型。正如@elorenz 指出的那样，手动计算偏移量不仅乏味且容易出错，但可能不正确;编译器有很多自由来填充等，以实现有效的内存访问。在你的情况下，它可能会工作，因为它都是整数，但对于具有混合大小的字段的类型，你会遇到麻烦。

处理该问题的正确方法是使用`MPI_Get_address`为您计算字段偏移量；下面是一个完整的例子。

```
program type_derived_gather
  use iso_fortran_env
  use mpi
  implicit none
  integer :: ierr
  integer, parameter :: nfields=4
  integer :: iblock(nfields)
  integer(kind=MPI_ADDRESS_KIND) :: start, idisp(nfields)
  integer :: itype(nfields)
  integer :: inewtype
  integer :: nproc, iproc
  integer :: i

  type :: newXYZ
       integer :: id
       real(kind=real64) :: x, y, z
  end type

  type(newXYZ), dimension(:), allocatable :: allxyzs
  type(newXYZ) :: locxyz

  call MPI_INIT(ierr)
  call MPI_COMM_SIZE(MPI_COMM_WORLD,nproc,ierr)
  call MPI_COMM_RANK(MPI_COMM_WORLD,iproc,ierr)

  locxyz % x  = 1.d0*iproc
  locxyz % y  = 2.d0*iproc
  locxyz % z  = 3.d0*iproc
  locxyz % id = iproc

  if (iproc == 0) allocate(allxyzs(nproc))

  ! everyone builds the type

  iblock = 1

  itype(1)  = MPI_INTEGER
  itype(2:4)= MPI_DOUBLE_PRECISION

  call MPI_Get_address(locxyz,    start, ierr)
  call MPI_Get_address(locxyz%id, idisp(1), ierr)
  call MPI_Get_address(locxyz%x,  idisp(2), ierr)
  call MPI_Get_address(locxyz%y,  idisp(3), ierr)
  call MPI_Get_address(locxyz%z,  idisp(4), ierr)

  idisp = idisp - start

  call MPI_Type_create_struct(nfields,iblock,idisp,itype,inewtype,ierr)
  call MPI_Type_commit(inewtype,ierr)

  ! Now gather the structs

  print '(A,I3,A,I3,1X,3(F6.2,1X))', 'Rank ', iproc, ': locxyz = ', locxyz%id, locxyz%x, locxyz%y, locxyz%z

  call MPI_Gather(locxyz, 1, inewtype, allxyzs, 1, inewtype, 0, MPI_COMM_WORLD, ierr)

  if (iproc == 0) then
      print '(A,I3,A)', 'Rank ', iproc, ' has -- '
      do i=1, nproc
          print '(A,I3,A,I3,1X,3(F6.2,1X))', '    ', i, ': ', allxyzs(i)%id, allxyzs(i)%x, allxyzs(i)%y, allxyzs(i)%z
      enddo
      deallocate(allxyzs)
  end if

  call MPI_FINALIZE(ierr)

end program type_derived_gather 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T14:28:39.730

是的，它可以。但请确保在数据类型的定义中使用“序列”！否则，编译器可以在类型成员如何在内存中对齐方面采取一些自由度。这可能会导致复制缓冲区时出现一些乱码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T03:49:36.110

当然，您可以将 MPI_Gather（或其他集合）与派生数据类型一起使用。任何采用 MPI_Datatype 参数的 MPI 函数都可以与派生数据类型一起使用。如果您发布一个如何构造和使用派生数据类型的最小示例，我们可能会提供更好的帮助。

# mysql - SQL GROUP_CONCAT 返回不需要的 NULL

> ID：13113448
> 
> 赞同：0
> 
> 时间：2012-10-28T22:01:21.217
> 
> 标签：mysql, sql

我的 SQL 查询中有一个问题，到目前为止我无法解决...

```
SELECT `m` . * , `s`.`id` AS `user_id` ,
    CONCAT( s.firstname, s.lastname ) AS `name` ,
    `s`.`email` , `mu`.`status` , `r`.`id` AS `user_id` ,
    GROUP_CONCAT( r.firstname, r.lastname
SEPARATOR "," ) AS `name` , `r`.`email`
FROM `messages` AS `m`
INNER JOIN `users` AS `s` ON m.from = s.id
INNER JOIN `messages_users` AS `mu` ON m.id = mu.message_id
INNER JOIN `users` AS `r` ON r.id = mu.user_id
WHERE (
m.id = '183'
) 
```

我认为问题出在 GROUP_CONCAT 中。当确实找到匹配项时，它会正常工作。但是当什么都没有找到时，所有字段都返回 NULL。我希望它不返回任何行，而不是 NULL。该查询在使用 CONCAT 时有效，但我确实需要将所有名称组合在一行中，而不是多行。

# c# - 对于我必须连接到服务器的每个 Tcp 连接，我如何单独管理每个连接？

> ID：13113449
> 
> 赞同：1
> 
> 时间：2012-10-28T22:01:25.500
> 
> 标签：c#, .net, networking, tcp, client

假设我有一个侦听 TCP 端口的服务器（通过 TcpListener），并且我与该服务器有五个不同的连接（通过 TcpClient）。我将如何通过流向每个人发送信息而不向错误的客户提供错误的信息。
例如：
五个客户端都连接到服务器。我必须向客户端 1 发送消息“这是一条消息”，但我不想将该消息发送给客户端 2、3、4 和 5。我还想向客户端 3 发送消息“这是另一条消息”和 5 但不将该消息发送到客户端 1、2 和 4。
我究竟该如何做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:13:27.223

该类`TcpListener`具有方法[`AcceptSocket`](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.acceptsocket.aspx)和[`AcceptTcpClient`](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.accepttcpclient.aspx). 它们为连接到您服务器的每个客户端返回不同的`Socket`（或`TcpClient`）——您使用这些对象将数据发送到各个客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:20:14.657

接受 Socket 或调用 AcceptTcpClient 后，您可以使用端点区分它们。如果您想知道将什么发送到哪个端点，您应该使用它们的 IP 和/或连接来自的端口来区分它们。您可以参考这篇文章以了解如何[获取远程套接字端点的 IP 地址](https://stackoverflow.com/questions/1904160/getting-the-ip-address-of-a-remote-socket-endpoint)

[编辑：例如，您可以在此处](https://stackoverflow.com/questions/726115/how-can-i-send-data-over-the-internet-using-a-socket)查看如何发送/接收数据

# ios - 删除以编程方式创建的视图 iOS

> ID：13113451
> 
> 赞同：0
> 
> 时间：2012-10-28T22:01:44.980
> 
> 标签：ios, button, view

在我的游戏应用程序中，我使用 uibutton 以编程方式创建了一个视图。通过单击按钮，整个视图将被删除。但是我尝试使用“[polygonView removeFromSuperview];”删除视图都没有成功 例如。我想我需要先获取当前视图，但不知道如何做到这一点并在按钮方法中实现它。

这是代码：

```
- (void) addNewView {
    UIWindow *window = [UIApplication sharedApplication].keyWindow;

    UIView *polygonView = [[UIView alloc] initWithFrame: CGRectMake ( 60, 0, 900, 900)];
    polygonView.backgroundColor = [UIColor blueColor];

    polygonView.tag = 42;
    // [self playMovie];

    [window addSubview:polygonView];

    // [polygonView setHidden:NO];

    [polygonView release];

    UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];

    button.frame = CGRectMake(100, 170, 100, 30);

    [button setTitle:@"Click Me!" forState:UIControlStateNormal]; 

    [button addTarget:self action:@selector(buttonPressed) 
     forControlEvents:UIControlEventTouchUpInside];

    [polygonView addSubview:button];

    // NSLog(@"mike=%@ tag=%d",[[polygonView class] description], [polygonView tag]);

}

-(void)buttonPressed {
    NSLog(@"Button Pressed!");
    [polygonView removeFromSuperview];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:10:38.827

你需要掌握你的`polygonView`：

```
-(void)buttonPressed {
    UIView *polygonView = [[[[UIApplication sharedApplication] keyWindow] subviews] lastObject];
    [polygonView removeFromSubview];
} 
```

# installation - 安装 GLIB 时出现奇怪的错误

> ID：13113457
> 
> 赞同：2
> 
> 时间：2012-10-28T22:02:43.350
> 
> 标签：installation, glib

安装时`GLIB`出现此错误：

> 安装在 . ./install-sh -c -d '/usr/bin' /usr/bin/install -c glib-gettextize '/usr/bin' ./install-sh -c -d '/usr/local/share/glib -2.0/gettext' /usr/bin/install -c mkinstalldirs '/usr/local/share/glib-2.0/gettext' ./install-sh -c -d '/usr/lib/pkgconfig' /usr/bin/ install -c -m 644 glib-2.0.pc gobject-2.0.pc gmodule-2.0.pc gmodule-export-2.0.pc gmodule-no-export-2.0.pc gthread-2.0.pc gio-2.0.pc gio-unix -2.0.pc '/usr/lib/pkgconfig' 在 m4macros make[2] 中进行安装：对于 `install-exec-am' 无需执行任何操作。.././install-sh -c -d '/usr/local/share/aclocal' /usr/bin/install -c -m 644 glib-2.0.m4 glib-gettext.m4 gsettings.m4 '/usr/ local/share/aclocal' 在 glib GEN glib_probes.o 中进行安装 用法：

```
[-P provider [[ predicate ] action ]]
[-m [ provider: ] module [[ predicate ] action ]]
[-f [[ provider: ] module: ] func [[ predicate ] action ]]
[-n [[[ provider: ] module: ] func: ] name [[ predicate ] action ]]
[-i probe-id [[ predicate ] action ]] [ args ... ]

predicate -> '/' D-expression '/'
   action -> '{' D-statements '}'

-arch Generate programs and Mach-O files for the specified architecture

-a  claim anonymous tracing state
-A  generate plist(5) entries for anonymous tracing
-b  set trace buffer size
-c  run specified command and exit upon its completion
-C  run cpp(1) preprocessor on script files
-D  define symbol when invoking preprocessor
-e  exit after compiling request but prior to enabling probes
-f  enable or list probes matching the specified function name
-F  coalesce trace output by function
-h  generate a header file with definitions for static probes
-H  print included files when invoking preprocessor
-i  enable or list probes matching the specified probe id
-I  add include directory to preprocessor search path
-l  list probes matching specified criteria
-L  add library directory to library search path
-m  enable or list probes matching the specified module name
-n  enable or list probes matching the specified probe name
-o  set output file
-p  grab specified process-ID and cache its symbol tables
-P  enable or list probes matching the specified provider name
-q  set quiet mode (only output explicitly traced data)
-s  enable or list probes according to the specified D script
-S  print D compiler intermediate code
-U  undefine symbol when invoking preprocessor
-v  set verbose mode (report stability attributes, arguments)
-V  report DTrace API version
-w  permit destructive actions
-x  enable or modify compiler and tracing options
-Z  permit probe descriptions that match zero probes 
```

> make[1]: *** [glib_probes.o] 错误 2 make: *** [install-recursive] 错误 1

编辑：按照尼尔森的建议后，这个错误出现了，接近尾声：

```
gclosure.c:29:17: error: ffi.h: No such file or directory
gclosure.c:1128: error: expected '=', ',', ';', 'asm' or '__attribute__' before '*' token
gclosure.c: In function 'value_from_ffi_type':
gclosure.c:1217: error: 'ffi_arg' undeclared (first use in this function)
gclosure.c:1217: error: (Each undeclared identifier is reported only once
gclosure.c:1217: error: for each function it appears in.)
gclosure.c:1217: error: 'int_val' undeclared (first use in this function)
gclosure.c:1217: error: expected expression before ')' token
gclosure.c: At top level:
gclosure.c:1296: error: expected '=', ',', ';', 'asm' or '__attribute__' before '*' token
gclosure.c: In function 'g_cclosure_marshal_generic':
gclosure.c:1391: error: 'ffi_type' undeclared (first use in this function)
gclosure.c:1391: error: 'rtype' undeclared (first use in this function)
gclosure.c:1394: error: 'atypes' undeclared (first use in this function)
gclosure.c:1397: error: 'ffi_cif' undeclared (first use in this function)
gclosure.c:1397: error: expected ';' before 'cif'
gclosure.c:1405: warning: implicit declaration of function 'value_to_ffi_type'
gclosure.c:1409: error: 'ffi_type_void' undeclared (first use in this function)
gclosure.c:1412: error: 'ffi_arg' undeclared (first use in this function)
gclosure.c:1415: error: expected expression before ')' token
gclosure.c:1427: error: 'ffi_type_pointer' undeclared (first use in this function)
gclosure.c:1451: warning: implicit declaration of function 'ffi_prep_cif'
gclosure.c:1451: error: 'cif' undeclared (first use in this function)
gclosure.c:1451: error: 'FFI_DEFAULT_ABI' undeclared (first use in this function)
gclosure.c:1451: error: 'FFI_OK' undeclared (first use in this function)
gclosure.c:1454: warning: implicit declaration of function 'ffi_call'
gclosure.c: In function 'g_cclosure_marshal_generic_va':
gclosure.c:1469: error: 'ffi_type' undeclared (first use in this function)
gclosure.c:1469: error: 'rtype' undeclared (first use in this function)
gclosure.c:1472: error: 'atypes' undeclared (first use in this function)
gclosure.c:1476: error: 'ffi_cif' undeclared (first use in this function)
gclosure.c:1476: error: expected ';' before 'cif'
gclosure.c:1489: error: 'ffi_type_void' undeclared (first use in this function)
gclosure.c:1492: error: 'ffi_arg' undeclared (first use in this function)
gclosure.c:1495: error: expected expression before ')' token
gclosure.c:1504: error: 'ffi_type_pointer' undeclared (first use in this function)
gclosure.c:1525: warning: implicit declaration of function 'va_to_ffi_type'
gclosure.c:1547: error: 'cif' undeclared (first use in this function)
gclosure.c:1547: error: 'FFI_DEFAULT_ABI' undeclared (first use in this function)
gclosure.c:1547: error: 'FFI_OK' undeclared (first use in this function)
make[3]: *** [libgobject_2_0_la-gclosure.lo] Error 1
make[2]: *** [install-recursive] Error 1
make[1]: *** [install] Error 2
make: *** [install-recursive] Error 1 
```

编辑：决定`PKG_CONFIG_PATH`在我的用户中添加到 bash .profile。不工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:18:23.800

似乎找不到`dtrace`命令，并且根据[glib 构建](http://developer.gnome.org/glib/2.28/glib-building.html)文档：

> *   对 DTrace 的可选支持需要 sys/sdt.h 标头，该标头由 Linux 上的 SystemTap 提供。要在没有 DTrace 的情况下构建 GLib，请使用 --disable-dtrace 配置选项。
>     
>     
> *   可以使用 --disable-systemtap 配置选项禁用对 SystemTap 的可选支持。

因此，如果您对 SystemTap 支持不感兴趣，只需在运行时禁用它`configure`，如下所示：

```
configure --disable-dtrace  --disable-systemtap 
```

# java - 修改共享 BlockingQueue 的 2 个线程的意外输出

> ID：13113460
> 
> 赞同：1
> 
> 时间：2012-10-28T22:03:05.277
> 
> 标签：java, multithreading

我有以下几点：

```
public class ProducerConsumer {

  private BlockingQueue<Integer> q;
  private Random rnd;
  private boolean run;

  public ProducerConsumer(){
    rnd = new Random();
    q = new ArrayBlockingQueue<>(10);
    run = true;
  }

  // high leve - with ArrayBlockingQueue

  public void QProducer() throws InterruptedException{       
    int i;
    while(run){
        i  = rnd.nextInt(100);

        q.put(i);
        System.out.println(i +" Added. Size is: "+ q.size());
    }
  } 

  public void  QConsumer() throws InterruptedException{
    int i;
    while(run){
      Thread.sleep(100);
      if (rnd.nextInt(10) == 0) {

          i = q.take();
          System.out.println(i + " Taken. Size is: "+ q.size());
      }
    }
  }

public void changeRun(){
    run = false;
 }    
} 
```

* * *

```
 public static void main(String[] args) throws InterruptedException {

    // Producer Consumer

    final ProducerConsumer pc = new ProducerConsumer();

    Thread t1 = new Thread(new Runnable() {

        @Override
        public void run() {
            try {
                pc.QProducer();
            } catch (InterruptedException ex) {
                Logger.getLogger(Threading.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    });

    Thread t2 = new Thread(new Runnable() {

        @Override
        public void run() {
            try {
                pc.QConsumer();
            } catch (InterruptedException ex) {
                Logger.getLogger(Threading.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    });

    t1.start();
    t2.start();

    Scanner scn = new Scanner(System.in);

    scn.nextLine();
    pc.changeRun();

    t1.join();
    t2.join();

} 
```

输出：

```
20 Added. Size is: 1
8 Added. Size is: 2
71 Added. Size is: 3
72 Added. Size is: 4
61 Added. Size is: 5
97 Added. Size is: 6
6 Added. Size is: 7
64 Added. Size is: 8
58 Added. Size is: 9
27 Added. Size is: 10
20 Taken. Size is: 10 *
93 Added. Size is: 10
8 Taken. Size is: 9
95 Added. Size is: 10
71 Taken. Size is: 10 *
70 Added. Size is: 10
72 Taken. Size is: 10 *
85 Added. Size is: 10
61 Taken. Size is: 9
43 Added. Size is: 10
64 Added. Size is: 10 **
... 
```

我想知道如何获取数字，但大小保持不变（ * ），以及在 Queue 已满（ ** ）后添加 howcome 值。AFAIU，BlockingQueue 是同步的，如果队列为空，则等待添加值，如果队列满则将其删除。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:12:15.390

由于多线程，the and `put()`the after it`println/size()`和 the `take()`and the `println/size()`after it 可以交错。所以返回的值`size()`在打印时可能已经过时了。例如

```
1a. Add (size = 10)
  1b. Print size 10
2a. Take (size = 9)
3a. Add (size = 10)
  2b. Print size 10
  3b. Print size 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:11:16.857

由于您没有`synchronized`块，因此您的`put`操作不是`size`查询的原子操作。在这两者之间，其他线程可能会发生任何数量的动作——并且已经发生了，正如你所看到的那样。

# java - Bash 多输入 Java 测试器

> ID：13113462
> 
> 赞同：2
> 
> 时间：2012-10-28T22:03:10.590
> 
> 标签：java, linux, bash, unix

我目前正在尝试制作一个 bash 测试脚本，它将...

1）进入多人文件夹

2）编译他们的两个java文件

3) 对编译后的结果运行两个快速测试，并将输出发送到要保存在其文件夹中的文件

4) 取这四个结果文件的结果，并将它们转储到一个结果文件中，顶部有一个模板供我输入结果

...我目前已经完成了大部分工作。我唯一的问题是他们的程序要求输入几行，例如......

输入编号 1：

输入编号 2：

输入数字 3：

...等等，我不知道如何让它继续输入他们的程序。在我的 bash 文件中进行硬编码输入后是否需要 EOF？这是我到目前为止...

```
#! /bin/bash

for i in $(find . -maxdepth 1 -type d)
do

    pwd
    pushd "$i"
    pwd

    if [ -f "First.java" ];
    then
        javac -cp . First.java
        echo easyFirst.txt | java -cp . First - > easyFirstResult
        echo hardFirst.txt | java -cp . First - > hardFirstResult
    fi

    if [ -f "Second.java" ];
    then
        javac -cp . Second.java
        echo easySecond | java -cp . Second - > easySecondResult
        echo hardSecond | java -cp . Second - > hardSecondResult
    fi

    printf "easyFirstResult\t: \hardFirstResult\t: \easySecondResult\t: \hardSecondResult\t: " > lab5grade.txt

    popd

done 
```

PS 除了多行输入之外，一切都在工作，我有两个带有硬编码输入的文本文件来测试代码。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:01:52.127

我看到类似的命令

```
echo easyFirst.txt | java -cp . First - > easyFirstResult 
```

显然为java程序提供了一行输入；但是`echo`这样的命令不会传输文件内容，它们只是将“easyFirst.txt”之类的文本复制到标准输出。要将文件 easyFirst.txt 的内容通过管道传输到 First，请使用类似的命令

```
java -cp . First - < easyFirst.txt > easyFirstResult 
```

（注意，上面假设 classpath is `.`， class is `First`，并且`-`是 First 的一个无法解释的命令行参数。）

# html - 没有 JavaScript/CSS 的滑块/幻灯片 HTML 代码

> ID：13113464
> 
> 赞同：0
> 
> 时间：2012-10-28T22:03:26.343
> 
> 标签：html, slider, slideshow

我想在侧边栏的 Wordpress.com 博客上添加一个滑块（如下所示：[http](http://www.menucool.com/javascript-image-slider) ://www.menucool.com/javascript-image-slider ），而不更改我的主题。但是，我不允许使用 Javascript 或 CSS。有没有办法可以写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:38:21.443

看起来您使用的 HTML 编辑器不允许您编写自己的 javascript。提供“主题”的编辑器易于使用，但不能保护/维持其“主题”属性/外观免受 javascript 和 CSS 代码的影响。因此，大多数互联网编辑都不允许这样做。它们仅提供“主题”可以处理的某些对象。

由于大部分主题是在 CSS 属性中定义的，如果主题创建者提供文档并允许用户输入 CSS 会改变实际的主题声明，那就太好了。JavaScript 和 CSS 很容易使主题失效。由于任何更改，看似“功能性”的 CSS 和/或 JavaScript 代码可能会突然破坏主题。为任何一个提供功能和文档都需要保留主题版本，以便所选主题可以继续与您的 JavaScript 和 CSS 一起正常运行。换句话说...如果编辑器提供者调整了主题，那么您的功能主题/CSS/JavaScript 组合很容易变得无效，并且会出现调用投诉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:07:23.417

如果您不允许使用 jQuery，那么 Flash 对象将是 IMO 的唯一选择。

# function - 如何在 Drupal 中覆盖非主题功能

> ID：13113466
> 
> 赞同：1
> 
> 时间：2012-10-28T22:03:30.283
> 
> 标签：function, drupal, drupal-7, overriding

我需要更改指示我的搜索表单行为的函数。我希望文本是“GO”而不是“Search”，输入类型是搜索而不是文本。

现在，我已经通过编辑 search.module 完成了这项工作，但有没有更方便的方法？我希望主题是 1 包交易并准备就绪，而不必编辑 Drupal 安装中的其他文件。

适用于 Drupal v.7.16

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T01:38:36.120

在主题的 template.php 中，您可以通过实现 MYTHEME_form_alter 覆盖搜索表单的任何部分。

对于您的示例，它可能看起来像这样：

```
function MYTHEME_form_alter(&$form, &$form_state, $form_id) {
    if ($form_id == 'search_block_form') {
        // Change form submit text
        $form['actions']['submit']['#value'] = t('GO!');

        // Change type to 'search'
        $form['search_block_form']['#type'] = 'search';
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T17:43:15.017

有关 Tanis 解决方案的更多背景信息，请参阅[hook_form_alter()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_alter/7)和[hook_form_FORM_ID_alter()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_FORM_ID_alter/7)的 API 文档。

# c# - 仅将 BindingList 的某些属性绑定到 DataGrid

> ID：13113467
> 
> 赞同：4
> 
> 时间：2012-10-28T22:03:32.443
> 
> 标签：c#, wpf, mvvm, wpfdatagrid

一些背景：

```
public class Base
{
    public string A { get; set; }
    public double B { get; set; }
    public DateTime C { get; set; }
    public string D { get; set; }
}

public class DerivedClass : Base
{
    public string E { get; set; }
    public List<string> F { get; set; }
    public List<string> G { get; set; }
    public Image H { get; set; }
} 
```

Base 类用作其他几个具有共同属性的类的基础。派生类添加特定于该派生类的属性。

在我的视图中，我有一个绑定到我的 DataGrid`DerivedClassViewModel`的`BindingList<DerivedClass>`：

```
<DataGrid Margin="318,0,0,0" ItemsSource="{Binding BindingList}"> 
```

这很好用，我可以在 BindingList 中添加和删除项目，DataGrid 会自动更新以反映这一点。但是，有几个我不想在 DataGrid 中显示的`DerivedClass`属性（例如）。**如何在仍在使用的同时仅将 DerivedClass 的某些属性绑定到 DataGrid** **？**`List<string> F/H`**`BindingList<DerivedClass>`**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T09:11:19.037

您必须在 DataGrid 上禁用 AutoGenerateColumns 并明确定义列[http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.columns(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.columns(v=vs.100).aspx)，或使用 AutoGeneratingColumn 事件丢弃您不想要的列[http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.autogeneratingcolumn(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.autogeneratingcolumn(v=vs.100).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:16:51.770

@see [BindingList(IList)](http://msdn.microsoft.com/en-us/library/ms132679.aspx)（“构造函数”下的第二项）

# javascript - 在 Dojo 1.8 中实现以编程方式创建的接口

> ID：13113468
> 
> 赞同：1
> 
> 时间：2012-10-28T22:03:35.333
> 
> 标签：javascript, dojo, dijit.layout

如果我希望使用 Dojo 1.8 dijits、面板等来实现一个有凝聚力的单一界面概念，以包含在页面或其他 RIA 接口中，那么构建实现的最佳方式是什么？

让我们以一个简单的登录框为例。这将是一个包含两个文本框和一个按钮的面板。我**不会**使用声明性标记来创建布局，所以没有模板。

到目前为止，我采用的潜在方法是：

*   扩展我希望使用的面板类型，然后参与 dijit 生命周期以确保它填充了控件。
*   扩展 Form 类并与最后一点类似。
*   创建一个简单的对象，它只是将所有东西放在一起并接受一个 DOM 节点来爆炸。
*   ？？？- 我不确定还有其他选择。

问题：

*   事件处理程序将去哪里以及如何处理？
*   当我在页面上以及可能在其他 RIA 接口中使用封装的接口时，我将使它必须尽可能“dojo-ey”什么样的构造函数。

免责声明：虽然我认识到 Dojo 试图不影响这些类型的决策，但我觉得在它自己的 API 中，有一些关于如何最好地利用小部件生命周期和类库的意义或机会。从而确保我的创作与其他 Dojo 小部件一样兼容。

# while-loop - 如何防止布尔while循环中的无限循环？

> ID：13113471
> 
> 赞同：-1
> 
> 时间：2012-10-28T22:03:42.443
> 
> 标签：while-loop, boolean, infinite-loop

我有这样的代码：

```
maybeYes = raw_input("Please enter Yes to continue.")
    if maybeYes != "Yes":
        print "Try again."
        # ask for input again
    else:
        pass 
```

在我想让它再次要求输入的地方填写什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:07:50.773

您应该直接在循环中执行 raw_input 。

```
while True:
    result = raw_input("...")
    if result != "Yes":
        print "Try again."
        continue
    else:
        break 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:15:00.633

这将循环打印`wrong`，直到用户键入`yes`, `Yes`, `YEs`, `YES`,`yEs`或者`yeS`在检查之前将输入转换为全大写`YES`，然后您的代码可以继续...

```
while raw_input("Please enter Yes to start: ").upper() != 'YES':
       print 'Wrong'

print 'Correct'

#Carry on here 
```

输出：

```
Please enter Yes to start: nowg
Wrong
Please enter Yes to start: wggwe
Wrong
Please enter Yes to start: Yes
Correct 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T22:09:23.707

在我看来你想要一个无限循环。

```
maybeYes = raw_input("Please enter Yes to continue.")
while maybeYes != "Yes":
    maybeYes = raw_input("Please try again.") 
```

但是，您始终可以添加计数器/转义。

```
maybeYes = raw_input("Please enter Yes to continue.")
attempts = 0
while maybeYes != "Yes" and attempts < 10:
    maybeYes = raw_input("Please try again.")
    attempts += 1 
```

# symfony - 实体之间的可选 OneToOne 关系？

> ID：13113481
> 
> 赞同：2
> 
> 时间：2012-10-28T22:05:06.880
> 
> 标签：symfony, doctrine-orm

我有一个用户实体。在这种情况下，这被认为是主要实体，并且它被使用的事实意味着它存在。

User 实体，有一个 Store 实体。但并非所有用户都必须拥有商店实体。

值得注意的是，这是我们正在使用的现有数据库，并且 User 表的 id 与 Store 表的 id 相同。名称 (id) 和值。只是在某些情况下，Store 没有给定 User id 的记录。

用户：

```
class User extends Entity
{
    /**
    * @ORM\Id
    * @ORM\Column(type="string", length=36)
    */
    protected $id;

    /**
    * @ORM\OneToOne(targetEntity="Store")
    * @ORM\JoinColumn(name="id", referencedColumnName="id")
    */
    protected $store;

    ...
} 
```

店铺：

```
class Store extends Entity
{
    /**
    * @ORM\Id
    * @ORM\Column(type="string", length=36)
    */
    protected $id;

    ...
} 
```

这会导致控制器出现问题。如果用户实体没有商店记录，它会失败并出现“找不到实体”异常。这可以使用足够简单的 try catch 来解决（我无法找到一种方法来检查 Entity 对象是否存在或只是一个代理）。如果用户**确实**有商店记录，那么这里一切都很好。

但我遇到的最大问题尤其是夹具：

```
protected function createUser($id)
{
    $user = new User();
    $user->setId($id);
    $user->setEmail($id.'@example.com');
    $user->setUserName($id.'_name');
    $user->setArea($this->manager->find('Area', 156)); // Global

    $this->manager->persist($user);

    return $user;
} 
```

当我运行 Fixtures 时，这会失败。给我错误“完整性约束违规：1048 列 'id' 不能为空”。如果我从用户中删除商店实体，此消息就会消失。所以简而言之，如果没有商店，我无法添加用户。

有谁知道发生了什么？我做了一些环顾四周，我找不到任何东西，包括教义文档，关于实体之间的可选关系。我认为这是一种常见的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T01:57:18.030

在此文档页面上找到了解决方案：

[http://docs.doctrine-project.org/en/latest/tutorials/composite-primary-keys.html#use-case-3-join-table-with-metadata](http://docs.doctrine-project.org/en/latest/tutorials/composite-primary-keys.html#use-case-3-join-table-with-metadata)

在我的例子中，不是使用 id 字段将 User 实体与 Store 实体关联，而是通过用户（实体对象）将 User 实体中的 store 属性关联到 Store 实体。作为回报，Store 对象将保存一个 User 实体，该实体被注释为实体的 id。

我敢肯定这会令人困惑，所以请看上面的示例。以下是我调整后的实体类：

用户

```
class User extends Entity
{
    /**
     * @ORM\Id
     * @ORM\Column(type="string", length=36)
     */
    protected $id;

    /** 
     * @ORM\OneToOne(targetEntity="Store", mappedBy="user") 
     */
    protected $store;

    ...
} 
```

店铺

```
class Store extends Entity
{
    /**
     * @ORM\Column(type="string", length=36)
     */
    protected $id;

    /**
     * @ORM\Id
     * @ORM\OneToOne(targetEntity="User")
     * @ORM\JoinColumn(name="id", referencedColumnName="id")
     */
    protected $user;

    ...
} 
```

现在，如果给定用户没有存储记录，则用户实体中的存储属性将为空。夹具也按预期运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-26T22:08:21.523

除了上面的答案，我还需要添加一个`inversedBy`属性。否则，将抛出无效的实体映射错误。

使用上面的实体，`Store`对象需要看起来像这样：

```
class Store extends Entity
{
/**
 * @ORM\Column(type="string", length=36)
 */
protected $id;

/**
 * @ORM\Id
 * @ORM\OneToOne(targetEntity="User", inversedBy="store")
 * @ORM\JoinColumn(name="id", referencedColumnName="id")
 */
protected $user;

...
} 
```

# python - Google API 在给定的 1 小时后插入事件

> ID：13113482
> 
> 赞同：0
> 
> 时间：2012-10-28T22:05:16.967
> 
> 标签：python, google-calendar-api, google-api-python-client

[我使用适用于 Python 客户端的 Google Calendar API](https://developers.google.com/google-apps/calendar/v2/developers_guide_python?hl=de)插入一个事件， 不知何故，时间比预期晚了 1 小时。

这是片段。进口：

```
import gdata.calendar.data
import gdata.calendar.client
import gdata.acl.data
import atom.data 
```

连接到 Google 日历：

```
calendar_client = gdata.calendar.client.CalendarClient(source='noApp')
calendar_client.ClientLogin('account@gmail.com', 'password', calendar_client.source) 
```

创建事件：

```
event = gdata.calendar.data.CalendarEventEntry()
date='2012-10-29T18:30:00.001Z' # This is the time of event that I want to insert
event.when.append(gdata.calendar.data.When(start=date)) 
```

最后，插入事件

```
new_event = calendar_client.InsertEvent(event) 
```

结果，我在日历中的时间是 10 月 29 日的 19:30，而不是 18:30。
我试图在日期变量中将时区更改为“000Z”而不是“001Z”，但这没有帮助。当然，我可以提前减去一个小时，但为什么会这样呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:11:06.523

`18:30:00.000Z`并`18:30:00.001Z`在同一时区给出，即`Z`UTC，但相隔一毫秒——因为`0`您更改为`1`时间戳的小数秒部分。

如果您想在 CET 而不是 UTC 中给出 API 时间，您可以尝试类似`2012-10-29T18:30:00+01:00`（如果 API 支持 RFC-3339 时间戳）。或者，如果这不起作用，请先将所需时间转换为 UTC。

# facebook - 用于无用户投票应用的 Facebook 访问令牌

> ID：13113486
> 
> 赞同：0
> 
> 时间：2012-10-28T22:06:15.313
> 
> 标签：facebook, access-token, facebook-access-token

我想编写一个应用程序，以特殊方式跟踪和显示特定 Facebook 页面上的事件。关键是该应用程序将在诸如俱乐部之类的环境中的显示器上运行，以吸引（物理）访问者到俱乐部的 facebook 演示文稿。普通的 facebook 布局不适合这种演示。

现在我被 facebook 登录 api 困扰。似乎只有浏览器可以登录，用户手动驱动流程。

我需要某种形式的非交互式登录 - 运行应用程序的机器上不会有任何用户。

有应用程序访问令牌，但出于某种原因，它是*只写的*。

我不想发布任何内容，我的应用程序是只读的。

据我所知，有诸如 Spotify 之类的应用程序可以与 facebook 交互，而无需一直向用户提供浏览器驱动的 facebook 登录。

所以我忽略了什么？

# c# - 显示用于调试 DLL 的控制台应用程序窗口

> ID：13113492
> 
> 赞同：3
> 
> 时间：2012-10-28T22:07:31.570
> 
> 标签：c#, .net, visual-studio-2010, .net-4.0, class-library

我们有一个扩展第 3 方应用程序的 DLL。我想让这个 DLL 在纯粹出于调试目的启动时打开一个控制台窗口。我知道使用 Windows 应用程序执行此操作的技巧（将输出类型更改为控制台应用程序）。有没有办法用类库做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:12:10.430

我建议使用[`System.Diagnostics`](http://msdn.microsoft.com/en-us/library/system.diagnostics.aspx)命名空间并使用[`Debug.*`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debug.aspx)/[`Trace.*`](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.aspx)方法。检索它只需使用您的 IDE 或（如果在另一个应用程序中运行）类似[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)的东西。

# java - Repaint() 没有在 Java 中调用paint()

> ID：13113498
> 
> 赞同：3
> 
> 时间：2012-10-28T22:08:52.380
> 
> 标签：java, swing, jpanel, repaint, graphics2d

首先让我说我知道我在这段混乱的代码中违反了一些基本的 Java 原则，但是我拼命地试图在周二之前完成一个程序来进行社会科学实验，而且我不懂 Java，所以我'我现在基本上只是在摸索。

有了这个免责声明，我有一个单独的程序在屏幕上移动一个圆圈，用户必须点击它。当它在自己的单独的类文件中时它工作正常，但是当我将代码添加到我的主程序时，它不再工作。我什至不明白为什么 repaint() 调用我的 paint() 函数——就我而言，这很神奇，但我注意到 repaint() 在我的测试程序中调用了 paint()，但在更复杂的实际程序，我认为这就是为什么圆圈不再在我的程序上绘制的原因。

完整代码如下：

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import javax.swing.*;
import java.awt.event.*;
import java.awt.geom.Ellipse2D;
import java.io.FileReader;
import java.io.IOException;
import java.util.Calendar;

public class Reflexology1 extends JFrame{

private static final long serialVersionUID = -1295261024563143679L;
private Ellipse2D ball = new Ellipse2D.Double(0, 0, 25, 25);
private Timer moveBallTimer;
int _ballXpos, _ballYpos;
JButton button1, button2;
JButton movingButton;
JTextArea textArea1;
int buttonAClicked, buttonDClicked;
private long _openTime = 0;
private long _closeTime = 0;
JPanel thePanel = new JPanel();
JPanel thePlacebo = new JPanel();
final JFrame frame = new JFrame("Reflexology");
final JFrame frame2 = new JFrame("The Test");
JLabel label1 = new JLabel("Press X and  then click the moving dot as fast as you can.");

public static void main(String[] args){
    new Reflexology1();
}

public Reflexology1(){
    frame.setSize(600, 475);
    frame.setLocationRelativeTo(null);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setTitle("Reflexology 1.0");
    frame.setResizable(false);

    frame2.setSize(600, 475);
    frame2.setLocationRelativeTo(null);
    frame2.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame2.setTitle("Reflexology 1.0");
    frame2.setResizable(false);

    button1 = new JButton("Accept");
    button2 = new JButton("Decline");
    //movingButton = new JButton("Click Me");

    ListenForAcceptButton lForAButton = new ListenForAcceptButton();
    ListenForDeclineButton lForDButton = new ListenForDeclineButton();
    button1.addActionListener(lForAButton);
    button2.addActionListener(lForDButton);
    //movingButton.addActionListener(lForMButton);

    JTextArea textArea1 = new JTextArea(24, 50);

    textArea1.setText("Tracking Events\n");
    textArea1.setLineWrap(true);
    textArea1.setWrapStyleWord(true);
    textArea1.setSize(15, 50);
    textArea1.setEditable(false);

    FileReader reader = null;
    try {
        reader = new FileReader("EULA.txt");
        textArea1.read(reader, "EULA.txt");
    } catch (IOException exception) {
        System.err.println("Problem loading file");
        exception.printStackTrace();
    } finally {
        if (reader != null) {
            try {
                reader.close();
            } catch (IOException exception) {
                System.err.println("Error closing reader");
                exception.printStackTrace();
            }
        }

    }

    JScrollPane scrollBar1 = new JScrollPane(textArea1, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
    AdjustmentListener listener = new MyAdjustmentListener();

    thePanel.add(scrollBar1);
    thePanel.add(button1);
    thePanel.add(button2);

    frame.add(thePanel);
    ListenForMouse lForMouse = new ListenForMouse();
    thePlacebo.addMouseListener(lForMouse);
    thePlacebo.add(label1);
    frame2.add(thePlacebo);

    ListenForWindow lForWindow = new ListenForWindow();
    frame.addWindowListener(lForWindow);
    frame2.addKeyListener(new KeyAdapter() {
        public void keyPressed(KeyEvent e){
            if(e.getKeyChar() == 'X' || e.getKeyChar() == 'x') {moveBallTimer.start();}
        }
    });
    frame.setVisible(true);

       moveBallTimer = new Timer(1000, new ActionListener() {
           public void actionPerformed(ActionEvent e) {
           moveBall();
           System.out.println("Timer started!");
           repaint();
          }
        });

        addKeyListener(new KeyAdapter() {
          public void keyPressed(KeyEvent e) {
                if(frame2.isVisible()){ moveBallTimer.start(); }
          }
        });

}

private class ListenForAcceptButton implements ActionListener{
    public void actionPerformed(ActionEvent e){
        if (e.getSource() == button1){
            Calendar ClCDateTime = Calendar.getInstance();
            System.out.println(ClCDateTime.getTimeInMillis() - _openTime);
            _closeTime = ClCDateTime.getTimeInMillis() - _openTime;
            //frame.getContentPane().remove(thePanel);
            //thePlacebo.addKeyListener(lForKeys);
            //frame.getContentPane().add(thePlacebo);

            //frame.repaint();
            //moveBallTimer.start();
            frame.setVisible(false);
            frame2.setVisible(true);
            frame2.revalidate();
            frame2.repaint();

            }
        }
    }

private class ListenForDeclineButton implements ActionListener{
    public void actionPerformed(ActionEvent e){
        if (e.getSource() == button2){
            JOptionPane.showMessageDialog(Reflexology1.this, "You've declined the license agreement. DO NOT RESTART  the program. Please go inform a researcher that you have declined the agreement.", "WARNING", JOptionPane.INFORMATION_MESSAGE);
            System.exit(0);
        }
    }
}

private class ListenForWindow implements WindowListener{

    public void windowActivated(WindowEvent e) {
            //textArea1.append("Window is active");

    }

    // if this.dispose() is called, this is called:
    public void windowClosed(WindowEvent arg0) {

    }

    // When a window is closed from a menu, this is called:
    public void windowClosing(WindowEvent arg0) {

    }

    // Called when the window is no longer the active window:
    public void windowDeactivated(WindowEvent arg0) {
        //textArea1.append("Window is NOT active");

    }

    // Window gone from minimized to normal state
    public void windowDeiconified(WindowEvent arg0) {
        //textArea1.append("Window is in normal state");

    }

    // Window has been minimized
    public void windowIconified(WindowEvent arg0) {
        //textArea1.append("Window is minimized");

    }

    // Called when the Window is originally created
    public void windowOpened(WindowEvent arg0) {
        //textArea1.append("Let there be Window!");
        Calendar OlCDateTime = Calendar.getInstance();
         _openTime = OlCDateTime.getTimeInMillis();
        //System.out.println(_openTime);

    }

}

private class MyAdjustmentListener implements AdjustmentListener {

    public void adjustmentValueChanged(AdjustmentEvent arg0) {
        AdjustmentEvent scrollBar1;
        //System.out.println(scrollBar1.getValue()));

    }

}

  public void paint(Graphics g) {
        //super.paint(g);
          frame2.paint(g);
        Graphics2D g2d = (Graphics2D) g;
        g2d.setColor(Color.RED);
        g2d.fill(ball);
        System.out.println("Calling fill()");
      }

  protected void moveBall() {
        //System.out.println("I'm in the moveBall() function!");
        int width = getWidth();
        int height = getHeight();
        int min, max, randomX, randomY;
        min =200;
        max = -200;
        randomX = min + (int)(Math.random() * ((max - min)+1));
        randomY = min + (int)(Math.random() * ((max - min)+1));
       //System.out.println(randomX + ", " + randomY);

        Rectangle ballBounds = ball.getBounds();
        //System.out.println(ballBounds.x + ", " + ballBounds.y);
        if (ballBounds.x + randomX < 0) {
            randomX = 200;
        } else if (ballBounds.x + ballBounds.width + randomX > width) {
            randomX = -200;
        }
        if (ballBounds.y + randomY < 0) {
            randomY = 200;
        } else if (ballBounds.y + ballBounds.height + randomY > height) {
            randomY = -200;
        } 

        ballBounds.x += randomX;
        ballBounds.y += randomY;
        _ballXpos = ballBounds.x;
        _ballYpos = ballBounds.y;
        ball.setFrame(ballBounds);
      }

      public void start() {
        moveBallTimer.start();
      }

      public void stop() {
        moveBallTimer.stop();
      }

      private class ListenForMouse implements MouseListener{

            // Called when the mouse is clicked
            public void mouseClicked(MouseEvent e) {
                //System.out.println("Mouse Panel pos: " + e.getX() + " " + e.getY() + "\n");
                if (e.getX() >=_ballXpos && e.getX() <= _ballXpos + 25 && e.getY() <=_ballYpos && e.getY() >= _ballYpos - 25 ) { 
                    System.out.println("TRUE"); 
                }
            System.out.println("{e.getX(): " + e.getX() + " / " + "_ballXpos: " + _ballXpos + " | " +  "{e.getY(): " + e.getY() + " / " + "_ballYpos: " + _ballYpos);

            }

            public void mouseEntered(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

            public void mouseExited(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

            public void mousePressed(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

            public void mouseReleased(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }
                }
            //    System.out.println("e.getX(): " + e.getX() + " / " + "_ballXpos: " + _ballXpos);

            // Mouse over
            public void mouseEntered(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

            // Mouse left the mouseover area:
            public void mouseExited(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

            public void mousePressed(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

            public void mouseReleased(MouseEvent arg0) {
                // TODO Auto-generated method stub

            }

    } 
```

谁能告诉我我需要做什么才能让 repaint() 调用上述程序中的 paint() 方法？我假设多个帧导致了问题，但这只是一个猜测。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T22:16:32.033

你不应该直接在`JFrame`. 或应使用`JPanel`的扩展名。`JComponent`用于绘画覆盖`paintComponent()`而不是`paint()`. 别忘了打电话`super.paintComponent(g);`。

另外，请记住，`repaint()`仅计划组件更新，它不会立即触发`paint()`。

有关更多详细信息，请参阅[在 AWT 和 Swing 中](http://www.oracle.com/technetwork/java/painting-140037.html)[执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)和绘画。

例如，您可以应用以下更改。`TestPanel`将给球上色。

```
class TestPanel extends JPanel {
    @Override
  public void paintComponent(Graphics g) {
        super.paintComponent(g);

        Graphics2D g2d = (Graphics2D) g;
        g2d.setColor(Color.RED);
        g2d.fill(ball);
      }
} 
```

然后，更新`thePlacebo`面板：

```
JPanel thePlacebo = new TestPanel(); 
```

添加重绘`moveBall()`：

```
thePlacebo.repaint(); 
```

这是一个基于原始代码的示例：

```
package so;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.geom.Ellipse2D;
import java.util.Random;

import javax.swing.*;

public class TestBall {
    private static void createAndShowUI() {
        final TestPanel panel = new TestPanel();
        panel.validate();
        JFrame frame = new JFrame("TestBall");
        frame.getContentPane().add(panel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(new Dimension(300, 300));
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);

        ActionListener timerAction = new ActionListener() {
            public void actionPerformed(ActionEvent evt) {
                panel.moveBall();
            }
        };
        Timer timer = new Timer(1000, timerAction);
        timer.setRepeats(true);
        timer.start();
    }

    static class TestPanel extends JPanel {
        public static int BALL_SIZE = 25;
        private Ellipse2D ball = new Ellipse2D.Double(0, 0, BALL_SIZE,
                BALL_SIZE);
        Random rand = new Random();

        public TestPanel() {
            this.addMouseListener(new MouseAdapter() {
                // Called when the mouse is clicked
                public void mouseClicked(MouseEvent e) {
                    if (ball.contains(e.getPoint())) {
                        System.out.println("hit the ball");
                    }
                }
            });
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g;
            g2d.setColor(Color.RED);
            g2d.fill(ball);
        }

        public void moveBall() {
            Rectangle ballBounds = ball.getBounds();
            ball.setFrame(ballBounds);
            ballBounds.x = rand.nextInt(getWidth() - BALL_SIZE + 1) + 1;
            ballBounds.y = rand.nextInt(getHeight() - BALL_SIZE + 1) + 1;
            ball.setFrame(ballBounds);
            repaint();
        }
    }

    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                createAndShowUI();
            }
        });
    }
} 
```

# lisp - lisp 中的定点组合器

> ID：13113500
> 
> 赞同：4
> 
> 时间：2012-10-28T22:09:18.960
> 
> 标签：lisp, scheme, combinators, y-combinator

```
;; compute the max of a list of integers

(define Y
  (lambda (w)
    ((lambda (f)
       (f f))
     (lambda (f)
       (w (lambda (x)
            ((f f) x)))))))

((Y
  (lambda (max)
    (lambda (l)
      (cond ((null? l) -1)
            ((> (car l) (max (cdr l))) (car l))
            (else (max (cdr l)))))))
 '(1 2 3 4 5)) 
```

我想了解这个结构。有人可以对此代码给出清晰简单的解释吗？

例如，假设我忘记了 Y 的公式。我怎么能记住它，并在我使用它很久之后重现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:21:04.360

到目前为止，我发现的最好的解释是在[“The Little Schemer”](https://rads.stackoverflow.com/amzn/click/com/0262560992)一书的第 9 章。整章逐步解释了 Y-Combinator 的工作原理，以及如何从任意递归过程中推导出组合子.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T10:25:10.743

这是一些相关的答案（由我）：

*   [“The Little Schemer”中的 Y 组合器讨论](https://stackoverflow.com/questions/10499514/y-combinator-discussion-in-the-little-schemer/11864862#11864862)
*   [无法实现 Y 组合器工作](https://stackoverflow.com/questions/11924832/unable-to-get-implementation-of-y-combinator-working/11925131#11925131)
*   [在 Scheme 中，如何使用 lambda 创建递归函数？](https://stackoverflow.com/questions/7719004/in-scheme-how-do-you-use-lambda-to-create-a-recursive-function/11833038#11833038)

基本上，将**Y**定义为`λr.(λh.h h) (λg.r (λx.(g g) x))`，应用程序`Y r`减少为

```
Y r
(λw.(λh.h h) (λg.w (λx.(g g) x))) r
(λh.h h) (λg.r (λx.(g g) x))
h h
    ;where
        h = (λg.r (λx.(g g) x))       <----\
                                           |
(λg.r (λx.(g g) x)) h                      |
r (λx.(g g) x)             <-------------- | ----------\
    ;where                                 |           |
        g = h                         -----/           |
        ;so that                                       |
        (g g) = (h h) = r (λx.(g g) x)           ------/ 
```

所以`r`必须期待两个参数 - 第一个表示要调用的递归函数，第二个 - 一个实际参数：

```
 r = λf (λx. ....x.....(f y)...... ) 
```

所以`(Y r) x` 减少为

```
(r (λx.(g g) x)) x
(r f) x
    ;where
        f   = (λx.(g g) x) 
        f y = (λx.(g g) x) y = (g g) y = (r f) y  ; f is "fixed point" of r 
```

定义的`f = (λx.(g g) x)`意思是，当`f y`被调用时，`(g g) y`将被调用，*此时* `g`将被自我应用，`r`从内部“拉”，并且是带参数调用`g`的结果。即，由应用程序产生的 lambda 表达式主体中的任何调用都被转换回即使用新参数调用同一主体。`(r f)``y``(f y)``(r f)``(r f) y``y`

重要的实现细节是它是*相同*的函数体还是它的*副本*，但语义是相同的——我们可以使用新的参数值输入相同的函数体。

Y组合器的本质是引用复制和自我应用：我们通过同名引用同一事物*，*两次；因此我们安排*它*接受*自己*作为论据。

当没有引用时，如在纯 lambda 演算中，并且参数接收参数的文本副本 - 即通过文本重写完成缩减 - 这仍然有效，因为*相同的副本*被复制并传递，作为参数提供给 self 所以它是可用的如果需要，在下一次迭代中。

但是当共享引用可用时效率更高（所有*相同名称*的使用都引用*相同的东西*）。在环境模型下创建自引用函数的评价很简单：

```
(let ((fact #f)) 
  (set! fact 
        (lambda (n) (if (< 2 n) 1 
                               (* n (fact (- n 1)))))) 
  fact) 
```

* * *

实际上，您的答案中的定义是应用顺序 Y 组合器的定义。使用正常顺序，可以应用 eta-reduction 而不会导致无限循环，以获得`Ynorm = (λw.(λh.h h) (λg.w (g g)))`规范地写为

```
Ynorm = (λf.(λx.f (x x)) (λx.f (x x))) 
```

确实

```
Ynorm g
= (λx.g (x x)) (λx.g (x x))
= g ((λx.g (x x)) (λx.g (x x))) 
```

# actionscript-3 - ActionScript 3 中的 ExternalInterface 在脱机模式下不起作用

> ID：13113502
> 
> 赞同：1
> 
> 时间：2012-10-28T22:09:38.230
> 
> 标签：actionscript-3, flash, actionscript, externalinterface

我有问题。我制作了带有 JS 回调的 Flash 视频播放器，但是从本地磁盘执行页面时出现问题。闪退错误：

```
Error: Error #2067: ExternalInterface in this container not available.
    at Error$/throwError()
    at flash.external::ExternalInterface$/addCallback()
    at Player()[C:\Users\User\SkyDrive\Flash\MediaPlayer\Player.as:112]
    at MediaPlayer_fla::MainTimeline/frame1()[MediaPlayer_fla.MainTimeline::frame1:35] 
```

任何想法，如何使用 ExternalInterface 离线执行脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T09:53:28.713

我认为您应该在 Web 服务器上运行它以执行 ExternalInterface。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T09:06:23.033

1.  检查标签`allowScriptAccess`的属性。`<object>`将其设置为`always`。
2.  您是否从沙盒中执行您的页面？

# java - 如何使用 JButton 为 ActionEvent 创建 If 语句

> ID：13113505
> 
> 赞同：1
> 
> 时间：2012-10-28T22:09:55.183
> 
> 标签：java, if-statement, jbutton, actionlistener, joptionpane

如何仅显示属于用户按下的按钮的文本。截至目前，这段代码打开了所有显示其他按钮文本的窗口。我在想一个 IF 语句，但我不确定单击按钮时会输入什么。如果有人知道如何生成 if 语句对于单击的按钮，请分享信息。

第一课

```
import java.awt.Color;
import java.awt.Component;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BoxLayout;
import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;

@SuppressWarnings("serial")
public class rohwcg extends JFrame
{

// adds the buttons
private JButton minerbutton;
private JButton farmerbutton;
private JButton lumberjackbutton;
    private JButton blacksmithbutton;

public rohwcg()
{
    super ("Realms of Havenwood Class Guide");
    setLayout(new BoxLayout(getContentPane(), BoxLayout.Y_AXIS));
    setBackground(Color.GREEN);

    //miner button
    Icon mbutton = new ImageIcon (getClass() .getResource("miner.png"));
    minerbutton = new JButton(mbutton);
    add(minerbutton);

    //farmer button
    Icon fbutton = new ImageIcon (getClass() .getResource("farmer.png"));
    farmerbutton = new JButton(fbutton);
    add(farmerbutton);

    //lumberjack button
    Icon lbutton = new ImageIcon (getClass() .getResource("lumberjack.png"));
    lumberjackbutton = new JButton(lbutton);
    add(lumberjackbutton);

    //blacksmith button
    Icon bbutton = new ImageIcon (getClass() .getResource("blacksmith.png"));
    blacksmithbutton = new JButton(bbutton);
    add(blacksmithbutton);

    //the action of the button.
    HandlerClass handler = new HandlerClass();
    minerbutton.addActionListener(handler);
    farmerbutton.addActionListener(handler);
    lumberjackbutton.addActionListener(handler);
    blacksmithbutton.addActionListener(handler);

    //sets the position of the button to center.
    blacksmithbutton.setAlignmentX(Component.CENTER_ALIGNMENT);
    minerbutton.setAlignmentX(Component.CENTER_ALIGNMENT);
    lumberjackbutton.setAlignmentX(Component.CENTER_ALIGNMENT);
    farmerbutton.setAlignmentX(Component.CENTER_ALIGNMENT);    
}

private class HandlerClass implements ActionListener
{
    //what happens when you click the button, below.
    public void actionPerformed(ActionEvent event)
    {           
        //farmer
        String farmertext = "null farmer";  
        JOptionPane.showMessageDialog(farmerbutton,farmertext,"The Farmer Class",JOptionPane.PLAIN_MESSAGE);

        //miner
        String minertext = "null miner";
        JOptionPane.showMessageDialog(minerbutton,minertext, "The Miner Class", JOptionPane.PLAIN_MESSAGE);

        //blacksmith
        String blacksmithtext ="null blacksmith";
        JOptionPane.showMessageDialog(blacksmithbutton,blacksmithtext, "The BlackSmith Class", JOptionPane.PLAIN_MESSAGE);

        //lumberjack
        String lumberjacktext = "null lumberjack";
        JOptionPane.showMessageDialog(lumberjackbutton, lumberjacktext, "The Lumberjack Class", JOptionPane.PLAIN_MESSAGE);         
    }

} 
} 
```

2级

```
import java.awt.Dimension;
import java.awt.Toolkit;
import javax.swing.JFrame;

public class thehandler {
public static void main(String args []) 
{
    rohwcg classes1 = new rohwcg();
    classes1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    classes1.setSize(700,300);
    classes1.setVisible(true);

    //Sets the position of the window to a comman ratio. 
    Toolkit tk = Toolkit.getDefaultToolkit();
    Dimension d = tk.getScreenSize();
    int x = d.width / 2;
    int y = (d.height / 2 ) - classes1.getHeight();
    classes1.setLocation(x,y);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:07:41.547

没关系，我找到了答案！很简单，你需要做的就是添加一个被点击的对象

```
private class HandlerClass implements ActionListener 
```

{

```
public void actionPerformed(ActionEvent click)  {

    Object source = click.getSource();

    if(source == farmerbutton)
    {           
    String farmertext = "Blocks a Farmer cannot break:" +"\r\n" +"\r\n" + "Any type of logs" + "\r\n" + "Stone" + "\r\n" + " Coal ore" + "\r\n" + "Iron ore" + "\r\n" + "Gold ore" + "\r\n" + "Diamond Ore" + "\r\n" + "Redstone ore" + "\r\n" + "Lapiz ore";  
    JOptionPane.showMessageDialog(farmerbutton,farmertext,"The Farmer Class",JOptionPane.PLAIN_MESSAGE);
    }

    if(source == minerbutton)
    {
    String minertext = "null miner";
    JOptionPane.showMessageDialog(minerbutton,minertext, "The Miner Class", JOptionPane.PLAIN_MESSAGE);
    }

    if(source == blacksmithbutton)
    {
    //blacksmith
    String blacksmithtext ="null blacksmith";
    JOptionPane.showMessageDialog(blacksmithbutton,blacksmithtext, "The BlackSmith Class", JOptionPane.PLAIN_MESSAGE);
    }

    if(source == lumberjackbutton)
    {
    //lumberjack
    String lumberjacktext = "null lumberjack";
    JOptionPane.showMessageDialog(lumberjackbutton, lumberjacktext, "The Lumberjack Class", JOptionPane.PLAIN_MESSAGE); 
    }
} 
```

}

}

# ruby-on-rails - 意外结束语法错误

> ID：13113507
> 
> 赞同：2
> 
> 时间：2012-10-28T22:10:13.813
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

以下代码：

```
require 'csv'

desc "Import Voters from CSV File"
task :import => [:environment] do

  file ="db/GOTV.csv"

  CSV.foreach(file, :headers => true) do |row|
    Voter.create({
      :last_name => row[0], 
      :first_name => row[1],
      :middle_name => row[2],
      :name_suffix => row[3],
      :primary_address => row[4],
      :primary_city => row[5],
      :primary_state => row[6],
      :primary_zip => row[7],
      :primary_zip4 => row[8],
      :primary_unit => row[9],
      :primary_unit_number => row[10],
      :phone_number => row[11],
      :phone_code => row[12],
      :gender => row[13],
      :party_code => row[14],
      :voter_score => row[15],
      :congressional_district => row[16],
      :house_district => row[17],
      :senate_district => row[18],
      :county_name => row[19],
      :voter_key => row[20],
      :household_id => row[21],
      :client_id => row[22],
      :state_voter_id => row[23]
    })
  end 
```

...正在引发以下错误：

```
/Users/ecumbee/Desktop/cloudvoters/lib/tasks/import.rake:35: syntax error, unexpected $end, expecting kEND
  end
     ^ 
```

我尝试删除末端，这会引发与我尝试添加另一末端相同的错误，但会导致无法编译错误。

编辑：添加第二个结束语句时出错

```
Don't know how to build task 'db:import' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:14:19.547

您的`end`代码中的 用于`CSV.foreach ... do`块。你错过了另一个`end`街区`task ... to`。

如果这仍然给您一个语法错误，请编辑您的问题并发布该错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:20:31.420

In the error message, `$end` refers to the end of the input file, while `kEND` refers to the `end` keyword, so it's complaining about a missing `end`, not an extra one.

If you still get a syntax error after adding another `end`, that's something unrelated to this error.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T22:14:03.270

我知道您说过您尝试添加另一端但没有帮助，但您的文件的问题是它缺少`end`将结束任务的关键字

`task :import => [:environment] do`

然后，您能否提供有关添加缺少的错误的更多信息`end`？

# c++ - C++ Direct2D ID2D1HwndRenderTarget 的父 IUnknown 类的 _vfptr 变量变为空

> ID：13113511
> 
> 赞同：0
> 
> 时间：2012-10-28T22:11:00.510
> 
> 标签：c++, com, directx, direct2d

我正在制作一个 Direct2D 应用程序，并且我正在编写一个 Direct2D 库，它也使我使用 Direct2D 更容易。如果需要，我将发布确切的有问题的代码，但我的主要问题是我在一个类的定义中有一个 ID2D1HwndRenderTarget，我用另一个类扩展了该类，在子类中我有一个调用方法的方法初始化Render Target的父类，然后依次调用子类的load方法。但是，一旦程序到达子类的加载内容方法，ID2D1HwndRenderTarget 的 IUnknown 部分中的 __vfptr 变量（我不知道那是什么）现在为空。我发现这一点的唯一原因是在其他一些代码中，当使用渲染目标从 IWicBitmapSource 创建 ID2D1Bitmap 时，我遇到了访问冲突错误。我不明白这是怎么发生的，因为在初始化渲染目标之后，只要带有初始化代码的方法返回，_vfptr 变量就会变为空。谁能解释为什么会发生这种情况？我的相关代码如下。

此代码被调用一次以创建 hwnd 渲染目标和离屏渲染目标。这是在一个 dll 项目中。游戏基础.cpp

```
HRESULT GameBase::Initialize(HINSTANCE hInst, HWND winHandle, struct DX2DInitOptions options)
        {
            this->mainRenderTarget = NULL;
            this->offscreenRendTarget = NULL;
            this->factory = NULL;

            HRESULT result;

            D2D1_FACTORY_OPTIONS factOptions;
            D2D1_FACTORY_TYPE factType;

            if(options.enableDebugging)
                factOptions.debugLevel = D2D1_DEBUG_LEVEL::D2D1_DEBUG_LEVEL_ERROR;
            else
                factOptions.debugLevel = D2D1_DEBUG_LEVEL::D2D1_DEBUG_LEVEL_NONE;

            if(options.singleThreadedApp)
                factType = D2D1_FACTORY_TYPE_SINGLE_THREADED;
            else
                factType = D2D1_FACTORY_TYPE_MULTI_THREADED;

            result = D2D1CreateFactory(factType, factOptions, &this->factory);

            if(FAILED(result))
            {
                OutputDebugString(L"Failed to create a Direct 2D Factory!");
                return result;
            }

            this->instance = hInst;
            this->hwnd = winHandle;

            D2D1_SIZE_U size = D2D1::SizeU(options.winWidth, options.winHeight);

            this->width = options.winWidth;
            this->height = options.winHeight;

            result = factory->CreateHwndRenderTarget(D2D1::RenderTargetProperties(), D2D1::HwndRenderTargetProperties(winHandle, size), &this->mainRenderTarget);

            if(FAILED(result))
            {
                OutputDebugString(L"Failed to create a render target to draw to the window with!");
                return result;
            }

            result = this->mainRenderTarget->CreateCompatibleRenderTarget(&this->offscreenRendTarget);
            if(FAILED(result))
            {
                OutputDebugString(L"Failed to create an offscreen render target from the main render target.");
                return result;
            }

            return LoadContent();
        } 
```

在调用 LoadContent 之后，我不会更改 mainRenderTarget 的值。

DX2DImage.cpp

```
HRESULT DX2DImageLoader::LoadFromResource(LPCWSTR resourceName, LPCWSTR resourceType, HMODULE progModule, DX2DImage* image)
        {
            if(!this->isInit)
            {
                OutputDebugStringA("You must call InitializeImageLoader before using this image loader!");
                return E_FAIL;
            }

            IWICBitmapDecoder *decoder = NULL;
            IWICBitmapFrameDecode *source = NULL;
            IWICStream *stream = NULL;
            IWICFormatConverter *converter = NULL;

            HRSRC imageResHandle = NULL;
            HGLOBAL imageResDataHandle = NULL;
            void *imageFile = NULL;
            DWORD imageFileSize = 0;

            HRESULT result;

            //Find the image.
            imageResHandle = FindResource(progModule, resourceName, resourceType);
            if(!imageResHandle)
            {
                OutputDebugStringA("Failed to get a handle to the resource!");
                return E_FAIL;
            }
            //Load the data handle of the image.
            imageResDataHandle = LoadResource(progModule, imageResHandle);
            if(!imageResDataHandle)
            {
                OutputDebugStringA("Failed to load the image from the module!");
                return E_FAIL;
            }
            //Lock and retrieve the image.
            imageFile = LockResource(imageResDataHandle);
            if(!imageFile)
            {
                OutputDebugStringA("Failed to lock the image in the module!");
                return E_FAIL;
            }
            //Get the size of the image.
            imageFileSize = SizeofResource(progModule, imageResHandle);
            if(!imageFileSize)
            {
                OutputDebugStringA("Failed to retrieve the size of the image in the module!");
                return E_FAIL;
            }
            //Create a stream that will read the image data.
            result = this->factory->CreateStream(&stream);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to create an IWICStream!");
                return result;
            }
            //Open a stream to the image.
            result = stream->InitializeFromMemory(reinterpret_cast<BYTE*>(imageFile), imageFileSize);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to initialize the stream!");
                return result;
            }
            //Create a decoder from the stream
            result = this->factory->CreateDecoderFromStream(stream, NULL, WICDecodeMetadataCacheOnDemand, &decoder);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to create a decoder from the stream!");
                return result;
            }
            //Get the first frame from the image.
            result = decoder->GetFrame(0, &source);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to get the first frame from the decoder!");
                return result;
            }
            //Create a format converter to convert image to 32bppPBGRA
            result = this->factory->CreateFormatConverter(&converter);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to create a format converter!");
                return result;
            }
            //Convert the image to the new format.
            result = converter->Initialize(source, GUID_WICPixelFormat32bppPBGRA, WICBitmapDitherTypeNone, NULL, 0.0f, WICBitmapPaletteTypeMedianCut);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to convert the image to the correct format!");
                return result;
            }

            //Create the Direct2D Bitmap from the Wic Bitmap.
            result = this->renderTarget->CreateBitmapFromWicBitmap(converter, NULL, &image->bitmap);
            if(FAILED(result))
            {
                OutputDebugStringA("Failed to create a Direct 2D Bitmap from a WIC Bitmap!");
                return result;
            }

            image->width = static_cast<UINT>(image->bitmap->GetSize().width);
            image->height = static_cast<UINT>(image->bitmap->GetSize().height);

            SafeRelease(&source);
            SafeRelease(&converter);
            SafeRelease(&decoder);
            SafeRelease(&stream);

            return S_OK;
        } 
```

线路发生Access Violation异常

```
result = this->renderTarget->CreateBitmapFromWicBitmap(converter, NULL, &image->bitmap); 
```

其中 image->bitmap 是当前为 NULL（就像它应该是）ID2D1Bitmap。

这里，renderTarget 变量与上面 GameBase.cpp 中的 mainRenderTarget 变量相同。当我调试该行时，RenderTarget 的所有父级都不为空，但是一旦我到达它下面的 IUnknown 接口，_vfptr 的东西就是空的。对于转换器变量、此变量或图像变量，情况并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:02:41.213

我没有足够的代码来调试您的代码，但从我所看到的情况来看，我怀疑调用`converter->Initialize(...)`无效，因为`MSDN`说：

```
If you do not have a predefined palette, you must first create one. Use
InitializeFromBitmap to create the palette object, then pass it in along
with your other parameters. 

dither, pIPalette, alphaThresholdPercent, and paletteTranslate are used to
mitigate color loss when converting to a reduced bit-depth format. For
conversions that do not need these settings, the following parameters values
should be used: dither set to WICBitmapDitherTypeNone, pIPalette set to NULL,
alphaThresholdPercent set to 0.0f, and paletteTranslate set to
WICBitmapPaletteTypeCustom. 
```

并且在您的代码中，您没有提供有效的调色板（您使用过`NULL`）并且您的*paletteTranslate*不是**WICBitmapPaletteTypeCustom**

# css - 非圆角菜单

> ID：13113515
> 
> 赞同：0
> 
> 时间：2012-10-28T22:11:20.657
> 
> 标签：css, fxml

在 JavaFX 2.* 的默认菜单中，菜单选项卡是四舍五入的。如何将其更改为矩形？

我已经尝试过使用 CSS，但我不知道要更改哪个组件。

# java - Java 2D 数组错误

> ID：13113523
> 
> 赞同：0
> 
> 时间：2012-10-28T22:12:32.667
> 
> 标签：java

所以我需要一个二维数组对每个元素进行计算并将其转移到另一个二维数组中，同时使用当前元素的“左”“右”“上”和“下”的值。如果当前元素在边缘 (x = 0, y = 0, x = array.length , y = array.length) 我会得到一个数组越界错误。我想创建一个处理每种情况的 for 循环，但我不知道该怎么做。我的代码示例是

```
private void buildE(int[][] array, int y, int x)
{

    int up = array[y - 1][x];
    int down = array[y + 1][x];
    int left = array[y][x - 1];
    int right = array[y][x + 1];

    if(up == 0){

        buildETopRow(array);

    } 
```

E 将是我的新数组。此方法不起作用，因为 y 不等于 0，它只是不存在，但我也不能将 ints 设置为 null。在出现越界错误的情况下，我需要越界的元素（上、下、左或右）等于当前元素。有没有办法我仍然可以为此使用 for 循环，还是我需要做其他事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:31:00.360

如果我没看错，你想有效地将​​边缘元素与边缘元素之间的差异视为 0。如果这是真的，我将编写四个方法 right()、left()、up() 和 down() , 下面以 down() 为例：

```
 /*
  * Return the difference between an element an the element below it
  */

public void down(int x, int y) {

    if (y == array.length - 1) { 
       \\ on the bottom edge
       return 0;
    }   

    return array[y][x] - array[y + 1][x];

} 
```

在你的循环中，你会计算：

```
up(x,y) + down(x,y) + right(x,y) + left(x,y) 
```

或者你需要总结的任何计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:24:33.963

用边界区域包围阵列的最简单方法。这样你的`x`维度是真的`width+2`。

```
import java.util.*;
import java.lang.*;

class Main
{
    public static void main (String[] args) throws java.lang.Exception
    {
        int realWidth = 10;
        int realHeight = 10;
        int[][] in = new int[(realWidth+2)][(realHeight+2)];
        int[][] out = new int[(realWidth+2)][(realHeight+2)];
        for (int j = 1;j<realHeight+1;j++)
        {
            for (int i = 1;i<realWidth+1;i++)
            {
                int top = in[j-1][i];
                int bottom = in[j+1][i];
                int left= in[j][i-1];
                int right  = in[j][i+1];
                out[j][i] = operation(top,bottom,left,right);
            }
        }
    }
    public static int operation (int top,int bottom,int left,int right)
    {
        return top+bottom+left+right;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:32:19.563

我不完全确定你的问题是什么，但是（1）遍历二维数组的常用结构是使用嵌套的 for 循环（一个在另一个里面），以及（2）当你想要环绕计数器时（例如 2 , 3, 0, 1, 2, ...) 使用余数运算符`%`。

```
int numRows = theArray.length;
int numCols = theArray[0].length;

for (int i = 0; i < numRows; i++) {
    for (int j = 0; j < numCols; j++) {

        int right = theArray[(j+1) % numCols];
        int down = theArray[(i+1) % numRows];
        int left = theArray[(j+numCols-1) % numCols];
        int up = theArray[(i+numRows-1) % numCols];

        /* right, down, left, and up will be the elements to the right, down, 
           left, and up of the current element. Npw that you have them, you can 
           process them however you like and put them in the other array. */

    }
} 
```

余数运算符的`A%B`作用是在 A 变得与 B 一样大时将其设置回零。由于 B 是数组的大小，因此恰好是它太大并且会导致 IndexOutOfBounds 错误。注意：这不是如何`%` *工作*的，但它是一种很好的方式来思考它的作用。要了解更多关于它的信息，你可以谷歌它，我在[这里](http://www.cafeaulait.org/course/week2/15.html)找到了一个好的解释。

# facebook - 如何仅由单个用户发布 Facebook 用户墙/页面状态 不为其他用户安装应用程序

> ID：13113528
> 
> 赞同：3
> 
> 时间：2012-10-28T22:13:28.637
> 
> 标签：facebook, post, status, facebook-page

我在一个站点上工作，如果在上面发布了某些内容，我需要将该站点的页面链接发布到一个特殊的用户墙或页面，这意味着我只需要一个用户来发布该问题。

我面临的问题是访问令牌，因为我不想在网站流量前显示 facebook 登录页面。它不像在用户墙上共享，我们基本上是在尝试自动在页面上发布状态，因此对于这个问题的任何帮助将不胜感激。

我正在使用以下代码，只要页面的访问令牌有效，它似乎就可以正常工作，但我需要制作一些永久的东西，以便我可以在硬编码的 php 代码中添加所有信息，并且它可以在几周内工作 -至少不更改 api 密钥或令牌

```
$appid = 'code';
$appsecret = 'code';
$wall= $pageId = 'code';

$token='page token';

$facebook = new Facebook(array('appId'  => $appid, 'secret' => $appsecret, 'cookie' => true));

$params=array( 'message' => $msg,'name' => $title, 'caption' => $title, 'link' =>$uri,'description' => $desc, 'picture' => $pic, 'access_token' => $token,'actions' => json_encode(array('name' => $action_name,'link' => $action_link)) );

$result = $facebook->api($wall.'/feed/','post',$params); 
```

如果我从图形 api 调试页面制作令牌，那么它工作正常，但一段时间后我收到消息“OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。”

我真的很想为它找到一些可靠的东西。

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:39:12.077

您可以编写一个以特殊用户身份运行并进行所需 FB api 调用的后端脚本（可能是使用 FB PHP-SDK 的 cron 作业）。为此，您将需要使用[长期访问令牌](https://developers.facebook.com/docs/howtos/login/extending-tokens/)，需要每 60 天更新一次。您也可以使用[App Access Token](https://developers.facebook.com/docs/howtos/login/login-as-app/)尝试您的 FB api 调用，它不会过期，但也不支持所有 FB 发布和其他操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:38:29.770

要发布到某人的墙上（或使用打开的图表执行任何操作），您必须通过 facebook 作为他们图表中的某人或他们已授予权限的应用程序进行身份验证。

您应该查看可以使用 oauth 范围属性设置的权限...

[https://developers.facebook.com/docs/reference/dialogs/oauth/](https://developers.facebook.com/docs/reference/dialogs/oauth/)

在我看来，如果您想写信给他们的朋友墙以及您被认证为的用户，他们似乎需要授予您的应用程序 publish_stream。

[https://developers.facebook.com/docs/reference/login/extended-permissions/](https://developers.facebook.com/docs/reference/login/extended-permissions/)

# html - 在 CSS 中创建一个奇怪的阴影效果

> ID：13113529
> 
> 赞同：3
> 
> 时间：2012-10-28T22:13:30.577
> 
> 标签：html, css

我正在尝试为 DIV 创建阴影，但它不是普通的盒子阴影，是看起来像径向阴影或其他东西的阴影。

![在此处输入图像描述](../Images/2f5a2107d0c810b4f164d65c167f4c8c.png)

我尝试过使用 box-shadow 但它不起作用。我可以用什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T22:25:01.107

试试这个：

```
<div class="box">
  <div class="shadow">Heading</div>
</div>

.shadow { background:#fff;padding:10px; border:solid 1px #ccc }
.box { position:relative; width:100%; margin-top:30px; z-index:0}
.box .shadow:after{
    bottom: -5px;
    content: " ";
    height: 8px;
    display:block;
    text-indent: -9999px;
    width: 100%;
    left:0;
    position:absolute;
    z-index:-1;
    background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPHJhZGlhbEdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iNzUlIj4KICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNhYWFhYWEiIHN0b3Atb3BhY2l0eT0iMSIvPgogICAgPHN0b3Agb2Zmc2V0PSI2MCUiIHN0b3AtY29sb3I9IiNmZmZmZmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvcmFkaWFsR3JhZGllbnQ+CiAgPHJlY3QgeD0iLTUwIiB5PSItNTAiIHdpZHRoPSIxMDEiIGhlaWdodD0iMTAxIiBmaWxsPSJ1cmwoI2dyYWQtdWNnZy1nZW5lcmF0ZWQpIiAvPgo8L3N2Zz4=);0eT0iMSIvPgogIDwvcmFkaWFsR3JhZGllbnQ+CiAgPHJlY3QgeD0iLTUwIiB5PSItNTAiIHdpZHRoPSIxMDEiIGhlaWdodD0iMTAxIiBmaWxsPSJ1cmwoI2dyYWQtdWNnZy1nZW5lcmF0ZWQpIiAvPgo8L3N2Zz4=);
    background-image: -ms-radial-gradient(center top, ellipse farthest-side, #aaaaaa 0%, #FFFFFF 100%);
    background-image: -moz-radial-gradient(center top, ellipse farthest-side, #aaaaaa 0%, #FFFFFF 100%);
    background-image: -o-radial-gradient(center top, ellipse farthest-side, #aaaaaa 0%, #FFFFFF 100%);
    background-image: -webkit-gradient(radial, center top, 0, center top, 490, color-stop(0, #aaaaaa), color-stop(1, #FFFFFF));
    background-image: -webkit-radial-gradient(center top, ellipse farthest-side, #aaaaaa 0%, #FFFFFF 100%);
    background-image: radial-gradient(center top, ellipse farthest-side, #aaaaaa 0%, #FFFFFF 100%);
} 
```

取自：[http ://der-auftritt.de/testcase/gradientshadow.html](http://der-auftritt.de/testcase/gradientshadow.html)

ps 如果您也希望阴影位于顶部，请使用具有相同代码的 :before 选择器

pps 对于一些非常酷的渐变使用这个工具：[渐变编辑器](http://www.colorzilla.com/gradient-editor/)

# mysql - Rails 如何知道 MySQL 数据库在哪里？

> ID：13113530
> 
> 赞同：1
> 
> 时间：2012-10-28T22:13:35.510
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3.2, rails-migrations

在花了半天时间弄清楚之后，我终于得到了一个连接到 Rails 3.2 应用程序的 MySQL 数据库。

我不明白的是 Rails 如何知道在哪里可以找到数据库？

使用默认的 Sqlite3 非常简单，因为它嵌入在应用程序中，因此只需在*`database.yml`*( `db/devlopment.sqlite3`) 中指定路径即可。

但是，当它是 MySQL 时，我认为我必须指定从 MySQL 命令行创建的数据库的路径。事实证明我不必这样做，我所要做的就是提供数据库的名称和用户登录凭据。

那么当我在 Rails 中运行迁移时，它是如何知道数据库在哪里的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:22:12.343

这被称为合理的默认值。看看你的`database.yml`文件，你可能会发现这样一行：

```
socket = socket: /tmp/mysql.sock 
```

`host`AFAIK，如果没有明确显示，则在没有其他参数（例如and `port`）的情况下将其用作默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:46:16.947

实际上，Rails 对此一无所知。处理数据库连接的模块是 Active Record 使用的适配器。Rails 仅在 database.yml 文件的情况下提供一种“配置约定”，以使其对所有可能的数据库“通用”，但在内部，它们使用此信息以自己独特的协议设置每个数据库连接。我不了解 SQlite，但 mysql 和 mysql2 处理程序不是由 rails 团队维护的

[https://github.com/brianmario/mysql2](https://github.com/brianmario/mysql2)

在这里，您可以查看 Rails/ActiveRecord 用于设置 MySql 连接的接口。

所以，总而言之，Rails 不知道。它只需要你在 database.yml 中设置的信息来推断他们应该使用哪个适配器（转到你的 database.yml，你会看到类似“适配器：mysql2”或“适配器：“sqlite”）和必要的信息建立连接.正如@pjam所描述的，用于外部访问mysql服务的协议由模式 mysql://localhost:3306/DB_NAME?user=YOUR_USER_NAME&password=YOUR_PASSWORD 表示，这实际上是适配器设置连接的方式up. 只是它不是由 Rails 完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:18:03.190

我相信它可以通过本地数据库的 url 找到它，类似于

```
mysql://localhost:3306/DB_NAME?user=YOUR_USER_NAME&password=YOUR_PASSWORD 
```

所以它只需要 DB_NAME、YOUR_USER_NAME 和 YOUR_PASSWORD，这些都在您的`database.yml`

# php - simpleXML 创建一个 foreach

> ID：13113531
> 
> 赞同：-1
> 
> 时间：2012-10-28T22:13:44.883
> 
> 标签：php, foreach, simplexml

> **可能重复：**
> [foreach 和 simplexml](https://stackoverflow.com/questions/12154689/foreach-and-simplexml)

我的 XML 文档加载正确，但我不确定如何为提要中给出的每个项目创建一个简单的 foreach`[PictureHref]` `[Title]`并`[PriceDisplay]`加载。

我在文档中找不到明确的示例。

[XML 示例](http://api.trademe.co.nz/v1/Member/4389666/Listings/All.xml)

目前我的 PHP 代码包括以下内容：

```
$mainUrl = 'http://api.trademe.co.nz/v1/Member/{id}/Listings/All.xml';
$xmlFeed = simplexml_load_file($mainUrl); 
```

XML

```
<Listings xmlns="http://api.trademe.co.nz/v1" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
    <TotalCount>1</TotalCount>
    <Page>1</Page>
    <PageSize>1</PageSize>
    <List>
        <Listing>
            <ListingId>527496168</ListingId>
            <Title>Clifftop Resort style Living with stunning aspect</Title>
            <Category>0350-5748-3399-</Category>
            <StartPrice>0</StartPrice>
            <StartDate>2012-10-26T21:24:47.073Z</StartDate>
            <EndDate>2012-12-21T21:24:47.073Z</EndDate>
            <ListingLength i:nil="true" />
            <HasGallery>true</HasGallery>
            <AsAt>2012-10-28T22:48:47.409946Z</AsAt>
            <CategoryPath>/Trade-me-property/Residential/For-sale</CategoryPath>
            <PictureHref>http://images.trademe.co.nz/photoserver/thumb/10/239043710.jpg</PictureHref>
            <RegionId>2</RegionId>
            <Region>Auckland</Region>
            <Suburb>North Shore</Suburb>
            <NoteDate>1970-01-01T00:00:00Z</NoteDate>
            <ReserveState>NotApplicable</ReserveState>
            <IsClassified>true</IsClassified>
            <GeographicLocation>
                <Latitude>-36.5681333</Latitude>
                <Longitude>174.6936265</Longitude>
                <Northing>5951700</Northing>
                <Easting>1751547</Easting>
                <Accuracy>Address</Accuracy>
            </GeographicLocation>
            <PriceDisplay>To be auctioned</PriceDisplay>
        </Listing>
    </List>
</Listings> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:52:51.737

所有你需要的是

```
$url = simplexml_load_file("__YOUR__URL___");
$listing = $url->List->Listing;

echo "<pre>";
echo $listing->PictureHref, PHP_EOL;
echo $listing->Title, PHP_EOL;
echo $listing->PriceDisplay, PHP_EOL; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:52:33.030

虽然我建议使用 DOMDocument 而不是 SimpleXML，但下面是您在 SimpleXML 中的做法：

```
$data = array();

foreach($xmlFeed->List as $item) {
    $data[] = array(
        (string) $item->Listing->PictureHref,
        (string) $item->Listing->Title,
        (string) $item->Listing->PriceDisplay
    );
} 
```

[你可以在 CodePad](http://codepad.org/ITbAnxsw)上看到它（有点，我不得不改变一些东西）

# javascript - Autotab contenteditable divs 或向输入类型添加功能：文本

> ID：13113540
> 
> 赞同：0
> 
> 时间：2012-10-28T22:15:26.647
> 
> 标签：javascript, html, events, contenteditable

我有 3 个可内容编辑的 div。第一个和第三个 div 具有模拟更改与键事件关联的字符的功能，在用户键入时键入预编程的字符串，第二个 div 很简单——用户键入的内容会显示在 div 中。这可以在这里看到：http: [//jsfiddle.net/vRXph/4/](http://jsfiddle.net/vRXph/4/)。为了方便起见，我在这里包含了第一个 div 的代码：

```
var list1 = "Sing in me, Muse, and through me tell the story".replace(/\s/g,
 "\xA0").split("")
function transformTypedCharacter1(charStr) {
    var position = $("#verse1").text().length;
    if (position >= list1.length) return '';
    else return list1[position];
}

function insertTextAtCursor1(text) {
    var sel, range, textNode;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.getRangeAt && sel.rangeCount) {
            range = sel.getRangeAt(0).cloneRange();
            range.deleteContents();
            textNode = document.createTextNode(text);
            range.insertNode(textNode);

            // Move caret to the end of the newly inserted text node
            range.setStart(textNode, textNode.length);
            range.setEnd(textNode, textNode.length);
            sel.removeAllRanges();
            sel.addRange(range);
        }
    } else if (document.selection && document.selection.createRange) {
        range = document.selection.createRange();
        range.pasteHTML(text);
    }
}

$("#verse1").keypress(function(evt) {
    if (evt.which) {
        var charStr = String.fromCharCode(evt.which);
        var transformedChar = transformTypedCharacter1(charStr);
        if (transformedChar != charStr) {
            insertTextAtCursor1(transformedChar);
            evt.preventDefault();
            return false;
        }
    }
}); 
```

我想在这些 div 之间自动切换。在第一个 div 中，autotab 函数将在输入最终的预编程字符后调用，而对于第二个 div，autotab 将在一定数量的字符后调用（假设为 5 个字符，只是为了保持简短测试）。

我的第一个问题（共 3 个）：如何在 contenteditable div 之间自动切换？
我找到了一种在输入类型之间自动切换的方法：此处的文本字段：http: [//jsfiddle.net/Ukkmu/73/](http://jsfiddle.net/Ukkmu/73/)但我似乎无法将其应用于我的 div。我在这里尝试过但失败了：http: [//jsfiddle.net/Ukkmu/76/](http://jsfiddle.net/Ukkmu/76/)。

```
 function auTab (currentDiv, currentDivSize, currentDivLength, nextDiv) {
    if(currentDivSize == currentDivLength){
        $('#' + currentDiv).next().focus();
    };
};

$('div[id^="verse"]').keyup(function() {
    var thisDiv = $(this).attr('id');
    var thisDivSize = $(this).attr('size');
    var thisDivLength = $(this).val().length;

    auTab(thisDiv, thisDivSize, thisDivLength);
}); 
```

如您所见，系统只是忽略了 autotab 功能。我在我的第一个 div 上创建了一个大小为“5”的测试。我不知道这是否可能，但我这样做是因为我看到 autotab 功能取决于大小。我的第二个问题（共 3 个）是：我可以为 contenteditable div 分配 size 或 maxlength 属性吗？如果可以的话，并且如果 autotabbing 依赖于这个属性，那么我只需将第一个 div 的大小指定为我预编程字符串中的字符数（对于第二个 div，我会指定 5 个字符作为测试，正如我上面提到的）。

另一种方法是将我的 contenteditable div 更改为输入类型：文本字段。我在这里做了这个：http: [//jsfiddle.net/Ukkmu/74/](http://jsfiddle.net/Ukkmu/74/)，但是你可以看到我在这个问题的第一段中描述的原始功能不再有效。我最终在第一个字段之前有一个重复的字符（我的预编程字符串中的“S”） ，而不是我*在第一个字段**中*的预编程字符串。对于这个测试，我将字段的大小设置为 3，只是作为测试。最终版本将是整个预编程字符串的大小。我的第三个问题（共 3 个）（如果适用）：如何应用模拟更改与键关联的字符的功能，甚至输入 type= 文本字段？

我对这段代码的应用是这是一个艺术项目。*当用户键入时，屏幕上的输出会在经典文本（在本例中为 Homer's The Odyssey*）和用户实际键入的内容之间交替。

抱歉，如果这是一篇很长的帖子，但我想包含尽可能多的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T01:17:16.073

感谢 pckill，我的解决方案回答了问题 3。我使用了输入类型：具有以下功能的文本字段：

```
var list1 = "This is a test.".replace(/\s/g, "\xA0").split("")
function transformTypedChar1(charStr) {
    var position = $("#verse1").val().length;
    if (position >= list1.length) return '';
    else return list1[position];
} 
```

# haskell - 无法将预期类型 Int 与推断类型 Integer 匹配

> ID：13113542
> 
> 赞同：0
> 
> 时间：2012-10-28T22:15:35.067
> 
> 标签：haskell, inferred-type

我编写了一些简单的haskell 函数来计算图中给定顶点的邻居（见下文）。它编译得很好，但是，当我运行时`adj g 1`，我收到以下错误：`Couldn't match expected type `Int' against inferred type `Integer'`

编码：

```
module Test where
import Prelude
import Data.List

type Node = Int
type Edge = (Int, Int)

type Graph = ([Node], [Edge])

g = ([1,2,3,4,5,6], [(1,2),(2,3),(2,4),(5,6)])

adj :: Graph -> Node -> [Node]
adj (vs, []) n = []
adj (vs,((s,e):es)) n   | s==n = e:rec
                        | e==n = s:rec
                        | otherwise = rec
    where
    rec = adj (vs,es) n 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:21:01.973

添加显式类型签名：

```
g :: ([Int], [(Int, Int)]) 
```

或者更好

```
g :: Graph 
```

发生这种情况是因为数字 like`7`可以是任何整数类型，并且默认为 Integer，而您的函数使用 Int。

# c++ - 将结果保存到 C++ 中的文件

> ID：13113544
> 
> 赞同：-5
> 
> 时间：2012-10-28T22:15:45.483
> 
> 标签：c++, visual-c++, c++builder

我对这段代码有疑问。

我在代码中寻找的是随机获取“第一”和“第二”的结果并将结果放入文件中。

如果我在不使用文件的情况下运行它并且我得到所有正确的结果，它会很好，但是当我尝试将结果保存在文件中时，我只得到包含（第一个，第二个）的第一个节点。

这是代码：

```
#include<iostream>
#include <fstream>
#include<cmath>

using namespace std;

void main() 
{
    int first[100],secnd[100];

    for (int i=0; i<100 ;i++)
    {   
        first[i]=rand()%500;  //random number from  to 499
        secnd[i]=rand()%500;  //random number from  to 499
        ofstream myfile;
        myfile.open ("example.txt");
        myfile << "Writing this to a file.\n";
        myfile <<first[i]<<" "<<secnd[i];
        myfile.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:19:25.157

您在错误的位置打开文件。您在循环之前打开文件*一次*并在循环之后关闭文件*一次*。像这样。

```
myfile.open ("example.txt");
for (int i=0; i<100 ;i++)
{   
   ...
}
myfile.close(); 
```

当您打开文件进行输出时，您会删除文件中当前的内容。因此，如果您在循环内打开文件，那么您将丢失之前编写的随机数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:19:07.787

您正在循环中重新打开文件。这每次都会将文件归零，因此您只能获得最后一个条目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T22:19:15.560

an 的默认打开标志`ofstream`是截断（覆盖）文件。您每次通过循环打开和关闭文件。如果您想要文件中的所有结果，请在循环外打开它一次，并在循环后关闭它。

# java - 为什么我的菜单栏显示在容器中的 JPanel 下方？

> ID：13113546
> 
> 赞同：2
> 
> 时间：2012-10-28T22:16:19.393
> 
> 标签：java, swing, canvas, awt, mixing

我处于必须重用和修改其他人的代码来创建图像处理应用程序的位置。以下代码用于设置框架及其 GUI。我遇到的问题是，当在菜单栏上单击文件字时，菜单项列在 originalImage 容器中包含的画布下方。这是代码：

```
public ImageLoader(){    
    super("IRIS Application");
    JMenu fileMenu = new JMenu("File");

    JMenuItem fileOpenChoice = new JMenuItem("Open File");
    fileOpenChoice.addActionListener(new FileOpener());
    fileMenu.add(fileOpenChoice);

    JMenuItem fileSaveChoice = new JMenuItem("Save File");
    fileSaveChoice.addActionListener(new FileSaver());
    fileMenu.add(fileSaveChoice);

    JMenu processMenu = new JMenu("Process");

    JMenuItem reduceContrast = new JMenuItem("Reduce Contrast");
    reduceContrast.addActionListener(new ReduceContrast());
    processMenu.add(reduceContrast);

    JMenuItem scale = new JMenuItem("Scale");
    scale.addActionListener(new Scaler());
    processMenu.add(scale);

    JMenuItem sobel = new JMenuItem("Sobel");
    sobel.addActionListener(new Sobel());
    processMenu.add(sobel);

    JMenuItem prewitt = new JMenuItem("Prewitt");
    prewitt.addActionListener(new Prewitt());
    processMenu.add(prewitt);

  originalImage = new BufferedImage(565, 584, BufferedImage.TYPE_BYTE_GRAY);
  processedImage = new BufferedImage(565, 584, BufferedImage.TYPE_BYTE_GRAY);
  originalRaster = originalImage.getRaster();
  processedRaster = processedImage.getRaster();
  ic = new ImageCanvas();
  pc = new ImageCanvas();

  Container content = this.getContentPane();
  content.setLayout(new FlowLayout());
  JPanel originalContainer = new JPanel();
  originalContainer.add(ic);
  originalContainer.setSize(ic.getWidth(), ic.getHeight());
  originalContainer.setBorder(new EtchedBorder());
  JPanel processedContainer = new JPanel();
  processedContainer.add(pc);
  processedContainer.setSize(pc.getWidth(), pc.getHeight());
  processedContainer.setBorder(new EtchedBorder());
  JPanel imagePanel = new JPanel();
  imagePanel.setLayout(new FlowLayout());
  imagePanel.add(originalContainer);
  imagePanel.add(processedContainer);
  //content.add(imagePanel, BorderLayout.NORTH);
  JPanel originalGrid = new JPanel();
  originalGrid.setLayout(new GridLayout(0,1,5,0));
  JPanel processedGrid = new JPanel();
  processedGrid.setLayout(new GridLayout(0,1,5,0));
  originalText = new JTextField("Original Text");
  JButton originalButton = new JButton("View Coordinates Table");
  originalGrid.add(originalText);
  originalGrid.add(originalButton);
  JTextField processedText = new JTextField("Processed Text");
  JButton processedButton = new JButton("View Coordinates Table");
  processedGrid.add(processedText);
  processedGrid.add(processedButton);
  JPanel informationPanel = new JPanel();
  informationPanel.setBackground(Color.red);
  informationPanel.setLayout(new BorderLayout());
  informationPanel.add(originalGrid, BorderLayout.WEST);
  informationPanel.add(processedGrid, BorderLayout.EAST);
  //content.add(informationPanel, BorderLayout.SOUTH);
  ic.addMouseMotionListener(new ImageMouseMotionListener(ic, originalText));
  pc.addMouseMotionListener(new ImageMouseMotionListener(pc, processedText));
  JMenuBar bar = new JMenuBar();
  bar.add(fileMenu);
  bar.add(processMenu);

  content.add(imagePanel, BorderLayout.NORTH);
  content.add(informationPanel, BorderLayout.SOUTH);
  setJMenuBar(bar);
  setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
  setSize(1200, 725);
  setResizable(false);
  setVisible(true);
  setLocation(125, 0);

} 
```

我知道菜单栏很好，所以我假设它是我将画布添加到 JPanel 的方式。是否应该在 JPanel 中设置其 z 顺序？我已经阅读了我家里的书籍，没有提到这种问题。谢谢，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T03:03:31.143

AWT 和 Swing 组件混用会造成重叠问题，Canvas 是 AWT 组件，改用 JPanel JDK1.6_12 以后，都可以安全使用。

# jquery - Jquery/Ajax 显示/隐藏事件顺序

> ID：13113548
> 
> 赞同：0
> 
> 时间：2012-10-28T22:16:31.860
> 
> 标签：jquery, event-handling, show-hide

当用户单击提交按钮时，我正在尝试创建加载图像。由于某些奇怪的原因，似乎隐藏事件与显示事件同时执行（我根本看不到加载图像。我尝试添加延迟来隐藏但没有工作）但是，如果我删除隐藏事件，加载图像显示得很好。有任何想法吗？非常感谢你帮助我。

```
$('#submitButton').click(function() {
    $("#loading-popup").ajaxStart(function() {
        $(this).show();
    }); //show loading image
    //.....................
    $.ajax({
        type: 'POST',
        dataType: "json",
        //.....................
        success: function(jsonData) {
            //.....................
            $("#loading-popup").delay(15000).hide(); //hide loading image
            //.....................
        },

    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:23:00.003

[`.hide()`](http://api.jquery.com/hide/)不带任何参数是一个类似的同步动作`.css('display', 'none')`。它不是动画，因此不遵守动画延迟。

一个简单的解决方案是简单地`0`作为持续时间传递，因此它会触发`.hide()`遵循延迟的动画版本：

```
​$('#foo').​​​​delay(2000).hide(0);​ 
```

[**小提琴**](http://jsfiddle.net/CCwZm/)

请注意，`0`在某些 jQuery 版本中传递持续时间是错误的，因此如果您发现问题，请升级到 1.8.2 或您的版本的最新稳定版本。如果您需要延迟，您也可以使用 a `setTimeout`，即使这只是额外的混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:23:09.613

```
$('#submitButton').click(function() {

  $.ajax({
      type: 'POST',
      dataType: "json",
      beforeSend:  $("#loading-popup").show(); 
      //.....................
      success: function(jsonData) {
          //.....................
          $("#loading-popup").hide(); //hide loading image
          //.....................
      },

  });
}); 
```

# css - 定位 div，在另一个 div 上，对齐 - 右

> ID：13113551
> 
> 赞同：-1
> 
> 时间：2012-10-28T22:16:57.633
> 
> 标签：css

好的，在一个居中的 div 中有一个图像，它位于页面的中心。它的宽度是 400 像素。

我想要实现的是：

*   放置另一个 div - 在该 div 内，通过 CSS 对齐。

由于屏幕分辨率不同，我希望避免使用“top:, right:”命令。

如何做到这一点？

```
<div class="non"><div class="info">Go top right</div><a href=""><img src="images/top.jpg"></a></div> 
```

CSS..

```
.non { width:400px; background-color:#d20000;  }
.info { position:absolute;float:right; background-color:#efefef; } 
```

[这里的例子](http://jsfiddle.net/QhYS9/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:49:07.423

只需这样做，它应该可以工作：

```
.non { width:400px; background-color:#d20000; position: relative; }
.info { position:absolute; top: 0px; right: 0px; background-color:#efefef; } 
```

我知道你想避免使用 top 和 right，但如果你这样做， .info 类将定位在 .non 类 div 的右上角，而不是整个页面 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:48:59.920

恐怕我真的不知道如何保存`float: position`or `right: 0`。`relative`我设法使用包含 div 和`absolute`内部 div 的两个位置来实现你想要 的：

```
.non {
    width:400px;
    background-color:#d20000;
    position: relative;
}
.info {
    position:absolute;
    background-color:#efefef;
    right: 0;
}​ 
```

除此之外，正如@HashemQolami 所说，只需`position: absolute`从您的代码中删除，[它就可以正常工作](http://jsfiddle.net/pfPvH/)。

# loops - 如何使用现有的 for 循环在 Liquid 模板中循环 n.times

> ID：13113552
> 
> 赞同：10
> 
> 时间：2012-10-28T22:16:57.133
> 
> 标签：loops, liquid

在 ruby​​ 中我可以做 n.times，是否可以在 Liquid 标记中做到这一点？

我当前的循环是：对于 site.posts 中的视频，我的目标是运行此循环 2 次。目前有 4 个对象将通过循环调用，但我想要 8 个。我希望这很清楚！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-28T22:22:36.960

您应该能够使用具有范围的 for 循环（`n`是迭代次数）：

```
{% for num in (1..n) %} 
```

在 Shopify Liquid 的某些情况下，它也可以使用

```
{% for num in (1...n) %} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-23T14:08:33.937

如果像我一样，您想要一个不基于集合长度或内置变量的动态数字，您可以使用包含和捕获的默认值来创造奇迹

```
{% capture count %}{{include.count|default:16}}{% endcapture %}
{% for num in (1...count) %}
    {{num}}
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-26T16:49:07.097

我在这里玩游戏已经很晚了，但是对于对此感到困惑的任何人，这就是您可以做的。

您接受其他答案所说的话：

```
{% for num in (1..n) %} 
```

然后你把它包裹在你的另一个 forloop 周围。在 site.post 循环 2 次的原始视频请求中，它会像这样循环

```
{% for i in (1..2) %}
  {% for video in site.posts %}
    Do your loop stuff here
  {% endloop %}
{% endfor %} 
```

现在您正在控制原始循环遍历其总集的次数

# c# - 文本框动态自动完成

> ID：13113553
> 
> 赞同：1
> 
> 时间：2012-10-28T22:17:07.173
> 
> 标签：c#, json, autocomplete

我的表单有一个文本框，我想在输入时添加自动完成功能。我的自动完成值是通过 json api 动态加载的。

我在文本框的“TextChanged”事件上应用了“更新”功能。

每次触发时，自动完成都会打开 0.5 秒，并且文本框的值会更改为第一个自动完成条目。之后，自动完成菜单消失。

我无法手动选择任何建议...

怎么修？

加载事件：

```
AutoCompleteStringCollection colValues = new AutoCompleteStringCollection();
private void StellenUebersicht_Load(object sender, EventArgs e)
{
        TextBox textBoxExample = textBox1;
        textBoxExample.AutoCompleteMode = AutoCompleteMode.SuggestAppend;
        textBoxExample.AutoCompleteSource = AutoCompleteSource.CustomSource;
        textBoxExample.AutoCompleteCustomSource = colValues;
        doAutoCompleteListExample();
} 
```

doAutoCompleteListExample():

```
private void doAutoCompleteListExample()
    {
        if (textBox1.Text.Length >= 1)
        {
            string w = Web.get("MY JSON API URL");

            JObject o = JObject.Parse(w);
            List<string> ac = new List<string>();
            foreach (JObject item in o["items"])
            {
                string name = item["name"].ToString();
                ac.Add(name);
            }
            colValues.AddRange(ac.ToArray());
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:21:48.413

我修好了它。

解决方案：

**改变**

```
textBoxExample.AutoCompleteMode = AutoCompleteMode.SuggestAppend; 
```

**到**

```
textBoxExample.AutoCompleteMode = AutoCompleteMode.Suggest; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-19T02:06:58.170

只需删除您的 If,no need If... 如果您不确定，请执行此操作

```
 // if (textBox1.Text.Length >= 1)
    //    {
            string w = Web.get("MY JSON API URL");

            JObject o = JObject.Parse(w);
            List<string> ac = new List<string>();
            foreach (JObject item in o["items"])
            {
                string name = item["name"].ToString();
                ac.Add(name);
            }
            colValues.AddRange(ac.ToArray());
   //     } 
```

也许这对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T05:40:12.797

和 和之类`AutoCompleteCustomSource`的属性通过将输入的前缀字母与数据源中所有字符串的前缀进行比较来自动完成用户输入的字符串。`AutoCompleteMode``AutoCompleteSource``TextBox`

```
 textBox1.AutoCompleteMode = AutoCompleteMode.Suggest;
        textBox1.AutoCompleteSource = AutoCompleteSource.CustomSource;
        AutoCompleteStringCollection DataCollection = new AutoCompleteStringCollection();
        addItems("Add your Data here");
        textBox1.AutoCompleteCustomSource = DataCollection; 
```

完整来源[在这里](http://net-informations.com/q/faq/autocomplete.html)。

# java - 处理/C920罗技采集帧率视频话语

> ID：13113560
> 
> 赞同：1
> 
> 时间：2012-10-28T22:18:10.703
> 
> 标签：java, webcam, processing, frame-rate, logitech

我正在处理 2.0b 上进行开发，我刚刚购买了 C920 罗技网络摄像头以获得良好的捕获质量。

然后我尝试在 捕获`1920 x 1080`，问题是我每秒低于 15 fps。当我列出所有可捕获的设备时，程序写道：

> 一些尺寸和fps
> 
> ...
> 
> -[61]“名称=高清专业网络摄像头 C920，尺寸=1024x576，fps=5”
> 
> -[62]“名称=HD Pro 网络摄像头 C920，尺寸=1024x576，fps=30”
> 
> -[63]“名称=高清专业网络摄像头 C920，尺寸=1280x720，fps=5”
> 
> -[64]“名称=高清专业网络摄像头 C920，尺寸=1280x720，fps=30”
> 
> -[65]“名称=高清专业网络摄像头 C920，尺寸=1600x896，fps=5”
> 
> -[66]“名称=高清专业网络摄像头 C920，尺寸=1600x896，fps=30”
> 
> -[67]“名称=高清专业网络摄像头 C920，尺寸=1920x1080，fps=5”
> 
> -[68]“名称=高清专业网络摄像头 C920，尺寸=1920x1080，fps=30”
> 
> ...
> 
> 其他一些尺寸和fps...

所以，正如我所读到的......对于`1920 x 1080`30 fps的帧速率的大小是可用的......

怎么了 ？？

即使我强制程序或以 30 fps 运行.. 有一个崩溃点`cam.start();`告诉我这种大小的帧速率不可用...

任何帮助...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T05:34:18.483

几个月前我也遇到了这个问题。这是我通过论坛搜索并联系客户支持后发现的：

罗技 C920 仅在 1080p 下提供 30fps 的应用程序直接支持 H.264，并且可以直接从摄像头拉入 H.264 流。C920 进行板载 H.264 压缩，但大多数应用程序不支持直接从摄像机提取压缩流；相反，他们必须解压缩然后重新压缩流，从而降低帧速率。

Skype 直接从摄像头支持 H.264，因此使用 Skype，您应该能够获得 1920x1080 @ 30fps，但使用处理时您不会看到如此高的帧速率。另外，我认为您必须使用 Windows 才能使用 Logitech 驱动程序来支持这一点。

如果我能找到它，我会发布我不久前所做的研究，但不幸的是，答案是你必须降低分辨率或帧速率。

# google-apps-script - WebApp 访问的库中的 ScriptDb

> ID：13113564
> 
> 赞同：4
> 
> 时间：2012-10-28T22:18:32.000
> 
> 标签：google-apps-script

我创建了一个 Google Apps 脚本项目，该项目发布为任何人都可以看到的 WebApp，并以访问用户身份运行。

此 WebApp 包含一个 Library 项目，该项目具有以下访问方法`ScriptDb`：

```
function getDb() {
  return ScriptDb.getMyDb();
}

function save(props) {
  return getDb().save(props);
} 
```

我打算让每个访问用户运行一个 WebApp（使用基于时间的触发器来访问 Gmail），但是我想使用`ScriptDb`独立于运行 WebApp 的用户来存储数据。因此，我认为从 Google Apps 脚本文档[集中一个地方以获取数据库实例](https://developers.google.com/apps-script/scriptdb#centralizing_a_place_to_get_a_database_instance)的章节在这里适用，但是在访问 WebApp 时出现以下错误：

`You do not have access to library MyDBLibrary, used by your script, or it has been deleted.`

我做错什么了吗？当从 WebApp 访问时，ScriptDb 是否不打算独立于用户运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T16:39:21.453

Joscha - 您的设置正确，我复制了您报告的所有内容。您缺少的最后一件事是将图书馆项目本身分享给公众。

这样做的方法是 1\. 在脚本编辑器中打开库项目 2\. 转到文件 -> 共享 3\. 在“谁有权访问”部分中，将其设置为任何有链接的人都可以查看（不需要编辑） .

![共享设置](../Images/f80b419fa10d5cec8419e966a23ec818.png)

没有这个，Apps Script 现在就知道可以向公众提供库代码了。希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-08-31T09:41:06.183

您可能需要打开`development mode`标志才能使其工作。

这就是我所做的。

1.  用户 A：创建了一个`Master`电子表格并创建了一个应用脚本并将其保存为 version `1.0`。
2.  用户 A：授予用户访问此工作表的权限，`B`以便他们可以使用通用应用程序脚本。
3.  用户 A：将项目访问密钥授予用户`B`。4.用户B：创建了一个电子表格并添加了资源`library with project key`。
4.  用户 B：选定的版本`1.0`。
5.  用户 B：打开`development mode`。

**注意：**如果我按照步骤 1 到 5 操作，我仍然会看到相同的错误，说我没有权限或脚本已被删除。但是，执行第 6 步也将解决错误并允许您使用共享脚本。

# actionscript-3 - 我怎么称呼我的。来自另一个框架的类文件？

> ID：13113565
> 
> 赞同：0
> 
> 时间：2012-10-28T22:18:34.513
> 
> 标签：actionscript-3, class

我在外部设置了一个代码。类文件 这个类文件允许一些鼠标功能，例如使用色板进行颜色转换。现在代码运行良好，但它似乎只在第 1 帧中工作。我想在加载 as 时将我的所有作品从第 1 帧移动到第 4 帧。class 文件以在第 4 帧中伴随我的功能。所以基本上我只是想将所有内容从第 1 帧移动到第 4 帧。这是如何完成的？我尝试发布设置并将 eport 类选项更改为第 4 帧，但没有成功。这是我在外部的代码。文件。

```
package code
{
    /*****************************************
     * DrawingSample4 :
     * Demonstrates dynamic color transformations.
     * -------------------
     * See 4_color.fla
     ****************************************/

    import fl.events.SliderEvent;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.display.SimpleButton;
    import flash.display.MovieClip;
    import flash.geom.ColorTransform;

    public class Drawing5 extends MovieClip
    {
        //*************************
        // Properties:

        public var activeSwatch:MovieClip;

        // Color offsets
        public var c1:Number = 0;   // R
        public var c2:Number = 51;  // G
        public var c3:Number = 51;  // B

        //*************************
        // Constructor:

        public function Drawing5()
        {

            // Respond to mouse events
            swatch1_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false);
            swatch2_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false);
            swatch3_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false);
            swatch4_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false);
            swatch5_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false);
            swatch6_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false);
            apply_btn.addEventListener(MouseEvent.CLICK,clickHandler,false,0,true);
            previewBox_btn.addEventListener(MouseEvent.MOUSE_DOWN,dragPressHandler);

            // Respond to drag events
            red_slider.addEventListener(SliderEvent.THUMB_DRAG,sliderHandler);
            red_slider.addEventListener(Event.CHANGE,sliderHandler);
            green_slider.addEventListener(SliderEvent.THUMB_DRAG,sliderHandler);
            green_slider.addEventListener(Event.CHANGE,sliderHandler);
            blue_slider.addEventListener(SliderEvent.THUMB_DRAG,sliderHandler);
            blue_slider.addEventListener(Event.CHANGE,sliderHandler);

            // Respond to textfield events
            hexc1_txt.addEventListener(Event.CHANGE,changeHexHandler);
            hexc2_txt.addEventListener(Event.CHANGE,changeHexHandler);
            hexc3_txt.addEventListener(Event.CHANGE,changeHexHandler);
            c1_txt.addEventListener(Event.CHANGE,changeRGBHandler);
            c2_txt.addEventListener(Event.CHANGE,changeRGBHandler);
            c3_txt.addEventListener(Event.CHANGE,changeRGBHandler);

            // Draw a frame later
            addEventListener(Event.ENTER_FRAME,draw);

        }

        //*************************
        // Initialization:

        protected function draw(event:Event):void
        {

            // Set color transformations
            swatch1_btn.chipfill.transform.colorTransform = new ColorTransform(0,0,0,1,127,0,97);
            swatch2_btn.chipfill.transform.colorTransform = new ColorTransform(0,0,0,1,130,0,0);
            swatch3_btn.chipfill.transform.colorTransform = new ColorTransform(0,0,0,1,10,106,0);
            swatch4_btn.chipfill.transform.colorTransform = new ColorTransform(0,0,0,1,0,51,51);
            swatch5_btn.chipfill.transform.colorTransform = new ColorTransform(0,0,0,1,0,51,102)
            swatch6_btn.chipfill.transform.colorTransform = new ColorTransform(0,0,0,1,127,127,127);
            previewBox_btn.transform.colorTransform = new ColorTransform(0,0,0,1,c1,c2,c3);

            // Handle listeners...
            removeEventListener(Event.ENTER_FRAME,draw);
        }

        //*************************
        // Event Handling:

        protected function dragPressHandler( event:MouseEvent ):void
        {
            activeSwatch = new Swatch();
            activeSwatch.transform.colorTransform = new ColorTransform(0,0,0,1,c1,c2,c3);
            activeSwatch.addEventListener(MouseEvent.MOUSE_UP,dragReleaseHandler);          
            activeSwatch.startDrag(true);
            addChild(activeSwatch);
        }

        protected function dragReleaseHandler( event:MouseEvent ):void
        {
            if( activeSwatch.hitTestObject(car) ){
                car.transform.colorTransform = new ColorTransform(0,0,0,1,c1,c2,c3);
            }
            activeSwatch.stopDrag();
            activeSwatch.removeEventListener(MouseEvent.MOUSE_UP,dragReleaseHandler);           
            removeChild(activeSwatch);
        }

        protected function clickHandler(event:MouseEvent):void
        {
            car.transform.colorTransform = new ColorTransform(0,0,0,1,c1,c2,c3);
        }

        protected function changeRGBHandler(event:Event):void
        {
            c1 = Number(c1_txt.text);
            c2 = Number(c2_txt.text);
            c3 = Number(c3_txt.text);

            if(!(c1>=0)){
                c1 = 0;
            }
            if(!(c2>=0)){
                c2 = 0;
            }
            if(!(c3>=0)){
                c3 = 0;
            }
            hexc1_txt.text = c1.toString(16);
            hexc2_txt.text = c2.toString(16);
            hexc3_txt.text = c3.toString(16);

            updateSliders();
        }

        protected function changeHexHandler(event:Event):void
        {
            c1 = parseInt("0x"+hexc1_txt.text);
            c2 = parseInt("0x"+hexc2_txt.text);
            c3 = parseInt("0x"+hexc3_txt.text);

            if(!(c1>=0)){
                c1 = 0;
            }
            if(!(c2>=0)){
                c2 = 0;
            }
            if(!(c3>=0)){
                c3 = 0;
            }
            c1_txt.text = c1.toString();
            c2_txt.text = c2.toString();
            c3_txt.text = c3.toString();

            updateSliders();
        }

        protected function sliderHandler( event:SliderEvent ):void
        {
            switch( event.target )
            {
                case red_slider:

                    c1 = red_slider.value;
                    break;

                case green_slider:

                    c2 = green_slider.value;
                    break;

                case blue_slider:

                    c3 = blue_slider.value;
                    break;
            }
            updateFields();
        }

        protected function swatchHandler(event:MouseEvent):void
        {
            switch( event.target.parent )
            {
                case swatch1_btn:

                    c1 = 127;
                    c2 = 0;
                    c3 = 97;
                    break;

                case swatch2_btn:

                    c1 = 130;
                    c2 = 0;
                    c3 = 0;
                    break;

                case swatch3_btn:

                    c1 = 10;
                    c2 = 106;
                    c3 = 0;
                    break;

                case swatch4_btn:

                    c1 = 0;
                    c2 = 51;
                    c3 = 51;
                    break;

                case swatch5_btn:

                    c1 = 0;
                    c2 = 51;
                    c3 = 102;
                    break;

                case swatch6_btn:

                    c1 = 127;
                    c2 = 127;
                    c3 = 127;
                    break;
            }
            updateFields();
            updateSliders();
        }

        //*************************
        // Utils:

        protected function updateFields():void
        {
            hexc1_txt.text = c1.toString(16);
            hexc2_txt.text = c2.toString(16);
            hexc3_txt.text = c3.toString(16);

            c1_txt.text = c1.toString();
            c2_txt.text = c2.toString();
            c3_txt.text = c3.toString();

            previewBox_btn.transform.colorTransform = new ColorTransform(0,0,0,1,c1,c2,c3);
        }

        protected function updateSliders():void
        {
            red_slider.value = c1;
            green_slider.value = c2;
            blue_slider.value = c3;

            previewBox_btn.transform.colorTransform = new ColorTransform(0,0,0,1,c1,c2,c3);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:43:43.383

我认为您的问题是您以前使用 Drawing5 作为文档类。现在您想在第 4 帧中单独运行它。为此，您需要为 Drawing5 类提供对您的 swfs 阶段的引用，以便它现在知道在哪里可以找到所有这些对象。

```
var d5:Drawing5 = new Drawing5(this); 
```

然后向 Drawing5 类添加一个名为 _container （或其他东西）的属性

```
private var _container:MovieClip; 
```

然后在您的 Drawing 5 构造函数中，更改它以适应新的 var 并设置容器

```
public function Drawing5(container:MovieClip){
    _container = container;
} 
```

然后在 Drawing5 中，更改引用列表或按钮等对象的所有调用，以将容器包含在路径中，如下所示：

```
// Respond to mouse events
_container.swatch1_btn.addEventListener(MouseEvent.CLICK,swatchHandler,false,0,false); 
```

我希望我正确理解了您的问题，这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T00:36:20.943

问题是当您加载/调用此类时，它正在寻找舞台上的对象，如果它们不存在，它将引发错误。所以你不应该调用它，直到它与它正在寻找的项目在同一个框架上。因此，如果您要查找的所有项目都在第 4 帧上，那么您应该调用它。

所以转到第 4 帧并添加以下代码：

```
var myDrawings5 = new Drawing5(); 
```

另一种选择是将当前在构造函数中的代码移动到一个名为 init() 的新公共函数中。然后，您可以随时加载该类，但在项目出现在舞台上之前不要调用 init()。

```
public function Drawing5(){
  // now emtpy
}

public function init(){
  // move code from Drawing5() here
} 
```

然后加载它并在需要的地方调用它

```
var myDrawings5 = new Drawing5();
myDrawings5.init(); 
```

# asp.net - Asp.net mvc，实体框架，Poco - 架构

> ID：13113566
> 
> 赞同：0
> 
> 时间：2012-10-28T22:18:36.983
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, entity-framework, poco

我有一个“小型”企业应用程序，带有 POCO 实体和存储库模式的 aspnet mvc 3 + 实体框架。我在 4 个项目中构建了解决方案：

1.  POCO 实体
2.  领域模型
3.  服务
4.  Web应用程序

当应用程序对数据库执行查询时，使用提供的服务之一，该服务使用存储库和小类，因此我有一些动态代理对象，我想在使用它们之前在我的域实体中转换它们在 mvc 视图中，但我不知道如何。Dovrebber 被设置为翻译？

这种做法合理吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T02:48:48.017

不确定正在使用的“小类”是什么，但我假设您将希望使用一些 IOC 能够将您的存储库注入服务层。在此处查看更多信息：http: [//msdn.microsoft.com/en-us/magazine/dd942838.aspx#id0420033](http://msdn.microsoft.com/en-us/magazine/dd942838.aspx#id0420033)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T01:22:06.647

[AutoMapper](http://automapper.org/)可以方便地将对象从一种类型转换为另一种类型。如果所有目标类型属性都具有相应命名的源类型属性，它通常会“做正确的事”，并且任何不匹配的属性都可以使用 lambda 表达式轻松地手动映射。

# php - PHP - 列出数据库条目的内容

> ID：13113567
> 
> 赞同：-1
> 
> 时间：2012-10-28T22:18:37.823
> 
> 标签：php, database, phpmyadmin

我正在尝试通过 php 列出 db 表中的所有条目。

这是数据库的预览：

![在此处输入图像描述](../Images/eb8cfdc3d6290facf20953019b1a7d05.png)

这是我的php代码：

```
<?PHP
include('config.php');
$db_found = mysql_select_db($dbase, $db_handle);
if ($db_found) 
{
    $xSQL = "SELECT * FROM Logins";
    $result = mysql_query($xSQL);
    while ($db_field = mysql_fetch_assoc($result)) 
    {
        echo $db_field['Username'] . ":" . $db_feild['Password'] . '<br />';    
    }
}
else 
    {
        print "Database NOT Found ";
        mysql_close($db_handle);
    }
?> 
```

这是最终结果：

![在此处输入图像描述](../Images/2cdffc5cf2601653942153b93de7d929.png)

我希望结果显示：

用户名2：密码1

用户名1：密码1

我错过了我的代码中的错误（如果有）。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:20:37.743

检查你的回声，上面写着：$db_feild

它应该是 $db_field

希望能解决它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:21:57.023

如果你剪切/粘贴你的代码，你拼错了 $db_field['Password']

# python - 解压缩具有深层目录结构的存档时出现 Python IOError 异常

> ID：13113568
> 
> 赞同：4
> 
> 时间：2012-10-28T22:18:53.783
> 
> 标签：python, filenames, zipfile, ioerror

尝试使用 zipfile 模块的 extractall 方法提取 zip 文件时出现以下错误：

```
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
File "C:\Python27\lib\zipfile.py", line 964, in extractall
self.extract(zipinfo, path, pwd)
File "C:\Python27\lib\zipfile.py", line 952, in extract
return self._extract_member(member, path, pwd)
File "C:\Python27\lib\zipfile.py", line 996, in _extract_member
target = file(targetpath, "wb")

IOError: [Errno 2] No such file or directory: 'D:\\GITHUBDB\\C++\\FellowTraveler
_Open-Transactions\\FellowTraveler-Open-Transactions-846a939\\sample-data\\no_ba
skets\\client_data\\purse\\tBy5mL14qSQXCJK7Uz3WlTOKRP9M0JZksA3Eg7EnnQ1\\T1Q3wZWg
eTUoaUvn9m1lzIK5tn5wITlzxzrGNI8qtaV\\CvHGtfOOKzQKL5hFL7J4iF5yAodVKhS1rxPzME5R9XA' 
```

发生这种情况是因为 Windows 260 字符的路径限制。做 cd 不是一种选择，大部分路径来自存档本身。我已阅读有关“\\?\”前缀的信息，但将其添加到 extractall 参数不起作用，它在 zipfile 模块内的 os.mkdir 上失败。

用 "\\?\" 修复 zipfile.py 似乎是可能的，但这是一个丑陋的解决方案。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-12T08:54:25.173

在 Windows 上，有一种方法可以支持长文件路径。只需确保您的路径是 unicode、绝对路径并添加`\\?\`前缀即可。例如：

```
zip = ZipFile(zip_filename)
zip.extractall(u'\\\\?\\D:\\a_long_path') 
```

我已经用`ZipFile`python 2.7 上的类对其进行了测试，并且效果很好。

[您可以在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx)阅读有关 Windows 上文件命名的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-18T09:32:43.317

我不必将路径编码为 un​​icode，但我必须将路径更改为绝对路径并在此绝对路径之前添加 '\\?\'。

# prolog - 带有动物的 Prolog 语句/命令（逻辑帮助）

> ID：13113574
> 
> 赞同：2
> 
> 时间：2012-10-28T22:19:42.687
> 
> 标签：prolog, logic

我想知道如何让这样的事情发挥作用。这似乎是一个简单的概念，但我对 Prolog 很陌生，我似乎无法弄清楚如何正确地做到这一点。

例如，这里有两个表。每只动物，无论属于哪个类别，都有两个事实。

哺乳动物：

虎纹，有力

河马——大而危险

大象——大而温柔

昆虫：

飞 - 黑色，有翼

毛毛虫 - 绿色，缓慢

蜗牛——黏糊糊的，慢的

我将如何在 Prolog 代码中编写所有这些语句，以便将苍蝇及其特征归类为昆虫，将河马及其特征归类为哺乳动物？

那么，如果我插入这样的规则呢？

```
guess(mammal, large) 
```

在查阅代码后，我会写出这个命令：

```
possibleanimal(mammal, X) 
```

该命令的结论是：

```
X = hippo 
X = elephant 
```

因为河马和大象都有大的特点。

另一个例子：

```
guess(insect, slow) 
guess(insect, green) 
```

指挥部咨询后问：

```
possibleanimal(insect, Y) 
Y= caterpillar 
```

我们可以省略蜗牛，因为即使它很慢，它也不是绿色的。

请尽一切可能帮助我，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T11:43:36.870

第一个例子看起来像传递性，所以试试这个：

```
% animal(Animal, Property)
animal(tiger, striped).
animal(tiger, powerful).
animal(hippo, large).
animal(hippo, dangerous).
animal(elephant, large).
animal(elephant, gentle).

% guess(Category, Property)
guess(mammal, large).

% possibleanimal(Category, Animal)
possibleanimal(C, A) :-
       guess(C, P),
   animal(A, P).

?- possibleanimal(mammal, X).
X = hippo ;
X = elephant 
```

现在棘手的部分是第二个例子，因为我们有多个guess/2。

我猜你希望他们同时持有。所以你需要一种forall。

Forall 可以在 Prolog 中定义如下：

```
% forall(Goal,Goal)
forall(A, B) :- \+ (A, \+ B). 
```

参见例如： [http ://www.swi-prolog.org/pldoc/man?predicate=forall%2F2](http://www.swi-prolog.org/pldoc/man?predicate=forall%2F2)

所以你可以试试这个：

```
% possible(Animal)
    possible(fly).
    possible(caterpillar).
    possible(snail).

    % animal(Animal, Property)
animal(fly, black).
animal(fly, winged).
animal(caterpillar, green).
animal(caterpillar, slow).
animal(snail, slimy).
animal(snail, slow).

% guess(Category, Property)
guess(insect, green).
guess(insect, slow).

% possibleanimal(Category, Animal)
    possibleanimal(C, A) :-
        possible(A),
        forall(guess(C,P), animal(A,P)).

?- possibleanimal(insect,X).
X = caterpillar ;
No 
```

希望这可以帮助。

再见

# c - 来自写入的 stdio 数据未写入文件

> ID：13113577
> 
> 赞同：0
> 
> 时间：2012-10-28T22:19:52.690
> 
> 标签：c, file-io, stdio

我在使用 stdio 命令处理文件中的数据时遇到问题。简而言之，当我将数据写入文件时，write 返回一个表明它成功的 int，但是当我读回它时，我只得到旧数据。

这是代码的精简版本：

```
fd = open(filename,O_RDWR|O_APPEND);

struct dE *cDE = malloc(sizeof(struct dE));

//Read present data
printf("\nreading values at %d\n",off);
printf("SeekStatus <%d>\n",lseek(fd,off,SEEK_SET));
printf("ReadStatus  <%d>\n",read(fd,cDE,deSize));

printf("current Key/Data <%d/%s>\n",cDE->key,cDE->data);

printf("\nwriting new values\n");
//Change the values locally 
cDE->key  = //something new
cDE->data = //something new

//Write them back
printf("SeekStatus  <%d>\n",lseek(fd,off,SEEK_SET));
printf("WriteStatus <%d>\n",write(fd,cDE,deSize));

//Re-read to make sure that it got written back
printf("\nre-reading values at %d\n",off);
printf("SeekStatus <%d>\n",lseek(fd,off,SEEK_SET));
printf("ReadStatus  <%d>\n",read(fd,cDE,deSize));

printf("current Key/Data <%d/%s>\n",cDE->key,cDE->data); 
```

此外，如果您想知道，这里是 dE 结构：

```
struct dE {
    int key;
    char data[DataSize];
}; 
```

这打印：

```
reading values at 1072
SeekStatus <1072>
ReadStatus  <32>
current Key/Data <27/old>

writing new values
SeekStatus  <1072>
WriteStatus <32>

re-reading values at 1072
SeekStatus <1072>
ReadStatus  <32>
current Key/Data <27/old> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:44:11.667

`|O_APPEND`从`open`通话中删除。

# c# - RGB，如何生成匹配的调色板？

> ID：13113578
> 
> 赞同：0
> 
> 时间：2012-10-28T22:19:53.690
> 
> 标签：c#, algorithm

我正在开发一个应用程序，我必须在其中使用一些 RGB 颜色。实际上，我有 RGB 和它的 HEX/HSV 等价物。

现在，我正在尝试为所选颜色动态生成匹配颜色，比如说“红色”，然后我想为红色生成 5 种匹配颜色，例如：黑色、橙色、其他红色调、一些蓝色等。 .

我不了解颜色及其计算的工作原理，因此将不胜感激任何帮助、提示、代码片段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T14:44:59.797

HSV 是比 RGB 更好的颜色空间，因为 HSV 的轴直接对应于有用的颜色转换。

要使颜色更亮或更饱和，请增加其饱和度。要降低饱和度（制作灰度），请降低饱和度。降低颜色的 V(alue) 会使颜色变暗 - V 为 0 的所有颜色都是黑色。改变色调会改变颜色本身，围绕色轮移动。有关详细信息，请参阅 Wikipedia[关于 HSV 的文章。](http://en.wikipedia.org/wiki/HSL_and_HSV)

您所做的转换取决于您想要生成什么样的相关颜色。例如，如果您想要互补色，您可能想要获取颜色，保持 S 和 V 不变，并从当前颜色生成色轮周围 1/3 和 2/3 的颜色。通过改变值可以制作更亮和更暗的版本，而通过改变饱和度可以制作更多和更少的“强烈”颜色。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-29T01:03:58.323

RGB 颜色只是内存中的一个空间，其中有三个值，每个值的范围从 0 到 255。例如，红色在内存位置的“红色”字段中只是 255、0、0...255（最大值） ，在“蓝色”和“绿色”中为零。当您混合这些不同的值时，您开始获得我们在屏幕上看到的几乎无限的颜色阵列。

我不能完全告诉你如何处理你的代码而不看它，但我可以告诉你，如果你有一个控件或对象，其中你有一个 RGB 属性，你可以修改所述属性中的值以使颜色为控件或对象您想要的任何颜色。尝试查看哪些值会产生您想要的颜色，然后以您寻求的动态方式将这些值输入到属性字段中。

# jpa - 避免 JPA 多对一中的重复

> ID：13113581
> 
> 赞同：0
> 
> 时间：2012-10-28T22:20:16.023
> 
> 标签：jpa, eclipselink

我之前已经为 Hibernate 询问过这个问题的变体。但是，我现在正在使用 Eclipselink，但它仍然困扰着我。这很简单：

我需要在多对一关系中保留一个包含城市名称的地址对象。我希望能够保留地址并级联拯救城市 - 但前提是城市是独一无二的。据我了解，这不是 JPA 直接支持的吗？可能的解决方案包括使用城市名称作为城市表中的唯一 ID，并在城市表中查询特定城市，然后在保存之前将该对象添加到地址中。我当然已经看到几个 StackOverflow 问题/答案似乎表明这是方法（[JPA 级联持续存在 - 多对一](https://stackoverflow.com/questions/7049264/jpa-cascade-persist-many-to-one)）

我在这里错过了什么吗？有替代/更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:30:10.010

是的，解决方案是从数据库中获取城市，如果不存在则创建它，并将其设置为地址。

没有办法解决这个问题。不过，城市名称不必是主键。我将使用自动生成的、非功能性的代理键作为 PK，并在城市名称上添加唯一约束。这至少可以让您修复城市名称中的拼写错误，而无需更新引用它们的数千个地址。

# jquery - 如何使用 jquery 遍历复选框列表？

> ID：13113586
> 
> 赞同：2
> 
> 时间：2012-10-28T22:20:46.060
> 
> 标签：jquery

如何使用 jquery 遍历复选框列表？

这是代码...

```
 $("input:checked").parent().find("strong").text(); 
```

试过这个，但没有工作......

```
 $("input:checked").parent().find("strong").text().each(function()
         {
             alert(this);
         }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:23:15.773

```
$.each($('input[type=checkbox]'), function(){
   doSomething();
}); 
```

# performance - Push（即Netty）与Pull（即Nginx）的实时“ping”服务器？

> ID：13113587
> 
> 赞同：0
> 
> 时间：2012-10-28T22:20:59.363
> 
> 标签：performance, architecture, nginx, netty

想象一个应用程序，它每分钟接收新闻更新之类的东西。

使用像 Netty 这样的东西来构建服务器端会更有效吗？它会维护连接并每分钟推送一次数据，或者像 nginx/php 这样的东西会在每次拉取请求时断开/打开连接?

每个请求都需要为该用户定制的数据库查找（即无缓存）和一些基本处理（即加密/解密）

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T04:35:04.323

每分钟一次听起来不应该给您的基础架构带来太多负载，所以我会说哪种方式对您来说最简单。

但是，如果容量是一个问题，我会说推送方法更好，因为它只会在有数据时发送。无论是否有数据要检索，pull 方法都会占用资源。

希望这可以帮助。

# jquery - 带有方形图像的网格布局（溢出隐藏）

> ID：13113589
> 
> 赞同：0
> 
> 时间：2012-10-28T22:21:21.813
> 
> 标签：jquery, css, jquery-mobile

我正忙于网格布局，网格的每个 div 中都有图像。但我想让每个图像都成为一个正方形，所以必须隐藏所有溢出。我唯一的问题是，宽度设置为 '20%' 如何让高度成为该 div 的确切宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:27:07.657

您可以使用`padding-bottom:100%`

此技术对于保持对象的纵横比（在您的情况下为平方比）非常有用。唯一的缺点是`div`必须设置为`position:relative`并且内部必须有带有 的元素`position:absolute`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T23:28:16.020

感谢 Carlos Martinez，这就是我所需要的：http: [//jsfiddle.net/wSbnj/2/](http://jsfiddle.net/wSbnj/2/)

```
div#image {
    box-sizing: border-box; 
    border:1px solid red;
    position:relative;
    width:50%;
    padding-bottom:50%;
    overflow:hidden;
}
div#image img {
    position:absolute;
    width:100%;
}
​
<div id="wrapper">
    <div id="image"><img src="http://static.zara.net/photos//2012/I/0/2/p/5618/655/802/5618655802_1_1_3.jpg?timestamp=1350490400442"></div>
</div> 
```

​</p>

# iphone - 在框架中找不到 default.styleproto

> ID：13113594
> 
> 赞同：2
> 
> 时间：2012-10-28T22:21:59.397
> 
> 标签：iphone, ios, xcode, ios-simulator

由于这个原因，它没有显示任何图形，而这只是发生了。在此新更新发布之前，一切正常。我创建了一个新项目来测试我是否搞砸了原来的项目，但仍然是同样的问题。我也重复了这些步骤，但我一直在对象文件夹中的实际地图视图中找到问题的根源，以便您将其添加到情节提要中。它似乎不在 Mapkits 框架中，但我可能错了。

这似乎是因为苹果的开关，现在他们没有谷歌支持他们的地图，我在网上找不到关于这个解决方案的任何东西。

我只想显示一个地图视图并显示两个带方向的点。有没有办法通过新的苹果更新来做到这一点？

# c++ - 数字和字母散列的数学

> ID：13113595
> 
> 赞同：2
> 
> 时间：2012-10-28T22:22:02.187
> 
> 标签：c++, encryption, hash

散列使​​用一种读取文件内部数据的方法，并在数学上从中创建数字和字母。C++ 中的数学方程如何做到这一点？

我正在尝试使用 C++ 和 Visual Studio 创建一个应用程序，该应用程序读取数据文件并从中获取 SHA-256 哈希和。然后应用一个等式将其更改为不同的数字和字母，但字符更少。这个处理过的数字和字母将用作 7zip 或 rar 文件的密码。（不确定哪个更适合加密）

这是为了缓解互联网爬虫访问内容和不应该访问内容的人。我不希望它能够完全锁定一个人。

此外，它必须是可转码的。所以它必须能够从哈希到传递，最好是从传递到哈希。

如果有人可以在这方面帮助我，我将非常感激，我会在积分页面中为您提供一个位置，并提供指向您的个人资料的链接或任何您想要的链接：3。

如果您有任何其他问题或信息，请随时给我发消息。

图形用户界面图片：

[![](../Images/de54f2391a2413274585c20729de2fca.png)](https://www.mediafire.com/conv/44920d49859597e250903c93a8ac62629a37a1b31c633059bebf64f25ffbef776g.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T14:21:51.397

你根本不是在寻找哈希。如果您想要从编码到原始的可逆性，您需要加密。有很多方法可以加密某些东西，但一种非常简单的方法是使用[Everpassword 的 AES](http://www.everpassword.com/aes-encryptor)或[Crypto.org 的 RC4](http://www.crypo.org/tools/eng_rc4.php)之类的东西，并使用其他密码作为密钥。（如果你真的不在乎，你甚至可以使用空白密钥，它仍然会编码为看起来随机的东西。）主要区别在于 AES 通常需要填充（忽略 CTR 模式），因此它会产生更长的结果, 但 RC4 的大小与输入的大小完全相同。在上面的链接中，Bo 是通过 base64 转换扩展出来的。

不过，我真的不明白为什么您希望能够获得原始密码。我看不到一个用例可以给某人密码，然后让他们发现生成密码的原始短语以满足他们的好奇心，而您只需要加密的短语来做任何有用的事情。您不妨使用哈希中的几个字符，因为没有人会关心您是如何想到它的。

此外，哈希和密码不提供数字和字母。它们给出 1 和 0 - 数字和字母只是我们想要比较或键入它们时可视化它们的一种方便方式，因为我们不能很容易地处理原始二进制文件。但是，有许多可能的表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T19:14:32.170

看来你需要的很简单。（虽然为这个问题找到一个优雅的数学解决方案可能很有趣，但实际上没有必要）SHA-256 是一个 32 字节长的数组。您看到的字母和数字只是数组的十六进制表示。由于十六进制数字需要 4 位数据，因此两个字母或数字（或字母和数字）的每个组合代表 1 个字节。这就是为什么您需要一个 64 长的字符串来表示一个 32 字节的数组。

据我所知，WinRar 的密码限制为 177 个字符，而 7z 则没有限制。从理论上讲，您可以使用原始的 64 字符 SHA-256 表示形式作为密码。生成的密码非常强大，因为它有 16^64 == 2^256 种组合。

然而，碰巧 - 使用 Base64 编码可以生成更短但更强大的密码（维基百科是一个很好的起点）。使用 Base64，您的 32 字节数组可以表示为 43 个字符长的密码，由大写和小写字母以及 9 位数字和 + 和 / 字符组成。所以你得到 64^43 > 2^256。

您可以轻松地将 Base64 字符串转换回哈希。

**附带说明：** 您应该注意到，由于 AES256 使用 256 位密钥，因此生成更强的密码实际上是毫无用处的，因为在这种情况下，攻击者可以攻击密钥并忽略密码，因此使用 SHA-256 真的足够了。但我喜欢这样一个事实，即我们可以生成一个比 64 个字符长的密码更强大的 43 个字符长的密码。

**还有一个注意事项：** 根据您将使用的压缩器接受的字符类型作为密码字符，您可以设计自己的 Base128 编码并将字符数减少到 37 个。

我还建议使用 7z，因为它既快速、功能强大，又是最后但并非最不重要的开源。

# c# - WCF Windows 服务错误：套接字连接已被释放

> ID：13113596
> 
> 赞同：2
> 
> 时间：2012-10-28T22:22:02.293
> 
> 标签：c#, wcf, sockets, windows-services

我有 2 个 WCF 服务，它们都本地安装在同一个 Windows 服务上。2 个 WCF 服务调用同一个数据库并使用 Net TCP 绑定。

旁注：我创建了 2 个服务而不是 1 个，因为该服务的方法太多，因此 XML 文件太大，我无法将服务引用添加到消费者应用程序。此外，这种方式更具可读性。

在客户端应用程序上，我添加了对两个 WCF 服务的服务引用。为了使用这些服务，我扩展了 CommunicationObject，使其具有“Using()”方法：参见下面的代码。

**.Using() 方法的通信对象扩展**

```
public static class CommunicationObjectExtensions
{
    public static void Using<T>(this T client, Action<T> work)
        where T : ICommunicationObject
    {
        try
        {
            // make sure client is open
            //client.Open(); // didn't work                
            work(client);
        }
        catch (CommunicationException e)
        {
            client.Abort();
            throw;
        }
        catch (TimeoutException e)
        {
            client.Abort();
            throw;
        }
        catch (Exception e)
        {
            client.Abort();
            throw;
        }
        finally
        {
            client.Close();
        }
    }
} 
```

**服务电话**

```
new ServiceClientA().Using(client =>
    {
        var someObjectA = client.GetSomeObjectA();
    });
new ServiceClientB().Using(client =>
    {
        var someObjectB = client.GetSomeObjectB();
    }); 
```

当 ServiceClientB 的方法实际上有要返回的数据（相对于空列表）并返回（我能够调试并完成整个服务调用）时，我收到“套接字连接已被处理”错误。

使用指向不同数据库的其他 WCF 服务时，我没有遇到此问题。

有人知道发生了什么吗？

**更新**

好的，事实证明它只发生在我调用的方法（client.GetSomeObjectB（））中。它返回的对象导​​致错误。显然这是因为对象太大了，但这应该不是问题（因为我只返回 1 个小对象）。

# c++ - 我如何重载模板类的下标运算符

> ID：13113599
> 
> 赞同：1
> 
> 时间：2012-10-28T22:22:25.680
> 
> 标签：c++, templates, hash, hashmap, overloading

我必须基本上编辑一个二次探测文件才能作为 hash_map 库工作，但我无法重载下标运算符，因此我可以修改该特定索引。

我到目前为止的代码是：

```
template <typename HashedObj, typename storedObj >
class HashTable
{
public:
    int& operator [] (const int nIndex)
    {
        return array[nIndex];//THIS IS WHATS WRONG
    }

    //create hashtable with siz of 101
    explicit HashTable(int size = 101) : array( nextPrime( size ) )
    { makeEmpty( ); }

    //return true if current index is active
    bool contains( const HashedObj & x ) const
    {
        return isActive( findPos( x ) );
    }

    //initiallize index as empty
    void makeEmpty( )
    {
        currentSize = 0;
        for( int i = 0; i < array.size( ); i++ )
            array[ i ].info = EMPTY;
    }

    //insert object into hash index and mark index as active
    bool insert( const HashedObj & x )
    {
        // Insert x as active
        int currentPos = findPos( x );
        if( isActive( currentPos ) )
            return false;

        array[ currentPos ] = HashEntry( x, ACTIVE );

        if( ++currentSize > array.size( ) / 2 )
            rehash( );

        return true;
    }

    //search for obj and mark index as deleted
    bool remove( const HashedObj & x )
    {
        int currentPos = findPos( x );
        if( !isActive( currentPos ) )
            return false;

        array[ currentPos ].info = DELETED;
        return true;
    }

    //declare three different entry types
    enum EntryType { ACTIVE, EMPTY, DELETED };

private:
    //each hash index stores the following
    struct HashEntry
    {
        //THIS WILL BE STRINGS OR INTS
        HashedObj element;
        //THIS WILL BE VECTOR STRINGS
        storedObj ilement; 
        //index status is stored
        EntryType info;
        //each entry is made of hashed obj and stored obj and the status is empty
        HashEntry( const HashedObj & e = HashedObj( ), const storedObj & f = storedObj( ),EntryType i = EMPTY )
        : element( e ), ilement( f ),info( i ) { }
    };

    //create an array of hashentries
    vector<HashEntry> array;
    //currentsize of the hash table is stored here
    int currentSize;

    bool isActive( int currentPos ) const
    { return array[ currentPos ].info == ACTIVE; }

    int findPos( const HashedObj & x ) const
    {
        int offset = 1;
        int currentPos = myhash( x );

        while( array[ currentPos ].info != EMPTY &&
              array[ currentPos ].element != x )
        {
            currentPos += offset;  // Compute ith probe
            offset += 2;
            if( currentPos >= array.size( ) )
                currentPos -= array.size( );
        }

        return currentPos;
    }

    void rehash( )
    {
        vector<HashEntry> oldArray = array;

        // Create new double-sized, empty table
        array.resize( nextPrime( 2 * oldArray.size( ) ) );
        for( int j = 0; j < array.size( ); j++ )
            array[ j ].info = EMPTY;

        // Copy table over
        currentSize = 0;
        for( int i = 0; i < oldArray.size( ); i++ )
            if( oldArray[ i ].info == ACTIVE )
                insert( oldArray[ i ].element );
    }
    int myhash( const HashedObj & x ) const
    {
        int hashVal = hashing( x );

        hashVal %= array.size( );
        if( hashVal < 0 )
            hashVal += array.size( );

        return hashVal;
    }
};

int hashing( const string & key );
int hashing( int key ); 
```

关键是主代码能够执行以下操作：

```
wordsByLength[words[i].length()] = words[i]; 
```

其中 words[i] 将是一个向量。我还假设我稍后需要修改 = 运算符，但我不太确定

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:28:22.347

想想你的下标运算符应该返回什么。是`int&`吗？最简单的选择是 HashEntry：

```
template <typename HashedObj, typename storedObj >
class HashTable
{
public:
    HashEntry& operator [] (int nIndex) // read/write version
    {
        return array[nIndex];
    }

    const HashEntry& operator [] (int nIndex) const // read only version
    {
        return array[nIndex];//THIS IS WHATS WRONG
    }
...
}; 
```

但它是私人的。因此，要么将其公开-但这会以某种方式破坏您的封装。

因为您正在插入 HashedObj - 那么这可能是您想要的返回类型：

```
template <typename HashedObj, typename storedObj >
class HashTable
{
public:
    HashedObj& operator [] (int nIndex) // read/write version
    {
        return array[nIndex].element;
    }

    const HashedObj& operator [] (int nIndex) const // read only version
    {
        return array[nIndex].element;
    }
...
}; 
```

# php - On If 语句插入数据库

> ID：13113601
> 
> 赞同：1
> 
> 时间：2012-10-28T22:22:36.723
> 
> 标签：php, mysql

我想做一个 if 语句，当用户单击提交时将特定内容插入 MySQL 数据库。但是由于某种原因它不起作用，我认为我下面的 if 语句是错误的，但我不知道如何表达它。`if($_POST and $_POST['action'] == 'submit'){` 我应该在此处正确放置什么以使其在用户按下提交时将其插入到数据库中？

```
if($_POST and $_POST['action'] == 'submit'){ 
    foreach($_POST as $k=>$v){
        $$k = $v;
    }
    foreach($cat as $k=>$v){
        if($v =='') continue;
        dbConnect("INSERT INTO twit_info(cat_id) values('". $v ."')");
    }
} 
```

下面是我的代码的提交部分。

```
<form id="add_tweet_form" action="<?=$u?>admin/submit.php" enctype="multipart/form-data" method="post">
<input type="hidden" value="<?=$user_info->id_str?>" name="twitid">
</form>
<form id="go_back_to_user" action="submit" method="post">
<input type="hidden" value="masud" name="username">
<input type="hidden" value="from_tweet" name="submit_username">
</form>
<nav>
<a class="btn float-right" onclick="document.forms['add_tweet_form'].submit();this.innerHTML='Submitting...';" href="javascript:;">Submit</a>
<a class="float-right nav-text gray" title="Don't submit tweet, and go back"  onclick="window.location.href='<?=$u?>admin/submit.php';" href="javascript:;">Cancel</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:34:51.207

可以做这一行：

```
if($_POST and $_POST['action'] == 'submit'){ 
```

像这样：

```
if(isset($_POST['action']) && $_POST['action'] == 'submit'){ 
```

表格：

```
<form id="add_tweet_form" action="<?=$u?>admin/submit.php" enctype="multipart/form-data" method="post">
    <input type="hidden" value="<?=$user_info->id_str?>" name="twitid"/>
    <input type="hidden" value="submitted" name="PostAction" />
</form>
<form id="go_back_to_user" action="submit" method="post">
    <input type="hidden" value="masud" name="username">
    <input type="hidden" value="from_tweet" name="submit_username">
</form>
<nav>
    <a class="btn float-right" onclick="document.forms['add_tweet_form'].submit();this.innerHTML='Submitting...';" href="javascript:;">Submit</a>
    <a class="float-right nav-text gray" title="Don't submit tweet, and go back"  onclick="window.location.href='<?=$u?>admin/submit.php';" href="javascript:;">Cancel</a> 
```

处理：

```
if($_POST['PostAction']) && $_POST['PostAction'] == 'submitted'){ 
    echo '<pre>';
    print_r($_POST); // to see if the right info is posted...
    echo '</pre>';
    foreach($_POST as $k=>$v){
        $$k = $v;
    }
    foreach($cat as $k=>$v){
        if($v =='') continue;
        dbConnect("INSERT INTO twit_info(cat_id) values('". $v ."')");
        echo 'We have inserted something <br />';
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:44:51.287

添加`<input type="hidden" name="add_tweet_form" value="true">`

然后检查`if(isset($_POST['add_tweet_form']) && $_POST['add_tweet_form']=='true')`

# php - 从图像精灵、css 和 php 生成图像

> ID：13113610
> 
> 赞同：0
> 
> 时间：2012-10-28T22:23:30.243
> 
> 标签：php, css, gd, sprite

我有一个带有几个图标的精灵，大约 30 个。我通过设置一个特定图标的背景位置来使用它们。但是现在，我想使用一个像图像这样的图标，例如，将它们放在 facebook og:img 元标记中。

那么，如何通过 php 和 GD 生成图标呢？

`mydomain.com/generate_icon.php?icon_id=5`

如果没有 GD，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:17:22.137

`how can i do this with GD or other method.. sorry for my English!!`这是一个带有GD的例子

```
$no = isset($_GET['no']) ? $_GET['no'] : 0; <---- Image Number via GET
$img = "sprites.png";
list($h, $w) = getimagesize($img);
$size = ($h < $w) ? $h : $w;

$src = imagecreatefrompng($img);
$dest = imagecreatetruecolor($size, $size);

imagecopy($dest, $src, 0, 0, 0, ($size * $no), $size, $size);

// Output and free from memory
header('Content-Type: image/png');
imagegif($dest); 
```

用法`image.php?no=5`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:34:01.903

试试看：http: [//phpthumb.sourceforge.net/](http://phpthumb.sourceforge.net/) - 很多选项，你可以用你想要的方式来做：`mydomain.com/generate_icon.php?icon_id=5`。裁剪和过滤的示例如下所示：`<img border="0" src="../phpThumb.php?src=images/loco.jpg&amp;w=300&amp;fltr[]=crop|50&amp;hash=6af23273fc8ec3513eca71d51b018f32" alt="">`

# jquery - jqueryui 自动完成过滤器结果（来自远程数据源）“开始于”输入

> ID：13113611
> 
> 赞同：5
> 
> 时间：2012-10-28T22:23:54.650
> 
> 标签：jquery, jquery-ui, jquery-ui-autocomplete

我正在使用[带有多个结果和远程数据源的 jquery 自动完成功能](http://jqueryui.com/autocomplete/#multiple-remote)。我能够远程提取数据并选择多个结果。**但是结果列表不会根据输入的前 2 个字符更新，并且 jQueryUI 文档在这个问题上很薄。**

我进行了研究，并在 SO 上找到[了这个答案](https://stackoverflow.com/a/2405109/1104878)，并希望将其与我的其他功能集成，但它不会更新结果列表。独立地，SO 答案可以正常工作，但在与多个结果和远程数据源集成时就不行了。

**从自动完成/远程源/多重功能（截断）。**这部分工作正常：

```
.autocomplete({
                source: function( request, response ) {                            
                     $.ajax({
                        url: "/controller/myfunction",
                        dataType: "json",
                        data: request,
                        success: function(data){
                        if(data.response == 'true') {
                            response(data.message);
                            }
                        }
                    });
                }, 
```

**SO的[可能解决方案](https://stackoverflow.com/a/2405109/1104878)**：（独立工作正常，但不适用于jquery/remote/multiple代码）：

```
var wordlist= [ "about", "above", "within", "without"];

$("#input1").autocomplete({
    source: function(req, responseFn) {
        var re = $.ui.autocomplete.escapeRegex(req.term);
        var matcher = new RegExp( "^" + re, "i" );
        var a = $.grep( wordlist, function(item,index){
            return matcher.test(item);
        });
        responseFn( a );
    }
}); 
```

我需要将此解决方案与我的代码集成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:45:44.047

从[jQuery UI 自动完成：从字符串开始搜索，](http://www.jensbits.com/2011/04/28/jquery-ui-autocomplete-search-from-beginning-of-string/)您可以尝试：

```
$("#YOUR_TEXT_INPUT").autocomplete({
    source: function(req, response) { 
       $.ajax({
        url: "/controller/myfunction",
        dataType: "json",
        success: function( data ) {
            var re = $.ui.autocomplete.escapeRegex(req.term);
            var matcher = new RegExp( "^" + re, "i" );
            response($.grep(data, function(item){return matcher.test(item.value);}) );
            }
        });
     },
      minLength: 2,
      select: function(event, ui) {
          //custom select function if needed
       }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T15:50:13.550

最佳情况下，它应该是以 JSON 格式提供过滤数据的控制器。我建议您最好尝试在控制器中而不是在视图中过滤数据。如果您的应用程序是面向 MVC 的，您应该将所有查询和过滤保留在您指定的控制器操作中使用的模型内。我确实认为应该使用 AJAX（异步 Javascript 和 XML）将尽可能多的负载传递给服务器。所以，你的视图代码会很简单

var wordlist = [“关于”，“以上”，“内”，“没有”]；

```
$("#input1").autocomplete({
    source: 'url-to-controller/myAction', //Notice I'm using a string
    minLength: 2
}); 
```

[自动完成|jQuery Ui - 来源](http://api.jqueryui.com/autocomplete/#option-source)指出：

> ...当使用字符串时，自动完成插件期望该字符串指向将返回 JSON 数据的 URL 资源。它可以在同一台主机上，也可以在不同的主机上（必须提供 JSONP）。自动完成插件不会过滤结果，而是添加一个带有`term`字段的查询字符串，服务器端脚本应该使用该字段过滤结果。例如，如果源选项设置为 `"http://example.com"`并且用户类型`foo`为 ，则会向 发出 GET 请求`http://example.com?term=foo`。数据本身可以采用与上述本地数据相同的格式。

基于上述，您可以修改控制器操作，使其使用`term`GET 请求，以便用于过滤查询中的数据。请务必让我知道它是如何进行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T19:41:06.897

当您将 $.ajax 与 json dataType 一起使用时，您的 data.message 是一个数组，您可以通过删除不必要的项目来过滤它。
假设 ajax msg Array 是从下面的示例 json 构建的，

```
{"id":"Nycticorax nycticorax","label":"Black-crowned Night Heron","value":"Black-crowned Night Heron"},{"id":"Ardea purpurea","label":"Purple Heron","value":"Purple Heron"},{"id":"Circus cyaneus","label":"Hen Harrier","value":"Hen Harrier"},{"id":"Alcedo atthis","label":"Common Kingfisher","value":"Common Kingfisher"},{"id":"Oxyura leucocephala","label":"White-headed Duck","value":"White-headed Duck"},{"id":"Oenanthe oenanthe","label":"Northern Wheatear","value":"Northern Wheatear"},{"id":"Tadorna tadorna","label":"Common Shelduck","value":"Common Shelduck"},{"id":"Ardea cinerea","label":"Grey Heron","value":"Grey Heron"},{"id":"Ficedula hypoleuca","label":"Eurasian Pied Flycatcher","value":"Eurasian Pied Flycatcher"},{"id":"Motacilla flava","label":"Blue-headed Wagtail","value":"Blue-headed Wagtail"},{"id":"Muscicapa striata","label":"Spotted Flycatcher","value":"Spotted Flycatcher"},{"id":"Accipiter gentilis","label":"Northern Goshawk","value":"Northern Goshawk"} 
```

所以我们想要检查“值”是否每个都以输入的术语开头。
你可以简单地用这个替换你的自动完成代码：

```
.autocomplete({
    source: function( request, response ) {                            
            $.ajax({
            url: "/controller/myfunction",
            dataType: "json",
            data: request,
            success: function(data){
                if(data.response == 'true') {
                    var t = true;
                    var i = 0;
                    var ptrn = new RegExp("^" + request.term, "i");
                    while (t) {
                        if (!ptrn.test(data.message[i].Name)) {
                            data.message.splice(i, 1)
                        } else {
                            i++
                        };
                        if (i == data.message.length) {
                            t = false;
                        }
                    }
                    response(data.message);
                }
            }
        });
    },
    ...
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T22:42:21.317

jQuery autcomplete 将用户输入的内容作为 HTTP 参数发送，因此您可以使用它来更改从数据库中获取的结果。

[这是一个示例](https://github.com/jcu-eresearch/Edgar/blob/64e890c3eb2cf55d0e36818ac142d55b306938b3/webapplication/app/Controller/SpeciesController.php#L366)（在 CakePHP 中）。它获取“term”参数，其中包含用户输入的内容，并使用它来生成数据库查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T09:33:47.950

```
 $("#certi_name").autocomplete({
                source: "/controller/myfunction",
                minLength: 2,
                select: function(event, ui) {
                    $('#certi_name').val(ui.item.value);
                    $('#certi_id').val(ui.item.id);

                }
            }); 
```

这是我的功能。我正在使用它并且工作正常。

```
function certificationsAction()
    {
        $cert_obj = new Model_Certification();
        $obj=$this->getRequest();
        $term=$obj->getParam('term');//You will get passing keyword with the name term
        if($term)
        {
            $ins_arrs=$cert_obj->getMatchingCertifications($term);
            $return_arr = array();
            foreach($ins_arrs as $ins)
            {
                $row_arr['id']=$ins['certification_id'];
                $row_arr['value']=$ins['certification_name'];
                array_push($return_arr, $row_arr);
            }
            echo json_encode($return_arr);die;
        }

    } 
```

# node.js - 将附加参数传递给 node.js callack

> ID：13113622
> 
> 赞同：1
> 
> 时间：2012-10-28T22:25:25.733
> 
> 标签：node.js

我创建了一个休息客户端来在我的应用程序之外进行调用。我想将从其余调用中收到的数据发送回客户端的 Web 浏览器。

类似于以下内容，但是构建代码以允许访问响应以尽可能松散耦合写回 Web 浏览器的最佳方式是什么？我不想在请求处理程序中定义其余客户端。

```
var servReq = http.request(options, function(restResponse){
    var status = restResponse.statusCode
    var headers = restResponse.headers
    restResponse.setEncoding("utf8");
    d='';
    restResponse.on('data', function(chunk){
        d += chunk;
    })
    restResponse.on('end', function(restResponse){
        // res would be a response to write back to the client's web browser
        // with the data received from the rest client.
        res.writeHead(200, {"content-type":"text/plain"})    
        res.write(d)
        res.end();
    })
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:47:01.783

使用[request](https://github.com/mikeal/request)，您可以将 API 响应直接传送到应用程序的响应。这样，它将完全松散耦合——您的服务器将准确地返回 API 返回的内容。

```
request(options).pipe(res); 
```

[https://github.com/mikeal/request#streaming](https://github.com/mikeal/request#streaming)

# powershell - PowerShell 运行的命令的捕获输出有时不完整

> ID：13113624
> 
> 赞同：0
> 
> 时间：2012-10-28T22:25:44.523
> 
> 标签：powershell, powershell-2.0

我正在从 PowerShell 脚本中运行 DTEXEC.exe 命令，尝试捕获输出并将其记录到文件中。有时输出不完整，我试图弄清楚为什么会出现这种情况以及可能会采取什么措施。似乎从未被记录的行是最有趣的：

```
DTEXEC: The package execution returned DTSER_SUCCESS(0)
Started:  10:58:43 a.m.
Finished: 10:59:24 a.m.
Elapsed:  41.484 seconds 
```

对于在不到 8 秒内执行的包，输出似乎总是不完整的，这可能是一个线索（输出不多或它们很快完成）。

我正在使用 .NETs System.Diagnostics.Process 和 ProcessStartInfo 来设置和运行命令，并且我将 stdout 和 stderror 重定向到事件处理程序，每个事件处理程序都附加到 StringBuilder ，随后将其写入磁盘。

这个问题感觉像是时间问题或缓冲问题。为了解决时间问题，我尝试使用 Monitor.Enter/Exit。如果是缓冲问题，我不确定如何强制进程不缓冲 stdout 和 stderror。

环境是 - 运行 CLR 版本 2 的 PowerShell 2 - SQL 2008 32 位 DTEXEC.exe - 主机操作系统：XP Service Pack 3。

这是代码：

```
function Execute-SSIS-Package
{
    param([String]$fileName)

    $cmd = GetDTExecPath

    $proc = New-Object System.Diagnostics.Process
    $proc.StartInfo.FileName = $cmd
    $proc.StartInfo.Arguments = "/FILE ""$fileName"" /CHECKPOINTING OFF /REPORTING ""EWP"""
    $proc.StartInfo.RedirectStandardOutput = $True
    $proc.StartInfo.RedirectStandardError  = $True
    $proc.StartInfo.WorkingDirectory = Get-Location
    $proc.StartInfo.UseShellExecute = $False
    $proc.StartInfo.CreateNoWindow = $False

    Write-Host $proc.StartInfo.FileName $proc.StartInfo.Arguments

    $cmdOut = New-Object System.Text.StringBuilder

    $errorEvent = Register-ObjectEvent -InputObj $proc `
        -Event "ErrorDataReceived" `
        -MessageData $cmdOut `
        -Action `
        {
            param
            (
                [System.Object] $sender,
                [System.Diagnostics.DataReceivedEventArgs] $e
            )

            try
            {
                [System.Threading.Monitor]::Enter($Event.MessageData)
                Write-Host -ForegroundColor "DarkRed" $e.Data
                [void](($Event.MessageData).AppendLine($e.Data))
            }
            catch
            {
                Write-Host -ForegroundColor "Red" "Error capturing processes std error" $Error
            }
            finally
            {
                [System.Threading.Monitor]::Exit($Event.MessageData)
            }
        }

    $outEvent = Register-ObjectEvent -InputObj $proc `
        -Event "OutputDataReceived" `
        -MessageData $cmdOut `
        -Action `
        {
            param
            (
                [System.Object] $sender,
                [System.Diagnostics.DataReceivedEventArgs] $e
            )
            try
            {
                [System.Threading.Monitor]::Enter($Event.MessageData)
                #Write-Host $e.Data
                [void](($Event.MessageData).AppendLine($e.Data))
            }
            catch
            {
                Write-Host -ForegroundColor "Red" "Error capturing processes std output" $Error
            }
            finally
            {
                [System.Threading.Monitor]::Exit($Event.MessageData)
            }
        }

    $isStarted = $proc.Start()

    $proc.BeginOutputReadLine()
    $proc.BeginErrorReadLine()

    while (!$proc.HasExited)
    {
        Start-Sleep -Milliseconds 100
    }

    Start-Sleep -Milliseconds 1000

    $procExitCode = $proc.ExitCode
    $procStartTime = $proc.StartTime
    $procFinishTime = Get-Date

    $proc.Close()

    $proc.CancelOutputRead()
    $proc.CancelErrorRead()

    $result = New-Object PsObject -Property @{
        ExitCode = $procExitCode
        StartTime = $procStartTime
        FinishTime = $procFinishTime
        ElapsedTime = $procFinishTime.Subtract($procStartTime)
        StdErr = ""
        StdOut = $cmdOut.ToString()
    }

    return $result
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-14T23:09:39.517

您的输出被截断的原因是 Powershell 从 WaitForExit() 返回并在处理队列中的所有输出事件之前设置 HasExited 属性。

一种解决方案是循环任意时间和短睡眠以允许处理事件；Powershell 事件处理似乎不是先发制人的，因此单个长时间睡眠不允许事件处理。

一个更好的解决方案是同时注册进程上的退出事件（除了输出和错误事件）。此事件是队列中的最后一个事件，因此如果您在此事件发生时设置了一个标志，那么您可以循环短暂睡眠，直到设置此标志并知道您已处理所有输出事件。

[我在我的博客上](http://www.maxlyth.com/?p=197 "这里")写了一个完整的解决方案，但核心片段是：

```
# Set up a pair of stringbuilders to which we can stream the process output
$global:outputSB = New-Object -TypeName "System.Text.StringBuilder";
$global:errorSB = New-Object -TypeName "System.Text.StringBuilder";
# Flag that shows that final process exit event has not yet been processed
$global:myprocessrunning = $true

$ps = new-object System.Diagnostics.Process
$ps.StartInfo.Filename = $target
$ps.StartInfo.WorkingDirectory = Split-Path $target -Parent
$ps.StartInfo.UseShellExecute = $false
$ps.StartInfo.RedirectStandardOutput = $true
$ps.StartInfo.RedirectStandardError = $true
$ps.StartInfo.CreateNoWindow = $true

# Register Asynchronous event handlers for Standard and Error Output
Register-ObjectEvent -InputObject $ps -EventName OutputDataReceived -action {
    if(-not [string]::IsNullOrEmpty($EventArgs.data)) {
        $global:outputSB.AppendLine(((get-date).toString('yyyyMMddHHmm')) + " " + $EventArgs.data)
    }
} | Out-Null
Register-ObjectEvent -InputObject $ps -EventName ErrorDataReceived -action {
    if(-not [string]::IsNullOrEmpty($EventArgs.data)) {
        $global:errorSB.AppendLine(((get-date).toString('yyyyMMddHHmm')) + " " + $EventArgs.data)
    }
} | Out-Null
Register-ObjectEvent -InputObject $ps -EventName Exited -action {
    $global:myprocessrunning = $false
} | Out-Null

$ps.start() | Out-Null
$ps.BeginOutputReadLine();
$ps.BeginErrorReadLine();

# We set a timeout after which time the process will be forceably terminated
$processTimeout = $timeoutseconds * 1000
while (($global:myprocessrunning -eq $true) -and ($processTimeout -gt 0)) {
    # We must use lots of shorts sleeps rather than a single long one otherwise events are not processed
    $processTimeout -= 50
    Start-Sleep -m 50
}
if ($processTimeout -le 0) {
    Add-Content -Path $logFile -Value (((get-date).toString('yyyyMMddHHmm')) + " PROCESS EXCEEDED EXECUTION ALLOWANCE AND WAS ABENDED!")
    $ps.Kill()
}

# Append the Standard and Error Output to log file, we don't use Add-Content as it appends a carriage return that is not required
[System.IO.File]::AppendAllText($logFile, $global:outputSB)
[System.IO.File]::AppendAllText($logFile, $global:errorSB) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T19:54:45.267

我的 2 美分……它不是 powershell 问题，而是 System.Diagnostics.Process 类和底层 shell 中的问题/错误。我见过包装 StdError 和 StdOut 并不能捕获所有内容的时候，而其他时候，由于底层应用程序写入控制台的方式，“侦听”包装器应用程序将无限期挂起。（在 c/c++ 世界中，有许多不同的方法可以做到这一点，[例如 WriteFile、fprintf、cout 等]）

此外，可能需要捕获超过 2 个输出，但 .net 框架仅向您显示这两个（假设它们是两个主要输出）[请参阅这篇关于命令重定向的文章[，](http://technet.microsoft.com/en-us/library/bb490982.aspx)因为它开始给出提示）。

我的猜测（对于您和我的问题）是它与一些低级缓冲区刷新和/或引用计数有关。（如果想深入，可以从[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681913%28v=vs.85%29.aspx)开始）

解决此问题的一种（非常老套的）方法不是直接执行程序以实际执行将其包装在使用 2>&1 对 cmd.exe 的调用中，但是这种方法有其自身的缺陷和问题。

最理想的解决方案是让可执行文件有一个日志记录参数，然后在进程退出后去解析日志文件……但大多数时候你没有那个选项。

但是等等，我们使用的是 powershell ......你为什么首先使用 System.Diagnositics.Process？你可以直接调用命令：

```
$output = & (GetDTExecPath) /FILE "$fileName" /CHECKPOINTING OFF /REPORTING "EWP" 
```

# android - Android - 如何增加 EditText 值？

> ID：13113628
> 
> 赞同：0
> 
> 时间：2012-10-28T22:26:32.543
> 
> 标签：android, android-activity

我是 android 开发的新手。我的主类中有这段代码：

```
Button prevBtn, pauseBtn, nextBtn;
EditText counterTxt;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_affirmations);         

      SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);

        prevBtn = (Button)findViewById(R.id.prevBtn);
        pauseBtn = (Button)findViewById(R.id.pauseBtn);
        nextBtn = (Button)findViewById(R.id.nextBtn);        
        counterTxt = (EditText)findViewById(R.id.counterTxt);  

        prevBtn.setOnClickListener(new  View.OnClickListener() {        
            int t = Integer.parseInt(counterTxt.getText().toString());      

            public void onClick(View v) {
                counterTxt.setText(String.valueOf(t-1));                
            }       

        });

        nextBtn.setOnClickListener(new  View.OnClickListener() {        
            int t = Integer.parseInt(counterTxt.getText().toString());

            public void onClick(View v) {
                counterTxt.setText(String.valueOf(t+1));                
            }       

        });     

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_affirmations, menu);
    return true;
} 
```

当我单击“上一个”时，文本字段值变为 19。

当我单击“下一步”时，文本字段值变为 21。

但它只显示这两个值，没有别的，不管我是否再次点击。每当我单击相应的按钮时，我都想减或加 1。

我认为这是因为事件监听器在 onCreate() 方法中？关于如何在每次点击时更新它的任何想法？

![在此处输入图像描述](../Images/607d2de54f3988a1d56347bb32744dae.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T22:31:54.283

您需要将您的`parseInt`内部移动`onClick`：

```
nextBtn.setOnClickListener(new  View.OnClickListener() {

        public void onClick(View v) {
            int t = Integer.parseInt(counterTxt.getText().toString());
            counterTxt.setText(String.valueOf(t+1));                
        }       

    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:31:39.293

在这两种情况下，`t`都被定义为监听器的成员变量，并且从不改变。而是将其移到`onClick`方法中，如下所示（在这两种情况下）：

```
public void onClick(View v) {
    int t = Integer.parseInt(counterTxt.getText().toString());
    counterTxt.setText(String.valueOf(t-1));                
} 
```

# java - Android将单词插入ArrayList，内存不足

> ID：13113633
> 
> 赞同：5
> 
> 时间：2012-10-28T22:27:40.263
> 
> 标签：java, android, out-of-memory

我有两个文件，一个包含单词长度为 3 到 6 的字典和一个包含单词 7 的字典。单词存储在用换行符分隔的文本文件中。此方法加载文件并将其插入到我存储在应用程序类中的数组列表中。

文件大小为 386 KB 和 380 KB，每个包含少于 200k 字。

```
private void loadDataIntoDictionary(String filename) throws Exception {
    Log.d(TAG, "loading file: " + filename);
    AssetFileDescriptor descriptor = getAssets().openFd(filename);
    FileReader fileReader = new FileReader(descriptor.getFileDescriptor());
    BufferedReader bufferedReader = new BufferedReader(fileReader);
    String word = null;

    int i = 0;

    MyApp appState = ((MyApp)getApplicationContext());

    while ((word = bufferedReader.readLine()) != null) {
        appState.addToDictionary(word);
        word = null;
        i++;
    }
    Log.d(TAG, "added " + i + " words to the dictionary");

    bufferedReader.close();
} 
```

该程序在运行 2.3.3 且具有 64MB sd 卡的模拟器上崩溃。使用 logcat 报告的错误。堆增长超过 24 MB。然后我看到将目标 GC 堆从`25.XXX`24.000 MB 固定。

> GC_FOR_MALLOC 释放 0K，释放 12%，外部 1657k/2137K，暂停 208ms。
> GC_CONCURRENT 释放 XXK，释放 14%
> 内存不足 24 字节分配，然后是 FATAL EXCEPTION，内存耗尽。

How can I load these files without getting such a large heap?

Inside MyApp:

```
private ArrayList<String> dictionary = new ArrayList<String>();
public void addToDictionary(String word) {
    dictionary.add(word);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:05:07.867

Irrespective of any other problems/bugs, `ArrayList` can be very wasteful for this kind of storage, because as a growing ArrayList runs out of space, it doubles the size of its underlying storage array. So it's possible that nearly half of your storage is wasted. If you can pre-size a storage array or ArrayList to the correct size, then you may get significant saving.

Also (with paranoid data-cleansing hat on) make sure that there's no extra whitespace in your input files - you can use `String.trim()` on each word if necessary, or clean up the input files first. But I don't think this can be a significant problem given the file sizes you mention.

I'd expect your inputs to take less than 2MB to store the text itself (remember that Java uses UTF-16 internally, so would typically take 2 bytes per character) but there's maybe 1.5MB overhead for the String object references, plus 1.5MB overhead for the String lengths, and possibly the same again and again for the offset and hashcode (take a look at [String.java](http://www.docjar.com/html/api/java/lang/String.java.html))... whilst 24MB of heap still sounds a little excessive, it's not far off if you are getting the near-doubling effect of an unlucky ArrayList re-size.

In fact, rather than speculate, how about a test? The following code, run with `-Xmx24M` gets to about 560,000 6-character Strings before stalling (on a Java SE 7 JVM, 64-bit). It eventually crawls up to around 580,000 (with much GC thrashing, I imagine).

```
 ArrayList<String> list = new ArrayList<String>();
    int x = 0;
    while (true)
    {
        list.add(new String("123456"));
        if (++x % 1000 == 0) System.out.println(x);
    } 
```

So I don't think there's a bug in your code - storing large numbers of small Strings is just not very efficient in Java - for the test above it takes over 7 bytes per character because of all the overheads (which may differ between 32-bit and 64-bit machines, incidentally, and depend on JVM settings too)!

You might get slightly better results by storing an array of byte arrays, rather than ArrayList of Strings. There are also more efficient data structures for storing strings, such as [Tries](http://en.wikipedia.org/wiki/Trie).

# spring - 如何修改在视图中显示表单的记录

> ID：13113635
> 
> 赞同：0
> 
> 时间：2012-10-28T22:27:50.530
> 
> 标签：spring, spring-mvc

我正在尝试完成以下任务：

我有一个水果列表，它们存储在一个包含两列“id”、“name”和“color”的表中。在每个水果旁边，我都有一个“修改”按钮。我在这里要做的是能够以表格形式显示水果并能够修改“名称”和“颜色”属性。

我不明白为什么，但是当我点击“修改”按钮时，表单正在显示，但我点击的水果的属性却没有。

这是代码：

控制器：

```
@RequestMapping(value = "/fruit/modify", method = RequestMethod.POST)
    public String modifyFruit( @RequestParam("id") int id, ModelMap model) {
        Fruit fruit = fruitManager.getFruitById(id);
        model.addAttribute("fruit", fruit);
        return "redirect:/modifyfruit";
    }

    @RequestMapping(value = "/modifyfruit", method = RequestMethod.GET)
    public String showAddForm(@ModelAttribute("fruit") Fruit fruit, ModelMap model) {
        model.addAttribute("fruit", fruit);
        return "/secure/modifyfruit";
    } 
```

这是我在列表中每个水果旁边显示的修改按钮：

```
<td>
    <c:url var="modifyUrl" value="/fruit/modify.html"/>    
    <form id="${fruitForm}" action="${modifyUrl}" method="POST">
        <input id="id" name="id" type="hidden" value="${fruit.id}"/>
        <input type="submit" value="modify"/>
    </form>
</td> 
```

这是我用来显示要填充的表单的 modifyfruit.jsp：

```
<body>
    <form:form method="post" commandName="fruit">
        <table width="95%" bgcolor="f8f8ff" border="0" cellspacing="0"
            cellpadding="5">
            <tr>
                <td align="right">Name:</td>
                <td><form:input path="title" value="${fruit.name}"/></td>   
            </tr>
<tr>
                <td align="right">Color:</td>
                <td><form:input path="color" value="${fruit.color}"/></td>
            </tr>
        </table>
        <br>
        <input type="submit" align="center" value="Post Ad">
    </form:form>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T03:35:01.517

您的重定向只是转到该新 URL 而不添加任何请求参数。因此，您的水果 ID 将被丢弃，这就是为什么没有显示任何内容的原因。

重定向似乎毫无意义——为什么不返回与 GET 版本相同的视图名称字符串呢？

要使用参数重定向，请尝试：

```
return "redirect:/modifyfruit?id=" + id; 
```

编辑：刚刚注意到您已将 Fruit 添加到模型中 - 这不会在重定向中转移并且无论如何都不会工作。

# view - 如何在 Rails 3 中“取消范围”编辑路径和/或操作？

> ID：13113637
> 
> 赞同：2
> 
> 时间：2012-10-28T22:28:06.950
> 
> 标签：view, controller, ruby-on-rails-3.2, default-scope, url-helper

目前我正在使用设计开发一个简单的 Rails 3 Web 应用程序。当用户注册时，`Account`会创建一个。这是 Account 模型的本质：

```
class Account < ActiveRecord::Base
  include Authority::UserAbilities

  # Callbacks
  after_create do |account|
      account.create_person
      account.add_role :owner, account.person
  end

  has_one :person, dependent: :destroy
end 
```

以及 Person 模型的精髓：

```
class Person < ActiveRecord::Base
  belongs_to :account
  default_scope where(published: true)
end 
```

如您所见，一个人（基本上是一个用户配置文件）是在创建帐户后创建的，默认`published`值为`false`. 注册后，用户登录并重定向到主页，其中包含`edit_person_path(current_account.person)`.

在设置了`default_scope`for Person a`Routing Error: No route matches {:action=>"edit", :controller=>"people", :id=>nil}`后，由于`edit_person_path(current_account.person)`.

我对此的解决方案是更改`edit_person_path(current_account.person)`为`edit_person_path(Person.unscoped { current_account.person} )`.

我现在遇到的问题是，尽管页面渲染得很好，但是当我单击编辑链接时，会引发以下异常：

```
ActiveRecord::RecordNotFound in PeopleController#edit
Couldn't find Person with id=126 [WHERE "people"."published" = 't'] 
```

**暂时取消编辑操作范围的最佳方法是什么，我应该这样做`PeopleController#edit`吗？**

# java - 将字节插入字节数组

> ID：13113638
> 
> 赞同：4
> 
> 时间：2012-10-28T22:28:09.487
> 
> 标签：java, bytearray, byte

我真的不敢相信我在问这个，但我读到的所有内容都是从 int 转换为 byte 到 string 到 byte 或其他东西。我实际上是在尝试将一个字节插入字节数组。或者就此而言，用字节而不是整数初始化一个字节数组。

```
byte[] header = {0x8b, 0x1f, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03}; 
```

编译器抱怨它们是整数。我正在尝试插入字节。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T22:32:23.877

`byte`是范围内的有符号整数`[-128,127]`。`0x8b`是`139d`，因此您需要将其转换为一个字节`(byte)0x8b`或使用适当范围内的值，例如`-0x75`（相当于转换`0x8b`为`byte`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T22:33:16.153

编译器威胁文字，`0x8b`如整数，因此您必须显式转换为字节

```
byte[] header = { (byte) 0x0b, (byte) 0x1f }; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-28T22:34:07.027

字节是有符号整数，因此不能超过 127。`0x8b`因此太大了。

[参考](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T23:36:44.780

```
public static byte[] bytes(byte... bytes){ return bytes; }

byte[] header=bytes(0x8b, 0x1f, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03); 
```

# c++ - 将向量放入数组元素中

> ID：13113642
> 
> 赞同：0
> 
> 时间：2012-10-28T22:28:35.627
> 
> 标签：c++, arrays, vector

是否可以在数组元素 a[0],a[1]... 中放置一个向量（每个 a[x] 中的向量不同）？如果可能的话，我如何访问给定 a[n] 中向量的一个元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:37:37.850

您拥有的一些可能性：

```
// Static array of vectors (not a good practice though) 
std::vector<int> vec_array1[size];

// Or dynamic array of vectors (still not very c++ish and error prone)
std::vector<int> *vec_array2;
vec_array = new std::vector<int>[size];

// Or vector of vectors
std::vector<std::vector<int> > vec_array3(size);

// Or std::array of vectors (in c++11)
std::array<std::vector<int>, size> *vec_array4; 
```

在任何情况下，您都可以使用运算符访问向量`[]`：

```
vec_array[0].push_back(5); 
```

以及使用两个运算符的元素，`[]`例如：

```
vec_array[0][2] = 4; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:31:01.463

是的你可以。这是一个如何做到这一点的例子。

```
std::array<std::vector<int>, n> array_of_vector;
//add to vector in array
array_of_vector[0].push_back(4);
//access element in vector in array
array_of_vector[0][0]=5; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T22:31:29.293

你可以做类似的事情

```
 std::vector< std::vector < type > > a; 
```

所以，`a[i]`是`std::vector`你需要的。

# multithreading - 在多个线程上使用 TSQLConnection/SQLite

> ID：13113644
> 
> 赞同：1
> 
> 时间：2012-10-28T22:28:38.217
> 
> 标签：multithreading, sqlite, delphi, firemonkey, delphi-xe3

我正在使用 FireMonkey 2 (XE3) 测试一个在 OSX 上很好地在 Windows 7 和 8 上运行的应用程序。

出于某种原因，我在 OSX 上遇到了崩溃，而调试器并没有真正提供关于问题所在的线索。

到目前为止，我一直在使用单个 TSQLConnection，并在整个应用程序和多个线程中使用它。由于 OSX 上的问题一直在发生，我一直在寻找可能是 TSQLConnection 的原因，它在多个线程中使用。

所以我在这里希望找到关于如何在多个线程上使用 TSQLConnection/SQLite 的明确答案，如果我需要做任何事情以确保与线程没有冲突，或者我只是按原样使用它而没有担心可能的冲突？

# iphone - U_ILLEGAL_ARGUMENT_ERROR 使我的应用程序崩溃

> ID：13113651
> 
> 赞同：0
> 
> 时间：2012-10-28T22:30:13.340
> 
> 标签：iphone, ios, nsdictionary, didselectrowatindexpath

这是我从 UITableView 中选择一个值时收到的错误

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Can't do regex matching, reason: Can't open pattern U_ILLEGAL_ARGUMENT_ERROR (string Motron, pattern 
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

这是我第一次遇到这样的错误。我在下面显示的第二行代码的tableview 方法**didSelectRowAtIndexPath中收到它**

```
// This predicate restricts the filterDataArray to the related values of the selected index
            NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%K like %@",@"MASTER",cell.textLabel.text];
            filterDataArray = [dataArrayOfDictionaries filteredArrayUsingPredicate:predicate]; 
```

我已经注销了字典数组，这就是其中一个字典值的样子。

```
{
        HASM = 1;
        ISM = 0;
        ISV = 0;
        MASTER = Merc;
        MANURE = 96;
    } 
```

数组中大约有 60 或 17 个这样的字典。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:07:03.700

我认为在这种情况下你没有正确使用谓词，试试这个

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"MASTER CONTAINS [c]%@", cell.textLabel.text];
filterDataArray = [dataArrayOfDictionaries filteredArrayUsingPredicate:predicate]; 
```

# asp.net-mvc - 返回逻辑错误的最标准/正确的方法是什么？

> ID：13113652
> 
> 赞同：1
> 
> 时间：2012-10-28T22:30:16.550
> 
> 标签：asp.net-mvc, asp.net-mvc-3, error-handling

ASP.Net MVC 3，剑道 UI Web。

典型的例子——有一个数据库和一些表，用户正在编辑数据——添加新条目、删除、更新。

除了技术问题（网络连接中断）之外，可能还有几个逻辑问题——例如用户没有写任何东西的权限，或者数据被锁定，或者用户试图更新同时被删除的东西，等等上。

所以我想在这种情况下返回一个错误，所以我可以用剑道处理它并显示，比如说一些警报对话框（JS `alert`）。

现在 - 这样做的最精心设计、最正确的方式是什么？我不是在寻找“哦，好吧，它只是有效”的方法。

在这种情况下抛出`HttpException`一个好主意（我有我的问题，因为它是**http**异常，我尝试传递的错误与http无关）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:41:12.777

我将假设您正在使用 Kendo DataSource 对象，该对象存在于大多数自绑定模式下的小部件上（已定义传输部分并触发它自己的 CRUD 请求）。

网格的 CRUD 所绑定的操作应在其作为输入接收的模型上返回 IEnumerable.ToDataSourceResult。如果在您的处理过程中检测到错误，请通过您可以在操作中访问的 ModelState.AddModelError 方法将它们添加到 ModelState。ToDataSourceResult 将自动检测 ModelState 对象中是否存在任何错误并将它们序列化到 JSON 响应（错误字段）中。然后，您甚至可以在客户端通过订阅 DataSource.error 对它们进行操作（请参阅[http:](http://docs.kendoui.com/api/framework/datasource#error) //docs.kendoui.c​​om/api/framework/datasource#error ）。

# objective-c - 在具有滚动条的 UIAlertView 中对齐文本

> ID：13113653
> 
> 赞同：1
> 
> 时间：2012-10-28T22:30:29.340
> 
> 标签：objective-c, uialertview, text-alignment

如果 UIAlertView 包含一定数量的文本，则文本显示会自动更改为具有滚动条。我希望此文本居中对齐。

搜索解决方案提供了[这个 SO 响应](https://stackoverflow.com/questions/1392354/how-to-align-messages-in-uialertview)。但是，这不适用于包含滚动条的 UIAlertView。

如何对齐此类警报中的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T03:36:33.437

我的建议是不要这样做。如果 Apple 更改 UIAlertView 的结构方式，它可能会因任何 iOS 更新而中断。话虽如此，您可以这样做：

```
for(id subview in alertView.subviews) {
    if([subview isKindOfClass:[UITextView class]]) {
        [(UITextView *)subview setTextAlignment:NSTextAlignmentCenter];
    }
} 
```

# search - 如何对存储在 HBase 中的日志数据进行临时搜索

> ID：13113655
> 
> 赞同：0
> 
> 时间：2012-10-28T22:30:41.337
> 
> 标签：search, hbase

我将日志文件数据存储在 HBase 中。在 HBase 的日志中快速搜索关键字的最快方法是什么。我读过一些关于创建倒排索引的内容，但我不清楚索引的外观，甚至不清楚如何创建索引？我还查看了 hbasene- [https://github.com/akkumar/hbasene](https://github.com/akkumar/hbasene)

关于如何进行搜索的任何指示都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T10:54:19.630

您应该查看将 lucene（这是一个倒排索引 + 更有趣的功能，如词干提取等）与 HBase 集成的解决方案。hbasene 是一种选择，但更完整的解决方案是[SolBase](https://github.com/Photobucket/Solbase)和[Lily](http://www.lilyproject.org/lily/index.html)

# optimization - XNA“Texture2D”合并

> ID：13113668
> 
> 赞同：0
> 
> 时间：2012-10-28T22:32:07.293
> 
> 标签：optimization, xna, texture2d

如何将多个 Texture2D 连接到一个大的 Texture2D 中？我正在尝试通过将地图分成块来优化等距瓷砖游戏。

我试过用谷歌搜索它，发现有关“RenderTarget2D”的文章，但不确定如何实现。

谢谢，山姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T00:13:18.140

没关系 - 我解决了。

对于任何也在寻找这个的人，您基本上可以使用 spriteBatch 在“RenderTarget2D”上绘制，就像在屏幕上一样。

[（有用的文章）](http://msdn.microsoft.com/en-us/library/bb976073.aspx)

```
RenderTarget2D render;    //declare target

render = new RenderTarget2D(GraphicsDevice, (int)(tileSize.X * numberOfTiles.X), (int)(tileSize.Y * numberOfTiles.Y), 0, SurfaceFormat.Color); //assign target, where tileSize is the size of a tile and numberOfTiles is the number of tiles you are rendering

GraphicsDevice.SetRenderTarget(0, render); //Target the render instead of the backbuffer

batch.Begin();
//draw each tile
batch.End();

GraphicsDevice.SetRenderTarget(0, null); //target the backbuffer again

Texture2D myTexture = render.GetTexture(); //store texture in Texture2D variable 
```

很抱歉解释得很差——我第一次尝试教程。

# javascript - iframe 注入攻击 - Javascript Mass

> ID：13113670
> 
> 赞同：-2
> 
> 时间：2012-10-28T22:32:12.467
> 
> 标签：javascript, regex, iframe, code-injection

我想知道我是否可以帮助为这行代码创建正则表达式：

```
document.write('<iframe src="http://msn.com" scrolling="auto" frameborder="no" align="center" height="7" width="7"></iframe>'); 
```

发生的情况是病毒通过在末尾添加您提到的代码行来输入和编辑所有 javascript 文件 (.js)。我将使用本出版物的脚本 ( [http://crear-paginas-web.blogspot.com/2010/04/archivos-php-hackeados-con.html](http://crear-paginas-web.blogspot.com/2010/04/archivos-php-hackeados-con.html) )，但我需要新的正则表达式来实现。我一直在尝试自己做，但据我所知已经得到了回报：

```
/document[.]write\(\'\<iframe src\=\"http\:\/\/(msn.com)\" scrolling\=\"auto\" frameborder\=\"no\" align\=\"center\" height\=\"7\" width\=\"\7\"\>\<\/iframe\>+\'\);/ 
```

我希望你能帮助我，问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:53:20.467

此正则表达式将匹配您的特定字符串：

```
/document\.write\('<iframe src="http:\/\/msn\.com" scrolling="auto" frameborder="no" align="center" height="7" width="7"><\/iframe>'\);/ 
```

[http://regexr.com?32k7v](http://regexr.com?32k7v)

请注意，如果标记中存在最小变化，则它将不匹配。您很可能已将地址替换为违规脚本地址的正确转义版本。

如果您想要一个更通用的正则表达式，以匹配所有使用给定 URL`document.write`写入`iframe`的内容，您可以使用：

```
/document\.write\('<iframe.*?src="http:\/\/msn\.com".*?><\/iframe>'\);/ 
```

[http://regexr.com?32k85](http://regexr.com?32k85)

请注意，如果您的网站有很多页面，则很难确定没有攻击残留。因此，如果您有任何文件，我仍然建议您恢复文件的备份。

# asp.net-mvc - 使用 asp.net mvc 将 Http 重定向到 Https 和 SEO

> ID：13113674
> 
> 赞同：0
> 
> 时间：2012-10-28T22:32:43.297
> 
> 标签：asp.net-mvc, ssl, https, seo, http-status-code-301

我想知道我是否应该让 GET 页面远离 SSL，而在 SSL 上保持相同 URL 的 POST？我正在阅读有关使用 SEO 对需要 SSL 的所需页面进行重定向的问题。ASP.NET MVC 有一个属性，但是会执行 302 重定向而不是 301。是否有使用 SEO 执行此操作的最佳实践。我有诸如登录、注册、帐户页面之类的页面。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-30T09:52:54.423

通常，就 SEO 而言，这些原则不适用于表单，因为蜘蛛不会尝试完成表单，因此来自这些页面的重定向不会影响它们。他们遵循的只是静态链接等。

在受密码保护的网站上使用 SEO 需要担心的主要问题是确保付费/私人内容不会最终出现在搜索引擎等中。

/* 编辑 */

就重定向而言，我不会使用控制器上的标志来执行此操作。如果必须通过 https 协议查看站点，那么我将在 IIS 中的目录上设置 Require SSL 属性，并专门处理 403.4 错误以发出永久重定向到该人试图访问的位置。

这将确保访问的任何静态页面也通过 https 协议进行拉取。

硅

# objective-c - Objective-C 在返回时是否将 NSMutableArrays 隐式类型转换为 NSArrays？

> ID：13113677
> 
> 赞同：1
> 
> 时间：2012-10-28T22:33:13.790
> 
> 标签：objective-c, casting, nsmutablearray

如果我有这样的方法：

```
-(NSArray *)methodThatReturnsAnArray; 
```

这是它的实现：

```
-(NSArray *)methodThatReturnsAnArray {

    NSMutableArray *aMutableArray = [[NSMutableArray alloc] init];
    [aMutableArray addObject:@"some string"];
    return aMutableArray;
} 
```

将Objective-C隐式`aMutableArray`转换`NSArray`为返回时，还是我必须像这样指定：

```
 return (NSArray *)aMutableArray; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:35:50.880

`NSMutableArray`是 的子类`NSArray`，所以是的，您不必进行类型转换。这是教科书的[亚型多态性](http://en.wikipedia.org/wiki/Subtype_polymorphism)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:35:25.440

与一般面向对象语言中的[继承](http://en.wikipedia.org/wiki/Inheritance_%28computer_science%29)`NSMutableArray`一样，由于从`NSArray`类扩展，它在所有效果上都是[**A。**](http://en.wikipedia.org/wiki/Is-a) `NSArray`

您不需要将其强制转换为 a ，`NSArray`因为它已经是 a `NSArray`，或者在实践中，它能够响应 an`NSArray`可以响应的所有消息，因此[可以使用它来替代它](http://en.wikipedia.org/wiki/Subtype_polymorphism)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:34:47.803

您可以简单地返回该`NSMutableArray`对象，因为它是`NSArray`.

请注意，它仍然是一个可变数组。通常这不是问题，但如果你想确保它是不可变的，你必须创建一个新实例或副本。

```
return [NSArray arrayWithArray:aMutableArray]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T22:36:01.543

强制转换不会改变对象的类型。它只是告诉编译器它应该假设它是某种类型的对象。但是 a`(NSArray *)aMutableArray`仍然是 a `NSMutableArray`。

# django - 具有接受参数的灵活性的 Django 抽象模型

> ID：13113680
> 
> 赞同：0
> 
> 时间：2012-10-28T22:33:21.270
> 
> 标签：django, model, uuid

我几乎在每个模型中都有 uuid 字段。为了避免冗余，我有这个 BaseUuid 抽象模型来生成随机 uuid 字段：

```
class BaseUuid(models.Model):  # base abstract model with uuid field
    class Meta:
        abstract = True

    uuid = models.CharField(max_length=22, unique=True)

    def save(self, *args, **kwargs):
        if not self.uuid:
            uuid = shortuuid.uuid()[:10]
            while self.__class__.objects.filter(uuid=uuid).exists():
                uuid = shortuuid.uuid()[:10]
            self.uuid = uuid
        super(BaseUuid, self).save(*args, **kwargs) 
```

可能会注意到，上面的代码有一个固定的 uuid 长度 (10)。

现在我想灵活地设置那个长度。我想要类似的东西：

```
class BaseUuid(models.Model):  # base abstract model with uuid field
    class Meta:
        abstract = True

    uuid = models.CharField(max_length=22, unique=True)

    def __init__(self, uuid_length=10, *args, **kwargs):
        super(BaseUuid, self).__init__(*args, **kwargs)
        self.uuid_length = 22 if uuid_length > 22 else 5 if uuid_length < 5 else uuid_length

    def save(self, *args, **kwargs):
        if not self.uuid:
            uuid = shortuuid.uuid()[:self.uuid_length]
            while self.__class__.objects.filter(uuid=uuid).exists():
                uuid = shortuuid.uuid()[:self.uuid_length]
            self.uuid = uuid
        super(BaseUuid, self).save(*args, **kwargs) 
```

这个想法是启用 uuid_length 参数：

```
class SomeModel(BaseUuid(uuid_length=6), SomeOtherMixin):
    ... 
```

但这似乎不起作用。由于 BaseUuid 是 models.Model 的子类，“self.uuid_length”在未定义时被视为模型字段。

我想知道我应该使用哪些其他解决方法/技术？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:50:16.120

在`uuid_length`子类中创建一个类变量，因此：

```
class SomeModel(BaseUuid, SomeOtherMixin):

    uuid_length = 20 // or whatever...

    ... 
```

基类方法中的引用将`self.uuid_length`按照您的意图引用子类。`save``uuid_length`

# iphone - plist 的奇怪错误

> ID：13113681
> 
> 赞同：0
> 
> 时间：2012-10-28T22:33:32.270
> 
> 标签：iphone, ios, xcode, plist, title

当我试图阅读我的 plist 时，我遇到了一个非常奇怪的错误。我的 plist 看起来像：

```
Root (Array)
            Item 0 (Dictionary)
                              title (String) 
```

我想`title`在日志中显示，所以我做了下面的代码：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *basePath = ([paths count] > 0) ? [paths objectAtIndex:0] : nil;
NSString *path = [basePath stringByAppendingPathComponent:@"data.plist"];
NSMutableDictionary *dict = [[NSDictionary dictionaryWithContentsOfFile:path] mutableCopy];

NSLog(@"%@", [dict objectForKey:@"title"]);

NSLog(@"Path to plist: %@", path); 
```

使用此代码，`NSLog(@"%@", [dict objectForKey:@"title"]);`等于“ `(null)`”...

我的 plist 在我的应用程序的文档文件夹中，并且`path`将良好路径返回到我的 plist 的日志。

请帮帮我 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:37:09.313

你的 plist 的根是一个数组，但你把它读入字典，那是行不通的。

你应该：

*   将 plist 读入数组
*   获取项目 0 (objectAtIndex:0) -> 这是一个字典
*   在这本词典上，您可以执行 objectForKey ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:40:41.980

正如@Tom 所说，（正如您在第一个代码块中所说的那样）plist 的根是一个数组。

您可以使用非常相似的方式加载数组：

```
NSArray *array = [NSArray arrayWithContentsOfFile:path]; 
```

然后您可以像这样访问索引 0（字典）处的项目：

```
NSDictionary *dict = [array objectAtIndex:0]; 
```

或者从 Xcode 4.4 开始使用新的数组文字：

```
NSDictionary *dict = array[0]; 
```

然后按照您已经尝试过的方式记录标题：

```
NSLog(@"%@", [dict objectForKey:@"title"]); 
```

或者使用新语法：

```
NSLog(@"%@", dict[@"title"]); 
```

# c - 为什么我的产品平均成本为 0？

> ID：13113682
> 
> 赞同：0
> 
> 时间：2012-10-28T22:33:35.030
> 
> 标签：c

```
//Program Written By: Andre Chitsaz-zadeh
//Program Written On: 10/7/12
//Program calculates book cost for multiple book orders. 
//Program written using multiple functions.

#include <stdio.h>
#define SIZE 5

void inputData();
void processingData(float costs[]);
float costs[5];
float sortedCosts[5];

int main()
{
   inputData();
   processingData(costs);
}

void inputData()
{
   int i = 0;
   printf("\nPlease enter five products costs.\n");
   while (i < 5)
   {
      scanf("%d", &costs[i]);
      i = i + 1;
   }
}

void processingData(float costs[])
{
   int i;
   int j;
   float sum = 0.00f;
   float average = 0.00f;
   for (i = 0; i < 4; ++i)
   {
      int j, min, temp;
      min = i;
      for (j = i + 1; j < 5; ++j)
         if (costs[j] < costs[min])
            min = j;
      temp = costs[i];
      costs[i] = costs[min];
      costs[min] = temp;
   }
   for (i = 0; i < 5; i++)
      for (j = 0; j < 5; j++)
         sortedCosts[i] = costs[i];

   for (i = 0; i < 5; ++i)
      sum += costs[i];
   average = sum / 5;
   printf("Product Cost Average = %.2f\n", average);
} 
```

为什么我的产品平均成本为零？据我所见，我的所有变量都被声明为浮点数？我已经尝试了各种组合，但我似乎无法让它发挥作用。我真的很感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:35:33.827

```
scanf("%d", &costs[i]); 
```

`cost[i]`是你程序中的类型`float`not `int`。

使用`%f`转换规范来读取`float`.

还：

```
temp = costs[i]; 
```

您的`temp`值是 type`int`但`costs[i]`属于 type `float`。我不认为这是故意的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:37:16.303

*在scanf*中使用“%f”修饰符来获得浮点数，而不是“%d”。

还有，你

```
#define SIZE 5 
```

但是您在整个代码中使用 5 而不是 SIZE。使用 SIZE 来减少错误的可能性。

没什么*不好*的

```
i = i + 1; 
```

但这更常见的写成

```
i++; 
```

# jquery - jquery 属性文本

> ID：13113684
> 
> 赞同：1
> 
> 时间：2012-10-28T22:33:43.710
> 
> 标签：jquery

给出以下标记

```
<ul class="ulGreen">
                <li><b>On-Board systems - Road Vehicle</b><span style="color:black;"> (See an installation picture<a href="#" data-rel="onBoardVehiclepicdisplay">here</a>)</span> </li>
                <li><b>On-Board systems - Marine Vessel</b><span style="color:black;"> (See an installation picture<a href="#" data-rel="onBoardVesselpicdisplay">here</a>)</span> </li>
                <li><b>On-Board systems - FuelingBarge</b><span style="color:black;"> (See an installation picture<a href="#" data-rel="onBoardFuelBargepicdisplay">here</a>)</span> </li>

            </ul> 
```

和以下脚本

```
<script>
    $(document).ready(function() {

        $('.ulGreen').delegate(' li span a').click(function() {
            var divID = $(this).attr("data-rel").text;
            alert(divID);

        });
    });

</script> 
```

divID 应该包含来自单击标签的 data-rel 属性的文本，但它不包含，或者您不会阅读此内容。HTML 完全如上所示呈现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:39:45.267

首先，用于[`.data()`](http://api.jquery.com/data/)引用`data-`属性。

但真正的问题在于[`delegate()`](http://api.jquery.com/delegate/)以这种方式使用。使用时`find()`，它工作得很好（见[**jsFiddle**](http://jsfiddle.net/LKgJ4/)）：

```
$(document).ready(function() {
    $('.ulGreen').find('li span a').click(function() {
        var divID = $(this).data("rel");
        alert(divID);
    });
});​ 
```

如果您需要实时更新事件（并且正在使用 jQuery 1.7+），请使用[`.on()`](http://api.jquery.com/on/)（请参阅[**jsFiddle**](http://jsfiddle.net/LKgJ4/1/)）：

```
$(document).ready(function() {
    $('.ulGreen').on('click', 'li span a', function() {
        var divID = $(this).data("rel");
        alert(divID);
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:35:52.653

该`text()`方法返回一个没有`text()`方法的字符串，只需省略该方法调用：

```
$('.ulGreen').delegate('li span a').click(function(e) {
    var divID = $(e.target).attr("data-rel");
    alert(divID);
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/SKqdr/1/)。

`e.target`指的是被点击的元素（事件的目标， `e`），而`this`（和 jQuery 对象`$(this)`）指的是`ul`它本身。

# ruby-on-rails - 向带有动态段的 Rails 路由提交表单

> ID：13113685
> 
> 赞同：1
> 
> 时间：2012-10-28T22:33:49.333
> 
> 标签：ruby-on-rails, forms, routing, routes

我有一条看起来像的路线

```
match 'solar_systems/:planet_num/:moon_num' => 'solar_system#moon', :as => :moon 
```

我想要一个带有行星编号和月球编号选择框的表格，并将其提交到这条路线。但是我不能使用`moon_path`，因为如果像这样不包含动态参数，它会出错`moon_path(4, 1)`。我想要的甚至可能吗？如果是这样，我应该为路线的表单标签提供什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:46:23.483

您不必**使用**路由辅助方法，在这里您不能因为在呈现表单时您不知道所需的参数。但是，您确实知道控制器和操作，这实际上是目标 URL 所需的全部内容。所以这应该工作：

```
= form_tag('/solar_systems/moon') do
  = select_tag(:planet_num, ...
  = select_tag(:moon_num, ... 
```

这应该呈现表单标签。要处理请求，您还必须添加另一个路由，以便调用正确的控制器操作：

```
match 'solar_systems#moon' => 'solar_system#moon', :via => :post 
```

或者，如果它在您的应用程序上下文中更有意义，您可以修改现有路由以使参数可选：

```
match 'solar_systems(/:planet_num(/:moon_num')) => 'solar_system#moon', :as => :moon 
```

有关非资源路由的更多详细信息，请参阅[此 Rails 指南。](http://guides.rubyonrails.org/routing.html#non-resourceful-routes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:13:56.180

如果你在控制器上使用这个参数，你需要指定每个参数是什么，顺便说一句，在你的助手中你需要做这样的事情

```
moon_path(planet_moon: 4, moon_num: 1) 
```

干杯!

# javascript - document.getElementById 到 $

> ID：13113686
> 
> 赞同：2
> 
> 时间：2012-10-28T22:33:53.797
> 
> 标签：javascript, jquery

我找到了一个小聊天脚本，并认为我尝试将 javascript 最小化一点，并尝试更改`document.getElementById`为`$``.value``.val()`

```
function chat_initial(){
    var user = document.getElementById('chat_user').value;

    // tried to change above line to this
    // var user = $('chat_user').val();

    $.post('chat.php', {stage:'initial',user:user}, function(data){
        if (data == 'good'){

            chat_load();
            running = true;

            $('#chatbox #initial').css('display', 'none');
            $('#chatbox #primary').css('display', 'inline');
        }
        else
            alert('That username is taken. Please try another.');
    });
} 
```

但是当我做的脚本不再起作用时，它只是不断弹出`alert()`消息，我做错了什么？

jquery 已加载，所以我认为它会工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:35:14.887

这将起作用：

```
$('#chat_user').val(); 
```

（你需要告诉 jQuery 你正在做一个 ID 查询。你可以通过在 ID 字符串前面加上. 来做到这一点`"#"`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:42:19.000

jQuery 中的 CSS3 选择器可以解决问题！ `#`通过它的 ID 属性 `.`选择一个元素 通过它们的类标签选择元素

因此，要使您的代码正常工作，您需要键入选择器以及`$()`类似的内容：

```
$("#chat_user") 
```

并选择 DOM 标签的值（可能是输入标签？）我们输入[.val()](http://api.jquery.com/val/ ".val() 在 jQuery.com 上）")：

```
$("#chat_user").val() 
```

我希望它排序！

# razor - kendo ui网格中的下拉列表未选择任何值

> ID：13113687
> 
> 赞同：0
> 
> 时间：2012-10-28T22:33:56.877
> 
> 标签：razor, kendo-ui

目前我有如下内联编辑网格，我在列 CStatusID 中有下拉列表，但是，在尝试保存到数据库时它没有选择值

**看法：**

```
@(Html.Kendo().Grid(Model)
    .Name("SList")
        .HtmlAttributes(new { @Style = "align:center; font-size:10px;" })
    .Columns(columns => {
        columns.Bound(p => p.CCID);
        columns.Bound(p => p.CRN);
        columns.Bound(p => p.CStatusID).EditorTemplateName("CStatus
");
        columns.Bound(p => p.DateScheduled).Format("{0:MM/dd/yyyy}");

        columns.Command(commands => commands.Edit()).Width(175);
    })
    //.ToolBar(toolBar => toolBar.Save())
    .Editable(editable => editable.Mode(GridEditMode.InLine))
    .Pageable()
    .Sortable()
    .Scrollable()
    .Navigatable()
    .Selectable(selectable => selectable.Mode(GridSelectionMode.Single)
                                        .Type(GridSelectionType.Row))
    .DataSource(dataSource => dataSource        
        .Ajax()
        .PageSize(10)   
        .Model(model => model.Id(p => p.ConsumerID))
        .Read(read => read.Action("Index", "Management"))
        .Update(update => update.Action("Edit", "Management"))

    )
) 
```

**我在共享/编辑器**模板下有 CStatus.cshtml ：

```
@(Html.Kendo().ComboBox()
        .Name("Status")
        //.OptionLabel("Select status")
        .DataValueField("OptID")
        .DataTextField("OptName")
        .BindTo((System.Collections.IEnumerable)ViewData["constStatus"])

) 
```

**控制器：**

```
public ActionResult Index()
        {
            PopulateConstStatus();
            return View();
        }

private void PopulateConstStatus()
        {
            ViewData["constStatus"] = new EDEntities().COptions
                       .Select(e => new ConfOptModel
                       {
                           OptionID = e.OptID,
                           OptionName = e.OptName,
                           CTypeID = e.CTypeID
                       })
                       .Where(e => e.CTypeID == 2)
                       .OrderBy(e => e.OptName);
        } 
```

**模型**

```
public int OptID { get; set; }
public string OptName { get; set; }

[UIHint("CStatus")]
public COptionsModel COptionsModel { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-17T11:37:31.607

尝试在剑道网格中添加以下事件

```
.Events(events =>
{
    events.Save("TestPointGrid_Save");
}) 
```

和以下脚本

```
<script type="text/javascript">
    function TestPointGrid_Save(e) {
        var companyId = $("#NameoftheDropdownlist").data().kendoDropDownList.value();
        e.model.set("NameoftheDropdownlist", companyId);
    }
</script> 
```

您可以参考[此链接](http://www.sitereq.com/post/kendo-mvc-dropdown-lists-inside-inline-kendo-mvc-grids)以获取更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T13:50:54.797

我遵循这个，它就像一个魅力

[http://demos.kendoui.c​​om/web/grid/foreignkeycolumn.html](http://demos.kendoui.com/web/grid/foreignkeycolumn.html)

# php - Php：在错误的抽象级别调用了错误的方法

> ID：13113694
> 
> 赞同：1
> 
> 时间：2012-10-28T22:34:29.073
> 
> 标签：php, oop, polymorphism

这是一个代码：

```
abstract class A
{
    abstract public function add();

    public function callItself()
    {
        echo __CLASS__.':'.__FUNCTION__.' ('.__LINE__.')<br>';
        if (rand(1,100) == 5) { die; }
        $this->callItself();
    }
}

class B extends A
{
    public function add()
    {
        echo __CLASS__.':'.__FUNCTION__.' ('.__LINE__.')<br>';
    }
}

class C extends B
{
    public function add()
    {
        echo __CLASS__.':'.__FUNCTION__.' ('.__LINE__.')<br>';
        parent::add();
        parent::callItself();
    }

    public function callItself()
    {
        echo __CLASS__.':'.__FUNCTION__.' ('.__LINE__.')<br>';
        throw new Expection('You must not call this method');
    }
}

$a = new C();
$a->add();
die; 
```

在类`C`中`callItself()`不能调用，所以它会抛出一个异常。正如我们所知，我不能将其设置为私有 :) 但是在第 10 行，`$this->callItself();`调用该方法`**C**`而不是`A`所以它死了。但我不想要它，如何躲避它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:45:47.797

使用`self::callItself()`代替`$this->callItself();`

代替

```
public function callItself()
{
    echo __CLASS__.':'.__FUNCTION__.' ('.__LINE__.')<br>';
    if (rand(1,100) == 5) { die; }
    $this->callItself();
} 
```

和

```
public function callItself() {
    echo __CLASS__ . ':' . __FUNCTION__ . ' (' . __LINE__ . ')<br>';
    if (rand(0, 2) == 0) { <------- Better Probability 
        die();
    }
    self::callItself(); <---- This would continue to call A:callItself until die
} 
```

输出

```
C:add (23)
B:add (17)
A:callItself (7)
A:callItself (7)
A:callItself (7)
A:callItself (7)
A:callItself (7)
A:callItself (7) 
```

# python - 寻找允许在浏览器中使用 python 的工具

> ID：13113697
> 
> 赞同：0
> 
> 时间：2012-10-28T22:34:47.900
> 
> 标签：python, web-applications, pythonanywhere, online-compilation

我正在用 python 开发一个应用程序，其中涉及大量的绘图和用户交互。我不希望我的客户必须下载任何东西才能使用该应用程序。所以我一直在寻找一个在线工具，它允许用户运行脚本来使用它（他们不应该通过终端或任何需要他们拥有 python 或下载任何东西的东西来运行它）甚至在网络上拥有应用程序这样只有被允许的人才能访问它。我研究过 Skulpt、pythonanywhere 和 Django。它们要么不支持 Tkinter 等 GUI 库，要么我不确定它们是否用于此目的。你们能帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:46:36.543

您将无法在 Python 中创建最终用户将使用的应用程序，而无需用户下载 SOMETHING。就像你说的那样，你可以尝试做的最好的事情就是像 Skulpt。但是，您似乎感兴趣的 GUI 库假定您在系统本地运行，而不是在浏览器中运行。

您最好的选择是像正常一样创建一个 python 应用程序，然后让用户通过下载一个 exe（或您希望支持的其他平台的二进制文件）来运行它，该 exe 已使用[cx_Freeze](http://cx-freeze.sourceforge.net/)、[py2app](http://pypi.python.org/pypi/py2app/)、[py2exe](http://www.py2exe.org/)或[安装程序](http://www.pyinstaller.org/)。这些库将帮助您将自定义代码、任何库（如 Tkinter）和 Python 本身捆绑到一个可执行包中，以便用户无需事先安装任何东西即可运行它。当然，用户可能会犹豫是否只从您的网站运行 .exe。

另一种选择是选择 Python 以外的东西。为了使它成为一个零安装要求的浏览器内解决方案，请考虑寻找 Javascript 或 Flash 库，您可以使用它们来替换您在 Python 中想要的东西，例如 Tkinter。如果你真的想要在浏览器中使用，那么 Python 不是适合这项工作的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T16:52:20.413

为什么不尝试将 python 用于后端，而将[D3.JS](http://d3js.org)之类的东西用于前端图形呢？

# cookies - Google 如何知道我仍处于登录状态？

> ID：13113698
> 
> 赞同：3
> 
> 时间：2012-10-28T22:34:49.480
> 
> 标签：cookies, browser, login

我正在尝试了解有关 Google 和其他网站的更多信息，并想知道我是否做对了。所以这里是：

当我登录我的 Google 帐户（或任何其他网站，如 Twitter 或 Facebook）时，我会开始一个新会话。这意味着服务器知道我已登录并为该会话设置过期时间。所以当我关闭我的浏览器（而不是注销）并且我的会话还没有过期时，我可以打开一个新的浏览器窗口并且仍然会登录。这是正确的吗？

好的，我想知道的是，在这个登录过程中，我的电脑上是否存储了任何文件？喜欢饼干？还是仅在我勾选“保持登录”框时才存储它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:55:30.207

据我所知，为了让您的会话即使在您关闭浏览器时也“保持活跃”，谷歌使用 cookie。

有两种类型的 cookie：

会话 cookie 和持久性 cookie。会话 cookie 在浏览器退出或关闭时过期（对于像 firefox 这样的浏览器，您必须关闭进程，即所有窗口和所有选项卡）。

另一方面，持久性 cookie 会在有限的时间内（由服务器设置）保存到浏览器专用存储中，并且还会被发送回服务器，直到它们没有过期（因此服务器能够恢复用户会话）。

在您的情况下，谷歌很可能会使用持久性 cookie。

阅读[http://en.wikipedia.org/wiki/HTTP_cookie](http://en.wikipedia.org/wiki/HTTP_cookie)

**更新**：

从版本 19 开始的 Google Chrome 在会话 cookie 处理方面取得了突破性的变化。简而言之：为了改善用户体验，不会删除会话 cookie。

看看 chrome 设置，有一个选项：“从我离开的地方继续”。启用此选项后，会话 cookie 永不过期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:36:51.093

即使您根本没有登录，Google 也会始终存储 cookie。大多数网站都这样做。cookie 只是一种告诉您与半秒前访问该网站的人相同的方式。没有 cookie，就根本没有 webapp 状态（显然还有其他方法可以维护状态，但 cookie 是最流行的）。无论如何，当您登录时，服务器会记住与您的 cookie 关联的会话已登录。

# python - Project Euler #18 - 如何使用 Python 暴力破解树状结构中的所有可能路径？

> ID：13113700
> 
> 赞同：6
> 
> 时间：2012-10-28T22:35:06.320
> 
> 标签：python

我正在尝试以大西洋的[方式](http://www.theatlantic.com/technology/archive/2011/06/how-i-failed-failed-and-finally-succeeded-at-learning-how-to-code/239855/)学习 Python，并被困在 Project Euler #18 上。

我[可以](http://code.jasonbhill.com/python/project-euler-problem-18/) 在[网上](https://stackoverflow.com/questions/8002252/euler-project-18-approach)[找到](http://realultimateprogramming.blogspot.com/2009/08/project-euler-problems-18-and-67.html)的所有东西（除此之外还有更多的谷歌搜索）是​​“你可以暴力破解它，但这里有一个更优雅的解决方案”的一些变体......

我明白了，我完全明白。那里确实有很好的解决方案，我期待着有一天，[“无环图”](https://stackoverflow.com/questions/6553702/project-euler-problem-67-find-maximum-cost-path-in-100-row-triangle)这个词在我脑海中会让人联想到比模糊的 1 兆像素分辨率更多的东西。但是在我跑到这里之前，我需要先走路，[看看状态](http://worrydream.com/LearnableProgramming/)，然后玩弄暴力答案。

所以，问题：我如何在[Project Euler #18](http://projecteuler.net/problem=18)中生成（枚举？）三角形的所有有效路径并将它们存储在适当的 python 数据结构中？（列表列表是我最初的倾向？）。我不想要答案 - 我想知道如何暴力破解所有路径并将它们存储到数据结构中。

这就是我所拥有的。我肯定循环错误的数据集。期望的行为是“深度优先（？）”，而不是无效地循环每一行。我读了ch。Norvig 书中的第 3 章，但无法翻译伪代码。尝试阅读 ch 的 AIMA python[库](http://code.google.com/p/aima-python/)。3 但它有太多的飞跃。

```
triangle = [
    [75],
    [95, 64],
    [17, 47, 82],
    [18, 35, 87, 10],
    [20,  4, 82, 47, 65],
    [19,  1, 23, 75,  3, 34],
    [88,  2, 77, 73,  7, 63, 67],
    [99, 65,  4, 28,  6, 16, 70, 92],
    [41, 41, 26, 56, 83, 40, 80, 70, 33],
    [41, 48, 72, 33, 47, 32, 37, 16, 94, 29],
    [53, 71, 44, 65, 25, 43, 91, 52, 97, 51, 14],
    [70, 11, 33, 28, 77, 73, 17, 78, 39, 68, 17, 57],
    [91, 71, 52, 38, 17, 14, 91, 43, 58, 50, 27, 29, 48],
    [63, 66,  4, 68, 89, 53, 67, 30, 73, 16, 69, 87, 40, 31],
    [04, 62, 98, 27, 23,  9, 70, 98, 73, 93, 38, 53, 60,  4, 23],
]

def expand_node(r, c):
    return [[r+1,c+0],[r+1,c+1]]

all_paths = []
my_path = []

for i in xrange(0, len(triangle)):
    for j in xrange(0, len(triangle[i])):
        print 'row ', i, ' and col ', j, ' value is ', triangle[i][j]
        ??my_path = somehow chain these together???
        if my_path not in all_paths
            all_paths.append(my_path) 
```

首选避免使用外部库（如 itertools）的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:58:15.333

在这里使用递归更容易：

```
def all_paths(r, c):
    current = triangle[r][c]
    if r < len(triangle) - 1:
        below_paths = all_paths(r+1, c) + all_paths(r+1, c+1)
        return [[current] + path for path in below_paths]
    else:
        return [[current]] 
```

在这里，想法是`all_paths(r, c)`返回从 row `r`， column开始的所有路径`c`，这通常是通过递归地从它下面的两个节点获取所有路径，并将当前元素添加到所有路径来获得的。

如果我们在最后一行，我们只返回由单个元素组成的路径。

要获取从顶部开始的所有路径，请调用`all_paths(0, 0)`.

然后可以轻松地修改此函数以返回每条路径的总和而不是路径本身，并且通过进一步修改它可以只返回最大的总和而不是所有的总和。解决这个问题的“正确方法”本质上只是一个记忆版本。

# php - Mongo / PHP 包装器错误 - 我如何让包装器工作？

> ID：13113708
> 
> 赞同：3
> 
> 时间：2012-10-28T22:35:53.650
> 
> 标签：php, mongodb, ubuntu

尝试连接到 mongo 服务器时出现此错误：

```
Unable to find the wrapper "mongodb" - did you forget to enable it when you configured PHP? 
```

连接字符串如下所示：

```
$conn = new Mongo("mongodb://XXXX:XXXX@XXX.member0.mongohq.com:10021/XXX",array("replicaSet" => 'rsname')); 
```

我尝试使用以下方法找出 qhat 包装器可用：

```
var_dump(stream_get_wrappers()); 
```

并得到以下信息：

```
array
  0 => string 'https' (length=5)
  1 => string 'ftps' (length=4)
  2 => string 'compress.zlib' (length=13)
  3 => string 'compress.bzip2' (length=14)
  4 => string 'php' (length=3)
  5 => string 'file' (length=4)
  6 => string 'glob' (length=4)
  7 => string 'data' (length=4)
  8 => string 'http' (length=4)
  9 => string 'ftp' (length=3)
  10 => string 'phar' (length=4)
  11 => string 'zip' (length=3)
  12 => string 'ssh2.shell' (length=10)
  13 => string 'ssh2.exec' (length=9)
  14 => string 'ssh2.tunnel' (length=11)
  15 => string 'ssh2.scp' (length=8)
  16 => string 'ssh2.sftp' (length=9) 
```

我检查了 conf.d 文件夹，它们似乎都按照我可以看到的顺序排列，所以我不确定我需要做什么才能允许我使用包装器进行连接，如 php 中的示例所示文档示例。

我正在运行 nginx / PHP 5.3.5-1ubuntu7.11

以前有没有人对此有所了解，或者能够提供一些指导？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T11:10:50.700

您使用的是哪个版本的 Mongo php 库？我使用版本 1.2.12 做了一个这样的简单测试：

```
<?php

$mongo = new Mongo('mongodb://host1.local:27019,host2.local:27020', array("replicaSet"=>'aaa'));

$hosts = $mongo->getHosts();

var_dump( $hosts );
?> 
```

并且绝对没有问题。[自请求PHP-121](https://jira.mongodb.org/browse/PHP-121)起可通过 php 驱动程序提供 ReplicaSet 支持，该请求可追溯到版本 1.0.9

为了更具体地回答您的问题，mongo php 驱动程序不使用连接包装器。它有一个连接解析器。您可以在代码本身中找到更详细的信息： [parser.c](https://github.com/mongodb/mongo-php-driver/blob/master/mcon/parse.c#L35)

PS：你的ubuntu版本有点老了！于 2007 年 10 月发布，并于 2009 年 4 月达到 EOL。

# java - Android ListView ArrayAdapter notifyDataSetChanged() 并不总是有效

> ID：13113713
> 
> 赞同：0
> 
> 时间：2012-10-28T22:36:07.020
> 
> 标签：java, android, listadapter

我有一个连接到远程服务器并从中获取数据的应用程序。

根据这些数据，我对我的 ListView 连接对象进行了一些更改，并且我正在使用 notifyDataSetChanged() 方法来刷新我的 ListView 并反映我的更改。

不幸的是，该方法并不总是刷新列表。

onUpdate() 应该刷新列表。

```
@Override
public void onUpdate() {
    runOnUiThread(updateClientsInRangeRunnable());  
}

private Runnable updateClientsInRangeRunnable()
{
    Runnable run = new Runnable() {

        @Override
        public void run() {
            updateClientsInRangeList(); 
        }
    };
    return run;
}

public void updateClientsInRangeList()
{
    setClientsInRangeList();
    listArrayAdapter.notifyDataSetChanged();
} 
```

每当我想刷新列表时都会调用 onUpdate() 方法，但并不总是这样做...所做的更改是 ListView 表示的对象内部的属性更改，但只有在我重新加载 ListView 时更改才会刷新

有什么原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:38:47.973

从您显示的代码中很难分辨，但是 setClientsInRangeList() 实际上是否有可能无法找到任何新数据？

# objective-c - iOS 在应用程序中注册推送通知

> ID：13113716
> 
> 赞同：8
> 
> 时间：2012-10-28T22:36:35.700
> 
> 标签：objective-c, ios, push-notification

Q1。我必须在我的应用程序开始时这样做吗？或者我可以在我的应用程序的任何时候触发允许/不允许的提示吗？

Q2。有没有办法找出用户是否点击了是/否？（打回来？）

Q3。如果用户已经点击了否（在之前的会话中），我的提示是否真的会触发？还是我需要告诉用户去他们的手机设置并在那里启用它？

原因是我有一个应用程序，其中有一个名为“通知”的部分，他们可以启用/禁用接收某些事情的通知，所以我只想提示他们启用等，当他们在这个部分而不是在应用程序的启动。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-28T23:12:07.237

A1: No, it doesn't have to be at the start of the app. You can invoke registerForRemoteNotificationTypes from anywhere in the code.

```
[[UIApplication sharedApplication] registerForRemoteNotificationTypes:(UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound)]; 
```

You will need to handle following delegates methods(in delegate) which gets called on successful/fail registering for push notification.

```
// Delegation methods
- (void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)devToken {
    const void *devTokenBytes = [devToken bytes];
    self.registered = YES;
    [self sendProviderDeviceToken:devTokenBytes]; // this will send token to your server's database
}

- (void)application:(UIApplication *)app didFailToRegisterForRemoteNotificationsWithError:(NSError *)err {
    NSLog(@"Error in registration. Error: %@", err);
} 
```

A2: Yes you can. There are two possible scenarios. If your application is not running, you will handle push notification in didFinishLaunchingWithOptions. In this case if user has selected "open" in the message alert or clicked on Banners(depends on user's settings), your application will automatically start and you can handle user parameters passed in push notification.

```
 /* Push notification received when app is not running */
 NSDictionary *params = [[launchOptions objectForKey:@"UIApplicationLaunchOptionsRemoteNotificationKey"] objectForKey:@"appsInfo"];

    if (params) {
        // Use params and do your stuffs
    } 
```

If your application is already running, push notification will be delivered to `application:didReceiveRemoteNotification:` delegate method where you can simply present UIAlertView with the message in push notification and handle alertView delegates OK/Cancel button click in standard way.

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo {
    NSDictionary *apsInfo = [userInfo objectForKey:@"apsinfo"]; // This appsInfo set by your server while sending push

    NSString *alert = [apsInfo objectForKey:@"alert"];

    UIApplicationState state = [application applicationState];

    if (state == UIApplicationStateActive) {
        application.applicationIconBadgeNumber = 0;

        AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);

        UIAlertView *alertview = [[UIAlertView alloc] initWithTitle:@"Push Notification"
                                                            message:alert
                                                           delegate:self
                                                  cancelButtonTitle:@"NO"
                                                  otherButtonTitles:@"YES"];
        [alertview show];
        [alertview release];

    } else {
        [self setTabs:contentsInfo];
     }
}

- (void)alertView:(UIAlertView *)alertView willDismissWithButtonIndex:(NSInteger)buttonIndex {
    if (buttonIndex != [alertView cancelButtonIndex]) {
     // User pressed YES, do your stuffs
     }
} 
```

A3: If user has refused to accept push notification from your app then its didFailToRegisterForRemoteNotificationsWithError and you hence you will not get user's devToken which is required to be on your server to send push notification to that user. If user initially accept but later on if he changed settings to disable your push notification then Apple server will not send your push notification to that user. In this case that user's UDID will appear in Feedback service and ideally your server should remove that user's UDID from the database and stop sending push notification to that users going forward. If you keep sending invalid push notification, Apple server might drop your connection silently and you will not able to send any push notifications.

See [Apple Push Notification](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/WhatAreRemoteNotif/WhatAreRemoteNotif.html#//apple_ref/doc/uid/TP40008194-CH102-SW1) docs for details on implementation.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-29T01:38:27.180

*   Q1 应用启动时不需要推送注册，但有些人确实将其放入`application: didFinishLaunchingWithOptions:`以确保设备令牌成功存储在开发人员的服务器上。
*   Q2 这里的“是/否”是什么意思？如果您的意思是“如果收到推送通知”上的“是/否”，那么如果用户单击“是”，`application: didRegisterForRemoteNotificationsWithDeviceToken`则将触发委托，否则不会。
*   Q3 如果用户点击“否”拒绝接收推送通知，那么你可以稍后在设置中提醒他打开它，或者有一个功能，如 UISwitch 的东西，让用户 `[[UIApplication sharedApplication] registerForRemoteNotificationTypes:(UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeBadge |UIRemoteNotificationTypeSound)];` 再次触发。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-08-02T13:29:05.470

**您可以使用以下教程进行 swift（[访问链接](https://www.raywenderlich.com/123862/push-notifications-tutorial)）并使用以下简单代码用于 Apple 推送通知的 Objective-c。**

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
        if ([application respondsToSelector:@selector(isRegisteredForRemoteNotifications)])
        {
         // iOS 8 Notifications
            [application registerUserNotificationSettings:[UIUserNotificationSettings settingsForTypes:(UIUserNotificationTypeSound |UIUserNotificationTypeAlert | UIUserNotificationTypeBadge) categories:nil]];
            [application registerForRemoteNotifications];
        }
        return YES;
    }

    - (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken {
        NSLog(@"Did Register for Remote Notifications with Device Token (%@)", deviceToken);
    }

    - (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error {

        NSLog(@"Did Fail to Register for Remote Notifications");
        NSLog(@"%@, %@", error, error.localizedDescription);
    }

    -(void) application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo fetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler {
        NSLog(@"%@",userInfo);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-09T17:25:01.117

**回答问题：iOS 10 中的 2。**

在 iOS:10 中，实现了一个完成处理程序。因此，您将在完成处理程序块中立即收到通知。

```
if([[[UIDevice currentDevice] systemVersion] floatValue] >= 10.f){
    UNUserNotificationCenter* notificationCenter = [UNUserNotificationCenter currentNotificationCenter];
    [notificationCenter requestAuthorizationWithOptions:UNAuthorizationOptionAlert | UNAuthorizationOptionSound | UNAuthorizationOptionBadge completionHandler:^(BOOL granted, NSError * _Nullable error) {
        NSLog(@"grant Access:%d",granted);
    }]; 
```

# recursion - “单程”一词是如何定义的？

> ID：13113721
> 
> 赞同：2
> 
> 时间：2012-10-28T22:37:24.557
> 
> 标签：recursion, scheme

一次执行过程是否意味着非递归？或者这是否意味着该过程不应该在相同的信息上重复两次？

我问这个是因为我的印象是它是第一个定义，但现在我偶然发现了一个作业问题，如果不使用递归我无法弄清楚，但说“一次性完成”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:38:45.743

单遍是指您仅在集合中迭代一次（仅触摸每个元素一次）。

您可以通过像这样的简单迭代来完成此操作

```
for n from 0 to set length
 interact with set item n 
```

或者你可以递归（c#）

```
public int total(int[] numbers,int index)
    {
     if (index == numbers.Length - 1) return numbers[index];
     return numbers[index] + total(numbers, index + 1);
    }

int[] someInts = {1,2,3,4};
int intTotal = total(someInts,0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T23:32:01.997

“单程”意味着访问元素集合中的每个元素（例如：列表、数组、集合、向量、映射、树、图、字符串等）（“迭代over") 一次且仅一次 - 过程是递归的还是迭代的都没有关系。例如，Scheme 中的以下递归过程一次添加列表中的所有元素：

```
(define (sum lst)
  (if (null? lst)
      0
      (+ (car lst)
         (sum (cdr lst))))) 
```

相同的过程可以用[*尾递归*](http://en.wikipedia.org/wiki/Tail_call)方式编写 - 意思是：当递归调用发生在另一个过程中时，是它的最终动作；它可能会产生一个返回值，然后由调用过程立即返回。无论如何，只对列表中的元素执行一次传递：

```
(define (sum lst)
  (let loop ((lst lst)
             (acc   0))
    (if (null? lst)
        acc
        (loop (cdr lst) (+ (car lst) acc))))) 
```

将上面的两个示例与 Java 中的这段代码进行比较：它是一个迭代方法，但再次对数组执行单遍：

```
int sum(int[] array) {
    int acc = 0;
    for (int x : array)
        acc += x;
    return acc;
} 
```

# java - 字符串索引超出范围异常错误

> ID：13113725
> 
> 赞同：1
> 
> 时间：2012-10-28T22:37:43.203
> 
> 标签：java, string

我不确定为什么会收到此错误。该代码旨在测试回文而不考虑标点符号。

所以这是我的代码：

```
 char junk;
            String temp = "";

            for (int i = 0; i < txt.length(); i++)
            {
                junk  = txt.charAt(i);
                if (Character.isLetterOrDigit(txt.charAt(jumk)))
                {
                    temp += junk;
                }
            }
            txt = temp;
            left = 0;
            right = txt.length() -1;

            while (txt.charAt(left) == txt.charAt(right) && right > left)
            {
                left++;
                right--;
            } 
```

> java.lang.StringIndexOutOfBoundException： PalindromeTester.main(PalindromeTester.java:35) 处的字符串索引超出范围 0

第35行如下：

```
 while (txt.charAt(left) == txt.charAt(right) && right > left) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:39:21.873

```
 if (Character.isLetterOrDigit(txt.charAt(yP))) 
```

是你的问题， yP 是一个字符而不是对位置的引用。

你的意思可能是：

```
 if (Character.isLetterOrDigit(yP)) 
```

编辑：我的评论：权利的值是-1，而charAt需要一个大于0的整数..所以你应该检查txt的长度，如果它是== 0然后显示一条消息说需要一个实际的单词.

您应该在到达此行之前停止执行：

```
right = txt.length() -1; 
```

这是您的固定代码：

```
do
    {
        System.out.println("Enter a word, phrase, or sentence (blank line to stop):");
        txt = kb.nextLine();
    }

while (!txt.equals(""));

    txt = txt.toLowerCase();
    char yP;
    String noP = "";

    for (int i = 0; i < txt.length(); i++)
    {
        yP  = txt.charAt(i);
        if (Character.isLetterOrDigit(txt.charAt(yP)))
        {
            noP += yP;
        }
    }
    txt = noP;

    left = 0;
    right = txt.length() -1;

    while (txt.charAt(left) == txt.charAt(right) && right > left)
    {
        left++;
        right--;
    }

    if (left > right)
    {
        System.out.println("Palindrome");
        cntr++;
    }
    else
    {
        System.out.println("Not a palindrome");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:40:02.620

该变量`yP`是您*在 index 处* `i`的字符，而不是索引（因为您在给您错误的行上使用它）。将该行更改为：

```
if (Character.isLetterOrDigit(yP)) { ... 
```

编辑新问题：

您不需要 while 循环来检查用户是否没有输入任何内容，因为在这种情况下您不想*重复*执行某些操作（这就是循环的用途）。由于您只想做某事*一次*，即打印出他们找到了多少回文，您可以只使用一个`if`语句。结构如下所示：

```
do {
    get user input

    if they entered the empty string "" {

        print out how many palindromes they have found so far

    } else { // they must have entered text, so check for palindrome

        your normal palindrome checking code goes here

    }

} while (your condition); 
```

编辑2：

尝试改变

```
if (left > right) 
```

到

```
if (left >= right) 
```

因为如果left==right，这意味着它们都在奇数长度字符串的中间字符上（例如，皮划艇中的'y'），这意味着字符串是回文。

# php - Yii 嵌套设置为下拉菜单

> ID：13113727
> 
> 赞同：4
> 
> 时间：2012-10-28T22:38:10.263
> 
> 标签：php, drop-down-menu, yii, nested-sets

我正在使用**Yii 嵌套集行为**，这有助于我保持我的类别嵌套，如此处所示（没关系标题行，它们是俄语）：![在此处输入图像描述](../Images/ba755f83a2490df101f0266f8042b31f.png)

我想做的就是拥有 Bootstrap 嵌套菜单，应该是这样的：

```
 $criteria = new CDbCriteria;
    $criteria->order = 'root, lft';
    $categories = Category::model()->findAll($criteria);
    foreach($categories as $i => $category) {
      $items[$i]['label'] = $category->title;
      $items[$i]['url'] = $category->url;
      $items[$i]['active'] = false;
      $items[$i]['items'] = array(
        array('label'=>'123', 'url'=>'#'),
        array('label'=>'123', 'url'=>'#'),
        array('label'=>'123', 'url'=>'#', 'items'=>array(
            array('label'=>'1234', 'url'=>'#'),
            array('label'=>'1234', 'url'=>'#'),
            array('label'=>'1234', 'url'=>'#', 'items'=>array(
                array('label'=>'1234', 'url'=>'#'),
                array('label'=>'1234', 'url'=>'#'),
                array('label'=>'1234', 'url'=>'#'),
            )),
        )),
    ); 
}
$this->widget('bootstrap.widgets.TbMenu', array(
    'type'=>'pills',
    'stacked'=>false, // whether this is a stacked menu
    'items'=>$items
)); 
```

我不明白如何完成这项工作，顺便说一句，我阅读[了这个主题](http://semlabs.co.uk/journal/converting-nested-set-model-data-in-to-multi-dimensional-arrays-in-php)，只是不知道如何将此功能实际应用于我的问题。感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T22:08:08.007

最后，我自己的递归解决方案（使用多个根）：

```
 public function getTreeRecursive() {
    $criteria = new CDbCriteria;
    $criteria->order = 'root, lft';
    $criteria->condition = 'level = 1';
    $categories = Category::model()->findAll($criteria);

    foreach($categories as $n => $category) {
        $category_r = array(
            'label'=>$category->title,
            'url'=>'#',
            'level'=>$category->level,
        );              
        $this->category_tree[$n] = $category_r;

        $children = $category->children()->findAll();
        if($children)
            $this->category_tree[$n]['items'] = $this->getChildren($children);
    }
    return $this->category_tree;
}
private function getChildren($children) {
    $result = array();
    foreach($children as $i => $child) {
        $category_r = array(
            'label'=>$child->title,
            'url'=>'#',
        );          
        $result[$i] = $category_r;
        $new_children = $child->children()->findAll();
        if($new_children) {
            $result[$i]['items'] = $this->getChildren($new_children);
        }           
    }
    return $result_items = $result;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T18:58:05.280

这是我用来格式化为json对象的函数，你可以修改它来生成一个php数组。

```
protected function formatJstree(){
        $categories = $this->descendants()->findAll();
        $level=0;
        $parent = 0;
        $data = array();
        foreach( $categories as $n => $category )
        {
            $node = array(
                'data'=> "{$category->title}",
                'attr'=>array('id'=>"category_id_{$category->category_id}")
            );
            if($category->level == $level){
                $data[$parent]["children"][] = $node;
            }
            else if($level != 0 && $category->level > $level){
                if(!isset($data[$n]["children"])){
                    $data[$n]["children"] = array();
                }
                $data[$parent]["children"][] = $node;
            }
            else
            {
                $data[] = $node;
                $parent = $n;
            }
            $level=$category->level;

        }
        return $data;

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-31T07:50:02.420

使用 PHP & Yii（MVC 框架）创建多级类别系统，这不仅仅是一项简单的工作。1\. 在模型中创建函数

`

```
function getRootCategory($cur_cat='') {
$sql='select id, course_name, parent_id from course where parent_id="0" and status=0'; 
$command=Yii::app()->db->createCommand($sql);
$return =$command->queryAll();
foreach($return as $rootCat){
if ($rootCat['id']==$cur_cat){
$test= 'selected=selected'; 
}else{
$test='';
 }
$id=$rootCat['id'];
echo "".$rootCat['course_name'].'';
$this->sub_cat($rootCat['id'] , '', $cur_cat ); 
}
 }

   function sub_cat($parentID=0, $space='',$cur_cat ) {
$sql="select id, course_name, parent_id from course where parent_id='$parentID' and status=0";
$command=Yii::app()->db->createCommand($sql);
$return =$command->queryAll();
$count=count($return);
if($parentID==0){ $space=''; }else{ $space .=" - "; }

if($count > 0){
foreach($return as $subcat){
if ($subcat['id']==$cur_cat){$test='selected=selected';}else{$test='';}
$ids=$subcat['id'];
echo "".$space.$subcat['course_name'].'';
$this->sub_cat($subcat['id'],$space, $cur_cat ); 
}
 } 
} 
```

` 现在在 view/file.php 中创建此代码

```
<?php
echo ‘&lt;select id=”parent_id” class=”select” name=”Course[parent_id]” >’;
echo “&lt;option value=’0′  >–Select Exam–&lt;/option>”;
echo Course::model()->getRootCategory($model->parent_id);
// ($model->parent_id) means selected text box
echo ‘&lt;/select>’; ?> 
```

更多详情请点击此网址访问 [http://it-expert.in/create-multi-level-category-using-recursive-function-in-yii/](http://it-expert.in/create-multi-level-category-using-recursive-function-in-yii/)

# java - 如何在java中随机倾斜一条线？

> ID：13113730
> 
> 赞同：3
> 
> 时间：2012-10-28T22:38:36.257
> 
> 标签：java, graphics

我知道我想从哪里开始排队，我知道我想排队多久。我希望这条线从面板的坐标 100,100 开始，我希望它的长度为 50 像素。我怎样才能随机倾斜每次运行的线？我在想类似的事情：

```
Random rand = new Random(System.currentTimeMillis());
int angle = rand.nextInt % 360; 
```

但是我现在如何使用它来画线呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-28T22:43:02.473

通过[极坐标](http://en.wikipedia.org/wiki/Polar_coordinate_system)传递，您可以轻松地做您想做的事：

```
// a random value in [0, 2PI] for the angle in radians
float angle = rand.nextFloat()*2*Math.PI; 
// length of the line
float magnitude = 50.0f;

// start point
Point2D.Float start = new Point2D.Float(100,100);
// end point
Point2D.Float end = new Point2D.Float(start.getX() + Math.cos(angle)*magnitude, start.getY() + Math.sin(angle)*magnitude); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T22:43:47.763

一旦你有了随机角度（以弧度为单位），你可以简单地使用 Math.sin(angle)*length 作为线的高度，使用 Math.cos(angle)*length 作为宽度。最后，您可以使用Graphics drawLine(100,100,width,height) 来绘制线条。

# java - Android - org.ksoap2.soapfault 无法强制转换

> ID：13113733
> 
> 赞同：4
> 
> 时间：2012-10-28T22:38:48.947
> 
> 标签：java, android-ksoap2

我正在尝试从 Android 客户端访问 Java Web 服务，但它显示错误：

“java.lang.classcastexception org.ksoap2.soapfault 不能转换为 org.ksoap2.serialization.soapobject”

你能帮助我吗？

这是我的客户端 Web 服务代码：

```
import java.lang.reflect.Method;

import android.app.Activity; 
import android.os.Bundle; 
import android.content.Context;
import android.content.Intent; 
import android.view.Menu; 
import android.view.MenuItem; 
import android.view.View;
import android.view.Window;
import android.widget.EditText;

import android.widget.TextView;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.AndroidHttpTransport;
import org.ksoap2.transport.HttpTransportSE; 

public class Loginuser extends Activity{

public static final int MENU1 = Menu.FIRST; 
public static final int MENU2 = Menu.FIRST + 1; 
public static final int MENU3 = Menu.FIRST + 2; 
public static Context group;

    private static final String SOAP_ACTION = "";
    private static final String METHOD_NAME = "logar";
    private static final String NAMESPACE = "http://wsproj.mycompany.com/";
    private static final String URL = "http://localhost:8084/wsproj/HelloWorld";

    EditText ura,pw; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE); 
    setContentView(R.layout.loginuser);

    }

    public void logar(View X) { 
    CarregaTelaBolarq();
    }

public void CarregaTelaBolarq(){

    ura=(EditText)findViewById(R.id.editText2);
    String raforn = ura.getText().toString();

    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);

    request.addProperty("raforn",ura.getText().toString());

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);

    envelope.setOutputSoapObject(request);

try{

    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

    androidHttpTransport.call(SOAP_ACTION, envelope);

    SoapObject sp = (SoapObject)envelope.bodyIn;

    String result=sp.toString();

    if(result.equals("1"))

            {

               TextView tv; 
               tv=(TextView) findViewById(R.id.editText1);
               tv.setText("foi: ");
            }
            else
            {
                TextView tv; 
                tv=(TextView) findViewById(R.id.editText1);
                tv.setText("Msg from service: ");
            }       

        }
        catch(Exception e)
        {

            TextView tv=(TextView) findViewById(R.id.editText1);
            tv.setText("ERROR: " + e.toString());
        }

}

public boolean onCreateOptionsMenu(Menu options) { 
options.add(0, MENU1, 0, "Página Principal");
options.add(0, MENU2, 0, "Manual");
options.add(0, MENU3, 0, "Sobre");

return super.onCreateOptionsMenu(options);   }

public boolean onOptionsItemSelected(MenuItem item) {   
    switch (item.getItemId()) { 
    case MENU1: 
        Intent mudarHome= new Intent(this, MainActivity.class); 
        startActivity(mudarHome);  
        return true;

    case MENU2: 
        Intent mudarManual = new Intent(this, Manual.class); 
        startActivity(mudarManual); 
        return true;

    case MENU3: 
        Intent mudarSobre = new Intent(this, Sobre.class); 
        startActivity(mudarSobre);  
        return true;

        }   
        return false;   
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T16:38:10.767

这意味着这些参数未找到服务尝试此代码以查找错误消息：

```
SoapFault error = (SoapFault)envelope.bodyIn;
System.out.println("Error message : "+error.toString()); 
```

在我看来，您必须通过包含具有包名称的服务的类来填充 SOAP_ACTION 参数：

```
private static final String SOAP_ACTION = "http://com.mycompany.wsproj/HelloWorld"; 
```

并通过 .wsdl 或 ?wsdl 结束 Web 服务的 URL（尝试它们都 xD ）

```
private static final String URL = "http://localhost:8084/wsproj/HelloWorld?wsdl"; 
```

最后一件重要的事情是（当您使用 android API 时）通过 IP 更改 localhost：

```
private static final String URL = "http://10.0.2.2:8084/wsproj/HelloWorld?wsdl"; 
```

希望对你有帮助！！... 祝你好运 ！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-08T19:55:12.630

当您处理 SOAP Web 服务时，这个问题可能会出现一段时间。来自服务的响应可以是 SOAP 对象，如果出现错误，例如传递了错误的凭据，则响应会带有错误消息，并且它是 SOAPFAULT 对象。因此，请更新您的解析代码以检查响应对象的类型。

这种代码可以解决你的问题，

```
if (envelope.bodyIn instanceof SoapFault) {
    String str= ((SoapFault) envelope.bodyIn).faultstring;
    Log.i("", str);

    // Another way to travers through the SoapFault object
/*  Node detailsString =str= ((SoapFault) envelope.bodyIn).detail; 
    Element detailElem = (Element) details.getElement(0) 
                 .getChild(0); 
    Element e = (Element) detailElem.getChild(2);faultstring; 
    Log.i("", e.getName() + " " + e.getText(0)str); */
} else {
    SoapObject resultsRequestSOAP = (SoapObject) envelope.bodyIn;
    Log.d("WS", String.valueOf(resultsRequestSOAP));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-27T07:20:13.150

> 与 Web 服务交互的最佳方式是从 Web 浏览器插入数据并在 android 调试过程之前使用调试器检查它。大多数情况下，它发生在 Web 服务生成异常时。

# java - 用户输入处理模式

> ID：13113735
> 
> 赞同：0
> 
> 时间：2012-10-28T22:38:55.670
> 
> 标签：java, console-application, design-patterns

我需要用菜单和子菜单做一些基本的 Java 控制台应用程序。该结构应如下所示：

主菜单：

```
(1)     Menu 1
(2)     Menu 2
(0)     Exit  

Menu 1 
(1)  Submenu 1 
(2)  Submenu 2 
(3)  Submenu 3 
(4)  Return to menu 1 
```

因此，当用户输入 1 时，将打印菜单 1 等...

我的问题是，我可以用某种模式来实现这种事情，并创建更动态的方法，还是我坚持使用 if switch 语句？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:54:25.177

除了使用 switch 语句，您可以创建一个对象，其中包含子菜单的字符串数组，以及与其按键值对应的编号的子菜单对象数组。为此，您可以使用这样的方法返回子菜单：

```
menu getSubmenu(int keyval){
    return menulist[keyval];
} 
```

我将把其余的实现留给你。

# c++ - 如何初始化成员变量

> ID：13113737
> 
> 赞同：0
> 
> 时间：2012-10-28T22:38:58.340
> 
> 标签：c++, class

对于那里的人来说可能是一个简单的问题，但是在下面的示例中我做错了什么？我正在尝试构建一个全局类，其中包含其他类的实例化......我认为我出错的地方归结为下面的示例。出现 seg 错误，好像 *b 从未创建。提前致谢！！

```
#include <iostream>

using namespace std;

class A;
class B;

class B
 {
   public:
   B()
   {
       b = 99;
   }
   ~B();

  int Getb() {return b; }
  void Setb (int x) { b = x; }

  private:
  int b;

};

class A
{
    public:
   A()
    {
        B *b = new B;
    }
    ~A();

    B * b;

    void Printout()
    {
        cout<<b->Getb()<<endl;
    }
    private:

};

int main()
{
A *a = new A;
a->Printout();
cin.get();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:42:32.617

```
A() {
    B *b = new B;
}

B * b; 
```

在构造函数中，您*声明了一个新的局部变量*，该变量被分配了新分配的地址`B`，然后被遗忘了！

实例字段`b`永远不会被分配，因为它被构造函数中同名的局部变量所遮蔽。

你可能的意思是

```
A() {
    b = new B;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T22:42:04.673

```
A()
{
    B *b = new B;
} 
```

应该

```
A()
{
    b = new B;
} 
```

在您的版本中，A 构造函数中有一个名为 b 的变量。这个变量隐藏了也称为 b 的 A 类成员（这显然是您想要使用的那个）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T22:43:13.853

在 cosntructor`A::A()`中，您不会初始化`A::b`成员，而是初始化局部变量。尝试做：

```
A() {
     b = new B;
} 
```

或更好：

```
A():b(new B) {} 
```

更好的是，根本不要使用原始指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T23:23:30.427

尽管很多人已经指出了解决您所看到的问题的一种方法，但似乎（对我来说，无论如何）都没有就如何真正使代码变得更好提供建议。

您的定义`B`是所谓的 a [`quasi-class`](http://www.idinews.com/quasiClass.pdf)。长话短说，您`B`可以在不丢失任何内容的情况下进行很多简化：

```
struct B { 
    int b;
    B() : b(99) {}
}; 
```

你所做的一切（get/set，析构函数）都没有完成任何事情。你的`A`班级不仅完成得差不多，而且做得更差。其他人已经指出了`A`' 的构造函数定义一个本地`B`对象，然后泄漏该对象的问题。没有（无论如何我已经看到）指出，即使你修复了这个问题，你的定义仍然`A`会泄漏`B`对象，因为即使它创建一个`B`对象作为创建对象的一部分`A`，它也*不会*破坏`B`对象当`A`包含它的对象被销毁时。

我看不出你的`A`类有任何理由动态分配`B`对象（或者，当你开始使用它时，甚至存在）。我会这样定义`A`：

```
class A { 
     B b;
public:
     void print() { std::cout << b.b << "\n";
}; 
```

但是，如果一个`B`对象知道如何将自己插入流中，并且它也使用正常的语法，那就更好了：

```
std::ostream &operator<<(std::ostream &os, B const &b) { 
    return os << b.b;
} 
```

有了这个，你的`A`类什么都没有添加，所以你的整个程序变成了这样：

```
struct B { 
    int b;
    B() : b(99) {}
};

std::ostream &operator<<(std::ostream &os, B const &b) { 
    return os << b.b;
}

int main() {
    std::cout << B() << "\n";
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-28T22:43:32.043

```
B *b = new B; 
```

创建一个名为`b`遮蔽类成员的局部变量`b`。您需要初始化类成员，并且应该在初始化列表中进行。

```
A() : b(new B) {} 
```

您的下一步是修复由于从不调用`delete`您动态分配的指针而导致的内存泄漏，但由于这是一个学习练习，它可能不是非常重要（还）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-31T02:35:00.437

很棒的提示，尽管回想起来我在命名 int 变量 b 时混淆了我的问题（应该是 b ！）。也就是说，你们向我“指出”了初始化列表、析构函数以及最终组合的主题。非常感谢[如何在 C++ 中实现类组合？](https://stackoverflow.com/questions/1853906/how-to-implement-class-composition-in-c?rq=1)

# spring - 具有更多数据源的spring jpa hibernate

> ID：13113739
> 
> 赞同：3
> 
> 时间：2012-10-28T22:39:24.450
> 
> 标签：spring, hibernate, jpa, persistence-unit

我必须在 Hibernate,Jpa 的应用程序（spring）中使用两个不同的数据库。我想将不同的表直接定义到不同的数据源。所以我使用两个不同的持久性单元，我尝试使用

```
<property name="packagesToScan" value="it.two.app.domain.first" /> 
```

和

```
<property name="packagesToScan" value="it.two.app.domain.second" /> 
```

将不同的表放入不同的包中。但它不起作用。事实上所有的表都是第一个数据源。然后我尝试将类的名称写入持久性 XML 文件

```
 <persistence-unit name="persistenceFirst" transaction-type="RESOURCE_LOCAL">
 <class>it.two.app.domain.first.OneTable</class>
 <exclude-unlisted-classes/>
</persistence-unit> 
```

和 it.two.app.domain.second.OtherTable

但是当我运行日志时说表'firstDB.other-table'不存在，我使用到服务文件中

```
@PersistenceContext(unitName ="persistenceFirst")
private EntityManager em; 
```

和

```
@PersistenceContext(unitName = "persistenceSecond")
EntityManager em; 
```

你有一些想法吗？这是数据源 XML 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:jdbc="http://www.springframework.org/schema/jdbc"
xmlns:jpa="http://www.springframework.org/schema/data/jpa"
xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:p="http://www.springframework.org/schema/p"
xsi:schemaLocation="http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.0.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
    http://www.springframework.org/schema/context     http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<!-- first datasource -->
<context:property-placeholder location="classpath:jdbc-first.properties"/>
<bean id="dataSourceFirst"  class="org.apache.commons.dbcp.BasicDataSource"
    p:driverClassName="${jdbc.driverClassName}" p:url="${jdbc.databaseurl}"
    p:username="${jdbc.username}" p:password="${jdbc.password}"  />
<!-- second datasource -->      
<context:property-placeholder location="classpath:jdbc-second.properties"/>
<bean id="dataSourceSecond"     class="org.apache.commons.dbcp.BasicDataSource"
    p:driverClassName="${jdbc.driverClassName}" p:url="${jdbc.databaseurl}"
    p:username="${jdbc.username}" p:password="${jdbc.password}"  />     

<bean id="transactionManagerFirst"  class="org.springframework.orm.jpa.JpaTransactionManager"
p:entityManagerFactory-ref="emfFirst"/>

<bean id="transactionManagerSecond"     class="org.springframework.orm.jpa.JpaTransactionManager"
p:entityManagerFactory-ref="emfSecond"/>

<tx:annotation-driven transaction-manager="transactionManagerFirst"/>
<tx:annotation-driven transaction-manager="transactionManagerSecond"/>

<jpa:repositories base-package="it.two.app.repository.first"
entity-manager-factory-ref="emfFirst" transaction-manager-ref="transactionManagerFirst" />

<jpa:repositories base-package="it.two.app.repository.second"
entity-manager-factory-ref="emfSecond" transaction-manager-ref="transactionManagerSecond" />

<bean id="emfFirst"
class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
<property name="persistenceUnitName" value="persistenceFirst"/>
<property name="persistenceXmlLocation" value="classpath:/META-INF/persistence-first.xml"/>
<property name="jpaVendorAdapter">
    <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
</property>

<property name="dataSource" ref="dataSourceFirst" />
<property name="packagesToScan" value="it.two.app.domain.first" />
<property name="jpaProperties">
    <props>
        <prop     key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
        <prop key="hibernate.max_fetch_depth">3</prop>
        <prop key="hibernate.jdbc.fetch_size">50</prop>
        <prop key="hibernate.jdbc.batch_size">10</prop>
    </props>
</property>

</bean>

<bean id="emfSecond"     class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
<property name="persistenceUnitName" value="persistenceSecond"/>
<property name="persistenceXmlLocation" value="classpath:/META-INF/persistence-        second.xml"/>
<property name="jpaVendorAdapter" >
 <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
</property>
<property name="dataSource" ref="dataSourceSecond"/>
<property name="packagesToScan" value="it.two.app.domain.second"/>
<property name="jpaProperties">
 <props>
<prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop> 
<prop key="hibernate.max_fetch_depth">3</prop>
<prop key="hibernate.jdbc.fetch_size">50</prop>
<prop key="hibernate.jdbc.batch_size">10</prop>
 </props>
</property>

</bean>

</beans> 
```

解决方案！！！！！！我不明白这个问题。简单地

```
<!-- first datasource -->
 <bean id="dataSourceFirst"  class="org.apache.commons.dbcp.BasicDataSource"
    p:driverClassName="com.mysql.jdbc.Driver" p:url="url...."
    p:username="username" p:password="password"  />
<!-- second datasource -->      
<bean id="dataSourceSecond"     class="org.apache.commons.dbcp.BasicDataSource"
     p:driverClassName="com.mysql.jdbc.Driver" p:url="url2...."
    p:username="username2" p:password="password2"  /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-29T03:32:06.717

如果您想`DataSource`在`Spring + JPA`.

1.  `PersistenceUnit`在 中创建两个或更多`persistence.xml`。
2.  为中`EntityManagerFactory`的每个创建。`PersistenceUnit``spring-beans.xml`

更多参考。

1.  [Spring+Hibernate+JPA的多数据库](https://stackoverflow.com/questions/1902997/multiple-database-with-springhibernatejpa)
2.  [使用 Spring 3、Hibernate 3 访问多个数据库](http://turgayzengin.blogspot.com/2007/09/multiple-persistence-units-with-spring.html)
3.  [使用 Spring 3.0 和 Hibernate 3.0 的多个数据库](http://tiwarij2eeblog.blogspot.com/2010/12/handling-transaction-with-multiple.html)

在您的 DAO 课程中。

```
@PersistenceContext(unitName ="JPA_1")
private EntityManager em_1; 

@PersistenceContext(unitName ="JPA_2")
private EntityManager em_2; 
```

配置持久化.xml

```
<persistence-unit name="JPA_1" type="RESOURCE_LOCAL">
....
</persistence-unit>

<persistence-unit name="JPA_2" type="RESOURCE_LOCAL">
....
</persistence-unit> 
```

配置：spring-beans.xml

```
<bean id="entityManagerFactory1" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="JPA_1"/>
    <property name="jpaVendorAdapter" ref="jpaVendorAdapter"/>
    <property name="jpaDialect">
        <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaDialect"/> <--if it is necessary, replace with hibernate.
    </property>
    <property name="jpaPropertyMap">
        <props>
            <prop key="eclipselink.weaving">false</prop> <--if it is necessary, replace with hibernate.
        </props>
    </property>
    <property name="loadTimeWeaver">
        <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver">
        </bean>
    </property>
</bean>

<bean id="entityManagerFactory2" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="JPA_2"/>
    <property name="jpaVendorAdapter" ref="jpaVendorAdapter"/>
    <property name="jpaDialect">
        <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaDialect"/> <--if it is necessary, replace with hibernate.
    </property>
    <property name="jpaPropertyMap">
        <props>
            <prop key="eclipselink.weaving">false</prop> <--if it is necessary, replace with hibernate.
        </props>
    </property>
    <property name="loadTimeWeaver">
        <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver">
        </bean>
    </property>
</bean> 

<bean id="jpaVendorAdapter" class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter"> <--if it is necessary, replace with hibernate.
    <property name="databasePlatform" value="org.eclipse.persistence.platform.database.MySQLPlatform"/>
    <!--<property name="databasePlatform" value="org.eclipse.persistence.platform.database.OraclePlatform" />-->
    <property name="generateDdl" value="false"/>
    <property name="showSql" value="true"/>
</bean> 
```

# android - Android 对 Cast 和监听器的反射

> ID：13113744
> 
> 赞同：0
> 
> 时间：2012-10-28T22:39:59.607
> 
> 标签：android, reflection

我有一个 minsdk=4 的应用程序

我想在支持这个（api>=11）的设备上使用 calendarview 类，我更喜欢 wrapper 类之上的反射，这样我就不必增加构建 api 级别。这可以防止意外使用新功能并产生错误。

这是我的代码的一部分。

```
 CalendarView cv = (CalendarView) findViewById(R.id.calview);
    cv.setOnDateChangeListener(new CalendarView.OnDateChangeListener() {

        public void onSelectedDayChange(CalendarView view, int year,
                int month, int dayOfMonth) {
            ....
            .... 
```

我无法做到这一点。不断发现反射很难得到..

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T08:13:43.980

有点解决办法。

我对包装类的主要担心是，不小心使用新的 api 不会被标记为错误。所以我可以很容易地在我的应用程序中引入新的错误。

但是从 ADT 17 开始，lintcheck 对此进行了检查。

参见：[lintapicheck](http://tools.android.com/recent/lintapicheck)

笔记。它不会在我的 Eclipse 安装中自动运行（即使两个复选框都在保存和导出启用时运行）我必须右键单击我的项目，android-tools -> 运行 lint。

这对我来说是一个很好的解决方案，所以我会很高兴从这里开始与反思说再见。

# javascript - jquery-mobile 按钮未在脚本中显示

> ID：13113745
> 
> 赞同：0
> 
> 时间：2012-10-28T22:40:00.967
> 
> 标签：javascript, html, jquery-mobile, backbone.js

我有以下代码按预期工作，除了移动按钮没有显示。

```
div id="items">     
 <script id="item-template"  type="text/template">    
         <input type="checkbox" id="toggle" {[ print( done ?  '' : 'checked') ]} />
         <span class="text">{{ text}}</span> 
         <a id="save" data-role="button" data-inline="true" data-icon='plus'>Save</a> 
```

我已经尝试打印出按钮等，但是 querymobile 按钮在脚本中不起作用吗？

为任何建议欢呼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T12:20:20.850

您可以将函数传递给模板并在`onclick`事件中调用它，如下所示：

```
var tpl = _.template( $("#item-template").html(), {fn : function() {alert("clicked!");} ); 
```

在模板中：

```
<a href="#" id="save" onclick="<% fn() %>" > Save </a> 
```

# jquery - 通过 JQuery 到数据库的外部域到图片

> ID：13113751
> 
> 赞同：1
> 
> 时间：2012-10-28T22:40:18.207
> 
> 标签：jquery, sql, database, embed, image

是否可以在外部域中嵌入一个 jQuery 脚本（位于我的网站上），它将获取其地址，然后在我的数据库中搜索它，然后根据数据库中的值显示特定图片？如果是这样，我从哪里开始？我是 jQuery 的新手。

提前致谢， 拉奇

# python - 按降序排序列表 Jinja

> ID：13113754
> 
> 赞同：3
> 
> 时间：2012-10-28T22:40:31.493
> 
> 标签：python, html, sqlalchemy, flask, jinja2

我正在使用 Jinja 模板引擎在 Flask 中创建一个网站。我有一个公告列表，但没有很好的方法来对它们进行排序。

他们现在正在被 id 调用的表中。我想按最新的优先排序（这意味着最高的 id）

像：

*   P1
    *   5
    *   4
    *   3
*   P2

    *   2
    *   1

在我的 HTML 中，我为 Jinja 提供了以下说明：

```
<div id="main"> 

{% autoescape false %}
{% for announcement in announcements.items|sort(attribute='id', reverse = True) %}

  <a name={{announcement.title}}></a>
  <h1>{{announcement.title}} - Posted on: {{announcement.date}}</h1>
  {{announcement.body}}
  <br/>
  <hr/>

{% endfor %}
{% endautoescape %}

 <p class = "footer">{% if announcements.has_prev %}<a href="{{ url_for('index', page = announcements.prev_num) }}"><< Newer posts</a>{% else %}<< Newer posts{% endif %} | 
 {% if announcements.has_next %}<a href="{{ url_for('index', page = announcements.next_num) }}">Older posts >></a>{% else %}Older posts >>{% endif %} </p>

<br/>
</div> 
```

和蟒蛇：

```
from flask import render_template, Markup
from app import app
from config import POSTS_PER_PAGE
from models import Announcement, VideoAnnouncement

@app.route('/')
@app.route('/index')
@app.route('/index/<int:page>')
def index(page = 1):
    loggedOut = True
    announcements = Announcement.query.paginate(page, POSTS_PER_PAGE, True)
    videoAnnounce = VideoAnnouncement.query.all()
    return render_template("index.html", announcements = announcements, videoAnnouncements = videoAnnounce , loggedOut = loggedOut) 
```

但这有点像：

*   P1
    *   3
    *   2
    *   1
*   P2

    *   5
    *   4

有没有按降序排序，不会被页面弄乱？

（我希望我的问题是有道理的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:57:06.920

接受食人者的建议。我在分页之前重新排序了查询。

更新代码：

```
from flask import render_template, Markup
from app import app
from config import POSTS_PER_PAGE
from models import Announcement, VideoAnnouncement

@app.route('/')
@app.route('/index')
@app.route('/index/<int:page>')
def index(page = 1):
    loggedOut = True
    query = Announcement.query.order_by(Announcement.id.desc())
    announcements = query.paginate(page, POSTS_PER_PAGE, True)
    videoAnnounce = VideoAnnouncement.query.all()
    return render_template("index.html", announcements = announcements, videoAnnouncements = videoAnnounce , loggedOut = loggedOut) 
```

# merge - 合并到 DVCS

> ID：13113755
> 
> 赞同：1
> 
> 时间：2012-10-28T22:40:33.323
> 
> 标签：merge, diff, dvcs

对于我的一个应用程序，我正在考虑实现分支/合并。在某些情况下，我不明白如何在没有冲突的情况下合并。让我们以这个为例。

Root 编写了一些代码。A、B 和 C 从他那里提取并添加特征。C 完成，因此 A 和 B 从中提取/合并。我相信它可以通过使用 root 作为基础将它们自己与 C 进行比较来工作。现在 A 和 B 编写更多功能并完成。

现在如果我从 A 拉然后从 B 拉会发生什么？它们的基础是根目录，它们都是从 C 中提取的，因此编辑了相同的行。它如何知道是否存在冲突？如果我编辑 C 写的一行然后从 B 拉出怎么办？我想这将是一个冲突。现在我的最后一个问题是，如果 A 和 B 在从 C 中拉出函数的位置后，会发生什么情况？我想现在归结为差异识别有多好，但我不确定如何从 A 和 B 中提取而不会发生冲突

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:45:10.850

有时你*会*遇到冲突，例如 A 和 B 编辑相同的行（不同）。然后，您需要通过检查它们（并且可能与 A 和 B 交谈！）手动合并更改，而不是依赖 DVCS 为您合并。

您可能还会遇到逻辑冲突（A 和 B 更改了文件的不同部分，因此没有明显的冲突，并且 DVCS 可以处理合并，但是这些部分打破了彼此的假设，因此引入了一个错误）。版本控制无法解决这个问题，只有开发人员之间的沟通和单元测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T08:08:56.063

> 它如何知道是否存在冲突？

*   要么是因为 DVCS 会告诉您：如果编辑了相同的行，它将触发合并的手动解析
*   或者因为你：
    *   足够了解代码以发现*语义*冲突
    *   有一个扩展的单元测试电池，它将消除语义冲突。

[但正如“仍然不喝 DVCS Kool-Aid](http://discuss.joelonsoftware.com/default.asp?joel.3.803103.28) ”的评论中所提到的，定期提交和合并（比使用 CVCS、集中式版本控制系统快得多）是避免逻辑冲突或使它们尽可能小的关键尽可能。
有关语义冲突的更多信息，请参阅这篇[Martin Fowler 文章](http://martinfowler.com/bliki/SemanticConflict.html)。

# jquery - JQuery 不能在外部工作

> ID：13113757
> 
> 赞同：0
> 
> 时间：2012-10-28T22:40:52.023
> 
> 标签：jquery

```
<head>
    <title> Slider </title>
    <link rel="stylesheet" type="text/css" href="stylesheet.css" />
    <script src="./js/jquery.js"></script>
    <script src="./js/javascript.js"></script>
    <script src="./js/slider.js"></script>  
</head>

<div class="subTab">
     <ul>
         <li><a>First</a></li>
        <li><a>Second</a></li>
    </ul>
</div>
<script>
    // works here
    $(".subTab").css("left", 500);
    alert($(".subTab").position().left);
</script> 
```

内容`js/javascript.js`：

```
$(document).ready(function() 
{
    $(".subTab").css("left", 500);
    alert($(".subTab").position().left);    
}); 
```

问题：

在标签中本地更改和输出`.position().left`of作品，而不是在. 为什么？`.subTab``<script>``js/javascript.js`

CSS：

```
.subTab
{
    z-index:12;
    position:absolute;
    background-color:black;
    padding-right:10px;
    border:1px solid #8C90FF;
    border-top:0px;
} 
```

在滑块内，我们有 index.php 和名为 js 的文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:46:22.797

这应该有助于：

```
$(document).ready(function() 
{
    $(".subTab").css("margin-left", 500);
    alert($(".subTab").position().left);    
})​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:42:56.577

我认为您可能错误地包含了您的外部文件。

尝试在相对路径中使用两个句点加载它。

```
<head>
   // wont work in js/javascript.js
   <script src="../js/javascript.js"></script>
</head> 
```

还可以尝试在您的 javascript.js 文件中添加警报，以查看它是否真正被加载。或者您可以使用 firebug 来查看它是否已加载。

如果你能把你项目的目录结构贴出来，我可以给你一个更具体的答案。

您的代码似乎格式不正确。

尝试：

```
$(document).ready(function() 
{
    $(".subTab").css("left", 500);
    alert($(".subTab").position().left);    
}); 
```

# c# - C# 比较构造函数签名

> ID：13113759
> 
> 赞同：0
> 
> 时间：2012-10-28T22:41:24.400
> 
> 标签：c#, generics, constructor, func

你如何比较构造方法？假设我有一个有 3 个构造函数的类。

```
public class MyClass
{
        private string myName;
        private string mySurname;
        public MyName {get;set;}
        public MySurname{get;set;}    
        public MyClass()
        {}
        public MyClass(string myName)
        {
           this.myName = myName;
        } 
} 
```

我有以下我使用的函数，我想弄清楚调用了哪个构造函数。

```
public <T> GetBOData<T>(Func<T> Constructor) where T: Class
{
     if(Constructor signature already exist)
     {
        pull Cache value
     }
     ELSE
     {
       Invoke it and save the values into the cache.
     } 
} 
```

这个想法是，如果我已经在应用程序的某个地方调用了这个构造函数，请将其添加到 DICTIONARY 中。因此，如果我再次调用相同的构造函数，它就不会再访问数据库了。它只是提取 DICTIONARY 值。

目前使用 MethodInfo 作为标识符，但我意识到它会更改每个 winform，因此我所有的调用总是命中数据库。

提前谢谢。

# c++ - C++ 在构造函数中设置数组大小，复制一个二维数组

> ID：13113764
> 
> 赞同：1
> 
> 时间：2012-10-28T22:42:19.180
> 
> 标签：c++, arrays

因此，在我的类的头文件中，`Foo`我声明了一个二维整数数组，如下所示：

```
int board[][]; 
```

我故意省略一个大小，因为我想在构造函数中设置它。`board[][]`初始化后大小不会改变。我的一个构造函数如下所示：

```
Foo(int _board[][]); 
```

在这个我想设置`board[][]`为相同的大小`_board[][]`并复制内容。我曾尝试在 .cpp 实现中使用它`Foo`：

```
Foo::Foo(int _board[][]){
board[][] = _board[][]; //Does not work as intended
} 
```

但是，这不能按预期工作。我怎样才能使`board[][]`大小和构造函数中的内容相同`_board[][]`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:55:17.697

C++ 与 Java 不同。`int a[][];`不允许作为变量类型。一些误导性的 C++ 特性是允许将第一个大小留空：

```
int foo(int a[]);
int foo(int a[][3]); 
int foo(int a[][3][4]); 
```

另一个误导性的 C++ 特性是在数组的初始化中允许这样做（编译器将计算大小）：

```
int a[][] = {{1,2}, {1,2,3,4}, {1}}; 
```

这相当于：

```
int a[3][4] = {{1,2}, {1,2,3,4}, {1}}; 
```

* * *

对于您的情况 - 使用 std::vector：

```
std::vector<std::vector<int>> board;
Foo(std::vector<std::vector<int>> board) : board(board) {} 
```

* * *

如果您出于某种原因不能使用 std::vector - 那么唯一的解决方案是同时使用`int**`两种尺寸：

```
int** board;
size_t s1;
size_t s2;
Foo(int** board = NULL, size_t s1 = 0, size_t s2 = 0) : board(board), s1(s1), s2(s2) {} 
```

但请注意，您不能使用这种方式：

```
int board[][] = {{1,1,2},{1,2,2}};
Foo foo((int**)board,2,3); 
```

因为你必须提供一个动态数组：

```
int** board = new int*[2] { new int[3]{1,1,2}, new int[3]{1,2,2}}; 
```

从那以后 - 你必须实现复制构造函数、赋值运算符和析构函数：

```
Foo(const Foo& other) : TODO { TODO }  
~Foo() { TODO }  
Foo& operator = (Foo other) { TODO } 
```

所以，只需使用 std::vector。

# c# - 在视图模型中实现 IDataErrorInfo

> ID：13113779
> 
> 赞同：6
> 
> 时间：2012-10-28T22:44:00.007
> 
> 标签：c#, wpf, validation, mvvm, idataerrorinfo

我有一个带有 Phone 对象作为其属性之一的 ViewModel 类，我的主窗口数据上下文设置为 ViewModel，我是否需要在底层 Phone 模型类或包含 Phone 属性的 ViewModel 类上实现 IDataErrorInfo？

另外，将我要验证的文本框绑定到我的 ViewModel.NewPhone.StringProperty 的正确方法是什么？

非常感谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-29T07:59:08.137

在哪里实现的决定`IDataErrorInfo`实际上取决于您的应用程序的逻辑。例如，您可以让您的`Phone`类以不允许任何无效电话号码的方式实现它，但在您的视图模型中您希望只允许来自美国的号码。

通常一个好的做法是`IDataErrorInfo`在你的模型和视图模型中都实现，如果视图模型没有发现错误，将请求转发给模型。然后你会像往常一样绑定到视图模型。

```
public string this[string propertyName]
{
    get
    {
        if (propertyName == "PhoneNumber")
        {
            if (!IsUSNumber(PhoneNumber))
            {
                return "Non-US number.";
            }
        }

        // No validation errors found by the viewmodel
        // Forward to model's IDataErrorInfo implementation
        return Model[propertyName];
    }
} 
```

我建议让模型实现与每个电话相关的基本验证，例如电话号码格式，并让视图模型实现可能因视图而异的视图特定验证，例如只允许美国电话号码或属于给某个供应商。

# python - 如何让 TK 按钮命令接收带有变量的参数（Python）

> ID：13113780
> 
> 赞同：1
> 
> 时间：2012-10-28T22:44:07.353
> 
> 标签：python, tkinter, tk

这让我难过了一个多星期。正如标题所问，我怎样才能让 TK 按钮命令接收带有变量的参数？

这是我正在使用的确切代码：

```
i=0

# Make a Staff list button
staffButton = Button(masterFrame,
                        text='Staff List',
                        width=20,
                        justify=LEFT,
                        #command=lambda:self.openTabHere(isLeft,STAFF_LIST_TAB))
                        command=lambda:self.openTabHere(isLeft,i))
staffButton.grid(column=0, row=1)

# Make a course list button
courseButton = Button(masterFrame,
                        text='Course List',
                        width=20,
                        justify=LEFT,
                        #command=lambda:self.openTabHere(isLeft,COURSE_LIST_TAB))
                        command=lambda:self.openTabHere(isLeft,i))
courseButton.grid(column=0, row=0)

i=1 
```

请注意，如果我使用注释（硬编码）命令，它会按预期工作。但是，如果我使用*未*注释的代码和变量 i，则两个按钮都会以 i=1 的命令结束。

是命令在运行时获取变量 i 吗？如果是这样，或者出于其他原因，我能做些什么来完成我想做的事情？

这是因为我对每个员工都做了类似的事情；一个 for 循环，旨在具有打开一个选项卡的按钮，该选项卡具有作为无法硬编码的变量的参数中的人员 ID。

提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T02:30:55.400

您需要在创建小部件时绑定 i 的值：

```
staffButton = Button(..., command=lambda btn=i:self.openTabHere(isLeft,btn)) 
```

您可能需要为 做同样的事情`isLeft`，除非这是一个静态值。

# php - 为什么 mysql_fetch_array() 期望参数 1 是资源？为什么不是参数 1 资源？

> ID：13113783
> 
> 赞同：0
> 
> 时间：2012-10-28T22:44:33.783
> 
> 标签：php

警告：mysql_fetch_array() 期望参数 1 是资源，第 19 行 C:\xampp\htdocs\test\index.php 中给出的字符串

```
 <?php
 $con = mysql_connect('localhost');
 if (!$con)
   {
   die('Could not connect: ' . mysql_error());
   }

 mysql_select_db("schedule", $con);

 $sql = "SELECT * FROM classes LIMIT 0,50\n";

 mysql_query($sql);

 IF (!$sql) {
   ECHO 'broken';
 };

 while($row = mysql_fetch_array($sql, MYSQL_BOTH))
   {
   echo $row['language'] . " " . $row['level'];
   echo "<br />";
   }

 mysql_close($con);
 ?> 
```

为什么？查询在 phpmyadmin 中有效

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-28T22:49:54.103

mysql_fetch_array() 函数的参数是您的 SQL 语句**字符串**。这就是你的警告所说的。您应该首先使用 $res = mysql_query($sql); 并将 $res 作为参数传递给 mysql_fetch_array()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T23:03:36.377

mysql_fetch_Array 的输入是一个资源，也是 mysql_query 的返回值。如果将值 $sql 传递给 mysql_query()，它不会修改参数，因为它是按值传递的。您必须将返回值分配给另一个变量，这将是所需的资源。

```
 $result = mysql_query($sql); 
```

然后，将结果参数传递给 mysql_fetch_array ：

```
 $row = mysql_fetch_array($result, MYSQL_BOTH) 
```

另一个重要说明：正如您在所有相关线程中看到的那样，请阅读[php.net](http://us2.php.net/mysql_query)中的红色框以了解这些功能。

> 不鼓励使用此扩展程序。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。另请参阅 MySQL：选择 API 指南和相关的常见问题解答以获取更多信息。此功能的替代方案包括：
> 
> mysqli_query() PDO::query()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:51:33.017

更改：mysql_query($sql); 到：`$sql = mysql_query($sql);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T22:59:58.393

引用自 PHP.net 关于`mysql_query()`：

> 对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。
> 
> 对于其他类型的 SQL 语句，INSERT、UPDATE、DELETE、DROP 等，mysql_query() 在成功时返回 TRUE，在错误时返回 FALSE。

在您的情况下，资源被退回，但您忘记将其分配给任何东西。

更改`mysql_query($sql)`为`$resource = mysql_query($sql)`。

完整的文档在这里： http: [//php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

# java - Try and Catch 成一个方法

> ID：13113786
> 
> 赞同：0
> 
> 时间：2012-10-28T22:45:00.950
> 
> 标签：java, function, methods, try-catch, procedure

我正在尝试将 try-catch 放入过程类型方法中，但我 95% 确定它必须是函数类型。我想要完成的是主要使我的代码更短。我想到的最重要的事情之一是将 try-catch 放入方法并调用该方法。

问题是，它会验证输入是否是整数——它甚至会捕获异常，问题是一旦继续执行程序/计算，它就不会“记住”经过验证的输入。这是我遇到问题的代码部分。

```
 public static void tryCatchNum(double value)
 {
    while(true)
    {
    try
    {
        Scanner iConsole = new Scanner(System.in);
        value = Double.parseDouble(iConsole.nextLine());
            System.out.println(" ");
        break;
    }
    catch(NumberFormatException e)
    {
        System.out.println("NumberFormatException error has oocured. Please try again.");
    }
} 
```

}

这是整个程序：

```
 import java.util.Scanner;

    public class ch7exercise1
{
public static double compound(double oA, double cI)
{
    return roundCent((oA*(Math.pow((1+(percent(cI))),10))));
}

public static double percent(double interest)
{
    return interest/100.0;
}

public static double roundCent(double amount)
{
    return ((Math.round(amount*100))/100.0); //100.0 is mandatory.
}

public static void tryCatchNum(double value)
{
    while(true)
    {
        try
        {
            Scanner iConsole = new Scanner(System.in);
            value = Double.parseDouble(iConsole.nextLine());
            System.out.println(" ");
            break;
        }
        catch(NumberFormatException e)
        {
            System.out.println("NumberFormatException error has oocured. Please try again.");
        }
    }
}

@SuppressWarnings("unused")
public static void main(String[] args)
{
    boolean f = true;
    boolean f2 = true;
    double origAmount = 0;
    double compInterest = 0;
    double total = 0;

    Scanner iConsole = new Scanner(System.in);

    System.out.println("10 year Compound Interest Claculator\n");

    System.out.println("Input amount of money deposited in the bank");

    tryCatchNum(origAmount);

    System.out.println("Input compouded interest rate. (If the compound interest is 3% input 3)");

    tryCatchNum(compInterest);

    total = compound(origAmount,compInterest);

    System.out.println("$"+total);

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:53:49.810

Java 参数是按值传递的。您将 0 传递给该`tryCatchNum`方法。将值的副本传递给该方法。此方法为其自己的副本分配一个新值，然后返回。所以原来的值还是0。

您不得将任何内容传递给该方法。相反，该方法必须返回它已验证的值。此外，请考虑使用更合适的方法名称：

```
public double readDoubleValue() {
    ...
    return value;
} 
```

在主要方法中：

```
double origAmount = readDoubleValue(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T22:56:34.983

由于 double 在 Java 中是一个原语，它是按值传递给方法的，因此当您更改原语的值时，对方法参数的更改不会反映在传递给方法调用的原始变量中。

阅读关于 Java 牧场的杯子故事，其中解释了按值传递和按引用传递。 [http://www.javaranch.com/campfire/StoryCups.jsp](http://www.javaranch.com/campfire/StoryCups.jsp)

下一个要阅读的故事是 Java Ranch 上的 Pass By Value 故事。 [http://www.javaranch.com/campfire/StoryPassBy.jsp](http://www.javaranch.com/campfire/StoryPassBy.jsp)

您应该更改您的方法，以便它返回一个 double，该 double 分配给程序的 main 方法中的 value。

我也很好奇你为什么使用一个检查 true 的 while 循环。我认为如果输入的值无法转换为双精度值，您的程序很可能会遇到无限循环。

# c# - C# winforms 中的属性来指定资源选择器？

> ID：13113788
> 
> 赞同：2
> 
> 时间：2012-10-28T22:45:10.327
> 
> 标签：c#, winforms, properties, attributes, embedded-resource

我在 C# 中为 WinForms 制作了一个自定义控件。它的属性之一是将在某个时候播放的音频流。有没有办法告诉 VS 这个属性应该从具有属性或类似属性的资源清单（特别是音频资源）中选择？

![属性，已定义。](../Images/03b83b5d2c804b3c8d927d22845dc920.png)

被注释的属性是一个音频流。

![控制属性。](../Images/fa10d638a98b2c4852e15e6c3183a98f.png)

这就是它在 WinForms 设计器中的显示方式。

![二进制数据编辑器。](../Images/5b78dc17e6b0d92992f2d7fd63a632cf.png)

这是您单击编辑 [...] 按钮时得到的结果。我希望将其替换为 [audio] 资源选择器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:12:45.567

您正在寻找的是：

```
[Editor(typeof(MyAudioEditor), typeof(UITypeEditor)] 
```

此属性允许您指定在属性网格中显示该属性时要使用的特定编辑器。

然后，您可以从基本类型派生和创建新编辑器。基类型必须是或必须派生自 System.Drawing.Design.UITypeEditor。

在大多数情况下，当调用编辑器时，您会弹出一个您选择的表单，并将其返回值绑定到您的属性。

UITypeEditor 有 4 个虚拟方法和一个虚拟属性，可让您在有人与您的属性交互或在网格中绘制您的属性时更改所有行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T00:34:37.227

我在下面发布了一个代码，显示了我自己会如何做。

只是一些观察：

*   在我的代码中，我创建了一个`AudioName`将在设计器中设置的 String 属性。此属性引用程序集中的资源名称。`Audio`然后将从所选资源名称中检索您感兴趣的 Stream 类型的（只读）属性。
*   正如 Marc-André Jutras 在他的回答中指出的那样，您需要自己编写代码`UITypeEditor`或`TypeConverter`从程序集中检索音频资源。在这种情况下，我选择实现一个自定义`TypeConverter`.

    ```
    Public Class Form1
        <System.ComponentModel.TypeConverter(GetType(AudioConverter)), System.ComponentModel.DefaultValue("(none)")>
        Public Property AudioName As String

        <System.ComponentModel.Browsable(False)> 'This will make the property not appear in the designer
        Public ReadOnly Property Audio As Stream
            Get
                If String.IsNullOrWhiteSpace(AudioName) OrElse
                    AudioName = "(none)" Then
                    Return Nothing
                End If
                Try
                    Return My.Resources.ResourceManager.GetStream(AudioName)
                Catch ex As Exception
                    Return Nothing
                End Try
            End Get
        End Property
    End Class

    Public Class AudioConverter
        Inherits System.ComponentModel.TypeConverter

        Public Overrides Function GetStandardValuesSupported(context As System.ComponentModel.ITypeDescriptorContext) As Boolean
            Return True
        End Function

        ' Set the property to be informed only from predefined (standard) values
        Public Overrides Function GetStandardValuesExclusive(context As System.ComponentModel.ITypeDescriptorContext) As Boolean
            Return True
        End Function

        ' Get possible values that will be inserted in the drop-down list
        Public Overrides Function GetStandardValues(context As System.ComponentModel.ITypeDescriptorContext) As System.ComponentModel.TypeConverter.StandardValuesCollection

            Dim returnList As New System.Collections.Generic.List(Of String)
            returnList.Add("(none)")
            For Each resItem As System.Collections.DictionaryEntry In My.Resources.ResourceManager.GetResourceSet(System.Globalization.CultureInfo.InvariantCulture, True, False)
                Dim resourceEntry As String = resItem.Key
                If TypeOf resourceEntry Is String Then
                    returnList.Add(resourceEntry)
                End If
            Next

            Return New System.ComponentModel.TypeConverter.StandardValuesCollection(returnList)
        End Function
    End Class 
    ```

# jquery - Jquery检查下一个元素输入是否是按钮

> ID：13113794
> 
> 赞同：0
> 
> 时间：2012-10-28T22:45:58.930
> 
> 标签：jquery, html, input

我正在使用此功能来检查`Enter Key`压力机并模仿压力机的动作`Tab Key`。但是，当用户到达最后一个输入时：文本我希望它接受`Enter Key`并且不使用该功能

这可能吗？

```
$('input').live("keypress", function (e) {
    /* ENTER PRESSED*/
    if (e.keyCode == 13) {
        /* FOCUS ELEMENT */
        var inputs = $(this).parents("form").eq(0).find(":input");
        var idx = inputs.index(this);
        if (idx == inputs.length - 1) {
            inputs[0].select()
        } else {
            inputs[idx + 2].focus(); // Skips two inputs
            inputs[idx + 2].select();
        }
        return false;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T22:51:08.407

您应该将`return`语句移动到`else`块中：

```
$(document).on('keypress', 'input', function (e) {
    /* ENTER PRESSED*/
    if ( e.keyCode == 13 ) {
        /* FOCUS ELEMENT */
        var inputs = $(this).closest('form').find(":input");
        var idx = inputs.index(this);
        if (idx == inputs.length - 1) {
            inputs[0].select()
        } else {
            inputs[idx + 2].focus(); // Skips two inputs
            inputs[idx + 2].select();
            return false;
        }
    }
}); 
```

**PS**你应该考虑缓存你的选择器。由于我不知道您的具体用例，因此我无法为您提供适当的帮助，但是*在每次按键时*查询DOM 都是**灾难的根源**。

* * *

在不确切知道您如何使用它的情况下，这是一个缓存的快速示例：

```
var inputs;

$(document).on('keypress', 'input', function (e) {
    if ( e.keyCode == 13 ) {
        inputs = inputs || $(this).closest('form').find(":input");
        // The rest of your code...
    }
}); 
```

这会检查是否`inputs`已经有一个值，如果没有，它会查询 DOM。

# c - 在 c 中使用 iwconfig 解析 ssid

> ID：13113795
> 
> 赞同：1
> 
> 时间：2012-10-28T22:46:06.363
> 
> 标签：c, linux, parsing, iwconfig

我正在为 DWM（ubuntu linux）建立一个栏，显示 wifi 详细信息，例如 ssid。

那是我的代码：

```
#include <stdio.h>
#include <stdlib.h>

int main( int argc, char *argv[] )
{

  FILE *fp;
  int status;
  char path[1035];

  /* Open the command for reading. */
  fp = popen("iwconfig", "r");
  if (fp == NULL) {
    printf("Failed to run command\n" );
    exit;
  }
   char s[500];

  /* Read the output a line at a time - output it. */
  while (fgets(path, sizeof(path)-1, fp) != NULL) {
    sprintf(s,"%s%s",s, path);
  }
    //printf("%s",s);
  /* close */
  pclose(fp);

    char delimiter[1] = "s";
    char *ptr;

    ptr = strtok(s, delimiter);

        printf("SSID: %s\n", ptr);

  return 0;
} 
```

我收到溢出错误，不知道该怎么做。我不认为，这也是获得 ssid 的好方法......：/建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T22:58:28.737

我宁愿使用来自内核的直接信息（例如 netdevice(7)）而不是调用子进程。

也许这个标题可以帮助： http: [//lxr.free-electrons.com/source/include/linux/wireless.h](http://lxr.free-electrons.com/source/include/linux/wireless.h)

编辑：如果你仍然想使用`popen`，你不只是添加一个`| grep Essid:`？

```
$ /sbin/ifconfig 2>/dev/null | grep ESSID | cut -d: -f2
"pink-panter" 
```

# python - 使用 pygame.key.get_pressed() 时，我在 python/pygame 中的游戏没有响应

> ID：13113796
> 
> 赞同：0
> 
> 时间：2012-10-28T22:46:13.250
> 
> 标签：python, pygame, keypress

所以我的游戏运行良好，但精灵无法处理重复的按键。我以为我修好了它，但现在一旦我通过开始屏幕，我什么也做不了。我认为问题所在的代码在 playgame() 下。如果有人知道那就太好了！

```
import pygame 
from Classes import PlaneClass
pygame.init()
import sys,random,os
from pygame.locals import*
#import pdb

menuscreen=pygame.display.set_mode((640, 480))#FULLSCREEN
def highscores():
    WHITE=(255,255,255)
    global menuscreen
    highscoresFile= open('data/highscores.txt','r')
    filecontentstoread=''
    for line in highscoresFile:
        filecontentstoread+=str(line)+'\n'

    menuscreen.fill(WHITE)
    my_font = pygame.font.SysFont('Courier', 20)
    the_text = my_font.render(filecontentstoread, True, (0,0,0))
    menuscreen.blit(the_text, (20, 40))
    pygame.display.update()

def playgame():

    BLACK=(0,0,0)#Define the color black, later used as backgound
    plane_x=0  #Define the planes x and y coordinates
    plane_y=0

    gamescreen=pygame.display.set_mode((640, 480))#FULLSCREEN
    gamescreen.fill(BLACK) #Fill screen with black, as background
    plane_img=pygame.image.load('data/plane.png')
    plane=PlaneClass(plane_x,plane_y,plane_img)

    plane.move(plane_x,plane_y)

    gamerunning=True

    while gamerunning==True:
        #Move plane according to keyboard input
            keys=pygame.key.get_pressed()
            if keys[K_LEFT]:
                    plane_x -=1
                    plane.move(plane_x,plane_y)
            if keys[K_RIGHT]:
                    plane_x +=1
                    plane.move(plane_x,plane_y)
            if keys[K_UP]:
                    plane_y -=1
                    plane.move(plane_x,plane_y)
            if keys[K_DOWN]:
                    plane_y+=1
                    plane.move(plane_x,plane_y)

            #gamescreen.fill(BLACK)

clock=pygame.time.Clock()
clock.tick(30)
def menu_screen_options():
    menuvalue=main_menu()
    laserstartup=pygame.mixer.Sound('data/laserstartup.wav')
    laserstartup.play()
    if menuvalue==0:
        playgame()
    if menuvalue==1:
        highscores()
    if menuvalue==2:
        credits()
    if menuvalue==3:
        pygame.quit()
        sys.exit()

def main_menu():
    menuclock=pygame.time.Clock()
    clock.tick(30)

    pygame.display.set_caption('Dog Fight')
    #pygame.mouse.set_visible(False)

    WHITE=(255,255,255)
    GREEN=(0,255,0)
    BLUE=(0,0,255)
    background=pygame.image.load('data/background.png')
    lasersound=pygame.mixer.Sound('data/lasershot.wav')

    arrow=pygame.image.load('data/arrow.png')

    arrowpos = { 0 : (140,147) , 1:(140,210) , 2:(140,270) , 3 :(140,330) }

    menu=True
    counter = 0
    menuscreen.blit(arrow,arrowpos[counter])
    menuscreen.blit(background,(0,0))
    pygame.display.update()

    while menu == True:
        for event in pygame.event.get():
            if event.type == QUIT:
                pygame.quit()
                sys.exit()
            if event.type == KEYDOWN:
                if event.key == K_ESCAPE:
                    menu = False

                if event.key == K_UP:
                    if counter > 0:
                        counter -= 1

                if event.key == K_DOWN:
                    if counter < 3:
                        counter += 1

                if event.key == K_RETURN:
                    return counter

            menuscreen.fill(WHITE)
            menuscreen.blit(background,(0,0))

            menuscreen.blit(arrow,arrowpos[counter])
        pygame.display.update()

menu_screen_options() 
```

另外，我不知道这是否有帮助，但精灵类的代码是。

```
import pygame

class PlaneClass(pygame.sprite.Sprite):

    # -- Methods
    # Constructor function
    def __init__(self,x,y,sprite_image):
        self.image=sprite_image

        self.x=x
        self.y=y
        pygame.sprite.Sprite.__init__(self)

    def move(self,new_x,new_y):
        screen=pygame.display.get_surface()
        self.new_x=new_x
        self.new_y=new_y
        screen.blit(self.image,(new_x,new_y))
        pygame.display.update() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T22:54:25.727

您`get_pressed`在循环中进行了调用`while True`，因此您永远不会回到主事件循环（带有 的位`for event in pygame.event.get():`）。这会阻止您的程序处理更多事件，这意味着您的程序会锁定。

相反，您需要在主事件循环中等待一个按键事件，并且仅`get_pressed`在您知道有按键要处理时才调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T03:25:14.293

请注意，您正在使用 keydown 轮询。您可能需要按键事件。请参阅：[https ://stackoverflow.com/a/11918084/341744](https://stackoverflow.com/a/11918084/341744)

# android - Android mediaplayer onSeekComplete 未被调用

> ID：13113803
> 
> 赞同：3
> 
> 时间：2012-10-28T22:47:07.380
> 
> 标签：android, media-player, seek

我正在编写一个媒体播放器，它将直播和点播流。它大部分都在工作，但由于某种原因，我无法让 seekTo(int) 正常工作。我的问题是，当我调用 seekTo(int) 时，我没有得到我的 onSeekComplete 回调。我在我的 onPrepared 回调中注册了我的回调方法。

我应该注意到我也在使用 MediaController，并且我已经用 MediaController 注册了我的 MediaPlayer。当我通过点击搜索栏进行搜索时，它会通过我的 MediaController 并且在那种情况下我确实得到了我的 onSeekComplete 回调。这是我的代码。

```
package com.brockoli.android.hsdroid;

import java.io.IOException;

import android.app.Activity;
import android.content.Intent;
import android.graphics.Point;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnSeekCompleteListener;
import android.os.Bundle;
import android.os.Handler;
import android.util.Log;
import android.view.Display;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.ViewGroup.LayoutParams;
import android.widget.MediaController;
import android.widget.MediaController.MediaPlayerControl;
import android.widget.ProgressBar;

public class VideoPlayerActivity extends Activity implements MediaPlayer.OnPreparedListener, 
                                                             MediaPlayer.OnVideoSizeChangedListener, 
                                                             SurfaceHolder.Callback,
                                                             MediaController.MediaPlayerControl,
                                                             OnSeekCompleteListener {

    private MediaPlayer mp;
    private MediaController mc;
    private int width = 0;
    private int height = 0;
    private SurfaceView surface;
    private SurfaceHolder holder;
    private ProgressBar timeline = null;
    private boolean isPaused = false;
    private int mCurrentPosition = 0;

    private Handler handler = new Handler();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.video_player);

        if (getLastNonConfigurationInstance() != null) {
            mCurrentPosition = (Integer) getLastNonConfigurationInstance();         
        }

        mc = new MediaController(this);

        surface = (SurfaceView) findViewById(R.id.surface_video);
        holder = surface.getHolder();
        holder.addCallback(this);

    }

    @Override
    protected void onPause() {
        super.onPause();

        isPaused = true;
    }

    @Override
    protected void onResume() {
        super.onResume();

        width = getScreenWidth();
        height = setHeightBasedOnWidth();

        isPaused = false;

    }

    @Override
    protected void onDestroy() {
        super.onDestroy();

        if (mp != null) {
            mp.release();
            mp = null;
        }
    }

    @Override
    public Object onRetainNonConfigurationInstance() {
        int currentPosition = 0;
        if (mp != null && mp.isPlaying()) {
            currentPosition = mp.getCurrentPosition();
        }
        return currentPosition;
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        mc.show();
        return false;
    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {

    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        Intent intent = this.getIntent();
        String url = intent.getStringExtra("STREAM_ID");

        playVideo(url);

    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {

    }

    @Override
    public void onPrepared(MediaPlayer mediaPlayer) {
        LayoutParams lp = surface.getLayoutParams();
        lp.width = width;
        lp.height = height;
        surface.setLayoutParams(lp);
        if (width != 0 && height != 0) {
            holder.setFixedSize(width, height);
            mc.setMediaPlayer(this);
            mc.setAnchorView(surface);

            handler.post(new Runnable() {

                @Override
                public void run() {
                    mc.setEnabled(true);
                    mc.show();
                }
            });

            Log.d("MEDIAPLAYER", "onPrepared start");
            mp.seekTo(mCurrentPosition);
            //mediaPlayer.start();
        }
    }

    private void playVideo(String url) {
            try {
                if (mp == null) {
                    mp = new MediaPlayer();
                    mp.setScreenOnWhilePlaying(true);
                    mp.setOnVideoSizeChangedListener(this);
                    mp.setOnSeekCompleteListener(this);
                } else {
                    mp.stop();
                    mp.reset();
                }

                mp.setDataSource(url);
                mp.setDisplay(holder);
                mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
                mp.setOnPreparedListener(this);
                mp.prepareAsync();
            } catch (IllegalStateException e) {
                e.printStackTrace();
            } catch (IllegalArgumentException e) {
                e.printStackTrace();
            } catch (SecurityException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
    }

    @Override
    public void onVideoSizeChanged(MediaPlayer mediaPlayer, int newWidth, int newHeight) {
/*      if (width != 0 && height != 0) {
            holder.setFixedSize(width, height);
            //mp.seekTo(mCurrentPosition);
            Log.d("MEDIAPLAYER", "onVideoSizeChanged start");
            //mediaPlayer.start();
        }
*/      
    }

    private Point getScreenSize() {
        Display display = getWindowManager().getDefaultDisplay();
        Point size = new Point();
        display.getSize(size);
        return size;
    }

    private int getScreenWidth() {
        return getScreenSize().x;
    }

    private int getScreenHeight() {
        return getScreenSize().y;
    }

    private int setHeightBasedOnWidth() {
        if (getScreenWidth() > getScreenHeight()) {
            return getScreenHeight();
        }
        return (int) (getScreenWidth()/1.6);
    }

    @Override
    public boolean canPause() {
        return true;
    }

    @Override
    public boolean canSeekBackward() {
        return true;
    }

    @Override
    public boolean canSeekForward() {
        return true;
    }

    @Override
    public int getBufferPercentage() {
        return 0;
    }

    @Override
    public int getCurrentPosition() {
        return mp.getCurrentPosition();
    }

    @Override
    public int getDuration() {
        return mp.getDuration();
    }

    @Override
    public boolean isPlaying() {
        return mp.isPlaying();
    }

    @Override
    public void pause() {
        mp.pause();
    }

    @Override
    public void seekTo(int pos) {
        mp.seekTo(pos);
    }

    @Override
    public void start() {
        Log.d("MEDIAPLAYER", "MediaController start");
        mp.start();
    }

    @Override
    public void onSeekComplete(MediaPlayer mp) {
        mp.start();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T11:09:20.537

设备实现 MediaPlayer 有时会有所不同。检查您的 onInfo 侦听器以查看您是否收到反馈。

从评论中编辑：
我自己尝试过，但在我的应用程序中也对我不起作用。对我来说，解决方法是，特别是如果您的媒体在搜索事件开始时已经在播放，如果您看到 currentPosition 再次增加，那么您知道搜索已经完成。

# perl - 如何从 Perl 中的哈希表中获取前 n 个键值对

> ID：13113808
> 
> 赞同：4
> 
> 时间：2012-10-28T22:47:57.430
> 
> 标签：perl, hash

我对 perl 很陌生，所以我搜索了一段时间，但仍然得到了答案。我想从哈希表中获取前 100 对，但不知道该怎么做。要从哈希表中获取每一对，我们可以执行以下操作：

```
foreach my $term (keys %hashtable)
{
    do something regarding $hashtable{$term} here
} 
```

但是如何从中取出前 100 双呢？非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-28T23:09:53.310

其他方式：

```
my %hash100 = (%hashtable)[0..199];
while ( my ($key, $value) = each %hash100 ) {
    ...
} 
```

或者：

```
for my $key ( (keys %hashtable)[0..99] ) {
    my $value = $hashtable{$key};
    ...
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T23:04:19.077

请注意，由于散列没有特定的顺序，因此与散列*的前 100对不同。*

另一种可以保护您免受错误影响的解决方案：

```
for my $i (1 .. 100) {
    my ($key, $value) = each %hashtable;
    print "$key => $value\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T22:56:32.243

我也是 Perl 的新手，可能有更优雅的解决方案，但您可以执行以下操作：

```
my $i = 0;
foreach my $term (keys %hashtable) {
    ...
    do something regarding $hashtable{$term} here
    ...

    last if ($i++) == 100;    
} 
```

# php - 通过 PHP 从 Mac 应用程序上传 S3 文件？

> ID：13113810
> 
> 赞同：0
> 
> 时间：2012-10-28T22:48:14.573
> 
> 标签：php, objective-c, apache, networking, amazon-s3

这个问题我以前也问过，但是信息太少被删了。这次我会尽量说得更具体一些。

我有一个 Objective-C mac 应用程序，它应该允许用户将文件上传到 S3 存储。s3 存储是我的，用户没有亚马逊账户。到目前为止，这些文件都是直接上传到亚马逊服务器的。在考虑了更多之后，关于安全性和灵活性，这并不是一个很好的概念。我想在两者之间添加一个服务器。用户应该通过我的服务器进行身份验证，如果身份验证成功，服务器将打开一个会话，并且可以开始文件共享。

现在我的问题。我想将文件上传到 S3。一种选择是发出 POST 请求并等待服务器接收到文件。这里的问题是，当文件从我的服务器上传到 S3 服务器时会有延迟，这会使上传时间加倍。

最好是，如果我可以验证请求，然后重定向它，以便客户端将其直接上传到 s3-storage。不确定这是否可能。

直接上传到 S3 似乎不是很聪明。在查看了 Droplr 和 Dropmark 等其他应用程序后，看起来他们并没有这样做。顺便提一句。我用小飞贼做到了这一点。

他们在自己的网络服务器上有自己的 api，就是这样。

有人可以帮我清理一下吗？

**编辑** 我应该如何将我的文件传输到 S3？有没有办法“转发”它，还是我必须将它上传到我的服务器，然后从那里上传到 S3？就像我说的，其他应用程序可以有效地做到这一点，而无需直接与 S3 通信。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:21:53.397

如果身份验证在您的服务器上进行管理，但您不想要两次上传，请查看 AWS/IAM 临时安全凭证。

[http://aws.amazon.com/releasenotes/Java/5316957573949696](http://aws.amazon.com/releasenotes/Java/5316957573949696)

简而言之：

1.  用户通过您的服务器进行身份验证
2.  服务器使用临时安全凭证进行响应
3.  用户使用临时凭据直接上传到 s3

# cpanel - cpanel 上的 exim 灰名单有问题

> ID：13113823
> 
> 赞同：0
> 
> 时间：2012-10-28T22:49:57.643
> 
> 标签：cpanel, exim

当有人试图发送电子邮件时，我在 /var/log/exim_mainlog 中遇到了一些奇怪的错误。问题是我无法解决这个问题，所以我会在这里尝试。

```
2012-10-29 00:35:54 DBD::SQLite::db prepare failed: database is locked at /etc/exim_greylist_sqlite.pl line 1013, <HAN1> line 66.
2012-10-29 00:35:54 H=valid_hostname [valid_ip]:5555 F=<mail@example.com> temporarily rejected RCPT <mail@example.com>: failed to expand ACL string "${perl{greylist}}": Can't call method "execute" on an undefined value at /etc/exim_greylist_sqlite.pl line 1014, <HAN1> line 66.
2012-10-29 00:35:54 SMTP connection from valid_hostname [valid_ip]:5555 closed by QUIT 
```

exim_greylist_sqlite 中的一些行：

```
1012     my $query = "select strftime('%s', block_expires, 'utc')-strftime('%s','now') from relaytofrom where rcpt_to='$lp' and mail_from='$sender_addr'";

1013     $sth = $isp->prepare($query) || print FILE "$query\n";
1014     $sth->execute || print FILE "$query\n";
1015     my @status_array = $sth->fetchrow_array;
1016     $sth->finish; 
```

我什至不知道从哪里开始解决这个问题。我尝试在 cPanel 论坛上搜索，尝试以多种方式使用谷歌但没有结果:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T01:54:10.910

这些似乎适用于您的情况：

[为什么在使用 Perl 的 DBD::SQLite 时，SQLite 会为事务中的第二个查询提供“数据库已锁定”？](https://stackoverflow.com/questions/3943398/why-does-sqlite-give-a-database-is-locked-for-a-second-query-in-a-transaction)

[如何在循环中更新 SELECT 返回的行？](https://stackoverflow.com/questions/1305976/how-can-i-update-rows-returned-by-a-select-in-a-loop)

听起来一个进程正在选择中间，而其他进程正在做一些试图更新数据的事情。找出还有什么正在访问该 sqlite 数据库并将其锁定。如果我是对的，那么第一行之后的所有内容都只是从根本原因中反击：表锁争用。

# ruby-on-rails - 在类的创建动作中创建模型

> ID：13113829
> 
> 赞同：0
> 
> 时间：2012-10-28T22:50:32.057
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

作为 Rails 的新手，我找不到如何解决我的问题 ^^
我想从带有包含视频 url 的文本字段（如 youtube）的表单创建一个 VideoPost
多亏了 gem，我正在获取有关视频的信息[https://github.com/thibaudgg/video_info](https://github.com/thibaudgg/video_info)
我想使用我的模型（VideoInformation）保存这些信息。但我不知道创建过程应该如何工作。
谢谢你的帮助 ！

我正在尝试在 VideoPostsController 中创建一个 VideoPost，如下所示：

```
def create
  video_info = VideoInfo.new(params[:video_url])
  video_information = VideoInformation.create(video_info)      #undefined method `stringify_keys' for #<Youtube:0x00000006a24120>
  if video_information.save
    @video_post = current_user.video_posts.build(video_information) 
  end
end 
```

我的 VideoPost 模型：

```
# Table name: video_posts
#
#  id                   :integer          not null, primary key
#  user_id              :integer
#  video_information_id :integer
#  created_at           :datetime         not null
#  updated_at           :datetime         not null 
```

我的 VideoInformation 模型（其属性名称与 VideoInfo gem 相同）：

```
# Table name: video_informations
#
#  id              :integer          not null, primary key
#  title           :string(255)
#  description     :text
#  keywords        :text
#  duration        :integer
#  video_url       :string(255)
#  thumbnail_small :string(255)
#  thumbnail_large :string(255)
#  created_at      :datetime         not null
#  updated_at      :datetime         not null 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T22:57:02.793

> 不知道创建过程应该如何工作

`create`方法需要一个带参数的散列，而不是某个任意对象。您应该使用 VideoInfo 的方法并将其转换为 ActiveRecord 可以使用的哈希值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T23:15:25.943

我将向 VideoInformation 模型添加一个方法，以便您可以通过传入 video_info 创建一个方法：

```
# app/models/video_information.rb
def self.create_from_video_info(video_info, url)
  video_information = self.new
  video_information.title = video_info.title
  video_information.description = video_info.description
  video_information.keywords = video_info.keywords
  video_information.duration = video_info.duration
  # video_url appears to not be available on video_info,
  # maybe you meant embed_url?
  video_information.video_url = url
  video_information.thumbnail_small = video_info.thumbnail_small
  video_information.thumbnail_large = video_info.thumbnail_large
  video_information.save
  video_information
end

# app/controllers/video_posts_controller.rb
def create
  video_info = VideoInfo.new(params[:video_url])
  video_information = VideoInformation.create_from_video_info(video_info, params[:video_url])

  if video_information.valid?
    current_user.video_posts << video_information
  end
end 
```

此外，您可能希望以不同的方式进行此操作。`VideoInformation`有,`VideoInfo`和`VideoPost`类 似乎是多余的。

也许`VideoPost`模型可以简单地存储视频的 URL，并且您可以在`VideoInfo`渲染/使用`VideoPost`实例时根据需要即时提取内容。

# postgresql-9.1 - Postgresql 9.1：错误：类型“citext”不存在

> ID：13113831
> 
> 赞同：8
> 
> 时间：2012-10-28T22:50:40.647
> 
> 标签：postgresql-9.1

我正在尝试通过 PgAdmin 实用程序执行以下查询。

```
CREATE TABLE svcr."EventLogs" ("eventId" BIGINT NOT NULL, 
"eventTime" TIMESTAMP WITH TIME ZONE NOT NULL, "userid" CITEXT, 
"realmid" CITEXT NOT NULL, "onUserid" CITEXT, "description" TEXT, 
CONSTRAINT eventlogs_pkey PRIMARY KEY ("eventId")); 
```

我得到以下错误 -

```
ERROR: type "citext" does not exist
SQL state: 42704
Character: 120 
```

但是，以下查询运行良好 -

```
CREATE TABLE svcr."CategoryMap" ("category" INT NOT NULL, 
"userData" INT NOT NULL); 
```

第一个查询有什么问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T22:57:34.527

你用的是什么版本的pg？在 < 8.4 中，citext 可以作为附加组件安装：

[http://pgxn.org/dist/citext/](http://pgxn.org/dist/citext/)

>= 8.4 它应该在核心中可用。

这里还有一些 9.1.2 的升级说明：

[http://www.postgresql.org/docs/9.1/static/release-9-1-2.html](http://www.postgresql.org/docs/9.1/static/release-9-1-2.html)

您可能需要加载 citext 扩展：

如果不存在带有 SCHEMA ext 的 citext，则创建扩展；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-18T11:05:50.243

pgadmin -> [你的数据库] -> 扩展 -> 创建扩展 -> 从下拉列表中选择一个**citext**并保存

# jquery - jquery 执行操作，除非 div 已经存在，然后替换

> ID：13113833
> 
> 赞同：0
> 
> 时间：2012-10-28T22:51:21.980
> 
> 标签：jquery, datatables

我有一个 jquery 数据表，在该数据表中，每一行都有一个列，可让您查看该行的详细信息。我不需要数据表 row_details 的东西。

这个想法是，一旦单击“视图”，文本就会变为隐藏，并且带有 row_### 的 div 将附加到内容正文中。然后，如果在显示该行时单击相同的按钮，它将隐藏它。此外，如果有人单击另一行的视图，则前一行文本应该变回隐藏，div 隐藏，并且应该显示刚刚单击的行。

这是我到目前为止所拥有的：

```
$("a[class^=view]").click(function() {
    var id = $(this).attr('class').match(/\d{1,}/);

    if( $("div[id^=report_]").size() >= 1) {
     // Slide up, remove
             // Change text back to view    
    } else {
             // Append and change text to Hide
            }
}); 
```

如果我在已经显示一个细节的情况下单击另一个“视图”，它会在当前 div 中添加一个新 div 并将相同的新 div 附加到内容主体.. 显然不是我正在寻找的效果，所以我的逻辑是错误的。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:43:50.180

知道了。有点乱，但它的工作原理。如果有其他方法感兴趣。这是解决方案：

```
$("a[class^=view]").click(function() {
    var id = $(this).attr('class').match(/\d+/);

    if($(this).text() == "Hide") {
        $(this).text("View");
        $("#report").html(null);
    } else {
        $("a[class^=view_]").each(function(){$(this).text("View");});
        $(this).text("Hide");
        $("#report").html("<div id='report_"+id+"'>viewing report "+id+"</div>").slideDown();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T04:49:13.577

要知道一个元素是否已经存在，我在父元素上使用 jquery 的 find ，寻找他的孩子......像这样：

```
if($('#parent_container').find('#child_element').length>0){
     //element(s) exists
}else{
     //element(s) not found
} 
```

# ios6 - 清空 UICollectionView 中的所有单元格

> ID：13113850
> 
> 赞同：1
> 
> 时间：2012-10-28T22:53:23.163
> 
> 标签：ios6, uicollectionview

使用 iOS6 的新功能`UICollectionView`，我如何能够`UICollectionViewCell`在一个大循环中删除所有对象？

假设我已经将所有数据加载到其中，我点击刷新，我想删除当前在那里的所有内容，然后再次调用我的东西。

我发现`deleteItemsAtIndexPaths`which 需要一个`NSArray`，那么我怎样才能将所有项目放入其中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-13T17:28:21.973

清除 UICollectionVew 的正确方法是简单地清除数据源，然后重新加载集合视图。

因此，如果您的数据源是一个数组：

```
self.dataArray = nil;
[self.collectionView reloadData]; 
```

砰，你被清除了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-29T19:17:57.193

结果我可以使用`deleteSections`并传递`NSIndexSet`给它，制作一个范围，`0,0`它会删除唯一的部分。

```
NSIndexSet *indexSet = [NSIndexSet indexSetWithIndexesInRange:NSMakeRange(0, 0)];
[self.collectionView deleteSections:indexSet]; 
```

我可能只是使用`indexSetWithIndex`，但是当我这样做时，我的应用程序崩溃了。

# matlab - 让 matlab 认为 gpuArray 是标量

> ID：13113856
> 
> 赞同：0
> 
> 时间：2012-10-28T22:54:15.230
> 
> 标签：matlab

我有以下功能，我想将其应用于每个元素：

```
function result = f(a, b, bs)
    % Simplified code
    result = a
    for i=0:bs
        result = dosomething(result, b(i))
    end
end

% Use
arrayfun(@result, gpuArray(A), gpuArray(B), size(B)); 
```

有没有一种方法可以“欺骗”MATLAB 认为`b`是标量以传递给函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T11:29:38.820

不幸的是，目前没有办法这样做，原因有两个：首先，gpuArrays 的 ARRAYFUN 实现始终坚持输入要么是标量，要么都是相同大小。其次，gpuArray ARRAYFUN 主体当前不支持从外部范围引用变量的索引或匿名函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T14:17:28.073

唯一的方法是使用`bsxfun`函数：

```
C = bsxfun(f, A, B') % A is column vector 
```

或多或少等同于

```
C(i,j) = f(A(i,1), B(j,1)) 
```

其他有用的功能是`repmat`。

然后对一系列矩阵和向量进行 JIT 处理，因此实际上没有`O(MN)`空间损失（通过 检查`nvidia-smi`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T23:24:07.067

我不完全确定您想要做什么，但我怀疑您希望在每次调用时将整个数组 B 传递给函数`result`。实现这一点的最佳方法是使用类似这样的匿名函数（未经测试的代码）：

```
arrayfun( @(a_in) result(a_in, gpuArray(B), size(B)), gpuArray(A) ); 
```

这应该做的是创建一个只接受一个参数 ( ) 的[匿名函数](http://www.mathworks.co.uk/products/matlab/examples.html?file=/products/demos/shipping/matlab/anondemo.html)`a_in`，并使用完整的数组调用`result`（实际上是`f`在你的函数头中），`B`而不管`a_in`. 因此，在 的每次迭代中`arrayfun`，`result`将只使用 的一个切片`A`，但使用 的整个切片来调用`B`。

编写上述代码的更语法明确的方式如下：

```
my_anon_fun = @(a_in) result(a_in, gpuArray(B), size(B));
arrayfun( my_anon_fun , gpuArray(A) ); 
```

免责声明：代码未经测试，我对代码的使用经验很少，`gpuArray`因此这可能不适用。

# javascript - 如何从循环中删除函数以使其与 JSLint 兼容？

> ID：13113861
> 
> 赞同：0
> 
> 时间：2012-10-28T22:54:38.450
> 
> 标签：javascript, loops, jslint

我正在尝试制作一个插件 JSLint 证明并且正在努力处理以下错误消息：

```
Don't make functions within a loop. 
```

抱怨这个片段：

```
 for ( i = 0; i < pops.length; i++){
    pops.eq(i)
        .addClass('reverse out '+trans)
        .hide('fast')
        .removeClass('ui-panel-active')
        .find(".ui-page-active")
           .not("div:jqmData(show='first')")
           .removeClass('ui-page-active').end()
        .find(".ui-btn-active")
           .removeClass('ui-btn-active').end()
        .find('div:jqmData(external-page="true")')
           .remove().end().end()
           .delay(350)
           // the problem
           .queue(function(next){
               $(this).removeClass('reverse out pop slide');
                 next();
                 });

            ...
        } 
```

我知道问题出在哪里，但不知道如何使它符合 JSlint。

**问题：**
如何使函数脱离循环？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T22:59:00.953

我认为是时候拆分这条单线了。它长得可笑。

要将函数移出循环，请从字面上将函数移出循环：

```
function queue_callback(next) {
    $(this).removeClass('reverse out pop slide');
    next();
} 
```

然后用这个替换`.queue()`回调中的匿名函数：

```
.queue(queue_callback) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-28T22:59:56.290

我能想到的最简单的方法是在外面声明函数并将其作为参数传递：

```
var queue = function(next) {
  $(this).removeClass('reverse out pop slide');
  next();
};

...

.queue(queue) 
```

# com - 避免 COM 编组

> ID：13113864
> 
> 赞同：3
> 
> 时间：2012-10-28T22:55:20.423
> 
> 标签：com, marshalling, inproc

我对 com 线程模型有点困惑。

我有一个 inproc 服务器，我想创建一个可从任何线程访问的接口，而不管 CoInitializeEx 中使用的线程模型和/或标志如何。

当将接口从一个线程传递到另一个线程时，我使用 CoMarshalInterface/CoUnmarshalInterface 没有问题，但我想知道是否存在任何方法来避免这种情况并直接传递接口指针。

我尝试使界面使用中性单元，但仍然必须调用 CoMarshalInterface/CoUnmarshalInterface 以避免出现问题。

问候，毛罗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-28T23:44:43.697

**COM 对象仅**驻留在一间公寓中。通过跨单元边界的接口指针访问 COM 对象*绝不*是一个好主意，除非您适用的场景可以利用**免费的线程封送聚合**。一个[自由线程编组器](http://support.microsoft.com/kb/256217)，本质上说这个接口的所有客户端，不管单元和线程，都在同一个进程中，并且将依赖对象本身来保持同步和线程安全。对象本身必须聚合自由线程编组器接口，因此希望您是它的作者以及客户端代码。

可以在 msdn.com 上找到有关自由线程封送处理的更多信息，但他们的一篇文章涵盖了我倾向于一次又一次地重用的对象是[这篇](http://support.microsoft.com/kb/256217)文章。

我希望它可以帮助你。

# opengl-es-2.0 - OpenGL ES 2.0 上的 VBO 不显示任何内容

> ID：13113866
> 
> 赞同：1
> 
> 时间：2012-10-28T22:55:29.567
> 
> 标签：opengl-es-2.0, vbo, vertex-buffer

我正在学习 OpenGL ES。我已经成功地绘制了一些立方体，了解相机位置背后的基本矩阵逻辑等。现在我正在尝试为 VBO 构建一个示例，但它没有在屏幕上绘制任何内容。我将粘贴我的代码，可能有人会意识到我做错了什么。

### 片段着色器代码

```
precision mediump float;
varying vec2 v_texCoord;
varying vec3 v_colour; 
uniform sampler2D s_texture;    
void main() 
{ 
 gl_FragColor = texture2D(s_texture, v_texCoord);
} 
```

### 顶点着色器

```
attribute vec3 av3position;
attribute vec2 a_texCoord; 
attribute vec3 av3colour;

uniform mat4 PerspectiveMatrix;
uniform mat4 ModelViewMatrix;

varying vec2 v_texCoord; 
varying vec3 v_colour;

void main() 
{ 
v_texCoord = a_texCoord; 
v_colour =av3colour;
vec4 pos = ModelViewMatrix * vec4(av3position,1.0);
gl_Position = PerspectiveMatrix * pos;
} 
```

### 纹理加载

```
Texture01RGBA->boLoadTextureFromfile("BitmapData/cubeLayout_02.png" );

glPixelStorei(GL_UNPACK_ALIGNMENT, 1);         // Use tightly packed data
glGenTextures(1, &gluiTextureID);              // Generate a texture object
glBindTexture(GL_TEXTURE_2D, gluiTextureID);   // Bind the texture object
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, Texture01RGBA->getWidth(), Texture01RGBA->getHeight(), 0, GL_RGBA, GL_UNSIGNED_BYTE, Texture01RGBA->getPixmapPointer()); 
glGenerateMipmap(GL_TEXTURE_2D);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);     
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); 
glActiveTexture ( GL_TEXTURE0 );
glBindTexture ( GL_TEXTURE_2D, gluiTextureID );
// Set the sampler texture unit to 0
glUniform1i ( iLoc2DSampler, 0 ); 
```

### 顶点对象结构

```
const float aCubeVertices[] =
{ // x, y, z, nx, ny, nz, u, v
 1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.500000, 0.500000,
 1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.500000, 0.250000,
-1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.250000, 0.250000,
-1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.250000, 0.500000,
 1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.500000, 0.750000,
-1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.250000, 0.750000,
-1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.250000, 1.000000,
 1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.500000, 1.000000,
 1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.750000, 0.250000,
 1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.750000, 0.000000,
 1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.500000, 0.000000,
 1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.500000, 0.250000,
 1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.500000, 0.250000,
 1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.500000, 0.000000,
-1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.250000, 0.000000,
-1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.250000, 0.250000,
-1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.250000, 0.250000,
-1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.250000, 0.000000,
-1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.000000,
-1.000000,1.000000, 1.000000, 1.000000, 0.000000, 0.000000, 0.000000, 0.250000,
 1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.500000, 0.750000,
 1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.500000, 0.500000,
-1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.250000, 0.500000,
-1.000000,1.000000, 1.000000, 0.000000, 1.000000, 0.000000, 0.250000, 0.750000
};

unsigned short aCubeIndices[]= // 36 Elements. 3 Groups
{  0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23 }; 
```

### VBO创作

```
glGenBuffers (1, &vao);
glBindBuffer  (GL_ARRAY_BUFFER, vao);

glBufferData(GL_ARRAY_BUFFER, 24 * sizeof(float)*8, aCubeVertices, GL_STATIC_DRAW);
glBindBuffer (GL_ARRAY_BUFFER, 0);

glGenBuffers(1, &vinx);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vinx);

glBufferData(GL_ELEMENT_ARRAY_BUFFER, 36* sizeof(GLushort), aCubeIndices, GL_STATIC_DRAW);
glBindBuffer (GL_ELEMENT_ARRAY_BUFFER, 0); 
```

### VBO 绘图

```
glBindBuffer  (GL_ARRAY_BUFFER, vao);
  // set up vertex attributes
  glEnableVertexAttribArray(iLocPosition);
  glEnableVertexAttribArray(iLocTexCoord);
  glVertexAttribPointer(iLocPosition, 3, GL_FLOAT, GL_FALSE, sizeof(float)*8, 0);
  glVertexAttribPointer(iLocTexCoord, 2, GL_FLOAT, GL_FALSE, sizeof(float)*8,  (const void *)24  );
  glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vinx);
  glDrawElements(GL_TRIANGLES, 36, GL_UNSIGNED_SHORT, (void*)0);
  glBindBuffer(GL_ARRAY_BUFFER, 0);
  glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
  glDisableVertexAttribArray(iLocPosition);
  glDisableVertexAttribArray(iLocTexCoord); 
```

正如我之前指出的那样，对于我之前完成的更简单的示例（纹理、转换矩阵），我一直使用基本相同的代码。我还检查了错误，并且没有代码错误存在。

如果有人强调我的代码可能有什么问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T20:38:33.117

Your vertex buffer (or at least your index buffer) seems incorrect. For instance, the first triangle is defined by the indices 0, 1, 2, which correspond to the following vertices:

```
 1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.500000, 0.500000,
 1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.500000, 0.250000,
-1.000000,1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.250000, 0.250000, 
```

As you can see, the position of the first and the second vertices is the same (1,1,1). The result is a degenerate triangle (a triangle with no area) which can't be rendered.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T10:56:46.257

您在此处显示的代码看起来是正确的。问题可能出在代码的其他部分。错误来源之一可能是您如何设置模型视图和透视矩阵。另一个可能是您设置制服 glUniform*() 的方式有问题（可能是行/列多数与您的矩阵不匹配以及 OpenGL 的预期方式）。如果您可以粘贴该代码，那么我们将拥有完整的图片我假设立方体的顶点和索引数据是正确的，因为您提到您之前已经绘制了立方体。

# .net - 实体框架是否返回整个数据集？

> ID：13113868
> 
> 赞同：0
> 
> 时间：2012-10-28T22:55:33.013
> 
> 标签：.net, entity-framework

使用：

*   .Net 4.0

*   实体框架 4.3

如果我以这种方式查询 DBSet：

```
public DbSet<Reciept> Reciepts { get; set; }
Reciepts.Where(rec =>rec.Number == reciept.Number &&
                        rec.Project.ID == reciept.Project.ID); 
```

是否会返回整个表，然后按我的查询过滤？

或者它是否以某种方式将其转换为 SQL（Linq2SQL？），并且只返回那些行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:06:44.240

它只会返回过滤后的值。

在调试时，您始终可以通过将鼠标光标指向查询变量来检查生成的查询：

```
var query = Reciepts.Where(rec =>rec.Number == reciept.Number && rec.Project.ID == reciept.Project.ID);
// put breakpoint here and stop mouse cursor at a 'query' variable 
```

SQL Server Profiler (http://msdn.microsoft.com/en-us/library/ms187929.aspx) 是另一个可以用来检查真正发送到数据库的好工具。我在使用 EF 开发时一直使用它。

# javascript - 有一个 Web 应用程序设计，但我不知道从哪里开始

> ID：13113873
> 
> 赞同：0
> 
> 时间：2012-10-28T22:56:22.223
> 
> 标签：javascript, ajax, json, heroku, playframework

我对 webApp 设计非常陌生，并且在学校参加了这项比赛，要求我在接下来的 2 天内提交一个功能齐全的应用程序。所以这是我计划实施的设计。假设有

```
A <-----> Application <-----> B 
```

A 只能通过应用程序与 B 交谈。A 有自己的数据库，其中存储一些详细信息，B 有自己的数据库，其中存储其个人信息。但是，A 和 B 中的某些数据字段可能相同。所以我需要部署这个应用程序来进行 A 和 B 之间的对话。我需要应用程序通过查询 B 和匹配相应的字段来帮助对 A 的数据库执行更新操作。通常从 B 为 A 获取数据并帮助更新 A 的数据库。

约束：这个应用程序需要使用Java Play平台开发，并且必须部署在heroku上。你能帮我开始吗？我已经从 Java Play 网站查看并部署了示例应用程序。我是 Json/javascript 和 Ajax 的新手（如果我应该使用的话）。那么有人可以向我指出一个示例代码或一些对学习者友好的教程吗？可能对从哪里开始等有帮助？任何帮助将不胜感激。顺便说一句，这不是家庭作业，我们可以使用我们想要的任何资源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:18:43.623

*我猜您对问题的上下文中的*A 和 B 是什么感到困惑。它们不是*应用程序*（您的描述和图表都没有暗示它们是）。它们是两个数据存储。所以你没有 3 个应用程序和两个数据库；你有*一个应用程序*（你必须写的），它可以连接到两个数据库。

当然，在您的问题范围之外，可能存在两个在 A 和 B 数据库中创建记录的应用程序；但是对于您的问题，您可以忽略它们。

# perl - 将代码从 Threads 重写为 AnyEvent

> ID：13113876
> 
> 赞同：1
> 
> 时间：2012-10-28T22:56:36.327
> 
> 标签：perl, anyevent

我写了一段代码：

* * *

```
use LWP::UserAgent;
use HTTP::Cookies;
use threads;
use threads::shared;
$| = 1;

$threads = 50; 
my @urls : shared = loadf('url.txt');   

my @thread_list = ();
$thread_list[$_] = threads->create(\&thread) for 0 .. $threads - 1;
$_->join for @thread_list;
thread();

sub thread
{
    my ($web, $ck) = browser();
    while(1)
    {
        my $url = shift @urls;
        if(!$url)
        {
            last;
        }
        $code = $web->get($url)->code;
        print "[+] $url - code: $code\n";
        if($code == 200)
        {
            open F, ">>200.txt";
            print F $url."\n";
            close F;
        }
        elsif($code == 301)
        {
            open F, ">>301.txt";
            print F $url."\n";
            close F;
        }
        else
        {
            open F, ">>else.txt";
            print F "$url code - $code\n";
            close F; 
        }
    }
}

sub loadf {
    open (F, "<".$_[0]) or erroropen($_[0]); 
    chomp(my @data = <F>);
    close F;
    return @data;
}

sub browser 
{
 my $web = new LWP::UserAgent;
 my $ck = new HTTP::Cookies;
    $web->cookie_jar($ck);
    $web->agent('Opera/9.80 (Windows 7; U; en) Presto/2.9.168 Version/11.50');
    $web->timeout(5);
    return $web, $ck;
} 
```

* * *

工作一段时间后，物理存储已满。你能帮我用 AnyEvent 重写它吗？我试过了，但我的代码不起作用。我读到它会帮助我保护一些记忆。非常感谢任何帮助者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T19:28:06.027

线程是邪恶的；考虑使用异步[AnyEvent::Net::Curl::Queued](https://metacpan.org/module/AnyEvent%3a%3aNet%3a%3aCurl%3a%3aQueued)：

```
#!/usr/bin/env perl
use common::sense;

use File::Slurp;
use YADA;

my @url = read_file('url.txt');
YADA->new(50)->append(
    \@url => {
        retry   => 0,
        timeout => 5,
        opts    => {
            useragent   => 'Opera/9.80 (Windows 7; U; en) Presto/2.9.168 Version/11.50',
            #verbose     => 1,
        },
    } => sub {
        my $self = shift;

        my $code = $self->getinfo('response_code');
        my $url = $self->final_url;

        say "[+] $url - code: $code";
        given ($code) {
            when (200) {
                open my $fh, '>>', '200.txt';
                say {$fh} $url;
                close $fh;
            } when (301) {
                open my $fh, '>>', '301.txt';
                say {$fh} $url;
                close $fh;
            } default {
                open my $fh, '>>', 'else.txt';
                say {$fh} "$url code - $code";
                close $fh;
            }
        }
    },
)->wait; 
```

# java - Jaxb 解组 fixml 对象，但所有字段均为空

> ID：13113882
> 
> 赞同：5
> 
> 时间：2012-10-28T22:57:46.773
> 
> 标签：java, xml, xml-parsing, jaxb

我有一个 FIXML 格式的小型 XML 文档。我正在使用 jaxb 解组它们。

**问题**

该过程完成没有错误，但创建的对象完全为空。每个字段都是空的。作为列表的字段（如数量）在其中具有正确数量的对象。但是这些对象的字段也是空的。

**设置**

我从[这里](http://www.fixprotocol.org/specifications/FIX.5.0SP2#FIXML_Schema)下载了 FIXML 模式， 并使用 xjc 和 maven 插件创建了类。它们都在包 org.fixprotocol.fixml_5_0_sp2 中。我有一个文件中的示例 xml

**FIXML.XML**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<FIXML>
<Batch>
    <PosRpt>
    <Pty ID="GS" R="22"/>
    <Pty ID="01" R="5"/>
    <Pty ID="6U8" R="28">
        <Sub ID="2" Typ="21"/>
    </Pty>
    <Pty ID="GS" R="22"/>
    <Pty ID="6U2" R="2"/>
    <Instrmt ID="GHPKRW" SecTyp="FWD" MMY="20121018" MatDt="2012-10-18" Mult="1" Exch="GS" PxQteCcy="KJS" FnlSettlCcy="GBP" Fctr="0.192233298" SettlMeth="G" ValMeth="FWDC2" UOM="Ccy" UOMCCy="USD">
        <Evnt EventTyp="121" Dt="2013-10-17"/>
        <Evnt EventTyp="13" Dt="2013-10-17"/>
    </Instrmt>
    <Qty Long="0.000" Short="22000000.000" Typ="PNTN"/>
    <Qty Long="0.000" Short="22000000.000" Typ="FIN"/>
    <Qty Typ="DLV" Long="0.00" Short="0.00" Net="0.0"/>
    <Amt Typ="FMTM" Amt="32.332" Ccy="USD"/>
    <Amt Typ="CASH" Amt="1" Rsn="3" Ccy="USD"/>
    <Amt Typ="IMTM" Amt="329.19" Ccy="USD"/>
    <Amt Typ="DLV" Amt="0.00" Ccy="USD"/>
    <Amt Typ="BANK" Amt="432.23" Ccy="USD"/>
</PosRpt> 
```

然后我用自定义事件处理程序调用解组器，它只是在解析错误时引发异常。解析完成，所以我知道没有生成错误。我也按照[这里的建议处理命名空间](https://stackoverflow.com/a/2148541/753707)

```
// sort out the file
String xmlFile = "C:\\FIXML.XML.xml";
System.out.println("Loading XML File..." + xmlFile);
InputStream input = new FileInputStream(xmlFile);
InputSource is = new InputSource(input);

// create jaxb context
JAXBContext jc = JAXBContext.newInstance("org.fixprotocol.fixml_5_0_sp2");
Unmarshaller unmarshaller = jc.createUnmarshaller();

// add event handler so jacB will fail on an error
CustomEventHandler validationEventHandler = new CustomEventHandler();
unmarshaller.setEventHandler(validationEventHandler);

// set the namespace
NamespaceFilter inFilter = new NamespaceFilter("http://www.fixprotocol.org/FIXML-5-0-SP2", true);

inFilter.setParent(SAXParserFactory.newInstance().newSAXParser().getXMLReader());
SAXSource source = new SAXSource(inFilter, is);

// GO!
JAXBElement<FIXML> fixml = unmarshaller.unmarshal(source, FIXML.class); 
```

fixml 对象已创建。在上面的示例中，Amt 数组将有五个元素，它们与文件中的 amt 数量相匹配。但是像 ccy 这样的所有字段都是空的。我在 xjc 创建的类中放置了断点，并且没有调用任何设置器。

*所以看起来 jaxb 正在解组并创建所有正确的对象，但它从不调用设置器？*

我完全被这件事难住了。我已经看到一些帖子建议确保由 xjc 生成的 package.info 文件在包中，并且我确保它在那里。IDE 中没有关于生成代码的警告。

非常感谢任何帮助。

**更新** 在开始解组之前，我尝试在解组器上设置模式文件。

```
Schema schema = sf.newSchema(f);
unmarshaller.setSchema(schema); 
```

我不确定要使用哪个模式，所以我在循环中依次尝试每个文件。结果是它们都没有使它起作用。它们会导致错误发现以元素“PosRpt”开头的无效内容。

这是令人惊讶的。我现在认为问题与*命名*空间有关。

**更新 2** 仍然没有进展。我已经尝试过 JAXB 2.0 和 2.2。现在查看不同的 maven 插件来调用 xjc。但我不认为是这样。

**更新 3** 现在已经阅读了 fixml，我将其编组回一个单独的文件。

```
// GO!
JAXBElement<FIXML> fixml = unmarshaller.unmarshal(source, FIXML.class);

//Write     
Marshaller marshaller = jc.createMarshaller();
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
marshaller.marshal(fixml, output); 
```

结果是：

**输入文件.xml**

```
<FIXML>
    <Batch>
    <PosRpt RptID="5952323" ReqID="434242" SetSesID="EOD" MtchStat="2" PriSetPx="11.284328" SetPx="11.4432" SetPxTyp="1" SettlCcy="EUR" ReqTyp="1" MsgEvtSrc="REG" BizDt="2012-11-17" SettlDt="2018-11-20">
        <Pty ID="CC" R="22"/>
            .... 
```

**输出.xml**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <FIXML xmlns="http://www.fixprotocol.org/FIXML-5-0-SP2">
        <Batch>
            <PosRpt>
                <Pty/>
                <Pty/>
                <Pty/> 
```

所以文件的结构是正确的，但它是空的。有一个明确的命名空间，所以我尝试将该命名空间添加到测试输入文件中，但这没有任何区别。接下来，我将尝试在封送它之前填充 fixml 对象。

**更新 4**

不是我正在创建一个简单的 FIXML 类并对其进行编组。

**simple_fxixml_out.xml**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<FIXML xmlns="http://www.fixprotocol.org/FIXML-5-0-SP2" cv="DDDD">
    <Batch ID="dfddd">
        <PositionReportMessageT Ccy="CCC"/>
    </Batch>
</FIXML> 
```

当我尝试重新阅读时，我得到：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<FIXML xmlns="http://www.fixprotocol.org/FIXML-5-0-SP2">
    <Batch/> 
```

我注意到的事情是：

1.  生成的命名空间是一样的
2.  我创建了 PositionReportMessageT 而不是 PosRpt 标签
3.  甚至 FIXML 上的 DDDD 属性也能在过渡中幸存下来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T12:46:23.973

我认为你需要做

`saxParserFactory.setNamespaceAware(true)`

（我认为您不需要 namespaceFilter）

顺便说一下，该类`javax.xml.bind.JAXB`包含在尝试编组/解组时非常有用的便捷方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-13T13:17:33.237

发现使用以下 FIXML 库更容易（可以使用 maven 加载） [https://javalibs.com/artifact/com.github.xgp/fixml](https://javalibs.com/artifact/com.github.xgp/fixml)

然后使用 JAXB 进行绑定和遍历（以下是我自己的 PoC 简单代码）：

```
 JAXBContext jaxbContext = JAXBContext.newInstance(FIXML.class);
    Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();

    FIXML fixml = (FIXML) unmarshaller.unmarshal(new StringReader(fixmlOrder));

    ExecutionReportMessageT er = (ExecutionReportMessageT) fixml.getMessage().getValue();
    if(er.getTrdDt() != null){
        System.out.println(er.getTrdDt().toGregorianCalendar().getTime());
    }
    System.out.println(ToStringBuilder.reflectionToString(er,ToStringStyle.MULTI_LINE_STYLE)); 
```

# c - POSIX 线程和信号掩码

> ID：13113885
> 
> 赞同：1
> 
> 时间：2012-10-28T22:58:00.830
> 
> 标签：c, multithreading, signals, posix, mask

有没有办法从另一个线程更改线程的信号掩码？我应该编写一个不使用互斥锁、信号量和条件变量，只使用信号的多线程 C 应用程序。

所以它看起来像这样：主线程将 SIGUSR1 发送到它的进程，并且 2 个线程之一（不包括主线程）将响应信号并阻止 SIGUSR1 来自 sigmask 和睡眠。然后主线程再次发送 SIGUSR1，其他线程会响应，从它的 sigmask 中阻塞 SIGUSR1，从其他线程的 sigmask 中解除阻塞 SIGUSR1，所以它会再次响应 SIGUSR1。

因此，基本上每当主线程发送 SIGUSR1 时，其他两个线程就会相互交换。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:11:18.983

You are probably looking for [`pthread_sigqueue(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/pthread_sigqueue.3.html) called from the main thread, and [`sigwait(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/sigwait.3.html) or [`sigtimedwait(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/sigwaitinfo.2.html) in the child thread(s).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T17:11:40.720

线程只能修改自己的信号掩码（通过`pthread_sigmask()`）。如果你想修改另一个线程的信号掩码，你必须自己编写代码让另一个线程去做。

信号被发送到这里的进程，所以`kill()`或者`sigqueue()`是要使用的函数。后者将避免将多个信号合并在一起，这可能发生在`kill()`.

# javascript - 如何将 Google Docs 集成到您的 Node.js 网络应用程序中？

> ID：13113889
> 
> 赞同：0
> 
> 时间：2012-10-28T22:58:33.370
> 
> 标签：javascript, node.js

我有一个 Web 应用程序，该应用程序当前在我的 Amazon S3 存储桶中为我的站点上的用户存储文档。我希望用户能够使用 Google Docs 从我的 S3 存储桶中打开和编辑他们的文档。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:08:44.813

I don't think you will be able to open your documents hosted on S3 from Google Docs, unless you get your users to save them first.

I have a crazy idea that could work:

1.  Share the documents with your users (either by making them public or just sharing the link).
2.  Use Google Drive to sync those documents with some server.
3.  Periodically upload the documents to s3.

# android-emulator - AVD 加载失败 ~ 解析属性失败 ~ Mac OSX

> ID：13113891
> 
> 赞同：2
> 
> 时间：2012-10-28T22:58:44.447
> 
> 标签：android-emulator, avd

我先说一声，请见谅。我是 android 开发的新手，对编程也很陌生。同样在 Mac 上。你将不得不说话......真的......慢。

我无法加载 AVD。我已经从 Eclipse (Juno) 和 Android SDK Manager (20.0.3) 尝试过。多次失败。

每次都收到同样的错误，

> “无法解析来自 User/myname/.android/avd/nameIGaveEmulator/config.ini 的属性。”

编辑：我试图通过检查文件夹并将它们移动到同一个文件夹中来自己解决路径问题，然后在 Eclipse 首选项中重置路径，但这不起作用，所以我删除了除 zip 文件之外的所有内容，解压缩并重新开始整个安装。然而，当我打开 SDK Manager 并尝试下载工具和平台时，我收到了以下信息。我忘记了我在第一次安装时收到了它。这与问题有关吗？

> 准备安装档案
> 下载 Android SDK 平台工具，修订版 14
> 安装 Android SDK 平台工具，修订版 14
> **停止 ADB 服务器失败（代码 -1）。**
> 已安装 Android SDK 平台工具，修订版 14
> 停止 ADB 服务器成功。
> **启动 ADB 服务器失败（代码 255）。**
> 完毕。已安装 1 个软件包。

旁注：

1.  当我打开 Eclipse 和 SDK 管理器时，我看不到任何地方可以检查我是否是管理员。

2.  如果需要“更改”路径，这究竟意味着什么，我该如何去做？是否只是将文件夹和文件移动到“正确”位置然后尝试再次加载 AVD 的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T08:17:23.587

使用命令行，导航到您的 android SDK 中的 /tools 文件夹，然后使用以下命令：

$ ./android avd

这将启动 AVD 管理器。

# vb.net - Visual Basic 与类共享变量？

> ID：13113893
> 
> 赞同：1
> 
> 时间：2012-10-28T22:59:10.287
> 
> 标签：vb.net

请帮助我了解如何使用类来共享变量。我有 3 个表单和一个类来存储一些变量。在 form1 中，我正在调用 myclass 并设置变量。现在我显示 form2 并在 form2 内部调用 form3

是否可以从我从第一种形式发送的类中获取变量？Myclass 代码如下所示：

```
 Private _var As String
Public Sub setvar(ByVal var As String)
    _var = pvar
End Sub

Public Function getvar() As String
    Return _var
End Function 
```

从表格1：

```
 Public class1 As myclass
      class1 = New myclass
       class1.setvar("test") 
```

现在我想调用 class1.getvar 并希望它返回我以第一种形式输入的值。是否可以 ？如果是，请帮助我如何？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:22:59.523

因为您在“class1”变量定义中使用了“Public”访问修饰符，所以您应该能够从可以访问该 Form1 实例的任何地方访问它作为 Form1 上的一个字段。

```
Dim myString as String = form1.class1.getvar() 
```

不过，不这样做可能会更整洁。

选项
1 如果是我，我更愿意以第一种形式创建 MyClass 的实例，然后将该实例传递给其他形式（可能通过构造函数）。

```
Public Class Form1

   Private _instance As MyType

   Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
      _instance = New MyType

      Dim newForm As New Form2(_instance)
   End Sub 
```

End Class 修改 Form2 和 Form3 的 New 方法，接受 MyClass 类型的参数：

```
Public Class Form2

   Private _instance As MyType

   Sub New(instance As MyType)
      _instance = instance
   End Sub

End Class 
```

然后，当您创建新表单并将其存储在一个私有成员中时，您将传递变量，您可以在第二个表单的代码中的任何位置访问该成员。

选项2 或者，您可以将class1
的定义放入模块中，然后您可以从项目中的任何位置访问它。

# android - Nexus 7 USB 主机 - 无法枚举设备

> ID：13113897
> 
> 赞同：1
> 
> 时间：2012-10-28T22:59:20.590
> 
> 标签：android, usb

我最近买了一个 Nexus 7 用于 USB 开发。我想使用新的 Android 操作系统提供的 USB 主机功能。我正在关注链接上的 USB 主机教程：http: [//developer.android.com/guide/topics/connectivity/usb/host.html](http://developer.android.com/guide/topics/connectivity/usb/host.html)。

我的程序很简单，下面是代码的相关部分：

```
private UsbManager manager;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Log.i(TAG, "in onCreate()");
    manager = (UsbManager) getSystemService(Context.USB_SERVICE);
    if(manager==null) {
        Log.i(TAG, "USB Manager is NULL");
    }
    else {
        Log.i(TAG, "USB Manager = " + manager);
    }
}

public void enumerateUSBDevices() {
    HashMap<String, UsbDevice> deviceList = manager.getDeviceList();
    Collection<UsbDevice> deviceCollection = deviceList.values();
    Iterator<UsbDevice> deviceIterator = deviceCollection.iterator();
    Log.i(TAG, "Number of connected USB Devices = " + deviceCollection.size());
    while(deviceIterator.hasNext()){
        UsbDevice device = deviceIterator.next();
        Log.i(TAG, device.getDeviceName());
    }
} 
```

当调用 enumerateUSBDevices 函数时，它报告连接的 USB 设备的数量 = 0。我正在使用 USB OTG 电缆，并且我知道 Nexus 7 正在为连接的 USB 设备供电，因为我插入了 USB 鼠标，并且它工作正常。我还插入了另一部 Android 手机，并确认 Nexus 7 正在为该设备供电。但是，在这两种情况下，Android 程序都说没有连接 USB 设备。我不确定我的代码出了什么问题。在我的 Android 清单中，我有以下行：

```
 <uses-feature android:name="android.hardware.usb.host" /> 
```

我的清单没有与任何 USB 设备关联的任何意图过滤器。根据阅读教程我的理解是，只有当您希望在应用程序运行后连接 USB 设备时通知应用程序时，意图过滤器才需要在清单中？

任何人都可以阐明我可能做错了什么吗？我需要root我的设备吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T02:48:50.860

It turns out, that since the Android OS takes over the mouse. I plugged in a different USB device and the code worked fine.

# image - 可缩放图像，如谷歌地图

> ID：13113899
> 
> 赞同：1
> 
> 时间：2012-10-28T22:59:30.440
> 
> 标签：image, web, maps

我想创建一个网站，从远处看有一棵树的大图像。当您放大时，它会显示更明确的分支图像，然后进一步放大单词将显示在分支中。您可以滚动图像以查看所有其他单词。所以它就像谷歌地图，但我自己的形象。

我曾尝试寻找示例等，但只能找到地图。我相信我必须为不同的级别制作不同的瓷砖。

是否有任何示例或教程可以帮助我，或者是否有我应该寻找的特定名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T02:09:23.047

最简单的方法是使用名为[MapTiler](http://www.maptiler.org/)的工具。

它是免费的，您只需遵循一个非常简单的向导，该向导隐藏了该过程的所有复杂性。

无论如何，我已经发布了一个关于这个主题的教程，你可以[在这里查看](http://build-failed.blogspot.pt/2012/11/zoomable-image-with-leaflet.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T21:29:36.970

我在这里创建了一个基于 Java 的 Google Map Tiler 工具：

[https://github.com/devldevelopment/googlemaptiler](https://github.com/devldevelopment/googlemaptiler)

这将帮助您按照 Map Tiler 剪切图像，但它是免费的。github 自述文件中提供了一个 Javascript 示例。

谢谢

# objective-c - 对类和对象 iVar 感到困惑

> ID：13113905
> 
> 赞同：0
> 
> 时间：2012-10-28T23:00:39.873
> 
> 标签：objective-c, ios, xcode

> **可能重复：**
> [@property 和 @synthesize](https://stackoverflow.com/questions/12730244/property-and-synthesize)

当一个类有一个属性但没有变量时，这意味着什么？相反，我看到的是：

```
@interface myClass : someClass

    @property (nonatomic,retain) UIButton* button;

@end 
```

并在实施中：

```
@synthesize button = _button; 
```

那么是谁`_button`呢？

像这样声明时会做什么`@synthesize`？
这是否意味着该类现在有一个名为 的私有变量`_button`？我可以将`_button`其视为班级的私有变量吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:03:15.683

> 这是否意味着该类现在有一个名为 _button 的私有变量？我可以将 _button 视为类的私有变量吗？

是的，这是 Clang 编译器的一个新特性——它会自动为属性创建实例变量，并且 ivar 具有`@private`访问级别，并且`_namwOfProperty`如果属性的名称是`nameOfProperty`.

# javascript - 在使用javascript的文本框中使用FF（或IE）自动完成时如何禁用keydown处理？

> ID：13113907
> 
> 赞同：0
> 
> 时间：2012-10-28T23:00:50.717
> 
> 标签：javascript, firefox, autocomplete, onkeydown

为了控制 Enter 键影响的字段，我编写了以下在 keydown 事件上调用的 javascript：

```
function editorEnter(e)
{
    var key;
    if (window.event) key = window.event.keyCode;     //IE
    else key = e.which;                               //firefox
    if (key == 13) addEditorRow('EditorTable');
} 
```

以下是它在文本字段上下文中的使用方式：

```
<input type="text" name="EditorSurname" class="EditorSurnameText" 
 value="" onkeydown="editorEnter(event);" onkeyup="EnableSave();"/> 
```

问题是在启用了自动完成功能的 FireFox 中，如果我从自动完成下拉列表中选择一个值并按 Enter，它不会执行自动完成并将该行添加到表中。选择自动完成时有没有办法禁用输入键功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T02:37:31.397

看看这个相关的问题：[Trap the enter key, but not when choose the browser's autocompleteSuggestion](https://stackoverflow.com/questions/1648993/trap-the-enter-key-but-not-when-choosing-the-browsers-autocomplete-suggestion)

# sql-server - 而不是使用合并触发视图不应用表默认值

> ID：13113909
> 
> 赞同：0
> 
> 时间：2012-10-28T23:01:09.130
> 
> 标签：sql-server, triggers, updatable-views, merge-statement

我有一个可更新的视图，它使用一个代替触发器来进行插入/更新。该触发器使用合并。我发现 Merge 语句没有应用来自底层物理表的默认约束，尽管合并文档建议它应该这样做。

以下示例演示：

```
create table tblTest
(
    id uniqueidentifier not null primary key default newid(),
    forename varchar(20),
    surname varchar(20) not null default 'xxyyzz'
)
go

create view vwTest as select * from tblTest
go

create Trigger vwTest_trigger_insteadof_insert_update On vwTest
Instead of Insert, Update As
begin
set nocount on
Merge tblTest t

Using
    inserted i On (t.id = i.id)

When Matched Then
    Update
        Set
        t.forename = i.forename,
        t.surname = i.surname

When Not Matched By Target Then
    Insert
    (
        id,
        forename,
        surname

    )
    Values
    (
        i.id,
        i.forename,
        i.surname

    )
OUTPUT $action, Inserted.*, Deleted.*
;
end
go

--Inserts to physical table work as expected
insert into tblTest (id) values (newid())
insert into tblTest (surname) values ('smith')

--Inserts into updateable view fail as no defaults are set
--from the underlying physical table
insert into vwTest (id) values (newid())
insert into vwTest (surname) values ('jones') 
```

我看到有人在[使用 INSTEAD OF INSERT 触发器中的默认值中](https://stackoverflow.com/questions/2200731/using-default-values-in-an-instead-of-insert-trigger)有类似的东西，并通过将插入的行复制到临时表中然后更改临时表以添加物理表中的默认约束来解决它。我不确定我能否容忍这些额外步骤的性能问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T03:53:06.897

很简单。为了使用默认值，您要么必须使用 DEFAULT 关键字，要么不将其包含在插入中。即使是 NULL 值也很重要。在这种情况下，您要在触发器的插入中指定值。如果你要改变它的那一部分

```
When Not Matched By Target Then
Insert
(
    id,
    forename,
    surname

)
Values
(
    i.id,
    i.forename,
    i.surname

) 
```

至

```
When Not Matched By Target Then
Insert
(
    id,
    forename,
    surname

)
Values
(
    i.id,
    i.forename,
    DEFAULT

) 
```

您会看到 surname 的默认值开始出现。不幸的是，这对您尝试做的事情并没有太大帮助。我能想到的最好的解决方案（而且不是很好）是使用 isnulls 将默认值放入触发器中。

```
When Not Matched By Target Then
Insert
(
    id,
    forename,
    surname

)
Values
(
    ISNULL(i.id,newid()),
    i.forename,
    ISNULL(i.surname,'xxyyzz')

) 
```

我意识到从维护的角度来看这不是很好，但它会起作用。[如果您有兴趣，我在此处](http://sqlstudies.com/2012/08/20/23/)发布了关于 DEFAULT 关键字的帖子，其中包含相当多的详细信息。

# javascript - 移除 Chrome 的“翻译”DOM 属性

> ID：13113914
> 
> 赞同：1
> 
> 时间：2012-10-28T23:02:50.933
> 
> 标签：javascript, html, magento, google-chrome, xpath

我正在使用一些遗留代码，其中原始开发人员大量使用生成具有名为的非标准属性的 HTML DOM 节点`translate`

```
<span translate="[{&quot;shown&quot;:&quot;My Account&quot;,&quot;translated&quot;:&quot;My Account&quot;,&quot;original&quot;:&quot;My Account&quot;,&quot;location&quot;:&quot;Text&quot;,&quot;scope&quot;:&quot;Mage_Customer&quot;}]">My Account</span> 
```

然后使用 javascript 代码遍历/搜索这些节点，如下所示。

```
if (!$(target).match('*[translate]')) {
    target = target.up('*[translate]');
} 
```

我要解决的问题是，Google Chrome 似乎**自动**为文档中的每个 DOM 节点添加了一个`translate`属性，并且该 DOM 节点的值是 boolean `true`。您可以通过从 Chrome 的 javascript 控制台运行以下 Javascript 来查看这一点

```
> document.getElementsByTagName('p')[0].translate
true
> 
```

有没有办法告诉 Chrome**不要**填充这些属性？他们的存在对遗留代码造成了严重破坏。PrototypeJS`match`和`up`节点将这些布尔对象属性视为匹配项，而我正在处理的代码专门寻找具有名为 translate 的属性的 DOM 节点。我想为我的问题找到一个解决方案，它不涉及重写旧的 Javascript 以使用`hasAttribute`.

我尝试（作为一个疯狂的猜测）添加[本文](http://blog.pheromonic.com/web-development/the-translate-attribute/)`meta`中提到的属性，

```
<meta name=”google” value=”notranslate”&gt;
<meta name=”google” content=”notranslate”&gt; 
```

但是页面中的节点仍然有一个布尔`true`翻译属性。

（如果重要的话，这是我在这里谈论的 Magento 的内联翻译系统）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T02:00:56.487

到目前为止，我能想到的最好的方法是遍历页面中的每个 DOM 元素，定义一个 getter 来检查属性是否存在。（`Object.__defineGetter__`保护子句确保在不支持现代 Javascript 的浏览器中没有错误）

```
if(Object.__defineGetter__)
{
    var hasTranslateAttribute = function(){
        return $(this).hasAttribute("translate");
    };
    document.observe("dom:loaded", function() {
        $$('*').each(function(theElement){
             theElement.__defineGetter__("translate", hasTranslateAttribute);
        });
    });
} 
```

我尝试定义一个开始`Object.prototype`and `Element.prototype`，但似乎浏览器的本机`translate`定义在链的更高层，因此您需要在每个元素的基础上重新定义事物。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T06:47:21.403

`translate`用类似的属性替换非标准属性`data-translate`，这几乎可以保证在 HTML 规范和浏览器中是未定义的并且保持未定义。这些[`data-*`属性](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)是为了防止此类问题而发明的，它们也可以用来修复它们。

# jquery - 在类 jquery 中指定类

> ID：13113915
> 
> 赞同：0
> 
> 时间：2012-10-28T23:02:54.337
> 
> 标签：jquery, jquery-ui

我想在悬停时切换帖子列表中的隐藏元素。与 twitter 类似，当您将鼠标悬停在帖子上时，链接菜单将变得不隐藏。

每行帖子都有一个类“帖子”。这是我当前的代码：

```
$("div.post").mouseover(function() {
 $(this).css("background-color", "#f9f9f9");
});
$("div.post").mouseleave(function() {
 $(this).css("background-color", "white");
}); 
```

每行都有一个跨度类，称为“菜单”。

如何为悬停的帖子打开和关闭跨度“菜单”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:08:41.360

对原始代码的简单链式修改：

```
$("div.post").mouseover(function() {
       $(this).css("background-color", "#f9f9f9").find('span.menu').stop(true,true).slideUp();
}).mouseleave(function() {
       $(this).css("background-color", "white").find('span.menu').stop(true,true).slideDown();
}); 
```

可以将幻灯片效果更改`toggle()`为两者，并且将隐藏/显示而没有效果。这`stop()`将防止跳跃，以便用鼠标快速进出

# python - 编辑; tkinter 体重转换器

> ID：13113918
> 
> 赞同：0
> 
> 时间：2012-10-28T23:03:36.983
> 
> 标签：python, tkinter

如果我输入一个整数，我会变得无效。如果它不是数字 0 或更大，我希望它无效。非常感谢任何帮助！

```
from Tkinter import *
import tkMessageBox

from Tkinter import *
import tkMessageBox

class MyApp(object):
   def __init__(self):
       self.root = Tk()
       self.root.wm_title("Question 7")
       self.label = Label(self.root, text="Enter weight in pounds",
                       font=('Calibri', 50))
       self.label.pack(padx=20,pady=10)
       self.labeltext = StringVar()
       self.labeltext.set("")
       Label(self.root, textvariable=self.labeltext).pack()
       self.entrytext = StringVar()
       Entry(self.root, textvariable=self.entrytext).pack()
       self.entrytext.trace('w', self.entry_changed)

       self.root.mainloop()

   def entry_changed(self, a, b, c):
        s = self.entrytext.get()
       try:
        a=int(s)*4.3
        self.labeltext.set(a) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:18:37.337

问题是第一个布尔条件。条件评估为真

```
>>> 'Not A Number' >= 0
True 
```

但是，当它然后将其转换为整数时，它会失败：

```
>>> int('Not A Number')
Traceback (most recent call last):
  File "<pyshell#5>", line 1, in <module>
    int('Not A Number')
ValueError: invalid literal for int() with base 10: 'Not A Number' 
```

试试这个，这样你就可以正确地捕获和管理正在引起的异常：

```
def entry_changed(self, a, b, c):
    s = self.entrytext.get()
    try:
        a=int(s)*4.3
        self.labeltext.set(a)
    except:
        if s=="":
            self.labeltext.set("")
        else:
            self.labeltext.set("invalid") 
```

请注意，当用户输入浮点数时`eg. 4.3`，它也会产生异常，因此您可能也想更正它。

# java - 访问 EJB 中的登录用户？

> ID：13113921
> 
> 赞同：0
> 
> 时间：2012-10-28T23:04:01.953
> 
> 标签：java, weblogic, ejb-3.0

在 Java 应用程序中，我需要获取 EJB3 中的登录用户详细信息。

但是 sessionContext.getCallerPrincipal().getName() 返回值匿名。

我尝试使用 JAAS (weblogic.security.auth.login.UsernamePasswordLoginModule)，但仍然是 Subject, Principal 值仅在最初可用，但没有转移到业务层。并具有匿名值。

我的环境是 Java / JSF / EJB3 / Weblogic 11g。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:34:47.723

我多次遇到这个问题。我将用户放在一个 ThreadLocal 上并在业务层访问它。要么将用户作为方法参数传递。

# java - 按下时键侦听器不起作用

> ID：13113922
> 
> 赞同：0
> 
> 时间：2012-10-28T23:04:03.350
> 
> 标签：java, swing, graphics, keylistener

试图让我的代码在屏幕上移动玩家（船舶）时遇到了很多麻烦。我可以让行星在屏幕和玩家飞船上绘制，但我不知道如何实现 keyListener 以至少打印出一些东西。预先感谢您的所有帮助！

```
 import javax.swing.JFrame;
    import javax.swing.JPanel;
    import java.awt.Canvas;
    import java.awt.Color;
    import java.awt.Dimension;
    import java.awt.Graphics;
    import java.awt.Point;
    import java.awt.Toolkit;
    import java.awt.event.KeyAdapter;
    import java.awt.event.KeyEvent;
    import java.awt.event.KeyListener;

    public class MapPanel extends JPanel {
public static final int WIDTH = 25;
 public static final int HEIGHT = 20;
 int zone = 0;
 private int xValue;
 private int yValue;
 private Color color;
 public Planet[][] planetGrid = new Planet[WIDTH][HEIGHT];
 static Player currPlayer = new Player("h");
 static Universe universe = new Universe(currPlayer);

 /**
 * Create the panel.
 */
 public MapPanel(Universe univ, Player p) {
    this.universe = univ;
    currPlayer = p;
    int i = 0;
    this.setSize(new Dimension(450,450));
    setVisible( true );
    //this.addKeyListener(new KeyController());
     KeyController kc = new KeyController();
     this.addKeyListener(kc);
    repaint();

 }

 /**
  * Draw method to draw the playing field
  * @param g Graphics object
  * @param tileDimension dimension of the tile
  */
 public void draw(Graphics g)
 {
 universe.draw(g);

    //    KeyController key = new KeyController();
 }
 public void paintComponent(Graphics g) {
     super.paintComponent(g);
     draw(g);
 }
 public static void main(String[] args)
 {
     MapPanel mp = new MapPanel(universe, currPlayer);
     JFrame f = new JFrame();
     f.add(mp);
     f.setSize(new Dimension(450,450));
     f.setVisible(true);
     f.setFocusable(true);

 }
 private class KeyController implements KeyListener {
     public KeyController()
     {
         System.out.println("ghgh");
         setFocusable(true);
        // addKeyListener(this);
     }
        @Override
        public void keyPressed(final KeyEvent key) {
            System.out.println("fgfgf");
            if (currPlayer != null) {

                int oldX = currPlayer.getPosition().x;
                int oldY = currPlayer.getPosition().y;

                switch (key.getKeyCode()) {
                    case KeyEvent.VK_RIGHT:
                      currPlayer.setPosition(new Point(oldX+1, oldY)); //move right
                      System.out.println("RIGHT");
                        break;
                    case KeyEvent.VK_LEFT:
                          currPlayer.setPosition(new Point(oldX-1, oldY));         //move left
                        break;
                    case KeyEvent.VK_DOWN:
                          currPlayer.setPosition(new Point(oldX, oldY+1));         //move down
                        break;
                    case KeyEvent.VK_UP:
                          currPlayer.setPosition(new Point(oldX, oldY-1));         //move up
                        break;
                }

            }
            repaint();
        }
        @Override
        public void keyReleased(KeyEvent e) {
            System.out.println("ggg");
        }
        @Override
        public void keyTyped(KeyEvent e) {
            System.out.println("typeeeddd");
        }
    }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:06:58.413

`KeyListener`不是实现您的结果的最合适的方法。

最好使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)API。

除了简化代码之外，它还可以让您更好地控制何时触发按键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T07:17:33.510

在这里，我设计了一个与您类似的应用程序，您可以在其中使用箭头键，然后在移动的船上投掷炸弹（这是我几年前的项目:)），设计一个运行的主要方法，希望这会有所帮助：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

/**
* This panel implements a simple arcade game in which the user tries to blow
* up a "submarine" (a black oval) by dropping "depth charges" (a red disk) from
* a "boat" (a blue roundrect).  The user moves the boat with the left- and
* right-arrow keys and drops the depth charge with the down-arrow key.
* The sub moves left and right erratically along the bottom of the panel.
*/
public class SubKillerPanel extends JPanel {

private Timer timer;        // Timer that drives the animation.

private int width, height;  // The size of the panel -- the values are set
                           //    the first time the paintComponent() method
                           //    is called.  This class is not designed to
                           //    handle changes in size; once the width and
                           //    height have been set, they are not changed.
                           //    Note that width and height cannot be set
                           //    in the constructor because the width and
                           //    height of the panel have not been set at
                           //    the time that the constructor is called.

private Boat boat;          // The boat, bomb, and sub objects are defined
private Bomb bomb;          //    by nested classes Boat, Bomb, and Submarine,
private Submarine sub;      //    which are defined later in this class.
                           //    Note that the objects are created in the
                           //    paintComponent() method, after the width
                           //    and height of the panel are known.

 /**
* The constructor sets the background color of the panel, creates the
* timer, and adds a KeyListener, FocusListener, and MouseListener to the
* panel.  These listeners, as well as the ActionListener for the timer
* are defined by anonymous inner classes.  The timer will run only
* when the panel has the input focus.
*/
public SubKillerPanel() {

  setBackground(Color.GREEN);

  ActionListener action = new ActionListener() {
           // Defines the action taken each time the timer fires.
     public void actionPerformed(ActionEvent evt) {
        if (boat != null) {
           boat.updateForNewFrame();
           bomb.updateForNewFrame();
           sub.updateForNewFrame();
        }
        repaint();
     }
  };
  timer = new Timer( 30, action );  // Fires every 30 milliseconds.

  addMouseListener( new MouseAdapter() {
          // The mouse listener simply requests focus when the user
          // clicks the panel.
     public void mousePressed(MouseEvent evt) {
        requestFocus();
     }
  } );

  addFocusListener( new FocusListener() {
         // The focus listener starts the timer when the panel gains
         // the input focus and stops the timer when the panel loses
         // the focus.  It also calls repaint() when these events occur.
     public void focusGained(FocusEvent evt) {
        timer.start();
        repaint();
     }
     public void focusLost(FocusEvent evt) {
        timer.stop();
        repaint();
     }
  } );

  addKeyListener( new KeyAdapter() {
         // The key listener responds to keyPressed events on the panel. Only
         // the left-, right-, and down-arrow keys have any effect.  The left- and
         // right-arrow keys move the boat while down-arrow releases the bomb.
     public void keyPressed(KeyEvent evt) {
        int code = evt.getKeyCode();  // Which key was pressed?
        if (code == KeyEvent.VK_LEFT) {
             // Move the boat left.  (If this moves the boat out of the frame, its
             // position will be adjusted in the boat.updateForNewFrame() method.)
           boat.centerX -= 15;
        }
        else if (code == KeyEvent.VK_RIGHT) {
             // Move the boat right.  (If this moves boat out of the frame, its
             // position will be adjusted in the boat.updateForNewFrame() method.)
           boat.centerX += 15;
        }
        else if (code == KeyEvent.VK_DOWN) {
              // Start the bomb falling, if it is not already falling.
           if ( bomb.isFalling == false )
              bomb.isFalling = true;
        }
     }
  } );

 } // end constructor

/**
* The paintComponent() method draws the current state of the game.  It
* draws a gray or cyan border around the panel to indicate whether or not
* the panel has the input focus.  It draws the boat, sub, and bomb by
* calling their respective draw() methods.
*/
public void paintComponent(Graphics g) {

  super.paintComponent(g);  // Fill panel with background color, green.

  if (boat == null) {
        // The first time that paintComponent is called, it assigns
        // values to the instance variables.
     width = getWidth();
     height = getHeight();
     boat = new Boat();
     sub = new Submarine();
     bomb = new Bomb();
  }

  if (hasFocus())
     g.setColor(Color.CYAN);
  else {
     g.setColor(Color.RED);
     g.drawString("CLICK TO ACTIVATE", 20, 30);
     g.setColor(Color.GRAY);
  }
  g.drawRect(0,0,width-1,height-1);  // Draw a 3-pixel border.
  g.drawRect(1,1,width-3,height-3);
  g.drawRect(2,2,width-5,height-5);

  boat.draw(g);
  sub.draw(g);
  bomb.draw(g);

 } // end drawFrame()

/**
* This nested class defines the boat.  Note that its constructor cannot
* be called until the width of the panel is known!
*/
private class Boat {
  int centerX, centerY;  // Current position of the center of the boat.
  Boat() { // Constructor centers the boat horizontally, 80 pixels from top.
     centerX = width/2;
     centerY = 80;
  }
  void updateForNewFrame() { // Makes sure boat has not moved off screen.
     if (centerX < 0)
        centerX = 0;
     else if (centerX > width)
        centerX = width;
  }
  void draw(Graphics g) {  // Draws the boat at its current location.
     g.setColor(Color.BLUE);
     g.fillRoundRect(centerX - 40, centerY - 20, 80, 40, 20, 20);
  }
 } // end nested class Boat

 /**
 * This nested class defines the bomb.
 */
 private class Bomb {
  int centerX, centerY; // Current position of the center of the bomb.
  boolean isFalling;    // If true, the bomb is falling; if false, it
                        // is attached to the boat.
  Bomb() { // Constructor creates a bomb that is initially attached to boat.
     isFalling = false;
  }
  void updateForNewFrame() {  // If bomb is falling, take appropriate action.
     if (isFalling) {
        if (centerY > height) {
              // Bomb has missed the submarine.  It is returned to its
              // initial state, with isFalling equal to false.
           isFalling = false;
        }
        else if (Math.abs(centerX - sub.centerX) <= 36 &&
                             Math.abs(centerY - sub.centerY) <= 21) {
              // Bomb has hit the submarine.  The submarine
              // enters the "isExploding" state.
           sub.isExploding = true;
           sub.explosionFrameNumber = 1;
           isFalling = false;  // Bomb reappears on the boat.
        }
        else {
             // If the bomb has not fallen off the panel or hit the
             // sub, then it is moved down 10 pixels.
           centerY += 10;
        }
     }
  }
  void draw(Graphics g) {  // Draw the bomb.
     if ( ! isFalling ) {  // If not falling, set centerX and CenterY
                          // to show the bomb on the bottom of the boat.
        centerX = boat.centerX;
        centerY = boat.centerY + 23;
     }
     g.setColor(Color.RED);
     g.fillOval(centerX - 8, centerY - 8, 16, 16);
  }
 } // end nested class Bomb

/**
* This nested class defines the sub.  Note that its constructor cannot
* be called until the width of the panel is known!
*/
private class Submarine {
  int centerX, centerY; // Current position of the center of the sub.
  boolean isMovingLeft; // Tells whether the sub is moving left or right
  boolean isExploding;  // Set to true when the sub is hit by the bomb.
  int explosionFrameNumber;  // If the sub is exploding, this is the number
                             //   of frames since the explosion started.
  Submarine() {  // Create the sub at a random location 40 pixels from bottom.
     centerX = (int)(width*Math.random());
     centerY = height - 40;
     isExploding = false;
     isMovingLeft = (Math.random() < 0.5);
  }
  void updateForNewFrame() { // Move sub or increase explosionFrameNumber.
     if (isExploding) {
           // If the sub is exploding, add 1 to explosionFrameNumber.
           // When the number reaches 15, the explosion ends and the
           // sub reappears in a random position.
        explosionFrameNumber++;
        if (explosionFrameNumber == 15) {
           centerX = (int)(width*Math.random());
           centerY = height - 40;
           isExploding = false;
           isMovingLeft = (Math.random() < 0.5);
        }
     }
     else { // Move the sub.
        if (Math.random() < 0.04) {
              // In one frame out of every 25, on average, the sub
              // reverses its direction of motion.
           isMovingLeft = ! isMovingLeft;
        }
        if (isMovingLeft) {
              // Move the sub 5 pixels to the left.  If it moves off
              // the left edge of the panel, move it back to the left
              // edge and start it moving to the right.
           centerX -= 5;
           if (centerX <= 0) {
              centerX = 0;
              isMovingLeft = false;
           }
        }
        else {
              // Move the sub 5 pixels to the right.  If it moves off
              // the right edge of the panel, move it back to the right
              // edge and start it moving to the left.
           centerX += 5;
           if (centerX > width) {
              centerX = width;
              isMovingLeft = true;
           }
        }
     }
  }
  void draw(Graphics g) {  // Draw sub and, if it is exploding, the explosion.
     g.setColor(Color.BLACK);
     g.fillOval(centerX - 30, centerY - 15, 60, 30);
     if (isExploding) {
            // Draw an "explosion" that grows in size as the number of
            // frames since the start of the explosion increases.
        g.setColor(Color.YELLOW);
        g.fillOval(centerX - 4*explosionFrameNumber,
              centerY - 2*explosionFrameNumber,
              8*explosionFrameNumber,
              4*explosionFrameNumber);
        g.setColor(Color.RED);
        g.fillOval(centerX - 2*explosionFrameNumber,
              centerY - explosionFrameNumber/2,
              4*explosionFrameNumber,
              explosionFrameNumber);
     }
  }
 } // end nested class Submarine

} // end class SubKiller 
```

# ios - 为什么 Facebook 登录不要求我提供电子邮件和密码

> ID：13113925
> 
> 赞同：1
> 
> 时间：2012-10-28T23:04:34.663
> 
> 标签：ios, facebook, facebook-ios-sdk

我只是简单地浏览了[这个](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)和[这个](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/personalize/)官方的 facebook 教程

我的电子邮件和密码对于真正进行身份验证很重要，对吧？为什么 facebook SDK 不要求它们。当我点击登录按钮时，它直接让我登录并显示我的姓名和头像。

我问这样的问题是因为我将在我的应用程序中集成 facebook SDK 以允许用户使用 Facebook 登录，所以我需要了解为什么身份验证过程不是真正的 Facebook 网站上使用的标准过程？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:08:43.847

您的 Internet 浏览器正在将您的登录信息保存在其缓存中。清除历史记录和/或缓存，系统会再次要求您提供登录信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:23:32.883

在 iOS 6.0 上，您的设置中有 Facebook。如果您已在那里登录，那么您的 FB 会话将是有效的（FBSession.activeSession.state == FBSessionStateCreatedTokenLoaded），直到您注销为止。这可以获得您的个人资料和其他默认信息。尝试调用 [FBSession.activeSession closeAndClearTokenInformation]; 来自 DidApplicationFinishLaunching，它会将您重定向到 FB 登录页面，而不是获取您的信息并立即显示。

# objective-c - 如何在 .h 文件中写入具有多个参数的方法的名称

> ID：13113928
> 
> 赞同：0
> 
> 时间：2012-10-28T23:05:08.460
> 
> 标签：objective-c, ios

我是 iOS 新手。我在 .m 文件中定义了以下方法，需要将其名称添加到 .h 文件中。

```
-(Boolean) addBookFromArrayOne:(Book*)bookOne bookTwo:(Book*)bookTwo mergeByThisField:(NSString*)field sortDescending:(Boolean) 
```

这篇文章[目标 C](https://stackoverflow.com/questions/683211/method-syntax-in-objective-c)中的方法语法对学习目标 C 方法语法非常有帮助。答案

> 在 Objective-C 中，方法的名称由声明中不是参数和类型的所有部分组成。因此，此方法的名称将是：pickerView:numberOfRowsInComponent:

特别有帮助。

但它没有展示如何推广到多个参数。

我猜测了头文件中的语法，但显然我弄错了：

```
@property Boolean addBookFromArrayOne:bookTwo:mergeByThisField:sortDescending; 
```

有人可以告诉我如何在头文件中定义这个方法名称吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:09:53.513

**只需将方法声明从实现复制到标题**

```
-(Boolean) addBookFromArrayOne:(Book*)bookOne bookTwo:(Book*)bookTwo mergeByThisField:(NSString*)field sortDescending:(Boolean)desc; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:09:06.450

不要使用属性来声明方法；要在头文件中声明一个方法，只需编写：

```
-(Boolean) addBookFromArrayOne:(Book*)bookOne bookTwo:(Book*)bookTwo mergeByThisField:(NSString*)field sortDescending:(Boolean)descending; 
```

# c++ - C++11 是否优化了 lambda 中的尾递归调用？

> ID：13113929
> 
> 赞同：3
> 
> 时间：2012-10-28T23:05:37.827
> 
> 标签：c++, lambda, c++11, tail-call-optimization

正如以下测试代码所观察到的，我的暂定答案是否定的：

```
#include <functional>
#include <iostream>
#include <string>
#include <vector>

using namespace std;

void TestFunc (void);
int TestFuncHelper (vector<int>&, int, int);

int main (int argc, char* argv[]) {
    TestFunc ();
    return 0;
} // End main ()

void TestFunc (void) {
    // Recursive lambda
    function<int (vector<int>&, int, int)> r = [&] (vector<int>& v_, int d_, int a_) {
        if (d_ == v_.size ()) return a_;
        else return r (v_, d_ + 1, a_ + v_.at (d_));
    };
    int UpperLimit = 100000; // Change this value to possibly observe different behaviour
    vector<int> v;
    for (auto i = 1; i <= UpperLimit; i++) v.push_back (i);
    // cout << TestFuncHelper (v, 0, 0) << endl; // Uncomment this, and the programme works
    // cout << r (v, 0, 0) << endl; // Uncomment this, and we have this web site
} // End Test ()

int TestFuncHelper (vector<int>& v_, int d_, int a_) {
    if (d_ == v_.size ()) return a_;
        else return TestFuncHelper (v_, d_ + 1, a_ + v_.at (d_));
} // End TestHelper () 
```

有没有办法强制编译器优化 lambdas 中的递归尾调用？

在此先感谢您的帮助。

**编辑**

我只是想澄清一下，我的意思是问 C++11 是否优化了 lambdas 中的递归尾调用。我正在使用 Visual Studio 2012，但如果绝对知道 GCC 进行了所需的优化，我可以切换环境。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-28T23:18:51.120

您实际上并没有在“lambda”代码中进行尾调用，至少不是直接进行。`std::function`是一个*多态函数包装器*，这意味着它可以存储任何类型的可调用实体。C++ 中的 lambda 具有唯一的、未命名的类类型并且不是`std::function`对象，它们可以存储在其中。

由于`std::function`使用类型擦除，它必须跳过几圈才能调用最初传递给它的东西。这些箍通常由虚函数或指向函数模板特化的函数指针和`void*`.

间接的唯一性质使得优化器*很难*看穿它们。同样，编译器很难看穿`std::function`并决定您是否有尾递归调用。

另一个问题是它`r`可能会从内部`r`或同时更改，因为它是一个简单的变量，突然间你不再有递归调用了！使用函数标识符，这是不可能的，它们不能在中途改变含义。

> 我只是想澄清一下，我的意思是问 C++11 是否优化了 lambdas 中的递归尾调用。

C++11 标准描述了抽象机器上的工作程序的行为方式，而不是编译器如何优化内容。事实上，编译器只有在不改变程序的可观察行为的情况下才被允许优化事物（复制省略/（N）RVO是例外）。

# java - android果冻豆上的图像缩放问题

> ID：13113930
> 
> 赞同：1
> 
> 时间：2012-10-28T23:05:39.420
> 
> 标签：java, android, android-4.2-jelly-bean

在 webview 上加载图像时，它会在所有设备和操作系统上正确缩放，直到 ICS。但是，在 Jelly Bean 更新后，它不再缩放了！我发现一些帖子谈论这个错误，但还没有找到解决方案。

[Galaxy SIII 忽略 setDefaultZoom？更新：WebView 的 JellyBean 问题？](https://stackoverflow.com/questions/12288344/galaxy-siii-ignoring-setdefaultzoom-update-jellybean-issue-with-webview)

我很乐意发布一些代码，但我不知道如何附加问题或哪些有用的代码可以提供帮助。请建议。谢谢

# android - Android画布绘制由多个简单形状定义的复杂形状

> ID：13113931
> 
> 赞同：2
> 
> 时间：2012-10-28T23:05:46.923
> 
> 标签：android, graphics, android-canvas, shapes

我想在 android canvas 上绘制类似于这种形状的东西：

![http://i.imgur.com/eQOHz.png](../Images/dd7b7a2a6f3dd81e7160ea427860e651.png)

我认为最好的方法是将这个形状定义为 2 个圆和一条线的交集。用 android canvas 创建这个的正确方法是什么？

***更新*** 我现在按照 smith324 的建议使用 PorterDuff：

*注意：为清楚起见，代码略微简化。

```
darkPaint = new Paint();
darkPaint.setColor(Color.rgb(50, 50, 50));

lightPaint = new Paint();
lightPaint.setColor(Color.rgb(200, 200, 200));

atopPaint= new Paint(GameDrawingPanel.darkPaint.getColor());
atopPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_ATOP));
atopPaint.setAntiAlias(true);
atopPaint.setStrokeWidth(2);

_boardCanvas.drawCircle(x, y, radius, darkPaint);
_boardCanvas.drawCircle(x, y, radius_small, lightPaint);
_boardCanvas.drawRect(0,0,height,width,atopPaint); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T04:39:01.837

我完全忘记了在这里使用哪种模式（XOR 应该可以工作），但基本上你需要使用 PorterDuff 传输模式来实现这一点。尝试将同心圆彼此重叠，然后在一侧绘制一个分割矩形。

[http://developer.android.com/reference/android/graphics/PorterDuff.Mode.html](http://developer.android.com/reference/android/graphics/PorterDuff.Mode.html)

[http://www.svgopen.org/2005/papers/abstractsvgopen/](http://www.svgopen.org/2005/papers/abstractsvgopen/)

# c# - 一种将 Adob e AIR 与 .NET 相结合的方法？

> ID：13113934
> 
> 赞同：0
> 
> 时间：2012-10-28T23:06:08.607
> 
> 标签：c#, .net, wpf, flash, air

我想知道是否有可能将 AIR 应用程序与 WinForms 应用程序结合起来？

**例子**

我用[Adob​​e AIR](http://www.adobe.com/products/air.html)制作了一些不错的动画加载屏幕/启动屏幕，我想将它们与 .NET 程序一起使用，这可能吗？

我不想简单地`program.exe`在 Adob​​e AIR ( ) 中调用程序可执行文件 ( `Air.exe`)。我想在空气中使用文本字段，当我单击提交时，我希望 AIR 将信息传递给 .NET`C#`表单并用它来处理。

这样做的正确方法是什么，或者有什么替代方法？（用于在内部`WPF`嵌入闪光灯（`SWF`）`.NET`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T02:56:53.547

根据本[教程](http://www.adobe.com/devnet/adobe-media-server/articles/first_im_app.html)中发布的内容，我认为可以将 .NET 与[Adob​​e AIR](http://www.adobe.com/products/air.html)一起使用，但我不确定。

您可能还想看看[这个](http://ajaxian.com/archives/commandproxy-integrating-air-and-net)展示如何使用`CommandProxy`集成 AIR 和 .NET

谢谢，
我希望你觉得这有帮助:)

# location - 我可以使用什么大数据产品或平台来存储地理数据？

> ID：13113936
> 
> 赞同：2
> 
> 时间：2012-10-28T23:06:30.853
> 
> 标签：location, geospatial, bigdata, sqlgeography

我正在寻找一种大数据解决方案，用于存储具有地理位置（Lat/Lng）的记录，然后执行邻近搜索。

例如，将所有建筑物存储在数据库中，然后在数据库中查询离用户当前位置最近的建筑物。

我期望有大量插入的实体，所以这必须是一个大数据解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T02:07:39.513

我建议你[PostgreSQL](http://www.postgresql.org/)和[PostGIS](http://postgis.refractions.net/)。众所周知，PostgreSQL 非常适合处理大型数据集。而且，它是开源的。

# exception-handling - zend framework 2 如何捕捉异常？

> ID：13113942
> 
> 赞同：1
> 
> 时间：2012-10-28T23:07:54.393
> 
> 标签：exception-handling, namespaces, zend-db, zend-framework2

如何使用 PHP 基本异常在 zend 框架 2 中捕获异常？

如果未注释行，则找不到异常类并且未捕获异常。

如果注释行，则命名空间为空，并创建 PHP 基异常类。

我不能取消注释这一行，因为 zend 在很多地方都需要它，例如 ActionController。

怎么做？
我只能使用 Zend Exceptions 吗？我必须使用哪个，更通用的 zend Exception 类是什么？

```
 <?php namespace SecureDraw; ?> //  <<----- If remove this line catch work ok!!
    <?php echo $this->doctype(); ?>
    <?php
        use Zend\Db\Adapter\Adapter as DbAdapter;

        try{
            $dbAdapter = new DbAdapter(array(  
                'driver' => 'Pdo_Mysql',
                'database' => 'securedraw',
                'username' => 'root',
                'password' => '',
            ));         
            $sql = "select * from tablenotexist";
            $statement = $dbAdapter->createStatement($sql);
            $sqlResult = $statement->execute();
        }
        catch(Exception $e){
            echo "hello";
        }
    ?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T23:18:07.410

您需要添加：

```
use Exception; 
```

或使用：

```
catch (\Exception $e) { 
```

所有内置的 PHP 类都存在于根 ( `\`) 命名空间中。您示例中的 try-catch 正在尝试匹配`SecureDraw\Exception`。

[这与如何在 ZF2 控制器中捕获异常](https://stackoverflow.com/questions/13108482/how-to-catch-exceptions-in-your-zf2-controllers)是同一个问题？

# java - 在 char 数组中查找整数平均值

> ID：13113945
> 
> 赞同：1
> 
> 时间：2012-10-28T23:08:13.810
> 
> 标签：java

所以我在创建这个函数时遇到了麻烦，它必须找到一个 char 数组的整数平均值。

这是我的数组 char[]letters = {'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'} ;

我试图键入 cast 以找到整数平均值，如 A= 32 j= 74。添加整数值并将其转回一个字符，但此刻卡住了。

```
/********************************************************************************
 This function will calculate the integer average of characters in the array
********************************************************************************/
public static void average( char [] letters )
{
     int total = 0;

     char mean;

     total = total + letters[letters.length];
     mean = (char)total / letters.length;

     System.out.println("The value is " + average( letters) );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:10:16.323

这是不正确的：

```
 total = total + letters[letters.length]; 
```

此操作将超出数组末尾的值添加到`total`，触发异常。

你需要一个循环：

```
for (int i = 0 ; i != letters.length ; i++)
    total += letters[i]; 
```

您还可以使用`for`-`in`循环，如下所示：

```
for (char ch : letters)
    total += ch; 
```

您也在铸造`total`而不是铸造除法的结果：

```
mean = (char)total / letters.length; 
```

应该替换为

```
mean = (char)(total / letters.length); // Note the added parentheses 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T23:17:21.173

首先-您的方法是递归的，它会中断。我想您想将字符转换为十进制 ascii 代码。试试这个：

```
public static int average( char [] letters )
{
     int total = 0;

     for(int i = 0; i < letters.length; i++){
       total += (int)letters[i];
     }

     return total / letters.length; //or cast it back to char if you prefer
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T23:15:38.533

这是一个关于如何做到这一点的练习吗？如果没有，请使用字符数组并使用 .digit()。

如果是这样，那么你在正确的轨道上，但我的第一个想法是循环，减去适当的值以将 ascii 字符更改为数字，也许将它们粘贴在一个新数组中，然后再次循环以求平均值。

老实说，我看不出你是如何用 0 个循环来尝试这个的。

# jquery - 重置 Twitter Bootstrap 表单单选按钮组。如何？

> ID：13113946
> 
> 赞同：1
> 
> 时间：2012-10-28T23:08:13.630
> 
> 标签：jquery, forms, twitter-bootstrap

我正在使用 Twitter Bootstrap 和 Joomla 3.0，并且有一个需要重置为默认值的表单。Simple`form.reset();`适用于除无线电 btn 组以外的所有元素。

我的意思是，收音机被重置，但标签状态没有改变。我几乎没有尝试重置它，但由于 btn 类名不明确而适得其反。我试图以具有 50 多个单选按钮选项的表单中的 id 为目标字段集组，但效果不佳。它们的颜色最终会有所不同，等等。

我将不胜感激这方面的任何帮助

这是摆弄例子

[http://jsfiddle.net/DZ7HL/31/](http://jsfiddle.net/DZ7HL/31/)

**Turn radios into btn-group**的 js 来自 joomla 默认管理员模板，**我无法删除/编辑或更改它**，如果这造成了一些麻烦，我必须想办法让它与存在的 js 一起工作。如果有任何帮助，我有我自己的 js 文件，该文件在该文件之后加载

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T00:50:20.613

这似乎是 joomla 对标签所做的奇怪的“逻辑”。它向标签添加了一些类，您可以轻松地重置无线电组，但是“手动”添加的类仍然存在，因此您必须删除它们。

所有“默认值”都是#2 选项，对吧？这是一个通用功能

```
// FROM HERE IS CHANGABLE
function resetRadioGroup(groupname) {
switch($("input[name='"+groupname+"']:eq(1)").val()) {
    case '' : var css='btn-primary'; break;
    case '0': var css='btn-danger'; break;
    default : var css='btn-success'; break;
}
$("input[name='"+groupname+"']").next().removeClass('active btn-success');
$("input[name='"+groupname+"']:eq(1)").prop("checked", true).next().addClass('active '+css);
}

$('#reset_form').click(function() {
    $('#myform')[0].reset();
    resetRadioGroup('radio_test');
    resetRadioGroup('radio2_test');
}) 
```

已经在[http://jsfiddle.net/AtL5q/上分叉了](http://jsfiddle.net/AtL5q/)

**更新** 鉴于所有无线电组都在具有类 btn-group 的字段集中，您可以自动调用`resetRadioGroup`函数：

```
$('#reset_form').click(function() {
    $('#myform')[0].reset();
    $('fieldset.btn-group').each(function() {
      resetRadioGroup($(this).find('input').first().attr('name'));
    });
})​ 
```

[http://jsfiddle.net/3aU4F/](http://jsfiddle.net/3aU4F/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T02:06:33.910

我去的解决方案是

```
// FROM HERE IS CHANGABLE
$('#reset_form').click(function() {

    $('#myform')[0].reset();

    $(".btn-group label:not(.active)").change(function() {
        var label = $(this);
        var input = $('#' + label.attr('for'));

        if (input.prop('checked')) {
            label.closest('.btn-group').find("label").removeClass('active btn-success btn-danger btn-primary');
            if (input.val() == '') {
                label.addClass('active btn-primary');
            } else if (input.val() == 0) {
                label.addClass('active btn-danger');
            } else {
                label.addClass('active btn-success');
            }
        }
    }).change();

})​ 
```

如此处所示，jsfiddle.net/Yt9uX/41 所以你有它我相信它会对使用 joomla 3.0 或使用 btn 组无线电的 bootsrtap 表单的任何人派上用场

# php - PHP在某个字符后拆分字符串，但字符串长度不同

> ID：13113948
> 
> 赞同：1
> 
> 时间：2012-10-28T23:08:35.603
> 
> 标签：php, arrays, string, split, substr

我使用一个单选按钮，它给了我两个连接的变量，我需要稍后将它们分开。它以 11:30 pm3 的格式为我提供了时间和日期，其中 3 是日期，晚上 11:30 是时间。我可以用我的函数很好地拆分它，但如果时间是一位数，例如晚上 7:30，它就会把事情搞砸。我可以使用军用时间，但这不是我想要的。有没有办法改变这个，所以它在字符“m”之后分割字符串，所以它适用于上午/下午，无论时间长度是上午 7:00或早上 7:00。提前致谢。

```
$string = $Radio;   //This is the value I get 
$MeetTime = substr("$string", 0, 7); //Gives me 11:30am
$MeetDay  = substr("$string", 7, 2); //Gives me 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:12:38.713

找出 m 在哪里，然后做你的逻辑

如果 m 为 6，则它是一个全长

```
$loc = stripos($string,"m"); 
```

如果它在 5 那么它很短所以调整你的分裂

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-28T23:13:57.023

```
if(preg_match('~^([\\d]{1,2}:[\\d]{1,2}[ap]m)([\\d]+)$~i', trim($string), $Matches)){
    var_dump($Matches); // See what this prints
} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-28T23:16:40.130

试试这个：

```
$date = '11:30am3';
$date = explode('pm', $date);
if(count($date) <= 2){
$date = explode('am', $date[0]);
}
print_r($date); 
```

其中 $date[1] 是时间，$day[0] 是日期。但是您应该使用其他格式，我建议使用时间戳。

# java - Why are my JPanels overlapping?

> ID：13113952
> 
> 赞同：0
> 
> 时间：2012-10-28T23:08:44.050
> 
> 标签：java, swing, layout, grid-layout

I am adding more than one panel to a Frame and they are not automatically spacing out. I have a layout manager for each panel. Do I need one for the Frame as well?

The frame is 600X240 and each panel is 200X200\. I need the three panels to space out perfectly. How do I force the frame to add one then add the second one where the first ends etc.?

EDIT** I added this line of code to my frame's constructor:

```
setLayout(new GridLayout(1,3)); 
```

and it now works perfectly.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:47:31.070

我认为 LayoutManagers 是特定于 JPanel 的，但现在我意识到它们用于所有组件。我在 OP 中添加了一个编辑，表明我就是这样做的。谢谢！

# python - Selenium webdriver using switch_to_windows() and printing the title doesn't print the title.

> ID：13113954
> 
> 赞同：15
> 
> 时间：2012-10-28T23:09:00.180
> 
> 标签：python, selenium

Here is the code

```
for handle in browser.window_handles:
    print "Handle = ",handle
    browser.switch_to_window(handle);
    elem = browser.find_element_by_tag_name("title")
    print elem.get_attribute("value") 
```

I am getting the following output

```
Handle =  {564f8459-dd20-45b8-84bf-97c69f369738}
None
Handle =  {85338322-5e58-4445-8fe3-3e822d5a0caf}
None 
```

After getting the handle I switch to the window and print the title. Why am I not seeing any title. Won't there be any titles? When I see the html source for the page I see the title tag though.

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-11T05:30:02.017

```
driver.switch_to_window(driver.window_handles[-1])
title=driver.title 
```

您只需使用上面的代码即可。driver.window_handles[-1] 将获得最新的窗口。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-28T23:14:12.407

页面的标题不会在元素的`value`属性中`title`，而是该元素的文本内容。

访问该文本的正确方法是`browser.find_element_by_tag_name("title").text`

或者更简单，只需访问`browser.title`.

# xcode - Core Data Mac OS X app and compatibilty with OS X 10.7

> ID：13113956
> 
> 赞同：0
> 
> 时间：2012-10-28T23:09:15.830
> 
> 标签：xcode, macos, core-data

Hello i have created a Simple Application with Core Data and OS X 10.8, it's the simple template that xcode create, but if i change the Base SDK to 10.7 xcode give me this error on this method in App Controller:

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    if (_persistentStoreCoordinator) {
    return _persistentStoreCoordinator;
}

NSManagedObjectModel *mom = [self managedObjectModel];
if (!mom) {
    NSLog(@"%@:%@ No model to generate a store from", [self class], NSStringFromSelector(_cmd));
    return nil;
}

NSFileManager *fileManager = [NSFileManager defaultManager];
NSURL *applicationFilesDirectory = [self applicationFilesDirectory];
NSError *error = nil;

NSDictionary *properties = [applicationFilesDirectory resourceValuesForKeys:@[NSURLIsDirectoryKey] error:&error];

if (!properties) {
    BOOL ok = NO;
    if ([error code] == NSFileReadNoSuchFileError) {
        ok = [fileManager createDirectoryAtPath:[applicationFilesDirectory path] withIntermediateDirectories:YES attributes:nil error:&error];
    }
    if (!ok) {
        [[NSApplication sharedApplication] presentError:error];
        return nil;
    }
} else {
    if (![properties[NSURLIsDirectoryKey] boolValue]) {
        // Customize and localize this error.
        NSString *failureDescription = [NSString stringWithFormat:@"Expected a folder to store application data, found a file (%@).", [applicationFilesDirectory path]];

        NSMutableDictionary *dict = [NSMutableDictionary dictionary];
        [dict setValue:failureDescription forKey:NSLocalizedDescriptionKey];
        error = [NSError errorWithDomain:@"YOUR_ERROR_DOMAIN" code:101 userInfo:dict];

        [[NSApplication sharedApplication] presentError:error];
        return nil;
    }
}

NSURL *url = [applicationFilesDirectory URLByAppendingPathComponent:@"SimpleApp.storedata"];
NSPersistentStoreCoordinator *coordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:mom];
if (![coordinator addPersistentStoreWithType:NSXMLStoreType configuration:nil URL:url options:nil error:&error]) {
    [[NSApplication sharedApplication] presentError:error];
    return nil;
}
_persistentStoreCoordinator = coordinator;

return _persistentStoreCoordinator;
} 
```

i receive this error:

![enter image description here](../Images/a003980601e71323c7a3fd39e69ca1ae.png)

how i can do?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:18:27.407

这实际上不是 Core Data 的问题，但这与[对象下标](http://clang.llvm.org/docs/ObjectiveCLiterals.html)有关。为了使这些文字正常工作，您的 SDK 至少需要为 OS X 10.8 或 iOS 6。

如果没有其他方法，您仍然可以使用下标并将您的 SDK 保持在 10.7，方法是向 NSObject 上实现所需方法的类别添加存根标头。[你可以在这里](http://petersteinberger.com/blog/2012/using-subscripting-with-Xcode-4_4-and-iOS-4_3/)看到一个这样的例子。不过，我建议您将 SDK 保持在 10.8 上。

# c++ - Compare string and map value

> ID：13113959
> 
> 赞同：1
> 
> 时间：2012-10-28T23:09:47.127
> 
> 标签：c++, string, comparison, maps

I'm trying to compare two strings

One string is a normal string that I got from an istringstream:

```
string command;
iss >> command; 
```

and the other is a string that I get from my map.

But it does not seem to be working.

The idea is that I have a `map<string, string>`, the value is to be an escape code to change the terminal output colour.

I have a map in my `main` that I put all the keys and values into (which works, I've tested that) so I pass the map into this function.

I also have defined colours at the top of my program:

```
#define BLACK "\033[22;30m"
#define RED "\033[22;31m"
#define GREEN "\033[22;32m"
#define BROWN "\033[22;33m"
#define BLUE "\033[22;34m"
#define PURPLE "\033[22;35m"
#define CYAN "\033[22;36m"
#define GREY "\033[22;37m"
#define DARK_GREY "\033[01;30m"
#define LIGHT_RED "\033[01;31m"
#define LIGHT_GREEN "\033[01;32m"
#define YELLOW "\033[01;33m"
#define LIGHT_BLUE "\033[01;34m"
#define LIGHT_PURPLE "\033[01;35m"
#define LIGHT_CYAN "\033[01;36m"
#define WHITE "\033[01;37m" 
```

This is the part that seems not to be working and confusing me:

```
string getColor(string command, map<string, string> &m)
{
  string color;
  if((m.find(command)->second).compare(RED) == 0)
  {
    color = RED;
    return color;
  }
  // ...and so on for all the other colors
} 
```

I would have made this a `switch`, but C++ doesn't allow switches on strings.

So the problem is, even if the both strings are the same, it's not working like that.

I realize that `m.find()` is returning an iterator at the position of what we are looking for. But then doing `m.find()->second` should get to the value right? And the value is a string, isn't it?

So in short, I'm not sure why the comparison isn't working.

**EDIT:**

Ok, here is the config file I was talking about:

```
bold           \e[0;31m 
italic         \e[0;34m
underline      \e[0;32m 
default        \e[0;37m 
```

so the user input would be something like:

(default this is a(bold simple) example.)

so when I get the command "default", I will search in my map for that string, and then get the colour code associated with it.

then I will change the output colour to the colour in the map associated with default. then I will change the output colour to the colour associated in the map with "bold" to print out the word "simple", and then I will go back to the previous colour to print out the rest of the sentence.

but because when I do this:

```
cout << config.find("bold")->second << " hi" << endl; 
```

it doesn't change the colour, it prints out:

\e[0;31m hi

instead of changing the output colour :/

so I thought I'd do a comparison, because something like this:

```
cout << RED << "hi" << endl; 
```

will print out hi in the colour red.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T23:19:30.713

听起来您正在尝试进行非常复杂的地图查找。这不行吗？

```
 const string & getColor(string command, const map<string, string> & m)
    {
        map<string,string>::const_iterator i = m.find(command);
        return i == m.end() ? BLACK : i->second;
    } 
```

当然，这并没有解决所谓的相等字符串而不是比较相等的问题。我认为，您需要发布一个更完整的示例，以便我们能够回答这个问题。但是关于嵌入空字符的第一个答案是错误的。你所拥有的是嵌入的转义字符，这是完全正确的。我唯一不同的是使用 const char * RED = etc. 而不是#defines，因为变量比宏更容易处理。

编辑：似乎我在这里指的答案消失了。

Edit2：这与您尝试做的相比如何？它至少对我有用：

```
 #include <cstdio>
    #include <string>
    #include <iostream>
    #include <sstream>
    #include <map>
    using namespace std;

    #define BLACK "\033[22;30m"
    #define RED "\033[22;31m"
    #define GREEN "\033[22;32m"

    const string & getColor(const string & command, const map<string, string> & m)
    {
        map<string,string>::const_iterator i = m.find(command);
        return i == m.end() ? BLACK : i->second;
    }

    int main() {
        map<string,string> cols;
        cols["BLACK"] = BLACK;
        cols["RED"]   = RED;
        cols["GREEN"] = GREEN;

        string line, cmd, val;
        while(getline(cin, line))
        {
            stringstream ss(line);
            if(ss >> cmd >> val && cmd == "color:")
                cout << getColor(val, cols);
            else cout << line << endl;
        }
    } 
```

输入

```
This text is default color
color: RED
This text is red
color: GREEN
This text is green 
```

应产生指示的颜色。

Edit3：根据您的新信息，似乎真正的问题是您的配置文件包含不包含实际的转义字符，仅包含字符“\”和“e”。确保您的文件实际上包含真正的转义字符。如何生成这些因编辑器而异。在 vim 中，您可以通过 ctrl-V 后跟 escape 来输入转义。在最坏的情况下，您可以通过从您自己的 C 程序中打印它们来生成它 - 毕竟，您已经有了定义：`fprintf(conffile, "bold %s\n", BOLD)`.

# javascript - 通过Javascript检查img的纵横比

> ID：13113964
> 
> 赞同：6
> 
> 时间：2012-10-28T23:10:18.197
> 
> 标签：javascript, jquery, css, image

[在这个问题](https://stackoverflow.com/questions/13105556/how-to-center-images-in-a-responsive-grid-with-css-only-and-supporting-retina-di)中，我一直在为具有不同比例图像的响应式照片库询问一个可行的 CSS 解决方案。
不幸的是，我想通过 css 执行此操作太复杂了，所以唯一快速简单的解决方案是使用 javascript 检查缩略图的纵横比并更改某些缩略图的内联 css：
脚本应该检查`height:width`每个缩略图的比例，如果比率低于 0.6666666666666667 (2:3) 然后通过 css 设置`height:100%; max-width:none;`以覆盖实际规则。如果更容易，也可以添加一个类。

这如何通过javascript完成？（也可以使用 jquery，因为该库已经存在于其他插件中）。

网格的结构是这样的：

```
<ul id="gallery" class="gallery-grid">
  <li class="grid-block">
    <div class="block-wrap">
        <div class="link-wrap">
            <a href="<?php echo $photo->sourceImageFilePath; ?>" class="block-link" target="_blank" >
                <img class="block-thumb" src="<?php echo $photo->thumbImageFilePath; ?>"/>              
            </a>
        </div>  
    </div>
  </li>
</ul> 
```

当然，如果你能找到一个可行的 css 答案来回答我之前的问题，那就更受欢迎了！谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-28T23:15:47.317

```
var ratio = $img.height() / $img.width();
if ( ratio < (2/3) ) { $img.css({ height: '100%', maxWidth: 'none' }) } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-28T23:15:23.667

您可能只想查询每个*缩略图*并进行数学计算。

```
$('img').each(function(_, img) {
    var $this = $(this);

    if( $this.height() / $this.width() < 0.6666666666666667 ) {
        $this.css({
            height: '100%',
            maxWidth: 'none'
        });
    }
}); 
```

# java - 在 Java 中的 try-catch 块中嵌入 try-catch 块

> ID：13113966
> 
> 赞同：1
> 
> 时间：2012-10-28T23:10:33.130
> 
> 标签：java, exception-handling

假设我有方法 a() 和方法 b() 都可能引发异常。在我的程序中，有一种情况我必须至少调用其中一个；我打电话给哪个都没关系。但是，如果其中一个抛出异常，我必须调用另一个。如果他们都抛出异常，我不需要做任何事情。

我正在考虑做这样的事情：

```
try {
    a();
catch (Exception e) {
    try {
        b();
    catch (Exception e) {

    }
} 
```

但我认为如果我有两个以上的方法可以调用，这将是不切实际的。所以我想知道是否有更优雅或更好的方法来做我想做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:15:24.010

你可以

```
 abc:
    {
        try
        {
            a();
            break abc;
        }
        catch(Exception e){}

        try
        {
            b();
            break abc;
        }
        catch(Exception e){}

        try
        {
            c();
            break abc;
        }
        catch(Exception e){}

    } 
```

* * *

如果链条更长，可能更好

```
for(int i=0; i<4; i++)
{
    try 
    {
        switch(i)
        {
            case 0: a(); break;
            case 1: b(); break;
            case 2: c(); break;
            case 3: d(); break;
        }
    }
    catch(Exception e){} // next
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T23:15:43.227

您可以在每个案例之后返回，这样在第一次成功后，就会触发返回。

```
public void uponSuccessStop() {
    try {
        a();
        return;
    } catch (Exception e) {}
    try {
        b();
        return;
    } catch (Exception e) {}
    try {
        c();
        return;
    } catch (Exception e) {}
} 
```

另一种选择是抛出异常，并使用短路布尔逻辑：

```
public boolean tryA() {
    try {
        a();
        return true;
    } catch (Exception e) {
        return false;
    }
}
// repeat for B and C

public void uponSuccessStop() {
    boolean succeeded = tryA() || tryB() || tryC();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T23:16:41.180

很难在如此笼统的层面上讨论实际的选择，但你可以这样做：

```
boolean succeeded = false;
try {
    a();
    succeeded = true;
} catch (Exception e) {
    // intentional ...
}
if (not succeeded) {
    try {
        b();
    catch (Exception e) {
        ...
    }
} 
```

...以及使用条件（或`break`或`return`）来避免嵌套的所有其他安排。

但是它们是否更“优雅”......或者更具可读性......将高度依赖于上下文。并且还依赖于读者。*（作为一名经验丰富的 Java 程序员，我可以毫无困难地理解嵌套异常。根据我的经验，旨在*避免嵌套的人为构造可能会导致代码*难以*阅读/理解。）

* * *

我希望你不会*真的*去捕捉`Exception`......因为如果你捕捉到了，那是一个比 try / catch 嵌套更糟糕的问题*！*

# django - Django class naming convention regarding abbreviations

> ID：13113967
> 
> 赞同：1
> 
> 时间：2012-10-28T23:10:56.177
> 
> 标签：django, naming-conventions

Is there an existing naming convention for using abbreviations in Django classes (e.g. models, forms, etc)? Specifically I'm interested if there's different rules between abbreviations/acronyms/initialisms?

So far I've only found examples of non-acronyms:

*   `XMLField`
*   `HTTPRequest`

What should a JSON field be called (since it's an acronym)?

*   `JSONField`, or
*   `JsonField`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-28T23:35:24.480

从[PEP 8](http://www.python.org/dev/peps/pep-0008/#naming-conventions)开始：

使用`JSONField`过`JsonField`。

由于 CapWords 用于类名，因此此注释适用：

> 注意：在 CapWords 中使用缩写词时，将缩写词的所有字母大写。因此 HTTPServerError 比 HttpServerError 好。

# c - Can I pass a string into a function

> ID：13113970
> 
> 赞同：1
> 
> 时间：2012-10-28T23:11:34.333
> 
> 标签：c, arrays, string, function

How can I pass a string from an array into a function? I want to pass a string such as `"Battleship"` into the function `print()` and have it print `"Where would you like to place the Battleship?"`

```
#include <stdio.h>

void print(char ship_names);

int main (void)
{
    int index = 0;
    char ships_name[5][21]= { "Aircraft Carrier (5)", "Battleship (4)", "Submarine (3)", 
                              "Cruiser (3)", "Destroyer (2)"};

    for(index = 0; index < 5; index++)
        print(*ships_name[index]);

return 0;
}

void print(char ship_names)
{
    printf("Where would you like to place the %s?\n", ship_names);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:13:59.770

Let `print` take a `char const *` instead of a single `char`. Then, drop the `*` from the call:

```
print(ships_name[index]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:14:21.187

您需要使您的打印函数采用指向字符的指针，而不是字符。这是因为在 C 中，字符串只是一个内存位置，其中包含一些以空字节结尾的字符。

您应该将 print 的签名更改为

```
void print(char *ship_names) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-28T23:16:25.833

我认为与其取消引用指向 shipname[index] 字符串的指针，不如传递字符串指针本身，并使用`print(ships_name[index])`该指针传递指向字符串的指针。然后，您的方法将必须采用 char *。

# c++ - Setting stack size with GCC 4.6.2 C++ Qt, MinGW, Vista

> ID：13113971
> 
> 赞同：4
> 
> 时间：2012-10-28T23:11:39.087
> 
> 标签：c++, qt, gcc, windows-vista, stack-size

I want to increase the stack size of my program because I have a complex recursive algorithm it would be a REAL pain to rewrite iteratively.

I am using GCC C++ 4.6.2\. MinGw, building with a Qt .pro file (I'm using Qt for the GUI front end), on Vista.

Advice on this website is to use:-

```
gcc -Wl,--stack,4194304 
```

and to send this to the g++ link phase with:-

```
LIB += -Wl,--stack,4194304 
```

but the linker errors with:-

> g++: error: unrecognized option '--stack,4194304'

I have tried sending the options to the compile phase with QMAKE_CXXFLAGS += but g++ still barfs.

The only option that does not barf is -fno-stack-limit from the GCC documentation (.pdf 4.5.0, p.260), but my stack still overflows. The other options mentioned in that para. barf.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T07:34:36.217

您需要添加`QMAKE_CXXFLAGS += -Wl,--stack,4194304`到您的 .pro 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T12:23:37.983

尝试这个：

```
ulimit -s STACK_SIZE 
```

# ruby-on-rails - How to update a record?

> ID：13113976
> 
> 赞同：0
> 
> 时间：2012-10-28T23:12:08.390
> 
> 标签：ruby-on-rails

What is the proper way to update a record in Ruby on Rails? Just a single record. For example, I want to modify the name of the title somehow. A code snippet would be awesome!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T23:30:22.217

The basic way to update a record is like that :

```
@user.name = "new name"
@user.save 
```

this assumes that `@user` in an instance of a `User` class having a `name` field.

you can also do mass_assignment with the `update_attributes` method

```
@user.update_attributes name: "new name", email: "new_email@foo.com" 
```

If you want an exception to be raised if the record is invalid you can use the bang method instead, so here it would be `save!` & `update_attributes!`

You can also use the `update_attribute` which has been (or will be soon) renamed to `update_column` to update a single column while skipping the validation, but you should generally avoid using this method

more doc [there](http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html)

Finally you can use the [write_attribute](http://api.rubyonrails.org/) method

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:29:50.043

```
entity = Entity.find_by_name("some_name")
entity.title="new title"
entity.save! 
```

or

```
Entity.find_by_name("some_name").update_attributes(:title => "new title") 
```

for more details, refer to [http://guides.rubyonrails.org](http://guides.rubyonrails.org)

# nginx - Does nginx block on long requests?

> ID：13113977
> 
> 赞同：0
> 
> 时间：2012-10-28T23:12:22.453
> 
> 标签：nginx

I've read a couple similar questions but haven't gotten the answer I'm looking for. If Nginx is using an evented model, my understanding is that any work that happens in the event loop is blocking the event loop. So does it block, or does it use some other idea to avoid blocking the event loop if there's some slow request. Is it based on the idea that there are no slow requests in a typical http situation?

# java - Why Does this Code Only Work Sometimes (Java)

> ID：13113980
> 
> 赞同：0
> 
> 时间：2012-10-28T23:12:47.640
> 
> 标签：java

I don't quite get it, here's this code to produce a 3D cube:

```
import javax.media.j3d.*;
import com.sun.j3d.utils.geometry.*;
import com.sun.j3d.utils.universe.*;
import javax.vecmath.*;
import javax.swing.*;
import java.awt.event.*;

public class pject extends JFrame {
private Canvas3D canvas;
private SimpleUniverse uni;
private BranchGroup scene;

public pject() {
    this.setSize(600,400);
    this.addKeyListener(new KeyHandler());
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setVisible(true);
    canvas = new Canvas3D(SimpleUniverse.getPreferredConfiguration());
    this.add(canvas);

    uni = new SimpleUniverse(canvas);
    scene = new BranchGroup();
    start();
}
private void start() {
    ColorCube cc = new ColorCube(0.1d);
    scene.addChild(cc);
    Transform3D lookAt = new Transform3D();
    lookAt.lookAt(new Point3d(0.0, 0.0, 1.0), new Point3d(0.0, 0.0, 0.0), new Vector3d(0.0, 1.0, 0));
    lookAt.invert();
    uni.getViewingPlatform().getViewPlatformTransform().setTransform(lookAt);
    uni.addBranchGraph(scene);

}

public static void main(String[] args) {
    pject frame = new pject();
}

float x = 0.4f;     
private class KeyHandler extends KeyAdapter {
    public void keyPressed(KeyEvent e) {                       
        if (e.getKeyCode() == KeyEvent.VK_LEFT) x += 0.001;   

        Transform3D lookAtx = new Transform3D();
        lookAtx.lookAt(new Point3d(x, 0.0, 1.0), new Point3d(x, 0.0, 0.0), new Vector3d(0.0, 1.0, 0));
        lookAtx.invert();
        uni.getViewingPlatform().getViewPlatformTransform().setTransform(lookAtx);

    }
    public void keyReleased(KeyEvent e) {
    }     
}

 } 
```

It works, but sometimes. I compile it, it works. I make absolutely no changes at all, compile it, and it doesn't work. I then have to compile it 10-20 times until one of those compilations actually work.

When it doesn't work, it just shows a JFrame with no Canvas3D on it (or if there is one, it's not visible).

This just doesn't make any sense to me. Why would my code only sometimes compile right? Why is it that compiling it over and over again 10-20 eventually will show me my cube?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T00:16:12.197

调用 this.setVisible(true); 在构造函数的末尾。

# php - how to count number of pixels in image (php)

> ID：13113981
> 
> 赞同：2
> 
> 时间：2012-10-28T23:12:50.957
> 
> 标签：php

Please help me to count number of pixels in image, or put out the array of RGB.

So this is the script thet give me one element from array:

```
<?php
    $img = "1.png";
    $imgHand = imagecreatefrompng("$img");
    $imgSize = GetImageSize($img);
    $imgWidth = $imgSize[0];
    $imgHeight = $imgSize[1];
    echo '<img src="'.$img.'"><br><br>';
    for ($l = 0; $l < $imgHeight; $l++) {
        for ($c = 0; $c < $imgWidth; $c++) {
            $pxlCor = ImageColorAt($imgHand,$c,$l);
            $pxlCorArr = ImageColorsForIndex($imgHand, $pxlCor);
        }
    }

        print_r($pxlCorArr); 
?> 
```

sorry for my english i from ukraine

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T23:18:44.723

图像中的像素数只是高度乘以宽度。

但是，我认为这就是你想要的：

```
<?php
    $img = "1.png";
    $imgHand = imagecreatefrompng("$img");
    $imgSize = GetImageSize($img);
    $imgWidth = $imgSize[0];
    $imgHeight = $imgSize[1];
    echo '<img src="'.$img.'"><br><br>';

    // Define a new array to store the info
    $pxlCorArr= array();

    for ($l = 0; $l < $imgHeight; $l++) {
        // Start a new "row" in the array for each row of the image.
        $pxlCorArr[$l] = array();

        for ($c = 0; $c < $imgWidth; $c++) {
            $pxlCor = ImageColorAt($imgHand,$c,$l);

            // Put each pixel's info in the array
            $pxlCorArr[$l][$c] = ImageColorsForIndex($imgHand, $pxlCor);
        }
    }

    print_r($pxlCorArr); 
?> 
```

这会将图像的所有像素数据存储在`pxlCor`和`pxlCorArr`数组中，然后您可以对其进行操作以输出您想要的内容。

该数组是一个 2d 数组，这意味着您可以引用以`$pxlCorArr[y][x]`开头的单个像素`[0][0]`。

# python - New rows not showing up after SQL INSERT & "commit" with Python and SQL

> ID：13113984
> 
> 赞同：3
> 
> 时间：2012-10-28T23:13:03.950
> 
> 标签：python, mysql, sqlite, commit, autocommit

I made a loop in Python that calls itself to repeatedly check for new entries in a database. On first execution, all affected rows are shown fine. Meanwhile, I add more rows into the database. On the next query in my loop, the new rows are not shown.

This is my query-loop:

```
def loop():
    global mysqlconfig # username, passwd...
    tbd=[] # this is where I save the result
    conn = MySQLdb.connect(**mysqlconfig)
    conn.autocommit(True)
    c = conn.cursor()
    c.execute("SELECT id, message FROM tasks WHERE date <= '%s' AND done = 0;" % now.isoformat(' '))
    conn.commit()
    tbd = c.fetchall()      
    print tbd
    c.close()
    conn.close()

    time.sleep(5)
    loop()
loop() 
```

This is the SQL part of my Python insertion-script:

```
conn = MySQLdb.connect(**mysqlconfig)
conn.autocommit(1)
c = conn.cursor()
c.execute("INSERT INTO tasks (date, message) VALUES ('{0}', '{1}');".format("2012-10-28 23:50", "test")) 
conn.commit()
id = c.lastrowid
c.close()
conn.close() 
```

I tried SQLite, I tried Oracle MySQL's connector, I tried MySQLdb on a Windows and Linux system and all had the same problem. I looked through many, many threads on Stackoverflow that recommended to turn on autocommit or use commit() after an SQL statement (ex. [one](https://stackoverflow.com/questions/7357995/why-doesnt-this-sql-script-execute), [two](https://stackoverflow.com/questions/9804073/sqllite-python-does-not-update-table), [three](https://stackoverflow.com/questions/12984607/python-mysqldb-failing-to-insert)), which I tried and failed.

When I added data with HeidiSQL to my database it showed up in the loop query, but I don't really know why this is. Rows inserted with mysql-client on Linux and my Python insertion script never show up until I restart my loop script.

I don't know if it's the fact that I open 2 connections, each in their own script, but I close every connection and every cursor when I'm done with them.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T23:45:19.983

问题可能出在您的变量`now`上。我在循环中看不到它正在被重置的任何地方。

我可能会使用 mysql`NOW()`函数：

```
c.execute("SELECT id, message FROM tasks WHERE date <= NOW() AND done = 0;") 
```

看起来您插入数据库的时间是未来的时间。我不认为您的问题与您的数据库连接有关，我认为这与您正在执行的查询有关。

# image - Adjusting the colour/contrast/gamma etc of the video source

> ID：13113988
> 
> 赞同：2
> 
> 时间：2012-10-28T23:14:04.293
> 
> 标签：image, television, hdmi, adjustment

I would like to know whether a Google TV device could be used as a 'man in the middle' and make manual adjustments to the colour and gamma of the input source from HDMI in, before output to the TV?

There are several apps already for phones/tablets which allow for these adjustments but I'm unsure what (if any) control over the video signal can be acheived with a GTV device.

Any insight into the feesibility of such an application would be most appreciated.

# macos - 在 os x 上将 javascript 代码注入 safari

> ID：13113993
> 
> 赞同：1
> 
> 时间：2012-10-28T23:15:25.167
> 
> 标签：macos, html, safari

我希望能够在将浏览器用作 ipad 代理时将 html5 视频播放速度提高到 2 倍。

我可以使用此处找到的代码将其作为书签吗？ [http://www.learningapi.com/2012/04/variable-speed-playback-html5-video-feature/](http://www.learningapi.com/2012/04/variable-speed-playback-html5-video-feature/)

# module - 使用 TypeScript 在客户端和服务器之间共享模块

> ID：13113995
> 
> 赞同：4
> 
> 时间：2012-10-28T23:15:28.613
> 
> 标签：module, client, typescript

我想编写一个可以在 node.js 服务器和浏览器之间重用的可移植模块。

是模块化的东西阻止了我。我正在阅读[http://caolanmcmahon.com/posts/writing_for_node_and_the_browser/](http://caolanmcmahon.com/posts/writing_for_node_and_the_browser/)它看起来很简单，但是让 tsc 生成类似的东西可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T08:48:45.357

如果您以 CommonJS / AMD 样式编写 TypeScript（即每个文件都是一个模块），您可以要求编译器输出 CommonJS（对于 nodejs 服务器）和 AMD（对于浏览器，使用 requires.js）。

所以你的模块文件看起来像这样（没有模块声明）

*我的模块.ts*

```
exports class MyClass {
    constructor (private id: number) {
    }

    // ... etc
} 
```

您将使用以下编译器命令来获取输出...

*对于 nodejs 或浏览器（推荐）*

```
tsc --module umd MyModule.ts 
```

*对于nodejs*

```
tsc --module commonjs MyModule.ts 
```

*对于浏览器（使用 requires.js）*

```
tsc --module amd MyModule.ts 
```

编译输出的唯一区别是服务器代码将使用 CommonJS 导入语句来加载模块，而浏览器代码将调用 requires。

# asp.net - 登录 cookie 在 Firefox 上随机失败。有人经历过吗？

> ID：13113999
> 
> 赞同：1
> 
> 时间：2012-10-28T23:15:43.343
> 
> 标签：asp.net, firefox, cookies

我遇到了这个非常奇怪的问题，目前无法重现。

上周五，使用 Firefox 的每个人（至少 3 家不同的公司，至少 1 家 Firefox 16 和 1 家 Firefox 14）都无法登录我的 2 个网站。我注意到在我的 Firefox 上没有创建登录 cookie（其他 cookie 很好）。同一台服务器上的其他网站（使用非常相似的代码）很好。

星期一，它自己修好了，没有人做任何事情。周二，我在 Firefox 上再次注意到同样的问题，但几分钟后又好了。从那以后我一直无法复制它。

会是什么呢？？？

（我将通过使用 Session 和 Cookie 来解决这个问题，但我真的很好奇它是什么）