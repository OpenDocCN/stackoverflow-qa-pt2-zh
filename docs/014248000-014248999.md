# StackOverflow 问答 14248000-14248999

# regex - 在VS中，你如何使用正则表达式查找/替换但增加数值

> ID：14248000
> 
> 赞同：4
> 
> 时间：2013-01-09T22:58:02.793
> 
> 标签：regex, visual-studio-2010

鉴于我有一个像 A30001 这样的 xml 标签

我能够得到一个正则表达式，它让我得到了数字部分 - 30001

像这样：

```
3{[0-9]^4}\< 
```

然后我可以通过像这样替换标记的表达式来取回值

```
3\1< 
```

但需要知道 Visual Studio 的正则表达式引擎是否会让我用 30002 替换它

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T09:58:43.017

答案是不。在网上搜索之后，我最终用下一个更高的数字进行了手动替换。

# c# - 心形画框

> ID：14248003
> 
> 赞同：0
> 
> 时间：2013-01-09T22:58:16.330
> 
> 标签：c#, winforms, picturebox

是否可以在 C# 中制作心形图片框？我看过制作矩形和椭圆的代码，但我对制作心形区域一无所知。

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:06:24.030

这似乎有效：

```
public class HeartPictureBox : PictureBox {
    protected override void OnPaint(PaintEventArgs pe) {
        using (System.Drawing.Drawing2D.GraphicsPath path = new System.Drawing.Drawing2D.GraphicsPath()) {
            path.AddBezier(this.Width >> 1,
                            this.Height >> 2,
                            this.Width * 1.25f, 0f,
                            this.Width,
                            this.Height * 0.75f,
                            this.Width >> 1,
                            this.Height);
            path.AddBezier(this.Width >> 1,
                            this.Height >> 2,
                            -this.Width * .25f, 0f,
                            0f,
                            this.Height * 0.75f,
                            this.Width >> 1,
                            this.Height);

            this.Region = new Region(path);
        }
    }
} 
```

贝塞尔曲线来自这里： http: [//www.codeproject.com/Tips/177794/Heart-shape-Form-in-C-2-0](http://www.codeproject.com/Tips/177794/Heart-shaped-Form-in-C-2-0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-14T23:28:27.493

```
using System;
namespace ConsoleApplication6
{
    class Program
    {
        static void Main()
        {
            Console.WriteLine("    o o.o o   ");
            Console.WriteLine("  o         o      ");
            Console.WriteLine("  o         o       ");
            Console.WriteLine("   o       o         ");
            Console.WriteLine("     o    o       ");
            Console.WriteLine("       o         ");
            Console.ReadKey();
        }
  }} 
```

# arrays - 需要 bash 来分隔 cat'ed 字符串以分隔变量并执行 for 循环

> ID：14248007
> 
> 赞同：2
> 
> 时间：2013-01-09T22:58:40.300
> 
> 标签：arrays, string, bash, split, cat

我需要获取添加到主文件夹的文件列表，并仅将新文件复制到相应的备份文件夹；每个文件夹的路径有多个文件夹，所有文件夹都以数字命名，并且只有 1 级深度。

```
ie /tester/a/100
   /tester/a/101 ... 
```

`diff -r`在生成的 diff.txt 文件中的每行 通常返回“**仅在 /testing/a/101: 2093_thumb.png ”。**

```
NOTE: there is a space after the colon 
```

我需要将路径和**文件名中的****101**获取到单独的变量中，并将它们复制到备份文件夹中。

 **我需要获取 lesserfolder var 以获取**101** 而不使用冒号和 mainfile var 以从**diff.txt** 的每一行获取 2093_thumb.png 并执行 for 循环，但我似乎无法获得`$file`行为。每次我尝试测试以回显变量时，我都会得到所有错误的结果。

```
 #!/bin/bash
 diff_file=/tester/diff.txt
 mainfolder=/testing/a
 bacfolder= /testing/b

 diff -r $mainfolder $bacfolder > $diff_file
 LIST=`cat $diff_file`

 for file in $LIST
  do
    maindir=$file[3]
    lesserfolder=
    mainfile=$file[4]
    # cp $mainfolder/$lesserFolder/$mainfile $bacfolder/$lesserFolder/$mainfile
    echo $maindir $mainfile $lesserfolder
 done 
```

如果我能让`echo`声明生效，`cp`那么也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T04:11:04.483

我相信这就是你想要的：

```
#!/bin/bash
diff_file=/tester/diff.txt
mainfolder=/testing/a
bacfolder= /testing/b

diff -r -q $mainfolder $bacfolder | egrep "^Only in ${mainfolder}" | awk '{print $3,$4}' > $diff_file

cat ${diff_file} | while read foldercolon mainfile ; do
  folderpath=${foldercolon%:}
  lesserFolder=${folderpath#${mainfolder}/}
  cp $mainfolder/$lesserFolder/$mainfile $bacfolder/$lesserFolder/$mainfile
done 
```

`rsync`但是用于这种备份更可靠（也更容易！） 。例如：

```
rsync -a /testing/a/* /testing/b/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:21:15.603

你可以试试`while read`循环

```
diff -r $mainfolder $bacfolder | while read dummy dummy dir file; do
    echo $dir $file
done 
```**

# python - 使用 pyinstaller 创建的 App-bundle 需要 chmod a+x 才能在其他系统上运行

> ID：14248018
> 
> 赞同：1
> 
> 时间：2013-01-09T22:59:27.160
> 
> 标签：python, pyqt, pyinstaller

我用 pyqt gui 在 python 中制作了一个跨平台应用程序。

然后，我成功地使用 pyinstallers 创建了一个应用程序包，但我遇到了一个问题。

当我在另一台电脑上使用 app bundle 时，我必须进去运行

```
chmod a+x [myapp].app/Content/MacOS/mybinary 
```

让它运行。

难道我做错了什么？有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:51:51.033

按照 X.Jacobs 的建议，使用 -m FILE 选项运行 Makespec.py 可以解决问题。

# javascript - 如何检测 jQuery 全局变量何时准备就绪？

> ID：14248020
> 
> 赞同：0
> 
> 时间：2013-01-09T22:59:31.373
> 
> 标签：javascript, jquery

我尝试使用以下方法进行操作。但是，由于尚未定义 jQuery，我得到了 -

> ReferenceError：未定义 jQuery

来自火狐。

我希望它是未定义和可测试的，不会产生错误。

如果我像这样定义一个虚拟变量`var jQuery`，那么当我使用 jQuery 时，由于范围查找规则，我将始终使用该空白变量。

*如何检测 jQuery 全局变量何时准备就绪？*

```
 // ... snip

    if (jQuery) { // not defined - I guess different from undefined - always errors

    // ...snip 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T23:01:20.197

```
if(window.jQuery !== undefined) 
```

或者

```
if(typeof jQuery !== 'undefined') 
```

但是，在我看来，第一个版本更具可读性，并且在浏览器环境`window`中是全局对象，因此`window.X`几乎等同于全局对象-除了尝试访问未定义对象不会引发错误`X`这一事实。`window.X`

# c# - 在 ASP.NET MVC4 中，application_error 去了哪里？

> ID：14248022
> 
> 赞同：0
> 
> 时间：2013-01-09T22:59:38.753
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4, event-handling

在 MVC3 中，Global.asax.cs 中有一个 Application_Error 事件处理程序

MVC4 没有这个事件处理程序。在 MVC4 中是否有用于处理此类事件错误的新功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:17:04.380

是的，它确实有一个 Application_Error 事件，但与其他事件一样，您必须自己实际创建它。只需将其添加到 global.asax

```
void Application_Error(object sender, EventArgs e)
{
    ....
} 
```

# objective-c - OS X 中的 JSON 到 TableView

> ID：14248023
> 
> 赞同：0
> 
> 时间：2013-01-09T22:59:43.490
> 
> 标签：objective-c, xcode, macos

**任务**：从 url 获取 json，解析它并加载到 table view。

为了解析我使用[json-framework](https://github.com/stig/json-framework)。用于将数据加载到表视图 - 通过 Dictionary 控制器进行 IB 绑定。

一些代码：

```
SBJsonParser* parser = [[SBJsonParser alloc] init];
self.projects = [parser objectWithString:installResponse]; 
```

模型键路径设置为**标题**和**描述**

Json 看起来像这样：

```
{"projects":[{"category_id":1,"date_add":"2013-01-08T01:04:35Z","description":"234324234234324","id":2,"link":null,"price":null,"source_type":null,"title":"324324"}]} 
```

错误是：**此类不符合键标题的键值编码**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:30:50.927

您收到该错误是因为“项目”的值是一个包含一个对象（字典）的数组。我不确定你做了什么来得到那个错误，但是要使用“description”和“title”键访问字典，你需要使用 objectAtIndex:0 或 lastObject。

如果您发布实际的字典而不是 JSON，那会更有帮助。另外，您的字典控制器到底绑定了什么？项目？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:08:26.310

不知道问题是什么，但我从你的描述中了解到，你应该首先

```
NSArray *arrayOfOne = self.projects[@"projects"]; 
```

然后

```
NSDictionary *dataDict = arrayOfOne[0]; 
```

在这种情况下。然后您可以从 dataDict 获取标题键。

```
thingIWantToLoadAStringInto.text = dataDict[@"title"]; 
```

# linux - 在 Linux 上编译 Flash

> ID：14248024
> 
> 赞同：0
> 
> 时间：2013-01-09T22:59:43.960
> 
> 标签：linux, flash, apache-flex

我是 ColdFusion 领域的新手，是我公司的 CM。我的大部分经验是使用 C、C++ 和 Java 构建。

我们有一个我需要编译的 ColdFusion 项目。它包含一堆动作脚本、CFM 文件，其中包含`build.xml`以下几行：

```
<exec executable="C:\Program Files\Adobe\Adobe Flash CS3\flash.exe"
    searchpath="true"
    <arg line="compilePoroject.jsfl"/>
</exec> 
```

我们的构建机器是一个 Linux 机器，所以我希望能够在 Linux 中构建它。我不需要在 Linux 上做开发，所以我不在乎有没有 Linux Flash IDE。我只需要编译我需要编译的任何东西。

我认为有一堆`*.as`文件是需要编译的动作脚本。还有一些`*.fla`我认为是 Adob​​e Vector Graphics 文件的文件。

我下载了 Apache 的 Flex 项目，但自述文件说它依赖于一些第三方资产 (Adobe)，没有它们就无法工作。但是，Flex 项目包含一个`mxmlc.jar`和一个`mxmlc`执行 jar 的二进制文件。此过程似乎没有任何基于 Windows 的依赖项。

我要做的就是编译和构建项目。我不需要编辑这些文件。我只需要构建 SWF 文件。我可以用`mxmlc`我的 Linux 机器上的编译器来做吗？是否可以重组所有内容以使用我的 Linux 机器构建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:25:33.687

基本的答案是你不能。您需要 Adob​​e 库来处理 FLA 文件。有用于编译的*开源*项目，但这些项目大多处于扩展的*alpha*阶段，缺少功能并且存在各种错误。对于一个小型网站来说，它们可能已经足够了，但对于数百万客户访问此页面的商业冒险来说，它们可能已经足够了。

# email - 连接电子邮件客户端，接收有效但发送无效

> ID：14248029
> 
> 赞同：2
> 
> 时间：2013-01-09T23:00:26.937
> 
> 标签：email, smtp, imap

我的代码有问题。它（应该是）一个电子邮件客户端，具有阅读和发送消息的选项 - 问题是，它**不下载消息并且无法发送它们**- 我认为问题出在连接上。

该计划包括以下课程

*   `EmailClient`：电子邮件客户端应用程序的主类
*   `ConnectDialog`：此类显示一个对话框，用于输入电子邮件服务器连接设置。
*   `MessagesTableModel`: 这个类管理电子邮件表的数据。
*   `MessageDialog`：此类显示用于创建消息的对话框。

这是主类，最有趣的是名为`sendMessage()`and的方法`connect()`：

```
import java.awt.*;
import java.awt.event.*;
import java.net.*;
import java.util.*;
import javax.mail.*;
import javax.mail.internet.*;
import javax.swing.*;
import javax.swing.event.*;

// The E-mail Client.
public class EmailClient extends JFrame {

    // Message table's data model.
    private MessagesTableModel tableModel;

    // Table listing messages.
    private JTable table;

    // This the text area for displaying messages.
    private JTextArea messageTextArea;

  /* This is the split panel that holds the messages
     table and the message view panel. */
    private JSplitPane splitPane;

    // These are the buttons for managing the selected message.
    private JButton replyButton, forwardButton, deleteButton;

    // Currently selected message in table.
    private Message selectedMessage;

    // Flag for whether or not a message is being deleted.
    private boolean deleting;

    // This is the JavaMail session.
    private Session session;

    // Constructor for E-mail Client.
    public EmailClient() {
        // Set application title.
        setTitle("E-mail Client");

        // Set window size.
        setSize(640, 480);

        // Handle window closing events.
        addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent e) {
                actionExit();
            }
        });

        // Setup file menu.
        JMenuBar menuBar = new JMenuBar();
        JMenu fileMenu = new JMenu("File");
        fileMenu.setMnemonic(KeyEvent.VK_F);
        JMenuItem fileExitMenuItem = new JMenuItem("Exit",
                KeyEvent.VK_X);
        fileExitMenuItem.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                actionExit();
            }
        });
        fileMenu.add(fileExitMenuItem);
        menuBar.add(fileMenu);
        setJMenuBar(menuBar);

        // Setup buttons panel.
        JPanel buttonPanel = new JPanel();
        JButton newButton = new JButton("New Message");
        newButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                actionNew();
            }
        });
        buttonPanel.add(newButton);

        // Setup messages table.
        tableModel = new MessagesTableModel();
        table = new JTable(tableModel);
        table.getSelectionModel().addListSelectionListener(new
                ListSelectionListener() {
            public void valueChanged(ListSelectionEvent e) {
                tableSelectionChanged();
            }
        });
        // Allow only one row at a time to be selected.
        table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

        // Setup E-mails panel.
        JPanel emailsPanel = new JPanel();
        emailsPanel.setBorder(
                BorderFactory.createTitledBorder("E-mails"));
        messageTextArea = new JTextArea();
        messageTextArea.setEditable(false);
        splitPane = new JSplitPane(JSplitPane.VERTICAL_SPLIT,
                new JScrollPane(table), new JScrollPane(messageTextArea));
        emailsPanel.setLayout(new BorderLayout());
        emailsPanel.add(splitPane, BorderLayout.CENTER);

        // Setup buttons panel 2.
        JPanel buttonPanel2 = new JPanel();
        replyButton = new JButton("Reply");
        replyButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                actionReply();
            }
        });
        replyButton.setEnabled(false);
        buttonPanel2.add(replyButton);
        forwardButton = new JButton("Forward");
        forwardButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                actionForward();
            }
        });
        forwardButton.setEnabled(false);
        buttonPanel2.add(forwardButton);
        deleteButton = new JButton("Delete");
        deleteButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                actionDelete();
            }
        });
        deleteButton.setEnabled(false);
        buttonPanel2.add(deleteButton);

        // Add panels to display.
        getContentPane().setLayout(new BorderLayout());
        getContentPane().add(buttonPanel, BorderLayout.NORTH);
        getContentPane().add(emailsPanel, BorderLayout.CENTER);
        getContentPane().add(buttonPanel2, BorderLayout.SOUTH);
    }

    // Exit this program.
    private void actionExit() {
        System.exit(0);
    }

    // Create a new message.
    private void actionNew() {
        sendMessage(MessageDialog.NEW, null);
    }

    // Called when table row selection changes.
    private void tableSelectionChanged() {
    /* If not in the middle of deleting a message, set
       the selected message and display it. */
        if (!deleting) {
            selectedMessage =
                    tableModel.getMessage(table.getSelectedRow());
            showSelectedMessage();
            updateButtons();
        }
    }

    // Reply to a message.
    private void actionReply() {
        sendMessage(MessageDialog.REPLY, selectedMessage);
    }

    // Forward a message.
    private void actionForward() {
        sendMessage(MessageDialog.FORWARD, selectedMessage);
    }

    // Delete the selected message.
    private void actionDelete() {
        deleting = true;

        try {
            // Delete message from server.
            selectedMessage.setFlag(Flags.Flag.DELETED, true);
            Folder folder = selectedMessage.getFolder();
            folder.close(true);
            folder.open(Folder.READ_WRITE);
        } catch (Exception e) {
            showError("Unable to delete message.", false);
        }

        // Delete message from table.
        tableModel.deleteMessage(table.getSelectedRow());

        // Update GUI.
        messageTextArea.setText("");
        deleting = false;
        selectedMessage = null;
        updateButtons();
    }

    // Send the specified message.
    private void sendMessage(int type, Message message) {
        // Display message dialog to get message values.
        MessageDialog dialog;
        try {
            dialog = new MessageDialog(this, type, message);
            if (!dialog.display()) {
                // Return if dialog was cancelled.
                return;
            }
        } catch (Exception e) {
            showError("Unable to send message.", false);
            return;
        }

        try {
            // Create a new message with values from dialog.
            Message newMessage = new MimeMessage(session);
            newMessage.setFrom(new InternetAddress(dialog.getFrom()));
            newMessage.setRecipient(Message.RecipientType.TO,
                    new InternetAddress(dialog.getTo()));
            newMessage.setSubject(dialog.getSubject());
            newMessage.setSentDate(new Date());
            newMessage.setText(dialog.getContent());

            // Send new message.
            Transport.send(newMessage);
        } catch (Exception e) {
            showError("Unable to send message.", false);
        }
    }

    // Show the selected message in the content panel.
    private void showSelectedMessage() {
        // Show hour glass cursor while message is loaded.
        setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
        try {
            messageTextArea.setText(
                    getMessageContent(selectedMessage));
            messageTextArea.setCaretPosition(0);
        } catch (Exception e) {
            showError("Unabled to load message.", false);
        } finally {
            // Return to default cursor.
            setCursor(Cursor.getDefaultCursor());
        }
    }

  /* Update each button's state based off of whether or not
     there is a message currently selected in the table. */
    private void updateButtons() {
        if (selectedMessage != null) {
            replyButton.setEnabled(true);
            forwardButton.setEnabled(true);
            deleteButton.setEnabled(true);
        } else {
            replyButton.setEnabled(false);
            forwardButton.setEnabled(false);
            deleteButton.setEnabled(false);
        }
    }

    // Show the application window on the screen.
    public void show() {
        super.show();

        // Update the split panel to be divided 50/50.
        splitPane.setDividerLocation(.5);
    }

    // Connect to e-mail server.
    public void connect() {
        // Display connect dialog.
        ConnectDialog dialog = new ConnectDialog(this);
        dialog.show();

        // Build connection URL from connect dialog settings.
        StringBuffer connectionUrl = new StringBuffer();
        connectionUrl.append(dialog.getType() + "://");
        connectionUrl.append(dialog.getUsername() + ":");
        connectionUrl.append(dialog.getPassword() + "@");
        connectionUrl.append(dialog.getServer() + "/");

    /* Display dialog stating that messages are
       currently being downloaded from server. */
        final DownloadingDialog downloadingDialog =
                new DownloadingDialog(this);
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                downloadingDialog.show();
            }
        });

        // Establish JavaMail session and connect to server.
        Store store = null;
        try {
            // Initialize JavaMail session with SMTP server.
            Properties props = new Properties();
            props.put("mail.smtp.host", dialog.getSmtpServer());
            session = Session.getDefaultInstance(props, null);

            // Connect to e-mail server.
            URLName urln = new URLName(connectionUrl.toString());
            store = session.getStore(urln);
            store.connect();
        } catch (Exception e) {
            // Close the downloading dialog.
            downloadingDialog.dispose();

            // Show error dialog.
            showError("Unable to connect.", true);
        }

        // Download message headers from server.
        try {
            // Open main "INBOX" folder.
            Folder folder = store.getFolder("INBOX");
            folder.open(Folder.READ_WRITE);

            // Get folder's list of messages.
            Message[] messages = folder.getMessages();

            // Retrieve message headers for each message in folder.
            FetchProfile profile = new FetchProfile();
            profile.add(FetchProfile.Item.ENVELOPE);
            folder.fetch(messages, profile);

            // Put messages in table.
            tableModel.setMessages(messages);
        } catch (Exception e) {
            // Close the downloading dialog.
            downloadingDialog.dispose();

            // Show error dialog.
            showError("Unable to download messages.", true);
        }

        // Close the downloading dialog.
        downloadingDialog.dispose();
    }

    // Show error dialog and exit afterwards if necessary.
    private void showError(String message, boolean exit) {
        JOptionPane.showMessageDialog(this, message, "Error",
                JOptionPane.ERROR_MESSAGE);
        if (exit)
            System.exit(0);
    }

    // Get a message's content.
    public static String getMessageContent(Message message)
    throws Exception {
        Object content = message.getContent();
        if (content instanceof Multipart) {
            StringBuffer messageContent = new StringBuffer();
            Multipart multipart = (Multipart) content;
            for (int i = 0; i < multipart.getCount(); i++) {
                Part part = (Part) multipart.getBodyPart(i);
                if (part.isMimeType("text/plain")) {
                    messageContent.append(part.getContent().toString());
                }
            }
            return messageContent.toString();
        } else {
            return content.toString();
        }
    }

    // Run the E-mail Client.
    public static void main(String[] args) {
        EmailClient client = new EmailClient();
        client.show();

        // Display connect dialog.
        client.connect();
    }
} 
```

将 printStackTrace() 添加到异常中会显示以下消息：

```
javax.mail.NoSuchProviderException: No provider for NORMAL
at javax.mail.Session.getProvider(Session.java:464)
at javax.mail.Session.getStore(Session.java:539)
at EmailClient.connect(EmailClient.java:296)
at EmailClient.main(EmailClient.java:365) 
```

我很感激我能得到的所有帮助！

# sql-server - 包含派生表的 SQL Server 查询

> ID：14248031
> 
> 赞同：0
> 
> 时间：2013-01-09T23:00:28.030
> 
> 标签：sql-server, tsql, derived-table

我创建了一个包含一个常规表和两个派生表（子查询）的选择查询。派生表都通过左连接与常规表连接。常规表包含超过 7000 行，但查询输出约为 3000 行。它必须等于常规表中的记录数。我的错误是什么？

```
SELECT T0.[ItemCode],
T0.[ItemName],
CASE T0.[PrcrmntMtd] WHEN 'B' THEN 'Inkoop' ELSE 'Productie' END AS Verwervingsmethode,
T0.[OnHand] AS Voorraad_excl_grondstof_reeds_verwerkt,
T1.[Reeds_geproduceerd] AS Grondstof_reeds_verwerkt,
CASE WHEN T1.[Reeds_geproduceerd] IS NULL
THEN T0.[OnHand]
ELSE T0.[OnHand]-T1.[Reeds_geproduceerd]
END AS Voorraad_incl_grondstof_reeds_verwerkt,
T2.[Nog_te_produceren] AS Geplande_productie_halffabrikaat_eindproduct,
T1.[Nog_te_produceren] AS Gereserveerd_voor_productie_grondstof_halffabrikaat,
CASE WHEN T1.[Reeds_geproduceerd] IS NULL
THEN (T0.[OnHand]/T2.[Nog_te_produceren])*30
ELSE ((T0.[OnHand]-T1.[Reeds_geproduceerd])/T2.[Nog_te_produceren])*30
END AS Dagen_voorraad_halffabrikaat_eindproduct,
CASE WHEN T1.[Reeds_geproduceerd] IS NULL
THEN (T0.[OnHand]/T1.[Nog_te_produceren])*30
ELSE ((T0.[OnHand]-T1.[Reeds_geproduceerd])/T1.[Nog_te_produceren])*30
END AS Dagen_voorraad_grondstof_halffabrikaat

FROM OITM T0

LEFT JOIN (
SELECT T1.[ItemCode],
SUM(T0.[PlannedQty]*T1.[BaseQty]) AS Geplande_productie,
CASE WHEN SUM(T0.CmpltQty) IS NULL THEN SUM(T0.[PlannedQty]*T1.[BaseQty]) ELSE SUM(T0\. [CmpltQty]*T1.[BaseQty]) END AS Reeds_geproduceerd,
CASE WHEN SUM(T0.CmpltQty) IS NULL THEN SUM(T0.[PlannedQty]*T1.[BaseQty]) ELSE SUM(T0.[PlannedQty]*T1.[BaseQty])-SUM(T0.[CmpltQty]*T1.[BaseQty]) END AS Nog_te_produceren
FROM OWOR T0
INNER JOIN WOR1 T1 ON T0.DocEntry = T1.DocEntry
WHERE T0.DueDate <= getdate()+30
AND (T0.[Status] LIKE 'p'
OR T0.[Status] LIKE 'r')
GROUP BY T1.[ItemCode]
) AS T1
ON T0.ItemCode = T1.ItemCode

LEFT JOIN (
SELECT T0.[ItemCode],
SUM(T0.[PlannedQty]) AS Geplande_productie,
SUM(T0.[CmpltQty]) AS Reeds_geproduceerd,
SUM(T0.[PlannedQty])-SUM(T0.[CmpltQty]) AS Nog_te_produceren
FROM OWOR T0
INNER JOIN WOR1 T1 ON T0.DocEntry = T1.DocEntry
WHERE T0.DueDate <= getdate()+30
AND (T0.[Status] LIKE 'p'
OR T0.[Status] LIKE 'r')
GROUP BY T0.[ItemCode]
) AS T2
ON T0.ItemCode = T2.ItemCode 
```

我提到了所有的 where 子句。如果我把链接的页面变红了，那不是问题。

我还更改了派生表的表名和列名。现在所有表名和列名都是唯一的。

但仍然是同样的问题。当我删除 select 中的最后两个 case 语句时，我确实得到了所有输出行，但我在这些 case 语句中看不到任何问题。

```
SELECT T0.[ItemCode],
T0.[ItemName],
CASE T0.[PrcrmntMtd] WHEN 'B' THEN 'Inkoop' ELSE 'Productie' END AS Verwervingsmethode,
T0.[OnHand] AS Voorraad_excl_grondstof_reeds_verwerkt,
T3.[Reeds_geproduceerd_grond] AS Grondstof_reeds_verwerkt,
CASE WHEN T3.[Reeds_geproduceerd_grond] IS NULL
THEN T0.[OnHand]
ELSE T0.[OnHand]-T3.[Reeds_geproduceerd_grond]
END AS Voorraad_incl_grondstof_reeds_verwerkt,
T6.[Nog_te_produceren_eind] AS Geplande_productie_halffabrikaat_eindproduct,
T3.[Nog_te_produceren_grond] AS Gereserveerd_voor_productie_grondstof_halffabrikaat,
CASE WHEN T3.[Reeds_geproduceerd_grond] IS NULL
THEN 30*(T0.[OnHand]/T6.[Nog_te_produceren_eind])
ELSE 30*((T0.[OnHand]-T3.[Reeds_geproduceerd_grond])/T6.[Nog_te_produceren_eind])
END AS Dagen_voorraad_halffabrikaat_eindproduct,
CASE WHEN T3.[Reeds_geproduceerd_grond] IS NULL
THEN 30*(T0.[OnHand]/T3.[Nog_te_produceren_grond])
ELSE 30*((T0.[OnHand]-T3.[Reeds_geproduceerd_grond])/T3.[Nog_te_produceren_grond])
END AS Dagen_voorraad_grondstof_halffabrikaat

FROM OITM T0

LEFT JOIN (
SELECT T2.[ItemCode] AS ItemCode_grond,
SUM(T1.[PlannedQty]*T2.[BaseQty]) AS Geplande_productie_grond,
CASE WHEN SUM(T1.CmpltQty) IS NULL
THEN SUM(T1.[PlannedQty]*T2.[BaseQty])
ELSE SUM(T1.[CmpltQty]*T2.[BaseQty])
END AS Reeds_geproduceerd_grond,
CASE WHEN SUM(T1.CmpltQty) IS NULL
THEN SUM(T1.[PlannedQty]*T2.[BaseQty])
ELSE SUM(T1.[PlannedQty]*T2.[BaseQty])-SUM(T1.[CmpltQty]*T2.[BaseQty])
END AS Nog_te_produceren_grond
FROM OWOR T1
INNER JOIN WOR1 T2 ON T1.DocEntry = T2.DocEntry
WHERE T1.DueDate <= getdate()+30
AND (T1.[Status] LIKE 'p'
OR T1.[Status] LIKE 'r')
GROUP BY T2.[ItemCode]
) AS T3
ON T0.ItemCode = T3.ItemCode_grond

LEFT JOIN (
SELECT T4.[ItemCode] AS ItemCode_eind,
SUM(T4.[PlannedQty]) AS Geplande_productie_eind,
SUM(T4.[CmpltQty]) AS Reeds_geproduceerd_eind,
SUM(T4.[PlannedQty])-SUM(T4.[CmpltQty]) AS Nog_te_produceren_eind
FROM OWOR T4
INNER JOIN WOR1 T5 ON T4.DocEntry = T5.DocEntry
WHERE T4.DueDate <= getdate()+30
AND (T4.[Status] LIKE 'p'
OR T4.[Status] LIKE 'r')
GROUP BY T4.[ItemCode]
) AS T6
ON T0.ItemCode = T6.ItemCode_eind 
```

# c++ - CLOCK_MONOTONIC 和 pthread_mutex_timedlock / pthread_cond_timedwait

> ID：14248033
> 
> 赞同：20
> 
> 时间：2013-01-09T23:00:35.647
> 
> 标签：c++, c, linux, pthreads, mutex

[pthread_mutex_timedlock 文档](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_timedlock.html)说需要`abs_timeout`一个. `CLOCK_REALTIME`但是，我们都知道对特定持续时间进行计时是不合适的（由于系统时间调整）。

有没有办法让 pthread 锁定超时`CLOCK_MONOTONIC`是可移植的？pthread_cond_timedwait 也是如此。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-18T11:23:48.627

查看了文档和`pthread.h`，我找不到使用[pthread_mutex_timedlock](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_timedlock.html)`CLOCK_MONOTONIC`的方法，所以我认为这（目前）不可能。但是，对于[pthread_cond_timedwait](http://pubs.opengroup.org/onlinepubs/009604599/functions/pthread_cond_wait.html)，您可以使用如下代码：

```
pthread_condattr_t attr;
pthread_cond_t cond;
/* ... */
pthread_condattr_init(&attr);
pthread_condattr_setclock(&attr, CLOCK_MONOTONIC);
pthread_cond_init(&cond, &attr); 
```

为了清楚起见，我省略了错误代码检查，但你当然应该这样做。

我认为`CLOCK_REALTIME`使用它是因为它始终可用，而原则上`CLOCK_MONOTONIC`是可选的。另外，我想知道设置绝对超时是否可以在系统调用被信号等中断后更容易恢复。

但是，在某些情况下可以设置时钟而不是在其他情况下设置时钟似乎非常不一致 - 确实应该有一个`pthread_mutexattr_setclock()`，但可惜似乎没有。我想你只需要希望有人没有设置时钟！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-02T07:33:23.160

在 OS X 和 FreeBSD 上，您可以使用`kqueue`和`kevent`. 在这里查看我的答案：[https ://stackoverflow.com/a/31174803/432](https://stackoverflow.com/a/31174803/432)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-05T15:00:16.003

目前还没有办法在 GLIBC中更改[pthread_mutex_timedlock的时钟。](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutex_timedlock.html)可能是因为向后兼容的原因，MONOTONIC 时钟是在 REALTIME 之后推出的，所以有很多软件在使用这个功能，更换 CLOCK 可能会影响到这一点。

Linux 解决方案：

*   [您可以在此处](https://code.woboq.org/userspace/glibc/nptl/pthread_mutex_timedlock.c.html)找到 pthread_mutex_timedlock 的源代码，它基于[FUTEX](https://man7.org/linux/man-pages/man2/futex.2.html)的系统调用，默认使用 MONOTONIC。[因此，您可以使用本文](http://www.rkoucha.fr/tech_corner/the_futex.html)实现自己的互斥锁，这可能是一个很好且强大的解决方案。

# actionscript-3 - 1180：调用可能未定义的方法 Player

> ID：14248034
> 
> 赞同：1
> 
> 时间：2013-01-09T23:00:36.577
> 
> 标签：actionscript-3, flash

我试图将下面的代码编码到来自教程的包中，但它最初在时间轴中

现在它给出错误 1180：调用可能未定义的方法 Player。

这是相关代码的片段（完整代码在下面）

```
private var player:Player;

    public function RamboCat() 
    {

    player = new Player(); 
```

所以 Player 没有定义。这是否意味着它缺少 AS 文件或其他东西但我试图告诉 flash 使用图像（图像是实例化的“播放器”）

我添加了上面的代码（减去已经存在的公共函数），因为我找到了一个解释我应该添加这些的源：[http ://www.actionscript.org/forums/showthread.php3?t=268065](http://www.actionscript.org/forums/showthread.php3?t=268065)

我对“打包”和“导入”事物的体验有点低。所以希望你能提供帮助。

```
package 
{
import flash.display.MovieClip;
import flash.events.*;
import flash.geom.Point;

public class RamboCat extends MovieClip 
{
    var leftPressed:Boolean = false;
    var rightPressed:Boolean = false;
    var upPressed:Boolean = false;
    var downPressed:Boolean = false;

    var leftBumping:Boolean = false;
    var rightBumping:Boolean = false;
    var upBumping:Boolean = false;
    var downBumping:Boolean = false;

    var leftBumpPoint:Point = new Point(-30, -55);
    var rightBumpPoint:Point = new Point(30, -55);
    var upBumpPoint:Point = new Point(0, -120);
    var downBumpPoint:Point = new Point(0, 0);

    var scrollX:Number = 0;
    var scrollY:Number = 500;

    var xSpeed:Number = 0;
    var ySpeed:Number = 0;

    var speedConstant:Number = 4;
    var frictionConstant:Number = 0.9;
    var gravityConstant:Number = 1.8;
    var jumpConstant:Number = -35;
    var maxSpeedConstant:Number = 18;

    var doubleJumpReady:Boolean = false;
    var upReleasedInAir:Boolean = false;

    var keyCollected:Boolean = false;
    var doorOpen:Boolean = false;

    var currentLevel:int = 1;

    var animationState:String = "idle";

    var bulletList:Array = new Array();
    var enemyList:Array = new Array();
    var bumperList:Array = new Array();

    private var player:Player;

    public function RamboCat() 
    {

    player = new Player();

    stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);
    stage.addEventListener(KeyboardEvent.KEY_UP, keyUpHandler);

    stage.addEventListener(Event.ENTER_FRAME, loop);

    addEnemiesToLevel1();
    addBumpersToLevel1();
    }
    public function addEnemiesToLevel1():void
{
addEnemy(620, -115);
addEnemy(900, -490);
addEnemy(2005, -115);
addEnemy(1225, -875);
}

    public function addBumpersToLevel1():void
{
addBumper(500, -115);
addBumper(740, -115);
}

    public function loop(e:Event):void{
if(back.collisions.hitTestPoint(player.x + leftBumpPoint.x, player.y + leftBumpPoint.y, true)){
    //trace("leftBumping");
    leftBumping = true;
} else {
    leftBumping = false;
}

if(back.collisions.hitTestPoint(player.x + rightBumpPoint.x, player.y + rightBumpPoint.y, true)){
    //trace("rightBumping");
    rightBumping = true;
} else {
    rightBumping = false;
}

if(back.collisions.hitTestPoint(player.x + upBumpPoint.x, player.y + upBumpPoint.y, true)){
    //trace("upBumping");
    upBumping = true;
} else {
    upBumping = false;
}

if(back.collisions.hitTestPoint(player.x + downBumpPoint.x, player.y + downBumpPoint.y, true)){
    //trace("downBumping");
    downBumping = true;
} else {
    downBumping = false;
}   

if(leftPressed){
    xSpeed -= speedConstant;
    player.scaleX = -1;

} else if(rightPressed){
    xSpeed += speedConstant;
    player.scaleX = 1;
}

 /*if(upPressed){
ySpeed -= speedConstant;

} else if(downPressed){
ySpeed += speedConstant;

}*/

if(leftBumping){
    if(xSpeed < 0){
        xSpeed *= -0.5;
    }
}

if(rightBumping){
    if(xSpeed > 0){
        xSpeed *= -0.5;
    }
}

if(upBumping){
    if(ySpeed < 0){
        ySpeed *= -0.5;
    }
}

if(downBumping){ //if we are touching the floor
    if(ySpeed > 0){ 
        ySpeed = 0; //set the y speed to zero
    }
    if(upPressed){ //and if the up arrow is pressed
        ySpeed = jumpConstant; //set the y speed to the jump constant
    }

    //DOUBLE JUMP
    if(upReleasedInAir == true){
        upReleasedInAir = false;
    }
    if(doubleJumpReady == false){
        doubleJumpReady = true;
    }
} else { //if we are not touching the floor

    ySpeed += gravityConstant; //accelerate downwards

    //DOUBLE JUMP
    if(upPressed == false && upReleasedInAir == false){
        upReleasedInAir = true;
        //trace("upReleasedInAir");
    }
    if(doubleJumpReady && upReleasedInAir){
        if(upPressed){ //and if the up arrow is pressed
            //trace("doubleJump!");
            doubleJumpReady = false;
            ySpeed = jumpConstant; //set the y speed to the jump constant
        }
    }

}

if(keyCollected == false){
    if(player.hitTestObject(back.other.doorKey)){
        back.other.doorKey.visible = false;
        keyCollected = true;
        trace("key collected");
    }
}

if(doorOpen == false){
    if(keyCollected == true){
        if(player.hitTestObject(back.other.lockedDoor)){
            back.other.lockedDoor.gotoAndStop(2);
            doorOpen = true;
            trace("door open");
        }
    }
}

if(xSpeed > maxSpeedConstant){ //moving right
    xSpeed = maxSpeedConstant;
} else if(xSpeed < (maxSpeedConstant * -1)){ //moving left
    xSpeed = (maxSpeedConstant * -1);
}

xSpeed *= frictionConstant;
ySpeed *= frictionConstant;

if(Math.abs(xSpeed) < 0.5){
    xSpeed = 0;
}

scrollX -= xSpeed;
scrollY -= ySpeed;

back.x = scrollX;
back.y = scrollY;

sky.x = scrollX * 0.2;
sky.y = scrollY * 0.2;

if( ( leftPressed || rightPressed || xSpeed > speedConstant || xSpeed < speedConstant *-1 ) && downBumping){
    animationState = "running";
} else if(downBumping){
    animationState = "idle";
} else {
    animationState = "jumping";
}

if(player.currentLabel != animationState){
    player.gotoAndStop(animationState);
}

if (enemyList.length > 0) // if there are any enemies left in the enemyList
{
    for (var i:int = 0; i < enemyList.length; i++) // for each enemy in the enemyList
    {
        if (bulletList.length > 0) // if there are any bullets alive
        {
            for (var j:int = 0; j < bulletList.length; j++) // for each bullet in the bulletList
            {
                if ( enemyList[i].hitTestObject(bulletList[j]) )
                {
                    trace("Bullet and Enemy are colliding");
                    enemyList[i].removeSelf();
                    bulletList[j].removeSelf();
                }

                // enemyList[i] will give you the current enemy
                // bulletList[j] will give you the current bullet
                // this will check all combinations of bullets and enemies
                // and see if any are colliding
            }
        }
    }
}

 //corralling the bad guys with bumpers
if (enemyList.length > 0){ //enemies left in the enemyList?
    for (var k:int = 0; k < enemyList.length; k++){ // for each enemy in the enemyList
        if (bumperList.length > 0){
            for (var h:int = 0; h < bumperList.length; h++){ // for each bumper in the List
                if ( enemyList[k].hitTestObject(bumperList[h]) ){
                    enemyList[k].changeDirection();
                    }
                }
            }
        }
    }

 //player and enemy collisions
if (enemyList.length > 0){ //enemies left?
    for (var m:int = 0; m < enemyList.length; m++){ // for each enemy in the enemyList
        if ( enemyList[m].hitTestObject(player) ){
            trace("player collided with enemy");
            //code to damage player goes here, maybe integrate with a health bar?                           
            enemyList[m].removeSelf();
        }
    }
}

 }

    public function nextLevel():void{
currentLevel++;
trace("Next Level: " + currentLevel);
if(currentLevel == 2){
   gotoLevel2();
}
// can be extended...
// else if(currentLevel == 3) { gotoLevel3(); } // etc, etc.    
}

    public function gotoLevel2():void{
back.other.gotoAndStop(2);
back.visuals.gotoAndStop(2);
back.collisions.gotoAndStop(2);
scrollX = 0;
scrollY = 500;

keyCollected = false;
back.other.doorKey.visible = true;
doorOpen = false;
back.other.lockedDoor.gotoAndStop(1);
}

    public function keyDownHandler(e:KeyboardEvent):void{
if(e.keyCode == Keyboard.LEFT){
    leftPressed = true;

} else if(e.keyCode == Keyboard.RIGHT){
    rightPressed = true;

} else if(e.keyCode == Keyboard.UP){
    upPressed = true;

} else if(e.keyCode == Keyboard.DOWN){
    downPressed = true;
    if(doorOpen && player.hitTestObject(back.other.lockedDoor)){
        //proceed to the next level if the player is touching an open door
        nextLevel();
    }
}
}

    public function keyUpHandler(e:KeyboardEvent):void{
if(e.keyCode == Keyboard.LEFT){
    leftPressed = false;

} else if(e.keyCode == Keyboard.RIGHT){
    rightPressed = false;

} else if(e.keyCode == Keyboard.UP){
    upPressed = false;

} else if(e.keyCode == Keyboard.DOWN){
    downPressed = false;
}

if(e.keyCode == Keyboard.SPACE){
    fireBullet();
}
 }

    public function fireBullet():void
{
var playerDirection:String;
if(player.scaleX < 0){
    playerDirection = "left";
} else if(player.scaleX > 0){
    playerDirection = "right";
}
var bullet:Bullet = new Bullet(player.x - scrollX, player.y - scrollY, playerDirection, xSpeed);
back.addChild(bullet);

bullet.addEventListener(Event.REMOVED, bulletRemoved);
bulletList.push(bullet);

 }

    public function bulletRemoved(e:Event):void
 {
e.currentTarget.removeEventListener(Event.REMOVED, bulletRemoved); //this just removes the eventListener so we don't get an error
bulletList.splice(bulletList.indexOf(e.currentTarget), 1); 
 //this removes 1 object from the bulletList, at the index of whatever object caused this function to activate
 }

    public function addEnemy(xLocation:int, yLocation:int):void
 {
var enemy:Enemy = new Enemy(xLocation, yLocation);
back.addChild(enemy);
enemy.addEventListener(Event.REMOVED, enemyRemoved);
enemyList.push(enemy);
 }

    public function addBumper(xLocation:int, yLocation:int):void
 {
var bumper:Bumper = new Bumper(xLocation, yLocation);
back.addChild(bumper);
bumper.visible = false;
bumperList.push(bumper);
 }

    public function enemyRemoved(e:Event):void
 {
e.currentTarget.removeEventListener(Event.REMOVED, enemyRemoved);
  //this just removes the eventListener so it doesn't give an error
enemyList.splice(enemyList.indexOf(e.currentTarget), 1); //this removes 1 object from the enemyList, at the index of whatever object caused this function to activate
 }
}
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:08:45.343

它不能作为对 player 实例的引用：`new Player();`创建一个新的 Player 实例。

所以 Player 需要是一个类。如果您使用的是 Adob​​e Flash Professional，您可以右键单击库中的图像，单击属性，动作脚本选项卡，然后导出到动作脚本（确保该类名为 Player）。这将为您创建图像的类。

如果您使用的不是 Adob​​e Flash Professional，请告诉我，我会帮助您使用 IDE。

编辑：回首往事，如果您还没有完成，您还需要导入键盘类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:16:34.367

看起来你需要一个 Player 的导入声明。

要导入单个类：

```
import your.package.name.ClassName; 
```

要导入包中的每个类：

```
import your.package.name.*; 
```

所以你需要：

```
import xxx.Player; 
```

其中 xxx 是 Player 类所在的包。

# c++ - QComboBox 不显示其项目列表

> ID：14248036
> 
> 赞同：2
> 
> 时间：2013-01-09T23:00:47.840
> 
> 标签：c++, qt, qtablewidget, qgraphicsscene, qcombobox

我对 QComboBox 作为 QTableWidget 的项目委托编辑器有疑问。QTableWidget 使用 SqlTypeDelegate 作为项目委托。

当我在 QGraphicsScene（通过 QGraphicsProxyWidget）中绘制 QTableWidget 时，不会显示可用项目的 QComboBox 弹出列表。但是，如果我将 QTableWidget 用作普通小部件（不是通过 QGraphicsScene\View 绘制的），那么 QComboBox 的行为是正常的 - 它显示项目列表。

我应该怎么做才能强制 QComboBox 显示其项目列表？

下面的示例代码：

主.cpp：

```
#include <QtGui/QApplication>
#include <QGraphicsScene>
#include <QGraphicsView>
#include <QTableWidget>
#include "sqltypedelegate.h"

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    QGraphicsScene scene;
    QTableWidget *table = new QTableWidget(4,2);
    table->setItemDelegate(new SqlTypeDelegate(table));
    QGraphicsProxyWidget *proxy = scene.addWidget(table);
    QGraphicsView view(&scene);
    view.show();
    return app.exec();
} 
```

sqltypedelegate.h：

```
#include <QItemDelegate>
#include <QStyledItemDelegate>
#include <QModelIndex>
#include <QObject>
#include <QSize>
#include <QComboBox>

class SqlTypeDelegate : public QItemDelegate
{
    Q_OBJECT
public:
    SqlTypeDelegate(QObject *parent = 0);
    QWidget *createEditor(QWidget *parent, const QStyleOptionViewItem &option,
                          const QModelIndex &index) const;
    void setEditorData(QWidget *editor, const QModelIndex &index) const;
    void setModelData(QWidget *editor, QAbstractItemModel *model,
                      const QModelIndex &index) const;
    void updateEditorGeometry(QWidget *editor,
        const QStyleOptionViewItem &option, const QModelIndex &index) const;
}; 
```

sqltypedelegate.cpp：

```
#include <QtGui>
#include "sqltypedelegate.h"

SqlTypeDelegate::SqlTypeDelegate(QObject *parent)
    : QItemDelegate(parent)
{}

QWidget *SqlTypeDelegate::createEditor(QWidget *parent,
    const QStyleOptionViewItem &/* option */,
    const QModelIndex &/* index */) const
{
    QComboBox *editor = new QComboBox(parent);
    editor->addItem(QString("decimal(50)"));
    editor->addItem(QString("integer"));
    editor->addItem(QString("varchar(50)"));
    editor->addItem(QString("char"));

    editor->setEditable(true);
    return editor;
}

void SqlTypeDelegate::setEditorData(QWidget *editor,
                                    const QModelIndex &index) const
{
    QString value = index.model()->data(index, Qt::EditRole).toString();
    QComboBox *comboBox = static_cast<QComboBox*>(editor);
    comboBox->setEditText(value);
}

void SqlTypeDelegate::setModelData(QWidget *editor, QAbstractItemModel *model,
                                   const QModelIndex &index) const
{
    QComboBox *comboBox = static_cast<QComboBox*>(editor);
    model->setData(index, comboBox->currentText(), Qt::EditRole);
}

void SqlTypeDelegate::updateEditorGeometry(QWidget *editor,
    const QStyleOptionViewItem &option, const QModelIndex &/* index */) const
{
    QComboBox *comboBox = static_cast<QComboBox*>(editor);
    comboBox->setGeometry(option.rect);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T12:24:04.630

最后我找到了解决方案：事件过滤器！潜伏在 QEvent::MouseButtonRelease 中，然后调用 showPopup。

```
bool SqlTypeDelegate::eventFilter(QObject *object, QEvent *event)
{
    QComboBox * comboBox = dynamic_cast<QComboBox*>(object);
    if (comboBox)
    {
        if (event->type() == QEvent::MouseButtonRelease)
        {
            comboBox->showPopup();
            return true;
        }
    }
    else
    {
        return QItemDelegate::eventFilter( object, event );
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T04:07:05.347

我遇到了同样的问题，我的解决方法是在 createEditor(...) 中添加两行代码。

```
editor->move(option.rect.x(),option.rect.y());
editor->showPopup(); 
```

然后双击表格项时，QComboBox会显示第二次鼠标按键触发的弹出项，隐藏鼠标第二次释放触发的弹出项。这适用于 Qt 4.8。

我还尝试了 Qt5.0，无论有没有这种解决方法，应用程序都崩溃了。我已将此问题报告为错误。

# bash - Bash Script - 在变量中存储不带空格的查找命令输出

> ID：14248039
> 
> 赞同：5
> 
> 时间：2013-01-09T23:01:05.847
> 
> 标签：bash

我正在寻找自动化我的 xcode 项目。除了带有空格的项目名称外，一切正常。我尝试了以下命令：

```
output_apps=`find ./ -name "*.app" -print`
output_apps=`find ./ -name "*.app"` 
```

当我跑

```
find ./ -name "*.app" -print 
```

如果不存储到变量中，它会按预期给我输出，如下所述：

```
.//Ten EU.app
.//Ten Official App EU.app
.//Ten Official App.app
.//Ten.app 
```

但是，当我将上述命令的输出存储在如下变量中时

```
output_apps=`find ./ -name "*.app" -print` 
```

然后运行以下 for 循环以获取名称

```
for curr_app in $o
do 
    echo "$curr_app"
done 
```

表明

```
.//Ten
EU.app
.//Ten
Official
App
EU.app
.//Ten
Official
App.app
.//Ten.app 
```

如何保持每个输出之间的空格并获得以下输出？

```
Ten EU.app
Ten Official App EU.app
Ten Official App.app
Ten.app 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-10T00:11:32.770

如果您不需要将文件名存储在变量中，则可以[`find -print0`](http://linux.die.net/man/1/find)与[`xargs -0`](http://linux.die.net/man/1/xargs). 这用 NUL 字节而不是换行符分隔找到的条目。`xargs`读取这些 NUL 分隔值并使用尽可能多的参数调用一些命令。

```
find ./ -name "*.app" -print0 | xargs -0 some-command 
```

如果你愿意，你可以限制给`some-command`with的参数数量`xargs -n 1`

```
find ./ -name "*.app" -print0 | xargs -0 -n 1 some-command 
```

另一种方法是使用`while`循环读取文件

```
find ./ -name "*.app" -print | while read f; do
    some-command "$f"
done 
```

这一次调用一个带有一个文件的命令。重要的一点是用[双引号括](http://www.gnu.org/software/bash/manual/bashref.html#Double-Quotes)`$f`起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:03:55.157

文件名可能包含空格。您需要通过 find 要求将它们分开`NULL(\0)`。使用`find -print0`.

# asp.net - RequestSecurityToken 使用 Windows 凭据和 .net 4.5 WIF

> ID：14248040
> 
> 赞同：8
> 
> 时间：2013-01-09T23:01:11.277
> 
> 标签：asp.net, security, .net-4.5, wif

任何人都可以指出使用 NT 凭证主动发出 RequestSecurityToken 的示例代码 `Thread.CurrentPrincipal as ClaimsPrincipal`吗？

该场景是一个启用了 Windows 身份验证的 asp.net Web 应用程序（因此有一个经过身份验证的 WindowsIdentity）。我的愿望是主动调用 STS 而不是启用被动重定向，并使用 .Net 4.5 身份库来执行此操作。

大多数代码示例（例如[Windows Phone 的声明帮助程序](http://blogs.objectsharp.com/post/2011/03/04/Claims-Authentication-Helper-Class-for-the-Windows-Phone-7.aspx)或[使用活动 STS](http://koenwillemse.wordpress.com/2010/08/02/making-a-web-application-use-an-active-sts/)）使用用户名/密码输入和 UserNameWSTrustBinding 设置凭据。

我认为解决方案可能涉及模拟或调用`channelFactory.CreateChannelWithActAsToken()`从 Windows 身份创建的令牌。

-- 以下 .Net4.5 代码在访问 /adfs/services/trust/13/windowsmixed 端点时确实获得了 GenericXmlSecurityToken。但是，声明适用于运行站点的域帐户，而不是经过身份验证的用户的域帐户。当我将端点切换到 /adfs/services/trust/13/kerberossmixed 时，我收到一些问题和论坛中记录的“无法协商”错误，但我无法将任何提供的解决方案应用于 .Net 4.5。未从 Microsoft.IdentityModel 移植的类之一是 KerberosWSTrustBinding...

```
public static void CallSts()
{
    try
    {
        var wsMod = FederatedAuthentication.WSFederationAuthenticationModule;
        var appliesToEp = new EndpointReference(wsMod.Realm);
        var stsEp = new EndpointAddress(new Uri(wsMod.Issuer), EndpointIdentity.CreateSpnIdentity("stsSpn"));

        var msgBinding = new WS2007HttpBinding(SecurityMode.TransportWithMessageCredential, false);
        msgBinding.Security.Message.EstablishSecurityContext = false;
        msgBinding.Security.Message.ClientCredentialType = MessageCredentialType.Windows;

        using(var factory = new WSTrustChannelFactory(msgBinding, stsEp))
        {
            factory.Credentials.SupportInteractive = false;
            factory.TrustVersion = TrustVersion.WSTrust13;

            var myRst = new RequestSecurityToken
            {
                RequestType = RequestTypes.Issue,
                AppliesTo = appliesToEp,
                KeyType = KeyTypes.Bearer,
            };
                var channel = factory.CreateChannel();
                var stsToken = channel.Issue(myRst) as GenericXmlSecurityToken;

                if(stsToken != null)
                {
                    Log.DebugFormat("Reply Token is {0}", stsToken.GetType().Name);

                    var handlers = FederatedAuthentication.FederationConfiguration.IdentityConfiguration.SecurityTokenHandlers;
                    var token = handlers.ReadToken(new XmlTextReader(new StringReader(stsToken.TokenXml.OuterXml)));
                    var identity = handlers.ValidateToken(token).First();
                    //TODO write to session
                }
                else
                {
                    Log.Debug("Reply Token is null.");
                }
        }
    }
    catch(Exception ex)
    {
        Log.Error("Rst.Call has failed", ex);
    }
} 
```

对于@leastprivilege 建议，我添加以下代码：

```
 var user = Thread.CurrentPrincipal as ClaimsPrincipal;
var winId = user.Identity as WindowsIdentity;
if(winId != null)
{
    // shows my domain account after I was prompted for credentials;
    // my domain account does not exist on the client machine, so it is a true domain credential
    Log.DebugFormat("WindowsIdentity Name is {0}", winId.Name);
}
using(winId.Impersonate())
{
    // again, shows my domain account
    Log.DebugFormat("Impersonation Context {0}", WindowsIdentity.GetCurrent(true).Name);
    var channel = factory.CreateChannel();
    var stsToken = channel.Issue(myRst) as GenericXmlSecurityToken;
    // request is issued, but results in SecurityNegotiationException: The caller was not authenticated by the service.
} 
```

失败并显示“调用者未经服务验证”。相同的 STS 将在被动重定向场景中验证我的域帐户......所以虽然我知道我做错了什么，但应该识别帐户本身。

* * *

**更新：**

我收到通知说这个问题获得了相当多的意见，因此我将提供以下解决方法：虽然我们配置了我们的服务器以进行委派（如下 Dominick 建议的那样），但我们仍然没有克服双跳问题。如果我记得，我们在本地 IT 之上的简单网络管理策略遇到了任何企业都可能遇到的障碍。因此，虽然不允许使用 Windows 身份验证通过双跃点模拟服务器，但可以使用基本身份验证通过双跃点模拟凭据。这可能是可接受的情况，也可能不是可接受的情况（我们的情况是内联网）。如果你这样做，你会添加

```
msgBinding.Security.Message.NegotiateServiceCredential = true; 
```

到上面的 ChannelBinding 配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T07:09:09.567

嗯 - 这实际上不是微不足道的。为此，您需要进行 Kerberos 模拟和委派。

首先是模仿。您需要在从 Thread.CurrentPrincipal 获得的 WindowsIdentity 上调用 Impersonate()。

您可以通过调用 WindowsIdentity.GetCurrent 来确保您正在模拟。这个身份必须指向客户端（而不是服务器身份）。

然后在模拟时您需要发出 WS-Trust 请求。默认情况下，这很可能是不允许的。因此，您的网络管理员需要为 STS 的服务器身份配置委派。

# android - 传递 Parcelable 数据时出现空指针错误

> ID：14248042
> 
> 赞同：1
> 
> 时间：2013-01-09T23:01:33.930
> 
> 标签：android, android-intent, nullpointerexception, runtime-error, parcelable

我正在尝试在两个活动之间传递一个订单对象。此对象包含 MenuItems 的 ArrayList。Order 的类如下：（它实现了 parcelable 接口）。

```
public class Order extends ArrayList <MenuItem> implements Parcelable {

private int covers;
private int table;
//To hold MenuItems
private ArrayList<MenuItem> items;

public Order(){

}

public static final Parcelable.Creator<Order> CREATOR = new Parcelable.Creator<Order>() {

    @Override
    public Order createFromParcel(Parcel source) {
        return new Order(source);
    }

    @Override
    public Order[] newArray(int size) {
        return new Order[size];
    }

};

public Order(int covers, int table, ArrayList<MenuItem> items) {
    super();
    this.covers = covers;
    this.table = table;
    this.items = items;
}

public int getCovers() {
    return covers;
}

public void setCovers(int covers) {
    this.covers = covers;
}

public int getTable() {
    return table;
}

public void setTable(int table) {
    this.table = table;
}

public ArrayList<MenuItem> getItems() {
    return items;
}

public void setItems(ArrayList<MenuItem> items) {
    this.items = items;
}

//add menu item to order
public void addToOrder(MenuItem m){
    items.add(m);
}

//remove menu item from order
public void removeFromOrder(MenuItem m){
    items.remove(m);
}

public Order(Parcel source) {
    readFromParcel(source); 
```

}

```
private void readFromParcel(Parcel source) {

    this.clear();

    //read the size of the list
    int size = source.readInt();

    //Remember order of items written into the Parcel. Important here.
    for(int i = 0; i < size; i ++){
        MenuItem item = new MenuItem();
        item.setName(source.readString());
        item.setPrice(source.readDouble());
        this.add(item);
} 
```

}

```
@Override
public void writeToParcel(Parcel dest, int arg1) {
        int size = this.size();

                dest.writeInt(size);

                for(int i = 0; i < size; i ++){
                    MenuItem item = this.get(i);
                    dest.writeString(item.getName());
                    dest.writeDouble(item.getPrice());

                }

            }

@Override
public int describeContents() {
    // TODO Auto-generated method stub
    return 0;
} 
```

}

当我的活动开始时，我创建一个新的订单项目并将其放入 Intent 以发送到下一个活动。当我单击按钮开始新活动时，我收到以下错误：

**java.lang.RuntimeException：无法启动活动 ComponentInfo{com.example.waitron5/com.example.waitron5.SectionsActivity}：java.lang.NullPointerException**

下面是我在 MainActivity.java 中用于将对象放入 Intent 的代码。

```
//Order object to hold details about order for duration of session
Order order;
ArrayList<Order> orderList;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //As soon as app is started up create an order object.
    order = new Order();
    orderList = new ArrayList<Order>();
    orderList.add(order);

    //reference to button and add listeners
    orderBtn = (Button)findViewById(R.id.orderBtn);
    orderBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            //Create a new intent and start up the sections activity...
            i = new Intent(v.getContext(), SectionsActivity.class);
            i.putExtra("data", (ArrayList<Order>)orderList);
            startActivity(i);
        }
    });

} 
```

下面是我在 SectionsActivity.java 中使用的代码，用于从 Intent 中检索我的对象。

```
//Get order information
public void getOrderData(){
    i = getIntent();
    if(i != null && i.hasExtra("data")){
        Toast.makeText(this.getApplicationContext(), "recieved", Toast.LENGTH_SHORT).show();
        order = i.getParcelableExtra("data");
        int size = order.size();
        Toast.makeText(this.getApplicationContext(), String.valueOf(size), Toast.LENGTH_SHORT).show();
    }
} 
```

有谁知道我为什么会收到这个错误。我知道这是因为它找不到可包裹的对象，我只是不知道我应该如何修复它！非常感谢。

编辑：我认为问题出在这段代码中：

```
@Override
public void writeToParcel(Parcel dest, int flags) {
        int size = this.size();
                dest.writeInt(size);
                for(int i = 0; i < size; i ++){
                    MenuItem item = this.get(i);
                    dest.writeString(item.getName());
                    dest.writeDouble(item.getPrice());

                }

            } 
```

记录 CAT 错误

*01-09 23:41:23.706: E/AndroidRuntime(22717): 致命异常: main 01-09 23:41:23.706: E/AndroidRuntime(22717): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com. example.waitron5/com.example.waitron5.SectionsActivity}：java.lang.NullPointerException 01-09 23:41:23.706：E/AndroidRuntime(22717)：在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180) 01 -09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app .ActivityThread.access$600(ActivityThread.java:141) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234) 01-09 23: 41:23.706: E/AndroidRuntime(22717): 在 android.os.Handler.dispatchMessage(Handler.java:99) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.os.Looper.loop(Looper.java:137) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在android.app.ActivityThread.main(ActivityThread.java:5039) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 java.lang.reflect.Method.invokeNative(Native Method) 01-09 23:41 :23.706: E/AndroidRuntime(22717): at java.lang.reflect.Method.invoke(Method.java:511) 01-09 23:41:23.706: E/AndroidRuntime(22717): at com.android.internal。 os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) 01-09 23:41:23.706: E/AndroidRuntime(22717): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) 01 -09 23:41:23.706: E/AndroidRuntime(22717): at dalvik.system.NativeStart.main(Native Method) 01-09 23:41:23.706: E/AndroidRuntime(22717): Caused by: java.lang. NullPointerException 01-09 23:41:23.706:E/AndroidRuntime(22717): 在 com.example.waitron5.SectionsActivity.getOrderData(SectionsActivity.java:113) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 com.example.waitron5.SectionsActivity.onCreate (SectionsActivity.java:44) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.Activity.performCreate(Activity.java:5104) 01-09 23:41:23.706: E/AndroidRuntime (22717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) 01-09 23:41:23.706: E/AndroidRuntime(22717): ... 11 更多onCreate(SectionsActivity.java:44) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.Activity.performCreate(Activity.java:5104) 01-09 23:41:23.706: E/ AndroidRuntime(22717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144 ) 01-09 23:41:23.706: E/AndroidRuntime(22717): ... 11 更多onCreate(SectionsActivity.java:44) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.Activity.performCreate(Activity.java:5104) 01-09 23:41:23.706: E/ AndroidRuntime(22717): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080) 01-09 23:41:23.706: E/AndroidRuntime(22717): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144 ) 01-09 23:41:23.706: E/AndroidRuntime(22717): ... 11 更多E/AndroidRuntime(22717): ... 11 更多E/AndroidRuntime(22717): ... 11 更多*

记录猫警告

* **01-09 23:41:23.676：W/Bundle(22717)：关键数据预期 Parcelable，但值是 java.util.ArrayList。已返回默认值。** 01-09 23:41:23.686: W/Bundle(22717): 尝试转换生成的内部异常: 01-09 23:41:23.686: W/Bundle(22717): java.lang.ClassCastException: java.util.ArrayList无法转换为 android.os.Parcelable 01-09 23:41:23.686: W/Bundle(22717): at android.os.Bundle.getParcelable(Bundle.java:1171) 01-09 23:41:23.686: W /Bundle(22717): 在 android.content.Intent.getParcelableExtra(Intent.java:4330) 01-09 23:41:23.686: W/Bundle(22717): 在 com.example.waitron5.SectionsActivity.getOrderData(SectionsActivity. java:112) 01-09 23:41:23.686: W/Bundle(22717): 在 com.example.waitron5.SectionsActivity.onCreate(SectionsActivity.java:44) *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T01:36:14.310

我设法解决了我的问题。问题是 Order 类正在实现 Parcelable 。然而，因为它包含一个 MenuItem 列表，MenuItem 类也需要实现 Parcelable 接口。

一旦我这样做了，问题就解决了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T23:17:06.653

查看完整的 LogCat 堆栈跟踪以*准确*了解错误发生的位置会非常有帮助，但我可以立即看到一个潜在问题。

您的默认构造函数不调用超级构造函数：

```
public Order(){

} 
```

因此，当`writeToParcel()`被调用时，您尝试从可能是空列表中获取值。

```
MenuItem item = this.get(i); // You never initialized the super class... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:17:54.260

改变`i = getIntent();`

经过

```
i = getIntent().getCharSequenceArrayListExtra("data"); 
```

更新以获取 ArrayList

# php - 使用 AJAX 的 PDO 连接池

> ID：14248043
> 
> 赞同：2
> 
> 时间：2013-01-09T23:01:42.120
> 
> 标签：php, mysql, time, pdo, connection-pooling

我不知道 PDO 的连接池是如何工作的，而且搜索也无处可去。

首先，为了清楚起见，PDO 的连接池是自动的吗？

如果没有，我如何在 AJAX 页面上使用它？

我已经计算了本地 wampserver 开发人员通过 mysqli 以每 10 毫秒建立数据库连接的时间成本，并且我试图将等待时间尽可能接近 0。这是我最后的问题之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T10:25:03.107

如果您正在谈论持久连接，请看这里： http: [//php.net/manual/en/pdo.connections.php](http://php.net/manual/en/pdo.connections.php)

> 持久连接是否在不同的 AJAX 请求中保持打开状态？

是的，而且它们永远不会被重复使用的风险。感谢@carefulnow。我将在这里引用他的评论：

> 持久连接和连接池不是一回事 连接池首先会创建大量连接，然后应用程序只会抓取其中一个已经建立的连接。持久连接确实会建立新连接，但除非明确告知，否则它们不会关闭（正常连接将在脚本结束时关闭）。如果不小心使用持久连接是危险的，因为大多数数据库都实现了最大连接数，并且在命中时会拒绝进一步的连接。在大多数情况下，正常的连接（只需使用 DSN 和登录详细信息调用 PDO 构造函数）就可以了。
> 
> 我将通过显示 PHP 代码以及 MariaDB 控制台监视器中生成的连接数来解释它。看下面的截图，注意右下角的“run count”。您会看到使用持久连接时，连接不会关闭，而是进入睡眠模式。忽略连接#231，这是控制台监视器的。 [http://i.imgur.com/IL42tjF.png](https://i.imgur.com/IL42tjF.png)，[http://i.imgur.com/aDvl7F7.png](https://i.imgur.com/aDvl7F7.png)，[http://i.imgur.com/IuFEEvO.png](https://i.imgur.com/IuFEEvO.png)。如您所见，时间列表示不活动的长度，而不是连接的时间长度，因此控制台监视器的时间始终为零，因为我刚刚执行了 SHOW PROCESSLIST;。我希望这能让一切都清楚一点，数据库连接管理有时非常棘手。

所以看截图，问题是开放的，如何再次拾取这些持久连接。StackOverflow 上的一些答案说，它们是在线程级别缓存的，所以如果你有多个线程（这是非常值得期待的），那么你会得到很多连接。这会带来遇到 mysql 连接限制的风险。在使用持久连接之前，请确保您了解它们是如何工作的（我不知道，但似乎 @carefulnow :-)）

> 是否可以将持久连接设置为过期？

PHP doc 说它们被缓存了，因此我认为它们会在一段时间后被清理。

[更多关于 php 文档](http://php.net/manual/en/features.persistent-connections.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-09T05:53:46.663

同样在@fabian 提供的同一[链接上，您可以看到以下内容：](http://www.php.net/manual/en/pdo.connections.php)

```
<?php
$dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass, array(
    PDO::ATTR_PERSISTENT => true
));
?>

Note: If you wish to use persistent connections, you must set PDO::ATTR_PERSISTENT in the array of driver options passed to the PDO constructor. If setting this attribute with PDO::setAttribute() after instantiation of the object, the driver will not use persistent connections. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-18T14:51:09.963

Pdo persistent 使用带有多个 mysql 请求的 any URL 作为一个连接。如果页面重新加载或使用 pdo 连接访问任何其他 php 页面，则只会建立新的 pdo 连接。我们需要已经在服务器中创建的静态 SQL 连接并将其重用于页面。就像页面加载之前的全局声明一样。只能使用带有 express 的 node mysql 包。在 express js 中，我们可以将 mysql 池连接配置为全局声明。

您可以将 nodejs 中的连接池与 mysql 和 express npm modules 一起使用。并在 node 中设置一个 http 服务器，然后在 post 请求中通过[http://127.0.0.1:1000/getdata](http://127.0.0.1:1000/getdata)之类的**API向表达服务器发出请求。**然后使用 php 作为 getter，使用带有流上下文的 file() 方法来创建发布请求。不要使用 curl，因为执行需要更多时间。使用 while 语句检查 express js 服务器返回的数据

这篇文章是我通过手机创建的，所以我无法给出解释代码以供使用。如果有人需要示例代码。我将发布到 GitHub 存储库。分享您的评论

# c++ - “匿名结构”是标准的吗？而且，真的，他们*是*什么？

> ID：14248044
> 
> 赞同：61
> 
> 时间：2013-01-09T23:01:49.573
> 
> 标签：c++

MSDN[认为](http://msdn.microsoft.com/en-us/library/z2cx9y4f.aspx)匿名结构在 C++ 中是非标准的：

> Microsoft C 扩展允许您在另一个结构中声明结构变量而无需为其命名。这些嵌套结构称为匿名结构。C++ 不允许匿名结构。
> 
> 您可以像访问包含结构中的成员一样访问匿名结构的成员。

[*@K-ballo*同意](https://stackoverflow.com/questions/14187647/c-private-modifier-ignored-on-nested-anonymous-struct#comment19665939_14187647)。

有人告诉我，此功能不一定与创建一个未命名的结构相同，但我看不出标准措辞方面的区别。

C++11 说：

> `[C++11: 9/1]`: *[..]*类*头*省略*类头名*的类*说明符*定义了一个未命名的类。

 **并为缺少名称的类型定义提供完整的语法结构。

C++03 缺少这种明确的措辞，但类似地表明`identifier`类型定义中的 是可选的，并引用了 和 中的“未命名类`9.4.2/5`” `3.5/4`。

*   那么MSDN错了吗，这些东西都是完全标准的？
*   或者在“未命名的结构/类”和用作阻止它们被此 C++03/C++11 功能覆盖的成员时，我是否缺少一些微妙之处？
*   我是否错过了“未命名结构”和“匿名结构”之间的一些根本区别？它们对我来说就像同义词。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-01-09T23:09:01.877

所有标准文本都是指创建一个“未命名的结构”：

```
struct {
   int hi;
   int bye;
}; 
```

只是一个很好的友好类型，没有可访问的名称。

以标准方式，它可以被实例化为这样的成员：

```
struct Foo {
   struct {
      int hi;
      int bye;
   } bar;
};

int main()
{
   Foo f;
   f.bar.hi = 3;
} 
```

* * *

但是一个“匿名结构”是微妙的不同——它是一个“未命名结构”和你神奇地从它的父对象中获取成员的事实的组合：

```
struct Foo {
   struct {
      int hi;
      int bye;
   }; // <--- no member name!
};

int main()
{
   Foo f;
   f.hi = 3;
} 
```

与直觉相反^†，这不仅创建了一个嵌套在 witin 中的未命名结构`Foo`，而且还自动为您提供了一个“匿名成员”，这使得成员可以在父对象中访问。

正是这种功能是非标准的。GCC[*确实*支持它](http://gcc.gnu.org/onlinedocs/gcc/Unnamed-Fields.html)，Visual C++ 也是如此。`#define NONAMELESSUNION`Windows API 标头默认使用此功能，但您可以通过在包含 Windows 标头文件之前添加来指定您不想要它。

与做类似事情的“匿名联合”的*标准*功能进行比较：

```
struct Foo {
   union {
      int hi;
      int bye;
   }; // <--- no member name!
};

int main()
{
   Foo f;
   f.hi = 3;
} 
```

* * *

^†看起来，虽然术语“未命名”指的是类型（即“类”或“结构”）本身，但术语“匿名”指的是实际实例化的成员（使用“结构”的旧含义”这更接近于“某种`struct`y 类型的对象”）。这可能是您最初困惑的根源。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-09T23:07:17.870

微软称之为匿名结构的东西不是标准的。未命名的结构只是一个没有名称的普通结构。除非您还定义了该类型的对象，否则您无能为力：

```
struct {
    int i;
    double d;
} my_object;

my_object.d = 2.3; 
```

匿名**联合**是标准的一部分，它们具有您在阅读[Microsoft](http://msdn.microsoft.com/en-us/library/vstudio/35ect93t.aspx)对其匿名结构的描述时所期望的行为：

```
union {
    int i;
    double d;
};

d = 2.3; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-09T23:09:41.020

标准谈论*匿名工会*：[9.5]/5

> 形式的联合
> 
> ```
> union { member-specification } ; 
> ```
> 
> 称为匿名联合；它定义了一个未命名类型的未命名对象。匿名联合的成员规范应仅定义非静态数据成员。[ 注意：嵌套类型和函数不能在匿名联合中声明。—尾注]匿名联合成员的名称应与声明匿名联合的范围内的任何其他实体的名称不同。出于名称查找的目的，在匿名联合定义之后，匿名联合的成员被认为是在声明匿名联合的范围内定义的。[ 例子：
> 
> ```
> void f() {
>     union { int a; const char* p; };
>     a = 1;
>     p = "Jennifer";
> } 
> ```
> 
> 这里 a 和 p 像普通（非成员）变量一样使用，但由于它们是联合成员，所以它们具有相同的地址。—结束示例]

*微软*所说的*匿名结构*就是这个功能，但适用于. 不仅仅是一个未命名的定义，重要的是要注意匿名联合/结构的成员被认为已在声明匿名联合/结构的范围内定义。*`unions``structs`*

 *据我所知，标准中的*未命名结构*没有这种行为。请注意，在引用的示例中，您如何实现原本不可能的事情，例如共享堆栈中变量的存储空间，而*匿名结构*不会带来任何新东西。***

# uiview - 修复了 UIView 的高度限制

> ID：14248046
> 
> 赞同：7
> 
> 时间：2013-01-09T23:01:52.250
> 
> 标签：uiview, autolayout

我的布局中有一个 UIView 以便进行一些剪辑和分组，但是自动布局在缩小时会调整它的大小。我想给它一个固定的高度，但唯一的选择是设置顶部和底部空间。

有没有办法设置明确的高度约束？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-06-03T19:35:00.160

我刚刚找到了这个答案（[自动布局约束：调整大小时如何使视图保持其宽度/高度比？](https://stackoverflow.com/questions/14188187/auto-layout-constraint-how-to-make-a-view-maintains-its-width-height-ratio-when)）。这就是我的实现的样子：

```
- (void)awakeFromNib
{
    [super awakeFromNib];

    NSLayoutConstraint *con1 = [NSLayoutConstraint constraintWithItem:self
                                                            attribute:NSLayoutAttributeHeight
                                                            relatedBy:NSLayoutRelationEqual
                                                               toItem:nil
                                                            attribute:NSLayoutAttributeNotAnAttribute
                                                           multiplier:1
                                                             constant:self.frame.size.height];
    [self addConstraint:con1];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-17T11:44:20.863

1.  在 Interface Builder 左侧的 Inspector 中选择您的视图。
2.  Ctrl 将一条线从视图拖到自身。

=> 会出现一个弹出框，您可以在其中设置明确的高度和宽度约束。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T20:34:03.850

是和否。在 AutoLayout 中，您不能为 UIView 的大小设置约束，但是您可以防止 UIView 被“压缩”超过其**固有大小**。

这将有效地约束视图，同时避免让父视图强制子视图具有一定大小的危险（从而删除 AutoLayout 的“自动”部分）。

要设置这些优先级，请使用：`setContentCompressionResistancePriority:forAxis:`

从[苹果`UIView`文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)：

> 自定义视图应在创建时根据其内容为两个方向设置默认值，通常为 NSLayoutPriorityDefaultLow 或 NSLayoutPriorityDefaultHigh。在创建用户界面时，当整体布局设计需要与界面中使用的视图的自然优先级不同的权衡时，布局设计者可以为特定视图修改这些优先级。
> 
> 子类不应覆盖此方法。

好的，现在我们知道如何分配优先级以避免我们的视图变得小于其固有大小，但是我们如何设置固有大小呢？

好吧，如果您使用的是标准 UI 元素，那么您已经设置好了！但是，如果您的 UIView 是自定义的，您将需要覆盖`- (CGSize)intrinsicContentSize`以返回正确的大小。在这里，您可以测量视图必须计算正确尺寸的任何子视图 - 或者如果您使用的是艺术品/恒定大小的元素，您可以返回一个硬编码的值。

同样，来自[Apple`UIView`文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)：

> 自定义视图通常会显示布局系统不知道的内容。覆盖此方法允许自定义视图根据其内容与布局系统通信它想要的大小。这个固有尺寸必须独立于内容框架，因为例如，无法根据改变的高度动态地将改变的宽度传达给布局系统。

Apple*强烈*建议不要检查 UIView 之外的任何内容（例如获取超级视图的大小并对其进行调整），因为这不是 AutoLayout 的用途（并且可能会在未来引起严重的头痛）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-10T17:59:07.317

[eckyzero](https://stackoverflow.com/a/24023495/2780252)代码的 Swift代码。

```
let heightConstraint = NSLayoutConstraint(item: yourView, 
                                      attribute: .Height, 
                                       relatedBy: .Equal, 
                                             toItem: nil, 
                              attribute: .NotAnAttribute, 
                             multiplier: 1, constant: 80)//your desired height

yourView.addConstraint(heightConstraint) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-25T00:46:04.363

是的，你可以给它一个固定的高度。

您需要在每个维度中指定至少两个约束，因此在添加固定高度约束之前，您不能删除顶部或底部空间。在 IB 中，选择您的视图，然后在视图编辑器的右下方有一个带有三个图标的按钮，按中间的一个并选择“高度”。这增加了高度约束。现在您可以删除底部或顶部空间，如果需要，您可以通过在尺寸检查器中单击它来编辑高度约束。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-11T17:58:00.747

你不需要给它一个顶部空间和底部空间。如果您有一个距离超级视图底部 8 像素的底部约束，它将始终尝试调整子视图的大小以保持在超级视图内（取决于您是否设置了优先级）。

您可以为高度约束赋予比底部空间约束更高的优先级，因此当它们发生冲突时，它将选择强制执行高度约束并忽略底部约束。

对于约束，您不需要 4 个约束（上、下、左、右）；您只需要 2 个：垂直和水平。其余的由自动布局计算。

只需删除底部约束，子视图就会被剪裁。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-01-10T07:05:11.307

尝试这个

```
view.autoresizingMask = UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin; 
```

# java - 有什么意义吗 在Android编码中？

> ID：14248047
> 
> 赞同：1
> 
> 时间：2013-01-09T23:01:56.337
> 
> 标签：java, android, generics, nested-generics

我试图定义一个包装类 `android.view.View`及其子类，并包含一些有关渲染的信息（人们可能将其称为 View Model 或 PresentationModel）。

```
public class MyClass<T extends View>
{
    private T view;
    private Blah blah;     
} 
```

我的主要问题是我是否应该将视图变量的类型参数化。Java 的通用实现似乎相当简单（例如，所有类型参数信息在编译时都被删除），我可以在这里找到两个可能的优点。

1）向下转换看起来更酷，即使我仍然需要在代码中的某处指定类型。

```
@SuppressWarnings("unchecked")
public final <U extends View> U getView()
{
    return (U) view;
} 
```

有了上面，

```
Button btn = (Button) obj.getView();
((LinearLayout) obj).addView(view); 
```

变成

```
Button btn = obj.getView();
obj.<LinearLayout>addView(view); 
```

2）我也许可以写一些多态代码；

```
@Override
public void bringToFront()
{
    // stuff
} 
```

如果某个方法被某些子类重新定义，

```
public final T getView()
{
    return view;
} 
```

与以上，

```
obj.bringToFront(); 
```

可能会根据我们提供的类型参数表现不同。最大的问题是我不知道 Google 的 android 框架中是否有任何实际的覆盖案例。

目前，我会避免使用泛型，因为显然我不能`HashMap`与泛型类一起使用。

```
Map<String, MyClass<View>> objs = new HashMap<String, MyClass<View>>();
MtClass<Button> obj = objs.get(key);    // type mismatch 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T05:17:24.223

2）是不正确的，至少在你的例子中。您提供的函数不是多态的，因此基于`T`. 当然，子类可以重新定义行为，但这与`T`.

至于 1)，是的，它确实使代码更漂亮，但也使它更不安全。考虑到您具有视图的类型`T`，为什么要将其转换为 a `U`？根据您上面给出的代码，这显然是非法的，如果您没有强制转换，这将是一个编译时错误，但现在只是一个运行时错误，除非类型碰巧匹配。即，如果您有`MyClass<Button>`并定义`T getView()`了 ，则代码可以在不使用 强制转换`U`或根本不使用类型参数`U`的情况下工作，同时`MyClass<TextView>`会在 上导致运行时错误`getView()`，尽管它可以正确编译。

至于您的最后一点，当您从 a 检索对象时，`Map<K, V>`您只能证明该对象是 a `V`，而不是 的子类型`V`，这就是您的最后一个示例无法编译的原因。

总体而言，泛型旨在*增加代码重用*，同时*强制执行类型安全*，但是您提供的示例似乎只做前者，并将类型安全抛到了窗外（公平地说，这是 Android UI 编程通常所做的）。在您给出的示例中，泛型对您的帮助似乎不会超过对您的伤害。

# iphone - 从另一个类启动时运行 void

> ID：14248052
> 
> 赞同：0
> 
> 时间：2013-01-09T23:02:27.247
> 
> 标签：iphone, xcode, latitude-longitude, void

我不能以任何方式引用它并让 void 运行。我可以在任何其他类中运行 void，只需创建一个函数并调用它，但在这个类中没有加载视图。所以问题是，我该如何运行它？

我试过从另一个类中引用变量，但它给出了编译器错误。

getCoords 的返回值必须是 double 类型，因为它是坐标。

```
#import "OmarAnnotation.h"
#import <CommonCrypto/CommonHMAC.h>
#import <netdb.h>
#import "AppDelegate.h"
#import "MapViewController.h"

@implementation SFAnnotation

@synthesize image;
@synthesize latitude;
@synthesize longitude;
@synthesize string;

+(void) getCoords {
NSString *string = @"http://jerwuqu.info/iambored/?GETPOS";
NSURL *url = [NSURL URLWithString:string];
NSString *otherURLContents = [NSString stringWithContentsOfURL:url];
NSLog(otherURLContents);

NSArray* foo = [otherURLContents componentsSeparatedByString: @","];
NSString *longi = [foo objectAtIndex: 0];
NSString *lati = [foo objectAtIndex: 1];
NSLog(longi);
NSLog(lati);

double latiDouble = [lati doubleValue];
double longiDouble = [longi doubleValue];

}

- (CLLocationCoordinate2D)coordinate;
{
 double extern *latiDouble;
 double extern *longiDouble;

CLLocationCoordinate2D theCoordinate;
theCoordinate.latitude  = latiDouble;
theCoordinate.longitude = longiDouble;
return theCoordinate;

}

- (void)dealloc
{
[image release];
[super dealloc];
}

- (NSString *)title
{
return @"Omar";
}

// optional
- (NSString *)subtitle
{

return @"Ortdenhegen";

}

@end 
```

//这是我在其他类文件中的viewDidLoad

```
 - (void)viewDidLoad
     {
     self.mapView.mapType = MKMapTypeStandard;   //Satelite?       
     self.mapAnnotations = [[NSMutableArray alloc] initWithCapacity:2];
     SFAnnotation *sfAnnotation = [[SFAnnotation alloc] init];
     [self.mapAnnotations insertObject:sfAnnotation atIndex:0];
     [SFAnnotation getCoords]; // <- The line with an error
     [self cityAction:self];
     [self gotoLocation];
     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:18:27.857

在你打电话的另一个班级，写`[sfAnnotation whateverMethodYouWantToCall];`

例如，如果您想`getCoords`从其他类的 viewDidLoad 调用：

```
-(void)viewDidLoad{
    //Whatever code you have before.
    [sfAnnotation getCoords];
    //Whatever code you have after.
} 
```

# jquery - jquery - 避免滑块的点击次数增加

> ID：14248054
> 
> 赞同：1
> 
> 时间：2013-01-09T23:02:37.147
> 
> 标签：jquery, animation, slider

我有一个滑块，我想在最后一张幻灯片上停下来（margin-left:-2586px;）。

我使用下面的 jquery 在每张幻灯片之间点击动画（目前只向左移动）。

问题是如果您快速单击#left，滑块将超过-2586px。我怎样才能确保这不会发生？

```
$('#left').click(function(){
    var left = 862;
    if($('#slider-visible').css('margin-left') == '-2586px'){
    }
    else{
        $('#slider-visible').animate({'margin-left':'-=' + left},500);
    }
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:08:20.883

检查元素是否在动画中间。如果是，请不要再次运行动画。

```
else{
    if($('#slider-visible:animated').length == 0){
       $('#slider-visible').animate({'margin-left':'-=' + left},500);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:08:33.573

为什么这是错误的：

```
$('#left').click(function(){
    var left = 862;
    if($('#slider-visible').css('margin-left') == '-2586px'){
    }
    else{
        $('#slider-visible').animate({'margin-left':'-=' + left},500);
    }
}); 
```

不停止动画队列（ using `.stop()`），并使用`-=`并尝试使用`==`来检测确切位置....**错误**

正确构建的滑块有一个`.stop()`和一个...
**计数器**！
动画通常是根据以下内容构建的：

*   元素的数量，
*   点击=增加（减少*“上一个”*按钮）计数器
*   和动画一样`left: - counter*oneSlideWidth`
*   这个简单的逻辑将你的计数器重置为 0`counter = counter % numberOfSlides`
*   另外，您检查计数器是否达到`-1`(inexistant left slide) 的值而不是您将其设置为的值，`numberOfSlides-1`然后再次执行：

```
 $('#slider').stop().animate({left: -counter * slideWidth }); 
```

**基本滑块逻辑：**

```
var galleryWidth = $('#gallery').width(), 
    counter = 0,
    numberOfSlides = $('#gallery .slides').length;

$('#prev, #next').click(function() {

   if( this.id=='next'){
      counter++;
      counter = counter % numberOfSlides ; // will reset to '0' if both match
   }else{ // prev was clicked
      counter--;
      if(counter==-1){
         counter = numberOfSlides-1 ;
      }
   }

   $('#slider').stop().animate({left: - counter * galleryWidth  }, 700);

}); 
```

或者简单地说：

```
$('#prev, #next').click(function() {      
   var myId = this.id=='next' ? counter++ : counter-- ;
   counter = counter===-1? numberOfslides-1 : counter%numberOfSlides;     
   $('#slider').stop().animate({left: - counter * galleryWidth  }, 700);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:20:03.840

我认为如果您对此进行测试，它将起作用： `var element=$('#left');
else{ $('#slider-visible').animate({element.style.marginLeft=left},500); }`

# xml - XPath 按属性值选择元素

> ID：14248063
> 
> 赞同：220
> 
> 时间：2013-01-09T23:03:53.923
> 
> 标签：xml, xpath

我有以下 XML。

```
<?xml version="1.0" encoding="UTF-8"?>
<Employees>
    <Employee id="3">
        <age>40</age>
        <name>Tom</name>
        <gender>Male</gender>
        <role>Manager</role>
    </Employee>
    <Employee id="4">
        <age>25</age>
        <name>Meghna</name>
        <gender>Female</gender>
        <role>Manager</role>
    </Employee>
</Employees> 
```

我想选择 id="4" 的 Employee 元素。

我正在使用下面的 XPath 表达式，它不返回任何内容。

```
//Employee/[@id='4']/text() 
```

我在[http://chris.photobooks.com/xml/default.htm](http://chris.photobooks.com/xml/default.htm)检查了它，它说无效的 xpath，不确定问题出在哪里。

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2013-01-09T23:06:59.837

您需要删除`/`. `[`谓词（ 中的部分`[` `]`）不应该在它们之前有斜线。此外，要选择 Employee 元素本身，您应该`/text()`在最后去掉 ，否则您只需选择 Employee 元素下方的空白文本值。

```
//Employee[@id='4'] 
```

**编辑：**正如 Jens 在评论中指出的那样，`//`可能会非常慢，因为它会在整个文档中搜索匹配的节点。如果您正在使用的文档的结构将保持一致，那么您可能最好使用完整路径，例如：

```
/Employees/Employee[@id='4'] 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2019-02-07T15:54:18.490

接下来，您可以像这样选择“具有特定属性的所有节点”：

```
//*[@id='4'] 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-09T23:09:04.017

尝试这样做：

```
/Employees/Employee[@id=4]/*/text() 
```

# ruby-on-rails - Rails 3.2 - 编写任意属性警告

> ID：14248065
> 
> 赞同：0
> 
> 时间：2013-01-09T23:04:00.703
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

> **可能重复：**
> [使用 ruby​​ 和 active_record 保存时的弃用警告](https://stackoverflow.com/questions/9632438/deprecation-warning-on-save-with-ruby-and-active-record)

我有以下简单的代码，将事件类型（这是一个模型）分配给我的事件模型：

```
def event_type=(new_event_type)
  self.event_type_id = new_event_type.id
  write_attribute(:event_type, new_event_type)
end 
```

它工作正常，但是在升级到 Rails 3.2 后，我收到以下消息：

**您正在尝试创建属性`event_type'. Writing arbitrary attributes on a model is deprecated. Please just use`attr_writer` 等。**

警告位于“write_attribute”行。

任何建议为什么会发生此警告以及解决此警告的最佳方法是什么，我们将不胜感激。

亲切的问候。

# python - 在 Python 中实例化为“无”的变量是否按值传递？

> ID：14248068
> 
> 赞同：0
> 
> 时间：2013-01-09T23:04:09.573
> 
> 标签：python, python-3.x

> **可能重复：**
> [Python - 传递值如何工作？](https://stackoverflow.com/questions/11585768/python-how-does-passing-values-work)

如果我有一个变量并将其实例化为 None，我该如何进行一个反映多个范围内变化的赋值？

例如：

```
def doStuff(test):
    test = "hello world"

def main():
    test = None
    doStuff(test)
    print(test) 
```

如果我猜对了，那么输出什么都不是，因为“测试”是按值传递的？有没有办法让它通过引用传递而不在函数之前静态声明类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:12:52.537

当你这样做时：

```
def main():
    test = None
    doStuff(test)
    print(test) 
```

您本质上打印' 范围内的字符串对象（由`test`引用引用） 。`main()`对于由 中的变量`print`引用的内部字符串对象，您应该执行以下三个操作之一：`test``doStuff`

*   你应该在里面使用一个`print`语句`doStuff`

*   或使用`global`关键字

*   `doStuff`从您存储在`main()`'s中的值返回一个值`test`。

对于最后一部分，您可以[在此处](https://stackoverflow.com/questions/146557/do-you-use-the-global-statement-in-python)找到更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:12:13.547

您可以查看`global`关键字。

```
def doStuff():
    global test
    test = 'Hello World' 
```

`global`关键字允许您直接分配给全局变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:14:48.420

如果要`doStuff`更改范围内的值`test`，`main()`则应将其返回，如下所示：

```
def doStuff(test):
    test = "hello world"
    return test

def main():
    test = None
    test = doStuff(test)
    print(test) 
```

当然，在这个例子中，没有理由将 test 作为输入传递给`doStuff()`，所以你可以这样做：

```
def doStuff():
    test = "hello world" # These 2 lines could be one
    return test          # return "hello world"

def main():
    test = doStuff()
    print(test) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T23:30:29.827

您不能直接从另一个函数更改*局部*变量的值 - 正如其他人回答的那样，您可以将其声明为全局变量，或返回新值并分配它。但是另一种尚未提及的实现此目的的方法是使用将值保存在属性中的包装类。然后您可以传递包装器实例并修改属性：

```
class Wrapper():
    """a simple wrapper class that holds a single value which defaults to None"""
    def __init__(self, value=None):
        self.value = value

def main():
    test = Wrapper()
    doSomething(test)
    print(test.value)

def doSomething(x):
    x.value = "something" 
```

# android - 如何使用签名密钥在 Eclipse 中运行 android 应用程序？

> ID：14248071
> 
> 赞同：4
> 
> 时间：2013-01-09T23:04:16.383
> 
> 标签：android, android-keystore

有没有办法可以将签名密钥提供给构建器并让应用程序直接使用签名密钥构建并安装到我的设备上？或者我必须手动导出应用程序并选择密钥，输入密码，然后手动将其安装到我的设备上？

所以简单的问题是：有没有办法在eclipse中构建应用程序时使用签名密钥（它会自动将它安装在设备上）？

请注意：我不是在问如何调试它，我只需要直接从 eclipse 运行它到带有签名密钥的设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:15:11.043

我从来没有做过，但根据文档你可以。您必须通过为其提供密钥库的路径和密码来将其配置为以这种方式运行。但看起来一旦你设置好它就会很容易并且做你需要的。

[在发布模式下运行](http://developer.android.com/tools/building/building-cmdline.html)

[这](https://stackoverflow.com/questions/5669586/eclipse-android-app-run-signed-with-real-certificate)也是一个关于它的SO帖子。

# networking - tcp/udp 端口 识别的正则表达式（16 位）

> ID：14248072
> 
> 赞同：0
> 
> 时间：2013-01-09T23:04:18.407
> 
> 标签：networking, gcc, lex, flex-lexer

我有一个包含以下代码的 lex 文件 port_regex.l。

```
DECIMAL_16bits [ \t]*[:digit:]{1,4}[ \t]*
SPACE [ \t]

%x S_rule S_dst_port

%%

%{
    BEGIN S_rule;
%}

<S_rule>(dst-port){SPACE}   {
           BEGIN(S_dst_port);
        }

<S_dst_port>\{{DECIMAL_16bits}\}  {
       printf("\n\nMATCH [%s]\n\n", yytext);
       BEGIN S_rule;
     }

. { ECHO; }

%%

int main(void)
{
    while (yylex() != 0)
        ;
    return(0);
}

int yywrap(void)
{
    return 1;
} 
```

我从它创建一个可执行文件，如下所示。

```
flex port_regex.l
gcc lex.yy.c -o port_regex 
```

它创建了一个名为 port_regex 的可执行文件。

我有一个包含名为 port.file 的测试数据的文件，如下所示。

```
dst-port {234}
dst-port {236}
dst-port {233}
dst-port {2656} 
```

如何使用 port_regex 可执行文件测试 port.file。

我可以做类似的事情吗

./port_regex < port.file

我尝试了上面的方法，它似乎不起作用？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T16:23:03.220

只要您的应用程序不会变得更复杂，我认为使用[启动条件](http://westes.github.io/flex/manual/Start-Conditions.html)是一个好方法，而不是引入 yacc 生成的解析器。

几个想法：

`BEGIN(comment)`我看到的示例有时在 BEGIN ( )中使用括号，有时在 ( `BEGIN comment`) 中不使用括号。我怀疑这有什么不同，但你应该保持一致。

这本书说，回显不匹配字符的默认规则仍然有效，即使在独占开始条件下，所以你不应该需要

```
. { ECHO; } 
```

并且由于您的开始条件是排他性的，因此无论如何它都不会触发。只是为了确保，您可以将其重写为

```
<*>.|\n     ECHO; 
```

# java - 我的 JLabel 文本不会改变

> ID：14248074
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:04:29.853
> 
> 标签：java, eclipse, swing, jlabel, windowbuilder

我正在为我的计算机编程课程创建一个最终项目，并且遇到了一个奇怪的问题，我希望有人可以帮助我。我正在尝试制作一个将在两台计算机之间运行的二十一点程序，但我无法让我的标签文本更改超出它们最初设置的内容。为了制作这个项目，我使用了带有窗口​​构建器插件的 eclipse 编译器。

问题本身存在于标签“lblEnterTextHere”中，当我尝试在 rungame 方法中这样做时，谁的文本不会改变。随机 System.out.print 消息用于检查代码是否甚至到达了运行此方法的位置，并且确实到达了。打印“等待连接”。

注意：我是java新手，这只是12年级的课程，所以请清楚地解释你的答案。这会有很大帮助。此外，这甚至还不是游戏，只是我正在尝试做的事情的骨架。

我的代码：

```
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JButton;
import javax.swing.ImageIcon;
import java.io.*;
import java.net.*;
public class Window {

ServerSocket providerSocket;
Socket connection = null;
ObjectOutputStream out;
ObjectInputStream in;
private JFrame frame;
JLabel label_5;
JButton btnNewButton;
JLabel label;
JLabel label_1;
JLabel label_2;
JLabel label_3;
JLabel label_4;
JLabel label_6;
JLabel label_7;
JLabel label_8;
JLabel label_9;
JLabel lblPlayerOneyou;
JLabel lblPlayerother;
JLabel lblNewLabel;
JLabel lblScore;
JLabel lblNewLabel_1;
JLabel lblNewLabel_2;
JButton btnNewButton_1;
JLabel lblStatus;
JLabel lblEnterTextHere;

public static void main(String[] args) {
    Window window = new Window();
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                Window window2 = new Window();
                window2.frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
    System.out.print("Hello.");
    window.runGame();
}

public Window() {
    frame = new JFrame();
    frame.setBounds(100, 100, 792, 536);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.getContentPane().setLayout(null);

    label_5 = new JLabel("New label");
    label_5.setEnabled(false);
    label_5.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_5.setBounds(36, 74, 110, 145);
    frame.getContentPane().add(label_5);

    btnNewButton = new JButton("First Draw");
    btnNewButton.setEnabled(false);
    btnNewButton.setBounds(661, 125, 89, 94);
    frame.getContentPane().add(btnNewButton);

    label = new JLabel("New label");
    label.setEnabled(false);
    label.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label.setBounds(156, 74, 110, 145);
    frame.getContentPane().add(label);

    label_1 = new JLabel("New label");
    label_1.setEnabled(false);
    label_1.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_1.setBounds(276, 74, 110, 145);
    frame.getContentPane().add(label_1);

    label_2 = new JLabel("New label");
    label_2.setEnabled(false);
    label_2.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_2.setBounds(393, 74, 110, 145);
    frame.getContentPane().add(label_2);

    label_3 = new JLabel("New label");
    label_3.setEnabled(false);
    label_3.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_3.setBounds(516, 74, 110, 145);
    frame.getContentPane().add(label_3);

    label_4 = new JLabel("New label");
    label_4.setEnabled(false);
    label_4.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_4.setBounds(36, 267, 110, 145);
    frame.getContentPane().add(label_4);

    label_6 = new JLabel("New label");
    label_6.setEnabled(false);
    label_6.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_6.setBounds(156, 267, 110, 145);
    frame.getContentPane().add(label_6);

    label_7 = new JLabel("New label");
    label_7.setEnabled(false);
    label_7.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_7.setBounds(270, 267, 110, 145);
    frame.getContentPane().add(label_7);

    label_8 = new JLabel("New label");
    label_8.setEnabled(false);
    label_8.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_8.setBounds(393, 267, 110, 145);
    frame.getContentPane().add(label_8);

    label_9 = new JLabel("New label");
    label_9.setEnabled(false);
    label_9.setIcon(new ImageIcon("C:\\Users\\Alexander Wong\\Documents\\Cards\\cardBack.jpg"));
    label_9.setBounds(516, 267, 110, 145);
    frame.getContentPane().add(label_9);

    lblPlayerOneyou = new JLabel("Player one (You)");
    lblPlayerOneyou.setBounds(46, 26, 100, 24);
    frame.getContentPane().add(lblPlayerOneyou);

    lblPlayerother = new JLabel("Player 2 (Other player)");
    lblPlayerother.setBounds(49, 241, 123, 14);
    frame.getContentPane().add(lblPlayerother);

    lblNewLabel = new JLabel("Score:");
    lblNewLabel.setBounds(170, 31, 46, 14);
    frame.getContentPane().add(lblNewLabel);

    lblScore = new JLabel("Score:");
    lblScore.setBounds(170, 242, 46, 14);
    frame.getContentPane().add(lblScore);

    lblNewLabel_1 = new JLabel("0");
    lblNewLabel_1.setBounds(220, 31, 46, 14);
    frame.getContentPane().add(lblNewLabel_1);

    lblNewLabel_2 = new JLabel("??");
    lblNewLabel_2.setBounds(220, 241, 46, 14);
    frame.getContentPane().add(lblNewLabel_2);

    btnNewButton_1 = new JButton("Quit");
    btnNewButton_1.setEnabled(false);
    btnNewButton_1.setBounds(661, 261, 89, 87);
    frame.getContentPane().add(btnNewButton_1);

    lblStatus = new JLabel("Status:");
    lblStatus.setBounds(23, 458, 46, 14);
    frame.getContentPane().add(lblStatus);

    lblEnterTextHere = new JLabel("Enter text here");
    lblEnterTextHere.setBounds(63, 458, 109, 14);
    frame.getContentPane().add(lblEnterTextHere);

}

public void runGame() {
    try {
        System.out.println("Hello.");
        providerSocket = new ServerSocket(5131, 10);
        lblEnterTextHere.setText("Waiting for connection");
        System.out.println("Waiting for connection");
        lblStatus.setText("me");
        connection = providerSocket.accept();
        lblEnterTextHere.setText("Connection received from " + connection.getInetAddress().getHostName());
        out = new ObjectOutputStream(connection.getOutputStream());
        out.flush();
        in = new ObjectInputStream(connection.getInputStream());
        out.writeInt(-1);
        out.flush();
        System.out.println("All systems go.");
        try {
            in.close();
            out.close();
            providerSocket.close();
        } catch (IOException ioException) {
            ioException.printStackTrace();
        }
    } catch (IOException ioException){
        ioException.printStackTrace();
    }

} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:14:18.217

您通过在该线程中`EDT`放置功能来阻止 。`ServerSocket`将功能放在`runGame`SwingWorker[中](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)，UI 将可以自由更新其组件。

因为您不需要任何退货信息，您可以使用`SwingWorker<Void, Void>`

请参阅此[相关帖子](https://stackoverflow.com/questions/9588543/server-based-swingworker-does-not-stop)。

# powershell - Powershell，检索用户管理器

> ID：14248080
> 
> 赞同：2
> 
> 时间：2013-01-09T23:04:59.330
> 
> 标签：powershell, csv, organization, cmdlets

我正在创建一个 csv 类型的组织结构图，只是想知道将用户经理、经理经理等检索到最高位置的首选方法是什么。目前我正在使用：

```
[string]$man = $userEntry.manager
    [array]$manName = $man.split('=,')
    $manager = $manName[1]
    $item.Cells.Item($i,1) = $userEntry.name.value
    $item.Cells.Item($i,2) = $userEntry.description.value
    $item.Cells.Item($i,3) = $manager.ToString() 
```

然后运行 ​​get-QADobject 以通过其 DN 查找下一个经理。

但必须有一个更清洁的方式！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T03:50:50.387

如果我对您的理解正确，您想一直遵循指挥链一直到最高层（大概那个人没有经理？）。在这种情况下，您需要递归地向上走。

未经测试的伪代码，因为我目前没有可用的域进行测试：

```
Function Get-Manager {
params(
[string]$username
)
$userEntry = get-qaduser $username
[string]$man = $userEntry.manager
if (-not ($man -eq $null)) {
    [array]$manName = $man.split('=,')
    $manager = $manName[1]
    "$manager is the manager of $username";
    Get-Manager $manager
}
} 
```

一旦用户没有经理，这将停止。在我的组织中，我们的 CEO 被列为他自己的经理，因此我将更改上面的代码以查找经理为非 null*或*等于用户，这样任何一个条件为真都会打破循环。

# python - 我的类继承列表类方法的方式 pythonicly 正确吗？

> ID：14248081
> 
> 赞同：3
> 
> 时间：2013-01-09T23:04:59.277
> 
> 标签：python, python-2.7

一个小例子将有助于澄清我的问题：

我定义了两个类：Security 和 Universe，我希望将它们作为一个安全对象列表。

这是我的示例代码：

```
class Security(object):
    def __init__(self, name):
        self.name = name

class Universe(object):
    def __init__(self, securities):
        self.securities = securities

s1 = Security('name1')
s2 = Security('name2')
u = Universe([s1, s2]) 
```

我希望我的 Universe 类能够使用常用的列表功能，例如 enumerate()、len()、__getitem__()...：

```
enumerate(u)
len(u)
u[0] 
```

所以我将我的班级定义为：

```
class Universe(list, object):
    def __init__(self, securities):
        super(Universe, self).__init__(iter(securities))
        self.securities = securities 
```

它似乎有效，但它是合适的pythonic方式吗？

[编辑]

当我对列表进行子集化时，上述解决方案无法正常工作：

```
>>> s1 = Security('name1')
>>> s2 = Security('name2')
>>> s3 = Security('name3')
>>> u = Universe([s1, s2, s3])
>>> sub_u = u[0:2]
>>> type(u)
<class '__main__.Universe'>
>>> type(sub_u)
<type 'list'> 
```

我希望我的变量 sub_u 保持为 Universe 类型。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T00:03:20.350

您不必真正成为`list`使用这些功能的人。这就是鸭子打字的重点。任何定义`__getitem__(self, i)`自动处理`x[i]`、`for i in x`、`iter(x)`、`enumerate(x)`和各种其他事物的东西。也定义`__len__(self)`and `len(x)`,`list(x)`等也有效。或者您可以定义`__iter__`而不是`__getitem__`. 或两者。这取决于`list`你想成为什么样的人。

Python[特殊方法](http://docs.python.org/2/reference/datamodel.html#special-method-names)的文档解释了每个方法的用途，并且很好地组织了它们。

例如：

```
class FakeList(object):
    def __getitem__(self, i):
        return -i
fl = FakeList()
print(fl[20])
for i, e in enumerate(fl):
    print(i)
    if e < -2: break 
```

看不到`list`。

如果您确实有一个`real`列表并希望将其数据表示为您自己的数据，则有两种方法可以做到这一点：委托和继承。两者都有效，并且都适用于不同的情况。

如果你的对象真的*是*一个`list`额外的东西，使用继承。如果您发现自己踩到了基类的行为，您可能无论如何都想切换到委托，但至少从继承开始。这很简单：

```
class Universe(list): # don't add object also, just list
    def __init__(self, securities):
        super(Universe, self).__init__(iter(securities))
        # don't also store `securities`--you already have `self`! 
```

您可能还想覆盖[`__new__`](http://docs.python.org/2/reference/datamodel.html#object.__new__)，它允许您`iter(securities)`进入`list`创建时间而不是初始化时间，但这通常对`list`. （对于像 . 这样的不可变类型更重要`str`。）

*如果您的对象拥有*一个列表而不是一个列表*这一*事实在其设计中是固有的，请使用委托。

最简单的委托方式是显式的。定义与您定义的完全相同的方法来伪造 a `list`，并将它们全部转发给`list`您拥有的：

```
class Universe(object):
    def __init__(self, securities):
        self.securities = list(securities)
    def __getitem__(self, index):
        return self.securities[index] # or .__getitem__[index] if you prefer
    # ... etc. 
```

您还可以通过以下方式进行委托[`__getattr__`](http://docs.python.org/2/reference/datamodel.html#object.__getattr__)：

```
class Universe(object):
    def __init__(self, securities):
        self.securities = list(securities)
    # no __getitem__, __len__, etc.
    def __getattr__(self, name):
        if name in ('__getitem__', '__len__',
                    # and so on
                   ):
            return getattr(self.securities, name)
        raise AttributeError("'{}' object has no attribute '{}'"
                             .format(self.__class__.__name__), name) 
```

* * *

请注意，许多`list`'s 方法将返回一个新的`list`. 如果您希望它们返回一个新的`Universe`，则需要包装这些方法。但请记住，其中一些方法是二元运算符——例如，只有当是一个时才应该`a + b`返回 a ，或者只有当两者都是，或者如果两者都是？`Universe``a`

另外，`__getitem__`这有点棘手，因为它们可以返回 a`list`或单个对象，而您只想将前者包装在`Universe`. 您可以通过检查 ; 的返回值`isinstance(ret, list)`或检查索引来做到这一点`isinstance(index, slice)`。哪个合适取决于您是否可以将`list`s 作为 a 的元素，以及提取时`Universe`是否应将它们视为 a`list`或 a 。`Universe`另外，如果您使用继承，在 Python 2 中，您还需要包装 deprecated`__getslice__`和 friends，因为`list`确实支持它们（尽管`__getslice__`总是返回一个子列表，而不是一个元素，所以这很容易）。

一旦你决定了这些事情，实现就很容易了，虽然有点乏味。以下是所有三个版本的示例，使用`__getitem__`因为它很棘手，以及您在评论中询问的那个。我将展示一种使用通用帮助器进行包装的方法，即使在这种情况下，您可能只需要一种方法，所以它可能有点矫枉过正。

遗产：

```
class Universe(list): # don't add object also, just list
    @classmethod
    def _wrap_if_needed(cls, value):
        if isinstance(value, list):
            return cls(value)
        else:
            return value
    def __getitem__(self, index):
        ret = super(Universe, self).__getitem__(index)
        return _wrap_if_needed(ret) 
```

显式委托：

```
class Universe(object):
    # same _wrap_if_needed
    def __getitem__(self, index):
        ret = self.securities.__getitem__(index)
        return self._wrap_if_needed(ret) 
```

动态委托：

```
class Universe(object):
    # same _wrap_if_needed
    @classmethod
    def _wrap_func(cls, func):
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            return cls._wrap_if_needed(func(*args, **kwargs))
    def __getattr__(self, name):
        if name in ('__getitem__'):
            return self._wrap_func(getattr(self.securities, name))
        elif name in ('__len__',
                      # and so on
                      ):
            return getattr(self.securities, name)
        raise AttributeError("'{}' object has no attribute '{}'"
                             .format(self.__class__.__name__), name) 
```

正如我所说，在这种情况下这可能有点矫枉过正，尤其是对于这个`__getattr__`版本。如果您只想覆盖一个方法，例如`__getitem__`，并委托其他所有内容，您始终可以`__getitem__`显式定义，并让`__getattr__`处理其他所有内容。

如果你发现自己经常做这种包装，你可以编写一个生成包装类的函数，或者一个让你编写骨架包装并填充细节的类装饰器，等等。因为细节取决于你的用例（所有我上面提到的那些问题可能会以某种方式或其他方式发生），没有一种万能的库可以神奇地做你想要的，但是 ActiveState 上有许多食谱可以显示更完整的细节——而且甚至是标准库源代码中的一些包装器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T23:09:41.383

这是一种合理的方法，尽管您不需要同时继承`list`and `object`。 `list`一个人就够了。另外，如果你的类是一个列表，你不需要存储`self.securities`; 它将被存储为列表的内容。

但是，根据您要使用类的目的，您可能会发现定义一个在内部存储列表的类（就像您正在存储的那样`self.securities`）更容易，然后在您的类上定义（有时）传递给方法的方法这个存储的列表，而不是继承自`list`. Python 内置类型没有根据哪些方法依赖于哪些其他方法（例如，是否`append`依赖于`insert`）定义严格的接口，因此如果您尝试对列表的内容进行任何非平凡的操作，您可能会遇到令人困惑的行为-班级。

编辑：正如您所发现的，任何返回新列表的操作都属于此类别。如果您子类`list`化而不覆盖其方法，那么您调用对象上的方法（显式或隐式），`list`将调用底层方法。这些方法被硬编码为返回一个纯 Python 列表，并且不检查对象的实际类是什么，因此它们将返回一个纯 Python 列表。

# asp.net - ASP.NET MVC 如何避免静态变量？

> ID：14248082
> 
> 赞同：-2
> 
> 时间：2013-01-09T23:04:58.980
> 
> 标签：asp.net, asp.net-mvc, thread-safety

最近发布了关于质疑静态变量有多不安全的帖子，我发现我需要摆脱它们。但我不知道怎么做？正在为每个类考虑一个静态 Get() 方法，该方法返回一个实例，但该实例必须声明为静态的。

因此，唯一的方法是让实例引用（对于每个助手、IE 用户 helper.cs、imagehelper.cs 等）将它们声明为某种全局可访问类的实例属性？但是哪个班？我在这里缺少什么吗？

我需要更改的示例类的代码如下：

```
sing System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Mvc.Mailer;

namespace MVCWebsite.Helpers
{
        public class AppSettings
        {
                public static void OnAppInit()
                {
                        //General
                        AppName = "MyApp";
                        DesktopBaseURLs = new Dictionary<string, string>();
                        DesktopBaseURLs.Add("dev", "localhost:50560");
                        DesktopBaseURLs.Add("test", "www.test.whatever.com");
                        DesktopBaseURLs.Add("live", "www.whatever.com");
                        MobileBaseURLs = new Dictionary<string, string>();
                        MobileBaseURLs.Add("dev", "m.local.whatever.com");
                        MobileBaseURLs.Add("test", "m.test.whatever.com");
                        MobileBaseURLs.Add("live", "m.whatever.com");

                        //Emails
                        EmailHostName = AppName + ".com"; //For the moment atleast
                        NoReplyEmailAddress = "no-reply@" + EmailHostName.ToLower();
                        SupportEmailAddress = "support@" + EmailHostName.ToLower();
                        ErrorEmailAddress = "errors@" + EmailHostName.ToLower();

                        //Resources
                        TempFileURL = "/content/temp/";
                        UserDataURL = "/content/user-content/";
                        ProfilePicturesURL = UserDataURL + "profile-pictures/";

                        var a = GlobalHelper.GetURLAsServerPath(ProfilePicturesURL);
                        var b = a;

                }

                //General
                public static string AppName { get; set; }
                public static Dictionary<string, string> DesktopBaseURLs;
                public static Dictionary<string, string> MobileBaseURLs;

                //Emails
                public static string EmailHostName { get; set; }
                public static string NoReplyEmailAddress { get; set; }
                public static string SupportEmailAddress { get; set; }
                public static string ErrorEmailAddress { get; set; }

                //Resources
                public static string UserDataURL { get; set; }
                public static string TempFileURL { get; set; }
                public static string ProfilePicturesURL { get; set; }

                //Methods
                public static void SetAppURL()
                {

                }
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:14:54.943

我建议为您的 AppSettings 类创建一个接口，以便您现在可以在控制器中使用它，并以您认为合适的不同方式实现它：

```
public interface IAppSettings
{
    string AppName { get; set; }
    ...
} 
```

然后，您可以通过包装类立即使用您的静态类实现它：

```
public class AppSettingsWrapper : IAppSettings
{
    public AppName
    {
        get
        {
            return AppSettings.AppName;
        }
        set
        {
            AppSettings.AppName = value;
        }
    }

    ...
} 
```

稍后，您可以创建使用会话、cookie、数据库值或其他任何内容的 IAppSettings 实现。重要的是抽象您存储事物的方式，以便您可以以满足您需求的方式实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:10:24.000

对您上一个问题的回答清楚地表明 IDictionary 是您的静态方法中唯一不安全的变量，因为它不是线程安全的。您只需要以不同的方式存储这些变量。您不需要摆脱所有静态变量。您只需要将 IDictionary 更改为线程安全的。

顺便说一句，那里有人对 web.config 发表了很好的评论

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-10T03:54:25.297

是的，我想我已经弄清楚了，它们应该作为实例变量存储在 Global.asax.cs 中。该文件包含继承自 System.Web.HttpApplication 的 Application 类。这个主类被限制为每个请求一个（本身的）实例。因此，如果您在此处存储对助手的任何引用，则可以通过 MvcApplication.MyHelper.DoSomething(); 来引用它们。如果这是错误的，请有人纠正我，但对我来说似乎是正确的。“在任何一个时间点，一个 HTTPApplication 实例只处理一个请求，所以我们不需要考虑任何非静态成员的锁定和解锁，但对于静态成员，我们确实需要。” -来自：[http:// www.codeproject.com/Articles/87316/A-walkthrough-to-Application-State#c](http://www.codeproject.com/Articles/87316/A-walkthrough-to-Application-State#c)

# ruby-on-rails - pjax vs turbolinks vs cache_digests 以提高轨道速度？

> ID：14248090
> 
> 赞同：2
> 
> 时间：2013-01-09T23:05:51.303
> 
> 标签：ruby-on-rails, ajax, performance, caching

我已经阅读了一些关于提高 Rails 站点速度的各种选项的内容。

以下库似乎很有希望：

*   pjax
*   涡轮链接
*   缓存摘要

然而，他们似乎试图做很多类似的事情。

您可以/应该同时使用它们吗？这样做会不会出现问题？

是否存在其中一个或另一个比其他更好的情况？（它们是什么？）

有没有比这三个更好的东西我应该检查一下？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:07:08.033

我更喜欢 pjax。它易于使用且速度非常快。您只需要定义一个 pjax 容器，它将在每个请求中被替换。

相反，Turbolinks 确实取代了整个身体。我不太喜欢那样。但这是品味问题。它将成为 Rails 4 的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T05:21:25.423

cache_digests 不能与 pjax 或 turbolinks 相提并论。cache_digests 增强了 Rails 缓存以允许俄罗斯娃娃缓存。

Turbolinks 往往更简单一些，并且不需要 jquery。

Pjax 是可配置的，但需要 jquery。

# oracle - 使用实体框架调用 Oracle 存储过程 VANCE_TEST，我得到 PLS-00302：必须声明组件“VANCE_TEST”

> ID：14248092
> 
> 赞同：0
> 
> 时间：2013-01-09T23:06:03.893
> 
> 标签：oracle, stored-procedures, entity-framework-4

我已经解决了所有类似的问题，但没有成功。

在 Visual Studio 2010 中，我正在创建一个调用 Oracle 存储过程的 MVC Web 应用程序。我什至无法调用一个非常简单的存储过程。这是一个简单的存储过程：

```
CREATE OR REPLACE PROCEDURE VANCE_TEST ( PARTNERS OUT sys_refcursor ) AS
BEGIN
  OPEN PARTNERS FOR SELECT COMPANY_NAME, SUN FROM PARTNER WHERE MARKET_IDX = 16;
END;
/ 
```

两列都是 Varchar2 类型。当我从 SQL*Plus 调用该过程时，使用以下代码可以正常工作：

```
var rc refcursor
execute VANCE_TEST( :rc );
print rc; 
```

在我的 web.config 文件中，我有以下规范来定义存储过程的游标：

```
 <oracle.dataaccess.client>
    <settings>
      <add name="PARTNER.VANCE_TEST.RefCursor.PARTNERS" value="implicitRefCursor bindinfo='mode=Output'" />
      <add name="PARTNER.VANCE_TEST.RefCursorMetaData.PARTNERS.Column.0" value="implicitRefCursor metadata='ColumnName=COMPANY_NAME;BaseSchemaName=PARTNER;BaseTableName=PARTNER;NativeDataType=Varchar2;ProviderType=Varchar2;ProviderDBType=String;DataType=System.String;ColumnSize=100;AllowDBNull=true'" />
      <add name="PARTNER.VANCE_TEST.RefCursorMetaData.PARTNERS.Column.1" value="implicitRefCursor metadata='ColumnName=SUN;BaseSchemaName=PARTNER;BaseTableName=PARTNER;NativeDataType=Varchar2;ProviderType=Varchar2;ProviderDBType=String;DataType=System.String;ColumnSize=10;AllowDBNull=true'" />
    </settings>
  </oracle.dataaccess.client> 
```

当我执行添加函数导入时，这工作得很好，并且 VS 能够为返回的数据创建一个复杂类型 VANCE_TEST_Result。PARTNER 是架构名称，并且添加函数导入无法看到返回的列，直到我在 VANCE_TEST 之前添加它。

在我的程序中，使用 Models.Entities 对 PARTNER 表进行 Linq 查询没有问题，我有以下代码：

```
using (Models.Entities db = new Models.Entities())
{
    IEnumerable<Models.VANCE_TEST_Result> results = db.VANCE_TEST(); 
```

当我执行它时，我在 db.VANCE_TEST() 中得到一个异常：

```
public ObjectResult<VANCE_TEST_Result> VANCE_TEST()
{
    return base.ExecuteFunction<VANCE_TEST_Result>("VANCE_TEST");
} 
```

ExecuteFunction （我无法追踪）抛出一个 Oracle.DataAccess.Client.OracleException ，其中包含来自 Oracle 的多行错误：

```
ORA-06550: line 1, column 17: 
PLS-00302: component 'VANCE_TEST' must be declared 
ORA-06550: line 1, column 7: 
PL/SQL: Statement ignored 
```

关于这里发生了什么的任何提示？或者我如何才能获得正在发送的实际 SQL 代码？我试图从其他 Stackoverflow 文章中学习，并在他们解决问题后尽可能多地这样做：

[Oracle 存储过程调用返回异常 ORA-06550 和 PLS-00103](https://stackoverflow.com/questions/9881091/oracle-stored-proc-call-returning-exception-ora-06550-with-pls-00103)

提前感谢您对此有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:56:05.043

您是否以用户 PARTNER 的身份连接到数据库？如果没有，那么也许这可能会有所帮助？

```
return base.ExecuteFunction<VANCE_TEST_Result>("PARTNER.VANCE_TEST"); 
```

# php - 源代码和 preg_match

> ID：14248093
> 
> 赞同：1
> 
> 时间：2013-01-09T23:06:04.840
> 
> 标签：php

我是 PHP 新手，我想学习从另一个站点获取信息的代码。我看着 preg_match 并爆炸了。

我的问题是我想获取一些信息，但没有标签。

我将此代码用于此标签

```
$site=file_get_contents("$link");
$price='#<div class="price">(.*?)<\/div>#si';
preg_match_all($price,$site,$pricelist);
for ($a=0; $a<5; $a++){
echo $pricelist[1][$a];
} 
```

但是在源代码中是这样的：

```
<b>500€&lt;/b></a><div class=gh_hl1>
<b>510€&lt;/b></small></a><br clear=all><div class=gh_hl1>
<b>520€&lt;/b></a><div class=gh_hl1>
<b>530€&lt;/b></a><div class=gh_hl1>
<b>540€&lt;/b></a><div class=gh_hl1>
<b>550€&lt;/b></a><div class=gh_hl1> 
```

它以`<b>`这个标签开始，以and结束，`<div class=gh_hl1>`还有`</small></a><br clear=all><div class=gh_hl1>`另一个标签以`<b>`

我想知道有没有可能采取这个价格？

我还看了 Simple HTML Dom Parser。但我什么也找不到。谢谢你的回答...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:12:35.903

好吧，您可以在 HTML 文件中查找模式。非常引人注目的一件事是€符号。你可以搜索那个。这个正则表达式应该这样做：

```
$price='/(\d*)€(\d*)/'; 
```

如果€符号在金额之前或之后，应该抢价格（如果你们只是在之后才这样做，那么最后一个（\ d *）。

还有其他相似之处，例如粗体标签，因此您可以添加它以获得更多特异性：

```
$price='/<b>(\d*)€(\d*)</b>/'; 
```

不过，这仍然是一个相当通用的字符串，真正将它们联系在一起的是`div`最后的: `<div class=gh_hl1>`. 因此，您可以使用以下正则表达式进行搜索，处理过程中的标签：

```
$price='/<b>(\d*)€(\d*)<\/b>(<\/small>)?<\/a>(<br clear=all>)?<div class=gh_hl1>/'; 
```

那是我的镜头。但这仍然很愚蠢（我不确定它是否可以在 PHP 中工作，最近主要是在做 Ruby），所以让我们将其简化为：

```
$price='/<b>(\d*)€(\d*)<\/b>.*<\/a>.*<div class=gh_hl1>/'; 
```

现在我们将获得介于两者之间的所有标签。就像评论中所说的那样，有一百万种更好的方法可以做到这一点，并且`<b>`标签上方的父项目可能会表明这是一个价格。寻找那些。

由于我们想要的主要是 b 标签之间的价格，并确保它以具有该类的 div 结尾，我们可以制作我们的正则表达式：

```
$price='/<b>(\d*)€(\d*)<\/b>.*<div class=gh_hl1>/'; 
```

# html - 如何使具有可变高度内容的 3 个“li”列具有相同的高度

> ID：14248095
> 
> 赞同：18
> 
> 时间：2013-01-09T23:06:10.393
> 
> 标签：html, css, internet-explorer-7

HTML：

```
<ul>
  <li>
    <div class="one">Variable Height Title</div>
    <div class="two">Fixed height middle block</div>
    <div class="three">Variable height middle block<br />more content<br /> more contentmore content<br /> more content<br /> more content</div>
    <div class="four">Fixed height footer</div>
  </li>
  <li>
    <div class="one">Variable Height Title Might be two lines long</div>
    <div class="two">Fixed height middle block</div>
    <div class="three">Variable height middle block</div>
    <div class="four">Fixed height footer</div>
  </li>
  <li>
    <div class="one">Variable Height Title</div>
    <div class="two">Fixed height middle block</div>
    <div class="three">Variable height middle block</div>
    <div class="four">Fixed height footer</div>
  </li>  
</ul> 
```

CSS：

```
li {
  float:left;
  width:33%;
}

.one, .three {
  background-color:blue;
}
.two, .four {
  background-color:green;
} 
```

请看这个例子：http: [//jsfiddle.net/WffHD/](http://jsfiddle.net/WffHD/)

有没有办法**只用css**让“一个”div等高（必须是动态的），然后也让所有三列的高度也基于最高的那一列？另一种说法：我希望所有“一个”div 的高度相同，然后通过拉伸“三个”div 的高度，所有列的高度也应该相同。不幸的是，由于我正在使用一个插件，它们必须保留为 li 项目。我认为这可以用 javascript 相当容易地完成，但如果可能的话，我正在寻找一个 css 解决方案。（警告，需要在 IE7 中工作）希望这是有道理的，谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T00:33:25.343

## 对于IE7？

## 和纯 CSS？

## 并且所有第 1 行（Div “one”）等高？

## 并且所有列都等高？

答案是……不可能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-09T23:12:51.727

好不容易，还是用JavaScript。

这实际上是 Flex Box Layout 的设计目的之一。所以你会有这样的事情：

```
#mylist {
    display: flex;
    flex-flow: row wrap;
}
#mylist>li {
    flex: 1 1 100%;
} 
```

它应该给所有元素相同的高度。有关更多选项，请参阅[完整的 Flex Box 布局规范](http://www.w3.org/TR/css3-flexbox/)。

只要确保你有适当的供应商前缀，你就可以开始了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T03:40:18.533

如果没有一些 HTML 更改，您需要的东西是不可能的。

一种可能的替代方法是，通过一些 HTML 更改，将元素威胁为表格，

*   作为表格行和表格单元格。您需要将所有元素放在同一行 (li) 中，并且需要一个额外的 li 元素作为页脚

    例如：

    ```
    <ul>
        <li>
            <div class="one">Variable Height Title</div>
            <div class="one">Variable Height Title that Might be two lines long</div>
            <div class="one">Variable Height Title</div>
        </li>
        <li>
            <div class="two">Fixed height middle block</div>
            <div class="two">Fixed height middle block</div>
            <div class="two">Fixed height middle block</div>
        </li>
        <li>
            <div class="three">Variable height middle block<br />more content<br /> more contentmore content<br /> more content<br /> more content</div>
            <div class="three">Variable height middle block</div>
            <div class="three">Variable height middle block</div>
        </li>
        <li>
            <div class="four">Fixed height footer</div>
            <div class="four">Fixed height footer</div>
            <div class="four">Fixed height footer</div>
        </li>

    </ul> 
    ```

    你可以看看这里：http: [//jsfiddle.net/WffHD/25/](http://jsfiddle.net/WffHD/25/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T23:13:45.340

编辑后。而不是使用高度，只需使用垂直对齐。（在 CSS 表中工作）

```
ul { display: table; } /* Behave as table */
ul > li { display: table-cell; vertical-align: bottom; } 
```

[http://jsfiddle.net/wC4RF/4/](http://jsfiddle.net/wC4RF/4/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-16T09:04:44.943

这个问题有两个方面需要注意：
1- 的高度 相等 2- 第一个 div 的高度 `li`相等

这是第一步：
有一个简单但诡计多端的纯 css 解决方案，它在 IE6+ 中有效且效果很好（我之前已经测试过），但需要一点勇气和标记。
第一的：

```
ul {
   display: block;
   overflow: hidden;
}
ul li {
   float: left;
   margin-bottom: -99999px;
   padding-bottom: 99999px;
} 
```

非常简单，我们强制列的高度非常高，然后用隐藏的溢出将它们切断，然后我们用大量的底部填充强制列更高，然后我们再次降低包装器的高度以等量的负底部边距备份。这给了我们我们需要的效果。
而对于**第二部分**，我唯一能实现的唯一方法就是将它们从结构中切断并将它们放在另一个结构中，就像上面提到的那样，所以用一点 css 魔法，它们似乎都只是一个结构（假设你不想为此使用js）。
希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-17T15:57:21.190

从 William G. Rivera 的答案中派生版本，以便在包括 IE7 在内的所有浏览器中保持一致的外观，`display: table;`免费。这有点作弊，并且不会使 div 的高度相等，但在视觉上这是相同的

HTML

```
<ul>
  <li class="one">
    <div class="one">Variable Height Title</div>
    <div class="one">Variable Height Title that Might be two lines longgggggg</div>
    <div class="one">Variable Height Title</div>
    <div class="clear"></div>
  </li>
  <li class="two">
    <div class="two">Fixed height middle block</div>
    <div class="two">Fixed height middle block</div>
    <div class="two">Fixed height middle block</div>
    <div class="clear"></div>
  </li>
  <li class="three">
    <div class="three">Variable height middle block<br />more content<br /> more contentmore content<br /> more content<br /> more content</div>
    <div class="three">Variable height middle block</div>
    <div class="three">Variable height middle block</div>
    <div class="clear"></div>
  </li>
  <li class="four">
    <div class="four">Fixed height footer</div>
    <div class="four">Fixed height footer</div>
    <div class="four">Fixed height footer</div>
    <div class="clear"></div>
  </li>
</ul> 
```

CSS

```
div {
  float: left;
  width:33%;
}

.one, .three {
  background-color:blue;
}
.two, .four {
  background-color:green;
}

.clear {
    width: 100%;
    clear: both;
    float: none;
    height: 0;
} 
```

[http://jsfiddle.net/YWtSe/2/](http://jsfiddle.net/YWtSe/2/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-11T12:33:07.783

对于 jQuery 解决方案（这可能只重写为 javascript）：

```
var liPerRow = 3; // The amount of li items on each row
var maxHeight = 0;

for (var i = 0; i < $("ul").children().length; i++) {
    if (i % liPerRow == 0) {
        // split the list in the li items for just this 'row'
        var items = $($("ul").children().splice(i, liPerRow));
        // get the highest Height value in this list
        maxHeight = Math.max.apply(null, items.map(function () {
            return $(this).height();
        }).get());

        items.height(maxHeight);
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-31T09:08:35.980

为了使 user1797792 的解决方案更进一步，您需要清除元素上的显式内联高度声明，以便能够在响应式布局中重用该函数。在这种情况下，我正在调整名为“prods”的父 ul 中的 li 元素的大小。

```
function resizeProds(){
    for (var i = 0; i < $("#prods").children().length; i++) {
        if (i % liPerRow == 0) {
            // split the list in the li items for just this 'row'
            var items = $($("#prods").children().splice(i, liPerRow));
            items.height('');
            // get the highest Height value in this list
            maxHeight = Math.max.apply(null, items.map(function () {
                return $(this).height();
            }).get());
            items.height(maxHeight);
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-01-09T23:16:38.467

看看马修詹姆斯泰勒的[这篇文章](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)。用 CSS 做这件事有点复杂。但这是唯一的“好”方式。您还可以使用 javascript 并计算最高列并将此高度应用于其他两个。

你需要几个这样的容器：

```
<div id="container3">
  <div id="container2">
    <div id="container1">
      <div id="col1">Column 1</div>
      <div id="col2">Column 2</div>
      <div id="col3">Column 3</div>
    </div>
  </div>
</div> 
```

比你需要重新定位每一列：

```
#container3 {
    float:left;
    width:100%;
    background:green;
    overflow:hidden;
    position:relative;
}
#container2 {
    float:left;
    width:100%;
    background:yellow;
    position:relative;
    right:30%;
}
#container1 {
    float:left;
    width:100%;
    background:red;
    position:relative;
    right:40%;
}
#col1 {
    float:left;
    width:26%;
    position:relative;
    left:72%;
    overflow:hidden;
}
#col2 {
    float:left;
    width:36%;
    position:relative;
    left:76%;
    overflow:hidden;
}
#col3 {
    float:left;
    width:26%;
    position:relative;
    left:80%;
    overflow:hidden;
} 
```

# drawing - 识别此视频中的建模软件？

> ID：14248099
> 
> 赞同：1
> 
> 时间：2013-01-09T23:06:25.337
> 
> 标签：drawing, modeling

该[视频](http://www.youtube.com/watch?v=isfqiYG7wiI)描述了 Steambox 在 2013 年 CES 上的首次亮相，并有一段从 0:38 开始的短片展示了正在设计的产品。

任何人都可以识别用于创建模型的软件吗？

该软件似乎还使用屏幕上的手写笔输入。这在建模程序中很常见吗？

# crystal-reports - Crystal Reports：抑制是在下一页上隐藏记录

> ID：14248101
> 
> 赞同：0
> 
> 时间：2013-01-09T23:06:40.420
> 
> 标签：crystal-reports, suppression

我有一个 Crystal Report，我只想显示第一个 ItemNum 行。

我使用以下表达式 (?) 来抑制后续记录。

`Previous ({ItemHistory.ItemNum}) = ({ItemHistory.ItemNum})`

我的问题是，当我使用仅选择一个 ItemNum 的参数时，我想要出现的第二页上的相同 ItemNum（因为它属于不同的储藏室）也会被抑制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:37:51.080

我想到了。我刚刚添加了检查以确保不执行对下一页（新储藏室）上 ItemNum 的抑制。

```
Previous ({ItemHistory.ItemNum}) = 
{ItemHistory.ItemNum} 
and 
Previous({ITEMHISTORY.STOREROOM}) = 
{ITEMHISTORY.STOREROOM} 
```

# ruby - 模块的 RSpec 测试

> ID：14248109
> 
> 赞同：0
> 
> 时间：2013-01-09T23:07:25.377
> 
> 标签：ruby, rspec

我是 RSpec 和 TDD 的新手。我想知道是否有人可以帮助我创建一个非常适合这个模块的测试：

```
module Kernel
  # define new 'puts' which which appends "This will be appended!" to all puts output 
  def puts_with_append *args
    puts_without_append args.map{|a| a + "This will be appended!"}
  end

  # back up name of old puts
  alias_method :puts_without_append, :puts

  # now set our version as new puts
  alias_method :puts, :puts_with_append
end 
```

我希望我的测试检查“puts”中的内容是否以“这将被附加！”结尾。那是一个足够的测试吗？我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:46:18.033

最好的测试测试你想要实现的目标，而不是你如何实现它......将测试与实现联系起来会使你的测试变得脆弱。

因此，您尝试使用此方法实现的是在加载扩展程序时更改“puts”。测试 puts_with_append 方法并没有达到这个目标......如果你后来不小心将它重新命名为其他东西，你想要的 puts 更改将不起作用。

但是，在不使用实现细节的情况下进行测试会相当困难，因此，我们可以尝试将实现细节推送到它们不会改变的地方，比如*STDOUT*。

## 只是测试内容

```
$stdout.stub!(:write)
$stdout.should_receive(:write).with("OneThis will be appended!")
puts "One" 
```

## 全面测试

我将在接下来的一天左右把它变成一篇博文，但我认为你还应该考虑到你已经为一个和多个参数得到了想要的结果，并且你的测试应该易于阅读。我将使用的最终结构是：

需要“rspec” 需要“./your_extention.rb”

```
describe Kernel do
  describe "#puts (overridden)" do
    context "with one argument" do
      it "should append the appropriate string" do
        $stdout.stub!(:write)
        $stdout.should_receive(:write).with("OneThis will be appended!")
        puts "One"
      end
    end

    context "with more then one argument" do
      it "should append the appropriate string to every arg" do
        $stdout.stub!(:write)
        $stdout.should_receive(:write).with("OneThis will be appended!")
        $stdout.should_receive(:write).with("TwoThis will be appended!")
        puts("One", "Two")
      end
    end
  end
end 
```

# inotifypropertychanged - 适配现有 POCO 实例实现 INotifyPropertyChanged

> ID：14248110
> 
> 赞同：0
> 
> 时间：2013-01-09T23:07:32.343
> 
> 标签：inotifypropertychanged

假设您的代码从外部源接收实例，并且您无法控制实例的创建方式。该实例未实现`INotifyPropertyChanged`。是否有可以将其传递给的适配器，例如：

```
var adapter = new ChangeNotifierAdapter( instance ); 
```

这样适配器就实现了 INotifyPropertyChanged 并且随后将针对?`PropertyChanged`的所有属性更改引发其事件。`instance`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T02:40:35.293

如果您可以保证对实例的所有更改都将通过您的包装器进行，那么您可以使用代理 -[动态](https://www.google.com.au/search?q=inotifypropertychanged%20dynamic%20proxy)代理或在设计时生成的代理（注意：如果您仍然必须公开具体类而不是接口它'必须是动态代理）。

如果这不是真的（或者即使是，但对一个属性的更改会影响另一个属性的值），那么实现这一点的唯一方法是通过轮询。包装器必须定期轮询对象的所有属性，确定哪些已更改并相应地引发事件。这很混乱，并且可能会严重消耗移动设备的电池电量。

当然，两者都很糟糕。映射到实现它的对象通常是更好的解决方案。

# ruby-on-rails - 遍历动态 JSON 键

> ID：14248113
> 
> 赞同：0
> 
> 时间：2013-01-09T23:07:43.147
> 
> 标签：ruby-on-rails, ruby

使用：

```
JSON.parse(response.read_body) 
```

返回此哈希：

```
{
    "stats": {
        "2012-10-31": 2637, 
        "2012-10-30": 2873, 
        "2012-12-14": 2894, 
        "2012-12-08": 2906, 
        "2012-12-09": 3357, 
        "2012-11-30": 4959
    }
} 
```

问题是日期键可以是任何日期值。

我想要所有值的总和。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:14:05.063

您可以使用 Ruby Enumerable 的 `reduce`方法。在我的示例中，我没有进行任何错误处理，但如果数据来自 API，您可能需要处理错误或丢失的数据。

```
JSON.parse(response.read_body)["stats"].reduce 0 do |memo, kvp|
   memo + kvp.last
end 
```

* * *

编辑：

选项 2 是更多的忍者：

```
JSON.parse(response.read_body)["stats"].values.reduce(&:+) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:16:25.003

如果你在 Rails 中，你可以使用[`Enumerable#sum`](http://apidock.com/rails/Enumerable/sum)：

```
JSON.parse(response.read_body)["stats"].values.sum 
```

# git - Git：自初始化/克隆以来我*签出*的提交历史

> ID：14248118
> 
> 赞同：1
> 
> 时间：2013-01-09T23:08:15.563
> 
> 标签：git

假设我有一个 git 存储库，我**从不提交**更改，**只使用它来读取**其内容。我时不时地从原始远程拉动以了解最新的变化。

有没有办法让我知道自从我克隆存储库以来我检查了哪些版本？

### 为什么我需要这个？

我遇到的问题是我很少从远程拉取并且项目发展迅速，所以我想跟踪我过去使用过（即签出）的提交，以防我想**恢复**我的工作目录到我知道它对我有用的状态。请记住，我只对我实际签出的提交感兴趣。

**更新：** 看起来我可以用标签（拉之前的标签）来做到这一点，虽然**我不知道如何让 git[只列出我的标签](https://stackoverflow.com/questions/14248425/git-tag-show-only-my-tags)**。不过，我想知道 git 是否**已经**为我记录了我签出的提交。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T23:37:51.943

您可以为此使用 reflog，但仅限于其限制（有时会被清除）。例如 - 对 msysGit 的本地克隆进行快速测试：

```
$ git log -g --oneline --abbrev-commit --grep-reflog "pull:"
53e28dd HEAD@{7}: pull: Fast-forward
947ccf6 HEAD@{9}: pull: Fast-forward
6bf64a4 HEAD@{10}: pull: Fast-forward
20344ae HEAD@{15}: pull: Merge made by the 'recursive' strategy.
31dd6ff HEAD@{36}: pull: Fast-forward
b4546cc HEAD@{37}: pull: Fast-forward
fd6f8d0 HEAD@{38}: pull: Fast-forward
4fc3780 HEAD@{41}: pull: Fast-forward 
```

这显示了过去几个月我碰巧在这个系统上“拉”的提交 ID。`git log -g`是更详细的版本`git reflog`。

如果您只是做一个`git log -g`，您可能会在提供的集合中看到更合适的选择。结帐可能对您有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:36:32.127

参考资料`@{-<n>}`（例如`@{-1}`，`@{-2}`等）将告诉您在当前结帐之前签出的参考资料。您也许可以解析这些列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:11:22.753

是否给你你正在寻找的东西[`git status`](http://git-scm.com/docs/git-status)？[`git log`](http://git-scm.com/docs/git-log)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T23:18:12.583

s --author[`git log`开关](http://gitready.com/advanced/2009/01/20/bend-logs-to-your-will.html)做你想做的事吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T23:20:18.260

不确定我是否理解但`git reflog`显示了更改分支尖端的本地更改的历史记录。

这可能是您正在寻找的东西。但是，历史记录的生命周期有限，并且会`git gc`擦除较旧的条目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-09T23:39:00.273

我相信可以通过`rebase`. 您想要一个`special_master`跟踪`master`但重新设置基准而不是在拉取时合并。它包含的唯一提交是您`pull`在某个时候明确编辑的提交。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-10T00:02:42.580

这看起来像是关于您在 git 中查看的内容的元信息。这超出了 git 的范围。您可以包装 git 命令（就像[git 成就](https://github.com/icefox/git-achievements)所做的那样）并具有辅助存储库版本 HEAD 文件和 HEAD 指示第一个 repo 的 ref 文件）

默认情况下，Reflog 仅存储 90 天的信息。这可以改变。但是，如果您重新克隆，则会丢失此信息。

# c# - 在 wpf 中隐藏默认的 resizegrip

> ID：14248123
> 
> 赞同：1
> 
> 时间：2013-01-09T23:08:36.313
> 
> 标签：c#, wpf, resizegrip

是否可以隐藏 wpf 中的默认调整大小手柄，我有一个自定义窗口，侧面没有手柄，目前正在使用：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="100" Width="200" ResizeMode="CanResizeWithGrip">
    <Grid></Grid>
</Window> 
```

我知道可以改变`ResizeMode="CanResize"`，但这是我能想到的调整窗口大小的唯一方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T01:09:06.707

是的，您可以从窗口中取出默认的调整大小夹点。您需要覆盖 WindowTemplate。以下是您在 XAML 中的操作方式：

```
<Window x:Class="MyNamespace.MyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None" 
        ResizeMode="CanResizeWithGrip"
        AllowsTransparency="True">
    <Window.Template>
        <ControlTemplate>
            <Border>

            </Border>
        </ControlTemplate>
    </Window.Template>
</Window> 
```

在“边框”内将包含您需要在窗口中显示的所有内容（例如文本框）。然后，如果您想要自定义 ResizeGrip，您也可以定义它。希望这可以帮助。

# scala - SBT 0.12.1 下载错误的 SNAPSHOT

> ID：14248128
> 
> 赞同：3
> 
> 时间：2013-01-09T23:09:02.557
> 
> 标签：scala, maven, sbt, ivy

我将一些 SNAPSHOT 依赖项部署到 Sonatype OSS，使用`mvn`. Sonatype 为每个坐标存储许多旧快照。我已部署的 SNAPSHOT 的目录列表位于此问题的底部。

在我的`sbt`游戏中！项目中，我添加了 Sonatype SNAPSHOT 存储库作为解析器。

```
val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
  // Add your own project settings here
  resolvers += "Sonatype snapshots" at "http://oss.sonatype.org/content/repositories/snapshots/"
) 
```

但是，每次都下载错误的 SNAPSHOT。虽然`sbt`应该下载最后部署的 SNAPSHOT (20130109.225335-6)，但它会下载第一个部署的 SNAPSHOT (20130109.210948-1)。

```
$ rm -r ~/.ivy2/cache/edu.washington.cs.knowitall.chunkedextractor/
$ sbt clean compile
[info] Loading project definition from /scratch/github/knowitall/documentextractor/project
[info] Set current project to documentextractor (in build file:/scratch/github/knowitall/documentextractor/)
[success] Total time: 0 s, completed Jan 9, 2013 3:06:41 PM
[info] Updating {file:/scratch/github/knowitall/documentextractor/}documentextractor...
[info] downloading http://repo.typesafe.com/typesafe/snapshots/edu/washington/cs/knowitall/chunkedextractor/chunkedextractor_2.9.2/1.0.1-SNAPSHOT/chunkedextractor_2.9.2-1.0.1-20130109.210948-1.jar ...
[info]  [SUCCESSFUL ] edu.washington.cs.knowitall.chunkedextractor#chunkedextractor_2.9.2;1.0.1-SNAPSHOT!chunkedextractor_2.9.2.jar (1079ms)
[info] Done updating. 
```

知道如何解决此问题并`sbt`下载最新的快照吗？这是一个`sbt`特定的问题还是与它有关`Play!`？

这是我的工件在 Sonatype 上的快照的目录列表。

[https://oss.sonatype.org/content/repositories/snapshots/edu/washington/cs/knowitall/chunkedextractor/chunkedextractor_2.9.2/1.0.1-SNAPSHOT/](https://oss.sonatype.org/content/repositories/snapshots/edu/washington/cs/knowitall/chunkedextractor/chunkedextractor_2.9.2/1.0.1-SNAPSHOT/)

```
chunkedextractor_2.9.2-1.0.1-20130109.210948-1-javadoc.jar   Wed Jan 09 15:09:55 CST 2013    361379   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1-javadoc.jar.md5   Wed Jan 09 15:09:56 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1-javadoc.jar.sha1  Wed Jan 09 15:09:56 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1-sources.jar   Wed Jan 09 15:09:53 CST 2013    17175    
chunkedextractor_2.9.2-1.0.1-20130109.210948-1-sources.jar.md5   Wed Jan 09 15:09:54 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1-sources.jar.sha1  Wed Jan 09 15:09:53 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1.jar   Wed Jan 09 15:09:48 CST 2013    178994   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1.jar.md5   Wed Jan 09 15:09:49 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1.jar.sha1  Wed Jan 09 15:09:49 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1.pom   Wed Jan 09 15:09:49 CST 2013    3725     
chunkedextractor_2.9.2-1.0.1-20130109.210948-1.pom.md5   Wed Jan 09 15:09:50 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.210948-1.pom.sha1  Wed Jan 09 15:09:50 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2-javadoc.jar   Wed Jan 09 16:21:29 CST 2013    363291   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2-javadoc.jar.md5   Wed Jan 09 16:21:30 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2-javadoc.jar.sha1  Wed Jan 09 16:21:30 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2-sources.jar   Wed Jan 09 16:21:27 CST 2013    17195    
chunkedextractor_2.9.2-1.0.1-20130109.222121-2-sources.jar.md5   Wed Jan 09 16:21:27 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2-sources.jar.sha1  Wed Jan 09 16:21:27 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2.jar   Wed Jan 09 16:21:21 CST 2013    177267   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2.jar.md5   Wed Jan 09 16:21:22 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2.jar.sha1  Wed Jan 09 16:21:22 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2.pom   Wed Jan 09 16:21:23 CST 2013    3725     
chunkedextractor_2.9.2-1.0.1-20130109.222121-2.pom.md5   Wed Jan 09 16:21:23 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.222121-2.pom.sha1  Wed Jan 09 16:21:23 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3-javadoc.jar   Wed Jan 09 16:30:25 CST 2013    363291   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3-javadoc.jar.md5   Wed Jan 09 16:30:26 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3-javadoc.jar.sha1  Wed Jan 09 16:30:25 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3-sources.jar   Wed Jan 09 16:30:22 CST 2013    17195    
chunkedextractor_2.9.2-1.0.1-20130109.223017-3-sources.jar.md5   Wed Jan 09 16:30:23 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3-sources.jar.sha1  Wed Jan 09 16:30:23 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3.jar   Wed Jan 09 16:30:18 CST 2013    177267   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3.jar.md5   Wed Jan 09 16:30:18 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3.jar.sha1  Wed Jan 09 16:30:18 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3.pom   Wed Jan 09 16:30:19 CST 2013    3725     
chunkedextractor_2.9.2-1.0.1-20130109.223017-3.pom.md5   Wed Jan 09 16:30:19 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.223017-3.pom.sha1  Wed Jan 09 16:30:19 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4-javadoc.jar   Wed Jan 09 16:47:24 CST 2013    363343   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4-javadoc.jar.md5   Wed Jan 09 16:47:24 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4-javadoc.jar.sha1  Wed Jan 09 16:47:24 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4-sources.jar   Wed Jan 09 16:47:21 CST 2013    17198    
chunkedextractor_2.9.2-1.0.1-20130109.224717-4-sources.jar.md5   Wed Jan 09 16:47:22 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4-sources.jar.sha1  Wed Jan 09 16:47:22 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4.jar   Wed Jan 09 16:47:17 CST 2013    177369   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4.jar.md5   Wed Jan 09 16:47:18 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4.jar.sha1  Wed Jan 09 16:47:17 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4.pom   Wed Jan 09 16:47:18 CST 2013    3725     
chunkedextractor_2.9.2-1.0.1-20130109.224717-4.pom.md5   Wed Jan 09 16:47:19 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.224717-4.pom.sha1  Wed Jan 09 16:47:18 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5-javadoc.jar   Wed Jan 09 16:52:52 CST 2013    363343   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5-javadoc.jar.md5   Wed Jan 09 16:52:52 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5-javadoc.jar.sha1  Wed Jan 09 16:52:52 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5-sources.jar   Wed Jan 09 16:52:49 CST 2013    17198    
chunkedextractor_2.9.2-1.0.1-20130109.225244-5-sources.jar.md5   Wed Jan 09 16:52:50 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5-sources.jar.sha1  Wed Jan 09 16:52:50 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5.jar   Wed Jan 09 16:52:45 CST 2013    177369   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5.jar.md5   Wed Jan 09 16:52:46 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5.jar.sha1  Wed Jan 09 16:52:45 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5.pom   Wed Jan 09 16:52:46 CST 2013    3725     
chunkedextractor_2.9.2-1.0.1-20130109.225244-5.pom.md5   Wed Jan 09 16:52:47 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225244-5.pom.sha1  Wed Jan 09 16:52:46 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6-javadoc.jar   Wed Jan 09 16:53:42 CST 2013    363343   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6-javadoc.jar.md5   Wed Jan 09 16:53:43 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6-javadoc.jar.sha1  Wed Jan 09 16:53:42 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6-sources.jar   Wed Jan 09 16:53:40 CST 2013    17198    
chunkedextractor_2.9.2-1.0.1-20130109.225335-6-sources.jar.md5   Wed Jan 09 16:53:40 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6-sources.jar.sha1  Wed Jan 09 16:53:40 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6.jar   Wed Jan 09 16:53:35 CST 2013    177369   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6.jar.md5   Wed Jan 09 16:53:36 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6.jar.sha1  Wed Jan 09 16:53:36 CST 2013    40   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6.pom   Wed Jan 09 16:53:36 CST 2013    3725     
chunkedextractor_2.9.2-1.0.1-20130109.225335-6.pom.md5   Wed Jan 09 16:53:37 CST 2013    32   
chunkedextractor_2.9.2-1.0.1-20130109.225335-6.pom.sha1  Wed Jan 09 16:53:37 CST 2013    40   
maven-metadata.xml   Wed Jan 09 16:53:43 CST 2013    1244     
maven-metadata.xml.md5   Wed Jan 09 16:53:44 CST 2013    32   
maven-metadata.xml.sha1  Wed Jan 09 16:53:43 CST 2013    40 
```

更新：`build.properties`指定`sbt.version=0.11.3`. 也许 Play 正在强制使用这个旧版本的`sbt`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T17:37:04.600

尝试其中一项是否对您有帮助：

1）运行“更新”

2) 将依赖项修改为 "groupId" %% "artifactId" % "version" changed() 并运行 'update'

# php - 将 .properties 文件解析为数组

> ID：14248132
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:09:30.693
> 
> 标签：php, parsing

我正在尝试为用于 Minecraft 的 server.properties 文件创建某种 GUI，该文件的布局如下所示；

```
level-name: world
server-ip: 123.123.123 
```

该文件还可以在单​​行上包含 ##properties.file 等内容，这可能会增加混乱

所以基本上我需要一种将其拆分为可读格式的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:19:55.713

像这样的东西应该适合你：

```
$file_path = '/some/path/to/properties/file.properties';
$lines = explode("\n", trim(file_get_contents($file_path)));
$properties = array();
foreach ($lines as $line) {
    $line = trim($line);

    if (!$line || substr($line, 0, 1) == '#') // skip empty lines and comments
        continue;

    if (false !== ($pos = strpos($line, ':'))) {
        $properties[trim(substr($line, 0, $pos))] = trim(substr($line, $pos + 1));
    }
}
print_r($properties);
// -> Array
// -> (
// ->     [level-name] => world
// ->     [server-ip] => 123.123.123
// -> ) 
```

# php - 使用 PHP/Codeigniter 连接到 Azure SQL

> ID：14248146
> 
> 赞同：2
> 
> 时间：2013-01-09T23:11:33.847
> 
> 标签：php, codeigniter, azure

过去一天左右，我一直在努力连接到 azure。

我已经完成了这里的所有步骤[https://github.com/WindowsAzure/azure-sdk-for-php](https://github.com/WindowsAzure/azure-sdk-for-php)直到这里的块：

```
DefaultEndpointsProtocol=[http|https];AccountName=[yourAccount];AccountKey=[yourKey] 
```

我认为之前的命名空间调用无效，但我不确定。

当我尝试像这样打电话给班级时

```
$tableRestProxy = ServicesBuilder->getInstance()->createTableService($connectionString); 
```

我收到以下错误：

```
syntax error, unexpected '->' (T_OBJECT_OPERATOR) 
```

如果我将“ServicesBuilder->”更改为“ServicesBuilder::”（如此处所示[）](http://www.windowsazure.com/en-us/develop/php/how-to-guides/table-service/#RetrieveEntity)，我会收到此错误：

```
Fatal error: Class 'ServicesBuilder' not found 
```

我真的不知道我在这一点上缺少什么，也想不出任何其他的尝试。

非常感谢您在正确方向上获得连接的任何帮助。还有一点需要注意：我正在使用 codeigniter 并包含[这个](https://github.com/thomasantony/codeigniter-azure)库，虽然我还没有看到它没有用，因为我什至无法连接到数据库：\

感谢您的帮助-

# android - 更新应用程序时未更新资产文件夹文件

> ID：14248148
> 
> 赞同：4
> 
> 时间：2013-01-09T23:11:49.667
> 
> 标签：android, apk, android-assets

我有一个应用程序 v1.0，它使用保存在资产文件夹中的本地数据库...我已将我的应用程序更新到 1.1 版，在新版本中，内部数据库有不同的条目。

不幸的是，已安装的应用程序继续使用 1.0 版的数据库，我必须卸载应用程序并再次安装才能使用最新版本的数据库。

强迫买家卸载应用程序并重新安装新版本真的是一件坏事……为什么资产文件没有随新版本更新？

**编辑**

我知道发生此问题是因为数据库是从资产文件创建的，并且仅当尚未创建时，这是我的 DatabaseHelper 类

```
public class DataBaseHelper extends SQLiteOpenHelper {
    private static String TAG = "DataBaseHelper"; 
    private static String DB_PATH = "";
    private static String DB_NAME = "MyDatabaseFile";
    private SQLiteDatabase mDataBase;
    private final Context mContext;

    public DataBaseHelper(Context context) {
        super(context, DB_NAME, null, 1);
        DB_PATH = "/data/data/" + context.getPackageName() + "/databases/";
        this.mContext = context;
    }

    public void createDataBase() throws IOException {
        // If database not exists copy it from the assets

        boolean mDataBaseExist = checkDataBase();
        if (!mDataBaseExist) {
            this.getReadableDatabase();
            this.close();
            try {
                copyDataBase();
                Log.e(TAG, "createDatabase database created");
            } catch (IOException mIOException) {
                throw new Error("ErrorCopyingDataBase");
            }
        }
    }

    private boolean checkDataBase() {
        File dbFile = new File(DB_PATH + DB_NAME);
        // Log.v("dbFile", dbFile + "   "+ dbFile.exists());
        return dbFile.exists();
    }

    private void copyDataBase() throws IOException {
        InputStream mInput = mContext.getAssets().open(DB_NAME);
        String outFileName = DB_PATH + DB_NAME;
        OutputStream mOutput = new FileOutputStream(outFileName);
        byte[] mBuffer = new byte[1024];
        int mLength;
        while ((mLength = mInput.read(mBuffer)) > 0) {
            mOutput.write(mBuffer, 0, mLength);
        }
        mOutput.flush();
        mOutput.close();
        mInput.close();
    }

    public boolean openDataBase() throws SQLException {
        String mPath = DB_PATH + DB_NAME;
        // Log.v("mPath", mPath);
        mDataBase = SQLiteDatabase.openDatabase(mPath, null,
                SQLiteDatabase.CREATE_IF_NECESSARY);
        // mDataBase = SQLiteDatabase.openDatabase(mPath, null,
        // SQLiteDatabase.NO_LOCALIZED_COLLATORS);
        return mDataBase != null;
    }

    @Override
    public synchronized void close() {
        if (mDataBase != null)
            mDataBase.close();
        super.close();
    }

    @Override
    public void onCreate(SQLiteDatabase arg0) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

    }

} 
```

当我在 PlayStore 上升级应用程序而不重命名 db 文件时，如何避免这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:28:27.237

> 我有一个应用程序 v1.0，它使用保存在 assets 文件夹中的本地数据库

不，您有一个应用程序 v1.0，它*复制*“保存在资产文件夹中”的数据库并从中创建本地数据库。希望[您`SQLiteAssetHelper`用于此](https://github.com/jgilfelt/android-sqlite-asset-helper).

> 为什么资产文件没有用新版本更新？

资产文件*已*更新。您没有做任何事情来修复您制作的副本。如果您使用`SQLiteAssetHelper`，它有一个处理此类升级的过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:19:45.947

每次对数据库进行更改时，您是否都在更新 DB 助手类中的 DATABASE_VERSION 参数？检查那个。它通常在辅助类中定义如下：

```
private static final int DATABASE_VERSION = 1; 
```

# perl - 从 perl 中的 eval-ed 字符串动态创建 subs

> ID：14248149
> 
> 赞同：1
> 
> 时间：2013-01-09T23:12:10.240
> 
> 标签：perl, eval, perl-data-structures

我需要将数据结构从数组列表转换为树状结构。在开始处理数据之前，我知道树的深度，但我想保持灵活性，以便我可以重用代码。

所以我想到了动态生成子引用（从基于 Moose 的模块中）从数组到树的想法。像这样（以简化的方式）：

```
use Data::Dump qw/dump/;

sub create_tree_builder {
     my $depth = shift;
     return eval join '', 'sub { $_[0]->{$_[', 
                           join(']}->{$_[', (1..$depth)),
                          ']} = $_[',  $depth + 1 , '] }'; 
}

my $s = create_tree_builder(5);
my $tree = {};

$s->($tree, qw/one two three four five/, 'a value');

print dump $tree;

# prints
#  {
#     one => { two => { three => { four => { five => "a value" } } } },
#  } 
```

这为我打开了世界，我发现这个 eval-in 过程很酷的用途——将参数化生成的字符串放入一个函数中（显然，这是一个寻找问题的解决方案）。

然而，感觉有点好得令人难以置信，几乎。

*对*这种做法有什么建议吗？或者改进建议？

我可以清楚地看到，评估任意输入可能不是最安全的事情，但还有什么呢？

# 跟进

感谢所有的答案。我使用了 amon 的代码并进行了一些基准测试，如下所示：

```
use Benchmark qw(:all) ;

$\ = "\n";

sub create_tree_builder {
 my $depth = shift;
 return eval join '', 'sub { $_[0]->{$_[', 
               join(']}->{$_[', (1..$depth)),
              ']} = $_[',  $depth + 1 , '] }'; 
}

my $s = create_tree_builder(5);

$t = sub {
$_[0] //= {};

    my ($tree, @keys) = @_;
    my $value = pop @keys;

    $tree = $tree->{shift @keys} //= {} while @keys > 1;
    $tree->{$keys[0]} = $value;
};

cmpthese(900000, {
        'eval'  => sub { $s->($tree, qw/one two three four five/, 'a value') },
    'build' => sub { $t->($tree, qw/one two three four five/, 'a value') },

}); 
```

结果显然有利于构建树，而不是评估工厂：

```
 Rate build  eval
build  326087/s    --  -79%
eval  1525424/s  368%    -- 
```

我承认我以前可以这样做。我将尝试使用更多随机树（而不是一遍又一遍地分配相同的元素），但我认为结果应该不同。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:39:45.510

编写一个通用的子程序来构建这样一个嵌套的哈希是非常容易的。这种方式比编写一个为特定数量的哈希级别生成这样一个子例程的工厂要简单得多。

```
use strict;
use warnings;

sub tree_assign {

  # Create an empty tree if one was not given, using an alias to the original argument
  $_[0] //= {};

  my ($tree, @keys) = @_;
  my $value = pop @keys;

  $tree = $tree->{shift @keys} //= {} while @keys > 1;
  $tree->{$keys[0]} = $value;
}

tree_assign(my $tree, qw/one two three four five/, 'a value');

use Data::Dump;
dd $tree; 
```

**输出**

```
{
  one => { two => { three => { four => { five => "a value" } } } },
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:32:25.843

### 为什么这可能是个坏主意

1.  可维护性。

    eval 的代码必须首先在程序员的头脑中进行 eval —— 这并不总是一件容易的事。本质上，评估是混淆。

2.  速度。

    `eval`在正常执行恢复之前重新运行 perl 解析器和编译器。但是，可以使用相同的技术通过推迟子程序的编译直到需要它们来获得启动时间。这*不是*这样的情况。

3.  有不止一种方法可以做到这一点。

    我喜欢匿名子例程，但您不必使用 an`eval`来构造它们。无论如何，它们都是关闭的。就像是

    ```
    ...;
    return sub {
      my ($tree, $keys, $value) = @_;
      $#$keys >= $depth or die "need moar keys";
      $tree = $tree->{$keys->[$_]} for 0 .. $depth - 1;
      $tree->{$keys->[$depth]} = $value;
    }; 
    ```

    和

    ```
    $s->($tree, [qw(one two three four five)], "a value"); 
    ```

    会做一些惊人的相似的事情。（实际上，使用`$depth`now 看起来像一个设计错误；完整的路径已经由键指定。因此，创建一个普通的命名子程序可能是最好的。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T00:12:37.470

根据他们的评论了解 OP 做得更好，并反复研究 Borodin 的代码，我建议更改界面。与其编写一个子程序来在树的深处应用一个值，我会编写一个子程序来创建一个空的子树，然后在那个子树上工作。这使您可以在子树上有效地工作，而不必在每个操作中遍历树。

```
package Root;

use Mouse;

has root =>
  is    => 'ro',
  isa   => 'HashRef',
  default => sub { {} };

sub init_subtree {
    my $self = shift;
    my $tree = $self->root;

    for my $key (@_) {
        $tree = $tree->{$key} //= {};
    }

    return $tree;
}

my $root = Root->new;
my $subtree = $root->init_subtree(qw/one two three four/);

# Now you can quickly work with the subtree without having
# to walk down every time.  This loop's performance is only
# dependent on the number of keys you're adding, rather than
# the number of keys TIMES the depth of the subtree.
my $val = 0;
for my $key ("a".."c") {
    $subtree->{$key} = $val++;
}

use Data::Dump;
dd $root; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T00:54:23.170

[Data::Diver](http://search.cpan.org/perldoc/Data%3a%3aDiver)是你的朋友：

```
use Data::Diver 'DiveVal', 'DiveRef';
my $tree = {};

DiveVal( $tree, qw/one two three four five/ ) = 'a value';

# or if you hate lvalue subroutines:
${ DiveRef( $tree, qw/one two three four five/ ) } = 'a value';

use Data::Dump 'dump';
print dump $tree; 
```

# python - 使用 Python 写入 Google 文档

> ID：14248152
> 
> 赞同：5
> 
> 时间：2013-01-09T23:12:20.180
> 
> 标签：python, google-drive-api

我有一些数据要写入 Google Docs 中的一个简单的多列表。这种方式是否太麻烦以至于无法开始尝试？我只会在 XHTML 中呈现它，但我的客户在 Google Docs 上设置了一个非常具体的工作流程，她不希望我干预。Google Docs API 似乎更倾向于更新元数据和对文件格式进行简单的更改，而不是只使用原始数据和一些格式化规则来完成编写整个文档的任务。我是否遗漏了什么，或者是否有任何其他库可以实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:19:39.863

从[文档](https://developers.google.com/google-apps/documents-list/#what_can_this_api_do)：

> 这个 API 能做什么？
> 
> Google Documents List API 允许开发人员创建、检索、更新和删除 Google Docs（包括但不限于文本文档、电子表格、演示文稿和绘图）、文件和集合。

因此，也许您可​​以将数据暂时保存到 Excel 工作表中，然后上传并转换。

保存到 excel 可以通过以下方式完成`xlwt`：

```
import xlwt
workbook = xlwt.Workbook()
sheet = workbook.add_sheet('Sheet 1')
sheet.write(0,1,'First text')
workbook.save('test.xls') 
```

# c++ - 如何将模板成员函数的参数转发到C++中的成员基类指针

> ID：14248153
> 
> 赞同：2
> 
> 时间：2013-01-09T23:12:26.307
> 
> 标签：c++, templates

我有一个类`Foo`，它使用 CRTP 从父类继承模板方法，避免必须提供几十个单独的成员方法。像这样的东西：

```
class Foo : public SomeBarClass<Foo>
{
//..
//from SomeBarClass
public:
    template <class T> void onMsg(T* msg);

private:
    IFoxMod* foxMod_;
}; 
```

现在，在实现中`onMsg`，我想要这样的东西：

```
template <class T>
void Foo::onMsg(T* msg)
{
    if (foxMod_->shouldDoStuff(msg))
    {
        //do stuff
    }
} 
```

并且可以有多种`foxMod_`类型（其中一种在`Foo`构造函数中通过配置文件中给出的名称进行实例化），只要它们遵守提供`bool shouldDoStuff`方法的公共接口即可。问题在于，这导致我定义以下内容：

```
struct IFoxMod
{
    virtual ~IFoxMod() {}
    template <class T> shouldDoStuff(T* msg) = 0;
}; 
```

对于所有`FoxMods`要实现的东西（比如，`class redMountainLogic : public IFoxMod`可能有它自己的辨别方式，当它适合做事情时）。

这是非法的，因为一个人不能有虚拟模板，我正试图找到一种解决方法。基本上，我需要动态调度，但我传递的参数是一个模板。我想不出解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T05:36:43.163

虚函数表似乎与模板特化不太协调。不会太令人惊讶。VFT 通常基于声明顺序，而模板并不真正存在。一种解决方案是手动重新创建 VFT。

这是一个例子。它可能会更干净一些，但它确实有效。

```
#include<iostream>
using namespace std;

// Message.h

template<int n>
struct MessageByInt {
  typedef int Msg;
};

struct MessageOfHope {
  int a;
  int b;
  static const int id = 0;
};
template<> struct MessageByInt<MessageOfHope::id> { typedef MessageOfHope Msg; };

struct MessageOfDoom {
  int b;
  int c;
  static const int id = 1;
};
template<> struct MessageByInt<MessageOfDoom::id> { typedef MessageOfDoom Msg; };

const int nMessages = 2;

// IFoxMod.h

typedef bool(*callback)(void*);

struct IFoxMod {
  callback vtable[nMessages];
  template<typename MSG>
  bool ShouldDoWork(MSG* msg) {
    return vtable[MSG::id](msg);
  }
};

template<typename TESTER, int n>
struct filler {
  typedef typename MessageByInt<n>::Msg MSG;
  typedef typename TESTER::template Tester<MSG> Tester;
  static void fill(IFoxMod* impl) {
    impl->vtable[n] = reinterpret_cast<callback>(&Tester::ReallyShouldDoWork);
    filler<TESTER,n-1>::fill(impl);
  }
};

template<typename TESTER>
struct filler<TESTER,-1>{
  static void fill(IFoxMod* impl) {
  }
};

// RedFox.h

struct RedFoxTester {
  template<typename MSG>
  struct Tester { // This struct exists to allow partial specialization
    static bool ReallyShouldDoWork(MSG* msg) {
      return msg->b == 2;
    }
  };
};

struct RedFoxMod : public IFoxMod {
  RedFoxMod() {
    filler<RedFoxTester,nMessages-1>::fill(this);
  }
};

//Main

main() {
  IFoxMod* fm = new RedFoxMod();
  MessageOfHope mohb2 = {1, 2};
  MessageOfDoom modb2 = {2, 3};
  MessageOfHope mohbn2 = {2, 3};
  MessageOfDoom modbn2 = {1, 2};
  cout << fm->ShouldDoWork(&mohb2) << ", " << fm->ShouldDoWork(&modb2) << endl;
  cout << fm->ShouldDoWork(&mohbn2) << ", " << fm->ShouldDoWork(&modbn2) << endl;
} 
```

# asp.net-web-api - 使用 Thinktecture.IdentityModel 在 WebAPI、MVC 和 IIS 中支持 CORS

> ID：14248154
> 
> 赞同：0
> 
> 时间：2013-01-09T23:12:30.147
> 
> 标签：asp.net-web-api

我正在尝试使用 Thinktecture.IdentityModel 实现 CORS，如下面的链接中所述：

[http://brockallen.com/2012/06/28/cors-support-in-webapi-mvc-and-iis-with-thinktecture-identitymodel/](http://brockallen.com/2012/06/28/cors-support-in-webapi-mvc-and-iis-with-thinktecture-identitymodel/)

我尝试了 Web API 方法，但没有成功。所以我去了IIS路线。

```
<system.webServer>
  <modules runAllManagedModulesForAllRequests=“true“&gt;
    <add name=“MvcCorsHttpModule“
         type=“Thinktecture.IdentityModel.Http.Cors.Mvc.MvcCorsHttpModule“/>
  </modules>
</system.webServer> 
```

然后再次在 global.asax 中配置设置：

```
protected void Application_Start()
{
    …
    RegisterCors(MvcCorsConfiguration.Configuration);
}

private void RegisterCors(MvcCorsConfiguration corsConfig)
{
    corsConfig
        .ForResources(“Products.GetProducts”)
        .ForOrigins(“http://foo.com&#8221;)
        .AllowAll();
} 
```

现在，它可以在我的本地主机（Windows 8、VS 2012）中运行，但是当我将它推送到产品（IIS 6）时，它就不起作用了。是否有其他设置可以使其在 IIS 6 中工作？为什么它会在本地主机中工作，但在我将其推送到生产环境时却不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T08:42:26.663

[您的问题与此](http://blog.dczweb.net/post/Migration-of-ASPNET-app-from-IIS6-to-IIS7-%2875%29.aspx)相反。

模块在 IIS6 到 IIS7+ 中的注册方式不同。

```
<configuration>
    <system.web>
      <httpModules>
        <add name="MvcCorsHttpModule" type="Thinktecture.IdentityModel.Http.Cors.Mvc.MvcCorsHttpModule"/>
      </httpModules>
    </system.web>
</configuration> 
```

# spring - 如何使调用另一个服务方法的服务方法具有事务性？

> ID：14248157
> 
> 赞同：0
> 
> 时间：2013-01-09T23:12:36.357
> 
> 标签：spring, hibernate, jpa, transactions, annotations

我正在使用 Spring 3.1.1.RELEASE、Hibernate 4.1.0.Final、JPA 2.0 和 MySQL 5.5 我在 Spring 应用程序上下文文件中定义事务，如下所示：

```
 <jee:jndi-lookup jndi-name="java:jboss/springboard/sbpersistence" id="entityManagerFactory"
                 expected-type="javax.persistence.EntityManagerFactory" />

    <bean id="entityManager" class="org.springframework.orm.jpa.support.SharedEntityManagerBean">
            <property name="entityManagerFactory" ref="entityManagerFactory"/>
    </bean>

    <tx:jta-transaction-manager /> 
```

我有一个具有以下方法的 Spring 服务类：

```
@Service
@Transactional
public class UserServiceImpl implements UserService
{

        @Override
        public User create(String firstName,
                   String middleName,
                   String lastName,
                   String userName,
                   String password,
                   String url,
                   Role role,
                   Organization org,
                   final Set<Contract> contracts)
        {
            …
            return userDao.save(user);
        }

        @Override
        public User createSampleUser(String firstName,
                             String middleName,
                             String lastName,
                             String userName,
                             String password,
                             String url,
                             Role role,
                             State state,
                             List<Product> products,
                             Date activationDate,
                             Date expirationDate)
        {        
            …
            return create(firstName,
                  middleName,
                  lastName,
                  userName,
                  password,
                  url,
                  role,
                  sampleDistrict,
                  contracts);
        } 
```

请注意，第二个方法调用第一个服务方法。我的问题是什么是适当的注释（如果有的话）来表明我希望第二种方法中的所有内容都被视为一个原子工作单元？我很困惑，因为我的第一个方法是自动@Transactional。

谢谢， - 戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:32:35.553

**根据评论更新**

* * *

`create()`您可以使用以下传播注释该方法`REQUIRED`：

```
 @Override
    @Transactional(propagation = Propagation.REQUIRED)
    public User create(String firstName,
               String middleName,
               String lastName,
               String userName,
               String password,
               String url,
               Role role,
               Organization org,
               final Set<Contract> contracts)
    {
        …
        return userDao.save(user);
    } 
```

`REQUIRED`意味着如果有当前事务，它将使用相同的事务。否则，它将为要在其中执行的方法创建一个新事务。javadoc 用于`REQUIRED`：

> 支持当前事务，如果不存在则创建一个新事务。类似于同名的 EJB 事务属性。这是事务注释的默认设置。

根据 javadoc 的最后一条评论，这是默认的事务传播设置，因此从技术上讲，您不需要注释，但我几乎总是将其放入以便清楚（以防默认更改！）。

# scala - 集成 Play 2 应用程序的 IntelliJ 抛出的库“scala-2.10.0-RC1 not used”

> ID：14248159
> 
> 赞同：2
> 
> 时间：2013-01-09T23:12:42.690
> 
> 标签：scala, intellij-idea, playframework-2.0

我刚刚生成了一个新的 Play！应用程序，版本 2.1-RC1。

这包括两个 Scala 编译器/库对：

*   斯卡拉 2.9.2
*   斯卡拉 2.10.0-RC1

整个井在 IntelliJ IDEA 12 中编译，但如图所示会出现**警告**：

![抱怨未使用 Scala 库](../Images/4d19b70aa0bf09d4b68ea4cafad38a09.png)

似乎使用另一个编译器来代替 2.10.0-RC1。

但是，我的 Scala 方面配置如下：

![Scala Facet 配置了 2.10.0-RC1](../Images/12c9fa1ee0cace1aecaaac4398df550f.png)

**可能是什么警告原因？**

我准确地说我还有一个 Scala 变量环境（用于 shell Scala 命令）配置为指向 scala-2.10.0-RC2，但我很好地想象 IntelliJ 基于用户在 Scala Facet 中指示的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:30:13.573

您可以从库中删除该 .jar，它没有被使用，因为它是由 IntelliJ SBT plubin 冗余生成的。

# php - Zend_Form 出现 324 错误

> ID：14248163
> 
> 赞同：2
> 
> 时间：2013-01-09T23:12:58.897
> 
> 标签：php, forms, zend-framework, zend-form

当我尝试在 ZF **v1.12.1**中显示表单时，我收到 Error: 324 in chrome 。我已经完全按照官方网站中的官方示例“快速入门指南”中的方式完成了它，并且仍然相同。在我找到 Grumpy's（不知道第二个名字的拼写方式（SORRY ABOUT THAT））之后，这段代码：

```
class Application_Form_Login extends Zend_Form
{
    public function __construct($options = null)
    {
        parent::__construct($options);
        $this->setAction($options['action'])->setMethod('post');

        $email = new Zend_Form_Element_Text('name', array('required' => true));
        $pass = new Zend_Form_Element_Password('password', array('required' => true));
        $submit = new Zend_Form_Element_Submit('submit', array('label' => 'Login', 'ignore' => true));
        $this->addElement(array($email, $pass, $submit));
    }
} 
```

在我的使用中更好，更有用。当我尝试运行任何一个示例（在官方文档或他的示例中）时，任何方式都会在 chrome 中出现此错误：

> 错误 324 (net::ERR_EMPTY_RESPONSE)：服务器关闭连接而不发送任何数据。

尝试了所有可能的修复和一切（防火墙关闭，禁用 chrome 中的网络预测等）都没有帮助。当我在调用表单时评论代码时，一切都重新上线。我在用：

> 版本 22.0.1229.94 Ubuntu 12.10 (161065) 铬

这个问题有什么可能的解决方法吗？

PS：我正在使用以下代码调用表单：

```
public function indexAction() 
    {
        $form = new Application_Form_Login(array('action' => '/index/index'));

        $this->view->form = $form;

    } 
```

只有在控制器中，当问题得到解决时，其他所有内容都将被添加。

PS2：在向 ZF 提交问题之前想在这里问一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:25:07.813

`$this->addElements(array($email, $pass, $submit));`

用于`addElements`添加多个元素

# ember.js - 如何让 ArrayController 忽略 DS.Store 的瞬态记录

> ID：14248164
> 
> 赞同：2
> 
> 时间：2013-01-09T23:13:11.410
> 
> 标签：ember.js, ember-data

我有一个通过 ClientsController 显示的客户端列表，其内容设置为 Client.find()，即 RecordArray。用户通过 ClientController 创建一个新客户端，其内容在路由处理程序中设置为 Client.createRecord()。

一切正常，但是，当用户填写客户端的创建表单时，客户端列表会更新为新的客户端记录，即在路由处理程序中创建的记录。

让 RecordArray/Store 在保存记录之前只知道新记录的最佳方法是什么？

更新：我最终根据对象状态过滤了列表

```
{{#unless item.isNew}} Display the list {{/unless}} 
```

更新 - 2 这是使用过滤器的另一种方法，但是必须首先通过 find 方法加载商店， App.Client.find().filter() 的行为似乎与单独调用这两种方法的行为方式不同。

```
// Load the store first     
App.Client.find();
    var clients = App.Client.filter(function(client){            
        console.info(client.get('name') + ' ' + client.get('isNew'));  
        return !client.get('isNew');
    });                   
    controller.set('content',clients); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T11:55:52.650

解决这个问题的几种方法：

首先，处理客户端列表的路由/状态必须不遗余力地过滤掉另一个不相关状态（即 newClient 状态）留下的垃圾，这是非常混乱的。我认为在离开 newClient 状态之前删除垃圾记录会更好，a la

```
if(client.get("isNew")) {
  client.deleteRecord();
} 
```

这将确保它不会蔓延到 clientIndex 路由或任何其他不需要额外工作来过滤掉垃圾记录的客户端列表路由。理想情况下，此代码将位于`exit`您的路由函数中，`newClient`因此它可以在路由器转换到另一个将调用的状态之前删除记录`Client.find()`

但还有一个更好的惯用解决方案：[https ://gist.github.com/4512271](https://gist.github.com/4512271)

（不确定您使用的是哪个版本的路由器，但这两者都适用）

解决方案是使用事务：而不是`createRecord()`直接`Client`调用 on ，而是调用`createRecord()`事务，以便新的客户端记录与该事务相关联，然后您需要做的就是调用 transaction.rollback() in `exit`-- 你不'甚至不需要调用`isNew`任何东西，如果保存了客户端记录，显然不会回滚。

这也是编辑记录的有用模式：1）在`enter`状态上创建事务并将记录添加到其中，例如

```
enter: function(router, client) {
     this.tx = router.get("store").transaction();
     this.tx.add(client); 
}, 
```

然后在状态上进行同样的事情`exit`：

```
exit: function(router, client) {
     this.tx.rollback();
}, 
```

这样，如果用户完成表单并提交到服务器，回滚将正确/方便地什么都不做。如果用户编辑了一些表单字段但在中途退出，你的回调将恢复未保存的更改，这样你就不会在你的路由`exit`中弹出一些肮脏的僵尸客户端显示它是未保存的更改。`clientIndex`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:24:49.743

不是 100% 确定，你可以尝试设置 ClientsController 的内容

```
Client.filter(function(client){
  return !client.get('isNew'));
}); 
```

编辑：为了使这项工作，您必须首先使用 Client.find() 加载存储。

# c - 无法将字符串保存到指向数组的指针中

> ID：14248165
> 
> 赞同：1
> 
> 时间：2013-01-09T23:13:14.383
> 
> 标签：c, string, file, pointers, io

我正在尝试将某些单词保存到指向数组（**valid_words）的指针中，但我遇到了一个我不明白的问题。下面是我尝试使用的功能，最终结果是根据 iline 和 dline 相等时的条件，valid_words 包含所有有效单词。

```
void CheckFile(char *input_file, char *dictionary_file, char *output_file, char **valid_words)
{
    /* Open files as read or append */
    FILE *input, *dictionary, *output;
    input = fopen(input_file, "r");
    dictionary = fopen(dictionary_file, "r");
    output = fopen(output_file,"a");
    int word_count = 0;

    /* Read from files */
    if (input != NULL && dictionary!= NULL)
    {   
        char *iline = malloc(MAXSIZE*sizeof(char)); 
        char *dline = malloc(MAXSIZE*sizeof(char));

        while (fgets (iline, sizeof iline, input) != NULL)
        {   
            while (fgets (dline, sizeof dline, dictionary) != NULL)
            {   
                trimwhitespace(iline);
                trimwhitespace(dline);
                if (strcasecmp(iline, dline) == 0 ) 
                {   
                    fprintf(output, "%s\n",iline);
                    valid_words[word_count] = iline;
                    printf("Word Count: %d\n", word_count);
                    printf("At Zero: %s\n", valid_words[0]);
                    printf("Valid Word: %s\n", valid_words[word_count]);
                    printf("Actual Word: %s\n", iline);
                    word_count++;
                }   

            }   
            rewind(dictionary);
        }   

        fclose(input);
        fclose(dictionary);
        fclose(output);
        free(iline);
        free(dline);
    }   
    else
    {   
        printf("An error has occured\n");
    }   
} 
```

我得到的当前输出是

```
Word Count: 0
At Zero: miles
Valid Word: miles
Actual Word: miles
Word Count: 1
At Zero: limes
Valid Word: limes
Actual Word: limes
Word Count: 2
At Zero: smile
Valid Word: smile
Actual Word: smile
Word Count: 3
At Zero: slime
Valid Word: slime
Actual Word: slime 
```

我期待在零：总是输出“英里”，但这并没有发生。调用该函数后，打印 valid_words[i] 不会打印任何内容。如果有人可以帮助我，我将非常感激，并且非常愿意接受任何批评。你可以在这里找到完整的实现[http://pastebin.com/TjxLRVaC](http://pastebin.com/TjxLRVaC) 谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:42:08.180

为什么它不起作用的答案是 -

```
valid_words[word_count] = iline; 
```

您应该`strcpy`在确保 in 中的元素`valid_words`可以容纳`MAXSIZE`字符之后使用，或者在确保要插入的元素中的第一个（真正的第零个）字符是 之后使用（NB `strncat`：*not`strncpy`* ） 。`valid_words``'\0'`

一些观察：

假设`MAXSIZE`是一个`#define`d 常数，这更好 -

```
char iline[MAXSIZE]; 
char dline[MAXSIZE; 
```

比您拥有的 malloc 调用（顺便说一下， sizeof(char) 是一个定义。）

同样，您最好更改 to 的最后一个参数`CheckFile`（`char valid_words[][MAXSIZE]`从而更改所有对 的调用中的参数`CheckFile`）。

希望这可以帮助。

# jquery - 记住 jQuery 在页面刷新后隐藏或显示状态

> ID：14248167
> 
> 赞同：0
> 
> 时间：2013-01-09T23:13:23.483
> 
> 标签：jquery

```
 $(document).ready(function(){
        $("#navibtnon").bind('click', function(){
            $('#navi').fadeIn("fast");
            $(window).unbind('resize');
        });
    });
    $(document).ready(function(){
        $('#navbtnoff').bind('click', function () {
            $('#navi').fadeOut("fast");
            $(window).bind('resize', ScreenSize);
        });
    });

function ScreenSize()  {
  windowsize = $(window).width();
    if (windowsize < 1040) {
      $('#naviclosed').fadeIn("fast");
    }
    if (windowsize >= 1040) {
    $('#naviclosed').fadeOut("fast"); 
    }
} 
```

那么如何让 jQuery 在页面刷新时记住这个设置呢？更新：我添加了 ScreenSize() 函数的作用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:23:44.493

使用[jquery cookie 插件](https://github.com/carhartl/jquery-cookie)，您可以将 screensize 设置为这样的 cookie：

```
$.cookie("ScreenSize",ScreenSize) 
```

当页面重新加载时，如果 cookie 存在，则像这样绑定它：

```
 var ScreenSize;
if ((ScreenSize = $.cookie('filter')) != undefined) {
  $(window).bind('resize', ScreenSize);
} 
```

这是我正在使用的实际代码：

```
$(".dropdown li a").click(function () {
var filter = grid.dataSource.filter();
filter == undefined ? "" : (filter.filters[0].value != undefined) ? "" : $.cookie("filter", JSON.stringify(filter)); 
```

});

```
var filter;
if ((filter = JSON.parse($.cookie('filter'))) != undefined) {
    grid.dataSource.filter(filter);
    $("#account-done").show(300);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:33:36.387

最好使用 ajax 将数据（查询）发送到数据库，并将其保存在数据库中；并在每次刷新时，从数据库重新加载它。

# c++ - 调整亮度、OpenCV 和 c++

> ID：14248170
> 
> 赞同：2
> 
> 时间：2013-01-09T23:13:40.577
> 
> 标签：c++, opencv, brightness

我想知道 OpenCV 是否有任何使用 C++ 来调整视频/帧的亮度和对比度的功能。您可以将 BGR 颜色空间转换为 HSV 颜色空间，并丢弃后面的分量 V（亮度）以使算法对视频中的光线条件不那么敏感，但我该怎么做呢？

我正在考虑使用 cvAddS (frame, cvScalar (-50, -50, -50), frame) 之类的东西来降低亮度，cvAddS 和 cvScalar 对 C 来说效果很好，但是对于 C++，我怎么能做到这一点，我使用 AddS 和我的程序中的标量，但不适用于 C++

```
int main() {
    VideoCapture video(1);
    if(!video.isOpened()) {
        cerr<<"No video input"<<endl; return -1;
    }
    namedWindow("Video",CV_WINDOW_AUTOSIZE);

    for(;;) {
        Mat frame;
        video >> frame; if(!frame.data) break;
        Mat frame2;
        //I USE AddS AND Scalar TO DECREASE THE BRIGHTNESS
        AddS(frame,Scalar(-50,-50,-50),frame2);
        //BUT DON'T WORK WITH C++
        imshow("Video",frame2);

        int c=waitKey(20);

        if(c >= 0)break;
    } 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T03:55:11.943

使用[矩阵表达式](http://docs.opencv.org/modules/core/doc/basic_structures.html#matrix-expressions)：

```
cv::Mat frame2 = frame + cv::Scalar(-50, -50, -50); 
```

您可能还想使用[直方图均衡](http://en.wikipedia.org/wiki/Histogram_equalization)调整对比度。将您的 RGB 图像转换为 HSV 并应用于[`cv::equalizeHist()`](http://docs.opencv.org/modules/imgproc/doc/histograms.html#equalizehist)V 通道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T18:49:57.127

通常使用像素值的线性变换来校正亮度和对比度。亮度对应于加性偏移，对比度对应于乘法因子。

一般来说，给定一个像素值`v`，校正后的新值是`v'=a*v + b`。

# java - 为高请求量配置 Jetty

> ID：14248172
> 
> 赞同：22
> 
> 时间：2013-01-09T23:13:49.427
> 
> 标签：java, performance, http, jetty

在我们的应用程序中，我们需要处理每秒超过 5,000 个请求的请求量。我们被告知在我们的应用程序类型中使用 Jetty 是可行的（我们必须将 JSON-HTTP API 暴露给远程系统，然后它将启动入站请求和与我们的连接）。

我们收到数千个入站 HTTP 连接，每个连接都是持久的，持续大约 30 秒。然后，远程服务器会尽快向我们发出请求，因为我们可以在每个连接上响应它们。30 秒后连接关闭并打开另一个连接。我们必须在不到 100 毫秒（包括网络传输时间）内做出响应。

我们的服务器运行在具有 8GB RAM 的 EC2 中，其中 4GB 分配给我们的 Java VM（过去的研究建议您不应将超过一半的可用 RAM 分配给 JVM）。

以下是我们目前根据在网上阅读的各种提示初始化 Jetty 的方式：

```
Server server = new Server();
SelectChannelConnector connector = new SelectChannelConnector();
connector.setPort(config.listenPort);
connector.setThreadPool(new QueuedThreadPool(5120));
connector.setMaxIdleTime(600000);
connector.setRequestBufferSize(10000);
server.setConnectors(new Connector[] { connector });
server.setHandler(this);
server.start(); 
```

请注意，我们的线程池中最初只有 512 个线程，我们尝试增加到 5120 但这并没有明显帮助。

我们发现使用这种设置，我们很难每秒处理 300 多个请求。我们认为问题不在于我们的处理程序，因为它只是在进行一些快速计算和 Gson 序列化/反序列化。

当我们在尝试处理此负载时手动执行自己的 HTTP 请求时，我们发现它可能需要几秒钟才能开始响应。

我们正在使用 Jetty 版本 7.0.0.pre5。

任何关于解决方案或隔离瓶颈的技术的建议都将不胜感激。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-09T23:31:36.953

首先，Jetty 7.0.0.pre5 已经**很**老了。Jetty 9 现已推出，并进行了*许多*性能优化。

[在https://www.eclipse.org/jetty/previousversions.html](https://www.eclipse.org/jetty/previousversions.html)下载更新版本的 7.x 行

以下建议记录在

*   [Eclipse.org / Jetty - 操作方法：高负载](http://www.eclipse.org/jetty/documentation/current/high-load.html)
*   [Eclipse.org / Jetty - HowTo：垃圾收集](http://www.eclipse.org/jetty/documentation/9.0.6.v20130930/garbage-collection.html)
*   [谎言、该死的谎言和基准](https://webtide.com/lies-damned-lies-and-benchmarks-2/)

请务必阅读它们。

接下来，线程池大小用于处理接受的请求，512 为高。5120太可笑了。选择一个大于 50 和小于 500 的数字。

如果您有基于 Linux 的 EC2 节点，请确保配置网络以在操作系统级别获得最大收益。（详见上述列表中标题为“高负载”的文档）

确保您使用的是最新的 JRE/JDK，例如 Oracle Java 1.6u38 或 1.7u10。此外，如果您有 64 位操作系统，请使用 64 位 JRE/JDK。

将您的接受器计数[SelectChannelConnector.setAcceptors(int)](http://download.eclipse.org/jetty/stable-7/apidocs/org/eclipse/jetty/server/AbstractConnector.html#setAcceptors%28int%29)设置为介于 1 和 (number_of_cpu_cores - 1) 之间的值。

最后，设置优化的垃圾收集，并打开 GC Logging 以查看您遇到的问题是与码头有关，还是与 Java 的 GC 有关。如果您通过 GC 日志记录看到有大量的 GC“停止世界”事件需要花费大量时间，那么您就会知道导致性能问题的另一个原因。

# javascript - viewContentLoaded - 每个控制器不重复代码 - AngularJS

> ID：14248177
> 
> 赞同：0
> 
> 时间：2013-01-09T23:14:05.610
> 
> 标签：javascript, angularjs

嘿，我正试图感受 Angular 并且遇到了一点障碍。

我有一个容器结构，如下所示：

```
<div class="main-container" ng-view>
    <!-- The below divs are constantly being 
         reloaded based on the current URL and it's associated view -->
    <div class="left-col">
    </div>
    <div class="right-col">
    </div>
</div> 
```

在我实现 Angular 之前，我只有一个简单的脚本，它可以检查窗口的高度并相应地设置左列和右列 div 的高度。

使用 angular 可能有更好的方法来执行此操作，然后将事件函数附加到窗口对象。基本上我想在每次渲染新视图时触发一个函数，但不要在我的所有角度控制器中复制以下代码，如下所示：

```
$scope.$on('$viewContentLoaded', setColumnHeight); 
```

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T05:03:40.307

I've solved this problem in my app by having a root "Application Controller" at the top of the DOM tree. For example:

```
<body ng-controller='applicationController'>
...
<div class="ng-view"></div>
...
</body> 
```

applicationController is always there, and can set up bindings on its scope when it is created.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T04:51:31.167

How about putting that event listener on the root scope:

```
$rootScope.$on('$viewContentLoaded', setColumnHeight); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:43:12.360

你可以使用这样的东西：

```
<div class="main-container" ng-view>
    {{ setColumnHeight() }}
    <!-- The below divs are constantly being 
         reloaded based on the current URL and it's associated view -->
    <div class="left-col">
    </div>
    <div class="right-col">
    </div>
</div> 
```

它会在每次渲染时检查高度，但是，这似乎有点过度处理。

The best approach would be to only update the height from both columns when the height of one of them changes. For that you could use [DOM Mutation Observers](http://dom.spec.whatwg.org/#mutation-observers), however they are not yet available on all browsers. If that's not a problem for you, check the [mutation-summary lib](https://code.google.com/p/mutation-summary/).

If you are using jQuery you can also try this: [https://github.com/jqui-dot-net/jQuery-mutate](https://github.com/jqui-dot-net/jQuery-mutate) (examples [here](http://www.jqui.net/jquery-projects/jquery-mutate-official/)).

# php - 减法变成加法？

> ID：14248183
> 
> 赞同：0
> 
> 时间：2013-01-09T23:14:23.450
> 
> 标签：php, jquery, subtraction

我在应该是一个非常简单的计算中遇到了一个奇怪的问题。单击复选框时`addDomain`，页面会向 php 后端发出 ajax 请求，其中新的小计是根据传递的参数确定的。首次选中复选框时，一切正常（即返回新的总和）。如果随后未选中该复选框，则再次触发请求，但从某处的加法返回一个总和，而不是减法的乘积。

这是我正在使用的代码。我想要做什么应该很简单。

```
case 'domainprices':
    $sub = request_var('s', 0.00);
    $checked = request_var('c', true);
    $price = (float) 10.99;

    if($checked){
        $sub = $sub + $price;
    }else{
        $sub = $sub - $price;
    }
    $res['res'] = $sub;
    echo json_encode($res);
break;

case 'hosting':
$id = request_var('id', '');
switch($id){
    case 'economy':
        $res['body'] = '<div>
            <select name="duration">
                <option value="3">3 years @ $2.99/Mo</option>
                <option value="2">2 years @ $3.99/Mo</option>
                <option value="1">1 year @ $4.99/Mo</option>
                <option value="0">1 month @ $5.99/Mo</option>
            </select><br />
            Add Domain Name: <input type="checkbox" name="addDomain" /><br />
            Subtotal: $<span id="subtotal">107.64</span>
        </div>
        <script>
        $("select[name=duration]").change(function(){
            var duration = $(this).val();
            var checked;
            if($("input[name=addDomain]").is(":checked")){
                checked = true;
            }else{
                checked = false;
            }
            Funcs.ajaxCall("services", "mode=hostingprices&d="+duration, function(data){
                $("#subtotal").html(data.result);
            });
        });
        $("input[name=addDomain]").mousedown(function(){
            var subtotal = $("#subtotal").html();
            var checked;
            if($(this).is(":checked")){
                checked = false;
            }else{
                checked = true;
            }
            Funcs.ajaxCall("services", "mode=domainprices&s="+subtotal+"&c="+checked, function(data){
                $("#subtotal").html(data.res);
            });
        });
        </script>';
        $res['name'] = "Economy Hosting";
        echo json_encode($res);
    break;
}
break; 
```

# ajax - 在 MVC 中启用 AJAX 的 WCF 服务？

> ID：14248184
> 
> 赞同：2
> 
> 时间：2013-01-09T23:14:26.617
> 
> 标签：ajax, asp.net-mvc, wcf, webforms

因此，我可以创建一个简单的启用 AJAX 的 WCF 服务，并在基本 WebForm 中的 Javascript 中使用它，如 MSDN (http://msdn.microsoft.com/en-us/library/bb924552.aspx) 上的此示例中所示。

是否可以在 ASP.NET MVC 3/4 中执行此操作？问题是显然没有 ScriptManager 控件，这使我可以引用要在 javascript 中使用的服务。

如果不可能 - 我如何在 ASP.NET MVC 的 javascript 中使用 WCF 服务？

我也无法在网上找到任何此类示例。我的 google fu 已关闭，我无法弄清楚我在这里缺少什么。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:41:39.910

确保您的 WCF 服务使用 JSON，然后使用 JQuery 调用该服务。这可能会有所帮助： http: [//pranayamr.blogspot.com/2010/12/steps-to-call-wcf-service-using-jquery.html](http://pranayamr.blogspot.com/2010/12/steps-to-call-wcf-service-using-jquery.html)

# servicestack - 请求被重定向到 login.aspx?ReturnUrl=

> ID：14248187
> 
> 赞同：3
> 
> 时间：2013-01-09T23:14:38.863
> 
> 标签：servicestack, xsp

我已经使用 Visual Studio 使用 servicestack 实现了一个 web 服务。从 vs 调试器运行服务就可以了。我刚刚尝试将它部署到使用 XSP4 的 debian 机器上。该服务使用日志记录，据我所知该服务已启动并正在运行。启动服务时会创建一个日志文件，但我提出的任何请求都不起作用。例如，我使用浏览器发出以下请求：

```
http://127.0.0.1/Activity/5b1e5316-8ea5-4ba5-aaee-7f40151b80d3/Unit 
```

但是浏览器被重定向到：

```
http://127.0.0.1/login.aspx?ReturnUrl=%2fActivity%2f5b1e5316-8ea5-4ba5-aaee-7f40151b80d3%2fUnit 
```

我已经使用我在 Configure 方法中添加的全局请求过滤器实现了我自己的身份验证。我很困惑为什么将请求重定向到 login.aspx。此外，在日志文件中看到以下内容：

错误 2013-01-10 00:07:53.2631 NotFoundHttpHandler 192.168.23.2 未找到请求：/login.aspx?ReturnUrl=%2fActivity%2f5b1e5316-8ea5-4ba5-aaee-7f40151b80d3%2fUnit

有谁知道可能导致这种行为的原因？这是添加全局过滤器的代码：

```
this.RequestFilters.Add((httpReq, httpResp, requestDto) =>
        {
            try
            {
                var userCreds = httpReq.GetBasicAuthUserAndPassword();

                if (userCreds == null)
                {
                    httpResp.ReturnAuthRequired();
                    return;
                }

                var userName = userCreds.Value.Key;
                var userPass = userCreds.Value.Value;

                if (!TryResolve<IAuthenticationProvider>().AuthenticateUser(userName, userPass))
                {
                    httpResp.ReturnAuthRequired();
                }

                return;
            }
            catch (Exception ex)
            {   
                log.Error(ex);
                throw new ApplicationException(ex.Message, ex);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-13T07:10:50.930

我刚刚想通了。我添加了

```
<authentication mode="None" /> 
```

像这样到 Web.config ：

```
<system.web>
    <!-- mode=[Windows|Forms|Passport|None] -->
    <authentication mode="Windows" />
</system.web> 
```

可在此处找到文档：msdn.microsoft.com/en-us/library/aa291347(v=vs.71).aspx

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-03T21:30:54.583

我使用下面的代码片段解决了我的问题，即 .NET Forms 身份验证覆盖了我试图通过 ServiceStack.NET 返回的 401。在每个请求上，如果是 AJAX，则在开始时立即抑制该行为。这个标志是由 MS 为这个目的而创建的。[http://msdn.microsoft.com/en-us/library/system.web.httpresponse.suppressformsauthenticationredirect.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.suppressformsauthenticationredirect.aspx)

请注意，搜索时出现的许多其他解决方案会告诉您禁用 .NET 身份验证，这在大多数情况下根本不可行。此代码无需其他修改即可工作。

```
protected void Application_BeginRequest()
{
    HttpRequestBase request = new HttpRequestWrapper(Context.Request);
    if (request.IsAjaxRequest())
    {
        Context.Response.SuppressFormsAuthenticationRedirect = true;
    }
} 
```

# twitter-bootstrap - 自动关闭响应式导航栏

> ID：14248194
> 
> 赞同：40
> 
> 时间：2013-01-09T23:15:18.733
> 
> 标签：twitter-bootstrap

我正在使用 Bootstrap 响应式导航栏。当导航栏折叠并打开菜单并单击菜单项时，菜单不会自动关闭，我必须自己手动完成。

单击其中一个按钮后是否可以使菜单自动关闭？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2014-02-21T17:42:48.987

引导程序 3 的工作解决方案

```
$('.navbar-collapse a').click(function(){
    $(".navbar-collapse").collapse('hide');
}); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-01-10T02:38:42.963

**编辑：** 正如[Maximus](https://stackoverflow.com/a/21941444/341692)在下面指出的，**3.x 引导**解决方案是：

```
$('.navbar-collapse a').click(function(){
    $(".navbar-collapse").collapse('hide');
}); 
```

[https://jsfiddle.net/yohuLuj2/](https://jsfiddle.net/yohuLuj2/)

* * *

**2.x bootstrap**的旧答案：

您应该能够通过向列表项添加单击处理程序然后以这种方式关闭导航来做到这一点。

```
$('.nav-collapse').click('li', function() {
    $('.nav-collapse').collapse('hide');
}); 
```

这是一个jsfiddle：http: [//jsfiddle.net/hajpoj/By6ym/4/](http://jsfiddle.net/hajpoj/By6ym/4/)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2014-02-15T12:31:40.010

我只是在每个链接上复制 btn-navbar 的 2 个属性（data-toggle="collapse" data-target=".nav-collapse"），如下所示：

```
<div class="nav-collapse">
  <ul class="nav" >
    <li class="active"><a href="#home" data-toggle="collapse" data-target=".nav-collapse">Home</a></li>
    <li><a href="#about" data-toggle="collapse" data-target=".nav-collapse">About</a></li>
    <li><a href="#portfolio" data-toggle="collapse" data-target=".nav-collapse">Portfolio</a></li>
    <li><a href="#services" data-toggle="collapse" data-target=".nav-collapse">Services</a></li>
    <li><a href="#contact" data-toggle="collapse" data-target=".nav-collapse">Contact</a></li>
  </ul>
</div> 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-08-08T16:49:24.350

我要添加到 jason 的解决方案中的唯一一件事是下拉列表的例外。如果有人只是单击切换子菜单，您不想关闭菜单。所以……</p>

```
$('.navbar-collapse a:not(.dropdown-toggle)').click(function(){
    $(".navbar-collapse").collapse('hide');
}); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-12-01T23:46:25.783

@Mike 的下拉解决方案对我有用，只是下拉切换中的项目不会隐藏菜单，所以我确保添加以下内容：

```
$('.navbar-collapse .dropdown-menu').click(function(){
    $(".navbar-collapse").collapse('hide');
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-12-16T04:09:17.643

只要记住遍历 DOM 树并关闭相关的导航栏，而不是所有的导航栏。特别是对于 Bootstrap 3，使用类似于以下代码片段的内容：

```
$("body").on("click", ".navbar-collapse a", function() {
  var $this = $(this);

  setTimeout(function() {
     $this.closest(".navbar-collapse").collapse('hide');
  }, 350);
}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-09-08T15:41:42.250

另一个问题是当您在桌面上看到导航栏时，它会尝试隐藏/显示导航栏，所以我做了这个：

```
$('.navbar-collapse a:not(.dropdown-toggle)').click(function(){
    if($(window).width() < 768 )
        $('.navbar-collapse').collapse('hide');
}); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-04T08:22:27.640

我通过添加按钮点击管理来完成答案：

```
$(document).on('click', '.navbar-collapse.collapse.in a:not(.dropdown-toggle)', function() {
    $(this).closest(".navbar-collapse").collapse('hide');
});
$(document).on('click', '.navbar-collapse.collapse.in button:not(.navbar-toggle)', function() {
    $(this).closest(".navbar-collapse").collapse('hide');
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-03T18:13:29.067

我的问题是，我正在使用锚点创建单页布局。所以，当你缩小窗口时，菜单隐藏在链接点击完美。*感谢上面给我线索的用户。*但是，当放大窗口时，绑定事件总是存在（虽然没有重新加载）。所以，这就是我所做的。希望它可以帮助某人:)

```
jQuery.noConflict();
(function($){
    $('ul#menu-menu-with-anchors li a, a[href="#top"]').click(function(){
        $('html, body').animate({
            scrollTop: $( $.attr(this, 'href') ).offset().top - ($('body').hasClass('admin-bar') ? 160 : 130)
        }, 500);
        return false;
    });

    bindUnbindNavToggle($);
    $(window).resize(function(){
        bindUnbindNavToggle($);
    });

})(jQuery);

function bindUnbindNavToggle($){
    if( $('button.navbar-toggle').css('display') != 'none' ) {
        $('.navbar-collapse ul li a').on('click', function(){
           $('.navbar-collapse').collapse('hide');
            return false;
        });
    }
    else {
        $('.navbar-collapse ul li a').on('click', function(){
            return false;
        });
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-29T19:52:21.753

如果你使用 Angular，你可以将折叠绑定到路由导航：

```
$scope.$on('$routeChangeSuccess', function(event, toState, toParams, fromState, fromParams){ $(".navbar-collapse").collapse('hide'); }); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-14T12:31:36.010

只需将此代码放在 main.js 中

```
 $(document).on('click', '.navbar-collapse.in', function (e) {
    if ($(e.target).is('a')) {
        $(this).collapse('hide');
    }
}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-18T19:27:13.523

也许有人需要在点击其他地方时隐藏菜单（我以为没有子菜单）。然后在jquery之后的某个地方添加这段代码，bootstrap.js

```
$('button.navbar-toggle').focusout(function(){
        $(".navbar-collapse").collapse('hide');
    }); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-12-16T17:30:50.453

ZU1779 答案是我最喜欢的。

无论如何，基于组件的实现（如 Bootstrap-vue）将不起作用。

在这种情况下，您可以在调用模拟单击折叠按钮的函数的链接上添加事件侦听器，链接：

```
collapseNav = function() {
  document
    .getElementsByClassName('navbar-toggler')[0]
    .dispatchEvent(new Event('click'))
} 
```

希望可能有用。

# c - 循环计数器在 c 中缺少带有 fread 的奇数

> ID：14248195
> 
> 赞同：0
> 
> 时间：2013-01-09T23:15:21.030
> 
> 标签：c, loops

大家好，我有这个功能可以告诉我数据文件中有多少条记录。但是，每当我运行它时，它只会读取偶数记录

例如：如果我有 0 条记录，则输出 0

有 1 条记录，它输出 0

有 2 条记录，它输出 1

用 3 它输出 1

用 4 它输出 2

（顺便说一句，它对于客户和产品数据库项目 customer 是一个结构，而 filep 是指向在此代码上方定义的文件 customerfile 的指针）我在 eclipse 上运行并且只能使用 gnu89/90 方言，如果这会产生差异

```
 int CusFileNumber(void)
{
    customer tempcus;
    filep = fopen(customersFile, "r");
    fseek (filep,0,SEEK_SET);
    int counter =0;

    while(!feof(filep))
    {
        fread(&tempcus,sizeof(customer),1,filep);
        printf ("%d",counter);
        counter ++;
    }
    fclose(filep);
    return (counter-1);
} 
```

* * *

所以我更新了代码以摆脱 feof

看起来像这样

```
int CusFileNumber(void)
{
    customer tempcus;
    filep = fopen(customersFile, "r");
    fseek (filep,0,SEEK_SET);
    int counter =0;

    while(fread(&tempcus, sizeof(customer), 1, filep) == 1)
    {
        printf ("%d",counter);
        counter ++;
    }
    fclose(filep);
    return (counter);
} 
```

但是这次我仍然遇到同样的问题，它没有计算偶数

这意味着在每个奇数计数器上递增 1，但当我在文件中有偶数条记录时保持不变（顺便说一句，它是一个 .dat 文件）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:16:01.570

1.  你不能这样用[`feof(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/feof.3.html)。它只告诉你流是否*已经*结束，而不是它即将结束。您需要将[`fread`](http://www.kernel.org/doc/man-pages/online/pages/man3/fread.3.html)调用放入循环条件并检查其返回值：

    ```
    while (fread(&tempcus, sizeof(customer), 1, filep) == 1) 
    ```

    完全摆脱`feof`通话。

2.  您确定`sizeof(customer)`与文件中的内容相符吗？

3.  为什么要`counter`在增加之前打印？

4.  你为什么要返回`counter - 1`而不是返回`counter`？

# jquery - jqPlot / 局部视图 jQuery 滑块/轮播 MVC

> ID：14248198
> 
> 赞同：0
> 
> 时间：2013-01-09T23:15:37.110
> 
> 标签：jquery, asp.net-mvc, jqplot

我有 jqPlot 图表，这些图表显示在部分视图中包含的 div 中。有没有办法使用 div/渲染图表创建轮播或滑块？我发现的所有 jQuery 滑块都希望与包含 jpg/png 的 li 元素一起使用 - 有什么东西可以轮播包含我的图表 div 的部分视图吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:42:14.713

你试过[http://kevinbatdorf.github.com/codaslider/](http://kevinbatdorf.github.com/codaslider/)吗？我过去曾使用它来实现与您尝试做的类似的事情。

# ruby-on-rails - 当呈现为 JSON 时，如何使用不同的 foreign_key 显示自定义的 belongs_to 关联作为关联名称？

> ID：14248201
> 
> 赞同：2
> 
> 时间：2013-01-09T23:15:58.153
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, rails-activerecord

我对rails相当陌生，并且在我的Champion模型上通过belongs_to建立了5个关联，这些关联连接到具有has_one关联回Champion模型的Ability模型。

这 5 个关联使用与关联名称和“_id”相匹配的外键。当我去渲染页面时，我看到“_id”值显示为整数，但希望这些显示为实际记录。因此，它不会只显示一个整数，而是会显示完整的能力记录及其所有字段。

这是我的 Champion.rb 模型：

```
class Champion < ActiveRecord::Base
  attr_accessible :q_id,
                  :w_id,
                  :e_id,
                  :r_id,
                  :passive_id

  belongs_to :q, :class_name => "Ability", :foreign_key => "q_id"
  belongs_to :w, :class_name => "Ability", :foreign_key => "w_id"
  belongs_to :e, :class_name => "Ability", :foreign_key => "e_id"
  belongs_to :r, :class_name => "Ability", :foreign_key => "r_id"
  belongs_to :passive, :class_name => "Ability", :foreign_key => "passive_id"
end 
```

而ability.rb 模型：

```
class Ability < ActiveRecord::Base
  has_one :champion
end 
```

以及显示模型的控制器：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  def show_all
    load_models

    respond_to do |format|
      format.json { render :json => { "champions" => @champions } }
    end
  end

  protected
  def load_models
    @champions = Champion.all
  end
end 
```

那么如何设置让 JSON 显示“q”、“w”、“e”、“r”和“passive”而没有“_id”，并显示整个能力记录？现在它只显示包含 id 的实际数据库字段，但不显示我想要的记录。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:37:26.013

最简单的方法是这样的：

```
respond_to do |format|
  format.json { render :json => @champions.to_json(:include => {:q => {}, :w => {}}) }
end 
```

不过，我可能会建议您研究类似[RABL 之](https://github.com/nesquena/rabl)类的东西。它将使处理这些更复杂的 json 响应变得更清晰。[这里](http://railscasts.com/episodes/322-rabl)有一个很好的 Railscast 。

# javascript - 如何在 setTimeout 中包装脚本

> ID：14248205
> 
> 赞同：0
> 
> 时间：2013-01-09T23:16:09.043
> 
> 标签：javascript, jquery

我有一些 jquery 代码，当单击选项卡时，它会将图像滑块重置为幻灯片 1。问题是，它会立即发生，所以在标签淡出之前你会看到重置滑块的一点点闪烁。

我想将重置“保持”大约半秒，直到它消失。

有人告诉我我需要将代码包装在“setTimeout”函数中，所以我希望在如何做到这一点上得到一些帮助。

我说的是这个页面的“工作”部分：www.oncreative.com.au

这是我必须重置滑块的代码：

```
<script>
    $('.reset').click(function() {
    $('.workslider').each(function() {
           var s = $(this).data('royalSlider');
           s.st.transitionSpeed = 0;
            s.goTo(0);
            setTimeout(function() {
                s.st.transitionSpeed = 600;
            }, 10); 
    });
    });
</script> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:18:44.670

```
setTimeout(function(){
 // your code here.
},500); 
```

setTimeout 有两个参数——第一个是你的代码，第二个是延迟它的时间（以毫秒为单位）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:19:57.807

这是一个非常基本的 jsFiddle，应该提供一个简单的`setTimeout`实际操作示例：http: [//jsfiddle.net/A5dQn/](http://jsfiddle.net/A5dQn/)

在您的具体情况下：

```
// First you need to wrap the code you want to be
// executed when the timeout fires in a function:
function resetSliders () {
    $('.workslider').each(function() {
        var s = $(this).data('royalSlider');
        s.st.transitionSpeed = 0;
        s.goTo(0);
        setTimeout(function() {
            s.st.transitionSpeed = 600;
        }, 10); 
    });
};

// Then simply pass in a reference to your function to the setTimeout function.
$('.reset').click(function() { window.setTimeout(resetSliders, 500); } ); 
```

**编辑：**显然，您希望在超时中包装在单击事件上执行的代码，而不是附加单击事件本身。对不起！

# salesforce - Salesforce.com：System.NullPointerException：尝试取消引用空对象

> ID：14248210
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:16:35.877
> 
> 标签：salesforce

尝试测试 Apex 测试类时出现以下错误

消息：System.NullPointerException：尝试取消引用空对象

堆栈跟踪错误：Class.RenewalNotificationController.mergeExistingFields：第 321 行，第 1 列 Class.RenewalNotificationController.mergeAndCreateMail：第 227 行，第 1 列 Class.RenewalNotificationController.sendMail：第 177 行，第 1 列 Class.RenewalNotificationControllerTEST.testRenewalNotifications：第 71 行，第 1 列

下面是 Apex 测试类

我很快就会添加我的 Apex 类。

任何帮助是极大的赞赏！

干杯! 隆美尔

# Apex 测试班

```
public class RenewalNotificationControllerTEST {

public testMethod static void testRenewalNotifications() {

//==============30 Day Test================
Opportunity opp1 = new Opportunity(Name = 'Test1', Renewal_Notice_Email__c = 'rmehta@apprivo.com', 
Probability = 5, Description = 'test', CloseDate = Date.today() + 5,Contract_Expires__c = Date.today() + 5, Sales_Engagement_Strategy__c = 'not null',
Amount = 1000, StageName = 'Awareness', Theater__c='NA');
insert opp1;

Renewal__c renewal1 = new Renewal__c(Renewal_Opportunity__c = opp1.Id, 
Serviced_Product_SKU__c = 'test SKU', Parent_Serial_Number__c = '123456', 
Serial_Number__c = 'SN123', Line_End_Date__c = Date.today() + 10);
insert renewal1;

//==============60 Day Test================
Opportunity opp2 = new Opportunity(Name = 'Test2', Renewal_Notice_Email__c = 'rmehta@apprivo.com', 
Probability = 5, Description = 'test', CloseDate = Date.today() + 65,Contract_Expires__c = Date.today() + 65, Sales_Engagement_Strategy__c = 'not null',
Amount = 1000, StageName = 'Awareness', Theater__c='NA');
insert opp2;

Renewal__c renewal2 = new Renewal__c(Renewal_Opportunity__c = opp2.Id, 
Serviced_Product_SKU__c = 'test SKU', Parent_Serial_Number__c = '123456', 
Serial_Number__c = 'SN123', Line_End_Date__c = Date.today() + 20);
insert renewal2;

//==============90 Day Test================
Opportunity opp3 = new Opportunity(Name = 'Test3', Renewal_Notice_Email__c = 'rmehta@apprivo.com', 
Probability = 50, Description = 'test', CloseDate = Date.today() + 95, Contract_Expires__c = Date.today() + 95, Sales_Engagement_Strategy__c = 'not null',
Amount = 1000, StageName = 'Awareness', Theater__c='NA');
insert opp3;

Renewal__c renewal3 = new Renewal__c(Renewal_Opportunity__c = opp3.Id, 
Serviced_Product_SKU__c = 'test SKU', Parent_Serial_Number__c = '123456', 
Serial_Number__c = 'SN123', Line_End_Date__c = Date.today() + 10);
insert renewal3;

//==============-1 Day Test================
Opportunity opp4 = new Opportunity(Name = 'Test1', Renewal_Notice_Email__c = 'rmehta@apprivo.com', 
Probability = 5, Description = 'test', CloseDate = Date.today() - 5,Contract_Expires__c = Date.today() - 5, Sales_Engagement_Strategy__c = 'not null',
Amount = 1000, StageName = 'Awareness', Theater__c='NA');
insert opp4;

BrandTemplate bt = [Select Id from BrandTemplate Limit 1];
/* EmailTemplate template = new EmailTemplate(Name = 'testTemplate', 
FolderId = RenewalNotificationController.FOLDER_ID,
Subject = 'Test Subject {!Opportunity.CloseDate}',
Body = 'Test Body {!Opportunity.Name} <Renewals> \n {!Opportunity.Theater__c} ' +
'\n {!Opportunity.CloseDate} \nfrom a F5 rep', 
HtmlValue = 'Test Body {!Opportunity.Name} <Renewals> <br> {!Opportunity.Theater__c} ' +
'<br> {!Opportunity.CloseDate} <br>from a F5 rep',
TemplateType= 'HTML',
BrandTemplateId = bt.Id, TemplateStyle = 'freeForm');
insert template;*/
EmailTemplate template = [Select Id, Name, Subject, Body, HtmlValue from EmailTemplate where FolderId = :RenewalNotificationController.FOLDER_ID Limit 1];

Test.startTest();
RenewalNotificationController controller = new RenewalNotificationController();

List<SelectOption> options = controller.getFilterOptionItems();

controller.FilterOption = '30';
controller.createTaskSubject();
controller.onDateFilterChange();
List<RenewalNotificationController.OppWrapper> opportunities = controller.getRenewalOpportunities();
for (RenewalNotificationController.OppWrapper wrapper : opportunities) {
wrapper.setSelected(true);
} 
controller.SelectedTemplate = template.Id;
controller.onEmailTemplateChange();
controller.sendMail();

controller.FilterOption = '60';
controller.createTaskSubject();
controller.onDateFilterChange();
controller.sendMail();

controller.FilterOption = '90';
controller.createTaskSubject();
controller.onDateFilterChange(); 
controller.sendMail();

controller.FilterOption = '-1';
controller.createTaskSubject();
controller.onDateFilterChange();

controller.FilterOption = '-14';
controller.createTaskSubject();
controller.onDateFilterChange();

controller.FilterOption = '-30';
controller.createTaskSubject();
controller.onDateFilterChange();

controller.FilterOption = '-90';
controller.createTaskSubject();
controller.onDateFilterChange();

controller.getSuccessEmails();
controller.getFailureEmails();

controller.backToRenewals();

Test.stopTest();
}
} 
```

# 顶点类

```
public class RenewalNotificationController {

    public String filterOption {get; set;}
    List<OppWrapper> wrapperList;
    public String NoOpportunityMessage {get; set;}
    public String selectedTemplate {get; set;}

    private String STAGE_NAME = 'Internal Education';
    private Integer PROBABILITY = 25;
    public static final String FOLDER_ID = '00l50000000vdRRAAY';

    //used on page2
    List<Opportunity> successEmails;
    List<Opportunity> failureEmails;

    private static final String REGEX = '\\{![a-zA-Z\\._]*\\}';

    private Map<String, String> opportunityFields;

    public RenewalNotificationController(){
     filterOption = 'none';

        opportunityFields = new Map<String, String>();
        opportunityFields.put('{!Opportunity.Account}', 'Account.Name');
        opportunityFields.put('{!Opportunity.CloseDate}', 'CloseDate');
        opportunityFields.put('{!Opportunity.Amount}', 'Amount');
        opportunityFields.put('{!Opportunity.Description}', 'Description');
        opportunityFields.put('{!Opportunity.Name}', 'Name');
        opportunityFields.put('{!Opportunity.Probability}', 'Probability');
        opportunityFields.put('{!Opportunity.Contract_Expires__c}', 'Contract_Expires__c');
        opportunityFields.put('{!Opportunity.OwnerEmail}', 'Owner.Email');
        opportunityFields.put('{!Opportunity.OwnerFullName}', 'Owner.Name');
        opportunityFields.put('{!Opportunity.OwnerFirstName}', 'Owner.FirstName');
        opportunityFields.put('{!Opportunity.OwnerLastName}', 'Owner.LastName');
        opportunityFields.put('{!Opportunity.OwnerPhone}', 'Owner.Phone');
        opportunityFields.put('{!Opportunity.OwnerTitle}', 'Owner.Title');

        onDateFilterChange();
    }

    public List<OppWrapper> getRenewalOpportunities() {
        return wrapperList;
    }

    public void onEmailTemplateChange() {
        System.debug('onEmailTemplateChange()');
        //List<SelectOption> options = getEmailTemplates();
        for (OppWrapper wrapper : wrapperList) {
            //Boolean selected = wrapper.getSelected();
            //unccoment thhis if only the selecyted ones should change
            //if (selected) {
                //String template = (selectedTemplate == null) ? options.get(0).getValue() : selectedTemplate;
                wrapper.setEmailTemplate(selectedTemplate);
            //}
        }
    }

    public void onDateFilterChange() {

        System.debug('selectedTemplate = ' + selectedTemplate);
        System.debug('f1 = ' + filterOption);

        if(filterOption != 'none'){
       String queryString = 'select Id, Renewal_Notice_Email__c, Probability, OwnerId, Owner.Email, Owner.FirstName, Owner.LastName, Owner.Name, Owner.Phone, Owner.Title, Name, LastActivityDate, Description, CloseDate, Contract_Expires__c, Amount, Account.Name, AccountId From Opportunity Where OwnerId = \'' + UserInfo.getUserID() + '\' AND Id IN (select Renewal_Opportunity__c from Renewal__c) AND Probability > 0 AND Probability < 100' ; 

       Date startDate;
       Date endDate;

       //Determine the end and start dates for the renewal query
   if(filterOption == '30'){
        queryString += 'AND (Contract_Expires__c = THIS_MONTH OR Contract_Expires__c = NEXT_MONTH)';
       }else if(filterOption == '60'){
        startDate = Date.newInstance(Date.today().year(),Date.today().Month() + 2,1);
        endDate = Date.newInstance(Date.today().year(),Date.today().Month() + 2,  Date.daysInMonth(startDate.year(),startDate.Month()));
        queryString += 'AND Contract_Expires__c >= :startDate AND Contract_Expires__c <= :endDate';
       }else if(filterOption == '90'){
        startDate = Date.newInstance(Date.today().year(),Date.today().Month() + 3,1);
        endDate = Date.newInstance(Date.today().year(),Date.today().Month() + 3,  Date.daysInMonth(startDate.year(),startDate.Month()));
        queryString += 'AND Contract_Expires__c >= :startDate AND Contract_Expires__c <= :endDate';
   }else if(filterOption == '-1'){
startDate = Date.today().addDays(-14);
        endDate = Date.today().addDays(-1);
        queryString += 'AND Contract_Expires__c > :startDate AND Contract_Expires__c <= :endDate';          
       }else if(filterOption == '-14'){
        startDate = Date.today().addDays(-30);
        endDate = Date.today().addDays(-14);
        queryString += 'AND Contract_Expires__c > :startDate AND Contract_Expires__c <= :endDate';
       }else if(filterOption == '-30'){
        startDate = Date.today().addDays(-89);
        endDate = Date.today().addDays(-30);
        queryString += 'AND Contract_Expires__c >= :startDate AND Contract_Expires__c <= :endDate';
       }else if(filterOption == '-90'){
        endDate = Date.today().addDays(-90);
        queryString += 'AND Contract_Expires__c <= :endDate';
       }      

       system.debug('q1 ' + queryString);
       List<Opportunity> opportunities = Database.query(queryString);

       System.debug('opportunities size=' + opportunities.size());
       //to set message if no opp are found
       noOpportunityMessage = '';
       if (opportunities.size() == 0) {
           noOpportunityMessage = 'No Opportunities found for the selected criteria.';
       }

       //create wrapper
       wrapperList = new List<OppWrapper>();
       List<SelectOption> options = getEmailTemplates();
       for (Opportunity opp : opportunities) {
           OppWrapper wrapper = new OppWrapper();
           wrapper.setOpportunity(opp);
           wrapper.setSelected(false);
           wrapperList.add(wrapper);
           String template = (selectedTemplate == null) ? options.get(0).getValue() : selectedTemplate;
           wrapper.setEmailTemplate(template);
       }
        }
    }

    public List<SelectOption> getFilterOptionItems() {
        List<SelectOption> options = new List<SelectOption>();
        options.add(new SelectOption('none','-None-'));
        options.add(new SelectOption('30','30 Day Notice'));
        options.add(new SelectOption('60','60 Day Notice'));
        options.add(new SelectOption('90','90 Day Notice'));
        options.add(new SelectOption('-1','1 Day Lapse Notice'));
        options.add(new SelectOption('-14','14 Day Lapsed Notice'));
        options.add(new SelectOption('-30','30 Day Lapsed Notice'));
        options.add(new SelectOption('-90','90 Day Lapsed Notice'));
        return options;
    }

    public List<SelectOption> getEmailTemplates() {
        List<EmailTemplate> templates = [Select e.Name, e.Id From EmailTemplate e where e.FolderId= :FOLDER_ID Order By e.Name];
        List<SelectOption> options = new List<SelectOption>();
        for(EmailTemplate t : templates) {
            options.add(new SelectOption(t.id,t.name));
        }

        return options;
    }

    /*
    * Action method called from the page
    */
    public PageReference sendMail() {
                //array for holding the mails
        Messaging.SingleEmailMessage[] mails = new List<Messaging.SingleEmailMessage>();

        //create a map so that we can avoid queries to get template details.
        Map<ID, TemplateDetails> emailTemplateMap = new Map<ID, TemplateDetails>();

        //get selected checkboxes
        for (OppWrapper wrapper : wrapperList) {
            Boolean selected = wrapper.getSelected();
            if (selected) {
                String emailTemplateId = wrapper.getEmailTemplate();
                System.debug('sendmail(): opp = ' + wrapper.getOpportunity().Name + ', Template ID = ' + emailTemplateId);
                //check if template exists in map
                TemplateDetails templateDetails = emailTemplateMap.get(emailTemplateId);
                if (templateDetails == null) {
                    //get the subject and body of the template
                    EmailTemplate emailTemplate = [Select e.Name, e.Subject, e.Id, e.HtmlValue, e.Body From EmailTemplate e Where e.Id= :emailTemplateId];
                    templateDetails = new TemplateDetails();
                    emailTemplateMap.put(emailTemplateId, templateDetails);
                    templateDetails.setEmailTemplate(emailTemplate);
                    //get documents for this email template and add it to template details
                    List<DocumentAttachmentMap> attachments = [Select d.DocumentId From DocumentAttachmentMap d 
                            Where d.ParentId = :emailTemplateId];
                    templateDetails.setDocumentIds(attachments);
                }

                //create the merged email and add it array
                Messaging.SingleEmailMessage mail = mergeAndCreateMail(templateDetails, wrapper.getOpportunity());
                mails.add(mail);

            }
        }
        if (mails.size() == 0) {
            return null;
        }
        System.debug('Now Sending email ');
        Messaging.SendEmailResult[] resultArr = Messaging.sendEmail(mails);
        System.debug('Send email result = ' + resultArr[0]);
        failureEmails = new List<Opportunity>();
        successEmails = new List<Opportunity>();
        Integer i = 0;
        for (OppWrapper wrapper : wrapperList) {
            Boolean selected = wrapper.getSelected();
            if (selected) {
                Messaging.SendEmailResult result = resultArr[i];
                if (result.isSuccess()) { //error
                    successEmails.add(wrapper.getOpportunity());    
                } else {
                    failureEmails.add(wrapper.getOpportunity());
                } 
                i++;
            }

        }       
        //90 day notifications will update opportunity probability to 30% and stage to 'Internal Education'.
        //if (filterOption.equals('2')) {
            updateOpportunities();
        //}
        //create tasks for the emails sent
        createTask();
        return Page.renewalNotificationResult;
    }

    /*
     * Called from the result page to go back to the renewals
     */
    public PageReference backToRenewals() {
        return Page.renewalNotification;
    }

/*******************mail methods****************************/

    private Messaging.SingleEmailMessage mergeAndCreateMail(TemplateDetails templateDetails, Opportunity opp) {
        EmailTemplate emailTemplate = templateDetails.getEmailTemplate();

        //merge existing fields
        String subject = emailTemplate.Subject;
        subject = mergeExistingFields(subject, opp);

        String htmlBody = emailTemplate.HtmlValue;
        System.debug('htmlBody = ' + htmlBody);
        htmlBody = mergeExistingFields(htmlBody, opp);

        String textBody = emailTemplate.Body;
        textBody = mergeExistingFields(textBody, opp);

        //merge dynamic fields
        Set<String> mergeFieldSet = getMergeFieldSet(subject, htmlBody, textBody);

        //we have to make the merge fields on the object type. 
        Map<String, List<String>> mergeFieldMap = getMergeFieldMap(mergeFieldSet);
        System.debug('mergeFieldMap = ' + mergeFieldMap);

        //now for each key in the array we need to make a dynamic soql
        //example of mergeFieldMap = {Opportunity=(Business_Type__c, Theater__c)}
        for (String s : mergeFieldMap.keySet()) {
            List<String> columnsForSoql = mergeFieldMap.get(s);
            String sColumnsForSoql = getListAsString(columnsForSoql);
            SObject sObj = null;
            if (s.equalsIgnoreCase('opportunity')) {
                sObj = Database.query('Select ' + sColumnsForSoql + ' from opportunity where id = \'' + opp.id + '\'');
            } else if (s.equalsIgnoreCase('user')) {
                sObj = Database.query('Select ' + sColumnsForSoql + ' from user where id = \'' + UserInfo.getUserID() + '\'');
            }
            subject = mergeDynamicFields(subject, sObj, mergeFieldSet);
            htmlBody = mergeDynamicFields(htmlBody, sObj, mergeFieldSet);
            textBody = mergeDynamicFields(textBody, sObj, mergeFieldSet);
        }

        //now get the renewals
        List<Renewal__c> renewals = getRenewals(opp);
        if (htmlBody.indexOf('<Renewals>') != -1 || htmlBody.indexOf('&lt;Renewals&gt;') != -1) {
            String htmlRenewals = printHtmlRenewals(renewals);
            if (htmlBody.indexOf('<Renewals>') != -1) {
                Integer startIndex = htmlBody.indexOf('<Renewals>');
                htmlBody = htmlBody.substring(0, startIndex)  + htmlRenewals + htmlBody.substring(startIndex + 10); //10 is length of renewals
            }
            if (htmlBody.indexOf('&lt;Renewals&gt;') != -1) {
                Integer startIndex = htmlBody.indexOf('&lt;Renewals&gt;');
                htmlBody = htmlBody.substring(0, startIndex)  + htmlRenewals + htmlBody.substring(startIndex + 16); //10 is length of renewals
            }

        }

        if (textBody.indexOf('<Renewals>') != -1 || textBody.indexOf('&lt;Renewals&gt;') != -1) {
            String textRenewals = printTextRenewals(renewals);
            if (textBody.indexOf('<Renewals>') != -1) {
                Integer startIndex = textBody.indexOf('<Renewals>');
                textBody = textBody.substring(0, startIndex)  + textRenewals + textBody.substring(startIndex + 10); //10 is length of renewals
            }
            if (textBody.indexOf('&lt;Renewals&gt;') != -1) {
                Integer startIndex = textBody.indexOf('&lt;Renewals&gt;');
                textBody = textBody.substring(0, startIndex)  + textRenewals + textBody.substring(startIndex + 16); //16 is length of renewals
            }
        }

        //now set the mail object
        Messaging.SingleEmailMessage mail = new Messaging.SingleEmailMessage();
        mail.setSubject(subject);
        mail.setHtmlBody(htmlBody);
        mail.setPlainTextBody(textBody);
        String[] userEmail = new List<String>();
        userEmail.add(getUserEmail()); 
        mail.setBccAddresses(userEmail);
        //set the attachments
        ID[] documentIds = templateDetails.getDocumentIds();
        if (documentIds != null) {
            System.debug('documentIds = ' + documentIds[0]);
            mail.setDocumentAttachments(documentIds);
        }

        //get the to Addresses
        String renewalNoticeEmail = opp.Renewal_Notice_Email__c;
        System.debug('renewalNoticeEmail = ' + renewalNoticeEmail);
        String[] toAddresses = renewalNoticeEmail.split(';'); //there maybe multiple
        mail.setToAddresses( toAddresses );
        return mail;
    }
private String mergeExistingFields(String text, Opportunity opp) {
            Set<String> existingFields = opportunityFields.keySet();
            for (String mergeField : existingFields) {
                System.debug('mergeField = ' + mergeField);
                Integer index = text.indexOf(mergeField);
                while (index != -1) {
                    String fieldSoqlName = opportunityFields.get(mergeField);
                    String value = '';

                    if (fieldSoqlName.startsWith('Account')) {
                        Account a = opp.Account;
                        fieldSoqlName = fieldSoqlName.substring(8);
                        value = (String) a.get(fieldSoqlName);
                    } else if (fieldSoqlName.startsWith('Owner')) {
                        User u = opp.Owner;
                        fieldSoqlName = fieldSoqlName.substring(6);
                        value = (String) u.get(fieldSoqlName);                                  
                    } else {
                        Object obj = opp.get(fieldSoqlName);
                        if (obj instanceof Date) {
                            Date dt = Date.valueOf(obj);
                            if (dt != null)
                                value = dt.month() + '/' + dt.day() + '/' + dt.year();
                            else
                                value = '';

                        } else {                                        
                            value = String.valueOf(obj);
                        }
                    }
                    if (value == null) value = '';

                    System.debug(fieldSoqlName + ' = ' + value);
                    Boolean more = text.length() > index + mergeField.length();
                    text = text.substring(0, index) + value + ((more) ? text.substring(index + mergeField.length()) : '');
                    index = text.indexOf(mergeField);       
                }
            }
            return text;
        }

        /*
         * Merges the fields retrieved by the dynamic query.
         */
        private String mergeDynamicFields(String text, SObject sObj, Set<String> mergeFieldSet) {

            for (String mergeField : mergeFieldSet) {
                Integer index = text.indexOf(mergeField);
                while (index != -1) {
                    String fieldValue = '';
                    String mergeFieldColumn = getMergeFieldColumn(mergeField);
                    System.debug('mergeFieldColumn = ' + mergeFieldColumn);
                    if (sObj != null) {
                        Object obj = sObj.get(mergeFieldColumn);
                        if (obj instanceof Date) {
                            Date dt = Date.valueOf(obj);
                            if (dt != null)
                                fieldValue = dt.month() + '/' + dt.day() + '/' + dt.year();                                             
                        } else {  
                            if (obj != null)                                      
                                fieldValue = String.valueOf(obj);
                        }
                    }
                    System.debug('fieldValue = ' + fieldValue);
                    if (fieldValue == null) fieldValue = '';
                    Boolean more = text.length() > index + mergeField.length();
                    text = text.substring(0, index) + fieldValue + ((more) ? text.substring(index + mergeField.length()) : '');
                    index = text.indexOf(mergeField);       
                }
            }

            return text;
        }

    /*
     * adds the merge fields to the Set. Set ensures they are added only once
     */
        private void extractMergeFields(String str, Set<String> mergeFieldSet) {
            Pattern p = pattern.compile(REGEX);
            Matcher m = p.matcher(str); // get a matcher object
            while(m.find()) {
                System.debug('group(): ' + m.group(0));
                mergeFieldSet.add(m.group(0));
            }
        }

        //example - mergeFieldSet = {{!Opportunity.Business_Type__c}, {!Opportunity.Theater__c}}
        private Set<String> getMergeFieldSet(String subject, String htmlBody, String textBody) {
                Set<String> mergeFieldSet = new Set<String>();
                extractMergeFields(subject, mergeFieldSet);
                extractMergeFields(htmlBody, mergeFieldSet);
                extractMergeFields(textBody, mergeFieldSet);
                System.debug('mergeFieldSet = ' + mergeFieldSet); 
                return mergeFieldSet;
        }

    /*
    * takes the merge field set and creates a map
    * Map is like - Opportunity = List {Theater__c, SomeField}
    */
    private Map<String, List<String>> getMergeFieldMap(Set<String> mergeFieldSet) {
        Map<String, List<String>> mergeFieldMap = new Map<String, List<String>>();
        for (String mergeField : mergeFieldSet) {
                String mergeFieldObject = getMergeFieldObject(mergeField);
                String mergeFieldColumn = getMergeFieldColumn(mergeField);
                List<String> mergeFieldColumnList = mergeFieldMap.get(mergeFieldObject);
                if (mergeFieldColumnList == null) {
                        mergeFieldColumnList = new List<String>();
                        mergeFieldMap.put(mergeFieldObject, mergeFieldColumnList);      
                }
                mergeFieldColumnList.add(mergeFieldColumn);
        }
        return mergeFieldMap;
    }

    private String getMergeFieldObject(String mergeField) {
        Integer index = mergeField.indexOf('.');
        if (index != -1)
            return mergeField.substring(2, index);
        return  mergeField;
    }

    private String getMergeFieldColumn(String mergeField) {
        Integer index = mergeField.indexOf('.');
        if (index != -1)
            return mergeField.substring(index + 1, mergeField.length() -1);
        return  mergeField;
    }

    private void updateOpportunities() {
        List<Opportunity> opportunities = new List<Opportunity>();
        for (OppWrapper wrapper : wrapperList) {
            Boolean selected = wrapper.getSelected();
            if (selected) {
                Opportunity opp = wrapper.getOpportunity();
                Decimal prob = opp.Probability;
                if (prob == 5) {
                    opp.StageName = 'Research and Internal Education';
                    opp.Probability = PROBABILITY;
                    opportunities.add(opp);             
                }
            }
        }
        update opportunities;
    }

    private void createTask() {
        List<Task> taskList = new List<Task>();
        for (OppWrapper wrapper : wrapperList) {
            Boolean selected = wrapper.getSelected();
            if (selected) {
                Task t = new Task();
                t.WhatId = wrapper.getOpportunity().Id;
                t.ActivityDate = Date.today();
                t.Description = 'A renewal notice has been sent to the following recipient(s): ' + wrapper.getOpportunity().get('Renewal_Notice_Email__c');
                t.OwnerId = UserInfo.getUserID();
                t.Status = 'Completed';
                t.Subject = createTaskSubject();
                taskList.add(t);            
            }
        }
        if (taskList.size() > 0) {
            insert taskList;
        }
    }

    public String createTaskSubject() {
        String txt = '';
        if (filterOption.equals('30')) { //60 days
            txt = '30';
        }else if (filterOption.equals('60')) { //60 days
            txt = '60';
        }else if (filterOption.equals('90')) { //60 days
            txt = '90';
        }else if (filterOption.equals('-1')) { //60 days
            txt = '-1';
        }else if (filterOption.equals('-14')) {  //90 days
            txt = '-14';
        }else if (filterOption.equals('-30')) {  //90 days
            txt = '-30';
        }else if (filterOption.equals('-90')) {  //90 days
            txt = '-90';
        }
        return 'Email: F5 Maintenance ' + txt + ' Day Renewal Notice';
    }

private String getUserEmail() {
User activeUser = [Select Email From User where Username = :UserInfo.getUserName() limit 1];
return activeUser.Email;
}

/* *************************renewal methods ********************************* */        
    private List<Renewal__c> getRenewals(Opportunity opp) {
        String oppId = opp.Id;
        List<Renewal__c> renewals  = [Select r.Serviced_Product_SKU__c, r.Serial_Number__c, r.Parent_Serial_Number__c, r.Line_End_Date__c From Renewal__c r Where Renewal_Opportunity__c =:oppId  OR Merged_to_Opportunity__c = :oppId];
        return renewals;
    }

    private String printHtmlRenewals(List<Renewal__c> renewals) {
        String htmlRenewals = '<table>';
        for (Renewal__c r : renewals) {
            htmlRenewals += '<tr>';
            htmlRenewals += '<td align=\'left\' width=\'20%\'>' + r.Serviced_Product_SKU__c + '</td>';
                htmlRenewals += '<td align=\'left\' width=\'15%\'>' + r.Parent_Serial_Number__c + '</td>';
                htmlRenewals += '<td align=\'left\' width=\'15%\'>' + r.Serial_Number__c + '</td>';
                Date dt = r.Line_End_Date__c;
                htmlRenewals += '<td align=\'left\' width=\'20%\'>' + dt.month() + '/' + dt.day() + '/' + dt.year() + '</td>';
            htmlRenewals += '</tr>';
        }
        htmlRenewals += '</table>';
        return htmlRenewals;
    }

    private String printTextRenewals(List<Renewal__c> renewals) {
        String textRenewals = '\n';
        for (Renewal__c r : renewals) {
        textRenewals += r.Serviced_Product_SKU__c + '\t';
            textRenewals += r.Parent_Serial_Number__c + '\t';
            textRenewals += r.Serial_Number__c + '\t';
            textRenewals += Date.valueOf(r.Line_End_Date__c) + '\n';
        }
        textRenewals += '\n';
        return textRenewals;
    }

/* 
 *****************util method ********************************* 
 */

    private String getListAsString(List<String> columnsForSoql) {
        String retStr = '';
        for (String s : columnsForSoql) {
                if (retStr != '') retStr += ',';
                retStr += s;
        }
        System.debug('getListAsString(): retStr = ' + retStr);
        return retStr;
    }

/*
 *****************getters *********************************
 */

    public List<Opportunity> getSuccessEmails() {
        return successEmails;   
    }

    public List<Opportunity> getFailureEmails() {
        return failureEmails;   
    }

    /*
     *******************wrapper class **************
     */
    public class OppWrapper {

        private Opportunity opportunity;
        private String emailTemplate;
        private Boolean selected;

        public void setOpportunity(Opportunity opportunity) {
                this.opportunity = opportunity; 
        }

        public Opportunity getOpportunity() { return this.opportunity; }

        public void setEmailTemplate(String emailTemplate) {
                this.emailTemplate = emailTemplate;     
        }

        public String getEmailTemplate() { return this.emailTemplate; } 

        public void setSelected(Boolean selected) {
                this.selected = selected;     
        }

        public Boolean getSelected() { return this.selected; } 
    }

        /*
         *********holder class for template details ******************
         */
        private class TemplateDetails {

                private EmailTemplate emailTemplate;
                private ID[] documentIds;

                public void setEmailTemplate(EmailTemplate emailTemplate) { this.emailTemplate = emailTemplate; }

                public EmailTemplate getEmailTemplate() { return this.emailTemplate; }  

                public void setDocumentIds(List<DocumentAttachmentMap> attachments) { 
                        if (attachments != null && attachments.size() > 0) {
                                documentIds = new ID[attachments.size()];
                                for (Integer i = 0; i < attachments.size(); i++) {
                                        documentIds[i] = attachments.get(i).DocumentId;
                                }
                        }
                }

                public List<ID> getDocumentIds() { return this.documentIds; }     
        }     
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T03:49:38.063

堆栈跟踪告诉您问题出在哪里：`Class.RenewalNotificationController.mergeExistingFields: line 321, column 1`.

转到该行并查看代码。从那个点开始备份，看看你是如何在那里得到一个 NULL 值的。查看您的调试日志以查看调用路径并观察传递给该函数的字段的值。`System.Debug()`如有必要，添加其他语句。

您拥有找出问题所需的一切，而且如果无法访问 Salesforce 组织中的代码，您将无能为力。

# shell - 在shell脚本的单引号内添加注释？

> ID：14248214
> 
> 赞同：1
> 
> 时间：2013-01-09T23:16:58.293
> 
> 标签：shell, hash, escaping, comments

我可以将注释（注释掉的代码或不影响脚本的注释）放在 shell 脚本的单引号内吗？

我尝试了以下方法来使这些工作：

```
# comment
\# comment
\/\* comment \*\/ 
```

下面是我正在尝试做的一个例子。你会看到我的评论以散列开头，并且在 curl 请求的数据包内的单引号内。

```
curl -XPOST 'http://ec2-54-234-64-66.compute-1.amazonaws.com:9200/nsns/nsn/_mapping?pretty=true' -d '{
    "nsn" : {

        "type" : "object",
        "include_in_all" : "false",
        "index" : "no",
        "properties" : {

        # this data is used for facetting END

            "id" : { "type" : "long", "include_in_all" : "true" },
            "BDC_CODE" : { "type" : "byte" },
            "KID" : { "type" : "byte" },
            "ITEM_STANDARDIZATION_CODE" : { "type" : "string" },

        # we don't know what these field's data look like yet

            "stock_on_hand" : { "type" : "integer" },
            "non_stocked_items" : { "type" : "integer" },
            "stocked_restrictions" : { "type" : "string" },
            "consistency_of_spend" : { "type" : "string" },
            "WSDC" : { "type" : "string" }

        }
    }
}' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:19:55.957

问题不是单引号，而是使用`JSON`. AFAIK，您不能在 中添加评论`JSON`，请参阅[Can comments be used in JSON?](https://stackoverflow.com/questions/244777/can-i-comment-a-json-file)

笔记 ：

你应该添加`-H "Content-Type: text/json"`你的`cURL`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T01:25:17.163

您不能将它们放在引号内，但您可以将字符串分解，以便保留注释：

```
json='{
    "nsn" : {

        "type" : "object",
        "include_in_all" : "false",
        "index" : "no",
        "properties" : {
'

# this data is used for facetting END
json+='
            "id" : { "type" : "long", "include_in_all" : "true" },
            "BDC_CODE" : { "type" : "byte" },
            "KID" : { "type" : "byte" },
            "ITEM_STANDARDIZATION_CODE" : { "type" : "string" },
'

# we don't know what these field's data look like yet
json+='
            "stock_on_hand" : { "type" : "integer" },
            "non_stocked_items" : { "type" : "integer" },
            "stocked_restrictions" : { "type" : "string" },
            "consistency_of_spend" : { "type" : "string" },
            "WSDC" : { "type" : "string" }
        }
    }
}'

url='http://ec2-54-234-64-66.compute-1.amazonaws.com:9200/nsns/nsn/_mapping?pretty=true'

curl -XPOST "$url" -d "$json" 
```

请注意，这`+=`是一个特定于 bash 的字符串连接赋值运算符。

# java - Java - 使用从超类导入的方法

> ID：14248216
> 
> 赞同：2
> 
> 时间：2013-01-09T23:17:04.593
> 
> 标签：java, inheritance, extends

> **可能重复：**
> [为什么 Java 编译器不支持导入继承？](https://stackoverflow.com/questions/14074874/why-should-the-java-compiler-not-support-inheritance-of-imports)

我是否可以执行以下操作：假设我有一个`A`扩展类的类`B`。`B`已导入类`C`，该类具有自己的`B`使用方法。可以`A`使用这些相同的方法，`C`而无需直接导入`C`，因为`A`extends `B`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:22:37.267

关键字是一个`imports`句法结构；它与该文件中声明的类无关。

当你使用一个类时，编译器无法知道它的源代码导入了哪些类或包。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:18:51.160

不，导入是类本地的。

您将不得不：

*   将 C 导入 A
*   在 B 中创建一个 A 可以调用的方法，该方法包装对 C 的调用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T23:24:06.253

不。

但如果你说：

*假设我有一个扩展类 B 的类 A。B~~导入了~~ **扩展**类 C，它有自己的 B 使用的方法。A 可以在不直接导入 C 的情况下使用 C 中的相同方法，因为 A 扩展了 B*。

然后 A 可以在不导入 C 的情况下使用 C`protected`和`public`方法（以及友好的方法，如果它在同一个包中）。

# jquery - Kendo UI Mobile - 停止在列表视图的点击事件中注册固定标题

> ID：14248221
> 
> 赞同：0
> 
> 时间：2013-01-09T23:17:21.440
> 
> 标签：jquery, listview, kendo-ui

我目前有一个问题，在我的列表视图的点击事件中注册了一个固定的标题。

我知道这可能是预期的行为，但很好奇将其从我的点击事件中的逻辑中排除的最佳方法？我知道固定标题使用该类`km-group-title`

DOM 如下所示：

```
<li>
    <div class="km-group-title">...</div>
    <ul class="km-list">
        <li>...</li>
    <ul>
</li> 
```

不注册那个 div 标签是我想要的。

谢谢

更新：

这是我如何绑定点击事件的片段（我想我刚刚通过条件逻辑解决了我的问题，但如果有更好的方法请告诉我！）：

```
$("#mList").kendoMobileListView({
        dataSource: kendo.data.DataSource.create({data: source, group: [ {field: "letter", dir: "asc"} ]}),
        template: $("#mTemplate").html(),
        headerTemplate: "${value}",
        fixedHeaders: true,
        type: "group",

        click: function(e) {
            // only register list items which contain an anchor tag
            if (e.target.closest("a").length) {
                e.preventDefault();
                // do something with list item
            }
        }
}); 
```

# c++ - constexpr 函数何时在编译时进行评估？

> ID：14248235
> 
> 赞同：67
> 
> 时间：2013-01-09T23:18:46.510
> 
> 标签：c++, c++11, runtime, compile-time, constexpr

既然声明为 constexpr 的函数可能在运行时被调用，那么编译器根据什么标准决定是在编译时还是在运行时计算它？

```
template<typename base_t, typename expo_t>
constexpr base_t POW(base_t base, expo_t expo)
{
    return (expo != 0 )? base * POW(base, expo -1) : 1;
}

int main(int argc, char** argv)
{
    int i = 0;
    std::cin >> i;

    std::cout << POW(i, 2) << std::endl;
    return 0;
} 
```

在这种情况下，i 在编译时是未知的，这可能是编译器将 POW() 视为在运行时调用的常规函数​​的原因。然而，这种动态，尽管看起来很方便，但有一些不切实际的含义。例如，是否存在我希望编译器在编译时计算 constexpr 函数的情况，而编译器决定将其视为普通函数，而它在编译时也可以工作？是否有任何已知的常见陷阱？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-01-09T23:25:17.970

`constexpr`当函数的所有参数都是常量表达式并且结果也用于常量表达式时，函数*将在编译时进行评估。*常量表达式可以是文字（如`42`）、非类型模板参数（如`N`in `template<class T, size_t N> class array;`）、`enum`元素声明（如`Blue`in `enum Color { Red, Blue, Green };`、另一个声明为*constexpr*的变量，等等。

当所有参数都是常量表达式并且结果*未*在常量表达式中使用时，它们*可能会*被评估，但这取决于实现。

 ** * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-09T23:24:48.840

当需要常量表达式时，必须在编译时评估该函数。

保证这一点的最简单方法是使用一个`constexpr`值，或者`std::integral_constant`：

```
constexpr auto result = POW(i, 2); // this should not compile since i is not a constant expression
std::cout << result << std::endl; 
```

或者：

```
std::cout << std::integral_constant<int, POW(i, 2)>::value << std::endl; 
```

或者

```
#define POW_C(base, power) (std::integral_constant<decltype(POW((base), (power)), POW((base), (power))>::value)

std::cout << POW_C(63, 2) << std::endl; 
```

或者

```
template<int base, int power>
struct POW_C {
  static constexpr int value = POW(base, power);
};

std::cout << POW_C<2, 63>::value << std::endl; 
```*

# wpf - 更新数据源时刷新数据网格

> ID：14248240
> 
> 赞同：4
> 
> 时间：2013-01-09T23:19:11.160
> 
> 标签：wpf, sql-server-2008, wpfdatagrid, observablecollection, inotifypropertychanged

我有一个数据网格，它显示一个绑定到一个`DataSource`在时间约束上不断变化的表。`DataSource`更新我的值时如何刷新数据网格的内容。

PS：我的`DataSource`表中的值由监控系统更新。其表值会定期更新。

我应该在我的 EF 哪里添加我的 Observable Collection？

```
 private IQueryable<MyTable> GetMyTablesQuery(TestDBEntities1 testDBEntities1 )
    {
         // definition of a Query to retrieve the info from my DB
        System.Data.Objects.ObjectQuery<EF_demo1.MyTable> myTablesQuery = testDBEntities1.MyTables;
         // Returns an ObjectQuery.
        return myTablesQuery ;
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
         // A New entity container is created that uses the object context
        var testDBEntities1 = new EF_demo1.HMDBEntities1();
         // Load data into MyTables. 
        var myTablesViewSource= ((System.Windows.Data.CollectionViewSource)(this.FindResource("myTablesViewSource")));
         // the query which is defined above is executed here. It grabs all the information from the entity container
        IQueryable<EF_demo1.MyTable> myTablesQuery = this.GetMyTablesQuery(testDBEntities1 );
         //The query result is binded to the source of the myTablesViewSource, which inturn binds back to the list.
        myTablesViewSource.Source = myTablesQuery .ToList();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:34:49.960

一种可能的方法是使用 ObservableCollection：

```
BoundCollection = new ObservableCollection<MyEntityType>(entities); 
```

Where `BoundCollection`is used in your binding. 然后每当更新值时，您将清除集合并重新添加它们：

```
BoundCollection.Clear();
foreach(var e in entities)
{
    BoundCollection.Add(e);
} 
```

这是另一个使用 INotifyPropertyChanged 并每次重新绑定集合的选项。但是，使用 ObservableCollection 是首选方法，因为它旨在添加和删除将自动更新 UI 的项目。

```
public class MyModel : INotifyPropertyChanged
{
  public IList<MyEntity> BoundCollection {get; private set;}

  public MyModel()
  {
    UpdateBinding();
  }

  private void UpdateBinding()
  {
    // get entities
    BoundCollection = new List<MyEntity>(entities);
    // this notifies the bound grid that the binding has changed
    // and should refresh the data
    NotifyPropertyChanged("UpdateBinding");
  }

  public event PropertyChangedEventHandler PropertyChanged;

  private void NotifyPropertyChanged( string propertyName = "")
  {
    if (PropertyChanged != null)
    {
      PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
  }
} 
```

# ios - 使用 Google Analytics for iOS SDK 2.0b3 时丢失的事件

> ID：14248241
> 
> 赞同：6
> 
> 时间：2013-01-09T23:19:12.250
> 
> 标签：ios, google-analytics

我最近将 Google Analytics 应用`iOS SDK v2`到了一些 . `iOS apps`，我注意到现在正在生成的报告中存在一些看似很大的差异。我主要担心的是，我的跟踪 ID 的总事件数大约`50%`低于我的内部指标所建议的值。我花了一些时间试图排除可能的问题。

首先，我认为我可能没有从应用程序内向 Google 进行跟踪调用，但这些都已检查。接下来，我测试了指标没有通过网络从本地数据库中生成的理论。在设置了wireshark来监控网络流量之后，这似乎也能正常工作。接下来，我尝试更慢地处理事件，因为我认为可能是事件在短时间内触发的事实可能是问题所在。在将事件触发率降低到每秒最多 1 次，然后进一步降低到每 3 秒最多 1 次之后，`50%`在 Web UI 中监视我的测试会话时，我仍然看到大致的事件丢失。此外，在我生成的报告中删除哪些事件似乎有些随机。

以下是有关我的分析配置的其他一些信息：

*   调度间隔60s
*   手动启动会话
*   使用多个跟踪器

奇怪的是，相同应用程序的 android 版本并没有表现出相同的问题。

如果有人有类似的经历或有任何建议，他们将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T15:09:35.243

在与 Google Analytics 团队联系后，他们确认 iOS SDK 的 beta 3 和 4 存在一个错误，导致我看到的漏报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T15:20:51.413

在[https://developers.google.com/analytics/devguides/collection/ios/v2/events](https://developers.google.com/analytics/devguides/collection/ios/v2/events)上有信息（错字，Android -> Analitics）：

> 注意：如果在短时间内发出大量发送调用，适用于 iOS 的 Google Android SDK 可能会限制事件以及其他点击。

所以，我认为您的问题可能与此有关。如果您正在通过 wireshark 监控流量并且您的应用正在发送正确的呼叫，我认为您无能为力。也许，尝试将调用之间的间隔增加到真正无可争议的值——比如 30 秒——然后计算差异。

# python - 将视图装饰器应用于 MethodView 派生类

> ID：14248242
> 
> 赞同：1
> 
> 时间：2013-01-09T23:19:17.443
> 
> 标签：python, flask, decorator

在我的烧瓶应用程序中，所有视图都来自 MethodView。

```
class TestView(MethodView):
def __init__(self):
    self.form = TestForm()

@login_required
@campaign_required
def get(self,cid):
     ......... 
```

并且 url 规则设置在不同的文件中......

这篇文章中提到的django是否有类似的可能：

[装饰基于类的视图的两种方法有什么区别？](https://stackoverflow.com/questions/12132819/whats-the-difference-between-the-two-methods-of-decorating-class-based-views)

我需要用一些限制来装饰班级......如上所述......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T09:04:22.610

我写了基于[这个片段](http://nimnull.blogspot.com/2012/05/decorating-flask-methodview-on-per.html)的小例子：

```
class BaseApi(MethodView):

def _content_type(self, method):
    """ decorator example """
    def decorator(*args, **kwargs):
        best = request.accept_mimetypes.best_match(['text/html', 'application/json'])

        if best == 'text/html':
            return self._html(*method(*args, **kwargs))

        elif best == 'application/json':
            return self._json(*method(*args, **kwargs))

        else:
            abort(400, err='Unknown accept MIME type - "%s"' % best)
            return

    return decorator

def dispatch_request(self, *args, **kwargs):
    method = super(BaseApi, self).dispatch_request

    if self.method_decorators is None:
        return method(*args, **kwargs)

    method_decorators = self.method_decorators.get(request.method.lower(), [])
    if getattr(method_decorators, '__call__', False):
        method_decorators = [method_decorators]

    common_decorators = self.method_decorators.get('*', [])
    if getattr(common_decorators, '__call__', False):
        common_decorators = [common_decorators]

    method_decorators.extend(common_decorators)

    for decorator in method_decorators:
        method = decorator(self, method)

    return method(*args, **kwargs)

method_decorators = {
    '*': _content_type,   # decorators here are applied to all methods
    # 'get': <another decorator only for get method>,
    # 'post': [<list of decorator functions that are applied for post requests>]
} 
```

# css - div 和图层

> ID：14248243
> 
> 赞同：0
> 
> 时间：2013-01-09T23:19:17.737
> 
> 标签：css, html

首先是网站：[www.rfdesignstudio.com/weavepublic/](http://www.rfdesignstudio.com/weavepublic/)

第二个CSS代码：

```
#hoverbox {
    position:absolute;
    width:725px;
    height:132px;
    z-index:1;
    margin-left:-360px;
    left:50%;
    top: 740px;
    visibility: visible;
} 
```

树部分后面的黑盒子。我希望它保持在那个位置，但是当我在顶部使用面板时，它会向上滑动，因为位置是绝对的。我仍在学习 css，并希望它留在那个地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:29:19.093

如果我的理解是正确的，您希望绿色框出现在其余内容之上吗？如果我错了，请纠正我。

为此，您需要将面板的 css 更改为此。

```
#panel {
background: #749311;
height: 200px;
display: none;
position: absolute;
width: 100%;
top: -200px;
} 
```

然后当您单击时，`.btn-slide`您会将顶部位置设置为 0px。像这样的东西。

```
$('.btn-slide').live('click',function () {
    $('#panel').animate({top:0});
}); 
```

* * *

**编辑** 现在我明白了。请看下文。

如果你改变`#wrapper {over:visible;}`

和

```
#hoverbox {
position: relative;
width: 725px;
height: 132px;
z-index: 1;
visibility: visible;
margin-left: auto;
margin-right: auto;
} 
```

我认为这应该有效

# sql-server - 如何在 SQL 中创建替换模式？

> ID：14248244
> 
> 赞同：8
> 
> 时间：2013-01-09T23:19:18.760
> 
> 标签：sql-server, tsql, replace

我有一个很长的 NVARCHAR 变量，我需要在其中替换一些这样的模式：

```
DECLARE @data NVARCHAR(200) = 'Hello [PAT1] stackoverflow [PAT2] world [PAT3]' 
```

我需要`[PAT%]`用空格替换所有内容，如下所示：

```
'Hello stackoverflow world' 
```

如何在 SQL Server 2008 中使用 T-SQL 执行此操作？

我正在搜索其他问题，我只找到[了 this](https://stackoverflow.com/questions/4385649/how-do-i-replace-a-pattern-using-t-sql)，但这对我没有帮助，因为我不需要保留字符串的原始部分。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T23:56:53.090

您可以使用此功能进行模式替换。您可以使用此[SQL-Fiddle 演示](http://sqlfiddle.com/#!3/92581/3/0)对其进行测试。

```
CREATE FUNCTION dbo.PatternReplace
(
   @InputString VARCHAR(4000),
   @Pattern VARCHAR(100),
   @ReplaceText VARCHAR(4000)
)
RETURNS VARCHAR(4000)
AS
BEGIN
   DECLARE @Result VARCHAR(4000) SET @Result = ''
   -- First character in a match
   DECLARE @First INT
   -- Next character to start search on
   DECLARE @Next INT SET @Next = 1
   -- Length of the total string -- 8001 if @InputString is NULL
   DECLARE @Len INT SET @Len = COALESCE(LEN(@InputString), 8001)
   -- End of a pattern
   DECLARE @EndPattern INT

   WHILE (@Next <= @Len) 
   BEGIN
      SET @First = PATINDEX('%' + @Pattern + '%', SUBSTRING(@InputString, @Next, @Len))
      IF COALESCE(@First, 0) = 0 --no match - return
      BEGIN
         SET @Result = @Result + 
            CASE --return NULL, just like REPLACE, if inputs are NULL
               WHEN  @InputString IS NULL
                     OR @Pattern IS NULL
                     OR @ReplaceText IS NULL THEN NULL
               ELSE SUBSTRING(@InputString, @Next, @Len)
            END
         BREAK
      END
      ELSE
      BEGIN
         -- Concatenate characters before the match to the result
         SET @Result = @Result + SUBSTRING(@InputString, @Next, @First - 1)
         SET @Next = @Next + @First - 1

         SET @EndPattern = 1
         -- Find start of end pattern range
         WHILE PATINDEX(@Pattern, SUBSTRING(@InputString, @Next, @EndPattern)) = 0
            SET @EndPattern = @EndPattern + 1
         -- Find end of pattern range
         WHILE PATINDEX(@Pattern, SUBSTRING(@InputString, @Next, @EndPattern)) > 0
               AND @Len >= (@Next + @EndPattern - 1)
            SET @EndPattern = @EndPattern + 1

         --Either at the end of the pattern or @Next + @EndPattern = @Len
         SET @Result = @Result + @ReplaceText
         SET @Next = @Next + @EndPattern - 1
      END
   END
   RETURN(@Result)
END 
```

[资源链接](http://dataeducation.com/splitting-a-string-of-unlimited-length/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-25T19:30:08.663

+1 @Nico，我需要一个可以从字符串中删除特殊章程的函数，所以我稍微调整了你的函数以便能够做到这一点：

```
select dbo.PatReplaceAll('St. Martin`n tr‘an, or – in - the * field007', '[^0-9A-Z ]', '')
--Returns 'St Martinn tran or  in  the  field007' 
```

这是功能：

```
CREATE FUNCTION dbo.PatReplaceAll 
(
    @Source     varchar(8000),
    @Pattern    varchar(  50),
    @Replace    varchar( 100)
)
RETURNS varchar(8000)
AS
BEGIN
    if @Source is null or @Pattern is null or @Replace is null
        return null
    if PATINDEX('%' + @Pattern + '%', @Source) = 0
        return @Source
    -- Declare the return variable here
    DECLARE @Result varchar(8000) SET @Result = ''
    -- The remainder of the @Source to work on
    DECLARE @Remainder varchar(8000) SET @Remainder = @Source
    DECLARE @Idx INT

    WHILE (LEN(@Remainder) > 0) 
    BEGIN
        SET @Idx = PATINDEX('%' + @Pattern + '%', @Remainder)
        IF @Idx = 0 --no match - return
            BEGIN
                SET @Result = @Result +  @Remainder
                BREAK
            END
        -- Concatenate characters before the match to the result
        SET @Result = @Result + SUBSTRING(@Remainder, 1, @Idx - 1)
        -- Adjust the remainder
        SET @Remainder = SUBSTRING(@Remainder, @Idx, LEN(@Remainder) + 1 - @Idx)

        SET @Idx = 1
        -- Find the last char of the pattern (aka its length)
        WHILE PATINDEX(@Pattern, SUBSTRING(@Remainder, 1, @Idx)) = 0
            SET @Idx = @Idx + 1
        --remove the pattern from the remainder
        SET @Remainder = SUBSTRING(@Remainder, @Idx + 1, LEN(@Remainder) - @Idx)
        --Add the replace string
        SET @Result = @Result + @Replace
    END
    return @Result
END
GO 
```

# django - Django - 在管理面板中查看外键对象的详细信息

> ID：14248246
> 
> 赞同：0
> 
> 时间：2013-01-09T23:19:32.967
> 
> 标签：django, django-admin, django-admin-tools

我有一个像下面这样的模型；

```
class Lecturer(models.Model):
    name = models.CharField(max_length=200,verbose_name=u'Eğitmenin Adı')
    tc_kimlik_no = models.IntegerField(verbose_name=u'Eğitmenin TC Kimlik Numarası')
    sertifika_no = models.CharField(max_length=200,verbose_name=u'Eğitmenin sertifika numarası')

    def __unicode__(self):
        return self.name

class Certificate(models.Model):
       name = models.CharField(max_length=50,verbose_name=u'Adı ve Soyadı')
       tc_kimlik = models.IntegerField(verbose_name="TC Kimlik No")
       sertifika_no = models.CharField(max_length=200,verbose_name="Sertifika No")
       egitim_tarihi = models.DateField(verbose_name='Eğitim Tarihi')
       hangi_egitim = models.ManyToManyField(Egitim,verbose_name="Hangi Eğitimi aldı?")
       nerde_verildi = models.ForeignKey(City,verbose_name="Eğitim Nerde Verildi")
       lecturer = models.ForeignKey(Lecturer,verbose_name="Eğitmen") 
```

但是在管理面板中，当在**证书管理表单中选择****讲师**对象时，我想查看除 unicode 之外的讲师的其他详细信息，例如“tc_kimlik_no 和 sertifika_no”。有没有办法做到这一点？

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:48:00.183

猜测您的要求，如果您想显示其他内容，只需将它们添加到您的`unicode`方法中：

```
class Lecturer(models.Model):
    name = models.CharField(max_length=200,verbose_name=u'Eğitmenin Adı')
    tc_kimlik_no = models.IntegerField(verbose_name=u'Eğitmenin TC Kimlik Numarası')
    sertifika_no = models.CharField(max_length=200,verbose_name=u'Eğitmenin sertifika numarası')

    def __unicode__(self):
        return 'Name: %s, Kimlik: %s, Sertifika: %s' % (
            self.name, str(self.tc_kimlik_no), self.sertifika_no) 
```

那是你想要的吗？**

# asp.net - 利弊，使用文字控制与精确控制和 runat=server

> ID：14248247
> 
> 赞同：2
> 
> 时间：2013-01-09T23:19:32.780
> 
> 标签：asp.net, webforms

我们遇到了一些由我们的 CMS 系统带来的场景，我们无法再使用代码块。目前有一些关于是否使用文字控件与使用所需的精确控件以及修改内部 html、href、innerText 等的讨论。

出于某种原因，我讨厌文字控件，但除了讨厌在服务器端构建 html 之外，我无法真正解释为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:56:13.137

Literal 的主要优点是它不呈现额外的标签 - 它只显示分配给 Text 属性的内容。所以它对快速显示 HTML 或 JavaScript 很有用。

然而，使用这些 Literal 控件的缺点是，当您想要对控件进行进一步的编程控制时，它会变得混乱 - 例如，在输出的 Text 上设置样式（您可以使用 Literal 来实现，但它很难看）

参考这个：

*   [http://msdn.microsoft.com/en-us/library/gg615475(v=vs.88).aspx](http://msdn.microsoft.com/en-us/library/gg615475(v=vs.88).aspx)

# java - Java swt 将对象拖入“死区”以创建新窗口

> ID：14248254
> 
> 赞同：1
> 
> 时间：2013-01-09T23:19:55.480
> 
> 标签：java, drag-and-drop, swt

我正在寻找用我的软件模拟窗口拖动。我目前有一些画布，它们在视图中就像它自己的窗口一样。我在它们之间创建了一个拖放，这一切都非常可靠。但是，当我拖放到死区时，我希望做一个拖动案例。或者更好地表述为我的应用程序未涵盖的区域。我的第一个想法是听鼠标移动到当前外壳之外，然后做一些事情。但是，我似乎无法找到一种方法来检测我在外壳之外。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-01T16:48:46.703

> 我似乎无法找到一种方法来检测我在外壳之外。

如果您使用的是[MouseListener](http://help.eclipse.org/kepler/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fevents%2FMouseListener.html)，则可以实现[mouseUp(MouseEvent)方法并通过](http://help.eclipse.org/kepler/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/events/MouseListener.html#mouseUp(org.eclipse.swt.events.MouseEvent))[MouseEvent](http://help.eclipse.org/kepler/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fevents%2FMouseListener.html&anchor=mouseUp(org.eclipse.swt.events.MouseEvent))对象获取鼠标释放的点。

```
@Override
public void mouseUp(final MouseEvent event) {
    final Point releasePoint = new Point(e.x, e.y);
} 
```

请注意，此位置将相对于添加此侦听器的对象的父 Shell。您需要将该父 Shell 的位置添加到上面的 (x,y) 对中，以获得屏幕上的绝对位置。

现在您有了单击某个目标对象后释放鼠标的点，您可以使用[Rectangle.contains(Point)](http://help.eclipse.org/luna/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/graphics/Rectangle.html#contains(org.eclipse.swt.graphics.Point))方法检查该点是否在原始窗口之外。

```
final Composite target = new Composite(parentComposite, SWT.NONE);
target.addMouseListener(new MouseAdapter() {
    @Override
    public void mouseUp(final MouseEvent event) {
        final Point releasePoint = new Point(event.x + target.getShell().getLocation().x,
                                             event.y + target.getShell().getLocation().y);
        if (!target.getShell().contains(releasePoint)) {
            // Dragged and dropped outside the window!
        }
    }
}); 
```

从这里你可以做任何你需要做的工作来创建一个新的 shell 并将目标移动到那个 shell。

* * *

这是我放在一起的一个小工作示例，您可以在其中将黄色矩形拖放到一个窗口中，它将创建一个包含矩形的新窗口：

```
public static void main(final String... args) {
    final Display display = new Display();
    final Shell shell = new Shell(display);
    shell.setText("Original shell");
    shell.setLayout(new FillLayout());
    shell.setMaximized(true);

    final Composite parentComposite = new Composite(shell, SWT.NONE);
    parentComposite.setLayout(new GridLayout());
    parentComposite.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));

    final Composite target = new Composite(parentComposite, SWT.NONE);
    target.setBounds(new Rectangle(0, 0, 100, 100));
    target.setBackground(new Color(display, 255, 255, 0));
    target.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseUp(final MouseEvent event) {
            final Point releasePoint = new Point(event.x + target.getShell().getLocation().x,
                                                 event.y + target.getShell().getLocation().y);
            if (!target.getShell().getBounds().contains(releasePoint)) {
                // Create the new shell and base composite
                final Shell newShell = new Shell(display);
                newShell.setText("New shell");
                newShell.setLayout(new FillLayout());
                newShell.setMaximized(true);
                final Composite newComposite = new Composite(newShell, SWT.NONE);
                newComposite.setLayout(new GridLayout());
                newComposite.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));

                // Set the parent of the target widget to the new base composite
                target.setParent(newComposite);
                target.layout();

                // Open the new shell
                newShell.setLocation(releasePoint);
                newShell.setSize(300, 300);
                newShell.open();
            }
        }
    });

    shell.setSize(300, 300);
    shell.open();
    display.readAndDispatch();

    while (!shell.isDisposed()) {
        if (!shell.getDisplay().readAndDispatch()) {
            shell.getDisplay().sleep();
        }
    }
} 
```

* * *

编辑：只是为了澄清，如果您使用 Canvas （您在问题中提到）而不是 Composite 作为`target`对象，它的行为将完全相同。

# jquery - Ruby on Rails 网站：向导航栏添加/删除活动类

> ID：14248258
> 
> 赞同：4
> 
> 时间：2013-01-09T23:20:15.437
> 
> 标签：jquery, ruby-on-rails, ruby, navbar

我正在用 Ruby on Rails 构建一个静态网站，我有一个如下所示的**application.html.erb**文件：

```
<!DOCTYPE html>
<html>
 <head>
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>BayEquities</title>
    <%= stylesheet_link_tag    "application", :media => "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
    <%= render "layouts/shim" %>
 </head>
 <body>
  <%= render "layouts/header" %>
  <div class="container">
    <%= yield %>
  </div>
 </body>
</html>

<script type="text/javascript">
  $(function() {
   $('.navbar .nav > li > a').click(function(e){
       $('.navbar .nav > li.active').removeClass('active')
       $(this).parent('li').addClass('active')
    });
  });
</script> 
```

目前，此代码添加活动类并相应地删除它。唯一的问题是每次单击新的导航栏链接时，标题部分（下面的代码）都会重新加载。从而在每次点击后将活动类应用于“主页”。

**_header.html.erb**

```
<header class="navbar">
  <div class="navbar-inner">
   <a class="brand" id="logo">Bay Equities</a>
   <ul class="nav">
    <li class="active"><%= link_to "Home", "index" %></li>
    <li><%= link_to "Services", "services" %></li>
    <li><%= link_to "Contact Us", "contact" %></li>
   </ul>
  </div>
</header> 
```

我提前为匆忙的格式化工作道歉，感谢所有帮助！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-09T23:42:28.727

您是否考虑过将此逻辑移至 Rails？

例如，您可以设置一个辅助方法，根据 params[:action] 分配活动类。

```
module ApplicationHelper  

  def is_active(action)       
    params[:action] == action ? "active" : nil        
  end

end 
```

然后在您的部分中为您的主页链接：

```
<li class="<%=is_active('home')%>"><%= link_to "Home", "index" %></li>
<li class="<%=is_active('services')%>"><%= link_to "Services", "services" %></li>
<li class="<%=is_active('contact')%>"><%= link_to "Contact Us", "contact" %></li> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-06-18T04:51:40.123

添加下面的类`application_helper.rb`

```
def current_class_by(path:)
    return 'active' if request.path == path ''
end 
```

菜单链接看起来类似于这样。

```
<%= link_to(dashboard_path, class: "nav-link #{current_class_by(path: dashboard_path)}") do %>
    <i class="nav-icon __icon-tachometer"></i>
    <p><%= t('dashboard_admin.menus.dashboard') %></p>
<% end %> 
```

# sql - 如何在没有日志文件的情况下附加 MDF？

> ID：14248260
> 
> 赞同：13
> 
> 时间：2013-01-09T23:20:20.197
> 
> 标签：sql, sql-server, sql-server-2008

我正在尝试`Yafnet.mdf`在没有日志文件的 SQL Server Management Studio 中附加。

我收到以下错误。任何想法如何做到这一点？

> *执行 Transact-SQL 语句或批处理时发生异常。(Microsoft.SqlServer.ConnectionInfo)*
> 
> *无法打开物理文件“C:\sql_logs\YAFnet_log.ldf”。操作系统错误 2：“2（系统找不到指定的文件。）”。（Microsoft SQL Server，错误：5120）*

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-09T23:29:11.520

对于您的初始情况，您似乎尝试过这样的事情（或者当您通过对话框时 GUI 为您准备的任何东西）：

```
CREATE DATABASE YAFnet ON (FILENAME = N'C:\sql_data\YAFnet.mdf')
FOR ATTACH; 
```

但是，此方法需要一个`mdf`文件和一个`ldf`文件。否则，您会收到类似于以下内容的错误消息：

> 消息 5120，级别 16，状态 101，第 1 行
> 无法打开物理文件“C:\sql_logs\YAFnet_log.ldf”。操作系统错误 2：“2（系统找不到指定的文件。）”。

现在，即使您只有`mdf`文件，也有一种方法可以继续。假设您有一个`mdf`从 SQL Server 正确分离的文件，您应该能够`mdf`使用以下语法在没有日志文件的情况下附加该文件：

```
CREATE DATABASE YAFnet ON (FILENAME = N'C:\sql_data\YAFnet.mdf')
FOR ATTACH_REBUILD_LOG; 
```

但是，在您的情况下，该文件似乎没有与 SQL Server 正确分离：

> Msg 1813, Level 16, State 2, Line 1
> 物理文件名“C:\sql_logs\YAFnet_log.ldf”可能不正确。无法重建日志，因为数据库关闭时有打开的事务/用户，数据库没有发生检查点，或者数据库是只读的。如果由于硬件或环境故障而手动删除或丢失事务日志文件，则可能会发生此错误。

有几种可能的解释，包括错误消息中提到的那些。也许它是从一些无效的 SAN 影子中检索到的，或者在只读时分离，或者在 SQL Server 或底层系统崩溃后恢复，或者在复制/下载期间损坏，或者谁知道还有什么。

您将需要返回 Yaf 的支持或他们的服务提供商的支持，以查看是否有***适当的备份***`mdf`可用，或者如果没有可用的文件的备用副本。还要记住，我们没有人真正知道 Yaf 是什么，也没有任何方法可以验证您所说的 Yaf。

否则，您似乎不走运，因为此特定`mdf`文件无效，因此不会让您走得太远。

这正是为什么分离/附加和/或 O/S 级文件复制方法对于 SQL Server 的备份（或迁移）不是非常有用的方法的原因。您需要一个适当的备份/恢复计划，这意味着采取适合您对数据丢失的容忍度的适当的完整/差异/日志备份。并且分离数据库几乎总是一个低级的想法 - 当`mdf`文件在分离期间或之后发生某些事情时，您现在拥有数据库的***零***副本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-09T23:30:35.000

您可以尝试几件事。第一的：

```
CREATE DATABASE Yafnet ON (NAME = 'Yafnet', FILENAME='*filepath*\Yafnet.mdf') FOR ATTACH; 
```

如果这不起作用，那么试试这个：

右键单击 SSMS 并以管理员身份运行。然后再次尝试附加。这应该可以解决问题。

# mysql - 错误 2006 (HY000) 第 9675 行：MySQL 服务器已消失

> ID：14248261
> 
> 赞同：-2
> 
> 时间：2013-01-09T23:20:21.320
> 
> 标签：mysql

我正在尝试恢复数据库（大小 477mb）并不断收到错误消息：*MySQL server has gone away*。我不确定如何解决此错误。我努力了：

*   更改`max_allowed_packets`为 600M。
*   增加到2880000 `wait_timeout`。

但这些都没有帮助。这是确切的错误消息：

> 18:13:52 恢复 C:\Users\Niting\Documents\Backup 20120918 0000.sql
> 
> 运行：mysql.exe --defaults-extra-file="c:\users\niting\appdata\local\temp\tmp_krvy8.cnf" --host=localhost --user=root --port=3306 --default-字符集=utf8 --comments < "C:\Users\Niting\Documents\Backup 20120918 0000.sql"`
> 
> ERROR 2006 (HY000) at line 9675: MySQL server has gone away

第 9675 行包含

```
(
3434,'','','brocar',18730,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL
,NULL,NULL,NULL,NULL,'false',NULL,NULL,'true',NULL,'Once',NULL,NULL,NULL
,NULL,NULL,'false',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'false'
,NULL,'false','false',NULL,'Accomplishment','false',NULL,NULL,NULL,NULL
,NULL,NULL,NULL,71,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL
,NULL,'2011-10-30','true',0,'false',NULL,NULL,NULL,NULL,NULL,NULL,'false'
,NULL,NULL,'2011-10-30',NULL,NULL,NULL,NULL,NULL,NULL,'2011-10-30','14:35:27'
), 
```

该行位于此插入下方：

```
INSERT INTO `tbldelinspect` (
`DELINSPECTID`,`DATE`,`TIME`,`USER`,`PIECEID`,`MARQUE`,`MODEL`,`SN`,`FROMTTAF`
,`FROMDATE`,`TBOHRS`,`INSTALLTTAF`,`INSTALLDATE`,`INSTALLCUSTOM`,`TBOMONTH`
,`HRSWARNING`,`MONTHWARNING`,`NOM`,`ISDUE`,`ACREG`,`DESCRIPTION`,`ISAD`
,`ADWHATSDONE`,`ADTYPE`,`NBSTART`,`CUSTOMCOMPUTEID`,`GROUPID`,`INVENTAIREID`
,`ATACODE`,`ADDONE`,`ADINTERVALTYPE`,`REMAINHRS`,`DUETTAF`,`DATENEXTINSPECT`
,`NOTE`,`CORRECTION`,`SHORTDESC`,`TTSO`,`REMAINMONTH`,`WARN`,`TSO`,`ISINSPECTION`
,`ISCURRENTINSPECTION`,`MONTHSATINSTALL`,`ACTION`,`UPDATE_`,`TSN`,`TTSN`,`MSN`
,`TMSN`,`REMAINCUSTOM`,`DUECUSTOM`,`TMSO`,`AIRCRAFTID`,`CUSTOMTBO`,`FROMCUSTOM`
,`CUSTOMWARNING`,`CUSTSN`,`TCUSTSN`,`CUSTOMATINSTALL`,`TCUSTSO`,`CUSTOMENGINE`
,`OLDMAXNG`,`MAXNG`,`ADCOMPONENT`,`LASTUPDATE`,`KEEPHISTORY`,`STARTADD`,`ISTASK`
,`TASKNO`,`RELATEDPIECEID`,`AIRCRAFTZONE`,`REFERENCE`,`PARTNO`,`TEMPLATEKEY`
,`ISSPECIALINSPECT`,`MANUALNEXTDUETTAF`,`MANUALNEXTDUECUSTOM`,`MANUALNEXTDUEDATE`
,`PERFAFTERXTTAF`,`PERFAFTERXMONTH`,`PERFAFTERXCYCLE`,`SPECIALTASKLINKPIECEID`
,`TOLERANCEVALUE`,`ASSEMBLYMASTERID`,`DELDATE`,`DELTIME`
) 
VALUES 
```

任何想法如何克服这个问题，以便我可以恢复我的 MySQL 数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:27:41.953

问题似乎不是由于`max_allowed_packet`，因为这会生成一个非常具体的消息，应该是`Got a packet bigger than 'max_allowed_packet' bytes`。您确定 MySQL 服务器没有因为您的声明而崩溃吗？您能否检查`SHOW GLOBAL STATUS LIKE 'Uptime'`以确保服务器正常运行的时间与您预期的一样长？

如果它在您`INSERT`加载转储期间崩溃/重新启动，这可能是由于磁盘空间不足或现有损坏。

# c# - 分数的字体

> ID：14248265
> 
> 赞同：3
> 
> 时间：2013-01-09T23:21:08.453
> 
> 标签：c#, .net, graphics, fractions, opentype

我有一个函数可以将小数转换为等效的分数。我找到了一些分数，但我似乎找不到十六分之一 (1/16) 分数。任何人都对我可以在网上查看的位置或将这三个字符分数转换为一个字符分数的方法提出任何建议。

我在下面有一个位图，它显示了第 16 小部分在哪里占据了如此多的不动产，这与其他看起来又小又小的部分不同。

我在下面添加了用于转换这些分数的函数。

我在网上到处查了，还没有解决。

如果我能在这里得到类似[http://msdn.microsoft.com/en-us/library/ms745109.aspx](http://msdn.microsoft.com/en-us/library/ms745109.aspx)的内容，大约在页面下方的四分之三处，您会看到数字类型。如果我能得到类似 Windows 图形的堆叠版本，那将是一个胜利。

![门细节](../Images/b2b432b72185c72b24e22f2a6af8e746.png)

```
static string getFractionFromDecimal(decimal dec)
    {
        string d = dec.ToString(), dd = string.Empty;
        switch (d)
        {
            case "0.0625": dd = " 1/16"; break;
            case "0.1250": dd = "⅛"; break;
            case "0.1875": dd = " 3/16"; break;
            case "0.2500": dd = "¼"; break;
            case "0.3125": dd = " 5/16"; break;
            case "0.3750": dd = "⅜"; break;
            case "0.4375": dd = " 7/16"; break;
            case "0.5000": dd = "½"; break;
            case "0.5625": dd = " 9/16"; break;
            case "0.6250": dd = "⅝"; break;
            case "0.6875": dd = " 11/16"; break;
            case "0.7500": dd = "¾"; break;
            case "0.8125": dd = " 13/16"; break;
            case "0.8750": dd = "⅞"; break;
            case "0.9375": dd = " 15/16"; break;
        }; return dd;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:47:30.427

我为你写了一个小班，可以帮助你画分数。请注意，我已经硬编码了许多值，这**不是**一个好习惯。如果你打算使用这个概念，我建议你在代码中参数化乘数。

```
public class FractionLabel : Control
{
    public int Numerator { get; set; }
    public int Denominator { get; set; }
    public Brush Brush { get; set; }

    protected override void OnPaint(PaintEventArgs e)
    {
        var graphics = e.Graphics;
        var font = Font;
        var n = Numerator.ToString();
        var d = Denominator.ToString();
        var numSize = graphics.MeasureString(n, font);
        graphics.DrawString(n, Font, Brush, new PointF());
        //Comment out the following line if you want sharp lines
        graphics.SmoothingMode = SmoothingMode.AntiAlias;
        using (var pen = new Pen(Brush))
        {
            var p1 = new PointF(numSize.Width/2, numSize.Height*5/4);
            var p2 = new PointF(numSize.Width*5/4, numSize.Height/2);
            graphics.DrawLine(pen, p1, p2);
        }
        var dPos = new PointF(numSize.Width*3/4, numSize.Height*3/4);
        graphics.DrawString(d, Font, Brush, dPos);
    }
} 
```

示例用法：

```
var label = new FractionLabel
            {
                Numerator = 3,
                Denominator = 16,
                Font = new Font("Arial", 8),
                Brush = Brushes.Black,
                Width = 100,
                Height = 100
            };
Controls.Add(label); 
```

如果您修改此类并集成它，您可以修改您的方法以返回 a`FractionLabel`而不是 a `string`。

# xcode - 尝试从相机胶卷播放电影时出现黑屏

> ID：14248267
> 
> 赞同：1
> 
> 时间：2013-01-09T23:21:27.470
> 
> 标签：xcode, url, mpmovieplayercontroller, playback

我在这里和网络上查看了十几个不同的帖子。还是想不通。我可以在本地播放已附加到支持文件的电影，但是当我尝试播放从相机胶卷中挑选的电影时，出现黑屏。所以我认为问题在于从 uipicker 获取 url 并播放它。

我认为我的问题出在 playMovie 的前两行 -

```
NSURL *videoURL = [NSURL URLWithString:@"public.movi​​e"];
MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL: videoURL];

```

这没有给我正确的网址来从选择器播放电影。我也试过用'url'代替@"public.movi​​e"

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController
@synthesize player;

-(IBAction) selectMovie
{

    UIImagePickerController *picker =
    [[UIImagePickerController alloc] init];
    picker.delegate = self;
    picker.sourceType =
    UIImagePickerControllerSourceTypePhotoLibrary;

    picker.mediaTypes = [[NSArray alloc] initWithObjects:(NSString *)kUTTypeMovie, nil];

    [self presentModalViewController:picker animated:YES];
}

-(void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{

    //NSString *mediaType = [info valueForKey:UIImagePickerControllerMediaType];
    //[mediaType isEqualToString:@"public.movie"];
    //{
        NSURL *videoURL = [info objectForKey:UIImagePickerControllerMediaURL];//used to be*videoURL
    MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:videoURL];

    [picker dismissModalViewControllerAnimated:YES];
    //[picker release];

}

-(IBAction)playMovie
{

    NSURL *videoURL = [NSURL URLWithString:@"public.movie"];
    MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL: videoURL];
    [moviePlayer prepareToPlay];
    moviePlayer.view.frame = CGRectMake(100, 100, 200, 200);
[self.view addSubview:moviePlayer.view];
    moviePlayer.shouldAutoplay = NO;
    moviePlayer.view.backgroundColor = [UIColor grayColor];

[moviePlayer play];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(moviePlayBackDidFinish:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:moviePlayer];
    //[player release];

}

-(void) moviePlayBackDidFinish:(NSNotification*)notification
{
    MPMoviePlayerController *moviePlayer = [notification object];

    [[NSNotificationCenter defaultCenter] removeObserver:self
                                                    name:MPMoviePlayerPlaybackDidFinishNotification
                                                  object:moviePlayer];
    [self dismissModalViewControllerAnimated:YES];
    //[player autorelease];
    //[player release];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    [moviePlayer release];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
    } else {
        return YES;
    }
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T10:14:26.200

问题就在这里

```
NSURL *videoURL = [info objectForKey:UIImagePickerControllerMediaURL]; 
```

尝试这个：

```
videoURL = (NSURL*)[info objectForKey:@"UIImagePickerControllerMediaURL"]; 
```

而当你播放视频时

```
NSURL *videoURL = [NSURL URLWithString:@"public.movie"];
MPMoviePlayerController *moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL: videoURL]; 
```

`moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:videoURL];`

和 movieplayer 应该是一个属性。希望能帮助到你。

# magento - 在 magento 中切换到新格式的升级脚本

> ID：14248268
> 
> 赞同：0
> 
> 时间：2013-01-09T23:21:36.013
> 
> 标签：magento

我在 magentocommerce 上托管的扩展程序的当前版本是`v1.0.0`，现在我的安装脚本名为`mysql4-install-1.0.php`. 只注意`1.0`而不注意`1.0.0`。

现在我即将发布一个小错误修复`v1.0.1`，并且还考虑切换到升级脚本的新命名法。

我应该重命名`mysql4-install-1.0.php`然后`mymodule_setup/install-1.0.0.php`添加一个新`upgrade-1.0.0-1.0.1.php`的`mymodule_setup`目录吗？

如何在不破坏旧安装的情况下进行过渡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:49:27.530

不幸的是，将您的文件重命名为 install-1.0.0.php 将再次运行该脚本。所有版本检查都是通过 php 的 version_compare() 函数运行的。这意味着 1 < 1.0 < 1.0.0。

我会让安装文件保持原样并让你的升级脚本 upgrade-1.0-1.0.1.php

通过保持安装文件不变，您现在拥有以下文件并且没有重新运行文件：

```
mysql4-install-1.0.php
upgrade-1.0-1.0.1.php

(and in the future):
upgrade-1.0.1-1.0.2.php 
```

如果它们正在当前实例上工作，则没有真正的理由返回并重命名任何安装文件或以任何方式调整它们。

当所有其他方法都失败时，请参考代码库以找出正在发生的事情。查看文件：/app/code/core/Mage/Core/Model/Resource/Setup.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:07:28.947

我认为您是否重命名文件并不重要。如果重命名它并且商店在 1.0(.0) 上运行，则安装脚本不会运行，如果尚未安装，它将运行。两者都可以。

install-1.0.0 和 install-1.0 不一样，但如果安装了扩展，它不会运行第二个安装脚本；-)

如果更改旧文件的名称，则必须添加两个升级脚本：

```
upgrade-1.0-1.0.1.php 
```

和

```
upgrade-1.0.0-1.0.1.php 
```

我不确定，但这是我期望的方式。

# kernel - 内核、glibc 和用户空间

> ID：14248269
> 
> 赞同：2
> 
> 时间：2013-01-09T23:21:37.533
> 
> 标签：kernel, debian, glibc

我的目标是使用 debian（挤压）用户空间运行更新的内核 Linux 3.4。

Debian 的[KernelFaq](http://wiki.debian.org/KernelFAQ)简单地说我们从 kernel.org 获取最新的原始内核并手动配置和编译它。

但是，在[glibc 文档](http://sourceware.org/glibc/wiki/FAQ#What_version_of_the_Linux_kernel_headers_should_be_used.3F)中，它指出：

> GNU C 库在比 [编译期间] 使用的内核头文件更早的内核上运行没有问题。反过来（使用旧内核头文件编译 GNU C 库并在最近的内核上运行）不一定按预期工作。

由于内核 API 从 2.6.32 到 3.4 相当稳定，我可能只需要编译 3.4 内核就可以了；但是，我想知道这是否仍然存在潜在问题。

这样做是针对我的 Linux 3.4（或更高版本）头文件重新编译 eglibc 2.11.3-4 的更正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T06:38:37.280

> 我想知道这是否仍然存在潜在问题。

您没有引用 glibc wiki 的下一段：

> ...不一定按预期工作。例如，如果您使用旧的内核头文件来编译 GNU C 库，则不能使用新的内核功能。

换句话说，您现有的 glibc 构建（以及用户空间的其余部分）将在新内核上正常工作*，*但 glibc 可能不会使用内核提供的所有最新功能。

# twig - Silex 中 Twig 的自定义过滤器

> ID：14248270
> 
> 赞同：3
> 
> 时间：2013-01-09T23:21:38.983
> 
> 标签：twig, silex, twig-filter

我需要在 Silex 框架中为 Twig 添加自定义过滤器。例如，我想将此函数应用于某个变量：

```
public function addExclamation($text) {
    return $text.'!!!';
} 
```

在 twig-template 中执行以下操作：

```
{{ text|exclam }} 
```

阅读[http://twig.sensiolabs.org/doc/advanced.html](http://twig.sensiolabs.org/doc/advanced.html)后，我创建了“Project_Twig_Extension.php”：

```
class Project_Twig_Extension extends Twig_Extension
{
    public function getName()
    {
        return 'project';
    }

    public function getFilters()
    {
        return array(
            new Twig_SimpleFilter('exclam', 'addExclamation'),
        );
    }

    public function addExclamation($text) {
        return $text.'!!!';
    }
} 
```

但我无法理解我需要把这个文件放在哪里，以及如何在 Silex 的“index.php”中注册这个过滤器。

你能给我一步一步的指导吗？方法，在[Twig addFilter using Silex 中描述？](https://stackoverflow.com/questions/9504309/twig-addfilter-using-silex)不工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-13T06:53:13.763

您可以像这样添加自定义过滤器：

```
$app['twig'] = $app->share($app->extend('twig', function(\Twig_Environment $twig) {
    $twig->addFilter(new Twig_SimpleFilter('exclaim', function ($value) {
        return $value.'!!!';
    }));

    return $twig;
})); 
```

参考：[http ://silex.sensiolabs.org/doc/providers/twig.html#customization](http://silex.sensiolabs.org/doc/providers/twig.html#customization)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-06T17:20:15.757

作为记录，现在注册 Twig 扩展的新方法如下：

```
$app['twig'] = $app->extend('twig', function (\Twig_Environment $twig, Silex\Application $app) {
    $twig->addExtension(new My_Twig_Extension($app));

    return $twig;
}); 
```

文档[http://silex.sensiolabs.org/doc/providers/twig.html#customization](http://silex.sensiolabs.org/doc/providers/twig.html#customization)已更新。

蒂姆

# django - collectstatic 无法收集管理静态文件

> ID：14248271
> 
> 赞同：2
> 
> 时间：2013-01-09T23:21:45.770
> 
> 标签：django, django-admin, django-staticfiles

当我运行 collectstatic 并且在没有 css 的情况下提供管理页面时，我遇到了以下错误。

错误：

> IOError：[Errno 2] 没有这样的文件或目录：u'/usr/local/lib/python2.7/dist-packages/django/contrib/admin/media/img/gis/move_vertex_off.png

下面是设置。

> STATIC_ROOT = '/var/www/mysite/media/'
> 
> STATIC_URL = '/静态/'
> 
> ADMIN_MEDIA_PREFIX = '/static/admin/'

这个错误信息是什么意思？该文件确实存在于上述路径中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T18:20:44.563

我认为问题是由于某些安装错误造成的。重新安装 django 没有帮助。完全重新安装了操作系统，因为这对我来说是更快的解决方案，而且一切顺利。但对我来说，根本原因仍然是个谜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-18T09:43:13.457

默认情况下，collectstatic 在 STATICFILES_DIRS 中定义的所有位置以及 INSTALLED_APPS 设置指定的应用程序的“静态”目录中查找（参见：[https](https://docs.djangoproject.com/en/dev/howto/static-files/) ://docs.djangoproject.com/en/dev/howto/static-files/和 [https ://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/](https://docs.djangoproject.com/en/dev/ref/contrib/staticfiles/)）。

因此，如果您将管理员添加到您的 INSTALLED_APPS，这应该没问题。

ADMIN_MEDIA_PREFIX 在当前版本的 Django 中不再使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-15T03:35:23.420

我通过运行`python manage.py collectstatic`然后将以下内容添加到我的 Apache 配置中解决了这个问题：

```
Alias /static/admin/ /PATH/TO/MY/PROJECT/static_root/admin/

<Directory /PATH/TO/MY/PROJECT/static_root/admin>
Require all granted
</Directory> 
```

# c - 提高C程序的计算速度

> ID：14248274
> 
> 赞同：1
> 
> 时间：2013-01-09T23:22:01.573
> 
> 标签：c

我有以下问题：

给定 2 个包含 N 个数字的文件，例如

file1.dat: 1,2,3,4,5,6,7,8,9,0

file2.dat: 2,5,4,7,6,9,8,1,0,3

我想知道第一个文件中两个连续数字的顺序在第二个文件中改变了多少次（包含相同的数字）。例如，在文件一中我们开始寻找 1 和 2，在第二个文件中，2 在 1 之前，所以顺序发生了变化；在第一个文件中有 9 然后是 0，在第二个文件中保持这个顺序。

我写了以下程序：

```
#include <stdio.h>
#include <stdlib.h>
#define N 32421

int main () {
  int A[N], B[N];
  int i,j,k=0,count=0;
  FILE *fp;

  if ((fp = fopen ("file1.dat", "r")) == NULL) {
    printf ("Error opening file 1\n");
    exit (EXIT_FAILURE);
  }
  for (i = 0; i < N; i++)
    fscanf (fp, "%d", &A[i]);
  fclose (fp);

  if ((fp = fopen ("file2.dat", "r")) == NULL) {
    printf ("Error opening file 2\n");
    exit (EXIT_FAILURE);
  }
  for (i = 0; i < N; i++)
    fscanf (fp, "%d", &B[i]);
  fclose (fp);

  for(i=0; i<N-1; i++)
    for(j=0; j<N; j++)
      for(k=0 ; k<N; k++)
        if(B[j]==A[i] && B[k]==A[i+1] && k < j )
    count++;

  printf("The number of inversion is: %d\n",count);

  return 0;
} 
```

从程序的第 3 行可以看出，我正在处理的文件非常大（每个文件有 32421 个数字），所以花费的时间太大了。有人对提高计算速度有什么建议吗？

* * *

我还尝试通过以下方式在循环中添加中断：

```
 int a;  

  for(i=0;i<N-1;i++){ 
    a=0;
    for(j=0;j<N;j++){
      for(k=0;k<N;k++){
    if(A[i]==B[j] && A[i+1]==B[k] && k<j) {
      count++;
      break;
      a=1;
    } if(A[i]==B[j] && A[i+1]==B[k] && j<k){
      break;
      a=1;
    }
      }
      if(a==1){
      break;
      }
    }
  } 
```

但是仍然需要5个多小时。我怎样才能加快速度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:29:50.313

```
for(i=0; i<N-1; i++) {
    //looking for the position of B[i] in A
    j=-1;
    while ( A[++j] != B[i] ) {}

    //now A[j] is B[i]

    for (k= 0 ; k < j; k++) {
        //is the next in B in a previous position in A ?
        if (B[i+1] == A[k]) {
            count++;
            break;
        }
    }
} 
```

而且，这是另一个解决方案

```
int pos1, pos2;
for(i=0; i<N-1; i++) {
    pos2=-1;
    for(j=-1; j<N && pos1 != -1 && pos2 != -1; j++) { //will stop if both are found
       if (pos1 == -1 && B[i]==A[j]) pos1 = j; //found the position of a num
       if (B[i+1]==A[j]) pos2 = j; //found the position of the next num
       if (pos2 < pos1) {
          count++;
       }
    }
    pos1 = pos2; //useful for next loop..
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:47:09.880

这里的关键是“第一个文件中的两个*连续*数字”。

无需执行 O(N^2) 循环。事实上，您可以使用利用以下标准的动态编程方法：

*   数字不同

*   对于任何一组`N`数字，数值都是`0..N-1`（这是我的假设）

*   对于任何两个连续的数字`A`，并且在第一个文件中，如果您在遇到时`B`已经遇到过，则顺序将保留在第二个文件中。`A``B`

请注意我对价值观的假设。如果该假设是错误的，那么您也可以使用当前被接受的 O(N^2)-ish 答案（尽管您可以构建一棵树来索引值并且最坏的情况变成 O(N.log(N) ）。

如果你可以直接索引这些值，那么这个问题就变成了线性的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:57:23.703

两个长度为 N 的数组之间的反转次数是...

如果 N 为 1，则反转次数为 0
，否则为第一个数组和第二个数组的最后 N-1 个元素之间的反转次数，不包括第一个数组的第一个元素加上第一个元素的位置第二个数组中的第一个数组

递归万岁:)

```
#include <stdlib.h>
#include <string.h>

static int find(int a, int *b, size_t n) {
  size_t k = 0;
  while (k < n) {
    if (b[k] == a) return k;
    k++;
  }
  return -1;
}

int ninversions(int *a, int *b, size_t n) {
  if (n == 1) return 0;
  size_t pos = find(*a, b, n);
  if (pos == (size_t)-1) exit(EXIT_FAILURE);
  int *newb = malloc((n - 1) * sizeof *newb);
  memcpy(newb, b, pos * sizeof *b);
  memcpy(newb + pos, b + pos + 1, (n - pos - 1) * sizeof *b);
  int retval = pos + ninversions(a + 1, newb, n - 1);
  free(newb);
  return retval;
} 
```

# python - Python：比较两个文件并制作一个显示差异的新文件时遇到问题

> ID：14248279
> 
> 赞同：0
> 
> 时间：2013-01-09T23:22:43.640
> 
> 标签：python, comparison

我正在尝试编写查看两个文件并创建一个新文件以显示哪些行不同的程序。两个文件都有相同数量的行，并且每行都有数字 1 或 -1，例如：

```
-1
1
1
-1 
```

然而，到目前为止我所做的代码认为每一行都是不同的，并将它们全部写入新文档：

```
f1 = open("file1", "r")
f2 = open("file2", "r")

fileOne = f1.readlines()
fileTwo = f2.readlines()

f1.close()
f2.close()

outFile = open("results.txt", "w")
x = 0

for i in fileOne:
   if i != fileTwo[x]:
      outFile.write(i+" <> "+fileTwo[x])
      print i+" <> "+fileTwo[x]
   x += 1

outFile.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:25:16.387

尝试这样的事情：

```
with open("file1") as f1,open("file2") as f2:
    for x,y in zip(f1,f2):
        if x !=y :
           print " dissimilar lines " 
```

`zip()`将从两个文件中获取单独的行，然后您可以比较它们：

例子：

```
In [12]: a=[1,2,3]

In [13]: b=[4,2,6]

In [14]: for i,(x,y) in enumerate(zip(a,b)):
    if x !=y :
        print "line :{0} ==>  comparing {1} and {2}".format(i,x,y)

line :0 ==>  comparing 1 and 4
line :2 ==>  comparing 3 and 6 
```

# node.js - 使用 mongoose 插入子文档

> ID：14248281
> 
> 赞同：3
> 
> 时间：2013-01-09T23:23:03.343
> 
> 标签：node.js, mongodb, express, mongoose

> **可能重复：**
> [mongo 可以插入数据吗？](https://stackoverflow.com/questions/13588342/can-mongo-upsert-data)

我的模式定义如下：

```
var Permission = new Schema({
  _id: String,  // email address
  role: String  // "admin" or "member"
});

var Org = new Schema({
  name: {type: String, index: {unique: true, dropDups: true}, trim: true},
  permissions: [Permission]
}); 
```

我正在尝试匹配和更新子文档行（在我的情况下为“权限”，或者如果不匹配（例如 upsert）则插入新的权限行。

这是我写的：

```
exports.updatePermissions = function(req, res) {
  return Org
    .update(
      {name:"my_org", "permissions.$._id": req.body.email},
      {$set: {"permissions.$.role": req.body.role}})
    .exec(function(err) {
      // stuff
    });
}; 
```

MongoDB 似乎接受了这一点（例如没有错误），但数据库没有变化。我也在 mongo shell 中尝试了以下操作：

```
db.orgs.update({"name":"my_org", "permissions.$._id":"newuser@email.com"}, {$set: {"permissions.$.role": "member"}}); 
```

Mongo 再次接受了查询，但没有任何变化。这是我要修改的文档：

```
{
    "name" : "my_org",
    "permissions" : [
        {
            "_id" : "newuser@email.com",
            "role" : "admin"
        }
    ]
} 
```

有什么建议么？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:31:15.243

这对我[有用 $elemMatch](http://docs.mongodb.org/manual/reference/operator/elemMatch/)，还可以查看[$ 运算符的规则](http://docs.mongodb.org/manual/reference/operators/#_S_)：

```
db.orgs.update({"name":"my_org", "permissions": {$elemMatch: {_id:"newuser@email.com"}}},
     {$set: {"permissions.$.role": "member"}}); 
```

# php - MySQL 错误疑难解答 - 表单、PHP 和 MySQL

> ID：14248282
> 
> 赞同：0
> 
> 时间：2013-01-09T23:23:05.380
> 
> 标签：php, mysql, forms

有人可以解释为什么这会给我以下错误吗？

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ' )' 附近使用正确的语法

我尝试在没有 Dreamweaver 添加的所有垃圾的情况下重新创建，但我不完全了解如何提交表单并将变量传递给我的查询。Dreamweaver 的代码让我很困惑，我想不出在不破坏整个程序的情况下可以删除什么。

```
<?php require_once('Connections/hh.php'); ?>
<?php
if (!function_exists("GetSQLValueString")) {
function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") 
{
  if (PHP_VERSION < 6) {
    $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;
  }

  $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue);

  switch ($theType) {
    case "text":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;    
    case "long":
    case "int":
      $theValue = ($theValue != "") ? intval($theValue) : "NULL";
      break;
    case "double":
      $theValue = ($theValue != "") ? doubleval($theValue) : "NULL";
      break;
    case "date":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;
    case "defined":
      $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue;
      break;
  }
  return $theValue;
}
}

$editFormAction = $_SERVER['PHP_SELF'];
if (isset($_SERVER['QUERY_STRING'])) {
  $editFormAction .= "?" . htmlentities($_SERVER['QUERY_STRING']);
}

if ((isset($_POST["MM_insert"])) && ($_POST["MM_insert"] == "form1")) {
  $insertSQL = sprintf("INSERT INTO data_customer (first_name, last_name) VALUES (%s, %s)",
                       GetSQLValueString($_POST['first_name'], "text"),
                       GetSQLValueString($_POST['last_name'], "text"));

  mysql_select_db($database_hh, $hh);
  $Result1 = mysql_query($insertSQL, $hh) or die(mysql_error());

$cid = mysqli_insert_id();

  $insertSQL = sprintf("INSERT INTO data_phone_number (phone_number) VALUES (%s)",
                       GetSQLValueString($_POST['phone_number'], "text"));

  mysql_select_db($database_hh, $hh);
  $Result1 = mysql_query($insertSQL, $hh) or die(mysql_error());

$pid = mysqli_insert_id();

  $insertSQL = sprintf("INSERT INTO join_customer_phone (customer_id, phone_id) VALUES ($cid, $pid)");
  mysql_select_db($database_hh, $hh);
  $Result1 = mysql_query($insertSQL, $hh) or die(mysql_error());

}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>
</head>

<body>
<form action="<?php echo $editFormAction; ?>" method="post" name="form1" id="form1">
 <table align="center">
  <tr valign="baseline">
   <td nowrap="nowrap" align="right">First_name:</td>
   <td><input type="text" name="first_name" value="" size="32" /></td>
  </tr>
  <tr valign="baseline">
   <td nowrap="nowrap" align="right">Last_name:</td>
   <td><input type="text" name="last_name" value="" size="32" /></td>
  </tr>
  <tr valign="baseline">
   <td nowrap="nowrap" align="right">Phone_number:</td>
   <td><input type="text" name="phone_number" value="" size="32" /></td>
  </tr>
  <tr valign="baseline">
   <td nowrap="nowrap" align="right">&nbsp;</td>
   <td><input type="submit" value="Insert record" /></td>
  </tr>
 </table>
 <input type="hidden" name="MM_insert" value="form1" />
</form>
<p>&nbsp;</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:35:58.280

您正在将 mysql 函数与 mysqli 函数混合使用。坚持使用 mysqli（因为不推荐使用 mysql）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:34:07.017

你为什么不试试：

```
$insertSQL = "INSERT INTO data_customer (first_name, last_name) VALUES ('" . 
                       GetSQLValueString($_POST['first_name'], "text") . "', '" .
                       GetSQLValueString($_POST['last_name'], "text") .  "';"; 
```

如果它不起作用，请将您`%s`的 s 放在“这些”括号中。我确信您应该将值放在这些括号中。

# ios - 无法以模态方式呈现以前的视图控制器

> ID：14248285
> 
> 赞同：0
> 
> 时间：2013-01-09T23:23:30.010
> 
> 标签：ios, objective-c, uiviewcontroller

我有一个应用程序（现在无法更改架构）。

第 1 页，显示第 2 页（一个 Tabnav），带有 presentModalViewController。然后第 2 页也可以使用 presentModalViewController 呈现第 1 页（通过按钮）。

问题是当我重新呈现第 1 页时，应用程序崩溃，因为第 1 页已经呈现或什么的。我可以关闭显示第 1 页的第 2 页，但我不能采用该选项，因为还有其他页面可以模态显示，然后它们将位于堆栈下方的级别而不是 Page1。

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Application tried to present modally an active controller <AccountViewController: 0xc3824a0>.'
*** First throw call stack:
(0x1f3d012 0x1a32e7e 0xa63721 0xa64777 0xa647b7 0x908e 0x1a46705 0x97d920 0xbb9b24 0x1a46705 0x97d920 0x97d8b8 0xa3e671 0xa3ebcf 0xa3dd38 0x9ad33f 0x9ad552 0x98b3aa 0x97ccf8 0x2e48df9 0x2e48ad0 0x1eb2bf5 0x1eb2962 0x1ee3bb6 0x1ee2f44 0x1ee2e1b 0x2e477e3 0x2e47668 0x97a65c 0x258d 0x24b5 0x1)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:36:47.360

如果您想再次显示第 1 页，那么您应该关闭当前视图控制器（即第 2 页），或者您应该创建第 1 页的新实例并以模态方式呈现它。

当您已经在模态呈现的视图控制器中时，开始呈现任何东西是一个坏主意。

您应该呈现一个模态 vc，然后将其关闭。应该是这样的。

重读你的OP。说真的，扔掉结构并重新设计。你所拥有的似乎是一团糟。如果你有很多过渡，为什么不直接使用导航控制器呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:38:02.630

您将无法在模态堆栈上按`Page1`原样`Page2`进行演示。`Page1`“ `Page1`is already present”是 Xcode 的简写方式。

由于您必须继续使用模态堆栈，您可以做的就是仔细地表达它，以便在任何时候，您都可以通过呈现必要的`ViewController`OR 进入任何页面，关闭一些`ViewControllers`以“跳转”到堆栈上的特定页面。

wL_ 对[这个问题](https://stackoverflow.com/questions/4955638/dismiss-two-modal-view-controllers)的回答是一个很好的起点，可以解释如何一次关闭多个模式`ViewController`（注意选择器名称在 iOS 6 中略有变化）。当然，如果你有很多模式`ViewControllers`，你将花费相当多的内存来跟踪每个页面在堆栈中的位置。

我应该指出，这是一个相当糟糕的设计——但正如你所说，你不能改变架构，这是解决问题的一种方法。

伪代码：

```
Button pressed to jump to page:
    PageIsInStackAlready?
        Yes
           Calculate/retrieve page position in stack
           Dismiss necessary number of ViewControllers
        No
           Present new modal ViewController
           Store/account for new page's location on stack 
```

正如我所说，这可能会奏效，但它肯定会与系统作斗争。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T23:38:19.170

你了解类和实例的区别吗？如果你想展示一个 AccountViewController，你需要创建*不同*的 AccountViewController 实例并展示它。听起来您正在尝试做的是呈现已经在界面中的相同 AccountViewController 实例。显然这是不可能的。

我同意其他人的观点，即您的界面只是糟糕的设计，但至少这回答了您提出的语言问题。

# r - 显示 R 中摘要函数的所有条目？

> ID：14248290
> 
> 赞同：3
> 
> 时间：2013-01-09T23:24:02.063
> 
> 标签：r

所以我有一个非常非常大的数组。当我在其上运行摘要（var）时，我怎样才能看到比列出的更多内容，即扩展（其他）位？这是一个示例输出：

```
"            var                         "
""  "foo1        :5908364  "
""  "foot        :1419481  "
""  "foop        :1214379  "
""  "billy       : 833016  "
""  "blah blah   : 517618  "
""  "asdfasdf    :  24668  "
""  "(Other)     :  82474  " 
```

我想显示更多（如果不是全部）捆绑在（其他）下的未列出项目。是否可以在 summary() 上使用选项来列出超过该数量的项目？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T23:28:33.013

我怀疑这`var`是一个数组，它看起来更有可能是`data.frame`一个`factor`列。

您正在寻找and /or的`maxsum`论点。`summary.factor``summary.data.frame`

`summary(var, maxsum = 50)`

或者你想设置什么。

您还可以`table`用来返回类似的信息（这就是幕后`summary.factor`所做的）

假设这`var`是 data.frame 中的一个因子列

```
DF <- data.frame(var = rep(letters[1:10],1:10))

summary(DF)

      var    
 j      :10  
 i      : 9  
 h      : 8  
 g      : 7  
 f      : 6  
 e      : 5  
 (Other):10  

# over estimating the number required  
summary(DF, maxsum = 20)
 var   
 a: 1  
 b: 2  
 c: 3  
 d: 4  
 e: 5  
 f: 6  
 g: 7  
 h: 8  
 i: 9  
 j:10  

 # using table
 table(DF$var)

 a  b  c  d  e  f  g  h  i  j 
 1  2  3  4  5  6  7  8  9 10 
```

# ios - 有没有办法在运行时访问另一个程序的数据？Xcode/iOS

> ID：14248294
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:24:20.820
> 
> 标签：ios, objective-c

我正在考虑为 whatsapp 做某种扩展，但我相信 Xcode 限制了我对其他应用程序的访问。甚至可能是 iOS 本身。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:28:27.363

这与 Xcode 无关。所有 3rd 方 iOS 应用程序都在自己的沙箱中运行。一个应用程序可以访问另一个应用程序数据的唯一方法是两个应用程序提前同意使用粘贴板、钥匙串或启动另一个应用程序并在 URL 上传递数据。

没有第 3 方应用程序可以访问另一个应用程序的文件。这是 iOS 的深思熟虑（并且很好）的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:31:58.297

您可以检查应用程序是否存在，如何进入

[如何检测“IAP 破解者”？](https://stackoverflow.com/questions/7465713/how-to-detect-iap-crackers)

经过

```
[[NSFileManager defaultManager] fileExistsAtPath:@"/Applications/Cydia.app"] 
```

试试这样看，也许你能找到什么。

# chef-infra - 无业游民的规定显示出自发的错误

> ID：14248295
> 
> 赞同：1
> 
> 时间：2013-01-09T23:24:23.927
> 
> 标签：chef-infra, vagrant

我有一个 Wndows 2008 R2 的 vagrant box 做一些 Chef 基本设置。如果我使用 vagrant destroy + vagrant up，它每次都有效。然而，即使我对我的存储库（食谱/食谱/属性/任何东西）没有做任何更改，流浪条款有时会向我显示错误，而有时它能够通过..谁能给我如何调试这个？

这是失败时的日志：

```
Matthew-Tings-MacBook-Pro-2:base mting923$ vagrant provision
WARNING: Could not load IOV methods. Check your GSSAPI C library for an update
WARNING: Could not load AEAD methods. Check your GSSAPI C library for an update
[Berkshelf] installing cookbooks...
[Berkshelf] Using windows (1.7.0)
[Berkshelf] Using ohai (1.0.3) at path:           '/Users/mting923/Documents/workspace/Schneider/chef-repo/cookbooks/ohai'
[Berkshelf] Installing pingdom (0.0.3) from github: 'cwjohnston/chef-pingdom' with branch: '0.0.3' over protocol: 'https'
[Berkshelf] Using powershell (1.0.8)
[Berkshelf] Using base (0.1.0) at path: '/Users/mting923/Documents/workspace/Schneider/chef-repo/cookbooks/base'
[Berkshelf] Using chef_handler (1.1.2)
[Berkshelf] Using chef-client (2.1.2)
[default] Running provisioner: Vagrant::Provisioners::ChefSolo...
C:\opscode\chef\bin\chef-solo.bat
[default] Generating chef JSON and uploading...
[default] Running chef-solo...
[2013-01-09T23:09:02+00:00] INFO: *** Chef 10.16.2 ***
[2013-01-09T23:09:25+00:00] INFO: Setting the run_list to ["recipe[base::default]"] from  JSON
[2013-01-09T23:09:25+00:00] INFO: Run List is [recipe[base::default]]
[2013-01-09T23:09:25+00:00] INFO: Run List expands to [base::default]
[2013-01-09T23:09:25+00:00] INFO: Starting Chef Run for vagrant-2008R2.nam.gad.schneider-  electric.com
[2013-01-09T23:09:25+00:00] INFO: Running start handlers
[2013-01-09T23:09:25+00:00] INFO: Start handlers complete.
[2013-01-09T23:09:25+00:00] ERROR: Running exception handlers
[2013-01-09T23:09:25+00:00] ERROR: Exception handlers complete
[2013-01-09T23:09:25+00:00] FATAL: Stacktrace dumped to C:/tmp/vagrant-chef-1/chef-stacktrace.out
[2013-01-09T23:09:25+00:00] FATAL: Chef::Exceptions::CookbookNotFound: Cookbook base not  found. If you're loading base from another cookbook, make sure you configure the dependency in your metadata
Chef never successfully completed! Any errors should be visible in the
output above. Please fix your recipes so that they properly complete. 
```

它不会一直发生..就像这一分钟我输入：vagrant provision 它工作，而另一分钟我输入相同的东西..它失败了..这是我从 vagrant VM 得到的 chef-stacktrace.out ：

```
Generated at 2013-01-09 23:09:25 +0000
Chef::Exceptions::CookbookNotFound: Cookbook base not found. If you're loading base from another cookbook, make sure you     configure the dependency in your metadata
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/cookbook/cookbook_collection.rb:38:in `block in     initialize'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/ohai-6.14.0/lib/ohai/mash.rb:77:in `yield'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/ohai-6.14.0/lib/ohai/mash.rb:77:in `default'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/ohai-6.14.0/lib/ohai/mash.rb:77:in `default'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/run_context.rb:94:in `[]'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/run_context.rb:94:in `resolve_recipe'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/run_context.rb:84:in `rescue in block in load'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/run_context.rb:76:in `block in load'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/run_context.rb:75:in `each'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/run_context.rb:75:in `load'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/client.rb:198:in `setup_run_context'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/client.rb:418:in `do_run'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/client.rb:176:in `run'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/application.rb:140:in `run_chef_client'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/application/solo.rb:224:in `block in run_application'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/application/solo.rb:216:in `loop'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/application/solo.rb:216:in `run_application'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/lib/chef/application.rb:72:in `run'
C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/bin/chef-solo:25:in `<top (required)>'
C:/opscode/chef/bin/chef-solo:19:in `load'
C:/opscode/chef/bin/chef-solo:19:in `<main>' 
```

# google-chrome - 使用 Chrome 开发者工具发出 HTTP 请求

> ID：14248296
> 
> 赞同：297
> 
> 时间：2013-01-09T23:24:26.533
> 
> 标签：google-chrome, google-chrome-devtools

有没有办法使用 Chrome 开发者工具发出 HTTP 请求而不使用像 POSTER 这样的插件？

* * *

## 回答 #1

> 赞同：312
> 
> 时间：2013-05-28T07:59:05.697

由于Chrome（和大多数其他浏览器）支持[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)，现在从 devtools 控制台发出 HTTP 请求非常容易。

**例如获取**一个 JSON 文件：

```
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then(res => res.json())
  .then(console.log)
```

或**发布**新资源：

```
fetch('https://jsonplaceholder.typicode.com/posts', {
  method: 'POST',
  body: JSON.stringify({
    title: 'foo',
    body: 'bar',
    userId: 1
  }),
  headers: {
    'Content-type': 'application/json; charset=UTF-8'
  }
})
.then(res => res.json())
.then(console.log)
```

Chrome Devtools 实际上也支持新的 async/await 语法（尽管 await 通常只能在 async 函数中使用）：

```
const response = await fetch('https://jsonplaceholder.typicode.com/posts/1')
console.log(await response.json()) 
```

*请注意，您的请求将受到[同源策略](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy)的约束，就像浏览器中的任何其他 HTTP 请求一样，因此要么避免跨域请求，要么确保服务器设置允许您的请求的 CORS 标头。*

**使用插件（旧答案）**

作为对之前发布的建议的补充，我发现 Chrome 的[Postman](https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop)插件运行良好。它允许您设置标头和 URL 参数、使用 HTTP 身份验证、保存您经常执行的请求等。

* * *

## 回答 #2

> 赞同：179
> 
> 时间：2015-04-23T19:49:49.080

如果您想编辑并重新发出您在 Chrome 开发人员工具的网络选项卡中捕获的请求：

*   右键单击`Name`请求的
*   选择`Copy > Copy as cURL`
*   粘贴到命令行（命令包括 cookie 和标头）
*   根据需要编辑请求并运行

[![在此处输入图像描述](../Images/87154f0167106ff1637466f05552927b.png)](https://i.stack.imgur.com/eMA1a.png)

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2017-01-12T00:54:27.403

我知道，旧帖子...但是将其留在这里可能会有所帮助。

[现代浏览器](http://caniuse.com/#search=fetch)现在支持[Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)。

你可以像这样使用它：

```
fetch("<url>")
    .then(data => data.json()) // could be .text() or .blob() depending on the data you are expecting
    .then(console.log); // print your data 
```

ps：它将进行所有 CORS 检查，因为它是一个改进的`XmlHttpRequest`.

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2018-09-18T13:16:42.910

扩展@dhfsk[答案](https://stackoverflow.com/questions/14248296/making-http-requests-using-chrome-developer-tools/14248427#comment75916318_16786805)

这是我的工作流程

1.  在 Chrome DevTools 中，右键单击要操作的请求 >`Copy as cURL` [![Chrome DevTools 复制为 cURL](../Images/87154f0167106ff1637466f05552927b.png)](https://i.stack.imgur.com/eMA1a.png)

2.  打开邮递员

3.  然后点击`Import`左上角`Paste Raw Text` [![邮递员从 Chrome 粘贴原始文本 cURL](../Images/ebca6def4455d3e7173a405d45d279c3.png)](https://i.stack.imgur.com/QoBaQ.png)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-01-09T23:36:12.027

如果您的网页在您的页面中有 jquery，那么您可以在 chrome 开发人员控制台上编写它：

```
$.get(
    "somepage.php",
    {paramOne : 1, paramX : 'abc'},
    function(data) {
       alert('page content: ' + data);
    }
); 
```

它的jquery方式！

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-07-05T05:54:45.097

如果您想从同一个域进行 POST，您始终可以使用开发人员工具将表单插入 DOM 并提交：

[![将表格插入文档](../Images/4b7c12c554446748adb7493c1b52e655.png)](https://i.stack.imgur.com/YCUCJ.png)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-01-01T16:52:09.107

结合上面的两个答案，我很幸运。在 Chrome 中导航到该站点，然后在 DevTools 的 Network 选项卡上找到该请求。右键单击请求并复制，但**复制为 fetch**而不是 cURL。您可以将获取代码直接粘贴到 DevTools 控制台并进行编辑，而不是使用命令行。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-10-28T13:57:01.793

要获取带有标头的请求，请使用此格式。

```
 fetch('http://example.com', {
      method: 'GET',
      headers: new Headers({
               'Content-Type': 'application/json',
               'someheader': 'headervalue'
               })
    })
    .then(res => res.json())
    .then(console.log) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-11-01T05:40:28.933

如果你在你的网站上使用 jquery，你可以在你的控制台上使用这样的东西

```
$.post(
    'dom/data-home.php',
    {
    type : "home", id : "0"
    },function(data){
        console.log(data)
    })
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-06-01T13:03:10.663

保持简单，如果您希望请求使用与您已经查看的页面相同的浏览上下文，那么在 Chrome 控制台中只需执行以下操作：

```
window.location="https://www.example.com"; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-10-10T00:07:51.597

```
$.post(
    'dom/data-home.php',
    {
    type : "home", id : "0"
    },function(data){
        console.log(data)
    })
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-06-17T23:52:22.950

# 是的，有一种方法无需任何 3rd 方扩展。

我已经构建了[**javascript-snippet**](https://github.com/ttodua/Tamper-Request-Javascript-Tool)（您可以将其添加**为 browser-bookmark**），然后在任何站点上激活以监控和修改请求。：

[![在此处输入图像描述](../Images/9a83d4be3f8717d8e9c24c2299bb6ac0.png)](https://i.stack.imgur.com/eQM9P.png)

如需进一步说明，请查看 github 页面。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-06T14:25:53.457

您可以在 Firefox 的 Inspector 中编辑/重新发送请求，而无需使用任何第三方，如下所示：

1.  按下`F12`以在 Firefox 中打开检查器 ▶ 转到“网络”选项卡
2.  找到您的 API 请求并单击它，“标题”部分将出现在右侧（您可以在顶部的栏中进行过滤）
3.  “标题”选项卡带有一个`Resend`按钮，您可以在此处重新发送或编辑并重新发送

[截屏](https://i.stack.imgur.com/Zv5DM.png)

# r - rExcel getarraytovba 大小限制

> ID：14248299
> 
> 赞同：0
> 
> 时间：2013-01-09T23:24:30.667
> 
> 标签：r, rexcel

我有一些 R 代码返回一个 12 列宽、超过 1M 行的矩阵。当我尝试使用 getarraytovba 将该矩阵返回到 VBA 变体时，它失败了。当我说它失败时，我的意思是它运行代码而不产生任何错误，但 VBA 变量将为空。如果我将 R 矩阵缩小到 5000 行以下，那么 VBA 将捕获该变量。如果它在 5000 到 20000 之间（球场），那么有时它会起作用，有时它不会。我的系统有 16GB 的内存，当我试图将数据移动到 VBA 时，它的利用率只有 40%。内存使用似乎没有改变，因为我在运行代码时打开了任务管理器。

我已经用谷歌搜索了这个主题，我发现的唯一答案是它受到物理内存的限制，但由于我有近 10GB 的可用内存，我认为它不仅仅如此。谁能帮我解释一下为什么 getarraytovba 如此受限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T16:27:51.923

我在VBA中写了以下内容来解决这个缺点......

```
Public Function returnresults()
Dim lResultsize As Long
Dim sBigblock As Variant
Dim lLow As Long
Dim lHigh As Long
Dim vTemp As Variant
Dim i As Long
Dim j As Long
Dim lBigrow As Long
Dim lFullresults As Long
rinterface.RRun "abc<-length(vbaget[,1])"
lFullresults = rinterface.GetRExpressionValueToVBA("abc")
lResultsize = lFullresults
If lResultsize > 1048575 Then
MsgBox "Results exceed 1,048,575 rows.  Excess will be dropped."
lResultsize = 1048575
End If
sBigblock = ThisWorkbook.Sheets("results").Range("a2:m" & lResultsize + 1)
lHigh = lResultsize
lLow = 1
If lResultsize > 3000 Then lHigh = 3000

lBigrow = 1
Do While lHigh <= lResultsize And lLow < lHigh
    rinterface.RRun "temp<-vbaget[" & lLow & ":" & lHigh & ",]"
    vTemp = rinterface.GetArrayToVBA("temp")
        For i = 0 To UBound(vTemp, 1)
            For j = 1 To 13 'This is number of columns in array it could be dynamic
                sBigblock(lBigrow, j) = vTemp(i, j - 1)
            Next j
            lBigrow = lBigrow + 1
        Next i
    lLow = lHigh + 1
    lHigh = lLow + 2999
    If lHigh > lResultsize Then lHigh = lResultsize
Loop

ThisWorkbook.Sheets("results").Range("a2:m" & lResultsize + 1) = sBigblock
End Function 
```

# c++ - Microsoft Threads，设置安全和访问权限

> ID：14248300
> 
> 赞同：0
> 
> 时间：2013-01-09T23:24:37.470
> 
> 标签：c++, c, windows, multithreading

我正在尝试制作一个基本的线程管理器。您可能已经看到了我之前提出的一些错误代码的问题之一，而我仍在处理该代码！但是我被卡住了，因为我希望能够调用函数 GetExitCodeThread(HANDLE, LPDWORD)，但是我在实现这个时遇到了麻烦。我遇到的第一个问题我想我知道我需要做什么，但我不知道如何实现它。我最初是在安全属性设置为 NULL 的情况下调用 CreateThread，从外观上看，我需要将其设置为 THREAD_QUERY_INFORMATION，但是我不知道如何填充它想要的 LPSECURITY_ATTRIBUTES 结构。msdn的结构是：

```
typedef struct _SECURITY_ATTRIBUTES {
  DWORD  nLength;
  LPVOID lpSecurityDescriptor;
  BOOL   bInheritHandle;
} SECURITY_ATTRIBUTES, *PSECURITY_ATTRIBUTES, *LPSECURITY_ATTRIBUTES; 
```

但我不知道如何用 THREAD_QUERY_INFORMATION 填充它，而且我不明白我用什么填充结构的其他部分。

我想如果我设置创建线程的安全属性，我应该能够调用 GetExitCodeThread，然后我的代码应该可以工作......有没有人有任何示例代码在创建线程时设置安全属性，我可以查看和参考了？以及关于更好地理解 Windows 库的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:12:32.967

该`lpThreadAttributes`参数确定句柄是否可继承以及在线程对象上设置了哪些安全权限。它不会影响授予返回的句柄的安全访问权限`CreateThread`，始终是`THREAD_ALL_ACCESS`.

同样，当新线程本身调用时返回的句柄`GetCurrentThread`始终具有完全访问权限，但不支持旧版本的 Windows 除外。

如果您`OpenThread`稍后要使用来获取额外的句柄，或者如果外部进程试图使用`OpenThread`来获取句柄，那么线程安全权限就会发挥作用。

在受支持的 Windows 版本上，线程对象的默认安全权限（几乎？）总是合适的，所以要么`lpThreadAttributes`或`lpSecurityDescriptor`应该是`NULL`. 处理加密、身份验证或其他特别敏感任务的软件可能在极少数情况下使用非默认线程安全权限。（我想不出这有什么有用的目的，但可能有一些奇怪的情况是合适的。）

在旧版本的 Windows 上，可能需要指定`lpSecurityDescriptor`线程调用`CreateThread`是否正在模拟另一个用户，尽管推荐的做法是在调用之前停止模拟`CreateThread`。

这在[MSDN 文档中`CreateThread`](http://msdn.microsoft.com/en-us/library/ms682453%28v=VS.85%29.aspx)有详细说明。

# c# - c# 如何在 c# 的组合框中显示名称和插入值（名称的 ID）

> ID：14248303
> 
> 赞同：4
> 
> 时间：2013-01-09T23:24:43.740
> 
> 标签：c#, winforms, combobox

提前谢谢你们。我是 c# Windows Forms 的新用户。

我有一个带有 id 和 name 的表

```
身份证 | 姓名
---------------
1 | 狮子
2 | 老虎
3 | 鳄鱼

```

如果我想从表格显示到组合框，我确实喜欢这样。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace Insert_update_delete_nr2
{
    public partial class Form1 : Form
    {
        SqlConnection con = new SqlConnection(@"CONNECTION_STRING");

        SqlCommand cmd = new SqlCommand();
        SqlDataReader dr;
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click_1(object sender, EventArgs e)
        {

                con.Open();

                string query = "select * from info";
                SqlCommand cmd = new SqlCommand(query, con);
                cmd.CommandType = CommandType.Text;
                dr = cmd.ExecuteReader();

                while (dr.Read())//while true
                {

                    comboBox1.Items.Add(dr[0].ToString());//loading values into combo
                }

                cmd.CommandText = "insert into info3 (name, name_id) values ('"+textBox1.Text+"', '" + comboBox1.Items.Add(dr[0].ToString()) + "')";
                cmd.ExecuteNonQuery();

                cmd.Clone();
                con.Close();

        }

        private void loadlist()
        {
            listBox1.Items.Clear();
            listBox2.Items.Clear();
            listBox3.Items.Clear();
            con.Open();

            cmd.CommandText = "select * from info3";
             dr = cmd.ExecuteReader();
            if (dr.HasRows)
            {
                while (dr.Read())
                {
                    listBox1.Items.Add(dr[0].ToString());
                    listBox2.Items.Add(dr[1]).ToString();
                    listBox3.Items.Add(dr[3].ToString());

                }
            }
            con.Close();

        }

        private void Form1_Load(object sender, EventArgs e)
    {

       // con.Open();
        FillDropDownList(string SQL, ComboBox comboBox1);// This giving me error.
        // How should I call this FillDropDownlist function? The parameters which are they?
        cmd.Connection = con;
        listBox3.Visible = false;

        loadlist();

    }

    }
} 
```

它正在尝试插入组合框中显示的名称，而不是 id。

在 PHP 中，它将如下所示：

```
$sql =  " SELECT * FROM info ";
$res = mysql_query($sql);
while ($row = mysql_fetch_array($res)) {
    print '<option value="'.$row['id'].'">'.$row['name'].'</option>';
} 
```

这将插入 id 并显示名称。但是我应该在c#中怎么做？再次感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:39:49.420

您可以添加自定义类型，而不是将名称字符串添加到组合框：

```
class Animal
{
    public int ID { get; set; }
    public string Name { get; set; }

    public override string ToString()
    {
        return Name;
    }
} 
```

为每个条目创建一个该类型的对象 ( `var animal = new Animal { ID = (int)dr[0], Name = (string)dr[1] };`)，将该对象添加到组合框中。然后，当您去检索它时，只需将项目转换为 Animal 类型并获取 ID。

```
var animal = (Animal)comboBox1.SelectedItem; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T23:50:14.950

如果我正确理解您的问题，这应该可以满足您的要求：

用这样的东西加载你的组合框（我现在无法测试这个，所以我可能犯了一些错字或轻微的语法错误）：

*** *更新：好的。那是我最后一次在匆忙中尝试“在旅途中”回答问题。我的原始代码充满了问题和愚蠢的错别字。我真诚的道歉！以下代码包含您尝试执行的所有操作的一个非常基本的版本。您可能需要对其进行调整以满足您的需求。

一些建议：

A. 如图所示，将您的连接和命令放在 using 块中。

B. 不要在代码中硬编码连接字符串，而是使用解决方案资源管理器中的 Properties.Settings 设计器（位于左侧）并为连接字符串创建中心引用。然后在代码中引用它，如图所示。

以下执行您尝试实现的基本功能，并在我的机器上运行：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        button1.Click += new EventHandler(button1_Click);
        this.FillDropDownList();
    }

    void button1_Click(object sender, EventArgs e)
    {
        this.SaveComboBoxContent();
    }

    public void FillDropDownList()
    {
        string SQL = "SELECT id, name FROM info ORDER BY name";

        DataTable dt = new DataTable();

        // Set the connection string in the Solutions Explorer/Properties/Settings object (double-click)
        using (var cn = new SqlConnection(Properties.Settings.Default.MyConnectionString))
        {
            using(var cmd = new SqlCommand(SQL, cn))
            {
                cn.Open();

                try
                {
                    dt.Load(cmd.ExecuteReader());
                }
                catch (SqlException e)
                {
                    // Do some logging or something. 
                    MessageBox.Show("There was an error accessing your data. DETAIL: " + e.ToString());
                }
            }
        }

        // UPDATED - The .ValueMember and .DisplayMember properties 
        // refer to the string name of the field (oops!):
        comboBox1.DataSource = dt;
        comboBox1.ValueMember = "id";
        comboBox1.DisplayMember = "name";
    }

    public void SaveComboBoxContent()
    {
        string SQL = "INSERT INTO info2 (name_id) VALUES (@name_id)";

        using (var cn = new SqlConnection(Properties.Settings.Default.MyConnectionString))
        {
            using(var cmd = new SqlCommand(SQL, cn))
            {
                cmd.Parameters.AddWithValue("@name_id", comboBox1.SelectedValue);
                cn.Open();

                try
                {
                    cmd.ExecuteNonQuery();
                }
                catch (SqlException e)
                {
                    // Do some logging or something. 
                    MessageBox.Show("There was an error accessing your data. DETAIL: " + e.ToString());
                }
            }
        }
    }

} 
```

希望有帮助。

# php - php文件上传权限，哪个是最好的chmod？

> ID：14248312
> 
> 赞同：1
> 
> 时间：2013-01-09T23:25:25.723
> 
> 标签：php, file-permissions

我正在创建一个用户可以将图像上传到的站点，但我不确定最佳权限是什么？我打算使用 0777，但在阅读了此处的其他一些问题后，我决定这是一个非常糟糕的主意。

允许用户在不影响安全性的情况下上传文件的最佳权限值是什么？

另外，有没有办法递归地更改权限，以便同时更改子文件夹？一位用户在 php.net 上提供了注释建议使用 chmod_R 但它似乎不是一个值命令？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:26:40.240

权限应该足以让网络服务器写入它。

因此，将目录所有权更改为网络服务器用户，可能的权限甚至可以`0700`

要递归地更改权限，请使用

```
chmod -R ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:37:50.803

您可以更改目录的权限

```
find /path/ -type d -exec chmod XYZ '{}' \; 
```

和文件的权限

```
find /path/ -type f -exec chmod XYZ '{}' \; 
```

我通常将 guid 位设置为 2，以便新目录保留组所有者，并将我作为所有者，将 apache 作为组所有者。

这样，如果我需要从 shell apache 创建一个文件，就可以读取它们（有时会发生）。仅将所有权授予 apache 也是一个不错的选择。

所以我想说

```
 2750 to directories (with me owner and apache group) 
```

和

```
 640 to files 
```

# c# - XMLReader 返回“\n”而不是值

> ID：14248315
> 
> 赞同：2
> 
> 时间：2013-01-09T23:25:43.720
> 
> 标签：c#, xml, xmlreader

我有一个奇怪的问题，我真的找不到原因。它只是突然停止工作，我不知道是什么触发了它。

我`XMLReader`在 C# 中使用来读取 xml 文件。我正在从 xml 文件中读取值，如下所示：

```
if(subReader2.MoveToAttribute("X"))
    float.TryParse(reader.Value, NumberStyles.Any
           , CultureInfo.InvariantCulture, out pt.point.X); 
```

xml 包含这样的标签：

```
<Point X="0" Y="0" Easing="Linear" EaseIn="True" EaseOut="True" /> 
```

当它读取属性`X`and`Y`时，由于某种原因`reader.Value`返回`\n`。它以前有效，但现在有什么东西阻止了它。属性，*Easing*，*EaseIn*和*EaseOut*读得很好。所以我不知道为什么`X`会`Y`失败。

[完整的xml文件](http://pastebin.com/PHNXF1zh)

[完整的解析功能](http://pastebin.com/tnzGWHxd)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:47:39.163

当你有的时候`read.Value`，不应该`subReader2.Value`吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T23:55:08.177

这里的问题是您指向`subReader2`X 属性，然后从`reader`. 您是否有理由为每个循环使用单独的阅读器？

# java - 找到遍历图中所有顶点的路线的更好算法是什么？

> ID：14248317
> 
> 赞同：9
> 
> 时间：2013-01-09T23:25:52.113
> 
> 标签：java, c++, algorithm

所以我有以下问题：

> 给定一个 x x y 维度的网格，计算从一个角开始（比如左上角）到另一个角（右下角）结束并通过每个顶点的路径数。

所以我目前的方法只是通过尝试所有可能的路径并计算到达终点并遍历每个节点的路径来强制它。虽然它有效，但它是 O(n^2) 并且非常快地变得令人难以置信的慢。由于路径需要遍历每个顶点，我不确定如何组合地执行此操作。

我查找了更复杂的算法，并且 Hierholzer 计算欧拉路径的算法似乎有些相关但并不完美，因为为此不能多次遍历节点。

事实上，我的程序可以工作，但效果很差，我想让它更有效率。我可以使用更好的算法吗？

**编辑**感谢到目前为止的答案。澄清一下，二维网格中的所有节点都通过 n/e/s/w 连接

此外，网格不必是正方形

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:33:01.170

你无能为力，因为它是[哈密顿路径问题](http://en.wikipedia.org/wiki/Hamiltonian_path_problem)，它是 NP 完全的。

但是，您实际上*可能会*搜索其他内容并为您尝试解决的问题添加一些限制......

### 编辑：

正如@JanDvorak 所指出的，*您的具体限制*是您使用的是方形网格。到目前为止我的发现：

如果`x`是偶数，则无法遍历从左上角开始到右下角结束的所有顶点。证明：

让我们计算沿轴的*定向*`-1`运动，例如向上是，向下是`1`，向左是`-1`，向右`-1`。因此，有 x x x 网格，您的总移动量将是`2*x`. 在每个顶点（除了最后一个！）您只选择一个方向。因此，如果您需要通过偶数个顶点，那么您的总运动将是偶数，反之亦然。如果`x`是偶数，则顶点数为奇数，但总运动仍然是偶数=>您找不到任何方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:51:16.367

这个学期我在一个主题上处理过这样的问题。我想你可以看看我们这样的元启发式算法：

*   [禁忌搜索](http://en.wikipedia.org/wiki/Tabu_search)
*   [进化计算](http://en.wikipedia.org/wiki/Evolutionary_computation)

不过，除非您真的需要改进，否则您可能希望继续使用蛮力；因为它们相当复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:10:01.710

首先，如果 x 是偶数，则有一个简单的奇偶校验参数表明答案始终为零；检查网格并注意左上角和右下角的正方形颜色相同，并且不能同时访问第一个和第 n ²个颜色，因为 n ²是偶数而 1 是奇数。

如果 x 是奇数，我不知道如何计算路径，但请注意总数至少呈指数快速增长：n*n 网格的任何遍历都可以提升为 (n+2) 的两个不同遍历*(n+2) 个网格。沿着第一行向右，沿着第二行向左，沿着第一列向下，沿着第二列向上，然后在剩余的方格上进行 n*n 网格遍历，您可以得到一个；您可以通过以相反的顺序覆盖前两行和列来获得另一个。

这应该告诉您，蛮力解决方案不太可能很好地工作。

# php - JavaScript 中的 PHP 值

> ID：14248318
> 
> 赞同：0
> 
> 时间：2013-01-09T23:25:57.760
> 
> 标签：php, javascript, jquery

以下代码工作正常，该函数`load()`将选定的单选按钮信息发送到 PHP 页面并显示返回：

```
<head>
<script>
  $(document).ready(function(){
    $('#myButtons input:radio').change(function() {
      var buttonValue = $("#myButtons input:radio:checked").val();
        $("#myDiv").load('myPHPfile.php', {selectedButtonValue : buttonValue});
    });
  });
</script>
</head>

<body>
  <div id="myButtons">
    <input type="radio" name="category" value="10" />ButtonA 
    <input type="radio" name="category" value="20" />ButtonB
    <input type="radio" name="category" value="30" />ButtonC
  </div>
  <div id="myDiv">Click the button to load results</div>
</body> 
```

我的PHP文件.php

```
<?php 
  if( $_REQUEST["selectedButtonValue"] )
  {
     $buttonPHP = $_REQUEST['selectedButtonValue'];
     echo "Value button is ". $buttonPHP;
  }
?> 
```

我需要在脚本内返回 PHP 值的警告框消息，如下所示：

```
;

  $("#myDiv").load('myPHPfile.php', {selectedButtonValue : buttonValue});
  alert(<?php $buttonPHP ?>);

; 
```

是否可以在 JavaScript 中编写 PHP 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:28:59.303

是的，几乎拥有它：

```
alert('<?php echo $buttonPHP; ?>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:54:00.390

您可以在 中添加一个回调函数`.load()`，如下所示：

```
$("#myDiv").load('myPHPfile.php', 
    {selectedButtonValue : buttonValue}, 
    function(data){
        alert(data);
}); 
```

如果您只想`$buttonPHP`在警报中显示 的值，请将您的更改`echo`为

```
echo $buttonPHP; 
```

代替

```
echo "Value button is ". $buttonPHP; 
```

**注意：功能存在问题`.load()`。如果您在本地/直接访问您的 html 页面，它将不起作用，您需要将它放在服务器上。或者你可以使用 xampp、wampserver 等 **

*希望能帮助到你。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:29:18.663

您现在正在执行此操作，但您需要输出值：

```
alert(<?php echo $buttonPHP ?>); 
```

在旁注中，您似乎并不清楚发生了什么。HTML、css 和 javascript 在客户端（访问者）计算机上运行，​​PHP 代码在服务器上运行，这意味着您始终可以将 php 输出与客户端代码结合起来，这会定期完成，就像您所做的那样.

这也是 PHP 作为一门语言如此火爆的原因之一，因为它入门门槛低，很容易创建有效的代码，但维护起来很麻烦。

这不是对您的代码的评论，而是对 php.ini 的一般反映。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T23:55:49.393

要么，您必须将警报放在 PHP 生成的代码中：

```
echo "<script type=\"text/javascript\">alert('Value button is ". $buttonPHP . "');</script>"; 
```

或者你必须使用`$.get`功能：

```
$.get('myPHPfile.php', {selectedButtonValue : buttonValue}, function(data) {
    alert(data);
}); 
```

# vim - 跳转到标记命令（反引号）不起作用

> ID：14248320
> 
> 赞同：1
> 
> 时间：2013-01-09T23:26:06.967
> 
> 标签：vim

设置标记后，我无法使用 跳转到它``<mark>`，它不起作用。但是`'<mark>`有效。有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T11:44:27.347

做一个`:map<CR>`检查是否没有覆盖“`”字符（愚蠢的插件做愚蠢的事情），如果你的键盘配置正确，有时拉丁字符是一团糟，不幸的是......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-30T20:09:28.443

使用 MacVim 时，该选项`Draw marked text inline`可能是罪魁祸首。

转到设置-> 高级并确保禁用相应的复选框。

# android - 可绘制：使其适合屏幕，并且可滚动

> ID：14248321
> 
> 赞同：0
> 
> 时间：2013-01-09T23:26:09.943
> 
> 标签：android, android-layout, scrollview, drawable

我有一个要显示的可绘制对象。我希望它水平适合屏幕，并且可以垂直滚动（当它的高度大于屏幕时），同时保持缩放。

我将可绘制对象放入`ImageView`. drawable 是可变的（不同高度和宽度的图片）。我可以缩放每个可绘制对象以适应屏幕的宽度，但是当我绘制可绘制对象高于屏幕时，顶部会被切掉，并且我的`ScrollView`.

我已经尝试了我能想到的 ScrollView 和 ImageView 的所有组合，但图像要么被拉伸，要么部分脱落。任何帮助深表感谢！

我当前的代码：

```
<ScrollView 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="center" >

    <ImageView
        android:id="@+id/iv1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:scaleType="center" />

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:36:39.290

```
<ImageView
    android:id="@+id/iv1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:scaleType="centerInside"
    android:adjustViewBounds="true"
 /> 
```

但我不确定这是否能够使图像大于父高度。如果这没有帮助，我会尝试在我的存档工作解决方案中找到。

# css - 如何制作外层 固定而内部 可以使用主窗口垂直滚动条滚动

> ID：14248323
> 
> 赞同：0
> 
> 时间：2013-01-09T23:26:20.897
> 
> 标签：css, html, scrollbar

请看这个：

[http://jsfiddle.net/sS7HN/2/](http://jsfiddle.net/sS7HN/2/)

我想要实现的不是那个内部滚动条，而是使用主窗口滚动条；这样我就可以使用 windows 垂直滚动条来浏览内部的内容，`innerContent`但同时我希望外部 div ( `content`and `mainContent`) 被修复。

那可能吗？

**CSS**

```
#header {
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 50px;
}

#footer {
    position: fixed;
    left: 0;
    bottom:0;
    width: 100%;
}

#content {
    background-color:#656565;
    width: 300px;
    margin:0 auto;
    padding-top:10px;
    border-radius:5px;
}

#mainContent {
    margin:0px auto;
    background-color:#515151;
    width:250px;
    border-radius:5px;
    padding-top:20px;
}

#contentHolder {
    color:#fff;
    margin:0 auto;
    width:200px;
    height: 400px;
    background-color:#000000;
    border-radius:10px;
    overflow:auto;
} 
```

**HTML**

```
<div id="header">cfdvfvdfvfv</div>
<div id="content">
    <div id="mainContent">
        <div id="contentHolder">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam dictum imperdiet lacus in aliquet. Nam leo
            risus, bibendum vel varius non, porta vel orci. Integer scelerisque est eu augue tempus lfvdvdfvuctus.
            Aliquam erat volutpat. Phasellus vulputate dolor ligula.
        </div>
    </div>
</div>
<div id="footer"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T02:39:22.603

@Daedalus 为此在[这个与你的问题类似的问题的答案中](https://stackoverflow.com/questions/10626503/scroll-an-overflowing-div-by-scrolling-anywhere-on-the-page)写了一些 jQuery 。

jQuery 代码如下（编辑：更改它以匹配您的代码）：

```
var curScroll = 0;

$(window).bind('mousewheel DOMMouseScroll', function(e){
    var evt = window.event || e;
    var delta = evt.detail? evt.detail*(-120) : evt.wheelDelta;
    if(delta < 0) {
        //scroll down
        curScroll += 10;
    }
    else {
        //scroll up
        curScroll -= 10;
    }
    $('#contentHolder').scrollTop(curScroll);
    return true;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T07:03:58.777

正如我在上面的评论中提到的，一个[基于 CSS 的示例是可用的](https://stackoverflow.com/questions/5383394/how-to-make-inner-div-use-window-scroll-bar)。

你还想要圆角。你可以通过给内容一些额外的填充来做到这一点，然后`fixed`在它的顶部和底部添加一些页面边缘。

[修改后的样品，带圆角](http://jsfiddle.net/7pcFm/3/)

关键位有：

```
#content {
    padding: 120px 150px; /* the 120px is the overlay vert height + 10px + 10px */
}
.page_horiz_strip {
    position:fixed;
    left: 150px;
    right: 150px;
    height: 10px;
    background: white;
}
.top_rounded {
    top: 90px; /* 10px less than the overlay vert height */
    border-radius: 10px 10px 0px 0px;
}
.bottom_rounded {
    bottom: 90px; /* 10px less than the overlay vert height */
    border-radius: 0px 0px 10px 10px;
} 
```

**笔记**

*   我在内容的顶部和底部添加了一个 10px 高的条带（并将条带四舍五入）。
*   叠加垂直高度为 100px。
*   因此内容内边距需要增加到 100px + 10px + 10px。
*   因此，条带需要距离页面边缘 90 像素，而不是 100 像素。

# php - javascript 相当于数组的 php max

> ID：14248327
> 
> 赞同：0
> 
> 时间：2013-01-09T23:27:02.280
> 
> 标签：php, javascript, arrays, max

我在 php 中有一个函数，它选择包含最多元素的数组。

```
$firstArray = array('firstArray','blah','blah','blah');
$secondArray = array('secondArray','blah','blah');
$thirdArray = array('thirdArray','blah','blah','blah','blah'); 
```

然后我得到具有最高长度的变量的名称，如下所示：

`$highest = max($firstArray, $secondArray, $thirdArray)[0];`

但我正在开发一个应用程序，我想避免使用 php，我已经尝试使用 javascript`Math.max()`来实现相同的结果，但除非我这样做，否则它的工作方式不同

`Math.max(firstArray.length, secondArray.length, thirdArray.length)`

但这没用，因为我需要知道包含最多元素的数组的名称。有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:30:48.827

此函数将一个数组数组作为输入，并返回最大的一个。

```
function largestArray(arrays){
   var largest;
   for(var i = 0; i < arrays.length; i++){
       if(!largest || arrays[i].length > largest.length){
          largest = arrays[i];
       }
   }
   return largest;
} 
```

我们可以用您的示例对其进行测试：

```
firstArray = ['firstArray','blah','blah','blah'];
secondArray = ['secondArray','blah','blah'];
thirdArray = ['thirdArray','blah','blah','blah','blah'];

// should print the third array
console.log(largestArray([firstArray, secondArray, thirdArray])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:33:50.080

以下 url 有一个 max() 等效项。它支持的不仅仅是数字，就像在 php 中一样：

[js max 相当于 php](http://phpjs.org/functions/max/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:35:37.980

如果您对包含 3rd-party 库感到满意，也许[http://underscorejs.org/#max 可以满足](http://underscorejs.org/#max)您的需求：

```
var aList = [firstArray, secondArray, thirdArray];
_.max(aList, function(each) { return each.length; }); 
```

# reporting-services - SSRS 2005 IIF(IsDBNull) 的第二个值不显示

> ID：14248329
> 
> 赞同：0
> 
> 时间：2013-01-09T23:27:11.160
> 
> 标签：reporting-services

我正在从使用 Address1 作为街道地址和使用 Address2 作为邮政信箱的数据库中提取数据。在街道地址不存在的情况下，我需要显示邮政信箱。我为此使用的表达式在语法上是正确的，并且在有 Address1 的地方，我确实在我的报告中得到了街道地址。在缺少地址 1 的地方，我从来没有看到地址 2。

这是表达式：

```
=IIF(IsDBNull(First(Fields!Address1.Value, "ReportDataset")), First(Fields!Address2.Value, "ReportDataset"), First(Fields!Address1.Value, "ReportDataset")) 
```

我对此可能大错特错，但我一直在研究这样的想法，即 IsDBNull 可能总是评估为 false，因为 Address1 实际上不是 NULL，而是一个空字符串。为此，我一直在尝试修改 IsDBNull 的评估部分以接受类似 or (Fields!Address1.Value, "ReportDataset") = "" 但我似乎无法让表达式在语法上正确甚至测试该理论。

如果我的代码还有其他问题，请告诉我。

*   一直在学习...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:06:15.137

```
 =IIF(IsNothing(First(Fields!Address1.Value, "ReportDataset")) OR First(Fields!Address1.Value, "ReportDataset") = "", First(Fields!Address2.Value, "ReportDataset"), First(Fields!Address1.Value, "ReportDataset")) 
```

# css - 如何定位子菜单活动级别？

> ID：14248332
> 
> 赞同：2
> 
> 时间：2013-01-09T23:27:30.923
> 
> 标签：css, wordpress, css-selectors

[http://misha.pixelworklab.com/mercedes-sl/](http://misha.pixelworklab.com/mercedes-sl/)

您将看到当前状态下的“MERCEDES”选项卡是正确的，但我需要让子菜单具有不同的当前状态，因为它看起来很糟糕。尝试了每个选择器，但似乎缺少一些东西。谢谢！

已尝试`.current-menu-item > a`但无法获取子元素的选择器。

![在此处输入图像描述](../Images/68ce5f4dc85f4ae4a410538f60db6150.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:42:33.483

Firefox 内置的**CSS Inspector Tools**可以帮助您找到自定义`hover`活动状态外观所需的选择器。

这是用于悬停导航链接的**CSS 活动状态选择器：**

```
#megaMenu ul.megaMenu>li:hover>a span.wpmega-link-title,#megaMenu ul.megaMenu>li:hover>span.um-anchoremulator span.wpmega-link-title,#megaMenu ul.megaMenu>li>a:hover span.wpmega-link-title,#megaMenu ul.megaMenu>li>span.um-anchoremulator:hover span.wpmega-link-title,#megaMenu ul.megaMenu>li.megaHover>a span.wpmega-link-title,#megaMenu ul.megaMenu>li.megaHover>span.um-anchoremulator span.wpmega-link-title 
```

由于它是疯狂的 LoNg 和 ubber 复杂，我将解释我是如何**一步一步地**使用最新版本的 PC 上的 Firefox 获得这个选择器的：

**1.)**右键单击`MERCEDES KITS`​​导航链接并从上下文菜单中 选择**Inspect Element(Q) 。**![在此处输入图像描述](../Images/7a071d0fce060af8ddac80c82d94ba97.png)

**2.)**你会在`span`标签上。悬停会将文本颜色更改**`red`**为 CSS 样式所定义的颜色。 ![在此处输入图像描述](../Images/8b64b93f2e7be69b5ae3af7a558d5f80.png)

**3.)**单击 CSS 选择器上的下拉箭头`span`并强制它**始终**处于`:hover`状态。 ![在此处输入图像描述](../Images/9657abbfdaf8ca45365aa6f421e615a7.png)

**4.)**按下位于右下角的**样式按钮，使其处于活动状态。**激活时，该按钮变为蓝色。 ![在此处输入图像描述](../Images/60025ceecddca19950bb341171951ba1.png)

**5.)**在**CSS 规则面板**的顶部，您会看到负责制作文本的选择器`red`。 ![在此处输入图像描述](../Images/4c35472b22a350256a9a1dc9fce6b501.png)

**6.)**在同一部分中，您可以访问这些选择器的**CSS 样式表**和**行号**： ![在此处输入图像描述](../Images/2b00443c112f2128cdc493ea7d144af2.png)

**7.)**第 169 行为所有导航锚提供**`hover`活动状态外观**：

```
/* Top Level Items Title - Hover */
#megaMenu ul.megaMenu > li:hover > a span.wpmega-link-title,
#megaMenu ul.megaMenu > li:hover > span.um-anchoremulator span.wpmega-link-title,
#megaMenu ul.megaMenu > li > a:hover span.wpmega-link-title,
#megaMenu ul.megaMenu > li > span.um-anchoremulator:hover span.wpmega-link-title,
#megaMenu ul.megaMenu > li.megaHover > a span.wpmega-link-title,
#megaMenu ul.megaMenu > li.megaHover > span.um-anchoremulator span.wpmega-link-title {
  text-shadow: 0 -1px 1px #ffffff;
  color: red !important;
} 
```

**8.)**您可以直接在 Firefox **CSS 规则面板中*****动态编辑 CSS***。 示例颜色更改是使用：对于上面的**第 5 步**： **`hover`**`color: yellow !important;`** **![在此处输入图像描述](../Images/180449a438839630aaa4d20494efba47.png)****

 ******9.)**提示：查看**HTML 面板**，左下角第二个图标，**查看其他** `classname`和`id`元素。 ![在此处输入图像描述](../Images/dd80ffdd63fe07512a68109ab45d42a4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T01:02:24.907

您可以使用子菜单`ul.sub-menu`及其子选择器来定位子菜单。

`ul.sub-menu` `ul.sub-menu li` `ul.sub-menu li:first-child a` `ul.sub-menu li a` `ul.sub-menu li:last-child a`

像这样的东西。****

# google-app-engine - 谷歌云存储在文件中寻找

> ID：14248333
> 
> 赞同：4
> 
> 时间：2013-01-09T23:27:37.897
> 
> 标签：google-app-engine, google-cloud-storage

Google App Engine 网站 ( [https://developers.google.com/appengine/docs/python/googlestorage/functions#seek](https://developers.google.com/appengine/docs/python/googlestorage/functions#seek) ) 暗示能够在 Google Cloud Storage 上的文件中进行搜索。但是，在 Google Cloud Storage API 页面上没有可以搜索的迹象。

我想知道是否可以使用 API 从非 Google App Engine 服务器搜索存储在 Google Cloud Storage 上的文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-09T23:44:34.787

使用[Range](https://developers.google.com/storage/docs/reference-headers#range)标头来执行此操作。

以下将获得六个字节 10, 11, 12, 13, 14*和 15*。

```
curl -v -H "Range: bytes=10-15" http://storage.googleapis.com/pub/gsutil.tar.gz

> GET /pub/gsutil.tar.gz HTTP/1.1
> Host: storage.googleapis.com
> Accept: */*
> Range: bytes=10-15
>
HTTP/1.1 206 Partial Content
< Content-Range: bytes 10-15/1092318
< Content-Length: 6
{ [data not shown] 
```

字节从 0 到（长度 - 1）开始。所以一个 5 字节的文件包含字节 0、1、2、3 和 4。

# java - 使用 Apache Thrift 时创建带有函数的字段时出错

> ID：14248334
> 
> 赞同：0
> 
> 时间：2013-01-09T23:27:53.127
> 
> 标签：java, thrift

我开始使用 apache thrift（java 编程）并且很难找到深入解释它的文档 - 所以我希望你能帮助我。

我正在尝试创建一个服务（接口），该服务（接口）具有返回具有函数的字段的函数（例如：另一个接口）。

我试过这段代码：

```
namespace java test

service A {
  string somefunc()
}

service B {
  string somefunc2(),
  A getA()
} 
```

但我没有成功..当我尝试编译 thrift 文件时，我收到一个错误，它在服务 B 中 - A 字段未定义。

我也试过：

```
namespace java test

struct A {
  1: string somefunc()
}

service B {
  A getA()
} 
```

这次它编译成功，但它没有将 somefunc 视为函数，而是将其视为字符串类型的字段。

有没有像我想要的那样做的东西？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T10:08:10.980

Thrift 通过网络发送序列化的数据结构。没有标准的方式来发送可执行代码。各种语言允许通过网络传输代码（即`.class`文本形式的 java 文件或 python 脚本），但不能互操作，因此不被 Thrift 支持。

但是，如果您需要，thrift 可以用于服务发现。单一的 thrift 服务总是绑定在特定的主机/端口上。因此，服务发现代码的节俭定义可能如下所示：

```
namespace java test

struct Endpoint {
  1: required string host;
  2: required i32 port;
}

service A {
  string somefunc()
}

service B {
  string somefunc2(),
  Endpoint getA()
} 
```

服务发现代码可能如下所示：

```
B.Client bClient = <.....>

Endpoint endpoint = bClient.getA();
TTransport transport = new TSocket(endpoint.host, endpoint.port);
transport.open();
A.Client aClient = = new A.Client(new TBinaryProtocol(transport));
aClient.somefunc2(); 
```

如果需要，`Endpoint`可以使用协议/传输元数据扩展定义，允许在二进制/紧凑/JSON 协议和 TTransport/TFramedTransport/等之间进行选择。

# vim - 请解释 Vim 的配置目录层次结构

> ID：14248335
> 
> 赞同：33
> 
> 时间：2013-01-09T23:27:58.490
> 
> 标签：vim, vim-plugin

我正在尝试更新我的`Vim`配置脚本。我的目录中有许多子目录，`~/.vim`我不确定它们的具体功能，也不知道为什么有些子目录似乎是多余的。

这是我的`~/.vim`目录树的样子

```
 |-after
 |---ftplugin
 |---syntax
 |-autoload
 |-compiler
 |-doc
 |-ftplugin
 |---latex-suite
 |-----dictionaries
 |-----macros
 |-----packages
 |-----templates
 |---python
 |-indent
 |-plugin
 |-spell
 |-syntax 
```

现在针对具体问题。

1.  `plugin`vs 里面有什么`ftplugin`？
2.  `plugin`和 和有什么不一样`autoload`？
3.  我什么时候应该把东西放进去`after/...`而不是直接放在下面的目录中`~/.vim`？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-09T23:57:16.813

每当vim启动时都会加载任何进入`plugin`的内容，而您输入的`ftplugin`内容仅加载它对应的特定文件类型（因此，如果您有一个名为python的文件夹，则打开python文件时将加载所有文件。在`autoload`你应该中定义的脚本对应的`plugin`函数。这里的函数只有在第一次调用时才会加载。

在`after`您应该放置您想要从正常插件加载中更改的设置。举个例子，假设您喜欢一些乳胶插件为您提供的设置，但它重新定义了您在`.vimrc`. 您可以使用自动命令或将正确的定义放在后面来恢复它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-10T01:44:57.190

我认为这可以准确解释每个文件夹的作用： http: [//learnvimscriptthehardway.stevelosh.com/chapters/42.html](http://learnvimscriptthehardway.stevelosh.com/chapters/42.html)

也不妨检查一下`:h runtimepath`。

希望这可以帮助。:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-09T23:55:11.813

所有这些目录都是`runtimepath`. 尝试一下`:h runtimepath`，它会将您链接到您的答案：

1.  查看`:h write-plugin`
2.  查看`:h autoload-functions`
3.  `after/...`脚本最后执行，因此它们可以覆盖早期脚本的设置。您可以在 中阅读有关此内容的更多信息`:h runtimepath`。

# android - 保存在列表中时出现异常

> ID：14248339
> 
> 赞同：0
> 
> 时间：2013-01-09T23:28:17.460
> 
> 标签：android, list

我创建了一个名为 Placeslist 的类，当我尝试创建 Placeslist 列表并将对象保存在其中时，我得到了**Android.java.lang.NullPointerException** This is placeslist 类

```
public class Placeslist {

     @Key
     public String status;

     @Key
        public String id;
        @Key
        public String name;
        @Key
        public String reference;

        @Key
        public double lat;

        @Key
        public double lon;

     public Placeslist(String status,String id,String name,String reference,double lat,double lon) {
        // TODO Auto-generated constructor stub
            this.status=status;
            this.id=id;
            this.name=name;
            this.reference=reference;
            this.lat=lat;
            this.lon=lon;

    } 
```

这是我尝试在列表中保存对象时的代码

```
Placeslist placeslist=null;

            String data = EntityUtils.toString(response.getEntity());
            JSONObject jsonObj = new JSONObject(data);
            List<Placeslist>places=null;
            JSONArray results = jsonObj.getJSONArray("results");
            for (int i = 0; i < results.length(); i++) {
                JSONObject result = results.getJSONObject(i);

                String name = result.getString("name");
                String id = result.getString("id");
                String reference = result.getString("reference");
                JSONObject latitudes = result.getJSONObject("geometry")
                        .getJSONObject("location");
                double lon = latitudes.getDouble("lng");
                double lat = latitudes.getDouble("lat");
                placeslist=new Placeslist("OK", id, name, reference, lat, lon);
                places.add(placeslist);

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:30:32.503

因为您的列表为空。使固定：

```
List<Placeslist>places = new ArrayList<Placeslist>(); 
```

您也可以将 PlacesList 重命名为 Place，因为 PlaceList 只是列表中的一个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:30:32.660

你错过了：

```
places = new ArrayList<PlacesList>(); 
```

或者

```
places = new LinkedList<PlacesList>(); 
```

`List`是一个`interface`并且不能直接用于创建对象。应该使用子类。

# python - Fabric 使用列表变量分配主机

> ID：14248340
> 
> 赞同：0
> 
> 时间：2013-01-09T23:28:24.717
> 
> 标签：python, fabric

我知道我可以通过这样做为主机分配结构：

```
env.hosts = ['host1', 'host2'] 
```

但我可以这样做吗？

```
myList = ['host1', 'host2']
env.hosts = myList 
```

我正在使用 Boto（来自 Amazon AWS）获取“public_dns_name”列表，然后想在这些服务器上运行命令。服务器列表可以是动态的，所以我需要能够分配主机环境变量而不是静态的。任何人都可以提出解决方案吗？

```
myHosts = []
for i in myInstances:
    publicDnsAddress = i.public_dns_name
    myHosts.append(i.public_dns_name)
    print ("public dns address: " + publicDnsAddress)

print ("myHosts = " + str(myHosts))        

env.hosts=myHosts
env.user='myUser'
run("/scripts/remote_script.py") 
```

我收到此错误：

```
No hosts found. Please specify (single) host string for connection: 
```

如果主机名错误，我预计至少会出现连接错误，而不是显示找不到主机的消息。当然，我可能把这件事说错了，但话又说回来，这就是我寻求帮助的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:24:11.387

在代码中动态设置主机时，我需要使用这种`with settings`模式：

```
user = 'root'
hosts = ['server1', 'server2']

for host in hosts:
    with settings(user=user, host_string=host):
        run(whatever_my_command_is) 
```

# python - 从系列可能的故障的字典中加载熊猫数据帧？

> ID：14248346
> 
> 赞同：1
> 
> 时间：2013-01-09T23:28:33.773
> 
> 标签：python, pandas

我正在使用嵌入了 read_csv 的字典理解来构建字典。这可以很好地构建字典，但是当我将其推送到 DataFrame 中时，我的所有数据都变为 null 并且日期也变得非常古怪。这是示例代码和输出：

```
In [129]: a= {x.split(".")[0] : read_csv(x, parse_dates=True, index_col=[0])["Settle"] for x in t[:2]}

In [130]: a
Out[130]: 
{'SPH2010': Date
2010-03-19    1172.95
2010-03-18    1166.10
2010-03-17    1165.70
2010-03-16    1159.50
2010-03-15    1150.30
2010-03-12    1151.30
2010-03-11    1150.60
2010-03-10    1145.70
2010-03-09    1140.50
2010-03-08    1137.10
2010-03-05    1136.50
2010-03-04    1122.30
2010-03-03    1118.60
2010-03-02    1117.40
2010-03-01    1114.60
...
2008-04-10    1370.4
2008-04-09    1367.7
2008-04-08    1378.7
2008-04-07    1378.4
2008-04-04    1377.8
2008-04-03    1379.9
2008-04-02    1377.7
2008-04-01    1376.6
2008-03-31    1329.1
2008-03-28    1324.0
2008-03-27    1334.7
2008-03-26    1340.7
2008-03-25    1357.0
2008-03-24    1357.3
2008-03-20    1329.8
Name: Settle, Length: 495,
 'SPM2011': Date
2011-06-17    1279.4
2011-06-16    1269.0
2011-06-15    1265.4
2011-06-14    1289.9
2011-06-13    1271.6
2011-06-10    1269.2
2011-06-09    1287.4
2011-06-08    1277.0
2011-06-07    1284.8
2011-06-06    1285.0
2011-06-03    1296.3
2011-06-02    1312.4
2011-06-01    1312.1
2011-05-31    1343.9
2011-05-27    1329.9
...
2009-07-10    856.6
2009-07-09    861.2
2009-07-08    856.0
2009-07-07    861.7
2009-07-06    877.9
2009-07-02    875.8
2009-07-01    902.6
2009-06-30    900.3
2009-06-29    908.0
2009-06-26    901.1
2009-06-25    903.8
2009-06-24    885.2
2009-06-23    877.6
2009-06-22    876.0
2009-06-19    903.4
Name: Settle, Length: 497}

In [131]: DataFrame(a)
Out[131]: 
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 806 entries, 2189-09-10 03:33:28.879144 to 1924-01-20 06:06:06.621835
Data columns:
SPH2010    0  non-null values
SPM2011    0  non-null values
dtypes: float64(2) 
```

谢谢！

编辑：

我也试过用 concat 做这个，我得到了相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:14:22.873

您应该能够使用[`concat`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.tools.merge.concat.html)和[`unstack`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.unstack.html)。这是一个例子：

```
df1 = pd.Series([1, 2], name='a')
df2 = pd.Series([3, 4], index=[1, 2], name='b')
d = {'A': s1, 'B': s2} # a dict of Series

In [4]: pd.concat(d)
Out[4]: 
A  0    1
   1    2
B  1    3
   2    4

In [5]: pd.concat(d).unstack().T
Out[5]: 
    A   B
0   1 NaN
1   2   3
2 NaN   4 
```

# google-maps - 折线在 IE9 中的行为不正确

> ID：14248347
> 
> 赞同：0
> 
> 时间：2013-01-09T23:28:35.327
> 
> 标签：google-maps

我正在使用一个简单的 javascript 在地图上叠加经纬线。它在我的旧机器（IE8、Windows XP）上运行良好，但在我的新机器（Win 7 64 位上的 IE9）上，折线的线宽和透明度不正确。两种情况下的脚本都是相同的。折线定义如下：

```
var gridLines = new google.maps.Polyline({
path: gridCoords,
strokeColor: "#FF0000",
strokeOpacity: 1,
strokeWeight: 1
}); 
```

在 IE8 中，网格被正确绘制（即完全不透明和 1 像素线宽）。在 IE9 中，网格被绘制为具有 2 像素线宽的半透明。所有的线都是垂直的或水平的。

有谁知道为什么会这样？

注意我不包括脚本的其余部分，因为我怀疑这里有一个简单的问题。

# mysql - MySQL - 查询中的复杂 SUM

> ID：14248349
> 
> 赞同：1
> 
> 时间：2013-01-09T23:28:40.670
> 
> 标签：mysql, sum, subquery

这将很难解释。

我`tbl_customers`每天都会循环浏览我的客户记录数次。

```
SELECT c.* FROM tbl_customers c 
```

我只是退回客户的：`customerid`,,,,`name``phone``email`

现在奇怪的部分。我想在电子邮件之后再附加 3 列：totalpaid、totalowed、totalbalance 但是，这些列名在任何地方都不存在。

以下是我如何查询每个：（作为单个查询）

```
SELECT SUM(total) AS totalpaid 
FROM tbl_customers_bills 
WHERE customerid = X
AND billtype = 1

SELECT SUM(total) AS totalowed 
FROM tbl_customers_bills 
WHERE customerid = X
AND billtype = 2

SELECT SUM(total) AS totalbalance 
FROM tbl_customers_bills 
WHERE customerid = X
AND billtype IN(1,2) 
```

因此，这`billtype`是告诉我记录是否已支付的列。

我在这里不知所措。如何将 3 个单独的查询和到第一个查询的循环中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T23:34:29.917

只需将客户加入账单并计算总和即可。要分离出totalpaid 和totalowed，您可以使用`SUM(CASE`或`SUM(IF`如[wless1's answer所示](https://stackoverflow.com/a/14248418/119477)

```
SELECT c.*,
        SUM(CASE WHEN billtype = 1 THEN total ELSE 0 END) totalpaid ,
        SUM(CASE WHEN billtype = 2 THEN total ELSE 0 END) totalowed ,
        SUM(total) AS totalbalance
FROM 
    tbl_customers c
    LEFT JOIN tbl_customers_bills  b
    ON c.customerid = b.customerid
     and billtype in (1,2)
GROUP BY 
     c.customerid 
```

因为这是 MySQL 你只需要对客户的 PK 进行分组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:35:25.497

您可以使用 、 和 的组合来执行`GROUP`此`SUM`操作`IF`

```
SELECT c.id, c.name, c.phone, c.email, 
SUM(IF(b.billtype = 1, b.total, 0)) AS totalpaid,
SUM(IF(b.billtype = 2, b.total, 0)) AS totalowed,
SUM(IF(b.billtype = 1 OR b.billtype = 2, b.total, 0)) AS totalbalance,
FROM tbl_customers c LEFT JOIN tbl_customers_bills b ON b.customerid = c.id
GROUP BY c.id 
```

请参阅： http: [//dev.mysql.com/doc/refman/5.0/en//group-by-functions.html](http://dev.mysql.com/doc/refman/5.0/en//group-by-functions.html) http://dev.mysql.com/doc/refman/5.0/en/control-flow-函数.html

# ruby-on-rails - 来自 Heroku Rails 应用程序的零星 Redis TimeoutError

> ID：14248357
> 
> 赞同：2
> 
> 时间：2013-01-09T23:29:11.653
> 
> 标签：ruby-on-rails, heroku, azure, timeout, redis

我们正在通过连接到 Windows azure VM 的 heroku 运行 rails 应用程序，我在其中设置了一个 redis 主/从作为缓存（斜线快速参考数据存储）。问题是，我们偶尔会遇到 redis 超时。这是 10 秒的超时（我知道这超出了它的需要），并在 fork 上重新建立 redis 连接。并使用hiredis作为驱动程序。

任何人都知道为什么会发生这种情况？我知道 heroku 和 azure vm 托管在不同的海岸，所以会有一点延迟；会不会有 TCP 请求丢失？我相当没有想法。

# ruby-on-rails - 在 Apache HTTPD 上运行的 Rails 应用程序

> ID：14248358
> 
> 赞同：0
> 
> 时间：2013-01-09T23:29:16.383
> 
> 标签：ruby-on-rails, apache, centos

有没有办法在 Apache HTTPD (CentOS) 上运行 Ruby on Rails 应用程序？

这只是用 VirtualHost 设置 httpd.conf 的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:36:16.423

乘客可能是最简单的方法。这是[在 CentOS6 上安装 Passenger 的教程](http://rabblemedia.net/blog/installing-rvm-ruby-rails-and-passenger-centos-6.html/)，这里是[预构建的 rpms](http://blog.phusion.nl/2011/01/04/phusion-passenger-native-packages-for-redhatfedoracentos/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:35:34.110

[http://rubyonrails.org/deploy](http://rubyonrails.org/deploy)

检查 Rails 站点，我认为您必须使用代理，除非我误解了 HTTPD 的含义。似乎您想要一个简单的 Apache 设置，Rails 应该能够提供帮助。

编辑：詹姆斯的回答看起来很完美。和我一样，但他有真正的 CENTOS 教程……我从来没有使用过 CENTOS，只是通过 Ubuntu 完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:38:59.810

您可以运行 mod_rails aka Passenger 或 Mongrel Cluster 或 Thin Cluster。

我发现乘客最简单，你可以[在这里下载](https://www.phusionpassenger.com/)

步骤很简单

```
sudo gem install passenger
sudo passenger-install-apache2-module 
```

按照屏幕上的说明进行操作。

# javascript - jQuery 可拖动 - 如果将它应用于一个元素两次会发生什么？

> ID：14248361
> 
> 赞同：4
> 
> 时间：2013-01-09T23:29:27.960
> 
> 标签：javascript, jquery, jquery-ui-draggable

直到最近我才进行了这个设置，它被多次调用：

```
 $('.rsh')
                    .draggable('destroy')                               
                    .draggable({ blah blah details }); 
```

`destroy`那里是为了阻止多个可拖动的处理程序在类上累积。AJAX 正在创建新元素，并且`draggable`对类的初始附加不会触及随后创建的元素。

但是，当我更新到 jQuery UI 的 1.9.2 版时，它开始给我这个错误：

> 错误：在初始化之前无法调用可拖动的方法；试图调用方法“销毁”

所以我删除了破坏线，它很甜蜜。除了......我怀疑我现在可能会在类中添加越来越多的处理程序（这就是为什么`destroy`首先存在的原因）。

我试过这个，但它不喜欢它：

```
if ($('.rsh').length) {
    $('.rsh').draggable('destroy'); 
} 
```

两个问题：（1）每次我触发可拖动设置线时，是否会有越来越多的处理程序附加到类？（2）如果是这样，任何关于如何删除它们的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-09T23:41:15.140

不，不会绑定额外的处理程序。jQuery 将初始化的实例注册到元素，并且不会为同一个元素创建同一个小部件的新实例。

由于您担心处理程序，这里有一个快速检查（jQuery 1.8+ 和 UI 1.9+）：

```
$('div').draggable();
console.log( $._data($('div')[0], 'events') );
$('div').draggable();
console.log( $._data($('div')[0], 'events') ); 
```

[**小提琴**](http://jsfiddle.net/ByNuC/28/)

如您所见，在尝试在同一元素上初始化新的可拖动实例后，附加的处理程序对象不会改变。

**编辑：**尽管不会忽略带有参数的后续调用，而是它们将扩展现有小部件，如@Jason Sperske 的答案所示。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T23:55:50.390

附加到同一个对象时的后续调用以`.draggable()`扩展先前的调用（而不是像我最初想象的那样替换它们）。请参阅此示例（从 Fabrício Matté 的扩展）（[演示](http://jsfiddle.net/ByNuC/31/)）

```
<div>foo</div>
<script>
 $('div').draggable({
  start: function () {
    console.log("drag 1");
  }
 });
 console.log($._data($('div')[0], 'events'));
 $('div').draggable({
  stop: function () {
    console.log("drag 2");
  }
 });
 console.log($._data($('div')[0], 'events'));
</script> 
```

在`console.log`您只看到以下消息：

```
drag 1 <- on start
drag 2 <- on stop 
```

# bash - 如何以编程方式或通过脚本增加主机的总交换使用百分比

> ID：14248362
> 
> 赞同：1
> 
> 时间：2013-01-09T23:29:38.610
> 
> 标签：bash, swap, alarm, host, rhel5

主机是 RHEL5，我想通过运行某个进程或脚本触发的警报是 TotalSwapUsedPercent .. 有没有快速简便的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:50:07.673

这将为您提供 TotalSwapUsedPercent：

```
free -t | grep Swap | awk '{print ($3 / $2) * 100 "%"}' 
```

您可以将其放入任何监控系统或 cron 或任何您想要的。

# google-maps - 如何在 Google Maps API 中以完全相同的坐标呈现多个标记？

> ID：14248365
> 
> 赞同：2
> 
> 时间：2013-01-09T23:29:56.590
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers, pushpin, overlapping-matches

我在同一条街道上有多个地址，门牌号相同，但公寓号不同。谷歌地图地理编码服务 (v2) 并没有降低许多地址的公寓级别精度，只是为我返回了完全相同的地理编码坐标。

所以问题是，当我去展示它们时，无论你放大多少，都只会出现一个图钉。我的问题是；在完全相同的房屋地址处呈现多个图钉的好方法是什么？我已经看到 craigslist.org 如何从他们的新地图功能的图钉中创建一个螺旋，但我想知道我的其他选择是什么，因为这似乎是一种解决方法。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:39:34.357

我使用[谷歌的动态图表图标](https://developers.google.com/chart/image/docs/gallery/dynamic_icons#plain_pin)解决了这个问题，它允许您在图钉中输入一个数字，以识别在这个确切的某个点上有多个标记。基本上，您使用一些查询参数调用他们的“图表”网址，然后他们会返回您的编号图标，然后您可以将其放置/设置在您在该位置拥有的现有标记中。

```
var markerImage = createMarkerImage(numDuplicates + 1);
existingMarker.setIcon(markerImage);

function createMarkerImage(text)
{
    var pinImage = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=" + text + "|FF8985|000000",
    new google.maps.Size(21, 34),
    new google.maps.Point(0,0),
    new google.maps.Point(10, 34));
    return pinImage;
} 
```

**注意**：此解决方案使用已弃用的谷歌 API，没有发布结束日期。

> “重要提示：Google Chart Tools 的 Image Charts 部分已于 2012 年 4 月 20 日正式弃用。它将根据我们的弃用政策继续工作。”

**更新：**
我已经离开了上述解决方案，因为它已被弃用（并且对许多标记有性能影响）在编号标记的相同最终效果的 leiu 中，但使用定义标记形状的多边形的坐标路径以及a`.png`为标记阴影。我使用自己的自定义标记的唯一原因是因为我需要创建单独的标记，每个标记都有唯一的颜色（可能还有嵌入的数字），而普通标记不支持。

# c# - 远程服务器返回错误：(401) : Linked In API

> ID：14248373
> 
> 赞同：2
> 
> 时间：2013-01-09T23:30:39.437
> 
> 标签：c#, httpwebrequest, oauth-2.0, linkedin

我创建了一个小包装器来访问 Linked In API，我传递给它的参数如下：

```
[oauth_verifier, 88600]
[oauth_token, xxxx]
[oauth_version, 1.0]
[oauth_nonce, xxx]
[oauth_timestamp, xxxxx]
[oauth_signature_method, HMAC-SHA1]
[oauth_consumer_key, xxxxxx]
[oauth_consumer_secret, xxxxxx]
[oauth_signature, xxx+xxxxxxxxxxx] 
```

我得到的异常如下：“远程服务器返回错误：（401）未经授权。”

我正在尝试通过非常适合 twitter 的 Web 请求访问它，您可以查看以下代码：

```
public static OAuthTokenResponse GetAccessToken(string consumerKey, string consumerSecret, string requestToken, string verifier, string getAccessTokenUrl, string realM)
    {
        if (string.IsNullOrEmpty(consumerKey))
        {
            throw new ArgumentNullException("consumerKey");
        }

        if (string.IsNullOrEmpty(consumerSecret))
        {
            throw new ArgumentNullException("consumerSecret");
        }

        if (string.IsNullOrEmpty(requestToken))
        {
            throw new ArgumentNullException("requestToken");
        }

        WebRequestBuilder builder = new WebRequestBuilder(
            new Uri(getAccessTokenUrl),
            HTTPVerb.GET,
            new OAuthTokens { ConsumerKey = consumerKey, ConsumerSecret = consumerSecret });
        builder.Realm = realM;

        if (!string.IsNullOrEmpty(verifier))
        {
            builder.Parameters.Add("oauth_verifier", verifier);
        }

        builder.Parameters.Add("oauth_token", requestToken);

        string responseBody;

        try
        {
            HttpWebResponse webResponse = builder.ExecuteRequest();

            responseBody = new StreamReader(webResponse.GetResponseStream()).ReadToEnd();
        }
        catch (WebException wex)
        {
            throw new Exception(wex.Message, wex);
        }

        OAuthTokenResponse response = new OAuthTokenResponse();
        response.Token = Regex.Match(responseBody, @"oauth_token=([^&]+)").Groups[1].Value;
        response.TokenSecret = Regex.Match(responseBody, @"oauth_token_secret=([^&]+)").Groups[1].Value;
        response.UserId = long.Parse(Regex.Match(responseBody, @"user_id=([^&]+)").Groups[1].Value, CultureInfo.CurrentCulture);
        response.ScreenName = Regex.Match(responseBody, @"screen_name=([^&]+)").Groups[1].Value;
        return response;
    } 
```

当我点击执行请求时出现错误。

Web 请求生成器执行以下操作：

```
public HttpWebResponse ExecuteRequest()
{
        HttpWebRequest request = PrepareRequest();
  return (HttpWebResponse)request.GetResponse();
} 
```

我想我在请求中缺少一个参数，有什么想法吗？

# c++ - C++11 中的 (Di|Tri) 图

> ID：14248374
> 
> 赞同：0
> 
> 时间：2013-01-09T23:30:41.717
> 
> 标签：c++, gcc, c++11, c99, trigraphs

在阅读了 digraphs 和 trigraphs 之后，我继续测试了一个简单的程序：

```
#include <stdio.h>

int main()
{
   int a = 0;
   //??/
   ++a;
   printf("%d",a);
   return 0;
} 
```

我反射性地做到了

```
g++ -std=c++11 test.c 
```

令我惊讶的是，没有发出警告并且打印了 0 所以我继续尝试使用 C 编译器进行编译，但由于三元组，它确实发出了警告。

我的问题是为什么默认情况下会`-std=c++11`自动拉入`-trigraphs`并且不发出警告？（不使用 -Wall）某些 C++11 功能的实现是否需要它们？（非常怀疑，但值得一问）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T02:14:38.547

传递`-std=c99`具有启用三元组和禁用警告的相同效果。

它必须使三元组严格符合标准。禁用警告令人惊讶，但请注意警告是关于三元组被*忽略*的。警告可能会消失，因为`-std`未能激活`-Wtrigraphs`有关正在*使用*的三元组的单独警告 () 。

这可能应该被认为是一个错误。

# php - 如何在不使用 PEAR 和 Spreadsheet_Excel_Writer 的情况下将 PHP 导出为风格化的 CSV 或 XLS？

> ID：14248386
> 
> 赞同：0
> 
> 时间：2013-01-09T23:32:00.163
> 
> 标签：php, export, xls

我需要将 php 脚本的输出导出到 xls 或 csv 文件。输出文件必须经过格式化（字体大小、字体粗细、边框等）。

我有两个选择：

1.  内容变量作为带有 h​​tml 标签的字符串（格式化文本）
2.  准备好格式化数据的数组

我认为最简单的方法是将包含 html 代码的变量严格导出到我刚刚做的 xls 文件中。唯一的问题是当我下载 xls 文件并打开它时，Excel 会提醒我打开的文件格式与文件扩展名不同。

我的 php 脚本中的标题：

```
header("Content-Type: application/xmls.ms-excel");
header("Content-Disposition: attachment;filename=test.xls");
header("Content-Transfer-Encoding: binary"); 
```

字符集设置为 UTF-8。

我还可以将数组变量与需要放入单元格的数据一起使用，但是：

1.  我不知道如何格式化单元格（字体、边框等）
2.  我不知道如何将数据放入确切的单元格中
3.  我无法使用 PEAR 和 Spreadsheet_Excel_Writer

任何进一步的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:53:32.297

不幸的是，仅仅将 HTML 转储出去是行不通的。如果您确实*需要*格式化电子表格，CSV 不是一个选项，因为它不存储格式信息。

这只留下 XLS 作为一种文件格式，这是一种复杂的二进制格式。尝试直接导出到它是不切实际的，这就是为什么编写了一些 PHP 库来为您处理这个问题。我最近被 PHPExcel 搞砸了，[据说](https://github.com/PHPOffice/PHPExcel)这并不难使用。我对 Excel 导出器的经验是，他们确实有学习曲线。

您没有说明为什么不能使用 PEAR，但如果您根本无法使用任何外部库，那么您可能不走运。

# php - 浏览器关闭时跟踪会话注销时间

> ID：14248388
> 
> 赞同：1
> 
> 时间：2013-01-09T23:32:19.977
> 
> 标签：php, session

我正在编写一个 php 应用程序，并将用户登录和注销时间记录在一个 txt 文件中。登录是最简单的部分。我认为注销有点棘手。当通过选择注销选项手动终止用户会话时，我可以毫不犹豫地跟踪注销时间。但是当他关闭浏览器的标签或窗口时我能做什么？我想我必须使用 js 来检测那些带有 window.onbeforeunload="foobarA()" window.onunload="foobarB()" 的事件，然后触发 php 将时间跟踪到 txt 作为注销时间。但这仅检查浏览器的窗口关闭效果。如果用户关闭了我们的应用程序正在运行的选项卡，然后在没有关闭浏览器的情况下在互联网上玩或上网几个小时，我如何准确跟踪他的注销时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:41:49.080

您不能依赖卸载事件，因为 a) 并非每个浏览器都会处理它们，并且 b) 不同的浏览器对可以在其中执行的操作有不同的限制。您可以使用 websocket 并监视连接何时从服务器关闭。对于不支持 websockets 的客户端，您可以每 5 秒使用 AJAX 回发到您的脚本。当您在过去 5 秒内未收到请求时，它们已“注销”。

# android - 如何向 RadioButton 添加类似偏好的摘要？

> ID：14248391
> 
> 赞同：3
> 
> 时间：2013-01-09T23:32:24.913
> 
> 标签：android, android-widget

我想在我的 中有一个摘要[`RadioButton`](http://developer.android.com/reference/android/widget/RadioButton.html)，有点像在[`CheckBoxPreference`](http://developer.android.com/reference/android/preference/CheckBoxPreference.html).

![GPS 卫星复选框](../Images/0d893e3d3caf0b2b2eda9b2f1993374e.png)

我试图用类似这样的方法扩展`RadioButton`和覆盖该[`onDraw`](http://developer.android.com/reference/android/widget/CompoundButton.html#onDraw(android.graphics.Canvas))方法，但我坚持所有计算以使其布局良好。

```
@Override
protected void onDraw(Canvas canvas) {
  super.onDraw(canvas);
  Paint paint = new Paint();
  int textSize = 20;
  int horizontalStartPosition = getCompoundPaddingLeft() + getCompoundDrawablePadding();
  int verticalStartPosition = getBaseline() + getLineHeight();
  paint.setTextSize(textSize);
  paint.setColor(Color.GRAY);
  paint.setAntiAlias(true);
  canvas.drawText(summary, horizontalStartPosition, verticalStartPosition, paint);
} 
```

呈现如下内容：

![带有摘要的 RadioButton](../Images/d32b7b6414b33257cbcb2412c46a1a35.png)

这真的是要走的路（感觉不像）还是我应该尝试一些完全不同的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T10:35:40.863

解决方案确实是覆盖该`onDraw`方法。这就是我最终如何做到的。

在构造函数上获取摘要文本的正确样式属性。

```
public SummaryRadioButton(Context context, AttributeSet attrs) {
  super(context, attrs);
  TypedArray a = getContext().getTheme()
    .obtainStyledAttributes(
      attrs,
      new int[] { android.R.attr.textSize,
        android.R.attr.textColor },
      android.R.attr.textAppearanceSmall, 0);
  textSize = a.getDimensionPixelSize(0, 15);
  textColor = a.getColorStateList(1);
  paint = new Paint(getPaint());
  paint.setTextSize(textSize);
  a.recycle();
} 
```

在`onDraw`获取基线的行高和垂直位置并计算摘要文本的正确起点。为单选按钮的状态使用正确的文本颜色。

```
@Override
protected void onDraw(Canvas canvas) {
  super.onDraw(canvas);
  if (summary != null && summary.length() > 0) {
    int horizontalStartPosition = getCompoundPaddingLeft()
        + getCompoundDrawablePadding();
    int verticalStartPosition = getBaseline() + getLineHeight();

    paint.setColor(textColor.getColorForState(getDrawableState(), 0));
    canvas.drawText((String) summary, horizontalStartPosition,
        verticalStartPosition, paint);
  }
} 
```

在`setSummary`文本中添加一个额外的换行符。这有点老套，但我想不出更好的方法让超类正确定位文本。

```
public void setSummary(CharSequence summary) {
  if (summary != null && summary.length() > 0) {
    setText(getText() + "\n");
  } else {
    setText(getText());
  }
  if (summary == null && this.summary != null || summary != null
      && !summary.equals(this.summary)) {
    this.summary = summary;
  }
} 
```

因此，当摘要出现时，我们也需要覆盖`getText`并删除换行符。

```
@Override
@CapturedViewProperty
public CharSequence getText() {
  CharSequence text = super.getText();
  if (summary != null && summary.length() > 0) {
    text = text.subSequence(0, text.length() - 1);
  }
  return text;
} 
```

您最终会得到一个带有摘要文本的漂亮单选按钮。但是，多行文本和摘要可能存在问题。在这个意义上的改进想法是受欢迎的。

# android - 即使设备休眠或我的进程终止，如何确保 BroadcastReceiver 处理 SMS 消息？

> ID：14248397
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:33:14.623
> 
> 标签：android, runnable, onpause

[根据@CommonWare 的反馈修改我的问题]

我正在尝试为应用程序从外部 GPS 发射器（即，不是来自手机的 GPS）接收到的每条 SMS 消息插入一条记录到 SQLite 数据库中。所有 SMS 都由我的 BroadcastReceiver（“SMSReceiver”）处理，它在 Manifest 中注册，优先级为 999。如果 SMS 是由 GPS 设备发送的，BroadcastReceiver 会中止广播，如果不是，则将其传递。

在处理设备可能进入睡眠状态或我的进程可能被终止的可能性时，确保我的应用程序处理所有 SMS 的最佳方法是什么？”

[BroadcastReceiver 文档](http://developer.android.com/reference/android/content/BroadcastReceiver.html)提到“对于运行时间较长的操作，您通常将 Service 与 BroadcastReceiver 结合使用，以在整个操作期间保持包含进程的活动状态。” 这听起来像我需要的，但他们没有提供如何做到这一点的说明。任何指导，尤其是代码示例，将不胜感激。而且，就我而言，只要手机开机，“操作”就必须处于活动状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:01:39.570

您需要编写一个扩展[BroadcastReceiver](http://developer.android.com/reference/android/content/BroadcastReceiver.html)的类并将其添加到您的 AndroidManifest.xml 文件中以接收适当的 SMS 操作。

# javascript - 用于检查空表单元素的 Javascript，如果为空则拒绝提交，发送警报消息

> ID：14248398
> 
> 赞同：1
> 
> 时间：2013-01-09T23:33:16.060
> 
> 标签：javascript, forms, alert

所以我一直在查看代码，看看通过 javascript 可以实现什么。我有一个代码，当前检查表单是否有空元素，如果有空元素，则拒绝提交。问题是我尝试在元素为空时添加警报，如果元素不为空但它不起作用则添加警报。我似乎对 java 脚本知之甚少，无法对其进行编辑。

这是表格。忽略奇怪的类和 div 名称，它们是这样设置的，因为表单提交到谷歌文档电子表格。

```
<form class="quickemailform" action="https://docs.google.com/spreadsheet/formResponse?formkey=dGp3YUxCTGtWd251ZXVfOEtwc1hhWVE6MQ&amp;ifq" method="post" target="hidden_iframe" onsubmit="submitted=true;" id="ss-form" name="frm1" onsubmit="InputChecker()">
        <br>
        <div class="errorbox-good">
            <div class="ss-item ss-item-required ss-text">
                <div class="ss-form-entry">
                    <label class="ss-q-title" for="entry_0">
                    <font class="formtitles">FULL NAME:</font>
                    </br>
                    <label class="ss-q-help" for="entry_0"></label>
                    <input type="text" name="entry.0.single" value="" class="ss-q-short" id="entry_0" size="42">
                </div>
            </div>
        </div>
        <div class="errorbox-good">
            <div class="ss-item ss-item-required ss-text">
                <div class="ss-form-entry">
                    <label class="ss-q-title" for="entry_1">
                        <font class="formtitles" id="compnam">COMPANY NAME:</font>
                        </br>
                    <label class="ss-q-help" for="entry_1"></label>
                    <input type="text" name="entry.1.single" value="" class="ss-q-short" id="entry_1" size="42">
                </div>
            </div>
        </div>
        <div class="errorbox-good">
            <div class="ss-item ss-item-required ss-text">
                <div class="ss-form-entry">
                    <label class="ss-q-title" for="entry_2">
                        <font class="formtitles"  id="emailadd">EMAIL ADDRESS:</font>
                        <br>
                    <label class="ss-q-help" for="entry_2"></label>
                    <input type="text" name="entry.2.single" value="" class="ss-q-short" id="entry_2" size="42">
                </div>
            </div>
        </div>
        <div class="errorbox-good">
            <div class="ss-item ss-item-required ss-paragraph-text">
                <div class="ss-form-entry">
                    <label class="ss-q-title" for="entry_3">
                        <font class="formtitles"  id="request">Your Request:</font>
                        <font class="fineprint">( SUMMARIZE IMPORTANT DETAILS )</font>
                        <br>
                    </label>
                    <label class="ss-q-help" for="entry_3"></label>
                    <textarea name="entry.3.single" cols="32" rows="10" class="ss-q-long" id="entry_3"></textarea>
                </div>
            </div>
        </div>
            <input type="hidden" name="pageNumber" value="0">
            <input type="hidden" name="backupCache" value="">

        <div class="ss-item ss-navigate"><div class="ss-form-entry">
                <input class="submitbuttons" type="submit" name="submit" value="&nbsp;" src="" border="0" onclick="myFunction()"  />
            </div>
        </div>
    </form> 
```

如果任何字段为空，以下是拒绝提交表单的 javascript。这个代码是网上找的，不是我自己写的。它已经过测试并且可以工作，但我希望它做的不仅仅是拒绝提交。

```
<script type="text/javascript">

              (function() {
        var divs = document.getElementById('ss-form').
        getElementsByTagName('div');
        var numDivs = divs.length;
        for (var j = 0; j < numDivs; j++) {
        if (divs[j].className == 'errorbox-bad') {
        divs[j].lastChild.firstChild.lastChild.focus();
        return;
        }
        }
        for (var i = 0; i < numDivs; i++) {
        var div = divs[i];
        if (div.className == 'ss-form-entry' &&
        div.firstChild &&
        div.firstChild.className == 'ss-q-title') {
        div.lastChild.focus();
        return;
        }
        }
        })();
    </script> 
```

如果可能的话，我想知道如何在表单被拒绝或接受时添加警报。另外，如果表格被拒绝，我想拥有它，以便我有类似的东西

```
<font class="asterick" div="your_name_ast">*</font>   or   <font class="asterick" div="company_name_ast">*</font> 
```

如果表单被拒绝未提交，则让星号显示在每个空元素旁边。例如让表单检查每个元素是否为空。如果脚本发现该元素为空，则会弹出一个警报，提示“表单未填写。请查看所有带有 * 的元素。” 然后它会出现星号。

感谢读到这里的任何人。

编辑：多做一些环顾四周，似乎警报被认为是不好的做法。这是真的？有没有其他方法可以让用户知道元素是否为空？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:03:32.020

您可以使用像 EdSF 提到的 jQuery Validate （或类似的），或者您可以将提交按钮更改为常规按钮，当单击它时，它会调用一个函数来验证您的字段，如果不是空的，请提交表单。我没有测试过下面的代码，但你明白了。

```
function validateForm(){
  var isValid = true;

  var elements = document.getElementById('ss-form').getElementsByTagName('input');

  for(var i=0; i < elements.length; i++){
    if(elements[i].value.length < 1){
      isValid = false;
    }
  }

  if(isValid){
    document.getElementById('ss-form').submit();
  }
  else {
    alert('Please fill all required fields');
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:25:26.877

使用 jQuery，您可以完成您想做的所有事情。jQuery 非常容易学习。这是使用 jQuery 的代码示例：

这是您可以做的一个非常简单的示例。

```
 <!DOCTYPE html>
<html lang="en">
  <head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(function(){

$('#entry_0').blur(function()
{
var Fullname = $(this).val();
$('#nameresult').css("display","none");
if(Fullname.length>0)
    {
    $('#nameresult').css("display","inline-block");
    $('#nameresult').css("color","#00BB00");
    $('#nameresult').html("Valid")
    return true;
    }
    $('#nameresult').css("display","inline-block");
    $('#nameresult').css("color","#ff0000");
    $('#nameresult').html("Input Needed")
    $(this).focus();
    return;    
    });

$('#entry_1').blur(function()
{
var Companyname = $(this).val();
$('#companyresult').css("display","none");
if(Companyname.length>0)
    {
    $('#companyresult').css("display","inline-block");
    $('#companyresult').css("color","#00BB00");
    $('#companyresult').html("Valid")
    return true;
    }
    $('#companyresult').css("display","inline-block");
    $('#companyresult').css("color","#ff0000");
    $('#companyresult').html("Input Needed")
    $(this).focus();
    return;    
    });

  });

</script>
  </head>
  <body>
<form >
FULL NAME:<input type="text" name="entry.0.single" value="" class="ss-q-short" id="entry_0" size="42">
<div id="nameresult" style="display: none;"></div>
<br>

COMPANY NAME:<input type="text" name="entry.1.single" value="" class="ss-q-short" id="entry_1" size="42">
<div id="companyresult" style="display:none;"></div>
<br>

EMAIL ADDRESS:<input type="text" name="entry.2.single" value="" class="ss-q-short" id="entry_2" size="42"><br>

Your Request:<textarea name="entry.3.single" cols="32" rows="10" class="ss-q-long" id="entry_3"></textarea><br><br>

<input class="submitbuttons" type="submit" name="submit" value="SUBMIT" src="" border="0" />

    </form>
  </body>
</html> 
```

请原谅代码格式，我输入得很快。

这是[jQuery的链接](http://jquery.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T11:40:40.357

这是我在电子邮件加密网站上使用的工作模型：http: [//jsfiddle.net/2b6d5/46/](http://jsfiddle.net/2b6d5/46/)

随意添加，更改它...在这里发布任何分叉/更新。:)

```
/*
 * validate an e-mail address by leveraging the HTML5
 * input element with type "email"
 */

function validate() {
  var input = document.createElement('input');
  input.type='email';
  input.value=document.getElementById('valid').value;

  if (input.checkValidity()) {
    document.getElementById('address').style.background = 'green';
  } else {
    document.getElementById('address').style.background = 'red';
  }

  return false;
}

function val2(){
      var input = document.createElement('input');
  input.type='email';
  input.value=document.getElementById('valid').value;
    if (input.checkValidity()) {
    return true;
  } else {
    alert("Not a valid e-mail address");  
    return false;
}
} 
```

# grails - 在保存域对象之前修改参数

> ID：14248400
> 
> 赞同：1
> 
> 时间：2013-01-09T23:33:38.213
> 
> 标签：grails, grails-orm, grails-2.0, grails-domain-class, grails-controller

我需要一个包含`Strings`. 众所周知，GORM 无法处理这个问题，所以我已经解决了这个问题。起初我尝试在域类中使用 getter 和 setter，但这会导致问题。然后我在 Stack Overflow 上找到了一种使用`afterLoad()`和`beforeValidate()`重写属性的方法，如下所示。这很有效，让我可以将其`List`变成`String`持久性并返回到`List`应用程序中使用。

```
 class Entries {
        // persisted to database
        String _entry

        // exposed to app
        List entry

        static transients = ['entry']   //don't try to persist the List

        def afterLoad() {
                            // split the String from the database into a List
            entry = _entry?.split('\\|')
        }

        def beforeValidate() {
                            // join the List into a String for persisting
            _entry = entry.join('|')
        }

        static constraints = {
            _entry maxSize:4000
        }
    } 
```

这以编程方式工作正常。唯一的问题是 Grails 脚手架无法处理这个问题，即使我尝试输入管道分隔的字符串。我理解脚手架创建表单字段的原因`_entry`，因此`entry`在尝试保存对象时为 null。并`beforeValidate()`依赖于一个字符串列表来工作。

我试图在控制器中解决这个问题，`params.entry = params._entry`方法是在调用`new Entries(params)`. [我认识到这不是一个完美的解决方案，但这是我第一次让表单工作。] 然后我添加了一个测试`beforeValidate()`来设置`entry = _entry`if `entry`is `null`。基本上：

条目控制器.groovy：

```
params.entry = params._entry    // I added this line
def entriesInstance = new Entries(params) 
```

条目.groovy：

```
 def beforeValidate() {
        if( entry == null ) entry = _entry    // I added this line
        _entry = entry.join('|')
    } 
```

我认为这将允许我将管道分隔的字符串输入到脚手架的 Create Entries 表单中，并将*某些*内容输入数据库。

然而，令我惊讶的是，我发现两者`entry`和`_entry`都`null`在 中`beforeValidate()`，即使我打印并验证`params`了控制器中包含两个键。我不明白为什么会这样。我是如何添加新密钥以`params`导致空值到达域类的？

接下来的问题当然是，让脚手架的 Create Entries 表单接受一个管道分隔的 String 并将其放入数据库的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T04:43:13.583

> 我需要一个包含字符串列表的域类。众所周知，GORM 无法处理这个问题，所以我已经解决了这个问题。

我不同意你的看法

```
class Xyz {

static hasMany = [entries: String]

} 
```

应该创建一个单独的表来保存您的字符串列表（它实际上是一个集合）。这是[文档](http://www.grails.org/doc/latest/guide/GORM.html#5.2.1.4%20Basic%20Collection%20Types)

# objective-c - 为每个表格视图项分配一个单独的用户界面

> ID：14248404
> 
> 赞同：0
> 
> 时间：2013-01-09T23:34:13.360
> 
> 标签：objective-c, uitableview, user-interface

有人可以告诉我如何使用情节提要为表格视图元素分配界面吗？我正在制作一个医疗计算器，它对每个方程都有不同的计算器，我需要帮助制作将元素指向另一个界面的代码。这是因为对于每个方程，需要填写不同的字段（例如年龄、氧气水平、是否患有糖尿病、身高等）。并非每个方程都需要相同的字段。

我试过这样做：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // Deselect row
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    // Declare the view controller
    UIViewController *anotherVC = nil;

    // Determine the row/section on the tapped cell
    switch (indexPath.section) {
        case 0:
            switch (indexPath.row) {
                case 0: {
                    // initialize and allocate a specific view controller for section 0 row 0
                    anotherVC = [[BmiViewController alloc] init];
                    break;
                }
                case 1: {
                    // initialize and allocate a specific view controller for section 0 row 1
                   /anotherVC = [[AaOxygenGradientViewController alloc] init];
                    break;
                }
            }
            break;
    }
} 
```

但是在这样做之后，它会引用故事板文档中的原始内容（这是空的，因为我已经以编程方式创建了界面），而不是显示我的测试警报弹出窗口。

此外，是否有可能制作一堆表格视图单元格，然后让每个单元格与情节提要中的每个其他视图控制器相连接？

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:44:57.493

首先，你在跑步`deselectCellAtIndexPath`吗？这是什么原因？如果您只是想删除蓝色突出显示，那么最好更改`UITableViewCellSelectionStyle`单元格的（或类似的东西）。

我不确定您对第一部分的要求是什么，但是对于 segue 部分，是的。

在`Storyboard`设置从`tableViewController`您想要连接的其他 VC 到其他 VC 的连接中，并为它们提供所有合理的标识符。

即医学计算器Segue graphSegue userDetailsS​​egue等...

然后在您的`didSelect`方法中，您将拥有类似...

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    //some stuff...

    switch(indexPath.row) {
        case 0:
            [self performSegueWithIdentifier:@"medicalCalulatorSegue"];
            break;
        case 1:
            [self performSegueWithIdentifier:@"graphSegue"];
            break;
        case 2:
            [self performSegueWithIdentifier:@"userDetailsSegue"];
            break;
    }
} 
```

然后，这将根据选择的单元格转到每个不同的视图控制器。

不取消选择单元格的原因是，在您的方法中，`prepareForSegue`您仍然可以访问`indexPath`所选单元格的...

```
NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow]; 
```

# matlab - 如何使用 Matlab 中的 StackExchange API？

> ID：14248406
> 
> 赞同：3
> 
> 时间：2013-01-09T23:34:29.707
> 
> 标签：matlab, stackexchange-api

如何使用 Matlab 从 StackExchange API 访问数据？

天真的

```
sitedata = urlread('http://api.stackoverflow.com/1.1/questions?tagged=matlab') 
```

由于数据被压缩而失败。但是，当我将其写入文件时（使用`fprintf(fileID,'%s',sitedata)`），我得到一个无法解压缩的 zip 文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T00:20:08.060

请尝试`urlwrite()`：

```
urlwrite('http://api.stackoverflow.com/1.1/questions?tagged=matlab',...
  'tempfile.zip')
gunzip('tempfile.zip')
fid = fopen('tempfile');
str = textscan(fid,'%s',Delimiter','\n');
fclose(fid); 
```

此代码段的更好版本将用于`tempname`动态生成临时文件名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T08:49:07.893

Matlab`urlread`假设您正在获取文本数据，而不是二进制数据。`urlread`当将字符数据解码为 Unicode 值以粘贴在 Matlab`char`中时，或者当格式化输出`fprintf`函数将它们写出，将它们编码为 UTF-8 或您正在使用的任何默认字符编码时，gzip 二进制数据会被破坏和`fileID`改变字节序列，或者两者兼而有之。

IIRC，`urlread`将默认使用 ISO-8859-1 编码，这意味着字节将被转换为具有相同数值的 Unicode 代码点 - 实际上只是扩大。所以你可以通过做`sitebytes = uint8(sitedata)`. （这是常规`uint8()`转换，而不是`typecast()`。）（如果不是这种情况，您可能可以摆弄`urlread`'`CharSet`选项。）

如果您无法`urlread`通过摆弄编码和强制转换来获取正确的字节，那么您可以`HttpAgent`像这样`urlread`做一样对Java进行调用并绕过字符集解码步骤，或者摆弄它的选项。请参阅`urlread`源代码以了解如何执行此操作。

一旦您在内存中拥有正确的字节，您就可以使用较低级别的函数将它们写入文件`fwrite()`，该函数不会通过执行字符集编码来破坏它们。然后，您将获得该站点原始响应的有效 gzip 文件。（我认为如果您也`fwrite(fileID, sitedata, 'uint8')`直接在 char 字符串上使用它会起作用，但恕我直言，它更丑陋。）

您还可以使用 Java 类将其解压缩到内存中并保存到文件系统的行程。`jsitebytes = typecast(sitebytes 'int8')`将它们作为 Java 友好的有符号字节获取，然后将其粘贴到 a中`ByteArrayInputStream`并通过`GZIPInputStream`. 您需要构建一个小的 Java 帮助程序类，因为 Matlab 在`byte[]`通过引用传递缓冲区方面表现不佳`java.io`，但如果您像这样进行大量内存中的处理，这可能是值得的。

在使用 Web 服务或更高级的数据下载（例如，需要会话或证书的站点）时，我经常会在 Matlab 中直接对`HttpAgent`和类进行编码。`java.io`

# android-layout - 滚动时如何保留列表视图选择/单击的项目颜色？

> ID：14248407
> 
> 赞同：2
> 
> 时间：2013-01-09T23:34:31.613
> 
> 标签：android-layout, android-widget, android-listview

这真的是一个奇怪的问题，我遇到了几个谷歌搜索，但都是徒劳的。

好吧，我有一个列表视图，其中在用户单击项目时应更改所选项目的颜色。

这篇文章帮助我更改了列表视图所选项目的颜色。现在我可以在单击项目时更改颜色。但是，如果我滚动列表视图，颜色会跳出选择。

[https://stackoverflow.com/a/12080202/1657093](https://stackoverflow.com/a/12080202/1657093)

如果选择了一个项目，例如第一行的列表视图项目，最后一个项目也被选中，同时滚动项目颜色继续移动到我从未选择的项目。

这是列表视图

```
<ListView
     android:id="@+id/loadedlist"
     android:layout_width="match_parent"
     android:layout_height="wrap_content"
     android:layout_above="@+id/horizontalScroll"
     android:layout_alignParentLeft="true"
     android:layout_below="@+id/Title"
     android:layout_toLeftOf="@+id/sidepanel"
     android:scrollingCache="false">

    </ListView> 
```

我使用数组适配器来填充列表视图

ringlist.setAdapter(new ArrayAdapter
(this,android.R.layout.simple_list_item_1,rings));

并使用列表视图的点击方法来设置颜色，

```
ringlist.setOnItemClickListener(new OnItemClickListener() {
     @Override
    public void onItemClick(AdapterView<?> parent, View view, int pos,long id) {
        // TODO Auto-generated method stub
    try{
    String con;
        String s =  ringlist.getItemAtPosition(pos).toString();
        con = s.toLowerCase();
    String selectedFromList = con;
            int resId = getResources().getIdentifier(selectedFromList, "raw",    
            "com.example.android");

            }
    if (row != null) {
            row.setBackgroundColor(Color.BLACK);
            }

           row = view;
               view.setBackgroundColor(Color.GREEN);
                }

       }  

        }); 
```

上面的代码完成了这项工作，但是在滚动列表时出现了问题

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T06:57:02.353

这是 android 中 Listview 的常见问题。当我们在向下或向上滚动后在 Listview Item 中使用复选框/单选按钮时，所选位置确实在某些不同的地方发生了变化。到目前为止，唯一的解决方案是，我们需要在数组列表（或任何您喜欢的结构）中维护选定的位置。当您向上/向下滚动列表视图时，会调用 getview。因此，在您的 getview() 中编写代码以从 arraylist 中选择复选框项目。也不要在 getview 中为 convertview 使用 if-else 条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-13T23:17:46.797

在 onItemClick() 方法中将单击/选定的位置存储在集合或数组中。编写代码以使用存储的位置在适配器的 getview() 方法中显示单击/选定的项目。

# html - HTML：调整字体大小以适合父级

> ID：14248408
> 
> 赞同：0
> 
> 时间：2013-01-09T23:34:35.887
> 
> 标签：html, text, fonts, resize, percentage

如果文本破坏了默认参数，有没有办法调整文本的字体大小，或者有没有办法将字体设置为父级的百分比？

```
<table  border='2' width='100'>
  <tr>
    <td width='25%'>
<!-- 
        can I do something to resize 
        the font to font in the cell?
--> 
      <label font='100%'>   
      How-To-Resize-Only-Text
      </label>

    </td>
  </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:36:18.553

测量`em`单位可以应用于子元素，并根据父元素的`font-size`值进行相对测量（默认为`16px`）。

因此，如果您`font-size: 20px;`在父元素和`font-size: 0.5em;`子元素上设置，则子元素的字体大小将为父元素的 50%，即 10px。您也可以使用`em`宽度和高度。

[http://www.impressivewebs.com/understanding-em-units-css/](http://www.impressivewebs.com/understanding-em-units-css/)

# entity-framework - 实体框架 TPH 继承数据建模问题

> ID：14248410
> 
> 赞同：0
> 
> 时间：2013-01-09T23:34:39.137
> 
> 标签：entity-framework, ef-code-first

我是 Entity Framework 和 C#/.Net 的新手，正在尝试创建 TPH 继承模型，我不确定我是否应该这样做，所以如果不是，请告知，

这是模型：

```
 public abstract class Vote
 {
    public int VoteID { get; set; }
    public int UserID { get; set; }
    public bool Value { get; set; }
    public DateTime DateCreated { get; set; }

    public User User { get; set; }
 }

 public class ProjectVote_ : Vote
 {
    public int ProjectID { get; set; }
    public virtual Project Project { get; set; }
 }
 public class CommentVote_ : Vote //There are three more like this, votes for different hings
 {
    public int CommentID { get; set; }
    public virtual Comment Comment { get; set; }
 } 
```

现在的项目模型（评论和模型相似）

```
public class Project
{
    public int ProjectID { get; set; }
    public string Title { get; set; }
    public virtual ICollection<Vote> Vote { get; set; }
} 
```

发生的情况是 ICollection 创建了一个数据库列 Project_ProjectID 作为 Vote 表中的外键（我认为），而不是使用我定义的 ProjectID。我该如何修复它，或者我应该以不同的方式对其进行建模。如果 fluent API 是修复它的方法，我不知道该怎么做。

最后，我希望能够使用一张表来存储 5 种不同类型的选票。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T02:46:04.107

当您拥有相关实体时，您不需要将 FK 存储在模型中的属性。实体框架知道，当它在您的 ProjectVote_ 模型中检测到 Project 时，它需要对 ProjectVote 中的 Project 表进行 FK。与 User 和 UserId 以及 Comment 和 CommentId 相同。您不需要在模型中存储 FK 的属性。

您将获得名称为“Project_ProjectID”的 FK 列，因为实体框架检测到它需要为您的导航属性“Project”创建一个 FK。它使用自己的命名约定来创建列，因此是“Project_ProjectID”。

如果您想在 DBContext 类中为列覆盖 OnModelCreating 提供您自己的名称并添加此流畅映射。

```
protected override void OnModelCreating(ModelBuilder modelBuilder)
{
    modelBuilder.Entity<Project>()
        .HasMany(p => p.Vote)
        .HasRequired(v => v.Project) //or .WithOptional(v => v.Project)
        .Map(m => m.MapKey("ProjectId"));  //or any other name you want.
} 
```

对于将来[如何使用 Fluent API，这是一个有用的参考。](http://msdn.microsoft.com/en-US/data/jj591617) 例如，这里是一些关于如何使用 fluent 自定义 TPH 的[文档。](http://msdn.microsoft.com/en-us/data/jj591617#2.4)

希望有帮助！

# java - 强制更新 UI

> ID：14248411
> 
> 赞同：5
> 
> 时间：2013-01-09T23:34:40.563
> 
> 标签：java, javafx-2, javafx

我有一段代码用于截取 JavaFX 中的一个节点：

```
public BufferedImage getSnapshot(final Node... hideNodes) {
    Window window = getScene().getWindow();
    Bounds b = localToScene(getBoundsInLocal());
    int x = (int) Math.round(window.getX() + getScene().getX() + b.getMinX());
    int y = (int) Math.round(window.getY() + getScene().getY() + b.getMinY());
    int w = (int) Math.round(b.getWidth());
    int h = (int) Math.round(b.getHeight());
    try {
        Robot robot = new Robot();
        for(Node node : hideNodes) {
            node.setOpacity(0);
            node.getParent().requestLayout();
        }
        BufferedImage image = robot.createScreenCapture(new java.awt.Rectangle(x, y, w, h));
        for(Node node : hideNodes) {
            node.setOpacity(1);
            node.getParent().requestLayout();
        }
        return image;
    }
    catch(AWTException ex) {
        return null;
    }
} 
```

它有一个转折，那就是它应该在截屏之前隐藏给定的节点（以防它们与节点重叠，这在某些情况下是确定的。）

但是，我一直在寻找一种方法来强制重绘以在截取屏幕截图之前包含不透明度更改 - 我发现的唯一参考是 to `requestLayout()`，但那里没有乐趣。

我应该调用什么方法来强制并等待重绘完成？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T01:11:23.330

我觉得你的代码很奇怪：

1.  为什么使用`node.setOpacity(0)`使其不可见，而不是`node.setVisible(false)`？
2.  为什么返回 AWT`BufferedImage`而不是 JavaFX `Image`？
3.  为什么使用机器人捕捉屏幕而不是拍摄场景快照？
4.  为什么混合 Swing 和 JavaFX 并最终不得不担心渲染顺序？

也许这些事情有我不明白的原因，但我会这样做：

```
public Image takeSnapshot(Scene scene, final Node... hideNodes) {
  for (Node node: hideNodes) node.setVisible(false);
  Image image = scene.snapshot(null);
  for (Node node: hideNodes) node.setVisible(true);

  return image;
} 
```

我创建了一个使用上述例程的小型[示例应用程序。](https://gist.github.com/4498440)

主窗口包括一个带有圆形和矩形的组。当发出快照命令时，矩形隐藏在主节点中，拍摄主节点的快照，然后矩形再次在主节点中可见。

![基本的](../Images/55df4a71cf821a43a7e56a7393944d37.png) ![快照](../Images/9f60d54d9e1f27be974c5168309b318e.png)

* * *

要回答有关强制 UI 更新的问题的标题 - 你真的不能。JavaFX 应用程序线程和JavaFX 渲染线程将被视为两个独立的事物。您需要做的是在 JavaFX 应用程序线程上运行您的处理，将控制返回给 JavaFX 系统，等待它进行渲染，然后检查结果。该`scene.snapshot`方法将为您处理该同步，因此您无需担心。

如果由于某种原因`scene.snapshot`对您不起作用并且您想保持与原始策略类似的东西，那么您将做的是：

1.  在 JavaFX 应用程序线程上发出一些更新命令（例如，将节点不透明度设置为 0）。
2.  发出`Platform.runLater`调用并在 runLater 主体中拍摄您的机器人快照。
3.  一旦真正拍摄了快照（某些 awt 回调中的通知），发出另一个`Platform.runLater`命令以返回 JavaFX 应用程序线程。
4.  回到 JavaFX 应用程序线程，发出更多更新命令（例如，将节点不透明度设置回 1）。

这应该可以工作，因为它将允许 JavaFX 系统执行另一个脉冲，该脉冲在您的机器人实际拍摄快照之前执行屏幕的渲染布局，其中不透明度发生变化。另一种机制是使用 JavaFX `AnimationTimer`，它会在 JavaFX 脉冲发生时为您提供回调。在 AWT 和 JavaFX 线程之间保持所有这些的正确同步会很烦人。

# android - Google Places Android API 中的 rankby=距离

> ID：14248412
> 
> 赞同：1
> 
> 时间：2013-01-09T23:34:41.557
> 
> 标签：android, google-places-api

我写了一些代码来根据他们的突出搜索附近的地方。接下来，我想让我的应用根据与用户的距离递增来搜索位置。为了做到这一点，我了解到我需要使用`rankby=distance`但`rankby`不允许使用值`radius`- 所以以下基于半径的搜索不起作用：

```
nearPlaces = googlePlaces.search(
    gps.getLatitude(), 
    gps.getLongitude(), 
    radius, 
    types
); 
```

我看过一些博客和文章，人们提出了类似的问题，但没有一个提供似乎有效的答案。如果不是上述情况，我应该使用什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T07:27:39.670

正确的是`rankBy=distance...`

保持`B`资本在`rankBy...`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-28T13:22:42.147

私有静态最终字符串 PLACES_SEARCH_URL = " [https://maps.googleapis.com/maps/api/place/search/json?rankby=distance&](https://maps.googleapis.com/maps/api/place/search/json?rankby=distance&) ";

公共 PlacesList 搜索（双纬度、双经度、双半径、字符串类型）抛出异常 {

```
 this._latitude = latitude;
    this._longitude = longitude;
    this._radius = radius;
    //this._rankby=_rankby;

    try {

        HttpRequestFactory httpRequestFactory = createRequestFactory(HTTP_TRANSPORT);
        HttpRequest request = httpRequestFactory
                .buildGetRequest(new GenericUrl(PLACES_SEARCH_URL));
        request.getUrl().put("key", API_KEY);
        request.getUrl().put("location", _latitude + "," + _longitude);
    //  request.getUrl().put("radius", _radius);
        request.getUrl().put("rankBy", _radius);
        // in meters
        request.getUrl().put("sensor", "false");
        //request.getUrl().put("rankby", _rankby);
        if(types != null)
            request.getUrl().put("types", types);

        PlacesList list = request.execute().parseAs(PlacesList.class);
        // Check log cat for places response status
        Log.d("Places Status", "" + list.status);
        return list;

    } catch (HttpResponseException e) {
        Log.e("Error:", e.getMessage());
        return null;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-29T18:33:19.303

你可以绕过它。我使用了“GOOGLE PLACES WEB SERVICES” [https://developers.google.com/places/webservice/search](https://developers.google.com/places/webservice/search)：

1.  使用 PLACES API 获取所有地点的 JSON（使用 HttpURLConnection 发送请求）：

    ```
    String nearByPlaceSearchURL =  "https://maps.googleapis.com/maps/api/place/nearbysearch/json?"
                    + "location=" + myLatPosition + "," + myLonPosition
                    + "&radius=" + myPlaceDistanceMeters
                    + "&types=" + myPlaceName
                    + "&key=" +  MyConstants.KEY_FOR_PLACES_AND_DISTANCES_API; 
    ```

2.  解析返回的 JSON 并获取每个地点的坐标 LAT/LON。

3.  使用 DISTANCE MATRIX API 获取从您当前位置到每个地点的所有距离的 JSON：

    ```
     String distancesSearchURL = "https://maps.googleapis.com/maps/api/distancematrix/json?"
            + "origins=" + myLatPosition + "," + myLonPosition
            + "&destinations=" + allPlacesCoordinates
            + "&mode=walking"
            + "&key=" + MyConstants.KEY_FOR_PLACES_AND_DISTANCES_API; 
    ```

    请注意，距离是步行、驾车或骑自行车的距离，这是我们感兴趣的距离。半径距离（空中距离）不相关。步行/驾车/骑行距离大于空中距离。因此，例如，您可以搜索半径为 10 公里的地方，但步行距离为 11 公里。

4.  为每个地点创建一个对象，并将其名称和与当前位置的距离作为内部变量。

5.  生成一个包含所有对象位置的 ArrayList。

6.  根据距离使用方法比较器对 ArrayList 进行排序。

# javascript - 在文本中查找关键字

> ID：14248416
> 
> 赞同：2
> 
> 时间：2013-01-09T23:35:03.483
> 
> 标签：javascript, regex, if-statement, find, match

我有一个数组，其中包含已发生的事件，它们是用自由文本编写的，因此除了某些关键字之外没有遵循某种模式，例如。“抢劫”、“凶手”、“入室行窃”、“车祸”等。这些关键字可以在文本中的任何位置，我想找到这些关键字并将它们添加到类别中，例如。“抢劫”。

**最后，当我检查完所有事件后，我想要一个这样的类别列表：**

```
Robberies: 14
Murder attempts: 2
Car accidents: 5
... 
```

**数组元素可能如下所示：**

```
incidents[0] = "There was a robbery on Amest Ave last night...";
incidents[1] = "There has been a report of a murder attempt...";
incidents[2] = "Last night there was a housebreaking in...";
... 
```

我想这里最好的是使用正则表达式来查找文本中的关键字，但我真的很讨厌正则表达式，因此在这里需要一些帮助。

下面的正则表达式不正确，但我猜这个结构会起作用吗？有没有更好的方法来避免 DRY？

```
var trafficAccidents = 0,
    robberies = 0,
    ...

function FindIncident(incident) {
    if (incident.match(/car accident/g)) {
        trafficAccidents += 1;
    }
    else if (incident.match(/robbery/g)) {
        robberies += 1;
    }
    ...
} 
```

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:50:20.410

实际上，我在这里有点不同意你的看法。. . 我认为像这样的字符串函数`indexOf`会很好地工作。

我会使用 JavaScript 的 indexOf 方法，它需要 2 个输入：

> string.indexOf(value,startPos);

所以你可以做的一件事就是定义一个简单的临时变量作为你的游标。. .

```
function FindIncident(phrase, word) {
    var cursor = 0;
    var wordCount = 0;
    while(phrase.indexOf(word,cursor) > -1){
        cursor = incident.indexOf(word,cursor);
        ++wordCount;        
    }
    return wordCount;
} 
```

我没有测试过代码，但希望你能明白。. .

如果您确实使用它，请特别注意起始位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T23:56:25.687

以下代码显示了您可以采用的方法。你可以[在这里测试](http://jsfiddle.net/jzcJL/1/)

```
var INCIDENT_MATCHES = {
  trafficAccidents: /(traffic|car) accident(?:s){0,1}/ig,
  robberies: /robbery|robberies/ig,
  murder: /murder(?:s){0,1}/ig
};

function FindIncidents(incidentReports) {
  var incidentCounts = {};
  var incidentTypes = Object.keys(INCIDENT_MATCHES);
  incidentReports.forEach(function(incident) {
    incidentTypes.forEach(function(type) {
      if(typeof incidentCounts[type] === 'undefined') {
        incidentCounts[type] = 0;
      }
      var matchFound = incident.match(INCIDENT_MATCHES[type]);
      if(matchFound){
          incidentCounts[type] += matchFound.length;
      };
    });
  });

  return incidentCounts;
} 
```

正则表达式是有意义的，因为您将拥有许多符合您的“匹配”标准的字符串，即使您只考虑“抢劫”的复数和单数形式的差异。您还希望确保您的匹配不区分大小写。

您需要在正则表达式上使用“全局”修饰符，以便匹配诸如“谋杀、谋杀、谋杀”之类的字符串，并将计数增加 3 而不仅仅是 1。

这使您可以将匹配标准和事件计数器之间的关系保持在一起。它还避免了对全局计数器的需要（granted`INCIDENT_MATCHES`在这里是一个全局变量，但您可以很容易地将它放在其他地方并将其移出全局范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T00:05:06.440

你可以做这样的事情，它将抓取在数组中每个项目上找到的所有单词，它会返回一个带有计数的对象：

```
var words = ['robbery', 'murderer', 'housebreaking', 'car accident'];

function getAllIncidents( incidents ) {
  var re = new RegExp('('+ words.join('|') +')', 'i')
    , result = {};
  incidents.forEach(function( txt ) {
    var match = ( re.exec( txt ) || [,0] )[1];
    match && (result[ match ] = ++result[ match ] || 1);
  });
  return result;
}

console.log( getAllIncidents( incidents ) );
//^= { housebreaking: 1, car accident: 2, robbery: 1, murderer: 2 } 
```

这更像是一个快速原型，但可以通过复数和多个关键字进行改进。

**演示：http:** [//jsbin.com/idesoc/1/edit](http://jsbin.com/idesoc/1/edit)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-09T23:58:29.897

使用对象数组来存储您正在搜索的所有许多不同类别，并带有适当的正则表达式和计数成员，您可以将整个内容写成四行。

```
var categories = [
    {
        regexp: /\brobbery\b/i
        , display: "Robberies"
        , count: 0
    }
    , {
        regexp: /\bcar accidents?\b/i
        , display: "Car Accidents"
        , count: 0
    }
    , {
        regexp: /\bmurder\b/i
        , display: "Murders"
        , count: 0
    }
];

var incidents = [ 
    "There was a robbery on Amest Ave last night..."
    , "There has been a report of an murder attempt..."
    , "Last night there was a housebreaking in..."
];

for(var x = 0; x<incidents.length; x++)
    for(var y = 0; y<categories.length; y++)
        if (incidents[x].match(categories[y].regexp))
            categories[y].count++; 
```

现在，无论您需要什么，您只需编辑一段代码，它就会在您的代码中传播。

此代码有可能将每个事件分类为多个类别。为了防止这种情况，只需在 if 块中添加一个“break”语句。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-09T23:49:03.437

使用对象来存储您的数据。

```
events = [
    { exp : /\brobbery|robberies\b/i, 
    //       \b                      word boundary
    //         robbery               singular
    //                |              or
    //                 robberies     plural
    //                          \b   word boundary
    //                            /i case insensitive
      name : "robbery",
      count: 0
    },
    // other objects here
]

var i = events.length;    
while( i-- ) {

    var j = incidents.length; 
    while( j-- ) {

        // only checks a particular event exists in incident rather than no. of occurrences
        if( events[i].exp.test( incidents[j] ) { 
            events[i].count++;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-09T23:54:13.717

RegEx 也让我头疼。;) 如果您正在寻找完全匹配并且不担心拼写错误和拼写错误，我会在事件字符串中搜索包含您要查找的关键字的子字符串。

```
incident = incident.toLowerCase();
if incident.search("car accident") > 0 {
    trafficAccidents += 1;
}
else if incident.search("robbery") > 0 {
    robberies += 1;
}
... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-10T00:21:46.607

是的，这是一种方法，虽然用正则表达式匹配纯单词有点矫枉过正——在这种情况下，你应该使用[*indexOf*作为 rbtLong 建议](https://stackoverflow.com/a/14248557/1608072)的。

您可以通过以下方式进一步完善它：

*   附加`i`标志（匹配小写和大写字符）。
*   为您的表达添加可能的单词变体。`robbery`可以翻译成`robber(y|ies)`，从而匹配单词的单数和复数变体。`car accident`可能是`(car|truck|vehicle|traffic) accident`。

## 单词边界 \b

不要使用这个。它需要在您的匹配词周围使用非字母数字字符，并防止匹配错别字。你应该让你的查询尽可能的清晰。

* * *

```
if (incident.match(/(car|truck|vehicle|traffic) accident/i)) {
    trafficAccidents += 1;
}
else if (incident.match(/robber(y|ies)/i)) {
    robberies += 1;
} 
```

注意我是如何丢弃`g`旗帜的；它代表“全局匹配”并使解析器在第一次匹配后继续搜索字符串。这似乎没有必要，因为只需一次确认的事件就足以满足您的需求。

这个网站提供了一个很好的正则表达式介绍

[http://www.regular-expressions.info/tutorial.html](http://www.regular-expressions.info/tutorial.html)

# javascript - 将预定义的日期传递给 dijit 日历

> ID：14248422
> 
> 赞同：0
> 
> 时间：2013-01-09T23:35:49.140
> 
> 标签：javascript, calendar, dojo

我把我的 dijit 日历准备好了，所以我想约会并把它贴在我的日历上。我从

```
return "<a href=\"#\" onclick='return false'>" + dateClick + "</a>"; 
```

我的日历功能是

```
cal_1 = new dijit.Calendar({
           value: new Date()
        }); 
```

我想将 dateClick 传递到我的 cal_1 中，dateClick 的格式类似于`2012-10-10 00:00:00`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:53:47.407

将 dateClick 保存为 Date() 对象并使用 Steven Leviathan 的[dateFormat](http://blog.stevenlevithan.com/archives/date-time-format)库来扩展 Date 对象，您可以根据需要对其进行格式化。

# iphone - 从 iOS 中的 plist 文件中读取 int

> ID：14248424
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:36:01.407
> 
> 标签：iphone, ios, objective-c, plist, nsdictionary

我需要一些帮助来读取 plist 文件。这是我的代码，但它不起作用，我不再有想法了。我想构建一个 dylib 来读取这个 plist com.mi.pp1.plist 的整数。

```
Bux = [[[NSDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences/com.mi.pp1.plist"]valueForKey:@"kBux"]intValue];

%hook PPPlayerData
- (int)bux
{
    return Bux;
}
%end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:58:47.843

```
int Bux;

Bux = [[[NSDictionary dictionaryWithContentsOfFile:@"/var/mobile/Library/Preferences    /com.mi.pp1.plist"]objectForKey:@"kBux"]intValue];

%hook PPPlayerData
- (int)bux
{
return Bux;
} 
```

作品

# git - git tag：只显示我的标签？

> ID：14248425
> 
> 赞同：0
> 
> 时间：2013-01-09T23:36:08.977
> 
> 标签：git

有没有办法只在 git 中查看我的标签？

我已经尝试过`git tag --author="XXX"`，但这不起作用。[我在文档上](http://git-scm.com/docs/git-tag)也找不到任何东西。

背景：这是对以下问题的后续问题：[Git: History of commits I have *check out* since init/cloning](https://stackoverflow.com/questions/14248118/git-history-list-of-commits-i-have-checked-out-since-init-cloning)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T23:59:46.980

除非您以某种方式对标签进行签名或注释，否则并非如此。但是，您可能想要制作未存储在`refs/tags/`. 有些系统会为事物的瞬态标记执行此操作——据我所知，gerrit 会创建“refs/for/”和“refs/changes/”引用。为此，您可以在 refs 下的另一个目录中创建 ref 文件：

```
$ git update-ref refs/special/first HEAD~4
$ git update-ref refs/special/second HEAD~2
$ git tag | grep first
<nothing returned -- shows these are not tags>
$ $ git log --oneline -n 2 special/first
7c1d983 Merge branch 'pt/tcltk8513' into devel
73cdc1e Merge pull request #72 from pointoforder/devel
<it works!> 
```

另外——这些确实出现在 gitk 或`git log --decorate`. 例如：

```
$ git log --graph --oneline --abbrev-commit --decorate -n10
* 53e28dd (HEAD, origin/master, master) Installer: Continue the idea of d5f2
* 0433db0 shell prompt should not beep and only show MSYSTEM when non-standa
*   947ccf6 (refs/special/second) Merge branch 'devel' of 
|\
| * 759a59f Bash PS1: Correctly enclose nonprintable sections
| * 4e4e3f3 Bash PS1: Split up PS1 into small components
| * 707197e Bash PS1: refactor code for better readability
* | 6bf64a4 Replace 'devel' with 'master'
* |   7c1d983 (refs/special/first) Merge branch 'pt/tcltk8513' into devel
|\ \
| * | cc9382f (pt/tcltk8513) Update tk to version 8.5.13
| * | 31fbf2c Update tcl to version 8.5.13 
```

因此，您可以创建一些别名以使这些对您有用且易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:54:47.250

```
git tag -l
git tag --list 
```

应该对所有标签都这样做。但是标签很轻，所以它不存储是谁制作的。

# symfony - 将 404 错误重定向到另一个目录

> ID：14248429
> 
> 赞同：0
> 
> 时间：2013-01-09T23:36:13.690
> 
> 标签：symfony, error-handling

我正在使用 Symfony 2 框架，我正在尝试将我的 404 页面重定向到我网站上的另一个文件夹。我想知道我该怎么做？

目前，我的 404 错误页面位于`app/resources/TwigBundle/views/Exception/error404.html.twig`. 我希望我的 404 页面可以从`src/site/StoreBundle/Resources/views/pages/error404.html.twig`.

请注意，我只想重定向我的 404 页面。我仍然希望我的其他错误（500、503）保留在`app/resources/TwigBundle/views/Exception/error404.html.twig`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T16:16:47.797

我不确定你为什么要这样做，所以很难建议，但为什么你不能在 app/resources/TwigBundle/views/Exception/error404.html.twig 中添加一个[包含](http://twig.sensiolabs.org/doc/tags/include.html)其他模板的内容? 请务必为您的包使用正确的命名空间。像下面这样的东西应该没问题（在适当的地方编辑）。

```
{% include 'StoreBundle:pages:error404.html.twig' %} 
```

# arrays - 如何根据列中的特定值从数组中挑选行？

> ID：14248440
> 
> 赞同：3
> 
> 时间：2013-01-09T23:36:54.213
> 
> 标签：arrays, matlab, sorting

我有一组数据。为简单起见，我们称其为 4 x 3 矩阵。假设我想在第 2 列中找到一个值为 5 的数据点。然后，我想在第 2 列中取出所有包含 5 值的行并将其放入自己的数组中。我的数据比下面显示的要大得多，所以我不想通过肉眼查看每一行数据并识别所有 5。

```
 % My idea of the code:

  data = [1 2 3 4; 5 5 5 6; 6 4 5 6]

  if data(:,2) == 5

  % This is the part I can't figure out

  end 
```

让我们将 finaldata 称为数组，其中将存储 5 的数据。我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T23:48:31.993

您应该使用[逻辑索引](http://www.mathworks.de/de/help/matlab/math/matrix-indexing.html?s_tid=doc_12b)：

```
all_fives_rows = data(data(:, 2) == 5, :) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:41:39.020

您可以使用[FIND](http://www.mathworks.com/help/matlab/ref/find.html)函数来搜索该值，并返回坐标（它可能是一个向量）以检索行：

```
data(find (data(:,2)==5),:) 
```

为什么不使用逻辑索引：[性能](http://www.mathworks.com/matlabcentral/newsreader/view_thread/102545)

# windows - Windows VBScript - 使用 Eval 执行代码

> ID：14248441
> 
> 赞同：3
> 
> 时间：2013-01-09T23:37:10.417
> 
> 标签：windows, vbscript, eval

我的 vbscript 文件中有一个字符串。我想将字符串作为代码执行。例如，字符串可以是 'msgbox("hello")'。但是，eval 函数只接受数字或字符串操作。我应该如何执行代码？我总是可以创建一个新文件并将该字符串写入文件，执行文件并删除它，但我正在寻找一种更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T00:25:30.180

也许令人惊讶的是，您可以使用[Execute](http://msdn.microsoft.com/en-us/library/03t418d2%28v=vs.84%29.aspx)语句来做到这一点。它甚至在Eval 函数的[文档中被引用。](http://msdn.microsoft.com/en-us/library/0z5x4094%28v=vs.84%29.aspx)

# html - 链接样式不起作用

> ID：14248442
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:37:24.217
> 
> 标签：html, css, hover, hyperlink

我正在尝试设置链接的样式，并且为此使用了以下代码：

```
.navtext {
    position:absolute;
    top:130px;
    right:50px;
    color:#ffffff;
    font-size:20px;
    z-index:3;
}

a.navtext:link {
    color:#ffffff;
    text-decoration:none;
}

a.navtext:hover {
    color:#ffffff;
    text-decoration:underline;
}

a.navtext:visited {
    color:#ffffff;
    text-decoration:none;
} 
```

这是我的html：

```
<div class="navtext">
    <a href="index.php">Home</a>
    <a href="about.php">About</a>
    <a href="school.php">School</a>
    <a href="workshop">Workshop</a>
    <a href="contact.php">Contact</a>
</div> 
```

但他们保持默认（链接：蓝色，下划线。没有悬停。访问：紫色，下划线。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:40:43.870

`a.navtext`选择具有`<a>`“navtext”类的标签。

你没有这样的`<a>`标签。您的`<a>`标签没有类。

尝试类似的东西`.navtext a`。这将选择一个`<a>`元素内的标签，该标签具有类“navtext”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:47:33.360

```
.navtext a {
    position:absolute;
    top:130px;
    right:50px;
    color:#ffffff;
    font-size:20px;
    z-index:3;
}

.navtext a:link {
    color:#ffffff;
    text-decoration:none;
}

.navtext a:hover {
    color:#ffffff;
    text-decoration:underline;
}

.navtext a:visited {
    color:#ffffff;
    text-decoration:none;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T23:49:49.120

改成

```
.navtext a:link      {   color:#ffffff;
                    text-decoration:none;
                }

.navtext a:hover     {   color:#ffffff;
                    text-decoration:underline;
                }

.navtext a:visited   {   color:#ffffff;
                    text-decoration:none;
                } 
```

# jquery - jquery form $("form").submit() 有效，但不适用于给定的表单 ID

> ID：14248444
> 
> 赞同：0
> 
> 时间：2013-01-09T23:37:27.273
> 
> 标签：jquery

我花了一些时间从我巨大的表单中提取这个简单的代码，请看一下：

```
<script type="text/javascript">
    $(document).ready(function(){
        $("form #formcontact").submit(function(){
            alert('a');
            return false;
        });
    });
</script>

<div>
    <form id="formcontact" action="" method="POST">
       <input id="contact_submit" type="submit" value="sub" />
    </form>
</div> 
```

这不起作用，但如果我用它替换`$("form #formcontact")`它`$("form")`，但我不希望它出现在每个表单上。

这是为什么？这么奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T23:39:02.307

$("form #formcontact") 选择 的子元素`<form>`。删除空间，它将起作用：

```
$("form#formcontact") 
```

或者

```
$("#formcontact") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T23:39:00.717

您的选择器是错误的，它应该`$("form#formcontact")`没有空格，或者只是`$("#formcontact")`因为 ids 应该是唯一的。

# java - 在 Lotus Notes 中使用 Web 服务显示错误消息没有为 org.apache.commons.logging.logfactory 定义实现

> ID：14248445
> 
> 赞同：0
> 
> 时间：2013-01-09T23:37:28.683
> 
> 标签：java, web-services, lotus-notes, axis, apache-commons-logging

我已经为此苦苦挣扎了好几个星期了。我几乎尝试了一切。

1.  放松安全
2.  把早期版本的 commons-loggings.jar
3.  放置 commons-loggins 属性文件

但所有的努力都是徒劳的。我无法成功运行代理。

错误消息是持久的 -

`org.apache.commons.discovery.discoveryexception no implementation defined for org.apache.commons.logging.logfactory`

任何帮助深表感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:02:07.947

看起来我找到了解决方案.. ATLAST 所需要的只是重新启动服务器。那成功了..

# c# - 通过 javascript 设置 iframe 的用户代理

> ID：14248446
> 
> 赞同：3
> 
> 时间：2013-01-09T23:37:31.163
> 
> 标签：c#, javascript, jquery, asp.net-mvc, iframe

试图满足的业务需求：在 iframe 中加载现有页面，模拟 iphone 用户代理。这需要在客户端发生的原因是有**客户端脚本**可以检测用户代理并将一些类附加到 html 元素上。基于此，网站的样式将彻底改变，因为 CSS 以基于 html 类的元素为目标。

因此，它将把它变成或在我试图在这里解决的情况下等等。

在 chrome 中使用 window.open 可以工作（如本代码所示）。该网站以适当的移动样式呈现。

使用 iframe 有效，但仅限于 FF。

理想情况下，我希望 iframe 版本在 Chrome 和 FF 中运行。

有什么想法吗？

```
<script type="text/javascript">

        navigator.__defineGetter__('userAgent', function () {
            return 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5';
        });

        var win = window.open('/home/get');
        win.navigator.__defineGetter__('userAgent', function () {
            return 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5';
        });
        win.location.href = '/home/get'; //required

        $(function () {
            var frame = $('<iframe width="320" height="480"></iframe>');
            frame.hide();
            $('#container').append(frame);

            (frame[0].contentWindow || frame[0].contentDocument).navigator.__defineGetter__('userAgent', function () {
                return 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5';
            });
            frame.attr('src', '/home/get');

            });

            frame.fadeIn();
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:17:56.620

想通了，适用于 FF、Chrome 和 IE。我不确定 Safari，因为我没有安装它。它的概要是发出 ajax 请求，获取 html，然后打开 iframes 文档。**打开它之后**，覆盖它的 userAgent getter，然后编写从 ajax 调用收到的 html。

```
 $(function () {
        var frame = $('<iframe width="320" height="480"></iframe>');
        frame.hide();

        $('#container').append(frame);
        var contentWindow = frame[0].contentWindow || frame[0].contentDocument;

        var setUA = function() {
            if (Object.defineProperty) {
                Object.defineProperty(contentWindow.navigator, 'userAgent', {
                    configurable: true,
                    get: function () {
                        return 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5';
                    }
                });
            } else if (Object.prototype.__defineGetter__) {
                contentWindow.navigator.__defineGetter__('userAgent', function () {
                    return 'Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_2 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8H7 Safari/6533.18.5';
                });
            } else {
                alert('browser not supported');
            }
        };

        $.ajax({
            cache: false,
            url: '/home/get',
            success: function (html) {
                contentWindow.document.open();
                setUA();
                contentWindow.document.write(html);
                contentWindow.document.close();
                frame.fadeIn();
            }
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:12:38.473

你不能用 iframe 做这样的事情。用户代理与初始请求的标头一起发送。

备择方案：

使用后端代理。iframe 实际上是从您自己的服务器加载页面，该服务器通过代理加载远程页面。你可以设置任何你想要的标题。这仅在 3rd 方站点不需要登录时才有效，因为您不想代理用户的会话。

如果远程站点支持 CORS，您可以从您的页面发出 XHR 请求，该请求设置用户代理标头并取回页面内容。然后，您可以将该代码添加到 iframe 中。当心这种技术的严重安全问题。

我的建议是，想出一个不同的行动计划。

# c# - 如何在 nhibernate 中实现导航属性

> ID：14248455
> 
> 赞同：1
> 
> 时间：2013-01-09T23:38:29.070
> 
> 标签：c#, nhibernate, orm, fluent-nhibernate

我有一个与 NHibernate 一起使用的域模型的场景，如下所示。

```
public class BaseClass
{
  public virtual int Id { get; set; }
  public virtual string SomeProperty { get; set; }
}

public class FirstClass : BaseClass 
{
  public virtual IList<AnotherClass> AnotherClassList  { get; set; }
}

public class SecondClass : BaseClass 
{
  public virtual AnotherClass AnotherClass  { get; set; }
}

public class AnotherClass 
{
  public virtual int Id { get; set; }
  public virtual BaseClass MyNavigationalProperty  { get; set; }
} 
```

它看起来不错，但它不像我预期的那样工作。这是我的场景；

作为我的**第一步**，我将我的 FirstClass 与列表中的一个或多个 AnotherClass 一起保存，它运行良好。我可以用列表中的相关 AnotherClasses 检索我的 FirstClass。

在我的**第二步**中，我将单独保存一个新的 AnotherClass，并将 MyNavigationalProperty 从我的第一步设置为我的 FirstClass。它看起来确实很棒，但是...

在我的**最后一步**中，我正在检索我的 FirstClass，并且我期望我的 AnotherClassList 包含我第二步中的 AnotherClass。但是我只从第一步中获得了原始的 AnotherClasses。

查看数据库，我可以看到第二步的记录，但表 AnotherClass、BaseClass_Id 和 FirstClass_Id 中有两个单独的 FK，FirstClass_Id 为 NULL，因此我在最后一步中没有得到此记录。

这是实现导航属性的错误方法吗？如果是这样，我应该如何正确地做到这一点？或者......简单地说，有没有更好的方法来做到这一点？

**编辑**

从Thilak的映射问题我得到了另一个想法，原来的域模型没有使用BaseClass，那是我的实现。那是否有必要创建我自己的映射？这是否意味着我必须完全放弃自动映射？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T05:36:51.937

该引用使用另一列作为集合。你可以手动覆盖它

```
class SetForeignKeyColumn : IAutomappingOverride<FirstClass>
{
    public ...
    {
        instance.HasMany(x => x.AnotherClassList).KeyColumn("baseclass_id");
    }
} 
```

# html - 左右两侧的div

> ID：14248460
> 
> 赞同：2
> 
> 时间：2013-01-09T23:39:04.650
> 
> 标签：html, css

有点模糊。我使用新闻系统，在左侧我想从世界获取新闻，在右侧我不会从我的国家获取新闻。这个问题我真不知道怎么解决：http://i48.tinypic.com/15rxzkw.jpg

资源：

```
<div style="width:1000px;">
    <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

 <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

  <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

   <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/> <br/>

   <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>

    <div style="border:1px solid red;float:left;width:400px;">news from world</div><br/><br/>
    <div style="border:1px solid blue;width:400px;float:right;">news from my country</div><br/><br/>
    <div style="border:1px solid blue;width:400px;float:right;">news from my country</div><br/><br/>
    <div style="border:1px solid blue;width:400px;float:right;">news from my country</div><br/><br/>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:44:27.790

您需要清除浮动 div。把这个：

```
<div style="clear: both;"></div> 
```

[http://www.quirksmode.org/css/clearing.html](http://www.quirksmode.org/css/clearing.html)

例如：

```
<div style="width:1000px;">
<div style="border:1px solid red;float:left;width:400px;">aaaaaaaa</div>
<div style="border:1px solid blue;width:400px;float:right;">bbbbbbb</div>
<div style="clear: both"></div>
<div style="border:1px solid blue;width:400px;float:left;top:0px;">cccccccc</div>
<div style="border:1px solid blue;width:400px;float:right;">dddddddddd</div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:43:46.417

其原因在于`<br /><br />`

删除它们，因为它们将元素 2,3 和 4 2 规则向下推。

还尝试将样式与您的 html 分开，并且永远不要`<br />`用于样式。（W3C 语义）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T23:46:45.823

你可以试试这个：

```
 <div style="width:1000px;">

   <div style="float:left;">
    <div style="border:1px solid red;width:400px;">aaaaaaaa</div><br/><br/>
    <div style="border:1px solid blue;width:400px;">bbbbbbb</div>
    </div>
     <div style="float:left;">
    <div style="border:1px solid blue;width:400px;top:0px;">cccccccc</div>
    <div style="border:1px solid blue;width:400px;">dddddddddd</div>
    </div>

    </div> 
```

# javascript - 如何使谷歌地球 iframe 垫片半透明

> ID：14248461
> 
> 赞同：1
> 
> 时间：2013-01-09T23:39:14.303
> 
> 标签：javascript, transparent, google-earth

我正在尝试实现 iframe shim 以在 google earth 插件之上呈现自定义 html 内容。我成功地渲染了叠加层，但是我也想让 iframe 和自定义 html 都是半透明的。将“allowTransparency”设置为 true 并降低 iframe 的不透明度时，不会呈现自定义 html 内容。

下面是示例代码

```
<body>

   <div id="earth"></div>

   <iframe allowTransparency="true" style="position:absolute; top:0px; bottom:0px; right:0px; width:200px; height:500px; background:#222; opacity:0.5; border:none; z-index:100;"></iframe>

   <div id="shimdiv" style="position:absolute; top:0px; bottom:0px; right:0px; width:200px; height:500px; background:#222; opacity:0.5; border:none; z-index:100;"></div>

</body> 
```

我发现的所有示例都呈现完全不透明的 html 内容。有谁知道允许透明度的解决方法？

提前致谢。

# ruby-on-rails-3 - Rails 3 唯一性验证 - 逻辑

> ID：14248462
> 
> 赞同：0
> 
> 时间：2013-01-09T23:39:29.940
> 
> 标签：ruby-on-rails-3

给定以下发票模型：

```
validates :po_number, :invoice_number, :invoice_date, :date_received, :state_id, :division_id, :pending_state_id, :approver_username, :approver_email, :presence => true
validates :po_number, :uniqueness => {:scope => :invoice_number} 
```

有时会取消发票记录 (state_id = 4)，但随后需要重新创建。

您能帮我解决如何仍然验证 po_number 和 invoice_number 的唯一性，以便即使相同的组合存在但具有不同的 state_id 也可以创建新记录（如果它被取消）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:56:27.023

我认为您需要一个自定义验证器。像这样的东西可能会起作用：

```
validate :unique_po_number
def unique_po_number
  errors.add(:po_number, 'must be unique') if self.class.where('state != 4').where(:po_number => po_number).count > 0
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T01:02:03.487

根据您的描述，我认为将其包含`:state_id`在范围中并通过`:unless`（或`:if`）选项以从检查中排除已取消（或任何其他状态）可能就足够了：

```
validates :po_number, :uniqueness => {
  :scope => [:invoice_number, :state_id], 
  :unless => :cancelled? 
}

# assumes an instance method like
def cancelled?
  state_id == 4
end 
```

# svn - 如何将本地代码恢复到以前的版本 svn

> ID：14248470
> 
> 赞同：7
> 
> 时间：2013-01-09T23:40:34.610
> 
> 标签：svn, version-control

我只想将本地代码恢复到以前的版本。

对于额外的点，我想做的是将文件夹恢复到以前的版本（仅在本地）并生成一个与它之后的版本不同的文件。

例如说我有 100 版。我想要 99 版以及它和 100 之间的差异，然后是 98 和 99 等。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-09T23:48:01.190

```
svn update -r 99
svn diff -r 100 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-09T23:44:59.020

```
svn checkout url://repository/path@1234 
```

查看 rev no 1234。

```
svn revert -R 
```

还原本地修改。

[在这里](http://svnbook.red-bean.com/en/1.7/svn.tour.history.html)查看更多

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-20T09:51:19.147

我最近不得不恢复到特定版本来调试旧版本，这就像魔术一样：

svn up -r 3340（或任何您想要的修订号）我必须使用“tc”选项解决所有冲突，因为我不关心本地更改（在还原之前检查了我关心的所有内容）

重新开始修订也很简单：

快点

注意：恢复到文件的先前 SVN 版本的更好方法。

# javascript - 有没有比使用 scrollingParallax 插件在页面上滚动我的图像更好的方法

> ID：14248480
> 
> 赞同：0
> 
> 时间：2013-01-09T23:42:24.710
> 
> 标签：javascript, jquery

我有 34 张照片，我希望滚动的速度比使用 javascript 的页面稍快一些，我目前正在使用[scrollingParallax 插件](http://dev.jonraasch.com/scrolling-parallax/docs#.UO39p2_gnlc)来实现。然而，当我切换到我的 ipad 来查看它时，它变得相当粗略！我想让网站响应，因为我妈妈只会在那里看它！我想知道这种抖动是由于我的低效编码、旧插件还是我只是个白痴造成的！

我基本上循环进入插件 34 次，我确信这效率不高，但时间和理解有限，我想我会把它扔到所有知识 stackoverflow 的字体中！

这是我正在使用的循环：

```
/* Photo sprite alignment and scroll   */
for(var i=0; i<34; i++){
var j = '#photo' + (i+1);
$(j).scrollingParallax({staticSpeed : 2.2,staticScrollLimit : false, loopIt : false});
}; 
```

几张照片的CSS：

```
.photos{position: fixed; z-index:-1;}

#photo1{top:900px; left:10px;}
#photo2{top:1100px; right:10px;}
#photo3{top:1300px; left:10px;}
#photo4{top:1500px; right:10px;}
#photo5{top:1700px; left:10px;}
#photo6{top:1900px; right:10px;}
#photo7{top:2100px; left:10px;}
#photo8{top:2300px; right:10px;} 
```

一些照片的html：

```
<div class="photos">
<img src="img/1.png" id="photo1">
<img src="img/2.png" id="photo2">
<img src="img/3.png" id="photo3"> 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T19:37:19.347

Shmiddty 提供了一种更好的调用函数的方法，但最终 iOS 只是没有足够快地运行 jquery scrollingParrallax，所以我最终在 iOS 上隐藏了这个类。

// 优化：将引用存储在事件处理程序之外： var $window = $(window);

```
function checkWidth() {
    var windowsize = $window.width();
    if (windowsize > 1250) {
        //if the window is greater than 1250px wide then turn on parallax scrolling..
                    $('.fixedPhotos').addClass('hidden');
                    $('.photos img').removeClass('hidden');
            }else{
                    $('.fixedPhotos').removeClass('hidden');
                    $('.photos img').addClass('hidden');
            }
}
// Execute on load
checkWidth();
// Bind event listener
$(window).resize(checkWidth); 
```

# ruby-on-rails-3 - Mercury WYSIWYG 编辑器不适用于资产的子文件夹

> ID：14248482
> 
> 赞同：0
> 
> 时间：2013-01-09T23:42:37.383
> 
> 标签：ruby-on-rails-3, wysiwyg, asset-pipeline, mercury-editor

[水星编辑器](http://jejacks0n.github.com/mercury/)

我已经排除`mercury.js`了`application.js`更改和移动`require_tree .`到名为inside的子文件夹。`require_directory .``mercury.js``mercury``assets/javascripts`

因此，我的应用程序上的其他所有内容都运行良好，并且没有加载任何水银。

从今起`layouts/mercury.html.erb`

```
 <%= stylesheet_link_tag    'mercury/mercury' %>
    <%= javascript_include_tag 'jquery-1.7', 'mercury/mercury' %> 
```

和

```
 <script type="text/javascript">
          // Set to the url that you want to save any given page to, leave null for default handling.
          var saveUrl = null;

          // Instantiate the PageEditor
          new Mercury.PageEditor(saveUrl, {
            saveStyle:  'form', // 'form', or 'json' (default json)
            saveMethod: null, // 'PUT', or 'POST', (create, vs. update -- default PUT)
            visible:    true  // boolean - if the interface should start visible or not
          });
</script> 
```

但是当编辑器加载我得到这个错误：

`TypeError: 'undefined' is not a constructor (evaluating 'new Mercury.PageEditor')`

是子文件夹的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T14:23:33.803

我很确定这是由于水星库占用了“水星”路径。

如果你耙路线，你会看到这个

```
Routes for Mercury::Engine:
mercury_editor  /editor(/*requested_uri)(.:format)        mercury#edit
                /mercury/:type/:resource(.:format)        mercury#resource
                /mercury/snippets/:name/options(.:format) mercury#snippet_options
                /mercury/snippets/:name/preview(.:format) mercury#snippet_preview 
```

这有点令人困惑，因为您在请求 yourhost://assets/mercury/mercury.js 时获得的文件是水银库文件。如果您将文件夹命名为“mercury_assets”或除“mercury”之外的任何其他名称，它将起作用。

除非您确定水星可以找到必要的库，否则我不会尝试更改路线。

# java - 挂起由java产生的子进程

> ID：14248484
> 
> 赞同：1
> 
> 时间：2013-01-09T23:42:59.787
> 
> 标签：java, spawn, suspend, child-process

我有一个`Runtime.exec()`用于生成子进程的 java 程序，但我需要能够以编程方式挂起它，然后从它停止的地方重新开始运行。Java`Process`对象似乎没有提供任何方法来做到这一点。有谁知道我如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:46:33.047

Java 不是低级语言。因此，不支持与操作系统的某些交互。

唯一的解决方案是让您使用可以真正与操作系统（如 C/C++）一起使用的语言创建代码，并使用 JNI 从 java 调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:06:10.240

在 UNIX 下，您可以 Runtime.exec + kill -STOP 和 -CONT 挂起和恢复进程，而无需使用 JNI。

# symfony - Symfony2 检查子实体的 ACL

> ID：14248485
> 
> 赞同：0
> 
> 时间：2013-01-09T23:42:58.947
> 
> 标签：symfony, entity, parent-child, acl

我想在列出父实体时检查多个子实体的 acl 条目。

这就是当前的设置：

```
Gallery (parent)
    Gallerycategory (child)
    Gallerylanguage (child) 
```

*   每个用户组都有自己的角色。
*   创建 Gallerycategory 或 Gallerylanguage 时，我会列出所有应该访问该实体的组。
*   选中后，组会在 ACL 中为`Gallerycategory -> ROLE_(Usergroup)`关系获取一个 VIEW 条目。

现在，当我想列出我的画廊时，应该只显示允许的 Gallerycategory 或 Gallerylanguage 的条目。

实现这一目标的最佳方法是什么？进入存储库并检查当前用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:13:17.917

我想我想通了。

首先，我创建了一个名为**AclChildEntityInterface**的新接口。很简单：

```
interface AclChildEntityInterface{ 
    public function getAclChildren(); 
} 
```

我要检查子 ACL / ACE 的每个实体都实现它并返回一个函数数组以获取子实体。

```
class Gallery implements AclChildEntityInterface
{
    public function getAclChildren(){
        return array(
            'mediacategories' => 'getMediacategories',
            'medialanguages' => 'getMedialanguages',
        );
    }
} 
```

**注意：**数组值必须作为函数存在于当前实体类中。

之后，我创建了一个新的 AclVoter 来扩展`Symfony\Component\Security\Acl\Voter\AclVoter`：

类几乎相同，我只是改变了投票功能中的行为

`catch (AclNotFoundException $noAcl)`

```
use Symfony\Component\Security\Acl\Voter\AclVoter as BaseVoter;
...
use Develth\Prodcut\GalleryBundle\Entity\AclChildEntityInterface;

class MediaAclVoter extends BaseVoter
{
    ...
    public function vote(TokenInterface $token, $object, array $attributes)
    {
        ...
        } catch (AclNotFoundException $noAcl) {
            if (null !== $this->logger) {
                $this->logger->debug('No ACL found for the object identity. Voting to deny access.');
            }

            // Check if entity has childs to check
            if($object instanceof AclChildEntityInterface){
                $entityChilds = $object->getAclChildren();
                foreach ($entityChilds as $child) {
                    $childEntites = call_user_func( array($object,$child) );
                    foreach ($childEntites as $childEntity) {
                        $mapping =  $childEntity->getName();
                        $oid = $this->objectIdentityRetrievalStrategy->getObjectIdentity($childEntity);
                        try{
                            $acl = $this->aclProvider->findAcl($oid, $sids);
                            if($acl->isGranted($masks, $sids, false)){
                                // Has permission to view. show it. 
                                return self::ACCESS_GRANTED;
                            }
                        }catch(AclNotFoundException $noAcl){
                            // No ACL for this entity. Ignore
                        }catch(NoAceFoundException $noAce){
                            // No ACE for this entity. Ignore because other could have.
                        }
                    }
                }
            }

            return self::ACCESS_DENIED;
        } catch (NoAceFoundException $noAce) {
           ...

} 
```

这里会发生什么？

如果没有为当前实体找到 ACL，它会检查它是否是先前创建的 AclChildEntityInterface 的实例。它让每个 childAcl 检查并返回一个`ACCESS_GRANTED`是否找到 ACE。

**但仍有一些我不喜欢的东西，我认为它可以改进。**

在实现的实体类中，`AclChildEntityInterface`我想做这样的事情：

```
public function getAclChildren(){
    return array(
        'mediacategories' => $this->mediacategories,
        'medialanguages' => $this->medialanguages,
    );
 } 
```

或关于获取方法。

但是，如果我想访问 Voter 中的那些，我总是以主实体媒体作为所有者获得 PersistentCollection，因此我无法直接访问这些。这就是我使用`call_user_funk`.

我感谢改进！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T11:48:27.127

我刚刚发布了一个 Symfony 包，它基于 @develth 描述的方法论解决了确切的问题。

[https://github.com/GoDisco/AclTreeBundle](https://github.com/GoDisco/AclTreeBundle)

AclTree **[Bundle](https://github.com/GoDisco/AclTreeBundle)**允许您为 ACL 权限创建实体之间的层次关系。

# c# - 在 ObservableCollection 中编辑 listView 项调用 XamlParseException（需要 DependencyObject）-WPF

> ID：14248488
> 
> 赞同：0
> 
> 时间：2013-01-09T23:43:17.497
> 
> 标签：c#, wpf, listview, binding, edit

我是 C# 和 WPF 编程的初学者，我正在创建一个 2 `ListView`s 的文件管理器，所有项目都有界。里面有`ListView`一些`GridViewColumn`s 和 first has`CellTemplate`因为我想要文件/文件夹的图标及其名称。是`CellTemplate`：

```
<DataTemplate x:Key="IconTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Image Source="{Binding Path=itemIcon}" Width="20" Grid.Column="0"/>
                <TextBlock Grid.Column="1" Text="{Binding Path=itemName}" />
            </Grid>
        </DataTemplate> 
```

我有一个 Class : ObservableCollection ，其中所有目录和文件都添加到集合中，并且对于每个文件，它的图标都是从文件转换而来的。MyItem 类包含一些名称、扩展名等字符串和一个用于这些图标的 ImageSource。一切都很好，直到我意识到某些具有不同文件的文件夹由于转换了这些图标而冻结了程序。所以现在我为每个文件绑定了一些通用图标，然后我想在另一个线程中转换和更改它。所以在主类中，我为项目创建了全局 ObservableCollection，因为我不知道如何从 listView 加载它们，所以我将填充 Collection 函数从 Observable-class 移动到主类。现在我' 我能够从新线程更改列表视图中的项目，但 - 最后是我的问题 - 我得到 XamlParseException - 必须在与 DependencyObject 相同的线程上创建 DependencySource。当我尝试更改文件名（字符串）时，它运行良好（到目前为止，我仅在单击按钮时对其进行测试）！根据我在互联网上找到的一些参考资料，我尝试将dependencyObject 实现为 MyItem 类，但没有奏效。这个改变图标的​​功能。

```
for (int i = leftDirectories.Length; i < (leftDirectories.Length + leftFiles.Length); i++)
        {
            FileToImageIconConverter some = new FileToImageIconConverter(locationLeft + leftFiles[i - leftDirectories.Length].Name);
            ImageSource imgSource = some.Icon;
            leftFilesLoad[i].itemIcon = imgSource;
            this.Dispatcher.BeginInvoke(DispatcherPriority.Normal, (ThreadStart)delegate()
                    {
                        contentLeft.Items.Refresh();
                    }
            ); 
```

相当长的文章，stackoverflow 说要具体：-D。非常感谢所有试图帮助我的人。我期待着您的回复，我已准备好向您展示您需要的所有代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T05:51:43.110

发生异常是因为您`ImageSource`在非 UI 线程上创建。除非您冻结对象，否则您无法执行此操作。您将希望所有与 UI 相关的逻辑都包含在您的`BeginInvoke`调用中。试试这个

```
for (int i = leftDirectories.Length; i < (leftDirectories.Length + leftFiles.Length); i++)
{
           this.Dispatcher.BeginInvoke(DispatcherPriority.Normal, (ThreadStart)delegate()
           {
               FileToImageIconConverter some = new FileToImageIconConverter(locationLeft + leftFiles[i - leftDirectories.Length].Name);
               ImageSource imgSource = some.Icon;
               leftFilesLoad[i].itemIcon = imgSource;
               contentLeft.Items.Refresh();
            }
    );
} 
```

这应该将所有与 UI 相关的活动保留在 UI 线程上。

# javascript - 使用 jQuery 加载脚本时保持范围

> ID：14248491
> 
> 赞同：4
> 
> 时间：2013-01-09T23:43:49.887
> 
> 标签：javascript, jquery, ajax, scope

假设我有一个包含以下内容的文件“test.js”：

```
var test = 'something'; 
```

然后我有一个需要加载 test.js 来获取测试变量的主脚本。

显然这有效：

```
$.ajax({dataType: "script", cache: true, url: 'test.js'}); 
```

问题是变量`test`存在于全局范围内。我很好奇是否有办法将它添加到对象中并将其排除在全局范围之外。

就像是：

```
function scriptloader() {
    this.grabscript = function() {
        return $.ajax({dataType: "script", cache: true, url: 'test.js'});
    }
}

var myloader = new scriptloader();

myloader.grabscript(); 
```

理想情况下 myloader 将包含加载的变量`test`。但是，我可以 console.log(test) 并且仍然看到“某些东西”。

有没有办法将加载的脚本锁定在范围内，还是我在做梦？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T00:04:30.957

你可以尝试这样的事情：

```
function scriptloader() {
  this.grabscript = function() {
    var loader = this;
    $.ajax('test.js', {
      complete: function(response) {
        var js = '(function() {' + response.responseText + ' loader.test = test; })();'
        eval(js);
      },
      dataType: 'text'
    });
  }
} 
```

然后该`scriptloader`实例将获得一个名为 的属性`test`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:54:43.163

您可以`eval`为此目的使用并在本地范围内创建一个具有预期名称的变量：

```
(function(jsString) {
    var test;
    eval(jsString);
    console.log(test); // 'something'
})("var test = 'something';");
console.log(test); // Exception: undefined variable 
```

然后，您需要使用该自定义函数而不是[ajax 中用于脚本](https://github.com/jquery/jquery/blob/master/src/ajax/script.js)[`$.globalEval`](http://api.jquery.com/jQuery.globalEval/)的（[代码](https://github.com/jquery/jquery/blob/master/src/core.js#L508)）。

当然，这不是对每个全局变量都适用的方法，因为您需要创建一个单独的全局对象（例如使用`<iframe>`）来评估那里的脚本。

但是，使用 JSONP 可能比使用变量更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T00:20:22.487

如果您无法控制 test.js，并且必须接受将 test 声明为全局变量，则解决方法是将 test.js 加载到页面内的 iframe 中。这种方式 test 将是一个全局变量，但仅在 iframe 窗口的范围内。在您的主页上，您将能够以`ifr.contentWindow.test`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-23T11:23:04.123

您可以尝试扩展页面上已经存在的对象。

假设您的页面上有这样的脚本

```
var app = {
    loadedScripts
    ,loadPageScript : function(scriptUrl, cb) {
        $.getScript(scriptUrl, cb)
            .fail(function( jqxhr, settings, exception ) {
                console.log(exception);
        })
    }
}

app.loadPageScript('/test.js', function(){
    app.loadedScripts['test']();
}); 
```

您的 test.js 文件：

```
if(!app.loadedScripts.test){
    app.loadedScripts.test = function() {

        app.someVar = 1;

        app.someFunction = function(){
            console.log('iha');
        };
    }
} 
```

# iphone - Cocos2d 应用 EXC_BAD_ACCESS 崩溃，不显示 bt 显示的内容

> ID：14248496
> 
> 赞同：2
> 
> 时间：2013-01-09T23:44:14.727
> 
> 标签：iphone, ios, cocos2d-iphone

我正在编写一个应用程序，我绞尽脑汁想弄清楚为什么它会一直崩溃。我认为这与计时器有关，但我不确定 bt 代码的含义。如果有人可以提供帮助，我将不胜感激。

```
* thread #1: tid = 0x1c03, 0x01e3f051 libobjc.A.dylib`_cache_getImp + 9, stop reason = EXC_BAD_ACCESS (code=1, address=0xd0000008)
frame #0: 0x01e3f051 libobjc.A.dylib`_cache_getImp + 9
frame #1: 0x01e2cac4 libobjc.A.dylib`lookUpMethod + 42
frame #2: 0x01e2ca88 libobjc.A.dylib`class_respondsToSelector + 65
frame #3: 0x0213b0d3 CoreFoundation`objectIsKindOfClass + 51
frame #4: 0x021c4087 CoreFoundation`__handleUncaughtException + 71
frame #5: 0x01e2e0b9 libobjc.A.dylib`_objc_terminate() + 86
frame #6: 0x01f4ca65 libc++abi.dylib`safe_handler_caller(void (*)()) + 13
frame #7: 0x01f4cacd libc++abi.dylib`std::terminate() + 23
frame #8: 0x01f4dc4e libc++abi.dylib`__cxa_rethrow + 83
frame #9: 0x01e2dfbd libobjc.A.dylib`objc_exception_rethrow + 47
frame #10: 0x020e0f98 CoreFoundation`CFRunLoopRunSpecific + 360
frame #11: 0x020e0e1b CoreFoundation`CFRunLoopRunInMode + 123
frame #12: 0x02e427e3 GraphicsServices`GSEventRunModal + 88
frame #13: 0x02e42668 GraphicsServices`GSEventRun + 104
frame #14: 0x00a5f4fc UIKit`UIApplicationMain + 1211
frame #15: 0x000f75af Carnivale`main(argc=1, argv=0xbffff3a4) + 127 at main.m:14
frame #16: 0x00002ba5 Carnivale`start + 53 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:38:15.697

可能访问已释放的对象。你可以尝试开启 NSZombiesEnabled：

> 在 Xcode 4.x 中按
> 
> alt-命令-R
> 
> 选择“诊断”选项卡并单击“启用僵尸对象”：

这会将释放的对象转换为 NSZombie 实例，在再次使用时会打印控制台警告。这是一种调试辅助工具，可以增加内存使用（没有真正释放对象），但可以改进错误报告。

# ruby-on-rails - 带有 Plesk 11、nginx 作为反向代理和 apache 的 Ubuntu 10.04 上的 Rails 3.2 应用程序

> ID：14248498
> 
> 赞同：0
> 
> 时间：2013-01-09T23:44:22.230
> 
> 标签：ruby-on-rails, ruby, nginx, unicorn, plesk

我有一个来自 Hosteurope 的带有 Ubuntu 10.04 的虚拟服务器。Plesk 11.0.9 已安装。nginx 作为反向代理启动。

在我的本地 Ubuntu 安装中，我安装了一个 rails 应用程序：rvm、ruby 1.9.3、rails 3.2.10、nginx、unicorn。一切正常。

我的问题是，是否有机会在 Plesk 11 上安装带有 nginx 和 unicorn 的 rails 应用程序？

有人成功管理过这个吗？

或者有没有更好的方法在带有 Plesk 11 的 Ubuntu 上运行 rails 应用程序？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T18:31:10.423

**更新：** 好的，我可以同时使用 nginx + Thin 和 nginx + 乘客。以下是开始的步骤 (Plesk 11)：

1.  在 Plesk 中停止 nginx（工具和设置 => 服务管理）
2.  通过以下方式从命令行卸载 Plesk 的 nginx：yum remove sw-nginx
3.  从源代码或通过他们的 RPM 安装 nginx

我现在正在尝试解决这个问题，据我所知，Plesk 使用 nginx 作为反向代理，并且使用 nginx 配置做了很多奇怪的事情。我无法使用 nginx + Thin 让它工作。我也在尝试 apache + 乘客或 nginx + 乘客。

我没有明确的答案，但似乎不可能（至少使用 nginx）。

# c++ - Opengl 3.3 c++ 运行时错误'向量下标超出范围'

> ID：14248503
> 
> 赞同：2
> 
> 时间：2013-01-09T23:44:41.970
> 
> 标签：c++, runtime-error, opengl-3

我的程序编译得很好，但是当我尝试执行它时，我得到了一个奇怪的错误。我已经包含了错误的图片。另外我想提一下，这个源代码来自一个在线 openGL 教程，在这里可以找到[http://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/](http://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/)

错误图片：

[http://postimage.org/image/i6ernf8d7/](http://postimage.org/image/i6ernf8d7/)

[http://postimage.org/image/dvywy86xf/full/](http://postimage.org/image/dvywy86xf/full/)

这是我的源代码：

片段着色器

```
#version 330 core

// Ouput data
out vec3 color;

void main()
{

    // Output color = red 
    color = vec3(1,0,0);

} 
```

顶点着色器

```
#version 330 core

// Input vertex data, different for all executions of this shader.
layout(location = 0) in vec3 vertexPosition_modelspace;

void main(){

    gl_Position.xyz = vertexPosition_modelspace;
    gl_Position.w = 1.0;

} 
```

着色器.hpp

```
#include <stdio.h>
#include <string>
#include <vector>
#include <fstream>
#include <GL/glew.h>

GLuint LoadShaders(const char * vertex_file_path, const char * fragment_file_path){

    // Create the shaders
    GLuint VertexShaderID = glCreateShader(GL_VERTEX_SHADER);
    GLuint FragmentShaderID = glCreateShader(GL_FRAGMENT_SHADER);

    // Read the Vertex Shader code from the file
    std::string VertexShaderCode;
    std::ifstream VertexShaderStream(vertex_file_path, std::ios::in);
    if(VertexShaderStream.is_open())
    {
        std::string Line = "";
        while(getline(VertexShaderStream, Line))
            VertexShaderCode += "\n" + Line;
        VertexShaderStream.close();
    }

    // Read the Fragment Shader code from the file
    std::string FragmentShaderCode;
    std::ifstream FragmentShaderStream(fragment_file_path, std::ios::in);
    if(FragmentShaderStream.is_open()){
        std::string Line = "";
        while(getline(FragmentShaderStream, Line))
            FragmentShaderCode += "\n" + Line;
        FragmentShaderStream.close();
    }

    GLint Result = GL_FALSE;
    int InfoLogLength;

    // Compile Vertex Shader
    printf("Compiling shader : %s\n", vertex_file_path);
    char const * VertexSourcePointer = VertexShaderCode.c_str();
    glShaderSource(VertexShaderID, 1, &VertexSourcePointer , NULL);
    glCompileShader(VertexShaderID);

    // Check Vertex Shader
    glGetShaderiv(VertexShaderID, GL_COMPILE_STATUS, &Result);
    glGetShaderiv(VertexShaderID, GL_INFO_LOG_LENGTH, &InfoLogLength);
    std::vector<char> VertexShaderErrorMessage(InfoLogLength);
    glGetShaderInfoLog(VertexShaderID, InfoLogLength, NULL, &VertexShaderErrorMessage[0]);
    fprintf(stdout, "%s\n", &VertexShaderErrorMessage[0]);

    // Compile Fragment Shader
    printf("Compiling shader : %s\n", fragment_file_path);
    char const * FragmentSourcePointer = FragmentShaderCode.c_str();
    glShaderSource(FragmentShaderID, 1, &FragmentSourcePointer , NULL);
    glCompileShader(FragmentShaderID);

    // Check Fragment Shader
    glGetShaderiv(FragmentShaderID, GL_COMPILE_STATUS, &Result);
    glGetShaderiv(FragmentShaderID, GL_INFO_LOG_LENGTH, &InfoLogLength);
    std::vector<char> FragmentShaderErrorMessage(InfoLogLength);
    glGetShaderInfoLog(FragmentShaderID, InfoLogLength, NULL, &FragmentShaderErrorMessage[0]);
    fprintf(stdout, "%s\n", &FragmentShaderErrorMessage[0]);

    // Link the program
    fprintf(stdout, "Linking program\n");
    GLuint ProgramID = glCreateProgram();
    glAttachShader(ProgramID, VertexShaderID);
    glAttachShader(ProgramID, FragmentShaderID);
    glLinkProgram(ProgramID);

    // Check the program
    glGetProgramiv(ProgramID, GL_LINK_STATUS, &Result);
    glGetProgramiv(ProgramID, GL_INFO_LOG_LENGTH, &InfoLogLength);
    std::vector<char> ProgramErrorMessage( glm::max(InfoLogLength, int(1)) );
    glGetProgramInfoLog(ProgramID, InfoLogLength, NULL, &ProgramErrorMessage[0]);
    fprintf(stdout, "%s\n", &ProgramErrorMessage[0]);

    glDeleteShader(VertexShaderID);
    glDeleteShader(FragmentShaderID);

    return ProgramID;
} 
```

主文件

```
#include <stdio.h>
#include <stdlib.h>

#include <GL/glew.h>
#include <GL/glfw.h>
#include <glm/glm.hpp>
using namespace glm;

#include <iostream>
using namespace std;

#include "shader.hpp"

int main()
{

    if( !glfwInit() )
    {
        fprintf( stderr, "Failed to initialize GLFW\n" );
        return -1;
    }

    glfwOpenWindowHint(GLFW_FSAA_SAMPLES, 4); // 4x antialiasing
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3); // We want OpenGL 3.3
    glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
    glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); //We don't want the old OpenGL

    // Open a window and create its OpenGL context
    if( !glfwOpenWindow( 1024, 768, 0,0,0,0, 32,0, GLFW_WINDOW ) )
    {
        fprintf( stderr, "Failed to open GLFW window\n" );
        glfwTerminate();
        return -1;
    }
    else
    {
        glfwSetWindowTitle( "Tutorial 01" );
    }

    // Initialize GLEW
    glewExperimental=true; // Needed in core profile
    if (glewInit() != GLEW_OK) {
        fprintf(stderr, "Failed to initialize GLEW\n");
        return -1;
    }

    glfwEnable( GLFW_STICKY_KEYS );

    glClearColor(0.3f, 0.5f, 0.9f, 0.0f);

    GLuint VertexArrayID;
    glGenVertexArrays(1, &VertexArrayID);
    glBindVertexArray(VertexArrayID);

    // Create and compile our GLSL program from the shaders
    GLuint programID = LoadShaders( "vertex.shader", "fragment.shader" );

    static const GLfloat g_vertex_buffer_data[] = { 
        -1.0f, -1.0f, 0.0f,
         1.0f, -1.0f, 0.0f,
         0.0f,  1.0f, 0.0f,
    };

    GLuint vertexbuffer;
    glGenBuffers(1, &vertexbuffer);
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);

    do{

        // Clear the screen
        glClear( GL_COLOR_BUFFER_BIT );

        // Use our shader
        glUseProgram(programID);

        // 1rst attribute buffer : vertices
        glEnableVertexAttribArray(0);
        glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
        glVertexAttribPointer(
            0,                  // attribute 0\. No particular reason for 0, but must match the layout in the shader.
            3,                  // size
            GL_FLOAT,           // type
            GL_FALSE,           // normalized?
            0,                  // stride
            (void*)0            // array buffer offset
        );

        // Draw the triangle !
        glDrawArrays(GL_TRIANGLES, 0, 3); // 3 indices starting at 0 -> 1 triangle

        glDisableVertexAttribArray(0);

        // Swap buffers
        glfwSwapBuffers();

    } // Check if the ESC key was pressed or the window was closed
    while( glfwGetKey( GLFW_KEY_ESC ) != GLFW_PRESS &&
    glfwGetWindowParam( GLFW_OPENED ) );

    // Close OpenGL window and terminate GLFW
    glfwTerminate();

    // Cleanup VBO
    glDeleteBuffers(1, &vertexbuffer);
    glDeleteVertexArrays(1, &VertexArrayID);

    return 0;
} 
```

我在 openGL 和 c++ 方面没有丰富的经验，所以如果我错过了一些建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T01:46:42.127

第 47 行的矢量索引超出范围。调试时检查向量的大小是否符合预期。

考虑使用`data()`而不是获取第一个元素的地址。

```
VertexShaderErrorMessage.data() 
```

代替

```
&VertexShaderErrorMessage[0] 
```

但是，如果向量为空，这将无法解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-04T04:59:11.287

您的程序在发布模式下运行良好吗？

我的 OpenGL 程序在发布模式下运行良好，但在调试模式下会因此断言报告而崩溃。我绕过了这个问题，因为我无法弄清楚代码中出了什么问题……我的意思是我花了一整天的时间来解决这个问题。我所做的是将Release 配置中的项目属性复制到我命名为DebugNoHiccup 的新配置中。然后为了使其适合调试，我禁用代码优化以允许单步执行代码。

# php - Laravel 4 中的嵌套控制器

> ID：14248506
> 
> 赞同：0
> 
> 时间：2013-01-09T23:44:55.747
> 
> 标签：php, laravel

我只是在尝试新的 Laravel 4，但似乎无法理解嵌套控制器的方法。Laravel 4 中是否仍然存在嵌套控制器，那么我将如何在路由文件中路由到它们？

在我的 Laravel 3 应用程序中，我使用了 Controller::detect() 并且我的所有嵌套路由都被拾取，但我知道这个功能已从 Laravel 4 中删除？

我只是在路由文件中明确定义每个 Route::resource 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T06:02:12.037

为简洁起见：

> Route::controller('example', 'ExampleController');
> 
> Route::get('example', array('uses' => 'ExampleController@getIndex');

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T18:15:25.893

根据您确实需要明确路由每个资源的文档：http: [//four.laravel.com/docs/controllers#resource-controllers](http://four.laravel.com/docs/controllers#resource-controllers)

# javascript - 我的 JavaScript 函数出了什么问题

> ID：14248509
> 
> 赞同：-1
> 
> 时间：2013-01-09T23:44:59.637
> 
> 标签：javascript

我正在本网站上的 FireFox 的 JavaScript 控制台中测试此功能： [http](http://www.google.com/search?hl=en&tbo=d&output=search&sclient=psy-ab&q=python) ://www.google.com/search?hl=en&tbo=d&output=search&sclient=psy-ab&q= python 所需的输出只是文本（.innerHTML）每个链接的。

```
 parents = document.getElementsByClassName("r");
    function my_links() {
        links = {};
        for (var i=0; i<parents.length; i++) {
            links[i] = parents[i].getElementsByTagName("a")[0];
        };
        return links;
    }
    elements = my_links();
    for (var i=0; i<elements.length; i++) {
        g_link = elements[i].innerHTML;
        console.log(g_link + "\n");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T23:48:40.880

您确实为变量分配了一个空*对象*，但是当您稍后访问它的属性时，我猜您希望它是一个*数组*。将其更改为`links``length`

 *```
 links = []; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:54:53.303

```
var parents = document.getElementsByClassName("r");
function my_links() {
    var links = []; // <-- I suppose it should be array and should not be global
    for (var i=0; i<parents.length; i++) {
        // when you're not defining array length then use push instead of indexes
        links.push(parents[i].getElementsByTagName("a")[0]);
    };
    return links;
} 
```

你可以以更有效的方式做到这一点

```
function my_links() {
     var links = new Array(parents.length),
         i = parents.length;
     while (i--) {
         links[i] = parents[i].getElementsByTagName("a")[0];
     }
     return links;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T23:55:05.460

变量`links`（等等`elements`）是一个对象，而不是一个数组，所以你不能得到它的长度。您可以将其更改为数组（这可能是您想要做的，`links=[]`而不是`links = {}`），或者您可以使用 foreach 循环记录`elements`对象的所有属性：

```
for (i in elements) {
    g_link = elements[i].innerHTML;
    console.log(g_link + "\n");
} 
```*

# sql - 将正确的常量值分配给查询中的相应行

> ID：14248513
> 
> 赞同：0
> 
> 时间：2013-01-09T23:45:21.277
> 
> 标签：sql, database

我有我的查询，我声明了 2 个常量值假设 112 和 78，因此它显示为 2 列，即商店和超市，我还有另一个列名customers_type，他们通常在商店和超市购物。所以我的商店常量值为112 和 Supermarket 是 78，我的最后一列 Customers_type 有 3 种类型，oldies、youth 和 children..for oldies 和 Youth 都有相同的常量值，112 和 children 有 78。当我运行查询时的问题是两者的值store(112) 和 Supermarket(78) 显示在我的所有行中，但未分配到正确的行，如果 store(112) 则应仅分配给老人和青少年，而 Supermarket(78) 仅分配给儿童

我希望我的解决方案类似于下面的解决方案

```
store | supermarket  |customers_type

112   |   0          |       oldies

112   |   0          |      youth

0     |  78          |      children 
```

# linux - 什么可能导致 Linux“ls”命令返回 seg 错误？

> ID：14248514
> 
> 赞同：1
> 
> 时间：2013-01-09T23:45:36.637
> 
> 标签：linux, segmentation-fault

我正在安装一些新软件。它在“Lib”目录中包含多个库。如果我`ls Lib`来自*另一个*目录，我会得到通常的文件列表。我也可以发出命令`dir`并`file`获得合理的结果。我什至可以将文件从这个目录复制到其他目录。*但是如果我 cd 到“Lib”，我给出的任何*linux 命令似乎都会返回一个 seg 错误。我无法在该目录中运行`ls`、`file`或。如果没有段错误，`dir`我什至不能在那里运行。`date`如果有人能帮助我解开这个谜团，我将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-09T23:58:40.313

可能您的[LD_LIBRARY_PATH](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)包含一个点 /`.`并且该`Lib`目录包含像 libc 这样的标准库，因此无论您发出什么命令，系统都会从该路径中选择一个库并且出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-14T11:55:41.910

在我的 rpi 上，我今天观察到同样的问题：

```
$ ls
Segmentation fault 
```

它为我解决的是：

`sudo apt-get dist-upgrade`

# asp.net - 如何从 web.config 中读取系统值并在 ASP.NET MVC C# 方法中使用

> ID：14248515
> 
> 赞同：33
> 
> 时间：2013-01-09T23:45:37.113
> 
> 标签：asp.net, asp.net-mvc-3, iis-7, web-config, configurationmanager

我正在开发一个最大上传大小为 100MB 的 ASP.NET MVC3 Web 应用程序（不是我编写的）。现在这个 Web 应用程序被安装在客户的服务器机器上，所以如果这个值最大上传大小可以为每个客户配置，那就太好了。如果需要，他们有权编辑 Web 应用程序的 web.config。

现在 web.config 中有一个值，如下所示：

```
<system.webServer>
    <security>
        <requestFiltering>
            <requestLimits maxAllowedContentLength="104857600" />
        </requestFiltering>
    </security>
</system.webServer> 
```

这里还有另一个值似乎相似：

```
<system.web>
    <httpRuntime maxRequestLength="104857600" executionTimeout="360" />
</system.web> 
```

104857600 字节似乎是 100MB 文件上传限制。但是，在更改值时，我发现这不是权威值，也没有遵守新的限制。因此，经过更多挖掘后，我发现 C# 代码中的其他地方是一个硬编码值`public const double MaxContentSize = 104857600`，而另一种 C# 方法正在使用该值来接受/拒绝 Ajax 文件上传。

所以我想我想做的是替换代码中的硬编码数字，以便它从 web.config 中的值读取。然后，至少任何人都可以在部署网站时更改 web.config 中的该值。

你能做这样的事情吗？

```
MaxContentSize = ConfigurationManager.systemWeb.httpRuntime['maxRequestLength']; 
```

我在 web.config 中看到了一些使用 appSettings 的示例，例如

```
<appSettings><add key="MySetting" value="104857600" /></appSettings> 
```

然后像这样访问它：

```
ConfigurationManager.AppSettings["MySetting"] 
```

但这意味着在其中添加一个自定义值，现在我们在 web.config 中有 3 个地方可以更改它。任何人都知道如何正确地做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-01-10T01:24:10.150

您可以执行以下操作：

```
int maxRequestLength = 0;
HttpRuntimeSection section =
ConfigurationManager.GetSection("system.web/httpRuntime") as HttpRuntimeSection;
if (section != null) 
    maxRequestLength = section.MaxRequestLength; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-10T01:49:31.363

似乎没有简单的方法来阅读 system.webServer 部分，因为它在 machine.config 中被标记为“忽略”。

一种方法是直接解析 web.config 文件的 XML：

```
var config = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);
var section = config.GetSection("system.webServer");
var xml = section.SectionInformation.GetRawXml();
var doc = XDocument.Parse(xml);
var element = doc.Root.Element("security").Element("requestFiltering").Element("requestLimits");
string value = element.Attribute("maxAllowedContentLength").Value; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-10T01:34:23.253

尝试：

```
var config = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration("/")
var section = (System.Web.Configuration.SystemWebSectionGroup)config.GetSectionGroup("system.web")
var maxRequestLength = section.HttpRuntime.MaxRequestLength 
```

# linux - 请解释一下linux命令：find /tmp -name core -type f -print | xargs /bin/rm -f

> ID：14248516
> 
> 赞同：-2
> 
> 时间：2013-01-09T23:45:42.640
> 
> 标签：linux, find, gnome-terminal

我一直在整个谷歌寻找这些命令的解释

```
find /tmp -name core -type f -print | xargs /bin/rm -f 
```

好吧，我从网络本身得到了命令，并且那里也提到了解释。现在我知道该命令用于在名为“tmp”的目录中查找名为“core”的文件并删除该文件。我已经使用并检查了它，它工作得很好。

我的问题是我无法理解此命令中使用的术语，例如 -type f 和 xargs 的作用？还有如何根据我们的需要生成这样的命令（除非正确理解，否则显然不能），最大的问题是在谷歌中写什么以获得关于这个的帮助......我的意思是在什么主题下我可以期待这些。

请帮忙

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:08:00.207

这是一串unix命令：

```
 find           // name of command (in this case, "find")

 arguments to 'find':
    /tmp        // where to look
    -name core  // name to look for, "core" (optional argument)
    -type f     // files only (not, eg, directories or files contents) 
                // (optional argument)
    -print      // output the list to standard output (STDOUT)

|               // name of command (otherwise known as
                // 'pipe') this is a little program that
                // takes the output from a previous process
                // (in this case, the output from 'find')
                // and pass it to another process as input  

 xargs          // name of command ('xargs') the program
                // that will accept the output from 'print'
                // as input (directed by 'pipe'). It provides
                // a robust way to process indefinitely
                // long lists by breaking them into smaller
                // lists and passing each sublist through
                // to its command argument

 /bin/rm        // name of command for xargs to execute 
                // on its input list ('rm' = remove)
      -f        // argument to rm, only remove files, not directories. 
```

这就是 unix 的工作原理，它由许多具有模糊的 2 个字母名称的小型单一用途程序组成，这些程序专门用于一项任务。您将它们串在一起以完成更复杂的任务。

找出任何一个命令的作用的正确方法是使用“man”命令并将相关命令名称作为参数，例如

```
man find
man xargs
man rm 
```

您将获得描述每个输入选项和输出可能性的详细信息页面。像“xargs”这样的名字也很容易用谷歌搜索，但可以理解的是“find”不是（也许试试“unix find”）。他们中的许多人都有维基百科页面......

也许您应该获得一份体面的 unix 指南...

# jquery - 将 标签转换为空白的 jQuery .text() 等效项

> ID：14248519
> 
> 赞同：15
> 
> 时间：2013-01-09T23:46:08.820
> 
> 标签：jquery, html, whitespace, line-breaks

从 jQuery 选择中获取文本很简单：

```
<span id="foo">hello world</span>

$('#foo').text(); 
```

> `hello world`

但是当 jQuery 选择包含`<br>`标签时，它们在概念上是换行符，即空格。不幸的是`.text()`，它们完全剥离了它们：

```
<span id="foo">hello<br>world</span>

$('#foo').text(); 
```

> `helloworld`

我怎样才能从这样的跨度中提取文本以使其产生结果`hello world`？

当然，这是为保持问题清晰而发明的一个微不足道的例子。当然，真正的答案需要“等效于`.text()`”并处理任意 HTML。这是一个稍微复杂一点的例子，也是编造的：

```
<div id="foo"><span class="bar"><em>hello</em><br></span>world</div> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T00:01:47.990

正如 Mims 建议`replaceWith()`的那样，用于更改`<br>`to 空格，但不要更改原始元素`clone()`，用于制作元素的克隆。

```
var foo = $("#foo").clone();
foo.find("br").replaceWith(" ");
var text = foo.text(); 
```

[**演示**](http://jsfiddle.net/mowglisanu/EQwt6/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-09T23:48:02.483

使用 `.html()`代替`.text()`

```
$('#foo').html(); 
```

或者使用 DOM 方法`.innerText`

```
$('#foo')[0].innerText ; 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/gavZs/)**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-09T23:54:25.567

您可以使用该`replaceWith()`功能。

```
$("br").replaceWith(" "); 
```

# xml - Firefox 和 Chrome 中 XMLSerializer 的细微差别？

> ID：14248526
> 
> 赞同：1
> 
> 时间：2013-01-09T23:46:33.713
> 
> 标签：xml, json, google-chrome, firefox, xmlserializer

以下代码片段使用 createDocument 和 XMLSerializer API 将 Javascript 对象转换为 XML 字符串。问题是它在 Chrome (23.0.1271.101) 和 Firefox (14.0.1) 浏览器上生成不同的输出。

```
var item = { _dto: {...} }; // the 'model' object
var xmlDto = $('<Column />'); // this is eventually serialized and sent to the server
var optionalTags = ['Abstract', 'Note', 'Size', 'Digits', 'Nullable', 'AutoUpdate', 'DataType'];

// convert badgerfish JSON back to XML.
// use XML because it is not possible serialize JSON and preserve key order.
var xmlDoc = document.implementation.createDocument("http://example.org/v1", "Column", null);
var root = xmlDoc.childNodes[0];
var nameTag = xmlDoc.createElement("Name");
nameTag.setAttribute('uuid', item._dto['Name']['@uuid']);
nameTag.textContent=item._dto['Name']['$'];
root.appendChild(nameTag);
optionalTags.map(function (tagName) {
    var tag = xmlDoc.createElement(tagName);
    tag.textContent=item._dto[tagName];
    if (item._dto.hasOwnProperty(tagName)) {
        tag.textContent=item._dto[tagName];
        root.appendChild(tag);
    }
});

var xmlStr = new XMLSerializer().serializeToString(xmlDoc);
xmlStr = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+xmlStr; 
```

在 Chrome 上，会生成以下所需/预期的输出：

```
 <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <Column xmlns="http://example.org/v1">
          <Name uuid="001b5cbe-bab7-4880-90b6-9e8f47f6e4af">FAILED_ID</Name>
          <Size>38</Size>
          <Digits>0</Digits>
          <Nullable>true</Nullable>
          <AutoUpdate>false</AutoUpdate>
          <DataType>NUMERIC</DataType>
    </Column> 
```

但在 Firefox 中，生成的输出`xmlns`在每个标签中插入了一个空值的属性：

```
 <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
     <Column xmlns="http://example.org/v1">
          <Name xmlns="" uuid="001b5cbe-bab7-4880-90b6-9e8f47f6e4af">FAILED_ID</Name>
          <Size xmlns="">38</Size>
          <Digits xmlns="">0</Digits>
          <Nullable xmlns="">true</Nullable>
          <AutoUpdate xmlns="">false</AutoUpdate>
          <DataType xmlns="">NUMERIC</DataType>
     </Column> 
```

看起来 Firefox 和 Chrome 中的 XMLSerializer 有细微的差异，但我需要验证这一点。在任何情况下，Firefox 输出都是无效的 XML。有人可以对此有所了解吗？

有没有更好的方法在浏览器中生成 XML 文档？

如果首先我有一种方法可以序列化为 JSON 并能够保留密钥顺序，我就不会这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T07:08:38.473

Firefox 序列化是正确的。当您使用`createElement`, not创建这些元素时，会将它们置于 null 命名空间中（您可以在创建元素后`createElementNS`通过检查元素来检查）。`namespaceURI`然而，解析 Chrome 产生的序列化会将它们放在`http://example.org/v1`命名空间中。

是的，Firefox 输出是有效的 XML。是什么让你认为它无效？

我提交了[https://bugs.webkit.org/show_bug.cgi?id=106531](https://bugs.webkit.org/show_bug.cgi?id=106531)

# perl - 忽略 Perl END 块中的错误

> ID：14248536
> 
> 赞同：3
> 
> 时间：2013-01-09T23:47:33.823
> 
> 标签：perl, exception-handling

如何忽略`die()`出现在 Perl`END`块中的 a？

现在我得到了

> END 失败--呼叫队列中止

并且错误冒泡了调用脚本。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T23:50:30.197

将您的结束块放在一个`eval { .... }`- 这应该可以防止您描述的行为。

```
#!/usr/bin/perl

print("hi there!\n");

END {
    eval{
        print("goodbye\n");
        die("this can't hurt....");
    };

    #detect if an error occurred in the eval
    if ( $@ ){
        print ("an error occurred: $@\n");
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T01:18:37.723

将您的代码放在 eval 块内，如果您想检索 die 提供的错误消息，您可以使用块外的 if 条件捕获。

```
#!/usr/bin/perl
my $val=1;
eval
{
   print "Inside Eval\n";
   if($val == 1)
   {
     die "hello world\n";
   }
   print "End of Eval\n";
};
if ( $@ )
{
         print  "Error message - $@" . "\n";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T01:03:38.027

[`Try::Tiny`](https://metacpan.org/module/Try%3a%3aTiny)是一个优秀的包装器`eval`，允许你显式地处理运行时异常。

# c++ - 为什么我的 C++ 程序会打印额外的换行符？

> ID：14248544
> 
> 赞同：3
> 
> 时间：2013-01-09T23:48:23.343
> 
> 标签：c++

好吧，我已经在这几个小时了....

```
//after a character is entered, library routines are used to uppercase the
letters. loops the program until "1" is entered

char letter;

while (letter != '1')
{
    cout << "Enter a letter: ";
    cin.get(letter);
    cout << char(toupper(letter)) << '\n';
} 
```

一切正常，但它会“输入一个字母：”两次......

这是一个示例输出

```
Enter a letter: h
H
Enter a letter: 

Enter a letter: k
K
Enter a letter: 

Enter a letter: a
A 
```

我希望它看起来像这样

```
Enter a letter: h
H
Enter a letter: k
K
Enter a letter: a
A 
```

你能帮忙解释一下为什么会这样吗......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-09T23:52:17.333

输入数据时，键入字母，然后按`ENTER`。这会将您的字母以及返回字符 ( `\n`) 添加到流中。由于`cin.get()`当仍有字符要从流中提取时不会等待您的输入，所以它会`\n`每隔一次传递。

您可以通过添加以下内容快速解决此问题`cin.ignore`：

```
while (letter != '1')
{
    cout << "Enter a letter: ";
    cin.get(letter);
    cin.ignore(256, '\n');
    cout << char(toupper(letter)) << '\n';
} 
```

一种替代方法是使用`>>`运算符，因为`cin.get`一次只检索一个字符：

```
while (letter != '1')
{
    cout << "Enter a letter: ";
    cin >> letter;
    cout << char(toupper(letter)) << '\n';
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:53:00.737

只需将 更改`cin.get(letter)`为`cin >> letter;`，它就会按预期工作。

**编辑：**以为我会提供更多有关此的信息。get() 从流中准确提取一个字符，正如其他人指出的那样，这将把换行符留在其中。对 get() 的下一次调用将提取它并立即终止，而不是等待输入，因为流仍然有数据。`>>`另一方面， -operator 正是为您在此处尝试执行的操作而制作的：从 stdin 读取一个值，直到按下返回键。所以它也消耗换行符，导致下一次调用`operator<<()`阻塞，直到用户输入新数据。

**注意：**还有一件事要记住：-`>>`提取到一个字符将最多从流中提取一个字符，但它不会阻止用户在按 Enter 之前输入更多字符。这将产生一些输出，如下所示：

```
niko@lethal-guitar:~$ ./a.out 
Enter a letter: a
A
Enter a letter: asas
A
Enter a letter: S
Enter a letter: A
Enter a letter: S 
```

这是因为操作员删除了一个字符和换行符，但将剩余的字符保留在流中。这些将立即终止接下来的三个`operator>>()`调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T00:20:28.290

对于初学者，因为您不检查是否`cin.get`成功。你几乎肯定会输出你读过两次的最后一个字符。你的循环应该是：

```
while ( letter != '1' && cin.get( letter ) ) ... 
```

或者

```
while ( cin.get( letter ) && letter != '1' ) ... 
```

还要注意，在大多数系统上，`cin.get()`在您按 Enter 之前不会返回（假设从键盘输入）。所以你会输出`"Enter a letter: "`，然后等到按下回车键。然后，您无需等待即可循环，读取您输入的所有字符，直到您读取`'\n'`. C++ 标准中没有按字符输入的规定，而且执行此操作的技术因系统而异。

# html - 正则表达式：根据各种数字范围添加书签 html 标签

> ID：14248545
> 
> 赞同：0
> 
> 时间：2013-01-09T23:48:27.133
> 
> 标签：html, regex, numbers, notepad++, replace

我有一些带有许多经文的 html 页面，例如：

```
verses 2-5
verses 11-15
verses 21-23 
```

我需要在“诗句”一词之前为每个数字添加一个代码

```
<a name="2"></a><a name="3"></a><a name="4"></a><a name="5"></a>verses 2-5 
```

等等

所以它采用给定数字的范围，并在开始之前添加：

```
<a name=""></a> 
```

对于范围内的每个数字..

我使用记事本++进行搜索和替换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:37:09.660

您可以像这样对 10 到 99 的 2 位数诗句执行此操作：

```
Search: verses (\d)(\d)-
Replace: <a name="$1">verses $1$2-</a> 
```

对于 3 位以上的数字，为多余的数字添加另一组并进行类似处理。

这个额外的复杂性是必需的，因为 notepad++ 不支持前瞻 AFAIK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T02:52:06.573

您将需要一个脚本来执行此操作。我编写了一个简单的 Ruby 脚本来完成它。在您的示例文本上使用它，得到您的输出。只需下载 Ruby，将其粘贴到该文本目录中的文件中，然后将该`verses.txt`行替换为您的文件名。然后从命令行运行它，如：`ruby ./script.rb`

```
d = File.read('./verses.txt')
c = d[0..d.length]
c.scan(/(verses\s+\d+-\d+)/) do |n|
  n.each do |a|
    a.scan(/(\d+-\d+)/) do |nums|
      z = nums.to_s.split(/-/)
      st=''
      in1 = z[0].gsub(/\["/, '').to_i
      in2 = z[1].chomp("\"]").to_i
      (in1..in2).each do |index|
        st += "<a name=\"#{index}\"></a>"
      end
      b = st + a;
      d.gsub!(a, b)
    end
  end
end
puts d
f = File.new('verses2.txt', "w")
f.write(d) 
```

根据您的要求，这是一个修改，它将覆盖打开的文件并在目录中的所有文件上运行。为方便起见，我不会做目录输入，所以将脚本放在所有文件的目录中运行它。开始：

```
Dir.entries('.').each do |entry|
    entry.scan(/.*.html/) do
        |fn|
        d = File.read('./' + fn.to_s)
        c = d[0..d.length]
        c.scan(/(verses\s+\d+-\d+)/) do |n|
          n.each do |a|
            a.scan(/(\d+-\d+)/) do |nums|
              z = nums.to_s.split(/-/)
              st=''
              in1 = z[0].gsub(/\["/, '').to_i
              in2 = z[1].chomp("\"]").to_i
              (in1..in2).each do |index|
                st += "<a name=\"#{index}\"></a>"
              end
              b = st + a;
              d.gsub!(a, b)
            end
          end
        end
        puts d
        f = File.new('./' + fn.to_s, "w")
        f.write(d)
    end
end 
```

我会考虑如何进行阿拉伯语编码。这将在所有文本文件上运行，如果它们具有不同的扩展名或具有相似的名称，请告诉我，我将更新脚本。

这应该完全有效，刚刚测试过。让我知道是否有问题。

# php - PHP - 会话不适用于免费主机

> ID：14248547
> 
> 赞同：0
> 
> 时间：2013-01-09T23:48:37.323
> 
> 标签：php, session

我一直在研究一个项目，并且会话在 localhost 上完美运行。

但我已经注册了一个域名如下的免费主机：nameWrittenByMe.NameGivenByHost.es

**我已经尝试了一切，但我没有让它工作**

```
ini_set('session.cookie_domain',
substr($_SERVER['SERVER_NAME'], strpos($_SERVER['SERVER_NAME'],"."),100));

session_set_cookie_params(3600, '/', '.a.b.es', false, false);
session_set_cookie_params(3600, '/', 'a.b.es', false, false);
session_set_cookie_params(3600, '/', 'b.es', false, false);
session_set_cookie_params(3600, '/', '.b.es', false, false);
session_set_cookie_params(3600, '/', '.b.es');
session_set_cookie_params(3600, '/', 'b.es');
session_set_cookie_params(3600, '/', '.a.b.es');
session_set_cookie_params(3600, '/', 'a.b.es'); 
```

在 .htacces 我试过了

```
php_value session.cookie_domain .a.b.es
php_value session.cookie_domain a.b.es
php_value session.cookie_domain .b.es
php_value session.cookie_domain b.es 
```

我究竟做错了什么？免费托管（我正在使用 Hostinger）是否可能不支持会话（我对此表示怀疑......）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-10T16:32:21.890

尝试将此添加到您的`.htaccess`：

```
php_flag output_buffering on 
```

# python - 期望长输入

> ID：14248551
> 
> 赞同：1
> 
> 时间：2013-01-09T23:49:08.713
> 
> 标签：python, putty, tty

很难解释我在做什么，但简而言之，由于我提供的输入字符串很长，pexpect 的日志/输出变得一团糟......它类似于在具有小（物理）的 Putty 会话中发生的情况窗口大小

例如，

```
! Using Python
# Python2.6
# Windows 7, Cygwin
# Psuedo-Code - I am giving this
p = pexpect.spawn('ssh Router')
p.sendline('show logging | include MLSCEF-DFC1-2-FIB_TCAM_WRITE_INCONSISTENCY')
i = p.expect('Router#')
print p.before

# Output Seen as 
Router# show logging | include MLSCEF-DFC1-2-FIB_TCAM_WRITE$g | include MLSCEF-DFC1-2-FIB_TCAM_WRITE_         INCONSISTe MLSCEF-DFC1-2-FIB_TCAM_WRITE_INCONSISTE         NCY

! Using Putty
# This is seen from a tiny putty session for Router
# Really I am just Copy Pasting the line "show logging | include MLSCEF-DFC1-2-FIB_TCAM_WRITE_INCONSISTENCY" into Putty and finally, putty looks like this
ur01.steubenville.oh.pitt#$EF-DFC1-2-FIB_TCAM_WRITE_INCONSISTENCY

# If I increase the windows size of the putty, I see the whole output
ur01.steubenville.oh.pitt#show logging | include MLSCEF-DFC1-2-FIB_TCAM_WRITE_INCONSISTENCY 
```

另一种解释方式，即使使用 pexpect 也会发生这种情况 - [http://support.suso.com/supki/File:Nano-pasted-authorizedkeys.png](http://support.suso.com/supki/File:Nano-pasted-authorizedkeys.png)

最终，我希望增加输入窗口的大小，这样我就看不到美元符号 ($)？

# mysql - 使用 SELECT 时看不到 MySQL BIT 字段值

> ID：14248554
> 
> 赞同：55
> 
> 时间：2013-01-09T23:49:59.603
> 
> 标签：mysql, sql, bit

`my_table`包含`enabled`定义为的字段：`enabled BIT NOT NULL DEFAULT 0`.

该表有多行带有`enabled = b'0'`，多行带有`enabled = b'1'`。

但是，这两个：

```
SELECT * from my_table WHERE enabled = b'0'; 
```

还有这个：

```
SELECT * from my_table WHERE enabled = b'1'; 
```

在`enabled`列中显示空白：

```
+----+---------+
| id | enabled |
+----+---------+
|  1 |         |
|  2 |         |
+----+---------+ 
```

这是为什么？我怎么能看到该`enabled`字段的值？

* * *

```
$ mysql --version
mysql  Ver 14.14 Distrib 5.1.63, for debian-linux-gnu (x86_64) using readline 6.1 
```

* * *

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-01-10T01:20:07.000

您在终端中看不到它的原因是因为位值是不可打印的字符。

让我们插入以下值：

```
INSERT INTO `my_table` (`ID`, `enabled`)
VALUES (1,b'1'),(2,b'0'); 
```

然后选择它们进行归档：

```
mysql> SELECT * FROM my_table INTO OUTFILE '/tmp/my_table.txt' FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n'; 
```

首先让我们`/tmp/my_table.txt`以纯文本形式查看我们的文件：

> "1","
> "2",""

然后在十六进制视图中：

> 22 31 22 2C 22 **01** 22 0A 22 32 22 2C 22 **00** 22 0A

为了能够看到这些值，您可以简单地`CAST`将它们放在`SELECT`：

```
SELECT id, CAST(enabled AS UNSIGNED) AS enabled FROM my_table 
```

这将产生以下输出：

```
+----+---------+
| id | enabled |
+----+---------+
|  1 |       1 |
|  2 |       0 |
+----+---------+
2 rows in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-05-19T10:48:27.940

另一种方法是

```
SELECT enabled+0 from my_table 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2015-09-06T07:08:58.830

最简单的方法是`ORD`函数：

```
SELECT ORD(`enabled`) AS `enabled` FROM `my_table` 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-05T03:36:44.903

> 位值作为二进制值返回。要以可打印形式显示它们，请添加 0 或使用转换函数，例如 BIN()。

[https://dev.mysql.com/doc/refman/5.7/en/bit-field-literals.html](https://dev.mysql.com/doc/refman/5.7/en/bit-field-literals.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-01T19:44:41.347

你也可以试试`SELECT enabled&1 from my_table`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-20T13:32:18.640

采用`HEX()`

像： `SELECT id, HEX(enabled) AS enabled FROM my_table`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-22T14:31:44.017

要将位字段值转换为人类可读的字符串，请使用内置的[EXPORT_SET](https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_export-set)函数，将位（1）类型的列转换为“Y”或“N”值的简单示例是

```
EXPORT_SET(column, 'Y', 'N') 
```

您还可以将 bit(8) 值转换为字节的二进制表示

```
EXPORT_SET(column, '1', '0', '', 8) 
```

# angularjs - 是否有 AngularJS 版本的 jQuery 文档准备好

> ID：14248558
> 
> 赞同：1
> 
> 时间：2013-01-09T23:50:23.120
> 
> 标签：angularjs

我是 Angular 的新手，并且能够创建一个基本页面，该页面创建一个带有一些复选框的人员列表，允许您选择他们。

[看到这个小提琴](http://jsfiddle.net/uvBWn/)

问题是当我将 getAllPeople 函数更改为从数据库中提取时

```
 $http.post('angular.cfc?method=returnSerializeQuery').success(function(data) {
       $scope.allPeople = data;
     }); 
```

html 不是在 js 中构建数组，而是快速加载并加载空白列表。如果我然后搜索列表显示。我知道 $http 调用速度太慢，无法跟上文档负载。

我必须使用 $timeout 但我似乎无法让它工作，因为数据集有时可能需要比其他时间更长的时间。如果有 $(document).ready() 的 Angular 版本，我似乎找不到它。

我还猜测，由于这是我的第一个功能齐全的页面，我还没有完全正确地设置它，这可能与它有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:35:28.423

如果想法是延迟页面呈现，直到从服务器获取数据，您[在此处](https://stackoverflow.com/questions/12356185/angular-js-delaying-controller-initialization)和[此处](https://stackoverflow.com/questions/11972026/delaying-angularjs-route-change-until-model-loaded-to-prevent-flicker)都有很好的答案（和示例） 。

主要思想：

```
function Ctrl($scope) {    
    $scope.data = {};
}

Ctrl.resolve = {
    data: function($http) {
        return $http({method: 'GET', url: '/path/to/some/data'});
    }
};

var myApp = angular.module('app', [], function($routeProvider) {
    $routeProvider.when('/', {
        templateUrl: '/template.html',
        controller: Ctrl,
        resolve: Ctrl.resolve
    });
});​ 
```

还要检查这个工作示例：http: [//jsfiddle.net/dTJ9N/54/](http://jsfiddle.net/dTJ9N/54/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:28:34.293

在您的 post().success 回调函数中，在`$scope.allPeople = data;`add之后`$scope.groupToPages()`，因为 ng-repeat 正在观看`pagedItems`，而不是`allPeople`.

# asp.net - “System.Web.UI.WebControls.ImageButton”没有名为“UpdateProgress”的公共属性

> ID：14248559
> 
> 赞同：2
> 
> 时间：2013-01-09T23:50:29.573
> 
> 标签：asp.net, .net

在一个页面中，我在更新面板中有一个网格和 2 个下拉列表。用户将从下拉列表中选择，选定的项目将保存并显示在更新面板中。我还计划使用 updateprogress 。

这样做时，我收到了这个设计时错误“ ***'System.Web.UI.WebControls.ImageButton'没有名为'UpdateProgress'的公共属性”***

我花了很多时间，但无法解决它。请帮我。这是我的代码。

```
 <tr>
        <td colspan="3">
            <div>
                <asp:Label runat="server" ID="Label1" Text="Update your professional experience below"></asp:Label>
                <asp:UpdatePanel runat="server" ID="upExperience">
                    <ContentTemplate>
                        <asp:DropDownList runat="server" AutoPostBack="true" ID="ddlCategory">
                        </asp:DropDownList>
                        <asp:DropDownList runat="server" ID="ddlValues">
                        </asp:DropDownList>
                        <asp:Button runat="server" ID="btnAddNew" Text="Add New" />
                        <asp:GridView runat="server" ID="gvExperience" AutoGenerateColumns="false">
                            <Columns>
                                <asp:BoundField DataField="Category" HeaderText="Category" />
                                <asp:BoundField DataField="Experience" HeaderText="Experience" />
                                <asp:BoundField DataField="Status" HeaderText="Status" />
                                <asp:TemplateField HeaderText="Remove">
                                    <ItemTemplate>
                                        <asp:ImageButton runat="server" ID="btnRemove" CommandArgument="<%#Eval("ID")%>" />
                                    </ItemTemplate>
                                </asp:TemplateField>
                            </Columns>
                        </asp:GridView>
                    </ContentTemplate>
                </asp:UpdatePanel>
                <asp:UpdateProgress runat="server" ID="upp">
                    <ProgressTemplate>
                        <img src="../Images/loading.gif" />
                    </ProgressTemplate>
                </asp:UpdateProgress>
            </div>
        </td>
    </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:17:57.503

由于 Eval 周围有双引号，您的 ImageButton 服务器控件格式不正确，因此 asp:UpdateProgress 被视为标记的延续。替换为：

```
<asp:ImageButton runat="server" ID="btnRemove" CommandArgument='<%#Eval("ID")%>' /> 
```

# c# - 简单的正则表达式 [0-9]* 不适用于 C# 中的 {e|24}

> ID：14248562
> 
> 赞同：2
> 
> 时间：2013-01-09T23:50:39.633
> 
> 标签：c#, regex

我一直在用 C# 开发我自己的简单维基百科解析器。到目前为止，由于这个问题，我还没有走得太远。

我提取字符串`{e|24}`，但它可以包含任何数字。我想做的只是从这个字符串中提取数字。

这是我目前使用的代码：

```
Match num = Regex.Match(exp.Value, "[0-9]*");
Console.WriteLine(num.Value); 
```

然而`num.Value`是空白。

有人可以解释为什么这不起作用以及我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T23:53:52.177

您可能希望使用 [0-9]+ 来确保至少有一个数字。[0-9]* 允许匹配 0 次或更多，从而得到空白

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:59:39.117

我的建议，使正则表达式：`\d+`

作品。更简单。更短，不使用组或范围。

# android - Android：如何在listView上的项目中结合滑动手势和长按

> ID：14248564
> 
> 赞同：1
> 
> 时间：2013-01-09T23:51:18.100
> 
> 标签：android, android-listview, gesture, swipe, long-press

我有一个我个性化的列表视图，我添加了`setOnItemLongClickListener()`它，效果很好。然后我决定实现一个`listView.setOnTouchListener(new OnSwipeTouchListener())`也很好用的手势。`OnSwipetouchListener`我从另一个帖子中复制了课程。

问题是，当我添加滑动监听器时，longPress 不再起作用。我猜这是因为滑动侦听器自己采取了长按动作，并且不允许长按做任何事情。

我想做的事：

滑动侦听器在 2 秒内获得所有内容，之后所有内容都进入 longpress。所以我仍然可以通过滑动手势更改列表视图内容，还可以为每个列表项创建函数。

我的代码：

```
public class OnSwipeTouchListener implements OnTouchListener {

    private final GestureDetector gestureDetector = new GestureDetector(new GestureListener());

    public boolean onTouch(final View v, final MotionEvent event) {
        //super.onTouch(v, event);
         return gestureDetector.onTouchEvent(event);
    }

    private final class GestureListener extends SimpleOnGestureListener {

        private static final int SWIPE_THRESHOLD = 100;
        private static final int SWIPE_VELOCITY_THRESHOLD = 100;

        @Override
        public boolean onDown(MotionEvent e) {
            return true;
        }

        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
            boolean result = false;
            try {
                float diffY = e2.getY() - e1.getY();
                float diffX = e2.getX() - e1.getX();
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    if (Math.abs(diffX) > SWIPE_THRESHOLD && Math.abs(velocityX) > SWIPE_VELOCITY_THRESHOLD) {
                        if (diffX > 0) {
                            onSwipeRight();
                        } else {
                            onSwipeLeft();
                        }
                    }
                } else {
                    if (Math.abs(diffY) > SWIPE_THRESHOLD && Math.abs(velocityY) > SWIPE_VELOCITY_THRESHOLD) {
                        if (diffY > 0) {
                            onSwipeBottom();
                        } else {
                            onSwipeTop();
                        }
                    }
                }
            } catch (Exception exception) {
                exception.printStackTrace();
            }
            return result;
        }
...methods...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:22:35.597

删除 onDown 方法。现在它总是返回 true 并阻止 longPress 被处理。

# css - 调整窗口大小时，如何消除浏览器窗口右侧的空白？

> ID：14248567
> 
> 赞同：1
> 
> 时间：2013-01-09T23:51:33.623
> 
> 标签：css, html, whitespace

我已经搜索了 StackOverflow 的答案，但我尝试过的任何方法都没有奏效。

我有一个容器 div，其中三个内部 div 以不同的高度垂直堆叠。当我的浏览器窗口最大化时，它看起来很好。当我使窗口变小并水平滚动时，会出现一段空白。我怎样才能摆脱它？谢谢大家！

```
body {
min-width: 100%;
}

div#outer {
display: block;
position: absolute;
min-width: 100%;
}

div#top {
left: 0;
top: 0;
height: 100px;
width: 100%;
position: relative;
display: block;
}

div#middle {
left: 0;
top: 0;
height: 600px;
width: 100%;
position: relative;
display: block;
}

div#bottom {
left: 0;
top: 0;
height: auto;
width: 100%;
position: relative;
display: block;
} 
```

HTML：

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="big">
    <div id="top">
    </div>

    <div id="middle">
    </div>

    <div id="bottom">
    </div>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:11:29.363

在 中`body`，有一些默认边距。您可以像这样删除所有内容：

```
body {
    min-width: 100%;
    margin: 0;
    padding: 0;
} 
```

如果您只想删除两侧的边距：

```
body {
    min-width: 100%;
    margin-left: 0;
    margin-right: 0;
} 
```

那样有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-31T10:05:47.657

```
html,body {
         margin: 0px;
         padding: 0px;
         overflow-x: hidden;
} 
```

# python - 在 Python 中创建顺序目录

> ID：14248568
> 
> 赞同：1
> 
> 时间：2013-01-09T23:51:43.213
> 
> 标签：python, naming, directory, sequential, convention

我试图找到如何创建具有特定填充的顺序目录。对于给定的数字，它应该创建目录：

```
def createDirectories(number=10, name='seq'):
    for i in range(1, number+1):
        os.mkdir(name+i) 
```

但它应该按照以下命名约定生成目录

```
seq0010
seq0020
seq0030
...
seq0100 
```

如何以这种方式格式化数字？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-09T23:53:26.863

```
>>> myNum = '5'
>>> print myNum.zfill(3)
>>> '005' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-09T23:56:21.863

`seq0010`您可以使用此表达式从输入中获取目录名称`1`：

```
dirName = 'seq%03d0' % 1 
```

替换`1`为`i`你就设置好了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T23:55:50.573

您还可以使用字符串格式一次创建整个文件夹名称：

```
>>> 'seq{0:03d}0'.format(3)
'seq0030' 
```

# python - 查找草率手绘矩形的属性

> ID：14248571
> 
> 赞同：24
> 
> 时间：2013-01-09T23:52:17.987
> 
> 标签：python, algorithm, image-processing, opencv, graphics

我正在使用的图片：

![https://dl.dropbox.com/u/454490/1%20%28Small%29.JPG](../Images/48464ff5ababe73e7b27d4ec5c3548df.png)

我正在尝试找到此图像中的每个框。结果不必是 100% 准确，只要找到的框的位置/大小大致正确即可。通过使用正方形检测示例，我设法获得了轮廓、边界框、角和框的中心。

我在这里遇到了一些问题：

1.  为绘制线的内部和外部检测边界矩形。
2.  检测到一些无关的角/中心。
3.  我不确定如何将角/中心与相关的轮廓/边界框匹配，尤其是在考虑嵌套框时。

代码生成的图像：![https://dl.dropbox.com/u/454490/testresult.jpg](../Images/c523f374e7adfafa09ee8428ad357957.png)

这是我用来生成上面图像的代码：

```
import numpy as np
import cv2
from operator import itemgetter
from glob import glob
def angle_cos(p0, p1, p2):
    d1, d2 = (p0-p1).astype('float'), (p2-p1).astype('float')
    return abs( np.dot(d1, d2) / np.sqrt( np.dot(d1, d1)*np.dot(d2, d2) ) )
def makebin(gray):
    bin = cv2.adaptiveThreshold(gray, 255, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, 5, 2)
    return cv2.bitwise_not(bin)
def find_squares(img):
    img = cv2.GaussianBlur(img, (11, 11), 0)
    squares = []
    points = []`
    for gray in cv2.split(img):
        bin = makebin(gray)
        contours, hierarchy = cv2.findContours(bin, cv2.RETR_LIST, cv2.CHAIN_APPROX_SIMPLE)
        corners = cv2.goodFeaturesToTrack(gray,len(contours)*4,0.2,15)
        cv2.cornerSubPix(gray,corners,(6,6),(-1,-1),(cv2.TERM_CRITERIA_MAX_ITER | cv2.TERM_CRITERIA_EPS,10, 0.1))
        for cnt in contours:
            cnt_len = cv2.arcLength(cnt, True)
            if len(cnt) >= 4 and cv2.contourArea(cnt) > 200:
                rect = cv2.boundingRect(cnt)
                if rect not in squares:
                    squares.append(rect)
    return squares, corners, contours
if __name__ == '__main__':
    for fn in glob('../1 (Small).jpg'):
        img = cv2.imread(fn)
        squares, corners, contours = find_squares(img)
        for p in corners:
            cv2.circle(img, (p[0][0],p[0][3]), 3, (0,0,255),2)
        squares = sorted(squares,key=itemgetter(1,0,2,3))
        areas = []
        moments = []
        centers = []
        for s in squares:
            areas.append(s[2]*s[3])
            cv2.rectangle( img, (s[0],s[1]),(s[0]+s[2],s[1]+s[3]),(0,255,0),1)
        for c in contours:
            moments.append(cv2.moments(np.array(c)))
        for m in moments:
            centers.append((int(m["m10"] // m["m00"]), int(m["m01"] // m["m00"])))
        for cent in centers:
            print cent
            cv2.circle(img, (cent[0],cent[1]), 3, (0,255,0),2)
        cv2.imshow('squares', img)
        ch = 0xFF & cv2.waitKey()
        if ch == 27:
            break
    cv2.destroyAllWindows() 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-10T02:34:51.057

我建议以更简单的方法作为起点。例如，形态梯度可以作为强边缘的良好局部检测器，其阈值往往很简单。然后，您可以删除太小的组件，这对于您的问题也相对容易。在您的示例中，每个剩余的连接组件都是一个框，因此在本例中解决了问题。

通过这个简单的过程，您将获得以下内容：

![在此处输入图像描述](../Images/2095d5005911a7608b5e1a3decbecede.png)

红点代表组件的质心，因此如果黄色对您不利，您可以从那里长出另一个包含在黄色中的盒子。

这是实现这一目标的代码：

```
import sys
import numpy
from PIL import Image, ImageOps, ImageDraw
from scipy.ndimage import morphology, label

def boxes(orig):
    img = ImageOps.grayscale(orig)
    im = numpy.array(img)

    # Inner morphological gradient.
    im = morphology.grey_dilation(im, (3, 3)) - im

    # Binarize.
    mean, std = im.mean(), im.std()
    t = mean + std
    im[im < t] = 0
    im[im >= t] = 1

    # Connected components.
    lbl, numcc = label(im)
    # Size threshold.
    min_size = 200 # pixels
    box = []
    for i in range(1, numcc + 1):
        py, px = numpy.nonzero(lbl == i)
        if len(py) < min_size:
            im[lbl == i] = 0
            continue

        xmin, xmax, ymin, ymax = px.min(), px.max(), py.min(), py.max()
        # Four corners and centroid.
        box.append([
            [(xmin, ymin), (xmax, ymin), (xmax, ymax), (xmin, ymax)],
            (numpy.mean(px), numpy.mean(py))])

    return im.astype(numpy.uint8) * 255, box

orig = Image.open(sys.argv[1])
im, box = boxes(orig)

# Boxes found.
Image.fromarray(im).save(sys.argv[2])

# Draw perfect rectangles and the component centroid.
img = Image.fromarray(im)
visual = img.convert('RGB')
draw = ImageDraw.Draw(visual)
for b, centroid in box:
    draw.line(b + [b[0]], fill='yellow')
    cx, cy = centroid
    draw.ellipse((cx - 2, cy - 2, cx + 2, cy + 2), fill='red')
visual.save(sys.argv[3]) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-11T14:03:50.997

我看你已经得到答案了。但我认为 OpenCV 中有一种更简单、更短、更好的方法可以解决这个问题。

在寻找轮廓的同时，您也在寻找轮廓的层次结构。轮廓的层次是不同轮廓之间的关系。

因此，您在代码中使用的标志`cv2.RETR_TREE`提供了所有层次关系。

`cv2.RETR_LIST`不提供层次结构，而`cv2.RETR_EXTERNAL`只为您提供外部轮廓。

最适合您的是`cv2.RETR_CCOMP`它为您提供所有轮廓和两级层次关系。即外轮廓始终是父轮廓，内孔轮廓始终是子轮廓。

有关层次结构的更多信息，请阅读以下文章：[**轮廓 - 5：层次结构**](http://opencvpython.blogspot.com/2013/01/contours-5-hierarchy.html)

所以轮廓的层次结构是一个 4 元素数组，其中最后一个元素是指向其父元素的索引指针。`If a contour has no parent, it is external contour and it has a value -1`. 如果它是一个内部轮廓，它是一个孩子，它会有一些指向它的父母的价值。我们将在您的问题中利用此功能。

```
import cv2
import numpy as np

# Normal routines
img = cv2.imread('square.JPG')
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
ret,thresh = cv2.threshold(gray,50,255,1)

# Remove some small noise if any.
dilate = cv2.dilate(thresh,None)
erode = cv2.erode(dilate,None)

# Find contours with cv2.RETR_CCOMP
contours,hierarchy = cv2.findContours(erode,cv2.RETR_CCOMP,cv2.CHAIN_APPROX_SIMPLE)

for i,cnt in enumerate(contours):
    # Check if it is an external contour and its area is more than 100
    if hierarchy[0,i,3] == -1 and cv2.contourArea(cnt)>100:
        x,y,w,h = cv2.boundingRect(cnt)
        cv2.rectangle(img,(x,y),(x+w,y+h),(0,255,0),2)

        m = cv2.moments(cnt)
        cx,cy = m['m10']/m['m00'],m['m01']/m['m00']
        cv2.circle(img,(int(cx),int(cy)),3,255,-1)

cv2.imshow('img',img)
cv2.imwrite('sofsqure.png',img)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

结果 ：

![在此处输入图像描述](../Images/89652e595cf4d3ab396dcee5bdc15601.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:39:25.653

这个问题与[python图像识别](https://stackoverflow.com/questions/1603688/python-image-recognition)有关。[squres.py demo](http://code.google.com/p/ctypes-opencv/source/browse/trunk/demo/squares.py?r=228)中给出了解决方案。

# excel - 自动筛选方法失败

> ID：14248572
> 
> 赞同：1
> 
> 时间：2013-01-09T23:52:32.927
> 
> 标签：excel, vba, autofilter

这个子程序突然停止工作；已添加新工作表，但此代码没有更改。知道为什么我收到消息“范围类的自动过滤方法失败”运行时错误 1004？

```
Sub Hide_Row()

    Application.ScreenUpdating = False
    ActiveSheet.Unprotect
    Range("a6:HO499").AutoFilter Field:=2, Criteria1:="<>"

End Sub 
```

# nsmutablearray - 在 plist 中写入字典有效，然后从 plist 返回中读取字典（空）

> ID：14248575
> 
> 赞同：0
> 
> 时间：2013-01-09T23:53:17.187
> 
> 标签：nsmutablearray, plist, nsmutabledictionary, read-write

这就是我在 viewDidLoad 方法中访问 plist 中字典的方式：

```
 NSString* documentsDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
     NSString *fileName = [NSString stringWithFormat:@"Level.plist"];
     filePath = [documentsDir stringByAppendingPathComponent:fileName];
     array = [[NSMutableArray alloc] initWithContentsOfFile:filePath];
     dict = [array objectAtIndex:1]; 
```

这很好用，然后我这样写字典：

```
 score = [NSString stringWithFormat:@"%d", score.integerValue + 10];
    [dict setObject:score forKey:@"Score"];
    [dict writeToFile:filePath atomically: NO]; 
```

这也可以正常工作，但是一旦我返回此视图并尝试在 viewDidLoad 方法中再次访问字典，它就会为字典返回 (null)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T00:37:09.953

这是因为您将文件作为数组读取，但是当您再次将其写回时，您只是写出字典，而不是包含该字典的数组。如果你尝试使用 NSMutableArray 读取一个 plist 文件，该文件的根目录不是数组，这将导致它返回 nil。因此，如果您只是在最后一行代码中替换`dict`为`array`，那应该可以解决问题。

# jquery - 电影世界 api 信息空白

> ID：14248579
> 
> 赞同：1
> 
> 时间：2013-01-09T23:53:42.797
> 
> 标签：jquery, api

嗨，我是使用 API 的新手，在尝试从 cineworld api 检索信息时遇到问题，有没有人使用过它。

这是他们给出的一个例子，但我似乎无法从中提取任何信息？

```
<script>
$(document).ready(function() {
$('a.retrieve').click(function() {
    $.ajax({
        url: '/api/quickbook/films',
        type: 'GET',
        data: {key: 'qUnEyRXt', full: true, cinema: 33},
        dataType: 'jsonp', // Setting this data type will add the callback parameter for you
        success: parseFilms
    });
});

$('a.clear').click(function() {
    $('span.film.count').text('0');
    $('ol.film.list').empty();
});
});

 function parseFilms(response, status) {
var html = '';

// Check for errors from the server
if (response.errors) {
    $.each(response.errors, function() {
        html += '<li>' + this + '</li>';
    });
} else {
    $('span.film.count').text(response.films.length);
    $.each(response.films, function() {
        html += '<li>' + this.title + ' (' + this.classification + ')</li>';
    });
}

// Faster than doing a DOM call to append each node
$('ol.film.list').append(html);
}

</script> 
```

网络文档的链接是[https://www.cineworld.co.uk/developer/jquery](https://www.cineworld.co.uk/developer/jquery)

任何帮助或建议都会非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:30:47.613

实际上，它有效！

这是**您要传递**的网址`$.ajax()`：

[http://www.cineworld.co.uk/api/quickbook/films?key=qUnEyRXt&full=true&cinema=33](http://www.cineworld.co.uk/api/quickbook/films?key=qUnEyRXt&full=true&cinema=33)

**这是代码**

```
<html>
  <head>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('a.retrieve').click(function() {
          $.ajax({
              url: 'http://www.cineworld.co.uk/api/quickbook/films',
              type: 'GET',
              data: {key: 'qUnEyRXt', full: true, cinema: 33},
              dataType: 'jsonp', // Setting this data type will add the callback parameter for you
              success: parseFilms
          });
        });

        $('a.clear').click(function() {
            $('span.film.count').text('0');
            $('ol.film.list').empty();
        });
      });

      function parseFilms(response, status) {
        var html = '';

        // Check for errors from the server
        if (response.errors) {
            $.each(response.errors, function() {
                html += '<li>Error' + this + '</li>';
            });
        } else {
            $('span.film.count').text(response.films.length);
            $.each(response.films, function() {
                html += '<li>' + this.title + ' (' + this.classification + ')</li>';
            });
        }

        // Faster than doing a DOM call to append each node
        $('ol.film.list').html(html);
      }
    </script>  
  </head>
  <body>
    <a class="retrieve" href="#retrieve">Retrieve</a>
    <a class="clear" href="#clear">Clear</a>
    <span class="film count"></span>
    <ol class="film list">
    </ol>
  </body>
</html> 
```

# jquery - 从 jquery 调用一个新的 rails 页面

> ID：14248581
> 
> 赞同：0
> 
> 时间：2013-01-09T23:53:43.343
> 
> 标签：jquery, ruby-on-rails-3

有没有更好的方法从 jquery 文件调用 rails 项目中的新页面。例子：

```
$(function(){

    var products = $('.item');
    products.click(function(event){
        window.location.href = '/products/cans';
        event.preventDefault();
    });
}) 
```

首先是上面最好的方法。其次，我有办法不对网址进行硬编码。而是以某种方式将路由路径传递给它。“work_cans_path”

# c# - 通过 C# 运行 Excel 宏：在另一个工作簿上运行宏？

> ID：14248592
> 
> 赞同：10
> 
> 时间：2013-01-09T23:54:36.507
> 
> 标签：c#, excel, vba, office-automation

我正在寻找运行一个宏，让我们在 WorkSheet02 上的 WorkSheet01 中将其称为 Macro01。

使用*Microsoft.Office.Interop.Excel 命名空间*，我打开了 WorkSheet01。

```
public void Main_CodedStep()
    {
        // Object for missing (or optional) arguments.
        object oMissing = System.Reflection.Missing.Value;

        // Create an instance of Microsoft Excel
        Excel.ApplicationClass oExcel = new Excel.ApplicationClass();

        // Make it visible
        oExcel.Visible = true;

        // Open Worksheet01.xlsm
        Excel.Workbooks oBooks = oExcel.Workbooks;
        Excel._Workbook oBook = null;
        oBook = oBooks.Open("C:\\Users\\Admin\\Documents\\Worksheet01.xlsm", oMissing, oMissing,
            oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, 
            oMissing, oMissing, oMissing, oMissing, oMissing, oMissing);
    } 
```

然后我使用自动化脚本来提取报告。此报告是通过 IE 的下载提示而不是 Interop 打开的。

当我尝试通过 C# 运行宏时出现问题（我制作了另一个新的 Excel.ApplicationClass()；只是这样编译，我相信这是我的失误之一。）

```
public void FirstMacro_CodedStep()
    {
        // Create an instance of Microsoft Excel
        Excel.ApplicationClass oExcel = new Excel.ApplicationClass();
        Console.WriteLine("ApplicationClass: " + oExcel);

        // Run the macro, "First_Macro"
        RunMacro(oExcel, new Object[]{"Worksheet01.xlsm!First_Macro"});

        //Garbage collection
        GC.Collect();
    }

    private void RunMacro(object oApp, object[] oRunArgs)
    {
        oApp.GetType().InvokeMember("Run", System.Reflection.BindingFlags.Default | System.Reflection.BindingFlags.InvokeMethod, null, oApp, oRunArgs);
    } 
```

当此方法运行时，它会在 Worksheet01 而不是 Worksheet02 上从 Worksheet01 运行宏。它还在我的文档中寻找工作表，所以我把它移过来看看会发生什么。

**回顾：**

1.  打开工作表01
2.  通过脚本从 MSIE 获取并打开报告 (Worksheet02)
3.  在 Worksheet02 上从 Worksheet01 运行 Macro01

**资源：**

[http://support.microsoft.com/kb/306683](http://support.microsoft.com/kb/306683)

[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.aspx)

对于那些想尝试它的人，请将其添加到您的 using 指令中：

```
using System.Reflection;
using Microsoft.Office.Core; //Added to Project Settings' References from C:\Program Files (x86)\Microsoft Visual Studio 10.0\Visual Studio Tools for Office\PIA\Office14 - "office"
using Excel = Microsoft.Office.Interop.Excel; //Added to Project Settings' References from C:\Program Files (x86)\Microsoft Visual Studio 10.0\Visual Studio Tools for Office\PIA\Office14 - "Microsoft.Office.Interop.Excel" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-10T19:50:19.877

我找到了一个我想分享的解决方案。首先，我删除了打开 Worksheet01 的位。然后我让我的自动化脚本将 .CSV 保存到我的文档中。然后我使用我必须打开 Worksheet01 的代码来打开下载的文件。此时的关键是 Worksheet01 与 Worksheet02 位于 Documents 文件夹中。最后，我使用代码从 Worksheet01 运行宏，该宏在 Worksheet02 上运行。

```
 public void WebTest_CodedStep()
    {
        // Object for missing (or optional) arguments.
        object oMissing = System.Reflection.Missing.Value;

        // Create an instance of Microsoft Excel
        Excel.ApplicationClass oExcel = new Excel.ApplicationClass();

        // Make it visible
        oExcel.Visible = true;

        // Define Workbooks
        Excel.Workbooks oBooks = oExcel.Workbooks;
        Excel._Workbook oBook = null;

        // Get the file path
        string path = System.Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
        path = path + "\\Worksheet02.csv";

        //Open the file, using the 'path' variable
        oBook = oBooks.Open(path, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing,  oMissing, oMissing, oMissing, oMissing, oMissing, oMissing);

        // Run the macro, "First_Macro"
        RunMacro(oExcel, new Object[]{"Worksheet01.xlsm!First_Macro"});

        // Quit Excel and clean up.
        oBook.Close(false, oMissing, oMissing);
        System.Runtime.InteropServices.Marshal.ReleaseComObject (oBook);
        oBook = null;
        System.Runtime.InteropServices.Marshal.ReleaseComObject (oBooks);
        oBooks = null;
        oExcel.Quit();
        System.Runtime.InteropServices.Marshal.ReleaseComObject (oExcel);
        oExcel = null;

        //Garbage collection
        GC.Collect();
    }

    private void RunMacro(object oApp, object[] oRunArgs)
    {
        oApp.GetType().InvokeMember("Run", System.Reflection.BindingFlags.Default | System.Reflection.BindingFlags.InvokeMethod, null, oApp, oRunArgs);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T00:29:19.517

我运行这个 C# VSTO 代码来调用 VBA 宏，这是我使用的语法：

```
this.Application.Run("mymacro"); 
```

编辑：

宏是工作簿范围内的，也许您需要在运行宏之前将 Sheet2 设为活动工作表，例如：

```
foreach (Worksheet worksheet in workbook.Sheets.ComLinq<Worksheet>())
{
    if (worksheet.Name == "Sheet2") worksheet.Activate();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-30T04:25:09.310

```
 public void ExecuteMacro()
    {
    //    using Excel = Microsoft.Office.Interop.Excel;
    //    using System;
    //    using System.IO;

        string path = Environment.CurrentDirectory;
        string filePath = "";
        string[] fileEntries = Directory.GetFiles(".\\Source");
        foreach (string fileName in fileEntries)
        {
            if (fileName.IndexOf(".xlsm") > 0 && fileName.IndexOf("$")<1) filePath = fileName;
        }

        if (filePath == "") return;

        filePath = filePath.Replace(".\\", "\\");
        string fileDest = filePath.Replace("Source","Processed");
        filePath = path+filePath;
        fileDest = path+fileDest;

        Excel.Application ExcelApp = new Excel.Application();
        Excel.Workbook wb = ExcelApp.Workbooks.Open(filePath, ReadOnly: false);

        try
        {
            ExcelApp.Visible = false;
            ExcelApp.Run("UpdateSheets");

            try
            {
                File.Delete(fileDest);
            }
            catch (Exception) { }

            wb.SaveAs(fileDest);
        }
        catch (Exception) { }

        wb.Close(false);
        ExcelApp.Application.Quit();
        ExcelApp.Quit();
    } 
```

# delphi - 使用突触库（blcksock）在pascal / delphi中调用绑定两次的udp客户端服务器

> ID：14248594
> 
> 赞同：0
> 
> 时间：2013-01-09T23:54:40.487
> 
> 标签：delphi, sockets, udp, bind, pascal

我知道我的 C 方式，但我在 Pascal 中有一个使用 synapse 库的 UDP 客户端和服务器的现有代码。我的问题是：
客户：
- 它是连接（）广播（而不是 sendto（））的好方法吗？

服务器：
- 怎么可能调用 bind() 两次？（主要问题）
- 你为什么要绑定（）到发件人IP？

问候

编辑：
澄清如何使用此代码：
有多个客户端尝试将数据包发送到服务器。在任何客户端的第一个数据包到达服务器后，服务器将从此只接受来自第一个客户端的数据。客户端和服务器在不同的机器上运行。

客户：

```
UDPport:=TUDPblockSocket.Create;
UDPport.EnableBroadcast(true);
UDPport.Connect(cBroadcast,'1234');
while (not EOF(DATAfile)) do begin
  read(DATAfile,DATApacket);
  with (DATApacket) do begin
    NCOMport.SendBuffer(Addr(DATApacket),SizeOf(DATApacket));
  end;
end; 
```

服务器：

```
begin
  with TUDPblockSocket.Create do begin
    Bind(cAnyHost,'1234');
    AnyHost:=true;
    while (true) do begin
      if (WaitingData>0) then begin
        repeat
          buffer:=RecvPacket(c_UDPtimeout);
        until (WaitingData<=0);
        if (AnyHost) then begin
          SenderIP:=GetRemoteSinIP;
          Bind(SenderIP,'1234');
          AnyHost:=false;
        end else begin
          {extracting information out of the received data buffer}
        end;
      end;
    end;
    Free;
  end;
end; 
```

和：

```
const  c_UDPtimeout  = 100; 
```

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:48:22.727

> *   它是连接（）广播（而不是sendto（））的好方法吗？

你可以。对 UDP 套接字真正做的只是将指定的 IP 静态设置为传出数据包的目的地，因此您可以`send()`使用`sendto()`.

> *   怎么可能调用 bind() 两次？（主要问题）

您不能`bind()`多次使用套接字。如果你需要重新绑定一个套接字，你必须先关闭它。您的代码示例基本上是将套接字绑定到所有本地 IP 上的同一端口，然后尝试将其重新绑定到仅在您的端口上接收任何数据的第一个 IP。

> *   你为什么要绑定（）到发件人IP？

您不会也不能`bind()`访问远程 IP。

# jquery - 如何访问 li 元素的名称或值？

> ID：14248597
> 
> 赞同：0
> 
> 时间：2013-01-09T23:54:48.950
> 
> 标签：jquery

我有一个看起来像这样的 li 元素：

```
<ol id="selectbox">
    <li class="boxes" name="bears">bees</li>
    <li class="boxes" name="cakes">candles</li>
    <li class="boxes" name="wine">beer</li>
    <li class="boxes" name="spoon">fork</li>
    <li class="boxes" name="bench">chair</li>
    <li class="boxes" name="matches">fire</li>
    <li class="boxes" name="kindling">wood</li>
</ol> 
```

当我单击它时，我想将名称“bears”或文本“bees”放入变量中（知道如何同时执行这两种操作会很有帮助）。如何使用 jQuery 选择器做到这一点？我尝试了很多事情，例如

```
var $radios = $('input[name="mybuttons"]');
$('#selectbox li').click(function(){
  var $btn = $(this).addClass('active');
  var idx = $btn.index();    
  var name = $('li['+idx+']').name();
}); 
```

和

```
var name = $('#li.active').name() 
```

和

```
var name = $radios.eq(idx).prop('name') 
```

等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T23:55:53.463

使用[.text()](http://api.jquery.com/text/)获取文本

```
$(this).text() 
```

和[.attr('name')](http://api.jquery.com/attr/)获取名称

```
$(this).attr('name') 
```

[小提琴](http://jsfiddle.net/wirey00/VaVm6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T23:56:36.493

您可以`$(this)`在单击事件上下文中使用它，因为它对应于被单击的元素。

```
var name = $(this).attr('name');  // bears 

var val = $(this).text();       // bees 
```

**代码**

```
$('#selectbox li').click(function(){
  var $this = $(this);
  var $btn = $this.addClass('active');
  var name = $this.attr('name');
  var txt = $this.text();
  console.log("Name Attribute - " + name + " :: Text - "+ txt); 
}); 
```

**[工作小提琴](http://jsfiddle.net/sushanth009/E8GrB/)**

此外，最好将**数据属性**用于自定义属性，以便验证文档并符合标准实践。

所以

```
<li class="boxes" name="bears">bees</li> 
```

应该看起来像

```
<li class="boxes" data-name="bears">bees</li> 
```

要访问它，您可以使用其中一个`.attr()`或`.data()`方法

```
var name = $this.attr('data-name');
var name = $this.data('name'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T23:58:30.580

就像这样简单：

```
$('#myOL li').click(function(){
    $(this).addClass('active');
    var name = $(this).attr('name');
    var text = $(this).text(); 
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T00:02:30.927

好，

```
 $('#selectbox .boxes') 
```

在#selectbox 中返回带有类框的所有元素的数组通过使用jQuery 让您的生活更轻松，您可以这样做

```
$('#selectbox .boxes').click(function(){
  var tmp_name = $(this).attr('name');
  alert(tmp_name);
  alert($(this).text()); // bees
  alert($(this).html()); // bees
  // changes the attribute name of this li element which has class boxes and has been clicked.
  $(this).attr('name','Hello world!'); 
  // changes the inner html of this li element which has class boxes and has been clicked.
  $(this).html('Hello world!');

}) 
```

希望能帮助到你。

# javascript - 字符串化时间戳对象

> ID：14248600
> 
> 赞同：3
> 
> 时间：2013-01-09T23:55:06.003
> 
> 标签：javascript, json, object, serialization, stringify

我怎样才能`JSON.stringify`获得以下数据结构？

```
var Records = {
    1357775376232: {
        pageX: 0,
        pageY: 0,
        scrollLeft: 0,
        scrollTop: 0,
        target: #document,
        type: null,
        value: undefined
    },
    1357775376243: {
        pageX: 69,
        pageY: 10,
        scrollLeft: 0,
        scrollTop: 0,
        target: <a>,
        type: "click",
        value: ""
    }
    // ...etc...
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:03:54.247

看起来这个对象包含对标签的引用`document`和对`a`标签的引用。在删除此类引用之前，您将无法对其进行序列化。

一个简单的解决方案是：

```
var arrayWithRefs = [...];
var arrayWithout = [];

for (var i = 0; i < arrayWithRefs.length; i++) {
  arrayWithout[i] = {
    safeProperty: arrayWithRefs[i].safeProperty;
    // copy whatever you want, omitting document references
  };
}

var serialized = JSON.stringify(arrayWithout); 
```

当然，还有一些库可以帮助您挑选出您想要的属性。我会推荐**underscore**（通用）或**cryo**（正是你正在尝试的）：

*   [underscorejs.org](http://underscorejs.org)
*   [冷冻](https://github.com/hunterloftis/cryo)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T20:05:50.840

不要使用普通对象，而是使用元素的 XPath。

# ruby-on-rails - 导致错误的自定义验证

> ID：14248603
> 
> 赞同：1
> 
> 时间：2013-01-09T23:55:26.223
> 
> 标签：ruby-on-rails, ruby, customvalidator

我是 Rails 新手，正在使用 Rails 进行实用敏捷 Web 开发中的 Depot 应用程序，但遇到了一个奇怪的问题。

在我的产品模型中，我创建了一个验证器，用于确认图像 url 字段中要求的图像确实作为资产存在。这是我的产品型号代码。

```
class Product < ActiveRecord::Base
  attr_accessible :description, :image_url, :price, :title
  validates :description, :price, :title, :presence => true
 validate :image_url_exists, on: :create
  def image_url_exists
    if Rails.application.assets.find_asset(image_url) == nil
      errors.add(:image_url, 'is not valid. The image does not exist.')
    end
  end
end 
```

现在的问题是当我运行我的单元测试时。这是什么：

```
require 'test_helper'
    class ProductTest < ActiveSupport::TestCase
       test "the products attributes should not be empty" do
         p = Product.new
         assert p.invalid?
       end
    end 
```

但是这样做会在我的代码中触发一堆错误。如果没有自定义验证器，一切似乎都可以正常工作。这是我目前遇到的错误。

```
test_the_products_attributes_should_not_be_empty(ProductTest):
TypeError: can't convert nil into String
    /var/lib/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/base.rb:156:in `initialize'
    /var/lib/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/base.rb:156:in `new'
    /var/lib/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/base.rb:156:in `find_asset'
    /var/lib/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/index.rb:60:in `find_asset'
    /var/lib/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/environment.rb:78:in `find_asset'
    /home/saurabh/Desktop/SCRIPTS/Rails/depot/app/models/product.rb:6:in `image_url_exists'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:418:in `_run__4343689776242734370__validate__107120755283260520__callbacks'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `__run_callback'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:385:in `_run_validate_callbacks'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:81:in `run_callbacks'
    /var/lib/gems/1.9.1/gems/activemodel-3.2.9/lib/active_model/validations.rb:228:in `run_validations!'
    /var/lib/gems/1.9.1/gems/activemodel-3.2.9/lib/active_model/validations/callbacks.rb:53:in `block in run_validations!'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:403:in `_run__4343689776242734370__validation__107120755283260520__callbacks'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `__run_callback'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:385:in `_run_validation_callbacks'
    /var/lib/gems/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:81:in `run_callbacks'
    /var/lib/gems/1.9.1/gems/activemodel-3.2.9/lib/active_model/validations/callbacks.rb:53:in `run_validations!'
    /var/lib/gems/1.9.1/gems/activemodel-3.2.9/lib/active_model/validations.rb:195:in `valid?'
    /var/lib/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/validations.rb:69:in `valid?'
    /var/lib/gems/1.9.1/gems/activemodel-3.2.9/lib/active_model/validations.rb:203:in `invalid?' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T00:08:45.190

问题是，`Rails.application.assets.find_asset(image_url)`当您在测试中创建刷新对象时：`image_url``nil`

```
p = Product.new # Here p.image_url => nil 
```

查看日志可以找到错误的原因

```
/var/lib/gems/1.9.1/gems/sprockets-2.2.2/lib/sprockets/base.rb:156:in `initialize' 
```

在这里（[链接](https://github.com/sstephenson/sprockets/blob/v2.2.2/lib/sprockets/base.rb#L156)）发生错误的第 156 行`path`就`nil`在这里。

所以要解决这个问题，你需要在你的地方添加一个条件`if`来检查是否`image_url`不是 nil，这是我的建议

```
if self.image_url.nil? || Rails.application.assets.find_asset(self.image_url).nil?
  errors.add(:image_url, 'is not valid. The image does not exist.')
end 
```

# php - 当值的路径（级别）动态变化时，如何访问多维 PHP 数组？

> ID：14248604
> 
> 赞同：2
> 
> 时间：2013-01-09T23:55:33.093
> 
> 标签：php, arrays, path

在多维数组中设置一个值很容易。例如：

```
$myArray['levelA']['levelB']['levelC'] = $value 
```

阅读它也很简单。例如：

```
$value = $myArray['levelA']['levelB']['levelC']- 
```

当我知道使用了多少级别时，这很容易。但是当我们不知道会发生多少个级别时怎么办？

如果我有这样的配置文件怎么办：

```
levelA.levelB.levelC.levelD = someValue 
```

如果我想用`levelA.levelB.levelC.levelD`它（作为“路径”）将它映射到多维数组，但不知道我的配置有多深怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:54:35.460

这是我写的一个小类，它将确定维度的数量。您可以轻松地对其进行修改以做任何您想做的事情，或者只使用它返回的数字来指导您自己的功能：

```
class DimensionCounter {

    var $i;

    public function count($array) {
        $this->i = 1;
        return $this->readArray($array);
    }

    private function readArray($array) {

        foreach($array as $value) {
            if (is_array($value)) {
                $this->i++;
                $this->readArray($value);               
            }
            return $this->i;
        }
    }
} 
```

在你的情况下，`$counter = new DimensionCounter();` `$num = $counter->count($value);`会给你维度的数量。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T00:04:53.950

> 但是，当我们不知道会发生多少个级别时[原文如此！] 怎么办？

嗯，只是你不知道有多少级别。

无论如何，您都可以使用[`isset()`](http://php.net/isset)它来轻松找出：

```
$exists = isset($myArray['levelA']['levelB']['levelC']['levelD']); 
```

但我也必须承认我有一些问题要理解你的问题。

您是否在寻找：

*   [使用字符串访问（可能很大）多维数组](https://stackoverflow.com/q/7003559/367456)

或类似的？

# ruby-on-rails - 将 Rails 应用程序部署到 Heroku 时出错

> ID：14248610
> 
> 赞同：0
> 
> 时间：2013-01-09T23:56:00.933
> 
> 标签：ruby-on-rails, heroku

我正在关注 Rails 教程，我正处于第二次指示将应用程序部署到 heroku 的地步。我过去已经成功部署了一个应用程序，但现在无法正常工作。

我收到此错误： Permission denied (public key) fatal: could not read from remote repository。

遥控器存在并且是正确的，当使用“heroku 密钥”时，我的密钥就会出现。我也可以向 heroku 添加一个新堆栈。我也尝试重新添加密钥，但没有奏效。

很困惑，我找到的所有解决方案都没有奏效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:49:44.320

听起来您需要配置 ssh 密钥（通常位于 ~/.ssh）。你用的是github吗？如果是这样，您的 ssh 密钥应该已经设置好（如果不设置这些密钥，您将无法推送到 github.com）。

如果您尚未设置 ssh 密钥，请按照[github](https://help.github.com/articles/generating-ssh-keys)中的这些说明进行操作。

设置好 ssh 密钥后，执行命令“git push heroku”应该可以解决问题。[按照教程](http://ruby.railstutorial.org/chapters/beginning#sec-heroku_setup)中的说明确保正确设置 Heroku

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T01:20:15.810

您可能没有部署为与部署第一个应用程序相同的用户。如果您在 linux 环境中，这可能意味着您曾经以 root 身份部署，而另一次尝试以用户身份部署，也许您使用了 sudo 。

或者您可能删除了您的 ssh 公钥....或者您更改了您的 ssh 密钥的权限。

我的评价不够高，无法发表评论，因此请导航至 ~/.ssh 并输入“ls -l”，以便我查看您的权限。然后将一个目录向上导航到 ~/ 并键入“ls -la”，这样我就可以看到您对实际 .ssh 文件夹的权限

然后导航到 /.ssh 并发布相同的权限，以便我可以看到它们。

# javascript - 在保存操作之前获取记录的 guid

> ID：14248615
> 
> 赞同：1
> 
> 时间：2013-01-09T23:56:17.920
> 
> 标签：javascript, dynamics-crm-2011, crm

我需要使用记录的 GUID。如果记录是旧的，我可以访问 guid

```
Xrm.Page.data.entity.getId(); 
```

问题是我需要在保存新记录的同时使用 ID。

我尝试保存记录，重新加载页面，然后使用 id

```
parent.Xrm.Page.data.entity.save();
window.location.reload(true);
var currentCaseId = Xrm.Page.data.entity.getId(); 
```

但它不起作用。

编辑：我更改了我的代码，所以现在我可以在 onLoad 事件中获取 ID，但现在我的问题是，如果用户选择“保存”（导致“保存”按钮刷新页面），我只能获取 GUID。如果用户选择“Save&Close”或“Save&New”，则记录不会刷新，因此不会发生 onLoad 事件并且我无法获取 GUID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T11:25:59.427

如果您在 crm 中创建记录，则主键由 crm 创建并返回给您。您可以自己创建一个 guid 并在保存之前分配它。现在你知道正手的关键了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:30:12.977

当您实际创建实例时，您首先会获得一个实例的*guid*。*因此，您需要在服务器使用guid*返回给您之前实际执行保存操作。

如果您需要在保存实体之前（或者可能在保存之后但在回发到客户端之前）对实体执行某些操作，您可能希望使用插件拦截操作。

最佳方法将取决于实际需要，这取决于您首先尝试获取*guid*的原因。你到底打算用“早期*向导*”做什么？

它是否必须在 JavaScript 中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-15T18:23:55.983

如果记录处于创建模式，我将使用 JavaScript 和 XrmServiceToolkit 创建具有所有可能属性的新记录。这为我在后台执行其他操作提供了所需的 GUID。然后我阻止保存原始表单并在同一窗口中打开新创建的记录。它看起来与常规储蓄完全相同，但它可以满足您的需求。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-08T12:34:26.317

我有一个类似的问题。这可能不是行业最佳实践，但它有效：我在用户有机会保存（并关闭或 saveandnew）之前执行自动保存（Xrm.Page.data.entity.save();）。用户输入所有必填字段后，我执行自动保存。然后生成 Guid 并可在 onload-event 上使用。

# .net - IIS Express 应用程序池版本

> ID：14248617
> 
> 赞同：3
> 
> 时间：2013-01-09T23:56:24.893
> 
> 标签：.net, iis-express

我有一台运行 IIS Express 7.5 并安装了 .NET 3.5 和 .NET 4.0 的 Windows 2003 服务器。服务器上的站点使用 2.0 版应用程序池已经有一段时间了。我们想使用 4.0 版应用程序池。作为概念证明，我将一个项目转换为 .NET 4.0 并开始在 IIS Express 中托管它。这是我的 applicationhost.config 文件中的站点部分：

```
<sites>
    <site name="ShopServer80" id="1" serverAutoStart="true">
        .
        .
        .
        <application path="/Old2.0Application">
            <virtualDirectory path="/" physicalPath="c:\WhereMyProjectLives"/>
        </application>
        .
        .
        .
    </site>
    <siteDefaults>
        <logFile logFormat="W3C" enabled="false" directory="%IIS_USER_HOME%\Logs"/>
        <traceFailedRequestsLogging directory="%IIS_USER_HOME%\TraceLogFiles" enabled="false" maxLogFileSizeKB="1024"/>
    </siteDefaults>
    <applicationDefaults applicationPool="Clr2IntegratedAppPool"/>
    <virtualDirectoryDefaults allowSubDirConfig="true"/>
</sites> 
```

我只想使用列出的一个应用程序并使用`Clr4IntegratedAppPool`所有其他应用程序`Clr2IntegrationAppPool`，所以我添加了属性`applicationPool`：

```
<application path="/New4.0Application" applicationPool="Clr4IntegratedAppPool">
    <virtualDirectory path="/" physicalPath="c:\WhereMyProjectLives"/>
</application> 
```

此时，我收到`BadImageFormatException`：**无法加载文件或程序集“ProjectName”或其依赖项之一。此程序集由比当前加载的运行时更新的运行时构建，无法加载。**. 既然我正在为应用程序指定`Clr4IntegratedAppPool`应用程序池，那么这个问题不应该得到解决吗？加载的运行时应该是 4.0，对吧？

# python - 使用 arcpy Polyline 对象作为字典值时丢失形状信息

> ID：14248618
> 
> 赞同：2
> 
> 时间：2013-01-09T23:56:24.767
> 
> 标签：python, dictionary, arcgis, shapefile, arcpy

环境：Win 7 Enterprise，SP1 | ArcGIS Desktop 10.0 (Python 2.6.5)

我正在尝试将 Arcpy Polyline 对象作为值存储在 Python 字典中，以便可以在数据比较工具中快速引用它们。

问题：一旦我的脚本退出用于将折线对象保存到字典的 FOR 循环，Python 字典中的所有折线对象都具有相同的属性（它们应该都不同）。下面的每个函数都会在内存中创建五个不同的 Polyline 对象，但是，ReadData1 对象的属性都不同，而 ReadData2 对象的属性都相同。

问题：为什么折线对象属性 (.firstPoint .centroid .lastPoint) 在将它们分配为字典值后立即正确，但在 FOR 循环完成后不正确？具体来说，为什么 ReadData1 输出中最终 Polyline 对象的属性与 ReadData2 输出中的所有对象相关联？

代码：

```
import arcpy

def ReadData1(inShapefile):
    print arcpy.Describe(inShapefile).dataType, arcpy.Describe(inShapefile).shapeType
    sRows = arcpy.SearchCursor(inShapefile)
    dataDict = {}
    for row in sRows:
            dataDict[row.FID] = row.Shape
            print '%s || %s || %s' % (dataDict[row.FID].firstPoint, dataDict[row.FID].centroid, dataDict[row.FID].lastPoint)

def ReadData2(inShapefile):
    print arcpy.Describe(inShapefile).dataType, arcpy.Describe(inShapefile).shapeType
    sRows = arcpy.SearchCursor(inShapefile)
    dataDict = {}
    for row in sRows:
            dataDict[row.FID] = row.Shape
    for key in dataDict:
            print '%s || %s || %s' %(dataDict[key].firstPoint, dataDict[key].centroid, dataDict[key].lastPoint) 
```

输出：

```
>>> ReadData1(r'U:\...\TestShapefile.shp')
ShapeFile Polyline
7590284.40892474 668332.064064309 NaN NaN || 7590324.42908373 666711.247624955 NaN NaN || 7592576.19984799 665145.042311657 NaN NaN
7592021.15673377 667418.928618325 NaN NaN || 7592961.14910463 667427.880926619 NaN NaN || 7593901.1414755 667436.833234913 NaN NaN
7594098.09225797 668421.587147249 NaN NaN || 7595183.14682072 667013.998170435 NaN NaN || 7596891.21244568 665682.180809295 NaN NaN
7593793.71377597 665897.03620835 NaN NaN || 7593516.19221886 665261.422319479 NaN NaN || 7593238.67066174 664625.808430607 NaN NaN
7590302.31354132 663336.676036276 NaN NaN || 7593453.20916493 663528.873380711 NaN NaN || 7596533.12011392 663873.814533914 NaN NaN

>>> ReadData2(r'U:\...\TestShapefile.shp')
ShapeFile Polyline
7590302.31354132 663336.676036276 NaN NaN || 7593453.20916493 663528.873380711 NaN NaN || 7596533.12011392 663873.814533914 NaN NaN
7590302.31354132 663336.676036276 NaN NaN || 7593453.20916493 663528.873380711 NaN NaN || 7596533.12011392 663873.814533914 NaN NaN
7590302.31354132 663336.676036276 NaN NaN || 7593453.20916493 663528.873380711 NaN NaN || 7596533.12011392 663873.814533914 NaN NaN
7590302.31354132 663336.676036276 NaN NaN || 7593453.20916493 663528.873380711 NaN NaN || 7596533.12011392 663873.814533914 NaN NaN
7590302.31354132 663336.676036276 NaN NaN || 7593453.20916493 663528.873380711 NaN NaN || 7596533.12011392 663873.814533914 NaN NaN 
```

测试形状文件：http: [//dl.dropbox.com/u/67329940/TestShapefile.zip](http://dl.dropbox.com/u/67329940/TestShapefile.zip)

ESRI 折线对象文档： [http ://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//000v000000n2000000](http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//000v000000n2000000)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T19:56:19.817

您遇到了 ArcGIS 10.0 的一个已知问题。它已在 10.1 中修复，这就是我现在正在使用的。但是我曾经通过将形状转换为列表，然后像这样重新创建它来解决 10.0 上的问题：

```
tractfc = 'c:/temp/test.shp'

rows = arcpy.SearchCursor(tractfc)
dct = {}
for row in rows:
    shp = row.Shape
    lst = list(shp)
    ary = arcpy.Array(lst)
    newshp = arcpy.Polyline(ary, shp.spatialReference)
    dct[row.FID] = newshp

for k in dct:
    print k, dct[k].firstPoint 
```

您可以将 geojson 转换与 AsShape 一起使用并使用 AsShape 进行`__geo_interface__`重建，但这样会丢失空间参考。上述方法保留了空间参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T14:37:54.063

您必须设置 arcpy.Geometry() 来存储您的 row.Shape ，否则您将丢失几何图形。这是上面代码中的一个示例。

```
tractfc = 'c:/temp/test.shp' 
rows = arcpy.SearchCursor(tractfc)
dct = {}

for row in rows:
   g = arcpy.Geometry()
   g = row.Shape
   dct[row.FID] = g

for k in dct:
   print k, dct[k].firstPoint.X, dct[k].firstPoint.Y 
```

# android - 如何将 TestNG 与 Roboelectric 一起使用？

> ID：14248621
> 
> 赞同：5
> 
> 时间：2013-01-09T23:56:29.803
> 
> 标签：android, testing, junit, testng, robolectric

所以我正在尝试将 TestNG 与 RoboElectric 集成，但有点卡住了。

网站上的示例显示了如何为 JUnit 而不是为 TestNG 执行此操作。

@RunWith 但是在 TestNG 中不存在。

有人可以粘贴如何将 RoboElectric 与 TestNG 集成的快速演示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T19:04:05.460

我刚查了这个[RoboelectricTestRunner](http://repo1.maven.org/maven2/com/pivotallabs/robolectric/1.2/robolectric-1.2-sources.jar)

我认为确保 TestNG 设置方法提供所有功能没有问题。

我推荐一个抽象的测试超类，它封装了所有需要的功能

# neo4j - 如何建模时间依赖关系？

> ID：14248623
> 
> 赞同：1
> 
> 时间：2013-01-09T23:56:35.373
> 
> 标签：neo4j

建模和迭代时间相关关系的正确方法是什么？

例如：

*   约翰于 69 年 7 月 3 日与伊丽莎白结婚，并于 73 年 5 月 12 日与她离婚；然后他于 82 年 3 月 18 日与 Corrie 结婚，至今仍结婚。
*   Mark 为 IBM 工作（某些日期间隔），然后是 MSFT（其他时间间隔）等。

还有许多其他与时间相关的关系：

*   住在
*   为**工作
*   报告给
*   属于等

对这些进行建模的正确方法是什么？一个典型的查询是找到一个带有“as of”参数的遍历，例如“谁是 John 的配偶，截至 74 年 1 月 1 日？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:47:03.303

这很容易通过使用索引来完成。索引/属性只能使用原语，因此您可以将 Date 对象转换为 long 值，然后您可以索引该值。您必须将索引存储为特殊的[数字](http://docs.neo4j.org/chunked/milestone/indexing-lucene-extras.html)类型，但之后，您可以根据范围进行搜索，因此您可以执行“之前”或“之后”甚至“之间”类型的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T09:47:02.037

您可以考虑结合[日历子图](http://blog.nigelsmall.com/2012/09/modelling-dates-in-neo4j.html)使用额外的节点来表示特定的婚姻或工作时期。例如，约翰的婚姻可以建模如下：

```
(John)-[:MARRIAGE]->(John+Liz)
(Liz)-[:MARRIAGE]->(John+Liz)
(John+Liz)-[:START_DATE]->(07/03/69)
(John+Liz)-[:END_DATE]->(05/12/73)
(John)-[:MARRIAGE]->(John+Corrie)
(Corrie)-[:MARRIAGE]->(John+Corrie)
(John+Corrie)-[:START_DATE]->(03/18/82) 
```

这为您提供了每个人可能进行的婚姻数量以及是否`END_DATE`存在的灵活性。

希望这可以帮助

尼日

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T08:39:55.163

我通常添加一个带有 on_date 属性的时间戳。

我还建议将您的日期编码为以下格式 YYYYMMDD。然后，您可以轻松地在代码中添加比较。例如：

约翰于 69 年 7 月 3 日与伊丽莎白结婚，并于 73 年 5 月 12 日与她离婚；然后他于 82 年 3 月 18 日与 Corrie 结婚，至今仍结婚。

如果您想知道约翰是否已婚以及与谁结婚，您可以简单地比较日期，并获取结束节点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T09:03:20.137

我会假设总是为每种类型建立两种关系 - living_in_s、lived_in_e、belonged_to_s、belonged_to_e .... 其中后缀“s”和“e”代表该关系的开始时间和结束时间。比，查询 as of 参数可能如下所示：

```
START n=node({John}) 
MATCH n-[r:spouse_of_s]-m, n-[?r2:spouse_of_e]-m
WHERE r2.time? < {timestamp} AND r.time > {timestamp}
RETURN m; 
```

（我可能在 r2 的查询中有错字？，我没有测试就写了）

你可能想使用@nicholas 写的索引

# python - Python：pickle 派生的 str 对象

> ID：14248633
> 
> 赞同：4
> 
> 时间：2013-01-09T23:57:50.873
> 
> 标签：python, string, cpython, pickle

跑步：

```
import pickle

class Foo(str):
    def __new__(cls, s, bar):
        self = super(Foo, cls).__new__(cls, s)
        self.bar = bar
        return self

with open('foo.pkl', 'wb') as w:
    x = pickle.dump(Foo('', 1), w, pickle.HIGHEST_PROTOCOL)

with open('foo.pkl', 'rb') as w:
    x = pickle.load(w) 
```

导致此异常：

```
Traceback (most recent call last):
  File "pkl.py", line 13, in <module>
    x = pickle.load(w)
  File "/usr/lib/python2.7/pickle.py", line 1378, in load
    return Unpickler(file).load()
  File "/usr/lib/python2.7/pickle.py", line 858, in load
    dispatch[key](self)
  File "/usr/lib/python2.7/pickle.py", line 1083, in load_newobj
    obj = cls.__new__(cls, *args)
TypeError: __new__() takes exactly 3 arguments (2 given) 
```

如果我删除它，它会起作用，`pickle.HIGHEST_PROTOCOL`但如果可能的话，我宁愿使用新协议。

我只是没有得到泡菜协议描述。谁能帮我吗？一定有什么神奇的方法……

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T00:05:51.060

这在没有 的情况下有效，`HIGHEST_PROTOCOL`因为旧协议不使用`__new__`构造函数来处理未腌制的对象。

但基本情况是您在`str`向`__new__`. `pickle`模块和内置类型对此`str`一无所知，它将导致显示的错误。

要修复它，您应该定义`__getnewargs__`方法并返回`(self.__class__, self.bar)`足以让它再次工作。

关于模块使用的特殊方法的文档`pickle`可以在[这里找到](http://docs.python.org/2/library/pickle.html#pickling-and-unpickling-normal-class-instances)

# ios - 为什么 SecKeyEncrypt 会为超过 246 字节的输入字符串返回 paramErr (-50)？

> ID：14248634
> 
> 赞同：6
> 
> 时间：2013-01-09T23:58:08.697
> 
> 标签：ios, public-key-encryption

我使用`SecKeyEncrypt`JSON 格式的字符串作为输入。如果传递`SecKeyEncrypt`小于 246 的 plainTextLength，它可以工作。如果我传递它的长度为 246 或更多，它会失败并返回 value: `paramErr (-50)`。

这可能是字符串本身的问题。我可能发送的一个示例`SecKeyEncrypt`是：

```
{ “手柄”： “音乐列表”， “sym_key”： “MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBALeaEO7ZrjgOFGLBzBHZtQuzH2GNDYMLWP + fIFNu5Y + 59C6HECY + jt0yOXXom2mzp / WYYI / 9G + Ig8OD6YiKv2nMCAwEAAQ ==”， “APP_ID”： “xgfdt.LibraryTestApp”， “API_KEY”： “7e080f74de3625b90dd293fc8be560a5cdfafc08” }

```

第 245 个字符是“0”。

在此工作之间发生变化的唯一输入是plainTextLength。`SecKeyGetBlockSize()`正在向我返回 256，因此任何长达 256 个字符的输入都应该有效。

这是我的加密方法：

```
+ (NSData*)encrypt:(NSString*)data usingPublicKeyWithTag:(NSString*)tag
{

    OSStatus 状态 = noErr；

    size_t cipherBufferSize;
    uint8_t *cipherBuffer;

    // [密码缓冲区大小]
    size_t dataSize = 246;//[数据长度OfBytesUsingEncoding:NSUTF8StringEncoding];
    const uint8_t* textData = [[data dataUsingEncoding:NSUTF8StringEncoding] bytes];

    SecKeyRef publicKey = [加密 copyPublicKeyForTag:tag];

    NSAssert(publicKey, @"在尝试使用它加密数据之前，标签引用的公钥必须已经存储在钥匙串中！");

    // 分配一个缓冲区

    cipherBufferSize = SecKeyGetBlockSize(publicKey);
    // 这个值不会被修改，而 cipherBufferSize 可以。
    const size_t fullCipherBufferSize = cipherBufferSize;
    cipherBuffer = malloc(cipherBufferSize);

    NSMutableData* 累积加密数据 = [NSMutableData dataWithCapacity:0];

    // 错误处理

    for (int ii = 0; ii*fullCipherBufferSize < dataSize; ii++) {
        const uint8_t* dataToEncrypt = (textData+(ii*fullCipherBufferSize));
        const size_t subsize = (((ii+1)*fullCipherBufferSize) > dataSize) ？fullCipherBufferSize-(((ii+1)*fullCipherBufferSize) - dataSize) : fullCipherBufferSize;

        // 使用公钥加密。
        状态 = SecKeyEncrypt（公钥，
                               kSecPaddingPKCS1,
                               数据加密，
                               小尺寸，
                               密码缓冲区，
                               &cipherBufferSize
                               );

        [accumulatedEncryptedData appendBytes:cipherBuffer 长度:cipherBufferSize];
    }

    if (publicKey) CFRelease(publicKey);

    免费（密码缓冲区）；

    返回累积加密数据；
}

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T00:08:14.010

从文档中：

> *plainTextLen*
> 明文缓冲区中数据的长度（以字节为单位）。这必须小于或等于 SecKeyGetBlockSize 函数返回的值。**进行PKCS1填充时，可以加密的最大数据长度比SecKeyGetBlockSize函数返回的值（secKeyGetBlockSize() - 11）少11个字节。**

（强调我的）

您正在使用 PKCS1 填充。因此，如果块大小为 256，则一次最多只能加密 245 个字节。

# wordpress - Wordpress 新手，在安装主题和插件时让 getter 出现以下错误

> ID：14248640
> 
> 赞同：0
> 
> 时间：2013-01-09T23:58:41.463
> 
> 标签：wordpress, wordpress-theming

我目前正在使用 Wordpress 开发 2 个站点，并由一个共享主机托管，该主机由几个不同的 WP 狂热者推荐给我。

站点 1 将是一个中高容量的博客。通过我的共享主机的一键安装，它附带了插件**W3 Total Cache**，根据我阅读的所有内容，它是最好的。

2个问题。首先，每次我上传主题时，我都会在管理员中收到以下错误：

每当我尝试更改 W3 Total Cache 中的设置时，我都会在管理员中收到大约 15 到 20 个以下错误：

```
Notice: get_theme is deprecated since version 3.4! Use wp_get_theme( $stylesheet ) 
instead. in /home/jpweber/public_html/wp-includes/functions.php on line 2824

Notice: get_themes is deprecated since version 3.4! Use wp_get_themes() instead. in 
/home/jpweber/public_html/wp-includes/functions.php on line 2824 
```

无论我安装什么主题，我都会在网站的每个页面顶部收到以下 3 个错误：

```
Notice: add_custom_background is deprecated since version 3.4! Use add_theme_support( 
'custom-background', $args ) instead. in /home/jpweber/public_html/wp-includes  
/functions.php on line 2824

Notice: get_theme_data is deprecated since version 3.4! Use wp_get_theme() instead. in 
/home/jpweber/public_html/wp-includes/functions.php on line 2824

Notice: Undefined variable: output in /home/jpweber/public_html/wp-content/themes/respo
/functions/theme-actions.php on line 138 
```

我没有对functions.php进行任何更改，我已经下载了functions.php的新副本，我已经检查了functions.php文件以查看作者主页上的任何答案是否适用，但我已经没有答案。

**更新：**

作为参考，这是我在 functions.php 中的第 2821-2828 行：

```
// Allow plugin to filter the output error trigger
if ( WP_DEBUG && apply_filters( 'deprecated_function_trigger_error', true ) ) {
    if ( ! is_null($replacement) )
        trigger_error( sprintf( __('%1$s is <strong>deprecated</strong> 
      since version %2$s! Use %3$s instead.'), $function, $version, $replacement ) );
    else
        trigger_error( sprintf( __('%1$s is <strong>deprecated</strong> 
    since version %2$s with no alternative available.'), $function, $version ) );
    }
    } 
```

在我的 theme_actions.php 文件中，这是第 138 行：

```
$output .= ' {font:'.$font_nav["style"].' '.$font_nav["size"].'px/1.5em 
    '.stripslashes($font_nav["face"]).';color:'.$font_nav["color"].'}' . "\n"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:01:10.417

这些通知有点告诉你该怎么做，它们非常具有描述性。您要么跟进通知，要么将错误级别设置为低于通知，因此消息将不再显示（但不推荐）

# php - php使用正则表达式从非结构化字符串中提取数据

> ID：14248643
> 
> 赞同：0
> 
> 时间：2013-01-09T23:58:56.670
> 
> 标签：php, regex, parsing

我需要从来自短信的非结构化字符串中提取数据

我需要提取的数据如下

代码：这是一个由 5 个字母数字组成的字符串，它必须包含至少一个数字

身份证件：这是一个 5 到 8 个字符之间的数字字符串，有效格式为：

```
V55555555
E55555555
55555
55 555
E55 555 555
55 555 555
5 555 555
555 555 
```

我需要提取的数据可以在字符串中的任何位置，我已经对字符串进行了规范化，只用一个替换了重复的空格，并删除了不是空格、数字和字母的任何内容

样品

```
1\. resuelvete 15C20 Pdero Perez c.i. V55.555.555,
2\. Pedro Perez resuelvete 15c20 55 555 555,
3\. 15c20 Resuelvete 555555 Pedro Perez,
4\. Resuelvete 555555 Pedro Perez 15c20 
```

对于代码部分，我尝试了这个正则表达式：

```
$regex = '/([a-zA-Z0-9]{5})/i'; 
```

我也试过这个：`$regex = '(?=.{5})(?=.*[A-Z])(?=.*[a-z])(?=.*\d)[a-zA-Z\d]';`，我[在这里](https://stackoverflow.com/questions/11319028/php-regex-for-password-validation "这里")看到但它不起作用（我必须说我不完全理解这个正则表达式）

但它不起作用，它返回字符串的前五个字符，我需要它在这个例子中返回`15c20`

对于身份文件部分，我尝试了以下方法：

```
// This not work with spaces
$regex = "/(V|E)?(\d{5,8})/i";

// This not work without spaces
//This fail in first case returning only 7 digits instead of 8
// Also fails in cases  3 and 4,  does not match anything
$regex = "/(V|E)?(\d{1,2}? ?\d{3} ?\d{3})/i"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:23:00.527

这应该适用于代码部分（注意我假设这里必须至少有一个字母字符，否则您将无法区分 ##### 案例的代码和身份）

```
$code_pattern = '/\b(?=.*[\d].*\b)(?=.*[a-zA-Z].*\b)[a-zA-Z\d]{5}\b/'; 
```

请注意，该`(?=....)`语法是所谓的积极前瞻。它用于断言模式的该部分中即将出现的值与该模式匹配（实际上不计为匹配中的字符。

对于身份部分，我会保持简单（即不要寻找一个适合所有解决方案的正则表达式）并在您的`preg_*`函数中使用一系列模式。

```
$identity_patterns = array(
    '/\b(V|E)[0-9]{8}\b/', // V########, E########
    '/\b[\d]{5}\b/', // #####
    '/\bE[\d]{2}\w[\d]{3}\w[\d]{3}\b/', // E## ### ###
    '/\b[\d]{1,3}\w[\d]{3}(\w[\d]{3})?\b/' // #{1,3} ### (###)?
); 
```

当然可以将所有这些统一到一个正则表达式中，但是如果将来需要，它会使得阅读和修改变得非常困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T03:18:08.880

> **[编辑]**我**`\w`**将以下正则表达式模式中的所有 's 更改为**`[a-zA-Z0-9]`**因为**`\w`**还包含下划线（ _ ）字符，我在写这个答案时忘记了它。

对于代码，您可以使用类似

```
~\b(?=[a-zA-Z0-9]{5}\b)[a-zA-Z0-9]*\d[a-zA-Z0-9]*~ 
```

可以分解成

```
\b                  # a word boundary (beginning of word in this case)
(?=                 # from here on...
    [a-zA-Z0-9]{5}  # 5 alphanumeric characters (a-z,A-Z,0-9)
    \b              # followed by a word boundary (end of word)
)
[a-zA-Z0-9]*        # 0 or more alphanumeric characters (a-z,A-Z,0-9)
\d                  # a decimal
[a-zA-Z0-9]*        # 0 or more alphanumeric characters (a-z,A-Z,0-9) 
```

对于 id 文档...如果除了您提供的示例之外没有其他可能的分组，您可以使用类似

```
'~(?<=\b|\bE|\bV)(?=[\d\ .]{5,10}\b)(
    \d{8}|
    \d{5}|
    \d{3}[\ .]\d{3}|
    \d{2}([\ .])\d{3}(\2\d{3})?|
    \d([\ .])\d{3}\4\d{3}
)~x' 
```

这说

```
(?<=                        # preceded by
    \b|                     # a word boundary (beginning of word) or
    \bE|                    # a word boundary (beginning of word) and E or
    \bV                     # a word boundary (beginning of word) and V
)
(?=                         # from here on...
    [\d\ .]{5,10}           # a group consisting of only decimals, spaces and dots 
    \b                      # followed by a word boundary (end of word)
)
(                           # either:
    \d{8}|                  # an 8 digit number
    \d{5}|                  # a 5 digit number
    \d{3}[\ .]\d{3}|        # a 3 digit number, space or dot, a 3 digit number
    \d{2}([\ .])\d{3}       # a 2 digit number, space or dot, a 3 digit number
    (                       # optionally...
        \2                  # previous sign (space or dot)
        \d{3}               # a 3 digit number
    )?| 
    \d([\ .])\d{3}\4\d{3}   # a 1 digit number, space or dot, a 3 digit number, previous sign, a 3 digit number
) 
```

# perl - 如何使用 Pod::Weaver 为方法定义多个小节？

> ID：14248648
> 
> 赞同：3
> 
> 时间：2013-01-09T23:59:28.177
> 
> 标签：perl, methods, documentation, dist-zilla

我有一些 Moose 类，它们定义了几组相关方法。我想让这些组在包 POD 中显而易见。

我使用and`Dist::Zilla`命令。是否可以在我的命令之间插入一些命令以达到预期的效果？`Pod::Weaver``=method``=head2-like``=method`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T02:03:20.187

我在这里写了一篇关于我是如何为[Redis::Client](https://metacpan.org/module/Redis%3a%3aClient)做到这一点的帖子：[Falling in Love with Pod::Weaver](http://friedo.com/blog/2011/11/falling-in-love-with-podweaver)。

最简单的做法是向您添加自定义`Collect`指令`weaver.ini`并通过为每种类型提供不同的自定义 POD 命令来组织您的方法，如下所示：

```
[Collect / FOO METHODS]
command = foo_method

[Collect / BAR METHODS]
command = bar_method

[Collect / BAZ METHODS]
command = baz_method 
```

然后像这样写你的POD

```
=foo_method blah blah 
```

而Weaver会自动将它们收集到自己的下面`=head1`。

如果你想做比这更复杂的事情，你可以编写自己的 Pod::Weaver 插件。要点是在已解析的 POD 中搜索自定义命令名称，并通过返回[Pod::Elemental](https://metacpan.org/module/Pod%3a%3aElemental)对象来转换它们。这是我写的插件：

```
package Pod::Weaver::Plugin::RedisLinks;

# ABSTRACT: Add links to Redis documentation

use Moose;
with 'Pod::Weaver::Role::Transformer';

use Data::Dumper;
use Scalar::Util 'blessed';
use aliased 'Pod::Elemental::Element::Pod5::Ordinary';

sub transform_document {
    my ( $self, $doc ) = @_;

    my @children = $doc->children;

    my @new_children;
    foreach my $child( @{ $children[0] } ) {
        if ( $child->can( 'command' )
             && $child->command =~ /^(?:key|str|list|hash|set|zset|conn|serv)_method/ ) {
            my $meth_name = $child->content;
            $meth_name =~ s/^\s*?(\S+)\s*$/$1/;

            my $cmd_name = uc $meth_name;
            $cmd_name =~ tr/_/ /;

            my $link_name = $meth_name;
            $link_name =~ tr/_/-/;

            my $new_para = Ordinary->new(
                content => sprintf 'Redis L<%s|%s> command.',
                           $cmd_name, 'http://redis.io/commands/' . $link_name );

            push @new_children, $child, $new_para;
            next;
        }

        push @new_children, $child;
    }

    $doc->children( \@new_children );
}

__PACKAGE__->meta->make_immutable;

1; 
```

该`transform_document`方法将解析的文档作为参数传递。然后它通过顶级命令查找标记为 的元素`/^(?:key|str|list|hash|set|zset|conn|serv)_method/`，稍微修改名称，然后构建一个新的 POD 段落，其中包含我想要的格式化 POD 内容。

# java - Android JDBC 连接问题

> ID：14248655
> 
> 赞同：0
> 
> 时间：2013-01-10T00:00:50.077
> 
> 标签：java, android, mysql, jdbc, phpmyadmin

我正在尝试连接到我网站的 MySQL 数据库，但我不了解 PHP，所以我决定使用 JDBC。我遵循了一些视频教程（非 JDBC）并使用了他们的步骤。我跳过了 MAMP 步骤，因为我没有在我的 PC 上托管服务器。它在本地托管，因为它将成为一个更大的网站。

所以我在我的登录活动中输入了这段代码（你看到的第一个屏幕）：

```
Connection connection = null;
    Statement statement = null;

    String username = "username";
    String password = "password";

    String dbURL = "jdbc:mysql://216.26.176.52:3306/lifesizefoto";

    try {
        Class.forName("com.mysql.jdbc.Driver").newInstance();
        connection = DriverManager.getConnection(dbURL, username, password);
        statement = connection.createStatement();
        System.out.println("Connected.");
    } catch (ClassNotFoundException error) {
        System.out.println("Cannot connect");
    } catch (SQLException error) {
        System.out.println("Error: " + error.getMessage());
    } catch (InstantiationException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } finally {
        if (connection != null) { try {connection.close();} catch (SQLException ignore) {} }
        if (statement != null) { try {statement.close();} catch (SQLException ignore) {} }
    } 
```

我已经尝试了 .getConnection() 语句的许多变体，但我无法弄清楚。我还联系了网站主机，他为我的 IP 关闭了所有防火墙，甚至为该应用程序打开了一个特殊端口。

当我运行我的应用程序时，我收到此错误：

```
 01-09 18:59:32.769: I/System.out(14178): Error: Communications link failure
01-09 18:59:32.769: I/System.out(14178): The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server. 
```

我将不胜感激任何帮助。提前谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T03:24:28.290

两个想法：

*   您网站的 MySQL 服务器不太可能绑定到外部接口 - 它可能只在 localhost 接口上侦听。您的托管服务提供商应该能够为您确认/可能解决该问题。

*   从长远来看，尝试将移动应用程序直接连接到服务器数据库可能效果不佳 - 我建议您要么弄清楚如何编写服务器端应用程序（供您的移动应用程序连接） PHP，或找到​​您的主机支持的另一种语言，然后使用它。

# javascript - highcharts散点图中的单个点颜色

> ID：14248661
> 
> 赞同：3
> 
> 时间：2013-01-10T00:01:12.983
> 
> 标签：javascript, charts, highcharts

请尝试以下代码：

```
<script src="http://code.highcharts.com/highcharts.js"></script>

<div id="container" style="height: 400px"></div> 
```

和

```
$(function () {
    var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            type: 'column'
        },
        series: [{
          data: [194.1, 95.6, {y:54.4,color:'#FF0000'}]
        }]
    });
}); 
```

或在[jfiddle](http://jsfiddle.net/Uu9ck/)中运行它。

HighCharts 将最后一根柱线涂成红色。现在，如果您将图表类型从“列”更改为“散点”，您将看到 HighCharts 不会为最后一个标记着色，而是为其工具提示着色。

如何使 HighCharts 为散点图中的特定点着色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:06:46.280

设置“fillColor”，而不是（或以及）“颜色”：

```
series: [{
  data: [194.1, 95.6, {y:54.4, fillColor:'#FF0000'}]
}] 
```

[http://jsfiddle.net/Uu9ck/1/](http://jsfiddle.net/Uu9ck/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-09-28T16:43:42.763

你不需要设置`fillColor`. `color`就像在你的例子中一样，如果你将**系列**类型设置为`scatter`（而不是图表类型）：

```
$(function () {
    var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
        },
        series: [{
          type: 'scatter',  // <- this
          data: [194.1, 95.6, { y:54.4, color:'#FF0000' }]
        }]
    });
});
```

这是[小提琴](http://jsfiddle.net/Uu9ck/169/)。

# c++ - 矩形碰撞

> ID：14248667
> 
> 赞同：0
> 
> 时间：2013-01-10T00:02:08.123
> 
> 标签：c++, math, collision-detection

这更像是一个编程*问题*而不是技术问题，但由于它与编程和数学有关，我希望能得到一些有用的反馈。

我有两个矩形：*rectangle1*和*rectangle2*。

两者都由四个浮点值定义：

```
float left;
float right;
float top;
float bottom; 
```

为了这个例子，假设每个矩形是 100 x 100，矩形 1 是：

```
float left = 100.0;
float right = 200.0;
float top = 500.0;
float bottom = 600.0; 
```

矩形2是：

```
float left = 150.0;
float right = 250.0;
float top = 550.0;
float bottom = 650.0; 
```

当发生碰撞时，我试图使用八个浮点值来确定矩形 1 的哪一侧撞到了矩形 2 的哪一侧。

如果我的问题得到了解答，我可能会在发生碰撞时确定以下内容：

*矩形 1 的右侧命中矩形 2 的左侧*

到目前为止，我已经尝试使用简单的数学来确定每种可能性之间的距离：

```
float distance1 = rectangle2.left - rectangle1.right;
float distance2 = rectangle2.top - rectangle1.bottom;
float distance3 = rectangle2.right - rectangle1.left;
float distance4 = rectangle2.bottom - rectangle1.top; 
```

然后取这些值中的最小值来确定每个矩形的哪一侧参与了碰撞。不过，这似乎并不那么简单。这种尝试有两个基本问题：

**1)**到达碰撞代码时，矩形已经重叠。

**2）**如果多个矩形堆叠在一起，计算会产生奇怪的结果（即，即使矩形1在右上方向移动并且应该击中左侧的两个矩形，它实际上可能会击中左侧的一个矩形底部和左侧的另一个。）

（这是因为到达碰撞代码时矩形重叠，并且在这种情况下距离 1 和距离 4 将接近或相等。）

有没有更好的方法来使用简单的数学来回答这个问题？任何帮助，将不胜感激。

而且，在提到之前，这不是家庭作业，而是我试图为我的游戏解决的一个真正问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:30:42.427

如果您可以正确识别碰撞，则确定面绘制一条连接 2 个矩形的中心的线，并检查与每个矩形的面是否相交。在任何给定时间，只要 2 个矩形不重叠或准确地说，只要 1 的中心不在另一个内部，这条线就会与 2 个面相交。

当它们重叠时，您可以获得 1 或 0 个交点。案例0：1个矩形完全在另一个矩形内，因此您可以决定如何确定要击中哪些边，可以选择最靠近每个中心的一个。

情况1：矩形完全或部分在另一个内部。在任何一种情况下，继续延长连接中心的线，直到穿过外部（包含）矩形。如果您之前再次穿过包含的矩形，只需将命中面更改为新穿过的面。

希望它不会太混乱:)

# xcode - 日期转换为字符串 xcode

> ID：14248669
> 
> 赞同：0
> 
> 时间：2013-01-10T00:02:19.807
> 
> 标签：xcode, date

我正在开发一个显示开始日期和结束日期的应用程序，但我在文本字段上显示日期时遇到问题

这里一切正常：![截屏](../Images/07503b2be71776c7cce11d49fe529946.png)

但是当我在输出中转到 2012 年 12 月 30 日时，您可以读到 2012（硬编码），但在文本字段中它写的是 2013（格式化）：

![截屏](../Images/79dde54124fdd6200460b58321fd0fea.png)

如果我尝试使用“全天”选项，也会发生同样的事情：

![截屏](../Images/0599db132766a2ff868c906e9071e75b.png)

也会分享我的应用程序代码，让事情变得更容易

```
#import "StartEndEventVC.h"
#import "visitVC.h"
#import "Functions.h"

@interface StartEndEventVC ()
{
    NSDate                  *date;
    NSDateFormatter         *df;
    NSString                *selectedCell;
}

@property (nonatomic, strong) Functions *funciones;
@end

@implementation StartEndEventVC

@synthesize funciones       = _funciones;
@synthesize datePicker      = _datePicker,
            SwitchDate      = _SwitchDate,
            fecFinDateSE    = _fecFinDateSE,
            fecInicioDateSE = _fecInicioDateSE;

#pragma mark *** Common methods ***
- (void)viewDidLoad
{
    [super viewDidLoad];

    //Datepicker initial settings
    self.datePicker.timeZone = [NSTimeZone localTimeZone];
    self.datePicker.locale   = [NSLocale currentLocale];
    self.datePicker.calendar = [NSCalendar currentCalendar];

    //Date format initial settings
     df             = [NSDateFormatter new];
    [df setDateFormat:@"EE, dd MMM YYYY HH:mm a"];
    [df setTimeZone:[NSTimeZone localTimeZone]];

    //initial cell to interact with datepicker
    selectedCell    = @"startDate";

    self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"back"
                                                                             style:UIBarButtonItemStyleBordered
                                                                            target:self
                                                                           action:@selector(didBack:)];
}

-(void)estableceFechaCamposTexto{

    self.fecInicioDateSE        = [[NSDate alloc]init];
    self.fecFinDateSE           = [[NSDate alloc]init];

    self.fecInicioDateSE        = [NSDate date];
    self.fecFinDateSE           = [self.fecInicioDateSE dateByAddingTimeInterval:60*60];

    self.startDateLabel.text    = [df stringFromDate:self.fecInicioDateSE];
    self.endDateLabel.text      = [df stringFromDate:self.fecFinDateSE];
}

-(void)viewDidAppear:(BOOL)animated{
    if ((self.fecInicioDateSE == nil) || (self.fecFinDateSE == nil)) [self estableceFechaCamposTexto];

        self.startDateLabel.text    = [df stringFromDate:self.fecInicioDateSE];
        self.endDateLabel.text      = [df stringFromDate:self.fecFinDateSE];
}

-(Functions *)funciones{
    if (!_funciones) _funciones = [[Functions alloc]init];
    return _funciones;
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    if ([segue.identifier isEqualToString:@"doneStartEnd"]) {

        [segue.destinationViewController setFecInicioDateV:  self.fecInicioDateSE];
        [segue.destinationViewController setFecFinDateV:     self.fecFinDateSE];

        NSLog(@"fecha inicio StartEvent: %@", self.fecInicioDateSE);
        NSLog(@"fecha fin    StartEvent: %@", self.fecFinDateSE);

    }
}

#pragma mark - Table view delegate
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    switch (indexPath.row) {
        case 0:
            selectedCell = @"startDate";
            self.datePicker.date = self.fecInicioDateSE;

            break;
        case 1:
            selectedCell = @"endDate";
            self.datePicker.date = self.fecFinDateSE;
        default:
            break;
    }
}
#pragma mark -

#pragma mark *** Custom methods ***
-(void)comparaFechaInicio{

    if ([self.fecInicioDateSE timeIntervalSinceDate:self.fecFinDateSE] >= 0) {
        if (self.SwitchDate.on)     self.fecFinDateSE = [self.fecInicioDateSE dateByAddingTimeInterval:60*60*24];
        else
            if(!(self.SwitchDate.on))   self.fecFinDateSE = [self.fecInicioDateSE dateByAddingTimeInterval:60*60];
    }

    self.startDateLabel.text    = [df stringFromDate:self.fecInicioDateSE];
    self.endDateLabel.text      = [df stringFromDate:self.fecFinDateSE];

    NSLog(@"Hardcoded date: %@", self.fecInicioDateSE);
    NSLog(@"formatted date: %@", [df stringFromDate:self.fecFinDateSE]);
}

- (void) didBack:(id)sender {
    [self.navigationController popViewControllerAnimated:YES];
}

#pragma mark -

#pragma mark *** Button actions ***
-(IBAction)adjustDate:(id)sender{
    if ([selectedCell isEqualToString:@"startDate"]){

        self.fecInicioDateSE = [self.datePicker date];
        [self comparaFechaInicio];
    }
    else
        if ([selectedCell isEqualToString:@"endDate"]){

            self.fecFinDateSE = [self.datePicker date];
            self.endDateLabel.text  = [df stringFromDate:self.datePicker.date];
        }
}

- (IBAction)saveChanges:(id)sender {
    [self comparaFechaInicio];

    [self performSegueWithIdentifier:@"doneStartEnd" sender:self];
}

-(IBAction)changeDateType:(id)sender{
    if (self.SwitchDate.on){
        self.datePicker.datePickerMode  = UIDatePickerModeDate;
        [df setDateFormat:@"EE, dd MMM YYYY"];
    }
    else{
        self.datePicker.datePickerMode  = UIDatePickerModeDateAndTime;
        [df setDateFormat: @"EE, dd MMM YYYY HH:mm a"];
    }

    [self comparaFechaInicio];
}
#pragma mark -
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:23:33.120

[你落入了与苹果最近的“请勿打扰”漏洞](http://arstechnica.com/apple/2013/01/ask-ars-why-will-apples-do-not-disturb-bug-fix-itself-next-week/)相同的陷阱。你想`yyyy`在你的 NSDateFormatter 中使用，而不是`YYYY`.

# c# - System.Linq.Expressions：在运行时绑定 LambdaExpression 输入

> ID：14248674
> 
> 赞同：3
> 
> 时间：2013-01-10T00:02:43.927
> 
> 标签：c#, .net

考虑以下设置：

```
class A { public int x; }
class B { public int y; }

static class Helper
{
    public static Expression<Func<B>> BindInput(
        Expression<Func<A, B>> expression,
        A input)
    {
        //TODO
    }
}

static void Main(string[] args)
{
    Expression<Func<B>> e = Helper.BindInput(
        (A a) => new B { y = a.x + 3 },
        new A { x = 4 });

    Func<B> f = e.Compile();
    Debug.Assert(f().y == 7);
} 
```

我想要在该方法中做的`BindInput`是将表达式转换为`input`嵌入其中。在 中的示例用法中`Main`，结果表达式`e`将是

```
() => new B { y = input.x + 3 } 
```

`input`传入的第二个值在哪里`BindInput`。

我该怎么做呢？

**编辑：**

我应该补充一点，以下表达式`e`不是**我**想要的：

```
((A a) => new B { y = a.x + 3 })(input) 
```

这将是相当微不足道的，因为它只涉及在现有表达式的顶部添加一个层。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:31:48.110

经过大量搜索，我偶然发现了魔法`ExpressionVisitor`课。以下似乎工作完美：

```
class MyExpressionVisitor : ExpressionVisitor
{
    public ParameterExpression TargetParameterExpression { get; private set; }
    public object TargetParameterValue { get; private set; }
    public MyExpressionVisitor(ParameterExpression targetParameterExpression, object targetParameterValue)
    {
        this.TargetParameterExpression = targetParameterExpression;
        this.TargetParameterValue = targetParameterValue;
    }
    protected override Expression VisitParameter(ParameterExpression node)
    {
        if (node == TargetParameterExpression)
            return Expression.Constant(TargetParameterValue);
        return base.VisitParameter(node);
    }
}

static class Helper
{
    public static Expression<Func<B>> BindInput(Expression<Func<A, B>> expression, A input)
    {
        var parameter = expression.Parameters.Single();
        var visitor = new MyExpressionVisitor(parameter, input);
        return Expression.Lambda<Func<B>>(visitor.Visit(expression.Body));
    }
} 
```

# assembly - 与 JMP 指令混淆

> ID：14248675
> 
> 赞同：0
> 
> 时间：2013-01-10T00:02:44.630
> 
> 标签：assembly, inline-assembly

我编写了一个内联汇编程序来取消**/home/httpd中的****“grades.txt”**的链接，代码如下：

 **```
void main()
{
   __asm__(
   "jmp L\n"\
   "sub1:\n"\
   "movl 0x4(%esp), %ebx\n"\
   "movb $0xa, %al\n"\
   "int $0x80\n"\
   "L:\n"\
   "call sub1\n"\
   ".string \"//home//httpd//grades.txt\" "
   );
} 
```

我认为代码应该做我想做的事，取消链接“/home/httpd”中的grades.txt，但是当我执行它时，有一个段错误。

而我用gdb来解决这个问题，我发现它无法执行“jmp L”行，程序会在第5行时停止[“__asm__（”]，直到我输入“ctrl + c”中断它。

如果我添加“exit(0)”的程序集让程序干净地退出，并继续执行它，程序将直接退出而不做任何事情。

所以这很令人困惑，**为什么程序不执行 jmp 指令？**有没有错误？

我将非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:16:22.003

一些事情：

*   您应该使用`%eax`而不是`%al`因为 3 个最重要的字节不能`000000`
*   该`movl 0x4(%esp), %ebx`行应该是`movl (%esp), %ebx`因为`%ebp`没有被压入堆栈，因此返回地址位于`%esp+0`
*   完成后`int 80h`，代码将失败并`sub1`一遍又一遍地调用，因此您需要额外的跳转：

    ```
    int80h
    add $4, %esp # pop the return address
    jmp exit     # jump over the call
    call sub1
    ....
    exit: 
    ```

*   无需使用`\`- 字符串将为您连接

*   `void`不是`main()`C 中的有效返回类型

总结以上tips：

```
int main()
{
   __asm__(
   "jmp L\n"
   "sub1:\n"
   "movl (%esp), %ebx\n"
   "movl $0xa, %eax\n"
   "int $0x80\n"
   "add $4, %esp\n"
   "jmp exit\n"
   "L:\n"
   "call sub1\n"
   ".string \"//home//httpd//grades.txt\"\n"
   "exit:\n"
   );
} 
```**

# mysql - Convert decimal stored as varchar to datetime

> ID：14248678
> 
> 赞同：-1
> 
> 时间：2013-01-10T00:02:47.683
> 
> 标签：mysql, datetime, varchar

I've inherited a MySQL database with a date column type of `Varchar`.

The column contains decimal strings. For example: `41143.646585648`.

How would I go about converting this into DateTime format?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:27:54.270

All you need to know is the date the original developer defined as the value zero. Then it's a simple matter of adding the integer number of days to that date, then multiplying the fractional part by 86400 to get seconds and doing the arithmetic to determine the hour, minute and second.

If you have a row where you know the actual date and the stored value you can determine the zero date easily by subtraction.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:35:53.870

You could string replace the dot, but the remaining count of numbers is to high for a unix timestamp. I don't know how the date was converted to decimal. Maybe you should split your string rather than string replace.

Maybe this code gives you some ideas for a solution:

```
#SELECT FROM_UNIXTIME(REPLACE('41143.646585648', '.', '')); # Does not work due to wrong amount of numbers in string

SELECT FROM_UNIXTIME(REPLACE('13577.77916', '.', '')); # works 
```

# javascript - 限制对页面的访问，除非来自特定页面

> ID：14248680
> 
> 赞同：0
> 
> 时间：2013-01-10T00:03:02.693
> 
> 标签：javascript, html

我知道这个问题已经被问过很多次了，但是我需要进一步的澄清和一个可以帮助我的人的直截了当的回答！

在我通过 weebly.com 托管的网站上，我有一个简单的登录页面，其中包含一个简单的 HTML 脚本，一旦他们为他们的帐户输入正确的用户名和密码凭据，该脚本基本上用于将流量引导到所需的页面。

可以这样想：

登录页面（用户输入凭据）船员中心（如果成功登录，将重定向到此页面）

我在这里寻求解决方案的原因是因为我现在遇到用户的问题，他们只是为船员中心添加书签，而不是每次都通过登录页面进行登录。有没有办法强制他们登录？

有谁知道一个 HTML 脚本（我也很乐意考虑 java-script），它可以阻止和重定向不首先登录的用户？我正在使用一个脚本来限制不是来自特定页面（在本例中为登录页面）的用户，结果他们被重定向到一个页面，我会说“你必须先登录才能访问此功能。

我只是想强调一点，我根本不追求任何安全的东西，只是一些简单的东西，这只是为了感觉和体验。

如果有人需要进一步澄清我的问题，请告诉我！

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:12:38.663

我假设您在登录页面上使用 JavaScript 来检查凭据。如果是这种情况，您可以在同一个 JavaScript 中设置一个“已登录”cookie，然后在船员中心页面上检查该 cookie。

您还需要以某种方式让 cookie 消失。设置一个短暂的超时或将 JavaScript 放在船员中心页面上以将其删除。

这是一些示例代码：

```
// Put this in your login function, just before the redirect
var sessionTimeout = 1; //hours
var loginDuration = new Date();
loginDuration.setTime(loginDuration.getTime()+(sessionTimeout*60*60*1000));
document.cookie = "CrewCentreSession=Valid; "+loginDuration.toGMTString()+"; path=/";

// Put this at the top of your Crew Centre page
if (document.cookie.indexOf("CrewCentreSession=Valid") == -1) {
  location.href = "/Login.html";
} 
```

# rss - Google Calendar Feed 渲染 1 进入 2

> ID：14248681
> 
> 赞同：0
> 
> 时间：2013-01-10T00:03:15.623
> 
> 标签：rss, feed, google-calendar-api, icalendar

这是我的播客提要： [https ://www.google.com/calendar/feeds/eci0cg9lo08bfp5uuuci7rk33k%40group.calendar.google.com/public/full?futureevents=true&orderby=starttime&sortorder=ascending](https://www.google.com/calendar/feeds/eci0cg9lo08bfp5uuuci7rk33k%40group.calendar.google.com/public/full?futureevents=true&orderby=starttime&sortorder=ascending)

如您所见，第 85 集被列出了两次，但两个链接都指向日历中的第 1 集 85 条目。

再往下看，第 92 集再次出现 - 将其列为 2 个单独的条目，单击任一链接时，您将转到第 92 集。

谷歌日历提要错误？为什么？没有这些问题的任何其他方式来呈现此列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T20:10:42.240

最后，使用定期事件和 Google 日历似乎存在问题。通过删除重复事件，条目会按预期显示在提要中。

# c - 扫描以 .wor 结尾的目录中的所有文件

> ID：14248685
> 
> 赞同：0
> 
> 时间：2013-01-10T00:03:35.923
> 
> 标签：c, file, directory, counter

我正在尝试编写 ac 代码来扫描整个目录以查找以 .wor 结尾的文件，打开每个文件并从中提取某些信息。
到目前为止，我的代码已成功打开该目录中的所有文件，并扫描它们以查找目标词。有没有办法让我修改代码，使其只扫描以 .wor 结尾的文件？我尝试了通配符“*.wor”，但它只是给我一个错误，说符号 * 和 .wor 无法识别。
非常感谢你的帮助！
（顺便说一句，我最后添加的计数器也无法工作，我尝试使用整数“c”在每次读取文件时递增，并显示最后读取的文件总数。它只是给出我现在是 0。）

这是我的代码：

```
 #include <stdio.h>
    #include <string.h>
    #include <stdlib.h>
    #include <sys/types.h>
    #include <dirent.h>
    #include <unistd.h>
    #include <errno.h>

    int main(int argc, char **argv) {

char file[100];
char buff[100];
char delims[] = " :=";
char *result = NULL;
char *customer;
char *device;
char *testprog;
char *software;
char *dutboardid;
char *corlbox;
int i=0;
DIR * FD;
struct dirent* in_file;
int c = 0;

    FILE * ft = fopen ( "WorkOrderInfo.csv", "w" ) ;    /* Open file to write to*/
    if ( ft == NULL )
    {
           puts ( "Cannot open target file" ) ;
           exit( 1 ) ;
    }

    fprintf (ft, "Work Order,Customer,Device,Test_Prog,Software,DUT_board_id,Corl box\n");

/* Open Directory*/

if (NULL == (FD = opendir ("/home/iselabs/dwang/pinscale/workorder/practice"))) 
    {
    fprintf(stderr, "Error : Failed to open input directory - %s\n");
    fclose(ft);

    return 1;
    }

    while ((in_file = readdir(FD))) 
    {

    if (!strcmp (in_file->d_name, "."))
        continue;
    if (!strcmp (in_file->d_name, ".."))    
        continue;

    /* Open files to read from  */

    FILE * fs = fopen(in_file->d_name, "r");
    if (fs == NULL)
    {
        puts ("Cannot open source file");

        return 1;
    }

    /* Scanning each file for targeted words: */

while( fgets(buff, 100,fs) != NULL )      
{   
 result = strtok( buff, delims );          
    while(result != NULL){                   
            if((strcmp(result,"Customer")==0)){ 
        result = strtok(NULL,delims);  
        customer = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(customer, result);
        for(i=0;i<strlen(customer)+1;i++){ if(customer[i] == '\n') break; }
        customer[i] = ' ';
        }

            if((strcmp(result,"name")==0)){ 
        result = strtok(NULL,delims);  
        customer = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(customer, result);
        for(i=0;i<strlen(customer)+1;i++){ if(customer[i] == '\n') break; }
        customer[i] = ' ';
        }

            if(strcmp(result,"device")==0){ 
        result = strtok(NULL,delims);  
        device = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(device, result);
        for(i=0;i<strlen(device)+1;i++){ if(device[i] == '\n') break; } 
        device[i] = ' ';
        }

            if(strcmp(result,"test_prog")==0){ 
        result = strtok(NULL,delims);  
        testprog = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(testprog, result);
        for(i=0;i<strlen(testprog)+1;i++){ if(testprog[i] == '\n') break; } 
        testprog[i] = ' ';
        }

            if(strcmp(result,"Rev")==0 || strcmp(result,"use")==0){ 
        result = strtok(NULL,delims);  
        software = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(software, result);
        for(i=0;i<strlen(software)+1;i++){ if(software[i] == '\n') break; } 
        software[i] = ' ';
        }

        if(strcmp(result,"rev")==0){ 
        result = strtok(NULL,delims);  
        software = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(software, result);
        for(i=0;i<strlen(software)+1;i++){ if(software[i] == '\n') break; } 
        software[i] = ' ';
        }

            if(strcmp(result,"DUT_board_id")==0){ 
        result = strtok(NULL,delims);  
        dutboardid = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(dutboardid, result);
        for(i=0;i<strlen(dutboardid)+1;i++){ if(dutboardid[i] == '\n') break; } 
        dutboardid[i] = ' ';
        }                   
        else if (strcmp(result,"DUT_board_id")==1){
        corlbox = "N/A";
        }

            if(strcmp(result,"box")==0){ 
        result = strtok(NULL,delims);  
        corlbox = (char*)malloc((strlen(result)+1)*sizeof(char));
        strcpy(corlbox, result);
        for(i=0;i<strlen(corlbox)+1;i++){ if(corlbox[i] == '\n') break; } 
        corlbox[i] = ' ';
        }
        else if (strcmp(result,"box")==1){
        corlbox = "N/A";
        }           
        result = strtok(NULL,delims);
    }

}

fprintf (ft, "%s,%s,%s,%s,%s,%s,%s\n", file, customer, device, testprog, software, dutboardid, corlbox);

fclose (fs) ;
printf("hey\n");
c = c++;                             /*Increments c by 1 every time a file is read */
}

printf("total files scanned: %d \n", c);
    fclose ( ft ) ;
return 0; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:17:36.917

您可以手动检查每个文件名是否以`.wor`如下方式结尾：

```
size_t len = strlen(in_file->d_name);
if (len >= 4 && memcmp(in_file->d_name + len - 4, ".wor", 4) == 0)
{
    // The filename ends in ".wor" (case-sensitive).  Note that this also
    // accepts the file whose entire name is ".wor".
} 
```

或者，您可以改为使用该[`glob(3)`](http://linux.die.net/man/3/glob)函数来获取与特定通配符匹配的文件名列表：

```
// Error checking omitted for expository purposes
glob_t globbuf;
glob("/home/iselabs/dwang/pinscale/workorder/practice/*.wor", 0, NULL, &globbuf);

for (size_t i = 0; i < globbuf.gl_pathc; i++)
{
    char *filename = globbuf.gl_pathv[i];
    // Process filename...
}

globfree(&globbuf); 
```

# mysql - 多行使用的内连接

> ID：14248686
> 
> 赞同：1
> 
> 时间：2013-01-10T00:03:51.270
> 
> 标签：mysql

我需要从成员表中选择 2 行来获取名称和 ID，并且我需要从消息表中获取所有行。到目前为止，这是我所拥有的任何提示或帮助，我们将不胜感激 EDIT Tables

![会员](../Images/d4458bcbc59b6aa57d09052feeb0de3c.png) ![短信](../Images/670ca19a910014ca32a7995187f02f38.png)

```
 SELECT member_messages.message_to, 
       member_messages.message_from, 
       member_messages.message_time, 
       member_messages.message_body,
       members.display_name,members.id 
FROM members
INNER JOIN member_messages 
   ON member_messages.message_to = members.id  AS 'to'
INNER JOIN member_messages 
   ON member_messages.message_from = members.id AS 'from'
WHERE member_messages.message_to = '$userId' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:41:18.147

您的连接几乎是正确的，但您需要引用表别名`to`以及您在列表中的s 中`from`分配的别名，而不是直接引用。由于和都是[MySQL 保留关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)，因此您必须将它们都反引号。`JOIN``SELECT``members``TO``FROM`

```
SELECT member_messages.message_to, 
       member_messages.message_from, 
       member_messages.message_time, 
       member_messages.message_body,
       /* Select cols from both aliases of members, with column aliases */
       `to.display_name AS to_name,
       `to`.id AS to_id ,
       `from`.display_name AS from_name,
       `from`.id AS from_id 
/* First reference to members as `to` */
FROM members AS `to`
INNER JOIN member_messages 
   ON member_messages.message_to = `to`.id
/* Second reference to members as `from` */
INNER JOIN members AS `from` 
   ON member_messages.message_from = `from`.id
WHERE member_messages.message_to = '$userId' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:13:52.780

如果将 db 结构放在这里会很有帮助。假设您的表 'member_messages' 包含您要阅读的所有消息，那么您需要将此表与您的 'members' 表连接两次以检索 'from' 和 'to' 成员的名称。

您可能正在寻找这样的东西：

```
SELECT
    message.message_time, message.message_body,
    member_to.id, member_to.display_name,
    member_from.id, member_from.display_name
FROM   
    member_messages AS message
JOIN   
    members AS member_to ON members.id = member_messages.message_to 
JOIN   
    members AS member_from ON members.id = members_messages.message_from 
```

如果您的数据库系统中保留了某些单词，请更改它们。

# python - 使用最小值和最大值 - Heapq 合适吗？

> ID：14248692
> 
> 赞同：1
> 
> 时间：2013-01-10T00:04:33.860
> 
> 标签：python, algorithm

我有一个调度算法，我比较优先级/任务元组列表的最小值和最大值，对它们进行一些更改优先级的操作，然后将它们重新插入列表并适当地更新列表。heapq 会是最好的数据结构吗？我将如何在不弹出的情况下进行初始比较（这基本上是确定优先级值是否相距足够远以需要进一步操作；如果不是，该函数将停止）？一旦进行了比较，我将如何将最大值与最小值一起使用，因为 heapq 是为仅弹出最小值而设计的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T01:37:01.927

`heapq`只提供一个最小堆——也就是说，您可以`min`在 O(log N) 时间内弹出值，但不能弹出`max`值。

如果你想要一个类似于 的双面数据结构`heapq`，有几个基本选项。

首先，常规最小堆有什么问题？这不仅仅是 API；找到最大值需要`O(n)`时间而不是`O(1)`时间，因此弹出它需要`O(n)`而不是`O(log n)`，这是您要改进的关键。

一个简单的 hack 涉及保留两个堆，一个具有正常值，一个具有正常值的修饰，以便它们向后排序。这是伪代码中的实现：

```
def push(self, value):
    insert into both normal and reversed heaps
def minpop(self):
    check that the min value of normal hasn't reached the min value of reversed
    pop and return the min value of normal
def maxpop(self):
    check that the min value of reversed hasn't reached the min value of normal
    pop and return the min value of reversed 
```

乍一看，似乎每个操作的最坏情况行为应该是 minheap 的两倍，但事实并非如此。特别是，最坏情况下的空间是曾经插入的元素数量，它可能远高于插入数量的两倍 - 删除的数量。（例如，如果您插入了 1000 个项目并删除了 100，则 900 >> 200。）

有许多用例不起作用，如果它在您的用例中不起作用，那应该是显而易见的。但是当它合适的时候，它*是*非常简单的。

如果*不合适*，您可以使用真正的最小-最大堆。这基本上只是将最小堆的`normal`和`reversed`版本交错到单个结构中，并且可以在上面的“检查”案例中轻松地做正确的事情（而不是留下值）。

但是，如果您想要双端优先级队列的对称性能，您实际上无法比平衡树或跳过列表做得更好。（嗯，不是出于一般目的。如果你有特定的行为特征，那可能不是真的。） AVL 树、红黑树和跳过列表的实现比 min-max 二叉堆要多得多。因此，在 PyPI 和 ActiveState 配方中搜索“平衡树”、“红黑树”、“AVL 树”、“skiplist”等，你会发现像[`bintrees`](http://pypi.python.org/pypi/bintrees/0.3.0)and之类的东西[`skiplist`](http://pypi.python.org/pypi/skiplist/0.1.0)，它们应该都可以工作。

但是，我建议[`blist`](http://pypi.python.org/pypi/blist/1.3.4). 它使用平衡树和数组的特殊混合，而不是经过充分研究的数据结构，乍一看可能会让您认为它不太可信。然而，我相信它比任何竞争模块都得到了更多的使用和实际测试，并且它也得到了相当大的优化。（当您处理`A * log Bn + C`性能时，更改`A`或`C`通常比更改具有更大的影响`B`。）它还有一个很好的界面——实际上，其中有一些。如果你使用`blist.sortedlist`，你可以做`sl[0]`, `sl[-1]`, `sl.pop(0)`, `sl.pop(-1)`, and `sl.add(x)`, 几乎完全符合你的预期。

所以，你的代码看起来像这样（如果我理解你的英文描述）：

```
class MyQueue(object):
    def __init__(self):
        self.sl = blist.sortedlist(key=operator.itemgetter(0))
    def add(self, priority, task):
        self.sl.add((priority, task))
    def step(self):
        if self.sl[-1][0] - self.sl[0][0] < MyQueue.EPSILON:
            return
        minprio, mintask = self.sl.pop(0)
        maxprio, maxtask = self.sl.pop(-1)
        newminprio, newmaxprio = recalc_priorities(minprio, maxprio)
        self.add(newminprio, mintask)
        self.add(newmaxprio, maxtask) 
```

这些方法中的任何一个的问题在于，偷看双方的最坏情况是`O(log N)`而不是`O(1)`。但是有一个简单的方法可以解决这个问题，如果这些是您需要的唯一操作：只需将这些值缓存起来：

```
class MyQueue(object):
    def __init__(self):
        self.sl = blist.sortedlist(key=operator.itemgetter(0))
        self.minprio, self.maxprio = None, None
    def add(self, priority, task):
        self.sl.add((priority, task))
        if prio < self.minprio: self.minprio = prio
        elif prio > self.maxprio: self.maxprio = prio
    def step(self):
        if self.maxprio - self.minprio < MyQueue.EPSILON:
            return
        minprio, mintask = self.sl.pop(0)
        maxprio, maxtask = self.sl.pop(-1)
        newminprio, newmaxprio = recalc_priorities(minprio, maxprio)
        self.add(newminprio, mintask)
        self.add(newmaxprio, maxtask)
        self.minprio, self.maxprio = sl[0][0], sl[-1][0] 
```

这使得快速路径通过`step` `O(1)`而不是`O(log n)`，它使所有现有`O(log n)`操作保持不变`O(log n)`。

另请参阅[Wikipedia](http://en.wikipedia.org/wiki/Priority_queue#Usual_implementation)以讨论其他类型的堆，这些堆可以替代此处可能相关的二进制堆。

最后一点，igorrs 的评论让我想起：

有多种不同的数据结构可以在这里获得相同的最坏情况算法复杂性。有时，避免任何事情`O(n)`就足够了，因此您应该使用最简单的实现并完成它。但有时（特别是对于许多操作但很小`n`，或非典型数据），常数因子、最佳情况等可能会产生巨大的差异。在这种情况下，正确的做法是构建多个实现并使用真实数据进行测试，看看什么是最快的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T01:15:00.490

鉴于您正在考虑堆，我可以假设您的期望（`n`元素总数）是：

1.  及时找到最小的钥匙和最大的钥匙`O(1)`。
2.  及时重新插入（使用更改的键）具有最小键的元素和具有最大键的元素`O(log(n))`。

这可以通过[min-max heap](http://en.wikipedia.org/wiki/Min-max_heap)来完成。不幸的是，我认为这在 Python 的标准库中不可用。

如果您放宽第一个要求，任何平衡树（例如红黑树）都可以解决问题，并`O(log(n))`为所有所需的操作留出时间。

Python 的标准库也不提供任何平衡树，因此您必须自己动手或寻找实现。

# c - 基本内存地址混淆

> ID：14248693
> 
> 赞同：1
> 
> 时间：2013-01-10T00:04:35.080
> 
> 标签：c, pointers, memory, memory-management, kernel

这是我遇到的一个非常基本的内存地址问题：

这是我的片段：

```
int *i = &a[0];
printf("ptr i = %p, i = %x, (i+1) = %p, (i+1) = %x\n", i, i, i+1, i+1); 
```

输出如下：

```
指针 i = 0x7fff5fbff700，i = 5fbff700，(i+1) = 0x7fff5fbff704，(i+1) = 5fbff704

```

这是一个 32 位内核。

我真正不明白的是：
地址`0x7fff5fbff700`和地址`0x7fff5fbff704`应该相差 32 位或 4 个字节。

如果我将地址中的每个“元素”`0x7fff5fbff700`视为 1 个字节，那么是的，我可以看到这两个地址如何相差 4 个字节，但如果是这种情况，那么地址`0x7fff5fbff704`将是 12*4 = 48bytes 。这怎么可能呢？？

我在Linux中运行它，这就是我得到的：

```
ptr i = 0xffff82cc, i = ffff82cc, (i+1) = 0xffff82d0, (i+1) = ffff82d0

```

如果我尝试打印 (i+1)-1，它总是给出 0x1

但我不明白 0xffff 82cc 和 0xffff 82d0 相差 32 位或 4 个字节！

```
0xffff82cc = FFFF 1000 0010 1010 1010
0xffff82d0 = FFFF 1000 0010 1011 0000

```

请解释

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T00:19:29.133

这很简单。地址指向内存中的一个字节。将地址加 1，即可获得内存中下一个字节的地址。

指针知道它们指向的值的大小，因此当您将 1 添加到 an 时，`int*`它实际上会将包含的地址增加 4（以适应 32 位（4 字节）整数）。

`0x7fff5fbff700`特定字节的地址也是如此（或者在`int*`32 位 int 的情况下）。 `0x7fff5fbff704 = 0x7fff5fbff700 + 4`，所以`0x7fff5fbff704`指向第一个字节之后的第 4 个字节（或下一个 32 位整数）。

同样，`0xffff82d0 = 0xffff82cc + 4`寻址位置相隔 4 个字节（32 位）。

图表可能会有所帮助。将内存视为一个大字节列表，每个字节都有自己的地址。所以一小部分内存看起来像（网格中的每个单元格都是一个位，字节的地址在右边）：

```
|               |
|               |
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff6ff
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff700
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff701
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff702
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff703
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff704
+-+-+-+-+-+-+-+-+
| | | | | | | | |   <-  0x7fff5fbff705
+-+-+-+-+-+-+-+-+
|               |
|               | 
```

因此，在您的代码中`int`，值为 0x7fff5fbff700 的指针指向 `32 位 int，它存储在内存位置 0x7fff5fbff700、0x7fff5fbff701、​​0x7fff5fbff702 和 0x7fff5fbff703 中。那是 4 个字节，总共 32 位。

当您将 1 加到指针上时，它实际上将地址增加 4，因此指针然后存储下一个 32 位整数 (0x7fff5fbff704) 的第一个字节的地址。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T00:28:21.690

“这是一个 32 位内核。”

不，不是。您的指针是 64 位的，因此您显然无法运行 32 位内核。尝试输入`uname -a`，它应该会在名称中的某处显示 x86-64。在 32 位内核中，指针永远不会超过 8 个十六进制数字，您的值是 12 = 48 位长。除非您拥有其他人没有听说过的 48 位处理器，否则它可能是 64 位处理器。

您的指针之间的差异是 4 个字节：

```
 0x7fff5fbff704
-0x7fff5fbff700
---------------
 0x000000000004 
```

这同样适用于您的 d0-cc 示例，相隔 4 个字节。

十六进制数学的工作原理与十进制数学几乎相同，除了数字是 0123456789abcdef，表示值 0..15 十进制。因此，例如`3 + 7 = a`, `a + 1 = b`, `a + a = 14`。所以`d0-cc`，如果从 移除 开始`c0`，`d0`我们`10-c`就剩下来计算了。那是十进制的 16-12，等于 4。

# shell - 如何使用另一个文件的每一行搜索文件并附加结果匹配的一个字段

> ID：14248699
> 
> 赞同：0
> 
> 时间：2013-01-10T00:05:10.833
> 
> 标签：shell, scripting

对于具有两列数据的文件 (file1)，如下所示：

```
1232323 dog 
21321   cat
21321   fox
2312323 bird 
```

第二个文件包含两列数据（file2），如下所示：

```
dog red
cat blue
fox green
bird black 
```

我正在尝试编写一个脚本，该脚本将使用遍历 file1 的第 2 列中的每个条目以从 file2 的第 1 列中查找匹配的条目，并创建第三个文件，将 file2 的第 2 列中的数据附加到具有“像这样打”：

```
1232323 dog red
21321   cat blue
21321   fox green
2312323 bird black 
```

这是一些伪代码：

```
For each string in field 2 of file1
    grep file2
    output field1 and field2 of file1 and matching field2 of file2 from any hits to file3 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:28:38.937

最干净的 bash-only 解决方案可能会使用关联数组，这需要 bash > 4：

```
#!/usr/bin/env bash

declare -A num_data
while read -r num animal; do
    num_data["$animal"]="$num"
done < file1

declare -A color_data
while read -r animal color; do
    color_data["$animal"]="$color"
done < file2

for i in "${!num_data[@]}"; do
    printf '%s %s %s\n' "${num_data[$i]}" "$i" "${color_data[$i]}"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:27:29.353

这个单线可能会有所帮助：

```
kent$  awk 'NR==FNR{a[$2]=$0;next}$1 in a{print a[$1],$2}' f1 f2
1232323 dog  red
21321   cat blue
21321   fox green
2312323 bird black 
```

或加入：

```
kent$  join -12 -21 -o 1.1 1.2 2.2 f1 f2
1232323 dog red
21321 cat blue
21321 fox green
2312323 bird black 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:41:45.383

这是一个 Perl 解决方案：

```
# Usage:  perl datafind.pl > file3.txt

open FILE1, "<file1.txt" or die $!;
my @lines1 = <FILE1>;
close FILE1 or die $!;

open FILE2, "<file2.txt" or die $!;
my @lines2 = <FILE2>;
close FILE2 or die $!;

foreach(@lines1) {
    my($col11, $col12) = split(/\s+/);
    foreach(@lines2) {
        my($col21, $col22) = split(/\s+/);
        if($col12 eq $col21) {
            print "$col11 $_";
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T01:12:33.163

该`join`命令是您需要的，但需要对输入文件进行排序。使用进程替换：

```
join -1 2 -o 1.1,1.2,2.2 <(sort -b -k2 file1) <(sort file2) 
```

生产

```
2312323  bird  black
21321    cat   blue
1232323  dog   red
21321    fox   green 
```

我通过管道将 join 命令输入`column -t`以使输出漂亮。

# select - 在 XForms 项集中组合（计算）字段

> ID：14248703
> 
> 赞同：1
> 
> 时间：2013-01-10T00:05:25.463
> 
> 标签：select, expression, xforms, computed-field

我有一个包含艺术家列表的实例

```
<xf:instance id="Artists" xmlns="">  
    <Artists>
        <Artist ID="6548">
            <FirstName>Elvis</FirstName>
            <LastName>Presley</LastName>
        </Artist>
        <Artist ID="7895">
            <FirstName>Duane</FirstName>
            <LastName>Eddy</LastName>
        </Artist>
    </Artists>
</xf:instance> 
```

我想从列表中选择艺术家。这段代码：

```
<xf:select>
    <xf:label>Artists</xf:label>
    <xf:itemset nodeset="instance('Artists')/Artist">
        <xf:label ref="LastName" ></xf:label>
        <xf:value ref="@ID"></xf:value>
    </xf:itemset>
</xf:select> 
```

显示“Presley”和“Eddy”标签，但我想显示“Presley, Elvis”和“Eddy, Duane”。这可以在不修改模型的情况下完成吗？我想有一些方法可以在那里表达，但我不知道。

我试过：

```
<xf:label ref="concat(LastName, ',', FirstName)" ></xf:label> 
```

但这并没有显示任何东西。（我正在使用 BetterForm 和 eXist）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T09:45:42.003

试试这个：

```
<xf:label value="concat(LastName, ', ', FirstName)" /> 
```

该解决方案可能是特定于实现的，我仅使用 orbeon 表单对其进行了测试。与您的代码的唯一区别是元素中的`value`属性`xf:label`而不是`@ref`. `ref="concat(LastName, ',', FirstName)"`将不起作用`ref`，因为您指定了单节点绑定。如果模型中没有这样的节点，它将失败。`value`相反，您可以使用 XPath 创建一个“计算的”标签值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T13:49:16.413

此语法适用于 BetterForm+eXist：

```
<xf:label>
    <xf:output value="concat(LastName, ',', FirstName)" />
</xf:label> 
```

# git - 在 git 中，列出自某个标签以来的所有标签

> ID：14248705
> 
> 赞同：7
> 
> 时间：2013-01-10T00:05:36.947
> 
> 标签：git, git-tag, git-rev-list

我正在使用标签来识别发布版本并识别任务的“开发完成”提交。做一个`git tag`我得到一个如下的列表。

```
> git tag
v0.1.0
task_1768
task_2011
task_1790
task_1341
v0.1.1
task_2043
task_2311
v0.1.2 
```

假设所有标签都指向`master`分支上的提交，有没有办法列出自某个标签以来的所有标签？例如，要生成包含在`v0.1.2`发布中的所有任务的列表——我正在寻找类似以下的内容（这不是实际命令）。

```
> git tag -l "task_*" --since v0.1.1 
```

获得如下输出。

```
task_2043
task_2311 
```

有没有办法做到这一点`git tag`？

有没有办法做到这一点`git rev-list`？

（或者其他一些 git 命令？）

### 更新

根据答案和评论，以下是我目前正在使用的。

```
> git log v0.1.1.. --decorate | grep -Eow 'tag: ([a-zA-Z0-9.-_]*)' | awk '{ print substr($0, 6); }'
task_2043
task_2311
v0.1.2

> git log v0.1.1.. --decorate | grep -Eow 'tag: ([a-zA-Z0-9.-_]*)' | awk '{ print substr($0, 6); }' | grep -Eo 'task_.*'
task_2043
task_2311 
```

### 第二次更新

新选择的答案。这正是我最初想要的。优雅得多。

```
> git tag --contains v0.1.1
v0.1.1
task_2043
task_2311
v0.1.2

> git tag --contains v0.1.1 | grep -Eo 'task_.*'
task_2043
task_2311 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-13T02:50:17.053

`git tag --contains v0.1.1`将向您显示包含给定标签的所有标签 - 即您可以从中追溯历史并到达给定标签的标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T00:17:10.153

您可以提供一个范围`git log`：

```
git log v1.1.0.. 
```

现在您添加`--decorate`将列出标签的选项。您可以将其他选项添加到日志中以将列表限制为仅有趣的列表，或者将其 grep 用于“标记”：

```
git log v1.1.0.. --decorate | grep 'tag:' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T00:25:40.417

您可以使用`git rev-list`以下链接为您提供所有可访问的修订`master`，不包括也可以从以下链接访问的任何修订`v0.1.1`：

```
git rev-list --tags master --not v0.1.1 
```

然后，您可以通过以下方式运行它`git describe`：

```
git describe --abbrev=0 --tags `git rev-list --tags master --not v0.1.1` 
```

这可能会为您提供标签的重复副本（并且可能会包括`v0.1.1`其自身），但这应该是获取所需列表的开始。

# pandas - 如何使用标称值在 pandas 中绘制直方图？

> ID：14248706
> 
> 赞同：19
> 
> 时间：2013-01-10T00:05:42.593
> 
> 标签：pandas, histogram

鉴于：

```
ser = Series(['one', 'two', 'three', 'two', 'two']) 
```

如何绘制这些值的基本直方图？

这是我想在 matplotlib 中看到的 ASCII 版本：

```
 X
 X   X   X
-------------
one two three 
```

我厌倦了看到：

```
TypeError: cannot concatenate 'str' and 'float' objects 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-10T00:33:02.837

您可以使用以下[`value_counts`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html)方法：

```
In [10]: ser.value_counts()
Out[10]: 
two      3
one      1
three    1 
```

然后将其[绘制为条形图](http://pandas.pydata.org/pandas-docs/stable/visualization.html#bar-plots)：

```
ser.value_counts().plot(kind='bar') 
```

编辑：我注意到这并没有保持所需的顺序。如果您有此排序的列表/系列（在这种情况下`ser[:3]`可以），您可以[`reindex`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.reindex.html)在绘图之前：

```
In [12]: ser.value_counts().reindex(ser[:3])
Out[12]: 
one      1
two      3
three    1 
```

# matlab - 如何在分水岭图像分割中使用 Kinect 深度数据

> ID：14248711
> 
> 赞同：4
> 
> 时间：2013-01-10T00:06:20.827
> 
> 标签：matlab, image-processing, image-segmentation, watershed

我有来自 Kinect 的 RGB 和深度图像作为 png 格式。我正在尝试将深度数据与分水岭分割一起使用，但我不知道如何结合这两种数据并获得更准确的结果。我检查了一些论文，但我不理解结果或找不到专门为分水岭算法编写的解决方案。如何将深度数据作为分割过程的参考点？

我正在使用 MatLab 的图像处理工具箱。

图片来自 Nathan Silberman 等。al. 在[Silberman 网站上的数据库](http://cs.nyu.edu/~silberman/datasets/nyu_depth_v2.html)

一个示例 RGB 图像及其对应的深度文件如下所示（注意深度图像，原本是二进制图像，被转换为 uint8）： ![RGB 图像](../Images/02fef78586fdff8751083e8275305519.png) ![深度图像（转换为 uint8）](../Images/c82e4774409774731a7c3c903ea7d410.png)

更新：我尝试通过获取每个通道（红色、绿色、蓝色和深度）并计算它们的权重，从 RGB 源与深度数据一起创建加权灰度图像；然后包括与每个相应像素的权重相乘的值。但是得到的灰度图像并没有显着改善结果。它并不比仅基于 RGB 的分割好。如果我遵循这种方法，我还能做什么？或者，我怎样才能看到深度数据的影响？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-13T06:34:44.870

除非您上传错误，否则深度图像是黑色的并且不包含任何深度数据。请记住（荷兰语）您在这里比较苹果和梨。Whatershed 图像不是深度图像，它们是轮廓的提取。

然后是你出错的下一件事，深度图像的分辨率低于彩色图像。对于 kinect v2，它只有 512x424，并且 kinect one 的真实深度视觉甚至低于其返回的位图大小（它是低分辨率深度，并不是每个像素都是测量的结果，与 kinect v2 相比）。但随后 v2 具有更好的视频输出。

如果您想要更好地划分 rgb 图像的分水岭，则平均多个相机帧以消除相机噪声。

PS 我建议您下载 windows kinect sdk 并查看随附的示例。

# php - 当有多种可能性时，在数组中查找对象的索引

> ID：14248712
> 
> 赞同：0
> 
> 时间：2013-01-10T00:06:32.663
> 
> 标签：php

我有一个数组，我想在数组中找到某个对象的所有索引。当我使用`array_search`时，它只返回可以找到对象的第一个索引。

```
echo array_search(3, array(3, 3, 4)); 
```

这返回 0，但我想知道索引 0 和 1 都将整数 3 作为它们的对象。有没有办法在不使用`for`循环的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T00:09:28.910

尝试 array_keys() 方法：

```
 $array = array(3, 3, 4);
  print_r(array_keys($array, "3")); 
```

以供参考：

array_keys() — 返回数组信息和用法示例的所有键或键的子集：http: [//php.net/manual/en/function.array-keys.php](http://php.net/manual/en/function.array-keys.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:12:26.917

作为 array_keys 的替代方法，array_filter() 保留关联性

```
$key = 3;
$array = array(1, 3, 3, 4, 3, 5);

$result = array_filter(
    $array,
    function ($item) use ($key) {
        return ($item == $key);
    }
);

var_dump($result); 
```

# javascript - 在我的画布外菜单中更改高度会导致水平滚动

> ID：14248713
> 
> 赞同：0
> 
> 时间：2013-01-10T00:06:37.707
> 
> 标签：javascript, css, mobile, menu

我有一个非画布菜单，它非常适合我的移动布局。

但是，当我展开菜单项以显示其下的子菜单时，整个页面可以水平滚动。不是那么完美。

我只是控制要显示的类名：block。

[http://dev.martinilab.com/so1/index.html](http://dev.martinilab.com/so1/index.html)

我不确定是什么导致了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:28:00.837

问题是您没有设置高度`.row`，因此它与内容强制它一样高。当您`display:block`使用该类并导致显示这些菜单项时，它会强制内容进一步向下，并且由于页面与内容一样高，因此页面会变长。

如果要修复它，请为该类设置一个高度，或者将这些菜单项从文档流中取出，这样它就不会将内容向下推。

# android - Android在连接到服务器套接字时有时会拒绝连接

> ID：14248717
> 
> 赞同：0
> 
> 时间：2013-01-10T00:07:20.447
> 
> 标签：android, sockets, networking, serversocket

所以我有一个应用程序可以在同一本地网络中相互通信 android 设备。它们通过建立与 serversocket 的连接、交换数据和关闭连接（每分钟）来定期相互交谈。

出于某种原因，它在前几次尝试中效果很好，然后他们开始每次都返回连接拒绝。谁能告诉我可能是什么原因？

我的代码很简单：

```
server = new ServerSocket(0);
while(true) {
    Socket clientSocket = server.accept();
    Log.d(TAG, "Incoming connection");
    handleClient(clientSocket);
} 
```

连接时：

```
 Socket s = new Socket(si.getInet4Addresses()[0], si.getPort());
    doStuff(s) 
```

我有以下权限：

```
 <manifest>
      ....
      <uses-permission android:name="android.permission.INTERNET"/>
      <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
      <uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE"/>
      <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
      <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
      <uses-permission android:name="android.permission.WAKE_LOCK"/>
      <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE"/>
      <uses-permission android:name="android.permission.CHANGE_WIFI_STATE"/>
      <application
        <activity>
          ...
          <intent-filter>
            ...
          </intent-filter>
        </activity>
        <service .. />
        <receiver >
           ....
        </receiver>
      </application>
    </manifest> 
```

哦，我应该提到这一切都发生在服务中。

# php - 扩展 htaccess 重写规则

> ID：14248721
> 
> 赞同：0
> 
> 时间：2013-01-10T00:07:51.510
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting, get

我的 htaccess 中有以下重写规则/条件：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^id([0-9]+)/?$ /profile.php?user_id=$1 [L] 
```

结果是“example.com/id1”

**现在我遇到的问题是，有时**我需要在 URL 中添加一个 $_GET 参数，但实际上它们会被忽略，例如：

```
example.com/id1?section=video
example.com/id1?section=photo
example.com/id1?section=audio 
```

也不工作：

```
example.com/id1&section=video 
```

是否有机会通过扩展 htaccess 规则来完成这项任务？请记住，URL 并不总是添加 $_GET 参数。

此致！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:10:18.963

尝试使用[QSA](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_qsa)标志

```
RewriteRule ^id([0-9]+)/?$ /profile.php?user_id=$1 [L,NC,QSA] 
```

# algorithm - 生成总和为给定数字的统一二进制数组

> ID：14248725
> 
> 赞同：0
> 
> 时间：2013-01-10T00:08:11.967
> 
> 标签：algorithm

我想生成一些二进制数组来控制没有控制器的 LED 的亮度。我不会在微控制器上生成脉冲宽度（这会占用本应用于其他事情的指令周期），而是将它们硬编码为查找表，并一遍又一遍地循环通过二进制数组，设置LED 在该指令下打开或关闭。

假设我的数组长度为 4，我将有 5 个亮度级别：

```
{{ 0, 0, 0, 0 },
 { 1, 0, 0, 0 },
 { 1, 0, 1, 0 },
 { 1, 1, 1, 0 },
 { 1, 1, 1, 1 }} 
```

请注意，我已尝试将 1 尽可能均匀地分布在整个阵列中，这并不总是可能的，但人眼不应该看到小的异常。

假设我的数组长度为 8，我想要 5/8 的亮度：

```
{ 1, 0, 1, 1, 0, 1, 1, 0 }; 
```

这似乎是一个很好的传播，但我也可以使用：

```
{ 1, 0, 1, 1, 1, 0, 1, 0 }; 
```

哪个更好？当然，平均亮度是相同的。从一种状态到另一种状态的变化次数也是相同的。标准差是一样的。但是，查看*运行*时，第一个示例的运行长度方差要低得多，这意味着它更均匀，因此更好。

反正。我需要一种算法来为给定的长度和亮度生成这些数组。如果可能，算法应该找到一个最佳数组——一个尽可能统一的数组。

这并不像听起来那么简单。老实说，我很想写一个蛮力算法来比较所有可能性并返回最好的。

我什至考虑将一个整数编程模型放在一起，但这对于这个问题来说似乎有点过分了。

除非有人有更好的主意？

**编辑：**

事实证明 与`{ 1, 1, 1, 1, 0, 0, 0, 0 }`具有相同的*运行方差*，`{ 1, 0, 1, 0, 1, 0, 1, 0 }`因此度量需要稍微复杂一些，因为第二个示例明显优于第一个示例。（对于更长的阵列长度，可能会看到一些 LED 闪烁，因为 1 会聚在一起）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:42:55.053

好的，就是这样。基本上，您想要做的是最小化 0 或 1 的最大运行长度。总体思路是尽可能分配。剩下的，把它塞在前面。

N = # 总位数 n = # of 1

```
void pwm(int N, int n, char* z = 0) {
    if (n == 0) {
        // degenerate case!
        for (int i = 0; i < N; i++) {
            printf("0");
        }
        printf("\n");
        return;
    } else if (n == N) {
        // degenerate case!
        for (int i = 0; i < N; i++) {
            printf("1");
        }
        printf("\n");
        return;
    }
    int m = N - n;
    int sep = m/n;
    int rem = m%n;
    int pre;
    int i,j;
    std::list<char> clist;

    if (z == 0) {
        // if more 1 than 0, then flip
        if (sep > 0) pwm(N,n,"01");
        else pwm(N,N-n,"10");
        return;
    }

    pre = sep/2;

    for (j = 0; j < pre; j++)
        clist.push_back(z[0]);
    if (rem > 0) {
        clist.push_back(z[0]);
        rem--;
    }

    for (i = 0; i < n; i++) {
        if (i!=0) {
            for (j = 0; j < sep; j++)
                clist.push_back(z[0]);
            if (rem > 0) {
                clist.push_back(z[0]);
                rem--;
            }
        }
        clist.push_back(z[1]);
    }

    for (j = 0; j < sep-pre; j++)
        clist.push_back(z[0]);

    // output the data so we can see
    char* res = new char[N+1];
    memset(res, ' ', N);
    res[N] = 0;
    char* u = res;
    for (std::list<char>::iterator cli = clist.begin(); cli != clist.end(); cli++) {
        (*u) = *cli;
        u++;
    }

    printf("%s\n", res);

    delete [] res;
} 
```

这是 N=25 的输出：

```
0000000000000000000000000
0000000000001000000000000
0000001000000000001000000
0000100000001000000010000
0001000001000001000001000
0010000100001000010000100
0010001000100010001000100
0010001000100010010010010
0010010010010010010010010
0100100100100100100101010
0100100100100101010101010
0100100101010101010101010
0101010101010101010101010
1010101010101010101010101
1011011010101010101010101
1011011011011010101010101
1011011011011011011010101
1101101101101101101101101
1101110111011101101101101
1101110111011101110111011
1101111011110111101111011
1110111110111110111110111
1111011111110111111101111
1111110111111111110111111
1111111111110111111111111 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T01:22:36.800

假设您需要在 n 个点的网格中点亮 k 个点。您可以遵循以下概率方法。

```
remk=k
remn=n
for i in range(n):
    x[i] = 1 if rand()< remk*1.0/remn else 0
    remk-=x[i]
    remn-=1 
```

x 是包含照明布置的数组。

# google-apps-script - 谷歌电子表格：所有粗体单元格的总和

> ID：14248726
> 
> 赞同：4
> 
> 时间：2013-01-10T00:08:12.590
> 
> 标签：google-apps-script, google-sheets

我正在尝试在 Google 电子表格中学习脚本，并且我已经得到了一些简单的脚本来工作，但是这个真的很痛苦。

我想制作一个使用 onEdit() 函数来更新特定单元格的脚本，以显示电子表格中所有粗体值的总和。

外汇：

1 2 **3**

**4**

那么该单元格的值为 (3+4) 7。

希望这是有道理的！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-12T04:59:59.800

有点晚了，但值得回答，我一直在研究类似的问题。

使用的公式是：

```
=sumIfBold(A1:B4,COLUMN(A1), ROW(A1)) 
```

脚本是：

```
/**
 * Sums cell values in a range if they are bold. The use of startcol and startrow
 * is to enable the formula to be copied / dragged relatively in the spreadsheet.
 * 
 * @param  {Array.Array} range    Values of the desired range
 * @param  {int} startcol The column of the range
 * @param  {int} startrow The first row of the range
 * 
 * @return {int}          Sum of all cell values matching the condition
 */
function sumIfBold(range, startcol, startrow){
  // convert from int to ALPHANUMERIC 
  // - thanks to Daniel at http://stackoverflow.com/a/3145054/2828136
  var start_col_id = String.fromCharCode(64 + startcol);
  var end_col_id = String.fromCharCode(64 + startcol + range[0].length -1);
  var endrow = startrow + range.length - 1

  // build the range string, then get the font weights
  var range_string = start_col_id + startrow + ":" + end_col_id + endrow
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var getWeights = ss.getRange(range_string).getFontWeights();

  var x = 0;
  var value;
  for(var i = 0; i < range.length; i++) {
    for(var j = 0; j < range[0].length; j++) {
      if(getWeights[i][j].toString() == "bold") {
        value = range[i][j];
        if (!isNaN(value)){
          x += value;
        }
      }
    }
  }
  return x;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-12T14:19:33.017

这些答案很棒，但对我来说，当通过 Z 列时它会中断（当我们有两个字母时，第 26 列到第 27 列）。

添加了一个小改动来解决这个问题（在斜体版本上）

```
 /**
     * Sums cell values in a range if they are italic. The use of startcol and startrow
     * is to enable the formula to be copied / dragged relatively in the spreadsheet.
     * 
     * @param  {Array.Array} range    Values of the desired range
     * @param  {int} startcol The column of the range
     * @param  {int} startrow The first row of the range
     * 
     * @return {int}          Sum of all cell values matching the condition
     * @customfunction
     */
    function sumIfItalic(range, startcol, startrow){
      // convert from int to ALPHANUMERIC 
      // - thanks to Daniel at http://stackoverflow.com/a/3145054/2828136
      var secondColChar = parseInt(startcol / 27); //26 is the number of col Z, 26 letters, works for only for two char

      var start_col_id = ""
      var end_col_id = ""

      if(secondColChar > 0) {
        start_col_id += String.fromCharCode(64 + (secondColChar));
        end_col_id += String.fromCharCode(64 + secondColChar + range[0].length -1);
      }

      start_col_id += String.fromCharCode(64 + (startcol % 27 + (secondColChar * 1))  );
      end_col_id += String.fromCharCode(64 + (startcol % 27) + (secondColChar * 1) + range[0].length -1);

      var endrow = startrow + range.length - 1

      // build the range string, then get the font styles
      var range_string = start_col_id + startrow + ":" + end_col_id + endrow

      var ss = SpreadsheetApp.getActiveSpreadsheet();
      var getStyles = ss.getRange(range_string).getFontStyles();

      var x = 0;
      var value;
      for(var i = 0; i < range.length; i++) {
        for(var j = 0; j < range[0].length; j++) {
          if(getStyles[i][j].toString() == "italic") {
            value = range[i][j];
            if (!isNaN(value)){
              x += value;
            }```
          }
        }
      }
      return x*1;
    } 
```

仅在我的情况下进行了测试，尽管...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-09T21:34:57.210

我想为汤姆的出色回答添加一点点。它当前返回一个字符串。要返回一个数字，请更改`return x;`为`return x*1;`

此外，对于任何希望将其转换为斜体而不是粗体的人，这里是代码：

```
/**
 * Sums cell values in a range if they are italic. The use of startcol and startrow
 * is to enable the formula to be copied / dragged relatively in the spreadsheet.
 * 
 * @param  {Array.Array} range    Values of the desired range
 * @param  {int} startcol The column of the range
 * @param  {int} startrow The first row of the range
 * 
 * @return {int}          Sum of all cell values matching the condition
 */
function sumIfItalic(range, startcol, startrow){
  // convert from int to ALPHANUMERIC 
  // - thanks to Daniel at http://stackoverflow.com/a/3145054/2828136
  var start_col_id = String.fromCharCode(64 + startcol);
  var end_col_id = String.fromCharCode(64 + startcol + range[0].length -1);
  var endrow = startrow + range.length - 1

  // build the range string, then get the font styles
  var range_string = start_col_id + startrow + ":" + end_col_id + endrow
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var getStyles = ss.getRange(range_string).getFontStyles();

  var x = 0;
  var value;
  for(var i = 0; i < range.length; i++) {
    for(var j = 0; j < range[0].length; j++) {
      if(getStyles[i][j].toString() == "italic") {
        value = range[i][j];
        if (!isNaN(value)){
          x += value;
        }
      }
    }
  }
  return x*1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-09T02:45:33.313

感谢这段代码，但不幸的是，它有多个值，它返回一个字符串。我在底部的 FOR 循环块中做了一个小更新，并删除了一些虚假的反引号。

```
 /**
 * Sums cell values in a range if they are italic. The use of startcol and startrow
 * is to enable the formula to be copied / dragged relatively in the spreadsheet.
 * 
 * @param  {Array.Array} range    Values of the desired range
 * @param  {int} startcol The column of the range
 * @param  {int} startrow The first row of the range
 * 
 * @return {int}          Sum of all cell values matching the condition
 * @customfunction
 */
function sumIf_Italic(range, startcol, startrow){
  // convert from int to ALPHANUMERIC 
  // - thanks to Daniel at http://stackoverflow.com/a/3145054/2828136
  var secondColChar = parseInt(startcol / 27); //26 is the number of col Z, 26 letters, works for only for two char

  var start_col_id = ""
  var end_col_id = ""

  if(secondColChar > 0) {
    start_col_id += String.fromCharCode(64 + (secondColChar));
    end_col_id += String.fromCharCode(64 + secondColChar + range[0].length -1);
  }

  start_col_id += String.fromCharCode(64 + (startcol % 27 + (secondColChar * 1))  );
  end_col_id += String.fromCharCode(64 + (startcol % 27) + (secondColChar * 1) + range[0].length -1);

  var endrow = startrow + range.length - 1

  // build the range string, then get the font styles
  var range_string = start_col_id + startrow + ":" + end_col_id + endrow

  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var getStyles = ss.getRange(range_string).getFontStyles();

  var x = 0;
  var value;
  for(var i = 0; i < range.length; i++) {
    for(var j = 0; j < range[0].length; j++) {
      if(getStyles[i][j].toString() == "italic") {
        value = range[i][j];
        if (!isNaN(value)){
          x += value*1;
        }
      }
    }
  }
  return x*1;
} 
```

# ios - 对 NSManagedObjectContext 的并发更改 - 如何以及何时保存

> ID：14248732
> 
> 赞同：0
> 
> 时间：2013-01-10T00:09:02.530
> 
> 标签：ios, objective-c, cocoa-touch, architecture, nsmanagedobjectcontext

我的应用程序有时会将对象插入到托管对象上下文中，这些对象不一定要保存。例如，当我启动“添加实体”模式时，我会创建一个托管对象并将其分配给该模式。如果用户从该模式保存，我保存上下文。如果他取消，我会删除该对象并且不需要保存。

我现在引入了一个“导入”功能，它可以切换到我的应用程序（使用 URL 方案）并添加一个实体。因为这些模态之一可能是打开的，所以此时保存上下文是不安全的。为模态创建的瞬态对象将被保存，即使用户取消，并且不能保证删除（来自取消操作）将被保存 - 用户可能会退出应用程序。

同样，我不能在我的应用退出时简单地保存。如果此时模态框处于打开状态，则临时对象将被错误地保存。

我正在寻找一种策略来处理这种架构。我正在考虑一些允许我识别导入实体的“标记”解决方案。当用户用户退出应用程序时，我将检查上下文是否有任何未保存的更改。如果是这样，我将过滤掉除了导入的实体之外的所有内容，然后保存。我不知道这是否可能（选择性保存）或一个好主意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:03:34.987

凯文和安德鲁的评论（以及链接的文章）足以让我前进。[我在这个](https://stackoverflow.com/questions/14284301/using-a-child-nsmanagedobjectcontext-for-displaying-a-modal)问题上得到了一些后续建议。

总之，我使用子上下文来创建瞬态对象，然后将其合并到主上下文中。实际上，我只需要临时上下文作为插入对象的位置 - 例如，如果可以在插入消息之外创建它，我可以这样做，然后在确认时将其直接插入主上下文。

# c# - 如何验证是否调用了两种方法之一？

> ID：14248735
> 
> 赞同：11
> 
> 时间：2013-01-10T00:09:39.717
> 
> 标签：c#, unit-testing, moq

我正在使用 Moq 来验证是否在我的单元测试中调用了一个方法。在这种特定情况下，我想测试被测方法是否通过 log4net 记录错误。问题是，这可以通过调用`log.Error`或来完成`log.ErrorFormat`。哪一个都好。

我该如何验证呢？我只知道如何验证他们都被调用了。

```
var logMock = new Mock<ILog>();

var myClass = new MyClass(logMock.Object);

myClass.MyMethod();

logMock.Verify(log => log.Error(It.IsAny<object>()));
logMock.Verify(log => log.ErrorFormat(It.IsAny<string>(), It.IsAny<object>())); 
```

现在我想起来了，它们都有一堆重载，我不介意是否调用了任何重载（我开始怀疑这是一个很好的测试）。

提前致谢。

编辑：我只是想到了一些讨厌的东西：

```
try
{
    logMock.Verify(log => log.Error(It.IsAny<object>()));
}
catch (Moq.MockException ex)
{
    logMock.Verify(log => log.ErrorFormat(It.IsAny<string>(), It.IsAny<object>()));
} 
```

也许我可以用某种扩展方法包装它......例如`VerifyAny`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-10T00:20:04.057

您可以为每个设置标志的有效错误方法注册一个回调：

```
// Arrange
bool errorFlag = false;
logMock
    .Setup(l => l.Error(It.IsAny<object>()))
    .Callback((object o) => errorFlag = true);

/* repeat setup for each logMock method */

// Act
myClass.MyMethod();

// Assert
Assert.IsTrue(errorFlag); 
```

当然，如果您要覆盖许多重载，这仍然会很乏味。

**编辑**：为了好玩，这里有一个扩展方法`Mock<T>.VerifyAny`：

```
public static class MockExtensions
{
    public static void VerifyAny<T>(this Mock<T> mock, params Expression<Action<T>>[] expressions)
        where T: class
    {
        List<MockException> exceptions = new List<MockException>();
        bool success = false;
        foreach (var expression in expressions)
        {
            try
            {
                mock.Verify(expression);
                success = true;
                break;
            }
            catch (MockException ex)
            {
                exceptions.Add(ex);
            }
        }

        if (!success)
        {
            throw new AggregateException("None of the specified methods were invoked.", exceptions);
        }
    }
} 
```

用法：

```
[TestMethod]
public void FooTest()
{
    Mock<IFoo> fooMock = new Mock<IFoo>();
    fooMock.Object.Bar1();

    fooMock.VerifyAny(
        f => f.Bar1(),
        f => f.Bar2());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:24:39.743

如果您正在专门测试是否记录了特定错误，为什么不进行 2 个测试，一个确保`log.Error`被调用，一个确保`log.ErrorFormat`被调用，我假设您可以根据输入控制调用哪一个。

如果您仍然想验证其中一个，您可以使用这种方法，它完全符合您的需要：

[验证单元测试中是否调用了一种方法或另一种方法](https://stackoverflow.com/questions/1099522/verify-that-either-one-method-or-the-other-was-invoked-in-a-unit-test)

# python - Sublime Text 动态 tmLanguage 文件

> ID：14248736
> 
> 赞同：1
> 
> 时间：2013-01-10T00:09:57.387
> 
> 标签：python, api, syntax-highlighting, sublimetext2

我的 github 项目有一个问题，该问题旨在维护 Sublime Text 编辑器的 EJS 语法定义文件。（[https://github.com/samholmes/EJS.tmLanguage/issues/1](https://github.com/samholmes/EJS.tmLanguage/issues/1)）

问题是用户希望能够自定义 EJS 中的开始和结束标记。我将其分别设置为`<?`和`?>`，因为我个人更喜欢这个。但是，“正确”或者我应该说推荐的默认打开和关闭标记是`<%`，`%>`您可以在 EJS 网站上找到。

那么，我想知道是否有一种方法可以在每次安装此软件包时自定义它？我不知道这将如何工作。tmLanguage 文件只是 XML 文件。所以，我的问题是。在这条线上：

[https://github.com/samholmes/EJS.tmLanguage/blob/master/EJS.tmLanguage#L579](https://github.com/samholmes/EJS.tmLanguage/blob/master/EJS.tmLanguage#L579)

有没有办法让某些设置文件生成正则表达式？

任何关于我如何解决这个问题的想法都将受到高度赞赏。我不熟悉 Sublime 的功能或 python API，所以任何对此有更多信息的人，请让我知道你认为我应该做什么。

# php - PHP GD imagefill -- 填充到源代码的左侧

> ID：14248738
> 
> 赞同：0
> 
> 时间：2013-01-10T00:10:00.180
> 
> 标签：php, gd

我正在使用 PHP gd 扩展图像画布：

```
 $newimage = imagecreatetruecolor($imageWidth + 840, $imageHeight);
    $color = imagecolorallocate($newimage, 0, 0, 0);
    imagefill($newimage, 0, 0, $color);
    imagecopy($newimage, $image, 0, 0, 0, 0, $imageWidth, $imageHeight);

    //get extension of the cropped image
    $ext = end(explode('.' , $imageName));

    //timestamp it
    $timestamp = time();

    //rename the new image
    $fileName = rand() . $timestamp . '.' . $ext;

    //unlink old image
    unlink($src);

    //update the DB with new imagename
    $update = array('update' => $this->image->update($imageID, $fileName));

    //Set the path for the image
    $path = 'data/gallery/' . $galleryID . '/images/album/' . $fileName;

    //create the cropped image
    imagejpeg($newimage,$path,$jpeg_quality); 
```

这按预期工作，画布向右扩展了 840 像素。我想做的是将画布向左扩展 840 像素。不知道如何做到这一点。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:32:20.433

一旦我破译了所有参数，实际上非常简单。

```
imagecopy ( resource dest_image, resource source_image, int dest_x, int dest_y, int source_x, int source_y, int source_width, int source_height) 
```

*   您要复制到的目标图像

*   您要从中复制的源图像

*   您要复制到的 X 坐标

*   要复制到的 Y 坐标

*   您要从中复制的 X 坐标

*   要从中复制的 y 坐标

*   要复制的源图像的宽度（以像素为单位）

*   要复制的源图像的高度（以像素为单位）

# actionscript-3 - hitTestpoint 在动作脚本 3 中给出错误

> ID：14248743
> 
> 赞同：0
> 
> 时间：2013-01-10T00:10:25.157
> 
> 标签：actionscript-3, flash, compile-time-constant

我正在尝试让 hitTestPoint 工作。当我输入这个时，我得到这个错误：

> > 场景 1 1046：类型未找到或不是编译时常量：mcircle。

这是我的代码：

```
 import flash.events.Event;

    addEventListener(Event.ENTER_FRAME, hitTest);

function hitTest(evt:Event){
if(mcircle.hitTestPoint(mouseX, mouseY, true)){
    hitText1.text= "hitTestPoint- TRUE";
}
else{
    hitText1.text= "hitTestPoint-FALSE";
} 
```

}

我是一个真正的闪光新手，所以我知道我犯了一些愚蠢的错误。任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:16:41.010

确保您的 mcircle 实例名称与您的代码完全匹配。

在 Flash IDE 中，单击舞台上的圆圈以选择剪辑。然后查看属性面板并验证剪辑的**实例名称**。

如果您不确定属性面板在哪里，您可以使用屏幕顶部的菜单通过选择窗口/属性来找到它。

您在库中看到的名称是符号的名称。它不是实例名称。

# php - PHP/Javascript 共享压缩库

> ID：14248744
> 
> 赞同：1
> 
> 时间：2013-01-10T00:10:29.763
> 
> 标签：php, javascript, compression

是否有一个同时具有 PHP 和 JavaScript 实现的压缩库，以便我可以互换地从/到 JavaScript/PHP 压缩/解压缩？我知道使用 PHP 或 JavaScript 压缩数据有不同的选择，问题是它们使用不同的元数据存储它们的输出。这意味着，例如，如果使用 PHP 将某些数据压缩到文件 output.bin 中，一旦我使用 JavaScript (ajax) 读取 output.bin，就无法解压缩该流。

PS：我不是在寻找 HTTP 请求的压缩，我有一堆压缩文件（通过 PHP），我需要使用 JavaScript 检索和解压缩。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:17:58.673

我不知道像[node.js](http://nodejs.org/)这样的东西是否适合您的方案，但它提供了快速的[zlib](http://zlib.net/)压缩和解压缩。php 也有[zlib](http://php.net/manual/en/book.zlib.php)，因此可以满足您的要求。如果您需要一个完全用 Javascript 编写的 zlib 克隆，那么在 google 搜索中会出现几个。但是我不知道是否有完整或正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:16:01.537

Javascript 方面会比 PHP 方面更棘手，但这里有很多讨论和[链接](https://stackoverflow.com/questions/294297/javascript-implementation-of-gzip)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:16:33.383

我建议研究 HTTP 级别的压缩。但是，如果您真的想手动执行此操作，则可以使用 zlib 例如。PHP 和 JS 都有实现：

[http://www.php.net/manual/en/ref.zlib.php](http://www.php.net/manual/en/ref.zlib.php)

[https://github.com/imaya/zlib.js](https://github.com/imaya/zlib.js)

# java - 为一行生成 id

> ID：14248745
> 
> 赞同：0
> 
> 时间：2013-01-10T00:10:33.340
> 
> 标签：java

我已经在按钮单击事件上调用了返回值 nextId，但是每当我尝试执行按钮单击事件时，它会将其初始化为启动，然后生成下一个，你能帮我解决这个问题吗？

```
package util;

import java.sql.Connection;
import java.sql.ResultSet;
import java.text.SimpleDateFormat;
import java.util.Date;

public class CalendarUtil {

    private static String buffer = "";
    private static int counter = 1;

    public String nextID() {
        final String datePrefix = new SimpleDateFormat("yyyyMMdd").format(new Date());

        if (Long.parseLong(returnMaxId()) > 0) {
            CalendarUtil.counter = Integer.parseInt(returnMaxId().substring(8, returnMaxId().length()));
        }

        if (buffer.equals(datePrefix)) {
            CalendarUtil.counter++;
        } else {
            CalendarUtil.buffer = datePrefix;
            CalendarUtil.counter = 1;
        }

        String suffix = "";

        if (CalendarUtil.counter <= 1000) {

            if (validateRange(0, 9, CalendarUtil.counter)) {
                suffix += "00" + counter;
            } else if (validateRange(10, 99, CalendarUtil.counter)) {
                suffix += "0" + counter;
            } else if (validateRange(99, 999, CalendarUtil.counter)) {
                suffix += counter;
            }
        }

        return (datePrefix + suffix);
    }

    public boolean validateRange(int min, int max, int field) {
        return field >= min && field <= max;
    }

    public String returnMaxId() {
        String result = "";
        try {
            DBUtil util = new DBUtil();
            Connection connection = util.getConnection();
            ResultSet rs = connection.createStatement().executeQuery("SELECT MAX(id) AS 'lastId' FROM crap ");
            if (rs.next()) {
                result = (rs.getString(1) != null) ? rs.getString(1) : "0";
            }
        } catch (Exception e) {
            e.printStackTrace();
            System.out.println("Error : " + e.getMessage());
        }
        return result;
    }
    public static void main(String[] args) {

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:12:52.157

```
 result = (rs.getString(1) != null) ? rs.getString(1) : "0"; 
```

应该

```
 result = (rs.getInt(1) != null) ? rs.getInt(1) : "0"; 
```

但是您应该使用 JDBC API 方法来获取最后插入的 id，请查看以下代码。

```
pstmt = conn.prepareStatement(Query, Statement.RETURN_GENERATED_KEYS);  
pstmt.executeUpdate();  
ResultSet keys = pstmt.getGeneratedKeys();  
keys.next();  
key = keys.getInt(1);  // gets the last inserted id
keys.close();  
pstmt.close();  
conn.close();  
} catch (Exception e) { e.printStackTrace(); }  
return key;  
} 
```

# ios - Error Domain=NSCocoaErrorDomain Code=512 "操作无法完成。操作无法完成。是一个目录

> ID：14248757
> 
> 赞同：1
> 
> 时间：2013-01-10T00:12:29.643
> 
> 标签：ios, ios5, nsdata

我想使用 writeToFile 将图片存储到文档中，但是发现下面的错误，如何解决？

*错误域=NSCocoaErrorDomain 代码=512“操作无法完成。（Cocoa 错误 512。）”{NSFilePath=/Users/alexqdh/Library/Application Support/iPhone Simulator/6.0/Applications/xxx/Documents/girl.png , NSUnderlyingError=0x753e630 "操作无法完成。是目录"}*

```
-(NSString*)getImagePath:(NSString *)name
{
    NSArray *path =NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,  NSUserDomainMask, YES);
    NSString *docPath = [path objectAtIndex:0];
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSString *finalPath = [docPath stringByAppendingPathComponent:name];
    [fileManager createDirectoryAtPath:finalPath withIntermediateDirectories:YES attributes:nil error:nil];
    return finalPath;
}
//below is how to use NSData writeToFile
AFImageRequestOperation *opera = [AFImageRequestOperation imageRequestOperationWithRequest:request imageProcessingBlock:nil
    success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
    img.image = image;
    [self.view addSubview:img];
    NSData *imageData = UIImagePNGRepresentation(img.image);
    if(imageData == nil)
    {
        NSLog(@"imageData nil");
    }
    NSString *picPath = [self getImagePath:@"girl.png"];
    NSLog(@"path:%@",picPath);
    NSError *error = [[NSError alloc]init];
    BOOL a = [imageData writeToFile:picPath options:NSDataWritingAtomic error:&error];
    if(a == YES)
    {
        NSLog(@"YES");
    }
    else
    {
        NSLog(@"NO.error:%@", error);
    }

    /*NSData *imageData = UIImagePNGRepresentation(img.image);
    NSString *picPath = [self getImagePath:@"girl.png"];
    [imageData writeToFile:picPath atomically:YES];*/

    NSLog(@"Got it.code:%d",response.statusCode);
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
    NSLog(@"Failed pic.error:%@",error);
}];

[opera start]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T00:30:05.977

该问题是由创建一个具有图像名称的目录，然后尝试写入一个文件来代替该目录引起的。换句话说，您首先要创建一个名为：

> 文件/girl.png/

然后您尝试将文件写入路径：

> 文件/girl.png

显然这不是你的本意。在您的`getImagePath:`方法中，摆脱创建目录的调用。该`Documents`目录将已经存在。当然，您不想要与文件名对应的目录。

另一种选择是将您的更改`getImagePath:`为：

```
- (NSString*)getImagePath:(NSString *)name {
    NSArray *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,  NSUserDomainMask, YES);
    NSString *docPath = [path objectAtIndex:0];
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSString *finalPath = [docPath stringByAppendingPathComponent:name];

    // Remove the filename and create the remaining path
    [fileManager createDirectoryAtPath:[finalPath stringByDeletingLastPathComponent] withIntermediateDirectories:YES attributes:nil error:nil];

    return finalPath;
} 
```

此更新后的代码现在支持您传入`name`包含您可能想要的子目录的值。

# javascript - 是什么导致使用 setTimeout 的方法出现意外延迟？

> ID：14248758
> 
> 赞同：0
> 
> 时间：2013-01-10T00:12:33.417
> 
> 标签：javascript

中间和完成之间有 43 毫秒的延迟，应该只有 1 毫秒，因为这是甜菜设置的超时值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:22:28.427

43ms 的延迟可能是浏览器花在下载和解析 jQuery 上的时间。JavaScript 在大多数（所有？）浏览器中都是单线程的，我认为浏览器在下载新脚本时暂停脚本执行是很常见的。

至于不工作的函数，你有没有尝试过其他的 jQuery 函数？对我来说，唯一不适合您的功能是您正在重新定义的功能，这让我很怀疑。

# php - kohana orm 从文本列中仅检索指定数量的字符

> ID：14248759
> 
> 赞同：0
> 
> 时间：2013-01-10T00:12:33.727
> 
> 标签：php, mysql, orm, kohana, chop

目前我正在使用 Kohana 框架 3.3 编写一个网站。今天，我想创建一个用户可以浏览新闻的子页面，但是我遇到了 Kohana ORM 的一个小问题。

我想从一个文本字段中只检索十几个/几十个字符，因为加载整个字段会严重浪费服务器资源。

有谁知道我怎样才能达到与这些情况相同的效果？

*   ↓ [MySQL/SQL 检索文本字段的前 40 个字符？](https://stackoverflow.com/questions/2080860/mysql-sql-retrieve-first-40-characters-of-a-text-field)
*   （首选）[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_left](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_left)
*   [如何从 MySQL 字段中只选择一些字符？](https://stackoverflow.com/questions/4530938/how-to-select-only-some-characters-from-mysql-field)

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:37:49.000

查看 ORM 背后的代码，似乎无法加载部分模型。您可能必须结合使用[Database_Query_Builder](http://kohanaframework.org/3.3/guide-api/Database_Query_Builder)类[`DB::expr`](http://kohanaframework.org/3.3/guide-api/DB#expr)来实现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T09:50:03.067

这对于 ORM 类是不可能的。您可以使用 Kohana 自己的查询构建器构建您自己的查询，并且对象可以作为 ORM 模型返回，因此您在 as_object 函数中填写您的 ORM 模型名称（例如“my_orm_model”）。

将您建议的链接之一与 Kohana 自己的查询构建器结合起来，您会得到类似的结果。

```
DB::Query(Database::SELECT,"SELECT LEFT(field, 40) AS excerpt FROM table(s) WHERE ...")->as_object('my_orm_class')->execute(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:16:01.013

ORM 设计用于处理整个记录（查询，如`SELECT * FROM ...`）。您可以将全文值存储在单独的 (MyISAM) 表中，因此您的 ORM 模型将跳过该字段。

# xcode - XCODE 示例中的语音转文本

> ID：14248763
> 
> 赞同：0
> 
> 时间：2013-01-10T00:12:44.453
> 
> 标签：xcode, speech-to-text

我一直在互联网上寻找有关如何创建将语音/语音转换为文本的 xcode 应用程序的示例代码。

希望你们能引导我找到一个关于如何做到这一点的链接，我是 xcode 的新手，如果链接在解释或代码中有点详细，将不胜感激。

谢谢大家和所有stackoverflow社区的其他人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T17:15:35.133

从技术上讲，这不是你应该问的那种问题。你应该提出一个问题并举例说明你迄今为止对这个问题所做的工作，而不是仅仅要求材料。您应该搜索的是 OpenEars。这是一个文本库的演讲，网站上有教程。它还可以将文本转为语音。但是，它有局限性，因此请务必先阅读其所有文档和建议。

# java - Java8 的蛋糕模式可能吗？

> ID：14248766
> 
> 赞同：30
> 
> 时间：2013-01-10T00:12:55.283
> 
> 标签：java, scala, java-8, cake-pattern

我只是想知道：使用 Java 8，以及在接口中添加实现的可能性（有点像 Scala 特征），是否可以像在 Scala 中那样实现[蛋糕模式](https://stackoverflow.com/questions/5172188/understanding-scalas-cake-pattern)？

如果是，有人可以提供代码片段吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-10T01:03:42.610

在其他答案的启发下，我提出了以下（粗略的）类层次结构，类似于 Scala 中的蛋糕模式：

```
interface UserRepository {
    String authenticate(String username, String password);
}

interface UserRepositoryComponent {
    UserRepository getUserRepository();
}

interface UserServiceComponent extends UserRepositoryComponent {
    default UserService getUserService() {
        return new UserService(getUserRepository());
    }
}

class UserService {
    private final UserRepository repository;

    UserService(UserRepository repository) {
        this.repository = repository;
    }

    String authenticate(String username, String password) {
        return repository.authenticate(username, password);
    }
}

interface LocalUserRepositoryComponent extends UserRepositoryComponent {
    default UserRepository getUserRepository() {
        return new UserRepository() {
            public String authenticate(String username, String password) {
                return "LocalAuthed";
            }
        };
    }
}

interface MongoUserRepositoryComponent extends UserRepositoryComponent {
    default UserRepository getUserRepository() {
        return new UserRepository() {
            public String authenticate(String username, String password) {
                return "MongoAuthed";
            }
        };
    }
}

class LocalApp implements UserServiceComponent, LocalUserRepositoryComponent {}
class MongoApp implements UserServiceComponent, MongoUserRepositoryComponent {} 
```

截至 2013 年 1 月 9 日，以上代码在 Java 8 上编译。

* * *

那么，Java 8 可以做蛋糕*一样*的模式吗？**是的。**

它是像 Scala 一样简洁，还是像 Java 中的其他模式一样有效（即依赖注入）？可能不是，上面的草图需要大量文件，而且不如 Scala 简洁。

总之：

*   自我类型（根据蛋糕模式的需要）可以通过扩展我们期望的基本接口来模拟。
*   接口不能有内部类（如@Owen 所述），因此我们可以使用匿名类。
*   `val`并且`var`可以通过使用静态哈希图（和延迟初始化）来模拟，或者由类的客户端简单地将值存储在他们身边（就像 UserService 一样）。
*   我们可以通过使用`this.getClass()`默认接口方法来发现我们的类型。
*   正如@Owen 所指出的，路径依赖类型是不可能使用接口的，因此完整的蛋糕模式本质上是不可能的。但是，上面显示了可以将其用于依赖注入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T01:42:07.637

也许你可以在 Java 8 中做这样的事情

```
interface DataSource
{
    String lookup(long id);
}  

interface RealDataSource extends DataSource
{
    default String lookup(long id){ return "real#"+id; }
}  

interface TestDataSource extends DataSource
{
    default String lookup(long id){ return "test#"+id; }
}  

abstract class App implements DataSource
{
    void run(){  print( "data is " + lookup(42) ); }
}  

class RealApp extends App implements RealDataSource {}

new RealApp().run();  // prints "data is real#42"

class TestApp extends App implements TestDataSource {}

new TestApp().run();  // prints "data is test#42" 
```

但这绝不比普通/旧方法更好

```
interface DataSource
{
    String lookup(long id);
}  

class RealDataSource implements DataSource
{
    String lookup(long id){ return "real#"+id; }
}  

class TestDataSource implements DataSource
{
    String lookup(long id){ return "test#"+id; }
}  

class App
{
    final DataSource ds;
    App(DataSource ds){ this.ds=ds; }

    void run(){  print( "data is " + ds.lookup(42) ); }
}  

new App(new RealDataSource()).run();  // prints "data is real#42"

new App(new TestDataSource()).run();  // prints "data is test#42" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T07:34:09.570

我最近对此做了一个小的概念验证。您可以在此处查看博客文章：http: [//thoredge.blogspot.no/2013/01/cake-pattern-in-jdk8-evolve-beyond.html](http://thoredge.blogspot.no/2013/01/cake-pattern-in-jdk8-evolve-beyond.html)和 github 存储库：[https ://github.com/thoraage /cake-db-jdk8](https://github.com/thoraage/cake-db-jdk8)

基本上你可以做到，但你至少面临两个障碍，使其不如 Scala 流畅。首先，Scala 特征可以有状态，而 Java 的接口不能。许多模块需要状态。这可以通过创建一个通用状态组件来保存此信息来解决，但这需要在一个类中。至少部分。第二个问题是接口中的嵌套类更类似于类中的静态嵌套类。所以你不能直接从模块类访问接口方法。默认接口方法可以访问这个范围，并且可以将它添加到模块类的构造函数中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T01:05:12.047

一些实验表明没有：

*   嵌套类自动是静态的。这本质上不像蛋糕：

    ```
    interface Car {
        class Engine { }
    }

    // ...
        Car car = new Car() { };
        Car.Engine e = car.new Engine();

    error: qualified new of static class
        Car.Engine e = car.new Engine(); 
    ```

*   因此，显然，是嵌套接口，尽管更难哄出错误消息：

    ```
    interface Car {
        interface Engine { }
    }

    // ...
        Car car = new Car() { };
        class Yo implements car.Engine {
        }

     error: package car does not exist
            class Yo implements car.Engine {

     // ...

    class Yo implements Car.Engine {
    }                                                                                                      

     // compiles ok. 
    ```

因此，没有实例成员类，您就没有路径依赖类型，这对于蛋糕模式来说基本上是必需的。所以至少，不，不是直接的方式，这是不可能的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-10T03:42:07.653

忽略 Java 8 中的新功能，理论上您可以使用编译时[AspectJ ITDs](http://www.eclipse.org/aspectj/doc/next/adk15notebook/ataspectj-itds.html)在 Java 5 及更高版本中执行 Cake Pattern 。

[AspectJ DTO 允许您制作 Mixins](https://stackoverflow.com/a/7403617/318174)。唯一烦人的事情是您必须制作两个工件：方面 (ITD) 和接口。但是，ITD 允许您做一些疯狂的事情，例如向实现接口的类添加注释。

# oauth-2.0 - 通过 ouath 2.0 将我的 parse.com api 的一部分暴露给其他开发人员

> ID：14248770
> 
> 赞同：4
> 
> 时间：2013-01-10T00:13:20.060
> 
> 标签：oauth-2.0, parse-platform, publisher

现在创建一个位于 Parse.com 之上的 Web 应用程序是微不足道的。现在我有了这个 web 应用程序，我想通过 oauth 可访问的 api 将它的一部分公开给其他开发人员。因此，他们可以开发一个应用程序，让我的网站用户通过 oauth '授予他们权限'，他们现在可以访问 api。

我将如何开始这样做？

更新：@Mubix 回复后，我觉得以下澄清会有所帮助

目前我正在通过 REST api 从服务器访问 Parse，以解决任何 javascript 安全问题 re:api 密钥等。因此，api 将由 Parse 以外的服务器提供服务。此外，服务器代码位于 javascript/nodejs 中。我遇到了[https://github.com/jaredhanson/oauth2orize](https://github.com/jaredhanson/oauth2orize)这似乎是一个可能的候选人，我想知道其他人是如何做到的，以及是否有人真的更进一步并集成了 Parse 访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T04:43:28.320

嗯..有趣的问题！

**法律：** 首先，他们的[ToS](https://parse.com/about/terms)似乎并没有禁止您尝试做的事情，但您应该在开始之前仔细阅读。

**实现：** 虽然 parse 不提供构建您自己的 API 的功能，但您可以自己实现一些东西。您可以将第三方开发人员视为您应用的用户。您可以使用[ACL](http://www.parse.com/docs/js/symbols/Parse.ACL.html)来控制访问。

**问题：**

*   我看不到任何方法可以完全在解析中实现 oAuth。
*   第三方应用程序将如何访问您的 API？理想情况下，您希望他们使用 REST 接口，但使用 parse.com REST API，您将无法管理对数据不同部分的访问。

**结论：** 完全在 parse 中实现 API 似乎太麻烦了。我建议您编写一个瘦 API 层来处理身份验证并使用 parse 作为后端。您可以使用可用于解析的服务端[库之一。](https://www.parse.com/docs/api_libraries)例如。[PHP 库](https://github.com/apotropaic/parse.com-php-library)，[节点解析](https://github.com/Leveton/node-parse-api)。

# java - Java字符串数字部分的正则表达式

> ID：14248775
> 
> 赞同：1
> 
> 时间：2013-01-10T00:13:59.067
> 
> 标签：java, regex

我正在尝试编写一个Java方法，它将一个字符串作为参数，如果它与模式匹配，则返回另一个字符串，`null`否则返回。图案：

*   以数字开头（1+ 位）；然后是
*   冒号（“ `:`”）；然后是
*   一个空格（“”）；然后是
*   *任何*1+ 个字符的 Java 字符串

因此，一些与此模式匹配的有效字符串：

```
50: hello
1: d
10938484: 394958558 
```

还有一些与此模式**不匹配的字符串：**

```
korfed49
: e4949
6
6:
6:sdjjd4 
```

该方法的一般框架是这样的：

```
public String extractNumber(String toMatch) {
    // If toMatch matches the pattern, extract the first number
    // (everything prior to the colon).

    // Else, return null.
} 
```

到目前为止，这是我最好的尝试，但我知道我错了：

```
public String extractNumber(String toMatch) {
    // If toMatch matches the pattern, extract the first number
    // (everything prior to the colon).
    String regex = "???";
    if(toMatch.matches(regex))
        return toMatch.substring(0, toMatch.indexOf(":"));

    // Else, return null.
    return null;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:17:38.483

您的描述很准确，现在只需将其翻译为正则表达式：

```
^      # Starts
\d+    # with a number (1+ digits); then followed by
:      # A colon (":"); then followed by
       # A single whitespace (" "); then followed by
\w+    # Any word character, one one more times
$      # (followed by the end of input) 
```

在 Java 字符串中给出：

```
"^\\d+: \\w+$" 
```

您还想捕获数字：在 周围加上括号`\d+`，使用 a `Matcher`，如果有匹配项，则捕获组 1：

```
private static final Pattern PATTERN = Pattern.compile("^(\\d+): \\w+$");

// ...

public String extractNumber(String toMatch) {
    Matcher m = PATTERN.matcher(toMatch);
    return m.find() ? m.group(1) : null;
} 
```

注意：在 Java 中，`\w`仅匹配 ASCII 字符和数字（例如，.NET 语言不是这种情况）并且它也将匹配下划线。如果您不想要下划线，您可以使用（Java 特定语法）：

```
[\w&&[^_]] 
```

而不是`\w`正则表达式的最后一部分，给出：

```
"^(\\d+): [\\w&&[^_]]+$" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T00:17:31.667

尝试使用以下内容： \d+: \w+

# xml - 无法使用带有自定义 gzip 编码器的 REST WebInvoke 反序列化合同

> ID：14248776
> 
> 赞同：0
> 
> 时间：2013-01-10T00:14:11.860
> 
> 标签：xml, wcf, rest, post, datacontract

给定一个 REST 服务 POST 调用：

```
 [WebInvoke] // POST
 string PostItem(PostItemContract contract); 
```

在自定义绑定 (web.config) 中使用自定义 gzip 编码器：

```
 <customBinding>
    <binding name="customHttpGzipBindingConfig">          
      <!-- Normally would use binaryMessageEncoding, textMessageEncoding or webMessageEncoding here  -->          
      <gzipMessageEncoding innerMessageEncoding="webMessageEncoding"/>          
      <httpTransport ...>        
    </binding>        
  </customBinding> 
```

我收到一个错误：

> InvalidOperationException：传入消息具有意外的消息格式“原始”。该操作的预期消息格式为“Xml”、“Json”。这可能是因为尚未在绑定上配置 WebContentTypeMapper。有关详细信息，请参阅 WebContentTypeMapper 的文档。

修改 web 配置以使用 webMessageEncoding 而不是 gzipMessageEncoding 可以清除错误。

所以我想我想让自定义 gzipMessageEncoding 表现得好像它是一个 webMessageEncoding：

我首先创建了 GzipWebContentTypeMapper 类：WebContentTypeMapper 其中 GetMessageFormatForContentType() 只返回 WebContentFormat.Xml;

然后对基于 MSDN 示例的编码器进行了一些修改：

[自定义消息编码器：压缩编码器](http://msdn.microsoft.com/en-us/library/ms751458.aspx)

```
class GZipMessageEncoder : MessageEncoder
{   
   public override bool IsContentTypeSupported(string contentType)
   {
       // A BP here says it is returning true, this is where the
       // custom GetMessageFormatForContentType() is getting called.

       return innerEncoder.IsContentTypeSupported(contentType);
   }     
   // ...
}

public class GZipMessageEncodingElement : BindingElementExtensionElement
{        
    public override Type BindingElementType
    {
       get { return typeof(WebMessageEncodingBindingElement); } // just to see
    }
    public override void ApplyConfiguration(BindingElement bindingElement)
    {                        
        GZipMessageEncodingBindingElement binding = (GZipMessageEncodingBindingElement)bindingElement;

        WebMessageEncodingBindingElement element = new WebMessageEncodingBindingElement();
        // responsible for mapping from Content-Type to WCF xml/json/raw/default formats.
        element.ContentTypeMapper = new GzipWebContentTypeMapper();
        binding.InnerMessageEncodingBindingElement = element;                              
    }
    // ...
} 
```

调试器显示：

GzipWebContentTypeMapper 确实被调用并返回 WebContentFormat.Xml；

GZipMessageEncoder.IsContentTypeSupported 返回 true。

显式设置格式也不起作用（？）：

```
[WebInvoke(RequestFormat=WebMessageFormat.Xml)] 
string PostItem(PostItemContract contract); 
```

在 web.config 中，我尝试在自定义 gzip 编码器之前/之后添加 webMessageEncoding，但它没有帮助。

任何想法 GZipMessageEncoder.IsContentTypeSupported 返回 true 后会发生什么？

GzipWebContentTypeMapper（成功返回 WebContentFormat.Xml）的结果将存储在哪里，它怎么会被忽略？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T18:46:48.637

问题是 ContentType 没有被传递给编码器内的 innerEncoder。

那就是将 message.Property[] 添加到带有键的消息的地方

```
WebBodyFormatMessageProperty.Name 
```

和价值

```
new WebBodyFormatMessageProperty(WebContentFormat). 
```

它正在添加“原始”，因为它不知道它正在阅读什么内容类型。

在此处添加了 contentType 参数：

```
class GZipMessageEncoder : MessageEncoder
{
   // ...
   ReadMessage(ArraySegment<byte> buffer, ...)  
   { 
      //...
      _innerEncoder.ReadMessage(decompressedBuffer, bufferManager, **contentType**);
   }

   ReadMessage(Stream stream, ...)
   { 
      //...
      _innerEncoder.ReadMessage(stream, maxSizeOfHeaders, **contentType**);
   }
} 
```

# grails - Grails 中奇怪的 afterInsert / afterUpdate 循环

> ID：14248783
> 
> 赞同：0
> 
> 时间：2013-01-10T00:14:56.553
> 
> 标签：grails, grails-orm

我有一个`Note`域类，当一个新的笔记被保存时，我需要为它创建一个`NoteEvent`，记录该笔记已创建的后代。`Note`有一个 的集合`NoteEvents`，每个`NoteEvent`都跟踪`Note`它属于哪个。

`Note`班级：

```
class Note {
    String noteText
    Date dateCreated

    static hasMany = [events : NoteEvent]
} 
```

`NoteEvent`班级：

```
class NoteEvent {
    Date dateCreated
    String type

    static belongsTo = [note : Note]
} 
```

为了`NoteEvents`在创建便笺时处理新的保存，我使用`afterInsert`，因为我在各处保存便笺实例（在每次保存新便笺后使用特定的事件创建代码将是重复且耗时的)，并且`beforeInsert`显然没有处理`Note`yet 的持久实例 - 没有任何东西`NoteEvent`可以作为它的`note`.

所以现在我的`Note`课是：

```
class Note {
    String noteText
    Date dateCreated

    static hasMany = [events : NoteEvent]

    def afterInsert = {
        def event = new NoteEvent(type: "CREATED")
        addToEvents(event)
        save()
    }
} 
```

但是我还需要`NoteEvent`在其中一个笔记更新时创建一个，这就是混乱和沮丧以及严重缺乏咖啡的地方。要在更新`NoteEvent`时将新的“更新”附加到笔记上，我非常聪明地决定再次使用`afterUpdate`, 以避免在我需要更新`Note`实例时将事件创建代码洒在整个应用程序中。

所以现在，对于`Note`，我有：

```
class Note {
    String noteText
    Date dateCreated

    static hasMany = [events : NoteEvent]

    def afterInsert = {
        def event = new NoteEvent(type: "CREATED")
        addToEvents(event)
        save()
    }

    def afterUpdate = {
        def event = new NoteEvent(type: "UPDATED")
        addToEvents(event)
        save()
    }
} 
```

要将新事件添加到笔记的集合中，我使用的是动态`addTo()`方法，然后需要一个`save()`实例。但在“之后”事件的情况下，这是对`save()`. 因此，当我第一次保存一个新实例并`afterInsert`调用它时，刚刚保存的实例会立即再次保存，这会导致`afterUpdate`事件被触发，现在我有两个笔记事件：我刚刚保存时的“创建”一个笔记，以及“更新”的笔记，当“创建”笔记导致笔记再次被保存时。

我不清楚使用“之前”事件如何在这种情况下有所帮助。我还能怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T03:26:33.483

您实际上可以使用`beforeInsert`和`beforeUpdate`方法。这是因为该`addTo*`方法不需要`Note`是持久化实例。

将`NoteEvent`在保存时`Note`保存，因为在方法中保存`NoteEvent`之前添加了。查看[文档](http://grails.org/doc/latest/ref/Domain%20Classes/addTo.html)以获得更长的解释。`Note``beforeUpdate`[`addTo*`](http://grails.org/doc/latest/ref/Domain%20Classes/addTo.html)

我能够让以下两个`Note`课程按照我认为您希望的方式工作。我确实遇到了一个问题，即在更新`Note`两个`NoteEvent`对象时会添加。我可以通过确保控制器的更新方法使用`noteInstance.save()`而不是`noteInstance.save(flush:true)`.

```
class Note {
    String noteText
    Date dateCreated

    static hasMany = [events : NoteEvent]

    def beforeInsert = {
        def event = new NoteEvent(type: "CREATED")
        addToEvents(event)
    }

    def beforeUpdate = {
        def event = new NoteEvent(type: "UPDATED")
        addToEvents(event)
    }
} 
```

如果您想要一个更精简的版本，该`addTo*`方法知道要添加什么类型的对象，您可以使用的`Map`构造函数`NoteEvent`

```
class Note {
    String noteText
    Date dateCreated

    static hasMany = [events : NoteEvent]

    def beforeInsert = {
        addToEvents(type: "CREATED")
    }

    def beforeUpdate = {
        addToEvents(type: "UPDATED")
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T01:42:29.210

可能有一种方法可以做到这一点，可以使用`beforeInsert`并且`beforeUpdate`因为那些不需要保存`Note`实例。像这样进行二次更新/插入的典型方法是使用`withNewSession`，但在这种情况下，我不确定它是否有意义，因为这更多地用于创建独立对象，并且您需要`Note`在新会话中重新加载. 没那么糟糕，但性能不佳。

一种方法是删除集合并`NoteEvent`直接保存实例：

```
class Note {
   String noteText
   Date dateCreated

   Set<NoteEvent> getEvents() {
      NoteEvent.findAllByNote(this)
   }

   def afterInsert() {
      new NoteEvent(type: "CREATED", note: this).save()
   }

   def afterUpdate() {
      new NoteEvent(type: "UPDATED", note: this).save()
   }
}

class NoteEvent {
   Date dateCreated
   String type
   Note note
} 
```

您失去了级联，因此您希望删除`Note`事务服务方法中的一个实例，以便您可以删除其关联`NoteEvent`的 s。但这确实是整个问题的解决方案。只需删除`afterInsert`和`afterUpdate`回调并在事务服务方法中完成所有工作（创建、更新和删除）。每当您进行多个数据库更新时，您都应该以事务方式进行更新，以便它们全部成功或全部失败。这也满足了您的抗混乱要求，因为所有工作都封装在服务中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T05:17:32.880

> “因为我正在到处保存笔记实例”

我能问一下你在哪里保存它们吗？我会避免将您的域实例保存在您的控制器中。如果您将它们保存在所有地方，则可能值得查看您的整体设计。

就个人而言，我更倾向于创建某种 NoteService，如果可能的话，我会在其中集中 CRUD 操作。一个示例服务是：

```
class NoteService 
{
    Note create (String noteText)
    {
       Note note = new Note(noteText: noteText)  
                       .addToEvents(new NoteEvent(type: NoteEvent.CREATED))
                       .save()   
    } 

    Note update (int id, String noteText)
    {
       Note note = Note.findById(id)
       note.setNoteText(noteText)
       note.addToEvents(new NoteEvent(type: NoteEvent.UPDATED))
           .save()   
    }

    .... 
} 
```

我更喜欢上述方法的原因是，如果您发现自己想要做更多的事情来响应这些事件并避免重复代码，它可以更好地扩展。

另一种方法可能是进行登录过滤器。但是，如果您在许多地方保存笔记实例，这可能会很棘手/混乱。

否则我会考虑使用上面提到的 beforeInsert/beforeUpdate 函数。

# php - PHP检索用户ip，真的靠谱吗？

> ID：14248786
> 
> 赞同：3
> 
> 时间：2013-01-10T00:15:17.410
> 
> 标签：php, javascript, jquery, ip

我正在开发一个系统，通过这个 php 脚本，用户可以通过他们的 IP 地址来识别：

```
function visitorIP()
{ 
    if(isset($_SERVER['HTTP_X_FORWARDED_FOR'])){
        $TheIp=$_SERVER['HTTP_X_FORWARDED_FOR'];
    }else{
        $TheIp=$_SERVER['REMOTE_ADDR'];  
    } 

    return trim($TheIp);
}

$ip = visitorIP(); 
```

我想知道这是否是检索 IP 地址的一种非常安全的方法。我不是在处理信用卡号码或金钱，所以系统不需要超级安全，但如果这个脚本很容易破解，那无论如何都可能是个问题。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:01:22.590

您用于获取 IP 的方法对于 Apache Web 服务器来说是相当标准的，但是 REMOTE_ADDR 不是唯一识别用户的可靠方法。同样正如其他人所指出的，任何“HTTP_*”标头都很容易被欺骗。

最大的问题是，通过 IP 地址来识别用户只是一个简单的问题，而且通常你不会在你希望看到很多用户的大型系统中这样做。我可以想到几种情况，它会崩溃：

*   在典型路由器后面有多个用户的家庭网络。路由器后面的所有计算机/设备都将来自同一个 IP。
*   在将请求转发到 PHP 服务器的负载均衡器后面设置程序。REMOTE_ADDR 将是负载均衡器的 IP。
*   通过代理服务的用户都将拥有与代理服务器相同的 IP。
*   ISP 经常使用 DHCP 为其客户分配 IP 地址。虽然不太可能，但如果 DHCP 租用时间到期/续订，理论上用户的 IP 地址可能会在会话中间发生变化。

[使用session](http://www.php.net/manual/en/book.session.php)可能会更好地处理您的情况。在您第一次看到用户时为其分配会话令牌，而不是使用他们的 IP 地址，并确保在后续请求中传递令牌（通过 cookie 或部分 HTTP 请求）。当您获得令牌时，您可以相当确信它是同一个用户（尽管有嗅探攻击）。

作为额外的奖励，如果您觉得需要，您可以将 IP 跟踪与会话结合起来，让事情变得更加强大。例如，许多应用程序通常会尝试确定用户的 IP 是否已更改，从而使会话无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:17:40.713

`REMOTE_ADDR`本身就是你最好的选择IMO。客户端可以更改任何*带有 HTTP*前缀的$ SERVER 变量，因此您不应该真正信任它。虽然，有些代理会在`HTTP_X_FORWARDED_FOR`标头中转发用户的真实 IP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:19:39.823

我个人只会使用：

```
 $_SERVER['REMOTE_ADDR']. 
```

作为

```
$_SERVER['HTTP_X_FORWARDED_FOR']; 
```

更容易造假。

仅通过 IP 识别人员并不是最好的主意。它们通常很容易被有需要/想要的人伪造/躲避。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T00:21:10.403

您的组合相当标准（我们将其用于基于 IP 的电子订阅检查），尽管正如其他人所指出的那样，它并不完美。

请注意，可以为 HTTP_X_FORWARDED_FOR 指定多个转发 IP；有关详细信息，请参阅[http://en.wikipedia.org/wiki/X-Forwarded-For#Format](http://en.wikipedia.org/wiki/X-Forwarded-For#Format)。

# java - 带有德语变音符号的 JSON Jackson + HTTPClient

> ID：14248787
> 
> 赞同：2
> 
> 时间：2013-01-10T00:15:27.207
> 
> 标签：java, android, json, httpclient

我有一个关于 json 字符串的问题，我使用 Apache http 客户端获取，其中包含德语变音符号。

json 字符串的映射仅在字符串不包含任何德语变音符号时才有效，否则我会收到“JsonMappingException：无法从 START_ARRAY 中反序列化 [...] 的实例。

Apache http 客户端使用“Accept-Charset”设置为 HTTP.UTF-8，但结果我总是得到例如“\u00fc”而不是“ü”。当我用“ü”手动替换例如“\u00fc”时，映射工作完美。

如何从 Apache http 客户端获取 utf-8 编码的 json 响应？还是服务器输出有问题？

```
params.setParameter(HttpProtocolParams.USE_EXPECT_CONTINUE, false);
HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
HttpProtocolParams.setContentCharset(params, HTTP.UTF_8);
httpclient = new DefaultHttpClient(params);
httpclient = new DefaultHttpClient(params);
HttpGet httpGetContentLoad = new HttpGet(url);
httpGetContentLoad.setHeader("Accept-Charset", "utf-8");
httpGetContentLoad.setParams(params);
response = httpclient.execute(httpGetContentLoad);
entity = response.getEntity();
String loadedContent = null;
if (entity != null)
{
   loadedContent = EntityUtils.toString(entity, HTTP.UTF_8);
   entity.consumeContent();
}
if (HttpStatus.SC_OK != response.getStatusLine().getStatusCode())
{
    throw new Exception("Loading content failed");
}
closeConnection();
return loadedContent; 
```

并且json代码映射在这里：

```
String jsonMetaData = loadGetRequestContent(getLatestEditionUrl(newspaperEdition));
Newspaper loadedNewspaper = mapper.readValue(jsonMetaData, Newspaper.class);
loadedNewspaper.setEdition(newspaperEdition); 
```

**更新 1：** JsonMetaData 是包含获取的 json 代码的 String 类型。

**更新2：**

我用来将json输出转换为我需要的这段代码：

```
public static String convertJsonLatestEditionMeta(String jsonCode)
{
    jsonCode = jsonCode.replaceFirst("\\[\"[A-Za-z0-9-[:blank:]]+\",\\{", "{\"edition\":\"an-a1\",");
    jsonCode = jsonCode.replaceFirst("\"pages\":\\{", "\"pages\":\\[");
    jsonCode = Helper.replaceLast(jsonCode, "}}}]", "}]}");
    jsonCode = jsonCode.replaceAll("\"[\\d]*\"\\:\\{\"", "\\{\"");
    return jsonCode;
} 
```

**Update3：** Json 转换示例：

转换前的jsoncode：

```
["Newspaper title",
{
    "date":"20130103",
"pages":
            {
            "1":  {"ressort":"ressorttitle1","pdfpfad":"pathToPdf1","number":1,"size":281506},
            "2":{"ressort":"ressorttitle2","pdfpfad":"pathToPdf2","number":2,"size":281533},
            [...]
        }
    }
] 
```

转换后的Jsoncode：

```
{   
"edition":"Newspaper title",
"date":"20130103",
    "pages":
    [
       {"ressort":"Resorttitle1","pdfpfad":"pathToPdf1","number":1,"size":281506},
       {"ressort":"Resorttitle2","pdfpfad":"pathToPdf2","number":2,"size":281533},
       [...]
    ]
} 
```

**解决方案：** 我按照@Boris 的建议开始使用 GSON，关于变音符号的问题消失了！更多的 GSON 似乎真的比 Jackson Json 更快。

一种解决方法是手动替换此表后面的字符：

```
Sign        Unicode representation

Ä, ä        \u00c4, \u00e4
Ö, ö        \u00d6, \u00f6
Ü, ü        \u00dc, \u00fc
ß           \u00df
€           \u20ac 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T09:28:35.177

尝试这样解析：

```
entity = response.getEntity();
Newspaper loadedNewspaper=mapper.readValue(entity.getContent(), Newspaper.class); 
```

没有理由经过`String`，Jackson`InputStream`直接解析s。如果您使用我提出的方法，Jackson 也会自动检测编码。

**编辑**顺便考虑使用[GSON](http://code.google.com/p/google-gson/) JSON 解析库。它甚至比杰克逊更快，更易于使用。不过，Jackson 最近也开始解析 XMl，这是一个优点。

**EDIT2**毕竟你已经添加了细节，我想问题出在服务的服务器实现上——变音符号不能在 json 中进行 unicode 转义——UTF 8 是它的本机编码。你为什么不`manually replace e.g. "\u00fc" with "ü"`通过正则表达式来代替呢？

# ios - 你如何删除 UITableView 编辑单元格阴影？

> ID：14248788
> 
> 赞同：6
> 
> 时间：2013-01-10T00:15:42.557
> 
> 标签：ios, uitableview, styling

我有一个正在发生的事情的图像：

![在此处输入图像描述](../Images/92c56a1e4dbf1d024d8372ac86b9483e.png)

我如何摆脱那个阴影？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-10-09T10:36:49.783

Swift 4 解决方案；使用扩展的 uitableviewcontroller 因为现在阴影在表格中并且仅在移动单元格时添加。

```
class UITableViewControllerEx: UITableViewController {

    override func viewWillLayoutSubviews() {
        super.viewWillLayoutSubviews()
        view.subviews.filter({ String(describing: type(of: $0)) == "UIShadowView" }).forEach { (sv: UIView) in
            sv.alpha = 0
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-06T05:50:20.927

**在 cellForRowAtIndexPath 中试试这个，它就像 Charm 一样工作！！！**

```
cell.layer.shadowOffset = CGSizeMake(0, 0);
cell.layer.shadowColor = [[UIColor clearColor] CGColor];
cell.layer.shadowRadius = 0;
cell.layer.shadowOpacity = 0.0f; 
```

# android - 打开警报对话框时如何收听onKeydown

> ID：14248792
> 
> 赞同：0
> 
> 时间：2013-01-10T00:16:18.657
> 
> 标签：android

我有一个复选框，取消选中该框后，我会显示警报对话框。我想在弹出警报对话框时按下返回键时保留首选项。当我想将它与 alertDialogBu​​ilder 一起使用时，我知道 onKeyDown 方法并面临问题。如何在弹出警报对话框时收听返回键/按下键事件，并在用户未选中>弹出窗口>但按下返回键时保留复选框首选项。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:33:54.553

我找到了答案，不需要使用 onKeydown 而是可以使用：setOnCancelListener

```
 new AlertDialog.Builder(mContext).setIcon(
    android.R.drawable.ic_dialog_info).setTitle(
    R.string.pref_title_mms_notification_led_color).setView(v)
    .setOnCancelListener(new OnCancelListener() {
        public void onCancel(DialogInterface dialog) {
            mDialogShowing = false;
            mNotificationManager.cancel(0);
        }
    }).setNegativeButton(android.R.string.cancel, 
```

# javascript - 谷歌地图方向经/纬度参数

> ID：14248795
> 
> 赞同：0
> 
> 时间：2013-01-10T00:16:36.720
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在搜索可以通过将 lon/lat 作为源参数直接打开地图窗口并获取我的位置的参数。

像这样的东西，并在地图上绘制方向

[https://maps.google.com/maps?from=37.4219720,-122.0841430&to=GET_MY_LOCATION](https://maps.google.com/maps?from=37.4219720,-122.0841430&to=GET_MY_LOCATION)

感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:37:07.763

没有用于自动检测您的位置的参数，您必须使用例如：[navigator.geolocation自行检测它](https://developer.mozilla.org/de/docs/Using_geolocation)

正确的参数不是`from`，`to`或其他任何东西，它们是`saddr`and `daddr`。

例子：

[`https://maps.google.com/maps?saddr=52.5191,13.4060&daddr=52.4244,13.7497`](https://maps.google.com/maps?saddr=52.5191,13.4060&daddr=52.4244,13.7497)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T05:40:56.963

简单的！假设您的浏览器支持地理定位并且您没有阻止它，就像所有地理定位调用一样，有一个用于自动检测您的位置的参数。

我假设您想直接或通过“a href”标签传递链接而不使用 gmaps api。

```
https://maps.google.com/maps?saddr=52.5191,13.4060&daddr=current%20Location 
```

更好的方法是运行测试并验证地理定位是否支持并打开。查看这个要点：[https](https://gist.github.com/bingeboy/5519841) ://gist.github.com/bingeboy/5519841 如果成功回调触发，那么您知道 URL 将起作用。

# javascript - 用户关闭许多选项卡的选项卡（意味着注销），这些选项卡不会重定向到索引

> ID：14248796
> 
> 赞同：0
> 
> 时间：2013-01-10T00:16:37.660
> 
> 标签：javascript, session, jsf-2, tabs, primefaces

我有以下问题

我使用过滤器使用户能够导航到授权页面，否则它会派生到索引。

显而易见，但必须说，一个浏览器一个会话。此外，当用户关闭浏览器或标签时，他的会话过期。

当用户打开新选项卡并关闭其中一个选项卡时会出现问题，这意味着会话无效并且其他选项卡不会重定向到索引，因为它没有 ajax 事件。

我测试的解决方案之一。

*   仅在仅存在一个选项卡时注销，因为我将不得不计算某个会话变量或 servlet 变量中的选项卡（[在此页面上我阅读了此解决方案，但我不理解此示例...](https://stackoverflow.com/a/13717258/1303201)）。

> 这是 servlet 中的代码，但没有解释它是如何实现的。

```
 public void trackUserTabs() {
    String onload = Controller.getParameter(ONLOAD_ID);
    if (onload != null && onload.trim().equals("true")) {
        openedTabs++;
        System.err.println("onload: " + controller.getCurrentPrinciple() + "..........." + openedTabs);
    }
    String onunload = Controller.getParameter(ONUNLOAD_ID);
    if (onunload != null && onunload.trim().equals("true")) {
        openedTabs--;
        System.err.println("onunload: " + controller.getCurrentPrinciple() + ".............." + openedTabs);
    }
    if (openedTabs <= 0 && controller.getCurrentProfile() != null) {
        /**
         * All tabs are closed, log out current user.
         */
        controller.logoutCurrentProfile();
    } 
```

> 但它有一个细节，我可能不知道用户何时关闭浏览器或选项卡。

另一种解决方案。

*   使用轮询在 javascript 中调用函数并询问是否已记录。尝试使用此功能，但没有积极的结果。

    ```
    function ComprobarSessionExpirada() {

    var request = false;
    if(window.XMLHttpRequest) { // Mozilla/Safari
        request = new XMLHttpRequest();
    } else if(window.ActiveXObject) { // IE
        request = new ActiveXObject("Microsoft.XMLHTTP");
    }
    var url = '/ACP_3.0/pag/resumen.jsf';
    request.open('POST', url, true);
    request.onreadystatechange = function() {
        alert('a');
        if(request.readyState == 4) {
            var session = eval('(' + request.responseText + ')');
            if(session.valid) {
                alert('ok');
                // DO SOMETHING IF SESSION IS VALID
            } else {
                alert('Your Session has expired');
                window.location = '/ACP_3.0/index.jsf';
            }
        }
    }
    request.send(null);
    } 
    ```

**编辑：**

> 我忘了提到我在应用程序的 bean 中维护用户信息，这可以让我知道我进行的聊天的用户状态。
> 
> 因此，您需要识别用户何时直接（注销）或间接（关闭浏览器或超时​​）关闭会话，因为如果不关闭会话，则用户的状态始终保持在线。
> 
> 为了识别他什么时候下线，我使用了破坏会话的前奏。实现 HttpSessionListener 方法 sessionDestroyed 在应用程序 bean 中更改用户的状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T08:15:09.763

我可能不是唯一一个这样认为的人。不要试图将会话绑定到选项卡，浏览器不是出于某种目的而设计的。

大多数正常用例都会受到关闭选项卡时会话将终止的设计的影响。如果用户不小心关闭了他的最后一个标签怎么办？

# mysql - 如何编译这个复杂的 sql 查询

> ID：14248799
> 
> 赞同：3
> 
> 时间：2013-01-10T00:16:44.130
> 
> 标签：mysql, sql, select, join

我有一个关于我想要执行的 SQL 的问题，但不知道如何编写它。以下是具有如此虚拟数据的表格：

**模块：**

```
ModuleId (PK auto) ModuleNo   ModuleName
1                  CHI2523    Business 
```

**课程：**

```
CourseId (PK auto)  CourseName
1                    Business and Computing
2                    ICT
3                    Sports 
```

**课程_模块：**

```
CourseId (PK) ModuleId (PK)
1             1 
2             1 
```

**会议：**

```
SessionId (PK auto)  SessionName  ModuleId (FK)
3                    DFRER        1 
```

**学生：**

```
StudentId (PK auto)  StudentAlias StudentForename  StudentSurname  CourseId (FK)
1                    u03824       Bill             Murphy          1
2                    u38492       Conrad           Jones           2
3                    u48383       Jane             Peters          1
4                    u34322       Morgan           Gray            2
5                    u39292       Bilal            Tuddy           3 
```

**学生会话：**

```
SessionId (PK)  StudentId (PK)
3               1
3               2 
```

我希望查询能够找到的是所有剩余的当前未参加所选评估但可以清楚地参加评估的学生。

因此，为了能够做到这一点，我们必须：

*   `SessionId`通过在`Session`表中查找来查看所选会话是什么

*   通过查看表中`SessionId`的来查看属于哪个模块。`ModuleId``Session`

*   `ModuleId`通过`Course_Module`查表查看哪些课程

*   通过查看与表中的's`CourseId`匹配的学生表来查找每个学生的课程`CourseId``Course_Module`

*   显示属于该模块所在课程的所有学生，但只显示当前不在会话中的学生（或者换句话说，不在`Session`表格中选择所选`SessionId`.

所以如果`SessionId`选择的是 3，那么它应该输出的学生是：

```
StudentId (PK auto)  StudentAlias StudentForename  StudentSurname  CourseId (FK)
3                    u48383       Jane             Peters          1
4                    u34322       Morgan           Gray            2 
```

这是因为：

*   `SessionId`3属于`ModuleId`1

*   `ModuleId`属于`CourseId`1 和 2

*   查找`CourseId`1 和 2 有 4 名学生参加了该课程

*   `SessionId`但是其中 2 名学生在查看 Table 时已经参加了3`Student_Session`次，因此只显示其他 2 名学生，因为他们目前没有参加课程

我的问题是如何编写查询以实现上述示例？我已经开始查询，但需要有人帮助来增强它，以便它符合上面示例的要求：

```
SELECT s.StudentId, StudentAlias, StudentForename, StudentSurname
FROM Session s 
INNER JOIN Module m ON m.ModuleId = s.ModuleId
INNER JOIN Course_Module cm ON cm.ModuleId = m.ModuleId
INNER JOIN Student s ON cm.CourseId = s.CourseId
INNER JOIN Student_Session ss ON s.StudentId = ss.StudentId
WHERE s.SessionId = 3
ORDER BY StudentAlias; 
```

我不知道如何检查哪些学生是/不清晰，然后只选择那些可以参加评估但目前没有参加评估的学生

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T00:46:40.700

```
SELECT  e.*
FROM    Session a
        INNER JOIN Module b
            ON a.ModuleID = b.ModuleID
        INNER JOIN Course_Module c
            ON b.ModuleID = c.ModuleID
        INNER JOIN Course d
            ON c.CourseID = d.CourseID
        INNER JOIN Student e
            ON d.CourseID = e.CourseID
        LEFT JOIN Student_Session f
            ON f.sessionID = a.SessionID AND
                f.studentID = e.studentID
WHERE   a.SessionID = 3 AND
        f.studentID IS NULL
ORDER   BY e.STUDENTALIAS 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/9c068/8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:51:45.207

```
SELECT s.StudentId, StudentAlias, StudentForename, StudentSurname
FROM Session s 
INNER JOIN Module m ON m.ModuleId = s.ModuleId
INNER JOIN Course_Module cm ON cm.ModuleId = m.ModuleId
INNER JOIN Student s ON cm.CourseId = s.CourseId
LEFT OUITER JOIN Student_Session ss ON s.StudentId = ss.StudentId AND s.SessionId = 3
WHERE s.SessionId = 3
AND ss.SessionID IS NULL
ORDER BY StudentAlias; 
```

左外连接允许您找出谁在 Student_session 中，谁不在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T01:10:19.113

我没有时间用你的数据创建一些测试数据库，但我希望我的代码能给你一些提示，如何达到你的目标。

你不应该在没有冲动的情况下使用 INNER JOIN。它们不利于请求性能，并且会在您不想要它们的地方产生许多重复。

也许你应该阅读这个以获得更好的理解：[http ://www.w3schools.com/sql/sql_join.asp](http://www.w3schools.com/sql/sql_join.asp)

```
SELECT s.* FROM Student AS s 

# JOIN STUDENT SESSION
LEFT JOIN Student_Session AS ss
ON (ss.StudentId = s.StudentId AND ss.SessionId = 3)

# JOIN COURSE
LEFT JOIN Course_Module AS cm
ON s.CourseId = cm.CourseId

LEFT JOIN Session AS se 
ON (cm.ModuleId = se.ModuleId AND se.SessionId = 3)

WHERE se.SessionId IS NOT NULL
AND ss.SessionId IS NULL

ORDER BY StudentAlias; 
```

# hadoop - 启动 hadoop 流式作业的替代方法

> ID：14248800
> 
> 赞同：2
> 
> 时间：2013-01-10T00:16:46.970
> 
> 标签：hadoop, hadoop-streaming

我可以从终端成功启动 hadoop 流式传输作业，但我正在寻找通过 api、eclipse 或其他方式开始处理作业的方法。

我发现的最接近的是这篇文章[https://stackoverflow.com/questions/11564463/remotely-execute-hadoop-streaming-job](https://stackoverflow.com/questions/11564463/remotely-execute-hadoop-streaming-job)但它没有答案！

欢迎任何想法或建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:27:10.083

有趣的问题，我找到了一种方法来做到这一点，希望这对你也有帮助。

第一种方法应该适用于 Hadoop 0.22：

```
Configuration conf = new Configuration();
conf.set("fs.defaultFS", "hdfs://xxxxx:9000");
conf.set("mapred.job.tracker", "hdfs://xxxxx:9001");
StreamJob sj = new StreamJob();
try {
    ToolRunner.run(conf, sj, new String[] { 
                "-D", "stream.tmpdir=c:\\",
                "-mapper", "/path/to/mapper.py",
                "-reducer", "/path/to/reducer.py", "-input",
                "/path/to/input", "-output",
                "/path/to/output" });
} catch (Exception e) {
    e.printStackTrace();
} 
```

我还发现了这个你应该能够运行的[Java 包装器。](https://github.com/lohitvijayarenu/hadoop-common/blob/trunk/hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/streaming/HadoopStreaming.java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T02:31:35.963

看看[Apache Oozie——](http://oozie.apache.org/)一旦你通过 XML 定义了你的工作，你就可以通过一个 Http POST 向 oozie 服务器启动一个工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T16:22:02.527

当 Hadoop 流作业运行为

> hadoop jar /home/training/Installations/hadoop-1.0.3/contrib/streaming/hadoop-streaming-1.0.3.jar -input input4 -output output4 -mapper /home/training/Code/Streaming/max_temperature_map.rb -reducer /home/training/Code/Streaming/max_temperature_reduce.rb

然后执行[org.apache.hadoop.streaming.HadoopStreaming](http://svn.apache.org/repos/asf/hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/streaming/HadoopStreaming.java)。此类在 hadoop-streaming-1.0.3.jar 的 MANIFEST.MF 中定义。检查[org.apache.hadoop.streaming.HadoopStreaming](http://svn.apache.org/repos/asf/hadoop/common/trunk/hadoop-tools/hadoop-streaming/src/main/java/org/apache/hadoop/streaming/HadoopStreaming.java) java 类中的代码以了解 API 详细信息。

# javascript - 如何从 Backbone.listenTo 中找到触发事件？

> ID：14248801
> 
> 赞同：5
> 
> 时间：2013-01-10T00:16:48.313
> 
> 标签：javascript, backbone.js, backbone-events, backbone.js-collections

在 Backbone 中，我正在使用新`Backbone.listenTo`事件。我的一个实例将侦听器附加到三个不同的事件，例如：

```
this.listenTo(this._Collection, 'reset add change', this._setCollection); 
```

当它应该被适当地调用并且那里没有问题时，它会被适当地调用。我不知道如何找出触发了哪个事件。我可以使用以下方法访问`e`参数：

```
_setCollection: function(e) {
    // Do fun stuff
} 
```

问题是该`e`参数仅发送集合的副本，并没有提及实际触发的事件。我试过了`e.type`，`e.target`但那些对象不存在。`e`这是来自 Chrome 开发工具的对象的副本：

```
_byCid: Object
_byId: Object
_events: Object
    add: Array[1]
    change: Array[1]
    remove: Array[1]
    reset: Array[1]
__proto__: Object
_listenerId: "l16"
length: 3
models: Array[3] 
```

我怎样才能找到触发了什么事件？

编辑：答案澄清：虽然标记的答案在技术上是正确的，正如 mu_is_too_short 所指出的，正确的答案是使用多个处理程序而不是执行这种类型的“诡计”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T00:42:46.793

您无法直接检测事件类型，但在某些情况下，您可以从[`arguments`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments). [活动目录](http://backbonejs.org/#Events-catalog)有这样的说法：

> *   **"add"** (model, collection, options) — 将模型添加到集合时。
> *   **"reset"** (collection, options) — 当集合的全部内容被替换时。
> *   **"change"** (model, options) — 当模型的属性发生变化时。

幸运的是，所有这三个事件都有不同的参数，因此 的内容`arguments`将唯一（在这种情况下）确定触发事件：

1.  如果`arguments[0]`是一个模型并且`arguments[1]`是一个集合，那么你就有一个`"add"`事件。
2.  如果`arguments[0]`是一个集合，那么你有一个`"reset"`事件。
3.  如果`arguments[0]`是一个模型并且`arguments.length`是 2 那么你有一个`"change"`事件。

所以你可以在你的`_setCollection`：

```
 // M is your model, C is your collection.
    if(arguments[0] instanceof M
    && arguments[1] instanceof C) {
        // An "add" event...
    }
    else if(arguments[0] instanceof C) {
        // A "reset" event...
    }
    else if(arguments[0] instanceof M
         && arguments.length == 2) {
        // A "change" event...
    }
    else {
        console.log('confusion!');
    } 
```

演示：http: [//jsfiddle.net/ambiguous/Y9UUX/](http://jsfiddle.net/ambiguous/Y9UUX/)

I wouldn't recommend this sort of chicanery though, it is kludgey, fragile, and can break if you add more event types to the list. If your event handler needs to know what sort of event triggered it then you'd be better off using separate handlers for each event type: three functions and three `listenTo` calls are better than a small pile of ugly hackery.

# mysql - Mysql Dashboard 覆盖客户端（UUID 问题）

> ID：14248808
> 
> 赞同：0
> 
> 时间：2013-01-10T00:17:24.223
> 
> 标签：mysql, uuid

我正在使用 MySQL 仪表板，并且我有 2 台彼此为主/从属的服务器。

当我创建具有*唯一* `UUID`性的 mysql 代理时，一切正常。代理连接到仪表板并正确显示。除了主机名不来自 agent.ini。但是，当我在第二台服务器上启动代理时，它会覆盖第一台。名字是一样的。服务器`UUID`是相同的（这很奇怪，因为我手动配置了`UUID`），但它仍然从数据库中提取它，而不是服务器详细信息中的 INI。但是，主人不一样。

换句话说，它取代了前一个实例，而不是 2 个实例。

我禁用`UUID`了发现。我设置了`UUID`，但似乎找不到任何解决方案。

我希望在我松开所有头发之前有人能指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:22:56.147

真该死！有时思考两秒钟就能解决问题。由于这是复制主机，我必须复制 mysql 数据库（不喜欢这样做，我更喜欢只复制需要的数据库并单独保留 mysql 数据库），库存在主机之间共享。好吧，这就是问题所在。

为了解决这个问题，我重新创建了清单，但只是简单地：'truncate mysql.inventory' 并重新启动主机上的代理。

一切都很好！

# javascript - 多个 Youtube Iframe API

> ID：14248813
> 
> 赞同：1
> 
> 时间：2013-01-10T00:17:53.163
> 
> 标签：javascript, api, youtube

有人可以帮我弄清楚为什么我不能在同一页面上有多个 Youtube API iframe 吗？当我尝试将此代码复制并粘贴为另一个实例时，一个或另一个不会出现。我已经尝试删除这段代码的一些第一行，因为我怀疑这就是问题所在，但我在 Javascript 方面相对较新，我不知道该怎么做才能继续。

我需要在我的页面上安装大约 6 个 Youtube 剪辑，并且需要使用 API，以便在隐藏包含 DIV 时可以使用 stopVideo()。

帮助！请！如果我的代码丑陋或调用不必要的东西，请原谅我。我已经为此投入了 24 小时的代码，试图让它工作。

每个玩家都在自己的 Absolute Div 中。然后使用 Youtube API 创建一个 Youtube div。

例如，这是一个例子......

```
<div id="notes1"  style="position:absolute; z-index:0; width:541px; left: 363px; top: 224px; height: auto; overflow:auto; overflow-x: hidden; background-color: #FFFFFF; layer-background-color: #FFFFFF; visibility: hidden;"> 

    <div id="notesplayer"></div>
   <script>

      var tag = document.createElement('script');
      tag.src = "http://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      var notesplayer;
      function onYouTubeIframeAPIReady() {
        notesplayer = new YT.Player('notesplayer', {
          height: '365',
          width: '425',
          videoId: 'cmIg9MWhVss',
          playerVars: {
            modestbranding: 1,
            wmode: "opaque",
            autoplay:0,
        },
          events: {
            'onReady': onPlayerReady,

          }
        });
      }

      function onPlayerReady(event) {
        notesplayer.stopVideo();
      }

     function stop() {
  if (notesplayer) {
    notesplayer.stopVideo();
  }
     }
    </script>
</div> 
```

这是另一个例子......

```
<div id="married"  style="position:absolute; z-index:0; width:541px; left: 363px; top: 224px; height: auto; overflow:auto; overflow-x: hidden; background-color: #FFFFFF; layer-background-color: #FFFFFF; visibility: hidden;"> 
```

```
 <script>

      var tag = document.createElement('script');
      tag.src = "http://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
      var marriedplayer;
      function onYouTubeIframeAPIReady() {
        marriedplayer = new YT.Player('marriedplayer', {
          height: '365',
          width: '425',
          videoId: 'nREbUaxUlmE',
          playerVars: {
            modestbranding: 1,
            wmode: "opaque",
            autoplay:0,
        },
          events: {
            'onReady': onPlayerReady,

          }
        });
      }

      function onPlayerReady(event) {
        marriedplayer.stopVideo();
      }

     function stop() {
  if (marriedplayer) {
    marriedplayer.stopVideo();
  }
     }
    </script>
</div> 
```

最终我希望能够控制/停止我现有的显示/隐藏图像映射中的每个视频......例如......

```
<area shape="rect" coords="8,19,561,74" href="#" alt="Home" onmouseover="MM_showHideLayers('Film-Menu-Plain','','hide','Film-Menu-Married','','hide','Film-Menu-Run','','hide','Film-Menu-Notes1','','hide','Film-Menu-Notes2','','hide');notesplayer.stopVideo();marriedplayer.stopVideo();"/> 
```

我到底做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:50:42.730

你给他们都一样的ID，'notesplayer'吗？如果是这样，那就可以解释为什么每个

```
 new YT.Player('notesplayer', ...) 
```

正在覆盖前一个播放器对象。

如果没有，请显示更多代码...这样我们就可以看到每个播放器的 html 和 javascript 与其他播放器的关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T01:29:23.253

这是一个链接，可以帮助我解决同样的问题。[处理多个 youtube 视频](https://stackoverflow.com/questions/13043799/handling-multiple-youtube-videos)

我挂断电话的地方和你一样。我们不能使用多个 youtube api 脚本堆栈，而是必须一起描述变量。

```
 <script>

var tag = document.createElement('script');
      tag.src = "http://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    //call all your video ids' variables here
    var notesplayer;
    var marriedplayer;
    //then the function
    function onYouTubeIframeAPIReady() {
        notesplayer = new YT.Player('notesplayer', {
          height: '365',
          width: '425',
          videoId: 'cmIg9MWhVss',
          playerVars: {
            modestbranding: 1,
            wmode: "opaque",
            autoplay:0,
        },
          events: {
            'onReady': onPlayerReady,

          }
        });
        marriedplayer = new YT.Player('marriedplayer', {
          height: '365',
          width: '425',
          videoId: 'nREbUaxUlmE',
          playerVars: {
            modestbranding: 1,
            wmode: "opaque",
            autoplay:0,
        },
          events: {
            'onReady': onPlayerReady2, //this can't be the same as the above one

          }
        });

      }
    // this ends that set and now you're ready to call some function events
    // notice how i refer to onPlayerReady2 for marriedplayer etc
    function onPlayerReady2(event) {
        marriedplayer.stopVideo();
      }
    </script> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-18T09:20:22.617

```
<script type="text/javascript" src="http://www.youtube.com/player_api"></script>
<script>

    var player1st;
    var player2nd;
    function onYouTubePlayerAPIReady() { 
    player1st = new YT.Player('frame1st', {events: {'onStateChange': onPlayerStateChange}}); 
    player2nd = new YT.Player('frame2nd', {events: {'onStateChange': onPlayerStateChange}});
        }

    //function onYouTubePlayerAPIReady() { player2nd = new YT.Player('frame2nd', {events: {'onStateChange': onPlayerStateChange}}); }

    function onPlayerStateChange(event) {
    alert(event.target.getPlayerState());

    }

</script>

<iframe id="frame1st" style="position: relative; height: 220px; width: 400px" src="http://www.youtube.com/embed/1g30Xyh6Wqc?rel=0&amp;enablejsapi=1"></iframe><br>
<a href="javascript: void(0)" onclick="player1st.playVideo(); return false">play1st</a><br>
<a href="javascript: void(0)" onclick="player1st.pauseVideo(); return false">pause1st</a><br>
<a href="javascript: void(0)" onclick="player1st.stopVideo(); return false">stop1st</a>

<iframe id="frame2nd" style="position: relative; height: 220px; width: 400px" src="http://www.youtube.com/embed/T39hYJAwR40?rel=0&amp;enablejsapi=1"></iframe><br>

<a href="javascript: void(0)" onclick="player2nd.playVideo(); return false">play2nd</a><br>
<a href="javascript: void(0)" onclick="player2nd.pauseVideo(); return false">pause2nd</a><br>
<a href="javascript: void(0)" onclick="player2nd.stopVideo(); return false">stop2nd</a> 
```

[http://jsfiddle.net/sumanP/rzeb23aq/1/](http://jsfiddle.net/sumanP/rzeb23aq/1/)

# javascript - jQuery - 删除元素不会删除相关的规则和错误消息

> ID：14248819
> 
> 赞同：0
> 
> 时间：2013-01-10T00:19:14.177
> 
> 标签：javascript, jquery, html

在我的页面中，我有一组基本输入元素。除了这些之外，我还有另外一堆输入元素，我会根据某些条件动态添加和删除它们。在添加时，我将 jQuery 事件、规则和消息附加到它们。到目前为止一切正常。

1.  删除这些元素（使用“删除”或“空”方法）不会删除相关的规则和消息。jQuery 文档明确指出删除元素会删除关联的事件，但并不清楚规则。目前，我正在通过迭代这些元素来删除这些规则。有没有更好的办法？

2.  label.error 也是如此。删除输入元素不会自动删除错误消息，无论是隐藏的还是显示的。目前，我正在遍历输入元素，查询错误消息标签（使用'for=elementid'）并删除它们。有没有更好的办法？

我正在使用验证插件，并且规则和消息与之关联。这是一个代码片段：

```
//remove the rules
$('.typeProperty').each(function(){ $(this).rules('remove'); });
//remove the input elements
$('#typeDiv').empty(); 
```

其中“typeProperty”是我与动态插入的元素相关联的类。

以下是删除错误消息的代码片段：

```
for (var i in inputElements) {
   //jQuery messages
   $("label.error[for={0}]".format(inputElements[i].attr('id'))).remove();
   //custom messages
   $("label.cerror[for={0}]".format(inputElements[i].attr('id'))).remove();
} 
```

其中 'inputElements' 是动态添加的输入元素的数组

# ruby-on-rails - Rails 3.0 - 无法使用 Bundler 加载 ruby -oci8

> ID：14248821
> 
> 赞同：3
> 
> 时间：2013-01-10T00:19:21.447
> 
> 标签：ruby-on-rails, bundler, gemfile, oci8

Rails n00b 这里 - 需要一些帮助。我正在尝试将 Rails3 应用程序从 Linux 移植到 Windows。我的 Gemfile 如下所示：

```
source 'http://rubygems.org'
gem 'rails', '3.0.0'
gem 'sqlite3-ruby', '1.2.5', :require => 'sqlite3'
gem 'ruby-oci8', '1.0.6' 
```

我在这台 Windows 机器上没有 Oracle 客户端，所以我无法本地编译 ruby​​-oci8 gem。

我已经在我的 Gemfile 中注释掉了“ruby-oci8”行，并从这里手动安装了 gem：[http](http://rubygems.org/downloads/ruby-oci8-1.0.6-x86-mswin32-60.gem) ://rubygems.org/downloads/ruby-oci8-1.0.6-x86-mswin32-60.gem 。我还将必要的 DLL 复制到`ruby\bin`.

我已经验证它有效：

```
ruby -rubygems -e "require 'oci8'; OCI8.new('user','password','pasdev:2700/gen11dvu').exec('select * from ARCS_USER_LO
GON') do |r| puts r.join(','); end" 
```

这会从我的数据库返回大量数据，所以我知道它有效。

但是，如果我尝试`require 'oci8'`从 rails 控制台（或正在运行的应用程序），我会得到以下信息：

```
LoadError: no such file to load -- oci8 
```

我认为这发生在 b/c Rails 只加载 Gemfile 中指定的 gem，但我不知道如何指定它！我已经安装了我需要的 gem：

```
C:\javadev\ashbtw3>gem list

*** LOCAL GEMS ***

activerecord (3.0.0)
bundler (1.0.21, 1.0.0)
rails (3.0.0)
rake (0.8.7)
ruby-oci8 (1.0.6 x86-mswin32-60)
...etc... 
```

然而，如果我在 Gemfile 中取消注释这一行：

```
gem 'ruby-oci8', '1.0.6' 
```

bundler 尝试下载并编译另一个 1.0.6，这当然会失败。我也尝试了所有这些变体，但均未成功：

```
gem 'ruby-oci8', '1.0.6', :platforms => :mingw
gem 'ruby-oci8', '1.0.6-x86-mswin32-60', :platforms => :mingw32
gem 'ruby-oci8-1.0.6-x86-mswin32-60'
gem 'ruby-oci8', '1.0.6-x86-mswin32-60' 
```

为什么 bundler 试图安装我已经拥有的 gem？如何正确指定版本和平台以使 Bundler 看到该 gem 已安装，并将其包含在 Gemfile.lock 中？这里有没有其他解决方案可以在不安装 Oracle 客户端的情况下使用？

**编辑 1**：

根据凯尔的建议，我尝试了以下方法：

```
gem 'ruby-oci8', :path => 'C:/Ruby187/lib/ruby/gems/1.8/gems/ruby-oci8-1.0.6-x86-mswin32-60 
```

这使得 Bundler 运行成功！

```
Using ruby-oci8 (1.0.6) from source at C:/Ruby187/lib/ruby/gems/1.8/gems/ruby-oci8-1.0.6-x86-mswin32-60 
```

但是，现在尝试从 Rails 控制台要求“oci8”给了我这个：

```
C:\javadev\ashbtw3>ruby script\rails console
Loading development environment (Rails 3.0.0)
irb(main):001:0> require 'oci8'
LoadError: no such file to load -- oci8lib
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:239:in `require'
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:239:in `require'
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:225:in `load_dependency'
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:591:in `new_constants_in'
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:225:in `load_dependency'
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:239:in `require'
        from C:/Ruby187/lib/ruby/gems/1.8/gems/ruby-oci8-1.0.6-x86-mswin32-60/lib/oci8.rb:20
        from C:/Ruby187/lib/ruby/gems/1.8/gems/activesupport-3.0.0/lib/active_support/dependencies.rb:239:in `require' 
```

它缺少的文件`ext/oci8`位于已安装的 gem 目录下，但它看不到它。

还有什么我可以做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:40:46.393

您是否尝试过指定`:path`?

```
gem 'ruby-oci8', :path => '/path/to/ruby-oci8-1.0.6-x86-mswin32-60' 
```

# java - 使用 Swing 设计聊天布局

> ID：14248825
> 
> 赞同：1
> 
> 时间：2013-01-10T00:19:42.160
> 
> 标签：java, swing, user-interface, jtextpane

我正在尝试使用 Swing 设计一个聊天 UI，但我太笨了，无法弄清楚如何为消息部分进行适当的缩进。

这是我所追求的一个例子： ![http://xchat.org/docs/start/xchat-3-channel.png](../Images/5c56c7b395f1c5fc82530c9ae4f84538.png)

这是我刚刚破解的内容（只需复制并粘贴即可）：

```
import javax.swing.*;
import javax.swing.text.*;
import java.awt.*;

public class Scrap {

private static final int NICK_INDENT = 120;
private static final int MESSAGE_INDENT = NICK_INDENT + 10;

private static boolean applyHangingIndent = false;

public static void main(final String args[]) {
    StyledDocument doc = new DefaultStyledDocument();
    JTextPane pane = new JTextPane(doc) {
        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.setColor(Color.BLACK);
            g.drawLine(NICK_INDENT + 5, 0, NICK_INDENT + 5, getHeight());
        }
    };

    TabStop[] tabs = new TabStop[2];
    tabs[0] = new TabStop(NICK_INDENT, TabStop.ALIGN_RIGHT, TabStop.LEAD_NONE);
    tabs[1] = new TabStop(MESSAGE_INDENT, TabStop.ALIGN_LEFT, TabStop.LEAD_NONE);
    TabSet tabset = new TabSet(tabs);

    StyleContext sc = StyleContext.getDefaultStyleContext();
    AttributeSet aset = sc.addAttribute(SimpleAttributeSet.EMPTY, StyleConstants.TabSet, tabset);
    pane.setParagraphAttributes(aset, false);

    insertString(doc, "\ta nickname:\tthis is the message blaa blaa blaa\n");

    if (applyHangingIndent) {
        applyHangingIndent(doc);
    }

    insertString(doc, "\tanother nickname:\there is another message blaa blaa blaablaa, try to resize the window\n");

    if (applyHangingIndent) {
        applyHangingIndent(doc);
    }

    insertString(doc, "\ta third nickname:\tnow try to set the applyHangingIndent to true!\n");

    if (applyHangingIndent) {
        applyHangingIndent(doc);
    }

    JFrame frame = new JFrame();
    frame.setContentPane(new JScrollPane(pane));
    frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
    frame.setSize(600, 300);
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);
}

private static void insertString(StyledDocument doc, String str) {
    try {
        doc.insertString(doc.getLength(), str, null);
    } catch (BadLocationException e) {
        e.printStackTrace();
    }
}

private static void applyHangingIndent(StyledDocument doc) {
    SimpleAttributeSet sas = new SimpleAttributeSet();
    int indent = MESSAGE_INDENT;
    StyleConstants.setFirstLineIndent(sas, -indent);
    StyleConstants.setLeftIndent(sas, indent);
    doc.setParagraphAttributes(0, doc.getLength(), sas, false);
}
} 
```

尝试将窗口调整为更小的尺寸。

现在，尝试将 applyHangingIndent 设置为 true 并再次调整大小。

在我看来，代码应该没问题，但是负的第一行缩进属性似乎不适用于制表位。

任何人都知道如何使缩进正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T06:00:13.593

我会推荐另一种方法 - 基于表格。

请参阅示例[http://java-sl.com/JEditorPaneTables.html](http://java-sl.com/JEditorPaneTables.html)和此[http://java-sl.com/JEditorPaneTablesRowColumnInsert.html](http://java-sl.com/JEditorPaneTablesRowColumnInsert.html) 您可以根据需要定义一个包含 2 列和任意多行的表（对于每条消息）。

第一个单元格包含昵称，第二个单元格包含消息。您可以根据需要对齐单元格的内容（实际上是普通段落）。您还可以为列/行定义要呈现或不呈现的任何所需边框。

# c++ - 使用 Dijkstra 算法 - alg 从邻接矩阵计算下一跳路由表。不停歇

> ID：14248827
> 
> 赞同：2
> 
> 时间：2013-01-10T00:19:47.857
> 
> 标签：c++, algorithm, graph, routing, dijkstra

我正在尝试使用[邻接矩阵](https://en.wikipedia.org/wiki/Adjacency_matrix)确定下一跳路由表。每个节点都知道该拓扑的完整邻接矩阵。我发现以前的帖子解释了如何做到这一点，但是，我不明白为什么我的错误。我有几个辅助函数，但它们的名称很直观，因此您可以跳到“开始路由计算”。

我使用邻接矩阵作为成本矩阵，它只有 0 和 1。由于某种原因，该算法似乎没有停止。队列卡在大小 1,3 或 5 上，具体取决于节点。

变量 rank 保存当前节点索引，它在 OpenMPI 中运行，因此每个进程（rank / node）独立运行这段代码。变量矩阵保存邻接矩阵。这是我正在使用的拓扑：

```
 0
             /    \
           1       2
       / /  | \   /  \
      3  4  5  6 7    8
        / \           |
       9  10          11 
```

邻接矩阵：（如节点 3 所见，其中一个不会停止）；

```
1 1 1 0 0 0 0 0 0 0 0 0 
1 0 0 1 1 1 1 0 0 0 0 0 
1 0 0 0 0 0 0 1 1 0 0 0 
0 1 0 0 0 0 0 0 0 0 0 0 
0 1 0 0 0 0 0 0 0 1 1 0 
0 1 0 0 0 0 0 0 0 0 0 0 
0 1 0 0 0 0 0 0 0 0 0 0 
0 0 1 0 0 0 0 0 0 0 0 0 
0 0 1 0 0 0 0 0 0 0 0 1 
0 0 0 0 1 0 0 0 0 0 0 0 
0 0 0 0 1 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 1 0 0 0 
```

到目前为止我的代码：

```
int isFull(int *d, int size) {
    int i;

    for(i = 0; i < size; i++) {
        if(d[i] == INF) {
            return -1;
        }
    }
    return 1;
}
int vecSize(int *d, int size) {
    int counter = 0;
    int i;
    for(i = 0; i < size; i++) {
        if(d[i] != INF) {
            counter++;
        }
    }
    return counter;
}
bool List_contains(std::list<int > l, int val) {
    for (std::list<int>::const_iterator iterator = l.begin(), end = l.end(); iterator != end; ++iterator) {
        if (*iterator == val) {
            return true;
        }
    }
    return false;
}
int minimum (int a, int b) {
    if (a < b) {
        return a;
    }
    return b;
}
/* matrix is the complete adjacency matrix */

/* starting routing calculations
 *
 */
std::list <int > visited;
int *dist;
dist = (int*) calloc(size, sizeof(int));
visited.push_back(rank);

//debug
//printf("debug not empty %d\n", isFull(dist, size));
for(i = 0; i < size; i++) {
    if(matrix[rank][i] == 1) {
        dist[i] = 1;
    } else {
        dist[i] = INF;
    }
}
dist[rank] = 0;
int min;
while(isFull(dist,size) < 0) {
    if(rank == 3)
        printf("node - %d -debug -- list size %d\n",rank, vecSize(dist, size));
    //get the first node that isn't contained
    for(i = 0; i < size; i++) {
        if (!List_contains(visited, i) && min != rank) {
            min = i;
            break;
        }
    }

    for(i = 0; i < size; i++) {
        if((min >= dist[i]) && (!List_contains(visited, i)) && min != rank) {
            min = i;
        }
    }
    if(rank == 3)
        printf("min = %d\n", min);
    visited.push_back(min);

    for(i = 0; i < size; i++) {
        if((matrix[min][i] == 1) && (!List_contains(visited, i))) {
            dist[i] = minimum (dist[i], dist[min] + matrix[min][i]);
        }
    }
    if(rank == 3)
        //printf("rank %d dist = \n", rank);
    for(i = 0; i < size; i++) {
        if(rank == 3)
            printf("%d ", dist[i]);
    }
    if(rank == 3)
        printf("\n");
}
/*
 * finished routing calculations.
 */ 
```

这将是迄今为止的输出：http: [//pastebin.com/x5wjKkyn](http://pastebin.com/x5wjKkyn)

有人能指出我做错了什么吗？谢谢 ！稍后编辑：从技术上讲，该算法提供了正确的距离，它只是不会停止。（输出仅来自节点 0）

稍后编辑：似乎程序没有停止，因为对于某些节点，算法没有完成。

# clojure - 创建一个 clojure 映射线程宏（ map-> ）

> ID：14248832
> 
> 赞同：3
> 
> 时间：2013-01-10T00:20:10.583
> 
> 标签：clojure

我受到[clojure 的 1.5`cond->`宏的启发。](https://github.com/clojure/clojure/blob/master/changes.md#24-new-threading-macros)

同样，我想创建一个具有相同想法的宏，应用于函数`map`。但是，我不知道从哪里开始。

例如，我找不到`cond->`. （可能是因为还没有发布）

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T01:33:55.720

有`cond->` [https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L6742的来源](https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L6742)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T02:01:24.370

托盘项目人员提供了各种[线程宏](http://palletops.com/thread-expr/autodoc/pallet.thread-expr-api.html)，包括 apply-map-> 看起来很接近，但并不完全符合您的要求。

```
(letfn [(apply-map-
          [arg f arg-coll]
          `(let [arg# ~arg]
             (apply ~f arg#
                    ~@(butlast arg-coll)
                    (apply concat ~(last arg-coll)))))]

  (defmacro apply-map->
    "Apply in a threaded expression.
   e.g.
      (-> :a
        (apply-map-> hash-map 1 {:b 2}))
   => {:a 1 :b 2}"
    [arg f & arg-coll]
    (apply-map- arg f arg-coll)) 
```

也许那里会有足够的例子让你挑选出你需要的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-24T19:30:26.387

如果我理解 - 你想编写一个宏，它需要一个部分函数调用的列表，并且对于每个函数，在开头添加`map`（或`apply map`），并将前一个结果添加到结尾？

虽然这并不能直接回答如何编写该宏，但我想指出您有几个选择。

# 分解出`map`

对于纯函数来说总是如此：

```
(=
  (map g (map f coll))
  (map (comp g f) coll)) 
```

重构后的版本只遍历集合一次，不需要进行中间集合。

这是线程的样子：

```
(=
  (->> coll
       (map f)
       (map g))

  (map #(->> % f g) coll)) 
```

[这是 JS 中的一个具体示例。](https://mostly-adequate.gitbooks.io/mostly-adequate-guide/ch06.html#a-principled-refactor)

# 传感器

[转换器](https://clojure.org/reference/transducers)是在 Clojure 中做这种事情的另一种模式，它不仅仅适用于`map`. 它们是对 reducer 函数的一种抽象。如果在没有集合的情况下调用Clojure 的`map`// `filter`（等），将创建一个转换器。`reduce`您可以将它们链接起来`comp`并在各种上下文中使用它们（懒惰的、渴望的、可观察的，等等）。[Rich Hickey](https://www.youtube.com/watch?v=6mTbuzafcII)关于它们的演讲是一个很好的介绍。

# python - Python - 索引列表中的元素

> ID：14248836
> 
> 赞同：0
> 
> 时间：2013-01-10T00:20:24.953
> 
> 标签：python, arrays, list, object

我是一个新的 Python 程序员，正在尝试一些东西。我想创建一个字符串列表并循环遍历我的列表以检查每个元素的大小，如果大小大于 5，那么我将该字符串更改为大写字符串。我被困在如何访问该元素上。下面是我写的一些代码。先感谢您！

```
lis = ['heeeeellllooo','world','low','higggghhh']
for elem in list:
  if len(lis[elem]) > 5:
    list[elem].upper() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T00:21:56.783

[`list comprehension`](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)与 一起使用[`ternary operator`](http://docs.python.org/2/reference/expressions.html#conditional-expressions)：

```
In [16]: lis = ['heeeeellllooo','world','low','higggghhh']

In [17]: [x.upper() if len(x)>5 else x for x in lis] # this is a new list

Out[17]: ['HEEEEELLLLOOO', 'world', 'low', 'HIGGGGHHH'] 
```

您也可以使用[`enumerate()`](http://docs.python.org/2/library/functions.html#enumerate),`enumerate`返回一个`tuple`完整的第一项是元素的索引，第二项是元素本身。

此方法修改原始列表。

```
In [18]: for index,elem in enumerate(lis):
   ....:     if len(elem)>5:
   ....:         lis[index]=elem.upper()  #access element by index
   ....:         

In [19]: lis
Out[19]: ['HEEEEELLLLOOO', 'world', 'low', 'HIGGGGHHH'] 
```

**[列表是如何实现的？](http://docs.python.org/2/faq/design.html#how-are-lists-implemented)：**

> Python 的列表实际上是可变长度数组，而不是 Lisp 样式的链表。该实现使用对其他对象的连续引用数组，并将指向该数组的指针和数组的长度保存在列表头结构中。
> 
> 这使得索引列表 a[i] 成为一种操作，其成本与列表的大小或索引的值无关。
> 
> 当添加或插入项目时，引用数组的大小会调整。应用了一些巧妙的方法来提高重复追加项目的性能；当数组必须增长时，会分配一些额外的空间，因此接下来的几次不需要实际调整大小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T00:24:05.893

`enumerate`非常有用，如果您想就地更改它。试试这个：

```
for idx, elem in enumerate(lis):
    if len(elem) > 5:
        list[idx] = elem.upper() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:31:00.053

这是使用 for 循环执行您尝试的操作的正确方法。您的代码为列表使用了两个不同的变量名称：lis 和 list。变量 elem 是列表中的项目，而不是索引。要获取索引，您需要使用 enumerate()。Ashwini Chaudhary 展示的解决方案称为列表推导，是一种更好的方法。

```
for i, elem in enumerate(lis):
  if len(elem) > 5:
    lis[i] = elem.upper() 
```

# google-calendar-api - 谷歌日历提要不会导入

> ID：14248839
> 
> 赞同：0
> 
> 时间：2013-01-10T00:20:53.783
> 
> 标签：google-calendar-api, icalendar

我已经在这几个小时了，我似乎无法将此提要导入谷歌日历： [http ://newtest.wpengine.com/programs/?ical=1](http://newtest.wpengine.com/programs/?ical=1)

当我下载它然后将其作为文件导入时，它可以很好地导入。我什至试着只用几行就让它变得光秃秃的。它在这个验证器中获得 100%：http: [//icalvalid.cloudapp.net/](http://icalvalid.cloudapp.net/)。谁能发现我错过了什么。这是文件

```
开始：VCALENDAR
版本：2.0
PRODID:-//蓝曼陀罗静修地
CALSCALE:公历
方法：发布
X-WR-CALNAME:Deryk Wenaus 博客
X-WR-时区：
开始：事件
UID：http://ayahuas.ca/program/sample-program/
DTSTAMP:20130110T001222Z
接触：
描述：一个不​​错的程序。一个不错的程序。
DTSTART；值=日期：20130124
DTEND；值=日期：20130127
地点：
摘要：示例程序
网址：http://ayahuas.ca/program/sample-program/
结束：事件
结束：VCALENDAR

```

我不断从谷歌日历得到的错误是`The address that you provided did not contain a calendar in a valid iCal or GData format.`

我`header( 'Content-type: text/calendar; charset=UTF-8' );`用作标题，我也试过`header( 'Content-Disposition: inline; filename="calendar.ics"' );`没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T08:04:13.990

Google 日历使用 GoogleBot 请求您网站上的日历信息。也许您的服务器正在阻止 GoogleBot 输入 ICal URL。检查您的 robots.txt

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T17:54:10.487

这很可能是因为您指定了一个不指向您的 ics 文件本身的 URL 属性值。

没有 URL 属性的相同 icalendar 文件应该可以工作（我尝试通过文件而不是 url 将您的 icalendar 文件上传到谷歌日历中，它可以工作，但它继续尝试加载日历，当删除 URL 属性时它消失了）。

# ruby-on-rails-3 - 为什么我需要在 rails 3 控制器路由中指定控制器？

> ID：14248845
> 
> 赞同：0
> 
> 时间：2013-01-10T00:21:28.153
> 
> 标签：ruby-on-rails-3, routing, controller

以下路线有效：

```
controller :foo do 
    get 'bar/:baz' => "foo#bar"
end 
```

但是这个

```
controller :foo do 
    get 'bar/:baz'
end 
```

会抛出`missing :action`

为什么它没有检测到动作并默认使用“foo”控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:20:59.027

路由找到控制器并在找到时呈现视图。该部分`=> "foo#bar"`对应于“转到控制器`foo`和渲染视图`bar.html.erb`”。

我还没有测试我的陈述，但今晚晚些时候会这样做。

# php - 使用 foreach 以对象为值创建关联数组

> ID：14248847
> 
> 赞同：1
> 
> 时间：2013-01-10T00:21:31.650
> 
> 标签：php, foreach, xml-rpc, associative-array

我正在使用 XMLRPC 构建一个 XML 结构，将产品信息传递给第三方系统。我需要构建一个产品自定义选项的关联数组，并且我不知道在每种情况下使用什么语法，因为值是一个对象。

我无法像往常一样调试和使用它我已经将它应用到站点，XMLRPC 抛出一个错误，说它无法序列化我构建的对象，然后我很快又将它切换回来。

如果我像这样对其进行硬编码，它可以正常工作。

```
 $item_array = array(
       "product_id" => new xmlrpcval($item->getSku()),
       "name" => new xmlrpcval($item->getName()),
       "price" => new xmlrpcval($item->getBaseCalculationPrice(), 'double'),
       "vat_inclusive" => new xmlrpcval(0,'int'),
       "quantity" => new xmlrpcval($item->getQty(),'int'),
       "option_text" => new xmlrpcval(
           array(
              "option_1" => new xmlrpcval("Colour: Military Black"),
              "option_2" => new xmlrpcval("Sizes: L")
           ),
           "struct")                          
        ); 
```

这是我需要生成的以下部分，特别是 foreach 循环中的数组，因为我不知道会有多少选项；

```
 "option_text" => new xmlrpcval(
           array(
              "option_1" => new xmlrpcval("Colour: Military Black"),
              "option_2" => new xmlrpcval("Sizes: L")
           ),
           "struct") 
```

如果我像下面那样做，那么结果很好，但是值是一个字符串而不是一个对象，XMLRPC 不能序列化；

```
 $optioncount = 1;
      $attList = array();

      foreach ( $attributes as $attribute => $value ) {

          $attpair = implode(": ", $value);

          $attList['option_'. $optioncount] = 'new xmlrpcval("'.$attpair.'")';

          $optioncount++;

      } 
```

如果`var_dump($attList)`我得到；

```
array(2) {
  ["option_1"]=>
  string(39) "new xmlrpcval("Colour: Military Black")"
  ["option_2"]=>
  string(25) "new xmlrpcval("Sizes: L")"
} 
```

任何其他方式似乎都会变成`$attList`一团糟——我知道这应该是非常基本的，但对于我的生活，我无法让它发挥作用。感谢您的任何指示。

如果我`var_dump($attList)`在使用时`new xmlrpcval($attpair);`得到；

```
array(2) {
  ["option_1"]=>
  object(xmlrpcval)#469 (3) {
    ["me"]=>
    array(1) {
      ["string"]=>
      string(22) "Colour: Military Black"
    }
    ["mytype"]=>
    int(1)
    ["_php_class"]=>
    NULL
  }
  ["option_2"]=>
  object(xmlrpcval)#433 (3) {
    ["me"]=>
    array(1) {
      ["string"]=>
      string(8) "Sizes: L"
    }
    ["mytype"]=>
    int(1)
    ["_php_class"]=>
    NULL
 } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:04:15.183

构建您的阵列必须如下所示：

```
 $optioncount = 1;
  $attList = array();

  foreach ( $attributes as $attribute => $value ) {

      $attpair = implode(": ", $value);

      $attList['option_'. $optioncount] = new xmlrpcval($attpair);

      $optioncount++;

  } 
```

进而：

```
"option_text" => new xmlrpcval(
       $attList,
       "struct") 
```

# c - 扩展名为“h.in”的文件是什么意思？

> ID：14248848
> 
> 赞同：47
> 
> 时间：2013-01-10T00:21:33.037
> 
> 标签：c, header-files

我正在学习 C 语言，我看到了一个我以前没有见过的新扩展。

扩展名为 like 的文件`library.h.in`是什么意思？

它是带有扩展名“.h”的简单标题吗？有什么不同？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-10T00:30:07.557

这些文件通常是[autoconf](http://www.gnu.org/software/autoconf/manual/autoconf.html)的输入，它将生成最终的 .h 文件。

这是PCRE的一个例子：

```
#define PCRE_MAJOR          @PCRE_MAJOR@
#define PCRE_MINOR          @PCRE_MINOR@
#define PCRE_PRERELEASE     @PCRE_PRERELEASE@
#define PCRE_DATE           @PCRE_DATE@ 
```

Autoconf 会将所有变量 ( `@…@`) 替换为相应的值，结果将是一个 .h 文件。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-10T00:24:38.243

通常，`.h.in`文件是标题模板，由`configure`脚本根据目标平台上存在的功能的多次测试结果填充成为实际标题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-10T00:25:15.357

以 .in 结尾的文件通常是一个被调用的程序使用的模板文件，该程序`configure`在替换变量扩展后生成一个没有扩展名的新文件。即，如果您正在查看具有被调用文件的源树，例如`Makefile.in`在树中，那么`./configure`将生成一个可用的 Makefile，该 Makefile 可用于从源“制作”。

# jquery-mobile - 如何垂直居中对齐以及标题和单选按钮

> ID：14248852
> 
> 赞同：0
> 
> 时间：2013-01-10T00:22:15.650
> 
> 标签：jquery-mobile, radio-button

我正在尝试为我要组合的应用程序制作一个简单的个人资料页面。

它有 4 个问题，最后一个是`Gender`。

其他三个问题与“字段容器文本输入”配合得很好，但我想对性别问题使用单选按钮。

当我尝试将`Male/Female`按钮与`Gender`标题对齐时，它们总是太靠近而不与标题对齐。

我想要实现的是让按钮与`Gender`其他三个部分内联并保持相同的距离。

这是我到目前为止所拥有的：

```
<div data-role="content">
    <div data-role="fieldcontain">
       <label for="height" style="font-size:25px"><strong>Height</strong></label>
       <input style="display: inline-block;  width: 5%" type="text" name="name" id="height" value="" />
       <p style="display: inline-block; margin-left:5px; margin-right:10px"> feet   </p>
       <input style="display: inline-block;  width: 5%" type="text" name="name" id="height" value="" />
       <p style="display: inline-block; margin-left:5px; margin-right:10px"> inches OR   </p>
       <input style="display: inline-block;  width: 5%" type="text" name="name" id="height" value="" />
       <p style="display: inline-block; margin-left:5px"> cm</p>
    </div>
    <div data-role="fieldcontain">
       <label for="height" style="font-size:25px"><strong>Height</strong></label>
       <input style="display: inline-block;  width: 5%" type="text" name="name" id="height" value="" />
       <p style="display: inline-block; margin-left:5px; margin-right:10px"> pounds OR   </p>
       <input style="display: inline-block;  width: 5%" type="text" name="name" id="height" value="" />
       <p style="display: inline-block; margin-left:5px"> kg</p>
    </div>
    <div data-role="fieldcontain">
       <label for="age" style="font-size:25px"><strong>Age</strong></label>
       <input style="width: 5%" type="text" name="name" id="age" value="" />
    </div>
    <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
       <div style="display:inline !important;">
          <label style="font-size:25px"><strong>Gender</strong></label>
       </div>
       <div style="display:inline-block !important; float:right !important;">
          <input type="radio" name="radio-choice" id="male" value="choice-1" />
          <label for="male">Male</label>
          <input type="radio" name="radio-choice" id="female" value="choice-2" />
          <label for="female">Female</label>
       </div>
    </fieldset>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:47:20.237

将 Gender 字段组的标记更改为以下内容：

```
<div data-role="fieldcontain">
    <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
        <legend><strong style="font-size:25px">Gender</strong></legend>
        <input type="radio" name="radio-choice" id="male" value="choice-1" checked="checked" />
        <label for="male">Male</label>
        <input type="radio" name="radio-choice" id="female" value="choice-2" />
        <label for="female">Female</label>
    </fieldset>
</div> 
```

# php - 排列 JOIN 数据库结果

> ID：14248855
> 
> 赞同：1
> 
> 时间：2013-01-10T00:22:50.103
> 
> 标签：php, mysql, codeigniter

我目前正在从我的“social_posts”表中获取详细信息，然后添加它的标签、喜欢的数量以及它对结果对象的答案数量。有没有一种方法可以做到这一点而不必在循环中进行额外的查询？

```
 $query = "SELECT * FROM social_posts JOIN users ON social_posts.user_id = users.id";
    $posts = $this->db->query($query);

    if ($posts->num_rows() > 0) {        
        foreach ($posts->result() as $p => $post) {                     
            // Get the question's tags
            $tags = $this->db->query("SELECT * FROM social_tags 
                WHERE post_id = ?", $post->post_id);

            // Get the number of likes
            $likes = $this->db->query("SELECT id FROM social_likes 
                WHERE post_id = ?", $post->post_id);

            // Get the number of answers
            $answers = $this->db->query("SELECT id FROM social_responses 
                WHERE post_id = ?", $post->post_id);

            $post->tags = $tags->result();
            $post->likes = $likes->num_rows();
            $post->answers = $answers->num_rows();
            $post->author = array(
                "firstname" => $post->firstname,
                "thumbnail" => $post->thumbnail,
            );
        }

        return $posts->result();
    } else {
        return FALSE;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:49:45.397

你可以试试这个 SQL：

```
SELECT 
    social_posts.*,
    users.*,
    GROUP_CONCAT(social_tags.name) AS tags,
    COUNT(social_likes.id) AS likes,
    COUNT(social_responses.id) AS answers
FROM 
    social_posts 
        JOIN users ON social_posts.user_id = users.id
        LEFT JOIN social_tags ON social_tags.post_id = social_posts.id
        LEFT JOIN social_likes ON social_likes.post_id = social_posts.id
        LEFT JOIN social_responses ON social_responses.post_id = social_posts.id
GROUP BY
    social_posts.id 
```

您将获得以逗号分隔的字符串形式的标签。当然，您需要调整列名以适合您的数据库。

# php - 是否可以为单个页面更改 php.ini 中允许的内存？

> ID：14248860
> 
> 赞同：1
> 
> 时间：2013-01-10T00:23:10.843
> 
> 标签：php, apache, drupal

有没有办法为单个页面设置允许的内存？我不想在请求时允许其他页面超过 128m，但是如果我将 php.ini 中允许的内存大小设置为 128m 或更低，那么有一个页面会给我一个 500 错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:36:24.427

```
ini_set('memory_limit','16M'); 
```

[http://php.net/manual/en/function.ini-set.php](http://php.net/manual/en/function.ini-set.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T19:33:18.273

更好地检查使用配置为您完成的这个模块：http: [//drupal.org/project/path_memory](http://drupal.org/project/path_memory)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T00:36:45.910

为另一个页面创建第二个 php.ini 文件。并在您的 apache 配置中创建一个规则，以将该 ini 文件仅用于该页面请求

# php - 为 PHP 数组创建一个循环

> ID：14248862
> 
> 赞同：-1
> 
> 时间：2013-01-10T00:23:19.813
> 
> 标签：php, arrays, foreach, file-get-contents

假设我有一个 url 数组，我需要让文件获取数组上每个项目的内容我该怎么做？

```
$url = "http://seetelkol.com/forum/forum-46/";

$subject=  file_get_contents($url);
$subject=   preg_match_all('%<a class="title" href="http://seetelkol.com/forum/thread-(.*?)/" id="thread_title_(.*?)>%', $subject, $result, PREG_PATTERN_ORDER);
$result = $result[0];
$patterns = implode('|', $result);

$patterns = preg_match_all('%http://seetelkol.com/forum/thread-[0-9]{0,9}/%', $patterns, $new, PREG_PATTERN_ORDER);
print_r($new); 
```

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:13:05.860

*   首先，没有必要使用 2 preg_match_all

*   在正则表达式中，您需要对文字字符**\ 进行转义。**

*   最后，你必须使用标志“ **s** ”

尝试

```
<?php 

  $url  = 'http://seetelkol.com/forum/forum-46/';
  $subject = file_get_contents($url);

  preg_match_all('#<a class="title" href="http:\/\/seetelkol\.com/forum/thread\-([0-9]+)\/" id="thread_title_(?:[0-9]+)">#s', $subject, $result);

  print_r($result); 

 ?> 
```

# java - 我的 GPS 提醒一直要求我启用 GPS

> ID：14248864
> 
> 赞同：0
> 
> 时间：2013-01-10T00:23:30.237
> 
> 标签：java, android, google-maps, gps

我在我的应用程序中提供了 GPS 提醒，但是当我启用我的 gps 并返回我的 mainactivty 时，我的 gps 提醒再次询问我，当我按下 googlemaps 按钮时再次询问。它仅在我关闭程序并重新启动应用程序时才有效

这是我的 MainActivityClass。

```
GPSTracker gps;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    gps = new GPSTracker(MainActivity.this);
} 
```

我的 googlemaps 按钮。

```
public void googlemaps(View view) {
    if (gps.canGetLocation()) {
        Intent intent = new Intent(this, GoogleMaps.class);
        startActivity(intent);
    } else {
        gps.showSettingsAlert();
    }
} 
```

这是我的 GPS 追踪器课程

```
public class GPSTracker extends Service implements LocationListener {

private final Context mContext;

// flag for GPS status
boolean isGPSEnabled = false;

// flag for GPS status
boolean canGetLocation = false;

Location location; // location

public LocationManager locationManager;

public GPSTracker(Context context) {
    this.mContext = context;
    getLocation();
}

public Location getLocation() {
    try {
        locationManager = (LocationManager) this
                .getSystemService(Context.LOCATION_SERVICE);

        // getting GPS status
        isGPSEnabled = locationManager
                .isProviderEnabled(LocationManager.GPS_PROVIDER);

        if (!isGPSEnabled) {
        } else {
            this.canGetLocation = true;

            // if GPS Enabled get lat/long using GPS Services
            if (isGPSEnabled) {
                if (location == null) {
                    locationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER, 10, 2000, this);

                    Log.d("GPS Enabled", "GPS Enabled");
                    if (locationManager != null) {
                    }
                }
            }
        }

    } catch (Exception e) {
        e.printStackTrace();
    }

    return location;
}

/**
 * Function to show settings alert dialog On pressing Settings button will
 * lauch Settings Options
 * */
public void showSettingsAlert() {
    AlertDialog.Builder alertDialog = new AlertDialog.Builder(mContext);

    // Setting Dialog Title
    alertDialog.setTitle("GPS is settings");

    // Setting Dialog Message
    alertDialog
            .setMessage("GPS is not enabled. Do you want to go to settings menu?");

    // On pressing Settings button
    alertDialog.setPositiveButton("Settings",
            new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    Intent intent = new Intent(
                            Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                    mContext.startActivity(intent);
                }
            });

    // on pressing cancel button
    alertDialog.setNegativeButton("Cancel",
            new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    dialog.cancel();
                }
            });

    // Showing Alert Message
    alertDialog.show();
}

@Override
public void onLocationChanged(Location loc) {
}

@Override
public void onProviderDisabled(String provider) {
}

@Override
public void onProviderEnabled(String provider) {
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
}

@Override
public IBinder onBind(Intent arg0) {
    return null;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:29:29.027

显示对话框后，您需要重新测试 GPS 是否已启用。从它的外观来看，您`canGetLocation`在创建类时设置了一次变量（通过调用`getLocation()`。添加对“getLocation（）`in`onResume（）”的调用应该可以解决您的问题。我建议您打破逻辑以查看GPS被启用到它自己的方法中。

# c++ - Qt QVBoxLayout 的 addStretch strech 占用了太多空间（来自布局）

> ID：14248865
> 
> 赞同：1
> 
> 时间：2013-01-10T00:23:30.430
> 
> 标签：c++, python, qt, pyqt, pyside

我有一个 QVBoxLayout，它有一个 QSCrollArea 并在其末尾添加了 addStretch()。

此处的 QScrollArea 仅使用一半可用空间，尽管下方有可用空间，当前由 addStretch 占用。

如果 QScrollArea 的内容足够大，我希望 QScrollArea 扩展到所有可用空间。当 QScrollArea 的内容较小时，我希望 QScrollArea 缩小到那个大小，其余的可用空间由 addStetch 使用。

但是，目前，对于小的 QScrollArea 这有效，但是当 QScrollArea 的内容较大时，它只会扩展到可用空间的一半。

我尝试为 QScrollArea 和底层滚动小部件设置各种大小策略，但没有任何效果。

得到这个排序的诀窍是什么？

这是我的代码片段[在 Python 中，但非常欢迎使用 C++ 中的答案]：

```
# My setup
self.layout = QVBoxLayout()
self.setLayout(self.layout)

scrollArea = QScrollArea()
self.layout.addWidget(scrollArea)
scrollArea.setWidgetResizable(True)
scrollArea.setEnabled(True) 

self.scrollWidget = QWidget()
self.scrollLayout = QVBoxLayout()
self.scrollWidget.setLayout(self.scrollLayout)

scrollArea.setWidget(self.scrollWidget)

# Now what I do is, I add bunch of widgets inside the self.scrollLayout
# and in the end, I perform a self.layout.addStretch() to push them up (verticle Alignment does same)
# Maximum height QScrollArea (scrollArea) gets is stuck at around 50% although I want to take all the space if necessary 
```

我添加了所有可能的 setSizePolicy(..) 选项

```
scrollArea.setSizePolicy(QSizePolicy(QSizePolicy.Expanding, QSizePolicy.Expanding))
# and ALL others. None works. addStretch() still takes 50% minimum space and gets even more if QScrollArea's contents are smaller. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:32:06.807

我找到了解决方案。有必要覆盖 sizeHint 以保持滚动区域的滚动小部件。有必要为滚动小部件设置最大高度。并且有必要将此小部件放在 QVBoxLayout 中，并使用 addStretch() 将其推到顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T23:06:57.000

我只是遇到了同样的问题，我想我找到了解决方案。不要在 QScrollArea 之后添加拉伸，而是作为 QScrollArea 布局内的最后一个元素。因此，在您的代码中，使用`self.scrollLayout.addStretch()`而不是`self.layout.addStretch()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T06:20:49.310

> 当 QScrollArea 的内容较小时，我希望 QScrollArea 缩小到那个大小，其余的可用空间由 addStetch 使用。

如果 QScrollArea 的内容很小，可以将它们对齐到顶部并隐藏垂直滚动条。在这种情况下，您不需要向主垂直布局添加拉伸。

如果内容大于 QScrollArea，它将占用所有可用空间。

我想，这就是你需要的。

# php - 收到致命错误消息

> ID：14248867
> 
> 赞同：0
> 
> 时间：2013-01-10T00:23:36.693
> 
> 标签：php, mysqli

我在第二页上收到以下消息，但没有任何效果...

`Fatal error: Call to a member function fetch_assoc() on a non-object in C:\xampp\htdocs\send.php on line 6`

这是我显示电子邮件地址的第一页，它工作得很好，但是当我点击电子邮件并转到 info.php 时，我得到了那个错误.. 出了什么问题？

```
 <?php
 $mydb = new mysqli('localhost', 'root', '', 'database');
 $sql = "SELECT * FROM test ";
 $result = $mydb->query($sql);

 while( $row = $result->fetch_assoc() ){

 echo '<td><a href="info.php?email='.$row['Email'].'">'.$row['Email'].'</a>    </td>';

 echo "<br/>";
 }
 $mydb->close ();

 ?> 
```

这是info.php ..请记住，我正在尝试显示我在数据库的同一个表中拥有的单个用户的行年龄和姓名..

```
<?php
$mydb = new mysqli('localhost', 'root', '', 'database');
$sql = "SELECT * FROM User WHERE id = " . $_GET['email'];
$result = $mydb->query($sql);

while( $row = $result->fetch_assoc() ){
echo $row['Age'] . " " . $row['Name'] ;
echo "<br/>";
}
$mydb->close (); 
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:27:52.100

这意味着您的查询没有正确运行。你应该检查：

```
if (!$result) {
    echo $mydb->error;
}

die(); 
```

[准备好的报表](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)

您应该使用它们，因为您正在接受用户输入。准备好的语句提供了很好的清理输入，因此用户不会弄乱您的数据库。

看起来您有一个电子邮件列，但正在尝试根据以下内容选择用户：

id = 电子邮件。

将 id 设置为 INT 是一种常见做法，而 email 可能是 VARCHAR，因此这种比较没有意义（如果您的表架构遵循常见做法）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:29:27.773

查询失败，因为您没有在电子邮件地址周围加上引号。

```
$sql = "SELECT * FROM User WHERE id = '" . $_GET['email'] . "'"; 
```

# asp.net - 在 Visual Studio 中工作时，可以省略元素的“asp:”部分吗？

> ID：14248868
> 
> 赞同：0
> 
> 时间：2013-01-10T00:23:53.833
> 
> 标签：asp.net, web-applications, web-development-server

**情况：**我已经使用 Sublime 2 文本编辑器在 HTML5/CSS3 和 Javascript 中创建网页一年了，但是现在大学课程要求我使用 Asp.Net 和 Visual Studio 2010。我不使用设计器，因为我精通手工操作，但是我发现在每个元素中编写**asp:**非常耗时，并且在应用于某些 HTML 5 标记而不是其他标记时会导致语法错误。

示例 HTML 5： `<button id="btn" type="submit" value="Button"/>`

示例 Asp.net： `<asp:Button ID="Button1" runat="server" Text="Button" />`

**问题：**可以省略 asp: 部分而不影响任何内容，还是 IIS 或 C# 后端功能需要它？那 runat="server" 可以省略吗？谷歌已经对我的询问提出了质疑，因此我们不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:58:06.087

您根本无法删除两者中的任何一个，但请听我解释原因，因为我感觉您不熟悉 ASP，因此误解了 the`asp:`和`runat="server"`语法的含义。

first：`runat="server"` 一个元素上的这个属性，告诉编译器这实际上是一个服务端控件所以a`<button/>`和an不一样`<button runat="server"/>` 第一个是纯html，而第二个是控件，可以绑定到服务器端。.Net 会给它一个 clientID（不要被你自己给它的 ID 弄错了）。

第二：`asp:` 这是某些元素上的前缀，它告诉编译器这些是 ASP 控件（由 ASP.net 框架提供的默认控件）。其中包括 Buttons、TextBoxes、DropDownLists ……不要将其中 1 个与 html 元素混淆。

an`<asp:Button id="myAspButton" runat="server"/>` 与 a 不同`<button id="myHtmlButton"/>`

第一个是服务器端控件，可以绑定到（查看它的属性），并且该控件作为示例`runat="server"`呈现给浏览器。`<input type="submit"/>`

如果您愿意，您可以更改 asp.net 按钮类的呈现，使其返回完全不同的内容。

而且您也不仅限于使用 asp.net 类。您可以创建自己的控件，并将它们放入自定义创建的库中，您可以给这些控件添加自己的前缀。

如果我创建了这样一个自定义控件，我可以在 web.config 文件中为它注册一个前缀，因此我可以创建一个从原始按钮扩展的自定义按钮（但前面有一个默认标签......

```
<myc:CustomButton ID="myButton" Text="myButton" Label="myLabel" runat="server"/> 
```

这可以呈现为：

```
<label>myLabel</label>
<button ID="*******">myButton</button> 
```

星号表示它将从 .net 框架中获得的唯一 ID

如果您想了解有关自定义控件或扩展默认控件的更多信息，这里是创建自定义控件或从 TextBox 控件扩展的分步说明。它还显示了如何为控件添加自定义前缀（在本例中为“cc”） [，您可以在此处找到更多信息](http://www.beansoftware.com/ASP.NET-Tutorials/Custom-Server-Controls.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:35:50.793

该`runat="server"`部件需要告诉 .NET 它必须在那里呈现一个按钮（其中将包含 .NET 特定的 ID，以便在 POST 时进行处理）。不太熟悉 Web 表单（我从 MVC 开始），但我认为这`asp:`部分是为了帮助区分服务器控件和标准 HTML 标记。

为什么不尝试删除它，如果它破坏了某些东西，那么您就知道它是必需的。例如，如果按钮在删除后没有显示，那么显然 .NET 标记解析器需要它在那里才能知道它是服务器控件的占位符。

# css - 无法让页脚占据屏幕的其余部分

> ID：14248873
> 
> 赞同：0
> 
> 时间：2013-01-10T00:24:20.137
> 
> 标签：css, twitter-bootstrap

我正在使用引导程序，没有任何修改。布局非常简单。我有一个顶部导航栏。然后是主容器。最后，我有一个页脚。就像是：

```
<head>
 <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
    background-color: #ECECEC;
      }
 </style>
</head>

<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
    // navbar elements
    </div> <!-- end of class navbar -->

    <div class="container">
    // fluid-row class with two column structure
    </div> <!-- end of class container -->

    <div class="footer">
        <div class="container"> <!-- using container to left-align footer to the main content -->
        // some content
     </div> <!-- end of class footer -->
</body> 
```

有两件事不能做。

1）每当主容器类中的内容较少时，我需要在屏幕底部对齐页脚。我试过 min-height:100% 但做错了什么。

2）我需要页脚有不同的背景颜色，一旦主容器结束，页脚应该占据屏幕的其余部分。页脚可以有一个最小高度，也可以根据页脚内的内容采用高度。

```
.footer {
height:80px;
margin-top:-80px;
position:relative;
clear:both;
padding-top:20px;
background-color:#F4F4F4;
border-top:1px solid #ddd;
clear:both;
} 
```

这里发生了什么？

JSfiddle：http: [//jsfiddle.net/m7dkt/13/](http://jsfiddle.net/m7dkt/13/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:38:23.970

这应该为您解决问题：http: [//jsfiddle.net/panchroma/ru2BD/](http://jsfiddle.net/panchroma/ru2BD/)

不要试图弄清楚如何为页脚着色并将其扩展到页面底部，而是将正文颜色设置为页脚颜色所需的颜色，然后为页眉和页脚之间的内容区域着色。

```
body {
background-color: #F4F4F4; /*same as footer color */
}

/* don't need to explicitly set footer colour now, it's set above */  

/* .footer {
background-color:#F4F4F4;   
}   */  

/* wrap page content and set the background colour */  

#wrapper{       
padding-top:10px;
background-color:#ECECEC;
} 
```

**更新**

如果我理解正确，您还希望页脚文本与窗口底部对齐。看看这看起来如何：http:
[//jsfiddle.net/panchroma/D7YXP/](http://jsfiddle.net/panchroma/D7YXP/)

它是上述技术与粘性页脚的组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T06:28:56.213

尝试将以下 css 添加到您的 css 中：

```
html, body, #wrapper{
    height:100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T06:17:07.773

我使用了这个技巧：我希望它对你有用。

HTML

```
<div id="wrap">
   <div id="clearfooter"></div>
</div>
<div id="footer">
</div> 
```

CSS

```
#clearfooter {
    display: block;
    height: 50px;
}

#wrap{
    padding-bottom:69px;
    overflow:hidden;
}

#footer{
    width:100%;
    height:69px;
    background:#8dc63f;
    overflow:hidden;
    clear:both;
    color:#FFF;
    position:fixed;
    bottom:0;
    opacity:0.9;
} 
```

# android - 从系统托盘获取所有现有通知

> ID：14248879
> 
> 赞同：2
> 
> 时间：2013-01-10T00:25:15.047
> 
> 标签：android, notifications, push-notification

我是否可以从当前位于系统托盘中的应用程序中获取所有通知？我注意到我们可以更新托盘中已经存在的现有通知，但我想知道我是否可以检索所有通知。 [http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Updating](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Updating)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T12:51:56.957

简短的回答是“否”，通知管理器不提供查询当前托盘中通知的方法。

如果您想跟踪托盘中*的*通知，这是可能的，但需要一些工作。您将需要创建一种方法来跟踪通知的状态，最简单的方法可能是数据库。您所做的是在创建通知时为通知插入一行，并带有该通知的 id。接下来，您需要构建一个*Activity*或*Service*，它将在其生命周期内使用通知状态更新您的数据库。在向经理发布通知之前，您需要添加一个**contentIntent**和一个**deleteIntent**来通过您刚刚创建的*Activity*或*Service进行路由。*这**contentIntent**会在用户点击通知时被调用，而**deleteIntent**会在用户关闭它时被调用。当其中任何一个发生时，更新您的数据库以跟踪最新状态！

如果你实现了这一点，你将有一种方法来跟踪*你的*通知，以及它们在托盘中的状态。不幸的是，没有简单、现成的方法来查询它们，特别是如果它们不是您创造的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-28T17:56:26.363

试试这个 NotificationListenerService：

[https://developer.android.com/reference/android/service/notification/NotificationListenerService](https://developer.android.com/reference/android/service/notification/NotificationListenerService)

# javascript - JS执行时间

> ID：14248880
> 
> 赞同：1
> 
> 时间：2013-01-10T00:25:16.207
> 
> 标签：javascript, performance, debugging, profiling, execution-time

我的网站是一个非常标准的电子商务网站，它不是一个 JS 支持的独立应用程序或任何东西，它只是一个使用 JS 来做标准东西的网站，以及一些 jquery 插件来做一些事情。

我使用 Chrome 开发工具获取了一些 CPU 配置文件。

我的大部分功能都是低调操作，不超过200ms。

我应该瞄准什么好的基准？200ms 高吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:34:55.057

200 毫秒还不错，但您应该尽量将 JavaScript 交互控制在 100 毫秒以下。浏览器 UI 只有一个线程来更新 UI 和执行 JavaScript（一次只能发生一次）。因此，您的 JavaScript 运行时间越长，用户体验就越差。

**0.1 秒**大约是让用户感觉到系统在瞬间做出反应的极限，这意味着除了显示结果之外不需要特殊的反馈。

**1.0 秒**大约是用户思维流保持不间断的极限，即使用户会注意到延迟。正常情况下，在大于 0.1 秒小于 1.0 秒的延迟期间不需要特殊的反馈，但用户确实会失去直接对数据进行操作的感觉。

**10 秒**大约是让用户的注意力集中在对话上的极限。对于较长的延迟，用户将希望在等待计算机完成时执行其他任务，因此应向他们提供反馈，指示计算机预计何时完成。如果响应时间可能变化很大，则延迟期间的反馈尤其重要，因为用户将不知道会发生什么。

——雅各布·尼尔森

有几种模式可以将需要完成的工作分成块，这样您就不会遇到可怕的“无响应脚本”错误。例如使用计时器或网络工作者等，但实现取决于您的代码需要做什么。您正在使用开发工具进行正确的跟踪，以深入了解正在发生的事情！

# mysql - MYSQL 函数

> ID：14248882
> 
> 赞同：1
> 
> 时间：2013-01-10T00:25:18.893
> 
> 标签：mysql, sql, select

我有一张由`podcasts`我*做过*的表格、*歌曲*、*艺术家*、*标题混合编号日期*等组成的*表格*。我正在使用具有单独方法的类来单独显示它们

我的问题是，你如何得到`desc`行？像这样*`(mix_number is an int)`*

```
 select mix_name, date where mix_number = MAX(mix_number) limit 1 //1st query

 select mix_name, date where mix_number = MAX(mix_number - 1)//this would be the second query

 select mix_name, date where mix_number = MAX(mix_number - 2)//3rd query 
```

我不想`where clause`用数字硬编码，因为我希望它随着我添加更多而更新。

我真的在问是*`MAX(mix_number)`*还是*`MAX(mix_number-1)`*适当的？我不能让它以这种方式工作

我希望这是可以理解的。我在方法中有其他疑问，但这里的答案也会解决它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:26:53.350

```
select mix_name, date 
FROM tableName
where mix_number = (SELECT MAX(mix_number) FROM tableName)
LIMIT 1 
```

或者

```
select mix_name, date 
FROM tableName
where mix_number = (SELECT MAX(mix_number) FROM tableName) - 1
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:34:49.593

第一个查询：

```
SELECT mix_name, date
FROM table
ORDER BY mix_number DESC
LIMIT 1, 0 
```

第二个查询：

```
SELECT mix_name, date
FROM table
ORDER BY mix_number DESC
LIMIT 1, 1 
```

如果您想要来自同一查询的所有行：

```
SELECT mix_name, date
FROM table
ORDER BY mix_number DESC 
```

如果您想更精确地对具有相同 mix_number 的行进行排序：

```
SELECT mix_name, date
FROM table
ORDER BY mix_number DESC, date DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T00:37:26.657

你需要一个`ORDER BY`子句。

```
select mix_name, date order by mix_number desc 
```

添加`LIMIT 0, 1`将是您的第一个查询。`LIMIT 1, 1`将是第二个。等等

# ios - 有没有办法提取媒体库中音频文件的文件路径？

> ID：14248890
> 
> 赞同：3
> 
> 时间：2013-01-10T00:26:22.230
> 
> 标签：ios, audio

我正在开发适用于 iOS 的音乐播放器，我想知道是否有办法提取 iOS 上 iPod/媒体库中音频文件的文件路径。我已经阅读了多篇文章，您似乎只能提取一个只能与 AV 框架播放器一起使用的 URL。

那么能否提取媒体库中音频文件的文件名，并使用外部音频库播放这些文件？

谢谢！

# php - 尽可能低的预期 HTTPS 延迟？

> ID：14248891
> 
> 赞同：1
> 
> 时间：2013-01-10T00:26:25.377
> 
> 标签：php, mysql, linux, https, low-latency

在我的网站上，对于特定的 AJAX 文件（UI 的症结），我的平均延迟（不备份时等）约为 150 毫秒。我通过做一些服务器端/数据库技巧将它从 ~250ms 减少了，我认为最后一个技巧可能会将它从当前的 ~30ms 的实际 PHP/MySQL 部分的总数中再降低 10ms 左右页。

我正在使用 keep-alive，所以我认为 ssl 握手或多或少已经完全退出（但我希望尽快迁移到 SPDY，所以我真的不知道在最初的握手之后这有什么帮助）。

当我 ping 时，它平均约为 55 毫秒。

我在文件的开头连接到 MySQL，并在最后关闭它。我很确定这大约需要 10 毫秒。

那么剩下的~55ms 是从哪里来的呢？

这可能看起来完全令人着迷，但这是为了快速动态分页，并且每毫秒延迟都会严重降低效果。

提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T12:33:49.310

如果您建立了 HTTP 连接，您应该能够在与 ping 大约相同的时间内运行单个简单、简短的 HTTP 请求。

为了测试这一点，计算获取静态文件需要多长时间。

接下来，尝试从不使用任何库的 PHP 页面获取一小块数据。

接下来，尝试在不更改输出的情况下添加您的需求和库。这可能很重要，例如使用 Zend 和它的一些包很容易用 xcache 和通常快速的系统花费 40 毫秒。您可能想要更改 PHP 的运行方式，例如 apache prefork mod_php 必须启动一个新进程，而 php 必须为每个请求加载库。如果切换到 fastcgi，则可以预加载所需的库，提前打开数据库连接，并从感知延迟中消除相应的时间成本。

接下来，添加一些数据库查询。

下次升级到 AJAX。

现在 AJAX 通常会发出一个 POST 请求，在 HTTP 1.1 中这意味着 Expect: 100-continue 标头并增加一个往返行程。尝试禁用该标题。

最后，记录您的查询和响应，并尝试删除您不需要的所有内容。理想情况下，您希望每个请求和响应都低于 1K，但如果您的连接保持活动状态，tcp 窗口会增长，并且可能会在一段时间后推送 16K 消息。请求相对容易——它通常很小，删除不需要的 cookie 等；响应更难，因为它是您的数据，请尝试压缩或仅发送实际使用的数据，而不使用格式、样式或任何其他可以在客户端完成的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T01:54:10.770

对于与性能问题相关的所有问题，唯一的答案是 - 使用分析器。根据您的偏好、分析器功能和其他原因，您可以从工具列表中进行选择（该列表仅包含我曾经使用或听说过的工具）：

*   [xdebug](http://xdebug.org/)
*   [xhprof](https://github.com/facebook/xhprof)
*   [品霸](http://pinba.org/wiki/Main_Page)

# c - 错误：预期 ')' 在 ';' 之前 令牌

> ID：14248895
> 
> 赞同：1
> 
> 时间：2013-01-10T00:26:59.247
> 
> 标签：c

我有一个我无法解决的愚蠢的小问题......

```
exer3.c: In function ‘shm_pipe_pipe’:
exer3.c:69:39: error: expected ‘)’ before ‘;’ token
exer3.c:69:39: error: too few arguments to function ‘shmget’
/usr/include/i386-linux-gnu/sys/shm.h:54:12: note: declared here 
```

线路69周边：

```
pipes_array[i].m_key = 1;
key = i;

pipes_array[i].m_shmid = shmget(key, PIPE_SIZE, IPC_CREAT | IPC_EXCL | 0600); //69

if (pipes_array[i].m_shmid < 0) {
    perror("Error");
    return -1;
} 
```

然后：

```
exer3.c: In function ‘shm_pipe_read’:
exer3.c:111:60: error: expected ‘)’ before ‘;’ token 
```

线路111周边：

```
 current_bytes_to_read = total_bytes_to_read <= pipes_array[i].m_bytes_in_pipe ? total_bytes_to_read : pipes_array[i].m_bytes_in_pipe;

    //reading the information
    if ((pipes_array[i].m_roffset + current_bytes_to_read) < PIPE_SIZE) { //111
        memcpy(buf + offset, tbuffer + pipes_array[i].m_roffset, current_bytes_to_read); 
```

然后：exer3.c：在函数'shm_pipe_write'中：exer3.c:153:41：错误：预期'）'在';'之前 令牌

线路153周边：

```
while (total_bytes_to_write != 0) {
    if (pipes_array[i].m_bytes_in_pipe == PIPE_SIZE) { //153

make: *** [exer3.o] Error 1 
```

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T00:28:55.857

您的 PIPE_SIZE 宏可能如下所示：

```
#define PIPE_SIZE   100; 
```

扔掉分号（如果不存在，请添加一些括号）。

# c - 指针间接是否比条件更昂贵？

> ID：14248898
> 
> 赞同：6
> 
> 时间：2013-01-10T00:27:20.020
> 
> 标签：c, performance, pointers, conditional

## 指针间接（获取值）是否比条件更昂贵？

我观察到大多数体面的编译器可以在不同程度上预先计算指针间接 - 可能会删除大多数分支指令 - 但我感兴趣的是间接成本是否大于分支点的成本生成的代码。

我希望如果指针引用的数据在运行时不在缓存中，则可能会发生缓存刷新，但我没有任何数据来支持它。

有人对此事有可靠的数据（或合理的意见）吗？

**编辑：**几位张贴者指出，分支成本没有“一般情况”：它因芯片而异。

如果您碰巧知道一个值得注意的情况，即分支比缓存内间接更便宜（有或没有分支预测），请提及。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T00:40:19.520

这在很大程度上取决于具体情况。

1 缓存（L1、L2、L3）中的数据多久一次，或者必须多久从 RAM 中一直提取一次？

从 RAM 中提取大约需要 10-40ns。当然，这只会填满整个缓存行，所以如果你再使用接下来的几个字节，它肯定不会“受到严重伤害”。

2 它是什么处理器？

较旧的 Intel Pentium4 以其长流水线阶段而闻名，并且需要 25-30 个时钟周期（在 2GHz 时约为 15ns）才能从错误预测的分支中“恢复”。

3 这种情况有多“可预测”？

分支预测在现代处理器中确实有帮助，它们也可以很好地处理“不可预测”的分支，但它确实有点伤害。

4 缓存有多“忙”和“脏”？

如果您必须丢弃一些脏数据来填充缓存行，则在“获取数据”时间之外还需要 15-50ns。

间接寻址本身将是一条快速指令，但当然，如果下一条指令立即使用数据，您可能无法立即执行该指令 - 即使数据在 L1 缓存中。

另一方面，在美好的一天（很好的预测、缓存中的目标、正确方向的风等），分支需要 3-7 个周期。

最后，当然，编译器通常非常清楚什么最有效...... ;)

总而言之，很难肯定地说，唯一的方法来判断你的情况更好是对替代解决方案进行基准测试。我会认为间接内存访问比跳转更快，但是如果没有看到你的源代码编译成什么代码，很难说。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T00:30:40.080

这真的取决于你的平台。不看目标 CPU 的内部，就没有一个正确的答案。我的建议是在测试应用程序中以两种方式测量它，看看是否有明显的差异。

我的直觉是，在现代 CPU 上，通过函数指针进行分支和条件分支都依赖于分支预测器的准确性，因此如果预测器具有相似的工作负载，我希望这两种技术具有相似的性能。（即，如果它总是以相同的方式结束分支，预计它会很快；如果难以预测，预计它会受到伤害。）但唯一确定的方法是在您的目标平台上运行一个真实的测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T00:45:26.297

它取决于处理器到处理器，但取决于您正在使用的数据集，由错误预测的分支（或在某些情况下错误排序的指令）引起的管道刷新可能比简单的缓存未命中对速度的破坏更大。

例如，在 PowerPC 的情况下，未采用（但预计将采用）的分支花费大约 22 个周期（重新填充管道所花费的时间），而 L1 缓存未命中可能花费 600 个左右的内存周期。但是，如果您要访问连续数据，最好不要分支并让处理器缓存丢失您的数据，代价是为您的每组数据花费 3 个周期（预计会占用*和*占用的分支）重新加工。

这一切都归结为：自己测试。对于所有问题，答案**并不是确定的。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T00:32:05.210

由于处理器必须预测条件答案以计划哪条指令有更多的机会被执行，我想说指令的实际成本并不重要。

条件指令效率低下，因为它们使流程变得不可预测。

# php - PHP in_array 使用文本文件中的值不起作用

> ID：14248900
> 
> 赞同：0
> 
> 时间：2013-01-10T00:27:33.163
> 
> 标签：php, mysql, arrays, pdo

我试图从两个不同的文本文件中获取两个不同的数字，将它们放入一个变量中，并将其与 MYSQL 数组进行比较。我的问题是，当我定义三个变量时：

```
$num = 42;

$whichPlaylist = 2;

$joint = "$whichPlaylist $num" 
```

并使用数组进行测试，它可以工作。但是，如果我从文本文件中取出 2 和 42，它就不起作用。我试过使用 $trim 但这似乎并没有解决它。为什么当我定义我的变量时它起作用，但当我从文本文件中获取它们时它不起作用？他们有完全相同的东西（虽然文本文件有一个新行）。

这是我的代码：

```
//Connect to DB
$config = array(
'host'       => 'localhost',
'username'   => '******',
'password'   => '******',
'dbname'     => '******'
);

$db = new PDO('mysql:host='.$config['host'].';dbname='.$config['dbname'],$config['username'],$config['password']);
$query = $db->query("SELECT `recentlyplayed`.`numplayed`, `recentlyplayed`.`id` FROM `recentlyplayed`");

//Put numbers from text files into variables
$num = file_get_contents('/home/*****/num.txt'); // has the value "42" with new line
$whichPlaylist = file_get_contents('/home/*****/whichplaylist.txt'); // has the value "2" with newline
$playlist3_num = file_get_contents('/home/*****/playlist3_num.txt');

//$whichPlaylist = 2;
//$num = 42;
$joint = "$whichPlaylist $num";
$trimmed = trim("$joint");
echo $trimmed;

while ($row = $query->fetch(PDO::FETCH_ASSOC)) {
if (in_array($trimmed, $row)){
    echo " In Array!"; //This does NOT work, but if I use the self-defined variables $whichPlaylist and $num (and comment out file_get_content variables) it DOES work.

}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T00:32:40.950

在加入之前，您需要从 file_get_contents 中修剪变量；否则换行符将在结果字符串中。修剪只需要字符串开头和结尾的空格，这会将它放在中间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:33:56.830

在加入它们之前，您需要修剪这些值。如：

```
$num = trim(file_get_contents('/home/*****/num.txt')); // has the value "42" with new line
$whichPlaylist = trim(file_get_contents('/home/*****/whichplaylist.txt')); // has the value "2" with newline
$playlist3_num = file_get_contents('/home/*****/playlist3_num.txt');

$joint = "$whichPlaylist $num"; 
```

# python - Python - 在不使用 100% cpu 的情况下检查按键

> ID：14248901
> 
> 赞同：1
> 
> 时间：2013-01-10T00:27:41.570
> 
> 标签：python, multithreading, winapi, tkinter, keypress

我正在使用 Tkinter 在 Python 中编写一个 GUI 程序，我需要一种方法来检查是否发生了按键操作而不使用我所有的 cpu。目前我正在使用线程模块来启动一个线程，该线程将检查按键而不冻结界面（Tkinter）。我在线程内的 while 循环中使用 win32api.GetKeyState() 以便它不断检查键的状态，因为即使窗口没有焦点，它也需要能够判断键是否被按下。问题是程序在我启动线程的那一刻使用 100% cpu。如果我将 time.sleep() 放入循环中，它会显着减少 CPU 使用率，但实际按键与知道您正在按键的时间之间存在延迟。

```
from Tkinter import *
import win32api

class Application(Frame):
    def __init__(self, master=None):
        Frame.__init__(self, master)
        self.pack()

        coords = StringVar()

        Label(master=self, textvariable=coords).pack()

        def GetCoords():
            coords.set(str(win32api.GetCursorPos()))

        root.bind_all("<Scroll_Lock>", self.GetCoords)

root = Tk()
app = Application(master=root)
#root.wm_iconbitmap(default='INSERT ICON HERE')
#root.wm_title("TITLE OF PROGRAM")
#app.master.maxsize(640, 480)
app.master.minsize(640, 480)
app.master.resizable(0, 0)
app.mainloop()
app.quit() 
```

该脚本给了我以下结果： AttributeError: Application instance has no attribute 'GetCoords'

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T00:34:28.217

您想要捕获关键事件，而不是轮询当前的键盘状态。

请参阅TkInter 文档中的[事件和绑定](http://effbot.org/tkinterbook/tkinter-events-and-bindings.htm)，它有一个简单的示例，可以完全满足您的需求（另外，它是跨平台的，而不是仅限 Win32）。

这通常是所有 GUI 编程（和网络服务器，就此而言）的问题，答案总是相同的。无论有无线程，您都不会直接有效地使用非阻塞“检查当前 X 状态”调用。在主线程中，您要求事件循环“在 X 状态更改时调用我的函数”，或者您创建一个后台线程并进行阻塞“永远等待直到 X 发生”调用。

[事件循环](http://en.wikipedia.org/wiki/Event_loop)上的维基百科页面实际上对此有很好的描述。

* * *

查看您编辑的版本，您现在遇到了一个全新的问题：

```
class Application(Frame):
    def __init__(self, master=None):
        Frame.__init__(self, master)
        self.pack()

        coords = StringVar()

        Label(master=self, textvariable=coords).pack()

        def GetCoords():
            coords.set(str(win32api.GetCursorPos()))

        root.bind_all("<Scroll_Lock>", self.GetCoords) 
```

`GetCoords`是内部定义的局部函数`Application.__init__`。但是您尝试将其用作`Application`. `self.GetCoords`除非`GetCoords`是`self`. _ 这正是错误消息的`AttributeError: Application instance has no attribute 'GetCoords'`含义。

但是你*可以*通过本地函数`GetCoords`，只需`self.`去掉前缀。我不确定这会如你所想（因为我不确定你是否可以关闭`StringVar`类似的东西），但是……试试看。

或者，您可以通过将其移出并给它一个参数来*创建一个方法。* 然后你*可以*访问，并获得一个绑定的方法，你可以完全按照你想要的方式传递它。但是，在这种情况下，它将无法再访问，因为这是. 要解决此问题，请将该局部变量更改为成员变量，方法是使用和（以及其他任何地方）的任何地方而不是.`GetCoords``def __init__``self`*`self.GetCoords``coords``__init__``self.coords``__init__``GetCoords``coords`*

# ruby-on-rails - Rails APP_PATH 的测试依赖

> ID：14248912
> 
> 赞同：1
> 
> 时间：2013-01-10T00:29:02.673
> 
> 标签：ruby-on-rails, ruby, testing, testunit

我有以下测试：

```
def test_to_show_warnings_if_app_path_is_defined                                      
  require File.dirname(__FILE__) + '/../lib/macros.rb'
  warnings = $stderr.string.split(/\n/)
  warnings.each { |w| assert_no_match(/warning: already initialized constant/, w) }
end 
```

如果有关于已初始化常量的警告，它应该会失败。在所需文件的另一侧，我有以下问题：

```
MYPATH = ""
MYPATH = File.expand_path(File.split(APP_PATH)[0] + "/macros",  __FILE__) if defined?(APP_PATH) 
```

它检查 APP_PATH 是否已定义并保存在 MYPATH 上。显然，如果定义了 APP_PATH，它将覆盖常量。**除非测试捕获此警告**，否则我无法更正上面的代码。我应该怎么办？

请记住 APP_PATH 是在 rails 服务器运行时定义的，如您[在第 1.3 节 script/rails中所见](http://guides.rubyonrails.org/initialization.html)

# java - 如何让 XStream 映射回类型列表？

> ID：14248932
> 
> 赞同：1
> 
> 时间：2013-01-10T00:31:00.340
> 
> 标签：java, json, orm, xstream, oxm

我正在使用 XStream 将一些 JSON 映射回 Java 对象。我将处理一个可能如下所示的 JSON 字符串：

```
{
    "widgets":[
    {
        "widget_name": "Kenny",
        "widget_type": "Character"
    },
        "widget_name": "Apple",
        "widget_type": "Fruit"
    }
    ]
} 
```

**更新：**我*相信*这个 JSON 可以解释为：

> 此 JSON 表示包含对象的未命名`widgets`对象。反过来，该`widgets`对象包含一组其他未命名的对象。这些未命名的对象中的每一个都包含两个属性：`widget_name`和`widget_type`。

这里的每一个都`Widget`对应`widgetlist`一个 POJO：

```
public class Widget {
    private String name;
    private String type;

    // ...etc.
} 
```

我希望将上面的 JSON 字符串映射回 a `List<Widget>`，但我似乎无法弄清楚如何正确地为类命名：

```
XStream xs = new XStream();
xs.alias("widgetlist", List.class); // Not a List<Widget> ! 
```

**我怎样才能让`xs`映射器翻译`widgetlist`成一个`List<Widget>`？**提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T01:01:03.053

这段代码对我有用，但是生成的 JSON 与您拥有的不同。如果您使用 the`JsonHierarchicalStreamDriver`而不是 the`JettisonMappedXmlDriver`您将获得与您的问题相同的 JSON。这样做的缺点是`JsonHierarchicalStreamDriver`无法读取 JSON，`UnsupportedOperationException`如果您尝试会给出。

```
XStream xstream = new XStream(new JettisonMappedXmlDriver());
xstream.setMode(XStream.NO_REFERENCES); 
xstream.alias("widgetlist", List.class);
xstream.alias("widget", Widget.class);
List<Widget> widgetlist = new ArrayList<Widget>();
Widget w1 = new Widget("Kenny", "Character");
Widget w2 = new Widget("Apple", "Fruit");
widgetlist.add(w1);
widgetlist.add(w2);
String serialized = xstream.toXML(widgetlist);
System.out.println(serialized);
List<Widget> unserialized = (List<Widget>)xstream.fromXML(serialized);
System.out.println("Size: "+unserialized.size()); 
```

生成的 XML 由`JettionMappedXmlDriver`

```
{
    "widgetlist": {
        "widget": [
            {
                "name": "Kenny",
                "type": "Character"
            },
            {
                "name": "Apple",
                "type": "Fruit"
            }
        ]
    }
} 
```

**解释**

JSON 是`DROP_ROOT_MODE`以下 JSON 的版本（如果您愿意，可以选择未命名的对象）。因此，您可以将其视为一个未命名的对象，其中**包含** `Widget`. 该`Widget`对象仍然具有与问题中描述的相同的结构。

```
public class WidgetList {
    List<Widget> widgets;

    public WidgetList() {
        this.widgets = new ArrayList<>();
    }
} 
```

*Xstream 设置*

```
 xstream.setMode(XStream.NO_REFERENCES);
    xstream.alias("widgets", List.class);
    xstream.addImplicitCollection(WidgetList.class, "widgets");
    xstream.alias("widgets", Widget.class);
    xstream.alias("widgetsL", WidgetList.class); 
```

*JSON 输出*

```
{
    "widgetsL": {
        "widgets": [
            {
                "name": "Kenny",
                "type": "Character"
            },
            {
                "name": "Apple",
                "type": "Fruit"
            }
        ]
    }
} 
```

# jquery-ui - 带有 jquery 的简单多层手风琴列表

> ID：14248933
> 
> 赞同：0
> 
> 时间：2013-01-10T00:31:11.513
> 
> 标签：jquery-ui, html-lists

我正在尝试使用 jquery 手风琴样式菜单简化导航树。在其他帖子的帮助下，我觉得我错过了一些简单的东西。让我感到的是，一个类别有第二个子列表。我不能让它正确地打开。关闭。我在这里的示例代码只是不展开“T1 sub b”项目。我错过了什么？

[http://jsfiddle.net/9uvgs/203/](http://jsfiddle.net/9uvgs/203/)

html:

```
 <ul class='menu'>
  <li>Tier1</li>
  <ul>
     <li>T1 sub a</li>
     <li>T1 sub b</li>
         <ul>
           <li>T1 sub i</li>
         </ul> 
  </ul>
  <li>Tier 2</li>
  <ul>
      <li>T2 sub a</li>
      <li>T2 sub a</li>
      <li>T2 sub a</li>
  </ul>
</ul> 
```

jQuery

```
$(document).ready(function(){
$('ul.menu ul').hide();
$('ul.menu>li').click(function(){
    $(this).next('ul').slideToggle();

}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:37:50.580

```
$(document).ready(function(){
    $('ul.menu ul').hide();
    $('ul.menu li').click(function(){
        $(this).next('ul').slideToggle();

    });
}); 
```

我已经这样做了，它看起来工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:38:18.560

您只是将点击事件应用于`ul.menu`简单解决方案的直接子级，将选择器更改为`ul.menu li`而不是`ul.menu>li`

```
$(document).ready(function(){
    $('ul.menu ul').hide();
    $('ul.menu li').click(function(){
        $(this).next('ul').slideToggle();

    });
}); 
```

# synchronization - 消息队列是地理分布式部署的正确工具吗？

> ID：14248934
> 
> 赞同：2
> 
> 时间：2013-01-10T00:31:24.783
> 
> 标签：synchronization, message-queue, amqp

我们的场景如下（我猜这不是唯一的）：我们在两个不同的托管设施中有我们的数据库支持的 Web 应用程序。一个设施有主数据库，另一个有从属数据库。

即使主数据库处于脱机状态，我们也希望从属设施继续工作（必要时在受限模式下）。当主数据库备份时，数据应该得到同步。

我在想我可以使用消息队列来发送数据更新指令。如果从服务器和主服务器之间断开连接，从服务器中的消息队列将保存其消息。当连接恢复时，消息将流动，主服务器将更新数据库。

我错过了什么吗？这不是消息队列的好用处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T22:37:54.557

是的，但是它不像在数据中心使用消息队列那么简单。您可能需要在两个持久消息集群之间建立桥接架构。一种方法是在每个物理位置设置一个 RabbitMQ 代理（或代理集群），然后使用另一个协议桥接这些位置，例如使用这个 ZeroMQ 插件[https://github.com/rabbitmq/rmq-0mq /维基](https://github.com/rabbitmq/rmq-0mq/wiki)

最终结果是消息代理的联合。根据数据量和位置之间的距离，您可能希望将压缩构建到架构中，或者使用用于桥接的压缩 VPN 链接，或者在集群之间进行某种批处理和压缩。

但这不是唯一的方法。另一种方法是拥有一个中央 RabbitMQ 集群并使用 SSL 客户端通过 Internet 连接到该集群。如果位置相对靠近，这将是一个更好的解决方案。例如，如果所有地点都在美国东北部，这就是我会这样做的方式。但是，如果这些位置位于美国、欧洲和亚洲，那么最好使用联合解决方案来桥接代理集群之间的数据。

在一个非常大的组织中，比如在三大洲有 100 个地点，您可能希望将这两种解决方案结合起来。

但是，如果这真的就像两个位置一样简单，一个主数据库和一个副本，我认为你最好坚持使用标准的数据库复制解决方案，如果数据量真的很大，可以考虑用它们之间的压缩链接来补充它大的。我知道的复制解决方案已经处理了保存更新以供以后发送，当主从之间的链接断开时。在那种情况下最好忘记 AMQP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T04:05:30.140

IBM DB2 有一个工具`"Q Replication"`，用于将提交的事务数据从 DB2(R) UDB 源复制到目标。Q Replication 使用`WebSphere MQ`队列和两个程序`Q Capture`来`Q Apply`复制数据。该`Q Capture`程序在源上运行，捕获数据并发送到 WebSphere MQ 队列。Q Apply 程序在目标上运行，从 WebSphere MQ 队列接收消息并将数据应用到目标数据库。

[您可以在此处](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.ii.doc/start/cgpch300.htm)找到有关 Q 复制的更多信息

# ruby-on-rails-3 - Rails3 - 将缩略图图像作为字节数组传递给 JSON

> ID：14248935
> 
> 赞同：0
> 
> 时间：2013-01-10T00:31:37.327
> 
> 标签：ruby-on-rails-3, json, bytearray

在 Rails 3 中，如何将缩略图图像作为字节数组传递给 JSON？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:44:50.200

要将图像转换为文本，您可以将其转换为 base64。

查看：

红宝石：

[http://ruby-doc.org/stdlib-1.9.3/libdoc/base64/rdoc/Base64.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/base64/rdoc/Base64.html)

jQuery：

[http://archive.plugins.jquery.com/project/base64](http://archive.plugins.jquery.com/project/base64)

**更新：**

[如何在 Ruby 中给定 URL 以 base64 编码媒体](https://stackoverflow.com/questions/1547008/how-to-encode-media-in-base64-given-url-in-ruby)

# magento - Magento CE 1.7.0.2 - 编辑订单不取消原始订单

> ID：14248938
> 
> 赞同：0
> 
> 时间：2013-01-10T00:32:03.500
> 
> 标签：magento, magento-1.7

我不确定究竟是什么变化会导致这个问题，如果我编辑处理订单并放置新订单，它不会取消原始订单。在 Google 和 StackOverflow 上查找现有解决方案，但实际上是空的。

**重现步骤（场景）：**

1.  您需要编辑订单，因为客户忘记向其中添加商品，所以我在处于“处理中”状态的订单上单击“编辑”

2.  下订单

3.  查看销售-> 订单列表，我可以看到原始订单处于处理状态仍处于错误中。新订单具有相同的订单#，末尾附加“-1”，这很好

所以，我想知道是否有其他人遇到过这样的问题。它用于在您下订单后取消原始订单。单击“编辑”后弹出的警告 JS 消息说它将下新订单并将当前标记为已取消，因此出现问题。在我的配置中似乎没有什么异常。

编辑：猜猜没有人遇到过这样的问题。我想不出任何会导致这种情况的事情。自从这篇文章以来，我已经将 Magento 升级到 CE 1.7.0.2。

谢谢，

乔治

编辑：附上截图：

![屏幕截图显示 Magento 上的查看顺序](../Images/4a7ebfca933fe8104933cfc3379bfc23.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T12:59:46.447

您不能取消已在**处理（已开票）/已发货/已完成**的订单！

您只能在**NEW State取消订单**

在您的情况下，您有发票订单，并且您想重新订购：-

*   按编辑并继续新订单（订单将后缀 -1/-2，因为这意味着此订单与前一个订单相关/相关）

*   去原始订单并完成退款（它将处于关闭状态/状态）

您需要了解订单的工作流程以及您可以在**每个州对订单执行的操作**

# web-crawler - robots txt 不允许使用通配符

> ID：14248940
> 
> 赞同：3
> 
> 时间：2013-01-10T00:32:06.520
> 
> 标签：web-crawler, robots.txt

我无法阻止谷歌抓取一些导致错误的网址。

我想停下来

*   /project/123984932842/download/pdf
*   /project/123984932842/下载/zip

但允许

*   /项目/123984932842
*   /project/123984932842/平

我试过 project/*/download/pdf 但它似乎不起作用。有谁知道会怎样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T00:40:33.640

你有一个`/`在行的开头`Disallow:`吗？

```
User-agent: googlebot
Disallow: /project/*/download/pdf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:55:02.227

*最初*的robots.txt 规范没有定义任何通配符，但谷歌（和其他一些人）将它们添加到他们的解析器中。~~但是，我想您无论如何都不需要它们~~（正如吉姆指出的那样，这是错误的）。以下 robots.txt（使用[`*`通配符](https://developers.google.com/webmasters/control-crawl-index/docs/robots_txt)）应该可以完成这项工作：

```
User-agent: Googlebot
Disallow: /project/*/download 
```

# java - Java如何判断文件是否存储在本地？

> ID：14248942
> 
> 赞同：1
> 
> 时间：2013-01-10T00:32:17.563
> 
> 标签：java

我想检查一个文件是否存在并且是一个目录：

```
File file = new File("C:\file.txt");
boolean isValidDir = file.exists() && file.isDirectory(); 
```

文件可以存储在同一台计算机上，也可以存储在网络上的不同计算机上。如果文件存储在本地，这些方法将很快返回，但如果文件存储在网络上的其他地方，例如网线断开，这些方法需要一段时间才能返回。此外，如果从 EDT 调用这些方法，UI 将显示为冻结。（我从不同的线程调用这些方法以避免这个问题。）

我想知道是否有一种方法可以判断文件`U:\helloworld\`是存储在本地还是存储在网络上的其他地方。这些方法仍然需要一段时间才能在另一个线程中返回，但我需要在 EDT 中使用上述行的结果来相应地绘制组件。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T02:08:22.147

*只是一个建议*-我会找到在本地文件系统上验证文件所需的大致时间。如果花费的时间大约是所用时间的 1.5 或 2 或 3 倍，则可以*假定*该文件位于不同的文件系统上。

# c - c中的strcmp字符串和字符数组

> ID：14248945
> 
> 赞同：2
> 
> 时间：2013-01-10T00:32:37.650
> 
> 标签：c, arrays, string, character, strcmp

这是我的代码。我正在尝试进行字符串比较。串行输入读取按下的键并将 cmd.command 设置为在键盘上键入的内容。然后我接受它并进行字符串比较，看看它是否是我列表中的命令。我坚持的是字符串比较。

```
typedef struct {
    const char *cmd;
    void (*cmdFuncPtr)(void);
}CmdStruct;

typedef struct {
    char command[16];
    char argument[16];
} Command;

Command cmd;

CmdStruct cmdStructArray[] = { {"led",      LEDHandler      },
                               {"relay",    RelayFunction    },  };

void ProcessCommand() {
    for (j = 0; j < sizeof(cmdStructArray)/sizeof(cmdStructArray[0]); j++) {
        if(strcmp(cmdStructArray[j].cmd, cmd.command) == 0) {
            // do stuff
        }
    }
} 
```

如果我输入“led”，那么这两个 printf 语句会打印相同的内容。

```
printf(cmdStructArray[0].cmd);
printf("%s", cmd.command); 
```

如何使字符串比较起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:40:54.637

您的`cmd.command`命令可能有隐藏的尾随空格。在运行比较之前去掉空格。（感谢评论中的大卫施瓦茨！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T17:49:01.543

我找到了一个修复程序，现在 strcmp 可以工作了。我更改了结构数组中的结构。现在是

```
typedef struct {
    char cmd[16];
    void (*cmdFuncPtr)(void);
}CmdStruct; 
```

我不知道为什么会这样，也不知道有什么区别。我之前的 const char *cmd 也是一种在 C 中创建“字符串”的方法。

# asp.net - 您的登录尝试不成功。请再试一次。在 asp.net 虽然密码被重置

> ID：14248949
> 
> 赞同：4
> 
> 时间：2013-01-10T00:33:17.913
> 
> 标签：asp.net, visual-studio-2010, login, asp.net-membership

我在 asp.net 中的一个帐户有问题，虽然我重置了密码，但我在尝试登录时仍然收到此错误：“您的登录尝试不成功。请重试”

我如何才能看到为什么会发生这种情况的真实信息？根据 aspnet 成员的数据库表，一切看起来都不错：

![在此处输入图像描述](../Images/b43a3364be0b3f1612e248622b585726.png)

每一个建议都值得赞赏。提前致谢， Laziale

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:48:52.820

在验证您的登录信息的语句处放置断点。然后调试看看有没有异常。请记住使用 try..catch 语句进行包装，并在 catch 语句中放置另一个断点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T05:18:47.830

我也跑过这个问题。在与我的项目的旧版本比较后，我发现了以下问题。属性：

```
onauthenticate="LoginSite_Authenticate" 
```

已添加到导致此行为的**asp:LoginView控件。**删除它后 - 登录恢复正常。

# matlab - 不懂matlab生成的绘图命令

> ID：14248951
> 
> 赞同：3
> 
> 时间：2013-01-10T00:33:48.923
> 
> 标签：matlab

我是 Matlab 的新手，正在探索 R2011a 中的工具。通过在工作区（右上角的子窗口）中选择变量并按下 plot(x,y) 按钮，我能够成功绘制 x vs sin(x)，如下所示：

```
x = 0:0.01:2*pi;
y = sin(x); 
```

![选择 x 和 y 变量，然后按下 plot(x,y)](../Images/7d246b2f298eb8d27336f5e47fa66a2f.png)

显然按下 plot(x,y) 按钮会生成以下命令，我从命令窗口复制并粘贴了该命令：

```
plot(x,y,'DisplayName','y vs. x','XDataSource','x','YDataSource','y');figure(gcf) 
```

有人可以解释上述命令的作用吗？我做了“doc plot”（使用 Matlab 2011a），下面列出了可能的参数选项。哪一个与上面的 plot 命令匹配，我怎么知道呢？

```
plot(Y)
plot(X1,Y1,...,Xn,Yn)
plot(X1,Y1,LineSpec,...,Xn,Yn,LineSpec)
plot(X1,Y1,LineSpec,'PropertyName',PropertyValue)
plot(axes_handle,X1,Y1,LineSpec,'PropertyName',PropertyValue)
h = plot(X1,Y1,LineSpec,'PropertyName',PropertyValue) 
```

另外，`figure(gcf)`生成的命令中有什么作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T01:12:37.633

您的命令使用的语法是列表中的第 4 个。

```
plot(x,y, [LineSpec,] 'property1', value1, 'property2', value2, 'property3', value3); 
```

要使用图表，通常只需要第二种形式：

```
x = 0:0.001:pi;
y = sin(x);
plot(x,y) 
```

如果您省略`x`，则这些值暗示为 integers `1:len(y)`，这有时就足够了，但在这种情况下并不理想。

该`figure(H)`命令要么创建一个图形窗口，要么如果带有句柄的图形`H`已经存在，则简单地为该图形提供焦点（例如，如果它隐藏在其他窗口后面，它将显示它）。

可`LineSpec`用于修改线条的外观，例如它们的颜色或线条是实线还是虚线。例如，`'r--x'`制作一条带有十字的红色虚线作为标记（在每个数据点上）。如果省略，则采用默认值（没有标记的蓝色实线）。

对于更高级的设置，linespec 还可以包含属性、值对，但这会使事情变得有点复杂，因为它们已成为通用属性、值设置，因此可以`LineSpec`与`'PropertyName',PropertyValue`部件一起出现。所以

```
plot(x,y, 'r--x', 'linewidth', 3, 'DisplayName', 'sin x')
plot(x,y, 'r--x', 'DisplayName', 'sin x', 'linewidth', 3) 
```

都是有效的并且具有产生更粗线的相同效果，而

```
plot(x,y, 'linewidth', 3, 'DisplayName', 'sin x', 'r--x') 
```

无效，因为它位于`LineSpec`某些属性、值设置之后。

通常，尝试在命令窗口中键入`help <command>`或`doc <command>`尝试更好地理解特定函数，或者如果您不确切知道该函数可能被调用的内容，请尝试`lookfor <keyword>`（例如 `lookfor filter`与过滤相关的函数）。

**编辑：**在这种情况下设置的其他属性是

*   '显示名称'
*   'XDataSource'
*   'Y 数据源'

图例字符串将显示在该图的行旁边。要显示图例（假设上面的数据）：

```
plot(x,y,'DisplayName', 'sin x');
legend toggle 
```

如果您正在制作链接图，设置数据源可能很有用。（参见[在线文档](http://www.mathworks.co.uk/help/matlab/data_analysis/making-graphs-responsive-with-data-linking.html)）。

帮助页面`figure`并`figure properties`提供图形可以采用的所有属性的全面详细信息；并查看`lineseries properties`图中各条线的属性。

**编辑 2：**添加了上面 linespec 的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:53:01.460

我不确定您使用的是哪个 MATLAB 版本，但`doc plot`在 R2011b 和 R2012b 中有上述语法版本：

```
plot(Y)
plot(X1,Y1,...,Xn,Yn)
plot(X1,Y1,LineSpec,...,Xn,Yn,LineSpec)
plot(...,'PropertyName',PropertyValue,...)
plot(axes_handle,...)
h = plot(...) 
```

[http://www.mathworks.nl/help/matlab/ref/plot.html](http://www.mathworks.nl/help/matlab/ref/plot.html)

这解释了为什么允许“省略” ：的`LineSpec`对可以放在参数列表中的任何位置。所以从技术上讲，你的语法是这个列表中第二个和第四个的组合——你的版本在语法上不正确，真的。`PropertyName``PropertyValue``doc plot`

我相信 Bonlenfum 已经回答了您的其他问题。

# ios - 将 UIView 或 UIViewController 置于所有其他之上

> ID：14248954
> 
> 赞同：4
> 
> 时间：2013-01-10T00:34:06.820
> 
> 标签：ios, uiview, uiviewcontroller, uiapplicationdelegate, uiapplication

我正在继承 UIApplication 以在我的 TouchDisplay 视图中拦截和显示触摸。我想扩展 Application、Window、Delegate 或 Main ViewController，以使我的 TouchDisplay 视图位于所有其他视图之上。随着我和大多数其他应用程序的工作，视图和控制器一直在添加和删除。我认为正确的答案将能够处理这些添加和删除，并且仍然保持 TouchDisplay 视图位于顶部。

谢谢你的帮助，乔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T02:03:55.200

您可以为此采取以下几种方法：

1.  如果您*只针对 iOS 5+ 和 iPad*，您可以制作一个包含两个视图控制器的顶级视图控制器。第一个是“TouchDisplay”视图的视图控制器。第二个是应用程序的普通根视图控制器。（即你现有的主视图控制器；你需要在这个视图控制器*上将definePresentationContext*设置为YES）因为你正在编写容器视图控制器，你可以随意订购这两个子视图。WWDC 2011 [Talk on view controller contains](https://developer.apple.com/videos/wwdc/2011/?id=102)对此进行了非常详细的说明。恕我直言，这是最“正确”的方法，因为它为您的 TouchDisplay 视图提供了一个视图控制器，处理旋转并且通常与其他人相处得很好。（这只适用于 iPad，因为在 iPhone 上，新的模态视图总是覆盖全屏。）

2.  一种更直接的方法是简单地将您的 TouchView 添加到您现有的顶级 UIWindow 作为具有`addSubview:`. 大多数应用程序实际上并没有删除顶级视图控制器或添加新的顶级视图控制器；他们只是从中呈现其他视图控制器。您在顶级窗口中添加的视图将保持在这些视图之上。当然，您的应用程序可能不遵循此规则，在这种情况下，您可以尝试选项 #3。这有旋转陷阱（当设备旋转时，您的视图不会自动旋转，因此您需要自己执行此操作。）如果您遇到问题，您也可以强制您的视图返回顶部，例如在 1 秒计时器上用其他东西覆盖它。这也没有选项#1 好，因为你没有得到 UIViewController，只有 UIView。

3.  最极端的方法是您可以创建另一个 UIWindow 并为其提供更高的窗口级别，例如`UIWindowLevelAlert`并将您的 TouchDisplay 视图放入其中。然后，您可以使窗口背景透明，并且它将保持在您的正常应用内容之上。这里有很多陷阱，特别是关于自动旋转以及哪个窗口是 keyWindow（这就是为什么你应该使用 #1 或 #2 来代替）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T00:04:30.917

一段时间后，我能够让我的应用程序正常工作。我制作了一个易于使用的叠加层，可以显示现有应用程序的触摸反馈。

你可以在这里下载项目： [https ://github.com/megaplow/FingerTracks/tree/master/FingerTracks](https://github.com/megaplow/FingerTracks/tree/master/FingerTracks)

![示例图像](../Images/1e920b72766c0d0cf462d5c6b50d92a8.png)

快乐的编码，乔

# objective-c - 使用块创建回调

> ID：14248955
> 
> 赞同：0
> 
> 时间：2013-01-10T00:34:06.857
> 
> 标签：objective-c, callback, objective-c-blocks

我是来自 JavaScript 世界的 Objective-C 新手，我正在尝试在一个类上定义一个“回调”属性。在 JavaScript 领域，我们习惯于随意传递函数，但似乎 Objective-C 并不那么宽松。

这是我尝试做的事情（尽量简化事情）：

```
@interface CallbackThing : NSObject
  @property (nonatomic) NSString *derpDerp;
  @property (nonatomic) SEL callback;
@end 
```

然后在另一堂课......

```
CallbackThing *testCallbackThing = [CallbackThing alloc] init];
testCallbackThing.callback = @selector(methodInThisCLass); 
```

终于在另一个班级...

```
if (self.testCallbackThing.callback != nil){
    [self.thatOtherClass performSelector:self.testCallbackThing.callback];
} 
```

效果很好！我为自己感到骄傲……直到……

**“警告：performSelector 可能会导致泄漏，因为它的选择器是未知的！”**

尝试阅读内容，似乎做事的新方法是使用块......但我看过的例子在这种情况下都没有多大意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:36:58.630

不确定您的具体用例是什么，但块很容易。首先，声明你的块类型：

```
typedef void (^MyBlock)(NSArray*, NSString*); 
```

然后你可以将它设置为一个属性，就像你对 SEL 所做的那样：

```
@property(nonatomic, copy) MyBlock block; 
```

然后，您只需调用执行它的块：

```
self.block(someArray, someString); 
```

# objective-c - viewController 中 tableView 的圆角

> ID：14248956
> 
> 赞同：0
> 
> 时间：2013-01-10T00:34:13.883
> 
> 标签：objective-c, tableview, rounded-corners

我不知道如何在 viewController 中的 tableView 上制作圆角。

视图控制器.m：

我添加了框架并导入：

```
#import <QuartzCore/QuartzCore.h> 
```

而且在 voidDidLoad 方法中：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    [self.view.layer setCornerRadius:7.0];

} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:38:38.623

这应该工作：

```
 #import <QuartzCore/QuartzCore.h>
   self.view.layer.cornerRadius = 7;
   self.view.layer.masksToBounds = YES; 
```

# html - 风格选择菜单

> ID：14248961
> 
> 赞同：5
> 
> 时间：2013-01-10T00:34:50.313
> 
> 标签：html, css

是否可以像下图那样设置 <select> 菜单的样式：

![一个选择菜单](../Images/b9c845374fc6f942921fe403538a0c52.png)

这是我一直在研究但无法正确箭头的小提琴。

[http://jsfiddle.net/nmpxj/](http://jsfiddle.net/nmpxj/)

这是HTML：

```
<select>
  <option>Alabama</option>
  <option>Alaska</option>
</select> 
```

这是CSS：

```
select {
background: -webkit-linear-gradient(#C9C9C9, #CCC);
background: -moz-linear-gradient(#C9C9C9, #CCC);
border: 1px solid #ccc;
color: white;
text-shadow: 0 0 4px rgba(0, 0, 0, 0.8);    
-webkit-appearance:none;
-moz-appearance:none;
appearance:none;
padding:10px;
} 
```

是否可以像这样设置 <select> 菜单的样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T01:01:58.230

你需要做的方式基本上是把它们都向左浮动并清除它们的权利，如下所示

```
select { float:left; clear:right; }
div { float:left; clear:right; } 
```

这会将它们推到一起。此外，您不应该使用`<p>`选择框旁边的标签。将箭头放在 div 内，没有理由不这样做，当您浮动它们时它也会删除空间。这样做只是更简洁的编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T07:21:39.920

您可以将其添加到您的 CSS：

```
width: auto;  
background: url('http://cdn1.iconfinder.com/data/icons/picol/icons/arrow_sans_down_32.png') no-repeat right; 
```

这应该够了吧。

演示：[选择演示](http://jsfiddle.net/nmpxj/11/ "选择")

# ruby-on-rails - Rails ActiveRecord 关系 - 避免写入 .blank？支票

> ID：14248964
> 
> 赞同：4
> 
> 时间：2013-01-10T00:35:22.283
> 
> 标签：ruby-on-rails, rails-activerecord

这更像是一个风格问题。

在编写查询时，我总是发现自己检查查询的结果是否为空白，这似乎 - 我不知道，在某种程度上过于冗长或错误。

前任。

```
def some_action
  @product = Product.where(:name => params[:name]).first
end 
```

如果没有 name = params[:name] 的产品，我会得到一个 nil 值，它会破坏事情。

我已经开始写这样的东西

```
def some_action
  product = Product.where(:name -> params[:name])
  @product = product if !product.blank?
end 
```

是否有更简洁的方法来处理 nil 和空白值？当事情依赖于其他关系时，这变得更加令人头疼

前任。

```
def some_action
  @order = Order.where(:id => params[:id]).first
  # if order doesn't exist, I get a nil value, and I'll get an error in my app
  if !@order.nil?
    @products_on_sale = @order.products.where(:on_sale => true).all
  end
end 
```

基本上，有什么我还没有学到的东西可以让处理 nil、空白和潜在的视图破坏实例变量更有效吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T00:50:42.987

如果它只是风格相关，我会看看 Rails 的 Object# [try](http://api.rubyonrails.org/classes/Object.html#method-i-try)方法，或者考虑类似[andand](https://github.com/raganwald/andand)。

使用您的示例，尝试：

```
def some_action
  @order = Order.where(:id => params[:id]).first
  @products_on_sale = @order.try(:where, {:onsale => true}).try(:all)
end 
```

或使用 andand：

```
def some_action
  @order = Order.where(:id => params[:id]).first
  @products_on_sale = @order.andand.where(:onsale => true).andand.all
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T00:50:04.220

好吧，即使您在控制器中绕过“零破坏”，您的视图中仍然会遇到这个问题。`if`在您的控制器中有一个语句并将视图重定向到“未找到”页面比`if`在您的视图中有多个 s要容易得多。

或者你可以添加这个

```
protected
  def rescue_not_found
  render :template => 'application/not_found', :status => :not_found
end 
```

到你的`application_controller`. 在此处查看更多信息：[https ://ariejan.net/2011/10/14/rails-3-customized-exception-handling](https://ariejan.net/2011/10/14/rails-3-customized-exception-handling)

# php - 在存在的列上插入表

> ID：14248966
> 
> 赞同：2
> 
> 时间：2013-01-10T00:35:28.260
> 
> 标签：php, mysql, sql

假设我有一个非常大的用户信息数组：

```
$user=array(
"name"=>"john",
"ip"=>"xx.xx.xx.xx",
"email"=>"john@something.com",
//lots more values
) 
```

我们还假设此信息需要**进入多个表**。例如`username`需要进入表`users`，`address`需要进入`details`表等。

现在，我使用某个自制函数插入到我的表中，将**数组键与列名**匹配，将**数组值与输入的值**匹配。与此类似的东西：

```
function insert_sql($table, arr $values){
    GLOBAL $dbc;
    $sql="INSERT INTO `$table` (".implode(array_keys($values), ", ").") VALUES (".implode(array_values($values), ", ").")";
    $dbc->prepare($sql)->execute();
    return $dbc->lastInsertId();

}
//I don't actually use this function, just trying to show you what is being accomplished. 
```

问题是我的函数使用**了所有的键**和**所有的值**，所以当我只需要将数组的某些部分放入多个表时，它就不起作用了。

问题是：

**如果某个列不存在，如何使 INSERT 语句忽略该列？** 因此，如果我将`name`, `email`, `address`, 插入 table `users`，但该表没有地址列，我需要它来插入包含名称和电子邮件的行，但只需忽略地址列不存在的事实。

编辑：另一个选项是使用表的列创建一个数组，并使用它来过滤值数组。虽然我不确定如何设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:41:08.927

查找给定的表列名称：

```
SELECT 
column_name
FROM 
information_schema.columns
WHERE 
table_name =  'tablename' 
```

然后只需将您的键列入白`$values`名单

例子：

```
function insert_sql($table, array $values){
        global $connection;
        $query = "SELECT column_name FROM information_schema.columns WHERE table_name =  :tablename";
        /* @var $stmt PDOStatement */
        $stmt  = $connection->prepare($query);
        $stmt->execute(array(
            'tablename' => $table
        ));
        $columns = array_flip($stmt->fetchAll(PDO::FETCH_COLUMN, 0));
        $values  = array_intersect_key($values, $columns);
        var_dump($values);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:43:38.437

> 如果某个列不存在，如何使 INSERT 语句忽略该列？因此，如果我在表用户中插入姓名、电子邮件、地址，但该表没有地址列，我需要它来插入包含姓名和电子邮件的行，但忽略地址列不存在的事实。

你不能

相反，您应该使用单独的插入将数据映射到适当的表。

# ios - 为什么我需要在删除核心数据中的对象之前删除关系？

> ID：14248967
> 
> 赞同：1
> 
> 时间：2013-01-10T00:35:32.470
> 
> 标签：ios, core-data

我有一个程序，我在其中使用 CoreData 来管理永久和临时数据。

在一种情况下，我通过在用户按下取消时删除对象来中止添加一些数据。但是当我点击下一个视图时，数据仍然存在，附加到它的父核心数据对象。

```
 [self.bar removeFoosObject:self.foo];//Why do I need this line?
    [self.foo.managedObjectContext deleteObject:self.foo]; 
```

我最终通过手动从其父对象中删除子对象来解决这个问题——但这不是核心数据自动处理的吗？为什么我需要第一行？

我运行了一些测试代码，Foo 肯定被删除了——它搞砸的代码让我检查一下，它的 MOC 已设置为 nil。记忆是存在的，但它应该是非常非常死寂的……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:44:31.300

您必须手动执行此操作，因为您的删除规则设置错误。检查以下苹果文档中的关系删除规则。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html)

或者也可能是父对象和子对象之间的关系未设置为可选。

并且在您删除对象后，您应该保存数据库以同步它。

# mysql - 在没有表单的 Rails 中发出 AJAX 请求

> ID：14248974
> 
> 赞同：3
> 
> 时间：2013-01-10T00:36:50.480
> 
> 标签：mysql, ruby-on-rails, ruby, ajax

因此，我`posts`在 Rails 应用程序中生成了一个脚手架，并在 post 模型中添加了一个`upvote`and`downvote`列。我在视图文件上添加了一个“upvote”按钮，当您点击 upvote 按钮时，我需要进行 AJAX 调用并查询数据库，但是 upvote 按钮没有`<form>`附加真正的 Rails。如何进行此 AJAX 调用并将投票添加到数据库中以获取已投票帖子？

当我进行此 AJAX 调用时：

```
$('.up,.down').click(function(){
    $.ajax({
      type: 'POST',
      url: '/posts',
      dataType: 'JSON',
      data: {
        post: {
          upvote: 1
        }
      },
      success: function(){
        alert('success')
      }
    });
  }); 
```

它返回 500 错误。我去哪里形成这里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T00:57:36.523

您可以使用帮助器`:remote => true`上的属性`link_to`，例如：

```
<%= link_to post_upvote_path(post), :remote => true, :method => "put" %>
<%= link_to post_downvote_path(post), :remote => true, :method => "put" %> 
```

然后在`config/routes.rb`：

```
resources :posts do
  put "upvote", :to => "posts#upvote", as: :upvote
  put "downvote", :to => "posts#downvote", as: :downvote
end 
```

然后在您的帖子控制器中处理投票，就像您可能已经在做的那样，并`params[:id]`在操作中获取帖子 ID

[这是 Rails 风格的不显眼 javascript 的介绍](http://net.tutsplus.com/tutorials/javascript-ajax/using-unobtrusive-javascript-and-ajax-with-rails-3/)

**更新**
要查看创建的赞成和反对路线，请转到终端并键入

```
rake routes | grep vote 
```

这将为您提供名称中包含“投票”的所有路线的列表。或者只需键入`rake routes`以获取所有这些的列表。第一列是命名路由，只需将“_path”附加到它的末尾即可在您的应用程序中使用它 - 就像`post_upvote_path`上面那样被视为

```
post_upvote  PUT  /posts/:id/upvote(.:format) posts#upvote 
```

在您的 PostsController 中，您需要这些操作：

```
class PostsController < ApplicationController
  ###
  # index, show... other RESTful actions here
  ###

  def upvote
    @post = Post.find params[:id]
    # code for however you are voting up the post here
  end

  def downvote
    @post = Post.find params[:id]
    # code for however you are voting down the post here
  end
end 
```

# audio - 用于语音/说话人识别的 CMU Sphinx

> ID：14248983
> 
> 赞同：6
> 
> 时间：2013-01-10T00:37:29.433
> 
> 标签：audio, pattern-matching, speech-recognition, voice-recognition, cmusphinx

我正在寻找一种方法来匹配已知数据集，比如说 MP3 或 wav 文件列表，每个文件都是某人说​​话的样本。在这一点上，我知道文件 ABC 是关于人 X 说话的。

然后，我想再取一个样本，并进行一些语音匹配，以根据当时已知的数据集显示这个语音最有可能是谁。

另外，我不一定在乎对方说了什么，只要我能找到匹配的，即我不需要任何转录或其他方式。

我知道 CMU Sphinx 不做语音识别，它主要用于语音到文本，但我见过其他系统，例如：LIUM Speaker Diarization (http://cmusphinx.sourceforge.net/wiki/ Speakerdiarization）或 VoiceID 项目（https://code.google.com/p/voiceid/），它使用 CMU 作为此类工作的基础。

如果我要使用 CMU，我该如何进行语音匹配？

另外，如果 CMU Sphinx 不是最好的框架，有没有开源的替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T09:03:07.370

对于博士论文来说，这是一个足够复杂的主题。目前还没有好的和可靠的系统。

您要完成的任务是一项非常复杂的任务。你应该如何处理它取决于你的情况。

*   你的人数有限吗？多少？
*   每个人有多少数据？

如果您**要识别的人很少**，您可以尝试一些简单的方法，例如获取这些人的[共振峰](http://en.wikipedia.org/wiki/Formant)并将它们与样本进行比较。

否则 - 您必须联系一些从事该主题工作的学者或陪审团制定您自己的解决方案。无论哪种方式，正如我所说，这都是一个难题。

# java - 在 PageAdapter 中获取共享首选项？

> ID：14248988
> 
> 赞同：0
> 
> 时间：2013-01-10T00:38:02.943
> 
> 标签：java, android

我正在开发一个家庭更换应用程序。我需要在我的 PageAdapter 中获取共享首选项，以便我可以更改图标大小和启动器的其他几个方面。

使用时：

```
public class MyPagerAdapter extends PagerAdapter {
    SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(this);
    @Override
    public Object instantiateItem(View container, int position) {
        Context context = container.getContext(); 
```

Eclipse 告诉我方法 getDefaultSharedPreferences 没有为 PageAdapter 类型定义。

有没有办法以某种方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T00:58:02.710

使用正确的上下文：用正确的上下文替换“this”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:51:58.000

从创建此 PagerAdapter 对象的活动中，通过方法（或者可能是构造函数）传递您希望此 PagerAdapter 具有的设置

# jquery - 尝试使用 jquerys .load 加载 asp 代码/sql

> ID：14248992
> 
> 赞同：0
> 
> 时间：2013-01-10T00:38:25.377
> 
> 标签：jquery, sql, asp-classic, ado

每次下拉选择发生变化时，我都会尝试加载一段代码。我认为最好的方法是 .load 文件，但这似乎并没有带来 asp/sql。

如何使以下代码工作：

```
$(document).ready(function() {
    $("#abn").change(function () {
    $("#searchUpdate").load("sql.asp");
})
.change();
}); 
```

错误：

```
Microsoft VBScript runtime error '800a01a8'

Object required: ''

/junk/dbinstant.htm, line 27 
```

页面代码：

```
<%@ LANGUAGE="VBSCRIPT" %>
<%
pagetitle="Contractor Details"
%>
<!--#INCLUDE VIRTUAL="/_lib/include/header.htm"-->
<!--#INCLUDE VIRTUAL="/_lib/include/menu.htm"-->
<script>
$(document).ready(function() {
    $("#abn").change(function () {
    $("#searchUpdate").load("sql.asp");
})
});
</script>
<div class="twoColumnRow">
<div class="twoColumnContent">
<p class="breadCrm"><a href="/index.htm">Home</a> <span>&gt;</span> <a href="/tools/index.htm">Tools of the Trade</a> <span>&gt;</span> <a href="/tools/finance/index.htm">Finance and Purchasing</a><span>&gt;</span> <a href="/tools/finance/procurement/index.htm">Procurement and Contracts information</a></p>
<div class="contentPad">
<!-- Start of main content -->

<p class="imageRight">&nbsp;</p>
<h1><%=pagetitle%></h1>

<div id="searchUpdate"></div> 
<h2>Search results</h2><hr />
<% if not con.BOF then %>
<div style="margin-top:1em">

  <form action="dbresults.htm" method="get">

      <p>Company name:<br/>
      <select id="abn" name="abn">
        <option label="All companies" value="all"></option>
        <% while (NOT scon.EOF) %>
        <option label="<%=scon("legal")%>" value="<%=scon("abn")%>"></option>
        <%scon.MoveNext()
                          Wend %>
      </select>
      </p>
     <p>Categories for Creative Design:<br/>
      <select id="cat" name="cat">
        <option class="group" label="All categories" value="all"></option>
        <option class="group" label="Strategic brand, marketing and communications advice" value="a"></option>
        <option class="group" label="Graphic design and layout" value="b"></option>
        <option class="group" label="Forms design" value="c"></option>
        <option class="group" label="Web design and development" value="d"></option>
        <option class="group" label="Authoring services" value="e"></option>
        <option class="group" label="Editorial services" value="f"></option>
        <option class="group" label="Translation services" value="g"></option>
        <option class="group" label="Photography and film services" value="h"></option>
        <option class="group" label="Scanning and digitisation services" value="i"></option>
        <option class="group" label="Multimedia editing services" value="j"></option>
      </select>
    </p>
    <input type="submit" value="Search" />
  </form>
  <br /><hr />

    <table style="font-size:.9em;" class="contentTable">
          <tr>
                <th>ABN:</th>
                <th>Company Name:</td>
          </tr>
  <% con.Movefirst() %>
  <% while (NOT con.EOF) %>
          <tr>
                <td><%=con("abn")%></th>
                <td><a href="dbcomp.htm?abn=<%=con("abn")%>&cat=all"><%=con("legal")%></a></td>
          </tr>
  <%
    con.MoveNext()
    Wend
  %>
</table>

</div>
<% else %>
    <% scon.Movefirst() %>
  <form action="dbresults.htm" method="get">

      <p>Company name:<br/>
      <select name="abn">
        <option label="All companies" value="all"></option>
        <% while (NOT scon.EOF) %>
        <option label="<%=scon("legal")%>" value="<%=scon("abn")%>"></option>
        <%scon.MoveNext()
                          Wend %>
      </select>
      </p>
     <p>Categories for Creative Design:<br/>
      <select name="cat">
        <option label="All categories" value="all"></option>
        <option label="Strategic brand, marketing and communications advice" value="a"></option>
        <option label="Graphic design and layout" value="b"></option>
        <option label="Forms design" value="c"></option>
        <option label="Web design and development" value="d"></option>
        <option label="Authoring services" value="e"></option>
        <option label="Editorial services" value="f"></option>
        <option label="Translation services" value="g"></option>
        <option label="Photography and film services" value="h"></option>
        <option label="Scanning and digitisation services" value="i"></option>
        <option label="Multimedia editing services" value="j"></option>
      </select>
    </p>
    <input type="submit" value="Search" />
  </form>
  <br /><hr />
<p>No records match your query.</p>
<p><a href="dbtest.htm">Return to search page</a></p>
<%
  end if
  con.close
%>

<!-- End of main content -->
</div> <!-- end contentPad div -->
</div> <!-- end twocolumncontent div -->
<div class="twoColumnLinks">

<!--<div class="relatedLinks">
<h3>Related Links</h3>
<ul>
<li><a href="/index.htm">Related link 1</a></li>
</ul>
</div>--> <!-- end relatedlinks div -->
<!--#INCLUDE VIRTUAL="/_lib/include/quicklinks.htm"-->
<!--#INCLUDE VIRTUAL="/_lib/include/mylinks.htm"-->
</div> <!-- end twocolumnlinks div -->
</div> <!-- end twocolumnrow div -->
<!--#INCLUDE VIRTUAL="/_lib/include/footer.htm"--> 
```

ASP页面代码：

```
<%
        Dim connectString, connect, conDB, sconDB, con, scon, src_abn, src_cat
        connectString = "Driver={Microsoft Text Driver (*.txt; *.csv)}; DBQ=" & Server.MapPath("data")
              src_abn = Request.QueryString("abn")
              src_cat = Request.QueryString("cat")
        set connect = Server.CreateObject("ADODB.connection")
        connect.open connectString

        if src_abn = "all" and src_cat = "all" then
        conDB = "SELECT * FROM cont.csv"    
        elseif src_abn = "all" then
        conDB = "SELECT * FROM cont.csv WHERE " & src_cat & " = 'Yes'"  
        elseif src_cat = "all" then
        conDB = "SELECT * FROM cont.csv WHERE ucase(abn) LIKE ucase('%"+src_abn+"%')"   
        else 
        conDB = " SELECT * FROM cont.csv WHERE " & src_cat & " = 'Yes' AND ucase(abn) LIKE ucase('%"+src_abn+"%')"
        end if

        sconDB = "SELECT * FROM cont.csv"   

        set con = connect.execute(conDB)
        set scon = connect.execute(sconDB)
%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T00:49:41.300

希望我在这里指出显而易见的。jQuery 在客户端工作，可以通过 ajax 调用服务器以检索更多 HTML。您将无法以这种方式将 ASP 和 SQL “加载”到您的页面中。你可以做的是调用一个服务器端的 asp 页面，它会执行 ASP 和 SQL，然后返回一些 HTML 到你的页面。这里的线索是您正在调用“sql.htm”，默认情况下不会在服务器端执行任何操作。我本来希望调用像“sql.asp”这样的东西，它会执行服务器端然后返回对你有用的东西。

# c# - 如何在linq中有两个条件的两个表中进行选择

> ID：14248993
> 
> 赞同：0
> 
> 时间：2013-01-10T00:38:35.063
> 
> 标签：c#, linq-to-sql

我有两个有关系的表，我想用两个条件从它查询，如下所示：

```
var data = from d in db.table1
           where !d.isdeleted & d.table2.Where(dm => !dm.isdeleted)
           select d; 
```

但我有这个错误：

> 运算符“&”不能应用于“bool”和“System.Collections.Generic.IEnumerable”类型的操作数

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T02:50:21.937

你应该做两个改变

1\. 更改[`&`为`&&`](http://blog.dmbcllc.com/vs-and-vs-whats-the-difference)（这不是必需的，但在您希望在所有情况下都执行第二个操作数之前是一个很好的做法）

2\. 更改`IEnumerable<T> (or IQueryable<T>)`为`bool`。而不是`Where`，使用`Any`

```
var data = from d in db.table1
       where !d.isdeleted && d.table2.Any(dm => !dm.isdeleted) 
       select d; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T00:50:16.263

也许这就是你所追求的？

```
var data = from d in db.table1
           where !d.isdeleted && d.table2.All(dm => !dm.isdeleted)
           select d; 
```

这将从`table1`where`isdeleted`为 false 的行中选择行，并且所有相应的行都`table2`等于`isdeleted`false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T02:35:10.197

如果它们是相关的，你可以加入表格......

```
public class Program
{
    private static void Main(string[] args)
    {
        List<ItemA> itemATable = new List<ItemA>(new[]
            {
                new ItemA {Id = "A1", IsDeleted = true},
                new ItemA {Id = "A2", IsDeleted = false},
            });

        List<ItemB> itemBTable = new List<ItemB>(new[]
            {
                new ItemB {Id = "B1", ItemAId = "A1", IsDeleted = true},
                new ItemB {Id = "B2", ItemAId = "A1", IsDeleted = false},
                new ItemB {Id = "B3", ItemAId = "A2", IsDeleted = true},
                new ItemB {Id = "B4", ItemAId = "A2", IsDeleted = false},
            });

        var test = from a in itemATable
                   join b in itemBTable on a.Id equals b.ItemAId
                   where !a.IsDeleted && !b.IsDeleted
                   select new { a, b };
    }
}

public class ItemA
{
    public string Id { get; set; }
    public bool IsDeleted { get; set; }
}

public class ItemB
{
    public string Id { get; set; }
    public string ItemAId { get; set; }
    public bool IsDeleted { get; set; }
} 
```

# haskell - Haskell中类型的协积（不相交联合）的语法是什么？

> ID：14248995
> 
> 赞同：13
> 
> 时间：2013-01-09T22:06:08.057
> 
> 标签：haskell

考虑以下

```
data Point=Point{x::Float,y::Float}
data Shape=Circle{centre::Point,radius::Float}
           |Rectangle {uleft::Point,bRight::Point} 
```

这里的 Shape 类型是 Circle 和 Rectangle 两种类型的联产品。我可能想在别处重用 Circle 和 Rectangle 类型。所以这样做会很有用：

```
data Point=Point{x::Float,y::Float}
data Circle=Circle{centre::Point,radius::Float}
data Rectangle=Rectangle {uleft::Point,bRight::Point}
data Shape =Circle | Rectangle 
```

但是当我这样做时出现编译错误： Circle 被声明了两次。尝试这个的正确语法是什么，或者这不可能？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-10T01:20:46.430

Haskell 中类型的联积通常表示为`Either`：

```
data Either a b = Left a | Right b

type Shape = Either Circle Rectangle
-- so you have shapes as either Left c for some Circle c
-- or Right r for some Rectangle r 
```

这很好用，尽管由于技术原因[它不*完全*是 coproduct](http://www.haskell.org/haskellwiki/Hask#Hask_is_not_Cartesian_closed)。另一种常见的方法是定义一个像这样的类型：

```
data Shape = CircleShape Circle | RectangleShape Rectangle 
```

所以这就是你`CircleShape :: Circle -> Shape`的`RectangleShape :: Rectangle -> Shape`两次注射。

正如您在问题中所做的那样，说原始`Shape`是类型`Circle`和的副产品是错误的`Rectangle`，因为后两者不是类型。如果你想设置`Circle p r`既是 type 的值又是 type`Circle`的值`Shape`，那么这真的与 Haskell 类型系统的精神背道而驰（尽管有足够多的类型系统扩展可能会发生类似的事情）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-09T22:30:41.260

这不是直接可能的，但是您有几个选择。在这种情况下，我将使用 a`GADT`索引`DataKind`：

```
{-# LANGUAGE DataKinds, GADTs, KindSignatures #-}

data ShapeType = Circle | Rectangle

data Shape :: ShapeType -> * where
     CircleShape :: { centre :: Point, radius :: Float } -> Shape Circle
     RectangleShape { uleft :: Point, bRight :: Point } -> Shape Rectangle 
```

然后，当你想处理一般的形状时，你只需使用`Shape a`，如果你想要一个矩形或圆形，你分别使用`Shape Rectangle`or `Shape Circle`。

# entity-framework - 微风.js 一对多

> ID：14248997
> 
> 赞同：2
> 
> 时间：2013-01-10T00:38:51.047
> 
> 标签：entity-framework, breeze

我目前正在构建一个带有 Web API 和淘汰赛等的 SPA。到目前为止，我编写了自己的简单数据上下文，它工作得很好。我碰到了微风，认为这可能值得一试。特别是我希望在实体之间的导航上获得一种更简单的方法......

用微风加载实体或单个实体工作正常。使用导航属性似乎不起作用。导航属性始终为空，即使它是一对多的关系。

这是我的模型（简化）：

```
public class WorkdayHours
{
    public int Id { get; set; }

    public bool IsWorkDay { get; set; }
    ...
    public Byte WeekDay { get; set; }
}

public class Service
{
    public int Id { get; set; }
    public string DisplayName { get; set; }
    public virtual ICollection<WorkdayHours> BookableDays { get; set; }
}
public class Employee
{
    public int Id { get; set; }
    public string DisplayName { get; set; }
    public virtual ICollection<WorkdayHours> BookableDays { get; set; }
}
public class Shop
{
    public int Id { get; set; }
    public string DisplayName { get; set; }
    public virtual ICollection<WorkdayHours> BookableDays { get; set; }
} 
```

然后我在我的 SPA 中获取实体服务，如下所示：

```
var query = EntityQuery
            .from('Services')   
            .where('id', 'eq', serviceId)
            .expand('BookableDays'); 
```

当执行查询时，我得到请求的服务实体，除了 bookableDay 属性之外的所有数据始终是一个空数组。当我检查 Json 答案时，我看到 workdayHours 也被传输，并且微风甚至调用了我为这个实体定义的 ctors。但是，它们没有链接到 bookableDays 属性本身。

在检查生成的数据库模型时，EF 按预期在工作日为服务、员工和商店生成了外键。

微风不能有几个可选的外键吗？

建议和想法高度赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T00:42:27.123

Breeze 依赖于外键。我有一个类似的问题。这应该可以解决它：EF 也在为我生成 ForeignKeys 并且相关的实体仍然是空的。据我所知，微风需要外键字段的显式注释/配置。

```
public class Mvl
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public long MvlId{ get; set; }

    public DateTime CreatedAt { get; set; }

    [InverseProperty("Mvl")]
    public ICollection<MvlOP> MvlOps { get; set; }

    public DateTime? ReleasedAt { get; set; }
    public DateTime? LockedAt { get; set; }
    public DateTime? ClosedAt { get; set; }

    //[ConcurrencyCheck]
    //public int? RowVersion { get; set; }

    [Timestamp]
    public byte[] TimeStamp { get; set; }
}

public class MvlOP
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public long MvlOpId { get; set; }

    public long MvlId { get; set; }
    [ForeignKey("MvlId")]
    public Mvl Mvl { get; set; }

...
} 
```