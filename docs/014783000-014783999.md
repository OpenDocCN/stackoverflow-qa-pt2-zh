# StackOverflow 问答 14783000-14783999

# c# - 我可以使用助手类记录网站的访问者吗？

> ID：14783003
> 
> 赞同：0
> 
> 时间：2013-02-08T23:25:52.773
> 
> 标签：c#, asp.net, ip

我有一个托管内部服务器的 ASP.NET 网站。我的网站无法跟踪所有访问者。有没有办法跟踪/获取访问过/当前访问我的网站的访问者的所有外部 IP 地址的日志？通过谷歌，我发现 IIS 保留了一个日志，我在此处检查日志：C:\WINDOWS\system32\LogFiles\W3SVC1，但我无法控制每个主机的 IIS，我可以编写一个帮助程序类在一个只位于我的服务器上并记录进入的每个 Ip 的 ip 的 dll 中？特定服务器不提供任何网页，它只是图像和文本文档的目录列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:39:53.593

使用 ADSI 脚本或 WMI 来获取远程 WebServer 上的数据，

或者可能更好——[将 IIS 配置为在远程服务器](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/0b56f0c2-5043-48a6-9564-2de0cc29c81d.mspx?mfr=true)（可能是您的服务器）上记录数据。

# facebook-opengraph - 使用带有自定义对象类型的内置“关注”操作

> ID：14783004
> 
> 赞同：0
> 
> 时间：2013-02-08T23:25:55.083
> 
> 标签：facebook-opengraph, custom-object

我怎样才能做到这一点？我有一个自定义对象类型 - 例如，一个`Club`. 我希望我的应用程序的用户能够`Follow`使用`Club`，它有一个发布一般俱乐部更新等的经理。我可以想出的两种方法是：

A - 更改我的自定义`Club`对象类型以使用内置`Profile`对象类型。

B - 选择一个同义词`Follow`并尝试通过审查过程获得自定义操作。

我已经尝试作为自定义`Subscribe`操作提交并被拒绝。选项 A 似乎我会按照设计使用的方式使用该系统。

**澄清**

我不关心用户接收 Facebook 通知或“关注”俱乐部这个词的 facebook 意义。我只想向用户的时间线发布一些内容，例如“Sammy 在 MyApp 上关注了一个俱乐部”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:57:04.700

Facebook 允许您进行自定义的“关注”操作，但它们并没有让它变得明显……原因很明显。

1.  创建一个名称*不是* `follow`
2.  在下一页上，将名称更改为`follow`

这绝不是偷偷摸摸的。在多次因“跟踪”和“订阅”等同义操作而被拒绝以试图解决隐含的无自定义关注限制后，**审稿人最终建议**我使用“关注”这个词作为我的自定义行动。

# android - HTC OneVX 的 USB 设备驱动程序（USB 调试）

> ID：14783009
> 
> 赞同：12
> 
> 时间：2013-02-08T23:26:14.277
> 
> 标签：android, device-driver

我有一部 HTC One VX 手机，我想为它开发一个应用程序。

我得到了 SDK、IDE、JDK 和我需要的一切。[http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)我试图从 eclipse 在我的手机上运行我的应用程序。但我的设备没有显示在 Android 设备选择器窗口中。我猜这是因为我没有手机的驱动程序，但我似乎找不到它。

我的手机设置为“ **USB 调试**”。

该网站-> [http://developer.android.com/tools/extras/oem-usb.html#Drivers](http://developer.android.com/tools/extras/oem-usb.html#Drivers)

说要为我的电脑安装 OEM USB 驱动程序。我有一个戴尔已升级到 Windows 7，服务标签为 BLZXLC1。我的所以我无法从该站点获取驱动程序，因为我已经升级了我的操作系统。

但是我已经有了 USB 驱动程序，对吧？在设备管理器中，我在“其他设备”下有一个“Android 手机”，它没有驱动程序。我需要做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-08T23:33:59.750

从 HTC下载并安装**HTC Sync Manager ：http:**
[//www.htc.com/www/software/htc-sync-manager/download/](http://www.htc.com/www/software/htc-sync-manager/download/)

除了作为 HTC 设备的官方同步程序外，它还包含`USB device drivers`Windows 所必需的，与 (USB) `Android Debug Bridge`( *ADB* ) 一起使用。

HTC Sync Manager 支持以下设备（截至*2013 年 2 月 9 日*）：

HTC J Butterfly、HTC Droid DNA、HTC One VX、HTC One SV、HTC One X+、HTC One S 特别版、HTC Desire X、HTC One SC、HTC One SU、HTC One X、HTC One XL、HTC One XC , HTC One S, HTC One V, HTC EVO 4G LTE, HTC Droid Incredible 4G, HTC J, HTC Desire C, HTC Desire VC, HTC Desire V

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T05:45:33.760

在将 HTC 手机与 Eclipse 连接时遇到问题的人。他们必须从 HTC 网站安装 HTC-SYNC。htc sync 也包含了 USB 调试驱动。只需安装并享受。100% 成功了！！

就是这个链接

## **[http://www.htc.com/au/support/content.aspx?id=6196](http://www.htc.com/au/support/content.aspx?id=6196)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-19T06:17:00.557

您好，仅下载此链接的驱动程序。使用运行 Sense 3.6 或更低版本的设备的 HTC 用户，下载版本 4.5.0.001.exe 或更低版本。

[HTC 驱动程序](https://www.mediafire.com/folder/i2kfapzwunvgu/HTC)

# c - C中的一般地图操作

> ID：14783010
> 
> 赞同：1
> 
> 时间：2013-02-08T23:26:16.317
> 
> 标签：c

如何在 C 中的数组上定义通用映射操作？

理想情况下，我想要像 python 的 map(function,array) ~~ 但是作为一个宏。我相信这将类似于 C++ 的 std::transform，但会在 C 中，并且不使用迭代器。

（这将是一元操作）我在想这样的事情：

```
template <class T*, class U*,size_t N>
T* map(T (*func)(U), U* arr,size_t N)
{
   T* tmp = (T*)malloc(sizeof(T) * N);
   size_t i;
   for(i=0;i<N;i++)
   {
       *(tmp+i) = *func(*(arr+i));
   }
} 
```

...但当然模板是 C++ 中的..所以我怎么能 1）做后者和 2）如果可以的话，你能修复上面的代码片段吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:41:12.953

对于这样的模板，有一个相当简单的宏转换；主要的语法问题是你不能返回结果数组，写入它的变量必须是另一个参数。

```
#define map(func_, input_, output_, type_, n_) do { \
    output_ = xmalloc(sizeof(type_) * (n_));        \
    size_t i_;                                      \
    for (i_ = 0; i_ < (n_); i_++)                   \
        output_[i_] = func_(input_[i_]);            \
  } while (0) 
```

如果您注意编译器警告，这并不像看起来那样类型不安全。但是，如果使用此宏的任何实际参数不是简单的标识符，则*不是特别安全。*最重要的是，如果任何实际参数有副作用，就会发生*灾难性的事情。*

这可以解决，无法返回结果数组也可以解决，但前提是您愿意使用 GNU 扩展...

```
#define gnumap(func_, input_, type_, n_) ({                    \
    __typeof(func_)   func__   = (func_);                      \
    __typeof(input_)  input__  = (input_),                     \
                      output__ = xmalloc(sizeof(type_) * n__); \
    __typeof(n_)      n__      = (n_),                         \
                      i__;                                     \
    for (i__ = 0; i__ < n__; i__++)                            \
        output__[i__] = func__(input__[i__]);                  \
    /* return */ output__;                                     \
  }) 
```

我会在现实生活中做这些吗？可能不是，但有时它确实是最糟糕的可用选项。把它想象成比用汇编语言重写那个关键的内部循环还差一步。

（`xmalloc`如果您不熟悉它，它是用户编写的包装器的常规名称，`malloc`它要么成功要么使整个程序崩溃。我在这里使用它来回避如何应对`malloc`失败的问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:32:28.700

因此，您可以编写一个函数，该函数接受一个函数指针和一个`void *`（或`char *`）数据，以及一个数据大小。

我当然不会只使用宏来执行此操作，但您可能有一个宏可以执行以下操作：

```
 #define MAP(func, type, arr, size) map(func, sizeof(type), arr, size) 
```

并且`map`是我上面描述的功能。

# php - 如果选择了一个播放器，如何停止所有音频播放器的播放？

> ID：14783013
> 
> 赞同：0
> 
> 时间：2013-02-08T23:26:21.590
> 
> 标签：php, javascript, jquery, html, jplayer

我在这里有一个演示：[演示](http://helios.hud.ac.uk/u0867587/Mobile_app/Text20.php)

在演示中，我有 2 个问题，在这些问题中，它包含 jplayer 音频播放器，它播放属于每个问题的音频。

所以在演示问题 1 中有 2 段音频，因此为什么问题 1 有 2 个音频播放器，每个播放器一个音频文件。在问题 2 中，它只有一个音频播放器，因为它只包含一个音频文件。现在下面的代码将显示此内容，如果问题没有音频文件，则显示空白，否则显示每个音频文件的音频播放器。

唯一的问题是，如果你点击一个音频播放器，那么所有的音频播放器都在播放，播放他们的文件。我想要的是，如果用户使用音频播放器，则只有属于该音频播放器的音频文件应该播放，仅此而已。这与其他控件相同，如果用户在音频播放器中使用控件，则它仅控制该音频播放器。

但是我需要做什么才能解决这个问题？

下面是代码：

```
<?php

foreach ($arrQuestionId as $key=>$question) {

?>

<div class='lt-container'>
<p><?php echo htmlspecialchars($arrQuestionNo[$key]) . ": " .  htmlspecialchars($arrQuestionContent[$key]); ?></p>

<?php

        //start:procedure audio
        $aud_result = '';
        if(empty($arrAudioFile[$key])){
          $aud_result = '&nbsp;';
        }else{

$j = 0;
foreach ($arrAudioFile[$key] as $a) { 

        $info = pathinfo('AudioFiles/'.$a); 
?>

<script type="text/javascript">   
    $(document).ready(function(){
  $("#jquery_jplayer_1-<?php echo $key.'-'.$j; ?>").jPlayer({
    ready: function () {
      $(this).jPlayer("setMedia", {
        <?php echo $info['extension'];?>: "<?php echo "AudioFiles/".$a; ?>"
      });
    },
    solution:"flash,html",
    swfPath: "jquery",
    supplied: "<?php echo $info['extension'];?>"
  });
}); 
</script>
  <div id="jquery_jplayer_1-<?php echo $key.'-'.$j; ?>" class="jp-jplayer"></div>
  <div id="jp_container_1" class="jp-audio">
    <div class="jp-type-single">
      <div class="jp-gui jp-interface">
        <ul class="jp-controls">
          <li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li>
          <li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li>
          <li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>
          <li><a href="javascript:;" class="jp-mute" tabindex="1" title="mute">mute</a></li>
          <li><a href="javascript:;" class="jp-unmute" tabindex="1" title="unmute">unmute</a></li>
          <li><a href="javascript:;" class="jp-volume-max" tabindex="1" title="max volume">max volume</a></li>
        </ul>
        <div class="jp-progress">
          <div class="jp-seek-bar">
            <div class="jp-play-bar"></div>
          </div>
        </div>
        <div class="jp-volume-bar">
          <div class="jp-volume-bar-value"></div>
        </div>
        <div class="jp-time-holder">
          <div class="jp-current-time"></div>
          <div class="jp-duration"></div>
          <ul class="jp-toggles">
            <li><a href="javascript:;" class="jp-repeat" tabindex="1" title="repeat">repeat</a></li>
            <li><a href="javascript:;" class="jp-repeat-off" tabindex="1" title="repeat off">repeat off</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
<?php $j++; 
}

}
//end:procedure audio
?>

</div>

<?php

}

?> 
```

更新：

```
 $("#jquery_jplayer_1-<?php echo $key.'-'.$j; ?>").jPlayer({
    ready: function () {
      $(this).jPlayer("setMedia", {
        <?php echo $info['extension'];?>: "<?php echo "AudioFiles/".$a; ?>"
      });
    },
    $(this).bind($.jPlayer.event.play, function() { //ERROR HERE
      $(this).jPlayer("pauseOthers");
    },
    solution:"flash,html",
    swfPath: "jquery",
    supplied: "<?php echo $info['extension'];?>"
  }); 
```

上面的代码给了我这个错误：缺少：属性列表之后

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:11:01.353

我们在最近的一个项目中遇到了这个问题。请参阅此 jPlayer 演示：

[http://www.jplayer.org/latest/demo-03/](http://www.jplayer.org/latest/demo-03/)

根据该页面，“已使用额外的 $.jPlayer.event.play 事件处理程序来避免 jPlayer 一起玩。”

在 jPlayer 属性中添加播放功能，如下所示：

```
 $("#jquery_jplayer_1-<?php echo $key.'-'.$j; ?>").jPlayer({
    ready: function () {
      $(this).jPlayer("setMedia", {
        <?php echo $info['extension'];?>: "<?php echo "AudioFiles/".$a; ?>"
      });
    },
    play: function() { // To avoid both jPlayers playing together.
      $(this).jPlayer("pauseOthers");
    },
    solution:"flash,html",
    swfPath: "jquery",
    supplied: "<?php echo $info['extension'];?>"
  }); 
```

# javascript - 如何将 mouseenter/mouseleave 菜单代码更改为 javascript 的 onclick 菜单？

> ID：14783020
> 
> 赞同：-1
> 
> 时间：2013-02-08T23:27:24.397
> 
> 标签：javascript, jquery, menu, onclick, hover

我是 javascript 的新手，我正在尝试制作一个 onclick 下拉菜单。我希望它看起来像这样： http: [//www.instantshift.com/demo/dropdown_menu/](http://www.instantshift.com/demo/dropdown_menu/) 但这是 mouseenter/mouseleave（换句话说，悬停），而我希望它是 onclick。如何更改此代码以使其成为 onclick？您还可以为我提供 onclick 的 jquery 吗？

我当前的悬停代码（mouseenter/mouseleave 菜单）如下：

```
$(function(){
$('.dropdown').mouseenter(function(){
    $('.sublinks').stop(false, true).hide();

    var submenu = $(this).parent().next();

    submenu.css({
        position:'absolute',
        top: $(this).offset().top + $(this).height() + 'px',
        left: $(this).offset().left + 'px',
        zIndex:1000
    });

    submenu.stop().slideDown(300);

    submenu.mouseleave(function(){
        $(this).slideUp(300);
    });
});
});
</script> 
```

再一次，我想将其更改为 onclick。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:37:12.333

我认为您只需单击即可触发菜单，然后任何其他单击都会将其关闭。

所以，简单的修改：

```
$(function() {
    $('.dropdown').click(function() {
        $('.sublinks').stop(false, true).hide();

        var submenu = $(this).parent().next();

        submenu.css({
            position: 'absolute',
            top: $(this).offset().top + $(this).height() + 'px',
            left: $(this).offset().left + 'px',
            zIndex: 1000
        });

        submenu.stop().slideDown(300);

       //click anywhere outside the menu
       $(document).click(function() {
            var $el = $(this);
            $el.not('.dropdown') && $el.slideUp(300);
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:34:15.483

代替

```
$('.dropdown').mouseenter(function(){ 
```

和

```
$('.dropdown').click(function(){ 
```

# xcode - iWebDriver - iphone Selenium

> ID：14783021
> 
> 赞同：5
> 
> 时间：2013-02-08T23:27:32.837
> 
> 标签：xcode, ipad, selenium-webdriver, selenium-grid

我之前已经让它工作了，所以我知道它是可能的，但是在新机器上尝试它。

我有 OS X 10.8.2、Xcode 4.6、iPad 6.1，并尝试这样做：

[iphone驱动硒](http://code.google.com/p/selenium/wiki/IPhoneDriver)

我到了在 Xcode 中构建项目并得到这个错误的地步：

检查依赖项

没有要编译的架构（ONLY_ACTIVE_ARCH=YES，active arch=armv7，VALID_ARCHS=i386）。

我的架构设置为：标准（armv7，armv7s），构建活动：是，有效架构：armv7s armv7，

该项目是代码签名的。任何帮助表示赞赏。我知道我错过了一些明显的东西。如果我遗漏了任何内容或您需要更多信息，请告诉我。我查看了以下 SO 问题和其他类似问题：

[SO链接1](https://stackoverflow.com/questions/3549478/iphone-compiler-fails-no-architectures-to-compile-for) [SO链接2](https://stackoverflow.com/questions/4915953/upgrading-to-xcode-4-error-no-architectures-to-compile-for)

我希望有人对 iWebDriver 有特定的经验。我最终将在 GRID 2 配置中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T19:21:19.863

“armv7 armv7s i386”是它在项目和目标的所有“有效架构”字段（调试和发布）上想要的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T17:12:43.820

我在构建设置配置中遇到了同样的错误，修复如下：

```
Architectures --Standard(armv7,armv7s) - $

Valid Architectures --i386 armv7s 
```

# c - 设置结构变量 - C

> ID：14783022
> 
> 赞同：2
> 
> 时间：2013-02-08T23:27:43.913
> 
> 标签：c, memory, struct

我在以下类型的布局中有一些代码，我相信`topExample`/`botExample`调用时没有正确设置`addTopBotExample`。我认为这是由于函数堆栈上的顶部 bot 变量因此在函数结束时被清除？我有一种感觉，也许我需要先`malloc`记住记忆，但我不确定我将如何去做这件事，即使它是正确的方法。

```
typedef struct Example Example;
struct Example {
   /* normal variables ...*/
   Example *topExample;
   Example *botExample;
};

....

void addTopBotExample(Example **example, int someVariable) {
    Example top = createTopExample(int someVariable); //(createTopExample returns a
                                                      //type Example based on some input)
    Example bot = createBotExample(int someVariable);
    (*example)->topExample = &top;
    (*example)->botExample = &bot;
    return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:38:07.090

如果`createTopExample`不分配内存，那么当它被多次调用时，这将导致问题。重写`createTopExample`and`createBotExample`使用`malloc`并返回一个`Example*`. 像这样的东西：

```
Example* createTopExample(stuff)
{
    Example *example = malloc(sizeof(Example)); 
    // ... stuff you do
    return example;
} 
```

然后你`addTopBotExample`会看起来像这样：

```
 void addTopBotExample(Example **example, int someVariable) {
     if ((*example)->topExample)
         free((*example)->topExample)
     if ((*example)->botExample)
         free((*example)->botExample)
     (*example)->topExample = createTopExample(int someVariable);
     (*example)->botExample = createBotExample(int someVariable);
     return;
 } 
```

请注意，这`addTopBotExample`将`free`在再次调用之前分配内存，`malloc`但在程序结束之前，您需要调用`free`任何`Example`使用此`addTopBotExample`函数的 lingering ：

```
free(exampleInstanceThatWasPassedIntoAddTopBotExampleAtSomePoint.topExample);
free(exampleInstanceThatWasPassedIntoAddTopBotExampleAtSomePoint.botExample); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:40:38.803

哦，这很糟糕。addTopBotExample() 函数中的表达式“Example top”在堆栈上分配了该对象。退出该功能后将被丢弃。（下一行的“Example bot”也是如此。）这样的事情会更好：

```
void addTopBotExample(Example **example, int someVariable) {
  Example *top = createTopExample(someVariable); // NOTE THE *
  Example *bot = createBotExample(someVariable); // NOTE THE *

  (*example)->topExample = top; // NOT &top !!
  (*example)->botExample = bot; // NOT &bot !!
  return;
} 
```

并且您需要编写 createTopExample 和 createBotExample 以便它们返回指针：

```
#include <stdlib.h> // For malloc!
Example *createTopExample(stuff)  // Note *. It's returning a pointer.
{
  Example *example = malloc(sizeof(Example)); // Allocate on the HEAP. Lives after this function call.

  // Fill in the fields of example.
  example->field1 = 25; // Note the "->": you're dereferencing a pointer.
  example->title = "Example title";

  return example;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:37:07.887

你已经拥有了一切。分配`Example`in`createTopExample`或`createTopExample`

```
Example *createTopExample(int someVariable)
{
    Example *x = malloc(sizeof(Example));
    /* initialize x */
    return x;
} 
```

并且在`addTopBotExample`

```
void addTopBotExample(Example *example, int someVariable) {
    Example *top = createTopExample(int someVariable); //(createTopExample returns a
                                                       //type Example based on some input)
    Example *bot = createBotExample(int someVariable);
    example->topExample = top;
    example->botExample = bot;
    return;
} 
```

# php - Apache LocationMatch 授权所有子路径 PHP

> ID：14783034
> 
> 赞同：0
> 
> 时间：2013-02-08T23:28:51.367
> 
> 标签：php, apache, authorization

我们有一个 PHP 站点：

网站

我们希望根目录中的所有子路径都需要基本身份验证。例如

site.com - 无需身份验证

site.com/subpath 需要身份验证

我们有这个指令：

```
<LocationMatch "^/.+$">

  AuthName "members Only"
  AuthType Basic
  AuthBasicProvider file
  AuthUserFile /Applications/MAMP/conf/apache/extra/auth-pass-file
  Require valid-user
 </LocationMatch> 
```

[但是，当我们访问http://site.com/](http://site.com/)或[http://site.com](http://site.com)时，它要求输入密码。

有人可以提出一个解决方案，以便只要求对子路径进行授权吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:34:09.117

`<LocationMatch "^/.*/.+$">`应该管用。您的 LocationMatch 实际上是选择根目录中的所有内容，您需要向下一层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:37:12.907

我们添加了要检查的特定目录（存在的目录），并在人们试图寻找不存在的页面时创建了错误重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-03T18:26:32.200

因为 authz 规则不仅适用于实际请求的 /，而且适用于扩展的内容 - 例如 /index.html

不幸的是，您需要单独允许...

# django - 在 django 中调用内部视图函数

> ID：14783036
> 
> 赞同：1
> 
> 时间：2013-02-08T23:28:55.660
> 
> 标签：django, function, request

我想从 django 中的另一个函数调用一个函数。函数看起来像这样

```
def main_view(request):
    if request.method == 'GET': 
```

我不想打开 main_view 的 url，以便用户可以直接访问这个 url，而是他们应该面对一个登录页面（只是很多应该选择四个正确的复选框），然后提交之后，他们应该来main_view 函数正在渲染的模板。

但是，我如何实际调用需要请求 GET 输入的内部函数？调用函数时有没有办法发出 GET 请求？

//迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:30:40.583

您可以将来自另一个视图的请求传递给该视图，如下所示：

```
def my_public_view(request):
    if user_passed_checkbox_test():
        return main_view(request) 
```

# geometry - 如何找到属于同一条线的两条线段的公共点的轨迹

> ID：14783039
> 
> 赞同：1
> 
> 时间：2013-02-08T23:29:01.710
> 
> 标签：geometry, segments

我阅读了各种相关的答案。特别是在这里（[你如何检测两条线段相交的位置？](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect/563240#563240)）很好地解释了如何找到两条线段之间的交点并检查平行度以及它们是否属于同一条线。我按照这个好主意编写了一个 fortran 程序。现在的问题包括当两条线段属于同一条线时找到联合线段。在这里，我找到了一个 C++ 代码（[检测两个重合线段的重合子集](https://stackoverflow.com/questions/2255842/detecting-coincident-subset-of-two-coincident-line-segments)），但没有解释，我无法阅读 C++，但只能阅读 Fortran（这是一个有用的图像描述问题，发布在另一个问题中，但没有有用的答案[http： //judark.myweb.hinet.net/parallel.JPG](http://judark.myweb.hinet.net/parallel.JPG)）。找到属于同一条线的两个段的公共点（即联合段，即定义该联合的两个点）的轨迹的最佳语言无关算法是什么？我已经设法通过“如果”计算点之间的所有曼哈顿距离（[http://en.wikipedia.org/wiki/Taxicab_geometry](http://en.wikipedia.org/wiki/Taxicab_geometry)）来做到这一点，但我想知道是否有更好的方法来做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T03:27:08.973

如果这两个线段在同一条线上并且确实重叠，那么并集就是四个端点中相距最远的两个端点之间的线段。因此，只需计算所有平方距离（无需计算平方根）并识别具有最大距离的对。这种方法可以很好地处理许多退化的情况，包括所有 4 个点重合并且两个相等点的并集就是那个点的情况。

# matlab - 设置matlab图形的比例

> ID：14783043
> 
> 赞同：0
> 
> 时间：2013-02-08T23:29:21.677
> 
> 标签：matlab

![在此处输入图像描述](../Images/d6cd956787c7eb5474eeaba4d5934b5a.png)

在上图中，我想把 10^1 改成更漂亮的方式，比如 10_superscript(1)。

谁能帮我？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:47:04.543

据我所知，刻度标签不支持 Latex 样式格式。但是这里描述了一种方法[http://blogs.mathworks.com/pick/2007/09/24/tex-interpreter-in-x-tick-and-y-tick-labels/](http://blogs.mathworks.com/pick/2007/09/24/tex-interpreter-in-x-tick-and-y-tick-labels/)可能对您有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:13:33.777

你用的是什么版本的matlab？在 2012b 中，它已经是乳胶风格了。

# javascript - 同步使用 getScript

> ID：14783046
> 
> 赞同：23
> 
> 时间：2013-02-08T23:29:32.490
> 
> 标签：javascript, jquery, ajax, getscript

我正在编写一个需要广泛使用 getScript 的引擎。为了便于使用，我已经将它推入了自己的函数中，但现在我需要确保函数本身是同步的。不幸的是，我似乎无法让 getScript 等到它加载的脚本实际完成加载后再继续。在进行调用之前，我什至尝试将 jQuery 的 ajax asynch 属性设置为 false。我正在考虑使用 jQuery 的 when/done 协议，但我似乎无法理解将其放置在函数中并使函数本身同步的逻辑。任何帮助将不胜感激！

```
function loadScript(script){
//Unrelated stuff here!!!
$.when(
$.getScript(script,function(){
    //Unrelated stuff here!!!
})).done(function(){
    //Wait until done, then finish function
});
} 
```

循环代码（根据要求）：

```
for (var i in divlist){
        switch($("#"+divlist[i]).css({"background-color"})){
            case #FFF:
            loadScript(scriptlist[0],divlist[i]);
            break;
        case #000:
            loadScript(scriptlist[2],divlist[i]);
            break;
        case #333:
            loadScript(scriptlist[3],divlist[i]);
            break;
        case #777:
            loadScript(scriptlist[4],divlist[i]);
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-07-26T16:22:44.557

这对我有用，可能会对你有所帮助。

```
$.ajax({
    async: false,
    url: "jui/js/jquery-ui-1.8.20.min.js",
    dataType: "script"
}); 
```

基本上，我只是绕过了速记符号并添加到`async: false`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-09T02:34:45.850

正如我所说，将Ajax 调用与promise 对象链接起来相对容易。现在，它不明白*为什么*必须一个接一个地加载脚本，但你会有理由这样做。

`switch`首先，如果您只使用不同的参数调用相同的函数，我会删除该语句。例如，您可以将所有脚本 URL 放在地图中：

```
var scripts = {
    '#FFF': '...',
    '#000': '...'
    // etc.
}; 
```

您可以通过简单地从传递给[`.then` *^([docs])*](http://api.jquery.com/deferred.then/)的回调中返回另一个 Promise 来链接 Promise 。你需要做的就是从一个 promise 或 deferred 对象开始：

```
var deferred = new $.Deferred();
var promise = deferred.promise();

for (var i in divlist) {
    // we need an immediately invoked function expression to capture
    // the current value of the iteration 
    (function($element) {
        // chaining the promises, 
        // by assigning the new promise to the variable
        // and returning a promise from the callback
        promise = promise.then(function() {
            return loadScript(
                scripts[$element.css("background-color")], 
                $element
            );
        });
    }($('#' + divlist[i])));
}

promise.done(function() {
    // optional: Do something after all scripts have been loaded
});

// Resolve the deferred object and trigger the callbacks
deferred.resolve(); 
```

在`loadScript`中，您只需返回返回的承诺`$.getScript`或返回的承诺`.done`：

```
function loadScript(script_url, $element){
    // Unrelated stuff here!!!

    return $.getScript(script_url).done(function(){
        //  Unrelated stuff here
        // do something with $element after the script loaded.
    });
} 
```

脚本将按照循环中的访问顺序全部调用。请注意，如果`divlist`是一个数组，你真的应该使用普通`for`循环而不是`for...in`循环。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-27T13:13:47.153

你知道`$.getScript` [接受](http://api.jquery.com/jquery.getscript/)脚本加载后同步调用的回调函数吗？

例子：

```
$.getScript(url,function(){
//do after loading script
}); 
```

我还有 2 个解决方案：一个[纯 js](https://stackoverflow.com/a/24778028/669677) 一个和一个用于[多个 js load](https://stackoverflow.com/a/25328848/669677)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-08T23:46:29.877

尝试这种方式，使用延迟对象创建数组并使用 $.when 和“apply”

```
var scripts = [
    'src/script1.js',
    'src/script2.js'
];

var queue = scripts.map(function(script) {
    return $.getScript(script);
});

$.when.apply(null, queue).done(function() {
    // Wait until done, then finish function
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-09T00:01:11.170

```
var getScript = function(url) {
    var s = document.createElement('script');
    s.async = true;
    s.src = url;
    var to = document.getElementsByTagName('script')[0];
    to.parentNode.insertBefore(s, to);
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-19T12:59:58.203

@Felix Kling 的回答是一个很好的开始。但是，我发现如果我想“功能化”它`.done()`，在返回结果末尾附加的整体存在一个小问题。您需要循环内`.getScripts()`链式迭代的最后一个承诺。`.getScript()`这是他的解决方案的修改版本（谢谢，顺便说一句）。

## 插入：

```
(function ($) {
    var fetched = new function () {
            this.scripts = [];
            this.set = [];

            this.exists = function (url) {
                var exists = false;

                $.each(this.set, function (index, value) {
                    if ((url || '') === value) {
                        exists = true;

                        return false;
                    }
                });

                return exists;
            };

            this.buildScriptList = function () {
                var that = this;

                that.set = [];

                $('script').each(function () {
                    var src = $(this).attr('src') || false;

                    if (src) {
                        that.set.push(src);
                    }
                });

                $.merge(this.set, this.scripts);

                return this;
            };
        },
        getScript = $.getScript;

    $.getScript = function () {
        var url = arguments[0] || '';

        if (fetched.buildScriptList().exists(url)) {
            return $.Deferred().resolve();
        }

        return getScript
            .apply($, arguments)
            .done(function () {
                fetched.scripts.push(url);
            });
    };

    $.extend({
        getScripts: function (urls, cache) {
            if (typeof urls === 'undefined') {
                throw new Error('Invalid URL(s) given.');
            }

            var deferred = $.Deferred(),
                promise = deferred.promise(),
                last = $.Deferred().resolve();

            if (!$.isArray(urls)) {
                urls = [urls];
            }

            $.each(urls, function (index) {
                promise = promise.then(function () {
                    last = $.getScript(urls[index]);

                    return last;
                });
            });

            if (Boolean(cache || false) && !Boolean($.ajaxSetup().cache || false)) {
                $.ajaxSetup({cache: true});

                promise.done(function () {
                    $.ajaxSetup({cache: false});
                });
            }

            deferred.resolve();

            return last;
        }
    });
})($); 
```

您可以忽略 fetched 函数（我实现它以减少潜在的冗余调用 - 这就是我劫持的原因`.getScript()`）并查看变量在方法`last`内的设置位置`.getScripts()`。它默认为已解析的延迟对象，因此如果 urls 数组为空，则将其传递给返回的结果以附加外部`.done()`调用。否则，它将不可避免地从链式`.getScript()`调用中分配到最后一个 Promise 对象，从而确保所有内容从函数外部保持同步。

如果您在将其返回给调用者之前将其解析，则返回最初创建的延迟对象将不起作用（这是您应该按照[jQuery 的官方文档](https://api.jquery.com/deferred.resolve/)执行的操作）。

## 例子：

```
function loadStuff(data) {
    var version = {
        'accounting': '1.2.3',
        'vue': '1.2.3',
        'vueChart': '1.2.3'
    };

    $.getScripts([
        'https://cdnjs.cloudflare.com/ajax/libs/accounting.js/' + version.accounting + '/accounting.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/vue/' + version.vue + '/vue.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/vue-chartjs/' + version.vueChart + '/vue-chartjs.min.js'
    ], true)
        .done(function () {
            // do stuff
        })
        .fail(function () {
            throw new Error('There was a problem loading dependencies.');
        });
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-08T23:31:59.507

只需创建一个脚本节点，将其 src 属性设置为您要加载的 JS，然后将其附加到头部：

```
var myScript = document.createElement('script');
myScript.src = "thesource.js";
document.head.appendChild(myScript); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-03-30T13:40:38.293

这就是我所做的

```
function loadJsFile(filename) {
    $.ajaxSetup({
        cache: true
    });

    var dloadJs = new $.Deferred();
    $.when(dloadJs).done(function () {
        $.ajaxSetup({
            cache: false
        });
    });

    dloadJs.resolve(
         $.getScript(filename, function () { })
    );
} 
```

# java - 对代理的 HttpServlet 请求使用原始 URL 请求

> ID：14783049
> 
> 赞同：0
> 
> 时间：2013-02-08T23:29:38.633
> 
> 标签：java, servlets, request, servlet-filters

我有一个 Apache 代理，它将对 /foo/bar 的请求重定向到在 /foo 上运行的 Web 应用程序。问题是我的过滤器链中有一个 Servlet 过滤器，它要求请求仍然是 /foo/bar 格式。这是一个我无法更改的身份验证过滤器，这导致登录到 /foo 而不是 /foo/bar 后重定向不正确。

在其他类似的线程之后，我尝试将 RequestDispatcher.forward 与修改后的请求和 HttpServletResponse.sendRedirect 一起使用来修改 URL。第一种方法似乎跳过了我的过滤器链的其余部分，第二种方法转到代理，然后将 URL 修改回 /foo。

有没有办法解决。理想情况下，我想要的只是身份验证过滤器获取 /foo/bar 请求，而链的其余部分获取 /foo 请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T11:41:09.927

看起来 HttpServletRequestWrapper 是我想要的。只需要扩展它并提供 getRequestURI 和 getRequestURL 覆盖（就像[这里描述的](http://publib.boulder.ibm.com/infocenter/wmqfte/v7r0/index.jsp?topic=/com.ibm.wmqfte.doc/web_admin_servlet_filters.htm)那样）。然后需要在我的身份验证过滤器之前和之后添加过滤器映射，以根据需要转换请求 URL/URI。

# android - 如何在android的结果屏幕中显示来自意图的数据？

> ID：14783052
> 
> 赞同：0
> 
> 时间：2013-02-08T23:30:03.783
> 
> 标签：android, android-listview

一旦用户单击列表中的一个项目，我在屏幕 A 中有列表视图，它导航到下一个屏幕，他可以在其中查看所选项目的更多详细信息。

用户可以在屏幕 B 中修改该项目。一旦用户返回屏幕 A，更改就完成了，该列表必须更新如何操作。

我使用的列表是静态的。

我使用的代码是：

```
ArrayList<ItemDetails> image_details = GetSearchResults();

    final ListView lv1 = (ListView) findViewById(R.id.listV_main);
    lv1.setAdapter(new ItemListBaseAdapter(this, image_details));

    lv1.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> a, View v, int position, long id) { 
            Object o = lv1.getItemAtPosition(position);
            ItemDetails obj_itemDetails = (ItemDetails)o;
            Intent i = new Intent(DemoPastSubstitutions.this,DemoPastSubstitutionsDetail.class);
            i.putExtra("substitutesName", obj_itemDetails.getName());
            i.putExtra("positionCompany", obj_itemDetails.getDesignation());
            i.putExtra("phone", obj_itemDetails.getphone());
            i.putExtra("email", obj_itemDetails.getEmail());
            i.putExtra("Date", obj_itemDetails.getDates());
            i.putExtra("imageNo", obj_itemDetails.getImageNumber());
            startActivity(i);
                }  
    });
}
private ArrayList<ItemDetails> GetSearchResults(){
    ArrayList<ItemDetails> results = new ArrayList<ItemDetails>();
    ItemDetails item_details = new ItemDetails();

        item_details.setName("Diesel Dean");
        item_details.setDates("From 02/19/2013 - 04/03/2013");
        item_details.setDesignation("Manager");
        item_details.setphone("+9164589022");
        item_details.setEmail("diesel.dean@sap.com");
        item_details.setImageNumber(1);

        item_details = new ItemDetails();
        item_details.setName("Kate Hudson");
        item_details.setDates("From 01/23/2013 - 02/15/2013");
        item_details.setDesignation("Manager");
        item_details.setphone("+916458902");
        item_details.setEmail("kate.hudson@sap.com");
        item_details.setImageNumber(2);
        results.add(item_details);

        item_details = new ItemDetails();
        item_details.setName("Kevin James");
        item_details.setDates("From 01/01/2013 - 01/02/2013");
        item_details.setDesignation("Manager");
        item_details.setphone("+9164589023");
        item_details.setEmail("kevin.james@sap.com");
        item_details.setImageNumber(3);
        results.add(item_details);

        item_details = new ItemDetails();
        item_details.setName("Gray Cruz");
        item_details.setDates("From 01/10/2013 - 01/20/2013");
        item_details.setDesignation("Manager");
        item_details.setphone("+9164589025");
        item_details.setEmail("gray.cruz@sap.com");
        item_details.setImageNumber(4);
        results.add(item_details);
            return results;
} 
```

基础适配器代码：private static ArrayList itemDetailsarrayList；

```
private Integer[] imgid = {
        R.drawable.p1,
        R.drawable.bb2,
        R.drawable.p2,
        R.drawable.bb5,
        R.drawable.bb6,
        R.drawable.d1
        };

private LayoutInflater l_Inflater;

public ItemListBaseAdapter(Context context, ArrayList<ItemDetails> results) {
    itemDetailsrrayList = results;
    l_Inflater = LayoutInflater.from(context);
}

public int getCount() {
    return itemDetailsrrayList.size();
}

public Object getItem(int position) {
    return itemDetailsrrayList.get(position);
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    if (convertView == null) {
        convertView = l_Inflater.inflate(R.layout.item_details_view, null);
        holder = new ViewHolder();
        holder.txt_itemName = (TextView) convertView.findViewById(R.id.name);
        holder.txt_itemDescription = (TextView) convertView.findViewById(R.id.itemDescription);
        //holder.txt_itemPrice = (TextView) convertView.findViewById(R.id.price);
        holder.itemImage = (ImageView) convertView.findViewById(R.id.photo);

        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    holder.txt_itemName.setText(itemDetailsrrayList.get(position).getName());
    holder.txt_itemDescription.setText(itemDetailsrrayList.get(position).getDates());
    holder.itemImage.setImageResource(imgid[itemDetailsrrayList.get(position).getImageNumber() - 1]);

    return convertView;
}

static class ViewHolder {
    TextView txt_itemName;
    TextView txt_itemDescription;
    //TextView txt_itemPrice;
    ImageView itemImage;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:42:18.450

*   使用 startActivityForResult() 代替 startActivity() 并覆盖屏幕 A 中的 onActivityResult()
*   将项目索引与其他数据一起传递到屏幕 B
*   在屏幕 B 中修改后 - 将所有数据连同索引一起发送回屏幕 A，通过 Bundle（在屏幕 B 中完成活动之前使用 setResult()）。
*   完成屏幕 B 后，您会在 onActivityResult() 中收到回调，您可以在其中提取数据并更新列表。
*   更新列表中的数据后，不要忘记调用 ListAdapter.notifyDataSetChanged();
*   请注意，由于您使用静态列表，因此您必须来回传递数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:39:13.750

启动“详细信息”活动时，您需要使用 startActivityForResult()。

在这里查看答案，其中解释了更多详细信息：[如何在 Android 上管理 `startActivityForResult`？](https://stackoverflow.com/questions/10407159/android-how-to-manage-start-activity-for-result)

# html - html.erb 无法正确呈现

> ID：14783054
> 
> 赞同：0
> 
> 时间：2013-02-08T23:30:14.580
> 
> 标签：html, ruby-on-rails, forms

我有一个 html.erb 文件，在使用以下内容时不会呈现任何内容：

```
<% form_for :profile do |form| %> 
```

使用时（注意“=”符号）：

```
<%= form_for :profile do |form| %> 
```

这是html的输出：

![网页](../Images/0787ae73fca35a275c436fa47d681da9.png)

部分html代码：

```
<%= form_for :profile do |form| %> 
```

```
<%= text_field_for form, "first_name" %>
<%= text_field_for form, "last_name" %>
<div class="form_row">
    <label for="gender">Gender:</label>
    <%= radio_button :profile, :gender, "Male" %> Male
    <%= radio_button :profile, :gender, "Female" %> Female
</div>
<div class="form_row">
    <label for="birthdate">Birthdate:</label>
    <%= date_select :profile, :birthdate,
                    :start_year => Profile::START_YEAR,
                    :end_year => Time.now.year,
                    :include_blank => true,
                    :order => [:month, :day, :year] %>
</div> 
```

Form_for 定义：

```
def text_field_for(form, field,
                  size=HTML_TEXT_FIELD_SIZE,
                  maxlength=DB_STRING_MAX_LENGTH)
 label = content_tag("label", "#{field.humanize}:", :for => field)
 form_field = form.text_field field, :size => size, :maxlength => maxlength
 content_tag("div", "#{label} #{form_field}", :class => "form_row")
end 
```

控制器部分：

```
def edit
 @user = current_user
 @user.profile ||= Profile.new
 @profile = @user.profile
 if param_posted?(:profile)
   if @user.profile.update_attributes(params[:profile])
    flash[:notice] = "Changes saved."
    redirect_to :controller => "users", :action => "index"
   end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:04:36.967

在你的`text_field_for`助手中，你需要声明作为`DIV`你的助手生成的标签内容传递的字符串是安全的，因此不应该被清理。这是用`html_safe`.

```
def text_field_for(form, field,
  size =HTML_TEXT_FIELD_SIZE,
  maxlength =DB_STRING_MAX_LENGTH)
  label = content_tag("label", "#{field.humanize}:", :for => field)
  form_field = form.text_field field, :size => size, :maxlength => maxlength
  content_tag("div", "#{label} #{form_field}".html_safe, :class => "form_row")
end 
```

# jquery - 选择一个没有id的img元素，堆叠在多个div中

> ID：14783055
> 
> 赞同：0
> 
> 时间：2013-02-08T23:30:17.380
> 
> 标签：jquery, jquery-selectors

我有一个 img，它没有 id，并且堆叠如下：

```
<div class = "someclass">
  <div>
   <div>
     <img>
   </div>
  </div>
</div> 
```

我正在使用以下 jQuery 选择器来获取结果：

```
$('.someclass div div img') 
```

没用，我也试过

```
$('.someclass').children('img') 
```

那也不起作用，然后我尝试了这个荒谬的选择器：

```
$('.someclass').children('div').children('div').children('img') ; 
```

而且那场比赛没有奏效。

如何选择那个难以捉摸的 img 元素，我在哪里可以阅读更多详细信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T23:33:00.813

尝试使用 jQuery 的[find()](http://api.jquery.com/find/)方法：

```
$(".someclass").find("img"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:33:40.687

如果它是该 div 中唯一的图像元素，那么您可以`img`在具有该类的元素中的某处查找元素：

```
var image = $('.someclass img'); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-08T23:38:00.070

您可以使用子选择器

```
$('.someclass').children(0).children(0).children(0); 
```

# php - 为什么普通对象实例化和引用对象实例化之间存在差异？

> ID：14783059
> 
> 赞同：3
> 
> 时间：2013-02-08T23:30:43.257
> 
> 标签：php, reference, porting

我正在处理一个非常古老的项目，该项目已从 PHP 4 迁移到 PHP 5.2，我们现在正在将该项目迁移到 PHP 5.4。我们提出了许多参考错误。这是一些困扰我的示例代码。

```
<?php

class book_shelf 
{
    protected $_elements = array();

    function addBook(&$element){
        $this->_elements[] =& $element;
    }

    function printBooks(){
        print(json_encode($this->_elements));
    }
}

class book 
{
    function __construct($title, $author="unknown") {
        $this->title = $title;
        $this->author = $author;
    }

    public $title = NULL;
    public $author = NULL;
}

function createBookShelf(){
    $bookshelf1 = new book_shelf();

    for ($i = 0; $i < 3; $i++){
        $book1 = new book("Book $i");
        $bookshelf1->addBook($book1);
    }

    $bookshelf1->printBooks();  
}   

createBookShelf();

?> 
```

我希望这可以创建 3 本书。但是元素数组中的每个对象最终都指向最后一个变量。另一方面，如果我通过引用创建一本新书，一切正常。（例如`$book1 =& new book("Book $i");`）这是示例代码：

```
<?php

class book_shelf 
{
    protected $_elements = array();

    function addBook(&$element) {
        $this->_elements[] =& $element;
    }

    function printBooks(){
        print(json_encode($this->_elements));
    }
}

class book 
{
    function __construct($title, $author="unknown") {
        $this->title = $title;
        $this->author = $author;
    }

    public $title = NULL;
    public $author = NULL;
}

function createBookShelf() {
    $bookshelf1 = new book_shelf();

    for ($i = 0; $i < 3; $i++){
        $book1 =& new book("Book $i");
        $bookshelf1->addBook($book1);
    }

    $bookshelf1->printBooks();  
}   

createBookShelf(); 
```

我的印象是在 PHP 5.4 中通过引用创建对象是不必要的。知道为什么我会得到不同的结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:42:55.550

这是一个逻辑错误，与 PHP 版本无关。让我们看一下您的代码的以下片段：

```
//echo "phpinfo: " . phpinfo();
for ($i = 0; $i < 3; $i++){
    $book1 = new book("Book $i");
    $bookshelf1->addBook($book1);
}

...

function addBook(&$element){
    $this->_elements[] =& $element;
} 
```

怎么了？您通过引用传递 $book 。但是在每个循环中，您都会更改引用的值。在 for 循环结束时，$book 指向最后创建的 book 对象和引用。（也有过这个错误；）

结论：您的 addBook 函数必须如下所示：

```
function addBook($element){
    $this->_elements[] = $element;
} 
```

并保持添加书籍的代码不变 - 就像上面的例子一样，没有`&`.

* * *

**关于 =& 新 ... **

首先，如果你这样做，你会从 php 5.3 收到以下警告：

> 不推荐使用：不推荐使用通过引用分配 new 的返回值

因此，您不应该将它用于新代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-11T08:56:08.780

在您编写时，这最初是 PHP 4 代码。这两个构造：

```
$book1 =& new book("Book $i"); 
```

和

```
function addBook(&$element){
    $this->_elements[] =& $element;
} 
```

不再需要。第一个是*“new by reference”*，这从来都不是正确的做法，但有必要在 PHP 4 中使用对象而不是一直克隆对象

第二个是*“按引用传递”*，它可以是一个有效的概念，但就 PHP 5 中的对象而言，这不是必需的，*并且不应用于*作为对象的参数。

内存管理在 PHP 5 和 PHP 5.3 中得到了极大的改进。PHP 5.4 通过发出警告帮助您迁移代码。特别是*“新的参考”*可以很容易地发现和修复。

旧（PHP 4）：

```
$book1 =& new book("Book $i"); 
```

新的（当前 PHP 版本）：

```
$book1 = new book("Book $i"); 
```

（不，它不会回来:)）。对于通过引用传递的方法，我建议在重构代码时删除引用，并键入提示对象类型：

旧（PHP 4）：

```
function addBook(&$element){
    $this->_elements[] =& $element;
} 
```

新的（当前 PHP 版本）：

```
function addBook(Book $element){
    $this->_elements[] = $element;
} 
```

然后，您不仅解决了一个老问题，而且还确保仅使用预期的类型调用此函数，并且您可以看到它总是要获取一个对象（而不是仅在 PHP 4 中用于对象的变量引用，因为PHP 4 是有限的。这不再需要并且可以（并且应该，扔掉这个旧的东西！）被删除）。

将您的代码库置于版本控制之下，这样您就可以轻松地将更改应用到您的代码库，而不必担心破坏以前工作的任何内容。

* * *

> 我希望这可以创建 3 本书。但是元素数组中的每个对象最终都指向最后一个变量。

这里的实际问题是您使用通过引用传递。当你分配

```
$book1 = new book("Book $i"); 
```

的 refcount`$book1`为 1 且未标记为参考。现在将它作为引用传递给`$bookshelf1->addBook($book1)`方法会将其转换为引用计数为 2 的引用，因为在该方法内部，*引用*再次分配给类的私有成员：

```
for ($i = 0; $i < 3; $i++)
{
    $book1 = new book("Book $i");
    $bookshelf1->addBook($book1);
}

...

function addBook(&$element){
    $this->_elements[] =& $element;
} 
```

然后，您更改现在创建的参考。

因此，现在当您将具有实例化的代码更改为：

```
$book1 = & new book("Book $i"); 
```

您总是 - 每个循环一次 - 只使用相同的变量名创建一个新的别名（引用）。因为您随后将其作为参考传递，所以它是您指定为参考的*新别名。**因此Book*中的数组指向三个不同的引用——而不是三次指向同一个引用。

我希望这能更好地解释这个问题。这也是我们说的原因：除非您知道自己在做什么，否则不要使用引用。PHP 4 的情况是，许多用户习惯于在没有完全理解其工作原理的情况下使用引用（这是可以理解的，因为在 PHP 中这并不容易，我还需要稍微思考一下，直到我找到一个好的描述来分享这里 -希望这次能奏效:)）。显然在这里使用 PHP 5 的好处是您不再需要对对象使用引用，这使得编写和阅读代码更加容易。

* * *

有关的：

*   [严格标准：只能通过引用 PHP 5.4 分配变量](https://stackoverflow.com/q/11777908/367456)

# forms - 定义 Element_File 后 Zend Form 不显示

> ID：14783060
> 
> 赞同：0
> 
> 时间：2013-02-08T23:30:51.417
> 
> 标签：forms, zend-framework

下面是我的 Zend_Form 文件（抱歉间距太小了）！！

```
<?
class Form_Participant extends Zend_Form
{
public function init()
{
    $role = new Zend_Form_Element_Radio('role');
    $role->setRequired(true)
               ->setLabel('Role at Competition*')
               ->setMultiOptions(array('Competitor','Coach'),array(0,1))
               ->setDecorators($this->container());
    $this->addElement($role);

    $salutation = new Zend_Form_Element_Radio('salutation');
    $salutation->setRequired(true)
               ->setLabel('Salutation/Title')
               ->setMultiOptions(array('Mr.','Mrs.','Miss.','Ms.','Dr.','Other'),array(0,1,2,3,4,5))
               ->setDecorators($this->container());
    $this->addElement($salutation);     

    $first_name = new Zend_Form_Element_Text('first_name');
    $first_name->setRequired(true)
               ->setLabel('First Name')
               ->setDecorators($this->container());
    $this->addElement($first_name);

    $last_name = new Zend_Form_Element_Text('last_name');
    $last_name->setRequired(true)
              ->setLabel('Last Name')
              ->setDecorators($this->container());
    $this->addElement($last_name);

    $preferred_name = new Zend_Form_Element_Text('preferred_name');
    $preferred_name->setRequired(false)
                   ->setLabel('Preferred Name (optional)')
                   ->setDecorators($this->container());
    $this->addElement($preferred_name);

    $gender = new Zend_Form_Element_Select('gender');
    $gender->setRequired(true)
           ->setLabel('Gender')
           ->addMultiOptions(array('Female','Male'),array('0','1'))
           ->setDecorators($this->container());
    $this->addElement($gender);

    $email_address = new Zend_Form_Element_Text('email');
    $email_address->setRequired(true)
                  ->setLabel('Email Address')
                  ->setDecorators($this->container());
    $this->addElement($email_address);

    $year = new Zend_Form_Element_Radio('year');
    $year->setRequired(true)
               ->setLabel('Year of Study')
               ->setMultiOptions(array('1st Year','2nd Year','3rd Year','4th Year','5th Year','Other'),array(1,2,3,4,5,6))
               ->setDecorators($this->container());
    $this->addElement($year);

    $major = new Zend_Form_Element_Text('major');
    $major->setRequired(true)
          ->setLabel('Major/Specialization')
          ->setDecorators($this->container());
    $this->addElement($major);

    $resume = new Zend_Form_Element_File('resume');
    $resume->setRequired(false)
           ->setLabel('Upload Resume (PDF format)')
           ->setDestination(APPLICATION_PATH . '/../public/schools/2013/resume')
           ->setDecorators($this->container());
    $this->addElement($resume);

    $food_preference = new Zend_Form_Element_Textarea('food_preference');
    $food_preference->setRequired(false)
                    ->setLabel('Dietary Restrictions/Allergies (optional)')
                    ->setDecorators($this->container());
    $this->addElement($food_preference);

    $disabilities = new Zend_Form_Element_Textarea('disabilities');
    $disabilities->setRequired(false)
                    ->setLabel('Do you have any disabilities? (optional)')
                    ->setDecorators($this->container());
    $this->addElement($disabilities);

    $emergency_contact = new Zend_Form_Element_Textarea('emergency_contact');
    $emergency_contact->setRequired(true)
                    ->setLabel('Emergency Contact')
                    ->setDecorators($this->container());
    $this->addElement($emergency_contact);

    $additional_info = new Zend_Form_Element_Textarea('additional_info');
    $additional_info->setRequired(false)
                    ->setLabel('Additional Information (optional)')
                    ->setDecorators($this->container());
    $this->addElement($additional_info);

    $this->addElement('submit', 'register_participant_submit', array('label' => 'Add Participant','class'=>'blue_button add_participant'));
}

private function container()
{
    return array(
                    'ViewHelper',
                    'Errors',
                    array('Description', array('tag' => 'p', 'class' => 'description')),
                    array('HtmlTag', array('tag' => 'dd', 'id'  => array('callback' => array(get_class($this), 'resolveElementId')))),
                    array('Label', array('tag' => 'dt')),
                    array(array('elementContainer' => 'HtmlTag'), array('tag' => 'div', 'class' => 'element-container')),
                );
}

 } 
```

那里也有一个 Element_File。没有它，一切正常。有了它，表格根本不显示！

这就是我在控制器中调用表单的方式：

```
 $Form_Participant = new Form_Participant();
 $Form_Participant->setMethod('post')
                  ->setAttrib('id','registration_form')
                  ->setAttrib('enctype', 'multipart/form-data'); 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:34:52.920

File 元素必须包含“File”装饰器，否则将不会呈现。如果您检查错误日志，您可能会在其中看到异常。您需要处理文件元素的装饰器与处理其他装饰器的方式略有不同，如下所示：

```
private function fileContainer()
{
    return array(
        'File',
        'Errors',
        array('Description', array('tag' => 'p', 'class' => 'description')),
        array('HtmlTag', array('tag' => 'dd', 'id'  => array('callback' => array(get_class($this), 'resolveElementId')))),
        array('Label', array('tag' => 'dt')),
        array(array('elementContainer' => 'HtmlTag'), array('tag' => 'div', 'class' => 'element-container')),
    );
} 
```

# c# - Windows Phone 8 中的 Websockets 客户端支持

> ID：14783065
> 
> 赞同：5
> 
> 时间：2013-02-08T23:31:04.580
> 
> 标签：c#, websocket, windows-phone-8

当我阅读Windows 8 中的[MessageWebSocket](http://msdn.microsoft.com/library/windows/apps/BR226842)类时，我开始考虑一个可以在 Windows Phone 8 中使用该客户端的应用程序。

但是，深入挖掘我刚刚发现该类不在 Windows Phone 8 SDK 中。

你知道是否有任何其他与 Windows Phone 8 兼容的 Websockets 客户端实现？（看哪，不是 Windows 8）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T10:34:42.860

不幸的是，Windows Phone 8 没有像 WinRT 的 MessageWebSocket 那样提供本机 websocket 支持。您可以将 websocket4net 库（参见 codeplex：[http](http://websocket4net.codeplex.com/) ://websocket4net.codeplex.com/ ）用于您的 wp8 应用程序。

编辑：websocket4net 还支持 WP8 的 SSL！

问候，亚历克斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-04T09:21:40.913

我会尝试 SignalR ......这似乎是实现 WebSockets 的正确方法，因为它是 MSFT Web 技术堆栈的一部分：[第 9 频道介绍视频](http://channel9.msdn.com/posts/Building-real-time-connected-apps-with-Windows-Phone-8-and-SignalR)

顺便说一句：API 有一个有趣的抽象级别，您可以在其中管理客户端组，很好地支持不同的身份验证 startegies 等等......我唯一想念的是不支持二进制序列化，至少开箱即用。

# java - 控制台文本输出被阻止，即使它在另一个线程上

> ID：14783068
> 
> 赞同：0
> 
> 时间：2013-02-08T23:31:58.740
> 
> 标签：java, multithreading

我有一个非常复杂的 Java 程序。它工作正常。但是我只想在应用程序中打印一个“工作”动画，让用户知道应用程序是响应式的。我用这样的代码创建了一个简单的类：

```
public class Working extends Thread {
    private volatile boolean finished = false;
    char[] animationChars = new char[] { '|', '/', '-', '\\' };
    int anim = 0;

    public void finish() {
        finished = true;
    }

    public void run() {
        try {
            while (!finishing) {
                print();
            }
        } catch (Exception e) {
            // nothing here...
        }
    }

    private void print() throws InterruptedException {
        for (int i = 0; i < SLEEP_SECS; i++) {
            System.out.print("\rWorking... " + animationChars[anim++]);
            if (anim == 4)
                anim = 0;
            Thread.sleep(1000);
        }
    }
} 
```

当我运行它时，起初它工作正常。但是随着时间的推移，在某些情况下动画会停止几秒钟。我虽然将此代码移动到另一个线程可以解决这个问题，但正如您所看到的，它没有！

我的项目访问数据库、运行命令行进程并大量下载页面。是什么导致了这个问题？我是否遗漏了什么，或者 Java 无法处理如此简单的任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:39:17.523

我怀疑这些停止是在完整的 gc 期间，因为完整的 gc 可能会停止世界以释放一些内存（如果您不使用并行 gc）。您应该检查 gc 日志。

# macos - Qt：响应标题栏代理图标菜单

> ID：14783071
> 
> 赞同：2
> 
> 时间：2013-02-08T23:32:15.683
> 
> 标签：macos, qt

在 Mac 上，您可以将窗口标题设置为路径或文件，“代理图标”将显示在路径的最后一个元素旁边。例如，如果您打开 Finder 窗口并控制单击标题，您可以选择要切换到的目录；在 TextEdit 中，您可以对文件执行操作。

在Qt中我们可以使用`setWindowFilePath()`设置代理图标和最后一段路径。我可以控制点击并获得一个菜单，其中路径的不同部分一直到根目录。

我如何响应用户在此菜单上选择另一个目录？

是否可以设置自定义菜单，与 TextEdit 相同？

# bash - 使用 bash printf 右对齐第二列文本（带有彩色文本）

> ID：14783073
> 
> 赞同：0
> 
> 时间：2013-02-08T23:32:22.027
> 
> 标签：bash

我正在编写一个脚本来自动化一堆命令，并且我希望输出是右对齐和彩色的。到目前为止，我能够获得其中一个，但我未能成功实现这两个。我的（测试）脚本如下：

```
#!/bin/bash

columns=$(tput cols)
txtgrn=$(tput setaf 2) # Green
txtpur=$(tput setaf 5) # Purple
txtrst=$(tput sgr0) # Text reset.

col1="60"
let "col2 = $columns - $col1"

# Colored text, left-aligned
string1="${txtpur}Running update 1${txtrst}"
string2="${txtgrn}(1 of 10)${txtrst}"
printf "%-*s%*s\n" "$col1" "$string1" "$col2" "$string2"

string1="${txtpur}Running update 10${txtrst}"
string2="${txtgrn}(10 of 10)${txtrst}"
printf "%-*s%*s\n" "$col1" "$string1" "$col2" "$string2"

# Non-colored text, right-aligned
string1="Running update 1"
string2="(1 of 10)"
printf "%-*s%*s\n" "$col1" "$string1" "$col2" "$string2"

string1="Running update 10"
string2="(10 of 10)"
printf "%-*s%*s\n" "$col1" "$string1" "$col2" "$string2"

exit 0 
```

我正在使用标准 Mac 终端程序中的 Mac OS 10.7.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:46:00.737

```
string1="Running update 1"
string2="(1 of 10)"
printf "${txtpur}%-*s${txtgrn}%*s${txtrst}\n" "$col1" "$string1" "$col2" "$string2"

string1="Running update 10"
string2="(10 of 10)"
printf "${txtpur}%-*s${txtgrn}%*s${txtrst}\n" "$col1" "$string1" "$col2" "$string2" 
```

# jquery - WP Sidebar jQuery Toggle 不工作

> ID：14783080
> 
> 赞同：1
> 
> 时间：2013-02-08T23:32:51.267
> 
> 标签：jquery

获取脚本 src 代码后，我网站右侧边栏中的 jQuery 切换停止工作。它应该仍然可以工作，因为我的网站上安装的其他插件正在加载 jquery，但事实并非如此。

网站链接：http: [//goo.gl/XuanJ](http://goo.gl/XuanJ)

当您单击进行预订时，切换会打开。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js" type="text/javascript"></script>*
<script type="text/javascript">
$(document).ready(function() {
   $('a.res-toggle').click(function() {
      $('#reservation-box').toggle(400);
      return false;
   );
});
</script> 
```

如果我保留此代码

```
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js" type="text/javascript"></script> 
```

然后我网站上的滑块无法正常工作，因为它正在尝试导入最新的 jquery，我猜它们会崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:09:17.300

解决方案之一是将这个代码块移动到一个单独的文件中，比如 togglefunctionality.js 并将它放在 /wp-includes/js/jquery/ 目录中，然后像下面这样调用它。

```
<script type="text/javascript">
$(document).ready(function() {
 $("#side-res-open").click(function() {
 $('#reservation-box').toggle(400);
     return false;
 });
});
</script> 
```

如果您仍然看到一些冲突，并且只想在页面上显示此内容。然后替换`$`为`jQuery`，您应该在家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T13:48:21.620

首先 - 不要使用额外的 jquery 包括

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

然后，在无冲突模式下使用 jquery：http: [//api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

# basecamp - 如何在 C# 中向 BaseCamp 的事件部分添加一些内容，例如 github

> ID：14783085
> 
> 赞同：0
> 
> 时间：2013-02-08T23:33:23.573
> 
> 标签：basecamp

与 Basecamp 的 github 集成将项目添加到 Basecamp 的进度和事件部分，而无需实际添加消息、日历、待办事项等。查看 api [https://github.com/37signals/bcx-api](https://github.com/37signals/bcx-api)时，所有事件都已读取-只要。我尝试向 /projects/x/events.json 发出发布请求，但返回 (422) Unprocessable Entity 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:02:32.300

它似乎没有记录，但发布到事件 api 的要求如下：

描述、网址、标题和服务

如果您的 json 对象中包含所有这些并发布到事件 api /projects/x/events.json 它将起作用。

# python - 如何在没有复制/重置索引操作的情况下基于索引进行切片？

> ID：14783086
> 
> 赞同：1
> 
> 时间：2013-02-08T23:33:23.607
> 
> 标签：python, pandas

采用这样的布尔过滤器操作，它返回结果数据集的副本：

```
df[(df.age > 20) & (df.age < 30)]. 
```

现在从结果集中我想根据索引选择一个随机切片。所以例如。我可能想要第 10 行、第 14 行和第 17 行。

但我不能说

```
df[(df.age > 20) & (df.age < 30) & df.index.isin([10, 14, 17])] 
```

因为过滤后的索引会不同。我们可以像这样在 3 个语句中轻松做到这一点：

```
a = df[(df.age > 20) & (df.age < 30)]. 
a = a.reset_index()
result = a.index.isin([10, 14, 17]) 
```

这可能是对整个数据集（百万行）的巨大复制操作，然后是重置操作。

我想在没有复制操作的情况下一步完成。任何意见/见解表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:31:21.177

对此的一项改进是使用[`iloc`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.iloc.html)，它只抓取指定*整数*位置的行：

```
a = df[(df.age > 20) & (df.age < 30)]
a.iloc[10, 14, 17] 
```

*注意：这将抛出一个`IndexError`if`a`没有 18 行。*

请参阅[文档的索引部分](http://pandas.pydata.org/pandas-docs/stable/indexing.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T02:46:10.740

只需使用`.ix`：

```
In [1]: df = DataFrame(np.arange(20).reshape(5,4))

In [2]: df
Out[2]:
    0   1   2   3
0   0   1   2   3
1   4   5   6   7
2   8   9  10  11
3  12  13  14  15
4  16  17  18  19 
```

在这里，我索引第一列的值小于 12 的数据框，然后用于`.ix`获取结果的第 0 行和第 2 行：

```
In [3]: df[df[0] <12].ix[[0,2]]
Out[3]:
   0  1   2   3
0  0  1   2   3
2  8  9  10  11 
```

**更新：**

好的，布尔索引索引然后将其传递给`.ix`呢？

```
In [1]: (df[0] < 12) | (df[0] > 12)
Out[1]:
0     True
1     True
2     True
3    False
4     True
Name: 0 
```

使用上述布尔系列索引 df.index：

```
In [2]: df.index[(df[0] < 12) | (df[0] > 12)]
Out[2]: Int64Index([0, 1, 2, 4], dtype=int64) 
```

现在，在`df.ix[]`. 在这里，传递 3 会拉回最初索引的第 4 行：

```
In [3]: df.ix[df.index[(df[0] < 12) | (df[0] > 12)][3]]
Out[3]:
0    16
1    17
2    18
3    19
Name: 4 
```

# python - 处理文件的一般策略

> ID：14783089
> 
> 赞同：1
> 
> 时间：2013-02-08T23:33:50.323
> 
> 标签：python, file-io, preprocessor

我有一个问题不是关于特定的实现，而是关于处理文件的一些常见编码实践：将完整的源文件加载到内存中是否正常？

例如，[这里](https://github.com/Kronuz/pyScss/blob/master/scss/tool.py#L316)的 SASS 源文件只是加载到内存中。我认为如果此文件的大小超过 100Mb，可能会导致问题。当然，我们可以检查扩展名，或检查文件大小，或以固定大小的块读取文件或等待良好的用户意图。正如我所见，后者最常被选择。

你怎么看待这件事？它是如何在像 gcc 这样的复杂系统中实现的？

# c++ - 在我的 C++ 项目中找不到头文件

> ID：14783090
> 
> 赞同：0
> 
> 时间：2013-02-08T23:33:51.077
> 
> 标签：c++, visual-studio-2010

我刚刚下载了一些文件（TinyXML.h）并将这些文件添加到我的其他头文件和 cpp 文件旁边。我还将该行添加到我的主 cpp 文件中

```
#include "tinyxml.h" 
```

但是我仍然收到错误

```
fatal error C1083: Cannot open include file: 'tinyxml.h': No such file or directory 
```

现在，如果我在项目的属性中添加文件的确切路径（“添加其他包含目录”），那么我不会收到此错误。我想知道如何解决这个问题。由于 VS2010 没有问题找到我放置在它旁边的其他头文件，为什么它有这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:37:38.960

首先，我不会只是将第 3 方标头复制到您的项目目录中。只需将它们保存在自己的文件夹中，然后将该文件夹添加到其他包含目录即可。

其次，如果标头与源文件位于同一位置，则`include`应该按原样工作。所以我不认为就是这样（假设你的大小写正确）。我认为您实际上正在查看与该目录中的源文件不同的源文件。（您可以通过将鼠标悬停在 Visual Studio 中的文件选项卡上并检查路径或打开您认为包含该文件的源文件来判断这种情况）。我 99% 确定您正在编译错误的 cpp 文件。

# user-controls - 隐藏用户控件并删除空间

> ID：14783100
> 
> 赞同：0
> 
> 时间：2013-02-08T23:34:23.573
> 
> 标签：user-controls

我有一个带有面板的用户控件，它嵌入到默认页面中。在面板中，我有控件和文本。我的问题是如何在默认页面上呈现面板时隐藏面板并删除其空间。

# ubuntu - Ubuntu：启动时无法从程序运行脚本

> ID：14783103
> 
> 赞同：0
> 
> 时间：2013-02-08T23:34:32.447
> 
> 标签：ubuntu, startup

在 Ubuntu 中，我有一个 C++ QT 程序，我在其中调用了一个外部脚本 (.sh)。

如果我手动运行程序（从命令行）一切正常（脚本被正确调用）但是如果程序在启动时被调用（通过放入`/etc/init.d`并运行`update-rc.d`）程序运行正确，但脚本没有开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:37:48.983

我终于解决了。问题出在脚本 (script1.sh) 本身，因为它使用了对另一个脚本 (script2.sh) 的调用：在 script1 中，对 script2 的调用就像“script2”一样完成。我将该调用更改为 /path/to/script2/script2 并且一切正常。 **最后一个问题是：如果这是在环境路径（$PATH）中，为什么我需要指定绝对脚本路径？**

# android - 在内容提供程序中使用自定义查询时，LoaderManager 未收到数据更改通知

> ID：14783105
> 
> 赞同：0
> 
> 时间：2013-02-08T23:34:55.623
> 
> 标签：android, android-contentprovider, ormlite

总的来说，我对 Android 和 Java 不是很熟悉，所以我的说法可能是错误的。对此感到抱歉。

反正。我有一个 ListActivity 从 LoaderManager 获取数据。LoaderManager 使用 ContentProvider [https://github.com/jakenjarvis/Android-OrmLiteContentProvider](https://github.com/jakenjarvis/Android-OrmLiteContentProvider)。

当使用 contentUri (net.mydomain.app.listitems) 获取数据时，一切正常，其定义方式与示例设置中的定义几乎相同。但是我需要来自连接查询的数据并为该查询添加了一个 URI (net.mydomain.app.listitems/items_joined)。uri 在 Contract 类中定义并命名为 itemsJoinedUri。使用此 URI 时，视图中的列表不会在新数据插入表时更新。

在我的 ContentProvider 类的 onQuery 方法中，如果“模式代码”与 itemsJoinedUri 匹配，我会执行自定义查询。其他副我将工作传递给超级方法。

```
public class DataProvider extends OrmLiteSimpleContentProvider<DatabaseHelper> {

    @Override
    protected Class<DatabaseHelper> getHelperClass() {
        return DatabaseHelper.class;
    }

    @Override
    public boolean onCreate() {
        Controller = new MatcherController()
            .add(ListItem.class, SubType.Directory, "", Contract.ListItem.CONTENT_URI_PATTERN_MANY)
            .add(ListItem.class, SubType.Item, "#", Contract.ListItem.CONTENT_URI_PATTERN_ONE)
            .add(ListItem.class, SubType.Directory, "items_joined", Contract.ListItem.CONTENT_URI_PATTERN_WITH_ITEMS_JOINED)
            .initialize();
        return true;
    }

    @Override
    public Cursor onQuery(DatabaseHelper helper, MatcherPattern target, QueryParameters parameter) {
        Cursor result = null;
        //SQLiteQueryBuilder builder = new SQLiteQueryBuilder();

        switch(target.getPatternCode()) {
        case 310:
            String MY_QUERY = "SELECT items.name as name, listitems._id as _id FROM listitems INNER JOIN items ON items._id = listitems.item_id WHERE list_id = ?";
            SQLiteDatabase db = helper.getReadableDatabase();
            result = db.rawQuery(MY_QUERY, parameter.getSelectionArgs());
            break;
        default:
            result = super.onQuery(helper, target, parameter);
            break;
        }
        return result;
    }
} 
```

我的相关部分的合同实施：

```
public class Contract {
    public static final String DATABASE_NAME = "mydatabase.db";
    public static final int DATABASE_VERSION = 1;

    public static final String AUTHORITY = "net.mydomain.app";
    .
    .
    .
    public static class ListItem implements BaseColumns {
        public static final String TABLENAME = "listitems";
        public static final String CONTENT_URI_PATH = TABLENAME;
        public static final String MIMETYPE_TYPE = TABLENAME;
        public static final String MIMETYPE_NAME = AUTHORITY + ".provider";

        // field info
        public static final String ITEM = "item_id";
        public static final String LIST = "list_id";
        public static final String QUANTITY = "quantity";

        // content uri pattern code
        public static final int CONTENT_URI_PATTERN_MANY = 300;
        public static final int CONTENT_URI_PATTERN_ONE = 301;
        public static final int CONTENT_URI_PATTERN_WITH_ITEMS_JOINED = 310;

        // Refer to activity.
        public static final Uri contentUri = new Uri.Builder()
            .scheme(ContentResolver.SCHEME_CONTENT)
            .authority(AUTHORITY)
            .appendPath(CONTENT_URI_PATH)
            .build();

        public static final Uri itemsJoinedUri = new Uri.Builder()
            .scheme(ContentResolver.SCHEME_CONTENT)
            .authority(AUTHORITY)
            .appendPath(CONTENT_URI_PATH)
            .appendPath("items_joined")
            .build();
    }
} 
```

ListActivity 的 onCreateLoader 方法在这里。我想使用但没有正确更新列表的那个被注释掉了。

```
//  @Override
//  public Loader<Cursor> onCreateLoader(int id, Bundle bundle) {
//      String[] selectArgs = { "" + list_id };
//      Uri baseUri = Contract.ListItem.itemsJoinedUri;
//      return new CursorLoader(this, baseUri, null, null, selectArgs, null);
//  }

    @Override
    public Loader<Cursor> onCreateLoader(int id, Bundle bundle) {
        String select = "( " + Contract.ListItem.LIST + " = 2 )";
        Uri baseUri = Contract.ListItem.contentUri;
        String[] projection = new String[] {
                Contract.ListItem._ID,
                Contract.ListItem.LIST
        };
        return new CursorLoader(this, baseUri, projection, select, null, null);
    } 
```

列表中的新项目使用代码插入到不同的活动中`getContentResolver().insert(Contract.ListItem.contentUri, values);`。该 Activity 在层次结构中比 ListActivity 更深一层，因此我可以使用后退按钮返回 ListActivity，此时我看到列表尚未更新。

所以数据是使用 contentUri 插入的，但使用我自己的 itemsJoinedUri 读取。这可能是这里的问题吗？

编辑

我添加了一个简单的 clicklistener 来从列表中删除一行。这使用 contentUri 并且列表在删除后自动更新。因此，我猜想从另一个 Activity 移回列表时列表未更新的问题可能与 ListActivity 生命周期的错误实现有关。

```
@Override
public void onListItemClick(ListView l, View v, int position, long id) {
    String[] args = { "" + id};
    getContentResolver().delete(Contract.ListItem.contentUri, "_id = ?", args);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:18:09.367

问题在于生命周期管理。我没有正确的 onRestart() 实现。添加后一切正常。

```
@Override
public void onRestart() {
    super.onRestart();
    getLoaderManager().getLoader(0).forceLoad();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:03:41.633

在您注释掉的部分中，您仅发送选择参数，但不发送选择字符串。选择参数不能单独出现，您还必须设置选择字符串，例如：

```
return new CursorLoader(this, baseUri, null, "_id = ?", selectArgs, null); 
```

那样有用吗？

# jquery - Jquery 使用变量来 .show() div

> ID：14783106
> 
> 赞同：3
> 
> 时间：2013-02-08T23:35:11.010
> 
> 标签：jquery, html

我试图使用 .show() 在幻灯片放映中显示 div 元素，如幻灯片。

我想做的是使用导航栏上按钮的 ID 属性使该幻灯片“滑入”，就像幻灯片放映一样。所以按钮一的 id 为“1”。然后我使用 Jquery 将“#slide”附加到该 ID 并获得“#slide1”。这对应于我希望展示的特定幻灯片。到目前为止，我一直无法让“幻灯片”div 与 $variable.show() 一起出现。

我要解决这个问题了吗？

这就是我到目前为止所拥有的。

[http://jsfiddle.net/greyoxide/RN2jC/](http://jsfiddle.net/greyoxide/RN2jC/)

```
$(".button").click(function () {
    $(".slide").hide();
    var content = $(this).attr('id');
    var fix = "'" + '#slide' + content + "'";
    $("#show").val(fix);
    $(fix).show();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:39:03.893

摆脱单引号`'`，所以改变：

```
var fix = "'" + '#slide' + content + "'"; // This translates to "'#slide1'" 
```

到：

```
var fix = '#slide' + content; // This translates to "#slide1" 
```

最终结果：

```
$(".button").click(function () {
    $(".slide").hide();
    var content = $(this).attr('id');
    var fix = '#slide' + content;
    $("#show").val("'" + fix + "'"); // If you still want to display single quotes
    $(fix).show();
}); 
```

[http://jsfiddle.net/RN2jC/9/](http://jsfiddle.net/RN2jC/9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:38:13.330

您不需要幻灯片 ID 周围的引号。

```
$(".button").click(function () {
  $(".slide").hide();
  var content = $(this).attr('id');
  var fix = '#slide' + content;
  $("#show").val(fix);
  $(fix).show();
}); 
```

见[演示](http://jsfiddle.net/zaknotzak/RN2jC/4/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:38:26.443

删除`fix`字符串中的撇号：

`var fix = "'" + '#slide' + content + "'";`

应该：

`var fix ='#slide' + content;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T23:38:38.290

为什么要在前后加上引号`fix`？那是错误的，否则它将起作用：http: [//jsfiddle.net/RN2jC/6/](http://jsfiddle.net/RN2jC/6/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T23:41:01.010

```
$(".button").click(function () {
    $(".slide").hide();
    $("#slide"+$(this).attr('id')).show();
}); 
```

[小提琴](http://jsfiddle.net/RN2jC/8/)

# javascript - 使用 nodejs 时的 i18next 段落

> ID：14783110
> 
> 赞同：0
> 
> 时间：2013-02-08T23:35:34.477
> 
> 标签：javascript, internationalization, i18next

我正在使用[http://jamuhl.github.com/i18next/node/](http://jamuhl.github.com/i18next/node/)工作正常，但是对于一个我似乎无法解决的问题。

就是这样，我的 /locales/dev/translation.json 中有这个 translation.json 文件

```
{
  "tzm": "Chapters - Zeitgeist Movement"
  ,"welcome": [
    "<p>The Zeitgeist Movement is an explicitly non-violent, global sustainability advocacy group currently working in over 1000 Regional Chapters across 70 countries.</p>"
    ,"<p>The basic structure of The Movement consists of Chapters, Teams, Projects & Events. Overall, the Chapters are essentially what define the Movement and each Chapter works to not only spread awareness about the roots of our social problems today but also to express the logical, scientific solutions and methods we have at our disposal to update and correct the current social system and create a truly responsible, sustainable, peaceful, global society.</p>"
  ] 
```

在我的刀片模板中，我有以下内容：

```
div#page
   p=t("welcome") 
```

问题是我得到了 html 标签，查看文档[http://i18next.com/pages/sample.html](http://i18next.com/pages/sample.html)专门设置内部 html：

使用 i18next-node 和显示段落部分的正确方法是什么，我之前的做法是：

```
 ,"welcome": {
    "p1":"The Zeitgeist Movement is an explicitly non-violent, global sustainability advocacy group currently working in over 1000 Regional Chapters across 70 countries."
    ,"p2":"The basic structure of The Movement consists of Chapters, Teams, Projects & Events. Overall, the Chapters are essentially what define the Movement and each Chapter works to not only spread awareness about the roots of our social problems today but also to express the logical, scientific solutions and methods we have at our disposal to update and correct the current social system and create a truly responsible, sustainable, peaceful, global society."
  } 
```

然后我的 page.blade 模板看起来像：

```
div#page
   p=t("welcome.p1")
   p=t("welcome.p2") 
```

对于少量数据，这可以正常工作，但是如果您有大量段落，它可能会变得无聊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T16:16:48.167

想知道但不应该是这样吗

```
div#page
    p!=t("welcome") 
```

至少在玉中设置未转义的内容是这样的。

我会使用 node-blade 提供的降价过滤器来处理纯文本内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T17:48:29.580

我这样做并且它有效，尽管您可以`<p>`在页面加载时看到初始的，然后显示段落。你可以看到它[http://blade.eu01.aws.af.cm/](http://blade.eu01.aws.af.cm/)

```
p(data-i18n="[html]welcome")=t("welcome") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T07:42:52.160

我看了你的页面。它确实以这种方式添加了两个段落。一个带有 p(data-i18n="...") 和一个带有 p!=t("welcome")。对我来说，这似乎是与刀片模板引擎相关的问题。我会在那里打开一个问题。

# android - mapfragment 之上的 Android Activity

> ID：14783112
> 
> 赞同：0
> 
> 时间：2013-02-08T23:35:44.817
> 
> 标签：android, android-activity

我想创建一个基于谷歌地图的活动。活动应该作为一个选项卡，在左边你有可点击的项目，在右边它将加载相应的活动。

所以也许我想做的是创建一个包含一个选项卡的活动，每个选项卡都是一个活动。

查看[示例图像](http://i49.tinypic.com/2wf1hxg.jpg)。

我的代码目前只是加载谷歌地图。

```
public class WorldApp extends Activity 
{

    private GoogleMap map;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.alfaworldtab);

        map = ((MapFragment) getFragmentManager().findFragmentById(R.id.map)).getMap();
        map.setMapType(GoogleMap.MAP_TYPE_HYBRID);

        CameraUpdate center = CameraUpdateFactory.newLatLng(new LatLng(52.022078,4.49340));
       map.moveCamera(center);

    }

}

<fragment xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  class="com.google.android.gms.maps.MapFragment"/> 
```

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:18:11.127

看起来你想要做的是有多个可以与地图交互的片段。当您使用片段时，您并没有真正开始活动，通常只有一个活动是打开的。您可以在 xml 布局中或通过使用片段管理器来定义片段。

这是关于[片段的所有指南](http://developer.android.com/guide/components/fragments.html)

而[这个](http://developer.android.com/reference/com/google/android/gms/maps/MapFragment.html)你将不得不用于地图部分。

希望这可以帮助

# asp.net - 循环遍历多个复选框列表以构建电子邮件

> ID：14783113
> 
> 赞同：0
> 
> 时间：2013-02-08T23:35:47.573
> 
> 标签：asp.net, checkboxlist

我正在创建一个包含多个 CheckBoxLists（总共 8 个）的表单，如下所示：

```
Configurar el Sistema (1-3 horas)
<asp:CheckBoxList runat="server" ID="Configurar">
<asp:ListItem ID="ECheckBox1" class="submenu" runat="server"  Text="Personal"/>
<asp:ListItem ID="ECheckBox1a" class="submenu"  runat="server" Text="Seguridad del Sistema"/>
 <asp:ListItem ID="ECheckBox1b" class="submenu"  runat="server" Text="Configuración del     agencia (sitios, salones)"/>
 <asp:ListItem ID="ECheckBox1c" class="submenu"  runat="server" Text="Configuración de los módulos (elegibilidad, requisitos de salud)"/>
 <asp:ListItem ID="ECheckBox1d" class="submenu"  runat="server" Text="Configuración del sistema (preferencias, Campos de específicos a su agencia)"/>
 <asp:ListItem ID="ECheckBox1e" class="submenu"  runat="server" Text="Utilidades  del Database (archivo, función de adiestramiento)"/>
 <asp:ListItem ID="ECheckBox1f" class="submenu"  runat="server" Text="Los datos de registro historia"/>
 <asp:ListItem ID="ECheckBox1g" class="submenu"  runat="server" Text="Configuración del PIR"/>
 <asp:ListItem ID="ECheckBox1h" class="submenu"  runat="server" Text="Configurar Data en vivo"/>
</asp:CheckBoxList> 
```

在 SubBtn.Click 上，所选项目将进入电子邮件。我正在使用它来循环第一个 CheckBoxList：

```
 Dim ConfigurarChkVal As String = String.Empty

    For Each item As ListItem In Configurar.Items

        If item.Selected Then
            ConfigurarChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(ConfigurarChkVal) Then
        ConfigurarChkVal = ConfigurarChkVal.Substring(1)
    End If

    Dim EmailBody As String
    EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + ">" + ConfigurarChkVal + "</p>" 
```

它返回：

> 配置系统
> 
> 个人的
> 
> 安全保障
> 
> Configuración del agencia (sitios, 沙龙)
> 
> Configuración de los módulos (elegibilidad, requisitos de salud)
> 
> Configuración del sistema (preferencias, Campos de específicos a su agencia)
> 
> Utilidades del Database (archivo, función de adiestramiento)
> 
> 历史数据
> 
> PIR 配置
> 
> 体内配置数据

所以它切断了第一个选定值的第一个字母。我该如何解决这个问题？但这并不是真正的主要问题——如果我尝试对剩余的 CheckBoxLists 使用相同的代码，它只会返回最后一个 CheckBoxList 而不是电子邮件中的全部 8 个。

我不确定是否有更简单的方法，但任何建议都将不胜感激。

* * *

所有 8 的代码：

```
 Dim EntradaChkVal As String = String.Empty

    For Each item As ListItem In FamilyServices.Items

        If item.Selected Then
            EntradaChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(EntradaChkVal) Then
        EntradaChkVal = EntradaChkVal.Substring(0)
    End If

    Dim HealthChkVal As String = String.Empty

    For Each item As ListItem In Health.Items

        If item.Selected Then
            HealthChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(HealthChkVal) Then
        HealthChkVal = HealthChkVal.Substring(0)
    End If

    Dim FamilyChkVal As String = String.Empty

    For Each item As ListItem In FamServices.Items

        If item.Selected Then
            FamilyChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(FamilyChkVal) Then
        FamilyChkVal = FamilyChkVal.Substring(0)
    End If

    Dim AdminChkVal As String = String.Empty

    For Each item As ListItem In Admin.Items

        If item.Selected Then
            AdminChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(AdminChkVal) Then
        AdminChkVal = AdminChkVal.Substring(0)
    End If

    Dim StatusChkVal As String = String.Empty

    For Each item As ListItem In StatusCenter.Items

        If item.Selected Then
            StatusChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(StatusChkVal) Then
        StatusChkVal = StatusChkVal.Substring(0)
    End If

    Dim ReportsChkVal As String = String.Empty

    For Each item As ListItem In Informes.Items

        If item.Selected Then
            ReportsChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(ReportsChkVal) Then
        ReportsChkVal = ReportsChkVal.Substring(0)
    End If
    Dim OptionalChkVal As String = String.Empty

    For Each item As ListItem In Opciones.Items

        If item.Selected Then
            OptionalChkVal += item.Value + "<br />"
        End If
    Next
    If Not [String].IsNullOrEmpty(OptionalChkVal) Then
        OptionalChkVal = OptionalChkVal.Substring(0)
    End If 
```

我意识到问题是这样的：EmailBody = EmailBody + " **Configurar el Sistema** " + "

" EmailBody = EmailBody + "" + ConfigurarChkVal + "

"

```
 EmailBody = "<p style=" + "font-family:Verdana;" + "><p style=" + "font-family:Verdana;" + "><strong>Informacion de entrada para la familia y matriculados </strong> " + "</p><p></p>"
        EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + ">" + EntradaChkVal + "</p>" 
```

我在每个并发语句上都省略了 EmailBody +，这又重新启动了 EmailBody。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:47:50.457

字符串从零开始索引，所以 `ConfigurarChkVal.Substring(1)`应该是`ConfigurarChkVal.Substring(0)`

# c# - 在 WCF 服务中使用大量数据后清理内存

> ID：14783120
> 
> 赞同：1
> 
> 时间：2013-02-08T23:36:38.747
> 
> 标签：c#, windows, wcf, memory-management, event-log

我有一个 WCF 客户端，我连接到托管在 Windows 服务中的 WCF 服务器。在服务中，我从安全事件日志中读取了最后一天的条目。然后我解析条目并创建我自己的条目，然后将`List<Data>`其返回到我的 WCF 客户端以在 DataGrid 中显示它。问题是，在安全事件日志中，我有 30000 个条目，在解析每个条目后，我创建了 30000 个类型的新对象`Data`。此类型是一个具有 15 个字符串属性的类，其中包含来自事件日志的消息的详细信息。整个过程结束后，Windows 服务的内存使用量上升了 60-70MB。一旦我将这么大的数据集发送到客户端，如何将 Windows 服务使用的内存从 70-80MB 降低到默认的 10MB ？

这是我的代码：

```
public List<Data> GetConnections()
{        
   var eventLog = new EventLog("Security");
   var fromDate = DateTime.Now.AddDays(-1);
   var entries = (from EventLogEntry e in eventLog.Entries
                   where (e.InstanceId == m_EventNumber) && e.TimeGenerated >= fromDate orderby e.TimeGenerated
                   select e).ToList()
                            .OrderByDescending(x => x.TimeGenerated);

   var items = new List<Data>();
   foreach(var item in entries)
   {
      var nData = ParseMessage(item.Message);
      if (nData != null)
          items.Add(ruleData);
   }
   return items;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:43:11.963

更高效的代码：只有一个循环而不是两个，GC 收集的对象更少。

```
var q = from EventLogEntry e in eventLog.Entries
        where (e.InstanceId == m_EventNumber) && e.TimeGenerated >= fromDate orderby e.TimeGenerated
        order by e.TimeGenerated desc
        let r = ParseMessage(e.Message)
        where r != null
        select r;

return new List<Data>(q); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:06:20.587

每次调用服务时，您的内存消耗是否会持续增加？如果每分钟调用一次服务，一小时后是否有 60*70MB 的内存使用？如果没有，那么您可能没有内存泄漏。您不需要采取任何行动。

# javascript - 如何在 Ember.pre4 版本中从普通类访问控制器？

> ID：14783121
> 
> 赞同：0
> 
> 时间：2013-02-08T23:36:39.583
> 
> 标签：javascript, ember.js, ember-router

到目前为止，我通常有一个数据源类，其中包含访问服务器、检索数据并将其放入控制器的所有功能，类似于：

```
...
App.DataSource = Ember.Object.extend({
  getBooks: function(callback) {
    $.ajax({
      url: '/books.json',
      done: function(data){
        //process the data
        App.get('router.booksController').set('content', processedData);
      }
    });
  }
});

App.dataSource = App.DataSource.create();
... 
```

但是由于发布了 pre-4 版本，因此无法再从路由器访问控制器，并且似乎对它们的访问非常有限，如[本](https://stackoverflow.com/questions/14506275/accessing-an-instance-of-a-controller-or-a-view-in-ember)问题所述。

那么根据这些变化，这不可能了？推荐的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:59:11.933

就我个人而言，我会说你在这个意义上错误地使用了 Ember。`App.DataSource`让您的对象知道控制器对我来说似乎很奇怪。两个重要的问题要问自己：

1.  为什么这个对象有责任填充控制器？
2.  为什么控制器没有填充自己的责任？

**@Matt：**我也一直在使用该`this.controllerFor`方法，但此后已被弃用。相反，我们应该使用以下`needs`方法：

```
App.IndexController = Ember.Controller.extend({
    // Requires App.ThisController, App.ThatController.
    needs: ['this', 'that']
}); 
```

在这种情况下，我将`BooksController`负责填充自身。也许在`init`方法上。

如果你**真的**需要使用`App.DataSource`那么你真的需要考虑另一种方法来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:33:13.013

路由器有一个新方法 controllerFor，它接受控制器实例的字符串名称。只要您可以获得对路由器的引用，您就应该能够访问由 ember 实例化/生成的控制器。

请参阅：[http ://emberjs.com/guides/routing/setting-up-a-controller/](http://emberjs.com/guides/routing/setting-up-a-controller/)

您可能仍然可以做类似的事情，`App.Router.controllerFor("books")`尽管在您的对象中像模型一样进行硬编码并不好。

我注意到的另一件奇怪的事情是 Ember.Router 不再在网站 API 中查找文档。我认为这是因为他们将路由器的核心移动到了 Ember 扩展的独立项目或类似的东西。

我认为这是github来源：[https ://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/system/route.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/system/route.js)

# django - 用于链接模板中相关数据的 Django 查询

> ID：14783122
> 
> 赞同：0
> 
> 时间：2013-02-08T23:36:40.400
> 
> 标签：django, templates, join, models

我在 Django 应用程序中有两个数据表，一个包含船舶详细信息，另一个包含与单个船舶相关的报价。我的模型如下：

```
class Vessel(models.Model):
    name = models.CharField(max_length=64)
    image = models.CharField(max_length=64)
    vesseltype = models.ForeignKey(VesselType)
    capacity = models.IntegerField()
    length = models.FloatField()
    beam = models.FloatField()
    speed = models.IntegerField()
    activities = models.CharField(max_length=256)
    category = models.IntegerField()
    display_order = models.IntegerField()
    published = models.BooleanField()
    def __unicode__(self):
        return self.name

class Offer(models.Model):
    vessel = models.ForeignKey(Vessel)
    description = models.CharField(max_length=128)
    date = models.DateField()
    duration = models.IntegerField()
    itinerary = models.TextField()
    price = models.IntegerField()
    display_order = models.IntegerField()
    link = models.URLField()
    published = models.BooleanField()
    def __unicode__(self):
        return self.description 
```

在我的views.py中，我有以下代码：

```
def home(request):
    vessels = Vessel.objects.filter(published='y').order_by('display_order')
    offers = Offer.objects.filter(vessel__published__exact='y').filter(published='y').order_by('display_order')
    t = loader.get_template('index.html')
    c = Context({
        'vessels' : vessels,
        'offers' : offers,
    }) 
```

在模板中，我需要显示多个 div，每个 div 都包含船只名称、一些船只详细信息以及与该船只相关的任意数量的报价。

我查看了尝试将报价与每艘船只相关联的查询，并且我还尝试在模板中的循环代码中识别船只名称，以便仅在vessel.id 和offer.vessel 匹配时显示报价。

到目前为止，仅在查询端出现错误并通过模板方式单独列出船只名称和报价，都没有成功。如何加入这些信息，以便我可以在模板中使用类似这样的内容：

```
for offer in offers:
    offer.vessel.name
    offer.vessel.category
    offer.description
    offer.price 
```

还是我期待太多？在这里待了几个小时，在文档中找不到解决方案，但这可能很明显。更改查询、视图代码或模板都不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:42:50.217

答案是更改您的`view`代码。你想要一个像`Offer.objects.all().select_related()`. [`select_related`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-related)将确保每次执行循环时都不会访问数据库，因为它会在执行查询之前跟随外键到最后。

您还使用了错误的[模板语法](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#for)。它需要是这样的：

```
{% for object in object_list %}
{{ object.attribute }}
{% endfor %} 
```

# c# - 如何从其他应用程序捕获拖放

> ID：14783124
> 
> 赞同：1
> 
> 时间：2013-02-08T23:36:55.067
> 
> 标签：c#, drag-and-drop, mouseevent, capture

我搜索了各种问题的答案，但我认为还没有讨论过这个问题。有两个 winforms 应用程序一个有焦点，另一个正在运行，但没有焦点。

我怎样才能从不专注的人那里捕捉到专注中发生的事情。特别是我需要从拖放的开始和结束捕获坐标。

后台的应用程序有一个数据库，我希望用户同时使用两个应用程序。在一个应用程序中，用户进行拖放，而另一个应用程序捕获坐标并基于该坐标搜索数据库并显示结果。然而，用户仍然保持第一个焦点。

任何有关 C# 代码的帮助将不胜感激。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:50:42.997

您描述了两个单独的应用程序，因此我的回复假设您有两个不同的进程 (EXE) 正在运行。如果是这种情况，那么您需要使用进程间通信机制，请[考虑命名管道](http://msdn.microsoft.com/en-us/library/bb546085.aspx)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-09T00:54:33.767

拖放功能会为您解决这个问题。只需让它们设置并运行，它就会在应用程序之间自动运行。我一直这样做，忘记另一个人。

# git-submodules - 带有子模块的 git 存档导出（git 存档全部/递归）

> ID：14783127
> 
> 赞同：17
> 
> 时间：2013-02-08T23:37:10.957
> 
> 标签：git-submodules, git-archive

我有一个用 git 版本化的网站目录。我将子模块用于 Twitter Bootstrap、colorbox 和 lessjs 等所需库，因为我不应该跟踪源代码，而应该只跟踪我使用的代码版本。

现在我想部署项目，因此我也需要子模块代码。通过使用`git archive`我没有从子模块中获取源文件/代码。

以下三种方法尝试实现我想要但不起作用的方法： **第一种方法**

```
#!/bin/sh

export revision="$1"

export GIT_INDEX_FILE=".git/tmpindex"
rm -f "$GIT_INDEX_FILE"

git read-tree $revision

export up="$(pwd)"

read_one_level () {
        export GIT_ALTERNATE_OBJECT_DIRECTORIES="$GIT_ALTERNATE_OBJECT_DIRECTORIES":$(
            git submodule foreach 'echo "$up/$path/.git/objects"' |
            grep -E -v '^(Entering|No submodule mapping found)' |
            tr '\n' : |
            sed 's/:$//'
        )

        git submodule foreach '
                cd "$up"
                subcommit=$(git rev-parse :"$path")
                git rm --cached "$path"
                git read-tree -i --prefix="$path/" $subcommit
        ' >/dev/null
}

while git ls-files -s | grep -q ^160000; do
    read_one_level
done

git archive --format=tar $(git write-tree)

rm -f "$GIT_INDEX_FILE" 
```

托马斯拉斯特在[http://git.661346.n2.nabble.com/Running-git-archive-recursively-over-submodules-td4577012.html](http://git.661346.n2.nabble.com/Running-git-archive-recursively-over-submodules-td4577012.html)

这给了我在 Windows 和 Linux 上都没有找到对象文件的错误。

**第二种方法** [https://github.com/meitar/git-archive-all.sh](https://github.com/meitar/git-archive-all.sh)

抱怨在 Windows 上找不到 mktemp。`git archive`并且更正对(from ) 的调用`git-archive`不会在 tar ...:(

**第三种方法** [https://github.com/Kentzo/git-archive-all](https://github.com/Kentzo/git-archive-all)

从我的角度来看，由于与最新的 python 3.3 不兼容，并且由于相同的文件抱怨，使用 2.7 仍然不能完全工作，因此已经过时。

所以我现在的问题是：最近有什么方法/方法来处理导出/归档一个包含子模块的 git 项目吗？

或者我应该检查这个工作流程的子树吗？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-10-03T19:11:57.290

我正在使用以下代码

```
git archive -o release.zip HEAD
git submodule --quiet foreach 'cd $toplevel; zip -ru release.zip $sm_path' 
```

创建包含所有子模块的 git 存储库的完整存档。

如果你想变得花哨，你甚至可以通过重写 zip 评论

```
echo -e "Repository:\n$(git rev-parse HEAD)\nSubmodule status:\n$(git submodule status)" | zip -u release.zip -z 
```

所有在 windows 上使用 infozip。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-26T13:59:33.330

[正如@Kentzo 所说， https://github.com/Kentzo/git-archive-all](https://github.com/Kentzo/git-archive-all)现在正在 linux 下工作。

在 cygwin 环境中（通过 cygwin 安装程序安装了 git 和 python）它也可以在那里工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-08T03:18:05.937

我们可以做一个快速的 bash 脚本，在 tar、模块和子模块中存档，在我们连接 tar 和压缩之后，这是一个包含 2 个子模块的示例：

```
#!/bin/bash

set -e

pwd=$(pwd)
date=$(date +%Y%m%d)
package=gitreponame
branch=master
name=tarbz2name
submodule1=/src/app/sub1/
submodule2=/src/sub2/

pushd ${package}
git checkout ${branch}
git pull
tag=$(git rev-list HEAD -n 1 | cut -c 1-7)
git archive --prefix="${name}/" --format=tar master > "$pwd"/${name}-${date}-${tag}.tar

git submodule update --init

cd ${submodule1}
git archive  --prefix="${name}${submodule1}" --format=tar master > "$pwd"/sb1.tar
cd -

cd ${submodule2}
git archive --prefix="${name}${submodule2}" --format=tar master > "$pwd"/sb2.tar
popd

tar -Af ${name}-${date}-${tag}.tar sb1.tar
tar -Af ${name}-${date}-${tag}.tar sb2.tar
bzip2 ${name}-${date}-${tag}.tar
rm sb1.tar sb2.tar 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-25T07:31:01.660

第二种方法：[https](https://github.com/meitar/git-archive-all.sh) ://github.com/meitar/git-archive-all.sh部署为独立的 Bash 脚本，并且似乎仍在维护中。我发现这是一种快速拍摄项目子模块快照的简单方法。它甚至可以捕获较早的版本（有点，见下文）：

```
git-archive-all.sh --tree-ish (tag) ## for example 
```

可能会或可能不会破坏交易的几个问题：

*   我在尝试使用该`--format`选项时遇到了问题——但默认的`tar`, 通常有效。

*   （非常）大问题：它捕获了我的子模块，但仅在其当前版本中 - 而不是指定版本。哎呀！

作为一个 Bash 脚本，这可能需要某种 Linux 兼容层（如 Cygwin）才能在 Windows 下运行。

* * *

看起来这应该是 Git 的内置功能——用脚本拼凑起来太复杂了。我想没有多少人使用子模块*或*git-archive，所以想要同时使用的人更少。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-27T13:47:38.833

如果您和我一样是 KISS 的朋友，您可以使用@tb 的答案，因为我发现此解决方案不会存档嵌套子模块。以下代码将有所帮助

```
# archive main directory
$ git archive --format tar -o release.tar HEAD
# descend recursively and archive each submodule
$ git submodule --quiet foreach --recursive 'git archive --format tar --prefix=$displaypath/ -o submodule.tar HEAD'
# concatenate with main archive
$ TOPDIR=$(pwd) git submodule --quiet foreach --recursive 'cd $TOPDIR; tar --concatenate --file=release.tar $displaypath/submodule.tar; rm -fv $displaypath/submodule.tar'
$ gzip -9 release.tar 
```

结果将是文件 result.tar.gz ...当然，您可以选择另一个提交而不是 HEAD。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-25T15:21:12.820

我开发了[git-archive-with-submodules](https://github.com/chrismaes87/git-archive-with-submodules)使用`bash`. 它还具有允许创建包含未提交更改的存档的不错功能。

# c# - 身份验证和导航栏

> ID：14783132
> 
> 赞同：1
> 
> 时间：2013-02-08T23:37:33.340
> 
> 标签：c#, asp.net, asp.net-mvc

我想在我的页面左侧设置一个菜单导航，该导航仅在用户登录后显示。

我不知道如何在我的 index.cshtml 文件中使用 MVC4 WebSecurity 类和 Razor 来实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T11:11:47.177

尝试使用 2 布局：

_Layout.cshtml 用于非登录用户和

_memberLayout.cshtml 用于登录用户。将您的会员菜单放在 _memberLayout 中。

/首页/索引控制器：

```
 public ActionResult Index()
    {
        if (User.Identity.IsAuthenticated)
        {
            return RedirectToAction("Index", "Member");
        }

        return View();
    } 
```

/成员/索引控制器：

```
 [Authorize]
    public ActionResult Index()
    {
        return View();
    } 
```

成员文件夹中的 Index.cshtml：

```
@{
    ViewBag.Title = "Member Area";
    Layout = "~/Views/Shared/_memberLayout.cshtml";
}

<div>
         ... your member html code
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:43:14.153

如果您使用的是 Windows 窗体身份验证，请查看 User.Identity.IsAuthenticated

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-30T00:31:47.430

**使用两个布局页面**

*   _Layout.cshtml
*   _MemberLayout.cshtml

**那么你有两个选择：**

* * *

**第一**：在_ViewStart.cshtml

改变

```
Layout = "~/Views/Shared/_Layout.cshtml"; 
```

到

```
if (Request.IsAuthenticated)
{
    Layout = "~/Views/Shared/_MemberLayout.cshtml";
}
else
{
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

* * *

**或者：**在每个视图的开头执行以下操作：

```
@{
    ViewBag.Title = "Home Page";
    if (Request.IsAuthenticated)
    {
        Layout = "~/Views/Shared/_MemberLayout.cshtml";
    }
}
```

# mysql - 别名多个“AS”语句 - 缩短语法数量 - 不必为每个别名都说“AS”？

> ID：14783134
> 
> 赞同：0
> 
> 时间：2013-02-08T23:37:40.430
> 
> 标签：mysql, sql, alias

将别名与您的选择查询一起使用时，如下所示：

```
SELECT u.col1 AS u_col1
    , u.col2 AS u_col2
    , u.col3 AS u_col3
    -- etc
    , u2.col1 AS u2_col1
    , u2.col2 AS u2_col2
    , u2.col3 AS u2_col3
etc. 
```

* * *

有没有办法缩短语法量？所以你不必为每个别名都说“ **AS** ”？

我想也许：`SELECT u.col1, u.col2 AS u_col1, u_col2`

但这没有用。有谁知道这是否可能？

谢谢大家:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:46:26.823

[http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)

> `AS`当使用标识符为 select_expr 起别名时，该关键字是可选的。

所以只需这样做：

```
SELECT 
      u.col1 u_col1
    , u.col2 u_col2
    , u.col3 u_col3
    ... 
```

# ruby-on-rails-3 - simple_form 在表单字段的名称中创建括号

> ID：14783136
> 
> 赞同：2
> 
> 时间：2013-02-08T23:38:07.030
> 
> 标签：ruby-on-rails-3, simple-form

我的用户模型中有一个生日，我使用了 simple_form 用于生日的示例：

```
<%= f.label "When is your birthday?" %>
<%= f.input :birthday, as: :date, start_year: Date.today.year - 60,
                      end_year: Date.today.year, order: [:month, :day, :year], label: false %> 
```

这将创建名称birthday(1i)、birthday(2i)、birthday(3i)，然后导致此批量分配错误：

```
Can't mass-assign protected attributes: birthday(2i), birthday(3i), birthday(1i) 
```

现在如何将带括号的符号名称添加到 attr_accessible 方法？

# python - 用正则表达式替换两个标签之间的所有内容

> ID：14783140
> 
> 赞同：0
> 
> 时间：2013-02-08T23:38:16.083
> 
> 标签：python, regex

如果我有一个 xml 标签，例如：

```
<tag>
    ... abunch of stuff inside here
</tag> 
```

我将如何删除里面的所有东西，包括标签本身？

我试过`re.sub('<tag>.+</tag>', '', string)`了，但没有用。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T23:41:54.837

您[无法](https://stackoverflow.com/a/1732454/721269)使用正则表达式解析 XML。这是不可能的。许多人创建了似乎有效的正则表达式，然后在遇到任何未预料到的情况时立即中断。您确实需要使用 XML 解析器来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:02:03.563

你能安全地做到吗？这与`lxml`您的愿望背道而驰，`re`但您可能已被其他人的评论所说服，即使用`re`充满危险。

```
import lxml.etree as etree

xml = """<root>
<item name="1"/>
<item name="2"/>
<tag>
    <nested>Will I die</nested>
    ... abunch of stuff inside here
</tag>
<another/>
</root>"""

root = etree.fromstring(xml)
for to_kill in root.xpath("//tag"):
    to_kill.getparent().remove(to_kill)

print etree.tostring(root,  pretty_print=True) 
```

给出：

```
<root>
<item name="1"/>
<item name="2"/>
<another/>
</root> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-09T00:26:22.717

我以前实际上使用过 xml，但它是很久以前的。我正在使用 svgs，我正在处理编辑 svgs。如果您想删除标签内的内容，我相信您应该在 javascript 或 jquery 中寻找答案。

# jquery - 遍历 DOM 并移除一个类

> ID：14783141
> 
> 赞同：0
> 
> 时间：2013-02-08T23:38:19.973
> 
> 标签：jquery, dom, dom-traversal

我在一个页面上有几个表单，每个表单都有它自己的“消息框”来显示验证错误。每个“消息框”都有一个关闭按钮。让关闭按钮关闭“消息框”没有问题，但我还需要它从有问题的文本输入中删除类“错误”。页面内容是由 ajax 引入的，因此是“.on”

伪 HTML（请记住，在任何时候都有 8 个这些都包含在自己的表单标签中，消息框和关闭按钮是其中的一部分。

```
<form action="#" method="post" id="Form6">
    <ul>
        <li>
            <label for="foo">label</label>
            <input type="text" name="foo" id="foo">
            <input type="submit" id="Button6" value="submit" />
        </li>
    </ul>
    <div id="Msg6" class="error"><a class="close">X</a><ul></ul></div>
</form> 
```

我的尝试

```
$('body').on('click', 'a.close', function(){
    $(this).parent().fadeOut("fast");
    $(this).closest('input[type="text"].error').removeClass('error'); // doesn't work
    $('a.close').closest('ul > li > input.error').remove();// doesn't work
    //console.log($.closest('input[type="text"].error'));//tring to log the value of the ancestor
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:41:51.807

这应该有效：

```
$(this).parents('form').find('input.error').removeClass('error'); 
```

但是如果要删除它，无需更改类，只需使用`.remove()`...

# php - 如何组合 JSON 结果

> ID：14783144
> 
> 赞同：0
> 
> 时间：2013-02-08T23:38:29.850
> 
> 标签：php, jquery, json

我可以结合 JSON 的这个结果吗？

问题是，在尝试在 codeigniter 上组合此结果时，我在调用成员 result_array() 时收到错误致命错误

```
$this->alerts
            ->select('products.id as productid, products.code as code, products.name, products.price, sum(purchase_items.quantity)')
            ->from('products');
            $this->alerts->join('purchase_items', 'products.id = purchase_items.product_id');
                $this->alerts->group_by("products.id");
            echo "Total Purchases";
            echo $this->alerts->generate();

 $this->alerts
            ->select('products.id as productid, products.code as code, products.name, products.price, sum(sale_items.quantity)')
            ->from('products');
            $this->alerts->join('sale_items', 'products.id = sale_items.product_id');           
                $this->alerts->group_by("products.id");
            echo "Total Sales";
            echo $this->alerts->generate(); 
```

结果为 JSON：

```
{"sEcho":0,"iTotalRecords":210,"iTotalDisplayRecords":210,"aaData":[["522","E12345","BAMBOO SCARF","100.00","3"]],"sColumns":"productid,code,products.name,products.price,sum(sale_items.quantity)"}

{"sEcho":0,"iTotalRecords":210,"iTotalDisplayRecords":210,"aaData":[["522","E12345","BAMBOO SCARF","100.00","15"]],"sColumns":"productid,code,products.name,products.price,sum(sale_items.quantity),productid,code,products.name,products.price,sum(purchase_items.quantity)"} 
```

从 json 获取数据的脚本：

```
$(document).ready(function() {
                $('#fileData').dataTable( {
                    "aLengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                    "sPaginationType": "full_numbers",  
                    "aaSorting": [[ 0, "desc" ]],
                    "bJQueryUI": true,
                    "sDom": '<"H"frlT><"clear">t<"clear"><"F"ip>',
                        //<"H"T><"clear">
                        //"sDom": '<"top"i>rt<"bottom"flp><"clear">',
                    'bProcessing'    : true,
                    'bServerSide'    : true,
                    'sAjaxSource'    : 'index.php?getdata',
                    'fnServerData': function(sSource, aoData, fnCallback)
                    {
                      $.ajax
                      ({
                        'dataType': 'json',
                        'type'    : 'POST',
                        'url'     : sSource,
                        'data'    : aoData,
                        'success' : fnCallback
                      });
                    },  
                    "oLanguage": {
                      "sSearch": "Filter: "
                    },
                    "aoColumns": [ 
                      null,
                      null,
                      null,
                      null,
                      null,
                      { "bSortable": false }
                    ]

                } );

            } ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:48:06.950

与其立即回显响应，不如尝试将它们堆叠成一个数组，然后输出 JSON。

```
<?php

//......

$result = arrray();

$result[] = $this->alerts->generate();
$result[] = $this->alerts2->generate();

echo json_encode($result); 
```

# ios - CGColorRef 不透明类型的对象的 ID

> ID：14783145
> 
> 赞同：2
> 
> 时间：2013-02-08T23:38:29.887
> 
> 标签：ios, core-foundation, opaque-pointers

我希望通过这项研究了解 CoreFoundation 对象的内部结构。[下面给出了来自免费石英项目](http://code.google.com/p/freequartz/source/browse/trunk/CoreGraphics/CGColorPriv.h?r=42)的 CGColor 的结构。

```
typedef struct CGColor {
        CFRuntimeBase obj;

        CFTypeID nextID;
        CGColorSpaceRef colorSpace;
        CGPatternRef pattern;
        size_t numberOfComponents;
        CGFloat *components;
} *CGColorRef; 
```

保持全局线程安全的唯一值，该值随着创建并分配给 nextID 成员的每个 CGColor 对象而递增。只有未记录的 CGColorGetIdentifier() 函数返回此值。

我检查了 CoreGraphics 及其资源库。我发现只有 ripc_GetColor (libRIP.A.dylib) 函数调用了 CGColorGetIdentifier() 函数，它似乎比较了一些颜色对的 nextID 值。

> CGColorGetIdentifier 的调用堆栈；（希望有助于推断 nextID）
> 
> ```
> 0   com.apple.CoreGraphics CGColorGetIdentifier + 0
> 1   libRIP.A.dylib          ripc_GetColor + 112
> 2   libRIP.A.dylib          ripc_DrawGlyphs + 1740
> 3   com.apple.CoreGraphics  CGContextDelegateDrawGlyphs + 108
> 4   com.apple.CoreGraphics  drawGlyphs + 284
> 5   com.apple.CoreGraphics  CGContextShowGlyphsWithAdvances + 208 
> ```

CFEqual 首先比较引用，如果它们不相等，则比较内容，因此比较引用是一种正确的方法。如果不更改引用，那么创建和维护唯一的 ID 值将是一种浪费。

因此，可能需要唯一 ID 并比较它们是否相等；

1.  当存在线程安全问题时，比较 ID 可能优于比较引用。获取引用后，引用指向的内容（数据）可能会在您身后（由另一个线程）更改。
2.  或者，即使在同一个线程中，为了进一步使用而存储的引用也会被一些其他不可预见的动作释放和/或修改。

所以，我们可以使用一些关于内容的引用，并确保它们可以一直使用（释放内存时引用可能变得无效）。此外，当使用一些数据（如 ID）而不是整个内容时，性能将得到优化。

Apple Core Graphics 的 CGColor 中这个 nextID 的真正意图是/可能是什么？它是从以前的方法遗留下来的，所以不能完全放弃吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T00:43:56.323

id 表示 nextID 字段的作用有点像内容摘要。它标识对象的相同内容——在本例中为颜色。

Equal 的对象不能有我们都知道的相同的引用。即使它们包含相等的数据并且实际上相等..例如RGB中的黑色或BW中的黑色......两者都是黑色：D（只是一个例子！） - 因此您需要比较它们的内容。

对于数字或日期，您可以找到... 它们被称为标记数字和标记日期。

# mysql - 在后台复制大型 MySQL 表

> ID：14783148
> 
> 赞同：0
> 
> 时间：2013-02-08T23:38:43.860
> 
> 标签：mysql

我需要将一个大的（8000 万条记录）MySQL 表复制到另一个表中，因为我需要向表中添加索引并且使用 ALTER 会太慢/内存不足。

我尝试在屏幕实例中运行包含 INSERT INTO table2 SELECT * FROM table1 的 MySQL 脚本，以便我可以分离并退出 SSH 会话，但由于某种原因，它完成了前 2000 万行（花了几个小时）然后它随机停止。这种方法需要大量内存吗？我还能如何在后台快速执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:48:50.360

将表转储到 .csv 文件中

```
mysqldump -u [username] -p -t -T/path/to/directory/file.txt [database] [table]  --fields-terminated-by=, 
```

使用正确的架构创建一个新表

然后加载包含 .csv 数据的新表

```
LOAD DATA INFILE '/path/to/directory/file.txt' INTO TABLE database.new_table FIELDS TERMINATED BY ',' 
```

仅供参考：这些命令未经测试，可能需要一些调整，但你应该明白

# design-patterns - 工厂模式中的创建条件应该迁移到哪里？

> ID：14783149
> 
> 赞同：1
> 
> 时间：2013-02-08T23:39:00.737
> 
> 标签：design-patterns, factory

![在此处输入图像描述](../Images/0c96cb699fa94e948e1a608127fda63d.png)

在这张图片中，您可以看到源类中的一些常量，它们帮助工厂生成正确的对象。有人告诉我这是一种反模式，我应该将这些常量移到另一个类。我应该把他们搬到工厂班吗？

这是工厂类的代码：

```
class Factory
{
        public function make($format)
        {
                switch ($format)
                {
                        case Source::Assocs:
                                return new SourceFormatsAssocs();
                        case Source::XML:
                                return new SourceFormatsXML();
                        //Some more formats
                }
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:49:17.427

这确实可以防止在不修改基类的情况下添加新的子类（添加新常量）。我确实会把它搬到工厂。工厂必须知道它可以创建的所有类型的子类。基类不需要知道它的子类。

此外，这些常量仅由工厂（以及工厂的调用者）使用。基类根本不使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T05:29:17.033

一个更好的主意是考虑建造者。为什么？因为您可以拥有一个知道 Formats 类型的抽象类，然后是构造各种子类型的具体 Builders。请注意，当构建涉及通过多个步骤使某些东西变得复杂时，应该完成构建器，但是构建器模式有多种变体，例如 Bloch 中的静态构建器和流利的构建器，您可以使用该模式将调用链接到使代码更具可读性，并内联生成产品。

另一种可能性是[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)。如果您对自己的班级是否值得 Builder 感到不安，这可能是一个很好的匹配。

# javascript - Colorbox不显示边框或按钮，其他问题

> ID：14783154
> 
> 赞同：0
> 
> 时间：2013-02-08T23:39:16.323
> 
> 标签：javascript, jquery, colorbox

我已经看到了一些关于同样问题的问题，并且我已经尝试了其中建议的所有内容，但到目前为止没有任何效果。

我正在按照它们应该是的顺序加载 css/js 文件：Colorbox.css->jQuery.js->Colorbox.js（在它们之间加载了其他 css 和 js 文件）。

我正在通过脚本启动颜色框：

```
$().ready(function() {
    $('.dgallery').click(function(e) {
        e.preventDefault();
        $('a[class=dgallery]').colorbox({
            rel:'dgallery', 
            slideshow:true,
            preloading:true,
            slideshowSpeed:4000
        }).click();
    });
}); 
```

HTML（.dgallery 在样式表中有 display:none ）：

```
<a class="dgallery" href="/assets/images/VideoSlides/slide1.png"></a>
<a class="dgallery" href="/assets/images/VideoSlides/slide2.png"></a>
<a class="dgallery" href="/assets/images/VideoSlides/slide3.png"></a> 
```

问题似乎因浏览器而异：

*   Chrome 显示灯箱和图像，但缺少边框和按钮。有时，我看到灯箱打开并显示“图像无法加载”，然后继续播放幻灯片并且它可以正常工作（但仍然缺少边框和按钮）。

*   Firefox 会打开看起来不错的灯箱。但它只是与“加载”图形一起坐在那里，从不加载图像。

*   IE 与 Chrome 做同样的事情。有时我看到浏览器在打开灯箱之前闪烁白色。

我不确定我还缺少什么。

# java - 从列表中删除字符串并在java中排序

> ID：14783159
> 
> 赞同：1
> 
> 时间：2013-02-08T23:39:41.693
> 
> 标签：java, list, alphabetical, listiterator

我有返回名称和值的列表，我有兴趣通过检查返回列表是否按字母顺序排列来创建 Junit 测试。到目前为止，我已经这样做了，但我得到的结果总是 = TRUE，因为我相信它正在考虑“MINTS ......”。所以我的目标是从列表中删除 MINTS ( Name ) 并检查列表 ( VALUE ) 的订单。

从表中列出

![在此处输入图像描述](../Images/57ca65eda1a81582a8008f4a6b460966.png)

Junit 代码

```
public void test() throws Exception
    {
        DataObj dao = new DataObj();

        HashMap<String, Object> params = new HashMap<String, Object>();
        params.put( "code", 100 );

        List<?> values = dao.getDataObj( params, conn );

        String previous = "";
        boolean result = false;

        for ( final Object vCurrent : values )
        {

            String current = vCurrent.toString();
            if ( current.compareTo( previous ) < 0 )
            {
                result = false;
                previous = current;

            }
            result = true;
        }

    } 
```

如果我对值进行打印，我会得到类似“薄荷糖戴夫薄荷糖杰基薄荷糖德里克.....”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:45:06.213

您总是`result = true`在循环的每次迭代结束时进行设置。

你可以这样做：

```
 String previous = "";
    boolean result = true;

    for ( final Object vCurrent : values )
    {

        String current = vCurrent.getValue();
        if ( current.compareTo( previous ) < 0 )
        {
            result = false;
            break;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:34:45.593

如果这应该是 JUnit 测试，那么您应该使用 JUnit "assertXxxx" 方法来进行低级测试；例如像这样的东西

```
 import static org.junit.Assert.*;

    ....

    @Test
    public void testOrdered() {
        DataObj dao = new DataObj();

        HashMap<String, Object> params = new HashMap<String, Object>();
        params.put( "code", 100 );

        List<?> values = dao.getDataObj( params, conn );

        String previous = "";
        for (final Object vCurrent : values) {
            String current = vCurrent.toString();
            assertTrue("list not ordered correctly",  /* this arg is optional */
                       current.compareTo(previous) < 0);
            previous = current;
        }
    } 
```

这完全消除了产生“结果”的需要。

# apache - JBoss 和 ProxyPass Apache 指令的问题

> ID：14783160
> 
> 赞同：0
> 
> 时间：2013-02-08T23:39:45.247
> 
> 标签：apache, jboss, jboss7.x, mod-proxy, mod-jk

我的 JBoss 7.1 (standalone.xml) 配置如下：

```
<subsystem xmlns="urn:jboss:domain:web:1.1" default-virtual-server="default-host" native="false">
            <connector name="http" protocol="HTTP/1.1" scheme="http" socket-binding="http"/>
            <connector name="ajp" protocol="AJP/1.3" scheme="http" socket-binding="ajp"/>
            <virtual-server name="default-host" enable-welcome-root="false" default-web-module="mydefaultapp">
                <alias name="localhost"/>
                <alias name="www.mydefaultapp.it"/>
            </virtual-server>
            <virtual-server name="secondApp" enable-welcome-root="false" default-web-module="secondApp">
                <alias name="www.secondapp.com"/>
            </virtual-server>
        </subsystem> 
```

'mydefaultapp' 将“/”定义为 jboss-web.xml 文件中的 context-root 并与 mod_jk 完美运行：

```
<VirtualHost *:80>
        ServerName      www.mydefaultapp.it

        DocumentRoot /var/www/mydefaultapp
        <Directory />
                Options FollowSymLinks
                AllowOverride None
        </Directory>
        <Directory /var/www/mydefaultapp>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                Order allow,deny
                allow from all
        </Directory>

        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                Order allow,deny
                Allow from all
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log
        LogLevel warn
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        SetEnvIf Request_URI "/foto/*" no-jk
        JkMount / ajp13
        JkMount /* ajp13

</VirtualHost> 
```

现在我有那个没有定义上下文根的'secondapp'战争，所以它假设'/ secondapp'。如果我尝试使用 '/' context-root 部署它，我会收到此错误：

> 安装：无法处理部署“foo.war”的阶段安装原因：org.jboss.msc.service.DuplicateServiceException：服务 jboss.web.deployment.default-host./.realm 已注册

如果我使用 '/secondapp' context-root 部署它，则没有任何效果。只需 www.secondapp.com 以 404 not found 错误结尾。

一个可能的解决方案是使用具有此配置的 http 代理：

```
<VirtualHost *:80>
    ServerName www.secondapp.com
    ProxyPass         /     http://localhost:8080/secondapp/
    ProxyPassReverse  /     http://localhost:8080/secondapp/
</VirtualHost> 
```

这似乎有效，但是......我无法访问 jsf 资源（我不断收到登录表单，我的安全性存在一些问题）

您能否建议我拥有两个域的正确配置，与 JBoss 7.1 + Apache2 + mod_jk 进行两次战争。记住第一个有“/”上下文根，而第二个有“/secondapp”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T08:23:33.753

最后我用 mod_jk 做到了！这是关于标签的，它令人困惑。我写了一篇博客：http: [//fabiobozzo.wordpress.com/2013/02/25/multiple-web-applications-with-jboss-and-apache/](http://fabiobozzo.wordpress.com/2013/02/25/multiple-web-applications-with-jboss-and-apache/)

# javascript - JSON 获取键/值：如果不存在，JS 就停止。如何解决设置数组？

> ID：14783164
> 
> 赞同：0
> 
> 时间：2013-02-08T23:39:54.707
> 
> 标签：javascript, jquery, json

给定 localStorage 中的大型 JSON 表和用户提供的给定键，我访问关联的值。但是如果值和/或键不存在，那么我想创建它们。然而...

**给定以下 JSON：**

```
var data = [ 
{ 'myKey': 'A', 'status': 0 },
{ 'myKey': 'B', 'status': 1 },
{ 'myKey': 'C' },
{ 'myKey': 'D', 'status': 1 }
]; 
```

以及**以下JS：**

```
function getJsonVal(json, itemId) {
    for (var i in json) {
        if (json[i].myKey == itemId) {
            return json[i]; 
        }
    }
} 
```

如果我...

```
// request non-existing-in-JSON value:
valC = getJsonVal(data, 'C');
alert("this is C's value: "+ valC) 
```

或者

```
// request non-existing-in-JSON key:
keyE = getJsonVal(data, 'E');
alert("this is E: "+ keyE); 
```

脚本只是中途停止。

**我希望有一些错误值允许我制作类似的东西`If ( null|| undefined ) Then create new key/value`，但我的脚本只是停止，因为这些项目不存在。有什么解决办法吗？**Jsfiddle 赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:46:01.857

使用 typeof 运算符，您可以安全地检查是否设置了属性

```
function getJsonVal(json, itemId) {
    for (var i in json) {
        if (typeof json[i].myKey != 'undefined' && json[i].myKey == itemId) {
            return json[i]; 
        }
    }
    return 'someDefault';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T23:49:55.617

我对您的示例代码的修订：

[http://jsfiddle.net/dqLWP/](http://jsfiddle.net/dqLWP/)

```
var data = [ 
{ 'myKey': 'A', 'status': 0 },
{ 'myKey': 'B', 'status': 1 },
{ 'myKey': 'C' },
{ 'myKey': 'D', 'status': 1 }
];

function getJsonVal(json, itemId) {
    for (var i in json) {
        if (json[i].myKey == itemId) {
            return json[i]; 
        }
    }
}

var output = getJsonVal(data, 'E');
alert("this is the outputted value: "+ output);

if ( ! output) {
    alert('time to create that new key/value you wanted');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T23:44:21.180

`C`除非您正在为变量和某处设置值，否则您`E`需要将它们放在引号中：

```
// request non-existing-in-JSON value:
valC = getJsonVal(data, 'C');
alert("this is C's value: "+ valC)

// request non-existing-in-JSON key:
keyE = getJsonVal(data, 'E');
alert("this is E: "+ keyE); 
```

此外，您应该提醒您设置的变量（`valC`或`keyE`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-31T19:44:10.447

为了改进林登的回答：

```
function getJsonVal(json, itemId) {
    for (var i in json) {
        if (json[i].myKey == itemId) {
            return json[i].status; // add .status here so you can see the value of keys that exist and have one.
        }
    }
} 
```

# algorithm - 赏金分配均衡

> ID：14783173
> 
> 赞同：-1
> 
> 时间：2013-02-08T23:41:17.687
> 
> 标签：algorithm, math, distribution

我需要一种算法，就像 Travian 中使用的那样。我想知道如何制作它，以便有 4 种资源类型，当有人袭击时，他们会占用这么多，但他们从每种资源类型中占用相等的百分比，具体取决于袭击可用的资源量。所以假设我可以突袭 450 资源，但防御者有 300 木材、400 粘土、200 铁和 100 小麦，我将取木材占总资源的百分比，然后将其乘以赏金。问题是当我四舍五入时，有时会得到 449/450 或 451/450。

那么有什么方法可以解决舍入问题，有人可以编译整个算法吗？我只是很好奇，就像我平时一样，出于好奇编译了大量的算法，比如 Elo、Torus 和其他非常基本的算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-22T14:24:51.030

如果您希望它们都“平均分布”，那么您偶尔会遇到舍入问题。如果我的容量是 100 并且有三个相等的资源，那么仅四舍五入就永远无法正确计算。

如果发生这种情况，只需选择一个来“修复”它。我通常会选择最后一个资源。只需像往常一样将除最后一个之外的所有值四舍五入，然后从总数中减去它们（450 或在您的示例中），这就是您的最后一个资源值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T02:04:17.603

[您可以使用modulo](http://en.wikipedia.org/wiki/Modulo_operation)计算余数，并随机分配余数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-22T10:01:57.727

为什么要让你的掠夺者占被掠夺城镇资源的百分比？根据我的说法，袭击者应该根据自己的能力来平衡数量的每种资源。

用你的例子：

```
Raiders capacity - 450
Wood - 300
Clay - 400
Iron - 200
Wheat - 100

While  Not Empty (Wood and clay and Iron and Wheat) and Not Full ( Raiders )
    Raiders pick up 1 each ressources 
```

经过这一步攻略有`400`资源（因为没有小麦了）。

镇栈

```
Wood - 200
Clay - 300
Iron - 100
Wheat - 0 
```

对剩余资源执行相同操作： `50 / 3 = 16`

之后的攻略栈是这样的：

```
Wood - 116
Clay - 116
Iron - 116
Wheat - 100
TOTAL : 448 
```

然后你有两个解决方案，选择最大堆栈中的资源或继续你的循环。如果您选择在最大的情况下获取资源：

当前库存：

```
Wood - 184
Clay - 284
Iron - 84
Wheat - 0
TOTAL : 552 
```

选择 2 个单位的粘土然后你有以下结果：

**镇栈**

```
Wood - 184
Clay - 282
Iron - 84
Wheat - 0
TOTAL : 550 
```

**攻略栈**

```
Wood - 116
Clay - 118
Iron - 116
Wheat - 100
TOTAL : 450 
```

这只是另一个观点。你觉得有趣吗？

# javascript - 清理 Javascript/Nodejs 代码

> ID：14783187
> 
> 赞同：1
> 
> 时间：2013-02-08T23:43:26.180
> 
> 标签：javascript, node.js, asynchronous, coding-style

我是 javascript / nodejs 的新手，我正在尝试清理一些代码。

我正在使用[async](https://github.com/caolan/async "异步") nodejs 库来处理使代码的异步部分更容易。

现在代码如下所示：

```
Object.prototype.method = function(){
  var self = this; 
  // bunch of code
  async.forEach(self.someArr, function(someObj, callback){
    self.somefunc(someObj.someProp, function(err, aNewObj) {
      if (err) {
        return callback(err);
      }

      self.someOtherArr.push(aNewObj.someOtherProp);
      callback();
   });
 }, callback);
} 
```

但是，我想用对象原型上定义的另一个命名函数替换匿名函数。由于代码的结构方式，我不知道如何创建一个新函数来传递`async.forEach`，同时保留正确的`self`值。

我希望它看起来像什么：

```
AnObject.prototype.method = function(){
  var self = this; 
  // bunch of code 
  async.forEach(self.someArr, self._newMethod, callback);
}

AnObject.prototype._newMethod = function(someObj, callback){
  var self = this;
  self.somefunc(someObj.someProp, function(err, aNewObj) {
    if (err) {
      return callback(err);
    }
    self.someOtherArr.push(aNewObj.someOtherProp);
    callback();
  });
} 
```

但这显然行不通，因为上下文发生了变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:56:45.570

除非该函数在 self 存在的同一个闭包中定义，否则您需要使用一些东西来代理它：

```
async.forEach(self.someArr, function(someObj, callback){
   self.somefunc(someObj.someProp, function(err, aNewObj) {
       self.otherfunc(err, aNewObj, callback);
   });
 }, callback); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:23:49.223

如果你稍微改变一下你的风格，你可以很容易地完成这项工作。

```
AnObject = function() {
    var self = this;

    self.method = function(){
        // bunch of code 
        async.forEach(self.someArr, self._newMethod, callback);
    };

    self._newMethod = function(someObj, callback){
        self.somefunc(someObj.someProp, function(err, aNewObj) {
            if (err) {
                return callback(err);
            }
            self.someOtherArr.push(aNewObj.someOtherProp);
            callback();
        });
    };
}; 
```

# assembly - 寻找低级编程语言的学习资料

> ID：14783191
> 
> 赞同：0
> 
> 时间：2013-02-08T23:43:57.040
> 
> 标签：assembly, operating-system, hex, low-level-code

我希望学习用于编写驱动程序和固件以及其他操作系统的裸机编程，但我终其一生都找不到任何好的学习材料来学习这些语言。我为 asm 找到的宝石很少而且相差甚远，而且我找不到任何关于直接十六进制编程的东西。当我说直接的十六进制时，我的意思是你可以在 Linux 内核的固件部分找到的那种东西。这是我在两个月的搜索中得到的最接近的结果：[http](http://www.omnimaga.org/index.php?topic=6272.0) ://www.omnimaga.org/index.php?topic=6272.0并且本教程的信息太少，并且没有根据我的知识进行跟进。

**TL;DR：**我想学习十六进制。在哪里？

**注意：**我确实意识到这将是一项多么困难、具有纪念意义和受虐狂的努力。你不必告诉我。在这个自我鞭笞的旅程中，我会比没有学习材料做得更好。

**第二点：**我已经对操作系统、内核和 I/O 设备的内部工作原理以及内存的工作原理和分配方式有了很多了解，并且我已经对平面组装有基本的了解。

我内心的极客是不安分的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T23:49:57.583

好吧，如果您想知道如何以十六进制编程 x86 处理器，您需要的所有信息都在[英特尔软件开发人员手册](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)中。最具体地说，您需要第 2 卷中的所有信息。第 2 章涵盖一般指令编码，第 3 章和第 4 章涵盖所有特定指令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T00:26:25.730

如果这让你内心不安的极客感到失望，我很抱歉，但我认为你误解了这些固件 blob 的目的以及它们的创建路径。

Linux 中存在的固件文件是需要上传到接口适配器的大量内容，并将由该适配器上存在的任何智能执行。通常这些是高度特定的 ASIC，需要将固件作为二进制 blob 上传有几个潜在原因：ASIC 生产商不想透露芯片的确切内部工作原理，或者不愿意（或能够) 与用户共享源代码或必要的工具。

但是，这并不意味着固件 blob 是某些 übergeek 整天疯狂地输入十六进制代码的结果，这些文件通常在工具链中开始它们的生命，这些工具链支持与常规编程相当的工作流：源代码是以某种高级语言（但不一定是 C 或 C++ 等常见语言之一）生成，并且该代码被编译为二进制文件 - 固件文件。

所以，虽然这可能是一个让人们在夏天的第一次烧烤时惊叹的巧妙技巧，但“编程十六进制”的实际应用几乎不存在，如果你真的想深入，汇编已经足够深入了。由于当今编译器技术的改进，即使大多数微控制器开发不再以汇编方式完成，所以最好的办法可能是挖掘旧的 DOS 软件，在那里你会发现很多用汇编代码编写的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T00:34:27.273

去查找你正在研究的 CPU 的处理器操作码。这些代码是将汇编 pnumonics 转换为“十六进制”值的罗塞塔石碑，并且是汇编器所做的大量工作。然后绝望地使用它。我在汇编方面有很强的背景，并且在调试发布版本时仍然偶尔会使用它。但是直接操作码读写不再那么有用了。我最后一次做这种事情是在 Color Gameboy 上编写自我修改代码，以便在 HBlanks 期间有效地填充调色板。正如我所说，非常、非常专业化，在现代没有用，因为讨厌的缓存会挡道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T23:52:56.303

您是否尝试过这个名为“Linux Assembly Tutorial”的文档

[http://docs.cs.up.ac.za/programming/asm/derick_tut/](http://docs.cs.up.ac.za/programming/asm/derick_tut/)

例如，它有一个“hello world”，上面写着（逐字复制）：

```
section .data
    hello:     db 'Hello world!',10    ; 'Hello world!' plus a linefeed character
    helloLen:  equ $-hello             ; Length of the 'Hello world!' string
                                   ; (I'll explain soon)

section .text
    global _start

_start:
    mov eax,4            ; The system call for write (sys_write)
    mov ebx,1            ; File descriptor 1 - standard output
    mov ecx,hello        ; Put the offset of hello in ecx
    mov edx,helloLen     ; helloLen is a constant, so we don't need to say
                     ;  mov edx,[helloLen] to get it's actual value
    int 80h              ; Call the kernel

    mov eax,1            ; The system call for exit (sys_exit)
    mov ebx,0            ; Exit with return code of 0 (no error)
    int 80h 
```

（我得到的谷歌查询是：[https](https://www.google.co.uk/search?q=how+to+write+drivers&oq=how+to+write+drivers) ://www.google.co.uk/search?q=how+to+write+drivers&oq=how+to+write+drivers ）

# ios - 我应该如何通过多个视图控制器传输数据？

> ID：14783195
> 
> 赞同：1
> 
> 时间：2013-02-08T23:44:42.473
> 
> 标签：ios, model-view-controller, uiviewcontroller, delegation

在 iOS 开发中，在视图控制器之间传递数据似乎过于复杂。以下是我所意识到的：使用 -(void)prepareForSegue 方法可以轻松地向前传递数据（推送视图）或直接向视图传递数据。使用 presentingViewCotnroller 和 presendedViewController 属性，数据可以轻松地在视图控制器之间来回移动。这是从第二个视图控制器返回到第一个视图控制器的数据示例。这是我正在谈论的示例代码：

```
 ((FirstViewController *)self.presentingViewController).firstViewControllerProperty = self.secondViewControllerProperty; 
```

但是，当我尝试通过多个视图控制器传递数据时，我被卡住了。似乎每个人都说使用委托并从 MVC 的角度思考。当我尝试这样做时，我被卡住了。原因如下：如果 viewControllerA 告诉模型保存一些数据，然后 viewControllerD 需要这些数据，我最终会让 viewControllerD 引用模型的一个实例。（我这样做 b/c 我不知道如何从视图控制器访问模型）我假设当我创建模型的实例时，这意味着我有一个没有我试图访问的数据的新模型.

然后我意识到也许我应该将我的模型设置为单例。我假设单例是当您设置一个由所有其他视图控制器引用的类时，它们不必创建模型类的实例。我对单身人士的了解越多，我就越觉得自己偏离了轨道。我尝试将所有这些东西放在一起，但它变得过于复杂。

我在这里错过了什么吗？我应该能够在不创建新实例的情况下从各种视图控制器中引用我的模型吗？我对 iOS 编程相对较新，我正在寻找能指出我正确方向的人。我应该把精力放在学习授权上吗？或学习单身人士？或学习目标行动？是否有简单的教程/书籍推荐来学习在视图控制器之间传输数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:50:42.830

如果您想要最简单的方法，只需向视图控制器添加一个属性，当您想要将数据传递给该视图控制器时，只需将该属性设置为您尝试传递的数据。另一种方法是在您的视图控制器上创建一个方法来接受数据，然后从调用代码中只需使用您要发送的数据调用该视图控制器上的该方法。

只要您有对要将数据传递到的控制器的引用，您就可以根据需要设置属性或调用方法。

不要对委托感到太困惑，它们只是一种使用方法提供通信接口的方式。我想说理解 iOS 开发中的委托是很重要的，因为它们被大量使用。

阅读[Objective-C 协议](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/WorkingwithProtocols/WorkingwithProtocols.html)，这些协议类似于其他语言的接口。委托就是我们所说的实现协议的对象。

只传递从前一个视图控制器需要知道的数据。您不需要在每次推送视图控制器时传递数据存储，只需推送您正在处理的对象的 id 或新视图完成其工作所需的任何变量。您的视图控制器都应该能够相互独立地访问数据存储，不要传递容易从数据存储中获取的数据。

# javascript - 如何检查字符串是否仅包含拉丁字符？

> ID：14783196
> 
> 赞同：67
> 
> 时间：2013-02-08T23:44:49.680
> 
> 标签：javascript

如何检查字符串是否`[a-zA-Z]`仅包含字符？

**例子：**

```
var str = '123z56'; 
```

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2013-02-08T23:47:00.440

不需要 jQuery

```
if (str.match(/[a-z]/i)) {
    // alphabet letters found
} 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-02-08T23:49:39.173

您可以使用正则表达式：

```
/[a-z]/i.test(str); 
```

使`i`正则表达式不区分大小写。你也可以这样做：

```
/[a-z]/.test(str.toLowerCase()); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-02-08T23:49:00.453

啊，自己找到了答案：

```
if (/[a-zA-Z]/.test(num)) {
  alert('Letter Found')
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-01-22T21:21:02.460

我很惊讶这里的答案在没有人真正回答问题时得到了如此多的支持。以下是确保给定字符串中只有拉丁字符的方法。

```
const hasOnlyLetters = !!value.match(/^[a-z]*$/i); 
```

`!!`需要将非布尔值转换为布尔值。（这与应用两次完全相同`!`，实际上您可以使用任意`!`多的次数来多次切换真实性。）

至于RegEx，这里是细目。

*   `/.../i`定界符是一种以不区分大小写`/`的`i`方式评估语句的方法。
*   `^...$``^`查看字符串开头的方法。`$`看字符串结尾的意思，和一起使用时，意思是考虑整个字符串。您可以在这些边界之外向 RegEx 添加更多内容，例如附加/前置所需的后缀或前缀。
*   `[a-z]*`这部分说要查找所有小写字母。（不区分大小写的修饰符意味着我们也不需要查看大写字母。）`*`最后的 表示我们应该多次匹配括号中的内容。这样，“abc”将匹配，而不仅仅是“a”或“b”，等等。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-08T23:49:25.710

不需要jquery：

```
var matchedPosition = str.search(/[a-z]/i);
if(matchedPosition != -1) {
    alert('found');
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-01-27T09:45:17.273

所有这些答案都是正确的，但我还必须检查字符串是否包含其他字符和希伯来字母，所以我简单地使用了：

```
if (!str.match(/^[\d]+$/)) {
    //contains other characters as well
} 
```

# php - php array_combine 将两个数组与额外的设施结合起来

> ID：14783208
> 
> 赞同：1
> 
> 时间：2013-02-08T23:46:56.247
> 
> 标签：php, arrays

我先道歉，但我今天已经编码了大约 8 个小时来完成这最后一件事。

代码。

```
$a = array('a', 'c', 'b');

$c = array('a', 'c', 'b');

foreach(array_combine($a, $c) as $k => $v) {
  echo $k.$v;
} 
```

导致： `aa, bb, cc`

但我想得到@

```
aa, ac, ab
ba, bc, bb
ca, cc, cb 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:50:22.563

如果您想要所有排列，那么我不确定您是否要使用 array_combine()。只需使用嵌套循环，如下所示：

```
$a = array('a', 'c', 'b');
$c = array('a', 'c', 'b');

foreach($a as $v1){
  foreach($c as $v2) {
    echo $v1.$v2;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T11:48:23.490

我建议您使用 foreach 功能。不要使用 array_combine()。

```
function cloop($a, $c) {

$a = array('a', 'b', 'c');
$c = array('d', 'e', 'f');

foreach($a as $A){

  foreach($c as $B) {

    $ab = $A.$B;

  }

}

return $ab;

} 
```

# java - 日历对象时区转换

> ID：14783214
> 
> 赞同：0
> 
> 时间：2013-02-08T23:47:19.163
> 
> 标签：java, calendar, timezone

我有一个日历对象，它位于 UTC 时区。我想将该日历对象中的日期和时间转换为 PST，同时牢记所有 DST。我正在寻找具有以下签名的辅助函数：

```
private Calendar getPSTTime(Calendar utcTime)
{

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T23:55:52.150

```
private Calendar getPSTTime(Calendar utcTime)
{
    TimeZone americaPacific = TimeZone.getTimeZone("America/Los_Angeles");
    Calendar pacificTime = Calendar.getInstance(americaPacific);
    pacificTime.setTime(utcTime.getTime());
    return pacificTime;
} 
```

仅供参考：方法返回所有可用的时区字符串标识符[`TimeZone.getAvailableIDs()`](http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html#getAvailableIDs%28%29)。我就是从那里得到`"America/Los_Angeles"`的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:26:49.263

Java 中的时间事件存储为该事件与 1970 年 1 月 1 日 00:00:00 GMT 之间的毫秒数（例如，就好像它发生在伦敦一样）

因此，每当我们在 Java 中谈论日期和时间时，以 java.util.Date 或 java.util.Calendar 为代表，我们总是谈论绝对数字，而不考虑时区。

只有当我们尝试将日期/时间输出为字符串时，时区才有意义。在我的脑海中，我可以回忆起两种方法：

*   使用日历，设置时区，使用 get(Calendar.XXX) 方法获取您想要的时区中的各个日期/时间组件
*   使用 SimpleDateTimeFormat，设置时区，将整个日期/时间格式化为您想要的时区的单个字符串

Java中确实没有“时区转换”之类的东西，但是有特定于时区的格式。

但是，如果您想让事情变得非常混乱，您可以将“更正”添加到您的日历时间值中，以便它返回字段值，就好像它在 PST 时区中一样：

```
private Calendar getPSTTime(Calendar utcTime)
{
   TimeZone pstZ = TimeZone.getTimeZone("America/Los_Angeles");
   long offset = pstZ.getOffset(utcTime.getTime());
   Calendar pacificTime = Calendar.getInstance();
   pacificTime.setTimeInMillis(utcTime.getTimeInMillis()-offset); 
   return pacificTime;
} 
```

# objective-c - 奇怪的 pushViewController 行为

> ID：14783216
> 
> 赞同：2
> 
> 时间：2013-02-08T23:47:32.327
> 
> 标签：objective-c, xcode

我的应用程序开始于`LoginViewController`. 登录视图有一个“注册”按钮，代码如下所示。如果我点击注册，当应用程序启动时，什么也没有发生。但是，如果我登录并注销，则注册按钮可以正常工作。

发生这种情况应该是什么问题？

应用委托：

```
...
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.

    //Load View Controllers;

    self.vcClubs = [[[ClubsViewController alloc] init] autorelease];
    self.vcParties = [[[PartiesViewController alloc] init] autorelease];
    self.vcEditProfile = [[[EditProfileViewController alloc] init] autorelease];

    self.navClubs = [[[UINavigationController alloc] initWithRootViewController:self.vcClubs] autorelease];
    self.navClubs.navigationBarHidden = YES;

    self.navParties = [[[UINavigationController alloc] initWithRootViewController:self.vcParties] autorelease];
    self.navParties.navigationBarHidden = YES;

    // Load Login View
    UIViewController *loginView = [[[LoginViewController alloc] init] autorelease];
    self.window.rootViewController = loginView;
    [self.window makeKeyAndVisible];

    return YES;
}
...
- (void)login
{
self.vcMenu = [[[MenuViewController alloc] init] autorelease];
self.vcLocationMenu = [[[LocationMenuViewController alloc] init] autorelease];
self.mainController = [[[MainViewController alloc] init] autorelease];
self.mainController.leftViewController = self.vcMenu;
self.mainController.rightViewController = self.vcLocationMenu;

[self.mainController setMainViewController:self.navParties];
[self.mainController showMainViewControllerAnimated:YES];

self.window.rootViewController = self.mainController;

CATransition *transition = [[[CATransition alloc] init] autorelease];
transition.duration = 1;
transition.type = kCATransitionFade;
transition.subtype = kCATransitionFromBottom;
transition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
[self.window.layer addAnimation:transition forKey:@"login"];
}
... 
```

登录控制器.php：

```
...
- (IBAction)onTapSignupButton:(id)sender
{
RegisterViewController *controller = [[[RegisterViewController alloc] init] autorelease];
[self.navigationController pushViewController:controller animated:YES];
NSLog(@"%@", self.navigationController);
}
... 
```

在应用启动时返回 NSLOG：

```
2013-02-18 02:18:29.986 App[32652:c07] (null) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T04:31:57.040

它可能看起来很奇怪。但我犯了同样的错误。希望对你有帮助。。

检查您是否在 AppDelegate 中初始化了 UInavigationController。如果是，我不知道你为什么得到这个......如果不是，请尝试以下代码

```
RegisterViewController *controller = [[[RegisterViewController alloc] init] autorelease];
UINavigationController *nav=[[UINavigationController alloc]initWithRootViewController:controller]
[self.navigationController pushViewController:controller animated:YES]; 
```

根据您编辑的代码

```
 // Load Login View
UIViewController *loginView = [[[LoginViewController alloc] init] autorelease];
UINavigationController *nav=[[UINavigationController alloc]initWithRootViewController:loginView]
self.window.rootViewController = nav;
[self.window makeKeyAndVisible]; 
```

快乐编码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:01:30.567

似乎您第一次尝试时，LoginViewController 没有被包装在导航控制器中。我会检查登录/注销周期是否将登录控制器放入导航堆栈，并查看为什么在第一次出现登录时没有发生这种情况

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T04:57:34.563

试试这个，

```
RegisterViewController *controller = [[[RegisterViewController alloc] initWithNibName:@"RegisterViewController" bundle:nil];

[self.navigationController pushViewController:controller animated:YES]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-18T05:04:54.707

```
RegisterViewController *controller = [[[RegisterViewController alloc] init] autorelease];
[self.navigationController pushViewController:controller animated:YES]; 
```

由于 Objective C 内存管理，您的代码不正确 首先，您应该检查您的导航控制器是否不为零。然后^正确的代码看起来像

```
RegisterViewController *controller = [[RegisterViewController alloc] init];
[self.navigationController pushViewController:controller animated:YES];
[controller release]; 
```

# matlab - 如何加快 Eigen 库的矩阵乘积？

> ID：14783219
> 
> 赞同：7
> 
> 时间：2013-02-08T23:47:45.013
> 
> 标签：matlab, mex, eigen

我正在使用 Eigen 库研究两个大矩阵的简单乘法。对于相同大小的矩阵，这种乘法似乎明显慢于 Matlab 和 Python。

有什么办法可以使 Eigen 运算更快？

**问题详情**

X：随机 1000 x 50000 矩阵

Y：随机 50000 x 300 矩阵

**计时实验（在我 2011 年末的 Macbook Pro 上）**

使用 Matlab：X*Y 需要 ~1.3 秒

使用 Enthought Python：numpy.dot(X, Y) 大约需要 2.2 秒

使用 Eigen：X*Y 需要 ~2.7 秒

**特征细节**

您可以获取我的特征码（作为 MEX 函数）：[https ://gist.github.com/michaelchughes/4742878](https://gist.github.com/michaelchughes/4742878)

这个 MEX 函数从 Matlab 中读取两个矩阵，并返回它们的乘积。

在没有矩阵乘积运算的情况下运行这个 MEX 函数（即只进行 IO）产生的开销可以忽略不计，因此函数和 Matlab 之间的 IO 并不能解释性能上的巨大差异。这显然是实际的矩阵乘积运算。

我正在用 g++ 编译，带有这些优化标志：“-O3 -DNDEBUG”

我正在使用最新的稳定 Eigen 头文件（3.1.2）。

有关如何提高 Eigen 性能的任何建议？谁能复制我看到的差距？

**更新** 编译器似乎真的很重要。最初的 Eigen 计时是使用 Apple XCode 的 g++ 版本完成的：llvm-g++-4.2。

当我使用通过 MacPorts 下载的 g++-4.7（相同的 CXXOPTIMFLAGS）时，我得到 2.4 秒而不是 2.7 秒。

任何其他关于如何更好地编译的建议将不胜感激。

您还可以获得此实验的原始 C++ 代码：[https ://gist.github.com/michaelchughes/4747789](https://gist.github.com/michaelchughes/4747789)

./MatProdEigen 1000 50000 300

在g++-4.7下报2.4秒

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T09:18:16.883

首先，在进行性能比较时，请确保您禁用了涡轮增压 (TB)。在我的系统上，使用来自 macport 的 gcc 4.5 并且没有涡轮增压，我得到 3.5 秒，对应于 8.4 GFLOPS，而我的 2.3 核心 i7 的理论峰值是 9.2GFLOPS，所以还不错。

MatLab 基于 Intel MKL，从报告的性能来看，它显然使用了多线程版本。像 Eigen 这样的小型库不太可能在自己的 CPU 上击败英特尔！

Numpy 可以使用任何 BLAS 库、Atlas、MKL、OpenBLAS、eigen-blas 等。我猜在你的情况下它使用的 Atlas 也很快。

**最后，您可以通过以下方式获得更好的性能**：通过使用 -fopenmp 编译在 Eigen 中启用多线程。默认情况下，Eigen 使用 OpenMP 定义的默认线程数作为线程数。不幸的是，这个数字对应于逻辑内核的数量，而不是物理内核的数量，因此请确保禁用超线程或将 OMP_NUM_THREADS 环境变量定义为内核的物理数量。在这里我得到 1.25s（没有 TB）和 0.95s 有 TB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:07:16.743

Matlab 速度更快的原因是它使用了英特尔 MKL。Eigen 也可以使用它（参见[此处](http://eigen.tuxfamily.org/dox/TopicUsingIntelMKL.html)），但您当然需要购买它。

话虽如此，Eigen 变慢的原因有很多。要比较 python、matlab 和 Eigen，您确实需要用各自的语言编写三个等效版本的操作。另请注意，Matlab 缓存结果，因此您确实需要从一个新的 Matlab 会话开始，以确保它的魔力不会愚弄您。

此外，[Matlab 的 Mex 开销并非不存在](https://stackoverflow.com/questions/5228388/matlab-mex-file-is-slow-compared-to-its-straight-c-equivalent)。那里的 OP 报告了较新的版本“修复”了该问题，但如果所有开销都已完全清除，我会感到惊讶。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-19T05:06:05.340

Eigen doesn't take advantage of the AVX instructions that were introduced by Intel with the Sandy Bridge architecture. This probably explains most of the performance difference between Eigen and MATLAB. I found a branch that adds support for AVX at [https://bitbucket.org/benoitsteiner/eigen](https://bitbucket.org/benoitsteiner/eigen) but as far as I can tell it not been merged in the Eigen trunk yet.

# java - 使用 iText，如何使用 CssResolver 和 CssFile 将 css 应用于我的 PDF 文档？

> ID：14783231
> 
> 赞同：10
> 
> 时间：2013-02-08T23:49:24.483
> 
> 标签：java, itext

谢谢你的帮助...

# 问题

在将 html 表格标签/片段（我已转换为字符串）转换为 PDF 文档时...

我能够使用这种技术**成功地** 将 css 样式应用于 PDF 文档......

```
CSSResolver cssResolver = XMLWorkerHelper.getInstance().getDefaultCssResolver(false);  
cssResolver.addCss("td {border-right: white .1px solid;}", true); 
```

但是，我使用现有的 css 文件（即，使用 CssFile 对象）将 css 应用于 PDF 文档没有成功，就像这样**......**

```
CSSResolver cssResolver = new StyleAttrCSSResolver();
InputStream csspathtest = Thread.currentThread().getContextClassLoader().getResourceAsStream("styles/itextweb.css");            
CssFile cssfiletest = XMLWorkerHelper.getCSS(csspathtest);
cssResolver.addCss(cssfiletest); 
```

...我无法让这个工作，也不知道问题是什么...我得到...

```
Java.io.IOException The document has no pages 
```

# 问题：

如何正确使用 CssFile 和 CssResolver 将 css 样式（即，从现有的“.css”文件）应用到我的 PDF 文档？（我使用 iText 完成此操作的方式有什么问题？）

（再次感谢您对此提供的任何帮助/指导）

================= 下面是更详细的信息 ===================

Java 6、JSF (Mojarra) 2.1.11、Primefaces v3.4.2、itextpdf v5.3.4、xmlworker v1.2.1

# 这是有问题的“printPDF”功能......

```
public void createPDF() throws DocumentException, CssResolverException
{
    FacesContext context = FacesContext.getCurrentInstance();
    ExternalContext econtext = context.getExternalContext();

    try
    {
        String htmlstring   = context.getExternalContext().getRequestParameterMap().get("testForm:htmlstring");

        InputStream is = new ByteArrayInputStream(htmlstring.getBytes());             
        ByteArrayOutputStream baos = new ByteArrayOutputStream(); 

        // step 1
        Document document = new Document();

        // step 2
        PdfWriter writer = PdfWriter.getInstance(document, baos);

        writer.setInitialLeading(12.5f);

        // step 3
        document.open();

        HtmlPipelineContext htmlContext = new HtmlPipelineContext(null);

        htmlContext.setTagFactory(Tags.getHtmlTagProcessorFactory());

        // CSS
        CSSResolver cssResolver = new StyleAttrCSSResolver();
        InputStream csspathtest = Thread.currentThread().getContextClassLoader().getResourceAsStream("styles/itextweb.css");            
        CssFile cssfiletest = XMLWorkerHelper.getCSS(csspathtest);
        cssResolver.addCss(cssfiletest);             

        Pipeline<?> pipeline =  new CssResolverPipeline(cssResolver, new HtmlPipeline(htmlContext, new PdfWriterPipeline(document, writer)));

        XMLWorker worker = new XMLWorker(pipeline, true);
        XMLParser p = new XMLParser(worker);
        p.parse(is); //new FileInputStream("results/demo2/walden.html"));

        // step     
        document.close();

        //post back...
        HttpServletResponse response = (HttpServletResponse) context.getExternalContext().getResponse();
        response.setContentType("application/pdf");
        response.setHeader("Expires", "0");
        response.setHeader("Cache-Control", "must-revalidate, post-check=0, pre-check=0");           
        response.setHeader("Content-Type", "application/pdf");
        response.setHeader("Content-disposition","attachment;filename=file.pdf");
        response.setContentLength(baos.size());
        OutputStream os = response.getOutputStream();
        baos.writeTo(os);
        os.flush();
        os.close();
        context.responseComplete();
    }
    catch (FileNotFoundException e)
    {
        e.printStackTrace();
    }
    catch (IOException e)
    {
        e.printStackTrace();
    }
    catch (DocumentException e)
    {
        e.printStackTrace();
    }
} 
```

# 这是包含要解析为 pdf 的 html 表格片段的页面（即 id="table1"）...

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
    <f:view contentType="text/html">
        <h:head>
            <title>test html-to-pdf with itext...</title>
            <meta charset="utf-8" />
        </h:head>
        <h:body>
            <h:form id="testForm">

                <p:panel id="queryPanel"  header="...test itext html-to-pdf conversion..." style="width:100%;">

                    <table id='table1'>
                        <thead class="dt-thd">
                            <tr id="table1-h-hdr-row">
                                <th style="width: 120px" class="dt-hhdr-c " >Last name</th>
                                <th style="width: 120px" class="dt-hhdr-c " >First Name</th>
                                <th style="width: 120px" class="dt-hhdr-c " >Middle Name</th>
                                <th style="width: 180px" class="dt-hhdr-c " >Date Of Birth</th>

                            </tr>
                        </thead>
                        <tbody>
                            <tr class="dt-r-even" onclick="uiOnRowClick('table1', 14, this)">
                                <td style="width: 120px" class="dt-c  row-selected-left" ><a class="column-link " onfocus="uiOnRowClick('table1', 14, this.parentNode.parentNode)" onclick="storeFilters()" href="#">lastnameAAA</a></td>
                                <td style="width: 120px" class="dt-c  row-selected" >firstnameAAA</td>
                                <td style="width: 120px" class="dt-c  row-selected" >A</td>
                                <td style="width: 180px" class="dt-c  row-selected" >11/27/1971</td>
                            </tr>
                            <tr class="dt-r-odd" onclick="uiOnRowClick('table1', 14, this)">
                                <td style="width: 120px" class="dt-c " ><a class="column-link " onfocus="uiOnRowClick('table1', 14, this.parentNode.parentNode)" onclick="storeFilters()" href="#">lastnameBBB</a></td>
                                <td style="width: 120px" class="dt-c " >firstnameBBB</td>
                                <td style="width: 120px" class="dt-c " >B</td>
                                <td style="width: 180px" class="dt-c " >01/15/1951</td>
                            </tr>
                            <tr class="dt-r-even" onclick="uiOnRowClick('table1', 14, this)">
                                <td style="width: 120px" class="dt-c " ><a class="column-link " onfocus="uiOnRowClick('table1', 14, this.parentNode.parentNode)" onclick="storeFilters()" href="#">lastnameCCC</a></td>
                                <td style="width: 120px" class="dt-c " >firstnameCCC</td>
                                <td style="width: 120px" class="dt-c " >C</td>
                                <td style="width: 180px" class="dt-c " >02/16/1962</td>
                            </tr>
                            <tr class="dt-r-odd" onclick="uiOnRowClick('table1', 14, this)">
                                <td style="width: 120px" class="dt-c " ><a class="column-link " onfocus="uiOnRowClick('table1', 14, this.parentNode.parentNode)" onclick="storeFilters()" href="#">lastnameDDD</a></td>
                                <td style="width: 120px" class="dt-c " >firstnameDDD</td>
                                <td style="width: 120px" class="dt-c " >D</td>
                                <td style="width: 180px" class="dt-c " >03/17/1973</td>
                            </tr>
                            <tr class="dt-r-even" onclick="uiOnRowClick('table1', 14, this)">
                                <td style="width: 120px" class="dt-c " ><a class="column-link " onfocus="uiOnRowClick('table1', 14, this.parentNode.parentNode)" onclick="storeFilters()" href="#">lastnameEEE</a></td>
                                <td style="width: 120px" class="dt-c " >firstnameEEE</td>
                                <td style="width: 120px" class="dt-c " >E</td>
                                <td style="width: 180px" class="dt-c " >04/18/1984</td>
                            </tr>
                            <tr class="dt-r-odd" onclick="uiOnRowClick('table1', 14, this)">
                                <td style="width: 120px" class="dt-c " ><a class="column-link " onfocus="uiOnRowClick('table1', 14, this.parentNode.parentNode)" onclick="storeFilters()" href="#">lastnameFFF</a></td>
                                <td style="width: 120px" class="dt-c " >firstnameFFF</td>
                                <td style="width: 120px" class="dt-c " >F</td>
                                <td style="width: 180px" class="dt-c " >05/19/1995</td>
                            </tr>
                        </tbody>
                    </table>

                    <p:commandButton
                        id="printPdf"
                        value="Print"
                        action="#{testBean.createPDF2}"
                        ajax="false"
                        onclick="printPreview(this);this.form.target='_blank'"/>

                    <h:inputHidden id="htmlstring" value="no value"/>

                </p:panel>

            </h:form>

            <h:outputStylesheet  library="styles"    name="itextweb.css"      />
            <h:outputScript      library="primefaces" name="/jquery/jquery.js" />
            <h:outputScript      library="primefaces" name="/jquery/plugins/ui/jquery-ui.custom.js" />
            <h:outputScript      library="primefaces" name="/jquery/plugins/inputmask/maskedinput.js" />
            <h:outputScript      library="js"         name="itextweb.js" />
        </h:body>
    </f:view>
</html> 
```

# 这是使用的javascript...

```
function uiOnRowClick(a, b, c)
{
    alert("uiOnRowClick(a,b,c) function called...blah...");
}

function storeFilters()
{
    alert("storeFilters() function called...bleah...");
}

function printPreview(e)
{
    var t = document.getElementById("table1");
    var htmlstring = "<table id='table1-hdr' class='dt' style='width:2416px;position:absolute'>" + t.innerHTML + "</table>";
    document.getElementById('testForm:htmlstring').value = htmlstring;
} 
```

# 这是此示例的 CSS 样式表...

```
.text1
{
    background-color: transparent !important;
    font-weight: bold;
    font-size: 2em;
    color: blue;
    text-align:center;
}

.ui-inputfield {
    background: white !important;
    height: 10px !important;
    vertical-align: middle;
    display:inline-block;
    white-space: nowrap;
}

.ui-button
{
    margin-top: .5px !important;
    vertical-align: middle !important;
    display:inline-block !important;
    white-space: nowrap !important;
    text-align: center !important;
}

.ui-message-error
{
    background: transparent !important;
    border: none !important;
    font-size: .9em !important;
    font-weight: normal !important;
    font-family: Arial, sans-serif !important;
}

.ui-message-error-icon {
    display: none;
}

.ui-messages-error
{
    background: transparent !important;
    border: none !important;
    font-size: .9em !important;
    font-weight: normal !important;
    font-family: Arial, sans-serif !important;
}

.ui-messages-error-icon {
    display: none;
}

.ui-inputfield.ui-state-error
{
    background: pink !important;
}

form *
{
box-sizing: content-box !important;
-moz-box-sizing: content-box !important;
-ms-box-sizing: content-box !important;
}

.ui-widget, .ui-widget .ui-widget
{
font-size: 90% !important;
}

.dt-thd
{

}

.table1-h-hdr-row
{

}

.dt-hhdr-c
{
    color: blue;
    background-color:  lightgray;
}

.dt-r-odd
{
    background-color: aliceblue;
}

.dt-r-even
{
    background-color:  lightskyblue;
}

.dt-c
{
    font-size: 8px;
    font-weight: normal;
} 
```

# 下面是与此示例一起使用的 pom.xml（说明了依赖项/版本/等）...

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>aaa.bbb.ccc</groupId>
    <artifactId>itextweb-war</artifactId>
    <packaging>war</packaging>
    <version>1</version>
    <name>itextweb-war</name>
    <url>http://maven.apache.org</url>

    <dependencies>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.11</version>
        </dependency>

        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.11</version>
        </dependency>

        <dependency>
            <groupId>javax.el</groupId>
            <artifactId>el-api</artifactId>
            <version>2.2</version>
        </dependency>
        <dependency>
            <groupId>org.glassfish.web</groupId>
            <artifactId>el-impl</artifactId>
            <version>2.2</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>3.1.1.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>3.1.1.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>commons-lang</groupId>
            <artifactId>commons-lang</artifactId>
            <version>2.6</version>
        </dependency>

        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.4</version>
        </dependency>

        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.4.2</version>
        </dependency>

        <dependency>
            <groupId>org.primefaces.themes</groupId>
            <artifactId>aristo</artifactId>
            <version>1.0.1</version>
        </dependency>

        <dependency>
            <groupId>com.itextpdf</groupId>
            <artifactId>itextpdf</artifactId>
            <version>5.3.4</version>
        </dependency>

        <dependency>
            <groupId>com.itextpdf.tool</groupId>
            <artifactId>xmlworker</artifactId>
            <version>1.2.1</version>
        </dependency>

    </dependencies>
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.3</version>
            </plugin>

        </plugins>
        <finalName>${project.name}-${project.version}</finalName>
    </build>
</project> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T12:15:18.533

从您的代码开始创建一个项目，经过测试，它可以很好地从带有外部 CSS 的 html 文件创建 PDF 文件。

这是公共存储库：[https](https://github.com/valentin-nasta/itext-html-css-pdf-jsf-template) ://github.com/valentin-nasta/itext-html-css-pdf-jsf-template 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T01:45:00.207

我认为用于此目的（从 XHTML 生成 PDF 文件）的更好、更强大（和更高级别的抽象）工具将是 Flying Saucer，又名。xhml 渲染器。

它为打印媒体提供了完整的 CSS2 支持和一些 CSS3 属性，您可以对其进行扩展以呈现任何 PDF（请参阅 ReplacementElementFactory API）。

我用它来呈现动态 PDF 报告（使用 freemarker），带有自定义标签，比如 . 非常简单的工具，易于理解。

请参阅：[http ://code.google.com/p/flying-saucer/](http://code.google.com/p/flying-saucer/)

用户指南可以在这里找到：http: [//flyingsaucerproject.github.com/flyingsaucer/r8/guide/users-guide-R8.html](http://flyingsaucerproject.github.com/flyingsaucer/r8/guide/users-guide-R8.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-09T18:15:58.480

不，飞碟已用完，不再受支持。我们有很多麻烦。私人使用可以，但不能用于商业案例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-11T03:33:03.090

对于 cssResolver，您需要指定 .css 的绝对路径，如下所示。

```
HtmlPipelineContext htmlContext = new HtmlPipelineContext(null);

htmlContext.setTagFactory(Tags.getHtmlTagProcessorFactory());

CSSResolver cssResolver = XMLWorkerHelper.getInstance().getDefaultCssResolver(false);

cssResolver.addCssFile("src\\template\\style.css",true);
Pipeline<?> pipeline = new CssResolverPipeline(cssResolver, new HtmlPipeline(htmlContext, new PdfWriterPipeline(document, writer)));

XMLWorker worker = new XMLWorker(pipeline, true);
XMLParser xmlParser = new XMLParser(worker); 
```

# c++ - 从 double 到 const int 的 C++ 类型转换无法正常工作

> ID：14783234
> 
> 赞同：1
> 
> 时间：2013-02-08T23:49:42.890
> 
> 标签：c++, types, casting, static-cast

我有一个 const int 类型的变量，但它所依赖的参数是 double 类型。当我尝试将其从“double”转换为“const int”时，它无法正常工作。比如N应该是991，就输入990。我试过几种方法，只有一种有效，但我不确定这种方法是否一直有效。以下是我尝试过的一些方法：

第一种方法：

```
const int N = (Ls-1)/dx + 1; 
```

第二种方法：

```
const int N = static_cast<const int>((Ls-1)/dx) + 1; 
```

第三种方法：

```
double Z = (Ls-1)/dx + 1;
const int N = Z; 
```

第四种方法（唯一工作方法）：

```
double Z = (Ls-1)/dx;
const int N = Z + 1; 
```

请注意，dx 是一个值，使得 (Ls-1)/dx 的余数始终为零（即，它始终是整数值）。无论如何可以解释为什么其他方法不起作用，以便我可以更好地理解类型转换？

编辑：根据要求，我正在上传整个代码以显示一切是如何工作的：

```
#include <iostream>
#include <math.h>
#include <stdio.h>
#include <fstream>
#include <cmath>
#include <algorithm>

#define pi 3.14159265

using namespace std;

//Define Fluid Properties
double rho_L = 998; //Liquid Density
double rho_LG = 828.9; //Liquid-Gas Density Ratio
double mu_L = 0.000798; //Liquid Viscosity
double mu_LG = 40.24; //Liquid-Gas Viscosity Ratio
double sigma = 0.0712; //Surface Tension
double nu_G = (mu_L/mu_LG)/(rho_L/rho_LG);

//Define Injector Properties
double Uinj = 56.7; //Injection Velocity
double Dinj = 0.0998; //Injector Diameter
double theta = 15.0*pi/180.0; //Spray Cone Angle
double L = 500.0*Dinj; //Atomization Length
double Ls = L/Dinj; //Normalized Atomization Length

//Define Solver Parameters
double K = 5294; //Viscous Dissipation Coefficient
double Eps = pow(10,-5); //Residual Error
double dx = 0.0001; //Step Size
double Ui = 10; //Initial Guess
//const int Z = static_cast<const int>((Ls-1)/dx + 1) + 1;
const int N = (Ls-1)/dx + 1;//Z;

double deriv (double U, double X, double delta, double m)
{
    double dudx;
    dudx = -(1.0/delta)*(1.0/U)*(U - sqrt(1.0 - U)/sqrt(m*X*X))*(U - sqrt(1.0 - U)/sqrt(m*X*X));
    return (dudx);
}

int main()
{
    //Declare Variables
    int max_step;
    double ERR;
    int step;
    double DEN;
    double SMD;
    double m;
    double Ug;
    double Re;
    double Cd;
    double delta;
    double K1;
    double K2;
    double K3;
    double K4;

    //Allocate Memory From Heap
    double *U = new double [N];
    double *X = new double [N];

    //Initialize Vectors and Variables
    DEN = 0.5*rho_L - (4.0/3.0)*K*(mu_L)/(Uinj*Dinj*Dinj)*L;

    m = 4.0/rho_LG*tan(theta)*tan(theta);

    for (int i = 0; i < N; i++)
    {
        X[i] = 1.0 + dx*i;
    }
    U[0] = 1.0;

    max_step = 1;
    ERR = 1;
    step = 0;
    while(abs(ERR) > Eps && step < max_step)
    {

        //Calculate Ug
        Ug = sqrt(1.0 - (Ui/Uinj))/sqrt(m*Ls*Ls)*Uinj;

        //Calculate SMD
        SMD = 6.0*sigma/(DEN*(Uinj*Uinj - Ui*Ui));

        //Calculate Re # and Drag Coefficient
        Re = abs(Ui-Ug)*SMD/nu_G;

        if(Re <= 0.01)
        {
            Cd = (0.1875) + (24.0/Re);
        }
        else if(Re > 0.01 && Re <= 260.0)
        {
            Cd = (24.0/Re)*(1.0 + 0.1315*pow(Re,(0.32 - 0.05*log10(Re))));
        }
        else
        {
            Cd = (24.0/Re)*(1.0 + 0.1935*pow(Re,0.6305));
        }

        //Determine New U
        delta = (4.0/3.0)*(1.0/Cd)*(rho_LG)*(SMD/Dinj);

        //RK4
        for (int i = 0; i < N-1; i++)
        {
            K1 = deriv(U[i],X[i],delta,m);
            K2 = deriv(U[i]+0.5*dx*K1,X[i]+0.5*dx,delta,m);
            K3 = deriv(U[i]+0.5*dx*K2,X[i]+0.5*dx,delta,m);
            K4 = deriv(U[i]+dx*K3,X[i+1],delta,m);
            U[i+1] = U[i] + dx/6.0*(K1 + 2.0*K2 + 2.0*K3 + K4);
            //if(i >= 0 && i <= 3)
                //cout << i << " " << K1 << " " << K2 << " " << K3 << " " << K4 << " " << U[i] << endl;
        }

        ERR = abs(U[N-1]*Uinj - Ui)/Ui;

        Ui = U[N-1]*Uinj;

        step = step + 1;
    }

    SMD = 6.0*sigma/(DEN*(Uinj*Uinj - Ui*Ui));

    cout << "U = " << Ui << endl;
    cout << "SMD = " << SMD << endl;
    cout << "DEN = " << DEN << endl;
    cout << "Ug = " << Ug << endl;
    cout << "m = " << m << endl;
    cout << "delta = " << delta << endl;
    cout << "Re = " << Re << endl;
    cout << "Cd = " << Cd << endl;
    cout << "U* = " << U[N-1] << endl;
    cout << "Error = " << ERR << endl;
    cout << "step = " << step << endl;

    //Output Data Into Text File
    ofstream outputdata("result-500-15.txt");
    for (int i = 0; i < N; i++)
    {
        outputdata << X[i] << " " << U[i] << '\n';
    }
    outputdata.close();

    delete [] U;
    delete [] X;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:09:17.203

你的猜测是正确的：0.1 没有二进制的有限表达式。这是一个相当复杂的问题，并且有*许多*极端情况通常无法通过添加 0.01 来解决，如您的评论中所述。（这在很大程度上取决于您期望的值等）

你的问题表明商总是应该是一个整数。在这种情况下，保持正确结果的正确方法是不使用任何以 (for , , )`double`开头的 s 。要么使用小数类型（C++ 中没有内置，使用你自己的或库），任意精度的十进制类型（同样，使用类似的库- 如果你知道所有数字都有一个终止的十进制表达式，那么这是明智的），或者, 最简单的：如果两者和都保证在小数点后最多有数字，则将两者乘以并使用整数类型。`Ls``dx``Z``gmp``Ls``dx``n``10^n`

* * *

好的，您的代码与我的预期非常不同。在这种情况下，在我看来，正确的做法是固定步数`N`并据此计算`dx`，而不是反过来：

```
const int N = 10000;
double dx = (Ls-1.0)/(double)(N-1); 
```

如果您想从 dx 的值开始并选择 N 以便计算出 dx 的值，请在程序启动时询问用户：

```
#include <cmath>

double dxestim;
cout << "dx should be close to: ";
cin >> dxestim;
cout << "Candidate values for N: " << endl;
int N1 = (int) floor((Ls-1)/dx + 1.0);
int N2 = (int) ceil((Ls-1)/dx + 1.0);
cout << N1 << " gives dx = " << (Ls-1.0)/(double)(N1-1) << endl;
cout << N2 << " gives dx = " << (Ls-1.0)/(double)(N2-1) << endl;
cout << "Please choose N: ";
cin >> N;
... 
```

# algorithm - 硬币找零算法和伪代码：需要澄清

> ID：14783236
> 
> 赞同：1
> 
> 时间：2013-02-08T23:49:44.053
> 
> 标签：algorithm, dynamic-programming, coin-change

我正在尝试了解硬币找零问题的解决方案，但遇到了一些困难。

在[Algorithmist](http://www.algorithmist.com/index.php/Coin_Change)中，有一个动态规划解决方案的伪代码解决方案，如下所示：

```
n = goal number
S = [S1, S2, S3 ... Sm]

function sequence(n, m)
   //initialize base cases

   for i = 0 to n
     for j = 0 to m
       table[i][j] = table[i-S[j]][j] + table[i][j-1] 
```

这是一个非常标准的`O(n^2)`算法，可以避免使用二维数组多次重新计算相同的答案。

我的问题有两个：

1.  如何定义基本案例并将它们合并`table[][]`为初始值
2.  如何从表中提取不同的序列

关于问题 1，此算法存在三种基本情况：

*   `if n==0, return 1`
*   `if n < 0, return 0`
*   `if n >= 1 && m <= 0, return 0`

如何将它们合并到`table[][]`中，我不确定。最后，我不知道如何从数组中提取解决方案集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:30:53.480

我们可以用至少两种不同的方法来实现动态规划算法。一种是使用记忆的自上而下的方法，另一种是自下而上的迭代方法。

对于动态编程的初学者，我总是建议首先使用自顶向下的方法，因为这将有助于他们理解动态编程中的递归关系。

所以为了解决换币问题，你已经明白递推关系说的是什么了：

```
table[i][j] = table[i-S[j]][j] + table[i][j-1] 
```

这样的递归关系很好，但没有那么明确，因为它没有任何边界条件。因此，我们需要定义边界条件，以确保递归关系能够成功终止而不会陷入无限循环。

那么当我们尝试沿着递归树向下走时会发生什么？

如果我们需要计算，这意味着使用硬币从 type`table[i][j]`更改为 的方法的数量，我们需要处理几个极端情况：`i``0``j`

1）如果`j == 0`？

如果`j == 0`我们将尝试解决子问题`table(i,j-1)`，这不是一个有效的子问题。因此，一个边界条件是：

```
if(j==0) {
  if(i==0) table[i][j] = 1;
  else table[i][j] = 0;
} 
```

2）如果`i - S[j] < 0`？

我们还需要处理这种边界情况，我们知道在这种情况下，我们要么不尝试解决这个子问题，要么`table(i-S[j],j) = 0`对所有这些情况进行初始化。

所以总而言之，如果我们要从自上而下的记忆方法实现这种动态编程，我们可以这样做：

```
int f(int i, int j) {
  if(calc[i][j]) return table[i][j];
  calc[i][j] = true;
  if(j==0) {
    if(i==0) return table[i][j]=1;
    else return table[i][j]=0;
  }
  if(i>=S[j])
    return table[i][j]=table[i-S[j][j]+table[i][j-1];
  else
    return table[i][j]=table[i][j-1];
} 
```

在实践中，我们也可以使用`table`数组的值来帮助跟踪之前是否计算过这个子问题（例如，我们可以初始化一个值 -1 表示这个子问题还没有被计算过）。

希望答案是明确的。:)

# php - FOSUserBundle 修改配置文件编辑页面

> ID：14783237
> 
> 赞同：1
> 
> 时间：2013-02-08T23:49:53.917
> 
> 标签：php, symfony, fosuserbundle

我更新了我的注册表单，添加了一些字段。注册工作正常，现在当我进入个人资料/编辑页面时，我看不到新字段。即使我手动尝试添加

```
 {{ form_widget(form.country) }} 
```

它不起作用，找不到国家。我需要更新哪个文件才能更新配置文件编辑页面？

实体\用户

```
protected $position;

/**
 * Set position
 *
 * @param string $position
 * @return User
 */
public function setPosition($position)
{
    $this->position = $position;

    return $this;
}

/**
 * Get position
 *
 * @return string
 */
public function getPosition()
{
    return $this->position;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T03:23:47.107

您需要`ProfileFormType`按照类似于[this](http://symfony.com/doc/current/bundles/FOSUserBundle/overriding_forms.html)的内容覆盖该类。此外，对于验证，FOSUserBundle 使用 2 个验证组：注册和配置文件。您需要将配置文件验证组添加到您的属性。

# sql - 使用 groovy 从对象更新 SQL

> ID：14783239
> 
> 赞同：0
> 
> 时间：2013-02-08T23:49:56.380
> 
> 标签：sql, groovy

当您在 Groovy 中读取结果集时，它会出现在一组映射中。

似乎您应该能够更新这些映射中的值并将它们写回，但是我找不到任何内置于 groovy 中的东西来允许我这样做。

我正在考虑编写一个例程，允许我通过迭代其中一个结果对象的字段、获取每个键/值对并使用它们创建适当的更新语句来编写修改后的映射，但这可能很烦人，所以我想知道是否有其他人这样做过，或者它是否已经在 groovy 中可用。

这似乎只是几行代码，所以我宁愿不为此引入休眠。我只是在考虑一种允许的“更新”方法：

```
def 行=sql.rows（查询）
行[0].name="新名称"
更新（sql，行[0]）

```

更新数据库中第一个人的名字。任何人都见过/创造了这样一个怪物，还是像这样的东西已经内置在 Groovy Sql 中而我只是想念它？

（我想您可能必须指出更新方法哪个字段是关键字段，但这是可行的......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:05:11.887

使用该`rows`方法实际上会将所有值读入 a `List`of 中，`GroovyRowResult`因此如果不创建您提到的更新方法，则实际上不可能更新数据。

在一般情况下实际上不可能这样做，因为您`query`可以包含联接或作为聚合的列引用等。

但是，如果您从单个表中进行选择，请使用该`Sql.eachRow`方法并将其设置`ResultSet`为可更新的，您可以在`ResultSet`迭代时使用底层接口进行更新：

```
sql.resultSetConcurrency = ResultSet.CONCUR_UPDATABLE
sql.resultSetType = ResultSet.TYPE_FORWARD_ONLY
sql.eachRow(query) { row ->
    row.updateString('name', 'newName')
    row.updateRow()
} 
```

根据您使用的数据库/驱动程序，您可能无法创建可更新的`ResultSet`.

# c++ - printf("%cx", FILE2CHAR(F(fr))) 到 cout

> ID：14783241
> 
> 赞同：0
> 
> 时间：2013-02-08T23:49:57.660
> 
> 标签：c++, printf, cout

如何`printf("%cx", FILE2CHAR(F(fr)))`用“cout”表达？（注意：FILE2CHAR(F(fr)) 返回一个 int`）

我已经尝试过`cout<<hex<<FILE2CHAR(F(fr));` ，但在某些情况下，它仍然返回错误的十六进制。

我的错。FILE2CHAR(F(fr)) 不返回 int。F(fr) 返回一个整数

FILE2CHAR 是一个宏：

```
#define FILE2CHAR(f)       ('a'+(f))       /* file to text */ 
```

给您造成的困扰请大家帮忙~

## 谢谢

你想打印什么？%cx 将打印一个字符后跟 x。为什么还要使用六角操纵器？– parkydr
因为我认为 x 指的是十六进制，对吗？有点与这里的语法混淆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T11:57:03.217

仍然有点困惑，所以我将介绍这两种情况。

要打印一个字符， printf 应该是

```
printf("%c", FILE2CHAR(F(fr))); 
```

流当量是

```
cout << static_cast<char>(FILE2CHAR(F(fr))); 
```

强制转换是必需的，因为 FILE2CHAR 将返回一个整数，因此 cout 将显示整数值。

要打印十六进制值， printf 应该是

```
printf("%x", FILE2CHAR(F(fr))); 
```

流当量是

```
cout << hex << FILE2CHAR(F(fr)); 
```

注意：在您使用 dec 操纵器之前，所有后续数字都将以十六进制显示。

# android - 引用 Android 库项目错误

> ID：14783245
> 
> 赞同：1
> 
> 时间：2013-02-08T23:50:29.593
> 
> 标签：android, eclipse

我在让我的项目引用 Android 库进行编译时遇到问题。我完全按照此处文档中的说明进行操作：http: [//developer.android.com/tools/projects/projects-eclipse.html](http://developer.android.com/tools/projects/projects-eclipse.html)

我的 android 库被正确标记为库，我可以在我的项目中看到 jar 文件和我的所有 .class 文件。但是当我尝试在我的新项目中引用它们时找不到这些类并且它不会编译。我究竟做错了什么？

这是一个屏幕截图（SoundGraphingLibrary 是我的库项目，SoundGraphingLibrary 是我需要在其中使用库的项目）：

![在此处输入图像描述](../Images/e9ca17c0dd2f848eb9b80939f13a8ab4.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-04T06:00:02.057

确保项目和库项目在同一个文件夹中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-05T02:21:19.143

不知道这是否有帮助，但我做了以下

*   通过转到 Project->Properties->Android 来删除和添加库。
*   通过转到 Project->Clean 来清除项目
*   重新启动 Eclipse 并让它工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T03:57:17.107

首先，`Project->Clean`在库上运行，然后按照@iagreen 的建议运行您的项目。然后继续关闭并重新打开eclipse。等待一切建立起来。

假设此时没有更好的方法，请单击库并执行`Project->Properties->Android`. 确认`Is Library`已选中。现在，删除项目中库 *.jar 的任何实例。做`Project->Properties->Android`你的项目。单击`Add...`并单击所需的库，`OK`，`Apply`，`OK`。

那应该这样做。还有，火狐猴。

# visual-studio-2008 - 待办事项在 Visual Studio 2008 中多次出现

> ID：14783248
> 
> 赞同：0
> 
> 时间：2013-02-08T23:50:42.340
> 
> 标签：visual-studio-2008, todo

Visual Studio 2008 中的任务列表对我来说有点古怪。有些任务只显示一次，但有些任务显示多次。

例如，`// TODO: Change this to 9000.0 when...`在我的代码中只出现一次（AcceptanceTests.cpp 第 74 行），但它在任务列表中出现了四次。

![VisualStudioTaskListWithDuplicates 的屏幕截图](../Images/3ca266767f7e3a9441c07cecb5d1dde3.png)

似乎在编辑文件时，会创建一个具有正确行号的 TODO 实例，但不会删除旧的过时实例。

有没有办法刷新任务列表？

我尝试重建解决方案，但没有帮助。我并不感到惊讶，因为这与编译器无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:10:12.457

关闭并重新打开 Visual Studio 有效！不再重复（暂时）。

![显示问题已修复的屏幕截图](../Images/10fc5657e56e070c007e26d127d9a14c.png)

# android - PhoneGap 根路径

> ID：14783252
> 
> 赞同：0
> 
> 时间：2013-02-08T23:51:00.293
> 
> 标签：android, cordova, mobile

我正在使用 PhoneGap 为 Android 制作一个应用程序。该应用程序基本上重定向到移动网站。我有想要包含在应用程序中的视频，以便用户可以在没有互联网的情况下观看它们。从在线页面，如何链接到应用程序的根目录，而不是网站？

所以基本上，应用程序重定向到`mobile.website.com`. 用户点击“视频”，进入应用根目录。我如何链接到这个；应用程序的路径是什么？

谢谢！

编辑：我正在使用 PhoneGap Build。

# php - mysql_fetch_array 返回 false

> ID：14783259
> 
> 赞同：0
> 
> 时间：2013-02-08T23:52:40.150
> 
> 标签：php, mysql

这是我的代码：

```
mysql_connect("localhost", "username", "password") or die(mysql_error());
mysql_select_db("database") or die(mysql_error());

$method = $_POST["method"]; //dropdown box
$category = $_POST["category"]; //dropdown box
$email = mysql_real_escape_string($_POST["email"]);
$companyname = mysql_real_escape_string($_POST["companyname"]);
$phone = mysql_real_escape_string($_POST["phone"]);
$address = mysql_real_escape_string($_POST["address"]);
$state = mysql_real_escape_string($_POST["state"]);
$zip = mysql_real_escape_string($_POST["zip"]);

$salt = $email;
$length = 10;
$temporarypassword =  
substr(str_shuffle("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),  
0, $length);
$temp_encrypted_password = sha1($salt.$temporarypassword);

$addcompany = mysql_query("INSERT INTO company (`method`, `category`,  
`email`, `password`, `companyname`, `phone`, `address`, `state`, `zip`, `ratingcount`, 
`ratingscore`, `usage`, `date`)
VALUES 
('$method','$category','$email','$temp_encrypted_password',
'$companyname','$phone','$address','$state','$zip','0','0','0',CURDATE()) ")
or die(mysql_error());

if (mysql_fetch_array($addcompany)) {

$to = "$email";
$subject = "Your Temporary Password";
$message = "Your temporary password is: <b>$temporarypassword;</b>. Sign in and   
update your password as soon as possible.";
$header = "From: email@gmail.com\r\n";
$header .= "MIME-Version: 1.0\r\n";
$header .= "Content-type: text/html\r\n";
mail($to,$subject,$message,$header);

$message = "Company Added";

}

}
} 
```

因此，sql 语句执行得很好，并按照我的需要输入到我的数据库中。但是，如果 $addcompany 返回 true 的 IF 语句必须返回 false，因为语句中的任何内容都不会执行。我在我网站的其他部分以这种方式对 mysql_fetch_array 使用这种检查，它工作正常，所以我很好奇为什么在这种情况下它没有返回。

仅供参考，我正在为那些会说的人研究 PDO。大声笑我已经在今天的前一篇文章中对此进行了扩孔。

谢谢你的时间，我很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:56:28.967

php-doku 声明，对于所有 INSERT 语句， [mysql_query](http://php.net/manual/de/function.mysql-query.php)返回一个布尔值，判断语句是否成功执行。所以你不需要

```
if (mysql_fetch_array($addcompany)) { 
```

但简单

```
if ($addcompany) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:58:02.777

mysql_fetch_array 不是用于插入的 if 条件，而是用于**select**语句的 while 循环，它将遍历查询的每个结果。如果没有结果，则脚本不会进入循环。

检查 php.net 底部的示例：http: [//php.net/manual/en/function.mysql-fetch-array.php](http://php.net/manual/en/function.mysql-fetch-array.php)

你只需要`if ($addcompany) {`这里，没有 fetch_array

# c# - XML解析：属性而不是元素

> ID：14783261
> 
> 赞同：1
> 
> 时间：2013-02-08T23:52:46.107
> 
> 标签：c#, xml, linq, parsing, linq-to-xml

所以我有这个 c# 代码，它在将以下 XML 解析为数组方面做得很好：

```
var doc = XDocument.Load(path).Root
                              .Elements()
                              .Select(y => y.Elements().ToDictionary(x => x.Name, x => x.Value))
                              .ToArray(); 
```

XML:

```
<?xml version="1.0" encoding="utf-8" ?>
<bbb>
    <a>
        <x>green</x>
        <y>4</y>
        <z>3</z>
    </a>
</bbb> 
```

但我希望能够像这样编写 XML

```
<a x="green" y="4" z="3" /> 
```

我应该如何更改 C# 以使其最终得到相同的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:00:02.713

试试这个：

```
.Select(y => y.Attributes()
              .ToDictionary(x => x.Name, x => x.Value)) 
```

# ruby-on-rails - 推送到heroku，sqlite3时出现Ruby on Rails错误

> ID：14783263
> 
> 赞同：1
> 
> 时间：2013-02-08T23:53:08.837
> 
> 标签：ruby-on-rails, heroku, sqlite

我在将我的应用程序推送到 heroku 时遇到问题。它说我必须安装 sqlite3，但我已经安装了 sqlite！我正在使用 OSX Mountain Lion

```
>> sudo gem install sqlite3

Building native extensions.  This could take a while...
Successfully installed sqlite3-1.3.7
1 gem installed

>> git push heroku master
Counting objects: 115, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (99/99), done.
Writing objects: 100% (115/115), 33.62 KiB, done.
Total 115 (delta 12), reused 0 (delta 0)
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.3.0.pre.5
       Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin --deployment
       Fetching gem metadata from https://rubygems.org/.........
       Fetching gem metadata from https://rubygems.org/..
       Installing rake (10.0.3)
       Installing i18n (0.6.1)
       Installing multi_json (1.5.0)
       Installing activesupport (3.2.11)
       Installing builder (3.0.4)
       Installing activemodel (3.2.11)
       Installing erubis (2.7.0)
       Installing journey (1.0.4)
       Installing rack (1.4.4)
       Installing rack-cache (1.2)
       Installing rack-test (0.6.2)
       Installing hike (1.2.1)
       Installing tilt (1.3.3)
       Installing sprockets (2.2.2)
       Installing actionpack (3.2.11)
       Installing mime-types (1.19)
       Installing polyglot (0.3.3)
       Installing treetop (1.4.12)
       Installing mail (2.4.4)
       Installing actionmailer (3.2.11)
       Installing arel (3.0.2)
       Installing tzinfo (0.3.35)
       Installing activerecord (3.2.11)
       Installing activeresource (3.2.11)
       Installing coffee-script-source (1.4.0)
       Installing execjs (1.4.0)
       Installing coffee-script (2.2.0)
       Installing rack-ssl (1.3.2)
       Installing json (1.7.6)
       Installing rdoc (3.12)
       Installing thor (0.17.0)
       Installing railties (3.2.11)
       Installing coffee-rails (3.2.2)
       Installing jquery-rails (2.2.0)
       Installing pg (0.12.2)
       Using bundler (1.3.0.pre.5)
       Installing rails (3.2.11)
       Installing sass (3.2.5)
       Installing sass-rails (3.2.6)
       Installing sqlite3 (1.3.7)
       Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
       /usr/local/bin/ruby extconf.rb
       checking for sqlite3.h... no
       sqlite3.h is missing. Try 'port install sqlite3 +universal'
       or 'yum install sqlite-devel' and check your shared library search path (the
       location where your sqlite3 shared library is located).
       *** extconf.rb failed ***
       Could not create Makefile due to some reason, probably lack of
       necessary libraries and/or headers.  Check the mkmf.log file for more
       details.  You may need configuration options.
       Provided configuration options:
       --with-opt-dir
       --without-opt-dir
       --with-opt-include
       --without-opt-include=${opt-dir}/include
       --with-opt-lib
   **strong text**    --without-opt-lib=${opt-dir}/lib
       --with-make-prog
       --without-make-prog
       --srcdir=.
       --curdir
       --ruby=/usr/local/bin/ruby
       --with-sqlite3-dir
       --without-sqlite3-dir
       --with-sqlite3-include
       --without-sqlite3-include=${sqlite3-dir}/include
       --with-sqlite3-lib
       --without-sqlite3-lib=${sqlite3-dir}/lib
       --enable-local
       --disable-local
       Gem files will remain installed in /tmp/build_1s94inzz103xe/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.7 for inspection.
       Results logged to /tmp/build_1s94inzz103xe/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.7/ext/sqlite3/gem_make.out
       **An error occurred while installing sqlite3 (1.3.7), and Bundler cannot continue.
       Make sure that `gem install sqlite3 -v '1.3.7'` succeeds before bundling.**
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app

To git@heroku.com:demoapp1999990.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:demoapp1999990.git' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T00:01:36.287

您不能在 Heroku 上运行 sqlite - 尝试使用 postgres `gem pg`。确保对 sqlite gem 的引用被注释掉或在`group :development do . . .end`gemfile 中的仅开发组 ( ) 中。`gem pg`然后为 postgres ( )添加 gem 。然后`bundle install --without development`再次尝试推送

# java - 计算 catch 块中发生的异常数量

> ID：14783266
> 
> 赞同：1
> 
> 时间：2013-02-08T23:53:57.410
> 
> 标签：java, atomic, concurrenthashmap

我正在尝试收集所有异常发生的计数和异常的名称，`ConcurrentHashMap`以便我应该知道这个异常发生了多少次。

因此，在我的 catch 块中，我有一个地图，它将继续添加异常的名称，并且出现总数。

以下是我`which I have modified to always throw SQL Exception`每次用于测试目的的代码，以便我可以看到异常计数是否准确。

所以某些场景-

1）如果我选择线程`10`数和任务数`50`，那么在该映射中，我可以看到该特定字符串的 500 异常

2）但是如果我选择线程`40`数和任务数，`500`那么我`20000`在该地图中看不到异常，它显示在`19000`.

我的问题是为什么？我在这里做错了什么？

```
class Task implements Runnable {

     public static final AtomicInteger counter_exception = new AtomicInteger(0);
     public static ConcurrentHashMap<String, Integer> exceptionMap = new ConcurrentHashMap<String, Integer>();

     @Override
     public void run() {

     try {

          //Making a db connection and then executing the SQL-

         } catch (SQLException e) {
               exceptionMap.put(e.getCause().toString(), counter_exception.incrementAndGet());
          } catch (Exception e) {

          }
     }

    } 
```

**更新：**

如果我有这样的东西——我会得到`Null Pointer Exception`40 个线程和 4000 个任务。为什么？

```
catch (SQLException e) {

synchronized(this) {
                   exceptionMap.put(e.getCause().toString(), counter_exception.incrementAndGet());
}              
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:59:18.577

也许这样的事情正在发生：

任务 1-500：捕获异常，准备调用`exceptionMap.put`，从中获取一个`counter_exception.incrementAndGet()`传递给所述方法的数字

任务 500：原子整数计数器的编号为 500，已调度，因此它`exceptionMap.put`首先运行

任务 1：原子整数计数器的编号为 1，已调度，因此`exceptionMap.put`最后运行

现在即使计数器是 500 并且我们有 500 个异常，异常消息也会与 1 相关联，因为它是最近执行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T02:33:59.980

这让我觉得这是错误的方法。

如果您在负载下的应用程序中遇到异常，您应该找到这些异常的原因（或多个原因）......并修复它们。

计算异常没有帮助。事实上，您可能会通过以下方式使问题变得更糟：

*   由于您添加的额外复杂性，很难理解您的代码，
*   导致症状发生变化，使识别导致症状的错误变得更加困难，并且
*   由于计算异常的方式出现错误而引入新的错误。

* * *

好的，那么你能做些什么来让问题更容易被发现呢？

*   检查您的代码库以确保您没有*挤压*异常。
*   寻找不记录异常的异常处理程序。
*   寻找过于宽泛的异常处理程序；例如`Exception`或`RuntimeException`或`Throwable`。
*   寻找过早捕获异常的异常处理程序。如果您有意外的异常，您能做的最好的事情是让它传播到“顶部”并终止应用程序或（对于 Web 容器）当前请求。尝试进行更具体的恢复是一个坏主意......'因为您的代码不知道异常的含义或导致它的原因。
*   最后，确保所有线程都有一个未捕获的异常处理程序......以便至少记录任何未捕获的异常。

如果您在应用程序处于负载状态时出现异常（尤其是奇怪的异常），则可能是您拥有由两个或多个线程共享且未正确同步的数据结构/对象/变量。我建议您对代码库进行代码审查以*寻找*此类问题。

* * *

**更新**

查看您更新的代码，您的 NPE 最可能的原因`e.getCause()`是返回`null`；即你的一些例外没有连锁的“原因”例外！这应该是微不足道的处理；即测试返回的值`e.getCause()`。

请注意，由于您使用的是`ConcurrentHashMap`，因此不能`null`用作键。这是明确禁止的 - 请参阅 javadoc。

另一个可能的原因是不正确的同步。

```
synchronized(this) {
    exceptionMap.put(e.getCause().toString(), 
                     counter_exception.incrementAndGet());
} 
```

问题是您正在同步`this`，并且执行相同代码的其他线程将具有不同的`this`......所以您不会与它们同步。

但是，我很确定您实际上*不需要*在这里与其他线程同步，因为：

*   静态变量在类初始化期间被初始化，并且（可能）在那之后没有分配，并且
*   您对共享对象进行的方法调用是线程安全的。

我会宣布`exceptionMap`是`final`，并摆脱`synchronized`障碍。

如果您确实需要同步，则应该在这两个静态对象之一上进行同步，或者在`Task.class`.

# java - 具有多个类别的骰子滚轮应用程序

> ID：14783267
> 
> 赞同：-2
> 
> 时间：2013-02-08T23:54:01.800
> 
> 标签：java, class

我正在编写一个掷 2 个骰子的程序，并为用户提供重复掷骰的选项（继续 y/n）。此外，应用程序需要识别何时进行某些滚动，例如滚动 7 或 2（蛇眼），我不确定是否需要进入主方法或有自己的类，我迷路了！请帮忙。以下是我对应用程序需要的大纲的概述，我不确定如何对其进行编码。

这是我第一次编写自己的类以在 main 方法中使用，布局如下：

```
public class DiceRollerApp
{
    public static void main(String[] args)
    {
    }// end main method
}// end App class

class Die
{
    public Die()
    {}           // default to six-sided die
    public Die(int sides)
    {}  // variable number of sides
    public void roll()
    {}     // randomly picks a face value
    public int getValue()
    {}  // returns the face value
}// end class Die

class PairOfDice
{
    public PairOfDice()
    {}          // default to six-sided dice
    public PairOfDice(int sides)
    {} // variable number of sides
    public void roll()
    {}         // roll both dice
    public int getValue1(){}       // get value of die1
    public int getValue2(){}       // get value of die2
    public int getSum()    {}
    // get sum of both dice
}// end class PairOfDice

public class Validator
{
    public static String getString(Scanner sc, String prompt)
    {
        System.out.print(prompt);
        String s = sc.next();  // read user entry
        sc.nextLine();  // discard any other data entered on the line
        return s;
    }

    public static int getInt(Scanner sc, String prompt)
    {
        int i = 0;
        boolean isValid = false;
        while (isValid == false)
        {
            System.out.print(prompt);
            if (sc.hasNextInt())
            {
                i = sc.nextInt();
                isValid = true;
            }
            else
            {
                System.out.println("Error! Invalid integer value. Try again.");
            }
            sc.nextLine();  // discard any other data entered on the line
        }
        return i;
    }

    public static int getInt(Scanner sc, String prompt,
    int min, int max)
    {
        int i = 0;
        boolean isValid = false;
        while (isValid == false)
        {
            i = getInt(sc, prompt);
            if (i <= min)
            System.out.println(
            "Error! Number must be greater than " + min + ".");
            else if (i >= max)
            System.out.println(
            "Error! Number must be less than " + max + ".");
            else
            isValid = true;
        }
        return i;
    }

    public static double getDouble(Scanner sc, String prompt)
    {
        double d = 0;
        boolean isValid = false;
        while (isValid == false)
        {
            System.out.print(prompt);
            if (sc.hasNextDouble())
            {
                d = sc.nextDouble();
                isValid = true;
            }
            else
            {
                System.out.println("Error! Invalid decimal value. Try again.");
            }
            sc.nextLine();  // discard any other data entered on the line
        }
        return d;
    }

    public static double getDouble(Scanner sc, String prompt,
    double min, double max)
    {
        double d = 0;
        boolean isValid = false;
        while (isValid == false)
        {
            d = getDouble(sc, prompt);
            if (d <= min)
            System.out.println(
            "Error! Number must be greater than " + min + ".");
            else if (d >= max)
            System.out.println(
            "Error! Number must be less than " + max + ".");
            else
            isValid = true;
        }
        return d;
    }
} // end class Validator 
```

我已经编写了验证器类，但没有在此处发布，其目的是简单地验证问题“继续？y/n：”中的字符串

我不知道如何编写骰子类和一对骰子类，我不知道我是否需要为 DiceRollerApp 设置一个单独的类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:03:12.327

```
class Die 
{
    private int sides;

    private int value;

    public Die() {
        this.sides = 6;
    }           // default to six-sided die

    public Die(int sides) {
        this.sides = sides;
    }  // variable number of sides

    public void roll() {
        value = (int)(Math.random() * (sides-1)) + 1;
    }     // randomly picks a face value

    public int getValue() {
        return value;
    }  // returns the face value

}// end class Die 
```

# javascript - 使用 .append() 添加的 HTML 不会触发事件

> ID：14783268
> 
> 赞同：1
> 
> 时间：2013-02-08T23:54:27.377
> 
> 标签：javascript, jquery, html, javascript-events

我有一些 jQuery 从 php 脚本中添加 HTML。

jQuery

```
$.ajax({
    type: "POST",
    url: "newPage.php",
    data: data,
    cache: false,
    success: function(html)
    {
        $('.item1 ul').append(html);
    }
}); 
```

PHP

```
 echo"<li><a href=\"#\">".$pages["title"]."<img src=\"images/delete.jpeg\" class=\"delete del-page\" id=".$pages["pages_id"]." title=\"Delete Page\"/><img src=".$state." class=\"page-state\" id=".$pages["pages_id"]." title=\"Page On\"/></a></li>"; 
```

追加后，没有 jQuery 事件在新的 HTML 上起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T23:55:32.843

您需要委托您的活动[`.on()`](http://api.jquery.com/on/)

[**您可以在此处**](http://api.jquery.com/on/#direct-and-delegated-events)专门阅读有关此内容[](http://api.jquery.com/on/#direct-and-delegated-events)

 **但基本上你需要在 DOM 层次结构中将监听器附加到更高的位置。

所以而不是这个......

```
$('.selector').on('event', function(e) {...}); 
```

做这个

```
$('.item1 ul').on('event', '.selector', function(e) {...}); 
```

* * *

## 为什么？

这是因为当您绑定事件时尚未出现在页面上的动态元素仍会触发事件，它们只是没有处理程序。

由于[**事件冒泡**](http://www.javascripter.net/faq/eventbubbling.htm)，树上的所有 DOM 元素都会听到它们的后代事件（除非传播已停止），并且可以相应地对它们采取行动。

在此示例中，当`'.item1 ul'`听到 an`'event'`已从其子元素之一触发时，如果是`'.selector'`触发它，则处理程序将触发。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T23:56:17.803

您可能正在将事件绑定到元素：

```
$('button').click(function() {
    ...
}); 
```

这仅在`$('button')`选择器返回您想要的元素时才有效。您的问题是选择器被调用一次。它不会更新以考虑在调用选择器后创建的元素。

您应该使用事件委托语法将事件绑定到已经存在的父元素：

```
$('#parent').on('click', 'button', function() {
    ...
}); 
```

这样，当`#parent`接收到一个`click`事件时，它会寻找匹配的元素`button`并将事件传递给它们。**

# angularjs - AngularJS + Ngingx CORS

> ID：14783277
> 
> 赞同：3
> 
> 时间：2013-02-08T23:55:53.247
> 
> 标签：angularjs, nginx, cors

我试图进行以下设置：

**API**

api.domain.com

**应用程序**

域名.com

我已经设置了 2 个不同的 nginx 配置，每个 2 个 url 一个。当在浏览器（api.domain.com/test）中执行常规 GET 请求时，它们都可以工作，但是当从 angularjs（POST）执行 $resource 调用时，它们都会崩溃。这会返回一个

```
 not allowed by Access-Control-Allow-Origin. 
```

我已经做了一段时间了，一直在玩不同的配置文件。我目前正在使用以下文件，但我不知道这是否可行。

[http://paste.laravel.com/h6U](http://paste.laravel.com/h6U)

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T11:26:52.553

要在 Angular JS 中使用 CORS，请尝试将此配置添加到应用程序的 Angular 模块中

```
angular.module('simpleRESTapp')
.config(['$httpProvider', function($httpProvider) {
        $httpProvider.defaults.useXDomain = true;
        delete $httpProvider.defaults.headers.common['X-Requested-With'];
}]) 
```

对于 Nginx 端，您需要配置 nginx 或您的应用程序服务器以返回`Access-Control-Allow-Origin`包含客户端发送的标头值的`Origin`标头（如果它与允许列表匹配）。我想这个配置应该可以工作，

```
if ($http_origin ~ "^(http://developers.example.com|http://example.com)$") {
    add_header "Access-Control-Allow-Origin" $http_origin;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T06:51:18.607

你可以参考这篇[文章](http://mercenarytech.com/2013/01/nginx-and-angularjs-routes/)。

我也是 angularjs 的新手。我用 nodejs 编写我的后端代码。当尝试使用 angularjs 在前端的后端使用 api 时，我遇到了和你一样的问题。

所以我使用nginx来存储我的应用程序，然后在我的`/etc/nginx/conf.d/default.conf`文件中我可以用nginx更改路由器，这样可以避免Access-Control-Allow-Origin引起的问题。

希望这可以帮到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-12T09:51:37.457

我对 angularJs 和 Nginx 有同样的问题，所以我在我的 nginx 配置中添加了以下代码。经过大量搜索后，我发现的重要事情是 [总是] 关键。使用 [always] 键的重点是，当我使用代码时，我没有得到任何错误状态码，而我只得到 200 和 201，其他状态码会出现跨源错误。

```
 add_header 'Access-Control-Allow-Origin' http://127.0.0.1 always;
 add_header 'Access-Control-Allow_Credentials' 'true';
 add_header 'Access-Control-Allow-Headers' 'Authorization,Accept,Origin,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Content-Range,Range,Access-Control-Allow-Origin';
 add_header 'Access-Control-Allow-Methods' 'GET,POST,OPTIONS,PUT,DELETE,PATCH';
```

# actionscript-3 - AS3：嵌入字体两种具有相同名称的不同字体

> ID：14783279
> 
> 赞同：0
> 
> 时间：2013-02-08T23:56:11.547
> 
> 标签：actionscript-3, embedded-fonts

我使用以下命令在 AS3 中嵌入字体：

```
[Embed(source="../font/font1.swf", fontName = "FontName1", fontWeight = "bold" )]
private var myEmbeddedFont:Class;

var _tf: TextFormat;

_tf = new TextFormat();
_tf.color = 0x000000;
_tf.size = 18;
_tf.font = "FontName1"; 
```

现在我想嵌入第二种字体，它是相同的字体但不是粗体。我现在的问题是：两个字体（粗体和非粗体）具有*相同*的名称。

我该怎么做才能同时使用这两种字体？在嵌入命令中 fontName="" 必须是字体的“真实”名称。我可以为字体名称设置某种别名吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T04:47:57.827

没有什么比你必须设置要设置的字体的“真实”名称，你可以为你的字体使用别名。

喜欢：对于 ARIEL（正常）：字体名称：Ariel

对于 ARIEL(bold)：字体名称：Ariel_Bold

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T09:18:59.143

你想使用 fontFamily 而不是 fontName。另外，为什么你的字体是.swf？这是我使用的：

```
 [Embed(source="../font/font1.ttf", embedAsCFF="false", fontFamily="FontName1")]
    private static const Font:Class;
    [Embed(source="../font/font1_Bd.ttf", embedAsCFF="false", fontFamily="FontName1", fontWeight="bold")]
    private static const FontBold:Class; 
```

这样，AS3 应该能够使用您的字体显示正常和粗体文本。

# javascript - 如何在页面底部显示一个 div，然后跳转到它？

> ID：14783283
> 
> 赞同：2
> 
> 时间：2013-02-08T23:56:40.063
> 
> 标签：javascript, jquery, twitter-bootstrap, progressive-enhancement

我正在构建一个[逐步增强的](http://en.wikipedia.org/wiki/Progressive_enhancement)、[引导](http://twitter.github.com/bootstrap/)式的Web 应用程序，它在每个页面上都提供[以任务为中心的帮助。](http://www.cfug-md.org/meetings/JeromyFrench_TaskCentricHelpSystems.ppt)帮助区 div( `id="help_area"`) 以隐藏状态加载；一般当用户点击“帮助”按钮`a id="nav_help_button"`（这很好用。

因为我想支持手机和平板，所以我使用的是 Bootstrap 的响应式脚手架。因此*，如果您在狭窄的视口上查看页面*，单击帮助按钮“显示”页面底部的隐藏帮助区域‡。我正在尝试使用 jQuery 的`.slideToggle()`回调方法来执行 JavaScript ( `window.location.hash = "help_area";`)，该 JavaScript () 在显示后“跳转到”帮助区域，但在跳转时没有运气（它不会出错；它只是不会移动浏览器专注于帮助区域）。

**如何在页面底部显示一个 div，然后跳转到它？**我还使用了 preventDefault ，因此浏览器在目标显示之前不会尝试跳转到内部链接。这可能是冲突吗？

这是相关的 ECMA 脚本：

```
$('#nav_help_button').click(function(event) {
    "use strict"; //let's avoid tom-foolery in this function
    event.preventDefault(); //don't let a tag try to jump us to #help_area before we reveal it
    //adjust spans of main block and help area, set aria-hidden attribute on help block to help screen-readers
    if ( $('#help_area').attr('aria-hidden')==='true' ) {
        $('#content_container.span12').switchClass('span12', 'span9', 300);
        $('#help_area').delay(300).slideToggle(300, function() { window.location.hash = "help_area"; }).attr('aria-hidden', 'false');   
    }
    else {
        $('#help_area').slideToggle(300).attr('aria-hidden', 'true');
        $('#content_container.span9').delay(300).switchClass('span9', 'span12', 300);
    }
}); 
```

我还设置了[一个说明问题的 JSFiddle](http://jsfiddle.net/jhfrench/HdCbu/)。复制

1.  打开[http://fiddle.jshell.net/jhfrench/HdCbu/7/show](http://fiddle.jshell.net/jhfrench/HdCbu/7/show)
2.  然后调整该浏览器窗口的大小，直到“PTO、AIT Life、Hours Worked”等堆叠在一起
3.  单击右上角的按钮（带有三个白色水平条的按钮）以显示导航菜单
4.  单击蓝色的“帮助”按钮以执行显示/跳转。

‡ 作为最右侧的 div，它左侧的所有内容都堆叠在顶部，因此新“显示”的帮助区域通常位于页面可见部分的下方。

有关的：

*   [Javascript使页面跳转到特定位置](https://stackoverflow.com/questions/3569329/javascript-to-make-the-page-jump-to-a-specific-location)
*   [http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)
*   [http://api.jquery.com/slideToggle/](http://api.jquery.com/slideToggle/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:33:25.513

当我完全按照您所说的（步骤 1-4）为我的浏览器（Chrome 24）执行操作时，您的 JSFiddle 会跳动。您的浏览器是什么？

但也许这是你的问题。如果我导航到[http://fiddle.jshell.net/jhfrench/HdCbu/7/show/#help_area](http://fiddle.jshell.net/jhfrench/HdCbu/7/show/#help_area)（注意附加的井号标签）并执行您的步骤 1-4，我的浏览器不会跳转。请注意，当您第一次导航到该 URL 时，没有可见的 #help_area。因此，您要导航到的 URL 指定了一个不可见的哈希标记。也许浏览器对此有点困惑，只是让#help_area 哈希标记处于错误状态。从那时起，即使它变得可见，它也不允许滚动到它。推测，但我希望它有帮助！

# javascript - JS - 从另一个数组填充一个数组+修改值

> ID：14783286
> 
> 赞同：1
> 
> 时间：2013-02-08T23:56:52.713
> 
> 标签：javascript, arrays

有人可以帮我用 JavaScript 做以下事情：

*   我有一个包含字符串的数组（array1）
*   我需要遍历初始数组（array1）的每个元素
*   然后我需要获取array1中每个索引的值，并为每个值添加一个字母
*   最后将array1中每个索引的修改值写入array2。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:05:37.720

```
//declares the array and initializes it with strings
var array1 = ["one", "two", "three", "four"];

//declares the second array
var array2 = []; 

//this line begins the loop. Everything inside the { } will run once for every single item inside array1
for (var i = 0; i < array1.length; i++) 
{
    //this gets the contents of the array at each interval
    var string = array1[i]; 

    //here we take the original string from the array1 and add a letter to it.
    var combo = string + "A"; 

    //this line takes the new string and puts it into the 2nd array
    array2.push(combo); 
}

//displays a message box that shows the contents of the 2nd array
alert(array2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T08:38:59.657

使用 Array.map 的示例。

```
var singularArray = ['Dog', 'Cat', 'Bird'],
pluralArray = singularArray.map(function(value){
    return value+'s';
});

console.log(pluralArray); //Logs ['Dogs', 'Cats', 'Birds'] 
```

[http://jsfiddle.net/fzakf/](http://jsfiddle.net/fzakf/)

有关详细信息，请参阅[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map)。

# php - Php和utf8插入mysql的问题

> ID：14783287
> 
> 赞同：0
> 
> 时间：2013-02-08T23:57:02.200
> 
> 标签：php, mysql

我有 php & mysql 的问题，使用 utf-8 插入数据库。第一个文件：addsite：

```
<?php
include 'header.php';
if(isset($data)) {
foreach($_POST as $key => $value) {
$posts[$key] = filter($value);
}
if(isset($posts['type'])){
if($posts['url'] == "http://" || $posts['url'] == ""){
$error = "Add your page link!";
}else if($posts['title'] == ""){
$error = "Add your page title!";
}else if(!preg_match("/\bhttp\b/i", $posts['url'])){
$error = "URL must contain http://";
}else if(!preg_match('|^http(s)?://[a-z0-9-]+(.[a-z0-9-]+)*(:[0-9]+)?(/.*)?$|i',       $posts['url'])){
$error = "Please do not use special characters in the url.<";
}else{
    include "plugins/" . $posts['type'] . "/addsite.php";
}
}
?>
<div class="contentbox">
<font size="2">
<li>Pick the type of exchange you are promoting from the dropdown menu.</li>
<li>Set the amount of coins you wish to give per user complete(CPC).</li>
<li>The higher the amount of coins the higher the Links position.</li>
</div>
<div class="contentbox">
<div class="head">Add Site</div>
<div class="contentinside">
    <?php if(isset($error)) { ?>
    <div class="error">ERROR: <?php echo $error; ?></div>
    <?php }
    if(isset($success)) { ?>
    <div class="success">SUCCESS: <?php echo $success; ?></div>
    <?php }
    if(isset($warning)) { ?>
    <div class="warning">WARNING: <?php echo $warning; ?></div>
    <?php } ?>

    <form class="contentform" method="post">
        Type<br/>
        <select name="type"><?php $select = hook_filter('add_site_select', ""); echo   $select; ?></select><br/><br/>
        Link<br/>
        <input name="url" type="text" value="<?php if(isset($posts["url"])) { echo $posts["url"]; } ?>"/><br/><br/>
        Title<br/>
        <input name="title" type="text" value="<?php if(isset($posts["title"])) { echo $posts["title"]; } ?>"/><br/><br/>
        Cost Per Click<br/>
        <?php if($data->premium > 0) { ?>
        <select name="cpc"><?php for($x = 2; $x <= $site->premcpc; $x++) { if(isset($posts["cpc"]) && $posts["cpc"] == $x) { echo "<option selected>$x</option>"; } else { echo "<option>$x</option>"; } } ?></select><br/><br/>
        <?php }else{ ?>
        <select name="cpc"><?php for($x = 2; $x <= $site->cpc; $x++) { if(isset($posts["cpc"]) && $posts["cpc"] == $x) { echo "<option selected>$x</option>"; } else { echo "<option>$x</option>"; } } ?></select><br/><br/>
        <?php } ?>
        <input style="width:40%;" type="Submit"/>
    </form>
</div>
 </div>
<?php
 }
else
 {
echo "Please login to view this page!";
 }
 include 'footer.php';
  ?> 
```

第二个文件，插件addsite.php

```
<?php
$num1 = mysql_query("SELECT * FROM `facebook` WHERE `url`='{$posts['url']}'");
$num = mysql_num_rows($num1);
if($num > 0){
$error = "Page already added!";
 }else if(!strstr($posts['url'], 'facebook.com')) {
$error = "Incorrect URL! You must include 'facebook.com'";
}else{
mysql_query($qry);
  mysql_query("INSERT INTO `facebook` (user, url, title, cpc) VALUES('{$data->id}', '{$posts['url']}', '{$posts['title']}', '{$posts['cpc']}') ");
$success = "Page added successfully!";
}
?> 
```

当我在表单中编写阿拉伯语并提交时，它以未知语言进入数据库，例如：

```
 &Oslash;&pound;&Oslash;&sup3;&Ugrave; 
```

数据库整理：utf8_general_ci

```
<?php
error_reporting(E_ALL);
ini_set('display_errors', '0');

$host       =   "localhost"; // your mysql server address
$user       =   "z*******"; // your mysql username
$pass       =   "m********"; // your mysql password
$tablename  =   "z*******"; // your mysql table

session_start();
$data = null;
if(!(@mysql_connect("$host","$user","$pass") && @mysql_select_db("$tablename"))) {
    ?>
    <html>
    MSQL ERROR
    <?
    exit;
}

include_once 'functions.php';
require_once "includes/pluggable.php";
foreach( glob("plugins/*/index.php")  as $plugin) {  
  require_once($plugin);  
}  

hook_action('initialize');

$site = mysql_fetch_object(mysql_query("SELECT * FROM settings"));
?> 
```

删除后

$posts[$key] = filter($value); " 来自 header.php

输出从：到：& Oslash; & 磅; ＆Oslash; ³& 乌格雷夫

至：Ù Ù Ù

* * *

头文件：http: [//zwdha.com/header.txt](http://zwdha.com/header.txt)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:01:21.677

如果您的数据库是完整的 utf8，您可能需要添加一些 ini_set 语句：[http ://www.polak.ro/php-mysql-utf-8.html](http://www.polak.ro/php-mysql-utf-8.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:53:22.267

这是一个非常基本的插入查询，用于查看是否可以使用 PHP 在数据库中插入数据。

```
<?php

function inserting_data() {
    $host = "host";
    $user = "username";
    $password = "password";
    $database = "database";
    $charset = "utf8";

    $link = mysqli_connect($host, $user, $password, $database);
    mysql_set_charset($charset, $link);
    IF (!$link) {
        echo('Unable to connect to the database!');
    } ELSE {
        /*
         * this just to test if something gets inserted into your table. 
         * If some of your columns are set to not null you should add them tot this insert query.
         */

        $query = "INSERT INTO facebook (`title`) VALUES('test_title'), ('test_title1')";
        mysqli_query($link, $query);
    }
    mysqli_close($link);
}

?> 
```

这是一个非常基本的选择查询，用于从数据库中检索数据。

```
<?php

function selecting_data(){

    $host = "host";
    $user = "username";
    $password = "password";
    $database = "database";
    $charset = "utf8";

    $link = mysqli_connect($host, $user, $password, $database);
    mysql_set_charset($charset, $link);
    IF (!$link) {
        echo('Unable to connect to the database!');
    } ELSE {
        /*
         * this just to test if something gets returned from your table. 
         */

        $query = "SELECT * FROM facebook";
        $result = mysqli_query($link, $query);
        while ($rows = mysqli_fetch_array($result, MYSQLI_BOTH)){
            echo $rows['title']; 
        }
    }
    mysqli_close($link);

}
?> 
```

我的建议是首先测试您是否可以在数据库中获取数据并检索它。通过反复试验，您将需要解决您的问题。顺便说一句，我使用了 MYSQLI_ 函数而不是 MYSQL。mysql_ 函数将很快贬值。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T01:21:03.607

a - 你不应该使用 mysql_ 函数。使用 PDO。这个错误是原因之一。

b - mysql_set_charset('utf8');

c - 您尝试使用 utf8_general_ci 插入数据的列？

d - 在 my.cf 上设置默认字符集和字符集服务器

如果这不起作用，请阅读： [http ://www.oreillynet.com/onlamp/blog/2006/01/turning_mysql_data_in_latin1_t.html](http://www.oreillynet.com/onlamp/blog/2006/01/turning_mysql_data_in_latin1_t.html)

这： [http ://www.phpwact.org/php/i18n/utf-8](http://www.phpwact.org/php/i18n/utf-8)

如果在那之后您仍然无法正确使用，请确保听取人们的意见并使用 PDO。

# javascript - JQuery 没有在 IE 中返回 div，但 Firefox/Chrome/Safari 是？

> ID：14783290
> 
> 赞同：1
> 
> 时间：2013-02-08T23:57:39.047
> 
> 标签：javascript, jquery, html, internet-explorer

我在 html 中有以下代码：

```
<div id="image-internal"> 
```

我的 javascript 中有以下代码：

```
parent = $("#" + type + "-" + location);
parent.empty(); 
```

parent.empty() 仅在 IE 中返回一个 JavaScript 错误，说“对象不支持属性或方法‘空’。所有其他浏览器 (FireFox/Chrome/Safari) 正确地将父对象设置为 div 对象并允许为空（） 称呼。

是什么导致 IE 出现这种行为？我该如何解决？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:33:02.910

更改变量的名称或使用`var`-keyword 定义它。`parent`是 的内置属性`window`。

# c++ - 地图中的派生类

> ID：14783294
> 
> 赞同：0
> 
> 时间：2013-02-08T23:57:53.213
> 
> 标签：c++

我有两个独立的类层次结构，从`BaseClass1`,`BaseClass2`

这就是我想要做的：

```
struct BaseClass1 {
  virtual void obtain_map(std::map<int,BaseClass2> &map) = 0;
} 
```

`BaseClass1`覆盖的子类`obtain_map`。但问题是那些子类应该能够`BaseClass2`在`map`参数中使用子类。（所以从这个意义上说，两个“独立”层次结构的子类实际上是相关的，或者如果子类设计者想要的话，可以是相关的）

我怎样才能做到这一点，还是我被迫`map`从头开始创建自己的课程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:06:59.417

如果您像这样派生您的类并使用指针作为第二个`map`模板参数（智能指针之类的`std::unique_ptr`将为您节省一些内存管理麻烦）：

```
struct BaseClass1 {
    virtual void obtain_map(std::map<int, std::unique_ptr<BaseClass2>> &map) = 0;
};
struct DerivedClass1 : public BaseClass1 {
    virtual void obtain_map(std::map<int, std::unique_ptr<BaseClass2>> &map) override
    {
    }
}; 
```

您仍然可以将`maps`BaseClass2 的派生版本作为第二种类型传入：

```
struct DerivedClass2 : public BaseClass2;
// ...

std::map<int, std::unique<DerivedClass2>> mdc2;
DerivedClass1 dc1;
dc1.obtain_map(mdc2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:05:12.647

STL 容器只存储固定大小的对象。如果将 BaseClass2 派生类对象推送到`std::map<int,BaseClass2>`，则对象将被切片为 BaseClass2 类型。

如果要`std::map`存储 BaseClass2 的子类，则需要在 map 中存储指针（智能指针）。

例如：

```
 struct BaseClass1 {
    virtual void obtain_map(std::map<int, std::unique_ptr<BaseClass2>> &map) = 0;
  }

   struct DerivedClass1 : public BaseClass1 {
   virtual void obtain_map(std::map<int, std::unique_ptr<BaseClass2>> &map)
   {
      // implementation
   }
 } 
```

存储 smpart 指针与原始指针相比具有进步，因为您不需要手动删除指针指向的内存。

# excel - Excel 查找数据并找到前 3 项

> ID：14783301
> 
> 赞同：1
> 
> 时间：2013-02-08T23:58:49.093
> 
> 标签：excel, lookup-tables

我不知道我可以使用哪些公式来解决以下问题：

![桌子](../Images/2d92a9c4ae6bb6d348df735ebe979dc5.png)

如何使用 Occurrence 从列表中查找前三项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:51:57.080

实际上 #N/As 并没有太大问题.....在 C2 中尝试这个公式

`=INDEX(A$2:A$15,MATCH(1,(B$2:B$15=LARGE(IF(COUNTIF(C$1:C1,A$2:A$15)=0,B$2:B$15),1))*(COUNTIF(C$1:C1,A$2:A$15)=0),0))`

确认`CTRL+SHIFT+ENTER`并复制到 C4

如果您有相同次数的不同项目，那甚至可以应付......

如果少于 3 个不同的项目，那么您将收到 #N/A 错误 - 您可以使用`IFERROR`Excel 2007 或更高版本中的函数消除这些错误

# c# - 如何在没有“仅原始类型”错误的情况下表达 LINQ to Entities 查询

> ID：14783306
> 
> 赞同：2
> 
> 时间：2013-02-08T23:59:45.097
> 
> 标签：c#, entity-framework, exception-handling, linq-to-entities

我有一个 Game 模型，上面附有许多 Organizer 模型。这是我的模型：

```
public class Organizer
{
    public int ID { get; set; }
    public string Name { get; set; }
    public List<Game> Games {get; set; }
}

public class Game
{
    public int ID { get; set; }
    public string Name { get; set;}
    public List<Organizer> Organizers { get; set; }
} 
```

我正在尝试获取所有包含特定组织者的游戏。例如，我可能有一些这样的数据：

```
Game
ID    Name
--    ----
1     Soccer
2     Baseball

Organizer
ID    Name
--    ----
1     John
2     Barry

GameOrganizer
GameID    OrganizerID
------    -----------
1         1
2         1 
```

这是我尝试使用的代码：

```
Organizer thisOrganizer = db.Organizers.Single(o => o.ID == 1);

var gamesQuery = db.Games
    .Where(game => game.Organizers.Contains(thisOrganizer))
    .Select(g => new { ID = g.ID, Name = g.Name }); 
```

这给了我一个错误：

> 在此上下文中仅支持原始类型。

我明白这意味着什么，但我不知道如何以不同的方式表达它。我最接近的是：

```
var gamesQuery = db.Games
    .Where(game => game.Organizers
        .Any(gO => gO.ID == 1)); 
```

但这只是没有回报。我到处寻找，但一切都处理事先已经知道的字符串数组。

那么，如果没有模型对象，我该如何表达呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:32:17.767

在您的`Organizer`课程中，您的 Games 属性应如下所示：

```
public virtual ICollection<Game> Games { get; set; } 
```

看看[这里](https://stackoverflow.com/questions/5597760/what-effects-can-the-virtual-keyword-have-in-entity-framework-4-1-poco-code-fi)为什么。

然后，您应该能够像 abatishchev 在他的回答中所写的那样访问所有游戏：

```
Organizer thisOrganizer = db.Organizers.Single(o => o.ID == 1);
var games = thisOrganizer.Games; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:15:30.103

您还需要将 Games 声明为 Organizer 的（导航）属性，那么它将是：

```
db.Organizers.Single(o => o.ID == 1).Games; 
```

# java - 语法错误

> ID：14783307
> 
> 赞同：-1
> 
> 时间：2013-02-08T23:59:58.903
> 
> 标签：java, android, syntax

我编写了这段代码来从计算器返回值：

```
try {
    startActivity(intent);

    @Override
    protected void onActivityResult (int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if (resultCode == Activity.RESULT_OK) {
            // User pressed OK.
            double value = data.getDoubleExtra("X", Double.NaN);
            if (Double.isNaN(value)) {
                // Calculation result was "Error".
            } else {
                // Calculation result ok.
            }
        } else {
        // User pressed cancel or back button.
        }
    }
} 
```

它给了我一行中括号、逗号和单词 Intent 的语法错误：

```
protected void onActivityResult (int requestCode, int resultCode, Intent data) { 
```

一些为什么它需要分号而不是所有这些符号。你知道为什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T00:01:59.523

这段代码：

```
protected void onActivityResult (int requestCode, int resultCode, Intent data)... 
```

声明一个方法。你不能只在任何地方声明一个方法；它必须在类体内。在这里，您尝试`onActivityResult`用另一种方法声明，但 Java 不允许这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:13:29.677

我认为你混淆了一些事情。如果您在 Eclipse 中，编辑器会尝试向您显示语法错误所在的位置，但在这种情况下，此功能会出现太多错误而无法使用。

Java 语言（如 Matt Ball 所说）将您的行视为方法的声明。它在那个地方期待的是一个指令（这就是为什么它告诉你它期待一个冒号）。如果你把它放进去，它会告诉你受保护的和无效的关键字是错误的，等等……

# binary - 一行中的多个位运算符

> ID：14783312
> 
> 赞同：0
> 
> 时间：2013-02-09T00:00:27.853
> 
> 标签：binary, operators, bit-manipulation

好的，我正在尝试将所有这些较小的数字塞入一个 32 位数字中，全部放在一行中。由于 a 是 101，b 是 001，d 是 011，我认为 an or 与所有这些变化会返回给我 101001011 或 331。但 cout 返回 1。

```
int main()
{
    int a, b, c, d;
    a = 5;
    b = 1;
    d = 3;
    c = 0;

    c = ( 0 || a << 8 || b << 5 || d << 2 );
    cout << c;
    system("PAUSE");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:03:30.663

您正在使用逻辑“或”。你的结果是“真的”。使用单管道“|”

```
c = ( 0 | a << 8 | b << 5 | d << 2 ); 
```

# jpa - org.dozer.MappingException：找不到字段的读取或写入方法

> ID：14783315
> 
> 赞同：3
> 
> 时间：2013-02-09T00:00:49.107
> 
> 标签：jpa, spring-mvc, dozer

> org.dozer.MappingException：在类（com.essilor.ong.domain.inventory.POLocationEntity）中找不到字段（tarShipMethodCode.lmCourier.courierName）的读取或写入方法

当我构建我的 war 文件并尝试运行 Tomcat 时出现此错误。我正在使用 JPA 和推土机映射。谁能告诉我如何解决它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-01T12:14:08.017

检查您的 Beans 和 Dozer-Mapping-File。

可能存在多个（或多或少常见）错误：

*   在映射文件中输入错误。检查 POLocationEntity 中的包和字段名称，它是否有一个名为 tarShipMethodCode 的字段，它是否有一个 ImCourier 字段，这是一个 courierName 字段？

*   缺乏吸气剂/二传手。再次检查 bean，Dozer 通常需要 getFieldName 和 setFieldName 方法，除非您指定其他方法（我不假设，可能发布您的映射文件）。

*   缩小问题范围：这是唯一不起作用的领域吗？还是根本没有指定这个字段？Dozer 倾向于尝试按名称映射映射文件中没有相应条目的字段，这可能会导致意外错误。

tl;博士

有了更多信息（映射 xml、bean 代码），这将更容易分析，但根据我的经验，上面的指针是解决这类问题的指针。

# python - GDB，python脚本从函数中获取返回值

> ID：14783321
> 
> 赞同：0
> 
> 时间：2013-02-09T00:01:44.877
> 
> 标签：python, gdb

我正在尝试使用 python 脚本支持将 gdb 调用命令的值获取到 python 变量。

## 我的脚本

```
import gdb

res = []
res.append(gdb.execute("call factorial(4)"))
res.append(gdb.execute("call factorial(5)"))
print res 
```

## 输出

```
$4 = 24
$5 = 120
[None, None] 
```

我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:10:00.877

查看链接的问题，您似乎缺少一些标志。做

```
import gdb

res = []
res.append(gdb.execute("call factorial(4)", False, True))
res.append(gdb.execute("call factorial(5)", False, True))
print res 
```

工作？ [（文档）](http://sourceware.org/gdb/current/onlinedocs/gdb/Basic-Python.html#Basic-Python)

# scala - 基于 Scala 磁盘的 Map

> ID：14783327
> 
> 赞同：3
> 
> 时间：2013-02-09T00:02:35.220
> 
> 标签：scala, caching, hashmap, redis, key-value

我有一个不适合内存的大地图，因此我希望它存在于磁盘上。我有以下选择：

1.  使用像[MapDB](https://github.com/jankotek/MapDB)这样的纯 Java 库：这可行，但我没有得到像`getOrElseUpdate`and`++=`和 `apply`/`update`方法这样的 Scala 集合糖。我可以在 Scala 中创建自己的包装类`MapDB`，但我真的不想手动实现所有`Map`特征。
2.  使用 redis/memcached 之类的东西：我找不到一个好的 scala 库来给我`Map`redis 或 memcached 的特征。这可能是性能更好的解决方案，但它引入了运行数据库的复杂性

那么是否有任何不错的 scala only 库来实现地图的 Scala 集合糖，但它又依赖于磁盘和/或大型地图的键值存储？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-09T01:48:50.210

回答了我自己的问题

```
import collection.mutable
import org.mapdb.DBMaker
import collection.JavaConversions._

val cache: mutable.Map[String, Seq[String]] = DBMaker.newTempHashMap[String, Seq[String]]() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-19T00:38:46.513

值得一提的是[Chronicle Map](https://github.com/OpenHFT/Chronicle-Map)：它与 MapDB（磁盘持久化实现）基本相同`ConcurrentMap`，但它比 MapDB[高效得多。](http://jetbrains.github.io/xodus/#benchmarks)

例子：

```
val cache: mutable.Map[String, java.util.List[String]] = ChronicleMap
    .of(classOf[String], classOf[java.util.List])
    .averageKey("key")
    .averageValue(...)
    .valueMarshaller(ListMarshaller.of(
        CharSequenceBytesReader.INSTANCE,
        CharSequenceBytesWriter.INSTANCE
    ))
    .entries(...)
    .createPersistedTo(file) 
```

# sql - 使用键组合数据库条目以生成表，每个键一个条目

> ID：14783328
> 
> 赞同：1
> 
> 时间：2013-02-09T00:02:37.410
> 
> 标签：sql

# 我有的

我有一个 sql 数据库，其中有几个通过整数键相互关联的表。这是我的 3 个表、列名和每个表的一些示例数据。请记住，我只是输入这个来给出一个想法，它不是直接从数据库复制/粘贴（因此格式是为了传达这一点，而不是被 sql 数据库解析器读取。）

表格1

```
ItemTable
itemID,itemName, fruitOrVeggie, Color
1, Apple, Fruit, Red
2, Orange, Fruit, Orange
3, Carrot, Vegetable, Orange 
```

表 2

```
AttributeTypesTable
attributeID,attributeName
1, Price
2, Weight
3, Diameter 
```

表3

```
ItemAttributesTable
itemID,attributeID,attributeValue
1, 1, .75
1, 2, .5
1, 3, .7
2, 1, .9
2, 3, .7
3, 1, .3
3, 2, .5 
```

请注意，我如何在 ItemAttributesTable 中为每个 itemID 提供多个条目——这是我试图在新表中合并的部分。

# 我想要的是

从这三个表中，我想创建一个这样的新表。

```
NewTable
itemID,itemName,fruitOrVeggie,Color,Price,Weight,Diameter
1, Apple, Fruit, Red, .75, .5, .7
2, Orange, Fruit, Orange, .9, , .7
3, Carrot, Vegetable, Orange, .3, .5, 
```

在这个 NewTable 中，itemID 是一个唯一键，因此每个 itemID 只有一个条目——这就是目标。请注意每个属性名称现在如何成为此新表中的一列，以及来自 ItemAttributesTable 的相应数据现在如何在此处列出，每个 itemID 都有一个条目（如果 ItemAttributesTable 没有该 itemID 的该属性 ID 的条目，则将字段留空） . 我不想在列名中硬编码，因为我的实际数据有大约十几个列，我希望这个查询足够通用，即使属性名发生变化也能够继续使用它，我添加或删除了一些他们等等

# 到那里怎么走

我主要看这种复杂查询所涉及的 sql，尽管实际上创建这个新表的某种 shell 可能会很好。例如，一个查询，然后是一个运行该查询以创建 ItemAttributesTable 的 Python 脚本。

关键部分是如何根据另一个表中的条目（在本例中为 attributeName）在新表中创建列，然后如何正确地从多个表中提取数据以填充这个新表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T09:50:31.030

在 SQLServer2005+ 中，您可以使用[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)运算符来旋转表值表达式。[SELECT...INTO](http://msdn.microsoft.com/en-us/library/ms188029%28v=sql.105%29.aspx)创建一个新表并将查询的结果行插入其中

```
IF OBJECT_ID('NewTable') IS NOT NULL DROP TABLE NewTable
SELECT ItemID, ItemName, FruitOrVeggie, Color, Price, Weight, Diameter
INTO NewTable
FROM      
(      
 SELECT t.ItemID, t.ItemName, t.FruitOrVeggie, Color, attributeName, attributeValue
 FROM ItemTable t JOIN ItemAttributesTable at ON t.ItemID = at.ItemID
                  JOIN AttributeTypesTable tt ON at.attributeID = tt.attributeID
) x
PIVOT
(
 MAX(attributeValue) FOR attributeName IN ([Price], [Weight], [Diameter])
 ) p

SELECT *
FROM NewTable 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/1cc4c/1/0)上的演示[](http://sqlfiddle.com/#!3/1cc4c/1/0)

 **或者

如果您有未知数量的列（属性名称）要转换，那么您可以使用动态 PIVOT。

```
DECLARE @cols AS nvarchar(max),
        @query AS nvarchar(max)

SELECT @cols = STUFF((SELECT DISTINCT ',' + QUOTENAME(attributeName)
                      FROM AttributeTypesTable
                      FOR XML PATH(''), TYPE).value('.', 'nvarchar(max)'), 1, 1, '')

IF OBJECT_ID('NewTable') IS NOT NULL DROP TABLE NewTable                      
SET @query = 'SELECT ItemID, ItemName, FruitOrVeggie, Color, ' + @cols + 
             'INTO NewTable FROM 
             (
              SELECT t.ItemID, t.ItemName, t.FruitOrVeggie, Color, attributeName, attributeValue
              FROM ItemTable t JOIN ItemAttributesTable at ON t.ItemID = at.ItemID
                               JOIN AttributeTypesTable tt ON at.attributeID = tt.attributeID
              ) x
              PIVOT
              (
               MAX(attributeValue) FOR attributeName IN (' + @cols + ')
               ) p '

EXEC(@query)

SELECT *
FROM NewTable 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/4bb54/2/0)上的演示[](http://sqlfiddle.com/#!3/4bb54/2/0)

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T03:45:32.907

我会尝试这样的事情：

```
INSERT INTO NEW TABLE (itemID, itemName, fruitOrVeggie, Color, Price, Weight, Diameter)
SELECT IT.itemID, IT.itemName, IT.fruitOrVeggie, IT.Color, Price.attributeValue, Weight.attributeValue, Diameter.attributeValue
FROM ItemTable IT
LEFT OUTER JOIN ( SELECT itemId, attributeValue
        FROM ItemAttributesTable
        WHERE attributeID = 1
    ) AS Price
ON Price.itemID = IT.itemID
LEFT OUTER JOIN ( SELECT itemId, attributeValue
        FROM ItemAttributesTable
        WHERE attributeID = 2
    ) AS Weight
ON Weight.itemID = IT.itemID
LEFT OUTER JOIN ( SELECT itemId, attributeValue
        FROM ItemAttributesTable
        WHERE attributeID = 3
    ) AS Diameter
ON Diameter.itemID = IT.itemID 
```

插入语法可能因您使用的特定 SQL 实现而异。我建议尝试 Select 部分，看看返回的行是否与您希望 newTable 中的行在运行插入之前的样子相匹配。****

# c++ - OpenCV CV::Mat 和 Eigen::Matrix

> ID：14783329
> 
> 赞同：36
> 
> 时间：2013-02-09T00:02:40.603
> 
> 标签：c++, opencv, eigen

是否有可逆的方法将 OpenCV`cv::Mat`对象转换为`Eigen::Matrix`?

例如，某种做法：

```
cv::Mat cvMat;
Eigen::Matrix eigMat;
camera->retrieve(cvMat);

// magic to convert cvMat to eigMat
// work on eigMat
// convert eigMat back to cvMat

imshow("Image", cvMat);
```

我试过使用`cv2eigen`and `eigen2cv`，但结果`cvMat`完全被破坏了，我不确定为什么。尺寸是正确的，但图形完全被破坏了，所以可能是每像素字节数或数据大小问题？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-07-03T17:16:33.217

你也可以使用

```
void eigen2cv(const Eigen::Matrix<_Tp, _rows, _cols, _options, _maxRows, _maxCols>& src, Mat& dst) 
```

和

```
void cv2eigen(const Mat& src, Eigen::Matrix<_Tp, _rows, _cols, _options, _maxRows, _maxCols>& dst) 
```

从`#include <opencv2/core/eigen.hpp>`.

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-02-14T12:03:24.373

您应该考虑使用 Eigen::Map 来包装 OpenCV 矩阵，以便由 Eigen SDK 直接使用。这允许您在 OpenCV 分配的矩阵上应用 Eigen 中实现的几乎所有功能

特别是您只需实例化一个 Eigen::Map 提供指向 cv::Mat 缓冲区的指针：

```
//allocate memory for a 4x4 float matrix
cv::Mat cvT(4,4,CV_32FC1); 

//directly use the buffer allocated by OpenCV
Eigen::Map<Matrix4f> eigenT( cvT.data() ); 
```

有关 Eigen::Map 的更多信息，请查看 [Eigen 教程：地图类](https://eigen.tuxfamily.org/dox/group__TutorialMapClass.html)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2014-02-11T16:00:16.080

您可以在 Eigen 和 OpenCV 之间映射任意矩阵（无需复制数据）。

但是，您必须注意两件事：

*   Eigen 默认以列为主存储，OpenCV 以行为主存储。因此，在映射 OpenCV 数据时使用 Eigen::RowMajor 标志。

*   OpenCV 矩阵必须是连续的（即 ocvMatrix.isContinuous() 必须为真）。如果您在创建矩阵时一次性为矩阵分配存储空间，就会出现这种情况（例如，如下面的示例，或者矩阵是 Mat W = A.inv(); 之类的操作的结果）

例子：

```
Mat A(20, 20, CV_32FC1);
cv::randn(A, 0.0f, 1.0f); // random data

// Map the OpenCV matrix with Eigen:
Eigen::Map<Eigen::Matrix<float, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor>> A_Eigen(A.ptr<float>(), A.rows, A.cols);

// Do something with it in Eigen, create e.g. a new Eigen matrix:
Eigen::Matrix<float, Eigen::Dynamic, Eigen::Dynamic, Eigen::RowMajor> B = A_Eigen.inverse();

// create an OpenCV Mat header for the Eigen data:
Mat B_OpenCV(B.rows(), B.cols(), CV_32FC1, B.data()); 
```

对于多通道矩阵（例如图像），您可以完全按照 Pierluigi 在他的评论中建议的那样使用“Stride”！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-25T13:20:51.127

这对我有用，

```
 #include <opencv2/core/eigen.hpp>

  cv::Mat image;
  image = cv::imread("/dataset/images/15207_angle_image.jpg", CV_LOA D_IMAGE_GRAYSCALE);   // Read the file
  Eigen::Matrix<float,Eigen::Dynamic, Eigen::Dynamic> eigen_mat;
  cv::cv2eigen(image, eigen_mat); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-12T12:09:04.537

Pierluigi 的版本对于 3 通道图像完全不适合我！经过一番调查，我以以下对我有用的解决方案结束：

```
using namespace Eigen;

constexpr uint32_t height = 3;
constexpr uint32_t width = 7;

cv::Mat img(height, width, CV_32FC3, cv::Scalar(1.0f, 2.0f, 3.0f));

using MatrixXfRowMajor = Matrix<float, Dynamic, Dynamic, RowMajor>;
using C3Stride = Stride<Dynamic, 3>;
C3Stride c3Stride(width *3,3);

using cvMap = Map<MatrixXfRowMajor, Unaligned, C3Stride >;
cvMap imgC1(reinterpret_cast<float*>(img.data) + 0, img.rows, img.cols, c3Stride);
cvMap imgC2(reinterpret_cast<float*>(img.data) + 1, img.rows, img.cols, c3Stride);
cvMap imgC3(reinterpret_cast<float*>(img.data) + 2, img.rows, img.cols, c3Stride);

std::cout << imgC1 << std::endl << std::endl;
std::cout << imgC2 << std::endl << std::endl;
std::cout << imgC3 << std::endl << std::endl; 
```

# c++ - C++ 中的动态库、插件框架和函数指针转换

> ID：14783330
> 
> 赞同：8
> 
> 时间：2013-02-09T00:02:59.360
> 
> 标签：c++, plugins, frameworks, function-pointers, dynamic-library

我正在尝试在 C++ 中创建一个非常开放的插件框架，在我看来，我已经想出了一个方法来做到这一点，但是一个唠叨的想法一直告诉我，我正在做的事情非常非常错误，它要么不起作用，要么会导致问题。

我的框架设计包含一个调用每个插件`init`功能的内核。然后 init 函数转而使用内核的`registerPlugin`and`registerFunction`获取唯一的 id，然后分别注册插件希望使用该 id 访问的每个函数。

函数 registerPlugin 返回唯一的 id。函数 registerFunction 接受该 id、函数名称和通用函数指针，如下所示：

```
bool registerFunction(int plugin_id, string function_name, plugin_function func){} 
```

plugin_function 在哪里

```
typedef void (*plugin_function)(); 
```

然后内核获取函数指针并将其放入带有`function_name`and的映射中`plugin_id`。所有注册其函数的插件都必须将该函数强制转换为 type `plugin_function`。

为了检索函数，不同的插件调用内核的

```
plugin_function getFunction(string plugin_name, string function_name); 
```

然后该插件必须将其`plugin_function`转换为其原始类型，以便可以使用它。`.h`通过访问概述插件提供的所有功能的文件，它（理论上）知道正确的类型是什么。插件，by，被实现为动态库。

这是完成允许不同插件相互连接的任务的聪明方法吗？或者这是一种疯狂且非常糟糕的编程技术？如果是，请指出正确的方法来完成此任务。

编辑：如果需要任何澄清，请询问并将提供。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-11T07:10:50.840

函数指针是奇怪的生物。它们不一定与数据指针的大小相同，因此不能安全地`void*`来回转换。但是，C++（和 C）规范允许将[任何函数指针安全地转换为另一个函数指针](https://stackoverflow.com/a/11240372/21475)类型（尽管如果您想要定义的行为，您必须稍后将其转换回早期的类型，然后再调用它）。这类似于安全地`void*`来回转换任何数据指针的能力。

指向方法的指针是真正麻烦的地方：方法指针可能比普通函数指针大，这取决于编译器，应用程序是 32 位还是 64 位等。但更有趣的是，即使在相同的编译器/平台，并非所有方法指针的大小都相同：指向虚函数的方法指针可能比普通方法指针大；如果涉及多重继承（例如菱形模式中的虚拟继承），则方法指针可以更大。这也因编译器和平台而异。这也是很难创建函数对象（包装任意方法以及自由函数）的原因，尤其是在没有在堆上分配内存的情况下（使用[模板巫术](https://stackoverflow.com/a/4300544/21475)*是*可能的）。

因此，通过在您的界面中使用函数指针，插件作者将方法指针传回您的框架变得不切实际，即使他们使用的是相同的编译器。这可能是一个可接受的约束；稍后会详细介绍。

由于无法保证从一个编译器到下一个编译器的函数指针大小相同，因此通过注册函数指针，您将插件作者限制为实现与编译器具有相同大小的函数指针的编译器。这在实践中并不一定那么糟糕，因为函数指针大小在编译器版本之间往往是稳定的（甚至对于多个编译器来说可能是相同的）。

当你想调用函数指针指向的函数时，真正的问题就开始出现了。如果您不知道函数的真实签名，则根本无法安全地调用该函数（您*将*得到从“不工作”到分段错误的糟糕结果）。因此，插件作者将被进一步限制为仅注册`void`不带参数的函数。

更糟的是：函数调用在汇编程序级别的实际工作方式不仅仅取决于签名和函数指针大小。还有调用约定，处理异常的方式（抛出异常时堆栈需要正确展开），以及函数指针字节的实际解释（如果它大于数据指针，额外的字节做什么）表示？以什么顺序？）。此时，插件作者几乎只能使用与您相同的编译器（和版本！），并且需要注意匹配调用约定和异常处理选项（例如，使用 MSVC++ 编译器，异常处理仅使用该[`/EHsc`](http://msdn.microsoft.com/en-us/library/1deeycx5%28v=vs.110%29.aspx)选项显式启用），并且仅使用具有您定义的确切签名的普通函数指针。

到目前为止，所有限制*都*可以认为是合理的，如果有一点限制的话。但我们还没有完成。

如果你加入`std::string`（或 STL 的几乎任何部分），事情会变得更糟，因为即使使用相同的编译器（和版本），也有几个不同的标志/宏控制 STL；这些标志会影响表示字符串对象的字节的大小和含义。实际上，这就像在单独的文件中有两个*不同*的结构声明，每个文件都具有相同的名称，并希望它们可以互换；显然，这是行不通的。一个示例标志是`_HAS_ITERATOR_DEBUGGING`. 请注意，这些选项甚至可以在调试和发布模式之间更改！这些类型的错误并不总是立即/一致地表现出来，而且很难追踪。

您还必须非常小心跨模块的动态内存管理，因为`new`在一个项目中的定义可能与`new`在另一个项目中不同（例如，它可能被重载）。删除时，您可能有一个指向带有虚拟析构函数的接口的指针，这意味着`vtable`正确`delete`的对象需要它，并且不同的编译器都以`vtable`不同的方式实现这些东西。通常，您希望分配对象的模块是解除分配对象的模块；更具体地说，您希望释放对象的*代码*在与分配它的代码完全相同的条件下编译。这是一个原因`std::shared_ptr`可以在构造时采用“删除器”参数 - 因为即使使用相同的编译器和标志（`shared_ptr`在模块之间共享 s 的唯一保证安全的方式），`new`并且`delete`可能在任何地方都不同，`shared_ptr`可以被破坏。使用删除器，创建共享指针的代码也控制它最终如何被销毁。（我只是把这一段扔进去了；你似乎没有跨模块边界共享对象。）

所有这些都是 C++ 没有标准二进制接口 ( [ABI](https://stackoverflow.com/questions/7492180/c-abi-issues-list) ) 的结果；这是一个免费的游戏，很容易在脚上开枪（有时没有意识到）。

那么，还有希望吗？完全正确！您可以改为向您的插件公开 C API，并让您的插件也公开 C API。这非常好，因为 C API 几乎可以与任何语言进行互操作。您不必担心异常，除了确保它们不会在插件函数之上冒泡（这是作者所关心的），并且无论编译器/选项如何它都是稳定的（假设您不通过 STL 容器之类的）。只有一种标准调用约定 ( `cdecl`)，这是声明的函数的默认值`extern "C"`。`void*`实际上，在同一平台上的所有编译器中都是相同的（例如 x64 上的 8 个字节）。

您（和插件作者）仍然可以用 C++ 编写代码，只要两者之间的所有外部通信都使用 C API（即为了互操作而伪装成 C 模块）。

C 函数指针在实践中也可能在编译器之间兼容，但如果您不想依赖它，您可以让插件注册一个函数*名称*( `const char*`) 而不是地址，然后您可以自己提取地址，例如[`LoadLibrary`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)使用[`GetProcAddress`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683212%28v=vs.85%29.aspx)对于 Windows（类似地，Linux 和 Mac OS X 有`dlopen`和`dlsym`）。这是有效的，因为使用 .声明的函数禁用了[名称修饰](https://stackoverflow.com/questions/1314743/what-is-name-mangling-and-how-does-it-work)`extern "C"`。

请注意，没有直接的方法可以将注册函数限制为单一原型类型（否则，正如我所说，您无法正确调用它们）。如果您需要为插件函数提供特定参数（或返回值），则需要分别注册和调用具有不同原型的不同函数（尽管您可以将所有函数指针折叠为一个通用函数指针在内部输入，并且只在最后一分钟回退）。

最后，虽然您不能直接支持方法指针（在 C API 中甚至不存在，但即使使用 C++ API 也具有可变大小，因此不容易存储），您可以允许插件提供“用户- data" 注册函数时的不透明指针，每当它被调用时都会传递给函数；这为插件作者提供了一种简单的方法来编写方法周围的函数包装器并存储对象以将方法应用到 user-data 参数中。user-data 参数还可以用于插件作者想要的任何其他内容，这使您的插件系统更易于交互和扩展。另一个示例用途是使用包装器和存储在用户数据中的额外参数来适应不同的函数原型。

这些建议导致了类似这样的代码（对于 Windows——其他平台的代码非常相似）：

```
// Shared header
extern "C" {
    typedef void (*plugin_function)(void*);

    bool registerFunction(int plugin_id, const char* function_name, void* user_data);
}

// Your plugin registration code
hModule = LoadLibrary(pluginDLLPath);

// Your plugin function registration code
auto pluginFunc = (plugin_function)GetProcAddress(hModule, function_name);
// Store pluginFunc and user_data in a map keyed to function_name

// Calling a plugin function
pluginFunc(user_data);

// Declaring a plugin function
extern "C" void aPluginFunction(void*);
class Foo { void doSomething() { } };

// Defining a plugin function
void aPluginFunction(void* user_data)
{
    static_cast<Foo*>(user_data)->doSomething();
} 
```

很抱歉这个回复的长度；其中大部分可以总结为“C++ 标准没有扩展到互操作；使用 C 代替，因为它至少具有*事实上的*标准。”

* * *

注意：有时在插件将在完全相同的情况下编译的假设下，设计一个普通的 C++ API（带有函数指针或接口或任何你最喜欢的东西）是最简单的；如果您希望自己开发所有插件（即 DLL 是项目核心的一部分），这是合理的。如果您的项目是开源的，这也可以工作，在这种情况下，每个人都可以独立选择一个有凝聚力的环境，在该环境下编译项目和插件——但这使得除了作为源代码之外很难分发插件。

* * *

**更新**：正如 ern0 在评论中指出的那样，可以抽象模块互操作的细节（通过 C API），以便主项目和插件都处理更简单的 C++ API。以下是这种实现的概述：

```
// iplugin.h -- shared between the project and all the plugins
class IPlugin {
public:
    virtual void register() { }
    virtual void initialize() = 0;

    // Your application-specific functionality here:
    virtual void onCheeseburgerEatenEvent() { }
};

// C API:
extern "C" {
    // Returns the number of plugins in this module
    int getPluginCount();

    // Called to register the nth plugin of this module.
    // A user-data pointer is expected in return (may be null).
    void* registerPlugin(int pluginIndex);

    // Called to initialize the nth plugin of this module
    void initializePlugin(int pluginIndex, void* userData);

    void onCheeseBurgerEatenEvent(int pluginIndex, void* userData);
}

// pluginimplementation.h -- plugin authors inherit from this abstract base class
#include "iplugin.h"
class PluginImplementation {
public:
    PluginImplementation();
};

// pluginimplementation.cpp -- implements C API of plugin too
#include <vector>

struct LocalPluginRegistry {
    static std::vector<PluginImplementation*> plugins;
};

PluginImplementation::PluginImplementation() {
    LocalPluginRegistry::plugins.push_back(this);
}

extern "C" {
    int getPluginCount() {
        return static_cast<int>(LocalPluginRegistry::plugins.size());
    }

    void* registerPlugin(int pluginIndex) {
        auto plugin = LocalPluginRegistry::plugins[pluginIndex];
        plugin->register();
        return (void*)plugin;
    }

    void initializePlugin(int pluginIndex, void* userData) {
        auto plugin = static_cast<PluginImplementation*>(userData);
        plugin->initialize();
    }

    void onCheeseBurgerEatenEvent(int pluginIndex, void* userData) {
        auto plugin = static_cast<PluginImplementation*>(userData);
        plugin->onCheeseBurgerEatenEvent();
    }
}

// To declare a plugin in the DLL, just make a static instance:
class SomePlugin : public PluginImplementation {
    virtual void initialize() {  }
};
SomePlugin plugin;    // Will be created when the DLL is first loaded by a process

// plugin.h -- part of the main project source only
#include "iplugin.h"
#include <string>
#include <vector>
#include <windows.h>

class PluginRegistry;

class Plugin : public IPlugin {
public:
    Plugin(PluginRegistry* registry, int index, int moduleIndex)
        : registry(registry), index(index), moduleIndex(moduleIndex)
    {
    }

    virtual void register();
    virtual void initialize();

    virtual void onCheeseBurgerEatenEvent();

private:
    PluginRegistry* registry;
    int index;
    int moduleIndex;
    void* userData;
};

class PluginRegistry {
public:
    registerPluginsInModule(std::string const& modulePath);
    ~PluginRegistry();

public:
    std::vector<Plugin*> plugins;

private:
    extern "C" {
        typedef int (*getPluginCountFunc)();
        typedef void* (*registerPluginFunc)(int);
        typedef void (*initializePluginFunc)(int, void*);
        typedef void (*onCheeseBurgerEatenEventFunc)(int, void*);
    }

    struct Module {
        getPluginCountFunc getPluginCount;
        registerPluginFunc registerPlugin;
        initializePluginFunc initializePlugin;
        onCheeseBurgerEatenEventFunc onCheeseBurgerEatenEvent;

        HMODULE handle;
    };

    friend class Plugin;
    std::vector<Module> registeredModules;
}

// plugin.cpp
void Plugin::register() {
    auto func = registry->registeredModules[moduleIndex].registerPlugin;
    userData = func(index);
}

void Plugin::initialize() {
    auto func = registry->registeredModules[moduleIndex].initializePlugin;
    func(index, userData);
}

void Plugin::onCheeseBurgerEatenEvent() {
    auto func = registry->registeredModules[moduleIndex].onCheeseBurgerEatenEvent;
    func(index, userData);
}

PluginRegistry::registerPluginsInModule(std::string const& modulePath) {
    // For Windows:
    HMODULE handle = LoadLibrary(modulePath.c_str());

    Module module;
    module.handle = handle;
    module.getPluginCount = (getPluginCountFunc)GetProcAddr(handle, "getPluginCount");
    module.registerPlugin = (registerPluginFunc)GetProcAddr(handle, "registerPlugin");
    module.initializePlugin = (initializePluginFunc)GetProcAddr(handle, "initializePlugin");
    module.onCheeseBurgerEatenEvent = (onCheeseBurgerEatenEventFunc)GetProcAddr(handle, "onCheeseBurgerEatenEvent");

    int moduleIndex = registeredModules.size();
    registeredModules.push_back(module);

    int pluginCount = module.getPluginCount();
    for (int i = 0; i < pluginCount; ++i) {
        auto plugin = new Plugin(this, i, moduleIndex);
        plugins.push_back(plugin);
    }
}

PluginRegistry::~PluginRegistry() {
    for (auto it = plugins.begin(); it != plugins.end(); ++it) {
        delete *it;
    }

    for (auto it = registeredModules.begin(); it != registeredModules.end(); ++it) {
        FreeLibrary(it->handle);
    }
}

// When discovering plugins (e.g. by loading all DLLs in a "plugins" folder):
PluginRegistry registry;
registry.registerPluginsInModule("plugins/cheeseburgerwatcher.dll");
for (auto it = registry.plugins.begin(); it != registry.plugins.end(); ++it) {
    (*it)->register();
}
for (auto it = registry.plugins.begin(); it != registry.plugins.end(); ++it) {
    (*it)->initialize();
}

// And then, when a cheeseburger is actually eaten:
for (auto it = registry.plugins.begin(); it != registry.plugins.end(); ++it) {
    auto plugin = *it;
    plugin->onCheeseBurgerEatenEvent();
} 
```

这具有使用 C API 以实现兼容性的好处，但也为用 C++ 编写的插件（以及主要项目代码，即 C++）提供了更高级别的抽象。请注意，它允许在单个 DLL 中定义多个插件。您还可以通过使用宏来消除一些重复的函数名称，但对于这个简单的示例，我选择不这样做。

* * *

顺便说一下，所有这些都假设插件没有相互依赖关系——如果插件 A 影响插件 B（或被插件 B 需要），您需要设计一种安全的方法来根据需要注入/构造依赖关系，因为无法保证插件将按什么顺序加载（或初始化）。在这种情况下，两步过程会很有效：加载并注册所有插件；在注册每个插件期间，让他们注册他们提供的任何服务。在初始化过程中，通过查看注册的服务表，根据需要构造请求的服务。这确保了所有插件提供的所有服务在尝试使用它们*之前*都已注册，无论插件以何种顺序注册或初始化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T08:42:26.017

您采取的方法总体上是理智的，但我看到了一些可能的改进。

*   您的内核应该使用传统的调用约定（cdecl，或者如果您在 Windows 上可能是 stdcall）导出 C 函数，以注册插件和函数。如果您使用 C++ 函数，那么您将强制所有插件作者使用您使用的相同编译器和编译器版本，因为 C++ 函数名称修改、STL 实现和调用约定等许多事情都是编译器特定的。

*   插件应该只导出像内核这样的 C 函数。

*   从定义`getFunction`看来，每个插件都有一个名称，其他插件可以使用该名称来获取其功能。这不是一种安全的做法，两个开发人员可以创建两个具有相同名称的不同插件，因此当一个插件通过名称请求其他插件时，它可能会得到一个与预期不同的插件。更好的解决方案是让插件具有公共[GUID](http://en.wikipedia.org/wiki/Globally_unique_identifier)。这个 GUID 可以出现在每个插件的头文件中，以便其他插件可以引用它。

*   您尚未实施版本控制。理想情况下，您希望对内核进行版本控制，因为将来您总是会更改它。当插件向内核注册时，它会传递编译它所针对的内核 API 的版本。然后内核可以决定是否可以加载插件。例如，如果内核版本 1 收到需要内核版本 2 的插件的注册请求，那么您遇到了问题，解决该问题的最佳方法是不允许插件加载，因为它可能需要内核中不存在的功能旧版本。相反的情况也是可能的，内核 v2 可能希望也可能不希望加载为内核 v1 创建的插件，如果允许，它可能需要适应旧的 API。

*   我不确定我是否喜欢插件能够定位另一个插件并直接调用其函数的想法，因为这会破坏封装。对我来说，如果插件向内核宣传它们的功能似乎更好，这样其他插件就可以通过功能找到他们需要的服务，而不是通过名称或 GUID 来寻址其他插件。

*   请注意，任何分配内存的插件都需要为该内存提供释放函数。每个插件可能使用不同的运行时库，因此插件分配的内存可能不为其他插件或内核所知。在同一个模块中分配和释放可以避免问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-11T05:16:30.657

C++ 没有[ABI](http://en.wikipedia.org/wiki/Application_binary_interface)。所以你想做的有一个限制：插件和你的框架必须由相同的编译器和链接器在相同的操作系统中使用相同的参数进行编译和链接。如果实现是二进制分发形式的互操作，那是没有意义的，因为为框架开发的每个插件都必须准备许多版本，这些版本针对不同的编译器在不同的操作系统上。所以分发源代码会比这更实用，这就是 GNU 的方式（下载 src，配置和制作）

COM 是一种选择，但它过于复杂和过时。或在 .Net 运行时托管 C++。但它们只在 ms os 上。如果您想要一个通用的解决方案，我建议您更改为另一种语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T20:15:54.553

正如 jean 所提到的，由于没有标准的 C++ ABI 和标准的名称修改约定，因此您必须使用相同的编译器和链接器来编译东西。如果你想要一个共享库/dll 类型的插件，你必须使用 C-ish。

如果所有内容都将使用相同的编译器和链接器进行编译，您可能还需要考虑 std::function。

```
typedef std::function<void ()> plugin_function;

std::map<std::string, plugin_function> fncMap;

void register_func(std::string name, plugin_function fnc)
{
   fncMap[name] = fnc;
}

void call(std::string name)
{
   auto it = fncMap.find(name);
   if (it != fncMap.end())
      (it->second)();   // it->second is a function object
}

///////////////

void func()
{
   std::cout << "plain" << std::endl;
}

class T
{
public:
   void method()
   {
     std::cout << "method" << std::endl;
   }

   void method2(int i)
   {
     std::cout << "method2 : " << i << std::endl;
   }
};

T t; // of course "t" needs to outlive the map, you could just as well use shared_ptr

register_func("plain", func);
register_func("method", std::bind(&T::method, &t));
register_func("method2_5", std::bind(&T::method2, &t, 5));
register_func("method2_15", std::bind(&T::method2, &t, 15));

call("plain");
call("method");
call("method2_5");
call("method2_15"); 
```

您还可以使用带有参数的插件函数。这将使用 std::bind 的占位符，但很快你会发现它在 boost::bind 后面有些欠缺。Boost bind 有很好的文档和示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T17:51:44.230

您没有理由不这样做。在 C++ 中使用这种类型的指针是最好的，因为它只是一个普通的指针。我知道没有流行的编译器会做任何像不像普通指针那样制作函数指针那样脑残的事情。有人会做出如此可怕的事情，这超出了理性的范围。

Vst 插件标准以类似的方式运行。它只是在 .dll 中使用函数指针，并且没有直接调用类的方法。Vst 是一个非常流行的标准，在 Windows 上人们几乎可以使用任何编译器来执行 Vst 插件，包括基于 Pascal 且与 C++ 无关的 Delphi。

所以我会完全按照你个人的建议去做。对于常见的知名插件，我不会使用字符串名称，而是使用可以更快查找的整数索引。

另一种方法是使用接口，但如果您的想法已经基于函数指针，我认为没有理由。

如果你使用接口，那么从其他语言调用函数就不是那么容易了。你可以从 Delphi 中做到这一点，但 .NET 呢？

例如，根据您的函数指针样式建议，您可以使用 .NET 来制作其中一个插件。显然，您需要在程序中托管 Mono 来加载它，但只是出于假设目的，它说明了它的简单性。

此外，当您使用接口时，您必须进行引用计数，这很讨厌。像您建议的那样将您的逻辑粘贴在函数指针中，然后将控件包装在一些 C++ 类中，以便为您执行调用和处理。然后其他人可以使用其他语言制作插件，例如 Delphi Pascal、Free Pascal、C、其他 C++ 编译器等...

但与往常一样，无论您做什么，编译器之间的异常处理仍然是一个问题，因此您必须考虑错误处理。最好的方法是插件自己的方法捕获自己的插件异常并将错误代码返回给内核等......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-16T21:14:37.337

有了上面所有出色的答案，我只想补充一点，这种做法实际上分布广泛。在我的实践中，我在商业项目和免费软件/开源项目中都看到了它。

所以 - 是的，这是一个很好且经过验证的架构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-17T15:04:41.327

您不需要手动注册函数。真的吗？真的。

您可以使用插件接口的代理实现，其中每个函数按需从共享库中加载其原始文件，并透明地调用它。到达该接口定义的代理对象的任何人都可以调用这些函数。它们将按需加载。

如果插件是单例，则根本不需要手动绑定（否则必须首先选择正确的实例）。

新插件的开发者的想法是首先描述接口，然后有一个生成器为共享库的实现生成一个存根，另外还有一个具有相同签名但具有按需自动加载的插件代理类然后在客户端软件中使用。两者都应该实现相同的接口（在 C++ 中是纯抽象类）。

# android - Android mapview：如何平滑地同时缩放和居中

> ID：14783332
> 
> 赞同：0
> 
> 时间：2013-02-09T00:03:17.693
> 
> 标签：android, android-mapview, zooming, center

似乎无法使用适用于 android 的 google map sdk 平滑地缩放和居中...我一直在尝试使用计时器以及 zoomInFixing/zoomToSpan 和 setCenter/animateTo 的组合几个小时，但没有任何效果。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:34:25.133

```
//setZoom is not smooth, but you can emulate that effect using an approach like this:

zoom = 0;
totalZoom = 16;
deltaZoom = 0.5;

while(zoom < totalZoom){
sleep(100);
mapController.setZoom(zoom);
zoom += deltaZoom;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:13:46.297

您是否尝试过这样的方法？

```
private void goToPoint(Double longitude, Double latitude) {

        Double latAux = latitude * 1E6;
        Double lngAux = longitude * 1E6;

        MapController mapController = mapView.getController();

        mapController.animateTo(point);
        mapController.setZoom(16);
} 
```

如果你假装更流畅的东西，你必须自己实现它。多次放大总缩放的增量值。

```
zoom = 0; 
totalZoom = 16; 
deltaZoom = 0.5;
while(zoom < totalZoom){ 
  sleep(100); 
  mapController.setZoom(zoom); 
  zoom += deltaZoom; 
} 
```

# json - solrj QueryResponse 转换为 json

> ID：14783334
> 
> 赞同：1
> 
> 时间：2013-02-09T00:03:37.533
> 
> 标签：json, solrj

我使用 solrj 向 solr 提交查询，该查询以 json 格式返回结果。

```
SolrQuery query = new SolrQuery();    
SolrQuery query = new SolrQuery();
query.setParam("kw", keyword);
query.setParam("lc", location);
query.setParam("wt", "json");
query.setParam(CommonParams.QT, "/lds");
QueryResponse qResponse = solrServer.query(query);
searchResultStr = qResponse.toString(); 
```

但是 searchResultStr 没有 JSON 格式的字符串。相反，它有这样的东西：

> {responseHeader={status=0,QTime=21},location={has_zipcode=true,location_param=94085}}

但是如果我直接在浏览器中点击 solr url，我会得到正确的 JSBON 格式：

> {"responseHeader":{"status":0,"QTime":15},"location": {"has_zipcode":true,"location_param":"94085"}}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-12T07:07:59.837

Solr QueryResponse 返回一个 hashmap，所以使用任何 hashmap 到 json 转换器来获取 json。在这里，我使用 Gson() 进行转换。

```
QueryResponse response = solr.query(query);
Gson gson = new Gson(); 
String json = gson.toJson(response.getResults());
System.out.println(json); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T15:47:34.590

对于`JSON`输出，您必须按照[此处](https://stackoverflow.com/questions/2586975/how-to-use-curl-in-java)答案中的说明查询`HTTPSolrServer`使用。使用将无济于事，即。`curl``EmbeddedSolrServer``solrj`

当您使用`solrj`查询时，您必须`SolrDocumentList`从对象中获取并通过遍历每个对象并将数据转换为您想要的方式 `QueryResponse`将其转换为格式。`JSON``SolrDocument``JSON`

# c# - 调用回复时用户重复

> ID：14783339
> 
> 赞同：1
> 
> 时间：2013-02-09T00:04:21.820
> 
> 标签：c#, asp.net-mvc, linq, linq-to-entities, ef-code-first

我正在尝试使用 MVC 制作一个简单的论坛，但我无法弄清楚为什么发布回复的用户会被重复。

这是回复操作：

```
[HttpPost]
public ActionResult Reply(string Title, string Content,int ReplyTo)
{
    Post masterPost = db.Posts.FirstOrDefault(p => p.PostID == ReplyTo);
    Post post = new Post();
    post.PostID = 0;
    post.CreatedOn = DateTime.Now;
    post.ModifiedOn = DateTime.Now;
    post.ReplyTo = masterPost;
    post.Forum = db.Forums.FirstOrDefault(f=>f.ForumID == masterPost.Forum.ForumID);
    post.User = (User)Session["User"];
    post.Title = Title;
    post.Content = Content;

    //if (ModelState.IsValid)
    //{
        db.Posts.Add(post);
        db.SaveChanges();
        return RedirectToAction("View", "Posts", new { id = ReplyTo });
    //}
    return View(post);
} 
```

这是 Post 实体：

```
public class Post
{
    [Key]
    public int PostID { get; set; }
    public string Title { get; set; }
    [DataType(DataType.MultilineText)]
    public string Content { get; set; }
    public DateTime CreatedOn { get; set; }
    public DateTime? ModifiedOn { get; set; }
    public virtual Forum Forum { get; set; }
    public virtual User User { get; set; }
    public virtual Post ReplyTo { get; set; }
} 
```

这是用户实体：

```
public class User
{
    public int UserID { get; set; }
    public string Name { get; set; }
    public string Username { get; set; }
    public string Password { get; set; }
    public string Email { get; set; }
    public DateTime RegisteredOn { get; set; }
} 
```

每当调用ReplyTo 操作时，它都会创建帖子，但它也会复制存储在会话中的用户（具有不同的用户ID）。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:07:27.763

即使您没有说明，看起来您使用的是实体框架。

如果是这样，罪魁祸首可能就是这条线

```
post.User = (User)Session["User"]; 
```

您存储在会话中的“用户”现在与实体框架断开连接，因此 EF 假定它是全新用户。

有几种方法可以解决这个问题。我更喜欢的一个是将 UserId 属性添加到您的 Post 类并使用它

```
public class Post
{
    // Stuff
    public virtual int UserId { get; set; }
} 
```

然后做：

```
post.UserId = ((User)Session["User"]).Id; 
```

Entity Framework 使用约定来了解您希望将该用户链接到该帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:18:21.580

因此，当您说“它也复制了用户”时，我得出的结论是，您在 db.SaveChanges 之后在数据库中获得了重复的用户类型。

鉴于我的假设，那么我推测存储在 Session["User"] 中的用户没有现有的 UserID 属性集，并且/或者您的 EF 模型没有 Post to User 多重关联集。通常，我希望在 Post 中看到 UserId 属性，而您上面的示例没有显示这一点。

检查您的模型以确保您在 User 和 Post 之间设置了关联，并且有一个将 Post 链接到 User 的外键属性。Post 对象需要一个引用 UserId 的外键。

看看Microsoft 的这个示例[中的第 5 步。](http://blogs.msdn.com/b/efdesign/archive/2009/03/16/foreign-keys-in-the-entity-framework.aspx)

# python - ImportError 没有名为帐户的模块

> ID：14783344
> 
> 赞同：0
> 
> 时间：2013-02-09T00:04:56.363
> 
> 标签：python, django

尝试使用 Django 创建简单的登录功能，而我对使用 python 和 django 还是很陌生。我一直在寻找一段时间，但没有找到任何解决问题的方法。我正在使用 MS VS2010 运行 Django，所以我在 Windows 而不是典型的 linux 环境下工作。运行时，我得到这个：

```
Request Method: GET
Request URL:    http://localhost:1214/accounts/signup
Django Version: 1.4.3
Exception Type: ImportError
Exception Value:    
No module named accounts
Exception Location: C:\Python27\lib\site-packages\django\utils\importlib.py in import_module, line 35
Python Executable:  C:\Python27\python.exe
Python Version: 2.7.3
Python Path:    
['C:\\Users\\brandon\\Desktop\\AdvancedLogin\\AdvancedLogin',
 'C:\\Windows\\system32\\python27.zip',
 'C:\\Python27\\DLLs',
 'C:\\Python27\\lib',
 'C:\\Python27\\lib\\plat-win',
 'C:\\Python27\\lib\\lib-tk',
 'C:\\Python27',
 'C:\\Python27\\lib\\site-packages'] 
```

我 `__init__.py` 在 bot 的主项目目录和 app 目录中找到了该文件，尽管我根本没有修改它们。我真的不知道从这里去哪里。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T05:03:33.143

您是否将帐户添加到您的 settings.py 中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-04T12:49:50.877

对于其他人，请务必使用正确的 AUTHENTICATION_BACKENDS。我已经设置了一个进行测试，但忘记了，我也遇到了同样的错误。

在我之前： **settings.py**

```
AUTHENTICATION_BACKENDS = (
    'accounts.backends.MyAuthBackend',
) 
```

之后：**settings.py**

```
#Default one
AUTHENTICATION_BACKENDS = (
    'django.contrib.auth.backends.ModelBackend',
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-11T00:39:12.940

[![在此处输入图像描述](../Images/53ab0c14cb1f6ad68ef93c3795ef61fb.png)](https://i.stack.imgur.com/JnacC.png) 当我在“INSTALLED_APPS”的 setting.py 文件中包含“accounts”时，我遇到了同样的错误。但是我使用的是 sublime 编辑器，所以我忘记保存该文件并收到此错误。只需将此“帐户”添加到 INSTALLED_APPS。这对我有用。

[![在此处输入图像描述](../Images/1efaa66e4adb808e09b4cbe2b02f51bc.png)](https://i.stack.imgur.com/DTlUM.png)

# java - ant：生成的JAR无法执行

> ID：14783345
> 
> 赞同：0
> 
> 时间：2013-02-09T00:04:59.780
> 
> 标签：java, ant, jar, javac

我已经编写/复制了一个简单的 ant 示例，并试图用它部署一个 Java 程序。我的构建文件`bsp0201.xml`：

```
<?xml version="1.0" encoding="UTF-8" ?>
<project name="bsp0201" default="main" basedir=".">
    <property name="dir.src" value="./source" />
    <property name="dir.build" value="./classes" />
    <property name="dir.lib" value="./lib" />
    <path id="cp">
        <pathelement path="${classpath}" />
        <pathelement location="${dir.build}" />
    </path>
    <target name="main" depends="prepare, compile, run" />
    <target name="prepare">
        <mkdir dir="${dir.build}" />
        <delete>
            <fileset dir="${dir.build}" includes="**/*" />
        </delete>
    </target>
    <target name="compile">
        <javac classpathref="cp" destdir="${dir.build}" srcdir="${dir.src}" includes="**/*.java" includeantruntime="false" />
        <mkdir dir="${dir.lib}" />
        <jar destfile="${dir.lib}/ae.jar">
            <fileset dir="${dir.build}" includes="**/*.class" />
        </jar>
    </target>
    <target name="run" if="test">
        <java classname="main.GeoAnalyzerMain" classpath="${dir.lib}/ae.jar">
            <arg line="${test}" />
        </java>
    </target>
</project> 
```

我的蚂蚁突击队和结果输出：

```
# ant -f bsp0201.xml run -Dtest=Echo
Buildfile: /var/www/sandbox/ant/bsp0201/bsp0201.xml

run:

BUILD SUCCESSFUL
Total time: 1 second 
```

Ant 生成文件夹、类文件和 JAR 文件`ae.jar`。但是这个 JAR 文件的大小只有 19.1 KB（而不是 297 KB 的 JAR 文件，当我用 eclipse 生成它时）并且我无法执行它。我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T12:13:40.770

是的，比较 JAR 是个好主意。:) 在这里您可以看到比较结果：

![JAR 比较](../Images/499e684bfedb33c214b84952d42769e0.png)

Ant-JAR 中缺少文件夹 /img 和 /.classpath。为什么 Ant 没有包含它们？如何让 Ant 包含丢失的文件/文件夹？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T09:40:31.667

我编辑了构建 XML：

```
<?xml version="1.0" encoding="UTF-8" ?>
<project name="bsp0201" default="main" basedir=".">
    <property name="dir.src" value="./source" />
    <property name="dir.build" value="./classes" />
    <property name="dir.lib" value="./lib" />
    <path id="cp">
        <pathelement path="${classpath}" />
        <pathelement location="${dir.build}" />
    </path>
    <target name="main" depends="prepare, compile, run" />
    <target name="prepare">
        <mkdir dir="${dir.build}" />
        <delete>
            <fileset dir="${dir.build}" includes="**/*" />
        </delete>
    </target>
    <target name="compile">
        <javac classpathref="cp" destdir="${dir.build}" srcdir="${dir.src}" includes="**/*.java" includeantruntime="false" />
        <mkdir dir="${dir.lib}" />
        <jar destfile="${dir.lib}/AntExample.jar">
            <fileset dir="${dir.build}" includes="**/*.class" />
            <fileset dir=".">
                <include name="img/*.*" />
            </fileset>
        </jar>
    </target>
    <target name="run" if="test">
        <java classname="main.GeoAnalyzerMain" classpath="${dir.lib}/AntExample.jar">
            <arg line="${test}" />
        </java>
    </target>
</project> 
```

现在图像文件夹被复制到结果存档中。但是 JAR 仍然无法执行。

编辑：

有用！

```
<?xml version="1.0" encoding="UTF-8" ?>
<project name="bsp0201" default="main" basedir=".">
    <property name="dir.src" value="./source" />
    <property name="dir.build" value="./classes" />
    <property name="dir.lib" value="./lib" />
    <path id="cp">
        <pathelement path="${classpath}" />
        <pathelement location="${dir.build}" />
    </path>
    <target name="main" depends="prepare, compile, run" />
    <target name="prepare">
        <mkdir dir="${dir.build}" />
        <delete>
            <fileset dir="${dir.build}" includes="**/*" />
        </delete>
    </target>
    <target name="compile">
        <javac classpathref="cp" destdir="${dir.build}" srcdir="${dir.src}" includes="**/*.java" includeantruntime="false" />
        <mkdir dir="${dir.lib}" />
        <jar destfile="${dir.lib}/AntExample.jar">
            <fileset dir="${dir.build}" includes="**/*.class" />
            <fileset dir=".">
                <include name="img/*.*" />
            </fileset>
            <manifest>
                <attribute name="Main-Class" value="main.GeoAnalyzerMain" />
            </manifest>
        </jar>
    </target>
    <target name="run" if="test">
        <java classname="main.GeoAnalyzerMain" classpath="${dir.lib}/AntExample.jar">
            <arg line="${test}" />
        </java>
    </target>
</project> 
```

# c++ - 将 char* 相互比较

> ID：14783346
> 
> 赞同：4
> 
> 时间：2013-02-09T00:05:01.387
> 
> 标签：c++, visual-studio-2010

我目前有一个名为 getResult 的方法，它返回 const char* 现在我正在做这样的事情

```
if(getResult=="Something")
{
  ...
} 
```

但是，这种比较似乎不起作用。“Something”不是也是一个 const char 指针吗？或者在这种情况下是比较地址吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T00:06:23.287

如果`getResult`是一个方法（成员函数），你需要*调用*它来比较结果，所以你可能想要：

```
if (something.getResult() == std::string("Something"))
  // ... 
```

另一方面，如果`getResult`确实是指向 char 的指针（或指向 const char 的指针），则需要在比较`string`之前转换要比较的内容之一）：

```
if (getResult == std::string("Something")) 
```

或者：

```
if (std::string(getResult) == "something)) 
```

IMO，这*几乎*从来没有必要——而不是从指向 [const] char 的指针开始，然后进行转换，您通常应该`std::string`在整个过程中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T00:06:31.617

是的，正在比较地址。要比较两个字符串的*内容*[`strcmp`](http://linux.die.net/man/3/strcmp)，请使用以下函数：

```
if (strcmp(getResult, "Something") == 0) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T00:08:54.130

如果您比较 C/C++ 中的 2 个字符串常量，您会比较每个字符串的实际地址，而不是内容。使用`strcmp`2 个 c 字符串或使用 C++ 的`std::string`类将比较内容。

# python - 使用 pyinstaller 编译我的脚本后如何避免黑壳窗口

> ID：14783348
> 
> 赞同：2
> 
> 时间：2013-02-09T00:05:07.717
> 
> 标签：python, shell, compilation, wxpython, pyinstaller

我正在使用 wxpython 开发 GUI，并使用 pyinstaller 编译它。一切正常，但在程序实际午餐之前总是会弹出一个黑色外壳窗口。（就像您使用 python 而不是 pythonw 来运行脚本一样）

我的问题是，如何避免这种情况？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-09T03:06:27.913

来自：[http ://www.pyinstaller.org/export/v2.0/project/doc/Manual.html?format=raw#getting-started](http://www.pyinstaller.org/export/v2.0/project/doc/Manual.html?format=raw#getting-started)

> -w, --windowed, --noconsol
> 使用窗口子系统可执行文件，在 Windows 上启动程序时不会打开控制台。

# android - 谷歌 api 版本 v1 与 v2

> ID：14783353
> 
> 赞同：1
> 
> 时间：2013-02-09T00:05:40.420
> 
> 标签：android, google-maps, google-play

我即将将使用 google api v1 的 Android 应用程序推向市场。我现在看到 v1 已被贬值，我被敦促改用 v2。我看到 v2 看起来要复杂一个数量级，并且需要 google play 服务。

由于需要 google play 服务，这是否意味着我的应用程序只能在 google play 上分发，而不能从我自己的网站分发？

谢谢，加里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:25:05.217

> 由于需要 google play 服务，这是否意味着我的应用程序只能在 google play 上分发

不，您仍然可以通过您想要的任何渠道进行分发。这是设备的要求，而不是分发。安装您的应用程序的设备需要安装 Google Play 服务，这是一个数字。它与需要手机安装谷歌地图的 v1 地图非常相似，反映在清单中

```
<uses-library android:name="com.google.android.maps"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:26:02.217

谷歌喜欢让每个人都像往常一样使用自己的系统。但是应该仍然可以通过您的网站进行分发。您需要将其保存为 .apk 文件。

[继承人](https://superuser.com/questions/499513/eclipse-save-as-apk-in-my-computer)如何保存为 .apk 文件

这里有一个关于用户如何下载和安装的教程[。](http://news.softpedia.com/news/How-to-Manually-Install-APK-Files-on-Android-Smartphones-150487.shtml)

# c# - 无法在 .NET 3.5 中使用 ServiceController 停止服务

> ID：14783354
> 
> 赞同：2
> 
> 时间：2013-02-09T00:05:45.207
> 
> 标签：c#, .net, service, windows-services, servicecontroller

我在 .NET 3.5 中工作，并且在使用 ServiceController 停止某些服务时遇到了问题。我搜索了整个互联网，但没有找到解决问题的方法；）

我是这样做的：

```
使用 (ServiceController service = new ServiceController("Service"))
{
    尝试
    {
        TimeSpan 超时 = TimeSpan.FromSeconds(timeoutSeconds);

        服务.停止（）；
        service.WaitForStatus(ServiceControllerStatus.Stopped, timeout);
    }
    捕捉（例外前）
    {
        Console.WriteLine(ex.ToString());
    }
}

```

我正在等到我的服务停止。然后我想替换它的库（更新它）。并抛出异常：

*UnauthorizedAccessException 异常详细信息：System.UnauthorizedAccessException：对路径“blablabla”的访问被拒绝。*

我确定我可以访问此路径，因为我以管理员身份运行我的应用程序。

有趣的是，当这段代码执行时，该服务从当前服务列表中消失（在任务管理器中）。所以它实际上停止了它，但是一些线程仍然必须使用它，所以我不能移动任何服务的文件。即使我尝试自己移动文件（我转到服务目录并尝试使用鼠标移动其文件）我也做不到。但是当我手动停止服务（任务管理器和“结束任务”）时，我可以对它的文件做任何我想做的事情。那么从 C# 代码（使用 ServiceController）停止它和使用任务管理器停止它有什么区别？

我不知道这是否重要，但我在 Virtual Box 的 Windows Server 2008 上运行此应用程序（和此服务）。（我需要在其他机器上运行它，然后是我的电脑）。

有什么想法可以解决这个问题吗？;)

谢谢你的帮助。

最好的祝愿，皮特。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T22:57:01.223

好的，我解决了我的问题。

首先，我使用了`Administrator Command-Prompt Command`of`Net Stop`来停止它`Service`并且它**起作用**了，但我开始想知道为什么。答案是花了很多时间！ `ServiceController`实际上停止了它，但一些进程仍在使用它。

```
 service.WaitForStatus(ServiceControllerStatus.Stopped, timeout); 
```

也工作得很好，因为它立即改变了服务的状态（这只是列表中的一个变化`Windows Services`），但是使用某些服务礼貌地关闭所有线程需要一些时间:)

因此，您需要做的就是等待，然后再次检查它是否仍在运行。如果是，那么就用`Process`类杀死它。

# php - 基于 sql 位值创建自定义 html 内容。空, 0, 1

> ID：14783366
> 
> 赞同：0
> 
> 时间：2013-02-09T00:06:58.497
> 
> 标签：php, html, sql

如果没有图像，它会**在 File 上返回 No Rx**，这可以正常工作。如果有图像，它会在蓝色链接中返回**Rx Requires Validation 。**上传图像时，它是 0，当它被选择为活动时，它变成 1 作为数据库中的活动字段。我不确定如何将所有图像设置为 0 蓝色，现在将活动图像设置为 1 绿色。我认为我的逻辑在这一点上已经被破坏了..任何帮助将不胜感激。

```
if ($a['rx_scanned'] === null)
    {
         echo "<tr><td>**No Rx on File**</td></tr>"; 
    }

elseif ($a['rx_scanned'] = 1 ) 
    {
  $rx_image_color = '#009933';

    echo "<tr><td> &nbsp;<img src='http://sqlserver/test/tim/leaflet/check-icon.gif'>&nbsp;<a href='" 
            . matry::base_to('patient/image/view', array('event_id'=>$event->id, 'patient_id'=>$patient->code, 'uniqueid'=>$a['image_id'])) 
            . "' style='color:$rx_image_color'>Valid Rx on File</a></td></tr>"; 

    }
else   
    { 
      $rx_image_color = '#3366FF';
      echo "<tr><td>" . cbox_return($name) . "<a href='" 
            . matry::base_to('patient/image/view', array('event_id'=>$event->id, 'patient_id'=>$patient->code, 'uniqueid'=>$a['image_id'])) 
            . "'>**Rx Requires Validation**</a></td></tr>"; 
    }   

echo "<tr><td></td></tr>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:56:25.343

如果我对您的理解正确，您是在说 rx_scanned 是一个布尔值，而不是一个数字。

您需要更改条件以检查布尔值（我不是 PHP 开发人员，但我想像这样）

```
if ($a['rx_scanned']) {
  $rx_image_color = '#009933';
   // Insert your stuff here.
}
else {
  $rx_image_color = '#3366FF';
  echo "<tr><td>**No Rx on File**</td></tr>";
} 
```

# linux - 搜索字符串的标准命令

> ID：14783368
> 
> 赞同：1
> 
> 时间：2013-02-09T00:07:11.367
> 
> 标签：linux, unix

我正在尝试列出所有包含某个字符串的标准命令。有人告诉我 echo $PATH 会对此有所帮助，但我不确定如何...有什么建议吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:11:47.660

试试这个：

`find `echo $PATH | tr : ' ' ` | grep FOO`

其中“FOO”是您感兴趣的字符串。

如果您想忽略大小写，请使用以下`-i`标志`grep`：

`find `echo $PATH | tr : ' ' ` | grep -i FOO`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:10:58.880

```
ls `echo $PATH | tr ':' '\n'` | grep "string_to_search_for" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:20:57.460

所有“标准命令”将位于 /bin、/usr/bin、/sbin、/usr/sbin、/usr/local/bin、/usr/local/sbin、/usr/local/something/bin 等. 所以所有的命令前面都有一个“bin/”。让它`locate`做它的事：

```
locate bin/ | grep -F 'whatever you are looking for' 
```

实际上，/sbin 和 /usr/sbin 将包含系统命令。如果你想排除那些：

```
locate bin/ | grep -F sbin/ | grep -F 'whatever you are looking for' 
```

您想了解的有关不同 bin 和 sbin 目录的所有信息都可以在[Filesystem Hierarchy Standard (FHS)](http://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard#Directory_structure)中找到。

# php - 在 PHP PCRE 函数中双重转义还是不双重转义？

> ID：14783370
> 
> 赞同：4
> 
> 时间：2013-02-09T00:07:18.370
> 
> 标签：php, regex

我一直在寻找一篇关于何时需要双重转义以及何时不需要的可靠文章，但我找不到任何东西。也许我看起来不够努力，因为我确信在某个地方有一个解释，但是让下一个有这个问题的人很容易找到！

以以下正则表达式模式为例：

```
/\n/
/domain\.com/
/myfeet \$ your feet/ 
```

没有什么突破性的吧？好的，让我们在 PHP 的 preg_match 函数的上下文中使用这些示例：

```
$foo = preg_match("/\n/", $bar);
$foo = preg_match("/domain\.com/", $bar);
$foo = preg_match("/myfeet \$ your feet/", $bar); 
```

据我了解，带引号的字符串值上下文中的反斜杠会转义以下字符，并且表达式是通过带引号的字符串值给出的。

以前会不会像做以下那样，这不会导致错误吗？：

```
$foo = preg_match("/n/", $bar);
$foo = preg_match("/domain.com/", $bar);
$foo = preg_match("/myfeet $ your feet/", $bar); 
```

这不是我想要的吗？这些表达方式与上述不同。

我不必像这样写它们双重转义吗？

```
$foo = preg_match("/\\n/", $bar);
$foo = preg_match("/domain\\.com/", $bar);
$foo = preg_match("/myfeet \\$ your feet/", $bar); 
```

这样当 PHP 处理字符串时，它会将反斜杠转义为反斜杠，然后在传递给 PCRE 解释器时保留该反斜杠？

还是 PHP 只是神奇地知道我想将该反斜杠传递给 PCRE 解释器......我的意思是它怎么知道我没有试图`\"`逃避我想在我的表达式中使用的引号？还是在使用转义引号时只需要双斜杠？就此而言，您是否需要三倍转义报价？`\\\"`你知道，所以引号被转义并留下一个双精度？

这有什么经验法则？

我刚刚用PHP做了一个测试：

```
$bar = "asdfasdf a\"ONE\"sfda dsf adsf me & mine adsf asdf asfd ";

echo preg_match("/me \$ mine/", $bar);
echo "<br /><br />";
echo preg_match("/me \\$ mine/", $bar);
echo "<br /><br />";
echo preg_match("/a\"ONE\"/", $bar);
echo "<br /><br />";
echo preg_match("/a\\\"ONE\\\"/", $bar);
echo "<br /><br />"; 
```

输出：

```
0

1

1

1 
```

所以，看起来对引号并不重要，但对于美元符号，我认为需要双重转义。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T00:10:09.760

**双引号字符串**

当涉及在双引号内转义时，规则是 PHP 将检查紧跟在反斜杠后面的字符。

如果相邻字符在集合中，`ntrvef\$"`或者后面有一个数值（规则可以在[此处](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)找到），则它分别被评估为相应的控制字符或序数（十六进制或八进制）表示。

重要的是要注意，如果给出了无效的转义序列，则不会计算表达式并且反斜杠和字符都保留。这与其他一些语言不同，其中无效的转义序列会导致错误。

例如`"domain\.com"`，将保持原样。

请注意，变量也会在双引号内展开，例如`"$var"`需要转义为`"\$var"`.

**单引号字符串**

自 PHP 5.1.1 起，单引号字符串中的任何反斜杠（并且后跟至少一个字符）都将按原样打印，并且也不会替换任何变量。这是迄今为止单引号字符串最方便的特性。

**常用表达**

对于转义正则表达式，最好将转义保留为`preg_quote()`：

```
$foo = preg_match('/' . preg_quote('mine & yours', '/') . '/', $bar); 
```

这样您就不必担心需要转义哪些字符，因此它适用于用户输入。

也可以看看：[`preg_quote`](http://www.php.net/preg_quote)

**更新**

你添加了这个测试：

```
"/me \$ mine/" 
```

这被评估为`"/me $ mine/"`; 但在 PCRE 中`$`具有特殊含义（它是主题结束锚）。

```
"/me \\$ mine/" 
```

这被评估为`"/me \$ mine/"`，因此反斜杠对 PHP 本身进行了`$`转义，而对 PCRE 进行了转义。顺便说一句，这只是偶然的。

```
$var = 'something';

"/me \\$var mine/" 
```

这被评估为`"/me \something"`，因此您需要`$`再次转义。

```
"/me \\\$var mine/" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:09:55.097

使用单引号。它们防止发生转义序列。

例如：

```
php > print "hi\n";
hi
php > print 'hi\n';
hi\nphp > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:47:27.057

好的所以我做了一些更多的测试并发现了在双引号中封装 PCRE 时的拇指规则，以下是正确的：

`$`- 需要双重转义，因为如果文本紧随其后，PHP 会将其解释为变量的开头。未转义，它将指示您的针头结束并会折断。

`\r\n\t\v`- 特殊的 PHP 字符串转义，仅需要单个转义。

`[\^$.|?*+()`- 特殊的正则表达式字符，只需要单转义。不必要地使用时，双重转义似乎不会破坏表达式。

`"`- 由于封装，引号显然必须转义，但只需要转义一次。

`\`- 寻找反斜杠？使用表达式的双引号封装，这将需要 3 次转义！\\（总共四个反斜杠）

有什么我想念的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T00:16:14.223

每当您有一个无效的转义序列时，PHP 实际上将字符留在字符串中。从[文档](http://php.net/manual/en/language.types.string.php#language.types.string.syntax.double)中：

> 与单引号字符串一样，转义任何其他字符也会导致打印反斜杠。

即`"\&"`真的被解释为`"\&"`。转义序列并不多，因此在大多数情况下，您可能只需要一个反斜杠即可。但为了保持一致性，转义反斜杠可能是更好的选择。

一如既往：知道你在做什么:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-16T02:49:27.010

我将开始说，我将在下面写的并不完全是发生了什么，但是为了清楚起见，我将对其进行简化。

想象一下，**当使用正则表达式时发生了两个评估**：第一个由 PHP 完成，第二个由 PCRE 完成，就好像它们是单独的引擎一样。为了我们的倒霉，

**PHP 和 PCRE 以不同的方式评估事物。**

我们这里有 3 个“人”：1）用户；2）PHP和；3）PCRE。

用户通过编写代码与 PHP 通信，这正是您在代码编辑器中键入的内容。PHP 然后评估此代码并将另一位信息发送到 PCRE。这条信息与您在 CODE 中键入的信息不同。PCRE 然后评估它并向 PHP 返回一些东西，PHP 评估这个响应并向用户返回一些东西。

我将在下面的示例中更好地解释。在那里，我将使用反斜杠（“\”）来说明正在发生的事情。

假设在 php 文件中有这段 CODE：

```
<?php
$sub = "A backslash \ in a string";
$pat1 = "#\#";
$pat2 = "#\\#";
$pat3 = "#\\\#";
$pat4 = "#\\\\#";

echo "sub: ".$sub;
echo "\n\n";

echo "pat1: ".$pat1;
echo "\n";
echo "pat2: ".$pat2;
echo "\n";
echo "pat3: ".$pat3;
echo "\n";
echo "pat4: ".$pat4;
?> 
```

这将打印：

> ```
> sub: A backslash \ in a string
> 
> pat1: #\#
> pat2: #\#
> pat3: #\\#
> pat4: #\\# 
> ```

在这个例子中，没有涉及到正则表达式，所以只发生了代码的 PHP 评估。 **PHP 保留一个反斜杠，就好像它没有在任何特殊字符之前一样**。这就是它在 $sub 中正确打印反斜杠的原因。

PHP 对 $pat1 和 $pat2 的评估完全相同，因为在 $pat1 中，反斜杠保持原样，而在 $pat2 中，第一个反斜杠转义了第二个反斜杠，从而产生了一个反斜杠。

现在，在 $pat3 中，第一个反斜杠转义了第二个反斜杠，从而产生一个反斜杠。然后 PHP 计算第三个反斜杠并保持原样，因为它没有任何特殊的前面。结果将是双反斜杠。

现在有人可能会说“但是现在我们又有两个反斜杠了！第一个不应该再次逃脱第二个吗？！” 答案是不”。在 PHP 将前两个反斜杠计算为一个后，它不再回头，而是继续评估下一个反斜杠。

此时您已经知道 $pat4 发生了什么：第一个反斜杠转义第二个反斜杠，第三个反斜杠转义第四个，最后留下两个。

现在很清楚 PHP 对这些字符串做了什么，让我们在前面的代码之后添加更多代码。

```
if (preg_match($pat1, $sub)) echo "test1: true"; else echo "test1: false";
echo "\n";

if (preg_match($pat2, $sub)) echo "test2: true"; else echo "test2: false";
echo "\n";

if (preg_match($pat3, $sub)) echo "test3: true"; else echo "test3: false";
echo "\n";

if (preg_match($pat4, $sub)) echo "test4: true"; else echo "test4: false"; 
```

结果是：

> ```
> test1: false
> test2: false
> test3: true
> test4: true 
> ```

所以，这里发生的事情是 PHP 没有将代码中的“你输入的内容”直接发送到 PCRE。相反，PHP 发送的是它之前评估过的内容（这正是我们在上面看到的）。

对于 test1 和 test2，即使我们在 CODE 中为每个测试编写了不同的模式，PHP 仍将相同的模式**#\#**发送到 PCRE。test3 和 test4 发生同样的事情：PHP 正在发送**#\\#**。因此，test1 和 test2 以及 test3 和 test4 的结果相同。

现在，当 PCRE 评估这些模式时会发生什么？PCRE 不像 PHP。

在 test1 和 test2 中，当 PCRE 看到单个反斜杠没有转义任何特殊内容（或根本没有转义）时，它不会保持原样。相反，它可能会认为“这到底是什么？” 并向PHP返回一个错误（实际上，我真的不知道向PCRE发送单个反斜杠时发生了什么，搜索了这个，但仍然没有定论）。然后 PHP 接受我们假设的错误并将其评估为“假”并将其返回给代码的其余部分（在此示例中为*if ()*函数）。

在 test3 和 test4 中，事情按照我们现在的预期进行：PCRE 将第一个反斜杠评估为转义第二个反斜杠，从而产生一个反斜杠。这当然匹配 $sub 字符串并向 PHP 返回“成功消息”，PHP 将其评估为“真”。

**回答问题**
有些字符对于 PHP 来说是特殊的（例如， **n**代表新行，**t**代表制表符）。
某些字符对于 PCRE 是特殊的（例如**，.**（点）匹配任何字符，**s**匹配空格）。
并且某些字符对两者都是特殊的（例如， **$**到 php 是变量名称的开头，而对于 PCRE，它断言主题的结尾）。

这就是为什么你只需要转义一次换行符，就像这样**\n**。PHP 会将其评估为真实字符 NEW LINE 并将其发送到 PCRE。

对于点，如果要匹配该特定字符，则应使用**\。**而 PHP 什么也不做，因为点不是字符串中 PHP 的特殊**字符**。相反，它将按原样将它们发送到 PCRE。现在在 PCRE 上，它会“看到”一个点前面的反斜杠，并理解它应该匹配那个特定的字符。如果您使用双重转义**\\.** 第一个反斜杠将转义第二个反斜杠，使您得到相同的结果。

如果你想匹配字符串中的美元符号，那么你应该使用**\\\$**。在 PHP 中，第一个反斜杠将转义第二个反斜杠，留下一个反斜杠。然后第三个反斜杠将避开美元符号。最后，结果是**\$**。这是 PCRE 将收到的。PCRE 将看到反斜杠并理解美元符号不是断言主题结束，而是文字字符。

**引号**

现在我们来到了报价。它们的问题在于 PHP 以不同的方式评估字符串，具体取决于用于包围它的引号。看看：[字符串](https://secure.php.net/manual/en/language.types.string.php)

在此之前我所说的所有内容都适用于双引号。如果你在单引号中尝试这个**'\n'**，PHP 会将该反斜杠作为文字来评估。
但是，如果在正则表达式中使用它，PCRE 将按原样获取此字符串。而且由于**n**对 PCRE 也是特殊的，它会将其解释为换行符，并且 BOOM，它“神奇地”匹配字符串中的换行符。在此处检查转义序列：[转义序列](http://php.net/manual/en/regexp.reference.escape.php)

正如我在一开始所说的那样，事情并不完全像我在这里试图解释的那样，但我真的希望它有所帮助（并且不要让它比现在更混乱）。

# visual-studio-2010 - 相同的 wixproj 文件仅适用于 VS 2012 IDE，但不适用于 VS 命令提示符

> ID：14783373
> 
> 赞同：0
> 
> 时间：2013-02-09T00:07:30.977
> 
> 标签：visual-studio-2010, msbuild, wix, msbuild-4.0, wix3.7

我正在尝试此[页面](http://wix.sourceforge.net/manual-wix3/daily_builds.htm)上的步骤。我已将 wix 二进制文件安装在本地计算机上的文件夹中。

所以我得到了一个由 wix VS 2010 插件创建的 wix 安装程序项目。我可以使用 VS 2010 IDE 来构建它并生成 msi 文件，但我不能在 VS 命令提示符下使用 Msbuild 做同样的事情。当 Msbuild 尝试编译时，出现一个错误，抱怨 candle.exe 找不到：

> 未处理的异常：System.IO.FileLoadException：无法加载文件或程序集“file:///C:\MyFolder\Wix\candle.exe”或其依赖项之一。不支持操作。（来自 HRESULT 的异常：0x80131515）---> System.NotSupportedException：尝试从网络位置加载程序集，这会导致程序集在以前版本的 .NET Framework 中被沙盒化。此版本的 .NET Framework 默认情况下不启用 CAS 策略，因此这种加载可能很危险。如果此加载不打算对程序集进行沙箱处理，请启用 loadFromRemoteSources 开关。有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=155569](http://go.microsoft.com/fwlink/?LinkId=155569)。

我很确定 exe 在正确的位置，因为 VS IDE 可以找到它。我想知道我对 Msbuild 缺少什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-15T03:23:01.113

我从这里找到了答案：http: [//windows-installer-xml-wix-toolset.687559.n2.nabble.com/Error-in-candle-during-build-td7385947.html](http://windows-installer-xml-wix-toolset.687559.n2.nabble.com/Error-in-candle-during-build-td7385947.html)。在解压缩二进制文件之前，右键单击 zip 文件，选择属性并从第一个选项卡中选择 Unblock。然后你像往常一样解压缩它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T19:45:37.553

根据您提供的[页面](http://wix.sourceforge.net/manual-wix3/daily_builds.htm)，在代码行中输入的路径将帮助 MSBuild 脚本识别 WIX 二进制文件。

```
<PropertyGroup>
        <WixToolPath>$(SourceCodeControlRoot)\wix\3.6.3220.0\</WixToolPath>
        <WixTargetsPath>$(WixToolPath)Wix.targets</WixTargetsPath>
        <WixTasksPath>$(WixToolPath)wixtasks.dll</WixTasksPath>
</PropertyGroup> 
```

这里的重要引述如下：

> WixTargetsPath 属性值必须与使用它的 .wixproj 项目文件相关。WixTasksPath 属性在 wix.targets 中用于加载 WixTasks.dll

应根据解压缩文件的文件夹正确指定路径。否则有可能发生此错误。然后，该项目也将从 VS2010 运行良好，因为这是从 WIX 的安装位置引用 WIX 二进制文件。但是，MSBuild 将引用您在上述代码行中提供的值。

那么，您能否提供您为`WixToolPath`和提供`WixTargetsPath`的值`WixTasksPath`。以及解压缩**wix36-binaries.zip**或**wix37-binaries.zip**的路径。

这些信息可能有助于解决这个问题，因此我也会更正这个答案。

# c++ - 在 Visual Studio 10 项目中同时使用 /YC 和 /MP

> ID：14783374
> 
> 赞同：6
> 
> 时间：2013-02-09T00:07:32.130
> 
> 标签：c++, visual-studio-2010, visual-studio, winapi, precompiled-headers

我试图绕过 /YC 和 /MP 互斥的限制。我想利用预编译的头文件和多进程编译。

到目前为止，我的回答是创建 2 个项目而不是 1 个。第一个是 pch 生成库，仅包含 stdafx.h 和 stdafx.cpp。它生成 pch 文件，并在 stdafx.cpp 上设置了 /YC

该库成功生成pch文件！作为旁注，pch 库项目还指定了 /YU 指向其 stdafx.h 和 /Fp 引用输出 pch 文件。

我的第二个项目是我的主要可执行文件。它指定了 /MP，但没有为任何文件指定 /YC，并且不包含 stdafx.h 或 stdafx.cpp。相反，我将项目的 /YU 设置为 pch 库的 stdafx.h，将 /Fp 设置为 pch 库生成的 pch。然后我将 pch 库设置为 exe 项目的依赖项。我还在 exe 项目上设置了 /FI 以强制将 pch 库中的 stdafx.h 包含在每个编译单元中。

我的问题是，虽然 pch 库确实生成了 pch 文件并且 exe 项目似乎确实正确引用了生成的 pch 文件，但只要 exe 项目开始构建（在一些与 pch 无关的预构建步骤之后），它删除了 pch 库生成的 pch。我想这是因为它认为，指定了/Fp，即使没有指定/YC，项目也会生成该文件。

我在这里做错了吗？我是不是少了一步。有没有办法阻止 exe 项目在开始构建之前删除我的 pch 文件？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-05T05:52:36.627

试试这个：[如果我使用 /Yc，Visual C++ 是否检查它是否需要重新生成它的 pch](https://stackoverflow.com/questions/12121700/does-visual-c-check-if-it-needs-to-re-generate-its-pch-if-i-use-yc)

您基本上为 stdafx.cpp 设置 /Yc，为所有其他 *.cpp 文件设置 /Yu + /MP。

要为每个文件单独设置标志，请右键单击解决方案资源管理器上的 cpp 文件并选择属性。

# javascript - 多次快速单击复选框按钮无法正常工作

> ID：14783375
> 
> 赞同：3
> 
> 时间：2013-02-09T00:08:15.253
> 
> 标签：javascript, jquery, html, css

我在这里有一个 jsfiddle：http: [//jsfiddle.net/zAFND/616](http://jsfiddle.net/zAFND/616)

现在，如果您在 IE（我使用 IE9）和 firefox 中打开 fiddle，如果您双击复选框按钮，它会打开它但不会关闭它。但是如果你在opera、safarai和chrome中打开它，双击或者快速连续点击就可以了。

我的问题是如何让快速连续点击在 Firefox 和 IE9 中正常工作？

代码：

HTML：

```
<div id="ck-button"><label>
<input type="checkbox" name="options[]" id="optionA" value="A" /><span>A</span></label>
</div> 
```

CSS：

```
#ck-button {
    margin:8px;
    background-color:#EFEFEF;
    border:1px solid #D0D0D0;
    overflow:auto;
    float:left;
    position: relative;
}

#ck-button label {
    float:left;
    width:4.0em;
    cursor:pointer;
}

#ck-button label span {
    text-align:center;
    padding:3px 0px;
    display:block;
}

#ck-button label input {
    position:absolute;
    top:-20px;
}

#ck-button input:checked + span {
    background-color:green;
    color:white;
} 
```

jQuery/javascript：

```
 $(document).ready(function(){
            $("body").css("-webkit-user-select","none");
            $("body").css("-moz-user-select","none");
            $("body").css("-ms-user-select","none");
            $("body").css("-o-user-select","none");
            $("body").css("user-select","none");
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:37:18.750

这是 Firefox 中的一个错误。请参阅[错误 608180 - 双击/快速单击复选框标签无法按预期工作](https://bugzilla.mozilla.org/show_bug.cgi?id=608180)

由于历史原因（但在最近的版本中已修复），IE 有一个错误的事件模型，它会跳过第二个事件`mousedown`和`click`双击事件。[请参阅错误 263 - 当心 IE 中的 DoubleClick](http://webbugtrack.blogspot.com.br/2008/01/bug-263-beware-of-doubleclick-in-ie.html)。

我制作了一个[插件](https://github.com/UltCombo/UltButtons/)，修复了 jQuery UI 按钮小部件中的一些错误，并在不久前解决了 Firefox 错误，应该不难适应您的非 jQuery UI 按钮。

提取了重要部分并将其改编为 s 内的嵌套复选框`label`：

```
(function () {
    var mdtarg, //last label mousedown target
        mdchecked, //checked property when mousedown fired
        fixedLabelSelector = '.fixedLabelCheckbox'; //edit as you see fit
    $(document).on('mousedown', fixedLabelSelector, function (e) {
        //only left clicks will toggle the label
        if (e.which !== 1) return;
        mdtarg = this;
        mdchecked = this.control ? this.control.checked : $(this).find('input')[0].checked;
        //reset mdtarg after mouseup finishes bubbling; prevents bugs with
        //incorrect mousedown-mouseup sequences e.g.
        //down IN label, up OUT, down OUT, up IN
        $(document).one('mouseup', function () {
            mdtarg = null;
        });
    }).on('mouseup', fixedLabelSelector, function (e) {
        if (e.which !== 1) return;
        if (mdtarg === this) {
            var ch = this.control || $(this).find('input')[0];
            //the click event is supposed to fire after the mouseup so
            //we wait until mouseup and click finish bubbling and check if it
            //had the desired effect
            setTimeout(function () {
                if (mdchecked === ch.checked) {
                    //else patch it manually
                    ch.checked = !ch.checked;
                    $(ch).change();
                }
            }, 0);
        }
    });
}()); 
```

[**Fiddle**](http://jsfiddle.net/zAFND/623/)在 Firefox 中测试。

您必须将该`fixedLabelCheckbox`类添加到包含您希望使用上面的代码修复的复选框的所有标签中。

无论您将脚本放在哪里，它都会起作用，并且只要标签具有相应的委托类/选择器，它还可以修复动态添加的复选框。

请注意，如果您使用其他库，这可能不会触发绑定在 jQuery 之外的更改处理程序。

如果你不想在你的标记中添加额外的类，你可以使用这个版本（更多的代码和更少的性能）：

```
(function ($) {
    function getControl(lbl) { //fallback for non-HTML5 browsers if necessary
        return lbl.control || (lbl.htmlFor ? $('input[id="'+lbl.htmlFor+'"]')[0] : $(lbl).find('input')[0]);
    }
    var mdtarg, //last label mousedown target
        mdchecked; //checked property when mousedown fired
    $(document).on('mousedown', 'label', function (e) {
        //only left clicks will toggle the label
        if (e.which !== 1) return;
        var ch = getControl(this);
        if (!ch || ch.type !== 'checkbox') return;
        mdtarg = this;
        mdchecked = ch.checked;
        //reset mdtarg after mouseup finishes bubbling; prevents bugs with
        //incorrect mousedown-mouseup sequences e.g.
        //down IN label, up OUT, down OUT, up IN
        $(document).one('mouseup', function () {
            mdtarg = null;
        });
    }).on('mouseup', 'label', function (e) {
        if (e.which !== 1) return;
        if (mdtarg === this) {
            var ch = getControl(this);
            //the click event is supposed to fire after the mouseup so
            //we wait until mouseup and click finish bubbling and check if it
            //had the desired effect
            setTimeout(function () {
                if (mdchecked === ch.checked) {
                    //else patch it manually
                    ch.checked = !ch.checked;
                    $(ch).change();
                }
            }, 0);
        }
    });
}(jQuery)); 
```

[**小提琴**](http://jsfiddle.net/zAFND/627/)

正如您从上面的代码中看到的那样，此版本应该与标签的`for`属性以及标签内的嵌套输入一起使用，而无需添加任何额外的标记。

* * *

关于禁用选择：您可以将`user-select`问题中的注释放入 CSS 中，或者，如果浏览器不支持，`user-select`也可以[将此答案](https://stackoverflow.com/a/2700029/1331430)应用于您希望禁用选择的所有标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:34:47.500

您可以添加浏览器检测，然后，如果是 IE 或 Firefox，则通过 JS 添加[`ondblclick`事件](http://www.quirksmode.org/js/events_mouse.html)以反转复选框。

您不能无条件地设置它，因为有些浏览器（Safari、Chrome）传输两个`click`s 和 a `dblclick`，而其他浏览器（IE、Firefox）只传输一个`click`和一个`dblclick`。在前者上，这两个`click`事件将反转场两次。在后者中，只有一个`click`事件触发，因此场仅反转一次；为了缓解这种情况，您需要`dblclick`反转该字段，以便两次单击将其反转偶数次。

希望这可以帮助！！

# ios - RedPark 无法从串口读取数据：UIViewController 与 UINavigationController

> ID：14783376
> 
> 赞同：1
> 
> 时间：2013-02-09T00:08:18.950
> 
> 标签：ios, objective-c, serial-port, external-accessory

我正在使用 Redpark Serial SDK 1.4 r270 来帮助 iphone 的 i/o 功能。我目前遇到的问题之一是读取使用给出的数据

```
- (void) readBytesAvailable:(UInt32)numBytes { 
```

这是我的错误。

```
Feb  8 15:27:50  iapd[897] <Warning>: ERROR - /SourceCache/iapd/iapd-1065.23/iapd/IAPSession.mm:-[IAPSessionBasic _sessionBufferToAppHasSpaceAvailable] - 823 session=0x1 for connectionID=0x1e12ea00 failed to write bytes, errno = 32
Feb  8 15:27:50  iOS[7428] <Warning>: ERROR - /SourceCache/ExternalAccessory/ExternalAccessory-213/EASession.m:-[EASession dealloc] - 137 unable to close session for _accessory=0x20047eb0 and sessionID=65536
Feb  8 15:27:50  iOS[7428] <Warning>: ERROR - /SourceCache/ExternalAccessory/ExternalAccessory-213/EAOutputStream.m:-[EAOutputStream write:maxLength:] - 212 failed to write 229 bytes (wrote -1) with error 9
Feb  8 15:27:50  iOS[7428] <Warning>: ERROR - /SourceCache/ExternalAccessory/ExternalAccessory-213/EAInputStream.m:-[EAInputStream _readInputFromAccThread] - 357 error waiting for read data, errno = 9 
```

这与单视图应用程序完美配合。

假设有一个 UINavigationController 具有视图 A 和视图 B，其中 A => B 当单击按钮时。视图 B 正在使用 RscMgr 线程，其中所有的魔法都恰好从串行端口读取。在视图 B 的 UINavigationController 的第一个实例中，如果我们停留在此视图上，它可以正常工作。我们能够断开连接，连接端口，我们将继续流式传输数据。

但是，如果我返回查看 A，然后返回查看 B。一切都将陷入困境。我无法再从此函数中读取数据，并且在控制台中发现 (MULTIPLE) 错误。有没有人有充分的理由说明为什么会发生这种情况以及我们如何解决它？我知道我们已经将 UIViewController 从堆栈中弹出，一切都重置了，并且再次创建了 RscMgr 线程，但没有查看任何内容。我不确定如何使用 SDK 清除缓冲区，因为它没有提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-30T16:28:00.450

**这比上面的解决方案更简单。在不同的 .m 文件中定义您的函数，并从 AppDelegate 而不是 ViewController 启动。**

我以前写的应用程序有这个问题。另一种选择是在 App Delegate 中声明 RscMgr，然后在给定的 ViewController 中对其进行初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:36:44.980

您声明的范围

```
- (void) readBytesAvailable:(UInt32)numBytes { 
```

很可能是问题所在。我会在您打开和关闭 B 时不会消失的地方声明这一点。例如在 UINavigationController 或 AppDelegate 上。

更好的是，创建一个新的单例类来管理 RedPark 的接口，并根据需要从应用程序的其余部分查询它。

# android - 视口根本不起作用

> ID：14783377
> 
> 赞同：0
> 
> 时间：2013-02-09T00:08:18.620
> 
> 标签：android, iphone, viewport

我的视口标签有一个非常奇怪的问题，这让我抓狂..

我的例子基于这篇文章：[http ://dev.opera.com/articles/view/an-introduction-to-meta-viewport-and-viewport/](http://dev.opera.com/articles/view/an-introduction-to-meta-viewport-and-viewport/)

代码：

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=320">
</head>
<body>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean nec tortor turpis, id pharetra purus. Pellentesque venenatis tortor vitae metus varius placerat. Donec eu dui id turpis egestas lobortis.
</body>
</html> 
```

现在，我正在 iPhone 和 Android 上观看此页面。我应该在两部手机上看到文本，在纵向模式下，第一行以 consectetur 结尾，在横向模式下，第一行也以 consectetur 结尾，但文本更大。

我看到的是这样的：

[http://imgur.com/a/GkCE5](http://imgur.com/a/GkCE5)

第一张图片 (Xn5r7ef)，iPhone 纵向 第二张图片 (mYNvAGR)，iPhone 横向 第三张图片 (7wqmCAX)，Android 纵向第四张图片 (sFuyxlc)，Android 横向

可以看出，android 不会调整文本大小，它只是保持文本大小相同，并使用额外的宽度来显示更多文本。从开发歌剧链接我了解到这不应该发生。

如果我使用 width=device-width，两部手机都会显示与 imgur 照片完全相同的文本，这意味着在这种情况下，iPhone 无法正确显示文本。

我在这里做错了什么？难道我做错了什么？我怎样才能让它正常工作？

显然，我的真实项目要大得多，但我有类似的元视口地狱问题......问题，页面似乎放大了太多，在每次页面加载时，不同的页面（具有完全相同的视口元标记）有不同飞涨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T17:34:42.817

令我惊讶的是，我可以通过使用[http://andreasbovens.github.com上的示例来确认所描述的 Android (](http://andreasbovens.github.com/understanding-viewport/) [http://imgur.com/nPiK8Nc](http://imgur.com/nPiK8Nc) ) 和 iPhone 行为 ( [http://imgur.com/pQ8OUGP )](http://imgur.com/pQ8OUGP) [/理解视口/](http://andreasbovens.github.com/understanding-viewport/)

这些问题对我来说是新的，而且肯定是最近在 Android 浏览器和移动 Safari 中的回归...... Chrome 和 Opera Mobile 的行为应该如此。

确实非常烦人的错误：您可以使用`initial-scale=1`. 我没有解决Android问题的方法。调查。

# jquery - jPlayer 更改播放列表

> ID：14783378
> 
> 赞同：0
> 
> 时间：2013-02-09T00:08:27.593
> 
> 标签：jquery, jplayer

我正在用 jPlayer 做一个应用程序。我的想法是当单选按钮单击播放列表时会发生变化。我做到了，但只有在我第一次点击时才有效。

然后，我发出警报以查看脚本何时出错并在`jQuery_min("#jquery_jplayer").jPlayer`.

```
jQuery_min("#jquery_jplayer").jPlayer({
        ready: function() {
            displayPlayList();
            playListInit(false); // Parameter is a boolean for autoplay.
        },
        oggSupport: false
    })
    .jPlayer("onProgressChange", function(loadPercent, playedPercentRelative, playedPercentAbsolute, playedTime, totalTime) {
        jpPlayTime.text(jQuery_min.jPlayer.convertTime(playedTime));
        jpTotalTime.text(jQuery_min.jPlayer.convertTime(totalTime));
    })
    .jPlayer("onSoundComplete", function() {
        playListNext();
    }); 
```

脚本第一次运行时，它会读取前一个函数，否则不会。

我在函数之前尝试过这个`jQuery_min("#jquery_jplayer").jPlayer("clearMedia");`，`jQuery_min("#jquery_jplayer").jPlayer("destroy");` 但没有运气。

谢谢 ：）

对不起我的英语，我正在学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T01:51:11.093

使用播放列表插件并使用 setPlaylist 方法在播放列表之间切换。更多信息可以在 jPlayer 网站上的[播放列表插件演示页面上找到。](http://jplayer.org/latest/demo-02-jPlayerPlaylist/)

# c# - 如果我为 Office 2007 编写加载项，它将适用于 2010、2013 年吗？

> ID：14783379
> 
> 赞同：14
> 
> 时间：2013-02-09T00:08:29.400
> 
> 标签：c#, add-in, office-2007, office-2010, office-2013

我目前正在重写一些为 Office 2003 编写的 VBA 宏。我想知道我是否为 2007 年编写了 C# 插件，它是否适用于 2010 年甚至 2013 年。或者我是否编写了它们如果它们也适用于 2007 年和 2013 年，则适用于 2010 年。我目前可以访问 2007，但如果需要，我可以访问 2010，还没有 2013。

那么，基本上，office的版本对插件的影响有多大？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-09T09:35:37.297

如果您使用**Visual Studio Tools for Office 2010 (VSTO 4.0)**，那么它将兼容 .`Office 2007 ,Office 2010 and with Office 2013`如果您使用上述以外的早期版本，那么您只能将其用于特定的 Office 版本。例如，`VSTO 3.0`仅支持`office 2003 and 2007`如下表所示。

有关详细信息，请查看[**Visual Studio Tools for Office**](http://en.wikipedia.org/wiki/VSTO)和[**Visual Studio 2010 Tools for Office Runtime**](https://www.microsoft.com/en-za/download/details.aspx?id=44074)

兼容性显示如下：

![在此处输入图像描述](../Images/11fbecdf07bf13e6df1a99064029a0a0.png)

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T11:21:22.173

您可以查看[Netoffice](http://netoffice.codeplex.com)，它是 MS Office 的包装器，使您能够为所有受支持的 MS Office 版本创建插件。你不需要 VSTO，你可以在你自己的代码中检查你的外接程序在哪个版本的 Office 中运行。

# sockets - 在 Web 应用程序中接收数据并推送到客户端浏览器的套接字

> ID：14783380
> 
> 赞同：0
> 
> 时间：2013-02-09T00:08:30.227
> 
> 标签：sockets, jakarta-ee, web-applications, server-sent-events, server-push

我需要连接一个 SocketServer，接收数据，然后将其推送回客户端（网络浏览器）。

我只需要确认方法。我将创建一个 Socket 连接，它将在 ServletContextListener 中继续侦听消息。然后消息将存储在 ServletContext 中，以便可以将其推送回客户端浏览器。

1.  我应该在 ServletContextLister 中创建套接字连接吗？或者有没有其他方法可以监听套接字？

2.  为了将数据推回客户端，我不想进行双向通信。那么我应该选择 SSE 还是 Html5 WebSockets？任何支持 SSE 或 WebSocket 以及客户端库的 java 框架？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T14:20:37.263

我实现了这个并且它工作正常。对于服务器，我选择了 Jetty 8 并使用了 jetty 的 WebSocket。

简而言之，我是如何实现的，为了收听来自 SocketServer 的消息，我实现了 ServletContextListener ，它初始化 Socket ，它将使用这些消息。

当用户点击 url 时，我将 WebSocket 连接添加到 Collection 并将该集合存储为 ServletContext 属性。然后，这个 WebSocket 列表由 Socket 访问，它在消息到达时迭代并发送消息。然后将消息推送回所有连接的客户端。

# ruby - Ruby 数组：添加数字的方法

> ID：14783381
> 
> 赞同：0
> 
> 时间：2013-02-09T00:08:31.773
> 
> 标签：ruby, arrays

我正在尝试编写将采用数组并返回数组的 SUM 的代码。首先，这是将数字放入数组的正确方法吗？根据错误，这似乎有问题。

```
 def total(num)
       x = []
       x << num
       puts x.inject(0){|a,b|a+b}

    end 
```

看起来这里有一些问题。首先，当我使用以下方法调用该方法时出现此错误`sum([3,2,41,2])`：

```
`total': wrong number of arguments (5 for 1) (ArgumentError) from calculator.rb:11 
```

我还记得收到一个错误：`cant't covert fixnum into array`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:30:41.210

你的`inject`块是正确的。出现参数错误是因为您将方法定义为采用单个参数，但在您的示例中，您使用四个参数调用它。如果你想使用可变数量的参数，你可以使用 splat 操作符`*`，它可以做各种各样的事情——在这种情况下，它将所有未定义的参数收集到一个数组中：

```
def total(*nums)
  nums.inject(0) {|a,b| a + b }
end

total(3,2,41,2) #=> 48 
```

您可以使用带有 的符号进一步简化此操作`inject`：

```
nums.inject(0, :+) #=> 48 
```

这通过将符号表示的方法发送到累加器来工作，使用数组的每个成员作为参数（相当于将块定义为`{|a, b| a.send(:+, b) }`）。

实际上在这种情况下，您不需要定义初始值。Inject 有第三种形式，它将简单地使用数组的第一个成员作为初始值并将其他成员相加：

```
nums.inject(:+) 
```

# python - 将 python 列表操作为字符串

> ID：14783383
> 
> 赞同：1
> 
> 时间：2013-02-09T00:08:43.757
> 
> 标签：python

我问了一个关于如何服用的问题`A_board=[['0', '0'],['1', '1']]`。我想把这个嵌套列表分开并得到一个`result`，如果我调用`print result`它，它会显示：`< 0 0 > < 1 1 >.`

有人告诉我使用`' '.join('< {} {} >'.format(*items) for items in A_board)`，但这仅适用于两个元组，它不灵活。如果我有一个`[[0],[0],[0]]`并且想把它变成`< 0 > < 0 > < 0 >`怎么办？现在，`{}`每次`len(A_board)`增加时我都必须输入额外的内容。

前任。如果长度为 2 ，`A_board`那么将有两个`{}`

如果`A_board`长度为 3，那么将有 3`{}`个

有什么更好的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T00:11:07.513

你可以做另一个加入：

```
' '.join('< {} >'.format(' '.join(items)) for items in A_board) 
```

这将适用于任何长度`items`。

# python - numpy 矩阵技巧 - 逆时间矩阵的总和

> ID：14783386
> 
> 赞同：12
> 
> 时间：2013-02-09T00:09:05.487
> 
> 标签：python, numpy, scipy, linear-algebra

我正在尝试执行以下操作，并重复直到收敛：

![](../Images/03ed78f1c5334483080f5a128fa29cb3.png)

其中每个 X [i]是`n x p`，并且`r`它们在一个`r x n x p`名为 的数组中`samples`。`U`是`n x n`，`V`是`p x p`。（我得到了[矩阵正态分布](http://en.wikipedia.org/wiki/Matrix_normal_distribution)的 MLE 。）尺寸都可能很大；我期待的事情至少在 `r = 200`, `n = 1000`, `p = 1000`.

我当前的代码确实

```
V = np.einsum('aji,jk,akl->il', samples, np.linalg.inv(U) / (r*n), samples)
U = np.einsum('aij,jk,alk->il', samples, np.linalg.inv(V) / (r*p), samples) 
```

这行得通，但当然你永远不应该真正找到逆并乘以它。如果我能以某种方式利用 U 和 V 是对称且正定的这一事实，那也很好。我希望能够在迭代中计算 U 和 V 的 Cholesky 因子，但由于总和，我不知道该怎么做。

我可以通过做类似的事情来避免相反的情况

```
V = sum(np.dot(x.T, scipy.linalg.solve(A, x)) for x in samples) 
```

（或类似利用 psd 的东西），但是有一个 Python 循环，这让 numpy 仙女哭了。

我还可以想象`samples`以这样一种方式进行重塑，即我可以获得一个`A^-1 x`using `solve`for each的数组，`x`而无需执行 Python 循环，但这会产生一个很大的辅助数组，这会浪费内存。

是否有一些线性代数或 numpy 技巧可以让我充分利用这三者：没有显式逆，没有 Python 循环，没有大的辅助数组？或者我最好的选择是用一种更快的语言实现一个 Python 循环并调用它？（直接将其移植到 Cython 可能会有所帮助，但仍会涉及大量 Python 方法调用；但直接制作相关的 blas/lapack 例程可能不会太麻烦而没有太多麻烦。）

（事实证明，我实际上并不需要矩阵`U`，`V`最后 - 只是它们的行列式，或者实际上只是他们的 Kronecker 乘积的行列式。因此，如果有人对如何减少工作并仍然获得决定因素，那将不胜感激。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T01:38:32.033

直到有人想出一个更有灵感的答案，如果我是你，我会让仙女哭泣……

```
r, n, p = 200, 400, 400

X = np.random.rand(r, n, p)
U = np.random.rand(n, n)

In [2]: %timeit np.sum(np.dot(x.T, np.linalg.solve(U, x)) for x in X)
1 loops, best of 3: 9.43 s per loop

In [3]: %timeit np.dot(X[0].T, np.linalg.solve(U, X[0]))
10 loops, best of 3: 45.2 ms per loop 
```

因此，拥有一个 python 循环，并且必须将所有结果汇总在一起，所花费的时间是 390 毫秒，是解决必须解决的 200 个系统中的每一个系统所需时间的 200 倍多。如果循环和求和是免费的，您将获得不到 5% 的改进。也可能有一些调用 python 函数的开销，但对于求解方程的实际时间，它可能仍然可以忽略不计，无论你用什么语言编写它。

# php - 解析xml并在php中正确使用fwrite

> ID：14783388
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:09:09.727
> 
> 标签：php, simplexml, fwrite

我的问题是我不知道如何使用`fwrite`. 我使用 simplexml 解析 xml，然后，虽然`echo`工作正常，但我无法在文件中写入相同的结果。在下面的示例中，我从 xml 提要中回显 5 个项目，但是当我将其写入文件时，它只写入第 5 个项目。谁能告诉我有什么问题？

```
$file = simplexml_load_file($url); {
$c = 0;
foreach($file->channel->item as $post) {
if($c == 5){
break;
}

$headline = (string) $post->title;

echo $headline;

$fp=fopen('myfile.htm', "w+");  
fwrite($fp, $headline."<br />");
fclose($fp);
        $c++;
        }
} 
```

**编辑：**第二次尝试。我使用了一个`while`循环，而不是`if`，但我只设法写了**第 5**项的**5**次。我需要（而不是）每次更新文件时都覆盖文件，而不是每次都添加内容：**`w+``a+`**

 **```
$file = simplexml_load_file($url); {

foreach($file->channel->item as $post) {

$fp=fopen('myfile.htm', "w+");
$c = 1;
while ($c <= 5){
    $headline = (string) $post->title;
    fwrite($fp, "$headline<br />");
    $c++;
}
fclose($fp);
}
include 'myfile.htm';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:16:39.550

您需要打开文件进行附加：

改变：

```
$fp=fopen('myfile.htm', "w+"); 
```

至：

```
$fp=fopen('myfile.htm', "a"); 
```

而且，为了提高效率，您应该在开始循环之前打开文件并在循环后关闭它。

fopen 中的“w+”打开文件“进行读写；将文件指针放在文件的开头并将文件截断为零长度。如果文件不存在，请尝试创建它。”

每当您使用 w+ 命令打开文件时，它将从文件开头开始写入并删除文件中已有的所有数据。如果您仍然想使用“w+”，您应该将 fopen 命令放在循环之前（以及循环之后的 fclose）以按照您想要的方式编写。

见：[http ://www.php.net/manual/en/function.fopen.php](http://www.php.net/manual/en/function.fopen.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:16:53.067

您可以在循环外打开文件，或者如果必须在循环内打开文件，请使用`a`模式打开。

```
$fp = fopen('myfile.htm', 'w+');
foreach(...) {
    //write here
}  
fclose($fp); 
```

或者

```
foreach(...) {
    $fp = fopen('myfile.htm', 'a');
    //write here
    fclose($fp);
} 
```

该`w+`模式所做的是以写入模式打开文件，并指向文件的开头，这导致只有最后一次迭代被写入文件。所有以前的迭代都被覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:17:11.287

而不是以“w+”模式打开文件，您需要使用“a”模式，并且您应该在循环之前打开文件，因为它与您每次打开的文件相同，并在循环之后关闭文件。

```
$fp=fopen('myfile.htm', "a+");  

//the loop starts here

//your code

// the loop ends here.

fclose($fp); 
```**

# c++ - 使用 while(inf.good) 读取整数文件

> ID：14783390
> 
> 赞同：1
> 
> 时间：2013-02-09T00:09:14.437
> 
> 标签：c++, io

我正在尝试打开一个整数文件，该文件将被传递到一个包含数组的结构中，但是当我尝试这样做时，我在输出中得到一个加零，当我在我的程序中添加更多时，核心只是被转储了，所以我不确定我做错了什么以及如何解决它。

```
#include <iostream>
#include <string>
#include <iomanip>
#include <fstream>
#include <cmath>
#include <cstdlib>
using namespace std;

struct Hand
{
  int handCards[52];
  int totalCards;
};

struct Card
{
  char rank;
  char suit;
};

void OpenFile (ifstream&, string&);
void ReadFile (ifstream&, Hand&);
void ProcessRank (Hand&, int CardRank[]);
void ProcessSuit (Hand&, int CardSuit[]);
char GetRank (int);
char GetSuit (int);
void PrintCard (Card);
Card ConvertRaw (Hand);
void PrintHand (Card, Hand);
int main()
{
  ifstream inf;
  string filename;
  Hand theHand;
  Card aCard;
  int CardRank[13];
  int CardSuit[4];

  OpenFile(inf, filename);
  ReadFile(inf, theHand);

}

void OpenFile (ifstream &inf, string &filename)
{
  cout<<"What is the name of the file?" <<endl;
  cin>>filename;

  inf.open(filename.c_str());

  if (inf.fail())
    {
      cout<<"Sorry, that file doesn't exist" <<endl;
      exit(1);
    }
  else
    cout<<"Success!" <<endl <<endl;
}

void ReadFile (ifstream &inf, Hand &theHand)
{
  theHand.totalCards=0;
  int i=0;
  while(inf.good())
    {

      inf>>theHand.handCards[i];
      theHand.totalCards++;
      cout<<theHand.handCards[i];
      i++;
    }
} 
```

该文件是 123456，但随后我得到 1234560> 作为输出，当我添加其余代码时，核心转储出现了。我不确定传递是否有问题，或者我的变量是否以某种方式关闭，但如果有人可以帮助我，这将意味着很多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:13:23.440

通常你想检查你的阅读尝试是否成功：

```
while(inf>>theHand.handCards[i])
{
  theHand.totalCards++;
  cout<<theHand.handCards[i];
  i++;
} 
```

当然，您通常也应该使用`std::vector`而不是数组，但我想我们可以把它留给另一个问题。

# android - TabHost 中的 OnClick 选项卡按钮

> ID：14783394
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:10:03.877
> 
> 标签：android, tabs, onclick, android-tabhost, title

我非常需要允许用户在长按可更改的选项卡主机（确切地说是选项卡名称，而不是选项卡主体内部的某个位置）后执行某些操作。经过大量搜索和我自己的试验，我找到了一个可行的解决方案，以及正常的 onClick。

我还需要存储当前单击的选项卡的选项卡标题（可能在许多情况下需要它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:10:03.877

在我们的 TabHost 已经创建之后，我们应该这样做：

```
 // TabHost ourTabHost;
    // ... Create your tab host ...
    // Now on click listener for all of tabs

    TabWidget tw = ourTabHost.getTabWidget();
    int childCount = tw.getChildCount();
    for (int i = 0; i < childCount; i++) {
        View child = (View) tw.getChildAt(i);
        child.setOnLongClickListener(this);
    } 
```

但是有一件奇怪的事情，尽管 onClicks 有效，但现在我们无法使用“child.getTag()”获取选项卡名称。它会给我们NULL（我不确切知道。为什么？）。所以最终的工作，但不是太漂亮的解决方案将是：

```
// Your onCreate
// ...

TabHost ourTabHost;

// During creating tabhost
SparseArray<String> TabsIdsTitles = new SparseArray<String>();
int tab_id = 0;
String tabTitle;

/* I have loop here */
tabTitle = whatever_you_need();
TabsIdsTitlte.put(tab_id++, tabTitle);
TabSpec nextTab = ourTabHost.newTabSpec(tabTitle);

// Tab content here

nextTab.setIndicator(tabTitle);
ourTabHost.addTab(nextTab);
/* End of my loop */

// Now on click listener for all of tabs
TabWidget tw = ourTabHost.getTabWidget();
int childCount = tw.getChildCount();
for (int i = 0; i < childCount; i++) {
    View child = (View) tw.getChildAt(i);
    child.setOnLongClickListener(new longClick(PlansForTabs.get(i)) );
}

// Long click listener tabs in TabHost, with their names (tags)
private class longClick implements View.OnLongClickListener {
    String title;
    public longClick(String title) {
        this.title = title;
    }

    @Override
    public boolean onLongClick(View v) {
        // Finally we can do what we want
        return false;
    }
} 
```

# python - Django 静态文件相对引用 Amazon S3

> ID：14783398
> 
> 赞同：0
> 
> 时间：2013-02-09T00:10:36.167
> 
> 标签：python, css, django, amazon-s3

我正在尝试获取背景图像以显示在 Amazon S3 上托管静态文件。我的 base.html 中的以下代码运行良好，并找到了位于我的 S3 存储桶中的 CSS 文件：

```
<link rel="stylesheet" href="{{ STATIC_URL }}css/stylesheet.css" type="text/css" /> 
```

我的问题是，在我的 CSS 文件中，以下行似乎找不到图像：

```
 background-image: url("{{ STATIC_URL }}img/GreenBackground.jpg") no-repeat center center fixed; 
```

我的亚马逊存储桶看起来像

```
/newdjangoapp
--/admin
--/css
----/stylesheet.css
--/img
----/GreenBackground.jpg 
```

我尝试在 img 和 css 目录周围添加一个额外的“静态”目录并在文件路径中更新它，我尝试了以下代码：

```
 background-image: url("{{ STATIC_URL }}../img/GreenBackground.jpg") no-repeat center center fixed; 
```

乃至

```
 background-image: url("../img/GreenBackground.jpg") no-repeat center center fixed; 
```

我的静态 URL 设置如下：

```
STATIC_URL = 'http://s3.amazonaws.com/' + AWS_STORAGE_BUCKET_NAME +'/' 
```

和静态目录...

```
STATIC_ROOT = os.path.join(PROJECT_DIR,'')

STATICFILES_DIRS = (
        os.path.join(PROJECT_DIR, 'static/'),
) 
```

任何有关解决此问题的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T09:05:49.237

也许您应该以不同的方式引用它，因为您的 css 不知道 {{ STATIC_URL }}。查看您如何在 django settings.py 文件中定义静态（在我的情况下，我有它“/static/”），然后像在 css 文件中那样引用它。而不是 {{STATIC_URL}}，使您的引用与您相同在您的 settings.py 文件中创建（在我的情况下是“/static/css ...”）

# c++ - 将字符串从一个 C++ 程序发送到另一个程序并等待响应

> ID：14783399
> 
> 赞同：0
> 
> 时间：2013-02-09T00:10:41.630
> 
> 标签：c++, visual-studio-2010

我们将在 Visual Studio 2010 中同时运行两个 C++ win32 控制台程序。我们希望能够将消息（字符串）从一个发送到另一个。程序 1 向程序 2 发送消息，并等待程序 2 发回消息。一旦程序 2 发送了回复，它现在就等待来自程序 1 的下一条消息而不退出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:50:13.563

在同一台 PC 上运行的多个应用程序之间交换数据的方式有很多种。它们属于通用术语“进程间通信”。使用您最熟悉的任何 IPC 机制 - 文件、注册表、套接字、命名管道、邮件槽、ActiveX、远程过程调用、共享内存或 WM_COPYDATA 窗口消息。它们都有其优点和缺点，因此您需要自己决定哪一种最适合您的实际需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T06:57:11.750

See here for example and explanation on a simple program to send data between server and client using sockets: [Getting Started with Winsock (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms738545%28v=vs.85%29.aspx)

This is one of the methods to do inter-process communication. For other inter-process communication methods in windows see here: [Interprocess Communications (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365574%28v=vs.85%29.aspx)

# delphi - Delphi 子类化可视化组件并使用它

> ID：14783400
> 
> 赞同：7
> 
> 时间：2013-02-09T00:10:44.967
> 
> 标签：delphi, overriding, subclass

我想用另一个名为 MyTToolBar 的类来继承 TToolBar，以便我可以覆盖一个方法。我是 Delphi 的新手，但是在尝试了各种方法两个小时后，我无法使用 MyTToolBar 代替 TToolBar。我不能成为第一个想要覆盖可视组件类上的方法的人。

我更多来自 Xcode 背景，其中子类化视觉组件很容易。您创建父类（例如，MySuperClass）的子类（例如，MySubclass），然后只需在Xcode 的Interface Builder 视图中分配子类。子类被自动识别和使用。

为什么我似乎不能在 Delphi RAD Studio XE3 中执行此操作？

将 TToolBar 添加到 TForm 后，似乎无法更改类。我尝试通过 Object Inspector 以及 .PAS 源代码文件。如果我更改 .PAS 文件中的类，我会收到一条错误消息，提示工具栏“应为 Vcl.ComCtrls.TToolBar 类型，但声明为 MyTToolbar。更正声明？” 这只是看起来很愚蠢......

哦，我还使用了新组件向导，选择：文件 -> 新建 -> 其他 -> Delphi 项目 -> Delphi 文件 -> 组件。我选择 MyTToolBar 的祖先作为 TToolBar 并告诉它在“示例”调色板页面中注册。但是，它不会出现在“示例”页面中。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-09T00:31:47.617

与您的 XCode 方法最接近的方法是在 Delphi 中使用“interposer”类。基本上，您不会更改 IDE 为标准`TToolBar`用途创建的代码。相反，您声明了一个派生自标准`TToolBar`组件但也被命名的新类，并在声明标准**后**`TToolBar`使其对编译器可见。编译器最后看到的任何类都将是在流式传输 DFM时实例化的实际类类型。**`TToolBar``TToolBar``TForm`**

 **您可以通过以下两种不同方式之一`TToolBar`使编译器在标准类之后看到您的自定义类：`TToolBar`

1.  `TToolBar`在与您的类相同的单元中声明自定义`TForm`类：

    ```
    unit MyForm;

    interface

    uses
      ..., Vcl.ComCtrls, ...;

    type
      TToolBar = class(Vcl.ComCtrls.TToolBar)
        // override what you need...
      end;

      TMyForm = class(TForm)
        ToolBar1: TToolBar; // <-- do not change this!
        ...
      end;

    implementation

    // implement custom TToolBar as needed...

    // normal TForm implementation code as needed ...

    end. 
    ```

2.  您可以`TToolBar`在其自己的单元中声明自定义类，然后在添加单元后将其添加到`TForm`单元的`uses`子句中`ComCtrls`：

    ```
    unit MyToolBar;

    interface

    uses
      ..., Vcl.ComCtrls;

    type
      TToolBar = class(Vcl.ComCtrls.TToolBar)
        // override what you need...
      end;

    implementation

    // implement custom TToolBar as needed...

    end. 
    ```

    .

    ```
    unit MyForm;

    interface

    uses
      ..., Vcl.ComCtrls, ..., MyToolBar;

    type
      TMyForm = class(TForm)
        ToolBar1: TToolBar; // <- do not change this!
        ...
      end;

    implementation

    // normal TForm implementation code as needed ...

    end. 
    ```

这种方法仅适用于每个项目。如果您想`TToolBar`在多个项目中使用您的自定义类，那么您最好将它安装到 IDE 中，就像@KenWhite 描述的那样，并使用它而不是标准的`TToolBar`. 回到命名它`TMyToolBar`（或其他），不要再命名它`TToolBar`，因为它不会用作插入器。确保该包在其项目选项中标记为“运行时和设计时”（创建单独的仅运行时和仅设计时包超出了本讨论的范围）。 `TMyToolBar`将在设计时提供，您可以`TForm`像使用任何其他组件一样放置您的组件。如果不是，那么您没有正确设置它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T00:31:19.853

要更改现有表单上的组件，它实际上必须是 IDE 可以在设计时创建实例的组件。当然，这意味着 IDE 必须首先意识到这一点。

这样做的方法是创建您自己的后代组件，并将其实际安装到设计时包中的 IDE 中。然后，您可以将其放在您的表单上而不是标准版本上，或者通过一些工作将其替换到现有表单上。（不过，您必须先创建版本并安装它。）

`File->New->Package (Delphi)`从 IDE 的菜单开始。像保存任何其他项目一样保存包（例如，`MyComponents.dpk`）。

现在使用`File->New->Other->Delphi Files`，并`Component`在右窗格中双击。向导将`New Component`启动，您可以在其中选择要继承的现有组件（或设计新组件）。

按照向导的步骤操作，您最终将获得组件的基本外壳：

```
unit MyToolBar1;

interface

uses
  System.SysUtils, System.Classes, Vcl.Controls, Vcl.ToolWin, Vcl.ComCtrls;

type
  TMyToolBar = class(TToolBar)
  private
    { Private declarations }
  protected
    { Protected declarations }
  public
    { Public declarations }
  published
    { Published declarations }
  end;

procedure Register;

implementation

procedure Register;
begin
  RegisterComponents('Samples', [TMyToolBar]);
end;

end. 
```

在新后代中实现您想要的任何功能，然后保存文件。

右键单击包中的`Project Manager`（默认情况下在 IDE 中的右上角窗口），然后`Install`从上下文菜单中选择。这将编译和构建包，并自动将其安装在 IDE 中。（我展示的示例将`Samples`根据调用中指示的内容将新组件放在调色板中的页面上`RegisterComponents`。）

完成上述操作后，您可以更改现有表单（**首先备份 .pas 和 .dfm 文件！**）。我将使用`TToolBar`您提到的，以及我在下面的说明中发布的外壳的示例替换。

手动将源代码编辑器中的类名从`TToolBar`更改为`TMyToolBar`.

右键单击表单，然后`View as Text`从上下文菜单中选择。

找到`TToolBar`，并将其从 更改`TToolBar`为`TMyToolBar`。

再次右键单击，然后`View as Form`从上下文菜单中选择。如果您正确地完成了这些步骤，单击工具栏上的 应该会`TMyToolBar`在对象检查器中显示您。如果您没有看到它（或者如果您收到错误消息），那么您做错了；您可以通过右键单击代码编辑器顶部的选项卡并选择来关闭选项卡，`Close tab`然后对有关保存更改的提示回答“否”，然后在必要时从我告诉您首先制作的备份副本中恢复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T00:23:51.747

为您的班级创建一个单元：

```
Unit YourComponent;
interface
uses
 ....
Type
 TYourNewClass=Class(ExistingClass)
   private
   ...
   protected
   ...   
   public
   ...
   published
  end;

  procedure Register;

implementation

.....

procedure Register;
begin
  RegisterComponents('YourPalette', [TYourNewClass]);
end; 
```

创建一个新包（或打开一个自己的现有包）并添加您的单元选择安装在您的 Package.bpl 上。**

# mysql - 使用 MySQL 几何函数时出现 SQL 错误

> ID：14783401
> 
> 赞同：1
> 
> 时间：2013-02-09T00:10:51.753
> 
> 标签：mysql, sqlgeography, sqlgeometry

```
ALTER PROCEDURE dbo.StoredProcedure1    
AS  
DECLARE @Seedid int, @data1 float, @data2 float, @g geometry  

DECLARE member_cursor CURSOR FOR  
SELECT id from test1 ;  

OPEN member_cursor;  

FETCH NEXT FROM member_cursor  
INTO @Seedid ;  
WHILE @@FETCH_STATUS = 0  
BEGIN  
    select @data1 =data1 from test where id=@Seedid  
    select @data2 =data2 from test where id=@Seedid  
    update test1  
       set data4 = geometry::STGeomFromText('POINT (@data1 @data2)', 0)
        where id=@Seedid;  
    -- This is executed as long as the previous fetch succeeds.  
    FETCH NEXT FROM member_cursor  
    INTO @Seedid ;  
END  
RETURN  
CLOSE member_cursor;  
DEALLOCATE member_cursor; 
```

**我收到以下错误：**

> 该语句已终止。
> 在执行用户定义的例程或聚合“几何”期间发生 .NET Framework 错误：
> System.FormatException：24141：输入的位置 13 处应有一个数字。输入有@data1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:02:14.057

经过一番努力，我终于找到了解决这个问题的方法。如果其他人再次遇到此类问题，请发布解决方案。在几何中，当我通过`@data1`and时`@data2`，它的那些变量`@data1`只是不是它的**浮点值**。所以，我们可以做的是：

```
select @data1 =data1 from test1 where id=@Seedid  
select @data2 =data2 from test1 where id=@Seedid  
Set @POINTSTR = 'POINT(' + CAST(@data1 AS varchar(32)) + ' ' + CAST(@data2 AS varchar(32)) + ')';  
update test1  set data4 = geometry::STGeomFromText(@POINTSTR, 4326) where id=@Seedid; 
```

# c# - 将嵌套的 xml 反序列化为 C# 对象

> ID：14783406
> 
> 赞同：7
> 
> 时间：2013-02-09T00:11:35.963
> 
> 标签：c#, xml-serialization

我正在从 http Web 请求中检索 xml 数据并将数据反序列化为对象。

这是一个示例 xml 结构。

```
<users>
    <user>
        <name>...</name>
        <orders>
            <order>
                <number>...</number>
            </order>        
            ...
        </orders>
    </user>
    <user>
        <name>...</name>
        <orders></orders>
    </user>
    ...
</users> 
```

我有四节课

```
public class Users
{
    [XmlElement("user")]
    public User[] UserList { get; set; }
}

public class User
{
    [XmlElement("name")]
    public string Name { get; set; }

    [XmlArray("orders")]
    public Orders OrderList { get; set; }
}

public class Orders
{
    [XmlElement("order")]
    public Order[] Order { get; set; }
}

public class Order
{
    [XmlElement("number")]
    public string Number { get; set; }
} 
```

我觉得三个类就足够了 - 在 User 类中有一个 Order[] 并摆脱“Orders”类。那可能吗？无论我尝试什么都没有用。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-09T00:46:01.303

这应该工作

```
XmlSerializer ser = new XmlSerializer(typeof(Users));
var u = (Users)ser.Deserialize(stream);

[XmlRoot("users")]
public class Users
{
    [XmlElement("user")]
    public User[] UserList { get; set; }
}

public class User
{
    [XmlElement("name")]
    public string Name { get; set; }

    [XmlArray("orders"),XmlArrayItem("order")]
    public Order[] OrderList { get; set; }
}

[XmlRoot("order")]
public class Order
{
    [XmlElement("number")]
    public string Number { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T00:40:00.243

您只能使用 3 个类。您所要做的就是将 Xml.Serialization.XmlType 添加到您的类中

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Data;
using System.Diagnostics;

[Xml.Serialization.XmlType("users", IncludeInSchema = true)]
public class Users
{
[XmlElement("user")]
public List<User> UserList {
    get {
        if (m_UserList == null) {
            m_UserList = new List<User>();
        }
        return m_UserList;
    }
}

private List<User> m_UserList;
}
[Xml.Serialization.XmlType("user", IncludeInSchema = true)]
public class User
{
[XmlElement("name")]
public string Name {
    get { return m_Name; }
    set { m_Name = value; }
}

private string m_Name;
[XmlArray("orders")]
public List<Orders> OrderList {
    get {
        if (m_OrderList == null) {
            m_OrderList = new List<Orders>();
        }
        return m_OrderList;
    }
}
private List<Orders> m_OrderList;
}
[Xml.Serialization.XmlType("orders", IncludeInSchema = true)]
public class Orders
{
[XmlElement("number")]
public string Number {
    get { return m_Number; }
    set { m_Number = value; }
}
private string m_Number;
} 
```

# android - 如何在自定义对话框中创建正面和负面按钮

> ID：14783409
> 
> 赞同：3
> 
> 时间：2013-02-09T00:11:51.363
> 
> 标签：android, button, user-interface, dialog, customdialog

我想创建一个自定义对话框。所以我创建了一个模板“dialog_change”并打开了对话框。

```
Dialog myDialog = new Dialog(Overview.this);
myDialog.setContentView(R.layout.dialog_change);
myDialog.setTitle("My Custom Dialog Title");
myDialog.show(); 
```

![在此处输入图像描述](../Images/d0ee3940dc396ca44b68cfc18b2beddb.png)

现在我想在底部添加两个按钮（一个正按钮和一个负按钮）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T01:11:45.383

我只是制作自己的自定义类来模拟 AlertDialog，这样您就可以使用自己的布局而不附加任何字符串。（如果您想要一个完全样式化的 AlertDialog，则存在一些无法完全摆脱框架的奇怪问题）。像这样的东西，但您可以根据需要完全扩展它：

```
public class CustomDialog extends Dialog {
    private Button positive, negative;

    public CustomDialog(Context context) {
        super(context);
        initialize(context);
    }

    protected CustomDialog(Context context, boolean cancelable, OnCancelListener cancelListener) {
        super(context, cancelable, cancelListener);
        initialize(context);
    }

    public CustomDialog(Context context, int theme) {
        super(context, theme);
        initialize(context);
    }

    private void initialize(Context c) {
        //Inflate your layout, get a handle for the buttons

        positive = (Button)layout.findViewById(R.id.positive):
        negative = (Button)layout.findViewById(R.id.negative):

        positive.setVisibility(View.GONE);
        negative.setVisibility(View.GONE);
    }

    public void setPositiveButton(String buttonText, View.OnClickListener listener) {
        positive.setText(buttonText);
        positive.setOnClickListener(listener);
        positive.setVisibility(View.VISIBLE);
    }

    public void setNegativeButton(String buttonText, View.OnClickListener listener) {
        negative.setText(buttonText);
        negative.setOnClickListener(listener);
        negative.setVisibility(View.VISIBLE);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:26:52.433

您可以将这两个按钮添加到您用于对话框的自定义布局中（即 dialog_change）。然后您可以在创建对话框后访问它们，如下所示：

```
Dialog myDialog = new Dialog(Overview.this);
View view = LayoutInflater.from(context).inflate(R.layout.dialog_change,null);
myDialog.setContentView(view);
myDialog.setTitle("My Custom Dialog Title");

Button button1 = (Button)view.findViewById(R.id.button1);
button1.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v){
        dialog.dismiss();
    }
});
//Similarly for the second button
myDialog.show(); 
```

# matlab - matlab绘制多个函数

> ID：14783410
> 
> 赞同：-2
> 
> 时间：2013-02-09T00:12:27.087
> 
> 标签：matlab

我是 matlab 新手，我试图在一个图上绘制一些函数来比较它们的增长率：

```
n = [1:100];

plot(n, 2.^(2.^n), 'b')
hold
plot(n, 2.^n, 'r');
hold
plot(n, n.^log2(n), 'g') 
hold   
plot(n, n.^2, 'm') 
```

但我得到的只是最后一个功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T00:21:02.297

将您的`hold`命令更改为`hold on`. `hold`本身只是切换图形的保持状态，这意味着如果你有：

```
plot(...)   %plot 1
hold
plot(...)   %plot 2
hold
plot(...)   %plot 3
hold
plot(...)   %plot 4 
```

这相当于：

```
plot(n, 2.^(2.^n), 'b')   %plot 1
hold on
plot(n, 2.^n, 'r')   %plot 2 --> figure is held
hold off
plot(n, n.^log2(n), 'g')   %plot 3 --> figure isn't held
hold on
plot(n, n.^2, 'm')   %plot 3 --> figure is held 
```

所以最后，根据您的原始代码，您应该绘制 2 行。由于一个的增长速度比另一个快得多，您可能需要仔细观察才能看到较慢的一个。在那一点上，当您按顺序绘制所有 4 行时，您的第一个图将增长得如此之快，以至于您不会真正看到其他 3 行的大部分内容，就像抬头一样。

此外，您只需要为图形设置 1 个保持命令；您无需在每次绘图后重新应用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:37:26.373

最好的方法是将所有内容放在一个“绘图”命令中：

```
n = [1:100];

plot(n, 2.^(2.^n), 'b', n, 2.^n, 'r', n, n.^log2(n), 'g', n, n.^2, 'm'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:32:43.307

尝试这个：

```
n = [1:100];
figure 
hold on;
plot(n, 2.^(2.^n), 'b');
plot(n, 2.^n, 'r');
plot(n, n.^log2(n), 'g'); 
plot(n, n.^2, 'm');
hold off; 
```

当您想要打开多个窗口时，生成一个新的图形窗口很有用。生成新的图形窗口后，您可以根据需要打开保持。

# javascript - 通过分隔符拆分字符串，但在返回数组中包含分隔符

> ID：14783413
> 
> 赞同：3
> 
> 时间：2013-02-09T00:12:37.840
> 
> 标签：javascript, regex, split

我希望将字符串拆分为多个分隔符，但我想在返回的数组中包含分隔符。例如，我想`"hello i=5 (goodbye)"`用空格、赋值运算符和括号分割这个字符串。我知道如何拆分该字符串的唯一方法是执行以下操作：`"hello i=5 (goodbye)".split(/[\s=)(]/);`但返回的数组是`["hello", "i", "5", "", "goodbye", ""]`. 有没有办法在结果中包含分隔符？我希望它返回`["hello", "i", "=", "5", "(", "goodbye", ")"]`

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:22:03.290

您可以`match`在单个正则表达式中使用和匹配您想要的符号和与您想要的符号不匹配的组：

```
"hello i=5 (goodbye)".match(/[\s=)(]|[^\s=)(]+/g)
// result: ["hello", " ", "i", "=", "5", " ", "(", "goodbye", ")"] 
```

如果你想摆脱空间，你可以链接`.filter(function(el){ return el.trim(); })`到上面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:34:57.117

```
"hello i=5 (goodbye)".replace(/[\s=)(]/g, function(a){return ","+a+","}).split(/,/); 
```

输出：

```
[hello,  , i, =, 5,  , , (, goodbye, ), ] 
```

诀窍是引入另一个分隔符，例如逗号。请注意，新的分隔符不能出现在原始字符串中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:23:43.573

您可以使用前瞻，它在匹配字符之前选择一个空字符串。

```
/(?=[\s=)(])/ 
```

对于lookbehind，要选择匹配后的空字符串，请使用[以下方法之一](http://blog.stevenlevithan.com/archives/mimic-lookbehind-javascript)。

希望这可以帮助！！

# mysql - MySQL Pivot 或 Excel 解决方案

> ID：14783414
> 
> 赞同：1
> 
> 时间：2013-02-09T00:12:50.630
> 
> 标签：mysql, excel, pivot

我有一张桌子：

```
CREATE TABLE `Issues` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB; 
```

我还有一张桌子：

```
CREATE TABLE `Attachments` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `issue_id` int(11) DEFAULT NULL,
  `attachment` text,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB; 
```

我怎样才能让数据看起来像这样：

```
issue_id    title    attachment1    attachment2    attachment3
--------------------------------------------------------------
1           T1       a1.png         a2.png
2           T2
3           T3       b4.gif         xyz.doc        ttt.file 
```

我无法弄清楚的问题是如何将动态附件集放入按问题分组的动态列中。我已确定一个问题的最大附件数量为 12，但每张票的总数可以在 0-12 之间。我被难住了...

我已经尝试将此 [MySQL 透视行转换为动态列数](https://stackoverflow.com/questions/12004603/)，但在我的情况下无法理解它，因为我正在根据每条记录的总匹配数构建动态列......

任何帮助将不胜感激。如果这没有意义，请告诉我。

尼诺

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:33:13.870

如果您知道最大数量为 12，这是实现此目的的一种方法。它使用`MAX`和`CASE`，获取每个附件的行号。

```
SELECT 
    I.Id issue_id, 
    I.title, 
    MAX(CASE WHEN d.row_number = 1 THEN D.attachment END) attachment1,
    MAX(CASE WHEN d.row_number = 2 THEN D.attachment END) attachment2,
    MAX(CASE WHEN d.row_number = 3 THEN D.attachment END) attachment3,
    MAX(CASE WHEN d.row_number = 4 THEN D.attachment END) attachment4,
    MAX(CASE WHEN d.row_number = 5 THEN D.attachment END) attachment5,
    MAX(CASE WHEN d.row_number = 6 THEN D.attachment END) attachment6,
    MAX(CASE WHEN d.row_number = 7 THEN D.attachment END) attachment7,
    MAX(CASE WHEN d.row_number = 8 THEN D.attachment END) attachment8,
    MAX(CASE WHEN d.row_number = 9 THEN D.attachment END) attachment9,
    MAX(CASE WHEN d.row_number = 10 THEN D.attachment END) attachment10,
    MAX(CASE WHEN d.row_number = 11 THEN D.attachment END) attachment11,
    MAX(CASE WHEN d.row_number = 12 THEN D.attachment END) attachment12
FROM Issues I
  LEFT JOIN (
  SELECT 
      a.issue_id, 
      @running:=if(@previous=a.issue_id,@running,0) + 1 as row_number,
      @previous:=a.issue_id,
      a.attachment
  FROM Attachments a
      JOIN    (SELECT @previous := 0) r
    ORDER BY a.issue_id, a.attachment
  ) D ON I.ID = D.issue_id
GROUP BY I.Id, I.Title 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!2/97478/1)。

我必须进行编辑以使每个组的行号重置。现在应该可以上班了。另外，根据@spencer7593 的精彩评论，我稍微更新了查询。

- 编辑 -

为了回应OP关于需要动态结果的评论，这应该有效：

设置@sql = NULL；

```
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MAX(IF(d.row_number = ', d.row_number, ',D.attachment,NULL)) AS attachment', d.row_number)
  ) INTO @sql
FROM Issues I
  LEFT JOIN (
  SELECT 
      a.issue_id, 
      @running:=if(@previous=a.issue_id,@running,0) + 1 as row_number,
      @previous:=a.issue_id,
      a.attachment
  FROM Attachments a
      JOIN    (SELECT @previous := 0) r
    ORDER BY a.issue_id, a.attachment
  ) D ON I.ID = D.issue_id
;

SET @sql = CONCAT('SELECT I.Id issue_id, 
                          I.title, ', @sql, ' 
                  FROM Issues I
                  LEFT JOIN (
                  SELECT 
                      a.issue_id, 
                      @running:=if(@previous=a.issue_id,@running,0) + 1 as row_number,
                      @previous:=a.issue_id,
                      a.attachment
                  FROM Attachments a
                      JOIN    (SELECT @previous := 0) r
                    ORDER BY a.issue_id, a.attachment
                  ) D ON I.ID = D.issue_id
                GROUP BY I.Id, I.Title');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!2/cf7ff/1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T00:27:23.327

SELECT 语句返回的列集是静态定义的。SELECT 语句不能返回“可变”数量的列。

如果您可以定义要返回的列，则可以生成您显示的结果集，在您的情况下，这意味着定义`attachment`将在一行上返回的最大值（列）数。

获取该结果集的一种方法是使用 SELECT 列表中的相关子查询来返回第一次、第二次、第三次等出现的`attachment`值。

```
SELECT i.id
     , i.title
     , ( SELECT a1.attachment
           FROM `Attachments` a1
          WHERE a1.issue_id = i.id
          ORDER BY a1.id
          LIMIT 0,1
        ) AS attachment1
     , ( SELECT a2.attachment
           FROM `Attachments` a2
          WHERE a2.issue_id = i.id
          ORDER BY a2.id
          LIMIT 1,1
        ) AS attachment2
     , ( SELECT a3.attachment
           FROM `Attachments` a3
          WHERE a3.issue_id = i.id
          ORDER BY a3.id
          LIMIT 2,1
        ) AS attachment3
  FROM `Issues` i
 ORDER BY i.id 
```

* * *

要返回您的最大附件数，您需要扩展...

```
 , ( SELECT a4.attachment
           FROM `Attachments` a4
          WHERE a4.issue_id = i.id
          ORDER BY a4.id
          LIMIT 3,1
        ) AS attachment4 
```

ORDER BY 的目的是使查询的结果集具有确定性（没有 ORDER BY，MySQL 可以按照它想要的任何顺序返回行。）

LIMIT 子句的目的是指定只返回 1 行。`LIMIT 0,1`指定要返回 1 行，从第一行 (0) 开始。 `LIMIT 1,1`仅返回第二行。

* * *

这不是唯一的方法，也可能不是最有效的。对于从外部查询返回的少量行（在您的情况下，从`Issues`表中返回），它可以合理地工作。为此语句生成的“嵌套循环”计划对于大型集合来说可能是资源密集型的（即慢速）。

为了获得最佳性能，您可能需要一个索引...

```
ON `Attachments` (issue_id, id) 
```

或至少在

```
ON `Attachments` (issue_id) 
```

* * *

如果您确实需要返回一个“动态”数字，那么最好将这些`attachment`值作为单独的行返回，并在客户端处理从 SQL 语句返回的结果集。

# java - 如何为 Eclipse 插件制作动态上下文菜单？

> ID：14783424
> 
> 赞同：2
> 
> 时间：2013-02-09T00:14:25.297
> 
> 标签：java, eclipse, dynamic, eclipse-plugin, contextmenu

我正在尝试制作一个 Eclipse 插件，该插件能够使用第一个插件提供的扩展点根据其他插件动态更改导航视图的上下文菜单。

带一点示意图：[http ://hpics.li/bddf781](http://hpics.li/bddf781)

目的是插件 2、3 ... 提供的所有命令都可以在导航上下文菜单中访问，这要归功于插件 1

我已经用谷歌搜索了，但我什么也做不了。

例如 ：

包 com.sigasi;

```
 import java.util.Date;

 import org.eclipse.jface.action.ContributionItem;
 import org.eclipse.swt.SWT;
 import org.eclipse.swt.events.SelectionAdapter;
 import org.eclipse.swt.events.SelectionEvent;
 import org.eclipse.swt.widgets.Menu;
 import org.eclipse.swt.widgets.MenuItem;

 public class MyDynamicMenu extends ContributionItem {

    public MyDynamicMenu() {
    }

    public MyDynamicMenu(String id) {
    super(id);
    }

@Override
public void fill(Menu menu, int index) {
    //Here you could get selection and decide what to do
    //You can also simply return if you do not want to show a menu

    //create the menu item
    MenuItem menuItem = new MenuItem(menu, SWT.CHECK, index);
    menuItem.setText("My menu item (" + new Date() + ")");
    menuItem.addSelectionListener(new SelectionAdapter() {
        public void widgetSelected(SelectionEvent e) {
            //what to do when menu is subsequently selected.
            System.err.println("Dynamic menu selected");
        }
    });
}
} 
```

和 ：

```
<extension point="org.eclipse.ui.menus">
<menuContribution locationURI="popup:org.eclipse.ui.navigator.ProjectExplorer#PopupMenu?after=additions">
    <dynamic
              class="com.sigasi.MydynamicMenu"
              id="com.sigasi.myDynamicMenu">
    </dynamic>
  </menuContribution>
</extension> 
```

来源： [http ://www.sigasi.com/content/dynamic-menu-items-eclipse](http://www.sigasi.com/content/dynamic-menu-items-eclipse)

如果它不会只向菜单中添加一项，那可能会很棒。我试图让它适应我的需要，但没有成功。

编辑：我试图将 java 类的超类更改为 CompoundContributionItem；它允许向菜单添加多个项目，但似乎根据索引替换现有项目，而不是简单地添加它。此外，我仍然无法插入菜单。这是我所做的：

```
package fr.cardinjoseph.extensionpoint.definition;

import java.util.HashMap;
import java.util.Map;

import org.eclipse.jface.action.ContributionItem;
import org.eclipse.jface.action.IContributionItem;
import org.eclipse.swt.SWT;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.widgets.Menu;
import org.eclipse.swt.widgets.MenuItem;
import org.eclipse.ui.IWorkbench;
import org.eclipse.ui.IWorkbenchWindow;
import org.eclipse.ui.PlatformUI;
import org.eclipse.ui.actions.CompoundContributionItem;
import org.eclipse.ui.menus.CommandContributionItem;
import org.eclipse.ui.menus.CommandContributionItemParameter;

public class MyDynamicMenu extends CompoundContributionItem {

    ExtensionsFinder ef;

    public MyDynamicMenu() {
        ef = new ExtensionsFinder();
        ef.evaluateExtensions();
    }

    public MyDynamicMenu(String id) {
        super(id);
    }

    @Override
    public void fill(Menu menu, int index) {
        // Here you could get selection and decide what to do
        // You can also simply return if you do not want to show a menu

        // create the menu item

          Menu commandMenu = new Menu(menu);

         MenuItem test = new MenuItem(menu, index); test.setText("Test");
         test.addSelectionListener(new SelectionAdapter() { public void
         widgetSelected(SelectionEvent e) {  System.err.println("Dynamic menu selected"); }
         });

    }

    @Override
    protected IContributionItem[] getContributionItems() {
        // TODO Auto-generated method stub
        int size = ef.getExtensions().size();
        IContributionItem[] list = new IContributionItem[size];

        IWorkbench wb = PlatformUI.getWorkbench();
        IWorkbenchWindow win = wb.getActiveWorkbenchWindow();

        for(int i = 0 ; i< size ; i++){
            list[i] = new CommandContributionItem(new CommandContributionItemParameter(win, "MenuCommandeId_"+i, "CommandeId_"+i, SWT.None));
        }

        System.out.println("test");

        return list;
    }

    @Override
    public boolean isDynamic(){
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T09:23:02.870

通过使用`enabledWhen/visibleWhen`元素并实现您自己的[属性测试](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/workbench_cmd_handlers.htm)器或[源提供程序](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/workbench_cmd_handlers.htm)，可以显示/隐藏、启用/禁用菜单。例如，另请参阅[以下教程](http://codeandme.blogspot.fr/2012/04/source-provider-property-tester-and.html)。

在这种情况下，您将创建所有菜单项并在您想要显示它们时测试所需的条件。像这样的东西：

```
<extension point="org.eclipse.ui.menus">
<menuContribution allPopups="false" locationURI="menu:org.eclipse.ui.main.menu">
           <menu id="id" label="%label">
               <visibleWhen
                    checkEnabled="false">
                    <with
                        variable="SomeProvider.var1">
                    </with>
              </visibleWhen>
              <command commandId="command1" id="com1" label="%test" style="push">
              </command>
           </menu>
        </menuContribution>
 </extension>

 <extension
         point="org.eclipse.ui.services">
      <sourceProvider
            provider="com.your_package.SomeProvider">
         <variable
               name="SomeProvider.var1"
               priorityLevel="workbench">
         </variable>
      </sourceProvider>
</extension> 
```

```
public class SomeProvider extends AbstractSourceProvider {
   private static final String VAR1 = "SomeProvider.var1";

    @Override
    public Map getCurrentState() {
        Map<String, String> stateMap = new HashMap<String, String>();
                stateMap.put(VAR1, testIfMenuForVar1ShouldBeShown());
        return stateMap;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-14T16:15:11.100

您可以像这样添加多个菜单项：

```
 @Override
    public void fill(Menu menu, int index) {
        MenuItem menuItem = new MenuItem(menu, SWT.CHECK, index);
        menuItem.setText("1\. menu item (" + new Date() + ")");

        menuItem = new MenuItem(menu, SWT.CHECK, index);
        menuItem.setText("2\. menu item (" + new Date() + ")");

        menuItem = new MenuItem(menu, SWT.CHECK, index);
        menuItem.setText("3\. menu item (" + new Date() + ")");
    } 
```

或添加这样的级联菜单：

```
 @Override
    public void fill(Menu menu, int index) {
        Menu cascMenu = new Menu(menu);
        MenuItem cascade = new MenuItem(cascMenu, SWT.CASCADE, index);
        cascade.setText("Cascade...");
        cascade.setMenu(cascMenu);

        MenuItem menuItem = new MenuItem(cascade, SWT.CHECK, index);
        menuItem.setText("1\. menu item (" + new Date() + ")");
        // etc.
    } 
```

# ios - Objective-C 为什么我的类方法对类中的其他方法或其他对象不可见？

> ID：14783425
> 
> 赞同：0
> 
> 时间：2013-02-09T00:14:40.010
> 
> 标签：ios, objective-c

我有一个有多种方法的类。我可以从另一个对象实例化这个类并调用这些方法。当我添加一个新方法时，我不能从类中的另一个方法或另一个类中调用它。如果我删除参数，那么我可以看到该方法，但是当我将其添加回来时，我看不到该方法。我在这里和互联网上进行了搜索，并确保我正在导入该类并且该方法是在 .h 文件中定义的。我不知道可能是什么问题。

界面：

```
@interface npcgGetCharacterData : NSObject
@property (strong, nonatomic) NSFetchedResultsController *fetchedResults;
@property (nonatomic, strong) NSManagedObjectContext *managedObjectContext;
@property BOOL debug;
- (NSMutableString *)getRandomRace;
- (NSMutableString *)getRandomAlignment;
- (int)getRandomLevel;
- (NSMutableString *)getRandomNPCType;
- (NSMutableString *)getRandomNPCClass:(NSString *)entityClassType;
@end 
```

实施：

```
#import "npcgGetCharacterData.h"
#import "RaceEntity+Properties.h"
#import "AlignmentEntity+Properties.h"
#import "NPCTypeEntity+Properties.h"

@implementation npcgGetCharacterData
@synthesize fetchedResults, managedObjectContext, debug;

- (NSMutableString *)getRandomRace {
    NSString *randomRace = [NSString alloc];
    NSArray *resultsArray;
    NSInteger intCount;
    RaceEntity *raceEntity;

    [self setupFetchedResultsController:@"RaceEntity" entityName:@"raceName" entityWhere:@"raceName != 'Any Race'"];
    debug = NO;
    [self performFetch];
    resultsArray = [fetchedResults fetchedObjects];
    intCount = [resultsArray count];
    raceEntity = [resultsArray objectAtIndex:arc4random() % intCount];
    randomRace = raceEntity.raceName;
    self.fetchedResults = nil;
    return randomRace.mutableCopy;
}

- (NSMutableString *)getRandomAlignment {
    NSString *randomAlignment = [NSString alloc];
    NSArray *resultsArray;
    NSInteger intCount;
    AlignmentEntity *alignmentEntity;

    [self setupFetchedResultsController:@"AlignmentEntity" entityName:@"alignmentName" entityWhere:@"alignmentName != 'Any Alignment'"];
    debug = NO;
    [self performFetch];
    resultsArray = [fetchedResults fetchedObjects];
    intCount = [resultsArray count];
    alignmentEntity = [resultsArray objectAtIndex:arc4random() % intCount];
    randomAlignment = alignmentEntity.alignmentName;
    self.fetchedResults = nil;
    return randomAlignment.mutableCopy;
}

- (NSMutableString *)getRandomNPCType {
    NSString *randomNPCType = [NSString alloc];
    NSArray *resultsArray;
    NSInteger intCount;
    NPCTypeEntity *npcTypeEntity;

    [self setupFetchedResultsController:@"NPCTypeEntity" entityName:@"npcTypeName" entityWhere:@"npcTypeName != 'Any Type'"];
    debug = NO;
    [self performFetch];
    resultsArray = [fetchedResults fetchedObjects];
    intCount = [resultsArray count];
    npcTypeEntity = [resultsArray objectAtIndex:arc4random() % intCount];
    randomNPCType = npcTypeEntity.npcTypeName;
    self.fetchedResults = nil;
    return randomNPCType.mutableCopy;
}

- (NSMutableString *)getRandomNPCClass:(NSString *)entityClassType {
    NSString *randomNPCClass = [NSString alloc];

    return randomNPCClass.mutableCopy;
}

- (int)getRandomLevel {
    int intRandomLevel = 0;

    intRandomLevel = (NSInteger)arc4random_uniform(20) + 1;
    return intRandomLevel;
}

- (void)setupFetchedResultsController:(NSString *)entityType entityName:(NSString *)entityName entityWhere:(NSString *)entityWhere{

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:entityType];
    if (entityWhere != nil) {
        [request setPredicate:[NSPredicate predicateWithFormat:entityWhere]];
    }
    NSSortDescriptor *entityGroup = [[NSSortDescriptor alloc] initWithKey:entityName ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)];
    NSSortDescriptor *entityNameSort = [[NSSortDescriptor alloc] initWithKey:entityName ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)];
    request.sortDescriptors = [NSArray arrayWithObjects:entityGroup, entityNameSort, nil];

    self.fetchedResults = [[NSFetchedResultsController alloc] 
          initWithFetchRequest:request
          managedObjectContext:self.managedObjectContext
          sectionNameKeyPath:nil
          cacheName:nil];
}

- (void)performFetch {
    if (self.fetchedResults) {
        if (self.fetchedResults.fetchRequest.predicate) {
            if (self.debug) NSLog(@"[%@ %@] fetching %@ with predicate: %@", NSStringFromClass([self class]), NSStringFromSelector(_cmd), self.fetchedResults.fetchRequest.entityName, self.fetchedResults.fetchRequest.predicate);
        } else {
            if (self.debug) NSLog(@"[%@ %@] fetching all %@ (i.e., no predicate)", NSStringFromClass([self class]), NSStringFromSelector(_cmd), self.fetchedResults.fetchRequest.entityName);
        }
        NSError *error;
        [self.fetchedResults performFetch:&error];
        if (error) NSLog(@"[%@ %@] %@ (%@)", NSStringFromClass([self class]), NSStringFromSelector(_cmd), [error localizedDescription], [error localizedFailureReason]);
        if (self.debug) {
            NSLog(@"Number of Objects = %i", [[self.fetchedResults fetchedObjects] count]);
        }
    } else {
        if (self.debug) NSLog(@"[%@ %@] no NSFetchedResultsController (yet?)", NSStringFromClass([self class]), NSStringFromSelector(_cmd));
    }

}

@end 
```

调用方法。这是来自不同的对象：

```
- (IBAction)GenerateNPCClick:(id)sender {
    npcgGenerateAttribute *nga = [npcgGenerateAttribute alloc];
    npcgGetCharacterData *ngc = [npcgGetCharacterData alloc];
    ngc.managedObjectContext = self.managedObjectContext;
    int intValue = 0;
    NSMutableString *textViewHolder = [NSMutableString alloc];
    for (NSInteger i = 0; i < 6; i++) {
        intValue = nga.generate4D6;
        if (i == 0) {
            textViewHolder = [NSMutableString stringWithFormat:@"%d", intValue];
        } else {
            [textViewHolder appendString:@"\n"];
            [textViewHolder appendString:[NSMutableString stringWithFormat:@"%d", intValue]];
        }
    }
    NSMutableString *strRace = ngc.getRandomRace;
    [textViewHolder appendString:@"\n"];
    [textViewHolder appendString:@"Race: "];
    [textViewHolder appendString:strRace];
    NSMutableString *strAlignment = ngc.getRandomAlignment;
    [textViewHolder appendString:@"\n"];
    [textViewHolder appendString:@"Alignment: "];
    [textViewHolder appendString:strAlignment];
    int intLevel = ngc.getRandomLevel;
    [textViewHolder appendString:@"\n"];
    [textViewHolder appendString:@"Level: "];
    [textViewHolder appendString:[NSMutableString stringWithFormat:@"%d", intLevel]];
    NSMutableString *strNPCType = ngc.getRandomNPCType;
    [textViewHolder appendString:@"\n"];
    [textViewHolder appendString:@"NPC Type: "];
    [textViewHolder appendString:strNPCType];
    [ngc getRandomNPCClass:@"TestString"];
    self.textViewMessageSpace.text = textViewHolder;
} 
```

给我带来麻烦的方法是 getRandomNPCClass 方法。所有其他 getRandom 方法都在工作。

忘记包含错误消息：属性“getRandomNPCClass”不在“npcgGetCharacterData *”类型的对象上。当我尝试从另一个对象调用它时，我得到了这个。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:53:22.047

问题是如何创建对象：

```
npcgGetCharacterData *ngc = [npcgGetCharacterData alloc]; 
```

您正在混淆初始化消息，因此这就是您在尝试将其用作正确初始化的对象时遇到麻烦的原因。由于您还没有定义 init 方法，因此将使用 NSObject 的 init 方法来初始化对象：

```
npcgGetCharacterData *ngc = [[npcgGetCharacterData alloc]init]; 
```

此外，我希望记住关于访问器 ID 的 Objective-C 约定不同于 Java 和 C++。您不调用getter getRandomNPCClass，而是调用randomNPCClass。

# list - 如何将函数参数传递到 Erlang 中的列表中？

> ID：14783426
> 
> 赞同：0
> 
> 时间：2013-02-09T00:14:44.123
> 
> 标签：list, erlang

我正在尝试遵循有关 Erlang 列表的教程，但在将参数传递给列表时遇到了困难。以下是代码，我不确定如何运行它，我得到了错误，

异常错误：没有匹配插入的函数子句

我试过了

案例：插入（1，[0]）。

在命令行和许多其他...

```
-module(cases).
-export([insert/2]).

insert(X,[]) ->
    [X];
insert(X,Set) ->
    case lists:member(X,Set) of
        true  -> Set;
        false -> [X|Set]
    end. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:38:40.543

您发布的代码工作正常。

您可能想重新编译它，`c(cases)`然后试一试。

但它对我来说很好用，我已经将它复制并粘贴到 case.erl 中，这是命令行的结果：

```
7> cases:insert(0,[1]).                                                                             
[0,1] 
```

# zend-framework2 - 在 Zend Framework 2 中实现 403 渲染策略是否有简单的解决方案？

> ID：14783427
> 
> 赞同：1
> 
> 时间：2013-02-09T00:14:49.253
> 
> 标签：zend-framework2, zend-view

我设置了一个简单的 ACL 模块作为控制器插件。现在我想实现一个“403 渲染策略”，这样对于“拒绝”，我只需设置一个 403 响应，然后将渲染来自 template_map 的“error/403”视图。该功能应该类似于原始的 404 策略。

我看了看，`Zend\Mvc\View\Http\RouteNotFoundStrategy`但发现它有点超重。有没有更简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T08:46:04.307

您可能会看一下我是其中的作者的[SlmErrorException 。](https://github.com/juriansluiman/SlmErrorExceptions)它允许您抛出标有异常接口的异常。这个接口决定是设置 40x 还是 50x 状态码，以及渲染哪个错误模板。

您可以创建自己的异常

```
namespace MyModule\Exception;

use SlmErrorException\Exception\UnauthorizedInterface;

exception UnauthorizedUserException
    extends \Exception
    implements UnauthorizedInterface
{
} 
```

然后在代码中的某处抛出异常，模块会检查抛出的异常是否实现了任何已知接口。然后将设置一个状态码（在本例中为 403）并`error/unauthorized`呈现视图。

该模块正在开发中，尚未准备好投入生产。但是你可以看看它是否合适。也许您可以帮助稳定并帮助编写测试，以便更多人可以使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-29T07:09:15.703

这是一个不使用第三方模块的解决方案。

您可以创建一个自定义事件，该事件在触发时会将模板设置为所需的模板（请重新添加代码注释）：

```
public function onBootstrap(MvcEvent $e)
{
    $eventManager = $e->getApplication()->getEventManager();

    $eventManager->getSharedManager()->attach('custom', '403', function(MvcEvent $event) use($eventManager){

        //set the 403 template you have previously prepared
        $viewModel = new ViewModel();
        $viewModel->setTemplate('error/403');

        $appViewModel = $event->getViewModel();
        $appViewModel->setTemplate('layout/layout');//set the default layout (optional)
        $appViewModel->addChild($viewModel, 'content');//add the 403 template to the app layout

        //prevent the MvcEvent::EVENT_DISPATCH to fire by calling it
        //with high priority (100) and using $event->stopPropagation(true);
        $eventManager->attach(MvcEvent::EVENT_DISPATCH, function(MvcEvent $event) {
            $event->stopPropagation(true);
        }, 100);
    });
} 
```

然后您可以从代码中的任何位置触发此事件：

```
$e = new \Zend\Mvc\MvcEvent();
$eventManager = new \Zend\EventManager\EventManager('custom');
$eventManager->trigger('403', $e); 
```

# batch-file - 卸载并重新安装 apache/php 和其他服务

> ID：14783430
> 
> 赞同：0
> 
> 时间：2013-02-09T00:15:36.000
> 
> 标签：batch-file, windows-services

我今天发帖是为了了解是否可以使用命令提示符从记忆棒安装-卸载 Apache 等服务。

我正在为我的 LAMP Stack for windows 使用 xampp。

* * *

**问题 1**

原因是我经常往返于不同的地方。以轻装上阵为目的；我的老板要求我带一个公司监管的记忆棒，它将用于使用预先构建的批处理脚本安装/卸载 Apache 服务。

我将可以访问我将入住的计算机上的高级权限。但是这些机器中的大多数可能没有我成功开发所需的要求。

所以我想知道我的树中是否只有一个带有 exe/库的文件夹？

* * *

**问题2**

我有这个批处理脚本。问题是，无论主要输入如何。它会自动转到`:Install`.. 出了什么问题？

```
@ECHO OFF
@ECHO Service Management 

@echo Please Select an Option

@echo 1) Install Apache and other set services
@echo 2) Uninstall Services
SET /p option = Please Select: 

IF "%option%" == "1" GOTO Install
IF "%option%" == "2" GOTO Uninstall
IF "%option%" gtr "2" GOTO Error
:Install
SET /p path=Enter Path Of MemoryStick (letter only): 
@echo Install
PAUSE
EXIT
:Uninstall
SET /p path=Enter Path Of MemoryStick (letter only): 
@echo Uninstall
PAUSE
EXIT
:Error
@echo Error. Please Re-run
PAUSE
EXIT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:47:55.110

解决方案。将记忆棒分配给通常不使用的字母。Z:\ 例如。除非设置，否则什么都不会使用它。

您不需要命令提示符。您可以轻松复制必要的文件夹/文件。例如：

> C:\xampp\apache
> 
> C:\xampp\php

到你的记忆棒上。对 Apache 目录中的必要配置文件进行更改。在这种情况下，它将是：

> Z:\apache\conf\httpd.conf

将所有内容移至`C:\xampp\htdocs`记忆棒上的不同目录。例如。说如果你想使用目录*WebScripts*

举个例子：

```
#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "Z:/WebScripts" 
```

股票 httpd.conf 上的第 191 行

```
<Directory "Z:/WebScripts">
    #
    # Possible values for the Options directive are "None", "All",
    # or any combination of:
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #
    # Note that "MultiViews" must be named *explicitly* --- "Options All"
    # doesn't give it to you. 
```

股票 httpd.conf 上的第 221 行

在 Z:\ 根目录中创建该目录。如果这不存在，那么您将在从记忆棒安装服务时遇到错误。

**在您的 apache 目录 (Z:\Apache) 中安装 Apache 服务** ，您将找到`apache_installservice.bat`并`apache_uninstallservice.bat` 使用管理权限运行这些服务。

这些服务将被创建并通过位于 Z:\Apache\bin\httpd.exe 的 exe 运行，该 exe 将收集您的所有配置文件并使用 PHP 支持运行 apache 服务。

# preprocessor - 处理神经网络输入的文本字符串

> ID：14783431
> 
> 赞同：29
> 
> 时间：2013-02-09T00:16:08.370
> 
> 标签：preprocessor, neural-network, textinput, normalize, standardized

我知道 ANN 输入必须被规范化、标准化等。撇开各种 ANN 的特性和模型不谈，我如何在 {0,1} 范围内或在 {-1} 范围内预处理 UTF-8 编码文本， 1} 在作为神经网络的输入之前？我一直在谷歌上搜索这个但找不到任何信息（我可能使用了错误的术语）。

1.  那有意义吗？
2.  这不是为神经网络预处理文本的方式吗？
3.  有没有其他选择？

# 2013 年 11 月更新

我早就接受了皮特的正确答案。然而，我有严重的怀疑，主要是由于我最近对符号知识和 ANN 的研究。

[**Dario Floreano 和 Claudio Mattiussi**](http://baibook.epfl.ch/)**在他们的书中解释说，通过使用分布式编码**，这种处理确实是可能的。

实际上，如果您尝试使用 google 学者搜索，就会发现大量的神经科学文章和论文，这些文章和论文介绍了如何假设大脑使用分布式编码来编码符号知识。

**Teuvo Kohonen**在他的论文“*自组织地图*”中解释说：

> 有人可能认为，将神经适应定律应用于符号集（被视为一组矢量变量）可能会创建一个显示符号之间“逻辑距离”的地形图。然而，与连续数据相比，存在符号的不同性质的问题。对于后者，相似性总是以自然的方式出现，作为它们连续编码之间的度量差异。对于没有定义度量的离散符号项目（例如单词）不再适用。符号的本质与它的编码是分离的。

然而，Kohonen 确实设法处理了 SOM 中的符号信息！

此外，**Alfred Ultsch 教授**在他的论文“*神经网络与符号知识处理的集成*”中准确地处理了如何在人工神经网络中处理符号知识（例如文本）。Ultsch 提供以下处理符号知识的方法：神经近似推理、神经统一、内省和综合知识获取。尽管在谷歌学者或其他任何地方都找不到关于这方面的信息。

皮特在他的回答中关于语义是正确的。ANN 中的语义通常是不连贯的。然而，在参考之后，提供了研究人员如何使用 RBM 的见解，这些 RBM 被训练以识别不同单词输入的语义相似性，因此拥有语义应该不是不可能的，但如果需要语义，则需要分层方法或辅助 ANN .

[使用子符号神经网络进行自然语言处理，Risto Miikkulainen，1997 年](http://nn.cs.utexas.edu/?miikkulainen:perspectives97) [在单词观察上训练受限玻尔兹曼机，GEDahl，Ryan.P.Adams，H.Rarochelle，2012 年](http://deeplearningworkshopnips2011.files.wordpress.com/2011/12/21.pdf)

# 2021 年 1 月更新

NLP 和深度学习领域的研究在过去几年中出现了复苏，自从我提出这个问题以来。现在有机器学习模型可以解决我试图以多种不同方式实现的目标。

对于遇到此问题并想知道如何在深度学习或神经网络中预处理文本的任何人，这里有一些有用的主题，它们都不是学术性的，但很容易理解，它们应该可以帮助您开始解决类似的任务：

*   [向量空间模型](https://www.sciencedirect.com/topics/computer-science/vector-space-models)
*   [变形金刚](https://en.wikipedia.org/wiki/Transformer_(machine_learning_model))
*   [用于文本分类的递归和卷积网络](https://towardsdatascience.com/text-classification-rnns-or-cnn-s-98c86a0dd361)
*   [词嵌入](https://en.wikipedia.org/wiki/Word_embedding)
*   [文本预处理](https://www.kdnuggets.com/2019/04/text-preprocessing-nlp-machine-learning.html)

在我问这个问题的时候，RNN、CNN 和 VSM 即将开始使用，现在大多数深度学习框架都支持广泛的 NLP 支持。希望以上有所帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-21T16:57:11.277

我将继续在这里总结我们的讨论作为答案。

您的目标是能够将文本合并到您的神经网络中。我们已经确定传统的人工神经网络并不适合分析文本。为什么会这样的基本解释是基于这样的想法，即 ANN 对通常是连续值范围的输入进行操作，并且输入的两个值的接近意味着它们的含义具有某种接近性。单词没有这种接近的概念，因此，对于作为 ANN 输入有意义的单词，没有真正的数字编码。

另一方面，一个可行的解决方案是使用更传统的语义分析，它可能会为主题列表生成情感范围，然后这些主题及其情感值可能会用作 ANN 的输入。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-20T10:07:00.553

回应您的意见，不，您提出的方案不太合理。一个人工神经元的输出本质上代表一个连续的或至少一个二进制值。在巨大的离散枚举（如 UTF-8 字符）和由浮点值表示的连续范围之间进行映射是没有意义的。例如，当这些数字可以很容易地映射到换行符和字符“a”时，ANN 必然会表现得像 0.1243573 是 0.1243577 的一个非常好的近似值，这对于彼此来说*根本**不是*很好的近似值。

 *坦率地说， “通用 unicode 字符串”*没有*合理的表示形式作为 ANN 的输入。一个合理的表示取决于你正在做什么的细节。这取决于您对以下问题的回答：

*   您是否希望输入字符串中出现单词而不是字符块？您希望字符串中出现哪些单词？
*   输入字符串的长度分布是多少？
*   输入字符串的预期熵是多少？
*   对于您期望字符串的外观，您是否有任何特定领域的知识？

最重要的是

*   你想用 ANN*做什么。*这***不是***你可以忽略的。

您可能有一个*没有*翻译的设置，实际上可以让您使用神经网络*做您想做的事情。*在你回答这些问题之前（你在上面的评论中绕过它们），不可能给出一个好的答案。

我可以给出一个*示例答案*，如果您碰巧对上述问题给出了某些答案，那将起作用。例如，如果您正在阅读具有任意长度但由空格分隔的小词汇表组成的字符串，那么我建议您使用一种翻译方案，其中您制作 N 个输入，一个用于词汇表中的每个单词，并使用递归神经网络通过将相应的输入设置为 1 并将所有其他输入设置为 0 来一次输入一个单词。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-13T17:13:36.557

我认为将文本（在字符级别编码）输入到深度信念网络中，看看它可以发现语言的哪些属性会很有趣。

最近在神经网络语言建模方面做了很多工作（主要是单词级别，也有字符级别）

有关更多信息，请参阅这些链接

[http://www.stanford.edu/group/pdplab/pdphandbook/handbookch8.html](http://www.stanford.edu/group/pdplab/pdphandbook/handbookch8.html) [http://code.google.com/p/word2vec/](http://code.google.com/p/word2vec/)

词向量是通过对大量维基百科文章等进行训练而编码的，并且已经能够获得语义和句法特征，这允许在它们之间定义“距离””

“最近表明，词向量捕获了许多语言规律，例如向量操作向量（'king'）-向量（'man'）+向量（'woman'）接近向量（'queen'）”

另请参阅 Ilya Sutskever 的这篇关于生成随机字符的出色研究论文，该论文在经过维基百科培训后展示了英语语言的特征。惊人的东西！

[http://www.cs.toronto.edu/~ilya/pubs/2011/LANG-RNN.pdf](http://www.cs.toronto.edu/~ilya/pubs/2011/LANG-RNN.pdf) [http://www.cs.toronto.edu/~ilya/rnn.html](http://www.cs.toronto.edu/~ilya/rnn.html)（在线文本生成文本演示-非常凉爽的！）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-20T20:49:12.780

目前尚不清楚您要做什么，但我想它似乎在某种意义上与人们所说的“自然语言”有关。有很多关于这方面的参考资料......我不是专家，但我知道例如 O'Reilly 有一些有趣的参考资料。

从 NN 的角度来看，有许多不同的 NN 模型。我认为您指的是最流行的一种称为多层感知器的具有一种反向传播算法的感知器，但是有很多关联内存模型可能更适合您的情况。关于这方面的一个很好的参考是 Simon Haykin 的书。

但是，如果我尝试做这样的事情，我会开始尝试理解字母、音节和单词的频率如何在英语中一起出现（？）。

我希望我有所帮助。正如我之前所说，我不是该领域的专家。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-16T23:43:30.570

解决方案1：A = Alt(65) = 65 Bin = 01000001

解决方案 2：将单词添加到字典数据库并添加 id(int) 字段。将 id 字段转换为二进制。

在 NN 中使用字母或单词 id（二进制）*

# javascript - 在类外定位类内的元素

> ID：14783436
> 
> 赞同：0
> 
> 时间：2013-02-09T00:16:40.877
> 
> 标签：javascript, jquery, html, css

所以我在这里使用这个演示插件[http://tympanus.net/Tutorials/PrettySimpleContentSlider/](http://tympanus.net/Tutorials/PrettySimpleContentSlider/)并试图让右侧的动画标签（ul id="rotmenu"）能够自由浮动并自由定位在其主要的 div 类“旋转器”之外，仍然保持其功能并在旋转器中发挥作用。我尝试在这里和那里对 div 和类的属性进行一些简单的更改，但它们或多或少地把事情搞砸了。有任何想法吗？

好的，这里是使用 jquery_easing.1.3 和 jquery.min.js 库的 js

```
<script type="text/javascript">
        $(function() {
            var current = 1;

            var iterate     = function(){
                var i = parseInt(current+1);
                var lis = $('#rotmenu').children('li').size();

            }
            display($('#rotmenu li:first'));
            var slidetime = setInterval(iterate,3000);

            $('#rotmenu li').bind('click',function(e){
                clearTimeout(slidetime);
                display($(this));
                e.preventDefault();
            });

            function display(elem){
                var $this   = elem;
                var repeat  = false;
                if(current == parseInt($this.index() + 1))
                    repeat = true;

                if(!repeat)
                    $this.parent().find('li:nth-child('+current+') a').stop(true,true).animate({'marginRight':'-20px'},300,function(){
                        $(this).animate({'opacity':'0.7'},700);
                    });

                current = parseInt($this.index() + 1);

                var elem = $('a',$this);

                    elem.stop(true,true).animate({'marginRight':'0px','opacity':'1.0'},300);

                var info_elem = elem.next();
                $('#rot1 .heading').animate({'left':'-420px'}, 500,'easeOutCirc',function(){
                    $('h1',$(this)).html(info_elem.find('.info_heading').html());
                    $(this).animate({'left':'0px'},400,'easeInOutQuad');
                });

                $('#rot1 .description').animate({'bottom':'-270px'},500,'easeOutCirc',function(){
                    $('p',$(this)).html(info_elem.find('.info_description').html());
                    $(this).animate({'bottom':'0px'},400,'easeInOutQuad');
                })
                $('#rot1').prepend(
                $('<img/>',{
                    style   :   'opacity:0',
                    className : 'bg'
                }).load(
                function(){
                    $(this).animate({'opacity':'1'},600);
                    $('#rot1 img:first').next().animate({'opacity':'0'},700,function(){
                        $(this).remove();
                    });
                }
              ).attr('src','images/'+info_elem.find('.info_image').html()).attr('width','800').attr('height','300')
            );
            }
        });
    </script> 
```

应用 jquery 的地方

```
 <body>
    <div id="content">
        <a class="back" href=""></a>

        <div class="rotator">
            <ul id="rotmenu">
                <li>
                    <a href="rot1">Portfolio</a>
                    <div style="display:none;">
                        <div class="info_image">1.jpg</div>
                        <div class="info_heading">Our Works</div>
                        <div class="info_description">

                            <a href="#" class="more">Read more</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="rot2">Services</a>
                    <div style="display:none;">
                        <div class="info_image">2.jpg</div>
                        <div class="info_heading">We serve</div>
                        <div class="info_description">

                            <a href="#" class="more">Read more</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="rot3">Contact</a>
                    <div style="display:none;">
                        <div class="info_image">3.jpg</div>
                        <div class="info_heading">Get in touch</div>
                        <div class="info_description">

                            <a href="#" class="more">Read more</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="rot4">Experiments</a>
                    <div style="display:none;">
                        <div class="info_image">4.jpg</div>
                        <div class="info_heading">We do crazy stuff</div>
                        <div class="info_description">

                            <a href="#" class="more">Read more</a>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="rot5">Applications</a>
                    <div style="display:none;">
                        <div class="info_image">5.jpg</div>
                        <div class="info_heading">Working things</div>
                        <div class="info_description">

                            <a href="#" class="more">Read more</a>
                        </div>
                    </div>
                </li>
            </ul>
            <div id="rot1">
                <img src="" width="800" height="300" class="bg" alt=""/>
                <div class="heading">
                    <h1></h1>
                </div>
                <div class="description">
                    <p></p>

                </div>    
            </div>
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:31:03.323

首先，这听起来像你想的那样，因为 rotmenu 是 rotator 类的一部分，你需要在它之外有 rotator 类。这不是课堂的运作方式。如果您希望 rotmenu 成为该课程的一部分，请执行 . 如果不是这种情况，则忽略这部分消息。

它的结构方式是你的无序列表被一些不可见的 div 包裹。我不知道你说的搞砸是什么意思。但由于它的类，它可能与该包装器 div 的某些 css 元素有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:35:22.357

如果您希望它在其父级 ( `.rotator`) 之外可见，则需要将父级的 CSS 更改为 have `overflow: visible`。然后，您可以将其`#rotmenu`放置在您想要的任何位置。

```
#rotmenu {
    position: absolute;
    top: 300px;
    left: 100px;
    z-index: 10;
}    
.rotator {
    ...
    overflow:visible;
    ...
} 
```

此外，为了继续屏蔽动画组件，您需要设置`#rot1`为溢出：隐藏并使其具有与公共父级相同的尺寸（`.rotator`）。

```
#rot1 {
    position: absolute;
    overflow: hidden;
    height: 100%;
    width: 100%;
} 
```

最后，为了防止损坏的图像收集在 DOM 中（在示例中发生这种情况，因为我们不包含源图像），我在图像插入代码中添加了一个错误处理程序以删除图像。

```
$('#rot1').prepend(
$('<img/>', {
    style: 'opacity:0',
    className: 'bg'
}).error(function () {
    $(this).remove();
}).load(function () {
    $(this).animate({
        'opacity': '1'
    }, 600);
    $('#rot1 img:first').next().animate({
        'opacity': '0'
    }, 700, function () {
        $(this).remove();
    });
}).attr('src', 'images/' + info_elem.find('.info_image').html()).attr('width', '800').attr('height', '300')); 
```

[jsfiddle](http://jsfiddle.net/hK43c/)

# python - jinja2 打印到控制台或日志

> ID：14783438
> 
> 赞同：20
> 
> 时间：2013-02-09T00:17:02.317
> 
> 标签：python, template-engine, jinja2

我是 Jinja2 的新手，想知道是否有办法让模板在生成时打印到控制台或将某些输出重定向到某种流？

由于 Jinja2 模板内部可能有逻辑，我认为有时将一些信息记录到某种日志文件中会很有用，或者至少打印到控制台。

这是可能的还是我只是在说垃圾？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-09T01:00:01.693

我认为您可以使用过滤器（[http://jinja.pocoo.org/docs/api/#custom-filters](http://jinja.pocoo.org/docs/api/#custom-filters)）或扩展（[http://jinja.pocoo.org/docs/extensions/#adding-extensions](http://jinja.pocoo.org/docs/extensions/#adding-extensions)）来实现它. 这个想法是将过滤器或扩展直接打印到控制台。

未经测试，但过滤器应类似于：

```
def debug(text):
  print text
  return ''

environment.filters['debug']=debug 
```

用作：

```
...<p>Hello world!</p> {{"debug text!"|debug}}... 
```

请记住删除生产代码上的调试！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-03-19T15:34:10.980

使用上下文处理器的类似但略有不同的方法：

在蟒蛇/烧瓶中：

```
@app.context_processor
def utility_functions():
    def print_in_console(message):
        print str(message)

    return dict(mdebug=print_in_console) 
```

在 jinja2 中，在任何地方使用它，如下所示：

```
{{ mdebug("any text or variable") }} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-02-05T07:24:56.503

我将有一个带有 id 集的 HTML 元素和该元素的 hidden 属性。然后像这样使用JavaScript

```
<p id="hidden-p">{{a_variable}}</p>
<script>
    var hiddenP = document.getElementById("hidden-p").innerHTML;
    console.log(hiddenP);
</script> 
```

# php - 使用一个 foreach 获取数组中的数组值

> ID：14783444
> 
> 赞同：0
> 
> 时间：2013-02-09T00:17:48.370
> 
> 标签：php, arrays, foreach

我想在数组中获取数组的值，但无法使其工作。这是我尝试过的。

```
for($i=2;$i<=$row_count;$i++){
    $auto_part = 'auto_part'.$i;
    $auto_parts['part'][] = $_POST[$auto_part];
    $description = 'auto_description'.$i;
    $auto_parts['description'][] = $_POST[$description];
}
foreach($auto_parts as $part){
    echo $part['part'];
    echo $part['description'];
} 
```

for 循环是正确的，数组也是按照我想要的方式构建的，我检查了一下。但是如何在一个 foreach 中同时获得 $part['part'] 和 $part['description'] 的两个数组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T00:19:51.937

如果数据相关，则以不同方式构造数组

```
for($i=2; $i<=$row_count; $i++){
    $auto_part = 'auto_part' . $i;
    $description = 'auto_description' . $i;
    $auto_parts[] = array(
        'part' => $_POST[$auto_part],
        'description' => $_POST[$description]
    );
}
foreach($auto_parts as $part){
    echo $part['part'];
    echo $part['description'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:24:28.460

采用`foreach($variable as $key => $value)`

```
for($i=2;$i<=$row_count;$i++){
    $auto_part = 'auto_part'.$i;
    $auto_parts['part'][] = $_POST[$auto_part];
    $description = 'auto_description'.$i;
    $auto_parts['description'][] = $_POST[$description];
}
foreach($auto_parts as $key => $part){
    echo $part['part'][$key];
    echo $part['description'][$key];
} 
```

# ruby-on-rails - Rails 导入城市、国家、地区数据

> ID：14783453
> 
> 赞同：0
> 
> 时间：2013-02-09T00:19:09.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试按照此导入脚本将国家和城市数据从 GeoWorldMaps 导入我的 Rails 应用程序。它给我带来了问题。

我用 Rails.root 替换了 RAILS_ROOT。我仍然收到以下错误（见下文）

我正在按照此处详述的步骤进行操作：

[http://blog.inspired.no/populate-your-database-with-free-world-cities-countries-regions-in-2-minutes-using-a-rails-migration-273/](http://blog.inspired.no/populate-your-database-with-free-world-cities-countries-regions-in-2-minutes-using-a-rails-migration-273/)

这是迁移文件：

```
 class Places < ActiveRecord::Migration
  def self.up
    create_table :countries do |t|
      t.string :name, :limit => 50, :null => false
      t.string :fips104, :limit => 2, :null => false
      t.string :iso2, :limit => 2, :null => false
      t.string :iso3, :limit => 3, :null => false
      t.string :ison, :limit => 4, :null => false
      t.string :internet, :limit => 2, :null => false
      t.string :capital, :limit => 25
      t.string :map_reference, :limit => 50
      t.string :nationality_singular, :limit => 35
      t.string :nationaiity_plural, :limit => 35
      t.string :currency, :limit => 30
      t.string :currency_code, :limit => 3
      t.integer :population
      t.string :title, :limit => 50
      t.string :comment, :limit => 255

      t.timestamps
    end

    create_table :regions do |t|
       t.references :country, :null => false
       t.string :name, :limit => 45, :null => false
       t.string :code, :limit => 8, :null => false
       t.string :adm1code, :limit => 4, :null => false

       t.timestamps
     end

     create_table :cities do |t|
       t.references :country, :null => false
       t.references :region, :null => false
       t.string :name, :limit => 45, :null => false
       t.float :latitude, :null => false
       t.float :longitude, :null => false
       t.string :timezone, :limit => 10, :null => false
       t.integer :dma_id
       t.string :county, :limit => 25
       t.string :code, :limit => 4

       t.timestamps
     end
     add_index :cities, :name

     execute "LOAD DATA INFILE '#{RAILS_ROOT}/db/migrate/Countries.txt' INTO TABLE countries
       FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' LINES TERMINATED BY '\r\n' IGNORE 1 LINES;"

     execute "LOAD DATA INFILE '#{RAILS_ROOT}/db/migrate/Regions.txt' INTO TABLE regions
       FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' LINES TERMINATED BY '\r\n' IGNORE 1 LINES;"

     execute "LOAD DATA INFILE '#{RAILS_ROOT}/db/migrate/Cities.txt' INTO TABLE cities
       FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' LINES TERMINATED BY '\r\n' IGNORE 1 LINES;"

  end

  def self.down
    drop_table :countries
    drop_table :regions
    drop_table :cities
  end
end 
```

我得到的错误是：

```
SQLite3::SQLException: near "LOAD": syntax error: LOAD DATA INFILE '/Users/william/Websites/project7/db/migrate/Countries.txt' INTO TABLE countries
       FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' LINES TERMINATED BY '
' IGNORE 1 LINES;
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:91:in `initialize'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:91:in `new'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:91:in `prepare'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/sqlite3-1.3.7/lib/sqlite3/database.rb:134:in `execute'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/connection_adapters/sqlite_adapter.rb:278:in `block in execute'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activesupport-3.2.11/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/connection_adapters/sqlite_adapter.rb:278:in `execute'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:466:in `block in method_missing'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:438:in `block in say_with_time'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:438:in `say_with_time'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:458:in `method_missing'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:334:in `method_missing'
/Users/william/Websites/project7/db/migrate/20130208235628_places.rb:49:in `up'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:370:in `up'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:410:in `block (2 levels) in migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:410:in `block in migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in `with_connection'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:389:in `migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:528:in `migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:720:in `block (2 levels) in migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:775:in `call'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:775:in `block in ddl_transaction'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/transactions.rb:208:in `transaction'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:775:in `ddl_transaction'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:719:in `block in migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:700:in `each'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:700:in `migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:570:in `up'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/migration.rb:551:in `migrate'
/Users/william/.rvm/gems/ruby-1.9.3-p125@clasee/gems/activerecord-3.2.11/lib/active_record/railties/databases.rake:179:in `block (2 levels) in <top (required)>'
Tasks: TOP => db:migrate
(See full trace by running task with --trace) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:34:56.817

您正在使用 mysql load 命令尝试导入 sqlite。请参阅：[将数据批量加载到 sqlite？](https://stackoverflow.com/questions/697004/bulk-load-data-into-sqlite)有关如何导入 sqlite 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:36:24.533

我最好的猜测是 sqlite 不喜欢 LOAD 命令，我不确定您是否可以在 sqlite shell 之外执行以下操作。

要使用 sqlite 导入 csv，请执行以下操作：

```
.mode csv <table> 
.import <filename> <table> 
```

或者在你的情况下，特别是：

```
.mode csv Countries
.import /Users/william/Websites/project7/db/migrate/Countries.txt Countries 
```

你需要为城市和州做同样的事情。

# objective-c - viewController 类的前向声明接收非法接口限定符错误

> ID：14783454
> 
> 赞同：2
> 
> 时间：2013-02-09T00:19:43.637
> 
> 标签：objective-c

```
@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;

@class ViewController;

@property (strong,nonatomic) ViewController *viewController; 

@end 
```

在@class ViewController 行上，它说存在非法接口限定符错误。这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-02-21T02:08:34.957

只是为其他人添加一个，我也得到了“非法接口限定符错误”，我 99% 确定这是前向声明的东西..但是..每次我更改并尝试修复这个问题时，xcode 都会给出非常奇怪的错误这不合逻辑。

最后的问题是：在其他头文件中缺少@end ..

倒霉……

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-09T00:23:37.600

宣布

```
@class ViewController; 
```

之前

```
@interface AppDelegate : UIResponder <UIApplicationDelegate> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T00:23:37.243

您需要将@class ViewController 放在@interface 之外，如下所示：

```
@class ViewController;
@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;

@property (strong,nonatomic) ViewController *viewController; 

@end 
```

# c# - 如何在 PowerShell cmdlet 中使用 Get-Content？

> ID：14783457
> 
> 赞同：1
> 
> 时间：2013-02-09T00:20:02.783
> 
> 标签：c#, visual-studio-2010, powershell

问题是在in 中`PowerShell 3.0` `cmdlet`使用。`C#``.Net Framework 4.0``Visual Studio 2010`

我们正在编写一个需要管道输入的 PowerShell cmdlet。喜欢...

```
Get-Content .\somefile.bin -Encoding Byte | Receive-Bytes 
```

Receive-Bytes cmdlet 需要以与 Set-Content 相同的方式工作。喜欢...

```
Get-Content .\somefile.bin -Encoding Byte | Set-Content otherfile.bin -Encoding Byte 
```

我们尝试了以下三个选项：

```
[System.Management.Automation.Parameter(Position = 1, Mandatory = true, ValueFromPipeline = true)]
public byte Input { private get; set; }
public byte[] Input { private get; set; }
public System.IO.BinaryReader Input { private get; set; } 
```

但是... byte、byte[]、BinaryReader 都会导致相同的错误。

```
+ Get-Content .\somefile.bin | Receive-Bytes
+ ~~~~~~~~~~~~~~~~~~
+ CategoryInfo : InvalidArgument: [Receive-Bytes], ParameterBindingException
+ FullyQualifiedErrorId : 

Receive-Bytes : The input object cannot be bound to any parameters for the command either because the command does not take pipeline input or the input and its properties do not match any of the parameters that take pipeline input. 
```

我们注意到错误重复了好几次，这表明 Get-Content 实际上正在发送几块数据。研究并发现情况确实如此（[http://brianreiter.org/2010/01/29/powershells-object-pipeline-corrupts-piped-binary-data/](http://brianreiter.org/2010/01/29/powershells-object-pipeline-corrupts-piped-binary-data/)），但这让我们离解决它更近了一步。

所以...问题是：我们如何设置 System.Management.Automation.Parameter 来接受从 Get-Content 发送的字节流？

更新：下面的答案指向在 Get-Content 上使用 -Encoding Byte，并在 Receive-Bytes 中使用...

```
public IConvertible Input { private get; set; } 
```

IConvertible 获取数据。但是我们在 Receive-Bytes 中获取的内容与我们使用 Get-Content 选择的源文件不匹配。

那么......我们如何设置参数以将 IConvertible 更改回字节流？

# ruby-on-rails-3 - 将异常从延迟作业传递到控制器 - 使用缓存（memcached）

> ID：14783458
> 
> 赞同：1
> 
> 时间：2013-02-09T00:20:06.070
> 
> 标签：ruby-on-rails-3, exception-handling, ruby-on-rails-3.1, memcached, delayed-job

我正在尝试`error`通过使用 Rails.cache（绑定到 Memcached）在延迟作业中使用钩子将异常传递给我的控制器。

我的控制器方法具有以下代码行，并且我已经测试了该作业是否正常运行：

```
Delayed::Job.enqueue(BuildDetail.new) 
```

BuildDetail 类在我的 /lib/jobs/build_detail.rb 文件中定义：

```
class BuildDetail

  def perform
    # do some stuff here
  end

  def success(job)
    Rails.cache.write("job_done", true, :expires_in => 4.hours)
  end

  def error(job, exception)
    Rails.cache.write("job_errors", exception, :expires_in => 4.hours)
  end 
```

然后在另一个控制器方法中，我希望能够执行以下操作：

```
def other_controller_method
  job_errors = Rails.cache.read("job_errors")

  case job_errors
    when Timeout::Error
      redirect_to reports_path
      flash[:error] = "You have timed out!"
    else
  #...something else here
  end

end 
```

但是，我似乎无法从 case 语句的缓存键中访问错误消息。我究竟做错了什么？异常以什么格式保存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T17:04:23.053

因此，在一些帮助下，我发现将后台作业异常保存在缓存键中是一个非常可行的解决方案。从那里，我做了几件不同的事情——用 JQuery 处理一些错误，用实际的 Rails 服务器处理一些错误。我的问题是（在成为 Rails 新手时）我忘记了异常是特定的对象类型 - 并且假设我可以传递缓存值并将其作为字符串引用。

# jquery-selectors - 在用户脚本中，使用 querySelector() 与 jQuery 的 $() 有什么优势吗？

> ID：14783464
> 
> 赞同：5
> 
> 时间：2013-02-09T00:21:40.153
> 
> 标签：jquery-selectors, cross-browser, css-selectors, greasemonkey, userscripts

在用户脚本中使用`querySelector()`vs jQuery有什么好处`$()`吗？我希望该脚本在所有支持用户脚本的主流浏览器中都能工作，所以我对跨浏览器兼容性特别感兴趣。

我开始对此感到疑惑，因为我注意到*Honestbleeps*出色的*Reddit Enhancement Suite*包含jQuery 作为依赖项，但主要`querySelector()`用于选择元素和其他用于DOM 操作的基本JavaScript 方法。

这只是品味问题，还是有理由将 jQuery 的使用保持在最低限度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T01:03:44.603

使用`querySelector()`or的唯一原因`querySelectorAll()`是您不使用 jQuery。与高级 CSS 选择器相比，jQuery 选择器更强大，并且更有可能在浏览器中始终如一地执行。

也就是说，包括 jQuery 会使*简单的*脚本不必要地复杂化。它需要在大多数浏览器上进行*脚本注入*——这会破坏沙盒，产生潜在的冲突，并使您的脚本依赖于第三方服务器。
[这是一种包含 jQuery 的跨浏览器方法，可以最大限度地减少冲突。而且，如果浏览器支持本地 jQuery 副本，则不需要第三方服务器始终处于启动/快速状态。](https://stackoverflow.com/a/12751531/331508)

如果脚本很简单并且您可以轻松避免使用 jQuery，请使用`querySelector()`. 您的脚本将在所有支持脚本的浏览器上运行，99% 以上的时间。

如果脚本仍然加载 jQuery，请使用 jQuery 选择器以获得最大的功能和一致性。

请注意，除了最基本的 DOM 操作之外，jQuery 通常是物有所值的。对于 Firefox+Greasemonkey 或 Chrome+Tampermonkey，如果你使用 jQuery，几乎没有[`@require`缺点](http://wiki.greasespot.net/Metadata_Block#.40require)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:24:23.843

`querySelector` [某些浏览器版本不支持](http://caniuse.com/queryselector)，而 jQuery支持`$()`。

# sql - 此 SQL 查询是否保证正确加入？

> ID：14783466
> 
> 赞同：1
> 
> 时间：2013-02-09T00:22:03.473
> 
> 标签：sql, inner-join

这是一个非常基本的问题，但出于某种原因，我无法让自己放心。我有一个 sql 查询，我想确保它按预期运行。

`question_records``enrollments`两者都有一个外键`questions`

```
SELECT `question_records`.* FROM `question_records` 
  INNER JOIN `enrollments` ON `enrollments`.`id` = `question_records`.`enrollment_id` 
  INNER JOIN `questions` ON `questions`.`id` = `question_records`.`question_id` 
  WHERE (enrollments.id IN (10,20) 
         AND questions.id IN (500,600) 
         AND question_records.id not in (3000,4000)) 
```

我要确保的是，我不会得到一个问题记录，例如，enrollment_id 为 11，question_id 为 500。换句话说，这个内部连接是否逐个记录地处理这个 where 子句？更重要的是，它*总是这样*对待它吗？（我可以想出一个测试示例，但要确保我没有遗漏任何案例。

编辑：为清楚起见的附加叙述：

`question_record`数据库中可能存在 a`enrollment_id`为 11 和 a`question_id`为 500。如果此查询不是逐条记录搜索条件，它将匹配`question_id`500 并返回记录。这不是我想要的行为。我只想要*与*给定记录匹配**的**记录。我得到的答案涵盖了这种情况。`enrollment_id` *`question_id`*

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:27:54.963

评估此查询的心智模型是：

1.  `question_records`您从、`enrollments`和中获取所有行`questions`。
2.  您创建这三个行集的笛卡尔积。（首先将所有内容与所有内容匹配。）
3.  根据条件是否为真`INNER JOIN`过滤笛卡尔积的行。`ON`
4.  然后根据最终`WHERE`条件对其进行过滤。
5.  选择所需的列以形成最终结果。

（显然，数据库会将其优化为完全不同的东西。）

因此，如果一行符合`INNER JOIN..ON`条件，但不符合条件，`WHERE`则不会出现在最终结果中。它必须匹配所有条件。

当您知道您`INNER JOIN`的等效于以下时，这可能更容易理解：

```
SELECT qr.* FROM question_records qr
                 enrollments      e
                 questions        q
  WHERE e.id = qr.enrollment_id
    AND q.id = qr.question_id
    -- your original WHERE condition
    AND enrollments.id IN (10,20) 
    AND questions.id IN (500,600) 
    AND question_records.id not in (3000,4000)) 
```

（这种形式更符合我概述的心智模型。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:36:51.567

如果您的问题确实是 SQL 优化器是否会将 WHERE 子句中的条件推送到 JOIN 中并在执行连接之前对每个表进行过滤作为中间结果，那么答案是没有这样的*保证*，但在简单的情况下，例如这是任何体面的优化器的一半。*

# c++ - 是否有等效于 timeGetTime() 的标准库？

> ID：14783468
> 
> 赞同：1
> 
> 时间：2013-02-09T00:22:20.487
> 
> 标签：c++, stl, std

我尝试过搜索，但没有真正找到满足我要求或解释得足够清楚的这个问题的答案。

我正在寻找一个函数或一种方法来实现一个函数，该函数可以以与 timeGetTime() 函数在 Windows 中相同的方式检索滴答数或毫秒数。

我正在寻找一种仅使用标准 C++、没有其他库或平台细节的解决方案（例如 windows 上的 timeGetTime() 或 linux 等价物；多平台解决方案）。

我试图在库的较低级别保持我的代码平台独立，我只想知道是否有人可以告诉我/指出我将类似于 timeGetTime() 的东西放在一起的方式。

谢谢

更新：我不一定要寻找高性能和准确性，我只需要毫秒精度即可查看自上次检查以来已经过去了多少时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T00:33:23.170

您可以使用[`<chrono>`](http://en.cppreference.com/w/cpp/chrono)C++11 中添加的 ever so verbose 库。

它具有不同类型的时钟，具体取决于您的需求，`system_clock`它是唯一可以使用的时钟，`time_t`并且`high_resolution_clock`是具有最小刻度的时钟。

用它来计时事情相对简单，例如：

```
#include <iostream>
#include <chrono>

int main() {
    auto now = std::chrono::high_resolution_clock::now();
    //do stuff here
    auto then = std::chrono::high_resolution_clock::now();
    std::cout << std::chrono::duration_cast<std::chrono::milliseconds>(then-now).count();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T00:25:42.737

C++11 添加了标头`<chrono>`，它提供了一种标准化的方式来读取系统时间，其分辨率比旧的`localtime`. 然而，准确度因平台而异。

该`steady_clock`课程可能对您最有用。

# iphone - 为什么这是一个无限循环？

> ID：14783469
> 
> 赞同：0
> 
> 时间：2013-02-09T00:22:24.927
> 
> 标签：iphone, ios, ipad, uigesturerecognizer, infinite-loop

我在 UIView 的子视图中遇到手势识别问题。我的子视图是一个可通过 UIPanGestureRecognizer 拖动的视图 - 我知道这部分有效。但我*在首先接触到那个视图时*遇到了问题。触动的是我的 UIView - 而不是我希望他们去的子视图。我尝试使用以下代码将触摸强制重定向到我的目标视图：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    NSLog(@"rT");
    [self.valueLabel touchesBegan:touches withEvent:event];
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    NSLog(@"mT");
    [self.valueLabel touchesMoved:touches withEvent:event];
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    NSLog(@"eT");
    [self.valueLabel touchesEnded:touches withEvent:event];
} 
```

...但后来我的控制台发疯了 - 无限循环

```
...
2013-02-08 17:07:33.683 Totalizer[3810:907] rT
2013-02-08 17:07:33.684 Totalizer[3810:907] rT
2013-02-08 17:07:33.685 Totalizer[3810:907] rT
2013-02-08 17:07:33.686 Totalizer[3810:907] rT
2013-02-08 17:07:33.686 Totalizer[3810:907] rT
2013-02-08 17:07:33.687 Totalizer[3810:907] rT
2013-02-08 17:07:33.688 Totalizer[3810:907] rT
2013-02-08 17:07:33.689 Totalizer[3810:907] rT
2013-02-08 17:07:33.690 Totalizer[3810:907] rT
2013-02-08 17:07:33.691 Totalizer[3810:907] rT
2013-02-08 17:07:33.692 Totalizer[3810:907] rT
2013-02-08 17:07:33.692 Totalizer[3810:907] rT
2013-02-08 17:07:33.693 Totalizer[3810:907] rT
2013-02-08 17:07:33.694 Totalizer[3810:907] rT
2013-02-08 17:07:33.695 Totalizer[3810:907] rT
2013-02-08 17:07:33.696 Totalizer[3810:907] rT
2013-02-08 17:07:33.697 Totalizer[3810:907] rT
2013-02-08 17:07:33.698 Totalizer[3810:907] rT
2013-02-08 17:07:33.700 Totalizer[3810:907] rT
2013-02-08 17:07:33.701 Totalizer[3810:907] rT
2013-02-08 17:07:33.702 Totalizer[3810:907] rT
2013-02-08 17:07:33.703 Totalizer[3810:907] rT
2013-02-08 17:07:33.704 Totalizer[3810:907] rT
2013-02-08 17:07:33.705 Totalizer[3810:907] rT
2013-02-08 17:07:33.706 Totalizer[3810:907] rT
2013-02-08 17:07:33.707 Totalizer[3810:907] rT
2013-02-08 17:07:33.708 Totalizer[3810:907] rT
2013-02-08 17:07:33.709 Totalizer[3810:907] rT
2013-02-08 17:07:33.710 Totalizer[3810:907] rT
2013-02-08 17:07:33.711 Totalizer[3810:907] rT
2013-02-08 17:07:33.713 Totalizer[3810:907] rT
... 
```

我似乎无法弄清楚这一点。

任何事情都有帮助（在合理范围内......）

尔威软件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:30:02.443

您发布的代码进入循环，因为

`valueLabel`不响应`touchesBegan:`, `touchesMoved:`, 和`touchesEnded:`... 这调用会回溯到您的代码。

这是一个无意的递归循环。

绝对放弃这种方法。你试过`valueLabel.userInteractionEnabled = YES`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:30:09.643

您的触摸被转发到 self.label 的 superview，即 self。这导致了无限递归。

# php - 在 PHP 中阻止图像主机的隐写术？

> ID：14783472
> 
> 赞同：3
> 
> 时间：2013-02-09T00:22:38.663
> 
> 标签：php, steganography

我正在创建一个图像主机，但想避免人们在他们上传的图像中嵌入隐藏的图像和文件，因为我看不到隐藏的图像，因此无法监控它们。

我听说有人在一些图像主机上使用隐写术，我想知道我将如何阻止或阻止人们使用它？

顺便说一句，我需要它来支持动画 gif 并且图像质量必须保持原始图像的质量？

我该怎么做呢？因为有人可以在图像中嵌入非法/禁止的文件或图像，而我不知道发生了什么。我见过一些情况，用户必须下载图像，然后将扩展名重命名为 .rar 或其他东西才能访问嵌入在图像中的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T14:04:33.120

你必须检测隐写术吗？由于隐写术可以使用最低位来存储数据而不显示在图像上，所以你不能翻转某些颜色的最低位吗？它不应该改变实际图像中的任何内容，但会混淆任何隐藏的信息

# c++ - 在 Ubuntu 上缺少与 MinGW 的标头依赖项

> ID：14783475
> 
> 赞同：2
> 
> 时间：2013-02-09T00:22:59.660
> 
> 标签：c++, linux, windows, mingw, cross-compiling

我正在尝试从我的 Ubuntu 笔记本电脑上设置一个交叉编译器，以便我可以为 Windows 编译命令行程序。到目前为止，我已经用 g++ 编译了我需要的所有库，所以我想做同样的事情来生成等效的 Windows 二进制文件。

我已经通过 apt-get 安装了 gcc-mingw，它安装了许多二进制文件。`i686-w64-mingw32-g++`我已经使用二进制文件成功地为 Windows 编译了一个“Hello World”程序。

但是，我在编译更复杂的项目时遇到了一些问题。我注意到这个二进制文件包含与标准 g++ 不同的文件夹，它找不到依赖项（例如，boost headers、bits/predefs.h 等）。有没有办法设置 mingw 参数，以便它像 g++ 一样开箱即用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T12:47:18.357

我发现了问题。我使用的 Boost 库是我通过 apt-get 安装的。显然，这意味着许多`#if defined (__GLIBC__)`人自动转换为`#if 1`. 这导致包含一些非跨平台的头文件。从网站下载库并使用它解决了这个问题。

# html - 网站的 CSS 边框

> ID：14783483
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:23:38.577
> 
> 标签：html, css

嘿，我正在制作一个个人网站来开始展示我的作品，但出现了浏览器兼容性错误。

我有三个使用蓝图框架的容器（侧边栏、标题和内容）。侧边栏的右侧我有一个边框，标题的底部也是如此。问题是标题的边框没有出现，我不知道为什么。

您可以在 jaredsmith.se 上查看该站点并查看源代码，据我所知，它似乎只适用于 Safari，但似乎不适用于 Chrome 和 Firefox。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:28:31.263

在“2px”中的 2 之后有一个空格。删除它，边框就会出现。

```
#header {
  border-bottom : 2px solid black;
  margin-bottom : 5%;
} 
```

此外，您的文档类型中有一个错字。这会导致 IE 使用怪癖模式。

更改`<DOCTYPE html>`为`<!doctype html>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:29:06.387

在`style.css`第 30 行：

`border-bottom: 2 px solid black;`是无效的。改成`border-bottom: 2px solid black;`

# github - GitHub wiki 选择 GitHub 上显示的分支

> ID：14783486
> 
> 赞同：11
> 
> 时间：2013-02-09T00:23:53.993
> 
> 标签：github, wiki

是否可以配置 GitHub wiki 中的哪个分支默认显示在 GitHub 上。例如，如果我在本地克隆 GitHub wiki，然后创建、提交并将新分支推送回 GitHub，是否可以将 GitHub 配置为默认显示该新分支？

从我的测试来看，似乎 GitHub 默认只显示 master 中的任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-25T08:36:14.053

**它不是。** 引用[Github 帮助](https://help.github.com/articles/adding-and-editing-wiki-pages-locally/#cloning-wikis-locally-to-your-computer)：

> 您和您的协作者在处理 wiki 时可以创建分支，但**只有推送到主分支的更改才会生效**并可供您的读者使用。

# php - 是否可以阻止 php 脚本在 img src 标签中运行？

> ID：14783487
> 
> 赞同：0
> 
> 时间：2013-02-09T00:23:55.530
> 
> 标签：php, security

是否可以阻止 php 脚本在`img src`标签中运行？

如果以这种方式在网页上调用来自[http://example.com/page.php](http://example.com/page.php)的脚本，我不希望执行该脚本：

```
<img src="http://example.com/page.php"> 
```

我希望它仅在直接打开页面或用户单击该页面上的链接时运行，因此阻止引荐来源网址不是解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:27:49.563

是的，可以使用[accept 标头来](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)做到这一点，但是**个人用户可以绕过**保护。当浏览器正在下载图像时，它会发送预期数据的标题 - 例如`Accept: image/png,image/*;q=0.8,*/*;q=0.5`
但这当然不能依赖，因为任何用户都可以**关闭此标题，**并且任何浏览器都可能碰巧**不发送此标题**。
在这里，您可以阅读有关[http Accept header 兼容性的](http://www.gethifi.com/blog/browser-rest-http-accept-headers)文章。

~~另一个有用的标题可能是`Referer`标题。此标头告诉您调用此请求的站点（该站点上的图像、站点上的 CSS 或仅来自该站点的链接）。规则是相同的 - 大多数用户会发送标头，但有些可能会关闭它。
许多人已经安装了插件来阻止引荐来源标头以增加他们的隐私。~~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:43:46.747

不，没有办法阻止 PHP 脚本在图像标签中运行。

但是，一旦脚本运行，您就可以根据标头发回不同的内容。因为可以修改标头，所以这不是防止任何事情的可靠方法。

`img`不过，在标签中运行脚本应该不是问题。一旦浏览器发现内容不是图像，它就会简单地丢弃它而不做任何事情（或者它可能会显示某种错误）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T01:28:10.080

我做了一个小测试。如果您将内容类型刷新为 text/html（可能还有除图像以外的任何内容），Firefox 和 IE 似乎将停止等待完整的回复。但我看不到他们断开了连接。然而，Chrome 等待整个页面。

因此，如果浏览器没有断开连接或者 PHP 无法检测到它，您似乎无论如何都必须渲染整个页面。而且您必须尽早决定所有标题设置。所以这不值得。

框架测试.html

```
<html>
<head>
    <title>Frame test</title>
</head>
<body>
    <h1>Frame test</h1>
    <p>The following frame is not to be displayed in frames!</p>
    <img src="frametest.php"/>
</body>
</html> 
```

框架测试.php

```
<?php
header('Content-Type: text/html');
echo " ";

flush();

sleep(3);
echo " \r\n ";
flush();
$aborted = (connection_aborted() ? 'yes' : 'no');
$status = (connection_status() ? 'yes' : 'no');

$temp = mail('your@email.here', 'Frametest', 'Client Aborted: ' . $aborted . ' Status: ' . $status);

?>

<html>
<head>
<title>test</title>
</head>
<body>
<h1>Test</h1>
<p>Not to be displayed in frames!</p>
<p>Mail ok? <?php echo ($temp ? 'Yes' : 'No'); ?> </p>
</body>
</html> 
```

# pypy - 用于重新分发的 PyPy 清理

> ID：14783493
> 
> 赞同：0
> 
> 时间：2013-02-09T00:24:51.877
> 
> 标签：pypy

如何在构建 PyPy 后清理它？哪些部分是绝对关键的，哪些部分可以安全删除？

显然有必要删除所有与版本控制相关的文件和文件夹（`.gitignore`, `.hg`, `.hgignore`, `.hgsubstate`, `.hgtags`），但必须有更多目录可以轻松删除。

提示：[http](http://doc.pypy.org/) : //doc.pypy.org/ 上有所有目录的描述，它可能会有所帮助，但不幸的是我现在找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T19:23:10.267

在 PyPy 团队中，我们使用以下脚本：

```
cd pypy/tool/release
./package.py ../../.. pypy-VERSION-PLATFORM 
```

它将结果放在 /tmp/usession-YOURNAME/build/ 中。这是安装或重新分发二进制文件所需的所有内容的完整副本。

# php - 在 apach2 本地 mac 上设置多个虚拟主机

> ID：14783495
> 
> 赞同：3
> 
> 时间：2013-02-09T00:25:06.167
> 
> 标签：php, apache2, virtualhost

我正在尝试在我的本地 apache2 服务器上设置多个虚拟主机。我的目标是能够在浏览器中为我的 Zend 项目访问“zf2-tutorial.localhost”，然后为我的 Symfony 项目访问“symfony.localhost”。现在，无论我转到“zf2-tutorial.localhost”还是“symfony.localhost”，我的 Zend 项目都会得到服务。这是我的 http.conf 文件的一部分

```
<VirtualHost *:80>
    ServerName zf2-tutorial.localhost
    DocumentRoot /Users/myusername/Sites/Zend/public
    SetEnv APPLICATION_ENV "development"
    <Directory /Users/myusername/Sites/Zend/public>
        DirectoryIndex index.php
        AllowOverride All
        Order allow,deny
        Allow from all
        Options Indexes FollowSymLinks
    </Directory>
</VirtualHost>

<VirtualHost *:80>
    ServerName symfony.localhost
    DocumentRoot /Users/myusername/Sites/symfony
    SetEnv APPLICATION_ENV "development"
    ServerAlias www.symfony.localhost
</VirtualHost> 
```

我的“主机”文件以这两行结尾

```
127.0.0.1 zf2-tutorial.localhost localhost
127.0.0.1 symfony.localhost localhost 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:38:11.797

如果您在[2.3.11](http://httpd.apache.org/docs/2.4/mod/core.html#namevirtualhost)版本之前运行 Apache ，那么您忘记使用[NameVirtualHost](http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost)指令。

```
NameVirtualHost *:80 
```

您还应该阅读[2.2](http://httpd.apache.org/docs/2.2/vhosts/)或[2.4](http://httpd.apache.org/docs/2.4/vhosts/)版的 Apache Virtual Host 文档。

# mongodb - 多次请求后，MongoDB + Nodejs 数据获取失败

> ID：14783499
> 
> 赞同：1
> 
> 时间：2013-02-09T00:25:40.950
> 
> 标签：mongodb

我以每分钟约 30,000 个请求达到 mongodb 端点。在 20,000 个请求之前，一切似乎都可以正常工作，之后所有请求都失败了

> t [对象对象]。(/home/ubuntu/node_modules/mongodb/lib/mongodb/connection/server.js:530:7) 在 [object Object].emit (events.js:88:20) 在 [object Object]。(/home/ubuntu/node_modules/mongodb/lib/mongodb/connection/connection_pool.js:104:15) 在 [object Object].emit (events.js:70:17) 在 Socket。(/home/ubuntu/node_modules/mongodb/lib/mongodb/connection/connection.js:411:10) 在 Array.0 (net.js:319:25) 的 Socket.emit (events.js:67:17)在 EventEmitter._tickCallback (node.js:192:41)

每次迭代关闭数据库连接，仅供参考，我每次都连接到多个数据库。

再次重复相同的过程会产生相同的后果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:37:22.627

这通常是服务器上的 ulimit 问题，因为您打开了太多连接，但您需要查看 mongod/mongos 日志以确定。如果是这种情况，您将看到有关无法分配资源和/或创建新线程的错误。有关如何解决此问题，请查看此处：

[http://docs.mongodb.org/manual/administration/ulimit/](http://docs.mongodb.org/manual/administration/ulimit/)

此外，根据您使用的驱动程序关闭连接可能是一个非常糟糕的主意，并且可能是问题的根本原因（特别是如果您适当地设置了 ulimits）。现在的大多数驱动程序，包括我相信的节点都有一个连接池，可以适当地管理连接并允许重用。通过明确关闭它们，您实际上可能会在短期内导致旧连接建立。

# web-services - Filezilla root 访问 aws ubuntu 实例

> ID：14783500
> 
> 赞同：0
> 
> 时间：2013-02-09T00:25:41.470
> 
> 标签：web-services, amazon-web-services, filezilla

我刚刚在 Amanzon 上设置了一个 aws ubuntu 实例。我正在尝试在我的 apache 服务器文件夹（/var/www/）上使用 filezilla 上传/创建新文件，但我只能访问“/home/ubuntu/”。有没有办法通过filezilla访问其他文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:30:40.587

是的，但据我所知，您必须先登录 SSH 才能创建/编辑文件夹并更改所有者或组权限，然后才能使用 FileZilla 执行任何操作。

# javascript - 按用户和标签搜索 Instagram

> ID：14783502
> 
> 赞同：0
> 
> 时间：2013-02-09T00:25:44.387
> 
> 标签：javascript, jquery, instagram

有谁知道这是可能的吗？我有一个使用 Instagram RSS 提要搜索特定主题标签的脚本。然后，我根据特定用户过滤这些图像`credit.content`物品。除了一件事之外，一切都很好 - Instagram 仅提供对 20 张图像的访问，如果特定用户的图像不在所选标签的最近 20 张图像中，则结果为空。唯一的选择似乎是设置一个脚本首先由用户搜索 - 然后解析结果以匹配特定标签。不幸的是，没有与标签搜索 RSS 等效的用户搜索 RSS，所以它回到了 API。如何设置搜索（我可以随时更改用户）然后搜索特定标签的结果？我应该补充一点，我不想只为我这样做 - 我希望能够进行设置，以便我网站的用户可以简单地输入他们自己的 Instagram 用户 ID 和选择的主题标签，然后显示他们自己的图像。

我无权访问任何服务器脚本，所以如果可能的话，我更愿意在 javascript/jquery 中完成所有客户端。

感谢您的任何建议。

# ajax - jQuery单击时将数据保存在数组中？

> ID：14783503
> 
> 赞同：1
> 
> 时间：2013-02-09T00:25:52.640
> 
> 标签：ajax, arrays, jquery, multidimensional-array

我想使用基于点击的 jquery 将数据保存在数组（或任何最佳方法）中。我已经设置了 jquery，其中用户只能单击 2 个元素（`<div>`标签），如果他们想选择其他东西，他们需要取消选择他们选择的元素之一。这些元素在我要存储的标签中具有“data-id=”。

如何仅为选定的项目保存数据 ID。这是否意味着如果用户取消选择，需要删除数组中的数据（或首选哪种最佳方法）？

```
$('.media-search').hover(function(){
    var $this = $(this);
    var dataid = $this.data('id');
    $this.toggleClass('highlight');
}).click(function(){
if($('.selectMedia').length < 2 || $(this).hasClass('selectMedia'))
{
    $(this).toggleClass('selectMedia');
}else{

    alert('need to unselect item')      

}
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-21T20:34:25.650

我不确定我是否理解你，但我的解决方案是

```
var dataIds = new Array();

$('.media-search').click(function(){
 if($(this).hasClass('selectMedia')){
  $(this).removeClass('selectMedia');
  dataIds.splice(dataIds.indexOf($this.data('id')),1); 
 }else{
  if(dataIds.leght==2){
   $(this).addClass('selectMedia');
   dataIds.push($this.data('id'));
  }else{
   alert("only 2 items");
  }
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T20:06:55.937

我不是 100% 确定这是您要求的，但是如果您需要一个数组，您可以在任何时候使用此函数并将其存储在一个变量中：

```
function getArray() {
    var data = [],
        media = $('.selectMedia');

    for(var i = 0; i < media.length; i++) {
        data[i] = media.eq(i).attr("data-id");
    }

    return data;
} 
```

我的建议是在切换类**后**`click`在函数中使用此函数。

 **另外，我注意到您在方法`dataid`内部声明`hover`，并且该变量将不再存在于方法外部，即一旦您完成悬停，该值现在超出范围。因此，如果您确实声明了一个数组来存储此方法的结果，请在任何事件处理程序**之外**执行它，以便它保持在范围内。**

# python - sqlalchemy 和 postgresql 的编码错误

> ID：14783505
> 
> 赞同：20
> 
> 时间：2013-02-09T00:26:15.433
> 
> 标签：python, postgresql, encoding, sqlalchemy

我将金字塔用于具有 postgres 数据库、wtforms、sqlalchemy 和 jinja2 的 Web 应用程序，当应用程序尝试从数据库中获取问题类型以使用 wtforms 填充选择字段时出现此错误：

```
Error: 'ascii' codec can't decode byte 0xc3 in position 5: ordinal not in range(128) 
```

这是model.py中的问题类型表：

```
class Mixin(object):
    id = Column(Integer, primary_key=True, autoincrement=True)
    created = Column(DateTime())
    modified = Column(DateTime())

    __table_args__ = {
        'mysql_engine': 'InnoDB',
        'mysql_charset': 'utf8'
    }
    __mapper_args__ = {'extension': BaseExtension()}

class IssueType(Mixin, Base):
    __tablename__ = "ma_issue_types"
    name = Column(Unicode(40), nullable=False)

    def __init__(self, name):
        self.name = name 
```

进入 bd 我有这个：

```
# select name from ma_issue_types where id = 3;
name    
------------
Teléfono 
```

这是发生错误的部分

```
# -*- coding: utf-8 -*-

from issuemall.models import DBSession, IssueType

class IssueTypeDao(object):

    def getAll(self):
        dbsession = DBSession()
        return dbsession.query(IssueType).all() #HERE THROWS THE ERROR 
```

这是回溯

```
Traceback (most recent call last):
  File "/issueMall/issuemall/controller/issueRegisterController.py", line 16, in issue_register
    form = IssueRegisterForm(request.POST)
  File "/env/lib/python2.7/site-packages/wtforms/form.py", line 178, in __call__
    return type.__call__(cls, *args, **kwargs)
  File "/env/lib/python2.7/site-packages/wtforms/form.py", line 224, in __init__
    super(Form, self).__init__(self._unbound_fields, prefix=prefix)
  File "/env/lib/python2.7/site-packages/wtforms/form.py", line 39, in __init__
    field = unbound_field.bind(form=self, name=name, prefix=prefix, translations=translations)
  File "/env/lib/python2.7/site-packages/wtforms/fields/core.py", line 301, in bind
    return self.field_class(_form=form, _prefix=prefix, _name=name, _translations=translations, *self.args, **dict(self.kwargs, **kwargs))
  File "/issueMall/issuemall/form/generalForm.py", line 11, in __init__
    types = issueTypeDao.getAll()
  File "/issueMall/issuemall/dao/master/issueTypeDao.py", line 11, in getAll
    return self.__dbsession.query(IssueType).all()
  File "build/bdist.linux-x86_64/egg/sqlalchemy/orm/query.py", line 2115, in all
    return list(self)
  File "build/bdist.linux-x86_64/egg/sqlalchemy/orm/query.py", line 2341, in instances
    fetch = cursor.fetchall()
  File "build/bdist.linux-x86_64/egg/sqlalchemy/engine/base.py", line 3205, in fetchall
    l = self.process_rows(self._fetchall_impl())
  File "build/bdist.linux-x86_64/egg/sqlalchemy/engine/base.py", line 3172, in _fetchall_impl
    return self.cursor.fetchall()
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 5: ordinal not in range(128) 
```

我试试这个，但它不能 [作为 python 中的默认编码使用 ascii](http://community.webfaction.com/questions/2609/ascii-as-default-encoding-in-python)

我尝试这样的事情，但没有奏效

[gae python ascii编解码器无法解码字节](https://stackoverflow.com/questions/11789770/gae-python-ascii-codec-cant-decode-byte)

```
return dbsession.query(IssueType.id, IssueType.name.encode('utf-8')).all() #or decode('utf-8') 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-02-09T13:43:21.847

您需要配置 Psycopg2 的客户端编码。请参阅[SQLAlchemy 文档](http://docs.sqlalchemy.org/en/latest/dialects/postgresql.html#unicode)：

> 默认情况下，psycopg2 驱动程序使用`psycopg2.extensions.UNICODE`扩展，以便 DBAPI 直接接收和返回所有字符串作为 Python Unicode 对象 - SQLAlchemy 传递这些值而不做任何更改。此处的 Psycopg2 将根据当前的“客户端编码”设置对字符串值进行编码/解码；默认情况下，这是`postgresql.conf`文件中的值，通常默认为`SQL_ASCII`. 通常，这可以更改为`utf-8`，作为更有用的默认值：
> 
> ```
> #client_encoding = sql_ascii # actually, defaults to database
>                              # encoding
> client_encoding = utf8 
> ```
> 
> 影响客户端编码的第二种方法是在本地 Psycopg2 中设置它。SQLAlchemy 将根据传递给使用参数的值在所有新连接上调用 psycopg2 的`set_client_encoding()`方法（参见：http: [//initd.org/psycopg/docs/connection.html#connection.set_client_encoding ）：](http://initd.org/psycopg/docs/connection.html#connection.set_client_encoding)`create_engine()``client_encoding`
> 
> ```
> engine = create_engine("postgresql://user:pass@host/dbname", client_encoding='utf8') 
> ```
> 
> 这会覆盖 Postgresql 客户端配置中指定的编码。

该`client_encoding`参数可以指定为引擎 URL 中的查询字符串：

```
 postgresql://user:pass@host/dbname?client_encoding=utf8 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-08T09:42:31.097

我使用mysql并像这样设置字符集。这个对我有用。

```
from sqlalchemy import create_engine
from sqlalchemy.engine.url import URL

db_url = {
    'database': 'db_name',
    'drivername': 'mysql',
    'username': 'username',
    'password': 'mypassword',
    'host': '127.0.0.1',
    'query': {'charset': 'utf8'},
}

engine = create_engine(URL(**db_url), encoding="utf8") 
```

# sql - 如何计算和组合两个查询

> ID：14783510
> 
> 赞同：0
> 
> 时间：2013-02-09T00:26:39.860
> 
> 标签：sql, sql-server

我正在使用此查询进行组合和计数。有时它有效，有时它不。个别查询有时不相等。这里有什么做错了吗？有没有更好/更简单的方法来做到这一点？提前致谢。

```
SELECT   CONVERT(VarChar(8), End_Date, 112)as End_Date,count(*) as Qty, 'LPFG' as     Wc_Code 
FROM
(
 (SELECT  dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr, Demand_Order_Line_Nbr,
CONVERT(VARCHAR(8), min(dimdbmc.dbo.t_Allocation_Event.Row_Insert_Datetime), 112) as     End_Date
FROM dimdbmc.dbo.t_Allocation_Event INNER JOIN dimdbmc.dbo.t_Demand_Order ON    (dimdbmc.dbo.t_Allocation_Event.MMM_Facility_Code = dimdbmc.dbo.t_Demand_Order.MMM_Facility_Code) AND (dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr = dimdbmc.dbo.t_Demand_Order.Demand_Order_Nbr)
WHERE (((dimdbmc.dbo.t_Allocation_Event.MMM_Facility_Code)='MC') 
AND ((dimdbmc.dbo.t_Allocation_Event.Event_Type_Code)='Allocate') 
AND dimdbmc.dbo.t_demand_order.demand_order_type_code IN  ( 'COMS-SMPNO') 
AND ((dimdbmc.dbo.t_Allocation_Event.Row_Insert_Datetime)>= '8/01/2012'))
Group by
dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr,    dimdbmc.dbo.t_Allocation_Event.Demand_Order_Line_Nbr)
 UNION ALL

(SELECT  dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr, Demand_Order_Line_Nbr,
CONVERT(VARCHAR(8), min(dimdbmc.dbo.t_Allocation_Event.Row_Insert_Datetime), 112) as    End_Date
FROM dimdbmc.dbo.t_Allocation_Event INNER JOIN dimdbmc.dbo.t_Demand_Order ON    (dimdbmc.dbo.t_Allocation_Event.MMM_Facility_Code = dimdbmc.dbo.t_Demand_Order.MMM_Facility_Code) AND (dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr = dimdbmc.dbo.t_Demand_Order.Demand_Order_Nbr)
WHERE (((dimdbmc.dbo.t_Allocation_Event.MMM_Facility_Code)='MC') 
AND ((dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr) Is Not Null) 
AND ((dimdbmc.dbo.t_Allocation_Event.Event_Type_Code)='Allocate') 
AND substring(dimdbmc.dbo.t_Demand_Order.Demand_Order_Nbr, 8, 1) <>'_'  
AND dimdbmc.dbo.t_demand_order.demand_order_type_code IN  ( 'COMS-CUST','COMS-   GOVT','COMS-INTL') 
AND ((dimdbmc.dbo.t_Demand_Order.Charge_To_Customer_Nbr)='WHP4101')
AND ((dimdbmc.dbo.t_Allocation_Event.Row_Insert_Datetime)>= '8/01/2012'))
Group by
dimdbmc.dbo.t_Allocation_Event.Demand_Order_Nbr,dimdbmc.dbo.t_Allocation_Event.Demand_Order_Line_Nbr
)

)as a

 group by End_Date
order by End_Date 
```

# python - 使用 pyodbc 损坏的结果集

> ID：14783516
> 
> 赞同：2
> 
> 时间：2013-02-09T00:27:48.303
> 
> 标签：python, pyodbc

Python 2.6 版 pyodbc 3.0.6 版

Python 代码示例：#!/usr/bin/python26

```
import pyodbc
import os
import sys

SQL = sys.argv[1];

conn = pyodbc.connect('DSN=VerticaDSN')
cursor = conn.cursor()

cursor.execute(SQL)
rows = cursor.fetchall()
for row in rows:
   print row[0] 
```

python 不是按表格中的原样打印数据，而是输出损坏的数据，仅输出部分数据，例如

```
ps
t Foods
smart
ly Dollar
enney
ean
rd 
```

预期结果集：

```
Ames
Ukrops
Giant Foods
Cardsmart
Aco
Family Dollar
JC Penney
Eckerd 
```

为什么结果集被破坏？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:36:01.473

问题可能不在ODBC 驱动程序本身，`pyodbc`而在 ODBC 驱动程序本身。这里有几件事可以尝试：

*   尝试将列转换为另一种数据类型（不确定您使用的是什么数据库，但该列可能是 Unicode，并且驱动程序只能理解 ASCII 或其他方式；我倾向于认为这是问题所在）
*   如果可用，请为您的数据库使用专门的 python 客户端而不是 ODBC（如`cx_Oracle`, `psycopg2`）
*   查看 ODBC 驱动程序配置参数
*   安装来自不同供应商的 ODBC 驱动程序

# php - PHP：在第三个字符上爆炸

> ID：14783521
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:28:47.003
> 
> 标签：php, explode

我有一个问题，我`dirname($_SERVER['PHP_SELF']);`用来获取当前页面的 url，我最终得到了这个`/clients/sherloc_media/install`，我试图用这个`explode()`来获取这个`/clients/sherloc_media`我需要这个用于 1 个变量，然后我需要`sherloc_media`另一个，我一直在尝试这在过去几个小时内，因为`/clients/sherloc_media`我将用作`$root`变量，

不知何故，我最终得到了这样的链接`http://localhost/clients/sherloc_media/operate/opertate/index.php`

当它应该是`http://localhost/clients/sherloc_media/opertate/index.php`

任何帮助都会非常感谢，我没有任何用于获取错误结果的代码，因为我一直在删除并重新开始，你知道破解，干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:32:05.557

多种方式之一：

```
$firstPart = substr(rtrim($path, '/'), 0, strrpos($path, '/')); 
```

或者，如果您更喜欢爆炸：

```
$parts = explode('/', trim($path, '/'));
$firstPart = $parts[0] . '/' . $parts[1]; 
```

# c# - 如何强制应用程序仅使用 c# 中指定路径中的库？

> ID：14783522
> 
> 赞同：0
> 
> 时间：2013-02-09T00:28:58.983
> 
> 标签：c#, .net, dll

我有一些用 C# 编写的简单控制台应用程序（使用 VS2008）。

在这个应用程序中，我想检查某个库的当前版本。我有库的路径，但是当我用其他库替换库（我将第一个库移动到其他目录）时，我的应用程序仍然“查看”第一个库，而不是“查看”给定路径中的库。

代码如下所示：

```
private void Sth()
{
   Assembly assembly = Assembly.LoadFrom(libPath);
   Version ver = assembly.GetName().Version;
} 
```

我每隔一段时间都会调用这个方法（所以程序集应该正确加载文件）。

因此，当我启动我的应用程序并且给定路径中的库版本为 1.0.0.0 时，我的应用程序会正确显示它。但是当我用新的（版本 2.0.0.0）替换库文件时，我的应用程序仍然显示 1.0.0.0。但是当我关闭我的应用程序并再次运行它时，它将正确显示 2.0.0.0。

为什么会这样？

最好的祝愿，皮特。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:32:12.533

程序集只加载一次。在执行期间交换 dll 不会更改加载的版本。每次执行该程序集中的某些代码行时，应用程序都不会转到该路径。整个事情被加载到内存中，然后路径（以及那里发生的事情）不再相关。关闭应用程序并重新启动后，它会转到该文件夹​​并加载您在那里拥有的任何程序集，以便您获得 v2。

据我了解，在执行过程中无法更改程序集。这[如何为 .NET 应用程序域重新加载程序集？](https://stackoverflow.com/questions/1024072/how-to-reload-an-assembly-for-a-net-application-domain)问题讨论了它，最重要的答案说你不能卸载程序集。

编辑：

```
 var assemblyInfo = AssemblyName.GetAssemblyName(pathToMyAssembly); //get assembly
 Version assemblyVersion = assemblyInfo.Version; // get version
 Version minVersion = new Version(1, 1, 4); // minimum version of 1.1.4
 if (minVersion.CompareTo(assemblyVersion) < 0)
       // the version is less than the minimum.
       // do something to reconcile problem 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T23:59:27.060

查看您对 evanmcdonnal 答案的评论，您需要在不加载程序集的情况下确定程序集的版本。您可以（我什至认为您应该）使用[AssemblyName.GetAssemblyName 方法](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyname.getassemblyname.aspx)，该方法完全符合您的需要：检索程序集的名称，而不是加载它。

我已经快速测试了该方法，并且在我替换了 dll 文件后它成功地显示了正确的输出。

```
var initialName = AssemblyName.GetAssemblyName("Foo.dll");
Console.WriteLine(initialName);
Console.WriteLine(initialName.Version);
// replaced the dll manually

initialName = AssemblyName.GetAssemblyName("Foo.dll");
Console.WriteLine(initialName);
Console.WriteLine(initialName.Version); 
```

希望它有所帮助，伊万。

# javascript - 一个脚本工作，但另一个不工作

> ID：14783527
> 
> 赞同：1
> 
> 时间：2013-02-09T00:29:29.437
> 
> 标签：javascript, jquery, jquery-ui, javascript-framework, jquery-events

我打算使用两个不同的 JavaScript 文件，一个用于桌面屏幕，另一个用于 iPhone 屏幕。

我使用它的原因是因为我需要减小立方体的大小。在桌面浏览器中一切正常。但是，当我减小浏览器大小时，立方体没有出现。

这是两个不同的JS文件：

我在控制台中看不到与这些脚本相关的任何错误。

这是问题的一个[小提琴](http://jsfiddle.net/RH4HD/)。

```
$(window).bind('resize', function() { location.reload();

     Gallery.setOptions({
            size: 78,
            lightbox: false,
            //animation:  'drop'
            //speed:      500,
            //closeOnEsc: true,
            //slideshow:  false,
            //slideshow_speed: 3000,
            //cube_speed: 1000
        });

 })

$(window).bind('resize', function() { location.reload();

     iphGallery.setOptions({
            size: 78,
            lightbox: false,
            //animation:  'drop'
            //speed:      500,
            //closeOnEsc: true,
            //slideshow:  false,
            //slideshow_speed: 3000,
            //cube_speed: 1000
        });

 }

) 
```

# backbone.js - 使用 Backbone 的实时 D3 时间序列——图形的移动速度比轴慢

> ID：14783528
> 
> 赞同：3
> 
> 时间：2013-02-09T00:29:36.163
> 
> 标签：backbone.js, d3.js

我正在尝试使用 D3 和 Backbone 构建实时时间序列。我遇到的问题是图形的移动速度比 x 轴慢。x 轴准确地跟上当前时间，所以我知道这是图形线的问题。我的代码基于 Mike Bostock 的[这个](http://bost.ocks.org/mike/path/)示例（帖子底部的最后一张图）。我似乎找不到问题——我的代码紧跟示例，只是用 Backbone 实现的。

该应用程序设置有 websocket 和事件聚合器，以便在接收到新数据点时，将数据点的模型添加到集合中，并且添加模型会触发“TimeseriesView”视图中的函数“newPoint”。“newPoint”将一个数字推送到一个数组“data”，这就是图形线数据的来源。以下是相关观点。（如果代码有点混乱，请原谅——我是 Backbone 的新手，所以我怀疑有一种更清洁的方法可以做到这一点）

```
TimeseriesView = Backbone.View.extend({
    el: "#timeseries",
    initialize: function (options) {
        var self = this;
        /*
         * Create timeseries
         */
        self.n = 243;
        self.duration = 750;
        self.now = new Date(Date.now() - self.duration);
        self.data = d3.range(self.n).map(function() { return 0; });

        self.margin = { top: 6, right: 0, bottom: 20, left: 40};
        self.width = 960 - self.margin.right;
        self.height = 120 - self.margin.top - self.margin.bottom;

        self.x = d3.time.scale()
            .domain([self.now - (self.n-2) * self.duration, self.now - self.duration])
            .range([0, self.width]);

        self.y = d3.scale.linear()
            .range([self.height, 0]);

        var x = self.x;
        var y = self.y;
        var now = self.now;
        var duration = self.duration;
        var n = self.n;
        var height = self.height;
        var width = self.width;
        var margin = self.margin;

        self.line = d3.svg.line()
            .x(function(d, i) { return x(now - (n - 1 - i) * duration); })
            .y(function(d, i) { return y(d); });

        var timeseries = d3.select("#timeseries").append("p").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
          .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

        timeseries.append("defs").append("clipPath")
            .attr("id", "clip")
          .append("rect")
            .attr("width", width)
            .attr("height", height);

        self.x.axis = d3.svg.axis().scale(x).orient("bottom");

        self.axis = timeseries.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + height + ")")
            .call(x.axis);

        self.path = timeseries.append("g")
            .attr("clip-path", "url(#clip)")
          .append("path")
            .data([self.data])
            .attr("class", "line");

        self.dataSet = options.dataSet;
        self.dataSet.on('add', this.newPoint, this);
    },
    newPoint: function (pt, context) {
        var self = this;
        if (isNaN(parseFloat(pt.attributes.auth_amt))) return;
        self.data.push(parseFloat(pt.attributes.auth_amt));

        self.now = new Date();

        var now = self.now;
        var duration = self.duration;
        var n = self.n;
        var x = self.x;
        var y = self.y;
        var width = this.width;
        var height = this.height;
        console.log('self', self);
        x.axis = d3.svg.axis().scale(x).orient("bottom");

        // update the domains
        self.x.domain([now - (n - 2) * duration,
                now - duration]);
        self.y.domain([0, d3.max(self.data)]); 

        self.line = d3.svg.line()
            .x(function(d, i) {
                return x(now - (n - 1 - i) * duration); })
            .y(function(d, i) { return y(d); });

        // redraw the line
        d3.select(".line")
            .attr("d", self.line)
            .attr("transform", null);

        // slide the x-axis to the left
        self.axis.transition()
            .duration(duration)
            .ease("linear")
            .call(x.axis);

        self.x = d3.time.scale()
            .domain([now - (n-2) * duration, now - duration])
            .range([0, width]);

        var x = self.x;

        // slide the line left
        self.path.transition()
            .duration(duration)
            .ease("linear")
            .attr("transform", "translate(" +  x(now - (n - 1) * duration) + ")");

        // pop the old dat point off the front
        self.data.shift();
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T16:20:42.063

您基于代码的示例深深地交织在一起滑动 x 轴和添加数据。当您像示例中那样轮询某些内容时，它可以正常工作，而不是像我认为在您的 websocket 设置中那样以不同的时间间隔或随机到达的数据（请参阅[http://jsfiddle.net/K8rub/1/](http://jsfiddle.net/K8rub/1/)获取希望准确复制您的代码）

首先要做的是将滑动（`tick`函数）和数据注入分开：http: [//jsfiddle.net/K8rub/2/](http://jsfiddle.net/K8rub/2/)：每个数据都有一个时间戳，用于提取x值，数据最初是为空，`tick`仅滑动图形。

将这些修改应用于您的代码，我们得到

```
TimeseriesView = Backbone.View.extend({

    initialize: function (options) {
        _.bindAll(this, 'tick');

       // ...

        self.dataSet = options.dataSet;
        self.dataSet.on('add', this.newPoint, this);
        self.tick();
    },

    newPoint: function(model) {
        this.data.push(model);
    },

    tick: function () {
        var self = this;
        self.now = new Date();

        var now = self.now;
        var duration = self.duration;
        var n = self.n;
        var x = self.x;
        var y = self.y;
        var width = this.width;
        var height = this.height;

        x.axis = d3.svg.axis().scale(x).orient("bottom");

        // update the domains
        self.x.domain([now - (n - 2) * duration,
                now - duration]);
        self.y.domain([0, d3.max(self.dataSet.pluck('auth_amt'))]); 

        self.line = d3.svg.line()
            .x(function(d) { return x(d.get('stamp')); })
            .y(function(d) { return y(d.get('auth_amt')); });

        // redraw the line
        d3.select(".line")
            .attr("d", self.line)
            .attr("transform", null);

        // slide the x-axis to the left
        self.axis.transition()
            .duration(duration)
            .ease("linear")
            .call(x.axis);

        self.x = d3.time.scale()
            .domain([now - (n-2) * duration, now - duration])
            .range([0, width]);

        var x = self.x;

        // slide the line left
        self.path.transition()
            .duration(duration)
            .ease("linear")
            .attr("transform", "translate(" +  x(now - (n - 1) * duration) + ")")
            .each("end", self.tick);
    }
}); 
```

[http://jsfiddle.net/K8rub/4/](http://jsfiddle.net/K8rub/4/)

# recursion - 递归函数 - 参数值在某个值之后不更新

> ID：14783535
> 
> 赞同：0
> 
> 时间：2013-02-09T00:30:14.837
> 
> 标签：recursion

我写了一个递归函数，指向整数的指针作为参数传递。该整数值在函数中递增，但我面临一个奇怪的问题，即在某个值之后它的值永远不会更新。即使我正在检查该地址的值。

下面是代码：--

```
 computeWait(long long int begin, long long int begin2, long long int w,
    int* current, int limit)      
   {    
      long long int next = 0, arrival = 0;

      long long int next1 = 0, service = 0;

      long long int serviceTime = 0;

      long long int wait = 0;

      static long long int Ta = 0;

      static long long int Ts = 0;
      static long long int W = 0;

      while(*current < limit)
      {
         next = (16807 * begin) % m;
         arrival = -200 * log((double)next/m);

         next1 = (16807 * begin2) % m;
         service = -100 * log(EDRN((double)next1));

         wait = max(0, (w + service - arrival));
         Ta = Ta + arrival; 
         Ts = Ts + service; 
         W = W + wait;

         *current = *current + 1;;
         computeWait(next, next1, wait, current, limit);
       }   

       printf("\n\nTotal arrival %Ld Total service %Ld Total wait %Ld\n", Ta/limit, Ts/limit, W/limit);
   }

   int main(int agrc, char* argv[])    
   {

       int num = 0;
       int currentValue = 0;        // seed number
       int end = 1000000;

       computeWait(1, 46831694, 0, &currentValue, end);          
   } 
```

在 103917 之后，它的值没有得到更新，它给出了内存保护失败。

请让我知道我在哪里做错了，因为修复它似乎很简单。

谢谢，内哈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:40:43.033

好吧，我并没有真正尝试理解代码，但我看到了一些大数字和递归这个词。所以我猜它是堆栈溢出，因为你的递归太深了？

# c# - .NET 方法（在 .dll 中）和反射版本之间的性能差异

> ID：14783539
> 
> 赞同：9
> 
> 时间：2013-02-09T00:30:42.697
> 
> 标签：c#, .net, dll, assemblies

我一直在尝试优化 JavaScript 编码函数（在 C# 中）以提高其性能（整体尝试提高企业 Web 应用程序的性能）。我们尝试使用 .NET `HttpUtility.JavaScriptStringEncode`，但它没有按照我们的数据层预期的方式进行编码（并且更改数据层不在桌面上）。

使用 RedGate 分析器工具，我确定我们函数的最佳性能约为总页面加载的 8%。当我使用 .NET 函数（在接受它的页面上）时，它大约占页面总负载的 0.08%。我们反映了 .NET 函数以查看它们在使用什么魔法，当我将反映的代码复制到函数中并直接运行它时，它的性能约为 10%。

我很好奇为什么。.NET 函数如何准备不同的方式来奖励这种性能提升？

我提前道歉，但我无法粘贴我们正在使用的功能，但我认为这不会影响回答问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T09:17:04.473

您能否将反射代码粘贴到库中后生成的 IL 代码与 .NET 库中存在的 IL 代码进行比较？用于编译的编译器开关可能会导致此类差异。

# ios - 未找到 Xcode 有效签名身份，管理 2 个开发帐户

> ID：14783548
> 
> 赞同：0
> 
> 时间：2013-02-09T00:31:22.167
> 
> 标签：ios, xcode, provisioning-profile, ios-provisioning

我有一个用于 app1 的企业帐户/个人资料。我在市场上推出了 app1，它目前在线。然后我用另一个开发帐户启动了一个个人 app2，完成了 app2 并尝试将其投放市场。我收到一个错误，我只能在钥匙串中拥有一个分发证书，因此我删除了我的业务证书并能够提交我的个人 app2。所以现在我正在尝试对 app1 进行一些更改，但现在我收到“未找到有效的签名身份”警告。所以我尝试重新下载我的分发证书等等，尝试创建新的配置文件，但没有任何效果。在钥匙串中，我可以查看证书，并且没有与之关联的私钥。我读过所有遇到“未找到有效签名身份”的人 问题，似乎常见的解决方案是吊销证书并创建一个新证书。除了我读到，如果您撤销当前证书，那么我的应用程序将停止在所有设备上运行，我不能让这种情况发生。请告诉我苹果不只是把我搞砸了（再次）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T04:16:31.820

我找到了这个链接，它回答了这个问题：[如果 App Store 证书/密钥对代码签名过程中有任何“永久搞砸”的情况，该怎么办？](https://stackoverflow.com/questions/10642989/what-if-any-screw-it-up-permanently-situations-are-there-in-the-app-store-cer)

> 分发证书仅用于提交到 iTunes Connect（和 Ad Hoc 的东西）。一旦获得批准，Apple 会在将应用程序放入 App Store 之前使用不同的未过期证书对应用程序进行签名，因此开发人员的分发证书的状态不再重要。

# objective-c - UIActivityViewController 在特定动作中使用项目

> ID：14783552
> 
> 赞同：4
> 
> 时间：2013-02-09T00:32:11.813
> 
> 标签：objective-c, printing, uiactivityviewcontroller, uiactivity

我有一个 UIActivityViewController，我想让它拥有 safari 所做的所有动作等等。目前我只能收到邮件、消息、推特、脸书和半工作副本。我使用 url 设置活动项目数组。然后我添加了该 url 的 nsstring 并将其与 url 一起添加，一切都很好，就像通过复制字符串复制效果更好一样，我将它粘贴到更多区域。但是当也有字符串时，twitter 和 facebook 将 url 添加到他们的文本中并包含链接。我怎样才能做到让他们没有文字，只有链接？另一个问题是如何在 twitter 和 facebook 活动的链接中显示 web 视图预览？它只显示一个 Safari 图标。第三个问题是如何打印网页的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-10T06:26:39.587

我发现了这个[https://www.albertopasca.it/whiletrue/objective-c-custom-uiactivityviewcontroller-icons-and-text/](https://www.albertopasca.it/whiletrue/objective-c-custom-uiactivityviewcontroller-icons-and-text/)它显示了如何为每个服务做不同的内容

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-10T08:53:00.437

要为**不同的服务提供不同的项目**，您需要进行子类化`UIActivityItemProvider`。它符合`UIActivityItemSource`协议，所以你实现方法：

```
- (id)activityViewController:(UIActivityViewController *)activityViewController
         itemForActivityType:(NSString *)activityType {
    // compare `activityType` and return what you want
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:52:49.093

[对于 twitter 或 facebook，您需要使用正确类型的 twitter/facebook 帖子（请参阅此处](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIActivity_Class/Reference/Reference.html)底部的常量）和有效负载来设置 UIActivity。

# database - 关系代数查询问题

> ID：14783555
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:32:22.607
> 
> 标签：database, relational-algebra

我有一个问题，我有两个关系，一个包含属性song_id、song_name、album_id，另一个包含album_id 和album_name。我需要在歌曲关系中找到所有没有歌曲的专辑的名称。问题是我只能使用重命名、投影、选择、分组（使用 sum、min、max、count）、笛卡尔积和自然连接。我已经花了很多时间来解决这个问题，如果有任何帮助可以为我指明正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T02:47:19.040

正如@ErwinSmout 指出的那样，差异通常是一种简单的方法。但是由于您不能使用它，因此使用计数有一个棘手的解决方法。我假设`album_id`歌曲关系中的每个存在也存在于`albums`关系中。

`PROJECT`来自歌曲关系的 album_id（请注意，关系代数`PROJECT`相当于 SQL 的`SELECT DISTINCT`）。我将调用此关系`song_albums`。现在让我们计算`albums`关系的计数，称为 m，并计算新表的计数，称为 n。

取专辑关系和 song_albums 关系的笛卡尔积。这个新关系有 m*n 行。现在，如果您进行计数，按 分组`album_name`，则每个 m`album_name`的计数为 n。不是很有帮助。

但是现在，我们`SELECT`从关系行 where `albums.album_id != song_albums.album_id`。现在，如果您进行按 分组`album_name`的计数，则不在原始关系中的那些专辑的计数`songs`将为 n，而最初在其中的那些专辑的计数将小于 n，因为将根据如何删除行与那张专辑的许多歌曲都在原始`songs`关系中。

* * *

**编辑：**事实证明，这不是一个*严格*的关系代数解决方案：在 SQL 中，一个 1 x 1 表，例如包含的表，`n`可以简单地被视为一个整数并用于相等比较。但是，根据维基百科，[选择](http://en.wikipedia.org/wiki/Selection_%28relational_algebra%29)必须在关系的两个属性之间进行比较，或者在一个属性和一个*常*量值之间进行比较。

另一个障碍将由另一个不推荐的笛卡尔积来解决：我们可以将包含`n`我们最近的关系的 1 x 1 关系的笛卡尔积取为。现在我们可以进行适当的关系代数选择，因为我们有一个始终等于 的属性`n`。

由于这变得相当复杂，这里有一个关系代数表达式，用于捕捉上述英文解释：

![关系代数 1](../Images/1c108186bc6caddb7ea20b96887bced7.png)

![关系代数 2](../Images/a62bf2756d90e9debe0ca81c02a89243.png)

![关系代数 3](../Images/b78bbdedc01fb7eb2c8269f76798b698.png)

![关系代数 4](../Images/9940f319d2cad748ef49b63ef2a27469.png)

请注意，n 是一个 1 x 1 关系，具有名为“count”的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T14:22:10.493

不可能。问题包括一个否定，并且在关系代数中，只能使用关系差异来表达，你似乎不允许使用它。

我很好奇你的老师提出了什么作为这个问题的解决方案。

# crossfilter - crossfilter 过滤器不适用于更新数据。是设计使然吗？

> ID：14783556
> 
> 赞同：0
> 
> 时间：2013-02-09T00:32:42.580
> 
> 标签：crossfilter

我在最近的项目中使用交叉过滤器管理一个大型数据集，我需要能够更改数据值（布尔值）。但是，在值更改后，此属性上的过滤器不会过滤掉更改的项目。例如，我有大型数据集，其数据具有名为“忽略”的布尔属性；我为此属性创建了一个维度，以过滤出忽略 = true 的数据。在应用程序中，用户可以将此值从 false 更改为 true。在值更改为 true 后，清除过滤器并重新过滤该维度上的数据，我仍然得到应该被过滤掉的数据项。是设计使然还是有办法绕过它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T22:02:11.060

从 API Docs 和来源看来，这种行为不受支持。

[https://github.com/square/crossfilter/wiki/API-Reference](https://github.com/square/crossfilter/wiki/API-Reference)

# sql - 从2台机器查询2张表并分组结果

> ID：14783566
> 
> 赞同：1
> 
> 时间：2013-02-09T00:33:27.717
> 
> 标签：sql, sql-server, tsql

我有一个查询可以返回正确的信息，但我无法弄清楚如何获得不同的日期并将计数相加。下面是我的查询，结果显示了我得到了什么，以及我希望得到什么。我以为工会会加入他们，并给我想要的结果。我已经搜索了很长时间，但没有找到关于这个主题的任何帮助。任何帮助将不胜感激。先感谢您。

```
SELECT COUNT(log_datetime) AS icount, CONVERT(varchar, log_datetime, 101) AS logdate
from openrowset('sqloledb', 'ServerName1';'UserID';'Password',
          'select * from DatabaseName..TableName where field1 > 899')
group by convert(varchar, log_datetime, 101)
union
SELECT COUNT(log_datetime) AS icount, CONVERT(varchar, log_datetime, 101) AS logdate
from openrowset('sqloledb', 'ServerName2';'UserID';'Password',
    'select * from DatabaseName..TableName where field1 > 899')
group by convert(varchar, log_datetime, 101)
order by logdate 
```

```
Results
235     01/10/2013
312     01/10/2013
3091    01/11/2013
3197    01/11/2013
3339    01/12/2013
3536    01/12/2013 
```

```
Wanted Results
547      01/10/2013
6288     01/11/2013
6875     01/12/2013 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:07:26.813

你可以试试这个

```
SELECT SUM(icount) AS icount, logdate FROM
(
    SELECT COUNT(log_datetime) AS icount, CONVERT(varchar, log_datetime, 101) AS logdate
    FROM openrowset('sqloledb', 'ServerName1';'UserID';'Password',
              'select * from DatabaseName..TableName where field1 > 899')
    GROUP BY convert(varchar, log_datetime, 101)
        UNION ALL
    SELECT COUNT(log_datetime) AS icount, CONVERT(varchar, log_datetime, 101) AS logdate
    FROM openrowset('sqloledb', 'ServerName2';'UserID';'Password',
        'select * from DatabaseName..TableName where field1 > 899')
    GROUP BY convert(varchar, log_datetime, 101)
) AS tbl
GROUP BY logdate
ORDER BY logdate 
```

这是[sqlfiddle](http://sqlfiddle.com/#!3/7c142/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T04:56:07.290

```
SELECT count(1) icount, AA.logdate FROM
(
SELECT CONVERT(varchar, log_datetime, 101) AS logdate
from openrowset('sqloledb', 'ServerName1';'UserID';'Password',
          'select * from DatabaseName..TableName where field1 > 899')
union all
SELECT CONVERT(varchar, log_datetime, 101) AS logdate
from openrowset('sqloledb', 'ServerName2';'UserID';'Password',
    'select * from DatabaseName..TableName where field1 > 899')
) AA
group by AA.logdate order by AA.logdate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T02:07:45.270

我相信彼得姆的回答是正确的，只是想添加一个关于原因的注释。

使用 SQL，您必须分组思考。您正在创建两组独特的数据，并使用 UNION 将它们组合起来。但是，您的 GROUP BY 语句在每个集合中，而不是组合中。因此，多行结果。通过使用另一个 SELECT 语句包装所有内容，您正在查询组合集，并且现在可以进行分组和聚合。

# knockout.js - 使用多个 ViewModel 时如何使用敲除数据绑定元素

> ID：14783570
> 
> 赞同：1
> 
> 时间：2013-02-09T00:33:42.623
> 
> 标签：knockout.js

我目前有 2 个合并的视图模型。现在我想将此 MasterViewModel 数据绑定到页面中的元素，但不确定如何。

这是我的 HTML：

```
 <select data-bind="options: MasterViewModel.VMPR.ProjectName">
   </select>
   <select data-bind="options: MasterViewModel.VMTT.TaskTypeDetail">
   </select> 
```

我的 ViewModels 和绑定模型：

```
 var ProjectDS = function (data) {
        var self = this;
        self.ProjectID = ko.observable(data.ProjectID);
        self.ProjectName = ko.observable(data.ProjectName);

    }

    var ProjectModel = function (Projects) {
        var self = this;
        self.Projects = ko.observableArray(Projects);

        $.ajax({
            url: "CreateTask.aspx/GetTaskProjects",
            // Current Page, Method  
            data: '{}',
            // parameter map as JSON  
            type: "POST",
            // data has to be POSTed  
            contentType: "application/json; charset=utf-8",
            // posting JSON content      
            dataType: "JSON",
            // type of data is JSON (must be upper case!)  
            timeout: 10000,
            // AJAX timeout  
            success: function (Result) {
                var MappedProjects =
              $.map(Result.d,
       function (item) { return new ProjectDS(item); });
                self.Projects(MappedProjects);
            },
            error: function (xhr, status) {
                alert(status + " - " + xhr.responseText);
            }

        });
    };

    var TaskTypeDS = function (data) {
        var self = this;
        self.TaskTypeID = ko.observable(data.TaskTypeID);
        self.TaskTypeDetail = ko.observable(data.TaskTypeDetail);

    }

    var TaskTypeModel = function (TaskTypes) {
        var self = this;
        self.Projects = ko.observableArray(TaskTypes);

        $.ajax({
            url: "CreateTask.aspx/GetTaskTypes",
            // Current Page, Method  
            data: '{}',
            // parameter map as JSON  
            type: "POST",
            // data has to be POSTed  
            contentType: "application/json; charset=utf-8",
            // posting JSON content      
            dataType: "JSON",
            // type of data is JSON (must be upper case!)  
            timeout: 10000,
            // AJAX timeout  
            success: function (Result) {
                var MappedTaskType =
              $.map(Result.d,
       function (item) { return new TaskTypeDS(item); });
                self.Projects(MappedTaskType);
            },
            error: function (xhr, status) {
                alert(status + " - " + xhr.responseText);
            }

        });
    };

    var MasterViewModel = {
            VMPR: new ProjectModel(),
            VMTT: new TaskTypeModel()
        }

    $(document).ready(function () {
        ko.applyBindings(MasterViewModel);
    }) 
```

最后，这是我得到的 JSON：

```
{
"VMPR": {
    "Projects": [
        {
            "ProjectID": 1,
            "ProjectName": "Dummy Project"
        },
        {
            "ProjectID": 3,
            "ProjectName": "Dummy Project2"
        }
    ]
},
"VMTT": {
    "Projects": [
        {
            "TaskTypeID": 1,
            "TaskTypeDetail": "Documentation"
        },
        {
            "TaskTypeID": 2,
            "TaskTypeDetail": "Development"
        },
        {
            "TaskTypeID": 3,
            "TaskTypeDetail": "Planning"
        },
        {
            "TaskTypeID": 4,
            "TaskTypeDetail": "Integration"
        },
        {
            "TaskTypeID": 5,
            "TaskTypeDetail": "Deployment"
        },
        {
            "TaskTypeID": 6,
            "TaskTypeDetail": "Testing"
        }
    ]
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T12:13:33.747

您快到了，您只需要将视图模型的正确属性绑定到每个选择，然后[设置](http://knockoutjs.com/documentation/options-binding.html)用于文本的属性以及用作值的属性：

```
<select data-bind="options: VMPR.Projects, optionsText: 'ProjectName', optionsValue: 'ProjectID', optionsCaption: 'Choose...'"></select>

<select data-bind="options: VMTT.Projects, optionsText: 'TaskTypeDetail', optionsValue: 'TaskTypeID', optionsCaption: 'Choose...'"></select> 
```

您还需要展平您的视图模型，因此您没有两个嵌套的视图模型：

```
var ProjectModel = function (Projects) {
    var self = this;
    self.Projects = ko.mapping.fromJS(Projects);
};

var TaskTypeModel = function (TaskTypes) {
    var self = this;
    self.Projects = ko.mapping.fromJS(TaskTypes);
}

$(function () {
var MasterViewModel = {
    VMPR: ko.mapping.fromJS(data.VMPR),
    VMTT: ko.mapping.fromJS(data.VMTT)
};
    ko.applyBindings(MasterViewModel);
}) 
```

[这里的](http://jsfiddle.net/SNbw7/1/)工作示例

要让这与您的两个 ajax 调用一起工作：

```
var TaskTypeModel = function (TaskTypes) {
    var self = this;
    self.Projects = ko.observableArray(TaskTypes);

    $.ajax({
        url: "CreateTask.aspx/GetTaskTypes",
        // Current Page, Method  
        data: '{}',
        // parameter map as JSON  
        type: "POST",
        // data has to be POSTed  
        contentType: "application/json; charset=utf-8",
        // posting JSON content      
        dataType: "JSON",
        // type of data is JSON (must be upper case!)  
        timeout: 10000,
        // AJAX timeout  
        success: function (Result) {
            ko.mapping.fromJS(Result, self.Projects);
        },
        error: function (xhr, status) {
            alert(status + " - " + xhr.responseText);
        }

    });
}; 
```

# jsp - 如何使用 count 和 JSTL ForEach 动态创建表

> ID：14783572
> 
> 赞同：4
> 
> 时间：2013-02-09T00:33:54.697
> 
> 标签：jsp, foreach, jstl

我想创建一个动态表，当它提供了 no 时接受书籍属性。要在前一页输入的书籍。但我什么也没得到。

这是我的代码：

```
<table>
<c:forEach begin="1" end= "${ no }" step="1" varStatus="loopCounter">
<tr>
<td>
<input type='text' name="isbn" placeholder="ISBN">
</td>
<td>
<input type="text" name="Title" placeholder="Title">
</td>
<td>
<input type="text" name="Authors" placeholder="Author">
</td>
<td>
<input type="text" name="Version" placeholder="Version">
</td>
</tr>
</c:forEach>
</table> 
```

${no} 是我要输入的书籍数量。我刚来这地方。抱歉，如果标题不清楚。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T05:46:59.750

你没有得到任何东西，因为你没有迭代你的书单。此外，您只`<input type="text" />`在每次迭代中打印大量内容。您的代码应如下所示（假设您的书籍列表是`lstBooks`并且已经初始化）：

```
<table>
    <!-- here should go some titles... -->
    <tr>
        <th>ISBN</th>
        <th>Title</th>
        <th>Authors</th>
        <th>Version</th>
    </tr>
    <c:forEach begin="1" end= "${ no }" step="1" varStatus="loopCounter"
        value="${lstBooks}" var="book">
    <tr>
        <td>
            <c:out value="${book.isbn}" />
        </td>
        <td>
            <c:out value="${book.title}" />
        </td>
        <td>
            <c:out value="${book.authors}" />
        </td>
        <td>
            <c:out value="${book.version}" />
        </td>
    </tr>
    </c:forEach>
</table> 
```

* * *

根据评论了解您的问题后，请确保该`${no}`变量在`request.getAttribute("no")`. 您可以使用 scriptlet（但这是一个[坏主意](https://stackoverflow.com/q/3177733/1065197/)）或仅使用`<c:out value="${no}" />`.

请注意，正如我所说，该变量应该可以通过 访问`request.getAttribute`，不要将其与`request.getParameter`.

顺便说一句，如果你知道它的值可能是这样的，你可以设置一个变量：

```
<c:set var="no" value="10" /> 
```

然后您可以使用`${no}`.

更多信息：[JSTL 核心标签](http://www.tutorialspoint.com/jsp/jstl_core_set_tag.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-18T05:46:38.050

*假设您在Employees 下给出了一个地图`List<Map<String, Object>>`列表*

```
<caption>Emplyess Under You</caption>
<tr>
    <th>Employee Id</th>
    <th>First Name</th>
    <th>Last Name</th>
    <th>Designation
</tr>
<c:forEach  var="record"  items="${underEmployees}" > 
    <tr>
        <c:forEach var="entry" items= "${record}">
            <th><c:out value="${entry.value}"></c:out></th>
        </c:forEach>

    </tr>
</c:forEach> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-02T03:28:40.417

```
<table>
  <tr>
    <th>First name</th>
    <th>Last Name</th>
    <th>Age</th>
  </tr>
  <c:forEach items="${students }" var="student">
    <tr>
      <td>${student.firstName}</td>
      <td>${student.lastName }</td>
      <td>${student.age }</td>
    </tr>
  </c:forEach>
</table> 
```

# javascript - 我想通过js在一页中显示图片，但是onclick不起作用

> ID：14783574
> 
> 赞同：0
> 
> 时间：2013-02-09T00:34:21.947
> 
> 标签：javascript, html

这是显示图片的页面，用js替换不同来源的占位符。当我单击链接时，我不希望它转到另一个页面`<a>`，所以我正在使用`onclick="return false"`. 但它不起作用。我找不到问题。

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>my first gallery</title>
    <script type="text/javascript" src="scripts/showPic.js"></script>
</head>
<body>
    <h1>Snapshot</h1>
    <a href="images/6.jpg" onclick="return false; ">Click me</a>
    <ul>
        <li>
        <a href="images/1.jpg" onclick="showPic(this);
            return false;" title="first picture" >my favorite </a>
        </li>
        <li>
        **<a href="images/2.jpg" onclick="showPic(this); return false;" title="second picture">second my favorite</a>**
        </li>
    </ul>
    <ol>
        <li>
        <a href="images/3.jpg" onclick="showPic(this); return false;" title="third picture" >third my favorite </a>
        </li>
        <li>
        <a href="images/4.jpg" onclick="showPic(this); return false;" title="forth picture" >forth my favorite </a>
        </li>
    </ol>
<!--this the place to show pictures-->
    <img id="placeholder" src="images/5.jpg" alt="place holder imga" />

</body>
</html>

JS:
function showPic(whichPic){
    var source = whichPic.getAttribute("href");
    var placeholder = document.getElementById("placeholder");
    placeHolder.setAttribute("scr", source);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:45:48.933

哪个位不起作用？我注意到的第一件事是您在设置占位符的属性时有拼写错误。你有 scr 当它应该是 src

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:29:14.593

我假设您的 JavaScript 将占位符替换`href`为用作源的图像。相反，我建议您这样做：

```
<span onclick="showPic('images/4.jpg');" title="fourth picture" >fourth my favorite</span> 
```

您将需要相应地编辑 JavaScript。如果您发布脚本代码，我可以向您展示如何。

# c++ - 如何将两个 Makefile（每个都构建具有特定环境变量集的脚本）合并到一个 Makefile 中？

> ID：14783576
> 
> 赞同：0
> 
> 时间：2013-02-09T00:34:25.757
> 
> 标签：c++, merge, makefile

我有两个不同的目录，有两个不同的 C++ 源代码，每个都执行不同的程序。目录有自己的 Makefile，每个目录都构建带有特定环境变量集的脚本。

现在，我想将两个目录的内容放在一个目录中，因为我想混合两个 C++ 源代码，以便开发一个利用这两个程序功能的新 C++ 源代码。

到目前为止，我将所有文件都放在了一个目录中，并且在放置相应的 Makefile 时，我可以成功构建每个原始源代码。现在，我想要一个允许我构建每个原始源代码（而不替换 Makefile）的 Makefile，希望这将允许我构建新的混合 C++ 源文件......

我尝试了一个简单的解决方案，并将两个 Makefile 的内容放入一个 Makefile 中，但这不起作用......

我认为发布我的两个 Makefile 很有用

这是第一个

```
# A simple $(MAKE)file to cause make to go look in the top directory. A simple
# convenience.

all: lib 
    $(MAKE) -C .. examples

lib:
    $(MAKE) -C .. lib/libAria.so

%.so: ../lib/libAria.so %.cpp 
    $(MAKE) -C .. examples/$@

%: ../lib/libAria.so %.cpp 
    $(MAKE) -C .. examples/$@

%Static: ../lib/libAria.a %.cpp 
    $(MAKE) -C .. examples/$@

clean: 
    $(MAKE) -C .. cleanExamples

../lib/libAria.so: FORCE
    $(MAKE) -C .. dirs lib/libAria.so

../lib/libAria.a: FORCE 
    $(MAKE) -C .. dirs lib/libAria.a

FORCE:

.PHONY: all FORCE clean lib 
```

第二个 Makefile 是

```
LDLIBS = -lm 
CXXFLAGS = -O3 -finline-functions -I. -I./qpoases/INCLUDE -I./qpoases/SRC
CFLAGS = -O3
CC     = g++

OBJECTS = \
    ./qpoases/SRC/QProblemB.o       \
    ./qpoases/SRC/Bounds.o          \
    ./qpoases/SRC/Constraints.o     \
    ./qpoases/SRC/SubjectTo.o       \
    ./qpoases/SRC/Indexlist.o       \
    ./qpoases/SRC/CyclingManager.o  \
    ./qpoases/SRC/Utils.o           \
    ./qpoases/SRC/MessageHandling.o \
    ./qpoases/solver.o              \
    integrator.o                    \
    condensing.o                    \
    gauss_newton_method.o 

.PHONY: all
all: test libacado_exported_rti.a

test: ${OBJECTS} test.o

./qpoases/solver.o    : ./qpoases/solver.hpp
integrator.o          : acado.h
condensing.o          : acado.h
gauss_newton_method.o : acado.h   ./qpoases/solver.hpp
test.o                : acado.h   ./qpoases/solver.hpp

libacado_exported_rti.a: ${OBJECTS}
    ar r $@ $?

${OBJECTS} : ./qpoases/solver.hpp

.PHONY : clean
clean :
    -rm -f *.o *.a ./qpoases/SRC/*.o ./qpoases/SRC/*.a test 
```

我检查了与我的问题相关的所有 stackoverflow 问题，唯一最接近我的情况是一个标题为（**一个目录中有多个 makefile**）的问题；但是，这并不是我想要做的......

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:39:25.150

为什么要合并源目录？我认为他们分开是有原因的。相反，我将保留它们并在它们上方的目录中创建一个新的 make 文件，该文件调用它下面的每个子 make 文件 - 通过包含或通过直接对每个 makefile 进行脱壳。我不会为了让继承或任何工作“更容易”而混合代码。

顺便说一句，这是给你的链接：[Stack Overflow 向你展示了如何](https://stackoverflow.com/questions/1139271/makefiles-with-source-files-in-different-directories)

# c++ - OpenGL：无法使用 freeGLUT 执行渲染？C++

> ID：14783578
> 
> 赞同：0
> 
> 时间：2013-02-09T00:34:33.727
> 
> 标签：c++, opengl, render, freeglut

我今天刚开始使用 freeGLUT，我已经很好地安装了所有东西。我能够创建一个基本窗口，但是每当我调用几乎所有渲染方法时，编译都会失败。我正在使用以下代码：

```
#include "math_lib.h"
#include <stdlib.h>
#include <GL/freeglut.h>

void render(void);

int main(int argc, char** argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);
    glutInitWindowPosition(100, 100);
    glutInitWindowSize(640, 480);
    glutCreateWindow("Simple GLUT Application");

    glutDisplayFunc(render);    

    glutMainLoop();
}

void render(void) {
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glBegin(GL_TRIANGLES);
        glColor3f(1, 0, 0);
        glVertex2f(-0.5, -0.5);
        glColor3f(0, 1, 0);
        glVertex2f(0.5, -0.5);
        glColor3f(0, 0, 1);
        glVertex2f(0.0, 0.5);
    glEnd();

    glutSwapBuffers();
} 
```

我得到的错误是：

```
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:29: undefined reference to `glClear@4'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:31: undefined reference to `glBegin@4'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:32: undefined reference to `glColor3f@12'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:33: undefined reference to `glVertex2f@8'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:34: undefined reference to `glColor3f@12'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:35: undefined reference to `glVertex2f@8'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:36: undefined reference to `glColor3f@12'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:37: undefined reference to `glVertex2f@8'
C:\Users\User\Dropbox\NetBeans Workspace\OpenGL_Testing/main.cpp:38: undefined reference to `glEnd@0' 
```

那么我做错了什么还是我只是错过了导入？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T00:37:17.250

根据错误消息，它看起来像 Windows。您需要链接到`opengl32.lib`.

# c# - C#服务不会写文件，没有错误

> ID：14783582
> 
> 赞同：0
> 
> 时间：2013-02-09T00:34:56.453
> 
> 标签：c#, service

编辑：

好的，到目前为止，通过无数的帖子，我已经找到了一个解决方案，我无法从服务中做我需要做的事情，我希望它成为一项服务，以便它始终在计算机上运行，但显然，通过编写服务的方式，我可能无法运行我想运行的命令，因为“该服务没有在与用户桌面相同的空间中运行”，因此它至少无法捕获桌面，这就是我到目前为止收集的内容。

至于现在，我将把它留在这里，也许会找到一种方法，在用户登录时以用户名启动程序，以捕获桌面，而不是尝试直接从服务中执行。

我已经在墙上敲了几个小时试图弄清楚这一点，我以前从未做过服务，只是形成应用程序，我的下一个项目（客户端服务器模型客户端监控实用程序）需要安装作为客户端机器上的服务并将数据发送回主服务器。

在我查找如何编写服务以及如何安装服务之前从未编写过服务。我让它一切正常，当前的工作版本每 30 秒吐出一个事件日志以显示它的工作。

我首先在 LocalSystem 中运行它，因为我认为它具有写入文件的权限，但是在那之后我尝试了 LocalService，但它也不起作用。

我将目录指定为 C:\WatcherData\Test.jpg

并在常规表单应用程序中对其进行了测试（有效）

OutputImage.Save("c:\watcherdata\test.jpg", ImageFormat.Jpeg);

没有例外，没有事件，它只是没有发生，但是 EventLog 消息被放在它之前，所以它应该到达那个点，对吧？

任何帮助将不胜感激，如果您需要了解其他任何信息，我将很乐意提供帮助

编辑：这里有一些代码：

```
private void ServiceWorkerThread(object state)
    {
        while (!this.stopping)
        {
            this.eventLog1.WriteEntry("This is a test2");

            CallMe();

            Thread.Sleep(30000);
        }

        this.stoppedEvent.Set();
    }

    private void CallMe()
    {
        try
        {
            int screenWidth = Screen.GetBounds(new Point(0, 0)).Width;
            int screenHeight = Screen.GetBounds(new Point(0, 0)).Height;
            Bitmap OutputImage = new Bitmap(screenWidth, screenHeight);
            Graphics gfx = Graphics.FromImage((Image) OutputImage);
            gfx.CopyFromScreen(0, 0, 0, 0, new Size(screenWidth, screenHeight));
            OutputImage.Save("c:\\watcherdata\\test.jpg", ImageFormat.Jpeg);
        }
        catch (Exception e)
        {
            this.eventLog1.WriteEntry(e.Message + "\r\n" + e.StackTrace, EventLogEntryType.Error);
        }
    } 
```

正如我所说，大部分内容来自 Microsoft 示例文档，我是服务新手

目前仍在尝试解决，如果我有任何地方会告诉你们

编辑 2

在玩了一些之后，我设法让它写入文件，在意识到大部分问题是我缺乏关于如何构建服务和安装程序的知识之后，显然我在构建我的服务时没有重建安装程序。

现在它只写全黑，一个大的黑色图片。但至少它的写作！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:42:29.960

一些源代码怎么样？

我可能会添加一些跟踪以确保执行文件写入代码。

大多数情况下，这种类型的故障是权限问题和/或人们试图写入 Windows 系统目录。您的问题表明您正在确保您没有写入 Windows 目录。请确保 c:\watcherdata 文件夹存在。

# javascript - jquery focus 命令在 chrome 命令行中不起作用

> ID：14783585
> 
> 赞同：23
> 
> 时间：2013-02-09T00:34:57.673
> 
> 标签：javascript, jquery, google-chrome

如果我有如下所述的文本页面。标题部分中的调用工作 `$("#target").focus();` 正常。`$()`我还可以将该命令绑定到更真实页面中的事件。

但是，如果我打开 chrome 控制台并键入 `$("#target").focus();` 它不会改变焦点。如果我运行`$("#target").val("something");`它会更改屏幕上的值，但它不适用于焦点。

显然这不是一个关键问题，但我真的很好奇为什么会发生这种情况。有人有想法吗？

```
<html>
  <head>
    <script src="jquery-1.9.1.js"></script>
    <script>
      $(function(){
         $("#target").focus();
      });
    </script>
  </head>

 <body>
   <input id="target" type="text">
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-09T00:39:55.027

您将意识到，当单击 Chrome 控制台时，它将从当前页面上的任何输入或文本区域控件中窃取焦点，反之亦然。这是因为 Chrome 控制台实际上是使用与任何其他 HTML 页面相同的 HTML 控件实现的，只是具有特殊属性，例如，阻止 Chrome 以递归方式检查 Chrome 控制台。

当您在 Chrome 控制台（即 Chrome 控制台的输入控件）中键入命令时，它将保持焦点。Chrome 工程师可能选择了不同的实现方式，但在大多数情况下，用户会希望在发出命令后继续在 Chrome 控制台中输入，因此没有命令会从控制台释放焦点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-08T14:07:33.170

一种可能的方法是：散焦/模糊您的控制。将其滚动出视图。在 Chrome 控制台中输入要聚焦的命令。如果然后网站将向上滚动到您的控件，您可以确定焦点方法有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-29T07:06:59.707

有点骇人听闻，但有效......

尝试`setTimeout :D`在计时器到期之前包装您的突出显示代码，然后单击网页。

```
ele2 = $('#input')
setTimeout(function(){ele2.focus()},4000); 
```

# android - 如何判断蓝牙设备是否已连接？我的代码不起作用

> ID：14783588
> 
> 赞同：1
> 
> 时间：2013-02-09T00:35:06.647
> 
> 标签：android, android-intent

我正在尝试监听蓝牙连接/断开事件以确定是否连接了蓝牙设备。我正在尝试这样做，以便我的应用程序可以在较旧的 android 版本上运行。

我在清单中注册了接收器，如下所示：

```
<receiver
        android:name=".BluetoothReceiver">
        <intent-filter>
            <action android:name="android.bluetooth.device.action.ACL_CONNECTED" />

        </intent-filter>
</receiver> 
```

在我的 BluetoothReceiver 课程中，我有

```
public class BluetoothReceiver extends BroadcastReceiver{
public final static String TAG = "BluetoothReciever";

public void onReceive(Context context, Intent intent)
{

    Log.d(TAG, "Bluetooth Intent Recieved");

    final BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
    String action = intent.getAction();

    if (BluetoothDevice.ACTION_ACL_CONNECTED.equalsIgnoreCase(action))
    {
        Log.d(TAG, "Connected to " + device.getName());
    }

    if (BluetoothDevice.ACTION_ACL_DISCONNECTED.equalsIgnoreCase(action))
    {
        Log.d(TAG, "Disconnected from " + device.getName());
    }
}} 
```

但是当连接和断开蓝牙时，什么也没有发生。我究竟做错了什么？

# php - file_put_contents：打开流失败，没有这样的文件或目录

> ID：14783592
> 
> 赞同：15
> 
> 时间：2013-02-09T00:35:29.187
> 
> 标签：php, dompdf

我正在尝试使用 dompdf 将表单保存到易于阅读的 .pdf 文件中，我的处理脚本如下。我收到错误`Warning: file_put_contents(/files/grantapps/NAME0.pdf) [function.file-put-contents]: failed to open stream: No such file or directory in /home/username/public_html/subdir/apps/dompdf/filename.php on line 39`。（第 39 行是我完整脚本的最后一行。）我不知道如何解决这个问题。

`allow_url_fopen`已打开，我尝试了各种文件路径，包括完整目录 ( `/home/username/public_html/subdir/files/grantapps/`) 和下面代码中的内容，但没有任何效果。

```
require_once("dompdf_config.inc.php");
date_default_timezone_set('America/Detroit');

$html = 'code and whatnot is here';

$name = str_replace(" ", "", $_POST['form2name']);
$i = 0;
$dompdf = new DOMPDF();
$dompdf->load_html($html);
$dompdf->render();
while(file_exists("files/grantapps/" . $name . $i . ".pdf")) {
    $i++;
}
file_put_contents("files/grantapps/" . $name . $i . ".pdf", $dompdf->output()); 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-02-09T00:49:43.893

目标文件夹路径肯定有问题。

您上面的错误消息说，它想将内容放到目录中的文件中`/files/grantapps/`，这将超出您的`vhost`，但在系统中的某个位置（请参阅前导绝对斜杠）

你应该仔细检查：

*   目录是否`/home/username/public_html/files/grantapps/`真的存在。
*   包含你的循环和你的 file_put_contents-Statement 绝对路径`/home/username/public_html/files/grantapps/`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-02-05T08:28:29.567

我也遇到了同样的问题，我按照下面的简单步骤操作。

只需获取要复制到的文件的确切 url，例如：

```
http://www.test.com/test.txt (file to copy) 
```

然后将确切的**绝对文件夹路径与**您要写入该文件的文件名一起传递。

1.  如果您在 Windows 机器上，那么 `d:/xampp/htdocs/upload/test.txt`

2.  如果您在 Linux 机器上，那么 `/var/www/html/upload/test.txt`

您可以使用 PHP 函数获取文档根目录`$_SERVER['DOCUMENT_ROOT']`。

# javascript - 画布游戏 - 存储/计算位置/迭代粒子/子弹/游戏元素的最有效方式

> ID：14783593
> 
> 赞同：1
> 
> 时间：2013-02-09T00:35:32.887
> 
> 标签：javascript, canvas

假设我想存储所有子弹，任何人都在我的游戏中射击以计算每一帧的新位置等。

如果有 10 名玩家，每个人的射门率是每秒 10 次，我们可能需要在 10 秒后跟踪 1000 个物体。

我们知道，对数组的迭代非常有效。

我应该添加这样的新项目符号吗？

```
// "bullets" is an array
bullets.push({
    x_position: 5, // x position from which bullet was shot
    y_position: 10, // same as above but for y
    x_speed: 2, // count of pixels that bullet is travelling on x axis per frame
    y_speed: 10 // as above but for y
}); 
```

我应该移除击中边界的子弹还是其他类似的玩家？

```
delete bullets[i] // i -> currently processed bullet index 
```

因为如果我尝试从子弹数组中取出元素，那么长数组的效率不是很高。

老实说，我没有更好的主意来解决子弹问题。几分钟后迭代这种数组可能会很痛苦，因为如果我们删除旧的子弹，数组长度保持不变，我们最终会迭代数百万条记录，其中 99% 只是空的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:02:55.567

我相信你想实现一个链表而不是使用 JavaScript 数组。

# JS 数组的真相

首先，您可能对数组有误解。当我们想到 JavaScript 数组时，我们实际上是在谈论哈希映射，其中键恰好是整数。这就是数组可以有非数字索引的原因：

```
L = [];
L[1] = 4
L["spam"] = 2; 
```

数组的迭代速度很快（至少在 C/C++ 意义上），但是通过哈希映射的迭代相当糟糕。

[在您的情况下，如果满足某些约束](http://www.html5rocks.com/en/tutorials/speed/v8/)，某些浏览器可能会将您的数组实现为真正的数组。但我相当肯定你也不想要一个真正的数组。

# 阵列性能

即使是真正的数组也不是特别适合您想要做的事情（正如您所指出的`undefined`，即使您删除了项目符号，您的数组也会不断填充元素！）

想象一下，如果你确实想从一个真正的数组中删除子弹并删除`undefined`元素：我能想到的最有效的算法是在完整扫描子弹后创建一个新数组，将所有没有被删除的子弹复制到这个新数组。这很好，但我们可以做得更好。

# JavaScript 中的链表！

根据您的问题，我认为您需要以下内容：

*   快速创作
*   快速迭代
*   快速删除

提供恒定时间创建、迭代和删除的简单数据结构是链表。（也就是说，链表不允许您快速获得随机项目符号。如果这对您很重要，请改用树！）

那么如何实现链表呢？我最喜欢的方法是给每个对象一个`next`引用，以便每个项目符号指向或“链接”到列表中的下一个项目符号。

## 初始化

以下是您可以如何启动链表的方法：

```
first_bullet = {
    x_position: 5,
    y_position: 10,
    x_speed: 2,
    y_speed: 10,
    next_bullet: undefined, // There are no other bullets in the list yet!
};

// If there's only one bullet, the last bullet is also the first bullet.
last_bullet = first_bullet; 
```

## 追加

要将项目符号添加到列表的末尾，您需要设置`next`old 的引用`last_bullet`，然后移动`last_bullet`：

```
new_bullet = {
    x_position: 42,
    y_position: 84,
    x_speed: 1,
    y_speed: 3,
    next_bullet: undefined, // We're going to be last in the list
};

// Now the last bullet needs to point to the new bullet
last_bullet.next_bullet = new_bullet;

// And our new bullet becomes the end of the list
last_bullet = new_bullet; 
```

## 迭代

遍历链表：

```
for (b = first_bullet; b; b = b.next_bullet) {

    // Do whatever with the bullet b

    // We want to keep track of the last bullet we saw...
    // you'll see why when you have to delete a bullet
    old = b; 
} 
```

## 删除

现在进行删除。这里,`b`代表被删除的项目符号, 并且`old`代表链表中它之前的项目符号--- 所以`old.next_bullet`等价于`b`.

```
function delete_bullet(old, b) {
    // Maybe we're deleting the first bullet
    if (b === first_bullet) {
        first_bullet = b.next_bullet;
    }

    // Maybe we're deleting the last one
    if (b === last_bullet) {
        last_bullet = old;
    }

    // Now bypass b in the linked list
    old.next_bullet = b.next_bullet;
}; 
```

请注意，我没有使用`delete b`. 那是因为[`delete`没有做你认为它做的事情。](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T09:48:34.403

这是我删除集合中的子弹或任何对象的方法。从来没有发现它是游戏的瓶颈——它总是渲染。

## 游戏

```
game = {
  dirty: false,
  entities: [ ],
  clean: function() {
    this.dirty = false;
    clean(this.entities, "_remove");
  },
  step: function() {
    if(this.dirty) this.clean();
  }
} 
```

## 子弹

```
Bullet = function() { 
  this._remove = false;
}

Bullet.prototype = {
  kill: function() {
    this.game.dirty = true;
    this._remove = true;
  }
} 
```

## 清洁功能

```
function clean(array, property) {

  var lastArgument = arguments[arguments.length - 1];
  var isLastArgumentFunction = typeof lastArgument === "function";

  for(var i = 0, len = array.length; i < len; i++) {
    if(array[i] === null || (property && array[i][property])) {
      if(isLastArgumentFunction) {
        lastArgument(array[i]);
      }
      array.splice(i--, 1);
      len--;
    }
  }
} 
```

# unix - 无法使用 fg 检索 nohup 进程

> ID：14783594
> 
> 赞同：0
> 
> 时间：2013-02-09T00:35:40.450
> 
> 标签：unix, process, ssh, nohup

我在`SSH`会话中从终端运行一个进程，并在后台启动该进程`nohup`并断开连接。

一段时间后，我重新登录服务器并看到该进程仍在运行，但无法使用当前终端将其带回前台，`bash`因为它不是启动它的那个。我认为该进程现在属于`init`当我从第一个`SSH`会话退出时启动进程退出的 shell。

现在，我如何与我开始的流程进行交互？我的意思不是我想杀死它或其他什么，但是如果该过程不时接受用户输入而现在它正在等待一个呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T04:29:00.010

> 现在，我如何与我开始的流程进行交互？

简短的回答：你没有。该进程的输入和输出连接到一个不再存在的终端。

> 如果该过程不时接受用户输入而现在它正在等待用户输入怎么办？

它不会等待输入。如果它尝试获取任何内容，它会在尝试读取时收到文件结尾。

也许您更愿意在[屏幕](http://www.gnu.org/software/screen/)下运行这样的进程，以便您可以分离会话并重新附加它。

# function - 程序适用于 Python 2.7，但不适用于 Python 3.3（两者的语法兼容）

> ID：14783598
> 
> 赞同：0
> 
> 时间：2013-02-09T00:36:05.430
> 
> 标签：function, python-3.x, python-2.7

所以我在中`integral(function, n=1000, start=0, stop=100)`定义了函数`nums.py`：

```
def integral(function, n=1000, start=0, stop=100):
    """Returns integral of function from start to stop with 'n' rectangles"""
    increment, num, x = float(stop - start) / n, 0, start
    while x <= stop:
        num += eval(function)
        if x >= stop: break
        x += increment
    return increment * num 
```

但是，我的老师（对于我的编程课）希望我们创建一个单独的程序来获取输入`input()`，然后返回它。所以我有：

```
def main():
    from nums import integral # imports the function that I made in my own 'nums' module
    f, n, a, b = get_input()
    result = integral(f, n, a, b)
    msg = "\nIntegration of " + f + " is: " + str(result)
    print(msg)

def get_input():
    f = str(input("Function (in quotes, eg: 'x^2'; use 'x' as the variable): ")).replace('^', '**')
    # The above makes it Python-evaluable and also gets the input in one line
    n = int(input("Numbers of Rectangles (enter as an integer, eg: 1000): "))
    a = int(input("Start-Point (enter as an integer, eg: 0): "))
    b = int(input("End-Point (enter as an integer, eg: 100): "))
    return f, n, a, b

main() 
```

在 Python 2.7 中运行时，它运行良好：

```
>>> 
Function (in quotes, eg: 'x^2'; use 'x' as the variable): 'x**2'
Numbers of Rectangles (enter as an integer, eg: 1000): 1000
Start-Point (enter as an integer, eg: 0): 0
End-Point (enter as an integer, eg: 100): 100

Integration of x**2 is: 333833.5 
```

然而，在 Python 3.3（我的老师坚持我们使用它）中，它在我的函数中引发了一个错误，`integral`输入相同：

```
Traceback (most recent call last):
  File "D:\my_stuff\Google Drive\documents\SCHOOL\Programming\Python\Programming Class\integration.py", line 20, in <module>
    main()
  File "D:\my_stuff\Google Drive\documents\SCHOOL\Programming\Python\Programming Class\integration.py", line 8, in main
    result = integral(f, n, a, b)
  File "D:\my_stuff\Google Drive\Modules\nums.py", line 142, in integral
    num += eval(function)
TypeError: unsupported operand type(s) for +=: 'int' and 'str' 
```

此外，`integral`它本身（在 Python 3.3 中）可以正常工作：

```
>>> from nums import integral
>>> integral('x**2')
333833.4999999991 
```

正因为如此，我相信问题出在我的课程计划中......感谢任何和所有帮助。谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T01:02:27.827

您遇到的问题是`input`在 Python 2 和 Python 3 中的工作方式不同。在 Python 3 中，该`input`函数的工作方式与 Python 2 中的一样`raw_input`。Python 2 的`input`函数与`eval(input())`Python 3 中的函数相同。

由于您使用公式键入的引号，您遇到了麻烦。当您在 Python 2 上运行时键入`'x**2'`（带引号）作为公式时，文本会`eval`在函数中被编辑，`input`并且您会得到一个不带引号的字符串作为结果。这行得通。

当您将相同的字符串提供给 Python 3 的`input`函数时，它不会执行`eval`，因此引号仍然存在。当您稍后`eval`将公式作为积分计算的一部分时，您会得到字符串`x**2`（不带任何引号）作为结果，而不是`x`平方的值。当您尝试将字符串转换为 时，这会导致异常`0`。

为了解决这个问题，我建议要么只使用一个版本的 Python，要么将以下代码放在文件顶部以`input`在两个版本中获得 Python 3 样式：

```
# ensure we have Python 3 semantics from input, even in Python 2
try:
    input = raw_input
except NameError:
    pass 
```

然后只需输入不带引号的公式，它应该可以正常工作。

# html - 子菜单仅悬停部分工作

> ID：14783600
> 
> 赞同：0
> 
> 时间：2013-02-09T00:36:22.193
> 
> 标签：html, css, drop-down-menu, hover, onhover

这里是：

[http://gyazo.com/e94edf3c9b10bc33c2d9be8ed049583e](http://gyazo.com/e94edf3c9b10bc33c2d9be8ed049583e)

如您所见，子菜单有效，当我将鼠标悬停在子菜单上的某些内容上时，它会创建一个灰色背景。问题是，一旦我进入“运动版”，悬停基本上取消并关闭子菜单。它停在那条蓝线开始的地方。

这是代码：HTML：

```
<div id="toprightunder">
    <ul>
        <li>
          <a href="#">Content options</a>
          <ul>
                <li><a href="#">Default Homepage</a></li>
                <li><a href="#">News Edition </a>li>
                <li><a href="#">Entertainment Edition</a></li>
                <li><a href="#">Sports Edition</a></li>
                <li><a href="#">Latino Edition</a></li>
            </ul>
        </li>
    </ul>
</div> 
```

CSS：（有很多，因为我测试了很多）

```
#toprightunder {
    margin-top:18px;
    height:15px;
    position:absolute;
    width:200px;
    right:0;
}
#toprightunder a {
    text-decoration:none;
    color:rgb(100, 100, 100);
    margin-left:0;
    padding-bottom:3px;
}
#toprightunder ul {
    list-style:none;
    margin:0 auto;
    /*text-align:right;*/
    position:relative;
    display:inline-table;
    margin-left:0;
    padding-left:0;
}
#toprightunder ul li {
    display:inline;
    color:rgb(100, 100, 100);
    font-family:"arial", times, sans-serif;
    font-size:10px;
    margin-top:13px;
    text-decoration:none;
    margin-left:0;
    padding-left:0;
}
#toprightunder ul ul {
    display:none;
}
#toprightunder ul li:hover > ul {
    display:block;
}
#toprightunder ul ul {
    position: absolute;
    top: 100%;
    padding-top:2px;
    padding-bottom:7px;
    margin-right:0;
    right:0px;
    background: white;
    border: 1px solid #000;
    overflow:hidden;
    height:auto;
    margin:auto;
}
#toprightunder ul ul li {
    position:relative;
    color:rgb(100, 100, 100);
    font-size:13px;
    display:block;
    /*margin-bottom:10px;
padding-left:25px;
padding-right:4px;*/
    white-space:nowrap;
    height:auto;
    margin:auto;
}
#toprightunder ul ul li a {
    color:#fff;
    text-align:left;
    float:left;
    margin-right:0;
    position:relative;
}
#toprightunder a:hover {
    background-color:transparent;
    color:rgb(100, 100, 100);
}
#toprightunder ul li:hover > li {
    background-color:transparent;
}
#toprightunder ul ul li:hover > a {
    color:rgb(50, 50, 50);
    background:rgb(240, 240, 240);
}
#toprightunder ul ul li > a {
    color:rgb(100, 100, 100);
    padding-bottom:7px;
    padding-top:2px;
    padding-left:25px;
    width:100%;
}

#headbar a {
    text-decoration:none;
    color:white;
    padding-bottom:2px;
    padding-top:4px;
    padding-left:8px;
    padding-right:8px;
    }

#headbar ul ul {
    display:none;
    }

#headbar ul li:hover > ul {
    display:block;
    color:green;
    }

#headbar ul {
    text-decoration:none;
    list-style:none;
    margin-top:1px;
    padding:0;
    position:relative;
    }

#headbar ul li {
    display:inline;
    color: white;
    padding-bottom:2px;
    padding-top:3px;
    font-family:"arial", times, sans-serif;
    font-size:12px;
    }

#headbar ul ul {
    border-radius: 0px; 
    position: absolute; 
    top: 100%;
    padding-top:6px;
    }

#headbar ul ul li {
    float:none;
    position:relative;
    color:rgb(100,100,100);
    font-size:16px;
    }

#headbar ul ul li a {
    color:#fff;
    }

#headbar ul ul li a:hover {
    }

/*#headbar ul:after {
    content: "";
    clear:both;
    display:block;*/

#headbar a:hover {
    background-color:rgb(255,255,255);
    color:rgb(100,100,100);
    }

#headbar ul li:hover > a{
    color:rgb(50,50,50);
    background-color:transparent;
    padding-top:8px;
    }

#headbar ul ul li > a {
    color:rgb(100,100,100);
    padding-top:8px;
    }

#headbar {
    width: 100%;
    height: 20px;
    background-color: rgb(30,144,255);
    text-decoration:none;
    padding-top:129px;
    text-align: left;
    /*position:relative;*/
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:05:38.833

添加`z-index: 2;`到`#toprightunder`选择器，这应该可以解决您的问题。

```
#toprightunder {
    margin-top:18px;
    height:15px;
    position:absolute;
    width:200px;
    right:0;
    z-index: 2;
} 
```

# iis - “更漂亮的 URL”的 MVC4 URL 重写别名

> ID：14783605
> 
> 赞同：0
> 
> 时间：2013-02-09T00:36:49.150
> 
> 标签：iis, razor, asp.net-mvc-4, asp.net-mvc-routing, url-rewrite-module

我目前对 Microsoft 的 MVC4 有点陌生，我不太了解路由以及我想要的。

我想要做的是让我的 URL 更易于阅读。目前，我的 URL 如下所示：

*   foo.com/UserProfile/Details/6
*   foo.com/UserExperience/Details/
*   foo.com/UserSpecificController/Edit/8

所有用户控制器都以“用户”为前缀，我想知道是否可以更改这些 URL，使它们看起来像这样：

*   foo.com/u/Profile/Details/6
*   foo.com/u/Experience/Details/
*   foo.com/u/SpecificController/Edit/8

我的第一次尝试是使用 IIS：

```
<rewrite>
        <rules>
            <rule name="AddTrailingSlashRule1" stopProcessing="true">
                <match url="(.*[^/])$" />
                <conditions>
                    <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                    <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                </conditions>
                <action type="Redirect" url="{R:1}/" />
            </rule>
            <rule name="Pretty User Redirect" enabled="false" stopProcessing="true">
                <match url="User(.*)/(.*)" />
                <action type="Redirect" url="u/{R:1}/{R:2}" />
                <conditions>
                </conditions>
            </rule>
            <rule name="User pretty URL Rewrite">
                <match url="u/(.*)/(.*)" />
                <action type="Rewrite" url="User{R:1}/{R:2}" />
            </rule>
        </rules>
    </rewrite> 
```

这工作得很好，除了我会在我所有的链接上得到 /u/ ，无处不在......

例如：foo.com/Home/WhatWeDo/

会出来像：foo.com/u/Home/WhatWeDo/

这将是 404。

我正在使用默认路由配置

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
            ); 
```

我所有的链接都是用@Html.ActionLink(...)

如果有人能对此有所了解，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:07:54.037

删除您的自定义 IIS 重写规则并将其插入到您的默认路由之前

```
routes.MapRoute(
    name: "UserProfile",
    url: "u/Profile/{action}/{id}",
    defaults: new { controller = "Home", id = UrlParameter.Optional }
);

routes.MapRoute(
   name: "UserExperience",
   url: "u/Experience/{action}/{id}",
   defaults: new { controller = "Home", id = UrlParameter.Optional }
); 
```

编辑：区域

使用区域，您可以对相关控制器进行分组

```
Profile controller within a User area
/User/Profile/Details

Experience controller
/User/Experience/Details 
```

然后该区域的 RegisterArea 只需一个自定义规则来替换您的路线中的“u”

```
context.MapRoute(
    "UsersRoute",
    "u/{controller}/{action}/{id}",
    new { Controller = "Home", action = "Index", id = UrlParameter.Optional },
    new string[] { "MyNamespace.MyProj.Areas.User.Controllers" }
); 
```

# r - 在R中逐行合并多个data.frame

> ID：14783606
> 
> 赞同：11
> 
> 时间：2013-02-09T00:36:58.157
> 
> 标签：r, merge, dataframe, do.call

我想在 R 中使用`merge`多个，做一个完整的外连接。为此，我希望执行以下操作：`data.frame``row.names`

```
x = as.data.frame(t(data.frame(a=10, b=13, c=14)))
y = as.data.frame(t(data.frame(a=1, b=2)))
z = as.data.frame(t(data.frame(a=3, b=4, c=3, d=11)))
res = Reduce(function(a,b) merge(a,b,by="row.names",all=T), list(x,y,z))

Warning message:
In merge.data.frame(a, b, by = "row.names", all = T) :
  column name ‘Row.names’ is duplicated in the result
> res
  Row.names Row.names V1.x V1.y V1
    1         1         a   10    1 NA
    2         2         b   13    2 NA
    3         3         c   14   NA NA
    4         a      <NA>   NA   NA  3
    5         b      <NA>   NA   NA  4
    6         c      <NA>   NA   NA  3
    7         d      <NA>   NA   NA 11 
```

我希望得到的是：

```
 V1 V2 V3
  a 10 1  3
  b 13 2  4
  c 14 NA 3
  d NA NA 11 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T00:54:41.970

以下作品（最多一些最后的列重命名）：

```
res <- Reduce(function(a,b){
        ans <- merge(a,b,by="row.names",all=T)
        row.names(ans) <- ans[,"Row.names"]
        ans[,!names(ans) %in% "Row.names"]
        }, list(x,y,z)) 
```

确实：

```
> res
  V1.x V1.y V1
a   10    1  3
b   13    2  4
c   14   NA  3
d   NA   NA 11 
```

行连接会发生什么情况是在答案中添加了具有原始行名的列，而该列又不包含行名：

```
> merge(x,y,by="row.names",all=T)
  Row.names V1.x V1.y
1         a   10    1
2         b   13    2
3         c   14   NA 
```

此行为记录在`?merge`（在值下）

> 如果匹配涉及行名，则在左侧添加一个名为 Row.names 的额外字符列，并且在所有情况下，结果都具有“自动”行名。

当`Reduce`尝试再次合并时，除非手动清理名称，否则找不到任何匹配项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T01:03:54.107

为了连续性，这不是一个干净的解决方案，而是一种解决方法，我使用`sapply`.

```
Reduce(function(a,b) merge(a,b,by=0,all=T),
                      sapply(list(x,y,z),rbind))[,-c(1,2)]
   x y.x y.y
1 10   1   3
2 13   2   4
3 14  NA   3
4 NA  NA  11
Warning message:
In merge.data.frame(a, b, by = 0, all = T) :
  column name ‘Row.names’ is duplicated in the result 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-17T18:48:01.307

出于某种原因，我在使用 Reduce 方面没有取得多大成功。给定一个 data.frames 列表（df.lst）和一个后缀列表（suff.lst）来更改相同列的名称，这是我的解决方案（它是循环，我知道它对于 R 标准来说很难看，但它有效） ：

```
df.merg <- as.data.frame(df.lst[1])
colnames(df.merg)[-1] <- paste(colnames(df.merg)[-1],suff.lst[[1]],sep="")
for (i in 2:length(df.lst)) {
    df.i <- as.data.frame(df.lst[i])
    colnames(df.i)[-1] <- paste(colnames(df.i)[-1],suff.lst[[i]],sep="")
    df.merg <- merge(df.merg, df.i, by.x="",by.y="", all=T)
} 
```

# joomla2.5 - Joomla 有没有办法使用从组件到另一个组件的数据？

> ID：14783609
> 
> 赞同：0
> 
> 时间：2013-02-09T00:37:21.377
> 
> 标签：joomla2.5

我正在尝试在另一个组件上使用来自一个组件的联系人数据。有没有办法我可以做到这一点？如果是这样，有人可以引导我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T20:54:12.597

是的...您可能必须将它们各自的库/对象/模型/ect导入您正在使用的代码中：

```
require_once(''): 
```

或 joomla 的

```
jimport('joomla.application.component.controller'); 
```

看

```
http://docs.joomla.org/Jimport 
```

# php - 表单提交：foreach 循环中的 PHP S_SESSION 语句

> ID：14783612
> 
> 赞同：1
> 
> 时间：2013-02-09T00:37:43.733
> 
> 标签：php, arrays, forms, session, foreach

假设我有以下 PHP 代码，它尝试从一个名为 {fullname, studentnumber, email} 的数组`$arr`中*读取*。提交我的 HTML 表单后，此 PHP 代码将执行 foreach 循环，并将发布到页面的值存储在`$_SESSION`数组中。

```
foreach($arr as $field):
    $_SESSION[$field] = $_POST[$field];
endforeach; 
```

上面的代码没有按预期工作。如果我用下面的代码替换上面的代码块，我页面上字段中的值会正确存储在`$_SESSION`数组中。

```
$_SESSION[fullname] = $_POST[fullname];
$_SESSION[studentnumber] = $_POST[studentnumber];
$_SESSION[email] = $_POST[email]; 
```

我如何以一种有效且可扩展的方式实现这一目标？我不想每次在表单中添加新字段时都编写新的 $_SESSION 语句。

编辑：//第一块代码实际上按预期工作。原来有错别字！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:49:13.813

你想要的是使用 array_keys() 否则你会得到数组内容。

```
foreach (array_keys($arr) as $field) 
```

让我知道这是否有效/是您正在寻找的:)

# php - PHP DOM 保留 Html 结构

> ID：14783614
> 
> 赞同：1
> 
> 时间：2013-02-09T00:37:49.457
> 
> 标签：php, dom

我有这个代码

```
 $strhtml = file_get_contents('05001400300320100033100.html');
 $dochtml = new DOMDocument();
 $dochtml->loadHTML($strhtml);
 $elm = $dochtml->getElementById('upPanelActuciones');
 $tag = $elm->tagName;
 $cnt = $elm->nodeValue;
  echo $tag. ' - '. $cnt; 
```

所以..我得到这个：

88 PEDRO NEL OSPINA 2010 年 5 月 10 日 2010 年 5 月 3 日 FIJACION ESTADO ACTUACIÃƒÂ“N REGISTRADA EL 03/05/2010 A LAS 11:32:40。2010 年 5 月 5 日 2010 年 5 月 5 日 2010 年 5 月 3 日 2010 年 5 月 3 日 AUTO RECHAZA DEMANDA T.4 2010 年 5 月 3 日 2010 年 4 月 7 日 RADICACIÃƒÂ“N DE PROCESO ACTUACIÃƒÂ”N DE RADICACIÃƒÂ“N DE PROCESO REALIZADA EL 07/04/2010 A LAS 17: :12 2010 年 4 月 7 日 2010 年 4 月 7 日 2010 年 4 月 7 日

只是一个纯文本。

所以，我的问题是：有没有办法保留 Html 结构，我的意思是“upPanelActuciones”中的 Td 和 Tr 或我想要的任何其他标签或属性？

在此先感谢您的帮助！.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:40:03.277

那是因为该`nodeValue`属性只会为您获取该节点的文本内容。

请改用以下[`saveXml()`](http://php.net/manual/en/domdocument.savexml.php)方法：

```
$elm = $dochtml->getElementById('upPanelActuciones');

print $dochtml->saveXml($elm); 
```

# vba - 如何将引发的错误传递给 VBA 中的自定义错误处理程序？

> ID：14783616
> 
> 赞同：9
> 
> 时间：2013-02-09T00:37:59.727
> 
> 标签：vba, excel

我在 Excel 中使用 VBA 已经有一段时间了，我对所有程序都使用了自定义错误处理程序。我第一次发现自己处于需要使用`Err.Raise`（处理块`Case Else`中的情况`Select Case`）的位置。我不知道如何将错误传递给自定义错误处理程序。VBA 没有将引发的错误传递给自定义处理程序，而是弹出自己的丑陋且相当无用的错误对话框。如果有人能告诉我解决此问题的方法，我将不胜感激。

下面是我正在使用的代码的通用版本（函数/变量名称已更改以保护无辜者）。该`gErrorHandler`对象是一个全局维度的类模块变量，它处理来自任何和所有过程的错误。

```
Public Function MyFunction(dblInputParameter As Double) As Double
On Error GoTo Err_MyFunction

    Dim dblResult as Double

    Select Case dblInputParameter 

        ...Several case statements go here...

        Case Else
            Err.Raise vbObjectError + 1000, "MyProjectName.MyObjectName", "Error Description"

    End Select

    MyFunction = dblResult

Exit_MyFunction:
    Exit Function

Err_MyFunction:
    gErrorHandler.DisplayError Err.Number, Err.Description, Erl, csModule, "basMyModuleName", "MyFunction"
    Resume Exit_MyFunction

End Function 
```

这是我得到的错误对话框，而不是将错误传递给自定义处理程序：

![在此处输入图像描述](../Images/17602bd0ef6c738683a6ad105f45bcb2.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T01:03:04.897

正如 Tim 在他的评论中指出的那样，答案是 VBA IDE 被配置为中断所有错误。将其更改为在未处理的错误上中断只会给我我想要的行为。

![在此处输入图像描述](../Images/a29f25a305b9f35d27ec545a35d37951.png)

# linux - 如何正确发送路由器广告？

> ID：14783617
> 
> 赞同：7
> 
> 时间：2013-02-08T18:40:40.733
> 
> 标签：linux, drivers, router, ipv6

我正在开发一个没有手头设备的 IPv6 linux 设备驱动程序。所以我现在试图用虚假的路由器广告消息来欺骗内核。

```
unsigned char c[] = {0x33, 0x33, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 61, 0x86, 0xdd, //IPv6 type
            0x60, 0x00, 0x00, 0x00, //Version, ...
            0x00, 24, //payload length
            58,         //next header 
            255,        //hop limit 
            0xfe, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0xff, 0xfe, 0x00, 0x00, 0x3d, //source
            0xff, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, //destination
            134, //type
            0, //code,
            0x7a, 0x2c, //checksum
            255, //current hop limit
            0x80, //flag
            0xff, 0xff,
            0x00, 0x00, 0x00, 0x00, //reachable timer
            0x00, 0x00, 0x00, 0x00,
            0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 61, //source link-layer address   
            }; 
```

我尝试使用 Tcpdump 来抓取我发送给内核的这个数据包。而且我发现内核真的得到了这个数据包。

```
13:32:59.989851 00:00:00:00:00:3d (oui Ethernet) > 33:33:00:00:00:02 (oui Unknown), ethertype IPv6 (0x86dd), length 78: (hlim 255, next-header ICMPv6 (58) payload length: 24) fe80::200:ff:fe00:3d > ip6-allnodes: [icmp6 sum ok] ICMP6, router advertisement, length 24
    hop limit 255, Flags [managed], pref medium, router lifetime 65535s, reachable time 0s, retrans time 0s
      source link-address option (1), length 8 (1): 00:00:00:00:00:3d
        0x0000:  0000 0000 003d 
```

但之后我`ip -6 neigh`会检查内核是否在邻居表中存在假节点。我找不到它了。

我的问题是什么？任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T20:32:29.380

也许这些黑客工具包会有所帮助

1.  [IPv6-toolkit](https://github.com/fgont/ipv6-toolkit "IPv6 工具包") - *ra6*程序伪造路由器广告
2.  [THV-IPv6](http://www.thc.org/thc-ipv6/ "THV-IPv6") - *fake_advertise6* 程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T12:33:00.140

为什么要伪造路由器广告？

在您的情况下，我会在同一以太网链路上放置第二个 Linux（如果您没有物理设置，则在 VMWare 或任何其他虚拟环境中），在第二个 Linux 上安装[radvd](http://www.litech.org/radvd/)，然后让 radvd 在关联。

# javascript - Windows 8 音频在后台播放

> ID：14783618
> 
> 赞同：1
> 
> 时间：2013-02-09T00:38:07.540
> 
> 标签：javascript, html, windows-8, microsoft-metro, windows-store-apps

我已经阅读了微软以前的帖子和文档，但似乎无法让我的应用程序在后台运行声音。它播放 100%，但当应用程序暂停时，音乐也会停止。我添加了选择音频的“后台任务”声明，我的音频标签看起来像这样

```
<audio id="musicplayr" msAudioCategory="BackgroundCapableMedia" controls="controls"><source src="song.mp3"/> </audio 
```

最后我的 javascript 包含对 MediaControls 的引用

```
var MediaControls = Windows.Media.MediaControl;

        // Add event listeners for the buttons
        MediaControls.addEventListener("playpressed", play, false);
        MediaControls.addEventListener("pausepressed", pause, false);
        MediaControls.addEventListener("playpausetogglepressed", playpausetoggle, false);

        // Add event listeners for the audio element
        document.getElementById("musicplayr").addEventListener("playing", playing, false);
        document.getElementById("musicplayr").addEventListener("paused", paused, false);
        document.getElementById("musicplayr").addEventListener("ended", ended, false); 
```

在代码下面我有事件处理程序

```
// Define functions that will be the event handlers
function play() {
    document.getElementById("musicplayr").play();
}
function pause() {
    document.getElementById("musicplayr").pause();
}

function playpausetoggle() {
    if(MediaControls.isPlaying === true) {
        document.getElementById("musicplayr").pause();
    } else {
        document.getElementById("musicplayr").play();
    }
}

function playing() {
    Windows.Media.MediaControl.isPlaying = true;
}

function paused() {
    Windows.Media.MediaControl.isPlaying = false;
}

function ended() {
    Windows.Media.MediaControl.isPlaying = false;
} 
```

*注意musicplayr是html5标签的参考

任何帮助赞赏为什么这不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T03:26:05.843

您还需要 stoppressed 事件的事件处理程序。如果没有四个处理程序中的任何一个——playpressed、pausepressed、playpausetogglepressed 和 stoppressed——将不会启用背景音频。请参阅提出相同问题的 MSDN 论坛上的[http://social.msdn.microsoft.com/Forums/en-IN/winappswithhtml5/thread/2ca0c122-df31-401c-a444-2149dd3e8d68 。](http://social.msdn.microsoft.com/Forums/en-IN/winappswithhtml5/thread/2ca0c122-df31-401c-a444-2149dd3e8d68)

.克雷格

# c# - Linq to XML 显示错误“使用未分配的局部变量..”？

> ID：14783623
> 
> 赞同：1
> 
> 时间：2013-02-09T00:38:42.880
> 
> 标签：c#, linq-to-xml

很困惑为什么这给了我错误我认为我的代码是正确的

```
XElement outer = new XElement("Main");
XElement xsets;
XElement xsubsets;
foreach (DataRow nav_sets in GetNavigationSets().Rows)
{
    if (nav_sets["parent_id"].ToString() == null)
    {
        xsets = new XElement("Menu", nav_sets["name"].ToString());
    }
    else
    {
        if (int.Parse(nav_sets["id"].ToString()) == int.Parse(nav_sets["parent_id"].ToString()))
        {
            xsubsets = new XElement("SubMenu", nav_sets["name"].ToString());
            foreach (DataRow nav_menus in GetMenusInNavigationSetByNavigation(int.Parse(nav_sets["id"].ToString())).Rows)
            {
                foreach (DataRow menus in GetMenuById(int.Parse(nav_menus["menu_id"].ToString())).Rows)
                {
                    xsubsets.Add(new XElement("MenuItem", menus["name"].ToString()));
                }
            }
        }
        xsets.Add(xsubsets);
    }
    outer.Add(xsets);
}
outer.Save("main.xml");
cn.Close(); 
```

错误部分显示在这行代码中`xsets.Add(xsubsets);`

错误：

> 错误 1 ​​使用未分配的局部变量 'xsets'
> 错误 2 使用未分配的局部变量 'xsubsets'

很困惑如何摆脱这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:41:59.133

改变它从

```
XElement xsets;
XElement xsubsets; 
```

至

```
XElement xsets = null;
XElement xsubsets = null; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T00:55:21.227

您面临的问题是编译器无法在编译时判断 if 语句的第一种情况是在第二种情况之前采用的。同样在第二种情况下，它不知道`xsubsets`使用了 before ，该`if`语句将评估为 true 并创建它。虽然您可能会因为预期输入的格式而知道这一点，但编译器却不能并给出关于使用未分配变量的错误。通过给变量一个初始值（甚至`null`），你给它们一个值并且编译器很满意你知道你在做什么并且没有犯错误。当然，如果您确实将它们设置为`null`然后尝试在使用它们之前引用它们的属性，你会得到一个运行时异常，但如果你确定你满足它的标准，编译器的工作就不用担心这个了。

通过分配初始值来解决编译器警告`null`。我的偏好是超越这一点并`null`在使用它们之前检查值，以便您可以抛出带有更有意义的错误消息的异常并记录异常条件。

# c++ - C++ 设置动态创建数组的值失败

> ID：14783626
> 
> 赞同：1
> 
> 时间：2013-02-09T00:38:56.390
> 
> 标签：c++, windows, arrays

一些简单的代码似乎不起作用，我不知道为什么。

![在此处输入图像描述](../Images/b9c86c819974585c8b72dd89486b014a.png)

我正在动态创建一个整数数组。这个数组的大小显示为 15，但这只是因为我正在尝试调试程序。实际大小在运行时是可变的。

我浏览了一些网站，了解如何在 C++ 中动态创建整数数组。像[这样](http://www.fredosaurus.com/notes-cpp/newdelete/50dynamalloc.html)的网站出现了。他们的代码看起来像我的代码：创建了一个数组，然后`for`循环设置数组中每个元素的值。

但是在我的 for 循环运行之后，我得到一个大小为 0 的数组。可能是什么问题？

这是一个在 Windows 上使用 Visual Studio 编译的非常基本的 C++ 程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T00:47:46.780

指针与数组不同，调试器只会显示第一个元素的内容及其地址。您的动态数组已正确创建，您可以添加`array[0],... array[14]`到`watch window`，您可以看到内存中的每个变量。 ![在此处输入图像描述](../Images/c79c06c3670feb7f3188479d253c7963.png)

或者通过数组内存地址到DEBUG->Windows->Memory->Memory1，可以看到内存中的每个元素都被正确初始化了

![在此处输入图像描述](../Images/fe7af1e39bd2fb4c843573d96d0722d3.png)

如果您声明静态数组，调试器应该向您显示所有元素：

```
 int array2[15]; 
```

这些是基本的调试技能，在调试应用程序时会变得很方便。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T00:43:30.083

调试器不知道它是指向数组开头的指针，它认为您有一个指向 an 的普通指针`int`（因为这是`array`:的类型`int*`）。所以它显示了它的值`int`（数组中的第一个元素），它就在`0`这里。

你的代码很好；您确实已经正确分配（并初始化）了一个 15`int`秒的数组。

# java - 从列表中选择的 Spring jpaTemplate 语法

> ID：14783628
> 
> 赞同：0
> 
> 时间：2013-02-09T00:39:00.387
> 
> 标签：java, spring, list, select, jpa

我觉得自己像个菜鸟，想弄清楚这个——

我想知道从数字列表中选择以下 jpa 查询的正确语法。?

```
List<Long> personIds = new ArrayList<Long>();
personIds.add(1L);
personIds.add(2L);
jpaTemplate.find("select count(*) from Person p where p.id in (?) ",personIds); 
```

当我尝试时，我得到

```
 "java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.lang.Long" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T21:59:03.487

我像这样使用EntityManager修复了它-

```
Query q = jpaTemplate.getEntityManager().find("select count(*) from Person p where p.id in :personIds") ; 
q.setParameter("personIds",personIds); 
q.getResultSet(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T08:10:17.873

尝试在 JPQL 中设置不带括号的参数。像这样的东西：

```
List<Long> personIds = new ArrayList<Long>();
personIds.add(1L);
personIds.add(2L);
jpaTemplate.find("select count(*) from Person p where p.id in ?",personIds); 
```

我认为这应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-05T11:32:43.727

您的查询返回 Long 因为`count`，并且您想将该 long 分配给列表

# ios - InAppSettingsKit 和核心数据

> ID：14783629
> 
> 赞同：0
> 
> 时间：2013-02-09T00:39:20.787
> 
> 标签：ios, xcode, cocoa-touch, core-data, inappsettingskit

我目前正在实施一个自定义 IASKSettingsStore 以使用核心数据。你可以看到下面的代码。问题是值的存储变得非常缓慢。例如，当我在文本字段中输入内容时，我知道 IASKAppSettingsViewController 会存储所有更改，但我发现即使是单个更改也存储得非常慢。我怎样才能使这项工作更快？

我监督什么？提前致谢。

**到目前为止，自定义 IASKSettingsStore 如下所示：**

```
@implementation GPSettingsStoreCoreData

@synthesize managedObject = _managedObject;

- (id)initWithManagedObject:(NSManagedObject *)managedObject {
    self = [super init];
    if( self ) {
        _managedObject = managedObject;
    }
    return self;
}

- (id)init
{
    if (self = [super init]) {
        _managedObject = nil;
    }
    return self;
}

- (void)setBool:(BOOL)value forKey:(NSString*)key {
    [self.managedObject setValue:[NSNumber numberWithBool:value] forKey:key];
}

- (void)setFloat:(float)value forKey:(NSString*)key {
    [self.managedObject setValue:[NSNumber numberWithFloat:value] forKey:key];
}

- (void)setDouble:(double)value forKey:(NSString*)key {
    [self.managedObject setValue:[NSNumber numberWithDouble:value] forKey:key];
}

- (void)setInteger:(int)value forKey:(NSString*)key {
    [self.managedObject setValue:[NSNumber numberWithInt:value] forKey:key];
}

- (void)setObject:(id)value forKey:(NSString*)key {
    [self.managedObject setValue:value forKey:key];
}

- (BOOL)boolForKey:(NSString*)key {
    return [[self.managedObject valueForKey:key] boolValue];
}

- (float)floatForKey:(NSString*)key {
    return [[self.managedObject valueForKey:key] floatValue];
}

- (double)doubleForKey:(NSString*)key {
    return [[self.managedObject valueForKey:key] doubleValue];
}

- (int)integerForKey:(NSString*)key {
    return [[self.managedObject valueForKey:key] intValue];
}

- (id)objectForKey:(NSString*)key {
    return [self.managedObject valueForKey:key];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T13:29:03.783

好吧，我终于弄清楚了问题出在哪里。与 InAppSettingsKit 无关。我将 InAppSettingsKit 控制器作为模式视图控制器从具有 NSFetchedResultsController 的视图控制器呈现。因此，我在设置控制器中所做的每一次更改都会调用 NSFetchedResultsController 的委托。结果，整个表视图被不必要地重新加载。我使用模态视图控制器的子托管对象对象上下文解决了它。我发现了一篇关于该主题的非常有用的文章：http: [//www.cocoanetics.com/2012/07/multi-context-coredata/](http://www.cocoanetics.com/2012/07/multi-context-coredata/)

到目前为止，我在上面发布的用于 Core Data 的自定义 IASKSettingsStore 运行良好，因此您可以根据需要将其实现到您自己的项目中。

# javascript - JavaScript 中的无限精度算术

> ID：14783631
> 
> 赞同：2
> 
> 时间：2013-02-09T00:39:38.370
> 
> 标签：javascript, precision

在 JavaScript 中，函数`alert((3*3*Math.sqrt(2))/13)`prints`0.9790709277967582`只是表达式真实值的近似值。有没有什么方法可以像这样在 JavaScript 中执行算术运算而不会损失精度，以便`3*3*sqrt(2))/13`输出类似的东西`9*(2)^(1/2)/13`，它是精确值，而不是`0.9790709277967582`，它只是一个近似值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:43:34.427

这里有一个库：[https ://github.com/whatgoodisaroad/Big-js/downloads](https://github.com/whatgoodisaroad/Big-js/downloads)

它有一堆函数，比如`myNum.add(otherNum)`，所以使用起来可能会有点困难。但是，如果您需要无限精度，则必须这样做。

例子：

```
var number1 = new Big("12.00000000000000005");
var number2 = new Big("12");

number1.lessThanOrEqualTo(number2); // False, like it should be. 
```

# image - 如何为图像控件设置圆角？

> ID：14783632
> 
> 赞同：2
> 
> 时间：2013-02-09T00:39:52.427
> 
> 标签：image, button, controls, windows-phone-8, rounded-corners

## 背景

我是 Windows Phone 8 的菜鸟。我过去学习过 WPF 和 Silverlight，但那是很久以前的事了。

在 Windows phone 8 上，我有一个可点击的图像控件，我希望它的内容（图片本身）具有圆角。

## 问题

如何为控件设置圆角？

另外，我可能会考虑使用 Button 控件，以便我可以自定义单击（或触摸）它时发生的情况。单击后，我希望具有圆角的区域以某种颜色着色，表明它确实被单击/触摸。我怎么做？

* * *

编辑：

感谢@Depechie，我找到[了这个解决方案](https://stackoverflow.com/a/5801561/878126)：

```
<Grid>
    <Border Height="200" Width="250" CornerRadius="0,0,50,50">
        <Border.Background>
            <ImageBrush ImageSource="Images/Desert.jpg" />
        </Border.Background>
    </Border>
</Grid> 
```

但是，我有两个问题：

1.  我仍然找不到如何让它在你触摸它时被点击，这样圆角就会有黄色背景。

2.  处理点击事件时，我无法通过代码获取 imageSource 和转换器（及其参数）。以前，我使用过：

    图片缩略图图片 =（图片）发件人；var bindingExpression = thumbnailImage.GetBindingExpression(Image.SourceProperty); string selectedItem = (string)bindingExpression.DataItem; string selectedThumbnailIndex = (string) bindingExpression.ParentBinding。转换器参数；

    也许我可以以编程方式而不是 Xaml 创建项目？如果是这样，如何（项目在网格中，顺便说一句）？

我现在能做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-09-03T21:47:15.850

使用 Rect 试试这个

```
<Image VerticalAlignment="Center" 
                       HorizontalAlignment="Center" 
                       Stretch="None" 
                       Source="Jellyfish.jpg">
                    <Image.Clip>
                        <RectangleGeometry RadiusX="5"
                                           RadiusY="5"
                                           Rect="0,0,150,113"/>
                    </Image.Clip>
                </Image> 
```

这是另一个链接 [https://msdn.microsoft.com/en-us/library/ms750631(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/ms750631(v=vs.110).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T10:31:35.103

这里列出了一个类似的问题[......](https://stackoverflow.com/questions/14598375/how-to-mask-a-square-image-into-an-image-with-round-corners/) 也许这些也可以帮助你？

如果您想错觉图像是可点击的控件，请查看[Phone 工具包](http://phone.codeplex.com/)中提供的[TiltEffect](http://windowsphonegeek.com/articles/using-tilteffect-in-wp7)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:55:31.383

与其尝试改变控件的形状（在查看 VS 和 Blend 之后，我认为这是不可能的），为什么不简单地创建带有圆边的图像，然后将按钮边框和背景设置为无颜色？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T00:56:25.403

对于圆角，您可以将 RadiusX 和 RadiusY 值设置为非零数字以在矩形中实现该效果。所以我想如果你想保留按钮控制，你可以在矩形内嵌入一个按钮。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-09T09:06:59.503

```
<Image  Width="25" Height="25"  VerticalAlignment="Center" 
                       HorizontalAlignment="Center" 
                       Stretch="Fill" 
                        >
                                                        <Image.Clip>
                                                            <RectangleGeometry RadiusX="12.5"
                                           RadiusY="12.5"
                                           Rect="0,0,25,25"/>
                                                        </Image.Clip>
                                                    </Image> 
```

拐角半径应为宽度或高度的一半。

# c# - Game Center 在 EAGLView 中擦除纹理

> ID：14783636
> 
> 赞同：0
> 
> 时间：2013-02-09T00:40:05.687
> 
> 标签：c#, xamarin.ios, eaglview

我在 MonoTouch 中集成 Game Center 时遇到问题，Game Center 登录视图正在加载，但它正在擦除当前加载的所有纹理。如果我注释掉 PresentModalViewController 行，那么游戏中心登录表单不会出现，但是已经加载的纹理会保留在内存中并且可以工作。我正在使用以下代码来显示游戏中心视图：

```
 GKLocalPlayer.LocalPlayer.AuthenticateHandler = (ui, ErrorCode) =>
        {
            if (ui != null) {
                Debug.WriteLine ("GK Not authenticated, presenting login");
                PresentModalViewController (ui, true);
            } else {
                Debug.WriteLine ("GK Checking Authentication");
                bool authenticated = GKLocalPlayer.LocalPlayer.Authenticated;

                if (authenticated)
                    Debug.WriteLine ("Game Center Authenticated. " + GKLocalPlayer.LocalPlayer.DisplayName);
                else
                    Debug.WriteLine ("Game Center Not Authenticated. " +  GKLocalPlayer.LocalPlayer.PlayerID + " " + ErrorCode.ToString());
            }
        }; 
```

有没有人见过这个问题，如果是这样，显示游戏中心登录页面但保留加载的纹理的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T15:40:22.193

找到了这个问题的答案，它与 MonoTouch OpenTK 示例应用程序建议在 ViewWillDisappear 事件中销毁渲染缓冲区有关，该事件发生在 GameCentre 窗口出现时。当 Buffer 被销毁时，纹理随之而来，因此这里的解决方案是在 ViewWillDisappear 事件中不销毁渲染缓冲区（随后，不要在 ViewWillAppear 中重新创建它）。

# c - C中的广义缩减梯度算法

> ID：14783639
> 
> 赞同：4
> 
> 时间：2013-02-09T00:40:57.263
> 
> 标签：c, algorithm, nonlinear-optimization

我正在从事一些科学项目，我需要广义缩减梯度算法的 C 语言实现来进行非线性优化。是否有任何库或只是一段代码？或者，请为非线性多变量问题提出任何其他解决方案。我正在寻找使用 4 个自变量和 2 个常数来构建优化模型：该模型是非线性的。我已经检查了 Microsoft Excel 的 Solver，使用广义缩减梯度 (GRG) 可以完美地解决这个模型，但我需要用 C 语言进行模拟。

这是我的 excel 解决方案： [http](http://speedy.sh/SEdZj/eof-cs-rest.xlsm) : //speedy.sh/SEdZj/eof-cs-rest.xlsm 我使用带有 GRG 算法的 Microsoft Excel Solver 来搜索 SS 的最小值，输出是 Const_a 和 Const_b 的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:09:31.840

[由GAMS](http://www.gams.com/mccarl/mccarlhtml/index.html?conopt.htm)分发的 CONOPT似乎是 GRG 的既定实现，但不是免费的（尽管演示对您来说可能就足够了）。

[Alglib 在这里](http://www.alglib.net/optimization/levenbergmarquardt.php)实现了非线性 Levenberg-Marquardt 算法，并且是 GPL / 商业许可的。

下面使用 alglib 的示例代码：

```
/*
 * Simple optimiser example
 *
 * nl_opt.cpp
 *
 * Compile with eg 'g++ -I../tools/alglib/src ../tools/alglib/src/ap.cpp ../tools/alglib/src/alglibinternal.cpp ../tools/alglib/src/linalg.cpp ../tools/alglib/src/alglibmisc.cpp ../tools/alglib/src/solvers.cpp ../tools/alglib/src/optimization.cpp nl_opt.cpp -o opt'
 *
 */

#include "stdafx.h"
#include <iostream>
#include <cmath>

#include "optimization.h"

using namespace std;

double fn(double a1, double a2, double a3, double x, double A, double B)
{
    return A * exp(-x*(a1*B*B+a2*B+a3));
}

struct problem
{
    double *m_a1s;
    double *m_a2s;
    double *m_a3s;
    double *m_xs;
    double *m_ys;

    int m_n;

    problem(double *a1s, double *a2s, double *a3s, double *xs, double *ys, int n) 
        : m_a1s(a1s), m_a2s(a2s), m_a3s(a3s), m_xs(xs), m_ys(ys), m_n(n)
    {
    }

    void fn_vec(const alglib::real_1d_array &c_var, alglib::real_1d_array &fi, void *ptr)
    {
        double sum = 0.0;
        for(int i = 0; i < m_n; ++i)
        {
            double yhat = fn(m_a1s[i], m_a2s[i], m_a3s[i], m_xs[i], c_var[0], c_var[1]);
            double err_sq = (m_ys[i] - yhat) * (m_ys[i] - yhat);
            sum += err_sq;
        }
        fi[0] = sum;
    }
};

problem *g_p;

void fn_vec(const alglib::real_1d_array &c_var, alglib::real_1d_array &fi, void *ptr)
{
    g_p->fn_vec(c_var, fi, ptr);
}

int main()
{
    cout << "Testing non-linear optimizer..." << endl;

    int n = 5;
    double a1s[] = {2.42, 4.78, 7.25, 9.55, 11.54};
    double a2s[] = {4.25, 5.27, 6.33, 7.32, 8.18};
    double a3s[] = {3.94, 4.05, 4.17, 4.28, 4.37};

    double xs[] = {0.024, 0.036, 0.048, 0.06, 0.072};
    double ys[] = {80, 70, 50, 40, 45};

    double initial[] = {150, 1.75};
    double ss_init = 0.0;

    cout << "Initial problem:" << endl;
    for(int i = 0; i < n; ++i)
    {
        double yhat = fn(a1s[i], a2s[i], a3s[i], xs[i], initial[0], initial[1]);
        double err_sq = (ys[i] - yhat) * (ys[i] - yhat);
        ss_init += err_sq;
        cout << a1s[i] << "\t" << a2s[i] << "\t" << a3s[i] << "\t" 
            << xs[i] << "\t" << ys[i] << "\t" << yhat << "\t" << err_sq << endl;
    }
    cout << "Error: " << ss_init << endl;

    // create problem
    problem p(a1s, a2s, a3s, xs, ys, n);
    g_p = &p;

    // setup solver
    alglib::real_1d_array x = "[150.0, 1.75]";
    double epsg = 0.00000001;
    double epsf = 0;
    double epsx = 0;

    alglib::ae_int_t maxits = 0;
    alglib::minlmstate state;
    alglib::minlmreport report;

    alglib::minlmcreatev(2, x, 0.0001, state);
    alglib::minlmsetcond(state, epsg, epsf, epsx, maxits);

    // optimize
    alglib::minlmoptimize(state, fn_vec);

    alglib::minlmresults(state, x, report);

    cout << "Results:" << endl;

    cout << report.terminationtype << endl;
    cout << x.tostring(2).c_str() << endl;

    double ss_end = 0.0;
    for(int i = 0; i < n; ++i)
    {
        double yhat = fn(a1s[i], a2s[i], a3s[i], xs[i], x[0], x[1]);
        double err_sq = (ys[i] - yhat) * (ys[i] - yhat);
        ss_end += err_sq;
        cout << a1s[i] << "\t" << a2s[i] << "\t" << a3s[i] << "\t"
             << xs[i] << "\t" << ys[i] << "\t" << yhat << "\t" << err_sq << endl;
    }
    cout << "Error: " << ss_end << endl;

    return 0;
} 
```

这给出了示例输出：

```
./opt 
Testing non-linear optimizer...
Initial problem:
2.42    4.25    3.94    0.024   80  95.5553 241.968
4.78    5.27    4.05    0.036   70  54.9174 227.485
7.25    6.33    4.17    0.048   50  24.8537 632.338
9.55    7.32    4.28    0.06    40  9.3038  942.257
11.54   8.18    4.37    0.072   45  3.06714 1758.36
Error: 3802.41
Results:
2
[92.22,0.57]
2.42    4.25    3.94    0.024   80  77.6579 5.48528
4.78    5.27    4.05    0.036   70  67.599  5.76475
7.25    6.33    4.17    0.048   50  56.6216 43.8456
9.55    7.32    4.28    0.06    40  46.0026 36.0314
11.54   8.18    4.37    0.072   45  36.6279 70.0922
Error: 161.219 
```

# apache - 从 apache 重写参数中删除“-”

> ID：14783640
> 
> 赞同：1
> 
> 时间：2013-02-09T00:40:58.897
> 
> 标签：apache, mod-rewrite, get

我正在使用 mod_rewrite 并想这样做：

```
RewriteRule ^item/([0-9]*)-(.*)-(.*)$ pages/page_item.php?id=$1-&name=$2-&firstname=$3 [QSA,L] 
```

成为这个

```
item/25-Foo-Bar 
```

但是当我通过 PHP var_dump $_get 参数时，我得到了这个：

```
array (size=3)
  'id' => string '25-' (length=4)
  'prenom' => string 'Foo-' (length=4)
  'nom' => string 'Bar' (length=7) 
```

前 2 个参数包括“-”字符。如何避免这种情况？谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:44:32.417

它包括，`-`因为您*明确地*将其放在重写中：

```
RewriteRule ^item/([0-9]*)-(.*)-(.*)$ pages/page_item.php?id=$1-&name=$2-&firstname=$3 [QSA,L]
#--------------------------------------------------------------^--------^--- 
```

删除那些，你会得到你期望的结果。

不过，您可以改进正则表达式。`(.*)`我建议不要使用贪婪的，而是使用`([^-]+)`. 该表达式`[^-]+`表示匹配直到但不包括下一个的所有字符`-`。

所以你的最终结果看起来像：

```
RewriteRule ^item/([0-9]*)-([^-]+)-(.*)$ pages/page_item.php?id=$1&name=$2&firstname=$3 [QSA,L] 
```

# ios - UITextview 不进入触摸编辑

> ID：14783648
> 
> 赞同：0
> 
> 时间：2013-02-09T00:42:04.287
> 
> 标签：ios, cocoa-touch, cocoa

我无法让我的 UITextView 在被触摸时变得可编辑。
根据 Apple 文档，我已包含以下代码。

```
-(BOOL)textViewShouldBeginEditing:(UITextView *)textView{
    NSLog(@"begin editing");
    return YES;
}

-(BOOL)textViewShouldEndEditing:(UITextView *)textView{
    NSLog(@"end editing");
    return NO;
} 
```

我还通读了苹果文档，并将 textview 设为委托，但它似乎仍然无法正常工作。我非常想用记事本影响完成编辑后的位置、数字等是超链接的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T14:35:57.557

记得设置你的 textView 的委托，否则这些方法不会被调用

```
self.textView.delegate = self; // assuming self is the view controller with your textView 
```

记住`<UITextViewDelegate>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:10:43.780

为了获得那种记事本效果，其中数字和链接是超链接的，你需要`UITextView`用一个特殊的`CoreTextView`. 我会根据您的需要修改类似的内容：[https](https://github.com/jasarien/CoreTextHyperlinkView) ://github.com/jasarien/CoreTextHyperlinkView 。因此，`textViewShouldEndEditing:`您将使用 填充您的 CoreTextHyperlinkView 文本`textView.text`，隐藏 textView 并显示您的 CoreTextView。反之亦然`textViewShouldBeginEditing:`。

另外，请确保`<UITextViewDelegate>`在标头中引用协议。

# mysql - 在 mysql 的同一查询中使用多个语句时是否会减少开销？

> ID：14783649
> 
> 赞同：3
> 
> 时间：2013-02-09T00:42:24.047
> 
> 标签：mysql

我想知道是否可以通过在同一个查询中向数据库发送多个语句来减少开销。这可能吗？

我目前正在一个一个发送查询，并想同时发送一批（总而言之，我发送了 2k 左右的查询）

它们都是选择查询

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:54:38.420

我在使用 Grails 和 MySQL 时使用了批量插入，插入的时间减少了 100 倍！（我使用批处理一次处理了大约 50 个插入）所以我可以肯定地说批量插入节省了很多时间。

我不确定这篇文章有多少可以帮助你，但这里[有性能帮助：SUBQUERY vs JOIN](https://stackoverflow.com/questions/7117686/help-with-performance-subquery-vs-join)

连接表的方式也可能是性能的主要问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:56:28.850

批处理 SQL 操作绝对可以提高整体速度。对于小型查询，最慢的部分通常是建立数据库连接。无论 SQL 查询本身如何，这是一个代价高昂的步骤。您可以通过减少必须创建和销毁这些数据库连接的次数来减少此开销。

# c - 有一个错误显示为“指针和整数之间的比较（'int'和'const char *'）”

> ID：14783665
> 
> 赞同：0
> 
> 时间：2013-02-09T00:44:56.050
> 
> 标签：c, pointers

```
char * piglatin(const char s[], int len) {
    char * result[len+3] = s[];
    char * current[len+3] = s[];
    if(s[0]=="o"||"u"||"e"||"a"||"i"){
        result[len-1] = "y";
        result[len-2] = "a";
        result[len-3] = "-";
    }
    else{
        for(int i = 0; i<len-1; i++){
            result[i] = current[i+1];
            result[len-1] = "-";
            result[len] = current[0];
            result[len+1] = "a";
            result[len+2] = "y";
        }
    }

    } 
```

我在为我的计算机科学课做程序作业时遇到了一个问题。如果 s 的第一个字母是元音，教授希望我们在字符串 s 之后附加“-ay”，否则删除 s 的第一个字母并附加“-?ay”。我的错误出现在 "if(s[o]=="o"||"u"||"e"||"a"||"i")" 并且它说“指针和整数之间的比较 (' int' 和 'const char *')"。我感到困惑，因为 s 不是指针，右侧也不是整数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:00:55.413

cmon 兄弟...对所有其他人使用'o'而不是“o”，并且在 if 语句中你必须将它们全部与 s[0] 像这样 s[0]=='o'||s[0]= 进行比较='u'||s[0]=='e'||s[0]=='a' 等等。但是你仍然会得到错误所以不要忘记返回指针的值:) 和 (const char s[]) s 是常数你将如何改变它!!!!!! 删除常量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T00:46:26.453

这里有两个问题。编译器抱怨是因为`s[0]`is a`char`和`"o"`（和其他）是指向 char 数组的指针（基本上）。要解决此问题，请替换`"o"`为`'o'`.

但是还有一个更大的问题：您只是将 s[0] 与 'o' 进行比较。测试中的其他内容都将评估为 true：

```
 if(s[0]=='o'||s[0]=='u'||s[0]=='e'||s[0]=='a'||s[0]=='i'){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T00:52:53.917

在下面，`s[0]`是一个字符 - 所以是整数的一种形式，其中`"o"`是一个字符串 - `const char *`- 所以你将一个字母“a”（或类似）与字符串“o”的地址进行比较。

```
if(s[0]=="o"||"u"||"e"||"a"||"i"){ 
```

你应该做：

```
if(s[0]=='o' ... ) 
```

然而，|| '你'并不意味着我认为你认为它意味着什么。由于没有任何字符（或代码中的字符串）为零/NULL，因此它们变为`true`，并且您的 if 语句将始终为真。

您需要有一个比较语句：

```
if(s[0] == 'o'|| s[0] == 'u' ... ) 
```

# php - CodeIgniter htaccess 和 URL 重写问题

> ID：14783666
> 
> 赞同：44
> 
> 时间：2013-02-09T00:45:08.467
> 
> 标签：php, .htaccess, codeigniter

我以前从未使用过 CodeIgniter，更不用说任何 php 框架了，我想我会尝试一下。一切都很好，除了我似乎无法从 URL 中删除 index.php 并仍然访问我的页面。

我从来没有使用过 MVC 结构，所以我边走边学，如果我做错了，请原谅我。

我试图通过简单地输入**localhost/ci/about**来访问我创建的名为“about_page.php”的视图，但目前我只能使用**localhost/ci/index.php/about来访问它**

页面的控制器是：**/application/controllers/about.php**
页面 的模型是：**/application/models/about_model.php**
页面 的视图是：**/application/views/about_page.php**

我一直在寻找解决此问题的方法，但一直找不到。这是我已经搜索过的地方：

[CodeIgniter - 删除 index.php](https://stackoverflow.com/questions/5203581/codeigniter-removing-index-php?rq=1)
[Codeigniter - 如何从 url 中删除 index.php？](https://stackoverflow.com/questions/11947234/codeigniter-how-to-remove-the-index-php-from-url)
[http://www.farinspace.com/codeigniter-htaccess-file/](http://www.farinspace.com/codeigniter-htaccess-file/)

CodeIgniter 在“应用程序”文件夹中带有一个 .htaccess 文件，其中仅包含`Allow Deny From All`. 所以我在根目录中创建了一个新的 .htaccess 文件，`http://localhost/ci/.htaccess`并将这段代码添加到其中：

```
RewriteEngine On
RewriteBase /ci
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

当 .htaccess 文件位于根目录中时，我收到 500 内部服务器错误。当我将完全相同的文件复制到应用程序文件夹中时，500 错误消失了，但我仍然无法使用**localhost/ci/about访问 about 页面**

我已经更改`$config['index_page'] = 'index.php';`为`$config['index_page'] = '';`并且我尝试更改`$config['uri_protocol'] = 'AUTO';`为`$config['uri_protocol'] = 'REQUEST_URI';`但我仍然收到内部服务器错误。

我进入了 httpd.conf 文件并取消了 mod_rewrite.so 模块的注释，所以我知道 mod_rewrite 处于活动状态。

有谁知道为什么这不起作用或我如何才能完成这项工作？我知道 StackOverflow 上有很多关于这个主题的问题，但我找不到能回答我问题的问题。

我这样做对吗？我是否应该能够通过访问**localhost/ci/about**来访问 about 页面，还是必须在“application”目录中创建一个“about”目录？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-02-11T07:12:41.503

删除 有 3 个步骤`index.php`。

1.  `application/config.php`在文件中进行以下更改

    ```
    $config['base_url'] = 'http://'.$_SERVER['SERVER_NAME'].'/Your Ci folder_name';
    $config['index_page'] = '';
    $config['uri_protocol'] = 'AUTO'; 
    ```

2.  `.htaccess`使用以下代码在根目录中创建文件

    ```
    RewriteEngine on
    RewriteCond $1 !^(index\.php|resources|robots\.txt)
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
    ```

3.  启用重写引擎（如果尚未启用）

    **一世。**首先，使用以下命令启动它：

    ```
    a2enmod rewrite 
    ```

    **ii.** 编辑文件`/etc/apache2/sites-enabled/000-default`

    全部更改`AllowOverride None`为`AllowOverride All`.

    注意：在最新版本中，您需要更改`/etc/apache2/apache2.conf`文件

    **iii.** 使用以下命令重新启动服务器：

    ```
    sudo /etc/init.d/apache2 restart 
    ```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-09T01:39:21.207

你`.htaccess`的有点不对劲。看看我的：

```
 RewriteEngine On
 RewriteBase /codeigniter  

  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond $1 !^(index\.php|images|robots\.txt|css|docs|js|system)
  RewriteRule ^(.*)$ /codeigniter/index.php?/$1 [L] 
```

注意两个地方的“codeigniter”。

之后，在您的配置中：

```
base_url = "http://localhost/codeigniter"
index = "" 
```

在适当的地方将 codeigniter 更改为“ci”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-18T06:13:12.693

```
<IfModule mod_rewrite.c>
   RewriteEngine On
   RewriteBase /dmizone_bkp
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteCond %{REQUEST_FILENAME} !-d
   RewriteCond $1 !^(index\.php|images|robots\.txt|css|docs|js|system)
   RewriteRule ^(.*)$ /dmizone_bkp/index.php?/$1 [L]
</IfModule> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-26T08:12:35.733

这对我有用

将您的**.htaccess**文件移动到根文件夹（在我的情况下位于应用程序文件夹之前）

```
RewriteEngine on
RewriteBase /yourProjectFolder
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php/$0 [PT,L] 
```

我的 config.php 看起来像这样（application/config/ **config.php**）

```
$config['base_url'] = "";
$config['index_page'] = "index.php";
$config['uri_protocol'] = "AUTO"; 
```

让我知道它是否也适合你们！干杯！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-09T02:49:32.910

我正在使用这样的东西 - [codeigniter-htaccess-file](http://www.farinspace.com/codeigniter-htaccess-file/)，这是一篇很好的文章。

*   将 .htaccess 文件留在 CI 根目录中
*   确保 mod_rewrite 开启
*   检查拼写错误（即控制器文件/类名）
*   在 /application/config/config.php 中设置`$config['index_page'] = "";`
*   在 /application/config/routes.php 中设置**您的**默认控制器`$route['default_controller']="home";`

如果您正在运行 CI (2.1.3) 的全新安装，那么实际上并没有太多可能出错的地方。

*   2个配置文件
*   控制器
*   .htaccess
*   mod_rewrite

读

*   [代码点火器 .htaccess](https://stackoverflow.com/a/12856804/380211)
*   [重定向索引-php-in-codeigniter](https://stackoverflow.com/questions/2861650/redirect-index-php-in-codeigniter)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-29T04:42:12.427

对于那些使用 wamp 服务器的用户，请按照@Raul Chipad 解决方案的前两个步骤进行操作：

3.  单击 wamp 图标（通常为绿色），转到“Apache”>“Apache 模块”>“rewrite_module”。应该勾选“rewrite_module”！然后就是要走的路！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-16T08:34:13.540

如果不工作

```
$config['uri_protocol'] = 'AUTO'; 
```

将其更改为

```
$config['uri_protocol'] = 'PATH_INFO'; 
```

如果不起作用，请将其更改为

```
$config['uri_protocol'] = 'QUERY_STRING'; 
```

如果使用这个

```
$config['uri_protocol'] = 'ORIG_PATH_INFO'; 
```

重定向或标头位置到不在 htaccess 中的 url 将不起作用，您必须在 htaccess 中添加 url 才能工作

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-20T22:10:45.370

我在 Linux Ubuntu 14 上遇到了类似的问题。

在浏览器中不断出现 403 错误消息并在此处阅读所有答案后，我无法弄清楚出了什么问题。

然后我找到了 apache 的错误日志，最后得到了一个有点意外但完全合乎逻辑的提示。

codeIgniter 主文件夹对文件夹没有 X 权限，从而使 Web 服务器无法读取其他所有内容。

chmod ugo+x yourCodeIgniterFolder

修复了第一个问题。杀死 403 错误。

但后来我开始收到错误 500。

罪魁祸首是 .htaccess 中的错误设置行

然后我开始收到php错误。

罪魁祸首与应用程序和系统文件夹中的内部文件夹的“其他”权限的主文件夹没有 X 标志相同。

我对这个问题的两分钱：阅读 Apache Error.log。

但是，也要注意安全问题。CodeIgniter 建议将应用程序和系统文件夹移出 web 空间，因此如果这些文件夹保留在 web 空间中，则应非常小心地更改权限。

这里值得一提的另一件事是，我已将下载的 CodeIgniter 存档直接解压缩到网络空间。文件夹权限可能是直接从存档中创建的。鉴于它们是安全的，但 CodeIgniter 手册[https://codeigniter.com/user_guide/installation/index.html](https://codeigniter.com/user_guide/installation/index.html)中没有提到文件夹访问问题（在类似 unix 的系统上） ，也许应该在其中提到如何放松的指南CodeIgniter 工作的安全性，同时保持生产系统的安全性（如前所述，手册中已经存在一些安全提示）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-07T14:28:31.700

只需将其添加到 .htaccess 文件中：

```
DirectoryIndex index.php
RewriteEngine on
RewriteCond $1 !^(index\.php|images|css|js|robots\.txt|favicon\.ico)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ ./index.php?/$1 [L,QSA] 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-15T16:22:07.470

默认情况下，以下内容位于`application`文件夹中，按照建议将其移动到根目录中。

`leave the .htaccess file in CI root dir`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-11-05T04:46:50.753

打开***application/config/config.php***文件并进行下面给出的更改，

1.  `$config['base_url']`通过替换, 的值来设置您的基本网址`$config['base_url'] = 'http://localhost/YOUR_PROJECT_DIR_NAME';`

2.  使`$config['index_page']`配置为空`$config['index_page'] = '';`

在项目根文件夹中 创建新的***.htaccess文件并使用给定的设置，*** `RewriteEngine on RewriteCond $1 !^(index\.php|resources|assets|images|js|css|uploads|favicon.png|favicon.ico|robots\.txt) RewriteCond %{REQUEST_FILENAME} !-f RewriteCond %{REQUEST_FILENAME} !-d RewriteRule ^(.*)$ index.php/$1 [L,QSA]`

重启服务器，打开项目，一切顺利。

# c# - Skybound GeckoFX 设置主机字段

> ID：14783667
> 
> 赞同：1
> 
> 时间：2013-02-09T00:45:27.387
> 
> 标签：c#, http, geckofx

为了调试，我需要操作 GeckoFX Webbrowser 控件的 HTTP-Request 中的主机字段。有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:08:19.557

好，我知道了。您必须设置一个额外的标头，然后主机标头将被替换。例子：

```
geckoWebBrowser1.Navigate(urlTB.Text, Skybound.Gecko.GeckoLoadFlags.None, 
                          referrerTB.Text, null, string.Format("Host: {0}\r\n",
                          hostTB.Text)); 
```

# c - C编程初学者的家庭作业帮助

> ID：14783676
> 
> 赞同：0
> 
> 时间：2013-02-09T00:46:32.343
> 
> 标签：c, function, user-defined-functions

我必须将我创建的程序分成 1 个主函数和 3 个用户定义函数。我的工作说明如下：

> // 从用户那里获取一个整数并返回 // 对该函数进行 3 次调用： // 从用户那里获取矩形的长度并将其返回给 main // 从用户那里获取矩形的宽度并返回它to main // 从用户处获取圆的半径并返回给 main int GetNum(void);
> 
> // 接受两个参数，矩形的长度和宽度，并返回区域 int CalculateAreaR(int length, int width);
> 
> // 接受一个参数，圆的半径并返回面积 double CalculateAreaC(int radius);

不过，我很困惑。我已经编写了函数，但无法正确地将它们调用到主函数。我知道这可能很简单，但是我看不到正确的东西。我写的代码如下：

```
#include <stdio.h>
#include <math.h>
#define PI 3.14

int GetNum(void)
{
    int length;
    int width;
    int radius;

    printf( " Please enter the length of a rectangle  \n");
    scanf(" %d", &length);
    printf(" Please enter the width of a rectangle \n");
    scanf(" %d", &width);
    printf(" Please enter the radius of a circle \n");
    scanf(" %d", &radius);

    return length, width, radius;
}

int CalculateAreaR(int length, int width)
{   
    return length*width;
}

double CalculateAreaC(int radius)
{
    return PI*radius*radius;
}

int main(void)
{   
    int length;
    int width;
    int radius;
    int areaR;
    double areaC;

    GetNum();

    printf("\nThe area of the rectangle is %d\n", CalculateAreaR);

    printf("\nThe length is %d, the width is, %d and thus the area of the rectangle is %d\n\n", length, width, areaR);

    areaC = CalculateAreaC();

    printf("\nThe area of the circle is %.3f\n", CalculateAreaC);

    printf("\n\n The radius of the circle is %d and the area of the circle is %.3f\n\n", radius, areaC);

    return 0;
} 
```

谁能帮帮我吗？我会非常感谢。我正在努力学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:53:30.787

在 C 中，函数只能通过`return`语句返回单个值。

对于一个简单的程序，您可以让您的`GetNum()`函数修改全局变量。

```
// variables placed outside any function have global scope
int length;
int width;
int radius;

int GetNum(void)
{

    printf( " Please enter the length of a rectangle  \n");
    scanf(" %d", &length);
    printf(" Please enter the width of a rectangle \n");
    scanf(" %d", &width);
    printf(" Please enter the radius of a circle \n");
    scanf(" %d", &radius);

    return 0;
} 
```

这显示了在全局范围内声明变量，然后在函数中使用它们。

一种更高级但通常更好的返回多个值的方法是调用者传递一个指向变量的指针，以及使用该指针设置变量的函数。@bash0r 在他/她的回答中展示了这种技术。

现在，要调用函数，您必须始终在函数名后面加上括号。永远永远永远。如果你把名字不带括号，你不是在调用函数；您只是在引用函数（您正在引用函数的地址）。您有几个地方想调用函数，但没有放括号。

一些函数接受参数。当你调用一个带参数的函数时，你需要传入参数。下面是一个函数的例子，它把一个数字乘以一个因子，然后加上一个项。

```
float adjust_num(float x, float factor, float term)
{
    return x * factor + term;
}

// example of calling the above:

float adjusted;

adjusted = adjust_num(input_value, scale_factor, 0.0f); 
```

在示例中，我们传入`input_value`and `scale_factor`。我们没有要添加术语的常量或变量，所以我们只传入一个文字`0.0`值。所以对于这个例子，我们传递了所有必需的参数。然后函数返回一个值，我们在变量中收集该输出值`adjusted`。

如果您确实按照我的建议尝试了全局变量，则需要删除在`main()`函数内声明变量的行。否则，您将声明两组变量，一组是内部的私有变量，`main()`另一组是全局变量。里面的那些`main()`会隐藏全局的；我们称之为“遮蔽”，就像“内部的局部变量`main()`遮蔽了全局变量”一样。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:01:10.803

```
int GetNum(void)
{
    ...
    return length, width, radius;
} 
```

你不能那样做，C 函数只能返回 1 个返回值。你基本上可以按照三种方法来解决这个问题：

1.  将长度、宽度、半径存储在函数外部（即全局）的变量中
2.  将要返回的元素打包在`struct`ure中
3.  将指向包含长度、宽度、半径的变量的指针传递给该函数

使用全局变量是这三个中最简单的，在这种情况下可能就足够了，但在实际程序中，我们倾向于避免使用全局变量。

```
printf("\nThe area of the rectangle is %d\n", CalculateAreaR); 
```

您可以在调用另一个函数（在本例中为 printf）中调用一个函数，您必须*调用*该函数，您在这里所做的是将指向该函数的指针指向 printf。此外，如果您将函数声明为带参数，则必须将这些参数提供给函数，如下所示：

```
printf("\nThe area of the rectangle is %d\n", CalculateAreaR(length,width)); 
```

可以在这里找到一个类似的问题：

```
areaC = CalculateAreaC();
printf("\nThe area of the circle is %.3f\n", CalculateAreaC); 
```

与上面相同的注释（应该给出参数），但是在这里你已经将结果存储在 areaC 所以你可以说

```
printf("\nThe area of the circle is %.3f\n", areaC); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T00:53:39.120

您不能同时返回 3 个值。如果您需要超过 1 个返回值，则必须这样做：

```
int x = 0, y = 0, z = 0;
myFunction( &x, &y, &z ); 
```

where`myFunction`必须这样声明：

```
void myFunction( int *x, int *y, int *z ) { } 
```

您可以读取/写入`x`，`y`并`y`通过 * 运算符。你可以像这样使用它：

```
*x = 10; // write 10 to the variable behind x.
*y = *x; // write to variable behind y and read from variable behind x. 
```

`int *x`称为指针变量/参数。它存储一个地址而不是一个值。使用指针，您可以“指向”另一个变量并从其他地方修改它的值（例如在您调用的函数中）。指针的大小取决于操作系统（32 位系统有 4 字节地址，64 位系统有 8 字节地址）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-08T23:29:56.973

在主函数内部，您应该从输入函数接收输入：getNum(); 我通常喜欢将输入数据封装到单独的函数中，所以我特别知道这个函数只做一件事。在 main 中声明长度、宽度和半径的重点是在我需要时能够实际使用这些值。最简单的方法可以这样做：

**功能：**

```
int get_length() 
{
    int length = 0;

    printf("Enter length of rectangle: ");
    scanf("%d", &length);

    return length; 
} 
```

**主功能：**

```
int main()
{
    int length = 0;

    length = get_length(); 

    // collect additional input...

    return 0;
} 
```

# ruby - 用 rubmine 调试一个 sinatra 应用程序

> ID：14783678
> 
> 赞同：1
> 
> 时间：2013-02-09T00:46:39.103
> 
> 标签：ruby, debugging, rubymine

我正在尝试使用 RubyMine 调试 sinatra 应用程序。我正在使用`rackup`在本地主机上运行应用程序并`unicorn`在远程主机上运行它。我的红宝石版本是 1.9.3。

我还应该注意，“运行调试模式图标”是灰色的。我不知道配置中缺少什么。

我需要什么宝石？我还需要做什么？

**更新：** 我已经使用`rackup -p 9000`. 为了开始调试 -run `rdebug-ide --port 1234 -- rackup`并收到此消息：

```
Fast Debugger (ruby-debug-ide 0.4.17.beta16, ruby-debug-base 0.10.5.rc1) listens on 127.0.0.1:1234 
```

我仍然不明白如何使用 Rubymine 进行调试。我打开了浏览器，`http://0.0.0.0:1234`但没有得到任何响应（它一直在加载）

我像这样使用独角兽运行远程主机：

```
unicorn -c etc/fin_srv_unicorn.conf -E staging 
```

如何设置远程调试？我也试过`rack`和`ruby remote`。尝试连接到远程主机并运行服务（使用上面列出的命令），然后像这样运行 rdebug：

```
rdebug-ide --port 1911 -- $SCRIPT$ 
```

对于 $SCRIPT$，我在哪里尝试过`app/main.rb staging`, `unicorn -E staging`,`unicorn -c etc/fin_srv_unicorn.conf -E staging`

# sql - System.Security.HostProtectionException 使用函数调用 web 服务时

> ID：14783679
> 
> 赞同：0
> 
> 时间：2013-02-09T00:46:39.760
> 
> 标签：sql, sql-server, wcf, web-services, clr

从函数调用 Web 服务时出现以下错误。

我已经使用“不安全”权限集引用了 sql server 中所有必需的程序集，并已将项目程序集注册为“外部访问”，并将序列化程序程序集注册为“安全”权限集。我也查看了代码，我没有看到像消息弹出等这样的东西......这在 sql server 的上下文中是无关紧要的。我创建了另一个使用相同服务的控制台应用程序，它可以从同一台服务器正常访问该服务。还有什么可能导致这个问题？任何帮助表示赞赏。

错误：System.Security.HostProtectionException：尝试执行 CLR 主机禁止的操作。在 System.ServiceModel.Description.TypeLoader.LoadContractDescriptionHelper（类型 contractType，类型 serviceType，对象 serviceImplementation） 在 System.ServiceModel.ChannelFactory`1.CreateDescription() at System.ServiceModel.ChannelFactory.InitializeEndpoint(Binding binding, EndpointAddress address) at System.ServiceModel.ChannelFactory`1..ctor(Binding binding, EndpointAddress remoteAddress) at System.ServiceModel.ClientBase`1..ctor(Binding binding, EndpointAddress remoteAddress) at MWMInterfaceBeanServiceClient.MWMInterfaceBeanServiceClient..ctor(Binding binding, EndpointAddress remoteAddress) at MWMInterfaceBeanServiceClient.MWMServiceClient.GetClient( ）在 MWMInterfaceBeanServiceClient.MWMServiceClient.UpdateMobileCrew（布尔值活动，布尔值可用，布尔值availForOp，字符串合同，字符串代码，字符串名称，Int32 编号，字符串船员中心，字符串船员组，字符串船员 ID，Int32 船员大小，字符串船员监督员，字符串船员类型，布尔 mdtCrew， SqlXml 成员、String 区、String 划分、String serviceArea、String mobileNum、String pagerNum、Boolean tempFlag、SqlXml 车辆）受保护的资源（仅在完全信任的情况下可用）为：所有需要的资源是：同步、外部线程

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:23:49.783

所以，我将程序集标记为不安全，这使这个错误消失了，但给了我另一个错误，说它无法序列化 svcutil 生成的代理之一来发出请求。我已经在构建后任务中使用 sgen 生成了序列化程序程序集，并注册为 UNSAFE，这似乎不起作用。也许这仅适用于具有本机类型的简单方法？因此，我采用了以下链接中提到的不同方法。

[http://www.vishalseth.com/post/2009/12/22/Call-a-webservice-from-TSQL-(Stored-Procedure)-using-MSXML.aspx](http://www.vishalseth.com/post/2009/12/22/Call-a-webservice-from-TSQL-(Stored-Procedure)-using-MSXML.aspx)

# sql - Sql PIVOT 和字符串连接聚合

> ID：14783680
> 
> 赞同：25
> 
> 时间：2013-02-09T00:47:18.277
> 
> 标签：sql, tsql, pivot, reporting-services, reportbuilder3.0

我想使用数据透视 SQL 查询来构造一个结果表，其中连接文本作为数据透视表的 DATA 部分中的结果。

即我使用简单的选择得到以下结果：

```
+------------+-----------------+----------------+
| 活动名称 | 资源类型 | 资源名称 |
+------------+-----------------+----------------+
| 活动 1 | 资源类型 1 | 资源 1 |
| 活动 1 | 资源类型 1 | 资源 2 |
| 活动 1 | 资源类型 2 | 资源 3 |
| 活动 1 | 资源类型 2 | 资源 4 |
| 活动 1 | 资源类型 3 | 资源 5 |
| 活动 1 | 资源类型 3 | 资源 6 |
| 活动 1 | 资源类型 3 | 资源 7 |
| 活动 1 | 资源类型 4 | 资源 8 |
| 活动二 | 资源类型 5 | 资源 1 |
| 活动二 | 资源类型 2 | 资源 3 |
| 活动二 | 资源类型 3 | 资源 11 |
| 活动二 | 资源类型 3 | 资源 12 |
| 活动二 | 资源类型 3 | 资源 13 |
| 活动二 | 资源类型 4 | 资源 14 |
| 活动二 | 资源类型 5 | 资源 9 |
| 活动二 | 资源类型 5 | 资源 16 |
+------------+-----------------+----------------+

```

我想构建一个如下所示的结果查询：

```
+---------------------+-------------+-- ----------------------+---------------------------- ------------+------------------+-------- ------------------+
| 事件/资源类型 | 资源类型 1 | 资源类型 2 | 资源类型 3 | 资源类型 4 | 资源类型 5 |
+---------------------+-------------+-- ----------------------+---------------------------- ------------+------------------+-------- ------------------+
| 活动 1 | 资源 1、资源 2 | 资源 3，资源 4 | 资源 5、资源 6、资源 7 | 资源 8 | *空*                                |
| 活动二 | *空*                   | 资源 3 | 资源 11、资源 12、资源 13 | 资源 14 | 资源 1、资源 9、资源 16 |
+---------------------+-------------+-- ----------------------+---------------------------- ------------+------------------+-------- ------------------+

```

我知道如何在 ms-sql 中使用 PIVOT 语句，但我不知道如何将资源名称聚合为每种资源类型的逗号分隔项的串联。

PS 我还可以使用 SSRS 2008-R2 提供的 Martix 解决方案，使用 Report Builde 3 将第一个表作为我的数据集，并创建一个矩阵，将资源名称聚合为逗号分隔的字符串。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-09T16:01:23.600

为了得到结果，首先你应该将值连接到逗号分隔的列表中。

我会使用`CROSS APPLY`和`FOR XML PATH`：

```
SELECT distinct e.[Event Name],
  e.[Resource Type],
  LEFT(r.ResourceName , LEN(r.ResourceName)-1) ResourceName
FROM yourtable e
CROSS APPLY
(
    SELECT r.[Resource Name] + ', '
    FROM yourtable r
    where e.[Event Name] = r.[Event Name]
      and e.[Resource Type] = r.[Resource Type]
    FOR XML PATH('')
) r (ResourceName) 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/25d6d/27)。给你结果：

```
| EVENT NAME |   RESOURCE TYPE |                          RESOURCENAME |
------------------------------------------------------------------------
|    Event 1 | Resource Type 1 |                Resource 1, Resource 2 |
|    Event 1 | Resource Type 2 |                Resource 3, Resource 4 |
|    Event 1 | Resource Type 3 |    Resource 5, Resource 6, Resource 7 |
|    Event 1 | Resource Type 4 |                            Resource 8 |
|    Event 2 | Resource Type 2 |                            Resource 3 |
|    Event 2 | Resource Type 3 | Resource 11, Resource 12, Resource 13 |
|    Event 2 | Resource Type 4 |                           Resource 14 |
|    Event 2 | Resource Type 5 |   Resource 1, Resource 9, Resource 16 | 
```

然后你将应用你`PIVOT`的这个结果：

```
SELECT [Event Name],
  [Resource Type 1], [Resource Type 2],
  [Resource Type 3], [Resource Type 4],
  [Resource Type 5]
FROM
(
  SELECT distinct e.[Event Name],
    e.[Resource Type],
    LEFT(r.ResourceName , LEN(r.ResourceName)-1) ResourceName
  FROM yourtable e
  CROSS APPLY
  (
      SELECT r.[Resource Name] + ', '
      FROM yourtable r
      where e.[Event Name] = r.[Event Name]
        and e.[Resource Type] = r.[Resource Type]
      FOR XML PATH('')
  ) r (ResourceName)
) src
pivot
(
  max(ResourceName)
  for [Resource Type] in ([Resource Type 1], [Resource Type 2],
                          [Resource Type 3], [Resource Type 4],
                          [Resource Type 5])
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/25d6d/29)。您的最终结果将是：

```
| EVENT NAME |        RESOURCE TYPE 1 |        RESOURCE TYPE 2 |                       RESOURCE TYPE 3 | RESOURCE TYPE 4 |                     RESOURCE TYPE 5 |
----------------------------------------------------------------------------------------------------------------------------------------------------------------
|    Event 1 | Resource 1, Resource 2 | Resource 3, Resource 4 |    Resource 5, Resource 6, Resource 7 |      Resource 8 |                              (null) |
|    Event 2 |                 (null) |             Resource 3 | Resource 11, Resource 12, Resource 13 |     Resource 14 | Resource 1, Resource 9, Resource 16 | 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T16:37:20.190

这在 SQL 2008 中对我有用，而且它是动态的 - 将处理额外的`Resource Type`

[工作 SQLFiddle](http://sqlfiddle.com/#!3/cb3d9/2)

```
IF OBJECT_ID('tempdb..#test') IS NOT NULL
  DROP TABLE #test

GO

CREATE TABLE #test
  (
     eventName    VARCHAR(30),
     resourceType VARCHAR(30),
     resourceName VARCHAR(30)
  );

INSERT INTO #test
VALUES      ('Event 1','Resource Type 1','Resource 1'),
            ('Event 1','Resource Type 1','Resource 2'),
            ('Event 1','Resource Type 2','Resource 3'),
            ('Event 1','Resource Type 2','Resource 4'),
            ('Event 1','Resource Type 3','Resource 5'),
            ('Event 1','Resource Type 3','Resource 6'),
            ('Event 1','Resource Type 3','Resource 7'),
            ('Event 1','Resource Type 4','Resource 8'),
            ('Event 2','Resource Type 5','Resource 1'),
            ('Event 2','Resource Type 2','Resource 3'),
            ('Event 2','Resource Type 3','Resource 11'),
            ('Event 2','Resource Type 3','Resource 12'),
            ('Event 2','Resource Type 3','Resource 13'),
            ('Event 2','Resource Type 4','Resource 14'),
            ('Event 2','Resource Type 5','Resource 9'),
            ('Event 2','Resource Type 5','Resource 16');

DECLARE @resourceTypes VARCHAR(max);

SELECT @resourceTypes = stuff((SELECT DISTINCT ',[' + resourceType + ']'
                               FROM   #test
                               FOR xml path('')), 1, 1, '');
DECLARE @query NVARCHAR(max);

SET @query = 'SELECT *
FROM   (SELECT eventName,
               resourceType,
               stuff((SELECT '','' + resourceName + ''''
                      FROM   #test b
                      WHERE  a.eventName = b.eventName
                             AND a.resourceType = b.resourceType
                      FOR xml path('''')), 1, 1, '''') resourceName
        FROM   #test a
        GROUP  BY eventName,
                  resourceType) AS data PIVOT (max(resourceName) FOR resourceType IN (' + @resourceTypes + ')) AS pvt';

EXEC(@query);

DROP TABLE #test; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T07:53:03.930

在报表生成器中，您应该使用**表格**或**矩阵**向导并执行以下操作：

*   `Resource Type`字段作为列组。
*   `Event Name`字段作为行组。
*   和`Resource Name`字段作为详细信息，您**将**不得不使用聚合函数，例如`Count`.

在此阶段完成向导，然后完成将`Resource Name`单元格编辑为表达式。将表达式替换为：

```
=Join( LookupSet( Fields!EVENT_NAME.Value + Fields!RESOURCE_TYPE.Value,
                  Fields!EVENT_NAME.Value + Fields!RESOURCE_TYPE.Value,
                  Fields!RESOURCE_NAME.Value, "DataSet1"), ", ") 
```

**现在尝试和测试：**

![在此处输入图像描述](../Images/3c4e69303f42092e004e532c80cb6f19.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-09T16:15:31.950

完整的工作示例：

```
SET NOCOUNT ON
GO

    DECLARE @SourceTable TABLE
    (
         EventName NVARCHAR(10)
        ,ResourceType NVARCHAR(20)
        ,ResourceName NVARCHAR(20)
    )

    INSERT INTO @SourceTable(EventName,ResourceType,ResourceName)
    VALUES   ('Event 1','Resource Type 1','Resource 1')
            ,('Event 1','Resource Type 1','Resource 2') 
            ,('Event 1','Resource Type 2','Resource 3') 
            ,('Event 1','Resource Type 2','Resource 4')
            ,('Event 1','Resource Type 3','Resource 5') 
            ,('Event 1','Resource Type 3','Resource 6') 
            ,('Event 1','Resource Type 3','Resource 7') 
            ,('Event 1','Resource Type 4','Resource 8') 
            ,('Event 2','Resource Type 5','Resource 1') 
            ,('Event 2','Resource Type 2','Resource 3') 
            ,('Event 2','Resource Type 3','Resource 11')
            ,('Event 2','Resource Type 3','Resource 12')
            ,('Event 2','Resource Type 3','Resource 13')
            ,('Event 2','Resource Type 4','Resource 14')
            ,('Event 2','Resource Type 5','Resource 9') 
            ,('Event 2','Resource Type 5','Resource 16') 

    ;WITH SourceTable AS
    (
        SELECT DISTINCT ST1.EventName
                       ,ST1.ResourceType
                       ,(SELECT SUBSTRING((SELECT ',' +ResourceName 
                                           FROM @SourceTable AS ST2
                                           WHERE ST1.EventName=ST2.EventName AND ST1.ResourceType=ST2.ResourceType 
                                           FOR XML PATH('')),2,200) AS CSV) AS ResourceName
        FROM @SourceTable AS ST1
    )
    SELECT    EventName
            ,[Resource Type 1]
            ,[Resource Type 2]
            ,[Resource Type 3]
            ,[Resource Type 4]
            ,[Resource Type 5]
    FROM 
    (
        SELECT EventName
              ,ResourceType
              ,ResourceName
        FROM SourceTable
    ) PivotSource
    PIVOT
    (
        MAX(ResourceName) FOR ResourceType  IN ([Resource Type 1],[Resource Type 2],[Resource Type 3],[Resource Type 4],[Resource Type 5])
    ) PivotTable

SET NOCOUNT OFF
GO 
```

# java - 名为 Spring @Service 中的匿名 bean

> ID：14783681
> 
> 赞同：0
> 
> 时间：2013-02-09T00:47:22.693
> 
> 标签：java, spring, spring-mvc, dependency-injection

如何在命名的 Spring Service 中指定匿名内部 bean？

```
@Service("myNamedService")
public class myNamedServiceClass  {

    private InnerBeanType innerBean;

    @Autowired
    public void setInnerBean(InnerBeanType innerBean) {
        this.innerBean = innerBean;
    }

} 
```

我基本上是在尝试实现以下 Spring XML 接线的等效项：

```
<bean name="myNamedService" class="somePackage.myNamedServiceClass">
    <property name="innerBean">
        <bean class="somePackage.InnerBeanType"/>
    </property>
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:14:24.937

我认为使用纯注释等效是不可能的。`@Configuration`如果目的是不以这种方式公开`innerBean`为可见 bean，则可以使用：

```
@Bean
public MyNamedServiceBean myNamedServiceBean(){
  MyNamedServiceClass myNamedServiceBean = new MyNamedServiceClass();
  myNamedServiceBean.setInnerBean(new InnerBeanType());
  return myNamedServiceBean;
} 
```

# ajax - ajax 请求的 401（未经授权）错误（需要用户名和密码）

> ID：14783684
> 
> 赞同：1
> 
> 时间：2013-02-09T00:47:35.360
> 
> 标签：ajax, jsonp, http-status-code-401

我正在发出 ajax 请求以从 webtrends 检索 json 数据 - 一项需要登录的服务。我在我的 ajax 请求中传递了用户名和密码，但仍然给我一个 401 未经授权的错误。我尝试了 3 种不同的方法 - 但没有运气。有人可以帮我找到解决方案吗？

```
1\.   $.getJSON('https://ws.webtrends.com/..?jsoncallback=?', { format: 'jsonp', suppress_error_codes: 'true', username: 'xxx', password: 'xxx', cache: 'false' }, function(json) {
         console.log(json);        
       alert(json);
  });

2\.  $.ajax({
    url: "https://ws.webtrends.com/../?callback=?",
    type: 'GET',
    cache: false,
    dataType: 'jsonp',
    processData: false,
    data: 'get=login',
            username: "xxx",
            password: "xxx",
    beforeSend: function (req) {
        req.setRequestHeader('Authorization', "xxx:xxx");
    },
    success: function (response) {
        alert("success");
    },
    error: function(error) {
      alert("error");
    }
});

3\. window.onload=function() {
var url = "https://ws.webtrends.com/...?username=xxx&password=xxx&callback=?";
var script = document.createElement('script');
script.setAttribute('src', url);
document.getElementsByTagName('head')[0].appendChild(script);
}

function parseRequest(response) {
                try  {
alert(response);
}
catch(an_exception)  {
                    alert('error');
                }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T14:17:53.067

**当您使用命名回调函数并在 url 中使用基本身份验证时，***方法 3可能会起作用。***请注意，尽管许多浏览器不接受 url-authentication（或任何名称）。如果你想试试，你可以这样重写：**

 **```
window.onload = function() {
 var url = "https://xxx:xxx@ws.webtrends.com/...?callback=parseRequest";
 var script = document.createElement('script');
 script.setAttribute('src', url);
 document.getElementsByTagName('head')[0].appendChild(script);
}

function parseRequest(response) {
  try  {
     alert(response);
  }
  catch(an_exception)  {
     alert('error');
  }
} 
```**

# backbone.js - 422 错误，设计/主干

> ID：14783692
> 
> 赞同：0
> 
> 时间：2013-02-09T00:48:34.563
> 
> 标签：backbone.js, devise

我正在尝试设置一个使用 Backbone 和 Devise 进行注册的 Rails 应用程序。

Chrome 控制台中的错误回调中的响应文本说

```
responseText: "{"errors":{"email":["can't be blank"],"password":["can't be blank"]}}" 
```

但是，服务器中的日志显示无法处理的实体

```
 Parameters: {"email"=>"pp@rr.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]", "registration"=>{"email"=>"pp@rr.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}
   (0.1ms)  begin transaction
   (0.1ms)  rollback transaction
Completed 422 Unprocessable Entity in 4ms (Views: 0.3ms | ActiveRecord: 0.1ms) 
```

我有一个 Backbone 用户模型，可以设置保存的 url

```
UserRegistration = Backbone.Model.extend({
          url: '/users.json',
          paramRoot: 'user',

          defaults: {
            "email": "",
            "password": "",
            "password_confirmation": ""
          }
    }); 
```

在关联视图中，我从注册表单中获取属性，在模型中设置它们，然后保存模型

```
 var email = $('#email').val();
    var password_confirmation = $('#password_confirmation').val();
    var password = $('#password').val();

    this.model.set({email : email, password_confirmation: password_confirmation, password: password})

    this.model.save(this.model.attributes, {
      success: function(userSession, response) {
        console.log("success");
        console.log(userSession);
        console.log(response);
        console.log(this.model.url);

      },
      error: function(userSession, response) {
        console.log("error");
        console.log(userSession);
        console.log(response);

      }
    });
  } 
```

设置模型属性后（保存前）我做了一个console.log（this.model.attributes），它们被设置了

```
Object {email: "oo@gmail.com", password: "snowy", password_confirmation: "snowy"} 
```

我的用户模型看起来像这样

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me

end 
```

任何人都可以提出任何建议吗？

最近的 Devise 版本仅响应 html 存在一些问题，因此我安装了 Devise 2.1.2 以使其响应 json 以使其与 Backbone 兼容。这不是这里的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:13:03.923

paramRoot 不是 Backbone 核心的一部分。为了解决这个问题，我必须包含来自 Backbone-Rails gem 的同步库[https://raw.github.com/codebrew/backbone-rails/master/vendor/assets/javascripts/backbone_rails_sync.js](https://raw.github.com/codebrew/backbone-rails/master/vendor/assets/javascripts/backbone_rails_sync.js)以使用户参数根的一部分

```
 url: '/users.json',
  paramRoot: 'user', 
```

# git - 如何将我的项目移动到 github

> ID：14783695
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:49:35.000
> 
> 标签：git, github

我有一个新的 spring maven 项目，我想上传到 github，以便其他人可以分享和更新它。

我在 github 上做了一个 repo，我的项目都被编码了。但我不知道我必须在我的 mac 上运行的命令才能将我的代码放入 github 上的 repo

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T00:55:09.057

下载源树。是炸弹。

只需`git clone YourRepoName`在命令行上执行。

（或者如果你有一个特定的分支`git clone YourRepoName -b YourBranchName`）

然后只需将克隆的目录文件从查找器窗口拖到 sourceTree 中。它会识别出这是一个 git repo。然后只需将当前项目放入目录并提交即可。然后确保你做了一个推动和你的好去。

如果你有麻烦，请告诉我。

# python - 如何（或为什么不）从子类调用 unicode.__init__

> ID：14783698
> 
> 赞同：2
> 
> 时间：2013-02-09T00:49:53.263
> 
> 标签：python, constructor, subclass

我遇到了这样一种情况，即子类化 unicode 会导致 Python 3.3 之前的弃用警告和 Python 3.3 上的错误：

```
# prove that unicode.__init__ accepts parameters
s = unicode('foo')
s.__init__('foo')
unicode.__init__(s, 'foo')

class unicode2(unicode):
    def __init__(self, other):
        super(unicode2, self).__init__(other)

s = unicode2('foo')

class unicode3(unicode):
    def __init__(self, other):
        unicode.__init__(self, other)

s = unicode3('foo') 
```

奇怪的是，警告/错误不会出现在前三行，而是出现在第 8 行和第 14 行。这是 Python 2.7 的输出。

```
> python -Wd .\init.py
.\init.py:8: DeprecationWarning: object.__init__() takes no parameters
  super(unicode2, self).__init__(other)
.\init.py:14: DeprecationWarning: object.__init__() takes no parameters
  unicode.__init__(self, other) 
```

代码被简化以举例说明问题。在现实世界的应用程序中，我会执行的不仅仅是调用 super `__init__`。

从 unicode 类实现的前三行可以看出，`__init__`该方法至少接受一个参数。但是，如果我想从子类调用该方法，无论我是否调用，我似乎都无法这样做`super()`。

为什么可以调用`unicode.__init__`unicode 实例但不能调用 unicode 子类？如果子类化 unicode 类，作者该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T01:28:23.520

我怀疑这个问题来自`unicode`不可变的事实。

实例创建后`unicode`无法修改。因此，任何初始化逻辑都将在`__new__`方法中（被调用以创建实例），而不是`__init__`（仅在实例存在后调用）。

不可变类型的子类没有相同的严格要求，因此您可以根据需要做一些事情`unicode2.__init__`，但调用`unicode.__init__`是不必要的（而且可能不会做您认为它会做的事情）。

更好的解决方案可能是用您自己的`__new__`方法执行您的自定义逻辑：

```
class unicode2(unicode):
    def __new__(cls, value):
        # optionally do stuff to value here
        self = super(unicode2, cls).__new__(cls, value)
        # optionally do stuff to self here
        return self 
```

You can make your class immutable too, if you want, by giving it a `__setattr__` method that always raises an exception (you might also want to give the class a `__slots__` property to save memory by omitting the per-instance `__dict__`).

# javascript - 多次调用 jQuery show()

> ID：14783704
> 
> 赞同：0
> 
> 时间：2013-02-09T00:50:34.637
> 
> 标签：javascript, jquery, html

我有一个 3 * 3 的照片拼贴，如果将鼠标悬停在照片上，我希望显示照片的相应文本摘要。文本摘要包含在 id 为 summary-container 的 div 中。也就是说，之前的文本摘要将被当前文本替换为具有幻灯片动画效果的文本。下面是一段javascript代码。

```
$('#photo-collage').find('.span4').hover(function(){  
      $('#summary-container').fadeOut();
      $('#summary-container').show('slide',{direction: 'left'},1000);
      $('#summary-container').load(url,data);
},function(){}); 
```

如果我将鼠标从一张照片悬停在另一张照片上，效果会很好。但问题是，例如，如果我在穿过照片 2 和照片 3 时将鼠标从照片 1 悬停到照片 4，则 show() 函数会再调用两次。所以多了两个幻灯片动画，没必要。

我应该如何调整我的代码来解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T00:55:47.247

尝试

```
$("#summary-container").clearQueue().stop(); 
```

清除动画队列。

# php - SimpleXMLElement 并获取属性值？

> ID：14783705
> 
> 赞同：0
> 
> 时间：2013-02-09T00:50:41.803
> 
> 标签：php, xml, simplexml

我无法从我的 XML 中获取所有数据。任何人都可以阐明一下。

我的XML如下

```
<storeitems>
<PRODUCT ITEM="3002074730">
<SPECIALS_ID>14713</SPECIALS_ID>
<FULL_PRICE>27.00</FULL_PRICE>
<SPECIALS_NEW_PRODUCTS_PRICE>25.65</SPECIALS_NEW_PRODUCTS_PRICE>
</PRODUCT>
<PRODUCT ITEM="SE-0088-10-3">
<SPECIALS_ID>29555</SPECIALS_ID>
<FULL_PRICE>53.99</FULL_PRICE>
<SPECIALS_NEW_PRODUCTS_PRICE>51.29</SPECIALS_NEW_PRODUCTS_PRICE>
</PRODUCT>
<storeitems> 
```

我的代码如下

```
$xml = new SimpleXMLElement($data);

foreach($xml->PRODUCT as $post) {

    echo $post->SPECIALS_ID .'<BR>';
    echo $post->FULL_PRICE . '<BR>';
    echo $post->SPECIALS_NEW_PRODUCTS_PRICE . '<BR>';
} 
```

这符合我的期望，但请您帮助我让这部分 XML 回显

```
<PRODUCT ITEM="3002074730"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:58:15.127

```
echo $post->attributes(); 
```

将打印您的`item`（第一个）属性的值（它是一个在字符串上下文中调用它时执行此操作的对象）。

如果您添加更多属性并且想要全部获取它们，则可以迭代[`$post->attributes()`](http://www.php.net/manual/en/simplexmlelement.attributes.php)：

```
foreach($post->attributes() as $name => $value){
  ...
} 
```

# javascript - 检查 CSS 和 JS 文件文件夹的工具

> ID：14783707
> 
> 赞同：0
> 
> 时间：2013-02-09T00:51:18.303
> 
> 标签：javascript, css

是否有任何工具可以检查 JS 或 CSS 文件集并报告函数或类名冲突？我有一个大项目，有很多 JS 和 CSS 文件。到目前为止，命名约定尚未得到强制执行，我想扫描所有文件以查找文件之间的违规行为。理想情况下检测重复的 CSS 类名称以及重复的 JS 名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T02:18:30.463

[WebStorm](http://www.jetbrains.com/webstorm/)可以做到这一点，并且在查找重复的 Javascript 声明（商业、免费试用）方面特别好。（如果您下载并运行代码重复分析，只需打开 CSS 和 Javascript 的复选框）。

对于 CSS，您可以使用[mincss](http://www.peterbe.com/plog/mincss)。这也将删除 HTML 中从未引用的 CSS 类；您需要告诉它任何引用仅动态生成的元素的类。

# ajax - jQuery Mobile：从 ajax 加载页面后 javascript 中断

> ID：14783709
> 
> 赞同：0
> 
> 时间：2013-02-09T00:51:43.177
> 
> 标签：ajax, jquery-mobile, menu

所以我决定使用 jQuery Mobile 框架来构建我的新移动网站。它具有通过ajax加载任何本地href链接的功能，这很棒。但是加载的新页面不响应任何 javascript。我有一个主页和第 2 页，它们都有相同的 html 布局，其中内容有一些变化，我举个例子。

我制作了一个从左侧滑入并将主要内容推到右侧的导航菜单。当我单击页面链接时，它会通过 ajax 加载新页面，但是在新页面上，如果我单击菜单按钮，jQuery 不会选择它，因此什么也不会发生（菜单不会滑出）。

```
$(document).ready(function() {
$( ".menu-trigger" ).click(function() {
    console.log("1")
    if ($( 'nav' ).hasClass('navTransform')) {
        console.log("2")
    $( 'nav' ).removeClass('navTransform');
    $( 'article' ).removeClass('articleTransform'); 
    }
    else {
        console.log("3")
    $( 'nav' ).addClass('navTransform');
    $( 'article' ).addClass('articleTransform');
    }
});
}); 
```

此 jQuery 脚本位于单独的 .js 文件中，该文件包含在两个页面的标题中。我知道脚本正常工作，因为当我刷新页面时，菜单触发器工作。有没有已知的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:29:36.530

解决方法是使用适当的 jQM 处理程序`pageinit()`而不是 jQuery 就绪处理程序。

> **[pageinit = DOM 就绪](http://jquerymobile.com/demos/1.2.0/docs/pages/page-scripting.html)**
> 
> 人们在 jQuery 中学习的第一件事就是使用 $(document).ready() 函数在 DOM 准备好后立即执行特定于 DOM 的代码（这通常发生在 onload 事件之前很久）。 **但是，在 jQuery Mobile 站点和应用程序中，页面被请求并注入到与用户导航相同的 DOM 中，因此 DOM 就绪事件没有那么有用，因为它只针对第一页执行。**要在 jQuery Mobile 中加载和创建新页面时执行代码，您可以绑定到 pageinit 事件。

因此，您的代码可能如下所示：

```
$(document).on("pageinit", "#page1", function(){
    //Your init code for page 1 goes here  
});

$(document).on("pageinit", "#page2", function(){
    //Your init code for page 2 goes here  
}); 
```

# c# - 将未知数量的 htmlAttributes 添加到 C# MVC HtmlHelper

> ID：14783710
> 
> 赞同：0
> 
> 时间：2013-02-09T00:51:43.213
> 
> 标签：c#, asp.net-mvc-4, html-helper

免责声明：我已经做了一些研究，我能找到的最接近的现有问题是：[如何在 HtmlHelper 扩展中支持 htmlAttributes 参数？](https://stackoverflow.com/questions/9669293/how-to-support-htmlattributes-parameters-in-htmlhelper-extensions)

我正在尝试编写一个新的 DatePickerFor，它使用一组自定义 htmlAttributes 调用 TextBoxFor。这纯粹是为了节省我每次想使用 DatePicker 时都必须添加属性。

到目前为止，我有：

```
public static MvcHtmlString DatePickerFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression)
    {
        return htmlHelper.TextBoxFor(expression, new { @class = "datepicker", data_date_weekStart = 1, data_date_format = System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern.ToLower() });
    } 
```

我已经设法让它正常工作。棘手的一点是当我开始在我的 DatePickerFor 上添加额外的参数时。比如说，我想拥有以下签名：

```
 public static MvcHtmlString DatePickerFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression, DateTime earliest) 
```

此方法的行为应与上述方法几乎相同，但应为 data_startDate 添加另一个 htmlAttribute，如下所示：

```
return htmlHelper.TextBoxFor(expression, new { @class = "datepicker", data_date_weekStart = 1, data_date_format = System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.ShortDatePattern.ToLower(), data_startDate = earliest.ToShortDateString() }); 
```

如何创建一个方法签名，以及对 TextBoxFor 的伴随调用，该调用采用未知的参数组合？最初我可能希望拥有：

*   开始日期
*   结束日期
*   开始日期和结束日期
*   StartDate 和 AllowWeekendSelection
*   EndDate 和 AllowWeekendSelection
*   StartDate 和 EndDate 和 AllowWeekendSelection

等等...

我想我可以编写一个接受每个参数的方法签名，以及一个像上面那样调用 TextBoxFor 的实现，为该特定方法签名添加所有相关属性。但这闻起来很强烈，违反了 DRY 规则。

谁能提供一些见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T00:58:13.513

你不能只使用可选参数吗？[http://msdn.microsoft.com/en-us/library/dd264739.aspx](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

# cocoa - 动画自动布局更改与 NSPopover contentSize 更改同时发生

> ID：14783711
> 
> 赞同：5
> 
> 时间：2013-02-09T00:51:43.793
> 
> 标签：cocoa, animation, autolayout, nspopover

我正在尝试在弹出窗口中重现可导航视图的 iTunes 11 行为。不过，我似乎无法找到一种方法让我的动画在弹出框的`contentSize`变化发生的同时发生。

我的基本设置是一个自定义视图子类 MyPopoverNavigationView ，它有两个子视图：我希望弹出框在旧视图和新视图之间导航。弹出`contentViewController`框有一个 MyPopoverNavigationView 实例作为其`view`. 我这样做：

```
// Configure constraints how I want them to show the new popover view
[NSAnimationContext runAnimationGroup:^(NSAnimationContext *ctx) {
    [ctx setDuration:0.25];
    [ctx setAllowsImplicitAnimation:YES];
    [self layoutSubtreeIfNeeded];
} completionHandler:nil]; 
```

据我从 Auto Layout WWDC 2012 视频中可以看出，这是推荐的方法，因为约束更改而对视图帧的更改进行动画处理。它可以工作，但动画分两个阶段进行：

*   首先，弹出框`contentSize`将更改以适应我要移动到的新视图（*在*该视图变得可见之前，因此它会部分遮盖现有内容）。
*   其次，视图按照我的预期进行动画处理，从而满足我安装的约束系统。

通过设置一些断点，看起来`-layoutSubtreeIfNeeded`最终在弹出框上调用了一个名为 的私有方法，该方法在`_fromConstraintsSetWindowFrame:`我的动画组之外执行弹出框大小动画。我的上下文的持续时间没有受到尊重，并且我的动画在弹出框的大小更改完成之前不会发生。

如何让我的视图与弹出框的大小变化一起动画？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:10:24.790

事实证明，诀窍是在动画和完成块*之外*`contentSize`显式设置弹出框的属性。我整理的[示例 GitHub 项目](https://github.com/lithium3141/PopoverNavigationDemo)中的相关片段如下所示：

 *```
// Configure constraints for post-navigation view layout
[NSAnimationContext runAnimationGroup:^(NSAnimationContext *ctx) {
    [ctx setDuration:0.25];
    [ctx setAllowsImplicitAnimation:YES];
    [self layoutSubtreeIfNeeded];
} completionHandler:^{
    // Tear down some leftover constraints from before the transition
}];

// Explicitly set popover's contentSize so its animation happens simultaneously
containingPopover.contentSize = postTransitionView.frame.size; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-26T06:09:45.323

这对我在 Sierra 上很好用：

```
let deltaHeight = 8 
let contentSize = popover.contentSize  
NSAnimationContext.runAnimationGroup({ (context) -> Void in
    context.allowsImplicitAnimation = true
    popover.contentSize = NSSize(width: contentSize.width, height: contentSize.height+deltaHeight)
}) 
```*

# python - Python 预期的缩进错误

> ID：14783712
> 
> 赞同：0
> 
> 时间：2013-02-09T00:51:49.493
> 
> 标签：python, indentation

![它说预期的缩进无法弄清楚如何解决它。](../Images/9fe8ba9552749b01bfcc2a821b682157.png)

这是我在空闲时遇到的问题的图片，它说我有一个预期的缩进错误并且不知道该怎么做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T00:53:27.540

你所有的文档字符串应该再对齐一步：它们应该与方法内的代码对齐，而不是与方法定义对齐。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T00:53:56.937

您必须将文档字符串缩进到与代码相同的级别。

# python - 如何更新 TraitsUI 中的 ListStrEditor，或在 Python GUI 中显示列表的另一种方式？

> ID：14783714
> 
> 赞同：0
> 
> 时间：2013-02-09T00:52:05.130
> 
> 标签：python, traits, enthought, traitsui

我正在尝试学习如何使用 Traits 为我的 Python 脚本构建简单的 UI。我想用一个列表制作一个程序，用户可以用一个按钮添加单词，或者用另一个按钮完全清除列表。

到目前为止，我已经使用了特征：

```
myList = List(Str)

myList = ['Item1','Item2'] #Initial items in list 
```

为了在特性 UI 中显示这个列表，我使用了特性 UI 包中的 ListStrEditor：

```
Item('myList', show_label = False, label = 'Data Files', editor = ListStrEditor(auto_add = False) 
```

我编写了 2 个按钮：1) 一个用于将项目添加到列表 ( `myList.append('item3')`) 2) 一个清除按钮以清空列表 ( `myList = []`)。基本的用户界面很好，按钮工作正常，我的列表变量按预期更改。

但是，问题是，我在 GUI 中的列表没有更新。但是，如果我单击它，则会显示新值。另外，我想潜在地向其中添加许多项目，并想知道是否有办法在侧面添加滚动条？

我查阅了 ListStrEditor 手册和用法，尽管我对术语有些困惑。显然`refresh()`存在一个函数，但我不确定如何将它应用于 ListStrEditor。另外，我不确定是否需要使用称为“适配器”或“处理程序”的东西。

任何正确方向的提示或指示将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T15:27:18.143

如果没有看到更完整的代码，就很难知道您的代码为什么不起作用。也许你错过了使用`self`? 例如`self.myList.append('Item3')`，而不仅仅是`myList.append('Item3')`?

以下对我有用。只要按下按钮，列表的显示就会更新。

```
import random

from traits.api import HasTraits, List, Str, Button
from traitsui.api import ListStrEditor, View, UItem

class Demo(HasTraits):

    my_list = List(Str)

    add = Button("ADD")
    clear = Button("CLEAR")

    traits_view = \
        View(
            UItem('my_list', editor=ListStrEditor(auto_add=False)),
            UItem('add'),
            UItem('clear'),
        )

    def _my_list_default(self):
        return ['Item1', 'Item2']

    def _add_fired(self):
        new_item = "Item%d" % random.randint(3, 999)
        self.my_list.append(new_item)

    def _clear_fired(self):
        self.my_list = []

if __name__ == "__main__":
    demo = Demo()
    demo.configure_traits() 
```

它适用于 wx 和 qt4+pyside 后端。我正在使用 Enthought python 发行版 EPD 7.3，它具有 Traits 和 TraitsUI 的 4.2.0 版本。

如果您的代码明显不同，您可以将其添加到问题中吗？

# c# - 函数接受指向结构的指针

> ID：14783717
> 
> 赞同：3
> 
> 时间：2013-02-09T00:52:47.983
> 
> 标签：c#, pinvoke

我在C中有这个结构

```
struct system_info
{  
   const char *name;     
   const char *version;  
   const char *extensions; 
   bool        path;    
}; 
```

而这个函数签名

```
void info(struct system_info *info); 
```

我正在尝试像这样使用此功能：

```
[DllImport("...")]
unsafe public static extern void info(info *test);

[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public unsafe struct info
{
    public char *name;
    public char *version;
    public char *extensions;

    public bool path;
} 
```

而在我的主要：

```
info x = new info();
info(&x); 
```

我收到一个错误，指针无法引用封送结构，我该如何管理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T08:40:51.897

完全没有必要在`unsafe`这里使用。我会这样做：

```
public struct info
{
    public IntPtr name;
    public IntPtr version;
    public IntPtr extensions;
    public bool path;
} 
```

然后函数是：

```
[DllImport("...")]
public static extern void getinfo(out info value); 
```

您可能需要指定`Cdecl`调用约定，具体取决于本机代码。

像这样调用函数：

```
info value;
getinfo(out value);
string name = Marshal.PtrToStringAnsi(value.name);
// similarly for the other two strings fields 
```

由于在您发布的本机代码中没有提及字符串长度，我假设这些字符串是由本机代码分配的，并且您不需要做任何事情来解除分配它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T03:02:38.957

通过使用 ref 而不是 *test 像 Hans Passant 提到的那样解决

```
[DllImport("...")]
unsafe public static extern void info(ref system_info test); 
```

# objective-c - 主循环中的类方法？

> ID：14783722
> 
> 赞同：0
> 
> 时间：2013-02-09T00:53:10.217
> 
> 标签：objective-c, xcode, ios6, viewcontroller, iphone-developer-program

我有一些来自 ViewController 类的类方法，这些方法是用 BOOL 类型激活的。我想将这些方法插入主循环，因此当它们被激活时，该方法将运行，但由于某种原因，我无法将 viewController 方法放入 main 中。

但是我收到方法调用错误，并且该方法未显示在自动完成中。

```
#import <UIKit/UIKit.h>

#import "AppDelegate.h"

#import "ViewController.h"

int main(int argc, char *argv[])
{
    @autoreleasepool
    {

        [ViewController singleBoxShow];

        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T00:56:31.567

这是错误的地方。视图层次结构甚至还没有接近现有的。不要`main()`无缘无故*乱搞*。

相反，这应该在`ApplicationDelegate`. 比如`applicationDidFinishLaunchWithOptions:`。

# ios - 目标 C：转换为 ARC 后的无限 getter 方法循环

> ID：14783727
> 
> 赞同：2
> 
> 时间：2013-02-09T00:53:31.210
> 
> 标签：ios, objective-c, automatic-ref-counting

我有以下方法：

```
-(NSMutableArray *)someArray{ // line 1
    if(self.someArray == nil){ // line 2
        self.someArray = [[NSMutableArray alloc]init];
    }  
    return self.someArray;
} 
```

我在非 ARC 中有这个，它工作正常：如果`self.someArray`第 2 行是`nil`，那么继续实例化它。

但是，在我切换到 ARC 后，当它到达第 2 行时，它又回到第 1 行，并且循环继续。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T00:56:20.753

self.someArray 调用 getter，因此是无限循环。在该方法中使用 _someArray （假设您使用的是属性提供的自动 ivar。否则，请使用您的支持变量）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-09T00:57:31.117

正确的形式是

```
@synthesize someArray = _someArray;
- (NSMutableArray *)someArray {
    if (!_someArray) {
        _someArray = [NSMutableArray array];
    }
    return _someArray;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T00:55:57.630

发生的事情是您在访问器内部调用访问器方法。但是，如果每个访问者都调用自己，那么您将永远不会打破这个循环。

使用自动合成属性来避免这种情况：

```
-(NSMutableArray *)someArray{ // line 1
    if(_someArray == nil){ // line 2
        _someArray = [[NSMutableArray alloc]init];
    }  
    return _someArray;
} 
```

# validation - 使用 Lithium PHP 框架进行高级验证

> ID：14783731
> 
> 赞同：0
> 
> 时间：2013-02-09T00:54:18.320
> 
> 标签：validation, lithium

我正在通过 Lithium PHP 框架构建一个非常复杂和动态的表单。

我已经让表单正常工作并保存到 MongoDB 中没有什么问题。但我在验证方面遇到了麻烦。

简单的验证（例如检查字段是否为空或数字）工作正常。但是我必须做一些复杂的验证，这些验证依赖于表单中的许多字段。

例如，我有一个表单，用户可以在其中输入一个问题，然后为这个问题输入无限数量的可能答案。列出每个答案的字段 ID，例如“answer_1”、“answer_2”、“answer_3”等。用户可以添加无限数量的答案。这是通过一些花哨的 JavaScript 来实现的，这些 JavaScript 在客户端向表单中插入额外的元素。

在验证级别，我想确保添加的每个答案都不为空。

我想使用 Lithium 中内置的“传统”验证器功能来做到这一点。我也在模型级别执行此操作，而不是控制器级别（*注意*- 我有一个解决方法可以在控制器级别解决这个问题，但宁愿在模型中以“正确”的方式进行）

据我所知，问题在于您只能将单个值传递给验证器规则。我只需要将表单中的所有值传回验证器。如果我能做到这一点，我会是黄金。我想要做的伪代码如下所示：

```
 Validator::add('CorrectTest', function(&$value, $format = null, array $options = array()) {

        foreach ($_data as $key => $value) {
            if (stristr($key, "answer_")) {
                if ($value == "") {
                    return false;           
                }
            }
        }   

        return true;
    }); 
```

此代码不起作用，因为 $_data 值不存在。如果我能想出一种方法将一个完全填充的“$_data”对象放入验证器函数中，我想我可以让它工作。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T02:57:46.123

看看里面有什么`$options`。您应该在其中有一个“值”键，其中包含表单中的所有值。

所以试试 `$_data = $options['values'];`

# hadoop - InputSplit 的大小或映射任务的数量是否受输入文件数量的影响

> ID：14783736
> 
> 赞同：1
> 
> 时间：2013-02-09T00:54:44.827
> 
> 标签：hadoop, mapreduce, hdfs

如果我有很多小文件（~HDFS 块大小）与几个大文件相比，它会对作业产生的映射任务的数量产生影响吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:41:00.570

这取决于`InputFormat`您使用哪个，因为这决定了输入拆分计算，从而决定了地图任务的数量。

如果使用 default `TextInputFormat`，每个文件至少会有 1 个拆分，因此每个文件至少有 1 个映射器，即使这些文件只有几 kB，每个映射器做的工作很少，但这会给 Map/ 带来很多开销减少框架。也就是说，如果您保证这些“小”文件将接近块大小，那可能并不重要。

如果您无法控制文件并且它们可能会变得非常小，我建议您使用不同的`InputFormat`调用`CombineFileInputFormat`，它将多个输入文件组合在同一个拆分中，在这种情况下，地图的数量将仅取决于数据的总量，无论的文件数。可以在[此处](https://stackoverflow.com/a/14284330/1332690)找到实现。

# c# - 当我“新建”它时，ObservableCollection 失去了约束力

> ID：14783750
> 
> 赞同：17
> 
> 时间：2013-02-09T00:56:30.390
> 
> 标签：c#, wpf, binding

我的 UI 上有一个 ListBox，它绑定到 ObservableCollection 的属性。我将 ObservableCollection 的新实例设置到视图模型构造函数的属性中，并且可以使用表单上的按钮向其中添加项目。这些在列表中可见。

一切都很好。

*但是，如果我在按钮回调中使用new*重新初始化属性，它会破坏绑定并且 UI 不再显示集合中的内容。

我假设绑定将继续查找属性的值，但它可能链接到一个被*new*破坏的引用。

我做对了吗？任何人都可以扩展这是如何联系起来的吗？当我的视图模型不知道视图时，有没有办法重新绑定它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-09T01:06:11.093

确保在重新初始化集合后引发 PropertyChangedEvent。引发此事件将允许视图在模型不了解视图的情况下处理对属性的更改。

```
class Model : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(string name)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(name));
    }

    private ObservableCollection<string> _list = new ObservableCollection<string>();
    public ObservableCollection<string> List
    {
        get { return _list; }
        set 
        { 
            _list = value;
            NotifyPropertyChanged("List");
        }
    }

    public Model()
    {
        List.Add("why");
        List.Add("not");
        List.Add("these?");
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T01:06:23.577

我认为根据您的描述，您需要做的是重构公开 ObservableCollection 的属性，以便在为其分配新值时也会引发 PropertyChanged 事件。例子：

```
public ObservableCollection<int> Integers
{
    get { return this.integers; }
    set {
        if (this.integers != value)
        {
            this.integers = value;
            RaisePropertyChanged("Integers");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-09T01:06:47.560

假设您已经在 ViewModel 上实现了 INotifyPropertyChanged，那么每当您为其分配*新*值时，您都可以在 ObservableCollection 上引发属性更改事件。

```
public ObservableCollection<string> MyList { get; set; }

public void SomeMethod()
{
    MyList = new ObservableCollection<string>();
    RaisePropertyChanged("MyList");
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-09T01:11:47.167

对事件的更新`ObservableCollection`是通过挂钩`CollectionChanged`事件来处理的，因此当您创建新的观察者时，`ObservableCollection`您的观察者仍在查看旧集合。

两个简单的建议是`INotifyPropertyChanged`在包含 的类上实现`ObservableCollection`并在集合属性的设置器中引发`PropertyChanged`事件（如果它是您自己的代码，请不要忘记首先在您的观察者中从旧的取消挂钩）。

```
private ObservableCollection<string> _myCollection = new ObservableCollection<string>();
public ObservableCollection<string> MyCollection
{
    get { return _myCollection; }
    set
    {
        if(_myCollection == value)
            return;

        _myCollection = value;
        RaisePropertyChanged("MyCollection");
    }
} 
```

其次，我通常更喜欢的选项是在新数据到达时清除并重新填充集合。

```
public void HandleCollectionData(IEnumerable<string> incomingData)
{
    MyCollection.Clear();
    foreach(var item in incomingData)
    {
        MyCollection.Add(item);
    }
} 
```

# c# - 为什么发布后我的模型为空？循环索引

> ID：14783752
> 
> 赞同：0
> 
> 时间：2013-02-09T00:56:31.903
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我知道要在发布后获取模型，我们需要在剃刀视图中编写索引。我的模型有一个来自实体框架的实体，称为 Class，但该实体具有`ICollection<Student>`属性导航。

我的意思是，我需要从 Class 实体中公开我的项目，但问题是这个是 ICollection，我不知道如何公开索引。

这是我的剃刀观点：

```
@model Contoso.MvcApplication.Models.Assignment.ShareAssignmentViewModel

@{
    ViewBag.Title = "ShareAssignment";
}

<h2>Share Assignment: @Model.Assignment.Name</h2>

@for (int i = 0; i < Model.Classes.Length; i++)
{
<section>
    <h3>@Model.Classes[i].Name</h3>

    @for (int j = 0; j < Model.Classes[i].Students.Count; j++)
    {
        @Html.CheckBox(modelItem => Model.Classes[i].Students // what now?? [j])
    }
</section>
} 
```

发布后我该怎么做才能获得所有模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:19:41.140

```
@model Contoso.MvcApplication.Models.Assignment.ShareAssignmentViewModel

@{
    ViewBag.Title = "ShareAssignment";
}

<h2>Share Assignment: @Model.Assignment.Name</h2>

@for (int i = 0; i < Model.Classes.Length; i++)
{
   var studentsArray = Model.Classes[i].Students.ToArray();
<section>
    <h3>@Model.Classes[i].Name</h3>

    @for (int j = 0; j < studentsArray.Length; j++)
    {
        <input type="checkbox" 
               name="@(string.Format("Classes[{0}].Students[{1}]", i, j))" 
              value="@studentArray[j]" />
    }
</section>
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:16:31.270

您的意思是使用@Html.CheckBoxFor 而不是@Html.CheckBox？

在大多数情况下，@Html.CheckBoxFor 应该可以很好地呈现由默认模型绑定器自动填充模型所需的标记。我没有用您的代码对此进行测试，因为我不太了解 Model 类中的内容。但是，如果 @Html.CheckBoxFor 不起作用，您可以轻松使用自定义模型绑定器。一个教程在这里：

[http://brendan.enrick.com/post/custom-model-binders-in-aspnet-mvc.aspx](http://brendan.enrick.com/post/custom-model-binders-in-aspnet-mvc.aspx)

# php - 更改mysql表中的密码？

> ID：14783754
> 
> 赞同：-1
> 
> 时间：2013-02-09T00:56:42.303
> 
> 标签：php, html, passwords

嗨，我的更改密码脚本有问题。我试图允许用户在 mysql 表 'ptb_users.password' 中更改他们的密码，假设将其存储为 md5。

当我在我的表单中点击提交时，我假设它转到 changepassword.php 但页面只是空白，没有回显，我没有收到任何错误。

有人可以告诉我我哪里出了问题，谢谢

这是我的表格：

```
<?php 
// CONNECT TO THE DATABASE
    require('includes/_config/connection.php');
// LOAD FUNCTIONS
    require('includes/functions.php');
// GET IP ADDRESS
    $ip_address = $_SERVER['REMOTE_ADDR'];  
?>

  <?php require_once("includes/sessionframe.php"); 
  require('includes/checks.php');
?>

<?php

if (isset ($_GET['to'])) {
$user_to_id = $_GET['to'];

}

?> 

<?php 
//We check if the form has been sent
if(isset($_POST['subject'], $_POST['message_content']))
{
    $subject = $_POST['subject'];
    $content = $_POST['message_content'];
        //We remove slashes depending on the configuration
        if(get_magic_quotes_gpc())
        {
                $subject = stripslashes($subject);
                $content = stripslashes($content);
        }
        //We check if all the fields are filled
        if($_POST['subject']!='' and $_POST['message_content']!='')
        {
            $sql = "INSERT INTO ptb_messages (id, from_user_id, to_user_id, subject, content) VALUES (NULL, '".$_SESSION['user_id']."', '".$user_to_id."', '".$subject."', '".$content."');";
            mysql_query($sql, $connection);

            echo "<div class=\"infobox2\">The message has successfully been sent.</div>";
        }
}

if(!isset($_POST['subject'], $_POST['message_content']))

if (empty($_POST['subject'])){
        $errors[] = 'The subject cannot be empty.';

    if (empty($_POST['body'])){
        $errors[] = 'The body cannot be empty.';

    }
    }

{
?>

<form method="post" action="includes/changepassword.php" name="form1" id="form1">
<input type="password" name="oldpassword" id="password" class="subject" placeholder="Old Password">

<input type="password" name="oldpassword" id="password" class="message" placeholder="Old Password">

<input type="password" name="newpassword" id="newpassword" class="message" placeholder="New Password">

<input type="image" src="assets/img/icons/loginarrow1.png" name="submit" id="submit" class="submit">
</form> 
```

这是我的mysql函数：

```
<?php
require_once("session.php"); 
require_once("functions.php");
require('_config/connection.php');
?>
<?php 

session_start();

include '_config/connection.php'; 

$password = $_POST['password'];
$newpassword = $_POST['newpassword'];
$confirmnewpassword = $_POST['confirmnewpassword'];

$result = mysql_query("SELECT password FROM ptb_users WHERE id=".$_SESSION['user_id']."");

if(!$result) 
{ 
echo "The username you entered does not exist"; 
} 
else 
if($password!= mysql_result($result, 0)) 
{ 
echo ""; 
} 
if($newpassword=$confirmnewpassword) 
{
    $newpassword=md5($newpassword);
    $sql=mysql_query("UPDATE ptb_users SET password='$newpassword' WHERE id=".$_SESSION['user_id'].""); 
}
    if($sql) 
    { 
    echo "Thank You. Your Password has been successfully changed."; 
    }
else
{ 
echo "The new password and confirm new password fields must be the same"; 
}  
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T10:45:06.243

```
if(isset($_POST['submit']))
{

   $email = $_POST['email'];
   echo $newpassword = ($_POST['password1']);
   echo $confirmpasssword = ($_POST['password2']);

        if($newpassword=$confirmpassword) 
        {
            echo $newpassword = md5($newpassword);
            echo $result = mysql_query("UPDATE users SET password='$newpassword' WHERE email='$email' "); 
        }
                if($result) 
                { 
                echo "Thank You. Your Password has been successfully changed."; 
                }
            else
            { 
            echo "The new password and confirm password fields must be the same"; 
            }  
}

can anyone tell me is this correct coding, to change password and store in mysqldb. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:07:56.253

这有很多问题。

让我们先了解一下基础知识：

1.  不要使用 mysql_ 函数。尽可能切换到 PDO 或 mysqli。

2.  md5 正在消亡。看到[这个](https://stackoverflow.com/questions/10125219/md5-alternative-in-php)答案 - 可以理解，你可能在 md5 中根深蒂固，如果不纠缠每个用户更新他们的密码，你就无法离开。

那么你的问题是这样的：

```
if($password!= mysql_result($result, 0)) 
```

您没有与 md5 存储的哈希进行比较。它应该是这样的：

```
if(md5($password) != mysql_result($result, 0)) 
```

和这个：

```
if($newpassword=$confirmnewpassword) 
```

只是重新分配一个变量。我想你想要

```
if($newpassword == $confirmnewpassword) 
```

至于输出，您可能需要考虑您在此处使用的 if/else 结构。这可以显着清理，所有这些看起来都过时了。也许只是一个意见。

如果您有具体的事情要磨练，请告诉我，我可能会更新。

*编辑*

这整个块应该被清理。这样的事情可能会有所帮助：

```
if(!$result) 
{ 
    echo "The username you entered does not exist"; 
} 
else
{
    if(md5($password) != mysql_result($result, 0)) 
    { 
        echo "Current PW does not match what we have"; 
    }
    else
    {
        if($newpassword == $confirmnewpassword) 
        {
            $newpassword=md5($newpassword);
            $sql=mysql_query("UPDATE ptb_users SET password='$newpassword' WHERE id=".$_SESSION['user_id']."") or die(mysql_error());

            if($sql) 
            { 
              echo "Thank You. Your Password has been successfully changed."; 
            } 
        }
        else
        { 
            echo "The new password and confirm new password fields must be the same"; 
        }
    } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T01:08:35.000

首先你没有正确检查旧密码（md5 存储，明文比较......不起作用）其次你没有设置任何确认密码，所以这也不起作用

什么会起作用：

```
$password = md5($_POST['password']);
$newpassword = md5($_POST['newpassword']);

$result = mysql_query("SELECT password FROM ptb_users WHERE id=".$_SESSION['user_id']." AND password = '".$password."'");
if(!$result) 
{ 
echo "The username you entered does not exist or old password didn't match"; 
} 
else
{
     $sql=mysql_query("UPDATE ptb_users SET password='$newpassword' WHERE id=".$_SESSION['user_id'].""); 
}
if($sql) 
{ 
    echo "Thank You. Your Password has been successfully changed."; 
} 
```

# c# - 为什么我不能在 C# 代码文件中使用 Request.ServerVariables["ALL_HTTP"]？

> ID：14783756
> 
> 赞同：2
> 
> 时间：2013-02-09T00:57:27.777
> 
> 标签：c#, asp.net, iis

我可以 `Request.ServerVariables["ALL_HTTP"]`在 .aspx 文件中使用 % 标记，即，`<%=Request.ServerVariables["ALL_HTTP"]%>` 但是 .cs 文件将无法识别命名空间。是什么赋予了？我需要将这些变量放入我的代码文件中的数组中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:18:18.650

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

using System.Collections.Specialized;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

        NameValueCollection coll;
        coll = Request.ServerVariables;
        // Get names of all keys into a string array. 
        String[] arr1 = coll.AllKeys;
        for (int loop1 = 0; loop1 < arr1.Length; loop1++)
        {
            Response.Write("Key: " + arr1[loop1] + "<br>");
            String[] arr2 = coll.GetValues(arr1[loop1]);
            for (int loop2 = 0; loop2 < arr2.Length; loop2++)
            {
                Response.Write("Value " + loop2 + ": " + Server.HtmlEncode(arr2[loop2]) + "<br>");
            }
        }

    }
} 
```

# java - 活动结果 ()

> ID：14783758
> 
> 赞同：1
> 
> 时间：2013-02-09T00:57:43.747
> 
> 标签：java, android, methods

我有代码可以让我从计算器中获取价值并进一步使用它：

```
//-----------------This section creates the keypad functionality
for (int o = 0; o < keybuttons.length; o++) {
    final int n = o;
    keybuttons[o] = (Button) findViewById(data.keyIds[n]);
    keybuttons[o].setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            try {
                String tmp = texts[selectEdit].getText()
                    .toString();
                switch (n) {
                case 3:
                    texts[selectEdit].setText(tmp.substring(0, tmp.length() - 1));
                    break; //get cursor position and delete char
                case 7:
                    {
                        // Create intent for RealCalc.
                        Intent intent2 = new Intent("uk.co.quarticsoftware.REALCALC");
                        double x = 0; // Set initial value (double).
                        if (!texts[selectEdit].getText()
                            .toString()
                            .equals("")) {
                            x = Double.valueOf(texts[selectEdit].getText()
                                .toString());
                        }
                        intent2.putExtra("X", x);
                        // Launch calculator
                        try {
                            startActivityForResult(intent2, 0);
                        } catch (ActivityNotFoundException e) {
                            Intent intent = new Intent(Intent.ACTION_VIEW,
                            Uri.parse("market://details?id=uk.co.nickfines.RealCalc"));
                            try {
                                startActivity(intent);
                            } catch (ActivityNotFoundException f) {
                                // Google Play Store app not available.
                            }
                        }
                        break;
                    } //open Calculator
                case 11:
                    {
                        if (!tmp.contains("E")) texts[selectEdit].setText(tmp + "" + keybuttons[n].getText());
                        break;
                    } //check for E if dont have do default case
                case 15:
                    {
                        TL.setVisibility(View.GONE);
                        break;
                    } //simulate back button
                default:
                    {
                        texts[selectEdit].setText(tmp + "" + keybuttons[n].getText());
                        //get cursor start and end and get entire String
                        // replace selected String with button text
                        //insert back
                        break;
                    }
                } //end of switch
            } //end of try
            catch (ActivityNotFoundException e) {
                Intent intent = new Intent(Intent.ACTION_VIEW,
                Uri.parse("market://details?id=uk.co.nickfines.RealCalc"));
                // Calculator not installed
            } //calculator.num=n;
            catch (Exception e) {
                StringWriter sw = new StringWriter();
                e.printStackTrace(new PrintWriter(sw));
                EasyPhysActivity.error = sw.toString();
            }
        }

        @Override
        protected void onActivityResult(int requestCode, int resultCode, Intent data) {
            super.onActivityResult(requestCode, resultCode, data);
            if (resultCode == Activity.RESULT_OK) {
                // User pressed OK.
                double value = data.getDoubleExtra("X", Double.NaN);
                if (Double.isNaN(value)) {
                    // Calculation result was "Error".
                } else {
                    // Calculation result ok.
                }
            } else {
                // User pressed cancel or back button.
            }
        }
    });

}
//---------------------------------------- 
```

但它不喜欢这三行：

```
@Override
protected void onActivityResult (int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data); 
```

如果我删除`@Override`它会变得更好，但它仍然显示错误

```
super.onActivityResult(requestCode, resultCode, data); 
```

这里出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:04:04.780

您不能`onActivityResult`在内部覆盖，`OnClickListener`因为它在基类中不存在。移动您的`onActivityResult`代码，使其位于您的`Activity`类中，而不是`OnClickListner`.

# php - 移除 DOM 警告 PHP

> ID：14783760
> 
> 赞同：2
> 
> 时间：2013-02-09T00:58:13.097
> 
> 标签：php, dom

我有这个代码：

```
$strhtml = file_get_contents('05001400300320100033100.html');
$dochtml = new DOMDocument();
 $dochtml->loadHTML($strhtml);
 $elm = $dochtml->getElementById('upPanelActuciones');
 print $dochtml->saveXml($elm); 
```

我收到这个警告：

```
 Warning: DOMDocument::loadHTML() [domdocument.loadhtml]: error parsing attribute  name in Entity, line: 674 in C:\AppServ\www\video01\sector2\dom3.php on line 10

      Warning: DOMDocument::loadHTML() [domdocument.loadhtml]: Opening and ending tag mismatch: div and td in Entity, line: 1019 in C:\AppServ\www\video01\sector2\dom3.php on line 10

      Warning: DOMDocument::loadHTML() [domdocument.loadhtml]: Opening and ending tag mismatch: div and td in Entity, line: 1020 in C:\AppServ\www\video01\sector2\dom3.php on line 10

      Warning: DOMDocument::loadHTML() [domdocument.loadhtml]: Opening and ending tag mismatch: div and td in Entity, line: 1022 in C:\AppServ\www\video01\sector2\dom3.php on line 10 
```

我无法操作 html（我知道 html 文件有错误），所以有办法删除这个警告吗？（没有出现）。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-09T01:10:42.723

> DOMDocument 非常擅长处理不完美的标记，但它会在所有地方抛出警告。
> 
> 这在这里没有很好的记录。对此的解决方案是实现一个单独的设备来处理这些错误。
> 
> 在调用 loadHTML 之前设置 libxml_use_internal_errors(true)。这将防止错误冒泡到您的默认错误处理程序。然后，您可以使用其他 libxml 错误函数来处理它们（如果您愿意）。
> 
> 你可以在这里找到更多信息 [http://www.php.net/manual/en/ref.libxml.php](http://www.php.net/manual/en/ref.libxml.php)

处理 DOMDocument 错误的正确方法是：

```
<?php

// enable user error handling
var_dump(libxml_use_internal_errors(true));

// load the document
$doc = new DOMDocument;

if (!$doc->load('file.xml')) {
    foreach (libxml_get_errors() as $error) {
        // handle errors here
    }

    libxml_clear_errors();
}

?> 
```

# javascript - Jquery在滚动上移动元素？

> ID：14783763
> 
> 赞同：-3
> 
> 时间：2013-02-09T00:58:17.187
> 
> 标签：javascript, jquery

示例：我有水平菜单（在标题上），然后如果我向下滚动页面（从顶部大约> 100px），菜单（水平）将移动到浏览器的左侧（垂直）并固定在那里......

有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T01:00:44.277

尝试这个：

[这是工作 jsFiddle](http://jsfiddle.net/4TfTF/232/)和[source](https://stackoverflow.com/questions/11971475/setting-css-value-limits-of-the-window-scrolling-animation/11971912#11971912)。

```
$(window).scroll(function() {

   var headerH = $('.header').outerHeight(true);
   //this will calculate header's full height, with borders, margins, paddings
   var scrollTopVal = $(this).scrollTop();
    if ( scrollTopVal > headerH ) {
        $('#subnav').css({'position':'fixed','top' :'0px'});
    } else {
        $('#subnav').css({'position':'static','top':'0px'});
    }

   var scrollLeftVal = $(this).scrollLeft();
   if ( scrollLeftVal > 1 ) { alert('i scrolled to the left'); }
}); 
```

# git - 在 .gitattributes 中指定 dir/* 不会抑制所有所需的输出

> ID：14783765
> 
> 赞同：0
> 
> 时间：2013-02-09T00:58:38.800
> 
> 标签：git

我想抑制文件的所有输出

```
 dir/* 
```

使用命令时

```
 git diff 
```

我决定遵循 [从 git-diff 中排除文件的建议](https://stackoverflow.com/questions/1016798/excluding-files-from-git-diff)

**方法一。**

添加到**.git/config**

```
[alias]
    mydiff = !git diff -- $(git diff --name-only | grep -Ev "dir/") 
```

并使用

```
git mydiff 
```

按预期工作，从而解决了我的问题。但是，我想使用方法 2。

**方法2。**

添加到**.gitattributes**

```
dir/* -diff 
```

然后使用

```
git diff 
```

产生输出

```
diff --git a/dir/1 b/dir/1
deleted file mode 100644
index 05e9130..0000000
... 
```

**问题** 如何抑制 dir/ 中所有文件的这种不需要的输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T15:33:39.267

您在设置中看到输出的原因是`dir/* -diff`仅将文件标记`dir`为二进制文件，因此文本差异不适用于它们（请参阅 参考资料`man 5 gitattributes`）。

要抑制文件的任何输出，`dir`您必须定义一个外部差异驱动程序，如下所示：

1.  分配新的“沉默”（你可以选择你的名字）差异驱动程序：

    ```
    $ cat .gitattributes 
    dir/* diff=silent 
    ```

2.  定义“静默”差异函数：

    ```
    $ tail -n2 .git/config
    [diff "silent"]
        command = "true" 
    ```

这应该够了吧。

# google-app-engine - 使用 GoogleAppEngineLauncher 运行 web2py

> ID：14783770
> 
> 赞同：1
> 
> 时间：2013-02-09T00:59:25.603
> 
> 标签：google-app-engine, web2py

尝试使用 GoogleAppEngineLauncher 从开发服务器运行我的 web2py 应用程序

不确定在线教程是否已过时或者我只是遗漏了一些东西，但是当我按照链接下载适用于 OSX 的 GoogleAppEngine pythonSDK 时，我得到了 GoogleAppEngineLauncher 的 dmg。

我下载并使用它，它安装了正确的可执行文件，但是在我设置我的 app.yaml 文件并运行“dev_appserver.py myApp”之后，我收到了这个错误：

fancy_urllib.InvalidCertificateException：主机 appengine.google.com 返回了无效证书（_ssl.c:503：错误：14090086：SSL 例程：SSL3_GET_SERVER_CERTIFICATE：证书验证失败）：

如果我尝试从启动器本身启动应用程序，我不会收到错误消息，但是我无法启动应用程序，因为它说目录已经存在并且我没有写入权限。我什至在 myApp 目录上尝试了 chmod 777。

我不应该使用 GoogleAppLauncher 吗？

另外我尝试使用 linux SDX 并收到相同的“证书”错误。错误消息将我引导到一个链接，该[链接](https://developers.google.com/appengine/kb/general#rpcssl)提到我需要“ssl”模块，但它包含在我正在使用的 python 2.7.2 中。

该链接还提到：“默认情况下，appcfg 在连接到管理控制台时使用 SSL，除非传递了 --insecure 标志。” 但是我在帮助菜单中找不到那个标志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:08:06.187

找到解决问题的[答案](https://stackoverflow.com/questions/13899530/gae-sdk-1-7-4-and-invalidcertificateexception)。

基本上：

```
rm google_appengine/lib/cacerts/cacerts.txt 
```

来自 SDK

# ios - iOS，在 UIImage 上用笔划绘制文本

> ID：14783771
> 
> 赞同：2
> 
> 时间：2013-02-09T00:59:37.970
> 
> 标签：ios, objective-c, fonts, uiimage, stroke

我目前正在将文本绘制到 UIImage 上，该 UIImage 出现在 iOS 地图的 AnnotationView 中 - 自定义图标出现在某些长/纬度坐标处。效果很好。但是，我想用白色笔划来绘制这个文本（你可以称之为轮廓）。

//[绘制文本并添加到 UIImage iOS 5/6](https://stackoverflow.com/questions/12571852/draw-text-and-add-to-a-uiimage-ios-5-6)

```
+ (UIImage*)drawText:(NSString*)string inImage:(UIImage*)image atPoint:(CGPoint)point {

    UIFont *font = [UIFont boldSystemFontOfSize:12];
    UIGraphicsBeginImageContext(image.size);
    [image drawInRect:CGRectMake(0,0,image.size.width,image.size.height)];

    CGRect rect = CGRectMake(point.x, point.y, image.size.width, image.size.height);
    [[UIColor whiteColor] set];
    [string drawInRect:CGRectIntegral(rect) withFont:font];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-25T15:09:21.953

NSAttributedString 绝对是要走的路，特别是如果你希望它在 iOS7 中工作。对于您的示例，您可以将两个文本块替换为以下内容：

```
// draw stroke
NSMutableDictionary *attributes = [[NSMutableDictionary alloc] init];
[attributes setObject:font forKey:NSFontAttributeName];
[attributes setObject:[NSNumber numberWithFloat:4] forKey:NSStrokeWidthAttributeName];
[attributes setObject:[UIColor whiteColor] forKey:NSStrokeColorAttributeName];
[self.text drawInRect:rect withAttributes:attributes];

// draw fill
[attributes removeObjectForKey:NSStrokeWidthAttributeName];
[attributes removeObjectForKey:NSStrokeColorAttributeName];
[attributes setObject:[UIColor blackColor] forKey:NSForegroundColorAttributeName];
[self.text drawInRect:rect withAttributes:attributes]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T22:30:39.843

花费的时间和精力比我想象的要多，但万一有人在寻找相同的解决方案……显然在 iOS7 下无法工作，当我找到答案时会更新

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    UIImage *backgroundImage = [UIImage imageNamed:@"abstract_art_masterpiece_b.jpg"];
    UIImage *textWithStrokeImage = [RJViewController drawTextWithStroke:@"unit 111"];
    UIImage *image = [RJViewController placeImage:textWithStrokeImage onImage:backgroundImage];

    self.imageView.image = image;
}

+ (UIImage*)placeImage:(UIImage*)image1 onImage:(UIImage*)image2 {

    CGSize size = image2.size;

    if ([UIScreen instancesRespondToSelector:@selector(scale)] && [[UIScreen mainScreen] scale] == 2.0f) {
        UIGraphicsBeginImageContextWithOptions(size, NO, 2.0f);
    } else {
        UIGraphicsBeginImageContext(size);
    }

    [image2 drawAtPoint:CGPointMake(0, 0)];
    [image1 drawAtPoint:CGPointMake(0, 0)];

    UIImage* result = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return result;
}

+ (UIImage*)drawTextWithStroke:(NSString*)string {

    // set rect, size, font

    CGRect rect = CGRectMake(0, 0, 88, 24);
    CGSize size = CGSizeMake(rect.size.width, rect.size.height);
    UIFont *font = [UIFont fontWithName:@"Helvetica-Bold" size:12];

    // retina display, double resolution

    if ([UIScreen instancesRespondToSelector:@selector(scale)] && [[UIScreen mainScreen] scale] == 2.0f) {
        UIGraphicsBeginImageContextWithOptions(size, NO, 2.0f);
    } else {
        UIGraphicsBeginImageContext(size);
    }

    CGContextRef context = UIGraphicsGetCurrentContext();

    // draw stroke

    CGContextSetStrokeColorWithColor(context, [UIColor whiteColor].CGColor);
    CGContextSetLineWidth(context, 4.0);
    CGContextSetTextDrawingMode(context, kCGTextStroke);
    [string drawInRect:CGRectIntegral(rect) withFont:font];

    // draw fill

    CGContextSetFillColorWithColor(context, [UIColor blackColor].CGColor);
    CGContextSetTextDrawingMode(context, kCGTextFill);
    [string drawInRect:CGRectIntegral(rect) withFont:font];

    // convert to image and return

    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return newImage;

} 
```

# dynamic - 使用方法引用时的常规方法范围

> ID：14783773
> 
> 赞同：1
> 
> 时间：2013-02-09T01:00:09.563
> 
> 标签：dynamic, methods, groovy

我有一个 groovy 类，它查找方法引用然后调用它。被调用的方法是私有方法。当实际类是子类的实例时，它会抛出一个找不到私有方法的错误，即使它是父类中的公共方法实际调用它。

在这种情况下，我显然可以`pMethod2()`直接调用并且它有效，但我试图理解为什么这不能像书面那样工作，以及是否有办法纠正它以便它工作。

```
class Parent {

  def pMethod1() {
    def m = this.&pMethod2
    m() // this call fails if the calling class is of type Child
  }

  private def pMethod2() {}

  public static void main(String[] args) {
    new Child().pMethod1();
  }
}

class Child extends Parent {} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T20:39:38.190

这有点令人困惑，尤其是如果您习惯于 C/C++。在 Groovy 中使用“.&”运算符时得到的不是地址，而是 MethodClosure 的实例。

MethodClosure 对象包含一个所有者和一个委托对象，用于解析要调用的方法。在您的示例中，所有者和委托对象将是“this”，它是 Child 的一个实例。要调用的方法简单地存储为字符串。

所以，任务

```
m = this.&pMethod2 
```

只是一种简写方式

```
m = new MethodClosure(this, "pMethod2") 
```

当您调用 m() 闭包时，它将尝试通过分别在所有者和委托对象中查找名为“pMethod2”的方法来解析（在运行时）该方法。由于所有者和委托是 Child 的一个实例，它不会找到位于 Parent 中的私有方法。

要使您的示例工作，您必须确保该方法对闭包的所有者和/或委托人可见。

这可以通过多种方式完成，例如通过将 pMethod2 的访问修饰符更改为受保护，或者通过使用 Parent 的实例创建闭包；像这样的东西：

```
m = new Parent().&pMethod2 
```

请注意，这与您在 pMethod2 实际可见的方法中创建 MethodClosure 实例无关。在可见的方法中调用闭包也无关紧要。MethodClosure 的所有者或委托人看不到该方法，这是解析该方法时使用的方法。

# objective-c - 在 UILabel 上设置文本会重置其他 UI 元素的位置

> ID：14783779
> 
> 赞同：0
> 
> 时间：2013-02-09T01:01:00.513
> 
> 标签：objective-c, uilabel

我只是在学习objective-c，所以我的问题可能很简单。我正在创建一个简单的游戏，该游戏具有用于跟踪玩家得分的标签。游戏运行良好，计算分数没有问题。当我将标签的 text 属性设置为存储在我的 score 变量中的值时，就会出现问题。

```
score += (int)someFloatValue;
NSString *scoreText = [NSString stringWithFormat:@"%i", score];
scoreLabel.text = scoreText; 
```

在我的游戏循环中，我总是设置这个文本。因此，即使在分数超过零之前，我也会不断地将文本设置为零值。到目前为止没有问题。一旦玩家得分，我的 score 变量中的值就会改变。仍然没有问题。但是，当我使用新分数更新标签的文本时，我所有 UI 元素的位置都会重置回最初在界面生成器中设置的位置。没有崩溃。并且分数会正确显示在标签中。只是每个 UI 元素都会被移动。

不确定这是否有帮助，但我认为我设置了一切正确：

h 文件：

```
@interface ViewController : UIViewController{
    UILabel *scoreLabel;
    NSInteger score;
}

@property (nonatomic, retain) IBOutlet UILabel *scoreLabel;
@property (nonatomic) NSInteger score; 
```

.m 文件：

```
@interface ViewController ()

@end

@synthesize scoreLabel;
@synthesize score; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:13:09.417

如果您在代码中移动 UI 元素而不是在 IB 中设置约束，请务必关闭自动布局。

[在 Interface Builder 中删除自动布局（约束）](https://stackoverflow.com/questions/9566789/remove-autolayout-constraints-in-interface-builder)

此外，您可以像这样简化该代码（尽管它很好）：

```
scoreLabel.text = [NSString stringWithFormat:@"%i", score]; 
```

# gcc - 哪个内联汇编代码对 rdtscp 是正确的？

> ID：14783782
> 
> 赞同：15
> 
> 时间：2013-02-09T01:01:06.583
> 
> 标签：gcc, assembly, x86-64, inline-assembly

免责声明：言语无法描述我对 AT&T 风格语法的厌恶程度

我有一个问题，我希望是由寄存器破坏引起的。如果没有，我有一个更大的问题。

我使用的第一个版本是

```
static unsigned long long rdtscp(void)
{
    unsigned int hi, lo;
    __asm__ __volatile__("rdtscp" : "=a"(lo), "=d"(hi));
    return (unsigned long long)lo | ((unsigned long long)hi << 32);
} 
```

我注意到这个版本中没有“破坏”的东西。这是否是我不知道的问题......我想这取决于编译器是否内联函数。使用这个版本会给我带来*一些并不总是可重现的*问题。

我找到的下一个版本是

```
static unsigned long long rdtscp(void)
{
    unsigned long long tsc;
    __asm__ __volatile__(
        "rdtscp;"
        "shl $32, %%rdx;"
        "or %%rdx, %%rax"
        : "=a"(tsc)
        :
        : "%rcx", "%rdx");

    return tsc;
} 
```

这是令人放心的不可读和官方外观，但就像我说的那样，我的问题并不总是可重现的，所以我只是试图排除我的问题的一个可能原因。

我*认为*第一个版本存在问题的原因是它覆盖了以前保存函数参数的寄存器。

什么是正确的...版本 1 或版本 2，或两者兼而有之？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-09T01:19:17.417

这是将返回 TSC 并将辅助 32 位存储到参考参数中的 C++ 代码

```
static inline uint64_t rdtscp( uint32_t & aux )
{
    uint64_t rax,rdx;
    asm volatile ( "rdtscp\n" : "=a" (rax), "=d" (rdx), "=c" (aux) : : );
    return (rdx << 32) + rax;
} 
```

最好在 C++ 语句中执行`shift`并`add`合并两个 32 位半部分而不是内联，这允许编译器在它认为合适的时候调度这些指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:10:54.643

据此，[此](https://stackoverflow.com/questions/12631856/difference-between-rdtscp-rdtsc-memory-and-cpuid-rdtsc)操作破坏了 EDX 和 ECX。您需要将这些寄存器标记为已损坏，这是第二个所做的。顺便说一句，这是您获得上述代码的链接还是您在其他地方找到的链接？它还显示了一些其他的时间变化，非常简洁。

# php - CakePHP：是否可以从控制器访问受保护的函数？

> ID：14783785
> 
> 赞同：2
> 
> 时间：2013-02-09T01:01:29.013
> 
> 标签：php, cakephp

我在控制器中编写了两个动作`some_controller`，允许人们下载文件。程序是这样的：

1.  用户转到`some_controller/export_data`并单击表单以生成文本文件。
2.  然后该操作`export_data()`为用户写入一个文本文件。
3.  一旦检测到文件已生成，则会出现另一个按钮供用户单击以通过媒体视图下载文件。这个动作是`some_controller/download_file`。

我的问题是，如何`some_controller/download_file`手动使用户无法访问？即我想阻止用户在浏览器中输入这个 URL 并下载文件。我尝试设置`protected function _download_file()`，但这使得视图无法访问中的操作`some_controller`。

我觉得我正在以错误的方式接近这个。有人想给我一些指示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T07:03:03.617

当用户单击`generate a text file`按钮时：

1.  在`some_controller/export_data`行动中设置会话变量

2.  在`some_controller/download_file`行动中首先检查该会话变量。

3.  如果已设置，则允许用户下载文件并销毁会话。

4.  如果不是，那么现在让他下载文件。

这样，您可以分配`some_controller/download_file` `public`访问权限。

如果用户直接访问`some_controller/download_file action`，则会话变量将不存在并且他无法下载文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T15:34:49.537

无法保护该操作，因为当用户单击下载按钮时您需要它。你能做的最好的就是保护它，这是完全可以接受的。例如，您可以执行以下操作：

1.  在 export_data 中生成代表文件的随机密钥（即 1234）
2.  当按钮出现时，url 包含代表文件的键（即 ../some_controller/download_file?key=1234）
3.  在 download_file 中，检查 key 是否存在并且代表一个可以下载的文件。如果密钥是好的，给他们文件，如果它没有显示错误消息。

# c - 在 C 中的输入系统调用期间添加的额外字符串

> ID：14783787
> 
> 赞同：0
> 
> 时间：2013-02-09T01:01:54.807
> 
> 标签：c, linux

当我在 linux 上使用 GCC 编译它时，当我等待输入时，“hi”出现了。我不想使用 scanf，并且想知道为什么在我要求用户输入名称时显示 hi。此外，当我想打印刚刚通过的文件的名称时，我会得到垃圾字符。在netbeans中，我得到了我想要的。但在 linux 上，它决定表现得很奇怪。请帮忙

代码：

```
int main(int argc, char** argv)
{
char val[70];
        if(write(1, "Please input your name", 36)!=36)
        {
                return -1;
        }
        if(read(0, val, 36) < 0)
        {}

        if(write(1, val, 36)!=36)
        {}

printf("Yo");//THIS IS PRINTING OUT WAY BEFORE IT IS CALLED, ANY VARIABLE WITH A STRING     GETS PRINTED OUT, EVEN WITHOUT PRINTF BEING INVOKED
} 
```

输出：

```
Please input the file nameYo: hi
hi
???Om?0?a?Sm?  <<WHAT IS THIS? I DONT GET THIS ON NETBEANS 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:08:00.900

第三个参数`write`是您要打印的字符串的字节长度。您有 36 个，但您提供的字符串只有 22 个字节长。将代码更改为如下所示的行为将与您预期的一样：

```
int main(int argc, char** argv)
{
    char val[70];
    if(write(1, "Please input your name", 22)!=22)
    {
        return -1;
    }
    if(read(0, val, 36) < 0)
    {}

    if(write(1, val, 36)!=36)
    {}

    printf("Yo");//THIS IS PRINTING OUT WAY BEFORE IT IS CALLED, ANY VARIABLE WITH A STRING     GETS PRINTED OUT, EVEN WITHOUT PRINTF BEING INVOKED
} 
```

请注意，您可能应该考虑使用`printf`，`scanf`这样您就不必担心字节长度了。

这可能看起来像这样：

```
#include <stdio.h>

int main(int argc, char** argv)
{
    char val[70];
    printf("Please input your name");

    if(scanf("%69s", &val) == 1)
        printf(val);

    printf("Yo");
} 
```

# iis - 我可以以编程方式识别 IIS 服务器设置吗？（最大连接数等）

> ID：14783788
> 
> 赞同：0
> 
> 时间：2013-02-09T01:02:24.303
> 
> 标签：iis, signalr, web-hosting

我正在尝试在廉价的共享主机提供商上运行 SignalR 应用程序 (.NET 4.5)，并且我已经读到如果服务器设置分配得太低，IIS 可能会开始限制连接。由于我对此服务器没有管理员控制权，有没有办法以编程方式检查服务器设置，例如每个 CPU 的最大连接数等？

# linux - 使用 NodeJS 访问系统图标

> ID：14783790
> 
> 赞同：3
> 
> 时间：2013-02-09T01:02:34.470
> 
> 标签：linux, node.js

我正在使用[node-webkit](https://github.com/rogerwang/node-webkit)开发一个 HTML5 应用程序。

我希望我的应用程序遵循运行它的主机（主要是 Linux 主机）的图标主题。

框架如`GTK+`或`QT`根据用户的主题成功找到一个标准股票（如NEW_FILE）的对应图标。

GTK 图标主题安装在**$HOME/.icons**或**/usr/share/icons**和图标主题共享一个共同的目录结构。

但是是否有任何规则或算法来获得一个精确的图标？

如何在用户主题中查找（**NEW_FILE**、**SAVE_FILE**或其他）股票图标？

我对此很迷茫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T20:58:11.363

您可以查看 GTK+ 或 QT 的源代码，看看它们如何确定正确的图标？

# java - JAXB 如何猜测列表的模式类型？

> ID：14783791
> 
> 赞同：3
> 
> 时间：2013-02-09T01:02:39.043
> 
> 标签：java, generics, jaxb

这是我从头开始定义的示例 jaxb 类。当我尝试使用 JAXB 为此类生成架构时，它正确猜测列表的 itemType 为“int”

JVM 不会在运行时丢弃泛型吗？通过这样做，List 的容器类型在运行时会丢失，但 jaxb 仍然知道 itemType 是 Integer。我很好奇 jaxb 框架是如何实现这一点的。有任何想法吗？

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "int-list")
public class IntegerList{
    @XmlValue
    private List<Integer> values;

    public List<Integer> getValues() {
        return values;
    }

    public void setValues(List<Integer> values) {
        this.values = values;
    }
} 
```

使用 JAXBContext.generateSchema 生成的相应模式：

```
 <xs:simpleType name="int-list">
    <xs:list itemType="xs:int"/>
  </xs:simpleType> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:49:28.783

> JVM 不会在运行时丢弃泛型吗？

是的，关于实际的字节码（好吧，是编译器把它们扔掉了）。但是类和某些变量的泛型类型信息仍然可以在运行时通过使用反射来收集。例如：

```
Field field = IntegerList.class.getDeclaredField("values");
Type fieldType = field.getGenericType();
Type typeArg = ((ParameterizedType)fieldType).getActualTypeArguments()[0];
System.out.println(typeArg); //class java.lang.Integer 
```

只是一个猜测，但 JAXB 可能会做类似的事情，然后映射`Integer.class`到`int.class`.

# ruby-on-rails - 如何在 Heroku 上抓取来自同一域的页面

> ID：14783794
> 
> 赞同：0
> 
> 时间：2013-02-09T01:03:05.697
> 
> 标签：ruby-on-rails, ruby, heroku, nokogiri

我创建了一个 Facebook 风格的 URL 抓取工具来发布内容。

当有人输入一个 URL 时，它会发送一个请求，在后端，我使用 Nokogiri 抓取 URL 以提取信息来构建帖子。

它适用于所有其他网站，如 apple.com、sony.com，但是当我使用来自我的原始域（“mywebsite.com”）的链接时它超时，除了 Heroku 在 30 秒后超时请求之外没有显示错误. 如果我从计算机上的本地主机上抓取我的域，它就可以工作。

是否有某种来源规则阻止 Nokogiri 抓取来自同一域的页面？

我正在使用 Ruby On Rails 3.1.10、Nokogiri 1.4.7 和 Heroku Cedar Stack。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T10:12:08.220

抓取是在后台作业中运行还是通过网络工作者运行？你只有1个dyno吗？如果您的应用只有 1 个网络工作者，那么它可能正忙于尝试抓取，因此无法提供该页面。

尝试将您的测功机缩放到 2，看看问题是否仍然存在。

```
heroku ps:scale web=2 
```

# c++ - catch 块中的函数抛出异常

> ID：14783795
> 
> 赞同：0
> 
> 时间：2013-02-09T01:03:11.227
> 
> 标签：c++, exception-handling

如果我的代码中有一个 try catch 块，并且 catch 块中的函数生成异常，那么该异常会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:06:25.090

`catch`从子句中抛出并没有什么特别之处。

通常，如果该`catch`子句仅用于某些本地清理，那么从该`catch`子句中重新抛出当前异常是一个好主意和良好的通用编程习惯，这就是`throw`无参数的用途。

另一方面，从析构函数抛出通常是有问题的，因为在堆栈展开期间可能会自动调用析构函数（然后终止程序）。

# scala - 在参数 func 需要隐式视图的情况下，我应该如何编写这个高阶函数？

> ID：14783797
> 
> 赞同：1
> 
> 时间：2013-02-09T01:03:27.767
> 
> 标签：scala, implicit

我有一个使用 Seq[A] 的隐式视图的函数，您可以看到它使用了 head 方法并保留了类型：-

```
scala> def needSeq[A, C <% Seq[A]](col: C) = { (col.head , col) }
needSeq: [A, C](col: C)(implicit evidence$1: C => Seq[A])(A, C)

scala> needSeq(List(1,2,3))
res0: (Int, List[Int]) = (1,List(1, 2, 3))

scala> needSeq(List("a","b"))
res1: (java.lang.String, List[java.lang.String]) = (a,List(a, b))

scala> needSeq(Array("a","b"))
res2: (java.lang.String, Array[java.lang.String]) = (a,Array(a, b)) 
```

我想编写一个函数，它接受像needSeq 这样的函数并将它们应用于参数

```
scala> def useFunc[A, C <% Seq[A], R](col: C)(f: C => R) = { f(col) }
useFunc: [A, C, R](col: C)(f: C => R)(implicit evidence$1: C => Seq[A])R 
```

问题是因为参数列表中只提供了一种类型（C），所以没有来自 C => Seq[A] 的隐式视图可用

```
scala> useFunc(List(1,2,3))(needSeq)
<console>:10: error: No implicit view available from C => Seq[A].
              useFunc(List(1,2,3))(needSeq)
                                   ^ 
```

我应该如何编写useFunc？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T08:54:47.787

问题在于定义`needSeq`..
如果您可以尝试将其重构为..

```
def needSeq[A](col : Seq[A]) = (col.head , col) 
```

那么这两种情况都有效..

```
useFunc(List(1,2,3))(needSeq) //> res1: (Int, Seq[Int]) = (1,List(1, 2, 3))

useFunc(List(1,2,3))(x => needSeq(x)) //> res2: (Int, Seq[Int]) = (1,List(1, 2, 3)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T23:32:01.577

我认为@Eastsun 的解决方案

```
 useFunc(List(1,2,3))(x => needSeq(x)) 
```

有效，因为**C**来自

```
def useFunc[A, C <% Seq[A], R](col: C)(f: C => R) 
```

现在由**x**表示，并且 kind of*将*List 的类型与 needSeq 采用的参数类型连接起来

或者可以说上面的两条线更相似：

```
 def useFunc[A, C <% Seq[A], R]  (col: C)   (f: C => R)
     useFunc                  (List(1,2,3)) (x => needSeq(x)) 
```

# opencv - OpenCV 2.4.2 字节数组到 Mat 产生一个奇怪的图像模式

> ID：14783800
> 
> 赞同：0
> 
> 时间：2013-02-09T01:03:50.000
> 
> 标签：opencv, labview

下午好，

我正在尝试运行`OpenCV`并`DLL`在应用程序中使用它`LabVIEW`。

我已正确获取图像`LV`并将字节数组传递给`DLL`.

我可以在文本文件中循环并打印出每个像素的值，并将它们与 LV 中的输出相匹配，所以我知道我的所有像素都在正确的位置，除了 LV 在开头添加 2 列，与为高度和宽度保留的前 2 个值，其余为任意数字。但这一切应该做的是在图像的左侧产生一条条纹。

接下来，我使用以下几行来转换和显示图像。

`a[0]`, `a[1]`... 等是渠道。

输出图像是一个非常水平拉伸的图像，像素间隔相等 15-20 像素，并被黑色像素包围。我附上了截图

```
_declspec (dllexport)  double  imageProcess(int **a, int &x, int &y, int &cor,int &cog,int &cob,int &cow, int th, int hth)
{

    y = a[0][0];
    x = a[0][1];

    Mat image(y, x, CV_8U, a[0]);

    namedWindow( "Display window", CV_WINDOW_NORMAL );  // Create a window for display.
    imshow( "Display window", image );                 // Show our image inside it.

    return (0);
} 
```

此外，我尝试使用此代码具有相同的效果：

```
IplImage* cv_image = cvCreateImageHeader(cvSize(x,y), IPL_DEPTH_8U, 1);
cvSetData(cv_image, a[0], cv_image->widthStep);
Mat image = Mat(cv_image, false); 
```

谁能帮我解释为什么在我的图像创建过程中会发生这种情况？

请注意，不幸的是，我无法提供来自 LV 的原始图像/捕获，但我可以说它看起来不像那样，我正在处理灰度的所有内容。

输出图像：

![输出](../Images/42f6cebe7aee2d26a5c15080ddd23206.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T09:16:40.033

你的输入（ a ）是一个整数矩阵，而 opencv 想要 uchars 在那里。

您当前的操作方式，每个 int（来自 a）都分布在 4 个连续字节上，（这正是我在该图片中看到的）而且它仅使用输入数据的 1st 1/4

你可能不会仅仅将像素指针输入到你的 cv::Mat 那里，循环 a[0]，将每个像素投射到 uchar，然后将它分配给 opencv-pixel 应该可以工作，恕我直言

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T19:52:04.217

您可以通过将 CV_8U 替换为 CV_32S 来将图像转换为 uchar 或简单地使用 int 图像，然后：

```
int offset = 0;
int scale = 0;
cv::Mat image8U;
image.convertTo(image8U, CV_8UC1, scale, offset ); 
```

# encryption - 使用 Rsa 私钥/函数解密数据

> ID：14783805
> 
> 赞同：1
> 
> 时间：2013-02-09T01:04:40.643
> 
> 标签：encryption, cryptography, byte, rsa, crypto++

我只是想用 RSA 编码/解码数据（首先解码）。我不关心数据的类型（字符串、字节或其他 lolcat 编码的数据），我只是寻找一个非常简单的函数来完成这项工作（加密操作），剩下的事情我可以完成。

这是我尝试过的：

```
CryptoPP::InvertibleRSAFunction rsa;

rsa.SetModulus( n_factor );
rsa.SetPrivateExponent(d_private_exponent);

rsa.SetPrime1( rsa_params.at(p1) );
rsa.SetPrime2( rsa_params.at(p2) );

// All above inputs are correct. I don't have public exponent, but it's works in other languages (I comprared all inputs/outputs)

bool key_ok = rsa.Validate(CryptoPP::NullRNG(), 15);
/* Returns false, but doesn't tell me why :/ */

CryptoPP::Integer to_decode( my_data, size_of_my_data );
res = rsa.CalculateInverse(rg,to_decode); 
```

这将返回：

```
EXCEPTION : what():  CryptoMaterial: this object contains invalid values 
```

返回的错误码对应`"INVALID_DATA_FORMAT"`，可能不是按键问题，而是输入问题。

如果有人对这个库有一些经验，或者检测到一个“noob”错误（我从 4 小时开始就一直在考虑代码，所以这是可能的），任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T10:16:26.880

比我想象的要容易：

```
CryptoPP::Integer dec_data = a_exp_b_mod_c( enc_data, d_private_exponent, n_modulus ); 
```

所以'd'和'n'就足够了。我真的不明白为什么它不适用于加密功能。

# .htaccess - htaccess 将下划线重写为特定目录的破折号

> ID：14783807
> 
> 赞同：2
> 
> 时间：2013-02-09T01:05:12.193
> 
> 标签：.htaccess, mod-rewrite, seo

我可以使用以下内容成功地将下划线重写为破折号——但我需要代码仅适用于某个目录，并且我无法让该部分工作。

作品：

```
RewriteRule ^([^_]*)_([^_]*)_(.*)$ /$1-$2-$3 [R=301,L]
RewriteRule ^([^_]*)_(.*)$ /$1-$2 [R=301,L] 
```

不工作：

```
RewriteRule ^/media/entry/([^_]*)_([^_]*)_(.*)$ /media/entry/$1-$2-$3 [E=unscors:Yes]
RewriteRule ^/media/entry/([^_]*)_(.*)$ /media/entry/$1-$2 [E=unscors:Yes]
RewriteCond %{ENV:unscors} ^Yes$
RewriteRule ^/media/entry/(.*)$ http://domain.com/media/entry/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:59:51.117

当您`/`从`RewriteRule`模式中删除所有前导时，一切都应该可以正常工作（如前两个示例一样）。

以下代码：

```
RewriteRule ^media/entry/([^_]*)_([^_]*)_(.*)$ /media/entry/$1-$2-$3 [E=unscors:Yes]
RewriteRule ^media/entry/([^_]*)_(.*)$ /media/entry/$1-$2 [E=unscors:Yes]
RewriteCond %{ENV:unscors} ^Yes$
RewriteRule ^media/entry/(.*)$ http://domain.com/media/entry/$1 [R=301,L] 
```

还有一个不错的[在线 htaccess 测试器](http://htaccess.madewithlove.be/)，它可以帮助您验证您的配置，例如

![在线 htaccess 测试仪](../Images/7e53769db6a60eb8369ac3998fa50e1c.png)

该工具有一些限制，即目前没有实现某些功能，如`%{REQUEST_FILENAME}`或`%{ENV:...}`但对于简单的规则应该没问题。

我希望这会有所帮助。

# meteor - 用户更新时包含在 currentUser 中的内容重新渲染

> ID：14783809
> 
> 赞同：5
> 
> 时间：2013-02-09T01:05:24.237
> 
> 标签：meteor

我正在使用 Meteor 并且遇到了一个问题，即我的内容在我不想要的时候被重新渲染。

我将我的主要内容包裹在一个`currentUser`我认为相当标准的 if 语句中。

```
{{#if currentUser}}
  {{> content}}
{{/if}} 
```

这个问题是当我更新我的用户对象时我的内容模板被重新渲染。有没有办法解决？我不会在内容模板中的任何地方引用用户。

谢谢！

这是一个复制我的问题的示例应用程序：

**HTML**

```
<head>
  <title>Render Test</title>
</head>

<body>
  {{loginButtons}}

  {{> userUpdate}}

  {{#if currentUser}}
    {{> content}}
  {{/if}}
</body>

<template name="userUpdate">
  <p>
    <input id="updateUser" type="button" value="Update User Value" />
    User last update: <span id="lastUpdated">{{lastUpdated}}</span>
  </p>
</template>

<template name="content">
  <p>Render count: <span id="renderCount"></span></p>
</template> 
```

**JavaScript**

```
if (Meteor.isClient) {
  Meteor.startup(function() {
    Session.set("contentRenderedCount", 0);
  });

  Template.content.rendered = function() {
    var renderCount = Session.get("contentRenderedCount") + 1;
    Session.set("contentRenderedCount", renderCount);
    document.getElementById("renderCount").innerText = renderCount;
  };

  Template.userUpdate.events = {
    "click #updateUser": function() {
      Meteor.users.update({_id: Meteor.userId()}, {$set: {lastActive: new Date()}});
    }
  };

  Template.userUpdate.lastUpdated = function() {
    return Meteor.user().lastActive;
  };

}

if (Meteor.isServer) {
  Meteor.users.allow({
    'update': function () {
      return true; 
    }
  });
} 
```

**更新：** 我应该稍微解释一下这个例子。创建用户后，单击“更新用户值”按钮会导致渲染计数增加。这是因为它被包裹在一个`{{#if currentUser}}`. 如果将其删除，您会注意到渲染计数仍为 1。

此外，您需要将`accounts-ui`和`accounts-password`包添加到您的项目中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T02:34:01.053

Meteor 将重新渲染任何包含被改变的反应变量的模板。在您的情况下，`{{currentUser}}`它`Meteor.user()`是一个包含用户数据的对象。当您更新用户配置文件时，对象会发生变化，它会告诉流星重新计算涉及该对象的所有反应。

我们可以稍微改变一下反应性，让它只对用户是否登录/退出的变化做出反应，而不是对象本身的任何变化：

```
Meteor.autorun(function() {
    Session.set("meteor_loggedin",!!Meteor.user());
});

Handlebars.registerHelper('session',function(input){
    return Session.get(input);
}); 
```

你的 html

```
{{#if session "meteor_loggedin"}}
    {{> content}}
{{/if}} 
```

# paypal - 带有空 POST 的 PayPal 即时付款通知 IPN

> ID：14783811
> 
> 赞同：2
> 
> 时间：2013-02-09T01:05:38.550
> 
> 标签：paypal, paypal-ipn

我使用贝宝订阅（托管按钮）

```
auto-return for Website Payments is on
Payment Data Transfer is on
success, fail and notify url are different
extra params for button are:
rm=2
notify_url=<url>
sra=1
rest in PayPal is default. 
```

所有作品都在专业版和沙盒中

但是来自 IPN 的 POST 请求每次都带有空数据。

*   沙盒 IPN 有效。
*   请求处理没问题 - 用 curl 测试过。
*   paypal 上的 IPN 消息历史记录还可以。

我忘了什么吗？

请在您的 IPN 上确认或拒绝 PayPal 问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T16:51:17.110

我将 IPN 的编码设置为 UTF-8，现在可以使用

我的帐户 => 我的个人资料 => 我的销售工具 => 语言编码

# google-drive-api - 我如何知道用户何时关闭了 Google Drive Editor 会话？

> ID：14783812
> 
> 赞同：0
> 
> 时间：2013-02-09T01:05:51.250
> 
> 标签：google-drive-api, google-docs

我可以轮询[更改 api](https://developers.google.com/drive/v2/reference/changes/list)，但我永远不知道何时停止轮询。我目前依靠轮询javascript弹出窗口的关闭属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:04:48.163

抱歉，Drive SDK 无法做到这一点。Drive SDK 和 Drive 编辑器都是同一数据上的单独客户端，并没有像这样真正连接。

对不起。

# php - jQuery 正在注释掉我的 PHP 代码片段

> ID：14783813
> 
> 赞同：1
> 
> 时间：2013-02-09T01:05:56.483
> 
> 标签：php, jquery, code-snippets

我正在构建一个代码片段系统并使用 jQuery 来显示编辑器。我注意到 jQuery 喜欢注释掉任何内联 PHP 代码。有没有办法防止这种情况发生：

```
<textarea id='beep'></textarea> 
```

jQuery代码：

```
var code = "<div>Why <?php echo 'hello'; ?> there!</div>";
var parsed = $(code).html();
$('#beep').val(parsed); 
```

这是我想在 textarea 中看到的：

```
Why <?php echo 'hello'; ?> there! 
```

但是 jQuery 将其修改为如下所示：

```
Why <!--?php echo 'hello'; ?--> there! 
```

我知道这可能是一种安全措施，但有没有办法阻止这种情况发生？

我知道我可以使用 HTML 实体来解决这个问题，但由于这个工具的性质，它会干扰发布的有意包含 html 实体的代码片段。

JSFiddle：http: [//jsfiddle.net/YB4fD/1/](http://jsfiddle.net/YB4fD/1/)

**附加节点**：一些答案建议我在没有 jQuery 的情况下使用 JavaScript 来处理这个问题，但我需要 jQuery。我的字符串包含我正在使用 jQuery 解析的 DOM 树。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:01:20.393

尝试这个：

```
var code = "<div>Why &lt;?php echo 'hello'; ?&gt; there!</div>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:24:34.967

这可以解决问题。

```
var code = "Why <?php echo 'hello'; ?> there!";
document.getElementById('beep').appendChild(document.createTextNode(code)); 
```

在 textarea-element 中使用其他元素是无效的。

# regex - 最小化正则表达式的程序/计算器

> ID：14783814
> 
> 赞同：2
> 
> 时间：2013-02-09T01:05:59.363
> 
> 标签：regex, minimization

我只是想知道是否有任何免费软件能够有效地最小化正则表达式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T01:18:22.467

你看到这个问题被问了很多，但我在任何地方都没有看到一个有效的问题。如果您认为尽管逻辑只需要简化字符类中的字符范围之类的简单事物 - 并且做类似事情的价值相当低，我认为缺少这些开始是有道理的。

再举一个例子，当您不知道如何在替换字符串中使用不需要的分组时，如何删除它们。我认为任何可以实现的简化都是肤浅的。

这个人在 Haskell 中写了一篇但没有分享：http: [//community.haskell.org/~ndm/resimplify/](http://community.haskell.org/~ndm/resimplify/)

（PS：我有点撒谎 - 有一个有效的正则表达式简化工具......堆栈溢出的机械土耳其人:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:20:22.277

我想我在这里找到了一个：[http ://regexvisualizer.apphb.com/?Regex=%28a%2Bb%2Bc%2B%29%2B%7Cabc&NfaSize=300&DfaSize=250#](http://regexvisualizer.apphb.com/?Regex=%28a%2Bb%2Bc%2B%29%2B%7Cabc&NfaSize=300&DfaSize=250#)

# javascript - 从asp中的国家选择中填充状态下拉列表

> ID：14783815
> 
> 赞同：2
> 
> 时间：2013-02-09T01:05:58.993
> 
> 标签：javascript, asp-classic

我有一个旧的经典 asp 应用程序需要更新。我需要添加 2 个下拉列表，第二个需要根据第一个（例如国家和州）填充。你是如何使用javascript做到这一点的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T02:07:18.660

更新：根据您在下面的评论，我更新了我的回复以包含可以满足您需求的代码。您可以使用该`optgroup`元素根据选择的国家/地区进行过滤`options`，而无需使用 Ajax。

**第一种方式：（optgroup过滤）**

[jsFiddle 上的工作示例](http://jsfiddle.net/htmled/5STCN/)。

HTML：

```
<select id="C_Country" name="C_Country" aria-required="true" class="required">
    <option value="">-- Please Select --</option>
    <option value="USA">United States</option>
    <option value="CA">Canada</option>
</select>
<p>
    <label for="C_State_Prov">State or Province <span title="required">*</span>
    </label>
</p>
<select id="C_State_Prov" name="C_State_Prov" aria-required="true" class="required">
    <option value="" selected="">-- Please Select --</option>
    <optgroup label="United States">
        <option value="AK">Alaska</option>
        <option value="AL">Alabama</option>
        <option value="AR">Arkansas</option>
        <option value="AZ">Arizona</option>
        <option value="CA">California</option>
    </optgroup>
    <optgroup label="Canada">
        <option value="AB">Alberta</option>
        <option value="BC">British Columbia</option>
        <option value="MB">Manitoba</option>
    </optgroup>
</select> 
```

JavaScript：

```
var state_province = $('#C_State_Prov option, #C_State_Prov optgroup');

state_province.hide();

$('#C_Country').change(function () {
    state_province.hide();
    $("#C_State_Prov optgroup[label='" + $(this).find(':selected').html() + "']")
        .children()
        .andSelf()
        .show();
}); 
```

**第二种方式：（阿贾克斯）**

[jsFiddle 上的工作示例](http://jsfiddle.net/htmled/8RbtW/)。

这是如何完成此任务的粗略想法。jQuery 中定义的 URL 应指向服务器端代码将根据用户选择的国家/地区生成所需 HTML 的位置（而不是在 JavaScript 中定义为变量）。

HTML：

```
<form action="#">
    <div>
        <label for="country">Country:</label>
    </div>
    <div>
        <select name="country" id="country">
            <option value="">Please select</option>
            <option value="us">United States</option>
        </select>
    </div>
    <div id="stateContainer" class="hidden">
        <div>
            <label for="state">State</label>
        </div>
        <div>
            <select id="state" name="state"></select>
        </div>
    </div>
    <div>
        <input type="submit" id="submit" name="submit" value="Submit">
    </div>
</form> 
```

CSS：

```
.hidden {
    display: none;
} 
```

JavaScript：

```
var $country = $("#country"),
    $stateContainer = $("#stateContainer"),
    $state = $("#state"),
    url = "http://jsfiddle.net/htmled/KZ4jd/",
    html = '<option value="al">Alabama</option><option value="ar">Arkansas</option>',
    countryVal;

$country.change(function () {
    countryVal = $country.val();
    $stateContainer.show();
    $state.html(html).load(loadUrl);
}); 
```

# vba - 使用 ComboBox/UserForms 创建库存系统

> ID：14783816
> 
> 赞同：4
> 
> 时间：2013-02-09T01:06:07.303
> 
> 标签：vba, excel, combobox, userform

我正在尝试在我的工作中创建一个库存系统，作为我们唯一拥有的 Excel 软件。基本上我们有一个工作订单表，我们输入维修以及使用的零件。我制作了一个代码，可以将插入的零件编号和描述从各个工作订单中提取出来，以跟踪使用的所有内容，但我的老板希望我创建一个系统，允许我们开始输入某物的名称/零件编号，并且让它为我们猜测或填写。因此，组合框出现在哪里。

我让它工作到了一定程度。列表中填充了零件库存（我们有一个主 EXTNERAL 文件列表），但我的问题是：

当您单击用户表单的“添加部件”时，我无法弄清楚如何在工单上的某个范围内添加部件。我在[这里](http://www.contextures.com/Excel-VBA-ComboBox-Lists.html)和[这里](http://www.contextures.com/xlUserForm02.html)一直关注的所有教程仅设置为按列的顺序添加部件。任何人都可以看看我的（可怕的，我很抱歉）编码，看看他们是否能提供帮助？

```
Private Sub UserForm_Initialize()

Dim cPart As Range
Dim cNum As Range
Dim ws As Workbook
'Dim ComboBox1 As Variant

Application.ScreenUpdating = False
Set ws = Workbooks.Open("\\Capserver\iso maintenance\CAPS MASTER PARTS & PRICE LIST 2012.xls")
Windows("CAPS MASTER PARTS & PRICE LIST 2012.xls").Visible = False
'ws.Sheets("CAPS ORDER FORM").Range("Name") = Sheet1.ComboBox1

'ComboBox1.Clear
For Each cPart In ws.Sheets("CAPS ORDER FORM").Range("Name")
    With Me.cboPart
     .AddItem cPart.Value
    End With

Next cPart

For Each cNum In ws.Sheets("CAPS ORDER FORM").Range("Number")
    With Me.cboNum
     .AddItem cNum.Value
     .List(.ListCount - 1, 1) = cNum.Offset(0, 1).Value
    End With

Next cNum

End Sub

Private Sub cmdAdd_Click()
Dim lRow As Range
Dim lPart As Long
Dim ws As Worksheet
Dim something As Variant
Dim box As Object
Set ws = Worksheets("Sheet2")

With Worksheets(1).Range("A1:a500")
Set lRow = .Find(What:="", SearchOrder:=xlRows, SearchDirection:=xlNext, LookIn:=xlValues)
End With

'Set lRow = Range("A1")
'    If VBA.IsEmpty(lRow.Value) Then
'        MsgBox ("POOP!")
'    Else
'        Set box = lRow.End(xlDown)
'    End If

'lRow = Worksheets("Sheet2").Range("A33:A37")
'ws.Cells.Find(What:="*", SearchOrder:=xlRows,  (From tutorial, always returned lRow =     Nothing)
'    SearchDirection:=xlPrevious, LookIn:=xlValues).Row 1

lPart = Me.cboPart.ListIndex

'check for a part number
If Trim(Me.cboPart.Value) = "" Then
  Me.cboPart.SetFocus
  MsgBox "Please enter a part name or number"
  Exit Sub
End If

'copy the data to the database
'use protect and unprotect lines,
'     with your password
'     if worksheet is protected
With ws
'  .Unprotect Password:="password"
  .Cells(lRow, 1).Value = Me.cboPart.Value
  .Cells(lRow, 2).Value = Me.cboPart.List(lPart, 1)
  .Cells(lRow, 3).Value = Me.cboNum.Value
'  .Cells(lRow, 4).Value = Me.txtDate.Value
  .Cells(lRow, 5).Value = Me.txtQty.Value
'  .Protect Password:="password"
End With

'Combobox1.linkedcell=C4

'clear the data
Me.cboPart.Value = ""
Me.cboNum.Value = ""
Me.txtQty.Value = ""
Me.cboPart.SetFocus

End Sub

Private Sub cmdClose_Click()
  Unload Me
End Sub 
```

目标是能够单击“添加部件”按钮并添加多个文件并将其输出到工单（我认为部件的范围是 A33:A55 或类似的东西）

我还想知道是否有一种方法可以根据您输入的内容使部件名称和部件编号都依赖于用户窗体？虽然这是一个较低的优先级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T02:13:07.867

我仍然不是 100% 了解您要做什么，并且您可能会注释掉一些您可能想要使用的部分（即组合框）。您的 1row 范围正在寻找下一个我认为您不想做的空单元格。但至于如何将信息输入范围，您可能需要更改 ws With 语句：

```
 1row = 35 'or whatever row number
   For n =0 to CountOfItemsToAdd 'could also be done with a For Each statement
   'You will also need another for statement here to go through your part list
    With ws
     1row = 1row + (n*3)
     '  .Unprotect Password:="password" [you only need this if using passwords]
     .Cells(lRow, 1).Value = Me.cboPart.Value
     .Cells(lRow+1, 1).Value = Me.cboPart.List(lPart, 1)
     .Cells(lRow+2, 1).Value = Me.cboNum.Value
     '  .Cells(lRow, 4).Value = Me.txtDate.Value
     .Cells(lRow+3, 1).Value = Me.txtQty.Value
     '  .Protect Password:="pasword" 
```

但是为了解决您的具体问题，您可以更改 .Cells 引用中的第一个值，即行索引，而不是第二个数字，即列索引。

# delphi - 无尽的进度条？

> ID：14783823
> 
> 赞同：4
> 
> 时间：2013-02-09T01:07:33.917
> 
> 标签：delphi, progress-bar

我正在尝试使用 Indy 下载文件，但该文件由 PHP 脚本提供，因此它没有指定任何 Content-Length。因此我无法设置 Progressbar.Max。我看到 Windows 有一些不错的无穷无尽的进度条——Delphi 中有这样的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T01:09:00.840

设置为通用[`TProgressBar`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TProgressBar)控件的[`Style`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TProgressBar.Style)属性为[`pbstMarquee`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TProgressBar.Style)。

# cocoa - CALayer 没有使图层处于正确状态

> ID：14783827
> 
> 赞同：1
> 
> 时间：2013-02-09T01:08:12.387
> 
> 标签：cocoa, calayer, nsview, caanimation

在我的 Mac OS X 应用程序中，我正在尝试使用以下代码为 NSView 设置动画：

我创建了一个 CAAnimation：

```
myAnimation = [CABasicAnimation animationWithKeyPath:@"opacity"];
myAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
myAnimation.fromValue = [NSNumber numberWithFloat:1.0];
myAnimation.toValue = [NSNumber numberWithFloat:0.0];
myAnimation.duration = 3;
myAnimation.repeatCount = 1;
myAnimation.autoreverses = NO; 
```

然后我将它添加到我的“myContentView”NSView 层：

```
[self.myContentView.layer removeAllAnimations];
[self.myContentView.layer addAnimation:myAnimation forKey:@"opacity"];
self.myContentView.layer.opacity = 0; //Set final value of opacity to this value 
```

这实际上工作正常，除了每次我运行动画（通过鼠标单击触发）时，我首先使 NSView 的父窗口可见并将其 alphaValue 设置为 1，myContentView 在最后一个不透明度显示几分之一秒当我调用上面的代码并点击 removeAllAnimations 时它显示的值。

这就像presentationLayer 保留在缓存中并在动画开始之前重新显示。

如果我让动画完全完成（通过按住鼠标按钮更长时间直到它完全消失），那么下一次，一切都很好。只有当它在中途被 removeAllAnimations 打断时，它才似乎一直存在。

我尝试在每次调用之前将不透明度设置为 0 以使窗口可见，但这也失败了。我不知道为什么即使我中断动画，图层的不透明度也没有设置为 0。

有什么建议么？我做错了什么？

为了清楚起见，我自己并没有添加图层，只是将 NSView 设置为支持图层。

如果我将它设置为委托，我的 CAAnimation 永远不会在我的控制器上调用任何东西......这也很奇怪。我肯定做错了什么。

在 NSView 中绘制的内容是在它的 drawRect: 方法中以编程方式完成的，使用贝塞尔形状。

我找到了一个可行的解决方法。如果我在显示所述窗口之前从窗口的 contentView 中删除我的视图，并在之后将其添加回来，那么上一个动画的幽灵“似乎会以某种方式被刷新并且不会出现。

# java - 邻接表的Java实现

> ID：14783831
> 
> 赞同：2
> 
> 时间：2013-02-09T01:08:56.017
> 
> 标签：java, adjacency-list

我有一个 *m 矩阵，每个节点都有一个整数值，它是一个无向图。我想为它建立一个邻接列表。我怎么做？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-26T17:55:07.823

下面是一个创建邻接表的简单实现。根据问题：

将有 n 个链表，每个链表的大小都是可变的。

首先初始化一个整数链表的 ArrayList：

```
ArrayList<LinkedList<Integer>> adj_list = new ArrayList<LinkedList<Integer>>(); 
```

然后通过重复以下代码简单地添加链表：

```
adj_list.add(new LinkedList<Integer>()); 
```

如果你用它来表示图形，那么没有链表=没有顶点。所以你必须重复上面的行n（顶点数）次。

现在假设您想将数字 3,4,5 添加到您的第一个链接列表中。执行以下操作：

```
adj_list.get(0).add(3);
adj_list.get(0).add(4);
adj_list.get(0).add(5); 
```

它只是意味着您的图中从顶点 0 到 3、4、5 有一条边。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T02:00:38.850

首先，您的描述似乎是一个邻接矩阵，除非您说的是`m`by `n`。邻接矩阵总是方的，所以我们必须假设`m==n`。矩阵元素是边缘权重。

图的邻接表表示（通常）是一`adj`组对的数组。如果在表示的图中存在有向边，即从顶点到具有权重，则该集合`adj[i]`包含对。`<j, w>``i--w-->j``i``j``w`

有了这个定义，很明显你必须从`n`空的邻接集开始`adj[i]`，然后遍历矩阵元素`m[i][j] = w`。对于这些中的每一个，添加`<j, w>`到`adj[i]`.

这个java代码很简单，我就不写了。用邻接表表示的图的类型类似于`ArrayList<HashMap<Integer, Integer>> adjacencies`. 这些对是存储在哈希表中的`<j,w> in adj[i]`映射。创建这种邻接的代码将是. `j -> w``adjacencies.get(i)``adjacencies.get(i).put(j, w)`

`i`此方法允许您通过迭代哈希表中的键来迭代相邻的顶点`adjacencies.get(i)`，使用 查找给定边的权重`i--w-->j`，`w = adjacencies.get(i).get(j)`等等所有常见的图形操作。

# java - JOptionPane 和读取整数 - 初学者 Java

> ID：14783836
> 
> 赞同：1
> 
> 时间：2013-02-09T01:10:03.360
> 
> 标签：java, swing, joptionpane

我目前有读取用户在一行中输入的月份、日期和年份的代码（用空格分隔）。这是代码。

```
Scanner input = new Scanner(System.in);
int day = 0;
int month = 0;
int year = 0;

System.out.printf("enter the month, date, and year(a 2 numbered year). Put a space between the month, day, and year");
month = input.nextInt();
day = input.nextInt();
year = input.nextInt(); 
```

这很好，第二部分是显示一条消息，如果月*日==年，那么它是一个神奇的数字，如果不是，那么它不是一个神奇的数字。它必须显示在对话框中。这是我的代码，它工作得很好。

```
 if((day * month) == year)
  {
    String message = String.format("%s", "The date you entered is MAGIC!");//If the day * month equals the year, then it is a magic number
    JOptionPane.showMessageDialog(null, message);
  }
  if((day * month) != year)
  {  
    String message = String.format("%s", "The date you entered is NOT MAGIC!");//If the day * month does not equal the year, it is not a magic number
    JOptionPane.showMessageDialog(null, message);
  } 
```

我的问题是！！如何获得一个对话框，以在控制台中的工作方式在一行中输入月份、日期和年份。我在 DrJava 中工作，而我所在的书中的章节对我的特定用途没有帮助。任何帮助都会很棒。谢谢大家！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T01:47:49.633

有多种方法可以解决问题，具体取决于您最终想要实现的目标。

`JOptionPane`允许您`Object`作为消息提供。如果此消息是 a `String`，它将按原样呈现，但是，如果它是`Component`某种类型的，它将被简单地添加到对话框中。这使得`JOptionPane`一个非常强大的小 API。

![在此处输入图像描述](../Images/e786771f41dc35af4017897e201245b0.png)

```
public class TestOptionPane07 {

    public static void main(String[] args) {
        new TestOptionPane07();
    }

    public TestOptionPane07() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JTextField fldDay = new JTextField(3);
                JTextField fldMonth = new JTextField(3);
                JTextField fldYear = new JTextField(4);
                JPanel message = new JPanel();
                message.add(fldDay);
                message.add(new JLabel("/"));
                message.add(fldMonth);
                message.add(new JLabel("/"));
                message.add(fldYear);

                int result = JOptionPane.showConfirmDialog(null, message, "Enter Date", JOptionPane.OK_CANCEL_OPTION, JOptionPane.QUESTION_MESSAGE);
                if (result == JOptionPane.OK_OPTION) {
                    String sDay = fldDay.getText();
                    String sMonth = fldMonth.getText();
                    String sYear = fldYear.getText();
                    JOptionPane.showMessageDialog(null, "You enetered " + sDay + "/" + sMonth + "/" + sYear);

                    try {
                        int day = Integer.parseInt(sDay);
                        int month = Integer.parseInt(sMonth);
                        int year = Integer.parseInt(sYear);
                        JOptionPane.showMessageDialog(null, "You enetered " + day + "/" + month + "/" + year);
                    } catch (Exception e) {
                        JOptionPane.showMessageDialog(null, "The values you entered are invalid");
                    }
                }
            }
        });
    }
} 
```

**更新**

如果我要使用这样的东西，我还会使用[DocumentFilter](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html#filter)来确保用户只能输入有效值（[此处](http://www.jroller.com/dpmihai/entry/documentfilter)的示例）

但你也可以使用`JSpinners`

![在此处输入图像描述](../Images/f5827aa5b86b31615848dbd5d3a646c5.png)![在此处输入图像描述](../Images/5ca3acf3ccf1b57ddae59acc3f305f3f.png)

或者`JComboBox`

![在此处输入图像描述](../Images/1c4a088e5750c7b3a7d3a69a98ee653b.png)

取决于你想要达到什么...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T01:21:31.877

您可以利用以下内容获取用户输入

```
String word = JOptionPane.showInputDialog("Enter 3 int values");
String[] vals = word.split("\\s+"); // split the sting by whitespaces accepts regex. 
// vals[0] cast to int
// convert string representation of number into actual int value
int day = Integer.parseInt(vals[0]); // throws NumberFormatException
// vals[1] cast to int
// vals[2] cast to int 
```

[拆分 Java API](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)

[parseInt Java API](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#parseInt%28java.lang.String%29)

[Java 正则表达式教程](http://www.vogella.com/articles/JavaRegularExpressions/article.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T01:25:44.320

这是一些代码，所有内容都在注释中描述：

```
// import statements
import javax.swing.JOptionPane;
// main class
public class Main {
    // main method
    public static void main(String[] args) {
        // get info
        try {
            Info info = new Info();
        } catch(Exception e) {
            System.err.println("Error! " + e.getMessage());
        }
        // do whatever with the info
    }
    // info class
    static class Info {
        // instance variables
        public int day, month, year;
        // constructor
        public Info() throws Exception {
            // get inputs
            String[] inputs = JOptionPane.showInputDialog(null, 
                "Enter day, month, year").split(" ");
            // not the right size
            if(inputs.length != 3) {   
                throw new Exception("Not enough infomation was given!");
            }
            // get values
            day = Integer.parseInt(inputs[0]);
            month = Integer.parseInt(inputs[1]);
            year = Integer.parseInt(inputs[2]);
        }
    }
} 
```

如果出现问题，它会以一种优雅的方式通知您，并且您需要的所有内容都打包在一个方便的对象中。

# java - 是否可以在 Eclipse 中将子包设置为源 DISPLAY 的根？

> ID：14783845
> 
> 赞同：1
> 
> 时间：2013-02-09T01:10:44.853
> 
> 标签：java, eclipse, package-explorer

所以我有这个 Java 项目，我使用 Eclipse Indigo。

源包都以 AB 开头（不是真的，但你明白了），在 Eclipse 包资源管理器中，我看到：

*   一个
    *   乙
        *   包1
        *   包2

看到 AB 是没有意义的有没有办法，在分层模式下使用 Package Explorer，看不到 AB 而只看到这个：

*   包1
*   包2

首先十分感谢。似乎应该有办法，但我似乎找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:34:12.210

好吧，这不是很好，但事实证明我只是找到了一种方法。

定义一个工作集，其中 src、src/A 和 src/A/B 不是工作集的一部分。但是 src/A/B/package1 和 src/A/B/package2 是工作集的一部分。

在分层模式下，包资源管理器将树显示为：

*   AB
    *   包1
    *   包2

它并不完美（我仍然不想看到 AB），但它比我所拥有的要好——包前缀实际上是 4 段长。

但如果有人知道如何完全隐藏 AB，我很想听听。

# git - Git 文件超出了符号链接

> ID：14783847
> 
> 赞同：12
> 
> 时间：2013-02-09T01:11:07.060
> 
> 标签：git, symlink

我遇到了一个问题，Git 认为文件超出了符号链接，因此它不能受版本控制，但它似乎是一个真实文件。

```
[root@r1 h]# stat -f conf/core-site.xml 
  File: "conf/core-site.xml"
    ID: 5c7eb82882a6e866 Namelen: 255     Type: ext2/ext3
Block size: 4096       Fundamental block size: 4096
Blocks: Total: 2735511    Free: 510158     Available: 371202
Inodes: Total: 694960     Free: 597972 
```

此外，我尝试过“readlink”来显示链接指针，但无济于事。

Git如何确定文件是否为符号链接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-04-20T08:00:45.240

/项目/子项目/conf

如果您需要将 /conf 添加到主项目并为子项目添加符号链接，

01）从子项目中删除conf并添加到项目中，并提交更改。

*   cp /项目/子项目/conf /项目
*   rm /项目/子项目/conf
*   提交更改

02）然后添加符号链接并提交

*   cd /项目/子项目/
*   ln -s ../conf/conf
*   提交更改

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-16T09:29:22.567

如果路径中的任何目录或文件本身是符号链接，Git 会显示文件 /this/is/my/file 的消息。在您的情况下，该文件是真实的，但“conf”目录可能是一个符号链接。

解决方案：找到文件的正确路径并在真实文件上运行 git add

# google-chrome-extension - 单击按钮运行javascript

> ID：14783854
> 
> 赞同：0
> 
> 时间：2013-02-09T01:11:57.753
> 
> 标签：google-chrome-extension

我的最后一个问题因为不够清楚而被关闭。我将在这里详细分解它，以免发生这种情况。

我有包含 4 个按钮的 popup.html。当我单击图标时，我需要在任何给定页面上发生什么，popup.html 会弹出。然后我单击每个按钮，我需要为活动选项卡中该页面上的每个按钮运行特定的 javascript 代码。

我在 popup.html "http://cnn.com' onclick='alert("test");'>" 中尝试过这个只是为了尝试运行一个函数，但这不起作用。我还没有在本网站或谷歌开发示例中找到任何特定代码来完成此任务。

基本上，当“popup.html”页面上显示的按钮时，我需要这个 javascript 来运行“javascript:document.getElementById(%22forwardbutton%22).click();”。

或我的其他功能之一，例如“javascript：var auto = {名称：'0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9'，简介：'0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9'，密码：'秘密'，填充：函数（）{ var all_inputs = document.getElementsByTagName（'input'）; [...] next.click（）;“

我目前正在从书签菜单中的“书签”运行该代码，但想将其合并到打包的扩展中。

我希望这足够清楚。我遇到的主要问题是能够执行代码。一旦我能够单击一个按钮并在活动选项卡上执行一个“功能”，我将能够弄清楚其余部分。即使您可以将我指向一个足够接近的示例代码站点，它也会有很大帮助。很抱歉问这个问题，但我无法用我搜索过的资源来解决这个问题。

提前致谢！

* * *

编辑：这是我需要运行的函数，这是代码，但它不会运行。

```
document.addEventListener('DOMContentLoaded', function () {
var divs = document.getElementById('ADD');
divs.addEventListener('click', ADD);
});

function ADD(e) {
var auto = {
names: '0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9',
blurb: '0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9 1 2 3 4 5 6 7 8 9',
password: 'secret',
fillerup: function () {
    var all_inputs = document.getElementsByTagName('input');
    var all_selects = document.getElementsByTagName('select');
    var all_textareas = document.getElementsByTagName('textarea');
    var textflag = this.getRand(1);
    for (var i = 0, max = all_selects.length; i < max; i) {
        var sel = all_selects[i];
        if (sel.selectedIndex != -1 && sel.options[sel.selectedIndex].value) {
            continue;
        }
        var howmany = 1;
        if (sel.type == 'select-multiple') {
            var howmany = 1 this.getRand(sel.options.length - 1);
        }
        for (var j = 0; j < howmany; j) {
            var index = this.getRand(sel.options.length - 1);
            sel.options[index].selected = 'selected';
        }
    }
    for (var i = 0, max = all_textareas.length; i < max; i) {
        var ta = all_textareas[i];
        var flag = this.getRand(1);
        if (ta.value) {
            ta.value = "";
            continue;
        } else {
            ta.value = this.getRandomString(10)
            '\n\n'
            this.getRandomString(10);
        }
    }
    for (var i = 0, max = all_inputs.length; i < max; i) {
        var inp = all_inputs[i];
        var type = inp.getAttribute('type');
        var id = inp.getAttribute('id');
        if (!type) {
            type = 'text';
        }
        if (type == 'checkbox') {
            var flag = this.getRand(1);
            if (flag) {
                inp.setAttribute('checked', 'checked');
            } else {
                inp.removeAttribute('checked');
            }
        }
    }
    for (var i = 0, max = all_inputs.length; i < max; i) {
        var inp = all_inputs[i];
        var type = inp.getAttribute('type');
        var id = inp.getAttribute('id');
        var flag = this.getRand(1);
        if (type == 'text') {
            if (!flag) {
                inp.value = '';
                continue;
            }
            if (inp.name.indexOf('name') != -1) {
                inp.value = this.getRandomName()
                ' '
                this.getRandomName();
            } else if (inp.name.indexOf('email') != -1) {
                inp.value = this.getRandomString(1)
                '@example.org';
            } else {
                inp.value = this.getRandomString(1);
            }
        }
    }
    for (var i = 0, max = all_inputs.length; i < max; i) {
        var inp = all_inputs[i];
        var type = inp.getAttribute('type');
        var id = inp.getAttribute('id');
        var flag = this.getRand(1);
        if (type == 'radio') {
            var to_update = true;
            var name = inp.name;
            var input_array = inp.form.elements[inp.name];
            if (to_update) {
                var index = this.getRand(input_array.length - 1);
                input_array[index].setAttribute('checked', 'checked');
            }
        }
    }
},
getRandomString: function (how_many_words) {
    if (!how_many_words) {
        how_many_words = 2;
    }
    if (!this.words) {
        this.words = this.blurb.split(' ');
    }
    var retval = '';
    for (var i = 0; i < how_many_words; i) {
        retval = this.words[this.getRand(this.words.length) - 1];
        retval = (i < how_many_words - 1) ? ' ' : '';
    }
    return retval;
},
getRandomName: function () {
    if (!this.split_names) {
        this.split_names = this.names.split(' ');
    }
    return this.split_names[this.getRand(this.split_names.length) - 1];
},
getPassword: function () {
    if (!this.password) {
        this.password = 'secret';
    }
    return this.password;
},
getRand: function (count) {
    return Math.round(count * Math.random());
}
};
auto.fillerup();
var next = document.getElementById(forwardbutton);
next.click();
} 
```

# python - 我试图在两次之间循环，从 8:00 到 17:00 每 15 分钟

> ID：14783858
> 
> 赞同：8
> 
> 时间：2013-02-09T01:12:38.863
> 
> 标签：python, datetime, python-2.7

我试图在两次之间循环，从 8:00 到 17:00 每 15 分钟

预期的输出将是一个时间列表，例如

```
[8:00, 8:15, 8:30, 8:45, 9:00] 
```

这是到目前为止我得到的

```
now = datetime(2013, 2, 9, 8, 00)
end = now + timedelta(hours=9) 
```

但我不知道如何运行循环来返回我想要的列表。

感谢您的关注。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T01:18:42.953

你是这个意思？

```
>>> now = datetime(2013,2,9,8,0)
>>> end = now + timedelta(hours=9)
>>> while now <= end:
        print 'doing something at', now
        now += timedelta(minutes=15)

doing something at 2013-02-09 08:00:00
doing something at 2013-02-09 08:15:00
doing something at 2013-02-09 08:30:00
doing something at 2013-02-09 08:45:00
../.. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T01:29:56.203

这有效：

```
import datetime

now = datetime.datetime(2013, 2, 9, 8, 00)
end=now+datetime.timedelta(hours=9)

l=[]
while now<=end:
    l.append(now)
    now+=datetime.timedelta(minutes=15)

print [t.strftime("%H:%M") for t in l] 
```

印刷：

```
['08:00', '08:15', '08:30', '08:45', '09:00', '09:15', '09:30', '09:45', '10:00', '10:15', '10:30', '10:45', '11:00', '11:15', '11:30', '11:45', '12:00', '12:15', '12:30', '12:45', '13:00', '13:15', '13:30', '13:45', '14:00', '14:15', '14:30', '14:45', '15:00', '15:15', '15:30', '15:45', '16:00', '16:15', '16:30', '16:45', '17:00'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T02:45:20.720

如果您可以提前计算列表中的元素数量，则可以使用：

**输入：**

```
import datetime
now = datetime.datetime(2013, 2, 9, 8, 00)
print [(now + datetime.timedelta(minutes=15*n)).strftime('%H:%M') for n in range(37)] 
```

**输出：**

```
['08:00', '08:15', '08:30', '08:45', '09:00', '09:15', '09:30', '09:45', '10:00', '10:15', '10:30', '10:45', '11:00', '11:15', '11:30', '11:45', '12:00', '12:15', '12:30', '12:45', '13:00', '13:15', '13:30', '13:45', '14:00', '14:15', '14:30', '14:45', '15:00', '15:15', '15:30', '15:45', '16:00', '16:15', '16:30', '16:45', '17:00'] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-09T01:18:54.263

```
l=[]

while now<end:
    l.append(now)
    now+=timedelta(minutes=15) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-21T06:11:55.463

我会认真地给[Delorean](http://delorean.readthedocs.org/en/latest/quickstart.html#with-power-comes)一个认真的外观，做这样的事情就像 for 循环一样容易。

```
>>> import delorean
>>> from delorean import stops
>>> for stop in stops(freq=delorean.MINUTELY, count=4, start=d1, interval=15):
...     print stop.datetime
... 
2012-05-06 00:00:00+00:00
2012-05-06 00:15:00+00:00
2012-05-06 00:30:00+00:00
2012-05-06 00:45:00+00:00 
```

您还可以提供一个停止时间，这将是您问题的一个很好的例子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-09T03:13:42.503

```
import datetime as dt

def timerange (start, end, step):
    while start < end:
        yield start
        start += step

for x in timerange (dt.datetime (2013, 2, 9, 8), dt.datetime (2013, 2, 9, 17), dt.timedelta (minutes = 15) ):
        print (x) 
```

如果您需要更频繁地步进时间范围。

# rest - Sonatype Nexus REST Api 获取最新的构建版本

> ID：14783859
> 
> 赞同：20
> 
> 时间：2013-02-09T01:12:41.407
> 
> 标签：rest, build, repository, nexus, sonatype

如何使用 Sonatype REST Api 获取具有最高版本的构建（最新的临时构建）？

```
http://MY_REPOSITORY/nexus/service/local/lucene/search?a=ARTIFACT_NAME&v=ARTIFACT_VERSION 
```

传递构建版本作为`ARTIFACT_VERSION`作品。通过`v=LATEST`或`v=latest`不返回最新版本。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-10T15:50:39.867

没有记录 /service/local/lucene/search 支持“LATEST”作为版本参数 [ [link](https://repository.sonatype.org/nexus-indexer-lucene-plugin/default/docs/path__lucene_search.html) ] OSS rest api 文档指出`/service/local/artifact/maven`[ [link](https://oss.sonatype.org/nexus-restlet1x-plugin/default/docs/path__artifact_maven.html) ]（获取工件 pom 文件）和`/service/local/artifact/maven/content`[ [link](https://oss.sonatype.org/nexus-restlet1x-plugin/default/docs/path__artifact_maven_content.html) ]（获取实际文件内容）确实支持它：

> 工件的版本（必需）也支持解析“LATEST”、“RELEASE”和快照版本（“1.0-SNAPSHOT”）。

因此，我认为您应该使用其中之一（您还必须为它们提供 repositoryId 和 groupId），例如：

```
http://MY_REPOSITORY/nexus/service/local/artifact/maven/content?r=repoId&g=groupName&a=art&v=LATEST 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-05-08T11:52:24.350

我遇到了同样的问题，并使用 lucene search api 解决了这个问题：

```
if [[ "${REPO}" == "snapshots" ]]; then
  version=$( curl --silent "http://${HOST}/nexus/service/local/lucene/search?g=${GROUP_ID}&a=${ARTIFACT}" | sed -n 's|<latestSnapshot>\(.*\)</latestSnapshot>|\1|p' | sed -e 's/^[ \t]*//' | tail -1 )
else
  version=$( curl --silent "http://${HOST}/nexus/service/local/lucene/search?g=${GROUP_ID}&a=${ARTIFACT}" | sed -n 's|<latestRelease>\(.*\)</latestRelease>|\1|p' | sed -e 's/^[ \t]*//' | tail -1 )
fi

curl -o ~/${ARTIFACT}-${VERSION}.zip -L -#  "http://${HOST}/nexus/service/local/artifact/maven/redirect?r=${REPO}&g=${GROUP_ID}&a=${ARTIFACT}&e=zip&v=${VERSION}" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-24T23:39:20.117

Lucene 搜索 API 还允许关键字搜索版本：

```
http://<nexus_repository>/nexus/service/local/lucene/search?a=ARTIFACT_NAME&v=1.0.* 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-14T08:02:32.283

我有 Linux 操作系统，但无法访问 REST API，因此我使用以下命令从 Nexus 获取最新版本的快照：

示例快照来自 WSO2 存储库的 maven-metadata.xml：

```
$ curl -s "http://maven.wso2.org/nexus/content/repositories/snapshots/org/wso2/is/wso2is/maven-metadata.xml"
<?xml version="1.0" encoding="UTF-8"?>
<metadata>
  <groupId>org.wso2.is</groupId>
  <artifactId>wso2is</artifactId>
  <versioning>
    <latest>5.3.0-SNAPSHOT</latest>
    <release></release>
    <versions>
      <version>5.1.0-SNAPSHOT</version>
      <version>5.2.0-SNAPSHOT</version>
      <version>5.3.0-SNAPSHOT</version>
    </versions>
    <lastUpdated>20160914062755</lastUpdated>
  </versioning>
</metadata> 
```

从 maven-metadata.xml 中的最新 XML 标签中提取：

```
curl -s "http://maven.wso2.org/nexus/content/repositories/snapshots/org/wso2/is/wso2is/maven-metadata.xml" | \
grep "<latest>.*</latest>" | \
sed -e "s#\(.*\)\(<latest>\)\(.*\)\(</latest>\)\(.*\)#\3#g" 
```

从 maven-metadata.xml 中的版本 XML 标记中提取：

```
curl -s "http://maven.wso2.org/nexus/content/repositories/snapshots/org/wso2/is/wso2is/maven-metadata.xml" | \
grep "<version>.*</version>" | \
sort | uniq | tail -n1 | \
sed -e "s#\(.*\)\(<version>\)\(.*\)\(</version>\)\(.*\)#\3#g" 
```

直到今天 2016 年 9 月 14 日，这两个命令的结果是：

```
5.3.0-SNAPSHOT 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-11-02T10:50:13.663

在尝试使用该`LATEST`版本的 REST 服务（并发现[它并不总是有效](https://stackoverflow.com/a/25951599/4483113)`metadata.xml`）之后，我最终创建了这个用于解析文件的单行 Linux 命令：

```
wget -O - -o /dev/null https://repo1.maven.org/maven2/org/brutusin/wava/maven-metadata.xml | grep -Po '(?<=<version>)([0-9\.]+(-SNAPSHOT)?)' | sort --version-sort -r| head -n 1 
```

# context-free-grammar - CFG 到正则表达式

> ID：14783860
> 
> 赞同：1
> 
> 时间：2013-02-09T01:12:45.103
> 
> 标签：context-free-grammar, regular-language, automata

这里是语法，

`S -> A | B`

`A -> 0000A | epsilon`

`B -> 000B | epsilon`

我认为上面的正则表达式是

`0000(0000)*000(000)*` // 因为 0000 和 000 至少会被发现一次。

这个对吗 ？

有人说我，这个语法是模棱两可的。任何人都可以向我解释为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T09:14:04.503

在以下语法中（实际上是*Right liner grammar*）

```
S -> A | B

A -> 0000A | epsilon

B -> 000B | epsilon 
```

`S`您可以通过`A`或从起始变量生成字符串，`B`因此语法 L(G) 的语言是 Union ( `+`)，两种语言可以从`A`和生成`B`。

生产：

```
A -> 0000A | epsilon 
```

生成 `(0000)*`.

和

生产：

```
B -> 000B | epsilon 
```

生成 `(000)*`

所以 L(G) 的正则表达式是： `(000)*` `+` `(0000)*`

*注意*L(G) 可以有空字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:21:35.303

你的推理不正确。反例：空字符串在语言中，但您的正则表达式与它不匹配。

至于歧义，请考虑一串 12 个零。从该语法中可以得出多少种不同的方法？

# android - Android - 如何将 ImageView 与父母中心相关联？

> ID：14783862
> 
> 赞同：2
> 
> 时间：2013-02-09T01:12:50.123
> 
> 标签：android, imageview, center

这个问题很简单。我想放置一个 ImageView 使其与父母左侧和父母水平中心对齐。在不添加其他布局等的情况下这可能吗？

编辑：这是我想要的图像。并不是说 ImageView 应该与父母的水平中心对齐。ImageView 的高度并不重要。 ![在此处输入图像描述](../Images/caf157ff33ddcc8d54c6e61f184275c4.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:29:31.843

所以，我知道这是你不想要的，但这是获得你想要的东西的方式：

```
 <RelativeLayout
     android:layout_height="match_parent"
     android:layout_width="match_parent" />
     <View
         android:id="@+id/anchor"
         android:layout_width="0dp"
         android:layout_height="0dp"
         android:layout_centerHorizontal="true" />
     <ImageView
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_alignParentLeft="true"
         android:layout_toLeftOf="@+id/anchor" />
</RelativeLayout> 
```

* * *

预编辑：

我会专门将它放在具有以下属性的 RelativeLayout 中：

```
<ImageView
    android:layout_height="wrap_content"
    android:layout_width="wrap_content"
    android:layout_centerVertical="true"
    android:layout_alignParentLeft="true"
    ... whatever else you need /> 
```

我在这里假设您希望它垂直居中，因为不可能左对齐和水平居中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T01:20:14.727

这在很大程度上取决于您选择了哪种类型的父布局。

你能张贴一张你想要的样子吗？

将您的图像居中，您可以使用

```
android:layout_gravity="center" 
```

或者

```
android:layout_gravity="center_horizontal" 
```

此外，如果您有一个 RelativeLayout 作为父级，您可以将您的 ImageView 与附近的其他元素对齐：

```
android:layout_above="@id/neighbour"
android:layout_alignLeft="@id/who_to_align_left_with" 
```

依此类推，您拥有所有方向的属性。

这也可能有用

[Android 相对布局](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html)

编辑：

现在我想我明白你想要什么了；居中父母使用这个属性：

```
android:layout_gravity="center_horizontal" 
```

对于 ImageView 使用这个属性

```
android:layout_gravity="center|center_vertical" 
```

# python - 无法弄清楚如何使标志循环正常工作。不断收到语法错误。

> ID：14783868
> 
> 赞同：0
> 
> 时间：2013-02-09T01:14:00.867
> 
> 标签：python

我需要编写一个程序来创建随机数学问题。

每个问题应具有以下格式：

```
 <num> <op> <num>  = ? 
```

其中每个 num 代表一个介于 -50 和 50 之间的随机数，并且 op 是从四个基本数学运算符中随机选择的：+、-、/、*。

程序会将这个问题呈现给用户并等待答案。如果答案是正确的，程序应该祝贺用户并退出。如果答案不正确，程序应允许用户重试。用户将被允许继续尝试，直到给出正确答案。

每次编译代码时，我都会在“标志”处收到语法错误，但我不知道如何修复它。

```
 def main(): 

        import random
        from operator import add, sub, mul, div

        random.seed()

        ops = (add, sub, mul, div)
        op = random.choice(ops)

        num1 = random.randint(-50,50)
        num2 = random.randint(-50,50)    

        answer = op(num1, num2)

        print("Welcome! Here is your practice problem:\n")

        print(num1, op ,num2,"=?\n")

        guess = int(input("What is your answer?\n")

        flag = True

        while flag:
            guess = int(input("I’m sorry, that is not correct.  Please try again.\n"))

            if guess == answer:
                flag = False
        print("Congratulations! You have answered the problems correctly!\n)

    main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:18:22.177

你错过了一个近亲。

```
int(input("What is your answer?\n")) # < here 
```

我还建议将您的导入语句移到方法块之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T13:14:52.560

除了缺少的括号（由 Makoto 提到）之外，您还缺少以下引用：

```
print("Congratulations! You have answered the problems correctly!\n") 
```

此外，您可能想要`break`而不是使用标志，更好的做法是将导入放在函数声明之外，您需要`guess == answer`在进入循环之前测试 if，并且您想要打印`op.__name__`而不只是 op。

# javascript - 将十进制数转换为分数/有理数

> ID：14783869
> 
> 赞同：19
> 
> 时间：2013-02-09T01:14:08.433
> 
> 标签：javascript, decimal, fractions, rational-numbers

在 JavaScript 中，有没有办法将十进制数（例如`0.0002`）转换为表示为字符串的分数（例如 " `2/10000"`）？

如果`decimalToFraction`为此目的编写了一个被调用的函数，`decimalToFraction(0.0002)`则将返回字符串`"2/10000"`。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-09T01:28:43.607

您可以使用 Erik Garrison 的[fraction.js](https://github.com/ekg/fraction.js)库来执行此操作以及更多的分数运算。

```
var f = new Fraction(2, 10000);
console.log(f.numerator + '/' + f.denominator); 
```

* * *

要做 .003 你可以做

```
var f = new Fraction(.003);
console.log(f.numerator + '/' + f.denominator); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-09T01:27:29.497

[用“十进制到分数 js”这个术语进行](https://www.google.com/webhp?sourceid=chrome-instant&ion=1&ie=UTF-8#hl=en&tbo=d&spell=1&q=decimal+to+fraction+js&sa=X&ei=UKUVUePAA4iriQLvl4DgDA&ved=0CC8QvwUoAA&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&fp=f822b5a8d5b24453&biw=1707&bih=1342&ion=1)一点谷歌搜索，第一个产生了这个：

[http://wildreason.com/wildreason-blog/2010/javascript-convert-a-decimal-into-a-simplified-fraction/](http://web.archive.org/web/20130202141934/http://wildreason.com/wildreason-blog/2010/javascript-convert-a-decimal-into-a-simplified-fraction)

它似乎工作：

[http://jsfiddle.net/VKfHH/](http://jsfiddle.net/VKfHH/)

```
function HCF(u, v) { 
    var U = u, V = v
    while (true) {
        if (!(U%=V)) return V
        if (!(V%=U)) return U 
    } 
}
//convert a decimal into a fraction
function fraction(decimal){

    if(!decimal){
        decimal=this;
    }
    whole = String(decimal).split('.')[0];
    decimal = parseFloat("."+String(decimal).split('.')[1]);
    num = "1";
    for(z=0; z<String(decimal).length-2; z++){
        num += "0";
    }
    decimal = decimal*num;
    num = parseInt(num);
    for(z=2; z<decimal+1; z++){
        if(decimal%z==0 && num%z==0){
            decimal = decimal/z;
            num = num/z;
            z=2;
        }
    }
    //if format of fraction is xx/xxx
    if (decimal.toString().length == 2 && 
            num.toString().length == 3) {
                //reduce by removing trailing 0's
        decimal = Math.round(Math.round(decimal)/10);
        num = Math.round(Math.round(num)/10);
    }
    //if format of fraction is xx/xx
    else if (decimal.toString().length == 2 && 
            num.toString().length == 2) {
        decimal = Math.round(decimal/10);
        num = Math.round(num/10);
    }
    //get highest common factor to simplify
    var t = HCF(decimal, num);

    //return the fraction after simplifying it
    return ((whole==0)?"" : whole+" ")+decimal/t+"/"+num/t;
}

// Test it
alert(fraction(0.0002)); // "1/5000" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-04T02:25:41.970

我使用这个网站[http://mathforum.org/library/drmath/view/51886.html](http://mathforum.org/library/drmath/view/51886.html)来构建一个函数，但正如文章提到的，你会得到一个不合理的大量激进分子或 pi。

希望它有所帮助。

```
function Fraction(){}
Fraction.prototype.convert = function(x, improper)
{
    improper = improper || false;
    var abs = Math.abs(x);
    this.sign = x/abs;
    x = abs;
    var stack = 0;
    this.whole = !improper ? Math.floor(x) : 0;
    var fractional = !improper ? x-this.whole : abs;
    /*recursive function that transforms the fraction*/
    function recurs(x){
        stack++;
        var intgr = Math.floor(x); //get the integer part of the number
        var dec = (x - intgr); //get the decimal part of the number
        if(dec < 0.0019 || stack > 20) return [intgr,1]; //return the last integer you divided by
        var num = recurs(1/dec); //call the function again with the inverted decimal part
        return[intgr*num[0]+num[1],num[0]]
    }
    var t = recurs(fractional); 
    this.numerator = t[0];
    this.denominator = t[1];
}

Fraction.prototype.toString = function()
{
    var l  = this.sign.toString().length;
    var sign = l === 2 ? '-' : '';
    var whole = this.whole !== 0 ? this.sign*this.whole+' ': sign;
    return whole+this.numerator+'/'+this.denominator;
}

//var frac = new Fraction()
//frac.convert(2.56, false)
//console.log(frac.toString())
//use frac.convert(2.56,true) to get it as an improper fraction 
```

如果您只想要一个只返回分子和分母的自包含函数，请使用下面的函数。

```
var toFraction = function (dec) {
    var is_neg = dec < 0;
    dec = Math.abs(dec);
    var done = false;
    //you can adjust the epsilon to a larger number if you don't need very high precision
    var n1 = 0, d1 = 1, n2 = 1, d2 = 0, n = 0, q = dec, epsilon = 1e-13;
    while (!done) {
        n++;
        if (n > 10000) {
            done = true;
        }
        var a = parseInt(q);
        var num = n1 + a * n2;
        var den = d1 + a * d2;
        var e = (q - a);
        if (e < epsilon) {
            done = true;
        }
        q = 1 / e;
        n1 = n2;
        d1 = d2;
        n2 = num;
        d2 = den;
        if (Math.abs(num / den - dec) < epsilon || n > 30) {
            done = true;
        }
    }
    return [is_neg ? -num : num, den];
};
//Usage:
//var frac = toFraction(0.5);
//console.log(frac)
//Output: [ 1, 2 ] 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-28T20:32:21.327

非常老的问题，但也许有人会发现这很有用。它是迭代的，不是递归的，不需要分解

```
function getClosestFraction(value, tol) {
    var original_value = value;
    var iteration = 0;
    var denominator=1, last_d = 0, numerator;
    while (iteration < 20) {
        value = 1 / (value - Math.floor(value))
        var _d = denominator;
        denominator = Math.floor(denominator * value + last_d);
        last_d = _d;
        numerator = Math.ceil(original_value * denominator)

        if (Math.abs(numerator/denominator - original_value) < tol)
            break;
        iteration++;
    }
    return {numerator: numerator, denominator: denominator};
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-09T17:52:19.613

使用数字的字符串表示有一个非常简单的解决方案

```
 string = function(f){ // returns string representation of an object or number
        return f+"";
    }
    fPart = function(f){ // returns the fraction part (the part after the '.') of a number
        str = string(f);
        return str.indexOf(".")<0?"0":str.substring(str.indexOf(".") + 1);
    }
    wPart = function(f){ // returns the integer part (the part before the '.') of a number
        str = string(f);
        return str.indexOf(".")<0?str:str.substring(0, str.indexOf(".")); // possibility 1
        //return string(f - parseInt(fPart(f))); // just substract the fPart
    }

    power = function(base, exp){
        var tmp = base;
        while(exp>1){
            base*=tmp;
            --exp;
        }
        return base;
    }

    getFraction = function(f){ // the function
        var denominator = power(10, fPart(f).length), numerator = parseInt(fPart(f)) + parseInt(wPart(f))*denominator;
        return "[ " + numerator + ", " + denominator + "]";
    }

    console.log(getFraction(987.23)); 
```

它只会检查分数中有多少个数字，然后扩展 f/1 的分数，直到 f 是整数。这可能会导致分数很大，因此您可以通过将分子和分母都除以两者的最大公约数来减少它，例如

```
 // greatest common divisor brute force
    gcd = function(x,y){
        for(var i = Math.min(x, y);i>0;i--) if(!(x%i||y%i)) return i;
        return 1;
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-09T01:34:20.367

好消息是这是可能的，但您必须将其转换为代码。

让我们毫无理由地使用 2.56。

使用数字 .56 的小数部分

.56 有 2 位数字，把 .56 写成 56/100。

所以我们有 2 + 56/100 并且需要通过将分子和分母都除以[最大公约数](http://en.wikipedia.org/wiki/Greatest_common_divisor)（在这种情况下为 4）将这个分数减少到最低项。

因此，这个分数减少到最低项是 2 + 14/25。

要添加整个 2，我们乘以除数并添加到 14

(2*25 + 14)/25 = **64/25**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-11T11:05:31.537

尝试过这样的事情吗？

```
var cnum = 3.5,
  deno = 10000,
  neww;
neww = cnum * deno;
while (!(neww % 2 > 0) && !(deno % 2 > 0)) {
  neww = neww / 2;
  deno = deno / 2;
}
while (!(neww % 3 > 0) && !(deno % 3 > 0)) {
  neww = neww / 3;
  deno = deno / 3;
}
while (!(neww % 5 > 0) && !(deno % 5 > 0)) {
  neww = neww / 5;
  deno = deno / 5;
}
while (!(neww % 7 > 0) && !(deno % 7 > 0)) {
  neww = neww / 7;
  deno = deno / 7;
}
while (!(neww % 11 > 0) && !(deno % 11 > 0)) {
  neww = neww / 11;
  deno = deno / 11;
}
while (!(neww % 13 > 0) && !(deno % 13 > 0)) {
  neww = neww / 13;
  deno = deno / 13;
}
while (!(neww % 17 > 0) && !(deno % 17 > 0)) {
  neww = neww / 17;
  deno = deno / 17;
}
while (!(neww % 19 > 0) && !(deno % 19 > 0)) {
  neww = neww / 19;
  deno = deno / 19;
}
console.log(neww + "/" + deno);
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-08T17:18:49.990

我按照popnoodles的建议做了，就在这里

```
function FractionFormatter(value) {
  if (value == undefined || value == null || isNaN(value))
    return "";

  function _FractionFormatterHighestCommonFactor(u, v) {
      var U = u, V = v
      while (true) {
        if (!(U %= V)) return V
        if (!(V %= U)) return U
      }
  }

  var parts = value.toString().split('.');
  if (parts.length == 1)
    return parts;
  else if (parts.length == 2) {
    var wholeNum = parts[0];
    var decimal = parts[1];
    var denom = Math.pow(10, decimal.length);
    var factor = _FractionFormatterHighestCommonFactor(decimal, denom)
    return (wholeNum == '0' ? '' : (wholeNum + " ")) + (decimal / factor) + '/' + (denom / factor);
  } else {
    return "";
  }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-21T04:09:02.433

我只想要一个我发现的**将十进制数转换为分数**并**减少分数**的替代方法，它是一个 JS 库。

该库调用[fraction.js](https://github.com/ekg/fraction.js)，它对我非常有帮助，并为我节省了大量时间和工作。希望对其他人有用！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-10T01:40:44.560

这可能有点旧，但发布的代码在 0 值上失败我已修复该错误并将在下面发布更新的代码

```
//function to get highest common factor of two numbers (a fraction)
function HCF(u, v) { 
    var U = u, V = v
    while (true) {
        if (!(U%=V)) return V
        if (!(V%=U)) return U 
    } 
}
//convert a decimal into a fraction
function fraction(decimal){

    if(!decimal){
        decimal=this;
    }
    whole = String(decimal).split('.')[0];
    decimal = parseFloat("."+String(decimal).split('.')[1]);
    num = "1";
    for(z=0; z<String(decimal).length-2; z++){
        num += "0";
    }
    decimal = decimal*num;
    num = parseInt(num);
    for(z=2; z<decimal+1; z++){
        if(decimal%z==0 && num%z==0){
            decimal = decimal/z;
            num = num/z;
            z=2;
        }
    }
    //if format of fraction is xx/xxx
    if (decimal.toString().length == 2 && 
        num.toString().length == 3) {
            //reduce by removing trailing 0's
            // '
    decimal = Math.round(Math.round(decimal)/10);
    num = Math.round(Math.round(num)/10);
}
//if format of fraction is xx/xx
else if (decimal.toString().length == 2 && 
        num.toString().length == 2) {
    decimal = Math.round(decimal/10);
    num = Math.round(num/10);
}
//get highest common factor to simplify
var t = HCF(decimal, num);

//return the fraction after simplifying it

if(isNaN(whole) === true)
{
 whole = "0";
}

if(isNaN(decimal) === true)
{
    return ((whole==0)?"0" : whole);
}
else
{
    return ((whole==0)?"0 " : whole+" ")+decimal/t+"/"+num/t;
}
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-11-15T17:03:15.030

我知道这是一个老问题，但我创建了一个大大简化的函数。

```
Math.fraction=function(x){
return x?+x?x.toString().includes(".")?x.toString().replace(".","")/(function(a,b){return b?arguments.callee(b,a%b):a;})(x.toString().replace(".",""),"1"+"0".repeat(x.toString().split(".")[1].length))+"/"+("1"+"0".repeat(x.toString().split(".")[1].length))/(function(a,b){return b?arguments.callee(b,a%b):a;})(x.toString().replace(".",""),"1"+"0".repeat(x.toString().split(".")[1].length)):x+"/1":NaN:void 0;
} 
```

调用它`Math.fraction(2.56)`

它会：

*   如果输入不是数字，则返回 NaN
*   如果输入未定义，则返回未定义
*   减少分数
*   return a `string`（`Math.fraction(2.56).split("/")`用于包含分子和分母的数组）

请注意，这使用了 deprecated `arguments.callee`，因此在某些浏览器中可能不兼容。

[在这里](https://ayunami2000.github.io/?html=&css=&js=TWF0aC5mcmFjdGlvbj1mdW5jdGlvbih4KXsKcmV0dXJuIHg/K3g/eC50b1N0cmluZygpLmluY2x1ZGVzKCIuIik/eC50b1N0cmluZygpLnJlcGxhY2UoIi4iLCIiKS8oZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9hcmd1bWVudHMuY2FsbGVlKGIsYSViKTphO30pKHgudG9TdHJpbmcoKS5yZXBsYWNlKCIuIiwiIiksIjEiKyIwIi5yZXBlYXQoeC50b1N0cmluZygpLnNwbGl0KCIuIilbMV0ubGVuZ3RoKSkrIi8iKygiMSIrIjAiLnJlcGVhdCh4LnRvU3RyaW5nKCkuc3BsaXQoIi4iKVsxXS5sZW5ndGgpKS8oZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9hcmd1bWVudHMuY2FsbGVlKGIsYSViKTphO30pKHgudG9TdHJpbmcoKS5yZXBsYWNlKCIuIiwiIiksIjEiKyIwIi5yZXBlYXQoeC50b1N0cmluZygpLnNwbGl0KCIuIilbMV0ubGVuZ3RoKSk6eCsiLzEiOk5hTjp2b2lkIDA7Cn0KCmFsZXJ0KE1hdGguZnJhY3Rpb24od2luZG93LnByb21wdCgiZW50ZXIgZGVjaW1hbCIpKSk7&tab=3)测试

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-30T23:46:21.987

# ios - 无法发布 Facebook 状态 iOS Facebook SDK 3.0

> ID：14783871
> 
> 赞同：1
> 
> 时间：2013-02-09T01:14:40.003
> 
> 标签：ios, facebook, sdk, facebook-javascript-sdk, fbconnect

[我已经使用这个例子来实现 FaceBook SDK 3.0。](http://xcodenoobies.blogspot.nl/2012/09/how-to-upload-photo-and-update-status.html)唯一的区别是我使用导航控制器来弹出 Facebook Nib。

模拟器在下面的代码中得到一个 sigabrt。任何人都可以在代码中找到错误或其他东西吗？

if (alertView.tag==200) { // 发布状态

```
 [FBRequestConnection startForPostStatusUpdate:myStatus.text completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
            if (!error) {
                UIAlertView *tmp = [[UIAlertView alloc] 
                                    initWithTitle:@"Success" 
                                    message:@"Status Posted"
                                    delegate:self 
                                    cancelButtonTitle:nil
                                    otherButtonTitles:@"Ok", nil];

                [tmp show];
                [tmp release];
            } else {
                UIAlertView *tmp = [[UIAlertView alloc] 
                                    initWithTitle:@"Error" 
                                    message:@"Some error happened"
                                    delegate:self 
                                    cancelButtonTitle:nil
                                    otherButtonTitles:@"Ok", nil];

                [tmp show];
                [tmp release];
            }
        }];
    } 
```

这是整个方法：` -(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {

```
if (buttonIndex==1) { // yes answer
    if (alertView.tag==100) {
        // then upload
        [self controlStatusUsable:NO];
        [FBRequestConnection startForUploadPhoto:myImg.image 
                               completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
                                   if (!error) {
                                       UIAlertView *tmp = [[UIAlertView alloc] 
                                                           initWithTitle:@"Success" 
                                                           message:@"Photo Uploaded"
                                                           delegate:self 
                                                           cancelButtonTitle:nil
                                                           otherButtonTitles:@"Ok", nil];

                                       [tmp show];
                                       [tmp release];
                                   } else {
                                       UIAlertView *tmp = [[UIAlertView alloc] 
                                                           initWithTitle:@"Error" 
                                                           message:@"Some error happened"
                                                           delegate:self 
                                                           cancelButtonTitle:nil
                                                           otherButtonTitles:@"Ok", nil];

                                       [tmp show];
                                       [tmp release];
                                   }

                                   [self controlStatusUsable:YES];
                               }];

    }

    if (alertView.tag==200) {
        // the post status

        [FBRequestConnection startForPostStatusUpdate:myStatus.text completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
            if (!error) {
                UIAlertView *tmp = [[UIAlertView alloc] 
                                    initWithTitle:@"Success" 
                                    message:@"Status Posted"
                                    delegate:self 
                                    cancelButtonTitle:nil
                                    otherButtonTitles:@"Ok", nil];

                [tmp show];
                [tmp release];
            } else {
                UIAlertView *tmp = [[UIAlertView alloc] 
                                    initWithTitle:@"Error" 
                                    message:@"Some error happened"
                                    delegate:self 
                                    cancelButtonTitle:nil
                                    otherButtonTitles:@"Ok", nil];

                [tmp show];
                [tmp release];
            }
        }];
    }

} 
```

}`

# ruby - 使用 ruby mine 调试 Rails 应用程序

> ID：14783872
> 
> 赞同：5
> 
> 时间：2013-02-09T01:14:46.310
> 
> 标签：ruby, debugging, rubymine, ruby-1.8.7

我有一个使用 Ruby 1.8.7 的 Rails 应用程序，在调试模式下运行并设置断点时出现此错误：

```
54749: Exception in DebugThread loop: undefined method `errmsg' for #<Debugger::ControlState:0x10e3def28>
Backtrace:
/Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-0.10.4/cli/ruby-debug/command.rb:188:in `errmsg'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-0.10.4/cli/ruby-debug/commands/breakpoints.rb:81:in `execute'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide/ide_processor.rb:89:in `process_commands'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide/ide_processor.rb:86:in `catch'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide/ide_processor.rb:86:in `process_commands'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:121:in `start_control'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:103:in `initialize'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:103:in `new'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:103:in `start_control'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:65:in `start_server'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:69:in `prepare_debugger'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/lib/ruby-debug-ide.rb:83:in `debug_program'
  from: /Users/ohad/.rvm/gems/ruby-1.8.7-p371/gems/ruby-debug-ide-0.4.17.beta16/bin/rdebug-ide:109
  from: -e:1:in `load'
  from: -e:1 
```

我已将 ruby​​-debug 添加到我的 Gemfile 中：

```
group :development do
  gem "inaction_mailer", '0.6', :require => 'inaction_mailer/force_load'
  gem 'ruby-debug', :require => nil
  # gem 'bullet'
  # gem "ruby-growl"
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T01:52:05.790

您已`ruby-debug`安装 gem，将其删除。

看到[这个答案](https://stackoverflow.com/a/10325110/104891)，只需要 2 个调试 gem（Ruby 1.8 的版本会有所不同）：

```
ruby-debug-base (0.10.5.rc3)
ruby-debug-ide (0.4.17.beta16) 
```

# php - 上传多个文件导致上传 4 次同一个文件

> ID：14783873
> 
> 赞同：0
> 
> 时间：2013-02-09T01:14:58.090
> 
> 标签：php, javascript, css, ajax, fine-uploader

这段 javascript 代码广告被修改为上传的图片数量等于 4。这很好用，因为它总是下载 4 张图片，但它为所有图片带来相同的路径，女巫是四次相同的图片。注意我使用随机数生成器来确保图片是唯一的。

```
i=0;
    $(function(){
        var btnUpload=$('#upload');
        var status=$('#status');
        new AjaxUpload(btnUpload, {
            action: 'upload-file.php',
            name: 'uploadfile',
            onSubmit: function(file, ext){
                 if (! (ext && /^(jpg|png|jpeg|gif)$/.test(ext))){ 
                    // extension is not allowed 
                    status.text('Only JPG, PNG or GIF files are        allowed');
                return false;
            }
            else if(i>=4){addClass('error');}
            status.text('Uploading...');
        },
        onComplete: function(file, response){
            //On completion clear the status
            status.text('');
            //Add uploaded file to list
            if(response==="success"&&i<=3){
                $('<li></li>').appendTo('#files').html('<img src="./uploads/'+file+'" alt="" /><br />'+file).addClass('success');
            i++;} else{
                $('<li></li>').appendTo('#files').text(file).addClass('error');
            }
        }
    });

    }); 
```

处理所有下载的块是：

```
<?php
session_start();
if($_SESSION['upload-file'] == "AAA"){$_SESSION['upload-file']=0;}
$uploaddir = 'uploads/'; 
$random_digit = rand(0,1000000);
$file = $uploaddir.$random_digit.basename($_FILES['uploadfile']['name']);     
  if($_SESSION['upload-file'] == 0){$_SESSION['Photo1'] = $file;$_SESSION['upload-     file']++;}
  if($_SESSION['upload-file'] == 1){$_SESSION['Photo2'] = $file;$_SESSION['upload-file']++;}
  if($_SESSION['upload-file'] == 2){$_SESSION['Photo3'] = $file;$_SESSION['upload-file']++;} 
  if($_SESSION['upload-file'] == 3){$_SESSION['Photo4'] = $file;$_SESSION['upload-file']++;$_SESSION['upload-file']="AAA";}

if (move_uploaded_file($_FILES['uploadfile']['tmp_name'], $file)) { 
  echo "success"; 

} else {
    echo "error";
}

the variable $_SESSION['upload-file'] ='AAA'; is only to create a loop.
So the block up there goes into file end_temp_p.php and the second block is upload-file.php
This donwload 4 time the same file wich look like a paradox 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T12:42:18.803

我看不出是什么导致了您的问题，因为您提供的信息不充分。看起来您正在使用[AjaxUpload](https://github.com/valums/ajax-upload)，它已经很老了，不再受支持。如果我是正确的，请考虑升级到由同一作者[Fine Uploader](http://fineuploader.com)替换 AjaxUpload 的库。您可能会发现您的许多问题/疑问在升级后得到解决。

# c++ - C++ - 是否可以从模板中的成员函数类型中提取类和参数类型？

> ID：14783876
> 
> 赞同：8
> 
> 时间：2013-02-09T01:15:13.677
> 
> 标签：c++, templates, template-meta-programming, member-function-pointers

我想用模板类包装符合“void (ClassType::Function)(ArgType)”类型的成员函数。稍后，我想将 ClassType 的实例传递给此模板的实例并让它调用包装的方法：

```
class Foo {
 public:
  Foo() : f_(0.0) {}
  void set(double v) { f_ = v * 2.1; }
  double get() { return f_; }
 private:
  double f_;
};

template <typename ArgType, typename ClassType, void (ClassType::*Method)(ArgType)>
class Wrapper {
 public:
  explicit Wrapper(ClassType *cls) : cls_(cls) {}

  void do_something(ArgType value) {
    (cls_->*Method)(value);
  }

 private:
  ClassType *cls_;
};

#include <iostream>
int main(int argc, char ** argv) {
  Foo foo;
  Wrapper<double, Foo, &Foo::set> wrapper(&foo);

  wrapper.do_something(1.0);
  std::cout << foo.get() << std::endl;
  // outputs "2.1"
  return 0;
} 
```

*注意在 Wrapper<> 的实例化中“Foo”被指定了两次*——在这里看起来是多余的。

所以我想知道的是是否可以避免模板参数**ClassType**。例如，如果可以从成员函数指针参数中隐含或提取它，则不需要在 Wrapper<> 的实例化中显式指定它。

**以类似的方式，避免显式指定ArgType**也很有用，因为（也许）它可以从 Foo::set?

这在 C++ 中可能吗？也许沿着这些（完全幻想的）路线：

```
template <void (ClassType::*Method)(ArgType)>
class Wrapper2 {
 public:
  explicit Wrapper(Method::ClassType *cls) : cls_(cls) {}

  void do_something(Method::ArgType value) {
    (cls_->*Method)(value);
  }

 private:
  Method::ClassType *cls_;
};

// ...

int main() {
  Foo foo;
  Wrapper<&Foo::set> wrapper(&foo);
  // ...
} 
```

或者，也许可以调用另一个级别的模板魔术来执行以下操作：

```
Wrapper<Magic<&Foo::set> > wrapper(&foo); 
```

我很想知道可能有哪些机制可用（如果有的话）。

我要求使用 C++03，而不是 C++11，但我也想知道 C++11 可能提供什么。

编辑：更多信息 - 我打算使用这种机制来包装约 300 个成员函数（全部属于 ClassType，或一组非常相似的类），但只有大约六个左右的签名需要考虑：

*   void (ClassType::Function)(ArgType) - 其中 ArgType 是“浮动”
*   void (ClassType::Function)(ArgType) - 其中 ArgType 是“积分”
*   void (ClassType::Function)(bool)
*   void (ClassType::Function)(IndexType, ArgType) - 上面三个带有额外的“索引”参数

例如，成员函数是我在大型配置“集合”类中称为“属性”的“设置器”函数（而不是上面的简单 Foo）：

```
class MyPropertyCollection {
 public:
  void set_oink(double value) { oink_ = value; }
  void set_bar(int value) { bar_ = value; }
  void set_squee(bool value) { squee_ = value; }
 private:
  double oink_;
  int bar_;
  bool squee_;
};

// elsewhere
WrapperCollection wrapper_collection;  // a simple set of wrapper objects, accessed by id
MyPropertyCollection property_collection;
wrapper_collection.add(PROPERTY_OINK_ID, new Wrapper<double, MyPropertySet, &MyPropertySet::set_oink>(&property_collection);
wrapper_collection.add(PROPERTY_BAR_ID, new Wrapper<int, MyPropertySet, &MyPropertySet::set_bar>(&property_collection);
wrapper_collection.add(PROPERTY_SQUEE_ID, new Wrapper<bool, MyPropertySet, &MyPropertySet::set_squee>(&property_collection);
// +300 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-06T05:13:00.543

```
struct MyClass
{
    MyClass& Move(MyClass& m) { return *this; }
};

typedef MyClass& (MyClass::*MethodT) (MyClass&);

template< typename T >
struct ExtractType : std::false_type
{
};

template< typename R, typename C, typename A >
struct ExtractType< R (C::*)(A) >
{
    typedef C type;
};

static_assert( std::is_same< ExtractType< MethodT >::type, MyClass >::value, "oops" ); 
```

它似乎适用于我的 gcc 4.8 版本。
它就像我在评论中提到的那样工作，它是编译器在专业化检查期间执行的“反向模式匹配”。这是非常强大的。
所以你看，我们指定了某种模式，如果类型`T`尊重，编译器将把它分解成组成它的三个子类型：`R`, `C`, `A`。即返回类型、类类型和参数。

但是，您可以看到它适用于一个参数。当我们有未定义数量的参数时怎么办？
也许是检查器类的列表，或者使用可变参数模板？

老实说，我什至不确定这是否适用`void`。我认为 void 总是不可能放在模板中，因此它将导致这个`ExtractType`类的许多版本支持所有可能的声明组合。或者在我看来是这样。

编辑：

好的，所以我完全随机地放弃了这个，但在 C++11 中它似乎比我预期的要好得多，这在 gcc 4.8 上是可以的：

```
struct MyClass
{
};

typedef int (MyClass::*MethodT) (bool);
typedef void (MyClass::*VV) ();
typedef void (MyClass::*IL) (int, long);

template< typename T >
struct ExtractType : std::false_type
{
};

template< typename R, typename C, class...A >
struct ExtractType< R (C::*)(A...) >
{
    typedef C type;
    typedef R returntype;
};

static_assert( std::is_same< ExtractType< MethodT >::type, MyClass >::value, "oops" );
static_assert( std::is_same< ExtractType< VV >::type, MyClass >::value, "oops" );
static_assert( std::is_same< ExtractType< IL >::type, MyClass >::value, "oops" );

static_assert( std::is_same< ExtractType< MethodT >::returntype, int >::value, "oops" );
static_assert( std::is_same< ExtractType< VV >::returntype, void >::value, "oops" );
static_assert( std::is_same< ExtractType< IL >::returntype, void >::value, "oops" ); 
```

疯狂的部分是它不介意`void`返回类型。当然，它是 C++11。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-04T20:54:42.330

在 C++11 中，您可能会使用 lambda，例如：

> ```
> template <typename X, typename ARG>
> std::function<void(X*, ARG)> wrapper(void (X::*mfp)(ARG))
> {
>     return [=](X *x, ARG arg) {
>        (x->*mfp)(arg);
>     };
> } 
> ```

使用 VisualC++（至少与 VS2013 一样新），`[=]`在捕获成员函数指针（或遇到崩溃）时使用按值捕获。

操场：

> ```
> #include <iostream>
> #include <functional>
> 
> struct A {
>     virtual void a(int i) { std::cout << "A: " << i << std::endl; }
> };
> 
> struct B {
>     virtual void b(int i) { std::cout << "B: " << i << std::endl; }
> };
> 
> template <typename X, typename ARG>
> std::function<void(X*, ARG)> wrapper(void (X::*mfp)(ARG)) {
>     return [=](X *x, ARG arg) { (x->*mfp)(arg); };
> }
> 
> int main()
> {
>     auto g = wrapper(&B::b);
>     B b;
>     g(&b, 3);
>     auto h = wrapper(&A::a);
>     A a;
>     h(&a, 4);
>     return 0;
> } 
> ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T01:59:47.430

`::std::mem_fn`这是对+的糟糕重新实现`::std::bind`，它们是 C++11 构造。以下是您可以使用这些方法执行此操作的方法：

```
#include <functional>

int main() {
   Foo foo;
   auto wrapper = ::std::bind(::std::mem_fn(&Foo::set), ::std::ref(foo), _1);
   wrapper(5); // Calls foo.set(5)
} 
```

但是，当然，您需要 C++03 解决方案。使用 Boost 可以在 C++03 中实现这一点。我也相信在带有 TR1 的 C++03 中这样的事情是可能的。您可以通过查看是否`#include <tr1/functional>`有效来判断您是否拥有它。如果您有 TR1，它们会显示在`::std::tr1`命名空间中。

现在，有一种方法不是。您已将函数指针本身作为类的类型签名的一部分。这是一件很奇怪的事情，但正如你已经知道的那样，这肯定是可能的。但是，能够在编译时确定`ClassType`and`ArgType`值是很棘手的。您可以使用模板函数参数匹配来做到这一点，但没有用处，因为 C++03 没有`auto`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T02:39:03.910

阅读你所做的让我想到了几个选择：

1）在继承中包装实例化。这会将可怕的东西移到您的定义中。

> ```
> class FooWrapper : public Wrapper< double, Foo, &Foo::set >, public Foo
> {
> public:
>     FooWrapper() : Wrapper(this){}
> }; 
> ```

您的逻辑代码如下所示：

```
 FooWrapper fooWrapper;
  fooWrapper.do_something(1.0);
  std::cout << fooWrapper.get() << std::endl; 
```

这意味着您没有消除双模板参数，您只是移动了它们。

2）有一种更通用的方式来包装它，在一个级别：

```
 template<typename argType1, class classType1>
class FooWrapper2 : public Wrapper<argType1, classType1, &classType1::set>, public classType1
{
public:
    FooWrapper2()
        : classType1(),
          Wrapper<argType1, classType1, &classType1::set>(this)
    {

    }
}; 
```

这种方式具有看起来更复杂的逻辑的缺点，但是您不必每次都定义一个新的包装器，只需为每个签名定义一个新的包装器：

```
 FooWrapper2<double, Foo> fooWrapper2;
  fooWrapper2.do_something(1.0);
  std::cout << fooWrapper2.get() << std::endl; 
```

3）保持与模板思想一致，您可以包装包装器：

```
 template<typename argType1>
class FooWrapper3 : public FooWrapper2<argType1, Foo>
{
public:
    FooWrapper3()
    {

    }
}; 
```

这里的逻辑代码看起来好一点，但是您不得不为要包装的每种类型重新子类化（使用特定代码，而不仅仅是使用模板）：

```
 FooWrapper3<double> fooWrapper3;
  fooWrapper3.do_something(1.0);
  std::cout << fooWrapper3.get() << std::endl; 
```

4) 这个选项废弃了基础包装类并使用了一个接口。只需像传递包装器一样传递接口，就可以执行大多数操作。

```
template <typename ArgType>  
class Do_something {  
 public:  

  virtual void do_something(ArgType value) = 0;  

};  

template<typename ArgType>  
class FooWrapper4 : public Foo, public Do_something<ArgType>  
{  
public:  
    virtual void do_something(ArgType value)  
    {  
        set(1.0);  
    }  
}; 
```

我玩的测试程序：

```
class Foo {
 public:
  Foo() : f_(0.0) {}
  void set(double v) { f_ = v * 2.1; }
  double get() { return f_; }
 private:
  double f_;
};

template <typename ArgType, typename ClassType, void (ClassType::*Method)(ArgType)>
class Wrapper {
 public:
  explicit Wrapper(ClassType *cls) : cls_(cls) {}

  void do_something(ArgType value) {
    (cls_->*Method)(value);
  }

 private:
  ClassType *cls_;
};

class FooWrapper : public Wrapper< double, Foo, &Foo::set >, public Foo
{
public:
    FooWrapper() : Wrapper(this){}
};

template<typename argType1, class classType1>
class FooWrapper2 : public Wrapper<argType1, classType1, &classType1::set>, public classType1
{
public:
    FooWrapper2()
        : classType1(),
          Wrapper<argType1, classType1, &classType1::set>(this)
    {

    }
};

template<typename argType1>
class FooWrapper3 : public FooWrapper2<argType1, Foo>
{
public:
    FooWrapper3()
    {

    }
};

template <typename ArgType>
class Do_something {
 public:

  virtual void do_something(ArgType value) = 0;

};

template<typename ArgType>
class FooWrapper4 : public Foo, public Do_something<ArgType>
{
public:
    virtual void do_something(ArgType value)
    {
        set(1.0);
    }
};

#include <iostream>
int main(int argc, char ** argv) {
  Foo foo;
  Wrapper<double, Foo, &Foo::set> wrapper(&foo);

  wrapper.do_something(1.0);
  std::cout << foo.get() << std::endl;

  FooWrapper fooWrapper;
  fooWrapper.do_something(1.0);
  std::cout << fooWrapper.get() << std::endl;
  // outputs "2.1"

  FooWrapper2<double, Foo> fooWrapper2;
  fooWrapper2.do_something(1.0);
  std::cout << fooWrapper2.get() << std::endl;

  FooWrapper3<double> fooWrapper3;
  fooWrapper3.do_something(1.0);
  std::cout << fooWrapper3.get() << std::endl;

  FooWrapper4<double> fooWrapper4;
  fooWrapper4.do_something(1.0);
  std::cout << fooWrapper4.get() << std::endl;

  return 0;
} 
```

# windows-7 - 当我在 Windows 7 命令行上使用 `Vagrant Up` 时，为什么 Vagrant ssh 不会进入我的虚拟盒子？

> ID：14783878
> 
> 赞同：6
> 
> 时间：2013-02-09T01:15:30.273
> 
> 标签：windows-7, ssh, virtualbox, puppet, vagrant

每当我尝试 Vagrant Up 时，它都会加载盒子并正确完成大部分工作，但是因为我正在尝试使用 Puppet 来配置这个 CentOS 6.3，所以我需要 SSH 在 Vagrant Up 期间工作（如果我希望它尽可能自主） .

我从 Vagrant 的 INFO 日志中得到以下信息：

```
DEBUG virtualbox_4_2:   - [1, "ssh", 2222, 22]
 INFO ssh: Connecting to SSH: 127.0.0.1:2222
 INFO ssh: SSH not up: #<Timeout::Error: execution expired>
 INFO subprocess: Starting process: ["C:\\Program Files\\Oracle\\VirtualBox\\VBoxManage.exe", "showvminfo", "c2e7375d-159f-4014-9bda-ff9914423f4c", "--machinereadable"]
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: name="Vagrant-Apache-Nick_1360372174" 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-09T01:16:45.157

在`Vagrant Up`您的 Windows 系统尝试连接到 SSH 期间。如果您在命令行中键入：

```
set VAGRANT_LOG=INFO 
```

您可能会看到它失败并尝试几次。它看起来像这样：

```
INFO ssh: Connecting to SSH: 127.0.0.1:2222 
```

发生这种情况是因为超时设置为 10。这可以通过在 Vagrantfile 中放置以下内容来修改：

```
config.ssh.timeout = 300 
```

您可以使用任何您喜欢的数字，但我建议您使用 100 以上的数字。

资料来源：

1.  [这家伙有一些有用的故障排除信息。](http://devops.me/2011/10/10/vagrant-tricks-and-troubleshooting/)
2.  [Vagrantfiles 的 Vagrant 文档](http://docs.vagrantup.com/v1/docs/config/ssh/timeout.html)
3.  [Vagrantfile SSH 超时的 Vagrant 文档](http://docs.vagrantup.com/v1/docs/config/ssh/timeout.html)
4.  [用于调试的 Vagrant Docs](http://docs.vagrantup.com/v1/docs/debugging.html)
5.  [故障排除时间（保持微笑）](http://i.imgur.com/spyALqO.gif)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-08T20:49:34.523

我知道我写这篇文章已经很晚了，但是在我简单地从 Windows 中删除 Hyper-V 并神奇地解决了我的问题之前，我确实有一整天几乎完全相同的问题。

我想当我使用 Docker for Windows 进行测试时（不要与 docker-machine 混淆）它以某种方式弄乱了我的 Hyper-V。不是 100% 确定为什么这个调整解决了这个问题，但是在 Docker for Windows 似乎对我的 VirtualBox 感到厌烦之后它就像一个魅力（Docker for Windows 和 Local by FlyWheel / VirtualBox 相互冲突）。

[![在此处输入图像描述](../Images/ea16732c0469c8e0cac49d743cee675f.png)](https://i.stack.imgur.com/xvE4D.png)

希望这可以帮助某人！

# php - 如何将while循环中的数据拼接到PHP中的多维数组中？

> ID：14783879
> 
> 赞同：0
> 
> 时间：2013-02-09T01:15:33.423
> 
> 标签：php, multidimensional-array

我需要将数据添加到多维数组中的每个数组。到目前为止，这是我的代码：

```
<?php 
//Arrays
$rsIdeas_array = array();

//Query Database
mysql_select_db($database_connFormula, $connFormula);
$query_rsIdeas = "SELECT * FROM ideas";
$rsIdeas = mysql_query($query_rsIdeas, $connFormula) or die(mysql_error());
$row_rsIdeas = mysql_fetch_assoc($rsIdeas);
$totalRows_rsIdeas = mysql_num_rows($rsIdeas);

//loop bizideas into array
do {
$calculated = ($row_rsIdeas['monthlysearches'] * 9);
array_push($rsIdeas_array, $row_rsIdeas);
array_splice($rsIdeas_array, 7, 0, $calculated);
} while ($row_rsIdeas = mysql_fetch_assoc($rsIdeas));

print_r($rsIdeas_array); 
```

这是我得到的：

```
Array
(
[0] => Array
    (
        [ideaID] => 1
        [userID] => 1
        [bizidea] => Business Idea 1
        [bizexplained] => Business Idea 1 Explanation
        [bizmodel] => Utility
        [repkeyword] => Keyword 1
        [monthlysearches] => 33100
        [advcomp] => 0.95
        [startease] => 6
    )

[1] => 297900
[2] => Array
    (
        [ideaID] => 2
        [userID] => 1
        [bizidea] => Business Idea 2
        [bizexplained] => Business Idea 2 Explained
        [bizmodel] => Service
        [repkeyword] => Keyword 2
        [monthlysearches] => 6600
        [advcomp] => 0.93
        [startease] => 8
    )

[3] => 59400

) 
```

但是，我需要的是每个先前创建的数组都包含计算值，如下所示：

```
Array
(
[0] => Array
    (
        [ideaID] => 1
        [userID] => 1
        [bizidea] => Business Idea 1
        [bizexplained] => Business Idea 1 Explanation
        [bizmodel] => Utility
        [repkeyword] => Keyword 1
        [monthlysearches] => 33100
        [calculated] => 297900 //Here is where I need the calculated values
        [advcomp] => 0.95
        [startease] => 6
    )

[1] => Array
    (
        [ideaID] => 2
        [userID] => 1
        [bizidea] => Business Idea 2
        [bizexplained] => Business Idea 2 Explained
        [bizmodel] => Service
        [repkeyword] => Keyword 2
        [monthlysearches] => 6600
        [calculated] => 59400 //Here is where I need the calculated values
        [advcomp] => 0.93
        [startease] => 8
    )
) 
```

我哪里错了？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:21:52.763

你不需要做任何拼接。

```
do {
  $row_rsIdeas['calculated'] = ($row_rsIdeas['monthlysearches'] * 9);
  array_push($rsIdeas_array, $row_rsIdeas);
} while ($row_rsIdeas = mysql_fetch_assoc($rsIdeas)); 
```

是的，就是这么简单。

- 编辑 -

如果您绝对必须按特定顺序排列列，则可以执行以下操作：

```
$row_rsIdeas['calculated'] = ($row_rsIdeas['monthlysearches'] * 9);
$row_rsIdeas = array(
  'ideaID' => $row_rsIdeas['ideaId'],
  'userID' => $row_rsIdeas['userId'],
  'bizidea' => $row_rsIdeas['bizidea'],
  // and so on
);
array_push($rsIdeas_array, $row_rsIdeas); 
```

或者

```
$row_rsIdeas['calculated'] = ($row_rsIdeas['monthlysearches'] * 9);
uksort($row_rsIdeas, function($col1, $col2)) {
   $cols = array('ideaID' => 0, 'userID' => 1, 'bizidea' => 2, ...); //etc
   return ($cols[$col1] > $cols[$col2]);  // this might be backwards, trying reversing
}
array_push($rsIdeas_array, $row_rsIdeas); 
```

# django - 缩进错误消息 Django

> ID：14783880
> 
> 赞同：0
> 
> 时间：2013-02-09T01:16:02.623
> 
> 标签：django, indentation

我正在使用 Django 1.4.2 并收到以下错误消息：

![在此处输入图像描述](../Images/c6ff5724aabdbf78726bb0c516c5a143.png)有人能告诉我哪些文件有缩进问题吗？我试过 `python -m tabnanny -v manage.py`了，我得到了“干净的健康单”，所以我认为那个文件没问题。而且我以前从未接触过其他两个文件。

我在 Vista 上使用 Python 2.7.2 和 Django 1.4.2。

这是整个 importlibs.py：

```
def _resolve_name(name, package, level):
"""Return the absolute name of the module to be imported."""
if not hasattr(package, 'rindex'):
    raise ValueError("'package' not set to a string")
dot = len(package)
for x in xrange(level, 1, -1):
    try:
        dot = package.rindex('.', 0, dot)
    except ValueError:
        raise ValueError("attempted relative import beyond top-level "
                          "package")
return "%s.%s" % (package[:dot], name)

def import_module(name, package=None):
"""Import a module.

The 'package' argument is required when performing a relative import. It
specifies the package to use as the anchor point from which to resolve the
relative import to an absolute import.

"""
if name.startswith('.'):
    if not package:
        raise TypeError("relative imports require the 'package' argument")
    level = 0
    for character in name:
        if character != '.':
            break
        level += 1
    name = _resolve_name(name[level:], package, level)
__import__(name) # LINE 35
return sys.modules[name] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T06:44:41.190

在 Django 中使用选项卡是一种不好的做法。为了解决您的问题，您必须只使用空格，我认为是 4 个空格。尝试退格您的代码，您会看到它是制表符缩进，仅使用空格。

# php - 如何转义文件名中不需要的字符

> ID：14783889
> 
> 赞同：0
> 
> 时间：2013-02-09T01:16:55.510
> 
> 标签：php, javascript, jquery, html

尝试使用 jplayer 播放音频文件时，出现此错误：

```
"NetworkError: 404 Not Found - http://.../AudioFiles/Thorne,%20Grandma%27s%20Goodbye%20excerpt_4.m4a" 
```

现在这是我拥有的唯一一个带有此错误的音频文件，我假设这是因为文件名在文件名中有一个单引号，因为它被称为`Thorne, Grandma's Goodbye excerpt.m4a`.

我的问题是如何转义音频文件名中不需要的字符？

下面是代码：

```
$getaudio = 'AudioFiles/' . $_GET['filename'];

$info = pathinfo($dbAudioFile); 

    <script type="text/javascript">   
        $(document).ready(function(){
      $("#jquery_jplayer_1").jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", {
            <?php echo $info['extension'];?>: "<?php echo $dbAudioFile; ?>"
          });
        },
        solution:"flash,html",
        swfPath: "jquery",
        supplied: "<?php echo $info['extension'];?>"
      });
    }); 
    </script> 
```

`$dbAudioFile`是文件名

# grep - 带通配符的 grep

> ID：14783890
> 
> 赞同：4
> 
> 时间：2013-02-09T01:17:03.387
> 
> 标签：grep, wildcard

我想 grep 文件中的以下字符串：

```
directory1
directory2
directory3 
```

有没有办法用grep同时grep所有3个？

例如：

```
cat file.txt | grep directory[1-3] 
```

不幸的是，以上不起作用

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T01:18:35.807

如果这些是您需要搜索的唯一字符串，请使用`-F`（grep for fixed strings）：

```
grep -F "directory1
directory2
directory3" file.txt 
```

如果您想使用更高级的正则表达式进行 grep，请使用`-E`（使用扩展的正则表达式）：

```
grep -E 'directory[1-3]' file.txt 
```

请注意，某些`grep`s（如 GNU grep）不需要`-E`此示例即可工作。

最后，请注意您需要引用正则表达式。如果你不这样做，你的 shell 可能会首先根据路径名扩展来扩展正则表达式（例如，如果你在当前目录中有一个名为“directory1”的文件/目录，`grep directory[1-3]`将由`grep directory1`你的 shell 转换）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:53:22.197

你在哪个shell下测试过？

这里

`grep directory[1-3]` works for bash, doesn't work under zsh

you can either quote `"directory[1-3]"`

or escape `grep directory\[1-3\]`

```
bash v4.2
zsh v5.0.2
grep (GNUgrep 2.14) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-01T19:52:50.830

It's not very pretty but you can chain the grep together:

```
grep -l "directory1" ./*.txt|xargs grep -l "directory2"|xargs grep -l "directory3" 
```

Limit your input so to improve performance, for example use find:

```
find ./*.txt -type f |xargs grep -l "directory1"|xargs grep -l "directory2"|xargs grep -l "directory3" 
```

# symfony - 使用 Symfony2 和 Propel 进行验证

> ID：14783900
> 
> 赞同：0
> 
> 时间：2013-02-09T01:18:31.190
> 
> 标签：symfony, propel

我最近开始使用 symfony2 和推进一个项目。这不是一帆风顺的，但它会顺利进行。

几天前，我被表单验证卡住了。我的 validation.yml 定义如下：

```
Project\MainBundle\Model\User:
    properties:
        first_name:
            - NotBlank: { message: "Please add the user's first name." }
        last_name:
            - NotBlank: { message: "Please add the user's last name." }
        email: 
            - NotBlank: { message: "Please add the user's email address." }
            - Email: { message: "Please use a valid email address." }
        password: 
            - NotBlank: { message: "Please add the user's email address." } 
```

当我提交表单时，一切正常，除了表单提交时包含空白的 first_name 和 last_name。我在调试后发现，问题不在于验证，而在于两个字段的错误呈现。密码和电子邮件错误呈现正常。这是我设置表单的方式。

```
 $builder->add('firstName', 'text');
    $builder->add('lastName', 'text');
    $builder->add('email', 'text');
    $builder->add('password', 'password'); 
```

我可以更改我在表单构建器上命名我的字段的方式，但同时我想遵循 symfony2 的命名约定（并且我的数据库命名约定保持不变），所以我选择这个作为最后的手段。

我希望我清楚地解释了我的问题。任何人都可以为我提供解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-10T03:56:54.753

您可以通过 getter 进行验证。 [http://symfony.com/doc/current/validation.html#getters](http://symfony.com/doc/current/validation.html#getters)

```
Project\MainBundle\Model\User:
    getter:
        firstName:
            - NotBlank: { message: "Please add the user's first name." }
        lastName:
            - NotBlank: { message: "Please add the user's last name." }
        email: 
            - NotBlank: { message: "Please add the user's email address." }
            - Email: { message: "Please use a valid email address." }
        password: 
            - NotBlank: { message: "Please add the user's email address." } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:33:38.683

您的问题可能来自您似乎不尊重 YAML 语法这一事实。

```
Project\MainBundle\Model\User:
    properties:
        first_name:
            - NotBlank: { message: Please add the user's first name. }
        last_name:
            - NotBlank: { message: "Please add the user's last name. }
        email: 
            - NotBlank: { message: Please add the user's email address. }
            - Email: { message: Please use a valid email address. }
        password: 
            - NotBlank: { message: Please add the user's email address.} 
```

可以参考：[http ://symfony.com/doc/current/book/validation.html](http://symfony.com/doc/current/book/validation.html)

# jquery - jquery snap 可拖动到包装器

> ID：14783905
> 
> 赞同：2
> 
> 时间：2013-02-09T01:18:51.550
> 
> 标签：jquery, jquery-ui, draggable, jquery-ui-draggable

我水平拖动一个大于浏览器的 div，但希望它在到达左右末端时捕捉到包装器。我不能用“包含”来做到这一点，因为当拖动的 div 大于其包含时，拖动无法正常工作：

```
$( "#dragable" ).draggable({ cursor: "e-resize", axis: "x", containment: "document" }); 
```

[http://jsfiddle.net/xBVYT/320/](http://jsfiddle.net/xBVYT/320/)

出于这个原因，我删除了“包含”，但随后拖动的 div 离开了浏览器窗口：

```
$( "#dragable" ).draggable({ cursor: "e-resize", axis: "x" }); 
```

[http://jsfiddle.net/xBVYT/325/](http://jsfiddle.net/xBVYT/325/)

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T02:34:59.433

您在 API 中的相似之处是`revert`- [http://api.jqueryui.com/draggable/#option-revert](http://api.jqueryui.com/draggable/#option-revert)或者您可以以类似的方式使用 jQuery`.animate()`

例如在**下降**

`wrapX+wrapWidth < draggableX + draggableW`也就是说`wrapEndX < draggableEndX`，您已经越过了右边缘，因此将其恢复到开始的位置，否则其他工作将在最后对其进行动画处理 - 可能的最大值。

它与左边缘类似。

您需要编写自己的逻辑，但无论如何似乎如此

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T13:40:29.847

通过控制拖动事件，可以防止可拖动对象移出边距：参见我的[jsfiddle](http://jsfiddle.net/martyk/hfkKp/) 下面是具有拖动事件功能的选项：

```
$( "#dragable" ).draggable({
    cursor: "e-resize"
    , axis: "x" 
    , drag: function(event, ui) {
        var $container = $(this).closest(".wrap");
        var container_left = $container.position().left;
        var container_right = $container.position().left + $container.width();
        var drag_left = ui.offset.left;
        var drag_right = ui.offset.left + $(this).width();
        if (drag_left > container_left) {
            return false;
        };
        if (drag_right < container_right) {
            return false;
        };
    }
}); 
```

# jquery - 从 html 中完全删除 li 元素

> ID：14783908
> 
> 赞同：0
> 
> 时间：2013-02-09T01:19:17.010
> 
> 标签：jquery, html

我有一个如下所示的 HTML 列表，我试图完全删除其中的所有 li。我正在使用 Jquery 来实现这个效果。但是它没有达到我想要的效果，它实际上并没有从 DOM 中删除 li 它只是将它的显示状态设置为隐藏：

```
<li style="display: none;"> </li> 
```

## jQuery

```
 var size = parseInt($(".thumbs li").size(),10);
 for( var i=0; i< size; i++) {
    var src = $('.thumbs li:nth-child('+i+')').remove();    
 } 
```

## HTML

```
<ul class="thumbs noscript">
 <li>
  <a class="thumb" name="leaf" href="" title="Title #0">
     <img src="" alt="Title #0"/>
  </a>
  <div class="caption">
     <div class="download">
        <a href="">Download Original</a>
     </div>
     <div class="image-title">Title #0</div>
     <div class="image-desc">Description</div>
  </div>
 </li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:22:50.553

```
$(".thumbs li").remove(); 
```

你不需要那个循环。（但为了澄清起见，您在循环中的问题是您正在删除元素，所以在中途，DOM 中不再存在第 n 个子元素）

# c - C - 一个计算一系列数字组合的简单表达式？

> ID：14783910
> 
> 赞同：1
> 
> 时间：2013-02-09T01:19:24.560
> 
> 标签：c, math

嗯，真的是一个模糊的陈述（对我来说）

计算的基本表达式是什么：

*   “一次取 k 个整数的 n 个事物的组合数”

*编辑：* 再澄清一点：“例如，一次取三个的四个项目a，b，c，d的组合是abc，abd，acd和bcd。换句话说，总共有四种不同的组合四样东西“一次拿三样”。

我正在上非入门 C 课程，同时尝试完成我的数学要求以转学 CS 学位。到目前为止，我在所有工作中都获得了很高的分数，但是当更高级别的数学出现时，我真的被卡住了。但是我跑题了。。

*n*的数字范围是 1-10， 而*k*的范围是 1-4。

以下是我收到的唯一参考资料，这超出了我的想象。

[http://www.themathpage.com/aPreCalc/permutations-combinations-2.htm](http://www.themathpage.com/aPreCalc/permutations-combinations-2.htm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:36:26.880

基本表达式是 n!/(k!(nk)!)。一种有效的计算方法是使用帕斯卡三角形的 2D DP 表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:40:28.730

页面上的关键表达式是：

*   ^n C [k] = n！÷ ((n - k)!k!)

*这是“一次取k**个 n*事物的组合数”的简单表达式。术语*^n* *C* *[k]*是数学家写“一次取*k**个 n*事物的组合数”的方式。右边的表达式是计算正确值的简洁、准确和简单的方法。它的前提是你知道*n!* 是阶乘*n*，而“阶乘*n ”表示 1 和**n*之间的每个数字相乘。

 ***请注意，*n！*很快就变得非常大，因此朴素算法将工作到大约*n = 12*，但远远超出此范围，您必须非常小心。

*   0！= 1
*   1！= 1
*   2！= 2
*   3！= 6
*   4！= 24
*   5！= 120
*   6！= 720
*   7！= 5040
*   8！= 40320
*   9！= 362880
*   10！= 3628800
*   11！= 39916800
*   12！= 479001600
*   13！= 6227020800

注意13！太大而无法放入 32 位无符号整数，而 21！太大而无法放入 64 位无符号整数，而 35！太大而无法放入 128 位无符号整数（如果您能找到具有这种类型的计算机）。

如果你仍然无法应付，那么你将在转会中遇到问题；这不是很复杂的数学。***

# c# - XNA Platformer - 离开平台后不会摔倒

> ID：14783911
> 
> 赞同：0
> 
> 时间：2013-02-09T01:19:29.803
> 
> 标签：c#, xna, collision-detection

我目前正在为 XNA 开发基于 C# 的平台游戏项目。

我的问题发生在角色离开平台时。他应该跌倒，但不会。我目前正在使用一系列布尔值；jumpBool、fallBool、groundBool 和一个静态布尔值，它使用矩形助手确定他是否在平台上。

判断他处于什么跳跃状态的代码如下。

```
 if (onGround == true)
        {
            fallBool = false;
            gravity = 0.0f;
            jumpheight = -14.0f;
        }
        else
        {
            fallBool = true;
        }

        if (jumpBool == true)
        {
            gravity = 0.0f;
            jumpheight += 1.0f;
            Position.Y += jumpheight;
            onGround = false;
        }

        if (jumpheight > 0)
        {
            jumpBool = false;
            fallBool = true;
        }

        if (fallBool == true)
        {
            gravity = 1.0f;
        } 
```

这一切都有效，直到我尝试在他触摸平台时添加碰撞测试。

下面确定边界框以检查玩家是否在平台上方。

```
static class RectangleHelper
{
    public static bool TouchTopOf(this Rectangle r1, Rectangle r2)
    {
        return (r1.Bottom >= r2.Top - 1 &&
                r1.Bottom <= r2.Top + (r2.Height / 2) &&
                r1.Right >= r2.Left + r2.Width / 5 &&
                r1.Left <= r2.Right - r2.Width / 5);
    }

    public static bool TouchBottomOf(this Rectangle r1, Rectangle r2)
    {
        return (r1.Top <= r2.Bottom + (r2.Height / 5) &&
                r1.Top >= r2.Bottom - 1 &&
                r1.Right >= r2.Left + (r2.Width / 5) &&
                r1.Left <= r2.Right - (r2.Width / 5));
    }

    public static bool TouchLeftOf(this Rectangle r1, Rectangle r2)
    {
        return (r1.Right <= r2.Right &&
                r1.Right >= r2.Right - 5 &&
                r1.Top <= r2.Bottom - (r2.Width / 4) &&
                r1.Bottom >= r2.Top + (r2.Width / 4));
    }

    public static bool TouchRightOf(this Rectangle r1, Rectangle r2)
    {
        return (r1.Left <= r2.Left &&
                r1.Left >= r2.Left - 5 &&
                r1.Top <= r2.Bottom - (r2.Width / 4) &&
                r1.Bottom >= r2.Top + (r2.Width / 4));
    }
} 
```

最后，这段代码检查他是否站在一个块上，并在他触摸平台时更改跳跃属性。

```
 if (rectangle.TouchTopOf(newRectangle))
        {
            jumpheight = -14.0f;
            onGround = true;
            gravity = 0.0f;
            fallBool = false;
        } 
```

但是，因为我使用 bool 来确定他是否在地面上，所以当他离开平台时，bool 仍然设置为 true，他不会摔倒。我想过尝试类似的东西

```
 if else(!rectangle.TouchTopOf(newRectangle))
 {
      onGround = false;
 } 
```

但这会导致 onGround 由于某种原因总是错误的，他只是从平台上掉了下来。一旦他从平台上走下来，我怎么可能让他跌倒？

感谢您查看这篇文章并一直到这里。对此，我真的非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:25:06.547

看起来你只是在玩家在地上时设置'onGround'（并且在玩家离开后不更新它），因为你的函数返回一个布尔值你为什么不试试

```
onGround = rectangle.TouchTopOf(newRectangle); 
```

# android - 在 android 2.3 上通过 HTTPS 播放 .m3u8 文件

> ID：14783914
> 
> 赞同：4
> 
> 时间：2013-02-09T01:19:54.310
> 
> 标签：android, video, https, m3u8

在我的代码中，应用程序找到了一个指向 .m3u8 文件的 URL。这就是接下来会发生的事情：

```
mVideoView.setVideoURI(Uri.parse(feed.getUrl().toString())); // feed.getUrl returns the url
mVideoView.start(); 
```

它在 Android 3.1+ 上运行良好。不在早期版本上，因为它使用 https（参见：http: [//developer.android.com/guide/appendix/media-formats.html](http://developer.android.com/guide/appendix/media-formats.html)）

所以我所做的是我为 Android 2.2+ 创建了一个新版本的应用程序，它使用**vitamio**，一个应该让我更容易的库。但是，在 (android.widget.VideoView) 完美处理的地方， (io.vov.vitamio.widget.VideoView) 需要很长时间来加载流并最终在崩溃时说：

![加载 .m3u8 时记录](../Images/3e8354fbc7533af33692b71b23aee9dc.png)

但是，当我尝试加载此 URL 时： http: [//devimages.apple.com/iphone/samples/bibpbop/gear1/prog_index.m3u8](http://devimages.apple.com/iphone/samples/bipbop/gear1/prog_index.m3u8) 它工作正常！

我无法分享我需要使用的 URL，但这是它指向的 .m3u8 的内容：

```
#EXTM3U
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=264000
playlist.m3u8?session=003016302664236&index=0
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=1364000
playlist.m3u8?session=003016302664236&index=1
#EXT-X-STREAM-INF:PROGRAM-ID=1,BANDWIDTH=44000
playlist.m3u8?session=003016302664236&index=2 
```

所以我可以看到这个和苹果样本之间的主要区别是我使用 https，我的文件指向其他 .m3u8 文件（而苹果的 .m3u8 指向 .ts 文件）.. 两者似乎都使用AAC 音频。

这个问题似乎与维生素有关。我怎样才能绕过这个崩溃？非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T04:29:51.583

我找到了解决办法！

所以我应该说的第一件事是我很困惑，我没有使用 HTTPS，但我的解决方案也应该适用于 https。

首先，您可能需要像我一样使用 Vitamio，因为 Gingerbread 不支持直播（再次阅读[此](http://developer.android.com/guide/appendix/media-formats.html)内容）。现在的问题是，如果您的 M3u8 文件是 .ts 文件列表，它应该可以正常工作。但如果它指向其他 m3u8 文件..

那么你将不得不自己解析它。例如，您可以这样做：

```
url = new URL(livetvchannel.getUrl());
InputStream M3U8 = (InputStream) url.getContent();      
BufferedReader br = new BufferedReader(new InputStreamReader(M3U8));
for(int i = 0; i < 2; ++i)
    br.readLine();
String target = br.readLine(); //this parses the third line of the playlist
br.close();
url = new URL(baseURL.concat(target)); 
//if the m3u8 url is relative, you have to concat it with the path
//Note: You have to do all this in a thread, you can't do network on UiThread

mVideoView.setVideoURI(Uri.parse(url.toString())); //Run this on UiThread 
```

url 将指向视频流。你去吧！最后也没那么难。:)

# wordpress - 显示子类别和来自父类别的帖子

> ID：14783918
> 
> 赞同：3
> 
> 时间：2013-02-09T01:20:42.703
> 
> 标签：wordpress, loops, categories, posts

所以我对wordpress中的循环有这个问题。
我的网站中有以下结构：

*   父类 1
    *   儿童类别 1
    *   儿童类别 2
*   家长类别 2
    *   儿童类别 1
    *   儿童类别 2
    *   *   发布 Cat2.1
    *   *   发布 Cat2.2
    *   帖子 1
    *   帖子 2

在这种情况下，“父类别 2”具有子类别和帖子。我需要在“父类别页面”中显示的是子类别及其不带子类别帖子的帖子。
我到处找，但似乎我一直在寻找错误，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-03T07:07:13.847

我认为这会有所帮助：

```
$cat_id = get_query_var('cat');

if( ! empty( $cat_id ) ) {
$category = get_category( $cat_id, ARRAY_A );

if( ! empty( $category ) ) {
    // parent category
    if( $category['parent'] === '0' ) {

        // get child IDs
        $terms = get_term_children( $cat_id, 'category' );

        foreach( $terms as $term_id ) {
            $child_category = get_term( $term_id, 'category' );

            // if you need the category
            $category_name = $child_category->name;

            /**
             * Sample data in your child category object: 
             * 
             * object(stdClass)[365]
                      public 'term_id' => string '14' (length=2)
                      public 'name' => string 'Child 1' (length=7)
                      public 'slug' => string 'child-1' (length=7)
                      public 'term_group' => string '0' (length=1)
                      public 'term_taxonomy_id' => string '14' (length=2)
                      public 'taxonomy' => string 'category' (length=8)
                      public 'description' => string '' (length=0)
                      public 'parent' => string '12' (length=2)
                      public 'count' => string '5' (length=1)
                      public 'object_id' => string '33' (length=2)
             * 
             * 
             */

            // do whatever you like with the categories now...
        }

    } else { // in child category
        // do the regular loop here, if ( have_posts() ) ...
    }
 }
} 
```

它也发布[在这里](https://gist.github.com/mpeshev/cb1cd3c56d06017b3d87)

希望它可以帮助你:)

# bots - 自动控制发送

> ID：14783920
> 
> 赞同：0
> 
> 时间：2013-02-09T01:20:49.500
> 
> 标签：bots, keypress, autoit

只是试图用[`ControlSend()`](https://www.autoitscript.com/autoit3/docs/functions/ControlSend.htm). 由于某种原因，它不起作用。

```
While 1
   ControlSend("PokeMMO", "", "", "{DOWN}")
   Sleep(900)
   ControlSend("PokeMMO", "", "", "{DOWN}")
   Sleep(900)
   ControlSend("PokeMMO", "", "", "{DOWN}")
   Sleep(900)
   ControlSend("PokeMMO", "", "", "a")
   Sleep(Random(750, 2000, 1))
   ControlSend("PokeMMO", "", "", "a")
   Sleep(Random(750, 2000, 1))
   ControlSend("PokeMMO", "", "", "a")
   Sleep(Random(750, 2000, 1))
   ControlSend("PokeMMO", "", "", "a")
   Sleep(3000)
WEnd 
```

[Au3信息](https://www.autoitscript.com/autoit3/docs/intro/au3spy.htm)：

> 标题：РokеММO，
> 类别：LWJGL

```
Global $sProcess = "javaw.exe" ;PokeMMO Process

ControlSend(_Process2Win($sProcess), "", "", "{DOWN}")

Func _Process2Win($pid)
    If IsString($pid) Then $pid = ProcessExists($pid)
    If $pid = 0 Then Return -1
    $list = WinList()
    For $i = 1 To $list[0][0]
        If $list[$i][0] <> "" And BitAND(WinGetState($list[$i][1]), 2) Then
            $wpid = WinGetProcess($list[$i][0])
            If $wpid = $pid Then Return $list[$i][0]
        EndIf
    Next
    Return -1
EndFunc   ;==>_Process2Win 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T16:15:26.470

您可以先使用 WinGetHandle 接收窗口句柄，然后在 ControlSend 函数中使用此句柄，这应该可以工作。它如下所示：

```
$handle = WinGetHandle("[TITLE:PokeMMO; CLASS:LWJGL]")
ControlSend($handle, Default, $handle, "{Down}") 
```

尝试先显示句柄的内容以确认，您正在接收一个工作句柄。喜欢`ConsoleWrite($handle)`或`MsgBox(1, "Handle", WinGetTitle($handle))`

去吧，试一试;-)
祝你好运！

# java - 在 hadoop 中执行 .jar 文件时出现 Java 版本错误

> ID：14783923
> 
> 赞同：-1
> 
> 时间：2013-02-09T01:21:14.617
> 
> 标签：java, hadoop

我已经使用 Java/NetBeans 实现了一个 pagerank 算法，并且我已经构建了 .jar 文件以在 hadoop 中执行它。

在尝试执行它时，我遇到了这个错误：

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: Pagerank : Unsupported major.minor version 51.0
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
at java.lang.ClassLoader.loadClass(ClassLoader.java:295)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Class.java:247)
at org.apache.hadoop.util.RunJar.main(RunJar.java:149) 
```

经过一番搜索，我发现可能存在 Java 版本兼容性问题。现在我使用带有 Java 1.6 的 hadoop 1.04 版本。我更改了我的 NetBeans 项目以使用相同的版本。

关于我在项目中包含的一些 .jar 库，所有这些库都取自我的 hadoop 安装档案，除了我必须从 MavenRepository 手动下载的一个（hadoop-core）（[http://mvnrepository.com/artifact/org.apache .hadoop/hadoop-core](http://mvnrepository.com/artifact/org.apache.hadoop/hadoop-core)）。我下载了 1.0.4 版本，这是我使用的 Hadoop 版本。

尽管如此，事情对我来说似乎很兼容，但是我再次使用 Hadoop，我希望我能对这个问题有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T03:00:25.557

为什么不在主机本身编译源文件并将它们打包到 Jar 中。您可以运行以下命令：

1.  将所有 Java 文件复制到一个目录。
2.  `mkdir classes`
3.  `javac -classpath <path_to_hadoop_library_jars_separated_by_colon_if_more_than_one> -d classes *.java`
4.  `jar -cvf myjar.jar -C classes/ .`

现在尝试运行这个 JAR。让我们看看它是否有效。

# javascript - 闭包和论证混淆

> ID：14783926
> 
> 赞同：0
> 
> 时间：2013-02-09T01:21:33.010
> 
> 标签：javascript, scope, closures

我试图理解为什么在使用回调函数和闭包时会得到不同的结果。

第一个场景：

```
var cb = function(){
   console.log("anim done");
} 

var anim = Raphael.animation({
    transform: 't0, 100'
}, 2000, cb);

circle.animate(anim); 
```

运行此程序时，有问题的圆圈会动画，2 秒后控制台中会显示“动画完成”消息。

第二种情况：

```
var cb = function(msg){
   console.log("anim done");
} 

var anim = Raphael.animation({
    transform: 't0, 100'
}, 2000, cb("test"));

circle.animate(anim); 
```

这会导致回调 (cb) 立即执行。这会导致立即显示“动画完成”消息。

有人可以澄清这里实际发生的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:28:01.677

When you put a function name all by itself, it just evaluates to the function (a function name is essentially just a variable whose value is the function.

When you follow a function name with parentheses, it means to call the function at that time, with the given arguments. The value is what the function returns.

If you want to pass a function that will call the function, you have to wrap it in a closure, using the `function` keyword:

```
var anim = Raphael.animation({
    transform: 't0, 100'
}, 2000, function() {cb("test")}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T01:27:54.377

当您提供回调时，它必须是一个函数。`cb("test")`不是函数——它是函数的返回值。如果你从`cb("test")`那个函数返回一些东西，它会按预期工作。

事实上，你应该这样做：

```
var anim = Raphael.animation({
    transform: 't0, 100'
}, 2000, function() {
    cb("test");
}); 
```

This way you pass a function, and not an already-evaluated expression, to the animation.

# html - Chrome 无法将 base64 显示为 iframe 源

> ID：14783928
> 
> 赞同：1
> 
> 时间：2013-02-09T01:21:35.743
> 
> 标签：html, google-chrome, iframe, base64, src

基本上，我有一些 HTML 编码为 base64，并带有一个 iframe，其中所说的 html 设置为源。

```
<iframe src="data:html;base64, PGRpdiBzdHlsZT0iY29sb3I6cmVkOyI+VGhpcyB0ZXh0IGlzIHJlZC48L2Rpdj4="></iframe> 
```

[jsFiddle 版本](http://jsfiddle.net/mTgna/)

上面的代码应该显示为：

```
This text is red. 
```

Firefox 似乎能够毫无问题地显示它，但是 Chrome 尝试将其作为文件下载并且根本不显示它。IE 也有问题，但我不太关心这个特定的项目。

我想知道为什么会发生这种情况，以及解决方案（如果有）。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T00:08:31.887

此问题是由错误的数据类型规范引起的。

如果你回看原始代码，规范如下；

```
data:html;base64, 
```

但是，HTML 的正确规范类型是：

```
data:text/html;base64, 
```

Firefox 似乎可以理解格式错误的版本，而 Chrome 则没有。

# html - CSS链接的兄弟选择器？

> ID：14783929
> 
> 赞同：0
> 
> 时间：2013-02-09T01:21:49.240
> 
> 标签：html, css

给定html：

```
 <div class="apples">
    <div class="apple"></div>
    <div class="apple"></div><br>
  </div>
  <div class="oranges">
    <div class="apple"></div>
    <div class="apple"></div>
  </div> 
```

.. 我希望 div 中的两个 s 之间有边距`.apple`，但橙子 div 中的苹果之间没有边距。`.apples``15px`

我可以：

```
.apple + .apple{
    margin-left:15px;
} 
```

..但这也将边距添加到`.apple`s in `.oranges`。

我希望能够做类似的事情：

```
.apples > .apple + .apples > .apple{
  margin-left:15px;
} 
```

..但是，毫不奇怪，这没有用。

摆弄：http: [//jsbin.com/ijagoc/1/edit](http://jsbin.com/ijagoc/1/edit)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:31:54.233

```
.apples > .apple + .apple {
    margin-left: 15px;
} 
```

或者你可以做一个第一个子选择器来支持多个内部 div：

```
.apples .apple {
    margin-left: 15px;
.apples .apple:first-child {
    margin-left: 0;
} 
```

# php - 加载大图像页面加载时间

> ID：14783936
> 
> 赞同：0
> 
> 时间：2013-02-09T01:23:02.603
> 
> 标签：php, jquery, image, loading

我尝试了几种方法来做到这一点，并发现两者都有问题。

1.  从 ajax 帖子加载图像，并将 img id 源更新到它。
2.  PHP 函数加载“li”列表中的所有图像，其中类设置为 display:none 并使用 jquery 隐藏/显示图像。

我的问题是这些图像最小为 1440 像素 x 960 像素。因此，如果我使用 ajax post 加载，则需要一段时间才能显示完整图像，如果我使用 php 循环加载，则页面加载需要很长时间。

这是我的 php 循环函数的示例：

```
public function LoadStreamImages()
{
    $imgs = '<li id="0"><img src="img/OM.jpg" class="bgimg" /></li>';
    if($db->num_rows($consulta)>0)
    {
        while($row = $db->fetch_array($consulta)) { 
            $imgs .= '<li id="' . $row['id'] . '" class="hidden"><img src="img/' . $row['imagefile'] . '" class="bgimg" /></li>';
        }
    }   

    echo $imgs;
} 
```

我能做些什么来加快这个速度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:37:46.943

我猜你最好的解决方案是在方法之间。通过 php 发送图像信息，但在页面加载后使用 javascript 加载 em....

```
<?php
public function LoadStreamImages(){

    if($db->num_rows($consulta)>0)
    {
        $i =0;
        $imgs = array();    
        while($row = $db->fetch_array($consulta)) { 
            $imgs[$i]['id'] = $row['id'];
            $imgs[$i]['imagefile'] = $row['imagefile'];
            $i++;
        }
    }   

echo "<script>myImages = ".json_encode($imgs).";</script>";
}
?> 
```

并在 myImages 上的页面加载后使用 javascript 运行 foreach，只需插入 <li>s 和 <img>s 标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T02:38:12.300

您可以加载缩略图并将其拉伸到大图像的大小，它将用作模糊占位符，直到完整大小的图像可用。淡出低分辨率图像以显示下面的完整图像。这是假设有一种简单的方法可以判断图像何时加载。

# android - 具有共享首选项名称的列表视图并将它们链接起来

> ID：14783937
> 
> 赞同：1
> 
> 时间：2013-02-09T01:23:06.770
> 
> 标签：android, listview, sharedpreferences

我正在开发一个 android 应用程序，其中我有一个创建共享首选项的活动。

在另一个活动中，我只想检索由第一个活动创建的共享首选项的名称，并将这些名称填充到列表视图中。而且我还想将这些名称（在列表视图中）与实际的共享首选项链接起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T01:41:02.973

在另一个活动中，使用[SharedPreferences.getAll](http://developer.android.com/reference/android/content/SharedPreferences.html#getAll%28%29)从共享首选项中获取所有值：

```
Map<String,?> values = prefs.getAll(); 
```

然后，您可以遍历`values`以获取所需的字符串。可能您可以将这些字符串存储到数组中。接下来，初始化一个`ArrayAdapter`让列表视图填充这些数据。类似的代码在这里：

```
 ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.list_item, strings);

    listView.setAdapter(adapter); 
```

# xml - Perl将新元素插入数组子数组

> ID：14783940
> 
> 赞同：0
> 
> 时间：2013-02-09T01:23:47.767
> 
> 标签：xml, arrays, perl, hash

您好，我正在尝试插入一个新元素，以便从这里开始

```
 <explicit-group name="CDEV">
      <aip-address>1.1.1.1</aip-address>
      <aip-address>2.2.2.2</aip-address>
      <aip-address>3.3.3.3</aip-address> 
```

对此

```
 <explicit-group name="CDEV">
      <aip-address>1.1.1.1</aip-address>
      <aip-address>2.2.2.2</aip-address>
      <aip-address>3.3.3.3</aip-address>
      <aip-address>99.99.99.254</aip-address> 
```

我拥有的代码如下，但我已经阅读了两天的引用和取消引用，但仍然无法得到它。我是在尝试做一些不可能的事情，还是有人可以告诉我如何做。

谢谢！

```
use strict;
use XML::Simple;
use Data::Dumper;
my $xs = XML::Simple->new(
  XMLDecl => '<?xml version="1.0" encoding="UTF-8"?>',
  forcearray => [ 'item' ],
  keyattr    => {   },
  rootname   => 'SG-distribution',
);

my $opt = $xs->XMLin(\*DATA);

push @{ $opt->{'sa-coller'}->{'explicit-group'} } , { {'CDEV'}->{'aip-address'} };

print Dumper($opt);
print $xs->XMLout($opt);

__DATA__
<?xml version="1.0" encoding="UTF-8"?><SG-distribution>
  <sa-coller name="W8-C1" enabled="true" host="localhost" port="99">
    <ip-group name="home" ipAddressMask="192.168.0.*" match="glob"/>
    <ip-group name="home2" ipAddressMask="10.0.0.*" match="glob"/>
    <explicit-group name="CDEV">
      <aip-address>1.1.1.1</aip-address>
      <aip-address>2.2.2.2</aip-address>
      <aip-address>3.3.3.3</aip-address>
    </explicit-group>
    <explicit-group name="HYU"/>
    <explicit-group name="JUN"/>
  </sa-coller>
</SG-distribution> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T02:15:39.463

您有一个包含四个元素的数组，代表每个`explicit_group`元素。您要识别名称属性为 的那个`CDEV`。由于它们不是按名称（而是按位置）索引的，因此您需要遍历数组以找到正确的元素。

```
for my $explicit_group (@{ $opt->{'sa-coller'}{'explicit-group'} }) {
  if ($explicit_group->{name} eq 'CDEV') {
     push @{ $explicit_group->{'aip-address'} }, '99.99.99.254';
   }
} 
```

# android - <= 4.1.2 中的 Android 锁屏控件

> ID：14783943
> 
> 赞同：2
> 
> 时间：2013-02-09T01:24:32.490
> 
> 标签：android, widget, locking, screen, android-4.2-jelly-bean

我知道 Jelly Bean 4.2 添加了创建锁屏小部件的功能，但我也注意到某些应用程序（例如 Spotify）甚至为我的 4.1.2 手机添加了锁屏播放/暂停/停止/等控件。不过，我终其一生都无法弄清楚他们是如何做到的。我怎样才能在我的应用程序中做这样的事情？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T01:30:13.490

[http://developer.android.com/about/versions/android-4.0.html](http://developer.android.com/about/versions/android-4.0.html)

> 新的 RemoteControlClient 允许媒体播放器启用来自远程控制客户端的播放控制，例如设备锁定屏幕。媒体播放器还可以公开有关当前正在播放的媒体的信息，以便在遥控器上显示，例如曲目信息和专辑封面。

以及有关该主题的更多段落。

[您在 上](http://developer.android.com/reference/android/media/AudioManager.html#registerRemoteControlClient%28android.media.RemoteControlClient%29)注册了一个`RemoteControlClient`via 。[`registerRemoteControlClient()``AudioManager`](http://developer.android.com/reference/android/media/AudioManager.html#registerRemoteControlClient%28android.media.RemoteControlClient%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-28T14:30:17.720

您仍然可以注册 MediaButtonIntent 并使用 CommonsWare 提到的 RemoteControlClient API。您的应用程序需要获得音频焦点，但您可以拥有自己的广播接收器，可以根据需要对按钮做出反应。模仿媒体意图的 API 已在 kitKat 中公开

# ruby-on-rails-3 - 如何使用 simple_form 呈现复选框？

> ID：14783945
> 
> 赞同：0
> 
> 时间：2013-02-09T01:24:41.230
> 
> 标签：ruby-on-rails-3, simple-form

我正在查看 simple-form-b​​ootstrap 页面，但不知道如何呈现复选框。

假设我有四个复选框，对应于示例中的四个布尔表列：博客、社论、公告、广告。

代码如下所示：

```
<%= f.input :content_type, :collection => content_type_options, :as => :check_boxes %> 
```

我猜`content_type_options`这将是上述四个复选框的数组，对吗？那么我放`:content_type`什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T03:10:44.627

simple_form 将选定的选项绑定到`params[:content_type]`变量。

注意：`content_type_options`也可以是包含选项/值对的哈希。例如 {'Blog' => 'blog', 'Editorial' => '社论', ...}

# python - Python中的分组/聚类数字

> ID：14783947
> 
> 赞同：20
> 
> 时间：2013-02-09T01:24:59.817
> 
> 标签：python, numbers, iteration

我用谷歌搜索过，我已经测试过了，这让我束手无策。我有一个需要按相似度分组的数字列表。例如，在 [1, 6, 9, 100, 102, 105, 109, 134, 139] 的列表中，将 1 6 9 放入列表中，将 100、102、105 和 109 放入列表中列表，以及 134 和 139。我的数学很糟糕，我已经尝试过这个，但我无法让它工作。为了尽可能明确，我希望将彼此相距 10 个值以内的数字分组。任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-09T01:31:56.090

有很多方法可以进行[聚类分析](https://en.wikipedia.org/wiki/Cluster_analysis)。一种简单的方法是查看连续数据元素之间的间隙大小：

```
def cluster(data, maxgap):
    '''Arrange data into groups where successive elements
       differ by no more than *maxgap*

        >>> cluster([1, 6, 9, 100, 102, 105, 109, 134, 139], maxgap=10)
        [[1, 6, 9], [100, 102, 105, 109], [134, 139]]

        >>> cluster([1, 6, 9, 99, 100, 102, 105, 134, 139, 141], maxgap=10)
        [[1, 6, 9], [99, 100, 102, 105], [134, 139, 141]]

    '''
    data.sort()
    groups = [[data[0]]]
    for x in data[1:]:
        if abs(x - groups[-1][-1]) <= maxgap:
            groups[-1].append(x)
        else:
            groups.append([x])
    return groups

if __name__ == '__main__':
    import doctest
    print(doctest.testmod()) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-09T01:29:33.817

这将找到组：

```
nums = [1, 6, 9, 100, 102, 105, 109, 134, 139]
for k, g in itertools.groupby(nums, key=lambda n: n//10):
    print k, list(g)

0 [1, 6, 9]
10 [100, 102, 105, 109]
13 [134, 139] 
```

请注意，如果 nums 没有像您的示例显示的那样实际排序，您需要先对其进行排序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-19T04:30:17.203

首先，您可以轻松地将任何序列转换为相邻项目对的序列。只需开球，将其向前移动，然后将未移位和未移位的副本拉上拉链。唯一的技巧是您需要从`(<something>, 1)`or开始`(139, <something>)`，因为在这种情况下，我们不想要每对元素，而是每个元素都有一对：

```
def pairify(it):
    it0, it1 = itertools.tee(it, 2)
    first = next(it0)
    return zip(itertools.chain([first, first], it0), it1) 
```

（这不是最简单的编写方式，但我认为这可能是不熟悉 . 的人最容易阅读的方式`itertools`。）

```
>>> a = [1, 6, 9, 100, 102, 105, 109, 134, 139]
>>> list(pairify(a))
[(1, 1), (1, 6), (6, 9), (9, 100), (100, 102), (102, 105), (105, 109), (109, 134), (134, 139)] 
```

然后，使用稍微复杂一点的 Ned Batchelder 密钥版本，您就可以使用`groupby`.

但是，我认为在这种情况下，这最终会比做同样事情的显式生成器更复杂。

```
def cluster(sequence, maxgap):
    batch = []
    for prev, val in pairify(sequence):
        if val - prev >= maxgap:
            yield batch
            batch = []
        else:
            batch.append(val)
    if batch:
        yield batch 
```

# java - 如何在 Java 中从游戏画布中添加单独的图像

> ID：14783953
> 
> 赞同：1
> 
> 时间：2013-02-09T01:25:52.430
> 
> 标签：java, image, canvas, interface

所以我面临着一个我已经坚持了一个小时的情况。

这是我的情况：我想添加一个显示“生活：”的图像，与我的游戏画布分开，非常类似于 NES 的这款游戏《塞尔达传说》。

![例子](../Images/2bcf7c0274905c22f00ab56304f3182b.png)

问题是：我的代码仍然只显示我的游戏画布。

```
public class Game extends Canvas {

           private Game(){

           JFrame container = new JFrame("Arcade Shooter Clone");

            panel = (JPanel)container.getContentPane();
            panel.setLayout(new BorderLayout());

            panel.add(this,BorderLayout.CENTER);

            ShipLifeTitle shipLifeTitle = new ShipLifeTitle();
            panel.add(shipLifeTitle,BorderLayout.SOUTH);
           }

    }

    public class ShipLifeTitle extends Sprite {

        private Image image;

        public ShipLifeTitle()
        {
            try
            {
                image = ImageIO.read(new File("src/Ship/shipLifeTitle.PNG"));

            }
            catch(IOException e)
            {
                e.printStackTrace();
            }

        }

        @Override
        public void draw(Graphics g) {
            // TODO Auto-generated method stub
            g.drawImage(image, 200, 200, null);
        }

    }

    public class Sprite extends Component implements GameComponent {

        public Vector2D position;
        public Vector2D velocity;

        @Override
        public void update(long milliseconds) {
            // TODO Auto-generated method stub

        }

        @Override
        public void draw(Graphics g) {
            // TODO Auto-generated method stub

        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T01:34:23.373

在您`ShipLifeTitle`的面板中，您需要覆盖其`getPreferredSize`方法。

```
public class ShipLifeTitle extends Sprite {
    //...
    public Dimension getPreferredSize() {
        return new Dimension(image.getWidth(null), image.getHeight(null));
    }
} 
```

这将为`BorderLayout`您希望面板的布局方式提供一些提示

# javascript - 为什么账单地址不能复制到发货地址？

> ID：14783956
> 
> 赞同：0
> 
> 时间：2013-02-09T01:26:22.180
> 
> 标签：javascript

因此，我知道字段是正确命名的，但是当检查复选框时，JavaScript仍未复制信息。我已经仔细检查过，字段中的所有内容都匹配。

JavaScript：

```
function FillShiping(f) {
    if(f.shipingtoo.checked == true) {
        f.shipto.value = f.billto.value;
        f.shipaddress.value = f.Address.value;
        f.shipcity.value = f.City.value;
        f.shipstate.value = f.State.value;
        f.shipzip.value = f.Zip.value;
    }

    if(f.shipingtoo.checked == false) {
        f.shipto.value = '';
        f.shipaddress.value = '';
        f.shipcity.value = '';
        f.shipstate.value = '';
        f.shipzip.value = '';
    }
} 
```

HTML：

```
<div class="fb-checkbox">
    <input type="checkbox" onclick="Fillshiping(this.form)" name="shipingtoo">
    <span class="fb-fieldlabel" id="item61_0_span">Check this if shipping address is same
                        as billing address </span>
    </label>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-09T01:34:00.450

控制台显示错误：

> ReferenceError：Fillshiping 未定义

您命名了函数`FillShiping`，但您正在调用`Fillshiping(this.form)`（小写`s`）。

在[更正您的小提琴](http://jsfiddle.net/f3vGx/1/) *并* [正确命名该功能后，它似乎可以工作](http://jsfiddle.net/f3vGx/2/)。

* * *

使用浏览器的开发人员工具来调试代码，这是非常宝贵的。

# jquery - Jquery 多种形式

> ID：14783958
> 
> 赞同：2
> 
> 时间：2013-02-09T01:26:33.590
> 
> 标签：jquery, forms

我是 JQuery 的新手，我不敢相信这是不可能的......

我有多个动态创建的 HTML 表单。我正在使用 JQuery 从表单中捕获数据，但是当我提交表单时，我只能访问最后一个表单中的数据。

这是我的代码：

```
for($x=0; $x<10; $x++){

     ?>
     <form method="POST" id="formid<? echo $x; ?>">
      <textarea name="notes_text"><? echo $row[2]; ?></textarea></td>
      <input type="hidden" value="<? echo $row[0]; ?>" name="notes_id" />
      <input type="image" src="/images/edit-small.png" id="update-notes-submit" class="submit-img-sml"/>            
     </form>
     <?

} 
```

和 jQuery：

```
$("form").submit(function(){

     var form_id = $(this).closest("form").attr('id');  
     alert(form_id);

     var notes_id=$('#formid1 input[name=notes_id]').val();
     var notes_text=$('#formid1 textarea[name=notes_text]').val();

} 
```

警报给了我正确的形式，这样就可以了。

如果我提醒 notes_id 或 notes_text 变量，我会得到“未定义”。

我努力了：

```
var notes_id=$('#formid1 input[name=notes_id]').val();
= undefined

var notes_id=$('#formid2 input[name=notes_id]').val();
= undefined

var notes_id=$('input[name=notes_id]').val();
= data from the last form that appears in my script 
```

如何指定表单和变量。我不敢相信这很难实现，也许 JQuery 不可能做到这一点，如果是这样，这是一个令人震惊的限制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:37:05.463

您假设表单 id 是`formid1`，但我感觉不是正在提交的那个。尝试以下操作：

```
$("form").submit(function(){
     var form =$(this);//this refers to the form
     var notes_id=form.find('input[name=notes_id]').val();
     var notes_text=form.find('textarea[name=notes_text]').val();
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T18:10:03.180

Ok so I finally figured it out after about 8 hours of hammering away.

The problem was caused by the table tags which were in the wrong place. I was using this format:

```
<table>

 <?

 for($x=1; $x<=mysql_num_rows($notes); $x++){

      $row=mysql_fetch_row($notes);

      ?>
      <form id="form<? echo $x; ?>">

       <tr>
        <td width="150"><b>Text 1</b></td>
        <td colpsan="3"><textarea name="txtarea">Some text</textarea></td>
       </tr>

      <input type="hidden" value="<? echo $row[0]; ?>" name="notes_id" />        
      </form>

      <?

 }

?>

</table> 
```

But if I placed the table opening and closing tags within the for loop it solved the problem:

```
 <?

 for($x=1; $x<=mysql_num_rows($notes); $x++){

      $row=mysql_fetch_row($notes);

      ?>

      <table>
       <form id="form<? echo $x; ?>">

        <tr>
         <td width="150"><b>Text 1</b></td>
         <td colpsan="3"><textarea name="txtarea">Some text</textarea></td>
        </tr>

       <input type="hidden" value="<? echo $row[0]; ?>" name="notes_id" />        
       </form>

      </table> 

      <?       

}

?> 
```

I'm not sure why this works, because as far as I can see this simply creates a table for each form, where as previously a single table was used.

Thank you so much for your help - it is appareciated!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T02:32:18.527

去掉多余的`</td>`后`</textarea>`。它与表单外部匹配，因此表单元素也被终止。结果，元素不在表单内。看看检查器中的 DOM，你会发现这是多么混乱。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-02-09T01:48:22.923

你不是缺少引号吗？

```
var notes_id=$('#formid1 input[name=notes_id]').val();
var notes_text=$('#formid1 textarea[name=notes_text]').val();

var notes_id=$('#formid1 input[name="notes_id"]').val();
var notes_text=$('#formid1 textarea[name="notes_text"]').val(); 
```

很确定这些报价很重要。

# inno-setup - 需要有关 Inno Setup 脚本的帮助 - 检查 jre 安装中的问题

> ID：14783959
> 
> 赞同：5
> 
> 时间：2013-02-09T01:26:33.550
> 
> 标签：inno-setup

我正在使用以下脚本来安装 Java 程序。我面临这个脚本的两个问题。如果您知道这些问题的解决方法，请告诉我。我真的很感谢你的时间

1.  JRE 检查发生 2 次，即安装开始和安装结束。我希望 JRE 检查仅在安装开始时进行

2.  我正在检查以下 Windows 注册表项以检查 JRE，并且此脚本不适用于所有情况。我的意思是有时这可以正常工作，有时对于 64 位 JRE 安装会失败。我正在寻找一种逻辑来检查所有场景的注册表（即 32 位、64 位和所有 Windows 版本）

```
; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

#define MyAppName "Test"
#define MyAppVersion "1.0"
#define MyAppPublisher "Test"
#define MyAppURL "gmail.com"
#define MyAppExeName "abc.exe"
#define MinJRE "1.6"

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
;(To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{200DC169-9647-4295-91B4-B1D1D8482B82}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
;AppVerName={#MyAppName} {#MyAppVersion}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
DefaultDirName={userdocs}\xsxsxs\bvb
DisableDirPage=yes
DefaultGroupName=test
DisableProgramGroupPage=yes
AllowNoIcons=yes
LicenseFile=C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\TemsOfUse.txt
OutputDir=C:\test\test
OutputBaseFilename=test
SetupIconFile=C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\Icon\icon.ico
Compression=lzma
SolidCompression=yes
PrivilegesRequired=lowest

[Tasks]
Name: "desktopicon"; Description: "{cm:CreateDesktopIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked
Name: "quicklaunchicon"; Description: "{cm:CreateQuickLaunchIcon}"; GroupDescription: "{cm:AdditionalIcons}"; Flags: unchecked; OnlyBelowVersion: 0,6.1

[Dirs]
Name: "{app}\Graphics"
Name: "{app}\lib"
Name: "{app}\Database"
Name: "{app}\Grades"
Name: "{app}\HelpFiles"
Name: "{app}\images"
Name: "{app}\Scripts"

[Files]

Source: "C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\test.exe"; DestDir: "{app}"; Flags: ignoreversion;
Source: "C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\Graphics\*"; DestDir: "{app}\Graphics"; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\lib\*"; DestDir: "{app}\lib"; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\DataBase\*"; DestDir: "{app}\DataBase"; Flags: ignoreversion recursesubdirs createallsubdirs
Source: "C:\test\Installers_PC_MAC\CORRECTIONS_TO_INSTALLER_BUGS\Grades\*"; DestDir: "{app}\Grades"; Flags: ignoreversion recursesubdirs createallsubdirs

[Icons]
Name: "{group}\test"; Filename: "{app}\{#MyAppExeName}"
Name: "{group}\{cm:uninstallProgram,test}"; Filename: "{uninstallexe}"
Name: "{commondesktop}\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; Tasks: desktopicon
Name: "{userappdata}\Microsoft\Internet Explorer\Quick Launch\{#MyAppName}"; Filename: "{app}\{#MyAppExeName}"; Tasks: quicklaunchicon

[Run]
Filename: "{app}\{#MyAppExeName}"; Description: "{cm:LaunchProgram,{#StringChange(MyAppName, '&', '&&')}}";check:InitializeSetup; Flags: nowait postinstall skipifsilent

[Code]

function installJRE(): Boolean;
   var
   Result1 : Boolean;
   ErrorCode: Integer;
   begin
   Result1 := false;

   Result1 := MsgBox('Java is required to run the program you are trying to install. Please click on Yes button given below to close this installer and be directed to a website were you can download and install Java.',
   mbConfirmation, MB_YESNO) = idYes;
   if Result1 = false then
   begin
   // user can install the Java later also
   Result:=true;
   end else
   begin
   Result:=false;        
   ShellExec('open', 'http://www.oracle.com/technetwork/java/javase/downloads/jre6downloads-1902815.html','','',SW_SHOWNORMAL,ewNoWait,ErrorCode);
  end;
end;

function InitializeSetup(): Boolean;
var 
 jreVersion: String;                            
   begin
   Result := False; 
     if ((RegValueExists(HKEY_LOCAL_MACHINE, 'SOFTWARE\JavaSoft\Java Runtime Environment','CurrentVersion'))) then
     begin      
      RegQueryStringValue(HKLM,'Software\JavaSoft\Java Runtime Environment','CurrentVersion',jreVersion);
      if CompareStr(jreVersion,'{#MinJRE}') > 0 then 
      begin      
          Result:=true;
       end else
       begin
        if(installJRE) then
         Result:=true;  
      end;      
       end else
        if(installJRE) then
        Result:=true;
       end;
    end. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T05:08:34.653

***为什么 InitializeSetup 函数在用作 Check 函数时会被多次调用？***

您将`InitializeSetup`事件方法用作`Check`函数，是什么导致该方法被多次调用。第一次初始化设置时（作为真实事件方法）和下一次`Check`确定是否`[Run]`应打开该部分的文件条目。

基本上，对函数使用事件方法`Check`是错误的。您甚至不应该手动调用它们，只需让它们被安装程序应用程序触发。在你的情况下，宁愿做一个函数来检查是否安装了 JRE 并为你的`Check`.

***如何获取 Java SE 运行时环境版本？***

您无需将设置运行为 64 位。您可以简单地从 WOW 注册表节点读取 64 位 Windows 上的 64 位 JRE 版本。我会尝试使用这样的东西：

```
[Run]
Filename: "{app}\MyApp.exe"; Flags: nowait postinstall skipifsilent; Check: IsJREInstalled

[Code]
#define MinJRE "1.6"
#define WebJRE "http://www.oracle.com/technetwork/java/javase/downloads/jre6downloads-1902815.html"

function IsJREInstalled: Boolean;
var
  JREVersion: string;
begin
  // read JRE version
  Result := RegQueryStringValue(HKLM32, 'Software\JavaSoft\Java Runtime Environment',
    'CurrentVersion', JREVersion);
  // if the previous reading failed and we're on 64-bit Windows, try to read 
  // the JRE version from WOW node
  if not Result and IsWin64 then
    Result := RegQueryStringValue(HKLM64, 'Software\JavaSoft\Java Runtime Environment',
      'CurrentVersion', JREVersion);
  // if the JRE version was read, check if it's at least the minimum one
  if Result then
    Result := CompareStr(JREVersion, '{#MinJRE}') >= 0;
end;

function InitializeSetup: Boolean;
var
  ErrorCode: Integer;
begin
  Result := True;
  // check if JRE is installed; if not, then...
  if not IsJREInstalled then
  begin
    // show a message box and let user to choose if they want to download JRE;
    // if so, go to its download site and exit setup; continue otherwise
    if MsgBox('Java is required. Do you want to download it now ?',
      mbConfirmation, MB_YESNO) = IDYES then
    begin
      Result := False;
      ShellExec('', '{#WebJRE}', '', '', SW_SHOWNORMAL, ewNoWait, ErrorCode);
    end;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T02:57:39.783

关于问题 1，您应该`check:InitializeSetup;`从`[Run]`. `InitializeSetup`安装程序启动时将调用一次，

[http://www.jrsoftware.org/ishelp/index.php?topic=scriptevents](http://www.jrsoftware.org/ishelp/index.php?topic=scriptevents)

当您添加额外`check`内容时，它会再次触发该功能，这是不必要的。

关于问题 2，根本不应该检测到 JRE x64，因为您的安装程序将作为 x86 执行并且没有机会访问注册表项的 x64 部分。要验证 x64 JRE，您需要设置`ArchitecturesInstallIn64BitMode`.

[http://www.jrsoftware.org/ishelp/index.php?topic=setup_architecturesinstallin64bitmode](http://www.jrsoftware.org/ishelp/index.php?topic=setup_architecturesinstallin64bitmode)

Bitness 对于安装程序创建者来说是一个非常复杂的话题，因此您需要进一步研究如何正确使用它。

# wpf - WPF：如何动态生成 ContextMenu

> ID：14783961
> 
> 赞同：18
> 
> 时间：2013-02-09T01:27:00.460
> 
> 标签：wpf, contextmenu

我有包含多个项目的 ListBox（SelectionMode=Extended），我想添加上下文菜单功能。问题是如何根据某些条件动态创建上下文菜单。例如。如果只选择了一个项目，我想显示常规上下文菜单，但在选择多个项目时显示其他上下文菜单（例如添加了一些新项目）。另外，如果所选项目中至少有一个具有某些属性集，我想创建第三种上下文菜单。等等......可能有多个这样的条件。

基本上我需要在用户右键单击鼠标按钮后但在菜单实际显示之前立即动态生成上下文菜单。这可能吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-04-24T18:56:45.643

我知道这是一个老问题。似乎有一个非常简单的答案可以解决 MVVM 场景中 OP 的原始问题，因为 ContextMenu 类支持通过 ItemsSource 属性进行绑定。

希望它可以帮助遇到这个问题的人。

**XAML**

```
 <ContextMenu ItemsSource="{Binding Path=ItemList, UpdateSourceTrigger=PropertyChanged}">
      </ContextMenu> 
```

在 ViewModel 中，您可以根据当前应用程序状态动态修改“ItemList”属性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-09T02:18:44.153

我找到了我的问题的答案，它是 ContextMenuOpening 事件。基本上我需要处理这个事件并根据当前的应用程序状态进行菜单调整。更多详细信息：[https ://msdn.microsoft.com/en-us/library/Bb613568(v=vs.100).aspx](https://msdn.microsoft.com/en-us/library/Bb613568(v=vs.100).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-09T02:04:03.770

如果您有一组要根据特定场景使用的预定义上下文菜单，您始终可以将上下文菜单创建为资源。

```
<Window.Resources>
    <ContextMenu x:Key="Menu1">
        <MenuItem>Item1</MenuItem>
    </ContextMenu>
    <ContextMenu x:Key="Menu2">
        <MenuItem>Item1</MenuItem>
        <MenuItem>Item2</MenuItem>
    </ContextMenu>
</Window.Resources> 
```

然后在您创建数据触发器`ListBox`以设置`ContextMenu`要使用的，而不是我在下面所做的，我建议绑定到您的视图模型上的属性或后面的代码，因为它在 xaml 中可能会变得非常混乱。这里的实现检查是否只选择了一个项目，在这种情况下切换到 Menu1

```
<ListBox x:Name="mylist" SelectionMode="Multiple" ContextMenu="{StaticResource Menu2}" >
    <ListBox.Style>
        <Style TargetType="{x:Type ListBox}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=SelectedItems.Count, RelativeSource={RelativeSource Self}}" Value="1" >
                    <Setter Property="ContextMenu" Value="{StaticResource ResourceKey=Menu1}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </ListBox.Style>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=DisplayName}" />
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

如果选择显示哪个上下文菜单仅与视图有关，我建议在后面的代码中处理它。

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        // Hook up any events that might influence which menu to show
        mylist.SelectionChanged += listSelectionChanged;
        InitializeComponent();
    }

    private void listSelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        var listBox = sender as ListBox;
        if (listBox == null)
            return; // Or throw something, hard

        ContextMenu menuToUse;
        // Logic for selecting which menu to use goes here

        listBox.ContextMenu = menuToUse;
    }
} 
```

如果 ViewModel 确实对显示哪个菜单感兴趣（听起来不像，但如果不知道完整的上下文很难分辨），您可以公开一些属性，让您在 ViewModel 中决定`ContextMenu`要显示的内容。尽管您很可能希望创建一个类来确保在任何给定时间只有一个布尔值为真，而不是单个布尔属性。

```
public class MyViewModel : INotifyPropertyChanged
{

    public MyViewModel()
    {
        SelectedItems = new ObservableCollection<string>();
        SelectedItems.CollectionChanged += SelectedItemsChanged;
    }

    private void SelectedItemsChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        // Logic to see which ShowMenuX property to set to true goes here
    }

    public ObservableCollection<string> SelectedItems { get; set; }

    private bool _showMenu1 = false;
    public bool ShowMenu1
    {
        get { return _showMenu1; }
        set
        {
            _showMenu1 = value;
            RaisePropertyChanged("ShowMenu1");
        }
    }

    // INotifyPropertyChanged implementation goes here
} 
```

# php - 在 jQuery Flexbox 插件中显示 mysql 记录

> ID：14783962
> 
> 赞同：0
> 
> 时间：2013-02-09T01:27:05.820
> 
> 标签：php, javascript, jquery, mysql, jquery-flexbox

```
 <script type="text/javascript">  
            $(function() {
$('#jo').flexbox({  
        "results": [  
            { "id": "1", "name": "002155" },  
            { "id": "2", "name": "002155" },
            { "id": "3", "name": "asdasdasd" }
        ]}, 
    {  
showArrow: false  
});
            });  
        </script> 
```

顶部的代码是 flexbox 建议的记录，例如 ill type **00**它有两个建议 002155 和 002155，但问题是建议这个词的结果是静态的，我读了一些来自这个站点的代码他们链接一个 php 页面用作数据库。这是样本...

```
$("#suggest").flexbox('back/search.php', { 
```

上面这段代码来自：[jquery flexbox ?](https://stackoverflow.com/questions/7533858/jquery-flexbox) 我尝试做一些替代方案，以便能够使用 mysql 作为建议这个词的结果；

```
 <script type="text/javascript">  
            $(function() {
$('#jo').flexbox({  
        "results": [  
    <?php
        $con = mysql_connect("localhost","root","");

        mysql_select_db("accom");
        $query = mysql_query("select * from myproject");
            while($i = mysql_fetch_array($query))
            {
                $ii++;
                print"{ id : ".$ii.", name: ".$i[per_name]." },";       
            }
    ?>
        ]}, 
    {  
showArrow: false  
});
            });  
        </script> 
```

但它不起作用;-(，请帮帮我，让建议这个词的来源来自一个sql查询，谢谢你们..

顺便说一下，这是我的桌子

```
myproject
per_id(int 100)auto_increment
per_name(varchar 100) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T02:18:28.370

生成的 json 无效。

事实上，参数不包括第二个参数（因为你用'}'关闭对象）并且名称值是字符串，所以你可能需要添加引号。

```
 <script type="text/javascript">  
        $(function() {
            $('#jo').flexbox({  
                "results": [  
                    <?php
                        $con = mysql_connect("localhost","root","");
                        mysql_select_db("accom");
                        $query = mysql_query("select * from myproject");
                        while($i = mysql_fetch_array($query))
                        {
                            $ii++;
                            print"{ id : ".$ii.", name: '".$i[per_name]."' },";       
                        }
                    ?>
                ], 
                showArrow: false  
             });
        });  
        </script> 
```

请注意，如果名称包含引号字符，您应该需要对名称值进行分隔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T14:44:24.513

最佳做法是进行 php 调用，json 获取您需要的数据然后加载它。

```
<script type="text/javascript">  
$(function() {
$.getJSON("search.php", function(data){
    $('#jo').flexbox({  
        "results": data, 
        showArrow: false  
    });
}); 
});  
</script> 
```

然后在您的 search.php 中执行以下操作：

```
$con = mysql_connect("localhost","root","");
mysql_select_db("accom");
$query = mysql_query("select * from myproject");
$data = array();
while($i = mysql_fetch_array($query))
{
    $data[] = array('id' => $ii, 'name' => $i[per_name])       
}
echo json_encode($data); die(); 
```

所以现在当页面加载完成时，它会调用你的 php 搜索函数，以 json 格式获取数据，然后你只需将其分配给你的 flexbox。

# windows-phone-7 - 我应该在 Windows Phone 7.8 中使用哪个版本的 MVVM Light？

> ID：14783963
> 
> 赞同：0
> 
> 时间：2013-02-09T01:27:28.763
> 
> 标签：windows-phone-7, mvvm, mvvm-light

我想在 windows phone 7.8 中开始开发，但不确定要使用哪个版本的 [MVVM Light Toolkit](http://www.galasoft.ch/mvvm/)。我必须使用 VS 2010，因为据我所知你不能在 Vs2012 中编程 wp7。最新版的MVVM light好像只支持2012。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T08:39:52.967

使用 Visual Studio 2012，您还可以开发 Windows Phone 7 应用程序。创建新项目时只需选择合适的目标操作系统。

MVVM Light v3 应该始终像为 Visual Studio 2010 构建的那样工作。

**这是它在我的机器上的样子：**

Visual Studio 2012 中的新项目屏幕： ![Visual Studio 2012 中的新项目屏幕](../Images/bbbe030210acb4974dce16a6b61b5001.png)

显示 7.1 和 8.0 的 Windows Phone 操作系统版本选择框： ![显示 7.1 和 8.0 的 Windows Phone 操作系统版本选择框](../Images/37a2cf100f1f59c354ec6e0b4fed13ab.png)

# windows - 从批处理文件中更改文本颜色

> ID：14783966
> 
> 赞同：0
> 
> 时间：2013-02-09T01:27:36.067
> 
> 标签：windows, command-line, colors, batch-file

我制作了一个交互式批处理文件，允许您向人们发送消息，并且我在为批处理中的特定配置文件永久更改颜色时遇到问题。（它可以为批处理文件制作配置文件以用作登录名。）因此需要知道是否有办法更改批处理文件并将其保存给该特定用户，以便当他们登录时，颜色会变回他们选择的颜色。

Messenger将其用户信息保存在隐藏`.txt`文件中，可以在`for /f`取消隐藏正在读取的txt文件后使用命令登录时与用户输入进行比较。所以现在我需要它来构建一个包含保存信息的批处理文件，供用户更改所有屏幕上的颜色，仅针对该特定用户。如果您还没有收集，它可以有多个用户。

到目前为止，这就是我所拥有的。

```
:COLORCHANGER
cls
echo.
echo.
echo                   Background            Text
echo                   0=Black               A=Bright Green
echo                   1=Deep Blue           B=Bright Blue
echo                   2=Dark Green          C=Light Red
echo                   3=Blue                D=Light Purple
echo                   4=Dark Red            E=Light Yellow
echo                   5=Purple              F=Bright White
echo                   6=Dark Yellow                
echo                   7=White
echo                   8=Grey
echo                   9=Deep Blue

set color=
set /p color=Color: 
```

[`.bat`为该特定用户创建一个文件，以便在他们登录时更改为`.bat`文件中所有屏幕所需的颜色]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T02:02:42.007

您可以使用这些代码行...

```
set /p col=Color code: 
echo color %col% > "color.bat" 
```

这将创建一个带有代码“color [user_input]”的 .bat 文件 现在，当您启动主程序时，输入代码`call color.bat`，它会将颜色设置为文件中的任何内容。

此外，您可以使用此代码段在创建后隐藏文件`attrib +h color.bat`

希望能帮助到你。

# php - 使用 PHP 运行查询并将其放置在 javascript 对象中

> ID：14783969
> 
> 赞同：0
> 
> 时间：2013-02-09T01:28:01.530
> 
> 标签：php, javascript, oracle

我正在尝试使用 PHP 运行存储过程。我想将查询结果放入 javascript 对象中。我找不到如何做到这一点。我已经运行了这段代码，但我得到的结果之一是未定义的。这是我的代码：

```
$result = mysql_query("call sp_getGenre()");
    if($result === FALSE){
            die(mysql_error());
        }
        while($row = mysql_fetch_array($result)){
    ?>
            <script type="text/javascript">
                console.log(<? $row['Type'] ?>);
                var genreObj = new Object();
                genreObj.name = "<? echo $row['Type'] ?>";
                genreObj.level = <? echo $row['Level'] ?>;
    <?
                $parentID = $row['PrevID'];
                if($parent == null){ $parent = "0"; }
    ?>
                genreObj.parent = <? $parent ?>;
                arrGenre.push(genreObj);
            </script>
    <?
        }
    ?> 
```

我对 PHP 世界还很陌生，但非常感谢正确方向的观点。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:45:12.607

在 PHP 中构建一个类似于您想要的 JavaScript 对象的关联数组，然后[`json_encode()`](http://php.net/manual/en/function.json-encode.php)将其转换为 JSON 对象，然后您可以轻松地传递给 JavaScript。

您甚至可以执行以下操作：

```
<?php
// stuff
$resultObj = json_encode($row);
?>

<script type="text/javascript">
var genreObj = <?= $resultObj ?>;
</script> 
```

这不应该是您问题的完美解决方案，但希望它会给您一些想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T01:45:14.490

我认为

```
<? $row['Type'] ?> 
```

应该

```
<?= $row['Type'] ?> or
<? echo $row['Type'] ?> 
```

同样适用

```
<? $parent ?>; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T02:03:17.623

下面的代码没有经过全面测试，但基本思想是将所有值写入数组，然后将该数组转换为 json 对象。从那里将 json 对象分配给 jsonresults 变量。现在您可以通过 javascript 提取您需要的所有信息。

```
<?php

$result = mysql_query("call sp_getGenre()");
if($result === FALSE){
    die(mysql_error());
}
while($row = mysql_fetch_array($result)){
    $resultsarray = array("type"=> $row['type'], "level" => $row['Level'}, "previd" => $row['PrevID']);
    $jsonifiedresults = json_encode($resultsarray);
    ?>
            <script type="text/javascript">
                jsonresult = <? echo $jsonifiedresults; ?>;

                console.log(jsonresult.type);
                var genreObj = new Object();
                genreObj.name = jsonresult.type;
                genreObj.level = jsonresult.level;
                genreObj.parent = jsonreult.prevID;
                arrGenre.push(genreObj);
            </script>
<?php
        }
?> 
```

# ruby - 使用注入的数组中的前 2 个值

> ID：14783972
> 
> 赞同：0
> 
> 时间：2013-02-09T01:28:20.203
> 
> 标签：ruby, arrays

我正在尝试使用从该数组中获取前 2 个值`inject`，

```
a = [1, 2, 5, 7, 4, 9, 2]

b = a.inject(Array.new(2) {0}) {|r, e|
  if e > r[0]
    r[1] = r[0]
    r[0] = e
  end
} 
```

`'block in <main>': undefined method '[]' for nil:NilClass (NoMethodError)`但我不断收到错误消息`r[1] = r[0]`

我怎样才能改变它，以便`r[0]`代表 中的最大值`a`和`r[1]`第二大值？还是有更好的，更像红宝石的方式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-09T01:40:19.450

怎么样：

```
a.sort[-2, 2]
=> [7, 9] 
```

如果您需要相反的顺序（并使用`last(2)`来自@mu）：

```
a.sort.last(2).reverse
=> [9, 7] 
```

就目前`inject`而言，它总是要求从块中返回所谓的备忘录对象，以便在下一次循环迭代中可用。因此，这将修复您的代码：

```
b = a.inject([0, 0]) { |r, e|
  # Added fix from @Chuck
  if e > r[0] 
    r[0], r[1] = e, r[0] 
  elsif e > r[1] 
    r[1] = e 
  end
  r # <- add this line
} 
```

# ajax - jQuery：检查值是否在数组中，如果是，则删除，如果不是，添加

> ID：14783974
> 
> 赞同：12
> 
> 时间：2013-02-09T01:28:32.873
> 
> 标签：ajax, arrays, jquery, push

我正在尝试检查数组中是否已经存在值。如果数组中不存在该值，则应将其添加到数组中，如果该值已存在，则应将其删除。

```
var selectArr = [];
$('.media-search').mouseenter(function(){
    var $this = $(this);
    $this.toggleClass('highlight');
}).mouseleave(function(){
    var $this = $(this);
    $this.toggleClass('highlight');

}).on('click',function(){
    var dataid = $(this).data('id');

    if(selectArry){ // need to somehow check if value (dataid) exists.
    selectArr.push(dataid); // adds the data into the array
    }else{
    // somehow remove the dataid value if exists in array already
    }

}); 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-02-09T01:42:38.383

使用`inArray`方法查找值，使用`push`and`splice`方法添加或删除项目：

```
var idx = $.inArray(dataid, selectArr);
if (idx == -1) {
  selectArr.push(dataid);
} else {
  selectArr.splice(idx, 1);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-12T07:48:49.207

用于查找和添加/删除数组中的值的简单 JavaScript 程序

```
var myArray = ["cat","dog","mouse","rat","mouse","lion"]
var count = 0; // To keep a count of how many times the value is removed 
for(var i=0; i<myArray.length;i++) {
    //Here we are going to remove 'mouse'
    if(myArray[i] == "mouse") {
        myArray .splice(i,1);
        count = count + 1;
    }
}
//Count will be zero if no value is removed in the array
if(count == 0) {
    myArray .push("mouse"); //Add the value at last - use 'unshife' to add at beginning 
}

//Output
for(var i=0; i<myArray.length;i++) {
    console.log(myArray [i]); //Press F12 and click console in chrome to see output
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-12T07:27:00.450

```
 function AddingOffences() {

var sendingcountry = ary.filter((item) => {
  return (item.Offence.toLowerCase().indexOf($("#ddl_OffencesByLocation option:selected").val()) > -1);
})
if (sendingcountry == "") {

  if ($("#txtPriceByLocation").val() == "") {
    alert("Please select price")
  } else {

    $("#Div_OffenceListByLoction").append("<li id=" + $("#ddl_OffencesByLocation option:selected").val() + ">" + $("#ddl_OffencesByLocation option:selected").text() + "<span>" + $("#txtPriceByLocation").val() + " kr" + "</span><span onclick='RemoveOffence(" + $("#ddl_OffencesByLocation option:selected").val() + ")' > Remove</span></li>");
    pushToAry($("#ddl_OffencesByLocation option:selected").val(), $("#txtPriceByLocation").val());
  }
  } else {
    alert("Allready Exist");
  } 
```

}

# java - 为什么这两个java程序的输出不同

> ID：14783975
> 
> 赞同：3
> 
> 时间：2013-02-09T01:28:41.517
> 
> 标签：java, methods

```
public class Test {

    public static void change(char[] a){
        a[0] = '1';
        a[1] = '2';
    }

    public static void main(String args[]){
        char[] a = new char[]{'a','b'};

        change(a);

        System.out.println(a);
    }

} 
```

输出为 12

```
public class Test {

    public static void change(char[] a){
        a = new char[]{'1','2'};
    }

    public static void main(String args[]){
        char[] a = new char[]{'a','b'};

        change(a);

        System.out.println(a);
    }

} 
```

输出为 ab。我知道我遗漏了一些关于 java 传递方法参数的方式。我知道对对象的引用是按值传递的。但是，我无法将我的理解与这些程序的结果相协调。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-09T01:31:04.113

在版本“2”中，change 方法“什么都不做”，因为您将一个新数组分配给`a`，这是*本地（参数）变量* `a`。`a`这对分配给在 main 方法中声明的变量的数组没有影响。

`change()`当方法完成时，新数组超出范围并且不可访问（因此指定用于垃圾收集） 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-09T01:31:54.020

这是因为 Java 按值传递，而不是按引用传递。在引用的情况下，您复制引用。您可以修改引用后面的值（版本 1），但不能修改引用本身（版本 2）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-09T01:32:08.763

随着调用

```
a = new char[]{'1','2'}; 
```

所发生的只是方法的本地变量被分配了一个新的引用，这对仍然引用旧数组的 main 方法中`a`的变量没有任何影响。`a`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T01:38:41.097

因为 Java 通过**值**而**不是引用**在方法之间传递对象。在第一个示例中，您在 main 中实例化一个对象并将其传递给`change`，它仅通过设置值来更改它。在第二个示例中，您实际上在`change` (using `new`) 中重新实例化了它，因为您已经在主体中实例化了一次。`char[]`重新实例化的范围`change`仅是方法，因此当您返回调用它的 main 时，它将恢复到自己的实例，而不是本地使用的实例`change`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-09T01:30:58.437

第一个，您正在更改传入并由“a”引用的数组

第二个，您正在更改“a”引用的数组

有效地，你正在做的第二个

```
char[] original = new char[]{'a','b'};
// this is basically what your function call is doing from here....
char[] a = original;      // a is now also referencing the ab array
a = new char[]{'1','2'};  // now a is referencing a 1 2 array.
// then the function returns....and original is the same still 
```

所以 a 引用了一个新数组，而原始数组仍然引用了原始数组

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-09T01:34:21.490

发生这种情况是因为您传递数据的方式。在第一个示例中，数组已更改，因为您向 Change() 方法传递了数组的地址，并且该方法正在更改地址中的数据。

在第二个示例中，数组被传递，但是您正在初始化一个新数组，该数组声明新的内存空间并更改传入的地址。但是，这不会删除主中原始声明和初始化的 char[] 实例方法，因此当您打印出来时，它会打印出本地 char[] 而不是您尝试创建的新字符。

# ios - 通过 Xcode 中的 UITextField 从用户输入创建 NSMutable 数组

> ID：14783994
> 
> 赞同：-4
> 
> 时间：2013-02-09T01:31:35.917
> 
> 标签：ios, core-data, nsmutablearray, nsarray

我正在尝试创建一个数组，该数组将存储根据来自两个 UITextField 的用户输入计算的浮点数。通过搜索网络，我认为我应该使用 NSMutableArray。理想情况下，数组不会设置大小，因为用户输入更多我希望它扩展的值，这可能吗？

这些值需要保存在应用程序中，即使它已关闭。据我所知，有两个选项，CoreData 或存储在 .plist 文件中。我想做两者中更容易的，因为我仍然是 iOS 开发的初学者。

如果有人可以帮助我并指出正确的方向来设置这个数组并保存数据，我将非常感激。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T01:46:20.700

这里写的真的很多，所以你最好看教程：[http ://www.youtube.com/watch?v=F6fEolemTts&list=UUy-pGo1UB-rXTO21OXTt2wg&index=1](http://www.youtube.com/watch?v=F6fEolemTts&list=UUy-pGo1UB-rXTO21OXTt2wg&index=1)

这真的很好，你会明白你想要的一切。

# c++ - 关于动态分配的数组和指针的作业帮助

> ID：14783999
> 
> 赞同：2
> 
> 时间：2013-02-09T01:32:04.227
> 
> 标签：c++

这是我的问题：

假设您的程序包含创建动态分配数组的代码，如下所示：

```
int * entry;
entry = new int [10]; 
```

这样指针变量条目就指向这个动态分配的数组。编写代码，用键盘输入的十个数字填充这个数组。

这本书我已经看了两天了，仍然无法弄清楚这一点。

这是我正在尝试的代码，但它在第 17 行给了我一个错误，上面写着：没有运算符匹配这些操作数“<<”。我检查了 msdn 和其他几个网站，但我无法弄清楚。任何帮助，将不胜感激。

```
#include <iostream>

using namespace std;

int main()
{
int * entry;
entry = new int [10];
int array_size = 10;
int num;
for(int i = 0; i< array_size; i++)
    entry[i] = i;

for(int i = 0; i < array_size; i++)
{
    cout << "Enter an int into the array: " << endl;
    cin << entry[i] << endl;
}

return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T01:38:50.047

您的流运算符方向错误：使用`cin >> entry[i];`. 记住这一点的一个好方法是将运算符视为箭头：对于输出，您将要输出的内容指向`cout`，对于输入，您将值`cin`指向应该存储输入的变量。

默认情况下，`cin >> ...`会自动处理空格（空格、制表符、换行符），因此两者都不需要`>> endl`。

最后，前面的循环设置`entry[i] = i;`在您当前的程序中没有做任何有用的事情，因为当用户输入他们的值时，所有条目都会被覆盖。