# StackOverflow 问答 15101000-15101999

# iphone - 知道由于 Dismissal（不是 segue）而出现 ViewController

> ID：15101000
> 
> 赞同：1
> 
> 时间：2013-02-26T22:51:42.003
> 
> 标签：iphone, ios, ipad, segue, dismiss

我试图弄清楚如何在我的 rootViewController 中获取一个刚刚自行解散的类。我有几个选项可以解散回我的 rootViewController，我需要知道它是否来自一个实例，以便相应地更改一些 UI。

我正在寻找类似的东西，`[self presentingViewController]`除了当 viewController 因为解雇而不是 segue 而出现时。有没有内置的方法来抓取这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T06:01:38.487

我基本上通过跟踪我是否访问了我担心解雇的一个视图控制器来解决这个问题。那样的话，我只是在我 segue 之前在 viewController 中设置一个属性，所以我已经知道当我返回时我需要处理 UI 更改。感谢您对 unwind segues 的评论。我肯定会在未来很快实施它们！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:53:53.793

*更新*

这个答案中的所有内容都是旧消息 - 从 XCode 4.5 开始，我们可以使用展开 segues 来返回任何以前的 viewController 并触发该控制器中的展开方法。（感谢@rdelmar）

[Unwind segues 有什么用，你如何使用它们？](https://stackoverflow.com/questions/12561735/what-are-unwind-segues-for-and-how-to-use-them)

* * *

*旧方式/代码方式..理想情况下涉及委托以实现特定方法*

当一个类自行解散时，你不能抓住它，因为它被……解散了。*你需要在它被解雇之前*持有它，然后知道解雇。

稍微详细说明一下，班级通常不会解雇自己，他们自己的班级会解雇自己。这里的混淆方法可能是 UIViewController 方法：

```
- (void) dismissViewControllerAnimated: 
```

这是一个简写

```
- (void) [[self presentingViewController] dismissViewControllerAnimated:completion:nil] 
```

呈现的 viewController 具有一个属性，该属性`presentedViewController`会保留该被解除的对象 - 直到它被解除。当presentingViewController 关闭时，它会将其`presentedViewController`属性重置为nil。但是您始终可以选择在解雇事件之前将该引用复制到另一个（强/保留）属性中，并在解雇事件之后对其进行询问。

引用苹果：

> “如果您想保留对接收者呈现的视图控制器的引用，请在调用 [dismissViewControllerAnimated:completion:] 之前获取 presentViewController 属性中的值。”

# html - 如何让我的 html 占据整个浏览器窗口？

> ID：15101001
> 
> 赞同：0
> 
> 时间：2013-02-26T22:51:43.407
> 
> 标签：html, css, background-image

如果我的浏览器窗口足够大，网页就可以了。如果它更小并且我向右滚动，我的背景不会水平穿过整个浏览器窗口。他们停在网页内。我已将主体背景设为蓝色，以便您可以看到背景的结束位置。我想让实际的内容和背景图片在浏览器窗口结束的地方结束并且没有蓝色。该网站位于 avidest.com/schneer。这是CSS：

```
.main {width:100%; padding:0; margin:0 auto; min-width: 1020px;}
.header { background:url(images/slider_bgpng200.png); background-repeat: repeat-x; padding:0; margin:0 auto; width: 100%; }
.header .headertop{width: 100%; background: #d3e5e8; height: 30px;}
.block_header {margin:0 auto; width:1200px; padding:0; border:none; }
.slider { background: transparent; margin:0 auto; padding:0; height:420px;}  
.slider .gallery { margin:0 auto; width:980px; height:420px; padding:0;} 
```

这是html：

```
<div class="header">
   <div class="headertop"> 
       <div class="header_text"><a href="#">Email</a> | <a href="#">Client Login</a> </div>
   </div>
   <div class="block_header">
       <div class="slider">
          <div class="gallery">
          </div>
      </div>
   </div>
</div> 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T22:59:44.783

你有超出`.main`div 的内容。
如果你添加你的，`div.main { overflow: hidden; }`你会看到它按预期工作，因为没有什么东西把它推到比预期更大的宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T22:54:16.743

对于 100% 的高度，您还需要 html 和 body 标签为 100%

将此添加到您的 CSS

```
html, body { height: 100%; width: 100%; } 
```

然后，您必须从 100% x 100% 包装 div 中创建一个假背景，并将您的背景放置在其中以获得您正在寻找的效果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:05:11.687

为什么你有 .main 类？你是不是忘记了一些元素？

在您的`.header`中，您设置背景和宽度 100%。所以具有 .header 类的元素的宽度将是其父元素的 100%。的父元素是`<div class="header">`什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T23:06:59.857

我看到你的宽度有很大的差异。我认为“main”“header”“block_header”都是相同的宽度。另请注意，100% 不是父元素的 100%，它是窗口大小的 100%，尤其是当父元素大于窗口时。将宽度设置为确定的数字。如果您希望内容填满用户屏幕，请先将父元素设置为 100%，然后可以将所有子元素设置为 100% 以适应父元素的宽度。

# c# - 传递指向类属性的指针

> ID：15101006
> 
> 赞同：3
> 
> 时间：2013-02-26T22:52:01.923
> 
> 标签：c#, properties, arguments, parameter-passing

**编辑：** 这是一个示例程序，我知道 linq 中有一个 sum 运算符。但是，我试图专门询问如何将指针传递给属性以对其进行复杂的处理，不一定是求和算法。

假设我有这样的课程：

```
class Point
{
    double x {get; set;}
    double y {get; set;}
} 
```

在我的主程序中，我有 2 个功能。

```
double function1(List<Point> PointList)
{
   double sum = 0.0;
   foreach(Point p in PointList)
   {
      sum += p.x;
   }       
   return sum;
}

double function2(List<Point> PointList)
{
   double sum = 0.0;
   foreach(Point p in PointList)
   {
      sum += p.y;
   }       
   return sum;
} 
```

这些函数完全相同，除了一个是对 X 值求和，另一个是对 Y 值求和。由于这些非常相似，我想将它们组合起来，以便我基本上传入那个点列表，以及一些东西来确定我想要进行基于 X 或 Y 的计算。

我知道我可以放入一个 switch 语句并根据枚举告诉它是 X 还是 Y，或者定义为告诉它执行 X 或 Y 的数字。如果这是一个正常的函数，我假设我可以使用 s 委托，但这是一个属性，所以我不确定它是如何翻译的。

那么我如何将这些功能组合成类似的东西：

```
double bothFunctions(List<Point> PointList, var propertyToUse)
{
   double sum = 0.0;
   foreach(Point p in PointList)
   {
      sum += p.propertyToUse;
   }       
   return sum;
} 
```

其中 propertyToUse 指向 X 或 Y。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T22:59:57.210

当前的解决方案效果很好，但它们假设您的操作是`sum`，或者您将只有两个可能的属性（`X`和`Y`）。

如果你想要更多的自由，你可以这样做：

```
double function(List<Point> PointList, Func<Point, double> selector)
{
    double sum = 0.0;
    foreach (Point p in PointList)
    {
        sum += selector(p);
    }
    return sum;
} 
```

然后你这样称呼它：

```
double sumX = function(PointList, p => p.X);
double sumY = function(PointList, p => p.Y); 
```

您将能够编写更复杂的选择器，例如：

```
double sumXY = function(PointList, p => p.X + p.Y); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T22:55:18.020

您应该考虑使用[`Enumerable.Sum`](http://msdn.microsoft.com/en-us/library/bb549150.aspx)扩展方法而不是编写自己的方法。

```
var sumX = pointList.Sum(item => item.X);
var sumY = pointList.Sum(item => item.Y); 
```

`using System.Linq;`如果您的代码文件中尚未出现，您将需要添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T22:55:08.450

我觉得你把事情弄得太复杂了。您可以使用这样的方法：

```
double bothFunctions(List<Point> PointList, bool sumX)
{
   double sum = 0.0;
   foreach(Point p in PointList)
   {
      if (sumX)
          sum += p.x;
      else
          sum += p.y;
   }       
   return sum;
} 
```

或者只使用 LINQ：

```
var ySum = pointList.Sum(e => e.y);
var xSum = pointList.Sum(e => e.x); 
```

# abap - 使用 Zeconfig_var 表中的值填充参数

> ID：15101007
> 
> 赞同：1
> 
> 时间：2013-02-26T22:52:10.100
> 
> 标签：abap, dropdownbox

我有以下选择参数：

```
PARAMETERS: p_ver(2)   AS LISTBOX VISIBLE LENGTH 5. 
```

我想用 ZCONFIG_VAR 表中的结果填充它。

我会在什么时候这样做。选择屏幕输出、选择开始或其他。我试图让用户能够决定他们想要调用哪个版本的 Web 服务。配置表对于不同的版本会有不同的 url。

我看过这个[答案](https://stackoverflow.com/questions/8847534/how-to-set-values-in-the-listbox)，提供的教程对我来说没有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T01:12:03.357

我会在 INITIALIZATION 活动中这样做

但是，创建一个搜索帮助并使用以下命令将其分配给 p_ver 可能会更容易：

```
parameters: p_ver(2) visible lenghth 5 MATCHCODE OBJECT zshelpname. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T05:45:19.123

Esti 是对的，您可能希望在`INITIALIZATION`.

但是要填充列表框参数，您需要将调用`VRM_SET_VALUES`放入`AT SELECTION-SCREEN OUTPUT`.

# perl - 为什么我在尝试使用 Perl 的 Archive::Extract 解压缩时得到一个 ARRAY(0x7fd5c22f7cd8) 的文件名？

> ID：15101013
> 
> 赞同：2
> 
> 时间：2013-02-26T22:52:31.047
> 
> 标签：perl, unzip

我在 Mac 10.5.7 上使用 Perl 5.12。我有一个 JAR 文件，我希望将其解压缩，然后处理与文件模式匹配的文件。我无法弄清楚如何迭代解压缩的结果。我有 ...

```
### build an Archive::Extract object ###
my $ae = Archive::Extract->new( archive => $dbJar );

### what if something went wrong?
my $ok = $ae->extract or die $ae->error;

### files from the archive ###
my @files   = $ae->files;

for (@files) {
    print "file : $_\n"; 
```

但是循环只返回一件事——“ARRAY(0x7fd5c22f7cd8)”。我知道存档中有很多文件，所以我很好奇我在这里做错了什么。-戴夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T22:58:46.300

`$ae->files`返回一个数组*引用*，而不是一个数组。试试这个：

```
my $files = $ae->files;

for(@$files) {
   print "file : $_\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T01:03:31.117

来自[Archive::Extract](http://perldoc.perl.org/Archive/Extract.html#%24ae-%3efiles)的 Perldoc ：

> ### $ae->文件
> 
> 这是一个***数组 ref***，包含存档中的所有路径。有关详细信息，请参阅 extract()。

方法返回的不是数组和散列而是对它们的引用是很常见的。将数组和散列的引用作为参数的方法也很常见。这是因为在方法和调用之间来回传递的数据更少。

你可以这样做：

```
for my $file ( @{ $ae->files } ) {
    print "$file\n";
} 
```

`@{...}` *取消引用*引用并使其成为一个简单的数组。`@{...}`是的，您可以像我一样放置返回数组引用的方法调用。

如前所述，一个非常有用的包是[Data::Dumper](http://perldoc.perl.org/Data/Dumper.html)。这可以作为参考并向您展示其中包含的数据结构。它还会告诉您该数据结构是否代表一个受*祝福的对象*，这可能是一个线索，表明您可以使用一种方法来提取数据。

例如，想象一个名为*Company*的对象。`Employee` *其中一种方法可能是 $company->Employees ，它返回对objects*的数组引用。你可能没有意识到这一点并发现你得到了类似`ARRAY{0x7fd5c22f7cd8)`返回的东西，通过 Data::Dumper 推送它可能会帮助你看到结构：

```
use Data::Dumper;
use Feature qw(say);

use Company;

[...]

@employee_list =  $company->Employees;

# say join "\n", @employee_list;   #Doesn't work.
say Dumper @employee_list; 
```

这可能会打印：

```
 $VAR = [
    {
        FIRST => 'Marion',
        LAST  => 'Librarian',
        POSITION => 'Yes Man',
    }  Employee,
    {
        FIRST => 'Charlie',
        LAST  => 'australopithecus`,
        POSITION => 'Cheese Cube Eater'
    }  Employee,
] 
```

您不仅看到这是一个哈希引用数组，而且这些也是对象`Employee`。因此，您应该使用`Employee`类中的一些方法来解析您想要的信息。

```
use Feature qw(say);
use Company;
use Employee;

[...]
for my $employee ( @{ $company->Employees } ) {
    say "First Name: " . $employee->First;
    say "Last Name: " . $employee->Last;
    say "Position: " . $employee->Position;
    print "\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T22:56:53.440

尝试这样做：

```
use Data::Dumper;
print Dumper @files; 
```

这样，您将看到@files 的内容。

如果您不知道如何处理您的数据结构，请粘贴`Dumper`此处的输出

# ubuntu - 星号答录机检测

> ID：15101015
> 
> 赞同：1
> 
> 时间：2013-02-26T22:52:35.480
> 
> 标签：ubuntu, asterisk

我的应答机检测检测到应答机是人。我在播放消息之前播放了 7 秒的铃声，它只是提示用户按下一个键，然后处理 AMD

这是我的 AMD.conf

```
;
; Answering Machine Detection Configuration
;

[general]
initial_silence = 2250          ; Maximum silence duration before the greeting.
                                ; If exceeded then MACHINE.
greeting = 1500                 ; Maximum length of a greeting. If exceeded then MACHINE.

after_greeting_silence = 1250   ; Silence after detecting a greeting.
                                ; If exceeded then HUMAN
total_analysis_time = 5000      ; Maximum time allowed for the algorithm to decide
                                ; on a HUMAN or MACHINE
min_word_length = 100           ; Minimum duration of Voice to considered as a word
between_words_silence = 50      ; Minimum duration of silence after a word to consider
                                ; the audio what follows as a new word
;maximum_number_of_words = 3    ; Maximum number of words in the greeting.
maximum_number_of_words = 8     ; Maximum number of words in the greeting.
                                ; If exceeded then MACHINE
silence_threshold = 256 
```

在我的日志中，当我让它转到语音信箱时，这就是我所看到的：

```
-- AMD: initialSilence [2250] greeting [1500] afterGreetingSilence [1250] totalAnalysisTime [5000] minimumWordLength [100] betweenWordsSilence [50] maximumNumberOfWords [8] silenceThreshold [256]
-- AMD: Word detected. iWordsCount:1
-- AMD: Changed state to STATE_IN_SILENCE
-- AMD: Word detected. iWordsCount:2
-- AMD: Changed state to STATE_IN_SILENCE
-- AMD: Word detected. iWordsCount:3
-- AMD: Changed state to STATE_IN_SILENCE
-- AMD: Word detected. iWordsCount:4
-- AMD: Changed state to STATE_IN_SILENCE
-- AMD: HUMAN: silenceDuration:1260 afterGreetingSilence:1250
-- Executing [s@play-message-list:16] NoOp("SIP/xxxx.com_xxxx", ""AMD STATUS IS :"HUMAN"...CAUSE:"HUMAN-1260-1250") in new stack 
```

它可以在没有铃声的情况下工作，留下语音邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T17:04:13.317

不幸的是，应答机检测不是精确的科学，而是大量的猜测。结果在很大程度上取决于答录机的问候语以及随机人员接听电话的方式。一个人通常在拿起电话后只会说几句话，比如“你好”或“这是约翰”，而自动系统（语音邮件或 ACD）会在接听后立即说出完整的问候语。因此，像“嗨，给我留言*哔*”这样的语音邮件问候很有可能被检测为人类，而真正的服务员会回答“早上好，谢谢您致电 ACME Inc，我该如何转接您的电话？” 可能会被检测为机器。

您的呼叫流程或 AMD 设置没有任何问题。在您的日志中，看起来“人”的决定是基于仅检测到 4 个单词，然后是超过 1250 秒的沉默，并且基于 after_greeting_silence 设置触发的决策算法。现在想象一个语音邮件问候语慢慢地说，“你好，谢谢你的来电。[2 秒停顿]。没有人可以接听你的电话......”等等。您的设置将无法正确检测到这种特殊情况。但正如我最初所说，没有“通用”设置可以解释这个世界上的任何问候和人类回答模式。

# ruby-on-rails - bash_profile：没有这样的文件或目录

> ID：15101024
> 
> 赞同：0
> 
> 时间：2013-02-26T22:52:51.893
> 
> 标签：ruby-on-rails, bash

**我得到这个提示：**

```
-bash: source/Users/sean/.bash_profile: No such file or directory
-bash: /Users/sean/.bash_profile: line 3: syntax error near unexpected token `newline'
-bash: /Users/sean/.bash_profile: line 3: `PS1=\w >'
Seans-MacBook-Pro:~ sean$ source .bash_profile
-bash: source/Users/sean/.bash_profile: No such file or directory
-bash: .bash_profile: line 3: syntax error near unexpected token `newline'
-bash: .bash_profile: line 3: `PS1=\w > 
```

**当我打开 .bash_profile 这就是它所说的**

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source/Users/seanlanning/.bash_profile "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function*
PS1=\w >
PS1='\w >' 
```

**不知道我搞砸了什么以及 .bash_profile 应该是什么样的**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:01:19.210

在行

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source/Users/seanlanning/.bash_profile "$HOME/.rvm/scripts/rvm" # Load RVM into a shell session *as a function* 
```

你需要一个空间`source`和`/Users...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T22:56:36.383

检查以确保您没有合并行：

`export PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/bin:/sbin:/usr/sbin`

`[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" # Load RVM function`

**什么操作系统**？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T22:57:31.753

这条线

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source/Users/seanlanning/.bash_profile "$HOME/.rvm/scripts/rvm" 
```

应该

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && source "$HOME/.rvm/scripts/rvm" 
```

# tinymce - 测试对象是否为 TinyMCE 编辑器

> ID：15101028
> 
> 赞同：0
> 
> 时间：2013-02-26T22:53:00.480
> 
> 标签：tinymce

如何测试对象是否是 TinyMCE 编辑器实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T08:57:17.683

根据您要检查的对象类型以及此检查循环的时间`tinymce.editors`可能不够。如果你想检查一个对象是否是一个 tinymce 编辑器对象并且没有初始化的 tinymce 编辑器`tinymce.editors`，那么即使你的对象可能是一个有效的 tinymce 编辑器对象（没有活动的编辑器！），它也会是一个空数组。

如果你有一个，`object`你可以测试这个对象是否具有以下属性。这应该足够了：

```
if(object.editorCommands && object.editorId && object.execCommands && object.plugins) return true; 
```

如果这不适合您的用例，您将需要提供更多信息。

# vba - 在excel中过滤后获取前100行的宏

> ID：15101035
> 
> 赞同：0
> 
> 时间：2013-02-26T22:53:19.037
> 
> 标签：vba, excel

我有 600 个 .txt 文件 - 但只有当作为 excel 文件打开时，它们才会显示出良好的结构。它们中的每一个都由三列和大约 18000 行组成。

我的任务是打开它们中的每一个，按 C 列中的值降序对它们进行排序，取前 100 个，将它们复制到单独的工作表中，并将第一行加粗（在新工作表中复制的 100 个中的第一行）。因此，最终结果将是一个工作表，该工作表收集了每个文件中所有最大 100 个值，其中粗体行使边界清晰。

我决定用宏来完成工作，但由于我没有 VBA 编程经验，所以我用谷歌搜索并遇到了很多问题，但最终在采用了一些其他宏（主要是通过尝试和失败方法）后，我想出了解决方案。它工作得很好，而且确实有效。但问题是我不明白这段代码的行为如何，现在我需要做其他事情，我被卡住了。

我再次从相同的 600 个 .txt 文件开始，我需要打开它们中的每一个，但这次按升序对它们进行排序，过滤它们以便我只剩下那些高于平均水平的文件，然后取前 100 行，复制它们在单独的工作表中并将第一个加粗。

我不知道如何做到这一点。我最大的问题是过滤后，第一行实际上不是第 1 行，而是其他一些取决于值的值，所以我不能将范围指定为 A2:C101。

感谢您为完成此任务提供任何建议或解决方案。

**编辑让自己清楚：**主要问题是，当我过滤数据时，我不知道获取前 100 行的方式，因为过滤后的行数（excel 标签）不像排序 1、2、3 后那样，但它们取决于在值上，例如我可以得到类似 5,6,8,21... 所以我的问题是如何取这个范围？

并且适用于第一个任务的代码是（我知道它很乱，但我能做到最好）：

```
Sub MergeAllWorkbooks()
    Dim MyPath As String, FilesInPath As String
    Dim MyFiles() As String
    Dim SourceRcount As Long, FNum As Long
    Dim mybook As Workbook, BaseWks As Worksheet
    Dim sourceRange As Range, destrange As Range
    Dim rnum As Long, CalcMode As Long

    Dim isEmpty As String
    isEmpty = "null"

    ' Change this to the path\folder location of your files.
    MyPath = "C:\Excel"

    ' Add a slash at the end of the path if needed.
    If Right(MyPath, 1) <> "\" Then
        MyPath = MyPath & "\"
    End If

    ' If there are no Excel files in the folder, exit.
    FilesInPath = Dir(MyPath & "*.txt")
    If FilesInPath = "" Then
        MsgBox "No files found"
        Exit Sub
    End If

    ' Fill the myFiles array with the list of Excel files
    ' in the search folder.
    FNum = 0
    Do While FilesInPath <> ""
        FNum = FNum + 1
        ReDim Preserve MyFiles(1 To FNum)
        MyFiles(FNum) = FilesInPath
        FilesInPath = Dir()
    Loop

    ' Set various application properties.
'    With Application
'        CalcMode = .Calculation
'        .Calculation = xlCalculationManual
'        .ScreenUpdating = False
'        .EnableEvents = False
'    End With

    ' Add a new workbook with one sheet.
    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)
    rnum = 1

    ' Loop through all files in the myFiles array.
    If FNum > 0 Then
        For FNum = LBound(MyFiles) To UBound(MyFiles)
            Set mybook = Nothing
            On Error Resume Next
            Set mybook = Workbooks.Open(MyPath & MyFiles(FNum))

            On Error GoTo 0

            Dim c As Range
            Dim SrchRng As Range
            Dim SrchStr As String
            SrchStr = "null"

            Set SrchRng = mybook.Worksheets(1).Range("C1:C18000")
                Do
                Set c = SrchRng.Find(SrchStr, LookIn:=xlValues)
                If Not c Is Nothing Then c.EntireRow.Delete
                Loop While Not c Is Nothing

            If Not mybook Is Nothing Then
                On Error Resume Next

                    mybook.Worksheets(1).Sort.SortFields.Clear
                    mybook.Worksheets(1).Sort.SortFields.Add Key:=Range("C1:C18000") _
                    , SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal

                 ' Change this range to fit your own needs.
                With mybook.Worksheets(1)
                    Set sourceRange = .Range("A2:C101")
                End With

                If Err.Number > 0 Then
                    Err.Clear
                    Set sourceRange = Nothing
                Else
                    ' If source range uses all columns then
                    ' skip this file.
                    If sourceRange.Columns.Count >= BaseWks.Columns.Count Then
                        Set sourceRange = Nothing
                    End If
                End If

                On Error GoTo 0
                If Not sourceRange Is Nothing Then

                    SourceRcount = sourceRange.Rows.Count

                    If rnum + SourceRcount >= BaseWks.Rows.Count Then
                        MsgBox "There are not enough rows in the target worksheet."
                        BaseWks.Columns.AutoFit
                        mybook.Close savechanges:=False
                        GoTo ExitTheSub
                    Else

                        ' Copy the file name in column A.

                       ' With sourceRange
                           ' BaseWks.Cells(rnum, "D").Font.Bold = True
                           ' BaseWks.Cells(rnum, "D"). _
                                    Resize(.Rows.Count).Value = MyFiles(FNum)
                       ' End With

                        ' Set the destination range.

                        Set destrange = BaseWks.Range("A" & rnum)

                With mybook.Worksheets(1).Sort
                .SetRange Range("A1:C18000")
                .Header = xlGuess
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
                End With

                        ' Copy the values from the source range
                        ' to the destination range.
                        With sourceRange
                            BaseWks.Cells(rnum, "A").Font.Bold = True
                            BaseWks.Cells(rnum, "B").Font.Bold = True
                            BaseWks.Cells(rnum, "C").Font.Bold = True
                            'MsgBox (BaseWks.Cells.Address)
                            If ActiveCell.Text = isEmpty Then
                            ActiveCell.Offset(0, 1) = 1
                            ActiveCell.Offset(1).EntireRow.Insert
                            ActiveCell.Offset(1, 1) = 0
                            End If
                            Set destrange = destrange. _
                                            Resize(.Rows.Count, .Columns.Count)
                        End With
                        destrange.Value = sourceRange.Value

                        rnum = rnum + SourceRcount
                    End If
                End If
                mybook.Close savechanges:=False
            End If

        Next FNum
        BaseWks.Columns.AutoFit
    End If

ExitTheSub:
    ' Restore the application properties.
    With Application
        .ScreenUpdating = True
        .EnableEvents = True
        .Calculation = CalcMode
    End With
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:06:51.440

问题是排序会自动插入标题。您应该通过将 Header 参数设置为*xlNo*来指定没有标题：

```
 With mybook.Worksheets(1).Sort
        .SetRange Range("A1:C18000")
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With 
```

然后您可以将 sourceRange 指定为 A1:A100。

您是否也尝试过在工具菜单下使用 Excel 中的宏记录器？这将极大地帮助您为您提供简洁的代码并了解它的工作原理，因此您可以使用这些知识来简化您的代码。

**编辑：**

首先使用复制和粘贴获取过滤后的数据：

```
mybook.Worksheets(1).Range("A1:A18000").SpecialCells(xlVisible).Copy
destrange.PasteSpecial xlPasteValues 
```

然后删除留下 100 行：

```
Dim lLastRow as long
lLastRow = BaseWks.Range("A" & CStr(.Rows.Count)).End(xlUp).Row
'Check we have rows to delete
If lLastRow >= rnum Then
    BaseWks.Range("A" & CStr(rnum + 100) & ":A" & CStr(lLastRow)).EntireRow.Delete
End If 
```

# r - 应用于 rep() 的向量上的 join 或 outer()

> ID：15101038
> 
> 赞同：1
> 
> 时间：2013-02-26T22:53:32.923
> 
> 标签：r

我以为这会很容易，但结果却非常困难。这是一个简单的问题：我有一个名称向量：

```
[1] David    David    David    Nathan   Holly    Holly    Holly    Holly   
[9] Holly    Sue      Sue      Sue      Sue      Sue      Rene     Michelle
[17] Michelle Michelle Jennie   Jennie   Jennie   Jennie 
```

我想制作一个索引向量，以便每个名称都获得相同的索引：

```
[1] 1 1 1 2 3 3 3 3 3 4 4 4 4 4 5 6 6 6 7 7 7 7 
```

我得到了每个名字的号码

```
bar <- ddply(df, .(Rater.Name), summarize, rater.n=sum(!is.na(Rater.Name))) 
```

我试过了

```
lapply(bar$Rater.Name, rep(1:7, bar$rater.n)) 
```

以及其他各种东西，例如outer（），by（）等。没有奏效。我最终使用了一个笨拙的 for 循环，但似乎应该有一个更像“R-like”的方式来做到这一点。任何人都可以提出一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T22:56:37.600

您正在寻找`factor`：

```
as.numeric(factor(x))

# [1] 1 1 1 5 2 2 2 2 2 7 7 7 7 7 6 4 4 4 3 3 3 3 
```

这个默认按字母顺序排列。如果您不希望这样做（例如：`2`而不是`5`for `Nathan`...），请执行以下操作：

```
as.numeric(factor(x, levels=x[!duplicated(x)]))
# [1] 1 1 1 2 3 3 3 3 3 4 4 4 4 4 5 6 6 6 7 7 7 7 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T02:08:53.590

关于 using ，我没有什么特别负面的说法`factor`，但是您可以通过查看以下内容来学习一个额外的技巧和一个非常有用的功能`match`：

```
> dat <- scan(what="")
1:  David    David    David    Nathan   Holly    Holly    Holly    Holly   
9:  Holly    Sue      Sue      Sue      Sue      Sue      Rene     Michelle
17:  Michelle Michelle Jennie   Jennie   Jennie   Jennie  
23: 
Read 22 items
> match(dat, unique(dat))
 [1] 1 1 1 2 3 3 3 3 3 4 4 4 4 4 5 6 6 6 7 7 7 7 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T22:59:09.920

这是首先将其转换为因子的技巧：

```
> x <- c('David', 'David', 'Lena', 'David')
> as.factor(x)
[1] David David Lena  David
Levels: David Lena
> y <- as.factor(x)
> y
[1] David David Lena  David
Levels: David Lena
> as.numeric(y)
[1] 1 1 2 1 
```

# r - R内存限制警告与“无法分配......”

> ID：15101045
> 
> 赞同：11
> 
> 时间：2013-02-26T22:54:05.870
> 
> 标签：r

内存警告会影响我的 R 分析吗？

在 RI 中运行大型数据分析脚本时，会收到如下警告：

> 在“...”中达到*_* __Mb 的总分配：请参阅帮助...

但是我的脚本继续没有错误，只是警告。对于其他数据集，我收到如下错误：

> 错误：无法分配大小为 ___Mb 的向量：

我知道这个错误会破坏我的数据分析，但是仅仅收到警告有什么问题吗？我没有注意到我的数据集中有任何遗漏，但它非常大，我没有很好的方法来检查所有内容。我分配给内存的内存为 18000Mb，无法合理分配更多。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-02T23:45:01.697

早在[R 2.5.1 新闻](http://cran.r-project.org/bin/windows/base/old/2.5.1/CHANGES.R-2.5.1)中，我发现了对内存分配警告的引用：

> `malloc.c`已更新至 2.8.3 版。此版本的分配策略略有不同，并且在接近地址空间限制时可能会更好地工作，但可能会在成功分配之前发出更多关于达到总分配的警告。

基于这个注释，我假设（没有任何内部实现的高级知识）当 R ( `malloc.c`) 中的内存分配调用尝试分配内存失败时会给出警告。多次尝试分配内存，可能使用不同的方法，也可能调用垃圾收集器。只有当`malloc`相当确定*不能*进行分配时才会返回错误。

警告不会危及现有的 R 对象。他们只是通知用户 R 接近计算机内存的限制。

（我希望有更多知识的用户可以确认这一点......）

# sql - 获取 Excel VBA MS Access 查询以追加或显示查询的数组？

> ID：15101048
> 
> 赞同：0
> 
> 时间：2013-02-26T22:54:19.067
> 
> 标签：sql, excel, vba

我正在尝试使用 Excel 查询 MS Access (2007-2010) 数据库并将查询打印到我的电子表格中。

下面的代码仅将字段标题打印到指定的单元格中，并且不打印所选字段中的其他数据。我哪里错了？提示等欢迎。

```
 Option Explicit

    ' Add reference to Microsoft ActiveX Data Objects Lib

    Public Sub main(): On Error GoTo Err_handler

        Dim cn As ADODB.Connection
        Set cn = New ADODB.Connection

    'open DB connection

        cn.ConnectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=Databaselocation
        cn.Open

        Dim rs As ADODB.Recordset
        Set rs = New ADODB.Recordset

      'Query Stuff

        rs.ActiveConnection = cn
        rs.Open "SQL Query here;"

    'does something
        Dim fld As ADODB.Field
        Dim rng As Range
        Set rng = [a2]

        For Each fld In rs.Fields
            rng.Value = fld.Name
            Set rng = rng.Offset(0, 2)
        Next fld

        Set rng = rng.Offset(2, -rs.Fields.Count)
        rng.CopyFromRecordset rs

    ' closes db connection

        rs.Close
        cn.Close
        Set rs = Nothing
        Set cn = Nothing

        Exit Sub

        Err_handler:
            MsgBox Err.Description

        End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:56:57.340

您还必须在 rs (ADODB.Recordset) 对象的 Rows 中循环。使用`MoveNext`方法移动到下一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:51:44.207

您希望在显示列名时一次跳过一列，而不是两列，因为 rng.CopyFromRecordset 方法将输出没有间隙的记录集。

```
Set rng = rng.Offset(0, 1) 
```

我测试了您的代码，它确实适用于该更改。

# c++ - 代码分析在 VS 2010 中不起作用

> ID：15101056
> 
> 赞同：0
> 
> 时间：2013-02-26T22:54:34.360
> 
> 标签：c++, visual-studio-2010, analysis

我使用 VS2010 创建了一个控制台应用程序，如下所示

```
int test(int i)
{   
if ( i == 0 )
    return 0;
else
    return 1;
int j = 2;
j++;

return j;
}

void deadCode(char * pa)
{
 printf("%s", pa);
}

int _tmain(int argc, _TCHAR* argv[]) 
{
    test(2);
    return 0;
} 
```

我检查了“在构建时为 C/C++ 启用代码分析”并选择规则集“Microsoft 所有规则”，当我构建项目时，我得到了

1>运行代码分析：

1> 运行代码分析...

1> 代码分析完成 -- 0 个错误，0 个警告

我预计 test() 中粗体部分会出现“CA1804”警告，应该为死代码 deadCode() 显示另一个警告。

我的问题是为什么代码分析没有发现缺陷？我还尝试创建仅启用 CA1804 警告的规则集，但结果与上述相同（Microsoft 所有规则）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:59:22.950

*   未使用的函数不是“死代码”。想象一下，您正在编写一个库——它很可能向其用户公开它自己不使用的函数。
*   至于 CA1804，我只能做假设：大概分析不够深入，无法创建完整的控制流图，并注意到无法访问`if/else`块之后的代码。但即使它进行了全面分析，我也希望块`test()`之后的部分出现“死代码”警告`if`，而不是“未使用的本地”警告 - 如果代码可以访问，`j`将被使用。

# java - The difference between passing query params in a webservice

> ID：15101062
> 
> 赞同：1
> 
> 时间：2013-02-26T22:55:02.957
> 
> 标签：java, ajax

What is the difference between passing query params as `/cars/id/toyota` vs `/cars?id=toyota` in a webservice?

Is one REST vs other web service type?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T21:46:50.057

Passing parameter in Rest service in the form of Url or query string, both have different significance. In simple words

1.  `/cars/id/toyota` in this toyta is variable and your service expecting something after `id/{variablename}` otherwise it gives an error (endpoint not found). So in this case your variable became mandatory.

2.  `/cars?id=toyota` in this case your query string (Id) becomes optional. So use query string whenever you want to make that variable optional. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T22:58:21.850

Nothing, obviously–it all depends on how the consuming service expects to retrieve parameters.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:01:27.690

It depends on the receiving party (your web server and the framework you use on that web-service). Both or neither could conceivably be REST web-services, depending on your implementation.

Conceptually, the difference lies in the path from the web-server root (`/`) and parameters:

`/cars/id/toyota` is a URL to path `/cars/id/toyota` without parameters

`/cars?id=toyota` is a URL to path `/cars` with parameter named `id` with value `toyota`

# c# - Techart 的 DrawValue

> ID：15101063
> 
> 赞同：0
> 
> 时间：2013-02-26T22:55:06.433
> 
> 标签：c#, teechart

如果我在 teechart 上绘制了一个蜡烛系列，并且我更改了最后一根蜡烛的 CloseValue，则蜡烛不会在图表上自动更新。我真的不想使整个图表无效以显示它，因为如果有很多蜡烛，那会很慢。我以为 Candle 系列的 DrawValue 方法可以解决这个问题，但似乎它实际上也重绘了整个图表。有没有办法在屏幕上更新/重绘那根蜡烛？

我知道当我在 Delphi 5 中执行此操作时，蜡烛似乎在没有重新绘制整个图表的情况下更新 - 尽管可能整个图表更新速度足够快，以至于看起来就是这样。一般来说，C# 的 Teechart 绘制似乎比 Delphi 5 VCL Teechart 的绘制慢 3 到 5 倍......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T15:39:44.687

我认为您可以使用只允许刷新系列 RefreshSeries 的方法，就像下一行代码一样：

```
 candle1.RefreshSeries(); 
```

你能告诉我，如果它对你有用吗？如果您有任何问题，请告诉我。

更新信息以回答下一个问题：

> 好吧，我想我在这里解释得不好，桑德拉。让我再尝试一次。假设我的图表只有一个系列 - 30,000 支蜡烛。假设我在图表上显示所有蜡烛。重新绘制所有 30K 蜡烛需要时间。假设代码只更改了一根蜡烛 - 最后一根。有没有办法只重绘图表中包含新蜡烛的那一小部分，而不是重绘整个图表以显示新的变化？我尝试将 Invalidate 函数传递给蜡烛的矩形，但似乎 Invalidate() 和 Invalidate(rect) 产生完全相同的结果。

您能告诉我们您使用的是哪个版本的 TeeChart？另一方面，我编写了一个简单的代码，在其中修改了 CloseValue 并发布了不需要重绘、重绘或刷新 Series，因为该值会自动更新。我使用最新版本的 TeeChartFor.Net 内部版本号 [4.1.2012.01312] 和下一个代码进行了测试：

```
Steema.TeeChart.Styles.Candle candleSeries1;
Random r;
double tmpOpen;
double tmpClose;
int count;
DateTime dt;
TimeSpan ts;
private void InitializeChart()
{
    tChart1.Aspect.View3D=false;
    tChart1.AutoRepaint = false;
     r = new Random();
    candleSeries1.Clear();
    candleSeries1.XValues.DateTime = true;
    candleSeries1.GetHorizAxis.Labels.Angle = 90;
    count = 0;
    dt = DateTime.Today;
    ts = TimeSpan.FromDays(1);
    candleSeries1.Pen.Visible = false;
    for (int t=0;t<30000;t++)
    {
        tmpOpen = r.Next(100);
        tmpClose = tmpOpen - r.Next(100);
            ++count;
            candleSeries1.Add(dt,tmpOpen,tmpOpen + r.Next(50),
                tmpClose -r.Next(50),tmpClose);
        dt += ts;
    }
    tChart1.AutoRepaint = true;
}
private void button1_Click(object sender, EventArgs e)
{
    tmpOpen = r.Next(100);
    tmpClose = tmpOpen - r.Next(100);
    candleSeries1[candleSeries1.LastVisibleIndex].Close = tmpOpen;

} 
```

谢谢，

# java - 更改微调器箭头

> ID：15101069
> 
> 赞同：2
> 
> 时间：2013-02-26T22:55:21.330
> 
> 标签：java, android, layout

我需要更改 Spinner 视图的箭头，使其看起来像下一个图像。

![asd](../Images/4a01e9a9cee9508e402cbf1067c9d4aa.png)

我尝试过使用新的 xml 文件，但我只能修改背景（但我也得到了灰色填充）。

我需要知道是否可以在不从核心更改 png 文件的情况下做到这一点。

# c# - 如何使用 Lucene.net 中的自定义 TokenFilter 从令牌中删除逗号

> ID：15101072
> 
> 赞同：0
> 
> 时间：2013-02-26T22:55:25.930
> 
> 标签：c#, .net, visual-studio-2010, lucene, lucene.net

我有一个自定义令牌过滤器设置来解析关键字，例如

```
oracle,java,sybase,vb.net etc. 
```

进入

```
oracle java sybase vb.net 
```

并且工作正常，但是其中一个测试文档具有以下文本

```
,oracle java,sybase,unix 
```

我正在尝试从

```
,oracle 
```

使用下面的代码

```
 public override bool IncrementToken()
    {
        if (!input.IncrementToken())
            return false;

        char[] buffer = termAtt.TermBuffer();
        int bufferLength = termAtt.TermLength();

...
        else if (bufferLength > 1 && buffer[0] == ',')
        {
            // strip the starting , off !
            offsetAtt.SetOffset(offsetAtt.StartOffset + 1, offsetAtt.EndOffset);
        // where offsetAtt = AddAttribute<IOffsetAttribute>();
        }
        ...

        return true;

    } 
```

但是，这不会删除逗号

关于如何完成这项工作的任何帮助？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:28:17.977

Lucene 中的标记基于属性工作，即标记的每个属性（如文本值、偏移量等）都是一个属性。

令牌的文本值与令牌 TermAttribute.class 相关联。

更改偏移量和其他属性后，您可能还必须更改其自身的文本，可能使用以下代码段。

```
private final TermAttribute termAtt; // instance variable

termAtt = addAttribute(TermAttribute.class); // initialization in constructor 

....

 else if (bufferLength > 1 && buffer[0] == ',')
        {

            // strip the starting , off !
            offsetAtt.SetOffset(offsetAtt.StartOffset + 1, offsetAtt.EndOffset);

        // update the termAtt
            termAtt.setTermBuffer("sub-content of the buffer");

        }

.... 
```

让我知道它是否有效..

# iphone - 图标设计和锯齿状边缘

> ID：15101078
> 
> 赞同：0
> 
> 时间：2013-02-26T22:56:11.423
> 
> 标签：iphone, ios, ipad

我以为我的 ios 应用程序图标已经全部解决了。我在 Photoshop 中设计并以规定的尺寸进行了测试，它看起来很棒（在 Photoshop 中调整大小并保存为 .png）。我还通过“添加到主屏幕”进行了测试，以查看它的外观和外观漂亮和清晰（通过一个很酷的小网页，您可以在设备上上传图标和书签）。

但是，当我通过 iTunes Connect 将其上传为 1024 x 1024 大图标 (png) 时，我的形状看起来都是锯齿状的。至少在您最初准备提交新申请时获得的预览中。

想知道是什么原因造成的，以及我需要考虑什么，因为它与 Apple 如何调整图标大小以进行交付有关。任何能帮助我指出正确方向的帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:59:59.923

你设计的分辨率是多少？如果您在 Photoshop 中设计它，它是光栅图像，我建议您在 illustrator 中将其设计为矢量，但至少要确保您设计的分辨率高于 Itunes 图标所需的比例。

# ruby-on-rails - 使用作为可标记的 ruby gem 优化查询

> ID：15101080
> 
> 赞同：3
> 
> 时间：2013-02-26T22:56:19.760
> 
> 标签：ruby-on-rails, ruby, optimization, acts-as-taggable-on, taglist

我在我的项目中使用acts-as-taggable-on gem。但是，加载所有标签大约需要 80 秒。

我在 run_controller 中添加了急切加载，但它不起作用。这是一段代码：

```
def index
  @runs = Measurement.includes(:tags).order( "run_name DESC" ).group( :run_name )#.descending #.order_by( :run => 'desc' )
  respond_to do |format|
    format.html # index.html.erb
    format.json  { render :json => @runs }
  end
end 
```

我正在使用acts-as-taggable-on 支持的tag_list 来显示标签。因此，在 Measurements 上使用预先加载对性能没有影响。以下两个是stackflow中的相关问题： 1.acts_as_taggable_on [：如何优化查询？](https://stackoverflow.com/questions/7777069/acts-as-taggable-on-how-to-optimize-the-query) 2. [使用acts_as_taggable_on优化查询](https://stackoverflow.com/questions/7478651/optimizing-queries-with-acts-as-taggable-on?rq=1)

我查看了日志文件，发现最耗时的部分是加载标签，比如

ActsAsTaggableOn::Tag Load (69.9ms) SELECT `tags`.* FROM `tags`INNER JOIN `taggings`ON `tags`。`id`= `taggings`。`tag_id`在哪里`taggings`。`taggable_id`= 223866 和`taggings`。`taggable_type`= '测量' AND (taggings.context = 'tags' AND taggings.tagger_id 为空)

ActsAsTaggableOn::Tag Load (70.2ms) SELECT `tags`.* FROM `tags`INNER JOIN `taggings`ON `tags`。`id`= `taggings`。`tag_id`在哪里`taggings`。`taggable_id`= 223854 和`taggings`。`taggable_type`= '测量' AND (taggings.context = 'tags'

它有数千个查询来加载标签，每个查询花费大约 0.07 秒。以下代码用于显示标签。

```
= form_for (run), :remote => true, :method => :put,  :html => { :class => "myform"} do |f|
  =f.text_field :tag_list, :class => "tags" 
```

有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-26T21:54:44.960

我今天才遇到这个。您可以通过关联进行预加载`tags`，只要您不使用该`tag_list`方法即可。

[这里](https://stackoverflow.com/questions/7777069/acts-as-taggable-on-how-to-optimize-the-query)和[这里](https://github.com/mbleigh/acts-as-taggable-on/issues/91)提到

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T21:41:02.823

已考虑切换到[https://github.com/tmiyamon/acts-as-taggable-array-on](https://github.com/tmiyamon/acts-as-taggable-array-on)。您将需要使用 postgres 作为您的数据库。

看看这个[http://adamnengland.wordpress.com/2014/02/19/benchmarks-acts-as-taggable-on-vs-postgresql-arrays](http://adamnengland.wordpress.com/2014/02/19/benchmarks-acts-as-taggable-on-vs-postgresql-arrays)

# ios - iOS上div之间的奇怪差距

> ID：15101083
> 
> 赞同：0
> 
> 时间：2013-02-26T22:56:24.120
> 
> 标签：ios, css, html

我有两个间隔为 0px 的 div，但在 iOS 设备上，有一个奇怪的非常细的间隙。请在桌面浏览器和 iOS 设备上访问[http://melino.com 。](http://melino.com)请注意左上角徽标后面的细线。

有解决办法吗？

这是移动 Safari 上的预览：http: [//imageshack.us/photo/my-images/843/previewios.png/](http://imageshack.us/photo/my-images/843/previewios.png/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:04:05.873

我不确定 - 但也许移动版 Safari 不理解

```
margin: 0 77px; 
```

正确（#header-logo-box）。

您是否尝试写入所有边距值？喜欢：

```
margin: 0 0 0 77px; 
```

# symfony - Symfony2：在实体或控制器中使用业务（存储库）逻辑的最佳方法

> ID：15101087
> 
> 赞同：5
> 
> 时间：2013-02-26T22:56:42.320
> 
> 标签：symfony, doctrine-orm, repository, entity, business-logic

我的项目中有一个设计问题，与一些业务逻辑的放置位置有关。

我有三个实体，Event、TicketOrder 和 Ticket。一个 Event 有很多 TicketOrder，而一个 TicketOrder 有很多门票。

在我的模板中，我必须显示一个 Event 有多少张门票。我一直在考虑实现这一目标的最佳方法，但没有得到好的解决方案。我试过这个：

1) 在 Event 实体中创建一个私有成员 'ticketsCount'，使用 setTicketsCount 和 getTicketsCount 方法。使用 LifeCycleCallback 'PostLoad' 创建一个 'loadTicketsCount' 方法，以访问 TicketRepository 方法 'findByEvent'。这是不可能的，因为我无法访问实体类中的存储库。

2) 在将用于显示事件的操作中，我可以访问 Ticket Repository 并手动设置事件“ticketsCount”属性。我不知道这是否是一个好方法，因为如果我的操作列出了很多事件，我将不得不遍历所有事件并对每个事件进行存储库调用。

我真的不知道实现这一目标的最佳方法，如果有人可以帮助我，我将不胜感激。

谢谢！;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:43:58.240

当您使用学说实体存储库的 findAll、findBy 或 findBy* 方法时，会返回一个包含实体对象的简单 php 数组。

数组类实现了可数接口。所以使用树枝长度过滤器

```
{{ ticketOrder.tickets|length }} 
```

`count()`你在数组上执行一个简单的 php 。

实际上现在执行计数查询是有意义的，因为您已经在内存中获得了结果。因此，对结果进行计数并从内存中检索它似乎更有效，因为当您访问关联时，它们会完全加载到内存中。

* * *

然而，实体之间的关联可能会变得非常大。因此，想象一下您与数十万个实体有关联。您不会将这些实体一起加载并一直保存在内存中。因此，在 Doctrine 2.1 中，您可以将关联注释为**Extra Lazy**。如果在您的情况下这样做，则在调用上述树枝过滤器时会执行计数查询。但结果不会保存在内存中。

[http://docs.doctrine-project.org/en/2.0.x/tutorials/extra-lazy-associations.html](http://docs.doctrine-project.org/en/2.0.x/tutorials/extra-lazy-associations.html)

* * *

**根据您的最新评论：**

我可以想象一种方法来做到这一点。在模板中，您可以使用 render 语句调用控制器的操作，例如

```
{% render YourMainBundle:getTickets with { 'event_id' : event.id } %} 
```

在此操作中，您可以调用一个查询来查找与特定事件关联的所有票证。此操作必须返回 html，例如填充数据的模板。

# ruby-on-rails-3.2 - 向表中添加外键时有什么特殊考虑吗？

> ID：15101090
> 
> 赞同：0
> 
> 时间：2013-02-26T22:57:08.177
> 
> 标签：ruby-on-rails-3.2

我已经有一个架构，现在想将`organization_id`组织表的字段添加到`Program`表中。所以我可以添加一个小的`add_column migration`并完成，但是因为这是`organization_id`字段（Rails 生成的同一个 *_id 字段）我想确保我没有错过任何关键点？所以只需一个 add_column 迁移就足够了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T06:05:42.447

添加组织 ID 后，您必须确保还在模型中放置了所需的关联类型。

例如：

```
Organization model

belongs_to :program

Program Model

has_many :organizations 
```

你可以在这里了解更多

[http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# java - 如何在 JPA 中更新实体

> ID：15101092
> 
> 赞同：0
> 
> 时间：2013-02-26T22:57:13.870
> 
> 标签：java, jpa

这是我第一次真正接触 JPA，我正在尝试运行最简单的更新语句。我在使用 Hibernate 作为 JPA 实现的 jBoss 7.1.x 服务器中运行。任何帮助将不胜感激..

这是我的 EntityManager 的生产者方法：

```
@ApplicationScoped
public class EntityManagerProducer
{

    @PersistenceContext
    private EntityManager entityManager;

    @Produces
    @RequestScoped
    public EntityManager getEntityManager()
    {
        return entityManager;
    }

} 
```

这是尝试执行更新的 DAO 方法：

```
@Inject EntityManager em;

public void updateRequestStatus(String requestNumber, String newStatus)
        {
            em.getTransaction().begin();
            ServiceRequestEntity serviceRequestToUpdate = em.find(RequestEntity.class, requestNumber);
            requestToUpdate.setStatus(newStatus);
            em.merge(serviceRequestToUpdate);
            em.getTransaction().commit();
        } 
```

这是persistence.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
 version="2.0">
 <persistence-unit name="database" transaction-type="RESOURCE_LOCAL">
  <jta-data-source>java:/jdbc/myDS</jta-data-source>
  <properties>
   <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect" />
   <property name="hibernate.show_sql" value="true" />
   <property name="hibernate.format_sql" value="false" />
   <property name="hibernate.use_sql_comments" value="true" />
  </properties>
 </persistence-unit>
</persistence> 
```

这是错误消息（如果需要，可以提供完整的堆栈跟踪 - 它在“合并”行阻塞）：

```
javax.persistence.TransactionRequiredException: JBAS011469: Transaction is required to perform this operation (either use a transaction or extended persistence context)
....
at org.jboss.weld.proxies.EntityManager$-1727851269$Proxy$_$$_WeldClientProxy.merge(EntityManager$-1727851269$Proxy$_$$_WeldClientProxy.java) [weld-core-1.1.5.AS71.Final.jar:] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T05:12:57.060

EntityManager 上的@Inject 注释我认为不会起作用。使用您当前的设置，我相信您想要注入您的 EntityManagerProducer 类（在您的 DAO 中未使用），然后在其上调用您的 getEntityManager 方法。

另一种选择是在 DAO 中使用 @PersistenceContext。

您可能还需要指定持久性上下文的名称，如您的 persistence.xml 中所指定的，例如： `@PersistenceContext(name="database")`

# python - Pymunk - 查找身体的相关形状和约束

> ID：15101102
> 
> 赞同：2
> 
> 时间：2013-02-26T22:57:45.493
> 
> 标签：python, chipmunk, pymunk

我试图找到某种方法来迭代依赖于 pymunk 中特定主体的约束。在 Chipmunk 中似乎有多种方法可以做到这一点，但我在 pymunk 中找不到等价物。我希望看到一些方法来检测约束，这样我就不必手动跟踪所有约束。

我还想看看一种检测与身体相关的形状的方法。一般来说，当我从空间中移除身体时，我希望能够自动移除身体的形状和约束。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T00:05:14.730

最新的 pymunk 主干版本在 Body 类上有两个新的（截至目前）形状和约束属性。我总是返回形状/约束，不管它们是否被添加到空间中。

所以现在你可以这样做：

```
>>> import pymunk
>>> b = pymunk.Body()
>>> b2 = pymunk.Body()
>>> j = pymunk.PivotJoint(b,b2,(0,0))
>>> s = pymunk.Circle(b,3)
>>> b.constraints
set([<pymunk.constraint.PivotJoint object at 0x02521890>])
>>> b.shapes
set([<pymunk.Circle object at 0x025218F0>]) 
```

（这将包含在 pymunk 3.1 中。）

# math - 两个 3d 向量之间的欧拉角

> ID：15101103
> 
> 赞同：8
> 
> 时间：2013-02-26T22:57:46.720
> 
> 标签：math, vector, 3d, geometry, euler-angles

你如何找到 2 个 3D 向量之间的 3 个欧拉角？当我有一个向量并且我想获得它的旋转时，通常可以使用此链接：[计算旋转以查看 3D 点？](https://stackoverflow.com/questions/1251828/calculate-rotations-to-look-at-a-3d-point)

但是，当它们相互计算时，我该怎么做呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-27T09:55:24.513

正如其他人已经指出的那样，应该修改您的问题。让我们称你的向量`a`和`b`。我假设`length(a)==length(b) > 0`否则我无法回答这个问题。

* * *

计算向量的[叉积](http://en.wikipedia.org/wiki/Cross_product#Coordinate_notation)`v = a x b`；`v`给出旋转**轴**。通过计算[点积](http://en.wikipedia.org/wiki/Dot_product#Algebraic_definition)，您可以获得应该旋转的**角度**`cos(angle)=dot(a,b)/(length(a)length(b))`的余弦，并且`acos`您可以唯一地确定角度（@Archie 感谢您指出我之前的错误）。此时，您有了旋转的**轴角表示**。

剩下的工作是将此表示转换为您正在寻找的表示：欧拉角。[如您所见，将轴角转换为欧拉](http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToEuler/index.htm)是一种方法。`v = [ 0, 0, 0]`当 时，即角度为 0 度或 180 度时，您必须处理退化情况。

* * *

我个人不喜欢欧拉角，它们会破坏应用程序的稳定性，并且不适合插值，另请参阅

*   [android方向传感器的奇怪行为](https://stackoverflow.com/q/5577334/341970)

*   [在旋转矩阵之间进行插值](https://stackoverflow.com/q/5580283/341970)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-05T15:29:52.593

首先，您必须从向量二中减去向量一，以获得相对于向量一的向量二。使用这些值，您可以计算欧拉角。

为了直观地理解从向量到欧拉的计算，让我们想象一个半径为 1 且原点位于其中心的球体。向量表示其表面上 3D 坐标中的一个点。该点也可以通过球面 2D 坐标定义：分别为纬度和经度、俯仰和偏航。

为了“滚动<-俯仰<-偏航”计算可以如下完成：

要计算偏航，请考虑象限，计算两个平面轴（x 和 z）的切线。

```
yaw = atan2(x, z) *180.0/PI; 
```

俯仰是完全一样的，但是当它的平面随着偏航旋转时，“相邻”在两个轴上。为了找到它的长度，我们将不得不使用勾股定理。

```
float padj = sqrt(pow(x, 2) + pow(z, 2)); 
pitch = atan2(padj, y) *180.0/PI; 
```

笔记：

*   滚动无法计算，因为向量没有围绕自己的轴旋转。我通常将其设置为 0。
*   矢量的长度丢失，无法转换回来。
*   在 Euler 中，轴的顺序很重要，将它们混合起来，你会得到不同的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-02T12:42:23.737

我花了很多时间才找到这个答案，所以我现在想与您分享。

首先，您需要找到旋转矩阵，然后`scipy`您可以轻松找到所需的角度。

没有捷径可以做到这一点。所以让我们首先声明一些函数......

```
import numpy as np
from scipy.spatial.transform import Rotation

def normalize(v):
    return v / np.linalg.norm(v)

def find_additional_vertical_vector(vector):
    ez = np.array([0, 0, 1])
    look_at_vector = normalize(vector)
    up_vector = normalize(ez - np.dot(look_at_vector, ez) * look_at_vector)
    return up_vector

def calc_rotation_matrix(v1_start, v2_start, v1_target, v2_target):
    """
    calculating M the rotation matrix from base U to base V
    M @ U = V
    M = V @ U^-1
    """

    def get_base_matrices():
        u1_start = normalize(v1_start)
        u2_start = normalize(v2_start)
        u3_start = normalize(np.cross(u1_start, u2_start))

        u1_target = normalize(v1_target)
        u2_target = normalize(v2_target)
        u3_target = normalize(np.cross(u1_target, u2_target))

        U = np.hstack([u1_start.reshape(3, 1), u2_start.reshape(3, 1), u3_start.reshape(3, 1)])
        V = np.hstack([u1_target.reshape(3, 1), u2_target.reshape(3, 1), u3_target.reshape(3, 1)])

        return U, V

    def calc_base_transition_matrix():
        return np.dot(V, np.linalg.inv(U))

    if not np.isclose(np.dot(v1_target, v2_target), 0, atol=1e-03):
        raise ValueError("v1_target and v2_target must be vertical")

    U, V = get_base_matrices()
    return calc_base_transition_matrix()

def get_euler_rotation_angles(start_look_at_vector, target_look_at_vector, start_up_vector=None, target_up_vector=None):
    if start_up_vector is None:
        start_up_vector = find_additional_vertical_vector(start_look_at_vector)

    if target_up_vector is None:
        target_up_vector = find_additional_vertical_vector(target_look_at_vector)

    rot_mat = calc_rotation_matrix(start_look_at_vector, start_up_vector, target_look_at_vector, target_up_vector)
    is_equal = np.allclose(rot_mat @ start_look_at_vector, target_look_at_vector, atol=1e-03)
    print(f"rot_mat @ start_look_at_vector1 == target_look_at_vector1 is {is_equal}")
    rotation = Rotation.from_matrix(rot_mat)
    return rotation.as_euler(seq="xyz", degrees=True) 
```

找到从 1 个向量到另一个向量的 XYZ Euler 旋转角度可能会给您多个答案。

假设您正在旋转的是`look_at_vector`某种形状，并且您希望这种形状不会倒置并仍然看着`target_look_at_vector`

```
if __name__ == "__main__":
    # Example 1
    start_look_at_vector = normalize(np.random.random(3))
    target_look_at_vector = normalize(np.array([-0.70710688829422, 0.4156269133090973, -0.5720613598823547]))

    phi, theta, psi = get_euler_rotation_angles(start_look_at_vector, target_look_at_vector)
    print(f"phi_x_rotation={phi}, theta_y_rotation={theta}, psi_z_rotation={psi}") 
```

现在，如果您想对您的形状进行特定的角色旋转，我的代码也支持！你只需要给出`target_up_vector`作为参数。只需确保它与您提供的 target_look_at_vector 垂直。

```
if __name__ == "__main__":
    # Example 2
    # look and up must be vertical
    start_look_at_vector = normalize(np.array([1, 2, 3]))
    start_up_vector = normalize(np.array([1, -3, 2]))
    target_look_at_vector = np.array([0.19283590755300162, 0.6597510192626469, -0.7263217228739983])
    target_up_vector = np.array([-0.13225754322703182, 0.7509361508721898, 0.6469955018014842])
    phi, theta, psi = get_euler_rotation_angles(
        start_look_at_vector, target_look_at_vector, start_up_vector, target_up_vector
    )
    print(f"phi_x_rotation={phi}, theta_y_rotation={theta}, psi_z_rotation={psi}") 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2017-01-23T18:11:57.000

在 MATLAB 中获取旋转矩阵非常简单，例如

```
A = [1.353553385,  0.200000003,  0.35]
B = [1 2 3]

[q] = vrrotvec(A,B)
Rot_mat = vrrotvec2mat(q) 
```

# fancybox - 带有 Windows 7 的 Chrome 上的幽灵滚动条

> ID：15101105
> 
> 赞同：0
> 
> 时间：2013-02-26T22:57:58.823
> 
> 标签：fancybox

想知道您是否在 Windows7 和 Chrome 上使用 fancybox 时遇到过出现鬼滚动条的问题？ [看到这张图片](http://ttp://avwxworkshops.com/etips/images/Ghost-Scroll-Bars.gif)。

这在 Vista 下的 Chrome 中实际上不会发生。

如果你看[这里](http://avwxworkshops.com/etips/images/Overflow-Attribute.gif)，溢出属性被覆盖/更改为滚动。使用 Firebug 将其设置为隐藏，使幽灵滚动条消失。我在代码中将属性设置为隐藏，但显然有些东西会覆盖要滚动的属性。

任何想法如何摆脱这些幽灵滚动条？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:03:41.543

一个快速的解决方法是`!important`在你的 CSS 中使用来强制它们消失。

# java - 将sql查询的结果插入数组

> ID：15101107
> 
> 赞同：-2
> 
> 时间：2013-02-26T22:58:00.617
> 
> 标签：java

我有一个返回整数数组的 SQL 查询。问题是将整数插入数组的正确方法是什么？像这样的东西：

```
int[] IntArray = new int[40];

            while (result.next())
            {

                IntArray[0] = result.getInt(1);
            } 
```

数组的大小始终是固定的。我得到每本书 40 个整数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T22:59:42.443

好吧，您还需要数组的**索引**。

```
int index=0;
  while (result.next())
 {
    IntArray[index] = result.getInt(1);
      index++;
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T22:59:48.803

如果您不知道您的查询返回了多少行，那么您应该使用 an[`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)及其`add`方法，如果需要，它将增长到超过初始大小。

```
ArrayList<Integer> intArray = new ArrayList<Integer>(40);
while (result.next())
{
    intArray.add(result.getInt(1));
} 
```

如果您需要一个数组，则保留一个计数器变量并在每个循环中递增它，这样您就不会在每个循环中覆盖相同的第一个数组元素。

```
int[] intArray = new int[40];
int index = 0;
while (result.next())
{
    intArray[index] = result.getInt(1);
    index++;
} 
```

# matrix - Fortran 和 MPI 中的 Jacobi 迭代

> ID：15101111
> 
> 赞同：0
> 
> 时间：2013-02-26T22:58:16.420
> 
> 标签：matrix, fortran, mpi

我正在尝试用 jacobi 迭代解决 ax=b，我的串行代码工作正常，但 MPI 版本甚至无法运行。谁能帮我？

串行

```
program jacobis

implicit none

integer, parameter :: n=10
integer :: i,j,k,ni,s,seed
double precision :: tol,t1,t2,sig
double precision, dimension(0:n-1,0:n-1) :: A
double precision, dimension(0:n-1) :: B, x, xb, buff

ni=1000

seed=time()
call srand(seed)

do i=0, n-1
  do j=0, n-1
    A(i,j)=rand(0)
    B(i)=rand(0)
  end do
end do

do i = 0, n-1
 A(i,i) = sum(A(i,:)) + 1
enddo

!do i=0,n-1
 !A(i,i)=4
!end do  

print *, "a", A
print *, "b", B

x=B
call cpu_time(t1)
do k=1,ni
 xb=x
 do i=0,n-1
    s=0
    do j=0,n-1
    if (j/=i) then
         s=s+A(i,j)*xb(j)
        endif
    end do
    x(i)=(B(i)-s)/A(i,i) 

   sig=(x(i)-xb(i))*(x(i)-xb(i))
   tol=tol+sig
   tol=sqrt(tol)
 end do

 print *, "x", x

 !print *, "tol=", tol

 print *, "iter =",k

 if (tol<1.000001) EXIT
 if (k==(ni-1)) then
    print *, "Numero Maximo de Iteracoes" 
    EXIT
 endif
end do

 call cpu_time(t2)
 print *, "t=",t2-t1

end 
```

MPI 版本

```
program jacobis

use mpi
implicit none

integer, parameter :: n=2
integer :: i_local,i_global,j,k,ni,s,m
double precision :: tol,t,t2,sig
double precision, dimension(:,:), ALLOCATABLE :: A_local
double precision, dimension(:), ALLOCATABLE :: B_local, x_local, x_temp1,x_temp2,x_old,x_new, buff
INTEGER, DIMENSION (MPI_STATUS_SIZE) :: STATUS
integer :: rank,procs,tag,ierror

CALL MPI_INIT(ierror)
CALL MPI_COMM_RANK(MPI_COMM_WORLD,rank,ierror)
CALL MPI_COMM_SIZE(MPI_COMM_WORLD,procs,ierror)

ni=100
m=n/procs

ALLOCATE (A_local(0:n-1,0:n-1))
ALLOCATE (B_local(0:m-1))
ALLOCATE (x_temp1(0:m-1))
ALLOCATE (x_temp2(0:m-1))

A_local=0
B_local=2

do i_global=0,n-1
 A_local(i_global,i_global)=2
end do  

CALL MPI_ALLGATHER(B_local, m, MPI_DOUBLE, x_temp1, m, MPI_DOUBLE, MPI_COMM_WORLD,ierror)

x_new=x_temp1
x_old=x_temp2

print *, "a", A_local
print *, "b", B_local

t=mpi_wtime()
do k=1,ni
 x_old=x_new
 do i_local=0,m-1
    i_global=i_local+rank*m 
    !x_local(i_local)=b_local(i_local)
    s=0
    do j=0,n-1
    if (j/=i_local) then
         s=s+A_local(i_local,j)*x_old(j)
        endif
    end do
    x_local(i_local)=(B_local(i_local)-s)/A_local(i_local,i_global) 

 end do
 CALL MPI_ALLGATHER(x_local,m, MPI_DOUBLE, x_new, m, MPI_DOUBLE, MPI_COMM_WORLD,ierror)

 do i_global=0,n-1
   sig=(x_new(i_global)-x_old(i_global))*(x_new(i_global)-x_old(i_global))
   tol=tol+sig
   tol=sqrt(tol)
 end do

 print *, "x", x_local

 print *, "tol=", tol

 print *, "iter =",k

 if (tol<1.000001) EXIT
 if (k==(ni-1)) then
    print *, "Numero Maximo de Iteracoes" 
    EXIT
 endif
end do

 t2=mpi_wtime()-t;
 print *, "t=",t2

CALL MPI_FINALIZE(ierror)
end 
```

谁能指出我做错了什么？是索引问题吗？请我今天真的需要解决这个问题，否则我会不及格。我在这上面花了无数个小时，却无法让它发挥作用。

好吧，你是对的！现在我有一个分段错误，但找不到它！已将代码替换为新版本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T01:40:52.653

您的程序有几个我可以看到的问题。您包含的错误消息表明此调用中有一个未分配的接收缓冲区：

```
CALL MPI_ALLGATHER(B_local, m, MPI_DOUBLE, x_temp1, m, MPI_DOUBLE, MPI_COMM_WORLD) 
```

Array `x_temp1`，接收缓冲区，需要在此上下文中使用之前分配。

解决这个问题只会让你走得更远，而且你会得到一个信息量较少的分段错误。`MPI_AllGather`在 MPI 实现中查找正确用法会很有用。大多数 MPI 例程最后都有一个整数错误状态参数：

```
MPI_ALLGATHER(SENDBUF, SENDCOUNT, SENDTYPE, RECVBUF, RECVCOUNT,
        RECVTYPE, COMM, IERROR)
    <type>    SENDBUF (*), RECVBUF (*)
    INTEGER    SENDCOUNT, SENDTYPE, RECVCOUNT, RECVTYPE, COMM,
    INTEGER    IERROR 
```

这应该让你完成你的任务。确保分配`allocatable`您使用的所有数组，并为您的 MPI 实现和编译器手册使用适当的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T20:16:34.360

我已经解决了这个问题，现在它可以正确计算迭代，由串行程序使用相同的矩阵证明。这是一个分配和索引问题。感谢之前的回答，非常有帮助。

```
program jacobis

use mpi
implicit none

integer, parameter :: n=1000
integer :: i_local,i_global,j,k,ni,s,m,seed
double precision :: tol,t,t2,sig
double precision, dimension(:,:), ALLOCATABLE :: A_local
double precision, dimension(:), ALLOCATABLE :: B_local, x_local, x_temp1,x_old,x_new, buff
INTEGER, DIMENSION (MPI_STATUS_SIZE) :: STATUS
integer :: rank,procs,tag,ierror

CALL MPI_INIT(ierror)
CALL MPI_COMM_RANK(MPI_COMM_WORLD,rank,ierror)
CALL MPI_COMM_SIZE(MPI_COMM_WORLD,procs,ierror)

ni=1000
m=n/procs

ALLOCATE (A_local(0:n-1,0:n-1))
ALLOCATE (B_local(0:n-1))
ALLOCATE (x_local(0:n-1))
ALLOCATE (x_temp1(0:n-1))
ALLOCATE (x_new(0:n-1))

!A_local=23
!B_local=47

seed=time()
call srand(seed)

do k=0, n-1
 do j=0, n-1
    A_local(k,j)=rand(0)
    B_local(k)=rand(0)
 end do
end do

do i_global = 0, m-1
 A_local(i_global,i_global) = sum(A_local(i_global,:)) + n
enddo

CALL MPI_ALLGATHER(B_local, m, MPI_DOUBLE, x_temp1, m, MPI_DOUBLE, MPI_COMM_WORLD,ierror)

x_new=x_temp1

print *, "a", A_local
print *, "b", B_local

t=mpi_wtime()
do k=1,ni
 x_old=x_new
 do i_local=0,m-1
    i_global=i_local+rank*m 
    !x_local(i_local)=b_local(i_local)
    s=0
    do j=0,n-1
    if (j/=i_local) then
         s=s+A_local(i_local,j)*x_old(j)
        endif
    end do
    x_local(i_local)=(B_local(i_local)-s)/A_local(i_local,i_global) 
 end do
 CALL MPI_ALLGATHER(x_local,m, MPI_DOUBLE, x_new, m, MPI_DOUBLE, MPI_COMM_WORLD,ierror)
 do j=0,n-1
   sig=(x_new(j)-x_old(j))*(x_new(j)-x_old(j))
   tol=tol+sig
   tol=sqrt(tol)
 end do

 print *, "x", x_local

 print *, "tol=", tol

 print *, "iter =",k

 if (tol<1.01) EXIT
 if (k==(ni-1)) then
    print *, "Numero Maximo de Iteracoes" 
    EXIT
 endif
end do

 t2=mpi_wtime()-t;
 print *, "t=",t2

CALL MPI_FINALIZE(ierror)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-10T09:45:03.653

您的程序存在严重问题，您可能会得到错误的结果。变量 s 被声明为整数，而它被分配了非整数值。将其重新声明为双精度以获得正确的结果。（发布给那些曾经复制此代码的人）

# authentication - GitHub 身份验证如何工作？

> ID：15101112
> 
> 赞同：1
> 
> 时间：2013-02-26T22:58:16.330
> 
> 标签：authentication, github, ssh

如果您遵循 GitHub HowTo “[生成 SSH 密钥](https://help.github.com/articles/generating-ssh-keys)”，您会在`~/.ssh`目录中获得三个文件：`known_hosts`、`id_rsa`和`id_rsa.pub`.

该文件`known_hosts`用于服务器身份验证，`id_rsa`用于客户端身份验证（[这](https://unix.stackexchange.com/questions/42643/ssh-key-based-authentication-known-hosts-vs-authorized-keys/42695#42695)是一篇文章，解释了区别）。

为什么我应该创建/为什么 GitHub 确实需要主机和用户身份验证文件？GitHub 身份验证如何工作？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:09:12.287

这只是普通的旧 SSH 身份验证；没有什么是 GitHub 特有的。

`id_rsa`并且`id_rsa.pub`是您的密钥的两半：私钥和公钥。实际上，公钥是私钥的锁。您将锁（公钥）放在您想要轻松访问的任何服务器上，而不必太担心其他人会看到它，因为它只是一把锁。您将（私人）密钥保存在您的机器上，并使用它来登录这些服务器；他们看到你有一把适合锁的钥匙，然后让你进去。

（并不是说您应该将您的公钥放在完全不可信的机器上；有些恶意技巧可以利用诸如 .) 之类的快捷方式`ssh -A`。）

`known_hosts`实际上与此没有太大关系；它只是`ssh`存储您连接到的所有服务器的指纹的地方，因此如果指纹发生变化，它可能会引发一个可怕的警告。（这意味着它不是同一台机器：要么服务器端发生了根本性的变化，要么你的连接被劫持了。）

所以，无论如何，Git 本身理解的协议之一就是 SSH。当您`git@github.com:...`用作存储库 URL 时，Git 只是通过 SSH 连接。当然，GitHub 不希望你在他们的机器上乱搞，所以他们只让你做 Git 的事情，而不是得到一个完整的 shell。

像往常一样，[Arch wiki](https://wiki.archlinux.org/index.php/SSH_Keys)在这方面有更多的文字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T23:08:51.303

*   `known_hosts`在您第一次连接时存储服务器的身份，*以便您下次连接到同一台服务器时知道*。这可以防止有人在您下次连接时假装是服务器（但遗憾的是不是第一次）

*   `id_rsa`是你的密钥，证明你是真的你。*永远不要放弃这个*。

*   `id_rsa.pub`是公钥，其身份验证的目的基本上只是*为了证明您拥有密钥而不给出它*。您可以将此密钥提供给任何需要它的人，因为它没有任何秘密。

当您连接到服务器时，SSH 首先[检查服务器是否有正确的密钥](https://www.rfc-editor.org/rfc/rfc4253)（即它应该与 . 中的那个匹配`known hosts`。如果客户端认为服务器是真实的，它会使用其*私钥*[对以下数据](https://www.rfc-editor.org/rfc/rfc4252#page-10)进行签名并发送它到服务器；

```
 string    session identifier
  byte      SSH_MSG_USERAUTH_REQUEST
  string    user name
  string    service name
  string    "publickey"
  boolean   TRUE
  string    public key algorithm name
  string    public key to be used for authentication 
```

服务器使用公钥（您之前上传到 Github）验证签名，如果正确，则客户端通过身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:03:16.303

每当您实际通过 SSH 连接到主机时，ssh 都会使用 known_hosts 文件。它为服务器存储各种签名密钥。然后，如果它改变了，你就会知道。

`ssh-keygen -t rsa -C yourgithub@accountemail.com`用于生成 SSH 密钥，您将在其中将其提供`id_rsa.pub`给 github。`id_rsa`然后，当您连接到 github 时，您的文件夹中有私钥`~/.ssh`，然后用于通过 github 验证您的信息。

这是一个非常底层的解释，但是私钥（非 .pub）文件是你的目的，.pub 是给 github 的，known_hosts 是让你的盒子知道什么是什么。

您还可以生成一个`config`文件`~/.ssh`用于指定哪个密钥转到哪个主机..

**authorized_keys 和 known_hosts**完全不同..

您的 SSH 服务器（sshd，即）使用authorized_keys，或在您的内部定义的任何文件，`/etc/ssh/sshd_config/`用于了解另一个密钥的公共方面。因此，当用户连接到您的服务器时，他们会传递他们的私钥，您的 SSH 服务器会根据它在 authorized_keys 中的公钥进行验证，如果不匹配，它就不起作用。

Github`authorized_keys`对他们的用户保持着一个可以这么说的方式。您的公钥进入您帐户上的 authorized_keys，然后当您通过 ssh 连接到克隆、推送等时，它会检查您发送的私钥以及他们已经知道的公钥。

# recursion - 查看是否有可能通过 Prolog 的火车路线

> ID：15101123
> 
> 赞同：3
> 
> 时间：2013-02-26T22:59:02.727
> 
> 标签：recursion, prolog

我正在使用 Prolog 解决的一个问题是查看火车是否可以从一个目的地行驶到另一个目的地。有两个规则。

1.  一列火车可以通过一个或多个中间地从一个目的地到下一个目的地。
    例如：旧金山到洛杉矶
    洛杉矶到尔湾
    尔湾到圣地亚哥
    这给出了从旧金山到圣地亚哥的路线。

2.  火车可以往返于目的地。因此，如果一列火车可以从旧金山开往洛杉矶，它就可以从洛杉矶开往旧金山。

这是我目前拥有的代码。

```
nonStopTrain(sandiego,oceanside).
nonStopTrain(lasvegas,sandiego).
nonStopTrain(sanfrancisco,bakersfield).
nonStopTrain(bakersfield,sandiego).
nonStopTrain(oceanside,losangeles).
nonStopTrain(portland,sanfrancisco).
nonStopTrain(seattle,portland).

canTravel(From, To) :- nonStopTrain(From, To); nonStopTrain(To, From).
canTravel(From, To) :-
    canTravel(From, Through), canTravel(Through, To). 
```

问题是双向旅行的能力。当我运行这个程序时，我不断地在同一个地方来回跑，我不知道为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T04:46:00.633

幼稚解决方案的问题在于，如果不消除循环，则从 A 点到 B 点有无数种方法。假设我想从西雅图去旧金山。如果没有处理周期，我们将把它们中的每一个都作为一个独特的解决方案：

```
seattle ->  portland -> seattle -> portland -> sanfrancisco
seattle ->  portland -> seattle -> portland -> seattle -> portland -> sanfrancisco
seattle -> (portland -> seattle) x N -> sanfrancisco 
```

您可以加倍自己的次数没有限制，因此只要连接了三个节点，实际上就有无限数量的解决方案。在实践中，你不想要任何让你自己加倍努力的解决方案，但 Prolog 不知道这一点，也没有直观和幼稚的方法来防止它。

更好的方法之一是简单地跟踪你去过的地方。为此，我们需要让谓词接受一个额外的参数。首先，我还介绍了一个辅助谓词。

```
connectedDirectly(From, To) :- nonStopTrain(From, To) ; nonStopTrain(To, From). 
```

`canTravel`当我们真的只想在旅程中再增加一条腿时，将其分离出来将减少递归调用的欲望。现在为`canTravel`：

```
canTravel(From, To)    :- canTravel(From, To, []). 
```

这是一个映射到我们新的 arity 3 规则的 arity 2 规则。我们去过的地方列表最初总是空的。现在我们需要一个基本案例：

```
canTravel(From, To, _) :- connectedDirectly(From, To). 
```

这应该是显而易见的。现在归纳的情况有点不同，因为我们需要做两件事：找到一条新的腿来附加到旅程中，确保我们之前没有经历过那条腿，然后递归，将新的腿添加到列表中我们去过的地方。最后，我们要确保我们不会在我们开始的地方结束大循环，所以我们在末尾添加了一条规则以确保我们不会。

```
canTravel(From, To, Visited) :-
  connectedDirectly(From, Through),
  \+ memberchk(Through, Visited),
  canTravel(Through, To, [Through|Visited]),
  From \= To. 
```

现在，如果你运行它，你会发现你得到了 98 个解决方案，并且所有解决方案都是对称的：

```
?- forall(canTravel(X, Y), (write(X-Y), nl)).
sandiego-oceanside
lasvegas-sandiego
sanfrancisco-bakersfield
... etc. 
```

因此，令人高兴的是，我们能够避免采用广度优先搜索解决方案。

**编辑**

`canTravel`通过重载两个独立谓词的名称，我显然混淆了这种情况。在 Prolog 中，谓词由名称*和*数量唯一地定义，就像 C++ 或 Java 中的重载一样，其中“有效方法”由参数的数量和名称决定，而不仅仅是名称。

您的直觉是正确的 - 中的空列表`canTravel(From, To) :- canTravel(From, To, [])`正在为访问过的地点列表建立初始绑定。与其说是分配存储，不如说是建立一个基本案例。

canTravel 本身有两种用途。其中之一是`canTravel/3`从调用`canTravel/2`。在这种情况下，`canTravel/3`它真的有点像一个助手，做 的实际工作`canTravel/2`，但使用我们初始化为空列表的内部变量。另一个用途是`canTravel/3`from inside `canTravel/3`，为此我们都使用它来实现相同的目标：递归，Prolog 的主要“循环”构造。

中的第三个参数`canTravel(From, To, _) :- connectedDirectly(From, To)`是使该子句成为`canTravel/3`. 这是递归的基本情况，所以它不需要考虑我们到目前为止访问过的地方（尽管归纳情况会阻止循环旅程）。我们也可以在这里检查它，但事实证明它更昂贵并且对结果集没有影响：

```
canTravel(From, To, Visited) :- connectedDirectly(From, To), \+ memberchk(To, Visited). 
```

我得出的结论是，如果它在不改变答案的情况下增加了费用和复杂性，我们可以省略检查，这将基本情况减少到具有匿名第三变量的原始情况。

在没有重载的情况下看到这个可能更有意义，在这种情况下它看起来像这样：

```
canTravel(From, To) :- canTravel_loop(From, To, []).

canTravel_loop(From, To, _) :- connectedDirectly(From, To).
canTravel_loop(From, To, Visited) :-
  connectedDirectly(From, Through),
  \+ memberchk(Through, Visited),
  canTravel_loop(Through, To, [Through|Visited]),
  From \= To. 
```

**编辑 2**

关于“酒吧操作员”，您的直觉再次正确。:) 我在这里使用它来将项目添加到列表中。让您感到困惑的是，在 Prolog 中，通过统一，大多数表达式表达的是*关系*而不是*过程*。因此，根据上下文，`[X|Xs]`可能用于构造一个新列表（如果您手头有 X 和 XS），也可能用于将隐式列表分解为 head`X`和 tail `Xs`。看看我可以从 repl 中使用它的所有方式：

```
?- X = hello, Xs = [world, new, user], Y = [X|Xs].
Y = [hello, world, new, user]. 
```

这基本上就是我们在 中使用它的方式`canTravel`：我们有 Through 和 Visited，所以我们正在创建一个新列表，其中以 Through first 和 Visited 作为尾部，这是递归调用的第三个参数。在程序方面，我们只是将通过添加到我们在循环中使用的变量中。

但是因为这是 Prolog，我们不限于在一个方向上使用事物：

```
?- Y = [hello, world, new, user], Y = [X|Xs].
X = hello,
Xs = [world, new, user].

?- Y = [hello, world, new, user], [X|Xs] = Y.
X = hello,
Xs = [world, new, user]. 
```

请注意，Prolog 并不关心分配发生在哪个方向，但它设法“向后工作”以找出 X 和 Xs 应该使用 Y。这是 Prolog 的神奇之处之一。（请注意，在本次会议的示例中，我省略了回显的变量，因为它们模糊了重点。）

通常，您需要能够解决不同参数的谓词。例如，`member/2`可用于测试成员资格或枚举项目。`append/3`可以从两个旧列表构建一个新列表，或者它可以枚举将列表拆分为两个段的所有方法，或者它可以找到给定列表和后缀或前缀的前缀或后缀。

随着您越来越习惯此功能，您将不再将 Prolog 规则视为与其他语言中的函数类似，而是开始将它们视为*关系*：存在于某些结构之间的逻辑“真理”。`member/2`不是通过尝试枚举项目或通过寻找特定值的列表来编写的。它是这样实现的：当 Item 是 List 中的第一件事时，关系`member(Item, List)`为*真：*

```
member(Item, [Item|_]). 
```

或者当 Item 在列表的其余部分时：

```
member(Item, [_|Tail]) :- member(Item, Tail). 
```

该定义足以满足所有可能的用途。如果`Item`没有实例化，它将被实例化为列表中的第一项，然后是该列表尾部的第一项，依此类推。如果`Item`被实例化，如果 Item 是列表中的第一项或它是尾部的第一项，则为 true。令人惊讶的是，`member/2`它甚至可以用于生成包含值的列表：

```
?- member(1, X).
X = [1|_G274] ;
X = [_G8, 1|_G12] ;
X = [_G8, _G11, 1|_G15] . 
```

您可以看到那里发生了什么：`_`第二个子句中的 the 被制成匿名变量，因此它生成列表，其中 1 在第一个位置，然后是第二个，然后是第三个，等等。

很多 Prolog 都是这样工作的。这一个也很令人惊讶：

```
?- length(X, 3).
X = [_G273, _G276, _G279]. 
```

希望这有助于澄清一些事情！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:17:22.857

你有使用一些特定的 Prolog 系统吗？

`:- auto_table.`在具有表格支持的系统（如 B-Prolog）中，您的程序将按预期工作而无需修改（好吧，您必须将其添加为程序的第一行）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T02:02:25.800

我认为添加剪切将停止您的无限递归问题，因为一旦找到答案，它就不会永远回溯：

```
canTravel(From, To) :- nonStopTrain(From, To); nonStopTrain(To, From).
canTravel(From, To) :-
    canTravel(From, Through), canTravel(Through, To), !. 
```

我毫不怀疑有比这更正确的解决方案。

# c# - 如何在 XML 中填充子元素？

> ID：15101125
> 
> 赞同：1
> 
> 时间：2013-02-26T22:59:07.253
> 
> 标签：c#, xml, linq, soap, xml-parsing

我有一个定义如下的 xml (Foo.xml) 模板：

```
<Parent:Request xmlns:user="http://xxx.com/">
<Parent:ElemA></Parent:ElemA>
<Parent:ChildNode>
    <ElemB></ElemB>
    <ElemC></ElemC>
</Parent:ChildNode>
<Parent:ParentName></Parent:ParentName>
</Parent:Request> 
```

在我的代码中，我可以在 xmltemplate 中设置父元素，如下所示：

```
public void FooA( MyDomainObject DoM)
{
    private readonly XNamespace myNS = "http://ANameSpace.com/";
    XElement fooRequestDoc = XElement.Load("Templates/Foo.xml");

    XElement ElemA_El = fooRequestDoc.Descendants(myNS + "ElemA").FirstOrDefault();
    ElemA_El.SetValue(DoM.ElemA); 
} 
```

在这种情况下，如果 ElemA 的值为“ElementA”，则 ElemA_El 参数将设置为此值。

我的问题是，如何设置特定的 Child Note 元素，例如 ElemB 或 ElemC？

我试过使用“元素”（因为我知道它用于检索子元素）如下：

```
XElement ElemB_El = fooRequestDoc.Element(myNS + "ChildNode"); 
```

但它返回的是整个块，而不仅仅是我寻求的 ElemB。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T13:05:03.043

如果您知道标签的名称，您可以执行以下操作：

```
XElement ElemB_El = (from node in fooRequestDoc.Descendants() where node.Name == myNS + "ElemB" select node).FirstOrDefault(); 
```

如果您不知道标签的名称，您可以像这样获取 ChildNode 的每个后代：

```
var nodes = (from node in fooRequestDoc.Descendants(myNS + "ChildNode").Elements() select node).ToList(); 
```

# ruby-on-rails - Twitter Bootstrap - 将文本格式化为段落

> ID：15101138
> 
> 赞同：-1
> 
> 时间：2013-02-26T22:59:51.033
> 
> 标签：ruby-on-rails, twitter-bootstrap

我试图将我的文本放在 div class="span3" 中，但它只是在浏览器中显示为一个长的 1 行字符串。

```
<div class="container">
   <div class="span3" style="padding-bottom:25px">
     <%= link_to image_tag(illustration.image_thumbnail_url), illustration %>
   </div>
   <div class="span3">
     <h4><%= illustration.name + " - " + illustration.source%></h4>
     <p><%= illustration.description %></p>
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:12:34.280

Twitter Bootstrap 系统使用[12 列网格](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)。因此，您必须打开一个`<div class="row">`并且必须有一个或多个`spans`- 总和必须为 12，例如：

```
<div class="row">
  <div class="span4">...</div>
  <div class="span8">...</div>
</div> 
```

我真的不明白你想要达到什么目的，但你还没有打开你`<div class="row">`的总和`spans`不是 12。

您也许可以`row`与您一起打开`container`：

```
<div class="container row">
   <div class="span6" style="padding-bottom:25px">
     <%= link_to image_tag(illustration.image_thumbnail_url), illustration %>
   </div>
   <div class="span6">
     <h4><%= illustration.name + " - " + illustration.source%></h4>
     <p><%= illustration.description %></p>
   </div>
</div> 
```

**编辑**- 尝试以这种方式进行插值：

```
<%= "#{illustration.name} - #{illustration.source}" %> 
```

您还可以使用`html_safe`来显示描述：

```
<%= illustration.description.html_safe %> 
```

查看本指南： http: [//guides.rubyonrails.org/active_support_core_extensions.html#extensions-to-string](http://guides.rubyonrails.org/active_support_core_extensions.html#extensions-to-string)

# java - @Target(ElementType.ANNOTATION_TYPE) 如何工作

> ID：15101139
> 
> 赞同：72
> 
> 时间：2013-02-26T22:59:53.807
> 
> 标签：java, annotations

Java 注解用注解标记`@Target`以声明可以由该注解修饰的可能连接点。枚举的值`TYPE`, `FIELD`,`METHOD`等`ElementType`清晰易懂。

# 问题

**为什么**要`@Target(ANNOTATION_TYPE)`使用价值？带注释的注释有什么用？他们的贡献是什么？**解释一下它是如何工作的**以及我为什么要使用它。一些已经存在且众所周知的使用示例也会很棒。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-26T23:03:09.727

您可以使用带注释的注释来创建元注释，例如考虑`@Transactional`Spring 中的这种用法：

```
/**
 * Shortcut and more descriptive "alias" for {@code @Transactional(propagation = Propagation.MANDATORY)}.
 */
@Target({ElementType.METHOD, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Transactional(propagation = Propagation.MANDATORY)
public @interface RequiresExistingTransaction {
} 
```

当您启用 Spring 来处理`@Transactional`注解时，它将查找带有它的类和方法`@Transactional` *或其*任何元注解（带有注解的注解`@Transactional`）。

无论如何，这只是一个如何使用带注释的注释的具体示例。我想这主要是像 Spring 这样的框架，使用它们是有意义的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-03-04T19:26:07.850

由 注释的每个注释`@Target(ElementType.ANNOTATION_TYPE)`都称为`Meta-annotation`。这意味着，您可以定义自己的自定义注释，将许多注释合并为一个注释以创建`composed annotations`.

Android世界的一个很好的例子是[`StringDef`](https://developer.android.com/reference/android/support/annotation/StringDef)

> 表示带注释的 String 元素表示一种逻辑类型，并且它的值应该是显式命名的常量之一。
> 
> ```
> @Retention(SOURCE)
> @StringDef({POWER_SERVICE, WINDOW_SERVICE, LAYOUT_INFLATER_SERVICE}) 
> public @interface ServicesName {}
> 
> public static final String POWER_SERVICE = "power";
> public static final String WINDOW_SERVICE = "window";
> public static final String LAYOUT_INFLATER_SERVICE = "layout_inflater"; 
> ```

代码检查员将`@ServicesName`和`@WeekDays`以相同的方式处理`@StringDef`。因此，我们可以根据需要创建尽可能多的**named** `StringDef`并覆盖一组常量。`@Target(ElementType.ANNOTATION_TYPE)`它是一个允许扩展注释使用的工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-18T12:30:40.797

例如，如果注释看起来像

```
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface SomeAnnotation {

    String description() default "This is example for class annotation";
} 
```

在这种情况下编译器会抱怨

```
@SomeAnnotation
public class SomeClass {

    @SomeAnnotation    // here it's complaning
    public void someMethod(){}
} 
```

如果你改变

```
@Target(ElementType.TYPE) 
```

到

```
@Target({ElementType.METHOD, ElementType.TYPE}) 
```

它不会再抱怨了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-14T23:25:02.237

1.  为什么要使用@Target(ANNOTATION_TYPE) 值？

简单地说：当需要将注解应用于另一个注解时。如果您查看常见 Java 注释的源代码，您会经常看到以下代码模式：

```
@Target(ANNOTATION_TYPE)
public @interface TheAnnotation
{
  ...
} 
```

例如，

```
@Documented 
@Target({ ANNOTATION_TYPE }) 
@Retention(RUNTIME) 
public @interface Constraint { 
public Class<? extends ConstraintValidator<?, ?>>[] validatedBy(); 
} 
```

2.  带注释的注释有什么用？

如果在另一个注释（定义）类中使用该注释，它们是好的或更确切地说是必要的。

3.  他们的贡献是什么？

它们可以将注释直接应用于另一个注释，这与将注释应用于标准 Java 类或类方法等不同。

4.  解释一下它是如何工作的以及我为什么要使用它。

例如，如果您创建一个数据模型类并希望它检查数据的有效性，则可能需要在某些注解定义类中的@Target 注解中具有这样的值。通过向类添加注释很容易包括这些数据有效性检查：某些值不为空（@notNull），电子邮件有效（@ValidEmail），字段长度超过 x 个字符（@Size）等。有有许多现成的注释可以进行数据有效性检查，但不一定适用于所有目的，例如，如果您想通过添加注释 @PasswordMatches 来检查密码及其匹配密码是否相同。这可以通过创建注释类 PasswordMatches 来实现：

```
@Target({TYPE})
@Retention(RUNTIME)
@Constraint(validatedBy = PasswordMatchesValidator.class)
@Documented
public @interface PasswordMatches {

    String message() default "Passwords don't match";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};

 } 
```

注意有线

```
@Constraint(validatedBy = PasswordMatchesValidator.class) 
```

即注释包含在这个注释定义类中。

PasswordMatchesValidator 类可能如下所示：

```
public class PasswordMatchesValidator implements ConstraintValidator<PasswordMatches, Object> {

@Override
public void initialize(final PasswordMatches constraintAnnotation) {}

@Override
public boolean isValid(final Object obj, final ConstraintValidatorContext context) {
    final UserDto user = (UserDto) obj;
    return user.getPassword().equals(user.getMatchingPassword());
    }
} 
```

现在密码相等检查很容易通过添加注释@PasswordMatches 包含到数据模型类中：

```
@PasswordMatches 
public class UserDto {
... 
} 
```

请注意，仅通过将注释@PasswordMatches 添加到类中才能进行密码检查，并且PasswordMatches 注释类需要具有@Constraint(validatedBy = PasswordMatchesValidator.class) 行。换句话说，一个注解用于注解另一个注解。这是可能的，因为@Constraint 注释（定义）类具有@Target({ ANNOTATION_TYPE }) 行。

注释注释的主要原因是使在注释（定义）类中使用注释成为可能。特别是，如果您想使用注释自定义注释，则需要将 ANNOTATION_TYPE 包含到 @Target 注释值数组到自定义注释类中。

5.  一些已经存在且众所周知的使用示例也会很棒。

在第 4 项中有一个非常著名的示例，但另一个用于注释的已知注释（并且其实现必须具有 @Target(ANNOTATION_TYPE) 行）是 @Retention、@Documented 和 @Target 本身。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2013-02-26T23:13:03.010

注释基本上是与您的代码一起使用的附加元数据（信息）。它可以与侧面类型（类、接口）、方法和参数一起放置。

它在编译时和运行时通常很有用。许多流行的 API（例如 Java EE 5+、Spring、AspectJ）利用注释来提高代码的清晰度和一致性。

使用注解通常可以让代码更易读、更容易理解。

我建议您[通读 Java 教程的注释章节](https://docs.oracle.com/javase/tutorial/java/annotations/)

过去，元数据通常以 xml 文件的形式提供，如果必须查找不同的 xml 配置文件，则很难理解代码。最新的[Java servlet API 允许简单地通过使用注解来映射 servlet——而不是 web.xml 映射](http://docs.oracle.com/javaee/6/tutorial/doc/bnaeo.html)：

```
@WebServlet("/response")
public class ResponseServlet extends HttpServlet {
  // servlet code here...
} 
```

# xmpp - BOSH 模块未启动：Ejabberd / Strophe 设置问题

> ID：15101140
> 
> 赞同：8
> 
> 时间：2013-02-26T22:59:56.343
> 
> 标签：xmpp, ejabberd, strophe

我正在尝试使用内部 Ejabberd 网络服务器在 Ubuntu 12（Linode 最新版本）上使用 Ejabberd 设置 Strophe 来提供聊天服务。

测试网址（[http-bind](http://aviezri.org:5280/http-bind)和[admin](http://aviezri.org:5280/admin)）都可以工作。
JWChat 有效。
Strophe 抛出错误：

```
In Strophe:
RECV: <body xmlns='http://jabber.org/protocol/httpbind' type='terminate' condition='internal-server-error'>BOSH module not started</body>

In ejabberd.log:  
E(<0.468.0>:ejabberd_http_bind:1236) : 
You are trying to use BOSH (HTTP Bind) in host "admin", but the module mod_http_bind is not started in that host. 
Configure your BOSH client to connect to the correct host, or add your desired host` 
```

设置很简单（尽管花了很长时间才解决这个问题）：

1.  使用 sudo apt-get 安装
2.  在 sudo 下运行
3.  使用内部服务器，以避免弄乱代理或设置 PunJab。
4.  在 ejabberd.cfg 中进行了更改。

对 ejabberd.cfg 的更改：

```
%% In listening ports, amended the following lines:  
{ request_handlers,  [   
   {["pub"], mod_http_fileserver},   
   {["http-bind"], mod_http_bind}  
]},  

%% In modules, added the following:  
{ mod_http_fileserver, [   
   {docroot, "/var/lib/ejabberd/www"},   
   {accesslog, "/var/log/ejabberd/access.log"}   
]},  
{mod_http_bind,  []}, 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T08:56:59.493

答案相当明显。

Strophe 需要以下格式的用户名：

> 用户名@host
> 例如。admin@example.com

否则它会假设用户名确实是主机，并且由于这样的主机不存在，它会抛出一个错误`mod_http_bind is not started in that host`

这个错误充其量是误导，但它确实从技术上解释了这个问题。
我试图只使用用户名 [在 JWChat 中运行良好] 登录，因此出现了问题。

如果这不起作用，请列出要验证的其他一些事项的清单：

1.  确保您的域已添加到 /etc/hosts

    ```
    127.0.0.1    localhost.localdomain   localhost
    12.34.56.78  squire.example.com  squire 
    ```

2.  确保您的域已添加到 /etc/ejabberd/ejabberd.cfg

    ```
    %% Hostname
    Hostname {hosts, ["example.com","98.765.43.21","localhost"]}. 
    ```

3.  确保您的用户名存在并已注册：

    ```
    ejabberdctl register username example.com password 
    ```

    如果用户是管理员，则包含在 ejabberd.cfg [注意：它**也**必须注册！]

    ```
    %% Admin user
    {acl, admin, {user, "", "localhost"}}.
    {acl, admin, {user, "admin", "example.com"}}. 
    ```

4.  检查服务器是否正在运行：

    ```
    a. sudo ejabberdctl status  
    b. http://example.com:5280/admin  
    c. http://example.com:5280/http-bind 
    ```

5.  如果有问题，请重新使用两者（我知道理论上您不需要两者。在实践中，有时使用其中一个或另一个将无法正常工作。）

    ```
    sudo /etc/init.d/ejabberd restart
    sudo ejabberdctl restart 
    ```

6.  检查日志 - /var/log/ejabberd/ejabberd.log（[见这里](https://stackoverflow.com/questions/13166950/connection-failure-when-using-strophe-with-ejabberd-bosh-to-connect-to-jid-accou)）。

7.  安装 JWChat 并尝试（或者，如果您有 JWChat，请安装 Strophe）。
    以下简短教程非常宝贵，请完全按照：[http ://www.ejabberd.im/jwchat-localserver](http://www.ejabberd.im/jwchat-localserver)

# php - 具有过滤和导出功能的基于 PHP 的数据库表“查看器”，专门用于数据查看和报告目的？

> ID：15101142
> 
> 赞同：0
> 
> 时间：2013-02-26T22:59:56.633
> 
> 标签：php, database, filter

在我重新发明轮子之前，我希望有人知道一个流行的基于 PHP 的数据库表“查看器”，它可以通过枚举值配置每列过滤并包括导出功能。理想情况下，这将是用于数据探索/查看/报告目的的工具。

编辑——我似乎在激怒人们……我很抱歉。是的，我先用谷歌搜索，然后是堆栈溢出，然后又用不同的术语搜索。

这就是我要找的：

我们可以按照“tableview.php”的方式调用并传递 $_REQUEST 以下内容：

*   表名
*   过滤列名称（将用于过滤页面的内容 - 值的枚举将在加载时发生）
*   仅当您单击行时才会在模式或弹出窗口中可见的子列
*   导出为 csv、pdf、xls 等

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-26T23:06:45.613

我确定你正在寻找[这个](http://www.phpgrid.org)

[在此处](http://www.phpgrid.org/demo-center/)查看演示

# jquery - 如何让 jQuery Mobile 在桌面上工作？

> ID：15101145
> 
> 赞同：1
> 
> 时间：2013-02-26T23:00:11.937
> 
> 标签：jquery, html

如果您访问 jquery mobile，您会看到该站点具有实现移动工具的代码，但这些工具也适用于他们的桌面版本，所以我想知道他们是如何做到的。

链接在这里：http: [//jquerymobile.com/demos/1.2.0/docs/forms/switch/](http://jquerymobile.com/demos/1.2.0/docs/forms/switch/)

我试图在网站上实施代码，但我没有运气。

```
In the header:
    <script src="http://code.jquery.com/jquery-latest.min.js"
            type="text/javascript"></script> 
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>

In the body:    
<div class="containing-element">
        <label for="flip-min">Flip switch:</label>
        <select name="flip-min" id="flip-min" data-role="slider">
            <option value="off">Switch Off</option>
            <option value="on">Switch On</option>
        </select>
    </div> 
```

为什么这会导致不同的结果？这将返回如下所示的内容： ![在此处输入图像描述](../Images/8fc4891b97061d01cfc768a1c02b96e8.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:05:39.657

我相信这可能是因为您没有链接库附带的 Jquery 移动样式表。正是它附带的 css 样式使许多 ui 元素看起来像您在他们的网站上看到的那样。

把它记在你的脑海里

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" /> 
```

并将其添加到您的主包装器 div

```
<div data-role="page"> 
```

# android - 来自android的发布方法不起作用

> ID：15101146
> 
> 赞同：1
> 
> 时间：2013-02-26T23:00:14.230
> 
> 标签：android, post, http-post

所以，我正在尝试进行登录活动。它使用来自 mySql 的数据库，所以我创建了一个 php webservice 1login.php。然后我有一个带有方法 makeHttpRequest(url,method,params) 和一个 LoginActivity 类的 JSONParser 类。但有一个问题。我无法将参数发送到 Web 服务，但是当我尝试使用 GET 方法时，它起作用了（char '@' 有一些问题）。我想了解如何使用 Post 方法。以下是代码：

PHP：（它运作良好，所以我认为问题不在这里）

```
<?php

include "0conn.php";
$email =$_POST["email"];
$heslo =$_POST["heslo"];
$pass=sha1($heslo);
$query = mysqli_query($conn,"SELECT jmeno,email FROM users WHERE email='$email' AND heslo='$pass'");
$res=array();
$response=array();
if(mysqli_num_rows($query)==1){
$result=mysqli_fetch_array($query);
$res["vysledek"]=1;
$res["email"]=$result["email"];
$res["jmeno"]=$result["jmeno"];
}
else  $res["vysledek"]=0;
$response[]=$res;
mysqli_free_result($query);
echo json_encode($response);
?> 
```

JSONParser 类：

```
package com.thevnkid93.ucebnice;

    import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.R.integer;
import android.os.AsyncTask;
import android.util.Log;

    public class JSONParser{

        static InputStream is = null;
        static JSONObject jObj = null;
        static JSONArray jArr=null;
        static String json = "";

        // function get json from url
        // by making HTTP POST or GET method
        public static JSONArray makeHttpRequest(String url, String method,
                List<NameValuePair> params) {

            // Making HTTP request
            try {
                // check for request method
                if(method.equals("POST")){
                    // request method is POST
                    // defaultHttpClient

                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    HttpPost httpPost = new HttpPost(url);
                    httpPost.setEntity(new UrlEncodedFormEntity(params,"utf-8"));

                    HttpResponse httpResponse = httpClient.execute(httpPost);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();

                }else if(method.equals("GET")){
                    // request method is GET
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    String paramString = URLEncodedUtils.format(params, "utf-8");
                    url += "?" + paramString;
                    HttpGet httpGet = new HttpGet(url);

                    HttpResponse httpResponse = httpClient.execute(httpGet);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();
                }           

            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            try {
                BufferedReader reader = new BufferedReader(new InputStreamReader(
                        is, "iso-8859-1"), 8);
                StringBuilder sb = new StringBuilder();
                String line = null;
                while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                }
                is.close();
                json = sb.toString();
            } catch (Exception e) {
                Log.e("Buffer Error", "Error converting result " + e.toString());
            }

            // try parse the string to a JSON object
            try {
                jArr = new JSONArray(json);
            } catch (JSONException e) {
                Log.e("JSON Parser", "Error parsing data " + e.toString());
            }
            // return JSON String (Array)
            return jArr;
        }

} 
```

和 LoginActivity 类：

```
package com.thevnkid93.ucebnice;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ExecutionException;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class LoginActivity extends Activity{

    EditText e1,e2;
    Button b1,b2;
    List<NameValuePair>infoPost=new ArrayList<NameValuePair>();
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.login_layout);
        e1 = (EditText)findViewById(R.id.login_e1);
        e2 = (EditText)findViewById(R.id.login_e2);
        b1 = (Button)findViewById(R.id.login_b1);
        b2 = (Button)findViewById(R.id.login_b2);

        b1.setOnClickListener(new OnClickListener(){

            public void onClick(View arg0){
                    int vys=0; 
                    String email=e1.getText().toString();
                    String heslo=e2.getText().toString();
                    LoadInfo loadi=new LoadInfo();
                    try {
                        vys=loadi.execute(email,heslo).get();
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } catch (ExecutionException e) {
                        Toast.makeText(LoginActivity.this, "xxxxxxxx", Toast.LENGTH_LONG).show();
                        e.printStackTrace();
                    }

                    Toast.makeText(LoginActivity.this, ""+vys, Toast.LENGTH_LONG).show();
            }
        });//TLACITKO PRIHLASENI

    }

}

class LoadInfo extends AsyncTask<String, String, Integer>{
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    @Override
    protected Integer doInBackground(String... args) {
        params.add(new BasicNameValuePair("email", args[0]));
        params.add(new BasicNameValuePair("heslo", args[1]));
        JSONArray jArray = JSONParser.makeHttpRequest(my_url, "POST", params);
        int vys=0;
        try {
            JSONObject jobject = jArray.getJSONObject(0);
            vys=jobject.getInt("vysledek");
        } catch (JSONException e) {
            vys=2;  
            e.printStackTrace();
        }
        return vys;
    }   

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T00:26:53.910

先说第一件事。我们需要更具体的信息然后“它只是不起作用”

你需要做的事情。

1）使用一个很棒的教程。我强烈推荐[这个](http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/)。

2）在检查代码之前，请确保您的 php 可以正常工作。有一个伟大的！名为[POSTman](https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en)的测试仪。用它测试你的 php 代码。

3）更好地组织你的课程。您应该创建（就像我发布的教程一样）一个 useractions 类来处理 Web 调用和对您创建的 JSON 类的调用。

通过这三件事，您可以调试您的代码，然后给我们一个更具体的问题，社区很可能会帮助您解决。

# c# - 如果一个应用程序中的多个线程调用一个 DLL 会发生什么

> ID：15101150
> 
> 赞同：5
> 
> 时间：2013-02-26T23:00:52.567
> 
> 标签：c#, c++, dll

我想知道当一个应用程序中的三个线程（几乎）同时从 DLL 调用静态方法时会发生什么。是否为每个线程加载了 3 个 DLL 实例，或者其他线程是否只有在第一个线程使用 DLL 静态方法完成后才能访问 DLL（即）每个线程一旦轮到它就可以访问 dll？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-26T23:23:36.190

> 是否加载了 3 个 DLL 实例，每个线程一个？

不会。DLL*通常*每个进程加载一次。（这里有一些微妙的问题；如果你使用`Load`and ，同一个程序集可能会被加载两次`LoadFrom`。但这是一种罕见的情况，与线程无关。）

> 是否只有在第一个线程使用 DLL 静态方法完成后才能访问 DLL？

不; 静态方法**不会**自动序列化。如果您需要该方法来确保一次只有一个线程访问它，那么您将不得不自己编写代码来执行此操作。

静态*构造函数*的行为确实有点像这样。运行时将确保“赢得比赛”的线程将运行静态构造函数。其他线程将等待第一个线程完成 cctor。有关详细信息，请阅读我最近的系列文章。

[http://ericlippert.com/tag/static-constructors/](http://ericlippert.com/tag/static-constructors/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T23:02:28.170

通常，代码会被加载*一次*，即使对于非静态对象也是如此。

您必须担心 的是声明变量（统称为*state ）中包含的信息，而不是代码。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T23:30:54.930

DLL 仅在内存中加载一次。

如果同一进程中有多个线程调用或访问 DLL 中的全局变量，则 DLL 必须通过使用临界区保护对全局/共享数据的访问来保证线程安全。

如果有来自多个进程的多个线程访问 DLL，只要访问同一个 DLL 的进程的线程不超过一个，线程安全就不是问题。

操作系统巧妙地管理内存，使得最初它只从代码和数据部分的一份副本开始。数据部分页面以只读方式映射。当需要在其中一个进程中修改任何全局数据时，操作系统会出现分段错误并创建页面的副本并将其映射为进程的内存空间中的可写。这种方法称为写时复制。

# java - 基本 Java Web 服务器 - 接收 SocketException：连接重置

> ID：15101151
> 
> 赞同：0
> 
> 时间：2013-02-26T23:00:53.480
> 
> 标签：java, sockets, webserver

我试图创建一个基本的符合 HTTP/1.1 的 Web 服务器，它支持具有持久连接的简单 GET 请求。我得到一个 SocketException: Connection Reset 错误发生在第 61 行（if (line==null || line.equals(""))。我正在通过运行它然后将我的 chrome 浏览器定向到 localhost 端口号来测试它。当我使用具有多个图像的页面对其进行测试时，似乎在发生异常之前只处理了一个请求，但我不确定出了什么问题，因为这是我第一次尝试任何类型的套接字编程。

这是删除 DataOutputStream 后我更新的代码：

```
import java.io.BufferedReader;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStreamReader;
import java.io.ObjectOutputStream;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.URI;
import java.net.URISyntaxException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.HashMap;
import java.util.StringTokenizer;

public class webserve
{
    public static void main(String[] args) throws Exception
    {
        String rootPath = "~/Documents/MockWebServerDocument/";
        int port = 10000;

        if(rootPath.startsWith("~" + File.separator))
        {
            rootPath = System.getProperty("user.home") + rootPath.substring(1);
        }

        String requestLine="";
        StringTokenizer tokens=null;
        String line, command;
        Date date = new Date();
        String connectionStatus="";

        //Create new server socket listening on specified port number
        ServerSocket serverSocket = new ServerSocket(port);

        while(true)
        {
            //Wait for a client to connect and make a request
            Socket connectionSocket = serverSocket.accept();
            System.out.println("Socket opened");

            //Input stream from client socket
            BufferedReader incomingFromClient = new BufferedReader(new InputStreamReader(connectionSocket.getInputStream()));
            //PrintWriter to send header to client socket
            PrintWriter outgoingHeader = new PrintWriter(connectionSocket.getOutputStream(),true);
            //OutputStream to send file data to client socket
            ObjectOutputStream outgoingFile = new ObjectOutputStream(connectionSocket.getOutputStream());
            //Date format for HTTP Header
            SimpleDateFormat HTTPDateFormat = new SimpleDateFormat("EEE MMM d hh:mm:ss zzz yyyy");

            //Create a HashMap to store the request header information
            HashMap<String,String> requestHeader = new HashMap<String,String>();

            while(connectionSocket.isConnected())
            {
                //requestHeader.clear();

                while((line = incomingFromClient.readLine()) != null)
                {
                    if(line.isEmpty())
                    {   
                        break;
                    }
                    //If this is the first line of the request, i.e doesnt contain a colon
                    if(!(line.contains(":")))
                    {
                        requestLine = line;
                        requestHeader.put("Request", requestLine);
                    }
                    else
                    {
                        //Otherwise, find the colon in the line and create a key/value pair for the HashMap
                        int index = line.indexOf(':')+2;
                        String header = line.substring(0,index-1);
                        line = line.substring(index).trim();

                        requestHeader.put(header, line);

                        System.out.println(header + " " + line);
                    }
                }   

                connectionStatus = (String)requestHeader.get("Connection:");
                requestLine = (String)requestHeader.get("Request");

                System.out.println("RequestLine: " + requestLine);

                if(!requestLine.equals("")||!(requestLine.equals(null)))
                {
                    tokens = new StringTokenizer(requestLine);

                    command = tokens.nextToken();
                    String filename = tokens.nextToken();
                    filename = cleanUpFilename(filename);
                    String fullFilepath = rootPath + filename;
                    System.out.println("Full FilePath: " + fullFilepath);

                    File file = new File(fullFilepath);

                    //Get the number of bytes in the file
                    int numOfBytes=(int)file.length();

                    //Open a file input stream using the full file pathname
                    FileInputStream inFile = new FileInputStream(fullFilepath);

                    //Create byte array to hold file contents
                    byte[] fileInBytes = new byte[numOfBytes];

                    inFile.read(fileInBytes,0,numOfBytes);

                    inFile.close();

                    //Write the header to the output stream 
                    outgoingHeader.print("HTTP/1.1 200 OK\r\n");
                    outgoingHeader.print("Date: " + HTTPDateFormat.format(date)+"\r\n");
                    outgoingHeader.print("Server: BC-Server\r\n");
                    outgoingHeader.print("Last-Modified: " + HTTPDateFormat.format(file.lastModified())+"\r\n");
                    outgoingHeader.print("Connection: keep-alive\r\n");
                    outgoingHeader.print("Content-Length: " + numOfBytes);
                    outgoingHeader.print("\r\n\r\n");               

                    //When the header has been printed, write the byte array containing the file
                    //to the output stream
                    outgoingFile.writeObject(fileInBytes);

                    if(!(connectionStatus.equals("keep-alive")))
                    {
                        System.out.println("Closing: " + connectionStatus);
                        outgoingHeader.close();
                        outgoingFile.close();
                        break;
                    }
                    else
                        continue;

                }       

            }

        }
    }

    public static String cleanUpFilename(String filename)
    {
        //If there is a "/" at the start of the filename, then remove it
        if(filename.charAt(0) == '/')
        {
            filename = filename.substring(1);
        }

        //If we are given an absolute URI request, strip all characters
        //before the third "/"
        if(filename.startsWith("http://"));
        {
            try
            {
                URI httpAddress = new URI(filename);

                //Get the path from the supplied absolute URI, that is remove
                //all character before the third "/"
                filename = httpAddress.getPath();

                //Again, we may have to trim this modified address if there is an
                //extra "/" at the start of the filename
                if(filename.charAt(0) == '/')
                {
                    filename = filename.substring(1);
                }
            }
            catch (URISyntaxException e)
            {                   
                e.printStackTrace();
            }
        }

        return filename;
    } 
```

}

这是我的错误跟踪：

```
Exception in thread "main" java.net.SocketException: Connection reset
    at java.net.SocketInputStream.read(SocketInputStream.java:185)
    at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:282)
    at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:324)
    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:176)
    at java.io.InputStreamReader.read(InputStreamReader.java:184)
    at java.io.BufferedReader.fill(BufferedReader.java:153)
    at java.io.BufferedReader.readLine(BufferedReader.java:316)
    at java.io.BufferedReader.readLine(BufferedReader.java:379)
    at webserve.main(webserve.java:61) 
```

任何帮助将不胜感激，因为我完全不知所措。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:09:10.660

尝试使用 telnet、wget 或 curl 而不是 chrome 来测试连接，因为这样您就可以控制 TCP/IP 连接的两端。

我认为您的网络客户端正在从它的一侧关闭连接，并且您尝试再次从该套接字读取（是的，`isConnected()`当远程方关闭连接时甚至会抛出此错误）。我也很遗憾地说，除了捕获异常并优雅地处理它之外，没有简单的方法来解决这个问题。

这是同步套接字经常发生的问题。尝试改用`java.nio`通道和选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T01:38:32.823

您的服务器最明显的问题是它不是多线程的。重新阅读您对问题的描述后，这似乎是根本原因。每个连接需要一个线程。之后`serverSocket.accept()`，创建一个新线程来处理connectionSocket。

```
 while(true)
    {
        //Wait for a client to connect and make a request
        Socket connectionSocket = serverSocket.accept();

        new Thread()
        {
            public void run()
            {
                //Input stream from client socket
                BufferedReader incomingFromClient = ...

                etc

            }
        }.start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T00:55:03.420

同时使用多个输出流是很成问题的。在这种情况下，您不应该创建，`ObjectOutputStream`直到您确定要编写一个对象并且您已经写入并刷新了标头，因为`ObjectOutputStream`将标头写入输出，在您当前的代码中，它可能会出现在任何标头之前导致客户呕吐。

通常，`SocketException: Connection Reset`通常意味着您已写入已被对等方关闭的连接。在这种情况下，对等方是客户端，客户端是 Web 浏览器，这可能意味着任何事情，例如用户停止加载页面，他浏览离开，退出浏览器，关闭选项卡。这不是你的问题。只需关闭套接字并忘记它。

出于同样的原因，您的服务器还应该设置一个合理的读取超时时间，比如 10-30 秒，并在它触发时退出。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-26T23:37:49.067

您不能使用`DataOutputStream`，它是用于 Java-Java 通信的。尝试`Writer`写入标头，原始 O​​utputStream 用于写入文件内容。

发生的事情是浏览器看到无效响应并关闭连接。服务仍在写入客户端，客户端响应 RST，因为连接消失了。

# c++ - Eclipse C/C++ 错误 1 架构 x86_64 的重复符号

> ID：15101153
> 
> 赞同：5
> 
> 时间：2013-02-26T23:01:06.280
> 
> 标签：c++, eclipse

运行简单程序时，我在 Eclipse 中遇到这些错误。- 我安装了命令行工具。 ![我在 Eclipse 中的工作区的屏幕截图](../Images/6fd808c3bb825ec733fffe8d809206de.png)

我真的不知道该怎么做。我一直在使用 eclipse 进行 Java 课程，然后下载了 C/C++ 工作站，尽管有一些问题。任何帮助是极大的赞赏。顺便说一句，我在 Mac 最新的操作系统上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-01T17:03:30.873

很可能你有两个`main()`s。你的`src`文件夹里有什么？（确保没有任何其他 c 文件与您的文件一起编译。

# mysql - SQL Server 到 MySql 的转换 - sysobjects

> ID：15101156
> 
> 赞同：0
> 
> 时间：2013-02-26T23:01:37.617
> 
> 标签：mysql, sql-server, mysql-workbench

我正在尝试将以下 SQL Server 代码转换为 MySql ...

```
 SELECT 
        columns  = COALESCE(columns + ',', '') + Cast(sc.name AS char(64))
  FROM 
        sysColumns sc 
  INNER JOIN 
        sysObjects so ON sc.ID = so.ID
  WHERE 
        so.type = 'u'; AND 
        so.name = tableName; 
```

此转换是否有任何工具或参考链接？

我发现我可以使用`all_source`for`sysObjects`但不确定用于`sysColumns`和`tableName`.

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:17:17.397

[SQL小提琴](http://sqlfiddle.com/#!2/be99e/8)

**MySQL 5.5.30 架构设置**：

```
CREATE TABLE IF NOT EXISTS `category` (
  `id` int(11) NOT NULL,
  `parent_id` int(11) NOT NULL,
  `label` varchar(20) NOT NULL,
  `level` int(11) NOT NULL,
  `path` varchar(100) NOT NULL,
  `sortorder` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

**查询 1**：

```
SELECT t.table_name,
  group_concat( c.column_name ORDER BY c.ordinal_position ) AS columns
FROM information_schema.tables t
  JOIN  information_schema.columns c ON t.table_name = c.table_name
WHERE t.table_name = 'category'
GROUP BY t.table_name 
```

**[结果](http://sqlfiddle.com/#!2/be99e/8/0)**：

```
| TABLE_NAME |                                 COLUMNS |
--------------------------------------------------------
|   category | id,parent_id,label,level,path,sortorder | 
```

# ios - 如何使用 Parse with iOS 与其他用户共享对象？

> ID：15101157
> 
> 赞同：1
> 
> 时间：2013-02-26T23:01:42.657
> 
> 标签：ios, objective-c, xcode, facebook, parse-platform

我已经浏览了 parse.com 上的一些教程，并且我对用户创建对象并将它们存储在 Parse 中没有问题。

我不知道该怎么做是将对象传递给另一个用户。因此，例如，如果我的用户有自己的待办事项列表，而一个朋友想要添加到另一个用户的待办事项列表中，我将如何去做呢？所以一个用户会创建对象：

```
PFObject *task = [PFObject objectWithClassName:@"ToDo"];
[task setObject:@"Do the dishes" forKey:@"userName"];
[task save]; 
```

但我希望这个用户将任务传递给他们的朋友，所以当他们的朋友启动应用程序时，他们会看到该任务已添加到他们的列表中。

我也在使用 Facebook SDK，所以如果有什么可以帮助的，我可以使用它。

我以前没有使用过 Core Data，所以我希望通过 parse 处理很多后端工作，这样我可以暂时避免学习曲线。

感谢所有的帮助

我想补充一点，我不一定要寻找“答案”。我只是以前没有做过这样的事情，所以我不知道在哪里看。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T21:27:33.937

您想为此使用用户指针和 ACL。

```
// assume PFUser *assigned 
PFACL *acl = [PFACL ACLWithUser:PFUser.currentUser];
[acl setReadAccess:YES forUser:assigned];
PFObject *todo = [PFObject objectWithClassName:@"Todo"];
todo[@"task"] = @"Wash dishes";
todo[@"user"] = assigned;
todo.ACL = acl;
[todo saveInBackground]; 
```

现在，你可以看到所有的 TODO

```
[PFQuery queryWithClassName:@"Todo"]; 
```

您可以查看分配给您的所有查询

```
[query whereKey:@"user" equalTo:PFUser.currentUser]; 
```

只有 TODO 的创建者可以编辑它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:11:51.077

看起来你在这里有一个多对多的关系：一个用户可以拥有许多 todo 对象，而一个 todo 对象可以被许多用户拥有。

这种方法可以用`PFRelation`对象来处理。在这里查看官方博客文章：http: [//blog.parse.com/2012/05/17/new-many-to-many/](http://blog.parse.com/2012/05/17/new-many-to-many/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T00:33:49.450

在这种情况下，我不会将其视为多对多关系。

创建 todo 对象的人应该是唯一的所有者。你可以为 todo 对象添加一个属性，它的类型可以是一个数组。然后，该阵列可以跟踪与谁共享它。如果与之共享的人删除了它，您可以将它们从数组中删除，或者如果所有者删除它，则可以删除该对象。

# python - 创建嵌套列表的问题

> ID：15101158
> 
> 赞同：0
> 
> 时间：2013-02-26T23:01:46.443
> 
> 标签：python, google-app-engine

我是新手，所以如果我忽略了一些基本的东西，请多多包涵，但我正在尝试创建一个网站，列出我朋友的瑜伽工作室的瑜伽课程，从概念上讲，它应该看起来像这样：

```
Monday

Dynamic Yoga with Mary 6pm

Soft yoga with Susie 8pm

Wednesday

Hatha yoga with Bob 5pm

Hot yoga with Alice 7pm 
```

所以我想获取课程列表，然后看看周一是否有瑜伽课。如果有，我将“星期一”添加到列表和所有星期一的课程中，以此类推。

问题：

到目前为止，我的代码附加了所有有瑜伽课的日子，然后添加了从整周到每天的所有课程，此时他们应该只添加与每一天相对应的课程。

即应该是什么时候：

```
Monday_list = [Monday, [[Class1Monday],[Class2Monday]] 
```

相反：

```
Monday_list [Monday, [[CLass1Monday],[CLass2Monday],[CLass1Tuesday],[CLass2Tuesday]]] 
```

这是我的代码（它在 Google App Engine 上，这可能解释了代码中的一些奇怪之处......）：

```
def get_classes():
    weekly_classes = []
    d = {1: 'Monday', 
         2: 'Tuesday', 
         3: 'Wednesday', 
         4: 'Thursday', 
         5: 'Friday', 
         6: 'Saturday', 
         7: 'Sunday'}
    yoga_classes = Schema.all() #appengine DB request
    if yoga_classes:
         #list that will be sent to template
        for n in range(1,8):
            day_classes = []
            for e in yoga_classes:
                if e.weekday == n:
                    day = d[n]
                    class_output = [str(e.name),
                                    str(e.teacher),
                                    str(e.description)
                                    ]
                day_classes.append(class_output)
            day_output = [day,day_classes]
            weekly_classes.append(day_output)
        self.response.out.write(weekly_classes) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T01:59:17.930

这里有一些更多的 Pythonic 代码，利用[`itertools`](http://docs.python.org/2/library/itertools.html#itertools.groupby). 数据按照 的要求按天排序`groupby()`，然后分组。我发现对 range 函数的任何使用都表明您正在做的事情比 python 更多的是 C，并且可能有一种更简洁的方法来做到这一点。请注意，此代码的绝大多数只是设置要使用的虚拟数据。

```
class Yoga():
    def __init__(self,weekday,name,teacher,description):
        self.weekday=weekday
        self.name=name
        self.teacher=teacher
        self.description=description
    def __str__(self):
        return "%s yoga with %s %s" % (self.name,self.teacher,self.description)
    def __repr__(self):
        return str(self)

# just make up some data to work with
yoga_classes = (Yoga(1,"dynamic","mary","6pm"),
                Yoga(1,"soft","susie","8pm"),
                Yoga(3,"hatha","bob","5pm"),
                Yoga(3,"hot","alice","7pm"))

daylookup = (None,"Monday","Tuesday","Wednesday",
            "Thursday","Friday","Saturday","Sunday")

import itertools
def get_classes():
    weekly_classes = []
    ycsorted = sorted(yoga_classes,key=lambda x: x.weekday)
    for k,g in itertools.groupby(ycsorted,key=lambda x: x.weekday):
        weekly_classes.append((daylookup[k],tuple(g)))
    return weekly_classes

import pprint
pprint.pprint(get_classes()) 
```

# c++ - Qt 下载文件 - QNetworkAccessManager，未获取数据

> ID：15101159
> 
> 赞同：2
> 
> 时间：2013-02-26T23:01:52.440
> 
> 标签：c++, qt, download, qnetworkaccessmanager, qtnetwork

我正在尝试让我的应用程序从 URL（通常是 EXE 或 Jar）下载文件，但这并不是说这应该改变很多。我让这一切都在一个线程中运行，但我认为这不会有所作为（如果它确实让我知道的话）。

所以 Do_Download 是我创建管理器、设置 URL 和请求并执行获取的函数。然后我尝试将完成的信号连接到将写入文件的插槽。

```
void DownloadManager::Do_Download() {
    QNetworkAccessManager *netManager = new QNetworkAccessManager(this);
    QUrl url(install_mirror); //istall_mirror is the URL provided by user
    QNetworkRequest req(url);

    QNetworkReply *reply = netManager->get(req);

    connect(reply, SIGNAL(finished()), this, SLOT(writeData()));
} 
```

我的 writeData 函数检查错误，如果没有错误，它将数据写入文件。

```
void DownloadManager::writeData() {
    QNetworkReply *reply = qobject_cast<QNetworkReply*>(sender());

    if (reply) {
        if (reply->error() == QNetworkReply::NoError) {
            QFile file(location);
            if(file.open(QIODevice::WriteOnly)) {
                    file.write(reply->readAll());
            } else {
                errorMessage = "Error writing downloaded file for mirror installation";
            }
        } else {
            //get http status code
            int httpStatus = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute).toInt();
            errorMessage = "HTTP Error code while downloading from mirror: " + httpStatus;
        }

        reply->deleteLater();
    } else {
        errorMessage = "Error downloading file from installation mirror";
    }
} 
```

问题是没有数据被写入。它只是创建一个 0Kb 文件。我尝试添加一个下载进度槽，这样我就可以看到接收数据的情况。所以我将此添加到我的 Do_Download 方法中。

```
connect(reply, SIGNAL(downloadProgress(qint64,qint64)), this, SLOT(DL_Progress(qint64,qint64)));

void DownloadManager::DL_Progress(qint64 recieved, qint64 total) {
    std::cout << recieved << " / " << total << endl;
} 
```

输出显示一次为 0 / 01

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-13T19:30:33.963

我在您的代码中看到的唯一问题是您没有等待下载完成。NetworkRequest 对象将在函数调用结束时被破坏。

所以，我会像这样重写 Do_Download （QEventLoop 同步网络请求）：

```
void DownloadManager::Do_Download() {
    QEventLoop eventLoop;
    QNetworkAccessManager *netManager = new QNetworkAccessManager(this);
    QUrl url(install_mirror); //istall_mirror is the URL provided by user
    QNetworkRequest req(url);

    QNetworkReply *reply = netManager->get(req);

    connect(reply, SIGNAL(finished()), &eventLoop, SLOT(quit()));
    eventLoop.exec();

    writeData(reply);
} 
```

# c# - 如何通过单击按钮更改网格颜色？

> ID：15101163
> 
> 赞同：0
> 
> 时间：2013-02-26T23:02:20.097
> 
> 标签：c#, windows-phone-8

我试图在 Windows Phone 8 中创建一个应用程序，该应用程序在单击按钮时会更改网格的颜色，我可以使用一些帮助。

我在网上搜索过，但似乎找不到任何满足我需要的答案。

我目前只有这个：

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    Random random = new Random();
    int number = random.Next(0, 1);

    if (number == 1)
    {
        yesornogrid.Background = SolidColorBrush 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:09:16.033

使用以下名称空间：

```
using System.Windows.Media; 
```

然后尝试：

```
yesornogrid.Background = new SolidColorBrush([Some Color]); 
```

例如：

```
yesornogrid.Background = new SolidColorBrush(Colors.Orange); 
```

# python - 从列表中提取特定数据条目（作为组）并存储在单独的列表中？

> ID：15101168
> 
> 赞同：2
> 
> 时间：2013-02-26T23:02:42.220
> 
> 标签：python, list, nested-loops

例如，这是我正在循环的列表的示例，['n', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16、17、18、19、20、21、22、23、24、25、26、27、28、29、30、31、32、33、34、35、36、37、'n'、'n '，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'， 'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n '、'n'、'n'、'n'、'n'、'n'、'n'、'n'、'n'、82、83、84、85、86、87、88、'n '、'n'、'n'、'n'、'n'、'n'、'n'、'n'、'n'、'n'、'n'、'n'、'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n' ，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，'n'，''n'，'n'，'n'， 178、179、180]

该列表是从先前调用的函数生成的（已插入 n 以隐藏不需要的值）。

我正在尝试将在 n 之间分隔的数字分组并将它们发送到一个列表，例如取数字 1-37-> 放入列表中，取数字 82-88-> 不同列表，178-180-> 发送到不同的列表。

棘手的部分是列表中并不总是包含相同的数据集，“组”可以是任意大小和位置。唯一的定义特征是它们由 n 分隔。

到目前为止我的尝试：

```
for i in range(0, len(lists)):
        for index, item in enumerate(lines):
            if item != 'n': #if item is not n send to list
                lists[i].append(item)           
            elif lines[index+1] == 'n':#if the next item is an n
                 del lines[:index] 
```

其中“列表”实际上是在此函数之外创建的列表列表，为了存储每个组，列表的数量由需要存储的组的数量决定。

'lines' 是我希望循环的值列表。

我的逻辑是，所有不是“n”的值都附加在第一个列表中，如果下一个值是 n，则删除之前的所有值并循环遍历新列表，将下一组值放入下一个列表。很快。

除了我得到：列表索引超出范围

我明白，但我希望有办法绕过它。我也尝试在 elif 处跳出循环，但是我无法继续我离开的循环。我最后的尝试是在第一次运行后设置的位置重新启动循环，如下所示：

```
place=0
    for i in range(0, len(lists)):
        for index, item in enumerate(lines[place:]):
            if item != 'n': #if item is not n send to list
                lists[i].append(item)           
            elif lines[index+1] == 'n':#if the next item is an n
                 place=[index]
                 break 
```

切片索引必须是整数或 None 或具有**索引**方法

希望这很清楚，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:18:37.687

```
from itertools import groupby

data =  ['n', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 82, 83, 84, 85, 86, 87, 88, 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 178, 179, 180]

def keyfunc(n):
  return n == 'n'

groups = [list(g) for k, g in groupby(data, keyfunc) if not k] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T23:17:43.507

```
>>> import itertools
>>> data = ['n', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 82, 83, 84, 85, 86, 87, 88, 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 178, 179, 180]
>>> [list(g) for k, g in itertools.groupby(data, lambda x: x != 'n') if k]                                                                                                
[[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37],
 [82, 83, 84, 85, 86, 87, 88],
 [178, 179, 180]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:22:07.887

这有效：

```
li=['n', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 82, 83, 84, 85, 86, 87, 88, 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 'n', 178, 179, 180]

from itertools import groupby

def is_n(c): return c=='n'

print [list(t1) for t0,t1 in groupby(li, is_n) if t0==False] 
```

印刷：

```
[[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], [82, 83, 84, 85, 86, 87, 88], [178, 179, 180]] 
```

如果你想做这个“原始”（没有 itertools），这个工作：

```
def is_n(c): return c=='n'

def divide(li, f):
    r=[]
    while li:
        while li and f(li[0]):
            li.pop(0)
        sub=[]
        while li and not f(li[0]):
            sub.append(li.pop(0))
        r.append(sub)
    return r

print divide(li,is_n) 
```

或者，如果您想使用 for 循环：

```
def divide4(li,f):
    r=[]
    sub=[]
    for e in li:
        if f(e):
            if len(sub)==0:
                 continue
            else:
                r.append(sub)
                sub=[]    
        else:
            sub.append(e)
    else:
        if len(sub): r.append(sub)
    return r  

print divide4(li,is_n) 
```

无论哪种情况，打印：

```
[[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], [82, 83, 84, 85, 86, 87, 88], [178, 179, 180]] 
```

itertools 更快，更容易，经过验证。用那个。

# java - Java try-catch 在 while 循环内部或外部

> ID：15101169
> 
> 赞同：2
> 
> 时间：2013-02-26T23:02:44.567
> 
> 标签：java

有什么区别：

```
while( true ) {
    try {
        // something 
    } catch( Exception e ) {
        break; 
    }
} 
```

和

```
try {
    while( true ) {
    // something 
    // break; // eventually
    }
} catch( Exception e ) {

} 
```

前者是否在每次迭代时运行 try-catch 或编译器是否生成相同的代码。哪个是首选？

编辑：休息；在第二个示例中从 catch 块中删除，因为不需要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T23:08:22.030

不同之处在于，第一个将按预期编译和工作（发生异常时跳出循环），第二个不会编译。

编译器错误`break cannot be used outside of a loop or a switch`几乎是自我解释的（您试图在`break`循环之外使用（语法上），这是不允许的）。

我将修改您的示例以说明这一点：

```
try {
    while( true ) {
    // something 
    // break; // eventually
    }
    /* --> more code, that could throw an exception <-- */
} catch( Exception e ) {
    break; 
} 
```

如果在我插入评论的地方发生异常，应该打破什么？

要明确回答您的问题：

> 前者是在每次迭代时运行 try-catch 还是编译器生成相同的代码？

是的，前者在每次迭代时运行一个 try/catch 块。

> 哪个是首选？

~~第一个，很明显。~~

首选方式是第二种方式，只是`break`在 catch 块中没有关键字。正如 Ren 在他的评论中指出的那样，当发生异常时，您将执行 catch 块（记录错误或类似的东西），然后执行 catch 块下面的代码。不需要`break`关键字。

# android - Android：AsyncTask 中的进度对话框未显示

> ID：15101171
> 
> 赞同：2
> 
> 时间：2013-02-26T23:02:57.573
> 
> 标签：android, android-asynctask

我正在启动`asynctask`在 a 内部`SherlockListFragment`创建的内部 a`SherlockFragmentActivity`作为选项卡。

我将我的活动上下文传递给`asynctask`构造函数，并像这样在里面初始化异步任务`onCreate()`：

```
AsyncTask<String, Integer, String[]> asynctask = new DownloadFilesTask(getSherlockActivity()).execute(url); 
```

AsyncTask 类 DownloadFilesTask 中的构造函数如下所示：

```
private ProgressDialog dialog;
private SherlockFragmentActivity activity;

public DownloadFilesTask(SherlockFragmentActivity activity) {
        this.activity = activity;
        this.dialog = new ProgressDialog(activity);
    } 
```

执行前和执行后如下所示：

```
protected void onPreExecute(){  
        Log.d("AsyncTask!", "Showing dialog now!"); //shown in logcat
        dialog.setMessage("Retrieving all currently airing anime. Please wait.");
        dialog.setCancelable(false);
        dialog.show();  
    } 
```

.

```
protected void onPostExecute(String[] result) { 
    Log.d("AsyncTask!", "Dismissing dialog now!"); //shown in logcat
    dialog.dismiss();
} 
```

但是在完成所有后台工作时，进度对话框不会出现！我在这里做错了什么？我认为这可能是一个上下文问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T19:30:50.313

Part of the problem was fixed thanks to the comment from Mike Repass about passing a plain old context.

As for the dialog not showing up...I was just being stupid because I called a `.get()` after the execute OUTSIDE the AsyncTask which blocks the UI thread. Obviously the dialog is not going to show up that way.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-26T23:10:46.963

在 Java 中“如果你的方法覆盖了它的超类的方法之一，你可以通过使用关键字**super**来调用被覆盖的方法。” 因此，在您启动进度对话框时将您的 onPreExecute() 方法更改为：

```
@Override
protected void onPreExecute(){  
    super.onPreExecute();
    dialog = new ProgressDialog(activity);
    Log.d("AsyncTask!", "Showing dialog now!"); //shown in logcat
    dialog.setMessage("Retreiving all currently airing anime. Please wait.");
    dialog.setCancelable(false);
    dialog.show();  
} 
```

# facebook - 图形 API 调用返回“无效令牌：\”https:\“。已指定 ID。”,

> ID：15101173
> 
> 赞同：0
> 
> 时间：2013-02-26T23:03:00.660
> 
> 标签：facebook, facebook-graph-api

我正在使用[Graph API Explorer](https://developers.facebook.com/tools/explorer)运行此命令，以向我指定的三个朋友发送请求：

```
 https://graph.facebook.com//apprequests?ids=1000020,10000498163,63027&message='This is the message use this app man&data='This is some data or whateverz'&AAACEdEose0cBABlELWtsbtarJjOK2VqfZAuvlizieN1BtsB3izXhuHfwZDZD&method=post 
```

我收到此错误：

```
 "error": {
    "message": "Invalid token: \" https:\".  An ID has already been specified.", 
    "type": "OAuthException", 
    "code": 2500
  } 
```

任何帮助都会非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:55:02.660

您是否在“facebook.com”和“apprequests”之间包含用户 ID（或“我”）？

如果是这样，则路径的第一部分是您正在操作的对象 ID，因此额外的 'ids' 参数无效。如果不是，请省略其中一个正斜杠。

从错误文本中也可以看出，您正在执行类似的 `$facebook->api('https://www.facebook....')`操作（使用 PHP 示例）或以某种方式向 API 发出请求，其中包含两次 API 方法的路径

（见[https://developers.facebook.com/docs/reference/api/user/#apprequests](https://developers.facebook.com/docs/reference/api/user/#apprequests)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T06:15:35.653

你错了，这不是你发送应用请求的方式。相反，您实际上是在访问用户的应用请求（他的朋友提出的请求）。要发送应用请求，您必须使用此 URL：`http://www.facebook.com/dialog/apprequests?`

因此，在您的情况下，如果您想向某些特定的用户 ID 发送请求，那么它将是：

`http://www.facebook.com/dialog/apprequests?app_id=YOURAPPID&message=Your%20message!&to=100005354380146,100005240530237&redirect_uri=http://localhost/MyExample.aspx`

如果您忽略该`to`参数，则会显示一个完整的对话框，其中列出了他的所有朋友，用户可以从中选择目标朋友。

# youtube-api - 在 YouTube API 上传期间启用获利

> ID：15101174
> 
> 赞同：2
> 
> 时间：2013-02-26T23:03:02.233
> 
> 标签：youtube-api, ads

我正在尝试在 YouTube API 上传期间启用获利功能。我已将默认首选项设置为始终设置通过 Youtube.com 网站上传时所做的货币化标志，但在通过 API 上传时会被忽略。

我们预计我们的用户社区会在短时间内上传数千个视频，通过 Youtube.com 网站手动切换每个视频是不切实际的。

如果默认的 YouTube API 不支持此功能，是否有业务开发人员可以与我们交谈，以了解是否有不同的合作伙伴级别可以让我们访问此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T14:18:14.623

您的 API 上传应该是一样的。请提供您的信息与我联系，以便我验证。

# java - 如何让服务器感知它正在服务的域名？

> ID：15101175
> 
> 赞同：1
> 
> 时间：2013-02-26T23:03:08.183
> 
> 标签：java, servlets, dns

我有一个 Java Servlet 容器。此servlet容器可以提供`localhost:8080`、`192.168.1.2:8080`或. 如何让 Servlet 容器和/或任何正在运行的 servlet*感知*它所服务的域名？`www.development.example``www.production.example.com`

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:15:15.713

servlet 应该能够看到整个请求 URL：

方法一：获取请求URL，自己解析。

```
String url = request.getRequestURL().toString(); 
```

方法二：

```
String server = request.getServerName() 
```

看到[这个](https://stackoverflow.com/questions/4040094/getting-request-url-in-a-servlet)答案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:14:37.660

对于 Servlet，使用[请求](http://java.sun.com/javaee/6/docs/api/javax/servlet/ServletRequest.html#getServerName%28%29)对象`getServerName()`上的方法。

就 servlet 容器而言，如果将 apache 放在容器前面，则可以使用 VHosts 做一些诡计。您将不得不查看特定 servlet 容器的文档，以便查看他们的 HTTP 服务器是否支持该级别的 VHosts 之类的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:18:07.737

```
String host = request.getHeader("Host"); 
```*

# android-actionbar - Android Spinner 操作栏删除下划线

> ID：15101177
> 
> 赞同：1
> 
> 时间：2013-02-26T23:03:10.227
> 
> 标签：android-actionbar, android-spinner

[http://i.stack.imgur.com/OGxbu.png](http://i.stack.imgur.com/OGxbu.png) 上面是我的操作栏的图像。

第一个问题。如何删除文本“热门精选”下方的下划线但保留右下角三角形？

第二。如何使 topLeft 图标没有填充？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T09:41:43.253

我曾经遇到过同样的问题；但我现在解决了；你可以在这里看到它：[https ://stackoverflow.com/a/17854265/2618051](https://stackoverflow.com/a/17854265/2618051)

# redirect - Ektron 8.6.1 中的重定向

> ID：15101180
> 
> 赞同：2
> 
> 时间：2013-02-26T23:03:20.447
> 
> 标签：redirect, ektron

有人玩过 Ektron 8.6 中的新重定向功能吗？

我们在升级之前对其进行了测试（在 8.6.0 中）并且对它感到满意。但是到了升级的时候，Ektron 已经发布了 8.6.1，所以我们直接升级到那个。现在我们遇到了重定向功能的问题。（是的，我们应该在升级之前在 8.6.1 中再次测试所有内容）

现在，如果我们尝试为 CMS 中的现有页面添加重定向规则，它将不起作用。但是，如果我们为不存在的页面创建重定向规则，然后尝试访问该地址，则重定向工作正常。我们需要重定向来处理 CMS 中的现有页面。

澄清“工作”和“不工作”的含义......

如果我在 CMS 中有一个手动别名为“/erc/lucien.apsx”的现有页面，我可以像这样在重定向表中创建一个条目...... ![在此处输入图像描述](../Images/ed6d88e77b0dba327b0a08aaee955667.png)

添加此条目不会产生任何错误，但是当我访问该页面时，我看到的只是我创建的常规旧页面。*不是*它应该重定向到的 Google 网站。我*没有*收到任何 404 错误。

*但是，如果我为一个尚不*存在 的页面创建一个重定向条目，就像这样......![在此处输入图像描述](../Images/38e0ad57e6100d0440196783cddf6694.png)

它完美地工作。如果我尝试访问 /erc/fake.apsx 地址，我最终会访问 Google 网站，正如预期的那样。

（仅供参考，我们在 CMS 中为外部内容创建了一个“假”页面，因此我们可以将元数据附加到它并使其在分类法中可搜索，但随后提供指向“真实”页面的链接。我想在这里使用重定向，以便用户不必做这个额外的点击）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T21:38:52.400

对此（Ektron 的）“开箱即用”的回答是将重定向放置在 Web 服务器上，而不是放置在 Ektron CMS 的别名部分。

我工作的服务器使用 IIS，我为几个页面设置了这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T16:46:51.447

我怀疑它可能与缓存相关——原始 URL 被缓存为别名，然后对该 URL 的后续请求被重定向到快速链接，而无需查找数据库。添加重定向时，它可能不会从缓存中清除旧项目。添加 URL 重定向后，我会尝试重置 IIS，看看是否可以解决问题。

# operating-system - 以 EFI 模式启动是否意味着我将无法访问 BIOS 中断？

> ID：15101183
> 
> 赞同：6
> 
> 时间：2013-02-26T23:03:37.393
> 
> 标签：operating-system, boot, bios, osdev, efi

我正在尝试开发一个简单的操作系统。我以前做过一些汇编程序，不得不用`INT 10h`它来在屏幕上显示字符。我了解 UEFI 支持旧版 BIOS，并且可能仍然可以使用`INT 10h`服务。但是，如果我选择构建纯 UEFI 可启动操作系统，我应该避免使用`INT 10h`? 还是我看事情的方式不对？

换句话说，深入`printf`到`stdout`（屏幕）最终会调用 BIOS`INT 10h`吗？还是问题 - “`SYS_WRITE`函数调用是否基于 INT 10h？” 更合适？

我还需要创建一个 512 字节的引导扇区并将它们作为磁盘（或磁盘映像）上的第 0 个扇区吗？位置`0x7c00`还有意义吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-27T19:48:29.607

如果您的引导加载程序是 UEFI 引导加载程序（您将知道是否是），那么您**可能根本不**使用 BIOS，包括 int 0x10 - 您必须使用 UEFI 引导服务，它提供 BIOS 否则会提供给传统引导系统的所有功能。

如果您*没有*编写 UEFI 引导加载程序，但您的硬件启用了 UEFI，您的引导加载程序将以“传统”模式加载，您将能够像以前一样使用 BIOS。

或者换句话说，您的引导映像可以是 UEFI 引导加载程序，也可以是旧版 BIOS 映像。旧版 BIOS 映像不能使用 UEFI，UEFI 引导加载程序也不能使用 BIOS。

> 换句话说，深入到标准输出（屏幕）的 printf 是否最终会调用 BIOS INT 10h？还是问题 - “SYS_WRITE 函数调用是否基于 INT 10h？” 更合适？

取决于谁编写了你的​​ printf 函数（你是操作系统，你下面没有人）。如果您调用 Int 0x10 并且没有设置 IDT 来处理它作为对 UEFI 的调用以将字符写入屏幕，那么您只是在使用未定义的行为。

> 我还需要创建一个 512 字节的引导扇区并将它们作为磁盘（或磁盘映像）上的第 0 个扇区吗？位置 0x7c00 是否还有意义？

不，也不。UEFI 支持更大的引导加载程序，并且不会在 0x7C00 加载。如果你想知道哪些内存区域有特殊意义，你必须让 UEFI 给你一个内存映射。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T09:55:21.457

PC BIOS 不是 UEFI 编程模型的一部分，因此您不应在 UEFI 应用程序中使用它。例如，要打印到屏幕上，您将使用 UEFI 库中的函数。

从磁盘读取第一个扇区并将其加载到 0x7C00 是 BIOS 特定的引导协议。UEFI 引导加载程序是从文件系统加载的。[您可以在OSDev Wiki](http://wiki.osdev.org/EFI)上阅读有关它的更多信息。

# c++ - C ++中strcmp的自定义实现不起作用

> ID：15101187
> 
> 赞同：0
> 
> 时间：2013-02-26T23:03:51.780
> 
> 标签：c++, for-loop

我在挠头……为什么 strcmp_iter 中的 return 语句从未被调用？

当我运行这个函数时，输出只是从 0 计数到 6 然后终止......没有返回语句。非常令人沮丧。有趣的是，如果我将 myString2 更改为“abcdefG”，那么一切正常……非常奇怪。

```
int strcmp_iter(string s1, string s2) {
  int i = 0;
  for (; ((s1.at(i) == s2.at(i)) && (i <= s1.length())); i++) {
    cout << i << endl;
  }
  return s1.at(i) - s2.at(i);
}

int main() {
  string myString1 = "abcdefg";
  string myString2 = "abcdefg";

  int count_iter = strcmp_iter(myString1, myString2);
  cout << "Iter: " << count_iter << endl;

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:07:25.490

您正在循环超出字符串的范围并可能引发`std::out_of_range`异常。将您的条件更改为

```
i < s1.length() 
```

并在任何呼叫*之前*进行检查`std::string::at(size_type pos)`

另外，请注意，您的功能只有`s2`在至少与`s1`. 您可能应该循环最多比`std::min(s1.length(), s2.length())`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:11:40.893

每当我看到这种结构时，都会让我畏缩：

```
 for (; ((s1.at(i) == s2.at(i)) && (i <= s1.length())); i++) 
```

类 C 语言总是从左到右进行短路评估。所以终止条件——并验证比较有意义——应该在比较之前：

```
 int n = s1.length();
 if (s2.length() < n)
       n = s2.length();   // choose smaller length
 for (; i < n  &&  s1.at(i) == s2.at(i); i++) 
```

（我还删除了不必要的括号，将搜索长度限制为短字符串，并根据数组下标的工作方式更改`<=`为`<`。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:09:58.250

```
for (; ((s1.at(i) == s2.at(i)) && (i <= s1.length())); i++) { 
```

采用`i < s1.length()`

# dita - 如何使用 DITA subjectSchemes？

> ID：15101188
> 
> 赞同：2
> 
> 时间：2013-02-26T23:03:54.103
> 
> 标签：dita

DITA 中的 subjectScheme 是一种适合创建元数据分类的格式，但它应该如何真正使用呢？具体来说，我的问题涉及以下方面：

1.  它可以用于表示元数据元素，还是仅用于表示元数据属性？我只看到它应用于属性，这使得它有点受限，因为据我所知，元素通常用于检索元数据，即不用于过滤的元数据。
2.  如果您可以将它用于元素，该值是否仍应位于 subjectdef 的“keys”属性中？
3.  如果你想为元数据值添加定义/描述，你会在哪里做呢？
4.  您可以/应该发布主题方案吗？我已经看到它暗示它不适合发布，因为它的资源默认属性。但这不是限制吗？如果您使用它来创建分类法，您肯定还想要一种简单的方法来发布它以造福于用户吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T18:21:59.017

我将尽力解决您最初的问题。总体而言，subjectScheme 专业化旨在创建主题分类和受控值。它具有定义可用于检索的主题分类以及定义和控制属性值的强大功能。目前，DITA-OT 仅提供属性控制值领域的功能。

**问题：“它可以用于表示元数据元素还是仅表示元数据属性”？**

**答：**我不会说它的目的是“表示元素或属性”。它旨在代表*主题和受控价值*。它的设计基于键，因此大量使用属性。

**问题：如果您想为属性值添加定义，您在哪里做？**

**答：**您有多种选择：

*   您可以创建描述主题或属性值的关联主题。您可以使用 subjectdef 元素上的 @href 属性来引用本主题。这对于提供一致定义或有关何时应使用条件处理值的信息特别有用。
*   您可以在 subjectdef 元素中嵌套一个 topicmeta 元素；在 topicmeta 元素中，您可以访问 shortdesc 和 navtitle 元素。
*   您将内容添加到 subjectdef 元素的 @navtitle 属性。我不建议这样做，因为 @navtitle 属性已被弃用并且通常无法翻译。

**问题：您可以将 subjectScheme 特化与元数据元素一起使用吗？**

**回答：**是的。在我的脑海中，这是一种基于 HTML 的输出格式的直接可能性和设计：

*   对于特定主题，将 topicmeta 元素添加到 subjectdef 元素。在 topicmeta 元素中，您可以完全访问所有元数据元素。添加尽可能多的元数据元素。
*   将 DITA 主题与相关主题相关联。这可以通过使用特定的属性和值来完成，也可以通过使用分类域中的 subjectref 元素来完成。
*   调整输出处理，以便与该主题关联的每个 DITA 主题都将元数据写入 HTML，就像元数据元素位于 DITA 主题本身一样。通过这种设计，您已经强制执行一致性，并且由于基于密钥的架构、易于维护和抽象层。

**问题：你们可以发布主题方案吗？**

**回答：**是的，如果使用 @href 属性为 subjectdef 元素引用主题。虽然默认情况下，subjectScheme 元素的@processing-role 属性设置为“resource-only”，@toc 属性设置为“no”，您可以修改这些值，它们将在整个地图中级联，使其成为可能生成输出。当然，这只是目前使用 DITA-OT 可以做到的；使用自定义处理实现，可能性是无限的。

我认为 subjectScheme 映射和分类域提供了许多令人兴奋的可能性，包括分面和过滤浏览（用于输出）和分面搜索（用于 DITA 源）。

我希望构建使用 subjectScheme 和分类的实现的人们将分享故事，演示他们的实现等等。我认为这将使 DITA 架构的这一部分可以做的事情更清晰，更易于人们使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T13:41:18.340

就 DITA-OT 而言，我认为您只能将其用于使用 DITAVAL 文件对元素进行条件处理（过滤和标记）。

我认为主题方案地图的潜力远不止于此。它们可以用于分面浏览，因此我们可以省去静态主题图。静态内容似乎只是属于前网络时代。DITA略显沉稳的气场就可以这样解决。

无论如何，这是您目前*可以*执行的操作：

主题方案图：

> ```
> <?xml version="1.0" encoding="UTF-8"?>
> <!DOCTYPE subjectScheme PUBLIC "-//OASIS//DTD DITA Subject Scheme Map//EN" "map.dtd"> 
> <subjectScheme>
>     <hasInstance>
>         <subjectdef keys="all_routes">
>             <subjectdef keys="every_route">
>                 <subjectdef keys="anglia"/>
>                 <subjectdef keys="east_midlands"/>
>                 <subjectdef keys="kent"/>
>                 <subjectdef keys="lne_london_north_eastern"/>
>                 <subjectdef keys="lnw_london_north_western"/>
>                 <subjectdef keys="scotland"/>
>                 <subjectdef keys="wales"/>
>                 <subjectdef keys="sussex"/>
>                 <subjectdef keys="wessex"/>
>                <subjectdef keys="western"/>
>             </subjectdef>
>         </subjectdef>
>     </hasInstance>
> 
>     <enumerationdef>
>         <attributedef name="route"/>
>         <!-- Above is my new specialized attribute "routes"! -->
>      <subjectdef keyref="all_routes"/>
>     </enumerationdef> 
> ```

这是带有元数据的主题文本：

> ```
> <?xml version="1.0" encoding="UTF-8"?>
> <!DOCTYPE task PUBLIC "-//OASIS//DTD DITA General Task//EN" "task.dtd">
> <task id="task_ozd_ckn_qh">
>   <title>Route specialization test</title>
>   <shortdesc route="">This tests the new route attribute!</shortdesc>
>   <taskbody>
>      <section>
>          <title>Lines of text</title>
>          <p route="anglia">Anglia text text text text text text.</p>
>          <p route="sussex">Sussex text text text text text text.</p>
>          <p route="east_midlands">East Midlands text text text text text.</p>
>          <p route="kent">Kent text text text text text text.</p>
>          <p route="lne_london_north_eastern"NE text text text text text text.</p>
>          <p route="lnw_london_north_western">LNW text text text text text text.</p>
>          <p route="scotland">Scotland text text text text text text.</p>
>          <p route="sussex"Sussex text text text text text text.</p>
>          <p route="wales">Wales text text text text text text.</p>
>          <p route="western">Western text text text text text text.</p>
>          <p route="wessex">Wessex text text text text text text.</p>
>          <p route="every_route">Text.</p>
>          <p>Not profiled.</p>
>      </section>
>   </taskbody> 
> ```

这是 DITAVAL 过滤器：

> ```
>  <prop action="exclude" att="route"/>
>   <prop action="include" att="route" val="scotland"/> 
> ```

这将淘汰除标有“苏格兰”的路线之外的所有其他路线。

基本上就是这样。

您可以像这样将元数据添加到主题方案映射中：

> ```
>  <subjectdef keys="story_attributedef">
> 
>        <subjectdef keys="monster">
>            <hasKind>
>                <subjectdef keys="zarbi" href="glossary/contemporary.dita">
>                    <topicmeta>
>                        <navtitle>The Zarbi</navtitle>
>                        <shortdesc>Ant-like creature</shortdesc>
>                    </topicmeta>
>                </subjectdef> 
> ```

主题方案映射被渲染为“仅资源”（无论它们是否具有该值），因此它不适合渲染。

# javascript - AJAX 结果不坚持 DOM

> ID：15101189
> 
> 赞同：0
> 
> 时间：2013-02-26T23:04:02.583
> 
> 标签：javascript, ajax, dom

我有一个成功的 AJAX 请求和结果。结果是我想放在 DOM 中的表格行中的简单文本。下面是代码：

```
xhr.onreadystatechange = function(event) {
    if (xhr.readyState === 4 && xhr.status === 200) {
      var results = xhr.responseText;
      var col = document.getElementById("tr_concept_0_1_32").getElementsByClassName("col_1")[0];
      col.innerHTML = results;
    }
    else {
      console.log(event);
      alert("something went wrong!: " + event);
    }
  }; 
```

当我`return col.innerHTML = results;`可以看到 DOM 被修改时，它会很快恢复到以前的值。

我是 AJAX 的新手，所以我不太确定为什么“新价值”没有坚持 DOM。有什么建议么？

**更多代码：**
**更新按钮**

```
form.form-search(id='searchForm')
      fieldset
        .input-append
          input.input-xxlarge.search-query#search(type='text', placeholder='Search', name='q')
          button.btn.submit(onclick='getParams(); return false;') Search 
```

上面是做这项工作的代码。用户单击表单的`button`. 这可能是问题吗？我没有从这方面处理正确的事情吗？

**更新按钮** 上面的代码在 Chrome 中运行良好，但在 Firefox 中不运行。
在 Firefox 中，帖子返回`success`但`onreadystatechange`不会触发。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:59:11.903

我认为该按钮正在发送 AJAX，**并**提交表单......因此“重新加载”页面 - 所以您会看到“重置”值。

如果您的按钮只会提交 AJAX，请将其`type`属性更改为“按钮”，或者`onclick='getParams();return false;'`用于其`onclick`处理程序。

还有其他方法可以做到这一点，但在我的建议中，使用`return false;`会阻止提交按钮的默认行为 - 提交。但由于它是 after `getParams();`，`getParams`仍然被调用并做你需要的 - AJAX。

如果将`type`属性更改为“按钮”，它甚至不会有提交的行为，因此不会出现此问题。

# java - 实例化每个范围/组的单例 - 陷入 Guice 依赖地狱

> ID：15101191
> 
> 赞同：6
> 
> 时间：2013-02-26T23:04:06.177
> 
> 标签：java, dependency-injection, guice, multiple-inheritance

**[这个问题是对带有注入类的框架使用 guice](https://stackoverflow.com/questions/13708918/using-guice-for-a-framework-with-injected-classes-proper-way-to-initialize)**的延续，初始化的正确方法是什么？，我已经尝试实施，并且还尝试了其他方法来解决这个问题，但到目前为止没有任何效果。

主要问题是这个。我有一个`InterfaceA`and`InterfaceB`暴露在 API 的不同部分。有两个类实现了这两个接口`TestClass`和`RealClass`，因此根据我是在测试还是在做其他事情，我可以执行以下操作：

```
bind(InterfaceA.class).to(TestClass.class);
bind(InterfaceB.class).to(TestClass.class); 
```

或者，对于生产：

```
bind(InterfaceA.class).to(RealClass.class);
bind(InterfaceB.class).to(RealClass.class); 
```

我对使用这些类有两个要求：

1.  我需要相同的`TestClass`or实例`RealClass`绑定到`InterfaceA`and的所有注入`InterfaceB`；所以，就像一个单例模式，除了：
2.  单例仅适用于特定范围或子注入器，其中许多是在程序执行期间创建的。

默认的无范围方法会导致为每个接口注入创建多个`RealClass`/实例。`TestClass`我不希望这样，所以我尝试使用范围、子注入器和其他方法来实现它。没有任何效果：

*   [子注入器方法](https://stackoverflow.com/questions/9942782/custom-guice-scope-or-a-better-approach)：我创建一个新注入器并尝试将`TestClass`or绑定`RealClass`到该注入器中的单例实例。问题是，是否`TestClass`在`RealClass`父注入器中配置了正在使用的，并且[由于它是单例的，因此它已经实例化了](https://stackoverflow.com/questions/8053515/guice-eager-lazy-singleton-instantiations)（除非在 中`Stage.DEVELOPMENT`）。例如，无法在父注入器中绑定`InterfaceA`到`TestClass`, 然后在子注入器中将其重新绑定为单例。
*   范围方法：[我创建一个自定义范围](https://stackoverflow.com/questions/13708918/using-guice-for-a-framework-with-injected-classes-proper-way-to-initialize)并注释`TestClass`和`RealClass`. 然后，我进入和退出此范围以获取该范围内的单个实例。问题是我的代码是多线程的，并且从一个线程更改范围会影响全局注入器可以看到的内容并破坏创建其他实例。
*   结合子注入器和范围方法。我尝试为每次使用此自定义范围创建一个子注入器，但随后`RealClass`在父级中绑定失败

    ```
    No scope is bound to name.package.WhateverScope. 
    ```

    因为它似乎坚持始终`WhateverScope`可用，而不仅仅是在儿童注射器中。

所有这些问题似乎是由于我需要能够配置是否使用`TestClass`或`RealClass`在父级中，但随后能够以单例的形式为特定的一组对象实例化它们。我正在为如何完成这项工作而烦恼！

顺便说一句，Guice 范围的文档很糟糕，几乎无法理解。[这篇文章](http://andrewtill.blogspot.com/2011/09/guice-custom-scopes.html)是唯一让我有所收获的文章：

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:55:09.720

为发布后不到一个小时的突破表示歉意。

我似乎已经能够通过稍微滥用[http://code.google.com/p/google-guice/wiki/CustomScopes](http://code.google.com/p/google-guice/wiki/CustomScopes)提供的线程本地范围实现来解决这个问题。在不使用儿童注射器的情况下，这似乎是一种解决此问题的干净方法。不过，我不确定它是否“正确”。我仍然会接受其他答案。

这就是我所做的。首先，我创建一个作用域实例，将其绑定到适当的注解，并使其在注入器中可用：

```
ThreadLocalScope scope = new ThreadLocalScope();
bindScope(ExperimentScoped.class, scope);
bind(ThreadLocalScope.class).toInstance(scope); 
```

然后，正如文档所说，我需要为将在范围内播种的每种类型的密钥绑定一个虚假提供程序：

```
bind(SomeKey.class)
  .toProvider(ThreadLocalScope.<SomeKey>seededKeyProvider())
  .in(ExperimentScoped.class);
bind(SomeOtherKey.class)
  .toProvider(ThreadLocalScope.<SomeOtherKey>seededKeyProvider())
  .in(ExperimentScoped.class); 
```

我可能还有一些其他可作用域的对象，我希望它们在每个作用域内都是不同的，所以我也绑定了它们。这些是`TestClass`和`RealClass`以上。也可能有`SomeScopedClass`注释`@ExperimentScoped`：

```
bind(InterfaceA.class).to(TestClass.class).in(ExperimentScoped.class);
bind(InterfaceB.class).to(TestClass.class).in(ExperimentScoped.class);

bind(SomeInterface.class).to(SomeScopedClass.class); 
```

最后，我可以使用范围从不同的线程并行创建不同的相互依赖对象集。每个线程都可以执行以下操作，即使它们使用相同的注入器：

```
ThreadLocalScope scope = injector.getInstance(ThreadLocalScope.class);      
scope.enter();

try {
    // Seed the seed-able keys
    scope.seed(SomeKey.class, keyInstance);
    scope.seed(SomeOtherKey.class, otherKeyInstance);    

    SomeScopedClass instance = injector.getInstance(SomeScopedClass.class);

    // Hooray! instance was injected with the seeds and created just for this scope!
}
finally {
    scope.exit(); // Throws away the scope and referenced objects.
} 
```

在我的情况下，我可以完全放弃范围，因为一旦正确连接它们，我不关心跟踪范围中的对象集。但如果我想稍后回到这个范围并注入更多对象，它可能不会起作用。

希望这对某人有所帮助。Guice 范围界定文档很糟糕！

# c - 使用 C 将文本文件加载到结构中

> ID：15101194
> 
> 赞同：1
> 
> 时间：2013-02-26T23:04:21.610
> 
> 标签：c, printing, struct, io, load

我尝试将文本文件的内容加载到结构中。

我的想法是这样的：

我有两个文件`struct.h`，`main.c`和一个`list.txt`文件。

在文件中`struct.h`：

```
struct analg {
    char word[6];
    char signature[6];
};
struct analg h[106];
FILE *fp; 
```

在文件中`main.c`：

```
#include<stdio.h>
#include "struct.h"

void load() {
    fp = fopen("list.txt", "r");
    if(fp == NULL) {
        printf("fail");
        return 1;
    }
    else {
        printf("file loaded!\n");
    }
    fclose(fp);
    return;
}

void print() {

    int i;
    for(i=0; i<1000; i++) {
        while(fgets(h[i].word, 6, fp)) {
            printf("%s", h[i].word);
        }
    }
    return;
 }

int main () {

int choice;

do {
    printf("choose L or P: ");
    scanf("%s", &choice);
    switch(choice) {
        case 'l': 
            load();
            printf("\n[l]oad - [p]rint\n");
            break;
        case 'p': 
            print();
            printf("\n[l]oad - [p]rint\n");
            break;
        default:        
            break;
       }
    }  while(choice!='q');

    return;
} 
```

在文件中`list.txt`：

```
throw

timer

tones

tower

trace

trade

tread 
```

所以我尝试通过按“L”来加载文本文件到结构，然后当我按“p”时会显示，但事实并非如此！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:09:06.613

我会评论你的代码在做什么：

```
void load() {
fp = fopen("list.txt", "r"); // opens the file for reading
if(fp == NULL) {
    printf("fail");          // if the file couldn't be opened, return an error
    return 1;                // (aside: a void function can't return an int)
}
else {

   printf("file loaded!\n"); // tell the user that the file was opened
}

fclose(fp);                  // close the file, having read nothing from it

return;
} 
```

您绝不会从文件中读取任何内容。因此，内存中的内容与磁盘上的内容无关。

C 没有用于序列化和反序列化结构的内置方法，因此您需要为磁盘上的文件定义正式语法并编写可以将该语法解析为结构的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:09:53.303

在您的代码中，我看到有 2 个潜在问题。选择必须是基于`l`或切换的字符`p`。您可能还必须添加大小写来处理大写。

另一个问题是在`load`函数中，您正在关闭文件指针。因此，当您输入该`print`功能时，`fgets`可能无法正常工作，因为该`fp`功能已关闭。

要将文件加载到结构中，必须将加载修改为

```
void load() {
fp = fopen("list.txt", "r");
if(fp == NULL) {
    printf("fail");
    return; // There was an error in original code as this was returning 1
}

do{
    fgets(h[count++].word, 6, fp); // Count is a global variable - no. of elements read
}while(!feof(fp));
printf("file loaded!\n");
fclose(fp);

return;
} 
```

相应的打印函数将变为

```
void print(){

  int i;
  printf("Inside print\n");

  for(i=0; i < count; i++) {
      printf("%s", h[i].word);
  }
 return;
 } 
```

主要功能是，

诠释主要（）{

```
char choice;

do{
    printf("choose L or P: ");
    scanf("%c", &choice); //Only character is read and hence, %s is not required
    switch(choice){
    case 'l': 
        load();
        printf("\n[l]oad - [p]rint\n");
        break;
    case 'p': 
        print();
        printf("\n[l]oad - [p]rint\n");
        break;
    default:
    case 'q':
        break;
    }
} while(choice !='q');

return 0;
} 
```

最后一点。在使用`scanf`if 语句`scanf("%s", &choice);`时，退出时会生成运行时检查错误`main`，并显示变量周围的堆栈已损坏的消息`choice`。

# c# - 数据库集 .Local vs DbContext.ChangeTracker

> ID：15101196
> 
> 赞同：5
> 
> 时间：2013-02-26T23:04:36.553
> 
> 标签：c#, entity-framework, repository, dbcontext

在[另](https://stackoverflow.com/questions/15094903/is-dbset-local-something-to-use-with-special-care)一篇文章中，我要求澄清何时使用`DbSet<TEntity>.Local`. 我还没有得到答案，我认为这个问题可能包含太多信息。在深入挖掘之后，我可以问一个更具体的问题。

希望你们能解释在我的场景中选择两个选项中的哪一个。

## 我想达到什么目标？

1.  我正在尝试从我的`Repository`. 实体仍处于“添加”状态（即我还没有调用该`SaveChanges`方法）。我需要这个，因为我想将实体存储在一个原子操作中，所以我必须将`SaveChanges`调用推迟到验证完整模型*之后。*

2.  此外，我需要遵守 IQueryable 接口，因为我有依赖代码使用扩展方法`Include`来`Queryable`延迟加载导航属性。

## 我尝试了什么？

过去几天发生了很多事情，但归结为以下两种不同的方法：

*   `DbSet<TEntity>.Local`通过属性检索处于“添加”状态的实体
*   通过`DbContext.ChangeTracker`

## 可视化不同方法的代码示例

```
 public void AddAndRetrieveUncommittedEntityFromDbContext()
    {
        Database.SetInitializer(new DropCreateDatabaseAlways<TestContext>());
        var testContext = new TestContext();

        // Initialize the entities and store them in the repository
        var tenant = new Tenant { Name = "test", Guid = Guid.NewGuid().ToString() };
        var user = new User { Name = "bas", EmailAddress = "bas@domain.com", Password = "password" };
        tenant.Users.Add(user);
        testContext.Tenants.Add(tenant);

        // NOTE: I did not call `SaveChanges` yet, but still I want to retrieve 
        // the tenant from my repository

        ///////////////////////////////////////////////
        // Alternative one, use the ChangeTracker... //
        ///////////////////////////////////////////////
        IEnumerable<DbEntityEntry<Tenant>> tenants = testContext.ChangeTracker.Entries<Tenant>();
        IQueryable<Tenant> query = tenants.Select(dbEntityEntry => dbEntityEntry.Entity).AsQueryable();
        Tenant storedTenant = query.
            Where(ent => ent.Name.Equals("test")).
            Include(ent => ent.Users).First();

        Assert.IsNotNull(storedTenant.Users.FirstOrDefault()); 
        // hurray, it passes

        ///////////////////////////////////////////////
        // Alternative two, use the 'Local' property //
        ///////////////////////////////////////////////
        IQueryable<Tenant> query2 = testContext.Tenants.Local.AsQueryable();
        Tenant storedTenant2 = query2.
            Where(ent => ent.Name.Equals("test")).
            Include(ent => ent.Users).First();

        Assert.IsNotNull(storedTenant2.Users.FirstOrDefault()); 
        // hurray, it passes

        ////////////////////////////////////////////////
        // For completeness => entity is not in DbSet //
        ////////////////////////////////////////////////

        IQueryable<Tenant> query3 = testContext.Tenants.AsQueryable();
        Tenant storedTenant3 = query3.
            Where(ent => ent.Name.Equals("test")).
            Include(ent => ent.Users).FirstOrDefault();

        Assert.IsNotNull(storedTenant3); 
        // Fails, because the entity is not yet available in the DbSet 'testContext.Tenants'
    } 
```

testContext 非常简单：

```
public class TestContext : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<Tenant> Tenants { get; set; }

    public TestContext() : base("Test1") {}
} 
```

## 问题

*   检索所有实体（即包括处于“添加”状态的实体）的建议方法是什么？
*   `DbSet<TEntity>.Local`和的优缺点是`ChangeTracker`什么？

非常感谢提前！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T01:35:42.460

这真的取决于你想做什么。您的代码都没有专门过滤，`DbEntityEntry.State`因此我假设您确定上下文跟踪的所有实体都处于添加状态。

如果您不确定所有被跟踪的实体都处于添加状态，那么 `ChangeTracker`您有机会过滤`DbEntityEntry`s，`EntityState.Added`然后获取对要处理的实际实体的引用。

随着`Local`您获得`ObservableCollection<T>`实体本身。如果您确定它们都处于添加状态，那么这可能是最简单的。如果您不确定，那么您必须枚举集合并`DbEntityEntry`从上下文中获取以确保：

```
foreach(var entity in collection)
{
  if(context.entry(entity).State == EntityState.Added)
  {
  //do stuff...
  }
} 
```

如果这只是为了执行验证，那么还有其他方法可以解决，其中一些可以在[这里](http://msdn.microsoft.com/en-us/data/gg193959.aspx)阅读。

# dita - 如何调试 DITA 转换？

> ID：15101207
> 
> 赞同：0
> 
> 时间：2013-02-26T23:05:32.183
> 
> 标签：dita

我知道 XSLT 通常是可以调试的，但是考虑到它的模块化 XSLT 结构以及catalog.xml 文件指向样式表这一事实，究竟该如何调试 DITA 转换呢？

我希望能够在运行时单步执行代码，并能够设置断点等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T06:47:58.897

在代码中添加打印语句总是有一个很好的老技巧，即 xslt 转换为`<xsl:message>`. 这是我的frontmatter转换的片段：

```
<!-- 
<xsl:message>createFrontMatter_1.0</xsl:message>
<xsl:message>artworkPrefix=<xsl:copy-of select="$artworkPrefix"/></xsl:message>
<xsl:message>customizationDir.url=<xsl:value-of select="$customizationDir.url"/></xsl:message>
<xsl:message>imageLogoPath=<xsl:value-of select="$imageLogoPath"/></xsl:message>
<xsl:message>imageNotePath=<xsl:value-of select="$imageNotePath"/></xsl:message>
<xsl:message>imageWatermarkPath=<xsl:value-of select="$imageWatermarkPath"/></xsl:message>
<xsl:message>page-width=<xsl:value-of select="$page-width"/></xsl:message>
<xsl:message>page-height=<xsl:value-of select="$page-height"/></xsl:message>
--> 
```

如果我取消注释，我会在输出日志中得到一个很好的调试文本块，显示我使用的设置的各种值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T12:40:08.423

如果您使用的是 Oxygen 编辑器，则可以使用此处描述的技术（来自 Oxygen 14.2 文档）调试 Toolkit 转换：

调试 PDF 转换

1.  要使用 XSLT 调试器调试 DITA PDF 转换场景，请执行以下步骤：转到选项 > 首选项 > XML > XML 目录，单击添加并选择位于 [Oxygen 安装目录]\frameworks\dita\DITA-OT\plugins\ 的文件org.dita.pdf2\cfg\catalog.xml；

2.  在 DITA Maps Manager 中打开地图，创建 DITA Map PDF 转换场景；

3.  编辑场景，转到参数选项卡并将 clean.temp 参数的值更改为 no；

4.  运行转换场景；

5.  在 Oxygen XML 中打开位于临时目录中的 stage1.xml 文件并格式化并缩进它；

6.  通过关联位于 OXYGEN_INSTALL_DIR/frameworks/dita/DITA-OT/plugins/org.dita.pdf2/xsl/fo/topic2fo_shell_fop.xsl 的 topic2fo_shell.xsl 样式表，为此 XML 文件创建转换场景；

7.  在转换场景中，编辑参数列表并使用值 en_GB 和参数自定义目录设置参数 locale 以指向您的自定义目录或默认的 DITA OT 自定义目录。它的值应该具有如下 URL 语法：file://c:/path/to/OXYGEN_INSTALL_DIR/frameworks/dita/DITA-OT/plugins/org.dita.pdf2/cfg。

8.  调试转换场景。

我通过在 Oxygen 在线帮助中搜索“调试工具包”找到了这个主题。

这些说明专门针对 PDF，但您也应该能够使这些说明适应基于 HTML 的转换。

# dart - 你如何从javascript函数返回值

> ID：15101208
> 
> 赞同：0
> 
> 时间：2013-02-26T23:05:37.327
> 
> 标签：dart, dart-js-interop

我正在使用 Dart 中的 js 库来访问 OpenLayers。相关代码如下：

```
js.scoped(() {
  ol = js.retain(js.context.OpenLayers);
  var max_extent = new js.Proxy(ol.Bounds, -13652354.432172, 6026153.418145, -13574082.915218, 6065289.1766216);
  var restricted_extent = max_extent;

  if (controls == null){

    var options = js.map ({
      'maxExtent': max_extent,
      'restrictedExtent' : restricted_extent,
      'units' : 'm',
      'projection': new js.Proxy(ol.Projection, 'EPSG:900913'),
      'displayProjection' : new js.Proxy(ol.Projection, 'EPSG:4326'),
      'controls' : js.array([ new js.Proxy(ol.Control.Attribution),
                              new js.Proxy(ol.Control.Navigation),
                              new js.Proxy(ol.Control.ArgParser),
                              new js.Proxy(ol.Control.PanPanel),
                              new js.Proxy(ol.Control.ZoomPanel)
                             ])
    });
    _treemap = js.retain( new js.Proxy( ol.Map, map_div_id, options ) );
  }

  var roads = new MapLayer(ol, layer_type:'road').layer;
  var aerial = new MapLayer(ol, layer_type:'hybrid').layer;

  _treemap.addLayers(js.array([roads, aerial]));
  _treemap.setBaseLayer(roads);
  _treemap.zoomToMaxExtent();
  var result = _treemap.layers();
}); 
```

除最后一行外，所有工作都按预期工作。`_treemap.layers()`应该返回一个数组`OpenLayer.Layer`。当该行执行时，我得到一个错误：

> 例外：类型错误：对象 [对象数组] 没有方法“应用”

那么，在我的 Dart 代码中从 javascript 函数获取/处理返回值的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T07:29:55.677

`layers`是一个数组（参见[OpenLayers.Map.layers](http://dev.openlayers.org/releases/OpenLayers-2.12/doc/apidocs/files/OpenLayers/Map-js.html#OpenLayers.Map.layers)）。所以你应该使用：

```
var result = _treemap.layers; 
```

与`_treemap.layers()`您一起尝试调用`layers`，因为它是一个函数。

关于您的代码的一个旁注：当您使用时，`js.map({})`您不需要使用`js.array`或`js.map`在对象树中。您可以简单地给出一个类似*JSON*的结构。

```
var options = js.map ({
  'maxExtent': max_extent,
  'restrictedExtent' : restricted_extent,
  'units' : 'm',
  'projection': new js.Proxy(ol.Projection, 'EPSG:900913'),
  'displayProjection' : new js.Proxy(ol.Projection, 'EPSG:4326'),
  'controls' : [ new js.Proxy(ol.Control.Attribution),
                 new js.Proxy(ol.Control.Navigation),
                 new js.Proxy(ol.Control.ArgParser),
                 new js.Proxy(ol.Control.PanPanel),
                 new js.Proxy(ol.Control.ZoomPanel)
               ])
}); 
```

# php - jquery .load() 不工作挂载表

> ID：15101213
> 
> 赞同：1
> 
> 时间：2013-02-26T23:05:46.073
> 
> 标签：php, javascript, jquery, html, ajax

我在使用 .load () jquery 安装表时遇到问题。

我的表如下。

```
<table id="table_test">
     <thead>
        <tr>
          <th> COLUNA 1 </th>
        </tr>
     </thead>

    <tbody>

    </tbody>
</table> 
```

我的文件组合了以下输出。

```
<tr>
 <td>
  <span> Value 2</span>
 </td>
</tr> 
```

我正在使用以下功能。

```
<script type="text/javascript">
$(document).ready (function () {
         $('# table_test'). load ('modules/a/processa.php? opt = 2');
});
</ script> 
```

但是它无法挂载表中的行。

[http://jsfiddle.net/marcoscarraro/7NsNu/](http://jsfiddle.net/marcoscarraro/7NsNu/)

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:10:35.723

我认为您的问题在于**$**。

这应该工作`$('#table_test').load('modules/a/processa.php?opt=2');`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:21:08.233

您的问题中有很多拼写错误/语法错误。你可以在下面试试这个。我不确定您的数据返回什么，但我希望它确实可以正确返回文本。让我知道这个是否奏效。

HTML结构：

```
<table id="table_test">
  <thead>
    <tr>
      <th> COLUNA 1 </th>
    </tr>
   </thead>
   <tbody>
   </tbody>
</table> 
```

JS代码：

```
$(document).ready(function () {
    $('#table_test tbody').load("modules/a/processa.php?opt=2", 
                                function(response, status, xhr) {
     if (status == "error") {
         var msg = "Sorry but there was an error: ";
         alert(msg + xhr.status + " " + xhr.statusText);
     }
  });
}); 
```

JS 小提琴：http: [//jsfiddle.net/QztST/3/](http://jsfiddle.net/QztST/3/)

# knockout.js - 突出显示 pagerjs 和淘汰赛中的当前点击路径

> ID：15101221
> 
> 赞同：1
> 
> 时间：2013-02-26T23:06:21.970
> 
> 标签：knockout.js, navigation, single-page-application, pagerjs

如果您正在创建 pagerjs 应用程序，如何将您打开的路径设置为活动状态。例如

```
<div class="tabs">
    <a data-bind="page-href:'opt1'">opt1</a> | 
    <a data-bind="page-href:'opt2'">opt2</a>
    </div>

<div class="server" data-bind="page:{id:'opt1')}">
                </div> 
```

拥有一个 css:{selected:isVisible} 绑定很容易，但 isVisible 会是什么样子？它在文档中提到了这一点，但没有显示 isVisible 的样子。pagerjs 中有可以绑定的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T23:07:48.400

我最终在我的虚拟机上创建了一个新绑定

```
 vm.isCurrentPage = function(pageid){
            var page = pager.page.find(pageid);
            return page.isVisible;
        }; 
```

随着使用

```
<a data-bind="page-href:'server/dashboard', css:{selected:isCurrentPage('server')}">Dash</a> 
```

# c# - MediaElement Stream 和 VisualBrush

> ID：15101222
> 
> 赞同：1
> 
> 时间：2013-02-26T23:06:25.130
> 
> 标签：c#, wpf, wcf, mediaelement, ivalueconverter

从 WCF 服务我得到了一个视频流。现在我想`MediaElement`在`VisualBrush`.

我尝试直接给出URI，这不起作用。所以我写了一个简单`Converter`的将视频保存到 HDD 并将 URI 返回到保存的文件。这是我的代码。

`Converter`: _

```
[ValueConversion(typeof(Stream), typeof(Uri))]
public class MediaElementStreamConverter : IValueConverter {
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture) {
        if (!(value is Stream)) {
            return new Uri("");
        }
        string path = Path.GetTempFileName();
        using (var fs = new FileStream(path, FileMode.OpenOrCreate)) {
            ((Stream)value).CopyTo(fs);
        }
        return path;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture) {
        return "";
    }
} 
```

这是我使用的代码`Converter`：

```
<Grid Opacity="0.4" VerticalAlignment="Top">
    <Grid.Background>
        <VisualBrush>
            <VisualBrush.Visual>
                <MediaElement IsMuted="True" ScrubbingEnabled="True" LoadedBehavior="Manual" Source="{Binding stream, Converter={StaticResource MediaElementStreamConverter}}" Loaded="MediaElement_VideoDataTemplate_Loaded" />
            </VisualBrush.Visual>
        </VisualBrush>
    </Grid.Background>
</Grid> 
```

这是`MediaElement_VideoDataTemplate_Loaded`方法：

```
private void MediaElement_VideoDataTemplate_Loaded(object sender, RoutedEventArgs e) {
    var mediaElement = (MediaElement)sender;
    mediaElement.Play();
    mediaElement.Pause();
} 
```

问题是，视频无法启动。

# java - 如何创建和配置 Hadoop 客户端脚本？

> ID：15101225
> 
> 赞同：1
> 
> 时间：2013-02-26T23:06:33.200
> 
> 标签：java, shell, hadoop, sqoop

有一个正在运行的 Hadoop 集群。我已经下载了 Hadoop 发行版（在本例中为 0.20.205.0）

我需要创建一些能够在该集群上调用 Hadoop 的 shell 脚本（bash/zsh/perl）。理想情况下，它应该能够以这种方式从 Sqoop 脚本中调用：

```
exec ${HADOOP_HOME}/bin/hadoop com.cloudera.sqoop.Sqoop "$@" 
```

如何调用 Hadoop 并提供 namenode/jobtracker URI？如何为 Sqoop 和 DB 驱动程序提供额外的库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:05:54.373

使用 hadoop 通用选项应该足够简单 - 我假设您已经`${HADOOP_HOME}/conf`为集群配置了内容（即 core-site.xml 和 mapred-site.xml）

```
exec ${HADOOP_HOME}/bin/hadoop com.cloudera.sqoop.Sqoop \
    -libjars myjar1.jar,myjar2,jar "$@" 
```

在这里，您通过`-libjars`选项传递要放置在类路径中的 jar。

如果您有多个要定位的集群，那么您只需为每个集群创建不同的 conf 文件夹并`HADOOP_CONF_DIR`在调用 hadoop 脚本之前设置环境变量，或者您可以使用`-Dkey=value`通用参数来适当地设置`fs.default.name`和`mapred.job.tracker`：

```
exec ${HADOOP_HOME}/bin/hadoop com.cloudera.sqoop.Sqoop \
    -libjars myjar1.jar,myjar2,jar \
    -Dfs.default.name=hdfs://namenode-servername:9000 \
    -Dmapred.job.jobtracker=jobtracker-servername:9001 \
    "$@" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T04:40:18.667

我的问题实际上是运行 Sqoop。所以我通过简单地提供 -fs 和 -jt 参数作为 Sqoop 命令的第一个参数来解决它（例如 sqoop-import）

```
sqoop-import \
    -fs $HADOOP_FILESYSTEM -jt $HADOOP_JOB_TRACKER  \
    --connect $DB_CONNECTION_STRING --username $DB_USER -P \
    --outdir /home/user/sqoop/generated_code \
    "$@" # <- other parameters 
```

# mysql - 清除 MySQL 磁盘空间

> ID：15101227
> 
> 赞同：1
> 
> 时间：2013-02-26T23:06:40.940
> 
> 标签：mysql, flush, disk, diskspace

我们删除了一个非常大的 MySQL 表（大约 100GB 大小）。磁盘空间似乎没有被释放；您如何使 MySQL 将其更改刷新到磁盘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:09:11.803

在您的 my.ini 中查找数据目录，该数据库的所有文件都在数据目录的子目录中，如果仍然存在，请删除这些文件。

# dita - 在 Mac OS 中运行 DITA OT？

> ID：15101230
> 
> 赞同：0
> 
> 时间：2013-02-26T23:06:46.643
> 
> 标签：dita, dita-ot

DITA OT 文档有很多关于如何在 Windows 环境中运行 DITA OT 的信息，但对于在 Mac OS 中运行它的信息却很少。在 Mac OS (Mountain Lion) 中运行它的程序是什么？特别是如果您需要设置环境变量（这在 Mac OS 中有点棘手）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T08:47:23.157

OS X 的 DITA-OT 安装记录在[DITA-OT 用户指南](http://dita-ot.sourceforge.net/1.7/readme/installing-minimal-package-on-linux.html)中。

# ios - iOS 创建推送通知

> ID：15101233
> 
> 赞同：0
> 
> 时间：2013-02-26T23:06:55.227
> 
> 标签：ios, push-notification

是否可以从应用程序中创建推送通知而不是依赖 Web 服务？

例如，假设一个应用程序轮询位置变化并在用户进入地理围栏区域时通知用户。

推送通知是否*总是*必须通过苹果的服务？或者是否有可能触发一个内部事件，然后触发推送通知？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T23:09:17.200

您正在寻找的是“本地”通知，而不是“推送”通知。

更多信息：http: [//developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008194-CH1-SW1](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008194-CH1-SW1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:10:14.933

您不会使用推送通知来做到这一点，但您可以使用本地通知。让应用程序在后台轮询位置变化，并在用户进入该区域时提醒用户。这绝对是可行的。

[这](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html)是有关在前台和后台轮询位置更改的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T00:20:16.323

UILocalNotifications 的简单教程，以防您正在寻找一个。

[http://iphone-rahulvarma.blogspot.com/2012/03/uilocalnotifications-tutorial.html](http://iphone-rahulvarma.blogspot.com/2012/03/uilocalnotifications-tutorial.html)

# css - 为什么在 CSS 中使用带有大填充的 Bootstrap Glyphicons 会导致出现不需要的图标？

> ID：15101239
> 
> 赞同：0
> 
> 时间：2013-02-26T23:07:05.390
> 
> 标签：css, twitter-bootstrap

我知道如何显示这样的图标：

```
<span class='icon-remove'></span> 
```

但是，如果我添加`padding`到`span`，则会出现额外的图标。如何解决？

```
span {
    padding-right:60px;
} 
```

[小提琴](http://jsfiddle.net/uqVvA/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:11:14.977

我想你只是想在图标的右边有一些空格？你有没有试过`margin`：

```
<span class='icon-remove' style='margin-right:60px'></span> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:18:12.037

额外填充显示更多图标的原因是 Bootstrap 使用 CSS sprite 来显示图标。您实际看到的是背景图像，更具体地说，是包含许多可用图标的大型背景图像的一部分。“icon-remove”类的定义指定了用于选择特定图标的背景位置属性。如果添加填充，您将显示更多背景图像，其中将显示其他图标。

那么，解决方案是要么像 Rid Iculous 所建议的那样添加边距，要么将你放在另一个元素中并为其添加填充。我会选择保证金。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:18:19.180

字形使用一个大图像映射（或所谓的 CSS 精灵）呈现，因此如果您在元素的任一侧留出足够的空间，它也会显示其他字形。想到了两个解决方案：

1）将图标放在包含元素中：

```
<span><i class='icon-remove'></i></span> 
```

2）或使用保证金：

```
span { margin-right: 60px } 
```

# javascript - 我应该如何在javascript中制作复杂的顺序事件

> ID：15101243
> 
> 赞同：2
> 
> 时间：2013-02-26T23:07:35.097
> 
> 标签：javascript, jquery

我正在开发一个用于 JavaScript 的交互式教程工具。该工具的核心是教程的脚本。该脚本将触发运行动画、扬声器声音加载新页面等的各种功能。三个示例调用（大多数教程将有 10-100 次调用，因此非常需要对调用进行简洁的概述：

```
wrap(); //wrap the page in an iframe
playsound('media/welcome') //playing a sound (duh)
highlight('[name=firstname]'); //animation that highlights an element.
playsound('media/welcome2');
loadpage(page2); //loading a new page 
```

所有调用都有一个共同点：它们都有非正常触发器。例如，在这个简单的脚本中，一旦加载了第一个调用中的 iframe，就应该触发第二个调用。一旦声音完成（即延迟），就会触发第三个脚本。动画完成后应该触发第四个功能。第五个事件应该在一个事件上触发（例如点击）。

对此的技术解决方案是在前一个函数的回调中调用该函数，这可能会变得非常混乱。我喜欢这样的解决方案，其中函数被称为 lite，这是一个有一点头脑但没有编码经验的人可以编写自己的脚本。你会如何解决这个问题？我对javascript很陌生，所以如果你能明确一点，我会很感激的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:17:42.317

我认为回调是你最好的选择。它们不必是凌乱的（尽管当然有可能使它们完全难以理解）。您可以创建每个函数来接受回调，然后使用这样的结构以可读的方式依次调用它们：

```
var loadingSequence = {
    start : function() { wrap(this.playsound); },
    playsound : function() { playsound('media/welcome', this.highlight); },
    highlight : function() { highlight('[name=firstname]', this.playsound2); },
    playsound2 : function() { playsound('media/welcome2', this.loadpage); },
    loadpage : function()  { loadpage(page2); }
};

loadingSequence.start(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T23:38:59.977

我会使用按构建的解决方案。一定有一款适合您的需求。像[jTour](http://plugins.jquery.com/tour/)这样简单的东西，或者如果不包括它，像[Scriptio](http://www.scriptio.us/)这样更复杂的东西。您可能也对[这个问题](https://stackoverflow.com/questions/2533908/basic-framework-for-presentations-using-html5-javascript)的一些答案感兴趣。

**编辑** 如果您不想使用预先存在的解决方案，我会这样做：

```
var runTutorial = (function () {

    // The command object holds all the different commands that can
    // be used by someone for the tutorial. Each of these commands
    // will recive a callback set as their `this`. This
    // callback should be called by your commands when they are done
    // running. The person making the tutorial won't need to know
    // about the callback, the code will handle that.
    var commands = {
        wrap: function () {
            //wrap the page in an iframe
            this();
        },
        playsound: function (soundPath, soundLength) {
            //playing a sound (duh)
            setTimeout(this, soundLength);
        },
        highlight: function (selector) {
            //animation that highlights an element.
            //I'm using jQuery UI for the animation here,
            // but most animation libraries should provide
            // a callback for when the animation is done similarly
            $(selector).effect('highlight', 'slow', this);
        },
        loadpage: function (pageUrl) {
            //loading a new page
            setTimeout(this, 500);
        },
        waitForClick: function () {
            // when we go into the click handler `this` will no
            // longer be availble to us since we will be in a
            // different context, save `this` into `that` so
            // we can call it later.
            var that = this;
            $(document).one('click', function () {
                that();
            });
        }
    },
    // This function takes an array of commands
    // and runs them in sequence. Each item in the
    // array should be an array with the command name
    // as the first item and any arguments it should be
    // called with following as the rest of the items.
    runTutorial = function (commandList) {
        var nextCommand = function () {
            if (commandList.length > 0) {
                var args = commandList.shift();

                // remove the command name
                // from the argument list
                cmd = args.shift(1);

                // call the command, setting nextCommand as `this`
                commands[cmd].apply(nextCommand, args);
            }
        }

        nextCommand();
    };

    return runTutorial;

}()); 

$('#tutorialbutton').click(function() {
    runTutorial([
        ['playsound', 'media/welcome', 1000],
        ['highlight', '[name=firstname]'],
        ['playsound', 'media/welcome2', 1500],
        ['waitForClick'],
        ['loadpage', page2],
        ['playsound', 'media/page2', 100]
    ]);
}); 
```

该`runTutorial`函数采用一个简单的数组，其中包含按应运行顺序排列的命令及其参数。无需用回调来打扰编写脚本的人`runTutorial`，为他们处理。与需要编写器管理回调的系统相比，这具有一些很大的优势。您不需要像使用显式回调那样为脚本中的每一行指定一个唯一的名称，也不需要无休止地嵌套匿名函数。您无需重新连接任何东西来更改命令的播放顺序，您只需在阵列中重新排列它们即可。

[你可以玩的jsfiddle](http://jsfiddle.net/x2dfd/3/)

您的每个命令都需要等待其操作完成，然后才能调用其回调（又名`this`）。我在小提琴中使用`setTimeout`. 例如，如果您使用 jQuery 的[`.animate`](http://api.jquery.com/animate/)for `highlight`，它提供了一个`complete`在动画完成时触发的处理程序，只需坚持`this`（不带调用括号`()`）在那里。如果您使用的是 jQuery UI，它具有内置的[“高亮”](http://api.jqueryui.com/highlight-effect/) [效果](http://api.jqueryui.com/effect/)，因此您可以像这样实现它：

```
highlight: function (selector) {
    //animation that highlights an element.
    $(selector).effect('highlight', 'slow', this);
}, 
```

大多数其他提供动画的库应该提供类似的回调选项，您可以使用。

根据您播放它们的方式，控制声音的回调可能会更难。如果您使用的方法没有提供回调或轮询它的方式以查看它是否已完成，您可能只需要添加另一个参数，`playsound`该参数以毫秒为单位获取声音的长度，然后在继续之前等待那么长时间：

```
playsound: function (soundPath, soundLength) {
    //playing a sound (duh)
    setTimeout(this, soundLength);
}, 
```

# .net - 在.Net中我需要做双重检查锁定吗

> ID：15101244
> 
> 赞同：2
> 
> 时间：2013-02-26T23:07:35.337
> 
> 标签：.net, multithreading, locking

如果我想延迟实例化一个包含大量数据的类并且我希望它只有一个实例（单例），那么在设置实例之前是否需要仔细检查对象？（。网）。或者是否可以像在 AnotherWayForSingletonInstance 中那样只进行一次检查

这是代码：

```
class MyHeavyClass
{
private MyHeavyClass()
{
}

private static object _lock = new object();
private static MyHeavyClass _instance;
public static MyHeavyClass Instance{
    get{
        //check 1
        if (_instance == null)
        {
            lock(_lock)
            {
                //check 2
                if (_instance == null)
                {
                    _instance = new MyHeavyClass();
                }
            }
        }
        return _instance;
    }
}

public static MyHeavyClass AnotherWayForSingletonInstance{
    get{
        lock(_lock)
        {
            //check 1
            if (_instance == null)
            {
                _instance = new MyHeavyClass();
            }
        }
        return _instance;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:15:37.237

您*永远*不需要双重检查锁定 - 它纯粹是一种性能优化，依赖于平台相关的内存排序技巧来避免在大多数情况下锁定。单检查锁定总是足够的，更便携，更简单，所以你应该更喜欢它，除非基准测试表明你真的需要那个小提升。但还有一个更好的解决方案。

您应该完全避免显式锁定单例。相反，请尝试使用静态初始化程序，因为它们简单、（线程）安全、快速且延迟加载。

```
sealed class MyHeavyClass
{
    MyHeavyClass() {}
    public static readonly MyHeavyClass Instance = new MyHeavyClass();
} 
```

**这样的实例不是在应用程序启动**时创建的，而是在第一次使用类型或字段之前有点懒惰。确切的规则[取决于是否存在静态构造函数](http://csharpindepth.com/Articles/General/BeforeFieldInit.aspx)，但如果您可以接受初始化程序有时比必要的更早执行，这很好。在 .NET v4 上，初始化[非常懒惰](http://msmvps.com/blogs/jon_skeet/archive/2010/01/26/type-initialization-changes-in-net-4-0.aspx)。99% 的情况下，这应该是您的首选实现，因为它可能是最快、最简单的一种。即使在 .NET v3.5 和更早版本上，也不会加载，直到遇到引用该类型的方法。

这段代码比基于锁的版本更快，因为一旦类完全加载，访问字段时就不需要警卫或锁了。特别是，JIT 可以简单地假设变量已设置，理论上甚至可以省略空值检查和提升循环读取等内容。如果您确实需要精确控制延迟加载的时间；尝试更简单的 lock-then-check 而不是双重检查锁定（这依赖于一些棘手的内存模型细节）——但实际上，我怀疑几乎没有人需要这种精确的控制；你只是想避免不必要的工作。

关于双重检查锁定：据我所知，即使在 .NET 上，您也需要`volatile`完全可移植双重检查锁定的关键字：.NET 的 ARM 实现[没有与](http://msdn.microsoft.com/en-us/magazine/jj553518.aspx)您相同的写入顺序保证重新习惯于 x86。即使它适用于 ARM 和各种单声道平台，**如果它比简单的静态初始化程序慢，为什么还要使用如此复杂的实现呢？**

* * *

## 基准测试结果

```
  AlwaysLock 初始化
  每次迭代 37.09 纳秒（1000000 次 AlwaysLock）
  DoubleCheckedLocking 初始化
  每次迭代 2.78 纳秒（1000000 次 DoubleCheckedLocking 迭代）
  静态初始化器初始化
  每次迭代 2.13 纳秒（StaticInitializer 的 1000000 次迭代）
  静态构造函数初始化
  每次迭代 2.56 纳秒（StaticConstructor 的 1000000 次迭代）

  每次迭代 38.45 纳秒（10000000 次 AlwaysLock）
  每次迭代 2.07 纳秒（10000000 次 DoubleCheckedLocking）
  每次迭代 1.57 纳秒（StaticInitializer 的 10000000 次迭代）
  每次迭代 1.57 纳秒（StaticConstructor 的 10000000 次迭代）

  每次迭代 21.71 纳秒（10000000 次 AlwaysLock 同步迭代）
  每次迭代 4.62 纳秒（DoubleCheckedLocking 的 10000000 次同步迭代）
  每次迭代 3.15 纳秒（StaticInitializer 的 10000000 个同步迭代器）
  每次迭代 3.17 纳秒（StaticConstructor 的 10000000 个同步迭代器）

```

## 基准代码

```
void Main()
{
    const int loopSize = 10000000;

    Bench(loopSize/10, ()=> AlwaysLock.Inst);
    Bench(loopSize/10, ()=> DoubleCheckedLocking.Inst);
    Bench(loopSize/10, ()=> StaticInitializer.Inst);
    Bench(loopSize/10, ()=> StaticConstructor.Inst);
    Console.WriteLine();
    Bench(loopSize, ()=> AlwaysLock.Inst);
    Bench(loopSize, ()=> DoubleCheckedLocking.Inst);
    Bench(loopSize, ()=> StaticInitializer.Inst);
    Bench(loopSize, ()=> StaticConstructor.Inst);
    Console.WriteLine();
    SBench(loopSize, ()=> AlwaysLock.Inst);
    SBench(loopSize, ()=> DoubleCheckedLocking.Inst);
    SBench(loopSize, ()=> StaticInitializer.Inst);
    SBench(loopSize, ()=> StaticConstructor.Inst);

    //uncommenting the next lines will cause instantiation of 
    //StaticInitializer but not StaticConstructor right before this method.
    //var o = new object[]{ 
    //          StaticInitializer.Inst, StaticConstructor.Inst};
}

static void Bench<T>(int iter, Func<T> func) {
    string name = func().GetType().Name;
    var sw = Stopwatch.StartNew();
    Parallel.For(0,iter,i=>func());
    var sec = sw.Elapsed.TotalSeconds;
    Console.Write("{0:f2} nanoseconds per iteration ({1} iters of {2})\n"
        , sec*1000*1000*1000/iter, iter, name);
}

static void SBench<T>(int iter, Func<T> func) {
    string name = func().GetType().Name;
    var sw = Stopwatch.StartNew();
    for(int i=0;i<iter;i++) func();
    var sec = sw.Elapsed.TotalSeconds;
    Console.Write("{0:f2} nanoseconds per iteration ({1} sync iters of {2})\n"
        , sec*1000*1000*1000/iter, iter, name);
}

sealed class StaticInitializer {
    StaticInitializer(){ Console.WriteLine("StaticInitializer init"); }
    public static readonly StaticInitializer Inst = new StaticInitializer();
    //no static constructor, initialization happens before
    //the method  with the first access
}

sealed class StaticConstructor {
    StaticConstructor(){ Console.WriteLine("StaticConstructor  init"); }
    //a static constructor prevents initialization before the first access.
    static StaticConstructor(){}
    public static readonly StaticConstructor Inst = new StaticConstructor();
}

sealed class AlwaysLock {
    AlwaysLock(){ Console.WriteLine("AlwaysLock init"); }
    static readonly object _lock = new object();
    static AlwaysLock _instance;
    public static AlwaysLock Inst { get {
        lock(_lock)
            if (_instance == null)
                _instance = new AlwaysLock();
        return _instance;
    } }
} 

sealed class DoubleCheckedLocking {
    DoubleCheckedLocking(){ Console.WriteLine("DoubleCheckedLocking init"); }
    static readonly object _lock = new object();
    static DoubleCheckedLocking _instance;

    public static DoubleCheckedLocking Inst { get {
        if (_instance == null)
            lock(_lock)
                if (_instance == null)
                    _instance = new DoubleCheckedLocking();
        return _instance;
    } }
} 
```

## TL;博士

不要对单例使用锁定，使用静态初始化器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:26:43.727

一次检查就可以了。

仅出于性能原因进行双重检查。由于锁只是为了防止多个线程同时创建实例，因此只有在您实际需要创建实例时才需要它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T16:29:04.603

这是我的答案：正如@Eamon 所建议的，解决对静态对象的线程访问的最佳方法是使用静态初始化程序初始化静态对象（在这种情况下，您不需要锁来访问实例）（另外，请检查Eamon 关于如何使用静态 ctor 的代码可以使实例在首次访问类之前不被分配）。

但是，如果您不能使用静态初始化程序，我认为使用双重检查锁定是有意义的，因为它可以提高性能。从我的测试中，我发现只有当我调用 Instance 方法超过 100,000 次时，性能才重要。

在我的代码以及 Eamon 的代码中，在足够大的迭代中，使用双重检查锁定可以显着提升性能。

**这是我的测试代码（在 LinqPad 中运行）**

```
void Main()
    {
        Stopwatch sw = Stopwatch.StartNew();
        const int loopSize = 10000000;
        for (int i = 0; i < loopSize; i++)
        {
            SingletonSingleLock o = SingletonSingleLock.Instance;
        }

        sw.ElapsedMilliseconds.Dump();

        sw = Stopwatch.StartNew();
        for (int i = 0; i < loopSize; i++)
        {
            SingletonDoubleLock o = SingletonDoubleLock.Instance;
        }
        sw.ElapsedMilliseconds.Dump();
    }

    /* Test results
        Elapsed milliseconds
        # of calls to Instance      1,000       10,000      100,000     1,000,000       10,000,000
        SingletonSingleLock             0           0           4           39              433
        SingletonDoubleLock             0           0           1           17              185
    */

    public class SingletonSingleLock
    {
        private SingletonSingleLock()
        {

        }

        private static object _lock = new object();
        private static SingletonSingleLock _instance;
        public static SingletonSingleLock Instance
        {
            get
            {
                lock(_lock)
                {
                    if (_instance == null)
                    {
                        _instance = new SingletonSingleLock();
                    }
                }
                return _instance;
            }
        }

    }

    public class SingletonDoubleLock
    {
        private SingletonDoubleLock()
        {

        }

        private static object _lock = new object();
        private static SingletonDoubleLock _instance;

        public static SingletonDoubleLock Instance
        {
            get
            {
                if (_instance == null)
                {
                    lock(_lock)
                    {
                        if (_instance == null)
                        {
                            _instance = new SingletonDoubleLock();
                        }
                    }
                }
                return _instance;
            }
        }

    } 
```

从 VS 分析器结果的屏幕截图中可以看出，双重检查锁定可以提高性能。 ![VS 性能结果](../Images/f3079ef6446850c77df01823759edc0e.png)

# javascript - 同位素度假村不移动第一个元素

> ID：15101247
> 
> 赞同：2
> 
> 时间：2013-02-26T23:07:50.080
> 
> 标签：javascript, jquery, jquery-isotope

我正在尝试实现[同位素](http://isotope.metafizzy.co/index.html)库，以便元素围绕我的菜单进行排序。经过一些研究和工具，我选择将同位素容器中的第一个元素设置为菜单项。然后，我将其从我所做的任何过滤或排序操作中过滤掉。

我选择了这种方法而不是角戳方法，因为角戳的限制只适用于右对齐的元素（据我了解 - 我可能会错过使用它..）。我希望菜单位于左上角。

我遇到的问题是随机播放。我正在尝试随机化除第一个元素之外的所有元素的位置（在此示例中为菜单）。我想把菜单留在原处。当我尝试使用随机播放随机重新排序所有元素时，我无法从可用列表中过滤掉我的菜单项以进行随机播放。当子导航决定飞走时，这会导致一些导航问题。

这是一个示例布局：http: [//jsfiddle.net/ufomammut66/xwpuk/30/](http://jsfiddle.net/ufomammut66/xwpuk/30/)

到目前为止，我已经尝试过： `$('.container').isotope('shuffle');`

此函数只有 1 个参数 - 回调。我看不出如何在这里操纵选择过程。

我考虑过使用排序功能，但由于某种原因我无法得到： `$('.container').isotope({ sortBy : 'random' });`多次触发。即使我这样做了，我仍然不知道如何利用它来过滤掉我的菜单。

任何帮助将不胜感激，谢谢！

**编辑：**更新 jsFiddle 链接以包含可排序对象上的数字 - 有助于显示排序工作。

**编辑 2：**添加了更多的问题细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:33:40.673

我相信同位素缓存排序，所以它不必重新计算它已经完成的排序。它甚至看起来是“随机”的。

修复/破解是`reloadItems`在随机排序之后：

```
$('#reorder').click(function () {
    $('.container').isotope({sortBy: 'random'}).isotope('reloadItems');
}); 
```

演示：http: [//jsfiddle.net/nT66r/](http://jsfiddle.net/nT66r/)

至于过滤菜单项，random 只是返回一个随机数，所以你可以做的不多。但是，您可以编写自定义随机排序，允许您“过滤”菜单：

```
getSortData: {
    name: function ($elem) {
        return $elem.data('name');
    },
    myrandom: function ($elem) {
        if($elem.hasClass('menu')) {
             return -1;   
        }
        return Math.random();
    }
} 
```

演示：http: [//jsfiddle.net/PvnMn/](http://jsfiddle.net/PvnMn/)

请注意，因为`menu`是一个类，如果有多个`menu`项目，你会让自己对一些可能的奇怪现象持开放态度。如果你只有一个，身份证是更好的选择。在这种情况下，您将使用`$elem.is('#menu')`而不是`$elem.hasClass('menu')`.

与`#menu`：http: [//jsfiddle.net/PvnMn/1/](http://jsfiddle.net/PvnMn/1/)

这是我在过滤其他类型时尝试的版本：http: [//jsfiddle.net/jtbowden/Vuqgu/](http://jsfiddle.net/jtbowden/Vuqgu/)

# c# - *.Designer.cs 文件丢失

> ID：15101252
> 
> 赞同：2
> 
> 时间：2013-02-26T23:08:11.577
> 
> 标签：c#, visual-studio-2010

我正在使用 Visual Studio 2010，当我创建一个表单时，我得到一个`FormName.Designer.cs`包含所有自动生成代码的文件。

然而，当我执行以下操作时，这正是我想要的：

1.  创建了一个空类。
2.  子类`System.Windows.Forms.Control`
3.  给设计器添加一个`System.Windows.Forms.ImageList`。
4.  将图像添加到设计器中的 ImageList。

所有自动生成的代码都被丢弃在我的类文件中，我没有得到`*.Designer.cs`文件。

如何让 VS 始终使用`*.Designer.cs`文件？

* * *

**更新**

声明一个部分类和子类化 UserControl 是不够的。当我创建一个新项目时，我必须选择“UserControl”，然后我得到了一个 Designer.cs 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T01:08:56.980

这是正常的，设计人员在 VS2005 之前的 Visual Studio 版本中工作的方式，这些版本尚不支持*部分类*。您只能获得派生自 Form 或 UserControl 的类的单独 Designer.cs 文件，**并且**使用 partial 关键字声明它们。

不是 100% 确定根本原因是什么，但肯定与 Control 类的非常简单的设计器有关。Form 和 UserControl 的设计者要花哨得多。

实际上没有任何问题，所以这不是一个真正的问题。物有所值，特别是因为在创建自定义控件时实际上需要另一个组件或控件是非常罕见的。使“属性”窗口工作很方便，但以我个人的经验，当您在“解决方案资源管理器”窗口中双击类时，默认情况下获取设计器页面的相当大的烦恼是不值得的。我已经记不清我喊“粗鲁！”的次数了。在机器上。

# php - 无法在php中编辑xml文件内容

> ID：15101259
> 
> 赞同：2
> 
> 时间：2013-02-26T23:08:24.573
> 
> 标签：php, simplexml

```
<?php 
$picid= $_GET['id']; 
intval($picid);
$file="data.xml";
echo $picid; //output is 121 (say)
$data= new SimpleXMLElement($file, null, true);
$data->score[$picid]=$data->score[$picid]+3;
file_put_contents($file, $data->asXML());
?> 
```

xml 文件更改为

```
<score 121="3">0</score> 
```

在 score[0] 标签上。

而我想要输出

```
<score>3</score> 
```

在 score[121] 标签上。

但是当我将代码更改为

```
<?php 
$picid= $_GET['id']; 
intval($picid);
$file="data.xml";
echo $picid; //121 is printed (say)
$data= new SimpleXMLElement($file, null, true);
$data->score[121]=$data->score[121]+3;
echo $data->score[121];
file_put_contents($file, $data->asXML());
?> 
```

我得到了想要的输出。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:15:49.073

你的 intval 返回无效。

尝试：

```
$picid = intval($picid); 
```

# php - 在节点中使用 xmlns:xlink 属性创建 XML

> ID：15101271
> 
> 赞同：3
> 
> 时间：2013-02-26T23:09:29.350
> 
> 标签：php, xml, simplexml

我正在尝试添加生成这样的输出：

```
<mets ....
xmlns:xlink="http://www.w3.org/1999/xlink"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.loc.gov/METS/       
http://www.loc.gov/standards/mets/mets.xsd"> 
```

我可以生成一切正常，但不能添加`xmlns:xlink`属性。我得到的最接近的是：

```
$this->xml = new SimpleXMLElement('<mets></mets>');
$mets->addAttribute("xlink:someName", "blabla", "http://www.w3.org/1999/xlink");    
$mets->addAttribute("xsi:schemaLocation", "http://www.loc.gov/METS/  
http://www.loc.gov/standards/mets/mets.xsd",
"http://www.w3.org/2001/XMLSchema-instance"); 
```

生成：

```
<mets ....
xmlns:xlink="http://www.w3.org/1999/xlink"
----begin of part I don't desire-----
xlink:someName="blablabla"
----end of  part I don't desire-----
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.loc.gov/METS/       
http://www.loc.gov/standards/mets/mets.xsd"> 
```

我怎样才能添加`xmlns:xlink`而不添加 `xlink:somethingElse`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T13:54:21.447

我提出的解决方案相当简单：

因为

```
$mets->addAttribute("xlink:someName", "", "http://www.w3.org/1999/xlink"); 
```

将始终添加两个属性 - 一个用于命名空间声明 ( `xmlns:xlink`)，然后是您实际添加的属性 ( `xlink:someName`) - 然后您需要做的就是删除不需要的添加属性，前缀命名空间属性将保留：

```
unset($mets->attributes('xlink', true)['someName']); 
```

完整示例：

```
$mets = new SimpleXMLElement('<mets></mets>');
$mets->addAttribute("xlink:someName", "", "http://www.w3.org/1999/xlink");
unset($mets->attributes('xlink', true)['someName']);
echo $mets->asXML(); 
```

输出：

```
<?xml version="1.0"?>
<mets xmlns:xlink="http://www.w3.org/1999/xlink"/> 
```

然而，这通常不是必需的。您要么需要为某些东西使用命名空间 - 然后 simplexml 将在需要时添加它 - 或者您不需要它，则无需添加它。

XML 本身根本不需要声明未使用的命名空间。因此，您可能也可以忽略它，或者您只需要在需要添加它的地方添加它，例如稍后特定的 xlink 元素/属性。

任何支持名称空间的 XML 解析器都将支持任何格式良好的 XML+Namspaces 文档，因此确实没有理由担心根元素是否具有该声明以及带有哪个前缀。Simplexml 只是负责，只需在需要的地方添加 xlink 属性。例子：

```
$mets = new SimpleXMLElement('<mets></mets>');
$child = $mets->addChild('child');
$child->addAttribute('xlink:href', 'child.xml', 'http://www.w3.org/1999/xlink');
$child = $child->addChild('child');
$child->addAttribute('xlink:href', 'child.xml', 'http://www.w3.org/1999/xlink');
echo $mets->asXML(); 
```

输出：

```
<?xml version="1.0"?>
<mets>
  <child xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="child.xml">
    <child xlink:href="child.xml"/>
  </child>
</mets> 
```

# sorting - 返回二叉树中项目的排序子集

> ID：15101272
> 
> 赞同：2
> 
> 时间：2013-02-26T23:09:34.663
> 
> 标签：sorting, b-tree

我有很多节点以通常的方式存储在二叉树中，以便根据存储在每个节点中的某个值对它们进行排序；也就是说，可以从左到右递归遍历树并按排序顺序获得总集。

但是，我有一个大的单独的指针数组，指向树中节点的子集，并且该数组中的顺序是随机的。

我希望能够快速排序这个数组。有什么方法可以参考二叉树结构来加快速度吗？如有必要，我可以将成员添加到任何节点。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:32:36.203

通过在节点中添加一个标志，您可以获得运行时`O(t+a)`（t 是树的大小，a 是数组的大小）。这是通过首先在数组中设置标志然后遍历树并挑选出被标记的值来完成的。

这仅在您的树仅`log a`比数组大几倍时才有优势。如果 t>>a 快速排序肯定是首选方法，因为它的运行时间为`O(a * log a)`.

# android - 小部件 onClick 无法正常工作

> ID：15101275
> 
> 赞同：2
> 
> 时间：2013-02-26T23:09:39.907
> 
> 标签：android, android-intent, android-widget, widget, android-pendingintent

欢迎大家

我希望当用户按下小部件时，小部件会自行停止，当用户再次按下时，小部件会打开他的功能

我正在使用这篇文章的解决方案在我的小部件上实现 onClick：[Android 中的可点击小部件](https://stackoverflow.com/questions/2748590/clickable-widgets-in-android)

该解决方案适用于 android 2.2 手机和 android 4.1 手机，但不适用于 android 2.3.6 的 Nexus One。我单击小部件，但没有任何反应...

这是我完整的小部件类：

```
 public class mWidgetProvider extends AppWidgetProvider{         
            public static String ACTION_WIDGET_CLICK = "ActionWidgetClick"; 
            public static final String ACTION_AUTO_UPDATE = "AUTO_UPDATE";

            DecimalFormatSymbols symbols;
            DecimalFormat tempDecimalFormat;
            int pMaxFreq=-1;
            String cCurrentFreq=null;
            int freq = 0;
            float usage =-1;
            BufferedReader freqBufferedReader;
            PowerManager pm;
            RemoteViews remoteViews;
            ComponentName thisWidget;   
            WidgetAlarm widgetAlarm;
            ActivityManager manager;

            @Override
            public void onDisabled(Context context) {
                super.onDisabled(context);
                context.stopService(new Intent(context, UpdateService.class));

                //stop alarm
                widgetAlarm = new WidgetAlarm(context.getApplicationContext());
                widgetAlarm.stopAlarm();

                System.out.println("XXXXX onDISABLED");
            }

            @Override
            public void onDeleted(Context context, int[] appWidgetIds) {
                super.onDeleted(context, appWidgetIds);

                System.out.println("XXXXX onDELETED");
            }

            @Override
            public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
                super.onUpdate(context, appWidgetManager, appWidgetIds);

                context.startService(new Intent(context, UpdateService.class)); 

                remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
                thisWidget = new ComponentName(context, mWidgetProvider.class );

                //preparamos el evento para cuando el usuario presiona en el widget, ese evento será recibido en onReceive()
                Intent active = new Intent(context, mWidgetProvider.class);
                active.setAction(ACTION_WIDGET_CLICK);
                PendingIntent actionPendingIntent = PendingIntent.getBroadcast(context, 0, active, 0);
                remoteViews.setOnClickPendingIntent(R.id.fondo, actionPendingIntent);           

                AppWidgetManager.getInstance(context).updateAppWidget( thisWidget, remoteViews );       

                // start alarm
                widgetAlarm = new WidgetAlarm(context.getApplicationContext());
                widgetAlarm.startAlarm();

                System.out.println("XXXXX onUPDATE");       
            }       

            @Override
            public void onReceive(Context context, Intent intent){
                if (intent.getAction().equals(ACTION_WIDGET_CLICK)){
                    switchWidget(context);
                }else if(intent.getAction().equals(ACTION_AUTO_UPDATE)){

                    symbols = new DecimalFormatSymbols(Locale.GERMAN);
                    symbols.setDecimalSeparator('.');
                    tempDecimalFormat = new DecimalFormat("#.#", symbols);      

                    pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE); 
                    remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
                    thisWidget = new ComponentName(context, mWidgetProvider.class );

                    if (pm.isScreenOn()){               
                     /*
                                 here i do some work to update the textviews of the widget
                                 */

                        AppWidgetManager.getInstance(context).updateAppWidget( thisWidget, remoteViews );
                        System.out.println("XXXXX UPDATING WIDGET");
                    }
                }else{
                    super.onReceive(context, intent);
                }

                System.out.println("XXXXX onRECEIVE: "+intent.getAction());
            }

            @Override
            public void onEnabled(Context context) {
                super.onEnabled(context);           

                System.out.println("XXXXX onENABLED");
            }   

            public void switchWidget(Context context){
                symbols = new DecimalFormatSymbols(Locale.GERMAN);
                symbols.setDecimalSeparator('.');
                tempDecimalFormat = new DecimalFormat("#.#", symbols);      

                remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
                thisWidget = new ComponentName(context.getPackageName(), mWidgetProvider.class.getName());
                widgetAlarm = new WidgetAlarm(context.getApplicationContext());
                if (isMyServiceRunning(context)==true){ //si el widget está encendido la apagamos
                    context.stopService(new Intent(context, UpdateService.class));          
                    widgetAlarm.stopAlarm();
                    remoteViews.setTextViewText(R.id.freq,"HERE I CHANGE THE VALUE");
                }
                else{ //si el widget está apagado lo encendemos
                    context.startService(new Intent(context, UpdateService.class)); 
                    widgetAlarm.startAlarm();
                            remoteViews.setTextViewText(R.id.freq,"HERE I CHANGE THE VALUE");
                }
                AppWidgetManager.getInstance(context).updateAppWidget(thisWidget,remoteViews);
            }

            private boolean isMyServiceRunning(Context context) {
                manager = (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);
                for (RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) {
                    if (UpdateService.class.getName().equals(service.service.getClassName())) {
                        return true;
                    }
                }
                return false;
            }

            public void getpMaxFreq(){
                int freq = 0;
                try{            
                    //HERE I DO SOME WORK               
                }
                catch (Exception e){e.printStackTrace();}
            }
        } 
```

PD：我也尝试将意图放入`onEnabled()`函数中，结果相同......在 Nexus One 2.3.6 Android 版本上不起作用

问候

# php - php投票系统——数据库问题

> ID：15101278
> 
> 赞同：0
> 
> 时间：2013-02-26T23:09:52.373
> 
> 标签：php, mysql

我正在尝试为我的网站制作投票系统。我不确定如何设置数据库表，以便 1 个用户可以喜欢或不喜欢某个帖子（他可以喜欢/不喜欢任何其他帖子（但只有一次 - 不能喜欢/不喜欢帖子）不止一次））。

我有一个用户表，其中“用户名”是主键。
然后我有带有以下列的帖子表：post_text、timestamp、post_id（这是主键）、user_name（FK 是用户表中的用户名）、类别、posvotes、negvotes
最后一个表是投票表：用户名（FK 是用户表中的用户名table), post_id (FK 是posts 表中的post_id), votedpos, votedneg。
我真的不确定该表是否设置正确以使其正常工作。

这是我的 php 代码：（这是一个较旧的代码，查询将更改为 mysqli 语句，所以不要介意已弃用的 mysql 语句）
$post_id 和 $user_name 工作正常，并且具有当前的用户名和 post_id。

```
$post_id = $_SESSION['post_id'];
$user_name = $_SESSION['user_name'];
if(mysql_query("SELECT * FROM posts WHERE post_id='".$post_id."' AND user_name='".$user_name."' AND(SELECT * FROM votes WHERE post_id='".$post_id."' AND votedpos=0)"))
{
$vote = "UPDATE posts SET posvotes=posvotes+1 WHERE post_id='".$post_id."'"; 
$runvote = mysql_query($vote) or die("error");
$safe = "UPDATE votes SET votedpos=1 WHERE post_id='".$post_id."'";
$runsafe = mysql_query($safe);
if(mysql_query("SELECT * FROM posts WHERE post_id='".$post_id."' AND user_name='".$user_name."' AND(SELECT * FROM votes WHERE votedpos>0 AND username='".$user_name."')"))      //if u +voted, then fail
{
    echo "cant vote twice";
}
else
{
    if(mysql_query("SELECT * FROM posts WHERE post_id='".$post_id."' AND user_name='".$user_name."' AND (SELECT * FROM votes WHERE negvotes>0 AND username='".$user_name."')"))     //if u negvoted previously, change your vote to plusvote
    {
        $vote = "UPDATE posts SET posvotes=posvotes+1 WHERE post_id='".$post_id."'"; 
        $runvote = mysql_query($vote);
        mysql_query("UPDATE posts SET negvotes=negvotes-1 WHERE post_id='".$post_id."'");
        mysql_query("UPDATE votes SET votedneg=0 WHERE post_id='".$post_id."'");
        $safe = "UPDATE votes SET votedpos=1 WHERE post_id='".$post_id."'";
        $runsafe = mysql_query($safe);
    }
}
} 
```

对于不喜欢一个帖子，我有相同的脚本（除了积极投票是消极投票的地方）。但我无法让这个工作，也不知道我的表设置是否错误或我的 php 编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:31:56.127

如果您更改投票表以使用用户名和 post_id 作为主键，并使用枚举（vote_up、neutral、vote_down）作为投票值，那么它似乎可以解决问题，而无需将逻辑推入 PHP 并轮询现有数据的状态.

# c - libjpeg API 和参考

> ID：15101281
> 
> 赞同：15
> 
> 时间：2013-02-26T23:09:59.027
> 
> 标签：c, libjpeg

我很难找到详细说明函数调用和返回值的 API……标头也不是很干净……

我找到了大量示例，但我对错误处理（返回值）感兴趣。我是不是在接近这个错误，因为我正在努力为这个众所周知的库找到像函数列表一样基本的东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-27T01:04:54.567

这个问题到现在已经 7 年了，这个`libjpeg`项目已经停滞不前了。但是，该`libjpeg-turbo`项目似乎是它的继任者，并且向后兼容旧的`libjpeg`API。

[libjpeg.txt](https://github.com/libjpeg-turbo/libjpeg-turbo/blob/master/libjpeg.txt)中有一些文档。libjpeg 是一个非常低级、学习曲线陡峭的老式 c 库。要有效地使用它，您需要熟悉 setjmp 和 longjmp、c 结构布局、函数指针以及许多其他低级 C 内容。使用它是一种负担，但可以以最少的资源使用量做很多事情。

文档不是那么好。我认为作者的意图是让任何使用这个库的人都能够阅读源代码并弄清楚这些东西是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:15:23.257

主要的 API 文件是`jpeglib.h`和`jerror.h`. 您也可以在标准 Android 发行版中找到这些文件。`jpeglib.h`包含所有数据结构，而`jerror.h`包含所有带有相应消息的错误代码。

# php - php simplexml asXML 返回包括。外部元素

> ID：15101282
> 
> 赞同：1
> 
> 时间：2013-02-26T23:10:00.493
> 
> 标签：php, xml, simplexml

我设法将一个表（4x4 字段，第一行中的链接）加载到 simplexml，在链接上我希望只返回链接的内部 html（粗体等），但它返回整个元素

```
 foreach($xml->tbody->children() as $tr){
  $row++;
  for ($i=0;$i<4;$i++)   {  
     $data[$row][$i]= $tr->td[$i]->asXML();   
     if($row==1)
     { $href[$i] = (string)$tr->td[$i]->a[0]['href'];
       $titl[$i] = $tr->td[$i]->a[0]->asXML(); // PROBLEMATIC POINT
     }
  }  

expected: 'link<b>text</b>'
returned: '<a href="....">link<b>text</b></a>'  /e.g. whole 'a' element/ 
```

如果我要添加 (string) 类型设置，我会失去链接的内部格式，
而上面**`$tr->td[$i]`**只返回元素 td 的内部内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:36:40.450

希望能帮助到你：

```
$titl[$i] = $tr->td[$i]->a[0]->children()->asXML(); 
```

# javascript - 根据其他选择值隐藏选择中的选项

> ID：15101286
> 
> 赞同：1
> 
> 时间：2013-02-26T23:10:27.153
> 
> 标签：javascript, select, hide, option

我有两个拼车网站的到达城市和出发城市的选择标签，我想防止用户在到达城市的选择中选择同一个城市，这里的出发城市的选择是一个例子：

```
 <select name="departure" size="1">
    <option value="1">NY</option>
    <option value="2">FL</option>
    <option value="3">LA</option>
  </select>

  <select name="arrival" size="1">
    <option value="1">NY</option>
    <option value="2">FL</option>
    <option value="3">LA</option>
  </select> 
```

我只是想防止用户使用 JavaScript 或任何其他解决方案在两个选择字段中选择同一个城市

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:22:56.243

对于一个简单的解决方案，我建议：

```
function deDupe(el) {
    var opt = el.selectedIndex,
        other = el.name == 'departure' ? document.getElementsByName('arrival')[0] : document.getElementsByName('departure')[0],
        options = other.getElementsByTagName('option');
    for (var i = 0, len = options.length; i < len; i++) {
        options[i].disabled = i == opt ? true : false;
    }
}

var departure = document.getElementsByName('departure')[0],
    arrival = document.getElementsByName('arrival')[0];

deDupe(document.getElementsByName('departure')[0]);

departure.onchange = function () {
    deDupe(departure);
};
arrival.onchange = function () {
    deDupe(arrival);
}; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/qE4fN/)。

参考：

*   [`document.getElementsByName()`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByName).
*   [`document.getElementsByTagName()`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByTagName).

# arrays - 需要添加代码以将空数组返回为 null

> ID：15101293
> 
> 赞同：0
> 
> 时间：2013-02-26T23:11:09.380
> 
> 标签：arrays, testing

如果数组列表为空，此代码将返回错误。我需要添加代码以避免错误，如果为空则返回 null。谢谢

```
public Comment findMostHelpfulComment()
{
    Iterator<Comment> it = comments.iterator();
    Comment best = it.next();
    while(it.hasNext()) 
    {
        Comment current = it.next();
        if(current.getVoteCount() > best.getVoteCount()) {
            best = current;
        }
    }

return best;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:14:24.947

```
public Comment findMostHelpfulComment()
{
    if (comments.isEmpty()) {
        return null;
    }

    // rest of method
} 
```

或者，`null`如果您稍微修改循环，您可以从最佳评论开始。

```
public Comment findMostHelpfulComment()
{
    Comment best = null;

    for (Comment current: comments) {
        if (best == null || current.getVoteCount() > best.getVoteCount()) {
            best = current;
        }
    }

    return best;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:17:43.993

```
public Comment findMostHelpfulComment()
{
    Iterator<Comment> it = comments.iterator();
    Comment best = new Comment();
    best.setVoteCount(0);
    while(it.hasNext()) 
    {
        Comment current = it.next();
        if(current.getVoteCount() > best.getVoteCount()) {
            best = current;
        }
    }
    return best;
} 
```

尝试这个。空数组不会有问题，但它会返回一个`Comment`设置`voteCount`为`0`;

# javascript - 从单选按钮传递变量

> ID：15101296
> 
> 赞同：1
> 
> 时间：2013-02-26T23:11:35.190
> 
> 标签：javascript, html, forms, radio-button

我试图将变量从单选按钮传递给 javascript 链接中的变量。我无法将变量“testVar”（在 for 循环中检查选中的单选按钮）传递给链接。我很难过，这是完整的代码：

```
 <form>
    <label>Priority 1</label>
    <input type="radio" id="priority" name="priorityN" onclick="getResults();" value="prior1"  />
    <label>Priority 2</label>
    <input type="radio" id="priority" name="priorityN" onclick="getResults();" value="prior2"  />
</form>

<br /><br />

<div id="myLink"></div>

<script>

var testVar = '';

function getResults() {
var radios = document.getElementsByName("priorityN");

for (var i = 0; i < radios.length; i++) {       
    if (radios[i].checked) {
        testVar = (radios[i].value);
    //  alert(radios[i].value);
        break;
    }
}
}

document.getElementById("myLink").innerHTML = '<a href=\"' + 'www.example.com?pri=' + testVar + '\" onclick=\"$(this).modal({width:880, height:460}).open(); return false;\" >' + 'My Modal Link' + "</a>";

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:23:23.477

`**[SEE LIVE DEMO](http://jsfiddle.net/MGud5/)**`

根据我的评论，您可以进行一些更改。

1.  `id`属性应该是唯一的。您可以使用类名而不是使用`id`.

    ```
    <form>
        <label>Priority 1</label>
        <input type="radio" class="priority" name="priorityN" onclick="getResults();" value="prior1" />
        <label>Priority 2</label>
        <input type="radio" class="priority" name="priorityN" onclick="getResults();" value="prior2" />
    </form> 
    ```

2.  如果您想在每次按下不同的单选按钮时重新生成链接，那么您需要将其移动到`getResults`函数内。否则将生成当前初始值为`testVar`空字符串。

    ```
    function getResults() {
        var testVar;
        var radios = document.getElementsByName("priorityN");
        for (var i = 0; i < radios.length; i++) {
            if (radios[i].checked) {
                testVar = (radios[i].value);
                document.getElementById("myLink").innerHTML = '<a href=\"' + 'www.example.com?pri=' + testVar + '\" onclick=\"$(this).modal({width:880, height:460}).open(); return false;\" >' + 'My Modal Link' + "</a>";
                break;
            }
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:20:02.580

您可以使用现代浏览器`querySelector`并忘记循环：

```
function getResults() {
  var checked = document.querySelector('[name="priorityN"]:checked'),
      link = document.querySelector('#myLink');
  link.innerHTML = '<a href="...'+ checked.value +'">...</a>';
} 
```

# jquery - 加载动态内容后执行功能

> ID：15101305
> 
> 赞同：1
> 
> 时间：2013-02-26T23:12:14.427
> 
> 标签：jquery, dynamic, event-handling

我有一张需要在其上执行功能的表。虽然它在搜索结果页面上，但在执行搜索（或加载另一页结果）后，div 内的内容会发生变化。不幸的是，我无法访问被调用来更改数据的 ajax 方法（它是一个在整个站点中全局使用的函数，无法更改到此页面）。

我想要做的是，每次 $("#search_results) div 更改时，我想循环遍历结果集，删除内联定义的 onclick 事件，并使用我自己的 onclick 函数。这是一个示例（这在第一次加载页面时有效，但在 ajax 调用更改搜索结果后无效）：

```
<script type='text/javascript'>

    $(document).live(function(){
        alert('fired'); 
        $('table.lookup_table tr').each(function(){
            $(this).removeAttr('onclick');      
        });
    });

$('table.lookup_table tr').on('click', function(event){
        event.preventDefault();
        $(this).removeAttr('onclick');  
        var pacware = $.trim($(':nth-child(1)', $(this)).html());
        var site = $.trim($(':nth-child(2)', $(this)).html());

        window.location = '<?php echo matry::here_to('edit');?>&pacware_code=' + pacware + '&site_id='+site;
        return false;
    });
</script> 
```

*另外，我需要这个在 IE 8 中工作 *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:22:00.880

你可以试试这个，但这不是好方法：

```
$('body').on('click', 'table.lookup_table tr', function(e){
        e.preventDefault();
        e.stopPropagation();
        //...
        return false;
    }); 
```

it will check, on each click, if you clicked an element which matches `table.lookup_table tr` and if so, execute the event handler.

# java - 想确保我得到的大 O 符号是正确的

> ID：15101313
> 
> 赞同：-4
> 
> 时间：2013-02-26T23:13:06.083
> 
> 标签：java

我已经编写了这段代码，但我必须找到大 O 表示法。我想出了 O(n2) 但我不确定它是否正确。请有人帮忙。谢谢

```
int n = array.length;

for(int i=0;i<array.length;i++){
  int c = 1;
  for(int j=i+1;j<array.length;j++)
    if (array[i]==array[j])
      c=c+1;
    if (c>(array.length/2)){
      return array[i];
    }
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:28:30.067

如果我们假设数组中没有 2 个相等的元素，它将等于最坏情况冒泡排序，它等于 O(N2)。[您可能会在wikibooks](http://en.wikibooks.org/wiki/Algorithm_implementation/Sorting/Bubble_sort)中看到示例排序

[并且还可以在此处](http://www.leepoint.net/notes-java/algorithms/big-oh/bigoh.html)找到有关冒泡排序成本的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:56:22.790

您是对的，这是一个 O(n^2) 操作，因为您执行的操作数量与输入数组中数据元素数量的平方成正比。

如果匹配数超过数组长度的一半，则您具有“救助”条件这一事实也不会改变操作的基数，它仍然是 N 平方操作，因为这是函数的限制行为。

验证这一点的一种方法是通过蒙特卡罗模拟：

1.  从 N=2 开始，增加到 N= 说 100
2.  在内部循环中添加第二个计数器，让您知道您点击内部代码块的次数
3.  创建一个长度为 N 且只有二进制 (1/0) 值的随机数组
4.  运行你的函数并记录你点击内循环的次数
5.  对于 N 的每个选择，运行模拟 100 次，然后对每个 N 选择的结果取平均值
6.  在对数尺度上绘制平均迭代次数与 N 的关系。
7.  对数对数图上斜率为 2 的最佳拟合线表示操作为 O(N^2)。斜率为 1 意味着它是 O(N)。斜率为 3 表示 O(N^3)。

# c# - 将两个列表转换为字典

> ID：15101322
> 
> 赞同：2
> 
> 时间：2013-02-26T23:14:17.103
> 
> 标签：c#, linq

我正在寻找一个 LINQ 函数，它可以在这里替换我的两个循环以产生类似的结果：

```
public class Outer {
    public long Id { get; set; }
}

public class Inner {
    public long Id { get; set; }
    public long OuterId { get; set; }
}

var outers = new List<Outer>();
var inners = new List<Inner>();
// add some of each object type to the two lists

// I'd like to replace this code with a LINQ-style approach
var map = new Dictionary<long, long>();
foreach (Outer outer in outers) {
    foreach (Inner inner in inners.Where(m => m.OuterId == outer.Id)) {
        map.Add(inner.Id, outer.Id);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:22:35.920

```
var map = inners
          .ToDictionary(a => a.Id, 
                        a => outers
                             .Where(b => b.Id == a.OuterId)
                             .Select(b => b.Id)
                             .First()
                        ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T23:21:52.143

查看 Enumerable.Join 和 Enumerable.ToDictionary。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:25:58.830

以下应该可以工作（现在编写测试用例）：

```
var map = inners.Join(outers, x => x.OuterId, x => x.Id, (inner, outter) => new
    {
        InnerId = inner.Id,
        OuterId = outter.Id
    }).ToDictionary(x => x.InnerId, x => x.OuterId); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T23:26:31.873

```
var dict = (for outer in outers
            join inner in inners
            on outer.Id equals inner.OuterId
            select new KeyValuePair<long,long>(inner.Id, outer.Id)).ToDictionary(k => k.Key, v => v.Value); 
```

# c# - EF5.x 添加自定义属性

> ID：15101331
> 
> 赞同：0
> 
> 时间：2013-02-26T23:15:03.290
> 
> 标签：c#, entity-framework, c#-4.0, entity-framework-5

我正在使用 EF5.x 代码优先

```
namespace DAO.Models
{
    public partial class Person
    {
        public int UserId { get; set; }
}
} 
```

我创建了另一个部分类来添加自定义属性。

```
namespace DAO.Models
{
    public partial class Person
    {
        public string customName { get; set; }
}
} 
```

我有一个由 EF 5.x 电动工具为我生成的映射

```
 public PersonMap()
    {
        // Primary Key
        this.HasKey(t => new { t.PersonId });

        // Table & Column Mappings
        this.ToTable("Person", "TableX");
        this.Property(t => t.PersonId).HasColumnName("PersonId");

    } 
```

当我尝试将新人添加到数据库时

```
 XContext db = new XContext();

                Person per= new Person();
   db.Persons.Add(per); 
```

**我在字段列表错误中收到未知列 customName**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:22:10.313

您可以使用[[NotMapped]](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.notmappedattribute.aspx)注释/属性

```
[NotMapped]
public string customName { get; set; } 
```

# python - Python If 语句的问题

> ID：15101332
> 
> 赞同：0
> 
> 时间：2013-02-26T23:15:09.383
> 
> 标签：python, python-2.7, python-3.x

我正在上一堂课，但我被困住了。由于我是 Python 新手，因此很难弄清楚我哪里出错了。

```
#Write your two "if" statements below!

def true_function():
    if                #Fill in your `if` statement here!
        return        #Make sure this function returns `True`

def false_function():
    if                #Fill in your `if` statement here!
        return        #Make sure this function returns `False` 
```

这是我提出的解决方案，它给了我一个错误；

```
#Write your two "if" statements below!

    def true_function():
        if  2 + 2 == 4:           #Fill in your `if` statement here!
            return 'True'   #Make sure this function returns `True`

    def false_function():
        if  2 + 2 == 5:           #Fill in your `if` statement here!
            return 'False' #Make sure this function returns `False` 
```

有人可以帮助我了解我哪里出错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:17:41.760

`True`和`False`是对象（或变量，或常量，或软关键字，或任何你想调用它们）。它们不是字符串。

```
return True 
```

您的第二个函数也使用了错误条件，因此该`if`块的内容将永远不会运行。它会从末端掉落并返回`None`。

# python - 有没有办法一次监听多个 python 套接字

> ID：15101333
> 
> 赞同：10
> 
> 时间：2013-02-26T23:15:11.480
> 
> 标签：python, sockets

我可以一次听多个套接字吗

我现在用来监控套接字的代码是：

```
while True:
    for sock in socks:
        data, addr = sock.recvfrom(1024) # buffer size is 1024 bytes
        print "received message:", data 
```

但这在线上等待：

```
data, addr = sock.recvfrom(1024) # buffer size is 1024 bytes 
```

直到收到消息。

有没有办法让它一次监听多个套接字

编辑：不确定它是否完全相关，但我使用的是 UDP

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-26T23:33:53.560

就在这里。您需要使用非阻塞调用从套接字接收。查看[选择模块](http://docs.python.org/2/library/select.html)

如果您正在从套接字读取，那么您是如何使用它的：

```
while True:
    # this will block until at least one socket is ready
    ready_socks,_,_ = select.select(socks, [], []) 
    for sock in ready_socks:
        data, addr = sock.recvfrom(1024) # This is will not block
        print "received message:", data 
```

注意：您还可以传递一个额外的参数，`select.select()`该参数是超时。如果没有套接字准备好，这将防止它永远阻塞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-10T15:27:36.363

[对entropy](https://stackoverflow.com/users/414304/entropy)对 Python 3 的回答的轻微更新：该`selectors`模块允许高级和高效的 I/O 多路复用，建立在选择模块原语的基础上。鼓励用户改用这个模块，除非他们想要精确控制所使用的操作系统级原语。根据[文档](https://docs.python.org/3.8/library/selectors.html#module-selectors)

# java - JVM 能否优化数组的多次读取

> ID：15101334
> 
> 赞同：2
> 
> 时间：2013-02-26T23:15:15.453
> 
> 标签：java, jvm, java-memory-model

多次读取同一个索引时，JVM可以优化数组读取吗？考虑以下：

```
public static void foo(int[] array) {
   for (int i=0; i<array.length; i++) {
       int value1 = array[i];
       ...
       int value2 = array[i];
       ...
    }
    ...
} 
```

`array[i]`在循环中被读取两次。假设`array[i]`没有在循环中重新分配，是否允许 JVM 假设它`array[i]`没有改变并因此只读取它的值一次？由于`array`是传入的可变对象，因此可以想象它在第一次和第二次读取之间发生了变化。

我查看了生成的字节码，它确实读`array[i]`了两次（`daload`）。JVM 是否允许将其优化为一次读取？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:22:15.867

是的，优化器只考虑单线程数据流，它不关心变量是否被另一个线程更改，除非涉及到 volatile/synchronized。

即使没有优化，第二次读取也应该很快，大约 1ns，因为数据很可能在 L1 缓存中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:22:19.103

我不认为 JVM 会优化这个读取，但是`daload`操作的开销应该是微不足道的。

如果您只想从数组中读取一次值，请尝试分配给局部变量（花费一些微不足道的局部变量堆栈内存）

```
int origVal = array[i];
int value1 = origVal;
...
int value2 = origVal; 
```

测试应证明更改是任意的。

# javascript - 如何获取触发弹出窗口的 javascript 代码？

> ID：15101338
> 
> 赞同：1
> 
> 时间：2013-02-26T23:15:40.463
> 
> 标签：javascript, jquery-ui, jquery, javascript-events

我正在尝试为我的项目实现一个模式弹出窗口，我在 jsfiddle 中找到了我想要的。我可以找出他们用于模态的 html 和 css 是什么，但我不知道他们使用的是什么 js？

你能告诉我他们在模态中使用什么 javascript 吗？那就是当我单击登录按钮时，模式弹出窗口打开

[http://jsfiddle.net/VSsLC/](http://jsfiddle.net/VSsLC/)

[http://jsfiddle.net/VSsLC/embedded/result/](http://jsfiddle.net/VSsLC/embedded/result/)

这是下面的html代码

```
<div class="modal hide fade" id="login-modal" style="display: none;">
    <a class="close" data-dismiss="modal">×</a>
    <h1>Log in to Kippt</h1>

    <form class="connect-button" name="login" method="post" action="/social/twitter/redirect/" id="twitter-connect-form">
    <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken" value="MNH48hjwVMrGUWcpNqIt4qa1nko6RWdo"></div>

    <a href="#" onclick="$('#twitter-connect-form').submit(); return false;" class="signup-twitter signup-btn" id="twitter_button"><i></i>Log in with Twitter</a>
    </form>
    <form class="connect-button" name="login" method="post" action="/social/facebook/redirect/" id="facebook-connect-form">
      <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken" value="MNH48hjwVMrGUWcpNqIt4qa1nko6RWdo"></div>

      <a href="#" onclick="$('#facebook-connect-form').submit(); return false;" class="signup-facebook signup-btn" id="facebook_button"><i></i>Log in  with Facebook</a>
      </form>

      <form action="/login" method="POST" autocomplete="off"><div style="display:none"><input type="hidden" name="csrfmiddlewaretoken" value="MNH48hjwVMrGUWcpNqIt4qa1nko6RWdo"></div>

        <fieldset>
            <h5>or with Kippt account</h5>
            <input type="text" placeholder="Username or email" name="username" maxlength="30" id="id_username">
            <input type="password" placeholder="Password" name="password" id="id_password">
            <input type="submit" value="Log in" class="btn">
        </fieldset>
         <a href="/accounts/password/reset/"><span>Forgot password?</span></a> · <a href="/signup/"><span>Sign up to Kippt</span></a>
     </form>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:35:22.053

您可以将直接链接发布到[https://kippt.com/](https://kippt.com/)网站，询问他们如何创建注册表单。
很明显，他们的 Javascript 过于模糊，无法理解任何有用的东西，但我确实看到他们使用**jQuery**。通过做一个小的google搜索，我发现有一个非常相似的效果库，叫做**bootstrap modal**。
您必须考虑他们使用 jQuery 为自己编写此效果的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:39:39.543

你的问题不是很清楚，但如果我很好理解，你正在寻找 js 文件。因此，您可以使用大量开发人员工具（chrome、firefox、safari）访问任何浏览器。例如，在 Chrome 中，进入开发者工具，显示控制台（在 mac 上为 cmd+option+i），进入 resssources/Frames/Scripts，您会找到 js 文件

# bash - 使用 bc 或其他标准实用程序的任意数量的数字的标准偏差

> ID：15101343
> 
> 赞同：11
> 
> 时间：2013-02-26T23:16:01.070
> 
> 标签：bash, variables, standard-deviation

是否有一些技巧可以让人们使用 bc （或其他一些标准实用程序）返回任意数量的数字的标准偏差？为方便起见，假设这些数字按以下方式存储在 Bash 变量中：

```
myNumbers="0.556
1.456
45.111
7.812
5.001" 
```

因此，我正在寻找的答案将采用如下形式：

```
standardDeviation="$(echo "${myNumbers}" | <insert magic here>)" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-26T23:22:24.200

使用[awk](/questions/tagged/awk "显示标记为“awk”的问题")：

```
standardDeviation=$(
    echo "$myNumbers" |
        awk '{sum+=$1; sumsq+=$1*$1}END{print sqrt(sumsq/NR - (sum/NR)**2)}'
)
echo $standardDeviation 
```

使用[perl](/questions/tagged/perl "显示标记为“perl”的问题")：

```
#!/usr/bin/env perl

use strict; use warnings;
use Math::NumberCruncher;

my @data = qw/
    0.556
    1.456
    45.111
    7.812
    5.001
/;

print Math::NumberCruncher::StandardDeviation(\@data); 
```

## 输出

```
16.7631 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-17T10:42:25.263

总体标准差：

```
jq -s '(add/length)as$a|map(pow(.-$a;2))|add/length|sqrt'
ruby -e'a=readlines.map(&:to_f);puts (a.map{|x|(x-a.reduce(:+)/a.length)**2}.reduce(:+)/a.length)**0.5'
jq -s '(map(.*.)|add/length)-pow(add/length;2)|sqrt'
awk '{x+=$0;y+=$0^2}END{print sqrt(y/NR-(x/NR)^2)}' 
```

在`awk`,`^`在 POSIX 中但`**`不是。`**`支持`gawk`并且`nawk`不支持`mawk`。

样本标准偏差（前两个命令与上面的前两个命令相同，但`length`被替换为`length-1`）：

```
jq -s '(add/length)as$a|map(pow(.-$a;2))|add/(length-1)|sqrt'
ruby -e'a=readlines.map(&:to_f);puts (a.map{|x|(x-a.reduce(:+)/a.length)**2}.reduce(:+)/(a.length-1))**0.5'
R -q -e 'sd(scan("stdin"))' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-05T06:18:44.790

或者使用 GNU Octave（它可以比简单的 std 更多）：

```
standardDeviation="$(echo "${myNumbers}" | octave --eval 'disp(std(scanf("%f")))')"
echo $standardDeviation 
```

输出

```
18.742 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-01T19:00:22.427

鉴于：

```
$ myNumbers=$(echo "0.556 1.456 45.111 7.812 5.001" | tr " " "\n") 
```

首先确定您是否需要这些数字的[样本标准差](https://en.wikipedia.org/wiki/Standard_deviation#Sample_standard_deviation_of_metabolic_rate_of_Northern_Fulmars)与[总体标准差](https://en.wikipedia.org/wiki/Standard_deviation#Population_standard_deviation_of_grades_of_eight_students)。

总体标准差（Excel 中的函数[STDEV.P](https://support.office.com/en-us/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285)）需要整个数据总体。在 Excel 中，会跳过文本或空白。

它很容易在滚动基础上计算`awk`：

```
$ echo "$myNumbers" | awk '$1+0==$1 {sum+=$1; sumsq+=$1*$1; cnt++}
                           END{print sumsq/cnt; print sqrt(sumsq/cnt - (sum/cnt)**2)}'
16.7631 
```

或在`Ruby`：

```
$ echo "$myNumbers" | ruby -e 'arr=$<.read.split(/\s/).map { |e| Float(e) rescue nil }.compact
                             sumsq=arr.inject(0) { |acc, e| acc+=e*e }
                             p (sumsq/arr.length - (arr.sum/arr.length)**2)**0.5'
16.76307799182477 
```

对于样本标准偏差（Excel 中的函数[STDEV.S](https://support.office.com/en-us/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23)并忽略文本或空白）您需要首先收集整个样本，因为平均值用于样本中的每个值。

在`awk`：

```
$ echo "$myNumbers" | 
     awk 'function sdev(array) {
     for (i=1; i in array; i++)
        sum+=array[i]
     cnt=i-1
     mean=sum/cnt
     for (i=1; i in array; i++)  
        sqdif+=(array[i]-mean)**2
     return (sqdif/(cnt-1))**0.5
     }
     $1+0==$1 {sum1[++cnt]=$1} 
     END {print sdev(sum1)}' 
18.7417 
```

或者在 Ruby 中：

```
$ ruby -lane 'BEGIN{col1=[]}
            col1 << Float($F[0]) rescue nil
            END {col1.compact
                 mean=col1.sum / col1.length
                 p (col1.inject(0){ |acc, e| acc+(e-mean)**2 } / 
                        (col1.length-1))**0.5
              }' <(echo "$myNumbers")
18.741690950925424 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-16T11:51:44.947

只是为了好玩，8 年后，使用**gnuplot**：

```
echo "${myNumbers}" | gnuplot -e 'stats "-" nooutput; print STATS_stddev'
16.7630779918248 
```

作为解释，我让**gnuplot**对其上的数据运行`stats`函数`stdin`，抑制正常输出并仅打印标准偏差。

* * *

相关，但不是答案的真正部分......您还可以生成许多其他统计数据，如中位数、峰度和偏斜、四分位数、最大值、最小值，如下所示：

```
echo "${myNumbers}" | gnuplot -e 'stats "-"' 
```

**样本输出**

```
* FILE: 
  Records:           5
  Out of range:      0
  Invalid:           0
  Header records:    0
  Blank:             0
  Data Blocks:       1

* COLUMN: 
  Mean:              11.9872
  Std Dev:           16.7631
  Sample StdDev:     18.7417
  Skewness:           1.4125
  Kurtosis:           3.1303
  Avg Dev:           13.2495
  Sum:               59.9360
  Sum Sq.:         2123.4687

  Mean Err.:          7.4967
  Std Dev Err.:       5.3010
  Skewness Err.:      1.0954
  Kurtosis Err.:      2.1909

  Minimum:            0.5560 [0]
  Maximum:           45.1110 [2]
  Quartile:           1.4560 
  Median:             5.0010 
  Quartile:           7.8120 
```

# matlab - 情节和子情节

> ID：15101348
> 
> 赞同：0
> 
> 时间：2013-02-26T23:16:25.607
> 
> 标签：matlab, plot, subplot

我有一个很大的 for 循环，可以生成很多图表。我正在向代码添加功能，并希望可以选择在将一系列图形放入带有子图的一个图形中或将图形绘制为单个图形之间切换。我尝试使用以下代码执行此操作，但它不起作用。

```
 figure
 if (SubplotOPT == 0)
  subplot(2,2,1);
 end 
```

这个想法是，如果不满足 SubplotOPT == 0 则代码将生成一个单独的图形，但是，我认为 matlab 正在制作一个子图，而不管 if 语句如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:09:25.437

我对之前的两个解决方案都不满意，所以这是我的尝试：

```
% Should we add a subplot, or create a new figure & axes 
if (SubplotOpt == 0)
  ax = subplot(2,1,1);
else
  f = figure;
  ax = axes();
end

plot( 0:.01:2*pi, sin(0:.01:2*pi), 'Parent', ax); 
```

基本上我已经从绘图代码中抽象出子图/图形代码，它使阅读和编辑更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:27:59.963

尝试这个：

```
for i=1:3
figure(i)   
    if i==3
        subplot(2,1,1)
           plot(rand(1,100))
    else
           plot(rand(1,100))
    end
end 
```

这里在循环中创建了一个常规图形，其中仅针对特定条件创建了一个子图图形。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:28:39.793

```
if (SubplotOPT == 0)
    subplot(2,2,1);
else
    subplot(1,1,1);
end 
```

# php - 使用 javascript 链接的哈希链接问题

> ID：15101349
> 
> 赞同：0
> 
> 时间：2013-02-26T23:16:29.340
> 
> 标签：php, javascript, drop-down-menu, hash, menu

所以我的网站在标题中有下拉菜单，链接到不同页面的子页面。像主按钮链接`about.php`和悬停菜单链接`about.php#contacts`等......

现在，在这些子页面中的每一个页面上，它们不是单独的页面，而是使用 javascript 函数打开/关闭以修改显示 css 值。

因此，如果我在索引上，然后单击`about.php#contacts`，则可以很好地显示联系人内容。但是，如果我在 about 页面上，任何带有指向 about 页面的哈希链接都不起作用。对于其他页面，它会起作用，但如果哈希链接指向当前页面，它就不起作用。在地址栏中，网址发生了变化，但我猜页面或脚本需要强制重新加载以显示新内容。

这是我正在使用的相关代码，有没有更好的方法来完成我想要做的事情？

```
//Drop down
<ul><li><a href="about.php">About Us</a>
<ul><li><a href="about.php#profile">contacts</a></li>
//More..
</ul></li></ul>

//Menu on  the page
<ul>
<li><a href="javascript:showlayer('contacts');"><span>Contacts</span></a></li>
//More
</ul>

//Javascript code that handles everything
<script language="javascript">
var hash = window.location.hash;
var selectedDiv = hash.split('#')[1];
if(selectedDiv != null)
{
    showlayer(selectedDiv);
}
function showlayer(name){
    document.getElementById("contacts").style.display = "none";
    //More
    document.getElementById(name).style.display = "block";  
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:18:26.860

单击指向具有不同哈希值的当前页面的链接不会重新加载该页面。

相反，您需要向`hashchange`事件添加一个处理程序并在那里运行您的代码。

更好的是，用 CSS 选择器完全替换您的代码`:target`。

# ios - AFNetworking 嵌套参数请求

> ID：15101350
> 
> 赞同：0
> 
> 时间：2013-02-26T23:16:36.747
> 
> 标签：ios, objective-c, api, afnetworking

我有一个生成位置的 rails api，以及这些位置的菜单。在我的 iOS 应用程序中，我使用 AFNetworking 在表格视图中检索这些位置的 json 列表。

这是我用来获取位置数据的 AFNetworking 请求

位置表视图控制器.m

```
[[LocationApiClient sharedInstance] getPath:@"locations.json" parameters:nil
                                        success:^(AFHTTPRequestOperation *operation, id response) {
                                            NSLog(@"Response: %@", response);
                                            NSMutableArray *results = [NSMutableArray array];
                                            for (id locationDictionary in response) {
                                                Location *location = [[Location alloc] initWithDictionary:locationDictionary];
                                                [results addObject:location];

                                            }
                                            self.results = results;
                                            [self.tableView reloadData];
                                        }
                                        failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                                            NSLog(@"Error fetching locations!");
                                            NSLog(@"%@", error);

                                        }]; 
```

为位置请求返回的 json 示例

```
 {
    "created_at" = "2013-02-23T19:25:26Z";
    id = 2;
    lat = "48.870175";
    long = "2.779899999999998";
    name = "Disneyland Hotel";
    "places_id" = fd90769e2cf40d6cb6cb1a3d0bfd0ce5d37ed331;
    "street_address" = "Rue de la Marni\U00e8re, Chessy, France";
    "updated_at" = "2013-02-23T19:25:26Z";
}, 
```

显示姓名和地址

![在此处输入图像描述](../Images/e01ef94b3808055076198dc0d78cff97.png)

当用户点击位置单元格时，我想显示该位置啤酒列表的表格视图。rails api 路由（对于 location_id => 1）是`http://localhost:3000/locations/1/beers.json`并为属于 location_id:1 的啤酒输出以下 json

```
 {
"created_at":"2013-02-23T19:25:53Z",
"description":"fkjgvjkg",
"id":1,"location_id":1,
"name":"nhoihioh",
"price":"2.5","style":"ipa",
"updated_at":"2013-02-23T19:25:53Z"
    } 
```

当用户点击位置单元格时，我想显示该位置的啤酒列表，通过`http://localhost:3000/locations/(whatever location_id is associated with the table cell that was tapped)/beers.json`

当用户点击位置单元格时，如何将 location_id 插入到下一个表视图中发生的以下 AFNetworking 请求中？

BeerTableViewController.m

```
[[LocationApiClient sharedInstance] getPath:@"locations/**(location_id from location table cell inserted here)**/beers.json" parameters:nil
                                        success:^(AFHTTPRequestOperation *operation, id response) {
                                            NSLog(@"Response: %@", response);
                                            NSMutableArray *results = [NSMutableArray array];
                                            for (id beerDictionary in response) {
                                                Beer *beer = [[Beer alloc] initWithDictionary:beerDictionary];
                                                [results addObject:beer];

                                            }
                                            self.results = results;
                                            [self.tableView reloadData];
                                        }
                                        failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                                            NSLog(@"Error fetching beers!");
                                            NSLog(@"%@", error);

                                        }]; 
```

我假设我必须记录 location_id 并在点击表格单元格时将该值作为 url 的参数传递，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T16:40:41.313

当您使用 JSON 时，您可能应该使用 AFJSONRequestOperation，因为它会将响应数据解析为字典。

```
AFJSONRequestOperation JSONRequestOperationWithRequest:request
                                                           success:^(NSURLRequest *request, NSHTTPURLResponse *response, id locationJSON) {

....

}; 
```

然后，您可以从字典中获取 places_id 并再次调用以获取啤酒信息。

# java - Java SSL/TLS 客户端使用在运行时加载的自签名证书连接和验证服务器？

> ID：15101352
> 
> 赞同：4
> 
> 时间：2013-02-26T23:16:38.573
> 
> 标签：java, ssl, client

事实证明，对于这个特定问题，搜索互联网过于复杂。也许你能指出我正确的方向？

我已经设置了一个带有自签名证书的 SSL/TLS 服务器（不是 HTTPS）。我已成功连接到它并使用 Node.JS 进行了测试

```
var sock = tls.connect({
  host:'127.0.0.1',
  port:443,
  servername:'foobar',
  ca: fs.readFileSync('foobar-cert.pem')
}, function () {
  if(sock.authorized)
    console.log('secure connection - yea!')
  else
    console.log('Not Secure because ' + sock.authorizationError)
}) 
```

但我似乎无法在 Java 中找到等效的示例代码。

如何使用自签名证书文件连接到 Java 中的 TLS 服务器以进行服务器身份验证？自签名证书将在运行时加载，而不是安装到计算机的共享 CA 文件中。

[到目前为止，我找到](http://juliusdavies.ca/commons-ssl/ssl.html)的最佳答案需要一个外部库。这是我最后的手段，因为我确信 Java 会内置我需要的东西，而且我根本不需要外部库。

**编辑：**感谢您对重新打开问题的快速回复。

 ~~~~> **编辑：**我看到我的问题已关闭，因为重复[告诉 java 接受自签名 ssl 证书](https://stackoverflow.com/questions/2893819/telling-java-to-accept-self-signed-ssl-certificate)。这是不正确的，因为我的问题有额外的要求，我在上面说过：
> 
> *   建议：*“证书...将其导入您的 JVM 信任库”*
>     我的要求*“自签名证书...未安装到计算机的共享 CA 文件中”*
>     
>     
> *   建议：*“禁用证书验证”*（不推荐）
>     我的要求*“将在运行时加载自签名证书”* （并用于服务器验证）
>     
>     
> *   建议：*“使用密钥工具将其导入您的信任库”*
>     我的要求*“自签名证书......未安装到计算机的共享 CA 文件中”*~~  ~~* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T02:49:32.807

不久前我写了[一篇博](http://chariotsolutions.com/blog/post/https-with-client-certificates-on/)文，展示了如何在 Android 上执行此操作（包括在运行时读取证书），但相同的代码应该可以在桌面上运行。

基本思想是在运行时创建一个信任库，读取证书，并将其添加到信任库中。然后使用自定义信任库创建可与 SSLSocketFactory 一起使用的 SSLContext。

博客文章中的示例将 SSLSocketFactory 传递给 URLConnection，但您可以使用 SSLSocketFactory 的`createSocket`方法获取套接字并直接使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:01:13.643

您可能会在这个巨大的文档中的某个地方找到答案：

[http://download.java.net/jdk8/docs/technotes/guides/security/jsse/JSSERefGuide.html](http://download.java.net/jdk8/docs/technotes/guides/security/jsse/JSSERefGuide.html)

基本上，使用 SSLSocket 作为初学者。但我认为您不能在运行时添加证书。~~~~

# javascript - 在Javascript中将函数分配给变量并将变量分配给函数（？）

> ID：15101357
> 
> 赞同：2
> 
> 时间：2013-02-26T23:17:07.950
> 
> 标签：javascript, function, var

我通过剖析我以前使用过的其他人编写的一些脚本来学习 javascript（stackoverflow 对此至关重要！）。这段代码（我从中间删减了很多，以使代码更易于阅读，所有注释都是我的）来自[fullCalendar.js](http://arshaw.com/fullcalendar/)，一个 jquery 插件。

我不确定作者在这里做什么：

```
function EventManager(options, _sources) { //called using .call()
    var t = this;

    t.isFetchNeeded = isFetchNeeded;  //?? assign the function "isFetchNeeded" to the variable (not the value returned by the function)??

    var trigger = t.trigger;    //?? namespace??
}

function View(element, calendar, viewName) {
    var t = this;   

    function trigger(name, thisObj) {
        return calendar.trigger.apply(
                 calendar,
                 [name, thisObj || t].concat(Array.prototype.slice.call(arguments, 2), [t])
        );
    }
} 
```

首先，我的猜测是`this.foo=bar`将函数“bar”分配给当前对象中名为“isFetchNeeded”的变量（还不知道为什么要这样做。速度？）。

其次，这条线`var foo=this.bar`把我难住了。看起来它可能是一些命名空间的魔法。

我对第一行的思考是否正确？下一行在做什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:40:39.100

`this.foo = bar`将`bar`（无论它可能是）的值分配给名为 的对象的成员`foo`。这确实可以是一个函数定义以及许多其他东西。

什么`var trigger = t.trigger`是声明一个在函数`trigger`范围内命名的变量。`EventManager`在较低范围内定义了其他函数，即`pushLoading`和`popLoading`。这些不是对象成员，因此`this.trigger`在这些函数内部使用是行不通的。该`var trigger`声明使其可以在这些函数中访问。

我并没有声称自己是有史以来最好的 JS 程序员，所以我不能说他的所作所为是否有意义，但你可以看到`EventManager.js`实际使用的方式（在 中`Calendar.js`）：

```
EventManager.call(t, options, eventSources);
var isFetchNeeded = t.isFetchNeeded;
var fetchEvents = t.fetchEvents; 
```

他实际上并没有创建一个`EventManager`对象，但是他用这个`Calendar`对象调用了它的构造函数。 `Calender` *确实*已`trigger`定义，这就是为什么`var trigger = t.trigger`在`EventManager`. 同样，该行

```
var isFetchNeeded = t.isFetchNeeded; 
```

In`Calendar.js`获取`isFetchNeeded`方法“退出”`EventManager`并允许在`Calendar`范围内调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:29:31.507

变量`this`引用调用函数的上下文。在这种情况下（假设代码在 Web 浏览器中运行）是`window`对象。第一行简单地将函数分配为对象`isFetchNeeded`的方法。`this`第二行将`this`'s 成员变量的值分配`trigger`给函数的局部变量`EventManager`。

# mysql - 加入后 SUM 不正确

> ID：15101360
> 
> 赞同：1
> 
> 时间：2013-02-26T23:17:17.940
> 
> 标签：mysql, sql

我试图以三种不同的方式从一列中获取数据。我正在处理供应商报价和客户接受的报价（然后成为项目）。

我想从他们所有的项目中获得总节省额，无论是否完成。其次，我们正在抓住当前的储蓄，即当前开放项目的储蓄。最后，我需要找出提供给他们*但他们尚未采取行动*的总金额。

我已经处理了这个查询的前两个：

```
SELECT SUM(osh.Savings) as YTD,
       SUM(case when p.current_status < 3 then Savings end) AS "Open Savings"
FROM OfferSuggestionHeader osh LEFT JOIN
     Projects p
     ON p.offer_id = osh.OfferID
WHERE p.uid = '1' 
```

到现在为止还挺好。当我开始加入必要的表格以抓住最后一块时，问题就出现了。这是*单数*查询的样子（并且有效）：

```
SELECT SUM(ofh.Savings)
from OfferSuggestionHeader ofh
LEFT JOIN OfferSuggestionDetail osd
on ofh.OfferID = osd.OfferID
LEFT JOIN Facilities f
on osd.FacilityID = f.id
LEFT JOIN UserFacility uf
on f.id = uf.fid
LEFT JOIN Users u
on uf.uid = u.uid
WHERE u.uid = 1
AND ofh.OfferID NOT IN(SELECT offer_id FROM Projects WHERE uid = 1) 
```

我尝试了六种不同的混合方式，但都以失败告终。似乎它正在多次将数字相加或类似的东西。

感谢您的任何帮助或指点。

**编辑： - - - - - - - -**

因此，这是一个查询，它执行必要的连接以尝试在保持`CASE`语句存在的同时获得这么大的总数：

```
SELECT (osh.Savings) as "Potential", 
    (case when p.current_status < 3 then osh.Savings else null end) AS "Open Savings",
    (case when p.uid=1 then osh.Savings else null end) AS "YTD"
FROM OfferSuggestionHeader osh
LEFT JOIN OfferSuggestionDetail osd
    ON osd.OfferID = osh.OfferID
LEFT JOIN UserFacility uf
    ON uf.fid = osd.FacilityID
LEFT JOIN Projects p
    ON p.uid = uf.uid
WHERE p.uid = '1' 
```

我已经删除了这一`SUM`部分，看看会发生什么，正如你们中的一些人所建议的那样。果然，我得到了每个值的三个记录。

![在此处输入图像描述](../Images/3238b21758d0dff2cdc1522afe4a477e.png)

这是否有助于更好地澄清问题？

**编辑#2：------------** 根据要求，这里是单独的工作查询：

年初至今：

```
/*YTD Savings*/
SELECT SUM(osh.Savings) as YTD
FROM Projects p
LEFT JOIN OfferSuggestionHeader osh
    ON p.offer_id = osh.OfferID
WHERE p.uid = 1 
```

当前活动/打开：

```
/*total from open projects*/
SELECT SUM(osh.Savings) as TotalOpen
FROM Projects p
LEFT JOIN OfferSuggestionHeader osh
    ON p.offer_id = osh.OfferID
WHERE p.uid = 1 AND p.current_status < 3 
```

最后，潜在节省的总和：

```
/*POTENTIAL*/
SELECT SUM(ofh.Savings) as Potential
from OfferSuggestionHeader ofh
LEFT JOIN OfferSuggestionDetail osd
on ofh.OfferID = osd.OfferID
LEFT JOIN Facilities f
on osd.FacilityID = f.id
LEFT JOIN UserFacility uf
on f.id = uf.fid
LEFT JOIN Users u
on uf.uid = u.uid
WHERE u.uid = 1
AND ofh.OfferID NOT IN(SELECT offer_id FROM Projects WHERE uid = 1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T03:52:49.730

Shibormot 可能是正确的，您的 OfferSuggestionDetail 在 OfferSuggestionHeader 中的每一行都有多行。当您加入它们时，加入的每一行的 ofh.savings 字段都是相同的。然后，当你总结时，它会乘以细节行的数量。

-- 编辑为使用您的三个单独的查询：如果您采用查询 2，则可以这样重写：当前活动/打开：

```
SELECT SUM(CASE WHEN p.current_status < 3 osh.Savings ELSE 0 END ) as TotalOpen
FROM Projects p
LEFT JOIN OfferSuggestionHeader osh
    ON p.offer_id = osh.OfferID
WHERE p.uid = 1 
```

确认它给了你你想要的。如果是这样，它现在具有与查询 2 相同的 FROM 子句和相同的 WHERE 子句，因此它们可以这样组合：

```
SELECT SUM(osh.Savings) as YTD
      ,SUM(CASE WHEN p.current_status < 3 osh.Savings ELSE 0 END ) as TotalOpen
FROM Projects p
LEFT JOIN OfferSuggestionHeader osh
    ON p.offer_id = osh.OfferID
WHERE p.uid = 1 
```

MySql 支持选择列表中的列，该列*本身就是*一个 SELECT。

如果我将您的第三个查询滑入上面的组合查询中，我会得到这个：（可能可以稍微清理一下内部查询，但它应该可以工作。）

```
SELECT SUM(osh.Savings) as YTD
      ,SUM(CASE WHEN p.current_status < 3 osh.Savings ELSE 0 END ) as TotalOpen

, (SELECT SUM(ofh2.Savings) as Potential
   from OfferSuggestionHeader ofh2
   LEFT JOIN OfferSuggestionDetail osd2 on ofh2.OfferID = osd2.OfferID
   LEFT JOIN Facilities f2 on osd2.FacilityID = f2.id
   LEFT JOIN UserFacility uf2 on f2.id = uf2.fid
   LEFT JOIN Users u on uf2.uid = u2.uid
   WHERE ofh.OfferID = ofh2.OfferID 
   AND u2.uid = 1
   AND ofh2.OfferID NOT IN(SELECT offer_id FROM Projects WHERE uid = 1
  )

FROM Projects p
LEFT JOIN OfferSuggestionHeader osh
    ON p.offer_id = osh.OfferID
WHERE p.uid = 1 
```

希望这能让你更近一步。

# in-app-purchase - iTunes 和应用内购买

> ID：15101366
> 
> 赞同：0
> 
> 时间：2013-02-26T23:17:36.110
> 
> 标签：in-app-purchase, itunes, app-store-connect, storekit

我是应用程序购买的新手，但不知道如何使用我的应用程序从 iTunes 库购买歌曲并在我的应用程序中流式传输或下载歌曲？是否可以从 itune 购买歌曲并将其下载到我的应用程序？

请建议我或帮助我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:41:55.433

应用内购买 &`StoreKit`用于允许购买您创建并获得 Apple 批准的项目。它不适用于从其他供应商处购买物品，也不适用于从 iTunes 购买歌曲。您可以使用媒体播放器框架播放用户 iPod 库中的歌曲。有关该功能，请参阅 Apple 的 AddMusic 示例项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T03:32:11.993

iOS6 引入了 SKStoreProductViewController 以允许开发人员交叉推广或销售来自 iTunes 或 App Store 的其他内容，而无需将用户带出您的应用程序。

您可以在此处找到文档：http: [//developer.apple.com/library/ios/#documentation/StoreKit/Reference/SKITunesProductViewController_Ref/Introduction/Introduction.html](http://developer.apple.com/library/ios/#documentation/StoreKit/Reference/SKITunesProductViewController_Ref/Introduction/Introduction.html)

您可以在此处找到有关 stackoverflow 的更多讨论：
[https ://stackoverflow.com/search?q=SKStoreProductViewController](https://stackoverflow.com/search?q=SKStoreProductViewController)

# android - 活动之间的崩溃传递值 - 我错过了什么？

> ID：15101367
> 
> 赞同：0
> 
> 时间：2013-02-26T23:17:36.617
> 
> 标签：android, android-activity

我试图在 2 个活动之间传递几个值，但我的代码崩溃了，我不知道为什么。从图像按钮调用代码，但应用程序只是停止。

```
if(v==image1){
    try {
        Calendar c = Calendar.getInstance();
        System.out.println("Current time => "+c.getTime());

        SimpleDateFormat df = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss");
        String formattedDate = df.format(c.getTime());
        //now we have the time lets write it to the file
        File myFile = new File("/sdcard/.working/mx.txt");
        myFile.createNewFile();
        FileOutputStream fOut = new FileOutputStream(myFile, true);
        OutputStreamWriter myOutWriter = new OutputStreamWriter(fOut);
        myOutWriter.append(formattedDate);
        myOutWriter.append(" :");
        myOutWriter.append(tv1.getText());
        myOutWriter.append(" ,  ");
        myOutWriter.close();
        fOut.close();
    }catch (Exception e) {
        Toast.makeText(getBaseContext(), e.getMessage(), Toast.LENGTH_SHORT).show();
    }
    mx=mx++;
    Intent startabout = new Intent(RTO.this, RTOShooting.class); //this is about screen
    startabout.putExtra("mx", mx);
    startabout.putExtra("Callsign", tv1.getText());
    final int result=1;
    startActivityForResult(startabout, result);
    overridePendingTransition(R.anim.zoom_enter, R.anim.zoom_exit);
} 
```

接收代码看起来像这样（不是我曾经得到那么远......）

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_rtoshooting);
    Bundle extras = getIntent().getExtras();
    if (extras !=null){
        int mx = extras.getInt("mx");
    }
} 
```

有人可以引导我找到我明显想念的东西吗？

LOGCAT 输出为

```
02-27 11:44:46.461: W/dalvikvm(20231): threadid=1: thread exiting with uncaught exception (group=0x41053930)
02-27 11:44:46.471: E/AndroidRuntime(20231): FATAL EXCEPTION: main
02-27 11:44:46.471: E/AndroidRuntime(20231): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.nexgen.threedashone.trainer/com.nexgen.threedashone.trainer.RTOShooting}: java.lang.NullPointerException
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2304)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2354)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.ActivityThread.access$600(ActivityThread.java:150)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1244)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.os.Looper.loop(Looper.java:137)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.ActivityThread.main(ActivityThread.java:5191)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at java.lang.reflect.Method.invokeNative(Native Method)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at java.lang.reflect.Method.invoke(Method.java:511)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at dalvik.system.NativeStart.main(Native Method)
02-27 11:44:46.471: E/AndroidRuntime(20231): Caused by: java.lang.NullPointerException
02-27 11:44:46.471: E/AndroidRuntime(20231):    at com.nexgen.threedashone.trainer.RTOShooting.onCreate(RTOShooting.java:40)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.Activity.performCreate(Activity.java:5104)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
02-27 11:44:46.471: E/AndroidRuntime(20231):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2258)
02-27 11:44:46.471: E/AndroidRuntime(20231):    ... 11 more 
```

我也尝试过像这样创建自己的包：

```
 Bundle b = new Bundle();
        b.putString("Callsign", tv1.getText().toString());
        b.putInt("mx", mx);
        startabout.putExtras(b); 
```

像这样接收：

```
 Bundle b = getIntent().getExtras();

    String callsign = b.getString("Callsign");

    int mx = b.getInt("mx"); 
```

但它仍然会以非常相似的 logcat 输出崩溃。tvcallsign.setText(呼号);

编辑：这是每个活动的完整代码，它并不漂亮，但我刚刚进入 java 和 android：

```
 package com.test.trainer;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;

import android.os.Bundle;
import android.app.Activity;
import android.content.ContextWrapper;
import android.content.Intent;
import android.content.res.AssetManager;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.Chronometer;
import android.widget.ImageButton;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import android.support.v4.app.NavUtils;

public class RTO extends Activity implements Chronometer.OnChronometerTickListener, OnClickListener {

     //define buttons etc
     private Button babout;
     private Button bhome;
    private ImageButton image1;
    private ImageButton image2;
    private ImageButton image3;
    private ImageButton image4;
    private ImageButton image5;
    private ImageButton image6;
    private ImageButton image7;
    private ImageButton image8; 
    private ImageButton image9; 
    private ImageButton image10;
    private ImageButton image11;
    private ImageButton image12;
    private ImageButton image13;
    private ImageButton image14;
    private ImageButton image15;
    private ImageButton image16;
    private ImageButton imagesetup;
    private ImageButton imageevent;
    private ImageButton imageend;

        TextView tv1;
        TextView tv2;
        TextView tv3;
        TextView tv4;
        TextView tv5;
        TextView tv6;
        TextView tv7;
        TextView tv8;
        TextView tv9;
        TextView tv10;
        TextView tv11;
        TextView tv12;
        TextView tv13;
        TextView tv14;
        TextView tv15;
        TextView tv16;

    public ListView lv1;
    public Chronometer mchrono;

    //define logic
    public int mx = 0;
    public int configured = 0;
    public int side = 0; //int to handle which colour buttons to use
    public int prijettype = 0; //int for primary  type
    public int secjettype = 0; //int for sec  type

    public int prijetnumber = 0; //int for primary  numbers
    public int secjetnumber = 0; //int for sec  numbers

    //hint array strings
    public String loadeddata;
    public String[] splitdata;

    public String callsign;      

    ContextWrapper mContext = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_rto);
        getActionBar().setDisplayHomeAsUpEnabled(true);

     //define the buttons etc for use
        babout = (Button)findViewById(R.id.babout);   //about button
        bhome = (Button)findViewById(R.id.bhome);   //home button
        image1 = (ImageButton)findViewById(R.id.image1); 
        image2 = (ImageButton)findViewById(R.id.image2);
        image3 = (ImageButton)findViewById(R.id.image3); 
        image4 = (ImageButton)findViewById(R.id.image4); 
        image5 = (ImageButton)findViewById(R.id.image5); 
        image6 = (ImageButton)findViewById(R.id.image6); 
        image7 = (ImageButton)findViewById(R.id.image7); 
        image8 = (ImageButton)findViewById(R.id.image8); 
        image9 = (ImageButton)findViewById(R.id.image9); 
        image10 = (ImageButton)findViewById(R.id.image10); 
        image11 = (ImageButton)findViewById(R.id.image11);
        image12 = (ImageButton)findViewById(R.id.image12);
        image13 = (ImageButton)findViewById(R.id.image13);
        image14 = (ImageButton)findViewById(R.id.image14); 
        image15 = (ImageButton)findViewById(R.id.image15); 
        image16 = (ImageButton)findViewById(R.id.image16); 
        imageend = (ImageButton)findViewById(R.id.imageend);  //end mission
        imagesetup = (ImageButton)findViewById(R.id.imagesetup); //setup button
        imageevent = (ImageButton)findViewById(R.id.imageevent); //event button

   tv1 = (TextView) findViewById(R.id.tv1);
        tv2 = (TextView) findViewById(R.id.tv2);
        tv3 = (TextView) findViewById(R.id.tv3);
        tv4 = (TextView) findViewById(R.id.tv4);
        tv5 = (TextView) findViewById(R.id.tv5);
        tv6 = (TextView) findViewById(R.id.tv6);
        tv7 = (TextView) findViewById(R.id.tv7);
        tv8 = (TextView) findViewById(R.id.tv8);
        tv9 = (TextView) findViewById(R.id.tv9);
        tv10 = (TextView) findViewById(R.id.tv10);
        tv11 = (TextView) findViewById(R.id.tv11);
        tv12 = (TextView) findViewById(R.id.tv12);
        tv13 = (TextView) findViewById(R.id.tv13);
        tv14 = (TextView) findViewById(R.id.tv14);
        tv15 = (TextView) findViewById(R.id.tv15);
        tv16 = (TextView) findViewById(R.id.tv16);

        image1.setOnClickListener(this);
        image2.setOnClickListener(this);
        image3.setOnClickListener(this);
        image4.setOnClickListener(this);  
        image5.setOnClickListener(this);
        image6.setOnClickListener(this);   
        image7.setOnClickListener(this);
        image8.setOnClickListener(this);
        image9.setOnClickListener(this);
        image10.setOnClickListener(this);
        image11.setOnClickListener(this);
        image12.setOnClickListener(this);
        image13.setOnClickListener(this);  
        image14.setOnClickListener(this);   
        image15.setOnClickListener(this);
        image16.setOnClickListener(this); 
        imageend.setOnClickListener(this);
        imagesetup.setOnClickListener(this);
        imageevent.setOnClickListener(this);   

        settextviews();
            setimageviews();
            hidethem();
            arrayload();

 }//end oncreate

public void arrayload() {
}

public void settextviews() {

                    //load the asset files themselves
                    StringBuilder text = new StringBuilder();
                    try {
                         BufferedReader br = new BufferedReader(new FileReader("/sdcard/NexGen/RTOLOGS/.working/1.txt"));
                            String line;

                            while ((line = br.readLine()) != null) {
                                text.append(line);
                                text.append('\n');
                            }
                                //set the text we recovered to the TextView
                                tv1.setText(text);

                //load progress info
                StringBuilder text2 = new StringBuilder();
                     BufferedReader br2 = new BufferedReader(new FileReader("/sdcard/NexGen/RTOLOGS/.working/2.txt"));
                            String line2;
                                while ((line2 = br2.readLine()) != null) {
                                text2.append(line2);
                                text2.append('\n');
                            }
                            tv2.setText(new String(text2));
} //end try
                    catch (IOException ex) {
                        return;
                    }

public void setimageviews() {
//nothing here yet

}

    public void hidethem() {
        //nothing here yet

}

  public void onClick(View v) {
        // TODO Auto-generated method stub
        if (v==bhome) {
            // TODO Auto-generated method stub
            Intent starthome = new Intent(RTO.this, Main.class); //this is about screen
        startActivity(starthome);
        overridePendingTransition(R.anim.zoom_enter, R.anim.zoom_exit);
        }

        if (v==babout) {
            Intent startabout = new Intent(RTO.this, AboutScreen.class); //this is about screen
            startActivity(startabout);
            overridePendingTransition(R.anim.zoom_enter, R.anim.zoom_exit);
            }
        if(v==image1){
            mx=mx++;
            try {
                Calendar c = Calendar.getInstance();
                System.out.println("Current time => "+c.getTime());

                SimpleDateFormat df = new SimpleDateFormat("HH:mm:ss");
                String formattedDate = df.format(c.getTime());
                //now we have the time lets write it to the file
                String fileName = String.valueOf(mx) +".txt";   
                File myFile = new File("/sdcard/test/LOGS/.working/mx/" +fileName);
                myFile.createNewFile();
                FileOutputStream fOut = new FileOutputStream(myFile, true);
                OutputStreamWriter myOutWriter = 
                                        new OutputStreamWriter(fOut);
                myOutWriter.append(formattedDate);
                myOutWriter.append(" :");
                myOutWriter.append(tv1.getText());
                myOutWriter.append(" ,  ");
                myOutWriter.close();
                fOut.close();
            }
            catch (Exception e) {
                Toast.makeText(getBaseContext(), e.getMessage(),
                        Toast.LENGTH_SHORT).show();
            }

            Bundle b = new Bundle();
            String callsign = (String)tv1.getText().toString();
            b.putString("Callsign", callsign);
            b.putInt("mx", mx);
            Intent startabout = new Intent(RTO.this, RTOShooting.class); //this is next screen
            startabout.putExtras(b);
            startActivity(startabout);
            overridePendingTransition(R.anim.zoom_enter, R.anim.zoom_exit);
            }   

 } //end onClick

//nothing below here yet
  @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_rto, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case android.R.id.home:
                NavUtils.navigateUpFromSameTask(this);
                return true;
        }
        return super.onOptionsItemSelected(item);
    }

    public void onChronometerTick(Chronometer chronometer) {
        // TODO Auto-generated method stub

    }

} 
```

接收活动如下所示：

```
package com.test.trainer;

import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStreamWriter;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageButton;
import android.widget.TextView;
import android.widget.Toast;

public class RTOShooting extends Activity implements OnClickListener {

    private ImageButton image1;
    private ImageButton image2;
    private ImageButton image3;
    private ImageButton image3close;
    private ImageButton image3medium;
    private ImageButton image3short;

    public int MX;

TextView tvcallsign;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_rtoshooting);
        Bundle b = getIntent().getExtras();
         String callsign = b.getString("Callsign");
          int mx = b.getInt("mx");
        MX = mx;
        tvcallsign.setText(callsign);

 tvcallsign = (TextView) findViewById(R.id.tvcallsign);

 } //end on create

 public void onClick(View v) {
        // TODO Auto-generated method stub
        if (v==image1) {

        }
}

 @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_rtoshooting, menu);
        return true;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T12:17:50.480

假设您的代码和 StackTrace 对齐，您会在跟踪中看到以下行：

> 在 com.nexgen.threedashone.trainer.RTOShooting.onCreate(RTOShooting.java:40)

只需计算 RTOShooting 中的行数，我就到这里了：

```
tvcallsign.setText(callsign);
tvcallsign = (TextView) findViewById(R.id.tvcallsign); 
```

您正在尝试在下一行中设置您要查找的对象的文本。交换它们，一切都应该顺利。

# html - 如何从 CGI Perl 应用程序中获取参数值？

> ID：15101372
> 
> 赞同：0
> 
> 时间：2013-02-26T23:17:42.647
> 
> 标签：html, perl, cgi, param

我正在尝试从表单中获取价值。我的HTML如下：

```
<select name="new_id" ><option value="464">464</option></select> 
```

我正在尝试使用以下方法获取价值：

```
my $clientId2 = param('new_id'); 
```

但我得到 $clientId2 为空。它适用于除此之外的所有其他标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:23:43.573

提交表单时不会发送禁用的控件。

# c++ - 查找由链表链接的数据的各个地址。C++

> ID：15101375
> 
> 赞同：0
> 
> 时间：2013-02-26T23:17:48.167
> 
> 标签：c++, list, pointers, iterator, memory-address

我在从链接列表中的项目中获取一些地址时遇到了一些麻烦。而不是在 for 循环开始时创建和初始化的迭代器地址，我想获取位于列表中的实际数据的地址。如果不创建我自己的列表实现，这可能吗？这是我得到的代码块，但显然它没有按照我想要的方式工作。

```
int j = 0;

testIntList.resize(100);
for (list<int>::iterator i = testIntList.begin(); i != testIntList.end(); ++i) {
    *i = j*j;
    int * k = &(*i);
    cout << "the value of the iterator is " << *i << " and the address of the iterator is " << &i << "and the address of the pointer is " << *k << endl;
    j++;
} 
```

我以这种方式使用 k 来尝试获取内存中迭代器值地址的实际指针。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:20:13.783

`i`是你的迭代器，所以是迭代器`&i`的地址 - 不是你想要的。现在，您知道这`*i`是您的迭代器指向的对象，所以该对象的地址是`&*i`. 这就是你投入的`k`。打印出来`k`。

```
cout << "the value of the iterator is " << *i
     << " and the address of the iterator is " << &i
     << " and the address of the pointer is " << k << endl; 
```

# excel - 在单元循环中搜索三个字符串

> ID：15101376
> 
> 赞同：1
> 
> 时间：2013-02-26T23:18:00.503
> 
> 标签：excel, vba

我正在尝试在一列单元格中搜索三个字符串之一。如果没有找到三个字符串，我想复制当前的整行并将其粘贴到下一个空行的新工作表中。这是我的代码，它给我带来了问题。我相信错误是我定义字符串进行比较的地方。我已经创建了新工作表。

```
Dim LastRow As Long
LastRow = Worksheets("Spiff Download Reporting").Range("E65536").End(xlUp).Row
Dim text As String
Dim text2 As String
Dim text3 As String
Dim NextRow As Integer
text = InputBox("Enter PLUS Name")
text2 = InputBox("Enter HERO Name")
text3 = InputBox("Enter Outboard Motor Plan Name")
For n = LastRow To 2 Step -1

   If InStr(1, Worksheets("Spiff Download Reporting").Range(Cells(n, 6)).Value, text Or text2    Or text3, vbTextCompare = 1) = 0 Then

        Rows(n).EntireRow.Copy
        Worksheets("Vendor Paid").Activate
        NextRow = Sheets("Vendor Paid").Range("A" & Rows.Count).End(xlUp).Row + 1
        Rows(NextRow).EntireRow.Select
        ActiveSheet.Paste
        Worksheets("Spiff Download Reporting").Activate
        Rows(n).EntireRow.Delete Shift:=xlUp
    End If
Next n 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:38:20.850

尝试改变这个：

```
If InStr(1, Worksheets("Spiff Download Reporting").Range(Cells(n, 6)).Value, text Or text2    Or text3, vbTextCompare = 1) = 0 Then 
```

到：

```
If InStr(1, Worksheets("Spiff Download Reporting").Range(Cells(n, 6)).Value, text, vbTextCompare) < 1 And _
   InStr(1, Worksheets("Spiff Download Reporting").Range(Cells(n, 6)).Value, text2, vbTextCompare) < 1 And _
   InStr(1, Worksheets("Spiff Download Reporting").Range(Cells(n, 6)).Value, text3, vbTextCompare) < 1 Then 
```

该表达式`text Or text2 Or text3`会导致错误，因为它是一个逻辑运算符并`Or`尝试将变量`text`和视为布尔值。如果它不能将它们转换为布尔值，它会抱怨。`text2``text3`

此外，`vbTextCompare = 1`将评估为 True，其数值为 -1。输入 this 作为第三个参数`InStr`是无效的；`InStr`这里只接受 0、1 或 2。`vbTextCompare`是一个值为 1`vbBinaryCompare`的变量， 是一个值为 0 的变量，并且`vbDatabaseCompare`保持值为 2。

另外，我建议您更改以下内容：

```
Rows(n).EntireRow.Copy
Worksheets("Vendor Paid").Activate
NextRow = Sheets("Vendor Paid").Range("A" & Rows.Count).End(xlUp).Row + 1
Rows(NextRow).EntireRow.Select
ActiveSheet.Paste
Worksheets("Spiff Download Reporting").Activate
Rows(n).EntireRow.Delete Shift:=xlUp 
```

到：

```
With Worksheets("Spiff Download Reporting")
    .Rows(.Range("A:A").End(xlUp).Row+1).Value = Worksheets("Vendor Paid").rows(n).value
End With
Worksheets("Vendor Paid").Rows(n).EntireRow.Delete 
```

请注意：我建议在代码模块的顶部使用 Option Explicit。只需直接到模块顶部并键入（在它自己的行上）Option Explicit。这意味着您不能在不首先声明变量的情况下使用变量，就像您似乎对 n 所做的那样。

顺便说一句，欢迎来到 SO :)。您的问题完全可以，但如果您执行以下操作，它将帮助您获得答案：

1.  指出您的错误发生在哪一行
2.  告诉我们错误信息是什么
3.  尽可能多地减少代码，同时仍然重现问题（更少的人来帮助你！）

这里有很多信息，如果您有任何问题，我鼓励您在评论中提出:)。另外，使用即时窗口（编辑器中的 Ctrl+G）来评估我告诉你的一些事情。尝试输入`? vbTextCompare = 1`并按回车键查看结果。或者模拟 InStr 的第二个参数：查看使用字符串`? "a" Or "b" Or "c"`时会发生什么。`Or`

**编辑**

当你的错误发生时，点击调试。然后，按 ctrl+g 调出即时窗口。现在尝试输入以下几行，一次一行，然后按 Enter：

```
? Worksheets("Spiff Download Reporting") Is Nothing
? Cells(n, 6) Is Nothing
? Worksheets("Spiff Download Reporting").Range(Cells(n, 6)) Is Nothing 
```

至少其中两行应该出现错误，让我知道是哪一行。

**带声明**

当您将主要访问代码中单个对象的方法和属性时，使用 with 语句。该对象在关键字之后指定`With`。然后，您可以访问该对象的方法和属性，而无需使用它的名称。一个基本的例子：

```
' We are working with the Spiff Download Reporting sheet
With Worksheets("Spiff Download Reporting")
    'Because we've used the With statement we don't need to
    'specify the target object's name each time we access a
    'property (e.g. the name) or method of that object
    MsgBox(.Name) 
End With
' End with is essentially stating that we are no longer
' predominantly working with the object we specified
' earlier 
```

# sql-server - 如何识别 TSQL 中的大写和小写单词？

> ID：15101380
> 
> 赞同：1
> 
> 时间：2013-02-26T23:18:19.257
> 
> 标签：sql-server, tsql

我们需要以某种方式区分所有大写字母词与标题词，例如：

```
[Column 1]
Kenya
MELBOURNE
Japan
SYDNEY
CANBERRA
WOLLONGONG
United States
United Kingdoms 
```

大写单词表示城市，标题单词表示国家。

我们一直在寻找其他专栏来区分这些东西，但这是我们可以想出的情感专栏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:24:57.457

哇，区分两种不同类型的事实真是太糟糕了。

无论如何，您可以通过将列更改为区分大小写或`COLLATE`在每个比较上使用子句来执行区分大小写的比较：

```
DECLARE @x TABLE(c VARCHAR(255));

INSERT @x VALUES
('Kenya'),
('MELBOURNE'),
('Japan'),
('SYDNEY'),
('CANBERRA'),
('WOLLONGONG'),
('United States'),
('United Kingdom');

SELECT city = CASE 
  WHEN c = UPPER(c) COLLATE Latin1_General_BIN 
    THEN c ELSE NULL END,
  country = CASE
  WHEN c <> UPPER(c) COLLATE Latin1_General_BIN 
    THEN c ELSE NULL END
FROM @x; 
```

结果：

```
city         country
----------   --------------
NULL         Kenya           
MELBOURNE    NULL
NULL         Japan           
SYDNEY       NULL
CANBERRA     NULL
WOLLONGONG   NULL
NULL         United States   
NULL         United Kingdom 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:21:11.207

要识别城市，请检查文本是否与其[`UPPER`](http://msdn.microsoft.com/en-us/library/ms180055.aspx)值相同：

```
select * from table 
where [Column 1] = UPPER([Column 1]) COLLATE Latin1_General_CS_AI 
```

请注意，正如 Aaron Bertrand 正确指出的那样，这取决于整理。

# c# - tableadaptor - 删除行

> ID：15101383
> 
> 赞同：3
> 
> 时间：2013-02-26T23:18:27.633
> 
> 标签：c#, database, visual-studio-2012

我在 Visual Studio Designer 中创建了一个数据集。它有一个充电的tableadaptor。

费用表中的一列是“预订”。此列不是主键。

我想删除“booking”值为 27 的所有行。

我向chargesTableAdaptor 添加了一个名为DeleteByBooking 的查询。它的代码：

```
DELETE FROM charges
WHERE        (chargesid = @Original_chargesid) 
```

然后在我的代码中运行：

```
this.chargesTableAdapter.DeleteBookingCharges(27);
this.chargesBindingSource.EndEdit();
this.chargesTableAdapter.Update(this.quick_quoteDataSet.charges); 
```

尽管代码构建良好，并且应用程序运行正常，但没有从数据库中删除任何行！

请问我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:29:05.237

> 我向chargesTableAdaptor 添加了一个名为DeleteByBooking 的查询

如果手动添加查询，则必须手动在 TableAdapter 实例上调用此方法：

```
chargesTableAdapter.DeleteByBooking(27); 
```

如果要在（强类型）DataSet、DataTable 或 DataRow 上使用该功能，则`Update`必须提供.`DeleteCommand``TableAdapter`

[**MSDN**](http://msdn.microsoft.com/en-us/library/bz9tthwx%28v=vs.100%29.aspx)

> **TableAdapter 更新方法**
> 
> TableAdapter 使用数据命令来读取和写入数据库。TableAdapter 的初始填充（主）查询用作创建关联数据表架构的基础，以及与**TableAdapter.Update**方法关联的 InsertCommand、UpdateCommand 和**DeleteCommand**命令。这意味着调用 TableAdapter 的 Update 方法会执行最初配置 TableAdapter 时创建的语句，**而不是**使用 TableAdapter 查询配置向导添加的其他查询之一。

 ****请注意，如果您在 TableAdapter 配置向导中选择一个表，则会自动创建这些命令。如果您加入多个表，您必须手动创建更新、插入和删除命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-11T18:30:53.237

如果您使用 dataGrid 作为控件，您可以在没有 SQL 查询的情况下尝试此操作，同样您可以仅编辑数据集行来调整此代码。

```
DataSet.yourRow iAmARow;
try
{

   iAMARow = 
   this.yourDataSet.yourTable.FindByBooking(nameOfTheColumn);

   if (iAmARow != null)
   {
       iAmARow.Delete();
       this.yourTableAdapter.Update(this.yourDataSet);
       this.yourDataSet.yourTable.AcceptChanges();

   }

}
catch (SqlException ex)
{
   ex.StackTrace.ToString();
} 
```

我希望它可以帮助你。;)****

# python - 提取 MusicXML 中键变化的小节数

> ID：15101385
> 
> 赞同：1
> 
> 时间：2013-02-26T23:18:44.307
> 
> 标签：python, xml, music-notation, music21, musicxml

我正在使用 MusicXML 文件进行大量工作，并试图编译一个条形列表，其中有许多片段发生了关键变化。我需要一些帮助，使用 python 首先确定`<key>`标签在 XML 文件中出现的位置，然后从`<measure number ='*'>`上面的标签中提取数字。这是我正在使用的度量的示例：

```
<measure number='30' implicit='yes'>
    <print new-page='yes'/>
    <barline location='left'>
        <bar-style>heavy-light</bar-style>
        <repeat direction='forward'/>
    </barline>
    <attributes>
        <key>
            <fifths>-1</fifths>
            <mode>major</mode>
        </key>
    </attributes>
    <direction>
        <direction-type>
            <dynamics  default-y='-82'>
                <p/>
            </dynamics>
        </direction-type>
        <staff>1</staff>
    </direction>
    <direction>
        <direction-type>
            <words default-y='15' relative-x='4'>
        </direction-type>
        <staff>1</staff>
    </direction>
    <note>
        <pitch>
            <step>F</step>
            <octave>5</octave>
        </pitch>
        <duration>768</duration>
        <voice>1</voice>
        <type>quarter</type>
        <stem>down</stem>
        <staff>1</staff>
        <notations>
            <ornaments>
                <trill-mark default-y='20'/>
                <wavy-line type='start' number='1'/>
                <wavy-line type='stop' number='1'/>
            </ornaments>
        </notations>
    </note>
</measure> 
```

我怎样才能提取`'30'`位？有没有一种快速简便的方法可以用 music21 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:22:52.043

我不知道Music21。如果您想直接分析 XML，您可以使用以下单行[XPath 查询](https://stackoverflow.com/questions/8692/how-to-use-xpath-in-python)来完成：

```
//measure[attributes/key]/@number 
```

这会找到`<measure>`其中包含`<key>`元素的元素，然后`number`从这些度量中提取属性。有关在 Python 中执行 XPath 的信息，请参阅[此问题](https://stackoverflow.com/questions/8692/how-to-use-xpath-in-python)（听起来[lxml](http://lxml.de/)是要走的路）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T14:31:29.850

在 music21 中，您可以这样做：

```
from music21 import *
s = converter.parse(filepath)
# assuming key changes are the same in all parts, just get the first part
p = s.parts[0]
pFlat = p.flat
keySigs = pFlat.getElementsByClass('KeySignature')
for k in keySigs:
    print k.measureNumber 
```

对于您感兴趣的简单案例，John K 的答案会很好。但是，如果您想做一些更复杂的事情（例如确定键更改时的当前仪表，查看键区域是否分析到与签名相同的键等），那么 music21 可能会有所帮助。

（编辑：透露我是软件包的生产者）。

# java - 如何从另一个程序执行 jar 并在另一个程序中显示结果？

> ID：15101387
> 
> 赞同：0
> 
> 时间：2013-02-26T23:18:50.750
> 
> 标签：java, jar, return, executable-jar

我有 2 个 java 程序。一个是可执行的 jar，它将向控制台返回 hello world 的值。下面列出..

```
public class MainClass {

    public static void main(String[] args) {
        helloWorldSubRoutine();

    }

    public static void helloWorldSubRoutine () {

        String helloWorld = "Hello there!";
          System.out.println(helloWorld);

    }

} 
```

另一个程序是一个简单的 jframe，带有一个标签，我希望它显示来自另一个 jar 的返回值或字符串。

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T04:46:24.907

你知道什么是真正可怕的，当一个想法第一次奏效时......你会想知道你做错了什么......

基本思想是执行一个新的 JVM 并读取该进程的输出。为此，您可以使用 a`ProcessBuilder`并`java`直接执行。

此示例需要`java`在执行路径中才能工作。此外，试图运行的 Jar 位于`dist`目录中，您可能需要更改它；）

**执行人**

这将启动 Java，执行所需的 Jar 文件并读取响应。

```
public class RunJava {

    public static void main(String[] args) {
        ProcessBuilder pb = new ProcessBuilder("java", "-jar", "dist/RunJava.jar");
        pb.redirectErrorStream();
        try {
            Process p = pb.start();
            InputStreamReader isr = new InputStreamReader(p.getInputStream());
            p.waitFor();
            isr.join();

            System.out.println("Process said [" + isr.getText() + "]");
        } catch (Exception exp) {
            exp.printStackTrace();
        }
    }

    public static class InputStreamReader extends Thread {

        private InputStream is;
        private String text;

        public InputStreamReader(InputStream is) {
            this.is = is;
            start();
        }

        public String getText() {
            return text;
        }

        @Override
        public void run() {
            StringBuilder sb = new StringBuilder(64);
            int value = -1;
            try {
                while ((value = is.read()) != -1) {
                    sb.append((char)value);
                }
            } catch (IOException exp) {
                exp.printStackTrace();
                sb.append(exp.getMessage());
            }
            text = sb.toString();
        }

    }

} 
```

**主要的**

已执行的“主”类（以及我们正在阅读的结果......）

```
public class Main {

    public static void main(String[] args) {
        System.out.println("Hello from the other side!");
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:22:45.557

您可以将 jar 添加到您的项目中，然后调用返回您要查找的内容的方法。通过这种方式，您将 jar 视为另一个您看不到其实现的类。

请记住，这不会捕获写入控制台的文本。

# python - 仅打印 .csv 文件中的某些行

> ID：15101391
> 
> 赞同：2
> 
> 时间：2013-02-26T23:19:08.713
> 
> 标签：python, csv

我有一个 .csv 文件，其中包含与此类似的出生日期字段：

```
John,Smith,34 La La Lane,14/03/85,johnsmith@email.com
Sarah,Second,42 Wallaby Way,11/06/92,sarahsecond@email.com
Third,Example,99 Peacock Terrace,04/12/89,thirdexample@email.com 
```

我想制作一个程序，只打印在某个月份出生的条目文件中的行（在这种情况下，月份是在第一个斜线之后，即 dd/mm/yy）。

因此，如果所需的月份是 3 月，它将打印出 John Smith 的条目。

对此的任何帮助都会很棒，我已经挣扎了一段时间

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T23:27:33.770

我不确定您正在努力解决问题的哪一部分，所以我将给出一个一般性的答案。Python 有一个 csv 阅读器，你可以像这样使用：

```
import csv
desiredMonth = 3
with open('people.csv', 'rb') as csvfile:
    content = csv.reader(csvfile, delimiter=',')
    for row in content:
        month = int(row[3].split('/')[1])
        if month == desiredMonth:
            # print the row or store it in a list for later printing 
```

`row`已经为你分成了一个列表，`row[3]`生日也是如此。`split()`然后将月份部分分成几部分，并`[1]`给出第二部分，即月份。将其转换`int`为一个好主意，因此您可以轻松地将其与您想要的任何月份进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T00:17:14.033

这是一种不同的方法...为了处理 csv 文件，python 包`csvkit`安装了许​​多命令行实用程序，可以让您非常轻松地对 .csv 文件进行切片和切块。

```
$ pip install csvkit 
```

这将安装一个名为`csvgrep`（以及其他）的命令。

```
$ csvgrep -c 4 -r '\d{2}/03' yourfile.csv
First,Last,Address,Birthdate,Email
John,Smith,34 La La Lane,14/03/85,johnsmith@email.com 
```

需要注意的一件事是，`csvkit`假设所有 .csv 文件都有标题行。这就是为什么`csvgrep`显示标题行的结果。这也意味着您必须像这样向数据文件添加标头：

```
First,Last,Address,Birthdate,Email
John,Smith,34 La La Lane,14/03/85,johnsmith@email.com
Sarah,Second,42 Wallaby Way,11/06/92,sarahsecond@email.com
Third,Example,99 Peacock Terrace,04/12/89,thirdexample@email.com 
```

命令行参数说明：

```
$ csvgrep -c 4 -r '\d{2}/03' yourfile.csv
-c specifies which column you want to search 
-r specifies the regular expression you want to match in the column 
```

正则表达式 '^\d{2}/03' 将匹配以 2 位数字开头的字符串，然后是 '/'，然后是月份 '03'。

查看[csvkit 教程](http://csvkit.readthedocs.org/en/latest/tutorial/getting_started.html)以获取更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:30:31.723

```
import csv
with open('yourfile.csv', 'rb') as csvfile:
    spamreader = csv.reader(csvfile, delimiter=',')
    for row in spamreader:
        date = row[3]
        month = date.split('/')[1]
        if int(month) >= YOUR_MONTH_HERE
            print row 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-26T23:33:25.933

尽可能多的教程类型:-)

```
somecsvfile=r'/home/me/Desktop/txt.csv'
the_month_you_are_looking_for = 6 # as in june.
with open(somecsvfile, 'r') as fi:
    for line in fi:   
        list_from_text = line.split(',')
        bday = list_from_text[3]
        bmonth = int(bday.split('/')[1])
        if bmonth == the_month_you_are_looking_for:
            print (line) 
```

# postgresql - postgresql 在不知道表详细信息的情况下获取一行

> ID：15101394
> 
> 赞同：1
> 
> 时间：2013-02-26T23:19:27.387
> 
> 标签：postgresql

我正在尝试使用 ECPG - C 中的嵌入式 SQL - 使用游标从表中获取一行。

例如：

```
struct{
   char *col1;
   char *col2;
    ....

}test_struct;

EXEC SQL DECLARE mycursor CURSOR FOR select * from test
EXEC SQL SET TRANSCATION read only
EXEC SQL OPEN mycursor
EXEC SQL FETCH FROM mycursor INTO :test_struct 
```

但似乎我必须定义一个与表test对应的struct test_struct，这意味着我已经知道表中有多少列以及它们的类型和名称。如何从我不知道其架构的任何表中获取一行？

例如：

```
select * from arbitrary_table_in_my_db 
```

///////////////////////////////////////// ////////////////////////

/// 修改：SQLDA 工作正常，这里是来自[http://www.postgresql.org/message-id/4C206CD8.7050801@gmail.com的示例代码](http://www.postgresql.org/message-id/4C206CD8.7050801@gmail.com)

//做了一些修改

```
#include <pgtypes_date.h>
#include <pgtypes_numeric.h>
EXEC SQL include sqlda.h;

sqlda_t         *sqlda1;

int
main(void)
{
        EXEC SQL CONNECT TO ....

        EXEC SQL DECLARE cur CURSOR FOR SELECT * FROM test;
        EXEC SQL OPEN cur;

        EXEC SQL WHENEVER NOT FOUND DO BREAK;

        while (1) {
                /* Open a cursor and assign descriptor to the cursor  */
                EXEC SQL FETCH NEXT FROM cur INTO DESCRIPTOR sqlda1;

                while (1) {
                  int i;
                  char name_buf[1024];
                  char var_buf[1024];

                  for (i=0 ; i<sqlda1->sqld ; i++) {
                    sqlvar_t v = sqlda1->sqlvar[i];
                    char *sqldata = v.sqldata;
                    short sqllen  = v.sqllen;

                    strncpy(name_buf, v.sqlname.data, v.sqlname.length);
                    name_buf[v.sqlname.length] = '\0';

                    strncpy(var_buf, sqldata, sqllen);

                    var_buf[sqllen] = '\0';

                    if(v.sqltype == 16)
                        printf("%s = %s, (type:%d)\n", name_buf, PGTYPESnumeric_to_asc((numeric*)sqldata,0), v.sqltype);
                    else if(v.sqltype == 18){
                        printf("%s = %s, (type:%d)\n", name_buf, PGTYPESdate_to_asc(*v.sqldata), v.sqltype);
                    }
                    else
                        printf("%s = %s, (type:%d)\n", name_buf, var_buf, v.sqltype);
                  }
                  printf("\n");

                  if ( sqlda1->desc_next==NULL )
                    break;
                }
        }
        EXEC SQL CLOSE cur;
        EXEC SQL COMMIT;
        EXEC SQL DISCONNECT ALL;
        return (0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:23:36.623

您需要使用 SQLDA（SQL 描述符区域）结构来检索有关结果集的信息。

以这种方式使用描述符时，您可以执行类似的语句`SELECT *`，然后使用 SQLDA 结构来找出实际返回的内容的详细信息。

[SQLDA 文档 (Postgresql 9.1)](http://www.postgresql.org/docs/9.1/interactive/ecpg-descriptors.html#AEN42063)

# c++ - 将一个字符串转换为另一个字符串的问题

> ID：15101395
> 
> 赞同：0
> 
> 时间：2013-02-26T23:19:30.503
> 
> 标签：c++, string, date, date-conversion

我想将表单的日期 strVal="1992-12-12" 或 "1992-9-9" 转换为 19921212 和 19920909。为此，我用 C/C++ 编写了以下代码。但问题在于它将 1992-12-12 转换为 1992012012。谁能指导我如何修复这个错误？我也可能有“1992-9”形式的输入，我想将其转换为 19920900。或“1992”到“19920000”

```
stringstream     collectTimeBegin;

for (string::iterator it = strVal.begin(); it != strVal.end(); )
{
      if (*it != '-')
      {
             cout<< "\n -- *it=" << *it;
             collectTimeBegin << *it;
             it++;
      }
      else
      {
           stringstream    si("");
           stringstream    sj("");
           int             i;               

           it++;
           si << *(it + 1);
           sj<< *(it + 2);
           i = atoi((si.str()).c_str()), j = atoi((sj.str()).c_str());
           cout << "\n i=" << i << "\t j=" << j << "\n";
           if ((i == 4) || (i == 5) || (i == 6) || (i == 7) || (i == 8) || (i == 9))
           {
                 cout << "\n 1\. *it=" << *it;
                 collectTimeBegin << *it;
                 it++;
           }
           else if ((j == 0) || (j == 1) || (j == 2) || (j == 3) || (j == 4) || 
                    (j == 5) || (j == 6) || (j == 7) || (j == 8) || (j == 9))
           {
                 string     str = "0";

                 cout << "\n 2\. *it=" << *it;
                 collectTimeBegin << str;
                 collectTimeBegin << *it;
                 it++;
            }
       }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:48:41.890

这是使用标准 C++ 的解决方案；它使用与 Christian 相同的方法：根据破折号拆分输入，用 0 填充缺失的数字：

```
#include <string>
#include <sstream>
#include <algorithm>

int main()
{
    std::string date = "1992-9-12";

    std::replace(date.begin(), date.end(), '-', ' ');   // "1992 9 12"

    std::istringstream iss(date);
    int year = 0, month = 0, day = 0;

    if (iss.good()) iss >> year;    // 1992
    if (iss.good()) iss >> month;   // 9
    if (iss.good()) iss >> day;     // 12

    std::ostringstream oss;
    oss.fill('0');
    oss.width(4); oss << year;
    oss.width(2); oss << month;
    oss.width(2); oss << day;
    std::string convertedDate = oss.str();  // 19920912
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:34:46.350

如果你不介意使用外部库，我会用 boost 来做到这一点。

```
 string input = "1992-9-9";
    vector<string> v;
    boost::algorithm::split(v, input, boost::algorithm::is_any_of("-"));
    string output;
    BOOST_FOREACH(const string &s, v)
    {
        if (s.size() == 1)
        {
            output += "0"+s;
        } else {
            output += s;
        }
    }
    if (output.size() == 4)
        output += "0000"
    if (output.size() == 6)
        output += "00" 
```

编辑：如果您的输入字符串只有 6 或 4 位长，忘记处理这种情况

# jquery - jQuery DataTable - 隐藏字段中的 JSON

> ID：15101396
> 
> 赞同：1
> 
> 时间：2013-02-26T23:19:51.420
> 
> 标签：jquery, datatables

我正在使用流行的 DataTable jQuery 库在 Coldfusion 中呈现一些表格数据。我有以下 jQuery ...

```
var tbl = $('#tbl-people').dataTable({
   aaData : [<cfoutput query="qryPeople">
      [
         '#FName#',
         '#LName#',
         '<input type="hidden" value="{\"test_id\":123,\"test\":\"john\"}" />'
      ]<cfif currentRow NEQ recordCount>,</cfif></cfoutput>
   ],
   aoColumnDefs... and a few other pieces that I'm leaving out for the sake of brevity.
}); 
```

我的问题（和问题）围绕着作为 aaData 中的第三列创建的隐藏字段。我想将 FName 和 LName 作为 JSON 存储在隐藏字段的值中；然而，为了首先测试它，我决定在一些测试 JSON 中硬编码。我的问题是隐藏的输入字段在最终呈现为 HTML 时被破坏。隐藏输入的结果 HTML 如下所示...

```
<input type="hidden" test_id":123,"test":"john"}"="" value="{"> 
```

在我看来，在某些时候 JSON 中的双引号被某些东西误解或误解了，这似乎很明显，因此搞砸了 HTML。另外，请注意，我坚持使用标准反斜杠以尝试转义 JSON 中的双引号（但似乎无济于事）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:29:01.370

不要将 JSON 粘贴在隐藏字段中；这很乏味。我能够轻松地将其放入 HTML 跨度标记中，然后将 css 显示设置为“无”，从而有效地使其成为隐藏字段。

# c++ - 获取字符串文字的字符长度

> ID：15101405
> 
> 赞同：1
> 
> 时间：2013-02-26T23:21:00.263
> 
> 标签：c++, string, sizeof, literals

在不使用类似这样的 cstdlib 的情况下，如何获得字符串文字的长度（给定或取空终止符）：

```
char* foo = "foobar";
cout << sizeof(foo) << endl; //Always outputs 4
cout << sizeof(*foo) << endl; //Always outputs 1 
```

我必须在连接中可能/可能不包含字符串文字的字符串上重载 + 运算符。在不知道传递的 char*(Or char[] 我猜) 的长度的情况下，我无法为字符串分配内存。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T23:23:28.890

foo 是指向字符串的指针。是的，它是一个常量字符串，但它仍然是一个`char*`在一天结束时它仍然是一个。

特别是，char 指针 ( `foo`) 的大小是 4 字节（在 32 位系统上[嗯，具有 4 字节指针的系统]），而 char (`*foo` ) 的大小为 1 字节。

当您使用指向字符串文字的指针时，没有（标准）方法可以知道字符串的长度。

但是，您可以在使用数组时知道大小：

```
char foo[] = "some string";
size_t len = sizeof(foo) - 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T23:22:30.930

```
#include <cstring>
std::size_t length = std::strlen(foo); 
```

**如果您出于某种原因不能使用任何库，请进行**编辑，然后推出您自己的 strlen。**例如**

 **```
// simple recursion
size_t mystrlen1(const char* str)
{
  return (*str) ? 1 + mystrlen1(++str) : 0;
} 
```

或者

```
// iteration
size_t mystrlen_iteration(const char* str)
{
  size_t counter = 0;
  for (;*str!=0; ++str) ++counter;
  return counter; 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:32:29.803

sizeof(char *) 是指向字符串的指针的大小。你可以试试

```
char foo[] = "foobar"; 
```

sizeof(foo) = 7（因为它是 "foobar\0" - 以空字符结尾的字符串）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T23:27:48.803

您看到所获得值的原因很明显：

`foo`是一个指针，并且指针通常是 4 个字节长。`*foo`是一个字符，一个字节长。如果你不能使用内置库，你可以自己动手：

```
function myStrlen(char* foo) {
    int ii=0;
    while(foo[ii]!='\0') ii++;
    return ii;
} 
```

我有一个有趣的想法，大多数编译器通过将值存储在 (pointer - 1) 中来记录分配内存块的大小——这就是 free() 知道要释放多少内存的方式。我不知道这是否普遍正确，以及字符串常量是否正确，但我过去曾成功使用过它。是的，我是一名黑客......在你的情况下，我会仔细看看

```
*(((unsigned long int*)foo) - 1) 
```

如果您在那里找到字符串长度，我不会感到惊讶。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-23T19:31:19.333

如果我们不想要标准库字符串，我们可能会使用结构。

```
struct ConstStr
{
   const size_t length;
};

struct ConstStr operator ""cstr (const char*given, size_t given_size) { return {given_size-1}; } 
```

使用字符串文字运算符重载我们可以获得大小。

```
int main()
{
   auto str = "Hello world"cstr;
   cout << str.length << std::endl;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-26T23:30:07.170

使用`std::string`：

```
#include <string>

int main()
{
    std::string str("Hello World");

    std::cout << str.length(); // 11
} 
```**

# ivy - 为什么ivy不下载源代码？

> ID：15101413
> 
> 赞同：0
> 
> 时间：2013-02-26T23:21:43.817
> 
> 标签：ivy

[我按照这里](https://stackoverflow.com/questions/1083860/source-code-of-libraries-downloaded-with-ivy)的指示。我找不到我能找到的源代码。

常春藤.xml：

```
<ivy-module version="2.0">
<info organisation="com.example" module="test"/>
<dependencies defaultconfmapping="*->default,sources">
  <dependency org="org.apache.hadoop" name="hadoop-core" rev="1.0.3"/>      
</dependencies>
</ivy-module> 
```

输出：

```
$ ivy
:: loading settings :: url = jar:file:/usr/local/Cellar/ivy/2.3.0-rc1/libexec/ivy-2.3.0-rc1.jar!/org/apache/ivy/core/settings/ivysettings.xml
:: resolving dependencies :: com.example#test;working@foo.local
    confs: [default]
    found org.apache.hadoop#hadoop-core;1.0.3 in public
    found commons-cli#commons-cli;1.2 in public
    found xmlenc#xmlenc;0.52 in public
    found commons-httpclient#commons-httpclient;3.0.1 in public
    found junit#junit;3.8.1 in public
    found commons-logging#commons-logging;1.0.3 in public
    found commons-codec#commons-codec;1.4 in public
    found org.apache.commons#commons-math;2.1 in public
    found commons-configuration#commons-configuration;1.6 in public
    found commons-collections#commons-collections;3.2.1 in public
    found commons-lang#commons-lang;2.4 in public
    found commons-logging#commons-logging;1.1.1 in public
    found commons-digester#commons-digester;1.8 in public
    found commons-beanutils#commons-beanutils;1.7.0 in public
    found commons-beanutils#commons-beanutils-core;1.8.0 in public
    found commons-net#commons-net;1.4.1 in public
    found oro#oro;2.0.8 in public
    found org.mortbay.jetty#jetty;6.1.26 in public
    found org.mortbay.jetty#jetty-util;6.1.26 in public
    found org.mortbay.jetty#servlet-api;2.5-20081211 in public
    found tomcat#jasper-runtime;5.5.12 in public
    found tomcat#jasper-compiler;5.5.12 in public
    found org.mortbay.jetty#jsp-api-2.1;6.1.14 in public
    found org.mortbay.jetty#servlet-api-2.5;6.1.14 in public
    found org.mortbay.jetty#jsp-2.1;6.1.14 in public
    found org.eclipse.jdt#core;3.1.1 in public
    found ant#ant;1.6.5 in public
    found commons-el#commons-el;1.0 in public
    found net.java.dev.jets3t#jets3t;0.7.1 in public
    found net.sf.kosmosfs#kfs;0.3 in public
    found hsqldb#hsqldb;1.8.0.10 in public
    found org.codehaus.jackson#jackson-mapper-asl;1.0.1 in public
    found org.codehaus.jackson#jackson-core-asl;1.0.1 in public
downloading http://repo1.maven.org/maven2/commons-codec/commons-codec/1.4/commons-codec-1.4.jar ...
.................. (56kB)
.. (0kB)
    [SUCCESSFUL ] commons-codec#commons-codec;1.4!commons-codec.jar (70ms)
downloading http://repo1.maven.org/maven2/org/codehaus/jackson/jackson-mapper-asl/1.0.1/jackson-mapper-asl-1.0.1.jar ...
.................................................................................................. (264kB)
.. (0kB)
    [SUCCESSFUL ] org.codehaus.jackson#jackson-mapper-asl;1.0.1!jackson-mapper-asl.jar (466ms)
downloading http://repo1.maven.org/maven2/junit/junit/3.8.1/junit-3.8.1.jar ...
.......................................................... (118kB)
.. (0kB)
    [SUCCESSFUL ] junit#junit;3.8.1!junit.jar (130ms)
downloading http://repo1.maven.org/maven2/commons-lang/commons-lang/2.4/commons-lang-2.4.jar ...
...................................................................................................................................... (255kB)
.. (0kB)
    [SUCCESSFUL ] commons-lang#commons-lang;2.4!commons-lang.jar (302ms)
downloading http://repo1.maven.org/maven2/org/codehaus/jackson/jackson-core-asl/1.0.1/jackson-core-asl-1.0.1.jar ...
...................................................................... (132kB)
.. (0kB)
    [SUCCESSFUL ] org.codehaus.jackson#jackson-core-asl;1.0.1!jackson-core-asl.jar (110ms)
:: resolution report :: resolve 1647ms :: artifacts dl 1135ms
    :: evicted modules:
    commons-logging#commons-logging;1.0.3 by [commons-logging#commons-logging;1.1.1] in [default]
    commons-codec#commons-codec;1.2 by [commons-codec#commons-codec;1.4] in [default]
    commons-logging#commons-logging;1.1 by [commons-logging#commons-logging;1.1.1] in [default]
    commons-codec#commons-codec;1.3 by [commons-codec#commons-codec;1.4] in [default]
    commons-httpclient#commons-httpclient;3.1 by [commons-httpclient#commons-httpclient;3.0.1] in [default] 
```

[这篇博](http://theholyjava.wordpress.com/2011/05/20/ivy-how-to-retrieve-source-codes-of-dependencies/)文说要检查配置是否有来源。这个配置似乎表明来源是可能的，虽然我很难说：

```
$ cat ~/.ivy2/cache/org.apache.commons/commons-parent/ivy-11.xml
<?xml version="1.0" encoding="UTF-8"?>
<ivy-module version="2.0" xmlns:m="http://ant.apache.org/ivy/maven">
    <info organisation="org.apache.commons"
        module="commons-parent"
        revision="11"
        status="release"
        publication="20080721065829"
    >
        <description homepage="http://commons.apache.org/" />
        <m:properties__commons.binary.suffix>-bin</m:properties__commons.binary.suffix>
        <m:properties__organization.logo>http://www.apache.org/images/asf_logo_wide.gif</m:properties__organization.logo>
        <m:properties__commons.osgi.symbolicName>org.apache.commons.${commons.componentid}</m:properties__commons.osgi.symbolicName>
        <m:properties__commons.rc.version>RC1</m:properties__commons.rc.version>
        <m:properties__commons.docEncoding>${commons.encoding}</m:properties__commons.docEncoding>
        <m:properties__commons.osgi.export>org.apache.commons.*;version=${pom.version}</m:properties__commons.osgi.export>
        <m:properties__commons.componentid>${project.artifactId}</m:properties__commons.componentid>
        <m:properties__maven.compile.target>1.3</m:properties__maven.compile.target>
        <m:properties__commons.deployment.protocol>scp</m:properties__commons.deployment.protocol>
        <m:properties__maven.compile.source>1.3</m:properties__maven.compile.source>
        <m:properties__commons.encoding>iso-8859-1</m:properties__commons.encoding>
        <m:properties__commons.osgi.import>*</m:properties__commons.osgi.import>
        <m:properties__commons.release.name>${project.artifactId}-${commons.release.version}</m:properties__commons.release.name>
        <m:maven.plugins>null__maven-compiler-plugin__null|null__maven-jar-plugin__null|org.apache.felix__maven-bundle-plugin__null|null__maven-idea-plugin__null|org.apache.maven.plugins__maven-antrun-plugin__null|org.apache.commons__commons-build-plugin__null</m:maven.plugins>
        <m:properties__commons.manifestfile>target/osgi/MANIFEST.MF</m:properties__commons.manifestfile>
    </info>
    <configurations>
        <conf name="default" visibility="public" description="runtime dependencies and master artifact can be used with this conf" extends="runtime,master"/>
        <conf name="master" visibility="public" description="contains only the artifact published by this module itself, with no transitive dependencies"/>
        <conf name="compile" visibility="public" description="this is the default scope, used if none is specified. Compile dependencies are available in all classpaths."/>
        <conf name="provided" visibility="public" description="this is much like compile, but indicates you expect the JDK or a container to provide it. It is only available on the compilation classpath, and is not transitive."/>
        <conf name="runtime" visibility="public" description="this scope indicates that the dependency is not required for compilation, but is for execution. It is in the runtime and test classpaths, but not the compile classpath." extends="compile"/>
        <conf name="test" visibility="private" description="this scope indicates that the dependency is not required for normal use of the application, and is only available for the test compilation and execution phases." extends="runtime"/>
        <conf name="system" visibility="public" description="this scope is similar to provided except that you have to provide the JAR which contains it explicitly. The artifact is always available and is not looked up in a repository."/>
        <conf name="sources" visibility="public" description="this configuration contains the source artifact of this module, if any."/>
        <conf name="javadoc" visibility="public" description="this configuration contains the javadoc artifact of this module, if any."/>
        <conf name="optional" visibility="public" description="contains all optional dependencies"/>
    </configurations>
    <publications>
    </publications>
</ivy-module> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T20:23:17.603

该版本的 Hadoop 在 Maven Central 中没有源工件：

*   [Maven Central 中的 1.0.3 版 hadoop-core](http://search.maven.org/#artifactdetails%7Corg.apache.hadoop%7Chadoop-core%7C1.0.3%7Cjar)

无法下载不存在的内容:-)

# 例子

为了将来自己看到这一点，我建议在常春藤中使用配置并生成常春藤依赖管理报告。

与此示例关联的报告显示作为“源”配置的一部分下载的零工件。

## 构建.xml

```
<project name="demo" default="retrieve" xmlns:ivy="antlib:org.apache.ivy.ant">

    <target name="resolve">
        <ivy:resolve/>
        <ivy:report todir="build/ivy"/>
    </target>

    <target name="retrieve" depends="resolve">
        <ivy:retrieve pattern="build/lib/[conf]/[artifact].[ext]"/>
    </target>

</project> 
```

笔记：

*   报告任务将为 ivy 文件中创建的每个配置生成一个 HTML 报告
*   检索任务用于将文件放置在项目结构中的某个位置。

## 常春藤.xml

```
<ivy-module version="2.0">
    <info organisation="com.myspotontheweb" module="demo"/>

    <configurations>
        <conf name="compile" description="Required to compile application"/>
        <conf name="sources" description="Source code"/>
    </configurations>

    <dependencies>
        <dependency org="org.apache.hadoop" name="hadoop-core" rev="1.0.3" conf="compile->default;sources"/>      
    </dependencies>

</ivy-module> 
```

笔记：

*   在这里，我声明了两个配置（或 jar 的逻辑组）
*   两个映射：“compile”->“default”和“sources”->“sources”
*   常春藤“检索”任务是配置感知的，这意味着您可以将工件放在不同的目录中

# twig - 如何在 Twig 中生成和执行代码？

> ID：15101419
> 
> 赞同：0
> 
> 时间：2013-02-26T23:22:00.160
> 
> 标签：twig

我创建了一个这样的宏：

```
{% macro _path(my_path, param, js_var) %}
{% spaceless %}
    path('{{ my_path }}', { '{{ param }}': "%s" }) | url_decode | format('"+{{ js_var }}+"') | raw
{% endspaceless %}
{% endmacro %} 
```

当我这样称呼它时：

```
window.location ="{{ js.path('hqf_pizzas_searchpage', 'cp', 'monCP') }}"; 
```

它可以工作，但它会生成：

```
window.location ="path('hqf_pizzas_searchpage', { 'cp': "%s" }) | url_decode | format('"+monCP+"') | raw"; 
```

这不是我想要的。我只想让 Twig 在宏之后执行结果来获得这个：

```
window.location ="/my-url/cp/"+monCP+""; 
```

知道你怎么能做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T06:12:30.003

将您的宏体更改为：

```
{{ path(my_path, { param: "+"~js_var~"+" }) }} 
```

我不确定 的值是否`param`会正确传递。如果没有，试试这个：

```
{% set params = {} %}
{% set params[param] = "+" ~ js_var ~ "+" %}
{{ path(my_path, params) }} 
```

# android - 为什么我必须在 Eclipse 中如此频繁地重置 ADB 才能连接到 Android 设备？

> ID：15101422
> 
> 赞同：5
> 
> 时间：2013-02-26T23:22:05.603
> 
> 标签：adb, android, eclipse, adb

在Eclipse中开发Android项目时，经常发现android设备离线。当我重置 Android 调试桥 ( [adb](/questions/tagged/adb "显示标记为“adb”的问题") ) 时，问题得到了解决——尽管是暂时的。SE上有很多答案建议重置ADB以解决类似问题，但我还没有找到根本原因的答案：

*   **发生了什么需要如此频繁地重置亚行？**

* * *

更新：以下是有关我的配置的一些详细信息（根据@Berdon 的要求）：

*   开发环境运行 Windows 8。
*   Eclipse JDT (3.8.1)、Eclipse 平台 (4.2.1)、Eclipse RCP (4.2.1)、ADT (21.0.1.201212060302)。
*   使用 USB 电缆连接到 Android 设备，它们之间没有 USB 集线器。
*   有问题的 Android 设备主要包括 Nexus 7 平板电脑和 HTC Thunderbolt，尽管我已经看到其他设备也出现这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:58:54.963

我在使用 Eclipse 时也遇到过类似的问题。但我相信这是 Windows 的问题，而不是 Android 或 Eclipse。

回家后我会测试这个：

1.  转到控制面板 -> 系统 -> 设备管理器
2.  打开通用串行总线控制器
3.  右键单击所有根集线器
4.  在“电源管理”选项卡中，取消选中“允许计算机关闭此设备以节省电源”框

我使用的是 Windows 7 计算机，因此您必须通过 `Windows`+访问控制面板`x`。

# algorithm - 打印所有可能的 8 位数字的算法

> ID：15101439
> 
> 赞同：-2
> 
> 时间：2013-02-26T23:22:55.397
> 
> 标签：algorithm, random, numbers, time-complexity

打印所有可能的 8 位数字的算法是否需要 8 个 for 循环？即 10 次幂 n 时间复杂度。有没有办法可以减少循环次数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:24:46.613

> 有没有办法可以减少循环次数？

是的：

```
printf("00000000\n");
printf("00000001\n");
printf("00000002\n");
printf("00000003\n");
.... 
```

没有循环。只是打字很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:28:48.933

让我们试试单循环

```
int i;
for (i = 10000000; i < 100000000; i++)
{
    printf("%d\n", i);
} 
```

（假设您的意思是十进制表示、c 语言和以非零数字开头的数字）

如果你想打印所有的数字，你不会得到任何加速算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:24:43.990

不，没有办法降低复杂性。要生成 10^n 个输出，您需要迭代 10^n 次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T23:30:09.167

伪科...

```
for val in (10000000..99999999)
    display val 
```

是什么让你认为你需要 8 个循环？

# objective-c - 使用 - (void)applicationDidBecomeActive:(UIApplication *)application 从任何视图控制器切换到特定视图控制器

> ID：15101444
> 
> 赞同：0
> 
> 时间：2013-02-26T23:23:21.890
> 
> 标签：objective-c, ios5

我想在用户后台应用程序后跳转到特定屏幕（视图）。

如果我指定要从哪个屏幕离开，我可以跳转到另一个屏幕，但我想从任何屏幕移动。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:36:15.207

是的，它可能，具体取决于您的应用程序的结构。

例如，如果您的应用程序的内容是单个导航控制器，您可以简单地将所需的视图推送到导航控制器上。或者您可以弹出到根视图，然后推送所需的视图。

如果是选项卡控制器，您可以将视图推送到特定选项卡上，然后手动设置选项卡控制器的选定选项卡。

或者，如果视图是模态的，您可以将其显示在上述任何一个上，甚至是应用程序本身的窗口上。

你有更具体的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T01:26:53.703

在应用程序委托中：

```
@property (nonatomic, strong) UINavigationController *mainNavController; 
```

在完成启动：

```
self.mainNavController = // do your initialization here

self.window.rootViewController = self.mainNavController; 
```

在确实变得活跃：

```
[self.mainNavController pushViewController:myNewVC animated:YES]; 
```

或者您甚至可以更改根视图控制器：

```
self.window.rootViewController = newViewController; 
```

您可以通过调用从代码中的任何位置访问主导航；

```
UINavigationController *mainNav = [(MyAppDelegate *)[[UIApplication sharedApplication] delegate] mainNavController]; 
```

并用它做任何你的事情。

# c++ - 当检查为 eof 时，使用 getline 从文本文件中读取会导致无限循环

> ID：15101453
> 
> 赞同：1
> 
> 时间：2013-02-26T23:24:04.627
> 
> 标签：c++, windows, file, text

我正在尝试从特定行中的文本文件中获取一些数据（第 1、第 7、第 13 等 - 需要的数据放在下一个第 6 行）

到目前为止，我的代码是这样的：

```
txtfile = "titles.txt";
ifstream txt(txtfile);
const int buffer_size = 80;
char title_buffer[buffer_size];
const int titleLineDiff = 6;
if (txt.is_open())
{
    while(!txt.eof())
    {
        static int counter = 1;
        txt.getline(title_buffer, buffer_size);
        cout << "Title: \"" << counter << "." << title_buffer << "\"" << endl;
        counter++;
        //seek to the next title...difference is 6 lines
        for(int i = 0; i < titleLineDiff; i++)
            txt.getline(title_buffer, 40);
    }
} 
```

现在，它适用于我创建的这个文件：

```
testONE
two
three
four 
five
six

testTWO
bla 
```

它打印“testONE”和“testTWO”但是当我试图打开包含数据的文件时，我得到一个无限循环，输出是

> 标题：“counter_increasing_number。”

文本文档是从互联网上复制的，这可能是导致阅读问题的原因。

我能做些什么呢？

* * *

我已将代码更改为：

```
while(getline(txt,title_buffer))
{
    static int counter = 1;
    //getline(title_buffer, buffer_size);
    cout << "Title: \"" << counter << "." << title_buffer << "\"" << endl;
    counter++;
    //seek to the next title...difference is 6 lines
    for(int i = 0; i < titleLineDiff; i++)
    {
        getline(txt, title_buffer);
    }
} 
```

它奏效了。

有人可以解释一下为什么第一个不起作用的原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:51:15.620

对于初学者，您使用的结果`getline`不检查是否成功。（在第二个版本中，这只适用于内部循环。）

至于为什么第一个版本是错误的：是`eof`在最后一次成功读取之后设置，还是在第一次不成功之后设置，并没有真正指定。当然，除了文件结尾之外，还有其他原因导致输入失败。神圣的习惯用法是*始终*使用`getline`（和任何其他输入）作为循环或 if 中的控制表达式。如果表达式被考虑`true`，则输入成功。在您知道输入失败后进行检查有时很有用*；*`eof()`如果`eof()`不是真的，那么问题出在其他地方：硬件错误（`bad()`为真）或格式错误。

至于为什么你的测试数据和实际数据表现不同，很难说没有看到两者。一些可能的原因：不同的行结束约定，可能一组数据以不完整的行结尾（通常是使用 Windows 编辑器生成数据的情况），或者行长于缓冲区（在第一种情况下）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T03:24:48.003

给你（不要忘记阅读评论）：

**例子：**

```
void Example( void )
{
    // DECLARATION
    // *Declare iFile as std::ifstream and attempt to open file: Example.txt
    std::ifstream iFile( "Example.txt" );

    // *If iFile is open, do this:
    if( iFile.is_open( ) )
    {
        // DECLARATION
        // *You could declare strLine as an array of char if you want
        std::string strLine = "";
        unsigned int nLineCount = 0;

        // DO WHATEVER
        // *Read iFile line by line using std::getline
        while( std::getline( iFile, strLine ) )
        {
            // *For the line after every 6th line, we shall print
            // as a title
            // *( nLineCount % 6 ) gives us the remainder of
            // nLineCount / 6 and if the remainder is 0, then
            // do this:
            if( !( nLineCount % 6 ) )
            {
                std::cout << "Title = " << strLine << std::endl;
            }
            // *For every other line, we shall print it normally
            else
            {
                std::cout << strLine << std::endl;
            }

            // *Increase nLineCount by 1;
            nLineCount ++;
        }
        // CLEAN-UP
        // *Done using inFile - so close it
        inFile.close( );
    }
}; 
```

**测试：**

```
Title = 1
2
3
4
5
6
Title = 7
8
9
10
11
12
Title = 13
...

Debugging > Paused! Enter any key to continue... 
```

**更多...** 没有评论：

```
void Example( void ) {
    std::ifstream iFile( "Example.txt" );

    if( iFile.is_open( ) ) {
        std::string strLine = "";
        unsigned int nLineCount = 0;

        while( std::getline( iFile, strLine ) ) {
            if( !( nLineCount % 6 ) )
                std::cout << "Title = " << strLine << std::endl;
            else
                std::cout << strLine << std::endl;
            nLineCount ++;
        }
        iFile.close( );
    }
}; 
```

For-loop 方法，简洁明了：

```
void Example( void )
{
    std::ifstream iFile( "Example.txt" );

    if( iFile.is_open( ) )
    {
        std::string strLine = "";

        for( unsigned int nLineCount = 0; std::getline( iFile, strLine ); nLineCount ++ ) {
            if( !( nLineCount % 6 ) )
                std::cout << "Title = " << strLine << std::endl;
            else
                std::cout << strLine << std::endl;
        }
        iFile.close( );
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:31:36.047

第二个文件的行数不相等，因为您期望有 7 行，而最后一个块的行数少于此数。这导致您在检查之前超出了 eof。您需要将 eof 条件放在内部 for 循环中。

编辑：请确保每行不超过 80 个字符。

# regex - 重定向 WordPress 个人资料页面

> ID：15101454
> 
> 赞同：0
> 
> 时间：2013-02-26T23:24:24.070
> 
> 标签：regex, wordpress, .htaccess

我有一个 BBPress 论坛，可以生成这样的个人资料页面：forum/profile/USERNAME。

我想要做的是使用 .htaccess 或重定向插件将此链接重定向到 /profile/USERNAME 并删除配置文件部分。

最好的方法是什么？

干杯，

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T14:30:52.440

您可以在根目录的 .htaccess 文件中尝试此操作：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^forum/profile/([^/]+)/?  /profile/$1  [L,NC] 
```

静默地图

`http://sitename.com/forum/profile/username/`

至

`http://sitename.com/profile/username/`

假设字符串`username`是动态的，而`forum`假设`profile`是固定的。

对于永久重定向，替换`[L,NC]`为`[R=301,L,NC]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:33:38.133

您可以使用 .htaccess 文件中的 RedirectMatch（mod_alias 的一部分）让服务器以 301 响应：

```
//301 Redirect Entire Directory
RedirectMatch 301 ^/forum/profile/(.*) /profile/$1 
```

# javascript - YouTube API，定义为类并停止视频

> ID：15101455
> 
> 赞同：0
> 
> 时间：2013-02-26T23:24:40.363
> 
> 标签：javascript, api, video, youtube

我正在建立一个基于锚点和 Jquery 的网站，每个页面都有不同的幻灯片（一切都很好，只是想我会提供一些背景）

现在，事情就是这样。在其中三张幻灯片上，有 Youtube 视频需要在导航离开时自动停止。所以我写了“返回”按钮，并附有以下字符串

```
onclick="player.stopVideo(); return false" 
```

现在我遇到的问题是 Youtube API 自动为播放器提供“播放器”的 id 而不是一个类，在 API 之后调用了这行代码

```
<script>
var player;
function onYouTubePlayerAPIReady() {player = new YT.Player('player');} 
</script> 
```

还有这样的 iframe

```
<iframe id="player" src="http://www.youtube.com/embed/TMFINFk_080?&vq=hd720" frameborder="0" allowfullscreen></iframe> 
```

正如预期的那样完美地工作。现在，我需要这个课程，因为我有多个视频需要在同一页面上应用停止线，我完全迷路了。一个朋友建议定义一个函数来调用停止命令到任何具有类名的东西，但我不知道从哪里开始。

谢谢。

注意：iframe 将是理想的，因为此页面上已经有很多代码，并且添加嵌入将占用更多空间，对此不要太在意，但 iframe 提供的支持是理想的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-02T01:09:46.293

`

```
<!DOCTYPE html>
<html lang="es">
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>   
<script type="text/javascript" src="http://www.youtube.com/player_api"></script>
<script>
var player;
function onYouTubeIframeAPIReady() {player = new YT.Player('player');}
if(window.opera){
    addEventListener('load', onYouTubeIframeAPIReady, false);
}
</script>
 </head>
<body>
<script>
$(document).ready(function(){
 });
</script>
<div id="video">
  <iframe id="player" width="560" height="349" frameborder="0" src="http://www.youtube.com/embed/vE_0V55Vywc?rel=0&wmode=Opaque&enablejsapi=1"></iframe>
</div>
<a href="javascript: void(0)" onclick="player.playVideo(); return false">play</a><br>
<a href="javascript: void(0)" onclick="player.stopVideo(); return false">stop</a>
</body>
</html> 
```

`示例：http: [//jsfiddle.net/ckWLs/1/](http://jsfiddle.net/ckWLs/1/)

# sql-server - 从 SQL Server 中选择具有匹配列的行

> ID：15101457
> 
> 赞同：20
> 
> 时间：2013-02-26T23:24:43.247
> 
> 标签：sql-server

我相当肯定这很简单，但是我尝试过的每个示例都失败了。我想查询这样的表

```
ID   Part_Type   Station_Type
---  ---------   ------------
1    5           234
2    5           846
3    5           234
4    6           585
5    6           585
6    7           465 
```

并返回第 1 行和第 3 行，以及第 4 行和第 5 行。也就是说，我想返回其中两列匹配的行。它类似于这个问题：[SO Question](https://stackoverflow.com/questions/7122794/select-based-on-matching-columns)但只需要在一张桌子上完成。该查询将为每一行找到一个匹配项，但我只想要在两列中具有匹配值的行。我怎么去找到那个？

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-26T23:32:44.337

您可以使用以下内容：

```
select t1.id, t1.part_type, t1.station_type
from yourtable t1
where exists (select part_type, station_type
              from yourtable t2
              where t1.part_type = t2.part_type
                and t1.station_type = t2.station_type
              group by part_type, station_type
              having count(id) > 1) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/48af7/5)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T23:35:14.673

```
select id, part_type, station_type 
from myTable t1
where exists (select 1 from myTable t2
              where t1.part_type = t2.part_type
                  and t1.station_type = t2.station_type
                  and t1.id <> t2.id) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:29:16.370

我认为[自我加入](http://msdn.microsoft.com/en-au/library/ms177490%28v=sql.105%29.aspx)对您有用：

```
SELECT * FROM table t1 
INNER JOIN table t2 ON t1.Part_Type = t2.Part_Type 
  AND t1.Station_Type = t2.Station_Type
  AND t1.Id <> t2.Id 
```

# php - 使用 sfDoctrineGuardPlugin 在登录时设置用户文化

> ID：15101459
> 
> 赞同：1
> 
> 时间：2013-02-26T23:24:43.950
> 
> 标签：php, internationalization, symfony-1.4, sfguard, sfdoctrineguard

在 sfDoctrineGuardPlugin 处理的登录过程中如何设置用户文化？每个用户都可以设置他们的首选语言，该语言存储在 sfGuardUserProfile 表中。

最初我曾考虑`executeSignin()`通过执行类似的操作来覆盖该函数：

```
public function executeSignin(sfWebRequest $request)
{
  $this->getUser()->setCulture($this->getUser()->getGuardUser()->getProfile()->getLanguage());
  parent::executeSignin($request);
} 
```

但显然我不能这样做，因为在执行父函数之前我无法访问 GuardUser 对象。

然后我想到了创建一个`postExectute()`类似这样的函数：

```
public function postExecute()
{
  if($this->getUser()->isAuthenticated()){
    //SET USER CULTURE
  }
} 
```

但这又不起作用，因为登录功能会进行重定向，因此`postExecute()`永远不会运行。

我无法在登录后将我的逻辑设置在默认页面上，因为用户并不总是被重定向到同一页面甚至同一模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T08:24:07.077

我会做一些比重新创建动作更容易的事情。

在您`/apps/[your app]/lib/user/myUser.class.php`扩展的文件中`sfGuardSecurityUser`：

您可以像这样覆盖`signIn`函数：

```
public function signIn($user, $remember = false, $con = null)
{
  parent::signin($user, $remember, $con);

  $this->setCulture($user->getProfile()->getLanguage());
} 
```

因此，每次用户登录时，都会设置其文化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T08:13:13.503

你的第一个猜测是正确的方法，只需要改变;）

而不是调用父母`executeSignin()`编写您自己的登录操作（例如复制插件使用的操作）。然后添加你需要的行

```
$this->getUser()->setCulture($this->getUser()->getGuardUser()->getProfile()->getLanguage()); 
```

就在重定向之前 - 所以当您已经将配置文件分配给您的用户会话时。

您可以更改设置`settings.yml`以使 sfDoctrineGuard 使用新操作：

```
all:
  .settings:
    login_module:          myCleverModule
    login_action:          signinMyUser 
```

您还可以在您的 中创建一个文件夹，在那里`app/appName/modules/sfGuardAuth/actions`创建一个`actions.class.php`并将您的`executeSignin()`函数放入此文件中。它将自动覆盖插件中的原始文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:36:24.697

在身份验证之前，您无权访问 sfGuardUser 对象。这并不意味着您无权从您需要的[操作实例访问 sfUser。](http://www.symfony-project.org/api/1_4/sfComponent#method_getuser)

是否行

```
$this->getUser()->isAuthenticated() 
```

不建议您在调用用户时不一定对用户进行身份验证。

因此，如果那条线没有设置文化，请寻找其他地方。我将首先检查请求中是否存在文化，这种形式可能会覆盖您的前一行，因此请尝试交换它们。

在 Symfony 中，sfUser 代表一个 PHP 会话，它在用户登录而不是用户之前启动。您尝试通过 sfUser::setAttribute 操作会话数据，这样应该可以工作。

# php - 检查属性是否存在而不收到“节点不再存在”警告

> ID：15101478
> 
> 赞同：10
> 
> 时间：2013-02-26T23:27:18.623
> 
> 标签：php, xml, drupal, error-handling, simplexml

我正在使用 SimpleXML。如果用户对我的函数的输入无效，我的变量`$x`是一个空的 SimpleXMLElement 对象；否则，它有一个填充的属性`$x->Station`。我想检查是否`Station`存在。

```
private function parse_weather_xml() {
    $x = $this->weather_xml; 
    if(!isset($x->Station)) {
        return FALSE;
    }

    ...
} 
```

这就是我想要的，除了它返回一个错误：

> 警告：WeatherData::parse_weather_xml()：节点不再存在于 WeatherData->parse_weather_xml()（vvdtn.inc 的第 183 行）。

好的，就这样`isset()`出来了。让我们试试这个：

```
private function parse_weather_xml() {
    $x = $this->weather_xml; 
    if(!property_exists($x, 'Station')) {
        return FALSE;
    }

    ...
} 
```

这行为几乎相同：

> 警告：property_exists()：节点不再存在于 WeatherData->parse_weather_xml()（vvdtn.inc 的第 183 行）

好吧，好吧，我把它变成一个例外，不予理会。我以前从未这样做过，我不确定我做得对，但我会试一试：

```
function crazy_error($errno, $errstr, $errfile, $errline) {
    throw new ErrorException($errstr, $errno, 0, $errfile, $errline);
}

...

    private function parse_weather_xml() {
        set_error_handler('crazy_error');
        $x = $this->weather_xml; 
        if(!property_exists($x, 'Station')) {
            return FALSE;
        }
        restore_error_handler();

        ...
    } 
```

这将返回它自己的 HTML 页面：

> # 处理异常时抛出额外的未捕获异常。
> 
> ## 原来的
> 
> ErrorException: property_exists(): 节点不再存在于 crazy_error() 中（vvdtn.inc 的第 183 行）。
> 
> ## 额外的
> 
> ErrorException: stat(): stat failed for /sites/default/files/less/512d40532e2976.99442935 in crazy_error()（/includes/stream_wrappers.inc 的第 689 行）。
> 
> * * *

所以现在我歇斯底里地笑着放弃了。如何检查 SimpleXML 对象的属性是否存在而不会以一种或另一种形式出现此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:33:58.057

你想检查你是否`simplexml`包含某个节点吗？--> 数一数！

编辑：节点不存在时的错误->尝试xpath：

```
if ($xml->xpath("//station")->Count()==0) echo "no station!"; 
```

* * *

如果没有站节点将抛出错误：

Say `$xml`is your `simplexml`and `station`is on the top level：

```
 if ($xml->station->Count()==0) echo "no station!"; 
```

如果“站”是，比如说，一个孩子`<something>`，你当然会去......

```
... $xml->something->station->Count(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-30T21:56:40.983

首先检查您是否错误地尝试访问属性而不检查您尝试检查的代码位（有时错误消息与行号不准确）。

然后我使用了isset，它工作正常：

```
 if(isset($xml->element))
 {
      // $xml has element 
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-01T05:18:59.410

```
if (!$x || !$x->Station) {
    return false;
} 
```

重要的事情 -`!$x`你需要检查这个 xml 对象是否为空。如果这是真的，那么在任何尝试解决`$x->Station`时，您都会收到此错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-02T08:11:46.940

你试过`property_exists()`吗？

```
private function parse_weather_xml() {
  $x = $this->weather_xml; 
  if(!property_exists($x,"Station")) {
    return FALSE;
  }
...
} 
```

并考虑到这个注释：

```
As opposed with isset(), property_exists() returns TRUE even if the property has the value NULL. 
```

# asp.net-mvc-3 - 如何确保属性被映射为可观察的

> ID：15101479
> 
> 赞同：1
> 
> 时间：2013-02-26T23:27:29.847
> 
> 标签：asp.net-mvc-3, knockout.js, knockout-mapping-plugin

所以我有一个这样的 ViewModel：

```
public class ViewModel{
   // Constructors, other properties
   public List<ItemViewModel> Items { get; set; }
   public ItemViewModel SelectedItem {get;set;}

   public void InitializeViewModel(){
       //Case 1:
       SelectedItem = null;
       //Case 2:
       SelectedItem = Item.FirstOrDefault();

   }
} 
```

在我的cshtml中，我有以下内容：

```
var viewModel = ko.mapping.fromJS(@Html.Raw(Model.ToJson())); 
```

我注意到的是**ko.mapping.fromJS将***案例 1*绑定为可观察的。但是，当设置*案例 2*时，ko.mapping.fromJS 不会将 SelectedItem 映射为可观察的。

如何设置我的代码以便实现 Case2 并且 ko.mapping.fromJS 映射 SelectedItem 属性？

这是破解代码：[https ://skydrive.live.com/redir?resid=33048714B5BF3B4B!1261](https://skydrive.live.com/redir?resid=33048714B5BF3B4B!1261)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T01:48:51.150

在您的情况下， ko.mapping 会将 ItemViewModel 的属性映射到 observable 但不是 ItemViewModel 本身。如果要使 ItemViewModel 得到映射，可以将映射定义为：

```
var mapping = {
            'SelectedItem': {
                create: function (options) {
                    return ko.observable(options.data);
                }
            } 
```

并调用js转换：

```
var viewModel = ko.mapping.fromJS(@Html.Raw(Model.ToJson()), mapping); 
```

# reddit - 有没有办法使用 api 获取所有 subreddits 的列表或 json？

> ID：15101480
> 
> 赞同：15
> 
> 时间：2013-02-26T23:27:33.677
> 
> 标签：reddit

我一直在查看 API 方法，但找不到可以返回包含所有 subreddits 的 json 的方法。或者唯一的方法是通过抓取 reddit.com/reddits？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-26T23:53:14.050

`.json`在网址末尾添加： [http ://www.reddit.com/reddits.json](http://www.reddit.com/reddits.json)

# php - 如何获得多维数组的所有可能组合

> ID：15101494
> 
> 赞同：1
> 
> 时间：2013-02-26T23:28:46.400
> 
> 标签：php, arrays, multidimensional-array, foreach

好的，这里我有一个多维数组。它由 3 个数组组成，每个数组有 3 个数字。

```
$numbers = array(
    array("1", "2", "3"),
    array("4", "5", "6"),
    array("7", "8", "9"),
); 
```

我想从这些数组中生成并列出所有可能的数字组合。例如，“147”（1 来自第一个数组，4 来自第二个数组，7 来自第三个数组）、“247、347、157、257、357、167、267、367 等。 。”

重要的是第一个数字必须来自第一个数组，第二个数字来自第二个数组，第三个数字来自第三个数组。

我曾尝试使用嵌套的 foreach 循环遍历这些数组，但我无法完全弄清楚，这让我头晕目眩。希望这是有道理的，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T00:03:11.280

```
$numbers = array(
    array("1", "2", "3"),
    array("4", "5", "6"),
    array("7", "8", "9"),
);

$f_nb = $numbers['0'];
$s_nb = $numbers['1'];
$t_nb = $numbers['2'];

$final_array = array();

for($a = 0; $a<sizeof($f_nb); $a++) 
{
    for($b = 0; $b<sizeof($s_nb); $b++) 
    {
        for($c = 0; $c<sizeof($t_nb); $c++) 
        {
            $final_array[] = $f_nb["$a"] . $s_nb["$b"] . $t_nb["$c"];
        }
    }
}

print_r($final_array); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-26T23:51:21.460

```
<?php
$numbers = array(
    array("1", "2", "3"),
    array("4", "5", "6"),
    array("7", "8", "9"),
);

for ($i=0;$i<3;$i++) {
  for ($j=0;$j<3;$j++) {
    for ($k=0;$k<3;$k++) {
      echo $numbers[0][$i]+" "+$numbers[1][$j]+" "+$numbers[2][$k]+"\n";
    }
  }
}
?> 
```

我之前没有用 php 编程，所以代码可能会让你流血。尽管如此，代码仍然有效并展示了这个想法。

# data-binding - Xceed DataGridControl 绑定到 DataTable 并且已排序的列不再存在时引发异常

> ID：15101496
> 
> 赞同：1
> 
> 时间：2013-02-26T23:28:59.357
> 
> 标签：data-binding, xceed-datagrid

我正在尝试使用 Xceed ( [http://wpftoolkit.codeplex.com/](http://wpftoolkit.codeplex.com/) ) 提供的扩展 WPF 工具包社区版中提供的优秀 DataGrid。我有一个应用程序，它在一个简单的 DataGridControl 对象中显示报告的结果。用户可以从报告列表中选择报告，并且数据网格使用与报告关联的 DataTable 动态更新。每个 Report 的 DataTable 中的列在名称和数量上都可能不同。使用 WPF 中的默认控件，使用常规 MVVM 数据绑定可以正常工作。这也适用于 Xceed 的 DataGridControl，**除非使用列对数据进行排序或分组。**

发生的情况是，当对列进行排序或分组，并且 DataTable 更新为其中不包含该列的列时，DataGridControl 会引发 ArgumentException，说明正在排序的列不存在。这是一个示例异常：

> System.ArgumentException 未处理
> Message='' 类型没有名为 'SAP_MATERIAL_NUMBER' 的属性，因此无法对数据集合进行排序。
> Source=PresentationFramework StackTrace：在 System.Windows.Data.BindingListCollectionView.ConvertSortDescriptionCollection(SortDescriptionCollection sorts) 上 System.Windows.Data.BindingListCollectionView.RefreshOverride() 在 System.Windows.Data.CollectionView.Refresh() 在 System.Windows.Data。 CollectionView.EndDefer() 在 System.Windows.Data.CollectionView.DeferHelper.Dispose() 在 System.Windows.Controls.ItemCollection.SetCollectionView(CollectionView 视图) 在 System.Windows.Controls.ItemCollection.SetItemsSource(IEnumerable 值) 在 System。 Windows.Controls.ItemsControl.OnItemsSourceChanged(DependencyObject d, DependencyPropertyChangedEventArgs e) ...

这是我当前定义和绑定控件的 XAML：

```
<xcdg:DataGridControl
    Grid.Row="2"
    AutoCreateColumns="True"
    AutoRemoveColumnsAndDetailConfigurations="True"
    ReadOnly="True"
    x:Name="xceedReportResult"
    ItemsSource="{Binding SelectedReport.Report.Result}"
    FontSize="11">

    <xcdg:DataGridControl.View>
        <xcdg:TableflowView
            ShowRowSelectorPane="False"
            IsAnimatedColumnReorderingEnabled="True"
            HorizontalGridLineBrush="LightGray"
            VerticalGridLineBrush="LightGray"
            IsAlternatingRowStyleEnabled="True"
            ShowScrollTip="False">

            <xcdg:TableflowView.Theme>
                <xcdg:ClassicSystemColorTheme />
            </xcdg:TableflowView.Theme>
        </xcdg:TableflowView>
    </xcdg:DataGridControl.View>

</xcdg:DataGridControl> 
```

...根据 Xceed 论坛的一些建议，我尝试在选择新报告时运行以下代码以清除任何 SortDescriptions 或 GroupDescriptions，但这不起作用：

```
ICollectionView source = xceedReportResult.ItemsSource as DataGridCollectionView;

if (source != null)
{
    if (source.SortDescriptions != null)
    {
        source.SortDescriptions.Clear();
    }

    if (source.GroupDescriptions != null)
    {
        source.GroupDescriptions.Clear();
    }
} 
```

有没有人以这种方式使用过这个数据网格，并找到了解决这个问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T13:46:42.940

我想我找到了我的问题，或者至少找到了一种在不引发异常的情况下处理这个问题的方法。我通过 XAML 代码修改为我的网格使用显式 DataGridCollectionViewSource 声明：

```
<Control.Resources>
   <xcdg:DataGridCollectionViewSource
        x:Key="reportResultView"
        x:Name="reportResultView"
        Source="{Binding SelectedReport.Report.Result.DefaultView}"
        AutoCreateItemProperties="True"/>
</Control.Resources> 
```

然后更新我的 DataGridControl 以将其用作 ItemsSource 而不是直接绑定到 DataTable：

```
<xcdg:DataGridControl
    Grid.Row="2"
    AutoCreateColumns="True"
    AutoRemoveColumnsAndDetailConfigurations="True"
    ReadOnly="True"
    x:Name="xceedReportResult"
    ItemsSource="{Binding Source={StaticResource reportResultView}}"
    FontSize="11">

    <xcdg:DataGridControl.View>
        <xcdg:TableflowView
            ShowRowSelectorPane="False"
            IsAnimatedColumnReorderingEnabled="True"
            HorizontalGridLineBrush="LightGray"
            VerticalGridLineBrush="LightGray"
            IsAlternatingRowStyleEnabled="True"
            ShowScrollTip="False">

            <xcdg:TableflowView.Theme>
                <xcdg:ClassicSystemColorTheme />
            </xcdg:TableflowView.Theme>
        </xcdg:TableflowView>
    </xcdg:DataGridControl.View>

</xcdg:DataGridControl> 
```

一旦我这样做，如果排序或分组的列不存在，它就不再抛出异常，并且数据网格按预期更新。

# javascript - 创建 w/o 刷新后清除 text_field

> ID：15101497
> 
> 赞同：0
> 
> 时间：2013-02-26T23:29:00.540
> 
> 标签：javascript, jquery, ruby-on-rails, ajax

现在我正在使用 AJAX 创建评论。但是，当我点击输入时，文本字段仍然被填充。我希望该字段刷新（并且仍然可以在另一条评论中写）。没有错误，但它仍然没有刷新它看起来的文本字段。创建部分工作正常。

create.js/erb：（需要在这里修复第二行，以便完全替换）

```
$('#<%= dom_id(@micropost) %>').html("<%= escape_javascript(render(:partial => @micropost.comments))%>")
$("#comment_field_<%=@micropost.id%>").replaceWith("<%= escape_javascript(render 'shared/comment_form', micropost: @micropost) %>") 
```

微博/_micropost：

```
<span id="<%= dom_id(micropost) %>"><%= render micropost.comments %></span>
<span id="comment_field_<%=micropost.id%>"><%= render 'shared/comment_form', micropost: micropost if signed_in? %></span> 
```

共享/评论表格：

```
<%= form_for @comment, id:"comment_form", remote: true do |f| %>
  <%= hidden_field_tag :micropost_id, micropost.id %>
  <div id="comment_field">
    <%= link_to gravatar_for((current_user), size: 29) %>
    <%= f.text_field :content, placeholder: "Say Something...", id: "comment_text_field", :style => "width: 508px; text-indent: 5px" %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T08:49:29.217

只需要使用jquery通过设置空值来清除text_field

创建.js.erb

```
$("#comment_text_field_<%=@micropost.id%>").val("") 
```

使用唯一动态 ID 的最佳实践，但无论哪种方式都可能有效。

共享/评论表格：

```
 <%= f.text_field :content, id: "comment_text_field_#{micropost.id}" %> 
```

# haskell - Haskell - 符合标准的参数计数？

> ID：15101498
> 
> 赞同：0
> 
> 时间：2013-02-26T23:29:02.873
> 
> 标签：haskell, functional-programming

假设我有一个功能：

```
isOne :: Int -> Int -> Int
isOne x y = 
```

然后 if`x == 1`然后`y != 1`它返回`1`（其中一个参数等于 1），if`x == 1`并且`y == 1`它返回`2`（因为两者都是 1），if`x != 1`并且`y != 1`它返回`0`等等。

我不知道如何使用 if 语句（或用例）进行一次检查。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T23:35:46.423

为什么，您只需要将您的英语翻译成 Haskell：

```
if (x==1) && (y /= 1) then 1
else if (x/=1) && (y==1) then 1
... 
```

但你真的想要：

```
isOne 1 1 = 2
isOne 1 _ = 1
isOne _ 1 = 1
isOne _ _ = 0 
```

或者，甚至更短：

```
isOne x y = fromEnum (x==1) + fromEnum (y==1) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-26T23:36:08.193

最简单的方法是使用模式匹配。您可以按案例定义一个函数，这些案例按照它们发生的顺序进行解释

```
isOne 1 1 = 2
isOne 1 _ = 1
isOne _ 1 = 1
isOne _ _ = 0 
```

或者，您可以使用警卫

```
isOne x y | (x == 1) && (y == 1) = 2
          | (x == 1) && (y != 1) = 1
          | (x != 1) && (y == 1) = 1
          | otherwise            = 0 
```

再次，从上到下检查这些。也就是说，如果第一个守卫匹配，则使用第一个等式，否则尝试第二个等式，依此类推。这个也可以写

```
isOne x y | (x == 1) && (y == 1) = 2
isOne x y | (x == 1) && (y != 1) = 1
isOne x y | (x != 1) && (y == 1) = 1
isOne x y | otherwise            = 0 
```

或者

```
isOne x y | (x == 1) && (y == 1) = 2
isOne x y | (x == 1) || (y == 1) = 1
isOne x y | otherwise            = 0 
```

另一种方法是使用`if then else`表达式。

```
isOne x y = if (x == 1) && (y == 1) 
            then 2 
            else if (x == 1) || (y == 1) then 1 else 0 
```

或者你可以尝试做

```
isOne x y = (go x) + (go y) where
   go 1 = 1
   go _ = 0 
```

或其他几十种方式中的任何一种...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-26T23:36:13.227

## 方法一

使用配对`case`语句

```
isOne x y = case (x, y) of 
  (1, 1) -> 2
  (1, _) -> 1
  (0, 0) -> 0
  ... 
```

## 方法二

使用嵌套`if`语句

```
isOne x y = if x == 1 then (if y == 1 then 2 else 1) else 0 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-27T00:02:06.657

`case`我会在函数定义中或在元组上使用直接模式匹配。

但最易读的替代方案是 IMO `length [ q | q<-[x,y], q==1 ]`。

# c# - 为什么 SmtpClient SendAsync 使用 UseDefaultCredentials 和 EnableSsl 的组合抛出异常，而 Send 工作正常

> ID：15101502
> 
> 赞同：1
> 
> 时间：2013-02-26T23:29:06.747
> 
> 标签：c#, smtpclient, sendasync

我正在使用 System.Net.Mail。这个领域有一些主题，但它们是 ASP.NET 并且通常与 VB 相关。我将代码隔离为桌面骨架代码，我使用 .NET 3.5 和 C#。因此，发送适用于我尝试过的所有场景（`EnableSsl`假/真，`UseDefaultCredentials`假/真）。但`SendAsync`仅在`UseDefaultCredentials`未设置为 true 时才有效（事实证明，如果您将其明确设置为 false，它甚至可能很重要，默认情况下为 false），`EnableSsl`为 true（好的，这也可以是服务器设置），并且硬编码我的凭据. 我希望能够`SendAsync`使用`UseDefaultCredentials`. 代码：

```
void sendmail() {
  MailMessage email = new MailMessage();
  email.From = new MailAddress("tcs@software.com");
  email.To.Add("tcs@software.com");
  email.Subject = "Simple test email subject";
  email.Body = "Simple test email body";
  string mHost = "mail.software.com";
  string mUsername = @"DOMAIN\tcs";
  string mPassword = "myfreakinpassword?Really???";
  SmtpClient smtpCli = new SmtpClient(mHost);
  //smtpCli.UseDefaultCredentials = true;
  smtpCli.Credentials = new NetworkCredential(mUsername, mPassword);
  smtpCli.EnableSsl = true;
  smtpCli.SendCompleted += smtpCli_SendCompleted;
  try {
    //smtpCli.Send(email);
    smtpCli.SendAsync(email, null); // This mofo only works in this combination
  }
  catch (Exception ex) {
    Console.WriteLine(ex);
  }
}
void smtpCli_SendCompleted(object sender, AsyncCompletedEventArgs e) {
  if (e.Error != null)
    Console.WriteLine(e.Error);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T16:31:20.033

使用 Prism 之类的消息传递模式`EventAggregator`（指定`ThreadOption.BackgroundThread`）。通过这种方式，调用者发送一条消息（该消息将包含 From、To、Subject、Body），并且从发送者的角度来看它是异步的。`System.Net.Mail`然后在消息的消费者/处理程序中使用同步发送功能。这可能有效，因为正在执行的后台线程比生成`SendAsync`.

# internet-explorer - 启动时拒绝访问路径

> ID：15101503
> 
> 赞同：2
> 
> 时间：2013-02-26T23:29:09.997
> 
> 标签：internet-explorer, windows-8, silverlight-5.0

我有一个 Silverlight 5.0 应用程序在使用 Windows 8 和 Internet Explorer 访问应用程序时崩溃。它适用于任何其他组合：Windows 7 和 IE、Windows 7 和 Chrome 或 Firefox，以及 Windows 8 和 Chrome 或 Firefox。

应用程序在启动过程中很早就崩溃了。这是消息和堆栈跟踪：

**消息：**对路径“C:\Users\xxx\AppData\LocalLow\Microsoft\Silverlight\InBrowser\Profiles”的访问被拒绝。

**堆栈跟踪**

```
 at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.Directory.InternalCreateDirectory(String fullPath, String path, Object dirSecurityObj, Boolean checkHost)
   at System.IO.Directory.InternalCreateDirectoryHelper(String path, Boolean checkHost)
   at System.IO.Directory.UnsafeCreateDirectory(String path)
   at System.Windows.Application.StartMulticoreJit()
   at System.Windows.Application.Application_Starting(Object sender, StartupEventArgs e)
   at MS.Internal.CoreInvokeHandler.InvokeEventHandler(UInt32 typeIndex, Delegate handlerDelegate, Object sender, Object args)
   at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, Int32 actualArgsTypeIndex, String eventName, UInt32 flags) 
```

堆栈跟踪使它看起来在启动时 Silverlight 试图在用户的计算机上创建一个目录，但由于权限问题而失败。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T02:50:51.193

我遇到了同样的问题，只是我无法像你一样在 Windows 8 和 IE10 中自己复制它。出于某种原因，它对我有用，但我最近收到了一些来自客户的错误报告。

作为一个实验，我刚刚在包含 Silverlight 应用程序的页面上添加`IE=8`了`X-UA-Compatible`元标记，因此现在如下所示：

```
<meta http-equiv="X-UA-Compatible" content="requiresActiveX=true,IE=8" /> 
```

这解决了[IE10 的刷新错误，](http://social.msdn.microsoft.com/Forums/silverlight/en-US/db07a063-35e2-4385-bf91-fe9324ee3d31/silverlight-app-disappears-on-page-refresh-in-ie10)我希望它也能解决这个错误。我只需要等待，看看是否有更多的错误报告进来。或者你可以让我知道它是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-19T21:01:26.700

我知道这是一个非常古老的帖子，但对于其他在那里寻找解决方案的人来说：对我有用的解决方案是取消选中 Internet Explorer 选项中的一个框：

Internet 选项 -> 安全 -> 本地 Intranet -> 启用保护模式

# c++ - 重构实现

> ID：15101506
> 
> 赞同：0
> 
> 时间：2013-02-26T23:29:27.757
> 
> 标签：c++, design-patterns

我正在重构一个进行 kmean 聚类的 C++ 代码。代码有两个版本：

1.  正常kmean
2.  特征对齐聚类：使用稍微不同的距离度量和更新规则。

我应该如何有效地实施这一点？方法重载（虽然这不依赖于输入）

好的，这是进行 kmean 聚类的伪代码。我需要实现两个版本的距离和更新功能。

```
int* kmean_clustering(vector<double[10]> data)
// each row of data hold one data point
// so we have M data points of 10 dimension
{
    // Split codebook
    // Assignment step
    Find the closest codebook based on distance(distance here can be Euclidean, Mahalanobis, .....)
    //Update step
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T02:20:26.943

写得好的代码就像读一本好小说。这就是 Knuth 将其称为编程艺术的原因。[这本书](https://rads.stackoverflow.com/amzn/click/com/0201485672 "重构：改进现有代码的设计")可能会教你自下而上的重构方法。

# jquery - 为什么我的验证 ajax 调用会延迟整个验证方法？

> ID：15101513
> 
> 赞同：1
> 
> 时间：2013-02-26T23:30:11.633
> 
> 标签：jquery, jquery-validate

我正在验证一个包含用户个人资料信息的表单，并且我想检查我的服务器以查看用户指定的用户名是否已在使用中。我已经定义了一个这样的验证方法：

```
$.validator.addMethod(
    'check_username', 
    function(value, element, param) { 
        console.log('starting');
        var name_is_in_use = 0;

        // Start the throbber.
        $('form#user-profile-form input#edit-name').addClass('searching');

        // Hit the server and see if this name is already in use by someone else.
        $.ajax({
            url: '/checkusername/' + value + '/" . $form['#user']->uid . "',
            dataType: 'json',
            data: {},
            async: false,
            success: 
                function(data) {
                        console.log('back from the server');
                        name_is_in_use = data; // unnecessary, but whatever

                        // Kill the throbber
                        $('form#user-profile-form input#edit-name').removeClass('searching');
                    },
        });

        return name_is_in_use;
    },
    'Sorry, but this username is already in use.'); 
```

总体而言，验证过程有效；我遇到的问题是让输入字段上的“忙碌”脉动器正常工作——脉动器永远不会从其常规状态变为忙碌状态。但是在服务器上添加了一些 sleep() 回调以夸大那里真正发生的事情之后，我看到的是这两个 console.log 语句同时出现在控制台中——在调用服务器之后已经完成。这就解释了为什么我没有看到 throbber 变化——`.searching`该类在添加后立即被删除。但我不明白的是为什么我没有看到我认为**应该**发生的事情：

1.  我单击浏览器中的字段以触发验证方法。
2.  `console.log('starting')`出现在控制台中
3.  颤动器被打开。
4.  服务器被调用时有一个暂停，稍微休眠，并返回它的值，
5.  `console.log('back')`出现在控制台中
6.  颤动器被关闭。

相反，我得到了这个（忽略 throbber 类的变化）：

1.  我单击浏览器中的字段以触发验证方法。
2.  服务器被调用时有一个暂停，稍微休眠，并返回它的值，
3.  `console.log('starting')`出现在控制台中，然后，没有延迟，
4.  `console.log('back')`出现在控制台中

第 3 步和第 4 步几乎同时发生。

我对此感到非常困惑——看起来处理程序的整个执行都被 ajax 调用所阻碍，这对我来说根本没有意义。有人可以提供一些见解吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:32:33.710

这很简单，那是因为您在通话中设置**`async`**为。**`false`**`$.ajax`

您正在发出一个**同步**请求，通常当这样的事情完成时，Web 浏览器在等待来自服务器的响应时往往看起来像挂起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T02:35:50.543

好的，我有一些东西不仅有效，而且看起来相对有原则。想到它可能对其他人有用...

```
$('form#user-profile-form').validate({
    debug: true,
    rules: {
        name: {
            required: true,
            regexp: /\W/,
            remote: {
                url: '/checkusername',
                type: 'post',
                data: {
                    username: function () { return $('#edit-name').val() },
                    uid: " . $form['#user']->uid . "
                    },
                beforeSend: function (jqXHR, settings) {
                                $('form#user-profile-form input#edit-name').addClass('searching');
                            },
                complete: function (jqXHR, settings) {
                                $('form#user-profile-form input#edit-name').removeClass('searching');
                            },
            }
        }
    },

    messages: {
        name: {
            regexp: '" . USERNAME_VALIDATION_MESSAGE . "',
            remote: 'Sorry, but this username has been claimed by someone else.',
            },
        ...
        },
    errorPlacement: function(error, element) {
        switch (element.attr('name')) {
            case 'name':
                error.insertAfter('.control-group.form-item-name > label');
                $('form#user-profile-form input#edit-name').removeClass('searching');
                break;
             ... 
```

这里有一些注意事项：

*   繁重的工作是通过`remote`选项完成的，正如文档所说，该选项适用于这样的事情。如果用户名可用，则 URL 另一端的代码返回 JSONed 1/true，否则返回 0/false。
*   在服务器调用发生之前，`beforeSend`处理程序在验证的一开始就打开 throbber。
*   `complete`在用户指定了非冲突名称的情况下，处理程序会关闭颤动器。
*   在服务器调用返回并报告错误的情况下，调用关闭会关闭颤动器`removeClass`。`errorPlacement`
*   由于我有两个规则`username`——已经在使用的测试和一个正则表达式测试以确保指定的名称是一个“单词”——我必须在该`messages`部分中为每个规则指定适当的消息。

呸。欢迎评论；感谢大家的帮助！

# java - 在 java 7 中识别和替换字符串的一部分

> ID：15101516
> 
> 赞同：2
> 
> 时间：2013-02-26T23:30:47.183
> 
> 标签：java, string, filter, replace, minecraft

我想用另一个字符串替换字符串的一部分。例如，一个字符串进来，它包含`meat`，但我希望它把它`meat`改成**`vegetable`**. 我知道我可以用以下语句做到这一点。

`str = str.replaceAll("meat", "vegetable");`

但是，我需要有确切的大小写。无论示例中的字母是大写还是小写，我都在寻找一种方法`meat`。

我的应用程序是 Minecraft 的过滤器。要么发誓，要么只是定制菜单。就像我想替换单词的每个实例一样`minecraft`，无论大小写如何`Best game Ever!!`。

我已经对其进行了修改，以便它可以识别和替换特定的大写字母，但这是非常有限的。

我希望我提供了足够的信息，以便有人可以帮助我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-26T23:34:35.223

`(?i)`您可以通过在开始时添加标志来使正则表达式不区分大小写

```
str = str.replaceAll("(?i)meat", "vegatable"); 
```

例子

```
System.out.println("aBc def".replaceAll("(?i)abc","X")); // out: "X def" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-26T23:35:34.813

的第一个参数`replaceAll`是一个正则表达式，您可以在表达式中嵌入一个标志以使其不区分大小写：

```
str = str.replaceAll("(?i)meat", "vegatable"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-26T23:36:18.497

另一种方式：这里的标志不是明确地在正则表达式中，而是作为单独的参数传递。

```
String input = "abc MeAt def";
Pattern pattern = Pattern.compile("meat", Pattern.CASE_INSENSITIVE);
Matcher matcher = pattern.matcher(input);
String output = matcher.replaceAll("vegetable");
System.out.println(output); 
```

# php - preg_match 有可能吗？

> ID：15101517
> 
> 赞同：0
> 
> 时间：2013-02-26T23:30:48.740
> 
> 标签：php, regex, preg-match

我有看起来像这样的字符串：

```
"size:34,35,36,36,37|color:blue,red,white" 
```

是否可以匹配 preg_match(_all) 中的所有颜色？这样我会在输出数组中得到“蓝色”、“红色”和“白色”？

颜色可以是任何颜色，所以我不能去（蓝色|红色|白色）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:37:02.360

1.  爆发`|`
2.  爆发`:`
3.  爆发`,`
4.  `???`
5.  利润！

## 代码

恕我直言，使用其他答案中建议的正则表达式是一个比这样简单的解决方案更“丑陋”的解决方案：

```
$input = 'size:34,35,36,36,37|color:blue,red,white|undercoating:yes,no,maybe,42';

function get_option($name, $string) {
    $raw_opts = explode('|', $string);
    $pattern = sprintf('/^%s:/', $name);
    foreach( $raw_opts as $opt_str ) {
        if( preg_match($pattern, $opt_str) ) {
            $temp = explode(':', $opt_str);
            return $opts = explode(',', $temp[1]);
        }
    }
    return false; //no match
}

function get_all_options($string) {
    $options = array();
    $raw_opts = explode('|', $string);
    foreach( $raw_opts as $opt_str ) {
        $temp = explode(':', $opt_str);
        $options[$temp[0]] = explode(',', $temp[1]);
    }
    return $options;
}

print_r(get_option('undercoating', $input));
print_r(get_all_options($input)); 
```

输出：

```
Array
(
    [0] => yes
    [1] => no
    [2] => maybe
    [3] => 42
)
Array
(
    [size] => Array
        (
            [0] => 34
            [1] => 35
            [2] => 36
            [3] => 36
            [4] => 37
        )

    [color] => Array
        (
            [0] => blue
            [1] => red
            [2] => white
        )

    [undercoating] => Array
        (
            [0] => yes
            [1] => no
            [2] => maybe
            [3] => 42
        )

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:38:25.387

你可以用一种方式来实现它，`preg_match_all()`但我建议你用explode代替。

```
preg_match_all('/([a-z]+)(?:,|$)/', "size:34,35,36,36,37|color:blue,red,white", $a);
print_r($a[1]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:45:03.070

我认为[向后看](http://www.regular-expressions.info/lookaround.html)是可能的：

```
 /(?<=(^|\|)color:([^,|],)*)[^,|](?=\||,|$)/g 
```

[（对于`preg_match_all`）]

您的爆炸解决方案显然更清洁:-)

# php - 原则 2 配置和性能

> ID：15101519
> 
> 赞同：0
> 
> 时间：2013-02-26T23:31:00.197
> 
> 标签：php, performance, configuration, doctrine-orm, wamp

我的本地主机上的 Doctrine 2 有一些问题。仅使用一个查询的一页在大约 1.5 秒内加载到本地主机上。同时，在远程服务器上加载大约需要 300 毫秒（[http://gieromaniak.pl/contact](http://gieromaniak.pl/contact)）。我不知道可能出了什么问题。是 Doctrine 2 配置还是其他？或者我的服务器上没有一些 PHP 扩展（WAMP - Apache 2.4.2、PHP 5.4.3）？

尽管如此，我还是包含了我的 Doctrine 配置文件的源代码：

```
<?php
use Doctrine\Common\ClassLoader,
    Doctrine\ORM\Configuration,
    Doctrine\ORM\EntityManager,
    Doctrine\DBAL\Types\Type,
    Doctrine\Common\Cache\ArrayCache,
    Doctrine\DBAL\Logging\EchoSqlLogger;

// include the class loader directly
require_once __DIR__ . '/Doctrine/Common/ClassLoader.php';

$doctrineClassLoader = new ClassLoader('Doctrine', __DIR__ . '/');
$doctrineClassLoader->register();

Config::load('base');
Config::load('database');

if(Config::get('base.mode') == 'development') {
    $bProxyGen = TRUE;
} else {
    $bProxyGen = FALSE;
}

// Set up caches
$cache = new ArrayCache;
$config = new Configuration;
$config->setMetadataCacheImpl($cache);
$config->setQueryCacheImpl($cache);

// Metadata Driver
$driverImpl = $config->newDefaultAnnotationDriver($models);
$config->setMetadataDriverImpl($driverImpl);

// Proxy configuration
$config->setProxyDir(PATH_ROOT.Config::get('database.proxy_dir'));
$config->setProxyNamespace(Config::get('database.proxy_namespace'));
$config->setAutoGenerateProxyClasses($bProxyGen);

// Database connection information
$connectionOptions = array(
    'driver' => 'pdo_mysql',
    'charset' => 'utf8',

    'dbname' => 'dbname',
    'user' => 'username',
    'password' => 'password',
);

// Create EntityManager
$entityManager = EntityManager::create($connectionOptions, $config); 
```

预先感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T05:34:29.583

我建议安装 apc 并提高 mysql 性能：

## 安装 APC

我强烈建议为此使用 Wamp 服务器 (x86)，x64 版本的 windows 的 apc.dll 不能正常工作。

按照[本](http://docs.moodle.org/24/en/Installing_APC_in_Windows)教程进行以下修改：

*   [apc.dll](http://dev.freshsite.pl/php-accelerators/apc.html)的链接
*   从您的 phpinfo()中找到**Zend Extension Build**或**PHP Extension Build**；你可以将它`http://localhost/?phpinfo=1`用于你的 WAMP 本地主机
*   **Zend Extension Build**应该是这样的：

> API220100525,TS,VC9

*   注意TS字，可以为空；看看他们是否是一个不同的词，比如 NTS
*   根据TS或NTS值下载最新版本
*   重命名 dll php_apc.dll
*   将 php_apc.dll 放入`YourWampFolder/bin/php/ext/`
*   wamp 中有 2 个 php.ini 文件：`wamp\bin\apache\apacheX.X.XX\bin\`并且`wamp\bin\php\phpX.X.X\`（用您的版本替换 XX..）写入`extension=php_apc.dll;`它们
*   关闭/打开 Wamp（不重启）
*   从 wamp icon->php->PHP extensions->php_apc.dll 检查激活
*   重启 wamp

您可以通过将 apc.php 文件下载到您的项目目录中来验证 APC 是否正在运行。您[可以在 PECL 网站上的压缩文件](http://pecl.php.net/package/APC)中找到它。获取最新版本。

现在从您的浏览器：`http://localhost/yourproject/apc.php`

您可以从 php.ini 修改 APC 的设置（同时尝试）

例子：

```
//php.ini
...

[APC]
apc.ttl=7200
apc.user_ttl=7200
apc.shm_segments=3
apc.shm_size=90M
apc.max_file_size = 2M
apc.include_once_override = 1 
```

以防万一你想清除缓存

```
// resetcache.php
<?php
if ( $_GET['pass'] == 'yes') {
if(function_exists('apc_clear_cache')){
        if (apc_clear_cache() && apc_clear_cache('user'))
                print 'All Clear!';
        else
                print 'Clearing Failed!';

        print '<pre>';
        print_r(apc_cache_info());
        print '</pre>';
}else print "fuction_doesn't exist";
        } else {
        print 'Authenticate, please!';
} 
```

`apc.php`我设置了一些额外的安全性来防止不必要的访问，但不包括`clearcache.php`在生产服务器中。

## 提高 Mysql 性能

1.  [链接1](https://dba.stackexchange.com/questions/18614/wamp-server-performance-tuning-for-mysql)
2.  [链接2](http://forums.kayako.com/threads/mysql-performance-improvement-tips.25331/)
3.  [链接3](http://www.mysqlperformanceblog.com/2006/09/29/what-to-tune-in-mysql-server-after-installation/)

## 清理本地机器

您可以清理浏览器缓存和临时文件夹。[清洁工](http://www.filehippo.com/download_ccleaner/)

这就是我过去为提高本地机器上 Doctrine2 的速度所做的一切。您还可以监视 Mysql/Apache 进程使用的 RAM，以查看是否不需要购买/分配更多 RAM。

# jqgrid - jqGrid：Microsoft JScript 运行时错误：无法获取属性“整数”的值：对象为空或未定义

> ID：15101521
> 
> 赞同：3
> 
> 时间：2013-02-26T23:31:27.550
> 
> 标签：jqgrid

我在 jqGrid.src.js 的这行代码中得到了上述异常

```
fmt = $.jgrid.formatter.integer || {}; 
```

我这辈子都不能告诉你这意味着什么，或者为什么我不能让这该死的东西工作。我怀疑这与我构建 json 对象的方式有关。

```
 for(int j = rowstart; (j <= rowend && variable.Template.Count > j); j++){
            PatientACOModel patMod = variable.Template[j];
            var rowData = new{
                id = patMod.EncounterId,
                cell = new {
                    MRN = patMod.MRN,
                    Hospital_Fin = patMod.HospitalFinNumber,
                    First_Name = patMod.FirstName,
                    Last_Name = patMod.LastName,
                    Date_of_birth = patMod.DateOfBirth
                }
            };
            al.Add(rowData);
        }

        var griddata = new {
            total = variable.Template.Count % rows > 0 ? (variable.Template.Count / rows) + 1 : (variable.Template.Count / rows),
            page = page,
            records = al.Count,
            rows = al.ToArray()
        }; 
```

我不知道我做错了什么？看起来一切都设置正确？

**更新** 这将是发送回我的 jqGRid 的 json 数据......这些只是一小部分行和列。我在这里错过了什么吗？

```
{"total": 2,
"page": 1,
"records": 15,
"rows": [{
    "id": 2148,
    "cell": {
        "MRN": "840134833",
        "Hospital_Fin": "987141516",
        "First_Name": "YELLOW",
        "Last_Name": "CRAYON",
        "Date_of_birth": "\/Date(1253160000000)\/"          
    }
},
{
    "id": 1898,
    "cell": {
        "MRN": "785528039",
        "Hospital_Fin": "6669511596226",
        "First_Name": "RAYFIELD",
        "Last_Name": "BOYD",
        "Date_of_birth": "\/Date(-720298800000)\/"
    }
}]} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T01:35:48.283

要消除此错误，您需要确保**包含**本地化文件

```
<script src="~/Scripts/i18n/grid.locale-en.js"></script> 
```

**在 jqGrid**文件之前。这为我消除了问题。

# html - 如何在流体布局中将 ul 内的列表居中？

> ID：15101526
> 
> 赞同：1
> 
> 时间：2013-02-26T23:31:38.723
> 
> 标签：html, css

html

```
<div class="wrapContent">
   <ul>
      <li>Lorem</li>
      <li>Lorem</li>
      <li>Lorem</li>
   </ul>
</div> 
```

.wrapper 是一个流体 div，我试图将浮动的左侧列表居中放在页面上。基本上能够在 ul 中的第一个和最后一个 li 具有相同的左/右距离。

目前我做：

```
.wrapContent {
   width: 100%;
   margin: 0 auto;
}

.ul {
   width: 100%;
   margin: 0 auto;
}

.li {
   width: 250px;
   margin: 0 auto;
   float: left;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:40:31.923

不要漂浮它们。（这是您应该在问题中包含的重要细节...... :)）`display`改为使用。

```
ul {
    text-align: center;
}
li {
    display: inline-block;
    text-align: left;  /* optional */
} 
```

现在`li`每个 s 都会*像*内联元素一样，但会保留其内容的结构，并且您可以像其他任何东西一样将它们居中。

顺便说一句，您不需要`width: 100%;`在块元素上使用；它们会自动扩展以适应容器的宽度。

# jquery-ui - 如何使用嵌套下拉菜单使 jQuery UI 可排序？

> ID：15101530
> 
> 赞同：2
> 
> 时间：2013-02-26T23:32:10.200
> 
> 标签：jquery-ui, drop-down-menu, jquery-ui-sortable

我已经阅读了与我在此处发布的问题类似的所有内容，但没有找到任何解决方案。

我在下拉菜单中创建了一个带有子菜单条目的菜单。所有菜单条目都可排序到所有菜单级别。根菜单条目到子列表和其他方式。

几乎一切正常，但排序到第一个下拉列表会导致错误。更不可能在第一个下拉列表之前对菜单条目进行排序，也不能在第一个下拉列表中进行排序。通过尝试在第一个下拉列表中排序，占位符代码在邻居（最后一个）下拉列表中产生，并且在停止排序时，条目也在最后一个下拉列表中，而不是在第一个下拉列表中。排序到其他下拉列表没有这种行为。也许有人对此有想法？

这是 js 小提琴：http: [//jsfiddle.net/dehil/Vy4pu/1/](http://jsfiddle.net/dehil/Vy4pu/1/)

```
$('ul').sortable({ //    
    connectWith: $('ul'),
    items: 'li',
    placeholder: 'pf_sortable-placeholder',
    tolerance: 'pointer',
    cursor: 'pointer',
    cursorAt: {
        top: -20
    },
    zIndex: 20000,
    placeholder: 'pf_sortable-placeholder',
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:56:03.663

使用 jQuery UI 嵌套列表总是有点尴尬。最近我发现[http://johnny.github.com/jquery-sortable/](http://johnny.github.com/jquery-sortable/)可以用来对引导导航进行排序。

请参阅[http://johnny.github.com/jquery-sortable/#bootstrap](http://johnny.github.com/jquery-sortable/#bootstrap)。

# android - Livecode 互动广告 Android

> ID：15101533
> 
> 赞同：2
> 
> 时间：2013-02-26T23:32:33.337
> 
> 标签：android, ads, livecode

我正在 Android 平台上使用 Livecode v5.5.4 ... 我已经能够成功发布应用程序，但是，无法弄清楚如何安装 inneractive 广告... 由于 LC 与 inneractive 合作，他们提供了方向建议它就像...一样简单

```
mobileAdRegister "YOUR-AD-KEY" //I've replaced with my APP ID from inneractive

local tDetails

put "30" into tDetails["refresh"] // The advert refresh interval in seconds
put 25 into tDetails["age"] // The age of the target audience
put "male" into tDetails["gender"] // The expected gender of the target audience 
mobileAdCreate "myAd1", "banner", (0,0), tDetails 
```

但是，似乎没有任何效果......有任何LC ppl有建议吗？？......谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T03:05:48.680

如果 Mark 的建议没有报告错误，您可能希望确保它通过以下方式可见：

```
mobileAddSetVisible "myAd1",true 
```

如果失败了，您能否发布 mobileAds 函数的结果并让我们知道是否正在将 adLoaded 或 adLoadFailed 消息发送到执行 mobileAdCreate 的对象？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T00:45:53.047

您需要检查结果的值：

```
mobileAdCreate "myAd1","banner",(0,0),tDetails
put the result into rslt
if rslt is not empty then
  beep
  answer error rslt
end if 
```

亲切的问候，

标记

# sql - Rails - 如何根据日期从数据库中获取最接近的记录？

> ID：15101539
> 
> 赞同：1
> 
> 时间：2013-02-26T23:32:56.877
> 
> 标签：sql, ruby-on-rails, ruby, date

我在数据库中存储了这样的记录：

```
ID| date_column
1 | 2013-02-10 10:00:00
2 | 2013-02-10 11:00:00
3 | 2013-02-10 12:00:00
4 | 2013-02-10 13:00:00
5 | 2013-02-11 14:00:00
6 | 2013-02-11 22:00:00 
```

我正在尝试获取 3 条记录，它们是最接近今天日期的记录。例如，假设今天是`2013-02-10`，所以我需要获取 3 条具有今天日期（`2013-02-10 11:00:00`、`2013-02-10 12:00:00`、`2013-02-10 13:00:00`）的记录，但例如如果今天是`2013-02-15`，我需要获取最接近的 3 条记录，在这种情况下是`2013-02-10 13:00:00`，`2013-02-11 14:00:00`并且`2013-02-11 22:00:00`？

你能帮我吗，请，怎么做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:40:53.900

假设您使用的是 ActiveRecord 对吗？

**此查询将获取过去**最接近“现在”的三个日期：

```
time_to_check = Time.now
TableObjectName.where("date_column <= ?", time_to_check ).limit(3).order("date_column desc") 
```

**此查询将获取未来**最接近“现在”的三个日期：

```
TableObjectName.where("date_column >= ?", time_to_check ).limit(3).order("date_column desc") 
```

我唯一能想到的，这似乎效率低下，但我想不出这样做的 SQL 方式，你现在有两个数组，基本上有六个记录。

未来的三个（如果有的话） 过去的三个（如果有的话）。

`timeToCheck`然后我会遍历每一个，并比较变量中每条记录之间经过了多少时间。

无论哪三个具有最小的时间差，将它们添加到您的最终数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T01:39:30.170

这将使 3 关闭到特定时间，我在您的目标日期使用中午。这将确保今天的结果领先于其他任何一天。

```
TableObjectName.all(order: "abs(timediff('2013-02-10 12:00:00', date_column))", limit: 3). 
```

# javascript - 根据选定的单选按钮隐藏

> ID：15101540
> 
> 赞同：1
> 
> 时间：2013-02-26T23:32:58.593
> 
> 标签：javascript, jquery, html, radio-button

我想根据从单选按钮中选择的值隐藏表格行。这些单选按钮是根据从下拉列表框中选择的值创建的。

这是我的代码

**列表框的 HTML 代码**

```
<select name="txtLT" id="LT" >
    <option value="a">a</option>
    <option value="b">b</option>
    <option value="c">c</option>
</select> 
```

**jQuery**

```
$(document).ready(function() {
    $("#LT").change(function() {
        var selVal = $(this).val();
        $("#tblerow").html('');
        if(selVal == 'c') {
            $("#tblerow").append('<td><input type="radio" id="cmpof" name="cmpof" value="1" onclick="show()" />1 <input type="radio" id="cmpof"  name="cmpof" value="2"  onclick="hide()"/>2</td>');            
        }
    });
}); 
```

现在如果选择了单选按钮 2，那么带有 tr2 的表格行应该会消失。请帮助我找到解决方案。

**编辑**

我尝试了以下 JavaScript，但它没有隐藏该行。

```
function show() { document.getElementById('sbjrow').style.display = 'block'; }
function hide() { document.getElementById('sbjrow').style.display = 'none'; } 
```

你能建议这里有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:51:49.830

你可以像这样使用 jQuery 的`hide`and`show`函数：

```
$(function () {
    $('#LT').change(function () {
        if ($(this).val() == 'c') {
            $('.radios').show();
        } else {
            $('.radios').hide();
        }
    });
    $('input[name=cmpof]').change(function () {
        if ($('#LT').val() == 'c' && $(this).val() == 'bar') {
           $('#table tr').eq(1).hide(); 
        } else {
           $('#table tr').eq(1).show(); 
        }
    });
}); 
```

如果您不希望默认显示表格行，只需使用 css 即可。

JsFiddle 示例： http: [//jsfiddle.net/AX5TJ/1/](http://jsfiddle.net/AX5TJ/1/)
可能更接近您想要的更新版本：http: [//jsfiddle.net/AX5TJ/2/](http://jsfiddle.net/AX5TJ/2/)

还要小心，你的脚本中有一个语法错误：当你定义时`$("#LT").change(function() {`，你必须用`});`

# ruby - Ruby Koans - 词汇范围与继承层次结构的延续

> ID：15101544
> 
> 赞同：3
> 
> 时间：2013-02-26T23:33:30.117
> 
> 标签：ruby, inheritance, namespaces, lexical-scope

我有机会在 StackOverflow 中环顾四周，发现了同样的问题，我试图从 Ruby Koans 中更好地理解这个问题（[Ruby Koans：类定义上的显式作用域第 2 部分](https://stackoverflow.com/questions/5464811/ruby-koans-explicit-scoping-on-a-class-definition-part-2)）。

```
class MyAnimals
  LEGS = 2

  class Bird < Animal
    def legs_in_bird
      LEGS
    end
  end
end

def test_who_wins_with_both_nested_and_inherited_constants
  assert_equal 2, MyAnimals::Bird.new.legs_in_bird
end

# QUESTION: Which has precedence: The constant in the lexical scope,
# or the constant from the inheritance heirarachy?

# ------------------------------------------------------------------

class MyAnimals::Oyster < Animal
  def legs_in_oyster
    LEGS
  end
end

def test_who_wins_with_explicit_scoping_on_class_definition
  assert_equal 4, MyAnimals::Oyster.new.legs_in_oyster
end

# QUESTION: Now Which has precedence: The constant in the lexical
# scope, or the constant from the inheritance heirarachy?  Why is it
# different than the previous answer? 
```

根据链接中的解释，其他人（包括我自己）的主要困惑似乎是因为类定义：

```
class MyAnimals::Oyster < Animal
  # stuff goes in here
end 
```

我最初的想法是 MyAnimals::Oyster 意味着 Oyster 类是在 MyAnimals 中定义的。换句话说，我认为上面的代码类似于下面的代码：

```
class MyAnimals
  class Oyster < Animal
    # stuff goes in here
  end
end 
```

为了测试我的想法，我在 IRB 中做了以下操作：

```
class MyAnimals
  LEGS = 2

  class Bird < Animal
    def legs_in_bird
      LEGS
    end
  end
end

class MyAnimals::Oyster # You should notice that I'm not inheriting from Animal anymore
  def legs_in_oyster
    LEGS
  end
end 
```

如果我的推理是正确的，那么我希望下面的代码返回 2

```
MyAnimals::Oyster.new.legs_in_oyster # => NameError: uninitialized constant MyAnimals::Oyster::LEGS 
```

由于这不返回 2，有人可以向我解释为什么它不返回 2？

编辑：我忽略了添加 Animal 类；这里是：

```
class Animal
  LEGS = 4
  def legs_in_animal
    LEGS
  end

  class NestedAnimal
    def legs_in_nested_animal
      LEGS
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-21T20:56:23.650

回到 Ruby 搜索值的顺序。第 1 步是“封闭范围”。当您定义这样的嵌套类时

```
class Animal
    class Bird
    end
end 
```

'Bird' 包含在 'Animal' 范围内。

当你这样做时

```
class Animal
end

class Animal::Bird
end 
```

尽管您已将“Bird”定义为嵌套在“Animal”中，但在您定义“Bird”时，封闭范围是***全局***范围。返回 IRB 并定义`LEGS = 0`（在全局范围内）并再次尝试您的 Oyster。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-21T20:51:28.890

在严格词法/静态范围的语言（如 C++ 或 Java）中，通过简单地检查当前范围来解析标识符，将范围向上提升一个范围并重复直到达到最基础的范围。例如：如果您的示例是 C++，则首先在调用类 Bird/Oyster 中搜索 LEGS，然后是 Animal，然后是 My Animal。

Ruby 有一种动态作用域。每个对象，即使它位于同一个“位置”，也可以有自己的范围查找顺序，具体取决于它在运行时的定义或创建方式。您可以将每种方法视为具有要搜索的范围堆栈，并且它的定义方式会将新范围推入该堆栈。

由于 Bird 的定义方式（BaseScope 不是它的真实名称，您没有提供足够的代码来提供此名称），以及`BaseScope::MyAnimals::Bird`搜索`BaseScope::MyAnimals::Animal`解析名称。`BaseScope::MyAnimals``BaseScope`

虽然第一只牡蛎只得到`BaseScope::MyAnimals::Oyster`,`BaseScope::MyAnimals::Animal`和`BaseScope`。

没有继承的牡蛎变得更少，只是`BaseScope::MyAnimals::Oyster`和`BaseScope`。

此示例中每次使用 class 关键字和继承都会将另一个作用域推送到作用域堆栈上，以便搜索其内容。因此，`class MyAnimals::Oyster`仅使用将一个条目推入此堆栈。

## 编辑

为简单起见，我省略了方法legs_in_oyster。这是一个可以搜索的范围。它的简单定义是不言自明的，包括它会给这个答案添加很多无用的文本。

为简单起见，我还省略了全局范围。我知道 Koans 在 BaseScope 和全局范围之间或之间至少有一个范围。

# javascript - Javascript，Do While Loop 多个选项

> ID：15101553
> 
> 赞同：1
> 
> 时间：2013-02-26T23:34:19.823
> 
> 标签：javascript

您能否解释并显示正确答案：

```
<p id="show"></p>

<script>

var a = "word1";
var b = "word2";

do {
    color = prompt("Write a word1 or word2 to get out of loop", "");
} while (color != a || color != b);

document.getElementById("show").innerHTML=color;

</script> 
```

当我删除“b”选项并仅使用“a”选项保持原样时，它可以工作。那么如何将它用于多个选项？此外，如果您有一个解决方案来保持简单，例如我有 15 个选项，那就太好了！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T23:35:25.640

检查某件事是否不是一件事，**或者**不是另一件事，总是正确的。我想你想`&&`不想`||`。

更一般地说，如果您有很多选项，那么如果值是字符串（或容易字符串化的东西），那么一个好的模式是：

```
var badValues = {
  "a": 1, "b": 1, "c": 1, ...
};

do {
  color = prompt("Write a word1 or word2 to get out of loop", "");
} while (!badValues[color]); 
```

您可以翻转逻辑来处理“白名单”而不是“黑名单”。

*编辑*——一个有见地的评论（现已删除）指出，我的说法是，只有当“a”与“b”真正不同时，`||`比较才会始终有效。`true`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:45:11.653

您可以简单地使用数组并检查字符串是否在数组中。

```
var words = ["word1", "word2", "word3"];

do {
    color = prompt("Write a " + words.join(' or ') + " to get out of loop", "");
} while (words.indexOf(color) === -1);

document.getElementById("show").innerHTML = color; 
```

# mysql - Magento DB 客户订单映射

> ID：15101554
> 
> 赞同：0
> 
> 时间：2013-02-26T23:34:28.780
> 
> 标签：mysql, magento

Magento 订单如何映射到客户？订单是否包含客户 ID 或客户是否包含所有订单 ID？试图弄清楚更改订单号是否会弄乱客户映射。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T06:13:42.640

让我先回答你的问题

**Magento 订单如何映射到客户？**

> **Magento 订单使用订单表"sales_flat_order","sales_flat_order_grid","sales_flat_order_address"中的 "** **customer_id** " 外键字段映射到客户。并且客户实体没有依次引用订单。

 ****订单是否包含客户 ID 或客户是否包含所有订单 ID？**

> **订单仅包含客户 ID，反之亦然。**基本上客户实体遵循产品和类别等 EAV 结构。

**现在来完成更改订单号的任务（技术字段名称 increment_id）。**

> 是的，您可以更改订单的增量编号。您需要在两个表中执行此操作

```
1\. sales_flat_order
2\. sales_flat_order_grid 
```

> 请确保在完成更改订单号的任务后**重置实体类型 ID“5”的订单增量最后一个 ID ，该 ID 代表订单。**您应该在表“ **eav_entity_store** ”中执行此操作

如果您需要有关此的更多信息，请告诉我。**

# macos - 终端：shell 启动文件在哪里？

> ID：15101559
> 
> 赞同：38
> 
> 时间：2013-02-26T23:35:01.033
> 
> 标签：macos, shell, terminal, virtualenvwrapper

我正在关注一个名为[“以正确的方式启动 Django 1.4 项目”](http://www.jeffknupp.com/blog/2012/10/24/starting-a-django-14-project-the-right-way/)的教程，该教程提供了有关如何使用 virtualenv 和 virtualenvwrapper 等的指导。

有一段是这样写的：

> 如果您使用 pip 安装软件包（我不明白您为什么不这样做），您可以通过简单地安装 virtualenv 和 virtualenvwrapper 来获得后者。
> 
> ```
>  $ pip install virtualenvwrapper 
> ```
> 
> 安装后，将以下行添加到 shell 的启动文件（.zshrc、.bashrc、.profile 等）。
> 
> ```
>  export WORKON_HOME=$HOME/.virtualenvs
>    export PROJECT_HOME=$HOME/directory-you-do-development-in
>    source /usr/local/bin/virtualenvwrapper.sh 
> ```
> 
> 重新加载您的启动文件（例如源文件 .zshrc），您就可以开始了。

我正在运行 Mac OSX，并且不太了解终端的方式。作者到底是什么意思`shell's start-up file (.zshrc, .bashrc, .profile, etc)`？我在哪里可以找到这个文件，以便我可以添加这三行？

还有，他是什么意思`reload your start up file (e.g. source .zshrc)`？

我将不胜感激具体针对 OSX 的详细回复。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-26T23:40:36.997

您可能正在使用`bash`，因此只需将以下 3 行添加到`~/.bash_profile`：

```
$ cat >> ~/.bash_profile
export WORKON_HOME=$HOME/.virtualenvs
export PROJECT_HOME=$HOME/directory-you-do-development-in
source /usr/local/bin/virtualenvwrapper.sh
^D 
```

其中`^D`表示您键入`Control`+ `D`(EOF)。

然后关闭您的终端窗口并打开一个新窗口，或者您可以`.bash_profile`像这样“重新加载”您的：

```
$ source ~/.bash_profile 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-27T05:16:20.240

如果你使用 bash，它通常意味着`~/.bash_profile`.

在终端和 iTerm 中，默认情况下新的 shell 是登录 shell，因此`~/.bashrc`根本不会读取。如果为其他平台编写的说明告诉您添加一些东西到`.bashrc`，您通常必须将其添加到`.bash_profile`。

如果两者都`~/.profile`存在`~/.bash_profile`，`.bash_profile`则只读。`.profile`也可以被其他 shell 读取，但是您添加的许多内容`.bash_profile`不适用于它们。

从 /usr/share/doc/bash/bash.html：

> 当 bash 作为交互式登录 shell 或作为带有 --login 选项的非交互式 shell 调用时，它首先从文件`/etc/profile`中读取并执行命令（如果该文件存在）。读取该文件后，它会按顺序查找`~/.bash_profile`、`~/.bash_login`和`~/.profile`，并从第一个存在且可读的文件中读取并执行命令。
> 
> [...]
> 
> 当一个不是登录 shell 的交互式 shell 启动时，bash 读取并执行来自 的命令`~/.bashrc`（如果该文件存在）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-16T20:06:08.577

我安装了 Anaconda，所以我将这 3 行添加到 ~/.bash_profile

```
export WORKON_HOME=$HOME/.virtualenvs
export PROJECT_HOME=$HOME/Documents/Python
source /Users/Username/anaconda3/bin/virtualenvwrapper.sh 
```

然后通过以下方式重新加载配置文件：

```
$ source ~/.bash_profile 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-06T00:51:36.517

我使用一种我认为易于维护的方法。如果您有时使用 Ubuntu 系统，它也可以很好地工作，但是我一定会在我的回答中解决 OP 的 OSX 要求。

1.  `.aliases`在您的主目录中使用您的别名创建一个文件，例如`~/.aliases`

2.  使用. `.bashrc`_ `source ~/.aliases`顺便说一句，这就是您实际上需要为 Ubuntu 做的所有事情。

3.  `.bashrc`从您的文件中调用 OSX `~/.profile`，即`~/.bash_profile`包含：`source ~/.bashrc`

# php - $蒂姆 = 时间（） - 60000；if($tit->Time >= $Tim){ echo"t:"; }

> ID：15101561
> 
> 赞同：-1
> 
> 时间：2013-02-26T23:35:14.903
> 
> 标签：php

如果它是在那时或一小时前制作的，我希望它在线程标题旁边呼应 NEW。过了一个小时，我希望它什么都没有回响。

这以前有效，但现在无效，有人知道为什么这不符合我上面所说的吗？

```
$Tim = time() - 3600;
if($tit->Time >= $Tim){
echo"NEW ";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:37:11.377

```
echo $tit->Time >= strtotime('-1hour') ? 'New' : ''; 
```

确保，这`Time`确实*是*一个 UNIX 时间戳。如果不是，您必须先转换它。

你可以试试

```
strtotime($tit->Time); 
```

但这在很大程度上取决于是`$tit->Time`什么

# memory - 用 ddd 改变内存地址内容

> ID：15101564
> 
> 赞同：0
> 
> 时间：2013-02-26T23:35:24.670
> 
> 标签：memory, ddd-debugger

如何使用 ddd 更改内存地址的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:49:09.733

好吧，ddd 在下面运行 gdb，所以在 gdb 窗口中你可以输入如下内容：

```
set *((int *) 0x822b2ec) = 0x100 
```

请参阅[如何使用 GDB 修改内存内容？](https://stackoverflow.com/questions/3305164/how-to-modify-memory-contents-using-gdb)

# apache - ServerName 属性中的 Apache 的 VirtualHosts 通配符

> ID：15101568
> 
> 赞同：2
> 
> 时间：2013-02-26T23:35:33.970
> 
> 标签：apache, wildcard, virtualhost

是否可以在 VirtualHost 语句的 ServerName 属性上创建“通配符”？

我目前有这样的事情：

```
<VirtualHost *:80>
    ServerName testhost
    DocumentRoot "C:/xampp/htdocs/testhost/"
</VirtualHost> 
```

我想要的是这样的：

```
<VirtualHost *:80>
    ServerName $serverRequest
    DocumentRoot "C:/xampp/htdocs/" + $serverRequest
</VirtualHost> 
```

所以我可以将所有类似的主机重定向到同名目录。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:49:05.293

我认为您正在使用[动态配置的海量虚拟主机](http://httpd.apache.org/docs/current/vhosts/mass.html)。

# jquery - 我将如何重构这段 jQuery

> ID：15101570
> 
> 赞同：2
> 
> 时间：2013-02-26T23:35:38.863
> 
> 标签：jquery, refactoring

这段代码怎么写得更好？我的意思是我的目标是父母的孩子的父母。我不知道该怎么做，但似乎有一种更优雅的方式来做到这一点。

```
$('.flex-overlay')
    .children('.fluid-width-video-wrapper')
    .parent('.flex-overlay')
    .css({
        'border': '1px solid red',
        }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:39:27.933

您可以使用`has`方法：

```
$('.flex-overlay')
     .has('.fluid-width-video-wrapper')
     .css({ 'border': '1px solid red'}); 
```

# java - 如何创建存储过程以将 4 个值插入表中？

> ID：15101575
> 
> 赞同：0
> 
> 时间：2013-02-26T23:36:02.640
> 
> 标签：java, mysql, stored-procedures, triggers

我正在创建一个带有 Swing 组件的 Java 应用程序，但我不知道如何创建一个存储过程来将 4 个值插入到表中，或者如果使用触发器更好。这是我的界面：

```
Question: ______textbox_____      correct answer:(bonne reponse )
Reponse A: _____textbox______     *A (Radio button)
Reponse B: _____textbox______     *B (Radio button)   [Add button]
Reponse C: _____textbox______     *C (Radio button)
Reponse D: _____textbox______     *D (Radio button)
(levels)Paliers: _______ComboBox___ 
```

这些是我在 mysql 中的表

```
-- -----------------------------------------------------
-- Table `mydb`.`questions`
-- -----------------------------------------------------
CREATE  TABLE `questions` (
  `idquestion` INT NOT NULL AUTO_INCREMENT ,
  `question` VARCHAR(150) NULL ,
  `palier_fk` INT NULL ,
  PRIMARY KEY (`idquestion`) ,
  INDEX `palier_fk` (`palier_fk` ASC) ,
  CONSTRAINT `palier_fk`
    FOREIGN KEY (`palier_fk` )
    REFERENCES `paliers` (`idpalier` )
   )

-- -----------------------------------------------------
-- Table `reponses`
-- -----------------------------------------------------
CREATE  TABLE `reponses` (
  `idreponse` INT NOT NULL AUTO_INCREMENT ,
  `response` VARCHAR(60) NULL ,
  `bonne` TINYINT(1)  NULL ,
  `question_fk` INT NULL ,
  PRIMARY KEY (`idreponse`) ,
  INDEX `question_fk` (`question_fk` ASC) ,
  CONSTRAINT `question_fk`
    FOREIGN KEY (`question_fk` )
    REFERENCES `questions` (`idquestion` )
   ) 
```

但问题是如何创建存储过程以插入 4 个值并同时使用 idpalier (1,2,3) 插入表问题

我试过这个，但它不正确

```
CREATE PROCEDURE sp_reponses_INSERT
(

IN idreponse int(11),
IN reponse varchar(60),
IN bonne tinyint(1),
IN question_fk int(11)
)
BEGIN

INSERT INTO reponses(
    reponse,
    bonne,
    question_fk
)
VALUES
(   
    reponse,
    bonne,
    question_fk

),

(   
    reponse,
    bonne,
    question_fk

),
(   
    reponse,
    bonne,
    question_fk

),
(   
    reponse,
    bonne,
    question_fk

),

;

END 

GO 
```

另一方面，我正在考虑创建一个触发器而不是存储过程，但我对此不太确定。因为我必须在表格问题中插入问题以及表格响应中的 4 个响应。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:53:09.123

您可以按如下方式重写您的存储过程：

```
CREATE PROCEDURE sp_reponses_INSERT
(
@reponse varchar(60),
@bonne tinyint(1),
@question_fk int(11)
)
BEGIN

INSERT INTO reponses(
    reponse,
    bonne,
    question_fk
)
VALUES
(   
    @reponse,
    @bonne,
    @question_fk

)
END 
```

您现在可以传入变量并执行此存储过程。但是，此过程适用于 1 次执行。您必须调用它 4 次，每次都传入新的变量集。

在此之后，您可以在响应表上添加一个触发器，然后插入到问题表中。

# java - 字符更改时拆分字符串。可能的正则表达式解决方案？

> ID：15101577
> 
> 赞同：6
> 
> 时间：2013-02-26T23:36:11.187
> 
> 标签：java, regex, string, character

我有一些`String`仅由数字组成的 s，并且我想在字符更改时对其进行拆分。

例如：

*   `"11101100112021120"`去：`{"111", "11", "11", "2", "2", "11", "2"}`
*   `"222222222"`去`{"222222222"}`
*   `"222222122"`去`{"222222", "1", "22"}`
*   `"000000000"`去`{}`
*   `"0000100000"`去`{"1"}`
*   `"11121222212112133321"`去`{"111", "2", "1", "2222", "1", "2", "11", "2", "1", "333", "2", "1"}`

我想要一个很好的方法来做到这一点。

我知道解决这个问题的两种方法：只是暴力破解，或者逐段添加。或者，我可以删除所有 0 并替换为 0，然后在字符更改时添加 0，然后只对 0 进行拆分，但这两种方式都看起来很愚蠢。如果有人对更好/更漂亮的方法、正则表达式或逻辑有任何想法，那就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-26T23:55:10.857

这似乎像你期望的那样工作

```
data.split("0+|(?<=([1-9]))(?=[1-9])(?!\\1)"); 
```

测试：

```
String[] tests = { "11101100112021120", "222222222", "222222122",
        "000000000", "0000100000", "11121222212112133321" };

for (String data : tests) {
    System.out.println(data + " ->" + Arrays.toString(data.split("0+|(?<=([1-9]))(?=[1-9])(?!\\1)")));
    System.out.println("-----------------------");
} 
```

输出：

```
11101100112021120 ->[111, 11, 11, 2, 2, 11, 2]
-----------------------
222222222 ->[222222222]
-----------------------
222222122 ->[222222, 1, 22]
-----------------------
000000000 ->[]
-----------------------
0000100000 ->[, 1]     // <-- only problem - empty first element 
-----------------------
11121222212112133321 ->[111, 2, 1, 2222, 1, 2, 11, 2, 1, 333, 2, 1]
----------------------- 
```

不幸的是，前导零会让数组包含额外的空字符串。要摆脱它，您可以提前删除这些零`data.replaceFirst("^0+(?=[^0])", "")`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T23:48:32.143

尝试

```
 str.split( "0+|(?<=(\\d))(?!\\1)" ) 
```

对于包含零的字符串，您将不得不遍历数组并删除任何空元素。

# java - jscrollbar 显示其他组件

> ID：15101583
> 
> 赞同：0
> 
> 时间：2013-02-26T23:36:37.127
> 
> 标签：java, swing, jscrollpane, jscrollbar

各位晚上好;

我 java swing 我想有一个像图片中的菜单

（在图片左侧）

![在此处输入图像描述](../Images/0674abc70ff01ede301364ebf456caeb.png)

然而，它似乎比我想象的要困难。我有边框布局，我把盒子布局放在中间，把 jscroll bar 放在右边。在框布局内，我使用图标标记，我尝试通过调整级别事件来增加可见性。但是，我无法获得任何结果。我在互联网和 stackoverflow 上进行了研究，但是我再次无法完全达到我的目的。

问候 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:47:13.603

`JScrollBar`s 通常不单独使用，它们与 . 一起使用`JScrollPane`。

![在此处输入图像描述](../Images/d9e589eae46b8e379736570e74f8cbe4.png)

`JPanel`基本上，您希望使用适当的布局管理器将组件添加到某种容器（例如 a ），然后将该容器设置为 a 中的视图`JScrollPane`

有关详细信息，请参阅[如何使用滚动窗格](http://docs.oracle.com/javase/tutorial/uiswing/components/scrollpane.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T12:00:33.650

我从其他用户的评论中找到了一个鼓舞人心的答案。首先感谢您查看我的问题。

我在这里使用了代码；

[http://www.java2s.com/Code/Java/Swing-JFC/AsimpleJScrollPanedemonstration.htm](http://www.java2s.com/Code/Java/Swing-JFC/AsimpleJScrollPanedemonstration.htm)

问题是我需要创建一个容器并将项目放入容器中，然后将该窗格放入 jscroolpane。

问候 ...

# ruby-on-rails - 如何使用 Redis 跟踪每日和每周活跃用户？

> ID：15101595
> 
> 赞同：0
> 
> 时间：2013-02-26T23:37:42.280
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, statistics, redis

我想跟踪每天/每周有多少用户登录我的应用程序。我正在尝试这样的事情：

```
class SessionsController < ApplicationController
  ...
  def create
     if @session.save
       ...
       REDIS.sadd "2013-02-27:activity", current_user.id
     end
  end
end 
```

但是如何呈现（保存到文件）每周统计数据？

如何从本周开始全天获取摘要？

也许我使用了错误的 REDIS 命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:10:36.213

现在您已经每天将数据捕获到一个键中，您需要创建一个任务来定期运行以生成每周和每月计数的聚合。可以像您每天通过 cron 运行的小型 ruby​​ 脚本一样简单。

```
REDIS.get "#{1.day.ago.to_s}:activity" + REDIS.get "#{2.day.ago.to_s}:activity" + ... 
```

（上面的代码只是为了让你入门，不能直接使用）。

您可能还想看看`ZUNIONSTORE`（[http://redis.io/commands/zunionstore](http://redis.io/commands/zunionstore)）

# dynamics-crm-2011 - MS CRM 2011 获取 XML 查询

> ID：15101597
> 
> 赞同：1
> 
> 时间：2013-02-26T23:37:43.800
> 
> 标签：dynamics-crm-2011, fetchxml

我正在尝试为 CRM 2011 创建一些 fetch xml 或查询表达式。

我想 OR 下面的两个链接实体节点。这有可能吗，我需要在一个请求中完成。

如果我可以执行此查询，我打算通过注入额外的条件来修改 Activity History RetrieveMultiple 视图事件，类似于下面。

```
<fetch  mapping='logical' distinct='true'>
  <entity name='activitypointer'>
    <attribute name='activitytypecode' />
    <attribute name='subject' />
    <attribute name='statecode' />
    <attribute name='prioritycode' />
    <attribute name='modifiedon' />
    <attribute name='activityid' />
    <attribute name='instancetypecode' />
    <order attribute='modifiedon' descending='false' />
    <filter type='and'>
      <condition attribute='statecode' operator='eq' value='1' />
    </filter>
    <link-entity name='activityparty' from='activityid' to='activityid' alias='aa'>
      <link-entity name='account' from='accountid' to='partyid' alias='ab'>
        <filter type='or'>
          <condition attribute='accountid' operator='eq' uiname='A new Trust' uitype='account' value='{756CE4E9-F6F0-E111-8948-000C297B9BDA}' />
        </filter>
      </link-entity>
    </link-entity>
    <link-entity name='connection' from='record2id' to='activityid' alias='ad'>
      <link-entity name='account' from='accountid' to='record1id' alias='ae'>
        <filter type='or'>
          <condition attribute='accountid' operator='eq' uiname='A new Trust' uitype='account' value='{756CE4E9-F6F0-E111-8948-000C297B9BDA}' />
        </filter>
      </link-entity>
    </link-entity>
   </filter>
  </entity>
</fetch> 
```

这是返回我正在寻找的结果的 SQL，请注意问题是为 where 子句重新创建 fetchXml，特别是检查其中一个连接是否存在。

```
SELECT DISTINCT
    ap.activitytypecode,
    ap.[subject],
    ap.statecode,
    ap.prioritycode,
    ap.modifiedon,
    ap.activityid,
    ap.instancetypecode

FROM 

dbo.FilteredActivityPointer ap

--First Link
LEFT OUTER JOIN dbo.FilteredActivityParty party
ON ap.activityid = party.activityid
AND party.partyid = '756CE4E9-F6F0-E111-8948-000C297B9BDA'

--Second Link
LEFT OUTER JOIN dbo.FilteredConnection connection
ON ap.activityid = connection.record2id
AND connection.record1id = '756CE4E9-F6F0-E111-8948-000C297B9BDA'

WHERE
    ap.statecode =1

    AND (
        NOT party.partyid IS NULL
     OR NOT connection.record1id IS NULL
    )
ORDER BY 
    ap.modifiedon 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:42:51.400

如果我偏离了标准，也许您可​​以编写您想要实现的基本 SQL 语句。但是我认为您想要返回特定帐户是连接或活动方的所有活动指针？如果是这样，那么您需要将链接更改为外部链接。

尝试将 link-type='outer' 属性和值添加到您的链接实体，如下所示：

```
<fetch  mapping='logical' distinct='true'>
  <entity name='activitypointer'>
    <attribute name='activitytypecode' />
    <attribute name='subject' />
    <attribute name='statecode' />
    <attribute name='prioritycode' />
    <attribute name='modifiedon' />
    <attribute name='activityid' />
    <attribute name='instancetypecode' />
    <order attribute='modifiedon' descending='false' />
    <filter type='and'>
      <condition attribute='statecode' operator='eq' value='1' />
    </filter>
    <link-entity name='activityparty' from='activityid' to='activityid' alias='aa' link-type='outer'>
      <link-entity name='account' from='accountid' to='partyid' alias='ab' link-type='outer'>
        <filter type='or'>
          <condition attribute='accountid' operator='eq' uiname='A new Trust' uitype='account' value='{756CE4E9-F6F0-E111-8948-000C297B9BDA}' />
        </filter>
      </link-entity>
    </link-entity>
    <link-entity name='connection' from='record2id' to='activityid' alias='ad' link-type='outer'>
      <link-entity name='account' from='accountid' to='record2id' alias='ae' link-type='outer'>
        <filter type='or'>
          <condition attribute='accountid' operator='eq' uiname='A new Trust' uitype='account' value='{756CE4E9-F6F0-E111-8948-000C297B9BDA}' />
        </filter>
      </link-entity>
    </link-entity>
   </filter>
  </entity>
</fetch> 
```

* * *

## 编辑 1

在查看了您的 SQL 查询之后，我相信 CRM 在单个查询中不支持您尝试做的事情，尽管现在我找不到任何文档来支持我的预感......我不认为你可以对外部连接记录进行计数然后说，只返回第一个链接实体的计数+第二个链接实体的计数> 0的地方，但我可能弄错了。

# c++ - C ++：在派生类中声明一个虚拟方法是否合法，而它在基类中不是虚拟的？

> ID：15101601
> 
> 赞同：1
> 
> 时间：2013-02-26T23:38:06.093
> 
> 标签：c++, inheritance, virtual-functions

基类特别声明该方法是非虚拟的。它适用于 Visual Studio 2008、2010 和 2012 以及[ideone 使用的任何编译器](http://ideone.com/D8rbcH)（gcc 4.7+？）。

```
#include <iostream>

class sayhi
{
public:
    void hi(){std::cout<<"hello"<<std::endl;}
};

class greet: public sayhi
{
public:
    virtual void hi(){std::cout<<"hello world"<<std::endl;}
};

int main()
{
    greet noob;
    noob.hi(); //Prints hello world
    return 0;
} 
```

这也有效 - 该方法在基类中是私有且非虚拟的：

```
#include <iostream>

class sayhi
{
private:
    void hi(){std::cout<<"hello"<<std::endl;}
};

class greet: public sayhi
{
public:
    virtual void hi(){std::cout<<"hello world"<<std::endl;}
};

int main()
{
    greet noob;
    noob.hi(); //Prints hello world
    return 0;
} 
```

我的问题是：

1.  合法吗？
2.  为什么它有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T23:42:52.553

> 1\. 合法吗？

**是**的。

> 2\. 为什么它有效？

没有什么可以阻止您在派生类中声明与基类的成员函数同名的成员函数。您在派生类中的函数将简单地**隐藏**基类的函数。顺便说一句，如果派生类中的函数恰好是`virtual`，那么子类可能会覆盖它：

```
class howdy : public greet
{
public:
    // Overrides greet::hi()
    virtual void hi() { std::cout << "howdy world" << std::endl; }
}; 
```

但是，这不会`sayhi::hi()`以任何方式影响：特别是，仅`virtual`在派生类中存在隐藏它的函数**并不能使其成为** `virtual`. *因此，在通过指针或对基*类实例的引用调用函数时，您不能期望虚拟调度起作用`sayhi`：

```
sayhi noob;
noob.hi(); // Will NOT print "hello world"!

greet gentleman;
sayhi* p = &gentleman;
p->hi(); // Will NOT print "hello world"!

howdy neighbor;
p = &neighbor; 
p->hi(); // Will NOT print "howdy"!

greet* pG = &neighbor;
pG->hi(); // WILL print "howdy"! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T23:42:41.813

这是合法的。从那时起，该方法`virtual`在 的派生类中变为`greet`.

基类方法是隐藏的（就像非 发生的那样`virtual`）。

通过`greet`指针调用方法将动态解析调用。通过 a 调用它`sayhi`会静态地解决它。

举个例子：

```
class sayhi
{
public:
    void hi(){std::cout<<"hello"<<std::endl;}
};

class greet: public sayhi
{
public:
    virtual void hi(){std::cout<<"hello world"<<std::endl;}
};

class greetuniverse: public greet
{
public:
    virtual void hi(){std::cout<<"hello universe"<<std::endl;}
}; 
```

以下

```
sayhi* p = new greetuniverse;
p->hi(); 
```

将打印`hello`，因为`hi`is not virtual in `sayhi`。然而

```
greet* p = new greetuniverse;
p->hi(); 
```

将打印`hello universe`，因为该方法是动态调用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:40:06.760

这是合法的。通过在派生类中命名一个函数 virtual ，您是在告诉编译器在运行时检查派生类的方法以在转到基类之前检查函数的实现。

# matlab - MATLAB：从 for 循环值创建矩阵？

> ID：15101610
> 
> 赞同：1
> 
> 时间：2013-02-26T23:38:47.787
> 
> 标签：matlab, loops, matrix

我有以下代码：

```
for i = 1450:9740:89910
    n = i+495;
    range = ['B',num2str(i),':','H',num2str(n)];
    iter  = xlsread('BrokenDisplacements.xlsx' , range);
    displ = iter;
    displ = [displ; iter];
end 
```

它从我想要的多个范围的 Excel 文件中获取值并将它们输出为矩阵。但是，此代码仅使用 displ 的最终值并从那里创建总矩阵。我想将这些输出（displ）汇总为一个大矩阵保存值，我将如何做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:43:28.453

这个怎么样：

```
displ=[];

for i = 1450:9740:89910
    n = i+495;
    range = ['B',num2str(i),':','H',num2str(n)];
    iter  = xlsread('BrokenDisplacements.xlsx' , range);
    displ = [displ; iter];
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:12:49.003

由于您知道正在读取的数据块的大小，因此您可以使代码更加高效，如下所示：

```
firstVals = 1450:9740:89910;
displ = zeros((firstVals(end) - firstVals(1) + 1 + 496), 7);
for ii = firstVals
    n = ii + 495;
    range = sprintf('B%d:H%d', ii, ii+495);
    displ((ii:ii+495)-firstVals(1)+1,:) = xlsread('BrokenDiplacements.xlsx', range);
end 
```

几点：

1.  我不喜欢`i`用作变量，因为它`built in`就像`sqrt(-1)`- 如果你稍后执行假设为真的代码，你就有麻烦了
2.  我不是假设的最后一个值`ii`是`89910`- 通过首先将值分配给一个向量，然后找到向量中的最后一个值，我回避了这个问题
3.  我一次分配所有空间`iter`- 否则，随着它的增长，Matlab 必须不断移动数组，这会大大减慢速度
4.  我曾经`sprintf`生成表示范围的字符串 - 我认为它更具可读性，但这是一个风格问题
5.  我将返回值`xlsread`直接分配给`displ`大小合适的块

我希望这有帮助。

# windows-phone-7 - MainPageView 页面被实例化，即使没有调用

> ID：15101618
> 
> 赞同：0
> 
> 时间：2013-02-26T23:39:31.303
> 
> 标签：windows-phone-7

我是 WP 编程新手，需要了解承包商编写的代码。似乎 MainPageView 页面（它是主页）是在 App 类中的 Application_Launching() 事件之后立即启动的。但是我没有看到任何地方调用“new MainPageView”或导航到这个页面。

我尝试了什么.. 1\. 我在整个解决方案中搜索“MainPageView”以查看如何调用此页面.. 但是没有“新 MainPageView”或任何可以实例化页面的东西 2\. 我在 App 类上设置断点(App.xaml.cs) 和 MainPageView 类并进入但没有找到任何指示调用 MainPageView 类的触发器

有没有我错过的约定？我很难弄清楚 App 类和 MainPageView 类之间的联系。请帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T01:41:27.097

文件中引用了默认页面`Properties/WMAppManifest.xml`。

```
<Tasks>
  <DefaultTask
     Name ="_default"
     NavigationPage="MainPage.xaml"/>
</Tasks> 
```

还有[适用于 Windows Phone 的 App 清单文件](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff769509%28v=vs.105%29.aspx)

# c - WSTOPSIG（状态）== 22 & WTERMSIG（状态）== 9；这些数字从何而来？

> ID：15101619
> 
> 赞同：3
> 
> 时间：2013-02-26T23:39:33.693
> 
> 标签：c, fork, waitpid

我正在查看 esh (easy shell) 的实现，在这种情况下无法理解 22 和 9 是什么信号。理想情况下，有一个更具描述性的常数，但我找不到列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T23:47:58.620

信号列表及其编号（包括您看到的两个）实际上是由 POSIX.1-1990 指定的，例如，[如果您在本手册页中向下滚动一点，](http://www.kernel.org/doc/man-pages/online/pages/man7/signal.7.html)就可以找到。

```
SIGKILL       9       Term    Kill signal
SIGTTOU   22,22,27    Stop    tty output for background process 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T23:48:35.843

```
SIGTTOU 22,22,27    Stop    tty output for background process
SIGKILL  9         Term Kill signal 
```

这些是信号编号。含义取决于平台——这些是 Linux 的。

看：

```
http://linux.about.com/od/commands/l/blcmdl7_signal.htm 
```

信号通过内核发送到进程。在这种情况下`SIGTTOU`，后台进程试图写入 tty。这会导致内核问题，从而引发该信号。默认情况下，该信号的结果是终止进程。

# module - 未找到 Kohana 类

> ID：15101625
> 
> 赞同：0
> 
> 时间：2013-02-26T23:40:02.987
> 
> 标签：module, kohana

我从[kohana-modules.com](http://kohana-modules.com)下载了一个**Flickr 模块**，当我在本地服务器上进行测试时效果很好。但是当我上传到远程服务器，到与默认 Koahan 模块相同的目录时，我得到了一个The default Kohana modules are working as expected。我正在使用 Kohana 3.2.2。`"ErrorException [ Fatal Error ]: Class 'Flickr' not found".`

任何关于为什么会发生这种情况的指示？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T12:43:16.967

如果 Linux 服务器上的自动加载器无法解析对类的动态引用，我会在 Kohana 3.2 和 3.3 中遇到完全相同的行为。主要是因为*Mac OSX 和 Windows 使用的文件系统不区分大小写，但基于 Unix/Linux 的服务器不区分大小写*。您的本地和远程服务器在哪些操作系统上运行？

由于您使用的是 Kohana 3.2，并且提到的 flickr 模块的主分支被错误地命名为 3.1/master 但包含 3.3 PSR-0 更新，请*尝试使用 3.0 分支*：[https ://github.com/jeanmask/flickr/tree/3.0 /掌握](https://github.com/jeanmask/flickr/tree/3.0/master)

注意：更好的是分叉 github 存储库，构建一个有效的 Kohana 3.2 分支，该分支包含所有更改但不包含 PSR-0 修改并声明拉取请求。

# java - 奇怪的休眠错误

> ID：15101631
> 
> 赞同：0
> 
> 时间：2013-02-26T23:40:39.157
> 
> 标签：java, mysql, spring, hibernate, exception

我正在开发一个 Java 项目，我对偶然发现的情况感到困惑。

我正在使用 mac osx 山狮在 Mac 上开发。我正在使用 eclipse 并正确配置了所有内容，并且已经以这种方式开发了很长时间而没有问题。

我将 MySQL 和 Hibernate 与 HBM 映射文件一起使用，我使用 Spring 通过指示应该使用哪些映射文件将它们联系在一起。最近我尝试向表中添加一个新列，更新了域对象，并更新了 hbm 映射文件。

现在，我开始得到一个错误：

'字段列表'中的未知列'dateSent'

即使该列在我的映射文件中，并且该列在数据库中，也在我的域对象中。

然后我删除了它并使用 Maven 重建了所有内容，现在我遇到了一个更奇怪的问题，我的代码删除了对列的所有引用，从数据库中删除了该列，并且从 hbm 映射文件中删除了该列。但是，我仍然看到 Hibernate 抛出有关该列的错误，就好像它仍然存在于我的代码中的某个位置，但它不存在。更奇怪的是，Hibernate 输出并没有显示尝试使用有问题的列插入记录的不当使用......请参见下面的错误：“Hibernate：插入消息（用户 ID，内容，位置）值（？，？， ?)"...

这是我得到的错误：

```
 Hibernate: insert into messages (userid, content, location) values (?, ?, ?)
        18:08:19,154  WARN JDBCExceptionReporter:77 - SQL Error: 1054, SQLState: 42S22
        18:08:19,155 ERROR JDBCExceptionReporter:78 - Unknown column 'dateSent' in 'field list'
        18:08:19,175 ERROR MessageProcessorImpl:724 - org.springframework.dao.InvalidDataAccessResourceUsageException: could not insert: [com.app.domain.Message]; SQL [insert into messages (userid, content, location) values (?, ?, ?)]; nested exception is org.hibernate.exception.SQLGrammarException: could not insert: [com.app.domain.Message]
            at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:629)
        ... 50 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'dateSent' in 'field list'
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)
    at com.mysql.jdbc.Util.getInstance(Util.java:381)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1030)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3558)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3490)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1959)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2109)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2643)
    at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2077)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2362)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2280)
    at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:2265)
    at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeUpdate(NewProxyPreparedStatement.java:105)
    at org.hibernate.id.IdentityGenerator$GetGeneratedKeysDelegate.executeAndExtract(IdentityGenerator.java:73)
    at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:33)
    ... 66 more 
```

mysql 数据库或使用 Hibernate 的 java 应用程序之间是否有类似缓存的东西可能导致这种情况？

我重新启动了计算机，执行了 Maven clean / Maven install 以刷新所有内容。在我的代码中搜索字符串 dateSent 并没有在我的代码中找到对这个词的引用，它仍然在抱怨。

任何建议将不胜感激。

这是 HBM 文件：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="com.app.domain">
    <class name="Message" table="messages" >
        <id name="messageId" column="messageId">
            <generator class="native" />
        </id>
        <property name="userId" column="userId"/>
        <property name="content" column="content"/>
        <property name="location" column="location"/>
    </class>
</hibernate-mapping> 
```

这是我的域对象：

```
package com.app.domain;

import java.util.Date;
import java.util.List;

public class Message {
    private long messageId;
    private long userId;
    private String content;
    private String location;

    public long getMessageId() {
        return messageId;
    }
    public void setMessageId(long messageId) {
        this.messageId = messageId;
    }
    public long getUserId() {
        return userId;
    }
    public void setUserId(long userId) {
        this.userId = userId;
    }
    public String getContent() {
        return content;
    }
    public void setContent(String content) {
        this.content = content;
    }
    public String getLocation() {
        return location;
    }
    public void setLocation(String location) {
        this.location = location;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T04:01:26.840

我甚至将我的代码库恢复到上一个​​稳定版本，但我仍然遇到问题。问题最终是由于表上的历史触发器引用了我删除的字段。

异常消息似乎不准确地表明问题出在我的映射上。

# http - 登录和重定向：webapp 登录的最佳 HTTP 流程是什么？

> ID：15101635
> 
> 赞同：11
> 
> 时间：2013-02-26T23:40:56.430
> 
> 标签：http, rest, authentication, web-applications, web

这个问题是关于一般网络应用程序登录流程的问题。我对在保持安全性的同时优化可用性和性能的答案最感兴趣。

## 处理对书签 URL 的未经身份验证请求的最合适方法是什么？

为了演示该问题，以下是示例应用程序的一些路由和各自的行为：

```
GET /login         -> Display the authentication form
POST /processLogin -> process the username and password, 
                            if unauthentic...re-render the login form; 
                            otherwise...display the default page
GET /secret         -> if authenticated...display the secret resource;
                       otherwise...display a login form
POST /secret        -> if authenticated...perform a desirable, but potentially 
                                          non-idempotent action on the secret 
                                          resource
                       otherwise...display a login form 
```

# 选项 1：显示登录屏幕，重定向到所需页面

1.  用户点击书签
2.  GET /secret -> 200, 偷偷显示带有*隐藏字段*path="/secret"的登录表单
3.  POST /processLogin -> 302 到 /secret（路径参数的值）
4.  GET /secret -> 200，显示秘密资源

分析：希望您的客户端是现代浏览器，不兼容 HTTP，因此它在 302 的 POST 之后执行 GET。这适用于所有方面。我应该担心吗？

# 选项 2：重定向到登录屏幕，重定向到所需页面

1.  用户点击书签
2.  获取 /secret -> 302 到 /login
3.  GET /login via redirect -> 200，登录表单显示*隐藏字段*path="/secret"
4.  POST /processLogin -> 302 到 /secret
5.  GET /secret -> 200，显示秘密资源

分析：和上面一样的问题。增加登录时浏览器显示的URL发生变化，给用户造成混淆，破坏书签、链接共享等问题。

# 选项3：显示登录屏幕，显示所需页面

1.  用户点击书签
2.  GET /secret -> 200，偷偷地显示登录表单，*操作*为 =“/secret”
3.  POST /secret -> 200，显示秘密资源

分析：可悲的是，刷新按钮现在也坏了：刷新将导致用户代理重新发布并发出警告，而不是重新获取 /secret。他们的用户会收到警告，但如果他们忽略它，就会发生不好的事情。

从好的方面来说，您可以使用这种技术最大限度地减少往返次数。

# 选项 4：重定向到登录屏幕，显示所需页面

1.  用户点击书签
2.  获取 /secret -> 302 到 /processLogin
3.  通过重定向获取 /processLogin -> 200，登录表单显示为*action* ="/secret"
4.  POST /secret -> 302 到 /secret
5.  GET /secret -> 200，显示秘密资源

分析：与选项 2+4 相同的问题。

# 选项5：？？？

我还缺少另一种技术吗？

## 一般来说，您会推荐哪些技术？

### 也可以看看

[重定向到登录页面时正确的 HTTP 状态代码是什么？](https://stackoverflow.com/questions/2839585/what-is-correct-http-status-code-when-redirecting-to-a-login-page) [什么样的 HTTP 重定向用于登录？](https://stackoverflow.com/questions/4219184/what-kind-of-http-redirect-for-logins) [带有重定向的 HTTP 响应，但没有往返？](https://stackoverflow.com/questions/704888/http-response-with-redirect-but-without-roundtrip)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T09:39:30.177

选项 1 和 3 不遵循[HTTP RFC](http://www.ietf.org/rfc/rfc2616.txt)，因为“秘密显示登录表单”与 200 GET 响应相矛盾，其中“响应中发送了与请求的资源相对应的实体”是预期的。

选项 2 没问题。所有现代浏览器都支持 POST 上的 302，许多基于 REST 的框架（如 RoR）都在积极使用它。或者，在“302 to /login”中，您已经可以创建会话（cookie）并将 URL 存储在会话中，以避免在 GET 参数中传递原始 URL。从可用性的角度来看，您也可以在登录页面上显示适当的消息（我认为 URL 不匹配在这里无关紧要 - 无论如何您不能让用户看到内容）。

选项 4：当您 POST 到 /secret 时，HTTP RFC 希望您“接受请求中包含的实体作为请求行中的请求 URI 标识的资源的新下级”，但您所做的只是记录在而不是在 /secret 下创建任何新内容。

因此，遵循 HTTP RFC，您最好的选择是**Option 2**。实际上，选项 2 也符合 [POST->Redirect->GET 设计模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)，这有助于解决将 URL 添加到 POST 资源的不可预测性问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T15:23:34.970

我的 $.02：我最近使用选项 2 实现了（虽然我存储`/secret`在会话中，而不是作为隐藏字段存储在登录表单中）。

我并不完全同意您的担忧：

> 增加登录时浏览器显示的URL发生变化，给用户造成混淆，破坏书签、链接共享等问题。

重定向到`/login`以及随后的 URL 更改告诉用户，在他们可以继续之前，还需要先完成其他事情：登录。

由于登录页面看起来与“目标页面”完全不同，我看不出这会如何使人们混淆为书签和/或链接共享登录页面而不是目标页面（因为登录页面不包含他们想要收藏/分享的信息）。

如果您担心 302 会破坏标准（尽管我知道的每个浏览器都会很乐意破坏它），请考虑改用 303。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T11:01:55.220

请注意，mickeyreiss 是正确的，使用 AJAX 选项 3 没有后退按钮损坏的缺点。但是，这意味着用户必须启用 JavaScript。话虽这么说，如果您正确编写表单，则可以检测 JS 是否存在，如果不使用选项 1。

请注意，302 响应很好，但是，您可能会遇到缓存问题。如果您想为同一个 URI 显示 2 个完全不同的页面/表单，您必须确保没有任何内容被缓存。（/secret 显示登录名，然后显示实际密码。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T19:09:10.660

我几乎总是使用选项 #2，仅仅是因为 URL 返回的内容是一致的。虽然今天的秘密隐藏在登录后面，但明天您可能想要打开它或根据同一 URL 的身份验证显示混合的公共/秘密。在这种情况下，选项 #2 将最符合 Google 的预期。谷歌看不起任何内容诱饵和切换，在极端情况下，您的所有页面都会有重复的页面内容（即登录表单）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T19:05:47.703

我会选择使用 AJAX 的选项：

1.  登录页面并隐藏内容
2.  用户输入登录名和密码。
3.  身份验证在服务器端完成。
4.  服务器返回结果
5.  如果成功使用`location.href`设置您想去的页面，否则您可以输出一条消息说登录无效。
6.  在您的服务器中，您将测试一个`_SESSION`变量，如果未设置重定向到登录页面..

# security - 如何在 apache 磁贴中分配角色

> ID：15101636
> 
> 赞同：2
> 
> 时间：2013-02-26T23:40:57.567
> 
> 标签：security, jakarta-ee, tiles, role

Apache Tiles 让我们可以添加基于`role`. 这个角色到底是什么？如何为当前用户设置角色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:15:50.593

磁贴角色用于容器管理的安全性。框架获得角色的地方参见：[http ://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)

容器管理的安全性在应用服务器（AS）之间会有所不同，您需要查阅您的特定文档。

优点是，如果您已经熟悉容器管理的安全性，则可以轻松控制对磁贴的访问。缺点是，如果您不使用容器管理的安全性，那么设置起来并不容易，而且不那么便携。如前所述，不同的 AS 不同的设置。

Spring security 应该更容易实现并且更便携：[http](http://static.springsource.org/spring-security/site/) ://static.springsource.org/spring-security/site/当然它不仅可以应用于 struts2 操作，还可以应用于服务和数据层。

我想研究的另一个应用程序管理的安全框架是 apache shiro：[http](http://shiro.apache.org/) ://shiro.apache.org/这是一个关于两者的 SO 问题：[Spring security vs Apache Shiro](https://stackoverflow.com/questions/11500646/spring-security-vs-apache-shiro)

# java - 删除 ArrayLists 中常见元素的有效方法？

> ID：15101638
> 
> 赞同：0
> 
> 时间：2013-02-26T23:41:08.513
> 
> 标签：java, drawing

我有一个`ArrayList<ArrayList<Character>>`在计算结束时改变的。我制作了一个（惰性）方法，在每次计算结束时绘制此 ArrayList 中的所有内容。问题是有时我可以进行多次迭代而无需对 ArrayList 进行一次更改，而且一直重绘相同的东西似乎效率很低。

我想做的是在迭代结束时复制一份，将其与下一次迭代结束时的副本进行比较，然后只画出差异。一个简单的方法是以某种方式获取两个数组列表的差异，可能通过将所有相等的元素设置为空白`' '`（或 0 或其他任何东西，只要它与更改的元素明显区分开来）并编辑我的惰性方法只绘制非空白。这对我来说似乎是最快的解决方法，但我不知道如何有效地实现它。我想知道是否有任何实用程序可以采用上述方式。

# rabbitmq - 何时使用直接交换而不是扇出交换

> ID：15101640
> 
> 赞同：20
> 
> 时间：2013-02-26T23:41:17.493
> 
> 标签：rabbitmq, amqp

据我所知，直接交换没有合适的用例，就像你可以用它做的任何事情一样，你可以用扇出交换来做，只是更具可扩展性。

更具体地说，在阅读*RabbitMQ in Action*时，作者大量引用了类似的用例 - “假设当用户上传图片时，您需要生成缩略图。但后来营销还告诉您上传一个奖励积分照片。使用 RabbitMQ，您只需要创建另一个队列，并且在生产者端不做任何工作！”

但这*只有*在您有远见在生产者方面创建一个扇出交换时才是正确的。据我了解，直接交换无法实现这一点，并且仅在您真正想要交换和队列之间的紧密耦合时才适用（您不需要，因为这是消息传递系统的重点。）

这是正确的还是有实际的用例？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-03-24T10:41:54.397

与扇出交换相比，直接交换允许根据消息的路由键进行一些过滤，以确定哪个队列接收消息。使用扇出交换，没有这样的过滤，所有消息都进入所有绑定队列。

因此，如果您与多个使用相同路由键绑定的队列进行直接交换，并且所有消息都具有此键，那么您将具有与扇出交换相同的行为。[这在 RabbitMQ 网站上的教程 4 中](https://www.rabbitmq.com/tutorials/tutorial-four-python.html)有更好的解释。

在图片上传用例中，您可以使用：

*   带有两个队列的扇出交换（一个用于缩略图工作者，一个用于分数计算工作者）。路由键被忽略。

    ```
    fanout-exchange
    |--> queue --> thumbnail-worker
    `--> queue --> score-worker 
    ```

*   再次与两个队列直接交换。例如，队列与键绑定，`image-processing`具有此键的消息将排队到两个队列。

    ```
    direct-exchange
    |--["image-processing"]--> queue --> thumbnail-worker
    `--["image-processing"]--> queue --> score-worker 
    ```

    当然，在这种情况下，如果消息的路由键与绑定键不匹配，则任何队列都不会收到该消息。

您不能将两个工作人员放在同一个队列中，因为消息将在它们之间进行负载平衡：一个工作人员将看到一半的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T07:40:46.777

你的意思是扇出交换还是主题交换？扇出交换与直接交换非常不同。我假设将照片发送到交易所是使用指定有照片的路由键发送的。在这种情况下，您有一个生成缩略图的消费者，当您想添加一个新消费者时，您可以添加它并获得相同的消息，但对其执行不同的操作，即奖励积分。

用例成立。我认为关键是交易所最初是作为直接交易所创建的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T11:02:43.137

这个答案与上一个答案相呼应，如果您参考此[页面](http://www.rabbitmq.com/tutorials/amqp-concepts.html)，我相信您会发现所描述的一个特定用例是：

> 直接交换通常用于以循环方式在多个工作人员（同一应用程序的实例）之间分配任务。

# json - 从 Node REST 客户端访问 Google Apps 脚本时出现奇怪的错误

> ID：15101643
> 
> 赞同：1
> 
> 时间：2013-02-26T23:41:28.927
> 
> 标签：json, node.js, google-apps-script, restler

我正在设置一个简单的 Google App 脚本来从电子表格中获取一些数据到外部应用程序。当我从浏览器或 curl 打开 url 时，我得到了正确的 JSON 响应。

自己看吧，网址如下：

[https://script.google.com/macros/s/AKfycbwUqrOsqQk4rk0lY97Wl4bRsHVk6_CMVPz3hGHeyc3H2ZCahCIY/exec](https://script.google.com/macros/s/AKfycbwUqrOsqQk4rk0lY97Wl4bRsHVk6_CMVPz3hGHeyc3H2ZCahCIY/exec)

你应该得到一个 JSON 响应。我想让一个节点应用程序向该 URL 发出请求并解析 JSON 响应。我正在尝试使用两个不同的客户端，restler 和 request，并且两者都出现此错误：

```
Error: 140735264762208:error:0607907F:digital envelope routines:EVP_PKEY_get1_RSA:expecting an rsa
key:../deps/openssl/openssl/crypto/evp/p_lib.c:288 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T14:30:36.807

我相信这是一个已知的 Node.js 问题，已经有一个正在进行的修复 - [https://github.com/joyent/node/pull/4827](https://github.com/joyent/node/pull/4827)

# php - facebooks sharedSession 返回“页面未正确重定向”

> ID：15101649
> 
> 赞同：1
> 
> 时间：2013-02-26T23:41:56.287
> 
> 标签：php, facebook, login

我正在尝试通过 facebook 登录激活 cookie，因此它并不总是依赖于存在的会话，但每当我设置`sharedSession`为 true 时，我都会收到“页面未正确重定向”错误页面。这是我的方式吗？假设让facebook登录使用cookies？我在 github 上为 facebook SDK 使用最新的代码（今天刚下载）-> [https://github.com/facebook/facebook-php-sdk](https://github.com/facebook/facebook-php-sdk)

我没有使用 javascript SDK。并且在发送任何标头之前触发下面的所有编码。如果我`sharedSession`退出，它会正确登录，但它不会存储包含所需信息的 cookie。

这是我正在使用的编码

```
$facebook = new Facebook(array(
    'appId'  => $Sets['facebook']['appId'],
    'secret' => $Sets['facebook']['appSecret'],
'sharedSession' => true,
//  'trustForwarded' => true
));
$user = $facebook->getUser();
if($user){
    try {
        // Proceed knowing you have a logged in user who's authenticated.
        $user_profile = $facebook->api('/me');
    } catch (FacebookApiException $e) {
        $user = null;
    }
}
// the user is logged into facebook
if($user){
    // I register them on my website..
    // and then send them to the index page
    header('Location: /index.php'); 
} else {
    // they are not registered through facebook
    if(isset($_GET['error'])){
            // this happens when an error is found
        die($_GET['error'].' error');
//      header("Location: /login/?error=".urlencode($_GET['error']));
        exit;
    } else {
            // send to facebook to log them in.
        $loginUrl = $facebook->getLoginUrl($Sets['facebook']['scope_array']);
//      die('sending to '.$loginUrl);
        header("Location: ".$loginUrl);
        exit;
    }
} 
```

你可以看到我把`die()`函数放在任何重定向之前，这是为了调试我是否能找出失败的地方，但它似乎是在用户返回网站后发生的。我也试过了trustForward => true，但这并没有解决它..

我所追求的只是能够让用户登录更长的时间，而不必每次访问该网站时都通过 Facebook 登录。

发生的事情是用户被困在一个循环中，试图登录 facebook，在 facebook 和我的网站之间被重定向，因为用户从未经过验证。同样，这仅在我设置时发生`'sharedSession' => true`

我正在尝试让 facebook sdk 将我网站中的 cookie 存储到尝试登录但未设置 cookie 的个人计算机上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T14:48:23.580

我对你的问题感到困惑。你想达到什么目标：

1) 如果您想将您的 facebook user_id 设置为 cookie，您无需执行任何操作。当 oauth 过程完成后，facebook 重定向到您的“redirect_uri”url，cookie 由 facebook 设置为 cookie 值：fbsr_xxxx（xxxx 是您的 appId）

2）如果你想让用户登录的时间更长，你需要设置你自己的会话值来确定用户是否登录。换句话说，在 facebook oauth 流程之后，您的用户登录状态与您的 facebook 会话无关。

BTW：$Users->loginWithOauth，这个函数没有定义，这个函数是干什么用的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-17T09:21:01.097

原因是未授予所需的权限，因此最终它会去 facebook 搜索令牌并返回。

检查您需要的权限。

# c++ - 如何在 MFC C++ 中显示矩阵

> ID：15101651
> 
> 赞同：0
> 
> 时间：2013-02-26T23:42:06.433
> 
> 标签：c++, mfc, matrix, grid

我在变量中有一个整数矩阵，我想知道如何显示它以及我必须在 MFC 中使用什么控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T16:38:03.263

对于更高级的格式化选项，我总是使用网格控件来显示矩阵数据；更具体地说，[来自 CodeProject 的 CGridCtrl](http://www.codeproject.com/Articles/8/MFC-Grid-control-2-27)。它很旧，但效果很好。

# javascript - 尝试传递选择器，但在第二次传递时传递了对象

> ID：15101653
> 
> 赞同：2
> 
> 时间：2013-02-26T23:42:27.520
> 
> 标签：javascript, jquery

我正在尝试编写一个函数来每半秒更改一次图像 10 次迭代。在最后一次迭代中，图像 src 将被设置为实际值。这适用于第一个循环，但第一次`setTimeout`触发它通过**object** `mo456`而不是***string***。我正在使用 Firebug，控制台显示：

![在此处输入图像描述](../Images/4f385bd79e034642da960bb19cbbccb7.png)

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>
function loopMoHolder(lmc,thisMoDivID){
    ++lmc;
    ffRan = parseInt(Math.floor((Math.random()*10)+1));
    console.log(lmc);
    console.log(thisMoDivID);
    $('#'+thisMoDivID+' .moHolder .ffbg img').attr('src','/img/moMoniker/mo'+ffRan+'.png');

    if (lmc <= 10) {
        setTimeout("loopMoHolder("+lmc+","+thisMoDivID+")" , 500); }
    else {
        $('#'+thisMoDivID+' .moHolder .ffbg img').attr('src','/img/moMoniker/mo10.png');
    }
    }
</script> 
```

这是html

```
<div class="moHolder">
    <div id='mo456' class="moCol ffbg"><img src="/img/moMoniker/mo1.png"></div>
</div> 
```

我确定问题出在 setTimeout 行，但我不确定如何纠正它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T23:53:05.970

您不应该使用字符串作为`setInterval`.. 的执行函数的参数。它应该是一个函数（匿名与否）。事实上，这就是问题所在。你所做的相当于调用：

```
loopMoHolder(valueOfLmc, valueOfThisMoDivId) 
```

...插入到（显然）

```
loopMoHolder(9, #[object HTMLDivElement]) 
```

...这在语法上是不正确的。

相反，您可能想打电话

```
loopMoHolder(lmc, thisMoDivID) 
```

...因为其他两个变量甚至可能不存在或无法正常工作，甚至可能导致语法无效。

```
setTimeout(function () {
    loopMoHolder(lmc, thisMoDivID)
}, 5000); 
```

这听起来`setInterval`可能更合适，这样您就不必在方法本身中进行后续调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T23:55:42.890

不要将 setTimeout 与字符串参数一起使用，尤其是在传递对象时。我大方地重写了你的一些代码。

```
function loopMoHolder(lmc, thisMoDivID){
    var ffRan   = Math.floor(Math.random() * 10 + 1),
        $el     = $('#' + thisMoDivID + ' .moHolder .ffbg img');

    $el.attr('src', '/img/moMoniker/mo' + ffRan + '.png');

    if (lmc <= 10) {
        setTimeout(function() {
            loopMoHolder(lmc + 1, thisMoDivID);
        }, 500);
    } else {
        $el.attr('src', '/img/moMoniker/mo10.png');
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T00:04:00.860

```
var intervalId, intervalCount = 0,
    img = $('#mo456 .moHolder .ffbg img')[0],
    loopMoHolder = function(){
        var rand = parseInt(Math.floor((Math.random()*10)+1));
        if (++intervalCount < 10) {
            img.src = '/img/moMoniker/mo'+ rand +'.png';
        } else {
            img.src = '/img/moMoniker/mo10.png';
            window.clearInterval(intervalId);
        }
     };

intervalId = window.setInterval(loopMoHolder, 500); 
```

# php - 禁用 HTML 标记中的样式

> ID：15101654
> 
> 赞同：1
> 
> 时间：2013-02-26T23:42:32.267
> 
> 标签：php, html

如何禁用 HTML 标签中的样式，以便

```
"<b style="color:red;">" 
```

更改为

```
"<b>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:44:50.177

您可以使用正则表达式的强大功能...

```
$input = '<span style="color:red;">Example</span>';
$html = preg_replace('/(<[^>]+) style=".*?"/i', '$1', $input);

echo $html; 
```

这输出`<span>Example</span>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:47:39.630

最安全的方法是使用 DOM 解析器（例如[http://php.net/manual/en/book.dom.php](http://php.net/manual/en/book.dom.php)），遍历所有文档以查找`style`属性并删除它们。

# php - 在我的站点上从 mysql_connect 移动到 PDO

> ID：15101661
> 
> 赞同：-1
> 
> 时间：2013-02-26T23:43:13.637
> 
> 标签：php, jquery, mysql, pdo

我有一个无需刷新页面即可搜索的脚本。我正在尝试从旧连接转移`mysql_connect`到新`PDO`连接以使其更安全。我需要帮助更改我的 PDO 脚本，以便它与 post 函数一起使用。

我的 HTML 脚本：

```
<script type="text/javascript">
    $(document).ready(function(){
        $(".search").click(function(){
            $.post("search.php", { keywords: $(".keywords").val() }, function(data){
                $("div#content").empty()
                $.each(data, function(){
                    $("div#content").append("- <a href='#?id=" + this.id + "'>" + this.title + "</a><br>");
                });
            }, "json");
        });
    });
</script>
</head>
<body>
<input type="text" name="search" class="keywords">
<input type="submit" name="submit" class="search">
<div id="content">
</div> 
```

这是我的工作搜索脚本：

```
<?php
$link = mysql_connect("localhost","root","");
mysql_select_db("pirateconnection", $link);

$keywords = mysql_real_escape_string( $_POST["keywords"] );

$query = mysql_query("SELECT * FROM media WHERE title LIKE '%". $keywords ."%'");

$arr = array();
while( $row = mysql_fetch_array ( $query ) )
{
    $arr[] = array( "id" => $row["id"], "title" => $row["title"]);
}

echo json_encode( $arr );
?> 
```

我用 PDO 连接制作了一个新脚本：

```
<?php
$db = new PDO('mysql:host=localhost;dbname=pirateconnection','root','');

$query = $db->prepare("SELECT `media`.`title` FROM `media` WHERE `media`.`title` LIKE :keywords");

$keywords = (isset($_POST['keywords']) === true) ? $_POST['keywords'] : '';
$query->bindValue(':keywords', '%' . $keywords . '%', PDO::PARAM_STR);

try {
    $query->execute();

    $rows = $query->fetchAll(PDO::FETCH_ASSOC);
    echo '<pre>', print_r($rows, true), '</pre>';
} catch(PDOException $e) {
    die($e->getMessage());
}

?> 
```

现在我需要让 PDO 脚本与 html/jquery post 脚本一起工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:59:35.460

在我看来，您需要`try...catch`用以下内容替换该段，以使相同的 jQuery 正常工作

```
$arr = array();
$query->execute();
while( $row = $query->fetch(PDO::FETCH_ASSOC) ) {
    $arr[] = array( "id" => $row["id"], "title" => $row["title"]);
}
echo json_encode( $arr ); 
```

此外，更改您的准备查询以包括`id`：

```
$query = $db->prepare("SELECT `media`.`id`, `media`.`title` FROM `media` WHERE `media`.`title` LIKE :keywords"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:08:49.270

我就是这样做的。

```
 $query->setFetchMode(PDO::FETCH_ASSOC);
    $query->execute();
    $rows = array();
    while($row = $query->fetch()) {
     $rows[] = $row;
}
echo json_encode($rows);
exit;
} 
```

# c# - 使用 Tcp 获取 http 分块响应

> ID：15101664
> 
> 赞同：1
> 
> 时间：2013-02-26T23:43:43.010
> 
> 标签：c#, http, stream, tcpclient, networkstream

我想知道如何读取带有传输编码分块的http响应。
我写了一个我正在做的例子。我遇到的一个问题是，即使还有更多内容要阅读但在流中仍然不可用，它也会`clientStream.DataAvailable`返回。 欢迎就我的处理方式提出其他建议：`false`

```
StringBuilder response = new StringBuilder();

TcpClient tcpClient = new TcpClient("www.google.com", 80);

string request = "GET http://www.google.com/ HTTP/1.1\r\n";
request += "Host: www.google.com\r\n";
request += "User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0\r\n";
request += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n";
request += "Accept-Language: en-US,en;q=0.5\r\n";
request += "Accept-Encoding: gzip, deflate\r\n";
request += "Connection: keep-alive\r\n\r\n";

byte[] requestBuffer = Encoding.ASCII.GetBytes(request);
NetworkStream clientStream = tcpClient.GetStream();
clientStream.Write(requestBuffer, 0, requestBuffer.Length);

// Check to see if this NetworkStream is readable.
if (clientStream.CanRead)
{
    byte[] readBuffer = new byte[4096];
    int numberOfBytesRead = 0;

    // Incoming message may be larger than the buffer size.
    do
    {
        numberOfBytesRead = clientStream.Read(readBuffer, 0, readBuffer.Length);

        response.Append(Encoding.ASCII.GetString(readBuffer, 0, numberOfBytesRead));
    }
    while (clientStream.DataAvailable);
}

clientStream.Close();
tcpClient.Close();

Console.Write(response.ToString()); 
```

先感谢您。

# c# - 提高 SQLite 性能

> ID：15101665
> 
> 赞同：5
> 
> 时间：2013-02-26T23:43:49.687
> 
> 标签：c#, sql, sqlite

好吧，我有一个`file.sql`包含`20,000`插入命令的

`.sql`来自文件的样本

> 插入`table`值（1,-400,400,3,154850,'Text',590628,'TEXT',1610,'TEXT',79）；
> 
> 插入`table`值（39,-362,400,3,111659,'Text',74896,'TEXT',0,'TEXT',14）；

我正在使用以下代码创建内存中的 Sqlite 数据库并将值拉入其中然后计算经过的时间

```
using (var conn = new SQLiteConnection(@"Data Source=:memory:"))
{
    conn.Open();

    var stopwatch = new Stopwatch();
    stopwatch.Start();

    using (var cmd = new SQLiteCommand(conn))
    {
        using (var transaction = conn.BeginTransaction())
        {

                cmd.CommandText = File.ReadAllText(@"file.sql");
                cmd.ExecuteNonQuery();

            transaction.Commit();
        }
    }

    var timeelapsed = stopwatch.Elapsed.TotalSeconds <= 60
                          ? stopwatch.Elapsed.TotalSeconds + " seconds"
                          : Math.Round(stopwatch.Elapsed.TotalSeconds/60) + " minutes";
    MessageBox.Show(string.Format("Time elapsed {0}", timeelapsed));
    conn.Close();
} 
```

我尝试过的事情

1.  使用文件数据库而不是内存之一。
2.  使用开始事务和提交事务 [如我的代码中所示]。
3.  Using Firefox's extension named `SQLite Manager` to test whether the slowing down problem is from the script; However, I was surprised that the same `20,000` lines that i am trying to process using my code has been pulled to the database in JUST 4ms!!!.
4.  Using `PRAGMA synchronous = OFF`, as well as, `PRAGMA journal_mode = MEMORY`.
5.  Appending `begin transaction;` and `commit transaction;` to the beginning and ending of the `.sql` file respectively.

As the SQLite documentations says : SQLite is capable of processing `50,000` commands per seconds. And that is real and i made sure of it using the `SQLite Manager` [AS DESCRIPED IN THE THIRD SOMETHING THAT I'V TRIED]; However, I am getting my `20,000` commands done in 4 minutes something that tells that there is something wrong.

QUESTION : What is the problem am i facing why is the Execution done very slowly ?!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:10:03.800

SQLite.Net documentation recommends the following construct for transactions

```
using (SqliteConnection conn = new SqliteConnection(@"Data Source=:memory:")) 
{
  conn.Open();
  using(SqliteTransaction trans = conn.BeginTransaction())
  {
    using (SqliteCommand cmd = new SQLiteCommand(conn))
    {
      cmd.CommandText = File.ReadAllText(@"file.sql");
      cmd.ExecuteNonQuery();
    }
    trans.Commit();
  }
  con.Close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T15:16:18.510

Are you able to manipulate the text file contexts to something like:

```
INSERT INTO table (col01, col02, col03, col04, col05, col06, col07, col08, col09, col10, col11)
SELECT 1,-400,400,3,154850,'Text',590628,'TEXT',1610,'TEXT',79
UNION ALL
SELECT 39,-362,400,3,111659,'Text',74896,'TEXT',0,'TEXT',14
; 
```

Maybe try "batching them" into groups of 100 as a initial test.

[http://sqlite.org/lang_select.html](http://sqlite.org/lang_select.html)

SqlLite seems to support the UNION ALL statement.

# windows - R 15.2 Windows XP 下的 cppFunction(Rcpp) 出错

> ID：15101667
> 
> 赞同：1
> 
> 时间：2013-02-26T23:44:14.933
> 
> 标签：windows, r, compiler-errors, windows-xp, rcpp

当我打电话时：

```
cppFunction('
  int add(int x, int y, int z) {
    int sum = x + y + z;
    return sum;
  }'
) 
```

出现以下消息错误，有人遇到过类似问题吗？任何线索如何解释此消息？

```
g

    ++  -I"D:/PROGRA~1/R/R-215~1.2/include" -DNDEBUG     -I"D:/Program Files/R/R-2.15.2/library/Rcpp/include"      -O2 -Wall  -mtune=core2 -c filed946a0620c7.cpp -o filed946a0620c7.o g++ -shared -s -static-libgcc -o sourceCpp_70998.dll tmp.def filed946a0620c7.o D:/Program Files/R/R-2.15.2/library/Rcpp/lib/i386/libRcpp.a -LD:/PROGRA~1/R/R-215~1.2/bin/i386 -lR g++.exe: error: D:/Program: No such file or directory g++.exe: error: Files/R/R-2.15.2/library/Rcpp/lib/i386/libRcpp.a: No such file or directory 
    Error in sourceCpp(code = code, env = env, rebuild = rebuild, showOutput = showOutput,  : 
  Error occurred building shared library. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T02:23:35.763

您将 R 安装在带有空格的路径中。这会破坏事情。

即使 R-on-Windows 常见问题解答说不这样做，R 默认也是如此。

下一个 Rcpp 版本对此进行了防御。在那之前，移动你的 R 安装。

哦，我可能已经在 SO 上回答*了这个问题*三遍了......

# java - 通过 SQL 查询在 JTree 中动态创建节点

> ID：15101671
> 
> 赞同：1
> 
> 时间：2013-02-26T23:45:01.983
> 
> 标签：java, swing, jtree, treenode

我有这样的层次结构：

```
Lot
 |_Stages
    |_Samples 
```

例子：

```
Lot1
 |_Stage1
     |_Sample11 
     |_Sample12 
 |_Stage2
     |_Sample21 
     |_Sample22 
```

这个想法是用户将提供一个 LotID 并基于此我的 SQL 查询检索所有阶段以及每个阶段内的所有样本。

我将结果集中的每条记录保存为自定义对象并将其添加到数组列表中。

结果集输出示例：

> 批号 || 批次条件 || 阶段ID || 阶段条件 || 样品编号 || 样品条件
> 
> --------|| -------------- || ------------ || -------------------- || ------------|| ----------------
> 
> 5001 || 处置|| 4001 || 完成 || 3001 || 得到正式认可的
> 
> 5001 || 处置|| 4001 || 完成 || 3002 || 得到正式认可的
> 
> 5001 || 处置|| 4002 || 完成 || 3003 || 得到正式认可的
> 
> 5001 || 处置|| 4002 || 完成 || 3004 || 得到正式认可的
> 
> 5002 || 准备发布|| 4003 || 完成 || 3005 || 得到正式认可的
> 
> 5003 || 处置|| 4004 || 完成 || 3006 || 得到正式认可的
> 
> 5004 || 处置|| 4004 || 完成 || 3007 || 得到正式认可的

从这个数组列表中，我使用 DefaultMutableTreeNode 将对象添加到树中（即 new DefaultMutableTreeNode(custom_object.getLotID)..etc）。

现在有2个问题：

1.  只有一个唯一的 LotID = 5001，但它显示了 4 次（来自上面的示例），因为有 4 个样本，因此有 4 条记录。

2.  我的目标是首先检索 SampleID 并将其添加到各自的 StageID，最后将所有 StageID 添加到 LotID（根节点）。我不知道如何以分层方式显示。

谁能指出我正确的方向或一些想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:58:23.700

Ok..I found a way to do this and thought I might share it. I did not use the MutableTreeModel.

I decided to create loops i.e. when the result set is retrived. For example: I fetch the result set for Stages and within in I try to fetch for all the Samples with in each Stage.

Now I had 2 options, one was to store these result sets into a DefaultMutableTreeNode or to store them in an ArrayList and HaspMap (for example: I could have created a HashMap for Stage IDs as my keys and its Samples in an ArrayList as its values. Then because we can pass in any type of object other than a DefaultMutableTreeNode object to a TreeModel, we can pass in this HashMap object and use a custom TreeModel to handle it. This would also require my objects saved in the Arraylists override the HashCode and Equals method.

But I think, for my application, it is simple to go with option 1.

# bash - 关于文件年龄的 BASH 删除脚本

> ID：15101674
> 
> 赞同：0
> 
> 时间：2013-02-26T23:45:14.710
> 
> 标签：bash, find

我是一个脚本新手。我正在尝试为我的 Ubunutu 10.04 服务器编写一个简单的 bash 脚本，以删除另一个文件夹中超过 30 天和超过一年的文件夹中的档案。它们可以是两个不同的命令行，因为我会将它们放在不同的脚本中。

我刚开始尝试以下方法，这根本不起作用：

```
# find ~/addon_backups/202 -name 202adata* -maxdepth 0 -ctime +30 
```

和

```
# find ~/addon_backups/202/ME -name *.tar.gz -maxdepth 0 -ctime +365 
```

我分别得到以下信息：

```
find: paths must precede expression: 202adata_010213.tar.gz
Usage: find [-H] [-L] [-P] [-Olevel] [-D help|tree|search|stat|rates|opt|exec] [path...] [expression] 
```

和

```
find: paths must precede expression: 0213ME-202.tar.gz
Usage: find [-H] [-L] [-P] [-Olevel] [-D help|tree|search|stat|rates|opt|exec] [path...] [expression] 
```

我尝试了多种变体，但我显然遗漏了一些东西。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:52:37.990

您必须将参数引用到 -name 以便 shell 不会解释它（[shellcheck 会](http://www.shellcheck.net)自动指出这一点）：

```
find ~/addon_backups/202/ME -name "*.tar.gz" -maxdepth 0 -ctime +365 
```

另请注意，您将要使用`-mtime`代替`-ctime`，`-maxdepth 1`而不是 0，并且可以使用`-exec rm () {} +`删除：

```
find ~/addon_backups/202/ME -name "*.tar.gz" -maxdepth 1 -mtime +365 -exec rm {} + 
```

或者更简单地说：

```
find ~/addon_backups/202/ME/*.tar.gz -mtime +365 -exec rm {} + 
```

# c - 有没有办法将字符串分配给与其声明分开的字符数组？

> ID：15101678
> 
> 赞同：1
> 
> 时间：2013-02-26T23:45:27.000
> 
> 标签：c

我试过这段代码：

```
#include <stdio.h>

main()
{
char s[10][10];
s[10] = "Hi!";
printf("%s",s[1]);
return 0;
} 
```

其中编译器给了我这个错误：

```
".......lvalue expected" 
```

我刚开始学习C，所以我不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T23:47:25.860

您可以在定义时进行初始化，例如：

```
#include <stdio.h>

int main()
{
    char s[10][10] = { "Hello", "Hi!", "Bonjour", "Hola", "", "", "", "", "", "" }; 

    printf("%s\n", s[1]);
    return 0;
} 
```

或用于`strcpy()`稍后分配字符串，例如

```
#include <stdio.h>
#include <string.h>

int main()
{
    char s[10][10];

    strcpy(s[1], "Hi!");   // s[1] = "Hi!"
    printf("%s\n", s[1]);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:09:02.897

当您编写`"Hi!"`代码时，它是一个变相的指针值（例如，编译器将替换为指向`"Hi!"`内存中某处的地址，该地址包含四个字节“H”、“i”、“!”和“\0”）。对于您的变量`s`，内存在声明时已经分配，​​并且是变量的组成部分，因此将指针分配给元素没有意义（类型不匹配）。

如果您改为声明`s`为

```
char *s[10]; 
```

然后你就可以把你的代码写成

```
s[1] = "Hi!";
printf("%s",s[1]); 
```

# iphone - 为子视图 iphone 实现滚动视图

> ID：15101689
> 
> 赞同：0
> 
> 时间：2013-02-26T23:47:12.320
> 
> 标签：iphone, uiscrollview

如何将此视图包含在 scrollerView 中？

我有一个带有不同文本字段的子视图，我想将它放在滚动视图中，以便当用户单击字段视图时滚动。

```
 - (UIView *)Form
{
    if (!_Form) {

        CGRect frame = CGRectMake(0.0, Height, Width, 310.0);
        UIView *container = [[UIView alloc] initWithFrame:frame];

        CGFloat y = 15.0;
        frame = CGRectMake(15.0, y, width, height);
        UITextField *field = [[UITextField alloc] initWithFrame:frame];
        [
        field.placeholder = @"text";

        CGFloat spacing = 8.0;
        y = frame.origin.y + height + spacing;
        frame = CGRectMake(15.0, y, kDeviceWidth - 2*15.0, height);
        field = [[UITextField alloc] initWithFrame:frame];

        field.placeholder = @"text6";

        frame.size.height = 200.0;

        y = frame.origin.y + height + space;
        frame = CGRectMake(15.0, y, width - 2*15.0, height);
        field = [[UITextField alloc] initWithFrame:frame];

        field.placeholder = @"text1*";

        y = frame.origin.y + height + 16.0;
        CGFloat w = (kDeviceWidth - 2 * 15.0) / 2;
        frame = CGRectMake(15.0, y, w - 2.0, height);
        field = [[UITextField alloc] initWithFrame:frame];

        field.placeholder = @"text3*";

        frame = CGRectMake(15.0 + w + 2.0, y, w - 2.0, height);
        field = [[UITextField alloc] initWithFrame:frame];

        field.placeholder = @"text4*";

        y = frame.origin.y + height + spacevalue;
        frame = CGRectMake(15.0, y, w, height);
        field = [[UITextField alloc] initWithFrame:frame];

        field.placeholder = @"text5";

        y = frame.origin.y + height + 20.0;
        frame = CGRectMake((frame.size.width - 192.0) / 2, y, 192.0, 34.0);

        y = frame.origin.y + height + 8.0;
        frame = CGRectMake((frame.size.width - 192.0) / 2, y, 192.0, 34.0);
    }
    return _Form;
} 
```

你能帮我写代码吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:07:05.600

我有这个代码：

```
CGPoint puntoInicial;
-(void) textFieldDidBeginEditing:(UITextField *)textField {
    CGPoint pt;
    CGRect rc = [textField bounds];
    rc = [textField convertRect:rc toView:scrollView];
    pt = rc.origin;
    puntoInicial = pt;
    pt.x = 0;
    pt.y -= 250;
    [scrollView setContentOffset:pt animated:YES];
    textField.autocapitalizationType = UITextAutocapitalizationTypeAllCharacters;
}

//Bajar la pantalla cuando se termina de editar
-(void) textFieldDidEndEditing:(UITextField *)textField {
    puntoInicial.x = 0;
    puntoInicial.y = 0;
    [scrollView setContentOffset:puntoInicial animated:YES];
} 
```

只把它放在你的代码和 textField -> Connections inspector -> Oulets -> Delegate 中，把文件所有者

# r - 确定多天中的哪些小时具有非 NA 值

> ID：15101692
> 
> 赞同：0
> 
> 时间：2013-02-26T23:47:15.733
> 
> 标签：r

我有一个包含三列的数据框：DATE、HOUR、HRC（因此每个 DATE 有 24 行）HRC 列有时是数字，有时是 NA。我试图找出一种方法来获取 DATE 的子集，然后找出在所有日子中具有非 NA 值的 HOUR。

示例：因此，如果 DATES 是 Aug16、Aug18、Aug19，并且 HRC 列在 Aug16 在 HOURS 8、9、10、11、12... Aug18 在 HOURS 7、8、9、10、11 时具有非 NA 值。 .Aug19 在 9、10、11、12、13 小时。我希望结果是 9、10、11 小时的列表，因为这些是所有日期的非 NA 小时。

在 Gary 的解决方案中将 sum(is.na(x$HRC)) 调整为 sum(!is.na(x$HRC)) 就可以了。谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:53:17.757

您没有提供示例，因此我们对您的问题感到非常困惑。提供一个可重现的例子通常是有建设性的。即使我承认使用日期类型创建示例有点挑战。

```
set.seed(1234)
#generate sequence of 25 days hour by hour
x <- Sys.time() + seq(1,by=60*60,length.out=24*25)
hh <- as.POSIXlt(x)$hour
## generate the data.frame
dat <- data.frame(DATE = as.POSIXct(format(x,"%Y-%m-%d")),
                  HOUR=as.POSIXlt(x)$hour,
                  HRC  = 1:length(x))
## introduce random NA
id <- sample(nrow(dat),10,rep=F)
dat$HRC[id] <- NA 
```

我的解决方案从这里开始；它类似于 Gary 解决方案，我使用的是`plyr`包但具有不同的功能。

```
## I choose 2 dates to subset
min.d <- as.POSIXct('2013-03-01')
max.d <- as.POSIXct('2013-03-15')

dat.s <- subset(dat, DATE >=min.d & DATE <= max.d )

res <- ddply(dat.s, .(HOUR),   ## grouping by hour
      function(x){   
        any(is.na(x$HRC))  ## I retuen one HRC at least is NA
      }) 
```

结果：

```
res[res$V1,]
  HOUR   V1
6     5 TRUE
12   11 TRUE
14   13 TRUE
17   16 TRUE
19   18 TRUE
22   21 TRUE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:05:50.383

你可以尝试这样的事情：

```
library(plyr)

# assuming your dates are in some date format
d_0 <- as.Date('02-01-2010',format='%m-%d-%Y')

d_1 <- as.Date('02-10-2010',format='%m-%d-%Y')

# assuming your data are in data frame 'dat', get some subset of dates
some_dates <- subset(dat, DATE > d_0 & DATE < d_1)

# count the NAs for each hour
hr_count <- ddply(some_dates, .(HOUR), function(x) sum(!is.na(x$HRC))) 
```

# c# - 我需要什么来进一步限定 DataContext 以进行绑定？

> ID：15101696
> 
> 赞同：22
> 
> 时间：2013-02-26T23:47:26.163
> 
> 标签：c#, wpf, data-binding, mvvm

我已经创建并将在这个问题中引用的文件是：

```
TechnicainSelectionView.xaml
TechnicianSelectionView.cs
TechnicianSelectionViewModel.cs
Technician.cs (Code First Entity) 
```

我的 TechnicanSelectionView.xaml 中有以下 xaml

```
<UserControl xmlns etc... here" 
             d:DesignHeight="48" d:DesignWidth="300">
    <Grid>
        <StackPanel>
            <Label Content="Select a Technican to run the test" FontWeight="Bold"></Label>
            <ComboBox ItemsSource="{Binding Technicians, Mode=TwoWay}"></ComboBox>
        </StackPanel>
    </Grid>
</UserControl> 
```

ItemSource 设置为绑定到的 Technicians 属性声明它`Cannot resolve Technicians due to an unknown DataContext.`

因此，如果我们查看我的 TechnicianSelectionView.cs 代码隐藏...

```
public partial class TechnicianSelectionView : UserControl
{
    public TechnicianSelectionViewModel ViewModel { get; private set; }

    public TechnicianSelectionView()
    {
        InitializeComponent();

        Technician.GenerateSeedData();

        ViewModel = new TechnicianSelectionViewModel();
        DataContext = ViewModel;
    }
} 
```

...我们看到我正在将视图的 DataContext 设置为我的 TechnicianSelectionViewModel ...

```
public class TechnicianSelectionViewModel : ViewModelBase
{
    public ObservableCollection<Technician> Technicians { get; set; }

    public TechnicianSelectionViewModel()
    {
        Technicians = new ObservableCollection<Technician>();
    }

    public bool IsLoaded { get; private set; }

    public void LoadTechnicians()
    {
        List<Technician> technicians;

        using (var db = new TestContext())
        {
            var query = from tech in db.Technicians
                        select tech;

            foreach (var technician in query)
            {
                Technicians.Add(technician);
            }
        }

        IsLoaded = true;
    }
} 
```

技术人员是我的 ViewModel 上的一个属性...

因此，已经为视图设置了 DataContext，为什么它不能将 ViewModel 上的 Technicians 解析为它要绑定的 DataContext/property？

## **编辑：**

根据下面评论中的担忧。这是设计时问题，而不是编译时问题。我应该在一开始就指出这一点。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-26T23:54:35.810

您需要在 xaml 中指定数据上下文的类型以获得设计时支持。即使您在代码隐藏中分配了数据上下文，设计人员也不会认识到这一点。

尝试将以下内容放入您的 xaml：

```
d:DataContext="{d:DesignInstance vm:TechnicianSelectionViewModel}" 
```

有关更多详细信息，请参阅[此链接](http://www.codeproject.com/Tips/879109/Using-Design-time-Databinding-While-Developing-a-W)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-12T09:36:06.807

在我的 Xamarin Forms Xaml 文件中，我在标题（ContentPage 标记）中使用了以下几行，它可以按我的意愿完美运行。

基本上现在

*   智能感知显示绑定中的字段
*   如果我重构属性的名称，我的 Resharper 能够重命名 Xaml 文件中的绑定

    ```
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:vm="clr-namespace:YourApplicationName.ViewModels;assembly=YourApplicationName"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance {x:Type vm:CurrentPageViewModel}}" 
    ```

# sql - 将数据类型 DBTYPE_DBDATE 转换为日期时出错

> ID：15101698
> 
> 赞同：0
> 
> 时间：2013-02-26T23:47:44.507
> 
> 标签：sql, sql-server-2008, load

我正在尝试使用以下命令将数据从文件加载到 SQL Server Express：

```
BULK INSERT Clients_test FROM 'c:\clints_aa.csv'
    WITH ( KEEPIDENTITY, FIELDTERMINATOR = ',', ROWTERMINATOR = '\n'
) 
```

但我得到这个错误：

> 消息 8114，级别 16，状态 10，第 2
> 行将数据类型 DBTYPE_DBDATE 转换为日期时出错。

样本数据：

```
1,F,L,E,1950-12-18,x,-,z,6,k,r,4,1,N,1,m,,3,5,o,3,0,0,0,0,1,,,1900-01-01,1900-01-01,-
2,O,L,F,1946-06-23,y,-,z,6,l,s,5,0,N,1,n,,1,7,p,1,0,1,1,0,4,,,1900-01-01,1900-01-01,- 
```

包含日期的列是最后一列之前的第 5 列和第 2 列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:52:13.777

当您尝试将日期时间值作为字符串插入时，您需要在 T-SQL 中将它们转换为 DATETIME：

```
CONVERT('2013-02-26 16:51:23.767', GETDATE(), 126) 
```

这是使用普通的 T-SQL，并且不考虑批量插入。如果你想使用批量插入，如果你有 Visual Studio Business Intelligence Development Studio 会有所帮助。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms173767.aspx](http://msdn.microsoft.com/en-us/library/ms173767.aspx)。

# c# - 填充 ObservableCollection 使用字符串数组

> ID：15101699
> 
> 赞同：5
> 
> 时间：2013-02-26T23:47:45.533
> 
> 标签：c#, observablecollection

全部，

这里需要一些帮助..我有一个字符串数组，需要将它绑定到 ObservableCollection

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-26T23:49:49.617

该类`ObservableCollection<T>`可以在构造函数上接收一个`IEnumerable<T>`。你可以像这样使用它：

```
string[] items = ...
ObservableCollection<string> observableItems = new ObservableCollection<string>(items); 
```

**编辑：**如果您的阵列将来发生变化，您`ObsevableCollection`不会。如果您需要，请在您的问题中指定。

# ios - EAGLLayer 可以“选择性”保留支持吗？

> ID：15101700
> 
> 赞同：1
> 
> 时间：2013-02-26T23:47:49.077
> 
> 标签：ios, objective-c, opengl-es-2.0

我正在使用 openGL ES 2.0 为 iOS 制作一个绘画程序。在我的程序中，有一个带有保留支持的 EAGLLayer。每个绘图操作都“粘在”图层上，从而构建了用户的绘画。

然而，现在我需要一些图形出现在屏幕上而不被添加到绘画中——就像一个可以通过触摸定位并影响绘画风格但实际上不应该成为绘画的一部分的光标。

我可以通过在同一个 EAGLLayer 中为光标添加第二个渲染缓冲区来做到这一点，还是在绘画 UIVIew 之上有另一个 UIView 会更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T00:34:07.907

就我的目的而言，让 UIView（光标）漂浮在我的 EAGLLayer 之上并没有什么不好的地方。将 UIView 添加为我的主视图控制器视图的子视图，而不是 EAGLLayer 的子视图，并确保它位于 EAGLLayer 之上。不知道为什么我认为这会很棘手，回想起来！

# php - php exit() 函数导致内存泄漏

> ID：15101701
> 
> 赞同：3
> 
> 时间：2013-02-26T23:47:53.460
> 
> 标签：php

我正在使用一个 ajax 请求页面，并在其中添加 exit(); 函数停止加载模板，因为它是一个 ajax 请求。

问题是每次我添加 exit() 时，内存都不会被释放。我这样检查内存：

```
//mypage.php
echo memory_get_usage(); exit(); // This results to memory to climb up for every page refresh.
===============================
//mypage.php
echo memory_get_usage(); // The memory is ok

//For clarification the above codes are executed at different times. 
```

可能是什么问题呢？如何在退出时释放内存？请帮忙谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:53:50.893

这似乎是 PHP 的一个已知方面，并且根据肯定比我知识多得多的人的说法，这是一种故意的。有人有一个完全相同的问题（[http://comments.gmane.org/gmane.comp.php.devel/77918](http://comments.gmane.org/gmane.comp.php.devel/77918)），事实证明他们是故意这样做的：

> 我们确实有一些故意泄漏，我们依赖池分配器在请求结束时擦除内容。因此，与您在请求中发现一个请求相比，我不太关心您在请求终止时看到的内容。

希望这对您的问题有所启发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:47:43.030

我能够重现您的错误的唯一方法是每次存储一个值并将其**长度**`$_SESSION`加倍。这是我的代码：

 **```
<?php

session_start();

if (!isset($_SESSION['test'])) {
    $_SESSION['test'] = 'abcdefghij';
}
else {
    $_SESSION['test'] .= $_SESSION['test'];
}
$_SESSION['memory'][] = memory_get_usage();

print_r($_SESSION['memory']);
exit; 
```

刷新页面 24 次后，我终于让它耗尽内存：

```
Array
(
    [0] => 231768
    [1] => 232088
    [2] => 232248
    [3] => 232424
    [4] => 232640
    [5] => 232728
    [6] => 233200
    [7] => 233984
    [8] => 235376
    [9] => 238136
    [10] => 243392
    [11] => 253768
    [12] => 274384
    [13] => 315480
    [14] => 397536
    [15] => 561512
    [16] => 889328
    [17] => 1544952
    [18] => 2855808
    [19] => 5477384
    [20] => 10720400
    [21] => 21206296
    [22] => 42177952
    [23] => 84121128
)
Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 83886344 bytes) in Unknown on line 0 
```

可以看到每次刷新页面时内存使用量都会增加。

当您告诉 PHP 时`exit`，它不会在您的代码中执行任何进一步的操作。我的猜测是，在你做之后的某个地方`exit`，你也会做类似的事情：

```
$_SESSION['test'] = 'something else'; 
```

当您`exit`打开页面时，它不会被执行，因此会将其投入指数递增的循环中，每次都会增加内存使用量。如果您找不到类似的东西，我建议您查看[Xdebug](http://www.xdebug.org/)以更好地了解正在发生的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T23:54:34.400

我认为您误解了导致内存泄漏的原因。如果您尝试将代码修改为以下代码，那么您将看到`exit`调用后没有任何运行。

```
echo memory_get_usage(); exit(); // This results to memory to climb up for every page refresh.

echo "I will never echo". PHP_EOL;
echo memory_get_usage(); // The memory is ok 
```

为了正确调试，我建议在所有内联调试中包含一些额外的调试上下文，如下所示：

```
echo "before database call: ". memory_get_usage() . PHP_EOL; 
```

然后从他们那里找出内存使用量开始攀升的地方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T01:06:06.517

伙计们谢谢你的帮助，我真的很感激。我很幸运我发现了这个问题。它可能是包含 ob_start() 的模板类的 render() 方法。因此，当在 mypage.php 中调用 exit() 函数时（包含在 render() 中）。输出缓冲区可能已耗尽。我不确定这可能是问题，但我能够通过更改执行模板->渲染（）的顺序来解决问题；

多谢你们！！**

# c++ - C++ 中是否有类似双端队列的位集？

> ID：15101703
> 
> 赞同：4
> 
> 时间：2013-02-26T23:47:56.420
> 
> 标签：c++, vector, boolean, deque, bitset

我正在尝试使用位过滤器存储一个非常大的搜索掩码。

两者都`std::vector<bool>`将`std::bitset<n>`它们的 bool 表示形式存储为位，这与通常为 a`char`或大小的普通 bool 不同`int32_t`。

问题是这两种数据结构都将它们的元素存储在一个巨大的块中。操作系统因为我请求太大的块而生我的气。要做的一件事`std::deque<bool>`是将其元素存储在我认为的链表之类的东西中。

现在我知道你不能在不移位的情况下使用指向单个位的指针，并且使用链表类型结构会破坏内存保护的目的。但是您可以像 2gig 块一样存储`char[]`，使用移位设置各个位，然后将链接指针指向另一个 2gb 块，你挖吗？

所以告诉我这种类型的结构是否存在于某个地方，或者甚至是可能的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T00:23:05.633

我不知道您的问题有任何直接解决方案，但可以通过自定义容器轻松解决。

一种解决方案将简单地涉及 std::bitset 的 std::deque。其中 bitset 的大小是 2 的幂，例如 256。有了这个，您可以获取索引并单独屏蔽 deque 索引和 bitset 索引：

```
std::deque< std::bitset<256> > ;
unsigned long long = 1500;

bool val = bigBitset[ index>>8 ][ index & 0xFF ]; 
```

为了方便起见，这也可以封装在一个类中：

```
class DequeBitset : public std::deque< std::bitset<256> >
{
public:
    struct Index
    {
        unsigned long index;

        unsigned long dequeIndex() const { return index>>8; }       
        unsigned long bitsetIndex() const { return index&0xFF; }
        Index( unsigned long index ) : index(index) {}
    };
public:

    bool operator[]( const Index& index )
    { return std::deque< std::bitset<256> >::operator [](index.dequeIndex())[ index.bitsetIndex() ]; }
};

int _tmain(int argc, _TCHAR* argv[])
{
    DequeBitset test;
    test.resize(10);
    bool val = test[259];
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:10:34.307

具有所需“块”类（例如，为方便起见，无符号字符[N]，或包装类（甚至位集））的专用双端队列/队列具有自定义相等性和对相应块进行操作的按位运算符可以实现此目的。

那些自定义的按位方法将需要通过根据修改操作将操作的每个输入“全局”位索引转换为一组（块编号，块本地）索引来确定要操作的块/范围。非修改操作/查询可以实现为对所有块的简单遍历。

一般的想法是将位掩码拆分为块并对这些块序列进行操作，因为根据内存碎片，您可能无法在*运行时*分配 2GB 或更多的连续内存。当然，块大小越小，处理开销、缓存一致性降低和内存碎片就越多，但是，在您的客户端应用程序中，您可能能够从内存中挤出更多内存。

正如@Crog 提到的那样，似乎已经有一个实现：[`boost::dynamic_bitset`](http://www.boost.org/doc/libs/1_52_0/libs/dynamic_bitset/dynamic_bitset.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T00:11:23.147

我不知道您可以使用多少个 2GB 块。但是假设您需要 2048 个 2GB 块。那么为什么不将指向 2GB 块的指针存储在向量中，即，`std::vector<uint8_t*>`在需要扩展结构时将新的 2GB 块添加到该向量中。

# windows - 如何成功运行多个命令

> ID：15101705
> 
> 赞同：5
> 
> 时间：2013-02-26T23:48:01.887
> 
> 标签：windows, powershell

在 bash 和 CMD 中，您可以`rm not-exists && ls`将多个命令串在一起，每个命令只有在前面的命令成功时才会有条件地运行。

在 powershell 中，您可以执行此操作`rm not-exists; ls`，但`ls`即使`rm`失败，也将始终运行。

如何轻松复制 bash 和 CMD 的功能（在一行中）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T01:40:00.557

默认情况下，Powershell 中的大多数错误都是“非终止的”，也就是说，它们不会导致您的脚本在遇到它们时停止执行。这就是为什么`ls`即使在命令出错后也会执行`rm`。

不过，您可以通过多种方式更改此行为。`$errorActionPreference`您可以通过变量（例如）全局更改它`$errorActionPreference = 'Stop'`，或者通过设置参数仅针对特定命令更改它`-ErrorAction`，这对所有 cmdlet 都是通用的。这是对您最有意义的方法。

```
# setting ErrorAction to Stop will cause all errors to be "Terminating"
# i.e. execution will halt if an error is encountered
rm 'not-exists' -ErrorAction Stop; ls 
```

或者，使用一些常见的速记

```
rm 'not-exists' -ea 1; ls 
```

`-ErrorAction`参数说明帮助。类型`Get-Help about_CommonParameters`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:02:43.807

要检查 powershell 命令的退出代码，您可以使用`$?`.

例如，以下命令将尝试删除`not-exists`，如果成功，它将运行`ls`.

```
rm not-exists; if($?){ ls } 
```

# scheme - 方案函数检查常量/元音

> ID：15101706
> 
> 赞同：0
> 
> 时间：2013-02-26T23:48:03.813
> 
> 标签：scheme, racket

如何在 Dr. Racket 中创建函数使用字符串**str并在****str**至少有一个元音时产生 true ，如果**str**没有元音则产生 false。

 **元音是以下字符集：A、a、E、e、I、i、O、o、U、u。

例如：

```
 (has-vowel? "whatever") => true 
         (has-vowel? "trythnks") => false 
```

* * *

@ÓscarLópez 这就是我迄今为止想出的。该函数可以判断第一个字母是否为元音。我现在的问题是，如何获得检查其他字母的功能？

我在 Scheme 中不断收到此错误 *（其余：需要一个非空列表；给定“字符串”）*

我不知道如何修复它。非常欢迎任何帮助/建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:34:51.957

这看起来像家庭作业，所以我会给你一些开始的提示。首先，让我们将问题拆分为两个过程 - 第一个过程将字符串转换为字符列表，并且还将定义我们要查找的字符列表。填空：

```
(define (has-vowel? str)
  (any-in-list        ; helper procedure, we'll get to this later
   (<???> str)        ; how to transform a string into a list of chars?
   '(#\A #\a <???>))) ; list of vowels 
```

有了上面的过程，我们就可以编写我们的辅助过程了`any-in-list`。这是确定一个列表中的任何元素是否在另一个列表中的通用解决方案 - 将其视为判断两个列表的交集是否为非空的谓词：

```
(define (any-in-list lst check)
  (cond (<???> <???>) ; if lst is empty, we didn't find any element, return #f
        (<???> #t)    ; return #t if the first element in lst is in check
        (else (any-in-list <???> check)))) ; else advance the recursion over lst 
```

棘手的部分在`any-in-list`. 我们如何确定一个元素是否在另一个列表中？我们可以为此编写另一个帮助程序，但快速查看[文档](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._member%29%29)会让您走上正轨。并且不要忘记测试您的代码，这应该可以按预期工作：

```
(has-vowel? "whatever")
=> #t
(has-vowel? "trythnks")
=> #f 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:02:10.017

一种解决方案是：

1.  将字符串转换为字符列表（[string->list](http://docs.racket-lang.org/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string-~3elist%29%29)）
2.  遍历列表并检查元音字符（[字符](http://docs.racket-lang.org/guide/characters.html)）**

# rabbitmq - 主题交换是唯一支持通配符的交换吗？

> ID：15101707
> 
> 赞同：4
> 
> 时间：2013-02-26T23:48:29.140
> 
> 标签：rabbitmq, amqp

在试图理解直接、扇出和主题交换之间的区别时，我想确认主题交换的优点是生产者推送到交换并指定完全特定的路由键，队列可以通过绑定到多个路由键通配符。例如主题推送到...

```
$channel->basic_publish($msg, 'logs-exchange', 'error.critical.ram') 
```

一个队列会向待命团队发送关于所有严重错误的消息，就像......

```
$channel->queue_bind('on-call-team', 'logs-exchange', 'error.critical.*') 
```

一个类似的队列`error.*.ram`会向负责增加内存的系统操作团队发送消息。

这是主题交换的正确用例吗？主题交换是唯一可以支持这种灵活性的交换吗？相反，主题交换和扇出交换都可以通过主题交换实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T07:34:16.937

> 这是主题交换的正确用例吗？

是的，此交换的绝对正确用法。你会看到它非常强大

> 主题交换是唯一可以支持这种灵活性的交换吗？

是的，类似的直接交换将不支持通配符，因此您必须在绑定时指定完整的路由密钥，否则它将无法接收消息。可能有使用主题交换作为基础的自定义消息，但我想不出一个

> 相反，主题交换和扇出交换都可以通过主题交换实现吗？

我不确定你在这里的意思。是的，您可以使用相同的绑定键将多个队列绑定到交换器，因此它们都会收到相同的消息。但是，如果您不需要该功能，那么您不妨使用扇出交换本身。

此外，我有一个绑定到一些队列和主题交换的扇出交换。此交换的发布者使用路由密钥，即使扇出交换不需要它，但它被路由到的主题交换需要它。这很好，因为它对扇出没有影响，因为我们对主题交换造成了问题

# javascript - Meteor 会话试图触发模板渲染

> ID：15101714
> 
> 赞同：3
> 
> 时间：2013-02-26T23:48:56.890
> 
> 标签：javascript, jquery, meteor, handlebars.js

目前我遇到了流星会话以及我的代码如何触发它来呈现模板的问题。目前我有一个会话将其 ._id 设置为单击的任何内容。

```
Template.sidebar.events({
/* on click of current sidecat class change to sidecat selected */
'click .sidecat': function (event) {
    Session.set("selected_project", this._id);
    }
}); 
```

如果 selected_player 等于 div，我让它添加一个 css 类。

```
Template.sidebar.sidebarselected = function () {
   return Session.equals("selected_project", this._id) ? "sidebarselected" : '';
} 
```

现在，我在有侧栏和另一个类时渲染模板。单击项目时，它会呈现模板。

```
Template.sidebar.projectselected = function() {
var find = Session.get("selected_project");
var find2 = ($("#"+find).attr('class'));
/* if exists return true render the template */
if (find2 == 'project sidebarselected')
{
  return  true
}
/* else don't render it return null */
else {
  return null
}
}; 
```

到目前为止，一切都很好。现在我有一个按钮，它在列表中创建一个新项目并使其成为选定项目。这就是问题发生的时候。当我创建一个新项目时，会呈现列表项并给定类侧边栏，但它不会呈现应该调用的模板。当我单击一个项目时，它会呈现模板。但不是在使用按钮创建新列表项时。它被选中但不呈现模板。这是代码。

```
Template.sidebar.events({
/* add bar settings menu functions for clicks */
'click #newProject': function(event){ 
  var create = NewProject();
  Session.set("selected_project", create);
}, 
```

这是 NewProject 函数

```
/* add a new project to the side bar */
function NewProject() {
id = Aprojects.insert({
  name: "New Project",
  type: "project"
});
doc = Aprojects.findOne({_id:id});
return doc._id;
} 
```

好的，有一切。当我单击按钮时创建项目，添加类但未呈现模板。这是所有的javascript，如果需要html，请告诉我，我会提供。

让我添加一些细节和 html 模板的东西。但无论如何，有效的是

*   您可以在列表中选择一个项目
*   当您选择一个项目（通过单击它）时，它会被赋予一个类名以表明它已被选中
*   当您单击“新项目”时，您想将一个项目添加到列表中并立即选择它

一切正常。问题是单击新项目按钮时。它仍然正确地选择新创建的项目，并给它一个选定的类。不会发生的是，如果它发现 selectedbar 类也有一个项目类。它呈现一个单独的模板（项目选择）。单击项目时会显示 Projectpicked。不是在单击#newproject 时。即使它最终被选中，它也不会显示 projectpicked 模板。让我看看代码是否可以做更多的谈话。

```
<body>
{{> sidebar}}
</body>
<template name="sidebar">
{{#if aproject}}
  {{#each aproject}}
    <div class="sidecat {{sidebarselected}} project" id="{{divids}}">
    {{name}}
    </div>
  {{/each}}
{{/if}}
{{#if projectselected}}
{{> projectpicked}}
{{/if}}
</template>

<template name="projectpicked">
project was picked from sidebar
</template> 
```

应用程序逻辑和 DOM 结构组合背后的原因是，除了类别之类的项目之外，我还有其他东西。我想使用 session 获取 id，然后我们找出它像项目或类别的类，并根据它是什么类显示不同的模板。不知道这是否是最好的方法，但这是我想出的。接受建议。如果不清楚，我不知道，我会尽力解释。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T01:46:50.047

我会重写`projectselected`帮助器，使其不依赖于 HTML 类名来执行其逻辑，而是依赖于一个`Session`值。您`Session`在大多数代码中都正确使用了，但是将应用程序逻辑与 DOM 结构结合起来似乎很奇怪。

您的代码目前的工作方式（没有看到您的 HTML 模板 - 您也应该发布它！），看起来您希望它执行以下操作：

*   您可以在列表中选择一个项目
*   当您选择一个项目（通过单击它）时，它会被赋予一个类名以表明它已被选中
*   当您单击“新项目”时，您想将一个项目添加到列表中并立即选择它

这是我解决这种情况的方法：

**你的模板**

```
<body>
 {{> sidebar}}
</body>

<template name="sidebar">
  <ul>
    {{#each items}}
    <li class="{{selected}} project" id="id_{{_id}}">{{_id}}</li>
    {{/each}}
    {{> newproject}}
  </ul>
  {{> projectpicked}}
</template>

<template name="newproject">
    <li id="newproject">Create a new project</li>
</template>

<template name="projectpicked">
  {{#if projectpicked}}
    A project was picked!
  {{/if}}
</template> 
```

**你的 javascript**

```
// When clicking an item in the list, remember which one we just clicked
Template.sidebar.events({
  "click li": function() {
    Session.set("selected_project", this._id);
  }
});

// Add the selected class to the item that was remembered
// by the session when we clicked on it
Template.sidebar.selected = function() {
  return Session.equals("selected_project", this._id) ? "selected" : "";
}

Template.sidebar.items = function() {
  // or whatever code you have to return the list of items
  return Projects.find(); 
}

// when clicking the new project button, create the new project
// and remember the id, then store that as the selected value in the session.
Template.newproject.events({
  "click #newproject": function() {
    var newprojectId = newProject(); // do your thing
    Session.set("selected_project", newprojectId);
  }
});

Template.projectpicked.projectpicked = function() {
  return !Session.equals("selected_project", undefined);
} 
```

此处的关键是仅在单击某些内容时设置 selected_project 会话值。这发生了两次；当您单击一个项目以选择它时，以及当您单击新项目时。

要让您的模板绘制所选项目，您需要在 Meteor 中做的就是描述何时选择项目：当某个会话值与其 id 匹配时选择项目。就这样。

我还没有测试过这段代码，它显然是不完整的，但希望这能为你指明正确的方向来重构你的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T17:20:46.770

好吧，在相当沮丧并重新重写大部分代码之后，我发现了问题。在我的 projectpicked 模板中，而不是使用 Session.get 然后使用它来查找类。相反，我只有一个

```
if ($('.sidecat.project').hasClass('sidebarselected')) {
return true
} 
```

虽然原来是：

```
if (find2 == 'project sidebarselected')
{
return  true
} 
```

所以我使用了一些 jquery 而不是直接将变量 find2 与字符串进行比较。

# php - cibonfire(codeigniter) 资产中的 file.js.php

> ID：15101721
> 
> 赞同：0
> 
> 时间：2013-02-26T23:49:42.410
> 
> 标签：php, codeigniter, web, javascript

是否可以包含带有`.js.php`扩展名的资产？

我尝试此代码， `Assets::add_js('file.js.php');` 但该文件未包含在内。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T04:51:39.490

快速浏览一下 Bonfire 的来源将我引向[这条线](https://github.com/ci-bonfire/Bonfire/blob/develop/bonfire/libraries/assets.php#L754)，这可能是您问题的根源。

# google-chrome - chrome 中的 context.drawWindow 等价物

> ID：15101722
> 
> 赞同：1
> 
> 时间：2013-02-26T23:49:47.317
> 
> 标签：google-chrome, firefox, canvas, google-chrome-extension, html5-canvas

我知道只有firefox扩展了canvas对象以包含context.drawWindow方法，是否有任何已知的程序可以完成该方法在chrome中的作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T09:13:09.300

您可以通过创建包含 HTML 的 foreignObject 来使用 svg 在 Canvas 内渲染 DOM。

这是一个为您完成工作的库：

[http://pbakaus.github.com/domvas/](http://pbakaus.github.com/domvas/)

# c# - 比较不同和不同记录的多个 IEnumerables

> ID：15101725
> 
> 赞同：1
> 
> 时间：2013-02-26T23:50:12.843
> 
> 标签：c#, linq, active-directory, hashset

我正在比较 3 个或更多用户的活动目录组，在程序运行之前我永远不会知道要比较的用户数量。我最终要做的是获取我正在比较的用户之间的相似活动目录组列表以及用户的非相似组列表。我还希望能够知道哪些用户被分配给了非相似组，这在比较中增加了另一个问题。这是我到目前为止的代码。基本上，我为每个用户都使用了这个，但是我不仅坚持如何比较它们，而且在我必须比较它们之前如何存储所有 IEnumerable 对象。

```
 using (PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, "Domain"))
        {
            using (PrincipalSearchResult<Principal> user = UserPrincipal.FindByIdentity(principalContext, userName))
            {
                return user.GetGroups();
            }
        } 
```

由于我不知道用户的数量，我不知道需要创建多少 Ienumerables 来存储组，更不用说比较它们了。

任何帮助将非常感激。我尝试过使用哈希集，但是当我这样做时，我无法弄清楚如何保留用户属性以及组分配。

# c++ - RawInput 加载了我的第一个 CPU 内核的 100% 并且没有正确更新

> ID：15101726
> 
> 赞同：0
> 
> 时间：2013-02-26T23:50:40.827
> 
> 标签：c++, input, raw-input

当我注册 RawInput 时，我检查了函数的所有返回，一切都很好。但是，当我更新它时，它会阻塞我的第一个 CPU 内核的性能并且它不能正常工作（当我检查'M'按下按钮并让它创建一个消息框，它不仅会在我按下“M”时触发，而是在我按下任何东西或移动鼠标时触发。消息框也不会出现，还有只有哔声。）这是我用来初始化它的代码：

```
 const ushort usageTable[] = 
    {
        InputDeviceUsage::UsageMouse,
        InputDeviceUsage::UsageKeyboard,
        InputDeviceUsage::UsageGamepad,
    };

    const ulong flagsTable[] = 
    {
        mouseFlags,
        keyboardFlags,
        hidFlags
    };

    const List<SystemDevices>& systemDevices = EnumerateSystemDevices();

    List<String> deviceNames;
    List<InputDeviceInfo> deviceInfo;

    for(uint i = 0; i < systemDevices.Size(); i++)
    {
        deviceNames.Add(GetDeviceName(systemDevices[i].hDevice));
        deviceInfo.Add(GetDeviceInfo(systemDevices[i].hDevice));

        InputDevice device = 
        {
            InputDeviceUsagePage::UsagePageHID,
            usageTable[deviceInfo[i].dwType],
            flagsTable[deviceInfo[i].dwType],
            window
        };

        RegisteredDevices.Add(device);
        Devices[systemDevices[i].hDevice] = CreateDevice(deviceInfo[i].dwType); 
```

其中 List 等效于**std::vector<>**，这些是涉及的 typedef 和定义：

```
enum InputDeviceUsagePage
{
    UsagePageHID = 0x01
};

enum InputDeviceUsage 
{
    UsageMouse = 0x02,
    UsageKeyboard = 0x06,
    UsageGamepad = 0x04
};

enum InputDeviceType
{
    TypeMouse = RIM_TYPEMOUSE,
    TypeKeyboard = RIM_TYPEKEYBOARD,
    TypeHID = RIM_TYPEHID
};

enum InputDeviceChangeBehavior
{
    Arrival = GIDC_ARRIVAL,
    Removal = GIDC_REMOVAL
};

enum InputDeviceDataRequest
{
    PreparseData =  RIDI_PREPARSEDDATA,
    Name =  RIDI_DEVICENAME,
    Info = RIDI_DEVICEINFO 
}; 
```

这是**更新**功能：

```
 try
    {
        InputData data;
        RawDevice::UpdateUnbuffered(reinterpret_cast<HRAWINPUT>(lparam), &data);

        DevicePtr it = Devices[data.header.hDevice];

        if(it == nullptr)
        {   
            DevicePtr newDevice = CreateDevice(data.header.dwType);

            Devices.Add(data.header.hDevice, newDevice);

            if(data.header.hDevice != null) 
            {
                it = newDevice;
            }
        }

        DevicePtr device = it;

        device->Read(data);

        switch(data.header.dwType) 
        {
            case InputDeviceType::TypeMouse:
                {
                    const RawMouse& mouse = static_cast<RawMouse&>(*device);

                    //TODO: add event handling here
                    break;
                }

            case InputDeviceType::TypeKeyboard:
                {
                    const RawKeyboard& keyboard = static_cast<RawKeyboard&>(*device);

                    //TODO: add event handling here
                    break;
                }

            case InputDeviceType::TypeHID:
                {
                    const RawHID& hid = static_cast<RawHID&>(*device);

                    //TODO: add event handling here
                    break;
                }

            default:
                {

                }
        }   
        return(exit_success);
    }
    catch(...)
    {
        return(DefWindowProc(window, message, wparam, lparam));
    } 
```

因此，例如在有*//TODO: 添加事件处理*的地方我放了：

```
 case InputDeviceType::TypeKeyboard:
                {
                    const RawKeyboard& keyboard = static_cast<RawKeyboard&>(*device);

                    if(keyboard.KeyDown('M'))
                    {
                        MessageBox(window, L"Pressed key is 'M'", L"Input event", MB_OK);
                    }
                    break;
                } 
```

每次按下鼠标上的任何键或任何按钮时都会发出哔声，不仅是 M，而且消息框也不显示，窗口只是哔哔声。CPU 内核被加载到最大值。这是**KeyDown( )**功能：

```
const bool RawKeyboard::KeyDown(ushort key) const
{
    if(_data.VKey == key && !(_data.Flags & KeyActions::KeyDown))
    {
        return(true);
    }
    {
        return(false);
    }
} 
```

**DevicePtr**基本上是一个**RawDevice***，它包含一个名称和**DeviceInfo**，并且从**RawDevice**继承**RawMouse**、**RawKeyboard**和**RawHID**，其中包含名为**_data的****RAWMOUSE**、**RAWKEYBOARD**、**RAWHID**成员。

 **编辑：只是添加调用更新的地方：

```
 case WM_INPUT:
                {
                    return(_input.Update(_mainWindow.GetHandle(), message, wparam, lparam));
                }
                break; 
```

EDIT2：忘记添加 ReadUnbuffered 方法：

```
 void RawDevice::UpdateUnbuffered(const HRAWINPUT rawInput, RAWINPUT* data)
    {
        wint64 size(sizeof(RAWINPUT));

        boolresult = GetRawInputData(rawInput, RID_INPUT, data, &size, sizeof(RAWINPUTHEADER));

        if(result == false)
        {
            throw RawInputException(GetLastError(), L"GetRawInputData()");
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-18T18:41:27.123

您的消息循环需要在更新您的应用程序之前处理队列中的所有消息。

听起来您正在弹出第一条消息，切换到您的应用程序。填充味精队列，收到一条消息，再填充队列......你明白了**

# list - apache tile put-list-attribute XML 错误

> ID：15101735
> 
> 赞同：2
> 
> 时间：2013-02-26T23:52:00.587
> 
> 标签：list, jakarta-ee, attributes, tiles

我的tiles.xml中有这样的定义：

```
<definition name="t.base" template="/WEB-INF/tiles/base.jsp">
    <put-attribute name="title" value="SomeTitle" />
    <put-attribute name="menu" value="/WEB-INF/tiles/menu.jsp" />
    <put-attribute name="scripts" value="/WEB-INF/tiles/scripts.jsp" />
</definition>

<definition name="t.homepage" extends="t.base" preparer="com.blogspot.symfonyworld.lyricsbase.controller.TestViewPreparer">
    <put-list-attribute name="body">
        <add-attribute value="/WEB-INF/jsp/homepage.jsp" />
        <add-attribute value="/WEB-INF/tiles/footer.jsp" />
    </put-list-attribute>
    <put-attribute name="title" value="lyricsBase : home of lyrics" />
    <put-attribute name="view" value="homepage" cascade="true" />
</definition> 
```

处理主页请求时，编译器会抛出异常：

```
org.xml.sax.SAXParseException; lineNumber: 29; columnNumber: 18; The content of element type "definition" must match "(put-attribute*,put-list-attribute*)".
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:198) 
```

我不知道出了什么问题 - 根据[瓷砖文档](http://tiles.apache.org/framework/tutorial/advanced/list-attributes.html)，XML 语法似乎是正确的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-01T12:45:46.973

该`<put-list-attribute>`元素必须位于定义的末尾，如下所示：

```
<definition name="t.homepage" extends="t.base" preparer="com.blogspot.symfonyworld.lyricsbase.controller.TestViewPreparer">
    <put-attribute name="title" value="lyricsBase : home of lyrics" />
    <put-attribute name="view" value="homepage" cascade="true" />
    <put-list-attribute name="body">
        <add-attribute value="/WEB-INF/jsp/homepage.jsp" />
        <add-attribute value="/WEB-INF/tiles/footer.jsp" />
    </put-list-attribute>
</definition> 
```

# regex - vb.net如何检查字符串是否包含某个单词

> ID：15101737
> 
> 赞同：1
> 
> 时间：2013-02-26T23:52:08.053
> 
> 标签：regex, vb.net, string

我想检查字符串是否与数组中的单词匹配，而不仅仅是匹配字符。contains 方法只检查匹配字符而不是整个单词。这是我的代码：

```
 Dim builder As New StringBuilder()
    Dim reader As New StringReader(txtOCR.Text)
    Dim titles() As String = {"the", "a", "an", "of"}
    Dim regex As New Regex(String.Join("|", titles), RegexOptions.IgnoreCase)

    While True
        Dim line As String = reader.ReadLine()
        If line Is Nothing Then Exit While
        Dim WordCount = New Regex("\w+").Matches(line).Count

        If WordCount = 1 And Not line.ToLower().Contains("by") Then
            builder.AppendLine(line)
        ElseIf regex.IsMatch(line) Then
            builder.AppendLine(line)
        End If

    End While
    txtTitle.Text = builder.ToString() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T23:56:09.790

您可以使用单词边界`\b`来包围单个单词：

```
New Regex("\b" & String.Join("\b|\b", titles) & "\b") 
```

# python - 在 Linux (CentOS) 中的 Python 中即时获取负载或 getloadavg() 在较短的时间段内获取负载

> ID：15101740
> 
> 赞同：5
> 
> 时间：2013-02-26T23:52:28.010
> 
> 标签：python, linux, load

目前，我正在使用 Python`os.getloadavg()`来了解服务器上的当前负载`(Centos 6.3)`

根据 python 文档，`os.getloadavg()`“返回系统运行队列中在过去 1、5 和 15 分钟内平均的进程数”：

[http://docs.python.org/2/library/os.html#os.getloadavg](http://docs.python.org/2/library/os.html#os.getloadavg)

```
os.getloadavg()
返回系统运行队列中在过去 1、5 和 15 分钟内的平均进程数，如果无法获得平均负载，则引发 OSError。

```

**问题：**

*   是否可以在当前时刻获取系统运行队列中的进程数？
*   如果没有，是否有可能在更短的时间内获得平均值，比如最后 5 秒或 10 秒？

我问的原因是因为我得到了平均负载，那么如果它太高，就会杀死一些进程。这可能每分钟发生很多次，所以我担心在 1 分钟的平均值赶上之前会杀死太多的进程。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-03T05:24:01.017

根据Linux 3.5 内核源代码中的[Documentation/filesystems/proc.txt](http://lxr.linux.no/linux+v3.5/Documentation/filesystems/proc.txt#L1207)，您可以从以下位置检索当前运行的进程数`/proc/stat`：

```
>>> for l in open("/proc/stat"):
...   l = l.split()
...   if l[0] == 'procs_running':
...     result = int(l[1])
... 
>>> print result
6
>>> 
```

相同的号码可用于`/proc/loadavg`：

```
>>> print int(open("/proc/loadavg").next().split()[3].split('/')[0])
6 
```

# http - 用于启动服务的 Http/REST 方法

> ID：15101741
> 
> 赞同：6
> 
> 时间：2013-02-26T23:52:32.467
> 
> 标签：http, rest

我想设计一个 REST API 来启动一个数据库。我找不到合适的 http 方法（又名动词）。

我目前考虑：

```
START /databases/mysampledatabase 
```

我浏览了一些 RFC，但后来我想这里有人可能会指出我事实上的标准动词。

我放弃的方法（在我厌倦之前）：

**RFC 2616** 选项 GET HEAD POST PUT DELETE TRACE CONNECT

**RFC 2518** PROPFIND PROPPATCH MKCOL 复制移动锁定解锁

**RFC 3253** 报告 CHECKOUT CHECKIN UNCHECKOUT MKWORKSPACE UPDATE LABEL MERGE BASELINE-CONTROL MKACTIVITY

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T00:16:00.117

这里有很多思维缺陷。首先，额外的 HTTP 动词（除了 CRUD 动词）应该被认为是不平静的。

所以有两种方法可以解释这个问题，我对这两种方法都有一个答案：

**1.启动服务最合适的HTTP方法是什么**

没有什么比得上你需要的了，我建议你简单地使用`POST`.

**2\. 什么是启动服务的好 RESTful 方式**

首先，您不应将“启动服务”视为操作。将“状态”（正在启动或停止）视为您正在更改的资源和 PUT 更新资源更容易。

所以在这种情况下，每个服务都应该有一个唯一的 uri。`GET`那个 uri 上的 A可以返回如下内容：

```
{ "status" : "stopped" } 
```

您只需将“已停止”更改为“已启动”，`PUT`即新资源......然后服务可以自动开始运行。

我想知道这有多大用处..我不是 REST 狂热者，我认为简单的 POST 是最好的方法..

# python - 如何使用python提取txt文件中的信息

> ID：15101743
> 
> 赞同：-2
> 
> 时间：2013-02-26T23:52:47.357
> 
> 标签：python, ascii

这里我有一个 ASCII 格式的数据文件，如下所示：

```
--Boundary--
ID     1234567
DATE   2/26/13
TYPE   X
CLASS  ABC
--Boundary--
ID     1234568
DATE   2/25/13
TYPE   Y
CLASS  DEF
--Boundary--
ID     1234569
DATE   2/24/13
TYPE   Z
CLASS  GHI 
```

现在我需要提取“ID”和“CLASS”的信息，即我想要一些输出文件如下所示：

```
----------
ID          Class

1234567     ABC

1234568     DEF

1234569     GHI 
```

输出文件也是 .txt 格式。我是python的初学者，非常感谢任何有用的脚本。

我尝试了脚本：

```
inFile = open("input.txt")
outFile = open("output.txt", "w")
for line in inFile:
    if "ID" in line:
            id = line[line.find(' ')+7 :] 
```

这是一个好方法吗？如何保存输出？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:13:59.830

1.这是一个好方法吗？
我会更喜欢这个，但没关系

```
id = line.split(' ')[-1] 
```

2.如何保存输出？

从教程中，您将找到[7.2。读取和写入文件](http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)

```
outFile.write(rowdata) 
```

不要忘记 outFile.close()

# python - 在将输入放入字典时将输入更改为 int

> ID：15101744
> 
> 赞同：0
> 
> 时间：2013-02-26T23:52:47.427
> 
> 标签：python, csv, converter

有什么办法可以在读入这个字典时将每个键值的值转换为 int？最初它们是字符串，但我希望它们是整数。这是我尝试过的，但我遇到了错误！每个键看起来像 {'USA': ('123,123', '312,321,321')} 但我希望这些数字是整数

```
**def _demo_fileopenbox():        
msg  = "Pick A File!"
msg2 = "Select a country to learn more about!"
title = "Open files"
default="*.py"
f = fileopenbox(msg,title,default=default)
writeln("You chose to open file: %s" % f)

countries = {}

with open(f,'r') as handle:
    reader = csv.reader(handle, delimiter = '\t')  
    for row in reader:
        countries[row[0]] = ((int(row[1])),(int(row[2])))
    while 1:
        reply = choicebox(msg=msg2, choices= list(countries.keys()) )
        writeln(reply + ";\tArea: " + (countries[reply])[0] + "\tPopulation: " + (countries[reply])[1] )
  ** 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T23:57:37.020

`int`在将它们转换为s之前尝试从字符串中删除逗号：

```
countries[row[0]] = (int(row[1].replace(',', '')), int(row[2].replace(',', ''))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T23:58:32.940

您的问题是您的数字包含逗号。将代码更改为：

```
for row in reader:
    countries[row[0]] = tuple(int(a.replace(",","")) for a in row[1:]) 
```

# email - Mailchimp 电子邮件中的图像在 Gmail 中非常大

> ID：15101747
> 
> 赞同：0
> 
> 时间：2013-02-26T23:52:58.207
> 
> 标签：email, gmail, mailchimp

我有一个正在为客户处理的 MailChimp 模板。仅在 Gmail 中，我得到一些比模板中规定的尺寸大得多的图像。在此示例中，图像在 Gmail 中以 600 像素 x 120 像素显示，但它`<td>`是：

```
<td cellpadding="0" cellspacing="0" style="border-collapse:collapse;vertical-align:top" height="4px" width="600px">
                                <img src="http://www.marketingscience.co/boa/hero-header.png" style="display:block;border:0;min-height:4px;width:600px;background-color:#696969;color:white;font-size:18px;line-height:100%;outline:none;text-decoration:none">
                              </td> 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T05:28:07.883

尝试在纯 html 中设置图像尺寸，如下所示：

```
<img src="image.png" width="100px" height="300px" /> 
```

此外，您没有在“样式”属性中设置高度，因此添加它可能会解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T22:35:50.233

在您的电子邮件模板中添加样式元素，并为您的电子邮件中的所有图像设置一些默认样式，如下所示：

```
 <style>
   img {
     display:block;
     height:auto;
     line-height:100%;
   }
 </style> 
```

`<img>`MailChimp 将在发送电子邮件之前将这些样式内联添加到每个元素中。

然后，如果可能，按照 Alex Ponomarev 的建议将`height`和`width`属性添加到每个图像。

# vba - 具有最小值和最大值的 Excel VBA yearfrac

> ID：15101748
> 
> 赞同：0
> 
> 时间：2013-02-26T23:52:59.770
> 
> 标签：vba, excel, date-arithmetic

我试图在 Excel VBA 中查找两个日期之间的周数（两者之间有一些最小/最大功能），得到以下行的类型不匹配错误（运行时错误'13'）：

```
WeeksWorked = Application.WorksheetFunction.RoundDown _ 
             (52 * Application.WorksheetFunction.YearFrac _ 
             (Application.WorksheetFunction.Max(DOH, DateValue("Jan 1, 2012")), _ 
              DateValue("Dec 31, 2012")), 0) 
```

任何人都对我做错了什么有任何指导，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T04:12:25.073

不确定为什么需要在 VBA 中使用它，您可以尝试以下方法。

在 Excel 中：

假设开始日期在 A1 中，结束日期在 A2 中，然后是 A3，

```
=(NETWORKINGDAYS(A1,A2))/5 
```

现在这是从工作日的角度来看，因此每周有 5 天。如果您需要每周 7 天和正常的日子，

```
=WEEKNUM(A3)-WEEKNUM(A2) 
```

> 分析工具包插件中的函数 WEEKNUM() 计算给定日期的正确周数（如果您在美国） 下面的用户定义函数将根据您计算机上的国家语言设置计算正确的周数。

如果您仍然需要使用 VBA，请尝试以下操作：（正如 Tim 指出的那样`DateDiff`非常方便。）或者您甚至可以使用`Evaluate to trigger WEEKNUM`.

```
Option Explicit

Function numWeeks(startDate As Date, endDate As Date)
    numWeeks = DateDiff("ww", startDate, endDate)
End Function 
```

**在 WEEKNUM 上使用 Evaluate**：

```
Function numWeeks(startDate As Range, endDate As Range)
Dim s As Integer, t As Integer
    s = Application.Evaluate("=WEEKNUM(" & startDate.Address & ",1)")
    t = Application.Evaluate("=WEEKNUM(" & endDate.Address & ",1)")
    numWeeks = t - s
End Function 
```

* * *

*   [Excel VBA DataTime 函数参考](http://www.cpearson.com/excel/DateTimeVBA.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:19:36.507

正如评论中建议的那样，您可以这样做：

```
debug.print DateDiff("ww", DateValue("Jan 1, 2012"), DateValue("Dec 31, 2012")) 
```

* * *

如果由于某种原因您想自己滚动，您可以截断以下商：

```
| 第 1 天 - 第 2 天 |
---------------
       7

```

示例代码：

```
Sub test_numWeeks_fn()
    Call numWeeks(DateValue("Jan 1, 2012"), DateValue("Dec 31, 2012"))
End Sub

Function numWeeks(d1 As Date, d2 As Date)
    Dim numDays As Long
    numDays = Abs(d1 - d2)
    numWeeks = Int(numDays / 7)
    Debug.Print numWeeks
End Function 
```

结果：

```
52 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T04:15:02.420

![在此处输入图像描述](../Images/ab5267490e755783aaaee0c62592426e.png)试试下面的代码：

```
Sub example()

Dim dob As Date
dob = #7/31/1986#

Dim todaydt As Date
todaydt = Date

Dim numWeek As Long
numWeek = DateDiff("ww", dob, todaydt) ' Difference in weeks

End Sub 
```

# tfs - tfs 中失败和成功构建的单独放置位置

> ID：15101749
> 
> 赞同：0
> 
> 时间：2013-02-26T23:53:01.630
> 
> 标签：tfs, tfsbuild

每当我在 TFS 中触发构建时，都会在放置位置为失败和成功构建创建一个放置文件夹。是否有任何解决方案可以为成功和失败的构建创建单独的放置位置。我想保留两个文件夹但分开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T15:10:10.683

修改构建工作流模板，您可以使用组合测试您的构建是否有效

![在此处输入图像描述](../Images/5824e954752c1e29bfbd5a8b93eac1ae.png)

然后进行复制/删除

![在此处输入图像描述](../Images/69b910c75d55ca59b88c97815b7cc20c.png)

将原始输出文件夹上的目标文件夹。

在构建之后修改输出目录似乎不是一种选择，因为构建任务是一个庞大的、单一的功能，它完成了完整的构建，包括输出它。

![在此处输入图像描述](../Images/43174e10a692880099e16ffc286ddbc1.png)

# python - 尝试使用 python 2.7 提取 xml 元素

> ID：15101754
> 
> 赞同：-2
> 
> 时间：2013-02-26T23:53:19.257
> 
> 标签：python, xml-parsing

我正在尝试提取 xml 文件中序列下的名称元素。我在顶部粘贴了一个示例 xml 来说明。有了这个，我想通过指导从 01 Interview_been 中获得文本并将其写入文件。xml 中有多个序列标签，我试图弄清楚如何通过它并提取它。我试图弄清楚如何使用 xml.etree 和 xml.dom.minidom 但我似乎无法将我的大脑包裹在它周围。我能够从序列标签中获取所有 id 值，但不能从名称元素中获取。我在xml之前粘贴我的代码。

```
from xml.etree import ElementTree

file = open("xmldump.txt", "r")
filedata = file.read()
file.close()

with open('test.xml', 'rt') as f:
    tree = ElementTree.parse(f)

for node in tree.iter('name'):
    sequenceid = node.attrib.get('name')
    print '  %s' % (sequenceid)
    newLine = sequenceid + "\n"
    file = open("xmldump.txt", "w")
    file.write(newLine)
    file.close() 
```

这是 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xmeml>
<xmeml version="5">
<bin>
<uuid>0F5D72FA-54E4-4DE8-81D7-CC33F5C43836</uuid>
<updatebehavior>add</updatebehavior>
<name>Logged</name>
<children>
    <sequence id="01 Interview_been successful through mentorship">
        <uuid>12FB944D-83EA-4527-9A54-2130A42E3A06</uuid>
        <updatebehavior>add</updatebehavior>
        <name>01 Interview_been successful through mentorship</name>
        <duration>1195</duration>
        <rate>
            <ntsc>TRUE</ntsc>
            <timebase>24</timebase>
        </rate>
        <timecode> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T00:08:44.647

好吧，我不确定您是否想要“id”属性或名称标签（您的代码令人困惑，它试图从“sequence”标签中提取“name”属性，但该标签只有一个“id “ 属性）。下面是提取两者的代码，应该可以帮助您开始了解 ElementTree 的工作原理

```
from xml.etree import ElementTree

with open('test.xml', 'rt') as f:
    tree = ElementTree.parse(f)

for node in tree.iter('sequence'):
    sequenceid = node.attrib.get('id')
    name = node.findtext('name') 
```

# ios - iOS 线程和在主线程上进行 UI 更改

> ID：15101756
> 
> 赞同：2
> 
> 时间：2013-02-26T23:53:30.017
> 
> 标签：ios, objective-c, multithreading

我有以下`AcceptCallBack`方法，并希望在该方法运行时添加一个 UIActivityIndi​​cator，因此`[mvc performSelectorOnMainThread:@selector(invoke) withObject:nil waitUntilDone:YES];`. `invoke`是使 UI 发生变化的方法。然后我有这条线`[mvc performSelectorOnMainThread:@selector(hide) withObject:nil waitUntilDone:YES];`来删除 UIActivityIndi​​cator。然而，似乎发生的是调用仅在`AcceptCallBack`完成执行时才被调用。是否在两个不同的线程`AcceptCallBack`上`invoke`运行，因此允许它们同时运行？

```
void AcceptCallBack(
                CFSocketRef socket,
                CFSocketCallBackType type,
                CFDataRef address,
                const void *data,
                void *info)
{
NSLog(@"Start Receiving...");

MasterViewController* mvc = (__bridge MasterViewController*)info;
[mvc performSelectorOnMainThread:@selector(invoke) withObject:nil waitUntilDone:YES];

CFReadStreamRef readStream = NULL;
CFWriteStreamRef writeStream = NULL;
CFIndex bytes;
UInt8 buffer[8192];
UInt8 * fileData;
UInt8 recv_len = 0;

/* The native socket, used for various operations */
CFSocketNativeHandle sock = *(CFSocketNativeHandle *) data;

/* Create the read and write streams for the socket */
CFStreamCreatePairWithSocket(kCFAllocatorDefault, sock,
                             &readStream, &writeStream);

if (!readStream || !writeStream) {
    close(sock);
    fprintf(stderr, "CFStreamCreatePairWithSocket() failed\n");
    return;
}

CFReadStreamOpen(readStream);
CFWriteStreamOpen(writeStream);

bool headerRead = false;
int dataWritten = 0;
NSMutableString* filename = NULL;

NSMutableString * header = [[NSMutableString alloc] init];

while (true) {
    memset(buffer, 0, sizeof(buffer));
    bytes = CFReadStreamRead(readStream, buffer, sizeof(buffer));

    recv_len += bytes;

    if (bytes < 0) {
        fprintf(stderr, "CFReadStreamRead() failed: %d\n", (int)bytes);
        close(sock);
        return;
    }
    if (bytes == 0) {
        break;
    }

    if (!headerRead) {
        for (int b=0; b<bytes; b++) {
            if (buffer[b] == '\n') {
                headerRead = true;
                NSLog(@"Header is: %@", header);

                NSArray *listItems = [header componentsSeparatedByString:@":"];
                filename = [[NSMutableString alloc] init];
                [filename appendString:[listItems objectAtIndex:2]];
                [filename replaceOccurrencesOfString:@"/" withString:@"" options:NSCaseInsensitiveSearch range:NSMakeRange(0, [filename length])];
                fileData = (UInt8*)malloc(sizeof(UInt8) * [[listItems objectAtIndex:3] intValue]);

                b++;
                memcpy(fileData, buffer + b, bytes - b);
                dataWritten = bytes - b;

                break;
            } else {
                [header appendFormat:@"%c", buffer[b]];
            }

        }
    } else {
        memcpy(fileData + dataWritten, buffer, bytes);
        dataWritten += bytes;
    }

}

NSString* docFile = [NSTemporaryDirectory() stringByAppendingPathComponent:filename];

NSData * outputData = [[NSData alloc] initWithBytes:fileData length:dataWritten];
if ([outputData writeToFile:docFile atomically:false] == YES) {
    NSLog(@"File received and successfully written out to file------------------------------");

    MasterViewController * thing = (__bridge MasterViewController*)info;

    [thing restClient:NULL loadedFile:docFile];

    NSString *destDir = @"/Slide2Me/";
    [[thing restClient] uploadFile:filename toPath:destDir
                     withParentRev:nil fromPath:docFile];
    [mvc performSelectorOnMainThread:@selector(hide) withObject:nil waitUntilDone:YES];

} else {
    NSLog(@"Failed to write received data to file");
} 
```

}

**编辑** 所以我最终为了得到我想要的结果所做的就是把上面所有的代码都放进去，然后把`dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0)`它和我想在主线程上做的改变夹在中间，就像这样......

```
void AcceptCallBack(
                    CFSocketRef socket,
                    CFSocketCallBackType type,
                    CFDataRef address,
                    const void *data,
                    void *info)
{

NSLog(@"Start Receiving...");

MasterViewController* mvc = (__bridge MasterViewController*)info;

[mvc performSelectorOnMainThread:@selector(invoke) withObject:nil waitUntilDone:YES];

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0), ^{
      [the code above];

});

[mvc performSelectorOnMainThread:@selector(hide) withObject:nil waitUntilDone:YES];
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T00:46:35.847

您可以使用 GCD 使其成为多线程，并在指标启动和停止时发出信号。performSelector... 将在函数完成时执行.. 它没有说明您如何调用 AcceptCallBack 方法，我猜它已经在主线程上。如果是，那么您需要在另一个线程中调用 AcceptCallback 并使用下面的代码在主线程上执行“调用”方法。

```
dispatch_async(dispatch_get_main_queue(), ^{
    <do work here>
}); 
```

[http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW1](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW1)

编辑：

我会这样做

```
static dispatch_queue_t processing_queue;
static dispatch_queue_t request_processing_queue() {
    if (processing_queue == NULL) {
        processing_queue = dispatch_queue_create("com.xxx.processing", 0);
    }
    return processing_queue;
}

void AcceptCallBack(
                    CFSocketRef socket,
                    CFSocketCallBackType type,
                    CFDataRef address,
                    const void *data,
                    void *info)
{

    __block MasterViewController* mvc = (__bridge MasterViewController*)info;

    dispatch_async(processing_queue(), ^{

       dispatch_async(dispatch_get_main_queue(), ^{
            [mvc invoke];
        });

       ..... < Do AcceptCallback Code Here >

       dispatch_async(dispatch_get_main_queue(), ^{
            [mvc hide];
        });

    });

} 
```

警告：这只是伪代码..

# android - Android SQLite 比 HTML5 WebSql 慢得多

> ID：15101758
> 
> 赞同：0
> 
> 时间：2013-02-26T23:53:43.543
> 
> 标签：android, sqlite

两个数据库应用程序，一个 HTML5 WebSql 和一个使用 ADT 构建的 Android。两者都使用完全相同的 Sqlite 数据库，因此具有相同的模式、表和索引。

```
SELECT
    road.description,
    xy.lat AS lat,
    xy.lon AS lon,
    road.id_road AS id_road
FROM xy
INNER JOIN road
  ON xy.id_road = road.ID_ROAD
WHERE xy.lat BETWEEN -36.89804010977648
                 AND -36.878040110223516
  AND xy.lon BETWEEN 174.78966425022352
                 AND 174.8096642497765 
```

Web 应用程序使用 db.transaction。Android SQL 在一个类中运行，该类使用在异步进程中创建的数据库对象扩展 SQLiteOpenHelper。

```
SQLiteDatabase dbr = this.getReadableDatabase();
Cursor cursor = dbr.rawQuery(sql, null);
if( cursor.moveToFirst()){
    // loop through and analyse approx 400 results
} 
```

在 HTC-1V 硬件上测试 HTML5 在 250 毫秒内运行上述查询，在 Android 应用程序上仅需要 4000 毫秒才能打开光标。是否可以从 Android 应用程序获得 WebSql 性能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T05:42:00.513

很难说出确切的原因，但我可以告诉你应该创建哪些索引以使其更快地工作（除非你已经有了这些索引）：

```
CREATE INDEX road__id_road_idx       ON road (id_road);
CREATE INDEX xy__id_road_lat_lon_idx ON xy   (id_road, lat, lon); 
```

此外，请参阅有关如何在 Android 上优化查询的[答案](https://stackoverflow.com/a/13549991/1734130)[`EXPLAIN QUERY PLAN`](http://www.sqlite.org/eqp.html)，但基本思想是在其下运行查询并尝试消除昂贵的扫描。

# sql-server - 表在编辑模式下是否按主键排序？

> ID：15101761
> 
> 赞同：0
> 
> 时间：2013-02-26T23:53:57.263
> 
> 标签：sql-server, primary-key, ssms

我正在使用 SQL Server Management Studio，并且我有一个表，其主键是字母和数字的组合。

我的同事插入了所有主键，现在她想开始插入数据，所以她问我是否可以重新保存数据，以便表按其主键排序。但我在想它应该已经排序了？

所以，我的问题是...

当我右键单击表格并选择“编辑前 XXX 行”时，表格是否已经按其主键排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:07:24.627

您应该看到按聚集索引排序的可编辑行，聚集索引通常是主键，但可能更多。有关聚集索引与非聚集索引的更多信息，请参见[此处](https://stackoverflow.com/questions/7605707/clustered-vs-non-clustered)的讨论。

此外，您可以手动更改正在执行的 SQL Select 语句以显示可编辑的行。按照此[博客文章](http://www.diaryofaninja.com/blog/2010/11/04/visually-edit-records-for-any-query-using-sql-management-studio)中的简单说明，您将能够查看按您想要的列排序的行。

希望这有帮助！

夏皮

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-27T00:06:25.363

是的，只有当主键也是[CLUSTERING KEY](http://msdn.microsoft.com/en-us/library/aa933131%28v=sql.80%29.aspx)时才会按主键排序。

# php - 面向 OO-PHP 和 WordPress 插件的 MVC 方法

> ID：15101762
> 
> 赞同：3
> 
> 时间：2013-02-26T23:54:09.253
> 
> 标签：php, design-patterns, wordpress

我开始研究面向对象的 PHP。迄今为止，我已经开发了大量采用过程方法的 PHP 系统，但我认为是时候向前迈进了。

我目前正在从事的项目之一是 WordPress 的成绩和障碍计算插件。简而言之，该插件从上传的 CSV 文件中获取乒乓球运动员的成绩，并计算出他们的差点比赛评分。

我正在使用 WordPress，因为我的乒乓球俱乐部的网站使用 WP，如果它适用于他们，我可能会将其提供给其他俱乐部/联盟，他们也将能够安装插件并获得成熟的成绩和障碍系统。

在 WordPress 之外，我*有理由*相信我可以使用 MVC 模式在 OO-PHP 中开发这样一个系统。它可能看起来像这样：

**控制器**

1.  创建模型的实例
2.  处理“导航”，即 GET/POST 请求，并确定相应显示哪些页面模板

**模型**

1.  处理文件的上传和存储
2.  从数据库中更新和选择信息
3.  计算玩家成绩的主机机制

**看法**

1.  管理页面，即设置和上传文件
2.  成绩页面，显示球员的成绩和差点
3.  结果页面，特定用户可以在其中查看个别玩家的结果（主要用于调试目的）

如果我错了，请纠正我，因为我在过去 30 分钟左右才学会了这种模式，但按照我的逻辑，这是创建这个系统的真正 MVC 方法。

*但是*，一旦我将 WordPress 插件纳入等式，我就开始为以下问题而苦恼：

*   在非 WP 系统中，CSS 样式将简单地包含在 View 的 PHP 页面中，然后我会`include`在 Controller 中。但是，在 WordPress 中，它不能那样工作——我不能那样使用 CSS 样式，它们必须是`enqueue`'d. 我将在哪里托管用于排队我的 CSS 文件的功能？
*   当有人第一次激活插件时，它需要使用 WordPress 函数创建适当的数据库表来执行此操作。这将不得不运行 a `hook`，即 a `register_activation_hook`。我将在哪里托管这些功能？将它们放在控制器中似乎是明智的，但同时我想也许控制器需要保持尽可能干净和简单易读。
*   与上述问题类似，我还需要使用`add_menu_page`和`add_submenu_page`命令创建 WordPress 管理页面。我在哪里托管这些功能？

所有这些问题可能都有相同的答案，而且我知道这只是语义，但我热衷于尝试尽早解决这个问题，这样我才能真正了解面向对象 PHP 的 MVC 模式。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T06:29:40.397

如果你正在寻找一个更好的学习 MVC 的地方，[那就是它了。](http://www.larryullman.com/series/understanding-mvc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:50:51.160

希望我做对了。

1.  无法告诉您有关 CSS 的信息，因为我只是将那些定义在我的布局文件（视图）中。

2.  重逻辑可以放入服务（外部类），然后在控制器中运行。你会让你的控制器“瘦”

3.  和上一个类似。您可以将菜单存储为模型（不必严格与 DB 相关，也可以是 XML/JSON/数组数据），然后在控制器中调用您的添加/删除操作。

# c++ - 正确使用函数

> ID：15101767
> 
> 赞同：0
> 
> 时间：2013-02-26T23:54:45.843
> 
> 标签：c++

我正在尝试使用函数来处理 .dat 文件中的数据，但我似乎无法让函数正确读取数据。在第 62 行，它试图计算在三个不同高度记录的不同温度的低、高和平均值，但这些函数不处理任何数据。平均函数应该将数字的总数除以数字的计数，但它没有这样做。另外，我不能在工作中变得高或低。我究竟做错了什么？

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <conio.h>
#include <string>

using namespace std;

double qMeter = 0;
double hMeter = 0;
double oneMeter = 0;
int solDay = 0;
string garbage;
string localTime;
string decSol;
ifstream input;
ofstream output;

//function prototypes
double low(double lowTemp);
double high(double highTemp);
float average(double avgTemp);

int main()
{

input.open("curiosity234x.dat"); //opens input data file
output.open("output.dat"); //opens output data file

  for (int i = 0; i < 4; i++) //gets rid of the first four lines
{
  getline(input,garbage);
  cout << endl;
}

while (!input.eof())
{
    int count; 
    double newOneMeter;
    double newHMeter;
    double newQMeter;

    if (solDay == 2) //processes data for the second solar day
    {
     input >> solDay >> localTime >> decSol 
     >> newOneMeter >> newHMeter >> newQMeter;

     oneMeter = oneMeter + newOneMeter;
     hMeter = hMeter + newHMeter;
     qMeter = qMeter + newQMeter;
     count++;

     output << solDay << fixed << setprecision(1) << setw(5)
        << "Solar" << "Average" << "Low" << "High"
        << "Average" << "Low" << "High" 
        << "Average" << "Low" << "High" 
        << "Day" << "Temp" << "Temp" << "Temp" << "Temp" << "Temp"
        << "Temp" << "Temp" << "Temp" << "Temp"
        << fixed << setprecision(15) << "1 meter" << ".5 meters"
        << ".25 meters"
        << average(oneMeter) << low(oneMeter) << high(oneMeter)
        << average(hMeter) << low(hMeter) << high(hMeter)
        << average(qMeter) << low(qMeter) << high(qMeter);
    }

    if (solDay == 3) //processes data for the third solar day
    {
     input >> solDay >> localTime >> decSol 
     >> newOneMeter >> newHMeter >> newQMeter;

     oneMeter = oneMeter + newOneMeter;
     hMeter = hMeter + newHMeter;
     qMeter = qMeter + newQMeter;
     count++;

     output << solDay << fixed << setprecision(1) << setw(5)
        << "Solar" << "Average" << "Low" << "High" 
        << average(oneMeter) << low(oneMeter) << high(oneMeter)
        << average(hMeter) << low(hMeter) << high(hMeter)
        << average(qMeter) << low(qMeter) << high(qMeter);
    }
  }

  cout << endl << "The output.dat file has been written and transmitted.";
  /*
  reads first line. Assigns first string to 'int solDay' 
  second to 'string time', third to decSol, fourth to oneMeter, 
  fifth to hMeter and sixth to qmeter. Meters should have setw().
  */
getch();
return 0;

input.close();
output.close();
}

//functions used in main
double low(double lowTemp)
{
   int test = 10,000;
   double least;

   if (lowTemp < test)
   {
     lowTemp = test;
     lowTemp = least;       
    }
    return least;
}

double high(double highTemp)
{
   int test = 10,000;
   double most;

   if (highTemp < test)
   {
      highTemp = test;
      highTemp = most;        
    }
   return most;
}

float average(double avgTemp)
{
   avgTemp = avgTemp / count;
   return avgTemp;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T00:02:01.277

看一下`low`例如的实现：

```
int test = 10,000;
double least;

if (lowTemp < test)
{
  lowTemp = test;
  lowTemp = least;       
}
return least; 
```

如果`if`块执行，您将未初始化的分配`least`给`lowTemp`. 然后不管它是否执行，你都会返回 uninitialized `least`。

为什么你只分配`test`给`lowTemp`然后用覆盖它`least`？

也不`10,000`是代表一万的整数文字。您不能在文字中使用逗号来分隔数千。你必须写`10000`。

# javascript - 使用 innerHTML 创建 div 后无法收听悬停（等）事件

> ID：15101768
> 
> 赞同：1
> 
> 时间：2013-02-26T23:54:52.193
> 
> 标签：javascript, jquery

所以我使用这个生成了一些 div

```
document.getElementById('container').innerHTML += '<div class="colorBox" id="box'+i+'"></div>'; 
```

我遇到的问题是捕捉悬停事件

```
$(".colorBox").hover(function(){
    alert("!");
}); 
```

做了之后就不行了。有什么想法吗？

编辑：为了更清楚，请查看： http: [//graysonearle.com/test/16_t.html](http://graysonearle.com/test/16_t.html)

我需要能够在更改动态多次发生的 innerHTML 后发生悬停事件。所以就像在改变列数之后，悬停效果需要起作用。

感谢选择的答案：对于那些将来可能想做类似事情的人，我的代码现在看起来像这样：

```
$(document).ready(function(){

    document.body.onmousedown = function() { 
      ++mouseDown;
    }
    document.body.onmouseup = function() {
      --mouseDown;
    }

    $(document).on("mouseenter",".colorBox",function(){
        if(mouseDown){
            var clicked = $(this).attr("id");
            var clicked = clicked.substring('box'.length);
            next_color(clicked);
        }       
        $(this).css("border-color","#ff0");
        }).on("mouseleave", ".colorBox", function() {
        $(this).css("border-color","#aaa");
    });

    $(document).on("click",".colorBox",function(){
        var clicked = $(this).attr("id");
        var clicked = clicked.substring('box'.length);
        next_color(clicked);
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T00:07:57.143

每当我们从服务器端代码或客户端代码更新 DOM 时。对于 EX。我们正在更新的 DIV，如果我们加载部分数据，它将不适用于我们之前加载的事件。

所以对于这个在文档准备好的代码中是这样的。如果您使用的是 jquery 1.7+，那么代码如下

```
$(document).on("hover",".colorBox",function(){
    alert("Hi it will load after partial div update as well");
});

$(document).delegate(".colorBox","hover",function(){
    alert("Hi it will load after partial div update as well");
}); 
```

如果您使用的是 jquery 1.6 或更低版本，那么。

然后使用

```
$(".colorBox").live("hover",function(){
    alert("Hi it will load after partial div update as well");
}); 
```

[http://oscarotero.com/jquery/](http://oscarotero.com/jquery/)

如果这对您有帮助，请标记为答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T23:59:20.157

首先，当您使用 jQuery 时，您的第一个代码可以使用以下函数进行简化。

```
$('#container').append('<div class="colorBox" id="box'+i+'"></div>'); 
```

其次，我认为这是因为您尚未声明悬停功能。

```
 $(".colorBox").hover(
       function(){
          alert("On");
       }
    ); 
```

工作[小提琴](http://jsfiddle.net/EhNKM/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T00:00:58.270

您必须在注入 div 后调用悬停代码。Jquery 不会自动监听 dom 的变化，所以如果你把所有的 colorBoxes 都挂进去`$(document).ready(){...}`，然后插入一个新的 div，什么都不会发生。

所以这很好用：

```
$(document).ready(function(){
    for(i=0; i<5; i++) {
        document.getElementById('container').innerHTML += '<div class="colorBox" id="box'+i+'"></div>';
    }
    $(".colorBox").hover(function(){
        alert("!");
    });
} 
```

# javascript - 如何设置无需上传数据即可处理本地数据的 Web 应用程序？使用蟒蛇

> ID：15101770
> 
> 赞同：0
> 
> 时间：2013-02-26T23:55:05.617
> 
> 标签：javascript, python, google-chrome, web-applications, tsv

我有一个小python程序来帮助我的同事分析一些tsv数据。数据不大，一般在20MB以下。我用 PyQT 开发了 GUI。我想将此桌面程序更改为 Web 应用程序，这样我的同事就不必在每次更改或修复错误时都升级程序。他们只需访问一个网站并使用 Chrome 作为 GUI。那么我该怎么做呢？我大部分时间都在开发桌面程序，只知道一些基本的 Web 开发知识。我已经阅读了一些框架，例如flask和web2py，并且知道如何使用HTML和Javascript来制作按钮，但不知道如何实现我的目的。

有人可以给我一个实用的方法吗？如果用户不必将本地数据上传到服务器会更好。也许只是从服务器下载 python 代码然后在 Chrome 中执行。这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T23:59:22.487

不，您不能在 Web 浏览器中运行 Python 代码。[1] 您必须将应用程序的核心移植到 JavaScript 才能在本地完成所有操作。

只做上传。20MB 并不是那么多数据，如果它存储在服务器上，那么他们也可以查看彼此的结果。

* * *

[1] 有*一些*工具试图将 Python 转换为 JavaScript：pyjs 直接编译，而 Emscripten 是一个完整的 JS 中的 LLVM 解释器，可以运行 CPython 本身。我真的不建议依赖这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:18:53.290

Web 应用程序的全部意义在于 GUI 是用 HTML、CSS 和 JavaScript 编写的，而不是 Python。但是，它与*可以*用 Python 编写的 Web 服务通信。

对于编写良好的桌面应用程序，转换应该非常容易。如果您已经在代码的 GUI 部分和引擎部分之间进行了清晰的分离，那么引擎部分将只需要进行微小的更改（并且可能将其保留在后面，例如 WSGI 服务器）。您将不得不为 Web 重写 GUI 部分，但在复杂的应用程序中，这应该是简单的部分。

然而，许多桌面 GUI 应用程序并没有如此清晰的分离。例如，如果您有直接对模型执行操作的按钮处理程序，那么如果不在两侧（Python Web 服务和 JS 客户端应用程序）复制模型并同步两者，就没有办法让它工作，这是一个大量的工作并导致糟糕的体验。在这种情况下，您必须决定是从头开始重写您的大部分应用程序，还是将其重构到您可以对其进行 Web 服务化的程度。

如果您确实选择了重构路线，我会考虑添加第二个本地界面（可能使用该`cmd`模块来构建 CLI，或`tkinter`用于替代 GUI），因为这样做更容易。一旦相同的后端代码可以支持您的 PyQt GUI 和您的`cmd`GUI，添加 Web 界面就容易多了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-06T20:43:22.970

If I get your point correctly, you want

1.  Web connection, so your python program updated on server, client get it before using it.
2.  Data store on local to avoid upload big file.

You can write a python program to check a server location to get your latest program if needed. You need a url / server file for program version / created date/time information to determine if you need to update or not. After get latest python program, then start this python program to run locally.

With this said, What you need is to update your program to add below features:

*   Access your server, to get latest version information
*   Check against current version to see if you need to download latest program
*   Download latest version and use that to run locally.

Does this solve your problem?

# html - Firefox 19：使用 requestAnimationFrame 和 HTML5 画布时帧速率不稳定。FPS超过60

> ID：15101777
> 
> 赞同：0
> 
> 时间：2013-02-26T23:55:46.253
> 
> 标签：html, firefox, canvas, frame-rate, requestanimationframe

我正在使用 HTML5 画布开发游戏，所以我有使用 requestAnimationFrame 调用的游戏循环。当我使用 Chrome 或 IE 时，它运行良好，稳定 60 fps 并且流畅。当我在 Firefox 上运行它时，问题就开始了。FPS 计数器超过 60 fps（设置在 65-70 左右），并且游戏体验一点也不流畅。如果它实际上运行超过 60 fps，我想我可能会丢失一些帧。这是我用于游戏循环的代码：

```
window.requestAnimFrame = (function() {
    return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame ||
    function(callback) {
        window.setTimeout(callback, 1000 / 60); 
    };
})();

    gameloop=function(){
       //Here I do my calculations and drawings

       //I do this to calculate FPS
       thisLoop=new Date;
       var fps=1000/(thisLoop-lastLoop);
       lastLoop=thisLoop;

       requestAnimFrame(gameloop());
    } 
```

你对此有什么解释吗？这甚至可能是正常的，但我玩其他游戏，他们在 Firefox 上似乎根本没有这样的行为。

我试过这个解决方案：

[http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating](http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating)

但最终结果是一样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:23:46.673

```
requestAnimationFrame(gameloop()); 
```

那正确吗？这意味着您正在从自身调用游戏循环并等待它完成（这永远不会发生），然后再将其返回值 ( `null`) 传递给`requestAnimationFrame`. 您的游戏将尽可能快地运行，并且永远不会屈服于 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-27T21:59:43.070

`requestAnimFrame(gameloop());`

这是您的错误，这不是回调，您只是直接调用该方法。

`requestAnimFrame(gameloop);`

这会将要调用的实际游戏循环函数发送给 rAF。

# ios - iOS 自定义框架 .framework 文件

> ID：15101778
> 
> 赞同：2
> 
> 时间：2013-02-26T23:56:03.913
> 
> 标签：ios, frameworks

我遵循了本教程：

[https://github.com/jverkoey/iOS-Framework](https://github.com/jverkoey/iOS-Framework)

并让一切都在开发端工作。即使是依赖产品也能正常工作。最后，我有一个 .framework、.a、headers 文件夹和构建后的 include 文件夹。文章说您只需将 .framework 拖到您的项目中并包含 #include 但是，当我这样做并构建时，我得到一个链接器错误：

```
ld: framework not found MyFramework 
```

请记住，我在我的依赖项目中有这个工作、链接等，但在那个项目中，我将框架项目复制到了测试项目中。将 .framework 拖过来后，我是否需要执行一些步骤？我也尝试拖动 .a 没有成功（相同的错误消息）。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T00:19:07.117

你确定你的框架结构完全正确吗？由于您之前只是将它用作子项目，因此您可能无法正确构建框架目录。

它应该看起来像：

```
MyFramework.framework     //(directory)
  info.plist
  MyFramework             //(symbolic link to Versions/Current/MyFramework)
  Resources               //(symbolic link to Versions/Current/Resources)
  Headers                 //(symbolic link to Versions/Current/Headers)
  Versions                //(directory)
    Current               //(symbolic link to directory "A" below)
    A                     //(directory)
      Headers             //(directory containing framework headers)
      Resources           //(directory holding framework resources)
      MyFramework         //(actual compiled library, really a .a file) 
```

框架中的 .a 文件不应以 .a 结尾。如前所述，所有这些符号链接都必须正确，`ls -l`框架目录中的“”应如下所示：

```
drwxr-xr-x   7 kendall  admin   238B Feb 19 13:36 ./
drwxr-xr-x  11 kendall  admin   374B Feb 19 13:36 ../
lrwxr-xr-x   1 kendall  admin    24B Feb 19 13:36 Headers@ -> Versions/Current/Headers
lrwxr-xr-x   1 kendall  admin    30B Feb 19 13:36 MyFramework@ -> Versions/Current/MyFramework
lrwxr-xr-x   1 kendall  admin    26B Feb 19 13:36 Resources@ -> Versions/Current/Resources
drwxr-xr-x   4 kendall  admin   136B Feb 19 13:36 Versions/
-rw-r--r--   1 kendall  admin   215B Feb 19 13:36 info.plist 
```

info.plist 的内容（它告诉链接器框架中静态库的名称到底是什么）看起来像：

```
CFBundleDevelopmentRegion
English
CFBundleExecutable
MyFramework
CFBundleIdentifier
com.pushio.pushiomanager
CFBundleInfoDictionaryVersion
6.0
CFBundlePackageType
FMWK
CFBundleSignature
????
CFBundleVersion
1.0.0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T00:06:50.243

*）我想您在拖动或复制框架时错过了单击复选框“将项目复制到目标组文件夹（如果需要）”。

*) 并确保通过转到项目 -> 目标 -> 构建阶段 -> 将二进制文件与库链接并添加框架来链接框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T22:19:06.010

在上面的教程中，您需要确保删除了最新版本的 XCode 添加的 Copy Files Build 阶段。这是由于这一步造成的。其他所有内容均已正确添加。

# php - 使用 PHP 显示来自单个 MySQL 字段的多个链接

> ID：15101782
> 
> 赞同：0
> 
> 时间：2013-02-26T23:56:13.423
> 
> 标签：php, mysql, loops

我在单个数据库字段中插入了多个链接，如下所示：

```
    +--+---------------------------------- --------------------------------------------+
    |身份证| 链接 |
    +--+---------------------------------- --------------------------------------------+
    |1 |http//link1.com< br /> http://link2.com < br /> http://link3.com/apage.php?id=3|
    +--+---------------------------------- --------------------------------------------+

```

如何从该单个字段中循环出单个链接并使用 php 将它们显示在单独的行上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:00:30.970

一旦您查询了您的表并有一个包含您的示例的变量，即：

```
$links = 'http//link1.com< br />http://link2.com< br />http://link3.com/apage.php?id=3'; 
```

简单地：

```
$links_r = explode('< br />', $links);
foreach ($links_r as $link_s) {
  echo '<a href="' . $link_s . '">' . $link_s . '</a><br />';
} 
```

# php - 在 PHP 中添加时间

> ID：15101788
> 
> 赞同：0
> 
> 时间：2013-02-26T23:56:51.173
> 
> 标签：php, mysql, time

我认为这将是一个非常简单的问题，但我在任何地方都没有找到解决方案。

我正在用 PHP 和 mySQL 创建一个调度程序。班次有一个 startTime 和 endTime，每一个都在 mySQL 中存储为 TIME。

我想将一周内员工的总小时数相加，所以我尝试了：

```
$shifts = [...] //shifts for the week
$totalTime = 0; //I've also tried "0:0:0" and strtotime("0:00:00");

for($d = 0; $d < 7; $d++){
    $start = strtotime($shift_types[$shifts[$d]]['ShiftType']['start_time']);
    $end = strtotime($shift_types[$shifts[$d]]['ShiftType']['end_time']);
    echo date("g:ia", $start) . ' / ' . date("g:i a", $end); 
    $totalTime += ($end-$start);
    }
} 
```

问题在于 $totalTime 没有达到任何合理的数字。我认为这是因为 PHP 将 $totalTime 视为自 1970 年以来的时间戳，这将导致完全不同的结果。我真正想要的只是一个净小时值，它不需要任何与它相关的日期值。

我应该提到我正在显示总时间

```
echo date("g:i", $totalTime); 
```

当它以 9:30:00 开始和 16:15:00 结束运行时，它显示“1:45”。当没有触摸总时间时（因为没有班次），它显示“7:00”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:02:10.327

`strtotime`返回一个 Unix 时间戳，即自该时间表示的纪元以来的秒数。因此，使用秒数（并`$totalTime`从零开始）是正确的方法。如果你想要小时数，你需要：`$totalTime = $totalTime / (60 * 60);`在你的循环之后（除以 3600 秒/小时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:06:26.157

我认为这可以满足您的要求：

```
$t1 = strtotime("2013-01-01 00:00:00");
$t2 = strtotime("2013-01-15 00:00:00");

echo round(($t2-$t1)/3600) ." hours". PHP_EOL; 
```

或者您可以使用我的博客文章[http://webmonkeyuk.wordpress.com/2011/05/04/working-with-date-and-time-in-php/](http://webmonkeyuk.wordpress.com/2011/05/04/working-with-date-and-time-in-php/)中描述的两个`DateTime`对象和方法`diff()`

# bash - 如何让bash以多行格式将命令输出重定向到文件

> ID：15101790
> 
> 赞同：0
> 
> 时间：2013-02-26T23:57:01.330
> 
> 标签：bash, file, redirect, multiline, output

如何让 bash 将具有多个输出的命令的输出重定向到具有多行的文件。例子：

```
rsync --progress -v /source /destination >> file.txt 
```

cat file.txt 将给出：

```
file1 file2 file3 
```

当我希望文件看起来像终端或标准输出上的输出时：

```
file1
file2
file3 
```

谢谢，科里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:00:02.107

如果您只想将空格转换为换行符，请使用`tr`：

```
rsync --progress -v /source /destination | tr ' ' '\012' >> file.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T22:50:33.840

我实际上是在使用命令“s3cmd sync --no-progress /source /dest >> file.txt”通过 cat 管道传输它。谢谢您的帮助。"| tr ' ' '/012' >> file.txt" 也有效，但它将行中的每个空格都视为新行。谢谢您的帮助。

# css - 过滤后登录页面不呈现样式表

> ID：15101792
> 
> 赞同：4
> 
> 时间：2013-02-26T23:57:19.833
> 
> 标签：css, jsf-2

'正在开发一个 JSF 2 项目。我已将 login.xhtml 页面定义为 web.xml 中的入口页面

```
 <welcome-file-list>
        <welcome-file>login.xhtml</welcome-file>
    </welcome-file-list> 
```

我还有一个过滤器来检查用户是否登录

```
 @WebFilter(filterName = "loginCheckFilter", urlPatterns={"/*"})
    public class LoginCheckFilter implements Filter
    {
        @Inject
        private LoginStatus loginStatus;

        public void do Filter(...)
        {
            try{
            HttpServletRequest req = (HttpServletRequest) request;
            HttpServletResponse res = (HttpServletResponse) response;

            String path = req.getRequestURI();
            if(StringUtils.isNotBlank(path)
               && StringUtils.contains(path, ".xhtml")
               && !StringUtils.endsWith(path, "login.xhtml"))
             {
                    if(loginStatus == null
                       || !loginStatus.isLoggedIn())
                     {
                          res.sendRedirect(req.getContextPath() + "/login.xhtml");
                      }
                     else
                      {
                           chain.doFilter(request, response);
                       }
              }
              else
              {
                  chain.doFilter(request, response);
               }
            }catch (Exception ex)
             {
                  log.error(ex);
              }
           }

        .... ....
        } 
```

我的 css 文件以以下样式引用：

```
 <link href="css/styles.css" rel="stylesheet" type="text/css"/> 
```

一切正常，直到我将 css 引用样式更改为 JSF 2 资源处理程序 ( [http://www.mkyong.com/jsf2/resources-library-in-jsf-2-0/](http://www.mkyong.com/jsf2/resources-library-in-jsf-2-0/) )。我已将所有 css 文件复制到资源文件夹下，并提供了库名称和版本号。所以现在我引用css如下：

```
 <h:outputStylesheet library="default" name="css/styles.css"/> 
```

更改后，login.xhtml 不再呈现样式表。我在 login.xhtml 页面之后有一个 welcome.xhtml 页面，除了核心内容外，它的结构几乎相同，但这个页面呈现得非常好。我已经刷新了 login.xhtml 仍然没有呈现。但是一旦我登录，前进到下一页，然后回到 login.xhtml，然后刷新，就会呈现样式。此外，如果我取消 loginCheckFilter，login.xhtml 将呈现样式表。那么，如果有人遇到类似的情况并知道如何解决呢？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T00:50:58.057

```
urlPatterns={"/*"} 
```

您的过滤器还会阻止对 JSF 资源的请求。

您需要以允许 JSF 资源请求的方式重写您的过滤器。

```
@Override
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws ServletException, IOException {    
    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;
    String loginURL = request.getContextPath() + "/login.xhtml";

    boolean loggedIn = loginStatus != null && loginStatus.isLoggedIn();
    boolean loginRequest = request.getRequestURI().startsWith(loginURL);
    boolean resourceRequest = request.getRequestURI().startsWith(request.getContextPath() + "/faces" + ResourceHandler.RESOURCE_IDENTIFIER);

    if (loggedIn || loginRequest || resourceRequest)) {
        if (!resourceRequest) { // Prevent restricted pages from being cached.
            response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
            response.setHeader("Pragma", "no-cache"); // HTTP 1.0.
            response.setDateHeader("Expires", 0); // Proxies.
        }

        chain.doFilter(request, response);
    } else {
        response.sendRedirect(loginURL);
    }
} 
```

# java - .class 在类名之后是什么意思

> ID：15101794
> 
> 赞同：36
> 
> 时间：2013-02-26T23:57:24.567
> 
> 标签：java

是什么`.class`意思，例如，`MyClass.class`？我知道当您输入一个类的名称以及它用于访问其静态字段或方法的点时，但这与“.class”无关

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-26T23:59:46.987

`SomeClass.class`获取`Class<SomeClass>`可用于使用[反射 API](http://docs.oracle.com/javase/tutorial/reflect/index.html)进行编程的类型。

如果你有一个类的实例，你可以获得相同的类型`instance.getClass()`。

您可以在此处查看[文档](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)。例如，您可以：

*   获取字段和方法的名称、注释等。
*   调用方法，获取构造函数以创建类的新实例
*   获取类名、超类名、包名等

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-27T00:02:33.917

当你写`.class`在类名之后时，它引用[`Class`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)代表给定类的对象（正式地，它是一个命名的*类字面*量）。的类型`NombreClase.class`是`Class<NombreClase>`。

例如，`NombreClase.class`是一个表示`NombreClase`运行时类的对象。它与`getClass()`的任何（直接）实例的方法返回的对象相同`NombreClase`。

```
NombreClase obj = new NombreClase();
System.out.println(NombreClase.class.getName());
System.out.println(obj.getClass().getName()) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-27T00:02:55.033

您可以添加`.class`到任何类的名称以检索其*Class*对象的实例。

使用时，`Integer.class`您引用 的实例`Class<Integer>`，这是一个类型化的类对象。

我一直以为这是编译器添加的字段成员，但看起来它实际上只是语法糖。

# javascript - 在Javascript中通过参数传递变量

> ID：15101810
> 
> 赞同：0
> 
> 时间：2013-02-26T23:59:25.710
> 
> 标签：javascript, arrays, debugging, parameters, xmlhttprequest

在这里，我有一段代码，我一直在通过 Firebug 进行调试。我想知道如何将参数传递给`foo`函数`getHoliday(param,param,param)`。这是我的 XMLHttpRequest 中的代码块。

```
if (XMLHttpRequestObject.readyState==4 && XMLHttpRequestObject.status == 200)
{
    var pp = null
    var dd = null
    var xmlResponse = XMLHttpRequestObject.responseXML;
    var foo = new Array();
    foo = parseXML(xmlResponse);
    getHoliday(pp,dd,foo);
} 
```

的前两个参数`getHoliday`直到过程后期才使用。我想首先`getHoliday`从数组中加载数据，`foo`以便将来我可以使用 foo ，如下所示。一旦我的断点到达 getHoliday，脚本就会停止，所以我认为是参数错误。我想指出，`pp`什么`dd`都不是，只是空未定义参数的占位符。

```
function getHoliday(monthSelected,theday,names)
{   
    var HolidayName = new Array();
    var holiday = ""
    HolidayName = names;  
    monthSelected = monthSelected + 1;
    for(var index = 0; HolidayName.length >= index; index++)
    {   
        if(HolidayName[index] == monthSelected && HolidayName[index+1] == theday)
        {
            holiday = HolidayName[index+2]
        }
    }
    return holiday
} 
```

我一到这里，`names`我刚刚传递的数组就变成了未定义的。为什么？下面是`HolidayName`数组的外观。

```
HolidayName = new Array(2,4,"Party--12:00",2,22,"Eventalist Launch--6:00",2,18,"Play Day--12:00",3,17,"Play Day--12:00");); 
```

当警报`foo`结果是：

```
2,4,"Party--12:00",2,22,"Eventalist Launch--6:00",2,18,"Play Day--12:00",3,17,"Play Day--12:00" 
```

这是 parseXML

```
function parseXML(xmlData)
{
    var aOutput=document.getElementById("testing2");
    var events = xmlData.getElementsByTagName('year').length;
    for(var i=0;i< events;i++)
    {
        var eYear = xmlData.getElementsByTagName('year')[i].firstChild.nodeValue;
        var eMonth = xmlData.getElementsByTagName('month')[i].firstChild.nodeValue;
        var eDay = xmlData.getElementsByTagName('day')[i].firstChild.nodeValue;
        var eHour = xmlData.getElementsByTagName('hours')[i].firstChild.nodeValue;
        var eMinute = xmlData.getElementsByTagName('minutes')[i].firstChild.nodeValue;
        var eTitle = xmlData.getElementsByTagName('title')[i].firstChild.nodeValue;
        var holiStr = '"' + eTitle + "--" + eHour  +":"+ eMinute + '"';
        setup.push(eMonth,eDay, holiStr);
    }
    return setup;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T02:31:26.057

鉴于您提供的信息，最好的猜测：代码中是否有 var foo ？Javascript 没有块级作用域，这些被提升到函数的顶部，而 var foo lower 可能会改变你的 foo 值。

# nhibernate - 解释 CreateCriteria(typeof(Cat)) 和 CreateCriteria 的区别 ()

> ID：15101813
> 
> 赞同：2
> 
> 时间：2013-02-26T23:59:49.327
> 
> 标签：nhibernate, nhibernate-criteria, createcriteria

我已经在不同的示例、教程、博客等中看到了这两种格式，但在我的一生中，我无法找到差异的解释。和有什么区别

```
ICriteria crit = session.CreateCriteria(typeof(Cat)); 
```

和

```
ICriteria crit = session.CreateCriteria<Cat>(); 
```

我什么时候使用一个，什么时候使用另一个？

可以在[http://nhibernate.info/doc/nh/en/index.html#quickstart找到使用 session.CreateCriteria(typeof(Cat)) 的教程示例](http://nhibernate.info/doc/nh/en/index.html#quickstart)

可以在[http://ayende.com/blog/4023/nhibernate-queries-examples](http://ayende.com/blog/4023/nhibernate-queries-examples)找到使用 session.CreateCriteria() 的教程示例（表 Blog 而不是 Cat）

非常感谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T05:11:02.043

没有**区别**。如果可能，您可以/应该使用泛型，如果您只能访问 Type 实例（一些反射），则可以使用非泛型。

非泛型是 NHibernate 从 Java 导入的那一刻起的一部分`Hibernate`。

泛型是在*`Build 2.1.0.Alpha1`*版本中添加的。

但是因为结果*是非泛型的* `ICriteria` （与 的结果相比`QueryOver<T>()`）它只是一个语法糖。

# django - 使用 django-registration 和 django-socialauth 时如何显示注册后欢迎消息？

> ID：15101816
> 
> 赞同：2
> 
> 时间：2013-02-26T23:59:56.270
> 
> 标签：django, django-views, django-registration, django-socialauth

这是一个非常微不足道的问题，但我一定遗漏了一些东西，因为我无法提出我满意的解决方案。

我正在使用两个库来处理注册，django-registration 用于基于电子邮件的注册，django-socialauth 用于基于社交的注册，并且希望在用户第一次注册时显示欢迎消息。

我目前的方法是使用上下文处理器检查用户是否在过去 2 分钟内注册，如果是，则更新请求对象。这似乎效率低下，因为我每次都检查它只使用一次。

我尝试使用信号来实现它，但我遇到的问题是我需要某种方式来挂钩请求，但只有 django-registration 会传递请求。

我正在考虑的一个选项是使用信号来更新数据库中的记录，但这对于这么简单的事情来说似乎有点过分了。我错过了一些明显的东西吗？

context_processors.py：

```
def just_registered(request):
    just_registered = False
    if request.user.is_authenticated() and request.user.email:
        if request.user.date_joined < datetime.today() + timedelta(minutes=2):
            if 'just_registered' not in request.session:
                just_registered = True
                request.session['just_registered'] = just_registered
    return { 'just_registered' : just_registered } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T00:25:22.647

您可以使用 django 消息并在模板​​中实现它

```
{% if messages %}
    {% for message in messages %}
    {{message}}
    {% endfor %}
{% endif %} 
```

.

```
def just_registered(request):
    if request.user.is_authenticated():
        if request.user.date_joined < datetime.today() + timedelta(minutes=2):
            messages.info(request, "Welcome")
    return '' 
```

user is authenticated 已经明白了，你不必输入用户电子邮件，因为当你注册时，电子邮件是必需的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T04:37:50.420

根据您对公主的评论，您最好的选择是在用户第一次登录时保存某种数据。

我建议编写一个简单的中间件来检测首次登录并将其保存为持久形式

看看这个：

[http://blog.elcodo.pl/post/926902087/django-detect-users-first-login](http://blog.elcodo.pl/post/926902087/django-detect-users-first-login)

您还可以在 django tracking 中签出中间件

[https://github.com/codekoala/django-tracking/blob/master/tracking/middleware.py](https://github.com/codekoala/django-tracking/blob/master/tracking/middleware.py)

它的效率有点低，但是鉴于 HTTP 的无状态性，我看不到任何其他方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T23:19:40.853

为了清楚起见，您想在用户第一次成功登录时显示欢迎消息（它在您的问题中表示第一次注册）？他们是否关注电子邮件中的激活链接？您可以将该电子邮件链接转到登录页面的新用户版本。

否则，如果您想为普通用户和第一次登录的人使用相同的页面，我看不出如何避免检查这是否是用户第一次登录。要做到这一点，看起来像在用户上使用布尔属性（或对他们进行 fk'ed）来跟踪他们之前是否登录过，而不是查看他们多久之前激活了帐户（如果他们激活了 2 天呢？以前但没有登录？）

# javascript - 在 node.js 中捕获控制台输出而不编辑服务器代码

> ID：15101817
> 
> 赞同：2
> 
> 时间：2013-02-26T23:59:57.683
> 
> 标签：javascript, linux, node.js, shell, console

第一个stackoverflow问题！我正在尝试从 node.js 服务器捕获所有 console.log() 输出。假设我在一台 linux 机器上，**我无法编辑服务器的代码**，（项目负责人的请求）。但是，我可以更改启动服务器的方式（节点 --debug server.js），并且可以附加 shell 脚本。我的意图是将控制台输出通过管道传输到另一个 socket.io 服务器。

我认为唯一明显的解决方案是编写一个 linux 命令将服务器的输出通过管道传输到某些东西，或者 node.js 有一个棘手的 --debug 方法来输出信息。

最终结果是，我希望能够运行服务器并将控制台输出通过管道传输到 API 测试服务器。这样，测试人员将能够看到与来自 API 端点的响应 JSON 对象相关的服务器输出（流式传输）。

谢谢，我很想听听您的解决方案...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:09:13.063

如果有人感兴趣，请通过 IRC 回答：

```
<shesek> patrickm, can't you just pipe the output to another script?
<shesek> node server.js | node send-logs-to-somewhere.js
<shesek> patrickm, in send-logs-to-somewhere.js, you can just read from process.stdin
<patrickm> :)
<patrickm> thats easy 
```

# java - 从客户适配器的 getView 内的 onclick 侦听器访问特定视图

> ID：15101820
> 
> 赞同：1
> 
> 时间：2013-02-27T00:00:07.553
> 
> 标签：java, android, android-listview, custom-adapter

我希望 onclick 方法与我的布局中的其他视图进行通信。尝试这样做时，我得到了 NullPointerException。我想我可能做错了。

我的`getView`方法如下：

```
 public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    ViewHolder holder;
    final int p =position;
    if (v == null) {
       LayoutInflater vi = (LayoutInflater) _c.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
       v = vi.inflate(R.layout.menuitemrow, null);
       holder = new ViewHolder();
       holder.image = (ImageView) v.findViewById(R.id.MIR_itemImage);holder.image.setTag(position);
       holder.itemName = (TextView)v.findViewById(R.id.MIR_itemName);holder.itemName.setTag(position);
       holder.itemPrice = (TextView)v.findViewById(R.id.MIR_itemPrice);holder.itemPrice.setTag(position);
       holder.itemOther = (TextView)v.findViewById(R.id.MIR_itemOther);holder.itemOther.setTag(position);
       holder.details = (Button) v.findViewById(R.id.MIR_detailsbtn);holder.details.setTag(position);
       holder.qAdd = (Button) v.findViewById(R.id.MIR_qaddbtn);holder.qAdd.setTag(position);
       v.setTag(holder);
    } else 
        holder = (ViewHolder) v.getTag();
    MenuItemDetail mid = _data.get(position);
    holder.image.setImageResource(mid.icon);
    holder.itemName.setText(mid.itemName);
    holder.itemPrice.setText("Price: $"+mid.itemPrice);
    holder.itemOther.setText(mid.itemOther);
    //set click listeners
    holder.details.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            m =_data.get(p);
            s = m.getItemName();
            Toast.makeText(_c, "clicked details"+p+" "+s, Toast.LENGTH_SHORT).show();
        }
    });
    holder.qAdd.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            Toast.makeText(_c, "clicked quick add "+p, Toast.LENGTH_SHORT).show();
            TextView btnUpdate = (TextView) v.findViewById(R.id.CBV_textview2);
            //btnUpdate.setTag(1);
            //btnUpdate.setText(btnUpdate.getTag().toString());
            btnUpdate.setText("b");
        }
    });

    return v;
} 
```

正如你所看到的，我只是为它分配了一个数字，`getTag`只是为了将它传递给`setText`方法。我已经尝试使用它来注释掉集合并获取，只使用`String`.

有问题的线是`btnUpdate.setText("b");`

有任何想法吗？

总结一下，我正在尝试从其客户适配器的方法访问`TextView`自定义`Button`内部的自定义。`ListView``getView`

更新评论：

这是与其他按钮一起显示的自定义列表视图。`ListView`当单击以更新我创建的自定义按钮的文本视图时，我想要列表视图项（自定义的一部分），该按钮显示在与自定义列表视图相同的活动中。

布局如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/MI_backbutton"
    android:layout_width="fill_parent"
    android:layout_height="50dp"
    android:layout_weight="1"
    android:text="@string/back_list_categories"
    android:textSize="@dimen/FontSize8" />

<ListView
    android:id="@+id/menuList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_weight="20" >
</ListView>

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:layout_gravity="bottom"
    android:layout_marginBottom="5dp"
    android:layout_weight="1" >

    <Button
        android:id="@+id/button2"
        style="@android:style/Widget.Button"
        android:layout_width="wrap_content"
        android:layout_height="50dp"
        android:layout_gravity="bottom"
        android:layout_weight="1"
        android:text="@string/generalbutton" />

    <include
        android:id="@+id/MI_checkorder"
        style="android:buttonStyle"
        android:layout_width="wrap_content"
        android:layout_height="50dp"
        android:layout_gravity="bottom"
        android:layout_marginTop="5dp"
        android:layout_weight="1"
        layout="@layout/custombtnview"
        android:background="@style/AppTheme"
        android:clickable="true"
        android:focusable="true" />

</LinearLayout> 
```

在我引用获取 Textview 的视图中，textview 不存在。这种观点是`MI_checkorder`. 我在想也许这就是为什么我要`NullPointerException`为我的`btnUpdate`. textveiw`CBV_textview2`是我作为按钮（`MI_checkorder`）创建的视图的一部分。

我现在有了按钮，但无法在 UI 上显示更改。这是我添加的代码：

```
 public void onClick(View v) {
            Toast.makeText(_c, "clicked quick add "+p, Toast.LENGTH_SHORT).show();
            TextView btnUpdate = (TextView) inflateToEdit(_c, v).findViewById(R.id.CBV_textview2);
            //btnUpdate.setTag(1);
            //btnUpdate.setText(btnUpdate.getTag().toString());
            btnUpdate.setText("b");
        } 
```

这是我在自定义适配器类中创建的方法。

```
 public View inflateToEdit(Context c, View view){
    View vw = view;
    LayoutInflater vi = (LayoutInflater) _c.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    return vi.inflate(R.layout.custombtnview, null);
} 
```

它正在更新按钮的文本，但未在 UI 上显示。我不认为我可以从代码中的这一点更新 UI。我想我需要从活动中做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T01:38:42.393

这是因为在视图上调用的*findViewById*会查找给定视图的子视图。

[findViewById 文档](http://developer.android.com/reference/android/view/View.html#findViewById%28int%29)

“查找具有给定 id 的子视图。如果此视图具有给定 id，则返回此视图。”

据我所知，CBV_textview2 包含在活动的布局中。因此，您可以做的是将活动传递给适配器的构造函数（我看到您已经有一个 _c 成员变量，我认为它是一个上下文，或者直接传递 CBV_textview2 本身（在包含的活动中调用 findViewById）。

在这两种情况下，您都需要调用活动的 findViewById，它“从 onCreate(Bundle) 中处理的 XML 中查找由 id 属性标识的视图”。

```
public class YourAdapter extends ArrayAdapter<String> {
  private final Context context;
  // blahblahblah
  private final TextView mYourTextView;

 public YourAdapter(Context context, String[] values, TextView btnUpdate) {
     super(context, R.layout.rowlayout, values);
     this.context = context;
     this.values = values;
     mYourTextView = btnUpdate;
 }

 ....

 @Override
    public void onClick(View v) {
        Toast.makeText(_c, "clicked quick add "+p, Toast.LENGTH_SHORT).show();
        //mYourTextView.setTag(1);
        //mYourTextView.setText(btnUpdate.getTag().toString());
        mYourTextView.setText("b");
    } 
```

在您的活动中，您应该能够在调用构造函数之前获取 TextView。

# iphone - 绘制线的优化，CAShapeLayer 的可能替代方案

> ID：15101821
> 
> 赞同：3
> 
> 时间：2013-02-27T00:00:20.890
> 
> 标签：iphone, ios, objective-c, optimization, cashapelayer

我需要在屏幕上绘制多条线（在 50-75 范围内），目前使用下面的函数可以正常工作。在使用下面的代码绘制了 40-50 行之后，应用程序在我的 iPhone 4 中明显变慢了。为了优化，我尝试删除它帮助的线阴影，但应用程序仍然没有像我想要的那样流畅运行。我需要优化下面的代码，我的第一个想法是用 .png 线条图像替换 cashapelayers。但是新方法应该支持线旋转，相同宽度的不同长度的线，以及绘图的动画（对我来说似乎很多与cgaffinetransforms有关）。有什么可以帮助我的想法吗？

```
+ (CAShapeLayer *) drawLineOnView:(UIView *) view BetweenPoint1:(CGPoint) point1 Point2:(CGPoint) point2 lineWidth:(CGFloat)lineWidth lineColor:(UIColor *) color Animated:(BOOL) animed
{
    CAShapeLayer *lineShape = [CAShapeLayer layer];
    CGMutablePathRef linePath = nil;
    linePath = CGPathCreateMutable();

    //lineShape.opacity = 0.6;
    lineShape.lineWidth = lineWidth;
    lineShape.lineCap = kCALineCapRound;

    if(color==nil) color = [UIColor orangeColor]; //Default value
    lineShape.shadowColor = [color CGColor];
    lineShape.shadowOpacity = 1.0;
    lineShape.shadowRadius = 5.0;
    lineShape.strokeColor = [color CGColor];

    CGPathMoveToPoint(linePath, NULL, point1.x, point1.y);
    CGPathAddLineToPoint(linePath, NULL, point2.x, point2.y);

    if(animed)
    {
        CABasicAnimation *pathAnimation = [CABasicAnimation animationWithKeyPath:@"strokeEnd"];
        pathAnimation.duration = 1.0;
        pathAnimation.fromValue = [NSNumber numberWithFloat:0.0f];
        pathAnimation.toValue = [NSNumber numberWithFloat:1.0f];
        [lineShape addAnimation:pathAnimation forKey:@"strokeEndAnimation"];
    }

    lineShape.path = linePath;
    CGPathRelease(linePath);
    [view.layer addSublayer:lineShape];

    return lineShape;
} 
```

**部分解决**（优化永无止境）

我将我的线条绘制功能分解为 2 个互补部分，并将多条线条绘制到一个形状图层中，而不是每次都创建新图层。如果不是很好，它会更好。这是更新的代码：

```
+ (CAShapeLayer *) createNewShapeLayerForDrawingLinesOnView:(UIView *) view lineWidth:(CGFloat)lineWidth lineColor:(UIColor *) color
{
    CAShapeLayer *lineShape = [CAShapeLayer layer];

    //lineShape.opacity = 0.6;
    lineShape.lineWidth = lineWidth;
    lineShape.lineCap = kCALineCapRound;

    if(color==nil) color = [UIColor orangeColor]; //Default value
    lineShape.shadowColor = [color CGColor];
    lineShape.shadowOpacity = 1.0;
    lineShape.shadowRadius = 5.0;
    lineShape.strokeColor = [color CGColor];

    [view.layer addSublayer:lineShape];
    return lineShape;
}

+ (void) addNewLineToShapeLayer:(CAShapeLayer *) shapeLayer BetweenPoint1:(CGPoint) point1 Point2:(CGPoint) point2
{
    CGMutablePathRef combinedPath = CGPathCreateMutableCopy(shapeLayer.path);

    CGMutablePathRef linePath = CGPathCreateMutable();

    CGPathMoveToPoint(linePath, NULL, point1.x, point1.y);
    CGPathAddLineToPoint(linePath, NULL, point2.x, point2.y);

    //No paths drawn before
    if(combinedPath == NULL)
    {
        combinedPath = linePath;
    }
    else
    {
        CGPathAddPath(combinedPath, NULL, linePath);
    }

    shapeLayer.path = combinedPath;
    CGPathRelease(linePath);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T00:12:09.697

虽然我理解想要创建多个图层，但将所有线条绘制成一个并从那里管理线条列表的动画和旋转会更有效。您可以在具有组合路径的形状层中执行此操作（缺少标有“...”的代码）：

```
CGMutablePathRef combinedPath = CGPathCreateMutableCopy(path.CGPath);
for(...)
    CGPathAddPath(combinedPath, NULL, [self makeNewPathFrom:...].CGPath);
myLayer.path = combinedPath; 
```

更快的是，您可以将线列表直接绘制到[CALayer 的图形上下文中](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGContext/Reference/reference.html)。这个视图`drawRect:`方法的例子未经测试，但应该给你一个想法：

```
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSetLineWidth(context, lineWidth);
CGContextSetRGBStrokeColor(context, 1.0, 0.0, 0.0, 1.0); //red

for(MyLine *line in lines)
{
    CGContextMoveToPoint(context, point1.x, point1.y);
    CGContextAddLineToPoint(context, point2.x, point2.y);
} 
```

如果您需要进一步优化，您应该研究 OpenGL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:30:34.333

你绝对*不*想要 75 层，每层都有自己的线。您确定不能在单个图层中绘制单个更复杂的路径吗？

# unix - 在 Jenkins 作业中为 url 指定一个 ip

> ID：15101823
> 
> 赞同：0
> 
> 时间：2013-02-27T00:00:24.327
> 
> 标签：unix, dns, jenkins, ip, host

我有以下情况。

我公司的 webapp 在上线之前已经部署到多个环境中。每个测试环境都称为 qa-X，并具有不同的 IP 地址。我想做的是在 jenkins 作业“在 qa-x 中测试应用程序”中指定 x 环境的应用程序 IP，以便我的测试仅在知道应用程序 url 时才开始运行。

Jenkins 本身在 qa-x 环境之外。

我一直在寻找解决方案，但它们都破坏了 qa-X 的其他测试。例如，更改 /etc/hosts 或更改 dns 服务器。很棒的是，我可以在该作业中仅指定 ip 作为配置参数，并且该定义仍然是本地的。

有什么想法/想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T05:51:08.660

如果我正确理解您的查询，您应该考虑创建一个[参数化构建](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Build)，该构建将公开一个具有所需服务器 IP 的环境变量，您的测试脚本可以使用它。

# jquery - jQuery 更改 Nivo Control Nav 默认行为

> ID：15101831
> 
> 赞同：1
> 
> 时间：2013-02-27T00:01:11.830
> 
> 标签：jquery, wordpress, nivo-slider

默认情况下，jQuery 插件 Nivo Slider 使用点作为控件导航。默认情况下，单击这些点会显示它附加到的幻灯片。我需要防止这种行为，而是让每个点在点击时转到一个 url。我想我需要使用该`afterLoad`功能，但我遇到了麻烦。

```
jQuery(document).ready(function() {

jQuery( '.theme-wcoc .nivo-controlNav a[rel="0"]' ).nivoSlider( {

afterLoad: function(){

    jQuery( '.theme-wcoc .nivo-controlNav a[rel="0"]' ).click( function( e ) {

        // Prevent default

        e.preventDefault();

    } );

} 
```

});

});

此代码不会阻止任何事情。这是我正在处理的项目。 [http://bit.ly/YWgKo5](http://bit.ly/YWgKo5)。提前感谢您的任何建议。

# mysql - oracle 日期问题

> ID：15101841
> 
> 赞同：-1
> 
> 时间：2013-02-27T00:02:33.763
> 
> 标签：mysql, sql, oracle, plsql

我有一个名为`ORDER`column的表`cancel_date_time`。我在用：

```
to_char(cancel_date_time,'YYYYMMDD HH24:MI:SS')
    not between ('20120214 10:00:00')
            and ('20120215 10:00:00') 
```

检索记录。`cancel_date_time`但是当is时它不返回任何记录吗`NULL`？

任何人都可以建议检索记录的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:16:13.807

Null 不是一个值，因此它不能与其他值进行比较。

你可以使用这样的结构：

```
 ...
    where
      nvl (cancel_date_time, date_value_for_empty_cancel_date) 
      not between ('20120214 10:00:00') and ('20120215 10:00:00') 
```

日期的字符串文字也是 NLS 依赖的，并且 to_char 可能会阻止使用索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:16:52.127

如果您想要其中的行`cancel_date_time`以及不在两个日期之间`NULL`的任何行`cancel_date_time`

```
WHERE cancel_date_time NOT BETWEEN to_date( '20120214 10:00:00','YYYYMMDD HH24:MI:SS') 
                               AND to_date( '20120215 10:00:00','YYYYMMDD HH24:MI:SS')
   OR cancel_date_time IS NULL 
```

您不想将函数应用于可能被索引的列。如果您想要日期比较语义，您希望将日期与日期进行比较。最后，由于`NULL`is 永远不会等于也永远不会不等于任何其他值，因此您需要显式检查`IS NULL`.

# wordpress - Wordpress 多站点 wp-config-php 配置

> ID：15101843
> 
> 赞同：2
> 
> 时间：2013-02-27T00:02:40.780
> 
> 标签：wordpress

质疑好人..首先我想说的是，在我来到这里之前，我不知疲倦地研究了这个，因为我通常会加强我的学习经验，但现在我需要帮助。有一些帖子和网站接近我的问题，但并没有完全解决我的问题。我会感谢你的帮助。

我在它自己的目录 (mysite.com/public) 中有一个 wordpress 网站。我最近将其转换为多站点网络。安装很顺利。我的问题是，当我导航到“我的站点 -> 网络管理员 -> 仪表板”时，它会转到[http://mysite.com/wp-admin/network/](http://mysite.com/wp-admin/network/)，这给了我一个错误 404。我的主仪表板包括公共目录： http: [//mysite.com/public/wp-admin/](http://mysite.com/public/wp-admin/)但网络仪表板没有。但是，如果我在链接地址 ( [http://mysite.com/public/wp-admin/network/](http://mysite.com/public/wp-admin/network/) ) 中输入单词 public，一切都很好。

在我的 wp-config-php 中，我将其配置为：

```
 define('WP_DEBUG', false);
 define('WP_ALLOW_MULTISITE', true);
 define('MULTISITE', true);
 define('SUBDOMAIN_INSTALL', true);
 define('DOMAIN_CURRENT_SITE', 'mysite.com');
 define('PATH_CURRENT_SITE', '/');
 define('SITE_ID_CURRENT_SITE', 1);
 define('BLOG_ID_CURRENT_SITE', 1);
 /* That's all, stop editing! Happy blogging. */ 
```

所以我尝试在路径行手动输入“public”：

```
 define('PATH_CURRENT_SITE', '/public/'); 
```

但随后我收到此浏览器错误消息：此网页有一个重定向循环该网页位于[http://mysite.com/public/wp-admin/network/](http://mysite.com/public/wp-admin/network/)

所以我被困在这一点上。我将感谢任何人对此的帮助。这是我的 .htaccess 配置以防万一，我使用的是 wordpress 3.5.1

```
 # BEGIN WordPress
 RewriteEngine On
 RewriteBase /
 RewriteRule ^index\.php$ - [L]

 # add a trailing slash to /wp-admin
 RewriteRule ^wp-admin$ wp-admin/ [R=301,L]

 RewriteCond %{REQUEST_FILENAME} -f [OR]
 RewriteCond %{REQUEST_FILENAME} -d
 RewriteRule ^ - [L]
 RewriteRule ^(wp-(content|admin|includes).*) public/$1 [L]
 RewriteRule ^(.*\.php)$ public/$1 [L]
 RewriteRule . index.php [L]
 # END WordPress 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-18T14:35:28.697

这个错误与`.htaccess`，当它发生在我身上时，我把它放在了错误的地方。您`.htaccess`需要位于Wordpress 目录的**根目录中。**你的`wp-config.php`文件在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T08:20:23.343

从您的配置文件中，我希望您在子域上使用 wordpress。所以检查以下

通配符子域-检查您是否已在您的站点中激活通配符子域在“wp-contents”目录中创建名为“blogs.dir”的目录，权限为“755”确认后重试。

# javascript - 引导模式示例

> ID：15101846
> 
> 赞同：2
> 
> 时间：2013-02-27T00:02:52.867
> 
> 标签：javascript, html, css, twitter-bootstrap

我正在使用twitter bootstrap js来实现模态.....我使用了在线示例.....将html，CSS和js代码复制到小提琴中......但我没有看到任何输出.. ..

[http://jsfiddle.net/nJ6Mw/](http://jsfiddle.net/nJ6Mw/)

```
<div class="modal hide fade">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>Modal header</h3>
  </div>
  <div class="modal-body">
    <p>One fine body…&lt;/p>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn">Close</a>
    <a href="#" class="btn btn-primary">Save changes</a>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:17:17.240

你错过了启动模态的东西。您可以添加一个链接以使用`data-target`属性中引用的模态 ID 打开它，或者将`href`目标设置为模态 div：

```
<a  role="button" class="btn" data-toggle="modal" data-target="#myModal">Launch demo modal</a> 
```

您可以使用 javascript 将 Modal div 设置为模态目标，也可以打开和关闭它。

```
<a href="#myModal" role="button" class="btn" data-toggle="modal">Launch demo modal</a>
...
$('#myModal').modal(options)  <-- check the bootstrap site for possible options values.
$('#myModal').modal('show')
$('#myModal').modal('hide') 
```

为了完成这项工作，我将 myModal 的 id 添加到您的模态 div 中：

```
<div id="myModal" class="modal hide fade"> 
```

这都是根据 Bootstrap 文档。也许仔细看看它？

这是您示例中的一个工作小提琴。我将 boostrap 的东西添加为外部资源。[http://jsfiddle.net/nJ6Mw/4/](http://jsfiddle.net/nJ6Mw/4/)

编辑：

添加该`data-dismiss="modal"`属性将使关闭按钮起作用。

```
<a href="#" class="btn" data-dismiss="modal">Close</a> 
```

# asp.net-mvc-4 - 使用 jqGrid 获取异常

> ID：15101851
> 
> 赞同：0
> 
> 时间：2013-02-27T00:03:18.833
> 
> 标签：asp.net-mvc-4, jqgrid

我正在尝试设置我的 jqGrid 以从 document.ready 上的函数获取数据。不知何故，当我这样做时，我遇到了几个小例外......我最初认为也许我的 json 数据格式错误......

```
{"total": 2,
"page": 1,
"records": 15,
"rows": [{
    "id": 2148,
    "cell": {
        "MRN": "840134833",
        "Hospital_Fin": "987141516",
        "First_Name": "YELLOW",
        "Last_Name": "CRAYON",
        "Date_of_birth": "\/Date(1253160000000)\/"          
    }
},
{
    "id": 1898,
    "cell": {
        "MRN": "785528039",
        "Hospital_Fin": "6669511596226",
        "First_Name": "RAYFIELD",
        "Last_Name": "BOYD",
        "Date_of_birth": "\/Date(-720298800000)\/"
    }
}]} 
```

但它似乎看起来正确。

我得到这个例外，例如：

```
0x800a138f - Microsoft JScript runtime error: Unable to get value of the property 'integer': object is null or undefined 
```

我在代码的以下行得到了那个异常......

```
fmt = $.jgrid.formatter.integer || {}; 
```

我设置我的网格如下

```
 $(document).ready(function () {
        jQuery("#frTable").jqGrid ({
            cmTemplate: { sortable: false },
            caption: '@TempData["POPNAME"]' + ' Population',
            datatype: 'json',
            mtype: 'GET',
            url: '@Url.Action("GetAjaxPagedGridData", "Encounters", new { popId = TempData["POPULATIONID"] })',//'/Encounters/GetAjaxPagedGridData/'+ '',                
            pager: '#pager',
            loadonce: true,
            height: 450,
            gridview: true,
            viewrecords: true,
            rowNum: 15,
            shrinkToFit: false,
            autowidth: true,
            colNames: [...],
            colModel: [
                   { name: 'MRN', width: 125, align: 'left' },
                   { name: 'Hospital_Fin', width: 145, align: 'left' },
                   { name: 'First_Name', width: 115, align: 'left' },
                   { name: 'Last_Name', width: 115, align: 'left' },
                   { name: 'Date_of_birth', width: 145, align: 'left' },] 
```

colNames 和 colModel 不重要的地方。我的智慧到此为止。这应该有效。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:39:24.113

您可能缺少所需的语言环境文件，其中定义了 $.jqgrid.formatter：

[jqGrid 文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ahow_to_install)

您需要包含 jQuery、jqGrid 插件和 jqGrid 语言环境文件之一才能使其工作，例如：

```
<script src="js/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="js/i18n/grid.locale-en.js" type="text/javascript"></script>
<script src="js/jquery.jqGrid.min.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:10:39.303

在我看来，该错误听起来像是您的视图中的对象未设置有问题。尝试设置一个静态值而不是类似的值 `TempData["POPULATIONID"]`，我认为您可能会继续前进。

# c - 保持用户环境变量执行 gksu

> ID：15101854
> 
> 赞同：2
> 
> 时间：2013-02-27T00:04:00.930
> 
> 标签：c, linux, gtk

我在 c/gtk 中有一个用 gksu 打开的程序。问题是，当我使用 getenv("HOME") 获取环境变量 $HOME 时，它显然会返回“root”。我想知道是否有办法知道谁是执行 gksu 的用户或获取他的环境变量的方法。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T04:42:02.827

请参阅手册页。用于`gksu -k command...`保护环境（特别是`PATH`和`HOME`）。

或者，就像 Lewis Richard Phillip C 指出的那样，您可以使用`gksu env PATH="$PATH" HOME="$HOME" command...`来重置命令的环境变量。（逻辑是父 shell 以用户权限运行，替换变量，并`env`在获得超级用户权限时重新设置它们。）

如果您的应用程序只能以 root 权限运行，您可以编写一个启动器脚本——就像许多其他应用程序一样。脚本本身基本上是

```
#!/bin/sh
exec gksu -k /path/to/your/application "$@" 
```

或者

```
#!/bin/sh
exec gksu env PATH="$PATH" HOME="$HOME" /path/to/your/application "$@" 
```

该脚本安装在 中`/usr/bin`，您的应用程序安装为`/usr/bin/yourapp-bin`或`/usr/lib/yourapp/yourapp`。意思是`exec`命令*替换*了shell；即`exec`命令之后的任何内容都不会被执行（除非应用程序或命令根本无法执行）——最重要的是，当您的应用程序开始执行时，内存中不会有额外的外壳。

虽然 Linux 和其他类似 POSIX 的系统确实具有*有效*身份（定义应用程序可能执行的操作）和*真实*身份（定义正在执行操作的用户）的概念，但`gksu`会修改所有身份。特别是，虽然`getuid()`返回真实用户 ID，例如 set-UID 二进制文件，但在`gksu`使用时将返回零（“root”）。

因此，上述启动脚本是解决您问题的推荐方法。这也是一种常见的；跑

```
file -L /usr/bin/* /usr/sbin/* | sed -ne '/shell/ s|:.*$||p' | xargs -r grep -lie launcher -e '^exec /' 
```

查看系统上哪些命令是（或声明自己是）启动器脚本，或者

```
file -L /bin/* /sbin/* /usr/bin/* /usr/sbin/* | sed -ne '/shell/ s|:.*$||p' | xargs -r grep -lie gksu 
```

查看哪些`gksu`明确使用。采用已知的好方法没有害处.. ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:16:17.740

您可以将这些环境变量的值分配给标准变量，然后在 gkSU 之后执行 gksu 导出变量...通过在 gkSU 之后使用 && 将您的执行绑定在一起来定义这些，以便您基本上使用克隆的环境变量执行...

一个更好的问题是为什么要这样做？我意识到你想要保留一些文件夹，但我不确定为什么作为 root 创建的任何文件都必须是全局可写的，可能使用 umask，或者你必须手动修改权限或更改所有权......就是这样一个坏主意！

请查看[https://superuser.com/questions/232231/how-do-i-make-sudo-preserve-my-environment-variables](https://superuser.com/questions/232231/how-do-i-make-sudo-preserve-my-environment-variables)，[http://www.cyberciti.biz/faq/linux-unix-shell -export-command/](http://www.cyberciti.biz/faq/linux-unix-shell-export-command/) & [https://serverfault.com/questions/62178/how-to-specify-roots-environment-variable](https://serverfault.com/questions/62178/how-to-specify-roots-environment-variable)

# mongodb - MongoDB 聚合框架：使用 $group 时出现 $unwind 错误

> ID：15101856
> 
> 赞同：0
> 
> 时间：2013-02-27T00:04:14.433
> 
> 标签：mongodb, aggregation-framework

我的文档结构如下：

```
{
  "_id" : NumberLong("80000000012"),
[...]
  "categories" : [{
      "parent" : "MANUFACTURER",
      "category" : "Chevrolet"
    }, {
      "parent" : "MISCELLANEOUS",
      "category" : "Miscellaneous"
    }],
[...]
} 
```

我正在尝试为每个“父”字段获取所有“类别”字段的不同列表。我试图利用聚合框架通过以下查询来执行此操作：

```
db.posts_temp.aggregate(
    {$unwind : '$categories'},
    {$match : {'categories.parent' : 'MISCELLANEOUS'}},
    {$project : {
        '_id' : 0,
        parent : '$categories.parent',
        category : '$categories.category'
        }
    },
    {
        $group : { 
            _id : '$parent',
            category : {$addToSet : '$category'}
        }
    }
); 
```

运行此查询会返回以下错误：

```
{
    "errmsg" : "exception: $unwind:  value at end of field path must be an array",
    "code" : 15978,
    "ok" : 0
} 
```

这似乎与查询的组部分相关，因为当我删除它时，查询会正确运行，但显然，数据不在我想要的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:39:49.473

我刚刚尝试在我的 mongo 实例上执行上述聚合查询。这是我的 3 个文档，每个文档都有一个类别键，其中包含两个嵌套文档的数组。

这是我的数据：

```
{
    "_id" : ObjectId("512d5252b748191fefbd4698"),
    "categories" : [
        {
            "parent" : "MANUFACTURER",
            "category" : "Chevrolet"
        },
        {
            "parent" : "MISCELLANEOUS",
            "category" : "Miscellaneous"
        }
    ]
}
{
    "_id" : ObjectId("512d535cb748191fefbd4699"),
    "categories" : [
        {
            "parent" : "MANUFACTURER",
            "category" : "Chevrolet"
        },
        {
            "parent" : "MISCELLANEOUS",
            "category" : "Pickup"
        }
    ]
}
{
    "_id" : ObjectId("512d536eb748191fefbd469a"),
    "categories" : [
        {
            "parent" : "MANUFACTURER",
            "category" : "Toyota"
        },
        {
            "parent" : "MISCELLANEOUS",
            "category" : "Miscellaneous"
        }
    ]
} 
```

这是我运行的您的聚合查询：

```
db.posts_temp.aggregate( {$unwind:'$categories'} , {$match: {'categories.parent':'MISCELLANEOUS'}}, {$project:{'_id':0, parent: '$categories.parent', category:'$categories.category'}}, {$group:{_id:'$parent', category:{$addToSet:'$category'}}}) 
```

结果如下：

```
{
    "result" : [
        {
            "_id" : "MISCELLANEOUS",
            "category" : [
                "Pickup",
                "Miscellaneous"
            ]
        }
    ],
    "ok" : 1
} 
```

让我知道我的数据和你的数据之间是否存在一些差异。

夏皮

# oop - 何时使用/制作伴侣对象？

> ID：15101857
> 
> 赞同：1
> 
> 时间：2013-02-27T00:04:15.177
> 
> 标签：oop, scala, styles

所以我是 Scala 的新手（并且 Java 经验几乎为零）。我*以为*我抽象地理解了 OOP，但忽略了这一点。[我的问题——与“使用伴生对象时的方法名称限定](https://stackoverflow.com/questions/12231702/method-name-qualification-when-using-a-companion-object/12231975#12231975)”类似——是关于 Scala 专业人士何时会考虑实现类伴生对象模式？

从上面提到的问题来看，尚不清楚伴生对象是否旨在存储类“内部使用”的方法（例如，发布者想要使用 ^，在对象中定义，在 / 中，在类中定义）。所以，我不想将伴生对象视为伴生类可以使用的方法的“容器”，因为这显然不是真的......

如果这是一个模糊的问题，我很抱歉：我只是想知道使用这些家伙的正确方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T00:14:29.170

伴生对象对于您在 Java 中使用静态方法的用途很有用...

一个非常常见的用途是`apply()`在伴随对象中定义一个方法，它使用户能够`MyObject(arg, arg)`使用`new MyObject(arg, arg)`.

伴随对象也是放置隐式定义等内容的好地方。

我最近一直在我的 akka 应用程序中使用伴随对象作为放置特定于主管参与者及其子级的消息案例类的地方，但我不一定希望该子系统之外的代码直接使用。

* * *

这是一个简单的例子：

```
class Complex(real:Double, imag:Double) {
    def +(that:Complex):Complex = Complex(this.real + that.real, this.imag + that.imag)
    // other useful methods
}

// the companion object
object Complex { 
    def apply(real:Double, imag:Double) = new Complex(real, imag)

    val i = Complex(0, 1)

    implicit def fromInt(i:Int) = Complex(i, 0)
} 
```

实例化新的 Complex 对象的正常 OOP 方法是`new Complex(x, i)`. 在我的同伴对象中，我定义了函数`apply`，给我们一个语法糖，让我们可以编写`Complex(x, i)`. `apply`是一个特殊的函数名，当您直接调用对象时调用它，就好像它是一个函数一样（即`Complex()`）。

我还有一个名为 的值`i`，它的计算结果为`Complex(0, 1)`，它为我提供了使用通用复数的简写`i`。

这可以在 Java 中使用静态方法来完成，例如：

```
public static Complex i() {  
    return new Complex(0, 1);
} 
```

伴随对象本质上为您提供了一个附加到您的类名的命名空间，该命名空间并不特定于您的类的特定实例。

# dart - 如何在 Dart 中为 HttpServer 注册多个处理程序？

> ID：15101858
> 
> 赞同：6
> 
> 时间：2013-02-27T00:04:17.483
> 
> 标签：dart

（我正在使用 dart:io 的新 lib v2 版本。）

我想为 HttpServer 注册多个处理程序，特别是 WebSocketTransformer 和其他任意处理程序。像这样的东西：

```
// pseudo-code

var server = HttpServer;
server.register('/foo', someHandlerFunction);        // 1
server.register('/bar', someOtherHandlerFunction);   // 2
server.register('/ws', webSocketHandler);            // 3 
```

如果 #1 匹配，则不测试 #2，依此类推。所以，很贪心。

我见过只有一个处理程序的样本。如何注册多个处理程序？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T22:08:13.287

新答案：使用路由包： http: [//pub.dartlang.org/packages/route](http://pub.dartlang.org/packages/route)

这是您使用路由`serve()`方法的示例：

```
HttpServer.bind('127.0.0.1', 8889).then((server) {
  var router = new Router(server)
    ..serve('/ws').transform(new WebSocketTransformer()).listen(handleWebSocket)
    ..serve('/foo').listen((req) {
      req.response..addString('foo')..close();
    });
}); 
```

路由器会自动捕获未处理的请求并发送 404，但很快您就可以使用`defaultStream`可以收听的内容覆盖它。

路由器还支持过滤器，可用于日志记录、身份验证、压缩等：

```
HttpServer.bind('127.0.0.1', 8889).then((server) {
  var router = new Router(server)
    ..filter(new RegExp(r'/.*'), (req) {
      //log all requests
      _logger.info("request: $req");
      return new Future.immediate(true); // keep processing request
    })
    ..filter(new Regexp(r'/secure/.*'), (req) {
      // check authentication asynchronously
      return getUserFromRequest(req).then((user) {
        if (user == null) {
          sendRedirect('/login'); // sendRedirect coming soon
          return false; // stop processing request
        } else {
          return true; // keep processing
        }
      });
    })
    ..serve(/* ... */ );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T07:18:08.577

以下是[API 文档](http://api.dartlang.org/docs/releases/latest/dart_io/WebSocketTransformer.html)建议注册 WebSocket 处理程序的方式：

```
server
    .where((request) => request.uri.path == "/ws")
    .transform(new WebSocketTransformer()).listen((webSocket) => ...); 
```

但是，服务器是单订阅流。附加a`listen`后，您将无法附加其他侦听器。

我真正想要的是查看一个事件，决定它是否可以处理它，如果可以，则将其路由到另一个流。否则，传递它。这样，事件（在本例中为 HttpRequest 对象）沿链传递，直到它被处理。

我建立了一个`TakeAndRoute`扩展类`StreamEventTransformer`。使用`TakeAndRoute`一个函数来确定它是否应该抓取事件并将其路由到另一个流，或者只是转发它。

这是我想出的：

```
import 'dart:io';
import 'dart:async';

handleWebSocket(WebSocket webSocket) {
  webSocket.listen((event) {
    if (event is MessageEvent) {
      /* Handle message. */
    } else if (event is CloseEvent) {
      /* Handle closed. */
    }
  });
}

typedef bool ShouldTake(e);
typedef void RouteTo(Stream stream);
typedef void HandleEvent(e);

class TakeAndRoute<S, T> extends StreamEventTransformer<S, T> {
  ShouldTake shouldTake;
  RouteTo routeTo;
  StreamController controller = new StreamController();
  HandleEvent handler;

  TakeAndRoute(this.shouldTake, {this.routeTo, this.handler}) {
    if (routeTo != null) routeTo(controller.stream);
  }

  handleData(event, StreamSink sink) {
    print("handling");
    if (shouldTake(event)) {
      if (routeTo != null) {
        controller.add(event);
      }
      if (handler != null) {
        handler(event);
      }
    } else {
      sink.add(event);
    }
  }
}

main() {
  HttpServer.bind('127.0.0.1', 8888)
    .then((HttpServer server) {
      server
        .transform(new TakeAndRoute<HttpRequest, HttpRequest>(
          (req) => req.uri.path == '/ws',
          routeTo: (stream) => stream.transform(new WebSocketTransformer()).listen(handleWebSocket)))
        .transform(new TakeAndRoute<HttpRequest, HttpRequest>(
          (req) => req.uri.path == '/foo',
          handler: (req) {
            print('got foo');
            req.response.addString("foo");
            req.response.close();
          }))
        .listen((req) {
          print("got 404 for ${req.uri}");
          req.response.statusCode = 404;
          req.response.close();
        });
    });
} 
```

诚然，这可能是矫枉过正。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T07:45:17.393

这是一种更手动但更短的方法：

```
 HttpServer.bind('127.0.0.1', 8889)
    .then((HttpServer server) {
      var sc = new StreamController();
      sc.stream.transform(new WebSocketTransformer()).listen(handleWebSocket);

      server.listen((HttpRequest request) {
        print("new connection from ${request.uri.scheme} ${request.uri}");

        // See https://code.google.com/p/dart/issues/detail?id=8825
        //if (request.uri.scheme == 'ws') {
        if (request.uri.path == '/ws') {
          sc.add(request);
        } else if (request.uri.path == '/foo') {
          request.response.addString('foo');
          request.response.close();
        } else {
          print("got 404 for ${request.uri}");
          request.response.statusCode = 404;
          request.response.close();
        }
      });
    }); 
```

请注意我必须如何创建一个 StreamController 以便我可以将事件泵送到`WebSocketTransformer`

# c++ - 使用 -fno-rtti 编译的共享库中的子类

> ID：15101859
> 
> 赞同：8
> 
> 时间：2013-02-27T00:04:19.150
> 
> 标签：c++, subclass, rtti

我正在尝试从使用-fno-rtti 编译的共享库中进行子类化。不幸的是，我的代码库中的其他库需要 -frtti。结果，我收到链接错误，因为超类没有 typeinfo 结构。

在正常编译中收到错误：

```
out.o: in function typeinfo for MyClass:myclass.cpp(.data.rel.ro.<cpp magic>): error: undefined reference to 'typeinfo for NetlinkListener' 
```

我想要子类化的类是 libsysutils 中的一个 android 类（剪掉一点空间）：

```
class NetlinkListener : public SocketListener {
    char mBuffer[64 * 1024];
    int mFormat;

public:
    static const int NETLINK_FORMAT_ASCII = 0;
    static const int NETLINK_FORMAT_BINARY = 1;

    NetlinkListener(int socket);
    NetlinkListener(int socket, int format);
    virtual ~NetlinkListener() {}

protected:
    virtual bool onDataAvailable(SocketClient *cli);
    virtual void onEvent(NetlinkEvent *evt) = 0;
}; 
```

我的存根看起来像：

```
class MyClass: public NetlinkListener {

public:
    MyClass();
    virtual ~MyClass();

    int start();
    int stop();

protected:
    virtual void onEvent(NetlinkEvent *evt);
}; 
```

MyClass 中的所有方法都已实现（作为空存根）

我无法编译共享库 -frtti。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T00:30:53.113

1）对于简单的情况，您可以只创建接口的 C 包装器（不使用 RTTI 构建）。然后，您可以在启用 RTTI 的程序中使用 C 接口，前提是您将它​​们视为来自启用 RTTI 的程序的抽象 C 类型。

2）使用 RTTI 编译库正是您*应该*做的（或供应商的要求），除非有很好的理由禁用 RTTI（例如，您在不应使用异常的域中工作，例如作为内核、驱动程序或其他一些无异常区域——或者内存紧张的地方）。

3) 更改您的库以不使用 dynamic_cast、异常、typeid 运算符或任何导致问题的原因，并在禁用 RTTI 的情况下重建。与 1 类似，您可以将其设为单独的抽象库，具体取决于程序的组织方式。

4a) 下一个选项是永远不要引用对象的类型信息（例如，不要 dynamic_cast 或抛出它）——这可能会很痛苦。这将删除引用类型信息的链接器错误。

4b）创建内部类可能是最简单的（假设您必须覆盖某些方法，并且您必须与依赖于 rtti 的程序接口的类型）。您可以创建一个类型 ( `inner`)，它从其 lib 的类型继承并执行必要的覆盖，然后通过其他一些类层次结构回调（其他层次结构可以自由使用 rtti）。现在`inner`该类的虚拟导出被放置在*禁用*rtti 的 TU 中（因为否则它将隐式引用其基类的类型信息）。然后，您可以轻松隔离类型信息依赖关系并构建一个使用异常之类的层次结构——该层次结构使用该`inner`类型作为值。当然，*如果*可行，则所有**实现都已定义**-- 您需要了解 RTTI 和 vtables 是如何为您的目标平台构建的（参见 ABI refs）。甚至省略 RTTI 也是与标准 C++ 的偏差。没有任何信息表明符号的存在会导致您的 vtables 的正确构造和在没有这些功能的情况下编译的基础的类型信息。

也就是说，1 和 2 是您的安全选项，3 在 no-rtti 平台扩展（安全）的范围内，4 是一种可以在没有或仅在某些系统上免费工作的方法。

**说明 4b**

```
class MyClass // << cast me. throw/catch me. get my mangled name,
              //    but put my family's virtual exports in a TU with RTTI enabled
: public MyRTTIEnabledFamily {
public:
    MyClass() : d_inner(*this) {}
    virtual ~MyClass();
private:
    void cb_onEvent(NetlinkEvent * evt) {
        // no-rtti suggests exceptions may not be available,
        // so you should be careful if your program throws.
        someInfo = evt->getInfo();
    }
private:
    // non-rtti hierarchy
    class t_inner : public NetlinkListener {
    public:
        t_inner(MyClass& pMyClass) : NetlinkListener(), d_myClass(pMyClass) {
        }

        virtual ~t_inner(); // << put your virtual exports in a TU with RTTI disabled.
                            //    one out of line virtual definition is necessary for most compilers
    private:
        virtual void onEvent(NetlinkEvent * evt) {
            // how the callback to your imp actually happens
            this->d_myClass.cb_onEvent(evt);
        }
    private:
        MyClass& d_myClass;
    };
private:
    t_inner d_inner; // << don't do anything with my type info -- it does not exist.
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T00:32:14.027

根据 gcc 的文档，传递`-fno-rtti`只会禁用`dynamic_cast`and功能。`typeid`您应该能够毫无问题地派生类并使用虚拟方法。

`undefined reference to typeinfo for class`如果您将函数声明为`virtual`未为其提供定义，则通常会出现该错误。

事实上，我看到[`NetlinkHandler.h`](https://android.googlesource.com/platform/system/netd/+/0cd9ba45680acc2f5c139d7765c135b246d65108/NetlinkHandler.h)并且[`NetlinkHandler.cpp`](https://android.googlesource.com/platform/system/netd/+/e0ebc46c0aa38ce4f35bd3b60c0fcb9204d4c35e/NetlinkHandler.cpp)在 AOSP 中所做的正是您正在尝试做的事情，我发现这些文件与您发布的代码片段之间没有任何区别。

# xml - 在xsl中的节点和子节点中将文本转换为小写

> ID：15101862
> 
> 赞同：3
> 
> 时间：2013-02-27T00:04:30.837
> 
> 标签：xml, xslt, xslt-2.0, children, lowercase

使用 xsl 2.0 我试图将所有大写文本转换为每个节点中只有第一个文本字母大写。它们是大量可能的子元素。

```
<text> text text text
<head>BLAH <unkownTag>BLAH</unkownTag> BLAH </head>
</text> 
```

我想将其转换为阅读

```
<text> text text text
<head>Blah <unkownTag>Blah</unkownTag> Blah </head>
</text> 
```

我最接近的是

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="@*|node()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>
<xsl:template match="head/text()">
    <xsl:value-of select="concat(upper-case(substring(.,1,1)),lower-case(substring(.,2)))"/>        
</xsl:template> 
```

这给了我结果

```
<text> text text text 
   <head>Blah <unkownTag>BLAH</unkownTag> blah </head>
</text> 
```

如何在 head 的所有子节点中进行小写转换？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T03:24:59.570

**无论分隔单词的标点符号如何，这种转换都会产生想要的结果：**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="head//text()">
  <xsl:analyze-string select="." regex="\p{{L}}+">
   <xsl:matching-substring>
     <xsl:value-of select=
      "concat(upper-case(substring(.,1,1)), lower-case(substring(.,2)))"/>
   </xsl:matching-substring>
   <xsl:non-matching-substring>
    <xsl:value-of select="."/>
   </xsl:non-matching-substring>
  </xsl:analyze-string>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<text> text text text
 <head>BLAH <unkownTag>BLAH</unkownTag> BLAH </head>
</text> 
```

**产生了想要的正确结果：**

```
<text> text text text
 <head>Blah <unkownTag>Blah</unkownTag> Blah </head>
</text> 
```

**应用于此 XML 文档时：**

```
<text> text text text
 <head>BLAH$<unkownTag>BLAH</unkownTag>-BLAH;</head>
</text> 
```

**再次产生正确的结果：**

```
<text> text text text
 <head>Blah$<unkownTag>Blah</unkownTag>-Blah;</head>
</text> 
```

**说明**：

1.  正确使用[**`<xsl:analyze-string>`**](http://www.w3.org/TR/xslt20/#analyze-string)指令。

2.  正确使用[**`\p{L}`**](http://www.w3.org/TR/xmlschema-2/#charcter-classes)字符类。

3.  正确使用[**`<xsl:matching-substring>`**](http://www.w3.org/TR/xslt20/#element-matching-substring)和[**`<xsl:non-matching-substring>`**](http://www.w3.org/TR/xslt20/#element-non-matching-substring)说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T02:15:38.887

您文本中的空格使这是一个有趣的问题。要匹配 'head' 下的所有 text() 节点，请使用 XPath 表达式查看祖先。

在这里，我对字符串进行标记，然后循环遍历结果集，将第一个字符更改为大写，将后面的字符更改为小写。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:template match="@*|node()">
       <xsl:copy>
           <xsl:apply-templates select="@*|node()"/>
       </xsl:copy>
   </xsl:template>

   <xsl:template match="text()[ ancestor::head ]">
       <xsl:value-of select="
            for $str in tokenize( ., '\s' ) 
            return concat( upper-case(substring($str,1,1)), 
                           lower-case(substring($str,2)) )"/>
   </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T01:09:48.413

尝试这个。我还没有测试它，你可能需要稍微调整一下。

```
<xsl:template match="@*|node()">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="head">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()">
      <xsl:value-of select="concat(upper-case(substring(.,1,1)),lower-case(substring(.,2)))"/>
    </xsl:apply-templates>
  </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T01:31:21.310

这可能会帮助您参与其中。

```
<xsl:template match="/">
  <xsl:apply-templates select="node()" mode="firstup"/>
</xsl:template>

<xsl:template match="text()" mode="firstup">
  <!--<x>-->
    <xsl:value-of select="concat(upper-case(substring(.,1,1)),lower-case(substring(.,2)))"/>
  <!--</x>-->
</xsl:template> 
```

虽然不确定第三个“BLAH”，但这个 text() 节点以空格开头，因此在使兄弟文本节点大写正确时会增加一些难度。取消注释“x”元素以查看此内容。您可能还想查看规范化空间和 position() 函数以进一步了解。

# php - 将使用 header("Location: target"); 避免执行文档中的其余代码

> ID：15101867
> 
> 赞同：1
> 
> 时间：2013-02-27T00:05:24.363
> 
> 标签：php, header

通过使用这个：

```
$size = ob_get_length();    
header("Content-Length: $size"); 
header('Connection: close');    
ob_end_flush(); 
ob_flush(); 
flush(); 
```

随着`ignore_user_abort(true);`我通过 ajax 调用接收一个完整的状态，并让文件处理服务器端，而用户不必等待对要解析的文件内容的响应。

我想实现相同但使用 a`header("Location: target");`而不是`header('Connection: close');`- 所以看起来一切都已完成，但文件在触发后继续解析`header("Location: target");`

让文件继续工作但使用 PHP 重定向用户的正确方法是什么。

顺便说一句，在连续五次投票之前，这个问题不是[PHP Redirect User and Continue Process Script](https://stackoverflow.com/questions/11818702/php-redirect-user-and-continue-process-script)的重复，尽管标题似乎类似于这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:08:48.633

> 让文件继续工作但使用 PHP 重定向用户的正确方法是什么？

您正在描述立即退出的并行处理，您必须在 PHP 中对其进行修改：

1.  打开父 PHP 页面
2.  为另一个 php 文件的功能生成一个新线程（在 PHP 中，线程不存在，因此您必须使用 curl 或其他一些执行它的方法）
3.  重定向
4.  出口（）

如果您正在触发一个您不关心响应的 ajax 请求，请以相同的方式考虑第二步。它将与您的父页面并行完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:54:56.413

不，它不会停止执行，但您可以使用 exit 调用手动停止执行

# python - 如何测试打包为可重用应用程序的 Django-CMS 插件

> ID：15101870
> 
> 赞同：4
> 
> 时间：2013-02-27T00:05:57.247
> 
> 标签：python, django, unit-testing, pip, django-cms

我已经按照[Django 文档](https://docs.djangoproject.com/en/dev/intro/reusable-apps/)中的程序使一些 Django-CMS 插件可重用，并按照[Hitchhiker 的打包指南](http://guide.python-distribute.org/quickstart.html)将它们放在 pypi 上，因此它们可以通过

```
pip install cmsplugin-rt 
```

这会将它们安装在 python 可以找到它们的合理位置。当然，我在其他地方有我的开发目录。

但是当我向这个包添加一些测试时，我得到了错误：

```
django.core.exceptions.ImproperlyConfigured: App with label cmsplugin_rt could not be found 
```

需要更多的解释。由于该包不是 Django 项目的一部分，即没有`manage.py`用于运行测试的文件，因此我按照[stackoverflow](https://stackoverflow.com/questions/3841725/how-to-launch-tests-for-django-reusable-app)的建议并将其添加`runtests.py`到`tests`目录中。特别是在这个文件中，我放了：

```
import os, sys
from django.conf import settings

DIRNAME = os.path.dirname(__file__)
settings.configure(DEBUG=True,
    DATABASES={
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
         }
     },
    CMS_TEMPLATES = ( ('template_for_tests.html', 'Test template'), ),
    CMS_MODERATOR = False,
    CMS_PERMISSION = False,
    TEMPLATE_CONTEXT_PROCESSORS = (
        'django.contrib.auth.context_processors.auth',
        'django.core.context_processors.i18n',
        'django.core.context_processors.request',
        'django.core.context_processors.media',
        'django.core.context_processors.static',
        'cms.context_processors.media',
        'sekizai.context_processors.sekizai',
    ),
    INSTALLED_APPS = (
        'cmsplugin_rt.button',
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.admin',
        'django.contrib.sites',
        'django.contrib.messages',
        'django.contrib.staticfiles',
        'south',
        'cms',
        'mptt',
        'menus',
        'sekizai',
    ),
)

from django.test.simple import DjangoTestSuiteRunner
test_runner = DjangoTestSuiteRunner(verbosity=2)
failures = test_runner.run_tests(['cmsplugin_rt', ])
if failures:
    sys.exit(failures) 
```

所以，正如我所提到的，当我执行时，`python runtests.py`我得到了错误：

```
django.core.exceptions.ImproperlyConfigured: App with label cmsplugin_rt could not be found 
```

我哪里错了？还是有更好的方法来做到这一点？我很想在那里做一些测试！

谢谢！

`pip uninstall cmsplugin-rt`（如果这确实运行了，测试会使用我的包的开发版本运行，还是会从 pip 安装中提取版本？每次运行之前我需要吗？）

这是我的目录结构 - 我在一个包中有几个插件，这可能是问题的一部分。我把`tests`你看到的目录放在这里，虽然我也尝试过上一级。

```
cmsplugin-rt/
--README.txt
--LICENSE.txt
--MANIFEST.in
--setup.py
--cmsplugin_rt/
----__init__.py
----models.py
----button/
------__init__.py
------models.py
------cms_plugins.py
------templates/
----(other plugins)/
----tests/
------runtests.py
------mytests.py 
```

为了安全起见，我还在`models.py`顶层放了一个空（按照[这里](https://stackoverflow.com/questions/6483636/how-to-test-django-application-placed-in-subfolder)的建议），但我不确定它有什么不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T01:35:28.220

对于后代，这是我在第一条评论中提到的南方移民问题的解决方法。它不是很漂亮，所以我很乐意提供有关如何改进它的任何建议。

向`cmsplugin_rt.button`模型中添加新字段的过程是：

1.  在进行任何编辑之前，复制`site-packages/cmsplugin_rt/button`到一个虚拟的 Django-CMS 项目中，作为一个名为的应用程序`button`
2.  删除这个新应用的`button/migrations/`目录
3.  添加`button`到虚拟项目`settings.py`的 INSTALLED_APPS
4.  运行`./manage.py schemamigration --init button`，因此虚拟项目对数据库的理解与当前模型保持一致（在进行任何更改之前）
5.  运行`./manage.py migrate button`，更新虚拟项目的数据库
6.  编辑`model.py`虚拟项目中的按钮文件以添加额外字段，并进行所需的任何其他更改。
7.  运行`./manage.py schemamigration --auto button`，生成迁移代码。这将在`button/migrations/0002_auto__...`
8.  该文件是您需要放入包中的文件，但如果插件最初包含的不仅仅是`0001_initial.py`迁移文件，则前面的编号会错误。使用正确的编号将其复制到您的包开发目录中。同时复制您所做的任何模型、cms_plugin、模板和其他更改。

# javascript - javascript动画有时有效

> ID：15101883
> 
> 赞同：0
> 
> 时间：2013-02-27T00:07:58.300
> 
> 标签：javascript, animation, setinterval

我试图在不使用 jquery.animation 的情况下让 pacman 移动，因为我想要更多的控制权。所以我使用 setInterval，但它有时只有效。如果你刷新足够多，它最终会“点击”并正常工作，但如果你再次刷新，它就不起作用了，这里[http://pacman.townsendwebdd.com](http://pacman.townsendwebdd.com)如果你想看的话，谢谢

```
//earlier in the code
this.moveInterval = setInterval(_this.move, 40, _this);

move: function(_this)
{
    if(_this.pause)//set to true for now
        return false;

    var horz = 0;
    var vert = 0;

    var dir = _this.dir;

    //set horizontal and vertical directions
    if(dir % 2 == 0)
        horz = dir - 1;
    else
        vert = dir - 2;

    _this.top += vert;
    _this.left += horz;

    $('#pacman').css('top', _this.top);
    $('#pacman').css('left', _this.left);
}, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:55:49.660

我不确定这是否能解决问题，但我建议使用[请求动画帧](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)而不是 setInterval。

我认为问题的另一件事（我也被这个问题刺痛了）是您可能试图在页面完全加载之前启动动画。尝试将您的代码放入一个函数并使用[body 标签的 onload 属性](http://www.w3schools.com/jsref/event_body_onload.asp)调用它。

祝你好运！

格里福克。

# matlab - Matlab中的散点图

> ID：15101885
> 
> 赞同：1
> 
> 时间：2013-02-27T00:08:06.830
> 
> 标签：matlab, matrix, scatter

我有一组数据：

```
A = [2/3 -1/3 -1/3 ; -1/3 2/3 -1/3 ; -1/3 -1/3 2/3]
B = [ 0 0 0 ]
C = [ 0 0 1 ]'
D = [ 0 1 0 ]'
p00 =A*B-A*B
p01 =A*B-A*C
p02 = A*B-A*D 
```

等等...

我需要做一个和`poo`的散点图。`po1``po2`

在 matlab 中说明我用于散点图的 m 文件是`Too many input arguments`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:55:20.100

如果变量是 x,y,z 坐标向量，请尝试：

```
scatter3(p00, p01, p02) 
```

# c++ - 在 C++ 中遍历地图的一部分

> ID：15101888
> 
> 赞同：1
> 
> 时间：2013-02-27T00:08:26.727
> 
> 标签：c++

如何在 C++ 中仅遍历地图的一部分？我的最终目标是让多个线程遍历它们所在的地图部分并计算一些值。地图的类型是`std::map<std::string, std::vector<double> >`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:26:44.540

这是在 C++11 中执行此操作的一种简单方法：

```
#include <map>
#include <string>
#include <vector>
#include <algorithm>
#include <future>
#include <iostream>

typedef std::map<std::string, std::vector<double>> map_type;

void do_work(map_type::iterator b, map_type::iterator e)
{
    std::for_each(b, e, [] (map_type::value_type const& p) 
    {
        std::for_each(p.second.begin(), p.second.end(), [] (double d) 
        {
            /* Process an element of the vector... */
        });
    });
}

int main()
{
    map_type m;

    size_t s = m.size();
    int quarter = s / 4;
    auto i1 = m.begin();
    auto i2 = std::next(i1, quarter);
    auto i3 = std::next(i2, quarter);
    auto i4 = std::next(i3, quarter);
    auto i5 = m.end();

    std::vector<std::future<void>> futures;
    futures.push_back(std::async(do_work, i1, i2));
    futures.push_back(std::async(do_work, i2, i3));
    futures.push_back(std::async(do_work, i3, i4));
    futures.push_back(std::async(do_work, i4, i5));

    for (auto& f : futures) { f.wait(); }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:22:43.887

如果您想按数字平均分配工作，那么 map 可能不是最好的数据结构。您需要遍历地图并找到特定位置的迭代器。如果您使用像 std::vector 这样提供随机访问迭代器的容器，那么您可以算术计算迭代器。如果您想按字母顺序执行此操作，则可以执行以下操作：

```
typedef std::map<std::string,std::vector<double>> data;

void process( data::iterator beg, data::iterator end );
data dt;
{
   auto task1 = std::async( process, dt.begin(), dt.lower_bound( "n" ) );
   auto task2 = std::async( process, dt.lower_bound( "n" ), dt.end() );
} 
```

假设所有字符串都是小写的。

# c# - 听到来自麦克风的传入音频

> ID：15101889
> 
> 赞同：2
> 
> 时间：2013-02-27T00:08:36.230
> 
> 标签：c#, sockets, network-programming, naudio

我只想听听我使用 NAudio 对麦克风说的话，这是我目前的代码，但问题是我什么也听不见。任何帮助，将不胜感激。

```
public partial class frmMain : Form
    {
        private WaveIn waveIn; // Gets an audio from microphone
        private WaveOut waveOut; // Sends audio to speaker
        private BufferedWaveProvider waveProvider; // Gets an audio from stream

        public frmMain()
        {
            InitializeComponent();
        }

        private void frmMain_Load(object sender, EventArgs e)
        {
            waveOut = new WaveOut();
            waveIn = new WaveIn();
            waveProvider = new BufferedWaveProvider(waveIn.WaveFormat);

            waveOut.Init(waveProvider);             

            waveIn.DataAvailable += waveIn_DataAvailable;

            waveOut.Play();            
        }

        private void waveIn_DataAvailable(object sender, WaveInEventArgs e)
        {
            waveProvider.Read(e.Buffer, 0, e.BytesRecorded);
        }

        private void btnStop_Click(object sender, EventArgs e)
        {
            waveIn.StopRecording();
            waveIn.Dispose();
        }

        private void btnStart_Click(object sender, EventArgs e)
        {
            waveIn.StartRecording();
        }
    } 
```

我将在网络编程中使用这种场景，在该场景中，我将数据从麦克风发送到套接字，然后在客户端，BufferedWaveProvider 将读取数据，然后将其发送到扬声器。如果有什么更好的方法，请发表一些评论。

TIA

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-27T03:52:36.747

承诺的示例代码。代码用于具有两个按钮（名为 StartBtn 和 StopBtn）的表单。

```
public partial class Form1 : Form
{
    private WaveIn waveIn = null;
    private BufferedWaveProvider waveProvider = null;
    private WaveOut waveOut = null;

    public Form1()
    {
        InitializeComponent();
    }

    private void StartBtn_Click(object sender, EventArgs e)
    {
        if (waveIn != null)
            return;

        // create wave input from mic
        waveIn = new WaveIn(this.Handle);
        waveIn.BufferMilliseconds = 25;
        waveIn.RecordingStopped += waveIn_RecordingStopped;
        waveIn.DataAvailable += waveIn_DataAvailable;

        // create wave provider
        waveProvider = new BufferedWaveProvider(waveIn.WaveFormat);

        // create wave output to speakers
        waveOut = new WaveOut();
        waveOut.DesiredLatency = 100;
        waveOut.Init(waveProvider);
        waveOut.PlaybackStopped += wavePlayer_PlaybackStopped;

        // start recording and playback
        waveIn.StartRecording();
        waveOut.Play();
    }

    void waveIn_DataAvailable(object sender, WaveInEventArgs e)
    {
        // add received data to waveProvider buffer
        if (waveProvider != null)
            waveProvider.AddSamples(e.Buffer, 0, e.BytesRecorded);
    }

    private void StopBtn_Click(object sender, EventArgs e)
    {
        if (waveIn != null)
            waveIn.StopRecording();
    }

    void waveIn_RecordingStopped(object sender, StoppedEventArgs e)
    {
        // stop playback
        if (waveOut != null)
            waveOut.Stop();

        // dispose of wave input
        if (waveIn != null)
        {
            waveIn.Dispose();
            waveIn = null;
        }

        // drop wave provider
        waveProvider = null;
    }

    void wavePlayer_PlaybackStopped(object sender, StoppedEventArgs e)
    {
        // stop recording
        if (waveIn != null)
            waveIn.StopRecording();

        // dispose of wave output
        if (waveOut != null)
        {
            waveOut.Dispose();
            waveOut = null;
        }
    }
} 
```

请特别注意`waveIn.BufferMilliseconds`和`waveOut.DesiredLatency`设置以减少延迟时间。

为了压缩网络传输的数据，我建议使用不同的库来处理数据块。您可能需要调整该`BufferMilliseconds`值以减少开销并获得更好的压缩比。

[Opus Codec](http://opus-codec.org/)看起来是一个合理的选择，Opus.NET [for](https://github.com/JohnACarruthers/Opus.NET) C#。

# ruby-on-rails - 为 Rails 应用程序设置 logrotate

> ID：15101894
> 
> 赞同：0
> 
> 时间：2013-02-27T00:08:58.903
> 
> 标签：ruby-on-rails, linux, bash, cron, logrotate

几天来，我一直在网上搜索如何设置我的服务器以自动轮换我的团队最近发布的 Rails 应用程序的日志。我已经让自己能够跑步`sudo logrotate -f /etc/logrotate.conf`了，但是当然，谁愿意一直这样做呢？

应用程序日志的配置文件的内容（我想添加更多，但当我还不能旋转一个文件时，我认为不需要）：

```
/path/to/app/production.log {
  daily
  missingok
  rotate 7
  compress
  delaycompress
  notifempty
  copytruncate
} 
```

我已经验证该`/etc/logrotate.conf`文件包含这一行：

```
include /etc/logrotate.d 
```

但这是我不太确定去哪里的部分。我发现了许多不同的方法来实际自动化该过程，但似乎都没有奏效。作为记录，我已验证服务器已`anacron`安装命令，但我不知道如何为我自己的任何进程配置它。此外，root 在服务器上还没有 crontab（我们不需要它），我不确定这是否比`/etc/crontab`. 在`/etc/crontab`文件中，我添加了：

```
15 0 * * *   root    cd / && run-parts --report /etc/cron.daily 
```

但我见过其他人使用

```
15 0 * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily ) 
```

后者是更好的选择吗？为什么？如果是这样，我如何确保它有效？同样，我不知道如何为手头的任务设置 anacron。

最后，这里是`/etc/cron.daily/logrotate`文件之前的内容：

```
/usr/sbin/logrotate /etc/logrotate.conf >/dev/null 2>&1
EXITVALUE=$?
if [ $EXITVALUE != 0 ]; then
  /usr/bin/logger -t logrotate "ALERT exited abnormally with [$EXITVALUE]"
fi
exit 0 
```

经过一些研究，我用这个替换了它（我理解得更好）：

```
test -x /usr/sbin/logrotate || exit 0
/usr/sbin/logrotate /etc/logrotate.conf 
```

有人可以向我解释第一个配置在做什么，这两个选项中哪个更好？我不确定为什么我必须强制这个过程才能让它运行。也许`/etc/crontab`不像我想的那样工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:54:25.003

尝试将其放入 /etc/crontab 文件中： -*/15 * * * * root test -x /usr/lib/cron/run-crons && /usr/lib/cron/run-crons >/dev/null 2> &1

这个对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:46:27.540

> 后者是更好的选择吗？为什么？

使用您的 cron 命令，`/etc/cron.daily/*`仅当计算机在午夜 (00:15) 开启时才会运行。如果你像某些人那样在晚上关掉它，它就永远不会运行。

解决这个问题，当计算机在当天晚些时候启动时运行命令，可以使用 anacron。这对于服务器而言显然不如台式机有用。

当然，您不想同时使用两者，因为那样会每天运行两次作业。因此，最脆弱的机制 cron 将通过仅在未安装 anacron 的情况下运行作业来屈服于 anacron。

这就是 Debian 和 Ubuntu 默认使用它们的`test -x /usr/sbin/anacron ||`crontab 作业前缀所做的。

所有服务器发行版都将正确设置 logrotate，因此您不应修改 crontab、anacrontab 或`/etc/cron.daily/logrotate`. 您唯一应该做的就是将文件添加到`/etc/logrotate.d`.

# http-headers - css文件没有被缓存

> ID：15101900
> 
> 赞同：1
> 
> 时间：2013-02-27T00:09:28.723
> 
> 标签：http-headers, browser-cache, cache-control, etag

我们使用 IBM HTTP 服务器作为我们的 Web 服务器。每当向主页发送请求时，浏览器都会缓存除 CSS 之外的所有静态文件，例如 js 或图像。

为什么要缓存同样是静态但不是 CSS 的 JS 文件？

**下面是 CSS 的请求和响应标头**：

```
Status Code:200 OK

**Request Headersview**

Accept:text/css,*/*;q=0.1
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Cache-Control:max-age=0
DNT:1
If-Modified-Since:Thu, 14 Feb 2013 20:38:02 GMT
If-None-Match:"6b01-4d5b53c299e80"
Proxy-Connection:keep-alive
User-Agent:Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.3 Safari/537.31

**Response Headersview**

Accept-Ranges:bytes
Age:0
Cache-Control:max-age=172800
Connection:Keep-Alive
Content-Encoding:gzip
Content-Length:5831
Content-Type:text/css
Date:Tue, 26 Feb 2013 23:50:59 GMT
ETag:"6b01-4d5b53c299e80"
Expires:Thu, 28 Feb 2013 23:50:59 GMT
Last-Modified:Thu, 14 Feb 2013 20:38:02 GMT
Proxy-Connection:Keep-Alive
Server:IBM_HTTP_Server
Vary:Accept-Encoding,User-Agent
Via:1.1 localhost.localdomain 
```

**这些是返回 304 的 JS 文件的标头**：

```
**Request Headersview**

Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Cache-Control:max-age=0
DNT:1
If-Modified-Since:Thu, 14 Feb 2013 20:38:10 GMT
If-None-Match:"7bcc-4d5b53ca3b080"
Proxy-Connection:keep-alive
User-Agent:Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.3 Safari/537.31

**Response Headersview**

Cache-Control:max-age=172800
Connection:Keep-Alive
Date:Tue, 26 Feb 2013 23:50:58 GMT
Etag:"7bcc-4d5b53ca3b080"
Expires:Thu, 28 Feb 2013 23:50:59 GMT
Proxy-Connection:Keep-Alive
Vary:Accept-Encoding,User-Agent
Via:1.1 localhost.localdomain 
```

# entity-framework - 如何让实体框架在单元测试项目中读取我的 app.config 文件

> ID：15101901
> 
> 赞同：1
> 
> 时间：2013-02-27T00:09:32.143
> 
> 标签：entity-framework

我正在尝试为我的实体框架测试创建一个数据库，但我无法让它正确读取我的配置文件。我`app.config`在测试项目中的文件如下所示：

```
<configuration>
  <configSections>
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
  </configSections>
  <connectionStrings>
    <add name="TestConnection"
         connectionString= "Data Source=(LocalDb)\v11.0;
                            Initial Catalog=LocabalTestDB;
                            Integrated Security=SSPI;
                            MultipleActiveResultSets=true"
         providerName="System.Data.SqlClient" />
  </connectionStrings>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework>
  ....
</configuration> 
```

但是，它不是创建一个名为 的数据库`LocabalTestDB`，而是创建一个名为 的数据库`Locabal.Model.LocabalSqlContext`，连接字符串如下所示：

> “数据源=（localdb）\v11.0；初始目录=Local.Model.LocalSqlContext；集成安全=True；MultipleActiveResultSets=True；应用程序名称=EntityFrameworkMUE”

这就是数据库创建/种子代码的样子（它在我运行任何测试之前运行一次）：

```
 [AssemblyInitialize]
    public static void Init(TestContext c)
    {
        Database.SetInitializer<LocabalSqlContext>(null);

        using (var db = new LocabalSqlContext())
        {
            if (!db.Database.Exists())
            {
                db.Database.Create();
                Locabal.Model.Migrations.Configuration.SeedData(db);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T21:23:21.240

从这篇[MSDN 文章中](http://blogs.msdn.com/b/adonet/archive/2010/12/06/ef-feature-ctp5-code-first-walkthrough.aspx)，您必须将连接字符串中的名称设置为您的名称`DbContext`，然后“初始目录”参数将是您的数据库名称。例如：

```
 <connectionStrings>
    <add name="LocabalSqlContext"
         connectionString= "Data Source=(LocalDb)\v11.0;
                            Initial Catalog=LocabalTestDB;
                            Integrated Security=SSPI;
                            MultipleActiveResultSets=true"
         providerName="System.Data.SqlClient" />
  </connectionStrings> 
```

然后你可以像这样设置你的测试类：

```
public class TestDBSeeder : DropCreateDatabaseIfModelChanges<LocabalSqlContext>
{
    protected override void Seed(LocabalSqlContext context)
    {
        Locabal.Model.Migrations.Configuration.SeedData(context);
        base.Seed(context);
    }
}

[TestClass]
public class LocabalSqlContextIntegrationBaseTest
{
    protected TransactionScope Transaction { get; set; }

    [AssemblyInitialize]
    public static void Init(TestContext c)
    {
        Database.SetInitializer<LocabalSqlContext>(new TestDBSeeder());

        if (!Database.Exists("LocabalSqlContext"))
        {
            using (var db = new LocabalSqlContext())
            {
                db.Database.Initialize(true);
            }
        }
    }

    [TestInitialize]
    public virtual void StartDbTransaction()
    {
        Transaction = new TransactionScope();
    }

    [TestCleanup]
    public virtual void EndDbTransaction()
    {
        Transaction.Dispose();
    }
} 
```

# database - 使用带有restler API的通用数据库类

> ID：15101905
> 
> 赞同：0
> 
> 时间：2013-02-27T00:09:57.540
> 
> 标签：database, restler

我从 crud 示例中复制了 DB/PDO/MySQL.php 并将该目录结构放在我的 API 目录之一中（并进行了更改以用于我的数据库）。

API 结构是 myapi/artists（所以数据库的东西是 myapi/artists/DB/PDO/MySQL.php），我有 index.php 和 Artists.php 以及 Artists API 类。

所以现在我调用 $this->dp = new DB_PDO_MySQL(); 在艺术家课上，这很有效。

但是我希望能够在多个 API 类中使用一些常见的 db 函数，并且除非它位于每个 API 目录中，否则无法让 db 工作正常。

我尝试将 myapi/DB/PDO/mysql.php 放在供应商目录下并编辑 AutoLoader.php 为“myapi\DB\PDO”添加别名，但这没有用。

所以，问题是，我该如何配置才能共享一些通用的数据库代码？

假设我将在 myapi 目录下有多个 API 子目录（并且 myapi 与示例目录处于同一级别）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T02:38:34.603

将 MySQL.php 文件保存在文件`vendor/DB/PDO`夹中。然后你不必编辑 AutoLoader.php

# css - 自动列

> ID：15101906
> 
> 赞同：0
> 
> 时间：2013-02-27T00:10:05.137
> 
> 标签：css

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:42:38.747

No. With [css columns](http://www.w3.org/TR/css3-multicol/#the-number-and-width-of-columns), you can set either the column width or the number of columns. There's no 'auto detect width' option.

I usually go for width in `em` and let the number of columns depend on the client's browser window width.

# angularjs - 如果放置在 ng-include 包含的文件中，ng-show / ng-hide 将停止工作

> ID：15101911
> 
> 赞同：3
> 
> 时间：2013-02-27T00:11:08.207
> 
> 标签：angularjs

`ng-include`我观察到，当我在指令中包含一个模板时`ng-show`，`ng-hide`它似乎不起作用。

***注意**：在 angularjs`1.0.4`和`1.0.5`*

* * *

## 这个作品

### `template.html`

```
<table ng-init="changeable = null">
  <tr ng-repeat="(key, item) in items" ng-click="changeable = key">
    <td>
      <span ng-show="changeable != key">{{item.name}}</span>
      <input ng-hide="changeable != key" ng-model="item.name">
    </td>
    <td>
      <button ng-click="changeable = null">OK</button>
    </td>
  </tr>
</table> 
```

* * *

## 这不起作用

### `template.html`

```
<div ng-include src="'/changeable_table.html'"></div> 
```

### `changeable_table.html`

```
<table ng-init="changeable = null">
  <tr ng-repeat="(key, item) in items" ng-click="changeable = key">
    <td>
      <span ng-show="changeable != key">{{item.name}}</span>
      <input ng-hide="changeable != key" ng-model="item.name">
    </td>
    <td>
      <button ng-click="changeable = null">OK</button>
    </td>
  </tr>
</table> 
```

* * *

## 更新

过了一会儿[github@pkozlowski-opensource](https://github.com/angular/angular.js/issues/2077#issuecomment-14226676)给我一个 wiki 的链接，它很好地解释了为什么需要这个命名空间，它[是作用域原型继承的细微差别](https://github.com/angular/angular.js/wiki/The-Nuances-of-Scope-Prototypal-Inheritance)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T01:07:22.500

你有两个问题：

1.  不要忘记`ng-repeat`为每个条目创建一个新范围以及您执行此操作的方式，该`changeable`属性不会在所有这些范围之间共享。正确定义您的模型（示例）：

    ```
    <table ng-init="model = {}; model.changeable = null"> 
    ```

    并将所有引用更改`changeable`为`model.changeable`。

2.  on tr将`ng-click`覆盖`ng-click`on 按钮（当您单击按钮时，您也会单击 tr）。将 tr 移动`ng-click`到跨度：

    ```
    <span ng-show="model.changeable != key" ng-click="model.changeable = key">{{item.name}}</span> 
    ```

**plunker：** [http ://plnkr.co/edit/TTAUsPhqSq2rkF47EtNL?p=preview](http://plnkr.co/edit/TTAUsPhqSq2rkF47EtNL?p=preview)

# c# - 如何将日期对象添加到 C# 列表？

> ID：15101915
> 
> 赞同：2
> 
> 时间：2013-02-27T00:12:07.067
> 
> 标签：c#

早些时候我发布了[排序日期和时间](https://stackoverflow.com/q/15100233/146622)的问题。*mipe34*回答了它，但我一直试图在我的代码中使用该解决方案。

这是我到目前为止所做的。我创建了一个类，如下所示：

```
public class Meals
{
    public DateTime Start { get; set; }
    public DateTime End { get; set; }
} 
```

在我的主类中，我有以下具有日期对值的方法：

```
 IList<DateTime> starts = new List<DateTime>();
            IList<DateTime> ends = new List<DateTime>();
            DateTime breakStart1 = new DateTime(2012, 02, 15, 12, 30, 00);  // 15/02/12 12.30PM
            DateTime breakEnd1 = new DateTime(2012, 02, 15, 13, 30, 00);  // 15/02/12 01.30PM
            DateTime breakStart2 = new DateTime(2012, 02, 15, 11, 00, 00);  // 15/02/12 11.00AM
            DateTime breakEnd2 = new DateTime(2012, 02, 15, 12, 00, 00);  // 15/02/12 12.00PM
            DateTime breakStart3 = new DateTime(2012, 02, 15, 12, 00, 00);  // 15/02/12 12.00PM
            DateTime breakEnd3 = new DateTime(2012, 02, 15, 01, 00, 00);  // 15/02/12 01.00PM
            starts.Add(breakStart1);
            starts.Add(breakStart2);
            starts.Add(breakStart3);
            ends.Add(breakEnd1);
            ends.Add(breakEnd2);
            ends.Add(breakEnd3);
            for (int i = 0; i < starts.Count; i++)
            {
                var breaks = new List<Break>()

             {
                 //for (int j= 0; j<starts.Count; j++)
                 //{
                 new Break()
                     {
                         MealStart = starts[i],
                         MealEnd = ends[i]

                     }
                // }
             };

                var ordered = breaks.OrderBy(s => s.MealStart);
                foreach (var ord in ordered)
                {
                    System.Console.WriteLine(ord.MealStart);
                    System.Console.WriteLine(ord.MealEnd);
                }
            } 
```

我怎样才能传递我所有的日期对并使用他的解决方案？它不会带回预期值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:36:58.327

首先创建对象并将它们添加到列表中。在这种情况下，您可以使用集合初始化程序。

```
var mealList = new List<Meals>
{
     new Meals { Start = dtmealStart1, End = dtmealStart1 },
     /* Repeat for the rest of them possibly incorporating some kind of loop to generate this list */
};

//and then get your sorted list
var sortedMealList = mealList.OrderBy(m => m.Start); 
```

# mysql - 分块上传mysql数据库

> ID：15101917
> 
> 赞同：0
> 
> 时间：2013-02-27T00:12:22.673
> 
> 标签：mysql, phpmyadmin

我正在尝试将 32mb MYSQL 数据库上传到预先存在的数据库中，但我的共享主机上的 php 管理员有 10mb 的限制...我尝试将其压缩 - 但是当服务器解压缩数据库时，未压缩的文件是太大，服务器无法处理。

是否可以拆分数据库并通过将其粘贴为 SQL 查询的部分来上传它 - 我假设我需要每个块在它的开头都有一些东西，上面写着

“将此数据导入数据库中预先存在的表中”

这会是什么？

目前有几百行说“CREATE”和“INSERT INTO”之类的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:23:09.810

您可以尝试使用 mysql 工作台或命令行工具远程连接到数据库`mysql`。如果你能做到这一点，你可以运行：

```
source c:/path/to/your/file.sql 
```

并且您不会受到 phpmyadmin 的上传大小限制。我见过的大多数共享主机都允许它。如果没有，您可能只需要在 phpmyadmin （或任何界面）中授予 user@host 权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:18:39.600

创建的转储文件`mysqldump`只是一组将重建您的表的 SQL 语句。

要将其加载到块中，我建议将其转储到一组表中并逐个加载它们，或者如果需要，转储文件应大致采用相同的（伪）格式：

```
Set things up ready for loading

CREATE TABLE t1;
INSERT INTO TABLE t1...;
INSERT INTO TABLE t1...;

CREATE TABLE t2;
INSERT INTO TABLE t2...;
INSERT INTO TABLE t2...;

Finalise stuff after loading 
```

您可以通过将命令保留在开始和结束时手动拆分文件，并通过查找它们的`CREATE TABLE`语句来为各个表选择块。

# java - 如何检测谁将注册表单发送到操作？

> ID：15101918
> 
> 赞同：-1
> 
> 时间：2013-02-27T00:12:38.923
> 
> 标签：java, jsp, struts2

我有两种不同的表单来注册用户和一个操作，表单 1 由 A 类型的用户使用，表单 2 由 B 类型的用户使用。因此，当他们获得索引时，他们将根据自己的类型选择表单，所以我这样做没有任何选项来确定它们的类型，唯一的方法是接收请求并找出哪个表单已将请求发送到操作。

我需要一些关于如何找出将请求发送到操作的表单的提示。

用户A的jsp文件

```
<s:form name="form1" action="register">
   .... registration form for User A .....
</s:form> 
```

UserB的jsp文件

```
<s:form name="form2" action="register">
 .... Registration form for User B .......
</s:form> 
```

*   请注意表格不同

行动

```
public String Register() {

  if (request is from form1)
  { 
        .....
  }
  if (request is from form2)
  {
     ....
  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:17:27.177

一些选项：

1.  在表单中放置一个隐藏值。
2.  查看会话用户以确定他们的类型。
3.  适当地分离逻辑并具有单独的操作方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T09:44:07.113

假设他们已经有会话，您可以使用

```
ActionContext.getContext().getSession().getId() 
```

在Struts2-Bean 中识别Session。

从现在开始，您可以使用 Session-ID 区分 user1 的操作和 user2 的操作；

# asp.net-mvc - 设计模式：针对后端应用程序的 RPC 的 ASP.NET API

> ID：15101920
> 
> 赞同：1
> 
> 时间：2013-02-27T00:12:51.633
> 
> 标签：asp.net-mvc, web-services, asp.net-mvc-4, asp.net-web-api

我正在设计一个 API 以使远程客户端能够针对远程服务器执行 PowerShell 脚本。

为了有效地执行命令，应用程序需要为远程客户端创建一个唯一的运行空间（以便它可以使用适当的主机和该客户端的命令集来初始化运行空间）。每次客户端发出请求时，API 都需要确保请求在正确的运行空间内执行。

流程的（过度简化的）视图可能如下所示：

1.  客户端连接到 Web API，为后端应用程序发布凭据
2.  Web API 将这些凭据传递给后端应用程序，后端应用程序使用它们创建为该客户端唯一配置的 RunSpace
3.  Web API 和应用程序“同意”链接`session-runspace`ID
4.  Web API 要么通知客户端`session-runspace`ID，要么将其保存在内存中
5.  客户提出请求：例如`"GET http://myapiserver/api/backup-status/"`
6.  Web API 将请求传递到后端应用程序功能
7.  后端应用返回结果：例如“JSON {this is the current status of backup for user/client x}”
8.  Web API 将这些结果传递给远程客户端
9.  超时或注销请求结束“会话”并释放 RunSpace

*（实际上，PowerShell 应用程序可能只是 Web API 中的自定义控制器/模型，或者它可能是 IIS 管理单元或类似的 - 我愿意在这里提供设计建议......）。*

我担心的是，为了为每个远程客户端创建一个唯一的 RunSpace，我需要为该客户端提供一个唯一的“会话”ID，以便 API 可以正确地将请求传递给应用程序。这感觉就像我打破了无国籍规则。

事实上，API 仍然是无状态的，只是后端应用程序不是，但它确实需要为每个客户端创建一个会话 (RunSpace)，然后在超时/结束会话请求后处理该 RunSpace。

**问题**

1.  我应该破解 ASP.NET MVC 中的身份验证机制来启动 RunSpace 吗？
2.  我应该承认失败并破解会话变量吗？
3.  我应该考虑一个更好的 SOA 吗？（不过，Web API 感觉非常整洁 - 特别是如果我想拥有网络、移动和你有什么的客户端）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:45:57.793

> 这感觉就像我打破了无国籍规则。

您的应用程序是有状态的 - 无法绕过它。您必须为每个客户端维护一个**进程**，并且该进程必须在一个盒子上运行，并且客户端始终连接到**同一个盒子**。所以如果你有一个服务器，没问题。如果您有多个，则必须使用粘性会话，以便客户端始终返回到同一台服务器（负载均衡器可以为您做到这一点）。

> 我应该破解 ASP.NET MVC 中的身份验证机制来启动 RunSpace 吗？

如果您需要身份验证。

> 我应该承认失败并破解会话变量吗？

没有变量，只需使用普通的内存会话。如果服务器超过 1 个，请使用上述的粘性会话。

> 我应该考虑一个更好的 SOA 吗？（不过，Web API 感觉非常整洁 - 特别是如果我想拥有网络、移动和你有什么的客户端）

SOA 没有涉及到这一点。你有一个单一的服务。

# java - 如何使用 libvirt java 绑定构建项目

> ID：15101923
> 
> 赞同：0
> 
> 时间：2013-02-27T00:13:09.057
> 
> 标签：java, maven, ant, installation, libvirt

这可能是一个愚蠢的问题，但我如何设置环境来使用 libvirt 开发测试应用程序？
我是否必须设置 ant 或 maven 项目，或者我可以将 java 文件复制到 eclipse 中的 src 文件夹中吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:40:27.637

如果您使用 Eclipse，您可以在 Eclipse 中构建您的类并运行您的程序，而无需使用 Ant 或 Maven。事实上，Eclipse 通常完全不知道您的 Ant`build.xml`或 Maven`pom.xml`文件。Eclipse 使用它自己的构建技术（尽管您可以要求它运行您的`pom.xml`or `build.xml`）。***但是***，纯 Eclipse 构建项目的方式意味着除了使用 Eclipse 之外，没有其他方法可以构建和运行您的项目。如果你有一个持续集成系统，或者有人下载了你的项目并且只是想构建你的 jar 或 war 文件，他们就没有办法做到这一点。

事实上，也不*完全*正确。您可以编写一个 shell 脚本来通过命令编译您的代码并通过`javac`命令将其打包`jar`。Maven 和 Ant 所做的是为您提供一个框架来帮助构建您的应用程序并删除系统依赖项。

Ant 具有灵活性的优势。您可以在 Ant 中轻松完成在 Maven 中难以完成的事情。缺点是 Ant 可以灵活地以非常非常糟糕的方式做事。我几乎总是建议开发人员在新项目中使用 Maven。它迫使他们以标准方式编写他们的项目，并消除了编写大多数开发人员确实无法编写的 Ant 构建脚本的需要。

如果您不了解 Maven，但了解 Ant 怎么办？我仍然推荐你使用 Maven，并以此为契机学习 Maven。

# delphi - 如何让 Web 模块知道它的所有者是从哪里调用的？

> ID：15101924
> 
> 赞同：1
> 
> 时间：2013-02-27T00:13:16.520
> 
> 标签：delphi, delphi-xe2, indy, indy10, httpserver

我正在使用 HTTP 服务器，并且正在使用 Indy`TIdHTTPWebBrokerBridge`和`TWebModule`. 我将所有服务器功能封装到一个组件中，这包括 Indy 服务器组件及其相应的 Web 模块。但是，我在弄清楚如何让 Web 模块知道调用它的组件时遇到了一些问题。

假设我有这个组件：

```
type
  TMyComponent = class(TComponent)
  private
    FServer: TIdHTTPWebBrokerBridge;
  end;

implementation

uses
  MyWebModule; 
```

我知道我必须通过设置请求处理程序来初始化它，我已经通过向`initialization`这个单元添加一个部分来处理它：

```
initialization
  if WebRequestHandler <> nil then
    WebRequestHandler.WebModuleClass:= WebModuleClass; 
```

然后我将 Web Module 类放在一个单独的单元中：

```
uses
  MyWebServer;

type
  TMyWebModule = class(TWebModule)
  private
    FOwner: TMyComponent;
  end; 
```

请注意我在此 Web 模块中的私有字段`FOwner: TMyComponent`。这是我无法确定去哪里的地方。如何将其分配给适当的所有者？Web Module 是由 Indy HTTP Server 自动创建和管理的，据我所知，我没有任何控制权来设置这样的东西。

我需要访问其所有者的原因是因为我在那里设置了 Web 模块需要能够读取的属性。例如，我在我的组件上拥有的一个属性`RootDir`是一个根目录，可以在其中读取/写入文件。我需要能够从 Web 模块中读取此属性。

如何使 Web 模块能够读取其所有者组件的属性？或者一般来说，我如何将这个私有字段分配给`FOwner`我的组件实例，从它被实例化的地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:49:15.290

**在问了这个问题后我发现了我的答案**

由于不建议创建 的多个实例`TIdHTTPWebBrokerBridge`，因此您不必担心存在多个不同的`TMyComponent`. 但是，您确实需要执行自己的检查以确保首先不存在多个实例。但是由于您只有一个该组件的实例，因此您可以放心地在组件的单​​元中声明一个全局变量并将其公开给您的 Web 模块。

不要直接在你的单元中声明一个全局`var`变量。`interface`相反，你应该保护这个......

```
function MyComponent: TMyComponent;

implementation

uses
  MyWebModule;

var
  _MyComponent: TMyComponent;

function MyComponent: TMyComponent;
begin
  Result:= _MyComponent;
end;

constructor TMyComponent.Create(AOwner: TComponent);
begin
  inherited;
  _MyComponent:= Self;
end;

destructor TMyComponent.Destroy;
begin
  _MyComponent:= nil;
  inherited;
end;

initialization
  _MyComponent:= nil;
  if WebRequestHandler <> nil then
    WebRequestHandler.WebModuleClass:= WebModuleClass;
end. 
```

# c++ - 如何使用 std::sort 按 x 坐标对我的结构进行排序

> ID：15101929
> 
> 赞同：0
> 
> 时间：2013-02-27T00:13:55.923
> 
> 标签：c++, oop

这是我的结构：

```
class Pont{

private:

    int x, y;
public:

    Pont( int x=0, int y=0);
    int getX() const;
    int getY() const;
    void setX( int x );
    void setY( int y );
    void move( int nx, int ny);
}; 
```

我填写了我的 Pont 类型 pontok ：

```
while(n < N){

        int x=(rand()%2000);
        int y=(rand()%2000);
        Pont p(x,y);
        if(!letezike(p,n)){
            pontok[n]=p;
            ++n;
        } 
```

我试过这个：

```
bool sorter(Pont const& lhs, Pont const& rhs) {

   if (lhs.getX() != rhs.getX())
        return lhs.getX() < rhs.getX();
}

std::sort(pontok[0], pontok[N], &sorter); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T00:15:18.587

删除该`!=`检查。如果`x`值相等，它会为您的程序提供未定义的行为，因为该函数不会到达`return`语句。

```
bool sorter(Pont const& lhs, Pont const& rhs) {
    return lhs.getX() < rhs.getX();
} 
```

如果`x`值相等，这将返回`false`，就像它应该做的那样。

此外，您的呼叫`std::sort`不正确。假设`pontok`是一个 size 点数组`N`，您需要执行以下操作：

```
std::sort(pontok, pontok + N, &sorter); 
```

`std::sort`接受一个迭代器范围，该范围指向要排序的序列的开头和结尾。您传入了数组的两个元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:17:22.543

`sorter`当 X 坐标相等时，您的函数似乎没有返回任何内容，这是您的意思吗？！

可能很简单：

```
bool sorter(Pont const& lhs, Pont const& rhs) {
   return lhs.getX() < rhs.getX();
} 
```

# git - git pull 是复制所有分支还是只复制主分支？

> ID：15101931
> 
> 赞同：0
> 
> 时间：2013-02-27T00:14:36.170
> 
> 标签：git, github

我想知道 git pull 会更新我的所有分支还是只更新主分支？

或者

它只是拉动我正在工作的当前分支吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:18:25.557

它只是更新当前签出的分支。

更具体地说：它将`fetch`所有分支（=更新`origin/*`分支），然后将匹配的远程分支合并到当前签出的分支中。所以如果你在`master`,`git pull`就相当于：

```
git fetch
git merge origin/master 
```

如果你想拉所有的分支，看看这个问题：[“git pull --all”可以更新我所有的本地分支吗？](https://stackoverflow.com/questions/4318161/can-git-pull-all-update-all-my-local-branches)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:19:04.370

尝试`git pull --help`

> 将来自远程存储库的更改合并到当前分支中。在其默认模式下，git pull 是 git fetch 后跟 git merge FETCH_HEAD 的简写。

# twitter-bootstrap - 引导模式链接在 IE 和 Chrome 中重叠

> ID：15101932
> 
> 赞同：0
> 
> 时间：2013-02-27T00:14:42.593
> 
> 标签：twitter-bootstrap, modal-dialog

我正在使用最新的 Twitter Bootstrap 构建一个站点。

我有 3 张图片链接到模态框（充当灯箱）。中间的图像应该居中。

*   在 Firefox 中，它可以按我的意愿工作。
*   在 Chrome 中，图像重叠/太近，但是当您在其周围移动光标时，它会自动更新和修复。
*   在 IE 中，图像无论如何都会重叠。

我的网站位于[www.shifteddd.com](http://www.shifteddd.com)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:17:24.053

您应该[向 twitter bootstrap github 项目提交错误报告](https://github.com/twitter/bootstrap/issues)。他们将告诉您如何修复它，或者在全球范围内修复它以供其产品的下一个错误修复版本。

# arrays - 带大数组的 Excel VBA 搜索

> ID：15101933
> 
> 赞同：2
> 
> 时间：2013-02-27T00:14:47.840
> 
> 标签：arrays, performance, excel, vba, search

所以我找到并修改了一个适合我需要的宏，但是有一个限制。我正在构建一个宏来搜索特定诊断代码和程序代码的医疗支付数据。在我目前正在处理的项目中，只有 14 个诊断代码，因此我能够将其直接放入 VBA。但是，有超过 800 个程序代码无法放入 VBA。我能够执行一个单独的 VBA 步骤来引入包含这些数据的表，但我似乎无法将其设置为针对该表进行搜索。但话虽如此，运行此 VBA 搜索如此大量项目的最佳方法是什么？

```
Sub PROCEDURE_1_search()
Dim FirstAddress As String
Dim MySearch As Variant
Dim myColor As Variant
Dim Rng As range
Dim I As Long

MySearch = Array("412", "4100", "4101", "4102", "4103",...) <-- have over 800

  With Sheets("All Claims by Date of Service").range("G5:G55000")
    For I = LBound(MySearch) To UBound(MySearch)
       Set Rng = .Find(What:=MySearch(I), _
                        After:=.Cells(.Cells.Count), _
                        LookIn:=xlValues, _
                        LookAt:=xlPart, _
                        SearchOrder:=xlByRows, _
                        SearchDirection:=xlNext, _
                        MatchCase:=False)
        If Not Rng Is Nothing Then
            FirstAddress = Rng.Address
            Do
                With ActiveSheet.range("B" & Rng.Row & ":O" & Rng.Row)
                    .Font.ColorIndex = 1
                    .Interior.ColorIndex = 4
                End With
                Set Rng = .FindNext(Rng)
            Loop While Not Rng Is Nothing And Rng.Address <> FirstAddress
        End If
    Next I
End With
End Sub 
```

我可能会想出一个答案，而不是问正确的问题。如果有什么我可以澄清的，请告诉我，并提前感谢您的帮助。

-瑞安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T03:57:17.447

对于搜索数组，我建议您将数据转储到变体数组中，而不是遍历范围。这样，它减少了在代码和工作表上来回的流量 - 特别是格式化。格式化无论如何都很昂贵，在你的情况下，它似乎要花费你一个月亮..

所以这是它的步骤：（不是代码 -[如果您需要代码，请查看这些示例。](https://stackoverflow.com/questions/14342186/vba-multidimensional-arrays/14342574#14342574)）。

1.  将数据转置为变量数组
2.  在 VBA 代码中随心搜索
3.  将数据转储到位置（范围）
4.  格式（范围）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T04:13:08.347

在您的示例中，您可以使用`AutoFilter`这样的方式突出显示从 B 列到 O 列的行，其中 G`4101-4103`在一次拍摄中介于两者之间（即四个条件匹配一个条件）。一个小的调整是为不同的标准调用这个代码块，例如标准 412 等。

```
Sub Smaller()
Dim rng1 As Range
Set rng1 = Sheets("All Claims by Date of Service").Range("$G$5:$G$55000")
With rng1
   .AutoFilter Field:=1, Criteria1:=">=4100", Operator:=xlAnd, Criteria2:="<=4103"
       .Offset(0, -6).Resize(rng1.Rows.Count, 14).Font.ColorIndex = 1
       .Offset(0, -6).Resize(rng1.Rows.Count, 14).Interior.ColorIndex = 4
End With
Sheets(rng1.Parent.Name).AutoFilterMode = False
End Sub 
```

# java - 权限异常的内置java异常类型

> ID：15101936
> 
> 赞同：4
> 
> 时间：2013-02-27T00:14:58.213
> 
> 标签：java, exception

考虑到有意义的地方，我们应该始终使用内置异常而不是定义我们自己的异常，即：

*   `IllegalArgumentException`- 方法传入无效参数时抛出，即不允许为null
*   `IllegalStateException`- 在不允许调用方法时抛出（即`setup()`必须先调用。

当由于用户尝试读取或写入他们无权操作的资源而引发异常时，最好的异常类型是什么（如果有的话）。你会推荐使用`SecurityException` or吗`AccessControlException`，或者这听起来没有意义。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T00:23:55.410

在我看来，两者都不是。每个异常类都有一个用途，在这种情况下是由[SecurityManager](http://docs.oracle.com/javase/7/docs/api/java/lang/SecurityManager.html)（它是 JRE 的一部分）`SecurityException`抛出的异常类，并且是.`AccessControlException``SecurityException`

`SecurityException`我认为当真正的原因是未授予应用程序定义的权限（与 强制执行的权限相反）时抛出 a 是不正确的（即使名称很漂亮`SecurityManager`）。

您应该考虑到异常应该被预期能够知道如何处理它们的代码捕获。如果某些函数不知道如何“修复”异常，则应允许异常冒泡到堆栈中。任何处理的代码`SecurityException`肯定不知道如何处理应用程序引发的异常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-27T00:23:51.733

从[http://docs.oracle.com/javase/7/docs/api/java/security/AccessControlException.html](http://docs.oracle.com/javase/7/docs/api/java/security/AccessControlException.html)：

> AccessController 抛出此异常以指示请求的访问（对关键系统资源，如文件系统或网络）被拒绝。
> 
> 拒绝访问的原因可能会有所不同。例如，请求的权限可能类型不正确、包含无效值或请求根据安全策略不允许的访问。在抛出异常时，应尽可能提供此类信息。

听起来很接近你描述的场景。我会去的`AccessControlException`。

请注意，甚至还有一个带有`Permission`对象的构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-27T00:23:49.913

您不应该总是使用内置异常。如果您提供 API，则抛出您自己的自定义异常更为合适，例如`MyProjectPermissionException`，如果您的项目是“MyProject”。`IllegalArgumentException`当然，在很多情况下，如果用户传入一个明显糟糕的参数，最好还是抛出一个内置函数。

您也可以考虑将实际原因，例如`SecurityException`，放在您自定义的异常中，如果这对您的调用者有帮助的话。

```
catch(SecurityException e)
{
    throw new MyProjectPermissionException("Permission denied", e);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T00:22:33.817

我实际上建议为此用例实现您自己的（可能已检查）异常。AFAIK 核心 API 对您所描述的内容没有足够的概括性。

有[`AccessDeniedException`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/AccessDeniedException.html)，但它扩展`IOException`，因此是一个检查异常，并且与文件访问严格相关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T00:22:53.690

对于已检查的异常，最好使用新的异常类型。否则，如果有人抓住 a `SecurityException`，将不清楚它的含义。

# opengl - GLSL 顶点着色器使计算机崩溃

> ID：15101939
> 
> 赞同：1
> 
> 时间：2013-02-27T00:15:16.047
> 
> 标签：opengl, glsl

我一直试图找出导致我的计算机崩溃的 GLSL 着色器的确切原因。我正在运行带有 NVIDIA GeForce 9400M 的 Mac OS X 10.8.2。着色器渲染正确，但偶尔会导致我的计算机崩溃，在显示器上（包括渲染窗口之外）绘制黑色区域，直到计算机变得无响应。

`glGetError`在着色器编译期间，我没有收到任何错误，也没有收到任何错误。`uniform mat4`当我从顶点着色器（例如模型视图矩阵或阴影矩阵之一）中删除 a 时，似乎不再发生崩溃。然而根据`GL_MAX_VERTEX_UNIFORM_COMPONENTS`我的显卡支持4096个顶点统一组件。

这是顶点着色器：

```
#version 120

attribute vec3 position;
attribute vec2 texcoord;
attribute vec3 normal;

varying vec2 v_texcoord;
varying vec3 v_normal;
varying vec3 v_halfVec;
varying vec4 v_shadowcoord0;
varying vec4 v_shadowcoord1;
varying vec4 v_shadowcoord2;
varying vec4 v_shadowcoord3;

uniform mat4 mv;
uniform mat3 nmv;
uniform mat4 mvp;
uniform mat4 shadowMatrix0;
uniform mat4 shadowMatrix1;
uniform mat4 shadowMatrix2;
uniform mat4 shadowMatrix3;
uniform vec3 lightDir;

void main()
{
    vec4 p4 = vec4(position, 1.0);

    v_texcoord = texcoord;
    v_normal = normalize(nmv * normal);

    vec3 vertexPos = vec3(mv * p4);
    vec3 eyeDir = normalize(-vertexPos);
    v_halfVec = normalize(eyeDir + lightDir);

    v_shadowcoord0 = shadowMatrix0 * p4;
    v_shadowcoord1 = shadowMatrix1 * p4;
    v_shadowcoord2 = shadowMatrix2 * p4;
    v_shadowcoord3 = shadowMatrix3 * p4;

    gl_Position = mvp * p4;
} 
```

我将非常感谢任何帮助追踪此错误的原因。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T08:39:03.897

这听起来像是 10.8.2 中的一个问题，在这里也可以看到：[http ://news.softpedia.com/news/OS-X-10-8-2-Broken-NVIDIA-Drivers-Causing-Pixelmator-to- Crash-312907.shtml](http://news.softpedia.com/news/OS-X-10-8-2-Broken-NVIDIA-Drivers-Causing-Pixelmator-to-Crash-312907.shtml) 应该有一个 Max OS 10.8.3 有望解决这个问题。

更新：[http ://www.cultofmac.com/214775/apple-releases-yet-another-10-8-3-os-x-beta-to-developers/](http://www.cultofmac.com/214775/apple-releases-yet-another-10-8-3-os-x-beta-to-developers/)

# mysql - 计算多个值的不同行数

> ID：15101941
> 
> 赞同：4
> 
> 时间：2013-02-27T00:15:27.490
> 
> 标签：mysql, sql, distinct

让我们考虑这张表，它指定了一个人购买了多少次房产。

```
+--------+----------+
|  user  | property |
+--------+----------+
| john   | car      |
| john   | car      |
| john   | house    |
| peter  | car      |
| peter  | car      |
| amanda | house    |
| amanda | house    |
+--------+----------+ 
```

我需要知道一辆车买了多少次，房子买了多少次等等。这样的事情：

```
+----------+---+---+
| property | 1 | 2 |
+----------+---+---+
| cars     | 4 | 2 |
| house    | 3 | 1 |
+----------+---+---+ 
```

*   一辆车买了多少次？**四**，**彼得**两，**约翰**两。
*   一辆车被买了多少次？**二**，对于同一个人。
*   房子买了多少次？**三**，**阿曼达**两次，**约翰**一次。
*   房子被买了多少次？只有**一次**，对于**阿曼达**

**是否可以仅使用 SQL 查询来做到这一点？**

*   我不在乎性能或骇人听闻的方式。
*   有两个以上的频率。
*   购买房产的时间是固定的 (5)，因此在查询中手动指定列是没有问题的。我的意思是做类似的事情没有问题：

    ```
    SELECT /* ... */ AS 1, /* ... */ AS 2, /* ... */, AS 3 /* ... */ 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T01:18:04.603

自从您发布问题以来，我就在这里。好一个...
这是一种完全按照您的要求进行操作的方法，只需组和计数。
诀窍是我将用户列和属性列连接起来，为每个列生成一个唯一的“id”，如果我们可以这样称呼它的话。它应该独立于购买计数而工作。

```
SELECT C.`property`, COUNT(C.`property`), D.`pcount` from `purchases` C
LEFT JOIN(
  SELECT A.`property`, B.`pcount` FROM `purchases` A
  LEFT JOIN (
    SELECT `property`,
           CONCAT(`user`, `property`) as conc,
           COUNT(CONCAT(`user`, `property`)) as pcount
    FROM `purchases` GROUP BY CONCAT(`user`, `property`)
  ) B
  ON A.`property` = B.`property`
  GROUP BY B.pcount
) D
ON C.`property` = D.`property`
GROUP BY C.`property` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T01:19:49.460

[SQL小提琴](http://sqlfiddle.com/#!2/6a8ce/109)

**MySQL 5.5.30 架构设置**：

```
CREATE TABLE Table1
    (`user` varchar(6), `property` varchar(5))
;

INSERT INTO Table1
    (`user`, `property`)
VALUES
    ('john', 'car'),
    ('john', 'car'),
    ('john', 'house'),
    ('peter', 'car'),
    ('peter', 'car'),
    ('amanda', 'house'),
    ('amanda', 'house')
; 
```

**查询 1**：

```
select t.property, t.total, c1.cnt as c1, c2.cnt as c2, c3.cnt as c3
from
  (select 
    t.property , 
    count(t.property) as total
  from Table1 t
  group by t.property
  ) as t
  left join (
      select property, count(*) as cnt
      from (
          select 
            property, user, count(*) as cnt
          from table1
          group by property, user
          having count(*) = 1
        ) as i1
      group by property
  ) as c1 on t.property = c1.property
  left join (
      select property, count(*) as cnt
      from (
          select 
            property, user, count(*) as cnt
          from table1
          group by property, user
          having count(*) = 2
        ) as i2
      group by property
  ) as c2 on t.property = c2.property
  left join (
      select property, count(*) as cnt
      from (
          select 
            property, user, count(*) as cnt
          from table1
          group by property, user
          having count(*) = 3
        ) as i3
      group by property
  ) as c3 on t.property = c3.property 
```

**[结果](http://sqlfiddle.com/#!2/6a8ce/109/0)**：

```
| PROPERTY | TOTAL |     C1 | C2 |     C3 |
-------------------------------------------
|      car |     4 | (null) |  2 | (null) |
|    house |     3 |      1 |  1 | (null) | 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T00:52:35.730

```
SELECT DISTINCT @pr := prop,
    (SELECT COUNT(1) FROM tbl WHERE prop = @pr LIMIT 1),
    (SELECT COUNT(1) FROM 
        (SELECT *, COUNT(*) cnt
        FROM tbl
        GROUP BY usr, prop
        HAVING cnt = 2) as tmp
        WHERE `tmp`.prop = @pr LIMIT 1)
FROM tbl; 
```

是的，这不是最好的方法；但是，嘿，你会得到想要的答案。

此外，它还会为您表中的任何类型的属性生成结果。

小提琴链接[就在这里](http://sqlfiddle.com/#!2/12e1e/61)。

PS: 60 次尝试 O_O

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T01:25:03.893

您可以尝试关注。

```
SELECT COUNT(TABLE1.PROPERTY) AS COUNT, PROPERTY.USER FROM TABLE1
INNER JOIN (SELECT DISTINCT PROPERTY, USER FROM TABLE1) AS PROPERTY
ON PROPERTY.PROPERTY = TABLE1.PROPERTY
AND PROPERTY.USER = TABLE1.USER
GROUP BY TABLE1.USER, PROPERTY.PROPERTRY 
```

在 MySQL 中进行了类似的测试

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T00:24:28.410

尝试这个

```
 SELECT property , count(property) as bought_total , count(distinct(user)) bought_per_user
    FROM Table1
    GROUP BY property 
```

输出将是这样的

```
 PROPERTY  |   BOUGHT_TOTAL     |  BOUGHT_PER_USER
  ________________________________________________________
    car     |            4       |       2
    house   |            3       |       2 
```

[**演示 SQL 小提琴在这里**](http://sqlfiddle.com/#!2/6a8ce/3)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-27T06:35:31.307

I hope this can help u.....let us create one table first:

create table prop(user varchar(max),property varchar(max))

insert into prop values('john','car'),insert into prop values('john','car'), insert into prop values('john','house'),insert into prop values('peter','car'),

insert into prop values('peter','car'),insert into prop values('amanda','house'), insert into prop values('amanda','house')

1)how many times car was bought?

ANS: select count(property) from prop where property = 'car' (4)

2)How many times a car was bought twice?

ANS: select user,COUNT(property) from prop where property = 'car' group by user having COUNT(property) = 2

2-john 2-peter

3)How many times a house was bought?

ANS: select COUNT(property) from prop where property = 'house' (3) 4)How many times a house was bought twice? ANS: select user,COUNT(property) from prop where property='house' group by user having COUNT(property)< =2 2-amanda 1-john

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-27T00:35:22.930

您应该能够使用子选择来做到这一点。

```
SELECT property, user, COUNT(*) FROM purchases GROUP BY property, user; 
```

将返回您想要的全套分组数据。然后您需要查看不同的频率：

```
SELECT property, freq, COUNT(*) FROM (SELECT property, user, COUNT(*) freq FROM purchases GROUP BY property, user) AS foo GROUP BY property, freq; 
```

它与您说明的格式不完全一样，但它返回数据

# php - CURLOPT_FILE 适用于 WAMP 但不适用于 LAMP

> ID：15101943
> 
> 赞同：0
> 
> 时间：2013-02-27T00:15:31.473
> 
> 标签：php, json, curl

我对 PHP 和 curl 有点陌生。我在本地机器上的 WAMP 中设置了一个脚本。它将执行 curl 并将结果保存到 .csv 文件。这个相同的 curl 脚本不适用于最近为我设置的 LAMP 开发环境。相反，生成的 JSON 会打印在浏览器中。我需要在 LAMP 堆栈中启用某种 php 扩展吗？这是代码：

```
$reportfileurl = 'https://www.googleapis.com/analytics/sampleurl';
$path = 'temp/temp.csv';
 $fp = fopen($path, 'w');
 $request = curl_init();
 curl_setopt($request, CURLOPT_URL, $reportfileurl);
 curl_setopt($request, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
 curl_setopt($request, CURLOPT_HTTPHEADER, array($authorization_header));
 //curl_setopt($request, CURLOPT_RETURNTRANSFER, TRUE);
 curl_setopt($request, CURLOPT_FILE, $fp);
 curl_setopt($request, CURLOPT_SSL_VERIFYPEER, TRUE);
 curl_setopt($request, CURLOPT_SSL_VERIFYHOST, 2);
 curl_setopt($request, CURLOPT_CAINFO, getcwd() . "/CAcerts/BuiltinObjectToken-EquifaxSecureCA.crt");
 $report_file = curl_exec($request);
 curl_close($request);
 fclose($fp); 
```

另一方面，由于 curl 请求返回 JSON，我知道我需要先对其进行解码，然后才能将内容保存为 csv。我发现了一些关于如何从 JSON 对象创建数组的帖子，但我似乎无法在数组中引用 JSON 对象内的内容，所以我想知道部分问题是否与卷曲处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:15:30.097

凉爽的。我想出了如何创建一个有权将文件/文件夹添加到 /var/www 的用户组，然后我将 apache2 用户“www-data”添加到该组。这里的说明

[https://serverfault.com/questions/6895/whats-the-best-way-of-handling-permissions-for-apache2s-user-www-data-in-var](https://serverfault.com/questions/6895/whats-the-best-way-of-handling-permissions-for-apache2s-user-www-data-in-var)

我现在可以将 .csv 写入服务器。现在我只需要将 JSON 解码为实际的逗号分隔值！

# java - Java - Math.pow() 和 Math.sqrt() 的更快替代方案

> ID：15101945
> 
> 赞同：8
> 
> 时间：2013-02-27T00:15:45.500
> 
> 标签：java, function, math, floating-accuracy, pow

我的程序用来`Math.pow()`计算一个相对较大的双数的 2 次方。稍后我需要找到一个非常大的双数的平方根。问题是，我必须这样做超过 100,000 次，而且需要很长时间。有没有其他方法可以加快这个过程？谢谢

编辑：我的意思是在 1000 到 10000 之间（所以在计算方面可能没有那么大）。而就耗时而言，完成500次功能大约需要30秒

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-27T00:17:55.127

您不太可能找到比 Java Math 更好（更快）的实现。尝试改变算法中的计算方式可能会更幸运。例如，有什么方法可以避免找到一个大数的平方根？

如果这不起作用，您可以尝试用一种更合适的语言来实现它，这种语言用于快速数学计算（比如 Matlab）。

否则，您可以尝试在其他方面进行优化。如果以后有用，也许您可​​以尝试缓存过去的结果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-27T00:19:20.193

“2 的幂”是平方。你最好通过将数字乘以自身来做到这一点。

的库版本`sqrt`可能比您在其他地方挖掘的任何东西都快。如果你调用一个 C 例程，你只会增加跨语言调用的开销。但是您是否需要精确的平方根，或者近似值的表格查找需要吗？这些值是否重复很多，即您是否经常需要计算相同数字的根？如果是这样，在 a 中缓存平方根`HashMap`可能比计算它们更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T00:23:04.283

那么你的2的幂的问题可以简单地通过将数字乘以自身来完成。例如，假设变量 a 是您想要提高到 2 的数字。它与以下内容相同： `int a=5; int b=a*a;`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T00:39:49.780

我唯一能想到的就是存储结果以提高速度，平方根不会改变，而且大约 9000 个存储的数字并不多。您可能会很好地构建您的数据，这样您就可以确保您可以最佳地搜索适当的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T00:27:28.890

您可以使用 x*x 代替 pow(x, 2)。

对于平方根，你应该先看看 sqrt 的实现（近似方法）。

也许您可以找到更好的方法，例如[牛顿法](http://en.wikipedia.org/wiki/Newton%27s_method)（在方程 sqrt(N)-x=0 上）。

它还取决于所需的准确性，您可以交易准确性与时间。

您还可以存储结果以避免对同一条目进行多次计算。

# ruby-on-rails - 在 Rails 中 to_json 接受哪 些参数？

> ID：15101952
> 
> 赞同：0
> 
> 时间：2013-02-27T00:16:12.457
> 
> 标签：ruby-on-rails

```
 def show
    email = UserEmail.find_by_key(UserEmail.key_for(UserEmail.new(:publisher_id => @publisher.name, :app_id => @app ? @app.name : 'none', :external_uid => @user.external_uid)))
    respond_to do |format|
      format.xml { render :xml => @user.to_xml(:session => false, :authorized => user_logged_in? || publisher_logged_in? || app_logged_in?, :publisher => @publisher, :email => email || false) }
      format.json { render :json => @user.to_json(:session => false, :authorized => user_logged_in? || publisher_logged_in? || app_logged_in?, :publisher => @publisher, :email => email || false) }
    end
  end 
```

这是我的代码，我特别想了解以下内容：

```
format.json { render :json => @user.to_json(:session => false, :authorized => user_logged_in? || publisher_logged_in? || app_logged_in?, :publisher => @publisher, :email => email || false) } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T11:01:33.523

唯一`to_json`可以理解的参数是`:only`、`:except`和`:methods`（请查看[此处](http://apidock.com/rails/ActiveRecord/Serialization/to_json)`:include`的文档）。

如果您`to_json`使用其他参数，那是因为它（或方法`as_json`）已在您的模型中被覆盖。

# android - 在线程的小部件中显示 Toast

> ID：15101958
> 
> 赞同：1
> 
> 时间：2013-02-27T00:16:31.693
> 
> 标签：android, multithreading, android-appwidget

我必须开发一个包含按钮的小部件（AppWidget）。当按下按钮时，http 请求完成，如果请求成功，小部件通过 Toast 通知事实。由于http请求可以锁定UI，所以我在一个线程中运行它。一切正常（我可以在我的日志中看到“*好吧*”），除了 Toast 通知。我究竟做错了什么？

**在 AppWidgetProvider 子类中：**

```
@Override
    public void onReceive(Context c, Intent intent){
        super.onReceive(c, intent);
        if(intent.getAction().equals(CLICK_ACTION)){
            performRequest(c);
        }
    } 
```

（我认为这个问题不需要 onUpdate 方法）

```
private void performRequest(final Context c){
    new Thread(new Runnable(){
        public void run() {
            try {
                if(Http.get(URL).contains(SUCCESS)){
                Toast.makeText(c, "All right", Toast.LENGTH_SHORT).show();                                      
                Log.i("Widget","All right");        
                }
            } catch (Exception e) {
                e.printStackTrace();
            }}}).start();
} 
```

我认为问题出在 的`Context`参数上`performRequest`，但如果我删除`final`关键字，就会出错。

谢谢指教。

**[编辑]**

我以这种方式“解决”了这个问题：

-我声明`Toast t`为全局变量；

- 在 onReceive 方法中，我用它初始化它`Toast.makeText(Context,String,int)`

- 当我需要展示它时，我只需调用`t.show()`

我希望有更好的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:21:25.483

> 由于http请求可以锁定UI，所以我在一个线程中运行它。一切正常（我可以在我的登录中查看“好的”），除了 Toast 通知。我究竟做错了什么？

问题是您不能从另一个线程更改 UI。您必须将此消息传递回主线程才能显示您的 Toast。

* * *

> 我该怎么做？

有很多不同的方法可以做到这一点，尝试将 Context 保存`onReceive()`为字段变量：

```
Context context;

@Override
public void onReceive(Context c, Intent intent){
    super.onReceive(c, intent);
    context = c;
    ... 
```

接下来在您的 Activity 中创建一个简单的方法：

```
public void httpGetSucceeded() {
    Toast.makeText(context, "All right", Toast.LENGTH_SHORT).show();                                      
    Log.i("Widget","All right");        
} 
```

现在在你的 Runnable 中调用它：

```
try {
    if(Http.get(URL).contains(SUCCESS)){
         httpGetSucceeded();
    }
} //etc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T00:28:06.687

更好的是，为什么你没有一个在线程完成其任务后调度消息的处理程序。当您在广播接收器中收到该消息时，只需使用消息并使用 Handler 对象中的 post runnable 方法显示 toast。

因为处理程序将属于您的广播接收器，所以当您为可运行对象调用帖子时，您应该在 UI 线程上运行。

## 参考

[http://developer.android.com/reference/android/os/Handler.html](http://developer.android.com/reference/android/os/Handler.html) [http://developer.android.com/reference/android/os/Handler.html#post(java.lang.Runnable)](http://developer.android.com/reference/android/os/Handler.html#post(java.lang.Runnable))

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-27T00:34:02.810

最简单的方法是打电话

```
activity.runOnUiThread(new Runnable() {
  public void run() {
    // launch toast here
  }
}); 
```

或者，给定一个特定的小部件：

```
view.post(new Runnable() {
  public void run() {
    // launch toast here
  }
}); 
```

# asp.net - 如何正确让实体框架使用我的复合主键？

> ID：15101960
> 
> 赞同：1
> 
> 时间：2013-02-27T00:16:40.267
> 
> 标签：asp.net, sql-server-2008, entity-framework

我有一个这样定义的表：

```
CREATE TABLE [dbo].[Sitemap](
        [EntityId] [int] NOT NULL,
        [PageUrl] [nvarchar](400) NOT NULL,
        [Frequency] [nvarchar](400) NOT NULL,
[PageType] [nvarchar](400) NOT NULL,
[UpdatedOn] [datetime] NOT NULL,
CONSTRAINT [PK_Sitemap] PRIMARY KEY CLUSTERED 
(
[EntityId] ASC,
[PageType] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, 
   IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

我去了我的 edmx 文件并从数据库进行了更新。它导入了所有内容，但没有将两个字段都标记为主键。我尝试将第二个字段添加为主键，但它仍然不会将它们视为组合。

我遇到的问题是当我在具有类似条目的表上运行更新时，例如

EntityId = 1, PageType = 'Product',.... 和 EntityId = 1, PageType = 'Artist',...

我收到一条错误消息：

ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象。

如何让我的模型或代码正确使用复合作为主键？还是我必须制作某种复合字段才能做到这一点？

**更新**

我的代码是 NopCommerce 1.90 的一个分支

因此，我添加了一个接口和服务，并将其注册到 IoC 解析器。

对于这个表，我有以下类：

```
//------------------------------------------------------------------------------
// The contents of this file are subject to the nopCommerce Public License Version 1.0 ("License"); you may not use this file except in compliance with the License.
// You may obtain a copy of the License at  http://www.nopCommerce.com/License.aspx. 
// 
// Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. 
// See the License for the specific language governing rights and limitations under the License.
// 
// The Original Code is nopCommerce.
// The Initial Developer of the Original Code is NopSolutions.
// All Rights Reserved.
// 
// Contributor(s): _______. 
//------------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using NopSolutions.NopCommerce.BusinessLogic.CustomerManagement;
using NopSolutions.NopCommerce.BusinessLogic.Infrastructure;
using NopSolutions.NopCommerce.BusinessLogic.Payment;
using NopSolutions.NopCommerce.BusinessLogic.Promo.Affiliates;
using NopSolutions.NopCommerce.BusinessLogic.Promo.Discounts;
using NopSolutions.NopCommerce.BusinessLogic.Shipping;
using NopSolutions.NopCommerce.BusinessLogic.Tax;

namespace NopSolutions.NopCommerce.BusinessLogic.SEO.Sitemaps
{
    /// <summary>
    /// Represents a Sitemap
    /// </summary>
    [Serializable]
    public partial class Sitemap : BaseEntity
    {
        #region Utilities

        #endregion

        #region Properties

        /// <summary>
        /// Gets or Sets EntityId (Product ID, Show ID, etc.)
        /// </summary>
        public int EntityId { get; set; }

        /// <summary>
        /// Gets or sets the Page Url
        /// </summary>
        public string PageUrl { get; set; }

        /// <summary>
        /// Gets of set the Page Frequency (Should be one of the following - Always, Hourly, Daily, Weekly, Monthly, Yearly, Never)
        /// </summary>
        public string Frequency { get; set; }

        /// <summary>
        /// Gets or sets the page type. For example: Product, or Show
        /// </summary>
        public string PageType { get; set; }

        /// <summary>
        /// Gets or sets the date and time of sitemap entry update
        /// </summary>
        public DateTime UpdatedOn { get; set; }

        #endregion
    }
} 
```

然后我有接口和服务：

界面：

```
 //------------------------------------------------------------------------------
  // The contents of this file are subject to the nopCommerce Public License Version 1.0 ("License"); you may not use this file except in compliance with the License.
    // You may obtain a copy of the License at  http://www.nopCommerce.com/License.aspx.
    //
    // Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.
    // See the License for the specific language governing rights and limitations under the License.
    //
    // The Original Code is nopCommerce.
    // The Initial Developer of the Original Code is NopSolutions.
    // All Rights Reserved.
    //
    // Contributor(s): _______.
    //------------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using NopSolutions.NopCommerce.BusinessLogic.CustomerManagement;
using NopSolutions.NopCommerce.BusinessLogic.Payment;
using NopSolutions.NopCommerce.BusinessLogic.Shipping;
using NopSolutions.NopCommerce.Common;

namespace NopSolutions.NopCommerce.BusinessLogic.SEO.Sitemaps
{
    /// <summary>
    /// Sitemap service
    /// </summary>
    public partial interface ISiteMapService
    {
        /// <summary>
        /// Gets a Sitemap entry based on url.
        /// </summary>
        /// <param name="url">Fully Qualified URL (e.g. http://www.onlinesheetmusic.com/default.aspx)</param>
        /// <returns></returns>
        Sitemap GetSitemap(string url);

        /// <summary>
        /// Gets the most recent entry to the sitemap table
        /// </summary>
        /// <returns></returns>
        Sitemap GetLastAddedSitemap(string pageType);

        /// <summary>
        /// Gets a list of Sitemap entries that are in the init state of the given Page Type
        /// </summary>
        /// <param name="pageType">Page Type</param>
        /// <returns></returns>
        List<Sitemap> GetInitEntries(string pageType);

        /// <summary>
        /// Bool to determine if a given pageType has any entries in the init state.
        /// </summary>
        /// <param name="pageType"></param>
        /// <returns></returns>
        bool IsInit(string pageType);

        void InitSitemap(string pageType, int startProdId = 0);

        /// <summary>
        /// Inserts a sitemap entry
        /// </summary>
        /// <param name="order">Order</param>
        void InsertSitemap(Sitemap sm);

        /// <summary>
        /// Updates the order
        /// </summary>
        /// <param name="order">The order</param>
        void UpdateSitemap(Sitemap sm);
    }
} 
```

服务：

```
//------------------------------------------------------------------------------
// The contents of this file are subject to the nopCommerce Public License Version 1.0 ("License"); you may not use this file except in compliance with the License.
// You may obtain a copy of the License at  http://www.nopCommerce.com/License.aspx.
//
// Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.
// See the License for the specific language governing rights and limitations under the License.
//
// The Original Code is nopCommerce.
// The Initial Developer of the Original Code is NopSolutions.
// All Rights Reserved.
//
// Contributor(s): _______.
//------------------------------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Text;
using NopSolutions.NopCommerce.BusinessLogic.Audit;
using NopSolutions.NopCommerce.BusinessLogic.Caching;
using NopSolutions.NopCommerce.BusinessLogic.Configuration.Settings;
using NopSolutions.NopCommerce.BusinessLogic.CustomerManagement;
using NopSolutions.NopCommerce.BusinessLogic.Data;
using NopSolutions.NopCommerce.BusinessLogic.Directory;
using NopSolutions.NopCommerce.BusinessLogic.Infrastructure;
using NopSolutions.NopCommerce.BusinessLogic.Localization;
using NopSolutions.NopCommerce.BusinessLogic.Messages;
using NopSolutions.NopCommerce.BusinessLogic.Messages.SMS;
using NopSolutions.NopCommerce.BusinessLogic.Payment;
using NopSolutions.NopCommerce.BusinessLogic.Products;
using NopSolutions.NopCommerce.BusinessLogic.Products.Attributes;
using NopSolutions.NopCommerce.BusinessLogic.Profile;
using NopSolutions.NopCommerce.BusinessLogic.Promo.Discounts;
using NopSolutions.NopCommerce.BusinessLogic.QuickBooks;
using NopSolutions.NopCommerce.BusinessLogic.Security;
using NopSolutions.NopCommerce.BusinessLogic.Shipping;
using NopSolutions.NopCommerce.BusinessLogic.Tax;
using NopSolutions.NopCommerce.Common;
using NopSolutions.NopCommerce.Common.Extensions;
using NopSolutions.NopCommerce.Common.Utils;
using NopSolutions.NopCommerce.Common.Utils.Html;

namespace NopSolutions.NopCommerce.BusinessLogic.SEO.Sitemaps
{
    /// <summary>
    /// Sitemap service
    /// </summary>
    public partial class SiteMapService : ISiteMapService
    {
        #region Fields

        /// <summary>
        /// Object context
        /// </summary>
        private readonly NopObjectContext _context;

        /// <summary>
        /// Cache service
        /// </summary>
        private readonly ICacheManager _cacheManager;

        #endregion Fields

        #region Ctor

        /// <summary>
        /// Ctor
        /// </summary>
        /// <param name="context">Object context</param>
        public SiteMapService(NopObjectContext context)
        {
            this._context = context;
            this._cacheManager = new NopRequestCache();
        }

        #endregion Ctor

        #region Utilities

        #endregion Utilities

        #region Methods

        /// <summary>
        /// Gets a sitemap entry
        /// </summary>
        /// <param name="url">The url of the sitempa item</param>
        /// <returns>Order</returns>
        public Sitemap GetSitemap(string url)
        {
            if (!url.IsNotNullOrEmpty())
                return null;

            var query = from sm in _context.Sitemaps
                        where sm.PageUrl.Contains(url)
                        select sm;
            var sitemap = query.SingleOrDefault();
            return sitemap;
        }

        public Sitemap GetLastAddedSitemap(string pageType)
        {
            var query = (from sm in _context.Sitemaps
                         where sm.PageType.Equals(pageType)
                         orderby sm.UpdatedOn descending
                         select sm).Take(1);

            var sitemap = query.SingleOrDefault();

            return sitemap;                        
        }

        public List<Sitemap> GetInitEntries(string pageType)
        {
            var query = (from sm in _context.Sitemaps
                         where sm.PageType.Equals(pageType)
                         && sm.Frequency == "Init"
                         select sm).Take(500);

            return query.ToList();
        }

        /// <summary>
        /// Bool to check if a given type has any entries in the init state.
        /// </summary>
        /// <param name="pageType">Page Type</param>
        /// <returns>True or False</returns>
        public bool IsInit(string pageType)
        {
            var query = (from sm in _context.Sitemaps
                         where sm.PageType.Equals(pageType)
                         && sm.PageUrl.Equals("Init")
                         select sm).Take(1);
            if (query == null)
                return true;
            else
                return false;
        }

        public void InitSitemap(string pageType, int startProdId = 0)
        {
            _context.Sp_SitemapInit(pageType, startProdId);
        }

        /// <summary>
        /// Inserts a sitemap entry
        /// </summary>
        /// <param name="sm">Sitemap Entry to Insert</param>
        public void InsertSitemap(Sitemap sm)
        {
            if (sm == null)
                throw new ArgumentNullException("sitemap");

            sm.PageUrl = CommonHelper.EnsureNotNull(sm.PageUrl);
            sm.PageType = CommonHelper.EnsureNotNull(sm.PageType);
            sm.Frequency = CommonHelper.EnsureNotNull(sm.Frequency);

            _context.Sitemaps.AddObject(sm);
            _context.SaveChanges();

        }

        /// <summary>
        /// Updates a sitemap entry
        /// </summary>
        /// <param name="sm">Sitemap Entry to update</param>
        public void UpdateSitemap(Sitemap sm)
        {
            if (sm == null)
                throw new ArgumentNullException("sitemap");

            sm.PageUrl = CommonHelper.EnsureNotNull(sm.PageUrl);
            sm.PageType = CommonHelper.EnsureNotNull(sm.PageType);
            sm.Frequency = CommonHelper.EnsureNotNull(sm.Frequency);

            if(_context.Sitemaps.Any(s => (s.PageUrl == sm.PageUrl || s.EntityId == sm.EntityId)))
            {
                if (!_context.IsAttached(sm))
                    _context.Sitemaps.Attach(sm);
            }
            else
            {
                _context.Sitemaps.AddObject(sm);
            }

            _context.SaveChanges();
        }

        #endregion Methods

        #region Properties

        /// <summary>
        /// Gets a value indicating whether cache is enabled
        /// </summary>
        public bool CacheEnabled
        {
            get
            {
                return IoC.Resolve<ISettingManager>().GetSettingValueBoolean("Cache.OrderManager.CacheEnabled");
            }
        }

        #endregion Properties
    }
} 
```

当我打电话

```
var sitemapservice = IoC.Resolve<ISiteMapService>();
            sitemapservice.InitSitemap("Artist");
            var smEntries = sitemapservice.GetInitEntries("Artist");
            foreach (Sitemap sm in smEntries)
            {
                using (MvcMiniProfiler.MiniProfiler.StepStatic("Processing Entry: " + sm.EntityId + "," + sm.PageType))
                {
                    sm.Frequency = "Monthly";
                    sm.PageUrl = SEOHelper.GetUrl(this.ArtistService.GetArtistById(sm.EntityId), this.SettingManager.StoreUrl);

                    using (MvcMiniProfiler.MiniProfiler.StepStatic("Updating database"))
                    {
                        sitemapservice.UpdateSitemap(sm);
                    }
                    curCount++;
                }
            } 
```

它应该获取 init 阶段的所有条目并使用正确的 url 设置它们，但无论出于何种原因，我不断收到错误消息，说 ObjectStateManager 中已经存在具有相同键的对象。虽然奇怪的是数据库似乎正在正确更新，但它一直给我这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T00:28:57.573

我想这就是你所指的...

```
public class CollectionItem
{
    public int CollectionId { get; set; }
    public int ItemId { get; set; }

    [RelatedTo(ForeignKey = "CollectionId")]
    public Collection Collection { get; set; }
    [RelatedTo(ForeignKey = "ItemId")]
    public Item Item { get; set; }
} 
```

并像这样使用模型构建器

```
var builder = new ModelBuilder();
// ...
builder.Entity<CollectionItem>().HasKey(p=>new {p.CollectionId, p.ItemId});
// ...
model = builder.CreateModel(); 
```

希望这会有所帮助，我试图保持名称通用

# asp.net-mvc - 单元测试 - 用户控制器的方法

> ID：15101965
> 
> 赞同：0
> 
> 时间：2013-02-27T00:16:56.873
> 
> 标签：asp.net-mvc, unit-testing, controller

我有一个名为“UserController”的控制器，其方法名为“Invite”。我的控制器具有以下覆盖方法：

```
DBRepository _repository;
protected override void Initialize(System.Web.Routing.RequestContext requestContext)
{
    base.Initialize(requestContext);
            _repository = new DBRepository();

} 
```

因此，每次创建 UserController 类时都会调用此方法。

我的方法“邀请”有以下几行：

```
var startTime = _repository.Get<AllowedTime>(p => p.TimeID == selectTimeStart.Value); 
```

但是当我尝试通过 Unit 方法调用此方法时：

```
[TestMethod()]
[UrlToTest("http://localhost:6001/")]
public void InviteTest()
{
    UserController target = new UserController(); // TODO: Initialize to an appropriate value
    int? selectTimeStart = 57;
    int? selectTimeEnd = 61;
    Nullable<int> selectAttachToMeeting = new Nullable<int>(); // TODO: Initialize to an appropriate value
    int InvitedUserID = 9; // TODO: Initialize to an appropriate value
    UserInviteModel model = new UserInviteModel();
    model.Comment = "BLA_BLA_BLA";
    ActionResult expected = null; // TODO: Initialize to an appropriate value
    ActionResult actual;
    actual = target.Invite(selectTimeStart, selectTimeEnd, selectAttachToMeeting, InvitedUserID, model);
    Assert.AreEqual(expected, actual);
    Assert.Inconclusive("Verify the correctness of this test method.");
} 
```

我收到错误“未设置参考...”。我理解它为什么会发生（_repository 为空，因为在我的情况下未调用 Initialize 方法，但如何正确执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:39:38.020

如果您希望 DBRepository`Get`在测试期间从您的支持数据存储中实际执行 ，您可以将您的`_repository`字段更改为 a `Lazy<DBRepository>`，在第一次使用时进行初始化。（我假设它是`new`在 Initialize 方法而不是构造函数中被编辑的，因为它依赖于当前的请求上下文？）

如果您希望这是一个真正的单元测试，则根本不应该测试 DBRepository 类：您应该对可以模拟的接口进行编程。此外，您需要使它`DBRepository`来自测试用例可以提供的某个地方。您可以将其由工厂构建或作为单例提供，并且测试用例可以设置工厂或单例以提前提供模拟对象。但是，*最好*的方法是使用依赖注入，因此您可以在构建`new UserController()`.

# r - 根据每个键值的非 NA 观察数排除数据

> ID：15101966
> 
> 赞同：1
> 
> 时间：2013-02-27T00:16:58.117
> 
> 标签：r, data.table

我有一个数据集，其中包含对美国公司回报的每月观察。我试图从我的样本中排除所有非 NA 观察次数少于一定数量的公司。

我设法做我想做的事`foreach`，但我的数据集非常大，这需要很长时间。这是一个工作示例，它显示了我如何完成我想要的，并希望使我的目标明确

```
#load required packages
library(data.table)
library(foreach)

#example data
myseries <- data.table(
 X = sample(letters[1:6],30,replace=TRUE),
 Y = sample(c(NA,1,2,3),30,replace=TRUE))

setkey(myseries,"X") #so X is the company identifier

#here I create another data table with each company identifier and its number 
#of non NA observations
nobsmyseries <- myseries[,list(NOBSnona = length(Y[complete.cases(Y)])),by=X]

# then I select the companies which have less than 3 non NA observations
comps <- nobsmyseries[NOBSnona <3,]

#finally I exclude all companies which are in the list "comps", 
#that is, I exclude companies which have less than 3 non NA observations
#but I do for each of the companies in the list, one by one, 
#and this is what makes it slow.

for (i in 1:dim(comps)[1]){
myseries <- myseries[X != comps$X[i],]
} 
```

我怎样才能更有效地做到这一点？有没有`data.table`办法得到相同的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:25:39.747

如果您希望为 NA 值考虑超过 1 列，那么您可以使用`complete.cases(.SD)`，但是由于您想测试单个列，我建议类似

```
naCases <- myseries[,list(totalNA  = sum(!is.na(Y))),by=X] 
```

然后，您可以加入给定的阈值总 NA 值

例如

```
threshold <- 3
myseries[naCases[totalNA > threshold]] 
```

您还可以选择使用 not join 来获取您已排除的案例

```
 myseries[!naCases[totalNA > threshold]] 
```

如评论中所述，类似

```
myseries[,totalNA  := sum(!is.na(Y)),by=X][totalNA > 3] 
```

但是，在这种情况下，您正在对整个 data.table 执行矢量扫描，而之前的解决方案对只有`nrow(unique(myseries[['X']]))`.

鉴于这是一个单一的向量扫描，无论如何它都是有效的（也许二元连接 + 小向量扫描可能比更大的向量扫描慢），但是我怀疑这两种方式都会有很大的不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T00:32:45.787

如何在 X 上聚合 Y 中的 NA 数量，然后进行子集化？

```
# Aggregate number of NAs
num_nas <- as.data.table(aggregate(formula=Y~X, data=myseries, FUN=function(x) sum(!is.na(x))))

# Subset
myseries[!X %in% num_nas$X[Y>=3],] 
```

# delphi - 如何以编程方式更改特定显示器的分辨率？

> ID：15101977
> 
> 赞同：3
> 
> 时间：2013-02-27T00:17:57.980
> 
> 标签：delphi

您如何以编程方式更改特定显示器的分辨率？例如，可以通过编程方式更改辅助监视器的分辨率吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T06:07:22.620

以下功能可能是您的起点。它尝试将具有由`Index`参数指定的索引（如果存在）的显示设备的分辨率更改为由`Width`,`Height`参数给出的宽度和高度（以像素为单位）。如果找到具有给定索引的显示设备并且已成功更改其分辨率，则该函数返回 True，否则返回 False。

您尚未指定是要永久更改分辨率（如果要存储设置更改），还是仅临时更改。以下示例暂时执行此操作，但如果您在第二个[`ChangeDisplaySettingsEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183413%28v=vs.85%29.aspx)函数调用参数的`CDS_UPDATEREGISTRY`值中使用，您可以非常简单地更改此行为`dwflags`：

```
function ChangeMonitorResolution(Index, Width, Height: DWORD): Boolean;
var
  DeviceMode: TDeviceMode;
  DisplayDevice: TDisplayDevice;
begin
  Result := False;
  ZeroMemory(@DisplayDevice, SizeOf(DisplayDevice));
  DisplayDevice.cb := SizeOf(TDisplayDevice);
  // get the name of a device by the given index
  if EnumDisplayDevices(nil, Index, DisplayDevice, 0) then
  begin
    ZeroMemory(@DeviceMode, SizeOf(DeviceMode));
    DeviceMode.dmSize := SizeOf(TDeviceMode);
    DeviceMode.dmPelsWidth := Width;
    DeviceMode.dmPelsHeight := Height;
    DeviceMode.dmFields := DM_PELSWIDTH or DM_PELSHEIGHT;
    // check if it's possible to set a given resolution; if so, then...
    if (ChangeDisplaySettingsEx(PChar(@DisplayDevice.DeviceName[0]), 
      DeviceMode, 0, CDS_TEST, nil) = DISP_CHANGE_SUCCESSFUL)
    then
      // change the resolution temporarily (if you use CDS_UPDATEREGISTRY
      // value for the penultimate parameter, the graphics mode will also
      // be saved to the registry under the user's profile; for more info
      // see the ChangeDisplaySettingsEx reference, dwflags parameter)
      Result := ChangeDisplaySettingsEx(PChar(@DisplayDevice.DeviceName[0]),
        DeviceMode, 0, 0, nil) = DISP_CHANGE_SUCCESSFUL;
  end;
end; 
```

如何将辅助显示设备（索引为 1 的设备）的分辨率更改为 800x600 的示例：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  if ChangeMonitorResolution(1, 800, 600) then
    ShowMessage('Resolution of display device with index 1 has been changed!')
  else
    ShowMessage('Display device with index 1 doesn''t exist, doesn''t support ' +
      'resolution 800x600 or changing failed due to a reason, which you might ' +
      'know if the author of this function wouldn''t be so lazy!');
end; 
```

# perl - 提取具有不同分隔符的文本

> ID：15101978
> 
> 赞同：2
> 
> 时间：2013-02-27T00:18:09.303
> 
> 标签：perl, unix, text-files, delimiter

我的文本文件看起来像这样

```
foo.en 14 :: xyz 1;foo bar 2;foofoo 5;bar 9
bar.es 18 :: foo bar 4;kjp bar 2;bar 6;barbar 8 
```

**忽略`::`分隔符之前的文本，是否有一个衬里 unix 命令（允许许多管道）或一个衬里 perl 脚本来提取文本，从而产生由分隔的唯一单词的输出`;`？**：

```
xyz
foo bar
foofoo
bar
kjp bar
barbar 
```

我试过用 python 脚本循环遍历文本文件，但我正在寻找一个单行的任务。

```
ans = set()
for line in open(textfile):
  ans.add(line.partition(" :: ")[1].split(";").split(" ")[:-1])

for a in ans:
  print a 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T00:36:18.413

使用 Perl：

```
perl -nle 's/.*?::\s*//;!$s{$_}++ and print for split /\s*\d+;?/' input 
```

**说明**：

```
s/.*?::\s*//;  # delete up to the first '::' 
```

这部分：

```
!$s{$_}++ and print for split /\s*\d+;?/ 
```

可以这样重写：

```
foreach my $word (split /\s*\d+;?/) {   # for split /\s*\d+;?/
  if (not defined $seen{$word}}) {      # !$s{$_}
    print $word;                        # and print
  }
  $seen{$word}++;                       # $s{$_}++
} 
```

由于 in 的增量`!$s{$_}++`是后增量，Perl 首先测试假条件，然后执行增量。未定义的哈希值具有值`0`。如果测试失败，即`$s{$_}`先前已递增，则**and**部分由于[短路](http://www.perlmonks.org/?node_id=301355)而被跳过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T00:22:12.660

```
cat textfile | sed 's/.*:://g' |  tr '[0-9]*;' '\n' | sort -u 
```

解释：

```
sed 's/.*:://g'      Take everything up to and including `::` and replace it with nothing
tr '[0-9];' '\n'     Replace numbers and semicolon with newlines
sort -u              Sort, and return unique instances 
```

我相信它确实会产生排序的输出......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-27T00:24:41.253

你可以试试这个：

```
$ awk -F ' :: ' '{print $2}' input.txt | grep -oP '[^0-9;]+' | sort -u
bar 
barbar 
foo bar 
foofoo 
kjp bar 
xyz 
```

如果你的短语包含数字，试试这个[perl](/questions/tagged/perl "显示标记为“perl”的问题")正则表达式： `'[^;]+?(?=\s+\d+(;|$))'`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-27T00:33:37.337

只有[awk](/questions/tagged/awk "显示标记为“awk”的问题")：

```
$ awk -F' :: ' '{
    gsub(/[0-9]+/, "")
    split($2, arr, /;/ )
    for (a in arr) arr2[arr[a]]=""
}
END{
    for (i in arr2) print i
}' textfile.txt 
```

还有一个单行版本：

```
 awk -F' :: ' '{gsub(/[0-9]+/, "");split($2, arr, /;/ );for (a in arr) arr2[arr[a]]="";}END{for (i in arr2) print i}' textfile.txt 
```

# javascript - CSS如何修复元素以与页面水平滚动而不是垂直滚动？

> ID：15101989
> 
> 赞同：2
> 
> 时间：2013-02-27T00:19:08.147
> 
> 标签：javascript, html, css

我创建了一个示例来帮助解释。[http://jsfiddle.net/9AUbj/1/](http://jsfiddle.net/9AUbj/1/)

```
<style>
div#one {}
div#two {
    height: 50px;
    background-color: blue;
    width: 1000px;
}
div#three {
    height: 1000px;
}
</style>
...
<div id="one">Hello World!</div>
<div id="two"></div>
<div id="three"></div> 
```

我想要“Hello World！” 当用户水平滚动时随窗口水平移动。但是当用户垂直滚动时，我**不**希望它与窗口一起垂直移动。做这个的最好方式是什么？我正在使用 Bootstrap 和 jQuery UI，以防它们可能有帮助。不过，我也对纯 CSS 解决方案感兴趣。

在此先感谢:-) ktm

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T00:27:05.897

每当您滚动窗口时，将#one 元素重新定位为始终显示在屏幕上。此外，#one 应该是 position: absolute。

```
$(window).scroll(function () {
    $("#one").css({
        left: $(this).scrollLeft()
    });
}); 
```

这是您对新代码的小提琴：http: [//jsfiddle.net/9AUbj/15/](http://jsfiddle.net/9AUbj/15/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T00:29:35.970

虽然我承认纯 CSS 解决方案会很酷，但您不能应用基于轴的定位。使用固定定位的工作方式，即使固定位置元素延伸到外部，您也无法强制在*文档上进行水平滚动。*

然而，用 jQuery 来做这件事*很简单*

```
$(document).on('scroll', function () {
    $("#two").css('top', $(this).scrollTop());
}); 
```

这需要`#two`绝对定位。

[http://jsfiddle.net/9AUbj/16/](http://jsfiddle.net/9AUbj/16/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-04T16:09:54.917

我用了这段代码

```
$(window).scroll(function () {
    $("#one").css({
        left: $(this).scrollLeft()
    });
}); 
```

它在 Chrome 上完美运行，但在 Internet Explorer 上，当我拖动水平滚动时，固定内容开始闪烁:(

# objective-c - 为什么我在运行这个程序时会得到 nan？

> ID：15101995
> 
> 赞同：-1
> 
> 时间：2013-02-27T00:19:53.453
> 
> 标签：objective-c, nan, xcode4.6

我在这里有一个程序可以求解数学方程：（3.31 * 10 到 -8 次方 + 2.01 * 10 到 -7 次方）/（7.16 * 10 到 -6 次方 + 2.01 * 10 到 -8 次方） ...但是，我的输出总是导致 nan！请告诉我原因并帮助我解决它。

```
int a = 10;
    int b = -10;
    //10 to the -8 power below
    float ab = 1 / (a * b * b * b * b * b * b * b) ;
    //10 to the -7 power below
    float ba = 1 / (a * b * b * b * b * b * b) ;
    //10 to the -6 power below
    float abc = 1 / (a * b * b * b * b * b) ;
    //equation below
    double conclusion = (3.31 * ab + 2.01 * ba) / (7.16 * abc + 2.01 * ab);
    NSLog(@"the answer to the equation is %f",conclusion); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:23:42.190

您的表达式被计算为整数。在整数中，1/100 的计算结果为 0。

只需将您的 a 和 b 声明更改为：

```
float a = 10;
float b = -10; 
```

然后所有的计算都将是浮点数，并且将具有您期望的值。

此外，这是以一种相当奇怪的方式计算数字。您不妨将它们作为浮点文字输入`3.31E-8`，例如 3.31 * 10 的 -8 次方。

# css - Flex CSS 不支持对齐操作？

> ID：15101999
> 
> 赞同：0
> 
> 时间：2013-02-27T00:20:21.423
> 
> 标签：css, actionscript-3, apache-flex, styles, stylesheet

我正在使用 Flex 4.9。我认为使用最新的 SDK，他们最终使 Flex 和 CSS 组件标签能够工作。但他们没有。

我尝试将 spark HGroup 的 horisontalAlign 和 verticalAlign 设置为 CSS 样式，这样我就可以顺利管理它并节省一些代码输入。HGroups 没有响应我应用的 CSS 样式，好吧，我想至少我会设置它们的宽度。它也没有工作！也不是像素宽度或百分比值。

Flex CSS 样式真的如此有限还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T01:02:38.333

`horizontalAlign`, `verticalAlign`,`width`和`height`都是HGroup 类的*属性，而不是**样式*。因此，您不能通过样式表设置这些属性。

您似乎缺少的是 Flex 不是 HTML，并且相同的语义不适用。在 Flex 4 中，我们主要通过称为蒙皮的过程将内容与呈现方式分开：我们在一个类中声明组件及其逻辑（通常在 ActionScript 中），并在另一个类中定义其可视表示（通常用 MXML 编写）。
由于这种分离已经到位，几乎不需要样式表。实际上，如果您将 CSS 放在上面，您会人为地尝试将布局分成两个单独的实体，这没有多大意义。更不用说它会使代码更难阅读。

但是，在某些情况下 CSS 会派上用场，即当您想在整个应用程序中应用某种视觉样式时。一个按钮可以有五种不同的皮肤，但通过 CSS，您可以将所有五种的字体颜色设置为特定颜色，而无需在每个皮肤中重复该颜色。