# StackOverflow 问答 14076000-14076999

# php - 试图让 PHP 和数据库一起工作

> ID：14076000
> 
> 赞同：1
> 
> 时间：2012-12-28T21:25:37.547
> 
> 标签：php, mysql

我正在尝试自学如何使用 php 和 mysql。为了练习，我做了一个简单的测试网站，它需要一个用户名和一个密码，以及一个使用 phpmyadmin 和 mysql 的数据库。我能够成功连接到我的数据库，但现在我正试图从我网站上的表单中获取数据并将其插入一个名为“帐户”的表中。帐户具有三个字段：“用户名”、“密码”和“用户 ID”（主键）。用户 ID 应该自动递增，因此该字段不需要输入数据。我编写了我认为会收集用户名和密码并将其作为新记录添加到帐户表中的代码，但我收到一条错误消息：

> **内部服务器错误**
> 
> 服务器遇到内部错误或配置错误，无法完成您的请求。
> 
> 此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。

下面我已经包含了我的代码。我以前从未使用过 PHP 或做过数据库，所以我可能犯了非常明显的错误。

# php_script

```
 <?PHP

    $db_host = "stevie.heliohost.org";
    $db_username = "secret";
    $db_pass = "secret";
    $db_name = "secret";

    $connection = @mysql_connect ("$db_host","$db_username", "$db_pass") 
    or die ("could not connect to mySQL");

    @mysql_select_db("$db_name") or die ("No database");

    $sql="INSERT INTO account(username, password)
    VALUES('$_POST[user]','$_POST[password]')";
    if (!mysql_query($sql,$connection ))
      {die('Error: ' . mysql_error());}
    echo "1 record added";

    mysql_close($con);

?> 
```

# HTML 表格

```
 <form name="LOGIN" action="php_script.php" method="post">

     Username: <input id="username" type="text" name="user">   
     password: <input  id="password" type="text" name="password">
        <input id="submit" type="submit" value="Submit">

  </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:29:55.820

试试这个

```
$db_host = 'stevie.heliohost.org';
$db_username = "secret";
$db_pass = "secret";
$db_name = "secret";

$connection = mysql_connect($db_host,$db_username, $db_pass) 
or die ("could not connect to mySQL");

mysql_select_db($db_name) or die ("No database");

$sql="INSERT INTO account(username, password)
VALUES('".$_POST[user]."','".$_POST[password]."')";
if (!mysql_query($sql,$connection ))
  {die('Error: ' . mysql_error());}
echo "1 record added";

mysql_close($con); 
```

OBS：你应该使用 mysqli 或 PDO ，你的代码很容易进行 sql 注入

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T21:32:29.163

如果您正在自学 PHP，那么您应该做的第一件事就是学习 PDO。因为，您使用 mysql 的方式是让您的网站对 SQL 注入类型的黑客开放，任何人都可以这样做。由于您直接提交`$_POST[''];`数据库中的值。今天开始学习 PDO，它更安全。你可以在这里找到一个很好的教程：[http ://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

此外，请检查此代码，因为我已对其进行了一些修改。和主机名，几乎总是`localhost`

```
 <?PHP

    $db_host = "localhost";
    $db_username = "secret";
    $db_pass = "secret";
    $db_name = "secret";

    $connection = mysql_connect ("$db_host","$db_username", "$db_pass") 
    or die ("could not connect to mySQL");

    mysql_select_db("$db_name") or die ("No database");

    $sql="INSERT INTO account(username, password)
    VALUES('$_POST[user]','$_POST[password]')";
    if (!mysql_query($sql,$connection ))
      {die('Error: ' . mysql_error());}
    echo "1 record added";

    mysql_close($con);

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T21:32:51.170

首先，您不应该使用 mysql_ 函数，因为它们已被弃用。尝试使用 PDO 或喜欢。

第二次试试这个

```
 $db_host = 'stevie.heliohost.org';
 $db_username = "secret";
 $db_pass = "secret";
 $db_name = "secret";

 $connection = mysql_connect($db_host,$db_username, $db_pass) 
  or die ("could not connect to mySQL");

 mysql_select_db($db_name) or die ("No database");

$sql="INSERT INTO account(username, password)
  VALUES('".mysql_escape_string($_POST[user])."','".mysql_escape_string($_POST[password])."')";
if (!mysql_query($sql,$connection ))
   {die('Error: ' . mysql_error());}
 echo "1 record added";

 mysql_close($con); 
```

您也应该在查询中转义您的值，因此它不适合 SQL 注入

我不适合使用 mysql_escape_string 或者你应该使用至少 mysqli

所以通过一个很好的教程来了解更多关于它的信息

# groovy - 使用 groovy 类加载器无法加载 Pdf 文件

> ID：14076002
> 
> 赞同：1
> 
> 时间：2012-12-28T21:25:49.560
> 
> 标签：groovy

使用 groovy 加载文件时出现问题。我的测试数据中有一个`sample.txt`文件和一个 pdf ( `fonts.pdf`) 文件，用于一个项目。它们位于同一路径中。

当我使用下面的代码来获取 txt 文件时，我没有得到 a`NullPointerException`但是当我使用相同的代码来获取 pdf 文件时，我得到了`NullPointerException`.

```
 def String inputFile = 'fonts.pdf'
     GroovyClassLoader classLoader = new GroovyClassLoader()
     return new File(classLoader.getResource(inputFile).path) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:06:57.333

您是否使用带有包名的脚本？以下工作没有任何问题。

```
def String inputFile = 'fonts.pdf'
 GroovyClassLoader classLoader = new GroovyClassLoader()
 print classLoader.getResource(inputFile );
 return new File ( classLoader.getResource(inputFile ).toURI() ) 
```

如果我使用包，则文件名需要具有匹配的包名，并且应该位于适当的运行时位置

```
def String inputFile = 'apackage/fonts.pdf'
 GroovyClassLoader classLoader = new GroovyClassLoader()
 print classLoader.getResource(inputFile );
 return new File ( classLoader.getResource(inputFile ).toURI() ) 
```

无论如何，如果文件是文本或 pdf，我看不出有什么区别

# python - 那是标签列表还是其他？

> ID：14076003
> 
> 赞同：1
> 
> 时间：2012-12-28T21:26:00.590
> 
> 标签：python, nlp, nltk, corpus

我是 NLP 和 NLTK 的新手，我想找到模棱两可的词，意思是至少有`n`不同标签的词。我有这种方法，但输出不仅仅是令人困惑。

代码：

```
def MostAmbiguousWords(words, n):
# wordsUniqeTags holds a list of uniqe tags that have been observed for a given word
wordsUniqeTags = {}
for (w,t) in words:
    if wordsUniqeTags.has_key(w):
        wordsUniqeTags[w] = wordsUniqeTags[w] | set(t)
    else:
        wordsUniqeTags[w] = set([t])
# Starting to count
res = []
for w in wordsUniqeTags:
    if len(wordsUniqeTags[w]) >= n:
        res.append((w, wordsUniqeTags[w]))

return res
MostAmbiguousWords(brown.tagged_words(), 13) 
```

输出：

```
[("what's", set(['C', 'B', 'E', 'D', 'H', 'WDT+BEZ', '-', 'N', 'T', 'W', 'V', 'Z', '+'])),
("who's", set(['C', 'B', 'E', 'WPS+BEZ', 'H', '+', '-', 'N', 'P', 'S', 'W', 'V', 'Z'])),
("that's", set(['C', 'B', 'E', 'D', 'H', '+', '-', 'N', 'DT+BEZ', 'P', 'S', 'T', 'W', 'V', 'Z'])),
('that', set(['C', 'D', 'I', 'H', '-', 'L', 'O', 'N', 'Q', 'P', 'S', 'T', 'W', 'CS']))] 
```

现在我不知道什么`B`，，，，`C`等等`Q`。可以代表。所以，我的问题：

*   这些是什么？
*   他们的意思是什么？（如果它们是标签）
*   我认为它们不是标签，因为`who`并且`whats`没有`WH`指示“wh question words”的标签。

如果有人可以发布包含所有可能标签及其含义的映射的链接，我会很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T00:27:22.170

看起来你有一个错字。在这一行：

```
wordsUniqeTags[w] = wordsUniqeTags[w] | set(t) 
```

你应该有`set([t])`（不是`set(t)`），就像你在`else`案例中所做的那样。

这解释了您所看到的行为，因为`t`它是一个字符串，并且`set(t)`正在从字符串中的每个字符组成一个集合。你想要的是`set([t])`它制作一个`t`以它为元素的集合。

```
>>> t = 'WHQ'
>>> set(t)
set(['Q', 'H', 'W'])    # bad
>>> set([t])
set(['WHQ'])            # good 
```

顺便说一句，您*只需*将该行更改为：

```
wordsUniqeTags[w].add(t) 
```

但是，实际上，您应该使用`setdefault`方法 on`dict`和列表理解语法来整体改进方法。所以试试这个：

```
def most_ambiguous_words(words, n):
  # wordsUniqeTags holds a list of uniqe tags that have been observed for a given word
  wordsUniqeTags = {}
  for (w,t) in words:
    wordsUniqeTags.setdefault(w, set()).add(t)
  # Starting to count
  return [(word,tags) for word,tags in wordsUniqeTags.iteritems() if len(tags) >= n] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T00:53:16.607

您正在将您的 POS 标签拆分为这一行中的单个字符：

```
 wordsUniqeTags[w] = wordsUniqeTags[w] | set(t) 
```

`set('AT')`结果`set(['A', 'T'])`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T20:36:34.197

在 collections 模块中使用 Counter 和 defaultdict 功能怎么样？

```
from collection import defaultdict, Counter

def most_ambiguous_words(words, n):
    counts = defaultdict(Counter)
    for (word,tag) in words:
        counts[word][tag] += 1
    return [(w, counts[w].keys()) for w in counts if len(counts[word]) > n] 
```

# ocaml - ocamlyacc 中的空规则

> ID：14076006
> 
> 赞同：1
> 
> 时间：2012-12-28T21:26:24.240
> 
> 标签：ocaml, yacc

我有以下词法分析器规则：

```
let ws = [' ' '\t' '\n']+
... 
| ws                  {Printf.printf "%s" (Lexing.lexeme lexbuf); WS(Lexing.lexeme lexbuf)} 
```

以及以下解析器规则：

```
%token <string>  WORD WS 
cs               :  LSQRB wsornon choices wsornon RSQRB {$2}
                 ;

wsornon          : /* nothing */
                 | WS {$1}
                 ;

choices          :  choice {$1}
                 |  choices choice {$2}
                 ;

choice           :  CHOICE LCURLYB mainbody RCURLYB {$3}
                 ; 
```

我基本上想`wsornon`匹配空白或什么都没有。但是`cs`在没有空格的情况下给出语法错误（对应于空规则）。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T21:34:27.707

即使你解析空流，你也应该有一个生产规则：

```
wsornon:
  |    { something for nothing }
  | WS { something for whitespace } 
```

请注意，[menhir](http://gallium.inria.fr/~fpottier/menhir/)有一个`OPTION`参数化规则，它对这类事情很好，因此您不必为此编写另一个规则。实际上`OPTION(foo)`，`bar option`如果 rule`foo`返回 type 的内容，则返回 type 的产生式`bar`，而无论如何您都会忽略它们，所以情况有点不同。

如果您想忽略空格，为什么不在词法分析器步骤中完全放弃它呢？它在你语法的其他地方有用吗？我宁愿稍微破解词法分析器，以便在我知道它们很重要的一些标记之后有一些空白标记，而不是让它们污染我的整个语法。当然，menhir 允许定义可以帮助的参数化规则（下面的示例未经测试）：

```
ws(rule):
| LIST(WS) result = rule LIST(WS) { result } 
```

# sql - SQL Server：将两个存储过程结果插入一张表

> ID：14076011
> 
> 赞同：2
> 
> 时间：2012-12-28T21:26:59.083
> 
> 标签：sql, sql-server

我有两个存储过程`sp1`和`sp2`

`sp1`返回结果

```
value1 
------
   1    
   2
   3
   4
   5 
```

`sp2`返回结果

```
value2
------
   4    
   5
   6
   7
   8 
```

我有一个名为的表`test`，它有两列`value1`，`value2`如何在列中插入`sp1`结果并在表中的列中插入结果？`value1``sp2``value2``test`

我正在使用这个

```
 insert into test 
     exec [sp1], exec [sp2] 
```

它导致错误，但它适用于单个值，请单击以下链接

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T21:40:28.797

The only way I can think of is the following:

```
declare @t1 as table (id int identity(1,1), val int);
declare @t2 as table (id int identity(1,1), val int);

insert into @t1 (val)
    exec sp1;

insert into @t2 (val)
    exec sp2;

insert into test
    select t1.val, t2.val
    from @t1 t1 full outer join
         @t2 t2
         on t1.id = t2.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T21:35:01.530

如果这些是函数，您可以执行以下伪代码：

```
first_val = select sp1();  
second_val = select sp2();

insert into test values (first_val,second_val); 
```

这**也可能**有效：

```
insert into test values (select sp1(),select sp2()); 
```

您不能使用过程，因为无法从过程中返回值。

# python - 从列表中删除随机项

> ID：14076013
> 
> 赞同：1
> 
> 时间：2012-12-28T21:27:25.080
> 
> 标签：python, list, random, sample

正如标题所说：如何从列表中删除随机项目？我正在制作基于文本的游戏，我有一个列表，我想从中随机取出一个项目，然后将其从列表中删除，如下所示：

```
Deck = ['Lumina, Lighsworn Summoner', 'Lumina, Lighsworn Summoner', 'Judgment Dragon', 'Judgment Dragon', 'Judgment Dragon', 'Jain, Lightsworn Paladin', 'Ehren, Lightsworn Monk', 'Lyla, Lightsworn Sorceress', 'Lyla, Lightsworn Sorceress', 'Ryko, Lighsworn Hunter', 'Ryko, Lighsworn Hunter', 'Ryko, Lighsworn Hunter', 'Celestia, Lightsworn Angel', 'Aurkus, Lightsworn Druid', 'Garoth, Lightsworn Warrior', 'Garoth, Lightsworn Warrior', 'Lightray Gearfried', 'Lightray Gearfried', 'Lightray Gearfried', 'Lightray Daedalus', 'Lightray Daedalus', 'Lightray Daedalus', 'Lightray Diabolos', 'Lightray Diabolos', 'Lightray Diabolos', 'Sephylon, the Ultimate Timelord', 'Sephylon, the Ultimate Timelord', 'Sephylon, the Ultimate Timelord', 'Card Trooper', 'Card Trooper', 'Honest', 'Gorz the Emissary of Darkness', 'Necro Gardna', 'Necro Gardna', 'Necro Gardna', 'Charge of the Light Brigade', 'Solar Recharge', 'Solar Recharge', 'Solar Recharge', 'Beckoning Light', 'Beckoning Light']
loop = 1
while loop == 1:
    option = raw_input()
    if option == 'draw':
        newcard = random.sample(Deck, 1)
        print newcard
        Deck.remove(newcard) 
```

但是，当我尝试游戏中的“命令”“绘图”时，我总是会收到此输出和与列表相关的错误：

```
draw
['Judgment Dragon']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "YGOGame.py", line 183, in <module>
    Deck.remove(newcard)
ValueError: list.remove(x): x not in list 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T21:31:46.233

`newcard`是一个*列表*（您使用`random.sample(Deck, 1)`，它返回一个列表）；采用：

```
Deck.remove(newcard[0]) 
```

或用于`random.choice()`选择*一个*元素：

```
newcard = random.choice(Deck) 
```

# php - 如何从自身内部的表单重新加载 div？

> ID：14076015
> 
> 赞同：0
> 
> 时间：2012-12-28T21:27:26.350
> 
> 标签：php, ajax, forms, html, reload

我正在开发一个网页，其中有一个主登录页面，该页面有一个加载不同页面的 div；我这样做是为了不重新加载整个页面，但 ajax 只是发出调用以在该 div 中加载不同的页面。我已经有来自主登录页面的呼叫能够重定向 div；但我无法从 div 内部接听电话来重定向 div。

我的问题是在 div 中加载的一个页面上，我有一个表单。我希望该表单在提交时执行一些 php 任务，然后根据结果在 div 中加载不同的页面；但现在发生的是我的整个页面都被刷新了。

我不需要一个确切的答案，只需要一个通用方法和次要代码，例如：如果在这种情况下有人输入“是”并点击输入，则 div 将刷新为“a.php”，如果他们输入“否” div 将刷新为'b.php'；如果他们不输入任何内容，则 div 将使用相同的表单页面重新加载。

一些相关代码将是...登陆页面（在 div 之外）：

```
//all the ajax that handles the reloading
<form>
<select id="ajaxmenu" size="1">
<option value="p1.php">Page 1</option>
<option value="p2.php">Page 2</option>
<option value="p3.php">Page 3</option>
</select>
<input type="button" onClick="ajaxcombo('ajaxmenu', 'contentarea')" value="Go" />
</form>
<div id="contentarea"></div> 
```

form-page (inside div)：一个带有表单的基本 php 页面......我觉得我必须以某种方式改变动作和方法；并可能将 javascript 添加到此页面，但我不确定该怎么做。

```
<form action='' method='POST'>
word:<input type='text' name='value'>
<input type='submit name='submit'> 
```

非常感谢您的宝贵时间; 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:09:25.073

当一切都失败时......建立一个更大的盒子。您已经知道如何使用 jquery 和 ajax 提交页面。我要做的是创建另一个隐藏分区与这个分区相同。使用 ajax 提交表单并将响应返回到另一个部门，只需替换现有的部门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:52:10.390

另一种更简单的解决方案是使用 iFrame。前任：

```
 <iframe src="your_page.php" scrolling="no" frameBorder="0" style="position:absolute;top:0px;left:0px;height:100%;background-color:#ffffff;">
If you are seeing this your browser does not support iFrames.</iframe> 
```

当您在 iFrame 中加载页面时，您的浏览器会完全加载另一个页面，执行/呈现它，然后将生成的 html 导入您的页面；与只导入代码并在导入后在页面内呈现的 div 不同。这非常有用，因为如果您在 iFrame 中有一个页面，并且您单击该页面中的一个链接，它只会使用该新页面重新加载 iFrame。它可以像任何其他页面一样工作；使它更容易，因为即使提交表单数据，您也不需要 AJAX 在页面之间交换。

# javascript - 在保留节点结构和数组的同时修剪 JSON

> ID：14076017
> 
> 赞同：0
> 
> 时间：2012-12-28T21:27:44.580
> 
> 标签：javascript, arrays, json

除了我在不同级别指定的一些属性之外，我如何从我的 JSON 中修剪所有内容，同时保持我的节点结构和数组结构？

我查看了 Underscore.js，似乎它没有那么多细粒度的控制来保留节点结构。在下面的示例中，理想情况下，我希望能够指定`'_id', 'revisions[0]._id', 'revisions[0]._clientHasViewed'`为保留这些属性的参数。

当然有一个简单的方法可以做到这一点。这就是我要找的东西：

**原来的**

```
{
    "_id": "50cbf5214ffaee8f0400000a",
    "_user": "50b1a966c12ef0c426000007",
    "expenses": [],
    "name": "Untitled Project",
    "payments": [],
    "revisions": [
        {
            "_id": "50cbfae65c9d160506000007",
            "clientHasViewed": false,
            "comments": [],
            "dateCreated": "2012-12-15T04:21:58.605Z"
        },
        {
            "_id": "50cbfae65c9d160506000008",
            "clientHasViewed": false,
            "comments": [],
            "dateCreated": "2012-12-15T04:21:58.605Z"
        }
    ],
    "status": "Revised",
    "thumbURL": "/50cd3107845d90ab28000007/thumb.jpg"
} 
```

**修剪过的**

```
{
    "_id": "50cbf5214ffaee8f0400000a",
    "revisions": [
        {
            "_id": "50cbfae65c9d160506000007",
            "clientHasViewed": false,
        },
    ],
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:34:55.727

ExtJs 有一个[copyTo](http://docs.sencha.com/ext-js/4-0/#!/api/Ext-method-copyTo)函数（只有一层），但你可以用 AngularJs 创建类似的东西（angular 有 angular.copy，但它会复制整个对象）：

```
var copyTo = function(dest, source, names){
    names = names.split(/[,;\s]/);

    angular.forEach(names, function(name){
        if(source.hasOwnProperty(name)){
             dest[name] = source[name];
         }
     });
     return dest;
}; 
```

例如

```
var trimmed = copyTo({}, original, '_id,');
    trimmed.revisions = [{}];
    trimmed = copyTo(trimmed.revisions[0], original.revisions[0], '_id,_clientHasViewed,'); 
```

# php - 有趣的 CakePHP 失败！为什么？

> ID：14076021
> 
> 赞同：0
> 
> 时间：2012-12-28T21:27:54.090
> 
> 标签：php, cakephp

使用 cakephp 2.2.4 稳定版我制作了一个高级博客应用程序。

-- 模型是：帖子、用户、视图。

失败有不同的结束方式。有时它以致命错误结束：调用未定义的方法 View::find()，有时会收到脚本试图分配一些字节的错误，有时 chrome 会显示 ERR_CONNECTION_RESET。

查看型号：

```
class View extends AppModel {
public $belongsTo = array(
    'User' => array(
        'className' => 'User',
        'foreignKey' => 'user_id',
        'conditions' => '',
        'fields' => '',
        'order' => ''
    )
);
} 
```

我尝试访问的操作：

```
public function top_today($type = null) {

                $posts = $this->paginate('Post', array('Post.created_time BETWEEN ? AND?' => array(date('Y-m-d'),date('Y-m-d', strtotime("+1 day")))));

                if(!empty($posts)){
                    App::import('Model', 'Rating');
                    App::import('Model', 'View');
                    $rating = new Rating();
                    $view = new View();

                    $i=0;
                        foreach($posts as $post){
                            $plus = $rating->find('count', array('conditions'=>array('Rating.object_type' => 'post', 'Rating.object_id' => $post['Post']['id'], 'Rating.value' => 'plus')));
                            $minus = $rating->find('count', array('conditions'=>array('Rating.object_type' => 'post', 'Rating.object_id' => $post['Post']['id'], 'Rating.value' => 'minus')));
                            $posts[$i]['Post']['rating'] = $plus-$minus;

                            $views = $view->find('count', array('conditions'=>array('View.object_type' => 'post', 'View.object_id' => $post['Post']['id'])));
                            $posts[$i]['Post']['views'] = $views;
                            $i++;
                        }

                }
                $this->set('posts',$posts);

    } 
```

当我不计算观看次数时一切顺利，但与评分算法相同！

View 表具有以下列：id (A_I) user_id object_id object_type created_time。

错误日志还写了很多行：

2012-12-28 22:13:31 错误：致命错误（256）：[PDOException] SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获得在第 1 行**的“渲染”附近使用的正确语法**

0 D:\xampp\htdocs\lib\Cake\Model\Datasource\DboSource.php(459): PDOStatement-execute(Array)

1 D:\xampp\htdocs\lib\Cake\Model\Datasource\DboSource.php(425): DboSource->_execute('render', Array)

2 D:\xampp\htdocs\lib\Cake\Model\Datasource\DboSource.php(669): DboSource->execute('render', Array, Array)

3 D:\xampp\htdocs\lib\Cake\Model\Datasource\DboSource.php(611): DboSource->fetchAll('render', Array, Array)

4 D:\xampp\htdocs\lib\Cake\Model\Model.php(788): DboSource->query('render', Array, Object(View))

5 D:\xampp\htdocs\lib\Cake\Error\ExceptionRenderer.php(300): 模型->__call('render', Array)

6 D:\xampp\htdocs\lib\Cake\Error\ExceptionRenderer.php(300): 查看->render('error500', 'error')

7 D:\xampp\htdocs\lib\Cake\Error\ExceptionRenderer.php(281): ExceptionRenderer->_outputMessageSafe('error500')

8 D:\xampp\htdocs\lib\Cake\Error\ExceptionRenderer.php(195): ExceptionRenderer->_outputMessage('fatalError')

9【内部函数】：ExceptionRenderer->_cakeError(Object(FatalErrorException))

10 D:\xampp\htdocs\lib\Cake\Error\ExceptionRenderer.php(173): call_user_func_array(Array, Array)

11 D:\xampp\htdocs\lib\Cake\Error\ErrorHandler.php(126): ExceptionRenderer->render()

12【内部函数】：ErrorHandler::handleException(Object(FatalErrorException))

最多重复 100 次 {

13 D:\xampp\htdocs\lib\Cake\Error\ErrorHandler.php(211): call_user_func('ErrorHandler::h...', Object(FatalErrorException))

14 D:\xampp\htdocs\lib\Cake\Error\ErrorHandler.php(161): ErrorHandler::handleFatalError(256, '[PDOException] ...', 'D:\xampp\htdocs...', 135 )

15 [内部函数]: ErrorHandler::handleError(256, '[PDOException] ...', 'D:\xampp\htdocs...', 135, Array)

16 D:\xampp\htdocs\lib\Cake\Error\ErrorHandler.php(135): trigger_error('[PDOException] ...', 256)

}

我在这个问题上停留了 2 天。

PS：我在 xampp 上，尝试过 PHP 5.3.8.1 和 5.4.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T06:02:05.150

问题可能是`View`模型的名称，因为 CakePHP 已经包含一个`View`类。重命名您的模型（和相应的表）应该可以解决问题。

# java - GAE - Java 中的持久 http 会话（浏览器/实例重启）

> ID：14076022
> 
> 赞同：0
> 
> 时间：2012-12-28T21:27:54.373
> 
> 标签：java, google-app-engine, servlets

我想知道是否有一种“标准”方式来处理基于 GAE 的 Web 应用程序中的持久 HTTP 会话。让我解释一下我的问题。

如果我只使用 this.getThreadLocalRequest().getSession() 来获取会话，一旦用户关闭浏览器，该会话就会自动失效。

如果我使用 Cookies（因此会话将持续到 cookie 过期或用户删除他的 cookie），我需要有一种机制来验证存储在 cookie 中的 sessionID 实际上属于有效会话。我曾考虑将 sessionID 的键值对 HttpSession 存储在 concurrentHashMap 中，但现在我遇到了这个 hashmap 仅可用于当前实例的问题，因此我可能会遇到一致性问题。

我想到的最后一个解决方案是跟踪数据存储中的会话，但每次收到请求时都必须查询数据存储，这对我来说似乎很荒谬。

也许我完全脱离了轨道，并且有一种非常简单的方法可以实现我想要做的事情：在浏览器重启和多个 gae 实例中持续存在的 Http 会话。

谢谢！罗德里戈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:19:18.650

您通常使用 cookie 来实现记住我。这个想法是为经过身份验证的用户生成一个随机且唯一的 cookie，将其与其余用户信息一起存储在数据库中，并将 cookie 发送到客户端浏览器。

现在，当客户端在 5 天后返回时，cookie 会与它的第一个请求一起发送到您的应用程序。这时，如果用户还没有被认证，你可以从请求中提取cookie，在数据库中找到拥有这个cookie的用户，并自动认证他，就像他发送了他的凭据一样。

此解决方案不需要对 GAE 处理会话的方式进行任何修改。

# jquery-datatables - 如果我在 DataTables 中使用自定义排序功能，如何更改排序顺序（从默认 ASC 到 DESC）？

> ID：14076024
> 
> 赞同：0
> 
> 时间：2012-12-28T21:28:20.390
> 
> 标签：jquery-datatables

我需要在 DataTables 网格中按日期 (dd.mm.YYYY H:i:s) 执行排序。

我已经找到了 DataTables 排序插件，它运行良好 - 但我无法理解如何将默认排序顺序更改为降序排序插件结果。

我使用以下代码初始化数据表：

```
 $('.dt_table').dataTable( {
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "sPaginationType": "bootstrap",
        "aoColumns": [
                { "sType": "date-euro" },
         null,
         null,
         null,
         null,
         null,
         null
     ],
        "iDisplayLength": 25,
        "oLanguage": {
        "sUrl": "/js/dt_ru.txt"
        },
        "fnDrawCallback": function() {
                $(".editable").editable();
        }
} ); 
```

排序插件的代码在这里：

```
jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "date-euro-pre": function ( a ) {
        if ($.trim(a) != '') {
            var frDatea = $.trim(a).split(' ');
            var frTimea = frDatea[1].split(':');
            var frDatea2 = frDatea[0].split('.');
            var x = (frDatea2[2] + frDatea2[1] + frDatea2[0] + frTimea[0] + frTimea[1] + frTimea[2]) * 1;
        } else {
            var x = 10000000000000; // = l'an 1000 ...
        }

        return x;
    },

    "date-euro-asc": function ( a, b ) {
        return a - b;
    },

    "date-euro-desc": function ( a, b ) {
        return b - a;
    }
} ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T12:28:52.263

使用`aaSorting`选项指定排序方式：[http](http://datatables.net/ref#aaSorting) ://datatables.net/ref#aaSorting 。

```
$('.dt_table').dataTable( {
    "aaSorting": [[0, 'desc']]
} ); 
```

# c# - IIS 上托管的 asmx 服务下的长时间运行任务

> ID：14076025
> 
> 赞同：0
> 
> 时间：2012-12-28T21:28:24.523
> 
> 标签：c#, iis, asmx

我有一些旧版 ASMX IIS 托管服务。客户端应用程序订阅或取消订阅 Web 服务。通过 Web 服务逻辑的一些内部，它需要定期向订阅的应用程序发送消息。

完成长时间运行任务的最佳方法是什么？我了解在 IIS 下使用长时间运行的任务打开线程不是一个好主意。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:44:58.143

ASMX 服务无法满足您的要求：它们不能仅仅决定向客户端发送消息。他们所能做的就是在客户请求时做出响应。

您可以四处寻找一种方法来启动长时间运行的任务，以及另一种方法来轮询任务的状态。这行得通，但它可能很昂贵。

更好的模型是在单独的 Windows 服务中执行长时间运行的任务。让该服务托管一个仅由主服务（与客户端对话的服务）使用的简单 WCF 服务。主 (WCF) 服务将使用双工通道与客户端进行通信。这样，只要有关于其中一项长期运行任务的消息，它就可以“呼叫”客户端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T21:47:42.787

通常在这种情况下，当您没有办法将结果推回时，为长时间运行的任务创建一个唯一 ID 并将其发送回客户端，然后运行任务并在数据库或其他地方有一个表您存储任务的状态。客户端将定期拉取服务以通过给定 ID 查看任务的状态。一旦发现任务完成，它将检索结果。并且在 IIS 中运行一个线程来完成它的工作是完全可以的。

# php - 合并 PDF 的内存

> ID：14076026
> 
> 赞同：-2
> 
> 时间：2012-12-28T21:28:25.747
> 
> 标签：php, pdf, pdf-generation, fpdf, fpdi

我偶然发现了这个问题。我根据客户选择的 PDF 将多个 PDF 文件合并为一个。

如果我选择最小尺寸的 PDF 并合并它可以正常工作，但只要它稍大一点，比如大约 1MB，我就会收到致命错误：允许的 xxxxxx 字节的内存大小已用尽（试图分配 xxxx）。

我知道它是一个 php.ini 问题，只是把它放得更高，但我不能改变它，除非我支付一个 bussniess 帐户......

是否有任何解决方法，例如降低 PDF 质量大小然后再提高它？我真的不知道该怎么办：S

您可以在这里自己尝试：pdf.devharis.com

选择最便宜的两个并订购它们...，然后尝试更大的它崩溃...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T21:40:07.903

I'm not going to try that site because I'm not going to give you my information and I don't read whatever language that is, but I will try to answer your question.

Altering PDFs is an intensive task, if you are using cheap hosting, then it's time to upgrade. Also knowing how much memory you're allowed would be beneficial.

# php - 表单处理的初学者困难 - 无法将数据发布到 MySQL DB

> ID：14076028
> 
> 赞同：0
> 
> 时间：2012-12-28T21:28:30.173
> 
> 标签：php, mysql, sql, database

这是我第一次尝试创建表单。当我单击提交时，表中没有添加任何记录。

我在这里不明白什么？（我不只是想要答案！）

```
 <?php

 require_once 'login.php';
 $db_server = mysql_connect($db_hostname, $db_username, $db_password);

if (!$db_server) die("Unable to connect to MySQL: " . mysql_error());

mysql_select_db($db_database, $db_server)
or die("Unable to select database: " . mysql_error());

if (
isset($_POST['store_id']) &&
isset($_POST['item_title']) &&
isset($_POST['date']) &&
isset($_POST['price'])
)

{

$store = get_post('store_id');
$item = get_post('item_title');
$date = get_post('date');
$price = get_post('price');

$query = "INSERT INTO competitors VALUES('$store', '$item', '$date', '$price')";

if(!mysql_query($query, $db_server))
    echo "INSERT failed: $query<br/>" .
    mysql_error() . "<br/><br/>";

} 

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:34:04.917

1）你需要切换到PDO或MySQLi。这些例程已被弃用。
2）尝试将您的 $query 更改为

> $query = "插入竞争对手 VALUES('" . $store. "', '" . $item . "', '" . $date . "', '" . $price . "')";

3）阅读准备好的陈述。这种方法使您容易受到注入攻击。

# ruby - 使用主机的环境变量作为主厨属性（vagrant）——如何管理密码？

> ID：14076029
> 
> 赞同：2
> 
> 时间：2012-12-28T21:28:30.200
> 
> 标签：ruby, chef-infra, vagrant

在主机上，我有这样的东西：

```
export SOME_USER=foo
export SOME_PASSWORD=password 
```

我想将主机的一些环境变量转换为attributes/default.rb中的属性：

```
user = ENV["SOME_USER"]
password = ENV["SOME_PASSWORD"]
node.default["some"]["url"] = "http://#{user}:#{password} ..." 
```

但是，`ENV`这是来宾操作系统的`ENV`。我可以在属性文件中访问我的主机环境吗？

更广泛地说，在厨师中定义用户/密码而不在任何地方检查密码的首选方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:26:07.057

最好的方法是使用加密的数据包。

基本上，您将值存储在厨师服务器上，并使用密钥加密。您将此密钥提供给需要这些值的节点，它们可以下载和解密这些值，从而获取密码。这不仅可以防止签入纯文本密码，还可以确保密码在网络上也被加密。

阅读更多相关信息：[http ://wiki.opscode.com/display/chef/Encrypted+Data+Bags](http://wiki.opscode.com/display/chef/Encrypted+Data+Bags)

# sharepoint-2010 - Sharepoint Webpart 上的用户控制按钮未触发

> ID：14076030
> 
> 赞同：1
> 
> 时间：2012-12-28T21:28:33.713
> 
> 标签：sharepoint-2010, user-controls, buttonclick

我有一个按钮，我正在将它添加到一个用户控件（.ascx）中，该按钮作为 web 部件显示在 sharepoint 中。

```
<asp:Button ID="btnCCA_UserAdministration_NewUser" runat="server" Text="Request User" OnClick="btnCCA_UserAdministration_NewUser_Click" > 
```

但是按钮单击操作不会触发：

```
protected void btnCCA_UserAdministration_NewUser_Click(object sender, EventArgs e)
        {
            btnCCA_UserAdministration_NewUser.Visible = false;

        } 
```

我没有收到任何错误消息或任何东西。onload 事件似乎工作正常。关于我做错了什么有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T12:37:26.953

我们需要更多的 .ascx 代码，并尝试在解决方案中更改“到任何 CPU”

# php - 在 Ajax 调用中使用 PHP 数组

> ID：14076036
> 
> 赞同：0
> 
> 时间：2012-12-28T21:29:17.710
> 
> 标签：php, jquery, ajax

我是编程新手，我正在玩 htm/ajax/php。我有两个文本字段，名称和动物。您在名称字段中输入名称。如果名称存在于数据库中，它会返回与该名称相关的所有动物，并且不允许在动物字段中输入重复的动物。我正在使用[LiveValidation](http://livevalidation.com/)进行验证。

到目前为止，我的名称字段工作正常。它正在检查数据库并返回与该名称关联的所有动物的逗号分隔列表，并将它们插入结果 div。然而，结果 div 仅用于测试。我想要的是结果列表在此处填充列表：

```
//animal must not include
var animal = new LiveValidation('animal');
animal.add(Validate.Exclusion, { 
    within: [
    // Insert ajax results here
    'cow' , 'pigeon', 'giraffe',
    ] 
} ); 
```

这是我的其余代码。我认为我想做的事情相当简单，我只是不知道该怎么做。感谢任何花时间帮助我的人。

**HTML**

```
<input type="text" id="name" name="name"/>
<input type="text" id="animal" name="animal" />
<div class="results"></div> 
```

**JavaScript**

```
<script>
    //ajax call
    $(function(){

        $('#name').blur(function(){
            var inpval = $('#name').val();

            $.ajax({
                type: 'POST',
                data: ({name : inpval}),
                url: 'name_taken.php',
                success: function(data) {
                    $('.results').html(data);
                }
            });
        });
    });

    //validation from livevalidation.com
    //name must be present
    var name = new LiveValidation('name');
    name.add(Validate.Presence);

    //animal must not include
    var animal = new LiveValidation('animal');
    animal.add(Validate.Exclusion, { 
        within: [
            // How do I insert ajax results here?
            'cow' , 'pigeon', 'giraffe',
        ] 
    } );
</script> 
```

**PHP**

```
//name_taken.php
$input_name = trim($_POST['name']);

foreach($names_table as $row){
    $name = $row['name'];

    if($name == $input_name){
        echo $row['animal'] . ',';
    }
} 
```

**表结构**

```
//$names_table
| 1 | Dave | animal1 |
| 2 | Mark | animal2 |
| 3 | Dave | animal3 | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T21:37:16.573

with your ajax function you can use `dataType` to set the return data type

```
//animal must not include
var animal = new LiveValidation('animal');
var obj = { 
    within: [
        'cow' , 'pigeon', 'giraffe',
    ] 
};
animal.add(Validate.Exclusion,  obj);

$.ajax({
    type: 'POST',
    data: ({name : inpval}),
    dataType: 'json',
    url: 'name_taken.php',
    success: function(data) {
        obj.within = new Array();
        for(var i in data){
            obj.within.push(data[i]);
        }
        animal.add(Validate.Exclusion,  obj);
    }
}); 
```

then in your php you just need to use `json_encode()` like this:

```
<?php
$array = array(1,2,3,4,5,6);
echo json_encode($array); 
```

# jquery - 来自选择选项的jQuery内部html

> ID：14076038
> 
> 赞同：0
> 
> 时间：2012-12-28T21:29:25.997
> 
> 标签：jquery

我正在用 jquery 编写一个花哨的选择框，并且遇到了一个小问题。

[http://jsfiddle.net/kYhXn/](http://jsfiddle.net/kYhXn/)

```
<select>
    <option>
        Shocka <br> Zooloo
     </option>
</select>​

alert($('option').html()+'');​ 
```

无论出于何种原因，该`<br>`标签都不会显示在警报中！如何获取带有`br`标签的 html？

纯 js [http://jsfiddle.net/z4Wb9/](http://jsfiddle.net/z4Wb9/)同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:36:54.640

如果您想要一种解决方法 - 您可以使用不可见字符*“ `ALT+255`”*或“ ”并执行替换：

```
//In the replace function, use the ' ' character and not just a space.
alert($('option').val().replace(' ','\n'));​ 
```

或者，如果您想用新行替换 ALT+255 字符的每个实例，您可能想使用：

```
alert($('option').val().replace(new RegExp(' ',g),'\n')); 
```

显然这不是非常可取的，但是它应该可以满足您的需求。

**[例子](http://jsfiddle.net/kYhXn/2/)**

## **解决方法第 2 部分**

`(null)`如前所述，而不是使用字符。尝试使用该`&ensp;`字符作为您的标记来执行替换，如下所示：

```
 <option>
    Shocka&ensp;Zooloo
 </option> 
```

您可以复制 this 的内容`( )`以访问字符及其位置作为替换函数中的第一个参数。

```
//The character being replace is NOT a normal space
alert($('option').val().replace(' ','\n'));​ 
```

**[示例第 2 部分](http://jsfiddle.net/kgUku/2/)**

# php - 向同一页面添加 sql 函数？

> ID：14076042
> 
> 赞同：0
> 
> 时间：2012-12-28T21:29:33.130
> 
> 标签：php, mysql

我把这个脚本放在了一个链接文件 favorite.php 中。

当用户从页面 profile.php 中单击用户配置文件上的添加到收藏夹时，它将链接到 favorite.php 并运行 sql 查询。

有没有办法我现在可以将此脚本添加到 profile.php 页面，以便它在同一页面 (profile.php) 上回显消息。

当我只是复制并粘贴脚本时，它会清除 profile.php 页面的全部内容并说找不到用户。

有人可以告诉我我需要做什么。谢谢

```
<?php

require_once('includes/session.php');
require_once('includes/functions.php');
require('includes/_config/connection.php');

session_start();

    confirm_logged_in();

    if (isset ($_GET['to'])) {
    $user_to_id = $_GET['to'];

}

if (!isset($_GET['to']))
    exit('No user specified.');

$user_id = $_GET['to'];

$result = mysql_query("INSERT INTO ptb_favorites (user_id, favorite_id) VALUES (".$_SESSION['user_id'].", ".$user_to_id.")") 
or die(mysql_error()); 

echo "<div class=\"infobox-profile\"><strong>This is your profile</strong> - to edit now <a href=\"account_settings.php\">click here</a></div>";

?> 
```

ps 我会为 profile.php 添加代码，但前提是您必须知道该页面的布局方式，因为该页面上的代码太多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:32:10.893

看来您需要了解`require`和`include`。这是在应用程序的多个位置运行一组通用代码的最佳方式。

[http://php.net/manual/en/function.include.php](http://php.net/manual/en/function.include.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T21:55:15.193

在您的查询中 $results 是一个未使用的变量。您需要检查 $results 的条件以确定您将向用户显示的内容。

如果您问如何向用户显示结果，则向用户回显除法。您可以使用 jquery 从您的个人资料页面调用此脚本并返回结果，而无需刷新页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T02:07:11.603

就像 Mike Brant 所说的使用`include`or`require`语句。我建议您不要使用functions.php，而是看一下OOP（面向对象编程）。我还建议您使用 PDO 而不是 mysql_* 函数。

# python - 使用方法名称的金字塔遍历视图查找

> ID：14076046
> 
> 赞同：1
> 
> 时间：2012-12-28T21:29:51.187
> 
> 标签：python, pyramid

在金字塔中使用遍历 url 查找时，是否可以让视图查找算法检查类的方法名称。例如，我可以这样做：

```
@view_defaults(context=models.Group)
class GroupView(object):
    def __init__(self, context, request):
        self.context = context
        self.request = request

    @view_config(name='members')
    def members(self):
        pass 
```

匹配让我们说*/groups/somegroup/members*

有没有办法使名称查找部分动态化？也就是说，像这样：

```
@view_defaults(context=models.Group)
class GroupView(object):
    def __init__(self, context, request):
        self.context = context
        self.request = request

    def members(self):
        pass

    def add(self):
        pass 
```

这样*/groups/somegroup/members*和*/groups/somegroup/add*都将解析为各自的类方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:54:19.407

不能说这是`best`路（我对金字塔一无所知）；但一种选择可能是仅使用装饰器来装饰类，该装饰器适当地装饰方法名称。例如。

```
import inspect

def config_wrap(func, name):
    @view_config(name=name)
    def wrapped(*args, **kwargs):
        return func(*args, **kwargs)
    return wrapped

def dynamic_names(cls):
    for name, m in inspect.getmembers(cls, inspect.ismethod):
        setattr(cls,name,config_wrap(m, name))
    return cls

@dynamic_names
@view_defaults(context=models.Group)
class GroupView(object):
    def __init__(self, context, request):
        self.context = context
        self.request = request

    def members(self):
        pass

    def add(self):
        pass 
```

# android - 可滑动标签并以编程方式添加它们

> ID：14076052
> 
> 赞同：3
> 
> 时间：2012-12-28T21:30:11.653
> 
> 标签：android

目前，我有一个充满数据的 ListView，当一个项目被选中时，一个新的活动被打开。

我想更改这一点，以便在选择项目时，应添加具有特定标题的新选项卡，并且该选项卡下方显示活动，我还希望用户能够在选项卡之间滑动。

在查看 android 开发网站后，我发现[https://developer.android.com/design/building-blocks/tabs.html#scrollable](https://developer.android.com/design/building-blocks/tabs.html#scrollable)显示了 Play Store 应用程序的示例以及它们在那里的可滚动标签。但是，我找不到任何可以设置的示例，而且我可以以编程方式添加选项卡。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:34:22.627

[TheNewBoston](http://thenewboston.org/watch.php?cat=6&number=86)如果你迷路了，你可能想去一些教程回到这个[列表](http://thenewboston.org/list.php?cat=6)
中的 84 在 旁注中，你考虑过片段和浏览器吗？

# c# - 如何在 C# 中将数据列表视图保存到 .txt 中，以便下次打开表单时可以访问它？

> ID：14076055
> 
> 赞同：0
> 
> 时间：2012-12-28T21:30:22.943
> 
> 标签：c#, string, listview, save

如何将数据保存在列表视图中？

例如，如果用户在列表视图中放入了一些东西，然后关闭了应用程序，那么所有这些信息都会丢失。有什么方法可以在他们将某些内容放入 listView 后立即保存信息？

这是我用来将信息从文本框输入到 listView1 的代码：

```
 string[] items = { titletxt.Text, statustxt.Text };
        ListViewItem lvi = new ListViewItem(items);
        listView1.Items.Add(lvi); 
```

更新（2012 年 12 月 29 日）

感谢所有的帮助！但我似乎无法让它工作。我创建了一个非常简单的表单来尝试让它工作。它有 3 个文本框（NameTxt、AgeTxt、HairColourTxt）、一个按钮和列表视图（ListOfPeople）。

这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace listview
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            string[] items = { NameTxt.Text, AgeTxt.Text, HairColourTxt.Text };
            ListViewItem lvi = new ListViewItem(items);
            ListOfPeople.Items.Add(lvi);
        }
    }
} 
```

我试图添加@user574632 & @Joe & @DmitryKvochkin 发布的代码，我已经更改了位，但仍然无法让它工作。我不确定我做错了什么？我试图添加这个：

```
 private void saveListOfPeopleItems(string path, ListView lv)
    {
        var delimeteredListviewData = new List<string>();

        foreach (ListViewItem lvi in lv.Items)
        {
            string delimeteredItems = string.Empty;
            foreach (ListViewItem.ListViewSubItem lvsi in lvi.SubItems)
            {
                delimeteredItems += lvsi.Text + "#";
            }
            delimeteredListviewData.Add(delimeteredItems);
        }

        System.IO.File.WriteAllLines(path, delimeteredListviewData.ToArray());
    }

    private void loadListOfPeopleItems(string path, ListView lv)
    {

        foreach (string line in System.IO.File.ReadAllLines(path))
        {
            lv.Items.Add(new ListViewItem(line.Split(new char[] { '#' }, StringSplitOptions.RemoveEmptyEntries)));
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:40:19.747

您需要创建保存逻辑，没有自动方法。

最简单的方法是使用`Serialization`（查找`ISerializable`）保存到您选择的文件中（随意命名）：您可以通过这种方式保存整个对象。[这是一个关于序列化的简单教程。](http://www.codeproject.com/Articles/1789/Object-Serialization-using-C)

另一种方法是将列表视图内容解析为字符串（仅保留您需要的内容），然后将字符串保存到文本文件（`TextReader`和`TextWriter`）。

如果您想保存应用程序设置（而不是用户数据），请查看[此链接](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)，或者[此](http://www.codeproject.com/Articles/17659/How-To-Use-the-Settings-Class-in-C)链接可能更易于阅读。

最后，如果您需要与定期保存的数据进行交互，或者如果您有大量数据要存储，请使用数据库（SQL、mySQL 等）。后一种方法是实现时间最长的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:55:55.963

如果要保存到文本文件，可以使用以下内容：

```
 private void saveListViewItems(string path, ListView lv)
    {
        var delimeteredListviewData = new List<string>();

        foreach (ListViewItem lvi in lv.Items)
        {
            string delimeteredItems = string.Empty;
            foreach (ListViewItem.ListViewSubItem lvsi in lvi.SubItems)
            {
                delimeteredItems += lvsi.Text + "#";
            }
            delimeteredListviewData.Add(delimeteredItems);
        }

        System.IO.File.WriteAllLines(path, delimeteredListviewData.ToArray());
    }

    private void loadListViewItems(string path, ListView lv)
    {

        foreach (string line in System.IO.File.ReadAllLines(path))
        {
            lv.Items.Add(new ListViewItem(line.Split(new char[]{'#'}, StringSplitOptions.RemoveEmptyEntries)));
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T21:59:41.500

您可以使用集成的 Visual Studio 设置并将其绑定到您的列表视图，即使在设计器中也是如此。更改列表视图后，您可以保存它们

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-28T21:33:16.947

我会说答案是：使用 .txt 文件您也可以创建一个 SQL 数据库，并将其保存在那里...

# mysql - 从 SELECT 中插入每个 id

> ID：14076062
> 
> 赞同：1
> 
> 时间：2012-12-28T21:30:51.783
> 
> 标签：mysql, wordpress

我刚刚从另一个 CMS 将用户添加到我的 Wordpress 安装中，现在我需要为每个用户 ID`wp_users`插入带有其 ID 的新值到`wp_usermeta`. SQL中对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:35:02.670

您可以使用 SELECT 语句作为 INSERT 值的来源，如下所示：

```
INSERT IGNORE INTO wp_usermeta (id)
SELECT u.id FROM wp_users u 
```

IGNORE 关键字告诉 MySQL 插入它可以插入的行，如果我们尝试插入的任何行是“重复”行（抛出异常），那么就让这些行不被插入，并忽略否则会抛出的错误.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T21:39:18.050

试试这个 ：

```
INSERT INTO wp_usermeta(id)
SELECT id FROM wp_users; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T21:39:21.450

利用单引号字符串文字，您可以使用[`INSERT INTO ... SELECT`](http://dev.mysql.com/doc/refman/5.5/en/insert-select.html)语法同时从中选择所有用户 ID`wp_users`并将字符串值插入`wp_usermeta`：

```
INSERT INTO wp_usermeta (user_id, meta_key, meta_value) 
  SELECT
    wp_users.ID, 
   /* Single-quoted string literals for meta key and value... */
   /* Substitute the key and value you want to insert */
   'new_meta_keyname', 
   'new_meta_value' 
  FROM wp_users 
```

# sass - Sass 中 @keyframes 前缀的插值

> ID：14076063
> 
> 赞同：6
> 
> 时间：2012-12-28T21:30:53.013
> 
> 标签：sass

我正在尝试通过使用这样的 Sass 循环生成我自己的前缀版本来解决[Bourbon](http://bourbon.io/)不支持的问题：`@keyframe`

```
$list: '' -ms- -webkit- -moz- -o-
$at: @  //at sign
@each $prefix in $list

  #{$at}#{$prefix}keyframes moveclouds
    from
      #{$prefix}transform: translateX(2400px)
    to
      #{$prefix}transform: translateX(-400px) 
```

并期望生成css：

```
@keyframes moveclouds from {
  transform: translateX(2400px);
}
@keyframes moveclouds to {
  transform: translateX(-400px);
}

@-moz-keyframes moveclouds from {
  -moz-transform: translateX(2400px);
}
@-moz-keyframes moveclouds to {
  -moz-transform: translateX(-400px);
}
.... 
```

问题是我无法弄清楚如何在行首强制 Sass 输出`@`（在符号处）

如果我做

```
$at: @    // wont work, error
$at: \@   // will generate  \@keyframes = not good
$at: "\@" // wont work error
$at: @@   // will generate  @@keyframes = not good 
```

所以有人知道如何在 Sass 登录时输出吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T21:56:50.793

这根本不可能使用变量插值。您可以像这样绕过`@`作业：

```
$at: unquote("@"); // either of these will work
$amp: #{"@"}; 
```

但是你最终会遇到这个错误：

> 错误 sass/test.scss（第 4 行：“”之后的无效 CSS：预期的 selector_comma_sequence，是“@-ms-keyframes ...”）

目前不支持插值`@keyframes`，但将来会支持。您可以[在 GitHub 上跟踪该进度](https://github.com/sass/sass/issues/429)。同时，您必须手动写出关键帧信息。一个简单的示例如下所示：

```
@mixin keyframes($name) {
    @-webkit-keyframes #{$name} {
        @content;
    }

    @keyframes #{$name} {
        @content;
    }
} 
```

用法：

```
@include keyframes(foo) {
    0% {
        color: red;
    }

    100% {
        color: blue;
    }
} 
```

[在Eric Meyer 的 Sass 动画库](https://github.com/ericam/compass-animation/blob/master/stylesheets/animation/_core.scss)中可以找到更复杂的示例。

# r - 在双错误类型的连接列中使用 NA 的 data.table 内部/外部连接？

> ID：14076065
> 
> 赞同：11
> 
> 时间：2012-12-28T21:31:07.297
> 
> 标签：r, inner-join, data.table, outer-join

在这篇维基百科文章[SQL join](http://en.wikipedia.org/wiki/Join_%28SQL%29)之后，我想清楚地了解我们如何与 data.table 进行连接。在这个过程中，我们可能在加入 NA 时发现了一个错误。以维基为例：

```
R) X = data.table(name=c("Raf","Jon","Ste","Rob","Smi","Joh"),depID=c(31,33,33,34,34,NA),key="depID")
R) Y = data.table(depID=c(31,33,34,35),depName=c("Sal","Eng","Cle","Mar"),key="depID")
R) X
   name depID
1:  Joh    NA
2:  Raf    31
3:  Jon    33
4:  Ste    33
5:  Rob    34
6:  Smi    34
R) Y
   depID depName
1:    31     Sal
2:    33     Eng
3:    34     Cle
4:    35     Mar 
```

* * *

**左外连接**

```
R) merge.data.frame(X,Y,all.x=TRUE)
  depID name depName
1    31  Raf     Sal
2    33  Jon     Eng
3    33  Ste     Eng
4    34  Rob     Cle
5    34  Smi     Cle
6    NA  Joh    <NA> 
```

`merge.data.table`不要输出相同的结果并显示我认为是 lign 2 上的错误。

```
R) merge(X,Y,all.x=TRUE)
   depID name depName
1:    NA  Joh     Eng
2:    31  Raf      NA
3:    33  Jon     Eng
4:    33  Ste     Eng
5:    34  Rob     Cle
6:    34  Smi     Cle
R) Y[X] #same -> :(
   depID depName name
1:    NA     Eng  Joh
2:    31      NA  Raf
3:    33     Eng  Jon
4:    33     Eng  Ste
5:    34     Cle  Rob
6:    34     Cle  Smi 
```

* * *

**RIGHT OUTER JOIN** 看起来一样

```
R) merge.data.frame(X,Y,all.y=TRUE)
  depID name depName
1    31  Raf     Sal
2    33  Jon     Eng
3    33  Ste     Eng
4    34  Rob     Cle
5    34  Smi     Cle
6    35 <NA>     Mar

R) merge(X,Y,all.y=TRUE)
   depID name depName
1:    NA  Joh     Eng
2:    31   NA     Sal
3:    33  Jon     Eng
4:    33  Ste     Eng
5:    34  Rob     Cle 
6:    34  Smi     Cle
7:    35   NA     Mar 
```

* * *

**内部（自然）加入**

```
R) merge.data.frame(X,Y)
  depID name depName
1    31  Raf     Sal
2    33  Jon     Eng
3    33  Ste     Eng
4    34  Rob     Cle
5    34  Smi     Cle
R) merge(X,Y)
   depID name depName
1:    NA  Joh     Eng
2:    33  Jon     Eng
3:    33  Ste     Eng
4:    34  Rob     Cle
5:    34  Smi     Cle 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T23:16:59.257

是的，它看起来像是一个与键中的 NA 相关的（令人尴尬的）新错误。还有其他关于 NA in key 的讨论是不可能的，但我没有意识到它会以这种方式搞砸。会调查。谢谢 ...

[#2453 双键列中的 NA 混淆了连接（整数和字符中的 NA ok）](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=2453&group_id=240&atid=975)

现在在 1.8.7（提交 780）中修复，来自 NEWS：

> double 类型的连接列中的 NA 可能导致 X[Y] 和 merge(X,Y) 返回不正确的结果，#2453。由于 C 源代码中的错误 x==NA_REAL 应该是 ISNA(x)。对双键连接的支持是对 data.table 的相对较新的补充，但同样令人尴尬。已修复并添加了测试。非常感谢 statquant 提供的全面且可重复的报告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T00:11:26.203

跟进其他答案中的评论，是的，这证明它只影响类型`double`列（NA in`integer`和`character`columns 都可以）。

```
X = data.table(name=c("Raf","Jon","Ste","Rob","Smi","Joh"),
               depID=as.integer(c(31,33,33,34,34,NA)),key="depID")
Y = data.table(depID=as.integer(c(31,33,34,35)),
               depName=c("Sal","Eng","Cle","Mar"),key="depID")
Y[X]
   depID depName name
1:    NA      NA  Joh
2:    31     Sal  Raf
3:    33     Eng  Jon
4:    33     Eng  Ste
5:    34     Cle  Rob
6:    34     Cle  Smi

merge.data.frame(X,Y,all.x=T)
  depID name depName
1    31  Raf     Sal
2    33  Jon     Eng
3    33  Ste     Eng
4    34  Rob     Cle
5    34  Smi     Cle
6    NA  Joh    <NA>

Y = data.table(depID=as.character(c(31,33,34,35)),
               depName=c("Sal","Eng","Cle","Mar"),key="depID")
X = data.table(name=c("Raf","Jon","Ste","Rob","Smi","Joh"),
               depID=as.character(c(31,33,33,34,34,NA)),key="depID")
X
   name depID
1:  Raf    31
2:  Jon    33
3:  Ste    33
4:  Rob    34
5:  Smi    34
6:  Joh    NA
Y
   depID depName
1:    31     Sal
2:    33     Eng
3:    34     Cle
4:    35     Mar
str(X)
Classes ‘data.table’ and 'data.frame':  6 obs. of  2 variables:
 $ name : chr  "Raf" "Jon" "Ste" "Rob" ...
 $ depID: chr  "31" "33" "33" "34" ...
 - attr(*, "sorted")= chr "depID"
 - attr(*, ".internal.selfref")=<externalptr> 

merge.data.frame(X,Y,all.x=T)
  depID name depName
1    31  Raf     Sal
2    33  Jon     Eng
3    33  Ste     Eng
4    34  Rob     Cle
5    34  Smi     Cle
6  <NA>  Joh    <NA>

Y[X]
   depID depName name
1:    31     Sal  Raf
2:    33     Eng  Jon
3:    33     Eng  Ste
4:    34     Cle  Rob
5:    34     Cle  Smi
6:    NA      NA  Joh 
```

* * *

# 该问题已由 MATTHEW DOWLE 在 V.1.8.7 中修复

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T10:24:29.370

一些可能有用的信息：

```
library(data.table);

X <- data.table(name=c("Raf","Jon","Ste","Rob","Smi","Joh"),depID=c(31,33,33,34,34,NA),key="depID")
#R) X
   #name depID
#1:  Joh    NA
#2:  Raf    31
#3:  Jon    33
#4:  Ste    33
#5:  Rob    34
#6:  Smi    34

Y <- data.table(depID=c(31,33,34,35),depName=c("Sal","Eng","Cle","Mar"),key="depID")
#R) Y
   #depID depName
#1:    31     Sal
#2:    33     Eng
#3:    34     Cle
#4:    35     Mar

#################
#LEFT OUTER JOIN#
#################
LJ <- merge.data.frame(X,Y,by="depID",all.x=TRUE); #by is implicit (see ?merge.data.frame)
#R) LJ
  #depID name depName
#1    31  Raf     Sal
#2    33  Jon     Eng
#3    33  Ste     Eng
#4    34  Rob     Cle
#5    34  Smi     Cle
#6    NA  Joh    <NA>

LJ2 <- Y[X];
#R) LJ2
   #depID depName name
#1:    NA      NA  Joh
#2:    31     Sal  Raf
#3:    33     Eng  Jon
#4:    33     Eng  Ste
#5:    34     Cle  Rob
#6:    34     Cle  Smi

##################
#RIGHT OUTER JOIN#
##################
RJ <- merge.data.frame(X,Y,by="depID",all.y=TRUE); #by is implicit (see ?merge.data.frame)
#R) RJ 
  #depID name depName
#1    31  Raf     Sal
#2    33  Jon     Eng
#3    33  Ste     Eng
#4    34  Rob     Cle
#5    34  Smi     Cle
#6    35 <NA>     Mar

RJ2 <- X[Y];
#R) RJ2
   #depID name depName
#1:    31  Raf     Sal
#2:    33  Jon     Eng
#3:    33  Ste     Eng
#4:    34  Rob     Cle
#5:    34  Smi     Cle
#6:    35   NA     Mar

#################
#FULL OUTER JOIN#
#################
FJ <- merge.data.frame(X,Y,all=T)
#R) FJ
  #depID name depName
#1    31  Raf     Sal
#2    33  Jon     Eng
#3    33  Ste     Eng
#4    34  Rob     Cle
#5    34  Smi     Cle
#6    35 <NA>     Mar
#7    NA  Joh    <NA>

FJ2 <- merge(X,Y,all=T)
#R) FJ2
   #depID name depName
#1:    NA  Joh      NA
#2:    31  Raf     Sal
#3:    33  Jon     Eng
#4:    33  Ste     Eng
#5:    34  Rob     Cle
#6:    34  Smi     Cle
#7:    35   NA     Mar

####################
#NATURAL INNER JOIN#
####################
IJ <- merge.data.frame(X,Y)
#R) IJ
  #depID name depName
#1    31  Raf     Sal
#2    33  Jon     Eng
#3    33  Ste     Eng
#4    34  Rob     Cle
#5    34  Smi     Cle

IJ2 <- merge(X,Y)
#R) IJ2
   #depID name depName
#1:    31  Raf     Sal
#2:    33  Jon     Eng
#3:    33  Ste     Eng
#4:    34  Rob     Cle
#5:    34  Smi     Cle

A <- data.table(time=as.POSIXct(c("10:01:01","10:01:02","10:01:04","10:01:05","10:01:02","10:01:01","10:01:01"),format="%H:%M:%S"),
                b=c("a","a","a","a","b","c","c"), 
                d=c(1,1.9,2,1.8,5,4.1,4.2));
B <- data.table(time=as.POSIXct(c("10:01:01","10:01:03","10:01:00","10:01:01"),format="%H:%M:%S"),b=c("a","a","c","d"), e=c(1L,2L,3L,4L));
setkey(A,b,time)
setkey(B,b,time)

###########
#ASOF JOIN#
###########
AOJ <- B[A,roll=T]
#R) AOJ
   #b                time  e   d
#1: a 2013-01-11 10:01:01  1 1.0
#2: a 2013-01-11 10:01:02  1 1.9
#3: a 2013-01-11 10:01:04  2 2.0
#4: a 2013-01-11 10:01:05  2 1.8
#5: b 2013-01-11 10:01:02 NA 5.0
#6: c 2013-01-11 10:01:01  3 4.1
#7: c 2013-01-11 10:01:01  3 4.2 
```

# scala - 使用 scala 2.10.0 获取 Unidoc.scala 设置时，sbt 找不到 scala.reflect.Manifest

> ID：14076070
> 
> 赞同：5
> 
> 时间：2012-12-28T21:31:59.380
> 
> 标签：scala, reflection, build, sbt, updating

我刚刚使用 SBT 0.12 将我的项目更新为 Scala 2.10.0。但是现在，在运行 sbt 时，出现以下错误：

```
java.lang.NoClassDefFoundError: scala/reflect/ManifestFactory$
    at X.build.Unidoc$.<init>(Unidoc.scala:8)
    at X.build.Unidoc$.<clinit>(Unidoc.scala)
    at X.build.ServicesBuild$.<init>(Build.scala:25)
    at X.build.ServicesBuild$.<clinit>(Build.scala) 
```

似乎问题出在`SettingKey`：

```
8: val unidocDirectory = SettingKey[File]("unidoc-directory") 
```

我听说 Scala 2.10 所做的反映与以前不同，并认为这是问题所在，但 Akka 项目正在做同样的事情，而且（我认为）他们做得很好。

[https://github.com/akka/akka/blob/master/project/Unidoc.scala](https://github.com/akka/akka/blob/master/project/Unidoc.scala)（我的 Unidoc.scala 几乎是他们的复制和粘贴）。

有谁知道发生了什么？它怎么不能在 scala 本身中找到一个类？

谢谢！

# memory - c语言中的共享内存父子

> ID：14076071
> 
> 赞同：0
> 
> 时间：2012-12-28T21:32:03.073
> 
> 标签：memory, fork, shared

**大卫·施瓦茨（David Shwartz）**帮了我很多，现在它有点工作......如果输入包含超过 2 个需要由孩子处理的数字，您是否有更优雅的方式来解析输入？我希望孩子只得到两个整数，所以这就是我创建共享内存的原因，所以父亲会将结果（共享内存）+另一个整数发送给孩子。

谢谢你们。

```
 #include <sys/types.h>
 #include <sys/ipc.h>
 #include <sys/shm.h>
 #include <string.h>
 #include <signal.h>
 #include <stdio.h>
 #include <stdlib.h>

 volatile int *shared=0;
 int shmid;

 int  main()
 {

 char  line[256];
 int readByte;

 int fd[2]; //pipe to son, who processes addition
 int pid;

 shmid=shmget ( IPC_PRIVATE, sizeof(int) , 0600 );

 shared=shmat ( shmid, 0 , 0);

 if ( pipe(fd) )
 {
   perror("pipe");
   exit(-1);
 }

 pid=fork();

 if (pid!=0) // father
 {
     close (fd[0]);

     readByte=read(0, line, 256);
     line[readByte-1]='\0';
     printf("%d",readByte);

     int arr[2];
     int i=0;
     int j=0;
     int flag=0;
     char num[10];

     while (i<readByte)
     {
         if (line[i]=='+' )
         {
           i++;
           j=0;
           flag=1;
         }

          while (line[i]!='+' && line[i]!='\0')
          {
            num[j]=line[i];
            i++;
            j++;
           }
            num[j]='\0';

       if (flag==0)
           arr[0]=atoi(num);
       else
       {
           arr[1]=atoi(num);
           i++;
       }

     }
       printf("first %d\n",arr[0]);
       printf("sec %d\n",arr[1]);

        write(fd[1], &arr, sizeof(arr));
        wait(NULL);

       printf ( "%d\n" , *shared );

 }
 else
     // son
     {
       int arr[2];
       int sum;

       readByte = read(fd[0], &arr, sizeof(arr));

       printf("son printing: %d\n",arr[0]);
       printf("son printing: %d\n",arr[1]);

       sum =arr[0]+arr[1];
        *shared=sum;

       close (fd[0]);
       shmdt ( (const void *) shared );
     }

 shmdt ( (const void *) shared );
 shmctl ( shmid , IPC_RMID , 0 );

 close(fd[1]);

 return 0; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T21:59:16.530

你扔掉`shmat`. 你期望`shared`被共享，但这只是一个常规变量。此外，您需要防止编译器优化对共享内存的访问。这里修复了所有致命错误：

```
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <string.h>
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>

volatile int *shared;
int shmid;

int main()
{
    int s,i;

    shmid=shmget ( IPC_PRIVATE, sizeof(int), 0600 );

    shared=shmat ( shmid, 0 , 0);
    *shared=100;

    printf ( "%d\n" , *shared);
    if ( fork()==0 ) // son
    {
        *shared=1000;
        shmdt ( (const void *) shared );
    }
    else // father
    {
            wait ( &s );
            printf ( "%d\n" , *shared);
            shmdt ( (const void *) shared );
            shmctl ( shmid , IPC_RMID , 0 );
    }
    return 0;
} 
```

# android - GestureLibrary 提出 IndexOutOfBounds

> ID：14076072
> 
> 赞同：0
> 
> 时间：2012-12-28T21:32:10.140
> 
> 标签：android, gesture

GestureLibrary 有时会在`recognize()`

为什么？我能做些什么来防止这种情况发生？

> 12-28 22:25:06.118: E/DrawActivity(29717): java.lang.IndexOutOfBoundsException: 无效索引 0，大小为 0 12-28
> 
> 22:25:06.118: E/DrawActivity(29717): 在 java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
> 
> 12-28 22:25:06.118: E/DrawActivity(29717): 在 java.util.ArrayList.get(ArrayList.java:304)
> 
> 12-28 22:25:06.118: E/DrawActivity(29717): 在 android.gesture.Instance.temporalSampler(Instance.java:91)
> 
> 12-28 22:25:06.118: E/DrawActivity(29717): 在 android.gesture.Instance.createInstance(Instance.java:76)
> 
> 12-28 22:25:06.118: E/DrawActivity(29717): 在 android.gesture.GestureStore.recognize(GestureStore.java:137)
> 
> 12-28 22:25:06.118: E/DrawActivity(29717): 在 android.gesture.GestureLibrary.recognize(GestureLibrary.java:64)

编辑：手势是通过以下方式捕获的：

```
<android.gesture.GestureOverlayView     xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/gesture_overlay"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:eventsInterceptionEnabled="true"
android:fadeEnabled="false"
android:gestureStrokeAngleThreshold="0."
android:gestureStrokeSquarenessThreshold="0."
android:gestureStrokeType="single"

android:orientation="vertical"/> 
```

# android - 我如何为从 2.X 到 4.X 的所有 Android 版本使用相同的首选项屏幕？

> ID：14076073
> 
> 赞同：13
> 
> 时间：2012-12-28T21:32:09.177
> 
> 标签：android, compatibility, android-preferences, backwards-compatibility

**注意：请节省一些时间并参考已接受的答案，无需阅读所有问题。**
您可以阅读问题的其余部分以及我为替代（虽然不太复杂）方法提供的答案。
此外，您可能希望通过将相关代码添加到您的偏好活动类中来利用 Android 2.X 中背景故障的修复。

**背景**
作为 Android 编码的新手，但在其他编程语言/框架方面有一定的经验，我期待我的 Android 应用程序编码之旅会是一个相当愉快的过程。就是这样，直到我偶然发现了这个问题：

Android 项目的 Eclipse 向导建议，如果我将最小 API 设置为 8（Android 2.2），我可以覆盖 95% 的设备。反正我不需要用我的应用程序做任何花哨的事情，所以我想，“当然，为什么不呢？”。一切都很好，除了偶尔我会发现一些在最近的 API 版本中被弃用的方法/类，所以我不得不想办法在旧设备上继续使用旧方法，并尝试尽可能多地使用新的较新的 Android 版本的方法。这是一个这样的场合。

在使用 Eclipse 向导创建首选项活动后，我意识到 Eclipse 预编译器/解析器/检查器（或其他任何名称）Lint 会抱怨无法使用旧 API 版本中创建/管理首选项的新方法。所以我想，“好吧，把新方法搞砸。让我们用旧方法做，因为新的 API 版本应该是向后兼容的，所以应该没问题”，但事实并非如此。旧方式使用标记为已弃用的方法/类；对我来说，这意味着即使它们仍然可以在当前 API 中工作，但它们会在未来版本的某个时候停止工作。

所以我开始寻找正确的方法来做到这一点，最后点击了这个页面：[在 PreferenceActivity 中使用什么来代替“addPreferencesFromResource”？](https://stackoverflow.com/questions/6822319/what-to-use-instead-of-addpreferencesfromresource-in-a-preferenceactivity)Garret Wilson 解释了一种以与新方式兼容的方式使用旧偏好屏幕资源的方法。太棒了，终于感觉我可以继续我的应用程序编码了，但它在针对旧 API 时不起作用，因为它使用的是更新的 API 代码。所以我必须设计一种方法让它既适用于旧的 API 也适用于新的 API。在修补了一段时间后，我设法找到了一种方法，通过使用预编译器（或其他任何名称）注释和出色的 getClass().getMethod() 以及异常。

一切似乎都完美无缺，直到我创建了一个偏好子屏幕。它在较新的 Android 版本中正确显示，但当我在较旧的版本中尝试时，我只能看到黑屏。经过大量搜索，我找到了解释问题的页面：[http ://code.google.com/p/android/issues/detail?id=4611](http://code.google.com/p/android/issues/detail?id=4611)这显然是一个已知的故障，已经存在了很长一段时间的几个 Android 版本。我阅读了整个线程并找到了几个解决问题的建议，但我真的不喜欢其中任何一个。一方面，我更喜欢尽可能多地避免静态的东西，并以编程方式做事。我更喜欢自动化而不是重复性工作。一些解决方案建议将子屏幕创建为父屏幕，然后将它们添加到清单文件中，并通过意图从父屏幕调用它们。我真的很讨厌必须跟踪这些事情：清单中的条目、分离的屏幕资源文件、意图......所以这对我来说是一个禁忌。我一直在寻找并找到了一种我更喜欢的程序化方法……却发现它不起作用。它包括遍历首选项屏幕的整个视图树并为首选项子屏幕分配适当的背景，但它只是不起作用，因为我后来在经过多次调试后发现，首选项子屏幕视图不是偏好屏幕视图的孩子。我必须自己想办法实现这一目标。我尝试了尽可能多的东西，研究和研究无济于事。有好几次我都处于放弃的边缘，但经过大约两周的持续努力和大量调试，我找到了一个解决方法，我在评论 #35 中发布了它。我尝试了尽可能多的东西，研究和研究无济于事。有好几次我都处于放弃的边缘，但经过大约两周的持续努力和大量调试，我找到了一个解决方法，我在评论 #35 中发布了它。我尝试了尽可能多的东西，研究和研究无济于事。有好几次我都处于放弃的边缘，但经过大约两周的持续努力和大量调试，我找到了一个解决方法，我在评论 #35 中发布了它。

**意见**
这确实不是完美的解决方案/方法，我知道它的一些缺点，但它是一个有效的方法，所以我决定分享它。希望我的热情不会太荒谬，因为我知道这不是什么大问题，任何有经验的编码人员都可以解决。但是，嘿，我认为分享知识让我更好一点，无论我多么吹嘘，都比一个经验丰富的程序员对自己保密。只是分享我的观点，因为我不敢相信以前没有人遇到过这个问题，但我相信很多人都遇到过这个问题并且懒得分享他们的知识。

我在答案中向您展示了一个在多个版本的 Android 上使用的建议类，以及一些关于其使用的建议。我愿意进行讨论和贡献，以使其成为更好的课程。

**已知的问题：**

*   父屏幕装饰视图背景被克隆到子屏幕装饰视图背景上，这显然不是正常行为。
    *状态：在有人提出解决此问题的充分理由之前被解雇*
*   屏幕旋转时崩溃
    *状态：已修复。
    可能与较新的 API 实现（内部类 PF）的资源可见性有关
    显然从 preferenceFragment 继承的类需要使其所有成员都是静态的。我想如果每次需要使用新片段时都应该继承是有道理的*

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-30T17:22:08.390

如果您使用的是最新的 ADT 插件，则可以选择轻松创建支持大多数旧 Android 版本以及所有新版本的首选项 Activity。

> 右键单击您的项目 -> 其他 -> Android Activity

然后选择 SettingsActivity ![在此处输入图像描述](../Images/d0ff7bb6e18a1c63ed1e0961bf2fb33d.png)

创建的 Activity 将负责处理高和低 API 版本，因为它使用 if 语句来选择显示首选项的适当方法。

* * *

**编辑**
提出了一个很好的观点：电话大小的设备，无论 API 版本如何，都使用旧`PreferenceActivity`方法。

使用 API 11+ 设备的最快方法`Fragments`是`!isXLargeTablet(context);`从`isSimplePreferences()`

```
private static boolean isSimplePreferences(Context context) {
    return ALWAYS_SIMPLE_PREFS
            || Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB;
} 
```

然而，现在用户有更多的导航要做。
![标头作为根](../Images/024b567db3d5062c18efeebcfdc43812.png)

这是因为`onBuildHeaders()`被称为。

为了摆脱这种情况，我们需要创建自己的 PreferenceFragment 来添加每个 xml 资源。

```
@TargetApi(Build.VERSION_CODES.HONEYCOMB)
    public static class AllPreferencesFragment extends PreferenceFragment{
        @Override
        public void onCreate (Bundle savedInstanceState){
            super.onCreate(savedInstanceState);
            addPreferencesFromResource(R.xml.pref_general);

            // Add 'notifications' preferences, and a corresponding header.
            PreferenceCategory fakeHeader = new PreferenceCategory(getActivity());
            fakeHeader.setTitle(R.string.pref_header_notifications);
            getPreferenceScreen().addPreference(fakeHeader);
            addPreferencesFromResource(R.xml.pref_notification);

            // Add 'data and sync' preferences, and a corresponding header.
            fakeHeader = new PreferenceCategory(getActivity());
            fakeHeader.setTitle(R.string.pref_header_data_sync);
            getPreferenceScreen().addPreference(fakeHeader);
            addPreferencesFromResource(R.xml.pref_data_sync);

            // Bind the summaries of EditText/List/Dialog/Ringtone preferences to
            // their values. When their values change, their summaries are updated
            // to reflect the new value, per the Android Design guidelines.
            bindPreferenceSummaryToValue(findPreference("example_text"));
            bindPreferenceSummaryToValue(findPreference("example_list"));
            bindPreferenceSummaryToValue(findPreference("notifications_new_message_ringtone"));
            bindPreferenceSummaryToValue(findPreference("sync_frequency"));
        }
    } 
```

如果您可以从启动设置的外部确定屏幕大小，`Activity`则可以指定一个片段以通过它启动`EXTRA_SHOW_FRAGMENT`

```
i.putExtra(SettingsActivity.EXTRA_SHOW_FRAGMENT, "com.example.test.SettingsActivity$AllPreferencesFragment"); 
```

或者你可以`SettingsActivity`决定是否显示这个片段（假设你对这个`isXLargeTablet()`方法很满意。

更改`onBuildHeaders()`为：

```
@Override
@TargetApi(Build.VERSION_CODES.HONEYCOMB)
public void onBuildHeaders(List<Header> target) {
    if (!isSimplePreferences(this) && isXLargeTablet(this)) {
        loadHeadersFromResource(R.xml.pref_headers, target);
    }
} 
```

添加这个方法：

```
@TargetApi(Build.VERSION_CODES.HONEYCOMB)
private void setupNewApiPhoneSizePreferences() {
    if (!isXLargeTablet(this) && Build.VERSION.SDK_INT > Build.VERSION_CODES.HONEYCOMB){
            getFragmentManager().beginTransaction().replace(android.R.id.content, new AllPreferencesFragment()).commit();
    }
} 
```

并`onPostCreate()`添加方法调用。

```
setupNewApiPhoneSizePreferences(); 
```

现在应该使用从 API 11 开始的非弃用调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T21:32:09.177

您可以使用此类在从 2.X 到 4.X 的所有 Android 版本中显示首选项屏幕，方法是为其提供首选项屏幕资源。

如果您愿意，您可以通过重命名直接使用它，但我建议您将它按原样添加到您的项目中，并从中继承，如果您需要使用多个父首选项屏幕，这会更简洁。

如果您想直接使用它，只需将 prefs 值替换为您的偏好屏幕资源 ID。

如果你想继承它，你应该这样做：

```
import android.os.Bundle;

public class MyPreferencesActivity extends CompatiblePreferenceActivity
{   
    @Override
    protected void onCreate(final Bundle savedInstanceState)
    {
        setPrefs(R.xml.mypreferencesactivity);
        super.onCreate(savedInstanceState);
    }   
} 
```

总是在调用 super.onCreate(Bundle) 之前调用 setPrefs(int)

如果出于某种原因，您只想利用故障修复并自己创建首选项，您可以将故障修复代码复制到您自己的首选项活动中，或者从类继承并捕获PrefsNotSet 异常如下：

```
import android.os.Bundle;

public class MyPreferencesActivity extends CompatiblePreferenceActivity
{   
    @Override
    protected void onCreate(final Bundle savedInstanceState)
    {
        try{
            super.onCreate(savedInstanceState);
        }catch(PrefsNotSetException e){};
    }   
} 
```

**最后，班级：**

```
import android.annotation.TargetApi;
import android.os.Bundle;
import android.preference.Preference;
import android.preference.PreferenceActivity;
import android.preference.PreferenceFragment;
import android.preference.PreferenceScreen;

public class CompatiblePreferenceActivity extends PreferenceActivity
{
    private int prefs=0;

    //Get/Set
    public void setPrefs(int prefs)
    {
        this.prefs=prefs;
    }

    //Exception
    protected static class PrefsNotSetException extends RuntimeException
    {
        private static final long serialVersionUID = 1L;
        PrefsNotSetException()
        {
            super("\"prefs\" should be set to a valid preference resource ID.");
        }
    }

    //Creation
    @Override
    protected void onCreate(final Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        if (prefs==0)
            throw new PrefsNotSetException();
        else
            try {
                getClass().getMethod("getFragmentManager");
                AddResourceApi11AndGreater();
                }
            catch (NoSuchMethodException e) { //Api < 11
                    AddResourceApiLessThan11();
                }
    }

    @SuppressWarnings("deprecation")
    protected void AddResourceApiLessThan11()
    {
        addPreferencesFromResource(prefs);
    }

    @TargetApi(11)
    protected void AddResourceApi11AndGreater()
    {
        PF.prefs=prefs;
        getFragmentManager().beginTransaction().replace(
            android.R.id.content, new PF()).commit();
    }

    @TargetApi(11)
    public static class PF extends PreferenceFragment
    {
        private static int prefs;
        @Override
        public void onCreate(final Bundle savedInstanceState)
        {
            super.onCreate(savedInstanceState);
            addPreferencesFromResource(prefs);
        }
    }

    //Sub-screen background glitch fix
    @SuppressWarnings("deprecation")
    @Override
    public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen,
        Preference preference)
    {
        super.onPreferenceTreeClick(preferenceScreen, preference);
        if (preference!=null)
            if (preference instanceof PreferenceScreen)
                if (((PreferenceScreen)preference).getDialog()!=null)
                    ((PreferenceScreen)preference).getDialog().
                        getWindow().getDecorView().
                        setBackgroundDrawable(this.getWindow().
                            getDecorView().getBackground().getConstantState().
                            newDrawable());
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-25T21:48:52.300

好吧，使用自动生成的 SettingsActivity 很快就变得很老了。必须向上和向下滚动过去的样板代码 - 而且它充满了黄色警告，我讨厌黄色（虽然不能完全避免不推荐使用的警告 - 请参阅[在 PreferenceActivity 中使用什么代替“addPreferencesFromResource”？，](https://stackoverflow.com/questions/6822319/what-to-use-instead-of-addpreferencesfromresource-in-a-preferenceactivity)这也是问题所在还涉及到如何制作跨 API `PreferenceActivity`- 以及[是否有意将 PreferenceFragment 从兼容性包中排除？](https://stackoverflow.com/questions/5501431/was-preferencefragment-intentionally-excluded-from-the-compatibility-package)进行讨论）。而且你也可以很容易地得到一个 NPE - 你知道那`onPostCreate()`实际上是-`onPostStart()`所以`findPreference()`返回`null`。`onStart()`

现在有一些涉及反射的解决方案，但要避免反射（就像地狱一样） - 因为我们对前 2 个版本的 android 不感兴趣，所以可以避免反射*（*请参阅[Is checks SDK_INT enough or is lazy loading required for using new android API？为什么？](https://stackoverflow.com/questions/20271593/is-checking-sdk-int-enough-or-is-lazy-loading-needed-for-using-newer-android-api)）。还有一些解决方案涉及在运行时选择一个类 - 但有 2 个类很糟糕，而且无论如何都不是 OOP（对于这些和其他解决方案，请参阅相关问题的答案：[PreferenceActivity Android 4.0 及更早版本](https://stackoverflow.com/questions/10186697/preferenceactivity-android-4-0-and-earlier)）。

所以我想出了一个抽象基类，这是正确的 Java 和 OO 做事方式（除非你需要 Eclair 和下面你需要反射和/或延迟加载类来避免`VerifyErrors`），我移动了自动生成的样板代码：

```
import android.annotation.TargetApi;
import android.content.Context;
import android.content.res.Configuration;
import android.os.Build;
import android.os.Bundle;
import android.preference.PreferenceActivity;
import android.preference.PreferenceFragment;

import java.util.List;

/**
 * A {@link PreferenceActivity} that presents a set of application settings. On
 * handset devices, settings are presented as a single list. On tablets,
 * settings are split by category, with category headers shown to the left of
 * the list of settings.
 * <p>
 * See <a href="http://developer.android.com/design/patterns/settings.html">
 * Android Design: Settings</a> for design guidelines and the <a
 * href="http://developer.android.com/guide/topics/ui/settings.html">Settings
 * API Guide</a> for more information on developing a Settings UI.
 *
 * Defines two abstract methods that need be implemented by implementators.
 */
public abstract class BaseSettings extends PreferenceActivity {

    /**
     * Determines whether to always show the simplified settings UI, where
     * settings are presented in a single list. When false, settings are shown
     * as a master/detail two-pane view on tablets. When true, a single pane is
     * shown on tablets.
     */
    private static final boolean ALWAYS_SIMPLE_PREFS = false;

    /**
     * Helper method to determine if the device has an extra-large screen. For
     * example, 10" tablets are extra-large.
     */
    @TargetApi(Build.VERSION_CODES.GINGERBREAD)
    private static boolean isXLargeTablet(Context context) {
        return (context.getResources().getConfiguration().screenLayout &
                Configuration.SCREENLAYOUT_SIZE_MASK)
                >= Configuration.SCREENLAYOUT_SIZE_XLARGE;
    }

    /** {@inheritDoc} */
    @Override
    public final boolean onIsMultiPane() { // never used by us
        return isXLargeTablet(this) && !isSimplePreferences(this);
    }

    /**
     * Determines whether the simplified settings UI should be shown. This is
     * true if this is forced via {@link #ALWAYS_SIMPLE_PREFS}, or the device
     * doesn't have newer APIs like {@link PreferenceFragment}, or the device
     * doesn't have an extra-large screen. In these cases, a single-pane
     * "simplified" settings UI should be shown.
     */
    private static final boolean isSimplePreferences(Context context) {
        return ALWAYS_SIMPLE_PREFS
            || Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB
            || !isXLargeTablet(context);
    }

    @Override
    protected final void onCreate(Bundle savedInstanceState) {
        // disallow onCreate(), see comment in onPostCreate()
        super.onCreate(savedInstanceState);
    }

    @Override
    protected final void onStart() {
        // disallow onStart(), see comment in onPostCreate()
        super.onStart();
    }

    @Override
    protected void onPostCreate(Bundle savedInstanceState) {
        // onPostCreate() probably is needed because onBuildHeaders() is called
        // after onCreate() ? This piece of err code should be called
        // onPostStart() btw - so yeah
        super.onPostCreate(savedInstanceState);
        setupSimplePreferencesScreen();
        // findPreference will return null if setupSimplePreferencesScreen
        // hasn't run, so I disallow onCreate() and onStart()
    }

    /**
     * Shows the simplified settings UI if the device configuration if the
     * device configuration dictates that a simplified, single-pane UI should be
     * shown.
     */
    private void setupSimplePreferencesScreen() {
        if (!isSimplePreferences(this)) {
            return;
        }
        buildSimplePreferences();
    }

    /** {@inheritDoc} */
    /*
     * Subclasses of PreferenceActivity should implement onBuildHeaders(List) to
     * populate the header list with the desired items. Doing this implicitly
     * switches the class into its new "headers + fragments" mode rather than
     * the old style of just showing a single preferences list (from
     * http://developer
     * .android.com/reference/android/preference/PreferenceActivity.html) -> IE
     * this is called automatically - reads the R.xml.pref_headers and creates
     * the 2 panes view - it was driving me mad - @inheritDoc my - It does not
     * crash in Froyo cause isSimplePreferences is always true for
     * Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB - @Override has
     * nothing to do with runtime and of course on Froyo this is never called by
     * the system
     */
    @Override
    @TargetApi(Build.VERSION_CODES.HONEYCOMB)
    public final void onBuildHeaders(List<Header> target) {
        if (!isSimplePreferences(this)) {
            loadHeadersFromResource(getHeadersXmlID(), target);
        }
    }

    // =========================================================================
    // Abstract API
    // =========================================================================
    /**
     * Must return an id for the headers xml file. There you define the headers
     * and the corresponding PreferenceFragment for each header which you must
     * of course implement. This is used in the super implementation of
     * {@link #onBuildHeaders(List)}
     *
     * @return an id from the R file for the xml containing the headers
     */
    abstract int getHeadersXmlID();

    /**
     * Builds a pre Honeycomb preference screen. An implementation would use the
     * (deprecated)
*{@link android.preference.PreferenceActivity#addPreferencesFromResource(int)}
     */
    abstract void buildSimplePreferences();
} 
```

和一个示例实现：

```
public final class SettingsActivity extends BaseSettings implements
        OnSharedPreferenceChangeListener {

    private static final int PREF_HEADERS_XML = R.xml.pref_headers;
    private static CharSequence master_enable;
    private OnPreferenceChangeListener listener;
    private static Preference master_pref;
    private static final String TAG = SettingsActivity.class.getSimpleName();
    private SharedPreferences sp;
    /** Used as canvas for the simple preferences screen */
    private static final int EMPTY_PREF_RESOURCE = R.xml.pref_empty;
    private static int PREF_RESOURCE_SETTINGS = R.xml.pref_data_sync;

    // abstract overrides   
    @Override
    int getHeadersXmlID() {
        return PREF_HEADERS_XML;
    }

    @Override
    void buildSimplePreferences() {
        // In the simplified UI, fragments are not used at all and we instead
        // use the older PreferenceActivity APIs.
        // THIS is a blank preferences layout - which I need so
        // getPreferenceScreen() does not return null - so I can add a header -
        // alternatively you can very well comment everything out apart from
        // addPreferencesFromResource(R.xml.pref_data_sync);
        addPreferencesFromResource(EMPTY_PREF_RESOURCE);
        // Add 'data and sync' preferences, and a corresponding header.
        PreferenceCategory fakeHeader = new PreferenceCategory(this);
        fakeHeader.setTitle(R.string.pref_header_data_sync);
        getPreferenceScreen().addPreference(fakeHeader);
        addPreferencesFromResource(PREF_RESOURCE_SETTINGS);
    }

    // here is the work done
    @Override
    protected void onPostCreate(Bundle savedInstanceState) {
        super.onPostCreate(savedInstanceState);
        master_enable = getResources().getText(
            R.string.enable_monitoring_master_pref_key);
        listener = new ToggleMonitoringListener();
        // DefaultSharedPreferences - register listener lest Monitor aborts
        sp = PreferenceManager.getDefaultSharedPreferences(this);
        sp.registerOnSharedPreferenceChangeListener(this);
        master_pref = findPreference(master_enable.toString());
    }

    @Override
    protected void onResume() {
        super.onResume();
        master_pref.setOnPreferenceChangeListener(listener); // no way to
        // unregister, see: https://stackoverflow.com/a/20493608/281545 This
        // listener reacts to *manual* updates - so no need to be active
        // outside onResume()/onPause()
    }

    @Override
    protected void onDestroy() {
        // may not be called (as onDestroy() is killable), but no leak,
        // see: https://stackoverflow.com/a/20493608/281545
        sp.unregisterOnSharedPreferenceChangeListener(this);
        super.onDestroy();
    }

    /**
     * Toggles monitoring and sets the preference summary.Triggered on *manual*
     * update of the *single* preference it is registered with, but before this
     * preference is updated and saved.
     */
    private static class ToggleMonitoringListener implements
            OnPreferenceChangeListener {

        ToggleMonitoringListener() {}

        @Override
        public boolean
                onPreferenceChange(Preference preference, Object newValue) {
            if (newValue instanceof Boolean) {
                final boolean enable = (Boolean) newValue;
                Monitor.enableMonitoring(preference.getContext(), enable);
                final CheckBoxPreference p = (CheckBoxPreference) preference;
                preference.setSummary((enable) ? p.getSummaryOn() : p
                    .getSummaryOff());
                return true;
            }
            return false;
        }
    }

    /**
     * This fragment is used when the activity is showing a two-pane
     * settings UI.
     */
    @TargetApi(Build.VERSION_CODES.HONEYCOMB)
    public final static class DataSyncPreferenceFragment extends
            PreferenceFragment {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            Log.w(TAG, "onCreate");
            addPreferencesFromResource(PREF_RESOURCE_SETTINGS);
            master_pref = findPreference(master_enable.toString());
        }
    }

    @Override
    public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
            String key) {
        if (master_enable == null || master_pref == null) return;
        if (master_enable.toString().equals(key)) {
            refreshMasterPreference();
        }
    }

    /**
     * @param key
     */
    private void refreshMasterPreference() {
        final Boolean isMonitoringEnabled = AccessPreferences.get(this,
            master_enable.toString(), false);
        Log.w(TAG, "Stored value: " + isMonitoringEnabled);
        final CheckBoxPreference p = (CheckBoxPreference) master_pref;
        final boolean needsRefresh = p.isChecked() != isMonitoringEnabled;
        if (needsRefresh) {
            p.setChecked(isMonitoringEnabled);
            p.setSummary((isMonitoringEnabled) ? p.getSummaryOn() : p
                .getSummaryOff());
        }
    }
} 
```

因此，主要思想是您为带有标题的首选项提供 xml：

```
 public final void onBuildHeaders(List<Header> target) {
        if (!isSimplePreferences(this)) {
            loadHeadersFromResource(getHeadersXmlID(), target);
        }
    } 
```

在哪里：

```
 @Override
    int getHeadersXmlID() {
        return PREF_HEADERS_XML;
    } 
```

和`PREF_HEADERS_XML`：

```
<preference-headers xmlns:android="http://schemas.android.com/apk/res/android" >
    <!-- These settings headers are only used on tablets. -->
    <header
        android:fragment=".activities.SettingsActivity$DataSyncPreferenceFragment"
        android:title="@string/pref_header_data_sync" />
</preference-headers> 
```

并设置简单的首选项`buildSimplePreferences()`

我有兴趣把它变成一个更通用的 API - 可能包括`sBindPreferenceSummaryToValueListener`- 所以欢迎提出想法。

啊，是的，sBindPreferenceSummaryToValueListener 绒毛：

```
// FLUFF AHEAD:
// the fluff that follows is for binding preference summary to value -
// essentially wrappers around OnPreferenceChangeListener - just so
// you get an idea of the mess this autogenerated piece of, code, was
// formatter:off
/**
 * A preference value change listener that updates the preference's summary
 * to reflect its new value.
 */
/* private static Preference.OnPreferenceChangeListener
        sBindPreferenceSummaryToValueListener =
        new Preference.OnPreferenceChangeListener() {

        @Override
        public boolean onPreferenceChange(Preference preference,
                            Object value) {
            String stringValue = value.toString();
            if (preference instanceof ListPreference) {
                // For list preferences, look up the correct display value
                // in the preference's 'entries' list.
                ListPreference listPreference = (ListPreference) preference;
                int index = listPreference.findIndexOfValue(stringValue);
                // Set the summary to reflect the new value.
                preference.setSummary(index >= 0
                        ? listPreference.getEntries()[index] : null);
            } else if (preference instanceof RingtonePreference) {
                // For ringtone preferences, look up the correct display
                // value using RingtoneManager.
                if (TextUtils.isEmpty(stringValue)) {
                    // Empty values correspond to 'silent' (no ringtone).
                    // preference.setSummary(R.string.pref_ringtone_silent);
                } else {
                    Ringtone ringtone = RingtoneManager.getRingtone(
                        preference.getContext(), Uri.parse(stringValue));
                    if (ringtone == null) {
                        // Clear the summary if there was a lookup error.
                        preference.setSummary(null);
                    } else {
                        // Set the summary to reflect the new ringtone
                        // display name.
                        String name = ringtone
                            .getTitle(preference.getContext());
                        preference.setSummary(name);
                    }
                }
            } else if (preference instanceof CheckBoxPreference) {
                boolean b = (Boolean) value;
                Log.w(TAG, "::::value " + b);
                final CheckBoxPreference p =(CheckBoxPreference)preference;
                preference.setSummary((b) ? p.getSummaryOn() : p
                    .getSummaryOff());
                Log.w(TAG, p.getKey() + " :: " + p.isChecked());
            } else {
                // For all other preferences, set the summary to the value's
                // simple string representation.
                preference.setSummary(stringValue);
            }
            return true;
        }
    }; */

/**
 * Binds a preference's summary to its value. More specifically, when the
 * preference's value is changed, its summary (line of text below the
 * preference title) is updated to reflect the value. The summary is also
 * immediately updated upon calling this method. The exact display format is
 * dependent on the type of preference.
 *
 * @see #sBindPreferenceSummaryToValueListener
 */
/* private static void bindPreferenceSummaryToValue(Preference preference) {
    // Set the listener to watch for value changes.
    preference
      .setOnPreferenceChangeListener(sBindPreferenceSummaryToValueListener);
    // Trigger the listener immediately with the preference's
    // current value.
    sBindPreferenceSummaryToValueListener.onPreferenceChange(
        preference,
        PreferenceManager.getDefaultSharedPreferences(
            preference.getContext()).getString(preference.getKey(), ""));
} */ 
```

# sql-server - 使用实体框架更新数据库中的模型与外键发生冲突

> ID：14076076
> 
> 赞同：2
> 
> 时间：2012-12-28T21:32:15.497
> 
> 标签：sql-server, asp.net-mvc, entity-framework

我知道这已经被问过数百万次了，我自己也有过数百次，但由于某种原因，我无法解决这个问题。

我得到了众所周知的错误：

```
The UPDATE statement conflicted with the FOREIGN KEY constraint ... 
```

当插入或删除完成时，我数据库中的所有表都会级联。

现在出现错误：我想更新链接到文化表（用于语言）的管理员表（管理员帐户）。

一切都正确填写。因此我们得到以下代码：

```
 [HttpPost]
    public ActionResult Edit(Admins admins)
    {
        if (!ModelState.IsValid)
        {
            return View(admins);
        }
        admins.cultures_id = admins.Cultures.id;
        _unitOfWork.AdminsRepository.Update(admins);
        _unitOfWork.Save();

        return RedirectToAction("Index", "Overview", new { area = "Admin" });
    } 
```

我首先将我的管理对象/实体的文化 ID 设置为与链接的文化表中的 ID 相同：

```
admins.cultures_id = admins.Cultures.id; 
```

然后我填写更新表格：

_unitOfWork.AdminsRepository.Update(admins);

方法更新包含以下代码：

```
 public virtual void Update(TEntity entityToUpdate)
    {
        DbSet.Attach(entityToUpdate);
        ArtWebShopEntity.Entry(entityToUpdate).State = EntityState.Modified;
    } 
```

到目前为止一切顺利，但是，当我真正想保存管理员时：

```
_unitOfWork.Save(); 
```

该保存方法包含以下代码：

```
 public void Save() {
        try
        {
            _artWebshopEntity.SaveChanges();
        }
        catch (DbEntityValidationException dbEx)
        {
            foreach (var validationErrors in dbEx.EntityValidationErrors)
            {
                Console.WriteLine("Entity of type \"{0}\" in state \"{1}\" has the following validation errors:", validationErrors.Entry.Entity.GetType().Name, validationErrors.Entry.State);

                foreach (var validationError in validationErrors.ValidationErrors)
                {
                    Console.WriteLine("- Property: \"{0}\", Error: \"{1}\"", validationError.PropertyName, validationError.ErrorMessage);
                }
            }

            throw;  // Will do something here later on...
        }

    } 
```

在 SaveCHanges 方法中，我得到了错误。我知道这意味着什么，但我似乎无法修复它。我已经尝试了所有我知道可能导致它的事情。

# 编辑

我只想更新管理值，所以我不想更新文化值。

这是查询：

```
update [dbo].[Admins]
set    [login] = 'Herve' /* @0 */,
       [password] = null,
       [salt] = null,
       [email] = 'xxxxx.xxx@glevin.be' /* @1 */,
       [permissions] = 'administrator' /* @2 */,
       [attempts] = 4 /* @3 */,
       [locked] = 0 /* @4 */,
       [cultures_id] = 0 /* @5 */
where  ([id] = 1 /* @6 */) 
```

所以，cultures_id 是问题所在。我现在做了以下事情：

```
 var updateAdmin = new Admins
            {
                attempts = admins.attempts,
                cultures_id = admins.cultures_id,
                email = admins.email,
                locked = admins.locked,
                login = admins.login,
                id = admins.id,
                password = admins.password,
                permissions = admins.permissions,
                salt = admins.salt,
            }; 
```

这很有效，但是当我将 Cultures 对象添加到组合中时，它会崩溃并给我参考错误。所以归结为，**我如何将具有外键的表更新到另一个表也需要更新**？

## 编辑二

我的管理员和文化实体（数据库优先），也是 sql management studio 中的数据库图像：

管理类：

```
public partial class Admins
{
    public int id { get; set; }
    public string login { get; set; }
    public string password { get; set; }
    public string salt { get; set; }
    public string email { get; set; }
    public string permissions { get; set; }
    public Nullable<int> attempts { get; set; }
    public Nullable<bool> locked { get; set; }
    public Nullable<int> cultures_id { get; set; }

    public virtual Cultures Cultures { get; set; }
} 
```

文化课：

```
public partial class Cultures
{
    public Cultures()
    {
        this.Categories_local = new HashSet<Categories_local>();
        this.Menu_items_local = new HashSet<Menu_items_local>();
        this.Products_local = new HashSet<Products_local>();
        this.Subcategories_local = new HashSet<Subcategories_local>();
        this.Webpages_local = new HashSet<Webpages_local>();
        this.Admins = new HashSet<Admins>();
    }

    public int id { get; set; }
    public string name { get; set; }
    public string display_name { get; set; }

    public virtual ICollection<Categories_local> Categories_local { get; set; }
    public virtual ICollection<Menu_items_local> Menu_items_local { get; set; }
    public virtual ICollection<Products_local> Products_local { get; set; }
    public virtual ICollection<Subcategories_local> Subcategories_local { get; set; }
    public virtual ICollection<Webpages_local> Webpages_local { get; set; }
    public virtual ICollection<Admins> Admins { get; set; }
} 
```

![数据库设计](../Images/c6f9cc69ee5ef2ce789673b7c05861c5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T01:28:28.260

我已经让它工作了！

问题在于，在编辑页面中，最后一个字段是显示与管理员 ID 对应的文化名称的字段。

换句话说，我做了以下事情：

```
@Html.EditorFor(model => model.Cultures.name) 
```

但这不是正确的方法。

为了显示文化的名称，但在代码中传递文化 ID，我使用了 @Html.DropDownListFor() 元素。

但是，问题在于我的原始模型**Admins**没有可以传递给我视图中的下拉列表元素的 IEnumerable 对象。我必须创建一个名为**CreateAdminModel**的新模型，新模型如下所示：

```
public class CreateAdminModel
{
    public CreateAdminModel() { }

    public CreateAdminModel(IEnumerable<SelectListItem> cultures) { Cultures = cultures; }

    public CreateAdminModel(Admins admin) { Admin = admin; }

    public CreateAdminModel(IEnumerable<SelectListItem> cultures, Admins admin)
    {
        Cultures = cultures;
        Admin = admin;
    }

    public IEnumerable<SelectListItem> Cultures { get;  set; }
    public Admins Admin { get; internal set; }
} 
```

它有一个由实体框架创建的 Admin 对象（首先是数据库）。

使用该新模型，我创建了以下方法：

```
 private CreateAdminModel CreateAdminWithcultureDetails(Admins admin = null)
    {
        var cultureItems = (_unitOfWork.CulturesRepository.Get()).ToArray();
        var cultureList = new List<SelectListItem>();
        for (int i = 0; i < cultureItems.Count(); i++) cultureList.Add(new SelectListItem { Text = cultureItems[i].name, Value = cultureItems[i].id.ToString() });

        return admin != null ? new CreateAdminModel(cultureList, admin) : new CreateAdminModel(cultureList);
    } 
```

这会用文化填充下拉列表，并且根据是否传递了管理对象，还会添加一个管理对象。

现在我可以在视图中使用此模型，并在必要时正确填写下拉列表和管理员。

我将对必须使用 CRUD 的其他事情做同样的事情。

# c++ - QMediaPlayer 支持哪些音频格式？

> ID：14076077
> 
> 赞同：4
> 
> 时间：2012-12-28T21:32:16.347
> 
> 标签：c++, qt, qmediaplayer

我试图弄清楚`QMediaPlayer`Qt 支持什么，但找不到特定的格式列表（MP3、AAC、FLAC、MIDI 等）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T21:47:27.183

QtMultimedia 中有几个可用的后端。例如，在 Windows 上 QtMultimedia 使用 DirectShow，在 Linux 上使用 GStreamer。因此，支持的格式列表取决于目标系统上可用的后端和编解码器。请参阅QtMultimedia 插件[列表](http://qt.gitorious.org/qt/qtmultimedia/trees/stable/src/plugins)和有关后端的[一些信息。](http://doc.qt.digia.com/qtmobility/multimediabackend.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:06:39.230

您可能想看看[QAudioDeviceInfo](http://doc.qt.digia.com/qt/qaudiodeviceinfo.html)。

看看 QAudioDeviceInfo 类及其成员函数supportedCodecs()。

# security - 确保客户发送的高分是“真实的”

> ID：14076078
> 
> 赞同：1
> 
> 时间：2012-12-28T21:32:18.663
> 
> 标签：security, networking

我正在寻找一种体面的方法来确保客户发送的高分实际上是真实的（用于全球高分板），以防止用户发送虚假分数。

该方法不需要超级安全，但某种程度的安全性会很好。

我在想这样的事情：

`www.website.com/submitbest.php?player=bob&score=500&digest=xxxxxxxxxxxxx`

我将玩家姓名和得分以及整个字符串的加盐哈希发送到哪里。然后，我可以在服务器上检查哈希值是否应该是这样。

这足够体面吗？有没有我忽略的更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:44:28.070

> 这足够体面吗？有没有我忽略的更简单的方法？

由您决定它是否足够“体面”。就安全性而言，任何人都可以轻松生成所需的散列并将散列后的高分发送到服务器。所以真正的工作是发现所使用的算法+挑战，这可能会嵌入到代码中，因此是可发现的。

问题的要点是您正在服务器上检查用户是否知道散列算法，没有办法实际检查消息是否真实。

# node.js - 将everyauth 示例与简单登录应用程序集成的问题

> ID：14076082
> 
> 赞同：0
> 
> 时间：2012-12-28T21:32:39.350
> 
> 标签：node.js, express, everyauth

我正在尝试使用everyauth 示例登录facebook。我打印了显示身份验证已成功执行的everyauth 调试消息。但是，everyauth.loggedIn 变量未设置。我不确定为什么。我实际上有这样的代码

我有一个页面，其中有 auth/facebook 的链接。当用户单击该链接时，将发送用户进行 facebook 身份验证，一切都完成了。但是，当我检查everyauth.loggedIn 它总是未定义

```
if(everyauth.loggedIn) {
   console.log('The user has logged in');
} 
```

以上是我在'/' url 有请求时尝试检查的内容。这是在执行 facebook 身份验证之后。但是，它总是未定义。可能是因为局部，全局变量问题。我将everyauth 变量传递给几个模块。任何建议将不胜感激

**app.js**（设置快速应用程序）

```
var exp = require('express');
var app = exp.createServer();

var conf = require('/path/example/conf')
var everyauth = require('everyauth');

everyauth.debug = true;

var usersById = {};
var nextUserId = 0;

function addUser (source, sourceUser) {
  var user;
  user = usersById[++nextUserId] = {id: nextUserId};
  user[source] = sourceUser;
  return user;
}

var usersByFbId = {};
var usersByTwitId = {};

everyauth.everymodule
  .findUserById( function (id, callback) {
    callback(null, usersById[id]);
  });

everyauth
  .facebook
    .appId(conf.fb.appId)
    .appSecret(conf.fb.appSecret)
    .findOrCreateUser( function (session, accessToken, accessTokenExtra, fbUserMetadata) {
      return usersByFbId[fbUserMetadata.id] || (usersByFbId[fbUserMetadata.id] = addUser('facebook', fbUserMetadata));;
    })
    .redirectPath('/');

everyauth
  .twitter
    .consumerKey(conf.twit.consumerKey)
    .consumerSecret(conf.twit.consumerSecret)
    .findOrCreateUser( function (sess, accessToken, accessSecret, twitUser) {
      return usersByTwitId[twitUser.id] || (usersByTwitId[twitUser.id] = addUser('twitter', twitUser));;
    })
    .redirectPath('/');

app.root = __dirname;
global.host = 'local.host';

require('./app/config')(app, exp, everyauth);
require('./app/server/router')(app,everyauth);

app.listen(3000, function(){
    console.log("Express server listening on port %d in %s mode", app.address().port, app.settings.env);
}); 
```

**配置.js**

```
module.exports = function(app, exp, everyauth) {

    app.configure(function(){
        app.set('views', app.root + '/app/server/views');
        app.set('view engine', 'jade');
        app.set('view options', { doctype : 'html', pretty : true });
        app.use(exp.bodyParser());
        app.use(exp.cookieParser());
        app.use(exp.session({ secret: 'super-duper-secret-secret' }));
        app.use(everyauth.middleware(app));
        app.use(exp.methodOverride());
        app.use(require('stylus').middleware({ src: app.root + '/app/public' }));
        app.use(exp.static(app.root + '/app/server'));
        app.use(exp.static(app.root + '/app/public'));
    }); 
```

**路由器.js**

```
var CT = require('./modules/country-list');
var AM = require('./modules/account-manager');
var EM = require('./modules/email-dispatcher');

var mongodb = require('mongodb');
module.exports = function(app, everyauth) {

    // main login page //

    app.get('/', function(req, res){
      console.log('Root page called');
      // This is the problem area. everyauth.loggedIn always comes out undefined
      if(everyauth.loggedIn) {
         console.log('The user has logged in');
      } 

    // check if the user's credentials are saved in a cookie //
        if (req.cookies.user == undefined || req.cookies.pass == undefined){
            res.render('login', { locals: { title: 'Hello - Please Login To Your Account'}});
        }   else{
    // attempt automatic login //
            AM.autoLogin(req.cookies.user, req.cookies.pass, function(o){
                if (o != null){
                    req.session.user = o;
                    res.redirect('/dashboard');
                }   else{
                    res.render('login', { locals: { title: 'Hello - Please Login To Your Account' }});
                }
            });
        }
    });

    app.post('/', function(req, res){
      console.log('app called');
        AM.manualLogin(req.param('user'), req.param('pass'), function(e, o){
            if (!o){
                res.send(e, 400);
            }   else{
                req.session.user = o;
                if (req.param('remember-me') == 'true'){
                    res.cookie('user', o.user, { maxAge: 900000 });
                    res.cookie('pass', o.pass, { maxAge: 900000 });
                }
                res.send(o, 200);
            }
        });
    });

    app.post('/feedback', function(req,res) {
    var server = new mongodb.Server('localhost',27017, {auto_reconnect: true}, {safe:true});
        var db = new mongodb.Db('clicker', server);

    db.open(function(err, db) {
            if(!err) {
                db.collection('feedback', function(err, collection) {
                    var currentTime = new Date().getTime();
                    var feedback = {value:req.param('feedback'), datetime:currentTime}; 
                    collection.insert(feedback);
                    db.close();
                });
            }      
        });
        res.send('ok', 200);

    });

// logged-in user homepage //

    app.get('/home', function(req, res) {
        if (req.session.user == null){
    // if user is not logged-in redirect back to login page //
            res.redirect('/');
        }   else{
            res.render('home', {
                locals: {
                    title : 'Control Panel',
                    countries : CT,
                    udata : req.session.user
                }
            });
        }
    });

    app.get('/dashboard', function(req, res) {
        if (req.session.user == null){
    // if user is not logged-in redirect back to login page //
            res.redirect('/');
        }   else{
            res.render('dashboard', {
                locals: {
                    title : 'Dashboard',
                    countries : CT,
                    udata : req.session.user
                }
            });
        }
    });

    app.post('/home', function(req, res){
        if (req.param('user') != undefined) {
            AM.update({
                user        : req.param('user'),
                name        : req.param('name'),
                email       : req.param('email'),
                country     : req.param('country'),
                pass        : req.param('pass')
            }, function(o){
                if (o){
                    req.session.user = o;
            // udpate the user's login cookies if they exists //
                    if (req.cookies.user != undefined && req.cookies.pass != undefined){
                        res.cookie('user', o.user, { maxAge: 900000 });
                        res.cookie('pass', o.pass, { maxAge: 900000 }); 
                    }
                    res.send('ok', 200);
                }   else{
                    res.send('error-updating-account', 400);
                }
            });
        }   else if (req.param('logout') == 'true'){
            res.clearCookie('user');
            res.clearCookie('pass');
            req.session.destroy(function(e){ res.send('ok', 200); });
        }
    });

// creating new accounts //

    app.get('/signup', function(req, res) {
        res.render('signup', {  locals: { title: 'Signup', countries : CT } });
    });

    app.post('/signup', function(req, res){
        AM.signup({
            name    : req.param('name'),
            email   : req.param('email'),
            user    : req.param('user'),
            pass    : req.param('pass'),
            country : req.param('country')
        }, function(e, o){
            if (e){
                res.send(e, 400);
            }   else{
                res.send('ok', 200);
            }
        });
    });

// password reset //

    app.post('/lost-password', function(req, res){
    // look up the user's account via their email //
        AM.getEmail(req.param('email'), function(o){
            if (o){
                res.send('ok', 200);
                EM.dispatchResetPasswordLink(o, function(e, m){
                // this callback takes a moment to return //
                // should add an ajax loader to give user feedback //
                    if (!e) {
                    //  res.send('ok', 200);
                    }   else{
                        res.send('email-server-error', 400);
                        for (k in e) console.log('error : ', k, e[k]);
                    }
                });
            }   else{
                res.send('email-not-found', 400);
            }
        });
    });

    app.get('/reset-password', function(req, res) {
        var email = req.query["e"];
        var passH = req.query["p"];
        AM.validateLink(email, passH, function(e){
            if (e != 'ok'){
                res.redirect('/');
            } else{
    // save the user's email in a session instead of sending to the client //
                req.session.reset = { email:email, passHash:passH };
                res.render('reset', { title : 'Reset Password' });
            }
        })
    });

    app.post('/reset-password', function(req, res) {
        var nPass = req.param('pass');
    // retrieve the user's email from the session to lookup their account and reset password //
        var email = req.session.reset.email;
    // destory the session immediately after retrieving the stored email //
        req.session.destroy();
        AM.setPassword(email, nPass, function(o){
            if (o){
                res.send('ok', 200);
            }   else{
                res.send('unable to update password', 400);
            }
        })
    });

// view & delete accounts //

    app.get('/print', function(req, res) {
        AM.getAllRecords( function(e, accounts){
            res.render('print', { locals: { title : 'Account List', accts : accounts } });
        })
    });

    app.post('/delete', function(req, res){
        AM.delete(req.body.id, function(e, obj){
            if (!e){
                res.clearCookie('user');
                res.clearCookie('pass');
                req.session.destroy(function(e){ res.send('ok', 200); });
            }   else{
                res.send('record not found', 400);
            }
        });
    });

    app.get('/reset', function(req, res) {
        AM.delAllRecords( );
        res.redirect('/print');
    });

    app.get('*', function(req, res) { res.render('404', { title: 'Page Not Found'}); });

};

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:13:33.280

要启用像您这样的[快速助手](http://everyauth.com/#express-helpers)`everyauth.loggedIn`，您必须调用：

```
everyauth.helpExpress(app); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-12T02:24:43.750

我不确定为什么您的代码不起作用。我有一个可以正常工作的示例，但它需要 mongodb。如果您想尝试，只需推送到 github。 [链接到 github](http://github.com/foxgaocn/nodejs_express_everyauth_facebook_example)

# sql - 如何将 $node->nid 传递到更新语句中

> ID：14076085
> 
> 赞同：0
> 
> 时间：2012-12-28T21:32:52.747
> 
> 标签：sql, drupal-7

我正在尝试使用以下代码更新 Drupal 7 中的节点。

```
db_update('table')
  ->fields(array('column1' => 1))
  ->condition('entity_id', 2, '=')
  ->execute(); 
```

该语句按预期工作： column1 的值更新为 1，其中 entity_id = 2。

但是，我试图用当前节点替换 2 。

如果我使用`return $node->nid;`，则当前节点将按预期返回。如果我尝试`$node->nid`输入查询，它不会验证。

以下代码不返回任何内容；查询失败。

```
db_update('table')
  ->fields(array('column1' => 1))
  ->condition('entity_id', $node->nid, '=')
  ->execute(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T01:28:55.420

黑暗中的总刺：

尝试

```
global $node; 
```

在上述行之前。

或者只是将一个变量分配给 Return %node->nid

并将变量放在你有 $node->nid 的地方？

# php - 将解析的数据分组为“喜欢”组

> ID：14076088
> 
> 赞同：0
> 
> 时间：2012-12-28T21:33:27.070
> 
> 标签：php, arrays, sorting, loops

我目前有一个脚本，它解析一个包含（例如）100 行的文本文件，来自 10 个不同的用户，并且每行都提取一个`$userName`，`$timestamp`以及各种其他内容。有没有一种方法可以让我循环遍历（在解析之后）并`$userName`一次使用一组。

最终目标是一次将数据输入 google docs 1 个用户。

我尝试过使用`$i`，`$i++`但是由于我的主循环是数组中的一个数组，所以事情变得有点傻。

我想要的是能够看到以下内容

```
$userName   |   $timeStamp
mhopkins321 |    13-12-30
mhopkins321 |    14-59-01
mhopkins321 |    19-32-59 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:52:04.157

您只需要制作正确的数组结构：

```
$users = array(
    'mhopkins321' => array(
        '13-12-30',
        '14-59-01',
         ...
    ),
    'anotherUser' => array(
          ...
    )
); 
```

因此，当您解析并遇到用户名和时间戳时：

```
$users[$username][] = $timestamp; 
```

当你想制作那张桌子时

```
foreach($users as $user) {
    foreach ($user as $timestamp) {
        echo $user."| ".$timestamp."\n";
    }
} 
```

...可能有更好的格式，但你去吧。

# java - FloodFill - 扫雷，需要解释

> ID：14076090
> 
> 赞同：1
> 
> 时间：2012-12-28T21:33:35.170
> 
> 标签：java, algorithm, flood-fill

我正在尝试用 Java 制作类似扫雷的游戏，并且我已经完成了大部分工作。我需要帮助的是 FloodFill - [http://en.wikipedia.org/wiki/Flood_fill](http://en.wikipedia.org/wiki/Flood_fill)。

有人可以解释它是如何工作的吗？我在网上看过，但我不太明白解释，所以我认为在这里问会更容易。

在我的扫雷中，我有：

```
JButton[] btn = new JButton[100]//buttons being clicked and displaying the values/bombs
int[] mines = new int[100];//int array holding the values for each button. 
```

网格是一个 10x10 的网格，所以说你点击的按钮是 btn[14]，

```
btn[4]  // north of btn[14](14-10)
btn[24] // south of btn[14](14+10)
btn[13] //  west of btn[14](14-1)
btn[15] //  east of btn[14](14+1) 
```

回到这个问题，有人可以向我解释一下吗？

**编辑：** 我将我的代码更改为 2D，所以现在不是上面的代码

```
btn[1][4]//row one, column 4 
```

单击按钮时，我希望它检查一个名为 mines[][] 的变量，该变量具有值，如果该值等于 0（在初始单击附近），它会更改 BG

```
btn[x][y].setBackground(Color.GRAY); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T21:39:19.597

它是一种递归算法。您从 2D 网格 [x,y] 中的某个起始位置开始，然后查看所有方向并尽可能填充它们。如果 (x,y) 无法填写，则返回。

```
void floodFill( int x, int y ) {
   if ( btn( x, y ) isFillable ) {
       fillBtn(x,y);
       floodFill( x+1, y );
       floodFill( x-1, y );
       floodFill( x, y-1 );
       floodFill( x, y+1 );
   } else {
       return;
   }
} 
```

（省略检查网格边界）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T01:34:38.910

我想你主要是在问洪水填充。实际上它是一种简单而通用的递归算法。它可以解决您的数据结构是 1D 还是 2D 的任何问题。对于 2D 版本，@RMoeller 给出了答案。对于您之前的一维声明，它也类似于这样：

```
void floodFill( int pos ) {
   if ( btn( pos ) isFillable ) {
       fillBtn(pos);
       floodFill( pos+1 );
       floodFill( pos-1 );
       floodFill( pos+10 );
       floodFill( pos-10 );
   } else {
       return;
   }
} 
```

您应该记住的一件事是，floodfill 和几乎所有递归算法都需要检查边界。否则你可能会陷入无限循环或得到错误的结果。在上面的例子中（一维版本），你应该检查是否： pos >= 1 && pos <= 100 类似于要检查的二维版本：​​ x >= 1 && x <= 10 && y>=1 && y <=10

希望这可以帮助。

# javascript - 结合 fancyBox 脚本

> ID：14076091
> 
> 赞同：0
> 
> 时间：2012-12-28T21:33:43.967
> 
> 标签：javascript, fancybox

我是fancyBox的新手，在组合一些命令时遇到了麻烦——我希望这里有人能帮助我。我想结合以下三个脚本，但到目前为止我还没有运气。我很茫然，不胜感激。

# 1：http://jsfiddle.net/ZePx5/

```
$(".fancybox").fancybox({
helpers : {
    title: {
        type: 'outside'
    }
} 
```

});

# 2：http://jsfiddle.net/nJfAZ/

```
$(".fancybox")
.attr('rel', 'gallery')
.fancybox({
    padding : 0
}); 
```

# 3：http://jsfiddle.net/vkDcG/

```
$(".fancybox")
.attr('rel', 'gallery')
.fancybox({
    beforeLoad: function() {
        this.title = $(this.element).attr('caption');
    }
}); 
```

我希望 fancyBox 可以同时处理所有 3 个条件，但是当我尝试将它们结合起来时，我只是不断地破坏 fancyBox。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:43:48.760

您好，解决方案应该是：

```
$(".fancybox")
.attr('rel', 'gallery')
.fancybox({
    helpers : {
        title: {
            type: 'outside'
        }
    },
    padding : 0,
    beforeLoad: function() {
        this.title = $(this.element).attr('caption');
    }
}); 
```

# jquery - .val() 不会在外部脚本上触发事件 onchange

> ID：14076093
> 
> 赞同：2
> 
> 时间：2012-12-28T21:33:58.283
> 
> 标签：jquery, events, triggers, onchange

我发现这个颜色选择器[http://pastebin.com/17cPkjAT](http://pastebin.com/17cPkjAT) 我的问题是，如果通过 jquery 将文本设置到输入框，颜色选择器将不会“听到”新文本。

例子：

1.  我使用鼠标将颜色设置为黑色
2.  我通过jquery将颜色设置为白色

唯一改变的是文本，而不是颜色，结果：

![在此处输入图像描述](../Images/1ff636ad4c5a32e73b3550b7c3ad39dd.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T21:39:03.617

Call `.change()` after updating the value:

```
$(selector).val("#FFFFFF").change(); 
```

# android - Android - LinearLayout 上的下拉刷新功能

> ID：14076096
> 
> 赞同：1
> 
> 时间：2012-12-28T21:34:15.013
> 
> 标签：android, android-linearlayout, pull-to-refresh

我想问我可以在线性布局控件上实现下拉刷新选项吗，我也读过[这个](https://stackoverflow.com/questions/4583484/how-to-implement-android-pull-to-refresh)和其他示例，但它们都是针对“ListView”控件的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T12:03:56.230

@MH

看看 Chris Banes 的 pull-to-refresh 实现，它可用于多个视图，包括 ListView、GridView、ScrollView 和 WebView。您也许可以简单地使用 ScrollView 版本并将其包裹在您的 LinearLayout 周围。或者，使用该库中的构建块来实现您自己的应该相对容易。

这对我有用。

# android - 关闭刷新线程时崩溃

> ID：14076099
> 
> 赞同：-1
> 
> 时间：2012-12-28T21:34:50.907
> 
> 标签：android

如果我启用每秒刷新线程，我制作了一个音乐播放器，每次尝试关闭它时都会崩溃（刷新是为了更新歌曲的经过时间和进度条）。这是代码：

```
/**
 * Background Runnable thread
 * */
private Runnable mUpdateTimeTask = new Runnable() {
       public void run() {
           long totalDuration = mp.getDuration();
           long currentDuration = mp.getCurrentPosition();

           // Displaying Total Duration time
           songTotalDurationLabel.setText(""+utils.milliSecondsToTimer(totalDuration));
           // Displaying time completed playing
           songCurrentDurationLabel.setText(""+utils.milliSecondsToTimer(currentDuration));

           // Updating progress bar
           int progress = (int)(utils.getProgressPercentage(currentDuration, totalDuration));
           //Log.d("Progress", ""+progress);
           songProgressBar.setProgress(progress);

           // Running this thread after 100 milliseconds
           mHandler.postDelayed(this, 100); //this line is causing errors
       }
    }; 
```

这一切都在活动中再次起作用，但是一旦我按下后退按钮，它就会崩溃。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:38:48.853

Try stopping the future callbacks with [`removeCallbacks()`](http://developer.android.com/reference/android/os/Handler.html#removeCallbacks%28java.lang.Runnable%29) in `onPause()` or a similar method:

```
mHandler.removeCallbacks(mUpdateTimeTask); 
```

* * *

> if I enable refreshing the thread every sec

You seem to want to run your code once a second, but you use...

```
// Running this thread after 100 milliseconds
mHandler.postDelayed(this, 100); //this line is causing errors 
```

Understand that Handlers and Runnables are not created in a new Thread by default and that a 100 millisecond delay executes your code 10 times a second.

# eclipse - 如何在 Eclipse IDE 中保存运行和调试配置

> ID：14076100
> 
> 赞同：1
> 
> 时间：2012-12-28T21:34:54.010
> 
> 标签：eclipse

如何在 Eclipse IDE 中保存运行和调试配置？基本上，我在工作中所做的很多事情都需要我配置我经常运行的应用程序，但我忘记了这些配置，如果我必须重新安装 eclipse，最好对它们进行备份。任何帮助表示赞赏。

这是我拥有的版本：

适用于 Java 开发人员的 Eclipse IDE 版本：Indigo Service Release 1 Build id：20110916-0149

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:58:31.817

*   运行应用程序一次
*   转到运行-> 运行配置
*   选择应用程序的现有启动配置
*   点击常用选项卡
*   配置另存为 -> 共享文件

如果您将它们存储在工作区之外的某个地方（例如，在共享驱动器上），您可以稍后将它们导入到不同的工作区：文件 -> 导入 -> 运行/调试 -> 启动配置。

如果您愿意，您也可以选择一个配置作为收藏夹：

*   单击工具栏中的绿色运行图标
*   选择整理收藏夹
*   添加所需的启动配置

# ruby-on-rails - 我想在 RoR 中创建一个 ajax 驱动的静态站点

> ID：14076105
> 
> 赞同：0
> 
> 时间：2012-12-28T21:35:12.860
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的目标是创建一个基于 Rails 的站点，该站点使用 AJAX 来获取不同的部分。该网站不应该完全刷新。我正在使用 Rails 3.2.8。

网上有很多关于如何实际实现这一点的相互矛盾的文章。在我看来，简单地获取 pages.json 并使用 javascript 就可以实现我的目标，但这是“rails”方式吗？

用户将看到的每个页面都是静态的。我将使用 Rails 作为管理员来对它们进行 CRUD，但仅此而已，这部分不需要是 AJAX。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:02:59.063

看看[backbone.js](http://backbonejs.org/)。对于一个 ajax 繁重的网站，这正是您帮助组织代码并使前端与数据库保持一致所需要的。另外，请查看有关在 Rails 项目中实施骨干网的[优秀 railscast](http://railscasts.com/episodes/323-backbone-on-rails-part-1)。

我注意到你说的是静态网站。好吧，如果站点是完全静态的，为什么还要使用 Rails 之类的东西呢？我建议只用 html 和 javascript 对其进行编码，因为 rails 旨在用于动态的、数据库驱动的站点。

# twilio - 类似于 Tropo 的 Twilio 脚本引擎

> ID：14076106
> 
> 赞同：0
> 
> 时间：2012-12-28T21:35:24.370
> 
> 标签：twilio, tropo

Tropo 有一个脚本引擎，我们可以使用它以脚本语言为语音和短信应用程序编写代码。例如，接听电话的 python 代码看起来像，

```
answer()
say("thanks for calling")
transfer("tel:+1xxxxxxxxxx")
hangup() 
```

Twilio 是否有类似的功能。我看到他们在他们的 SDK 上有 Python 包装器，使用它可以做类似的事情。但我需要找出 Twilio 是否有类似的东西。

谢谢，gg

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:10:24.327

如果您需要执行任何*动态*操作（根据呼叫者以不同方式响应），您需要向 Twilio 提供一个 URL，然后在该 URL 处使用[TwiML](http://www.twilio.com/docs/api/twiml)进行响应。

您可以使用帮助程序库使用 Python[创建 TwiML：使用 twilio-python 创建 TwiML](https://twilio-python.readthedocs.org/en/latest/usage/twiml.html)

如果您以相同的方式响应每个呼叫（例如*静态*回复），则 Twilio 具有[Twimlet](http://twimlets.com)，您可以使用它来创建功能的小片段，例如说一条消息，然后拨打一个新号码。您可以使用 Twilio 托管 Twimlet，因此您不需要自己的服务器。

# c - 如何处理用于两件事柠檬解析器的相同符号

> ID：14076107
> 
> 赞同：3
> 
> 时间：2012-12-28T21:35:32.950
> 
> 标签：c, parsing, lemon

我正在开发一种特定领域的语言。语言的一部分与 C 表达式完全一样，解析判据和符号等语义。

我正在使用柠檬解析器。我遇到了一个问题，即同一个令牌被用于两种不同的事情，我无法分辨词法分析器中的区别。& 符号用于“按位与”和“地址”。

起初我认为这是一个微不足道的问题，直到我意识到它们没有相同的关联性。

如何给同一个令牌两个不同的关联性？我应该只使用 AMP（如与符）并使 addressof 和按位和规则使用 AMP，还是应该使用不同的令牌（例如 ADDRESSOF 和 BITWISE_AND）。如果我确实使用了单独的符号，我应该如何从词法分析器中知道哪个符号（如果不是解析器本身就无法知道！）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:56:48.620

如果你要明确地写出规则，为每个“优先级”级别使用不同的非终端，那么你根本不需要声明优先级，你不应该这样做。

Lemon 与所有 yacc 派生词一样，使用优先级声明来消除歧义语法中的歧义。所指的特定模棱两可的语法是这样的：

```
expression: expression '+' expression
          | expression '*' expression
          | '&' expression
          | ... etc, etc. 
```

在这种情况下，每一个备选方案都会导致班次减少冲突。如果您的解析器生成器没有优先规则，或者您想要精确，则必须将其编写为明确的语法（这就是您所做的）：

```
term: ID | NUMBER | '(' expression ')' ;
postfix_expr:        term | term '[' expression '] | ... ;
unary_expr:          postfix_expr | '&' unary_expr | '*' unary_expr | ... ;
multiplicative_expr: unary_expr | multiplicative_expr '*' postfix_expr | ... ;
additive_expr:       multiplicative_expr | additive_expr '+' multiplicative_expr | ... ;
...
assignment_expr:     conditional_expr | unary_expr '=' assignment_expr | ...; 
expression:          assignment_expr ;
[1] 
```

请注意，明确的语法甚至显示左结合（乘法和加法，上面）和右结合（赋值，虽然有点奇怪，见下文）。所以真的没有歧义。

现在，优先声明（`%left`,`%right`等）*仅*用于消除歧义。如果没有歧义，则*忽略*声明。解析器生成器甚至不检查它们是否反映了语法。（其实很多语法都不能用这种优先关系来表达。）

因此，如果语法明确，则包含优先级声明是一个非常糟糕的主意。他们可能是完全错误的，并且会误导任何阅读语法的人。更改它们不会影响语言的解析方式，这可能会误导任何想要编辑语法的人。

至少有一些问题是使用带有优先规则的歧义语法还是使用明确的语法更好。对于`C`-like 语言，其语法不能用简单的优先级列表表示，最好只使用明确的语法。然而，明确的文法有更多的状态并且可能使解析稍微慢一些，除非解析器生成器能够优化掉单位减少（上述文法中的所有第一个替代方案，其中每个表达式类型可能只是前一个不影响 AST 的表达式类型；这些产生式中的每一个都需要减少，尽管它主要是无操作的，并且许多解析器生成器会插入一些代码。）

原因`C`不能简单地表示为优先关系，恰恰是赋值运算符。考虑：

```
a = 4 + b = c + 4; 
```

这不会解析，因为在 中`assignment-expression`，赋值运算符只能在左侧应用于 a `unary-expression`。这并不反映`+`和之间可能的数字优先级`=`。[2]

如果`+`的优先级高于`=`，则表达式将解析为：

```
a = ((4 + b) = (c + 4)); 
```

如果`+`优先级较低，它将解析为

```
(a = 4) + (b = (c + 4)); 
```

* * *

[1] 我刚刚意识到我遗漏了 cast_expression 但我无法将其重新放入；你明白了）

[2] 描述已修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:36:53.130

后来我意识到我在取消引用（***）和乘法（*）之间也有同样的歧义。

Lemon 提供了一种为规则分配优先级的方法，在句点后使用方括号中的关联声明 (%left/right/nonassoc) 中使用的名称。

我还没有验证这是否正常工作，但我认为你可以做到这一点（注意最后方括号中的内容）：

```
.
.
.

%left COMMA.
%right QUESTION ASSIGN
    ADD_ASSIGN SUB_ASSIGN MUL_ASSIGN DIV_ASSIGN MOD_ASSIGN
    LSH_ASSIGN RSH_ASSIGN AND_ASSIGN XOR_ASSIGN OR_ASSIGN.
%left LOGICAL_OR.
%left LOGICAL_AND.
%left BITWISE_OR.
%left BITWISE_XOR.
%left BITWISE_AND.
%left EQ NE.
%left LT LE GT GE.
%left LSHIFT RSHIFT.
%left PLUS MINUS.
%left TIMES DIVIDE MOD.
//%left MEMBER_INDIRECT ->* .*
%right INCREMENT DECREMENT CALL INDEX DOT INDIRECT ADDRESSOF DEREFERENCE.

.
.
.

multiplicative_expr ::= cast_expr.
multiplicative_expr(A) ::= multiplicative_expr(B) STAR cast_expr(C). [TIMES]
    { A = Node_2_Op(Op_Mul, B, C); }
.
.
.
unary_expr(A) ::= STAR unary_expr(B). [DEREFERENCE]
    { A = Node_1_Op(Op_Dereference, B); } 
```

# javascript - 添加记录并检索生成的密钥

> ID：14076112
> 
> 赞同：0
> 
> 时间：2012-12-28T21:36:27.770
> 
> 标签：javascript, html, windows-8, microsoft-metro, indexeddb

> **可能重复：**
> [获取 IndexedDB 中添加记录的键](https://stackoverflow.com/questions/14068171/get-key-of-added-record-in-indexeddb)

我在这里问了这个问题：[Get key of added record in IndexedDB](https://stackoverflow.com/questions/14068171/get-key-of-added-record)但我不知道为什么它被否决了。我现在花了很多时间研究这个问题。

这是添加记录的代码

```
var request = objectStore.put({ entryType: entryType, entryDate: t });
        request.onsuccess = function (event) {
            console.log("Saved with id ", evt.result)
            var key = evt.result;
        }; 
```

但是，键值显示为未定义。我只阅读了这篇关于在交易后立即获取密钥的文章[http://msdn.microsoft.com/en-us/magazine/gg679063.aspx](http://msdn.microsoft.com/en-us/magazine/gg679063.aspx)。我找不到其他任何东西。我想我在这里缺少一些基本的东西..？

# objective-c - 如何使用 iTunes.h/Scripting Bridge 从专辑中获取所有曲目

> ID：14076113
> 
> 赞同：1
> 
> 时间：2012-12-28T21:36:38.907
> 
> 标签：objective-c, macos, cocoa, itunes

我想使用 iTunes 从专辑中获取所有曲目`iTunes.h`。
现在我通过以下方式获取当前曲目的数据：

```
NSInteger trackID = iTunes.currentTrack.databaseID;
NSString *name  = iTunes.currentTrack.name; 
```

以及专辑名称：

```
NSString *trackAlbum = iTunes.currentTrack.album; 
```

但是知道我不知道如何获取与当前曲目在同一专辑中的所有曲目。
有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:54:26.413

iTunes API 写得不好。您必须使用谓词过滤数组。

```
NSArray *allSongs = [self allSongs];
NSArray *songsOfAlbum = [allSongs filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"album == %@ && artist == %@", albumString, artistString]]; 
```

你可以得到所有这样的歌曲：

```
// Get all Songs
- (NSArray *)allSongs {
    if (_allSongs == nil) {

        NSArray *tracksToPlay = [(SBElementArray *)[self.library tracks] get];

        // Sort by artist
        _allSongs = tracksToPlay;
    }

    return _allSongs;
}

- (iTunesLibraryPlaylist *)library {
    if (_library == nil) {
        // Whole Library
        iTunesSource *source = [[[[self.iTunes sources] get] filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"kind == %i", iTunesESrcLibrary]] objectAtIndex:0];
        // Only the Music
        _library = [[[[source playlists] get] filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"specialKind == %i", iTunesESpKMusic]] objectAtIndex:0];
    }

    return _library;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-31T10:35:02.050

您可以将[iTunes Library Framework](https://developer.apple.com/library/mac/documentation/iTunesLibrary/Reference/iTunesLibraryFrameworkReference/_index.html#//apple_ref/doc/uid/TP40012886) (10.9 osx) 用于 iTunes 11。

```
#import <iTunesLibrary/ITLibrary.h>
#import <iTunesLibrary/ITLibMediaItem.h>
#import <iTunesLibrary/ITLibAlbum.h>

NSError *error = nil;
ITLibrary *library = [ITLibrary libraryWithAPIVersion:@"1.0" error:&error];
if (library)
{
        NSArray *tracks = library.allMediaItems; //  <- NSArray of ITLibMediaItem
}
for (ITLibMediaItem *item in tracks) {
       NSLog(@"tracks %@",item.album.title);
} 
```

[您可以从ITLibMediaItem](https://developer.apple.com/library/mac/documentation/iTunesLibrary/Reference/ITLibMediaItem_reference/translated_content/ITLibMediaItem.html#//apple_ref/doc/uid/TP40012813)获取专辑信息

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-02-18T14:32:39.017

作为检索艺术品的示例，我提交了一个 github 存储库：这是一个客观的 c 代码，使用上述代码更改：

```
 #import <Foundation/Foundation.h>
    #import <iTunesLibrary/ITLibrary.h>
    #import <iTunesLibrary/ITLibMediaItem.h>
    #import <iTunesLibrary/ITLibArtwork.h>
    int main(int argc, const char * argv[]) {
    @autoreleasepool {
        NSError *error = nil;
        ITLibrary *library = [ITLibrary libraryWithAPIVersion:@"1.0" error:&error];
        NSFileManager *fileManager = [NSFileManager defaultManager];

        if (library)
        {
            //NSArray *playlists = library.allPlaylists; //  <- NSArray of ITLibPlaylist
            NSArray *tracks = library.allMediaItems; //  <- NSArray of ITLibMediaItem
            [tracks enumerateObjectsUsingBlock:^(ITLibMediaItem*  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
                if (obj.artworkAvailable) {
                    ITLibArtwork* artWork=obj.artwork;
                    //NSData* d=artWork.imageData;
                    switch (artWork.imageDataFormat) {
                        case ITLibArtworkFormatPNG:{
                            NSURL* fileURL=obj.location;
                            NSString* fs=fileURL.lastPathComponent;
                            NSString* path=[fileURL.path stringByReplacingOccurrencesOfString:fs withString:@"Folder.png"];
                            if (![fileManager fileExistsAtPath:path]){
                                [artWork.imageData writeToFile:path atomically:YES];
                            }
                        }
                            break;
                        case ITLibArtworkFormatJPEG:{
                            NSURL* fileURL=obj.location;
                            NSString* fs=fileURL.lastPathComponent;
                            NSString* path=[fileURL.path stringByReplacingOccurrencesOfString:fs withString:@"Folder.jpg"];
                            if (![fileManager fileExistsAtPath:path]){
                                [artWork.imageData writeToFile:path atomically:YES];
                            }
                        }
                            break;
                        default:
                            break;
                    }
                }
            }];
            NSLog(@"End reached");
        }
    }
    return 0;
    } 
```

[https://github.com/ENees/iTunesGetImages](https://github.com/ENees/iTunesGetImages)

# webview - Android Webview Load Local Files in to Online Website

> ID：14076117
> 
> 赞同：0
> 
> 时间：2012-12-28T21:37:01.800
> 
> 标签：webview

I have made a Webview app to load a online site in to the view. now i want to save the css and java script files into the app assets dictionary to save trafik and speed for the website. But i cant load the picture from the assets dictionary. can anyone tell me what i am doihng wrong?

mWebView.loadUrl("http://www.XXX.de/android/index.html");

here the html file on an server:

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Hallo</title>
</head>
<body>
<center>hans hallo</center>
<center><img src="file:////Android/data/com.news/files/weltuntergang.png" height="200" width="200"></center>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T10:42:41.790

利用

> 文件：///android_asset/

指向您的资产目录

代替

> file:////Android/data/com.news/files/

可能您需要在 webview 中使用*loadDatawithBaseurl*才能顺利工作（根据我的经验和指南推荐）

# android - Cannot step through code while debugging android NDK project

> ID：14076123
> 
> 赞同：2
> 
> 时间：2012-12-28T21:37:38.430
> 
> 标签：android, android-ndk, android-debug

I am trying to learn how to use ffmpeg for android, and am trying setup this project to start with: [https://github.com/appunite/AndroidFFmpeg](https://github.com/appunite/AndroidFFmpeg)

It worked great with a few URLs I tried. I then compiled ffmpeg with mms protocol and wma support, and tried to open one media. The player returns cannot open media with error code -1\. I can see it read the headers of the media in the logcat. I tried to debug and see why it gives me error, so I put a breakpoint @ jni_player_set_data_source function in player.c file. I followed [these instructions](http://mhandroid.wordpress.com/2011/01/23/using-eclipse-for-android-cc-debugging/) to start ndk debugging in eclipse. After a few tries, it reached the breakpoint and I could continue or stop at the breakpoints in native code. But I cannot step in through the code, and cannot see the values of the variables. I put three breakpoints in that functions, I can step from one breakpoint to another, but thats about all I can do. How can I step through the code and more see the values of the variables?

*   I have FFMpegLibrary project setup as "is library" in eclipse.
*   The FFMpegExample uses FFMpegLibrary
*   I am debugging FFMpegExample as "Android application"
*   I am then letting the jni libs to load and then run ndk-gdb-eclipse
*   Then I go back to eclipse and start debugging the FFMpegLibrary native debug configuration. Then I can hit F8 on the java debug, and the execution stops at the native code. I can press F8 again to go to next native code's breakpoint but I cannot do F5, F6 or F7 (any code stepping) there. The icons for those are diabled in the toolbar.

Please let me know if you need more information to understand my setup.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T20:17:56.813

我放弃了尝试进一步调试该代码并使用 Vitamio 库。如果您只是在寻找一些支持比默认媒体播放器库更多格式和协议的 android 媒体播放器库，请使用[Vitamio 捆绑包](http://vitamio.org/vitamios?locale=en)。我不知道许可证是如何工作的。我只是需要测试一些东西，所以，我没有费心去找出它。如果您设法使调试工作，请分享您的经验。

# r - 将新数据附加到 R 中的现有数据框 (RDS)

> ID：14076126
> 
> 赞同：7
> 
> 时间：2012-12-28T21:37:45.100
> 
> 标签：r, stream, append, dataframe

我有一个 Rscript，它以平面文件的形式读取恒定的数据流。另一个脚本获取这个平面文件，进行一些解析和处理，然后将结果保存为 RDS 格式的 data.frame。然后它休眠，并重复该过程。

```
saveRDS(tmp.df, file="H:/Documents/tweet.df.rds") #saving the data.frame 
```

在第二次...第 n 次迭代中，我的代码仅处理自上次迭代以来添加到平面文件中的新行。但是，为了将增量线附加到永久数据帧，我必须将其读入、附加，然后将其保存回来，覆盖原始数据。

```
df2 <- readRDS("H:/Documents/tweet.df.rds") #read in permanent                      
tmp.df2 <- rbind(df2, tmp.df) #append new to existing
saveRDS(tmp.df2, file="H:/Documents/tweet.df.rds") #save it
rm(df2) #housecleaning
rm(tmp.df2) #housecleaning 
```

这种方法是有风险的，因为每当 RDS 打开以进行读/写时，另一个想要接触该文件的进程必须等待。随着基础文件变大，风险也会增加。

是否有类似`appendRDS`（我知道字面上没有）可以实现我想要的东西 - 单个数据帧的迭代更新 - 保存到文件 - 使用追加而不是完全替换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T23:22:41.367

我认为您可以通过使用连接来保护您的流程，在下一个流程接管之前打开和关闭它。

```
con <- file("tmp.rds")
open(con)
df <- readRDS(con)
df.new <- rbind(df,df)
saveRDS(df.new, con)
close(con) 
```

更新：

您可以测试与文件的连接是否打开，如果您遇到并发问题，请告诉它稍等片刻。

```
while(is.Open(con)) { # untested but something of this nature should work
sys.Sleep(2)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T00:27:40.897

在目录中使用一系列编号的 RDS 文件而不是单个 RDS 文件有什么问题吗？我认为不可能在不重写整个文件的情况下将 RDS 文件附加到数据帧，因为数据帧只是列的列表，所以大概它们一次序列化一列，所以只有最后一列结束文件末尾附近。

如果您想坚持使用单个文件但尽量减少从 RDS 文件中读取不一致数据的风险，您可以将其读入，执行附加操作，然后将其写入临时文件并将临时文件重命名为原始文件完成后命名。那么至少您的风险期不取决于文件的大小。我不熟悉将文件重命名为现有名称时各种文件系统保证什么样的原子性，但它可能比 saveRDS 所花费的时间要好。

# mysql - Struggling with a query, join, in

> ID：14076127
> 
> 赞同：0
> 
> 时间：2012-12-28T21:37:51.857
> 
> 标签：mysql, join

I am struggling with a query. And wondering if someone could help.

I have a table of tags (service request tickets) and a table of serial numbers

From my tags I am doing this

```
Select * from tag 
where
tag.created
BETWEEN '2012-9-01'
AND '2012-12-29' 
and
tag.tagtype <> 'service' 
```

Now, i would like to join with serialnumber (table) where (not sure inner/outer or just join)

tag.serialnumberid is in serialnumber.id and serialnumber .modelid = 80

I am thinking it should be easy. Any help would be appreciated

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:42:06.180

```
Select * from tag 
join serialnumber on tag.serialnumberid = serialnumber.id
where
   tag.created BETWEEN '2012-9-01' AND '2012-12-29' 
     and
  tag.tagtype <> 'service'
     and serialnumber.modelid = 80; 
```

# jquery - How to detect if element was faded out

> ID：14076129
> 
> 赞同：6
> 
> 时间：2012-12-28T21:38:05.687
> 
> 标签：jquery, if-statement, fadein, fadeout

I want to have two buttons, one to fade div1 out, and one either to fade div1 in, or to fade out the button itself, if the div1 is already hidden. here's the code, pretty unnecessary though, cause my main problem is "if" statement...

```
$('#b > button').click(function(){
    $('#div1').fadeOut(400)
});

$('#div2 > button').click(function(){
    $('#div1').fadeIn(400)
}); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-28T21:41:18.987

FadeOut 只是将 更改`display`为`none`.

`$('selector').css('display')`使用 jQuery或检查显示是否无`$('selector').is(':visible')`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T21:52:10.107

为什么不禁用/启用按钮？

```
$('#b > button').click(function(){
    $('#div1').fadeOut(400, function() {
        $(this).prop('disabled', true);
        $('#div2 > button').prop('disabled', false);
    });
});

$('#div2 > button').click(function(){
    $('#div1').fadeIn(400, function() {
        $(this).prop('disabled', true);
        $('#b > button').prop('disabled', false);
    });
}); 
```

# html - Open a link via a button press chosen from a form select option

> ID：14076130
> 
> 赞同：2
> 
> 时间：2012-12-28T21:38:07.847
> 
> 标签：html, forms, url, select

I have a small form which is dynamically built using a list of URLs.

```
<form> 
  <select>
    <option value="google.com">google.com</option>
    <option value="bing.com">bing.com</option>
  </select>
  <button class="btn" type="button">Go!</button>
</form> 
```

By hitting the 'Go!' button I would like to open a new window with the correct URL.

I'm pretty sure I can't do this through straight HTML but is there a jQuery way?

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:42:47.103

```
$('button').click(function() {
   url = $('select').val();
   window.open(url);
}); 
```

# c++ - How to proceed further in this 8 queen algorithm?

> ID：14076136
> 
> 赞同：-1
> 
> 时间：2012-12-28T21:38:49.983
> 
> 标签：c++, c, backtracking

The code and output is working fine before backtracking but I am not able to proceed for backtracking. What to do do after unplacing? It is giving the output of first 4 queens only means before backtracking.

```
 #include <iostream>
    #include <conio.h>
    using namespace std;
    int recu(int i,int k);
    void place(int i,int k);
    void unplace(int i,int k);
    int q[8][8];
    int row[8];
    int column[8];
    int c[15];
    int d[15];
    int totalqueens=0;
    int s;

    int main()
    {
        for(int i=0;i<8;i++) //Flags for rows,columns and diagonals
        {
        row[i]=0;
        column[i]=0;
        c[i]=0;d[i]=0;
        }
        for(int i=8;i<15;i++)
        {
        c[i]=0;d[i]=0;
        }
        int i=0;
        int k=0;
        recu(i,k);

      for(int i=0;i<8;i++)
      {
          for(int k=0;k<8;k++)
          {
                if(q[i][k]==1)
                {
                   cout<<"(";
                   cout<<i;
                   cout<<",";
                   cout<<k;
                   cout<<")";
                }
           }
     }

    getch();
    return 0;
}

int recu(int i,int k)
{ 
     if(totalqueens==8)
     {  goto print; }
     if(k<8)
      {
          if(column[i]==0 && row[k]==0 && c[i+k]==0 && d[i-k+7]==0)
           {
             place(i,k);

             s=k;
             k=0;
             recu(i+1,k);
           }
           else
           { 
             recu(i,k+1);
             unplace(i-1,s);
            //**I am not able to proceed further**
           }

      }

print:
    ;
}

void place(int i,int k)
{     
    totalqueens++;
    q[i][k]=1;
    row[k]=1;
    column[i]=1;
    c[i+k]=1;
    d[i-k+7]=1;
}

void unplace(int i,int k)
{
    q[i][k]=0;
    row[i]=0;
    column[k]=0;
    c[i+k]=0;
    d[i-k+7]=0;
    //cout<<"before call";
    recu(i,k+1);
    //cout<<"working";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T21:45:04.427

当没有放置所有皇后并且您不能放置另一个皇后时，您会回溯。你回溯如下：

1.  看看最后放置的皇后是否可以放在后面的位置。如果是这样，请将其放在那里并停止回溯。（继续放置。）

2.  删除最后放置的皇后。

3.  如果没有皇后了，就停下来。已找到所有解决方案。

4.  转到步骤 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T01:42:27.897

您的代码只给出了一种解决方案。您没有将输出部分放在正确的位置。

试试这样：

```
void print()
{
      for(int i=0;i<8;i++)
      {
          for(int k=0;k<8;k++)
          {
                if(q[i][k]==1)
                {
                   cout<<"(";
                   cout<<i;
                   cout<<",";
                   cout<<k;
                   cout<<")";
                }
           }
     }
} 
```

使它成为一种方法。然后，在您的 recu 方法中，修改为：

```
if(totalqueens==8)
{
    print();
    return;
} 
```

请记住，不要使用 goto 语句。它非常丑陋，可能会导致未知问题。

# jquery - Jsonp On Server. Properly naming Json file

> ID：14076140
> 
> 赞同：0
> 
> 时间：2012-12-28T21:39:07.480
> 
> 标签：jquery, json

I have seen a code for a countdown timer, that goes as follows:

```
jQuery(function() {

    var days, goLive, hours, intervalId, minutes, seconds;
    goLive = function() {
        $(".countdown_timer").hide();
        return $(".live_now").show();
    };
    days = void 0;
    hours = void 0;
    minutes = void 0;
    seconds = void 0;
    intervalId = void 0;
    return $.ajax({
        url: "http://(mywebdomain.com)/json/next",
        dataType: "jsonp",
        success: function(data) {
            var seconds_till;
            $("#churchonline_counter").show();
            if (typeof data.current_timestamp !== "undefined") {
                return goLive();
            } else if (typeof data.next_timestamp !== "undefined") {
                seconds_till = data.next_timestamp - (new Date().getTime() / 1000);
                hours = Math.floor((seconds_till % 86400) / 3600);
                minutes = Math.floor((seconds_till % 3600) / 60);
                seconds = Math.floor(seconds_till % 60);
                return intervalId = setInterval(function() {
                    if (--seconds < 0) {
                        seconds = 59;
                        if (--minutes < 0) {
                            minutes = 59;
                            if (--hours < 0) {
                                hours = 23;
                            }
                        }
                    }
                    $(".counter_h").html((hours.toString().length < 2 ? "0" + hours : hours));
                    $(".counter_m").html((minutes.toString().length < 2 ? "0" + minutes : minutes));
                    $(".counter_s").html((seconds.toString().length < 2 ? "0" + seconds : seconds));
                    if (seconds === 0 && minutes === 0 && hours === 0) {
                        goLive();
                        return clearInterval(intervalId);
                    }
                }, 1000);
            }
        }
    });
}); 
```

But I do not know how to create the JSON file on my web server so that it will read the data properly? I have tried uploading a file called "next" as a simple text file on my server using Filezilla that looked as follows:

```
({"next_timestamp":1356751800,"next_duration":3600,"next_title":"Title","next_description":"Description"}) 
```

But I think I am missing something on this Json uploaded file? I know my code works in the javascript, but the Json file I am not sure what to do with. How do I name or alter the Json file to properly have the javascript parse it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:04:30.920

这个倒计时脚本是专门为 Churchonlineplatform.org 用户编写的，作为该站点的用户，我可以告诉你，这行内容如下：

```
url: "http://(mywebdomain.com)/json/next", 
```

只是一个样本，实际上应该是

```
url: "http://mywebdomain.com/json/next", 
```

希望这可以帮助

# gdi+ - Alternative for GDI+

> ID：14076141
> 
> 赞同：7
> 
> 时间：2012-12-28T21:39:09.203
> 
> 标签：gdi+

I like GDI+ because its high performance and it's included with Windows XP. However, its blur class and effect class is only available in GDI+ 1.1, which only comes with Windows Vista or later. Despite the fact that Microsoft plans to drop support for Windows XP soon, there are still a large percentage of people who are still sticking with XP. If you make any consumer-targeted software, you have to support Windows XP. But unfortunately, GDI+ 1.1 is not redistributable under XP.

I tried a couple of opensource image libraries. However, when it comes to performance, for example, the gaussian blurring operation, they are significantly slower than gdi+.

Can anyone recommend a better alternative to GDI+ with XP support?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T05:10:32.463

我很惊讶您会发现[GDI+ Blur 因其](http://msdn.microsoft.com/en-us/library/windows/desktop/ms534422%28v=vs.85%29.aspx)性能而具有吸引力。

请注意，与 GDI 的前身不同，GDI+ 不是硬件加速的（基于 CPU 的渲染） - 请参阅[本文](http://en.wikipedia.org/wiki/Graphics_Device_Interface)了解 XP、Vista、W7 上的 GDI/GDI+ 的一些详细信息，包括比较两者的一些基本渲染基准。

正如 Abdias Software 所提到的，WPF BlurEffect 是一个很好的解决方案，因为它使用 DirectX 进行渲染。

高性能高斯模糊的另一个选择是实现基于 GPU 的模糊（通过某些 GPU 加速 API 中的着色器，例如 OpenGL/GLSL、DirectX 或 Direct2D）例如：[http://callumhay.blogspot。 com/2010/09/gaussian-blur-shader-glsl.html](http://callumhay.blogspot.com/2010/09/gaussian-blur-shader-glsl.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:36:28.597

GDI+ 已在[Legacy graphics](http://msdn.microsoft.com/en-us/library/windows/desktop/hh309470%28v=vs.85%29.aspx)下排序。

MS 现在采用的替代方案是 Windows Presentation Foundation，简称 WPF。这在 XP 下也可用，并且比 GDI+ 性能更好。

或者就像我们过去所做的那样，从头开始编写代码（尽管它并不适合所有人）。或者作为替代方案，您可以通过锁定位图直接操作缓冲区并通过字节数组添加卷积或平均（用于模糊）。

注意：GDI+ 确实通过其 Matrix 类支持卷积。

还有更底层和高性能的[DirectX 。](https://en.wikipedia.org/wiki/DirectX)

就我个人而言，我喜欢/更喜欢 GDI+，并在需要时使用缓冲区操作。我不担心这和 XP 会很快消失，即使 MS 放弃了它的支持。

# objective-c - 添加代码以动态阻止

> ID：14076145
> 
> 赞同：0
> 
> 时间：2012-12-28T21:39:29.790
> 
> 标签：objective-c, c, dynamic, objective-c-blocks, mutable

我对使用块很陌生。我想知道是否有办法将代码动态添加到块中？如果你愿意，一个可变块。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T21:50:58.757

这听起来并不像您想要的那样，但如果不是完全相同的话，它也会获得类似的结果：`__block NSMutableArray`从外部块中顺序调用一个块。

一个愚蠢的演示：

```
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{
    @autoreleasepool {

        __block NSMutableArray *subblocks = [NSMutableArray array];

        void (^blockWithBlocks)(void) = ^{
            NSLog(@"%s: in blockWithBlocks()", __PRETTY_FUNCTION__);

            for (void (^subblock)(void) in subblocks) {
                subblock();
            }
        };

        for (int i = 0; i < 3; i++) {
            void (^subblock)(void) = ^{
                NSLog(@"%s: in subblock %d", __PRETTY_FUNCTION__, i);
            };
            [subblocks addObject:subblock];
        }

        blockWithBlocks();

    }

    return 0;
} 
```

请注意，在 ARC 下复制块的要求一直在变化。以前，有必要在[clang 文档](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#blocks) 中描述的当前语义下编写`[subblocks addObject:[subblock copy]];`而不是简单地编写`[subblocks addObject:subblock];`

> 除了作为初始化 __strong 参数变量或读取 __weak 变量的一部分完成的保留之外，每当这些语义要求保留块指针类型的值时，它都具有 Block_copy 的效果。当优化器发现结果仅用作调用的参数时，它可能会删除此类副本。

唯一需要复制一个块以确保它不再在堆栈上的情况是，当该块作为参数传递给具有`__strong`参数变量的函数/方法时，以及从该块被读取时一个`__weak`变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T02:32:48.877

你是什​​么意思“动态添加代码到块”？这与简单地从“代码”和原始块创建一个新块有什么不同？

如果不同之处在于您希望获得对块的引用并更改其行为而不必为该引用分配新块，那么您可以让块捕获可变状态，其中可变状态可以包含块（s ) 调用，然后您可以更改它，就像@NateChandler 建议的那样。

如果不同之处在于您可以在几个不同的“代码”之间进行选择，因此您不能在创建块的地方对其进行硬编码，那么您可以将“代码”变成块并选择正确的块放入新块。

# php - Mutiple Highcharts with different ajax calls

> ID：14076148
> 
> 赞同：1
> 
> 时间：2012-12-28T21:39:54.463
> 
> 标签：php, ajax, cakephp, highcharts

I'd like to know the proper way to make a dashboard with multiple highcharts in a single page, I'm loading data to the charts with AJAX from a PHP method.

With 1 chart I'm doing it like this:

Controller

```
public function random_values(){
    //CakePHP code
    $this->autoRender = FALSE;

    header("Content-type: text/json");
$x = time() * 1000;
$y = rand(1,100);
$ret = array($x, $y);
echo json_encode($ret);
} 
```

View

```
<script type="text/javascript">

    var chart; //global
    function requestData() {
        $.ajax({
            url: 'singlecharts/random_values',
            success: function(point) {
                var series = chart.series[0],
                    shift = series.data.length > 20; // shift if the series is longer than 20

                // add the point
                chart.series[0].addPoint(eval(point), true, shift);

                // call it again after one second
                setTimeout(requestData, 1000);
            },
            cache: false
        });
    }

    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                defaultSeriesType: 'spline',
                events: {
                    load: requestData
                }
            },
            title: {
                text: 'Live random data'
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150,
                maxZoom: 20 * 1000
            },
            yAxis: {
                minPadding: 0.2,
                maxPadding: 0.2,
                title: {
                    text: 'Value',
                    margin: 80
                }
            },
            series: [{
                name: 'Random data',
                data:  []
            }]
        });
    });
</script> 
```

But how do I do to make many charts, everyone with its own ajax request.

Any help will be appreciated it, thank you.

EDIT

This is what I've tried so far and isn't working.

Controller:

```
public function random_one(){
    $this->autoRender = FALSE;

    //Set the JSON header
    header("Content-type: text/json");

    //The x value is the current JavaScript time, ...
    $x = time() * 1000;

    //The y value is a random number
    $y = rand(1,100);

    //Create a PHP array and echo it as JSON
    $ret = array($x, $y);
    echo json_encode($ret);
}

public function random_two(){
    $this->autoRender = FALSE;

    //Set the JSON header
    header("Content-type: text/json");

    //The x value is the current JavaScript time, ...
    $x = time() * 1000;

    //The y value is a random number
    $y = rand(1,100);

    //Create a PHP array and echo it as JSON
    $ret = array($x, $y);
    echo json_encode($ret);
} 
```

View

```
<script type="text/javascript">
    var chart; //global
    function requestData() {
        $.ajax({
            url: 'charts/random_one',
            success: function(point) {
                var series = chart.series[0],
                    shift = series.data.length > 20; // shift if the series is longer than 20

                // add the point
                chart.series[0].addPoint(eval(point), true, shift);

                // call it again after one second
                setTimeout(requestData, 1000);
            },
            cache: false
        });
    }

    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                defaultSeriesType: 'spline',
                events: {
                    load: requestData
                }
            },
            title: {
                text: 'Live random data one'
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150,
                maxZoom: 20 * 1000
            },
            yAxis: {
                minPadding: 0.2,
                maxPadding: 0.2,
                title: {
                    text: 'Value',
                    margin: 80
                }
            },
            series: [{
                name: 'Random data #1',
                data:  []
            }]
        });
    });

    var chart2; //global
    function requestDataTwo() {
        $.ajax({
            url: 'charts/random_two',
            success: function(point) {
                var series = chart2.series[0],
                    shift = series.data.length > 20; // shift if the series is longer than 20

                // add the point
                chart2.series[0].addPoint(eval(point), true, shift);

                // call it again after one second
                setTimeout(requestData, 1000);
            },
            cache: false
        });
    }

    $(document).ready(function() {

        chart2 = new Highcharts.Chart({
            chart: {
                renderTo: 'container-two',
                defaultSeriesType: 'spline',
                events: {
                    load: requestDataTwo
                }
            },
            title: {
                text: 'Live random data two'
            },
            xAxis: {
                type: 'datetime',
                tickPixelInterval: 150,
                maxZoom: 20 * 1000
            },
            yAxis: {
                minPadding: 0.2,
                maxPadding: 0.2,
                title: {
                    text: 'Value',
                    margin: 80
                }
            },
            series: [{
                name: 'Random data #2',
                data:  []
            }]
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T14:23:20.713

问题是 Highcharts 演示告诉您在“容器”div 中呈现图表，而 CakePHP 默认布局也使用“容器”div。这两者之间发生了冲突。

感谢你们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:32:27.390

你的 setTimeout(requestData, 1000); 在 requestData 和 requestDataTwo 中是相同的。您需要它们彼此独立，否则，返回的总是不是 1，而是请求数量的两倍...

```
function requestDataTwo() {
  $.ajax({
    url: 'test.php?random_two',
    success: function(point) {
      var series = chart2.series[0],
      shift = series.data.length > 20; // shift if the series is longer than 20

      // add the point
      chart2.series[0].addPoint(eval(point), true, shift);

      // call it again after one second
      setTimeout(requestData, 1000); **<-- Change this here to requestDataTwo**
    },
    cache: false
  });
} 
```

同样...您需要将其添加到您的php“控制器”中

```
<?php
switch (key($_GET)) {

  case 'random_two':
    random_two();
    die();
break;

  case 'random_one':
    random_one();
    die();
    break;
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:30:15.707

如果您想首先在单个页面上使用多个图表，请为所有图表创建不同的变量，例如`var chart1, chart2;`

现在`$(document).ready`定义不同图表的所有图表变量，并给出适当的属性，尤其是`renderTo`属性。您可以通过对图表使用单独的`load`事件来为不同的图表定义不同的 ajax 调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T23:13:26.290

您是否在此处查看过有关堆栈溢出的类似帖子？

[无法在单个页面上显示多个 Highchart 在单个网页](https://stackoverflow.com/questions/11626830/cannot-display-multiple-highcharts-on-a-single-page)
[中管理多个](https://stackoverflow.com/questions/8253590/manage-multiple-highchart-charts-in-a-single-webpage)
[Highchart 在单个页面中使用多个 Highchart](https://stackoverflow.com/questions/11559497/using-multiple-highcharts-in-a-single-page)
[创建六个具有相同渲染，不同数据的图表（highchart ）](https://stackoverflow.com/questions/6361631/create-six-chart-with-the-same-rendering-different-data-highchart)

它还有助于查看 Highcharts 演示页面的源代码，该页面在一页上有许多图表，并查看它们是如何被调用的。
[Highcharts 演示](http://www.highcharts.com/demo/)

对不起，我不能提供更多帮助。今晚晚些时候可能有更多时间:)

# device - KVM - DMA with a passthrough device

> ID：14076153
> 
> 赞同：3
> 
> 时间：2012-12-28T21:40:28.367
> 
> 标签：device, qemu, kvm, dma, pass-through

I have several assumptions in mind please correct me if I'm wrong:

1.  Without a real IOMMU a DMA-Transfer would be a security risk, because a guest could transfer garbage in Host Memory.
2.  A valid DMA-Transfer between guest memory and passthrough device without a real IOMMU is not possible.
3.  The Host-OS is not aware of any DMA-related things related to the passthrough device

* * *

An now some questions:

*   related to Point 3: Is there a way to get any information about a DMA-Transfer with a passthrough device?
*   If I don't have DMA-Remapping on, would KVM complain about it?
*   Is there a possibillity to deny any DMA-related stuff for the guest with the passthrough device?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T22:53:26.027

在进行一些研究时遇到了这个老问题，并认为我会为任何感兴趣的人发布答案。

关于第 1 点。没有 IOMMU，您根本无法进行直通。I/O 设备位于内核空间中。来宾内核是一个用户进程，它只认为它在内核空间中运行。

至于问题：

使用仿真设备，仿真器代码会拦截所有 DMA 设置并确保它们有效。使用 PCI 直通，寄存器读取和写入将直接发送到设备，或发送到设备上的 VF 以用于 SR-IOV，因此 KVM 或客户机之外的任何其他代码没有机会验证、给出错误或抱怨。

# android - Android 获取可用于视频录制的编解码器

> ID：14076160
> 
> 赞同：2
> 
> 时间：2012-12-28T21:41:08.813
> 
> 标签：android, android-camera, galaxy, mediarecorder

我的应用程序必须使用用户选择的分辨率和编解码器参数来录制视频。

这是我获取可用视频分辨率的代码：

```
Camera camera=Camera.open();
Parameters params = camera.getParameters();
List<Size> sizes = params.getSupportedPreviewSizes(); 
```

但是如何为当前的 Android 设备获取可用的视频编解码器呢？我知道[https://developer.android.com/guide/appendix/media-formats.html](https://developer.android.com/guide/appendix/media-formats.html)和[https://developer.android.com/reference/android/media/MediaRecorder.VideoEncoder.html](https://developer.android.com/reference/android/media/MediaRecorder.VideoEncoder.html) Android 常量，但例如如果将视频编码器设置为 H.263，Galaxy S3 会因我的应用程序而失败。那么如何检查每个设备上可用的编解码器呢？

# c# - C# if else 逻辑错误

> ID：14076171
> 
> 赞同：1
> 
> 时间：2012-12-28T21:41:51.627
> 
> 标签：c#, winforms

我做了某种逻辑，但它得到错误？

这是我的代码

```
private static void DrawText(String text, Font font, Color textColor, Color backColor)
{
    Image img = new Bitmap(640, 360);
    Graphics drawing = Graphics.FromImage(img);

    Color color = textColor;
    if (text.Length <= 80) {
        Rectangle displayRectangle =
            new Rectangle(new Point(20, 100), new Size(img.Width - 1, img.Height - 1));
    } else {
        Rectangle displayRectangle =
            new Rectangle(new Point(20, 80), new Size(img.Width - 1, img.Height - 1));
    }
    StringFormat format1 = new StringFormat(StringFormatFlags.NoClip);
    StringFormat format2 = new StringFormat(format1);

     // ERROR ON NEXT LINE
    drawing.DrawString(text, font, Brushes.Red, (RectangleF)displayRectangle, format2);

    drawing.Dispose();
    string fileName = "f.png";
    string path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName);
    img.Save(path, System.Drawing.Imaging.ImageFormat.Png);

    img.Dispose();
} 
```

错误是

> 错误1 当前上下文中不存在名称'displayRectangle' C:\Documents and Settings\admin\My Documents\Visual Studio 2008>\Projects\template\template\Form1.cs 119 69 模板

在这一行

```
drawing.DrawString(text, font, Brushes.Red, (RectangleF)displayRectangle, format2); 
```

在 php 中逻辑是正确的，但是在 C# 中它得到错误？，如何在 C# 中执行此逻辑？

有什么帮助吗？（仍在学习 C#：D）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-28T21:43:01.893

将`Rectangle`定义移到`if` `else`块上方，使其不会超出范围。

```
Rectangle displayRectangle;

if (text.Length <= 80)
{
    displayRectangle = new Rectangle(new Point(20, 100), new Size(img.Width  img.Height - 1));
}
else
{
    displayRectangle = new Rectangle(new Point(20, 80), new Size(img.Width -  img.Height - 1));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T21:43:11.050

基本上，它不会那样工作:)

`if`在一个或一个`else`块中定义的变量，在`{`和之间`}`仅在该块中可见。这就是为什么您能够定义它两次，一次在`if`分支中，一次在`else`分支中。

所以解决方法是在分支前声明变量，然后在 if/else 分支中设置。

```
Rectangle displayRectangle; //declaration

if (text.Length <= 80)
{
  //setting
  displayRectangle = new Rectangle(new Point(20, 100), new Size(img.Width - 1, img.Height - 1));
}
else
{
  //setting
  displayRectangle = new Rectangle(new Point(20, 80), new Size(img.Width - 1, img.Height - 1));
}
....
//usage
drawing.DrawString(text, font, Brushes.Red, (RectangleF)displayRectangle, format2); 
```

此外，C# 编译器足够聪明，可以检测到每个分支中都设置了变量，所以当它到达它的使用代码时，它肯定会被设置。但是，如果不是在每个分支中都设置它，那将是一个编译错误，例如

```
if (text.Length <= 80)
{
  displayRectangle = ...;
}
else if (text.Length > 40)
{

  displayRectangle = ...;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-28T21:43:17.667

`displayRectangle`您可以在 if/else 逻辑之外定义变量：

```
Rectangle displayRectangle;
if (text.Length <= 80)
{
    displayRectangle = new Rectangle(new Point(20, 100), new Size(img.Width - 1, img.Height - 1));
}
else
{
    displayRectangle = new Rectangle(new Point(20, 80), new Size(img.Width - 1, img.Height - 1));
} 
```

现在这个变量将被外部范围所知。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-28T21:43:53.523

您不能使用在当前范围之外声明的变量。您已`displayRectangle`在 内部声明`if-clause`，因此它在外部“不可见”。

而是在外面声明它并在里面初始化它：

```
Rectangle displayRectangle = Rectangle.Empty;
if (text.Length <= 80)
{
     displayRectangle = new Rectangle(new Point(20, 100), new Size(img.Width - 1, img.Height - 1));
}
else
{
    displayRectangle = new Rectangle(new Point(20, 80), new Size(img.Width - 1, img.Height - 1));
} 
```

[8.5.1 局部变量声明](http://msdn.microsoft.com/en-us/library/aa664742%28v=vs.71%29.aspx)

> **在 local-variable-declaration 中声明的局部变量的范围是发生声明的块**。在局部变量的局部变量声明符之前的文本位置引用局部变量是错误的。在局部变量的范围内，声明另一个同名的局部变量或常量是编译时错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-28T21:45:15.760

将变量声明移到块外：

```
 Rectangle displayRectangle;
    if (text.Length <= 80)
    {
        displayRectangle = new Rectangle(new Point(20, 100), new Size(img.Width - 1, img.Height - 1));
    }
    else
    {
        displayRectangle = new Rectangle(new Point(20, 80), new Size(img.Width - 1, img.Height - 1));
    } 
```

问题是代码中 displayRectangle 的范围。一旦块执行完毕，displayRectangle 就被完全遗忘，因为它是在块内声明的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-28T21:47:11.313

我认为这是因为您的初始化。

它应该是这样的：

```
 private static void DrawText(String text, Font font, Color textColor, Color backColor)
 {
    Rectangle displayRectangle; // YOU MUST DECLARE IT HERE OR OUTSIDE THE FUNCTION,
                                // but never inside an "if" statement.
    Image img = new Bitmap(640, 360);
    Graphics drawing = Graphics.FromImage(img);

    Color color = textColor;
    if (text.Length <= 80) {
        displayRectangle =
           new Rectangle(new Point(20, 100), new Size(img.Width - 1, img.Height - 1));
    } else {
        displayRectangle =
           new Rectangle(new Point(20, 80), new Size(img.Width - 1, img.Height - 1));
    }
    StringFormat format1 = new StringFormat(StringFormatFlags.NoClip);
    StringFormat format2 = new StringFormat(format1);

    // ERROR ON NEXT LINE
    drawing.DrawString(text, font, Brushes.Red, (RectangleF)displayRectangle, format2);

    drawing.Dispose();
    string fileName = "f.png";
    string path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, fileName);
    img.Save(path, System.Drawing.Imaging.ImageFormat.Png);

    img.Dispose();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-28T22:28:11.070

如果你真的想要简洁，你可以用下面这行代码替换整个 IF/ELSE 块：

`var displayRectangle = new Rectangle(20, (text.Length > 80 ? 80 : 100), img.Width - 1, img.Height - 1);`

# php - PHP 上传到 MySQL 数据库并下载和查看文件

> ID：14076177
> 
> 赞同：0
> 
> 时间：2012-12-28T21:42:44.043
> 
> 标签：php, mysql, image, download

无法正确下载：无法打开链接。帮助表示赞赏。我是 PHP 和 MySQL 的新手。我已将内容的 MySQL 设置为 BLOB，但我不知道如何更清楚，我可以看到文件的链接，其中包含相应 id 到 url 中文件内容 $id 的链接，但是当我点击链接没有打开，我希望能够在browser中打开文件。我打算能够打开 .zip 文件并在以后的开发中提取。就安全性而言，还请详细解释一下，以便我学习。我看到我的代码是 mod，但仍然无法在数组链接中工作。

`UPLOAD.PHP`：

```
<?php 
$dbname="upload";
$host="localhost";
$user="SELF";
$pass="PICME";
$link = mysql_connect($hostname, $user, $pass);
mysql_select_db($dbname, $link);
?>
<form method="post" enctype="multipart/form-data">
   <table width="350" border="0" cellpadding="1" cellspacing="1" class="box">
      <tr> 
         <td width="246">
            <input type="hidden" name="MAX_FILE_SIZE" value="2000000">
            <input name="userfile" type="file" id="userfile"> 
         </td>
         <td width="80"><input name="upload" type="submit" class="box" id="upload" value=" Upload "></td>
      </tr>
   </table>
</form>
<?php
if(isset($_POST['upload']) && $_FILES['userfile']['size'] > 0)
{
$fileName = $_FILES['userfile']['name'];
$tmpName  = $_FILES['userfile']['tmp_name'];
$fileType = $_FILES['userfile']['type'];
$fileSize = $_FILES['userfile']['size'];
$fp      = fopen($tmpName, 'r');
$content = fread($fp, filesize($tmpName));
$content = addslashes($content);
fclose($fp);
if(!get_magic_quotes_gpc())
{
$fileName = addslashes($fileName);
}
$query = "INSERT INTO upload (name, type, size, content) ".
"VALUES ('$fileName', '$fileType', '$fileSize', '$content')";
mysql_query($query) or die('Error, query failed'); 
echo "<br>File $fileName uploaded<br>";
} 
?>'
(DOWNLOAD.PHP)FILE
'<?php
$dbname="upload";
$host="localhost";
$user="SELF";
$pass="PICME";
$link = mysql_connect($hostname, $user, $pass);
mysql_select_db($dbname, $link);
$query = "SELECT id, name FROM upload";
$result = mysql_query($query) or die('Error, query failed');
if(mysql_num_rows($result) == 0)
{
echo "Database is empty <br>";
} 
else
{
while(list($id, $name) = mysql_fetch_array($result))
{
?>
<a href="download.php?id=<?php echo urlencode($id);?>"><?php echo urlencode($name);?></a> <br>
<?php 
}
}
exit;
?>
<?php
$dbname="upload";
$host="localhost";
$user="SELF";
$pass="PICME";
$link = mysql_connect($hostname, $user, $pass);
mysql_select_db($dbname, $link);
$query = "SELECT id, name FROM upload";
if(isset($_GET['id'])) 
{
// if id is set then get the file with the id from database
$id    = $_GET['id'];
$query = "SELECT name, type, size, content " .
"FROM upload WHERE id = '$id'";
$result = mysql_query($query) or die('Error, query failed');
list($name, $type, $size, $content) =                     mysql_fetch_array($result);
$content = $row['content']; 
header("Content-Disposition: attachment; filename=$name");
header('Content-type: image/jpeg' . $type); // 'image/jpeg' for JPEG images
header('Content-Length:' . $size);
exit;
print $content;
ob_clean();
flush();
echo $content;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T00:14:12.983

似乎您在上传和下载时为 JPEG 设置 Mimetype 时没有验证文件的 Mime 类型。请确保您上传的文件格式正确。此外，在从 DB 检索时，id 被 urlencoded 但未解码。

# c++ - VB换行符转义字符？

> ID：14076179
> 
> 赞同：5
> 
> 时间：2012-12-28T21:42:48.493
> 
> 标签：c++, c, vb.net, newline, output

在 CI 中使用`"1st line 1\n2nd line"`换行符，但是 VB 呢？我知道`"1st line" & VbCrLf & "2nd line"`但它太冗长了，VB 中换行符的转义字符是什么？

我要打印

```
1st line
2nd line 
```

我尝试使用`\n`，但无论我运行编译器多少次，它总是输出这个

```
1st line\n2nd line 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T21:47:21.620

你应该使用`Environment.NewLine`. 在 Windows 上计算为 CR+LF，在 Unix 系统上计算为 LF。

VB 中没有 CR 或 LF 字符的转义序列。这就是为什么`"\n"`按字面意思对待的原因。所以，`Environment.NewLine`是你的家伙。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T21:59:01.017

正如其他人所说，您应该使用环境敏感`Environment.NewLine`属性。 `vbCrLf`是一个旧的 VB6 常量，它在 VB.NET 中提供用于向后兼容。因此，例如，您应该使用：

```
"1st line" & Environment.NewLine & "2nd line" 
```

如果当你有很多行时这太罗嗦了，你可以使用这个`StringBuilder`类，而不是：

```
Dim builder As New StringBuilder()
builder.AppendLine("line 1")
builder.AppendLine("line 2")
builder.AppendLine("line 3")
builder.AppendLine("line 4") 
```

如果您特别需要 CR 和 LF 字符，则应该使用`ControlChars`类中的常量而不是旧`vbCrLf`常量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T21:46:49.873

您说的是 VB，但使用 VB.NET 进行了标记。你的问题也有点奇怪。不同的操作系统实际上需要不同的换行符。你想要的是`Environment.NewLine`. 无论 .NET 框架在什么操作系统上运行，这都会为您提供正确的换行符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-26T22:32:54.880

我仍然使用老式`chr(13)` 的例如：

```
"Hello" & chr(13) & "World" 
```

结果是：

```
Hello
World 
```

编辑：就像***Dave Doknjas***所说，在你的情况下，它将是`chr(10)`为了喂线。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-27T18:58:50.620

如果您正在寻找内联转义来完成诸如在 String.Format 中包含换行符之类的事情，您可以包含一个管道或类似的东西，然后在字符串的末尾替换它。

> String.Format("Batch: {0} | ProductNumber: {1} | Formula: {2}", dr.Item("BatchNumber"), dr.Item("PartNum"), dr.Item("Formula") ).Replace("|", Environment.NewLine)

# ironpython - IronPython：如何从 .NET 程序集中获取 XML 文档字符串

> ID：14076184
> 
> 赞同：0
> 
> 时间：2012-12-28T21:43:14.047
> 
> 标签：ironpython, xml-documentation, docstring

如何使用 IronPython 从 .NET 程序集中获取 XML 文档字符串？使用' ***_*** *doc* ***_*** '似乎不是办法。

```
MessageBox.Show(Label().Bottom.__doc__) returns "Represents a 32bit signed integer." 
```

如何获取实际的文档字符串，应该是“获取底部边缘之间的距离，以像素为单位......”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:45:45.050

我刚刚发现您需要将 XML 文档与 exe、dll 放在同一目录中，它会被 IronPython 拾取。看这里：

[IronPython 使用 C# 模块文档](https://stackoverflow.com/questions/5428298/ironpython-use-c-sharp-module-documentation)

# c - 程序从键盘读取数据，将其写入文件并再次从文件中读取相同的数据并将其复制到另一个文件并显示？

> ID：14076185
> 
> 赞同：0
> 
> 时间：2012-12-28T21:43:14.350
> 
> 标签：c, file-io, input, output

这就是我到目前为止。我希望程序从键盘读取数据并将其写入一个名为 INPUT 的文件，再次从 INPUT 文件中读取相同的数据，然后复制到另一个文件并将其显示在屏幕上。我不知道我哪里出错了。请帮我。提前致谢。

```
#include<stdio.h>
#include<file.h>
main()
{
  FILE *f1,*f2;
  char c;
  printf(“data input\n\n”)
  f1 = fopen(“INPUT”, “w”);
  while((c = getchar())!=EOF)
    putc(c,f1);
  fclose(f1);
  printf(“\ndata output\n\n”)
  f1 = fopen(“INPUT”, “r”);
  while((c = getchar())!=EOF)
    putc(“%c”,c);
  fclose(f1);
  //copying f f1 data into f2
  f1=fopen(file1,”r”)
  if(f1=NULL)
  {
    printf(“no data”);
    exit(0):
  }
  f2=fopen(file2,”w”);
  if(f2=null)
  {
    printf(“cannot able to open”);
    exit(0);
  }
  while((ch==getc(f1)!=EOF)
    putc(ch,f2);
  printf(“completed”);
  fclose(f1);
  fclose(f2);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:47:11.810

您想与 NULL 进行比较：

```
 if(f1=NULL) 
```

但这分配了NULL。

另一个比较中的相同问题：

```
 if(f2=null) 
```

只需将它们更改为：

```
if(!f1) 
```

和

```
if(!f2) 
```

# windows-8 - Windows 8 Winrt 应用程序进入后台或关闭

> ID：14076188
> 
> 赞同：4
> 
> 时间：2012-12-28T21:43:31.470
> 
> 标签：windows-8, winrt-xaml, lifecycle

如何判断 Windows 8 Metro 应用程序何时被置于后台？暂停状态不会激活。我有一个断点。只有在我关闭应用程序时才会触发。

我正在使用网络摄像头，因为没有应用程序可以在后台运行，所以我需要在后台保存我的工作。

windows phone 它被应用程序停用。

你能帮忙的话，我会很高兴。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T01:40:49.713

应用程序在调试器中通常不会暂停。*但是，您可以通过以下方式在调试时*强制暂停：

1.  启用调试位置工具栏（下图中的红色箭头）。
2.  然后按暂停按钮（蓝色箭头）。

![暂停](../Images/0c73206b8fb092f0d28b74647fdb9a26.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:12:17.580

当应用程序不再处于活动状态时，即当另一个应用程序被带到前面时，应该触发暂停事件。假设您使用的是 C#/XAML，app.xaml.cs 文件已经连接了[Suspending](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.application.suspending.aspx)事件。在 HTML5/JavaScript 中它是[检查点](http://msdn.microsoft.com/en-us/library/windows/apps/br229839.aspx)，您会在 default.js 中看到它。

# android - Android 简单应用程序在我打开时崩溃

> ID：14076189
> 
> 赞同：-1
> 
> 时间：2012-12-28T21:43:36.060
> 
> 标签：android

我的主要课程：

```
package com.example.hi;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class SampleLogin extends Activity {

 EditText txtUserName;
 EditText txtPassword;
 Button btnLogin;
 Button btnCancel;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        txtUserName=(EditText)this.findViewById(R.id.txtUname);
        txtPassword=(EditText)this.findViewById(R.id.txtPwd);
        btnLogin=(Button)this.findViewById(R.id.btnLogin);
        btnLogin=(Button)this.findViewById(R.id.btnLogin);
        btnLogin.setOnClickListener(new OnClickListener() {

   @Override
   public void onClick(View v) {
    // TODO Auto-generated method stub

    if((txtUserName.getText().toString()).equals(txtPassword.getText().toString())){
           Toast.makeText(SampleLogin.this, "Login Successful",Toast.LENGTH_LONG).show();
          } else{
           Toast.makeText(SampleLogin.this, "Invalid Login",Toast.LENGTH_LONG).show();
          }

   }
  });       
    }
} 
```

我的 XML 文件...

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:stretchColumns="1">

<TableRow> 
 <TextView 
 android:text="@string/User_Name: " 
 android:id="@+id/TextView01" 
 android:layout_width="wrap_content" 
 android:layout_height="wrap_content">
 </TextView>

 <EditText 
 android:inputType="textPassword|number"
 android:text="" 
 android:id="@+id/txtUname" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content">

 </EditText>
</TableRow>

<TableRow>
 <TextView 
 android:text="@string/Password: " 
 android:id="@+id/TextView02" 
 android:layout_width="wrap_content" 
 android:layout_height="wrap_content">
 </TextView>

 <EditText 
 android:inputType="textPassword|number" 
 android:text="" 
 android:id="@+id/txtPwd" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content"  />

</TableRow>

<TableRow>
 <Button
 android:text="@string/Cancel" 
 android:id="@+id/btnCancel" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content">
 </Button>

 <Button
 android:text="@string/Login" 
 android:id="@+id/btnLogin" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content">
 </Button>

</TableRow>

</TableLayout> 
```

所以这是我的代码，由于某种原因，当我打开它时应用程序停止工作，“应用程序（）已意外停止。请重试avd ...”我不知道为什么会这样，请帮忙！

我是android新手，谁能告诉我如何获取catlog文件？

关于 xml 文件上的字符串，我还是新手，我收到关于“硬编码字符串”或类似内容的错误，它说我需要将它添加到 res 文件夹中找到的字符串文件中，所以我添加字符串，然后添加@string

猫日志文件：

```
12-28 17:36:50.883: E/Zygote(33): setreuid() failed. errno: 2
12-28 17:37:00.573: E/Zygote(33): setreuid() failed. errno: 17
12-28 17:37:01.933: E/BatteryService(61): usbOnlinePath not found
12-28 17:37:01.933: E/BatteryService(61): batteryVoltagePath not found
12-28 17:37:01.933: E/BatteryService(61): batteryTemperaturePath not found
12-28 17:37:01.953: E/SurfaceFlinger(61): Couldn't open /sys/power/wait_for_fb_sleep or /sys/power/wait_for_fb_wake
12-28 17:37:02.173: E/SensorService(61): couldn't open device for module sensors (Invalid argument)
12-28 17:37:06.682: E/System(61): Failure starting core service
12-28 17:37:06.682: E/System(61): java.lang.SecurityException
12-28 17:37:06.682: E/System(61):   at android.os.BinderProxy.transact(Native Method)
12-28 17:37:06.682: E/System(61):   at android.os.ServiceManagerProxy.addService(ServiceManagerNative.java:146)
12-28 17:37:06.682: E/System(61):   at android.os.ServiceManager.addService(ServiceManager.java:72)
12-28 17:37:06.682: E/System(61):   at com.android.server.ServerThread.run(SystemServer.java:206)
12-28 17:37:06.712: E/EventHub(61): could not get driver version for /dev/input/mouse0, Not a typewriter
12-28 17:37:06.712: E/EventHub(61): could not get driver version for /dev/input/mice, Not a typewriter
12-28 17:37:07.122: E/SoundPool(61): error loading /system/media/audio/ui/Effect_Tick.ogg
12-28 17:37:07.122: E/SoundPool(61): error loading /system/media/audio/ui/KeypressStandard.ogg
12-28 17:37:07.122: E/SoundPool(61): error loading /system/media/audio/ui/KeypressSpacebar.ogg
12-28 17:37:07.122: E/SoundPool(61): error loading /system/media/audio/ui/KeypressDelete.ogg
12-28 17:37:07.122: E/SoundPool(61): error loading /system/media/audio/ui/KeypressReturn.ogg
12-28 17:37:07.164: E/UsbObserver(61): java.lang.NullPointerException
12-28 17:37:07.164: E/UsbObserver(61):  at com.android.server.UsbObserver.init(UsbObserver.java:131)
12-28 17:37:07.164: E/UsbObserver(61):  at com.android.server.UsbObserver.<init>(UsbObserver.java:65)
12-28 17:37:07.164: E/UsbObserver(61):  at com.android.server.ServerThread.run(SystemServer.java:402)
12-28 17:37:07.673: E/ThrottleService(61): Could not open GPS configuration file /etc/gps.conf
12-28 17:37:08.392: E/logwrapper(135): executing /system/bin/tc failed: No such file or directory
12-28 17:37:08.392: E/logwrapper(136): executing /system/bin/tc failed: No such file or directory
12-28 17:37:08.432: E/logwrapper(138): executing /system/bin/tc failed: No such file or directory
12-28 17:37:35.198: E/AndroidRuntime(335): FATAL EXCEPTION: main
12-28 17:37:35.198: E/AndroidRuntime(335): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.hi/com.example.hi.MainActivity}: java.lang.ClassNotFoundException: com.example.hi.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.hi-1.apk]
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.os.Looper.loop(Looper.java:123)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.ActivityThread.main(ActivityThread.java:3683)
12-28 17:37:35.198: E/AndroidRuntime(335):  at java.lang.reflect.Method.invokeNative(Native Method)
12-28 17:37:35.198: E/AndroidRuntime(335):  at java.lang.reflect.Method.invoke(Method.java:507)
12-28 17:37:35.198: E/AndroidRuntime(335):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-28 17:37:35.198: E/AndroidRuntime(335):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-28 17:37:35.198: E/AndroidRuntime(335):  at dalvik.system.NativeStart.main(Native Method)
12-28 17:37:35.198: E/AndroidRuntime(335): Caused by: java.lang.ClassNotFoundException: com.example.hi.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.hi-1.apk]
12-28 17:37:35.198: E/AndroidRuntime(335):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
12-28 17:37:35.198: E/AndroidRuntime(335):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
12-28 17:37:35.198: E/AndroidRuntime(335):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
12-28 17:37:35.198: E/AndroidRuntime(335):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
12-28 17:37:35.198: E/AndroidRuntime(335):  ... 11 more
12-28 17:38:05.517: E/AndroidRuntime(344): FATAL EXCEPTION: main
12-28 17:38:05.517: E/AndroidRuntime(344): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.hi/com.example.hi.MainActivity}: java.lang.ClassNotFoundException: com.example.hi.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.hi-1.apk]
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.os.Looper.loop(Looper.java:123)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.ActivityThread.main(ActivityThread.java:3683)
12-28 17:38:05.517: E/AndroidRuntime(344):  at java.lang.reflect.Method.invokeNative(Native Method)
12-28 17:38:05.517: E/AndroidRuntime(344):  at java.lang.reflect.Method.invoke(Method.java:507)
12-28 17:38:05.517: E/AndroidRuntime(344):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-28 17:38:05.517: E/AndroidRuntime(344):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-28 17:38:05.517: E/AndroidRuntime(344):  at dalvik.system.NativeStart.main(Native Method)
12-28 17:38:05.517: E/AndroidRuntime(344): Caused by: java.lang.ClassNotFoundException: com.example.hi.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.hi-1.apk]
12-28 17:38:05.517: E/AndroidRuntime(344):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
12-28 17:38:05.517: E/AndroidRuntime(344):  at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
12-28 17:38:05.517: E/AndroidRuntime(344):  at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
12-28 17:38:05.517: E/AndroidRuntime(344):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
12-28 17:38:05.517: E/AndroidRuntime(344):  ... 11 more 
```

它不再崩溃，但我无法输入任何内容！我在 xml 文件中更改了一些关于打字的内容，因为它给了我一个问题

```
android:inputType="textPassword|number" 
```

我认为是这样，但是当我尝试输入某些内容时，它什么也没做！

这应该工作吗？

```
<EditText 
 android:inputType="textPassword|number" 
 android:text="" 
 android:id="@+id/txtPwd" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content"  />

 <EditText 
 android:inputType="textPassword|number"
 android:text="" 
 android:id="@+id/txtUname" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:14:14.220

从您的 LogCat 中：

```
Caused by: java.lang.ClassNotFoundException: com.example.hi.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.hi-1.apk] 
```

这意味着您可能将类名更改为`SampleLogin`from`MainActivity`但忘记更新清单。

将清单更新为如下所示：

```
<activity
    android:name=".SampleLogin"
    android:label="@string/app_name" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

（您还需要解决`android:text="@string/User_Name: "`，`android:text="@string/Password: "`正如我在评论中提到的那样，您才能再次编译您的应用程序。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T21:51:21.737

您应该查看 LogCat 以确切知道错误是什么。

我可以在您的代码中发现的唯一一件事是您正在初始化 btnLogin 两次并且错过了 btnCancel 的初始化。除非您在某处使用 btnCancel 对象，否则这不会是错误的根源。

```
 btnLogin=(Button)this.findViewById(R.id.btnLogin);
 btnLogin=(Button)this.findViewById(R.id.btnLogin); 
```

如果您可以从 LogCat 发布错误，它会更容易提供帮助。

**编辑**

在您的布局 XML 文件中，您有一些看起来很奇怪的东西

```
android:text="@string/Password: " 

android:id="@+id/TextView01" 
```

资源没有合适的名称，如果需要，它应该是**所有小写字母**，只有下划线作为单词分隔符。

# android - Android ScrollView 不滚动

> ID：14076195
> 
> 赞同：2
> 
> 时间：2012-12-28T21:44:11.557
> 
> 标签：android, android-layout, scrollview

我已经解决了我的问题。我选择了一个页眉和一个页脚，它们始终分别位于屏幕的底部和顶部。然后我创建了一个包含在 ScrollView 布局中的“中心内容”。如果人们有兴趣查看它现在的样子，我已经更新了下面的代码。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:focusable="true"
    android:focusableInTouchMode="true"
    android:background="#FFFFFF">

    <LinearLayout android:id="@+id/header"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@layout/header"
        android:layout_alignParentTop="true">
        <ImageView android:src="@drawable/logo"
            android:contentDescription="@string/logo_description"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="10dip"/>
    </LinearLayout>

    <ScrollView android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="350dip"
        android:layout_below="@id/header">
        <LinearLayout android:orientation="vertical"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:padding="20dip" >
            <!--  Email Label -->
            <TextView android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:textColor="#372C24"
                android:text="@string/email"/>
            <EditText android:id="@+id/email_field"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="5dip"
                android:singleLine="true"
                android:inputType="textEmailAddress"/>
            <!--  Password Label -->
            <TextView android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="10dip"
                android:textColor="#372C24"
                android:text="@string/password"/>
            <EditText android:id="@+id/password_field"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:singleLine="true"
                android:inputType="textPassword"/>
            <!-- Login button -->
            <Button android:id="@+id/login_button"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dip"
                android:text="@string/login"/>
            <!-- Register button -->
            <Button android:id="@+id/register_button"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="25dip"
                android:text="@string/register_button"/>
        </LinearLayout>
    </ScrollView>

    <LinearLayout android:id="@+id/footer"
        android:layout_width="fill_parent"
        android:layout_height="90dip"
        android:background="@layout/footer"
        android:layout_alignParentBottom="true">
    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-01T19:06:35.650

对我来说，删除文件`android:windowSoftInputMode="adjustPan"`中的`<activity>`标签`AndroidManifest.xml`解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T05:43:57.590

我从 AndroidManifest.xml 文件中删除了这一行

`android:theme="@android:style/Theme.NoTitleBar.Fullscreen"`

并添加了这一行

`android:theme="@android:style/Theme.NoTitleBar"`

它既修复了我的滚动应用程序，又使我的应用程序看起来更具视觉吸引力。但是，我不确定这是否是正确的解决方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-01-30T14:53:09.137

对我来说，问题是 ScrowView 中的 LinearLayout 有 android:layout_height="wrap_content"。

```
<ScrollView android:id="@+id/scroll_view1"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:fillViewport="true" >

<LinearLayout android:id="@+id/layout_inside"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" --> This should not we wrap_content, but specific height.
    android:orientation="vertical" > 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-09-10T02:20:15.283

ScrollView 在用作 XML 布局的根元素时不起作用。它必须被包裹在一个 LinearLayout 中。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ScrollView android:id="@+id/scroll_view1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fillViewport="true" >

    <LinearLayout android:id="@+id/layout_inside"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" > 
```

玩得开心！！

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-12-28T22:02:38.730

ScrollView 必须具有 Linearlayout 控件作为直接子级，您有相对布局，我认为这可能会导致问题。

检查[这个](http://www.androidaspect.com/2012/02/scrollview-tutorial-android-ui.html)链接，还有[这个](http://www.curious-creature.org/2010/08/15/scrollviews-handy-trick/)。看看他们的布局xmls ..

# python - 在 Python 2.7 中模拟按键事件

> ID：14076207
> 
> 赞同：8
> 
> 时间：2012-12-28T21:45:20.513
> 
> 标签：python, api, events, keyboard, simulation

我想要做的是从 Windows 上的 Python 脚本级别按任何键盘键。我试过 SendKeys 但它只适用于 python 2.6。我尝试过的其他方法包括

```
import win32com.client 
win32com.client.Dispatch("WScript.Shell").SendKeys('String to be typed') 
```

只允许从脚本级别键入字符串，但不允许按 ENTER 和其他“特殊”键。

因此我的问题是：如何从 python 脚本级别模拟任何键盘按键事件，包括“特殊”事件，如 ENTER、CTRL、ESC 等。

如果可以在任何指定时间内按住一个键并按 Alt+F4 等组合键，这也将非常有帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-04-06T13:29:17.073

我在一年多前编写了这段代码，所以它并不完美，但它可以工作：

```
from win32api import keybd_event
import time
import random

Combs = {
    'A': [
        'SHIFT',
        'a'],
    'B': [
        'SHIFT',
        'b'],
    'C': [
        'SHIFT',
        'c'],
    'D': [
        'SHIFT',
        'd'],
    'E': [
        'SHIFT',
        'e'],
    'F': [
        'SHIFT',
        'f'],
    'G': [
        'SHIFT',
        'g'],
    'H': [
        'SHIFT',
        'h'],
    'I': [
        'SHIFT',
        'i'],
    'J': [
        'SHIFT',
        'j'],
    'K': [
        'SHIFT',
        'k'],
    'L': [
        'SHIFT',
        'l'],
    'M': [
        'SHIFT',
        'm'],
    'N': [
        'SHIFT',
        'n'],
    'O': [
        'SHIFT',
        'o'],
    'P': [
        'SHIFT',
        'p'],
    'R': [
        'SHIFT',
        'r'],
    'S': [
        'SHIFT',
        's'],
    'T': [
        'SHIFT',
        't'],
    'U': [
        'SHIFT',
        'u'],
    'W': [
        'SHIFT',
        'w'],
    'X': [
        'SHIFT',
        'x'],
    'Y': [
        'SHIFT',
        'y'],
    'Z': [
        'SHIFT',
        'z'],
    'V': [
        'SHIFT',
        'v'],
    'Q': [
        'SHIFT',
        'q'],
    '?': [
        'SHIFT',
        '/'],
    '>': [
        'SHIFT',
        '.'],
    '<': [
        'SHIFT',
        ','],
    '"': [
        'SHIFT',
        "'"],
    ':': [
        'SHIFT',
        ';'],
    '|': [
        'SHIFT',
        '\\'],
    '}': [
        'SHIFT',
        ']'],
    '{': [
        'SHIFT',
        '['],
    '+': [
        'SHIFT',
        '='],
    '_': [
        'SHIFT',
        '-'],
    '!': [
        'SHIFT',
        '1'],
    '@': [
        'SHIFT',
        '2'],
    '#': [
        'SHIFT',
        '3'],
    '$': [
        'SHIFT',
        '4'],
    '%': [
        'SHIFT',
        '5'],
    '^': [
        'SHIFT',
        '6'],
    '&': [
        'SHIFT',
        '7'],
    '*': [
        'SHIFT',
        '8'],
    '(': [
        'SHIFT',
        '9'],
    ')': [
        'SHIFT',
        '0'] }
Base = {
    '0': 48,
    '1': 49,
    '2': 50,
    '3': 51,
    '4': 52,
    '5': 53,
    '6': 54,
    '7': 55,
    '8': 56,
    '9': 57,
    'a': 65,
    'b': 66,
    'c': 67,
    'd': 68,
    'e': 69,
    'f': 70,
    'g': 71,
    'h': 72,
    'i': 73,
    'j': 74,
    'k': 75,
    'l': 76,
    'm': 77,
    'n': 78,
    'o': 79,
    'p': 80,
    'q': 81,
    'r': 82,
    's': 83,
    't': 84,
    'u': 85,
    'v': 86,
    'w': 87,
    'x': 88,
    'y': 89,
    'z': 90,
    '.': 190,
    '-': 189,
    ',': 188,
    '=': 187,
    '/': 191,
    ';': 186,
    '[': 219,
    ']': 221,
    '\\': 220,
    "'": 222,
    'ALT': 18,
    'TAB': 9,
    'CAPSLOCK': 20,
    'ENTER': 13,
    'BS': 8,
    'CTRL': 17,
    'ESC': 27,
    ' ': 32,
    'END': 35,
    'DOWN': 40,
    'LEFT': 37,
    'UP': 38,
    'RIGHT': 39,
    'SELECT': 41,
    'PRINTSCR': 44,
    'INS': 45,
    'DEL': 46,
    'LWIN': 91,
    'RWIN': 92,
    'LSHIFT': 160,
    'SHIFT': 161,
    'LCTRL': 162,
    'RCTRL': 163,
    'VOLUP': 175,
    'DOLDOWN': 174,
    'NUMLOCK': 144,
    'SCROLL': 145 }

def KeyUp(Key):
    keybd_event(Key, 0, 2, 0)

def KeyDown(Key):
    keybd_event(Key, 0, 1, 0)

def Press(Key, speed=1):
    rest_time = 0.05/speed
    if Key in Base:
        Key = Base[Key]
        KeyDown(Key)
        time.sleep(rest_time)
        KeyUp(Key)
        return True
    if Key in Combs:
        KeyDown(Base[Combs[Key][0]])
        time.sleep(rest_time)
        KeyDown(Base[Combs[Key][1]])
        time.sleep(rest_time)
        KeyUp(Base[Combs[Key][1]])
        time.sleep(rest_time)
        KeyUp(Base[Combs[Key][0]])
        return True
    return False

def Write(Str, speed = 1):
    for s in Str:
        Press(s, speed)
        time.sleep((0.1 + random.random()/10.0) / float(speed)) 
```

例子：

```
>>> Write('Hello, World!', speed=3)
Hello, World!
>>> Press('ENTER') 
```

如果你想实现更多的键，那么你可以在[这里](https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx)找到它们的代码。只需将这些键添加到 Base 字典中。

# javascript - 用于转义 Java 正则表达式字符串的 JavaScript 函数

> ID：14076210
> 
> 赞同：2
> 
> 时间：2012-12-28T21:45:25.043
> 
> 标签：javascript, regex, escaping

StackOverflow 上的早期问题讨论了 JavaScript 正则表达式的转义，例如：

*   [如何在javascript中转义正则表达式？](https://stackoverflow.com/questions/2593637/how-to-escape-regular-expression-in-javascript)
*   [用于 Javascript 正则表达式的转义字符串](https://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex)

建议的实现如下：

```
RegExp.quote = function(str) {
     return str.replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1");
}; 
```

鉴于两种语言中的正则表达式并不相同，是否有人知道正确转义用于 Java 正则表达式的字符串的 JavaScript 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:49:44.567

根本没有必要逃避。**这些问题是关于在源语言**中将正则表达式构造为字符串时需要做什么。由于您正在从输入字段中读取字符串，因此无需担心解释层。

只需将字符串发送到服务器，就会发现它是否是有效的正则表达式。

*编辑*——虽然我想不出来，但真正要担心的可能是可以通过这种途径进行的任何类型的“注入”攻击。在我看来，如果您只是将正则表达式传递给`Pattern.compile()`没有任何可以利用的副作用渠道。

# c++ - 带 bo ost.Asio 的多线程服务器

> ID：14076211
> 
> 赞同：3
> 
> 时间：2012-12-28T21:45:39.097
> 
> 标签：c++, multithreading, sockets, boost, boost-asio

我正在尝试制作一个接收许多连接并处理它的服务器。我认为如果我将每个连接放在一个线程中会更好，但我不知道该怎么做，因为我仍然不知道如何告诉我的班级“我收到一个新连接，将它放入一个线程”。我很困惑，仍然没有在此处的其他帖子中找到它。请帮我。

obs：我有一个提示，它创建了一堆连接，所以等待客户端，但我不想这样做，我只想在有人试图进入我的服务器时创建一个连接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:07:24.067

Boost::Asio 文档的[异步 TCP 日间服务器教程](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/tutorial/tutdaytime3.html)准确描述了如何编写这样的服务器。

此外，在所有其他示例中还有许多多线程[示例](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/examples.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:05:40.163

查看 asio 文档中的示例。以下示例可以满足您的要求： [http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/echo/blocking_tcp_echo_server.cpp](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/echo/blocking_tcp_echo_server.cpp) 这将为每个连接创建一个新线程并使用阻塞调用。

请注意，您还可以使用异步调用并在一个线程中完成所有操作。例如：http: [//www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/echo/async_tcp_echo_server.cpp](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/echo/async_tcp_echo_server.cpp)

# javascript - HTML5 文本字段的正则表达式模式

> ID：14076214
> 
> 赞同：0
> 
> 时间：2012-12-28T21:45:47.270
> 
> 标签：javascript, jquery, html, regex

我想在 javascript 中为一个`html text field`需要地址的 regex 模式创建一个。所以我只希望用户输入`[a-z,A-Z,0-9]`并且只有这些符号`[,#-.]`我还想阻止用户发送空字符串并且最大字符数小于 100。

这是html `<input>`：

```
<input type="text" id="addy" maxlength="100"/> 
```

我是 javascript 新手，所以我不知道如何创建一个能够遵守正则表达式模式的函数。

谢谢

编辑

根据我的建议，`kolink`我尝试了这个：

```
 <input type="text" style="width:285px" placeholder="Enter A Precise Address" name="address0" id="address"
     pattern="[ a-zA-Z0-9,#.-]+" maxlength="100" title="Standard address notation only"/> 
```

这现在仅在`<select>`未选择另一个时才有效。否则它不会拾取`pattern`属性。然而，完全相同的代码在 jsfiddle 上按预期工作：http: [//jsfiddle.net/peD3t/7/](http://jsfiddle.net/peD3t/7/)但不在浏览器中。这是 pastebin 中的代码：http: [//pastebin.com/qQGJ4EK5](http://pastebin.com/qQGJ4EK5)

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T21:49:20.930

HTML5 为您提供了`pattern`属性，它允许您要求某种模式。在这种情况下，你会想要`pattern="[a-zA-Z0-9,#.-]+"`

旧浏览器不支持这一点并不重要，因为您应该始终在服务器端进行验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T10:48:01.530

$(文档).ready(函数 () {

```
$('input').keyup(function() {
    var $th = $(this);
    $th.val( $th.val().replace(/[^a-zA-Z0-9,#.-]/g, function(str) { return ''; } ) );
}); 
```

});

这将起作用。

# nhibernate - 内部连接后防止多个实例

> ID：14076217
> 
> 赞同：3
> 
> 时间：2012-12-28T21:46:12.353
> 
> 标签：nhibernate, queryover

在连接到另一个表后，我对同一对象的多个实例有一个小*问题。*为了测试，我`Store`用两个创建一个`Products`（ManyToMany-Relation）。以下片段希望描述我的问题。

```
var preResult = _session.QueryOver<Store>().List(); // One store

Product productAlias = null;
var result = _session.QueryOver<Store>()
    .JoinAlias(s => s.Products, () => productAlias)
    .List();                                        // Two instances of the same store 
```

我什至认为这种行为是正确的，但我怎样才能防止多个实例呢？可以在查询中吗？

* * *

只是为了了解为什么我需要进行这种*不必要*的连接：我想根据不同的条件扩展查询，类似于：

```
Product productAlias = null;
var query = _session.QueryOver<Store>().JoinAlias(s => s.Products, () => productAlias);
if (!string.IsNullOrWhiteSpace(criteria.ProductName))
{
    query.Where(Restrictions.On(() => productAlias.Name).IsInsensitiveLike(criteria.ProductName));
}

if (criteria.ProductType != null)
{
    query.Where(s => productAlias.Type == criteria.ProductType);
}

var result = query.List(); 
```

在这里，我遇到了不同的问题，具体取决于标准。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T00:33:49.773

尝试`Transformers.DistinctRootEntity`在您的场景中使用以消除笛卡尔积。

```
Product productAlias = null;
var query = _session.QueryOver<Store>()
                    .JoinAlias(s => s.Products, () => productAlias)

query = query.TransformUsing(Transformers.DistinctRootEntity);

var result = query.List(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T08:44:01.623

让我们将解决方案分成两个查询。

1.  前一个`QueryOver<Store>()`将正确返回一个不同的列表。更重要的是，通过设计它将支持分页（`Take()`, `Skip()`）。
2.  内部的，将只返回一个商店 ID 列表，它完全符合任何标准......

结果 SQL 将如下所示

```
SELECT ... // top one 
FROM Store
WHERE StoreID IN ( SELECT StoreID ...) // inner one 
```

### 内

让我们从内部选择开始，NHibernate detached `QueryOver`：

```
Store storeAlias = null;
Product productAlias = null;

// detached query, resulting in a set of searched StoreID 
var subQuery = QueryOver.Of<Store>(() => storeAlias)
    .JoinAlias((s) => s.Products, () => productAlias)
    .Select((s) => s.ID); // ID projection

if (!string.IsNullOrWhiteSpace(criteria.ProductName))
{
    subQuery.Where(Restrictions.On(() => productAlias.Code)
        .IsInsensitiveLike(criteria.ProductName));
} 
```

### 最佳

一旦我们过滤了商店，我们就可以在顶部使用这个子查询

```
var query = session.QueryOver<Store>()
   // IN clause
   .Where(Subqueries.PropertyIn("ID", subQuery.DetachedCriteria))
   .Skip(100) 
   .Take(50) // paging over already distinct resultset
   ;

var result = query.List<Store>(); 
```

现在我们可以将任何过滤器应用于内部查询，并获取满足过滤条件的商店 ID 列表......同时使用不同的顶级查询......

# php - 清理 Symfony 项目并安装新包

> ID：14076219
> 
> 赞同：1
> 
> 时间：2012-12-28T21:46:17.130
> 
> 标签：php, symfony

我对 Symfony 非常陌生，但我已经熟悉 MCV 模型，经过一段时间阅读文档后，我现在在我的服务器上运行了 Symfony 2 的标准版本。

## 新的开始

如您所知，Symfony 带有一个 hello world 应用程序和一些欢迎脚本，我怎样才能清理所有这些？更好的是，有没有办法在没有示例包的情况下安装 Symfony 项目？

## 数据库结构恢复

过去，每次我使用数据库开发应用程序时，我都会使用*phpmyadmin*创建表的结构，然后创建一个初始 php 脚本，如果我需要在其他服务器上安装我的应用程序，该脚本会恢复该数据库。使用 Symfony 是完全不同的，我读到它使用原则和 Symfony 核心使用一些内部文件恢复数据库格式。我有一个需要安装的包，我知道这个包/应用程序使用 MySQL，我使用我的所有 MySQL 信息设置了配置文件，但我不知道如何运行一个脚本来恢复该特定所需的干净数据库应用程序。我知道这有关系，`php app/console schema:update`但不太确定。

感谢任何方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:46:44.833

> 我怎样才能清理所有这些？更好的是，有没有办法在没有示例包的情况下安装 Symfony 项目？

在 Symfony2 中没有办法做到这一点，而且看起来它永远不会成为 Symfony2 项目的一部分：

> *“我认为我们需要关于如何手动删除 Acme 演示代码的明确说明。我是 -1，添加了一个 CLI 命令来自动执行此操作。
> ”* —— [github 上的 fabpot](https://github.com/symfony/symfony-standard/pull/412#issuecomment-10153889)

你应该做的事情：

1.  删除`src/Acme`目录
2.  删除`$bundles[] = new Acme\DemoBundle\AcmeDemoBundle();`（第 25 行）`app/AppKernel.php`
3.  `app/config/routing_dev.yml`从( `_welcome`,`_demo_secured`和`_demo`)中删除相关路由
4.  您**可以**删除`security:`钥匙中的所有内容`app/config/security.yml`并放入`enabled: false`其中。但是，这不是必需的，它就像一个很好的样板，用于您自己的安全

* * *

您的另一个问题： Symfony2 没有“视图”层。你可以选择使用任何你想要的东西。但是 Symfony2 默认在其框架中包含 2 个 ORM，Doctrine 和 Propel。您可以在文档中阅读有关如何使用这些库的更多信息：[Doctrine](http://symfony.com/doc/current/book/doctrine.html)和[Propel](http://symfony.com/doc/current/book/propel.html)。

# java - Android为什么我的adfonic插页式广告只出现一秒钟然后消失

> ID：14076223
> 
> 赞同：0
> 
> 时间：2012-12-28T21:46:42.620
> 
> 标签：java, android, interstitial

因此，正如问题所暗示的那样，我试图让全屏广告正常工作，我拥有它，所以它们确实出现了，但它们只在那里停留了 4 秒左右，然后消失了

我在做什么/做错了什么，我似乎无法从 adfonic 找到任何文档，而且所有的 admobs 似乎都太不一样了，无法提供任何帮助。

```
public class AdPage extends Activity implements OnClickListener {

Button Close;

private final static String TAG = "Testing";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.ad_layout);

    final AdfonicView adView = (AdfonicView) findViewById(R.id.adfonicView);

    adView.setAdListener(new AdListener() {

        @Override
        public void onReceivedAd() {
            Log.d(TAG, "AdListener onReceivedAd()");

            adView.showInterstitial();

        }

        @Override
        public void onPresentScreen() {
            Log.d(TAG, "AdListener onPresentScreen()");

        }

        @Override
        public void onNoFill() {
            Log.d(TAG, "AdListener onNoFill()");

        }

        @Override
        public void onNetworkError() {
            Log.d(TAG, "AdListener onNetworkError()");

        }

        @Override
        public void onLeaveApplication() {
            Log.d(TAG, "AdListener onLeaveApplication()");

        }

        @Override
        public void onInvalidRequest() {
            Log.d(TAG, "AdListener onInvalidRequest()");

        }

        @Override
        public void onInternalError() {
            Log.d(TAG, "AdListener onInternalError()");

        }

        @Override
        public void onDismissScreen() {
            Log.d(TAG, "AdListener onDismissScreen()");

        }

        @Override
        public void onClick() {
            Log.d(TAG, "AdListener onClick()");

        }
    }); 
```

这是布局

```
<com.adfonic.android.AdfonicView
    xmlns:adfonic="http://schemas.android.com/apk/lib/com.adfonic.android"
    android:id="@+id/adfonicView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    adfonic:adfonic_adslot_id="######"
    adfonic:language="en"
    adfonic:refresh_ad="true"
    adfonic:refresh_time="30" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T09:42:00.603

[http://developer.adfonic.com/index.php/Android_SDK](http://developer.adfonic.com/index.php/Android_SDK)

目前，对于插页式广告，Adfonic 的超时时间为 4 秒。

我相信在 SDK 的下一次更新中，他们将添加为插页式广告设置超时的功能。

# jenkins - 声纳在新分析中失去项目角色配置

> ID：14076224
> 
> 赞同：0
> 
> 时间：2012-12-28T21:46:47.287
> 
> 标签：jenkins, maven-3, sonarqube

我的服务器上运行着 Jenkins 和 Sonar 服务器（版本 3.4）。每次我的 Jenkins 进行构建时，都会使用 sonar-maven-plugin 2.0 触发声纳代码分析。我为我的开源项目设置了一些自定义声纳角色（设置 -> 安全 -> 角色），以便任何人都可以看到这些结果。但是每次进行新的分析时，sonar 似乎忘记了这个自定义角色并应用默认角色，因此匿名用户无法查看统计信息。

我正在使用 Jenkins 内部的 sonar-maven-plugin 2.0 运行声纳分析。有谁知道如何永久保存自定义声纳角色？

**默认角色：**

用户：声纳用户

代码查看器：声纳用户

**我的自定义角色：**

用户：任何人，声纳用户

代码查看器：任何人，声纳用户

**更新：**声纳 3.4 版/“角色”在此处定义：设置 -> 安全 -> 角色

[声纳管理面板](https://i.stack.imgur.com/8HHxx.png) ![声纳管理面板](../Images/3dfbd02475ce272dabd707a7db53ece3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:37:38.703

@Elton，这实际上是 Sonar 3.4 中引入的一个严重错误：http: [//jira.codehaus.org/browse/SONAR-4050](http://jira.codehaus.org/browse/SONAR-4050)。我们将修复它，下周应该可以使用 3.4.1 版本。

# objective-c - 订购特定格式的数字的 NSString（例如 3:23.123）？

> ID：14076228
> 
> 赞同：0
> 
> 时间：2012-12-28T21:47:03.960
> 
> 标签：objective-c, ios, cocoa, nsstring, nstimeinterval

我有`NSString`s 代表`mm:ss.SSS`我的应用程序中格式的时间。我正在尝试生成一个“最快时间”列表，并且我正在努力弄清楚要使用哪些数据类型来订购这些数字。

将这些字符串从最少到最多时间排序的最简单方法是什么？我假设转换为编号数据类型可以解决问题，但我应该使用什么数据类型？我需要保留`mm:ss.SSS`格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:53:19.913

如果您有`NSString`可以转换为对象的`NSDate`对象（例如，您可以使用合适的偏移量将其转换为 ISO 8601 格式），那么您可以非常轻松地`NSArray`对对象实例进行排序（[示例](https://stackoverflow.com/a/13324849/19410)）并从中挑选列表的顶部或底部，具体取决于您是按降序还是升序排序。`NSDate`

这种方法的优点是您使用的是标准日期处理函数，这可能会导致更少的代码和更少的调试。重新发明轮子可能会为您提供更快的解决方案，但也可能会引入错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T00:25:30.500

如果字符串格式正确，带有前导零，则形成 an`NSArray`然后调用`sortedArrayUsingComparator:`. 但是如果你有像 12:34.567 和 2:34.567 这样的值，这种方法就行不通了。您必须转换为`double`或`NSNumber`，存储秒数（即 2:34.567 转换为 154.567）。

请注意，这些不是 NSDate 对象。NSDate 标记了一个特定的时间瞬间，这些似乎只是持续时间。

如果你使用`NSNumber`，你仍然可以使用`sortedArrayUsingComparator:`。您必须编写 NSFormatter 的子类，以便在 mm:ss.SSS 和 NSNumber 之间进行转换并再次返回。

[有关基于块的示例](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html "基于块的示例")，请参阅 NSComparator 的文档。您还需要 NSFormatter 的类参考。GitHub 上的[FormatterKit 项目](https://github.com/mattt/FormatterKit "Github 上的 FormatterKit 项目")有一些不错的 NSFormatter 示例代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T10:46:12.520

你也可以使用 (abuse ?)`localizedStandardCompare:`来达到这个目的，因为该方法会根据它们的数值比较嵌入在字符串中的数字：

```
NSArray *times = @[ @"11:22.333", @"2:44.555" ];
NSArray *sortedTimes = [times sortedArrayUsingSelector:@selector(localizedStandardCompare:)];
NSLog(@"%@", sortedTimes); 
```

*输出：*

```
(
    "2:44.555",
    "11:22.333"
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T21:53:34.857

我的建议是创建自己的类来表示 mm、ss 和 SSS 的数据类型。然后，您可以为数据类型编写自己的漂亮打印和比较方法。compare 方法本身实现起来相当简单，然后您可以使用该 compare 方法对此类对象的数组进行排序。

# mysql - 在cygwin上安装mysql

> ID：14076235
> 
> 赞同：-1
> 
> 时间：2012-12-28T21:47:32.703
> 
> 标签：mysql, installation, cygwin

我正在尝试使用 cygwin 安装 mysql。这个[指南](http://www.ehow.com/how_8616340_install-mysql-cygwin.html)似乎正是我想要的。我下载了这个[页面](http://www.mysql.com/downloads/mysql/#downloads)的底部项目。然后我按照所有说明进行操作，但是 mysql 目录中没有配置文件。有一个 cmake 目录，其中有一个 configure.pl 文件。我不确定是否应该运行 make 来编译这个 .pl 文件。鉴于没有 make 文件，我对如何进行有点困惑。任何见解都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:17:51.783

当有完美的 Windows 版本可用时，为什么要在 Cygwin 下安装 MySQL？此外，您说您下载的版本适用于 OS X，而 Cygwin 模拟 Linux。

我建议您使用 Windows 版本，因为它可能会更加稳定、快速等，因为您不需要模拟任何内容。此外，如果出于某种原因需要在 Cygwin 下运行它，请使用 Linux 二进制文件。

Cygwin 允许您在安装时选择一些要安装的二进制文件，也许 MySQL 就是其中之一，所以如果您重新运行 Cygwin 安装程序，您可能会很幸运，并且避免了自己编译/配置 MySQL 的麻烦。

还; 这个问题可能属于[https://serverfault.com/](https://serverfault.com/)或[https://superuser.com/](https://superuser.com/) =)

# mysql - 大型数据库

> ID：14076243
> 
> 赞同：1
> 
> 时间：2012-12-28T21:48:06.160
> 
> 标签：mysql, database, innodb, myisam

我有一个在线服务（在线词汇培训师）。每个用户都有自己的词汇表。

现在，我不确定我应该如何构建我的 Mysql-DB。

据我所知，我有不同的可能性：

1.  一个表中的所有内容（MyISAM）：我将所有词汇存储在一个大型 MyISAM 表中，并添加一列“userid”来标识每个用户的词汇

2.  每个用户都有自己的表（MyISAM）：每次创建用户时，程序都会添加一个名为“vocabulary_{userid}”的表，其中 {userid} 是将表连接到用户。

3.  一张表中的所有内容（InnoDB）：与第一点类似，但使用 InnoDB 而不是 MyISAM。

问题是，一个大型词汇表可以达到 1 亿行。使用 MyISAM，问题是每个查询都会锁定整个表。所以我想，如果有很多用户在线（并发送很多查询），表可能会被锁定很多。对于 InnoDB，我根本不确定，这是否是一个很好的解决方案，因为我有相当多的 SELECT-、UPDATE- 和 INSERT- 命令。

我希望任何人都可以帮助我。先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:52:19.367

[使用InnoDB](https://stackoverflow.com/questions/20148/myisam-versus-innodb)几乎总是更好。InnoDB 可以处理 1 亿行，最大大小为[64tb。](http://forums.mysql.com/read.php?20,78132,78329#msg-78329)

听起来您没有关系数据集，而更像是键/值存储。也许[Riak](https://github.com/basho/riak)是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T21:52:38.860

*这取决于*

如果您开始每个用户拥有一个表（也称为分片），那么一开始您会遇到一些麻烦。

如果你现在不需要规模。找一张索引好的表。我不会使用 MyISAM，而是使用 InnoDB，否则你可能会受到 MyISAM 最大问题的打击（锁......）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:03:26.443

我认为，正常的关系设计将使用三个表：

1.  用户 — 用户 ID 和其他属性：姓名、电子邮件等
2.  词汇——问题中最不清楚的，但可能是具有词性和含义等属性的单词，可能包括单词 ID（因为某些单词拼写具有多种含义）。
3.  User_Vocabulary — 包含用户 ID、单词 ID 以及可能的属性（例如“学习日期”）的表格。

如果 MyISAM 在查询进行时锁定了表，那么如果您需要对 User_Vocabulary 表进行并发更新，那么您将无法使用 MyISAM。因此，所有表都使用 InnoDB。

# linux - 使用 linux-arm-gnueabi-g++ 为 ARM 编译 QT 时出现 XLib 错误

> ID：14076247
> 
> 赞同：0
> 
> 时间：2012-12-28T21:48:32.660
> 
> 标签：linux, qt, ubuntu, arm, qmake

我在将 QT 程序从 i386 Ubuntu Linux PC 编译到 Pandaboard 时遇到一些问题。

我们成功地创建了一个可以从我的 PC 到 Pandaboard 创建控制台应用程序的构建，但是当我尝试使用带有 GUI 的程序时，我收到一个缺少符号的错误。

我们正在尝试构建一个直接在 ARM 设备上的 Ubuntu 系统上运行的程序。

我们不想将程序作为嵌入式运行，而是作为独立的 QT 应用程序运行。

我认为 X11 显示驱动程序有问题。

**以下是我在运行 ./configure 时收到的错误：**

XLib 功能测试失败！您可能需要通过在 /home/vantage/QT_ARM_GUI2/qt-everywhere-opensource-src-4.8.4/mkspecs/linux-arm-gnueabi-g++ 中编辑 QMAKE_INCDIR_X11 和 QMAKE_LIBDIR_X11 来修改包含和库搜索路径。

**以下是我在当前版本中安装的项目：**

```
libfontconfig1-dev

libfreetype6-dev

libx11-dev

libxcursor-dev

libxext-dev

libxfixes-dev

libxft-dev

libxi-dev

libxrandr-dev

libxrender-dev

sudo apt-get install build-essential automake autoconf libtool

sudo apt-get install g++-arm-linux-gnueabi

sudo apt-get build-dep qt4-qmake 
```

**以下是我当前的 PATH 变量：**

```
/usr/lib/lightdm/lightdm:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/home/vantage/QT/arm-2012.09/bin:/home/vantage/QT/xc/include/X11:/home/vantage/QT/xc/lib/X11:/usr/lib/xorg:/usr/include/xorg 
```

**我正在使用以下 QT 版本：**

qt-everywhere-opensource-src-4.8.4

**我正在使用以下工具链：**

来自 codesourcery 的 arm-2012.09-64-arm-none-linux-gnueabi-i686-pc-linux-gnu

**以下是我的配置声明：**

```
./configure -arch arm -nomake demos - nomake examples - nomake docs -no-qt3support -release -platform linux-g++ -xplatform qws/linux-arm-gnueabi-g++ -declarative -xmlpatterns -exceptions -make tools -make libs -little-endian 
```

我编辑了我的 linux.conf 文件并将 QMAKE_LIBDIR_X11 更改为指向 /usr/lib/xorg 并将我的 QMAKE_INCDIR_X11 更改为 /usr/include/xorg。

我还编辑了我的 linux-arm-gnueabi-g++ -> qmake.conf 文件以匹配上述包含和 lib 目录。

我还尝试将这些目录指向库并包含我从“http://www.x.org/archive/X11R6.8.1/src-single/X11R6.8.1-src.tar.bz2”收到的文件，我导出到 home/vantage/QT/xc/。

我一直在关注下面的文章，试图解决这些错误，但我仍然收到 Xlib 的问题。“http://qt-project.org/forums/viewthread/17193”

任何方向或帮助将不胜感激。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T08:50:28.170

我认为您应该尝试在 Qt 源代码的 qmake.config 文件中提供所有这些已安装的库，即 libX11 等。一旦包含交叉编译的库和头文件，它就应该可以工作。

# php - 插入时自动截断数据

> ID：14076248
> 
> 赞同：5
> 
> 时间：2012-12-28T21:48:33.113
> 
> 标签：php, mysql, windows, pdo

我的 MySQL 服务器（在 Windows 2008 服务器上通过 PDO 使用 PHP 运行）在插入比列中允许的长度更长的字符串时返回错误代码 1406（字段数据太长）。问题是我在某处读到 MySQL 通常会在不处于严格模式时截断数据。我更改了 my.ini 中的 sql_mode，这样即使在启动时它也不会进入严格模式（当前是“”），但它仍然给我错误并回滚，所以数据丢失了（截断是所需的网站行为）。

我进入命令行并在较短的 varchar 字段中插入了一个长字符串，它确实截断了数据并保存了，但站点却没有。当我将模式改回严格时，它没有在命令行中截断（只有错误）。

此外，我让站点输出当前的 sql 模式，包括全局和会话（@@GLOBAL.sql_mode 和 @@SESSION.sql_mode），它们都输出“”，但不能按预期工作。

有谁知道是什么原因造成的和/或如何改变它？

我的怀疑是它可能与使用 PDO::ATTR_ERRMODE = PDO::ERRMODE_EXCEPTION 启用的 PDO 有关，但我已阅读并找不到任何有用的信息（我真的不认为这绝对是解释，但是我只是把它放在那里，以便你尽可能多地了解这个问题）。

非常感谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T22:00:42.737

你真的不应该那样做——请不要让坏数据进入你的数据库，并在你插入之前在你的脚本中清理它。

如果您不知道 VARCHAR 列的实际宽度或不想在脚本中对其进行硬编码，则可以通过使用如下查询查询[INFORMATION_SCHEMA 表`COLUMNS`](http://dev.mysql.com/doc/refman/5.1/en/columns-table.html)从数据库中读取它：

```
SELECT
    column_name,
    data_type,
    character_maximum_length,
    ordinal_position
FROM information_schema.columns
WHERE table_name = 'mytable' 
```

（您可能希望将其限制为 only `data_type = 'varchar'`）。有了这些信息，特别是`character_maximum_length`，您可以使用 PHP [substr](http://php.net/manual/en/function.substr.php)将输入字符串修剪为所需的长度。

这种方法的优点是它不会改变任何服务器配置，并且应该适用于任何其他数据库，而不仅仅是 MySQL。

但是如果你坚持不安全的方式，你可以尝试通过执行以下命令暂时禁用严格模式：

```
SET sql_mode = ''; 
```

之后，MySQL 应该默默地修剪字符串。[在这里](https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html)阅读更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:11:09.093

mysql服务器可能处于“不原谅”模式，也就是。传统的（大多数时候）。如果 mysql 服务器在宽容模式下运行，您所读的是真的。如果您尝试插入太长的字符串，它可能是非常重要的信息，因此 mysql 会发出错误。你有几个选择：

1：使用插入忽略（这会将所有错误转换为警告并继续截断数据）

2：对于当前会话，将 sql_mode 设置为 ''

有了这些中的任何一个，您的问题都应该消失。

PS：我已经阅读了您遇到的错误，但我仍然认为服务器在传统模式下运行（所以我建议将 sql_mode 设置为空是正确的）。

PS2：修改了my.cnf后，有没有重启mysql服务器？

# objective-c - 没有任何静态表的静态表视图错误

> ID：14076257
> 
> 赞同：0
> 
> 时间：2012-12-28T21:49:48.223
> 
> 标签：objective-c, xcode

我收到以下错误：

> 静态表视图仅在嵌入 UITableViewController 实例时有效

问题是我的应用程序中只有两个表，并且都设置为动态。我不知道错误来自哪里。

![静态表视图错误](../Images/90024ac5823d3511579bee84940941d1.png)

# wpf - 覆盖注册名称

> ID：14076259
> 
> 赞同：3
> 
> 时间：2012-12-28T21:50:04.230
> 
> 标签：wpf, storyboard

我有一个方法，当被调用时，它会返回一个`LinearGradientBrush`随机颜色的`GradientStop`，我在它们`mylabel.RegisterName`上使用以供以后在`storyboard`动画中使用。为了防止第一次调用时出现没有注册名称的错误，我这样做：

```
try
{
    myLabel.UnregisterName("GS1");
    myLabel.UnregisterName("GS2");
    myLabel.UnregisterName("GS3");
    myLabel.UnregisterName("GS4");
}
catch
{
} 
```

我还没有找到覆盖注册名称的方法。有更好的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T22:10:07.637

~~怎么样`UnregisterName`？~~

（*当我只能阅读部分问题时，这就是我试图回答的结果......*）

进一步挖掘，可能找到了另一个（更简单的）替代方案：

```
var isGs1Defined = NameScope.GetNameScope(myLabel).FindName("GS1") == null; 
```

或包装得很好：

```
public static bool IsNameRegistered(DependencyObject depObject, string name)
{
    var namescope = NameScope.GetNameScope(depObject);
    if(namescope == null)
        return false;
    return namescope.FindName(name) != null;
} 
```

# sql - Progress DB：根据当前日期设置 Where 值

> ID：14076260
> 
> 赞同：1
> 
> 时间：2012-12-28T21:50:04.620
> 
> 标签：sql, progress-db

编辑更多信息：这是基本想法：

```
Select 
    ID,
    Site,
    Pay,
    Code
FROM STAFF
    WHERE CASE
    When 1/1/2013 < CURDATE() < 3/1/2013 then Staff."Code" in (1,2,3)
    When 3/1/2013 < CURDATE() < 5/1/2012 then Staff."Code" in (2,3,4)
    END 
```

我几乎从不使用 Progress DB，因此我们将不胜感激。谢谢你，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:05:33.047

你的意思是这样的吗？

```
WHERE
    (CURDATE() BETWEEN 1/1/2013 AND 3/1/2013 AND Staff."Code" IN (1,2,3)) OR
    (CURDATE() BETWEEN 3/1/2013 AND 5/1/2013 AND Staff."Code" IN (2,3,4)) 
```

# python - Django：错误没有名为apps.homepage的模块

> ID：14076261
> 
> 赞同：0
> 
> 时间：2012-12-28T21:50:17.993
> 
> 标签：python, django, django-models

所以我正在关注programmersbook.com的教程，我已经完成了位于[http://www.youtube.com/watch?v=hTq98PGOqMA&feature=share&list=PL385A53B00B8B158E](http://www.youtube.com/watch?v=hTq98PGOqMA&feature=share&list=PL385A53B00B8B158E)的第7个视频。

将命令传递给 ./manage.py runserver 后，我收到以下错误。

```
ImportError at /admin/

No module named apps.homepage 
```

以下是文件的内容和目录结构（如果需要）。

博客/博客/urls.py

```
from django.conf.urls import patterns, include, url
from blog.apps.homepage import *

# Uncomment the next two lines to enable the admin:
# from django.contrib import admin
# admin.autodiscover()

urlpatterns = patterns('',
    (r'^', include('blog.apps.homepage.urls')),
    # Examples:
    # url(r'^$', 'blog.views.home', name='home'),
    # url(r'^blog/', include('blog.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
    # url(r'^admin/', include(admin.site.urls)),
) 
```

博客/应用程序/主页/urls.py

```
 from django.conf.urls.defaults import *

  urlpatterns = patterns('',
      (r'^$', 'blog.apps.homepage.views.index'),
  ) 
```

博客/应用程序/主页/views.py

```
from django.http import HttpResponse

def index(request):
    return HttpResponse('Index Page') 
```

以防万一这是我的文件和目录结构

```
blog
├── apps
│   ├── homepage
│   │   ├── __init__.py
│   │   ├── models.py
│   │   ├── tests.py
│   │   ├── urls.py
│   │   └── views.py
│   └── __init__.py
├── blog
│   ├── __init__.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
├── custom
│   └── __init__.py
├── data.db
├── manage.py
├── static
│   ├── css
│   ├── img
│   ├── js
│   ├── restricted
│   └── upload
└── templates 
```

有人可以帮我理解我能做些什么来解决这个错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:26:01.580

建议不要`blog`在 django 项目中包含项目名称。修改以下内容：

### 博客/博客/urls.py

```
urlpatterns = patterns('',
    url(r'^', include('apps.homepage.urls')),
) 
```

### 博客/应用程序/主页/urls.py

```
from django.conf.urls.defaults import *

urlpatterns = patterns('',
    (r'^$', 'apps.homepage.views.index'),
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:18:14.960

在 blog/urls.py 中，尝试去掉**“from blog.apps.homepage import *”**

我检查了链接的文档，该行没有出现在那里。此外，如果您查看文件结构，则此行正在导入文件，而不是文件中的实体。通常，您会使用“from xyz import *”来导入模型文件中的所有模型。可能是您通过导入所有这些文件而遇到命名空间冲突或类似情况。

也许还可以尝试在 settings.py 的 INSTALLED_APPS 中放置“主页”而不是“apps.homepage”。鉴于您遇到的错误，我倾向于认为这就是问题所在。

# json - Jackson Jaxb 注释优先级 - @JsonProperty 覆盖 @XmlTransient

> ID：14076262
> 
> 赞同：9
> 
> 时间：2012-12-28T21:50:23.553
> 
> 标签：json, jaxb, jackson

我正在使用 Jackson (2.1.1) 进行 JSON 序列化/反序列化。我有一个带有 JAXB 注释的现有类。这些注释中的大多数都是正确的，可以按原样与杰克逊一起使用。我正在使用 mix-ins 来稍微改变这些类的反序列化/序列化。

在我的 ObjectMapper 构造函数中，我执行以下操作：

```
setAnnotationIntrospector(AnnotationIntrospector.pair(
                 new JacksonAnnotationIntrospector(), 
                 new JaxbAnnotationIntrospector(getTypeFactory()))); 
```

基于上述，Jackson 注释优先于 Jaxb，因为自省的顺序。这是基于 Jackson Jaxb[文档](http://wiki.fasterxml.com/JacksonJAXBAnnotations)。对于我想忽略`@JsonIgnore`的字段，添加到混合中的字段可以正常工作。有几个字段被标记为`@XmlTransient`现有的类，我不想忽略它们。我已经尝试`@JsonProperty`在混入中添加到该字段，但它似乎不起作用。

这是原始类：

```
public class Foo {
    @XmlTransient public String getBar() {...}
    public String getBaz() {...}
} 
```

这是混音：

```
public interface FooMixIn {
    @JsonIgnore String getBaz(); //ignore the baz property
    @JsonProperty String getBar(); //override @XmlTransient with @JsonProperty
} 
```

知道如何在不修改原始类的情况下解决此问题吗？

我还测试了将@JsonProperty 添加到成员而不是使用混合：

```
public class Foo {
    @JsonProperty @XmlTransient public String getBar() {...}
    @JsonIgnore public String getBaz() {...}
} 
```

我似乎得到了与混入相同的行为。除非删除 @XmlTransient，否则该属性将被忽略。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T22:06:19.070

问题是该`AnnotationIntrospectorPair.hasIgnoreMarker()`方法基本上忽略了`@JsonProperty`如果任一内省检测到忽略标记：

```
 public boolean hasIgnoreMarker(AnnotatedMember m) {
        return _primary.hasIgnoreMarker(m) || _secondary.hasIgnoreMarker(m);
    } 
```

参考：[github](https://github.com/FasterXML/jackson-databind/blob/master/src/main/java/com/fasterxml/jackson/databind/introspect/AnnotationIntrospectorPair.java#L277)

一种解决方法是对 进行子类化`JaxbAnnotationIntrospector`以获得所需的行为：

```
public class CustomJaxbAnnotationIntrospector extends JaxbAnnotationIntrospector {
    public CustomJaxbAnnotationIntrospector(TypeFactory typeFactory) {
        super(typeFactory);
    }

    @Override
    public boolean hasIgnoreMarker(AnnotatedMember m) {
        if ( m.hasAnnotation(JsonProperty.class) ) {
            return false;
        } else {
            return super.hasIgnoreMarker(m);
        }
    }
} 
```

然后只需使用`CustomJaxbAnnotationIntrospector`.`AnnotationIntrospectorPair`

# css - 如何制作这个 css 跨浏览器？

> ID：14076263
> 
> 赞同：0
> 
> 时间：2012-12-28T21:50:23.983
> 
> 标签：css

我不知道，如何使这段代码跨浏览器：（它只适用于 safari 和 chrome）

[http://jsfiddle.net/MWYnP/](http://jsfiddle.net/MWYnP/)

```
body {
    padding: 10px 9px;
    background: -webkit-linear-gradient(left, #C5CCD4 71%, #CBD2D8 71%, #CBD2D8 100%);
    -webkit-background-size: 7px 1px;   
}​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:15:00.770

试试这个：

```
body {
padding: 10px 9px;
background: -moz-linear-gradient(left, #C5CCD4 71%, #CBD2D8 71%, #CBD2D8 100%);
background: -ms-linear-gradient(left, #C5CCD4 71%, #CBD2D8 71%, #CBD2D8 100%);
background: -o-linear-gradient(left, #C5CCD4 71%, #CBD2D8 71%, #CBD2D8 100%);
background: -webkit-gradient(linear, 0 0, 100% 0, color-stop(0.71, #C5CCD4), color-stop(0.71, #CBD2D8), to(#CBD2D8));
background: -webkit-linear-gradient(left, #C5CCD4 71%, #CBD2D8 71%, #CBD2D8 100%);
background: linear-gradient(left, #C5CCD4 71%, #CBD2D8 71%, #CBD2D8 100%);
background-size: 7px 1px;
-moz-background-size: 7px 1px;
-o-background-size: 7px 1px;
-webkit-background-size: 7px 1px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T21:56:59.023

你可以使用这样的东西来生成你的渐变： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)。另外，不要使用渐变，它不兼容最新版本的浏览器，甚至不兼容所有浏览器。而是使渐变成为图像并重复它。

# javascript - 我需要在 ASP.NET 中编写一个动态报表生成器，我应该从哪里开始？

> ID：14076268
> 
> 赞同：8
> 
> 时间：2012-12-28T21:51:09.930
> 
> 标签：javascript, asp.net, sql, sql-server, report

我的任务是创建一个动态报告构建器来扩展我们当前的产品，它应该允许我们的用户相对轻松地配置一个有用的报告，从他们输入到系统中的数据中绘制数据。目前我们手动定制这些报告，这个过程涉及开发人员（我）获取报告的要求（字段、总计、百分比等）并将结果发布为一个相对交互式的页面，允许“向下钻取” ' 以获取记录行等中的更多信息。

这些报告并不是非常复杂，但它们涉及的内容足够多，以至于以编程方式生成这些报告似乎是不可能的。我觉得创建一个界面以允许用户自定义报告的外观应该不会太难，尽管它本身就涉及到。我不知所措的是如何创建一个界面，让完全没有“编程”知识的用户能够轻松生成 SQL 查询，从而获取他们需要的信息。

事实上，他们需要能够创建这些查询并访问他们输入数据的内容，而无需知道他们真正在做什么。我觉得要按要求工作，报告的生成必须尽可能与魔法没有区别。用户应该能够从可能的数据集中拖放他/她需要的内容，并神奇地生成报告。

我当然愿意接受挑战，但我真的不知道从哪里开始。一旦我开始行动，解决个别问题将变得“容易”（实际上更像是过程的一部分），但起步一直充满挑战和令人沮丧。如果有人能给我一个搜索的方向，我不怕花时间。感谢您的宝贵时间，我期待一些积极的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:04:13.280

以前我的任务是这样的。我的建议：不要。除非所需的报告非常基本，并且您的用户不关心报告的外观，否则实施将花费大量时间。随着您指示您的单人团队，请不要。雇用初级开发人员或实习生或其他人来处理这部分工作对您来说（即使从长远来看）会更便宜。

现在，有一些不同的报表设计器。我还没有看到任何完全在网页上工作的东西，而且从非程序员的角度来看，它们都非常糟糕。

现在，有办法解决这个问题。大多数想要这些类型的报告的人都知道如何使用 Microsoft Access。您可以利用他们的知识让他们创建自己的报告。这不是微不足道的，因为您不希望它们只是连接到您的数据库。所以，这是我推荐的：

1.  生成与 Access 兼容的可下载数据库
2.  确保下载的数据库“易于”使用。这意味着复制数据和非规范化很多东西
3.  确保您没有在可下载的数据库中留下任何敏感信息（密码、他们不应该看到的内部信息等）
4.  最后，确保他们可以以安全的方式下载它并且它是高性能的。您可能需要告诉您的用户可下载的数据库仅每周或每月“同步”一次，因为实时同步它相对昂贵

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T22:06:39.740

看看数据仓库做了什么（例如[The Data Warehouse Toolkit](https://rads.stackoverflow.com/amzn/click/com/0471200247)）。他们创建了几个非常广泛的基本表，包含大量冗余数据并涵盖数据库的某个方面。

我会创建几个这样广泛的视图，并让用户选择一个视图作为动态报告的基础。然后他们可以选择要显示的列、排序和分组。但是他们不能选择任何额外的表或视图。

当然，一个典型的视图必须真正涵盖有关数据库某个方面的所有内容。假设您有一个*Order Items*视图。这样的视图将包含所有订单的所有项目，提供数百列，包括：

*   订单产品 ID、产品名称、正常价格、折扣、支付价格、含价格。运费的相关部分等。
*   订单 ID、订单日期、交货日期、运费等。
*   客户ID、客户名称、客户地址等。
*   每个日期由几列组成：完整日期、一年中的某一天、月份、年份、季度、带有年份的季度等。
*   每个地址包括完整地址、城市、州、地区、区号等。

这样，动态报告就相当容易使用，因为用户不需要加入任何表格，而是拥有他们需要的所有数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T09:01:34.320

我建议您查看现成的报告组件。例如[Microsoft 的 Reporting Services](http://msdn.microsoft.com/en-us/library/ms159106.aspx)、[Telerik](http://www.telerik.com/developer-productivity-tools.aspx)、[DevExpress](http://www.devexpress.com/Products/NET/Reporting/)或（我应该承认，我们的产品）[SharpShooter Reports](http://www.perpetuumsoft.com/SharpShooter-Reports-Web.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T22:20:19.197

开始环顾四周，有哪些报告工具？那里有什么东西甚至接近他们的期望吗？周围的工具将是通用的，您的案例可能相当具体。您已经知道用户正在寻找的部分答案。您的解决方案应该以这种方式帮助他们。

你用了“魔法”这个词。这应该是一个巨大的警告信号。作为开发人员，我们不做*魔术*，我们做**逻辑**。我们可以创造幻觉，我们不能施展魔法。

我会深入研究 Sql Analysis Services 和 Excel。[这里](http://channel9.msdn.com/Blogs/rdoherty/Presentation-Using-Excel-2010-as-an-Analysis-Services-Client)有一个演示文稿。这些人也不会魔术，但他们可以做很多事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-30T17:30:22.463

我们使用 EasyQuery 和 FastReport.NET 的组合。

EasyQuery 允许我们的用户构建动态查询并提取报告和 FastReport 所需的数据 - 用于实际报告生成并将其导出到 Excel 或 PDF。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-13T20:29:41.130

看看 zpmsoftware.com。它有一个用于 ASP.NET MVC 的开源报告生成器，并输出到屏幕、excel 和 pdf。适应Webforms没有太多麻烦。由于大多数花哨的东西都在 jquery/javascript 中，因此适应其他服务器环境应该是可行的。

# javascript - jquery popbox没有弹出

> ID：14076269
> 
> 赞同：1
> 
> 时间：2012-12-28T21:51:15.840
> 
> 标签：javascript, jquery

全部！

我确定我在问一个非常基本的问题，但我花了一整天的时间，就是想不通。

我在标签框内有一张桌子。在表格标题行中，我需要添加一个按钮，该按钮将弹出一个数据输入框。选项卡区域有效，表格显示，按钮也有效。但是当我点击那个按钮时，什么也没有发生。

我以以下教程为例 [http://gristmill.github.com/jquery-popbox/example.html](http://gristmill.github.com/jquery-popbox/example.html)

在我的 html 代码中添加了 popbox.js 和 popbox.css 并添加了

```
$(document).ready(function() {
            $("#tabs").tabs();
            $('.popbox').popbox();
        }); 
```

在 html 文件的末尾。

但是，它不会弹出。我向该方法添加了警报，并且确实调用了 popbox 函数，但似乎没有执行绑定。我添加了一些警报，但没有触发警报：

```
return this.each(function(){
    alert("test1");
  $(this).css({'width': $(settings['box']).width()}); // Width needs to be set otherwise popbox will not move when window resized.
    alert("test2");
  $(settings['open'], this).bind('click', methods.open);
    alert("test3");
  $(settings['open'], this).parent().find(settings['close']).bind('click', methods.close);
}); 
```

据我所知，它没有弹出，因为打开和关闭点击没有绑定。但不确定发生了什么。我是 jsp 的新手，一头扎进了 jquery。为新手问题道歉。

谢谢您的帮助！

# vim - 在 VI 编辑器中按数字排序

> ID：14076275
> 
> 赞同：37
> 
> 时间：2012-12-28T21:51:47.747
> 
> 标签：vim, text-editor, vi

> **可能重复：**
> [如何在 Vim 中对数字和文字列进行排序](https://stackoverflow.com/questions/1355004/how-to-sort-numeric-and-literal-columns-in-vim)

我必须根据线程 ID 对以下行进行排序。

```
Internal thread 0 bound to OS proc set {1}
Internal thread 1 bound to OS proc set {5}
Internal thread 2 bound to OS proc set {9}
Internal thread 10 bound to OS proc set {41}
Internal thread 9 bound to OS proc set {37} 
```

当我发出`:!sort -n`它们时，它们会像这样排序：

```
Internal thread 0 bound to OS proc set {1}
Internal thread 1 bound to OS proc set {5}
Internal thread 10 bound to OS proc set {41}
Internal thread 2 bound to OS proc set {9}
Internal thread 9 bound to OS proc set {37} 
```

但我需要它们像这样排序：

```
Internal thread 0 bound to OS proc set {1}
Internal thread 1 bound to OS proc set {5}
Internal thread 2 bound to OS proc set {9}
Internal thread 9 bound to OS proc set {37}
Internal thread 10 bound to OS proc set {41} 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-12-28T21:57:14.093

只需使用 Vim 自己的排序功能。直观地突出显示文本（或使用范围）并键入：

`:sort n`

文档可在此处获得：http: [//vim.wikia.com/wiki/Sort_lines](http://vim.wikia.com/wiki/Sort_lines)

或者在 Vim 本身中：`:help sort`

*（编辑以反映 dash-tom-bang 的重要说明和对 Vim 自己的帮助文件的引用。）*

# asp.net-mvc - 有没有办法在不使用 if-else 语句的情况下刷新视图的内容？

> ID：14076277
> 
> 赞同：2
> 
> 时间：2012-12-28T21:51:51.860
> 
> 标签：asp.net-mvc, user-interface

有没有办法在不使用 if-else 语句的情况下刷新视图的内容？例如，如果我使用表格列出一堆记录，但如果没有找到行，我不需要标题：可能是一条消息说“未找到数据”。我想：

```
if (records.count == 0) {
  <div>No Data</div>
  return; //flush/render view
}
//no else
<table><tr><th>......</tr>
foreach (var record in records) {
  <tr><td>....</tr>
}
</table> 
```

说得通？或者我只是懒惰：我讨厌大量的嵌套代码，尤其是在缩进不是那么隐蔽的视图中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T21:53:17.233

试试这样，它应该工作：

```
@if (records.count == 0)
{
    <div>No Data</div>
    return;
}

<table>
    <tr><th>......</tr>
    foreach (var record in records) 
    {
        <tr><td>....</tr>
    }
</table> 
```

如果满足`records.count == 0`条件`No Data`（

# java - @Nullable 注解用法

> ID：14076296
> 
> 赞同：398
> 
> 时间：2012-12-28T21:54:07.233
> 
> 标签：java, annotations

我看到java中的一些方法声明为：

```
void foo(@Nullable Object obj)
{ ... } 
```

这里有什么意义`@Nullable`？这是否意味着输入可能是`null`？

没有注释，输入仍然可以为空，所以我猜这不仅仅是它？

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2012-12-28T21:57:22.487

它清楚地表明该方法接受空值，并且如果您覆盖该方法，您也应该接受空值。

它还可以作为[FindBugs](http://findbugs.sourceforge.net/)等代码分析器的提示。例如，如果此类方法取消引用其参数而不首先检查 null，则 FindBugs 将发出警告。

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2012-12-28T21:57:46.747

此注解通常用于消除`NullPointerExceptions`. `@Nullable`说这个参数可能是`null`. 这种行为的一个很好的例子可以在[Google Guice](https://github.com/google/guice/wiki/UseNullable)中找到。在这个轻量级的依赖注入框架中，你可以看出这个依赖可能是`null`. 如果您尝试在`null`没有注释的情况下通过，框架将拒绝完成它的工作。

更重要的是，`@Nullable`可能与`@NotNull`注释一起使用。在这里，您可以[找到](https://www.jetbrains.com/help/idea/nullable-and-notnull-annotations.html)有关如何正确使用它们的一些提示。IntelliJ 中的代码检查检查注释并帮助调试代码。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-12-28T22:32:45.400

不同的工具可能解释`@Nullable`不同的含义。例如，[Checker Framework](https://checkerframework.org/)和[FindBugs](http://findbugs.sourceforge.net/)的处理`@Nullable` [方式不同](https://checkerframework.org/manual/#findbugs-nullable)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-03-28T17:12:09.800

诚然，肯定有不同的想法，在我的世界里，我不能强制执行“从不传递空值”，因为我正在与无法控制的第三方打交道，比如 API 调用者、数据库记录、前程序员等......所以我在方法上偏执和防御. 由于您使用的是 Java8 或更高版本，因此有一种比`if`块更简洁的方法。

```
public String foo(@Nullable String mayBeNothing) {
   return Optional.ofNullable(mayBeNothing).orElse("Really Nothing");
} 
```

您还可以通过切换`.orElse`到 `orElseThrow(() -> new Exception("Dont' send a null"))`.

如果您不想使用 @Nullable，它不会在功能上添加任何内容，为什么不直接命名参数，`mayBe...`这样您的意图就很清楚了。

# c++ - 永久向下转换 c++ 指针

> ID：14076307
> 
> 赞同：3
> 
> 时间：2012-12-28T21:56:03.857
> 
> 标签：c++

所以这可能是一个奇怪的问题，但我有充分的理由问这个问题。

我的问题的要点是，给出一个在类层次结构上有两个派生级别的示例：

主要基类：

```
class Animal
{
  virtual void Draw() = 0;
}; 
```

派生类：

```
class Dog : public Animal
{
  virtual void Draw()
  {
    // draw a generic dog icon or something...
  }
}; 
```

进一步推导：

```
class Corgi : public Dog
{
  virtual void Draw()
  {
    // draw a corgi icon...
  }
}; 
```

现在，我希望能够从`Corgi`类中永久地将“this”指针向下转换为`Dog`指针，然后将其作为 Animal 传递到其他地方。然后这个其他地方将能够调用`Draw`函数并获取`Dog`方法，而不是虚拟`Corgi`方法。我知道这很奇怪，但同样，我有一个模糊的正当理由想要这样做。

我已经尝试了所有不同的铸造操作员并且没有任何运气，但也许有一种一致的方法可以解决这个问题？过去，我因未正确使用而给自己造成了麻烦，`dynamic_cast`这导致指针的类似状态。也许这一次我可以利用它来发挥我的优势？

**编辑：** 也许上面的例子并没有清楚地说明我想要达到的目标，所以我会详细说明我的真正目标。

我正在尝试实现注册基类实现的简写，这些实现链接到我已经使用了一段时间的脚本系统。脚本系统依赖于一个基类`IScriptContext`方便访问真实代码函数和成员变量访问。基类在内部注册它们的成员函数地址和成员变量地址，稍后通过查找表分派/访问这些地址。我正在为脚本系统添加对类派生层次结构的适当支持，我认为能够隔离这些接口的基类版本将有助于节省时间并使整个过程对我来说更清晰使用脚本解释器注册可用的基类。还有其他方法可以实现这一点，例如为每个可用基类的每个所需方法注册类特定函数指针（例如`this->Dog::CallFunction`，`this->Dog::SetMember``this->Dog::GetMember`.) 但是，如果我需要的话，我认为使用界面可以让我在以后更轻松地修改事情。

我希望所有这些都有意义。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T22:00:10.210

你有一个`Corgi`对象。你可以：

1.  通过对所有调用`Dog`使用限定符（例如） ，将其视为无处不在的对象。这会失去您的虚拟调度，并且几乎可以肯定这不是您从问题的阅读方式中想要的。`Dog::``ptr->Dog::draw();`

2.  实际上`Dog`从您的`Corgi`. 只需使用普通类型执行此操作，`static_cast`因为您将转换任何其他类型或让隐式转换接管（例如`Corgi c; Dog d(c);`）。

这些是您可以使用的选项。想要保留 a`Corgi`但在任何地方都自动假装它是 a`Dog`既不合理也不合法，因此语言没有提供它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T21:59:03.547

让我先说你的设计看起来有问题。

但是，您可以明确说明要调用层次结构中的哪个函数：

```
Corgi* corgi = new Corgi;
corgi->Dog::draw(); 
```

这将调用`draw`方法 from `Dog`，而不是 from `Corgi`。（我希望我能正确理解你的要求）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T22:26:55.137

Tomalak[已经概述](https://stackoverflow.com/a/14076349/464581)了您可以使用的两个主要选择：

*   使用合格的电话，或

*   构造 a`Dog`作为`Dog`您的`Corgi`.

除了这些，你还可以

*   使用简单的*包装器*

例如

```
class LooksLikeDog
    : public Dog
{
private:
    Dog*  realObject_;

    LooksLikeDog( LooksLikeDog const& );                    // No such.
    LooksLikeDog& operator=( LooksLikeDog const& );         // No such.

public:
    LooksLikeDog( Dog& other )
        : realObject_( &other )
    {}

    // Just for exposition: not implementing this does the same.
    virtual void draw() override { Dog::draw(); }

    // Example of other method that may need to be implemented:
    virtual void bark() override { realObject_->bark(); }
}; 
```

但最好的解决方案很可能是**修复您的设计**。;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T23:02:05.260

实现 Corgi 绘图功能并调用您父级的实现：

```
virtual void Corgi::Draw() 
{ 
    Dog::draw(); 
} 
```

# android - 通过android上传文件到GAE

> ID：14076310
> 
> 赞同：0
> 
> 时间：2012-12-28T21:56:20.987
> 
> 标签：android, google-app-engine

自 3 天以来，我一直在研究 Google 应用引擎，最后遇到了这个我无法解决的问题。做了很多研究，但可以找到任何令人信服的东西。米

设置我的 Google app Engine 帐户后，当我调用我的应用程序 url "my-app-id.appspot.com/myservlet" 时，GAE 上的简单 Servlet 能够在我的 Google bucket 中写入 .txt 文件。相同的代码片段在这里：

```
 fetchurl.java 

             DefaultHttpClient hc=new DefaultHttpClient();
             ResponseHandler <String> res=new BasicResponseHandler();
             HttpGet postMethod=new HttpGet("http://my-app-id.appspot.com/uploadservlet");

             String response=hc.execute(postMethod,res); 
```

上传servlet.java

```
 An example @ Complete Sample App at this link:
  https://developers.google.com/appengine/docs/java/googlestorage/overview 
```

现在我的问题是当我使用 multi-part 通过 POST 方法发送一些文件时，Servlet @ app 引擎不起作用，并且我在 eclipse 中收到错误消息“Filenotfound”。

Android端的.java文件

```
 urlString = "http://my-app-id.appspot.com/uploadservlet";
  URL url = new URL(urlString);

             // Open a HTTP connection to the URL
             conn = (HttpURLConnection) url.openConnection();
             conn.setConnectTimeout(90000);

             // Allow Inputs
             conn.setDoInput(true);

             // Allow Outputs
             conn.setDoOutput(true);

             // Don't use a cached copy.
             conn.setUseCaches(false);

             // Use a post method.
             conn.setRequestMethod("POST");

             isOK = true;

             conn.setRequestProperty("Connection", "Keep-Alive");

             conn.setRequestProperty("Content-Type",
                     "multipart/form-data;boundary=" + boundary);

             DataOutputStream dos = new DataOutputStream(conn.getOutputStream());

            dos.writeBytes(twoHyphens + boundary + lineEnd);
            dos.writeBytes("Content-Disposition: form-data; name=param1;filename="
                            + param1 + "" + lineEnd);
            dos.writeBytes(lineEnd);
            dos.writeBytes(twoHyphens + boundary + lineEnd);
            Log.e(Tag, "Param1 are written");

            dos.writeBytes(twoHyphens + boundary + lineEnd);
            dos.writeBytes("Content-Disposition: form-data; name=param2;filename="
                            + param2 + "" + lineEnd);
            dos.writeBytes(lineEnd);
            dos.writeBytes(twoHyphens + boundary + lineEnd);
            Log.e(Tag, "Param2 are written");

            FileInputStream fileInputStream = new FileInputStream(new File(
                    path));
            dos.writeBytes(twoHyphens + boundary + lineEnd);
            dos.writeBytes("Content-Disposition: form-data; name=uploadedfile;filename="
                         + path + "" + lineEnd);
            dos.writeBytes(lineEnd);

            Log.e(Tag, "Headers are written");

             // create a buffer of maximum size

             int bytesAvailable = fileInputStream.available();
             int maxBufferSize = 1000;
             // int bufferSize = Math.min(bytesAvailable, maxBufferSize);
             byte[] buffer = new byte[bytesAvailable];

             // read file and write it into form...

             int bytesRead = fileInputStream.read(buffer, 0, bytesAvailable);

             while (bytesRead > 0) 
             {
                 dos.write(buffer, 0, bytesAvailable);
                 bytesAvailable = fileInputStream.available();
                 bytesAvailable = Math.min(bytesAvailable, maxBufferSize);
                 bytesRead = fileInputStream.read(buffer, 0, bytesAvailable);
             }

             // send multipart form data necesssary after file data...
             //dos.writeBytes(lineEnd);
             dos.writeBytes(twoHyphens + boundary + lineEnd);
             dos.writeBytes(lineEnd);
             dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd); 
```

我想知道这种方法是否正确。如果不是其他解决方案..我也查看了blobstorage，但它也是一样的，将文件写入存储桶而不是上传..请帮助我......任何事情都会很棒和感激！！！

```
 Servlet code to handle file upload and save to Google storage--

 @MultipartConfig   
 @SuppressWarnings("serial")
   public class SecondtrygoogleServlet extends HttpServlet 
   {
public static String BUCKETNAME = "androidbucket";
public static String FILENAME = "shikhatry.txt";

private static final long serialVersionUID = 1L;

private static final int THRESHOLD_SIZE = 1024 * 1024 * 3; // 3MB
private static final int MAX_FILE_SIZE = 1024 * 1024 * 40; // 40MB
private static final int REQUEST_SIZE = 1024 * 1024 * 50; // 50MB

public void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException 
{
    // checks if the request actually contains upload file
    if (!ServletFileUpload.isMultipartContent(request)) {
        // if not, we stop here
        return;
    }

    response.setContentType("text/plain");
    response.getWriter().println("Hello, test1 world");

    // configures some settings
    DiskFileItemFactory factory = new DiskFileItemFactory();
    factory.setSizeThreshold(THRESHOLD_SIZE);
    factory.setRepository(new File(System.getProperty("java.io.tmpdir")));

    ServletFileUpload upload = new ServletFileUpload(factory);
    upload.setFileSizeMax(MAX_FILE_SIZE);
    upload.setSizeMax(REQUEST_SIZE);
    java.io.PrintWriter out = response.getWriter( );

    try {
            // parses the request's content to extract file data
            List<?> formItems = upload.parseRequest(request);
            out.println("Number of fields: " + formItems.size());
            Iterator<?> iter = formItems.iterator();

            // iterates over form's fields
            while (iter.hasNext()) 
            {
                out.println("Inside while loop");
                FileItem item = (FileItem) iter.next();
                // processes only fields that are not form fields
                if (!item.isFormField()) 
                {

                    String temp = item.getFieldName();
                    out.println("Parameter Name"+temp);

                    if(temp.equals("uploadedfile"))
                    {
                        String fileName = new File(item.getName()).getName();
                        FILENAME = fileName+".txt";
                        out.println("Filename"+fileName);

                        FileService fileService = FileServiceFactory.getFileService();
                        GSFileOptionsBuilder optionsBuilder = new GSFileOptionsBuilder()
                        .setBucket(BUCKETNAME)
                        .setKey(FILENAME)
                        .setMimeType("text/html") //audio/mp3 text/html
                        .setAcl("public_read")
                        .addUserMetadata("myfield1", "my field value");

                     AppEngineFile writableFile =
                         fileService.createNewGSFile(optionsBuilder.build());

                     // Open a channel to write to it
                     boolean lock = false;
                     FileWriteChannel writeChannel =
                         fileService.openWriteChannel(writableFile, lock);

                     // Different standard Java ways of writing to the channel
                     // are possible. Here we use a PrintWriter:

                     InputStream inputStream = item.getInputStream();
                     int readBytes = 0;
                     byte[] buffer = new byte[10000];

                     while ((readBytes = inputStream.read(buffer, 0, 10000)) != -1) 
                     {
                        writeChannel.write(ByteBuffer.wrap(buffer));

                     }

                     inputStream.close();

                     writeChannel.closeFinally();
                     response.getWriter().println("Done writing...");

                }
                else if(temp.equals("param1"))
                {
                    out.println("Inside param1");
                    //String param1Val = new File(item.getName()).getName();                        
                    //BUCKETNAME = param1Val;
                }
                else if(temp.equals("param2"))
                {
                    out.println("Inside param2");
                    //String param2Val = new File(item.getName()).getName();

                    //BUCKETNAME = param2Val;

                }
            }
        }
        request.setAttribute("message", "Upload has been done successfully!");
    } catch (Exception ex) {
        request.setAttribute("message", "There was an error: " + ex.getMessage());
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T01:08:31.830

选项是：

一种。使用带有表单的[createUploadURL](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/blobstore/BlobstoreService)来上传大文件，或者

湾。使用您的方法，然后在 servlet 中自己解码解析上传并写入 blobstore（文件需要小于 32MB），或者

C。使用[Google Cloud Storage API](https://developers.google.com/storage/docs/developer-guide)直接写入 GCS，然后将上传的文件名发布到您的应用程序。

# c# - VisitMethodCall 不访问每个部分

> ID：14076312
> 
> 赞同：1
> 
> 时间：2012-12-28T21:56:43.127
> 
> 标签：c#, linq, iqueryable

我有一个表达式访问者将表达式转换为 url 格式。但它只转换最后调用的表达式。例如，如果我这样称呼我的收藏：

```
NetworkAccountStorage.Where<NetworkAccountModel>(x => x.ID + 1 > 0).Select(x => x.Name).Distinct() 
```

Distinct 将是唯一访问的表达式。如何解决这个问题？

```
protected override Expression VisitMethodCall(MethodCallExpression m)
    {
        if (m.Method.DeclaringType == typeof(Queryable) && m.Method.Name == "Where")
        {
            sb.Append("$filter=");
            //this.Visit(m.Arguments[0]);
            //sb.Append(") AS T WHERE ");
            LambdaExpression lambda = (LambdaExpression)StripQuotes(m.Arguments[1]);
            this.Visit(lambda.Body);
            return m;
        }
        else if (m.Method.DeclaringType == typeof(Queryable) && m.Method.Name == "Select")
        {
            sb.Append("$select=");
            LambdaExpression lambda = (LambdaExpression)StripQuotes(m.Arguments[1]);
            this.Visit(lambda.Body);
            return m;
        }

        throw new NotSupportedException(string.Format("The method '{0}' is not supported", m.Method.Name));
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:27:33.560

您需要通过调用您覆盖的基本方法进行递归：

```
base.VisitMethodCall(...); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:07:35.093

你需要递归。Distinct 接受一个`this`参数，即 .Select 调用等。

# c# - c# & SQL 的标记？

> ID：14076316
> 
> 赞同：3
> 
> 时间：2012-12-28T21:57:07.440
> 
> 标签：c#, mysql, code-generation

我想知道是否有一个简单的标记可以为我生成我的 C# 类以及（My）SQL 创建表。最好是支持索引和 FK 的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:07:51.987

您可以使用设计器创建实体模型。之后，您可以通过您喜欢的数据库工具启用 sql 跟踪/或导出创建脚本。将新文件添加到项目时，只需查找“LINQ to SQL 类”。文件扩展名为 dbml。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:05:50.530

我们使用[CodeSmith](http://www.codesmithtools.com)来做这件事已经有很长时间了。您可以从现有的 SQL 表生成类，并且该工具的脚本功能允许您将输出微调为您想要的。例如，我们所有的业务类都继承自同一个基类，所以我们只是修改了脚本以在生成的输出中包含这个基类。

# knockout.js - 绘制时显示微调器/阻止剔除网格

> ID：14076325
> 
> 赞同：0
> 
> 时间：2012-12-28T21:57:53.260
> 
> 标签：knockout.js

我正在通过敲除和 foreach 绑定呈现一个 html 表。在对底层可观察数组进行*排序*时，如果有大量数据，重绘可能需要几秒钟，所以我想在网格上显示一个块/微调器，直到重绘完成。这是我的代码的*简化*小提琴：

[http://jsfiddle.net/cmontgomery/bkcsR/](http://jsfiddle.net/cmontgomery/bkcsR/)

我不能使用，`afterMove`因为它会触发每一行，而不是整个 foreach。我发现了一个非常接近的淘汰赛分支：[https](https://github.com/SteveSanderson/knockout/pull/690) ://github.com/SteveSanderson/knockout/pull/690 。但是，它似乎仍然无法正常工作，因为页面在重绘时被锁定，所以我的微调器直到所有重绘后才会上升，此时我无论如何都需要再次删除它......有什么建议吗？

PS> 我知道这一切可能存在一些用户体验问题，但请幽默我 ;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T19:58:41.710

对数组应用排序后，您可以知道数组中的哪一项是最后一项。然后在“afterMove”事件处理程序中等待项目元素移动到新位置并隐藏 Progess 标记的那一刻。这是小提琴：

[http://jsfiddle.net/rustam/jdavU/8/](http://jsfiddle.net/rustam/jdavU/8/)

您可以利用 observableArray 的 'change' 事件和 'foreach' 绑定的 'afterMove' 事件。

```
var lastMovedData = null;

Grid.prototype.onChange = function(value){
    lastMovedData = value && value.length ? value[value.length - 1] : null;
    console.log('show Progress image');
};

Grid.prototype.onAfterMove = function(value, index, data){

    //console.log('after move');

    if(lastMovedData && data.key == lastMovedData.key){
        console.log('hide Progress image. Last item\'s key: ' + data.key);
    }

}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T01:52:34.817

只是好奇，你研究过分页吗？

此外，我认为您会获得更好的性能，避免容器较少绑定并将其直接应用于 tr。您也可以避免跨度上的模板并使用文本绑定代替吗？您可能需要使数据更具多态性或确保列属性名称与日期属性名称匹配。如

```
text: $parent[$data.propName] 
```

至于掩码，您可以在网格上放置一个绝对不透明度的 div，并使用 bool 标志对其进行切换。我已经在复杂的场景中使用自定义绑定来完成此操作。这里的一个问题是网格的大小随着第一次填充而增长。它也看起来像静态数据。您也许可以想出一个巧妙的绑定，将 Dom 节点保存为排序状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T16:09:17.040

我能够使用`setTimeout`加上这个提交来完成这个：“[为foreach/模板绑定添加一个全局的前后回调](https://github.com/SteveSanderson/knockout/pull/690)”。由于我无法在我的小提琴中轻松链接到这个自定义构建的淘汰赛，我使用[Rustam](https://stackoverflow.com/users/425787/rustam)的代码来完成解锁（但是在我的真实代码中，我喜欢 seanami 的`after`事件`foreach/template`是多么干净）。这是一个工作示例：

[http://jsfiddle.net/cmontgomery/MvBBC/](http://jsfiddle.net/cmontgomery/MvBBC/)

setTimeout 允许块代码有足够的时间覆盖网格，然后继续进行排序：

```
Grid.prototype.sort = function (column) {
    $("#mygrid").block({ message: '<div />', overlayCSS: { opacity: 0.1, borderRadius: '4px' }, css: { border: 'none', background: 'transparent'} });
    setTimeout(this.doSort.bind(this, column), 100);
}; 
```

# objective-c - 目标 C 方法中的 IplImage *

> ID：14076327
> 
> 赞同：0
> 
> 时间：2012-12-28T21:57:58.440
> 
> 标签：objective-c, opencv

我想在openCV中对视频帧进行帧比较。让我们说视频文件中的第 10 帧和第 100 帧。如果我在主视频捕获循环中执行此操作，它会起作用。但现在我想将其移至专用方法（将 IplImages 作为输入）。

```
 // MAIN CAPTURE LOOP
 while(1) {

        cvSetCaptureProperty(capture, CV_CAP_PROP_POS_FRAMES, 10);
        frame = cvQueryFrame(capture);
        if (!frame) break;
        cvShowImage("Window_1", frame);

        cvSetCaptureProperty(capture, CV_CAP_PROP_POS_FRAMES, 100);
        nextFrame = cvQueryFrame(capture);
        if (!nextFrame) break;

        cvShowImage("Window_2", nextFrame);  // THIS SHOWS ME TWO DIFFERENT FRAMES

        // PASS THE IMAGES TO THE NEW METHOD

        [self compareFrame: frame withFrame: nextFrame]);                       

        char c = cvWaitKey(5);  
        if(c==27) {
            NSLog(@"ESC pressed!");
            break;
        } 
```

这是我的方法（简化）

```
- (int) compareFrame: (IplImage*) firstFrame withFrame: (IplImage*) secondFrame
{

// THIS SHOWS ME ONLY THE firstFrame IN BOTH      
// WINDOWS?

cvShowImage("Window_1", firstFrame);
cvShowImage("Window_2", secondFrame); 

return 1;

} 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T00:56:16.707

这是因为你不拥有 的结果`cvQueryFrame`，`cvCapture`结构拥有。如果你想对结果做点什么，你必须先做一个副本。您看到两个不同框架的原因是因为`cvShowImage`在显示之前制作了自己的副本。到达调用位置`[self compareFrame]`后， frame 和 nextFrame 将指向相同的数据。

试试这个：

```
while (1) {
    cvSetCaptureProperty(capture, CV_CAP_PROP_POS_FRAMES, 10);
    frame =cvQueryFrame(capture);
    if (!frame) {
        NSLog(@"Couldn't read frame 10");
        break;
    };

    frame = cvCloneImage(frame); //Make a copy of the frame     

    cvSetCaptureProperty(capture, CV_CAP_PROP_POS_FRAMES, 100);
    nextFrame = cvQueryFrame(capture);
    if (!nextFrame) {
        NSLog(@"Couldn't read frame 100");
        break;
    };

    nextFrame = cvCloneImage(nextFrame); //Make a copy of the frame

    // PASS THE IMAGES TO THE NEW METHOD
    [self compareFrame: frame withFrame: nextFrame];
    char c = cvWaitKey();

    cvReleaseImage(&frame);
    cvReleaseImage(&nextFrame);
    if(c==27) {
        NSLog(@"ESC pressed!");
        break;
    }
} 
```

# c# - 在计算目录大小时获取 UnauthorizedAccessException

> ID：14076336
> 
> 赞同：1
> 
> 时间：2012-12-28T21:58:49.423
> 
> 标签：c#, directory

我有一个简单的方法来计算目录和其中所有文件的大小。这是代码：

```
using System;
using System.IO;

namespace MyProject.Libs
{
    public sealed class DirectorySize
    {
        public static long GetDirectorySize(DirectoryInfo dir)
        {
            long total = 0;

            FileInfo[] fileInfos = dir.GetFiles();
            foreach (FileInfo fileInfo in fileInfos)
            {
                total += fileInfo.Length;
            }

            DirectoryInfo[] dirInfos = dir.GetDirectories();
            foreach (DirectoryInfo dirInfo in dirInfos)
            {
                total += DirectorySize.GetDirectorySize(dirInfo);
            }

            return total;
        }
    }
} 
```

当我在驱动器 c:\ 上使用它时，我得到“UnauthorizedAccessException”，并显示一条消息“访问路径 'C:\Documents and Settings' 被拒绝。” 那是：

```
DirectoryInfo di = new DirectoryInfo(Path.GetPathRoot(Environment.SystemDirectory));
long ds = DirectorySize.GetDirectorySize(di); 
```

试图以管理员身份运行 Visual Studio。都一样。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:06:18.013

即使以管理员身份，您也无权访问某些文件和文件夹。您能做的最好的事情就是添加一些异常处理，并希望您返回的信息相当完整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:25:16.183

您的代码失败`C:\Documents and Settings`，现在是[指向](http://msdn.microsoft.com/en-us/library/windows/desktop/bb968829%28v=vs.85%29.aspx)`C:\Users`. 您可以使用`FileAttributes.ReparsePoint`目录的 进行检查。

这是带有额外异常处理的修改后的代码（对于您未授权的其他目录）：

```
public sealed class DirectorySize
{
    public static long GetDirectorySize(DirectoryInfo dir)
    {
        long total = 0;
        FileAttributes attributes = File.GetAttributes(dir.FullName);
        if (!((attributes & FileAttributes.ReparsePoint) == FileAttributes.ReparsePoint))
        {
            try{
                FileInfo[] fileInfos = dir.GetFiles();
                foreach (FileInfo fileInfo in fileInfos)
                {
                    total += fileInfo.Length;
                }

                DirectoryInfo[] dirInfos = dir.GetDirectories();
                foreach (DirectoryInfo dirInfo in dirInfos)
                {
                    total += DirectorySize.GetDirectorySize(dirInfo);
                }
            } catch (UnauthorizedAccessException)
            { 
                // log this?
            }
        }

        return total;
    }
} 
```

[**连接点**(Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/bb968829%28v=vs.85%29.aspx)

> 在 Windows Vista 和 Windows Server 2008 中，用户数据和系统数据的默认位置已更改。例如，以前存储在 %SystemDrive%\Documents and Settings 目录中的用户数据现在存储在 %SystemDrive%\Users 目录中。为了向后兼容，旧位置具有指向新位置的连接点。例如，**C:\Documents and Settings**现在是指向**C:\Users**的连接点。备份应用程序必须能够备份和恢复连接点。这些连接点可以如下识别：它们具有 **FILE_ATTRIBUTE_REPARSE_POINT**、FILE_ATTRIBUTE_HIDDEN 和 FILE_ATTRIBUTE_SYSTEM 文件属性集。他们还将访问控制列表 (ACL) 设置为**拒绝所有人的读取访问权限**。调用特定路径的应用程序如果具有所需的权限，则可以遍历这些连接点。但是，**尝试枚举连接点的内容将导致失败**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T22:03:22.847

有些文件夹甚至管理员都无权访问它们。这大部分时间都发生在翻译系统上。例如，“程序文件”文件夹在德语中将被称为“程序”。您无法访问代码中的“程序”，只能访问“程序文件”

# sql-server - 使用 TRUNCATE TABLE 如何影响索引

> ID：14076338
> 
> 赞同：16
> 
> 时间：2012-12-28T21:58:59.953
> 
> 标签：sql-server

使用 SQL Server 2005，升级到 2012

如果我有 ETL，则执行以下操作（简体）

```
TRUNCATE TABLE detination
INSERT INTO detination
SELECT *
FROM source 
```

这会清除索引并使用插入重建它吗？我会有碎片吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T00:50:36.340

假设它*不会*截断索引。这意味着数据库在物理上是不一致的。所以不能这样。

截断逻辑上删除所有行并为所有分区物理创建新的 b 树。由于树木是新鲜的，因此不存在碎片。

实际上，我不确定树是否分配了 0 或 1 页。但这没关系。我相信对于临时表，有一个与临时表缓存有关的特殊情况。也无所谓。

您问题中的插入与任何其他插入的工作方式相同。在跨语句通信方式中，它不受先前截断的影响。是否会导致碎片化取决于您的具体情况，恕我直言，最好放在一个新问题中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-03-08T12:04:59.253

挑战@sjaan 回复

MSDN “TRUNCATE TABLE 从表中删除所有行，但表结构及其列、约束、索引等仍然存在。” SQL团队说索引将存在但没有数据页......您可以通过[参考轻松检查](https://stackoverflow.com/questions/11946957/sql-server-number-of-8k-pages-used-by-a-table-and-or-database)

如果您检查该表上索引的大小，它将为零

```
SELECT *
FROM
(
    SELECT OBJECT_NAME(i.OBJECT_ID) AS TableName,
           i.name AS IndexName,
           i.index_id AS IndexID,
           8 * SUM(a.used_pages) AS 'Indexsize(KB)'
    FROM sys.indexes AS i
         JOIN sys.partitions AS p ON p.OBJECT_ID = i.OBJECT_ID
                                     AND p.index_id = i.index_id
         JOIN sys.allocation_units AS a ON a.container_id = p.partition_id
    GROUP BY i.OBJECT_ID,
             i.index_id,
             i.name
) a
WHERE A.TableName LIKE '%table%'
ORDER BY Tablename,
         indexid; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-12-21T13:57:54.040

“TRUNCATE TABLE 删除表中的所有行，但表结构及其列、约束、索引等保留。”

见文章：[https ://msdn.microsoft.com/en-us/library/ms177570.aspx](https://msdn.microsoft.com/en-us/library/ms177570.aspx)

# java - 组件在 JFrame 中是不可见的

> ID：14076341
> 
> 赞同：0
> 
> 时间：2012-12-28T21:59:05.780
> 
> 标签：java, swing

你能告诉我，为什么像 JPanel 等组件在添加到 JFrame 时不可见？这是我的代码：

```
public class GUI{
static JPanel panel = new JPanel();
private void createAndShowGUI()  {

    final ImageIcon zielonaikona = new ImageIcon("kulazielona.png");
    JFrame frame1 = new JFrame("MasterMind");
    JRadioButton zielony = new JRadioButton(zielonaikona);
    zielony.setSelected(true);
    frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JButton akceptuj = new JButton("Akceptuj");

    akceptuj.addActionListener(new ActionListener() {

        public void actionPerformed(ActionEvent e)
        {
            JLabel label2 = new JLabel(zielonaikona);            
            panel.add(label2);
        }
    });      

    BoxLayout layout = new BoxLayout(panel, BoxLayout.Y_AXIS);
    panel.add(akceptuj);
    panel.setLayout(layout);
    panel.add(zielony);
    JLabel label = new JLabel (zielonaikona); 
    panel.add(label);
    frame1.getContentPane().add(panel);
    frame1.getContentPane().add(akceptuj);
    frame1.getContentPane().add(zielony);
    frame1.setSize(200, 300);
    frame1.setVisible(true);

}

public static void main(String[] args) {

    GUI kk = new GUI();
    kk.createAndShowGUI();
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:06:48.353

您将控件添加到`JFrame`以及 中`JPanel` `panel`，因此它们只会出现在添加它们的最后一个容器中，即框架中。还因为您将它们添加到默认`BorderLayout.CENTER`位置，每个替换最后一个，所以您只剩下一个显示的组件（`JRadioButton` `zielony`）

要修复，请删除以下行：

```
 frame1.getContentPane().add(akceptuj);
  frame1.getContentPane().add(zielony); 
```

* * *

*旁白：*在动态添加新组件*时*（即`JLabel`添加到 中`ActionListener`），不要忘记调用：

```
panel.revalidate();
panel.repaint(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:09:12.593

按钮和单选按钮被添加了两次，分别添加到面板和框架中。您没有在框架上设置布局，但我认为它有一个默认布局。就是不记得是什么品种了。

这是您错误的代码。

```
 panel.add(akceptuj);
 panel.add(zielony); 
```

和

```
 frame1.getContentPane().add(akceptuj);
 frame1.getContentPane().add(zielony); 
```

# javascript - 关于我应该如何分析这个算法的任何想法？

> ID：14076348
> 
> 赞同：-5
> 
> 时间：2012-12-28T22:00:00.190
> 
> 标签：javascript, python

我想知道是否可以就如何分析算法获得一些帮助，我的老师给了我们一些字符串的验证码。和out project是我们必须为这个验证器创建一个keygen，当然，它在验证时必须是真的。我一直在尝试蛮力，但我没有运气，它已经工作了 2 小时。现在，所以任何关于如何解决这个问题的帮助、想法或提示都是完美的。

提前致谢。

这是验证器的代码：

```
function char2number(chr) {
        var code = chr.charCodeAt(0); 
        if(code<65) code = code-48; 
        else {
             code=code-65+10; 
             if(code>=11) code++;
             if(code>=22) code++; 
             if(code>=33) code++; 
        } 
        return code; 
}

function checkdata(code) { 
        var dig = 0; 
        var test = 1; 
        for(var i=0; i<code.length-1;i++) { 
                dig=dig+(char2number(code.charAt(i))*test);   
                test*=2; 
         } 
        dig = mod(dig,9); 
        if(dig==code.charAt(code.length-1)) return true; 
        else return false; }

 function mod(X,Y) { var t; t = X % Y; return t < 0 ? t + Y : t; }

function valida() {
        var codigo = document.getElementById("code").value;
        // Validate the code
        if( code == "" || code.length < 15 ) {
           alert("Invalid!");
           return false;
        }
        if( ! checkdata(code.toUpperCase()) ) {
           alert("Invalid!");
           return false;
        } 
```

这段代码是用 Javascript 编写的，因为我们必须用 Python 详细说明我们的解决方案，并从 Python 调用服务进行验证。我不认为编写代码很难，但我一直在思考解决这个问题的方法，但我找不到让它工作的模式。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:08:40.250

好的，里面发生了`checkdata`什么？好吧，无论它在结束前做什么，在`dig = mod(dig, 9)`它得到一个从 0 到 8 的数字之后，它都会将它与最后一个字符 ( `code.charAt(code.length-1))`) 进行比较。请注意，`for`上面的循环执行`i<code.length-1`而不是`i<code.length`，因此最后一个字符不包括在计算中。而且（除了检查长度 15+）这里没有其他事情发生。

因此，您甚至不必了解整个`for`循环在做什么。如果您可以生成 14 个或更多随机字符，在它们上运行完全相同的代码，并将结果附加到末尾，它就会通过。

一种快速而肮脏的方法是在结束之前添加一个`alert`（或者，也许更好，`console.log`在节点而不是浏览器中使用和运行......），然后`checkdata`向您展示什么`dig`是：

```
function checkdata(code) { 
  var dig = 0; 
  var test = 1; 
  for(var i=0; i<code.length-1;i++) { 
    dig=dig+(char2number(code.charAt(i))*test);
    test*=2;
  }
  dig = mod(dig,9);
  alert(dig);
  if(dig==code.charAt(code.length-1)) return true; 
  else return false;} 
```

所以现在，取一些 15 个或更多字符的随机字符串，比如“ABC123DEF456GHI789”。会弹出一个警报说“2”，它会失败，因为 2 和 9 不一样。所以只需使用“ABC123DEF456GHI782”，它就会通过。

现在您所要做的就是将该`checkdata`函数移植到 Python，将 更改`alert(dig)`为`return code[:-1] + dig`，编写代码以生成 15 个字符的随机字符串，当然还要编写调用该服务的代码。但就是这样。

顺便说一句，移植到 Python 并不总是*像*看起来那么简单。例如：

*   JS，`2`是一个64位的浮点数；Python`2`是一个无限位整数。
*   JS 字符串是 Unicode；Python 2.x 字符串不是（但 3.x 是）。
*   某些浏览器中的 JS 字符串实际上是 UTF-16，而不是 Unicode。
*   JS`%`是保符号的；Python`%`总是积极的。

幸运的是，为了编写一个注册机，你可以生成一些不会超出这些东西的限制的东西，但是你应该仔细考虑以确保你这样做。

我应该补充一点，您的老师可能希望您*了解*循环内部发生的事情`for`，而不是将其视为黑匣子。此外，在现实生活中，无论谁编写了这个愚蠢的算法，都会弄清楚你是如何破解它的，然后做一个微不足道的更改，至少部分地理解循环是必要的（例如，如果他们将 更改`<code.length-1`为`<code.length`）。

# python - Django 查询 timezone.now 和 __range 中断的日期范围？

> ID：14076350
> 
> 赞同：3
> 
> 时间：2012-12-28T22:00:12.337
> 
> 标签：python, django, django-timezone

我正在使用 PostgreSQL 数据库 (9.2.2) 运行 Django 1.4.3 和 Python 2.7。我有一个带有“last_view”字段的模型，该字段是用户最后一次查看记录的时间戳。在我的首页上，我想显示上周查看次数最多的十个项目，因此在我的 ListView 中，我尝试将其用于我的查询集：

```
startdate = timezone.now() - datetime.timedelta(days=7)
enddate = timezone.now()
urlpatterns = patterns('',
    url(r'^$',
        ListView.as_view(
            queryset=Tag.objects.filter(last_view__range=([startdate, enddate])).order_by('-views')[:10],
            context_object_name='most_viewed_list',
            template_name='tags/index.html'),
        name='index'), 
```

这在我第一次加载页面时有效。如果我单击任何记录并“查看”它们，则数据库中的 last_view 属性会更新——但如果我随后重新加载页面，则该项目将从“最近查看”列表中消失（由上述查询集形成）。

我认为问题与这篇[文章](https://stackoverflow.com/questions/13225890/django-default-timezone-now-saves-records-using-old-time)有关，似乎 timezone.now() 的“结束日期”受我启动服务器进程的时间限制。因此，当我在服务器运行后单击链接时，与“now()”相比，“当前时间”在未来并且超出范围（这就是我单击的记录在页面重新加载时消失的原因）。但是，如果我像上面提到的帖子中那样将内容更改为**现在**，我会在页面加载时收到错误消息：

```
startdate = timezone.now - datetime.timedelta(days=7)
enddate = timezone.now 
```

- 不支持的操作数类型：“function”和“datetime.timedelta”

所以我无法创建我的 startdate 变量。**我可以通过将我的查询集从 _range 更改为 _gte 来使其工作，但如果now()**的时间戳确实是服务器进程启动的时间而不是“当前时间” ，那么它似乎会随着时间的推移而中断。

```
queryset=Tag.objects.filter(last_view__gte=(timezone.now() - datetime.timedelta(days=7)).order_by('-views')[:10] 
```

关于测试的[Django 教程](https://docs.djangoproject.com/en/dev/intro/tutorial05/)确实显示了**now**在对日期进行查询时的用法，但是它们没有显示如何从**现在**减去天数或将其与 timedelta 或日期范围一起使用...

有人可以解释一下如何从实际的当前时间获取时间差，即使用**now**而不是**now()**吗？我还想更好地了解使用**now()**与**now**的局限性。我找不到很好的文档，因为我可以使用 timedelta() 找到的所有示例都引用 timezone.now() 或 datetime.now()，它们有效（只是不是我想要的方式）。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T03:44:27.417

子类`ListView`化并覆盖该`get_queryset`方法。通过计算方法内部的`startdate`and ，将是发出请求的时间，而不是最初加载的时间。`enddate``get_queryset``timezone.now()``urls.py`

```
class TagListView(ListView):
    def get_queryset(self):
        startdate = timezone.now() - datetime.timedelta(days=7)
        enddate = timezone.now()
        return Tag.objects.filter(last_view__range=[startdate, enddate]).order_by('-views')[:10]
    context_object_name='most_viewed_list'
    template_name='tags/index.html'

urlpatterns = patterns('',
    url(r'^$', TagListView.as_view(), name='index'),
) 
```

# zend-framework2 - ZF2 中的控制器覆盖

> ID：14076351
> 
> 赞同：4
> 
> 时间：2012-12-28T22:00:17.243
> 
> 标签：zend-framework2

我是 Zend Framework 2 的新手。我正在启动一个项目，我希望它的安全性由 ZfcAdmin、ZfcUser、ZfcUserAdmin 和 BjyAuthorize 管理。我要做的第一件事是修改创建用户的过程。我希望能够在创建新用户后立即为其分配角色。

我面临的第一个问题是创建用户时，控制器将我重定向到用户的列表页面。我需要改变这种行为，我想被重定向到编辑页面，在那里我可以为最近创建的用户选择 N 个角色（这将是与实体的另一场战争......）。我选择了覆盖 UserAdminController (ZfcUserAdmin)。这就是我为实现这一目标所做的事情：

**1.**我将管理模块 (MyAdministration) 加载到*application.config.php*的最后一个位置，以便能够覆盖其他模块的属性。

**2.我在***MyAdministration/config/module.config.php*中覆盖 ZfcUserAdmin 控制器以使用我的：

```
(...)
'controllers' => array(
    'invokables' => array(
        'zfcuseradmin' => 'MyAdministration\Controller\MyAdministrationController',
    ),
),
(...) 
```

**3.**我创建了 *MyAdministration/src/MyAdministration/Controller/MyAdministrationController.php 类*

**4.**我已经声明它扩展了 ZfcUserAdmin 之一

```
namespace Administracion\Controller;
(...)
use ZfcUserAdmin\Controller\UserAdminController;

class AdministracionController extends UserAdminController {
(...) 
```

**5.**我重写了 createAction 函数以重定向到编辑页面

```
(...)
public function createAction() {
(...)
return $this->redirect()->toRoute('zfcadmin/zfcuseradmin/edit/:userId', 
    array('userId' => $user->getId()));
}
(...) 
```

这就是我不知道我是否做得对的地方。搜索网络和调试我了解到有一个名为 InjectTemplateListener 的类，它将控制器的命名空间转换为所需模板的路径。我的控制器“被翻译”为 **my-administration/my-administration/edit**导致无处可去，模板属于 ZfcUserAdmin 模块。正确的路径是它的控制器获得的路径（ZfcUserAdmin\Controller\UserAdminController）： **zfc-user-admin/user-admin/edit**

我还了解到模板路径可以手动编写。InjectTemplateListener 会忽略这些路径。这就是我使用的方法。在 *MyAdministration/config/module.config.php*我写过：

```
(...)
'view_manager' => array( 
    'template_map' => array(
        'my-administration/my-administration/list' => __DIR__ . '/../../../vendor/ZfcUserAdmin/view/zfc-user-admin/user-admin/list.phtml',
        'my-administration/my-administration/create' => __DIR__ . '/../../../vendor/ZfcUserAdmin/view/zfc-user-admin/user-admin/create.phtml',
        'my-administration/my-administration/edit' => __DIR__ . '/../../../vendor/ZfcUserAdmin/view/zfc-user-admin/user-admin/edit.phtml',
        'my-administration/my-administration/pagination_userlist' => __DIR__ . '/../../../vendor/ZfcUserAdmin/view/zfc-user-admin/user-admin/pagination_userlist.phtml',
    ),
    (...) 
), 
```

我不确定这是否是实现这一目标的最佳方式。我觉得必须有更好的方法来做到这一点，而不是手动编写模板路径。我发现很少有关于覆盖控制器的东西，也没有例子……这样可以吗？有没有人有更好的方法来做覆盖？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T13:28:03.203

您是正确的，模板名称*可以*由侦听器注入。那是在这个单一的条件下：如果没有设置模板名称。

因此，对于此操作，注入模板侦听器会注入模板名称：

```
namespace MyModule;

class MyController
{
  public function myAction()
  {
    return new ViewModel;
  }
} 
```

模板将是`my-module/my-controller/my-action`. 但是，如果您设置模板，则将跳过侦听器：

```
namespace MyModule;

class MyController
{
  public function myAction()
  {
    $view = new ViewModel;
    $view->setTemplate('another-module/my-controller/my-action');

    return $view;
  }
} 
```

您可以在控制器中看到您正在覆盖[返回的数据，表单是一个简单的数组，甚至不是一个视图模型](https://github.com/Danielss89/ZfcUserAdmin/blob/master/src/ZfcUserAdmin/Controller/UserAdminController.php#L43-L47)。重定向插件返回一个 Response 对象。

因此，您检查返回值是否为数组，如果是，则**显式**设置模板。这会跳过侦听器以注入模板名称：

```
namespace MyAdminModule;

use ZfcUserAdmin\Controller\UserAdminController as BaseUserAdminController;

use Zend\View\Model\ViewModel;
use Zend\Http\Response;

class UserAdminController extends BaseUserAdminController
{
    public function createAction()
    {
        $result = parent::createAction();

        if ($result instanceof Response) {
            // Old behaviour
            return $this->redirect()->toRoute('zfcadmin/zfcuseradmin/edit/:userId', 
                                              array('userId' => $user->getId()));
        }

        // $result is array
        $view = new ViewModel;
        $view->setVariables($result);
        $view->setTemplate('zfc-user-admin/user-admin/create');

        return $view;
    }
} 
```

因为您现在直接设置模板名称，所以您可以跳过在配置中对模板映射的操作。这也增强了灵活性，因为您使用模块外部的路径对模板路径进行了硬编码。您现在还可以选择在另一个模块中覆盖 zfcUserAdmin 模板映射。

# ruby-on-rails - Ruby“分桶”一个数组

> ID：14076354
> 
> 赞同：3
> 
> 时间：2012-12-28T22:00:21.907
> 
> 标签：ruby-on-rails, ruby

假设我有以下数组：

```
a = (1..10).to_a 
```

是否有一个内置的 ruby​​（或 rails）函数能够在保持顺序的同时将数组拆分为 N 个大致相等的部分？

我正在寻找这样的东西：

```
a.bucketize(3)
=> [[1,2,3,4],[5,6,7],[8,9,10]]
a.bucketize(5)
=> [[1,2],[3,4],[5,6],[7,8],[9,10]] 
```

提示：`each_slice`不这样做。

另外，我知道我可以自己编写这个函数并打开`Array`类或`Enumerable`模块。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T04:06:26.737

我会这样做：

```
ary = (1..10).to_a

ary.each_slice((ary.length.to_f/3).ceil).to_a
=> [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10]]

ary.each_slice((ary.length.to_f/5).ceil).to_a
=> [[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]] 
```

它并不完美，但确实很接近：

```
ary = (1..9).to_a
=> [1, 2, 3, 4, 5, 6, 7, 8, 9]

ary.each_slice((ary.length.to_f/2).ceil).to_a
=> [[1, 2, 3, 4, 5], [6, 7, 8, 9]]

ary.each_slice((ary.length.to_f/3).ceil).to_a
=> [[1, 2, 3], [4, 5, 6], [7, 8, 9]]

ary.each_slice((ary.length.to_f/4).ceil).to_a
=> [[1, 2, 3], [4, 5, 6], [7, 8, 9]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T10:44:57.980

这种任务最好使用函数式方法来解决。这是一个尾递归函数实现（除了不可避免`<<`地在数组上有效累积）：

```
class Array
  def bucketize(n, index = 0, acc = [])
    return acc if n <= 0 || size <= index
    n0 = ((size - index).to_f / n).ceil
    bucketize(n - 1, index + n0, acc << self[index, n0])
  end
end

(1..9).to_a.bucketize(3)
#=> [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
(1..10).to_a.bucketize(3)
#=> [[1, 2, 3, 4], [5, 6, 7], [8, 9, 10]]
(1..11).to_a.bucketize(3)
#=> [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11]] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T09:29:55.283

这就是我最终做的事情：

```
class Array
  def bucketize(n)
    return [] if (buckets = n.to_i) <= 0
    j = length / buckets.to_f
    result = each_with_index.chunk { |_, i| (i / j).floor }.map { |_, v| v.map(&:first) }
    result << [] until result.length == buckets
    result
  end
end 
```

例子：

```
a = (1..10).to_a
=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
a.bucketize(1)
=> [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]]
a.bucketize(2)
=> [[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]]
a.bucketize(3)
=> [[1, 2, 3, 4], [5, 6, 7], [8, 9, 10]]
a.bucketize(4)
=> [[1, 2, 3], [4, 5], [6, 7, 8], [9, 10]]
...
a.bucketize(9)
=> [[1, 2], [3], [4], [5], [6], [7], [8], [9], [10]]
...
a.bucketize(11)
=> [[1], [2], [3], [4], [5], [6], [7], [8], [9], [10], []] 
```

# php - if && not true && not true && not true 返回 true

> ID：14076359
> 
> 赞同：4
> 
> 时间：2012-12-28T22:00:54.870
> 
> 标签：php, if-statement

我正在检查是否`$_SESSION`填充了用户变量以及登录名是否正确。这是我的代码：

```
if(!empty($_SESSION['user'])&&!empty($_SESSION['pwd'])&&!verifyLogin($_SESSION['user'],$_SESSION['pwd'])){ 
```

`$_SESSION['user']`是用户名，`$_SESSION['pwd']`是密码，`verifyLogin()`是我验证用户登录的功能。

为什么即使`$_SESSION['user/pwd']`为空，我的 if 语句也会返回 true？我不应该回假吗？

即使我这样做：

```
if(!empty($_SESSION['user'])&&!empty($_SESSION['pwd'])&&verifyLogin($_SESSION['user'],$_SESSION['pwd'])==false){ 
```

我仍然得到相同的结果。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:06:07.157

更改您的支票以使用[`isset`](http://www.php.net/isset)over `empty`。`empty`如果它是空的，将返回 true，但如果它没有设置。查看[这篇关于差异的帖子](http://www.virendrachandak.com/techtalk/php-isset-vs-empty-vs-is_null/)。

```
if (isset(_usr_) && !empty(_usr_) // exists and isn't empty
 && isset(_pwd_) && !empty(_pwd_)
 && verifyLogin(_usr_, _pwd_)){
} 
```

从手册[`empty()`](http://php.net/manual/en/function.empty.php)：

> **如果 var存在并且具有非空、非零值，**则返回 FALSE 。否则返回 TRUE。

即未设置将返回`TRUE`。

# sql - MS SQL Server - 使用案例语句从 3 条记录创建单行

> ID：14076360
> 
> 赞同：2
> 
> 时间：2012-12-28T22:01:04.760
> 
> 标签：sql, sql-server, tsql, pivot

我有一个表，其中包含会话和问题的数字字段。每节课都有问题 1、2 和 3。1 = “努力”，2 = “满意度”，3 = “知识”。有 5 个可能的答案“非常满意”、“非常满意”、“有点满意”、“不满意”、“非常不满意”。

该表如下所示：

```
Session  Question  Answer
-------  --------  ------------------
1        1         Unsatisfied
1        2         Very Satisfied
1        3         Somewhat Satisfied 
```

我希望报告看起来像这样：

```
Session  Effort          Knowledge       Satisfaction
-------  --------------  --------------  --------------
1        Unsatisfied     Unsatisfied     Very Satisfied
2        Very Satisfied  Very Satisfied  Very Satisfied 
```

但是，当我使用我的案例陈述时，我得到：

```
Session  Question  Effort       Knowledge       Satisfaction
-------  --------  -----------  --------------  ------------
1        1         Unsatisfied  NULL            NULL
1        2         NULL         Very Satisfied  NULL
1        3         NULL         NULL            Unsatisfied 
```

我正在使用的查询是：

```
select 
    distinct session
    ,Question
    ,case
      when Question = '1' 
      then Answer
            end as "Effort"
,case
      when Question = '3' 
      then Answer
            end as "Knowledge"
,case
      when Question ='2' 
      then Answer
            end as "Satisfaction"
from Survey_Table 
```

关于如何让数据在每个会话中以单行形式返回的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T22:16:21.737

试试这个将聚合应用于 CASE 语句：

```
select session
   ,max(case when Question = '1' then Answer end) as Effort
   ,max(case when Question = '3' then Answer end) as Knowledge
   ,max(case when Question ='2' then Answer end) as Satisfaction
from Survey_Table
Group by session 
```

或者您可以使用 PIVOT 功能：

```
 Select session,
     [1] as effort,
     [2] as satisfaction,
     [3] as knowledge
 From
 (
       Select session, question, answer
       From survey_table
  ) src
  Pivot
  ( 
      Max(answer)
      For question in ([1], [2], [3])
  ) piv 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-24T13:21:42.807

Also:

You can combine max with partition by to remove the need to group by. e.g.

```
max(case when xxx ='123' then yyy end) OVER(PARTITION BY a,b,c) AS Test1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T22:38:54.573

请注意：[bluefeet 的回答](https://stackoverflow.com/a/14076485/57611)已经涵盖了这个基本方法。我只是想指出另一种构建`PIVOT`. 您确实应该有自己的表来将`Question`列值与标题相关联，但是在没有这样的表的情况下，我会亲自将此信息编码为派生表，而不是`[1], [2], [3]`使用明确的列别名将 Question 值链接到其相应的标题：

```
SELECT
   P.*
FROM
   (
      SELECT T.SessionID, Q.Title, T.Answer
      FROM
         dbo.SurveyTable T
         INNER JOIN (
            SELECT 1, 'Effort'
            UNION ALL SELECT 2, 'Knowledge'
            UNION ALL SELECT 3, 'Satisfaction'
         ) Q (Question, Title)
            ON T.Question = Q.Question
   ) S
   PIVOT (Max(Q.Answer) FOR Q.Title IN (Effort, Knowledge, Satisfaction)) P 
```

这将适用于 MS SQL Server 2005 及更高版本。

# git - Git在jail shell上与单个用户、多个开发人员共享repo

> ID：14076361
> 
> 赞同：1
> 
> 时间：2012-12-28T22:01:08.727
> 
> 标签：git, jail-shell

我一直在尝试为一小群开发人员建立一个像样的共享存储库位置，以便私下共享代码（所以没有 github 等）。埃塞俄比亚的互联网不稳定、缓慢，一些网站无缘无故被阻止（没有 bitbucket）。

我的网络服务器上有一个监狱外壳访问权限。我设法在那里编译和安装 git，并在那里托管一个裸仓库。这很好用，我唯一关心的问题是所有开发人员都将使用相同的用户名访问该帐户。即使我不共享密码，并且每个人都上传他们的公钥，我认为用户名是相同的。

这会导致任何问题吗？我想不出来，但这样做似乎很不正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:04:07.263

它不一定是不规则的；只需查看 Github 为您提供的 SSH 存储库规范 ( `git@github.com:path/to/repo/...`)。如果您授予所有人访问权限的帐户是您的主要登录名，这将是不正常的。共享用户名本身不是问题，但您将有效地为所有开发人员提供与您的服务器相同的访问权限。

# c++ - 具有相同模板类型的模板类中的模板方法

> ID：14076362
> 
> 赞同：1
> 
> 时间：2012-12-28T22:01:11.293
> 
> 标签：c++, templates

我有一个模板类，想为具有相同模板类型的类构建一个模板方法，如下所示

```
template<class T>
class A
{
public:
    void Set<T>(const T& t)  {...}  // I think this is wrong.

...
};

A<int> a;
a.Set<int>(10); 
```

如何让它发挥作用？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:05:05.933

你不需要做任何特别的事情。内`A`,`T`也被定义，这包括 的定义`Set`。所以你只会说：

```
template< class T >
class A
{
public:
    void Set( const T& t ) {...}
}; 
```

如果您也想模板化`Set`，以便可以使用不同的类型，您可以这样做：

```
template< class T >
class A
{
public:
    template< typename U > void Set( const U& u ) {...}
}; 
```

最后，请注意，有时在调用*模板函数*时，您不需要*显式*声明其模板参数。它们将从您用来调用它们的参数的类型中*推导出来。**IE，*

```
template< typename T > void Set( const T& t ) {...}

Set( 4 ) // T deduced as int
Set( '0' ) // T deduced as char
Set<int>( '0' ) // T explicitly set to int, standard conversion from char to int applies 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:05:32.470

如果您的意思是成员模板：

```
template<class T>
class A
{
public:
    template <typename U> void Set(const U& u)  {...}
}; 
```

# maven - 如何在 Cloudbees 中使用 ANT

> ID：14076363
> 
> 赞同：0
> 
> 时间：2012-12-28T22:01:11.743
> 
> 标签：maven, ant, jenkins, cloudbees

我正在尝试使用 Jenkins 将现有的 ANT 构建脚本 (build.xml) 移动到 Cloudbees for CI。我使用 GitHub 设置项目存储库。构建成功将存储库拉入 Cloudbees 工作区，但随后失败并显示此消息。

```
Parsing POMs
ERROR: No such file /scratch/jenkins/workspace/project/pom.xml
Perhaps you need to specify the correct POM file path in the project configuration? 
```

我对此不太熟悉，但据我所知（感谢 Google），这是因为 Cloudbees 使用 Maven 而不是 ANT。有没有办法让 Jenkins 运行 ANT 构建脚本而不是使用 Maven？还是从 Maven 执行我的 ANT 脚本的简单方法？这里的任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:37:26.927

如果您的项目是基于 Ant 的，则不需要 Maven POM 文件。

听起来您在 Jenkins 中创建了一个 Maven 作业。删除它并创建一个*自由样式的*作业，然后（如@thekbb 所说）单击*添加构建步骤*并选择*调用 Ant*并根据需要进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:00:18.583

ant 支持由 teh [ant 插件](https://wiki.jenkins-ci.org/display/JENKINS/Ant+Plugin)提供，我认为您在安装 jenkins 时会自动获得此支持。在您的 jenkins 作业中，添加类型为“Invoke Ant”的构建步骤并提供目标。

# python - Python - 将txt文件放入列表

> ID：14076365
> 
> 赞同：-2
> 
> 时间：2012-12-28T22:01:39.583
> 
> 标签：python, list, file-io, python-3.x

我正在尝试读取文件并将其中的文本保存为包含字符串的列表，（列表中的每个对象都是一个字符串，它是文本中的一行）我只设法逐行打印出文本，并且不作为一个列表。

文本是一长串生物材料（如果你问我，随机字母 (:) 和-

```
 def read_proteome ( filename ):
       f= open(filename).readlines()
       for line in f:
          print(line) 
```

只打印文件（确实分开了行..）

我哪里做错了 ？我如何将其设置为列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:09:04.717

的结果[`.readlines()` *是*一个列表](http://docs.python.org/3/library/io.html?highlight=readlines#io.IOBase.readlines)。只需打印`f`：

```
print(f) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:44:23.537

Martijn Pieters 已经给出了一个简单而完整的答案，但值得学习如何自己弄清楚这些事情。它通常更快，并且不会花费您六次反对票。

首先，您可以使用的事实`for line in f:`意味着它`f`显然是某种列表对象，因为它可以像可以`for`一样在循环中使用`list`。从技术上讲，这意味着它是“可迭代的”。

也许这意味着它已经是`list`? 如果是这样，你已经完成了。如果没有，该`list`函数将接受任何可迭代并将其变为 a `list`，因此，您只需添加即可`f = list(f)`。

你怎么知道哪个？

好吧，您可以添加`print(type(f))`到您的代码中并查看它打印出来的内容。如果它说`list`，你就完成了；如果还有其他内容，则需要添加转换行`f = list(f)`。

以交互方式完成这一切通常比在脚本中更容易：

```
>>> f = open(filename).readlines()
>>> type(f)
list
>>> f
['first line\n', 'second line\n', 'last line\n'] 
```

如果将其分解为多个部分，则可以分别查看每个部分的类型：

```
>>> filename = 'C:/foo.txt'
>>> type(filename)
str
>>> fileobj = open(filename)
>>> type(fileobj)
_io.TextIOWrapper
>>> lines = fileobj.readlines()
>>> type(lines)
list 
```

当你把所有这些放在一行中时`lines=open('C:/foo.txt').readlines()`，最终结果就像你分三步完成一样——<code>lines 是一个`list`.

但是，如果您因为不知道该尝试什么而无法通过实验来解决问题怎么办？

好吧，交互式解释器具有内置帮助：

```
>>> fileobj = open(filename)
>>> help(fileobject.readlines)
Help on built-in function readlines:

readlines(...)
    Return a list of lines from the stream.

    hint can be specified to control the number of lines read: no more
    lines will be read if the total size (in bytes/characters) of all
    lines so far exceeds hint. 
```

它在那里说它返回一个`list`.

或者，您可以查看[文档](http://docs.python.org/3/index.html)。尝试猜测`readlines`可能在 3.x 中的位置实际上有点复杂，因为`open`返回的东西的类型并不明显……但是您可以使用左侧的“快速搜索”，您会找到[`io.ioBase.readlines`](http://docs.python.org/3/library/io.html?highlight=readlines#io.IOBase.readlines)，它为您提供相同的答案：

> `readlines(hint=-1)`
> 
> 从流中读取并返回行列表。可以指定提示来控制读取的行数：如果到目前为止所有行的总大小（以字节/字符为单位）超过提示，则不会再读取行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-01T20:26:59.600

正如 Martijn 所说， .readlines() 将文件转换为列表并在它们之间循环。但是，这就是我认为您正在尝试做的事情。

```
with open("file.txt", 'r') as file:
    print file.read().split("\n") 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-28T22:19:49.360

正如 Martijn 所说，readlines() 方法返回一个列表，如 python[文档](http://docs.python.org/3.2/tutorial/inputoutput.html#methods-of-file-objects "文件")中所述。

如果您需要将字符串转换为列表，请使用：[ast helper](http://docs.python.org/3.2/library/ast.html#ast-helpers)

```
导入 ast
stringList = "{'a':'text'}"
realList = ast.literal_eval(stringList)
打印真实列表

```

希望这是你需要的！

# c - c - 正确释放结构的内存

> ID：14076369
> 
> 赞同：3
> 
> 时间：2012-12-28T22:01:59.393
> 
> 标签：c, memory

我的名为 的结构`Table`包含一个名为 的结构的数组`Object`。Object 持有指向另一个的指针`Object`。我想做两种方法——一种释放 an `Object`，另一种释放 a`Table`当指向这些结构的指针时（`ObjectP`和`TableP`分别）：

这是我目前的幼稚实现，它绝对不起作用，因为 valgrid 到处都是警告（我对来自 Java 的 c 真的很陌生）：

```
/*
 * Represents a linked list containing a key value
 */
typedef struct Object {
    void *key;
    struct Object *top;
    struct Object *next;
    Boolean originalCell;
} Object;

/*
 * Represents a table that stores keys based on a given object's hash
 */
typedef struct Table{
    Object *linkedObjects;
    size_t size, originalSize;
    HashFcn hfun;
    PrintFcn pfun;
    ComparisonFcn fcomp;
    Boolean wasDuplicated;
} Table;

void FreeObject(ObjectP object)
{
    free(object);
}

void FreeTable(TableP table)
{
    free(table);
} 
```

我应该如何正确释放这些结构？

编辑：

这就是我分配变量的方式：

```
ObjectP CreateObject(void *key)
{
struct Object *object = (struct Object*) malloc(sizeof(struct Object));
...
}

TableP CreateTable(size_t tableSize, HashFcn hfun, PrintFcn pfun, ComparisonFcn fcomp)
{
    struct Table *table = malloc(sizeof(Table));

    if (table==NULL)
    {
        ReportError(MEM_OUT);
        return NULL;
    }

    table->linkedObjects = NULL;
    table->linkedObjects  = malloc(tableSize * sizeof(Object));
...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:20:36.240

为了删除整个表（连同对象），您需要遍历对象图并调用`free()`通过 malloc 分配的每个块，即其中一个`Object`或一个数组。

我了解您的对象图如下所示：

![图形](../Images/18f4d245ba277c99bce571ffd1a819ac.png)

那么删除的方法是：

```
void FreeObjectChain(Object* obj) {
    Object* curr = obj->next;
    while (curr) {
        Object* tmp = curr;
        curr = tmp->next;
        free(tmp);
    }
} 
```

和

```
void FreeTable(Table* table) {
    for (int i=0; i<table->size; ++i) {
        FreeObjectChain( &(table->linkedObjects[i]) );
        // or simply FreeObjectChain( table->linkedObjects + i );
    }
    free(table->linkedObjects);
    free(table);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:18:39.813

*我不喜欢你的`ObjectP`和`TableP`符号；我将使用`Object *`and明确指针`Table *`。*

从评论中，您只关心删除整个表格；这很好，因为它比删除任意对象要简单得多。

我假设`tableSize`参数 to`CreateTable()`存储在`table->size`.

```
static Object *FreeObject(Object *obj)
{
    Object *next = 0;
    if (obj != 0)
    {
        free(obj->key);   // If you allocated this
        next = obj->next;
        free(obj);
    }
    return(next);
}

void FreeTable(Table *tab)
{
    if (tab != 0)
    {
        for (size_t i = 0; i < tab->size; i++)
        {
            Object *next = tab->linkedObjects[i].next;
            while ((next = FreeObject(next)) != 0)
                ;
            free(tab->linkedObjects[i].key);  // If you allocated this
        }
        free(tab->linkedObjects);
        free(tab);
    }
} 
```

该`FreeObject()`函数是静态的，因为它仅供`FreeTable()`. 它删除键，假设在分配对象时分配了键；它捕获指向列表中下一项的指针（可能是空指针），释放对象本身，并返回指向下一项的指针。

该`FreeTable()`函数使用该`FreeObject()`函数释放链接对象列表中的所有对象，这些对象挂在名为 的数组中分配的对象上`linkedObjects`，然后删除对象数组，然后删除表。

释放内存时的关键是确保每次分配都有一个空闲空间，并且每次分配只有一个空闲空间。传递给的值`free()`必须是来自`malloc()`或`calloc()`的值`realloc()`。请记住， a`realloc()`可以更改先前分配的地址，但`realloc()`必须释放 from 的值而不是来自`malloc()`or的原始分配`calloc()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:15:38.397

我会尝试做这样的事情：

```
void freeObject(Object* obj) {
    if (obj->next != NULL) {
        freeObject(obj->next);
    }
    if (obj->key != NULL) {
        free(obj->key);
    }   
    free(obj);
}

void freeTable(Table* table) {
     for (int i=0; i<table->size; ++i) {
         freeObject(&(table->linkedObjects[i]));
     }
     freeObject(table->linkedObjects);
     free(table);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T22:09:30.127

FreeTable() 必须遍历数组并在所有对象上调用 free()。

在尝试任何处理内存管理的代码之前，您应该首先了解/了解计算机如何在低级范围内工作。

# sql - SQL server 2008 r2 将备份加载到另一个数据库

> ID：14076371
> 
> 赞同：0
> 
> 时间：2012-12-28T22:02:32.847
> 
> 标签：sql, sql-server-2008-r2

我有来自 msdn 的以下查询来恢复 SQL Server 数据库备份

```
RESTORE DATABASE <DBName> FROM DISK = '<BackupFilePath>\<BackupFileName>'
GO 
```

如果您想将备份加载到具有新名称的新数据库而不恢复它以替换当前数据库怎么办？

在界面中，我将选择`Restore Files and Filegroups`并更改为数据库名称，然后它将创建一个包含备份数据的新名称，这可以通过简单的查询来实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:35:58.403

上面的 restore 命令可用于指定新名称，但当旧数据库仍然存在于同一台机器上时，您会收到错误消息，因为它将尝试对数据使用相同的文件名。您可以使用 WITH MOVE 子句来解决这个问题：

```
RESTORE DATABASE TestDB 
   FROM DISK = 'C:\Backup.BAK',
   WITH MOVE 'AdventureWorks2012_Data' TO 'C:\MySQLServer\testdb.mdf',
   MOVE 'AdventureWorks2012_Log' TO 'C:\MySQLServer\testdb.ldf';
GO 
```

上面的例子来自 MSDN 文档中的 restore 命令：

[http://msdn.microsoft.com/en-us/library/ms186858.aspx](http://msdn.microsoft.com/en-us/library/ms186858.aspx)

# java - Java UDP 多播 - 奇怪的异常

> ID：14076379
> 
> 赞同：3
> 
> 时间：2012-12-28T22:02:47.257
> 
> 标签：java, multicast

我正在使用以下代码`Hello, world!`使用 Java 发送到多播组。

```
InetSocketAddress sa = new InetSocketAddress("239.0.0.1", 12345);
MulticastSocket s = new MulticastSocket(sa);
s.setTimeToLive(255);
s.joinGroup(sa.getAddress());

byte[] sbuf = "Hello, world!".getBytes();
DatagramPacket sp = new DatagramPacket(sbuf, sbuf.length, sa);
s.send(sp);

byte[] rbuf = new byte[1024];
DatagramPacket rp = new DatagramPacket(rbuf, rbuf.length);
s.receive(rp);

System.out.format("Received \"%s\".\n", new String(rbuf));

s.leaveGroup(sa.getAddress());
s.close(); 
```

出于某种原因，代码总是抛出这样的异常：

```
java.io.Exception: Invalid argument
    at java.net.PlainDatagramSocketImpl.send(Native Method)
    at java.net.DatagramSocket.send(...)
    at ... 
```

为什么是这样？我该如何解决？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-28T22:15:18.667

获取数据：

```
 InetAddress group;
            int port;
            group = InetAddress.getByName("239.0.0.1");
            port = Integer.parseInt("12345");

            //create Multicast socket to to pretending group
            MulticastSocket s = new MulticastSocket(port);
            s.joinGroup(group);

while(running){

            s.receive(pkt);

            System.out.println();

            String msg_rec;

            msg_rec = new String(pkt.getData(), 0, pkt.getLength());

            System.out.println("(FROM:" + pkt.getAddress()+ ") "+ msg_rec);

            System.out.println();

        } 
```

发送数据：

`String msgToSend = "Hello, world!";`

```
 dgram = new DatagramPacket(msgToSend.getBytes(), msgToSend.length(), group ,port);
            s.send(dgram); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T00:13:33.957

您正在调用`send()`一个未连接`DatagramSocket`且不`DatagramPacket`包含目标地址的端口：端口。所以无处可寄。如果您的意思是发送到多播地址，则需要通过执行第一句中提到的任何一项来说明。加入群组不会这样做：它只会影响接收。

# ruby-on-rails - rails 3 link_to：远程

> ID：14076381
> 
> 赞同：1
> 
> 时间：2012-12-28T22:02:52.427
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, link-to

我对 RoR 有点陌生，我正在尝试使用 link_to 重新加载 div id 为“current_submission”的页面的一部分，

```
-for submission in @submissions
    =link_to submission.title, "/submissions/#{submission.id}/display_attachment", :remote=>true
%div#current_submission 
```

我希望单击提交标题时，“/submissions/#{submission.id}/display_attachment”的内容显示在页面底部。我还不知道javascript，我看到的例子似乎需要用javascript写一个函数？我认为 AJAX 的目的是避免通过学习 javascript 来破坏 Rails 抽象。我需要学习javascript来实现这个吗？另外，我使用 jquery 而不是原型。

我看了 RailsCast #205，但还是很困惑。

# php - 在页面之间传递值

> ID：14076384
> 
> 赞同：0
> 
> 时间：2012-12-28T22:03:08.490
> 
> 标签：php

我有一个页面叫`connect.php`

此页面与 twitter 连接并使用 OAuth 获取值。所以这个页面包含这样的值：

```
$id = 1;
$provider = 'twitter';
$name = 'Tom'; 
```

现在我有另一个页面叫做`email.php`

此页面有一个表单，用户可以在其中输入他的电子邮件地址。现在我想将值从`connect.php`to 传递给`email.php`.

用户输入电子邮件后，我想将该数据插入我的数据库中。有人可以通过提供一些资源来为我指明正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:10:22.567

您可以使用 PHP 会话 - [http://php.net/manual/en/session.examples.basic.php](http://php.net/manual/en/session.examples.basic.php)。

根据您的需要，您可以做这样的事情。

在 connect.php 中：

```
session_start();

$_SESSION['id'] = 1;
$_SESSION['provider'] = 'twitter';
$_SESSION['name'] = 'Tom'; 
```

在 email.php 中：

```
session_start();

if(isset($_SESSION['id']))
{
    echo $_SESSION['id']; // echoes 1

    // do something
}

if(isset($_SESSION['provider']))
{
    echo $_SESSION['provider']; // echoes twitter

    // do something
}

if(isset($_SESSION['name']))
{
    echo $_SESSION['name']; // echoes name

    // do something
} 
```

# backbone.js - BackboneJS + RequireJS 允许视图使用全局事件调度器对集合进行操作

> ID：14076390
> 
> 赞同：0
> 
> 时间：2012-12-28T22:03:50.317
> 
> 标签：backbone.js, coffeescript, requirejs, backbone-events

更新：问题解决，案件结案。

* * *

我仍然无法让我的一部分代码工作。

我的视图现在监听集合以获取更新，应该发生的是：

*   ListView 监听结果集合
*   结果已同步
*   ListView 为每个 Result 创建一个 ItemView
*   ListView (ul) 附加每个 ItemView (li)

一切似乎都很好，直到最后一步。

ListView 中应该将结果添加到列表的函数无权访问 ListView 的元素。

我可以创建一个 ItemView，并检索它的元素“ ”，但不能在函数中引用`<li>`ListView 的“ ”。`<ul>`

ListView 中的示例代码位：

```
el: $('.result-list'),

initialize: function() {
   this.listenTo(this.collection, 'add', this.addOne);
},

addOne: function(result) {
   view = new ItemView({ model: result });
   this.$el.append(view.render().el);
}, 
```

在上面的代码中，变量 view 存在，它的元素也存在，但是“this”不再引用 ListView。

* * *

**下面的问题解决了**

我想要完成的是让视图模块（搜索）能够触发集合（结果）中的事件。

当 Search View 被提交时，它应该将输入字段传递给 Collection 的 fetch 方法以从服务器检索结果。目前，我可以从 View 触发一个函数，但该函数无法访问 Collection 的任何方法。

以前，我让 View/Collection 通过它们的变量名直接相互引用。
由于我已将代码分成模块，因此视图/集合无法再直接相互访问。

这是一些代码：（用Coffeescript编写）

**app.coffee** - global_dispatcher 应用于 Backbone

```
define [
    'jquery'
    'underscore'
    'backbone'
    'cs!router'
], ($, _, Backbone, Router) ->
    # global_dispatcher added to all Backbone Collection, Model, View and Router classes
    dispatcher = _.extend {}, Backbone.Events, cid: 'dispatcher'
    _.each [ Backbone.Collection::, Backbone.Model::, Backbone.View::, Backbone.Router:: ], (proto) ->
        _.extend proto, global_dispatcher: dispatcher

    new Router() 
```

**router.coffee** - 这是我遇到麻烦的地方。'getResults' 的函数已触发，但无法从此处访问集合 'results'。

```
define [
    'backbone'
    'cs!views/resuls/list'
    'cs!views/results/search'
    'cs!collections/results'
], (Backbone, ListView, SearchView, Results) ->
    Backbone.Router.extend
        routes:
            # URL routes
            '': 'index'

        index: ->
            results = new Results
            new ListView { model: results }
            new SearchView

            @global_dispatcher.bind 'getResults', (data) ->
                console.log results 
```

**search.coffee** - 查看哪个触发了事件，它将成功触发事件并传递正确的参数。

```
define [
    'jquery'
    'backbone'
], ($, Backbone) ->
    Backbone.View.extend
        events:
            'submit #search-form': 'submit'

        submit: (evt) ->
            evt.preventDefault()

            phrase = @.$('input').val()
            @.$('input').val('')

            args = name: phrase

            @global_dispatcher.trigger 'getResults', args 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T00:48:23.893

如果我正确理解了您的问题，则不难解决。这里有一些虚拟代码来说明：

```
var Results = Backbone.Collection.extend();
var Search = Backbone.View.extend({
    someEventHandler: function() {
        // The next line accesses the collection from the view
        this.collection.fetch();
    }
});
var results = new Results();
var search = new Search({collection: results}); 
```

如果您希望您的视图在结果返回后执行某些操作，只需在集合上绑定一个事件处理程序：

```
var Search = Backbone.View.extend({
    fetchResposne: function() { /* do something*/},
    someEventHandler: function() {
        // The next line accesses the collection from the view
        this.collection.on('sync', this.fetchResponse);
        this.collection.fetch();
    }
}); 
```

# php - laravel 模型和表命名下划线

> ID：14076392
> 
> 赞同：0
> 
> 时间：2012-12-28T22:04:04.677
> 
> 标签：php, laravel

我正在尝试创建名为`CustomDataStore`( `models/custom_data_store.php`) 的模型，它正在扩展 Eloquent，因此表被命名为`custom_data_stores`，但它给了我错误。

Eloquent 想要名为`customdatastores`. 当然我可以手动设置表名，但是如何自动设置这样的名称呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:09:32.810

要自动制作它，您的模型必须在`models/custom/data/store.php`

```
class Custom_Data_Store extends Eloquent
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-23T05:56:46.360

我注意到，如果模型的文件名上有下划线，laravel 的 eloquent 并不能真正“看到”。我不太确定里面发生了什么（仍然是新手），但这只是基于我的观察..

我所做的是

我有两个不同的模型，名为`tblReport_date.php`和`tblReportdate.php`，它们都有相同的代码，只是它们指向不同的表。

`tblReportdate.php`代码：

```
<?php

use Illuminate\Auth\UserInterface;
use Illuminate\Auth\Reminders\RemindableInterface;

class tblReportdate extends Eloquent implements UserInterface, RemindableInterface
{
    /**
 * The database table used by the model.
 *
 * @var string
 */
protected $table = 'tblClients';

    ...rest of the codes... 
```

`tblReport_date.php`代码：

```
<?php

use Illuminate\Auth\UserInterface;
use Illuminate\Auth\Reminders\RemindableInterface;

class tblReportdate extends Eloquent implements UserInterface, RemindableInterface
{
    /**
 * The database table used by the model.
 *
 * @var string
 */
protected $table = 'tblReport_date';

    ...rest of the codes... 
```

在控制器上，我有这个代码

```
$db = tblReportdate::all();
return View::make('db.index')->with('db', $db); 
```

结果是它只会加载`tblReportdate.php`而不是`tblReport_date.php`

我尝试`tblReport_date.php`单独提取并对其进行测试..它总是返回错误，无论类名如何等等..以及 IDK 为什么。如果有人可以解释这一点，请将其注释掉。无论如何，请避免在文件名上加下划线 XD

# ruby-on-rails - 重载 ActiveSupport::Concern 中的方法

> ID：14076393
> 
> 赞同：8
> 
> 时间：2012-12-28T22:04:06.287
> 
> 标签：ruby-on-rails, ruby, overloading, activesupport

我怎么会有这样的担忧：

```
module Concerns
  module MyConcern
    extend ActiveSupport::Concern
    ...
    def my_concern_magic(arg0,arg1)
      #exciting stuff here
    end
  end 
end 
```

包含在超载的模型中`my_concern_magic`？例如

```
class User
  include Concerns::MyConcern
  ...
  def my_concern_magic(arg0)
    arg1 = [1,2,3]
    my_concern_magic(arg0,arg1)
  end
end 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-28T22:27:02.267

由于包含一个模块会将其插入祖先链中，因此您可以调用`super`：

```
class User
  include Concerns::MyConcern

  def my_concern_magic(arg0)
    arg1 = [1, 2, 3]
    super(arg0, arg1)
  end
end 
```

# android - MonoGame 错误中的新 Android 项目

> ID：14076396
> 
> 赞同：0
> 
> 时间：2012-12-28T22:04:19.463
> 
> 标签：android, visual-studio-2010, monogame

我刚刚安装了 MonoGame 3.0 Beta，我想我会尝试在其中创建一个新的 android 项目，并收到以下错误消息： ![在此处输入图像描述](../Images/ddc70edac8b6e68d842cc5998a4f43c6.png)

我实际上找不到解决方法。

有没有人对它有更深入的了解？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T01:42:05.820

在尝试创建 MonoGame Android 项目之前，您是否安装了 Mono for Android ( [http://android.xamarin.com/ )？](http://android.xamarin.com/)如果您没有安装上述编译器，那么从逻辑上讲，它不允许您创建该类型的项目。我希望这有帮助。

# javascript - XAMPP、Mac OS X 和链接文件

> ID：14076398
> 
> 赞同：0
> 
> 时间：2012-12-28T22:04:44.093
> 
> 标签：javascript, html, macos, xampp

我确信这个问题的答案是显而易见的，但是：我在 Mac OSX 上使用 Aptana Studio 3 和 XAMPP。有人给我发了一个网络应用程序，所以我可以加载它，但我遇到了以下问题：

1) 虽然 XAMPP 介绍页面使用端口 80 仅使用“localhost”加载正常，但我所有其他项目将仅使用 127.0.0.1:8020 加载

2) Web 应用程序中链接的 JS & CSS 是这样写的：

```
<script src="/js/controllers.js"></script> 
```

但我得到 404；为了让 Apache 找到它，我需要删除第一个 '/' 所以它看起来像这样：

```
<script src="js/controllers.js"></script> 
```

我想了解这里发生了什么，因为我不能（如果我做得正确，我不应该这样做）删除链接文件的所有开头的“/”。

顺便说一句，我已将服务器配置设置为使用基本 URL 并附加项目名称。唯一有效的是当我使用 127.0.0.1:8020 时。我从来没有在我的 Windows 机器上发生过这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T23:20:38.397

稍作休息后，我发现我的问题主要是因为我不习惯在 Mac 上工作，而且有点马虎。

我将 XAMPP 从应用程序中移到了文档中，同时仍然在应用程序中留下了 XAMPP 的副本，这是我遇到麻烦的根本原因。Mac 的工作方式（我猜），XAMPP 永远不会在应用程序之外工作，但在这两个地方都有一个副本只会让我的问题更加复杂。

我可能会做的是将 htdocs 移动到 Documents 中，同时将主 XAMPP 文件夹留在 Applications 中，确保在适当的 conf 文件中更改 Apache 的文档根目录。

关于外部文件的绝对文件路径和相对文件路径，解决方案是在 Aptana 中为 Web 应用程序创建另一个工作区。再一次，Mac OSX 不想合作：在 Windows 中，您可以启动多个 Eclipse/Aptana 实例来访问不同的工作区。Mac 并非如此，这在过去 6 年或更长时间里一直是个问题。幸运的是，有人创建了一个插件，可以很好地解决这个问题，可以在这里找到：http: [//bit.ly/MCPjQP](http://bit.ly/MCPjQP) Works in both Eclipse and Aptana Studio 3

我希望其他人可以从这篇文章中受益。

# python - 下载器中间件忽略对scrapy中某个URL的所有请求

> ID：14076399
> 
> 赞同：3
> 
> 时间：2012-12-28T22:04:51.700
> 
> 标签：python, screen-scraping, scrapy

我正在尝试在 Scrapy 中定义一个自定义下载器中间件，以忽略对特定 URL 的所有请求（这些请求是从其他 URL 重定向的，因此当我首先生成请求时无法将它们过滤掉）。

我有以下代码，其想法是在响应处理阶段捕获它（因为我不确定重定向到其他请求的请求是如何工作的），检查 URL，如果它与我正在尝试的匹配过滤掉然后返回一个 IgnoreRequest 异常，如果没有，则照常返回响应，以便它可以继续处理。

```
from scrapy.exceptions import IgnoreRequest
from scrapy import log

class CustomDownloaderMiddleware:

    def process_response(request, response, spider):
        log.msg("In Middleware " + response.url, level=log.WARNING)
        if response.url == "http://www.achurchnearyou.com//":
            return IgnoreRequest()
        else:
            return response 
```

我将其添加到中间件的字典中：

```
DOWNLOADER_MIDDLEWARES = {
    'acny.middlewares.CustomDownloaderMiddleware': 650
} 
```

值为 650，我认为应该让它直接在 RedirectMiddleware 之后运行。

但是，当我运行爬虫时，我收到一条错误消息：

```
ERROR: Error downloading <GET http://www.achurchnearyou.com/venue.php?V=00001>: process_response() got multiple values for keyword argument 'request' 
```

这个错误发生在抓取的第一页上，我无法弄清楚它为什么会发生 - 我想我已经按照手册所说的去做了。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T00:01:15.087

我找到了解决我自己问题的方法——在 Python 中创建类和方法是一个愚蠢的错误。上面的代码需要是：

```
from scrapy.exceptions import IgnoreRequest
from scrapy import log

class CustomDownloaderMiddleware(object):

   def process_response(self, request, response, spider):
       log.msg("In Middleware " + response.url, level=log.WARNING)
       if response.url == "http://www.achurchnearyou.com//":
           raise IgnoreRequest()
       else:
           return response 
```

即方法需要有一个`self`参数作为第一个参数，并且类需要继承自`object`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-23T10:00:50.563

如果您知道哪些请求被重定向到有问题的请求，例如：

```
def parse_requests(self, response):
    ....
    meta = {'handle_httpstatus_list': [301, 302]}
    callback = 'process_redirects'
    yield Request(url, callback=callback, meta=meta, ...)

def process_redirects(self, response):
    url = response.headers['location']
    if url is no good:
        return
    else:
        ... 
```

这样您就可以避免下载无用的响应。

而且您始终可以定义自己的自定义重定向中间件。

# php - 来自 PHP 的 Redis 连接缓慢

> ID：14076403
> 
> 赞同：1
> 
> 时间：2012-12-28T22:05:25.747
> 
> 标签：php, windows, redis, xampp

我刚开始在我的应用程序中使用 Redis，但由于某种原因，从 PHP 到 Redis 服务器的初始连接几乎需要 1 秒。使用 Predis 时，延迟问题在第一次调用之前不会发生`get()`，如果我尝试手动连接，延迟会发生在初始连接上，通过`fsockopen()`.

我已阅读[redis 延迟文档](http://redis.io/topics/latency)，但这些信息似乎与我的情况无关。跑步`redis-cli --latency`似乎只会产生乱码。我想我的问题是解决此问题的最佳方法是什么？任何帮助将非常感激。

**Predis 客户端实例化：**

```
$redis = new Predis\Client(array(
    'host'     => 'localhost',
    'port'     => 6379
)); 
```

**以下是一些相关信息：**

*   PHP 5.4.7
*   XAMPP
*   Windows 7 64 位
*   16GB 内存
*   redis服务器在本地6379端口运行

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-28T22:26:20.363

在 Windows 上总是使用`127.0.0.1`而不是 localhost。

在最近版本的 Windows 中，名称`localhost`解析是在 DNS 本身内处理的（它是帮助合并 IPv6 的“功能”），并且这个 dns 查询总是需要 1 秒。

# mysql - 将 mysql 数据库从一台主机迁移到另一台主机，编码问题

> ID：14076407
> 
> 赞同：0
> 
> 时间：2012-12-28T22:05:41.417
> 
> 标签：mysql, character-encoding

我正在将大量 mysql 数据库从几个共享的 web 主机迁移到一个共享的 web 主机。

其中大部分是葡萄牙语，所以有很多特殊字符。我正在迁移的一些数据库是 latin1，一些是 cp1251，一些是 utf8。

当然，简单地转储数据库，然后将转储恢复到新主机上会完全搞砸编码和“？” 字符和其他废话出现在与数据库相关的实际网站中。

在小范围内，可以接受 html 字符集标签，知道要转储/恢复为什么，但问题是我们正在处理数千个数据库和网站，并且迁移都是通过自动完成的几个脚本。

我正在寻找有关转储/恢复这些数据库的最佳方式的建议，假设执行工作的脚本**将不知道 HTML 标记中指定的编码**。

到目前为止，我已经尝试使用实际的 mysqldump 工具，以及使用 php 脚本模仿它，并从内存中转储而不是从文本文件中转储，这些似乎都不能完美地将数据从一个复制到其他没有编码问题。

我是否应该使用 UTF8 对转储进行编码，然后不管 html 代码页如何恢复原样？无论 HTML 代码页如何，都以 UTF8 转储和恢复？在每个 create table 语句中找到的默认字符集中转储和恢复？

我对这些不同场景的影响和影响的理解是有限的，但我需要知道的基本上是**是否有一种方法可以完美地复制数据而不会在 2 个数据库服务器之间出现编码问题，而无需知道脚本的 HTML 使用的代码页正在访问数据。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:49:53.983

编码是一个非常难以解决的问题，尤其是在移动数据库时。首先尝试进行结构导入，然后将新结构与旧结构进行精确比较，特别注意数据库字符集、表默认字符集和列字符集。您可以从 information_schema 数据库中轻松获取这些信息。

一旦完全镜像，您就可以开始导入了。但是，请注意您可以在不同编码列中保存不同编码类型的字符（在 latin1 列中有 utf8 有效字符是很常见的，latin 1 是 1 字节字符集，而 utf8 可以有 up到 3 个字节）。

您可以在此之后尝试各种方法来转换转储，但据我所知，到目前为止，还没有一种 100% 有效的方法可以在同一列中转换这种混合编码类型的情况。最终，您可能需要进行一些手动清理。但希望第一种方法就足够了，一切都会好起来的。

# openerp - 如何修改支票打印报告以包含供应商的发票编号？

> ID：14076413
> 
> 赞同：1
> 
> 时间：2012-12-28T22:06:52.043
> 
> 标签：openerp

当我收到供应商的发票时，我在供应商发票的“原始凭证”字段中输入发票编号（来自供应商）。现在，当我打印支票（使用 account_check_writing）时，它包括 OpenERP 为我的供应商发票记录生成的供应商发票编号（例如，EXJ/2012/01283），但它不包括供应商的发票编号。这使得供应商很难在他们的记录中找到正确的发票来应用付款。

我掌握了如何修改报告的一般方法，但我不确定将评估供应商发票编号的表达式。我可以按照数据库中的外键约束来查看 account_voucher_line -> account_move_line -> account_move <- account_invoice，并且可以在报告中找到与当前凭证行关联的 account.move 与“l.move_line_id.move_id”。但是现在我如何找到也引用该 move_id 的发票，以便从中获取“源文档”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T03:27:02.567

我们已经做到了（改进了支票书写报告），而且考虑到我们也改进了支票的批量打印向导。您可以获取以下分支并将其应用到 OpenERP 7 之上： [https ://code.launchpad.net/~openerp-dev/openobject-addons/trunk-account_check_writing_jam](https://code.launchpad.net/~openerp-dev/openobject-addons/trunk-account_check_writing_jam)

[或者，您可以在http://runbot.openerp.com](http://runbot.openerp.com)上即时试用，找到分支，构建它，然后使用 admin/admin 连接到它。

简而言之，改进是：

*   显示供应商/供应商的发票编号
*   可选地溢出到多个页面。您可以支付超过 10 个发票行。
*   可以选择显示与此检查一起应用的信用。
*   禁止不属于此支票付款的发票。
*   可选择是否使用预先打印的支票号码。
*   如果需要，可以选择在批量打印期间重置检查顺序。
*   如果需要，可选择在批量打印期间覆盖支票号码。
*   适用于标准美国支票（顶部、中间或底部窗格）。

选项位于以下位置：

*   在公司 > 公司 > 配置选项卡中
*   在会计 > 配置 > 日记帐 > 日记帐 > 高级设置选项卡中
*   在会计 > 供应商 > 写支票 > 打印按钮 > 批量打印向导

我们希望尽快将其合并到核心中。
欢迎反馈。

享受吧，
__
Fabrice
OpenERP US

# wordpress - 如何使用 get_posts 通过 JSON 发送标题和永久链接

> ID：14076417
> 
> 赞同：0
> 
> 时间：2012-12-28T22:07:12.217
> 
> 标签：wordpress

这是我打印出来的。

```
$args = array(
'category' => 'Animation',
'numberposts' => 8
);
$posts_array = get_posts( $args );
echo json_encode($posts_array); 
```

结果如下：（有 8 个像这样相同的 JSON 列表，为方便起见仅显示 1 个。）

{"ID":554,"post_author":"1","post_date":"2012-12-28 19:17:43","post_date_gmt":"2012-12-28 19:17:43"," post_content":"太空竞赛已经开始。随着各国的竞争，我们关注被招募到太空计划中的一只黑猩猩的进展。他的结果可能会证明对全人类的更好的影响。......他会站起来吗对于挑战","post_title":"Alpha","post_excerpt":"","post_status":"publish","comment_status":"open","ping_status":"open","post_password":"" ,"post_name":"alpha","to_ping":"","pinged":"","post_modified":"2012-12-28 19:17:43","post_modified_gmt":"2012-12-28 19:17:43","post_content_filtered":"","post_parent":0,"guid":"http://localhost/Wordpress%203.4.2/?p= 554","menu_order":0,"post_type":"post","post_mime_type":"","comment_count":"0","filter":"raw"

但我只想发送 id 和 post_content。我不断得到空值，无法弄清楚为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:21:07.917

只需按您需要的字段过滤：（`id and the post_content`或`title and permalink`）

```
$args = array(
    'category'       => 'Animation',
    'numberposts'    => 8
);

$posts_array = get_posts($args);

$send_array = array();
foreach ($posts_array as $key => $value)
{
    $send_array[$key]["ID"]          = $value->ID;
    $send_array[$key]["post_content"]    = $value->post_content;
}

echo json_encode($send_array);
exit; 
```

# javascript - 如何在Firefox中逐行获取javascript跟踪？

> ID：14076421
> 
> 赞同：1
> 
> 时间：2012-12-28T22:08:31.177
> 
> 标签：javascript, firefox, firebug

我正在尝试调试一个冗长的脚本，该脚本在执行开始后的一段时间内崩溃了。在 firebug 中逐步调试它是一场噩梦。

FlowTrace 很好地向我展示了函数调用，但是在脚本上逐行执行信息将是无效的。

有什么方法可以在 firebug 中或使用 firefoxes api 收集（和存储）这些信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:58:28.193

您可以使用断点，然后使用 chrome 或 firefox 中的 firebug 逐步跟踪它......它很容易并且减少了分配的工作量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T12:06:06.910

这是一个愚蠢的解决方案，但我使用 alert(); 在火狐中，当我必须在火狐中调试 javascript 时。:D

# javascript - 在 for 循环中创建关联数组

> ID：14076429
> 
> 赞同：0
> 
> 时间：2012-12-28T22:09:28.887
> 
> 标签：javascript, xml, for-loop, multidimensional-array, associative-array

我有一个很大的 xml 文档，我正在尝试将其处理成 javascript 中的数组。

> ```
> <DR>
>    <C>
>      <SWDGDRC>
>        <CID>0</CID>
>        <V>06/01/2012 00:00:00</V>
>      </SWDGDRC>
>      <SWDGDRC>
>        <CID>1</CID>
>        <V>1131</V>
>      </SWDGDRC>
>      <SWDGDRC>
>        <CID>2</CID>
>        <V>28800</V>
>      </SWDGDRC>
>    </C>
>    <rowid>0</rowid>
> </DR>
> <DR>
>    <C>
>      <SWDGDRC>
>        <CID>0</CID>
>        <V>06/02/2012 00:00:00</V>
>      </SWDGDRC>
>      <SWDGDRC>
>        <CID>1</CID>
>        <V />
>      </SWDGDRC>
>      <SWDGDRC>
>        <CID>2</CID>
>        <V />
>      </SWDGDRC>
>    </C>
>    <rowid>1000</rowid> 
> ```

它由多个 DR(datarow) 组成，每个 DR 有多个 C(columns) 和一个 rowid。我正在尝试将所有这些数据循环到一个关联数组中：

```
 for(var i=0; i < DR.length; i++) {          // loop DR
        for(var j=0; j < DR[i].getElementsByTagName('C').length; j++) {    // loop C
            for(var k=0; k < DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC').length; k++) {   //loop SWDGDRC
                columnData[i] = {
                    "rowid": DR[i].getElementsByTagName('rowid')[0].textContent,
                    "column": {
                       columnID: DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC')[k].getElementsByTagName('CID')[0].textContent,
                       value:DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC')[k].getElementsByTagName('V')[0].textContent
                    }
               };
            }
        }
    } 
```

问题是我想在“列”键中创建一个新数组，该数组循环所有 C（列）数据，以便我可以使用以下内容访问这些数据： columnData[0]['column'][0]['列ID']

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:42:20.157

DRCollection[] -> DRCollection[0] = row_id，DRCollection[1] = colCollection[]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:22:28.977

```
for(var i=0; i < DR.length; i++) {          // loop DR
        for(var j=0; j < DR[i].getElementsByTagName('C').length; j++) {    // loop C
            columnData[i] = new Array(DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC').length);
            columnData[i] = {
                rowid: DR[i].getElementsByTagName('rowid')[0].textContent
            }
            for(var k=0; k < DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC').length; k++) {   //loop SWDGDRC
                columnData[i][k] = {
                    columnID: DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC')[k].getElementsByTagName('CID')[0].textContent,
                    value:DR[i].getElementsByTagName('C')[j].getElementsByTagName('SWDGDRC')[k].getElementsByTagName('V')[0].textContent
                };
            }
        }
    } 
```

使用前面的代码修复它。首先，我使用要循环的数组长度创建一个新数组，然后设置“rowid”字段。这样我可以通过以下方式访问我的数据： columnData[0][0]['columnID']

# javascript - JavaScript 网络应用程序

> ID：14076435
> 
> 赞同：0
> 
> 时间：2012-12-28T22:10:15.153
> 
> 标签：javascript, node.js, backbone.js, web

我使用 MVC 框架使用 Ruby on Rails 构建了一个测验应用程序。我想用纯 JavaScript 做基本相同的事情，并使用 jQuery 为移动设备和特殊效果添加更多功能，因为 jQuery 就是这样很棒。

我在[TodoMVC 之](http://todomvc.com/)类的网站上查看了有关框架的比较，但我不知道这些框架的功能。为什么他们使用`Collection`而不是`Controller`在他们的 MVC 定义中？在我看来，这些只是客户端框架。我会使用 Backbone.js 之类的东西来进行客户端工作，而 Node.js 用于服务器端吗？

我只是不确定如何使用纯 JavaScript 函数进行开发。我需要创建一个数据库来存储测验和用户信息，并且能够在查看大多数页面时访问该数据库，所以我觉得 MVC 框架是最好的方法。

关于从哪里开始有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:24:52.740

如果您正在寻找类似 JavaScript MVC 的框架，请查看 Express.js [http://expressjs.com](http://expressjs.com)

Express.js 更像 Sinatra 而不是 Rails，但它会为您在服务器端打下良好的基础。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:37:20.127

哇，这是一个相当广泛的帖子；让我们一次处理一件事情

> 为什么他们在 MVC 定义中使用 Collection 而不是 Controller？

确切的答案因库而异，但一个简单的答案是大多数 Javascript 应用程序中的控制器并不真正需要任何框架。它们可以是原始的 Javascript 并且工作得很好，因为它们通常不是很复杂。

此外，您可能认为是“控制器”的部分通常是单独提供的。主要的例子是 Backbone 的 Router 对象：它类似于 Rails 中的隐含路由（和 routes.rb），或 Django 中的 urls.py。正如那些框架不认为路由是“控制器”的一部分一样，Backbone（和类似的框架）将路由作为一个单独的部分提供......即使它可能属于 MVC 中的 C 语言。

类似地，jQuery 提供的大部分 DOM 操作功能通常属于 MVC 应用程序的控制器，因此从某种意义上说，jQuery 可以帮助您构建控制器；Backbone.Model 帮助您构建模型的方式并不明确。

> 我会使用 Backbone.js 之类的东西来进行客户端工作，而 Node.js 用于服务器端吗？

那真的是苹果和橘子；用服务器端的术语来说，Backbone 更像 Rails，而 Node 更像 Ruby（或 Mongrel 之类的）。所以是的，一个是客户端，另一个是服务器端，但差异远不止于此。

> 关于从哪里开始有什么建议吗？

选择一个框架，让你的手变脏！说真的，你可以花几个小时阅读不同框架的评论，但最终还是比开始时更接近于做出决定（我是根据经验说话）。但是，如果您只是选择一个并尝试它，您可能会发现它要么与您“凝胶”，要么不会很快。

就个人而言，我建议从 Backbone 开始，因为 A）它现在非常流行，并且 B）我有偏见：我每天都使用它并且喜欢它。此外，它可能很适合您，因为它是由 CoffeeScript 人创建的（CoffeeScript 是他试图使 Javascript 更像 Ruby）。然而，Ember.js 最近也很流行，Hector 提到了 ExpressJS，我对此一无所知，但可能很酷。

但关键是，选择一个，打个招呼，或者更复杂一点的东西，比如介绍性教程（Backbone 有一个围绕 To Do 应用程序的教程）。用它编写几个小时的代码会比我（或 Stack Overflow 上的任何其他人）更能告诉你它是否适合你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T00:12:29.580

我肯定会看看[Google Closure](https://developers.google.com/closure/)。我已经开始在个人宠物项目中将它与[LimeJs](http://www.limejs.com/)一起使用，并且真的被它的 [编译器](https://developers.google.com/closure/compiler/)和模块化设计所吸引。

它不是*真正*的MVC，但由于 JavaScript 应该更多地以异步方式来考虑，我倾向于将其更多地视为事件驱动，而不是简单的请求-管道-响应方式。

因此，客户端的[闭包库](https://developers.google.com/closure/library/)和[jQuery](http://jquery.com/) / [jQuery UI](http://jqueryui.com/)（都在[Google API](https://developers.google.com/speed/libraries/devguide)上）和服务器端的[ExpressJs](http://expressjs.com/)。另外，看看这个[框架对比图](http://vschart.com/compare/railwayjs/vs/tower-js/vs/flatiron/vs/ruby-on-rails)，你可能会觉得很有趣。

# php - PHP多文件上传只上传第一张图片

> ID：14076436
> 
> 赞同：1
> 
> 时间：2012-12-28T22:10:16.573
> 
> 标签：php, upload

我正在使用以下文件输入的多个实例上传图像：

```
<input type="file" name="photos[]"> 
```

我已经设置了这样的表单属性：

```
<form action="?action=form" method="post" class="nice" enctype="multipart/form-data"> 
```

当我遍历文件数组时，我可以打印出多个文件名。

但是，一旦我尝试上传文件，它只会上传数组中的第一个文件。

这是我的PHP：

```
$uploadDir = '/uploads/';

$getCurrentTimeStamp = date('m-d-Y_h.i.s', time());

// Set the allowed file extensions
$fileTypes = array('jpg', 'jpeg', 'png', 'gif'); // Allowed file extensions

$theIds = $_POST["id"];

function findexts ($filename) 
 { 
 $filename = strtolower($filename) ; 
 $exts = split("[/\\.]", $filename) ; 
 $n = count($exts)-1; 
 $exts = $exts[$n]; 
 return $exts; 
 } 

 //This applies the function to our file  

 $fileCount = 1;
foreach ($_FILES["photos"]["error"] as $key => $error) {
    if ($error == UPLOAD_ERR_OK) {

 $ext = findexts ($_FILES['photos']['name'][$key]) ; 

if (!empty($_FILES)) {
    $tempFile   = $_FILES['photos']['tmp_name'][$key];
    $uploadDir  = $_SERVER['DOCUMENT_ROOT'] . $uploadDir;

    $targetFile = $uploadDir . "equipment_photo_" .$theIds . "_".$fileCount."_". $getCurrentTimeStamp."." .$ext;
    $theFileNameToStore = "equipment_photo_" .$theIds . "_".$fileCount."_". $getCurrentTimeStamp."." .$ext;

    // Validate the filetype
    $fileParts = pathinfo($_FILES['photos']['name'][$key]);

    if (in_array(strtolower($fileParts['extension']), $fileTypes)) {

        // Save the file
        move_uploaded_file($tempFile,$targetFile);

        echo $theFileNameToStore;

    } else {

        // The file type wasn't allowed
        echo 'Invalid file type.';

    }
}

        }

        $fileCount ++;

} 
```

任何想法为什么多个图像会回显但文件不会上传？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:45:13.713

为了让您的生活更轻松，我建议您使用此功能重新排序`$_FILES`全局

```
function rotate_array($source_array, $keep_keys = TRUE)
{
  $new_array = array();

  foreach ($source_array as $key => $value)
  {
     $value = ($keep_keys === TRUE) ? $value : array_values($value);
     foreach ($value as $k => $v)
     {
        $new_array[$k][$key] = $v;
     }
  }

  return $new_array;
} 
```

然后在您的代码中使用它：

```
$fileCount = 1;
$files = rotate_array($_FILES['photos']);

foreach ($files as $file) {
  if (is_uploaded_file($file['tmp_name'])) {
    $ext = findexts($file['name']); 

    $tempFile   = $file['tmp_name'];
    $uploadDir  = $_SERVER['DOCUMENT_ROOT'] . $uploadDir;

    $theFileNameToStore = "equipment_photo_" .$theIds . "_".$fileCount."_". $getCurrentTimeStamp."." .$ext;
    $targetFile = $uploadDir . $theFileNameToStore;

    // Validate the filetype
    $fileParts = pathinfo($file['name']);

    if (in_array(strtolower($fileParts['extension']), $fileTypes)) {
      // Save the file
      //move_uploaded_file($tempFile,$targetFile);
      // Sometimes move won't work for unknown reasons, try copying, this should work
      copy($tempFile, $targetFile);

      echo $theFileNameToStore;
    } else {
      // The file type wasn't allowed 
      echo 'Invalid file type.';
    }
  }
  $fileCount ++;
} 
```

确保您为和显示正确的`phpinfo()`值。在您的代码上或在您的 php.ini 文件中进行更改`max_file_uploads``upload_max_filesize``post_max_size`

# iphone - ios：模拟触摸：尝试私有框架时出错

> ID：14076440
> 
> 赞同：1
> 
> 时间：2012-12-28T22:10:34.977
> 
> 标签：iphone, ios

我正在尝试在 iOS 中模拟触摸。SO中有一些指针表明我可以在私有框架中尝试GraphicsServices/GSEvent.h。但是，当我按照[此处](https://stackoverflow.com/questions/11771948/add-graphicsservices-private-framework-into-ios)的步骤操作时，出现以下错误：

```
 Undefined symbols for architecture armv7:
    "_GSCopyPurpleNamedPort", referenced from:
    -[TestGraphicsServicesAppDelegate application:didFinishLaunchingWithOptions:] in TestGraphicsServicesAppDelegate.o
    "_GSSendEvent", referenced from:
    -[TestGraphicsServicesAppDelegate application:didFinishLaunchingWithOptions:] in TestGraphicsServicesAppDelegate.o
    ld: symbol(s) not found for architecture armv7
    clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有什么建议吗？谢谢

编辑：我使用的代码来自[Using GraphicsServices.h/GSEvent 以及使用 Xcode 编译 CLI iPhone 工具](https://stackoverflow.com/questions/3017367/using-graphicsservices-h-gsevent-as-well-as-compiling-cli-iphone-tools-with-xcod)。

看起来错误来自这一行。

```
 mach_port_t thePortOfApp = GSCopyPurpleNamedPort...
    GSSendEvent(&record, thePortOfApp); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T20:05:36.263

好的，我想我在添加框架时犯了一些错误。不知何故，我的项目现在开始工作了。

在我做了几件事后，错误就消失了。在**Build Setting**中，我将 Always **Search User Paths**更改为**Yes**。**在User Header Search Paths**中添加了私有头的路径。此外，在**Build Phrases 选项卡中，我在****Link Binary with Libraries**部分添加了 GraphicsServices 。

现在我可以做一些简单的事情，比如 GSEventLockDevice() 和模拟按下主页按钮。仍然对触摸一无所知。

# vb.net - LINQ 查询未正确分组

> ID：14076442
> 
> 赞同：0
> 
> 时间：2012-12-28T22:10:42.740
> 
> 标签：vb.net, linq

我正在尝试提取一组在一组数据中多次出现的记录。我的问题是我的查询没有考虑到初始查询的分组，基本上是在提取所有记录。我有一个初始查询，它从数据表中提取数据，如下所示：

```
Dim eDTKBase = From eDTKData In dteDTK _
Select New With _
{ _
.eDTK_PDP_Code = eDTKData.Field(Of String)("PDP_CODE"), _`
.eDTK_PDP_Description = eDTKData.Field(Of String)("PDP_DESCRIPTION"), _
.eDTK_WB_Slave = eDTKData.Field(Of String)("WALLBOARD_OR_SLAVE"), _
.eDTK_Print_On_DAD = eDTKData.Field(Of String)("PRINT_ON_DAD"), _
.eDTK_PLI = eDTKData.Field(Of String)("COMPASS_PLI"), _
.eDTK_Dead = eDTKData.Field(Of String)("DEAD"), _
.eDTK_Instance = eDTKData.Field(Of String)("COUNTRY_INSTANCE") _
} 
```

然后，我尝试使用以下 LINQ 查询仅针对由 eDTK_PLI、eDTK_PDP_Code 字段分组的记录筛选其中 eDTK_PDP_Code 字段的计数大于 1 的记录：

```
Dim EDTKMultPDPtoPLI = From EDTK In eDTKBase _
Group By EDTK.eDTK_PLI, _
EDTK.eDTK_PDP_Code _
Into g = Group _
Where eDTK_PDP_Code.Count > 1 _
Select eDTK_PLI, _
eDTK_PDP_Code, _
eDTK_PDP_Code.Count 
```

问题是它正在评估数据表中的整个数据集，而不仅仅是分组记录。我在这里做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T20:01:11.217

我做了一些实验，我想我找到了解决方案。这是使用 AdventureWorks 的代码，但我认为它应该有意义。

```
from r in (
     from s in SalesOrderHeaders
     select s.SalesPersonID,s.CustomerID
     where SalesPersonID isnot nothing)
group r by key = new with {r.SalesPersonID,r.CustomerID} into group
where group.count > 1
select key.SalesPersonID, key.CustomerID, group.count() 
```

使用此结果，显示客户与给定销售人员下订单的次数。

```
RepID   CustID  Count
280     1       4
283     2       8
275     3       6
277     3       6
275     4       6
277     4       2
281     5       8 
```

截断余数

希望这可以帮助

韦德

# symfony - Twig 是否允许将关联数组用作 Flash 会话变量？

> ID：14076443
> 
> 赞同：2
> 
> 时间：2012-12-28T22:10:46.723
> 
> 标签：symfony, twig, silex

我正在使用 Silex，我想知道是否可以将关联数组用于闪存会话变量？我似乎无法让它工作。

这是我一直在尝试的：

**在我的应用程序文件中设置 flash var。**

```
$my_array = array('fruit' => 'apple', 'veggie' => 'carrot');
$app['session']->setFlash('myFlashVar', $my_array); 
```

**并像这样在 Twig 中使用。**

```
{% set myVar = app.session.getFlash('myFlashVar') %}
// And so that we don't get an error, check to see if the key exists
{% if 'fruit' in myVar|keys  %}{{ myVar['fruit'] }}{% endif %} 
```

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:47:10.793

`setFlash`和`getFlash`不推荐使用的方法，因此应该避免。

您可以使用 Session::getFlashBag 提供的常用方法来运行您的代码（双关语？）

PHP：

```
$my_array = array('fruit' => 'apple', 'veggie' => 'carrot');
$app['session']->getFlashBag()->set('myFlashVar', $my_array); 
```

枝条：

```
{% for flashMessage in app.session.flashbag.get('myFlashVar') %}

    {{ flashMessage }}

{% endfor %} 
```

免责声明：我只使用 Symfony2 (2.16) 框架进行了测试，而不是 Silex。在 Symfony2 中是：

```
$this->get('session')->getFlashBag()->set('myFlashVar', $my_array); 
```

# c - C程序，堆栈计算器

> ID：14076444
> 
> 赞同：-3
> 
> 时间：2012-12-28T22:10:55.683
> 
> 标签：c, stack, calculator

有人可以看看我下面的代码并帮助我。我已经尝试解决这个问题好几个小时了，但我不知道出了什么问题。这是一个用 C 语言编写的程序，它应该接受堆栈计算器的操作并存储数学表达式的操作数。执行操作时，堆栈上的最后两个值被删除并用作操作数，然后将操作结果放入堆栈。但是，我没有得到正确的数字。请看一下我的代码。我知道它很长，但我很感激。谢谢。

```
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <stdlib.h>
#define SIZE 10
#define MAXINPUT 255

void printStack(int stack[], int tos)
{
if (isEmpty(tos))
{
    printf("Stack is empty\n");
    printf("---------------------------------------\n");
    return;
}   

printf("Stack: ");
while (tos < SIZE)
{
    printf("[%d] " , stack[tos]);
    tos++;

}   
printf("\n---------------------------------------\n");

}   

int top (int stack[], int tos)
{
if(isEmpty(tos))
    return;
return stack [tos];
}

int isEmpty(int tos)
{

if (tos < 0)
    return 1;
}

int isFull (int tos)
{

if(tos >= SIZE - 1)
    return 1;

}   

void push(int val, int stack [], int *tos)
{
if(isFull(*tos))
    return;
(*tos)++;
stack[*tos] = val;

}

int pop (int stack [], int *tos)
{

if(isEmpty(*tos))
    return;
int val = stack[*tos];
(*tos)--;
return val;
}

void clear(int *tos)
{
*tos = -1;

}   

int getInput (char *input)
{

printf("+------------------------------{Choose an option}------------------------------+\n");
printf("| (q) : quit the program.                                                      |\n"
       "| (integer value) : an integer value (either positive or negative) to push     |\n"
       "| (c) : clear the stack                                                        |\n"
       "| (=) : display top value on the stack                                         |\n"
       "| (+) : addition                                                               |\n"
       "| (-) : subtraction                                                            |\n"
       "| (*) : multiplication                                                         |\n"
       "| (/) : division - integer division only                                       |\n"
       "| (%) : modulus - remainder from an integer division                           |\n"
       "| (^) : exponentiation (x raised to the power of y)                            |\n"
       "+------------------------------------------------------------------------------+\n");
printf("Input: ");
gets(input);
if(strcmp(input, "q") == 0)
{
    printf("Exiting...\n");
    return 0;
}
return 1;
}   

int isNum(char *input)
{
int i;
for(i = 0; i < strlen(input); i++)
{
    if(!isdigit(input[i]))
        return 0;
}   
return 1;

}   

int hasTwo(tos)
{
if((SIZE - tos) >= 2)
    return 1;

printf("\nStack size is 1, must have 2 or more\n");
return 0;
}
void mathOp (char op, int stack[], int *tos)
{
if(!isEmpty(*tos))
    return;
if(!hasTwo(*tos))
    return;

int right = pop(stack, tos);
int left = pop(stack, tos); 
switch(op)
{
    case '+': 
        push((left + right), stack, tos);
        break;
    case '-': 
        push((left - right), stack, tos);
        break;
    case '*': 
        push((left * right), stack, tos);
        break;
    case '/': 
        push((left/right), stack, tos);
        break;
    case '%': 
        push((left % right), stack, tos);
        break;
    case '^': 
        push(pow(left, right), stack, tos);
        break;
}       

}   

int main(int argc, char **argv)
{
int verbose = 0;
int debugMode = 0;
if (argc == 2 && argv[1][0] == '-' && argv[1][1] == 'd')
{   
    debugMode = 1;
    if (strcmp("-dv", argv[1]) == 0)
    {
        verbose = 1;
    }
}

int stack[SIZE];
int tos = -1;
char input[MAXINPUT];
while (getInput(input))
{
    int result = 0;
    if (strcmp(input, "c") == 0)
        clear(&tos);
    else if (strcmp(input, "=") == 0)
    {

        result = top(stack, tos);
        printf("Top of Stack is [%d]\n", result);
    }
    else if (isNum(input))
        push(atoi(input), stack, &tos);
    else if(strcmp(input, "+") == 0 ||
            strcmp(input, "-") == 0 ||
            strcmp(input, "*") == 0 ||
            strcmp(input, "/") == 0 ||          
            strcmp(input, "%") == 0 ||          
            strcmp(input, "^") == 0 ) mathOp(input[0], stack, &tos);
    else
        printf("Invalid input\n");

    if (debugMode)
        printStack(stack, tos);     
}

return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:15:53.313

你在这段代码中有很多问题。使用（或等效设置）进行编译`-Wall`以找到`isEmpty`and `isFull`and `top`and `pop`don't (always) 正确返回值。

每个需要返回某些东西的函数都必须以 return 语句结束。C 中没有某种“默认返回值”。

举个例子：

```
int isFull (int tos)
{
    if(tos >= SIZE - 1)
        return 1;

    return 0; // <-- not full, you probably want to return 0
} 
```

附言。您需要在帮助文本中使用`%%`文字`%`。

**编辑**以解决所有问题：

1.  `printStack`严重损坏，您需要循环 from `0`to `tos`，而不是 from `tos`to `SIZE`。

2.  `hasTwo`需要测试是否`tos>=1`。

3.  `mathOp`需要先测试`if(isEmpty(*tos))`，删除`!`上面说的不是“如果不是空的”。

然后它应该工作。

# javascript - 在Javascript中返回一个字符串

> ID：14076448
> 
> 赞同：12
> 
> 时间：2012-12-28T22:11:19.800
> 
> 标签：javascript, string, asp-classic, return

我正在尝试创建一个简单的函数，该函数将在调用时返回正确的字符串：

```
function getState(abbr){
   if (abbr=="WY")
   {
   return "Wyoming";
   }
} 
```

然后调用是这样的：

```
var stateName = getState("WY"); 
```

但是，所有返回的是：0

抱歉，如果我遗漏了一些明显的东西。

更新 - 我的原始问题是因为“&”这是我正在处理的真实代码：

```
function getState(abbr){
    var url = "states.asp"
    var state = ""; 
    $.get(url, function(data) {
        var i = 0;
        $.each($('state',data),function(index, el) {            
            if (abbr == ($(this).attr("abbr"))){
                //alert($(this).attr("abbr"));
                state = $(this).text();
            }//if (abbr == $(this).attr("abbr")){
        });//$.each($('state',data),function(index, el) {
    }).success(function() { 
        alert("x" + state);
        return state;
    }); //.success(function() { 
    //$.get(url, function(data) {
    alert("y" + state); 
    return state;
} 
```

由于我的电话，我得到“未定义”：

```
alert(getState("WY")); 
```

警报（“x”+状态）有效。

更新#2 --- 这是 states.asp 生成的所有内容（现在）......稍后它将返回公司等：

```
<?xml version="1.0" encoding="utf-8"?>
<STATELIST>
<STATE abbr="AL">Alabama</STATE>
<STATE abbr="AK">Alaska</STATE>
<STATE abbr="AZ">Arizona</STATE>
<STATE abbr="AR">Arkansas</STATE>
<STATE abbr="CA">California</STATE>
<STATE abbr="CO">Colorado</STATE>
<STATE abbr="CT">Connecticut</STATE>
<STATE abbr="DE">Delaware</STATE>
<STATE abbr="FL">Florida</STATE>
<STATE abbr="GA">Georgia</STATE>
<STATE abbr="HI">Hawaii</STATE>
<STATE abbr="ID">Idaho</STATE>
<STATE abbr="IL">Illinois</STATE>
<STATE abbr="IN">Indiana</STATE>
<STATE abbr="IA">Iowa</STATE>
<STATE abbr="KS">Kansas</STATE>
<STATE abbr="KY">Kentucky</STATE>
<STATE abbr="LA">Louisiana</STATE>
<STATE abbr="ME">Maine</STATE>
<STATE abbr="MD">Maryland</STATE>
<STATE abbr="MA">Massachusetts</STATE>
<STATE abbr="MI">Michigan</STATE>
<STATE abbr="MN">Minnesota</STATE>
<STATE abbr="MS">Mississippi</STATE>
<STATE abbr="MO">Missouri</STATE>
<STATE abbr="MT">Montana</STATE>
<STATE abbr="NE">Nebraska</STATE>
<STATE abbr="NV">Nevada</STATE>
<STATE abbr="NH">New Hampshire</STATE>
<STATE abbr="NJ">New Jersey</STATE>
<STATE abbr="NM">New Mexico</STATE>
<STATE abbr="NY">New York</STATE>
<STATE abbr="NC">North Carolina</STATE>
<STATE abbr="ND">North Dakota</STATE>
<STATE abbr="OH">Ohio</STATE>
<STATE abbr="OK">Oklahoma</STATE>
<STATE abbr="OR">Oregon</STATE>
<STATE abbr="PA">Pennsylvania</STATE>
<STATE abbr="RI">Rhode Island</STATE>
<STATE abbr="SC">South Carolina</STATE>
<STATE abbr="SD">South Dakota</STATE>
<STATE abbr="TN">Tennessee</STATE>
<STATE abbr="TX">Texas</STATE>
<STATE abbr="UT">Utah</STATE>
<STATE abbr="VT">Vermont</STATE>
<STATE abbr="VA">Virginia</STATE>
<STATE abbr="WA">Washington</STATE>
<STATE abbr="WV">West Virginia</STATE>
<STATE abbr="WI">Wisconsin</STATE>
<STATE abbr="WY">Wyoming</STATE>
</STATELIST> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T22:21:54.607

最简单的方法是进行散列 - 不需要函数。

```
var states = {
    'AL': 'Alabama',
    'AK': 'Alaska',
    'AZ': 'Arizona',
    'AR': 'Arkansas',
    'CA': 'California',
    'CO': 'Colorado',
    'CT': 'Connecticut',
    ...
    'WY': 'Wyoming'
};

var stateName = states["WY"]; 
```

## 编辑

现在我更好地理解`getState()`需要从服务器检索状态名称。这将带您进入异步编码的世界，这与正常的同步编码完全不同。

要意识到的最重要的事情是，`getState()`不能简单地为给定的州缩写返回州名。为什么？因为对服务器的 ajax 调用是*异步*的——换句话说`getState()`，在返回之前不会等待服务器的响应。

处理异步性基本上有两种方法：

*   传递回调函数`getState()`来告诉它在收到响应时要做什么
*   安排`getState()`返回一种称为“promise”的特殊类型的对象，它可以在`getState()`被调用的地方进行处理，这样它就会在服务器响应时响应。

下面的代码采用第二种方法。

```
var states = {};//cache of state names, with state abbreviations as keys
function getState(abbr) {
    var dfrd = $.Deferred();//A deferred object, whose promise will be returned.
    if(!states[abbr]) {
        $.ajax({
            url: "states.asp",
            dataType: 'XML',
            success: function(data) {
                //Load up the cache
                $.each($('state', data), function(i, el) {
                    states[el.attr('abbr')] = $(el).text();
                });
                //Now resolve or reject the deferred object depending in whether states[abbr] has been cached
                if(states[abbr]) {
                    dfrd.resolve(abbr, states[abbr]);//Success! Let's resolve the deferred object (and its promise).
                }
                else {
                    dfrd.reject(abbr, 'States successfully downloaded but ' + abbr + ' was not included');
                }
            },
            error: function() {
                dfrd.reject(abbr, 'Download of states failed');
            }
        });
    }
    else {
        //The state name is already cached
        //The deferred object (and its promise) can be resolved without needing to make another ajax call.
        dfrd.resolve(abbr, states[abbr]);
    }
    return dfrd.promise();
} 
```

*未经测试*

现在您只需要知道如何调用`getState()`.

```
getState("WY").done(function(abbr, state) {
    alert(abbr + ': ' + state);
    //other stuff here
}).fail(function(abbr, message) {
    alert(abbr + ': ' + message);
    //other stuff here
}); 
```

如您所见，您想要`getState()`返回的值现在显示为`.done()`函数的第二个参数。为了更好地衡量，缩写（“WY”）作为第一个参数出现。

如果你想处理错误情况（总是一个好主意），那么在`.fail()`回调中这样做。

有关一切如何工作的更多线索，请参见代码中的注释。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T22:13:21.830

您的代码中绝对没有任何问题。请参阅此[工作演示](http://jsfiddle.net/kw6aS/)。

```
function getState(abbr){
   if (abbr=="WY")
   {
   return "Wyoming";
   }
}
var stateName = getState("WY");
alert(stateName);
​ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T10:39:59.693

HTML：

```
<div id="msg">...</div> 
```

JS：

```
function getState(abbr){
   if (abbr=="WY")
   {
   return "Wyoming";
   }
}
var stateName = getState("WY");
​document.getElementById('msg').innerHTML=stateName; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-28T22:18:03.447

这将需要评估很多`if`语句：该函数可能必须遍历所有 50条`if`语句才能到达怀俄明州！我会用这样的`switch`语句重写它：

```
function getState(abbr){

   switch case(abbr) {

      case "WY":
         return "Wyoming";
      ...

   }
} 
```

我认为这应该更快。我还会添加一个`default`案例，以防输入错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T16:05:51.587

这只是我的解决方案。我仍在努力理解异步行为，但这是有效的：

代替：

```
function searchServing(which,choice){
   var state = getState("WY");
   $("#searchResults").html("<tr><td>" + state + "</td></tr>");
   .get(function() {

   } //for reference call this getSearchServing
} 
```

我不得不撤消电话，所以：

```
function getState(abbr){
  .get(function(){
      $("#searchResults").html("<tr><td>" + state + "</td></tr>");
  })
  .success(function() { 
    searchServing('serving',abbr);
  })
} 
```

仍然不确定为什么 getSearchServing 会在 getState 之前运行，也不确定为什么我不能从 getState 返回值？？？

# c# - 使用 AeroGlass 时 WPF 中的 ClearType

> ID：14076449
> 
> 赞同：2
> 
> 时间：2012-12-28T22:11:21.960
> 
> 标签：c#, .net, wpf, aero

每当我在 WPF 应用程序中使用 AeroGlass 时，ClearType 的行为都会变得很奇怪。我发现以下行将我的字体渲染设置回灰度：

```
mainWindowSrc.CompositionTarget.BackgroundColor = Colors.Transparent; 
```

为了让它重新与 AeroGlass 一起工作，我必须将这些 .NET 4.0 属性设置为每个包含文本的控件：

`RenderOptions.ClearTypeHint="Enabled" TextOptions.TextFormattingMode="Display" TextOptions.TextRenderingMode="ClearType"`

然后它看起来像这样：

![左边是灰度，右边是cleartype](../Images/55ef11fa2a5e1aa95101ee4e26f9e5d7.png)

有没有办法在不为窗口上的每个控件设置这些属性的情况下实现相同的效果？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:57:14.807

您可以在 MainWindows 构造函数中全局设置它。

像这样的东西：

```
RenderOptions.ClearTypeHintProperty.OverrideMetadata(typeof(FrameworkElement), new FrameworkPropertyMetadata { DefaultValue = ClearTypeHint.Enabled });
TextOptions.TextFormattingModeProperty.OverrideMetadata(typeof(FrameworkElement), new FrameworkPropertyMetadata { DefaultValue = TextFormattingMode.Display }); 
```

# spring-mvc - @RequestMapping 不接受标头中的多个值

> ID：14076453
> 
> 赞同：3
> 
> 时间：2012-12-28T22:12:09.533
> 
> 标签：spring-mvc

我在请求标头中添加了一个自定义参数。为什么@RequestMapping 的标头中不能有多个值：

```
@RequestMapping(value="/mapping/header", method=RequestMethod.GET, headers={"version=1.0.1","version=1.0.2"})
public @ResponseBody String byHeaderValue(); 
```

我也尝试了下面的代码，但它绝对不起作用：

```
 @RequestMapping(value="/mapping/header", method=RequestMethod.GET, headers={"version=1.0.1,1.0.2"})
public @ResponseBody String byHeaderValue(); 
```

但是，如果我制作 2 个单独的方法，它会起作用：

```
@RequestMapping(value="/mapping/header", method=RequestMethod.GET, headers="version=1.0.1")
public @ResponseBody String byHeaderValue1();

@RequestMapping(value="/mapping/header", method=RequestMethod.GET, headers="version=1.0.2")
public @ResponseBody String byHeaderValue2(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:22:59.627

因为您试图指定 2 个具有相同名称的标头。标头名称必须是唯一的。

# jquery - Bootstrap 崩溃停止工作 - “闪烁”Rails

> ID：14076455
> 
> 赞同：1
> 
> 时间：2012-12-28T22:12:15.580
> 
> 标签：jquery, ruby-on-rails, twitter-bootstrap, collapse

我的 rails 项目中的 bootstrap collapse ( `bootstrap-transition.js v2.2.1`) 正在工作，现在它在闪烁。场景是页面加载，我单击一个按钮打开内部折叠，它工作正常，然后当我单击关闭它时它会闪烁并保持展开状态。

```
 <button type="button" class="btn btn-info offset3" data-toggle="collapse" data-target="#demo">Show completed</button><br>
  <div class="pull-left offset2 collapse" id="demo">
    <ul class="task-list" id="completed">
       <table>
         <tbody>
           <tr>
             <td><%= render "completed" %></td>
           </tr>
         </tbody>   
       </table>
    </ul>
  </div> 
```

页面上的js

```
<script type="text/javascript">
    $("#demo").collapse("hide");
</script> 
```

在这个视图上有一些额外的 AJAX 工作，但我的问题是我的检查是什么？我在这个问题上花了大约 2 天的时间检查所有我认为可能无济于事的事情，所以最后我需要寻求帮助。当我尝试在任何页面上实现折叠时，它会闪烁。

```
bootstrap.js and bootsrap.css.scs 2.2.1, rails 3.2.8 
```

我在看什么？感谢您的关注和查看。

# html - 无法在 div 中居中图像

> ID：14076456
> 
> 赞同：1
> 
> 时间：2012-12-28T22:12:17.897
> 
> 标签：html, css

所以我在一个名为 content-pic 的 div 中水平居中两个图像时遇到了问题。我已经尝试过[如何在 div 中垂直居中图像](https://stackoverflow.com/questions/2237636/how-to-center-image-inside-div)和在此处[如何在 div 中垂直居中图像](https://stackoverflow.com/questions/2237636/how-to-center-image-inside-div)的解决方案，这些解决方案似乎不适用于我的问题。我的问题是如何在标题下方的 div 内容中通过 css 水平居中图像？我是否有一个我丢失的属性，或者我只是要弄乱填充/边距，直到它们看起来正确？

```
 html
<body>
   <div id="wrapper">
      <div id="header">
         <div id="mast"><img src="http://i1256.photobucket.com/albums/ii488/terafanb/guildwars2/26.png" height="99" width="774=" /></div>
         <div id="below-mast">
            <!--Start of below mast -->
            <img class="nav" src="http://i157.photobucket.com/albums/t60/Dragon_Aleph/fantasy_warrior_23022-800x600.jpg" height="297" width="226" border="0" alt="Crusader Army" />
            <img class="Guy" src="http://i157.photobucket.com/albums/t60/Dragon_Aleph/fantasy_warrior_23022-800x600.jpg" height="297" width="549" border="0" alt="Crusader Army" />
         </div>
         <!--end of below mast -->
      </div>
      <!--end header -->
      <div id="content">
         <!--Start of content -->
         <img class="content-pic" src="http://i157.photobucket.com/albums/t60/Dragon_Aleph/fantasy_warrior_23022-800x600.jpg" height="252" width="184" border="0" alt="Crusader Army" />
         <img class="content-pic" src="http://i157.photobucket.com/albums/t60/Dragon_Aleph/fantasy_warrior_23022-800x600.jpg" height="252" width="184" border="0" alt="Crusader Army" />
      </div>
      <!--End of content -->
      <div id="footer">
         <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="whatIs1031.html">What is a 1031 Exchange?</a></li>
            <li><a href="exchangeRequ.html">
               1031 Exchange Requirements</a>
            </li>
            <li><a href="typesOfExchange.html">Types of Exchanges</a></li>
            <li><a href="howToStart.html">How to get Started</a></li>
            <li><a href="whyCLX.html">Why CLX?</a></li>
            <li><a href="resources.html">Resources</a></li>
            <li><a href="fAQs.html">FAQs</a></li>
            <li><a href="fees.html">Fees</a></li>
            <li><a href="contactUs.html">Contact Us</a></li>
         </ul>
      </div>
      <!--end of footer -->
   </div>
   <!--End of Wrapper --> 
```

CSS

```
body {
  margin: 0;
  padding: 0;
}

#wrapper {
  margin: 0 auto; /* use shorthand */
  width: 774px;
}

#content {
  float: left;
  font-family: Arial, Helvetica, sans-serif;
  font-size: 12px;
  text-align: center;
  background-color: green;
}

ul {
  list-style: none;
  margin: 20px auto;
  width: 600px;
}

dd {
  margin-left: 6em;
}

.nav{float: left;}

.Guy{width:500px;
  margin-left: 30px;
}

.content-pic{}
.we-pay {
  font-size: 13px
}

.note{
  text-align:center;
}

.disclaimer {
  font-size: 13px;
  text-align: center;
  font-weight: bold;
  font-style: italic;
}
.FAQ{
   font-size:14px;
}
.FAQ li{ 
  margin:20px 0px 20px 0px;
}

.Question{
  font-weight:bold;
}

#footer {
  clear:both;
  text-align:center;
  margin-top:300px;/* The margin is so large becuase it is cleared and need to be larger much large than content */
}

#footer li {
  display: inline;
  border-left: 2px solid #000;
  padding: 0 3px 0 3px;
}

#footer li:first-child {
  border: none;
}

#footer a {
  font-family: Helvetica, sans-serif;
  color: #300000;
} 
```

这是我在代码笔上的代码，为您提供方便[http://codepen.io/Austin-Davis/full/fJLEn](http://codepen.io/Austin-Davis/full/fJLEn)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:30:14.607

只需 从div中删除 `float: left;` 属性。`content`它将使图像居中。
告诉我这不是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:31:00.860

您应该从 #content div 中删除 float:left

```
#content {
  /*float: left;*/
  font-family: Arial, Helvetica, sans-serif;
  font-size: 12px;
  text-align: center;
  background-color: green;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-21T08:48:07.517

删除浮动：左，它会正常工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T22:24:24.057

我没有看到一个`div`名为 content_pic 的内容，所以我假设您想将其中包含的`div`id居中。`#content``img.content_pic`

由于其父级具有固定宽度，因此您可以使用与使包装器居中的相同技术：

```
#content {
   margin: 0 auto;
} 
```

根据您的编辑，我现在了解到您希望将图像居中在 div 内`#content`。好吧，因为它`div`没有设定宽度，所以它会收缩你的图像。它没有空间来水平证明您的图像。

您需要将内容 div 的宽度设置为包装器的宽度，然后将其内容居中，或者您必须为其设置一个小于包装器的宽度，然后使用我最初描述的技术。

# html - CSS - 使用 css / Ordered 创建 3 列

> ID：14076458
> 
> 赞同：0
> 
> 时间：2012-12-28T22:12:43.683
> 
> 标签：html, css

我想使用 css 创建一个带有有序列表的 3 列列表？

1.  苹果
2.  橘子
3.  柠檬

现在它显示一个无序列表，即使代码显示是有序的。

示例： 1\. Apples 将是第一列，Oranges 将是第二列，而不是 Apples 在第一列中，Oranges 在其下方的第一列中。

```
<style> ol{margin-bottom:20px; overflow:hidden; width:600px;}
li{display:inline; float:left; line-height:1px;}
#two li {width:50%;}
#three li {width:33.333%;}
#four li {width:25%;}
#six li {width:16.666%;}
</style>

<code>
<ol id="3">
<li>
    <div class="fruit">
        apples
        oranges
        lemons
        etc..
    </div>
</li>
</ol>
  </code> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:14:54.813

`<ul>`是一个无序列表。用于`<ol>`有序列表。

```
<ol>
    <li>item 1</li>
    <li>item 2</li>
</ol>​ 
```

这是一个工作示例：[w3schools tryit](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_lists)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:41:27.600

正如弗莱姆所建议的，

你的代码应该看起来像

```
<!DOCTYPE html>
<html>
<style> ol{margin-bottom:20px; overflow:hidden; width:600px;}
li{display:inline; float:left; line-height:15px;}
#two li {width:50%;}
#three li {width:33.333%;}
#four li {width:25%;}
#six li {width:16.666%;}
</style>
<body>

<h4>An Ordered List:</h4>
<ol>
  <li>Coffee</li>
  <li>Tea</li>
  <li>Milk</li>
</ol>

</body>
</html> 
```

我不明白你为什么要定义#two、#tree 等。

# linux - /usr/lib/libpthread.so: 没有这样的文件或目录 && /usr/lib/libm.so: 没有这样的文件或目录

> ID：14076460
> 
> 赞同：1
> 
> 时间：2012-12-28T22:13:10.770
> 
> 标签：linux, gcc, makefile, centos

解决了`sudo ln -s /usr/lib64/libm.so /lib`和`ln -s /usr/lib64/libpthread.so /lib`

libm.so 在此目录中：/usr/lib64/libm.so libpthread 在此目录中：/usr/lib64/libpthread.so

我试过`ln -s /usr/lib/libthread.so /lib64/libpthread.so`了，出现同样的错误，机器需要重启吗？

我在使用 Centos 6.3 在 C 中创建客户端 OPENDMTP 时遇到问题

我的源文件：[https ://sourceforge.net/projects/opendmtp/files/client-c/1.2.3/](https://sourceforge.net/projects/opendmtp/files/client-c/1.2.3/)

我安装了： `yum groupinstall "Development Tools"`

我尝试安装所需的库，但它们已经安装。

尝试：`"make dest=linux dmtp"` 我得到下一个：

```
[root@localhost OpenDMTP_client-c_1.2.0]# make dest=linux dmtp

Make tools dirs ...
/bin/mkdir -p ./build_lin/obj
/bin/mkdir -p ./build_lin/obj/tools
/bin/mkdir -p ./build_lin/obj/lib

Make './build_lin/obj/lib/libtools.a' ...
ar rc ./build_lin/obj/lib/libtools.a ./build_lin/obj/tools/checksum.o ./build_lin/obj/tools/base64.o ./build_lin/obj/tools/bintools.o ./build_lin/obj/tools/buffer.o ./build_lin/obj/tools/gpstools.o ./build_lin/obj/tools/strtools.o ./build_lin/obj/tools/utctools.o ./build_lin/obj/tools/threads.o ./build_lin/obj/tools/sockets.o ./build_lin/obj/tools/io.o ./build_lin/obj/tools/comport.o ./build_lin/obj/tools/random.o
ranlib ./build_lin/obj/lib/libtools.a

Make module dirs ...
/bin/mkdir -p ./build_lin/obj
/bin/mkdir -p ./build_lin/obj/modules
/bin/mkdir -p ./build_lin/obj/lib

Make './build_lin/obj/lib/libmodule.a' ...
ar rc ./build_lin/obj/lib/libmodule.a ./build_lin/obj/modules/odometer.o ./build_lin/obj/modules/motion.o ./build_lin/obj/modules/geozone.o
ranlib ./build_lin/obj/lib/libmodule.a

Make base dirs ...
/bin/mkdir -p ./build_lin/obj
/bin/mkdir -p ./build_lin/obj/base
/bin/mkdir -p ./build_lin/obj/lib

Make './build_lin/obj/lib/libbase.a' ...
ar rc ./build_lin/obj/lib/libbase.a ./build_lin/obj/base/mainloop.o ./build_lin/obj/base/propman.o ./build_lin/obj/base/event.o ./build_lin/obj/base/events.o ./build_lin/obj/base/packet.o ./build_lin/obj/base/pqueue.o ./build_lin/obj/base/protocol.o ./build_lin/obj/base/accting.o ./build_lin/obj/base/upload.o
ranlib ./build_lin/obj/lib/libbase.a
make dest=linux XPORT_MEDIA=-DTRANSPORT_MEDIA_SOCKET -f src/custom/custom.mk dmtpd_all
make[1]: Entering directory `/home/centos/Downloads/OpenDMTP_client-c_1.2.0'

Making sample DMTP reference implementation ...

Make dmtp object dirs ...
/bin/mkdir -p ./build_lin/obj/custom
/bin/mkdir -p ./build_lin/obj/custom/linux
/bin/mkdir -p ./build_lin/obj/custom/modules
/bin/mkdir -p ./build_lin/obj/dmtp

Linking 'dmtpd' ...
cc -o ./build_lin/obj/dmtp/dmtpd -Wall -DTARGET_LINUX -DTRANSPORT_MEDIA_SOCKET -DPROTOCOL_THREAD -DGPS_THREAD -Isrc /usr/lib/libpthread.so /usr/lib/libm.so ./build_lin/obj/custom/startup.o ./build_lin/obj/custom/transport.o ./build_lin/obj/custom/log.o ./build_lin/obj/custom/gps.o ./build_lin/obj/custom/gpsmods.o ./build_lin/obj/custom/linux/os.o -L./build_lin/obj/lib -lmodule -lbase -ltools
cc: /usr/lib/libpthread.so: No such file or directory
cc: /usr/lib/libm.so: No such file or directory
make[1]: *** [dmtpd_exe] Error 1
make[1]: Leaving directory `/home/centos/Downloads/OpenDMTP_client-c_1.2.0'
make: *** [dmtp_socket] Error 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T23:21:19.623

从您链接到的存档中，我在第 54 行的 /OpenDMTP_client-c_1.2.3/make/common.mk 中看到：

```
 SOLIBS    = $(LINUX_LIBS)/libpthread.so $(LINUX_LIBS)/libm.so 
```

这是在 linux 上提供这些库的一种奇怪方式，而且不太可能工作。它们是特殊的系统库，并不存在于这样可预测的位置。指定它们的常规方法是使用 -lm 和 -pthread（不带 l）。

作为快速破解编辑 /OpenDMTP_client-c_1.2.3/make/common.mk hack 并将第 54 行替换为：

```
 SOLIBS    = 
```

并将第 82 行修改为：

```
 ALIBS       = -L$(LIB_DIR) -lmodule -lbase -ltools -lm -pthread 
```

应该解决问题。虽然我不确定对其他平台的影响。

# android - Android：在不耗尽电池的情况下使用 AlarmManager 的正确方法

> ID：14076468
> 
> 赞同：2
> 
> 时间：2012-12-28T22:14:19.197
> 
> 标签：android, alarmmanager

我需要在我的应用程序中进行背景检查，基本上是轮询各种 URL 以获取新内容。所以我读过这是用AlarmManager 完成的。

问题是，我不需要新东西一到就通知用户。假设我每小时检查一次，我完全可以在手机休眠时不进行任何检查，并在使用手机时恢复检查。这样用户最终会收到通知，但消耗很少。

所以我尝试了 setInExactRepeating。我在启动时启动它，但也在应用程序启动时启动它（主要用于安装后的会话，并确保它正在运行，即使应用程序被“强制终止”）。如何防止所有这些检查加起来？（只有在没有运行或需要停止前一个检查时才应运行新检查）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T22:27:22.507

我发现 setInexact Repeating 与 ELAPSED_REALTIME（或 RTC）相结合可以很好地实现非常小的电池消耗。在现有的未决意图（相同的意图和 id）上使用标志 FLAG_UPDATE_CURRENT 将简单地刷新当前警报计划（如果它已经存在）。或者，添加 Ralgha 建议的代码来检查您是否已经创建了挂起的意图并设置了警报，如果没有，则设置挂起的意图和警报时间表。这两种方法对电池的影响可能相同（可以忽略不计）。会导致大量流失的原因是经常做某事。事实上，您只想每小时更新一次，而不是在屏幕关闭时更新，您的应用程序将几乎不使用任何电池（假设它的处理速度相对较快并且自行清理干净）

[http://developer.android.com/reference/android/app/AlarmManager.html#ELAPSED_REALTIME](http://developer.android.com/reference/android/app/AlarmManager.html#ELAPSED_REALTIME)

*ELAPSED_REALTIME*

*此警报不会唤醒设备；如果它在设备睡眠时熄灭，则直到设备下次唤醒时才会发送。*

[http://developer.android.com/reference/android/app/AlarmManager.html#setInexactRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29](http://developer.android.com/reference/android/app/AlarmManager.html#setInexactRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)

*setInexactRepeating*

*这些警报比 setRepeating(int, long, long, PendingIntent) 提供的严格重复更省电，因为系统可以调整警报的相位以使它们同时触发，避免不必要地从睡眠中唤醒设备。*

[http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_UPDATE_CURRENT](http://developer.android.com/reference/android/app/PendingIntent.html#FLAG_UPDATE_CURRENT)

*FLAG_UPDATE_CURRENT*

*...如果描述的 PendingIntent 已经存在，则保留它，但用这个新 Intent 中的内容替换其额外数据。如果您正在创建仅附加内容发生变化的意图，则可以使用此选项，并且不关心任何收到您之前的 PendingIntent 的实体将能够使用您的新附加内容启动它，即使它们没有明确提供。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:27:12.303

您可以在设置警报之前检查是否已经设置了警报，还可以使用标志，以便在设备唤醒之前不会发出警报。

```
if ( PendingIntent.getBroadcast( context, 0, updateIntent, PendingIntent.FLAG_NO_CREATE ) == null )
{
    pendingIntent = PendingIntent.getBroadcast(context, 0, updateIntent, 0);
    getSystemService(ALARM_SERVICE).setInexactRepeating(AlarmManager.RTC,System.currentTimeMillis(),AlarmManager.INTERVAL_HOUR,pendingIntent);
}

```

# ruby-on-rails - 根据 Rails 中的用户角色显示和隐藏

> ID：14076469
> 
> 赞同：0
> 
> 时间：2012-12-28T22:14:30.927
> 
> 标签：ruby-on-rails, controller, roles, cancan

我的`home.html.erb`文件中有以下代码；

```
<!-- if seeker is logged in show button "Grab it" -->
<% if user_signed_in? %>
<div class="grabit alignright">
<small>want to work on this?</small>
<!-- if seeker is not logged in, show him the output text of "Sign in to work on this job" -->
<% else %>
<small>are you a guru? want to work on this? Sign up.</small>
<% end %>
</div> 
```

现在你可以看到我正在尝试让 Seeker 作为用户角色。根据具有该类型角色的该类型用户是否已登录，将显示不同的内容。

我已经安装了 Devise + CanCan。现在对此非常陌生，我已经查看了所有内容以了解如何执行此操作。我将拥有具有普通用户角色的“用户”和具有搜索者角色的“搜索者”。使用上面的代码只显示用户何时登录，而不是搜索者。

就这么简单`seekers_signed_in`吗？我应该使用什么？比较`user_signed_in`？我已经为用户、搜索者和管理员生成了设计视图。管理员将能够为用户和搜索者删除、更新等。用户发布项目，搜索者抓住它们。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T09:02:05.457

您不必创建用户和搜索者（两个设计模型），而是可以只创建一个通用模型并将其命名为用户，然后根据需要添加任意数量的角色。

我建议使用此[gem](https://github.com/platform45/easy_roles)来轻松配置角色，

然后，您`home.html.erb`只需执行以下操作：

```
<!-- if seeker is logged in show button "Grab it" -->
<% if user_signed_in? && current_user.is_seeker? %>
<div class="grabit alignright">
<small>want to work on this?</small>
<!-- if seeker is not logged in, show him the output text of "Sign in to work on this job" -->
<% else if !user_signed_in?%>
<small>are you a guru? want to work on this? Sign up.</small>
<% else%>
<small>You are not a seeker, you need to be a seeker!</small>
<% end %>
</div> 
```

CanCan 用于控制器级别，因此上述方法对于您的情况来说既简单又直接。

我希望这将有所帮助。

# php - 使用 PHP 内置的 ltrim() 删除单个字符

> ID：14076470
> 
> 赞同：7
> 
> 时间：2012-12-28T22:14:37.157
> 
> 标签：php, string, function, built-in

有没有一种简单的方法可以`ltrim()`用来删除匹配的单个实例而不是所有匹配？

我正在遍历字符串数组，我想删除第一个，也是唯一一个匹配（在本例中为元音）：

```
ltrim($value, "aeiouyAEIOUY"); 
```

使用默认行为，字符串`aardvark`or`Aardvark`将被修剪为`"rdvark"`. 我希望结果是`"ardvark"`.

无论如何，我都不受 ltrim 约束，但它似乎是最接近的内置 PHP 函数。它会很好`ltrim`并且`rtrim`有一个可选参数“limit”，只是说...... :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:20:03.370

只需使用 preg 替换它有一个限制选项

例如

```
$value = preg_replace('/^[aeiouy]/i', '', $value, 1); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T22:19:39.953

正则表达式可能有点矫枉过正，但是：

```
$value = preg_replace('/^[aeiouy]/i', '', $value); 
```

请注意`i`使其不区分大小写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:18:46.123

你不能用`ltrim`你说的原因来做这个，你也不能用`str_replace`（也没有限制）。我认为使用正则表达式是最简单的：

```
$value = preg_replace('/^[aeiouy]/i', '', $value); 
```

但是，如果您真的不想这样做，您可以使用子字符串，但您必须在循环中检查字符串中任何这些字符串的位置，因为没有 php 函数可以进行这样的检查，我了解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T22:19:00.800

您可以使用以下`preg_replace`功能：

```
<?php
    $value = preg_replace('/^[aeiouy]/i', '', $value);
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-28T22:21:21.977

有几种方法可以去做你想做的事情。

也许最直接的方法是这样的正则表达式替换：

```
$pattern = '/^[aeiouy]{1}/i';
$result = preg_replace($pattern, '', $original_string); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-28T22:25:33.817

这可能是最有效的方法（所以忽略我的正则表达式答案）：

```
if (strpos('aeiouyAEIOUY', $value[0]) !== false) $value = substr($value, 1); 
```

或者，

```
if (stripos('aeiouy', $value[0]) !== false) $value = substr($value, 1); 
```

# processing - 正确使用 processing.org 三角函数

> ID：14076473
> 
> 赞同：0
> 
> 时间：2012-12-28T22:14:51.880
> 
> 标签：processing

这真的让我发疯，我知道我有点傻。为什么这条线不是45度？

```
 size(800, 600);
    background (30);  
    stroke(255);

    float r = 100;
    float a= 20+   r * cos(radians(QUARTER_PI))   ;
    float b= 20+   r * sin(radians(QUARTER_PI))   ;
    line(20,20,a,b); 
```

我已经从一个更大的项目中简化了这段代码，如果我做了很多迭代，就会出现圆圈。我做了什么来制作角度刻度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:28:35.957

我将从调试代码开始。由于传递给 的值，该线不是 45 度`line()`。通过打印 和 的值`a`，`b`很明显这条线是从坐标 (20,20) 到大致 (119, 21) 绘制的。所以你告诉程序画一条直线。

```
print(a + "\n");  // returns 119.99
print(b);         // returns 21.37 
```

如果你想画一个圆，为什么不使用这个[`ellipse()`](http://processing.org/reference/ellipse_.html)功能呢？

* * *

**编辑：**

您的代码的问题是您将 value 传递给`radians()`函数，该 value`QUARTER_PI`已经以弧度表示。因此，您的问题可以通过以下任一方式解决：

```
// Pass in an amount of radians directly.
float r = 100;
float a = 20 + r * cos(QUARTER_PI);
float b = 20 + r * sin(QUARTER_PI);
line(20,20,a,b); 
```

或者

```
// Pass in degrees converted to radians.
float r = 100;
float a = 20 + r * cos(radians(45));
float b = 20 + r * sin(radians(45));
line(20,20,a,b); 
```

# c - 程序计数字 c

> ID：14076477
> 
> 赞同：1
> 
> 时间：2012-12-28T22:15:06.737
> 
> 标签：c, counting

我有一个几乎很好的工作程序来计算标准输入中的单词。必须计数的词是程序参数。

问题是我使用空格来查看单词，但我也必须在单词本身内计数。示例：如果我的输入是 aa aaaa #EOF，并且我想计算 aa，那么结果应该是 4。我的代码结果是 2。

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>
#include <math.h>

int word_cnt(const char *s, char *argv[])
{
    int cnt = 0;

    while(*s != '\0')
    {
        while(isspace(*s))
        ++s;
        if(*s != '\0')
        {
            if(strncmp(s, argv[1], strlen(argv[1])) == 0)
            ++cnt;

            while(!isspace(*s) && *s != '\0')
            ++s;
        }
     }

    return cnt;
}

int main(int argc, char *argv[])
{
    char buf[1026] = {'\0'};
    char *p="#EOF\n";
    int tellen = 0;

    if (argc != 2)
    {
        printf("Kan het programma niet uitvoeren, er is geen programma argument gevonden\n");
        exit(0);
    }

    while((strcmp(buf, p) !=0))
    {
        fgets (buf, 1025, stdin);
        tellen += word_cnt(buf, argv);
    }

    printf("%d", tellen);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:22:45.787

你有这个：

```
if(strncmp(s, argv[1], strlen(argv[1])) == 0)
    ++cnt;

while(!isspace(*s) && *s != '\0')
    ++s; 
```

试试这个：

```
/* if it matches, count and skip over it */
while (strncmp(s, argv[1], strlen(argv[1])) == 0) {
    ++cnt;
    s += strlen(argv[1]);
}

/* if it no longer matches, skip only one character */
++s; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:49:46.613

```
int word_cnt(const char *s, char *argv[])
{
    int cnt = 0;
    int len = strlen(argv[1]);
    while(*s)
    {
            if(strncmp(s, argv[1], len) == 0)
              ++cnt;

            ++s;
     }

    return cnt;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:57:54.277

在循环中尝试[strncmp() 。](http://pubs.opengroup.org/onlinepubs/9699919799/functions/strncmp.html)

```
/* UNTESTED */
unsigned wc(const char *input, const char *word) {
    unsigned count = 0;
    while (*input) {
        if (strncmp(input, word, strlen(word)) == 0) count++;
        input++;
    }
    return count;
} 
```

# emacs - 在删除选择模式下覆盖时如何杀死文本

> ID：14076480
> 
> 赞同：2
> 
> 时间：2012-12-28T22:15:45.323
> 
> 标签：emacs

我想更改 delete-selection-mode 的默认行为，以便被覆盖的选择被杀死而不是被删除。新的 Emacs 24.2 就是这种情况：

```
Emacs -Q
(delete-selection-mode) 
```

浏览 delsel.el 我接近了我想要的行为：

```
(put 'self-insert-command 'delete-selection 'kill) 
```

但这实际上并没有插入我键入的键来覆盖所选文本。而且它不能满足`'org-self-insert-command`（作为不可预见后果的一个例子）。

我错过了一些基本的东西吗？

# asp.net-mvc-4 - 潜在危险请求服务堆栈

> ID：14076483
> 
> 赞同：3
> 
> 时间：2012-12-28T22:16:09.823
> 
> 标签：asp.net-mvc-4, servicestack

我正在向 `Body=%3Ch2%3E (Body=<h1>)` servicestack 休息端点提交一个包含值的查询字符串。这导致：

> 从客户端检测到潜在危险的 Request.QueryString 值 (Body=\"<h2>\")。

我知道在 MVC 4 中，您可以允许特定字段的 Html 内容，如果您使用 [AllowHtml] 装饰模型中的字段，如下所示：

> [AllowHtml] 公共字符串正文 { 获取；放; }

这样做了，但错误仍然存​​在。怀疑是服务堆栈没有正确参与验证过程，因此通过创建具有相同模型的纯 MVC 4 控制器进行测试，并且效果很好。

但是我需要一个 ServiceStack 的解决方案。他们的文档很薄，谷歌搜索无处可去。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T22:43:22.687

看起来您在 ASP.NET 应用程序中托管 ServiceStack 服务。

您可以将以下内容添加到`<system.web>`web.config 文件的部分，以禁用整个应用程序的请求验证：

```
<system.web>
    <httpRuntime requestValidationMode="2.0" />
    ...
</system.web> 
```

如果您只想对特定端点而不是整个应用程序禁用请求验证，请使用`<location>`web.config 中的标记：

```
<location path="hello">
    <system.web>
        <httpRuntime requestValidationMode="2.0" />
    </system.web>
</location> 
```

`/hello`这将禁用应用程序中所有端点的请求验证。例如`/hello?Body=%3Ch2%3E`将工作但`/bar?Body=%3Ch2%3E`不会工作。

您可以在[`following MSDN article`](http://msdn.microsoft.com/en-us/library/hh882339.aspx).

如果您是自托管 ServiceStack 服务，显然您不必担心这一点。

# java - 根据选定的 MenuItem 资源 ID 加载字符串资源 - Android JAVA

> ID：14076484
> 
> 赞同：0
> 
> 时间：2012-12-28T22:16:10.150
> 
> 标签：java, android

我正在编写我的第一个 Android 应用程序。它将有数百个菜单链接，这些链接会随着每个版本的发布而改变。我正在寻找一种基于资源 ID 处理 onclicks 的方法。

菜单在 XML 中定义如下：

```
<item android:id="@+id/Spring_2013" android:title="Spring 2013" android:showAsAction="ifRoom|withText" /> 
```

onclicks 将加载存储在 strings.xml 中的 URL：

```
<string name="Summer_2013">file:///android_asset/catalog/current/genadmissionreq.html</string> 
```

所以，似乎我只需要一个简单的、单一的 onclick 方法，它可以根据所选的资源 ID 加载所需的任何字符串。MenuItem ID 始终等于我的代码中的 URL 字符串 ID。因此，如果不使用数百个 if() 或 switch/case 语句，我不能说：

```
String url = getString("R.string." + menuItem.getItemId()); 
```

显然，由于多种原因，该分配不会起作用。但你明白吗？那么，我怎样才能使这项工作？

对于新手的问题，我很抱歉。我知道这应该很简单，但我已经阅读了好几天，如果没有每个菜单项的 if() 语句，我找不到任何方法。这种方法会使每周更新成为一场噩梦！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:31:44.507

尝试使用[`getIdentifier()`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)

```
String title = menuItem.getTitle().toString().replace(' ', '_');
id = getResources().getIdentifier(title, "string", getPackageName());
String string = getString(id); 
```

第一行获取`Spring 2013`并将其转换为`Spring_2013`.
第二行`"R.string."`以任何标题构建，在本例中为`"R.string.Spring_2013"`.
第三行只是获取 String 资源。

# hibernate - Log4j2 日志休眠参数绑定

> ID：14076487
> 
> 赞同：6
> 
> 时间：2012-12-28T22:17:09.807
> 
> 标签：hibernate, binding, parameters, log4j2

有没有人有一个如何用 log4j2 记录休眠 sql 参数的例子？我知道如何使用 log4j 1.x 记录它们，但我无法使用 log4j 的 2.0 beta 3 版本（迄今为止的最新版本）来执行此操作。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-23T18:46:54.797

我已经看到了对这个问题的其他回复，但没有一个**只记录 sql 替换参数**。如果您设置`org.hibernate.type`Logger 类别，您将获得大量输出！

我只想看到替换的值。如果这也是您想要的，请继续阅读...

总之，您要配置的 Logger 类别称为：

```
org.hibernate.type.descriptor.sql.BasicBinder 
```

您需要将其值设置为`TRACE`

也就是说，下面是`.properties`使这项工作有效的样式和 XML 配置。

`.properties`风格：

```
log4j.rootLogger=INFO, Console
log4j.appender.Console=org.apache.log4j.ConsoleAppender
log4j.appender.Console.layout=org.apache.log4j.PatternLayout
log4j.appender.Console.layout.ConversionPattern=%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n
# Below is the line to dump ONLY the bind variables
log4j.logger.org.hibernate.type.descriptor.sql.BasicBinder=TRACE 
```

XML:

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
  <appender name="Console" class="org.apache.log4j.ConsoleAppender"> 
    <layout class="org.apache.log4j.PatternLayout"> 
      <param name="ConversionPattern" value="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/> 
    </layout> 
  </appender> 

  <root> 
    <priority value="DEBUG" /> 
    <appender-ref ref="Console" /> 
  </root>

  <logger name="org.hibernate.type.descriptor.sql.BasicBinder">
    <level value="TRACE" />
    <appender-ref ref="Console" />
  </logger>

</log4j:configuration> 
```

输出将如下所示：

```
10:58:47,631 TRACE [org.hibernate.type.descriptor.sql.BasicBinder] (Thread-5212 (HornetQ-client-global-threads-475186579)) binding parameter [1] as [BIGINT] - 165
10:58:47,631 TRACE [org.hibernate.type.descriptor.sql.BasicBinder] (Thread-5212 (HornetQ-client-global-threads-475186579)) binding parameter [2] as [BIGINT] - 1390496100822 
```

玩得开心！

# c# - 将组件动态添加到不受大小限制的表单 C#

> ID：14076488
> 
> 赞同：0
> 
> 时间：2012-12-28T22:17:14.810
> 
> 标签：c#, forms

我在程序运行时在表单中动态添加标签和文本框。如何在滚动窗格中插入这些组件，以便无论我添加多少标签和文本框，它们都适合表单？

我不知道我是否清楚......但我想要的是能够添加尽可能多的组件，而不是在表单的有限大小中......有没有办法做到这一点？

这是我现在的代码：

```
public void generateFormDynamically()
{
      textBoxes = new TextBox[noOfPlayers];

      int xLabel = 95;
      int yLabel = 215;

      int xTextBox = 205;
      int yTextBox = 215;

      for (int i = 0; i < noOfPlayers; i++)
      {
           Label label = new Label();
           label.Text = "Player " + (i + 1) + ":";

           if (i == 0) label.Location = new Point(xLabel, yLabel);
           else
           {
               yLabel += 55;
               label.Location = new Point(xLabel, yLabel);
           }

           label.AutoSize = true;
           label.BackColor = System.Drawing.Color.Transparent;
           label.Font = new System.Drawing.Font("Segoe UI Semibold", 11.25F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
           label.Name = "label" + (i + 2);
           label.Size = new System.Drawing.Size(68, 20);
           label.TabIndex = 6;
           label.Visible = true;
           label.Show();
           this.Controls.Add(label);

           TextBox textBox = new TextBox();

           if (i == 0) textBox.Location = new Point(xTextBox, yTextBox);
           else
           {
                yTextBox += 55;
                textBox.Location = new Point(xTextBox, yTextBox);
           }

           textBox.Font = new System.Drawing.Font("Microsoft Sans Serif", 8.25F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
           textBox.Name = "textBox" + (i + 1);
           textBox.Size = new System.Drawing.Size(245, 20);
           textBox.TabIndex = 1;
           textBox.Text = "Player" + (i + 1);
           textBox.Visible = true;
           textBox.Show();
           textBoxes[i] = textBox;
           this.Controls.Add(textBox);
     }
} 
```

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:25:12.030

正如其他人所说，您不能将其添加到固定形式，然后再调整形式。最终，表格会太大。但是，你可以做的是：

1）在表单上添加一个面板，面板大小是固定的（或锚定/停靠）。2) 将面板 AutoScroll 设置为 true。3）然后添加标签/文本框。

所以，如果添加了太多的标签/文本框，滚动条就会出现。

但是，为动态控制的 # 设置一个限制是个好主意。

# forms - CakePHP：使用分组/嵌套选项填充选择下拉列表的简单方法？

> ID：14076490
> 
> 赞同：0
> 
> 时间：2012-12-28T22:17:48.387
> 
> 标签：forms, cakephp

假设我有大洲和国家，大洲有很多国家，有没有一种简单的方法可以创建这样的选择下拉列表？

![$this->form->select('国家');](../Images/fe0c06edeaa979cb767cb2578a7dea38.png)

我正在尝试编写如下代码：

```
// in the controller
$this->set('countries', $this->Country->find('all', array('fields' ...)))

// in the view
$this->Form->select('countries') 
```

我想将这些选择组合在一起，但避免编写大量额外的逻辑来重新排列数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T22:44:27.617

如果你像这样形成你的数组，它会这样做：

```
$countries = array(
    'North America' => array(
        123 => 'Canada'
        ...
        ...
    ),
    'South America' => array(
        345 => 'Argentina'
        ...
        ...
    ),
); 
```

然后你像往常一样使用表单助手。

```
$this->Form->select('countries'); 
```

### 笔记

您不能`find('all')`用于选择。您需要使用`find('list')`或重新格式化来自`find('all')`

# android - 使用 Python 文件“run.py”测试 Android OpenCV 应用程序性能的困难

> ID：14076494
> 
> 赞同：0
> 
> 时间：2012-12-28T22:18:18.787
> 
> 标签：android, python, opencv

我在运行“run.py”文件来测试我的 Android OpenCV 应用程序时遇到了困难。“run.py”文件未经修改，取自文件夹 ..\modules\ts\misc 中的 OpenCV 库包。我正在使用来自[http://opencv.willowgarage.com/wiki/AnalyzePerfTestsLogs](http://opencv.willowgarage.com/wiki/AnalyzePerfTestsLogs)和[http://code.opencv.org/projects/opencv/wiki/Android_Java_API_tests](http://code.opencv.org/projects/opencv/wiki/Android_Java_API_tests)的教程，但我在 python 编译器中得到了 SyntaxErrors。根据第一个教程，我将目录更改为由 Eclipse 创建的我的 android 应用程序项目文件夹。它是一个正确的文件夹吗？然后我输入第二个教程中的命令：“python run.py . -a -t java”，我收到一条错误消息：“File “run.py”, line 274 print “adb command:”, “”.join （自己。

我究竟做错了什么？你能告诉我如何在我的情况下运行“run.py”python文件吗？我之前没有使用过任何python脚本，所以请原谅我的任何错误。我想使用 OpenCV 库中包含的 python 文件，因为我的目标是在几个 Android 设备上测试 Android OpenCV 应用程序的性能，而这些 python 文件是我所知道的最佳解决方案。

# android - Android Bundle 循环异常

> ID：14076501
> 
> 赞同：0
> 
> 时间：2012-12-28T22:19:01.800
> 
> 标签：android

我正在尝试传递一些自定义对象（Parcelable），这是传递活动代码

```
Intent resultsActivity = new Intent(GamePlayActivity.this, Results.class);
                Bundle extras = new Bundle();
                resultsActivity.putExtra("length", arrayOfDrills.length);
                for(int i = 0; i < arrayOfDrills.length; i++ ){
                    extras.putParcelable("drill_" + i, arrayOfDrills[i]);
                }
                resultsActivity.putExtras(extras);
                startActivity(resultsActivity); 
```

这是接收活动代码：

```
public class Results extends Activity {
    Drill[] arrayOfDrills;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_results);

        Bundle extras  = getIntent().getExtras();
        //int length = extras.getInt("length"); 
        int length = 3;
        Log.w("length", ""+length);
        arrayOfDrills = new Drill[length];
        for(int i = 0; i < length; i++ ){
            arrayOfDrills[i] = extras.getParcelable("drill_" + i);
        } 
```

我在 logCat 中有这个：

```
12-28 22:10:07.944: E/AndroidRuntime(855): Caused by: java.lang.RuntimeException: Parcel android.os.Parcel@40512e58: Unmarshalling unknown type code 7077993 at offset 148
12-28 22:10:07.944: E/AndroidRuntime(855):  at android.os.Parcel.readValue(Parcel.java:1913)
12-28 22:10:07.944: E/AndroidRuntime(855):  at android.os.Parcel.readMapInternal(Parcel.java:2082)
12-28 22:10:07.944: E/AndroidRuntime(855):  at android.os.Bundle.unparcel(Bundle.java:208)
12-28 22:10:07.944: E/AndroidRuntime(855):  at android.os.Bundle.getParcelable(Bundle.java:1100)
12-28 22:10:07.944: E/AndroidRuntime(855):  at com.simplemathgame.Results.onCreate(Results.java:25)
12-28 22:10:07.944: E/AndroidRuntime(855):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-28 22:10:07.944: E/AndroidRuntime(855):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611) 
```

为什么会发生崩溃？？？

# polymorphic-associations - Batman.js：未找到多态关联的相关模型未定义

> ID：14076502
> 
> 赞同：0
> 
> 时间：2012-12-28T22:19:03.040
> 
> 标签：polymorphic-associations, batman.js

我在尝试在蝙蝠侠模型上实现多态关联时遇到了问题。我在控制台中收到此错误：

> 未找到多态关联的相关模型未定义。

我很难找出哪里出错了。我应该在哪里寻找丢失的部分？

我的模型看起来像这样：

```
class Admin.Product.PopularCollectables extends Batman.Model
  @belongsTo 'collectable', polymorphic: true

class Admin.Item extends Batman.Model
  @hasOne 'popular_collectable', as: 'collectable' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-19T05:50:29.167

当 Batman 在关联中加载相关模型时，它会检查命名空间。默认情况下，命名空间是`Batman.currentApp`（这是你调用后的应用程序`MyApp.run()`），但你也可以在声明关联时传递一个命名空间：

```
class Admin.Item extends Batman.Model
  @hasOne 'popular_collectable', as: 'collectable', namespace: Admin.Product 
```

这样，蝙蝠侠将`PopularCollectable`在 Admin.Product 上而不是在 Admin 上查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-09T12:35:11.237

当它从 Rails 发送到客户端时，我能够通过在父 Batman Model 实例`belongs_to`中嵌入关系的一侧来解决这个问题：`has_many`

```
format.json {render :json => @post, :include => {:comments => {:include => :comments}}} 
```

# shell - 根据unix中的位置拆分记录并将字符串与下一条记录进行比较并复制

> ID：14076503
> 
> 赞同：0
> 
> 时间：2012-12-28T22:19:03.187
> 
> 标签：shell, unix, sed, awk

我的输入文件如下：

```
B0000001201012345519680415EN
B0000001201052323219921114
B0000001701233333319510802LN
B0000001701238999919460920
B0000000247974444419611219TN
B0000000246666666619910804
B0000000247777777719940329 
```

我想根据开始的 9 个字节（`B00000012`）将第一条记录“EN”复制到第二条记录。预期的输出是：

```
B0000001201012345519680415EN
B0000001201052323219921114EN
B0000001701233333319510802LN
B0000001701238999919460920LN
B0000000247974444419611219TN
B0000000246666666619910804TN
B0000000247777777719940329TN 
```

我需要用 unix shell 脚本编写这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T01:10:02.967

这将适用于您的输入：

```
awk '!(x = substr($0,27)) { print $0 r; next } { r = x }1' file 
```

但是，如果需要检查前九个字符，它将失败。要执行此检查，请尝试以下操作：

```
awk 'x = substr($0,27) { a[substr($0,0,9)]=x } (y = substr($0,0,9)) in a && !x { print $0 a[y]; next }1' file 
```

结果：

```
B0000001201012345519680415EN
B0000001201052323219921114EN
B0000001701233333319510802LN
B0000001701238999919460920LN
B0000000247974444419611219TN
B0000000246666666619910804TN
B0000000247777777719940329TN 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:38:08.250

使用 Perl：

```
perl -lape '$m = $1 if /([A-Z][A-Z])$/; s/(?<=[0-9]) *$/$m/' input 
```

输出：

```
B0000001201012345519680415EN
B0000001201052323219921114EN
B0000001701233333319510802LN
B0000001701238999919460920LN
B0000000247974444419611219TN
B0000000246666666619910804TN
B0000000247777777719940329TN 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T00:46:26.993

如果您考虑使用 awk，这是一个经典的**FIELDWIDTHS**用法示例：

```
awk -vFIELDWIDTHS="9 17 2" -vOFS="" '{if($1 in a)$3=a[$1];else a[$1]=$3}1' file 
```

# iphone - 我可以使用与布局方向不同的滚动方向的 UICollectionViewFlowLayout 吗？

> ID：14076505
> 
> 赞同：1
> 
> 时间：2012-12-28T22:19:29.397
> 
> 标签：iphone, ios, sdk, uicollectionview, flowlayout

UICollectionViewFlowLayout 很棒，但是，我希望它稍微调整一下，以便 scrollDirection 与布局方向不同。我想要的示例是跳板主屏幕或表情符号键盘，您可以在其中向左/向右滑动，但单元格从左到右、从上到下排列（而不是从上到下、从左到右，因为它们是UICollectionViewFlowLayout 与 scrollDirection 设置为水平）。任何人都知道我可以如何轻松地对 FlowLayout 进行子类化以进行此更改？我很失望他们在 UICollectionViewFlowLayout 对象上除了 scrollDirection 之外没有 layoutDirection :(

@rdelmar 我实现了与您的解决方案类似的东西，并且有效（不像我想要的那样优雅），但我注意到偶尔项目会从集合中消失，除非重新绘制，这就是我不接受答案的原因。这是我最终得到的结果：

```
@interface UICollectionViewPagedFlowLayout : UICollectionViewFlowLayout
@property int width;
@property int height;
@end
@implementation UICollectionViewPagedFlowLayout
#warning MINOR BUG: sometimes symbols disappear
- (CGSize)collectionViewContentSize {
    CGSize size = [super collectionViewContentSize];
    // make sure it's wide enough to cover all the objects
    size.width = self.collectionView.bounds.size.width * [self.collectionView numberOfSections];
    return size;
}
- (NSArray*) layoutAttributesForElementsInRect:(CGRect)rect {
    NSArray *array = [super layoutAttributesForElementsInRect:rect];
    CGRect visibleRect;
    visibleRect.origin = self.collectionView.contentOffset;
    visibleRect.size = self.collectionView.bounds.size;

    for (UICollectionViewLayoutAttributes* attributes in array) {
        if (CGRectIntersectsRect(attributes.frame, rect)) {
            // see which section this is in
            CGRect configurableRect = UIEdgeInsetsInsetRect(visibleRect, self.sectionInset);
            int horizontalIndex = attributes.indexPath.row % self.width;
            int verticalIndex = attributes.indexPath.row / self.width;
            double xspace = (configurableRect.size.width - self.width * self.itemSize.width) / self.width;
            double yspace = (configurableRect.size.height - self.height * self.itemSize.height) / self.height;
            attributes.center = CGPointMake(attributes.indexPath.section * visibleRect.size.width + self.sectionInset.left + (self.itemSize.width + xspace) * horizontalIndex + self.itemSize.width / 2, self.sectionInset.top + (self.itemSize.height + yspace) * verticalIndex + self.itemSize.height / 2);
        }
    }
    return array;
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:16:22.203

IIRC，这正是在 UICollectionView[的 WWDC 2012 会议中展示的。](http://developer.apple.com/videos)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:17:37.210

我不太清楚，我猜取决于你的定义。我做了一个项目，我的布局与您正在寻找的内容接近。这将水平排列行，从左到右，从上到下。我的数据源是一个数组数组，其中每个子数组为一行提供数据。

```
#import "SimpleHorizontalLayout.h" // subclass of UICollectionViewFlowLayout
#define kItemSize 60

@implementation SimpleHorizontalLayout 

-(CGSize)collectionViewContentSize {
    NSInteger xSize = [self.collectionView numberOfItemsInSection:0] * (kItemSize + 20); // the 20 is for spacing between cells.
    NSInteger ySize = [self.collectionView numberOfSections] * (kItemSize + 20);
    return CGSizeMake(xSize, ySize);
}

- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)path {
    UICollectionViewLayoutAttributes* attributes = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:path];
    attributes.size = CGSizeMake(kItemSize,kItemSize);
    NSInteger xValue = kItemSize/2 + path.row * (kItemSize +20) ;
    NSInteger yValue = kItemSize + path.section * (kItemSize +20);
    attributes.center = CGPointMake(xValue, yValue);
    return attributes;
}

-(NSArray*)layoutAttributesForElementsInRect:(CGRect)rect {
    NSInteger minRow =  (rect.origin.x > 0)?  rect.origin.x/(kItemSize +20) : 0; // need to check because bounce gives negative values for x.
    NSInteger maxRow = rect.size.width/(kItemSize +20) + minRow;
    NSMutableArray* attributes = [NSMutableArray array];
    for(NSInteger i=0 ; i < self.collectionView.numberOfSections; i++) {
        for (NSInteger j=minRow ; j < maxRow; j++) {
            NSIndexPath* indexPath = [NSIndexPath indexPathForItem:j inSection:i];
            [attributes addObject:[self layoutAttributesForItemAtIndexPath:indexPath]];
        }
    }
    return attributes;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T21:40:27.833

在 Apple 添加一个简单的标志来更改流布局的布局方向之前，我最终还是进行了子类化。有些东西是特定于我的实现的，但它可能对其他人有帮助：

```
@interface UICollectionViewPagedFlowLayout : UICollectionViewFlowLayout
@property int width;
@property int height;
@end
@implementation UICollectionViewPagedFlowLayout
#warning MINOR BUG: sometimes items disappear
- (CGSize)collectionViewContentSize {
    CGSize size = [super collectionViewContentSize];
    size.width = self.collectionView.bounds.size.width * [self.collectionView numberOfSections];
    return size;
}
- (NSArray*) layoutAttributesForElementsInRect:(CGRect)rect {
    NSArray *array = [super layoutAttributesForElementsInRect:rect];
    CGRect visibleRect;
    visibleRect.origin = self.collectionView.contentOffset;
    visibleRect.size = self.collectionView.bounds.size;

    for (UICollectionViewLayoutAttributes* attributes in array) {
        if (CGRectIntersectsRect(attributes.frame, rect)) {
            // see which section this is in
            CGRect configurableRect = UIEdgeInsetsInsetRect(visibleRect, self.sectionInset);
            int horizontalIndex = attributes.indexPath.row % self.width;
            int verticalIndex = attributes.indexPath.row / self.width;
            double xspace = (configurableRect.size.width - self.width * self.itemSize.width) / self.width;
            double yspace = (configurableRect.size.height - self.height * self.itemSize.height) / self.height;
            attributes.center = CGPointMake(attributes.indexPath.section * visibleRect.size.width + self.sectionInset.left + (self.itemSize.width + xspace) * horizontalIndex + self.itemSize.width / 2, self.sectionInset.top + (self.itemSize.height + yspace) * verticalIndex + self.itemSize.height / 2);
        }
    }
    return array;
}
@end 
```

# javascript - 如何解析下面的简单 json 响应？

> ID：14076511
> 
> 赞同：2
> 
> 时间：2012-12-28T22:20:02.390
> 
> 标签：javascript, json, sencha-touch

**背景：我试图在我的 SenchaTouch 应用程序中解析这个简单的 json 响应。**

json响应：

```
{
    "Australia": 
    [
        {
            "Currency": "AustralianDollar",
        }
    ],
    "INDIA": 
    [
        {
            "Currency": "INR"
        }
    ],
    "USA": 
    [
        {
            "Currency": "USD"
        }
    ]
} 
```

我想根据国家名称获取国家的货币。

我正在尝试获取如下货币值。

```
var country = text.Australia.name;
console.log('Country name is'+country); 
```

但它给了我错误。谁能解释一下如何解析给出国家名称作为输入并获取货币？

谢谢你，甘达富

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:24:44.200

如果`text`是 JSON 字符串，您可以这样做：

```
var obj = JSON.parse(text);
var australia = obj.Australia;
var aussie_currency = australia[0].Currency; 
```

请注意，包含`Currency`在数组内部的对象的奇怪嵌套导致需要数组索引引用`[0]`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:37:45.383

在 Sencha Touch 你应该使用

```
var object = Ext.decode(text); 
```

将 json 字符串转换为对象。然后，在您的情况下，由于“澳大利亚”不是对象而是数组，因此您需要通过以下方式获取第一个元素货币

```
object.Australia[0].Currency; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:23:12.127

最简单的方法是：

```
var obj = eval("(" + text+ ')'); 
```

查看[json.org](http://json.org/)以获得更好/更安全的方法。

[这里的工作示例。](http://jsfiddle.net/3eAuf/)

查看[此兼容性图表](http://caniuse.com/json)以使用`JSON.parse(text);`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T23:31:41.367

最好的方法是使用 JSON.parse()。[所有浏览器都不支持这一点，但您可以通过在https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)使用 Douglas Crockford 实现来获得回退

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-12-28T22:32:25.553

您可以使用 jQuery 的[$.parseJSON()](http://api.jquery.com/jQuery.parseJSON/)

之后，您可以使用：

```
    var text = $.parseJSON(jsonString);
    var 货币 = text.Australia[0].Currency;

```

作为 jsonString，您可以通过 JSON 获得。

希望这可以帮助！

# javascript - 使用 javascript 为消息创建单独的页面？

> ID：14076512
> 
> 赞同：0
> 
> 时间：2012-12-28T22:20:02.627
> 
> 标签：javascript

好的，这可能是一个令人困惑的问题。我的messages.php 页面中有以下javascript，它控制将显示哪个div。每个 div 都有一个单独的功能。

message-content-p1 包含一个 while 循环，它获取所有消息并将其限制为 20 条要显示的消息，第二个是 message-content-p2 等等，每个都包含下一个 while 循环，每个循环只显示 20 条消息.

这个 javascript 的想法是创造一种错觉，即在第 2 页、第 3 页等上显示更多消息。

到目前为止，javascript 在单击“m_p1”或“m_p2”时显示每个 div，并淡出当前页面并淡入下一页。这适用于该功能。我遇到的问题是，如果用户想要跳过页面并转到第 3 页或第 5 页而不转到第 2 页或第 4 页，那么脚本将不起作用，并且没有任何东西淡入或淡出。

同样，如果用户从第 5 页返回到第 1 页，脚本将不起作用，并且不会淡出第 5 页并淡入第 1 页。

有没有办法做我所描述的事情，如果可以，有人可以告诉我如何做。

谢谢你。

```
 <script>
    $(".message-content-p2").hide();
    $('.m_p2').click(function () {
        if ($('.message-content-p2').is(":hidden")) {       
      $('.message-content-p1').fadeOut(500);
      $('.message-content-p2').delay(700).fadeIn(500);

        }

      });

    </script>

    <script>
    $(".message-content-p3").hide();
    $('.m_p3').click(function () {
        if ($('.message-content-p3').is(":hidden")) {       
      $('.message-content-p2').fadeOut(500);
      $('.message-content-p3').delay(700).fadeIn(500);

        }

      });

    </script>

    <script>
    $(".message-content-p4").hide();
    $('.m_p4').click(function () {
        if ($('.message-content-p4').is(":hidden")) {       
      $('.message-content-p3').fadeOut(500);
      $('.message-content-p4').delay(700).fadeIn(500);

        }

      });

    </script>

    <script>
    $(".message-content-p5").hide();
    $('.m_p5').click(function () {
        if ($('.message-content-p5').is(":hidden")) {       
      $('.message-content-p4').fadeOut(500);
      $('.message-content-p5').delay(700).fadeIn(500);

        }

      });

    </script>

    <script>
    $(".message-content-p6").hide();
    $('.m_p6').click(function () {
        if ($('.message-content-p6').is(":hidden")) {       
      $('.message-content-p5').fadeOut(500);
      $('.message-content-p6').delay(700).fadeIn(500);

        }

      });

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:40:00.187

这看起来非常手动，对于任何数量的页面都不是很可扩展。

为什么您不只是为每个“页面”设置相同的类，并且在单击确定要跳到哪些页面的任何控件时，只需淡出所有页面，然后仅淡入与该控件的索引值相对应的页面被点击？例如，假设您的所有消息“页面”都具有类`.message-content`，假设您有一组按钮都具有类`.m`。您的 jQuery 可能看起来像这样：

```
$('.m').click(function() {
    $('.message-content').fadeOut(500);
    var index = $(this).index();
    $('.message-content').get(index).delay(700).fadeIn(500);
} 
```

# opengl - 2 opengl中的通过效果

> ID：14076514
> 
> 赞同：2
> 
> 时间：2012-12-28T22:20:12.130
> 
> 标签：opengl, shader, fbo

我尝试在 OpenGL 中使用 FBO 创建一个 2 通道效果。

在第一遍中，我将深度写入颜色缓冲区（图 1）：

![在此处输入图像描述](../Images/c6c8df5696f325386febf2d5ee302a6f.png)

在其顶点着色器中使用以下内容：

```
gl_Position = projection * view * gl_Vertex;
vec4 position = gl_Position/gl_Position.w;
position = position / 2.0 + 0.5;
float temp_depth = position.z;
gl_FrontColor = vec4(temp_depth,temp_depth,temp_depth,1); 
```

在第二遍中，我尝试使用上一遍中的纹理并为场景着色（图 2）：

![在此处输入图像描述](../Images/7af384fa76b1bd19cc842158184d02db.png)

这是顶点着色器中的代码：

```
vec4 shadow_coord  = projection * view * gl_Vertex;
shadow_coord = shadow_coord / shadow_coord.w;
shadow_coord = shadow_coord / 2.0 + 0.5;
gl_FrontColor  = texture2D(light_depth_texture, shadow_coord.xy); 
```

场景由圆锥体前面的四边形组成。在这两种情况下，片段着色器都是。两种情况下`gl_FragColor = gl_Color;`的视图和投影矩阵在开始时定义的完全相同。问题是 shadow_coord.xy 存在偏差。

只要视图和投影值完全相同，我不应该得到相同的结果吗？

我能做些什么来修复它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T23:18:52.440

您渲染的纹理使用什么分辨率？以及什么样的过滤？（似乎是线性的，应该是最近的）。还尝试偏移您读取的坐标，例如：

```
// offset should be 0.5 / texture_resolution
gl_FrontColor  = texture2D(light_depth_texture, shadow_coord.xy + offset); 
```

正如其他评论者所提到的，8 位不足以存储深度值，请考虑使用深度纹理或浮点格式（如 ARB_texture_rg 中的[GL_R32F](http://www.opengl.org/registry/specs/ARB/texture_rg.txt)）。

# c++ - 在我执行某个功能后，尝试读取文件总是会导致错误

> ID：14076516
> 
> 赞同：1
> 
> 时间：2012-12-28T22:20:18.477
> 
> 标签：c++, file-io

这可能与问题无关，但这里是上下文：我一直在关注关于 OpenGL 的教程，并决定在寻找可能更好的实现之前尝试创建自己的骨骼系统。
这就是问题所在：我为我的骨架文件创建了一个简单的基于文本的格式。我还加载了一个 OBJ 文件、两个 GLSL 着色器和一个 PNG 格式的纹理。（以防万一，我使用来自[nothings.org](http://nothings.org/)的 STB Image 加载纹理）。我之前所有的文件加载都是成功的。加载骨架文件是成功的，但是**在我加载骨架文件之后，所有后续加载文件的尝试都失败了**，产生各种错误，具体取决于函数调用的位置。在我更喜欢它的位置，它会产生一个 SIGABRT。

这是我初始化骨架的代码，包括：

```
#include <stdio.h>
#include <iostream>
#include <sstream>
#include <fstream>
#include <cstring>
#include <glm/glm.hpp>
#include <glm/gtc/matrix_transform.hpp>

#include "model_stuff.hpp"
#include "skeleton_stuff.hpp"

void Skeleton::init(const char *sklfile) {
  std::ifstream in(sklfile, std::ios::in);
  if (!in) { std::cerr << "Cannot open " << sklfile << std::endl; exit(1); }

  std::string line;
  getline(in, line);
  if(line.substr(0,2) == "i ") {
    std::istringstream s(line.substr(2));
    s >> this->numBinds;
    this->boneBinds = new BoneBind[numBinds];
  } else {
    std::cerr << "Error: Missing information line for " << sklfile << std::endl; exit(1);
  }
  while (getline(in, line)) {
    if(line.substr(0,2) == "b ") {
      std::istringstream s(line.substr(2));
      std::string name;
      s >> name;
      glm::vec4 pos;
      s >> pos.x; s >> pos.y; s >> pos.z; pos.w = 1.0f;
    } else if(line.substr(0,2) == "v ") {
      std::istringstream s(line.substr(2));
      int v;
      s >> v;
      std::vector<Bone*> bones;
      while(!s.eof()) {
        std::string str;
        s >> str;
        bones.push_back(this->boneNamed(str));
      }
      float boneweight = 1.0f;
      if(bones.size() > 0) {
        boneweight = 0.5f;
      }
      boneBinds[v].boneweight = bones.size();
      boneBinds[v].childbone = bones[0];
      if(boneweight != 1.0f) {
        boneBinds[v].superbone = bones[1];
      } else {
        boneBinds[v].superbone = bones[0];
      }
    }
  }
} 
```

这是 gdb 的输出：

```
(gdb) run
Starting program: /home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
*** glibc detected *** /home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model: free(): invalid next size (normal): 0x0000000000d630c0 ***
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(+0x7e626)[0x7ffff6b7a626]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(_mesa_symbol_table_dtor+0x55)[0x7ffff4537bb5]
/usr/lib/x86_64-linux-gnu/dri/libglsl.so(_ZN17glsl_symbol_tableD1Ev+0xd)[0x7ffff41024dd]
/usr/lib/x86_64-linux-gnu/dri/libglsl.so(_Z22cross_validate_globalsP17gl_shader_programPP9gl_shaderjb+0x116)[0x7ffff4112306]
/usr/lib/x86_64-linux-gnu/dri/libglsl.so(_Z12link_shadersP10gl_contextP17gl_shader_program+0x260)[0x7ffff4113e40]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(_mesa_glsl_link_shader+0xfb)[0x7ffff459e21b]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(_mesa_get_fixed_func_fragment_program+0xa59)[0x7ffff4592c39]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(_mesa_update_state_locked+0x872)[0x7ffff44978e2]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(_mesa_update_state+0x11)[0x7ffff4497d51]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(+0xcfc48)[0x7ffff44a9c48]
/usr/lib/x86_64-linux-gnu/dri/libdricore.so(_mesa_TexImage2D+0x54)[0x7ffff44aa364]
/home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model[0x418b1d]
/home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model[0x419a28]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xed)[0x7ffff6b1d76d]
/home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model[0x403339]
======= Memory map: ========
00400000-00423000 r-xp 00000000 08:05 4456901                            /home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model
00622000-00623000 r--p 00022000 08:05 4456901                            /home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model
00623000-00624000 rw-p 00023000 08:05 4456901                            /home/pitzik4/Dropbox/Pitzik4/cppWorkspaces/glTestWorkspace/Triangle2/bin/model
00624000-00d7e000 rw-p 00000000 00:00 0                                  [heap]
7ffff2efb000-7ffff3841000 rw-p 00000000 00:00 0 
7ffff3841000-7ffff3857000 r-xp 00000000 08:05 1576592                    /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7ffff3857000-7ffff3a56000 ---p 00016000 08:05 1576592                    /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7ffff3a56000-7ffff3a57000 r--p 00015000 08:05 1576592                    /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7ffff3a57000-7ffff3a58000 rw-p 00016000 08:05 1576592                    /lib/x86_64-linux-gnu/libz.so.1.2.3.4
7ffff3a58000-7ffff3a60000 r-xp 00000000 08:05 5120173                    /usr/lib/x86_64-linux-gnu/libpciaccess.so.0.11.0
7ffff3a60000-7ffff3c5f000 ---p 00008000 08:05 5120173                    /usr/lib/x86_64-linux-gnu/libpciaccess.so.0.11.0
7ffff3c5f000-7ffff3c60000 r--p 00007000 08:05 5120173                    /usr/lib/x86_64-linux-gnu/libpciaccess.so.0.11.0
7ffff3c60000-7ffff3c61000 rw-p 00008000 08:05 5120173                    /usr/lib/x86_64-linux-gnu/libpciaccess.so.0.11.0
7ffff3c61000-7ffff3c7d000 r-xp 00000000 08:05 5119862                    /usr/lib/x86_64-linux-gnu/libdrm_intel.so.1.0.0
7ffff3c7d000-7ffff3e7c000 ---p 0001c000 08:05 5119862                    /usr/lib/x86_64-linux-gnu/libdrm_intel.so.1.0.0
7ffff3e7c000-7ffff3e7d000 r--p 0001b000 08:05 5119862                    /usr/lib/x86_64-linux-gnu/libdrm_intel.so.1.0.0
7ffff3e7d000-7ffff3e7e000 rw-p 0001c000 08:05 5119862                    /usr/lib/x86_64-linux-gnu/libdrm_intel.so.1.0.0
7ffff3e7e000-7ffff3ea5000 r-xp 00000000 08:05 1576499                    /lib/x86_64-linux-gnu/libexpat.so.1.5.2
7ffff3ea5000-7ffff40a5000 ---p 00027000 08:05 1576499                    /lib/x86_64-linux-gnu/libexpat.so.1.5.2
7ffff40a5000-7ffff40a7000 r--p 00027000 08:05 1576499                    /lib/x86_64-linux-gnu/libexpat.so.1.5.2
7ffff40a7000-7ffff40a8000 rw-p 00029000 08:05 1576499                    /lib/x86_64-linux-gnu/libexpat.so.1.5.2
7ffff40a8000-7ffff41ce000 r-xp 00000000 08:05 1569                       /usr/lib/x86_64-linux-gnu/dri/libglsl.so
7ffff41ce000-7ffff43cd000 ---p 00126000 08:05 1569                       /usr/lib/x86_64-linux-gnu/dri/libglsl.so
7ffff43cd000-7ffff43d6000 r--p 00125000 08:05 1569                       /usr/lib/x86_64-linux-gnu/dri/libglsl.so
7ffff43d6000-7ffff43d9000 rw-p 0012e000 08:05 1569                       /usr/lib/x86_64-linux-gnu/dri/libglsl.so
7ffff43d9000-7ffff43da000 rw-p 00000000 00:00 0 
7ffff43da000-7ffff4618000 r-xp 00000000 08:05 1570                       /usr/lib/x86_64-linux-gnu/dri/libdricore.so
7ffff4618000-7ffff4818000 ---p 0023e000 08:05 1570                       /usr/lib/x86_64-linux-gnu/dri/libdricore.so
7ffff4818000-7ffff4822000 r--p 0023e000 08:05 1570                       /usr/lib/x86_64-linux-gnu/dri/libdricore.so
7ffff4822000-7ffff4825000 rw-p 00248000 08:05 1570                       /usr/lib/x86_64-linux-gnu/dri/libdricore.so
7ffff4825000-7ffff483b000 rw-p 00000000 00:00 0 
7ffff483b000-7ffff4909000 r-xp 00000000 08:05 1334                       /usr/lib/x86_64-linux-gnu/dri/i965_dri.so
7ffff4909000-7ffff4b09000 ---p 000ce000 08:05 1334                       /usr/lib/x86_64-linux-gnu/dri/i965_dri.so
7ffff4b09000-7ffff4b0c000 r--p 000ce000 08:05 1334                       /usr/lib/x86_64-linux-gnu/dri/i965_dri.so
7ffff4b0c000-7ffff4b10000 rw-p 000d1000 08:05 1334                       /usr/lib/x86_64-linux-gnu/dri/i965_dri.so
7ffff4b10000-7ffff4b17000 r-xp 00000000 08:05 1576567                    /lib/x86_64-linux-gnu/librt-2.15.so
7ffff4b17000-7ffff4d16000 ---p 00007000 08:05 1576567                    /lib/x86_64-linux-gnu/librt-2.15.so
7ffff4d16000-7ffff4d17000 r--p 00006000 08:05 1576567                    /lib/x86_64-linux-gnu/librt-2.15.so
7ffff4d17000-7ffff4d18000 rw-p 00007000 08:05 1576567                    /lib/x86_64-linux-gnu/librt-2.15.so
7ffff4d18000-7ffff4d1d000 r-xp 00000000 08:05 5119694                    /usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0
7ffff4d1d000-7ffff4f1c000 ---p 00005000 08:05 5119694                    /usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0
7ffff4f1c000-7ffff4f1d000 r--p 00004000 08:05 5119694                    /usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0
7ffff4f1d000-7ffff4f1e000 rw-p 00005000 08:05 5119694                    /usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0
7ffff4f1e000-7ffff4f20000 r-xp 00000000 08:05 5119681                    /usr/lib/x86_64-linux-gnu/libXau.so.6.0.0
7ffff4f20000-7ffff511f000 ---p 00002000 08:05 5119681                    /usr/lib/x86_64-linux-gnu/libXau.so.6.0.0
7ffff511f000-7ffff5120000 r--p 00001000 08:05 5119681                    /usr/lib/x86_64-linux-gnu/libXau.so.6.0.0
7ffff5120000-7ffff5121000 rw-p 00002000 08:05 5119681                    /usr/lib/x86_64-linux-gnu/libXau.so.6.0.0
7ffff5121000-7ffff5123000 r-xp 00000000 08:05 1576494                    /lib/x86_64-linux-gnu/libdl-2.15.so
7ffff5123000-7ffff5323000 ---p 00002000 08:05 1576494                    /lib/x86_64-linux-gnu/libdl-2.15.so
7ffff5323000-7ffff5324000 r--p 00002000 08:05 1576494                    /lib/x86_64-linux-gnu/libdl-2.15.so
7ffff5324000-7ffff5325000 rw-p 00003000 08:05 1576494                    /lib/x86_64-linux-gnu/libdl-2.15.so
7ffff5325000-7ffff532f000 r-xp 00000000 08:05 5119860                    /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0
7ffff532f000-7ffff552e000 ---p 0000a000 08:05 5119860                    /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0
7ffff552e000-7ffff552f000 r--p 00009000 08:05 5119860                    /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0
7ffff552f000-7ffff5530000 rw-p 0000a000 08:05 5119860                    /usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0
7ffff5530000-7ffff5534000 r-xp 00000000 08:05 5119726                    /usr/lib/x86_64-linux-gnu/libXxf86vm.so.1.0.0
7ffff5534000-7ffff5733000 ---p 00004000 08:05 5119726                    /usr/lib/x86_64-linux-gnu/libXxf86vm.so.1.0.0
7ffff5733000-7ffff5734000 r--p 00003000 08:05 5119726                    /usr/lib/x86_64-linux-gnu/libXxf86vm.so.1.0.0
7ffff5734000-7ffff5735000 rw-p 00004000 08:05 5119726                    /usr/lib/x86_64-linux-gnu/libXxf86vm.so.1.0.0
7ffff5735000-7ffff5752000 r-xp 00000000 08:05 5120366                    /usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0
7ffff5752000-7ffff5951000 ---p 0001d000 08:05 5120366                    /usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0
7ffff5951000-7ffff5952000 r--p 0001c000 08:05 5120366                    /usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0
7ffff5952000-7ffff5953000 rw-p 0001d000 08:05 5120366                    /usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0
7ffff5953000-7ffff5968000 r-xp 00000000 08:05 5120350                    /usr/lib/x86_64-linux-gnu/libxcb-glx.so.0.0.0
7ffff5968000-7ffff5b67000 ---p 00015000 08:05 5120350                    /usr/lib/x86_64-linux-gnu/libxcb-glx.so.0.0.0
7ffff5b67000-7ffff5b69000 r--p 00014000 08:05 5120350                    /usr/lib/x86_64-linux-gnu/libxcb-glx.so.0.0.0
7ffff5b69000-7ffff5b6a000 rw-p 00016000 08:05 5120350                    /usr/lib/x86_64-linux-gnu/libxcb-glx.so.0.0.0
7ffff5b6a000-7ffff5b6b000 r-xp 00000000 08:05 5119673                    /usr/lib/x86_64-linux-gnu/libX11-xcb.so.1.0.0
7ffff5b6b000-7ffff5d6a000 ---p 00001000 08:05 5119673                    /usr/lib/x86_64-linux-gnu/libX11-xcb.so.1.0.0
7ffff5d6a000-7ffff5d6b000 r--p 00000000 08:05 5119673                    /usr/lib/x86_64-linux-gnu/libX11-xcb.so.1.0.0
7ffff5d6b000-7ffff5d6c000 rw-p 00001000 08:05 5119673                    /usr/lib/x86_64-linux-gnu/libX11-xcb.so.1.0.0
7ffff5d6c000-7ffff5d71000 r-xp 00000000 08:05 5119698                    /usr/lib/x86_64-linux-gnu/libXfixes.so.3.1.0
7ffff5d71000-7ffff5f70000 ---p 00005000 08:05 5119698                    /usr/lib/x86_64-linux-gnu/libXfixes.so.3.1.0
7ffff5f70000-7ffff5f71000 r--p 00004000 08:05 5119698                    /usr/lib/x86_64-linux-gnu/libXfixes.so.3.1.0
7ffff5f71000-7ffff5f72000 rw-p 00005000 08:05 5119698                    /usr/lib/x86_64-linux-gnu/libXfixes.so.3.1.0
7ffff5f72000-7ffff5f74000 r-xp 00000000 08:05 5119690                    /usr/lib/x86_64-linux-gnu/libXdamage.so.1.1.0
7ffff5f74000-7ffff6173000 ---p 00002000 08:05 5119690                    /usr/lib/x86_64-linux-gnu/libXdamage.so.1.1.0
7ffff6173000-7ffff6174000 r--p 00001000 08:05 5119690                    /usr/lib/x86_64-linux-gnu/libXdamage.so.1.1.0
7ffff6174000-7ffff6175000 rw-p 00002000 08:05 5119690                    /usr/lib/x86_64-linux-gnu/libXdamage.so.1.1.0
7ffff6175000-7ffff6185000 r-xp 00000000 08:05 5119696                    /usr/lib/x86_64-linux-gnu/libXext.so.6.4.0
7ffff6185000-7ffff6384000 ---p 00010000 08:05 5119696                    /usr/lib/x86_64-linux-gnu/libXext.so.6.4.0
7ffff6384000-7ffff6385000 r--p 0000f000 08:05 5119696                    /usr/lib/x86_64-linux-gnu/libXext.so.6.4.0
7ffff6385000-7ffff6386000 rw-p 00010000 08:05 5119696                    /usr/lib/x86_64-linux-gnu/libXext.so.6.4.0
7ffff6386000-7ffff63a7000 r-xp 00000000 08:05 5126526                    /usr/lib/x86_64-linux-gnu/libglapi.so.0.0.0
7ffff63a7000-7ffff65a6000 ---p 00021000 08:05 5126526                    /usr/lib/x86_64-linux-gnu/libglapi.so.0.0.0
7ffff65a6000-7ffff65a9000 r--p 00020000 08:05 5126526                    /usr/lib/x86_64-linux-gnu/libglapi.so.0.0.0
7ffff65a9000-7ffff65aa000 rw-p 00023000 08:05 5126526                    /usr/lib/x86_64-linux-gnu/libglapi.so.0.0.0
7ffff65aa000-7ffff65ab000 rw-p 00000000 00:00 0 
7ffff65ab000-7ffff66da000 r-xp 00000000 08:05 5119677                    /usr/lib/x86_64-linux-gnu/libX11.so.6.3.0
7ffff66da000-7ffff68da000 ---p 0012f000 08:05 5119677                    /usr/lib/x86_64-linux-gnu/libX11.so.6.3.0
7ffff68da000-7ffff68db000 r--p 0012f000 08:05 5119677                    /usr/lib/x86_64-linux-gnu/libX11.so.6.3.0
7ffff68db000-7ffff68df000 rw-p 00130000 08:05 5119677                    /usr/lib/x86_64-linux-gnu/libX11.so.6.3.0
7ffff68df000-7ffff68f7000 r-xp 00000000 08:05 1576561                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff68f7000-7ffff6af6000 ---p 00018000 08:05 1576561                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff6af6000-7ffff6af7000 r--p 00017000 08:05 1576561                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff6af7000-7ffff6af8000 rw-p 00018000 08:05 1576561                    /lib/x86_64-linux-gnu/libpthread-2.15.so
7ffff6af8000-7ffff6afc000 rw-p 00000000 00:00 0 
7ffff6afc000-7ffff6caf000 r-xp 00000000 08:05 1576481                    /lib/x86_64-linux-gnu/libc-2.15.so
7ffff6caf000-7ffff6eae000 ---p 001b3000 08:05 1576481                    /lib/x86_64-linux-gnu/libc-2.15.so
7ffff6eae000-7ffff6eb2000 r--p 001b2000 08:05 1576481                    /lib/x86_64-linux-gnu/libc-2.15.so
7ffff6eb2000-7ffff6eb4000 rw-p 001b6000 08:05 1576481                    /lib/x86_64-linux-gnu/libc-2.15.so
7ffff6eb4000-7ffff6eb9000 rw-p 00000000 00:00 0 
7ffff6eb9000-7ffff6ece000 r-xp 00000000 08:05 1576502                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff6ece000-7ffff70cd000 ---p 00015000 08:05 1576502                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff70cd000-7ffff70ce000 r--p 00014000 08:05 1576502                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff70ce000-7ffff70cf000 rw-p 00015000 08:05 1576502                    /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff70cf000-7ffff71c8000 r-xp 00000000 08:05 1576513                    /lib/x86_64-linux-gnu/libm-2.15.so
7ffff71c8000-7ffff73c7000 ---p 000f9000 08:05 1576513                    /lib/x86_64-linux-gnu/libm-2.15.so
7ffff73c7000-7ffff73c8000 r--p 000f8000 08:05 1576513                    /lib/x86_64-linux-gnu/libm-2.15.so
7ffff73c8000-7ffff73c9000 rw-p 000f9000 08:05 1576513                    /lib/x86_64-linux-gnu/libm-2.15.so
7ffff73c9000-7ffff74ab000 r-xp 00000000 08:05 5120266                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff74ab000-7ffff76aa000 ---p 000e2000 08:05 5120266                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff76aa000-7ffff76b2000 r--p 000e1000 08:05 5120266                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff76b2000-7ffff76b4000 rw-p 000e9000 08:05 5120266                    /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.16
7ffff76b4000-7ffff76c9000 rw-p 00000000 00:00 0 
7ffff76c9000-7ffff7726000 r-xp 00000000 08:05 2898                       /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2
7ffff7726000-7ffff7925000 ---p 0005d000 08:05 2898                       /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2
7ffff7925000-7ffff7927000 r--p 0005c000 08:05 2898                       /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2
7ffff7927000-7ffff7928000 rw-p 0005e000 08:05 2898                       /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1.2
7ffff7928000-7ffff7929000 rw-p 00000000 00:00 0 
7ffff7929000-7ffff798a000 r-xp 00000000 08:05 5119616                    /usr/lib/x86_64-linux-gnu/libGLEW.so.1.6.0
7ffff798a000-7ffff7b89000 ---p 00061000 08:05 5119616                    /usr/lib/x86_64-linux-gnu/libGLEW.so.1.6.0
7ffff7b89000-7ffff7b8f000 r--p 00060000 08:05 5119616                    /usr/lib/x86_64-linux-gnu/libGLEW.so.1.6.0
7ffff7b8f000-7ffff7b90000 rw-p 00066000 08:05 5119616                    /usr/lib/x86_64-linux-gnu/libGLEW.so.1.6.0
7ffff7b90000-7ffff7b94000 rw-p 00000000 00:00 0 
Program received signal SIGABRT, Aborted.
0x00007ffff6b32445 in raise () from /lib/x86_64-linux-gnu/libc.so.6
(gdb) bt
#0  0x00007ffff6b32445 in raise () from /lib/x86_64-linux-gnu/libc.so.6
#1  0x00007ffff6b35bab in abort () from /lib/x86_64-linux-gnu/libc.so.6
#2  0x00007ffff6b6fe2e in ?? () from /lib/x86_64-linux-gnu/libc.so.6
#3  0x00007ffff6b7a626 in ?? () from /lib/x86_64-linux-gnu/libc.so.6
#4  0x00007ffff4537bb5 in _mesa_symbol_table_dtor ()
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#5  0x00007ffff41024dd in glsl_symbol_table::~glsl_symbol_table() ()
   from /usr/lib/x86_64-linux-gnu/dri/libglsl.so
#6  0x00007ffff4112306 in cross_validate_globals(gl_shader_program*, gl_shader**, unsigned int, bool) () from /usr/lib/x86_64-linux-gnu/dri/libglsl.so
#7  0x00007ffff4113e40 in link_shaders(gl_context*, gl_shader_program*) ()
   from /usr/lib/x86_64-linux-gnu/dri/libglsl.so
#8  0x00007ffff459e21b in _mesa_glsl_link_shader ()
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#9  0x00007ffff4592c39 in _mesa_get_fixed_func_fragment_program ()
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#10 0x00007ffff44978e2 in _mesa_update_state_locked ()
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#11 0x00007ffff4497d51 in _mesa_update_state ()
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#12 0x00007ffff44a9c48 in ?? ()
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#13 0x00007ffff44aa364 in _mesa_TexImage2D ()
---Type <return> to continue, or q <return> to quit---
   from /usr/lib/x86_64-linux-gnu/dri/libdricore.so
#14 0x0000000000418b1d in initResources () at src/model.cpp:126
#15 0x0000000000419a28 in main (argc=1, args=0x7fffffffe7e8)
    at src/model.cpp:350 
```

我正在使用 make 使用 g++ -g 进行编译。我正在运行 64 位 Linux Mint。

这就是我能想到的所有潜在有用的信息。如果我没有在此处提供足够的信息来找到此问题的解决方案，只需添加评论，我将使用信息进行编辑。

所以......我能做些什么来解决这个问题？我一直在间歇性地搜索它并尝试修复它几个小时，但无济于事。

# macos - 如何在 Mac Qt App 中查找非公共 API 的使用情况

> ID：14076518
> 
> 赞同：2
> 
> 时间：2012-12-28T22:20:33.613
> 
> 标签：macos, qt, webkit, app-store, qtwebkit

我们基于 qtwebkit 的应用程序在提交到 mac 应用商店后被苹果拒绝。拒绝的原因之一是使用了非公共 API。我已经在 qtwebkit 的源代码中找到了其中的六个。但我无处可寻其余的。我搜索了我们应用程序的源代码和 QT 的整个源代码。

我在qtwebkit源码中找到的六个非公开api是：

```
CFHTTPCookieStorageSetCookieAcceptPolicy
CFURLCacheCopyResponseForRequest
CFURLResponseGetMIMEType
CFURLResponseCopySuggestedFilename
CFURLCacheSetMemoryCapacity
CFURLCacheSetDiskCapacity 
```

以下是苹果发现的违规行为的完整列表：

> 如果这些 API 将来发生变化，使用非公共 API 可能会导致糟糕的用户体验，因此是不允许的。您的应用程序中包含以下非公共 API：
> 
> NSAccessibilityCreateAXUIElementRef NSAccessibilityHandleFocusChanged NSAccessibilityUnregisterUniqueIdForUIElement NSAppKitPropertyCreator NSCarbonWindowPropertyTag NSMouseMovedNotification _NSDrawCarbonThemeBezel _NSDrawCarbonThemeListBox _NSPopUpCarbonMenu3 _NXShowKeyAndMain 来自框架：'/System/Library/Frameworks/AppKit.framework/App'Versions/
> 
> AXTextMarkerCreate AXTextMarkerGetBytePtr AXTextMarkerGetLength AXTextMarkerGetTypeID AXTextMarkerRangeCopyEndMarker AXTextMarkerRangeCopyStartMarker AXTextMarkerRangeCreate AXTextMarkerRangeGetTypeID CTLineCreateWithUniCharProvider CoreDragGetCurrentDrag CoreDragSetImage 从框架：'/System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices'
> 
> GetNativeWindowFromWindowRef TSMGetInputSourceProperty 从框架：'/System/Library/Frameworks/Carbon.framework/Versions/A/Carbon'
> 
> CFReadStreamSignalEvent _CFAppVersionCheckLessThan _CFBundleSetDefaultLocalization _CFStringGetUserDefaultEncoding 从框架：'/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation'
> 
> CFHTTPCookieStorageCopyCookiesForURL CFHTTPCookieStorageDeleteCookie CFHTTPCookieStorageGetCookieAcceptPolicy CFHTTPCookieStorageSetCookieAcceptPolicy CFHTTPCookieStorageSetCookies CFURLCacheCopyResponseForRequest CFURLCacheSetDiskCapacity CFURLCacheSetMemoryCapacity CFURLRequestCreateMutableCopy CFURLResponseCopySuggestedFilename CFURLResponseGetExpectedContentLength CFURLResponseGetHTTPResponse CFURLResponseGetMIMEType CFURLResponseGetURL CFURLResponseSetExpectedContentLength CFURLResponseSetMIMEType _CFNetworkHTTPConnectionCacheGetLimit _CFNetworkHTTPConnectionCacheSetLimit _CFURLCacheCopyCacheDirectory _CFURLRequestCreateArchiveList _CFURLRequestCreateFromArchiveList _CFURLResponseCreateArchiveList _CFURLResponseCreateFromArchiveList _CFURLResponseGetSSLCertificateContext _LSGetCurrentApplicationASN_LSSetApplicationInformationItem _kLSDisplayNameKey kCFStreamPropertyCONNECTAdditionalHeaders kCFStreamPropertyCONNECTProxy kCFStreamPropertyCONNECTProxyHost kCFStreamPropertyCONNECTProxyPort kCFStreamPropertyCONNECTResponse kCFURLResponseExpectedContentLengthUnknown 从框架：'/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices'
> 
> NSPopAutoreleasePool NSPushAutoreleasePool 来自框架：'/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation'
> 
> CARenderCGDestroy CARenderCGNew CARenderCGRender CARenderNotificationAddObserver CARenderNotificationRemoveObserver CARenderServerGetPort CARenderServerStart CARenderUpdateAddContext CARenderUpdateAddRect CARenderUpdateBegin CARenderUpdateFinish kCAContextPortNumber 从框架：'/System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore'
> 
> 如果您在源代码中定义了与上述 API 同名的方法，我们建议您更改方法名称，以便它们不再与 Apple 的私有 API 冲突，以避免您的应用程序在以后的提交中被标记。
> 
> 此外，一个或多个上述 API 可能驻留在应用程序随附的库中。如果您无权访问该库的源代码，则可以使用“strings”或“otool”命令行工具搜索已编译的二进制文件。“strings”工具可以输出库调用的方法列表，“otool -ov”将输出Objective-C类结构及其定义的方法。这些技术可以帮助您缩小有问题的代码所在的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T04:55:54.793

我终于追溯到了调用这些所谓的私有 api 的位置。它们是从 webkit 内部调用的。webkit使用的是苹果直接提供的webkit系统接口库，格式为编译后的静态库+头文件。更具体地说，它们是位于路径 src\3rdparty\webkit\WebKitLibraries 下的四个文件：

libWebKitSystemInterfaceLeopard.a libWebKitSystemInterfaceLion.a libWebKitSystemInterfaceMountainLion.a libWebKitSystemInterfaceSnowLeopard.a

我一直想知道它是否真的是一个私有 api，如果没有任何文档，还有谁知道如何调用它？现在原来是苹果本身。由于 nokia 或 digia 都没有这些库的源代码，因此他们可能无能为力。

现在，由于来自创建的库的私有 api 访问，任何基于 qtwebkit 的应用程序都会被苹果拒绝，这不是很讽刺吗？

如果我错了或遗漏了什么，请纠正我。我真的希望我错了。

# java - Java 编程挑战：创建类似于 GUI 计算器的界面

> ID：14076524
> 
> 赞同：2
> 
> 时间：2012-12-28T22:21:29.480
> 
> 标签：java, user-interface, event-handling, append, textfield

这大概是个初级问题。但是，我已经阅读了《Java 绝对初学者编程》的第 7 章，并进入了挑战部分。我不能完全让清除按钮来解决挑战问题。

问题问：

> 通过将单击的数字附加到其当前数字的末尾，创建一个使用 Buttons 更新不可编辑的 TextField 的数字小键盘。为 Frame 使用 BorderLayout。在 BorderLayout.NORTH，放置 TextField。在中心，创建一个面板，该面板使用 GridLayout 将按钮 1 到 9 布置在三乘三网格中。在 BorderLayout.SOUTH 处，创建另一个具有零键和“清除”键的面板，用于删除 TextField 中的当前数字。”

我认为我的主要问题在于 TextArea append 方法。我知道我应该使用 TextField，但是根据我所做的研究，似乎不可能在 TextField 中附加。

这个问题的答案可能有助于许多新的 Java 程序员理解基本的 GUI 和事件处理。

```
import java.awt.*;
import java.awt.event.*;

public class CalcFacade extends GUIFrame
                                    implements ActionListener, TextListener {

TextField tf;
TextArea ta;
Panel p1, p2;
Label clear;
Button b1, b2, b3, b4, b5, b6, b7, b8, b9, c, b0;
public CalcFacade() {
    super("Calculator Facade");
    setLayout(new BorderLayout());

Button b1 = new Button("1");
b1.addActionListener(this);
Button b2 = new Button("2");
b2.addActionListener(this);
Button b3 = new Button("3");
b3.addActionListener(this);
Button b4 = new Button("4");
b4.addActionListener(this);
Button b5 = new Button("5");
b5.addActionListener(this);
Button b6 = new Button("6");
b6.addActionListener(this);
Button b7 = new Button("7");
b7.addActionListener(this);
Button b8 = new Button("8");
b8.addActionListener(this);
Button b9 = new Button("9");
b9.addActionListener(this);

Button b0 = new Button("0");
b0.addActionListener(this);

Button c = new Button("Clear");
c.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
    clear.setText("");
}
});
    tf = new TextField(100);
add(tf);
tf.setEnabled(false);
tf.addActionListener(this);
tf.addTextListener(this);
setVisible(false);

ta = new TextArea("", 10, 30);
    add(ta);
    ta.setEnabled(true);
    setVisible(true);

Panel p1 = new Panel();
p1.setLayout(new GridLayout(3, 3));
p1.setBackground(Color.gray);
p1.add(b1);
p1.add(b2);
p1.add(b3);
p1.add(b4);
p1.add(b5);
p1.add(b6);
p1.add(b7);
p1.add(b8);
p1.add(b9);

Panel p2 = new Panel();
p2.setBackground(Color.gray);
p2.add(b0);
p2.add(c);

add(ta, BorderLayout.NORTH);
add(p1, BorderLayout.CENTER);
add(p2, BorderLayout.SOUTH);

pack();
setSize(400, 300);
setVisible(true);
}

public static void main(String args[]) {
    CalcFacade cf = new CalcFacade();
}
public void actionPerformed(ActionEvent e) {
   tf.setText(""
    +((Button)e.getSource()).getLabel());
}

public void textValueChanged(TextEvent e) {
    ta.append(tf.getText());
}
} 
```

我非常感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:06:36.137

TextField 不需要只监听按钮的事件。

要将数字添加到末尾，只需将文本设置为 TextField 中已有的内容加上按钮标签。

只有一个 ActionListener 和一个 actionPerformed 方法；识别按钮并适当设置 TextField 即 c.addActionListener(this);

```
public void actionPerformed(ActionEvent e)
{
    Button b = (Button) e.getSource();

    if (b.getLabel().equals("Clear"))
    {
        tf.setText("");
    }
    else
    {
        tf.setText(tf.getText() + b.getLabel());
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:28:00.113

当我猜你想调用它时，看起来你`ActionListener`的“清除”按钮正在调用。`setText("")``Label clear``TextField tf`

# wordpress - 在Wordpress中，当查询中有多个自定义字段时，如何按自定义字段排序？

> ID：14076528
> 
> 赞同：3
> 
> 时间：2012-12-28T22:22:15.683
> 
> 标签：wordpress, wordpress-theming

我正在编辑在自定义查询中使用自定义字段的现有 Wordpress 主题。我需要编辑查询，以便结果由一个自定义字段过滤，并按第二个自定义字段排序。

这是我到目前为止所尝试的：

```
<?php
$query_args = array();
$query_args['post_type'] = 'woo_estate';
$query_args['meta_query'] = array(
    array(
        'key' => 'on_show',
        'value' => 'true'
    ),
    array(
        'key' => 'price',
        'type' => 'numeric',
    )
);
$query_args['orderby'] = 'price';
$query_args['order'] = 'ASC';

$query_args['posts_per_page'] = $woo_options['woo_more_entries'];
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$query_args['paged'] = $paged;

?>
    <?php query_posts(  $query_args ); ?> 
```

问题是结果继续按默认（日期）而不是`price`自定义字段排序。

如何通过自定义价格字段订购此查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:53:11.343

在此处的文档中挖掘了一下之后：http: [//codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)我能够想出完成我需要的代码。

```
$query_args = array();
$query_args['post_type'] = 'woo_estate';
$query_args['meta_query'] = array(
    array(
        'key' => 'on_show',
        'value' => 'true'
    )
);

$query_args['meta_key'] = 'price';
$query_args['orderby'] = 'meta_value_num';
$query_args['order'] = 'DESC';

$query_args['posts_per_page'] = $woo_options['woo_more_entries'];
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$query_args['paged'] = $paged;

query_posts(    $query_args ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:55:18.210

要按自定义字段排序，您必须`meta_key`在数组中添加并且`orderby`应该是`meta_value`or`meta_value_num`用于数字，所以在这种情况下它应该是`meta_value_num`因为它是数字。

```
$query_args['meta_key'] = 'price';
$query_args['orderby'] = 'meta_value_num';
$query_args['order'] = 'ASC';
$query_args['meta_query'] = array(
    array(
        'key' => 'on_show',
        'value' => 'true'
    )
);
// ... 
```

[这是另一个答案](https://stackoverflow.com/questions/13610836/list-custom-post-type-by-custom-field-date/13611296#13611296)，你也可以看看这个。

# php - 在 android 模拟器或手机上运行时，Ajax 请求在 Eclipse 中不起作用

> ID：14076537
> 
> 赞同：2
> 
> 时间：2012-12-28T22:23:38.767
> 
> 标签：php, jquery, cordova, jquery-mobile

您好，我是 phonegap 和 jquery mobile 的新手，在尝试通过 eclipse 模拟器和我的 htc 手机运行我的应用程序时遇到问题。

当我在 Firefox 中运行应用程序时，我的代码运行良好。HTML调用在tomcat上运行的PHP脚本，php脚本访问mysql并传回jsonp数据。

任何帮助将非常感激。我已经阅读了其他帖子并且没有锁定我的代码。

我已使用以下所有正确权限更新了 android 清单：

```
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" /> 
```

我在下面有我的 html 文件：

```
 <!DOCTYPE HTML>
<html>
<head>

<title>Search by area</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="jquery.mobile.structure-1.2.0.min.css" />
<link rel="stylesheet" href="jquery.mobile-1.2.0.min.css" />
<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
<script type="text/javascript" src="jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="jquery.mobile-1.2.0.min.js"> </script>

</head>
<body> 

    <div id="areas" data-role="page" data-add-back-btn="true">
    <script type="text/javascript">

     // alert dismissed
     function alertMessageDimissed()
     {
        // do something 
     }

     $("#areas").on('pageshow', function() {
                // get the areas from the database 
        $.ajax({
            type:'GET',
            url:'http://localhost/getData.php',
            dataType:'jsonp',
            jsonp: 'jsoncallback',
            timeout: 5000,
            success: function(data, status)
            { 
              $.each(data, function(i,item){
               var addToSession = 'sessionStorage.areaID=' + item.area_id;
                $('#list').append("<li><a href='../www/choose_restaurant.html' onclick=" + addToSession + " data-transition='slidedown'>" + item.area_name + 
                "<span class='ui-li-count'>" + item.deal_count + "</span>" +
                "</a></li>");
                $("#list").listview("refresh");

                });

            },
             error: function(data)
             {
                  // there was no connection to the internet 
                  navigator.notification.alert(
                    'No intenet connection', // message
                     alertMessageDimissed, // callback
                     'Information - Error', // title
                     'Done'                 // buttonName
                    );  

            }
        });
        return false;       
    });
    </script>

        <div data-role="header">

            <h1> Bucuresti deals</h1>

        </div>

        <div data-role="content">

            <div class="choice_list">

                <h1> In which area do you want to eat? </h1>

                <ul id="list" data-role="listview" data-inset="true" data-filter="true" >
                </ul>
            </div>
        </div>
    </div>

</body>
</html> 
```

我的工作 php 脚本如下：

```
<?php
header('Content-type: application/json');

$server = "127.0.0.1:3306";
$username = "root";
$password = "";
$database = "deals";

$con = mysql_connect($server, $username, $password) or die ("Could not connect: " . mysql_error());
mysql_select_db($database, $con);

$sql = "SELECT a.area_id, a.name AS area_name, a.sector AS area_sector,
    (SELECT Count(*) FROM deals.main_deals b WHERE b.areaID = a.area_id) as deal_count
     FROM deals.areas a";

           $result = mysql_query($sql) or die ("Query error: " . mysql_error());

$records = array();

while($row = mysql_fetch_assoc($result)) {
    $records[] = $row;
}

mysql_close($con);

echo $_GET['jsoncallback'].'(' . json_encode($records) . ');';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:26:09.480

在安卓手机上测试时，你不能使用***url:'http://localhost/getData.php' 。***请记住，您不再在本地计算机上。手机的IP地址与您的服务器不同，因此您不再连接到localhost。

# android - CursorLoader - 两个表连接查询？

> ID：14076540
> 
> 赞同：9
> 
> 时间：2012-12-28T22:24:06.590
> 
> 标签：android, join, android-contentprovider, android-cursorloader

我有两个具有 1:1 关系的表，我正在使用内容提供程序和 cursorloader。

**我将如何进行连接查询以使用游标加载器？**我可以在内容提供程序中使用 rawSql 以某种方式破解它，但是如何在游标加载器构造函数中做到这一点超出了我的范围。

非常感谢 ！

```
private static final String CREATE_TABLE_ARTICLES = "create table "
            + TABLE_ARTICLES + "("
            + COLUMN_ARTICLE_ID + " integer primary key autoincrement, "
            + COLUMN_URL + " text not null unique, "
            + COLUMN_TITLE + " text not null, "
            + COLUMN_PRICE + " text not null, "
            + COLUMN_ADDED + " text not null, "
            + COLUMN_IMG_URL + " text);";

    private static final String CREATE_TABLE_ARTICLE_DETAIL = "create table "
            + TABLE_ARTICLE_DETAILS + "("
            + COLUMN_ARTICLE_DETAIL_ID + " integer primary key autoincrement, "
            + COLUMN_DESC + " text not null, "
            + COLUMN_LOCALITY + " text, "
            + COLUMN_TYPE + " text not null, "
            + COLUMN_SELLER + " text not null, "
            + COLUMN_SELLER_PHONE + " text, "
            + COLUMN_IMAGE_COUNT + " integer default 0, "
            + COLUMN_ARTICLE + " integer, foreign key (" + COLUMN_ARTICLE + ") references " + TABLE_ARTICLES + "(" + COLUMN_ARTICLE_ID + "));"; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-15T01:00:30.227

实际上，您不必使用自定义任务加载器。简而言之，一种解决方案是创建一个 Uri“content://AUTHORITY/TableArticlesWithDetail”。然后在您的内容提供程序中，检查该 Uri 并执行原始 SQL 来执行连接。

详情请参阅[CursorLoader 的构造函数不支持时如何在 CursorLoader 中使用连接查询](https://stackoverflow.com/questions/14090695/how-to-use-join-query-in-cursorloader-when-its-constructor-does-not-support-it)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-02T04:28:25.230

最简单的解决方案是创建一个视图来连接您的表并使用 Uri 从您的 CursorLoader 访问该视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-21T09:28:07.623

```
Cursor c = db.query(
    RefuelTable.TABLE_NAME + " , " + ExpenseTable.TABLE_NAME,
    Utils.concat(RefuelTable.PROJECTION, ExpenseTable.PROJECTION),
     RefuelTable.EXP_ID + " = " + ExpenseTable.ID + " AND  "  +    RuelTable.ID + " = " +  id ,
    null,
    null,
    null,
    null); 
```

**这样做**

# android - 运行时错误创建意图

> ID：14076544
> 
> 赞同：0
> 
> 时间：2012-12-28T22:24:43.133
> 
> 标签：android, android-intent

我正在尝试为我正在创建的库创建一个测试应用程序。当我的库被调用时，它会创建一个意图并启动一个活动。

```
intent = new Intent(getApplicationContext(), video_on_load.class);
myLib.this.startActivity(intent); 
```

我的程序似乎我的程序在创建新 Intent 时崩溃了。我试图解释为什么会发生这种情况，我发现在我的应用程序中我必须对 AndroidManafest 进行活动，所以我在清单中添加了以下行：

```
activity android:name="com.example.myLib.video_on_load"></activity> 
```

但是，我的应用程序仍然崩溃，并显示“不幸的是，TestApp 已停止”的消息。我不确定如何继续。我对 android 编程相当陌生，所以这可能是我错过的一些简单的事情。如果您需要任何其他有助于调试此问题的信息，请告诉我。

我的 video_on_load 类如下：

```
public class video_on_load extends Activity {
    private RelativeLayout layout;
    private ProgressBar progressBar;    

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.video_on_load);

        layout = (RelativeLayout) findViewById(R.id.video_onLoad_layout);
        progressBar = (ProgressBar) findViewById(R.id.video_onLoad_progress);
    } 
```

编辑：

相关LogCat：

```
 12-28 17:53:23.824: E/AndroidRuntime(25042): java.lang.NullPointerException
  12-28 17:53:23.824: E/AndroidRuntime(25042):  at android.content.ContextWrapper.getPackageName(ContextWrapper.java:135)
  12-28 17:53:23.824: E/AndroidRuntime(25042):  at android.content.ComponentName.<init>(ComponentName.java:75)
  12-28 17:53:23.824: E/AndroidRuntime(25042):  at android.content.Intent.<init>(Intent.java:3491) 
```

video_on_load.xml：

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:id="@+id/video_onLoad_layout" >

<ProgressBar android:id="@+id/video_onLoad_progress"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_centerInParent="true"
             style="@android:style/Widget.ProgressBar.Large" />

</RelativeLayout> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:51:46.727

改变

```
intent = new Intent(getApplicationContext(), video_on_load.class);
myLib.this.startActivity(intent); 
```

进入：

```
intent = new Intent(this, video_on_load.class);
startActivity(intent); 
```

只要您将此代码放在 Activity 中的某个位置，就可以开始了。注意，一个应用程序有一个上下文，应用程序有活动，活动也有一个上下文。尝试阅读有关活动和上下文的一些文档以获得更好的理解。

您的错误消息显示您的调用中有些内容为空，并且与 getApplicationContext() 有关。祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:33:05.817

您没有遵循命名约定，所以事情可能会令人困惑。您的布局是“R.layout.video_on_load”，您的嵌套相对布局是“R.layout.video_onLoad_layout”。该 id 是否实际在 XML 布局文件中为“R.layout.video_on_load”声明，或者进度条可能不存在于您调用 findViewById(id) 时会导致空指针错误。我们可以查看您的布局的 XML 文件吗？

更正您分配给变量的资源 ID。

# javascript - Javascript 转换时间戳

> ID：14076550
> 
> 赞同：1
> 
> 时间：2012-12-28T22:25:15.497
> 
> 标签：javascript, datetime, timestamp, date-formatting

我有一个格式为“2012-12-20 21:34:09”的日期。
如何在格式中格式化`dd/mm/yyyy`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:33:26.927

你可以试试

```
var mydate = '2012-12-20 21:34:09';
var formatteddate = mydate.split(' ')[0].split('-').reverse().join('/'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:33:57.627

这应该这样做。

```
var date = new Date(Date.parse("2012-12-20 21:34:09"));
var converted = date.getDate() + "/" + (date.getMonth()+1) + "/" + date.getFullYear(); 
```

​<strong>值得注意的是，这仅适用于 Chrome 和 Opera。（感谢 Gaby aka G. Pertrioli）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T10:03:26.457

使用 RegExp 的强大功能变得非常简单：

```
"2012-12-20 21:34:09".replace(/^(\d+)-(\d+)-(\d+).*/, '$3/$2/$1'); 
```

返回`"20/12/2012"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T22:35:41.860

您可以解析日期并重新打印它。像这样的东西：

```
var date = new Date( Date.parse( "2012-12-20 21:34:09" ) );
var formattedDate = date.getDate() + "/" + ( date.getMonth() + 1 ) + "/" + date.getFullYear(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-28T22:43:04.237

其他答案均不处理零填充，这意味着它们不适合其他日期的 dd/mm/yyyy 格式。

```
var date = new Date("2012-12-20 21:34:09");

var converted = String("0" + date.getDate()).slice(-2);
converted += "/" + String("0" + date.getMonth()+1).slice(-2);
converted += "/" + date.getFullYear();

alert(converted); 
```

**编辑**

跨浏览器版本：

```
var parts = "2012-12-20 21:34:09".split(" ")[0].split("-");

var converted = String("0" + parts[1]).slice(-2);
converted += "/" + String("0" + parts[2]).slice(-2);
converted += "/" + parts[0];

alert(converted); 
```

# javascript - 执行上下文 - 创建和激活阶段

> ID：14076551
> 
> 赞同：-1
> 
> 时间：2012-12-28T22:25:22.720
> 
> 标签：javascript

我正在阅读[这篇文章](http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/)，它真的很棒。我只想问一些目前正在我脑海中的问题。

```
function foo(i) {
    var a = 'hello';
    var b = function privateB() {

    };
    function c() {

    }
}

foo(22); 
```

在调用 foo(22) 时，创建阶段如下所示：

```
fooExecutionContext = {
    variableObject: {
        arguments: {
            0: 22,
            length: 1
        },
        i: 22,
        c: pointer to function c()
        a: undefined,
        b: undefined
    },
    scopeChain: { ... },
    this: { ... }
} 
```

1.  为什么长度是一。
2.  scopeChain 键包含什么。
3.  这也指什么。[它是指全局上下文`or`还是函数上下文]
4.  谁能指出我可以尝试的同一主题的另一个资源和示例。

**我对 JS 方面很陌生。我只是想纠正自己并从你们那里得到更多的澄清......所以我没有错。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T01:34:33.097

调用函数时，`ExecutionContext`会创建 an。这定义了函数环境中的很大一部分。

**1.为什么长度是一。**

现在让我们看看你的函数，`arguements`创建了属性。该对象包含一个长度（即传递给函数的参数数量）

现在让我们看看下面的例子。

```
function myFun1(a,b){
     function myFunc2(){
         alert("hello");
     }
}

myFun1(10,20); 
```

myFun1 中的 ExecutionContext

```
ExecutionContext: {
      variableObject: {
        arguments: {
           0: '10', 1: '20', 
           length: 2
       }
     }
} 
```

**2.这也指什么。[是指全局上下文还是函数上下文]**

`this`属性被创建，它取决于函数的调用方式。

1.  常规函数** `myFunction(args)`=> 它将引用全局对象...即窗口对象。
2.  对象方法`object.myFunction(args)`=> 它将引用对象。
3.  回调 for `call() or apply().`this 的值是第一个参数`call()/apply().`
4.  作为构造函数`(new myFunction(1,2,3))`。this 的值是一个以 myFunction.prototype 为原型的空对象。

# linq - 加入 GROUP 的查询

> ID：14076553
> 
> 赞同：2
> 
> 时间：2012-12-28T22:25:34.753
> 
> 标签：linq, entity-framework

我是 LINQ 新手，我有这个查询，它返回调查中的页面。（无论出于何种原因，这些值都没有具体化到表中。）

```
//Group all of this data by page 
var pages = from fq in db.FormQuestions
        where (fq.FormId == id) && fq.Disabled == false
        group fq by fq.PageNumber into p
        select new DTOs.PageDTO { PageNumber = p.Key.Value }; 
```

然后我有这个查询，它将所有的叶子数据投影到 DTO 中。

```
var questions = from fq in db.FormQuestions
   join q in db.Questions on fq.QuestionId equals q.QuestionId
   where (fq.FormId == id) && fq.Disabled == false
   //where (fq.FormId == id) && fq.Disabled == false && fq.PageNumber == page
   orderby fq.DisplayOrder
   select new DTOs.FormQuestionDTO()
   {
       DisplayOrder = (fq.DisplayOrder.HasValue ? fq.DisplayOrder.Value : 0),
       PageNumber = (fq.PageNumber.HasValue ? fq.PageNumber.Value : 0),
       QuestionId = q.QuestionId,
       QuestionSelectionMode = q.vts_tbQuestionSelectionMode.Description,
       QuestionText = q.QuestionText,
       Answers =
           from answer in q.Answers
           join at in db.AnswerTypes on answer.AnswerTypeId equals at.AnswerTypeID
           where answer.Disabled == false
           orderby answer.DisplayOrder
           select new DTOs.AnswerDTO()
           {
               AnswerId = answer.AnswerId,
               AnswerText = answer.AnswerText,
               DisplayOrder = answer.DisplayOrder,
               AnswerType = at.Description
           }
   }; 
```

有没有办法巧妙地加入这两个？即，在每个页面 DTO 下，我想查看 QUEstion DTO，然后在该 Answer DTO 内部，然后……

此外，即使我可以在一个 LINQ 语句中完成所有这些操作，是否最好单独构建 LINQ 语句然后合并它们？这感觉有点像在 SQL 中构建临时变量，因为它可能构建一个巨大的查询，但维护起来很痛苦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T23:25:59.687

那么为什么不这样的工作呢？

```
//Group all of this data by page 
var pages = from fq in db.FormQuestions
        where (fq.FormId == id) && fq.Disabled == false
        group fq by fq.PageNumber into p
        select new DTOs.PageDTO { 
          PageNumber = p.Key.Value 
          questions = from fq in db.FormQuestions
                     join q in db.Questions on fq.QuestionId equals q.QuestionId
                     where (fq.FormId == id) && fq.Disabled == false
                     orderby fq.DisplayOrder
                     select new DTOs.FormQuestionDTO()
                     {
                       DisplayOrder = (fq.DisplayOrder.HasValue ? fq.DisplayOrder.Value : 0),
                       // etc as you 2nd code sample 
```

# emacs - 模式局部错误

> ID：14076555
> 
> 赞同：0
> 
> 时间：2012-12-28T22:25:44.783
> 
> 标签：emacs, elisp

是否可以仅针对特定模式/缓冲区使用 defadvice 修改函数的行为？我希望 mouse-yank-primary 插入额外的文本，但仅当我处于特定模式时。我已经为 mouse-yank-primary 尝试了“defadvice after”，但是一旦激活它也可以在所有其他缓冲区中使用。

我认为可以通过在模式挂钩中将鼠标按钮重新绑定到我自己的功能来解决，但 elisp 手册说最好使用 defadvice。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:35:33.267

将鼠标按钮重新绑定到另一个功能对我来说似乎更可取。你不需要一个模式挂钩，通常你只需修改模式的键盘映射：

```
(eval-after-load '<mode>
  '(define-key <mode>-map [mouse-2] 'my-mouse-yank-primary)) 
```

将建议本地化到主要模式有点困难。没有参数可以传递给`defadvice`它，但你可以在模式挂钩中设置一些变量的缓冲区本地值，然后在建议代码中检查这个值。如果已设置，请做一些特别的事情。如果没有，只需评估`ad-do-it`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T13:51:05.733

将建议本地化到主要模式很容易：

```
(defadvice foo (after bar activate)
  (when (derived-mode-p 'python-mode)
    (do (something) now))) 
```

# c# - 如何从不同的表单将项目添加到列表框？

> ID：14076562
> 
> 赞同：1
> 
> 时间：2012-12-28T22:26:24.907
> 
> 标签：c#, winforms, visual-studio, listbox, multiple-forms

我正在尝试将新项目从 form2 添加到 form1 中的列表框。它背后的想法是根据 form2 活动最终得到一个不同项目的列表，每个项目彼此不同（或相同，无关紧要）。假设我打开 form1（它有购物清单（列表框）），然后打开 form2 并单击按钮，该按钮会将“bannana”添加到 form1 的列表中。我该怎么做呢？我尝试了各种方法，例如在 form1 中添加“addToList(parameter)”方法，然后从 form2 调用它并传递参数，但列表将保持为空，但是会弹出消息框等其他内容。所以任何想法如何解决这个问题？

我在表格一中使用此方法将项目添加到列表中并且它有效：

```
public void addToList()
{
    MessageBox.Show("Adding stuff to list");
    listEvent.Items.Add("New item 1");
    listEvent.Items.Add("new item 2");
    MessageBox.Show("Done adding");
    listEvent.Refresh();
} 
```

现在，当我尝试从另一个类/表单中调用它时，我使用它：

```
public void changeForm()
{
    EventPlanner mainEventForm = new EventPlanner();
    mainEventForm.addToList();
} 
```

或者：

```
private void btnAddEvent_Click(object sender, EventArgs e)
{
    EventPlanner mainEventForm = new EventPlanner();
    mainEventForm.addToList();
} 
```

但它仍然不起作用。虽然当我从 form1 （事件计划者，列表所在的位置）使用它时，它工作得非常好。我什至将访问修改器更改为公共，所以这不应该是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T00:11:07.050

正如我在对您的问题的评论中提到的，您可以在 Form2 上使用公共方法。这是一个简单的例子。

**表格1**

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Form2 frm2 = new Form2();
        if (frm2.ShowDialog(this) == DialogResult.OK)
        {
            listBox1.Items.Add(frm2.getItem());
        }
        frm2.Close();
        frm2.Dispose();
    }
} 
```

**从2**

```
public partial class Form2 : Form
{
    public Form2()
    {
        InitializeComponent();
        button1.DialogResult = DialogResult.OK;
        button2.DialogResult = DialogResult.Cancel;
    }

    public string getItem()
    {
        return textBox1.Text;
    }
} 
```

# c# - 使用 StreamWriter 从文本文件读取并以逗号分隔格式将其写入另一个文本文件

> ID：14076565
> 
> 赞同：1
> 
> 时间：2012-12-28T22:27:01.663
> 
> 标签：c#

我正在尝试将从文本文件中读取的数据写入另一个文本文件，以逗号分隔的格式。我需要知道代码是什么才能得出这个结论。这是我需要帮助的地方。

例子：

原始数据如下所示：

> Agnico-Eagle Mines
> COM
> 008474108
> 28996843
> 716800
> 716800
> N/A
> N/A
> 
> N/A
> 716800
> N/A
> Agrium Inc.
> COM
> 008916108
> 145739616
> 1646617
> 1646617
> N/A
> N/A
> 
> N/A
> 1646617
> N/A
> AuRico Gold Inc
> COM
> 05155C105
> 504505
> 62875
> 62875 不适用 不适用
> 不
> 适用
> 
> 62875
> 不
> 适用

这就是我希望数据在 RichTextBox 中的样子：

> Agnico-Eagle Mines,COM,008474108,28996843,716800,716800,N/A,N/A,,N/A,716800,N/A
> Agrium Inc.,COM,008916108,145739616,1646617,1646617,N/A ,N/A,,N/A,1646617,N/A
> AuRico Gold Inc,COM,05155C105,504505,62875,62875,N/A,N/A,,N/A,62875,N/A

就像您从原始文本数据中知道的那样，我想读取第一行，然后添加一个逗号，然后读取第二行，将其附加到第一行，然后添加一个逗号，这适用于第 12 行。第 12 行末尾没有逗号。然后该过程重新开始。

任何信息表示赞赏。

谢谢。

以下是我迄今为止编写的代码。

```
 private void button1_Click(object sender, EventArgs e)
    {
        using (StreamReader Reader = new StreamReader(@"C:\Original_Text_File.txt"))
        {
            while (!Reader.EndOfStream)
            {
                TextBox1.AppendText(Reader.ReadLine());
            }

        }           

    }

    private void button2_Click(object sender, EventArgs e)
    {
        using (StreamWriter Writer = new StreamWriter(@"C:\Original_Text_File.txt"))
        {

            Writer.WriteLine(TextBox1.Text);

        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:44:32.303

假设**12**是您输入文本的幻数，

```
var query = File.ReadLines("a.txt")
                .Select((line,no) => new{line,no})
                .GroupBy(x => x.no/12)
                .Select(g => String.Join(",",g.Select(x => x.line)));

File.WriteAllLines("b.txt",query); 
```

这适用于您的示例输入和预期输出....

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T22:35:22.763

这是我将接近读取数据的方式：

```
 var sbText = new System.Text.StringBuilder(10000);
        // Keeps track of your current position within a record
        int wCurrLine = 0;
        // Number of rows in the file that constitute a record
        const int LINES_PER_ROW = 12;

        using (StreamReader Reader = new StreamReader(@"C:\Original_Text_File.txt"))
        {
            while (!Reader.EndOfStream)
            {
                // If we are not on the first row in the record, add a comma
                if (wCurrLine != 0)
                {
                    sbText.Append(",");
                }
                // Add the text
                sbText.Append(Reader.ReadLine());

                // Increment our current record row counter
                wCurrLine++;
                // If we have read all of the rows for this record
                if (wCurrLine == LINES_PER_ROW)
                {
                    // Add a line to our buffer
                    sbText.AppendLine();
                    // And reset our record row count
                    wCurrLine = 0;
                }
            }
            // When all of the data has been loaded, write it to the text box in one fell swoop
            TextBox1.Text = sbText.ToString(); 
```

编辑：我刚刚意识到我没有完全回答原始问题：没有理由使用文本框，除非您想在写出结果之前查看结果。如果您不需要这样做，您可以替换该行：

```
 TextBox1.Text = sbText.ToString(); 
```

和：

```
 using (StreamWriter Writer = new StreamWriter(@"C:\Original_Text_File.csv"))
        {
            Writer.Write(sbText);
        } 
```

（注意文件名中扩展名的变化）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T22:32:15.103

如果您只想使用不同的方法从一个文件写入另一个文件，请尝试以下操作：

```
protected string TextProperty { get; set; }

private void button1_Click(object sender, EventArgs e)
{
    using (StreamReader reader = new StreamReader(@"C:\Original_Text_File.txt"))
    {
        // read all content file to the string property on your form.
        TextProperty = reader.ReadToEnd();    
    }         

}

private void button2_Click(object sender, EventArgs e)
{
    using (StreamWriter writer = new StreamWriter(@"C:\Original_Text_File.txt"))
    {
        // write all content of the property to the file.
        writer.Write(TextProperty);    
    }
} 
```

如果您想逐行分隔或对每一行进行特定处理，您可以使用`StringBuilder`class.

```
private void button1_Click(object sender, EventArgs e)
{
    using (StreamReader reader = new StreamReader(@"C:\Original_Text_File.txt"))
    {
        StringBuilder builder = new StringBuilder();
        while (reader.Peek() >= 0) 
        {
            builder.AppendLine(reader.ReadLine());
        }
    }
} 
```

并获取`StringBuilder`刚刚调用该`ToString()`方法的所有全部内容并将其写入文件：

```
private void button2_Click(object sender, EventArgs e)
{
    using (StreamWriter writer = new StreamWriter(@"C:\Original_Text_File.txt"))
    {
        writer.Write(builder.ToString());
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T22:30:14.607

创建 a `List<String>`，将每一行读入其中。然后 String.Join 使用 a`,`作为分隔符加入列表。当然`Clear`在每一行的开头调用列表中的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-28T22:57:25.230

```
private void button1_Click(object sender, EventArgs e)
{
    using (StreamReader Reader = new StreamReader(@"C:\Original_Text_File.txt"))
    {
        var i = 0;
        while (!Reader.EndOfStream)
        {
            if (i % 12 == 11)
            {
                //every 12 lines you read append new line instead of ,
                TextBox1.AppendText(string.Format("{0}\n", Reader.ReadLine()));
            }
            else
            {
                TextBox1.AppendText(string.Format("{0},", Reader.ReadLine()));
            }
            i++;
        }
    }
}

private void button2_Click(object sender, EventArgs e)
{
    using (StreamWriter Writer = new StreamWriter(@"C:\Original_Text_File.txt"))
    {
        using (StringReader Reader = new StringReader(TextBox1.Text))
        {
            while (true)
            {                
                var line = Reader.Readline()
                if(line !=null)
                {
                    Writer.WriteLine(Reader.Readline());
                }
                else
                {
                    break;
                }
            }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-28T22:36:45.447

注意 - 如果有标记（空白行），我将把它作为一个示例来说明如何执行此操作，我在编写示例数据时错过了阅读示例数据。

* * *

像这样的东西应该可以工作，我没有测试，所以它可能有错别字：

注意：我寻找一个空行（而不是计数）以知道我在记录的末尾。这样，如果您添加另一个字段，代码将不会中断。

```
 using (StreamReader Reader = new StreamReader(@"C:\Original_Text_File.txt"))
    {
        StringBuilder aLine;
        boolean first = true;

        while (!Reader.EndOfStream)
        {
           // read source line
           string inLine = Reader.ReadLine();

           // if length is zero append to test box (we have a blank line between records)
           if (inLine.Length == 0)
           {
              TextBox1.AppendText(aLine.ToString());
              first = true;
           } 

           // add a comma if we are not the first
           if (!first)
           {
             aLine.Append(",");
           }
           aLine.Append(inLine);

           // next time we won't be first
           first = false;

        }
        TextBox1.AppendText(aLine.ToString());

    } 
```

# c# - 如何使我的 PDF 完全适合 4x6 英寸？目前正在以普通 A4 文件打印

> ID：14076570
> 
> 赞同：4
> 
> 时间：2012-12-28T22:27:20.847
> 
> 标签：c#, asp.net, vb.net, itextsharp

我正在使用 iTextSharp 创建运输标签。

我正在做的是在 PDF 中创建一个标签，这样我就可以以任何我想要的方式对其进行格式化，然后将其发送到我的热敏打印机。

我的问题是，我的标签尺寸为 4x6（标准运输标签）。这些是我们在 UPS 和 Fedex 包裹上看到的标签。如何使我的 PDF 完全适合 4x6 英寸？目前它正在以普通 A4 文件打印。

我正在使用以下内容：

```
Dim document As New Document()
document.SetPageSize(PageSize.A4_LANDSCAPE) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T22:32:44.263

设置自定义页面大小：

```
Dim pgSize As New iTextSharp.text.Rectangle(myWidth, myHeight) 
Dim doc As New iTextSharp.text.Document(pgSize, leftMargin, rightMargin, topMargin, bottomMargin) 
```

iTextSharp 使用每英寸 72 像素，因此如果您知道所需页面大小的高度和宽度（以英寸为单位），只需将这些数字乘以 72 即可得到 myWidth 和 myHeight。

[https://stackoverflow.com/a/2503476/102937](https://stackoverflow.com/a/2503476/102937)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T05:31:05.577

我建议制作原始打印机语言。热敏条码打印机都有母语。ZPLII（Zebra 打印机语言 2）或 DPL（Datamax 打印机语言）等语言。您可以将它们构建为字符串并将它们直接传递给打印机。搜索打印机制造商网站，您可以快速找到您正在使用的打印机的打印机语言手册。

这种方法的最大优点是控制和速度。由于 Zebras 和 Datamax 打印机实际上并不关心页面大小，您可以专注于以您想要的大小和方向呈现您想要的数据。

您还可以利用打印机拥有的一些额外逻辑。这对于具有顺序编号的序列化标签特别有用。发送到打印机的单个字符串可以生成数十到数百个标签。如果您要进行大量热敏条形码打印，我强烈建议您了解这些打印机在其母语中的强大功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T06:38:38.887

设置文档大小使用如下： -

```
 Document doc = new Document(new iTextSharp.text.Rectangle(295f, 420f), 0f, 0f, 0f, 0f);
    PdfWriter.GetInstance(doc, Response.OutputStream);
                            doc.Open();
    -----------

    -----
    --------- 
```

这里的字体是代码： -

```
iTextSharp.text.Font myFont1 = new iTextSharp.text.Font() { Size = 4.5f };

PdfPTable header1 = new PdfPTable(2);

header1.AddCell(new PdfPCell(new Phrase("", myFont1 )) { UseAscender = true, PaddingTop = 0, Border = 0, HorizontalAlignment = 0 }); 
```

我刚刚添加了其他属性供您将来使用。

编码快乐！！

# jquery - Lightbox.js 将 Lightbox 推送到页面底部

> ID：14076575
> 
> 赞同：0
> 
> 时间：2012-12-28T22:27:58.187
> 
> 标签：jquery, lightbox

我正在尝试将 JQuery 插件、Lightbox、[http](http://leandrovieira.com/projects/jquery/lightbox/) ://leandrovieira.com/projects/jquery/lightbox/ 安装到我的图片库页面，但图片点击正在向容器和背景下方发送一个 div出现在主要区域。

```
 <!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="styles/styles.css">
  <link rel="stylesheet" href="styles/HTML5CSSReset.css">
  <link rel="stylesheet" type="text/css" href="styles/jquery.lightbox-0.4.css" media="screen" />
  <link rel="shortcut icon" href="images/favicon.ico">
  <title>Circle Bar</title>

    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery.lightbox-0.5.min.js"></script>

</head>

<body>
    <div id="ground">
    <div id="container">
    <div id="header">
    </div>
    <div id="nav">
        <ul>
            <li><a href="index.html">Information</a></li>
            <li><a href="calendar.html">Calendar</a></li>
            <li><a href="imageGallery.html">Images</a></li>
            <li><a href="informationContact.html">Contact & Directions</a></li>
        </ul>
    </div>  
    <div id="gallery" class="sidePage"><br><br><br><br><br>
    <ul>
        <li><a href="images/gallery/1.jpg" title="For this example: $('#gallery a').lightBox();"><img src="images/thumbs/1.jpg"></a></li>
        <li><a href="images/gallery/2.jpg" title="For this example: $('#gallery a').lightBox();"><img src="images/thumbs/2.jpg"></a></li>
        <li><a href="images/gallery/3.jpg" title="For this example: $('#gallery a').lightBox();"><img src="images/thumbs/3.jpg"></a></li>
        <li><a href="images/gallery/4.jpg" title="For this example: $('#gallery a').lightBox();"><img src="images/thumbs/4.jpg"></a></li>
        <li><a href="images/gallery/5.jpg" title="For this example: $('#gallery a').lightBox();"><img src="images/thumbs/5.jpg"></a></li>
        <li><a href="images/gallery/6.jpg" title="For this example: $('#gallery a').lightBox();"><img src="images/thumbs/6.jpg"></a></li>
    </ul>
<script type="text/javascript">
$(function() {
    // Use this example, or...
    $('a[@rel*=lightbox]').lightBox(); // Select all links that contains lightbox in the attribute rel
    // This, or...
    $('#gallery a').lightBox(); // Select all links in object with gallery ID
    // This, or...
    $('a.lightbox').lightBox(); // Select all links with lightbox class
    // This, or...
    $('a').lightBox(); // Select all links in the page
    // ... The possibility are many. Use your creative or choose one in the examples above
});
</script>
    </div>
    </div>
    </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-03-14T15:50:59.683

有这个问题

```
 <link ref="stylesheet" type="text/css" href="/assets/css/gallery.css" title="default" /> 
```

有`ref`而不是`rel`

```
<link rel="stylesheet" type="text/css" href="/assets/css/gallery.css" title="default" /> 
```

请务必检查您的 css 是否正确加载。

# android - 4人纸牌游戏的哪个选项

> ID：14076579
> 
> 赞同：0
> 
> 时间：2012-12-28T22:28:17.123
> 
> 标签：android

我正在为 4 名玩家（3 名机器人和 1 名人类）设计一款适用于 android 的纸牌游戏，我想知道考虑到 UI 和游戏计算的正确方法。以下是两种方法，哪一种更好？

1-启动一个线程（或assignTask），循环遍历所有玩家并相应地更新屏幕

```
void doInBackground(){

   for (i=0;i<13;i++){
     player1.play();
     //update GUI
     thread.sleep(1000);
     player2.play();
     //update GUI
     thread.sleep(1000);
     player3.play();
     //update GUI
     thread.sleep(1000);
     player4.play();
     //update GUI
     thread.sleep(1000);

   }

} 
```

2-第二个选项是让循环在后台线程上运行，但每个玩家的计算都在一个线程中

```
void OnCreat(){

.
.
.
.
   for (i=0;i<13;i++){
     new thread().execute(player1.play());
     new thread().execute(player2.play();
     new thread().execute(player3.play();
     new thread().execute(player4.play();

   }

} 
```

我认为第一个选项会更好，因为我不必确保没有播放器 2 不会在播放器 1 之前播放，而且我可以在播放之间使用 thread.sleep() （在播放之间暂停）。

有什么想法吗 ？甚至更好的想法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T19:08:11.100

我会建议第一个选项。因为看起来在你的游戏中，玩家一个一个地玩。

# cdi - CDI @Producer 方法可以接受自定义参数吗？

> ID：14076582
> 
> 赞同：5
> 
> 时间：2012-12-28T22:28:37.603
> 
> 标签：cdi

我想我了解 CDI 的工作原理，为了深入研究它，我想尝试将它与现实世界的示例一起使用。我被一件事困住了，我需要你的帮助才能让我理解。我非常感谢您在这方面的帮助。

我有自己的工作流框架，使用 Java 反射 API 和 XML 配置开发，其中基于特定类型的“源”和“事件名称”我加载适当的模块类并在其上调用“过程”方法。在我们的项目中一切正常。

我对 CDI 功能感到兴奋，并想尝试使用工作流框架，我计划在其中注入模块类，而不是使用反射等加载它们......

只是为了给你一个想法，我会尽量在这里保持简单。

“Message.java”是一种Transfer Object，它带有“Source”和“eventName”，以便我们可以适当地加载模块。

```
public class Message{
private String source;
private String eventName;
} 
```

模块配置如下

```
<modules>
<module>
    <source>A</source>
    <eventName>validate</eventName>
    <moduleClass>ValidatorModule</moduleClass>
</module>
<module>
    <source>B</source>
    <eventName>generate</eventName>
    <moduleClass>GeneratorModule</moduleClass>
</module>
</modules> 
```

模块加载器.java

```
public class ModuleLoader {
public void loadAndProcess(Message message){
    String source=message.getSource();
    String eventName=message.getEventName();

    //Load Module based on above values.

}
} 
```

问题

现在，如果我想通过 CDI 实现相同的功能以注入一个模块（在 ModuleLoader 类中），我可以使用 @Produce 方法编写工厂类，它可以做到这一点。但我的问题是，

a) 如何将 Message Object 传递给 @Produce 方法以根据 eventName 和 source 进行查找？

你能给我一些建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T21:38:59.810

这个有点棘手，因为 CDI 的工作方式与您的自定义解决方案不同（如果我理解正确的话）。CDI 必须在启动时拥有所有依赖项列表和这些依赖项的解决方案，您的解决方案听起来像是在运行时找到了可能发生变化的所有内容。话虽如此，您可以尝试几件事。

您可以尝试将 an`InjectionPoint`作为参数注入生产者方法并返回正确的对象，或创建正确的类型。

还有创建您自己的扩展来执行此操作，并创建依赖项并将它们全部连接到扩展中（查看`ProcessInjectionTarget`、`ProcessAnnotatedType`和 'AfterBeanDiscovery` 事件。这[两个](https://github.com/jboss-jdf/jboss-as-quickstart/tree/master/deltaspike-beanbuilder) [快速入门](https://github.com/jboss-jdf/jboss-as-quickstart/tree/master/cdi-portable-extension)也可能有助于获得一些想法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-18T03:04:34.610

我认为您可能在制作人方面走错了路。相反，特别是根据您所描述的内容，使用观察者可能会更好。

我假设“消息”传输对象像系统范围的事件一样抽象地使用，基本上您触发事件并且您希望在您创建的 XML 框架中定义一些处理程序来确定事件的正确管理器，实例化它（如果需要），然后调用传递事件的类。

```
 @ApplicationScoped 
public class MyMessageObserver {

    public void handleMessageEvent(@Observes Message message) {
        //Load Module based on above values and process the event
    }
} 
```

现在让我们假设你想使用你的原始界面（我猜它看起来像）：

```
 public interface IMessageHandler {
     public void handleMessage(final Message message);
}

@ApplicationScoped
public class EventMessageHandler implements IMessageHandler {

    @Inject
    private Event<Message> messageEvent;

    public void handleMessage(Message message) {
        messageEvent.fire(message);
    }
} 
```

然后在您想要使用它的任何遗留类中： `@Inject IMessageHandler handler;`

这将允许您执行您所描述的所有操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-17T20:40:14.397

可能你需要这样的东西：

1.  你需要预选赛。像@Module这样的注解，它需要两个参数source和eventName；它们应该是非限定符值。请参阅文档。

2.  其次，您需要一个生产者：

    ```
    @Produces  
    @Module  
    public Module makeAmodule(InjectionPoint ip) {  
       // load the module, take source and eventName from ip  
    } 
    ```

3.  像这样在适当的地方注入：

    ```
    @Inject
    @Module(source="A", eventName="validate")
    Module modulA; 
    ```

该解决方案只有一个问题，这些模块必须是依赖范围，否则系统将注入相同的模块，无论源和事件名称。如果要使用范围，则需要 make source 和 eventName 限定参数，并且：

*   为 CDI 做一个扩展，以编程方式注册生产者
*   或者为 source 和 eventName 的每一种可能的组合制作生产者方法（我不认为这很好）

# javascript - 如何使用 div 中的内容填充文本区域，包含文本和下拉选项的混合？

> ID：14076583
> 
> 赞同：0
> 
> 时间：2012-12-28T22:28:42.120
> 
> 标签：javascript, html

我的网站有一段带有 madlib 风格的段落，要求用户选择不同的内联下拉选项来完成该段落。

我的 HTML

```
<div id="aspirate">
BONE MARROW ASPIRATE AND TOUCH PREPARATION: The aspirate smears contain 
    <select name=asp_1>
        <option> few </option>
        <option> adequate </option>
        <option> numerous </option>
    </select>
    <select name=asp_2>
        <option> cellular </option>
        <option> paucicellular </option>
        <option> acellular </option>
    </select>
    marrow particles. Myeloid precursors appear 
<select name=asp_3>
        <option> adequate </option>
        <option> decreased </option>
        <option> increased </option>
    </select>    
in number with
    <select name=asp_4>
        <option> full-spectrum maturation </option>
        <option> left-shifted maturation </option>
    </select>. Erythroid precursors appear 
    <select name=asp_5>
        <option> adequate </option>
        <option> decreased </option>
        <option> increased </option>
    </select> in number with full-spectrum maturation <select name=asp_6>
        <option> and mild megaloblastic changes </option>
        <option> and mild dyspoies characterized by nuclear membrane irregularities and increased mitoses </option>
        <option> and occasional binucleate forms </option>
    </select>. 
    Megakaryocytes are 
    <select name=asp_7>
        <option> adequate </option>
        <option> decreased </option>
        <option> increased </option>
    </select> in number and normal in morphology. No dysplastic changes or increased numbers of blast cells are identified. No lymphoid infiltrates are identified. 
    <select name=asp_9>
        <option> </option>
        <option> The direct smears and touch preparation slides show similar cellular composition. </option>
        <option> The direct smear slides show similar cellular composition.</option>
    </select>  The iron stain shows 
    <select name=asp_10>
        <option> </option>
        <option> no ring sideroblasts, and </option>
        <option> rare ring sideroblasts, and </option>
    </select>
    <select name=asp_11>
        <option> adequate storage iron</option>
        <option> decreased storage iron </option>
        <option> increased storage iron </option>
    </select>.
</div>

<br>
<input id="submit" type="button" value="Submit" onClick='document.getElementById("outPut4").innerHTML=document.getElementById("aspirate").innerText'>
<br>
<form>
<textarea id="outPut4" rows = 20 cols = 45></textarea>
</form> 
```

这仅返回文本减去下拉选择？这可以仅使用 HTML 来完成，还是应该为每个下拉列表分配一个变量值并使用 javascript 调用一个函数，该函数将在 textarea 中写入我的文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T00:57:35.440

基本上，它需要一个执行以下操作的 JavaScript 函数：

1.  遍历div的每个子节点。
2.  确定每个是文本节点还是选择框。
3.  从每个节点中提取值。
4.  将组合值插入文本区域。

示例 JavaScript：

```
function showText() {
    var html = '';
    // Get the first child node
    var dom = document.getElementById('aspirate').firstChild;
    while (dom) {
        if (dom.nodeType == 3) { // Text node
            html += dom.nodeValue; // Add the value
        }
        else if (dom.nodeName.toLowerCase() == 'select') { // Select box
            html += dom.value; // Add the selected value
        }
        dom = dom.nextSibling; // Get the next child node
    }
    // Display the combined values of the child nodes
    document.getElementById('outPut4').innerHTML = html;
} 
```

这是一个演示这一点的[jsfiddle 演示](http://jsfiddle.net/Matt_Coughlin/36NYn/1/)。在这个演示中，`onchange`每个选择框都添加了一个事件处理程序，当其中一个选择框发生变化时，它会更新文本区域。

此外，对演示中的 HTML 进行了编辑，以改进文本区域中结果文本的格式。或者，可以在遍历子节点时过滤文本值（删除换行符和制表符）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:33:28.237

您已经在 onClick 中使用了 javascript。您需要从 onClick 调用的更复杂的部分，它将从下拉列表中获取选定的文本并将其与其他位合并。

在构建要放入 textarea 的文本时，您需要复制 html 页面中的文本内容。

# android - 是否应该覆盖android后退按钮

> ID：14076586
> 
> 赞同：0
> 
> 时间：2012-12-28T22:29:33.873
> 
> 标签：android, tabs, fragment

我想回到后退堆栈中的最后一个片段，所以我想让后退按钮弹出堆栈。我应该这样做吗？如果是这样，我应该覆盖 onBackPressed() 还是 onKeyDown()？

```
@Override
        public void onBackPressed()
            {
            Intent intent = new Intent(this,ABC.class);
            startActivity(intent);
            } 
```

* * *

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
    if (keyCode == KeyEvent.KEYCODE_BACK ) {
        // do something on back.
        return true;
    }

    return super.onKeyDown(keyCode, event);
} 
```

由于某种原因，我的片段没有正确添加到后台堆栈

我正在使用它来尝试返回上一个片段，但是顺序很奇怪。我应该怎么做才能使订单正确？

```
@Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft){
        if(teamsFrag !=null)
        {

            if(manage.getBackStackEntryCount() > 0)
                manage.popBackStack(manage.getBackStackEntryAt(manage.getBackStackEntryCount()-1).getName(), FragmentManager.POP_BACK_STACK_INCLUSIVE);

            //ft.detach(dataFrag);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:30:26.523

简短的回答？不。

长答案？如果你不得不问，不。

您应该使用片段管理器设置您的片段，以便后退按钮执行您想要的操作。您不应该覆盖后退按钮而不是正确实现您的堆栈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:51:26.067

> 我想回到后退堆栈中的最后一个片段，所以我想让后退按钮弹出堆栈。

[`FragmentTransaction#addToBackStack()`](http://developer.android.com/reference/android/app/FragmentTransaction.html#addToBackStack%28java.lang.String%29)这是您在使用FragmentManager 添加新 Fragments时使用的默认行为。

# php - Magento 在保存客户地址时会发送事件吗？

> ID：14076591
> 
> 赞同：4
> 
> 时间：2012-12-28T22:30:24.597
> 
> 标签：php, events, magento

`app/code/core/Customer/etc/config.xml`在 Magento 保存地址之前和之后注册观察者：

```
<events>
    <customer_address_save_before>
        <observers>
            <customer_address_before_save_viv_observer>
                <class>customer/observer</class>
                <method>beforeAddressSave</method>
            </customer_address_before_save_viv_observer>
        </observers>
    </customer_address_save_before>
    <customer_address_save_after>
        <observers>
            <customer_addres_after_save_viv_observer>
                <class>customer/observer</class>
                <method>afterAddressSave</method>
            </customer_addres_after_save_viv_observer>
        </observers>
    </customer_address_save_after>
</events> 
```

…但我找不到任何证据表明 Magento 实际上在任何地方发送这些事件：

```
$ grep -RF 'dispatchEvent(' . | grep -F customer_addres
./app/code/core/Mage/Customer/Model/Address/Abstract.php:        Mage::dispatchEvent('customer_address_format', array('type' => $formatType, 'address' => $this)); 
```

据我了解`Mage::dispatchEvent(…)`，这是 Magento 触发事件的唯一方法。这些事件真的发生了吗？（我希望如此，因为我真的可以使用一些在地址保存时间触发的事件。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-28T23:27:20.160

是的，它分派但有些事件很难找到分派的位置，因为 magento 会动态执行此操作。保存时几乎所有核心​​模型都会发生这种情况。Magento 像这样调度这些事件：

```
Mage::dispatchEvent($this->_eventPrefix.'_save_before', $this->_getEventData());
Mage::dispatchEvent($this->_eventPrefix.'_save_after', $this->_getEventData()); 
```

因此 grep 将无法找到此事件的调度位置。

例如，模型“Mage_Customer_Model_Address”扩展了类“Mage_Customer_Model_Address_Abstract”，该类`$_eventPrefix = 'customer_address'`在 Mage_Core_Model_Abstract 的 _beforeSave() 和 _afterSave() 方法中设置了事件被调度。

# php - PHPUnit 在 assertEquals 失败时不显示差异

> ID：14076593
> 
> 赞同：2
> 
> 时间：2012-12-28T22:30:34.153
> 
> 标签：php, cakephp, phpunit

我通过 CakePHP v2.3 使用 PHPUnit 3.7.10 并运行以下命令：

```
$this->assertEquals(array('a', 'b', 'c'), array('a', 'c', 'd')); 
```

我得到的只是：

`Failed asserting that two arrays are equal.`

为什么我没有得到这里概述的差异？[http://www.phpunit.de/manual/current/en/writing-tests-for-phpunit.html#writing-tests-for-phpunit.assertions.assertEquals.example5](http://www.phpunit.de/manual/current/en/writing-tests-for-phpunit.html#writing-tests-for-phpunit.assertions.assertEquals.example5)

```
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
 Array (
     0 => 'a'
-    1 => 'b'
-    2 => 'c'
+    1 => 'c'
+    2 => 'd'
 ) 
```

我错过了什么？

**更新**。通过 test.php?case=Cache/Engine/PhpUnit&debug=1 调用的测试文件

```
<?php

class PhpUnitTest extends CakeTestCase {
    public function testDiff() {
        $this->assertEquals(array('a', 'b', 'c'), array('a', 'c', 'd'));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:21:40.837

为我工作：

```
<?php
class SoTest extends PHPUnit_Framework_TestCase
{
    public function testIt()
    {
        $this->assertEquals(array('a', 'b', 'c'), array('a', 'c', 'd'));
    }
}
?> 
```

输出：

```
$  phpunit SoTest.php 
PHPUnit 3.7.10 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 3.00Mb

There was 1 failure:

1) SoTest::testIt
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
 Array (
     0 => 'a'
-    1 => 'b'
-    2 => 'c'
+    1 => 'c'
+    2 => 'd'
 )

/home/cweiske/SoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:30:03.597

您正在浏览器上运行单元测试。`--debug`当您在 CLI 上使用修饰符运行它时，您将看到预期的结果。您也可以`&debug=1`在使用 Web 浏览器运行测试时尝试在 url 的末尾添加，但这对我来说并没有奏效很多次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T15:39:02.560

这是 CakePHP 2.3 中的一个回归错误。[在https://github.com/cakephp/cakephp/commit/659715664d648d9a599002b5a7c3b55505efdcde](https://github.com/cakephp/cakephp/commit/659715664d648d9a599002b5a7c3b55505efdcde)中修复

对于参考这里是我打开的勾选： http: [//cakephp.lighthouseapp.com/projects/42648/tickets/3503-23-suppresses-phpunit-diff-output](http://cakephp.lighthouseapp.com/projects/42648/tickets/3503-23-suppresses-phpunit-diff-output)

# bash - 删除两行之间的数据

> ID：14076596
> 
> 赞同：2
> 
> 时间：2012-12-28T22:31:01.213
> 
> 标签：bash, shell, unix

在两行文本之间搜索和删除数据的最佳方法是什么，包括第一行但不包括第二行。

字符串 1：`SECTION - PAY 500`- 待删除

*要删除的数据，随机文本行*

字符串 2：`SECTION - Pay 400`- 停留

这是大约 3000 页的 word 文档，但我也有一个文本版本可以使用。我从哪里开始为这样的任务编写 bash 脚本？

文件内容示例：

```
text 
SECTION - PAY 500    (to be deleted)
text                 (to be deleted)
SECTION - Pay 400
text 
SECTION - PAY 500    (to be deleted)
text                 (to be deleted)
SECTION - Pay 400
text 
```

删除后应该是这样的结果

```
text 
SECTION - Pay 400
text
SECTION - Pay 400
text 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:55:45.760

标准解决方案`sed`：

```
sed "/$START/,/$END/ { /$END/"'!'" d; }" 
```

这意味着对于开始于`/$START/`和结束于`/$END/`action的范围，`{ /$END/! d; }`将完成`d`（删除）所有非`/$END/`.

`"'!'"`很奇怪，但是`!`从 bash 扩展中逃脱符号的唯一方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T00:00:46.080

我认为您可以很快地逐行解析文件。您要归档的内容似乎并不太复杂，无法实现。

```
copy=true
while read line; do
    if [ $copy ]; then
        if [[ "$line" == "SECTION - PAY 500"* ]]; then copy=; continue; fi
        echo "$line" >> outputfile
    else
        if [[ "$line" == "SECTION - Pay 400"* ]]; then copy=true; fi
    fi
done < inputfile 
```

通过这样做，我们现在甚至拥有了一台小型图灵机！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T00:13:34.760

另一个（不那么奇怪；））标准 sed 解决方案： `sed "/$END/ p; /$START/,/$END/ d;"`

旁注：`sed`如果需要，某些版本还支持文件的就地编辑。

还有一个完整的 bash 脚本：

```
#! /bin/bash

if [ "x$1" = "x-r" ]
then
    regex=1
    shift
else
    regex=0
fi

if [ $# -lt 2 ]
then
    echo "Usage: del.sh [-r] start end"
    exit 1
fi

start="$1"
end="$2"

function matches
{
    [[ ( regex -eq 1 && "$1" =~ $2 ) || ( regex -eq 0 && "$1" == "$2" ) ]]
}

del=0
while read line
do
    # end marker, must be printed
    if matches "$line" "$end"
    then
        del=0
    fi
    # start marker, must be deleted
    if matches "$line" "$start"
    then
        del=1
    fi
    if [ $del -eq 0 ]
    then
        echo "$line"
    fi
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:58:09.440

简单的解决方案：试试这种方式

**输入文件.txt**

```
text 
SECTION - PAY 500    
text                 
SECTION - Pay 400
text 
SECTION - PAY 500   
text                 
SECTION - Pay 400
text 
```

**代码**

```
awk '/500/{print;getline;next}1' Inputfile.txt | sed '/500/d' 
```

**输出**

```
text 
SECTION - Pay 400
text 
SECTION - Pay 400
text 
```

# google-apps-script - Google Docs SpreadSheet 脚本 - 如何将连续的特定单元格作为条件引用

> ID：14076602
> 
> 赞同：2
> 
> 时间：2012-12-28T22:31:48.657
> 
> 标签：google-apps-script

我有以下脚本（其中一些是我发现并根据我的需要修改的：

```
function onedit(e) { 
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var targetSheetName = "Completed";
  var sourceSheetName = "Eligibility & Pre-Auths"
  var targetSheet = ss.getSheetByName(targetSheetName);
  var sourceSheet = ss.getActiveSheet();
  var sourceRow = sourceSheet.getActiveRange().getRow();
  var targetRow = targetSheet.getLastRow() + 1;
  if (sourceSheet.getName() == SourceSheetName) {;
    if (sourceRow[22]=="Yes") {;
      if (targetRow > targetSheet.getMaxRows()) targetSheet.insertRowAfter(targetRow - 1);
      sourceSheet.getRange(sourceRow, 1, 1, sourceSheet.getLastColumn()).copyTo    (targetSheet.getRange(targetRow, 1));
      sourceSheet.deleteRow(sourceRow);
    };
  };
} 
```

除了我的情况，一切似乎都正常 - if (sourceRow[22]=="Yes")

我是新手，所以我知道我只是没有正确引用它。

我只是想检查文本“是”是否在当前行的第 22 列中。我在编辑时执行这个脚本。所以基本上，当在这个字段中输入“是”时，我会将这条记录移动到名为“已完成”的工作表中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T00:30:00.907

该语句`getRow()`返回一个整数，该范围的行数，您想要的是该行中 22cd 单元格的值，所以尝试

```
 var sourceRow = sourceSheet.getActiveRange().getRow();
  var sourceRowValue = sourceSheet.getRange(sourceRow,1,1,sourceSheet.getMaxColumn()).getValues(); 
```

然后获取单元格值条件：

```
 if (sourceRowValue[0][21]=="Yes") {;
     ... 
```

结果`getValues()`始终是一个二维数组，这就是`[0]`and is 0 indexed >> 更改为 21的原因

请注意，如果您使用`sourceSheet.getActiveCell().getValue()`which 直接返回您正在写入的单元格的值，我猜您的代码可能会更简单...

试试这个我得到值**和**列索引的小例子：

```
function onEdit(){
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var cellValue = ss.getActiveCell().getValue()
ss.getRange('A1').setValue(cellValue+' in col '+ss.getActiveCell().getColumn())
} 
```

# javascript - 推送到数组并创建运行总计

> ID：14076607
> 
> 赞同：0
> 
> 时间：2012-12-28T22:32:42.263
> 
> 标签：javascript, arrays, cumulative-sum

我需要将每个页面的高度推入一个数组。但是/我的问题是，我需要推送的不是值本身，而是值的总和。

这是我到目前为止所做的：

```
var heights = [0];
$('.page').each(function(i) {
    heights.push($(this).height());
}); 
```

结果看起来像这样：`[0, 2000, 1000, 3000, 1500]`，这是页面的高度，但我需要这样的东西：`[0, 2000, 3000, 6000, 7500]`，这是添加的页面高度的总和。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T22:43:17.037

```
var heights = [0];
$('.page').each(function(i) {
    heights.push(
        $(this).height() + (heights[i] || 0)
    );
}); 
```

**编辑**编辑后的版本现在根据提问者的要求
合并了领先的数组成员。`0`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:39:04.310

在您拥有的代码之后添加：

```
var total = 0;
for (i=1 ; i < heights.length ; ++i) {
    total += heights[i];
    heights[i] = total;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T22:41:35.560

您可以在一个循环中执行此操作：

```
var heights = [];
var total   = 0;
$('.page').each(function(i) {
    total += $(this).height();
    heights.push(total);
}); 
```

或者......如果你想让它超级干净：

```
var heights = [];
var total   = 0;
$('.page').each((function(){
  var total = 0;
  return function(i) {
    total += $(this).height();
    heights.push(total);
  };
}())); 
```

第二个版本避免使用`total`变量污染任何范围。

# c++ - 将序列化字节数组编码为 std::string

> ID：14076608
> 
> 赞同：0
> 
> 时间：2012-12-28T22:32:43.010
> 
> 标签：c++, encoding, stl, hypertable

是否有一种标准方法可以将字节数组**编码**和**解码**为可以存储到一个字符序列中`std::string`？

这个问题的原因是 HyperTable 的值类型是`std::string`，所以无论你想存储在表中的什么自定义类型都需要*序列化*并存储到字符串中，然后*反序列*化以供读取。（有关详细信息，请参阅此线程：[https](https://groups.google.com/forum/?fromgroups=#!topic/hypertable-user/_igfvLv9IfA) ://groups.google.com/forum/?fromgroups=#!topic/hypertable-user/_igfvLv9IfA ）

# linux - 如何在目录和子目录中的所有文件中将字符串模式替换为另一个字符串模式

> ID：14076611
> 
> 赞同：0
> 
> 时间：2012-12-28T22:32:46.443
> 
> 标签：linux, shell, grep

我正在重新构建我的网站，并且必须重新安排文件中的引用。有一个包含许多子目录和 php 文件的目录。我正在寻找某种命令/脚本，该命令/脚本可以搜索该目录中的每个文件以查找此模式并将其替换为自定义模式。

例如：我想替换确切出现的`one/two/three/` by `/shopping/shop/ipad`。换句话说，如果任何文件包含一些字符串 For 例如：

```
location:index.php?p=one/two/three/abcdefg&aid 
```

那么它应该被替换为

```
location:index.php?p=/shopping/shop/ipad/abcdefg&aid 
```

请注意，内容替换应该发生在每个文件中，在`/`主目录中的每个目录子目录中（比如主目录名称是`abc`& 所有子目录 & 文件都在 内`abc`）。不应更改目录名称本身。我怎样才能做到这一点？我的服务器运行 linux 并且我有 root 和 shell 访问权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:40:21.750

`sed`是您正在寻找的：

```
find .  -exec sed -i "s/one\/two\/three/shopping\/shop\/ipad/g" '{}' \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T08:32:15.653

```
find . -type f|xargs perl -pi -e 's/one\/two\/three/shopping\/shop\/ipad/g' 
```

经过测试并且工作正常。如果只有`one`

你也可以在[这里找到](http://theunixshell.blogspot.in/2012/12/find-and-replace-string-in-all-files.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T18:19:22.277

试试这个：

```
find . -type f -print0 | xargs -0 sed -i 's/one\/two\/three/shopping\/shop\/ipad/g' 
```

# php - 读取/使用服务器 /home/ 文件夹中的文件

> ID：14076613
> 
> 赞同：0
> 
> 时间：2012-12-28T22:33:00.830
> 
> 标签：php, home-directory

我有 7 个不同的自定义网站，都在同一台服务器上，使用相同的配置和图像文件。我想通过“包含”使用 PHP 或将它们引用为 src 图像来引用这些文件。不幸的是，当我尝试提取资源时，我得到了错误。有没有办法直接从 /home/ 目录使用这些文件，以便在所有网站上看到一个单一的变化？这是我现在使用的不起作用的东西：

```
 <?php include("/home/config.php"); ?> 
```

和

```
<img style="vertical-align:bottom" src="/home/buy_button.png" border="0" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T22:39:33.483

这同时是两个问题。

1\. 如何让 PHP 包含这些文件。?

确保 web 服务器用户，例如 ubuntu 上的 www-data 具有访问这些文件的适当权限。我会建议与 /home/.. 不同的东西（如果你问我）

2\. 如何从网络访问这些图像文件？

如果您使用的是 apache，则必须创建一个别名，使该图像可通过 Web 服务器访问。

这是apache2的一个例子

```
Alias /img /home/path/to/images
<Directory "/home/path/to/images">
    Order allow,deny
    Allow from all
</Directory> 
```

将此配置片段放置在 apache 安装的适当位置，例如 httpd.conf 的末尾或单独的文件。不要忘记重新启动您的网络服务器。

现在您应该能够访问以下图像：

```
<img style="vertical-align:bottom" src="http://www.myserver.com/img/buy_button.png"border="0" /> 
```

# java - 在 html 代码中搜索和保存指定链接

> ID：14076614
> 
> 赞同：0
> 
> 时间：2012-12-28T22:33:05.007
> 
> 标签：java, string, search, image, bufferedreader

```
</div><div class="tr">
  </div><div class="bl">
  </div><div class="br">
  </div>  <img src="http://blablabla.com/medium/blablabla.jpg" />
</div></a>
          </div><div class="meta">
<h3 class="action">
<span>
    <a href="/abc">ABC</a>
  </span> a picture
</h3> 
```

我将网站的 HTML 源代码保存到 String 中，如下所示：

```
 public static BufferedReader read(String url) throws Exception
  {
    return new BufferedReader(
        new InputStreamReader(
            new URL(url).openStream()));
  } 
```

在这段代码中，我想将所有图像 url 保存在一个新的字符串中，其中包含**/medium/**内部的连接 \n，或者使字符串中的所有图像链接更容易连接 \n。流程应该如何？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:40:55.120

与其尝试自己解析 HTML 内容，不如使用[JSoup](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)来获取图像标签并执行简单`String.contains`的操作来获取您正在寻找的图像标签。

```
Document doc = Jsoup.connect("http://www.blah.com/foo.html");
for (Element e : doc.select("img")) {
    String imageSrc = e.attr("src");
    if (imageSrc.contains("/medium/")) {
     ...
    }
} 
```

还要[避免使用正则表达式来解析 HTML](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)。

# php - 编辑 Wordpress 小部件

> ID：14076617
> 
> 赞同：1
> 
> 时间：2012-12-28T22:33:25.053
> 
> 标签：php, wordpress

我正在使用一个 Wordpress 主题，其中这是一个小部件代码，

```
/* Widget settings. */
$widget_ops = array( 'classname' => 'maxmag_catlist_widget', 'description' => __('A widget that displays a list of posts from a category of your choice.', 'maxmag_catlist_widget') );

/* Widget control settings. */
$control_ops = array( 'width' => 150, 'height' => 200, 'id_base' => 'maxmag_catlist_widget' );

/* Create the widget. */
$this->WP_Widget( 'maxmag_catlist_widget', __('Max Mag: Category List Widget', 'maxmag_catlist_widget'), $widget_ops, $control_ops ); 
```

在这里我想编辑这个小部件的宽度，所以我试图改变线

```
$control_ops = array( 'width' => 150, 'height' => 200, 'id_base' => 'maxmag_catlist_widget' ); 
```

然而它什么也没改变。我不懂一点php，但我有一些编码知识，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T02:08:25.557

我查看了 themeforest 中的 maxmag 主题（我认为你使用了这个），我注意到在 style.css 文件中它有这个指令（以及其他类似的其他小部件类型）：

```
.sidebar-widget {
    float: left;
    font: 400 12px/normal 'Open Sans', sans-serif;
    margin-bottom: 30px;
    overflow: hidden;
    width: 100%;
    } 
```

我不知道您必须更改哪个小部件，但我认为您可以更改`width: 100%;`说明来解决您的问题。

L.

# c++ - sem_destroy 其他人持有 sem_wait 的信号量？

> ID：14076624
> 
> 赞同：3
> 
> 时间：2012-12-28T22:33:44.573
> 
> 标签：c++, posix, semaphore

如果你有一个线程 (thread1) 在 a 上阻塞，`sem_wait()`而另一个线程 (thread2) 正在破坏那个信号量，使用`sem_destroy()`，那么 thread1 会发生什么？

[在互联网上快速搜索告诉我它会产生未定义的行为：](http://linux.die.net/man/3/sem_destroy)

> 销毁其他进程或线程当前被阻塞的信号量（在 sem_wait(3) 中）会产生未定义的行为。

但是，我碰巧看到它在许多多线程 c++ 应用程序中使用。

我的主要问题：

*   这有什么目的吗？
*   他们试图实现什么（例如，这会隐式终止线程）？
*   那不是很不安全吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:08:20.423

在我听说过的任何 API 中，我想不出任何一个案例，其中在使用过程中销毁某物是正常的或已定义的。因此，我认为您的问题的答案是：

> 那么他们想要达到什么目的呢？

我不知道。

> 那不应该很不安全吗？

是的！

也许你看过的其他程序的作者知道这些实现实际上做了什么并且依赖它。但他们必须为未来可能发生的变化做好准备。也许他们已经权衡了这种改变破坏他们的程序的风险与他们通过走捷径和依赖未定义的行为所获得的节省，并认为这是值得的。你必须自己做出这个判断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-08T03:18:01.603

这取决于实施。有些会解锁信号量阻塞的进程并将 errno 设置为 EINVAL。有些不会。我在Linux上做了一些实验。结果不一致。有时另一个进程会无限期地阻塞。有时它会被解锁但没有设置 errno。我猜在 Linux 上这确实是一种未定义的行为。

# javascript - IE - 无法获得财产

> ID：14076625
> 
> 赞同：0
> 
> 时间：2012-12-28T22:33:48.643
> 
> 标签：javascript, internet-explorer

我在 IE 9 和 10 中遇到错误。错误是“无法获取未定义或空引用的属性'替换'”。如果我们相信微软的错误，它会报告错误发生在以下函数的 value.replace 行：

```
function jsstrtonum($value) {
    if($value == '') {
        $value = '0.00';
    }
    var $retval = $value.replace(/[^0-9\.]+/g, '');

    return Number($retval);
} 
```

我只是在IE中遇到困难。所有其他浏览器都完美地执行此功能。我已经为此工作了几个小时。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:38:13.257

尝试

```
$value = new String($value); 
```

在使用“替换”之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:38:31.480

正如 Rocket Hazmat 所建议的那样，问题很可能是 $value 不是字符串。您可以使用一种快速而肮脏的方法来调试它是什么：

```
function jsstrtonum($value) {
    if (!$value.replace) {
        alert($value);
        // Alternatively if the IE developer tool gives you a console you could:
        // console.log($value);
    }
} 
```

这样你就可以看到是什么`$value`，并希望从那里调试你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T22:45:39.777

不妨将条件替换为：

```
if (!$value) 
```

这样所有的空值和未定义的值都会变成 0.00 字符串。

# php - PHP 和 JS 的时间戳之间的差异

> ID：14076630
> 
> 赞同：3
> 
> 时间：2012-12-28T22:34:28.757
> 
> 标签：php, javascript, unix, date, timestamp

疯了吧。我应该如何处理？

在 Chrome 控制台中：

```
new Date(2013,0,1).getTime() // 1st of Jan 2013
> 1356991200000
------------
new Date(2013,0,1).getTime()== 1356991200000
> true 
```

现在在 PHP 中取该值：

```
<?php 
    die(date('l, j F Y'), 1356991200000 / 1000); // cut some ms
?> 
```

我明白了`Monday, 31 December 2012`

这与格林威治标准时间有关吗？我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T22:37:05.687

Javascript 使用客户端上的时区，而 PHP 使用服务器时区。

**JS**：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)

```
var x = new Date()
var currentTimeZoneOffsetInHours = x.getTimezoneOffset()/60 
```

**PHP**： http: [//php.net/manual/en/function.date-default-timezone-get.php](http://php.net/manual/en/function.date-default-timezone-get.php)

```
<?php
echo date_default_timezone_get(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T22:36:58.213

使用任何一个（我会推荐服务器端）。您无法传达两者将同步的消息。一个取决于您的服务器，另一个取决于用户的计算机。

如果您需要显示某些内容，请使用相对时间并在页面刷新后更新客户端时间...

# c++ - 如何将图像的一部分从缓冲区复制到纹理中进行渲染？

> ID：14076635
> 
> 赞同：0
> 
> 时间：2012-12-28T22:35:05.310
> 
> 标签：c++, directx, directx-9

我一直在寻找一个简单的解决方案，但我没有找到任何东西。目前我正在从文件加载纹理并使用 C++ 2012 Express DirectX9 将其渲染到缓冲区中。但我想要做的是能够复制缓冲区的一部分，并将复制的部分用作纹理，而不是加载的纹理。

我希望能够像地图编辑器那样复制/选择。

编辑：问题解决了 :) 这只是愚蠢的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:57:20.033

您可以使用该`StretchRect`功能（[请参阅文档](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174471%28v=vs.85%29.aspx)）。

您应该将源缓冲区的子集复制到整个目标缓冲区（在您的情况下是新纹理的缓冲区）。像这样的东西：

```
LPDIRECT3DTEXTURE9 pTexSrc,     // source texture
                   pTexDst;     // new texture (a subset of the source texture)

// create the textures
// ...

LPDIRECT3DSURFACE9 pSrc, pDst;

pTexSrc->GetSurfaceLevel(0, &pSrc);
pTexDst->GetSurfaceLevel(0, &pDst);

RECT rect;   // (x0, y0, x1, y1) - coordinates of the subset to copy
rect.left = x0;
rect.right = x1;
rect.top = y0;
rect.bottom = y1;

pd3dDevice->StretchRect(pSrc, &rect, pDst, NULL, D3DTEXF_NONE);
// the last parameter could be also D3DTEXF_POINT or D3DTEXF_LINEAR

pSrc->Release();
pDst->Release(); // remember to release the surfaces when done !!! 
```

编辑：

好的，我刚刚了解了您的代码色调，我认为最好的解决方案是使用 uv 坐标而不是复制调色板纹理的子集。您应该为给定的图块计算适当的 uv 坐标`game_class:: game_gui_add_current_graphic`并在结构中使用它们`CUSTOMVERTEX`：

```
float width; // the width of the palette texture
float height; // the height of the palette texture
float tex_x, tex_y; // the coordinates of the upper left corner
                    // of the palette texture's subset to use for
                    // the current tile texturing
float tex_w, tex_h; // the width and height of the above mentioned subset

float u0, u1, v0, v1;
u0 = tex_x / width;
v0 = tex_y / height;
u1 = u0 + tex_w / width;
v1 = v0 + tex_h / height;

// create the vertices using the CUSTOMVERTEX struct
CUSTOMVERTEX vertices[] = {
{ 0.0f, 32.0f, 1.0f, u0, v1, D3DCOLOR_XRGB(255, 0, 0), },
{ 0.0f, 0.0f, 1.0f, u0, v0, D3DCOLOR_XRGB(255, 0, 0), },
{ 32.0f, 32.0f, 1.0f, u1, v1, D3DCOLOR_XRGB(0, 0, 255), },    
{ 32.0f, 0.0f, 1.0f, u1, v0, D3DCOLOR_XRGB(0, 255, 0), } }; 
```

示例：您的调色板由 3 行 4 列和 12 种可能的单元格纹理组成。每个纹理是 32 x 32。所以`tex_w = tex_h = 32;`和。假设您要计算应使用调色板第二行第三列中的图像纹理化的图块的 uv 坐标。然后和。最后，按照上面的代码计算 UV（在本例中，您将得到 {u0,v0,u1,v1} = {(3-1)/4, (2-1)/3, 3/4, 2/3} = {0.5, 0.33, 0.75, 0.66}）。`width = 4 * tex_w;``height = 3 * tex_h;``tex_x = (3-1)*tex_w;``tex_y = (2-1)*tex_h;`

# c++ - 强制 Windows 释放分配的内存

> ID：14076642
> 
> 赞同：1
> 
> 时间：2012-12-28T22:35:42.607
> 
> 标签：c++, windows, memory, memory-management, free

我在这里处理了一个有点奇怪的场景，但这正是我计划创建的。它只是一种特殊的测试软件......

我的环境：MSVS 2012，Windows 7/8 32b/64b。

所以，首先我正在创建一些内部结构/缓冲区/等以在我的应用程序中使用，然后我正在做这样的事情（这里简化了一点，请把它当作伪代码对待）：

```
{
   std::deque<boost::scoped_array<unsigned char>> deque;
   try {
     while (1) {
       deque.push_back(boost::scoped_array<unsigned char>(new unsigned char[system_page_size])); // happens to be 4096 on my system
     }
   }
   catch (std::bad_alloc& ex) { ... }
   // do something here
} 
```

我需要使用尽可能多的内存。我一次分配整个页面（也许这很糟糕，应该为双端队列/智能 ptr 的数据留出一些空间？）。当 CRT 决定不能再分配时，我会做更多的事情（根本不依赖任何内存可用性），然后退出范围。它将触发析构函数链，所有这些数据都应该被释放。

这很好用。但我碰巧在一个循环中进入这个奇怪的范围不是一次而是 10 次。它有时会工作 2 或 3 次。有时只有一次。下次我只会得到内存不足的错误，就是这样。

从我的角度来看，我需要重新启动整个过程才能真正强制释放内存。有没有一种方法可以在单个过程中实现这一目标？

我可以考虑尝试不同的分配器——也许是 CRT 问题？我也玩了一点堆操作（即低碎片堆），但也没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:17:49.083

为什么不使用 MEM_RESERVE通过几个大型[VirtualAlloc调用来保留进程的整个内存空间。](http://msdn.microsoft.com/en-us/library/aa366887%28v=VS.85%29.aspx)然后，您稍后将在每个内存范围上调用 VirtualFree 以释放。这仍然需要一些堆分配，就像您在这里所做的那样，以耗尽当前堆的其余部分。它会更快并消除您必须经历的页面文件流失。

至于你的具体问题，不知道你为什么会遇到。保留所有内存以使堆无法扩展应该有助于减少不确定性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:29:01.687

如果您使用大量内存，请使用某种平板分配（VirtualAlloc 将为您提供内存），然后，原则上[假设您在该块中创建的对象不需要析构函数做某事] ，您可以一次性扔掉整个块，而不是使用无数次删除 - 额外的好处是节省时间并保证您的内存已完全释放。

我怀疑您可能遇到问题的一个原因是必须先清除已释放的块，然后才能回收它们。这是在内核的后台线程中完成的。当然，使用 VirtualALloc 实际上对这个帐户没有帮助。

当然，您也可能会出现内存碎片，在这种情况下，使用旨在避免这种情况的磁头会起作用。

# django - 转移到服务器后 Django 站点出现 500 服务器错误

> ID：14076643
> 
> 赞同：2
> 
> 时间：2012-12-28T22:35:52.917
> 
> 标签：django, configuration, apache2, mod-wsgi, django-1.4

我在本地机器上使用 Django 站点和 Ubuntu，刚刚上传但收到 500 内部服务器错误，我无法理解原因。

似乎无法看到某些模块，可能是它没有查看我的设置文件？以下是此问题的错误日志，可能揭示了正在发生的事情：

```
 [Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10] mod_wsgi (pid=23248): Exception occurred processing WSGI script '/var/www/kaasib/pypr$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10] Traceback (most recent call last):
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/wsgi.py", line 24$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     response = self.get_response(request)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py", line 17$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     response = self.handle_uncaught_exception(request, resolver, sys.exc_info())
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py", line 22$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return debug.technical_500_response(request, *exc_info)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/views/debug.py", line 66, in te$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     html = reporter.get_traceback_html()
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/views/debug.py", line 276, in g$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return t.render(c)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/base.py", line 140, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return self._render(context)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/base.py", line 134, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return self.nodelist.render(context)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/base.py", line 823, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     bit = self.render_node(node, context)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/debug.py", line 74, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return node.render(context)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/debug.py", line 84, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     output = self.filter_expression.resolve(context)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/base.py", line 599, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     new_obj = func(obj, *arg_vals)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/template/defaultfilters.py", li$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return format(value, arg)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/dateformat.py", line 310,$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return df.format(format_string)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/dateformat.py", line 33, $
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     pieces.append(force_unicode(getattr(self, piece)()))
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/dateformat.py", line 214,$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return self.format('D, j M Y H:i:s O')
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/dateformat.py", line 33, $
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     pieces.append(force_unicode(getattr(self, piece)()))
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/encoding.py", line 71, in$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     s = unicode(s)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/functional.py", line 121,$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return func(*self.__args, **self.__kw)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/translation/__init__.py",$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return _trans.ugettext(message)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/translation/trans_real.py$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     return do_translate(message, 'ugettext')
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/translation/trans_real.py$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     _default = translation(settings.LANGUAGE_CODE)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/translation/trans_real.py$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     default_translation = _fetch(settings.LANGUAGE_CODE)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/translation/trans_real.py$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     app = import_module(appname)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]   File "/usr/local/lib/python2.7/dist-packages/django/utils/importlib.py", line 35, i$
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10]     __import__(name)
[Sat Dec 29 02:59:37 2012] [error] [client 139.190.233.10] ImportError: No module named company 
```

这是 httpd.conf 文件的内容：

```
WSGIPythonPath /var/www/kaasib/pyproject/kaasib/

<Directory /var/www/kaasib/pyproject/kaasib/kaasib/>
<Files wsgi.py>
Order deny,allow
Allow from all
</Files>
</Directory> 
```

WSGISCRIPTAlis 行位于站点可用的 vhost 文件中。以下是 wsgi 文件的内容：

```
"""
WSGI config for kaasib project.

This module contains the WSGI application used by Django's development server
and any production WSGI deployments. It should expose a module-level variable
named ``application``. Django's ``runserver`` and ``runfcgi`` commands discover
this application via the ``WSGI_APPLICATION`` setting.

Usually you will have the standard Django WSGI application here, but it also
might make sense to replace the whole Django WSGI application with a custom one
that later delegates to the Django one. For example, you could introduce WSGI
middleware here, or combine a Django application with an application of another
framework.

"""
import os

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "kaasib.settings")

# This application object is used by any WSGI server configured to use this
# file. This includes Django's development server, if the WSGI_APPLICATION
# setting points here.
from django.core.wsgi import get_wsgi_application
application = get_wsgi_application()

# Apply WSGI middleware here.
# from helloworld.wsgi import HelloWorldApplication
# application = HelloWorldApplication(application) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:46:51.120

查看您的 apache conf 文件和您的应用程序的 wsgi conf 文件会很有帮助。

正如您所建议的，您的公司模块似乎找不到。这可能是因为很多原因。我将首先检查您的 WSGIPythonPath 并确保它包含您的应用程序。

查看[Django WSGI 部署指南](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/)了解更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T03:36:10.743

在我看来，您的项目不在您的 pythonpath 中。尝试在 wsgi.py 顶部添加它，看看效果如何：

```
import os, sys

path = '/path-to/your/project-root/'
if path not in sys.path:
   sys.path.append(path) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T22:49:17.920

您是否通过 pip 或其他方式在远程服务器上安装了模块？它根本找不到模块名称公司。此外，请确保在设置文件中安装的 INSTALLED_APPS 中包含“公司”模块。

# javascript - 如何获得一致的 javascript window.outerHeight 跨浏览器？

> ID：14076650
> 
> 赞同：1
> 
> 时间：2012-12-28T22:36:19.643
> 
> 标签：javascript, cross-browser, height, pixel

也许这是一个菜鸟问题，但......

我有一个网站，我希望页脚始终出现在同一个地方。假设我的用户都使用 >= IE8、Chrome 和 Firefox，我认为这只是获取 Window.outerHeight 的问题。

但是当我测量 window.outerHeight 它在 FF v. Chrome v. IE 中返回不同的值。

另外，只是在视觉上做一些基本的测量，很明显 500px DIV 在我的 Chrome 和 FF 和 IE 中的显示器上的高度不同。

SO：是否有一些“公式”可以可靠地用于跨浏览器转换像素大小，以便可以为某个 div 设置适当的“最大高度”，并知道它在 IE、Chrome 和法郎？

再次......我并不真正关心真正的“普遍”。我的 99% 的用户将拥有这 3 种浏览器，所以如果我能获得这些浏览器，我会非常高兴。

TIA,

---JC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T00:18:26.577

对于 IE8，您可以使用`document.body.offsetHeight`.

但我建议只使用 CSS：

```
<div id="footer" style="position: fixed; bottom: 0;"></div> 
```

（例如：http: [//jsfiddle.net/5h8zj/](http://jsfiddle.net/5h8zj/)）

# google-app-engine - 谷歌应用引擎 java 数据存储是否缓存 JPA 查询结果？

> ID：14076653
> 
> 赞同：2
> 
> 时间：2012-12-28T22:36:40.750
> 
> 标签：google-app-engine, jpa, google-cloud-datastore, jpa-2.0, datanucleus

我正在使用 DN3 和 GAE 1.7.4。我使用 JPA2，根据文档，默认情况下启用了 Level2 缓存。

这是我的问题：

如果我运行一个返回一些对象的查询，这些对象是否会通过它们的 ID 自动放入缓存中？

如果我`em.find()`使用已经加载了另一个查询的对象的 id 运行，`createQuery().getResultList()`它会在缓存中可用吗？

我是否需要`em.find()`在事务中运行我的或查询才能启动缓存？

我需要澄清一下这个缓存是如何工作的，以及我如何进行查询/查找/持久化以充分利用缓存。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:07:39.223

来自[Google App Engine：将 JPA 与 App Engine 结合使用](https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2)

> 默认情况下启用二级缓存。要获得以前的默认行为，请将持久性属性 datanucleus.cache.level2.type 设置为 none。（或者在类路径中包含 datanucleus-cache 插件，并将持久性属性 datanucleus.cache.level2.type 设置为 javax.cache 以使用 Memcache 进行 L2 缓存。

至于您的疑问，这取决于您的查询以及 DataNucleus 和 GAE Datastore 适配器实现细节。正如[Carol McDonald 所建议](https://blogs.oracle.com/carolmcdonald/entry/jpa_caching)的那样，我相信找到问题答案的最佳途径是使用 JPA2 [Cache](http://docs.oracle.com/javaee/6/api/javax/persistence/Cache.html)接口......更具体地说是[contains](http://docs.oracle.com/javaee/6/api/javax/persistence/Cache.html#containscontains(java.lang.Class%2C%20java.lang.Object))方法。

运行您的查询，通过 访问`Cache`界面`EntityManagerFactory`并查看 2 级是否缓存`contains`了所需的实体。

启用[DataNucleus](https://stackoverflow.com/questions/10193919/how-to-set-loglevel-of-the-appengine-datastore-in-java)日志还将为您提供有关幕后发生的事情的良好提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T11:20:11.047

在开发本地 GAE 模式下调试后，我发现 2 级缓存可以工作。无需交易开始/提交。我对主键以及 em.find() 的简单查询的结果将通过它们的主键放入缓存中。

然而，本地开发服务器中的默认缓存超时就像几秒钟，我不得不添加这个：

```
 <property name="datanucleus.cache.level2.timeout" value="3600000" /> 
```

到persistence.xml。

# asp.net-mvc - 如何获取 NuGet 更新版本的签名以匹配他安装的版本？

> ID：14076656
> 
> 赞同：0
> 
> 时间：2012-12-28T22:36:55.573
> 
> 标签：asp.net-mvc

我正在使用 Visual Wb Developer 2012 Express。我正在尝试更新 NuGet。在错误日志中我发现：

安装错误：VSIXInstaller.SignatureMismatchException：“NuGet 包管理器”更新版本上的签名与已安装版本上的签名不匹配。因此，Extension Manager 无法安装更新。VSIXInstaller.Common.VerifyMatchingExtensionSignatures(IInstalledExtension installedExtension, IInstallableExtension updateExtension) VSIXInstaller.InstallProgressPage.BeginInstallVSIX(SupportedVSSKU targetAppID)

如何获取 NuGet 更新版本的签名以匹配他安装的版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:38:36.117

Nuget 在升级方面存在一些问题，需要用户首先卸载旧插件，然后重新安装新版本。试一试。之后的升级*应该*没问题。

# php - 从单个文件输入类型一次转换为多个文件上传。新手的东西

> ID：14076660
> 
> 赞同：0
> 
> 时间：2012-12-28T22:37:06.967
> 
> 标签：php, upload

我有一个通过表单上传图像的脚本。我想从：

```
<input type="file" name="img_1_upload" class="text">
<input type="file" name="img_2_upload" class="text">
<input type="file" name="img_3_upload" class="text">
<input type="file" name="img_4_upload" class="text">
<input type="file" name="img_5_upload" class="text">
<input type="file" name="img_6_upload" class="text"> 
```

要通过以下方式使用多个上传输入类型：

```
<input name="images[]" id="filesToUpload" type="file" multiple="" /> 
```

我的 PHP 脚本检测输入的图像名称 = img_1_upload,img_2_upload,img_3_upload... 一直到 img_6_upload...

但是，使用多文件输入类型，我无法将每个文件的名称设置为 img_1_upload、.. 等格式。

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:47:01.460

您是否尝试过[move_uploaded_file()](http://php.net/manual/en/function.move-uploaded-file.php)功能？上传的文件无论如何都是临时文件。您可能需要将它们移动到更合适的位置。移动时，您还可以将文件重命名为您想要的任何名称。

PS：我假设您知道可以使用`$_FILES["images"]["name"][index]`where index 是从 0 到文件数 - 1 的数组索引来访问文件的名称。

P.S2：还要确保您的表单具有`enctype="multipart/form-data"`多个文件的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:55:08.283

$_FILES 数组包含上传文件的信息。上传多个文件时，$_FILES 的结构如下；大批

```
(
    [name] => Array
        (
            [0] => foo.txt
            [1] => bar.txt
        )

    [type] => Array
        (
            [0] => text/plain
            [1] => text/plain
        )

    [tmp_name] => Array
        (
            [0] => /tmp/phpYzdqkD
            [1] => /tmp/phpeEwEWG
        )

    [error] => Array
        (
            [0] => 0
            [1] => 0
        )

    [size] => Array
        (
            [0] => 123
            [1] => 456
        )
) 
```

然后，您可以使用简单的`foreach()`循环根据需要重命名文件。

# java - 表中的行删除

> ID：14076661
> 
> 赞同：-2
> 
> 时间：2012-12-28T22:37:10.533
> 
> 标签：java, swing, jtable

我的整个代码是这样的，但是我的代码有一个错误并且没有运行：从文件中读取是正确的，但不要删除行。

```
public class AllUserTable extends AbstractTableModel{

Vector data;
Vector columns;
public AllUserTable() {

        String line;
        data = new Vector();
        columns = new Vector();
        try {
        FileInputStream fis = new FileInputStream("D:\\AllUserRecords.txt");
        BufferedReader br = new BufferedReader(new InputStreamReader(fis));
      StringTokenizer st1 = new StringTokenizer(br.readLine(), " ");
              while (st1.hasMoreTokens())
               columns.addElement(st1.nextToken());
                while ((line = br.readLine()) != null) {
                       StringTokenizer st2 = new StringTokenizer(line, " ");
                        while (st2.hasMoreTokens())
                                data.addElement(st2.nextToken());
                }
                br.close();
        } catch (Exception e) {
                e.printStackTrace();
        }
}

public int getRowCount() {
        return data.size() / getColumnCount();
}

public int getColumnCount() {
        return columns.size();
}

public Object getValueAt(int rowIndex, int columnIndex) {
        return (String) data.elementAt((rowIndex * getColumnCount())
                        + columnIndex);
}

  public static void main(String[] args){

    final AllUserTable aut1=new AllUserTable();
    final JFrame frame1=new JFrame();
    final JTable table=new JTable();
    final JPanel panel=new JPanel();
    JButton button1=new JButton("Delete");

     button1.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            DefaultTableModel model=new DefaultTableModel(data,columns);  //Error!
            model.removeRow(table.getSelectedRow());
            table.setModel(model);
            table.setModel(aut1);
            panel.add(table);
        }
    });

    JScrollPane scroolpane=new JScrollPane();
    scroolpane.setViewportView(table);
    panel.add(scroolpane);
    panel.add(button1);
    frame1.add(panel);
    frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame1.setBounds(200, 80, 600, 500);
    frame1.setVisible(true);
}
} 
```

请修复我的代码！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T22:51:03.497

此代码无法编译。您正在从静态方法 (main) 引用实例字段 ( `data`, `columns`)。编译器的错误信息应该告诉你。如果你不明白，谷歌搜索错误信息应该会引导你找到错误信息的解释。

即使它是编译器，这里是事件监听器每一行的解释：

```
DefaultTableModel model=new DefaultTableModel(data,columns); 
```

创建一个新的表模型。为什么？你的桌子已经有一个了。您只需要修改现有的表模型

```
model.removeRow(table.getSelectedRow()); 
```

从这个新的表模型中删除一行。为什么要修改新模型而不是修改现有模型？

```
 table.setModel(model); 
```

用新型号替换旧型号。这是非常低效的。该表已经有一个模型。修改它。

```
 table.setModel(aut1); 
```

用旧型号替换新型号。为什么？

```
 panel.add(table); 
```

将表格添加到框架的主面板。为什么？桌子已经在那里并且可见。这是没有意义的。

您应该`deleteRow()`在 AbstractTableModel 中实现一个方法。

使用对象列表（每行代表一行）也比使用单个列表表示所有行要清晰得多。

我感觉您在复制和粘贴代码时完全不了解它是如何工作的以及 Swing 的架构是什么。阅读 Swing 教程。甚至在此之前，阅读一本关于 Java、变量和范围的介绍性书籍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T22:48:49.367

首先，您永远不会`aut1`在按钮操作之前将表格模型 ( ) 设置为表格。

其次，当您在操作处理程序中构造新数据时，我看不到数据和`columns`定义的位置`DefaultTableModel`- 您尝试从这个“新”表模型中删除一行并将其应用于表，然后替换为 with `aut1`，这有效地做了....什么也没做。

在构建你的 UI 时，不要忘记将表格模型设置为表格...`table.setModel(aut1)`

`DefaultTableModel`从动作处理程序中删除并改用`aut1`。

**更新了建议**

*   你应该避免在方法中构建你的 UI `static main`，而是使用一个类实例，它会让你的代码更清晰，并且将来会出现更少的问题
*   您应该只在事件调度线程的上下文中构造/操作 UI/Swing 组件，使用`EventQueue#invokeLater`

# javascript - 使用 javascript 将大型 DataUri 发布到另一台服务器

> ID：14076667
> 
> 赞同：1
> 
> 时间：2012-12-28T22:38:10.127
> 
> 标签：javascript, image, http-post, data-uri

我有一个包含图像 dataUri 的字符串。我需要将此字符串发布到另一个远程服务器，所以我使用表单和 iframe 技术来做到这一点。

问题是，当字符串太大（图像太大）时 - 服务器不接受它。这意味着，该字符串在服务器上显示为“null”。我在 SO 上阅读了很多关于这个问题的内容，所有答案都以这种或另一种方式依赖于 Bolb 对象。不幸的是，IE9 不支持它。

有没有办法将一个（非常）大的字符串从客户端传递到服务器？multipart post 也不起作用，因为（据我了解）它仅适用于文件，而不适用于参数。

# python - 使用 Tkinter 打开网页

> ID：14076674
> 
> 赞同：4
> 
> 时间：2012-12-28T22:38:51.063
> 
> 标签：python, tkinter

所以我的应用程序需要能够在其中打开一个网页（它必须来自互联网而不是保存），特别是我想使用 Tkinter GUI 工具包，因为它是我最舒服的一个。最重要的是，我希望能够在窗口中生成事件（比如鼠标单击），但实际上不使用鼠标。有什么好的方法可以解决这个问题？

**编辑：**我想澄清一下，我需要一种方法来加载网页，甚至可能是特定的 java 小程序到 tkinter 小部件或窗口中。或者，如果不是这样，也许另一种方法可以做到这一点，我可以在不使用键盘鼠标的情况下生成鼠标和键盘事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T12:59:21.177

如果您希望它在您的 GUI 中打开，请使用 Bryans 建议，如果您只想打开一个网页，您可以使用：

```
import webbrowser

webbrowser.open("page.html") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T00:13:48.960

Tkinter 没有可以呈现网页的小部件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-07-16T08:29:49.323

您应该使用`pywebview`它非常简单，只需编写三行代码。

我使用了它，但就我而言，它并非在任何地方都有效。评论并让我知道它是否适合您。

适用于任何地方的最佳选择是`PyQt`'s`QtWebview`模块。您可能会遇到一个问题是重命名窗口，所以这里是解决方案

```
web.setWindowTitle(title) 
```

您可以按原样使用所有功能，但只需替换`window`或`self`使用`web`上述代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-22T10:12:29.293

所以我找到了这个名为 pywebview 的模块

```
pip install pywebview 
```

示例代码： -

```
import webview
webview.create_window('duckduckgo', 'https://www.duckduckgo.com')
webview.start() #this will open the webpage in a new window 
```

# spring-mvc - 如何创建一个将相同模型返回到任意视图（HTML-Form 或 Ajax）的控制器？

> ID：14076682
> 
> 赞同：1
> 
> 时间：2012-12-28T22:40:01.247
> 
> 标签：spring-mvc

在我对 MVC 模式的经典理解中，控制器不必知道视图的任何实现细节。我想要一个由事件（a `@RequestMapping`）触发并返回模型的控制器。如何呈现模型取决于视图。

具体用例是将商品添加到购物车中。我有两个视图，一个简单的 HTML 视图和一个更丰富的 Ajax 视图。在我梦寐以求的场景中，两个视图都向相同的 URI 发出请求，并点击了我的控制器中的唯一方法：

```
@Controller
public class ShoppingCartController {

    @RequestMapping("/add")
    public String addItem(@RequestParam String itemId, Model model) {
        // …
        model.add(shoppingCart);
        return "cart";
    }

} 
```

我的 Ajax 视图向 /add?itemId=abc 发送请求，理想情况下将获得 JSON 格式的模型。我的 HTML 视图发送到相同的请求并将模型呈现为 JSP。

我目前的方法是在控制器中实现第二种方法，该方法调用`addItem()`并返回 JSON：

```
@RequestMapping(value="/add", headers="x-requested-with=XMLHttpRequest")
public @ResponseBody ShoppingCart addItemByAjax(@RequestParam String itemId, Model model) {
    addItem(itemId, model);
    return model.asMap().get("shoppingCart");
} 
```

我不太喜欢用依赖于视图的模型适配器来装饰每个控制器的想法。是否有更通用的方式来提供模型的适当表示形式的视图？我希望我的控制器中只有一种方法可以将模型发送到任何视图。当然，堆栈中的某处必须存在一个处理程序，如果某些条件为真（假设 x-requested-with=XMLHttpRequest），该处理程序决定将模型作为 JSON 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T23:37:33.860

`ContentNegotiatingViewResolver`配置`MappingJackson2JsonView`为默认视图似乎有帮助。这比阅读文档更多的是反复试验。另外对我来说，将默认视图设置为 JSON 并不那么直观。我想知道你们是如何在 Spring 3.2 之前解决这个常见用例的。

# shell - 从 emacs 调用 shell

> ID：14076683
> 
> 赞同：1
> 
> 时间：2012-12-28T22:40:06.553
> 
> 标签：shell, emacs, elisp, key-bindings

我有一个可以从终端命令行使用的可执行文件。

`$ foo "bar"` 返回单行文本

我希望能够在编辑文件时调用此函数。

我可以看到我可以执行以下操作

`M-! ~/Library/yolo/bin/foo "bar"` 我得到了我正在寻找的东西。

所以我正在尝试编写一个函数，然后我可以绑定到键。但我很难过。

```
(setq foobar-path "~/Library/yolo/bin/foo ")
(defun foo-bar (func)
  (shell-command (concat foobar-path func)))

(global-set-key (kbd "M-p") foo-bar) 
```

但我知道（emacs 告诉我）我还有很长的路要走。

我最理想的结果是一个键绑定，它可以将一行代码（如评估最后一个表达式）发送到外部函数，并在消息栏中的屏幕底部显示返回。

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:04:26.343

您的代码有两个问题：

*   您需要引用传递给的符号`global-set-key`。
*   该功能必须是“命令”。这是通过包含顶级`interactive`表单标记为可交互调用的任何 emacs 函数。

特别是，如果你想`func`从 minibuffer 中传入参数，你可以这样做：

```
(setq foobar-path "~/Library/yolo/bin/foo ")
(defun foo-bar (func)
  (interactive "sEnter func: ")
  (shell-command (concat foobar-path func)))

(global-set-key (kbd "M-p") 'foo-bar) 
```

# cakephp - CakePHP 将数据导入到没有模型的表中

> ID：14076687
> 
> 赞同：2
> 
> 时间：2012-12-28T22:40:39.257
> 
> 标签：cakephp, model, controller

我正在构建一个 CakePHP 应用程序，我有一个与任何控制器/模型无关的 MySQL 表，但我需要在我的一个控制器/模型中插入/更新/获取该表中的数据，我想用`find`函数（我知道我可以编写 SQL 语句并`->query`在我的模型中制作，但我不想这样做）。我在网上看到的唯一解决方案是连接模型和类似的东西。我的情况有什么解决方案吗？

先感谢您！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T22:44:06.643

控制器不需要使用模型来成为有效模型。如果您想使用模型特征对表进行操作，请为其创建模型或即时使用模型。

然后，您可以通过关联（belongsTo、hasOne）从另一个模型中使用该模型。或者，使用创建一个实例`ClassRegistry::init('ModelName');`

如果您不要求 Model 有任何关联，而只是想快速访问以查找记录。您可以调用`ClassRegistry::init('ModelName')`，CakePHP 将为您自动创建模型。（`ModelName`应该是**CamelCase**版本的表格，见[约定](http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html#model-and-database-conventions)）

例如：您的数据库中有一个名为`documents`但没有`Document.php`模型文件的表。调用`ClassRegistry::init('Document');`将动态为该表创建一个模型。

```
ClassRegistry::init('Document')->find('all'); 
```

甚至

```
$Document = ClassRegistry::init('Document');
$Document->find('all'); 
```

在控制器中，您也可以`loadModel()`即时使用

```
$this->loadModel('Document');
$this->Document->find('all'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-18T10:08:29.497

我们可以在不创建模型文件的情况下对表进行操作。

如果我们有名为“Holidays”的表，那么我们可以在控制器中获取如下详细信息。

```
$this->loadModel("Holiday");
$result = $this->Holiday->find('all'); 
```

# python - django haystack 搜索表单找不到 is_vald 方法

> ID：14076691
> 
> 赞同：0
> 
> 时间：2012-12-28T22:41:01.193
> 
> 标签：python, django, django-forms, django-haystack

我正在使用 haystack 对我的 Person 模型针对所有选定的过滤器属性执行简单的搜索查询。我决定尝试分面搜索表单并创建了一个通用的 TemplateView `SearchView`。

```
class SearchView(TemplateView):
    template_name = "index.html"
    results = EmptySearchQuerySet()
    form_class = FacetedSearchForm
    form = None
    query = ''
    selected_people = None

    def get(self, request, **kwargs):
        self.request = request
        self.query = self.get_query()
        if self.form.is_valid():
            self.results = self.get_results()
        context = self.get_context_data(request, **kwargs)

        if request.is_ajax() or request.GET.get('ajax'):
            self.template_name = 'search/Taleebo/search_results.html'

        return self.render_to_response(context)

    def get_query(self):
        return self.request.GET.get('q')

    def get_results(self):
        return self.form.search() 
```

所有的路由都工作正常，但是当我的`get`方法被调用时，它就失败了

```
self.form.is_valid() 
```

有一个错误说`NoneType' object has no attribute 'is_valid'`

我正在使用默认的 form_class，所以不应该定义该属性吗？

编辑：

我现在正在尝试使用 haystack 提供的 SearchView，is_valid 不再是问题，但我没有从“结果”中获取任何记录。我改变了我的 urls.py 看起来像这样

```
 url(r'^search/person/', search_view_factory(
    view_class=SearchView,
    template='index.html',
    form_class=ModelSearchForm
), name='haystack_search'), 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:48:23.230

当您没有要访问的实例时，使用任何类都会导致相同的错误：

```
class SearchView(TemplateView):
(...)
      form = None  //<= Here you set the form to None 
```

因此，您调用`is_valid()`的是`None`，而不是实际表单。

# php - 从 sql 数据库中对类别列表中的一组子类别进行排序

> ID：14076693
> 
> 赞同：2
> 
> 时间：2012-12-28T22:41:19.863
> 
> 标签：php, database, loops, mysqli, while-loop

我有这个代码，但我不知道如何订购我的查询

```
function get_All_Categories(){
//new instance of mysqli
    $mysqli = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
    //if it doesn't work give an error
    if (!$mysqli) {
        die('There was a problem connecting to the database.');
    }
    $queryCats ="SELECT Catid, Catname
                 FROM ProductCats
                 ORDER BY Catid";
    $querySubCats ="SELECT Subcatname, Parentid
                    FROM ProductSubCats, ProductCats
                    WHERE ProductSubCats.Parentid = ProductCats.Catid
                    ORDER BY Subcatname;";
    if ($catResults = $mysqli->query($queryCats)){
        if (!$catResults) {
            echo 'Could not run query: ' . mysql_error();
            exit;
        }
        else{
            $subCatResults = $mysqli->query($querySubCats);
        }
        while ($rows = $catResults->fetch_assoc()) {
            echo '<div class = "categoryCluster">';
            echo '<a href="../index.php?Cat='.$rows["Catname"].'">'.$rows["Catname"].'</a>';
            echo '<br>';
            while($rowsSub = $subCatResults->fetch_assoc()){
                echo '<div class="subCategoryCluster">';
                echo '&emsp;'.'<a href="../index.php?Cat='.$rows["Catname"].'&'.'Subcat='.$rowsSub["Subcatname"].'">'.$rowsSub["Subcatname"].'</a>';
                echo '<br>';
                echo '</div>';
            }
            echo '</div>';
        }
    }
    $mysqli->close();
} 
```

显示此输出：

```
Header 1
 Subcat 1
 Subcat 2
 OtherSubcat 1
Header 2
Header 3
Header 4
Header 5
Header 6 
```

但我的问题是 subcat 1 和 subcat 2 的 parentid 为 1，符合标头 1，但是 othersubcat 1 的 parentid 为 5。实际上符合标头 5。是的，在我的循环中，它显示在其他 2 之后.

现在我知道为什么这是错误的了，这是因为 while 循环中的 while 循环命令它最后出现，并将其粘贴在那里。

但我完全不知道如何修改它以使其显示：

```
Header 1
 Subcat 1
 Subcat 2
Header 2
Header 3
Header 4
Header 5
 OtherSubcat 1
Header 6 
```

样品表：

```
>     ProductSubCats
>     Subcatid  |  Subcatname   | Parentid
>     1         | Subcat 1      | 1
>     2         | Subcat 2      | 1
>     3         | Othersubcat 3 | 5
> 
> 
> 
> ProductCats
>     Cat id   |   Catname
>     1        | Header 1
>     2        | Header 2
>     3        | Header 3
>     4        | Header 4
>     5        | Header 5
>     6        | Header 6 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:04:51.053

您需要将数据库查询循环与显示循环分开。首先为两个查询获取所有数据并将其存储在两个关联数组中。为了使第二步更容易，按如下方式构建您的子类别数组：

*   键 - 父 ID
*   值 - 具有此父 ID 的所有子类别的数组

其次，遍历类别数组。对于每个元素：

*   打印出类别名称
*   循环使用此父 ID 的子类别 - 打印它们

像这样：

```
//assuming you populated $catResults and $subCatResults as in your example
$categories = array();
$sub_categories = array();

while($row = $catResults->fetch_assoc()) {
 $categories[$row['Catid']] = $row['Catname'];
}
while($row = $subCatResults->fetch_assoc()) {
 if (!isset($sub_categories[$row['Parentid']])) {
  $sub_categories[$row['Parentid']] = array();
 }
 $sub_categories[$row['Parentid']][] = $row['Subcatname'];
}

//display
foreach ($categories as $cat_id => $name) {
 echo $name;
 if (isset($sub_categories[$cat_id])) {
  foreach($sub_categories[$cat_id] => $sub_cat_name) {
   echo '  ' . $sub_cat_name;
  }
 }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T14:59:31.607

对于您要执行的操作，请遵循 @Pasha Bitz 所说的内容。

尝试以下操作：

```
$categories = array();
        $sub_categories = array();  
        while ($rows = $catResults->fetch_assoc()) {
            $categories[$rows['Catid']] = $rows['Catname'];
        }
        while($rows = $subCatResults->fetch_assoc()){
            if (!isset($sub_categories[$rows['Parentid']])) {
                $sub_categories[$rows['Parentid']] = array();
            }
            $sub_categories[$rows['Parentid']][] = $rows['Subcatname'];
        }
        foreach ($categories as $cat_id => $name) {
            echo '<div class = "categoryCluster">';
            echo '<a href="../index.php?Cat='.$name.'">'.$name.'</a>';
            echo '<br>';
            if (isset($sub_categories[$cat_id])) {
                foreach($sub_categories[$cat_id] as $cat_id => $sub_cat_name) {
                    echo '<div class="subCategoryCluster">';
                    echo '&emsp;'.'<a href="../index.php?Cat='.$name.'&'.'Subcat='.$sub_cat_name.'">'.$sub_cat_name.'</a>';
                    echo '<br>';
                }
            }
        } 
```

那应该为您解决这个问题，研究代码，以便您了解这里发生了什么。

# android - ClassNotFoundException 使用 AndroidAnnotations

> ID：14076694
> 
> 赞同：4
> 
> 时间：2012-12-28T22:41:20.803
> 
> 标签：android, android-annotations

我尝试使用 AndroidAnotaions，但`ClassNotFoundException`在我的项目中出现错误。

出于测试目的，我创建了一个新项目，`Activity`但仍然出现错误。我的文件：

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.rodrigora.testannotations"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.rodrigora.testannotations.MainActivity_"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

MainActivity.java

```
package com.rodrigora.testannotations;

import android.app.Activity;
import android.view.Menu;

import com.googlecode.androidannotations.annotations.EActivity;

@EActivity(R.layout.activity_main)
public class MainActivity extends Activity {

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

这些是我从 Eclipse 创建的示例项目中更改的两个文件，并按照以下步骤将 AndroidAnnotations 添加到项目中：

1.  添加`androidannotations-api-2.7.jar`到`libs`文件夹和`build path`
2.  添加`androidannotations-2.7.jar`到`compiled-libs`文件夹和`Factory Path`
3.  `androidannotations-2.7.jar`在标签中标记`Order and Export`。

这是我启动应用程序时的堆栈跟踪：

```
12-28 20:29:21.296: E/AndroidRuntime(30600): FATAL EXCEPTION: main
12-28 20:29:21.296: E/AndroidRuntime(30600): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.rodrigora.testannotations/com.rodrigora.testannotations.MainActivity_}: java.lang.ClassNotFoundException: com.rodrigora.testannotations.MainActivity_ in loader dalvik.system.PathClassLoader[/data/app/com.rodrigora.testannotations-2.apk]
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1573)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.os.Looper.loop(Looper.java:130)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.ActivityThread.main(ActivityThread.java:3687)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at java.lang.reflect.Method.invokeNative(Native Method)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at java.lang.reflect.Method.invoke(Method.java:507)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at dalvik.system.NativeStart.main(Native Method)
12-28 20:29:21.296: E/AndroidRuntime(30600): Caused by: java.lang.ClassNotFoundException: com.rodrigora.testannotations.MainActivity_ in loader dalvik.system.PathClassLoader[/data/app/com.rodrigora.testannotations-2.apk]
12-28 20:29:21.296: E/AndroidRuntime(30600):    at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
12-28 20:29:21.296: E/AndroidRuntime(30600):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1565)
12-28 20:29:21.296: E/AndroidRuntime(30600):    ... 11 more 
```

有谁知道我忘记了什么？Eclipse 应该显示生成的类`AndroidAnnotations`？

谢谢！

**编辑**

**[完整代码-bitbucket](https://bitbucket.org/rodrigora/testannotations/src)**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T19:02:11.807

看起来您的 AndroindAnnotation 生成的类未包含在您的构建中。这是您的 .classpath 似乎缺少的行-

```
 <classpathentry kind="src" path=".apt_generated">
               <attributes>
                       <attribute name="optional" value="true"/>
               </attributes>
   </classpathentry> 
```

这些应该是在安装 AndroidAnnotations 的过程中为您生成的。检查事项——

*   您的 ADT 工具是最新的。

*   您`Project->Clean`在启用注释后运行

我能够使用以下步骤克隆您的存储库，导入 Eclipse，并获得一个干净的构建并运行该应用程序而不会崩溃 -

1.  将项目重构/重命名为 TestAnnotations（eclipse 导入为“MainActivity_”）
2.  开启注解处理（需要开启`Enable project specific settings`并`Enable annonation processing`在`Java Compiler->Annontation Processing中）
3.  项目->清洁
4.  运行

*注意：*如果我进行了导入并且只是重构以获得干净的构建，但没有启用注释处理，我会得到与您描述的完全相同的行为。检查以确保您启用了项目特定设置、注释，然后进行干净的构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-01T14:38:20.507

使用 maven 和 eclipse 更新项目配置会导致 android 注释输出文件夹被更改。要修复它，请转到 java build path>Source 并将 android 注释文件夹的输出设置为默认输出文件夹。

# javascript - 为什么 `this` 失去了与我的对象的绑定？

> ID：14076702
> 
> 赞同：1
> 
> 时间：2012-12-28T22:42:54.737
> 
> 标签：javascript, recursion, this, javascript-objects

我正在尝试创建一个递归方法，但它正在失去对`this`. 这是重新创建我的问题的最简单方法：

```
var Foo = function() {
    return {
        foo : 'foo',
        bar : function() {
            co​nsole.log(this.foo);
            setTimeout(this.bar, 500);
        }
    }​;
}
var foo = new Foo();
foo.bar();​ 
```

那只会运行两次。第一次将记录`foo`到控制台，第二次将记录`undefined`. 然后，当然，它不再运行，因为`bar`不再是 的属性，`this`因为我认为它已重置为全局对象。

我尝试`var that = this`了我的`bar`方法和引用`that.foo`，`that.bar`但它没有改变任何东西。我也尝试过`var that = this`我的`return`陈述，但问题仍然存在。

预期结果：

> 富
> 
> 富
> 
> 富
> 
> 富
> 
> ... 等等

这是一个示例[http://jsfiddle.net/k2hTJ/](http://jsfiddle.net/k2hTJ/)，结果如下：

> 富
> 
> 不明确的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T22:46:23.997

`setTimeout`将在当前范围内调用其函数，但`this`作为全局对象。

解决此问题的最佳方法是执行以下操作：

```
var that = this;
setTimeout(function() {that.bar.apply(that);},500); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T22:54:16.683

```
foo = {
    foo: 'bar',
    bar: function() {
        console.log(foo.foo);
        setTimeout(foo.bar, 500);
    }
};
foo.bar();​ 
```

这也可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T22:49:10.520

这有效：

```
var Foo = function() {
    return {
        foo : 'foo',
        bar : function() {
            co​nsole.log(this.foo);
            setTimeout(this.bar(), 500); //Add '()'
        }
    }​;
}
var foo = new Foo();
foo.bar();​ 
```

# c++ - 通过 Python BOOST 使用派生类 (C++)

> ID：14076708
> 
> 赞同：0
> 
> 时间：2012-12-28T22:43:33.227
> 
> 标签：c++, python, boost, derived-class

我有我想在 Python 中使用的 C++ 类：

```
#include "ExtraClass.h"
class CApp
{
   ...
   ExtraClass Bar; //there is function Foo()
}

BOOST_PYTHON_MODULE( CApp )
{
class_<ExtraClass>("ExtraClass",init<>())
    .def("Foo",&ExtraClass::Foo)
    ;
    class_<CApp>("CApp", init<>()) 
    .def_readonly("Bar", &CApp::Bar)
    ; 
```

编译没问题。所以我有 CApp.so 文件要在 Python 中导入。所以问题从 Python 开始：

```
from CApp import *
class pyApp(CApp):
def __init__(self):
    print "<--INIT-->"
CApp = CApp()
pyApp = pyApp()
print CApp.Bar.Foo()
print pyApp.Bar.Foo() 
```

输出：

```
<--INIT-->
FOO // <- this is from CApp.Bar.Foo()
Traceback (most recent call last):
  File "./pytest.py", line 16, in <module>
print pyApp.Bar.Foo()
Boost.Python.ArgumentError: 
Python argument types in None.None(pyApp) 
did not match C++ signature: None(CApp {lvalue}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T03:18:17.950

如果你在派生类中实现了一个**init** () 那么你需要确保调用基类**init** () 否则它将没有基类成员。

```
from CApp import *
class pyApp(CApp):
def __init__(self):
    CApp.__init__(self)
    print "<--INIT-->"
CApp = CApp()
pyApp = pyApp()
print CApp.Bar.Foo()
print pyApp.Bar.Foo() 
```

我遇到了同样的问题并在这里找到了解决方案 - [https://stackoverflow.com/a/6396839](https://stackoverflow.com/a/6396839)。

# android - Android 4.2 ACTION_OUTSIDE MotionEvent X 和 Y 在自己的应用程序之外返回 0

> ID：14076710
> 
> 赞同：3
> 
> 时间：2012-12-28T22:44:01.000
> 
> 标签：android, window, touch

我创建了一个`TYPE_SYSTEM_ALERT`视图，设置了标志`FLAG_NOT_TOUCH_MODAL`和`FLAG_WATCH_OUTSIDE_TOUCH`，并用`WindowManager.addView()`.

当我在视图之外触摸自己的活动时，一切正常并`MotionEvent.getY()`返回正确的值。

但是，如果我退出我的活动并触摸另一个应用程序，则`MotionEvent.getY()`始终返回 0。

我不确定这是否只发生在 4.2 上。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-07-01T03:22:39.053

不幸的是，这个问题已经 1.5 年没有答案了，但我遇到了和你一样的事情，并找出了原因！

翻遍了源码，找到了问题的根源：

[https://github.com/android/platform_frameworks_base/blob/79e0206ef3203a1842949242e58fa8f3c25eb129/services/input/InputDispatcher.cpp#L1417](https://github.com/android/platform_frameworks_base/blob/79e0206ef3203a1842949242e58fa8f3c25eb129/services/input/InputDispatcher.cpp#L1417)

```
// Check whether windows listening for outside touches are owned by the same UID. If it is
// set the policy flag that we will not reveal coordinate information to this window.
if (maskedAction == AMOTION_EVENT_ACTION_DOWN) {
    sp<InputWindowHandle> foregroundWindowHandle =
            mTempTouchState.getFirstForegroundWindowHandle();
    const int32_t foregroundWindowUid = foregroundWindowHandle->getInfo()->ownerUid;
    for (size_t i = 0; i < mTempTouchState.windows.size(); i++) {
        const TouchedWindow& touchedWindow = mTempTouchState.windows[i];
        if (touchedWindow.targetFlags & InputTarget::FLAG_DISPATCH_AS_OUTSIDE) {
            sp<InputWindowHandle> inputWindowHandle = touchedWindow.windowHandle;
            if (inputWindowHandle->getInfo()->ownerUid != foregroundWindowUid) {
                mTempTouchState.addOrUpdateWindow(inputWindowHandle,
                        InputTarget::FLAG_ZERO_COORDS, BitSet32(0));
            }
        }
    }
} 
```

如果“外部触摸”位于不与正在侦听外部触摸的视图共享其 UID（[在此处阅读](https://source.android.com/devices/tech/security/#the-application-sandbox)）的视图中，则事件调度程序将其坐标设置为 0,0。这绝对是出于安全目的，但我不确定我是否看到了它旨在减轻的威胁的全部范围。而这里的这位先生[（SO）](https://stackoverflow.com/questions/22041604/why-does-action-outside-return-0-everytime-on-kitkat-4-4-2)报告说你可以在2.3.6上检索位置数据，但似乎至少4.x不会向你透露（我试过4.1.2，它没有工作）。

如果您想关注它，我打开了一张关于此的错误票。至少，文档需要包含这些信息......我还想知道这个安全功能是否真的有必要。

[问题 72746：FLAG_WATCH_OUTSIDE_TOUCH 在 4.2+ 上不返回 ACTION_OUTSIDE 事件的位置](https://code.google.com/p/android/issues/detail?id=72746)

# mongodb - MongoDB 建模/查询子集

> ID：14076719
> 
> 赞同：0
> 
> 时间：2012-12-28T22:44:43.263
> 
> 标签：mongodb

所以我正在尝试实现一个模型来触发我的rails应用程序中可能发生的各种事件。

我想要它做的一些示例代码。

```
 Action.trigger_on("channel1") 
```

上面的代码将由以下触发：

```
 Trigger.trigger("channel1") 
```

但是，如果我只想为给定的一组参数触发动作，我可以传递一个哈希

```
 Action.trigger_on("channel1", {important: true, is_transfer: true}) 
```

上述动作只会由“channel1”上的 channel1 上的东西触发，而且它必须是`important: true`，而且它必须是`is_transfer: true`。

因此这不会触发它，因为它没有 is_transfer：

```
 Trigger.trigger("channel1", {important: true}) 
```

但这会

```
 Trigger.trigger("channel1", {important: true, is_transfer: true}) 
```

现在触发器是一个包含这些参数的“属性”子文档的文档。如何找到与所有参数的子集匹配的所有触发器？或者也许有更好的方法来改进这种建模？

愚蠢的做法是找到与通道匹配的所有触发器，然后遍历它们以检查当前触发器是否具有所有所需的属性......

编辑：另外，我想重要的是要注意动作的触发并不是那么关键。

# authentication - 软件（虚拟令牌）2 因素身份验证？

> ID：14076721
> 
> 赞同：0
> 
> 时间：2012-12-28T22:44:59.690
> 
> 标签：authentication, hipaa

我的公司一直在探索为我们的网站实施 2FA。在查看了几个产品和 2FA wiki 页面后，似乎虚拟令牌是最便宜的解决方案，据说可以满足我的要求，即：

1.  不是硬件令牌（所以没有 yubikey、securid 等），但这是由于成本限制
2.  客户端无需安装任何软件，如 Java Applet、ActiveX 插件、exe 可在桌面上运行
3.  很可能不能使用“网格”（可能不符合 508）
4.  不需要用户有电话（排除 google auth 和许多其他基于移动的解决方案）
5.  非生物识别（因为它很可能需要安装硬件或软件）
6.  如果我们必须违反 1)，它必须易于部署且成本低廉（我们的用户列表不断变化 [按项目] 并且位于非常不同的位置）

我看过一些“虚拟令牌”，包括“Sestus”，但我看不出这些是“真实的”2fa。它不需要安装任何软件，完全基于浏览器。2fa 基于可通过浏览器获取的信息，例如用户代理，这似乎很容易被欺骗。

我在这里发现了一个类似的问题：[软件令牌是多因素安全性中有效的第二个因素吗？](https://stackoverflow.com/questions/72540/is-a-software-token-a-valid-second-factor-in-multi-factor-security)但它已经超过 2 岁了。

在这一点上，使用 yubikeys 是最可行和最具成本效益的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T15:49:38.977

Sestus 的 Virtual Token(R) 解决方案是一种真正的多因素身份验证方法。它被 FFIEC、HIPPA、CJIS 和 PCI 监管公司使用，包括美国财政部。Virtual Token(r) MFA 确实在用户的设备上放置了一些东西，一个数学键。它使用用户已经拥有的软件（他们的浏览器）来实现这一点。因此，不必为用户部署新软件。

# c++ - 一个奇怪的访问冲突错误

> ID：14076725
> 
> 赞同：2
> 
> 时间：2012-12-28T22:45:18.373
> 
> 标签：c++, access-violation

我编写了一个使用继承的程序，一切正常，但我认为自然不应该出现错误。这是我的程序：

```
class A
{
protected:
    int x;
public:
    A(){};
    ~A(){};
    A* operator=(const A* other)
    {
        this->x = other->x;
        return this;
    }
};
class B : public A
{
public:
    B() : A(){};
    ~B(){};
};
class C
{
protected:
    A *a;
public:
    C(const A* other){ *(this->a) = other; };
};

int main()
{
    B *b = new B();
    C *c = new C(b);
    return 0;
} 
```

它在语句“this->x = other->x;”中产生执行时间错误。那这个呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T22:47:13.013

`*(this->a)`是未定义的行为，因为`this->a`没有初始化 - 它只是一个悬空指针。

你可以使用`a = new A; *a = other`（`this->`在这种情况下是多余的），但这不是正确的 C++ 方式——你应该使用 RAII（查找它）——如果你这样做了，你就不需要析构函数、赋值运算符或复制构造函数。

此外，`operator =`通常`*this`通过引用返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T23:15:43.327

我喜欢 Luchian 的回答，但您的代码中仍有一些地方需要增强，在修复其他潜在错误之前，您可能仍会在代码中遇到一些未定义的行为。

```
class A
{
protected:
    int x;
public:
    A():x(0){}     // should always initialize x in constructor
    virtual ~A()=0 {} // as A is a base case, ~A must be virtual
    A& operator=(const A& other)  // a reference will be more practical better?
    {
        this->x = other.x;
        return *this;
    }
}; 
```

如果您不想同时使 B 成为对象，这意味着 B 作为基类提供服务，那么您也应该将其析构函数设为虚拟，甚至将其设为纯虚拟。

```
class B : public A
{
public:
    B() : A(){}
    virtual ~B(){} =0
    { }       
}; 
```

`*(this->a) = other;`Luchian已经回答了。在您的代码中，如果您想保留指向 A 的指针的副本，您可以在`member initialize list` 下面的演示代码中简单地初始化 a_ptr：

```
class C
{
protected:
   A *a_ptr;
public:
    C(A* other):a_ptr(other){ }
}; 
```

最后来到你的main函数，如果b,c只用在main函数中，当程序结束时，系统会收回动态分配的内存，但如果你`a,b`在循环中使用，你需要手动删除它们。

# php - 如何检查 Twig 中的块是否被覆盖？

> ID：14076729
> 
> 赞同：1
> 
> 时间：2012-12-28T22:45:44.443
> 
> 标签：php, symfony, twig

我想检查一个块是否在子模板中被覆盖。

`template.html.twig`：

```
<html>
    ...
    <nav class="menu">
        {% block menu %}
        {% endblock %}
    </nav>
    ...
    <div class="contents">
        {% block contents %}
        {% endblock %}
    </div>
    ...
</html> 
```

`page1.html.twig`-- 包含一个菜单：

```
{% extends '::template.html.twig' %}

{% block menu %}
    <ul>
        <li>...</li>
    </ul>
{% endblock %}

{% block contents %}
    Hello World!
{% endblock %} 
```

`page2.html.twig`-- 不包含菜单：

```
{% extends '::template.html.twig' %}

{% block contents %}
    Hello World!
{% endblock %} 
```

我想`nav`在模板中显示元素，前提是它在子模板中被覆盖（目标是避免空`<nav />`元素）。

Twig 语法有一个`is empty`测试，但它只适用于变量，而不适用于块。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:52:15.993

您可以在子模板检查中设置一个变量：

```
{# template.html.twig #}

{% if show_menu is not empty %}
<nav class="menu">
    {% block menu %}
    {% endblock %}
</nav>
{% endif %} 
```

```
{# page1.html.twig #}

{% set show_menu = true %} 
```

也许您还应该考虑将此标记放在块定义中，以获得更直接的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T20:32:51.853

您可以在 nav 元素中添加一个包装器，然后在 page2 中覆盖它，以便在您不需要菜单时将其设为空白。这不需要额外的变量。

**模板.html.twig**

```
... snip ...
{% block nav %}
<nav class="menu">
    {% block menu %}
    {% endblock %}
</nav>
{% endblock %}
... snip ... 
```

**page2.html.twig**

```
{% extends '::template.html.twig' %}

{% block nav '' %} {# here's the kicker ... #}

{% block contents %}
    Hello World!
{% endblock %} 
```

在具有菜单的任何其他页面中，您将继续正常覆盖“菜单”块。

# java - Java——在子类中初始化超类变量？

> ID：14076730
> 
> 赞同：8
> 
> 时间：2012-12-28T22:46:00.953
> 
> 标签：java, variables, subclass, superclass

好的，例如，假设我有一个名为“Vehicle”的抽象类。Vehicle 类除其他外还有一个名为wheels 的静态变量，该变量未初始化。我想要做的是从车辆类扩展其他子类，如“摩托车”和“卡车”，并在这些子类中初始化车轮。

代码：

```
public abstract class Vehicle {
    static int wheels; //number of wheels on the vehicle
} 
```

但以下不起作用：

```
public class Motorcycle extends Vehicle {
    wheels = 2;
} 
```

有没有办法有效地做到这一点？

编辑：感谢到目前为止所有回复的人。我知道制作实例可能比将它们全部放在单独的类中更好的方法，但是我没有完美地获得 java 的“静态”部分，所以我需要一些帮助。

我要为我的程序做的是为 Motorcycle 和 Truck 类设置单独的 sprite，我希望它们是静态的，这样我就不必在每次创建 Motorcycle 或 Truck 的实例时重新加载图像. 不过，除此之外，它们将具有几乎相同的属性，这就是为什么它们都将从 Vehicle 超类扩展而来。

我可以看到完成此操作的唯一另一种方法是不在 Vehicle 类中声明 sprite 变量，而是在 Motorcycle/Truck 类中声明，如下所示：

```
public abstract class Vehicle {
//Other coding
}

public class Motorcycle extends Vehicle {
static BufferedImage sprite = //initialize image
//Other coding
}

public class Truck extends Vehicle {
static BufferedImage sprite = //initialize image
//Other coding
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-28T22:49:57.343

如果“车轮”是静态的，则只有一个，它将同时适用于所有车辆。所以三轮车、摩托车、18 轮卡车和福特都将具有相同数量的车轮。

这对我来说没有意义。最好让“轮子”成为父类中的实例变量，但每个子类都适当地设置。

但是你可以试试

```
Vehicle.wheels = 2; 
```

注意：自从您添加到问题中以来，我正在添加我的答案。

我喜欢你在每个子类中都有静态的想法。但是您应该将它们设为私有。然后在父类（Vehicle）中放一个抽象方法，如

```
public abstract BufferedImage getSprite(); 
```

然后每个直接子类必须具有相同的方法，并且它可以返回私有静态变量。

将变量设为静态，因此您只需加载一次。将它们设为私有，这样类本身之外的代码就不会愚弄它并引入错误。如果可能的话，您可以将它们设为“最终”，这样类本身的代码就不能在事后更改它并引入错误。（'final' 变量的值不能改变，但其值的内容可以改变。所以 'final' 并不像它可能的那样美妙。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-28T22:48:56.257

你试图做的从根本上是有缺陷的。您*可以*进行一次`Motorcycle`初始化`wheels`：

```
// Static initializer
static
{
    wheels = 2;
} 
```

...或每次创建实例时：

```
// Instance initializer
{
    wheels = 2;
} 
```

但是只有*一个变量*- 不是一个 for `Motorcycle`，一个 for`Truck`等等。如果你对两个`Truck`and做同样的事情`Motorcycle`，那么最后初始化的那个会“赢”。

目前还不清楚你想如何*使用*这个字段——但如果你只有一个静态字段，那么它只会有一个值——而不是每个子类一个值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T22:59:25.490

静态成员只定义一次，并且对每个扩展类都是通用的。更改其中一个值将影响所有其他值。这就是我相信您真正想要实现的目标：

```
public abstract class Vehicle {
    private int _wheels; //number of wheels on the vehicle
    public int getWheels(){return _wheels;}

    protected Vehicle(int wheels){
        _wheels = wheels;
    }
}

public class Motorcycle extends Vehicle {
    public Motorcycle(){
        super(2);
    }
}

public class Car extends Vehicle {
    public Car(){
        super(4);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-25T14:41:41.637

我认为有一种更优雅的方式来做到这一点

我将要提出的仍然受到您需要实例的限制。我没有看到任何解决方法，因为您希望`wheels`作为超类的一部分公开，但是 的值`wheels`取决于子类，并且内部`Vehicle`没有没有实例的子类类型的概念。

在我看来，在这种情况下，“轮子”既不是静态属性也不是非静态属性。它是类***元数据***。Java 指定类元数据的方式是通过注解。

您需要的是这样的用户定义注释：

```
@Documented
@Retention(RetentionPolicy.RUNTIME)
public @interface VehicleMetadata{
    int wheels();
} 
```

然后，您如下注释 Motorcyle：

```
@VehicleMetadata(2)
public class Motorcycle extends Vehicle {} 
```

在超类中，您提供了一个获取注释属性值的访问器。我建议您使用*“惰性评估”*方法，这样您就不会在每次需要值时都使用反射。

注意`this`获取实例的使用：

```
private String wheelsValue;

public String getWheels() {
    if (this.wheelsValue== null) {

        VehicleMetadatane = null;
        for (Annotation annotation : this.getClass().getAnnotations()) {
            if (annotation instanceof VehicleMetadata) {
                ne = (VehicleMetadata) annotation;
                break;
            }
        }

        wheelsValue = ne.wheels();
    }
    return wheelsValue ;
} 
```

在我看来，这是最优雅的解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-29T18:27:51.410

原始类声明：

```
public abstract class Vehicle {
    static int wheels; //number of wheels on the vehicle
}

public class Motorcycle extends Vehicle{...}
public class Truck extends Vehicle{...} 
```

不起作用，因为静态变量与声明它的类一起使用。静态类变量仅为每个类而不是每个类对象创建一个变量实例的内存存储。当编译器 (jvm) 在类 Vehicle 中看到静态变量时，它会为该变量分配内存，并且该内存位置是静态的（不会更改）。Vehicle 类的每次后续使用，无论是扩展还是实例化为对象，都将指向静态变量在内存中的相同位置。

为了在子类中使用静态变量，您必须在方法中使用它。因此，您实际上可以像这样重写您的 Motorcycle 类：

```
class Motorcycle extends Vehicle{
    public Motorcycle(){
        wheels = 2;
    }
} 
```

它会编译；但是，您可能不会得到您期望的结果。例如，如果您在代码中执行此操作（假设 Truck 类被声明为 Motorcycle 类并将 4 分配给车轮，并且有一个 getter 方法来返回车轮的值）。

```
Motorcycle cycle = new Motorcycle();
Truck pickup = new Truck();
...
System.out.println("Motorcycle has " + cycle.getWheels() + " wheels."); 
```

将打印：

摩托车有4个轮子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-28T22:56:52.390

如果您在您的对象中创建一个静态变量，那么您将创建的每个 Vehicle 类都将是相同的，即使您将为抽象 Vehicle 类创建另一个子类也是如此。这是因为任何静态变量的“性质”。

我认为您想使用非静态变量，以便对于抽象 Vehicle 类的任何子类的每个实例，您都可以确定车轮的值，并按以下方式完成：

```
public abstract class Vehicle {
    public int wheels; //number of wheels on the vehicle
} 
```

和任何子类：

```
public foo extends Vehicle{

     public void someMethode(){
         this.wheels = 2;
     }
} 
```

您也可以对静态变量执行此操作，但随后您将为 Vehicle 的任何子类的每个实例更改它

希望我帮助了你

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-28T22:53:25.367

也许您想考虑一下您正在使用的构造函数。

```
public Vehicle(int wheels) {
    this.wheels = wheels; 
}

public Motorcycle(int wheels) {
    super(wheels);
}

public Motorcycle cycle = new Motorcycle(2); 
```

Motorcycle 使用知道如何处理参数的超级构造函数。它会自动将车轮设置为 2。

# winapi - 正确移除窗框/边框

> ID：14076731
> 
> 赞同：3
> 
> 时间：2012-12-28T22:46:06.937
> 
> 标签：winapi, visual-c++

我一直在研究自定义 GUI 框架，因为我无法处理需要通过标记 (XAML) 开发 UI 的托管废话或本机代码。我正在尝试创建一个使用该 GUI 框架的应用程序原型，但我遇到了一个特定于平台的问题，即 WinAPI 中的窗口性质。

DWM 并不真正允许定制打破沉浸感的非客户区，它唯一允许的就是扩展到客户区，以产生定制的错觉。

所以，最好的做法是在客户区（相对于 WINAPI）内重建“非客户区”，这需要我去掉标题、最大化、最小化按钮等。所以，我基本上列举了我所有的东西想要将它们组合在一起并翻转所有位以停用它们。

```
~(WS_CAPTION | WS_SYSMENU | WS_HSCROLL | WS_VSCROLL | WS_MINIMIZE | WS_MAXIMIZE | WS_THICKFRAME) 
```

**一旦这些风格消失，我就无法使用正常的关机程序（Alt+F4，或右键单击任务栏并“关闭”），因为它们不起作用。我不得不手动拦截 VK_ESCAPE 和 PostQuitMessage(0) ，这样我就可以退出而不会被迫终止进程。**

为什么会这样？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T23:46:22.497

# 简短的回答

代替：

```
~(WS_CAPTION | WS_SYSMENU | WS_HSCROLL | WS_VSCROLL | WS_MINIMIZE | WS_MAXIMIZE | WS_THICKFRAME) 
```

和：

```
WS_POPUP 
```

并且没有更多时髦的行为。应用程序正确响应。享受蛋糕。

# 长答案

啊，就像最近 MSDN 上的所有内容一样，蛋糕是个谎言。窗口*样式*实际上不仅仅是视觉上的。它们还指定应用程序窗口可用的固有窗口功能。现在，这里有相当多的诡计需要观察。

首先，MSDN 的窗口样式定义表并没有真正推出和有用。Windows 的默认行为是经典的标题、关闭、边框包，它被标识为`WS_OVERLAPPEDWINDOW`占用最简单的表达式 0（一个 32 位值，所有位向下，0x00000000），所以想要快速浏览的人可以设置0 用于`CreateWindow*`函数中的样式，它将产生一个经典窗口。

你想要的是一个简陋的、肮脏的、空荡荡的窗户。微软得到了你正在寻找的东西——`WS_POPUP`它将最高位设置为 1，其他一切都是 0。这将放弃所有花哨的自动调整大小、窗口字幕和可爱的最小化、最大化和关闭按钮。

这意味着您将不得不重新实现所有内容。但这就是你想要的，对吧？

仅仅翻转所有位是不够的，您将放弃想要的选项，但也会激活其余选项，导致应用程序表现得有趣，您现在正在经历什么。因此，您要么将其与其他东西相结合，要么使用 Microsoft 很容易定义的东西 - `WS_POPUP`.

然后再次。享受蛋糕和快乐的编码。

# ruby-on-rails - 带有 erg 的 Rails link_to 用于链接文本

> ID：14076736
> 
> 赞同：0
> 
> 时间：2012-12-28T22:46:40.003
> 
> 标签：ruby-on-rails, link-to

这必须非常简单，但我被卡住了。

我有两个字段 fname 和 lname 我想将它们放在一起并用作 Show 方法的链接。

```
<%= link_to 'Show', person %>
<%= link_to person.fname %> <%= person.lname %> 
```

第一行链接到我需要它去的地方。但是，第二行以我想要的方式显示名字和姓氏，尽管它没有链接到特定记录，只是索引页面。

我怎样才能获得特定记录的第二行链接？

谢谢

斯科特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:54:22.917

您最好的选择是在您的`person`模型上为其全名创建一个属性：

```
def full_name
  self.fname + ' ' + self.lname
end 
```

然后在您看来，您可以使用：

```
<%= link_to person.full_name, person_path(person) %> 
```

这是假设您已经在`routes.rb`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:54:47.200

试试这个：

```
<%= link_to person.fname + " " + person.lname, person %> 
```

您无意中所做的是通过添加两个 <%= %> 分隔符将链接分成不同的部分。您需要做的是将 fname 和 lname 连接在一起作为 link_to 的第一个参数，它们提供对象作为第二个参数，以便 link_to 知道要生成什么链接。

顺便说一句，将字符串连接在一起的更快方法是使用插值：

```
<%= link_to "#{person.fname} #{person.lname}", person %> 
```

# java - 尝试更改参考变量

> ID：14076738
> 
> 赞同：0
> 
> 时间：2012-12-28T22:46:47.767
> 
> 标签：java, image, reference, resources, game-engine

我有一个游戏引擎，它试图通过将图像存储在 HashMap 中来有效地加载资源。当我想为 Sprite 对象加载图像时，我只需说 Sprite.image = LOAD_IMAGE(imageName);

现在我正在为这款游戏制作地图编辑器。我希望能够旋转某些瓷砖，例如房子的瓷砖，通过 Java 图像操作面向不同的方向。我有那个工作；但是，错误出现在我将图像设置为新的旋转图像的方式中。我说 Sprite.image = rotateImage(Sprite.image); 这导致相同类型的所有 TILES 具有相同的新旋转图像。

我可以在我的游戏中实现什么，以便每个 Sprite 都可以旋转而不影响其他 Sprite 的图像？如果可能的话，我仍然想保留我的 HashMap，因为我认为它确实会提高我的游戏效率。

这就是我实现轮换的方式：

```
terrain.terrainImage = ImageManipulator.mirror(currentTile.terrain.terrainImage, false); 
```

这是我的“ImageBank”： public HashMap images = new HashMap(30);

```
public synchronized Image getImage(String imgName) {
    // Check if the HashMap images already has the specified image
            // by checking for the image name.
    if (imgExists(imgName)) {
        // Sprite already loaded.
        return hm.get(imgName);
    } else {
        // Sprite hasn't been loaded yet.
        Image img;
        img = loadImage(imgName);
        if (img == null) {
            // An error occured, couldn't load sprite.
            return null;
        } // else move on

        // save the loaded sprite (and now transparent) into the hashmap
        hm.put(imgName, img);
        // and then return the sprite
        return img;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:54:16.527

您可以为每个图块存储它是否旋转以及旋转的角度（而不是每次绘制它时旋转它），或者将旋转的副本存储在图像上。

我建议存储旋转版本。

# javascript - 创建浮动侧边菜单的最佳方法

> ID：14076739
> 
> 赞同：0
> 
> 时间：2012-12-28T22:46:48.360
> 
> 标签：javascript, jquery, ajax, asp.net-mvc

我有一个正在开发的 ASP MVC3 网站，并且想创建一个浮动侧菜单栏，它在一组点之间保持静止。CNNSI.com 和 speckyboy.com 都有类似的浮动侧边栏，尽管是用于社交网络链接。如果有人能指出我正确的方向，我会非常满意，特别是如果您知道 Ajax/javascript 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:14:33.473

有几种方法可以做到这一点。一个非常简单的方法是使用 CSS，在你的元素上使用 position:fixed。不幸的是，您不会通过这种方法获得所需的智能响应能力。

如果你想变得更漂亮，让它在特定点之间随着用户滚动，你需要使用一些 javascript 来检测用户何时滚动以及他在页面中滚动到的位置。我只关注学习经验，但由于您使用的是 jQuery，因此有一些 [库和插件](http://www.jquery4u.com/menus/floating-message-plugins/)可以让您轻松完成类似的操作。有关更多信息，请参阅链接。

# sql - 谷歌大查询对多列的唯一组合进行排序

> ID：14076744
> 
> 赞同：1
> 
> 时间：2012-12-28T22:47:06.563
> 
> 标签：sql, distinct, google-bigquery, web-traffic, referrals

我们已经有一个网站所有推荐的表格：（每个推荐一个条目）

```
String : referral
String : target
integer: date 
```

现在，我们想使用大查询根据计数对所有推荐进行排序，例如：

```
referral       : target,         count:

google.com/... : welcome.html,   28353 
bing.com/...   : welcome.html,   5334 
gmail.com/...  : about.html,     343
... 
```

大查询sql应该是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T21:36:24.877

为什么不按两列分组？

```
SELECT referral, target, COUNT(*) as cnt
FROM [mydataset.referrallog] 
GROUP BY referral, target
ORDER BY cnt DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T21:15:41.513

如果我说对了，那么：

```
SELECT COUNT(path) AS path_count, path
FROM (
  SELECT concat(referrer, target) AS path
  FROM [mydataset.referrallog])
GROUP BY path ORDER BY path_count DESC; 
```

# jquery - 如何隐藏一些使用 .after() 添加的标记？

> ID：14076747
> 
> 赞同：0
> 
> 时间：2012-12-28T22:47:28.660
> 
> 标签：jquery

在我正在使用的导航栏中，使用 jquery 在“活动”项中添加了一个箭头：

```
$('.top-bar-wrapper li.active a').after('<div class="nav-active-arrow"></div>'); 
```

该代码无法更改，我需要按原样使用它。

我需要做的是在单击按钮时隐藏 .nav-active-arrow 标记。所以，我有以下几点：

```
var navArrow = $('.nav-active-arrow');

$('#nav-bar-churches').click( function(e) {
  churchesBar.show();
  navArrow.hide();
  e.stopPropagation();
}); 
```

还有更多内容 - 例如，我在一些事件上做了一个 .show。但是，上面的代码对我不起作用，我猜这是因为它`.nav-active-arrow`是在`.after()`函数中创建的。

我的想法正确吗？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:49:29.270

您不需要`$('.nav-active-arrow')`外侧点击，需要将其放入点击事件中以确保其`availabilty`.

```
$('#nav-bar-churches').click( function(e) {
  var navArrow = $('.nav-active-arrow');
  churchesBar.show();
  navArrow.hide();
  e.stopPropagation();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:49:56.173

尝试`var navArrow = $('.nav-active-arrow');`像这样将你的点击功能放在里面：

```
$('#nav-bar-churches').click( function(e) {    
  churchesBar.show();
  var navArrow = $('.nav-active-arrow');
  navArrow.hide();
  e.stopPropagation();
}); 
```

或者，更简洁地说：

```
$('#nav-bar-churches').click( function(e) {    
  churchesBar.show();
  $('.nav-active-arrow').hide();
  e.stopPropagation();
}); 
```

# jquery - 在没有href的情况下滚动到顶部...？

> ID：14076749
> 
> 赞同：-2
> 
> 时间：2012-12-28T22:47:42.720
> 
> 标签：jquery

这是我开始的，

```
 $("a[href='#top']").click(function() {
      $("html, body").animate({ scrollTop: 0 }, "slow");
   return false;
    }); 
```

哪个很好用

```
<a href="#top">...</a> 
```

但是，我需要类似的东西，不需要链接，比如......

```
<li id="top">....</li> 
```

我试过这个

```
 $("#top").click(function() {
          $("html, body").animate({ scrollTop: 0 }, "slow");
          return false;
        }); 
```

但这对我来说不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T23:00:54.460

问题在于您的 HTML，而不是您的 JavaScript。`id`在 HTML 中包含两个具有相同属性的元素是无效的。jQuery（实际上是底层的 JavaScript）只会在使用 ID 选择器时选择这些元素中的*第一个*`#top`，因此选择`<a>`. 您的选择器`li#top`更具限制性，但如果您颠倒元素顺序，您可以看到类似的效果：http: [//jsfiddle.net/WRmPz/10/](http://jsfiddle.net/WRmPz/10/)

出于这个和许多其他原因，您的所有元素都必须具有唯一的 ID。

By the way, the `return false` is not necessary for the `<li>`, (nor would it be necessary for `<a>` without `href`). If you were to use the latter, it would be better to pass in the event object and call `e.preventDefault()`: [http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/](http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/)

# delphi - 警告：'TSmallPoint' 到 'Integer' 的不安全类型转换

> ID：14076750
> 
> 赞同：10
> 
> 时间：2012-12-28T22:47:42.923
> 
> 标签：delphi, delphi-7

我在我的项目中使用此代码：

```
var
  P: TPoint;

MyControl.Perform(WM_LBUTTONDOWN, 0, Longint(PointToSmallPoint(P))); 
```

编译器给了我一个警告：

```
[Warning]: Unsafe typecast of 'TSmallPoint' to 'Integer' 
```

但是，在`Controls.pas` **没有任何警告**的情况下使用相同的代码- 例如在`TControl.BeginDrag`方法中：

```
....
Perform(WM_LBUTTONUP, 0, Longint(PointToSmallPoint(P))); 
```

我没有看到任何`{$warnings off}`单位`Controls.pas`。

为什么编译器警告我，但跳过警告`Controls.pas`？
这段代码不安全吗？

* * *

编辑：在我的项目选项 -> 编译器消息 -> 不安全类型转换**中选中**（默认情况下未选中）。
也许这就是@David 和@Ken 无法重现警告的原因。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-28T23:28:23.513

这是因为您`unsafe typecast`在 Project->Options->Compiler Messages 中检查了警告。取消选中是安全的（与它一样`unsafe type`及`unsafe code`以上。（见下文。）

我无法重现警告，因为我未检查不安全的类型转换。它不再适用。（当他们为 .NET 开发 Delphi 时，为了与 .net 兼容而在 Delphi 6 或 7 中添加了它，以便更轻松地编写适用于 .NET 和 Win32 的代码；由于 .NET 产品的 Delphi 已停产，因此该警告（以及上面的两个）不再适用）。这三个警告中的“不安全”使用 .NET 的“不安全”含义，意思是“非托管”。

从 Delphi 7 帮助文件（搜索“编译器更改”）（**强调我的**）：

> Delphi dcc32 编译器现在支持三个额外的编译器警告：Unsafe_Type、Unsafe_Code 和 Unsafe_Cast。 **默认情况下禁用这些警告**，但可以使用编译器指令 {$WARN UNSAFE_CODE ON}、编译器命令行开关 (dcc32 -W+UNSAFE_CODE) 以及在 IDE 中的项目|选项|编译器消息页面上启用。
> 
> **此功能旨在帮助您将代码移植到 Microsoft .NET 平台的托管执行环境。在托管执行环境中，“不安全”是指在即时 (JIT) 编译器执行的静态分析期间无法验证操作。**此类代码可能会带来安全风险，因为 JIT 编译器没有足够的信息来验证其运行时行为。不安全代码的示例包括指针操作和内存覆盖。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T23:21:47.450

如果您自己编译 Controls 单元并启用不安全类型转换警告，那么您将看到警告。但是，如果您链​​接预构建的 .dcu 文件，则不会看到任何警告。编译器只对它编译的单元发出警告。

作为一般规则，RTL 和 VCL 单元会生成大量提示和警告。如果我必须重新编译它们，我总是必须关闭这些单元上的提示和警告。

* * *

警告的现代[文档](http://docwiki.embarcadero.com/RADStudio/XE3/en/W1048_Unsafe_typecast_of_%27%25s%27_to_%27%25s%27_%28Delphi%29)说：

> 您使用了静态代码分析无法证明它不会覆盖内存的数据类型或操作。例如，您可能已经将一个记录*（原文如此）*到另一个或一个实例到另一个。

该警告确实适用于您的代码。您的代码不安全。编译器无法验证将两个 16 位整数叠加到一个 32 位整数上是否正确。所以编译器会警告你。代码是否正确由您决定。

现在，该警告似乎主要针对 .net 编译器。尽管如此，它仍然对 Win32 编译器有意义。将一个记录叠加在另一个记录上是可疑的行为。

# php - JavaScript 表单验证 - 函数未在提交时运行。

> ID：14076752
> 
> 赞同：0
> 
> 时间：2012-12-28T22:48:09.787
> 
> 标签：php, javascript, html, web

我目前正在对一个表单进行一些非常基本的验证，该表单使用简单的 PHP 脚本将大量信息从 Web 表单发布到 SQL 数据库。PHP 脚本工作正常，并且值正在发布到数据库中，但是我编写的验证似乎被忽略了。我已经尝试修复它一段时间，但看不到任何明显的错误，但如果它是微不足道的，我深表歉意。

HTML：

```
<form name = "registerForm" method = "POST" onsubmit = "return ValidateRegistration()" action = "createUser.php">
    <p class = "register">Desired Username*</p>
    <p class = "registerDesc">Between 1 and 20 characters long</p>                  
    <input type = "text" name = "username" class = "register">
    <p class = "register">Desired Password*</p>
    <p class = "registerDesc">We won't force securty onto you; between 6 and 255 characters long. No other criteria.</p>
    <input type = "password" name = "password" class = "register">
    <p class = "register">Confirm Password*</p>
    <input type = "password" name = "confirmPassword" class = "register">
    <p class = "register">Email Adress*</p>
    <input type = "text" name = "email" class = "registerEmail">
    <p class = "register">Bio</p>
    <p class = "registerDesc">Extra information such as hobbies, occupation, background information. Maximum 4096 characters. We can do this later.</p>
    <textarea name = "bio" class = "registerBio"></textarea>
    <p><input type = "submit" class = "registerButton" value = "Register"></p>
</form> 
```

JavaScript：

```
function ValidateRegistration()
{
    //username block
    var username=document.forms["registerForm"]["username"].value;
    if (username==null || username==" ")
    {
        alert("You must provide a username");
        return false;
    }       
    if (username.length>20 || username.length<1)
    {
        alert("Sorry, your username must be between 1 and 20 characters long.");
        return false;
    }
    //etc....
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:19:27.227

正是您的代码对我有用：

创建以下 test.html 文件并在 chrome 中打开：

```
<html>
<head>
<script>
function ValidateRegistration()
{
    //username block
    var username=document.forms["registerForm"]["username"].value;
    if (username==null || username==" ")
    {
        alert("You must provide a username");
        return false;
    }       
    if (username.length>20 || username.length<1)
    {
        alert("Sorry, your username must be between 1 and 20 characters long.");
        return false;
    }
    //etc....
}
</script>
</head>
<body>
<form name = "registerForm" method = "POST" onsubmit = "return ValidateRegistration()" action = "createUser.php">
    <p class = "register">Desired Username*</p>
    <p class = "registerDesc">Between 1 and 20 characters long</p>                  
    <input type = "text" name = "username" class = "register">
    <p class = "register">Desired Password*</p>
    <p class = "registerDesc">We won't force securty onto you; between 6 and 255 characters long. No other criteria.</p>
    <input type = "password" name = "password" class = "register">
    <p class = "register">Confirm Password*</p>
    <input type = "password" name = "confirmPassword" class = "register">
    <p class = "register">Email Adress*</p>
    <input type = "text" name = "email" class = "registerEmail">
    <p class = "register">Bio</p>
    <p class = "registerDesc">Extra information such as hobbies, occupation, background information. Maximum 4096 characters. We can do this later.</p>
    <textarea name = "bio" class = "registerBio"></textarea>
    <p><input type = "submit" class = "registerButton" value = "Register"></p>
</form>
</body>
</html> 
```

提交一个空表单警报：

> 抱歉，您的用户名长度必须介于 1 到 20 个字符之间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:25:37.840

[http://fiddle.jshell.net/hmariod/LRZkR/](http://fiddle.jshell.net/hmariod/LRZkR/)

```
<form name = "registerForm" method = "POST"  action = "createUser.php">
    <p class = "register">Desired Username*</p>
    <p class = "registerDesc">Between 1 and 20 characters long</p>                  
    <input type = "text" name = "username" class = "register">
    <p class = "register">Desired Password*</p>
    <p class = "registerDesc">We won't force securty onto you; between 6 and 255 characters long. No other criteria.</p>
    <input type = "password" name = "password" class = "register">
    <p class = "register">Confirm Password*</p>
    <input type = "password" name = "confirmPassword" class = "register">
    <p class = "register">Email Adress*</p>
    <input type = "text" name = "email" class = "registerEmail">
    <p class = "register">Bio</p>
    <p class = "registerDesc">Extra information such as hobbies, occupation, background information. Maximum 4096 characters. We can do this later.</p>
    <textarea name = "bio" class = "registerBio"></textarea>
    <p><input type = "button" onclick="ValidateRegistration();" class = "registerButton" value = "Register"></p>
</form>​

function ValidateRegistration(){
    try{
        var username=document.forms["registerForm"]["username"].value;
        if (username.length < 1)
        {
            alert("You must provide a username");
            return;
        }       
        if (username.length>20 || username.length<1)
        {
            alert("Sorry, your username must be between 1 and 20 characters long.");
            return;
        }
        document.forms["registerForm"].submit();
    }catch(er){
         alert(er);
    }
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T22:55:48.427

我会摆脱 onsubmit 中的回报。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T23:06:21.900

将您的代码放在 try/catch 块中，看看发生了什么。

```
try{
  //your code
}catch(er){
  alert(er);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T15:59:03.980

我认为问题出在你的比较线上

```
if (username==null || username==" ") 
```

应该是

```
if (username==null || username=="") 
```

我希望它能解决你的问题。请告诉我 ;-）

# java - Java 中的 Vigenere/Polyalphabetic Cipher Decoder/Decrypter/Breaker

> ID：14076753
> 
> 赞同：1
> 
> 时间：2012-12-28T22:48:18.810
> 
> 标签：java, encryption, vigenere

我正在尝试开发一个程序，对使用 Vigenere 密码编码的消息进行编码、解码和破解加密。我被卡住的地方是破坏消息（没有密钥）的[加密]。我知道如何去做，但我不知道如何编码。我的想法如下：

该程序将系统地生成潜在的密钥，长度从 1 开始到 26 结束。这些密钥将包含英文字母表中的字母并且不区分大小写。对于每个密钥长度（从 1 到 26 的任意位置），密钥将用字母“a”填充，然后程序将检查它们的密钥是否正确（我有另一种方法）。如果他们的键不正确，那么最后一个位置的字母将被旋转到字母表中的下一个字母。一旦最后一个字母经过所有 26 个可能的位置，倒数第二个字母将旋转，然后最后一个字母和倒数第二个字母将相应旋转，依此类推（一直回到第一个[potential] 键的字母）。每次生成新密钥时，正在使用单独的方法检查 [potential] 密钥，当找到正确的密钥时该方法停止。密钥创建进程将如下所示：

```
[starting with keys that are only 1 letter long]
a
b
c
...
x
y
z

[now the potential key length becomes two]
aa
ab
ac
ad
...
zw
zx
zy
zz

[eventually the potential key length becomes 26]
aaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaab
aaaaaaaaaaaaaaaaaaaaaaaaac
aaaaaaaaaaaaaaaaaaaaaaaaad
...
zzzzzzzzzzzzzzzzzzzzzzzzzw
zzzzzzzzzzzzzzzzzzzzzzzzzx
zzzzzzzzzzzzzzzzzzzzzzzzzy
zzzzzzzzzzzzzzzzzzzzzzzzzz 
```

（希望你能看到那里的模式）

如果有人拥有或知道如何执行此操作的代码，或者可以帮助指导完成编写此代码所需的步骤，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:02:27.003

**编辑**（现在我已经完成了数学计算）

您需要迭代大约 6*10^36 种可能的组合 -`long`最大值约为 9*10^18 - 一个*小得多*的数字。

话虽如此，假设您找到了一种优化的方法来迭代组合，您可以在其中每秒生成和比较一万亿 (10^12) 个组合（比普通开发人员的机器*快得多*），并且可以在百万台机器上并行化它- 这将是 (60*60*24*365*10^12)*10^6 每年，或每年检查大约 3*10^25 组合。

以如此惊人的速度，**仍然需要大约 1900 亿年才能遍历所有组合。**

我强烈敦促您研究另一种实现目标的替代方法，而不是尝试每一个键。

现在（回到我原来的答案），如果你有一个合理大小的键子集想要迭代，我可以想象用一个直接向上的数字循环做这样的事情，只是将数字转换为修改后的 base-26钥匙。

一些伪代码：

```
public void runAlgorithm () {
    for (int i=startKey; i<endKey; i++) {
        String key = toBase26(i);
        testKey(key);
    }
} 
```

使用类似[维基百科](http://en.wikipedia.org/wiki/Hexavigesimal)的十六进制转换器来实现`toBase26`（复制如下）：

```
public static String toBase26(int number){
    number = Math.abs(number);
    String converted = "";
    // Repeatedly divide the number by 26 and convert the
    // remainder into the appropriate letter.
    do
    {
        int remainder = number % 26;
        converted = (char)(remainder + 'A') + converted;
        number = (number - remainder) / 26;
    } while (number > 0);

    return converted;
} 
```

# python - 如何在 Web 服务器上设置持久进程并从多个会话连接到它？

> ID：14076756
> 
> 赞同：2
> 
> 时间：2012-12-28T22:48:41.390
> 
> 标签：python, cgi

这可能看起来很基本，但我以前从未这样做过，坦率地说我有点迷茫。这是我想做的事情：

*   我希望一个进程在 Web 服务器上运行（一个 Python CGI 脚本会很棒），除非我告诉它死掉，否则永远不会停止。

*   我希望任何会话都能够与同一个进程进行通信（即不为每个会话启动一个新的 CGI 进程）。

做这个的最好方式是什么？我一直在查看 FastCGI 并且我的托管服务似乎支持它，但我无法在任何搜索中找到可用的示例，因为所有结果似乎都在谈论将 python 或 php 本身作为 FastCGI 运行而不是关于我的上述问题。

谢谢

# mysql - 可以在 mysql 中将自动递增变量添加到 GROUP BY 的行结果中吗？

> ID：14076758
> 
> 赞同：0
> 
> 时间：2012-12-28T22:48:54.940
> 
> 标签：mysql

基本上，我使用此查询根据与他们关联的数字的总和对一组用户进行分组。我需要一些如何为每个结果分配索引。我对如何做到这一点感到茫然。我想我需要用 AS 给一些东西起别名，但不确定如何。有任何想法吗？

这是我动态切换页面和 per 的当前查询：

```
SELECT COUNT(*) as count, user_id, SUM(earnings) as sum FROM ci_league_result
 GROUP BY user_id ORDER BY sum desc LIMIT ".$page.', '.$per; 
```

我正在寻找它可以像这样工作：

```
SELECT COUNT(*) as count, user_id, SUM(earnings) as sum, *NEW-RESULTS-OVERALL-INDEX* AS newindex FROM ci_league_result
GROUP BY user_id ORDER BY sum desc LIMIT ".$page.', '.$per; 
```

注意第二个查询中的 AS newindex。

谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:53:26.747

您应该能够使用`SQL` [变量来完成此操作](http://domoconnor.com/2009/04/22/getting-the-current-row-number-from-mysql/)

```
SELECT
  COUNT(*) as count,
  user_id,
  SUM(earnings) as sum,
  @rownum := @rownum+1 AS newindex
FROM ci_league_result,
(SELECT @rownum:=0) r
GROUP BY user_id
ORDER BY sum DESC
LIMIT ".$page.', '.$per; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:53:45.013

尝试这个：

```
SELECT user_id, count, sum, @row := @row + 1 AS newindex FROM
(SELECT
   COUNT(*) as count,
   user_id,
   SUM(earnings) as sum
FROM ci_league_result 
GROUP BY user_id ORDER BY sum desc LIMIT ".$page.', '.$per) r
CROSS JOIN (SELECT @row := 0) rr; 
```

**已编辑**

# spss - 在 SPSS 中，是否可以使用值名称而不是值编号将数据集文件导出为 .CSV？

> ID：14076767
> 
> 赞同：8
> 
> 时间：2012-12-28T22:26:19.333
> 
> 标签：spss

在我的 SPSS 文件中，我有一个名为“X”的变量。它有四个值：1="dog"、2="cat"、3="hyena"、4="parrot"。

如果我将数据导出到 .CSV 文件，它的外观如下：

```
X
1
2
3
4 
```

我希望导出的 .CSV 看起来像这样：

```
X
dog
cat
hyena
parrot 
```

这可能吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-29T09:21:38.787

其他答案与 GUI 有关，但有些人更喜欢使用语法编辑器。如果您属于该类别，从编程的角度来看，您可以执行以下操作：

```
SAVE TRANSLATE OUTFILE='path\to\file.csv'
  /TYPE=CSV
  /MAP
  /REPLACE
  /FIELDNAMES
  /CELLS=LABELS. 
```

注意最后一行，`/CELLS=LABELS.`-- 如果您想要这些值，您可以将其更改为（惊喜！）`/CELLS=VALUES.`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-28T23:18:39.320

是的，这是可能的（至少在 SPSS 20 中）。在文件菜单中，选择“另存为...”，在打开的对话框的下拉菜单中选择“另存为类型：'逗号分隔 (*.csv)')”，然后在其下方选择“保存值定义的标签而不是数据值”（或点击“Alt-a”）并选择“保存”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-28T23:20:11.627

在我的 SPSS (17) 版本中，保存窗口有一个“保存定义的值标签而不是数据值”的复选框，它将保存随附的标签而不是数值。

# java - 备忘录模式和序列化之间的区别

> ID：14076772
> 
> 赞同：16
> 
> 时间：2012-12-28T22:50:00.560
> 
> 标签：java, design-patterns, serialization, memento

我正在对纪念品模式进行一些研究，而且我通常对行为模式不熟悉，而且我的研究让我很困惑。我一直感到困惑的主要事情之一是备忘录模式和序列化之间的区别。

据我所知，两者都可用于存储对象并在以后将它们带回，但我无法找到关于它们之间主要区别的明确答案，也许我在研究中遗漏了一些东西但我想知道是否有人可以阐明两者之间的区别。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-28T22:54:23.237

通常，Memento 模式用于实现回滚/保存点支持。例如，我可能想在某个时间点标记一个对象的状态，做一些工作，然后决定将该对象恢复到被标记的点。

Memento 模式的实现可以使用序列化，这将涉及将对象的内容保存到 byte[] 并保存在内存中或写入磁盘。当恢复对象的内容时，将从序列化的副本中重建。

相反，我可以通过在内存中克隆对象并保留对副本的引用，然后在对象需要恢复时将状态复制回来来实现 Memento 模式。此方法不使用序列化。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-28T22:55:31.360

Memento 模式是一种 OO 设计模式，用于将对象的先前状态保存在内存中。例如，实现“撤消”操作很有用。

例如，序列化是将对象图转换为字节数组的过程，以便将其保存在磁盘上，或通过网络将其发送到另一个 JVM。他们没有太多共同点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-15T05:44:28.257

[Memento](https://en.wikipedia.org/wiki/Memento_pattern) 是一种软件设计模式，它提供了将对象恢复到其先前状态（通过回滚撤消）的能力。

[纪念品](https://dzone.com/articles/design-patterns-memento)结构 ：

[![在此处输入图像描述](../Images/d93db80d8ca4e0ae314cb66a6b9d047f.png)](https://i.stack.imgur.com/ULHL8.png)

memento 模式由三个对象实现：*originator*、*caretaker*和*memento*。

*发起者*是一些具有内部状态的对象。

*看守者*将对发起者做一些事情，但希望能够撤消更改。看守人首先向发起人索要纪念品。然后它会执行它要执行的任何操作（或操作序列）。为了回滚到操作之前的状态，它将*memento*对象返回给*originator*。

序列化用于持久化对象状态。这不是设计模式。*有关序列化*的更多详细信息，请参阅此 SE 问题。

[使用可序列化而不是向/从文件写入和读取对象](https://stackoverflow.com/questions/31524162/use-of-serializable-other-than-writing-reading-object-to-from-file/31541629#31541629)

*Memento*模式可能使用也可能不使用*Serialization*。如果 memento 对象没有离开 JVM 或没有通过远程调用传递给其他服务，则 memento 可以将对象状态存储在内存中而无需*序列化*。存储的对象可以稍后用于更改状态。

有关更多详细信息，请参阅[来源制作](https://sourcemaking.com/design_patterns/memento)文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T22:56:50.580

顾名思义，设计模式解决了设计问题。

序列化是一种“冻干”对象的方法。

所以序列化可能是一种实现机制，您可以通过它实现备忘录模式。

但是，您可以在不使用序列化的情况下轻松实现备忘录模式。

# java - 模拟游戏 - 检查代理是否被阻止

> ID：14076773
> 
> 赞同：0
> 
> 时间：2012-12-28T22:50:19.200
> 
> 标签：java, simulation, game-physics

我正在尝试编写一个捕食者/猎物类型的模拟，其中两种不同类型的这些代理在模拟中四处移动。现在我有 8 个可能的移动方向（向右、向前、向右、向前等），代理可以进入。为了让它看起来更自然，我想像这样实现基于角度的运动：

```
xPos+= speed * Math.cos(Math.toRadians(angle));
yPos+= speed * Math.sin(Math.toRadians(angle)); 
```

我已经在模拟中实现了碰撞检测，其中代理不能相互重叠。现在我面临的问题是我如何检查我的代理是否已被阻止（被其他代理限制）并因此无法移动。通过之前的 8 向移动，我所做的是尝试移动其中一个八个可能的方向，如果代理无法在该方向移动（碰撞或边界），则从可能的移动方向中删除该方向并重试。一旦没有留下任何移动方向，则意味着代理已被框住。

但是我如何检查代理是否已被装箱，如果不是，如果我要实现基于角度的移动（肯定检查单个可能的移动角度是非常低效的），它应该选择哪个移动角度。或者我应该坚持8向运动？

目前代理向视野中最近的食物移动，否则它自由漫游。代理对它可以转动的速度等没有限制（现在可以立即转动）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:52:35.363

只需像您已经做的那样检查角色周围的所有 4 个边界，如果它们不可用，则使四个对角线运动同样不可用。

# linux - 返回字符串比较结果 - bash

> ID：14076774
> 
> 赞同：2
> 
> 时间：2012-12-28T22:50:24.130
> 
> 标签：linux, bash, scripting, gentoo

我正在编写一个比较两个文件的 md512sums 的小函数。我不能说我擅长 bash，但我需要返回一个简单的结果，注释部分是长代码。它要求减少。

顺便说一句，如果有人对改进我的代码有任何想法，我将不胜感激。

```
function TestStage()
{
    local URL="distfiles.gentoo.org/releases/${1:7:5}/current-stage3/${1}"
    wget -q ${URL}.DIGESTS
    local SUM_WEB=`cat ${1}.DIGESTS | sed '2q;d'`
    local SUM_LOC=`openssl dgst -r -sha512 ${1}`
    ####### time to return
    return [[ "${SUM_WEB:0:128}" == "${SUM_LOC:0:128}" ]]

    #if [ "${SUM_WEB:0:128}" == "${SUM_LOC:0:128}" ]
    #then
    #    rm ${1}.DIGESTS
    #    return 0
    #else
    #    rm ${1}.DIGESTS
    #    return 1
    #fi
} 
```

正如您可能已经猜到`$1`的那样`stage3-<arch>-<release>.tar.bz2`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T11:10:17.803

改进：

```
TestStage() {
    local url sum_web sum_loc
    url="distfiles.gentoo.org/releases/${1:7:5}/current-stage3/${1}"
    wget -q "$url.DIGESTS"
    { read; read -r sum_web; } < "$1.DIGESTS"
    sum_loc=$(openssl dgst -r -sha512 "$1")
    ####### time to return
    [[ "${sum_web:0:128}" = "${sum_loc:0:128}" ]]
    return
} 
```

*   使用小写变量名。
*   不使用已弃用的`function`关键字。
*   使用 of`$(...)`代替反引号。
*   使用 bash 内置函数而不是`sed`获取文件的第二行`"$1.DIGESTS"`。这节省了进程生成和子shell（以及对 cat 的无用使用）。
*   `return`它自己会返回前一个语句的返回码，这里是测试语句。
*   一次声明所有局部变量。

如果您不关心`$1.DIGESTS`将要保存的文件，您还可以执行以下操作：

```
TestStage() {
    local url sum_web sum_loc
    url="distfiles.gentoo.org/releases/${1:7:5}/current-stage3/${1}"
    { read; read -r sum_web; } < <(wget -q -O- "$url.DIGESTS")
    sum_loc=$(openssl dgst -r -sha512 "$1")
    ####### time to return
    [[ "${sum_web:0:128}" = "${sum_loc:0:128}" ]]
    return
} 
```

现在，`"${1:7:5}"`据我所知，将扩展到第二个字段`stage3-<arch>-<release>.tar.bz2`（字段由连字符分隔）。你也可以这样做：

```
IFS=- read _ arch _ <<< "$1" 
```

在这种情况下，您的功能将是：

```
TestStage() {
    local arch url sum_web sum_loc
    IFS=- read _ arch _ <<< "$1"
    url="distfiles.gentoo.org/releases/$arch/current-stage3/${1}"
    { read; read -r sum_web; } < <(wget -q -O- "$url.DIGESTS")
    sum_loc=$(openssl dgst -r -sha512 "$1")
    ####### time to return
    [[ "${sum_web:0:128}" = "${sum_loc:0:128}" ]]
    return
} 
```

希望这可以帮助。

然后，用作：

```
if TestStage "stage3-<arch>-<release>.tar.bz2"; then
    # return value is true, proceed accordingly
else
    # return value is false, proceed accordingly
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:45:15.043

我不确定您是否可以像您所做的那样返回比较结果。您很可能会遇到语法错误。

但是您可以尝试以下语法：

```
myfunction()
{
    [ "test" = "test" ]
}

myfunction
echo $?    # here if you get 0 that means strings are equal otherwise 1 
```

如果您决定采用这种方法，请确保比较语句是函数中的最后一个语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T00:29:27.590

您不能返回除整数值之外的任何内容。您可以采用 Ashish 的[建议](https://stackoverflow.com/a/14077191/1933494)并在函数调用之后检索退出代码，`$?`或者您可以通过将字符串比较表达式包围起来来评估您的字符串比较表达式，`if ; then`然后只使用`echo`任何值来指示两个哈希是否相同。

# c# - 如何在 C# 中将图像叠加或叠加到视频上

> ID：14076775
> 
> 赞同：1
> 
> 时间：2012-12-28T22:50:36.563
> 
> 标签：c#, image, video, overlay, watermark

我试图弄清楚如何在 Visual C# 中的（保存的文件）视频上覆盖图像，然后重新保存它。在过去的四个小时里，我一直在努力做到这一点，到处寻找，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:21:52.223

DirectShow.NET 是 DirectShow（上一代）MS 多媒体 API 的封装。API 本身更适合原生开发，但 .NET 包装器非常流行且功能强大。

[DirectShow.NET 示例](http://sourceforge.net/projects/directshownet/files/DirectShowSamples/2010-February/)包括：

> Samples\Capture\DxLogo ---------------------- 一个示例应用程序，展示了如何在数据流上叠加徽标。它使用捕获设备作为视频源，并将结果输出到文件。
> 
> Samples\Players\DxText ---------------------- 展示如何在数据流上叠加文本字符串的示例应用程序。流是从 avi 文件中读取的。

# python - 如何知道cherrypy中的原始网址？

> ID：14076780
> 
> 赞同：4
> 
> 时间：2012-12-28T22:51:19.813
> 
> 标签：python, cherrypy

你如何在cherrypy中获得baseurl？我看到一个cherrypy.url()，它给了我整个网址“http://mywebaddress.com/currentpage”

在cherrypy中是否有一些类似的功能可以让我获得“http://mywebaddress.com”/“http://mywebaddress.com/”部分，而不管我在哪条路线上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T02:42:21.230

cherrypy.request 对象具有[base](https://cherrypy.readthedocs.org/en/3.3.0/refman/_cprequest.html#cherrypy._cprequest.Request.base)和[script_name](https://cherrypy.readthedocs.org/en/3.3.0/refman/_cprequest.html#cherrypy._cprequest.Request.script_name)属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T00:57:20.790

查看[urlparse](http://docs.python.org/2/library/urlparse.html)。这将让您将 URL 解析为其组件。

# angularjs - AngularJS - 单击复选框时聚焦输入元素

> ID：14076783
> 
> 赞同：15
> 
> 时间：2012-12-28T22:51:39.480
> 
> 标签：angularjs

单击复选框时，是否有一种更简洁的方式将焦点委托给元素。这是我破解的肮脏版本：

**HTML**

```
<div ng-controller="MyCtrl">
    <input type="checkbox" ng-change="toggled()">
    <input id="name">
</div> 
```

**JavaScript**

```
var myApp = angular.module('myApp',[]);

function MyCtrl($scope, $timeout) {
    $scope.value = "Something";
    $scope.toggled = function() {
        console.debug('toggled');
        $timeout(function() {
            $('#name').focus();
        }, 100);
    }
} 
```

JSFiddle：http: [//jsfiddle.net/U4jvE/8/](http://jsfiddle.net/U4jvE/8/)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-28T23:15:22.250

这个怎么样 ？[笨蛋](http://plnkr.co/edit/84NRZHlGeL3LqS4XgTGY)

```
 $scope.$watch('isChecked', function(newV){
      newV && $('#name').focus();
    },true); 
```

@asgoth 和 @Mark Rajcok 是正确的。我们应该使用指令。我只是懒惰。

这是指令版本。[plunker](http://plnkr.co/edit/84NRZHlGeL3LqS4XgTGY)我认为把它作为指令的一个很好的理由是你可以重用这个东西。

所以在您的 html 中，您可以将不同的模态分配给不同的集合

```
<input type="checkbox" ng-model="isCheckedN">
<input xng-focus='isCheckedN'>

directive('xngFocus', function() {
    return function(scope, element, attrs) {
       scope.$watch(attrs.xngFocus, 
         function (newValue) { 
            newValue && element.focus();
         },true);
      };    
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-28T23:58:09.573

另一个指令实现（不需要 jQuery），并借用了@maxisam 的一些代码：

```
myApp.directive('focus', function() {
    return function(scope, element) {
       scope.$watch('focusCheckbox', 
         function (newValue) { 
            newValue && element[0].focus()
         })
    }      
}); 
```

HTML：

```
<input type="checkbox" ng-model="focusCheckbox">
<input ng-model="name" focus> 
```

[小提琴](http://jsfiddle.net/mrajcok/LZKkw/)。

由于该指令不创建隔离作用域（或子作用域），因此该指令假定作用域已`focusCheckbox`定义属性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-28T19:55:22.113

如果您想让它更有趣，并支持要评估的任何表达式（不仅是变量），您可以这样做：

```
app.directive('autofocusWhen', function ($timeout) {
    return {
        link: function(scope, element, attrs) {
            scope.$watch(attrs.autofocusWhen, function(newValue){
                if ( newValue ) {
                    $timeout(function(){
                        element.focus();
                    });
                }
            });
        }
     };
}); 
```

而且您的 html 可以更加解耦，就像这样：

```
<input type="checkbox" ng-model="product.selected" />
{{product.description}}
<input type="text" autofocus-when="product.selected" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T23:51:01.733

更简洁的方法是使用指令来执行切换：

```
app.directive('toggle', function() {
   return {
      restrict: 'A',
      scope: {
         selector: '='
      },
      link: function(scope, element, attrs) {
          element.on('change', function() {
              $(scope.selector).focus();
              scope.$apply();
          });
      }
   }:
}); 
```

你的 html 会是这样的：

```
<input type='checkbox' toggle selector='#name'> 
```

# ruby-on-rails - less-rails-bootstrap ...less 文件在哪里

> ID：14076785
> 
> 赞同：2
> 
> 时间：2012-12-28T22:52:07.637
> 
> 标签：ruby-on-rails, gem, less

我不知道这是否是一个荒谬的问题，但是我正在使用 RefineryCMS、Ruby 和 Rails 创建一个网站。我选择通过 less-rails-bootstrap gem 使用 Twitter 的 Bootstrap 来加速一些事情。但是，我确实需要自定义一些颜色等，尽管我似乎无法找到任何较少的文件。我查看了日志并看到了对诸如“twitter/bootstrap.css”之类的引用，尽管我无法找到这个或较少文件所在的位置。

这些东西在哪里？否则，如何覆盖默认值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:06:06.290

完成 gem install 和`bundle install`command 后，您应该：

```
rails g bootstrap:install 
```

`app/assets`这将在您的dir中插入一些文件，包括`bootstrap_and_overrides.css.less`在`app/assets/stylesheets`.

[您可以在此 Railscast](http://railscasts.com/episodes/328-twitter-bootstrap-basics?view=asciicast)中了解更多信息。

更新：（2014 年 1 月 25 日）：有价值的信息来自 @Niels Abildgaard 的评论：

根据 gem 的[GitHub 存储库](https://github.com/metaskills/less-rails-bootstrap/blob/master/README.md)，`less-rails-bootstrap`Rails 生成器命令应该是：

```
rails generate less_rails_bootstrap:custom_bootstrap 
```

# objective-c - AFNetworking 返回 400

> ID：14076793
> 
> 赞同：0
> 
> 时间：2012-12-28T22:53:18.813
> 
> 标签：objective-c, afnetworking

我正在尝试制作一个简单的登录系统

我正在使用 AFNetworking，这是我的登录功能：

```
- (void) login {

NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:email.text, @"email", password.text, @"password", nil];

AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:@"http://localhost:8888"]];
[httpClient setParameterEncoding:AFFormURLParameterEncoding];

NSMutableURLRequest *request = [httpClient requestWithMethod:@"POST"
                                                        path:@"http://localhost:8888/api.php"
                                                  parameters:params];

AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];

[httpClient registerHTTPOperationClass:[AFHTTPRequestOperation class]];

[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSString *response = [operation responseString];
    NSLog(@"response: [%@]",response);
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"error: %@", [operation error]);
}];

[operation start]; 
```

}

它返回状态 400“错误请求”，所以我假设我的帖子格式错误。但我似乎找不到它有什么问题？

这里是登录 APi 一览

```
function login() {

    // Check for required params
    if (isset($_POST['email']) && isset($_POST['password'])) { 

        // Put params into local variables
        $email = $_POST['email'];
        $pass = $_POST['password'];

        echo 'Your email:' + $email + 'and password: ' + $password;

        // look up params in db
        $stmt = $this->db->prepare('SELECT `email`, `password`, `group_name` FROM `User` WHERE `email` = ? AND `password` = ?'); 
        $stmt->bind_param('ss', $email, $password); 
        $stmt->execute();
        $stmt->bind_result($u_email, $u_password, $group_name);
        while ($stmt->fetch()) {
            break;
        }

        $stmt->close();

        // Bail if code doesn't exist

        // Return unlock code, encoded with JSON
        $result = array(
            "group_name" => $group_name,
        );

        sendResponse(200, json_encode($result));
        return true;
    } 

    sendResponse(400, 'Invalid request');
    return false;
} 
```

因此，您可以看到电子邮件/密码没有随帖子一起发送，因为它们的值没有设置。

这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:57:00.910

在运行网络主机的机器上获取wireshark。

[http://www.wireshark.org/](http://www.wireshark.org/)

然后您可以读取服务器上的网络流量。

也许它甚至没有到达服务器。或者可能端口 8888 被阻止。

或者可能是 http 请求格式错误，服务器不知道该怎么做，所以它返回 400

对于您可以使用的过滤器

```
tpc.port == 8888 
```

这样它只会显示端口 8888 上的 tcp 流量

# c# - 根据下拉列表标准插入数据

> ID：14076795
> 
> 赞同：0
> 
> 时间：2012-12-28T22:53:23.343
> 
> 标签：c#, asp.net, gridview

我的 asp.net 项目中有 2 个 datetimepicker、1 个下拉列表、1 个 gridview、4 个文本框和 1 个按钮。

我从 datetimepicker 中选择日期，然后从下拉列表中选择员工姓名。

在我根据该标准获得 gridview 之后。之后，我想在文本框中输入值，并且我想用我的 button1_click 事件将该值插入到数据库中。或者，如果我可以在源端做到这一点。

我怎样才能做到这一点 ？请帮忙。这是 .cs 代码；

```
SqlConnection conn;
        SqlCommand cmd = new SqlCommand();
        string strSQL = "Insert INTO penalties(DAY,P1,P2,OVER) Values (@DAY,@P1,@P2,@OVER)";
        string bag_str = WebConfigurationManager.ConnectionStrings["asgdb01ConnectionString"].ConnectionString;
        conn = new SqlConnection(bag_str);
        conn.Open();
        cmd.Connection = conn;
        cmd.CommandText = strSQL;
        cmd.Parameters.Add(new SqlParameter("@DAY", TextBox3.Text));
        cmd.Parameters.Add(new SqlParameter("@P1", TextBox4.Text));
        cmd.Parameters.Add(new SqlParameter("@P2", TextBox5.Text));
        cmd.Parameters.Add(new SqlParameter("@OVER", TextBox6.Text));

        int i = cmd.ExecuteNonQuery();
        conn.Close();
        if (i > 0)
            Response.Write("Data Inserted");
        else
            Response.Write("Error"); 
```

插入值后我需要 where 条件，但我将如何设置该条件？我在源端有这样的控制参数；

```
<InsertParameters>
        <asp:ControlParameter ControlID="Textbox1" Name="date1" Type="DateTime" PropertyName="Text" />
        <asp:ControlParameter ControlID="Textbox2" Name="date2" Type="DateTime" PropertyName="Text" />
        <asp:ControlParameter ControlID="DropDownList1" Name="name1" Type="String" PropertyName="Text" />
    </InsertParameters> 
```

等待你的答复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T15:23:12.447

我问了这个更复杂的问题，并在这里回答了这个话题；[使用 C# 使用条件更新数据库](https://stackoverflow.com/questions/14123899/update-database-with-conditions-by-using-c-sharp)

# delphi - 如果菜单有子项，Delphi TMenuItem OnClick 不起作用

> ID：14076798
> 
> 赞同：0
> 
> 时间：2012-12-28T22:53:39.557
> 
> 标签：delphi, winapi

似乎`Onclick`没有为具有子项的菜单项处理事件。

我意识到我可以创建一个用户可以使用的叶子项目，但我想让我的菜单文件夹响应`OnClick`（在我的情况下“启动”所有子项目）

有没有办法绕过这个限制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T23:00:24.943

具有子项的菜单项确实会触发`OnClick`事件。但是它们会在子菜单打开时触发，而不是在您单击父菜单项时触发。

我很确定您不想在发生这种情况时调用所有子项。`OnClick`每当打开子菜单时，都会触发父菜单的事件。当您单击父菜单项时，将鼠标悬停在其上，或者在通过键盘选择菜单项时按右箭头键。

因此，`OnClick`父菜单的事件对应于打开子菜单。打开子菜单时调用所有子菜单项操作违反了所有标准的预期 UI 行为。您应该做的是添加另一个可用于调用所有操作的子项。除非没有明智的选择，否则不要违背平台标准 UI。

# php - 使用 PHP 进行导航的文件夹和子文件夹结构

> ID：14076801
> 
> 赞同：1
> 
> 时间：2012-12-28T22:54:14.297
> 
> 标签：php, navigation, directory

> **可能重复：**
> [关于 PHP 递归导航列表菜单的帮助](https://stackoverflow.com/questions/2909868/help-with-php-recursive-navigation-list-menu)

我正在构建一个导航系统，该系统仅由服务器上的文件夹和子文件夹目录结构驱动。

例如：画廊

*   婚礼
*   自然
    *   鸟类
    *   猫
    *   小狗
*   航空
    *   战斗机
    *   商业的
    *   二战

现在我已经完成了这段代码，但我无法将其格式化为导航系统所需的无序列表和列表项。

```
<?php
function readDirs($path){
  $dirHandle = opendir($path);
  while($item = readdir($dirHandle)) {
    $newPath = $path."/".$item;

if(is_dir($newPath) && $item != '.' && $item != '..') {
    echo "<a href='$newPath'>$item</a>";
    readDirs($newPath);
  }
 }
}

$path =  "./galleries";
readDirs($path);

?> 
```

这是我需要作为 PHP 输出的 html 格式：

```
 <ul>
        <li><a href="./galleries/wedding">wedding</a></li>
        <li><a href="./galleries/nature/">nature</a>
            <ul>
                <li><a href="./galleries/nature/birds/">birds</a></li>
                <li><a href="./galleries/nature/cats/">cats</a></li>
                <li><a href="./galleries/nature/dogs/">dogs</a></li>
            </ul>
        </li>
        <li><a href="./galleries/aviation/">aviation</a>
            <ul>
                <li><a href="./galleries/aviation/fighter jets/">fighter jets</a></li>
                <li><a href="./galleries/aviation/commercial/">commercial</a></li>
                <li><a href="./galleries/aviation/wwii/">wwii</a></li>
            </ul>
        </li>
    </ul> 
```

在这件事上，任何帮助都将不胜感激。

提前致谢。

# javascript - 为图像进行平滑运动的最佳方法

> ID：14076813
> 
> 赞同：3
> 
> 时间：2012-12-28T22:55:47.537
> 
> 标签：javascript, drawing, html5-canvas

我写了一个快速程序来在屏幕上反弹一个球。一切正常，但图像容易闪烁且不流畅。

我怀疑图像闪烁是因为屏幕底部的速度很大。

我想知道是否有人对如何插入球的运动以减少闪烁有任何想法。

调用更新位置

```
 this.step = function()
      {
        thegame.myface.y = thegame.myface.y + thegame.myface.vSpeed;
        if (thegame.myface.y > thegame.height)
        {
        thegame.myface.vSpeed = -thegame.myface.vSpeed;
        }
        else
        {
        thegame.myface.vSpeed = thegame.myface.vSpeed + 1;
        }
      }
  }, 
```

调用重绘

```
draw: function()
      {
          //clears the canvas
          thegame.ctx.clearRect(0,0,thegame.width,thegame.height);
          //draw the objects
          thegame.ctx.drawImage(thegame.imgFace,this.x-this.width/2,this.y-this.height/2);
          return;
      }, 
```

调用框架`index.html`

```
<script type="text/javascript">
thegame.init(450,450);
// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
(function()
 {
 var lastTime = 0;
 var vendors = ['ms', 'moz', 'webkit', 'o'];
 for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x)
 {
 window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
 window.cancelRequestAnimationFrame = window[vendors[x]+'CancelRequestAnimationFrame'];
 }
 if (!window.requestAnimationFrame)
 {
 var f = function(callback, element)
 {
 var currTime = new Date().getTime();
 var timeToCall = Math.max(0, 16-(currTime-lastTime));
 var id = window.setTimeout(function()
     {
     callback(currTime+timeToCall);
     }, timeToCall);
 lastTime = currTime+timeToCall;
 return id;
 };
window.requestAnimationFrame = f;
 }
if (!window.cancelAnimationFrame)
    window.cancelAnimationFrame = function(id)
    {
        clearTimeout(id);
    };
 }());
(function gameloop()
 {
 thegame.update();
 requestAnimationFrame(gameloop);
 thegame.draw();
 })();
</script> 
```

编辑定义`thegame`

```
 init: function(width, height)
   {
       var canvas = $("<canvas width='"+width+"' height='"+height+"'></canvas>");
       canvas.appendTo("body");
       thegame.ctx = canvas.get(0).getContext("2d");
       thegame.width = width;
       thegame.height = height;
       thegame.imgFace = new Image();
       thegame.imgFace.src = "face.png";
       thegame.myface = new thegame.makeFace(width/2,height/2);
   }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T19:12:19.197

你的画布有多大？不确定它是否会解决您的闪烁问题，但您可以尝试的另一个优化是修改您的 clearRect() 调用以仅在每次更新之前清除脏区域。

例如：thegame.ctx.clearRect(this.x-this.width/2, this.y-this.height/2, thegame.imgFace.width, thegame.imgFace.height);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T14:42:10.067

这是关于视觉感知的。首先找出浏览器通过 requestanimationframe 调用游戏循环的速率。如果是 Chrome，它的任务管理器会有所帮助。如果没有，请使用时间戳自己计算费率。它应该至少每秒60次。如果浏览器以这个速度运行并且移动仍然不流畅，那么速度对于那个速度来说太高了。

但是，您可以选择欺骗运动感知。一种是使图像更小（简单），另一种是运动模糊（复杂）。要执行后者，您基本上以双倍速度运行隐藏的游戏并将两个混合帧绘制到可见画布上。或者以相同的速度和更简单的方式，跟踪最后两张图像并在画布上使用 50% 的 alpha 进行绘制。如果您想了解更多背景信息，请关注为什么最新的霍比特人电影以 48 帧而不是通常的每秒 24 帧拍摄。

如果出现图像被水平切开/切成两半，则浏览器未正确同步到显示器。在这种情况下，请确保垂直同步 (vsync) 不会被系统或显示选项覆盖。

# php - 提高服务器验证中的密码安全性

> ID：14076818
> 
> 赞同：9
> 
> 时间：2012-12-28T22:56:08.847
> 
> 标签：php, mysql

我目前正在建立一个设置来获取信用卡信息。使用了以下结构：

**服务器 1：**

*   MySQL用户设置为只读
*   保存登录凭据。

我使用 PBKDF2 散列，使用基于[此代码](http://crackstation.net/hashing-security.htm#phpsourcecode)构建的类完成。

**服务器 2：**

*   MySQL用户设置为读写
*   保存所有客户的信用卡信息

**我的问题：**

如果服务器 1 以这种格式存储密码：**algorithm:iterations:salt:hash**

例如：`sha256:1000:Pe27BkIKkBHklogp9Io80iRKtF+6koly:nrYUwOlixwJECRcjBRKwQ+MVNMTbnYnm`

如果服务器一被攻破，在我看来，拥有这种格式的密码会让他们很容易破解网站的密码并访问用户的信用卡信息。

这是我需要使用 Mysql（**AES_ENCRYPT() 和 AES_DECRYPT()**）的情况吗？

我是不是想太多了？

有没有更好的方法来保护服务器 1 中的信息？

**根据评论更新**

我建立了我的供暖和空气公司系统。如果他们愿意，任何在线支付的人都可以将他们的抄送信息与 quickbooks 一起存储。我有几个较大的客户，我们每月在办公室开账单，并通过桌面终端处理抄送。这些客户在我们的服务器上有客户资料，他们可以访问这些资料。这些是我希望允许在那里存储 cc 信息的客户端。这样我就不必将抄送信息存储在我们办公室的纸上供任何人查找。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T01:11:50.597

老实说，如果我设法攻破服务器 1，我不会尝试破解这些密码。他们应该是安全的。我更有可能做的是尝试在服务器上安装我自己的代码，以便在用户登录时向我发送密码和/或信用卡信息。例如，假设您在名为 login.php 的文件中处理身份验证. 如果我可以破坏 login.php，那么当它验证登录时，我可以让它执行 curl 命令或其他东西，将登录信息发送到我自己的服务器，我可以在那里收集它。

但是我离题了...答案是您对用户登录详细信息的散列应该是安全的，正如您所描述的那样。如果服务器 1 的数据库遭到破坏，它应该尽可能安全。您可以在 PHP 代码中添加一层混淆，以在盐的哈希中执行类似 munge 之类的操作，这样可以访问数据库但没有代码的人将很难知道您使用什么过程进行哈希处理密码，这将避免黑客试图暴力破解密码，如密码、iloveu 等。我还*强烈*建议服务器 2 上的信用卡信息使用`AES_ENCRYPT()`PHP 或 PHP 的[`mcrypt_encrypt()`](http://php.net/manual/en/function.mcrypt-encrypt.php)函数以加密格式存储。

确保你通过 POST 表单清理*了所有*输入，你应该很高兴。

# python - 如何在python中编码解析规则？

> ID：14076819
> 
> 赞同：0
> 
> 时间：2012-12-28T22:56:09.910
> 
> 标签：python, xml-parsing, document-imaging

给定许多类的 XML 对象（例如，文档图像的类型），我需要根据对象的类和一组与 XML 文件内容相关的复杂数学规则生成一些输出。

这个任务的通用名称是什么（解析？）以及为每个类编码单独规则的最简单方法是什么，记住这些规则可能涉及数学关系。我想我应该为每个类创建一个文件，以便使用 DSL 对其进行管理，但我不确定。有人建议合并一个成熟的 Lua 或 Javascript 解释器。这是一个好主意吗？我想保持精简，简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:21:43.643

解析是指读取语法中的一系列标记和匹配规则。如果您可以通过这种方式指定您的问题，您可以使用 pyparsing 编写语法。

如果您感兴趣的是提取 XML 文档的结构，那么您可以使用标准的 Python 模块 xml.etree.ElementTree。也看看beautifulsoup。

# sql - 有没有办法更有效地生成一百万个 mac 地址？

> ID：14076820
> 
> 赞同：1
> 
> 时间：2012-12-28T22:56:13.187
> 
> 标签：sql, sql-server, sql-server-2012-express

有没有办法更有效地生成一百万个 MAC 地址？

这是我正在做的事情，但是生成一百万个 MAC 地址并将它们插入到我的表中需要大约 10 分钟：

```
DECLARE @StartRange BINARY(6) 
DECLARE @EndRange BINARY(6) 
SET @StartRange = 0x0036D1F00000 
SET @EndRange = 0x0036D1FFFFFF 
--select convert(bigint,+ @EndRange) - convert(bigint,+ @StartRange) = 1048575
WHILE(convert(bigint, (SELECT IDENT_CURRENT('Mac_Address'))) < (convert(bigint, @EndRange) - convert(bigint, @StartRange)))
BEGIN
insert into Mac_Address (MacAddress)
select convert(BINARY(6),(convert(bigint, (SELECT IDENT_CURRENT('Mac_Address'))) + convert(bigint, @StartRange)))
END 
```

这是我在网上找到的执行此操作的代码，它会在几秒钟内执行。但是它正在将 MAC 地址生成到系统表中：

```
DECLARE @StartRange BINARY(8) 
DECLARE @EndRange BINARY(8) 
SET @StartRange = 0x00000004A500114B 
SET @EndRange = 0x00000004A50F11FF 

--select convert(integer,+ @EndRange) - convert(integer,+ @StartRange) = 983220

select convert(BINARY(8),RW + convert(integer, @StartRange)) 
from
(select row_number() over(order by a.id) As RW from syscolumns,syscolumns a,syscolumns b ,syscolumns c) b --I do not understand this line very well.
where RW between 1 and (convert(integer, @EndRange) - convert(integer, @StartRange)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T23:04:19.633

正如您所说，这不是“将 MAC 地址生成到系统表中”。它只是使用`syscolumns`表作为获取大量行的一种手段。您可以知道这一点，因为所有系统表都在该`FROM`子句中。要插入到表中，至少需要`INSERT`or `SELECT ... INTO`。

它速度快的原因是因为 SQL Server 针对“基于行”的操作进行了优化。在引擎内部，当然它必须遍历每一行，但它已经过大量优化。当您将 T-SQL 视为一种过程语言并一次循环遍历每个项目时，它不能使用这些优化，并且必须在完全不同的执行上下文中一次执行每个语句。

表`syscolumns`本身毫无意义。它具有价值，因为它保证有很多行。它可以是具有许多行的任何表——`FROM`子句中的表只是被交叉连接在一起以获得它们的笛卡尔积（意味着很多行），因此该`Row_Number()`函数可以使用一些东西来创建一个包含来自的数字的行集1 到 1,000,000。

如果您愿意，您可以使用这样的方法，它根本不会碰到任何“真实”表，它的执行速度应该一样快或更快。它所做的只是获取初始`SELECT 1 UNION ALL SELECT 1`值并通过重复`CROSS JOIN`ing 将其转换为 43 亿行（但使用的旧式语法`FROM Table1, Table2`与 as 相同`FROM Table1 CROSS JOIN Table2`但更短）。

我在 SQL 2008 中测试了以下内容，它运行良好。在我的 SQL Server 上需要**3 秒**（此时 SQL Fiddle 错误地抛出错误，我已通过电子邮件发送给管理员）。

```
DECLARE
   @StartRange bigint = 0x0004A500114B,
   @EndRange bigint = 0x0004A50F11FF;

WITH -- make sure you terminate your prior statement by putting ; after it
L0 AS (SELECT 1 N UNION ALL SELECT 1),
L1 AS (SELECT 1 N FROM L0, L0 B),
L2 AS (SELECT 1 N FROM L1, L1 B),
L3 AS (SELECT 1 N FROM L2, L2 B),
L4 AS (SELECT 1 N FROM L3, L3 B),
L5 AS (SELECT 1 N FROM L4, L4 B),
Nums AS (SELECT ROW_NUMBER() OVER (ORDER BY (SELECT 1)) N FROM L5)
INSERT Mac_Address (MacAddress)
SELECT Convert(binary(6), N + @StartRange - 1)
FROM Nums
WHERE N <= @EndRange - @StartRange + 1 
```

但是，我不能 100% 确定这将在 SQL Server 2012 的 Express 版本中工作。使用该`syscolumns`版本实际上没有任何问题，您只需添加一条`INSERT`语句并更正一些问题（包括`int`而不是`bigint`和`binary(8)`而不是`binary(6)`） . 请注意，您可以通过`WITH (NOLOCK)`在每个`syscolumns`表之后添加（或`SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED`在查询之前和`SET TRANSACTION ISOLATION LEVEL READ COMMITTED`之后使用）来提高性能。这个查询也执行得很好（在我的服务器上 2 秒）。

```
DECLARE
   @StartRange bigint = 0x0004A500114B,
   @EndRange bigint = 0x0004A50F11FF;

INSERT Mac_Address (MacAddress) -- Add this line
SELECT Convert(binary(6), N + @StartRange - 1) 
FROM
(
    SELECT N = Row_Number() OVER (ORDER BY (SELECT 1))
    FROM
       syscolumns WITH (NOLOCK),
       syscolumns a WITH (NOLOCK),
       syscolumns b WITH (NOLOCK),
       syscolumns c WITH (NOLOCK)
) b
WHERE N <= @EndRange - @StartRange + 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:01:58.833

第二个片段根本没有插入任何东西。它仅使用 syscolumns 表的（与自身交叉连接）行号来生成整数。

您可以为此使用任何其他表（前提是您有足够的行数或加入足够的次数来生成它）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T23:04:22.887

它并没有真正使用 syscolumns。它只是将它连接在一起以创建一个包含足够行数的表以供您的范围使用。如果您对此感到不舒服，可以执行以下操作：

```
with digits as (select 0 as dig union all
                select 1 union all
                select 2 union all
                select 3 union all
                select 4 union all
                select 5 union all
                select 6 union all
                select 7 union all
                select 8 union all
                select 9
               ),
      nums as (select dig1 + 10*dig2+100*dig3+1000*dig4+10000*dig5+100000*dig6 as num
               from dig dig1 cross join dig dig2 cross join
                    dig dig3 cross join dig dig4 cross join
                    dig dig5 cross join dig dig6
              )
select convert(BINARY(8), num + convert(integer, @StartRange)) 
from nums
where num + 1 between 1 and (convert(integer, @EndRange) - convert(integer, @StartRange)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T23:24:55.977

以下内容很简单，并且在在线[SqlFiddle](http://www.sqlfiddle.com/#!6/2910c/10/0)上运行了大约一分钟：

```
DECLARE @StartRange bigint;
DECLARE @EndRange bigint;
SET @StartRange = 0x0036D1F00000;
SET @EndRange =   0x0036D1FFFFFF; 

WITH cteMacAddress AS (
  SELECT @StartRange MacAddress
  UNION ALL
  SELECT MacAddress+1 FROM cteMacAddress
  WHERE MacAddress <= @EndRange
)
INSERT Mac_Address
  SELECT CAST(MacAddress AS BINARY(6))
  FROM cteMacAddress
  OPTION (MAXRECURSION 0);

SELECT COUNT(*) GeneratedAddressCount
  FROM Mac_Address; 
```

# jquery - jquery soundcloud 播放/停止

> ID：14076824
> 
> 赞同：1
> 
> 时间：2012-12-28T22:56:25.280
> 
> 标签：jquery, soundcloud

如何在曲目播放期间添加 CSS 类“playSound”？

```
jQuery(文档).ready(函数($)
    {
        var widget = SC.Widget(document.getElementById('soundcloud_widget'));

        /*widget.bind(SC.Widget.Events.READY, function()
        {
            //console.log('准备好了...');
            jQuery(".checkSound").removeClass('stopSound').addClass('playSound');
        });*/

        jQuery('.playSound').click(函数()
        {
            小部件.toggle();
            jQuery(".playSound").addClass('stopSound');
        });

        jQuery('.stopSound').live(function()
        //jQuery(".stopSound").live("click", function()
        //jQuery('.stopSound').click(function()
        {
            jQuery(".stopSound").addClass('playSound').removeClass('stopSound');
        });
    });
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:04:52.440

我从未使用过 SoundCloud，但您似乎正在尝试使用相同的元素来播放和停止。如果是这种情况，这应该有效：

```
jQuery(".playSound,.stopSound").click(function(){
    jQuery(this).toggleClass("playSound stopSound");
    widget.toggle();
}); 
```

点击事件可能会绑定到单个元素。选择器`.playSound,.stopSound`是为了确保它选择元素，而不管它从哪个类开始。 `.toggleClass()`如果它们在列表中，将删除类，如果不在列表中，则添加类。我假设`widget.toggle()`正在按预期工作。

# jquery-mobile - 如何在 jquery mobile 中在一行中创建三个“喜欢”图像按钮（一个在另一个旁边）？

> ID：14076842
> 
> 赞同：1
> 
> 时间：2012-12-28T22:58:35.743
> 
> 标签：jquery-mobile

如何在 jquery mobile 中在一行中创建三个“喜欢”图像按钮（一个在另一个旁边）？

我试过这样

```
<body>
    <a class="ui-icon-google" href="#" data-role="ui-li-aside" data-icon="google" data-theme="a"/>
    <a class="ui-icon-facebook" href="#" data-role="ui-li-aside" data-icon="facebook" data-theme="a"/a>
    <a class="ui-icon-twitter" href="#" data-role="ui-li-aside" data-icon="twitte" data-theme="a"/a>
</body> 
```

像CSS一样

```
.ui-icon-google{
    background-image: url("google.png") !important;
    background-position: 4px 50%;
    background-size: 60px 60px;
    margin-top: -12px !important;
    width: 192px;
    height: 192px;
}

.ui-icon-facebook{
    background-image: url("facebook.png") !important;
    background-position: 4px 50%;
    background-size: 60px 60px;
    margin-top: -12px !important;
    width: 192px;
    height: 192px;
}

.ui-icon-twitter{
    background-image: url("twitter.png") !important;
    background-position: 4px 50%;
    background-size: 60px 60px;
    margin-top: -12px !important;
    width: 192px;
    height: 192px;
} 
```

但它一个在另一个之上（出了什么问题，我正在尝试将 openid 的图标放在 stackoverflow 上）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:05:00.173

您首先需要图像，然后您可以将图像链接到您的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:08:11.730

使它成为[一个网格](http://jquerymobile.com/test/docs/content/content-grids.html)：

```
<div class="ui-grid-b">
     <a class="ui-block-a ui-icon-google" href="#" data-role="ui-li-aside" data-icon="google" data-theme="a"/>
     <a class="ui-block-b ui-icon-facebook" href="#" data-role="ui-li-aside" data-icon="facebook" data-theme="a"/a>
     <a class="ui-block-c ui-icon-twitter" href="#" data-role="ui-li-aside" data-icon="twitte" data-theme="a"/a>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T23:14:54.530

只需创建一个内联按钮组：

```
<div data-role="controlgroup" data-type="horizontal" >
    <a href="index.html" data-role="button" data-icon="arrow-u">Up</a>
    <a href="index.html" data-role="button" data-icon="arrow-d">Down</a>
    <a href="index.html" data-role="button" data-icon="delete">Delete</a>
</div> 
```

随心所欲地设计它。看看[这个](http://brooky.cc/2011/04/23/jquery-mobile-cheat-sheet/)链接，在这里你会发现更多 jQM GUI 元素的例子。这是一个例子：http: [//jsfiddle.net/Gajotres/YJfzP/](http://jsfiddle.net/Gajotres/YJfzP/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-24T19:10:44.417

使图像内联或 imline-block 元素。将以下样式添加到 .ui-icon-google、.ui-icon-facebook 和 .ui-icon-twitter：

```
display: inline; 
```

或者，

```
display: inline-block; 
```

# python - 基数为 10 的 int() 的文字无效：''

> ID：14076843
> 
> 赞同：1
> 
> 时间：2012-12-28T22:58:48.257
> 
> 标签：python, casting, slice

我正在尝试自学 python，并且正在尝试为我的 Raspberry Pi 的 GPIO 连接创建一个可远程访问的服务器。当我建立连接时，我发送的第一个输入是我在 Putty 中实际输入的任何内容，然后输入是 ''。所以我对此进行了检查，但我仍然在 if int(data[0])==0: 行上收到该消息。有小费吗？对不起，如果这是一个新手问题。

```
def run(self):
    try:
        while True:
            ret = -1
            data = self.cs.recv(self.BUFFERSIZE)
            if data=='':
                continue
            elif int(data[0])==0:
                self.cs.send(str(GPIO_setup(data)))
            elif int(data[0])==1:
                self.cs.send(str(GPIO_output(data)))
            elif int(data[0])==2:
                self.cs.close()
    except RuntimeError:
        if self.cs:
            self.cs.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:03:05.487

data[0] 可能是 ' ' 或无数其他不是数字的东西。但是要调试，请尝试以下操作：

```
def run(self):
    data = None
    try:
        while True:
            ret = -1
            data = self.cs.recv(self.BUFFERSIZE)
            if data=='':
                continue
            elif int(data[0])==0:
                self.cs.send(str(GPIO_setup(data)))
            elif int(data[0])==1:
                self.cs.send(str(GPIO_output(data)))
            elif int(data[0])==2:
                self.cs.close()
    except RuntimeError:
        print "error on input of: '%s'" % data
        if self.cs:
            self.cs.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:18:24.903

由于您的代码和错误，我怀疑这`data`是一个列表。这将完全按照您观察到的方式失败：

```
In [2]: data = ['', 'test']

In [3]: data == ''
Out[3]: False

In [4]: data[0]
Out[4]: ''

In [5]: int(data[0])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-5-4196b6567736> in <module>()
----> 1 int(data[0])

ValueError: invalid literal for int() with base 10: '' 
```

请注意，由于 的这个定义`data`，当转换仍然失败时不会触发原始测试。

因此最好使用另一个`data[0]`直接测试的测试；

```
data = self.cs.recv(self.BUFFERSIZE)
if len(data[0]) == 0:
    continue 
```

# html - 垂直对齐和浮动

> ID：14076845
> 
> 赞同：0
> 
> 时间：2012-12-28T22:59:13.780
> 
> 标签：html, css

如果我的问题看起来很愚蠢，我很抱歉，但我在这上面花了太多时间。我有一个 div 显示块，其中包含两个跨度，一个在右侧，另一个在左侧。

```
<div class="user-bar">
    <span class="username">Martin GOYOT</span>
    <span class="user-options"><input type="button" class="disconnect" value="déconnexion"/></span>
</div> 
```

我尝试了两件事来让它们垂直对齐：第一个，让这两个浮动，但问题是我可以清楚地看到它们没有流动（正常），因此，如果我将背景应用于容器，它不包括它们：

[http://jsfiddle.net/M7Ffd/1/](http://jsfiddle.net/M7Ffd/1/)

第二种解决方案，让第一个在流程中并将第二个作为浮点数，但结果是我不知道如何垂直对齐它们：

[http://jsfiddle.net/M7Ffd/2/](http://jsfiddle.net/M7Ffd/2/) （注意按钮，即使它看起来也不是真正垂直对齐）

所以，问题是：什么是最好的解决方案，以及如何解决这两种不当行为中的至少一种。

谢谢，对不起，我是一个CSS新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:03:43.387

垂直对齐是一个难题。浮动似乎是每个人对所有事情的第一个 goto 解决方案。避免 gotos，如何使用

```
position: absolute;
right: 0; 
```

[http://jsfiddle.net/M7Ffd/3/](http://jsfiddle.net/M7Ffd/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:51:59.947

对 2 个浮动子项的父元素使用 clearfix hack 来解决您的问题。

```
.clearfix:before, .clearfix:after { content: "\0020"; display: block; height: 0; overflow: hidden; }
.clearfix:after { clear: both; }
.clearfix { zoom: 1; } 
```

我更新了你的小提琴给你看[http://jsfiddle.net/M7Ffd/5/](http://jsfiddle.net/M7Ffd/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T23:19:08.603

这是你想要的吗？[在这里](http://jsfiddle.net/M7Ffd/4/)摆弄

```
.user-bar {
padding: 0.5em;
margin: 0 1em 1em 1em;
background-color: green;
font-weight: bold;
font-size: 1.25em;
height:30px;
min-width:300px;
}
.user-options {
display: inline-block;
background-color: #CCC;
float: right;
}
.username {
float: left;
background: yellowgreen;
} 
```

​ 设置最小宽度并给出高度解决对齐+背景的解决方案。

# java - 一维到二维，无限循环

> ID：14076851
> 
> 赞同：0
> 
> 时间：2012-12-28T22:59:37.983
> 
> 标签：java, multidimensional-array

这是我在 10x10 扫雷游戏板上生成随机地雷的代码。

```
 for (int j = 0; j < 10; j++) {
        mine[j] = (int) (Math.random() * 100);
        while (board[mine[j]] != 99)
            board[mine[j]] = 99;
    } 
```

我想修改它以在 2D int 数组中工作：

```
 for (int j = 0; j < 10; j++) {
        do {
            temp = (int) (Math.random() * 100);
            row = temp / 10;
            column = temp % 10;
        } while (board[row][column] != 99);
        board[row][column] = 99;
    } 
```

但是，此代码会创建一个无限循环。我被卡住了，我想不出它为什么不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:06:36.610

我想你的意思是：[`while`条件错误，你为什么要设置一个已经是 99 到 99 的字段]

```
for (int j = 0; j < 1; j++) {
    do {
        temp = (int) (Math.random() * 100);
        row = temp / 10;
        column = temp % 10;
    } while (board[row][column] == 99);
    board[row][column] = 99;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:28:22.193

为什么你的代码会创建一个无限循环？最初，没有一个单元格具有 99 作为值，并且您的`do_while`条件是`while (board[row][column] != 99);`。所以循环将继续迭代，因为它永远不会遇到值为 99 的单元格。
你的`do_while`条件是错误的。应该是`while (board[row][column] == 99);`
解释：如果当前生成的随机单元格有地雷，即如果单元格值等于 99，则将重新生成行号和列号。`do_while`循环将继续运行，直到生成的单元格位置没有地雷.
我相信这是你想做的。
请注意，您生成地雷的算法不是最优的。有更好的方法来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T23:39:26.867

从语法上讲，您的问题在 while 条件下，但您的算法也不是最优的，因为与已经放置的炸弹的碰撞会越来越频繁。在极端情况下，除了一个位置之外，您必须在棋盘上填满所有位置，您可能需要重新滚动很多次才能找到空闲位置。

最好从只包含空闲位置的集合中抽取槽。

```
 // create an array of slots to draw ten slots from
    int[] slots = new int[100];
    for (int i = 0; i < slots.length; i++) {
        slots[i] = i;
    }

    /*
     * draw ten slots by placing them at the start of the array
     * subsequent draws will draw from the tail of the array
     */
    Random random = new Random();
    for (int i = 0; i < 10; i++) {
        // draw from one of the slots from the tail
        int draw = random.nextInt(100 - i) + i; 

        // switch values at draw and i index
        int temp = slots[draw];
        slots[draw] = slots[i];
        slots[i] = temp;

        // use the draw to place a bomb on the board
        board[(draw / 10)][(draw % 10)] = 99;
    } 
```

# unix - 使用 awk 删除重复项时忽略大小写

> ID：14076852
> 
> 赞同：4
> 
> 时间：2012-12-28T22:59:47.547
> 
> 标签：unix, awk

我正在使用以下命令从文件中删除重复项。

```
awk -F"," '!x[$1]++' test.csv 
```

我怎样才能让它忽略第 1 列的大小写？

我试过`awk -F"," '{IGNORECASE = 1} !x[$1]++' test.csv`了，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T23:02:33.460

使用礼帽：

```
awk -F"," '!x[toupper($1)]++' test.csv 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T04:11:27.037

```
awk -F"," '!x[tolower($1)]++' test.csv 
```

# c# - 下载文件时如何限制带宽并允许多次下载？

> ID：14076855
> 
> 赞同：13
> 
> 时间：2012-12-28T22:59:57.730
> 
> 标签：c#, asp.net-mvc, multithreading, asp.net-mvc-3, download

我有这个代码，它在一次只运行 1 个下载时工作

```
using (System.IO.FileStream fs = System.IO.File.OpenRead(@"C:\HugeFile.GBD"))
{
    using (System.IO.BinaryReader br = new System.IO.BinaryReader(fs))
    {
        Response.AddHeader("Cache-control", "private");
        Response.AddHeader("Content-Type", "application/octet-stream");
        Response.AddHeader("Content-Length", fs.Length.ToString());
        Response.AddHeader("Content-Disposition", "filename=HugeFile.GBD");
        Response.Flush();
        float kbs = 20f;

        while (fs.Position < fs.Length)
        {
            if (!Response.IsClientConnected)
                break;
            byte[] bytes = br.ReadBytes((int)Math.Truncate(1024 * kbs));
            char[] c = UTF8Encoding.Default.GetChars(bytes);

            Response.Write(c, 0, c.Length);

            Response.Flush();
            System.Threading.Thread.Sleep(1000);
        }
        Response.Flush();
    }
} 
```

但是，如果我同时进行两个连接（在同一个浏览器上开始第二次下载），则第二个连接在第一个连接完成之前不会执行。

`Response`将标头添加到...时，使用线程或任务会导致错误

我怎样才能做到这一点，以便我可以同时在同一个浏览器上执行 2 次以上的下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:40:41.407

谷歌浏览器似乎使用唯一的 URL 处理下载，所以当我尝试访问相同的 URL 时，它甚至不会运行该操作。

通过向 URL 添加任何内容，例如：

```
home/download?x=1
home/download?x=2
home/download?x=3 
```

Chrome 会认为它是一个不同的下载并得到它。因此，要下载一个文件，即使每次生成不同的文件，我们也需要更改 URL。

至于油门，我创建了一个`FileThrottleResult`继承自`FilePathResult`：

```
using System;
using System.IO;
using System.Threading;
using System.Web.Mvc;

namespace Mvc3Test
{
    public class FileThrottleResult : FilePathResult
    {
        float rate = 0;

        /// <summary>
        /// 
        /// </summary>
        /// <param name="fileName"></param>
        /// <param name="contentType"></param>
        /// <param name="rate">Kbps</param>
        public FileThrottleResult(string fileName, string contentType, float rate)
            : base(fileName, contentType)
        {
            if (!File.Exists(fileName))
            {
                throw new ArgumentNullException("fileName");
            }
            this.rate = rate;
        }

        protected override void WriteFile(System.Web.HttpResponseBase response)
        {
            int _bufferSize = (int)Math.Round(1024 * this.rate);
            byte[] buffer = new byte[_bufferSize];

            Stream outputStream = response.OutputStream;

            using (var stream = File.OpenRead(FileName))
            {
                response.AddHeader("Cache-control", "private");
                response.AddHeader("Content-Type", "application/octet-stream");
                response.AddHeader("Content-Length", stream.Length.ToString());
                response.AddHeader("Content-Disposition", String.Format("filename={0}", new FileInfo(FileName).Name));
                response.Flush();

                while (true)
                {
                    if (!response.IsClientConnected)
                        break;

                    int bytesRead = stream.Read(buffer, 0, _bufferSize);
                    if (bytesRead == 0)
                        break;

                    outputStream.Write(buffer, 0, bytesRead);
                    response.Flush();
                    Thread.Sleep(1000);
                }
            }
        }
    }
} 
```

用法：

```
public FileThrottleResult Download()
{
    string testFile = @"C:\hugefile.zip";
    return new FileThrottleResult(testFile, "application/octet-stream", 200);
} 
```

这将成功限制带宽，并且不会出现同时下载同一文件的问题，只要您使用“不同”的 url 欺骗浏览器。

# jquery-mobile - iscroll / iscrollview 自定义滚动条

> ID：14076856
> 
> 赞同：1
> 
> 时间：2012-12-28T22:59:58.907
> 
> 标签：jquery-mobile, scrollbar, customization, iscroll4, iscroll

我阅读了文档，试图理解演示，但仍然没有自定义滚动条。

基本上我从 iScroll-Custom-Scrollbar 复制了演示代码：

### HTML

```
<div class="demo-page" data-role="page" id="test-page">

  <div data-role="header">
<h1>Header</h1>
  </div><!-- /header -->

  <div data-iscroll="" data-role="content" id="wrapper">

    <div class="iscroll-pulldown"></div><!--iScroll-Pulldown-->

    <ul data-role="listview" id="thelist">
        <li>Item 1 culpa aut nam qui</li>
        <li>Item 2 minima quam temporibus quidem</li>
        <li>Item 3 commodi sint facilis numquam</li>
    </ul>
 </div><!--wrapper-->
 </div><!--page--> 
```

### 脚本

```
<script type="text/javascript">
var myScroll;
myScroll = new iScroll('wrapper', { scrollbarClass: 'myScrollbar' });
</script> 
```

**实际上应该将一个类属性添加到滚动条的 div 中，但它没有。**

在尝试将栏挤死后；）我发现只要屏幕的高度非常小，就会*添加该类，而当它再次变大时就会消失。*看起来很有趣......让我发疯：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T00:17:28.460

看起来您正在不正确地初始化 iscrollview。

试试这个

```
<div class="demo-page" data-role="page" id="test-page">

  <div data-role="header">
<h1>Header</h1>
  </div><!-- /header -->

  <div data-role="content" data-iscroll='{"scrollbarClass": "myScrollbar"}'>

    <div class="iscroll-pulldown"></div><!--iScroll-Pulldown-->

    <ul data-role="listview" id="thelist">
        <li>Item 1 culpa aut nam qui</li>
        <li>Item 2 minima quam temporibus quidem</li>
        <li>Item 3 commodi sint facilis numquam</li>
    </ul>
 </div><!--wrapper-->
 </div><!--page--> 
```

现在放弃脚本标签中的代码，它是不需要的。

使用 iscrollview 的全部意义在于你不需要在 javascript 中做任何事情。您可以通过将 data-iscroll 属性包含到 div 来设置一个简单的 iscroller。如果您想添加更多自定义的 iscroll 功能，请将其包含在 data-iscroll= 之后的引号中

您也不需要指定包装器元素，因为 iscrollview 插件会自动为您创建一个。

# android - 防止 android 中的 dalvik 更改

> ID：14076862
> 
> 赞同：1
> 
> 时间：2012-12-28T23:00:28.923
> 
> 标签：android, android-lvl

有没有办法保护我的应用程序免受那些改变 dalvik 缓存的工具的影响？

我使用许可（经过大量修改）并且我想保护它免受[此处找到的“](http://lucky-patcher.netbew.com/)*幸运修补程序工具*”的影响。

知道怎么做吗？请帮忙 非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T00:25:54.603

你真的研究过[吗](http://lucky-patcher.netbew.com/)？

引用该站点链接：

> Lucky Patcher 是一款出色的 Android 工具，可绕过高级应用程序许可证验证、删除广告、修改权限等。
> 
> 要使用此应用程序，您需要有根设备。
> 
> 知乎：虽然稳定，但不能保证 Lucky Patcher 100% 正常运行。因此，您对使用此应用程序负全部责任。在任何情况下，Netbew 对您的设备造成的任何问题（重启循环、系统不稳定等）概不负责。

不要浪费时间来保护您的应用程序不受*此*影响！

抱歉，如果这个答案不是您要找的，但它简单明了，请忘记防破解 - 使用[proguard](http://developer.android.com/tools/help/proguard.html)。

一定要知道如何破解它，不要使用 LVL，不管你是否声称它*经过大量修改*。

无论如何，破解者有时间和资源来盗版和破解应用程序，任何反破解**都注定**会在很短的时间内被打破！

专注于功能并满足您的最终用户！

# knockout-2.0 - Knockout-2.2.0，订阅在更改和新值之前获取值

> ID：14076865
> 
> 赞同：18
> 
> 时间：2012-12-28T23:00:57.060
> 
> 标签：knockout-2.0

jsfiddle 链接：http: [//jsfiddle.net/T8ee7/](http://jsfiddle.net/T8ee7/)

当我调用 Knockout 的 subscribe 方法时，有没有一种方法可以同时获得以前的值和新的值？现在，我只能分别调用获取这些值。如果旧值和新值不同，我想触发一些代码。

我想我可以做以下事情，但它会变得混乱......（[http://jsfiddle.net/MV3fN/](http://jsfiddle.net/MV3fN/)）

```
var sv = sv || {};
sv.PagedRequest = function (pageNumber, pageSize) {
    this.pageNumber = ko.observable(pageNumber || 1);
    this.numberOfPages = ko.observable(1);
    this.pageSize = ko.observable(pageSize || sv.DefaultPageSize);
};

var _pagedRequest = new sv.PagedRequest();
var oldValue;
_pagedRequest.pageNumber.subscribe(function (previousValue) {
    console.log("old: " + previousValue);
    oldValue = previousValue;
}, _pagedRequest, "beforeChange");

_pagedRequest.pageNumber.subscribe(function (newValue) {

    console.log("new: " + newValue);
    if (oldValue != newValue) {
        console.log("value changed!");
    }

});

_pagedRequest.pageNumber(10);
_pagedRequest.pageNumber(20);
​ 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-08-01T15:54:58.470

我更喜欢使用[可观察的扩展器](http://knockoutjs.com/documentation/extenders.html)。

[http://jsfiddle.net/neonms92/xybGG/](http://jsfiddle.net/neonms92/xybGG/)

**扩展器：**

```
ko.extenders.withPrevious = function (target) {
    // Define new properties for previous value and whether it's changed
    target.previous = ko.observable();
    target.changed = ko.computed(function () { return target() !== target.previous(); });

    // Subscribe to observable to update previous, before change.
    target.subscribe(function (v) {
        target.previous(v);
    }, null, 'beforeChange');

    // Return modified observable
    return target;
} 
```

**示例用法：**

```
// Define observable using 'withPrevious' extension
self.hours = ko.observable().extend({ withPrevious: 1 });

// Subscribe to observable like normal
self.hours.subscribe(function () {
    if (!self.hours.changed()) return; // Cancel if value hasn't changed
    print('Hours changed from ' + self.hours.previous() + ' to ' + self.hours());
}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-03T14:16:50.043

这似乎对我有用

```
ko.observable.fn.beforeAndAfterSubscribe = function (callback, target) {
 var _oldValue;
 this.subscribe(function (oldValue) {
     _oldValue = oldValue;
 }, null, 'beforeChange');
   this.subscribe(function (newValue) {
     callback.call(target, _oldValue, newValue);
 });
}; 
```

*   查看更多信息：http: [//ideone.com/NPpNcB#sthash.wJn57567.dpuf](http://ideone.com/NPpNcB#sthash.wJn57567.dpuf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T04:13:06.067

[http://jsfiddle.net/MV3fN/3/](http://jsfiddle.net/MV3fN/3/)

```
var sv = sv || {};
sv.PagedRequest = function (pageNumber, pageSize) {
    var self = this;
    self.pageNumber = ko.observable(pageNumber || 1);
    self.numberOfPages = ko.observable(1);
    self.pageSize = ko.observable(pageSize || sv.DefaultPageSize);

    self.pageNumber.subscribe(function (previousValue) {
        console.log(previousValue);
        console.log(self.pageNumber.arguments[0]);
        if (previousValue != _pagedRequest.pageNumber.arguments[0]) {
            console.log('value changed');
        } 
        else {
            //This won't get executed because KO doesn't
            //call the function if the value doesn't change
            console.log('not changed');
        }
    }, _pagedRequest, "beforeChange");
};

var _pagedRequest = new sv.PagedRequest();

_pagedRequest.pageNumber(10);
_pagedRequest.pageNumber(20);
_pagedRequest.pageNumber(20);
_pagedRequest.pageNumber(5); 
```

我不知道你是否真的应该使用`arguments[0]`，但它似乎有效。

您还可以设置自己的方法以更简洁的方式完成此操作：

[http://jsfiddle.net/PXKgr/2/](http://jsfiddle.net/PXKgr/2/)

```
...
    self.setPageNumber = function(page) {
        console.log(self.pageNumber());
        console.log(page);
        if (self.pageNumber() != page) {
            console.log('value changed');
        }
        else {
            console.log('not changed');
        }
        self.pageNumber(page);
    };
...
_pagedRequest.setPageNumber(10);
_pagedRequest.setPageNumber(20);
_pagedRequest.setPageNumber(20);
_pagedRequest.setPageNumber(5); 
```

# chef-infra - 在 Chef 中将默认用户和组从 root 更改为属性驱动

> ID：14076867
> 
> 赞同：0
> 
> 时间：2012-12-28T23:01:16.063
> 
> 标签：chef-infra, vagrant

我正在使用 chef-solo 和 vagrant

Chef 默认对所有内容都使用 root。我只想将 root 用于几件事，但将功能用户用于其他所有事情。

我基本上将一些软件包安装到标准位置（应该以 root 身份完成）。然后，我将一堆东西编译到非标准位置。我希望这整棵树归非 root 用户/组所有。我可以将默认用户/组设置为属性吗？

更广泛地说，为什么 chef 想要充当 root 以及为什么将默认用户更改为非 root 不是更常见的请求？

具体来说，`bash`资源可以获取用户，但这不是用户的完整登录。因此，主目录仍然是 root 的主目录（用户不能写入），创建的文件组仍然是 root。所以，

```
bash "foo" do
  user node[:globals][:username]
  code <<-EOH
    # do stuff
  EOH
end 
```

`do stuff`不是作为用户的完整登录。

这个问题与[https://serverfault.com/questions/402881/execute-as-vagrant-user-not-root-with-chef-solo](https://serverfault.com/questions/402881/execute-as-vagrant-user-not-root-with-chef-solo)和那里提到的错误有关，无法修复：[http:// /tickets.opscode.com/browse/CHEF-1523](http://tickets.opscode.com/browse/CHEF-1523)我想我需要仔细看看，也许是在执行环境属性：[http ://wiki.opscode.com/display/chef/Resources#Resources-Execute](http://wiki.opscode.com/display/chef/Resources#Resources-Execute)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:34:59.007

大多数厨师资源采用用户（或所有者）和组属性来更改默认值。您可以创建目录，将所有者、组和模式设置为任何内容，您可以以非 root 用户身份执行（编译？）。

检查您为这些属性使用的资源。可以将用户名存储在属性或环境中，然后在配方资源块中使用这些值作为用户来运行命令或创建资源。

默认资源的一个很好的参考：[https ://docs.chef.io/resource_directory.html](https://docs.chef.io/resource_directory.html)

IE

```
directory '/tmp/what?' do
  owner node[:username]
  group node[:group]
  mode 00755
end 
```

或者

```
execute 'gcc somefile.cc' do
  user node[:user]
  group node[:group]
end 
```

如果有什么具体的动作你想不通，就指出来。

# java - 正则表达式围绕某些文本要求添加引号

> ID：14076872
> 
> 赞同：-2
> 
> 时间：2012-12-28T23:01:34.993
> 
> 标签：java, javascript, regex, string

我有这个字符串，我试图在满足某些要求的文本周围添加引号“”。规则是在 'Text:' 之后和 ';' 之前的单词中添加 "" 或 '}' 这是字符串： EDIT（注意“”。这不是 JSON 对象。它只是一个字符串）：

```
var str = "View_1:{
        Name:"View1";
        Image_1:{
            BackgroundImage:"Image.gif";
            Position: [0, 0];
            Text: 320;
            Height: 480
        },

        Button_1:{
            BackgroundImage:"Button.gif";
            Transition:"View2";
            Position: [49, 80];
            Width: 216;
            Height: 71;
            Text: more text more
        },

        Button_2:{
            BackgroundImage:"Button2.gif";
            Position: [65, 217];
            Width: 188;
            Text:Some Text;
            Height: 134
        },
    }" 
```

我无法让它工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:07:09.970

试试这个：

```
str.replace(/Text:[\s]*([^;}\r\n]+)/ig, 'Text:  "$1"'); 
```

尽管我对`str`在您的问题中成为一个字符串表示怀疑。它看起来更像（无效的）JSON 对象而不是字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:27:32.707

浏览器将无法解释此文字 javascript 对象上的任何内容。存在语法错误。

您应该首先在 JS 对象的每个属性处丢失分号，并添加一个简单的逗号。

它应该是这样的：

```
var str = View_1: {
    Name:"View1",
    Image_1:{
        BackgroundImage:"Image.gif",
        Position: [0, 0],
        Text: 320,
        Height: 480
    },

    Button_1:{
        BackgroundImage:"Button.gif";
        Transition:"View2",
        Position: [49, 80],
        Width: 216,
        Height: 71,
        Text: more text more
    },

    Button_2:{
        BackgroundImage:"Button2.gif",
        Position: [65, 217],
        Width: 188,
        Text:Some Text,
        Height: 134
    },
}; 
```

分号仅在对象的末尾。这些属性感觉不像是一个常规变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T23:38:30.670

你可以使用

```
var fixed = s.replace(/(Text:\s*)(.+?)(\s*;|}|$)/gm,'$1"$2"$3'); 
```

**演示在** [http://jsfiddle.net/gaby/2etcS/1/](http://jsfiddle.net/gaby/2etcS/1/)

# python - 如何将 Django 模型限制为几种可能的关系之一？

> ID：14076873
> 
> 赞同：0
> 
> 时间：2012-12-28T23:01:48.897
> 
> 标签：python, django

鉴于这些模型，我如何防止将 FinancialTransaction 分配给多个事物？

换句话说，如果 ThingOne 具有 FinancialTransaction，则 ThingTwo 或 ThingThree 不能与它有关系。

如何在管理员中强制执行此操作？我当然可以使用 Inlines 在 SomeThing 管理员中获取 Thing*，但这允许我设置多个 Thing*。

我的第一个倾向是我的建模是错误的，所有事物都应该由一个模型表示，但它们绝对是不同类型的事物。

```
from django.db import models

class ThingOne(models.Model):
    name = models.CharField(max_length=20)

    some_things = models.ForeignKey('FinancialTransaction', blank = True, null = True)

class ThingTwo(models.Model):
    name = models.CharField(max_length=20)

    some_things = models.ForeignKey('FinancialTransaction', blank = True, null = True)
    thingone = models.ForeignKey(ThingOne)

class ThingThree(models.Model):
    name = models.CharField(max_length=20)

    some_things = models.ForeignKey('FinancialTransaction', blank = True, null = True)
    thingtwo = models.ForeignKey(ThingTwo)

class FinancialTransaction(models.Model):
    value = models.IntegerField() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T02:54:53.020

您可以`FinancialTransaction`使用通用外键建立关系。

[https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1)

```
from django.db import models
from django.contrib.contenttypes.models import ContentType
from django.contrib.contenttypes import generic

class FinatialTransation(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id') 
```

那么关系存在于一处，且只能有1处。

然后从`FinancialTransaction`您检查对象 ID 和对象`ContentType`并相应地查找它。

```
ft = FinancialTransaction.objects.get(...)
thing = ft.content_type.get_object_for_this_type(id=ft.object_id) 
```

此外，您可以将 GenericForeignKey 限制为某些内容类型：

```
class FinatialTransation(models.Model):
    limit = models.Q(
        models.Q(app_label='yourappsname', model='ThingOne') | models.Q(app_label='yourappsname', model='ThingTwo') | models.Q(app_label='yourappsname', model='ThingThree')
    )
    content_type = models.ForeignKey(ContentType, limit_choices_to=limit)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id') 
```

# java - 我如何证明在 Java Fork/Join 框架中发生了工作窃取？

> ID：14076890
> 
> 赞同：2
> 
> 时间：2012-12-28T23:04:52.753
> 
> 标签：java, fork-join, work-stealing

我想改进我的 fork/join 小示例，以表明在 Java Fork/Join 框架执行期间会发生工作窃取。

我需要对以下代码进行哪些更改？示例的目的：只需对多个线程之间的值分解工作进行线性研究。

```
package com.stackoverflow.questions;

import java.util.LinkedList;
import java.util.List;
import java.util.Random;
import java.util.concurrent.ForkJoinPool;
import java.util.concurrent.RecursiveTask;

public class CounterFJ<T extends Comparable<T>> extends RecursiveTask<Integer> {

    private static final long serialVersionUID = 5075739389907066763L;
    private List<T> _list;
    private T _test;
    private int _lastCount = -1;
    private int _start;
    private int _end;
    private int _divideFactor = 4;

    private static final int THRESHOLD = 20;

    public CounterFJ(List<T> list, T test, int start, int end, int factor) {
        _list = list;
        _test = test;
        _start = start;
        _end = end;
        _divideFactor = factor;

    }

    public CounterFJ(List<T> list, T test, int factor) {
        this(list, test, 0, list.size(), factor);
    }

    @Override
    protected Integer compute() {

        if (_end - _start < THRESHOLD) {
            int count = 0;
            for (int i = _start; i < _end; i++) {
                if (_list.get(i).compareTo(_test) == 0) {
                    count++;
                }
            }
            _lastCount = count;
            return new Integer(count);
        }
        LinkedList<CounterFJ<T>> taskList = new LinkedList<>();

        int step = (_end - _start) / _divideFactor;
        for (int j = 0; j < _divideFactor; j++) {
            CounterFJ<T> task = null;
            if (j == 0)
                task = new CounterFJ<T>(_list, _test, _start, _start + step, _divideFactor);
            else if (j == _divideFactor - 1)
                task = new CounterFJ<T>(_list, _test, _start + (step * j), _end, _divideFactor);
            else
                task = new CounterFJ<T>(_list, _test, _start + (step * j), _start + (step * (j + 1)), _divideFactor);

            // task.fork();
            taskList.add(task);
        }
        invokeAll(taskList);

        _lastCount = 0;
        for (CounterFJ<T> task : taskList) {
            _lastCount += task.join();
        }

        return new Integer(_lastCount);

    }

    public int getResult() {
        return _lastCount;
    }

    public static void main(String[] args) {

        LinkedList<Long> list = new LinkedList<Long>();
        long range = 200;
        Random r = new Random(42);

        for (int i = 0; i < 1000; i++) {
            list.add(new Long((long) (r.nextDouble() * range)));
        }

        CounterFJ<Long> counter = new CounterFJ<>(list, new Long(100), 4);

        ForkJoinPool pool = new ForkJoinPool();
        long time = System.currentTimeMillis();
        pool.invoke(counter);

        System.out.println("Fork join counter in " + (System.currentTimeMillis() - time));
        System.out.println("Occurrences:" + counter.getResult());

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-24T22:13:22.233

最后我设法做到了，这并不难，所以我把它留给未来的读者。

在*创建*实例本身的`RecursiveTask`保存线程的构造函数中。在方法中检查执行线程是否相同。如果不是工作窃取已经发生。*`compute`*

 *所以我添加了这个成员变量

```
private long _threadId = -1;
private static int stolen_tasks = 0; 
```

像这样更改构造函数：

```
public CounterFJ(List<T> list, T test, int start, int end, int factor) {
        _list = list;
        _threadId = Thread.currentThread().getId(); //added
        _test = test;
        _start = start;
        _end = end;
        _branchFactor = factor;
} 
```

并将比较添加到`compute`方法中：

```
 @Override
   protected Integer compute() {

      long thisThreadId = Thread.currentThread().getId();
      if (_threadId != thisThreadId){
          stolen_tasks++;
      }
   // rest of the method 
```*

# ruby-on-rails - rake assets：ruby 1.9.2 -> 1.9.3 升级后预编译失败

> ID：14076894
> 
> 赞同：0
> 
> 时间：2012-12-28T23:05:46.657
> 
> 标签：ruby-on-rails, asset-pipeline, precompile

我正在尝试在本地预编译我的应用程序资产。当我跑

```
bundle exec rake assets:precompile --trace 
```

我得到一个堆栈级别太深的错误：

```
** Invoke assets:precompile (first_time)
** Execute assets:precompile
/Users/koriroys/.rbenv/versions/1.9.3-p194/bin/ruby /Users/koriroys/.rbenv/versions/1.9.3-p194/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace
** Invoke assets:precompile:all (first_time)
** Execute assets:precompile:all
** Invoke assets:precompile:primary (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
** Invoke tmp:cache:clear (first_time)
** Execute tmp:cache:clear
** Execute assets:precompile:primary
rake aborted!
stack level too deep
  (in /Users/koriroys/source/side_projects/test_app/app/assets/stylesheets/favorites.css.scss)
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:170
Tasks: TOP => assets:precompile:primary
rake aborted!
Command failed with status (1): [/Users/koriroys/.rbenv/versions/1.9.3-p194...]
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/file_utils.rb:53:in `block in create_shell_runner'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/file_utils.rb:45:in `call'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/file_utils.rb:45:in `sh'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/file_utils_ext.rb:40:in `sh'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/file_utils.rb:80:in `ruby'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/file_utils_ext.rb:40:in `ruby'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/actionpack-3.1.1/lib/sprockets/assets.rake:9:in `ruby_rake_task'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/actionpack-3.1.1/lib/sprockets/assets.rake:17:in `invoke_or_reboot_rake_task'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/actionpack-3.1.1/lib/sprockets/assets.rake:25:in `block (2 levels) in <top (required)>'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/Users/koriroys/.rbenv/versions/1.9.3-p194/lib/ruby/gems/1.9.1/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/Users/koriroys/.rbenv/versions/1.9.3-p194/bin/rake:23:in `load'
/Users/koriroys/.rbenv/versions/1.9.3-p194/bin/rake:23:in `<main>'
Tasks: TOP => assets:precompile 
```

自工作以来发生了什么变化`assets:precompile`：我从 ruby​​ 1.9.2 迁移到 1.9.3。不明白为什么它说它在样式表上失败了。有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T01:01:15.947

终于找到了谷歌正确的事情：“scss stack level too deep”。事实证明，根据这个 SO，这是一个 sass 问题：[“rake aborted！stack level too deep” while deploying to Heroku](https://stackoverflow.com/questions/9779456/rake-aborted-stack-level-too-deep-while-deploying-to-heroku)

TL;博士：

我的 Gemfile 中有这个：

```
gem 'sass-rails', '~> 3.1.4' 
```

需要这个：

```
gem 'sass-rails', '3.1.4' 
```

# asp.net - ASP.NET 中的详细信息视图

> ID：14076896
> 
> 赞同：0
> 
> 时间：2012-12-28T23:05:56.733
> 
> 标签：asp.net, gridview, ado.net, detailsview

我正在尝试使用 objectdatasource 访问 sql server 并返回一个数据表来填充我的详细信息视图控件。选定的 ID 值由 gridview 控件返回。似乎数据表没有被适配器填充，我不知道为什么。sql中的ID设置为主键（Int, 4, not null）。调试器说 Detail 数据表为空。任何帮助深表感谢。

```
public DataTable GetDetail(string ID)
        {
            if (ID == "")
            {
                return null;
            }
            else
            {

                DataTable Detail = null;
                using (SqlConnection conn = new SqlConnection(connection))
                {
                    string comm = @"select * from dbo.Products where ID = @ID";
                    conn.Open();
                    SqlDataAdapter adapter=null;
                    using (SqlCommand cmd = new SqlCommand(comm, conn))
                    {
                        cmd.Parameters.Add("ID", System.Data.SqlDbType.Int, 4).Value = Convert.ToInt32(ID);
                        adapter = new SqlDataAdapter(cmd);
                        adapter.Fill(Detail);
                        return Detail;
                    }
                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:09:36.367

我想你错过了 commandType

```
cmd.CommandType = CommandType.Text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T06:39:53.623

试试这个

```
DataSet ds = new DataSet();
using (SqlConnection con = new SqlConnection(connection))
 {
    string myquery="select * from dbo.Products where ID = @ID";
    SqlCommand cmd = new SqlCommand(myquery, con);
    SqlDataAdapter dap = new SqlDataAdapter();
    dap.SelectCommand = cmd;
    cmd.Parameters.Add("@ID", SqlDbType.NVarChar, 15).Value = ID;
    dap.Fill(ds);
    return ds.Tables[0];
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T22:20:59.253

谢谢大家。

问题是我没有将我的数据表初始化为一个新实例。

数据表详细信息 = null; ===> 数据表详细信息 = 新数据表（）；

并且转换应该在 sql 中而不是在代码中完成。

cmd.Parameters.Add("ID", System.Data.SqlDbType.Int, 4).Value = ID;

string comm = @"select * from dbo.Products where ID = convert(int,@ID)";

# python - 如何正确管理 connectionLost in twisted

> ID：14076897
> 
> 赞同：3
> 
> 时间：2012-12-28T23:05:59.533
> 
> 标签：python, twisted

我编写了以下代码来处理 twisted 中的丢失连接：

```
class Foo(LineReceiver):
    def connectionLost(self, reason):
        if reason.type != ConnectionLost:
            reactor.stop()
    def terminate(self):
        self.transport.loseConnection() 
```

该`terminate`方法由一些输入/输出协议调用。当我用 Ctrl-C 中断我的程序而不是调用该方法时，我必须`reason.type`在该方法中进行测试以避免错误“无法停止正在运行的反应器” 。`connectionLost``terminate`

这段代码有效，但我想知道是否有一种更优雅的方式来管理 twisted 中的连接结束？谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T01:17:32.130

您面临的问题是`control`+`C`正在调用已安装的信号处理程序来停止反应器。反应器在停止时会调用您的`connectionLost`方法，因为关闭反应器会自动关闭所有连接。反过来，您的协议试图停止反应器 - 却发现它已经停止了！

避免这种情况的一种简单（但不完全正确）的方法是[`running`](http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorCore.html#running)在停止之前查看反应器上的属性，如下所示：

```
def connectionLost(self, reason):
    if reactor.running:
        reactor.stop() 
```

[`Failure.check`](http://twistedmatrix.com/documents/current/api/twisted.python.failure.Failure.html#check)（另请注意，您可能不应该以这种方式检查异常类型；如果您确实关心原因的类型，您可能想要使用它，但在大多数情况下，您不应该关心原因的类型；断开的连接只是断开的连接，除非您试图确定其断开的某些非常具体的属性，例如终止是否应该导致 SSL 会话终止。）

如果您想更彻底地检查这一点，您将需要通过[`"before", "shutdown"`系统事件触发器](http://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorCore.html#addSystemEventTrigger)监视反应器的状态，或使用Twisted 12.3 中引入的[`twisted.internet.task.react`API 。](http://twistedmatrix.com/documents/current/api/twisted.internet.task.react.html)

# java - Transferable / URL export：在 Java App 和 Mozilla 之间传输书签数据

> ID：14076899
> 
> 赞同：0
> 
> 时间：2012-12-28T23:06:06.803
> 
> 标签：java, firefox, mozilla, data-transfer, drag-and-drop

我正在编写一个 Java 应用程序，我想集成一个功能来修改来自 Mozilla 的书签数据。这听起来很复杂，但这只是一个拖放问题：

1) 我不能真正从 Mozilla 库中将一个以上的书签条目放到我的 Java 应用程序中，因为没有可用的 DataFlavors。因此，很明显，我无法从我得到的 Transferable 中读取原始数据……单个条目带有 78 个 DataFlavor。有没有办法启用多个书签删除？
我可以通过将所有书签导出到 HTML 并从我的应用程序内部导入来规避这个问题，但这并不是很愉快。

2) 也很难弄清楚如何将任何 URL 导出到 Mozilla 书签。例如，最好的行为是 Mozilla 以与超链接相同的方式识别我的数据。从浏览器内部将链接（例如[Google](http://www.google.com)）放入书签库会立即创建一个名称为“Google”且 URL 为“http://www.google.com”的条目。我的应用程序虽然被迫返回 java.io.Reader 的实现，因为 Mozilla Firefox 库显然不接受任何其他内容。

TL;DR：有什么方法（通过拖放），所以我可以 1）将多个书签从 Mozilla 导入到 Java 应用程序和 2）将任何类型的可传输数据导出到 Mozilla 书签库，以便Firefox 直接识别**名称**和**URL** ?

我希望我的问题很清楚。

提前致以问候和感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:25:58.740

经过多次尝试和错误，我注意到该类型`text/x-moz-url`实际上根本不是文本类型，而是二进制类型。它从来没有与之关联的字符集；它始终是 UTF-16LE。

以下对我有用，至少在 x86 Linux 中，但它根本不适用于 Windows 版本的 Firefox：

```
static class Bookmark
implements Transferable {

    private final String mimeType;
    private final byte[] bytes;

    Bookmark(String uri,
             String name) {
        String text = uri + "\r\n" + name;
        this.bytes = text.getBytes(StandardCharsets.UTF_16LE);
        this.mimeType = "text/x-moz-url";
    }

    public DataFlavor[] getTransferDataFlavors() {
        try {
            return new DataFlavor[] {
                new DataFlavor(mimeType + "; class=java.io.InputStream"),
                new DataFlavor(mimeType + "; class=java.nio.ByteBuffer"),
                new DataFlavor(mimeType + "; class=\"[B\""),
            };
        } catch (ClassNotFoundException e) {
            throw new RuntimeException(e);
        }
    }

    public boolean isDataFlavorSupported(DataFlavor flavor) {
        return flavor.isMimeTypeEqual(mimeType);
    }

    public Object getTransferData(DataFlavor flavor)
    throws IOException,
           UnsupportedFlavorException {

        Class<?> cls = flavor.getRepresentationClass();
        if (cls.equals(byte[].class)) {
            return bytes;
        }
        if (cls.equals(ByteBuffer.class)) {
            return ByteBuffer.wrap(bytes);
        }
        if (cls.equals(InputStream.class)) {
            return new ByteArrayInputStream(bytes);
        }

        throw new UnsupportedFlavorException(flavor);
    }
} 
```

它在 Windows 中不起作用的原因是 Windows 版本的 Firefox 显然不使用`text/x-moz-url`. 当我从 Firefox 中拖动书签并打印出支持的 DataFlavors 时，`text/x-moz-url`它根本不在列表中。仅支持字符串风格（包括`text/html`和`text/uri-list`），以及表示类为 java.net.URL 的风格，除了 之外`text/html`，没有一个可以保存书签的名称，正如我上面提到的，它似乎是 Firefox 可以提供的类型，但是不会接受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T12:35:19.537

截至 2013 年 1 月，在**Windows 7**的当前版本的 Java (7u10) / Firefox (17.0.1) 上，似乎没有办法做我想做的事。

将多个书签拖到 Java 应用程序中没有任何 DataFlavor，因此无法读取它们。
将书签放入 Firefox 似乎也是不可能的 - 仅指定`text/x-moz-url`将使 Firefox “接受”数据，但 Firefox 从不尝试从中读取（从不调用方法）。指定不止一个`text/x-moz-url`（例如`text/x-moz-url; class=java.io.Reader`）会导致 Firefox 根本不接受数据。

除非有人可以提供稳定的解决方案，否则从技术上回答这个问题：

**这是不可能的。**

# windows - 如何将位图图像保存到本地文件夹 Windows Store 应用程序

> ID：14076901
> 
> 赞同：1
> 
> 时间：2012-12-28T23:06:16.950
> 
> 标签：windows, image, c#-4.0, windows-8, windows-store-apps

```
private async void Button_Click2(object sender, RoutedEventArgs e)
    {
        CameraCaptureUI camera = new CameraCaptureUI();
        camera.PhotoSettings.AllowCropping = true;
        camera.PhotoSettings.CroppedAspectRatio = new Size(16, 9);
        StorageFile photo = await camera.CaptureFileAsync(CameraCaptureUIMode.Photo);

        if (photo != null)
        {
            IRandomAccessStream stream = await photo.OpenAsync(FileAccessMode.Read);
            bmp.SetSource(stream);
            imageGrid.Source = bmp;
        }
    }

    private async void saveButton_Click3(object sender, RoutedEventArgs e)
    {

        //Save Image to the file
        //What code goes here?

    } 
```

我在拍照后将图像设置为网格（imageGrid），以便用户查看。完成一些任务后，我希望用户能够按一个按钮来保存图片和文字信息。将文本保存到文件中没有问题，但我似乎找不到任何有关以这种方式保存图像的信息。我不想直接从相机中保存它。我需要让用户能够在命令中保存它。所以我的问题是，如何将捕获的图像作为 XAML 图像设置到 UI 中后保存？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T05:29:45.197

正如 Sandra 已经建议的那样，您需要坚持`CaptureFileAsync`. 该方法已将捕获的图像保存到文件中，并将其作为`StorageFile`. 只需将该引用存储到私有字段并在用户单击后从中复制`Save`：

```
private StorageFile photo;

private async void Button_Click2(object sender, RoutedEventArgs e)
{
    CameraCaptureUI camera = new CameraCaptureUI();
    camera.PhotoSettings.AllowCropping = true;
    camera.PhotoSettings.CroppedAspectRatio = new Size(16, 9);
    photo = await camera.CaptureFileAsync(CameraCaptureUIMode.Photo);

    if (photo != null)
    {
        IRandomAccessStream stream = await photo.OpenAsync(FileAccessMode.Read);
        bmp.SetSource(stream);
        imageGrid.Source = bmp;
    }
}

private async void saveButton_Click3(object sender, RoutedEventArgs e)
{
    if (photo != null)
    {
        await photo.MoveAsync(ApplicationData.Current.LocalFolder, newFilename);
    }
} 
```

# postgresql - plpgsql：检查用户是否在表中插入唯一时间范围的函数

> ID：14076907
> 
> 赞同：0
> 
> 时间：2012-12-28T23:07:04.950
> 
> 标签：postgresql, plpgsql

我在创建 psql 函数时遇到问题，该函数在插入或更新表中的一行之前被称为触发器：“Performance”，它在特定音乐节期间举行音乐表演。

我想要完成的是该函数将检查新的性能 beg_date 和 end_date 是否不会与现有性能发生冲突。限制是在给定的音乐节上一次只能进行一场表演。

表“性能”的结构如下所示：

```
id
beg_date : timestamp
end_date : timestamp
artist_id
music_concert_id 
```

还有 Music_Festivals：

```
id
beg_date : timestamp
end_date : timestamp
name 
```

我的功能如下所示：

```
CREATE OR REPLACE FUNCTION check_valid_performance_date() RETURNS TRIGGER AS $check_date$ 
BEGIN
    IF EXISTS (SELECT * from wystep) THEN
        IF EXISTS (SELECT 1 FROM wystep WHERE beg_date > NEW.beg_date AND beg_date < NEW.end_date AND id_music_festival = NEW.id_music_festival LIMIT 1) THEN
            RAISE EXCEPTION 'exception 1';
        ELSIF EXISTS (SELECT 1 FROM wystep WHERE beg_date < NEW.beg_date AND end_date > NEW.beg_date AND id_music_festival = NEW.id_music_festival LIMIT 1) THEN
            RAISE EXCEPTION 'exception 2 ';
        ELSIF EXISTS (SELECT 1 FROM wystep WHERE beg_date <= NEW.beg_date AND NEW.end_date <= end_date AND id_music_festival = NEW.id_music_festival LIMIT 1) THEN   
            RAISE EXCEPTION 'exception 3 ';
        END IF;   
    END IF;  

    RETURN NEW; 
END
$check_date$ LANGUAGE plpgsql; 
```

我的触发器：

```
CREATE TRIGGER check_valid_performance
AFTER INSERT OR UPDATE OR DELETE ON Performance
FOR EACH ROW EXECUTE PROCEDURE check_valid_performance_date(); 
```

但是即使我从空表开始，我也会得到“异常 3”。这个功能有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:40:56.680

您可以在没有使用[排除约束](http://www.postgresql.org/docs/9.0/static/sql-createtable.html#SQL-CREATETABLE-EXCLUDE "排除约束")和[btree_gist的自定义 psql 触发器的情况下执行此操作](http://www.postgresql.org/docs/current/interactive/btree-gist.html "btree_gist")

这是另一个问题，它可以满足您的大部分需求。

[Postgres 日期重叠约束](https://stackoverflow.com/questions/10616099/postgres-date-overlapping-constraint)

# jquery - 让 Fancybox 工作？

> ID：14076911
> 
> 赞同：-1
> 
> 时间：2012-12-28T23:07:45.930
> 
> 标签：jquery, fancybox

我对使用 JQuery 插件很陌生，我必须承认，我完全不知道自己在做什么。我正在尝试在我的图片库中安装 Fancybox，但单击时图片只是在一个全新的页面中打开，而不是在灯箱视图中。任何帮助是极大的赞赏。

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="styles/styles.css">
  <link rel="stylesheet" href="styles/HTML5CSSReset.css">
  <link rel="shortcut icon" href="images/favicon.ico">

<!-- FancyBox -->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
  <script type="text/javascript" src="fancybox/jquery.fancybox-1.3.4.pack.js"></script>
  <script type="text/javascript" src="fancybox/jquery.mousewheel-3.0.4.pack.js"></script>
  <link rel="stylesheet" href="fancybox/jquery.fancybox-1.3.4.css" type="text/css" media="screen" />
<!-- End -->

  <title>Circle Bar</title>
</head>

<body>
    <div id="ground">
    <div id="container">
    <div id="header">
    </div>
    <div id="nav">
        <ul>
            <li><a href="index.html">Information</a></li>
            <li><a href="calendar.html">Calendar</a></li>
            <li><a href="imageGallery.html">Images</a></li>
            <li><a href="informationContact.html">Contact & Directions</a></li>
        </ul>
    </div>  
    <div id="content" class="sidePage">
        <a id="single_image" href="images/gallery/1.jpg"><img src="images/thumbs/1.jpg" alt=""/></a>
        <a id="single_image" href="images/gallery/2.jpg"><img src="images/thumbs/2.jpg" alt=""/></a>
        <a id="single_image" href="images/gallery/3.jpg"><img src="images/thumbs/3.jpg" alt=""/></a>
        <a id="single_image" href="images/gallery/4.jpg"><img src="images/thumbs/4.jpg" alt=""/></a>
        <a id="single_image" href="images/gallery/5.jpg"><img src="images/thumbs/5.jpg" alt=""/></a>
        <a id="single_image" href="images/gallery/6.jpg"><img src="images/thumbs/6.jpg" alt=""/></a>
    </div>
    </div>
    </div>
    </div>

<!-- FancyBox -->
<script type="text/javascript">
$(document).ready(function() {
    /* This is basic - uses default settings */
    $("a#single_image").fancybox();
    /* Using custom settings */
    $("a#inline").fancybox({
        'hideOnContentClick': true
    });
    /* Apply fancybox to multiple items */
    $("a.group").fancybox({
        'transitionIn'  :   'elastic',
        'transitionOut' :   'elastic',
        'speedIn'       :   600, 
        'speedOut'      :   200, 
        'overlayShow'   :   false
    });
});
</script>
<!-- End -->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:13:59.637

您在所有链接上使用相同的 id.. 这是无效的，并导致问题..

改用一个类

```
<a class="single_image" href="images/gallery/1.jpg"><img src="images/thumbs/1.jpg" alt=""/></a>
<a class="single_image" href="images/gallery/2.jpg"><img src="images/thumbs/2.jpg" alt=""/></a>
<a class="single_image" href="images/gallery/3.jpg"><img src="images/thumbs/3.jpg" alt=""/></a>
<a class="single_image" href="images/gallery/4.jpg"><img src="images/thumbs/4.jpg" alt=""/></a>
<a class="single_image" href="images/gallery/5.jpg"><img src="images/thumbs/5.jpg" alt=""/></a>
<a class="single_image" href="images/gallery/6.jpg"><img src="images/thumbs/6.jpg" alt=""/></a> 
```

并使用

```
$("a.single_image").fancybox(); 
```

* * *

*在旁注中，您为什么使用 v1.4 的 jQuery ？当前版本是 v1.8.3*

# model - 如何计算旋转后附加模型的位置[XNA]？

> ID：14076912
> 
> 赞同：1
> 
> 时间：2012-12-28T23:07:53.620
> 
> 标签：model, xna, rotation, position, game-engine

我正在xna上编写一个基本游戏。我开始在玩家的右臂上放置一个物体（例如武器）。当我将我的角色向前移动到左边或右边时。但是当我旋转时，我的设备没有正确定位。我完全理解有必要根据完成的旋转重新计算新位置，但我不知道如何。这是我的代码和图片一千谢谢

```
 //Function that will draw the current item selection in the player's hand            
private void draw_itemActionInUse(Model modelInUse)
            {

                int handIndex = skinningData.BoneIndices["Hand_Right"];

                Matrix[] worldTransforms = animationPlayer.GetWorldTransforms();

                Matrix rotationMatrixCalcul = Matrix.CreateRotationY(player.Rotation.Y);
//Here I calculate the new position of the item, but it does not work
                Vector3 newPosition= Vector3.Transform(new Vector3(player.Position.X, player.Position.Y + 4, player.Position.Z ), rotationMatrixCalcul);
                foreach (ModelMesh mesh in modelInUse.Meshes)
                {
                    foreach (BasicEffect effect in mesh.Effects)
                    {

                        effect.World =
    worldTransforms[handIndex]
    *
    Matrix.CreateScale(2)
    *
    Matrix.CreateRotationY(player.Rotation.Y)
    *
    Matrix.CreateTranslation(newPosition);

                        effect.View = View_;
                        effect.Projection = Projection_;

                        effect.EnableDefaultLighting();
                    }

                    mesh.Draw();
                }

            } 
```

![位置初始](../Images/a41114238b37585879dc58126ba25432.png)

**图 A**：位置：x:0;y:0;z:0 角度：90 **图 B**：位置：x:2;y:4;z:0 角度：90 ![在此处输入图像描述](../Images/6ec59197a83b04ab229effa8f3543ef6.png) **图 A**：位置：x:1;y:0 ;z:1 角度：35 **图B**：位置：*如何计算这个位置？* 角度：35

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T14:17:07.910

基于[这个 stackoverflow answer](https://stackoverflow.com/questions/13890820/rotating-objects-attached-to-other-objects/13893855#13893855)，附加对象的转换是：

```
Matrix positionRotationMatrix = Matrix.CreateTranslation(-parentPosition) 
                               * Matrix.CreateFromQuaternion(parentRotation) 
                               * Matrix.CreateTranslation(parentPosition);
Vector3 translation = Vector3.Transform(parentPosition + relativePosition,
                               positionRotationMatrix);

Matrix worldMatrix = Matrix.CreateScale(scale)
                * Matrix.CreateFromQuaternion(rotation)
                * Matrix.CreateFromQuaternion(parentRotation)
                * Matrix.CreateTranslation(translation); 
```

变量名称是不言自明的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T07:26:58.103

我你必须从你的枪和它的位置得到旋转。[然后为您的相机创建一个新的位置和旋转。您可以从http://msdn.microsoft.com/en-us/library/bb203909%28v=xnagamestudio.31%29.aspx](http://msdn.microsoft.com/en-us/library/bb203909%28v=xnagamestudio.31%29.aspx)找到一个非常精确和好的答案。附上示例代码。如果项目在运行前要求你注册到XBOX，你直接删除Xbox项目，保留windows项目。

# php - 标题位置无法正常工作

> ID：14076913
> 
> 赞同：3
> 
> 时间：2012-12-28T23:08:00.337
> 
> 标签：php, header

我的 URL 是[http://www.website.ro/index.php?subiect=10046&pag=1](http://www.website.ro/index.php?subiect=10046&pag=1) **#1006**，我在这里有一个没有任何操作的表单（`<form action="" method="post">`）。

提交后，我正在检查一些输入字段，如果有任何错误，我想重定向。我使用这段代码：

```
header('Location: /index.php?subiect='.$_GET['subiect'].'&pag='.$_GET['pag']); exit(); 
```

但是重定向包括**#1006**所以我的页面变成[http://www.website.ro/index.php?subiect=10046&pag=1](http://www.website.ro/index.php?subiect=10046&pag=1) **#1006**

我尝试使用以下方法更改标题中的位置：

```
header('Location: http://www.google.com'); exit(); 
```

带我去的页面是：[http ://www.google.com](http://www.google.com) **#1006**

为什么这样做？

我有`ob_start()`第一行，我试图删除它。没有效果。重定向后的 url 仍然有**#1006**。

如果我的网址是[http://www.website.ro/index.php?subiect=10046&pag=1](http://www.website.ro/index.php?subiect=10046&pag=1)并且我使用标题位置我没有问题，但如果网址包含 #1006 重定向后的网址包含到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:17:13.457

之后的部分`#`称为*片段标识符*并标识页面的一部分，即使该页面是从另一个 URL 检索的。

默认情况下，大多数浏览器会在发生 3xx 重定向时保留片段标识符，无论使用什么状态码。有关此事的一些资源，请参阅[URL 片段和 302 重定向](https://stackoverflow.com/questions/2286402/url-fragment-and-302-redirects)。

您可以返回一个包含片段标识符本身的 URI（甚至是空的）：

```
header('Location: http://www.google.com/#'); 
```

然后将使用那个代替，如[本草案中所述](http://www.w3.org/Protocols/HTTP/Fragment/draft-bos-http-redirect-00.txt)：

> 例外情况是返回的 URI 已经具有片段标识符。在这种情况下，不得不添加原始片段标识符。

`onclick`您还可以使用 Javascript更改片段标识符。

# ios - 尝试安装-iOS6.0.1和air 3.5.0.880

> ID：14076919
> 
> 赞同：1
> 
> 时间：2012-12-28T23:08:34.293
> 
> 标签：ios, ios6, air, flash-cs6

好吧，看看我能不能解释一下

我正在尝试在 iOS6.0.1 设备上安装 flash air 应用程序，我不断收到错误“appID 无法安装”

我正在使用 flash 专业 CS6 修改现有应用程序并使用 Air 3.5.0.880 发布。和 iTunes 安装

* * *

我试过了！

1.  重新注册的设备
2.  重新创建 AppID
3.  已删除设备上的移动配置文件
4.  重新创建的移动配置文件
5.  在设备上重新安装移动配置文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-20T18:57:33.877

也尝试更新证书

如果需要，甚至撤销！

如果你想要一个简短的 .bat 文件（用于 Windows）将 .cer 文件转换为 .p12 文件..回复，我会给你

祝你好运

编辑：

检查您是否使用开发证书和开发移动配置不要使用分发！

# asp.net - ajax调用中的重复标头

> ID：14076921
> 
> 赞同：1
> 
> 时间：2012-12-28T23:08:39.900
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

您好创建了一个链接，该链接执行对控制器的 ajax 调用，以便使用 ID UpdateCart 更新跨度。问题是，如果用户未经过身份验证，他将被发送到登录页面，并在页面上生成：

![在此处输入图像描述](../Images/a766d8167763aa5eba9b4b2e5e5aae94.png)

![在此处输入图像描述](../Images/aecf9101a5eef5d0290724996c7920fd.png)

从图像中可以看出，我的整个标题标签是如何被复制并添加到跨度标签内的。这是我的代码：

```
 @Ajax.ActionLink("Add To Cart" ,
                                 "AddToCart" ,
                                 "Products", 
                                 new {
                                        ProductId = @products.ElementAt(0).Value
                                     },
                                 new AjaxOptions{

                                                   InsertionMode = InsertionMode.Replace,
                                                   UpdateTargetId = "UpdateCart",
                                                   HttpMethod = "GET"
                                                })
public ActionResult AddToCart(string ProductId)
        {
            if( User.Identity.IsAuthenticated ) {
                string username = User.Identity.Name;

                CartHelperClass.AddToCart(ProductId , username);
                ViewBag.ItemsInCart = CartHelperClass.CountItemsInCart(username);

                return PartialView("_AddToCart");
            } else {
                return RedirectToAction("LogIn" , "Account" , new {
                    returnUrl = "Products"
                });
            }     
        } 
```

如何停止创建重复标头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T10:00:58.200

看看[`following blog post`](http://haacked.com/archive/2011/10/04/prevent-forms-authentication-login-page-redirect-when-you-donrsquot-want.aspx)。在这篇文章中，Phil Haack 解释了如何配置表单身份验证模块，以停止针对 AJAX 请求的未经身份验证的用户重定向到登录页面。您可以让它为 AJAX 请求返回一个真正的 401 状态代码给客户端。

然后这个 401 可以很容易地在客户端被拦截并执行任何你想要的操作——比如使用该`window.location.href`方法手动将浏览器重定向到登录页面。

因此，在您的情况下，您只需订阅`ajaxComplete()`处理程序，在此处理程序中，您可以测试响应状态是否为 401，这意味着用户未经过身份验证，您会将他重定向到登录页面。

因此，一旦您安装了 AspNetHaack NuGet ( `Install-Package AspNetHaack`)，您所要做的就是全局订阅[`.ajaxComplete()`](http://api.jquery.com/ajaxComplete/)页面中的处理程序：

```
<script type="text/javascript">
    $(document).ajaxComplete(function (e, xhr, settings) {
        if (xhr.status == 401) {
            alert('Sorry you must be authenticated in order to use this action. You will now be redirected to the LogOn page');
            window.location.href = '@FormsAuthentication.LoginUrl';
        }
    });
</script> 
```

当然，如果您设置了这个，您应该停止从您的 AJAX 控制器操作重定向，因为这没有任何意义。您的控制器操作现在将如下所示：

```
[Authorize]
public ActionResult AddToCart(string productId)
{
    string username = User.Identity.Name;
    CartHelperClass.AddToCart(productId , username);
    ViewBag.ItemsInCart = CartHelperClass.CountItemsInCart(username);
    return PartialView("_AddToCart");
} 
```

TODO：我真的建议您重构此`AddToCart`操作，以便它停止使用 ViewBag，但它将强类型视图模型传递给您的局部视图。

# ruby-on-rails - Rails / Redcarpet：Markdown->带有链接属性的HTML在帮助器中不起作用

> ID：14076922
> 
> 赞同：3
> 
> 时间：2012-12-28T23:08:42.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, redcarpet

我的 ApplicationHelper 中有一个函数，以及一个用于预渲染的控制器中的精确副本。预渲染以我想要的方式创建链接，target="_blank"，但现场渲染不会。我的代码如下：

```
require 'redcarpet'

module ApplicationHelper
  def markdown(text)
    rndr = Redcarpet::Render::HTML.new(:link_attributes => Hash["target" => "_blank"])
    markdown = Redcarpet::Markdown.new(
                rndr,
                :autolink => true,
                :space_after_headers => true
              )
    return markdown.render(text).html_safe
  end
end 
```

在 rails 控制台中运行它也会正常呈现链接，但没有链接属性。我的控制器中的相同代码按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-23T01:02:39.190

我使用自定义降价生成器（redcarpet v 3.1.2）让它工作

```
lib/my_custom_markdown_class.rb
class MyCustomMarkdownClass < Redcarpet::Render::HTML
  def initialize(extensions = {})
    super extensions.merge(link_attributes: { target: "_blank" })
  end
end 
```

然后像这样使用它

```
app/helpers/application_helper.rb
def helper_method(text)
  filter_attributes = {
      no_links:    true,
      no_styles:   true,
      no_images:   true,
      filter_html: true
    }

  markdown = Redcarpet::Markdown.new(MyCustomMarkdownClass, filter_attributes)
  markdown.render(text).html_safe
end 
```

或者，您可以将此 helper_method 放入模型中，并将 filter_attributes 设置为类变量。

# javascript - 具有绝对路径的 Grunt/Yeoman 连接 javascript 文件

> ID：14076927
> 
> 赞同：5
> 
> 时间：2012-12-28T23:09:44.053
> 
> 标签：javascript, gruntjs, yeoman

当 javascript 文件 src 路径以“/”开头时，我在使用 Gruntfile.js 时遇到问题。

我遵循这个用例[http://briantford.com/blog/angular-yeoman.html](http://briantford.com/blog/angular-yeoman.html)

默认情况下，JS 文件包含为

```
<!-- build:js scripts/scripts.js -->
        <script src="scripts/app.js"></script>
        <script src="scripts/controllers/main.js"></script>
        <!-- endbuild -->

$ ls dist/scripts/
ab541b7e.app.js     afa864c8.scripts.js controllers         vendor
$ cat dist/scripts/afa864c8.scripts.js 
"use strict";var ...
.... 
```

App Engine 应用程序配置[需要](https://developers.google.com/appengine/docs/python/gettingstarted/staticfiles)使用“/”前缀。

```
<!-- build:js scripts/scripts.js -->
        <script src="/scripts/app.js"></script>
        <script src="/scripts/controllers/main.js"></script>
        <!-- endbuild -->

Build results in the concatenated file,
$ ls dist/scripts/
9eecb7db.scripts.js ab541b7e.app.js     controllers         vendor
$ cat dist/scripts/9eecb7db.scripts.js 
```

但是，那么连接的脚本文件是空的。

完整的 Gruntfile 如下，未修改。

```
module.exports = function( grunt ) {
  'use strict';
  //
  // Grunt configuration:
  //
  // https://github.com/cowboy/grunt/blob/master/docs/getting_started.md
  //
  grunt.initConfig({

    // Project configuration
    // ---------------------

    // specify an alternate install location for Bower
    bower: {
      dir: 'app/components'
    },

    // Coffee to JS compilation
    coffee: {
      compile: {
        files: {
          'app/scripts/*.js': 'app/scripts/**/*.coffee',
          'test/spec/*.js': 'test/spec/**/*.coffee'
        }
      }
    },

    // compile .scss/.sass to .css using Compass
    compass: {
      dist: {
        // http://compass-style.org/help/tutorials/configuration-reference/#configuration-properties
        options: {
          css_dir: 'temp/styles',
          sass_dir: 'app/styles',
          images_dir: 'app/images',
          javascripts_dir: 'temp/scripts',
          force: true
        }
      }
    },

    // generate application cache manifest
    manifest:{
      dest: ''
    },

    // default watch configuration
    watch: {
      coffee: {
        files: 'app/scripts/**/*.coffee',
        tasks: 'coffee reload'
      },
      compass: {
        files: [
          'app/styles/**/*.{scss,sass}'
        ],
        tasks: 'compass reload'
      },
      reload: {
        files: [
          'app/*.html',
          'app/styles/**/*.css',
          'app/scripts/**/*.js',
          'app/views/**/*.html',
          'app/images/**/*'
        ],
        tasks: 'reload'
      }
    },

    // default lint configuration, change this to match your setup:
    // https://github.com/cowboy/grunt/blob/master/docs/task_lint.md#lint-built-in-task
    lint: {
      files: [
        'Gruntfile.js',
        'app/scripts/**/*.js',
        'spec/**/*.js'
      ]
    },

    // specifying JSHint options and globals
    // https://github.com/cowboy/grunt/blob/master/docs/task_lint.md#specifying-jshint-options-and-globals
    jshint: {
      options: {
        curly: true,
        eqeqeq: true,
        immed: true,
        latedef: true,
        newcap: true,
        noarg: true,
        sub: true,
        undef: true,
        boss: true,
        eqnull: true,
        browser: true
      },
      globals: {
        angular: true
      }
    },

    // Build configuration
    // -------------------

    // the staging directory used during the process
    staging: 'temp',
    // final build output
    output: 'dist',

    mkdirs: {
      staging: 'app/'
    },

    // Below, all paths are relative to the staging directory, which is a copy
    // of the app/ directory. Any .gitignore, .ignore and .buildignore file
    // that might appear in the app/ tree are used to ignore these values
    // during the copy process.

    // concat css/**/*.css files, inline @import, output a single minified css
    css: {
      'styles/main.css': ['styles/**/*.css']
    },

    // renames JS/CSS to prepend a hash of their contents for easier
    // versioning
    rev: {
      js: 'scripts/**/*.js',
      css: 'styles/**/*.css',
      img: 'images/**'
    },

    // usemin handler should point to the file containing
    // the usemin blocks to be parsed
    'usemin-handler': {
      html: 'index.html'
    },

    // update references in HTML/CSS to revved files
    usemin: {
      html: ['**/*.html'],
      css: ['**/*.css']
    },

    // HTML minification
    html: {
      files: ['**/*.html']
    },

    // Optimizes JPGs and PNGs (with jpegtran & optipng)
    img: {
      dist: '<config:rev.img>'
    },

    // rjs configuration. You don't necessarily need to specify the typical
    // `path` configuration, the rjs task will parse these values from your
    // main module, using http://requirejs.org/docs/optimization.html#mainConfigFile
    //
    // name / out / mainConfig file should be used. You can let it blank if
    // you're using usemin-handler to parse rjs config from markup (default
    // setup)
    rjs: {
      // no minification, is done by the min task
      optimize: 'none',
      baseUrl: './scripts',
      wrap: true
    }
  });

  // Alias the `test` task to run `testacular` instead
  grunt.registerTask('test', 'run the testacular test driver', function () {
    var done = this.async();
    require('child_process').exec('testacular start --single-run', function (err, stdout) {
      grunt.log.write(stdout);
      done(err);
    });
  });
}; 
```

## 编辑：

做一些研究会导致下面的 repo，yeoman 用它来替换标记。 [https://github.com/yeoman/grunt-usemin](https://github.com/yeoman/grunt-usemin)

仍然需要弄清楚，添加前导“/”有什么问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T12:40:54.997

实际上，应该支持您的用例。但是，请注意：

*   在当前的 0.9.6 版本的 yeoman 上，我不确定它是否有效
*   yeoman 目前正在进行大量的返工，很快就会使用 grunt-usemin。你的用例应该得到 grunt-usemin 的支持

# jquery - jquery.post 在 wordpress 插件中，目录问题

> ID：14076928
> 
> 赞同：2
> 
> 时间：2012-12-28T23:10:12.407
> 
> 标签：jquery, wordpress

我有一些 jQuery 发布代码，当我尝试运行它时会抛出未找到的错误。我正在尝试将它作为我的 wordpress 插件的一部分运行，我知道这些文件位于同一目录中，但拼写正确。我尝试直接从 url 访问该文件并将该 url 添加到插件中，但随后出现错误 500。

根据我所做的研究，我认为我必须做一些事情才能在我的插件中添加这个文件，我认为这与它不在 wordpress 框架中有关，但我找不到任何解决我的问题的方法。

```
jQuery.post("getResults.php", {id:id} , function(data)
        {
            jQuery("select#kDate").removeAttr("disabled");
            jQuery("select#kDate").html(data);
        })
        .success(function() { alert("second success"); })
        .error(function(xhr, status, detail) { alert("error ("+status+") : " + detail); })
     }); 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T11:58:47.393

如果您收到错误 500 内部服务器错误，则此代码通过使用文件的完整 url 起作用，请尝试更改您的权限，因为这对我有用。此代码适用于 wordpress。

```
jQuery.post("<?php echo plugins_url("/race-results/getResults.php"); ?>", {id:id} , function(data)
        {
            jQuery("select#kDate").removeAttr("disabled");
            jQuery("select#kDate").html(data);
        })
        .success(function() { alert("success"); })
        .error(function(xhr, status, detail) { alert("error ("+status+") : " + detail); })
     }); 
```

# php - php图片上传脚本

> ID：14076929
> 
> 赞同：1
> 
> 时间：2012-12-28T23:10:17.193
> 
> 标签：php, upload

嗨，感谢教程和自己的想法，我写了这段代码

```
if(isset($_POST['upload'])) {

$allowed_filetypes = array('.jpg','.jpeg','.png','.gif');
$max_filesize = 10485760;
$upload_path = 'uploads/';
$description = $_POST['imgdesc'];

$filename = $_FILES['userfile']['name'];
$ext = substr($filename, strpos($filename,'.'), strlen($filename)-1);

if(!in_array($ext,$allowed_filetypes))
  die('The file you attempted to upload is not allowed.');

if(filesize($_FILES['userfile']['tmp_name']) > $max_filesize)
  die('The file you attempted to upload is too large.');

if(!is_writable($upload_path))
  die('You cannot upload to the specified directory, please CHMOD it to 777.');

if(move_uploaded_file($_FILES['userfile']['tmp_name'],$upload_path . $filename)) {
   $query = "INSERT INTO uploads (name, description) VALUES ($filename, $description)"; 
   mysql_query($query);

echo 'Your file upload was successful!';

} else {
     echo 'There was an error during the file upload.  Please try again.';
}
} 
```

我收到此错误；

> 注意：未定义索引：第 16 行 C:\WebServer\htdocs\PicSide\admin\addimage.php 中的用户文件

有谁知道怎么解决？上传服务器是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T23:14:45.980

基本上，您的错误意味着您的表单中没有以下（或有些相似）元素：

```
<input type="file" name="userfile" /> 
```

其中重要的部分是`name="userfile"`指定`$_FILES`数组中键的实际值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-21T00:56:35.737

并且不要忘记连接：

```
$query = "INSERT INTO uploads (name, description) VALUES ($filename, $description)"; 
```

应该：

```
$query = "INSERT INTO uploads (name, description) VALUES (".$filename.", ".$description.")"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-11T06:49:52.013

```
<form>
<input type="file" name="userfile" />
</form>

$allowed_filetypes = array('.jpg','.jpeg','.png','.gif');
$max_filesize = 10485760;
$upload_path = 'uploads/';
$description = $_POST['imgdesc'];
$filename = $_FILES['userfile']['name'];
if(move_uploaded_file($_FILES['userfile']['tmp_name'],$upload_path . $filename)) {
   $query = "INSERT INTO uploads (name, description) VALUES ($filename, $description)"; 
   mysql_query($query);

echo 'Your file upload was successful!';

} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-01-24T05:37:53.557

```
<?php
error_reporting(0);
?> 
```

# ember.js - Ember - 从一种状态切换到另一种的嵌套状态

> ID：14076930
> 
> 赞同：2
> 
> 时间：2012-12-28T23:10:22.147
> 
> 标签：ember.js, nested, ember-old-router

我有以下代码。（我只是复制路由器，因为该应用程序目前大约有 500 行）我需要的是从状态“房间”切换到“guests.new”。

当我进入房间状态时，它会加载一个模板，我在其中调用操作“newGuest”以将状态更改为“newGuest”屏幕。但我无法让它工作。在萤火虫我得到这个错误：

```
g[a] is undefined 
```

这是路由器代码。希望您能够帮助我。

```
App.Router = Ember.Router.extend({
        enableLogging:true,
        location:'hash',
        gotoRooms:Ember.Route.transitionTo('rooms.index'),
        gotoGuests:Ember.Route.transitionTo('guests.index'),
        gotoBookings:Ember.Route.transitionTo('bookings'),
        gotoHome:Ember.Route.transitionTo('root.index'),

        root:Ember.Route.extend({
            index:Ember.Route.extend({
                route:'/',
                connectOutlets:function (router) {
                    App.HomeView.appendTo('#main-content .container_12');
                },
                enter: function(){
                    console.log('Entro Home');
                },
                exit: function(){
                    App.HomeView.remove();
                }
            }),
            guests:Ember.Route.extend({
                route:'/guests',
                index:Ember.Route.extend({
                    route:'/',
                    connectOutlets:function(router) {
                        App.GuestsView.appendTo('#main-content .container_12');    
                    },
                    enter: function(){
                        console.log("Entro Guests");
                    },
                    exit: function(){
                        App.GuestsView.remove();
                    },
                }),
                new:Ember.Route.extend({
                    route:'/new/:bed',
                    deserialize: function(manager, params) {
                        console.log('New Guest \nBed:'+params['bed']+"\n Date:"+params['date']);
                        App.GuestView.appendTo('#main-content .container_12');
                    },
                    connectOutlets:function(){
                        alert("hola");
                    },
                    exit: function(){
                        App.GuestsView.newGuestView.remove();
                    }
                })
            }),
            rooms:Ember.Route.extend({
                newGuest:Ember.Route.transitionTo('guests.new'),
                route:'/rooms',
                index:Ember.Route.extend({
                    route:'/',                    
                    connectOutlets:function(router) {
                        App.RoomsView.appendTo('#main-content .container_12');    
                    },
                    enter: function(){
                        console.log("Entro Rooms");
                    },
                    exit: function(){
                        App.RoomsView.remove();
                    }
                })
            })
        })
    }); 
```

谢谢@Akash，但它仍然无法正常工作。我正在使用 ember-1.0.pre。调用“newGuest”的模板如下：

```
 <script type="text/x-handlebars" data-template-name="rooms">
      {{#each room in App.Rooms}}
        <div class="grid_4">
      <div class="block-border">
        <div class="block-header">
          <h1>{{room.screen}}</h1><span></span>
        </div>
        <div class="block-content">
          <ul class="block-list">
          {{#each bed in room.camas}}
            {{#if bed.guestId}}
            <li {{action "viewGuest" on="click"}} class="occupied">{{bed.id_guest}}</li>
            {{else}}
            <li class="free" {{action "newGuest" on="click"}}>Free Bed</li>
            {{/if}}
          {{/each}}
          </ul>
        </div>
      </div>
    </div>
      {{/each}}
    </script> 
```

我也尝试过使用 ember-latest，因为我在各种线程中读到了预版本给出了一些路由问题。现在事实证明，使用 ember-latest，我无法定义计算属性。至少这是加载页面时控制台上弹出的内容。

有什么线索吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T08:37:43.300

问题是 Ember 无法`guests`从路线内访问`rooms`路线。所以你需要做的就是将动作函数移到树的下方。我在下面稍微调整了您的代码：

**调整代码：**

```
App.Router = Ember.Router.extend({
        enableLogging:true,
        location:'hash',
        gotoRooms:Ember.Route.transitionTo('rooms.index'),
        gotoGuests:Ember.Route.transitionTo('guests.index'),
        gotoBookings:Ember.Route.transitionTo('bookings'),
        gotoHome:Ember.Route.transitionTo('root.index'),

        root:Ember.Route.extend({
            newGuest:Ember.Route.transitionTo('guests.new'),
            index:Ember.Route.extend({
                route:'/',
                connectOutlets:function (router) {
                    App.HomeView.appendTo('#main-content .container_12');
                },
                enter: function(){
                    console.log('Entro Home');
                },
                exit: function(){
                    App.HomeView.remove();
                }
            }),
            guests:Ember.Route.extend({
                route:'/guests',
                index:Ember.Route.extend({
                    route:'/',
                    connectOutlets:function(router) {
                        App.GuestsView.appendTo('#main-content .container_12');    
                    },
                    enter: function(){
                        console.log("Entro Guests");
                    },
                    exit: function(){
                        App.GuestsView.remove();
                    },
                }),
                new:Ember.Route.extend({
                    route:'/new/:bed',
                    deserialize: function(manager, params) {
                        console.log('New Guest \nBed:'+params['bed']+"\n Date:"+params['date']);
                        App.GuestView.appendTo('#main-content .container_12');
                    },
                    connectOutlets:function(){
                        alert("hola");
                    },
                    exit: function(){
                        App.GuestsView.newGuestView.remove();
                    }
                })
            }),
            rooms:Ember.Route.extend({
                route:'/rooms',
                index:Ember.Route.extend({
                    route:'/',                    
                    connectOutlets:function(router) {
                        App.RoomsView.appendTo('#main-content .container_12');    
                    },
                    enter: function(){
                        console.log("Entro Rooms");
                    },
                    exit: function(){
                        App.RoomsView.remove();
                    }
                })
            })
        })
    }); 
```

# c# - IIS 7.5 Windows 2008 R2 远程提供 500，本地自定义 404

> ID：14076931
> 
> 赞同：2
> 
> 时间：2012-12-28T23:10:24.567
> 
> 标签：c#, asp.net-mvc-4, iis-7.5, custom-error-pages

我创建了以下基本控制器以在 InvalidOperationException 上显示自定义 404（例如，未找到视图）。

```
public class HandlesViewNotFoundController : Controller
{
    protected override void OnException(ExceptionContext filterContext)
    {
        //InvalidOperationException is thrown if the path to the view
        // cannot be resolved by the viewengine
        if (filterContext.Exception is InvalidOperationException)
        {
            if (!filterContext.ExceptionHandled)
            {
                filterContext.ExceptionHandled = true;
                filterContext.Result = new ViewResult { ViewName = "_404" };
                filterContext.HttpContext.Response.StatusCode = 404;
                Response.Clear();

                // Clear the error on server.
                Server.ClearError();

                // Avoid IIS7 getting in the middle
                Response.TrySkipIisCustomErrors = true;
            }
        }
        base.OnException(filterContext);
    }
} 
```

出于某种原因，当我打开一个会触发 404 的页面时，它在本地调试时完美运行，在服务器上查看页面时在本地运行，但如果我查看远程服务器上检查的相同 url，内部服务器返回错误 (500)。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:32:22.530

检查是否在 web.config（和部署的转换）中正确配置了 customeErrors 属性，并注释掉全局过滤器 HandleError。

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    //filters.Add(new HandleErrorAttribute());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:22:48.323

可能您忘记将视图文件 _404 部署到服务器。

# cakephp - 如何允许 CakePHP 根据身份验证/登录状态返回不同的主页？

> ID：14076932
> 
> 赞同：1
> 
> 时间：2012-12-28T23:10:45.697
> 
> 标签：cakephp, authentication, routing

我正在寻找根据用户当前是否登录来返回应用程序主页的最佳方式。

似乎`beforeFilter`'s 的`allow()`功能可以对此有所帮助，但看起来该功能确实会重定向用户。

相反，如果用户登录，我更喜欢特定的控制器（例如，显示用户模型的“主页”视图）显示，但为未登录的用户返回静态主页。不需要任何重定向，因为它们将使用相同的 URL 请求显示。

有这样做的标准方法吗？我还推断，也许我可以`routes.php`使用条件进行修改，但**AuthComponent**在请求的这个阶段不可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T00:33:28.667

你有一个指向你的控制器动作的路由，比如说OverviewController：

```
Router::connect('/', array('controller' => 'overview', 'action' => 'homepage')); 
```

然后你动态切换这个动作：

```
if (!($uid = $this->Session->read('Auth.User.id'))) {
    return $this->render('some_action');
    //or return $this->render('/Pages/some_static_page');
}
// normal homepage action for $uid xyz 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T23:42:52.513

使用 AuthComponent 意味着您无需担心`login()`UsersController 中的操作（我相信这是默认设置）。但是，如果您在该方法中放入一些代码，您可以让它做任何您想做的事情：

```
// In users_controller.php
function login()
{   
  if ( $this->Auth->user() ) { 
    if ( $this->Auth->user('role') == USER_ROLE_ADMIN ) { 
      $this->redirect('/admin');
    } else {
      $this->redirect('/');
    }   
  }   
} 
```

请注意检查用户角色并适当重定向的行。同样重要的是最外面的 if 语句 ( `if ( $this->Auth->user() )`)，如果用户成功登录，它只会执行里面的代码。

# apache-camel - 使用 Apache Camel 同步两个表

> ID：14076938
> 
> 赞同：0
> 
> 时间：2012-12-28T23:11:33.590
> 
> 标签：apache-camel

我刚开始使用 Apache Camel，我想尝试同步两个表。两个表都有两列，“id”和“name”。该方案将查询第一个表，检查第二个表中的每条记录是否存在，并插入每条不存在的记录。这是我的尝试：

```
<camel:camelContext id="test">
    <camel:route>
        <camel:from uri="timer://kickoff?period=5s"/>
        <camel:to uri="sql:select id, name from table1?dataSourceRef=dataSource"/>
        <camel:split>
            <camel:simple>body</camel:simple>
            <camel:to uri="sql:select * from table2 where id = #?dataSourceRef=dataSource" />
            <camel:choice>
                <camel:when>
                    <camel:simple>${header.CamelSqlRowCount} == 0</camel:simple>
                    <camel:to uri="sql:insert into table2 (id, name) values (#, #)?dataSourceRef=dataSource" />
                </camel:when>
            </camel:choice>
            <camel:to uri="mock:result" />
        </camel:split>
    </camel:route>
</camel:camelContext> 
```

这里的问题是，当我到达`insert into table2`时，原始消息（包含数据的消息）丢失了，因为我必须同时进行另一个查询（我在第二个表中检查数据）。我的方法好吗？如何检索包含数据的消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T09:02:31.410

当您调用第二条 SQL 进行检查时，您可以使用内容丰富器 EIP 将本次调用的结果与原始消息“合并”。在您的情况下，您只需要知道是否有一行，并将其存储在标题中。

内容丰富器 eip 记录在此处：[http://camel.apache.org/content-enricher.html](http://camel.apache.org/content-enricher.html)，例如参见丰富。

需要注意的是，您需要使用 java 代码并实现一个 AggregationStrategy 来实现“合并”逻辑。

您也可以按照 Ben 的建议将第一个数据存储在标头（或交易所的属性）中，以后可以访问。

尽管从 EIP 的角度来看，它是最能涵盖此用例的内容丰富 EIP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T06:18:37.230

您需要将第一个查询的结果保留在标题字段中，以便在为第二个查询设置正文时不会丢失

```
<header name="myresults"><simply>$body</simple></header> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T19:42:53.957

您还可以避免该问题并使用某种特定于数据库的语句来进行插入。

例如，对于 mysql，您可以执行类似的操作

```
INSERT IGNORE table2 (id, name) values (#, #) 
```

我确信其他数据库引擎也有类似的东西。它为您节省了一些对数据库的查询。

# c# - 尝试将元素添加到列表时引发“System.OutOfMemoryException”类型的异常

> ID：14076939
> 
> 赞同：0
> 
> 时间：2012-12-28T23:11:52.977
> 
> 标签：c#, out-of-memory

编辑：感谢各位的帮助，我刚刚意识到我的错误是把 number = (40 / i) 放在了应该是 number = (number / i) 的地方......由于某种原因，我脑子里有数字 40。

第一个循环中缺少的“i++”也是我在尝试修复代码时意外删除它：P

原来的：

我做了一个方法，它以整数列表的形式返回素数的素数。但是，当我尝试用元素填充列表时，出现错误。为什么？

```
static List<int> PrimeFactors(int number)
        {
            bool prime = false;
            List<int> primeFactors = new List<int>();
            for (int i = 2; i < number; )
            {
                if (number % i == 0)
                {
                    prime = true;
                    break;
                }
            }

            if (prime)
            {
                for (int i = 2; i < number; i++)
                {
                    if (number % i == 0)
                    {
                        primeFactors.Add(i); // <--- Error at this line.
                        number = (40 / i);
                        i = 1;
                    }
                }
                primeFactors.Add(number);
            }
            return primeFactors;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:15:01.190

在第一个循环中，您没有迭代`i`，因此除非`number % 2 == 0`，它将无限循环。

在第二个循环中，您正在重置`i = 1`然后循环。因此，如果`number % 2 == 0`，它将继续将项目添加到列表中，直到您耗尽内存为止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T23:16:24.713

您收到该错误是因为您的第二个 for 循环是无止境的，因此您不断添加到您的 List 并且在某个时刻您没有足够的内存来保存它。由于 i = 1; 循环是无限的。陈述。

另请注意，您在第一个循环中还有另一个问题，您在 for 语句的末尾缺少 i++ 语句。

# delphi - 使用内存中的密钥进行 OpenSSL RSA 签名

> ID：14076944
> 
> 赞同：1
> 
> 时间：2012-12-28T23:12:41.573
> 
> 标签：delphi, openssl

我正在为 Delphi 试验 OpenSSL，您可以在[此处](http://www.disi.unige.it/person/FerranteM/delphiopenssl/index.html)找到一个单元。到目前为止，我能够生成公钥/私钥。我要做的是签署一个字符串，然后检查该字符串是否用公钥签名。

所以..这是我到目前为止所拥有的。问题是**EVP_SignFinal**导致访问冲突，因为**EVP_PKEY_assign**总是返回 pKey = nil 所以我猜密钥不是从内存中分配的，我该如何分配它。

附言。您必须原谅代码只是一个测试；）

有人能指出我错在哪里吗？

```
var
  rsa : pRSA;
  eu : string;
  privateKey,publicKey,Err : pBIO;
  enc : pEVP_CIPHER;
  keylen : Cardinal;
  prv,pub : PChar;
  hash : TMD5Digest;
  mdctx : EVP_MD_CTX;
  pkey : pEVP_PKEY;
  lbuf : array [0..15] of Byte;
  i : Integer;
begin
  ERR_load_crypto_strings;
  OpenSSL_add_all_algorithms;
  OpenSSL_add_all_ciphers;
  OpenSSL_add_all_digests;
  eu := 'SIGN THIS';
  enc := EVP_des_ede3_cbc;

  rsa := RSA_generate_key(1024,RSA_F4,nil,Err);
  if rsa <> nil then
  begin
  privateKey := BIO_new(BIO_s_mem);
  PEM_write_bio_RSAPrivateKey(privateKey,rsa,enc,nil,0,nil,PChar('0PC0DE'));
  publicKey := BIO_new(BIO_s_mem);
  PEM_write_bio_RSAPublicKey(publicKey,rsa);
  keylen := BIO_pending(privateKey);
  GetMem(prv,keylen + 1);
  BIO_read(privateKey,prv,keylen);
  keylen := BIO_pending(publicKey);
  GetMem(pub,keylen + 1);
  BIO_read(publicKey,pub,keylen);
  Writeln(prv);
  Writeln('Keys generated!');
  pKey := nil;
  EVP_PKEY_assign(pkey,EVP_PKEY_RSA,pub);
  EVP_MD_CTX_init(@mdctx);
  EVP_SignInit(@mdctx,EVP_md5());
  EVP_SignUpdate(@mdctx,PChar(eu),Length(eu));
  EVP_SignFinal(@mdctx,@lbuf,keylen,pkey);
  EVP_MD_CTX_cleanup(@mdctx);
  WriteLn(keylen);

  Readln;
  end;
end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:22:00.330

我认为错误在于您尝试使用公钥而不是私钥进行签名。您总是使用公钥进行加密（和私钥进行解密）和私钥进行签名（因此公钥进行验证）。

此外，在我看来，最好使用`PEM_read_bio_RSAPrivateKey`而不是`EVP_PKEY_assign`，因为它似乎与`PEM_write_bio_RSAPrivateKey`. `EVP_PKEY_assign`似乎是一个不推荐使用的调用，并且不太可能处理 PEM 编码。

# sql - 获取 n 条随机记录，其中 n 存储在表中

> ID：14076946
> 
> 赞同：2
> 
> 时间：2012-12-28T23:13:01.963
> 
> 标签：sql, random, sample, teradata

> **可能重复：**
> [如何在 SQL 中随机选择行？](https://stackoverflow.com/questions/580639/how-to-randomly-select-rows-in-sql)

假设——在 Teradata 12 中——我有一个包含 Transaction_ID 和 Store_nbr 的表 TXN。还假设我有一个包含 Store_nbr 和 n_samples 的表 SAMP。

假设我想从 TXN 中抽取 n_samples Transaction_ID 的样本。即，我希望 SAMP 表能够驱动从 TXN 表中获取多少 transaction_id 样本。例如，

```
TXN
Transaction_ID Store_nbr
1              1
2              1
1              2
2              2
3              2 
```

...和...

```
SAMP
store_nbr n_samples
1         2
2         2
3         1 
```

那么我如何告诉 SQL（这是 Teradata，顺便说一句）：给我 2 个用于存储 1 的 transaction_Id 样本，2 个用于存储 2 的 transaction_Id 样本，以及 1 个用于存储 3 的 transaction_Id 样本？

Teradata 确实有条件样本概念：

```
select a,b
from foo
sample when a=1 then 5
       when a=2 then 10
       when a=3 then 7
end 
```

...如果需要，我可以使用 codegen 方法创建（有数千家商店）。

SAMP 表可以随时自由更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:26:26.743

您可以使用`row_number`and执行此操作`random()`：

```
select t.*
from (select t.*,
             row_number() over (partition by store_nbr
                                order by random(1,100000)) as seqnum
      from txn t
     ) t join
     samp s
     on t.store_nbr = s.store_nbr and
        t.seqnum <= s.n_samples 
```

我不知道`sample`用于完成此操作的简单语法。

出于好奇，这会被允许吗？

```
select t.*
from (select t.*,
             row_number() over (partition by store_nbr
                                order by rnd) as seqnum
      from (select t.*, random(1,100000) as rnd from txn t) t
     ) t join
     samp s
     on t.store_nbr = s.store_nbr and
        t.seqnum <= s.n_samples 
```

# c# - 一个不错的 ajax 自动完成扩展器的 css 样式

> ID：14076947
> 
> 赞同：1
> 
> 时间：2012-12-28T23:13:04.617
> 
> 标签：c#, asp.net, autocompleteextender

我真的很想继续使用我当前通过 完成的自动完成实现`ajax toolkit`，因为通过 C# 实现它相对容易。

我可以看到 jQuery 自动完成有很多样式主题，比如下面的链接（圆角、精心设计的样式等）

*   [链接1](http://www.andymatthews.net/code/autocomplete/)
*   [链接2](http://www.jensbits.com/demos/autocomplete/)

**我怎么能在 上设置这样的 CssStyle `AjaxToolKit AutoComplete Extender`？**

如果有人知道如何简单地做到这一点，或者有一个很好的风格可以使用，甚至是一个链接，我将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:21:16.717

尝试搜索中的第一个链接，您将获得有关如何设置样式的精彩教程

```
AjaxToolKit AutoComplete Extender 
```

[http://vijaysinghnegi.blogspot.com/2012/04/best-css-style-for-autocomplete.html](http://vijaysinghnegi.blogspot.com/2012/04/best-css-style-for-autocomplete.html)

jquery 之所以看起来如此时尚，是因为它们为它提供了默认样式

但是 `AjaxToolKit AutoComplete Extender`你必须使用 CSS 让它看起来像你想要的那样

```
<style type="text/css">
    /*AutoComplete flyout */
    .completionList {
        border: solid 1px #444444;
        margin: 0px;
        padding: 2px;
        height: 100px;
        overflow: auto;
        background-color: #FFFFFF;
    }

    .listItem {
        color: #1C1C1C;
    }

    .itemHighlighted {
        background-color: #ffc0c0;
    }
</style>

 CompletionListCssClass="completionList"
 CompletionListHighlightedItemCssClass="itemHighlighted"
 CompletionListItemCssClass="listItem" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-22T22:06:58.347

我创建了一个[Meteor 自动完成扩展器](https://github.com/mizzao/meteor-autocomplete)，它允许自由文本和多个自动完成源。Meteor 的数据模型允许使用自定义渲染列表进行快速多规则搜索。

我使用了[jquery-sew](https://github.com/tactivos/jquery-sew)的 CSS 样式。在此处查看他们的[演示](http://jquery-sew.s3-website-us-east-1.amazonaws.com/)或在[此处查看 CSS](http://jquery-sew.s3-website-us-east-1.amazonaws.com/demo.css)。

# java - JPanel JFrame 独立类

> ID：14076954
> 
> 赞同：0
> 
> 时间：2012-12-28T23:14:15.650
> 
> 标签：java, swing, jframe, jpanel

`JFrames`我是一名 Java 初学者，刚开始为我的程序制作 GUI ，我被困在`JPanels`. 我的目标是做一个`JFrame`有几个`JPanels`的，每个`JPanel`都有自己的类。

我已经开始了，但我似乎无法让它发挥作用。我的代码如下：

这是 JFrame 类：

```
import javax.swing.*;
import java.awt.*;

public class TestFrame extends JFrame{

    private static final long serialVersionUID = 1L;
    private JFrame f;

    public TestFrame(){
        f = new JFrame("Test");
        f.setVisible(true);
        f.setSize(600, 400);
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JPanel p = new TestPanel();
        p.setVisible(true);
        f.add(p);
    }

    public static void main(String[] args){
        new TestFrame();
    }
} 
```

这是 JPanel 类：

```
import javax.swing.*;
import java.awt.*;

public class TestPanel extends JPanel {

    private static final long serialVersionUID = 1L;
    private JButton b;
    private JTextField t;

    public TestPanel(){
        b = new JButton("bla");
        t = new JTextField("blaadda");
        add(b);
        add(t);
        setVisible(true);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T23:24:59.847

您的构造函数不应创建新的 JFrame。您的类 ( `TestFrame`) 将用于创建窗口，而不是 JFrame 类。您可能还有其他错误，但最明显的错误是

```
public TestFrame(){
    f = new JFrame("Test");
    f.setVisible(true);
    f.setSize(600, 400);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    JPanel p = new TestPanel();
    p.setVisible(true);
    f.add(p);
} 
```

应该

```
public TestFrame(){
    //Don't create a new JFrame, you're already creating a TestFrame!
    //call all methods on the TestFrame, not the JFrame
    setVisible(true);
    setSize(600, 400);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    JPanel p = new TestPanel();
    p.setVisible(true);
    add(p);
} 
```

您的 TestPanel 构造函数看起来不错。但是，我建议在您的 TestFrame 字段中创建任何面板，而不是在构造函数中创建临时变量。

然后像这样创建你的窗口：

```
 SwingUtilities.invokeLater(new Runnable()
  {
      public void run()
      {
          new TestFrame();
      }
  } 
```

最后，如果所有其他方法都失败，请尝试调用`setEnabled(true)`您的构造函数。

希望这对我有所帮助，我已经离开 Swing 转而使用 OpenGL，但我记得它是多么令人沮丧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T22:24:04.180

```
f.add(p);
p.repaint();
p.revalidate(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T23:18:18.520

您应该`setVisible`在构造函数中使用最后一个方法`TestFrame`：

```
f.setVisible(true); 
```

也没有必要对你的调用进行调用，`JPanel`因为当框架本身变得可见时，它的所有子组件都会变得可见：

```
p.setVisible(true); 
```

所以这条线可以被删除。

* * *

你也有`TestFrame`扩展`JFrame`。这会创建 2 个帧，其中一个永远不会显示。在构造函数中创建框架就足够了。

# .net - Visual C++ 的作用是什么？

> ID：14076959
> 
> 赞同：-1
> 
> 时间：2012-12-28T23:14:46.680
> 
> 标签：.net, visual-studio, visual-c++

我主要是一名 C# 开发人员，Visual Studio 中 Visual C++ 的存在让我感到困惑。

我有以下问题：

*   它是否使用 C 和 C++，是否有不同的编译器？
*   有没有办法开发在 Visual C++ 中非托管运行的代码，或者在 Visual C++ 中开发的任何东西都需要 .NET 才能运行？托管与非托管是否归结为使用的编译器？

*   如果运行编写和运行托管 Visual C++ 代码，有什么我可以在 VC++ 中做而我在 C# 中做不到的事情吗？

*   除了为自己而学习（这很棒）之外，我是否会通过学习 VC++ 获得任何见解，如果是这样，我应该从哪里开始？

我知道这不是一个直接的编程问题，我已经准备好接受投票的冲击，但是，我对此感到非常好奇，并认为其他人也可能如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:23:50.307

我记得从 Stephan T. Lavavej 那里听到的一点见解是，MS 工具链中的几乎所有东西都通过某种方式依赖于 MSVC。这是极其重要的，尽管并不总是直接的。

> 它是否使用 C 和 C++，是否有不同的编译器？

它只支持 C++，但大多数 C 都可以使用 C++ 编译器进行编译。

> 有没有办法开发在 Visual C++ 中非托管运行的代码，或者在 Visual C++ 中开发的任何东西都需要 .NET 才能运行？托管与非托管是否归结为使用的编译器？

不，您不需要 .NET 或 C++/CLI。很多人没有。

> 如果运行编写和运行托管 Visual C++ 代码，有什么我可以在 VC++ 中做而我在 C# 中做不到的事情吗？

可能是低级的东西并使用 C 或 C++ 库。

> 除了为自己而学习（这很棒）之外，我是否会通过学习 VC++ 获得任何见解，如果是这样，我应该从哪里开始？

您将了解 C++ 提供的所有见解。您不需要 MSVC，只需任何编译器即可。

[首先学习 C++。](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)然后像 Dan-o 指出的那样阅读[MSDN 文档。](http://msdn.microsoft.com/en-us/library/vstudio/zdbe067e.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T02:02:59.750

> 它 [Visual C++] 是做 C 和 C++ 的吗，每个都有不同的编译器吗？

有一个编译器（或至少一个前端程序）可以同时执行 C 和 C++（但与某些人认为的相反，它以单独的 C 模式运行，它将拒绝特定于 C++ 的构造）。

> 有没有办法开发在 Visual C++ 中非托管运行的代码，或者在 Visual C++ 中开发的任何东西都需要 .NET 才能运行？托管与非托管是否归结为使用的编译器？

是的，用 C 或 C++ 开发的本机代码可以/将在没有 .NET 的情况下运行。有一种混合（C++/CLI），有点像 C++，但它产生的东西需要 .NET 才能运行。我不会花很多时间/精力去担心它——事实上，我*通常*会完全忽略它的存在。

> 如果运行编写和运行托管 Visual C++ 代码，有什么我可以在 VC++ 中做而我在 C# 中做不到的事情吗？

是和不是。C++/CLI 使与本机代码的互操作比尝试直接从 C# 使用它要简单得多——这基本上是我建议使用它的唯一情况（至少在我最后一次查看时，这几乎是MS也推荐了什么）。

> 除了为自己而学习（这很棒）之外，我是否会通过学习 VC++ 获得任何见解，如果是这样，我应该从哪里开始？

你的意思是学习真正的 C++，还是微软的 C++/CLI 东西？正如上面所指出的，C++/CLI 不是鱼也不是鸟，我通常会避免它。

真正的 C++ 则完全不同。使用它的原因有很多：

1.  模板：找出 C#“泛型”在模仿方面做得不好。
2.  本机代码：有助于提高速度，消除对 .NET 的依赖。
3.  一些（但不是全部）标准库的设计要好得多。
4.  把最好的留到最后：RAII 管理各种资源，而 GC 只管理内存。

就个人而言，我认为您过于关注“一个编译器”与“两个编译器”——这几乎是毫无意义的区别。真正的问题不是涉及多少编译器，或者哪个编译器生成什么代码，而是如何完成你想要的——至少如果你在 VS 内部工作，它通常会整理出诸如哪个编译器之类的事情调用特定的源代码。

让这被视为一种推销（或类似的东西），我觉得有必要指出，与 C# 相比，C++ 并不*全是奇迹和轻巧。*举个例子，C++ 并不真正支持反射，这使得有些东西比 C# 更笨拙*。*其他一些领域（例如，模板元编程）是可能的，但可能难以理解并且经常涉及真正可怕的语法。然后有一个简单的事实，即 C++ 的编译时间几乎总是比 C# 慢很多。

# c++ - C中的快速生产者/慢消费者

> ID：14076963
> 
> 赞同：10
> 
> 时间：2012-12-28T23:15:04.077
> 
> 标签：c++, c, linux, unix

`system()`我用 C 语言编写了一个等待事件的程序，然后按函数运行外部系统命令。

```
while( true ){
    wait_for_event();
    system("cmd");
} 
```

我对此有一个严重的问题，这`cmd`是一个繁重的命令，需要几秒钟才能完成，我的应用程序在这个时间范围内错过了一些事件。

所以我决定把这个`system`很重的函数移到另一个程序中，所以我把我的程序改成如下：

```
while( true ){
    wait_for_event();
    write_to_fifo("cmd");
} 
```

并编写了另一个程序：

```
while(true){
    system(read_from_pipe());
} 
```

但这无济于事，因为如果生产者（第一个程序）的写入速度比消费者（第二个程序）快，那么消费者会丢失一些数据！

有没有办法处理这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T23:19:58.900

您应该将代码返回到它的原始形式——即一个程序调用第二个程序——除了用调用替换`system(3)`调用`popen(3)`。现在调用程序可以将事件检查调用与来自外部程序的读取行交错。

Unix 管道机制确保当管道已满时，缓慢的消费者将导致快速的生产者在写入时等待。

您可能还想查看该`fileno(3)`函数，结合`select(2)`or`poll(2)`以便从外部程序异步读取，以便它*永远不会*阻塞调用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T23:19:18.437

如果您只需要事件的数量，您可以拥有一个全局计数器。为避免竞争条件，您可能需要改用信号量。当然你需要有两个线程。

由于您的事件包含重要事件，因此可以使用列表（或具有足够数量的插槽的数组）来存储传入数据。您可以使用互斥锁来保护此列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T08:30:32.377

[您可以使用fork(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/fork.2.html)、[execve(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/execve.2.html)、[waitpid(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/waitpid.2.html)以及[pipe(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/pipe.2.html)、[dup2(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/dup2.2.html)和其他系统调用显式启动您的外部程序。

您可能需要一个事件循环。您可以使用[poll(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/poll.2.html)系统调用（或者可能是像[libev](http://software.schmorp.de/pkg/libev.html)这样的事件循环库，它使用`poll`）。

我强烈建议在编码之前花几个小时阅读一本好的[高级 Linux 编程书籍](http://advancedlinuxprogramming.com/)。

# android - 如何阻止startActivity创建同一个Activity的两个实例

> ID：14076968
> 
> 赞同：6
> 
> 时间：2012-12-28T23:15:31.597
> 
> 标签：android, back-button

活动 A 有一个按钮，并在`onclick`它启动新活动 B，新活动只有最小的 onCreate 功能。

在活动中，人工智能按下一个按钮，它使用

```
startActivity(new Intent(A.this, B.class)) 
```

启动活动 B。当我运行程序时，按下活动 A 中的按钮，活动 B 开始，但我必须使用两次后退按钮退出并返回第一个活动。

单击 A 中的按钮时，我检查了 logcat，同时创建了两个相同的实例。我还尝试在 Activity B 中使用`Toast`in`onCreate`进行调试，这表明当我使用后退按钮时，它会调用`onCreate`另一个双胞胎 B Activity 中的 。我发现这篇文章[单击后退按钮两次以退出](https://stackoverflow.com/questions/8430805/android-clicking-twice-the-back-button-to-exit-activity)不回答问题的活动。

我可以阻止它创建双实例的唯一方法是使用`tag:launchMode= "singleInstance"`清单中的活动明确限制它。

问题仍然存在：

1.  为什么它会产生两个实例？
2.  如何阻止它或如何正确使用它，以免发生这种情况？

更多解释：代码：Activity A 有一个 buttOnClick() 函数，其中有一个 switch(view.getId()) 检查哪个按钮被点击。每个案例都使用特定的整数参数（按钮 id）调用函数动画。在此函数中，switch 再次检查 id 并使用 setAnimationListener 运行与按钮对应的动画。在动画结束时，它要求启动一个新活动。这是它的样子：

```
public void myButtonOnClick(View view)
    {

        switch (view.getId()) {

        case R.id.button1:

            animation(1);

            break;
           //....more lines.....  }}
public void animation(int a){

           //...code...

          switch(a){

        case 1:
            anim.setAnimationListener(new AnimationListener() {

                public void onAnimationStart(Animation arg0) {
                    // TODO Auto-generated method stub

                }

                public void onAnimationRepeat(Animation arg0) {
                    // TODO Auto-generated method stub

                }

                public void onAnimationEnd(Animation arg0) {
                    Intent in =new Intent(A.this,     B.class);
                    startActivity(in.addFlags(      Intent.FLAG_ACTIVITY_CLEAR_TOP ));
                    animClear();
                }
            });

            break;
//......... other cases......} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T03:34:23.913

[意图标志](http://developer.android.com/reference/android/content/Intent.html#setFlags%28int%29)

我自己使用了一套，`FLAG_ACTIVITY_NEW_TASK | FLAG_ACTIVITY_CLEAR_TOP | FLAG_ACTIVITY_RESET_TASK_IF_NEEDED`但这可能有点矫枉过正。

然后就

```
startActivity(new Intent(A.this, B.class).addFlags(intent_flags)); 
```

# javascript - 如何使背景图像在 html 中不可调整大小？

> ID：14076972
> 
> 赞同：3
> 
> 时间：2012-12-28T23:15:42.283
> 
> 标签：javascript, html, css

```
body {
    background: url('../../asset/background.jpg') no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
} 
```

这是我的背景图像代码。我希望在调整浏览器大小时图像不能调整大小。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T23:18:04.303

你不应该使用`background-size:cover;`. 使用该 CSS，您可以告诉浏览器您希望背景图像扩展以覆盖整个背景区域。

如果您希望背景图像居中且不调整大小，只需执行以下操作：

```
body {
    background: url('../../asset/background.jpg') no-repeat center center;
} 
```

您可以以任何您喜欢的方式放置背景，[这里有更多选项](http://www.w3schools.com/cssref/pr_background-position.asp)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T23:18:37.893

尝试设置背景大小：

```
background-size: 100px 100px; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-28T23:22:31.047

设置`background-size`to`cover`占用div的空间。看到[这个](http://www.w3schools.com/cssref/playit.asp?filename=playcss_background-size&preval=cover)。

删除该`background-size`属性，它将正常工作。

# vb.net - 如何列出 FTP 连接的目录内容

> ID：14076973
> 
> 赞同：4
> 
> 时间：2012-12-28T23:15:53.127
> 
> 标签：vb.net, ftp

我找不到这方面的教程。在 VB.NET 中，我想做一个命令，例如：

```
Dim array1() as string = ListFilesInFolder("www.example.com/images") 
```

我知道这可能不会那么简单，但是任何人都可以指出我的教程或任何东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T23:33:03.077

使用这个免费库[http://netftp.codeplex.com/](http://netftp.codeplex.com/)

```
Imports System.Net
Imports System.Net.FtpClient

Sub Main
    using ftp = new FtpClient()

        ftp.Host = "www.example.com"
        ftp.Credentials = new NetworkCredential("yourFTPUser", "yourFTPPassword")
        ftp.SetWorkingDirectory("/images")
        for each item in ftp.GetListing(ftp.GetWorkingDirectory())

            select case item.Type
                case FtpFileSystemObjectType.Directory:
                    Console.WriteLine("Folder:" + item.FullName)
                case FtpFileSystemObjectType.File:
                    Console.WriteLine("File:" + item.FullName)
            End Select
        Next
    End Using    
End Sub 
```

当然我假设 www.example.com 是一个 FTP 服务器。

**重要提示：**该库需要完整的`Framework 4.0`. 您应该转到您的构建页面`Project Properties`，单击`Advanced Options`并选择`Framework 4.0`而不是`Framework 4.0 Client Profile`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-25T10:15:28.960

以下方法适用于`framework 3.5`更高版本，我知道这个问题已有 3 年历史，但我遇到了需要在项目中列出 FTP 目录的情况，所以我通过参考[*How to: List Directory Contents with FTP*](https://msdn.microsoft.com/library/ms229716(v=vs.100).aspx)`framework 3.5`编写了以下代码。[](https://msdn.microsoft.com/library/ms229716(v=vs.100).aspx)

 *```
Imports System.Net

Dim Dirlist As New List(Of String) 'I prefer List() instead of an array
Dim request As FtpWebRequest = DirectCast(WebRequest.Create("ftp://www.example.com/images"), FtpWebRequest)

request.Method = WebRequestMethods.Ftp.ListDirectory
request.Credentials = New NetworkCredential("USER_NAME", "PASSWORD")

Dim response As FtpWebResponse = DirectCast(request.GetResponse(), FtpWebResponse)
Dim responseStream As Stream = response.GetResponseStream

    Using reader As New StreamReader(responseStream)
          Do While reader.Peek <> -1
             Dirlist.Add(reader.ReadLine)
          Loop
    End Using
response.Close() 
```*

# jquery - 删除自关闭不必要的标记 xslt

> ID：14076974
> 
> 赞同：0
> 
> 时间：2012-12-28T23:16:03.267
> 
> 标签：jquery, html, xml, xslt

我正在使用以下 XSLT：

[https://gist.github.com/4402884](https://gist.github.com/4402884)

以下模板执行转换以呈现 html 输出，如下所示：

```
<li>
  <div class="content-left" style="float:left; width:300px"> content </div>

  <div class="content-left" style="float:left; width:300px">content </div>
</li>

<li>
  <div class="content-left" style="float:left; width:300px"> content </div>

  <div class="content-left" style="float:left; width:300px">content </div>
</li>
.
.
. 
```

等等.. 实际的 XSLT 完成了这样的工作以获得两列布局：

```
A-----B
C-----D
E-----F 
```

其中每一行都是一个'li'项目

```
 <xsl:choose>
    <xsl:when test="$CurPos mod 2 =1">
       <xsl:text disable-output-escaping="yes">&lt;li style=&quot;width:610px; height:290px; &quot;&gt;</xsl:text>      
       <div class="content-left" style="width:290px; height:290px;float:left;">
            <xsl:value-of select="@PublishingRollupImage" disable-output-escaping="yes" />
            <span class="NewsHeading"><h4><xsl:value-of select="$CurPos"/><xsl:value-of select="@Title"/></h4></span>
            <span class="Desc" style="display:block; width:280px;"><xsl:value-of select="substring(@Comments,0,200)"/>
            <xsl:if test="string-length(@Comments) &gt; 200">…&lt;/xsl:if><a href="{$SafeLinkUrl}" class="ReadMore"> Read More</a></span>
        </div>

        <div class="content-right" style="float:right; width:290px; height:290px;">
            <xsl:if test="$CurPos != $LastRow ">
                <xsl:value-of select="following-sibling::*[1]/@PublishingRollupImage" disable-output-escaping="yes" />
                <span class="NewsHeading"><h4><xsl:value-of select="$LastRow"/><xsl:value-of select="following-sibling::*[1]/@Title"/></h4></span>
                <span class="Desc" style="display:block; width:280px;"><xsl:value-of select="substring(following-sibling::*[1]/@Comments,0,200)"/>
                <xsl:if test="string-length(following-sibling::*[1]/@Comments) &gt; 200">…&lt;/xsl:if>
                <a href="{$SibSafeLinkUrl}" class="ReadMore"> Read More</a></span>
            </xsl:if>
        </div>
    </xsl:when> 
    <xsl:otherwise>
         <xsl:text disable-output-escaping="yes">&lt;/li&gt;</xsl:text>
    </xsl:otherwise>
</xsl:choose> 
```

可悲的是，然而 Inernet Explorer 会产生不必要的自封闭标签（仅 IE），FF 和 chrome 会正确呈现它......

```
<li>
  <div class="content-left" style="float:left; width:300px"> content </div>

  <div class="content-left" style="float:left; width:300px">content </div>
</li></li/></li/>

<li>
  <div class="content-left" style="float:left; width:300px"> content </div>

  <div class="content-left" style="float:left; width:300px">content </div>
</li></li/></li/> 
```

我如何摆脱那些不需要的自我封闭奇怪的“li”标签？因为我需要确切的 html 结构才能使 jquery 滑块插件工作，因为不需要的标签，滑块行为不端。

这是在 IE 中： [IE http://www.imagesup.net/?di=9135673644516](http://www.imagesup.net/?di=9135673644516)

这是在 FireFox 中： [FF http://www.imagesup.net/?di=11135673652612](http://www.imagesup.net/?di=11135673652612)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:17:49.580

我不确定这是否能解决您的问题，但我强烈考虑重新调整您的 xsl:choose 语句。我猜您正在使用禁用输出转义，因为如果您尝试像以下示例那样编写 XSLT，它将不是格式正确的 XML，因此无效。（为简洁起见，我删减了代码示例）。

```
<xsl:choose>
    <xsl:when test="$CurPos mod 2 =1">
       <li>  
       <div class="content-left">
           <xsl:value-of select="@PublishingRollupImage" />
        </div>
        <div class="content-right">
           <xsl:value-of select="following-sibling::*[1]/@PublishingRollupImage" />
        </div>
    </xsl:when> 
    <xsl:otherwise>
         </li>
    </xsl:otherwise>
</xsl:choose> 
```

您要实现的是将成对的元素组合在一起，因此您选择位置 1、3、5 等的元素，然后输出该元素和下一个元素。

为了避免使用禁用输出转义，您可以做的是像这样重写它。

```
<xsl:if test="$CurPos mod 2 =1">
   <li>  
      <div class="content-left">
         <xsl:value-of select="@PublishingRollupImage" />
      </div>
      <div class="content-right">
         <xsl:value-of select="following-sibling::*[1]/@PublishingRollupImage" />
      </div>
   </li>
</xsl:if> 
```

现在格式正确，直接输出**li元素。**无论这是否解决了您的问题，这可能都是值得的。

# environment-variables - 将流星应用部署到非流星基础设施时，如何为第三方登录服务维护不同的环境配置？

> ID：14076975
> 
> 赞同：4
> 
> 时间：2012-12-28T23:16:03.687
> 
> 标签：environment-variables, meteor

在将流星应用程序部署到 Heroku 或其他非流星托管基础设施并使用第三方 OAuth 登录服务包时，[`accounts-facebook`](http://docs.meteor.com/#accounts_api)必须关注安全地维护每个第三方登录服务的 API 密钥和 API 机密。

在这种情况下，我如何安全地维护不同类型环境（例如，开发、登台和生产）的环境特定安全信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T23:16:03.687

在维护部署策略时，有开发、登台和生产环境，代码通过这些层移动，从开发箱开始，到生产结束，需要考虑两件事：不向 VCS 系统提交安全信息像 git 一样，环境配置维护方便。

可以考虑为上述用例使用环境变量。

例如，要配置`accounts-facebook`，您可以在流星应用程序中编写以下内容`server/config.js`：

```
Accounts.loginServiceConfiguration.remove({
  service: "facebook"
});

Accounts.loginServiceConfiguration.insert({
  service: "facebook",
  appId: process.env.FACEBOOK_APP_ID,
  secret: process.env.FACEBOOK_APP_SECRET
}); 
```

以下几行是必不可少的：

```
appId: process.env.FACEBOOK_APP_ID,
secret: process.env.FACEBOOK_APP_SECRET 
```

`process.env`让您访问所有环境变量。

然后，您可以只设置环境变量`FACEBOOK_APP_ID`并`FACEBOOK_APP_SECRET`特定于您的环境 - 开发、登台或生产。

# php - codeigniter 插入语法错误

> ID：14076987
> 
> 赞同：1
> 
> 时间：2012-12-28T23:17:19.663
> 
> 标签：php, mysql, codeigniter, activerecord

这是我的插入 sql 语句：

```
$sql = "
                LOCK TABLE notre_offre WRITE;

                SELECT 
                    @myRight := rgt FROM notre_offre
                WHERE id = " . $this->input->post('category') . ";

                UPDATE notre_offre SET rgt = rgt + 2 WHERE rgt > @myRight;
                UPDATE notre_offre SET lft = lft + 2 WHERE lft > @myRight;
                INSERT INTO notre_offre(id, naziv, lft, rgt) VALUES(null, '" . $this->input->post('title') . "', @myRight + 1, @myRight + 2);
                UNLOCK TABLES;
                ";

        $query = $this->db->query($sql); 
```

但我得到了语法错误：

```
"Error Number: 1064

You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SELECT @myRight := rgt FROM notre_offre WHERE id = 2; UPD' at line 3 
```

这里有什么问题？这可以从 phpmyadmin 和 cmd 完美运行。"

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T23:19:24.827

具体不了解 Codeigniter，但您可能一次不能发送多个 SQL 命令。尝试通过单独的调用发送个人`LOCK`等`SELECT`命令。`query()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T00:35:41.237

您可能需要对此进行调整，但这些方面的内容应该让您开始在数据库中创建存储过程，而不是每次都尝试在运行中查询它：

```
DROP PROCEDURE IF EXISTS `InsertNode`;
DELIMITER $$
CREATE DEFINER=`db_user`@`localhost` PROCEDURE `InsertNode` (
    pParentCategory VARCHAR(50),
    pCategory VARCHAR(50),
    pTitle VARCHAR(50)
)
    COMMENT 'Inserts a node into a hierarchical table'
    LANGUAGE SQL
    NOT DETERMINISTIC
    MODIFIES SQL DATA
    SQL SECURITY DEFINER
BEGIN
    DECLARE myRight INTEGER;

    START TRANSACTION;
    SELECT `rgt` INTO myRight
      FROM `notre_offre`
      WHERE `id` = pParentCategory;

    UPDATE `notre_offre` SET `rgt` = `rgt` + 2 WHERE `rgt` > myRight;
    UPDATE `notre_offre` SET `lft` = `lft` + 2 WHERE `lft` > myRight;
    INSERT INTO `notre_offre` (`id`, `naziv`, `lft`, `rgt`)
        VALUES (pCategory, pTitle, myRight + 1, myRight + 2);

    SELECT `pCategory` AS "id", pTitle as "myRight",
        (myRight + 1) AS "lft", (myRight + 2) AS "rgt";
    COMMIT;
END $$
DELIMITER ; 
```

请注意，您只需定义*一次*，而不是每次要插入节点时。因此，您可以从您最喜欢的 DB GUI 工具（例如 PhpMyAdmit、MySQL Workbench 等）中运行它。之后，要插入一个节点，而不是尝试将其直接插入到表中，您可以这样调用它：

```
CALL `InsertNode`('Televisions', 'Game Consoles', 'User-defined Title'); 
```

但是，就像我说的那样，根据表中的确切字段，您可能必须添加参数并调整上面的过程才能完全按照您的意愿工作。不过，这应该是一个好的开始。

# android - 如何从 ASyncTask 中获取结果？

> ID：14076998
> 
> 赞同：0
> 
> 时间：2012-12-28T23:18:38.903
> 
> 标签：android, android-asynctask

我正在尝试连接到本地网络中的主机。通过我的电脑或我的安卓手机（SGS2）访问它，它似乎也适用于我的应用程序，但我想得到一个结果来检查它是否有效，并根据它继续采取进一步的行动。

我正在使用一个名为 Connector 的 ASyncTask 实现。当我调用连接器时，我不仅调用执行，还调用 get() 以接收表示成功的布尔值。这里的问题是执行执行得很好（肯定到达了主机，我在 doInBackground 中的断点处着陆。

但是我怎样才能接收到我在 doInBackground 中返回的布尔值呢？当我调用 get() 时，它永远不会结束......

基本上，我关心的是变量“connected”，但 get() 似乎永远运行！清单中授予了权限，我手机上的 wifi 已启用并且可以正常工作，我可以访问主机。

这是我执行连接器的地方：

```
url = new URL("http://192.168.2.103/?LED=T");
            Connector connector = new Connector();
            AsyncTask<URL, Integer, Boolean> execute = connector
                    .execute(url);
            Status status = execute.getStatus();
            boolean connected = false;
            try {
                Log.d("MainActivity", "trying to get result");
                connected = connector.get();
                Log.d("MainActivity", "got result");
            } catch (InterruptedException ie) {
                ie.printStackTrace();
            } catch (ExecutionException ee) {
                ee.printStackTrace();
            }
            System.out.println();
        } catch (MalformedURLException e) {
            e.printStackTrace();
        }
        //do something depending on connected 
```

这是连接器：

```
public class Connector extends AsyncTask<URL, Integer, Boolean> {

public static boolean connect(URL url) {
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(url.toString());
    System.out.println();

    try {
        HttpResponse response = httpclient.execute(httppost);
        int statusCode = response.getStatusLine().getStatusCode();
        Log.d("myapp", "response " + response.getEntity());
    } catch (ClientProtocolException e) {
        e.printStackTrace();
        return false;
    } catch (IOException e) {
        e.printStackTrace();
        return false;
    } catch (Exception e) {
        e.printStackTrace();
        return false;
    }

    return true;
}

@Override
protected Boolean doInBackground(URL... params) {
    boolean connect = connect(params[0]);

    return connect;
}

@Override
protected void onPostExecute(Boolean result) {
    Log.d("Connector", "onPostExecute");
    super.onPostExecute(result);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:33:34.343

我不认为你想打电话`get()`，因为你已经用`execute()`. 如果您只想查看已设置连接的变量，请`Lof`在您`onPostExecute()`的中使用 a，因为结果来自`doInBackground`发送给它。如果你需要用它做点什么，那么你也可以这样`onPostExecute()`做