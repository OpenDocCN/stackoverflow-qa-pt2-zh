# StackOverflow 问答 13405000-13405999

# php - 正则表达式查找带和不带双方括号的 ID (X.123)

> ID：13405002
> 
> 赞同：0
> 
> 时间：2012-11-15T19:48:01.520
> 
> 标签：php, regex

我正在使用以下内容来查找 ID 的实例，例如 X.123：

```
$regex_id   = "/\b[Xx][\.][0-9]{1,4}\b/";
preg_match_all($regex_id, $html, $matches_id, PREG_SET_ORDER); 
```

匹配的 ID 被转换为一些存储的文本。这部分效果很好，但是我需要添加一些功能。现在一些 ID 将被括在双括号中，例如 [[X.123]]，我需要匹配独立 ID 或括号内的 ID。

独立 ID 将替换为一些文本（例如：）`X.123 >> MyText`。
括号中的 ID 将被替换为图像（例如：`[[X.123]] >> <img src='mypic.png'>`.

我需要小心这是如何完成的，所以我不替换`[[X.123]]`为`[[MyText]]`. 正如 Jason McCreary 在下面指出的那样，我可以简单地对这两个表达式进行排序，尽管这可能不是最好的方法。

这是匹配括号内 ID 的正确表达式吗？

```
\[\[[Xx][\.][\s][0-9]{1,4}\]\] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T19:50:45.237

一种*天真*的方法是做两次传球。

1.  代替`[[X.123]]`
2.  代替`X.123`

我会通过一次调用来[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)使用数组作为搜索/替换参数来做到这一点。

**更新**

的正则表达式为`[[X.###]]`：

```
\[\[[Xx]\.\d{1,4}\]\] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T19:54:35.290

> 这是匹配括号内 ID 的正确表达式吗？
> 
> \[\[[Xx][\.][\s][0-9]{1,4}\]\]

里面有多余的字符。

```
\[\[[Xx]\.[0-9]{1,4}\]\] 
```

**编辑**

...这将匹配仅括号版本。如果你需要同时匹配：

```
(?:\[\[)?[Xx]\.[0-9]{1,4}(?:\]\])? 
```

...如果/当它们匹配时，它不会创建对括号的反向引用。这里一个可能的问题是您匹配一侧或另一侧的括号，*但不能同时匹配两者*。LMK 如果您需要它比这更严格。

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T19:58:43.593

```
(\[\[)?[Xx]\.[0-9]{1,4}(\]\])? 
```

# magento - 隐藏（可配置）具有属性的产品

> ID：13405004
> 
> 赞同：0
> 
> 时间：2012-11-15T19:48:07.260
> 
> 标签：magento

我在 Magento 网站上工作，我想做的是：我创建了一个属性来隐藏某些产品。在网格视图页面上，我使用以下代码将它们从列表中排除：

```
<?php if ($_product->getAttributeText('hideproduct')):?>
<?php else: ?> 
```

基本上，它只是说当“隐藏产品”出现时，不要显示任何东西。

这适用于简单的产品，但对于可配置的产品，它有点复杂，而且似乎不适用于此。假设我想隐藏具有某种颜色的产品，它总是不断出现在可配置产品的下拉菜单中。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T13:35:27.733

这就是我为我的一项任务所做的（如果有更好的方法请告诉我）您必须为此目的扩展 Mage_Catalog_Block_Product_View_Type_Configurable。在里面

```
public function getAllowProducts()
{
    if (!$this->hasAllowProducts()) {
        $products = array();
        $allProducts = $this->getProduct()->getTypeInstance(true)
            ->getUsedProducts(null, $this->getProduct());
        foreach ($allProducts as $product) {

            if ($product->isSaleable()) {
                if(!$product->getEcoReport())
                    {
                        $products[] = $product; 
                    }

            }
        }
        $this->setAllowProducts($products);
    }
    return $this->getData('allow_products');
} 
```

eco_report 是我的属性标签。所以这就是它的工作原理......如果对于（特定可配置产品的）简单产品，如果设置了属性 eco_report，那么该产品将不会显示在可配置产品的下拉列表中（在查看页面上）。因此，必须设置所有简单产品的 eco_report 属性，使其不会显示在可配置产品的下拉列表中......

# javascript - 单击图像（上一个和下一个）手动导航照片滑动中的图像

> ID：13405007
> 
> 赞同：3
> 
> 时间：2012-11-15T19:48:22.203
> 
> 标签：javascript, html, photoswipe

我在我的移动应用程序中使用 photoswipe。

我们在目标中显示图像`div`，我们没有使用全屏视图。

一个要求是内置工具栏不可见，并且在 div 的左侧和右侧有一个箭头图像以移动到上一个和下一个图像并允许滑动。如何`photoswipe.js`在单击图像时手动调用 JavaScript 来执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T15:17:45.943

经过一番挖掘和做了许多复杂的事情后，我找到了答案。答案很简单。

因为我有一个 PhotoSwipe 对象 (psInstance) 的实例，所以您只需执行以下操作：psInstance.next(); 或 psInstance.prev();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-12T12:36:38.123

我有同样的问题并用API解决了它。尝试使用这种方法来捕获点击事件：

```
/*slide to the next item on img click*/

lightBox.framework.bind(lightBox.scrollWrap, 'pswpTap', function(e) {
    pswp.next();
}); 
```

'pswp' => 你的 PhotoSwipe 对象。

# javascript - 无法在 jsfiddle 中执行 Doug Crockford 的 deentityify 示例

> ID：13405010
> 
> 赞同：4
> 
> 时间：2012-11-15T19:48:31.033
> 
> 标签：javascript

我正在尝试使用 jsfiddle 在 Douglas Crockfords J-TBP 书中执行那个非常好的去实体化示例

```
String.method('deentityify', function() {
    // The entity table. It maps entity names to
    // characters.
    var entity = {
        quot: '"',
        lt: '<',
        gt: '>'
    };
    // Return the deentityify method.
    return function() {
        // This is the deentityify method. It calls the string
        // replace method, looking for substrings that start
        // with '&' and end with ';'. If the characters in
        // between are in the entity table, then replace the
        // entity with the character from the table. It uses
        // a regular expression (Chapter 7).
        return this.replace(/&([^&;]+);/g, function(a, b) {
            var r = entity[b];
            return typeof r === 'string' ? r : a;
        });
    };
}());

document.writeln('&lt;&quot;&gt;'.deentityify()); // <"> 
```

*   请参阅[http://jsfiddle.net/cspeter8/7Pjzs/2/](http://jsfiddle.net/cspeter8/7Pjzs/2/) - 它不起作用！我希望结果窗格显示 '<">' 但什么也没有显示。有人想解开这个谜吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T19:52:23.310

此代码片段取决于`method`您必须事先定义的一些糖，即方法。（它在本书的早期描述过。）在线副本和它的解释在[Crockford 的文章“JavaScript 中的经典继承”的“糖”部分](http://www.crockford.com/javascript/inheritance.html#sugar)。它看起来像这样：

```
Function.prototype.method = function (name, func) {
    this.prototype[name] = func;
    return this;
}; 
```

包含上述内容的 Fiddle 的更正版本位于[http://jsfiddle.net/W9Ncd/](http://jsfiddle.net/W9Ncd/)。

# iphone - 核心数据的替代品

> ID：13405011
> 
> 赞同：1
> 
> 时间：2012-11-15T19:48:30.833
> 
> 标签：iphone, objective-c, ios

> **可能重复：**
> [是否有适用于 Cocoa 的 ORM 框架，或使用不同技术实现类似目标的框架？](https://stackoverflow.com/questions/1745860/is-there-an-orm-framework-for-cocoa-or-a-framework-that-accomplishes-a-similar)

是否有任何正在积极开发中提供 ORM 功能的框架？我只是讨厌必须附加 Core Data 中的数据模型才能使用的事实。我想使用普通对象，当我想保存等时，我告诉持久性框架这样做。就像 Java 中的 JPA 实现一样。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-16T03:32:14.770

你可能想试试[MagicalRecord](https://github.com/magicalpanda/MagicalRecord)

# objective-c - Objective C字符数组问题

> ID：13405012
> 
> 赞同：2
> 
> 时间：2012-11-15T19:48:31.020
> 
> 标签：objective-c, arrays, char, symbols

嘿，伙计们，所以我正在尝试将 Objective c 作为我学校的一项独立学习来学习，而我的一个项目只是为了练习制作一个计算器程序，在该程序中，用户输入一串数字和运算符，程序将其分解并执行计算。现在我有输入，我试图让它找到运算符并将它们全部放在一个数组中，以便它可以对它们进行排序以查找操作顺序并使用索引来查找不同的术语；但是，当我尝试打印出数组以查看它是否包含字符时，它会输出一些奇怪的符号，例如苹果徽标或倒置的问号。我已经对我的问题进行了 SSCCE - 有人知道发生了什么吗？

```
int main(int argc, const char * argv[])
{
@autoreleasepool {

    NSString *calculation;
    char str[50] = {0};
    int count = 0;

    NSLog(@"What would you like to calculate?");
    scanf("%s", str);
    calculation = [NSString stringWithUTF8String:str];

    for (int i = 0; i < [calculation length]; i++) {
        NSRange range = NSMakeRange (i, 1);
        if([[calculation substringWithRange: range] isEqualToString: @"*"] ||
           [[calculation substringWithRange: range] isEqualToString: @"/"])
            count++;
    }

    char operators[count];
    for (int i = 0; i < count; i++) {
        for (int j = 0; j < [calculation length]; j++) {
            NSRange range = NSMakeRange (j, 1);
            NSString *s = [s initWithString:[calculation substringWithRange: range]];
            if([s isEqualToString:@"*"]){
                operators[i] = '*';
                break;
            }
            if([s isEqualToString:@"/"]){
                operators[i] = '/';
                break;
            }
        }
        NSLog(@"%c", operators[i]);
    }

}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:31:22.580

回答您关于代码中发生了什么的问题。您看到的“奇怪符号”是`operators[]`数组内存中未初始化的值。

要查看 char[] 留下垃圾值的原因，请查看代码的这一部分：

```
 ...
    NSString *s = [s initWithString:[calculation substringWithRange: range]];
    if([s isEqualToString:@"*"]){
        operators[i] = '*';
        break;
    }
    ... 
```

您正在发送`initWithString`到`s`. `s`尚未分配。这导致`s`成为`nil`. 而且由于发送类似于 a 的消息`isEqualToString:`本质*上*`nil`会评估即使 a在该范围内，您的分配也永远不会发生。*`NO``@"*"``operators[i]`*

 *不过很容易修复，只需将`s`作业替换为：

```
NSString *s = [calculation substringWithRange:range]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:05:19.220

You don't need anything fancy for this. But: use stuff for what it is there for.

```
#import <Foundation/Foundation.h>

int main()
{
    NSAutoreleasePool *pool = [NSAutoreleasePool new];

    char str[128];
    printf("Enter formula:\n");
    scanf("%s", str); // this is DAMN unsafe, btw

    NSMutableArray *arr = [NSMutableArray array];

    char *s = str;
    while (*s) {
        if (*s == '*') {
            [arr addObject:@"*"];
        } else if (*s == '/') {
            [arr addObject:@"/"];
        }
        s++;
    }
    printf("\n");

    [arr enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        NSLog(@"%@", obj);
    }];

    [pool drain];
    return 0;
} 
```*

# asp.net - ASP.Net 网站上 Android 4+ 下的 CSS 差异

> ID：13405014
> 
> 赞同：4
> 
> 时间：2012-11-15T19:48:39.507
> 
> 标签：asp.net, html, css, android-4.0-ice-cream-sandwich

我的现有 ASP.Net 移动网站存在问题，该网站当前在 android 手机 pre 4、iphone 和黑莓下正确呈现。这个问题需要一些设置，但是..

CSS

```
tr
{
    color: #00ff00;
}

#MasterBackButton
{
    text-decoration: none;
    border-radius: 5px;
    background-color: #2f7ac1;
    padding: 5px;
    cursor: pointer;
    color: #ffffff;
} 
```

这是由 asp.net 生成的带有 html 的示例页面（注意：根本没有表标签）

```
<!DOCTYPE html>

<head>
    <title>CSS Problem</title>
    <link id="MainStyleSheet" rel="stylesheet" type="text/css" href="http://10.0.0.108/m/styles/default.css">
</head>
<body id="Body1">
<form method="post" action="/m/" id="MainForm" autocomplete="off">
     <div class="aspNetHidden">
         <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTcwODg1MTE2Ng9kFgJmD2QWAgIBD2QWAgIBDxYCHgZhY3Rpb24FAy9tL2RkHHvpHhoukujQ1p/Rk9kY9OLmIKo=" />
     </div>
     <div style="float: right;">
          <div id="MasterBackButton" onclick="javascript:history.back()">
              Back
          </div>
     </div>
</form>
</body> 
```

只需一个带有圆形按钮的页面即可返回。

正如预期的那样，它在 android 2.3 下：

![在此处输入图像描述](../Images/c7f1ca18a69b74ff5b295300efdfd190.png)

现在这是 4.03 下的同一页面

![在此处输入图像描述](../Images/be0eeb648cc913b3e77a8cf37718ebbb.png)

突然，文本变成了绿色......出于某种原因，即使页面上没有单个表格元素，tr 的样式也会应用于 div。

现在，我在浏览器上点击桌面模式，然后：

![在此处输入图像描述](../Images/6a96d4c280928d13b4dbdf99992c4b84.png)

它突然起作用了。诡异的。好的，我使用 wget 并下载确切的 html 并将该文件放在网络服务器上：

![在此处输入图像描述](../Images/9a9a3fee474df56b459e9761c2ad72c9.png)

它有效！那么，为什么 ASP.Net 页面一团糟呢？我一生都无法弄清楚为什么 tr 的样式会影响 div。如果我将 CSS 从 tr 更改为 table 它仍然会更改它。到目前为止，我尝试过的任何表格元素都可以做到。这几乎就像在标准中一样，库存的 android 浏览器将所有内容都视为表格元素。

我可以确认这一切都发生在真正的 Galaxy S 3 上，而不仅仅是模拟器。

对于一个有很多错误的网站，这只是一个尽可能简化的示例。我有一个之前的问题排名下降并最终关闭，其中包含完整的站点屏幕截图，您可以看到这发生了。甚至这比网站内的某些页面要好。 [https://stackoverflow.com/questions/13368693/mobile-css-broke-android-4](https://stackoverflow.com/questions/13368693/mobile-css-broke-android-4)如果您想查看这些屏幕截图。

编辑：[图片显示 asp 和 html 页面具有相同的标记。](http://i91.photobucket.com/albums/k299/heezer7/bothcode.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:50:44.067

好吧，我终于想通了。我安装了 51degrees 来自动重定向移动用户。我创建了一个新的网站，一旦我添加了所有现有的引用，这个 bug 就再次咆哮着它丑陋的脑袋。即使我没有 51degrees 的配置，web.config 中没有任何内容引用它只是引用它就足以导致问题。本周我们正要从精简版升级到高级版，直到我被设计错误阻止。他们一定会干扰对新安卓浏览器的响应。

# vb.net - 使用 edmx 将逗号分隔的项目转换为实体

> ID：13405018
> 
> 赞同：0
> 
> 时间：2012-11-15T19:48:52.327
> 
> 标签：vb.net, entity-framework, ado.net-entity-data-model, ef-database-first

是否可以将列（存储为逗号分隔）转换为在 edmx 设计器中显示为另一个实体？

表结构

```
student
  id
  name
  subjects << this is the comma delimited column (1,2,3,10)

subject
  id
  name 
```

EDMX 设计器结构将是

```
student 
  id
  name

student_subject
  studentId
  subjectid

subject
  id
  name 
```

如果是这样，有人可以指出我如何在 EF 设计器上做到这一点。

注意：我无法更改表结构，我首先使用数据库

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:16:11.217

There is no way to do this. Worse: in SQL it might be possible to fetch the subjects with an `IN` clause, but with linq you haven't even got that option. I'm afraid what's left is a painstaking linq-to-objects operation where you first grab the `Student` from the database, then parse the subjects in an `int` array, and finally grab the `Subject`s with a `Contains` query:

```
var subjectIds = student.Subjects
    .Split(",".ToCharArray(), StringSplitOptions.RemoveEmptyEntries)
    .Select (x => int.Parse(x));

var subjects = context.Subjects.Where(s => subjectIds.Contains(s.Id)); 
```

(And don't forget to send the architect as student to a course with subject 'Data base design')

# java - 使用 arraylist 作为类的实例

> ID：13405019
> 
> 赞同：0
> 
> 时间：2012-11-15T19:48:59.667
> 
> 标签：java, list, collections, arraylist

我在这个 Java 课程中，我基本上是想成为一个优秀的人，但我大部分时间都在试图弄清楚事情并且它不起作用。

我正在创建温度类的 ArrayList。

```
List<Temperature> templist = new ArrayList<Temperature>();
Temperature t1 = new Temperature ();

for (number of loops user wants) 
{
 templist.add(t1)
} 
```

但是我的温度课程既有数量又有规模。因此，当我显示 t1 时，它看起来像这样

```
Temperature [degrees=43.0, scale=F] 
```

我如何使用我的`getDegrees()`and`getScale()`方法来单独提取`degrees`and `scales`。我也需要得到一个最小值、最大值和平均值。我知道如何使用 for 循环来做到这一点，但是由于涉及到类的实例，这仍然可能吗？

所以基本上这就是我所拥有的

温度.java

```
import java.util.Scanner;

/*
 * This class represents a temperature value.
 */
    public class Temperature {

private double degrees;
private char scale;
Scanner s = new Scanner (System.in);

public Temperature (){
this.degrees = 0 ;
this.scale = 'F' ;
    }

public double getDegrees() {
    return degrees;
}

//public double getDegreesF(){
//  return degrees;
//}

public double getDegreesC(Temperature temperature)

{
         if (scale == 'C') 
             return degrees;
         else if (scale == 'F')
           degrees = ((degrees - 32)*(5)/(9));
           return degrees;

}

public void setDegrees(double degrees) {
    this.degrees = degrees;
}

public char getScaleC() {
     scale = 'C';
    return scale;
}

    public void setScale(char scale) {

    while  ((scale != 'C') && (scale !='F') )

       {

        System.out.println("Please enter correct value");
        scale = s.next().charAt(0);
      } 

    this.scale = scale;
}

@Override
public String toString() {
    return "Temperature [degrees=" + degrees + ", scale=" + scale + "]";
}

    }

 Test Temperature.java

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.Scanner;

public class TestTempreture {

    /**
     * @param args
     */
    public static void main(String[] args) {

        int numberoftimes = 0 ;

        Scanner s = new Scanner (System.in);

        Temperature t1 = new Temperature ();
        List<Temperature> templist = new ArrayList<Temperature>();

        for (int i = 0; i < numberoftimes; i ++  )

        {

            t1.setDegrees(s.nextInt());
            t1.setScale(s.next().charAt(0));
            templist.add(t1);

        }

        System.out.println(templist.get(0)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T19:58:12.563

问题是，`ArrayList`不知道如何计算`min`、`max`和`average`。您可以在主代码中使用循环，也可以使用组合...

```
public class AllTemps {
    private static final ArrayList<Temperature> temps = new ArrayList<Temperature>();
    private Temperature min = null;

    public AllTemps() { }

    public boolean add(Temperature t) {
        updateMin(t);
        return temps.add(t);
    }

    // Here you would implement any other methods to access the ArrayList that you need

    private void updateMin(Temperature t) {
        if (min == null) {
            min = t;
        } else {
            if(min.getDegrees() > t.getDegrees()) min = t;
        }
    }
} 
```

然后您可以以相同的方式实现计算`max`,`average`等。

# javascript - 如何用 B 替换元素 A 并在变量中有 B 对象？

> ID：13405021
> 
> 赞同：0
> 
> 时间：2012-11-15T19:49:05.757
> 
> 标签：javascript, jquery, dom, selection

我有这样的事情：

```
jQuery(this_element).replaceWith('<div>' + jQuery(this_element).html() + '</div>'); 
```

它工作正常，但执行后`this_element`仍然包含旧元素（不再存在，因为它已被替换`<div>old content</div>`）。如何恢复该元素中的选择或至少将新元素抓取到`this_element`变量中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T19:53:03.663

单独创建新对象，然后保留对该对象的引用（jQuery 1.4+）：

```
var $B = jQuery('<div/>', { 'html': jQuery(this_element).html() });
jQuery(this_element).replaceWith($B);
this_element = $B; 
```

（这里使用[`jQuery(html, props)`](http://api.jquery.com/jQuery/#jQuery2)方法。）

[**jsFiddle**](http://jsfiddle.net/nzdPr/1/)

# javascript - 比较javascript日期

> ID：13405026
> 
> 赞同：3
> 
> 时间：2012-11-15T19:49:27.833
> 
> 标签：javascript

我有两个 javascript 日期，我想知道它们是否是相同的日期。这两个日期可以是同一日期但有不同的时间：Date1 可以设置为下午 3 点，而 Date2 可以设置为凌晨 1 点。

我尝试了这两个选项，但都不起作用：

```
// doesn't work when same date but different time
if (Date1.getTime() === Date2.getTime()) 

// gives true when dates are in different months
if (Date1.getUTCDate() === Date2.getUTCDate()) 
```

当 Date1 和 Date2 是同一天时，无论一天中的实际时间如何，最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T19:51:16.170

你为什么不使用`toDateString`你的比较？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T19:55:06.820

您可以获取日期的日、月和年，并检查它们是否相等。

```
if (date1.getUTCDate() == date2.getUTCDate() && 
    date1.getUTCMonth() == date2.getUTCMonth() && 
    date1.getUTCFullYear() == date2.getUTCFullYear()) {
 // dates are on the same day
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T19:55:37.877

```
var equalDates = function (a, b) {
  var a_time = a.getTime();
  var b_time = b.getTime();

  var a_days = Math.floor(a_time / (24 * 3600 * 1000));
  var b_days = Math.floor(b_time / (24 * 3600 * 1000));

  return (a_days === b_days);
}; 
```

您首先以毫秒为单位获得时间。然后你四舍五入到天（自 1970 年 1 月 1 日起）并进行比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T20:03:55.420

**[`setHours:`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/setHours)**在您的日期对象上使用该函数并将`hours`、`minutes`和设置为零：`seconds``milliseconds`

`var today = new Date().setHours(0,0,0,0)`

对于您的具体示例，**您可以使用**：

`if(date1.setHours(0,0,0,0) === date2.setHours(0,0,0,0))`

您的日期对象在哪里`date1`和是。`date2`

**[`setHours:`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/setHours)**

> 根据本地时间设置指定日期的小时数，并返回从 1970 年 1 月 1 日 00:00:00 UTC 到更新的 Date 实例表示的时间的毫秒数。

**[例子：](http://jsfiddle.net/ChaseWest/C6Few/)**

```
var today1 = new Date().setHours(0,0,0,0); 
var today2 = new Date().setHours(1,0,0,0); //notice the 1 here

var today3 = new Date().setHours(0,0,0,0); 
var today4 = new Date().setHours(0,0,0,0);

console.log(today1 === today2); //returns false
console.log(today3 === today4); //returns true 
```

# java - 尝试使用 dom 解析 xml 页面时出现空指针异常

> ID：13405027
> 
> 赞同：2
> 
> 时间：2012-11-15T19:49:28.603
> 
> 标签：java, xml, xml-parsing, nullpointerexception

我为我的 xml 页面编写了一个解析器，但我得到了一个我完全不明白为什么的奇怪错误。首先，我想向您展示我的 xml 页面：

```
<?xml version="1.0" encoding="UTF-8"?>
<drugs xmlns:xs="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://drugbank.ca" xs:schemaLocation="http://www.drugbank.ca/docs/drugbank.xsd" schemaVersion="1.4">
<drug type="biotech" created="2005-06-13 07:24:05 -0600" updated="2012-02-13 17:42:20 -0700" version="3.0">
<drugbank-id>DB00001</drugbank-id>
<name>Lepirudin</name>
<drug-interactions>
  <drug-interaction>
    <drug>DB01381</drug>
    <name>Ginkgo biloba</name>
    <description>Additive anticoagulant/antiplatelet effects may increase bleed risk. Concomitant therapy should be avoided.</description>
  </drug-interaction>
  <drug-interaction>
    <drug>DB00374</drug>
    <name>Treprostinil</name>
    <description>The prostacyclin analogue, Treprostinil, increases the risk of bleeding when combined with the anticoagulant, Lepirudin. Monitor for increased bleeding during concomitant thearpy. </description>
  </drug-interaction>
</drug-interactions>
<targets>
  <target partner="54">
    <actions>
      <action>inhibitor</action>
    </actions>
  </target>
</targets>
  </drug>
<partners>
<partner id="54">
  <name>Prothrombin</name>
  <general-function>Involved in blood clotting cascade</general-function>
</partner>
  </partners> 
```

在这里，您可以看到药物相互作用标签，其中包含有关相互作用药物的信息。因此，当我删除药物相互作用标记时，我的解析器工作正常，但使用药物相互作用标记时，我得到 NullPointerException。

错误行：

```
if(nameElement.getChildNodes().item(0).getNodeValue().equals(str)) 
```

我把解析器的整个代码放在这里。你也可以自己试试。为什么我会收到此错误，我该如何解决？对不起，很长的帖子。谢谢

```
import java.io.File;
import java.util.ArrayList;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class xmlParser {

public static void main(String argv[]) {
    getDrug("Lepirudin");
}

public static void getDrug(String str){
    ArrayList<String> arr = new ArrayList();
    String trgts = "";
    try {
        File file = new File("test.xml");
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DocumentBuilder db = dbf.newDocumentBuilder();
        Document doc = db.parse(file);
        doc.getDocumentElement().normalize();
        System.out.println("Root element " + doc.getDocumentElement().getNodeName());

        NodeList drugList = doc.getElementsByTagName("drug");

        for (int s = 0; s < drugList.getLength(); s++) {

            Node drugNode = drugList.item(s);

            if (drugNode.getNodeType() == Node.ELEMENT_NODE) {

                Element drugElement = (Element) drugNode;

                Element nameElement = (Element) drugElement.getElementsByTagName("name").item(0);

                if(nameElement.getChildNodes().item(0).getNodeValue().equals(str)){
                    System.out.println("Name : " + nameElement.getChildNodes().item(0).getNodeValue());

                    Element drugNodeElement = (Element) drugElement.getElementsByTagName("drugbank-id").item(0);
                    System.out.println("ID : "  + drugNodeElement.getChildNodes().item(0).getNodeValue());

                    /////////////////////////////////////////////////
                    NodeList targetList = (NodeList) drugElement.getElementsByTagName("target");
                    for(int t=0; t<targetList.getLength(); t++)     
                    {
                        Node targetNode = targetList.item(t);
                        if(targetNode.getNodeType() == Node.ELEMENT_NODE)
                        {
                            Element targetElement = (Element) targetNode;

                            if(targetElement.getAttribute("position").equals(""))
                            {
                                System.out.println("target partner: " + targetElement.getAttribute("partner"));
                            }
                            else
                            {
                                System.out.println("target position: "+ targetElement.getAttribute("position")+ "target partner: "+ targetElement.getAttribute("partner"));

                            }
                            arr.add(targetElement.getAttribute("partner"));

                        }
                    }

                    System.out.println("-------------------------");

                }
            }

        }
        NodeList partnersList = doc.getElementsByTagName("partners");

        for (int q = 0; q < partnersList.getLength(); q++)
        {

            Node partnersNode = partnersList.item(q);
            if (partnersNode.getNodeType() == Node.ELEMENT_NODE) {
                Element partnersElement = (Element) partnersNode;
                NodeList partnerList = (NodeList) partnersElement.getElementsByTagName("partner");

                for(int w=0; w<partnerList.getLength(); w++)        
                {

                    Node partnerNode = partnerList.item(w);
                    if(partnerNode.getNodeType() == Node.ELEMENT_NODE)
                    {
                        Element partnerElement = (Element) partnerNode;

                        if(arr.contains(partnerElement.getAttribute("id"))){
                            Element partnernameElement = (Element) partnerElement.getElementsByTagName("name").item(0);
                            trgts += partnernameElement.getChildNodes().item(0).getNodeValue() + "," ;
                        }
                    }
                }
            }

        }

        trgts = trgts.substring(0, trgts.length()-1);
        System.out.println(trgts);

    } catch (Exception e) {
        e.printStackTrace();
    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T19:54:17.443

空指针异常意味着您试图在空指针上执行函数。我建议你做的是弄清楚你得到的笔记有多远。一次删除每个函数调用，直到你弄清楚 null 是如何发生的，看看你是否能弄清楚为什么这个值返回 null。

```
nameElement.getChildNodes().item(0).getNodeValue().equals(str) 
```

# vbscript - vbs 通过双击运行，从任务调度程序运行时冻结

> ID：13405029
> 
> 赞同：2
> 
> 时间：2012-11-15T19:49:48.117
> 
> 标签：vbscript, task, scheduler

我有一个从多台远程计算机复制文件的 .vbs 脚本。每台服务器都有一个共享文件夹，我将其映射为网络驱动器 (W:)。当我通过双击运行它时，它运行良好，但如果我从任务计划程序（Win Server 2003）运行它，它会挂在这一行：

NetworkObject.MapNetworkDrive "W:", "\xxx.xxx.xxx.xxx\sharename", false, [用户名], [密码]

我已经尝试了一切，但我不知道为什么它不能在任务调度程序中运行。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:28:37.013

您是否尝试像这样运行它：

```
C:\Windows\system32\cscript.exe yourscript.vbs 
```

# php - Salesforce Soap API，查询不返回布尔字段的值

> ID：13405033
> 
> 赞同：1
> 
> 时间：2012-11-15T19:50:05.580
> 
> 标签：php, api, boolean, salesforce

我有一个没有错误的销售人员查询。我可以使用除布尔字段之外的所有数据。我想根据 cfl_No_Advance_Sales__c 字段的值（真或假）显示不同的信息。如果我尝试只显示字段的值，我什么也得不到。这是代码：

* * *

```
 $query = "Select Id, Name, IsDeleted, LastActivityDate, cfl_Door_Price__c, cfl_Advance_Ticket__c, cfl_Start_Time__c, cfl_Event_Date__c, cfl_BPT_Event_ID__c, cfl_Location__c, cfl_Event_Status__c, LastModifiedDate, cfl_No_Advance_Sales__c, cfl_Total_Advance_Tickets__c FROM cfl_Caffe_Events__c where cfl_Event_Date__c >= ".$tday." and IsDeleted = FALSE and (cfl_Event_Status__c != 'Cancelled') order by cfl_Event_Date__c asc LIMIT 5 ";

$response = $mySforceConnection->query($query);
// QueryResult object is only for PARTNER client
$queryResult = new QueryResult($response);
foreach ($queryResult->records as $record) {

//lots more code in here that works just fine

echo " $".$record->cfl_Door_Price__c." door</div>";
  //check if no advanced sales
print '<br> No Advanced ticket sales value is:'.$record->cfl_No_Advance_Sales__c;

  if ($record->cfl_No_Advance_Sales__c != "False") {
  echo "<div class='etickets'><a href='/events-calendar/event-detail/?id=".$record->Id."'>TICKETS</a></div>"; 
  }else{
       echo "<div class='etickets'>NO ADVANCED TICKETS</div>";
  }
} 
```

* * *

**打印出来是这样的...**

3元门

否 高级门票销售价值为：TICKETS

* * *

谢谢你的帮助。

# asp.net-mvc - Web API 和 Ninject 过滤器导致序列不包含任何元素

> ID：13405038
> 
> 赞同：1
> 
> 时间：2012-11-15T19:50:22.990
> 
> 标签：asp.net-mvc, asp.net-web-api, ninject

我在尝试将过滤器与 Web api 控制器中的所有操作绑定时不断收到此错误。我正在使用 Ninject 3.0 和 ASP.NET MVC 4。

```
<Response>
<Message>An error has occurred.</Message>
<ExceptionMessage>Sequence contains no elements</ExceptionMessage>
<ExceptionType>System.InvalidOperationException</ExceptionType>
<StackTrace>
at System.Linq.Enumerable.Single[TSource](IEnumerable`1 source) at Ninject.Web.WebApi.FilterBindingSyntax.FilterFilterBindingBuilder`1.<>c__DisplayClass15`1.<WithConstructorArgumentFromActionAttribute>b__14(IContext ctx, HttpConfiguration controllerContext, HttpActionDescriptor actionDescriptor) in d:\Projects\Ninject.Web.WebApi\src\Ninject.Web.WebApi\FilterBindingSyntax\FilterFilterBindingBuilder.cs:line 385 at Ninject.Web.WebApi.FilterBindingSyntax.FilterFilterBindingBuilder`1.<>c__DisplayClass12.<WithConstructorArgument>b__11(IContext ctx) in d:\Projects\Ninject.Web.WebApi\src\Ninject.Web.WebApi\FilterBindingSyntax\FilterFilterBindingBuilder.cs:line 363 at Ninject.Parameters.Parameter.<>c__DisplayClass6.<.ctor>b__4(IContext ctx, ITarget target) in c:\Projects\Ninject\ninject\src\Ninject\Parameters\Parameter.cs:line 60 at Ninject.Parameters.Parameter.GetValue(IContext context, ITarget target) in c:\Projects\Ninject\ninject\src\Ninject\Parameters\Parameter.cs:line 89 at 
```

**BaseApiController.cs**

```
[ExceptionHandling, ApiValidation, HttpHeader("X-Robots-Tag", "noindex, nofollow")]
    public abstract class BaseApiController : System.Web.Http.ApiController
    {
        protected readonly IApiAuthenticationService ApiAuthenticationService;

        protected BaseApiController(
            IApiAuthenticationService apiAuthenticationService)
        {
            ApiAuthenticationService = apiAuthenticationService;
        }
    } 
```

**全球.asax**

```
kernel.BindHttpFilter<HttpHeaderFilter>(System.Web.Http.Filters.FilterScope.Controller)
                       .WhenControllerHas<HttpHeaderAttribute>()
                       .WithConstructorArgumentFromActionAttribute<HttpHeaderAttribute>("name", q => q.Name)
                       .WithConstructorArgumentFromActionAttribute<HttpHeaderAttribute>("value", q => q.Value); 
```

**HttpHeaderFilter.cs**

```
using System;
using System.Net.Http;
using System.Threading;
using System.Threading.Tasks;
using System.Web.Http.Controllers;

namespace Tournaments.Models.Mvc.Filters
{
    public class HttpHeaderAttribute : System.Web.Http.Filters.FilterAttribute 
    {
        public string Name { get; set; }
        public string Value { get; set; }

        public HttpHeaderAttribute(string name, string value)
        {
            Name = name;
            Value = value;
        }
    }

    public class HttpHeaderFilter : System.Web.Http.Filters.IActionFilter
    {
        private readonly string _name;
        private readonly string _value;

        public HttpHeaderFilter(string name, string value)
        {
            _name = name;
            _value = value;
        }

        public bool AllowMultiple
        {
            get { return false; }
        }

        public Task<HttpResponseMessage> ExecuteActionFilterAsync(HttpActionContext actionContext, CancellationToken cancellationToken, Func<Task<HttpResponseMessage>> continuation)
        {
            actionContext.Response.Headers.Add(_name, _value);

            return continuation();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T02:00:09.230

您的属性在控制器上。您必须`WithConstructorArgumentFromControllerAttribute`在这种情况下使用。

# django - 过滤具有空条件的查询集

> ID：13405045
> 
> 赞同：0
> 
> 时间：2012-11-15T19:50:56.710
> 
> 标签：django, django-models

我想过滤今天启用的记录：

```
today = datetime.today().date()
dataset = Structure.objects.exclude(final_date__lt=today).filter(initial_date__lte=today) 
```

上面的代码在初始和最后一天都被填满的情况下工作正常。

考虑到 final_date 可以为 null ，我该如何构造过滤器？

或者这个查询有更好的结构吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:07:50.067

如果我理解这一点，您想过滤`final_date`值和空值。是吗？

您可以使用 Q 对象进行过滤。

```
from django.db.models import Q

dataset = Structure.objects.filter(Q(final_date__lt=today) | Q(final_date__isnull=True)).filter(initial_date__lte=today) 
```

# perl - 程序意外停止时如何自动删除使用 File::Temp 创建的文件？

> ID：13405047
> 
> 赞同：4
> 
> 时间：2012-11-15T19:50:59.720
> 
> 标签：perl

我正在使用 File::Temp 创建临时文件。当程序正常退出时，我的临时文件会自动删除。我希望当我的程序用 ctrl+c 停止时也会发生同样的情况。它不是。

这是一个演示我的问题的简单程序。

期望的行为是这样的。我怎样才能实现它？我在 Linux 上。

*   关闭文件句柄时不会删除临时文件（确定）
*   程序正常退出时临时文件被删除（好的）
*   当程序使用 ctrl+c 退出时临时文件被删除（不工作）

.

```
#!/usr/bin/perl -l

use warnings; use strict;
use File::Temp qw(tempfile tmpfile);

my $fh = File::Temp->new;
close $fh;

-f "$fh" || die "$fh does not exist"; 
print "hit enter and the file will be deleted";
print "hit ctrl+c and it won't";
print "verify with ls $fh after program exits";
readline STDIN; 
```

编辑 1

我测试了 tempfile 的行为。似乎确认 Linux 支持我正在寻找的内容（将文件标记为临时/取消链接打开文件）。我似乎以某种方式理想化了 File::Temp 。

```
# program will die because os deletes tmpfile after close
my $fh = tempfile;
close $fh;
stat $fh || die;
readline STDIN; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:47:45.600

要使 Control_C 键盘中断运行您的`END`块，您需要添加一个信号处理程序。比较以下行为：

```
perl -E 'END{say "END"};<STDIN>' 
```

和：

```
perl -E '$SIG{INT}=sub{die};END{say "END"};<STDIN>' 
```

从[perlmod](http://perldoc.perl.org/perlmod.html)

```
An END code block is executed as late as possible, that is, after perl has
finished running the program and just before the interpreter is being exited,
even if it is exiting as a result of a die() function. (But not if it's
morphing into another program via exec, or being blown out of the water by a
signal--you have to trap that yourself (if you can).) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:34:35.503

您是否尝试过将清理代码放入和 END 块中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T15:14:02.067

我查看了源代码。我什至检查了最新版本（写作时为 0.22）。我想用 File::Temp 做什么是设计不允许的。

创建对象时，使用数组上下文创建临时文件，如下所示：

```
sub new {
  ...
  # Open the file and retain file handle and file name
  my ($fh, $path) = tempfile( @template, %args ); 
```

在数组上下文中创建临时文件意味着该文件永远不会自动取消链接（即使在支持它的平台上）。该文件被标记为延迟取消链接，这意味着当程序正常退出时它将被删除。

```
sub tempfile { 
  ...
  _deferred_unlink($fh, $path, 0) if $options{"UNLINK"};

  # Return
  if (wantarray()) {

    if ($options{'OPEN'}) {
      return ($fh, $path);
    } else {
      return (undef, $path);
    }

  } else {

    # Unlink the file. It is up to unlink0 to decide what to do with
    # this (whether to unlink now or to defer until later)
    unlink0($fh, $path) or croak "Error unlinking file $path using unlink0";

    # Return just the filehandle.
    return $fh;
  } 
```

如果我想继续使用 File::Temp，我需要设置一个信号处理程序以在我的程序中止时强制清理。如果对可移植性有任何顾虑，我还应该设置一个 sig 处理程序，因为在某些平台上只提供了延迟取消链接。好消息是， File::Temp 创建了一个 END 块，所以根本不需要做太多事情：

```
use sigtrap qw(die normal-signals error-signals); 
```

如果可移植性不是问题并且平台支持自动文件清理，那么使用 tempfile 是可以的（在标量上下文中）。

以下评论很好地解释了这种设计背后的基本原理：

> 当我们打开文件时，我们必须指出临时性。**一般来说，如果我们只返回文件句柄，我们只需要一个真正的临时文件 - 如果用户想要文件名，他们可能不希望文件在关闭后立即消失（如果他们想要一个子进程，这可能很重要使用文件）**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:02:36.117

你真的需要文件名吗？如果没有，请使用

```
my $fh = tempfile(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-08T06:16:27.650

我一直在寻找类似的东西，我想我找到了一个相当不错的小解决方案。

它根本不是什么新东西，但可能比安装自己的`END`块等更简单：

```
use sigtrap qw(die INT); # ensures DESTROY methods are run on Ctrl-C

my $temp = File::Temp->new(UNLINK => 1);
my $filename = $temp->filename;
# When $temp goes out of scope, the file will be
# deleted, and $filename will be invalid.
# Further, a Ctrl-C will cause $temp->DESTROY to be invoked,
# which will also delete the temp file. 
```

# jquery - Ajax 调用未通过 GRAILS 控制器上的 withFormat->json

> ID：13405049
> 
> 赞同：4
> 
> 时间：2012-11-15T19:51:04.617
> 
> 标签：jquery, grails

我有一个 gsp 页面，其中包含一个执行 ajax 调用的 JS 函数（名为“sample”）。

```
function sample() {
         var params = { office: {id: "testId"}, population: {id: "testId2"}};

        $.ajax({
            url: "http://localhost:8080/officeProj/mustache/list",
            cache: false,
            contentType: "application/json; charset=utf-8",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(params),
            complete:function(json){
                console.log(" reponse :"+ json);
            },
            success: function(officeData) {
                var template = "<h1>{{data.firstName}} {{data.lastName}}</h1>";
                var html = Mustache.to_html(template, data);
                $('#sampleArea').html(html);
            } ,
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                console.log("error :"+XMLHttpRequest.responseText);
            }
        })

    } 
```

现在，这个 ajax 调用到达适当的 GRAILS 控制器和适当的操作，定义为：

```
def list = {

    withFormat {
        html { return [title: "Mustache" , data:[firstName:"Indiana", lastName:"Jones"], address:"NYC" ] }
        json {
            // extract the data to be rendered to the page
            println("processing JSON.....")
            render ([title: "Mustache" , data:[firstName:"Indiana", lastName:"Jones"], address:"NYC" ] as JSON)
        }
    }
} 
```

问题是控件从不通过控制器操作中的 withFormat->json ，因此我没有看到预期的结果。（当控件返回 gsp 页面时，它通过“完整”但不是通过“成功”。没有记录错误。任何人都可以看到我的ajax调用有什么问题吗？如果我需要提供更多信息，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-11T11:10:31.020

即使您的问题似乎已经解决，我还是想提一下这背后的实际原因。

问题似乎出在 grails 进行内容协商的方式上。

根据 grails 文档，grails 将寻找接受标头，这将决定响应格式。

但是这里的问题是，默认情况下，在 config.groovy 中，grails.mime.use.accept.header = false，它基本上忽略了接受标头，因此即使您在 ajax 请求中设置了 dataType:"json"（这反过来会将接受标头设置为“application/json”），它不会寻找接受标头并且响应格式将始终为“全部”，这是默认值。

所以基本上设置 grails.mime.use.accept.header = true，将解决这个问题。

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T21:20:45.987

这通常会引起人们的注意，尤其是在从 Grails 1.x 迁移到 Grails 2.x 时。你必须仔细阅读[docco](http://grails.org/doc/latest/ref/Controllers/withFormat.html)。

粗体字的重点是我的...

> 另一个需要注意的重要因素是 withFormat 方法处理的是**响应**格式而不是**请求**格式。从 Grails 2.0 开始，请求提供了一个单独的 withFormat 方法，您可以使用它来处理由请求的 CONTENT_TYPE 标头指定的请求格式：

```
request.withFormat {
    xml { .. }
    html { .. }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-07T19:17:14.223

另一个潜在的解决方案。

医生说：

> 请注意，**如果请求格式为“全部”**或多个内容类型在接受标头中具有相同的“q”等级，则类型的顺序很重要。在前一种情况下，**块中的第一个类型处理程序被执行**

我认为这意味着如果您的 Accept 标头如下所示：

`Accept:application/json, text/javascript, */*; q=0.01`

`*/*`表示**接受所有**，这意味着将使用第一个处理程序，而不管其余的。

快速解决方案：将 html {} 闭包移至最后。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-16T14:19:30.540

Grails 默认忽略浏览器的接受标头。阅读[内容协商](http://grails.github.io/grails-doc/2.3.4/guide/single.html#contentNegotiation)

> text/xml, application/xml, application/xhtml+xml, text/html;q=0.9, text/plain;q=0.8, image/png, */* ;q=0.5
> 
> 这个特殊的接受头是无用的，因为它表明 XML 是首选的响应格式，而用户真正期望的是 HTML。这就是为什么 Grails 默认忽略浏览器的接受标头的原因。

grails.mime.disable.accept.header.userAgents 控制哪些浏览器接受标题 grails 将忽略

# mysql - MySql 查询需要很长时间才能完成

> ID：13405051
> 
> 赞同：0
> 
> 时间：2012-11-15T19:51:09.060
> 
> 标签：mysql, database, logic

我有一个经典的 ASP 页面，其中有我的所有客户（大约 4,000 个），无论是否处于活动状态，我需要在 4 个不同的表中获取有关它们的信息。我目前的做法是，我的页面需要 3、4、5 分钟，具体取决于服务器的繁忙程度。有时我什至会在 asp 中收到一条消息，上面写着“超出了脚本执行的最长时间”。我的查询如下，
1\. 我得到了我的客户的个人信息
2\. 我得到了我的客户的销售额
3\. 在有了这些信息之后，我对我的客户数组进行了一个 for 循环以获取其他信息。在那个循环中，我做了 5 个不同的查询。

我获得的所有信息在我的页面中都是必需的。
做这一切的最好方法是什么？

## （我正在研究视图、触发器、功能/程序）

查询（法语）：1。

```
SELECT c.NoClient, c.NomClient, c.CodeClient, c.NoClientFront,c.NoVendeur,
c.VilleClient,c.DateOuverture",Telemarketing,Autre1 FROM Client c WHERE (left(c.CodeClient,1) = 'C' Or left(c.CodeClient,1) = 'N') ORDER BY c.NoClient

CREATE TABLE `client` (
  `NoClient` decimal(7,0) NOT NULL DEFAULT '0',
  `NoVendeur` decimal(3,0) NOT NULL DEFAULT '0',
  `NomClient` varchar(35) NOT NULL DEFAULT '',
  `AdresseClient` varchar(35) NOT NULL DEFAULT '',
  `VilleClient` varchar(30) NOT NULL DEFAULT '',
  `TelClient` varchar(10) NOT NULL DEFAULT '',
  `CodeClient` char(3) NOT NULL DEFAULT '',
  `PointPower` int(11) NOT NULL DEFAULT '0',
  `PrevisionYonka` int(11) NOT NULL DEFAULT '0',
  `PrevisionCollin` int(11) NOT NULL DEFAULT '0',
  `TerritoireClient` int(3) NOT NULL DEFAULT '0',
  `NoClientFront` int(7) NOT NULL DEFAULT '0',
  `PersonneContact` varchar(20) NOT NULL DEFAULT '',
  `CodeCredit` varchar(30) NOT NULL DEFAULT '',
  `CodePostalClient` varchar(10) NOT NULL DEFAULT '',
  `DateOuverture` date NOT NULL DEFAULT '0000-00-00',
  `Master` int(7) NOT NULL DEFAULT '0',
  `Telemarketing` varchar(20) NOT NULL DEFAULT '',
  `GammeAutorisee1` char(2) NOT NULL DEFAULT '',
  `GammeAutorisee2` char(2) NOT NULL DEFAULT '',
  `GammeAutorisee3` char(2) NOT NULL DEFAULT '',
  `GammeAutorisee4` char(2) NOT NULL DEFAULT '',
  `GammeAutorisee5` char(2) NOT NULL DEFAULT '',
  `MembrePower` char(1) NOT NULL DEFAULT '',
  `NoteLivreur1` varchar(35) NOT NULL DEFAULT '',
  `NoteLivreur2` varchar(35) NOT NULL DEFAULT '',
  `PlanAVenirYonka` int(11) NOT NULL DEFAULT '0',
  `PlanAVenirCollin` int(11) NOT NULL DEFAULT '0',
  `Autre1` varchar(50) NOT NULL COMMENT 'Langue du client',
  `Autre2` varchar(50) NOT NULL DEFAULT '',
  `NoteClient` text NOT NULL,
  `CompteInternet` int(1) unsigned NOT NULL,
  `DEI` varchar(10) NOT NULL,
  `Empty1` varchar(45) NOT NULL,
  `Empty2` varchar(45) NOT NULL,
  PRIMARY KEY (`NoClient`),
  KEY `CodeClient` (`CodeClient`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

2.

```
Select a.NoClient,a.Gamme,a.Vente,a.Annee,a.Mois,c.Dateouverture" from AchatClient a, Client c where c.NoClient = a.NoClient And a.Annee <= " & AnneeRanking
And a.Annee >= " & AnneeRanking - 1 order by a.NoClient

CREATE TABLE `achatclient` (
  `NoClient` int(10) DEFAULT NULL,
  `NoVendeur` int(3) DEFAULT NULL,
  `Gamme` char(1) DEFAULT NULL,
  `G1` char(1) DEFAULT NULL,
  `G2` char(1) DEFAULT NULL,
  `Annee` int(4) DEFAULT NULL,
  `Mois` int(2) DEFAULT NULL,
  `Vente` float(10,2) DEFAULT NULL,
  KEY `NoClient` (`NoClient`,`NoVendeur`),
  KEY `Vente` (`NoClient`,`Annee`,`Mois`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

**在我的 FOR 循环中**
a)

```
Select DatePlanification from planification where NoClient=" & client(i) 
And DatePlanification <= '" & todayDate & "' And Etat=0 Order by DatePlanification DESC limit 1 

CREATE TABLE `planification` (
  `NoPlanification` decimal(10,0) NOT NULL DEFAULT '0',
  `IDUsager` varchar(30) DEFAULT NULL,
  `NoClient` decimal(7,0) DEFAULT NULL,
  `DatePlanification` date DEFAULT NULL,
  `HeurePlanDebut` varchar(5) NOT NULL DEFAULT '',
  `HeurePlanFin` varchar(5) NOT NULL DEFAULT '',
  `LieuxPlanification` varchar(50) NOT NULL DEFAULT '',
  `TypePlanification` varchar(50) NOT NULL DEFAULT '',
  `NomPlanification` varchar(250) NOT NULL DEFAULT '',
  `Commentaire` text NOT NULL,
  `Confirmation` int(1) unsigned zerofill NOT NULL DEFAULT '0',
  `TypeContact` varchar(50) NOT NULL DEFAULT '',
  `GammeContact` varchar(50) NOT NULL DEFAULT '',
  `DetailPersonnel` text NOT NULL,
  `DetailPublic` text NOT NULL,
  `DateEntree` date DEFAULT NULL,
  `HeureEntree` time DEFAULT NULL,
  `DateModifie` date DEFAULT NULL,
  `HeureModifie` time DEFAULT NULL,
  `Autre1` varchar(50) NOT NULL DEFAULT '',
  `Autre2` varchar(50) NOT NULL DEFAULT '',
  `Etat` int(1) NOT NULL DEFAULT '0',
  `DateCheckIn` varchar(15) DEFAULT NULL,
  `TimeCheckIn` varchar(15) DEFAULT NULL,
  `PositionCheckIn` varchar(100) DEFAULT NULL,
  `DateCheckOut` varchar(15) DEFAULT NULL,
  `TimeCheckOut` varchar(15) DEFAULT NULL,
  `PositionCheckOut` varchar(100) DEFAULT NULL,
  `Empty1` varchar(45) DEFAULT NULL,
  `Empty2` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`NoPlanification`),
  KEY `IDUsager` (`IDUsager`,`DatePlanification`),
  KEY `DatePlanification` (`DatePlanification`),
  KEY `NoClient` (`NoClient`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

b)

```
Select DateVisite from visite_kterm where NoClient = " & Client(i)
order by DateVisite DESC limit 1
CREATE TABLE `visite_kterm` (
  `NoClient` int(7) DEFAULT NULL,
  `DateVisite` date DEFAULT NULL,
  `SequenceVisite` char(2) DEFAULT NULL,
  `Usager` varchar(20) DEFAULT NULL,
  `Description_1` varchar(72) DEFAULT NULL,
  `Description_2` varchar(72) DEFAULT NULL,
  `Description_3` varchar(72) DEFAULT NULL,
  `Description_4` varchar(72) DEFAULT NULL,
  `Description_5` varchar(72) DEFAULT NULL,
  `Description_6` varchar(72) DEFAULT NULL,
  `Description_7` varchar(72) DEFAULT NULL,
  KEY `NoClient` (`NoClient`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

C）

```
Select DatePlanification from Planification where NoClient=" & Client(i) 
And DatePlanification > '" & answerFromA & "' And Etat=0
Order by DatePlanification ASC limit 1; 
```

d)`SELECT DateFacture FROM listefactures where NoClient=" & client(i)`

```
CREATE TABLE `listefactures` (
  `NoFacture` varchar(7) NOT NULL DEFAULT '',
  `NoPrise` int(6) DEFAULT NULL,
  `NoClient` int(10) DEFAULT NULL,
  `PrisePar` varchar(10) DEFAULT NULL,
  `DateFacture` date DEFAULT NULL,
  `AdresseEnvoie` text,
  `Reference` varchar(10) DEFAULT NULL,
  `SousTotal` float(10,2) DEFAULT NULL,
  `Total` float(10,2) DEFAULT NULL,
  `Terme` varchar(20) DEFAULT NULL,
  `TaxePro` float(10,2) DEFAULT NULL,
  `TaxeFed` float(10,2) DEFAULT NULL,
  `Transporteur` varchar(20) DEFAULT NULL,
  `FraisTransport` float(10,2) DEFAULT NULL,
  `FraisManutention` float(10,2) DEFAULT NULL,
  `Ouverture` char(1) DEFAULT NULL,
  `FacturePower` char(1) DEFAULT NULL,
  `CodeCredit` int(3) unsigned NOT NULL,
  `RepOuverture` varchar(5) NOT NULL,
  PRIMARY KEY (`NoFacture`),
  KEY `NoClient` (`NoClient`,`Ouverture`),
  KEY `NoPrise` (`NoPrise`),
  KEY `DateFacture` (`DateFacture`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

e)

```
Select Email from SDS where NoCompte = " & Client(i) 
And Email like '%@%' And Email like '%.%';
CREATE TABLE `sds` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `NoCompte` int(11) NOT NULL DEFAULT '0',
  `Email` varchar(100) DEFAULT NULL,
  `SiteWeb` varchar(255) DEFAULT NULL,
  `NomProprietaire` varchar(100) DEFAULT NULL,
  `ageproprietaire` varchar(20) DEFAULT NULL,
  `StatutProprietaire` int(11) DEFAULT NULL,
  `NomProprietaireDuLocataire` text,
  `Localisation` int(11) DEFAULT NULL,
  `Situation` varchar(30) NOT NULL DEFAULT '',
  `ProprioEstEstheticienne` int(11) DEFAULT NULL,
  `Travailencabine` int(11) NOT NULL DEFAULT '0',
  `ProprioDepuis` varchar(5) NOT NULL DEFAULT '',
  `NomPersonneContact` varchar(100) DEFAULT NULL,
  `FonctionPersonneContact` int(11) DEFAULT NULL,
  `NbEstheticienne` int(11) DEFAULT NULL,
  `NbEmploye` int(11) DEFAULT NULL,
  `NbCabineFacial` int(11) DEFAULT NULL,
  `NbCabineCorporel` int(11) DEFAULT NULL,
  `NbCabineAutre` int(11) DEFAULT NULL,
  `NbCabineDouche` int(11) DEFAULT NULL,
  `NbCabineBain` int(11) NOT NULL DEFAULT '0',
  `NbCabineLitSolaire` int(11) NOT NULL DEFAULT '0',
  `SoinsOfferts` int(11) DEFAULT NULL,
  `Competition1` varchar(30) DEFAULT NULL,
  `Competition2` varchar(30) DEFAULT NULL,
  `Competition3` varchar(30) DEFAULT NULL,
  `Competition4` varchar(30) DEFAULT NULL,
  `Competition5` varchar(30) DEFAULT NULL,
  `PotentielClient` varchar(15) DEFAULT NULL,
  `EtatVitrine` int(11) DEFAULT NULL,
  `EtatComptoireVitre` int(11) DEFAULT NULL,
  `EtatEtalageMur` int(11) DEFAULT NULL,
  `SurfaceIncitante` int(11) DEFAULT NULL,
  `PopulationVille` int(11) DEFAULT NULL,
  `NbCliniqueExistante` int(11) DEFAULT NULL,
  `NbCliniqueNotre` int(11) DEFAULT NULL,
  `ParticulariteVille` text NOT NULL,
  `DateMAJ` date DEFAULT NULL,
  `Email1` varchar(100) NOT NULL DEFAULT '',
  `Contact1` varchar(50) NOT NULL DEFAULT '',
  `titre1` varchar(50) NOT NULL DEFAULT '',
  `Email2` varchar(100) NOT NULL DEFAULT '',
  `Contact2` varchar(50) NOT NULL DEFAULT '',
  `titre2` varchar(50) NOT NULL DEFAULT '',
  `Email3` varchar(100) NOT NULL DEFAULT '',
  `Contact3` varchar(50) NOT NULL DEFAULT '',
  `titre3` varchar(50) NOT NULL DEFAULT '',
  `Email4` varchar(100) NOT NULL DEFAULT '',
  `Contact4` varchar(50) NOT NULL DEFAULT '',
  `titre4` varchar(50) NOT NULL DEFAULT '',
  `statutProspect` int(3) unsigned NOT NULL,
  `dei` int(4) unsigned NOT NULL DEFAULT '0',
  `deivalue` float NOT NULL DEFAULT '0',
  PRIMARY KEY (`ID`,`NoCompte`)
) ENGINE=MyISAM AUTO_INCREMENT=7356 DEFAULT CHARSET=latin1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:56:54.957

我将您的所有查询合二为一。我做了一些假设，比如每个客户只需要一条记录。需要添加的变量在花括号中。

```
SELECT NoClient, Gamme, Vente, Annee, Mois, Dateouverture, NomClient, CodeClient,
    NoClientFront, NoVendeur, VilleClient, DateOuverture, Telemarketing, Autre1,
    MAX(DatePlanification) AS DatePlanification, MAX(DateVisite ) AS DateVisite, Email
FROM Client
    JOIN AchatClient USING (NoClient)
    JOIN planification USING (NoClient)
    JOIN visite_kterm USING (NoClient)
    JOIN DateFacture USING (NoClient)
    LEFT JOIN SDS ON (NoClient = NoCompte)
WHERE (CodeClient LIKE 'C%' OR CodeClient LIKE 'N%')
    AND Annee BETWEEN {AnneeRanking} AND {AnneeRanking - 1}
    AND DatePlanification <= {todayDate}
    AND Etat=0
    AND Email like '%@%' AND Email like '%.%'
GROUP BY NoClient
ORDER BY NoClient 
```

该查询将受益于如下所列的索引：

```
SDS - single index on `NoCompte`
planification - make the `NoClient` index composite like (`NoClient`, `DatePlanification`)
achatclient - single index on `Annee` 
```

此外，将所有`NoClient`列设为其中一种`INT`类型。

使用这样的单个查询应该比大量的串行查询快得多*。*您可能需要根据数据将一些`JOIN`s 切换为`LEFT JOIN`s。

# python - SciPy leastsq 适合正弦波失败

> ID：13405053
> 
> 赞同：5
> 
> 时间：2012-11-15T19:51:25.343
> 
> 标签：python, scipy, curve-fitting

我想弄清楚我在这里不明白的是什么。

我正在关注[http://www.scipy.org/Cookbook/FittingData](http://www.scipy.org/Cookbook/FittingData)并尝试拟合正弦波。真正的问题是卫星磁力计数据，它在旋转的航天器上产生了很好的正弦波。我创建了一个数据集，然后试图适应它来恢复输入。

这是我的代码：

```
import numpy as np
from scipy import optimize

from scipy.optimize import curve_fit, leastsq

import matplotlib.pyplot as plt

class Parameter:
    def __init__(self, value):
            self.value = value

    def set(self, value):
            self.value = value

    def __call__(self):
            return self.value

def fit(function, parameters, y, x = None):
    def f(params):
        i = 0
        for p in parameters:
            p.set(params[i])
            i += 1
        return y - function(x)

    if x is None: x = np.arange(y.shape[0])
    p = [param() for param in parameters]
    return optimize.leastsq(f, p, full_output=True, ftol=1e-6, xtol=1e-6)

# generate a perfect data set (my real data have tiny error)
def mysine(x, a1, a2, a3):
    return a1 * np.sin(a2 * x + a3)

xReal = np.arange(500)/10.
a1 = 200.
a2 = 2*np.pi/10.5  # omega, 10.5 is the period
a3 = np.deg2rad(10.) # 10 degree phase offset
yReal = mysine(xReal, a1, a2, a3)

# plot the real data
plt.figure(figsize=(15,5))
plt.plot(xReal, yReal, 'r', label='Real Values')

# giving initial parameters
amplitude = Parameter(175.)
frequency = Parameter(2*np.pi/8.)
phase = Parameter(0.0)

# define your function:
def f(x): return amplitude() * np.sin(frequency() * x + phase())

# fit! (given that data is an array with the data to fit)
out = fit(f, [amplitude, frequency, phase], yReal, xReal)
period = 2*np.pi/frequency()
print amplitude(), period, np.rad2deg(phase())

xx = np.linspace(0, np.max(xReal), 50)
plt.plot( xx, f(xx) , label='fit')
plt.legend(shadow=True, fancybox=True) 
```

这使得这个情节： ![在此处输入图像描述](../Images/61d952ebeeb0aa4e7ebac8a4065511ab.png)

恢复的拟合参数`[44.2434221897 8.094832581 -61.6204033699]`与我开始时的没有相似之处。

对我不理解或做错的事情有任何想法吗？

```
scipy.__version__
'0.10.1' 
```

* * *

编辑：建议修复一个参数。在上面的示例中，将幅度固定为`np.histogram(yReal)[1][-1]`仍然会产生不可接受的输出。适合：`[175.0 8.31681375217 6.0]`我应该尝试不同的拟合方法吗？对哪方面的建议？

![在此处输入图像描述](../Images/a4e64678e2b74d497782c93664382fe0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:13:38.567

下面是一些代码实现了Zhenya 的一些想法。它用

```
yhat = fftpack.rfft(yReal)
idx = (yhat**2).argmax()
freqs = fftpack.rfftfreq(N, d = (xReal[1]-xReal[0])/(2*pi))
frequency = freqs[idx] 
```

猜测数据的主要频率，以及

```
amplitude = yReal.max() 
```

猜测幅度。

* * *

```
import numpy as np
import scipy.optimize as optimize
import scipy.fftpack as fftpack
import matplotlib.pyplot as plt
pi = np.pi
plt.figure(figsize = (15, 5))

# generate a perfect data set (my real data have tiny error)
def mysine(x, a1, a2, a3):
    return a1 * np.sin(a2 * x + a3)

N = 5000
xmax = 10
xReal = np.linspace(0, xmax, N)
a1 = 200.
a2 = 2*pi/10.5  # omega, 10.5 is the period
a3 = np.deg2rad(10.) # 10 degree phase offset
print(a1, a2, a3)
yReal = mysine(xReal, a1, a2, a3) + 0.2*np.random.normal(size=len(xReal))

yhat = fftpack.rfft(yReal)
idx = (yhat**2).argmax()
freqs = fftpack.rfftfreq(N, d = (xReal[1]-xReal[0])/(2*pi))
frequency = freqs[idx]

amplitude = yReal.max()
guess = [amplitude, frequency, 0.]
print(guess)
(amplitude, frequency, phase), pcov = optimize.curve_fit(
    mysine, xReal, yReal, guess)

period = 2*pi/frequency
print(amplitude, frequency, phase)

xx = xReal
yy = mysine(xx, amplitude, frequency, phase)
# plot the real data
plt.plot(xReal, yReal, 'r', label = 'Real Values')
plt.plot(xx, yy , label = 'fit')
plt.legend(shadow = True, fancybox = True)
plt.show() 
```

产量

```
(200.0, 0.5983986006837702, 0.17453292519943295)   # (a1, a2, a3)
[199.61981404516041, 0.61575216010359946, 0.0]     # guess
(200.06145097308041, 0.59841420869261097, 0.17487141943703263) # fitted parameters 
```

请注意，通过使用 fft，对频率的猜测已经非常接近最终拟合参数。

看来您不需要修复任何参数。通过使频率猜测更接近实际值，`optimize.curve_fit`能够收敛到一个合理的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:19:19.410

From what I can see from playing a bit with `leastsq` (without fancy stuff from the cookbook, just plain direct calls to `leastsq` --- and by the way, `full_output=True` is your friend here), is that it's very hard to fit all three of the amplitude, frequency and phase in one go. On the other hand, if I fix the amplitude and fit the frequency and phase, it works; if I fix the frequency and fit the amplitude and phase, it works too.

There is more than one way out here. What might be the simplest one --- if you are sure you only have one sine wave (and this is easy to check with the Fourier transform), then you know the frequency from just the distance between consecutive maxima of your signal. Then fit the two remaining parameters.

If what you have is a mixture of several harmonics, well, again, Fourier transform will tell you that.

# java - 在不跟随'\'的分隔符处拆分字符串

> ID：13405054
> 
> 赞同：1
> 
> 时间：2012-11-15T19:51:25.420
> 
> 标签：java, regex, string, split

我正在寻找一种在某个分隔符出现时将字符串分成两部分的方法。我知道当字符串看起来像这样时，这很容易做到：

```
String s = "prefix.key value";
String[] a = s.split("[ :=]",2); 
```

但按照惯例，字符串可能包含转义的分隔符（在分隔符前面直接带有 '\'）。所以我更新了正则表达式字符串：

```
String s = "prefix\ key value";
String[] a = s.split("[^\\\\][ :=]",2); 
```

这会在几乎正确的位置拆分字符串，但会切断键的“y”。这是因为现在正则表达式匹配分隔符和它前面的字符。split() 方法会删除匹配的部分，只返回剩余的字符串。

我有一个使用 split() 并查看返回数组中字符串的结束字符的工作解决方案，但这似乎是一种过于复杂和缓慢的方法。

有没有人有更好的主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T19:55:27.503

使用[否定的lookbehind断言](http://www.regular-expressions.info/lookaround.html)

```
String[] a = s.split("(?<!\\\\)[ :=]",2); 
```

所以你的字符类只有在它前面没有a时才会匹配`\`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:19:27.907

我会在stema的回答下发表评论，但我还不能发表评论。我只是想建议对呈现的正则表达式进行小改动。

```
(?<!\\)[ :=] 
```

否则转义码将需要两个反斜杠，而不仅仅是一个。

# c - 我应该在 C 中声明系统调用函数吗？

> ID：13405058
> 
> 赞同：4
> 
> 时间：2012-11-15T19:51:46.113
> 
> 标签：c, linux, function, declaration, system-calls

我读了这个答案： [必须在 C 中声明函数原型？](https://stackoverflow.com/questions/2575153/must-declare-function-prototype-in-c)

我的问题更具体：

在使用系统调用（如`access()`, `open()`, `creat()`, `write()`, `read()`...）的程序中，我必须声明每个系统调用函数吗？C是这样工作的吗？因为我得到以下信息：

```
hw1.c: In function ‘main’:
hw1.c:50:9: warning: implicit declaration of function ‘access’ [-Wimplicit-function-declaration]
hw1.c:131:9: warning: implicit declaration of function ‘lseek’ [-Wimplicit-function-declaration]
hw1.c: In function ‘writeFile’:
hw1.c:159:17: warning: implicit declaration of function ‘write’ [-Wimplicit-function-declaration] 
```

基本上，C 似乎对我使用的每个系统调用函数都很生气。我对 C 有点陌生，这对我来说似乎很奇怪，即使我知道我必须声明我编写的函数我会认为 C 会知道系统调用函数并且不需要我在代码中显式声明它们。

我需要做这样的事情吗：

`int access(const char *pathname, int mode);`

如果是这样，那为什么有意义？我使用其他语言，从不需要这样做。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-15T19:55:10.647

是的，您应该为您进行的每个系统函数调用包含正确的标头。你不自己写声明——你会弄错的。使用标题！

对于您引用的函数，相关标题是：

```
#include <unistd.h>  /* Many POSIX functions (but not all, by a large margin) */
#include <fcntl.h>   /* open(), creat() - and fcntl() */ 
```

请参阅[POSIX 2008](http://pubs.opengroup.org/onlinepubs/9699919799/toc.htm)以找到其他 POSIX 函数的正确标头。

C99 标准要求在使用所有函数之前声明或定义它们。

* * *

对于您自己的功能，您应该模拟“系统”。将有一个声明函数的头文件、实现它的源文件以及使用该函数的其他源文件。其他源文件使用标题来获得正确的声明。实现文件包含头文件以确保其实现与其他源文件所期望的一致。所以标题是将它们粘合在一起的粘合剂。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T19:56:57.747

你不必声明每一个，就其本身而言。您需要做的是包含包含这些函数声明的正确头文件。例如：

```
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h> 
```

`stdio.h`, `fcntl.h`, 和`unistd.h`（假设您正在为 *nix 编码）是您提到的功能所需的。有关详细信息，请查阅您的文档（即`man lseek`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T19:55:29.407

除了一组“核心”库之外，几乎所有语言都必须这样做。Java、C#、Perl 等都有 or 的形式，`import`或者`use`在构建配置中进行引用，或者......对于核心库之外的东西。C 没有什么不同，除了它有一个*非常*小的（即不存在的）“核心库”——默认情况下没有包含任何库头文件。

`#include`就是你要找的。检查每个函数的手册页，您就会知道需要包含哪些标题。

# android - 如何在 pre-Honeycomb 设备上使用三参数版本构造函数运行自定义视图？

> ID：13405061
> 
> 赞同：0
> 
> 时间：2012-11-15T19:51:57.140
> 
> 标签：android, android-linearlayout, android-custom-view

我有一个自定义视图，它使用以下构造函数扩展了 LinearLayout：

```
public VoiceRecorderLayout(Context context)
{
    this(context, null);
}

public VoiceRecorderLayout(Context context, AttributeSet attrs) {
    this(context, attrs, 0);
    }

    public VoiceRecorderLayout(Context context, AttributeSet attrs, int defStyle) 
{       
    super(context, attrs, defStyle);
    this.context = context;   
    loadViews();    
} 
```

仅当我在 api 低于 11 的设备或模拟器上运行它时，我的应用程序才会崩溃。崩溃的原因是我在 android 开发人员 google 组中找到的三参数构造函数：

```
**"The three-argument version of LinearLayout constructor is only available with API 11 and higher -- i.e. Android 3.0.
This dependency has to be satisfied at runtime by the actual Android version running on the device."** 
```

有没有办法可以在旧设备（例如 android 2.3.3）中使用此视图？

这是一个日志猫：

```
11-15 13:34:20.121: E/AndroidRuntime(408): Caused by: java.lang.reflect.InvocationTargetException
11-15 13:34:20.121: E/AndroidRuntime(408):  at java.lang.reflect.Constructor.constructNative(Native Method)
11-15 13:34:20.121: E/AndroidRuntime(408):  at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
11-15 13:34:20.121: E/AndroidRuntime(408):  at android.view.LayoutInflater.createView(LayoutInflater.java:505)
11-15 13:34:20.121: E/AndroidRuntime(408):  ... 21 more
11-15 13:34:20.121: E/AndroidRuntime(408): Caused by: java.lang.NoSuchMethodError: android.widget.LinearLayout.<init>
11-15 13:34:20.121: E/AndroidRuntime(408):  at edu.neiu.voiceofchicago.support.VoiceRecorderLayout.<init>(VoiceRecorderLayout.java:102)
11-15 13:34:20.121: E/AndroidRuntime(408):  at edu.neiu.voiceofchicago.support.VoiceRecorderLayout.<init>(VoiceRecorderLayout.java:97)
11-15 13:34:20.121: E/AndroidRuntime(408):  ... 24 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T20:05:00.447

In cases like this, it is easier not to chain the constructors, and place your custom setup code into an `init()` style method so that you don't have to try and branch your code based on platform version.

```
public VoiceRecorderLayout(Context context) {
    super(context);
    init(context);
}

public VoiceRecorderLayout(Context context, AttributeSet attrs) {
    super(context, attrs);
    init(context);
}

public VoiceRecorderLayout(Context context, AttributeSet attrs, int defStyle) {       
    super(context, attrs, defStyle);
    init(context);
}

private void init(Context context) {
    this.context = context;   
    loadViews();    
} 
```

# javascript - 在 HTML5 上最大化粒子渲染的速度

> ID：13405063
> 
> 赞同：8
> 
> 时间：2012-11-15T19:51:59.040
> 
> 标签：javascript, html, html5-canvas, sprite, webgl

我正在做一个实验，并试图在 HTML5 Canvas 的帧速率开始下降之前提高最大粒子数。

我正在使用 requestAnimationFrame，我正在使用画布中的 drawImage，因为这似乎是渲染图像的最快方法（在 jsPerf 上测试过）。

这里有一个工作的jsFiddle：http: [//fiddle.jshell.net/bewYC/5/](http://fiddle.jshell.net/bewYC/5/)

您可能需要刷新或重新运行几次才能使其正常工作（不知道为什么，但它只是不想在第一页加载时运行。）

照原样，我运行 Chrome 22 的计算机可以在大约 5,000 个粒子的情况下保持 60FPS。随着每一步，FPS开始下降。如果我删除 drawImage() 并只计算粒子的位置，我的处理器直到超过 10 倍的粒子才会达到最大值。

我想知道的是：有没有比使用带有drawImage的循环更快的方法来渲染大量粒子（例如40,000个）？我特别想了解有关 JavaScript/Canvas 的知识，但如果您只了解另一种语言，例如 Java 或 C#，那么无论如何请分享。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T02:59:14.043

对于这个问题，使用 WebGL（或其他适合您平台的“3D”API）几乎总是最好的方法。在移动位置合成大量图像（更确切地说是“纹理”）正是图形硬件的设计目标。现代浏览器确实使用 GPU 加速来执行 2D-Canvas 绘图操作，但仍然有 JavaScript 请求绘制每个单独的图像，这就是问题所在。

我建议你看看 WebGL——对于像粒子系统这样简单的东西，编程一点也不难，而且你可以轻松地渲染数千个粒子。您的 JavaScript 只是提供了一个包含所有粒子位置的数组。

一种先进的技术是将粒子的模拟也放在 GPU 上，因此根本不需要 JavaScript 来执行每个粒子。我自己在我的[GLToy](https://github.com/kpreid/gltoyjs)中编写了一个 GPU 粒子模拟器。[在这里，它配置了 80,000 个粒子](http://kpreid.github.com/gltoyjs/gltoy.html#effect=particles&pj.numParticles=80000&ps.shape=soft&ps.motion=harmonic&pj.nearView=false)，在我的笔记本电脑上达到了 60 FPS。事实上，该特定配置的限制是平滑粒子的填充率；如果我们只使用点，我可以将它推到[300,000 个粒子](http://kpreid.github.com/gltoyjs/gltoy.html#effect=particles&pj.numParticles=300000&ps.shape=square&ps.motion=harmonic&pj.nearView=false)。而且我不是图形编程的巫师；我敢肯定，确切知道该做什么的人可以将其推得更远。

（当我修改 GLToy 时，PS 链接可能很脆弱；如果您没有得到指定的效果，请告诉我，以便我修复链接。）

# java - Java - 如果时间匹配时语句不起作用

> ID：13405064
> 
> 赞同：-1
> 
> 时间：2012-11-15T19:52:09.543
> 
> 标签：java, if-statement, time

> **可能重复：**
> [如果使用 == 的语句给出了意外的结果](https://stackoverflow.com/questions/9870985/if-statement-using-gives-unexpected-result)

我正在研究一个 java 代码，如果你在代码中设置的时间和系统中的实时时间相等，它会做一些事情。如果时间不匹配，它会完全忽略它。现在我可以正确地得到时间，但由于某种原因，if 语句说它不相等，即使它是。我有什么遗漏或做错了吗？

```
Calendar now = new GregorianCalendar();
String am_pm;     
int hour = now.get(Calendar.HOUR);
int minute = now.get(Calendar.MINUTE);
if (now.get(Calendar.AM_PM) == 0){
    am_pm = "AM";  
}
else{
    am_pm = "PM";
}
String time = hour + ":" + minute + " " + am_pm;        
String Scan_hour = "2:45 PM";       
System.out.println(time + "--" + Scan_hour);    
if (time == Scan_hour){
    System.out.println("Time matchs");
}
else{
    System.out.println("Time Doesn't Match");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T19:53:39.990

```
if (time == Scan_hour){ 
```

应该

```
if (time.equals(Scan_hour)){ 
```

字符串比较应该使用`equals()`代替`==`（文字情况除外`String`）。

`==`检查引用是否相等（两个引用都指向同一个对象）。`equals()`检查内容是否相等。

# spring - 如何使用 Spring 的 Quartz Scheduler 的 javacode 以编程方式设置 cronExpression？

> ID：13405065
> 
> 赞同：1
> 
> 时间：2012-11-15T19:52:19.887
> 
> 标签：spring, quartz-scheduler

背景 ：

我正在使用带有 Spring 的 Quartz 调度程序来安排一个 cronjob。

问题：

我在我的 applicationconfig 文件中配置调度程序选项。相反，我想在我的 java 类中以编程方式指定这些选项。关于如何实现这一目标的任何想法？我的代码如下，

应用程序配置

```
<!-- Cron Trigger -->
<bean id="SimpleTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
  <property name="jobDetail" ref="TaskJobDetail" />
  <property name="cronExpression" value="0 19 14 * * ?" />  
</bean>

<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
 <property name="jobDetails">
    <list>
    <ref bean="TaskJobDetail" />
    </list>
</property>  
<property name="triggers">
    <list>
    <ref bean="SimpleTrigger" />
    </list>
</property>
</bean> 
```

我想在我的 java 类中以编程方式设置 cronExpression。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T19:59:49.853

当然，您首先必须将 Quartz 调度程序注入到您的 Java 类（Spring bean）中：

```
@Autowired
private Scheduler scheduler; 
```

然后只需使用[Quartz API](http://quartz-scheduler.org/documentation/quartz-2.1.x/examples/Example3)：

```
import static org.quartz.TriggerBuilder.*;
import static org.quartz.CronScheduleBuilder.*;
import static org.quartz.DateBuilder.*:

JobDetail job = newJob(SimpleJob.class).build();

CronTrigger trigger = newTrigger()
    .withSchedule(cronSchedule("0 19 14 * * ?"))
    .build();

schedulder.scheduleJob(job, trigger); 
```

# cakephp-2.0 - 在 Cakephp Shell 中使用插件

> ID：13405070
> 
> 赞同：0
> 
> 时间：2012-11-15T19:52:28.230
> 
> 标签：cakephp-2.0

我正在编写一个 shell，它将向在我们网站上发布消息的用户发送电子邮件。电子邮件是通过 Mandrill 完成的，并通过插件来完成。

这是路径：

/app/Plugin/mandrill/Controller/Component/MandrillComponent.php

在这个回答的 SO 帖子（http://stackoverflow.com/questions/10880694/using-a-plugin-component-from-shell-class-in-cakephp-2-0-2）之后，我有以下内容：

```
App::uses('Controller', 'Controller');
App::uses('ComponentCollection', 'Controller');
App::uses('MandrillComponent', 'mandrill.Controller/Component');`

$Collection = new ComponentCollection();
$Mandrill = new MandrillComponent($Collection); 
```

我通过 Console/cake NotifyMailer 运行 shell，但得到错误：**找不到插件 mandrill。**

我已经为此苦苦挣扎了一段时间，因此将不胜感激任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:58:51.000

您是否在 Config/bootstrap.php 中加载了插件？

[http://book.cakephp.org/2.0/en/plugins.html](http://book.cakephp.org/2.0/en/plugins.html)

```
CakePlugin::loadAll(); // Loads all plugins at once
CakePlugin::load('Mandrill'); //Loads a single plugin 
```

我认为按照 cakephp 2.x 的约定，所有插件都应该以大写字母开头，即。山魈代替山魈

# sqlite - SQLite 将所有 unicode 字符转换为 ANSI

> ID：13405071
> 
> 赞同：4
> 
> 时间：2012-11-15T19:52:30.660
> 
> 标签：sqlite

我对 sqlite 及其文本编码有一个小问题。我从 sqlite 处理 UTF-8 编码的文档中读取，或者我可以通过执行命令 PRAGMA encoding = "UTF-8"; 来使用它。等等。数据库需要存储波兰语文本。该数据库稍后将与 Qt 一起使用。我有一个包含两个命令的脚本： CREATE TABLE ... 和 INSERT INTO ... 该文件以 UTF-8 编码。但是，当我使用命令行时：sqlite3 myname.db < the_file.sql，我可以创建数据库和表，但所有波兰语特定字符，如 ą、ć、ź、Ż 等都会自动转换为更简单的 ANSI 等效字符：a，c，z，Z等。我认为这将是命令行的问题。所以我下载了 SQLite Manager 2009，当我复制/粘贴整个脚本在 SQLite Manager 中执行它时，我注意到效果是一样的。在复制/粘贴过程中会自动转换字符。SQLite 是否仅限于使用 ANSI 字符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T11:33:20.577

如果您的设置有任何问题，那肯定不是 SQLite。

几个简单的测试：

Linux：

```
$ cat > test.sql <<EOF
DROP TABLE IF EXISTS t;
CREATE TABLE t (str varchar(20));
INSERT INTO  t (str) VALUES ("ą, ć, ź, Ż");
SELECT * FROM t;
EOF

$ file test.sql
test.sql: UTF-8 Unicode text

$ sqlite3 test.db < test.sql
ą, ć, ź, Ż 
```

因此，它按照医生的规定起作用。

视窗：

使用`test.sql`同上。如果您需要重新创建它，请复制并粘贴以下文本：

```
DROP TABLE IF EXISTS t;
CREATE TABLE t (str varchar(20));
INSERT INTO  t (str) VALUES ("ą, ć, ź, Ż");
SELECT * FROM t; 
```

进入 Notepad++ 并使用 Encoding -> **Encode in UTF-8 without BOM**另存为文件。

```
sqlite3 test.db < test.sql
─Е, ─З, ┼║, ┼╗ 
```

这听起来很糟糕。但是，这是有缺陷的 Windows 控制台！将输出保存到文件中：

```
sqlite3 test.db < test.sql > out.txt 
```

`out.txt`在 Notepad++ 中打开- 看起来很棒：`ą, ć, ź, Ż`

**编辑**：它也适用于 Windows 控制台，如果您使用`chcp 65001`：

```
chcp 65001
sqlite3 test.db < test.sql
ą, ć, ź, Ż 
```

QED。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2018-10-23T16:52:43.963

尝试替换您的 sqlite3.exe 文件。有时它会损坏并且只能输出格式错误的字符（当它们应该是 UTF-8 时是 ANSI 字符）。

再次从以下位置下载最新版本的新副本： [https ://www.sqlite.org/download.html](https://www.sqlite.org/download.html)

# c++ - 在声明为“const”的函数中使用“const_iterator”迭代集合会导致错误

> ID：13405077
> 
> 赞同：2
> 
> 时间：2012-11-15T19:53:09.643
> 
> 标签：c++, stl, iterator, constants, deque

这种方法：

```
void LRU::displayQueue() const
{
   for(iter = m_buffer.begin(); iter != m_buffer.end(); ++iter)
      std::cout << (*iter) << " ";
   std:: cout << std::endl;
} 
```

导致以下错误：

```
lru.cpp:58: error: passing 'const std::_Deque_iterator<int, const int&, const int*>' as    'this' argument of 'std::_Deque_iterator<int, const int&, const int*>& std::_Deque_iterator<int, const int&, const int*>::operator=(const std::_Deque_iterator<int, const int&, const int*>&)' discards qualifiers 
```

`m_buffer`并`iter`在我的头文件中声明，其中缓冲区被声明为 a `deque`of type`int`并且`iter`是一个常量迭代器：

```
// ...

std::deque<int> m_buffer;
std::deque<int>::const_iterator iter;

// ... 
```

删除方法`const`中的`displayQueue`将消除编译器错误，但由于此函数不应修改 中的任何数据`deque`，我想通过保持我的代码“常量正确”来明确这一点。当我的迭代器是 a 时，为什么这会导致错误 `const_iterator`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T19:59:03.623

您不能在`const`成员方法中修改类的任何成员，这就是您在这里尝试做的事情：

```
for(iter = m_buffer.begin();iter != m_buffer.end(); ++iter)
    ^^^^^^^                                         ^^^^^^ 
```

`iter`是 的成员`class LRU`，因此您不能在`const`成员函数中分配、递增或以其他方式更改它。

一种解决方案是使`iter`可变：

```
mutable std::deque<int>::const_iterator iter; 
```

但我的感觉是大多数用途`mutable`都表明存在设计缺陷。在这种情况下，我怀疑首先`iter`成为其中的一员`class LRU`是一个潜在的设计缺陷。你为什么需要/想要这个？

因此，我首先考虑不让它成为`iter`一个`mutable`成员，而是使用一个局部变量，而不是创建一个成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:10:00.467

因为您的成员函数是一个 const，这意味着您承诺不会更改此函数中的任何成员。好吧， iter 是一个成员，您正试图在函数中更改它，所以出现了错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T19:56:17.227

您正在通过设置 const 迭代器成员变量的值来修改对象，从而使函数的 const 限制无效。使用局部变量。

A `const_iterator`only 表示迭代器不能修改序列，但您不是在修改序列，而是在修改成员变量 iterator*本身*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T19:57:52.930

在 const 类型`LRU`的对象中，`iter`成员是 const，因此您不能在该循环中修改它。您需要制作一份单独的副本。这就是标准库算法采用迭代器对象的原因：因此它们可以修改迭代器对象以在序列中移动，即使存在 const 的底层容器对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-15T19:58:45.807

```
void LRU::displayQueue() const
{
  // std::_Deque_iterator<int, const int&, const int*> l_iter = m_buffer.begin();
  for(auto l_iter = m_buffer.begin(); l_iter != m_buffer.end(); ++l_iter)
    std::cout << (*l_iter) << " ";
  std::cout << std::endl;
} 
```

应该管用。正如其他人所说，无法修改 const 值。类上的`begin()`方法`Deque`被重载以返回 const 或非 const 值，在这种情况下，它将选择非 const 值。或者，您可以明确地将 iter 的类型表示为不是 const。

# sql - 将 3 个 SQL 查询合并为 1 个

> ID：13405079
> 
> 赞同：-5
> 
> 时间：2012-11-15T19:53:12.927
> 
> 标签：sql, linq

我有 3 个查询需要合并为一个。他们来了

```
SELECT COUNT(e.EmployeeID) AS TotalEmpCount
FROM Employees as e
WHERE HomePhone <> ''

SELECT COUNT(e.EmployeeID) AS USEmpCount
FROM Employees as e
INNER JOIN Orders as o ON e.EmployeeID=o.EmployeeID
WHERE e.HomePhone <> '' AND e.Country='US' AND o.OrderDate BETWEEN '11/01/2011' AND GETDATE()

SELECT COUNT(e.EmployeeID) AS UKEmpCount
FROM Employees as e
INNER JOIN Orders as o ON e.EmployeeID=o.EmployeeID
WHERE HomePhone <> '' AND Country ='UK' AND o.OrderDate BETWEEN '01/01/2011' AND '12/31/2012' 
```

我需要一个返回 3 列的查询：TotalEmpCount、USEmpCount、UKEmpCount。

我需要 T-SQL 和 Linq 格式的这个查询

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:22:58.380

这应该会给您相同的结果：

```
SELECT COUNT(e.EmployeeID) AS TotalEmpCount,
    USEmpCount = SUM(CASE WHEN e.Country='US' AND o.OrderDate BETWEEN '11/01/2011' AND GETDATE() THEN 1 ELSE 0 END),
    UKEmpCount = SUM(CASE WHEN e.Country ='UK' AND o.OrderDate BETWEEN '01/01/2011' AND '12/31/2012' THEN 1 ELSE 0 END)
FROM Employees as e
LEFT JOIN Orders o
    ON e.EmployeeID = o.EmployeeID
WHERE HomePhone <> '' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:15:45.527

我自己想通了：

```
SELECT  (
        SELECT COUNT(*) 
FROM Employees as e
WHERE HomePhone <> ''
        ) AS TotalEmpCount,
        (
        SELECT COUNT(*)
FROM Employees as e
INNER JOIN Orders as o ON e.EmployeeID=o.EmployeeID
WHERE e.HomePhone <> '' AND e.Country='US' AND o.OrderDate BETWEEN '11/01/2011' AND GETDATE()
        )  AS USEmpCount,
        (
        SELECT COUNT(*)
FROM Employees as e
INNER JOIN Orders as o ON e.EmployeeID=o.EmployeeID
WHERE HomePhone <> '' AND Country ='UK' AND o.OrderDate BETWEEN '01/01/2011' AND '12/31/2012'
        )  AS UKEmpCount 
```

# php - PHP：将 blob 内容转换为图像

> ID：13405084
> 
> 赞同：0
> 
> 时间：2012-11-15T19:53:26.980
> 
> 标签：php, image, oracle, blob

虽然有几个类似的威胁，但我的问题没有得到回答。

我从 Oracle 数据库中提取了 blob 内容，如下所示：

bab216da9a85b9df1b6f4fdd84629838e71919a​​00645e2a966bb6851ac6dd804da27988672ca0f0

如何将其转换为 jpeg？我需要什么解码功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:14:51.987

它看起来像十六进制，但 oci_ 函数应该只使用二进制字符串作为 blob，因此要么您正在执行将其转换为十六进制字符串的额外步骤，要么您不小心将十六进制字符串插入到您的数据库中。在任何情况下，尝试 hex2bin，即：

```
header('Content-type: image/jpeg');
echo hex2bin($data); 
```

如果这不起作用，请显示您的代码。

# forms - 字体真棒的输入按钮

> ID：13405088
> 
> 赞同：1
> 
> 时间：2012-11-15T19:53:41.707
> 
> 标签：forms, input, icons

所以，我在表单中有这个按钮：

```
<input type="submit" value="Entrar" /> 
```

我希望它显示 ths fontawesome 的图标，它与 css 中的任何其他图标功能一样工作。

```
<i class="icon-circle-arrow-right icon-large"></i> 
```

但我尝试了几种方法，但都没有奏效！谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T11:25:06.033

不仅输入必须更改为：

```
<button type="submit">
   <i class="icon-circle-arrow-right icon-large"></i>
</button> 
```

而且css也应该匹配：

```
form button {
padding-top:10px;
background-color:transparent;
border:none;
font-size:30px;
float:right;
color:#333333;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T19:59:35.763

您是否尝试过使用按钮而不是输入？

```
<button type="submit">
    <i class="icon-circle-arrow-right icon-large"></i> 
    Entrar
</button> 
```

# ruby-on-rails - rails：颜色哈希格式的自定义验证

> ID：13405092
> 
> 赞同：0
> 
> 时间：2012-11-15T19:54:02.677
> 
> 标签：ruby-on-rails, ruby, validation, format

例如，可以为电子邮件设置一种格式，例如

> EMAIL_REGEX = /^[A-Z0-9._%+-]+@[AZ)0-9.-]+.[AZ]{2,4}$/i

对于颜色哈希，我无法获得正确的语法。我想确保用户输入一个哈希，后跟 6 个字符（数字/字母）

例如`#ff3u7a`

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T19:59:30.703

你试过Rubular吗？[http://rubular.com/](http://rubular.com/)

我相信这应该有效。我在许多字符串上进行了尝试并得到了所有积极的结果，但让我知道你得到了什么：

```
/^\#(\d|[a-z]){6}$/ 
```

不区分大小写：

```
/^\#(\d|[a-z]){6}$/i 
```

# java - 通过 TCP 连接到 3G 移动设备

> ID：13405096
> 
> 赞同：0
> 
> 时间：2012-11-15T19:54:07.990
> 
> 标签：java, android, tcp, connection, 3g

所以基本上我正在尝试实现与在 Android 上运行 ad-hoc 服务的 3G 移动设备的 TCP 连接（我正在使用的客户端是 Android x86 台式电脑，但它也可能是另一个 3G移动设备）。

[WhatIsMyIP](http://whatismyip.com/)为我提供了正确的 IP 地址和来自移动设备的***未检测到代理消息。***

显然，我第一次尝试连接的结果是：

> java.net.SocketException：操作超时

由于移动网络运营商的一些限制/保护，我认为这有点合乎逻辑，这可能是问题的根源。我读过一个[类似的问题](https://stackoverflow.com/questions/3069577/how-can-i-connect-directly-to-a-mobile-device-over-3g)，但它有点旧，并且与 Android 无关。

那么，为了实现可公开访问的 IP 和 PORT，是否有任何解决此问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:01:02.860

我认为问题也出在操作系统本身上，您不能等待 3g 接口上的连接，只能在无线上。不知道如何使用 TCP 解决这个问题，但使用 UDP 非常简单：[http ://en.wikipedia.org/wiki/UDP_hole_punching](http://en.wikipedia.org/wiki/UDP_hole_punching)

# wordpress - 将 Google Maps API vs3 集成到 Wordpress 插件中？- 很近

> ID：13405097
> 
> 赞同：2
> 
> 时间：2012-11-15T19:54:08.957
> 
> 标签：wordpress, google-maps, plugins

使用 API vs3 创建谷歌地图插件？嗨，编码员！在网上搜索了几个小时后，找不到关于将新版本 3 功能集成到 wordpress 站点的权威文章。这是我希望实现的目标......

1.) 创建一个插件，通过简单的帖子元在管理员中收集“国家名称”。2.) 地图将对国家名称进行反向地理编码，拉取该谷歌地图的适当缩放版本 3.) 向谷歌地图的管理员提供预览

所以首先，这里有一个我们想要的静态文件的工作示例：http: [//simondelasalle.com/file_drop/google-map-example.htm](http://simondelasalle.com/file_drop/google-map-example.htm)

一切都好...将画布拉到正确的尺寸，放大它...甜美。如果你调出源代码，你会注意到我已经通过取出正文 onload 并替换为 window.onload = loadScript; 为 wordpress 集成做了一些准备。

这几乎可以工作，但确实需要一些帮助微调。

1 Admin Box Heres 用于更新国家和在管理员中预览谷歌地图的管理元框。*note 下面不包括更新字段本身的功能。

'

```
// add meta box
add_action( 'add_meta_boxes', 'post_map' );

// add meta box to post type
function post_map() {
    add_meta_box( 
        'post_map_tab',
        __( 'Map', 'post_textdomain' ),
        'map_tab_box',
        'post' 
    );
}

// print box content
function map_tab_box( $post ) {
    // Use nonce for verification
    // wp_nonce_field( plugin_basename( __FILE__ ), 'post_map_noncename' );
    // The actual fields for data entry
    ?>
    <table border="0" align="center" cellpadding="5" cellspacing="0" class="customfieldtable">

      <tr>
        <td align="right">Country or Region<br />
    (This is to GeoCode Map the location using Google)</td>
        <td><input name="geoecode_country" type="text" value="<?php echo get_post_meta($post->ID, 'geoecode_country', true); ?>" size="30" /></td>
        <td rowspan="3">&nbsp;</td>
        <td width="400" rowspan="4" valign="top">
        Please enter country and update to preview Google Map
        <div id="mapcanvas" sty></div>
      </tr>

    </table>

    <?php
} 
```

'

2 在你的插件 CSS 中添加样式

`

```
#map_canvas {
    width: 400px;
    height: 400px;
} 
```

`

3 在头部加载必要的脚本以在管理页面中预览（为您的插件和 API 密钥自定义占位符）。这与 admin_head 挂钩，因此我们可以用动态值替换

'

```
 function print_google_map_script() {

        // we could load conditionally by page if we want here
        global $post;
            $geoecode_country = get_post_meta($post->ID, 'geoecode_country', true);
        ?>

        <script type='text/javascript'>

              var geocoder;
              var map;
              var query = '<?php echo $geoecode_country; ?>';
              function initialize() {
                geocoder = new google.maps.Geocoder();
                var mapOptions = {
                  zoom:3,
                  mapTypeId: google.maps.MapTypeId.ROADMAP
                }
                map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
                codeAddress();
              }

              function codeAddress() {
                var address = query;
                geocoder.geocode( { 'address': address}, function(results, status) {
                  if (status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                    var marker = new google.maps.Marker({
                        map: map,
                        position: results[0].geometry.location
                    });
                  } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                  }
                });
              }

              function loadScript() {
                var script = document.createElement("script");
                script.type = "text/javascript";
                script.src = "http://maps.googleapis.com/maps/api/js?key=YOUR_API&sensor=false&callback=initialize";
                document.body.appendChild(script);
                }

              window.onload = loadScript;   

        </script>
        <?php

    }

     add_action('admin_head', 'print_google_map_script'); 
```

'

离工作太近了，很痛苦。所以地图加载有点......如果你坐在那里刷新几次，它似乎最终会起作用。但是，当您第一次加载编辑帖子页面时，您会在画布内看到地图，以及不正确的缩放级别。这是一个屏幕： [http ://www.simondelasalle.com/file_drop/screen.jpg](http://www.simondelasalle.com/file_drop/screen.jpg)

也许脚本的加载方式？API 似乎没有识别画布宽度。

您可以提供的任何建议或反馈将不胜感激

谢谢！

S。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T09:40:16.500

问题是元框被添加到页面并在地图绘制后显示（因此给定宽度/高度）。页面加载后，您需要告诉地图刷新：

```
$(window).load(function() {
    google.maps.event.trigger(map, "resize");
}); 
```

更糟糕的是，元框可能会被用户隐藏，然后再显示；例如，他们可能会在编辑一个页面/帖子时隐藏元框，然后在编辑另一个页面/帖子时显示它。幸运的是，WP 提供了一个钩子，让您知道何时显示元框，因此您也可以处理它：

```
postboxes.pbshow = function() {
    google.maps.event.trigger(map, "resize");
}; 
```

# php - cURL、两个站点和表单步骤

> ID：13405105
> 
> 赞同：0
> 
> 时间：2012-11-15T19:54:48.443
> 
> 标签：php, forms, validation, curl

我有两个站点，A 和 B。

站点A代码：

```
<?php
if ($_POST['data']) echo "Thank you";
?>

<form action="" method='POST'>
    <input type="text" name='data'>
<input type="submit">
</form> 
```

B站代码：

```
 <?php 
  $url = 'http://site_a.com';   
  $ch = curl_init();
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt( $ch, CURLOPT_POST, true ); 

    $data = curl_exec($ch);
    curl_close($ch);

    echo $data; 
```

来自站点 a 的站点 B 显示表单。一切都很好，但我也需要查看站点 B 上的感谢页面。现在，我被重定向到站点 A。如何在站点 B 上显示站点 A（表单/验证结果/感谢页面）的每个步骤？所以，我需要像 iFrame 一样显示它。我知道我也可以使用 JSONP，但我无法在代码中显示源 URL（我不想发布站点 A URL 以防止 Google 索引）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:19:55.217

您被重定向回站点 A，因为当您从站点 A 卷曲表单时，该`action`属性将成为站点 A 上表单的完整地址。

如果您想留在站点 B，您需要：

*   `action`在站点 B 上回显表单之前删除属性的内容；这样，表单将发布到自身（在站点 B）；
*   在站点 B 的代码中添加检查以查看是否发布了帖子，如果是，请将帖子参数添加到您对站点 A 的 curl 调用中。然后站点 A 会给您返回正确的结果（谢谢）。

在两个站点上分别发布表单可能更容易......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:07:25.817

我会为此使用 iframe 或 ajax 请求。由于您`echo $data`随后将站点 A 源嵌入到站点 B 并在浏览器中解析为一个完整的站点（而不是站点 A 的表单）。

# c# - UpdatePanel 中的文本框值保持为空

> ID：13405108
> 
> 赞同：1
> 
> 时间：2012-11-15T19:54:55.617
> 
> 标签：c#, asp.net, vb.net

我的页面上有几个更新面板，如下所示：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
  <Triggers>
    <asp:AsyncPostBackTrigger ControlID="Button1" />
  </Triggers>
  <ContentTemplate>
    <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
    <asp:Button ID="Button1" runat="server" Text="Submit"></asp:Button>
  </ContentTemplate>
</asp:UpdatePanel>

<asp:UpdatePanel ID="UpdatePanel2" runat="server">
  <ContentTemplate>
    ...some more basic controls here...
  </ContentTemplate>
</asp:UpdatePanel> 
```

当我在 UpdatePanel1 中点击提交时，文本框中的值会丢失。我不确定这是由于同一页面上有两个更新面板还是其他原因。

UpdatePanel2 是我试图移动文本框值的地方。但是为了测试字符串，我删除了所有代码，只是在我的点击事件上添加了一个消息框，用于 Button1 以检查字符串是否正在传递。似乎每次都是一个空字符串。

我尝试设置`ChildrenAsTriggers`为 true 和 false，删除了触发器部分，将更新面板的`enableviewstate`属性设置为 true，尝试在更新模式之间切换，但似乎没有任何效果。

这可能是重复的，但我在这里和谷歌上浏览了与此相关的帖子，但仍然没有找到任何解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T09:53:55.507

事实证明，我在其中一个更新面板中使用了 jQuery UI 对话框，该面板将对话框附加到正文的末尾（在表单标签之外）。我在对话框的脚本中添加了以下行：

```
dlg.parent().appendTo(jQuery("form:first")); 
```

......它成功了！

# r - 如何使用 R 中的 Gamma GLM 通过 AIC 进行模型选择？

> ID：13405109
> 
> 赞同：0
> 
> 时间：2012-11-15T19:55:01.577
> 
> 标签：r, glm, model-comparison

正如 glm() 的文档所解释的，glm() 返回的值的 aic 组件不是有效的 AIC：

> 对于高斯、伽玛和逆高斯族，色散是从残余偏差估计的，参数的数量是系数的数量加一。对于高斯族，使用色散的 MLE，因此这是 AIC 的有效值，但对于 Gamma 和逆高斯族则不是。

因此，需要以其他方式获得有效的 AIC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T19:55:01.577

如果您想使用 step() 或 MASS::stepAIC() 模型选择函数，您可以首先通过执行以下操作确保正确计算 AIC：

```
GammaAIC <- function(fit){
  disp <- MASS::gamma.dispersion(fit)
  mu <- fit$fitted.values
  p <- fit$rank
  y <- fit$y
  -2 * sum(dgamma(y, 1/disp, scale = mu * disp, log = TRUE)) + 2 * p
}
GammaAICc <- function(fit){
  val <- logLik(fit)
  p <- attributes(val)$df
  n <- attributes(val)$nobs
  GammaAIC(fit) + 2 * p * (p + 1) / (n - p - 1)      
}

my_extractAIC <- function(fit, scale=0, k=2, ...){
  n <- length(fit$residuals)
  edf <- n - fit$df.residual  
  if (fit$family$family == "Gamma"){
    aic <- GammaAIC(fit)
  } else {
    aic <- fit$aic
  }
  c(edf, aic + (k - 2) * edf)
}
assignInNamespace("extractAIC.glm", my_extractAIC, ns="stats") 
```

如果你使用 glmulti 包，你可以简单地通过 glmulti() 的 crit 参数指定使用上述 GammaAIC() 或 GammaAICc() 函数。

# ruby-on-rails-3.1 - “rails server”命令未在 Windows 上执行

> ID：13405112
> 
> 赞同：3
> 
> 时间：2012-11-15T19:55:09.080
> 
> 标签：ruby-on-rails-3.1

我正处于构建 Rails 应用程序的第一部分，但我无法获得命令

rails server 工作，或者任何其他 rails 命令。每当我尝试使用 rails 命令时，我都会得到如下帮助屏幕：

```
$rails server
Usage:
rails new APP_PATH [options]

Options:
-r, [--ruby=PATH]              # Path to the Ruby binary of your choice                                       # Default: /home/sgallagher/.rvm/rubies/ruby-1.9.2-    p290/bin/ruby
-b, [--builder=BUILDER]        # Path to a application builder (can be a filesystem     path or URL)

-m, [--template=TEMPLATE]      # Path to an application template (can be a filesystem path or URL)
[--skip-gemfile]           # Don't create a Gemfile
  [--skip-bundle]            # Don't run bundle install
-G, [--skip-git]               # Skip Git ignores and keeps 
```

等等（无论我输入什么命令，它都会给我相同的“rails new”命令）......

关于我的系统中可能缺少什么或为什么这些命令没有响应的任何想法？谢谢

PS 另一个奇怪的事情是，当我创建这个应用程序时，最初，我使用了以下命令：

rails new first_app 这实际上创建了两个应用程序：一个名为“new”，另一个名为“first_app”。它也没有创建默认的 Gemfile。

我正在运行 Rails 3.1.0 和 Ruby 1.9.2。在 Windows 7 上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:20:37.863

首先尝试制作您的应用程序（例如`$rails new app_name`）然后`$cd app_name`最后运行`$rails server`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T08:58:37.537

我得到了更多搜索
“捆绑安装”命令的解决方案没有自动执行，我手动运行此命令，webrick 服务器在端口 3000 上启动，

但现在出现的问题是每次我启动 ROR 时，我都必须执行“bundle install”命令来启动服务器......我怎样才能解决这个问题？？？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-14T14:01:36.173

确保将 dos 或终端中的目录更改为 rails 应用程序所在的正确目录...

# php - 一键将订单存储在具有不同ID的数据库中

> ID：13405115
> 
> 赞同：0
> 
> 时间：2012-11-15T19:55:20.437
> 
> 标签：php, mysql

我在网上商店工作，我尝试将订单存储在数据库中。如果用户选择超过 1 个产品，我可以将最新选择的产品存储在数据库中。是否可以一键存储超过 1 个具有不同 ID 的产品？

我在其他页面“cart.php”上有这个

`$pp_checkout_btn = "<a href='pp.php?post=' class='placeraorder'>Placera Order</a>";`

```
 if (isset($_SESSION['id'])) {
$postf=$_GET['post']; //
$userid = $_SESSION['id'];
$pris = $price; 
$totalsumma = $price * $each_item['quantity'];
$produkt_id = $each_item['item_id'];
$antal = $each_item['quantity'];// I can store many quantity with this var  with the same id
$storlek = $each_item['size'];
$färg = $each_item['color'];

mysql_query("INSERT INTO order_postf (produkt_id,userid,storlek,färg,pris,total_pris,antal,date) VALUES ('$produkt_id','$userid','$storlek','$färg','$pris','$totalsumma','$antal',now())")or die(mysql_error()); 

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T19:57:55.963

你可以像这样插入多条记录

```
insert into your_table (col1, col2)
values ('v1', 'v2'),
       ('v3', 'v4') 
```

# .net - My.Computer.Info.OSFullName 崩溃 Windows XP - .Net 4 已安装

> ID：13405117
> 
> 赞同：0
> 
> 时间：2012-11-15T19:55:23.120
> 
> 标签：.net, .net-4.0, crash, windows-xp

有谁知道为什么调用 My.Computer.Info.OSFullName （或 .anything）会导致 .Net 4 崩溃？

任何人都知道它是否可以与防病毒相关，例如 McAfee 软件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T19:56:44.303

看起来您需要一些 WMI 组件。

[http://msdn.microsoft.com/en-us/library/ms184637(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms184637(v=vs.80).aspx)

或者您需要在完全信任的情况下运行您的应用程序。

# sql-server-2008 - 对不同长度的字符串进行通配符搜索？

> ID：13405120
> 
> 赞同：0
> 
> 时间：2012-11-15T19:55:31.960
> 
> 标签：sql-server-2008, tsql

我有一个可以有 3 种不同长度（10、11 和 12）的字符串。如果输入完整的字符串，我不想进行通配符搜索，例如，如果`abc1234567`输入并且这是最大长度，我不想搜索`abc1234567%`，但如果它不是最大长度，我会想通配它。

这对性能有多大影响，尤其是在您加入字符串的情况下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:00:07.280

你可以这样做：

```
 WHERE AnotherField LIKE CASE WHEN LEN(MyField) <> 10 --or some other number
                    THEN MyField + '%'
                    ELSE MyField END 
```

但性能方面`LIKE MyField +'%'`应该是每行执行的操作较小。如果字符串具有最大长度，则它不会返回误报，因为没有超过它的字符。

# c++ - shared_ptr 用于原始指针参数

> ID：13405124
> 
> 赞同：5
> 
> 时间：2012-11-15T19:55:56.363
> 
> 标签：c++, function, pointers, smart-pointers

当函数需要char*时，可以传入shared_ptr吗？

我正在阅读整个文本文件（长度 = 100），并希望将 char 存储到 char[] 数组中。我使用的天真方式是这样的：

```
ifstream dictFile(fileName);
size_t fileLength = 100;
char* readInBuffer(new char[fileLength]);
dictFile.read(readInBuffer, fileLength);
//processing readInBuffuer..............
delete[] readInBuffer;
dictFile.close(); 
```

当然，如果在 delete[] 语句之前抛出异常，则存在内存泄漏。我想知道是否可以使用 shared_ptr readInBuffer(new char[fileLength]); 但是函数原型

> 读取 ( char* s, 流大小 n )

不接受智能指针作为输入？有什么技巧吗？

编辑：我正在尝试写这样的东西：

```
shared_ptr<char[]> readInBuffer(new char[fileLength]);
dictFile.read(readInBuffer.get(), fileLength); 
```

但它不会编译。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T19:59:58.183

除了使用指针，您还可以使用向量。

```
std::vector<char> readInBuffer(fileLength);
dictFile.read(&readInBuffer[0], fileLength); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-15T20:03:21.907

**大胖警告**：创建`std::shared_ptr<char>`指向数组的 a 会引发未定义的行为，因为智能指针将`delete`指向指针，而不是指针`delete[]`。改用a `std::shared_ptr<char[]>`！

将其留在这里，因为它可能是一个有用的警告。原始答案如下...

该`get()`函数返回底层原始指针。你已经在你的代码中写了这个！

```
shared_ptr<char[]> readInBuffer(new char[fileLength]);
dictFile.read(readInBuffer.get(), fileLength); 
```

使用 可以达到相同的结果`&*readInBuffer`。

当然，你必须确定那`dictFile.read()`不是`delete`指针，否则恶魔可能会从你的鼻子里飞出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:06:01.530

No, you can't pass a `shared_ptr`. But you can create one, and call its `get()` member function to get a copy of the raw pointer to pass to the function. However, a `shared_ptr` doesn't deal with arrays; that's what `vector` is for. But you can use a `unique_ptr` to an array to manage that object:

```
std::unique_ptr<char[], std::default_delete<char[]> ptr(new char[whatever]);
f(ptr.get()); 
```

There may be a shorter way to write that first line, but I don't have time to dig it out.

# javascript - JavaScript：创建和保存文件

> ID：13405129
> 
> 赞同：312
> 
> 时间：2012-11-15T19:56:09.233
> 
> 标签：javascript, file, dialog, save

我有要写入文件的数据，并打开一个文件对话框供用户选择保存文件的位置。如果它可以在所有浏览器中运行，那就太好了，但它必须在 Chrome 中运行。我想在客户端做这一切。

基本上我想知道在这个函数中放什么：

```
saveFile: function(data)
{
} 
```

该函数在哪里接收数据，让用户选择一个位置来保存文件，并在该位置创建一个包含该数据的文件。

如果有帮助的话，使用 HTML 也很好。

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2015-06-14T17:09:08.520

[Awesomeness01](https://stackoverflow.com/users/4181717/awesomeness01)（不需要锚标记）对代码进行了非常小的改进，并按照[trueimage](https://stackoverflow.com/users/2430498/trueimage)的建议进行了添加（支持 IE）：

```
// Function to download data to a file
function download(data, filename, type) {
    var file = new Blob([data], {type: type});
    if (window.navigator.msSaveOrOpenBlob) // IE10+
        window.navigator.msSaveOrOpenBlob(file, filename);
    else { // Others
        var a = document.createElement("a"),
                url = URL.createObjectURL(file);
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(function() {
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);  
        }, 0); 
    }
} 
```

经测试可在 Chrome、FireFox 和 IE10 中正常工作。

在 Safari 中，数据会在新选项卡中打开，并且必须手动保存此文件。

* * *

## 回答 #2

> 赞同：147
> 
> 时间：2015-03-30T05:52:31.250

```
function download(text, name, type) {
  var a = document.getElementById("a");
  var file = new Blob([text], {type: type});
  a.href = URL.createObjectURL(file);
  a.download = name;
}
```

```
<a href="" id="a">click here to download your file</a>
<button onclick="download('file text', 'myfilename.txt', 'text/plain')">Create file</button>
```

然后，您可以通过将下载属性放在锚标记上来下载文件。

我喜欢这个比创建数据 url 更好的原因是你不必制作一个很大的长 url，你可以只生成一个临时 url。

* * *

## 回答 #3

> 赞同：139
> 
> 时间：2012-11-15T20:05:49.697

This project on github looks promising:

[https://github.com/eligrey/FileSaver.js](https://github.com/eligrey/FileSaver.js)

> FileSaver.js implements the W3C saveAs() FileSaver interface in browsers that do not natively support it.

Also have a look at the demo here:

[http://eligrey.com/demos/FileSaver.js/](http://eligrey.com/demos/FileSaver.js/)

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2012-11-15T20:08:19.197

在创建文件之前选择保存文件的位置是不可能的。但至少在 Chrome 中，仅使用 JavaScript 生成文件是可能的。这是我创建 CSV 文件的一个旧示例。将提示用户下载它。不幸的是，这在其他浏览器中效果不佳，尤其是 IE。

```
<!DOCTYPE html>
<html>
<head>
    <title>JS CSV</title>
</head>
<body>
    <button id="b">export to CSV</button>
    <script type="text/javascript">
        function exportToCsv() {
            var myCsv = "Col1,Col2,Col3\nval1,val2,val3";

            window.open('data:text/csv;charset=utf-8,' + escape(myCsv));
        }

        var button = document.getElementById('b');
        button.addEventListener('click', exportToCsv);
    </script>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2020-02-10T20:22:40.490

```
function download(text, name, type) {
  var a = document.getElementById("a");
  var file = new Blob([text], {type: type});
  a.href = URL.createObjectURL(file);
  a.download = name;
}
```

```
<a href="" id="a">click here to download your file</a>
<button onclick="download('file text', 'myfilename.json', 'text/json')">Create file</button>
```

如果您更改 mime 类型，我认为这也可以与 json 文件一起使用。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-11-15T20:05:34.230

For latest browser, like Chrome, you can use the [File API as in this tutorial](http://www.html5rocks.com/en/tutorials/file/filesystem/):

```
window.requestFileSystem  = window.requestFileSystem || window.webkitRequestFileSystem;
window.requestFileSystem(window.PERSISTENT, 5*1024*1024 /*5MB*/, saveFile, errorHandler); 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2019-10-12T16:37:16.793

```
function SaveBlobAs(blob, file_name) {
    if (typeof navigator.msSaveBlob == "function")
        return navigator.msSaveBlob(blob, file_name);

    var saver = document.createElementNS("http://www.w3.org/1999/xhtml", "a");
    var blobURL = saver.href = URL.createObjectURL(blob), 
        body = document.body;

    saver.download = file_name;

    body.appendChild(saver);
    saver.dispatchEvent(new MouseEvent("click"));
    body.removeChild(saver);
    URL.revokeObjectURL(blobURL);
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2015-04-11T09:47:36.037

在控制台中尝试了这个，它可以工作。

```
var aFileParts = ['<a id="a"><b id="b">hey!</b></a>'];
var oMyBlob = new Blob(aFileParts, {type : 'text/html'}); // the blob
window.open(URL.createObjectURL(oMyBlob)); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-11-15T20:02:56.913

您不能仅在 Javascript 中执行此操作。由于安全原因，在浏览器上运行的 Javascript 还没有足够的权限（有提议）。

相反，我建议使用[Downloadify](https://github.com/dcneiner/Downloadify)：

> 一个小型 javascript + Flash 库，无需服务器交互即可创建和下载文本文件。

[您可以在这里](http://pixelgraphics.us/downloadify/test.html)看到一个简单的演示，您可以在其中提供内容并测试保存/取消/错误处理功能。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-02-22T01:28:47.140

对于 Chrome 和 Firefox，我一直在使用纯 JavaScript 方法。

（我的应用程序不能使用一个包，`Blob.js`因为它是由一个特殊的引擎提供的：一个带有 WWWeb 服务器的 DSP，几乎没有空间容纳任何东西。）

```
function FileSave(sourceText, fileIdentity) {
    var workElement = document.createElement("a");
    if ('download' in workElement) {
        workElement.href = "data:" + 'text/plain' + "charset=utf-8," + escape(sourceText);
        workElement.setAttribute("download", fileIdentity);
        document.body.appendChild(workElement);
        var eventMouse = document.createEvent("MouseEvents");
        eventMouse.initMouseEvent("click", true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
        workElement.dispatchEvent(eventMouse);
        document.body.removeChild(workElement);
    } else throw 'File saving not supported for this browser';
} 
```

注释、警告和黄鼠狼的话：

*   我在 Linux (Maipo) 和 Windows (7 和 10) 环境中运行的 Chrome 和 Firefox 客户端中使用此代码取得了成功。
*   但是，如果`sourceText`大于 MB，Chrome 有时（仅有时）会卡在自己的下载中而没有任何失败指示；到目前为止，Firefox 还没有表现出这种行为。原因可能是 Chrome 中的一些 blob 限制。坦率地说，我只是不知道；如果有人对如何纠正（或至少检测）有任何想法，请发布。如果出现下载异常，当 Chrome 浏览器关闭时，它会生成诊断信息，例如 [![Chrome 浏览器诊断](../Images/be7964572eb52a3fd51594e3b935558a.png)](https://i.stack.imgur.com/uoWWx.gif)
*   此代码与 Edge 或 Internet Explorer 不兼容；我没有尝试过 Opera 或 Safari。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-05-31T19:41:06.240

[StreamSaver](https://github.com/jimmywarting/StreamSaver.js)是一种替代方法，可以保存非常大的文件，而无需将所有数据保存在内存中。
事实上，它模拟了服务器在保存文件时所使用的所有内容，但所有客户端都使用服务工作者。

您可以获取编写器并手动将 Uint8Array 写入其中，也可以将二进制可读流通过管道传输到可写流

有几个[例子](https://jimmywarting.github.io/StreamSaver.js/example.html)展示：

*   如何将多个文件保存为 zip
*   将 readableStream 从例如管道`Response`传输`blob.stream()`到 StreamSaver
*   键入内容时手动写入可写流
*   或重新编码视频/音频

这是最简单形式的示例：

```
const fileStream = streamSaver.createWriteStream('filename.txt')

new Response('StreamSaver is awesome').body
  .pipeTo(fileStream)
  .then(success, error) 
```

如果要保存 blob，只需将其转换为 readableStream

```
new Response(blob).body.pipeTo(...) // response hack
blob.stream().pipeTo(...) // feature reference 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-12-20T06:22:07.167

Javascript 有一个 FileSystem API。如果您可以处理仅在 Chrome 中使用该功能，那么一个很好的起点是：[http](http://www.html5rocks.com/en/tutorials/file/filesystem/) ://www.html5rocks.com/en/tutorials/file/filesystem/ 。

# asp.net-mvc - mvc razor 可编辑 DropDownList

> ID：13405130
> 
> 赞同：2
> 
> 时间：2012-11-15T19:56:11.857
> 
> 标签：asp.net-mvc, razor, html-select

我正在寻找使下拉列表在 MVC razor 中可编辑的代码。@Html.DropDownList 提供标准选择列表，但值不可编辑。

我尝试了一个教程中的示例，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:09:47.623

首先需要在页面中添加脚本引用：

```
<script type="text/javascript" src="jquery.editable-select.pack.js"></script> 
```

如果您在服务器上托管此脚本。

您只需要在下拉列表的剃刀定义上设置 id，然后执行以下操作：

```
$('#nameOfDropDown').editableSelect({...}); 
```

完成此操作并检查此插件的文档后，您可能可以获得可编辑的选择列表。

# delphi - 单击顶级按钮时显示 TActionToolBar 的子按钮

> ID：13405136
> 
> 赞同：4
> 
> 时间：2012-11-15T19:56:53.897
> 
> 标签：delphi, c++builder, vcl

我有一个使用 TActionToolBar 和 TActionManager 的工具栏。按钮具有子按钮，单击按钮右侧的小向下箭头可以使用这些子按钮。一切都由 VCL 管理并且工作正常。

当我单击顶级按钮时，我想显示子按钮。现在，我只需要单击小箭头，但我希望整个按钮都这样做。

可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-25T23:39:37.837

我设法使以下项目适用于我的项目。我找不到直接引用在 ActionBar 上创建的按钮的方法。但是，ActionComponent 设置为在运行时创建的按钮。

这当然必须是一个 Action 本身才能连接到 Action Bar 上的主按钮，子项在该主按钮所在的位置。

```
procedure TReportPlugin.actMyDropdownExecute(Sender: TObject);
var
  ActionButton: TCustomDropDownButton;
begin
  inherited;

  if (Sender is TAction) then
  begin

    if (Sender as TAction).ActionComponent is TCustomDropDownButton then
    begin
      ActionButton := (Sender as TAction).ActionComponent as TCustomDropDownButton;
      ActionButton.DropDownClick;
    end;

  end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:09:13.957

听起来您可以使用在选择项目时起作用的 DropDown 控件。除此之外，只需将代码放在 OnButtonClick 方法中以模拟被单击的向下箭头。

# javascript - Sencha Touch 2：Ext.Map 控件显示事件不会触发

> ID：13405142
> 
> 赞同：0
> 
> 时间：2012-11-15T19:57:12.903
> 
> 标签：javascript, map, sencha-touch-2

我有一个控件，其中我扩展了一个“Ext.Map”。一切正常，加载正常，使用我当前的位置。

不起作用的事情是永远不会触发“显示”事件。我试过在控制器中重载它：

```
Ext.define('MyApp.controller.Map', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            myMap: 'myMap'
        },
        control: {
            myMap: {
                show: 'onMyMapShow'
            }
        }
    },

    onMyMapShow: function(myMap, eOpts) {
        // never enters this function...
    }
}); 
```

...以及在控件本身中：

```
Ext.define('MyApp.view.MyMap', {
    extend: 'Ext.Map',
    xtype: 'myMap',

    config: {
        layout: 'fit',
        useCurrentLocation: true,

        listeners: {
            show: function() {
                // never enters this function either...
            }
        }
    }
}); 
```

似乎没有任何效果。如何让 show 事件触发？预计什么时候开火？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T20:35:18.380

那是因为调用函数`show`时不会触发事件。`show()`

如果您想在显示地图时执行一些代码，那么您需要监听`maprender`or`painted`事件。

希望这有帮助。

# windows - 从 Windows SFTP 服务器递归删除文件

> ID：13405144
> 
> 赞同：0
> 
> 时间：2012-11-15T19:57:19.357
> 
> 标签：windows, batch-file, ssis, sftp, putty

我正在尝试在使用`psftp.exe`. 批处理文件将连接到远程 SFTP 服务器（运行 Windows XP）并递归地关闭文件。下载完成后，应删除文件（但不是其目录）。

批处理文件调用`psftp.exe -b script`. 在脚本文件中，我可以使用以下命令递归地删除文件：

```
mget -r Share 
```

（Share 是起始文件夹；文件夹结构类似于）：

```
.../Share/Client1
.../Share/Client2 
```

但是，我不知道如何删除我删除的文件。如果我可以进行递归移动，它会起作用，但它还没有起作用。与执行“mget”后的递归删除相同。

有人有答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T03:43:54.247

WinSCP 可以使用 get 命令上的 -delete 开关来执行此操作：www.winscp.net/eng/docs/faq_script_transfer_and_delete

WinSCP 与使用执行进程任务的 SSIS 配合得很好。通常不需要脚本，因为您可以使用 /command 将命令串在一起

# php - jQuery - 与未定义的变量作斗争

> ID：13405145
> 
> 赞同：0
> 
> 时间：2012-11-15T19:57:28.477
> 
> 标签：php, jquery, mysql, ajax, attr

我试图用 jquery 获取 html 标记的属性值。

```
 $query = "SELECT * FROM frontpage_modules";
        mysql_query("SET NAMES 'utf8'");
        $result = mysql_query($query) or (mysql_error());
        while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
            $list[] = $row['module_name'];
            $name[] = $row['name'];
            $img[] = $row['img'];
            $link[] = $row['link'];
            $module_content[] = $row['module_content'];
        }
    ?>

  <form action="ChangeFrontpageModule.php" method="post">  
   <ul id="gallery">
            <?php

                for ($idx = 0; $idx < count($list); $idx+=1) {
                    echo "<li data-itemid='" . $idx . "'>";
                    echo "<div class='drag_div'>";

                    echo '<div class="kundeutsagn">';
                    echo '<img src="http://www.amedisin.no/pictures/artikler/'.$img[$idx].'" alt="Top5"  title="Top5" />';
                    echo '<div class="statement_top">';
                    echo '<h5>'.$name[$idx].'</h5>';
                    echo "<input type='text' name='title' value='".$name[$idx]."' />";
                    echo $module_content[$idx];
                    echo '</div></div>';

                    echo "</div>";
                    echo "</li>";
                }
            ?>
        </ul>
    </form> 
```

我正在尝试传递存储在数据项中（在 li 内）的 ID 和输入元素中的值。

通过此代码“var title = $(this).val();”，我能够从输入元素中获取数据，但属性值返回错误“未定义”

下面是返回错误的jquery脚本

```
 <script>
        $(function() {
    $('h5').click(function() {
        $(this).slideUp().next('input').slideDown();
    });
    $('ul#gallery input').change(function() {
        var id = $(this).parent('li').attr('data-itemid');
        var thisParam = $(this);
        var title = $(this).val();
        $.ajax({
            type: 'POST',
            url: 'JavaScript/ChangeFrontpageModule.php',
            data: 'title=' + title + '&id=' + id,
            success: function(response) {
                $('input').slideUp();
                $(thisParam).prev('h5').text(title).slideDown();
                $('#response').fadeIn(1000).empty().append(response).prepend('<span id="x">X</span>');
                $('span#x').click(function() {
                    $('div#response').fadeOut('slow');
                });
            }
        });
    });
});
        </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:06:02.440

You are asking for the `data-itemid` attribute from `$(this).parent('ul')`, but the attribute in the first snippet you posted is on the `<li>` elements, not on the `<ul>`.

**Edit**: Taking a closer look, the `input` is also not a direct descendant of the `li`. Use [closest()](http://api.jquery.com/closest/) instead.

So if you switch `$(this).parent('li')` to `$(this).closest('li')` you should be fine.

**Credit** to @wirey's comment for `closest()`, I had mistakenly suggested `parents()`

# macos - 在 OS X 终端上切换 Vim 的永久语法

> ID：13405149
> 
> 赞同：5
> 
> 时间：2012-11-15T19:57:53.940
> 
> 标签：macos, vim, terminal, syntax-highlighting

我使用终端 vim 进入现有和新程序。我讨厌这样一个事实，即在任何时候我都需要在`:syntax on`命令行上启动以使语法变得丰富多彩。有没有人知道如何确保我的终端总是以丰富多彩的语法启动？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-15T20:03:32.723

放入`syntax on`你的`~/.vimrc`文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T20:04:10.100

添加`syntax on`到您的`~/.vimrc`. 见`:help initialization`。

# c - 简单的 Linux 编程：文件读取不顺利？

> ID：13405152
> 
> 赞同：1
> 
> 时间：2012-11-15T19:57:57.417
> 
> 标签：c, linux, file

我正在尝试编写一个简单的程序来从文件中读取并在终端中打印它。但是程序在打开文件后挂起。如果我删除阅读部分，它工作得很好。我不知道出了什么问题。有人可以帮忙吗？请！

```
#include <fcntl.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

int main(void)
{
  int fd,bytes;
  char buffer[10];
  char path[ ] = "file";

  if(fd = open(path, O_RDONLY) < 0) {
    perror("open");
    exit(EXIT_FAILURE);

  } else {
    printf("opened %s\n", path);
  }

  do {
    bytes = read(fd,buffer,10);
    printf("%d", bytes);
  } while( bytes > 0);

  if(close(fd) < 0) {
    perror("close");exit(EXIT_FAILURE);
  } else{
    printf("closed %s\n", path);
  }
  exit(EXIT_SUCCESS);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T19:59:50.533

```
if(fd = open(path, O_RDONLY) < 0) { 
```

这被解析为：

```
if(fd = (open(path, O_RDONLY) < 0)) { 
```

将 0 或 1 分配给`fd`. 您需要一组额外的括号：

```
if((fd = open(path, O_RDONLY)) < 0) { 
```

或者更好，写成两行。

```
fd = open(...);
if (fd < 0) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:16:15.067

因此，首先，如果“文件”存在，您的程序如 Mat 所解释的将 0 分配给 fd。连续读取从标准输入读取。这可以解释为“挂起”，但实际上您的程序只是从标准输入读取，并且您的 printf 没有显示，因为最后没有 \n。如果您将其更改为

```
do {
  bytes = read(fd,buffer,10);
  printf("%d", bytes);
  fflush (stdout);
} while( bytes > 0); 
```

然后你会看到会发生什么......干杯。

# c# - C# Linq To Xml - 如何选择元素集合并使用 lambda 修改每个元素？

> ID：13405159
> 
> 赞同：0
> 
> 时间：2012-11-15T19:58:26.183
> 
> 标签：c#, linq

我想从 XDocument 中选择元素并在单个 lambda 表达式中为每个元素添加一个属性。这就是我正在尝试的：

```
 xhtml.Root.Descendants()
            .Where(e => e.Attribute("documentref") != null)
            .Select(e => e.Add(new XAttribute("documenttype", e.Attribute("documentref").Value))); 
```

这样做的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:12:10.510

由于 LINQ 的延迟执行，如果从不迭代语句的结果，则不会将属性添加到 XML。

```
var elementsWithAttribute = from e in xhtml.Root.Descendants()
                            let attribute = e.Attribute("documentref")
                            where attribute != null
                            select e;

foreach (var element in elementsWithAttribute)
    element.Add(...); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:06:37.097

```
 xhtml.Root.Descendants()
            .Where(e => e.Attribute("documentref") != null)
            .ToList()
            .ForEach(e => e.Add( new.... ) ); 
```

# .net - 从 Windows 服务器获取信息

> ID：13405161
> 
> 赞同：1
> 
> 时间：2012-11-15T19:58:32.953
> 
> 标签：.net, vb.net, network-programming

是否可以从 Windows 远程桌面服务管理器获取传入/传出字节和帧的登录时间和空闲时间？

如果您进入远程桌面服务管理器并右键单击用户并选择状态，您可以看到有关该用户的大量信息。我的应用程序启动时如何获取这些信息？

# php - 尝试通过 PHP 同时访问用户的 Facebook 和 Twitter

> ID：13405172
> 
> 赞同：0
> 
> 时间：2012-11-15T19:59:25.050
> 
> 标签：php, facebook, twitter, oauth

我正在尝试通过我的网站同时登录 Facebook 和 Twitter。计划是发布到我的网站并让网站同时发布到两者。该代码适用于登录一个或另一个，但在登录一个然后另一个时不起作用。我正在为 Facebook 使用[Facebook PHP SDK](https://github.com/facebook/facebook-php-sdk)，为 Twitter 使用[tmhOAuth](https://github.com/themattharris/tmhOAuth/)。

```
$userId = $this->facebook->getUser(); 
            if($userId == 0){
                $this->data['fbloginurl'] = $this->facebook->getLoginUrl(array('scope'=>'manage_pages,publish_stream,read_stream,offline_access'));
            } else {
                if($this->session->userdata('userInfo')->userType == 1 || $this->session->userdata('userInfo')->userType == 2){
                    $this->facebook->setExtendedAccessToken();
                    $newdata = array('fbInfo'  => $this->facebook->api('/me/accounts')['data']);
                    $this->session->set_userdata($newdata);
                    foreach($this->session->userdata('fbInfo') as $page){
                        if($page['category'] != 'Application'){
                            $this->status_model->updateToken($page['name'],$page['access_token']);
                        }
                    }
                }
            }
            $tmhOAuth = new tmhOAuth($this->config->item('tmhOAuth'));
            if(isset($_REQUEST['oauth_verifier']) && $this->session->userdata('oauth') && !$this->session->userdata('access_token')){
                access_token($tmhOAuth);
            } else if(!$this->session->userdata('access_token')){
                $this->data['twloginurl'] = request_token($tmhOAuth);
            } else {
                $tmhOAuth->config['user_token']  = $this->session->userdata('access_token')['oauth_token'];
                $tmhOAuth->config['user_secret'] = $this->session->userdata('access_token')['oauth_token_secret'];
                $newdata = array('twitInfo'  => getTwitInfo($tmhOAuth));
                $this->session->set_userdata($newdata);
            } 
```

我可以登录 Facebook 或 Twitter，它工作正常，但同时做这两个似乎根本不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:02:44.357

您可能希望确保没有变量保存第一部分（Facebook）中的值，该值在第二部分中使用，这可能会导致绝对失败。会话变量也是如此。它可能使您的脚本失败。

# c++ - C 字符串到宽 C 字符串赋值

> ID：13405176
> 
> 赞同：1
> 
> 时间：2012-11-15T19:59:33.703
> 
> 标签：c++, string, cstring

我对 C 字符串和宽 C 字符串有点困惑。为了这个问题，假设我使用 Microsoft Visual Studio 2010 Professional。如果我的任何信息不正确，请告诉我。

我有一个带有 const wchar_t* 成员的结构，用于存储名称。

```
struct A
{
    const wchar_t* name;
}; 
```

当我为对象'a'分配一个名称时：

```
int main()
{
    A a;

    const wchar_t* w_name = L"Tom";
    a.name = w_name;

    return 0;
} 
```

那只是将 w_name 指向的内存地址复制到 a.name 中。现在 w_name 和 a.name 都是指向内存中相同地址的宽字符指针。

如果我是正确的，那么我想知道如何处理这种情况。我正在使用 tinyxml2 从 XML 属性中读取 C 字符串。

```
tinyxml2::XMLElement* pElement;
// ...
const char* name = pElement->Attribute("name"); 
```

获得 C 字符串后，我将其转换为宽字符串，如下所示：

```
size_t newsize = strlen(name) + 1;
wchar_t * wcName = new wchar_t[newsize];
size_t convertedChars = 0;
mbstowcs_s(&convertedChars, wcName, newsize, name, _TRUNCATE);

a.name = wcName;

delete[] wcName; 
```

如果到目前为止我是正确的，那么该行：

```
 a.name = wcName; 
```

只是将数组 wcName 的第一个字符的内存地址复制到 a.name 中。但是，我在分配此指针后直接删除 wcName，这将使其指向垃圾。

如何将我的 C 字符串转换为宽字符 C 字符串，然后将其分配给 a.name？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:04:17.437

最简单的方法可能是让你`name`变量管理内存。反过来，这很容易通过将其声明为

```
std::wstring name; 
```

这些家伙没有独立内容和对象变异的概念，也就是说，你不能真正制作单个角色`const`，制作整个对象`const`会阻止它被分配到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:02:21.587

您*可以*在使用 a 时执行此操作，而`std::wstring`无需依赖额外的临时转换缓冲区分配和销毁。除非您明显担心堆碎片或在有限的系统（又名 Windows Phone）上，否则这不是非常重要。它只需要在正面进行一些设置。让标准库为您管理内存（稍微推动一下）。

```
class A
{
   ...
   std::wstring a;
};

// Convert the string (I'm assuming it is UTF8) to wide char
int wlen = MultiByteToWideChar(CP_UTF8, 0, name, -1, NULL, NULL);
if (wlen > 0)
{
    // reserve space. std::wstring gives us the terminator slot
    // for free, so don't include that. MB2WC above returns the
    // length *including* the terminator.
    a.resize(wlen-1);
    MultiByteToWideChar(CP_UTF8, 0, name, -1, &a[0], wlen);
}
else
{   // no conversion available/possible.
    a.clear();
} 
```

在完整的旁注中，您*可以*构建 TinyXML 以使用标准库`std::string`而不是`char *`，这在这里并没有真正帮助您，但可能会在以后为您节省*大量*的`strlen()`调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:21:57.270

正如您正确提到`a.name`的，它只是一个指针，它不假设任何分配的字符串存储。您必须使用`new`静态/范围数组手动管理它。

要摆脱这些无聊的事情，只需使用可用的字符串类之一：`CStringW`来自 ATL（易于使用但特定于 MS）或`std::wstring`来自 STL（C++ 标准，但不太容易转换`char*`）：

```
#include <atlstr.h>

// Conversion ANSI -> Wide is automatic
const CStringW name(pElement->Attribute("name")); 
```

不幸的是，`std::wstring`使用 with`char*`并不是那么容易。请参阅此处的转换函数：[How to convert std::string to LPCWSTR in C++ (Unicode)](https://stackoverflow.com/questions/27220/how-to-convert-stdstring-to-lpcwstr-in-c-unicode)

# java - 服务器连续注册我的调制解调器的 ip 以在我的 android 应用程序中使用它

> ID：13405179
> 
> 赞同：0
> 
> 时间：2012-11-15T19:59:36.143
> 
> 标签：java, android, webserver

最初，来自 ISP 的 IP 地址总是在变化。我正在开发一个 android 应用程序，我需要从我家外面连接到我的内部网络。我需要一个连接到我的调制解调器/路由器的服务器，并且服务器应该在每次更改时保存我的家庭网络的公共 IP。

**目标：**在我的 android 应用程序和调制解调器/路由器之间进行通信。

**我的问题是：** 我是否必须在服务器端编写一个应用程序才能完成这项工作，还是已经有一个应用程序可用？

如果没有可用的，您能否告诉我创建一个的步骤，或对此的任何引用？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:10:09.133

我认为您最好的选择是使用动态 dns 服务。这将允许你给你的机器一个字符串名称，运行他们会给你的应用程序（或者许多路由器支持这个内置的），并在你需要的时候按名称引用计算机。请参阅[http://en.wikipedia.org/wiki/Dynamic_DNS](http://en.wikipedia.org/wiki/Dynamic_DNS)

# python - 尝试使用 Tweepy/Twitters Streaming API 和 psycopg2 来填充 PostgreSQL 数据库。很近，一条线

> ID：13405192
> 
> 赞同：0
> 
> 时间：2012-11-15T19:59:57.163
> 
> 标签：python, postgresql, psycopg2, tweepy, postgresql-9.2

我一直在尝试使用 Tweepy 和 Twitter 的 Streaming API 在 PostreSQL 数据库中填充表。我非常接近，我相信我离得到它只有一条线。我看过很多例子，包括： [http ://andrewbrobinson.com/2011/07/15/using-tweepy-to-access-the-twitter-stream/](http://andrewbrobinson.com/2011/07/15/using-tweepy-to-access-the-twitter-stream/) [http://blog.creapptives.com/post/14062057061 /the-key-value-store-everyone-ignored-postgresql](http://blog.creapptives.com/post/14062057061/the-key-value-store-everyone-ignored-postgresql) [Python tweepy 写入 sqlite3 db](https://stackoverflow.com/questions/11432187/python-tweepy-writing-to-sqlite3-db) [tweepy 流到 sqlite 数据库 - 无效的 synatx](https://stackoverflow.com/questions/9434205/tweepy-stream-to-sqlite-database-invalid-synatx) [使用 tweepy 访问 Twitter 的 Streaming API](https://stackoverflow.com/questions/10970550/using-tweepy-to-access-twitters-streaming-api) 等

我可以很容易地使用 Tweepy 流式传输推文，所以我知道我的消费者密钥、消费者密钥、访问密钥和访问密钥是正确的。我还设置了 Postgres，并成功连接到我创建的数据库。我使用 .py 文件中的 psycopg2 将硬编码值测试到我的数据库中的表中，这也有效。我正在根据我选择的关键字获取推文，并成功连接到数据库中的表。现在我只需要将推文流式传输到我的 postgres 数据库中的表中。就像我说的，我是如此接近，任何帮助将非常感激。

这个精简的脚本将数据插入到我想要的表中：

```
import psycopg2

try:
    conn = psycopg2.connect("dbname=teststreamtweets user=postgres password=x host=localhost")
    print "connected"
except:
    print "unable to connect"

namedict = (
    {"first_name":"Joshua", "last_name":"Drake"},
    {"first_name":"Steven", "last_name":"Foo"},
    {"first_name":"David", "last_name":"Bar"}
    )

cur = conn.cursor()

cur.executemany("""INSERT INTO testdata(first_name, last_name) VALUES (%(first_name)s, %(last_name)s)""", namedict);

conn.commit() 
```

下面是我已经编辑了一段时间的脚本，现在试图让它工作：

```
import psycopg2
import time
import json
from getpass import getpass
import tweepy

consumer_key = 'x'
consumer_secret = 'x'
access_key = 'x'
access_secret = 'x'

connection = psycopg2.connect("dbname=teststreamtweets user=postgres password=x host=localhost")
cursor = connection.cursor()

#always use this step to begin clean
def reset_cursor():
    cursor = connection.cursor()

class StreamWatcherListener(tweepy.StreamListener):
    def on_data(self, data):
        try:
            print 'before cursor' + data
            connection = psycopg2.connect("dbname=teststreamtweets user=postgres password=x host=localhost")
            cur = connection.cursor()
            print 'status is: ' + str(connection.status)
            #cur.execute("INSERT INTO tweet_list VALUES (%s)" % (data.text))
            cur.executemany("""INSERT INTO tweets(tweet) VALUES (%(text)s)""", data);
            connection.commit()
            print '---------'
            print type(data)
            #print data
        except Exception as e:
            connection.rollback()
            reset_cursor()
            print "not saving"
            return 
        if cursor.lastrowid == None:
            print "Unable to save"

    def on_error(self, status_code):
        print 'Error code = %s' % status_code
        return True

    def on_timeout(self):
        print 'timed out.....'

print 'welcome'
auth1 = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth1.set_access_token(access_key, access_secret)
api = tweepy.API(auth1)

l = StreamWatcherListener()
print 'about to stream'
stream = tweepy.Stream(auth = auth1, listener = l)

setTerms = ['microsoft']
#stream.sample()
stream.filter(track = setTerms) 
```

对不起，如果代码有点乱，但一直在尝试很多选择。就像我说的那样，任何建议、有用示例的链接等都将不胜感激，因为我已经尝试了我能想到的一切，现在正在长途跋涉。万分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:42:23.463

好吧，我不确定你为什么要为此使用类，以及为什么你没有`__init__`在你的类中定义。看起来很复杂。

这是我用来做这些事情的函数的基本版本。我只使用过 sqlite，但语法看起来基本相同。也许你可以从中得到一些东西。

```
def retrieve_tweets(numtweets=10, *args):
    """
    This function optionally takes one or more arguments as keywords to filter tweets.
    It iterates through tweets from the stream that meet the given criteria and sends them 
    to the database population function on a per-instance basis, so as to avoid disaster 
    if the stream is disconnected.

    Both SampleStream and FilterStream methods access Twitter's stream of status elements.
    """   
    filters = []
    for key in args:
        filters.append(str(key))
    if len(filters) == 0:
        stream = tweetstream.SampleStream(username, password)  
    else:
        stream = tweetstream.FilterStream(username, password, track=filters)
    try:
        count = 0
        while count < numtweets:       
            for tweet in stream:
                # a check is needed on text as some "tweets" are actually just API operations
                # the language selection doesn't really work but it's better than nothing(?)
                if tweet.get('text') and tweet['user']['lang'] == 'en':   
                    if tweet['retweet_count'] == 0:
                        # bundle up the features I want and send them to the db population function
                        bundle = (tweet['id'], tweet['user']['screen_name'], tweet['retweet_count'], tweet['text'])
                        db_initpop(bundle)
                        break
                    else:
                        # a RT has a different structure.  This bundles the original tweet.  Getting  the
                        # retweets comes later, after the stream is de-accessed.
                        bundle = (tweet['retweeted_status']['id'], tweet['retweeted_status']['user']['screen_name'], \
                                  tweet['retweet_count'], tweet['retweeted_status']['text'])
                        db_initpop(bundle)
                        break
            count += 1
    except tweetstream.ConnectionError, e:
        print 'Disconnected from Twitter at '+time.strftime("%d %b %Y %H:%M:%S", time.localtime()) \
        +'.  Reason: ', e.reason

def db_initpop(bundle):
    """
    This function places basic tweet features in the database.  Note the placeholder values:
    these can act as a check to verify that no further expansion was available for that method.
    """
    #unpack the bundle 
    tweet_id, user_sn, retweet_count, tweet_text = bundle
    curs.execute("""INSERT INTO tblTweets VALUES (null,?,?,?,?,?,?)""", \
        (tweet_id, user_sn, retweet_count, tweet_text, 'cleaned text', 'cleaned retweet text'))
    conn.commit()
    print 'Database populated with tweet '+str(tweet_id)+' at '+time.strftime("%d %b %Y %H:%M:%S", time.localtime()) 
```

祝你好运！

# ruby-on-rails - Rails 重构：我如何重构它才能工作？

> ID：13405195
> 
> 赞同：1
> 
> 时间：2012-11-15T19:59:58.240
> 
> 标签：ruby-on-rails

这两个列表仅略有不同，因为我需要将前 3 个项目与其他项目稍有不同。这现在不起作用的唯一原因是因为带有正则表达式的变量被调用了两次。知道如何将前 3 个项目（如第一个 %li 所示）与其他项目分开，而不必重复这样的所有事情吗？

```
%ul.list_container

  - @links.sort_by { |link| link.votes.where(:up => true).count - link.votes.where(:up => false).count }.reverse.first(3).each do |link|

  %li
    .various_containers
    %p
      = link_to link.title, "http://youtube.com/embed/#{link.url.to_s.match(/\/\/youtu.be\/(\S+)$/)[1]}/?rel=0", :class => "youtube title_link"
    = link.url_html

  - @links.sort_by { |link| link.votes.where(:up => true).count - link.votes.where(:up => false).count }.reverse.drop(3).each do |link|

  %li{:style => 'margin-bottom: 50px;'}
    .various_containers
    %p
    = link_to link.title,"http://youtube.com/embed/#{link.url.to_s.match(/\/\/youtu.be\/(\S+)$/)[1]}/?rel=0", :class => "youtube title_link" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:21:16.973

一些东西。您有很多代码，包括 ActiveRecord 查找，在它不属于的视图中。当它到达视图时，`@links`应该已经变形为您想要迭代的任何简单集合。

所以视图应该是这样的：

```
-@prepared_links.each do |link, url_html|
  %p
    =link_to link.title, link.embedded_url, :class => "youtube title_link"
    =url_html 
```

这意味着您需要一些额外的方法：`embedded_url`可以进入您的 Link 模型，并且基本上可以是`"http://youtube.com/embed/.../?rel=0"`您现在拥有的字符串`link_to`。

至于`url_html`前三个的显示，请在您的控制器中尝试这样的操作：

```
def my_method
  @prepared_links = Link.sorted_by_vote_count # you'll have to add this method as well
  url_htmls = @prepared_links[0..2].map(&:url_html)
  @prepared_links = @prepared_links.zip(url_htmls)
end 
```

这将为您提供一组准备好的链接作为配对值，其中前三个将是`[some_link, url_html]`，前三个之后的所有内容都将是，这意味着除非它确实存在，否则`[some_link, nil]`不会显示任何内容。`url_html`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:17:52.520

您可以使用 each_with_index 方法并根据索引值自定义每个循环。

```
%ul.list_container
  - @links.sort_by { |link| link.votes.where(:up => true).count - link.votes.where(:up => false).count }.reverse.each_with_index do |link, index|
  %li{ :style => "#{index < 3 ? 'margin-bottom: 50px;' : ''}" }
    .various_containers
    %p= link_to link.title, "http://youtube.com/embed/#{link.url.to_s.match(/\/\/youtu.be\/(\S+)$/)[1]}/?rel=0", :class => "youtube title_link"
    - if index < 3
      = link.url_html 
```

# r - 如何从R中的重复测量中找到最终值？

> ID：13405202
> 
> 赞同：0
> 
> 时间：2012-11-15T20:00:26.117
> 
> 标签：r

我在 R 中有这样排列的数据：

```
indv    time    mass
1         10    7
2          5    3
1          5    1
2          4    4
2         14    14
1         15    15 
```

`indv`群体中的个体在哪里。我想为初始质量 ( `mass_i`) 和最终质量 ( `mass_f`) 添加列。我昨天了解到，我可以`ddply`在 plyr 中添加一个初始质量列：

```
sorted <- ddply(test, .(indv, time), sort)
sorted2 <- ddply(sorted, .(indv), transform, mass_i = mass[1]) 
```

它给出了一个类似的表格：

```
 indv mass time mass_i
1    1    1    5      1
2    1    7   10      1
3    1   10   15      1
4    2    4    4      4
5    2    3    5      4
6    2    8   14      4
7    2    9   20      4 
```

但是，同样的方法不适用于找到最终质量 ( `mass_f`)，因为我对每个人有不同数量的观察结果。当观察的数量可能会有所不同时，任何人都可以提出一种找到最终质量的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:12:33.260

您可以简单地`length(mass)`用作最后一个元素的索引：

```
sorted2 <- ddply(sorted, .(indv), transform,
                 mass_i = mass[1], mass_f = mass[length(mass)]) 
```

正如 mb3041023 所建议并在下面的评论中讨论的那样，您无需对数据框进行排序即可获得类似的结果：

```
ddply(test, .(indv), transform,
      mass_i = mass[which.min(time)], mass_f = mass[which.max(time)]) 
```

除了行的顺序外，这与`sorted2`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:13:54.467

您可以使用`tail(mass, 1)`.`mass[1]`

```
sorted2 <- ddply(sorted, .(indv), transform, mass_i = head(mass, 1), mass_f=tail(mass, 1)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:15:26.373

一旦你有了这张表，它就很简单了：

```
t <- tapply(test$mass, test$ind, max) 
```

`ind.`这将为您提供一个带有as`names`和`mass_f`as 值的数组。

# c# - C# 相当于 perl 的 $_

> ID：13405203
> 
> 赞同：5
> 
> 时间：2012-11-15T20:00:33.497
> 
> 标签：c#, perl

是否有等效于 Perl 的`$_`功能？我正在用 C# 重写一些旧的 perl 脚本，但我从未学过任何 perl。这是我想要弄清楚的一个例子

```
sub copyText {
        while($_[0]){
            $_[1]->Empty();
            $_[0] = $_[1]->IsText();
            sleep(1);
         } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-15T20:06:45.310

首先，`$_`不是函数。它只是一个普通变量（恰好被许多内置函数读取和更改）。

其次，您发布的代码不使用`$_`. `@_`它正在访问参数列表的元素。

您发布的代码的更具可读性的版本是：

```
sub copyText {
   my ($arg1, $arg2) = @_;
   while ($arg1) {
      $arg2->Empty();
      $arg1 = $arg2->IsText();
      sleep(1);
   }

   $_[0] = $arg1;   # arg1 is passed by reference
} 
```

*   arg1 是通过引用传递的布尔值。
*   arg2 是某种对象，它有一个名为`Empty`和一个名为的方法`IsText`。

抱歉，我不懂 C#，但希望你能继续前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:54:20.750

> Perl的`$_`功能

这不是一个函数。这是一个代词，意思是“它”。

还有另一个特殊变量`@_`，它是一个代词，意思是“他们”。

C# 中没有类似物。

# sql-server - 诊断与 SQL Server 的连接

> ID：13405208
> 
> 赞同：1
> 
> 时间：2012-11-15T20:00:57.633
> 
> 标签：sql-server, connection, odbc

我正在尝试创建到 SQL Server 的 ODBC 连接，但是当我这样做时，出现错误：

```
Connection failed:
SQLState: '01000'
SQL Server Error: 10060
[Microsoft][ODBC_SQL Server Driver][TCP/IP Sockets] COnnectionOpen (Connect()).
Connection failed:
SQLState: '08001'
SQL Server Error: 17
[Microsoft][ODBC_SQL Server Driver][TCP/IP Sockets] SQL Server does not exist or access denied. 
```

这是我尝试过的：

1.  不是防火墙问题：尝试关闭 SQL Server 上的防火墙并关闭客户端。还能够从客户端远程登录 1433，并且工作正常。
2.  不是访问问题：我可以使用我在客户端上使用的帐户从许多不同的计算机登录，包括 SQL Server 本身（使用 SQL Server 身份验证）
3.  我可以 ping 主机名和 IP 地址。（我都试过了）

我唯一能想到的是客户端计算机是 windows server 2003，并且具有各种角色设置：

*   文件服务器
*   应用服务器
*   终端服务器
*   域控制器
*   DNS 服务器

我不知道为什么要设置这些服务，但目前我无法关闭它们。会不会是其中任何一个，如果是这样，有没有办法禁用它们的任何方面，这可能会阻止 SQL。

任何建议真的很感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:44:01.053

发现问题。出于某种原因，即使客户端上没有使用 SQL，它也已安装，通过转到所有程序 -> Microsoft SQL Server -> 客户端网络实用程序，我发现协议 TCP/IP 正在使用端口 4717。我不知道为什么要使用该端口，甚至更进一步，我不确定它为什么会很重要-我只是设置了一个 odbc 连接，而根本没有使用 sql server（在客户端上）。不管怎样，我把它改成了典型的端口（1433），就像繁荣一样，ODBC 连接就像魅力一样！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:19:36.173

有问题的服务器是否可能未配置为使用命名管道？

> **原因**
> 此连接尝试失败的最常见原因是此 DSN 或 ODBC 数据源尝试使用 TCP/IP 套接字 Net-Library（即 Dbmssocn.dll）建立连接。因为 SQL Server 没有侦听 TCP/IP 套接字客户端的传入连接，所以连接失败。从 ISQL/w 将返回上述第二条错误消息。操作系统错误为 10061，失败的函数调用是 ConnectionOpen(connect())。
> 
> **替代方法**
> 默认情况下，SQL Server 将侦听由命名管道客户端进行的传入连接。命名管道是客户端连接到 SQL Server 4.2、6.0 和 6.5 服务器的默认 IPC 机制。命名管道 DLL 是 Dbnmpntw.dll，它应该位于 Windows\System 或 Winnt\System32 目录中。TCP/IP 套接字 netlib DLL 是 Dbmssocn.dll，也应该位于 Windows\System 或 Winnt\System32 目录中。解决此问题的最常见方法是将客户端计算机配置为使用命名管道进行连接。配置命名管道 如果计算机上已安装 Microsoft 数据访问组件 (MDAC) ODBC 驱动程序，您可以在创建新数据源向导的第二步中进行此更改。
> 
> 注意：您可以从以下位置下载 MDAC 驱动程序：
> 
> [http://msdn2.microsoft.com/en-us/data/aa937730.aspx](http://msdn2.microsoft.com/en-us/data/aa937730.aspx)要配置客户端，请启动创建新数据源向导，单击客户端配置按钮，然后根据版本执行以下步骤您正在使用的 SQL Server ODBC 驱动程序：
> 
> 对于 SQL Server ODBC 驱动程序版本 3.50
> 
> ```
> Click the Net Library tab and use the drop down list box to set the 
> default network (Net Library) to Named Pipes.
> On the Advanced tab, remove any advanced entries that reference the 
> server you are connecting to.
> Click Done. 
> ```
> 
> 对于 SQL Server ODBC 驱动程序版本 3.70
> 
> ```
> In the Network Libraries section of the Edit Network Library Configuration 
> dialog box, select Named Pipes.
> Click OK. 
> ```
> 
> 如果您没有安装 MDAC ODBC 驱动程序，您可以使用 SQL Server 客户端配置实用工具将默认的网络库设置为命名管道。您可以从 i386 目录中的 SQL Server CD 安装客户端实用程序。

来源： http: [//support.microsoft.com/kb/195566](http://support.microsoft.com/kb/195566)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-18T17:23:37.790

默认情况下，SQL Native Client 似乎在寻找 MSSQLSERVER 实例。但是，如果您使用 SQLEXPRESS，通过它的所有连接都将失败。

很奇怪，但是尝试使用 MSSQLSERVER 实例名称安装您的 SQL Server - 它应该可以工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-25T07:31:23.917

**要为 SQL Server 创建新的数据源，请执行以下步骤：**

1.  在主机/服务器中，转到 Sql server management studio --> 打开左侧的安全部分 --> 右键单击​​登录，选择新登录，然后为您要连接的数据库创建一个新帐户。

2.  检查 TCP/IP 协议是否启用。转到所有程序 --> Microsoft SQL server 2008 --> 配置工具 --> 打开 Sql server 配置管理器。在左侧选择客户端协议（基于您的操作系统 32/64 位）。在右侧，选中 TCP/IP 协议已启用。

3.  在远程计算机/服务器中，打开数据源管理员。控制面板 --> 管理工具 --> 数据源 (ODBC)。

4.  在 User DSN 或 System DSN 中，单击 Add 按钮并选择 Sql Server driver 然后按 Finish。

5.  输入名字。

6.  输入服务器，注意：如果要输入主机地址，则应输入该IP地址，不带“\\”。例如。192.168.1.5，然后按下一步。

7.  选择使用用户输入的登录 ID 和密码进行 SQL Server 身份验证。

8.  在下面输入您在第一步创建的登录 ID 和密码。然后单击下一步。

9.  如果显示的数据库是您的数据库，请单击下一步，然后单击完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-09T13:38:24.667

为上述所有答案添加另一个检查点。如果您使用的是 Sql Server (ServerName\InstanceName) 的命名实例，则有效

*   确保 UDP 端口在 Windows 防火墙中启用，SQL Server 默认 UDP 端口号为 1434。如果不存在，请在防火墙中为 UDP 1434 端口创建新的传入规则，并在 SQL 配置管理器中重新启动 SQL Server 浏览器服务。

# audio - 构建软件 DAW 需要哪些开发人员角色或头衔？

> ID：13405220
> 
> 赞同：-3
> 
> 时间：2012-11-15T20:01:59.723
> 
> 标签：audio, roles, audio-processing

到目前为止，我已经在 Mac 和 Windows 平台上使用了许多不同的**音频制作软件。**很多时候，我会思考创建自己的 DAW 的想法，但我意识到这对于一个人来说将是一项极其艰巨的挑战（尤其是如果只了解一种特定领域/编程语言的情况下）。

只要想到我使用过的其他一些 DAW，我就会想到大量的想法/功能。从实现**MIDI**输入/输出、**音频路由**、**混音总线**、**VST**支持、**钢琴卷帘**和**乐曲视图**的**用户界面**等......

 ****所以我的问题是...

开发人员团队需要哪些角色来创建完整的**数字音频工作站**(DAW) 软件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:10:12.327

我认为正确的答案是几个优秀的开发人员（你不需要这么多，也许 3 个）一个优秀的产品经理、一个 ui 设计师/图形师和很多测试人员。*和一台好的咖啡机。*

真正的问题是你想要什么样的 DAW，在 mac 和 windows 上便携，哪些操作系统，哪些格式（vst 2、3、AU、RTAS、AAX、机架扩展、DX），你只想要 MIDI 和音频轨道，你想支持哪些外部 MIDI 设备，你支持 OSC，其他协议吗？

你的混音器有什么特点，集成效果器？Windows 上的音频 API 支持什么（wasapi、asio ...）你想要一些云功能吗？社区或在线商店整合？

与cubase、live、PT、DP、Logic、garage band、bitwig、studio one、sonar、fl studio相比，你会有什么样的突破？你想要模块化补丁还是只想要轨道？您将拥有高级集成控件或 midi 修改器吗？

这都是问题所在...

这是一个非常复杂的问题！****

# javascript - 流星：子键上的Mongo排序

> ID：13405222
> 
> 赞同：1
> 
> 时间：2012-11-15T20:02:08.437
> 
> 标签：javascript, mongodb, meteor

在 Meteor 的[“Parties”示例](https://github.com/meteor/meteor/blob/master/examples/parties/model.js)中，有一个 Party 模型，它由以下模式的文档表示：

```
Each party is represented by a document in the Parties collection:
  owner: user id
  x, y: Number (screen coordinates in the interval [0, 1])
  title, description: String
  public: Boolean
  invited: Array of user id's that are invited (only if !public)
  rsvps: Array of objects like {user: userId, rsvp: "yes"} (or "no"/"maybe") 
```

我想找到所有缔约方，并根据特定用户按“rsvps”排序。例如，像这样：

```
Meteor.find({sort: {rsvps: {user: 'myself', rsvp: 'yes'}}}) 
```

但当然，这不起作用，因为它不遵循[排序说明符 syntax](http://docs.meteor.com/#find)。此外，在同一文档中有一条注释说 Minimongo（客户端上的本地 Mongo 实现）不支持对子键进行排序。但是，我不认为问题只是对子键进行排序，因为我需要找到一个特定的子键，*然后*对不同的兄弟子键（无论他们是否参加，`rsvps.rsvp`子键）进行排序。

是否有任何方法或解决方法来实现排序集合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T00:01:18.950

minimongo 排序文件包含以下注释：

```
// XXX sort does not yet support subkeys ('a.b') .. fix that! 
```

所以很遗憾，目前不支持。虽然我有这个拉取请求，您可以从中获取所需的部分来实现此功能。

在这里查看：

[https://github.com/meteor/meteor/pull/443](https://github.com/meteor/meteor/pull/443)

兰德凡布雷达

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T16:46:17.043

另一种选择是使用 '.fetch()' 从光标中获取数据，然后使用类似 underscore.js 的 _.sortBy 对生成的数组进行排序。

然后可以将生成的自定义排序数组传递给车把，并将在 Meteor 中保留其反应特性。

# python - 正则表达式？匹配部分或整个单词

> ID：13405223
> 
> 赞同：1
> 
> 时间：2012-11-15T20:02:24.380
> 
> 标签：python, regex

我想知道是否可以将正则表达式与 python 一起使用来捕获一个单词或单词的一部分（如果它位于字符串的末尾）。

例如：
目标词 - 土豆
串 - “这是一个关于**土豆**的句子”
字符串 - “这是一个关于土豆的句子” 字符串 - “这是另一个关于**土豆的****句子**”

 **谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:08:50.053

```
import re

def get_matcher(word, minchars):
    reg = '|'.join([word[0:i] for i in range(len(word), minchars - 1, -1)])
    return re.compile('(%s)$' % (reg))

matcher = get_matcher('potato', 4)
for s in ["this is a sentence about a potato", "this is a sentence about a potat", "this is another sentence about a pota"]:
    print matcher.search(s).groups() 
```

**输出**

```
('potato',)
('potat',)
('pota',) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:08:10.210

不知道如何在 python 中匹配正则表达式，但正则表达式将是：

```
"\bp$|\bpo$|\bpot$|\bpota$|\bpotat$|\bpotato$" 
```

如果它是字符串中的最后一个单词，这将匹配从`p`to的任何内容`potato`，例如，如果这是您想要的，则不是“foopotato”之类的东西。

`|`表示另一种选择，the是`\b`“单词边界”，因此它匹配单词和非单词字符之间的位置（不是字符）。并且`$`匹配字符串的结尾（也是一个位置）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:04:58.020

使用`$`匹配字符串的末尾。例如，以下内容仅匹配字符串末尾的 'potato'（第一个示例）：

```
"potato$" 
```

这将匹配您的所有示例：

```
"pota[to]{1,2}$" 
```

但是，也有匹配“potao”或“potaot”的风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:11:54.787

```
import re
patt = re.compile(r'(p|po|pot|pota|potat|potato)$')
patt.search(string) 
```

我很想使用`r'po?t?a?t?o?$'`，但这也可以匹配**poto**或**pott**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T20:14:07.837

不，据我所知，你不能用正则表达式来做到这一点，没有`(p|po|pot ...)`过多的无意义匹配。相反，只需选择最后一个单词，并使用子字符串匹配它：

```
match = re.search('\S+$', haystack)
if match.group(0) == needle[:len(match.group(0))]:
    # matches. 
```**

# java - 什么方法加入实体更快？

> ID：13405230
> 
> 赞同：0
> 
> 时间：2012-11-15T20:02:49.697
> 
> 标签：java, hibernate, postgresql, jpa, jpql

以下是检索等效数据的两个查询：

```
SELECT DISTINCT packStatus
  FROM PackStatus packStatus JOIN FETCH packStatus.vars, ProcessEntity requestingProcess
    WHERE
      packStatus.status.code='OGVrquestExec'
      AND packStatus.procId=requestingProcess.activityRequestersProcessId
      AND requestingProcess.id='1000323733_GU_OGVProc'

SELECT DISTINCT packStatus
  FROM PackStatus packStatus JOIN FETCH packStatus.vars
    WHERE
      packStatus.status.code='OGVrquestExec'
      AND packStatus.procId=(SELECT requestingProcess.activityRequestersProcessId FROM ProcessEntity requestingProcess WHERE requestingProcess.id='1000323733_GU_OGVProc') 
```

这些查询的不同之处在于如何`requstingProcess`与 连接`packStatus`。一般来说，这两种方法中哪一种在性能方面更可取？我在 Postgres 8.4 上使用 Hibernate 3.3 提供的 JPA 1.2。

UPD：我已经用我的应用程序中的真实查询替换了虚假查询。这是 Hibernate 为[第一个](http://paste.org.ru/?v770v7)和[第二个](http://paste.org.ru/?6usbpf)查询生成的 SQL。查询计划的链接：[first](http://explain.depesz.com/s/a2O)，[second](http://explain.depesz.com/s/QNf)。查询计划看起来非常相似。唯一的区别是 bpms_process 表中的数据在什么时刻聚合到查询结果。但我不知道概括这些结果是否正确？对于仅在连接方法上有所不同的查询，查询计划是否几乎相同？是否可以通过更改加入方法来获得很大的查询成本差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:58:41.700

使用`EXPLAIN ANALYZE`并查看。

如果它们变成相同的查询计划，我不会感到惊讶。

请参阅：[https ://stackoverflow.com/tags/postgresql-performance/info](https://stackoverflow.com/tags/postgresql-performance/info)

# java - 构造函数 LinkedHashMultimap 不可见

> ID：13405231
> 
> 赞同：0
> 
> 时间：2012-11-15T20:02:52.497
> 
> 标签：java, guava, multimap

以下代码无法编译

```
import com.google.common.collect.LinkedHashMultimap;

public class Test {
    public static void main(String[] args) {
        LinkedHashMultimap<String, String> p = new LinkedHashMultimap<String, String>();    
    }
} 
```

错误是：**构造函数 LinkedHashMultimap() 不可见**

我已经导入了谷歌 Java 库，它们在构建路径中

和

```
 LinkedHashMultimap<String, String> p; 
```

单独不会导致编译错误...奇怪

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:04:15.020

使用静态[create](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/LinkedHashMultimap.html#create%28%29)方法获取 LinkedHashMultimap 的新实例。

```
 LinkedHashMultimap<String, String> p = LinkedHashMultimap.create(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:11:18.730

`LinkedHashMultimap`没有公共构造函数，获取实例的方法是使用工厂方法`create`。原因是 Java 泛型中的漏洞，因为类型推断仅适用于方法而不适用于构造函数。这意味着，而不是例如

```
LinkedHashMultimap<String, Map<String, List<String>>> = 
  new LinkedHashMultimap<String, Map<String, List<String>>>(); 
```

你可以写

```
LinkedHashMultimap<String, Map<String, List<String>>> = 
  LinkedHashMultimap.create(); 
```

在 Java 7 中，由于“钻石运算符”，压力已经消退。

# jquery - 2种创建jquery对话框的方法。

> ID：13405234
> 
> 赞同：1
> 
> 时间：2012-11-15T20:02:58.957
> 
> 标签：jquery, dialog

我有 2 种不同的方法来创建与 Jquery 的对话框

这个不行：

```
 var options = "{width: 1024, height: 600, modal: true, buttons: { Cancelar: function () { $(this).dialog('close'); } }, draggable: false, resizeble: false}";

$('#UserSettings').dialog(options); 
```

这个工作正常：

```
$('#UserSettings').dialog({ width: 1024, height: 600, modal: true, buttons: { Cancelar: function () { $(this).dialog('close'); } }, draggable: false, resizeble: false }); 
```

想不通为什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:03:47.153

删除第一个选项中的引号。对话框的参数是一个对象而不是字符串。

```
var options = {  
        width: 1024, 
        height: 600, 
        modal: true, 
        buttons: { 
           Cancelar: function () { 
              $(this).dialog('close'); 
           } 
        },
        draggable: false, 
        resizeble: false
 }; 
```

# java - 如何在动态表单上完成 CRUD 操作？

> ID：13405238
> 
> 赞同：1
> 
> 时间：2012-11-15T20:03:23.520
> 
> 标签：java, jsf, jpa

我遵循 [Balusc 的第一种方法](https://stackoverflow.com/a/3522489)从数据库中定义的字段创建动态表单。我可以获取已发布字段的字段名称和值。但是我对如何将值保存到数据库中感到困惑。

*   我是否应该在创建表单后预先创建一个表来保存值并手动保存值（通过手动形成 SQL 查询）？
*   我应该将名称/值对转换为 JSON 对象并保存吗？
*   我是否应该创建一个带有 id、name、value 字段的简单表并在此处保存名称/值对（如 EAV 方案）？

或者有什么方法可以将发布的值保存到数据库中？问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T11:41:03.820

看起来您正在尝试自下而上而不是自上而下工作。

链接答案中的动态表单旨在在所有*现有*表中重用，而无需在每个表的“硬编码”Facelets 文件上手动创建单独的 JSF CRUD 表单。您应该已经有一个可用的通用模型，其中包含有关特定数据库表中所有可用列的信息（`Field`在链接的答案中）。该信息可以通过 JPA 元数据信息（如何执行这又取决于所使用的 JPA 提供程序）或仅[`ResultSetMetaData`](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSetMetaData.html)在应用程序启动期间通过良好的“ol JDBC 类”动态和通用地提取。

如果你真的需要自下而上地工作，那就更棘手了。在运行时创建表/列是一种非常糟糕的设计（当然，除非您打算开发某种数据库管理工具，例如 PhpMyAdmin 左右）。无需创建表/列运行时，您基本上应该有 3 个表：

*   1 个表，其中包含有关哪些“虚拟”数据库表都可用的信息。
*   1 个表，其中包含一个此类“虚拟”数据库表具有哪些列的信息。
*   1 个表，其中包含一个此类列具有的值的信息。

然后您应该通过 FK 关系将它们链接在一起。

# c++ - c++ stl 列表有问题

> ID：13405239
> 
> 赞同：0
> 
> 时间：2012-11-15T20:03:28.457
> 
> 标签：c++, list, stl

我有以下功能。

```
void BulletFactory::update(Uint32 ticks) {
  std::list<Sprite*>::iterator it = activeBullets.begin();
  while (it != activeBullets.end()) {
    (*it)->update(ticks);
    if(!((*it)->inView())) {
      activeBullets.remove(*it);
      Sprite* temp = *it;
      it++;
      inactiveBullets.push_back(temp);
    } else {
      it++;
    }
  }
} 
```

当条件`!((*it)->inView())`存在时，`true`存在分段错误。我看不到问题所在。

编辑：忘了提到 activeBullets 和 inactiveBullets 是两个列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:05:41.483

```
 activeBullets.remove(*it);
 Sprite* temp = *it; //<--- problem
 it++; //<-- problem 
```

应该：

```
 Sprite* temp = *it;
  it = activeBullets.erase(it); //use erase
  //it++; don't increment it 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:05:46.100

您不能修改迭代器指向的元素，因为它会使迭代器无效。请参阅[此问题](https://stackoverflow.com/questions/596162/can-you-remove-elements-from-a-stdlist-while-iterating-through-it)以获取解决方案。

# xserver - 是否可以以交互方式更改 .Xresources？

> ID：13405240
> 
> 赞同：0
> 
> 时间：2012-11-15T20:03:28.557
> 
> 标签：xserver

我的想法是这样的：

```
#include $PATH_TO_FILE 
```

在 .Xresources 中，这样我就可以更改 PATH_TO_FILE 的值并运行`xrdb -merge`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T20:14:01.797

显然，它不能。可以做的是然后在脚本中使用*来*更改指向的文件。`#include /path/to/symlink``PATH_TO_FILE``symlink`

# macos - Java Web Start in 10.8.2 with native (Apple) Java 1.6 找不到 JRE

> ID：13405242
> 
> 赞同：3
> 
> 时间：2012-11-15T20:03:45.393
> 
> 标签：macos, osx-mountain-lion, java, java-web-start

我正在尝试在最新的 os-x 上运行一些 .jnlp 应用程序（游戏）。在这样做的同时，Java Web Start.app 建议我安装 Java 运行时环境 (jre_7u9)。那不应该已经包含在 os-x, java 1.6 中了吗？例如，我使用基于 java 的 Eclipse，运行它没有问题。我只是担心新版本可能会弄乱一些迄今为止运行良好的东西（看到几个线程，人们在安装 java 7 后遇到问题，即使使用邮件应用程序也是如此！）。

我对java几乎一无所知，所以如果有人能指出不涉及安装jre_7u9的解决方案，那就太好了。

在此先感谢，问候，丹尼斯。

编辑1：

似乎 user/bin/javaws 指向了错误的方向：

```
javaws
No Java runtime present, requesting install.
Unable to locate a Java Runtime to invoke. 
```

那是：

```
/System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/javaws 
```

如果我将其更改为（如此处建议的那样[http://support.apple.com/kb/HT5559](http://support.apple.com/kb/HT5559)）

```
/System/Library/Frameworks/JavaVM.framework/Commands/javaws 
```

它工作正常，但是它并不能帮助 Java Web Start.app 正常运行，它仍然需要安装 JRE，这是一派胡言。

p/s/[这个](https://stackoverflow.com/questions/13004854/is-there-any-way-to-reenable-javaws-with-java-6-on-osx-lion/13012740#13012740)线程讨论了同样的问题。[这个](https://apple.stackexchange.com/questions/71428/mountain-lion-with-java-6-2012-006-web-plugin-javaws-cant-find-jre)也是。但到目前为止，我还没有看到任何使 Java Web Start 工作的解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-15T20:09:39.977

Java for OS X 2012-006中提供了有关如何解决此问题的详细指南[：如何重新启用 Apple 提供的 Java SE 6 小程序插件和 Web Start 功能](http://support.apple.com/kb/HT5559)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T17:31:54.840

我遇到了同样的问题，我可以从命令行运行 javaws，但是从 Chrome/Safari/Finder 运行无法使用 Java Web Start。我发现的问题是 Java Web Start 正在寻找一个不存在的用户首选项。我能够通过运行来完成这项工作：

```
defaults write com.apple.java.JavaPreferences WebComponentsEnabled -bool true 
```

# scala - 如何将 AND 添加到连接 SLICK

> ID：13405246
> 
> 赞同：5
> 
> 时间：2012-11-15T20:03:53.330
> 
> 标签：scala, playframework, scalaquery, slick

我在 SLICK 中编写查询时遇到问题这是我对 MySql 数据库的请求：

```
SELECT * FROM readings AS r
JOIN parameters AS p
LEFT JOIN sensorvalues AS sv ON sv.parameter_id=p.id AND sv.reading_id=r.id 
```

如何使用 SLICK 编写它？确实缺乏有关文档中连接的信息。

**更新 1** 我尝试了所有组合，即使是这样的组合

```
val q = for{
  Join(p,sv) <- Parameters leftJoin SensorValues on (_.id is sv.parameter_id)
  r <- Readings if sv.reading_id is r.id
} yield(r,p,sv) 
```

在这种情况下，编译器给了我一个错误`wrong number of parameters; expected = 2`

所以我将 sv.parameter_id 替换为 _.parameter_id 现在它争论 Join 它说：

`constructor cannot be instantiated to expected type; found : models.Join required: (models.Parameters.type, models.SensorValues.type)`

我正在使用最新版本的 SLICK，但已弃用。我手动导入

`import scala.slick.lifted.Join`现在它看起来像是常规的 innerJoin，因为它使用 WHERE 而不是在 ON 之后放置和。

SQL 生成的购买查询：

`select x2.id, x2.platform_id, x2.date, x3.x4, x3.x5, x3.x6, x7.x8, x7.x9, x7.x10, x7.x11 from (select x12.id as x4, x12.name as x5, x12.units as x6 from parameters x12) x3 left outer join (select x13.id as x8, x13.reading_id as x9, x13.parameter_id as x10, x13.value as x11 from sensorValues x13) x7 on x3.x4 = x7.x10, readings x2 where true and (x7.x9 = x2.id)`

即使是在 ON 部分添加条件的情况下也会很好

```
 val readings = for {
        all <-Readings join Parameters leftJoin SensorValues on (_._2.id is _.parameter_id) if(all._1._1.id === all._2.reading_id)
      } yield (all._1._1,all._1._2,all._2) 
```

但这从未发生过。

```
SELECT
    x2.x3,
    x2.x4,
    x2.x5,
    x2.x6,
    x2.x7,
    x2.x8,
    x9.x10,
    x9.x11,
    x9.x12,
    x9.x13
FROM
    (
        SELECT
            x14.x15 AS x3,
            x14.x16 AS x4,
            x14.x17 AS x5,
            x18.x19 AS x6,
            x18.x20 AS x7,
            x18.x21 AS x8
        FROM
            (
                SELECT
                    x22.`id` AS x15,
                    x22.`platform_id` AS x16,
                    x22.`date` AS x17
                FROM
                    `readings` x22
            )x14
        INNER JOIN(
            SELECT
                x23.`id` AS x19,
                x23.`name` AS x20,
                x23.`units` AS x21
            FROM
                `parameters` x23
        )x18
    )x2
LEFT OUTER JOIN(
    SELECT
        x24.`id` AS x10,
        x24.`reading_id` AS x11,
        x24.`parameter_id` AS x12,
        x24.`value` AS x13
    FROM
        `sensorValues` x24
)x9 ON x2.x6 = x9.x12
WHERE
    x2.x3 = x9.x11 
```

相反`WHERE`，我需要`AND`. 我应该用什么来提及这种情况，或者 slick 中没有任何功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T23:31:10.727

**编辑**
OP 正在寻找2 个表对象连接中的*条件链。*

这应该编译：

```
val q = for{
  r <- Readings
  Join(p,s) <- Params leftJoin Sensors on (
    (a,b)=> (a.id is b.parameter_id) && (b.reading_id is r.id)
  )
} yield(r,p,s) 
```

**原创**
尝试这样的事情：

```
val q = for{
  Join(p,s) <- Params leftJoin Sensors on (_.id is s.parameter_id)
  r <- Readings if s.reading_id is r.id
} yield(r,p,s)

val result = 
  q.list.map{ case(r,p,s)=>
    SomeCaseClass(r,p,s)
  } 
```

# hadoop - Apache Hadoop 版本 1.0.3 使用哪些端口来进行守护进程的集群内通信

> ID：13405247
> 
> 赞同：1
> 
> 时间：2012-11-15T20:03:54.680
> 
> 标签：hadoop, mapreduce, hbase, rhel, elastic-map-reduce

我知道端口 22 仅用于控制脚本。

但我需要知道我应该为我的 3 节点集群打开哪些端口。2个奴隶，1个namenode/jobtracker。

守护进程在哪个端口上运行？URL 显示在哪些端口上？

hadoop 发行版是：Apache Hadoop 版本 1.0.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T00:13:39.877

通过 URL，我假设您的意思是 JobTracker 和 TaskTracker 接口。细分如下：

```
Namenode                50070   
Datanodes               50075 
Secondarynamenode       50090 
JobTracker              50030   
TaskTracker             50060 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T02:24:09.587

[这](http://blog.cloudera.com/blog/2009/08/hadoop-default-ports-quick-reference/)是 Hadoop 中的默认端口号。

# c# - 如何对依赖于控制台的 switch 语句进行单元测试

> ID：13405250
> 
> 赞同：1
> 
> 时间：2012-11-15T20:03:56.480
> 
> 标签：c#, unit-testing, switch-statement

我是单元测试的新手，我正在使用 VS 2010 单元测试框架。

我有一个从用户那里获取整数的函数，然后根据用户输入执行不同的函数。我已经阅读了很多关于单元测试的内容，但是我没有找到任何可以告诉我如何测试 switch 语句的每个分支的内容。到目前为止我得到了什么：

```
 [TestMethod]
    public void RunBankApplication_Case1()
    {
        using (var sw = new StringWriter())
        {
            using (var sr = new StringReader("1"))
            {
                Console.SetOut(sw);
                Console.SetIn(sr);
                BankManager newB = new BankManager();
                newB.RunBankApplication();
                var result = sw.ToString();

                string expected = "Enter Account Number: ";
                Assert.IsTrue(result.Contains(expected));
            }
        }
    } 
```

当调用案例 1 下的函数时，首先发生的是字符串“输入帐号：”被写入控制台。但是，这根本行不通。我没有正确地将输入传递给控制台吗？谢谢您的帮助！

编辑：我的 RunBankApplication() 函数：

```
do
      {
            DisplayMenu();

            option = GetMenuOption();

            switch (option)
            {
                case 1:
                    if (!CreateAccount())
                    {
                        Console.WriteLine("WARNING: Could not create account!");
                    }
                    break;
                case 2:
                    if (!DeleteAccount())
                    {
                        Console.WriteLine("WARNING: Could not delete account!");
                    }

                    break;
                case 3:
                    if (!UpdateAccount())
                    {
                        Console.WriteLine("WARNING: Could not update account!");
                    }

                    break;
                case 4: DisplayAccount();
                    break;
                case 5: status = false;
                    break;
                default: Console.WriteLine("ERROR: Invalid choice!");
                    break;
            }
        } while (status); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T20:52:51.943

我想你的`RunBankApplication`样子类似于：

```
public void RunBankApplication()
{
    var input = Console.ReadLine();
    switch (input)
    {
        case "1":
            Console.WriteLine("Enter Account Number: ");
            break;
        case "2":
            Console.WriteLine("Hello World!");
            break;
        default:
            break;
    }
} 
```

要了解`Console`使您的方法无法测试的固定依赖项，您应该在构造函数中注入此依赖项。

您需要一个定义依赖项的接口：

```
public interface IConsoleService
{
    string ReadLine();
    void WriteLine(string message);
} 
```

您为其创建一个默认实现：

```
public class ConsoleService : IConsoleService
{
    public string ReadLine()
    {
        return Console.ReadLine();
    }

    public void WriteLine(string message)
    {
        Console.WriteLine(message);
    }
} 
```

然后你在你的类中注入这个实现并在`BankManager`类中使用它：

```
public class BankManager
{
    private IConsoleService _consoleService;

    public BankManager(IConsoleService consoleService)
    {
        _consoleService = consoleService;
    }

    public void RunBankApplication()
    {
        var input = _consoleService.ReadLine();
        switch (input)
        {
            case "1":
                _consoleService.WriteLine("Enter Account Number: ");
                break;
            case "2":
                _consoleService.WriteLine("Hello World!");
                break;
            default:
                break;
        }
    }
} 
```

现在你可以在你的测试中模拟这个依赖了。[Moq](http://code.google.com/p/moq/)是这样一个模拟库的不错选择：

```
[TestClass]
public class UnitTest1
{
    [TestMethod]
    public void GetMessage_Input1_ReturnEnterAccountNumberMessage()
    {
        var consoleService = new Mock<IConsoleService>();
        consoleService.Setup(c => c.ReadLine()).Returns("1");

        var bankManager = new BankManager(consoleService.Object);
        bankManager.RunBankApplication();

        consoleService.Verify(c => c.WriteLine("Enter Account Number: "), Times.Once());
    }

    [TestMethod]
    public void GetMessage_Input2_ReturnHelloWorldMessage()
    {
        var consoleService = new Mock<IConsoleService>();
        consoleService.Setup(c => c.ReadLine()).Returns("2");

        var bankManager = new BankManager(consoleService.Object);
        bankManager.RunBankApplication();

        consoleService.Verify(c => c.WriteLine("Hello World!"), Times.Once());
    }
} 
```

当然，对于这样一个简单的例子来说，这有点过头了，但这种方法在大型项目中确实很有用。下一步，您可以使用[IoC 容器](http://www.martinfowler.com/articles/injection.html)在应用程序中自动注入您的依赖项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:12:29.667

自动化测试不应该有用户输入。您的测试需要提供参数，如果您依赖外部资源（WCF 服务、数据库、文件系统、用户输入等），那么您需要模拟它们。这就是像[Moq](http://code.google.com/p/moq/)这样的测试框架为您做的事情。

如果要测试 switch 语句的每个 case，则需要对每个 case 进行测试。

顺便说一句，您无法使用控制台，因为您的单元测试可能在类库中，而不是控制台应用程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:12:34.673

这不是正确的方法。您不应该在单元测试中与 Console 进行通信。只需提取与输入参数一起使用的函数并测试此函数。

像这样：

在 YourExtractedClass 中：

```
 public string GetMessage(string input)
        {
            var result = string.Empty;

            switch (input)
            {
                case "1":
                    result = "Enter Account Number: ";
                    break;
                case "2":
                    result = "Hello World!";
                    break;
                default:
                    break;
            }

            return result;
        } 
```

……

在 YourExtractedClass 的测试类中

```
 [Test]
    public void GetMessage_Input1_ReturnEnterAccountNumberMessage()
    {
        var result = GetMessage("1");
        var expected = "Enter Account Number: ";

        Assert.That(result == expected);
    }

    [Test]
    public void GetMessage_Input2_ReturnHelloWorldMessage()
    {
        var result = GetMessage("1");
        var expected = "Hello World!";

        Assert.That(result == expected);
    } 
```

还有一件事：最好将字符串（“输入帐号”等）移动到一个地方（例如某些常量类）。不要重复自己！

阅读有关单元测试的好书：

[单元测试的艺术：.Net 中的示例](https://rads.stackoverflow.com/amzn/click/com/1933988274)

[使用 NUnit 的 C# 中的实用单元测试，第 2 版](https://rads.stackoverflow.com/amzn/click/com/0977616673)

[xUnit 测试模式：重构测试代码](https://rads.stackoverflow.com/amzn/click/com/0131495054)

# android - 在 onDestroy() onPause() 之前创建的 Activity 中使用之前的 Handler 可以吗？

> ID：13405252
> 
> 赞同：0
> 
> 时间：2012-11-15T20:04:13.180
> 
> 标签：android

是否可以在 Activity 的下一个生命周期中重用之前在其上一个会话中创建的 Handler 对象（在 onPause、onDestroy() 之前）？

就像我在 Activity 中创建一个 Handler 将其传播到其他地方的其他对象一样，Activity 死掉或暂停，然后再次复活并使用旧的处理程序？

```
 // In the oncreate() method I have this code to recreate handler every time
    // Then I set the handler to a static Global object 
    // Other Objects use the global object's static method to get 
    //fresh handler every timebefore calling sendMessage()

        /**
     * Set up handler 
     */     
    Handler h = new Handler(new Callback() 
    {           
        public boolean handleMessage(Message msg) 
        {
            handleServiceMessage(msg);
            return true;
        }
    }); 

    uiglobal = new UIGlobals(h); 
```

UiGlobals 被声明为

```
 private static UIGlobals uiglobal = null; 
```

不确定上述方法是否正确..

我的 GlobalUI 类看起来像这样

```
 public class UIGlobals 
    {
         private static Handler handler = null; 
         public UIGlobals(Handler h)
        {
            handler = h;
        }   
        public static Handler getHandler()
        {
            return handler;
        }    
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:09:09.787

如果您已经构建了自定义处理程序类，这应该可以工作，但是如果您在活动中定义了自定义处理程序，则必须取消注册 onPause 中的所有处理程序消息。否则你会得到一个空指针异常。但是我不知道在哪种情况下您需要此功能...我通常使用 Handler 进行 UI 访问，但用于活动和逻辑观察者模式之间的通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:19:19.130

如果您的处理程序是静态的并且`Application`（不是活动）尚未从内存中删除，则下次活动开始时，静态对象将在那里。

如果您的处理程序是静态的并且`Application`已从内存中删除（即服务、线程等都已停止并且您退出唯一的活动活动），则下次启动活动时，`Aplication`将重新启动对象并重新创建静态对象。

如果您的处理程序不是静态的，那么您应该在每次创建活动时重新创建它，当然，您会得到一个新的。

如果您想获得更具体的答案，您需要发布代码或更具体地说明您的情况。

# java - Need help understanding where to handle exceptions in Android

> ID：13405263
> 
> 赞同：0
> 
> 时间：2012-11-15T20:04:49.690
> 
> 标签：java, android, exception, exception-handling, android-contentprovider

I am trying to come up with an exception handling strategy for my Android application (although this may also apply to any Java app). For example, I am looking at the delete() ContentProvider function in the example Notepad application:

```
public int delete(Uri uri, String where, String[] whereArgs) {
    SQLiteDatabase db = mOpenHelper.getWritableDatabase();
    int count;
    switch (sUriMatcher.match(uri)) {
        case NOTES:
            count = db.delete(NOTES_TABLE_NAME, where, whereArgs);
            break;

        case NOTE_ID:
            String noteId = uri.getPathSegments().get(1);
            count = db.delete(NOTES_TABLE_NAME, NoteColumns._ID + "=" + noteId
                    + (!TextUtils.isEmpty(where) ? " AND (" + where + ')' : ""), whereArgs);
            break;

        default:
            throw new IllegalArgumentException("Unknown URI " + uri);
    }

    getContext().getContentResolver().notifyChange(uri, null);
    return count;
} 
```

What happens if the `Uri` is null? or `getContext`()? or `getContentresolver`()?

I have come to the conclusion that the `ContentResolver` is not the place to catch the exceptions, but it should re-throw them or throw new exceptions so the app can display a meaningful error message.

Would the following or something similar be a bad approach (overkill) - should I just let `NullPointerException`s, etc. bubble up to the top to be handled in a more generic way (as per the example)?.

```
public int delete(Uri uri, String where, String[] whereArgs) 
    throws SQLiteException, IllegalArgumentException, NotifyException {

    if (null != mOpenHelper) {
       SQLiteDatabase db = mOpenHelper.getWritableDatabase();
       if (null != db) {
           if (null != uri) {
               int count = 0;
               switch (sUriMatcher.match(uri)) {
                   case NOTES:
                       count = db.delete(NOTES_TABLE_NAME, where, whereArgs);
                       break;

                   case NOTE_ID:
                       String noteId = uri.getPathSegments().get(1);
                       count = db.delete(NOTES_TABLE_NAME, NoteColumns._ID + "=" + noteId
                        + (!TextUtils.isEmpty(where) ? " AND (" + where + ')' : ""), whereArgs);
                       break;

                   default:
                       throw new IllegalArgumentException("Unknown URI " + uri);
               }

               if (null != getContext()) && (null != getContentResolver()) {
                   getContext().getContentResolver().notifyChange(uri, null);
               } else {
                   throw NotifyException("Failed to notify change");
               }
               return count;
            } else {
                throw new IllegalArgumentException("Must provide URI");
            }
        } else {
            throw new SQLiteException("Failed to get database");
        }
    } else {
        throw new SQLiteException("Invalid database helper");
    }
} 
```

Disclaimer: this code may not compile! it is an example.

It certainly is harder to read! I don't know what the right balance is and need some help!.

Update: I read through Android's recommended practices (see [http://source.android.com/source/code-style.html#java-language-rules](http://source.android.com/source/code-style.html#java-language-rules)) but it just confused me further!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:18:56.753

有不同的方法可以解决这个问题。我非常喜欢“清洁代码”这本书。

您可以使用一个简单的 try catch 块来捕获一般异常。在这个 catch 块中，您可以运行自己编写的失败方法 systemOutFailure(Uri, Context, ContentResolver)。此方法检查失败并抛出正确的异常。无论如何，我认为 getContext 永远不能为空。您还可以更进一步，不要使用失败方法，而是使用自己的失败类来处理异常并抛出正确的异常。

throws 的问题是你必须“把它翻过来”，所以它不是很好的 OO 设计——如果你必须对另一个异常进行更改或扩展，则 throws 是非常静态的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:27:58.697

处理异常的想法是清楚地表明发生错误的原因，并可能根据错误执行一些操作。所以，请考虑：

1.  定义自己的从 Java 异常派生的异常类

2.  将您的代码放在 try/catch 块中。当您捕获异常时，您会使用跟踪记录它，然后抛出您自己的异常并给出明确的解释。

3.  在某些时候，您会捕获自己的异常，提取信息并将信息显示在屏幕上或发送回程序用户（如果您提供 Web 服务）

代码示例：

```
public class MyException extends Exception {

public static final String MYSeparator = "!@#!";
public MyException() {
    super();
}

public MyException(String message) {
    super(message);
}

public MyException(Throwable cause) {
    super(cause);
}

public MyException(String message, Throwable cause) {
    super(message, cause);
}

public MyException(String errorCode, String errorDescription,
        Throwable cause) {
    super(errorCode + MYSeparator + errorDescription, cause);
}

public MyException(String errorCode, String errorDescription) {
    super(errorCode + MYSeparator + errorDescription);
} 
```

}

# sql-server - T-sql Reset Row number on Field Change

> ID：13405264
> 
> 赞同：12
> 
> 时间：2012-11-15T20:04:55.200
> 
> 标签：sql-server, tsql, sql-server-2005, reset, row-number

Similar to a recent post of mine "t-sql sequential duration"”, but not exactly the same, I want to reset the row number based on a change in column x (in my case, column "who").

Here's the first query that returns the a small sample of the raw(ish) data:

```
SELECT      DISTINCT chr.custno, 
            CAST(LEFT(CONVERT( VARCHAR(20),chr.moddate,112),10)+ ' ' + chr.modtime AS DATETIME)as  moddate, 
            chr.who     
FROM        <TABLE> chr 
WHERE       chr.custno = 581827
            AND LEFT(chr.who, 5) = 'EMSZC'
            AND chr.[description] NOT LIKE 'Recalled and viewed this customer'
ORDER BY    chr.custno 
```

Result:

```
custno      moddate             who
581827      2012-11-08 08:38:00.000     EMSZC14
581827      2012-11-08 08:41:10.000     EMSZC14
581827      2012-11-08 08:53:46.000     EMSZC14
581827      2012-11-08 08:57:04.000     EMSZC14
581827      2012-11-08 08:58:35.000     EMSZC14
581827      2012-11-08 08:59:13.000     EMSZC14
581827      2012-11-08 09:00:06.000     EMSZC14
581827      2012-11-08 09:04:39.000     EMSZC49 Reset row number to 1
581827      2012-11-08 09:05:04.000     EMSZC49
581827      2012-11-08 09:06:32.000     EMSZC49
581827      2012-11-08 09:12:03.000     EMSZC49
581827      2012-11-08 09:12:38.000     EMSZC49
581827      2012-11-08 09:14:18.000     EMSZC49
581827      2012-11-08 09:17:35.000     EMSZC14 Reset row number to 1 
```

Second step is to add the row number (I didn’t do this in the first query because of the use of the word DISTINCT); so…</p>

```
WITH c1 AS (
        SELECT      DISTINCT chr.custno
                    CAST(LEFT(CONVERT( VARCHAR(20),chr.moddate,112),10)+ ' ' + chr.modtime AS DATETIME)as moddate,
                    chr.who
        FROM        <TABLE> chr 
        WHERE       chr.custno = 581827
                    AND LEFT(chr.who, 5) = 'EMSZC'
                    AND chr.[description] NOT LIKE 'Recalled and viewed this customer'
        )

SELECT  ROW_NUMBER() OVER (PARTITION BY custno ORDER BY custno, moddate, who) AS RowID, custno, moddate, who
FROM    c1 
```

Result:

```
RowID   custno      moddate                      who
1       581827      2012-11-08 08:38:00.000     EMSZC14
2       581827      2012-11-08 08:41:10.000     EMSZC14
3       581827      2012-11-08 08:53:46.000     EMSZC14
4       581827      2012-11-08 08:57:04.000     EMSZC14
5       581827      2012-11-08 08:58:35.000     EMSZC14
6       581827      2012-11-08 08:59:13.000     EMSZC14
7       581827      2012-11-08 09:00:06.000     EMSZC14
8       581827      2012-11-08 09:04:39.000     EMSZC49 Reset row number to 1
9       581827      2012-11-08 09:05:04.000     EMSZC49
10      581827      2012-11-08 09:06:32.000     EMSZC49
11      581827      2012-11-08 09:12:03.000     EMSZC49
12      581827      2012-11-08 09:12:38.000     EMSZC49
13      581827      2012-11-08 09:14:18.000     EMSZC49
14      581827      2012-11-08 09:17:35.000     EMSZC14 Reset row number to 1 
```

The next step is where I’m stuck: the goal is to reset the RowID to 1 on each change of value in the “who” column. The following code gets an “almost there” result (and it should be noted that I stole/borrowed this code from somewhere, but now I can’t find the website):

```
WITH c1 AS (
        SELECT      DISTINCT chr.custno,
                    CAST(LEFT(CONVERT( VARCHAR(20),chr.moddate,112),10)+ ' ' + chr.modtime AS DATETIME)as moddate,
                    chr.who
        FROM        <TABLE> chr 
        WHERE       chr.custno = 581827
                    AND LEFT(chr.who, 5) = 'EMSZC'
                    AND chr.[description] NOT LIKE 'Recalled and viewed this customer'
        )
, c1a AS    (
            SELECT  ROW_NUMBER() OVER (PARTITION BY custno ORDER BY custno, moddate, who) AS RowID, custno, moddate, who
            FROM    c1
            )

SELECT  x.RowID - y.MinID + 1 AS Row,
        x.custno, x.Touch, x.moddate, x.who      
FROM    (
            SELECT  custno, who, MIN(RowID) AS MinID
            FROM    c1a
            GROUP BY custno, who
        ) AS y
        INNER JOIN c1a x ON x.custno = y.custno AND x.who = y.who 
```

Result:

```
Row custno      moddate                    who
1   581827      2012-11-08 08:38:00.000     EMSZC14
2   581827      2012-11-08 08:41:10.000     EMSZC14
3   581827      2012-11-08 08:53:46.000     EMSZC14
4   581827      2012-11-08 08:57:04.000     EMSZC14
5   581827      2012-11-08 08:58:35.000     EMSZC14
6   581827      2012-11-08 08:59:13.000     EMSZC14
7   581827      2012-11-08 09:00:06.000     EMSZC14
1   581827      2012-11-08 09:04:39.000     EMSZC49 Reset row number to 1 (Hooray! It worked!)
2   581827      2012-11-08 09:05:04.000     EMSZC49
3   581827      2012-11-08 09:06:32.000     EMSZC49
4   581827      2012-11-08 09:12:03.000     EMSZC49
5   581827      2012-11-08 09:12:38.000     EMSZC49
6   581827      2012-11-08 09:14:18.000     EMSZC49
14  581827      2012-11-08 09:17:35.000     EMSZC14 Reset row number to 1 (Crappies.) 
```

DESIRED result:

```
Row custno      moddate                     who
1   581827      2012-11-08 08:38:00.000     EMSZC14
2   581827      2012-11-08 08:41:10.000     EMSZC14
3   581827      2012-11-08 08:53:46.000     EMSZC14
4   581827      2012-11-08 08:57:04.000     EMSZC14
5   581827      2012-11-08 08:58:35.000     EMSZC14
6   581827      2012-11-08 08:59:13.000     EMSZC14
7   581827      2012-11-08 09:00:06.000     EMSZC14
1   581827      2012-11-08 09:04:39.000     EMSZC49 Reset row number to 1 
2   581827      2012-11-08 09:05:04.000     EMSZC49
3   581827      2012-11-08 09:06:32.000     EMSZC49
4   581827      2012-11-08 09:12:03.000     EMSZC49
5   581827      2012-11-08 09:12:38.000     EMSZC49
6   581827      2012-11-08 09:14:18.000     EMSZC49
1   581827      2012-11-08 09:17:35.000     EMSZC14 Reset row number to 1 
```

Any assistance is appreciated.

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-18T13:10:31.550

如果您使用的是 SQL Server 2012，则可以使用[LAG](http://msdn.microsoft.com/en-us/library/hh231256.aspx)将值与前一行进行比较，并且可以使用[SUM](http://msdn.microsoft.com/en-us/library/ms187810.aspx)和[OVER](http://msdn.microsoft.com/en-us/library/ms189461.aspx)来记录更改。

```
with C1 as
(
  select custno,
         moddate,
         who,
         lag(who) over(order by moddate) as lag_who
  from chr
),
C2 as
(
  select custno,
         moddate,
         who,
         sum(case when who = lag_who then 0 else 1 end) 
            over(order by moddate rows unbounded preceding) as change 
  from C1
)
select row_number() over(partition by change order by moddate) as RowID,
       custno,
       moddate,
       who
from C2 
```

[SQL小提琴](http://sqlfiddle.com/#!6/501c0/2/0)

**更新：**

SQL Server 2005 的一个版本。它使用递归 CTE 和临时表来存储您需要迭代的数据。

```
create table #tmp
(
  id int primary key,
  custno int not null,
  moddate datetime not null,
  who varchar(10) not null
);

insert into #tmp(id, custno, moddate, who)
select row_number() over(order by moddate),
       custno,
       moddate,
       who
from chr;

with C as
(
  select 1 as rowid,
         T.id,
         T.custno,
         T.moddate,
         T.who,
         cast(null as varchar(10)) as lag_who
  from #tmp as T
  where T.id = 1
  union all
  select case when T.who = C.who then C.rowid + 1 else 1 end,
         T.id,
         T.custno,
         T.moddate,
         T.who,
         C.who
  from #tmp as T
    inner join C
      on T.id = C.id + 1
)
select rowid,
       custno,
       moddate,
       who
from C
option (maxrecursion 0);

drop table #tmp; 
```

[SQL小提琴](http://sqlfiddle.com/#!3/a649e/1/1)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-12-15T17:12:31.723

我通过使用 Rank() 成功解决了这个问题：

```
SELECT RANK() OVER (PARTITION BY who ORDER BY custno, moddate) AS RANK 
```

这返回了您想要的结果。我实际上发现这篇文章试图解决同样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:08:34.540

代替：

```
PARTITION BY custno ORDER BY custno, moddate, who) 
```

尝试：

```
PARTITION BY custno, who ORDER BY custno, moddate) 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-17T14:47:46.603

我能想到的唯一解决方案是使用游标（呃）并经历 RBAR 过程。这不是一个优雅的解决方案，因为光标必须读取超过 1m 行。真可惜。

# html - Enabling target=_'parent' in Google Fusion Map infowindow using click listener

> ID：13405267
> 
> 赞同：1
> 
> 时间：2012-11-15T20:05:05.900
> 
> 标签：html, google-maps, google-maps-api-3, google-fusion-tables

I'm quite new to Google Fusion, but keen to learn. I've created a map, customized the infowindow and embedded the map onto my site using FusionTablesLayer Wizard to create a script to be hosted on the same domain. Doing it that way, I thougt it would be possible using target=_parent for my links in the infowindow in stead of the ever annoying target=_blank command. Since then I've found out, that due to security, you have to add a click listener to be able to get trget=_parent working, and this is where my abilities come to a stop. Can anyone help me enable the listener, configure the infowindow and most important of all, get target=_parent working.

Here's some code, I hope you can use.

**Infowindow:**

```
<div class='googft-info-window' style='font-family:Georgia, sans-serif' "width: 250px;" >
<base target="_parent" />
<b><a href="{info-URL} " ">{Skole}</a></b></b><br>
<i>Åbner i ny fane/nyt vindue</i><br><br>
{Adresse}<br><br>
<b>Elevtal:</b> {Elevtal}<br>
<b>Rang 2010/2011:</b> {Rangering til kort}/107<br><br>
<b>Gennemsnit 2010/2011</b><br>
<b>Dansk:</b> {Dansk total}<br>
<b>Engelsk:</b> {Engelsk total}<br>
<b>Fysik/kemi:</b> {Fysik/kemi total}<br>
<b>Matematik:</b> {Matematik total}<br><br>
<b>Samlet gennemsnit:</b> {Skolegennemsnit}<br><br>
{NOTE}<br><br>
<a href="{Skole-URL}" target=_blank>Hjemmeside</a>
</div> 
```

**FusionTablesLayer Wizard code**

```
<!DOCTYPE html>
<html>
  <head>
<base target="_parent" />
  <style>
    #map-canvas { width:700px; height:400px; }
  </style>
  <script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false">
  </script>
  <script type="text/javascript">
    var map;
    var layerl0;
    function initialize() {
      map = new google.maps.Map(document.getElementById('map-canvas'), {
        center: new google.maps.LatLng(57.17199198214385, 9.771527295703208),
        zoom: 8
      });
      var style = [
        {
          featureType: 'all',
          elementType: 'all',
          stylers: [
            { saturation: 9 }
          ]
        }
      ];
      var styledMapType = new google.maps.StyledMapType(style, {
        map: map,
        name: 'Styled Map'
      });
      map.mapTypes.set('map-style', styledMapType);
      map.setMapTypeId('map-style');
      layerl0 = new google.maps.FusionTablesLayer({
        query: {
          select: "'col2'",
          from: 'table-id'
        },
        map: map,
        styleId: -1,
        templateId: 1
      });
    }
    google.maps.event.addDomListener(window, 'load', initialize);
  </script>
  </head>
  <body>
    <div id="map-canvas"></div>
  </body>
</html> 
```

The map is online at [www.skoleguide.net](http://www.skoleguide.net) right now and the inspiration to add a click listener, I got from [here](http://code.google.com/p/fusion-tables/issues/detail?id=338)

I really hope, someone out there can help me

Jens Skriver Steffensen

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:04:28.680

要将“target=_parent”添加到 FusionTables 中的预先存在的内容中，应该可以这样：

```
var newContent = e.infoWindowHtml.replace("/<a /<a target='_parent' /g"); 
```

[您使用google.maps.addListener](https://developers.google.com/maps/documentation/javascript/reference#MapsEventListener)方法添加点击收听您的 FusionTable

像这样的东西应该工作：

```
 //add a click listener to the layer
  google.maps.event.addListener(layer10, 'click', function(e) {
    //update the content of the InfoWindow
    var newContent = e.infoWindowHtml.replace("/<a /<a target='_parent' /g");
    infowindow.setOptions({
       content: newContent,
   pixelOffset: e.pixelOffset,
   position: e.latLng
   });
    infowindow.open(map);
  }); 
```

请务必通过在 FusionTablesLayer 构造函数中添加“suppressInfoWindows: true”选项来禁用默认信息窗口。

[工作示例](http://www.geocodezip.com/v3_SO_FusionTables_openInfowindowInParentE.html)

# c++ - 将 Mach-O 可执行文件与静态库合并？

> ID：13405270
> 
> 赞同：7
> 
> 时间：2012-11-15T20:05:34.223
> 
> 标签：c++, ios, mach-o

假设你有

1.  一个预构建的 iOS 可执行应用程序（用于模拟器或设备）。
2.  一个预构建的静态存档库静态库，其中包含 c++ 静态初始化程序。

现在应该可以合并两个构建的产品以生成一个新的 iOS 可执行文件，它与旧的一样，除了它现在还与附加的静态库链接，并且在执行时将运行静态库的静态初始化程序。

哪个工具（如果有）可以帮助解决这个合并问题？

编辑：一个可接受的解决方案也是使用 dlopen 动态加载库。这样做的全部目的是为了应用程序测试，所以重新链接的应用程序永远不会看到应用程序商店。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T13:48:02.440

## 编译器的工作原理（简单解释）

最流行的 C++ 编译器（比如 GCC）通过将所有 C++（以及 Obj-C、C 等）代码转换为 ASM 来工作。

然后它为目标处理器调用适当的汇编程序，并创建对象二进制文件。

然后它调用链接器，在这些二进制文件中搜索解释什么与什么链接的符号。链接器可以做的一个常见优化也是从静态链接的库中删除最终二进制文件中未使用的任何内容，其他常见的优化是不尝试链接所有未使用的库。

最后，链接器删除了它只需要的东西。

## 这对你来说意味着什么

你有一个图书馆，图书馆有链接符号。您还有一个可执行文件，它的链接符号被剥离，实际上取决于它是如何优化的，内部跳转可能只有几条 jmp 指令到代码上的任意地址。没有机器可以自动执行您想要的操作，因为您没有可执行文件所需的信息。

## 无论如何要怎么做

您需要反汇编可执行文件，自行确定函数调用的位置，然后使用库手动重新组装它，将这些函数调用更改为跳转到库中的地址。

这个过程有时被游戏修改者用来更改旧游戏的视频驱动程序（例如更新他们的 OpenGL 版本，或者强制 Glide 游戏使用一些更新的驱动程序，等等）。

因此，如果您无论如何都想这样做（我警告您：尽管这样做是荒谬的疯狂...），请问那些人:)我现在不记得有人指向您，但是它们确实存在。

## 比喻

当您处于正常链接阶段时，编译后的目标文件就像机器可以理解的源代码，根据需要充满了函数调用。

编译后，所有的函数调用都变成了goto。

因此，如果你是一个负责做你想做的事情的链接器，想象一下你正在阅读一个充满 goto 的源代码到代码中的随机位置（有时甚至是内部循环），并且你必须以某种方式弄清楚哪些是那些你想改变跳到你试图粘贴在那里的新部分。

# python - Python重定向标准输入

> ID：13405277
> 
> 赞同：1
> 
> 时间：2012-11-15T20:05:45.720
> 
> 标签：python, usb, barcode, stdin

我正在尝试设置一个条形码扫描仪对象，该对象将捕获来自扫描仪本身的任何输入。条形码扫描仪被识别为标准输入 (stdin)，因此每当我扫描条形码时，我都会得到标准输入文本。系统还将连接一个键盘，这是另一个标准输入。为了区分条形码扫描输入和键盘输入，我将为任何条形码信息使用前缀。换句话说，如果我的条形码总长度为 16 个字符，则前 4 个字符将是一个预定的字符串/键，以指示后面的 12 个字符是条形码输入。从我读过的内容来看，这是非常标准的。

现在，我看到的大多数示例都将通过在 GUI 应用程序中捕获字符输入事件来识别条形码输入。然后，此事件回调方法构建一个缓冲区以检查 4 个字符前缀并根据需要重定向条形码输入。事件回调方法还将跳过任何与条形码无关的字符输入事件，并允许它们与 GUI 交互，就像通常的标准输入一样（在文本框中键入或你有什么）。

除了不使用 GUI 应用程序外，我想做同样的事情。我希望我的条码扫描器对象独立于 GUI 应用程序。理想情况下，我会在条形码扫描仪对象内有一个回调方法，每次输入字符时标准输入都会调用该方法。从那里我将通过检查 4 个字符前缀来获取任何条形码输入，并传递不属于条形码输入的任何字符。所以换句话说，我希望标准输入通过我的条码扫描器回调方法，然后让我的条码扫描器回调方法能够将非条码字符作为标准输入返回，就好像什么都没发生一样（仍然是标准输入那会去一个文本框或其他东西）。

如果没有一个持续监控标准输入的while循环，这可能吗？即使我有一个 while 循环监视标准输入，如果它们不是条形码输入，我将如何将字符作为标准输入泵出？我研究过使用 pyusb 来接管条形码扫描仪的 USB 接口，但这需要 root 权限才能与硬件交互（这不是我的项目的选项）。任何帮助将不胜感激。我还没有找到这样的例子。

编辑：这个项目将在 CentOS 或某种 Linux 版本中运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:37:50.717

在 Unix 中拦截标准输入的正常方式是管道和多进程。如果您有一个多进程应用程序，那么一个进程可以接收“原始”标准输入，捕获条形码输入，并将其余的传递给它的标准输出。然后，该输出将成为您的 UI 流程的标准输入，它只会接收非条形码数据。要进行初始设置，请使用一个启动进程来设置管道、启动其他两个进程并退出。

如果您不熟悉这些概念，那么您将面临一个漫长而有趣的学习过程 :-)

所有这些都假设您确实是通过标准输入接收“键盘”数据，而不是您似乎暗示的通过 X11 事件。如果您在 X11（或 GTK 等）内开发，那么我所描述的几乎肯定不会工作。

# jquery-selectors - In JQuery, how to filter by both "button" and "not in class"?

> ID：13405282
> 
> 赞同：0
> 
> 时间：2012-11-15T20:06:04.773
> 
> 标签：jquery-selectors

In jQuery selector, I know hot select all Button:

```
$("input:button") 
```

And how to not contain class

```
$("input:not(.class1)") 
```

But how do you filter by both?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:07:14.053

```
$("input:button:not(.class1)") 
```

FWIW，考虑使用`<button>`而不是`<input type="button">`在有意义的时候这样做......例如，如果您的按钮输入没有值，*为什么它会是一个输入元素*？

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:02:08.893

您可以使用`.filter()`

```
$("input[type='button']").filter(':not(.class1)') 
```

# java - How to replace using regular expression in nested string?

> ID：13405284
> 
> 赞同：0
> 
> 时间：2012-11-15T20:06:10.250
> 
> 标签：java, regex

I have this: `start_xxx_end_Leftstart_xxx_end_Right`

How can I use the regular expression to remove characters between `start` and `end` (inclusive) so that I can get the following string:

`_Left_Right`

I tried this regex in java but it removes EVERYTHING between `start` and `end`:

`start(.*)end`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:09:18.077

只需使用`replaceAll`方法将子字符串替换`start`为`end`： -

```
String str = "start_xxx_end_Leftstart_xxx_end_Right";
str = str.replaceAll("start.*?end", "");
System.out.println(str); 
```

**输出 ： -**

```
"_Left_Right" 
```

# actionscript-3 - Is there a way to embed a compile-time dynamic timestamp in a Flash AS3 movie?

> ID：13405285
> 
> 赞同：2
> 
> 时间：2012-11-15T20:06:17.950
> 
> 标签：actionscript-3, flash, compile-time-constant

Background: I manually update a version timestamp in my Flash document, which is displayed on the log-in screen of the application at run time. This helps me verify that I have the latest version loaded in the browser, rather than some cached version.

The declaration for the variable is:

```
public static var version:String = "v 2012.11.14.1854"; //yyyy.mm.dd.hhmm 
```

Is there a way to have this value automatically updated to the current system time when the document is compiled in the flash IDE? Perhaps with some kind of "compile time variable".

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T14:42:34.487

a) 您可以创建 ANT 任务来构建，并且可以在那里设置变量，但如果您是单独开发而不使用 SVN 或 Perforce，这是一个相当复杂的解决方案。

b）我不确定它是否会起作用，但使用额外的编译器参数（项目属性> Actionscript 编译器）

```
-date text 
```

这会在生成的 SWF 文件中设置元数据。我不确定，您如何访问它，我还没有测试过。

# javascript - Need help getting multiple tables working on a single page using simple data grid

> ID：13405287
> 
> 赞同：2
> 
> 时间：2012-11-15T20:06:19.937
> 
> 标签：javascript, jquery, jquery-plugins

I am attempting to use "[simple data grid](http://mbraak.github.com/simple-data-grid/#api-data-callback)" to display multiple unique (tables) grids on a single page. In the code below I am unclear how to pass unique data to the function below instead of var data = ExampleData.fruits. Every attempt I have made so far to add a second table with unique data results in all data being broken. (I do need all the existing functionality sorting highlighting on click, pagination etc).

I have created this [jsfiddle](http://jsfiddle.net/Nehfs9/Ee3an) that is working with a single grid and the sample data. I have commented out a bit of code for a second set of data that I was trying to work with.

```
ExampleData = {};
ExampleData.handleMockjaxResponse = function(settings) {
var uri = new Uri(settings.url);
var page = uri.getQueryParamValue('page') || 1;
var order_by = uri.getQueryParamValue('order_by');
var sortorder = uri.getQueryParamValue('sortorder');
var rows_per_page = 6;
var start_index = (page - 1) * rows_per_page;
var total_pages = 1;
var data = ExampleData.fruits; //How can I pass this data so that multiple tables can exist with different data
if (data.length != 0) {
    total_pages = parseInt((data.length - 1) / rows_per_page) + 1;
}
if (order_by) {
    data.sort(function(left, right) {
        var a = left[order_by];
        var b = right[order_by];

        if (sortorder == 'desc') {
            var c = b;
            b = a;
            a = c;
        }
        if (a < b) {
            return -1;
        }
        else if (a > b) {
            return 1;
        }
        else {
            return 0;
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T00:48:55.190

您的问题的根源是您试图在同一个 url ( `'*'`) 上设置两个 mockjacks。你不能同时拥有它们。

如果您需要为给定的 URL 替换 mockjack，您需要首先摆脱旧的：

```
$.mockjaxClear();
$.mockjax({
    url: '*',
    response: ... // whatever
}); 
```

但这**仍然**不能完全解决您的问题。通过在安装第二个模型之前清除第一个模型，我能够显示两个数据网格。但是尝试导航`#grid`表格会导致一些有趣的错误（当然），因为应该提供数据的 mockjack`#grid`在我们设置时已被删除`#grid2`。

这是你应该做的：

*   为每个表使用不同的 URL
*   为每个 URL 设置不同的 mockjacks

我用一个解决方案**[叉了你的小提琴。](http://jsfiddle.net/slashingweapon/qyW4y/)**它使用数据说明符来指示要使用的数据集，以及用于数据响应回调的传统 lambda 函数。

```
function generateMockjackResponse(dataIn) {
    return function(settings) {
        var uri = new Uri(settings.url);
        var page = uri.getQueryParamValue('page') || 1;
        var order_by = uri.getQueryParamValue('order_by');
        var sortorder = uri.getQueryParamValue('sortorder');

        var rows_per_page = 6;
        var start_index = (page - 1) * rows_per_page;

        var total_pages = 1;
        var data = dataIn;

        if (data.length != 0) {
            total_pages = parseInt((data.length - 1) / rows_per_page) + 1;
        }

        if (order_by) {
            data.sort(function(left, right) {
                var a = left[order_by];
                var b = right[order_by];

                if (sortorder == 'desc') {
                    var c = b;
                    b = a;
                    a = c;
                }

                if (a < b) {
                    return -1;
                }
                else if (a > b) {
                    return 1;
                }
                else {
                    return 0;
                }
            });
        }
        var result = {
            total_pages: total_pages,
            rows: data.slice(start_index, start_index + rows_per_page)
        };
        this.responseText = result;
    };
}

var data1 = [
    // some data
];

var data2 = [ 
    // other data 
];

$.mockjax({
    url: '*',
    data: 1,
    response: generateMockjackResponse(data1)
});

$('#grid1').simple_datagrid({
    order_by: true,
    data: 1
});

$.mockjax({
    url: '*',
    data: 2,
    response: generateMockjackResponse(data1)
});

$('#grid2').simple_datagrid({
    order_by: true,
    data: 2
}); 
```

# c++ - C ++从文件中写入多个字符串

> ID：13405289
> 
> 赞同：-2
> 
> 时间：2012-11-15T20:06:27.060
> 
> 标签：c++, string, ifstream, standard-deviation

快速提问。我正在为一个 uni 作业做我的投资组合 C++ 问题。是标准差。我的问题与从文件中读取多个字符串有关，请参见此处的文本；

> 设计并编写一个 c++ 程序，从文件中读取一组分数`scored.dat`，并将它们的均值和标准差输出到`cout`.

我不会打扰实际的方程式，我已经将那部分几乎排序了。我的查询直接基于将从文件中读取的文本输出到字符串中。例如，如果文档有这三个分数：

```
10
15
11 
```

它不会按原样输出文本，而是将它们放入三个字符串中；

> Score_One（10 分）
> Score_Two（15 分）
> Score_Three（11 分）

我希望我在这里有意义。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:23:17.967

这是一个写起来很有趣的解决方案，但我几乎不希望出现这种解决方案。它也可能具有一些娱乐和/或教育价值。基本思想是值 a 写为

```
 std::cout << 10 << 15 << 11 << reset << '\n';
    std::cout << 1 << 2 << 3 << reset << '\n'; 
```

为了实现这一点，需要一些机器，但它并没有那么糟糕，真的。代码很糟糕：

```
#include <locale>
#include <iostream>
#include <algorithm>

static int index(std::ios_base::xalloc());
static std::string const names[] = { "One", "Two", "Three", "Four", "Five" };
static std::string const score("Score_");
static std::string const other(" (Which would be ");
std::ostream& reset(std::ostream& out)
{
    out.iword(index) = 0;
    return out;
}

struct num_put
    : std::num_put<char>
{
    iter_type do_put(iter_type to, std::ios_base& fmt, char_type fill,
                     long v) const {
        to = std::copy(score.begin(), score.end(), to);
        if (fmt.iword(index) < 5) {
            to = std::copy(names[fmt.iword(index)].begin(),
                           names[fmt.iword(index)].end(), to);
            ++fmt.iword(index);
        }
        else {
            throw std::runtime_error("index out of range!");
        }
        to = std::copy(other.begin(), other.end(), to);
        to = this->std::num_put<char>::do_put(to, fmt, fill, v);
        *to++ = ')';
        *to++ = ' ';
        return to;
    }
};

int main()
{
    std::cout.imbue(std::locale(std::locale(), new num_put));
    std::cout << 10 << 15 << 11 << reset << '\n';
    std::cout << 1 << 2 << 3 << reset << '\n';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:47:22.627

你需要做这样的事情：

```
int raw_score_one = 11; //you have already set this but for the sake of clarity
std::stringstream output;
output << raw_score_one;
std::string Score_One = output.str(); 
```

对于每个分数...

# java - Regex correction

> ID：13405293
> 
> 赞同：-2
> 
> 时间：2012-11-15T20:06:38.477
> 
> 标签：java, regex

I'm using this regular expression to parse a string like `"CALENDAR YEAR: 2012"`.Can someone suggest a better one ? And I want to use matcher.find() `(CALENDAR YEAR:\\s+)?((2\\d\\d\\d))`

I want to get 2012 in a group.

I can't understand why it prints null when i do this:

```
 while (myMatcher.find()) {
     System.out.println(myMatcher.group(1));
     System.out.println(myMatcher.group(2));

    }

CALENDAR YEAR: 
2012
null
null 
```

EDIT: How will I change the expression if the code is using matches and i Still want to parse the year out of the string?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:11:45.753

您根本不需要使用额外的组 - 使用正则表达式模式

```
(?<=CALENDAR YEAR: )2\\d{3}(?!\\d) 
```

...结果将在

```
myMatcher.group(0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:32:24.177

**阅读正则表达式手册**。

显然，您不知道何时使用该`?`角色，何时不使用。或者什么时候使用`()`...

你可以离开它。

```
CALENDAR YEAR:\s+(\d{4}) 
```

应该已经成功了。但是您只是将随机字符放入您的正则表达式中，而不是查看周围的各种示例。

# google-app-engine - 获取在 Google App Engine 服务页面上列出的 python 库

> ID：13405299
> 
> 赞同：0
> 
> 时间：2012-11-15T20:06:47.153
> 
> 标签：google-app-engine

让您的 python 库在 Google App Engine 服务页面上列出的过程是什么。

[https://developers.google.com/appengine/docs/python/tools/libraries27](https://developers.google.com/appengine/docs/python/tools/libraries27)

谷歌是否要求我们经过一些审查程序，才能将我们的库列在上面的页面上。还是根据图书馆本身的需求决定的。（例如，如果库 X 非常受欢迎，谷歌会与库开发人员交谈并询问他们是否可以在上面的页面上上传该库）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:01:57.360

这些库被认为被广泛使用。如果您想列出特定的库，您可能应该首先提交功能请求：[http ://code.google.com/p/googleappengine/issues/list](http://code.google.com/p/googleappengine/issues/list)

您需要让 Google 相信您添加的任何库都已被广泛使用。本质上，您需要说服人们在创建请求后为其加注星标。

大多数库不需要包含在 App Engine SDK 中。只需提供源代码，让人们将其包含在自己项目的代码中。

# java - 如何根据起源地不同处理骆驼交换？

> ID：13405301
> 
> 赞同：0
> 
> 时间：2012-11-15T20:06:49.133
> 
> 标签：java, servlets, apache-camel

我有一个带有多个入口点（servlet 和 direct）的路由。通过servlet激活时需要做一定的工作。必须为 servlet 请求完成这项工作（即使存在不良行为者）。如果是通过直接进行的交流，则不得进行此项工作。这是代码中的示例：

```
// In a Route Builder somewhere.
from("servlet:///myService").inOut("direct:myService");
from("direct:myService").process(new ConditionalProcessor());

// Implementation of processor above.
public class ConditionalProcessor implements Processor {

    @Override
    public void process(Exchange exchange) throws Exception {
        if(comesFromServlet(exchange)){
            // Logic for Servlet.
        } else {
            // Logic for direct and other.
        }
    }

    /**
     * Must return true if the exchange started as a request to the servlet.
     * Otherwise must return false.
     * 
     * @param exchange
     * @return
     */
    public boolean comesFromServlet(Exchange exchange){
        // What goes here?
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T14:28:13.393

Exchange 上还有一个 API，可以告诉您它是从哪个端点创建的。 [http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/Exchange.html#getFromEndpoint](http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/Exchange.html#getFromEndpoint) ()

```
exchange.getFromEndpoint().getEndp 
```

另一种方法是，如果您为您的路线分配 id，您也可以获得这个

```
String fromRoute = exchange.getFromRouteId(); 
```

您可以使用 .routeId("myRouteId") 将 id 分配给路由

```
from("servlet:///myService").routeId("myRouteId") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:06:49.133

我受到另一篇文章的[评论的启发。](https://stackoverflow.com/a/10107217/170587)这是我的解决方案：

```
// In a Route Builder somewhere.
from("servlet:///myService")
    .setHeader(ConditionalProcessor.PROPERTY, constant(true))
    .inOut("direct:myService");
from("direct:myService").process(new ConditionalProcessor());

// Implementation of processor above.
public class ConditionalProcessor implements Processor {
    public static final String PROPERTY = "came.from.servlet";
    @Override
    public void process(Exchange exchange) throws Exception {
        if(comesFromServlet(exchange)){
            // Logic for Servlet.
        } else {
            // Logic for direct and other.
        }
    }

    public boolean comesFromServlet(Exchange exchange){
        return exchange.getProperty(PROPERTY, true, Boolean.class);
    }

} 
```

# java - 在进行下一个活动之前，我无法绘制 UI

> ID：13405303
> 
> 赞同：1
> 
> 时间：2012-11-15T20:06:51.483
> 
> 标签：java, android, xml, user-interface

当我运行它时，它应该绘制 ui，（两个简单的图像和一个文本静态文本字段）等待五秒钟，然后前进到下一个活动（另一个带有几个按钮的页面）

我可以让它加载图像而不是前进，或者显示一个空白页面，等待五，然后继续。

主要的java文档：

```
package com.example.ccbc_maps;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;

public class MainActivity extends Activity 
{

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        //When I add a call to the main function here it just displays the white space
        //Then advances after five seconds same thing if I paste the code within
        //The main method.
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
     }

    public void main()
    {
        try 
        {
            Thread.sleep(5000);
        } 
        catch (InterruptedException e) 
        {

        }

        Intent goForward = new Intent(this, CampusSelect.class);
        startActivity(goForward);
    }
} 
```

这是它前进的课程：

```
package com.example.ccbc_maps;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class CampusSelect extends Activity 
{

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_campus_select);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        getMenuInflater().inflate(R.menu.activity_campus_select, menu);
        return true;
    }
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:10:16.713

这是因为您的活动仅在 onCreate() 方法完成后可见

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:12:19.987

事情没有按预期工作，因为您正在强制主线程（UI 线程）进入睡眠状态。

当您修改 UI 时，例如调用`setContentView()`或修改视图的属性，它们不会立即发生。相反，它们被放入消息队列中，稍后由主线程执行。

您实际上需要在单独的线程中进行等待。可能完成您想要做的最简单的方法是使用[Handler.postDelayed()](http://developer.android.com/reference/android/os/Handler.html#postDelayed%28java.lang.Runnable,%20long%29)来安排稍后在主线程上完成的一些工作。

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.R.layout.activity_main);

    new Handler().postDelayed(new Runnable()
    {
        @Override
        public void run()
        {
            Intent goForward = new Intent(MainActivity.this, CampusSelect.class);
            startActivity(goForward);
        }
    }, 5000);
} 
```

# casperjs - CasperJS 同时请求

> ID：13405310
> 
> 赞同：7
> 
> 时间：2012-11-15T20:07:17.127
> 
> 标签：casperjs

假设我有一个 url 数组。我不想使用 thenOpen 函数。因为它等待每个先前的 url 被加载并且它减少了加载时间。

```
 casper.each(hrefs,function(self,href){
      self.thenOpen(href,function(){ });
      self.then(function(){
        //  Selectors
     }); 
```

});

与上述方法相比，您将使用哪些方法花费更少？在数据库中创建多个实例存储然后获取是否有效......但这很让人头疼。并且还希望您也回答一般情况下我同时运行同一个 js 文件的多个实例时会遇到问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-18T01:45:28.913

如果您不关心正在打开的所有 URL 之间的同步行为，那么您应该为每个 URL 启动多个 casper 实例。这是一个例子：

```
var casperActions = {
  href1: function (casper) {
    casper.start(address, function() {...});
    // tests and what not for href1
    casper.run(function() {...});
  },
  href2: function (casper) {
    casper.start(address, function() {...});
    // tests and what not for href2
    casper.run(function() {...});
  },
  ...
};

['href1', 'href2', ...].each(function(href) {
  var casper1 = require('casper').create();
  casperActions[href](casper);
}); 
```

每个实例将彼此独立运行，但它允许您同时访问多个 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T07:18:21.047

如果您想等待每个操作完成以对一系列步骤进行排序，请查看 casper 附带的此示例：[https ://github.com/n1k0/casperjs/blob/1.0/samples/multirun.js](https://github.com/n1k0/casperjs/blob/1.0/samples/multirun.js)

# java - 设置目录的读取权限

> ID：13405311
> 
> 赞同：0
> 
> 时间：2012-11-15T20:07:23.520
> 
> 标签：java, permissions, javafx

> **可能重复：**
> [如何以编程方式更改文件权限？](https://stackoverflow.com/questions/664432/how-do-i-programmatically-change-file-permissions)

我想为某个目录设置读取权限。因为我想使用[java.io.File 中的 list() 方法](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#list%28%29)，但是当我打印例如这个时：

```
System.out.println(fileDir.list()); 
```

我得到“null”，根据文档，这可能意味着我没有文件所在目录的权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:13:16.370

您可以使用[JNA](https://github.com/twall/jna/)调用本机 C 库（作为使用 JNI 的替代方法）。

JNA 的唯一问题是它的处理时间比 JNA 长，因此如果您尝试修改大量文件/目录，则变得不切实际。

**编辑代码**

```
import com.sun.jna.Library;
import com.sun.jna.Native;

public class ChmodTest {
    private static LinkedOSLibrary linkedLibrary = 
        (LinkedOSLibrary ) Native.loadLibrary("c", LinkedOSLibrary.class);

    public static void main(String[] args) {
        linkedLibrary.chmod("/path/to/file", 0755);
    }
}

interface LinkedOSLibrary extends Library {
    public int chmod(String path, int mode);
} 
```

[资源](http://www.experts-exchange.com/Programming/Languages/Java/A_1498-File-permissions-with-Java.html)

# javascript - Javascript 语法错误“超出范围”

> ID：13405312
> 
> 赞同：0
> 
> 时间：2012-11-15T20:07:26.087
> 
> 标签：javascript, syntax

我从事 Web 开发已经有一段时间了，但从未见过 JavaScript 的这种行为。这是我开始使用的代码：

```
function processLogin() {
    if (loginReq.readyState == 4) {
        var data = eval('(' + loginReq.responseText + ')');
        data = data.userData;
        var focus = data.team.focus.coordinates;
        thisTeam = new Team(data.team.id, data.team.missionId, data.team.name, data.team.operatingArea.coordinates[0]);
        if (data.team.zoomLevel != '') {
            thisTeam.zoomLevel = data.team.zoomLevel;
        }
        if (focus.length > 0) {
            thisTeam.focusLat = focus[1];
            thisTeam.focusLon = focus[0];
        }
        for (var i = 0; i < data.teams.length; i++) {
            var temp_team = new Team(data.teams[i].id, data.teams[i].missionId, data.teams[i].name, []);
            teams.push(temp_team);
        }
        var teamDropDownText = [];
        for (var j = 0; j < teams.length; j++) {
            if (thisTeam.teamId == teams[j].teamId) {
                teamDropDownText.push('<option value="' + teams[j].teamId + '" selected="selected">' + teams[j].name + '</option>');
            } else {
                teamDropDownText.push('<option value="' + teams[j].teamId + '">' + teams[j].name + '</option>');
            }
        }
        $('#addIncidentTeam').html(teamDropDownText.join(''));
        $('#editIncidentTeam').html(teamDropDownText.join(''));
        // When all this has finished, make the
        //      rest of the calls to get the rest of the data
        startTimer();
        downloadDevices();
        initializeMap();
    }
} 
```

我在那里写的并不那么重要，让我解释一下原因。

后面带有单个分号的行在`thisTeam.zoomLevel = data.team.zoomLevel;`萤火虫中给了我一个语法错误。我反复阅读我的代码，但无法弄清楚我做错了什么，所以我将分号放在同一行`thisTeam.zoomLevel = data.team.zoomLevel`，它告诉我它在空白行上有语法错误！

为了进行另一项测试，我将整个函数移到它自己的 JavaScript 文件中，并将该行之后的所有内容放在一行，甚至尝试压缩上面的一些代码，所以现在看起来像这样：

```
function processLogin() {
if (loginReq.readyState == 4) {
    var data = eval('(' + loginReq.responseText + ')');
    data = data.userData;
    var focus = data.team.focus.coordinates;
    thisTeam = new Team(data.team.id, data.team.missionId, data.team.name, data.team.operatingArea.coordinates[0]); if (data.team.zoomLevel.length > 0) { thisTeam.zoomLevel = data.team.zoomLevel; } if (focus.length > 0) { thisTeam.focusLat = focus[1];thisTeam.focusLon = focus[0];} for (var i = 0; i < data.teams.length; i++) { var temp_team = new Team(data.teams[i].id, data.teams[i].missionId, data.teams[i].name, []); teams.push(temp_team); } var teamDropDownText = []; for (var j = 0; j < teams.length; j++) { if (thisTeam.teamId == teams[j].teamId) { teamDropDownText.push('<option value="' + teams[j].teamId + '" selected="selected">' + teams[j].name + '</option>'); } else { teamDropDownText.push('<option value="' + teams[j].teamId + '">' + teams[j].name + '</option>'); } } $('#addIncidentTeam').html(teamDropDownText.join('')); $('#editIncidentTeam').html(teamDropDownText.join('')); /* When all this has finished, make the rest of the calls to get the rest of the data */ startTimer(); downloadDevices(); initializeMap(); var kmlLink = document.getElementById('kmlLink'); var geoserverLink = document.getElementById('geoserverLink') if (user_role.substring(0, 1) == 'M') { kmlLink.href = "https://www.intelink.gov/giatstldni/hermes/webservice/kml/download/M&" + thisTeam.missionId + "&48"; kmlLink.innerHTML = "https://www.intelink.gov/giatstldni/hermes/webservice/kml/download/M&" + thisTeam.missionId + "&48"; geoserverLink.href = "https://www.intelink.gov/giatstldni/geoserver/wms/kml?layers=hermes_all&cql_filter=mission_id+=+" + thisTeam.missionId; geoserverLink.innerHTML = "https://www.intelink.gov/giatstldni/geoserver/wms/kml?layers=hermes_all&cql_filter=mission_id+=+" + thisTeam.missionId;} else { kmlLink.href = "https://www.intelink.gov/giatstldni/hermes/webservice/kml/download/T&" + thisTeam.id + "&48"; kmlLink.innerHTML = "https://www.intelink.gov/giatstldni/hermes/webservice/kml/download/T&" + thisTeam.id + "&48"; geoserverLink.href = "https://www.intelink.gov/giatstldni/geoserver/wms/kml?layers=hermes_all&cql_filter=team_id+=+" + thisTeam.id; geoserverLink.innerHTML = "https://www.intelink.gov/giatstldni/geoserver/wms/kml?layers=hermes_all&cql_filter=team_id+=+" + thisTeam.id; } } } 
```

我这样做只是为了看看我会得到什么错误，我知道它不能正常工作。但是现在它告诉我文件中不存在的行上有错误！我得到：

> 语法错误 [Break On This Error] (10 out of range 8)

我去注释了更多代码，它只是使它超出了范围 6 的 10！我不明白！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:02:53.417

我找到了罪魁祸首。返回的 JSON 值之一是空的（没有引号或任何东西）。不是很有帮助的错误信息。

# email - 通过 AppleScript 获取电子邮件的日期

> ID：13405313
> 
> 赞同：1
> 
> 时间：2012-11-15T20:07:27.813
> 
> 标签：email, date, applescript, geektool

我目前正在尝试自定义一个正在阅读收件箱中未读邮件的 AppleScript。除了我无法#T设法获取邮件日期之外，这基本上可以正常工作。

经过大约 2 小时的谷歌搜索后，我发现我需要的变量应该是 receiveate 或 deliverydate，但是当尝试使用其中一个时，我收到如下错误：

```
"...receivedate of id... cannot be converted to Type reference..." 
```

有人有一个想法，我该如何转换？

这是我当前的代码：

```
tell application "System Events"
    set processList to (name of every process)
end tell
if processList contains "Mail" then
tell application "Mail"
    if (unread count of inbox) > 0 then
        set messageList to (messages of inbox) whose read status is false
        set output to "Mails:" & return & return & ""
        repeat with itemNum from 1 to (unread count of inbox)
            set itemDate to (receivedate of item itemNum of messageList)
            set output to output & itemDate & " - " & (extract name from sender of item itemNum of messageList) & return & subject of item itemNum of messageList & return & return
        end repeat
    end if
end tell
else
set output to "ÄpplMäil isch aus..."
end if 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:02:42.893

您正在寻找的术语是`date received`

```
tell application "Mail" to if running then
    if (unread count of inbox) > 0 then
        set output to "Mails:" & return & return & ""
        repeat with thisMsg in (get messages of inbox whose read status is false)
            tell thisMsg to set output to output & (date received) & " - " & (extract name from sender) & return & subject & return & return
        end repeat
    end if
else
    set output to "ÄpplMäil isch aus..."
end if 
```

获得所需帮助的更快方法是 Applescript 字典**Mail**。**Mail**的所有命令、类和属性都在这本词典中。

打开该词典的一种方法是使用 的`File`菜单中的“打开词典”项`AppleScript Editor`。当您使用此项目时，您将获得具有字典的可用应用程序的列表。选择`Mail`并单击打开按钮或使用浏览按钮导航到未列出的应用程序。

另一种打开字典的方法是使用`AppleScript Editor's`库窗口。它位于`Window`Result History 和 Event Log History 菜单项下方的菜单中。“库”窗口显示默认应用程序列表，您可以通过双击打开其字典。

# hibernate - 通过 HQL 的 Hibernate ScrollableResults 需要为每个关联获取左连接

> ID：13405314
> 
> 赞同：1
> 
> 时间：2012-11-15T20:07:33.507
> 
> 标签：hibernate, hql, scrollableresults

希望一些 Hibernate 大师可以提供帮助。

我有一个看起来像这样的对象结构：

```
class Customer {
    private Stuff1 stuff1;
    private Stuff2 stuff2;

    // Bazillion other fields
}

class Report {
    private Customer customer;
    private String uniqueBatchId; 

    // Bazillion other fields 
}

class AbstractSpecialReport {
    private Report report;

    //Bunch of other fields
}

class SpecialReport extends AbstractSpecialReport{
    private List<ReportParts> reportParts;           
} 
```

这三个都被注释为 Hibernate 实体，并且所有关联都是默认的（使用 Hibernate 3.2，因此默认情况下应该是惰性的。

我想使用这个 HQL 来获得结果，使用`ScrollableResults`. 我已经完成了所需的咒语以使结果集流式传输。

```
select srpt
from SpecialReport as srpt
left join fetch srpt.report as rpt
left join fetch rpt.customer as cst
left join fetch cst.stuff1
left join fetch cst.stuff2
where rpt.uniqueBatchId = :batchId 
```

但我得到“java.sql.SQLException：流式传输结果集 com.mysql.jdbc.RowDataDynamic@633f8d4f 仍然处于活动状态。当任何流式传输结果集打开并在给定连接上使用时，不会发出任何语句。确保您有在尝试更多查询之前，在任何活动的流结果集上调用 .close()。”

我有 sql 查询登录，我可以清楚地看到它在向前滚动*后*试图在 Report 上获取一个不相关的属性。

所以我开始发展我的 HQL 以包括这些领域。

现在看起来像

```
select srpt
from SpecialReport as srpt
left join fetch srpt.report as rpt
left join fetch rpt.customer as cst
left join fetch rpt.field1
left join fetch rpt.field2
left join fetch rpt.field3
left join fetch rpt.field4 as child
-- now field 4 was an object that also has fields that are associations.
left join fetch child.field1
left join fetch child.field2
-- ad nauseum, this keeps going down the object tree 
left join fetch cst.stuff1
left join fetch cst.stuff2
where rpt.uniqueBatchId = :batchId 
```

即使有大约 25 个连接，我仍然有更多正在加载的字段导致相同的异常。我可以继续手动遍历图表，但这需要很长时间，我觉得这不应该是必要的。查看 Hibernate 代码，滚动调用似乎`TwoPhaseLoad`尝试初始化对象中的所有代理和延迟加载的字段，这必然打破了滚动运行时不执行其他 sql 查询的要求。这对外面的任何人都有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:17:10.620

XxxToOne 关联默认是渴望的。如果您不希望 Hibernate 急切地加载它们，请将它们注释为惰性。

而且，SpecialReport 就是 Report，所以下面的 join 没有多大意义：

```
from SpecialReport as srpt
left join fetch srpt.report as rpt 
```

# apache-flex - 针对 Android 和 iOS 的 Flex 移动应用程序的应用程序图标

> ID：13405324
> 
> 赞同：0
> 
> 时间：2012-11-15T20:08:31.680
> 
> 标签：apache-flex, flash-builder, flex-mobile, flash-builder4.5, multiscreen

Adobe 文档[为移动设备开发 AIR 应用程序](http://help.adobe.com/en_US/air/build/WS901d38e593cd1bac1e63e3d129907d2886-8000.html#WS901d38e593cd1bac58d08f9112e26606ea8-8000)列出了很多要在应用程序描述符文件中声明的图标。

但是当我尝试使用以下 myApp-app.xml 导出发布版本时：

```
<icon>
    <image16x16>assets/icons/16x16.png</image16x16>
    <image29x29>assets/icons/29x29.png</image29x29>
    <image32x32>assets/icons/32x32.png</image32x32>
    <image36x36>assets/icons/36x36.png</image36x36>
    <image48x48>assets/icons/48x48.png</image48x48>
    <image57x57>assets/icons/57x57.png</image57x57>
    <image72x72>assets/icons/72x72.png</image72x72>
    <image114x114>assets/icons/114x114.png</image114x114>
    <image128x128>assets/icons/128x128.png</image128x128>
    <image512x512>assets/icons/512x512.png</image512x512>
    <!-- 
    <image50x50>assets/icons/50x50.png</image50x50>
    <image58x58>assets/icons/58x58.png</image58x58>
    <image100x100>assets/icons/100x100.png</image100x100>
    <image144x144>assets/icons/144x144.png</image144x144>
    <image1024x1024>assets/icons/1024x1024.png</image1024x1024>
     -->
</icon> 
```

我收到错误消息（无论是为 Android 还是 iOS 部署），除非我如上所述注释 5 行：

```
error 103: application.icon.image50x50 is an unexpected element/attribute
error 103: application.icon.image58x58 is an unexpected element/attribute
error 103: application.icon.image100x100 is an unexpected element/attribute
error 103: application.icon.image1024x1024 is an unexpected element/attribute
error 103: application.icon.image144x144 is an unexpected element/attribute 
```

我的问题是在这里做什么？将这 5 个图标移到下方`<android>....</android>`或`<iphone>....</iphone>`也无济于事。

在 Windows 7 / 64 位下使用 Flash Builder 4.7 beta。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T18:50:11.580

解决方案是更新 SDK 中使用的 AIR 版本。Adobe Flex 4.6 [或 Apache Flex 4.8] 中包含的 AIR 版本不支持这些新的图标大小。

可以在此处找到[在 Flex](http://www.jasonsturges.com/2012/08/overlay-adobe-air-3-4-sdk-in-flash-builder-4-6/)中更新 AIR SDK 的说明。通常这样做：

1.  下载当前SDK并解压
2.  将解压缩目录中的文件和文件夹复制到 Flex 目录的根目录
3.  在“flex-sdk-description.xml”文件中更新 Flex SDK 的名称。

# c# - Prism 模块级异常处理

> ID：13405326
> 
> 赞同：4
> 
> 时间：2012-11-15T20:08:38.333
> 
> 标签：c#, exception, mvvm, exception-handling, prism

我正在尝试查看除了全局级别处理（Application.UnhandledException）之外是否可以在视图模型级别处理异常。目前，如果其中一个视图模型抛出未捕获的错误，则应用程序将硬崩溃。我想知道如何在模块级别捕获这个，发布一个事件，并让这个模块从它所占据的区域中删除，而不是取消整个应用程序。

有没有人实施过这样的事情？
应该避免这种类型的架构吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:27:11.203

我在自己的工作中遇到了同样的问题。涵盖以下所有内容似乎对我们有用：

```
DispatcherUnhandledException += OnDispatcherUnhandledException;

TaskScheduler.UnobservedTaskException +=TaskScheduler_UnobservedTaskException; \\exceptions in tasks

AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException; 
```

此外，对于模块和视图模型级别的异常，我们尝试/捕获，然后通过`EventAggregator`. 在我们的 shell 中，我们订阅此事件以显示/记录错误。由于外壳很可能包含所有区域，因此您应该能够从视图中删除/隐藏这些模块。但是，我会声明无法卸载模块。这可能不是最佳解决方案，我们仍在探索更好的方法来做到这一点。

壳：

```
EventAggregator.GetEvent<RaisedExceptionEvent>().Subscribe(RaisedException); 
```

视图模型：

```
try
{
}
catch (Exception ex)
{
            EventAggregator.GetEvent<RaisedExceptionEvent>().Publish(new ExceptionManager(ex,
                                                                                          ExceptionMessageType.
                                                                                              Default, true));
} 
```

# asp.net - 需要制作一个类似于工具提示的东西，里面有文字

> ID：13405328
> 
> 赞同：0
> 
> 时间：2012-11-15T20:08:44.827
> 
> 标签：asp.net

当有人像工具提示一样将鼠标悬停在按钮上时，我基本上会出现一个框。但我希望能够将 html 放入框中。我已经能够使用 div 和一些 javascript 来隐藏和取消隐藏 div，但我似乎无法让 div 在鼠标悬停在按钮上时出现在鼠标所在的位置。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:10:46.420

You could get help using a library like jquery.

Or you can try with something like:

[http://sixrevisions.com/tutorials/javascript_tutorial/create_lightweight_javascript_tooltip/](http://sixrevisions.com/tutorials/javascript_tutorial/create_lightweight_javascript_tooltip/)

Here is a working demo:

[http://sandbox.scriptiny.com/tooltip/](http://sandbox.scriptiny.com/tooltip/)

You need to replace the logic to work with your button, but it should be easy.

# cocos2d-iphone - Cocos2D iPhone Extensions v0.2.1：CCMenu高级警告：CCMenu可能无法响应initWithItems:vaList：我应该担心吗？

> ID：13405329
> 
> 赞同：0
> 
> 时间：2012-11-15T20:08:47.323
> 
> 标签：cocos2d-iphone, xcode4.5, cocos2d-extensions-ios

在 CCMenu.h 中查看，它似乎响应了 Xcode（4.5.2）说它不响应的确切方法。我尝试过覆盖该方法并扩展 CCMenu，但它总是抛出相同的消息。

当我构建并运行我的项目时，它似乎工作正常。我应该忽略这个警告并继续我的游戏吗？另一个问题：是否有一种简单的方法可以将此代码“更新”为未弃用或过时的方法？这是我正在使用的 cocos2d-iphone-extensions 版本。另外，它是 cocos2d 2.1。

该错误是在 .m 文件的第 76 行生成的。

CCMenuAdvanced.h：

[https://github.com/cocos2d/cocos2d-iphone-extensions/blob/master/Extensions/CCMenuAdvanced/CCMenuAdvanced.h](https://github.com/cocos2d/cocos2d-iphone-extensions/blob/master/Extensions/CCMenuAdvanced/CCMenuAdvanced.h)

CCMenuAdvanced.m:

[https://github.com/cocos2d/cocos2d-iphone-extensions/blob/master/Extensions/CCMenuAdvanced/CCMenuAdvanced.m](https://github.com/cocos2d/cocos2d-iphone-extensions/blob/master/Extensions/CCMenuAdvanced/CCMenuAdvanced.m)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T10:05:36.707

您收到此警告是因为`-(id) initWithItems: (CCMenuItem*) item vaList: (va_list) args`头文件 (CCMenuAdvanced.h) 中不存在此警告。

您需要`+ (id) menuWithItems: (CCMenuItem*) firstItem vaList: (va_list) args;`从 CCMenu（CCMenuAdvanced 的超类）中使用。

# jquery - jQuery Mobile CSS 特定性是否符合 W3C 标准？

> ID：13405332
> 
> 赞同：0
> 
> 时间：2012-11-15T20:08:52.537
> 
> 标签：jquery, jquery-mobile, mobile, standards

并不是说我需要答案，因为简短的答案是**NO**。我提出这个问题更多是因为这个问题没有从 jQuery 论坛到 Google 代码论坛到 StackOverflow 的此处解决。

自从我得到第一台使用标准盒式磁带录音机备份数据的 Commodore 16 以来，我一直是一名程序员（是的……我那么老了）。从那时起，为在许多编程语言的编码实践中创建普遍兼容的标准进行了漫长而令人厌烦的斗争，其中 W3C 是我们迄今为止最接近的。

在我自己看来，在使用 jQuery Mobile (jQm) 编写了几个应用程序之后，我认为 jQm 是一个好主意，但正是因为这个原因，它的实现很糟糕。jQm 决定以不符合标准的方式实现他们自己的 CSS，让开发人员与 jQm 劫持他们自己的“符合标准的”补充 CSS 作斗争。请记住，CSS 中的 C 表示“级联”，这意味着遵循先前样式声明的样式声明将优先于之前的样式。**jQm** CSS 并非如此，使其不符合标准。

我围绕 jQm 的 CSS 劫持行为（在 jQuery 的 CSS、@imports、内联样式...... 除了在加载 jQm CSS 之后用我自己的 CSS 覆盖 jQm CSS 中包含的样式之外。我的意思是......这不是完全否定了首先使用 jQm 的任何好处吗？

指向我的论点。如果我必须在我自己的“符合标准”的 CSS 中“覆盖”jQm 的 CSS，或者调整 jQm CSS 本身（这将消除能够将现有的 jQm CSS 导入 Theme Roller 的优势）稍后添加另一种样式），那么我不妨编写自己的 UI 开始。

我可以使用 jQuery 和 CSS3 过渡轻松地编写自己的过渡，因此使用 jQm 的过渡可以带来任何好处。jQm 将鼠标事件转换为触摸控件的功能已经过时，因为随着平板电脑和触摸屏笔记本电脑进入桌面环境，大多数主要浏览器已经在完善这一点，但与 jQm 不同的是，它以符合标准的方式。然后是 jQm 的默认 ajax 导航行为，我可以使用 jQuery 自己的丰富的 XMLHttpRequest 速记方法（$.ajax、$.get、$.post 和 $.getJSON）轻松实现自己，具有更低的开销和更好的性能。那么为什么要使用jQm呢？！

我自己已经完成了 jQm，因为我与 jQm 不符合 CSS 行为的斗争所花费的时间超过了我首先编写自己的符合标准的 UI 所花费的时间。我是标准合规性的坚定信徒，我不得不与不合规的应用程序（比如 IE ......哦，不，我是不是大声说出来了！）作斗争了二十多年。

我自己......从现在开始，我将使用符合标准的 HTML5 和 CSS3 编写我的所有应用程序，通过将我的兼容编码包装在移动设备自己的 SDK 中，可以轻松地通过不同的移动设备进行部署。旨在做到这一点，另一个强大的好处是能够使用移动设备自己的功能（如加速度计、指南针、相机等）。

我很想听听关于这个问题的反馈，因为我总是保持开放的心态，喜欢一个很好的圆桌讨论，让我重新思考我根据自己的经验做出的决定。

更新这是一个示例和一个 jsfiddle，描述了我在这个问题中引用的内容。

```
<style>
.my_link a:link{ color:#00cc00 }
</style>

<div data-role="page" data-theme="a">
<p><a href="#">
Link using default jQm CSS</a></p>
<p><a href="#" class="my_link">
Link using CSS class declared in HEAD after jQm CSS</a></p>
<p><a href="#"> style="color:#00cc00">
Link using inline CSS declared after jQm CSS</a></p>
</div> 
```

[http://jsfiddle.net/Ephiphany/S7NuK/](http://jsfiddle.net/Ephiphany/S7NuK/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:41:32.610

要覆盖 JQM 样式（或任何与此相关的样式），您的 css 选择器需要比 JQM 样式表使用的选择器更具体。

例如，给定以下带有 1 个链接的页面：

```
<div data-role="page" data-theme="a" data-url="/Ephiphany/S7NuK/show/" tabindex="0" class="ui-page ui-body-a ui-page-active" style="min-height: 209px;">
  <p class="my_p"><a href="#" class="my_link ui-link">Link using default jQm CSS</a></p>
</div> 
```

JQM 有这种风格：

```
.ui-body-a .ui-link:link {
    color: #2489CE;
} 
```

CSS Specificity 是一个优先级系统，其中有多个优先级：内联样式 > ID > 类/属性/状态 > 标记名/psudoelement

考虑到这一点，我们要么需要一个 ID，要么需要使用两个类。例如，如果它出现在 JQM 样式表之后，这将覆盖它：

```
.my_p .my_link:link { 
    color: #00cc00
} 
```

[http://jsfiddle.net/S7NuK/2/](http://jsfiddle.net/S7NuK/2/)

不要忘记`:visited` `:hover` `:active`等等。

# jquery - Jquery cookie 插件不适用于 Firefox

> ID：13405336
> 
> 赞同：2
> 
> 时间：2012-11-15T20:09:11.847
> 
> 标签：jquery, firefox, cookies

请看一下这个小提琴：[Jsfiddle](http://jsfiddle.net/V63Px/9/)

```
$(document).ready(function() {

    var cookie = $.cookie('myDemoCookie');

    // If the cookie has been set in a previous page load, show it in the div directly:
    if (cookie){
        var values = $.parseJSON(cookie);
        var li;
        for (var v in values) {
            li = $('<li><a href="' + values[v]+ '">' + values[v] + '</a></li>');
            $('.jq-text').append(li).show();
        }
    }

    $('.fields a').click(function(e) {
        e.preventDefault();
        var text = $('#inputBox').val();
        var values = $.parseJSON($.cookie('myDemoCookie')) || [];

        values.push(text);

        $.cookie('myDemoCookie',JSON.stringify(values),{expires: 7, path: '/' });
        $(".jq-text").append('<li><a href="' + text + '">' + text + '</a></li>');
    });

    $('#form1').submit(function(e){ e.preventDefault(); })

    $('.jq-text').on('click', 'li', function(e) {
        e.preventDefault();
        var values2 = [];

        $(this).remove();
        $(".jq-text li").each(function(i, item) {

            values2.push($(item).text());
        });
        $.cookie('myDemoCookie', JSON.stringify(values2), { expires: 7 });
    });
}); 
```

​</p>

如果您在输入中输入内容并单击保存，则会创建一个列表并将其与 cookie 一起存储。问题是我的 xp 系统上最新版本的 firefox 不保存 cookie。这很奇怪，因为在工作中我在 xp 上也有最新版本的 Firefox，但那里一切正常。

我对此有点烦恼，因为我没有玩设置，所以这意味着具有相同版本的其他人（/访问者）可能会遇到同样的事情。这种“奇怪”行为的原因可能是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-30T14:35:27.777

我也有这个问题。我的解决方案是设置路径。

```
$.cookie('cookieName','value',{ expires: 7, path: '/'}); 
```

代替

```
$.cookie('cookieName','value',{ expires: 7 }); 
```

看起来您在一个 cookie 上设置了路径，但没有在另一个 cookie 上设置路径。

# java - BFS 最短路径仅使用邻接矩阵？

> ID：13405338
> 
> 赞同：0
> 
> 时间：2012-11-15T20:09:16.427
> 
> 标签：java, algorithm, graph-algorithm

我正在尝试仅使用邻接矩阵来实现 Ford-Fulkerson/Edmonds-Karp。我唯一无法编程的是使用 BFS 计算最短路径的函数。查看是否确实存在最短路径的功能很好，但是是否也可以获得最短路径？或者是用 BFS 获得最短路径以使用某种父指针并向后遍历以获得路径的唯一方法？

这是我查看路径是否存在的代码：

```
public static boolean existsPathFromSourceToSinkInGf(int Gf[][])
{
    LinkedList<Integer> queue = new LinkedList<Integer>();
    queue.add(0);

    while (!queue.isEmpty())
    {
        int v = queue.remove();
        if (v == sink) return true;
        for (int i = 0; i < 5; i++)
        {

            if (Gf[v][i] != 0)
            {
                if (!queue.contains((Integer)i))
                {
                    queue.add((Integer)i); 
                }
            }
        }
    }

    return false;

  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T13:56:52.237

做到这一点的常用方法确实是在每次确定节点时维护父指针，并在找到路径后返回。

您还可以明确跟踪队列中的路径。您可以创建自己的类，而不是仅使用整数作为链表，该类由整数和字符串组成，例如“节点 1-> 节点 3->...”。由于类和路径的开销，它不太常用，但它避免了必须自己保留父指针并最终遍历它们。

在旁注 2 对您的代码的评论：

1.  为什么它运行 i=0..5？
2.  你检查`if (!queue.contains((Integer)i))`所以你不要把一个顶点放在你已经在它上面的队列上。您还应该避免将已经从列表中删除的顶点放在上面（尝试维护一组访问节点）。

# android - Android - getActivity 和 Activity 生命周期

> ID：13405340
> 
> 赞同：0
> 
> 时间：2012-11-15T20:09:18.650
> 
> 标签：android, android-activity

如果我在片段中有以下代码：

```
public void doSomething() {
    if (getActivity() == null)
        return; // no null pointer exceptions here!
    // ...
    // do bunch of stuff here
    // ...

    getActivity().setTitle("done something"); // just whatever
} 
```

如您所见，在方法的开头，我检查 getActivity() 是否为空，如果是则返回。但是，如果它不为 null，则该方法继续执行。最后，我再次调用 getActivity() 来设置标题，但是我不检查 getActivity() 是否为空。从理论上讲，此时 Fragment 可能已与 Activity 分离，因此 getActivity() 可能为 null，因此最后一行将抛出 NullPointerException。解决方案是什么？每次我想调用它时检查 getActivity() 是否为空？

编辑：即使我们尝试这个，也可以获得 NPE - 我每次都调用 getActivity() 来简化示例：

```
public void doSomething() {
    Activity activity = getActivity();
    if (activity == null)
        return; // no null pointer exceptions here!
    // ...
    // do bunch of stuff here
    // ...

    activity.setTitle("done something"); // just whatever
} 
```

问题不在于 Activity 尚未完成加载 - 例如，这可能在加载后几分钟发生，作为对任何事件的响应。问题不是第一次调用 getActivity，而是从我们检查活动是否为空到最后一次引用它的 15 行左右，它不再存在。

我现在没有 logcat，但这就是正在发生的事情。我们自己还没有真正看到这一点，但这是针对一个应用程序，该函数每天被调用数千次，因此可能偶尔会发生在某人身上。

编辑 2：我目前正在做的是尝试和捕捉 NPE，如果失败则不做任何事情。然而，这似乎是解决问题的一种丑陋方式——我想知道是否有更好的解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:11:55.387

在顶部调用一次 getActivity 并将其保存在变量中。为什么要调用它 20 次，因为它不会在两者之间发生变化（如果确实如此，那么使用新旧混合可能真的很糟糕）。

# c# - 使用点表示法或索引访问 DynamicModel.Query

> ID：13405343
> 
> 赞同：4
> 
> 时间：2012-11-15T20:09:47.273
> 
> 标签：c#, expandoobject, massive

我正在使用带有 .NET 框架 4.0 的 Massive micro-orm 和 SQL Server 2008R2。

```
// This is my model
    public class sUser : DynamicModel
    {
      public sUser() : base(Model.strConnection, "Users", "UserId") { }
    } 
```

和另一堂课……

```
 using System;
    using System.Data;
    using System.Data.SqlClient;
    using System.Linq;
    using System.Web;
    using System.Xml;
    using System.Dynamic;
    using System.Collections.Generic;
    using Massive;

    public class Test
    {
    public dynamic GetUser(string uName)
    {
        dynamic table = new sUser();
        var objUser = table.FindBy(UserName: uName);

        //Tried following...
       //var objUser = new sUser().All().Where(u => u.UserName.ToString() == uName).FirstOrDefault();
    //var objUser = new sUser().All().Where(u => u.UserName.ToString().Equals(uName)).FirstOrDefault();

        return objUser;
    }

    public void GetSomething(dynamic testObj, string user)
{
    dynamic User = GetUser(user);

      //testObj.CUser = User["FirstName"] + ' ' + User["LastName"];
      //Would like to access User object like
      //User.FirstName or User["FirstName"]

      //And not like this...
            foreach (var item in User)
            {
                testObj.CUser = item.FirstName + ' ' + item.LastName;
            }
}
} 
```

我想访问像 User.FirstName 或 User["FirstName"] 这样的用户动态对象。这是可能的，还是我错过了什么？

任何输入都受到高度赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:45:43.820

您将不得不使用`First`方法而不是`findby`

他们将能够访问这样的属性：

```
testObj.CUser = User.FirstName + User.LastName; 
```

完整的工作控制台应用程序：

```
 class Program
{

    static void Main(string[] args)
    {
        dynamic testObj = new ExpandoObject();
        test t = new test();
        t.GetSomething(testObj, "TestUserName");
        Console.WriteLine(testObj.CUser);
        Console.ReadLine();
    }

}
public class test
{
    // This is my model
    public class sUser : DynamicModel
    {
        public sUser()
            : base("test",
                    "Users",
                    "UserId") { }
    }
    public void GetSomething(dynamic testObj, string user)
    {
        dynamic User = GetUser(user);
        testObj.CUser = User.FirstName + User.LastName;

    }
    public dynamic GetUser(string uName)
    {
        dynamic table = new sUser();
        var objUser = table.First(UserName: uName);

        return objUser;
    }
} 
```

# c - 在 pthread_create 中传递指向函数的指针

> ID：13405345
> 
> 赞同：0
> 
> 时间：2012-11-15T20:09:50.367
> 
> 标签：c, pthreads

我正在尝试通过传递函数指针来创建线程，但是在这一行

```
pthread_t start_thread(void *func, thread_data *tdata) 
```

它给了我——

```
use-hello.c:23: error: invalid conversion from 'void*' to 'void* (*)(void*) 
```

任何输入请...

```
typedef struct thread_data{
int fd;
int threadId;
}thread_data;

pthread_t start_thread(void *func, thread_data *tdata)
{
   pthread_t thread_id;
   int rc;
      printf("In main: creating thread\n");
      rc = pthread_create(&thread_id, NULL, func, tdata);
      if (rc){
         printf("ERROR; return code from pthread_create() is %d\n", rc);
         exit(-1);
        }
    return(thread_id);
}

void thread_function1(thread_data *tdata){ 
.
.
}

int main(int argc, char **argv){

/* Our file descriptor */
int fd;
int rc = 0;

printf("%s: entered\n", argv[0]);

/* Open the device */
fd = open("/dev/hello1", O_RDWR);

if ( fd == -1 ) {
    perror("open failed");
    rc = fd;
    exit(-1);
}
printf("%s: open: successful, fd=%d\n", argv[0], fd);

//array of function pointers
void (*function[5])(thread_data*);

function[0] = thread_function0;
function[1] = thread_function1;
function[2] = thread_function2; 
function[3] = thread_function3;
function[4] = thread_function4;

//start threads
for(int i=0; i<2; i++){
    thread_data *tdata[i] = (thread_data*)malloc(sizeof(thread_data));
    tdata[i]->threadId = i;
    tdata[i]->fd = fd;
    printf("starting thread = %d\n",start_thread(function[i]), tdata[i]));
}

while(1) sleep(1); // infinite loop

printf("closing file descriptor..\n");
close(fd);
printf("file descriptor closed..\n");

return 0;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:16:22.443

问题是你的声明`start_thread`，它需要一个`void*`而不是函数指针。

将其更改为：

```
pthread_t start_thread(void *(*func) (thread_data *), thread_data *tdata); 
```

该函数指针类型的 typedef 将简化该原型和您的数组声明。

```
typedef void (*thread_func)(thread_data*);
pthread_t start_thread(thread_func func, thread_data *tdata);
thread_func function[5]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:16:02.623

您的函数将 func 作为`void*`

```
pthread_t start_thread(void *func, thread_data *tdata) 
```

然后你将它作为第三个参数传递给 pthread_create`void *(*) (void *)`

# c - 代码会按顺序通过多个标签定义执行吗？

> ID：13405347
> 
> 赞同：0
> 
> 时间：2012-11-15T20:09:52.640
> 
> 标签：c

这可能是一个愚蠢的问题，我很震惊我在谷歌搜索时遇到了麻烦，但这里是：

在这种情况下会发生什么：

```
int foo(void){
     char x = 1;

     if (x == 1}
         goto apple;
     }
     else{
         goto banana;
     }

apple:
    printf("apple");

banana:
    printf("banana");

    return 0;
} 
```

如果`x==1`输出是

```
 apple
 banana 
```

或者它会`apple`在标签的末尾停止吗？像代码会不会继续逐行执行，输入另一个标签？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:11:41.280

> 如果 x==1 将输出是

```
 apple
 banana 
```

是的，它会的。标签（`goto`或`switch`标签）落空。

# c++ - 不是表达式转换，而是从前序到中序的转换（不是表达式）

> ID：13405353
> 
> 赞同：0
> 
> 时间：2012-11-15T20:10:02.400
> 
> 标签：c++, binary-search-tree

我不是要求表达式转换

[中缀到前缀的转换](https://stackoverflow.com/questions/1946896/conversion-from-infix-to-prefix)

我只是问一个BST，如果输入以前缀表示法的形式给出，即BST的前序遍历，那么我如何将值序列转换为中缀表示法，即BST的中序遍历。

```
 8
               /  \
              1    12
              \     /
               5   9
             /   \
            4     7
                 /
                6 
```

例如，前序遍历将给出 8 1 5 4 7 6 12 9

我如何将这些值（输入）序列转换为中序遍历表达式 1 4 5 6 7 8 9 12。

AS 在某些情况下，中序表达式更容易处理......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:21:25.443

使用 BST：
**前缀**：左子树、节点、右子树。
**中缀**：节点、左子树、右子树。
**后缀**：右子树、左子树、节点。

转换取决于您如何遍历树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:16:58.527

让

V = 顶点

L = 左子树

R = 右子树

预购 = VLR

有序 = LVR

后订单 = LRV

（只需切换顺序即可修复，它是相同的）

将它们放回去以使前缀值成为中缀值的一种方法是再次使用前缀值创建二叉搜索树并进行中序遍历。

或者！

只是排序老兄......（如果你将它们挤压成一条线（从上到下挤压），BST 总是排序）

# javascript - JQuery：将内容从本地文件传输到变量。（同源政策）

> ID：13405356
> 
> 赞同：1
> 
> 时间：2012-11-15T20:10:11.220
> 
> 标签：javascript, jquery, file, variables

我正在尝试创建一个本地 javascript 应用程序（没有服务器端语言）该应用程序有不同的文本模板。我想要每个模板 1 个文件。

但我的问题是我不知道如何将内容从模板传输到变量。同源政策再次来袭！

**尝试#1：**

我知道相同的来源策略，并且通过使用静态列表加载所有模板来对动态进行折衷没有任何问题，例如：

```
<script src="tpl01.js"></script>
<script src="tpl02.js"></script>
... 
```

我确实有一个问题，就是将模板内容放入变量中。模板可以有数千行，而不得不做那种事情是极其不切实际的（并迫使我逃避一切）：

```
templateSource = "line 1"
+ "line2"
+ "line3" 
```

**尝试#2：**

我还尝试为每个 iframe 加载 1 个模板（然后我将其隐藏），但主窗口无法与 iframe 内容对话，并且 iframe 内容无法与主窗口对话：

> 不安全的 JavaScript 尝试从带有 URL file:///home/dev/tpl.html 的框架访问带有 URL file:///home/dev/index.html 的框架。域、协议和端口必须匹配。

我尝试有创意，但我的想法已经不多了......

您知道**将文件内容放入变量的任何解决方案**吗？

Ps.：我不介意每个模板添加几行代码，但我不想修改整个内容。

注意：该应用程序将仅在 IE 上使用。

# c# - 在 C# 中打开视频文件

> ID：13405359
> 
> 赞同：1
> 
> 时间：2012-11-15T20:10:22.827
> 
> 标签：c#, file

我是 C# 新手，这听起来可能很愚蠢，我做了一些研究，我想我很困惑。我希望我的 c# 程序打开一个视频文件 (c:\abc.mov)，我已将 .mov 文件设置为使用快速播放器自动打开，我希望程序使用快速播放器打开文件，就像双击一样在那个文件上。当我使用此代码时，它什么也不做！

```
File.Open(@"c:\abc.mov", FileMode.Open); 
```

请帮我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:12:18.840

你应该`Process.Start`改用。这是[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)。

您可以使用所需的任何参数指定要启动的程序，[如本例所示。](http://www.dotnetperls.com/process-start)

**编辑：**添加了另一个示例。谢谢@DJBurb

```
Process.Start(@"c:\\abc.mov"); 
```

此代码应使用与扩展名`.mov`关联的默认电影播放器​​打开文件。`.mov`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-19T02:58:31.430

这将使用默认视频播放器打开您的视频文件

```
System.Diagnostics.Process.Start(filepath); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:12:26.883

我相信 open() 将打开您的文件以针对当前程序进行编辑，而不是实际使用系统的默认播放器打开文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:13:47.157

`File.Open`返回`FileStream`，以便您可以读取该文件，而不是您绝对想使用`Process.Start(@"c:\abc.mov");`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-02T06:25:32.017

```
 private void buttonOpen_Click(object sender, EventArgs e)
    { 
        if (ofd.ShowDialog()==DialogResult.OK)
        {
            Process.Start(ofd.FileName);
        }
    } 
```

# android - 安卓的乐透程序

> ID：13405362
> 
> 赞同：0
> 
> 时间：2012-11-15T20:10:42.757
> 
> 标签：android, arrays

好的，所以我为我的班级制作了一个乐透计划。当我单击生成时它崩溃，我不知道当您单击生成时我是否对数组进行了正确的编码。我是初学者，但正在努力变得更好。提前致谢。

```
public class MainActivity extends Activity {
    EditText min,max;
    TextView numbers1;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);
        numbers1 = (TextView) findViewById(R.id.numbers);
        max = (EditText) findViewById(R.id.maxinput);
        min = (EditText) findViewById(R.id.mininput);

        ImageButton lotto = (ImageButton) findViewById(R.id.button1);
        lotto.setOnClickListener(new View.OnClickListener() {

            @Override
        public void onClick(View v) {
        ArrayList<Integer> al = new ArrayList<Integer>();
        for(int i = Integer.parseInt(min.getText().toString()); i <= Integer.parseInt(max.getText().toString()); i++)

            al.add(i);

        Random ran = new Random();

        for(int i = 0; i < 5; i++) {
            int x = al.remove(ran.nextInt(al.size()));
            al.get(x).toString();
        }   
        }       
        });  
   }
} 
```

**日志猫**

```
11-15 12:19:46.562: E/AndroidRuntime(31065): FATAL EXCEPTION: main
11-15 12:19:46.562: E/AndroidRuntime(31065): java.lang.IllegalArgumentException
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
java.util.Random.nextInt(Random.java:187)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
com.edu.ext.lottoapp.MainActivity$1.onClick(MainActivity.java:42)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
android.view.View.performClick(View.java:4084)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
android.view.View$PerformClick.run(View.java:16966)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at    
android.os.Handler.handleCallback(Handler.java:615)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
android.os.Handler.dispatchMessage(Handler.java:92)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at    
android.os.Looper.loop(Looper.java:137)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
android.app.ActivityThread.main(ActivityThread.java:4745)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
java.lang.reflect.Method.invokeNative(Native Method)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
java.lang.reflect.Method.invoke(Method.java:511)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
11-15 12:19:46.562: E/AndroidRuntime(31065):    at 
dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:13:12.473

您不能将整数设置为 TextView。做这样的事情：

```
numbers1.setText(al.get(x + "")); 
```

# html - 两个浮动 div 之间的中心

> ID：13405363
> 
> 赞同：1
> 
> 时间：2012-11-15T20:10:43.553
> 
> 标签：html, css

找了一圈没找到解决办法

我写了以下 HTML：

```
<div id="navcontainer">
    <div class="leftnav">
        <a href="/blabla.aspx">Home</a>
    </div>
    <div class="leftnav">
        <a href="/blabla.aspx">test1</a>
    </div>
    <div class="leftnav">
        <a href="/blabla.aspx">test2</a>
    </div>
    <div class="leftnav">
        <a href="/blabla.aspx">test3</a>
    </div>

    <div class="midnav">
        <a href="#">MIDDLE</a>
    </div>

    <div class="rightnav">
        <a href="/blabla.aspx">test5</a>
    </div>

    <div class="rightnav">
        <a href="/blabla.aspx">test6</a>
    </div>
</div> 
```

使用以下 CSS：

```
#navcontainer div.leftnav
{
    float:left;
    text-align: left;
    vertical-align: middle;
    margin-left:6px;
    margin-top:6px;
}

#navcontainer div.midnav
{
    //
    // What do I put here?
    //
}

#navcontainer div.rightnav
{
    float:right;
    text-align: left;
    vertical-align: middle;
    margin-right:6px;
    margin-top:6px;
} 
```

我想基于“navcontainer”将 MIDDLE div 居中，但 div 会根据有多少 'leftnav' 和 'rightnav' div 不断获取。谁能向我解释怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:22:47.227

为我认为您正在寻找的东西想出了一个更好的解决方案 - 在这种情况下，我绝对定位了 midnav：

```
#navcontainer {
    position: relative;
}
#navcontainer div.midnav {
    position: absolute;
    left: 50%;
} 
```

这是一个更新的[jsfiddle](http://jsfiddle.net/qbCDS/4/)来演示。那是你想要做的吗？由于绝对定位，您需要调整 midnav 的 css 以使元素与左右导航元素垂直对齐。

# android - Android 布局翻译

> ID：13405367
> 
> 赞同：1
> 
> 时间：2012-11-15T20:10:55.137
> 
> 标签：android, android-layout, user-interface, tablet, user-experience

较大布局上的布局是否有设计约定？我觉得这是一个很少有人问的问题。

很多 android 布局在大屏幕上看起来不太好，或者用户体验不能无缝转换。

对 android 应用程序的批评是它们只是在大屏幕上伸展，但对它们没有任何设计考虑。

`layout-large`例如，如果他们的默认`layout`xml 文件包含列表视图，是否有详细说明用户可能希望如何制作他们的 xml 文件的资源。在移动体验中，只有文本的列表视图会很好，而在大屏幕体验中，列表视图本身看起来不太好。

我想添加额外的布局文件，但我没有任何关于它们应该是什么样子的参考，甚至在应用程序的规划设计阶段，我也没有关于它应该如何设计的任何参考可以合并其他屏幕尺寸。

主要是寻找解决这些问题的资源。就像可能详细介绍此内容的博客文章一样。Google 的平板电脑设计指南也是一个有益的开始。

洞察力赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:33:35.413

也许这些资源会帮助你。我会做一个一般性的声明，可能最常见的从手机到平板电脑布局调整的技术是使平板电脑布局多窗格。您提到您已经仔细阅读了 Google 设计指南，但我想我会突出显示专门讨论此问题的一页：

[Android 设计：多窗格布局](http://developer.android.com/design/patterns/multi-pane-layouts.html "Android 设计：多窗格布局")

一般概念是，您将在手机的多个屏幕上呈现的信息（例如，项目列表，然后是显示选择的视图）可以在平板电脑的同一屏幕上集中在一起（因此列表现在位于一边- 与当前选择的视图并排）。您已经提到资源框架如何帮助选择正确的布局；在代码方面，片段旨在帮助模块化与视图一起使用的代码。

另一个可能有用的资源来自 Googler Kirill Grouchnikov。他有一系列博客文章以 Google Play 为案例研究，以及 UI 如何从概念上分解以在手机和平​​板电脑之间工作：

[响应式移动设计](http://www.pushing-pixels.org/2011/11/08/deep-dive-into-responsive-mobile-design-part-1.html "响应式移动设计")

希望有帮助！

# xml - Flex - 如何将 XML 子属性值绑定到 DropDownList 的 dataProvider 属性？

> ID：13405371
> 
> 赞同：0
> 
> 时间：2012-11-15T20:11:09.543
> 
> 标签：xml, apache-flex, data-binding, flex-spark, dataprovider

这是我的 XML 文档示例 XML，其中包含有关打印模板的元数据：

```
<TemplateList>
    <PaperSizeTemplates PaperSize="8.5x14">
        <Template>Letter ANSI A Landscape</Template>
        <Template>Letter ANSI A Portrait</Template>
    </PaperSizeTemplates>
    <PaperSizeTemplates PaperSize="A3_11.5x16">
        <Template>A3 Landscape</Template>
        <Template>A3 Portrait</Template>
    </PaperSizeTemplates>
    <PaperSizeTemplates PaperSize="A4_8.5x11">
        <Template>A4 Portrait Custom</Template>
        <Template>A4 Portrait Custom1</Template>
        <Template>A4 Portrait Custom2</Template>
    </PaperSizeTemplates>
</TemplateList> 
```

我有一个 spark **DropDownList**，我想设置它的 dataProvider，以便所有 PaperSizeTemplates 元素的 PaperSize 属性值显示在 DropDownList 中。

例如，对于上面显示的 XML，我希望 DropDownList 显示以下内容：

```
8.5x14
A3_11.5x16
A4_8.5x11 
```

我尝试了以下方法：

```
<s:DropDownList id="paperSizeDDL" dataProvider="{_layoutTemplatesXML.paperSizeTemplates.paperSize as XMLListCollection}" /> 
```

但下拉列表中没有任何内容。

对此的帮助将不胜感激。

**请使用数据绑定和我的示例 XML 提供正确的方法。**

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T17:48:52.390

将声明更改为：

```
<s:DropDownList id="paperSizeDDL" dataProvider="{_layoutTemplatesXML.paperSizeTemplates as XMLListCollection}" labelField="@PaperSize" /> 
```

不过，您可能必须使用“dataprovider”标签将 XML 单独指定为 XMLListCollection。由于您没有展示如何提供 XML，我只能推测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T22:02:10.397

使用 E4X 声明时需要考虑的几件事：

*   一切都区分大小写，因此如果您正在寻找 PaperSizeTemplates 节点，则必须准确引用它。如果你将根节点声明分配给一个变量即： var myXML = ... 那么你所引用的 XMLList 就是 myXML.PaperSizeTemplates
*   在您的特定情况下，您实际上是在寻找节点的属性 - 属性使用 @ 符号，因此您的参考是 myXML.PaperSizeTemplates.@PaperSize。

这里有一个关于[基于 XML 的](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7b69.html)数据结构的部分，应该可以作为参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T23:36:33.957

其他答案有点对标，但不起作用。请注意，@Mike Petty 关于将 e4x 语句中的大小写与 XML 中使用的大小写匹配的评论是问题的一部分。

但是，另一个问题是 e4x 语句返回`XMLList`对象。他们不返回`XMLListCollection`. 所以这个表达式的计算结果为 null：

```
_layoutTemplatesXML.PaperSizeTemplates as XMLListCollection 
```

相反，为下拉列表设置数据提供者，如下所示：

```
<s:DropDownList dataProvider="{new XMLListCollection(_layoutTemplatesXML.PaperSizeTemplates.@PaperSize)}"/> 
```

这将使用 3 个 XML 对象填充下拉列表，这些对象的值是每个大小的字符串。

# iphone - 是否有框架可以轻松实现服务器-客户端或主从设备间通信应用程序？

> ID：13405373
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:11:14.933
> 
> 标签：iphone, ios, networking, bluetooth, p2p

我想制作一个与其他设备上运行的其他客户端通信的实用程序应用程序。

一个应用程序成为主人并等待奴隶。它与从机连接并实时向它们发送轻量级数据。这些设备彼此之间的距离在 10 米范围内，并且不适合长距离通信，因此蓝牙就可以了。低延迟和时间同步非常重要。

我认为 GameKit 点对点会是一个选择吗？还有哪些其他选择？是否有一个开源框架可以很容易地设置它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:51:04.920

我不是专家，但我猜蓝牙-Wi-fi-Bonjour 将是您的选择。GameKit 将是最好的选择。

***来自 Matthijs Hollemans：*** `GKSession has a method called sendDataToAllPeers:withDataMode:error:` *这会将 NSData 对象的内容发送给所有连接的对等点。您可以使用此方法将单个消息从服务器发送到所有客户端。在这种情况下，消息是一个 NSData 对象，而这个 NSData 对象内部的内容完全取决于您。*

用于点对点连接； *一个数据包至少有 10 个字节。这 10 个字节称为“标头”，后面的任何（可选）字节都是“有效负载”。不同类型的数据包有不同的有效载荷，但它们都具有相同的包头结构*

您可以查看此蓝牙游戏教程 [Matthijs Hollemans: Snap](http://www.raywenderlich.com/12910/how-to-make-a-simple-playing-card-game-with-multiplayer-and-bluetooth-part-3)

# php - 在提交之前如何将表单数据保存到数据库中

> ID：13405376
> 
> 赞同：1
> 
> 时间：2012-11-15T20:11:21.133
> 
> 标签：php, html, wordpress

我正在尝试在提交表单数据之前将其保存到 wordpress 数据库中。请帮忙。这是我的代码和要插入数据库的 php 代码：

```
<form method="post" action="https://app.icontact.com/icp/signup.php" name="icpsignup" 

id="icpsignup1030" accept-charset="UTF-8" onsubmit="return verifyRequired1030();">
<input type="hidden" name="redirect" value="http://www.123.com/thank-you.html">
<input type="hidden" name="errorredirect" value="http://www.123.com/error.html">
<input type="hidden" name="listid" value="16360">
<input type="hidden" name="specialid:16360" value="MA3A">

<input type="hidden" name="clientid" value="1259610">
<input type="hidden" name="formid" value="1030">
<input type="hidden" name="reallistid" value="1">
<input type="hidden" name="doubleopt" value="0">
<input type="text" name="fields_email" size="21" style="padding:5px;">
<input type="image" name="submit" src="signup button top.png" value="" height="32px">

</form> 
```

以及插入数据库的代码：

```
<?php   
    require_once('../../../wp-config.php');
    global $wpdb;
    $table_name = "icontact_emails";
    $email = $_POST[fields_email];
    if (trim($email) != ""){
    $wpdb->insert($table_name, array('email' => $email, 'timestamp'=> date("Y- m-d h:i:s")));
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:13:15.087

“提交”是将其传输到服务器的唯一方法，无论您是通过 AJAX 还是传统方法提交表单 - 没有区别。

请记住，这是一个客户端-服务器模型。表单在客户端，数据库在服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:27:45.497

我可以从您的问题中推断出您的真正意思：我正在尝试将此表单保存到数据库中，然后再将其提交到我无法控制的另一个站点。这意味着您希望在将数据提交给第三方之前将其保存到您自己的数据库中。

如果是这种情况，我建议：

使用表单的 onSubmit 事件 ( `<form onSubmit="YourJavasScriptMethod();">`)。使用[JQuery](http://api.jquery.com/jQuery.ajax/)和 $.ajax() 读取所有表单输入并将它们提交到您自己的脚本，该脚本可以将值保存到数据库中。在您的 onSubmit 方法结束时，请务必返回 true，以便浏览器继续提交表单。

这是一个伪代码示例：

```
<form id="myForm" onSubmit="SaveToMyOwnDatabase();">

    <input />... //your inputs

</form> 
```

和你的 javascript：

```
function SaveToMyOwnDatabase()
{
    // Create Json object by selecting each of the form inputs
    // Call $.ajax and submit the Json to your script which processes the json

    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:53:36.327

我认为解决方案很简单：将您的表单提交到一个 PHP 页面，该页面将：1）将其保存在您的数据库中，2）将其发送到您想要的任何地方。到目前为止，您的案例中最简单和最常用的解决方案！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:26:26.900

我建议使用联系表 7（WP 插件）。有一个内置的 PHP 挂钩，您可以使用它来执行此操作，称为`wpcf7_before_send_mail`. 它将包含所有联系表单数据的对象传递给您的自定义函数，您可以使用该函数将其写入数据库或执行其他服务器端操作。这是一个（非常）简短的例子（这在functions.php中）：

```
add_action( 'wpcf7_before_send_mail', 'save_contact_to_db' );
function save_contact_to_db( $cf7 ) {
    $email = $cf7->posted_data['fields_email'];
    // put database writing stuff here
} 
```

这里还有[更多信息](http://blog.nbruns.us/tutorials/attaching-post-submit-php-to-contact-form-7-forms/)。此外[，此链接应该会有所帮助](http://wordpress.org/support/topic/plugin-contact-form-7-insert-contact-name-and-email-in-database-after-successful-submission)，因为人们正在讨论如何做与您所要求的完全相同的事情。还有[一个插件](http://wordpress.org/extend/plugins/contact-form-7-to-database-extension/)会自动为您将 CF7 或 Jetpack 表单提交写入数据库，但我从未使用过它，所以我无法评论它。一般来说，尽管我建议为此使用联系表 7，尤其是因为您将表单发布数据发送到不在您服务器上的 php 脚本。

# java - Java 对象转换如何在幕后工作？

> ID：13405377
> 
> 赞同：46
> 
> 时间：2012-11-15T20:11:28.797
> 
> 标签：java, casting, polymorphism

> **可能的重复：**
> [Java cast 运算符如何工作？](https://stackoverflow.com/questions/840322/how-does-the-java-cast-operator-work)
> [Java 强制转换实现](https://stackoverflow.com/questions/5886613/java-casting-implementation)

我一直想知道对象转换在 Java 中是如何工作的。我理解原始类型更像是二进制表示级别，但是对象呢？是不是有点像`Polymorphism`，还是`dynamic binding`因为一切都将在运行时确定？例如：

```
class Parent{
     void A(){}
}
class Child extends Parent{
     @Override
     void A(){}
}

Parent p = new Parent();
Child c = (Child) p; 
```

这在幕后如何运作？它会创建一个新的实例`Child`吗？而且，如果你尝试投射会发生什么：

```
Child b = (Child) new Object(); 
```

最后一个，将原语转换为包装类时：

```
Double d = (Double) 3.3; 
```

我知道你不需要投射它，但如果你这样做呢？后端有什么重要的事情发生吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-15T20:16:23.000

当您使用显式强制转换时，系统中不会创建新对象（除了在最后一种情况下，您将原始类型强制转换为[对象包装器](http://en.wikipedia.org/wiki/Primitive_wrapper_class)，因为`double`不是像`Double`is 那样的对象）。[请注意，由于 Java 的自动装箱功能](http://docs.oracle.com/javase/tutorial/java/data/autoboxing.html)，这种显式转换不是必需的。

在您的`(Child) new Object()`场景中，您将收到[ClassCastException](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/ClassCastException.html)，因为 an `Object`is not a `Child`（尽管反之亦然）。

第一个场景的答案是最复杂的。本质上，父类被视为接口。当您将`Child`转换为 时`Parent`，只有`Parent`API 可用。然而，[被覆盖的方法仍然会被调用](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)。所以，如果你这样做：

```
Parent p = (Parent) new Child();
p.a(); 
```

... `Child`'s`public void a()`将被调用，即使它是通过`Parent`班级的镜头看到的。`Child`但是，如果您在中有第二种方法`Parent`没有（`public void b()`例如），如果*不*将对象转换回`Child`.

正如您所说，“幕后”，唯一创建的新事物是指向同一对象的另一个[对象引用。](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)您可以对同一个单一对象有任意多的引用。考虑这个例子：

```
Parent p = new Parent();
Parent p1 = p;
Parent p2 = p;
Parent p3 = p2; 
```

在这里，有四个引用（`p`、`p1`、`p2`和`p3`），每个引用都指向您使用`new Parent()`声明创建的同一个对象。

不过，我可能会在哲学观点上争论，当你说`Parent p = something`.

**链接：**

*   [http://en.wikipedia.org/wiki/Primitive_wrapper_class](http://en.wikipedia.org/wiki/Primitive_wrapper_class)
*   [http://docs.oracle.com/javase/tutorial/java/data/autoboxing.html](http://docs.oracle.com/javase/tutorial/java/data/autoboxing.html)
*   [http://docs.oracle.com/javase/7/docs/api/java/lang/ClassCastException.html](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassCastException.html)
*   [http://docs.oracle.com/javase/tutorial/java/IandI/override.html](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)
*   [Java 是“按引用传递”还是“按值传递”？](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-15T21:38:04.730

您的主要问题的简单答案是否定的。所有转换都发生在语法检查时。

强制转换会影响语法检查器查看对象的方式，它不会影响对象本身，将 Child 强制转换为 Parent，仍然是 Child。

然而，演员表只在运行时检查。这就是为什么它很危险，除非没有其他办法，否则不应使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-15T20:22:46.273

根据这个：[checkcast](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.checkcast)，它的作用是验证引用是否可分配。如果是，则不会更改堆栈并保留对该引用的操作。

因此，如果您有：

```
 Child c = ( Child )  anyObject; 
 c.sayHi(); 
```

如果转换成功，则`sayHi` 可以调用该方法：

> *如果 objectref 可以转换为已解析的类、数组或接口类型，则操作数堆栈不变；否则，checkcast 指令会抛出 ClassCastException。*

这是“字节码”

```
$ cat CastDemo.java 
class Parent {}
class Child extends Parent {}
class Main {
    Child c = (Child) new Parent();
}
$ javap -c Main
Compiled from "CastDemo.java"
class Main {
  Child c;

  Main();
    Code:
       0: aload_0       
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: aload_0       
       5: new           #2                  // class Parent
       8: dup           
       9: invokespecial #3                  // Method Parent."<init>":()V
      12: checkcast     #4                  // class Child
      15: putfield      #5                  // Field c:LChild;
      18: return        
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-15T20:15:30.037

首先，要非常小心不要将*转换*与*强制*转换混淆。它们可能共享表面语法，但是是非常不同的过程。

在 Java 中，您可以将 Object 向下转换为任何类型，但在运行时，`ClassCastException`如果该对象实际上与目标类型不兼容，您将得到一个。这发生在字节码级别：有一条专用于向下转换的字节码指令。

```
Child c = (Child) new Object(); 
```

将无条件地导致一个`ClassCastException`.

```
Double d = 3.3; // note: no explicit casting needed 
```

将**自动装箱**到`Double`. 所以在这里，实际上创建了一个新实例。

一个正常的、成功的 dowcast 可能如下所示：

```
Object o = "a";
String s = (String)o; 
```

在这里，没有创建对象：只有 的值`o`被复制到`s`. 该值是一个参考。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-15T20:17:26.263

向下转换一个对象不会对该对象做任何事情。在幕后，编译器将注入[`checkcast`](https://www.vmth.ucdavis.edu/incoming/Jasmin/ref--7.html)字节码操作。如果`p`不是真正的实例`Child`，则会抛出异常。否则，您基本上对具有不同、更具体类型的同一对象具有（类型）安全引用。

* * *

```
Child b = (Child) new Object(); 
```

这失败了`ClassCastException`。JVM比较`getClass()`与. 由于不是 的子类，因此引发异常。`new Object()``Child.class``Object.class``Child.class`

* * *

```
Double d = (Double) 3.3; 
```

在这里，甚至不需要强制转换，这也可以`Double d = 3.3`：在幕后，这被翻译成：

```
Double d = Double.valueOf(3.3); 
```

这称为[自动装箱](http://en.wikipedia.org/wiki/Object_type_%28object-oriented_programming%29#Autoboxing)。

# jquery-mobile - JQuery Mobile 和 Google Maps 方向问题

> ID：13405379
> 
> 赞同：0
> 
> 时间：2012-11-15T20:11:37.133
> 
> 标签：jquery-mobile, google-maps-api-3, map-directions

我的代码有点问题，我不知道它是什么。我正在托盘绘制到地点之间的方向，但代码不起作用。我尝试使用此页面：[https](https://developers.google.com/maps/documentation/javascript/directions#TravelModes) ://developers.google.com/maps/documentation/javascript/directions#TravelModes但我无法得到它。谢谢 ！这是代码：

```
 $(document).ready(function() {

        $('#Encuentrame').click(function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(exito, error);
            } else {
                error('El navegador no soporta GeoLocalizacion');
            }
        });
    });  

    function exito(position) {
      var marcadorCasa = new google.maps.LatLng(-34.5688496,-58.4322009); //establece la posicion de un marcador que elijo
      var plazaDeMayo = new google.maps.LatLng(-34.60841643923174,-58.37216913700104);
      var directionsDisplay;
      directionsDisplay = new google.maps.DirectionsRenderer();
      var directionsService = new google.maps.DirectionsService();
      var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
      var myOptions = {
        zoom: 19,
        center: latlng,
        mapTypeControl: false,
        navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      var mapcanvas = $('#mapcanvas');
      var map = new google.maps.Map(mapcanvas[0], myOptions);
      var marker = new google.maps.Marker({
          position: latlng,
          map: map, 
          title:"Creo que estoy aca !"
      });
      directionsDisplay.setMap(map);
      var lugarCasa = new google.maps.Marker({
        position:marcadorCasa,
        map:map,
        title:"CASA",
        animation: google.maps.Animation.BOUNCE
      });
      var plaza = new google.maps.Marker({
        position:plazaDeMayo,
        map:map,
        animation: google.maps.Animation.BOUNCE,
        title:"Plaza de Mayo"
      });

      var requerimientoDeDirecciones = new google.maps.DirectionsRequest({
        origin: latlng,
        destination: LugarCasa,
        travelMode: google.maps.TravelMode.BICYCLING,
        unitSystem: UnitSystem.METRIC,
      });

      directionsService.route(requerimientoDeDirecciones, function(result, status) {
        if (status == google.maps.DirectionsStatus.OK) {
          directionsDisplay.setDirections(result);
        }
      });

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:12:39.573

您的代码中有一些错误：

*   [`google.maps.DirectionsRequest`](https://developers.google.com/maps/documentation/javascript/reference?hl=fr-FR#DirectionsRequest)并不存在。Google Maps 文档没有指明任何*构造函数*。它应该被定义为一个匿名对象。
*   `origin`并且`destination`必须是[`google.maps.LatLng`](https://developers.google.com/maps/documentation/javascript/reference?hl=fr-FR#LatLng)or `String`。`LugarCasa`在您的代码中并非如此。
*   您使用`UnitSystem.METRIC`的是`google.maps.UnitSystem.METRIC`.

这是一个工作版本：

```
var requerimientoDeDirecciones = {
  origin: latlng,
  destination: marcadorCasa,
  travelMode: google.maps.TravelMode.BICYCLING,
  unitSystem: google.maps.UnitSystem.METRIC
}; 
```

# javascript - 如何在 Chrome 开发者工具中禁用 JavaScript？

> ID：13405383
> 
> 赞同：489
> 
> 时间：2012-11-15T20:11:55.057
> 
> 标签：javascript, google-chrome, google-chrome-devtools

当用户禁用他们的 JavaScript 时，我正在尝试调试网站的功能。我想知道如何从 Google Chrome DevTools 禁用页面的 JavaScript？

* * *

## 回答 #1

> 赞同：633
> 
> 时间：2012-11-15T20:13:45.963

点击开发者工具一角的**齿轮**`Settings`图标，点击，然后在 下`Debugger`，勾选`Disable Javascript`，如下视频所示：

[![在此处输入图像描述](../Images/12a6afc817cb80d1d5062c55e83f784a.png)](https://i.stack.imgur.com/9S7eq.gif)

* * *

## 回答 #2

> 赞同：212
> 
> 时间：2016-02-10T19:10:02.153

**2020 年 8 月更新**

1.  开发人员工具 (F12)
2.  单击齿轮图标

[![设置](../Images/97d786431bac677d3c108f0fbce0a13f.png)](https://i.stack.imgur.com/tb2Wp.png)

3.  应该打开首选项选项卡
4.  禁用 Javascript 选项在最右边

[![禁用 JS 选项](../Images/bbe6ab21b604dfd0ac5f7a1f778bae55.png)](https://i.stack.imgur.com/913Ab.png)

**原始答案**

1.  开发人员工具 (F12)
2.  右上角的三个垂直点
3.  设置
4.  在左侧的“首选项”选项卡下

[![首选项部分](../Images/ad78cfa8c9b7d60c071cc089add00fee.png)](https://i.stack.imgur.com/hvOvj.jpg)

5.  将有一个带有选项的“调试器”部分（可能在最右边）

[![禁用复选框](../Images/4d003f0ac4386a95c8200a1d945093a4.png)](https://i.stack.imgur.com/L8isH.jpg)

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2016-11-21T18:50:27.180

官方文档：[使用 Chrome DevTools 禁用 JavaScript](https://developers.google.com/web/tools/chrome-devtools/javascript/disable)

现在 DevTools 中内置了一个命令菜单，可以更轻松地禁用 JavaScript。这已经在 2016 年 4 月左右出现。

1.  [打开开发工具](https://developers.google.com/web/tools/chrome-devtools/#open)。
2.  按`Command`+ `Shift`+ `P`(Mac) 或`Control`+ `Shift`+ `P`(Windows、Linux) 打开命令菜单。确保光标的焦点位于 DevTools 窗口上，而不是浏览器视口上。
3.  输入`Disable JavaScript`（或某个版本……这是一个模糊搜索），然后按`Enter`。

`Enable JavaScript`当您想重新打开它时使用该命令。

[![通过命令菜单禁用 js](../Images/f5feedf56399bfd552a6525313826eaa.png)](https://i.stack.imgur.com/AMGrD.png)

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2012-11-15T20:16:49.900

`chrome://settings/content`Javascript/管理异常

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2013-04-26T16:11:03.977

这个扩展使它更快（我是作者）：**[Quick Javascript Switcher](https://chrome.google.com/webstore/detail/quick-javascript-switcher/geddoclleiomckbhadiaipdggiiccfje)**

它是开源的：[https ://github.com/maximelebreton/quick-javascript-switcher](https://github.com/maximelebreton/quick-javascript-switcher)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2012-11-23T18:52:35.917

您还可以使用以下标志在默认禁用 JavaScript 的情况下运行 Chrome：

```
-disable-javascript 
```

例如，您可以通过像这样运行 Chrome 来使用它：

```
C:\Documents and Settings\%username%\Local Settings\Application Data\Google\Chrome" -disable-javascript 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2018-05-14T17:04:20.037

最快的方法可能是这个：

*   F12 打开开发控制台
*   ctrl + shift + p 打开命令工具（windows）
*   输入“禁用 javascript”并回车

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-11-16T17:54:10.277

在 OSX 上，我必须单击三个垂直点，然后取消选中设置部分中的一个框。也可以打开`f1`

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-09-20T13:17:40.520

至少在 Windows 10 中仅使用键盘：

*   `F12`, 显示开发者工具
*   `F1`, 显示设置
*   `tab`，移至“禁用 Javascript”复选框
*   `space`, 切换选项
*   `esc`, 隐藏设置

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-07-11T14:11:07.763

在 Mac OS X 上：

*   优先
*   显示高级设置
*   按“内容设置”按钮
*   滚动到“JavaScript”部分
*   勾选“不允许任何站点运行 JavaScript”前面的复选框

不过，[Chrome Quick JavaScript Switcher 扩展](https://chrome.google.com/webstore/detail/quick-javascript-switcher/geddoclleiomckbhadiaipdggiiccfje)要容易得多 :-)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-02-03T16:53:21.780

*   转到选项（Windows：右上角的三个垂直点）-> 设置，或按 F1。
*   在“常规”部分中，您会找到“禁用 JavaScript”

齿轮图标不再是开发者工具的一部分。自 Chome 30.0 起，甚至无法将其恢复（[在 Google Chrome 开发人员工具中，工具栏图标消失了。什么给出了？](https://stackoverflow.com/questions/15348919/in-google-chrome-developer-tools-the-toolbar-icons-disappeared-what-gives)）

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-09-01T11:38:14.040

暂时阻止域上的 JavaScript：

1.  单击地址栏上地址左侧的按钮（显示`View site information`）
2.  在 旁边的下拉列表中`JavaScript`，选择`Always block on this site`
3.  重新加载页面

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-01-03T18:39:49.187

**快速方法**：

1）只需点击**CTRL + SHIFT + P**

2) 用 3 个字母**dis**填写该字段，然后会出现此框并选择项目**Disable Javascript**

[![禁用 javascript](../Images/72d83287910d1c6b6f790f638c6120d8.png)](https://i.stack.imgur.com/vGr2r.png) .

就是这样！

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-05-29T11:42:41.353

*   点击开发者工具一角的⋮菜单，点击设置
*   点击底部的高级
*   点击内容设置
*   点击 JavaScript
*   关掉

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-11-24T00:45:53.167

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-01-22T12:49:31.357

Press **F8** for temporarily freezing / unfreezing JS (with DevTools open).

This is very useful for debugging UI issues on elements that may lose focus if you click or press anything outside of that element. (Chrome 71.0.3578.98, Ubuntu 18.10)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-03-01T14:08:49.677

粘贴：chrome://settings/content

转到“Javascript”部分并禁用它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-09-06T08:47:03.970

```
Chrome://chrome/settings/Privacy/Content settings/JavaScript 
```

在那里您可以粘贴您网站的 URL，`Manage exceptions..`并将 JavaScript 优先级从允许更改为阻止。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-10-14T05:49:42.497

This is the latest setting for the windows

```
Settings > Advanced > Privacy and security > Site Settings > Javascript > Blocked then get switch on and off 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-03-01T10:17:27.083

good question, i try so many way, but it is curry and boring, until i find shortcut.

1.  alt + cmd + i, this open dev tools, unless you use pocket, that need set other shortcut.
2.  shift + cmd + p, then input: javascript

only two shortcut, but i think safari is more convenient for that.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-06-23T03:12:57.577

There's a settings in chrome

open the menu from chrome, click settings > type in "javascript" in the search bar > click site settings > click javascript.

from here you can toggle javascript specifically to a site using their url. or just click the big button to allow/block it to all sites.

[![enter image description here](../Images/8a9b4f92ec1fc0832bab563e7c18cd25.png)](https://i.stack.imgur.com/5V7ql.png)

# jquery - 使用 ASP.Net MVC、Ajax 和部分视图，如何更新我的 url？

> ID：13405386
> 
> 赞同：1
> 
> 时间：2012-11-15T20:12:11.543
> 
> 标签：jquery, html, asp.net-mvc

好的，所以我试图在页面左侧有一个静态菜单，以便在单击链接时它不会改变。

我是如何做到这一点的，我在我的 A 标记上调用了一个小 javascript，它调用了一些 ajax。我的控制器返回一个局部视图，然后将其加载到我的内容 div 中。

这一切都很好。我遇到的问题是我的 URL 没有改变，我希望能够使用后退按钮返回上一页。

我曾尝试使用 location.hash ，但这似乎并没有按我希望的方式工作。想法？

下面是我的代码。

HTML

```
<li class="item3"><a href="#">Admin</a>
<ul>
    <li class="subitem1"><a onclick="ChangePage('/Admin/PageName', 'Hash')">Page Name</a></li> 
```

Javascript

```
function ChangePage(path, hash) {
        $.post(path, function (data) {
            $('#content').html(data);
            window.location.hash = '#' + hash;
        });
    } 
```

控制器

```
 public ActionResult PageName()
    {
        return PartialView("MyPage");
    } 
```

谢谢！大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:16:35.410

考虑检查[pjax](http://pjax.heroku.com/)。使用 MVC 实现非常容易，并且会完全按照您的要求完成。

[本文](http://kazimanzurrashid.com/posts/asp-dot-net-mvc-with-pajax-or-pushstate-slash-replacestate-and-ajax)讨论了另一种选择，PAjax。

`pushState`正如您在评论中所说的那样，这两种杠杆仍然没有得到所有浏览器的完全支持。但是当不支持 pushstate 时，pjax 会通过进行全页面更新来优雅地降级。

# ios - UIImagePickerController 上出现自定义后退按钮

> ID：13405390
> 
> 赞同：5
> 
> 时间：2012-11-15T20:12:27.397
> 
> 标签：ios, uinavigationbar, back-button, uiappearance

我使用以下代码在整个应用程序中自定义导航栏上的后退按钮：

```
UIImage *backButton = [[UIImage imageNamed:@"backButton"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
UIImage *backButtonOn = [[UIImage imageNamed:@"backButton_on"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButton
                                                  forState:UIControlStateNormal
                                                barMetrics:UIBarMetricsDefault];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonOn
                                                  forState:UIControlStateHighlighted
                                                barMetrics:UIBarMetricsDefault]; 
```

它工作得很好，除了当我呈现 UIImagePickerController 并在照片库中输入相册时，后退按钮也是自定义的后退按钮。如何取回图像选择器中的原始后退按钮？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-26T07:34:04.667

```
 [[UIBarButtonItem appearanceWhenContainedIn:[UIImagePickerController class], nil] setBackButtonBackgroundImage:[UIImage imageNamed:@"blank-button"] forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

这是正确的方法

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T20:21:39.147

尝试使用这个：

```
 [[UINavigationBar appearanceWhenContainedIn:[YourClassThatsNotAUIImagePicker class], nil] setBackButtonBackgroundImage:someOtherImage forBarMetrics:UIBarMetricsDefault]; 
```

这应该将您的外观设置限制为仅列出您列出的类，因此不理会 UIImagePickerController。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-17T11:18:00.607

1.对于swift和ios9（上面的答案会像）--

```
 UIBarButtonItem.appearanceWhenContainedInInstancesOfClasses([UIImagePickerController.self]).setBackButtonBackgroundImage(UIImage(named: "blank-button"), forState: UIControlState.Normal, barMetrics: UIBarMetrics.Default) 
```

2.如果要修改UINavigationBar的backIndicatorImage

```
UINavigationBar.appearanceWhenContainedInInstancesOfClasses([UIImagePickerController.self]).backIndicatorImage = UIImage(named: "backButton")//or nil 
```

3.如果要修改backIndicatorTransitionMaskImage

```
UINavigationBar.appearanceWhenContainedInInstancesOfClasses([UIImagePickerController.self]).backIndicatorTransitionMaskImage =UIImage(named: "backButton")// nil 
```

# php - PDO 绑定参数问题

> ID：13405392
> 
> 赞同：0
> 
> 时间：2012-11-15T20:12:30.383
> 
> 标签：php, mysql, pdo

> **可能重复：**
> [PHP PDO 语句可以接受表名作为参数吗？](https://stackoverflow.com/questions/182287/can-php-pdo-statements-accept-the-table-name-as-parameter)

我的班级中有一个函数正在做一些麻烦。这里的功能

```
function insert($table,$column = array(),$value = array())
{
    $array1 = implode(",", $column);
    $array2 = implode(",", $value);

    try 
    { 
        $sql = $this->connect->prepare("INSERT INTO :table (:date1) VALUES (:date2)");  
        $sql->bindParam(':table',$table, PDO::PARAM_STR);
        $sql->bindParam(':data1',$array1, PDO::PARAM_STR);
        $sql->bindParam(':data2',$array2, PDO::PARAM_STR);

        $sql->execute();

    }  
    catch(PDOException $e) 
    {  
        echo $e->getMessage();  
    }  
} 
```

我用以下方法调用该函数：

```
-> insert('coupons',array('categorie','name','link','code','id'),array('test11','test','test','test','NULL')); 
```

我得到的错误是：

> 警告：PDOStatement::execute() [pdostatement.execute]: SQLSTATE[HY093]: Invalid parameter number: parameter was not defined in C:\xampp\htdocs\MYFRAMEWORK\lib\database.class.php on line 46

第 46 行是：

```
$sql->execute(); 
```

所以现在我真的不明白问题出在哪里。任何指针？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:32:10.230

# PDO 绑定值数据，而不是表名和列名。

您误解了绑定的使用。您不能将表名和列名与 PDO 绑定。您绑定数据以插入这些列。您需要使用字符串操作构造 SQL 以包含表名和列。

## 格式化数据

我已将您的 $column 和 $value 重命名为 $column_array, $value_array 以明确它们是什么，并假设每个都是一个简单的数组：`$column_array = array('column1', 'column2', ...) etc.`

```
$placeholders = array_map(function($col) { return ":$col"; }, $column_array);

$bindvalues = array_combine($placeholders , $value_array); 
```

$placeholders 现在看起来像这样：

```
$placeholders = array(
        ':column1',
        ':column2',
         ...
    ); 
```

$bindvalues 现在看起来像这样：

```
$bindvalues = array(
        ':column1'=>'value1',
        ':column2'=>'value2',
         ...
    ); 
```

## 构建、准备、执行

```
$sql = $this->connect->prepare("INSERT INTO $table (" .implode(",", $column_array) .") VALUES (". implode(",", $placeholders) . ")"; 
```

这将为您提供一份准备好的表格声明：

```
$sql = INSERT INTO table_name (column1, column2, ...) VALUES (:column1, :column2, ...) 
```

然后，您可以执行准备好的语句并将 $values 作为参数传递。

```
$sql->execute($bindValues); 
```

## 笔记：

*   必须提到的一个警告。 **确保您的原始数据已针对 SQL 注入进行了清理。** PDO 负责处理绑定值，但如果您从 $_POST 数据构建列，这很容易受到攻击，需要进行清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:17:15.870

查询构造不正确，`values`缺少周围的`'`引号。

当您执行 时`implode`，array2 看起来像，

```
 test1,test,test... //and so on. 
```

它需要是 'test1','test','test'...才能在`Insert`查询中正确绑定。

```
$sql = $this->connect->prepare("INSERT INTO :table (:date1) VALUES (:date2)"); 
```

此外，您在参数名称中有拼写错误，`date1`而不是`data1`和`date2`而不是`data2`.

# java - Java Socket 客户端向设备发送额外的字节

> ID：13405397
> 
> 赞同：1
> 
> 时间：2012-11-15T20:12:51.740
> 
> 标签：java, sockets, tcp, embed, socket.io

目前我正在开发一个将二进制数据命令发送到设备面板的 Java 客户端。我有一个奇怪的问题，如果我为每个套接字连接（一个 TCP 会话）发送一个命令，所有命令都可以正常工作。但是当我在一个连接中发送多个命令（相同的 TCP 会话）时，第一个命令会在设备面板上完美执行，但在第二个命令中它会获得两个额外的字节值`0x01`和`0x00`. 这很奇怪，过去几天我一直在尝试，但找不到答案。

我的代码：

```
SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
sslsocket = (SSLSocket) sslsocketfactory.createSocket(deviceIP, port);
//Output Streams
OutputStream outputStream = sslsocket.getOutputStream();

outputStream.write(command1);

outputStream.write(command2); 
```

注意`command1`和`command2`是字节数组：

*   command1 中的值 = 01,01,01
*   command2 中的值 = 01,34,45,34,56

设备面板的日志为：

```
Received command: 01 01 01
Received command: 01 00 01 03 45 34 56 
```

可能是什么问题呢？您的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-19T15:51:30.830

我对带有 SSLSocket 的 Java 6 应用程序有同样的问题，服务器在两次写入之间收到了一个额外的字节。额外字节是 SSL 连接的 CBC 保护。如果您不希望有额外的字节，请添加一个 java 属性 -Djsse.enableCBCProtection=false 以禁用 CBC 保护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T22:26:55.617

Java 和您的操作系统不会添加额外的字节。否则一半的互联网将无法工作。很明显，要么设备出现故障，要么您错误地观察它。

# javascript - 使用没有 src 属性的 iframe

> ID：13405400
> 
> 赞同：0
> 
> 时间：2012-11-15T20:13:10.040
> 
> 标签：javascript, jquery, html, iframe

在我的网页中，用户可以单击作为复选框的输入。后来在他们的浏览中，他们选择的选项会导致其他 html 文档显示在他们所在的页面中。至少是这样的想法。

因此，用户 A 单击“Doc1”和“Doc4”的复选框。一个 ajax 调用发送到 Web 服务并将这些文档拉回。它们是html。回调方法应该采用这个 html 并将其插入到页面中。

我尝试使用 iframe，但这似乎需要指定 src 属性。返回的 html 是一个完整的页面，包括 . 这仅适用于兼容 HTML5 的浏览器。

这是可能的，还是我应该看 iframe 以外的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:38:55.343

我解决了这个问题：

*   用户选中几个复选框并单击“下一步”。
*   AJAX 调用出去检索那些与复选框相关联的文档。
*   显示的页面检索此数据，并根据需要创建 iframe。
*   无法指定 SRC，因为没有 url！
*   IE 不支持 ...'> 因为 2083 个字符是 IE 的限制。
*   最终解决方案是手动写入 iframe：

> ```
> var target = document.getElementById(someIframe).contentDocument;
> target.open();
> target.write(documentReceivedFromAJAXCall);
> target.close(); 
> ```

# unit-testing - java中修改条件/决策覆盖分析工具

> ID：13405406
> 
> 赞同：2
> 
> 时间：2012-11-15T20:13:31.387
> 
> 标签：unit-testing, testing, code-coverage, mc-dc

java中是否有任何用于修改条件/决策覆盖率分析的开源工具。

我看过coberta，它似乎只提供有条件的覆盖。

我有兴趣执行此处描述的分析

[http://sunnyday.mit.edu/papers/dupuy.pdf](http://sunnyday.mit.edu/papers/dupuy.pdf)

[http://en.wikipedia.org/wiki/Modified_condition/decision_coverage](http://en.wikipedia.org/wiki/Modified_condition/decision_coverage)

> 为了满足 MC/DC 覆盖标准，在测试期间，以下所有条件必须至少为真一次[1]：
> 
> ```
> * Each decision tries every possible outcome
> * Each condition in a decision takes on every possible outcome
> * Each entry and exit point is invoked
> * Each condition in a decision is shown to independently affect the outcome of the decision 
> ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-05-25T10:20:29.477

# MC/DC - 多条件/决策覆盖

> 程序中的每个进入点和退出点都至少被调用过一次，程序中决策中的每个条件至少对所有可能的结果采取了一次，并且每个条件都已被证明独立地影响该决策结果。通过仅改变该条件同时保持所有其他可能的条件不变，一个条件被证明可以独立地影响决策的结果。[维基百科 MC/DC - en.wikipedia.org/wiki/Modified_condition/decision_coverage]

# 代码封面

[http://codecover.org/features/coverage.html](http://codecover.org/features/coverage.html)

CodeCover 声明也检查 MC/DC，他们称之为 Ludewig 术语意义上的术语覆盖。我试图找到有关 Ludewig 术语的其他信息，但找不到任何有用的信息。

## 术语覆盖 (CodeCover)

术语覆盖检查布尔短路语义，例如涉及并不总是评估的副作用的决策：

```
if (expressionA && myfunc(b)) {
    do_something();
} 
```

[维基百科短路评估 - en.wikipedia.org/wiki/Short-circuit_evaluation]

如果 expressionA 的计算结果为 false，则不会执行 myfunc(b)。这是编写更快代码的常用技术，但存在风险，因为 myfunc(b) 可以对环境进行一些更改，这很容易被开发人员监督，从而创建不安全的代码。

根据我的理解，术语覆盖验证 expressionA 的计算结果为真假，因此 myfunc(b) 至少执行一次。

# 测试井 CTC++

[http://www.verifysoft.com/en_ctcpp.html](http://www.verifysoft.com/en_ctcpp.html)

*   许可证从 4100 欧元到 8800 欧元的专有软件</li>
*   似乎支持 C、C++、Java、C#
*   支持所有编译器
*   符合 DO 178-C / ED-12C（航空航天）、EN 50128（铁路）、IEC 61508（电子安全相关系统）、IEC 62304（医疗）、ISO 26262（汽车）、IEC 60880（核电）等质量标准。

PS：我没有足够的声誉来发布两个以上的链接，因此我使它们无法解析。但它们在引用参考中仍然很重要。

# android - 为什么android项目不能导入eclipse？

> ID：13405408
> 
> 赞同：0
> 
> 时间：2012-11-15T20:13:45.093
> 
> 标签：android, eclipse

我有一个根目录，里面有许多 android eclipse 项目。它们都有 .project 文件，但 eclipse 似乎没有将它们视为 eclipse 项目？有谁知道原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:19:04.990

eclipse中不导入项目的原因：

**原因一：项目结构不同**

**原因 2：项目配置文件丢失或不可用**

**原因 3：项目可能已经存在于工作空间中**

**原因 4：没有正确和标准的命名约定**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:16:49.803

您必须手动导入它们

*   第一的`File > Import`

*   然后`General > Existing Project Into Workspace`

*   选择根目录或选择存档文件，单击浏览找到包含要导入的项目的目录或文件

*   在`Projects`选择要导入的项目下

*   最后点击完成导入项目

这是 eclipse 帮助部分的链接

*   [http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2Ftasks%2Ftasks-importproject.htm](http://help.eclipse.org/helios/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2Ftasks%2Ftasks-importproject.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T09:44:48.673

按着这些次序。

希望你有 Eclipse 的 android sdk 和 ADT 插件。

File-->Import-->Android-->Existing Android code into workspace。

然后使用浏览按钮从您的根目录导入项目。如果你没有 ADT 插件，你绝对不会导入你的 android 项目。

# javascript - 如何使用 jquery 读取 url 中的单词？

> ID：13405419
> 
> 赞同：1
> 
> 时间：2012-11-15T20:14:40.170
> 
> 标签：javascript, jquery

我如何总是使用 jquery/javascript 在端口号之后读取第一个单词，例如单词“something”？

这是网址，我想获取端口号之后的第一个单词

[http://www.aaa.com:1081/something/arap/con.html](http://www.aaa.com:1081/something/arap/con.html)

```
$(document).ready(function() {
    var currentUrl= window.location.pathname;
    alert (currentUrl);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:17:17.993

又快又脏：

```
window.location.pathname.split('/')[1] 
```

但你可能想改用这样的东西：[https ://github.com/allmarkedup/jQuery-URL-Parser](https://github.com/allmarkedup/jQuery-URL-Parser)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:17:00.883

```
$(document).ready(function() {
    var pathArray = window.location.pathname.split( '/' );
   //Then access the different parts by the parts of the array, like
    var secondLevelLocation = pathArray[0];

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:17:14.743

尝试：

```
$(document).ready(function() {
    var currentUrl= window.location.pathname.split('/')[1];
    alert (currentUrl);
}); 
```

# java - 单例客户端连接器

> ID：13405424
> 
> 赞同：0
> 
> 时间：2012-11-15T20:14:54.997
> 
> 标签：java, networking, connection

想象一下你有一个聊天程序，你想在其中向服务器发送和接收数据。将客户端连接变成单例会很聪明吗？或者这会破坏数据流。

我的客户单例示例：

```
public class Client {
    private static Client client;
    private final int portNumber = 7070;
    private Socket socket;
    private Client(){
        connect();

    }
    public static synchronized Client getClient(){
        if (client == null) {
            client = new Client();
        }
        return client;
    }

    public void connect(){

        try {
            InetAddress adr = InetAddress.getByName("localhost");
            socket = new Socket(adr, portNumber);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:23:09.683

您的代码有两个问题：

*   单例非常不灵活。如果你以后想实现负载均衡或连接池，你的双手就束手无策了。只允许一个连接。那么重新连接呢？你如何摆脱旧的连接并创建一个新的连接？

*   在构造函数内连接（或任何具有副作用的操作）不是一个好习惯。想象一下对这个类进行单元测试

所以我不建议单例连接对象。而是有一个带有方法的`ClientConnections`管理器类。`Client connect()`这个管理器类跟踪所有打开的连接，可以缓存它们，关闭未使用的，定期测试等，`ClientConnections`是单例的更好候选者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:21:58.973

如果您不希望每个客户端有多个连接，则使用单例客户端是有意义的。这在大多数情况下应该没问题，除非您想支持同时发送多个文件。

# c# - C# ListBox 从文本文件导入崩溃

> ID：13405426
> 
> 赞同：3
> 
> 时间：2012-11-15T20:15:04.150
> 
> 标签：c#, import, crash, listbox

我正在使用此代码将文本文件导入我的 ListBox

```
 OpenFileDialog openFileDialog1 = new OpenFileDialog();
        openFileDialog1.Filter = "Text Files|*.txt";
        openFileDialog1.Title = "Select a Text file";
        openFileDialog1.FileName = "";
        DialogResult result = openFileDialog1.ShowDialog();
        if (result == DialogResult.OK)
        {
            string file = openFileDialog1.FileName;

            string[] text = System.IO.File.ReadAllLines(file);
            foreach (string line in text)
            {
                listBox2.Items.Add(line);

            }
            listBox2.Items.Add("");
        } 
```

它适用于 10 行左右的小文本文件，但是当我尝试导入更大的列表时，（4-5 兆字节）程序没有响应并且崩溃了。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:22:09.597

使用 C# 中的 BufferedStream 类来提高性能。
[http://msdn.microsoft.com/en-us/library/system.io.bufferedstream.aspx](http://msdn.microsoft.com/en-us/library/system.io.bufferedstream.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:30:26.233

通过使用这个：

```
string[] text = System.IO.File.ReadAllLines(file);
listBox1.Items.AddRange(text); 
```

而不是这个：

```
string[] text = System.IO.File.ReadAllLines(file);
foreach (string line in text)
{
       listBox2.Items.Add(line);
} 
```

您将至少加快执行速度 10-15 倍，因为您不会在每个 Item 插入时使 listBox 无效。我已经测量了几千行。

瓶颈也可能是`ReadAllLines`您的文本行数过多。即使我不明白为什么要插入这么多行，用户能否找到他/她需要的行？

**编辑**好然后我建议你使用BackgroundWorker，这里是代码：

首先初始化 BackGroundWorker：

```
 BackgroundWorker bgw;
        public Form1()
        {
            InitializeComponent();
            bgw = new BackgroundWorker();
            bgw.DoWork += new DoWorkEventHandler(bgw_DoWork);
            bgw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bgw_RunWorkerCompleted);
        } 
```

然后你在你的方法中调用它：

```
private void button1_Click(object sender, EventArgs e)
        {
            if (!bgw.IsBusy)
            {
                OpenFileDialog openFileDialog1 = new OpenFileDialog();
                openFileDialog1.Filter = "Text Files|*.txt";
                openFileDialog1.Title = "Select a Text file";
                openFileDialog1.FileName = "";
                DialogResult result = openFileDialog1.ShowDialog();
                if (result == DialogResult.OK)
                {
                    string file = openFileDialog1.FileName;
                    listView1.BeginUpdate();
                    bgw.RunWorkerAsync(file);
                }
            }
            else
                MessageBox.Show("File reading at the moment, try later!");
        }

        void bgw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            listView1.EndUpdate();
        }
        void bgw_DoWork(object sender, DoWorkEventArgs e)
        {
            string fileName = (string)e.Argument;
            TextReader t = new StreamReader(fileName);
            string line = string.Empty;
            while ((line = t.ReadLine()) != null)
            {
                string nLine = line;
                this.Invoke((MethodInvoker)delegate { listBox1.Items.Add(nLine); });
            }
        } 
```

它会在读取时添加每一行，您将拥有响应式 UI，并且在完成加载之前，行不会影响 listBox。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:22:47.163

可以使用流来存储数据：

```
class Test
{

public static void Main()
{
    string path = @"c:\temp\MyTest.txt";

    //Create the file. 
    using (FileStream fs = File.Create(path))
    {
        AddText(fs, "This is some text");
        AddText(fs, "This is some more text,");
        AddText(fs, "\r\nand this is on a new line");
        AddText(fs, "\r\n\r\nThe following is a subset of characters:\r\n");

        for (int i=1;i < 120;i++)
        {
            AddText(fs, Convert.ToChar(i).ToString());

        }
    }

    //Open the stream and read it back. 
    using (FileStream fs = File.OpenRead(path))
    {
        byte[] b = new byte[1024];
        UTF8Encoding temp = new UTF8Encoding(true);
        while (fs.Read(b,0,b.Length) > 0)
        {
            Console.WriteLine(temp.GetString(b));
        }
    }
}

private static void AddText(FileStream fs, string value)
{
    byte[] info = new UTF8Encoding(true).GetBytes(value);
    fs.Write(info, 0, info.Length);
} 
```

}

然后你的事件处理程序

```
 privateasyncvoid Button_Click(object sender, RoutedEventArgs e)
    {
        UnicodeEncoding uniencoding = new UnicodeEncoding();
        string filename = @"c:\Users\exampleuser\Documents\userinputlog.txt";

        byte[] result = uniencoding.GetBytes(UserInput.Text);

        using (FileStream SourceStream = File.Open(filename, FileMode.OpenOrCreate))
        {
            SourceStream.Seek(0, SeekOrigin.End);
            await SourceStream.WriteAsync(result, 0, result.Length);
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:26:01.413

它可能根本没有完成它的工作，你应该等待更多。试试这个解决方案：

[http://www.bytechaser.com/en/articles/f3a3niqyb7/display-large-lists-in-listview-control-quickly.aspx](http://www.bytechaser.com/en/articles/f3a3niqyb7/display-large-lists-in-listview-control-quickly.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T20:43:54.663

您的应用程序变得无响应，因为它正在等待`ReadAllLines`方法完成并阻塞 UI 线程。您可能希望在单独的线程上读取文件以避免阻塞 UI。我不能保证下面的代码不会出错，但它应该让你知道如何解决这个问题。

首先，您需要一种方法将项目附加到`ListBox`：

```
private void AddListBoxItem(string item)
{
    if(!InvokeRequired)
    {
        listBox2.Items.Add(item);
    }
    else
    {
        var callback = new Action<string>(AddListBoxItem);
        Invoke(callback, new object[]{item});
    }
} 
```

上面的方法检查它是否在 UI 线程上执行，如果是，它只是将一个项目添加到`listBox2.Items`集合中；如果没有，它会从自身创建一个委托并在 UI 线程上调用该委托。

接下来，您需要将读取文件的代码移动到另一个线程并调用`AddListBoxItem`方法。为了可读性，让我们把它放到一个单独的方法中：

```
private void AddFileContentsToList(string fileName)
{
    using(var reader = new System.IO.StreamReader(fileName))
    {
        while(!reader.EndOfStream)
        {
            var line = reader.ReadLine();
            AddListBoxItem(line);
        }
    }
} 
```

现在我们将在单独的线程上调用该方法：

```
OpenFileDialog openFileDialog1 = new OpenFileDialog();
openFileDialog1.Filter = "Text Files|*.txt";
openFileDialog1.Title = "Select a Text file";
openFileDialog1.FileName = "";
DialogResult result = openFileDialog1.ShowDialog();
if (result == DialogResult.OK)
{
    var thread = new Thread(AddFileContentsToList);
    thread.Start();
} 
```

希望这可以帮助！

# sql - 交叉连接两个表

> ID：13405434
> 
> 赞同：1
> 
> 时间：2012-11-15T20:15:56.350
> 
> 标签：sql

我有一个看起来像这样的表，让我们称之为这个表`B`。

```
id    boardid    schoolid     subject     cnt1   cnt2  cnt3 ....
=================================================================
1       20         21           f     
2       20         21           r
3       20         21           w
4       20         21           m
5       20         30           r
6       20         30           w
7       20         30           m 
```

假设计数只是整数。请注意，没有`subject = f`for `schoolid = 30`。同样，对于大多数学校来说，有些学校`subject`并不存在。你可能有一个`schoolid`刚刚`r, w`或一些只是`r, m, f`..

所以我想要做的是每所学校有 4 个一致的行，并且不存在的行我想要虚拟值。我想过创建一个辅助表

```
drop table #A
Select * into #A FROM 
(
select [subject_s] = 'r', orderNo = 1
union all
select [subject_s] = 'w', orderNo = 2
union all
select [subject_s] = 'm', orderNo = 3
union all
select [subject_s] = 'f', orderNo = 4
) z 
```

并在他们身上做一些连接，但我没有得到任何地方。我试过内连接，左外连接，交叉连接，一切。我什至尝试过制作笛卡尔积。我认为我的笛卡尔乘积搞砸了，因为我`orderno`在那里，所以它在主表中每行有 16 行。实际上输入这个，我意识到如果我删除`orderno`，应用笛卡尔积，然后在稍后添加 orderno，它可能会起作用，但我很想看看你们能想出什么。我难住了。

最终结果

```
id    boardid    schoolid     subject     cnt1   cnt2  cnt3 ....
=================================================================
1       20         21           r     
2       20         21           w
3       20         21           m
4       20         21           f
5       20         30           r
6       20         30           w
7       20         30           m
7       20         30           f 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:30:28.277

尝试以下操作：

```
SELECT S.boardid, S.schoolid, A.[subject], B.cnt1, B.cnt2, B.cnt3
FROM (SELECT DISTINCT boardid, schoolid FROM YourTable) S
CROSS JOIN #A A
LEFT JOIN YourTable B
    ON B.boardid = S.boardid AND  B.schoolid = S.schoolid 
    AND A.[subject] = B.[subject] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:39:25.360

由于我不知道您使用的是哪个 RDBMS，因此我尝试了以下方法`sqlite`和一个更简单的表：

```
sqlite> create table schools (name varchar, subject varchar, teacher varchar);

sqlite> select * from schools;
School1|Maths|Mr Smith
School2|English|Jack
School3|English|Jimmy
School3|Maths|Jane
School4|Computer Science|Bob

sqlite> select
            schoolnames.name, 
            subjects.subject, 
            ifnull(teachers.teacher, "Unknown") 
        from (select distinct name from schools) schoolnames
        join (select distinct subject from schools) subjects
        left join schools teachers
           on schoolnames.name = teachers.name
              and subjects.subject = teachers.subject;

School1|Maths|Mr Smith
School1|English|Unknown
School1|Computer Science|Unknown

School2|Maths|Unknown
School2|English|Jack
School2|Computer Science|Unknown

School3|Maths|Jane
School3|English|Jimmy
School3|Computer Science|Unknown

School4|Maths|Unknown
School4|English|Unknown
School4|Computer Science|Bob 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-15T20:33:08.993

我会使用：

```
SELECT 
    boardid, schoolid, dist_subject, id, cnt1, ...
FROM
    (SELECT 
        boardid, schoolid, dist_subject
    FROM
        (SELECT 
            DISTINCT subject AS dist_subject 
        FROM b ) s full outer join
        (SELECT 
            boardid, schoolid 
        FROM b 
        GROUP BY 
            boardid, schoolid   ) g ) sg LEFT OUTER JOIN
    b ON 
    sg.boardID = b.boardID AND
    sg.schoolid = b.schoolID
    sg.dist_subject = b.subject 
```

# twitter-bootstrap - 如何在流星应用程序中自定义引导程序？

> ID：13405435
> 
> 赞同：10
> 
> 时间：2012-11-15T20:15:55.230
> 
> 标签：twitter-bootstrap, meteor

Meteor 很棒，并且支持使用“智能包”进行引导，可以像这样包含：

```
meteor add bootstrap 
```

然后 css、javascript 和图像在运行时神奇地包含在浏览器中。太好了，但我想自定义引导程序，使其看起来不像网络上的所有其他引导程序站点。通常我会使用[引导程序自定义](http://twitter.github.com/bootstrap/customize.html)功能，但这在此处不可用。对我来说，在流星上下文中将自定义应用于引导的最佳方式是什么？

如果我可以从 Bootstrap 定制器生成一个 LESS 文件，将它放入我的目录并完成它，那将是特别理想的。事实证明，Bootswatch 生成的 CSS 会破坏流畅的布局，此外，任何第三方迟早都会过时。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T20:34:04.997

好吧，似乎解决方案很简单。我可以通过在我的流星应用程序的根目录中简单地包含一个 css 文件来覆盖默认值。我碰巧使用了[Bootswatch](http://bootswatch.com/)的罐装 css 文件，但我想也可以手动将其卷起来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-15T12:18:46.227

我最终完全删除了流星引导程序包并将其安装为`git submodule`inside `packages`。

我制作了自己的自定义打包 git repo [meteor-bootstrap](https://github.com/littke/meteor-bootstrap/tree/meteor-packaged)，我还向其中添加了一个`package.js`文件，其中包含我要使用的文件的说明。（见分行`meteor-packaged`）。

我这样做是为了能够更改 Bootstrap 变量并自由使用 LESS mixins，而不是包含每个 Bootstrap JS 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T09:34:59.763

我创建了一个 shell 脚本来从预编译发行版或您自己的 Bootstrap Git 存储库克隆生成自定义引导 Meteor 包。

您可以在这里找到它以及使用信息： [https ://github.com/wojas/meteor-package-bootstrap](https://github.com/wojas/meteor-package-bootstrap)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-16T15:05:13.273

此链接提供了一种将引导程序与 Meteor 一起使用的更好且更智能的方法。定制是通过变量和 mixins 完成的。如果你愿意，你可以试试。

* * *

> [https://www.manuel-schoebel.com/blog/meteorjs-and-twitter-bootstrap-the-right-way](https://www.manuel-schoebel.com/blog/meteorjs-and-twitter-bootstrap-the-right-way)

# php - PHP 文档根目录包含在

> ID：13405436
> 
> 赞同：0
> 
> 时间：2012-11-15T20:15:58.243
> 
> 标签：php

目前我在我网站的每个页面上都有这个，所以我可以在同一台服务器上的开发网站上使用相同的网站代码，但似乎他们是比这更好的方法？

```
define("DOC_ROOT", $_SERVER["DOCUMENT_ROOT"]);
$folder=explode("/",DOC_ROOT);

include("/home/".$folder[2]."/header.php"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:02:14.990

我通常使用一个通用文件来处理所有这些通用的事情（数据库连接启动、通用对象创建、确定语言、保存数据库用户名和密码等），我称之为`master_config.php`.

看起来像：

```
define("SITE","www.example.com");
define("DB_SERV", "db.com");
define("DB_USER", "user");
define("DB_PASS", "pass");
define("GOOGLE_MAPS_KEY", "qweasd");
$db = new database();
$db -> connect(DB_SERV,DB_USER,DB_PASS);
.. etc 
```

因此，如果您创建一个新页面，那么您只需将其包含在`master_config.php`其中，所有常见的对象、变量和设置都已被带到该页面。您可以将文件夹设置和分解添加到同一个公共文件中，并且只使用您在相应 php 文件中需要的部分。

# repository - 在 Maven 存储库之间移动工件的 Gradle 脚本

> ID：13405446
> 
> 赞同：1
> 
> 时间：2012-11-15T20:16:37.320
> 
> 标签：repository, gradle

我正在使用 Gradle 脚本将工件从一个 Maven 存储库复制到另一个。我试图通过将工件作为依赖项然后我们将其设置为存档来破解它。

我已经尝试使用 configuration.files() 方法，但我无法构建它将接受的依赖对象。

```
dependencies {
    compile group: artGroup, name: artName, version: artVersion
}

artifacts {
    archives configurations.default.files( 
        /* I have not been able to build an argument this method accepts */ 
    )
}

uploadArchives {
    repositories {
        mavenDeployer {
            repository(url: 'file:../../../repo')
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T07:18:43.510

我们已经在其他环境中这样做了（将文件从远程复制到本地），看起来你对 Gradle DSL 有一些误解。

首先，工件 { archives {}} 用于将可部署的工件添加到档案配置中。您不能在此块中使用它（就对配置文件做某事而言）。

其次，您无法上传“按原样”解决的内容。上传用于构建生成或手动添加的工件（它们具有特殊类型）。

对我们来说，解决方案是创建一个新的 Gradle 任务“copyArtifacts”，它实际上将所有已解析配置的文件复制到本地文件夹中。

希望这可以帮助。

# linux - 共享内存页面和分叉

> ID：13405453
> 
> 赞同：4
> 
> 时间：2012-11-15T20:17:05.197
> 
> 标签：linux, kernel

如果父进程与另一个进程共享一些页面并且我们分叉父进程。据我所知，孩子复制页表，我们将页面设置为只读并执行 Copy-On-Write。但是，如果我们写入错误的共享内存页面，这将创建共享内存页面的副本。Linux内核如何避免这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:45:23.563

内核知道使用共享内存操作分配了哪些内存页面。当一个孩子被分叉时，这些页面不会被标记为 Copy-on-Write，因此它们将在所有进程之间保持共享。

这记录在`vm_area_struct`数据结构中，在`vm_flags`成员中。标志之一是`VM_SHARED`. mm/memory.c 包含以下函数，用于确定是否应将页面转换为 COW

```
static inline int is_cow_mapping(vm_flags_t flags)
{
        return (flags & (VM_SHARED | VM_MAYWRITE)) == VM_MAYWRITE;
} 
```

如果您想了解有关如何设置和使用此标志的更多信息，请转到[Linux 交叉参考](http://lxr.linux.no/)并搜索 VM_SHARED。

# c# - 序列化。里亚服务。

> ID：13405459
> 
> 赞同：0
> 
> 时间：2012-11-15T20:17:18.550
> 
> 标签：c#, .net, wcf-ria-services, silverlight-5.0

我在 ria-service 中使用了三个类：

首先是响应类：

```
[DataContract]
public class ValidationResponseContainer
{
    [DataMember]
    public string EntityId { get; set; }

    [DataMember]
    public bool IsWarning { get; set; }

    [DataMember]
    public string ConstraintName { get; set; }

    [DataMember]
    public IEnumerable<string> Fields { get; set; }
} 
```

其次是 KeyValuePair<> 之类的东西：

```
[DataContract]
public class FieldValueContainer
{
    [DataMember]
    public Guid ConstraintId { get; set; }

    [DataMember]
    public string FieldName { get; set; }

    [DataMember]
    public string Value { get; set; }
} 
```

三是要求：

```
[DataContract]
[KnownType(typeof(FieldValueContainer))]
public class ValidationRequestContainer
{
    [DataMember]
    public string EntityId { get; set; }

    [DataMember]
    public string TableName { get; set; }

    [DataMember]
    public IEnumerable<FieldValueContainer> FieldValues { get; set; }

    public ValidationRequestContainer()
    {
        FieldValues = new List<FieldValueContainer>();
    }
} 
```

部署我的项目后，我在 EventLog 中收到一个错误：

```
Exception System.Runtime.Serialization.InvalidDataContractException Type 'System.Linq.Enumerable+WhereSelectEnumerableIterator`2[_2020vision.Infrastructure.FieldValueContainer,System.String]' cannot be serialized. Consider marking it with the DataContractAttribute attribute, and marking all of its members you want serialized with the DataMemberAttribute attribute.  If the type is a collection, consider marking it with the CollectionDataContractAttribute.  See the Microsoft .NET Framework documentation for other supported types.
   at System.Runtime.Serialization.DataContract.DataContractCriticalHelper.ThrowInvalidDataContractException(String message, Type type) 
```

我的数据合同类有什么问题？

# ruby - Ruby 哈希在默认值中使用键值

> ID：13405460
> 
> 赞同：1
> 
> 时间：2012-11-15T20:17:22.207
> 
> 标签：ruby, hash, default-value

我有以下代码来创建一个对象哈希数组：

```
tp = TupleProfile.new(98, 99)
keyDict = Hash[Array[98,99] => tp]
keyDict[[98,99]].addLatency(0.45)
puts keyDict[[98,99]].getAvg() 
```

这可行，但我希望能够在不检查现有哈希值的情况下调用 addLatency：

```
keyDict[[100,98]].addLatency(0.45) #throws error right now 
```

所以我想创建一个根据键而变化的默认值，例如：

```
keyDict = Hash.new(TupleProfile.new(theKey[0], theKey[1])) 
```

其中 theKey 是某种特殊指令。是否有任何合理干净的方法可以做到这一点，或者我最好每次检查或为哈希制作一个包装类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:26:08.850

尝试`Hash.new`块符号：

```
keyDict = Hash.new {|hash,key| hash[key] = TupleProfile.new(*key) } 
```

使用标准参数表示法 ( `Hash.new(xyz)`) 实际上只会为哈希实例化一个 TupleProfile 对象；这样每个单独的键都会有一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:59:55.320

如果我理解您的问题，我认为您可以使用[默认程序](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-default_proc)。如果您请求不存在的密钥，默认过程中的代码将运行。这是使用元组键的示例：

```
class Test
  def initialize(a,b); @a = a; @b = b; end
  attr_accessor :a, :b
end

keyDict = {}

keyDict.default_proc = proc do |hash, (key1, key2)|
  hash[[key1, key2]] = Test.new(key1, key2)
end

keyDict[[99,200]]
 => #<Test:0x007f9681ad2720 @a=99, @b=200> 

keyDict[[99,200]].a
 => 99 
```

# javascript - 嵌入式表单在 IE 中不显示值

> ID：13405465
> 
> 赞同：1
> 
> 时间：2012-11-15T20:17:34.363
> 
> 标签：javascript, html, forms, mailchimp

我已经在多个站点上嵌入了这些类型的自定义 mailchimp 表单，并且在所有浏览器中都取得了巨大的成功，但由于某种原因，这种特殊的迭代在 IE 中不起作用。该站点本身是[http://www.buildinggurus.com/](http://www.buildinggurus.com/)，此表单显示在主页和内页的侧边栏上。

在 IE 中发生的是输入字段显示为空白框。输入值不可见，单击输入字段不会执行任何操作（请阅读：您无法输入），并且它看起来更像是一个占位符而不是号召性用语。我在这里想念什么？

```
 <div id="mc_embed_signup">
    <form action="URLHERE" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="widget-lead-form"><h5>Subscribe to Our Blog</h5>
    <div class="mc-field-group">
        <input type="text" value="first name" name="FNAME" class="required-name" id="mce-FNAME" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'first name':this.value;" required />
    </div>
    <div class="mc-field-group">
        <input type="text" value="last name" name="LNAME" class="required-name" id="mce-LNAME" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'last name':this.value;" required />
    </div>
    <div class="mc-field-group">
        <input value="enter your email" name="EMAIL" type="email" class="required-email" id="mce-EMAIL" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'enter your email':this.value;" required />
    </div>
        <div id="mce-responses" class="clear">
            <div class="response" id="mce-error-response" style="display:none"></div>
            <div class="response" id="mce-success-response" style="display:none"></div>
        </div>
    <div class="clear">
        <input type="submit" name="subscribe" class="submit" id="mc-embedded-subscribe" value="submit" /></div>
    </div>
    </form>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:47:14.990

IE 仍然需要设置一个值。我在所有表单输入标签中使用以下内容：

onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?' **默认值**':this.value;" 值="**默认值**"

# c++ - SDL方法,参数转换

> ID：13405470
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:17:57.660
> 
> 标签：c++, methods, sdl

我对这种方法有一个小问题，这是我的代码（我有更多代码，但这是给我错误的部分）

```
void ranCol( SDL_Surface sprite[], SDL_Rect paste)
{

        SDL_FillRect(sprite[y],NULL,temp);
        SDL_BlitSurface(sprite[y],&paste[y],rScreen(),NULL);
} 
```

我收到 2 个错误

```
error C2664: 'SDL_FillRect' : cannot convert parameter 1 from 'SDL_Surface' to 'SDL_Surface *'
error C2664: 'randCol' : cannot convert parameter 2 from 'SDL_Surface *[50000]' to 'SDL_Surface []' 
```

谁能帮我搞定这个工作？

编辑：这是代码以防有人想要编译它

```
 void randCol(int times, SDL_Surface* sprite[], SDL_Rect paste)
{
    int unsigned temp = 10101;//seed
    for(int y = 0;y < times;y++)
    {
        temp = temp*(y+y+1);
        temp = (temp^(0xffffff))>>2;
        //printf("%x\n",temp);
        SDL_FillRect(sprite[y],NULL,temp);
        SDL_BlitSurface(sprite[y],&paste[y],rScreen(),NULL);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:19:39.653

您应该始终操作`pointers`以`SDL_Surface`...将您的功能更改为

```
void ranCol( SDL_Surface* sprite, SDL_Rect paste) 
```

我不知道你`[y]`来自哪里！如果它来自一个数组`SDL_Surface`，将单个`SDL_Surface`作为参数传递给函数，它会更清晰。

如果要传递一个 ARRAY 项，请使用以下签名：

```
void ranCol(SDL_Surface* sprite[], SDL_Rect paste[]) 
```

但是您仍然需要以`y`某种方式传递您的，无论是作为参数还是作为成员/全局。

# orbeon - 可以编写代码以在 Orbeon Form Builder 中使用不同规则为控件放置自动名称

> ID：13405471
> 
> 赞同：0
> 
> 时间：2012-11-15T20:17:57.520
> 
> 标签：orbeon

我们都知道，当我们在 FB 中创建新控件时，它会给出它的名称`control-1`。当我们创建下一个控件时，它会为其命名`control-2`，依此类推。是否可以编写规则来为控件命名？例如：对于网格中的特定列，名称为 A 的列，赋予该列名称中以`A_`后缀开头的所有控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T06:28:02.183

作为表单作者，您可以在将控件添加到表单生成器后更改其名称。但是，如果要更改默认命名方案，则必须更改 Orbeon Forms 中的代码。目前，这是通过`controlName(nextId(doc, "control"))`in完成的[`ToolboxOps.scala`](https://github.com/orbeon/orbeon-forms/blob/master/src/scala/org/orbeon/oxf/fb/ToolboxOps.scala)。

# javascript - 我的 jQuery 滑块控件

> ID：13405472
> 
> 赞同：0
> 
> 时间：2012-11-15T20:17:59.997
> 
> 标签：javascript, jquery, slider

今天我做了一个滑块，它的代码如下：

```
$(document).ready(function() {

    //Tworzenie Kontrolek
    var html = "<ol id=\"controls\">";
    $('#slider ul li').each(function(i) {
        html += "<a href=\"javascript:void(0);\"><li id=\"" + (i+1) + "\">" + (i+1) + "</li></a>";
    });
    html += "</ol>";
    $('#slider').after(html);
    //Koniec tworzenia kontrolek

    //Ustawianie
    var width = $('#slider').width();
    var slides = $('#slider li').length;
    $('#slider ul').css("width", "" + (width*slides) + "");
    //Koniec ustawiania

        //Animowanie Slide'ow
        var cur = 1;
        var kontrolka = -1;
        var slider = setInterval(function() {
            if(cur < slides){   
                $('#slider ul').animate({left: "-" + (cur*width) + "px"},"linear");
                cur+=1;
                kontrolka+=1;
             }
             if(cur == slides){
                $('#slider ul').delay(3000).animate({left: "0px"},"linear");  
                cur=1;
                kontrolka=0;
             }

             //Kontrolki
            $('#controls li').removeClass("active");
            $('#controls li:contains(' + kontrolka + ')').addClass("active");
            //Koniec Kontrolek
        }, 3000);
        //Koniec Animowania Slidow

        //Klikanie Kontrolek
        $('#controls li').click(function() {
            var clicked = $(this).attr('id');
            $('#slider ul').animate({left: "-" + ((clicked-1)*width) + "px"},500,"linear"); 
            clearInterval(slider);
        });

    //Koniec klikania Kontrolek

}); 
```

我有一些问题，因为它控制从 1 到 4 的计数离开 5 到 1 并且在这个 1 上是幻灯片编号 5 的图像，我真的不知道出了什么问题，有人可以帮助我吗？

PS对不起我的英语不好

好的 jsfiddle [http://jsfiddle.net/Sck5w/](http://jsfiddle.net/Sck5w/)看看导航是如何工作的：1 2 3 4 好 5 错过了，又一次 1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:52:38.923

**强文本**您几乎使用 kontrolka 就可以了，但后来您使用 cur 进行控制。

将 cur 初始化为 -1。

所以，无论你在哪里

```
cur=1 
```

应该是

```
cur=-1 
```

它适用于jsfiddle！

然后：而不是

```
$('#slider ul').animate({left: "-" + (cur*width) + "px"},"linear"); 
```

利用

```
$('#slider ul').animate({left: "-" + ((cur+2)*width) + "px"},"linear"); 
```

并且 kontrolka 应该始终是 cur+1。所以你甚至可以省略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:57:01.230

在上一张幻灯片中，将 var curl 设置为 -1。

```
if(cur == slides){
     $('#slider ul').animate({left: "0px"},"linear");  
     cur=-1; ==>>> 
     kontrolka=1;
} 
```

# c - ANSI C - 计算字符串指针的大小

> ID：13405475
> 
> 赞同：1
> 
> 时间：2012-11-15T20:18:15.140
> 
> 标签：c

是否可以使用指针创建字符串变量？这样我就不必每次都传递它的大小，比如 char x[4] = "aaa"？

我怎样才能得到这样的字符串的大小？

我可以用指针初始化一个空字符串吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T20:24:33.820

请记住，C 中的字符串以**空终止**符结尾，写为`\0`. 如果您的指针变量中存储了格式正确的字符串，则可以通过搜索此字符来确定长度：

```
char *x = "hello"; // automatically appends a null terminator
int len = 0;
while (x[len] != '\0') {
    len++;
} 
```

如果您的变量未初始化或格式不正确（例如，通过 be `NULL`），您显然不能采用这种方法；但是，大多数函数通常是在字符串格式良好的假设下编写的*，*因为这会导致代码更快。

如果您希望初始化一个指针，您有三个选项：`NULL`、有效地址（例如，`char *x = &someCharVar`）或字符串常量（例如，`char *x = "hello"`）。请注意，如果您使用字符串常量，则写入该指针是**非法的，除非您使用非常量字符串的地址重新分配给它。**

```
// Get enough space for 24 characters plus null terminator
char *myString = (char*) malloc(25 * sizeof(char));
strcpy(myString, "some text"); // fill the new memory
fgets(myString, 25, stdin); // fill with keyboard input 
```

注意`sizeof(char)`这里是不必要的，因为 a`char`总是被定义为正好 1 个字节。但是，当您使用其他数据类型时，养成这种习惯是一个好习惯，它可以通过使您的意图非常清晰来帮助您的代码自我记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T21:06:57.020

如果您使用字符串文字初始化数组`char`，则无需指定大小：

```
char str[] = "This is a test"; 
```

这将创建`str`一个 15 元素数组`char`（大小取自初始化器的长度，包括 0 终止符）并将字符串文字的内容复制到其中。

字符串文字是类型为“N 元素数组”（在 C++ 中）的*数组表达式。*除非它被用于在声明中初始化一个数组（例如上面）或者是一元运算符或一元运算符的操作数， “array of ”类型的表达式将被转换为“pointer to ”类型的表达式，并且表达式的值将是数组第一个元素的地址。 `char``const char``sizeof``&``T``T`

如果你写

```
const char *str = "This is a test"; 
```

表达式“This is a test”从“15-element array of `char`”类型转换为“pointer to `char`”，表达式的值是第一个字符的地址，写入变量`str`。

试图修改字符串文字内容的行为是*未定义*的；有些平台将字符串文字存储在只读内存中，有些则没有。有些将同一字符串文字的多次出现映射到单个实例，有些则不映射。最好始终将字符串文字视为不可修改，这就是我声明`str`为`const char *`而不是 just的原因`char *`。

要获取字符串的*长度*，请使用`strlen`：

```
char str[] = "This is a test"; // or const char *str = "This is a test";
size_t len = strlen(str);      // or strlen("This is a test"); 
```

这将返回字符串中最多（但不包括）0 终止符的字符数；`strlen("This is a test")`将返回 14。

要获取包含字符串的缓冲区的大小，您可以使用`sizeof`运算符：

```
char str[] = "This is a test";
size_t len = sizeof str;       // or sizeof "This is a test" 
```

请注意，如果您声明为指针，这*不会*给您缓冲区的大小`str`，例如

```
const char *str = "This is a test"; 
```

在这种情况下，`sizeof str;`只给你 a 的大小`char *`，而不是它指向的字符串。

# javascript - 最有可能的正则表达式验证快速修复

> ID：13405478
> 
> 赞同：1
> 
> 时间：2012-11-15T20:18:21.110
> 
> 标签：javascript, regex, forms, validation

我正在尝试验证一个表单以使用户输入他们的全名，如下所示..

> 第一，最后

用户必须有一些纯字母字符的字符串，然后是逗号，然后是空格，然后是姓氏，这又可以是任何字符字符串。

这是我目前的正则表达式..

```
var alphaExp = /^[a-zA-Z,+ a-zA-Z]+$/; 
```

但是，它允许用户提交一些简单的东西，比如 john. 我希望它强迫他们提交诸如约翰、史密斯之类的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:20:19.497

您正在做的是创建一个`[]`匹配以下任何字符的字符类 ( )：`a-zA-Z,+`. 这允许`john`匹配整个正则表达式。

这就是你想要的：

```
/^[a-zA-Z]+, [a-zA-Z]+$/ 
```

但是，我想建议您，对名称进行假设是有点错误的。如果有人叫约翰奥康纳怎么办？还是埃斯特万·佩雷斯？还是只是 Ng（只有名字）？

> “认为某人的名字只能包含某些字符的代码是愚蠢、冒犯和错误的” - [tchrist](https://stackoverflow.com/a/6163129/396458)

当然，您不想让人们只输入胡言乱语，而是为用户留下一个选项，让他们输入不一定符合您对正确性的看法，但仍然是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:20:38.260

这不是字符集的工作方式：

```
/^[a-zA-Z]+, [a-zA-Z]+$/ 
```

需要考虑的事项：

*   您在客户端上进行的任何验证都可以被绕过
*   有些人的名字可能带有重音字母
*   有些文化不只使用两个名字

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:21:11.513

```
^[a-zA-Z]+, [a-zA-Z]+$ 
```

应该工作，但是，你想阻止'.'吗？就像 J. Hooker 一样？还有更多的词，比如“Jan van Hoogstrum”？另请注意，您正在防止使用任何重音字符。一个选项（尽管它允许使用下划线）是使用`\w`：

```
^(\w+ )$ 
```

这会给你'name name name ...'。“第一，最后”不是输入您姓名的常用方式，因此您会以这种方式让很多用户感到沮丧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:22:36.720

仅允许首字母大写的正确正则表达式是：

`/^[A-Z][a-z]+, [A-Z][a-z]+$/`

# c# - 单例过度使用

> ID：13405481
> 
> 赞同：2
> 
> 时间：2012-11-15T20:18:47.330
> 
> 标签：c#, winforms, singleton

我正在考虑在我正在开发的 winforms 应用程序中使用单例模式，但很多人似乎认为单例是邪恶的。我正计划制作一个单例的“主菜单”表单。我想不出有什么理由需要我的主菜单的多个实例，而且它总是出现的第一个表单，所以如果它被不必要地实例化，我不担心浪费资源。

此外，如果主菜单有多个实例，我可能会看到问题。例如，如果另一个表单有一个“主菜单”按钮并且有多个主菜单实例，那么显示哪个实例的决定似乎是模棱两可的。

另外，如果我有另一个必须查看程序状态以确定是否已经存在主菜单实例的 winform，那么我觉得我正在破坏模块化，尽管我可能错了。

在这种情况下我应该避免使用单例还是将主菜单设为静态会更好？

几天前我才开始使用 c#，在过去的几年里我并没有真正用 OOP 做太多事情，所以如果这是一个愚蠢的问题，我深表歉意。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:28:29.240

人们喜欢全局状态。这显然很容易理解，对我们来说很有意义。您不必担心您使用的是哪个版本，因为它们都是相同的。

但是全局状态会引入各种奇怪的错误，因此通常不鼓励。C# 做出了许多设计决策，以使全局状态更难被遗漏。例如，您只允许将静态变量附加到必须管理它们的类。

单例是获得这种全局状态的另一种方式，但是它们的相似之处在于它们可能会导致问题。如果您的一个屏幕设置了主菜单的一部分然后转换到它，而没有意识到后台进程取消了更改，导致显示奇怪的主菜单怎么办？

单例的另一种替代方法是确保变量到达需要它们的位置。这样做的一种方法是跟踪一堆菜单，实际上 Android 在下面就是这样工作的。每个 UI 都有一组位于其上方的父级，如果它想返回，它可以切换到这些父级。通过确保只有您的初始启动过程创建初始主菜单屏幕，您可以保证只创建一个，但是所有屏幕仍然可以通过检查层次结构来访问它。

此外，如果您谈论的是 winform，它们已经内置了一个层次结构系统，您可以使用它来提供此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:30:11.757

`MainMenu`一直显示？如果没有，那么在旧实例关闭时释放它并在每次需要打开它时创建一个新实例是有意义的。这样其他模块就不需要知道它的实例，他们只需在需要打开它时创建一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:28:58.607

你几乎可以滥用一切。

单例是一种确保在任何时候只有一个对象实例处于活动状态，并且您可以同步访问它的方法。使用静态类，您将失去这一点，因为任何人都可以随时访问静态类，因此您需要确保您的方法不会做任何可能受并发影响的事情。

除此之外，如果我没看错的话，你想要一个作为父表单的表单来拥有你的菜单的唯一实例，而所有其他表单都是这个表单的子表单。如果是这种情况，那么您应该检查 Winforms 中的 MDI（多文档界面），因为这将恰好涵盖您的场景。

否则，我要做的只是为我的父表单（带有主菜单的那个）定义一个类，并让一个单例公开访问它，并为所有子表单使用另一个基类。

# java - Android 下使用 Logger 进行日志记录

> ID：13405482
> 
> 赞同：4
> 
> 时间：2012-11-15T20:18:50.753
> 
> 标签：java, android, logging

我注意到以下内容适用于 PC，但不适用于 Android 模拟器。

```
Logger logger = Logger.getLogger("foo");
logger.log(Level.INFO, "Number is: {0}", new Object[]{new Integer(42)}); 
```

它只是打印

```
Number is: {0} 
```

为什么这对android失败？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T07:56:51.630

我以迂回的方式找到了解决方案。最终，我认为在默认的 android 日志实现中某处有一个格式化程序，它只呈现消息，忽略参数。您应该能够使用 Logging API 来安装您自己设计的格式化程序。

出于完全不同的原因，我已经安装了一个新的处理程序。我使用的源代码在这里：http: [//4thline.org/projects/download/misc/](http://4thline.org/projects/download/misc/)

该处理程序位于*teleal-common-1.0.14-source.tar.gz*存档中。按照**src\main\java\org\fourthline\android\util\FixedAndroidHandler.java**的路径。

该站点还提供了安装此处理程序的代码，但它位于不同的存档中：*sash-1.0-SNAPSHOT.tar.gz*。找到**1.0\src\main\java\org\teleal\common\logging\LoggingUtil.java**。

您可以通过在应用程序启动代码中的某处进行此调用来安装此处理程序：

```
LoggingUtil.resetRootHandler(new FixedAndroidHandler()); 
```

我发现这个处理程序的格式化程序作为一个匿名类嵌入到处理程序中。多么方便。我可以看到 Formatter 没有处理通过 LogRecord 传入的参数。我刚刚添加了一个“else-if”条件：

```
private static final Formatter THE_FORMATTER = new Formatter() {
    @Override
    public String format(LogRecord r) {
        String msg = r.getMessage();
        Object[] params = r.getParameters();
        Throwable thrown = r.getThrown();
        if (thrown != null) {
            StringWriter sw = new StringWriter();
            PrintWriter pw = new PrintWriter(sw);
            sw.write(r.getMessage());
            sw.write("\n");
            thrown.printStackTrace(pw);
            pw.flush();
            return sw.toString();
        } else if ((params != null) && (params.length > 0) && (msg.indexOf("{0") >= 0)) {
            return MessageFormat.format(msg, params);
        } else {
            return r.getMessage();
        }
    }
}; 
```

if 测试与我见过的其他日志格式代码一致。从理论上讲，您应该能够采取更直接的方法将类似的格式化程序安装到现有的处理程序中。由于上述解决方案对我有用，我自己没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T01:15:37.577

您可以使用静态方法完成相同的`String`格式化[`String.format(String format, Object... args)`](http://developer.android.com/reference/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29)：

```
Log.d(TAG, String.format("Number is: %d", new Integer(42))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T23:22:16.080

利用：

```
android.util.Log.i(TAG,  "Number is: " + number); 
```

请参阅[http://developer.android.com/reference/android/util/Log.html](http://developer.android.com/reference/android/util/Log.html)

# python - 不理解的 csv 模块分隔符

> ID：13405485
> 
> 赞同：1
> 
> 时间：2012-11-15T20:19:04.357
> 
> 标签：python

嗨，大家好！

我目前正在使用 python csv 模块并尝试使用 '|' 分隔符。据我了解，分隔符是一个分隔表格每一列的值的字符。

我不明白为什么 python 一直放 ';' 在每列的值之间，而不是“|” 在我设置了分隔符之后？这是一个例子

```
# Suppose i have an excel table 'example' saved as a .csv file containing a simple table like this:
# Cat | Mouse | Dog

>>> ifile = open('example.csv', 'r')
>>> reader = csv.reader(ifile, delimiter = '|')
>>> reader.next()
['Cat;Mouse;Dog']  # But shouldn't it be ['Cat|Mouse|Dog'] !? 
```

如您所见，每一列都用分号分隔，但现在不应该使用'|' 当我将分隔符更改为“|”时作为列分隔符？

非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:26:48.013

这是否有效：

```
ifile = open('example.csv', 'r')
reader = csv.reader(ifile, delimiter = ';')
print reader.next() 
```

```
['Cat', 'Mouse', 'Dog'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:26:52.000

当您从文件中读取时，您不会期望在列表中看到分隔符，因为这是用于将行拆分为单独的列表元素的分隔符。这里的问题似乎是 CSV 文件中的分隔符实际上是 ';' 而不是“|”。

# windows - MFC如何在所有窗口上绘制

> ID：13405491
> 
> 赞同：0
> 
> 时间：2012-11-15T20:19:26.903
> 
> 标签：windows, graphics, mfc, gdi

我熟悉 MFC 和 GDI，但我偶然发现了一些我无法真正理解的东西。我可以在所有窗口的顶部画一些东西（实际上，我只需要几个点），并将它们保留在那里，就好像它们“总是在顶部”一样？它是应用程序的插件，因此 MFC 是强制性的。

提前Tnx。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T14:37:19.160

您将无法在屏幕上的任何位置绘制并粘贴。您最好的选择是使用您需要的图形创建一个透明的顶级窗口。我找到[了这个问题](https://stackoverflow.com/questions/438270/how-to-create-a-compeletely-transparent-window-with-mfc)，但我相信你可以找到其他人。

# jquery - 使用来自外部 MVC 应用程序的 jquery 将文档上传到 sharepoint 2010 库

> ID：13405496
> 
> 赞同：1
> 
> 时间：2012-11-15T20:19:45.927
> 
> 标签：jquery, asp.net-mvc, web-services, sharepoint

使用 asp.net MVC 4 应用程序（用 jquery 编码）将文档上传到 SharePoint 2010 库的方法有哪些。

SharePoint 网站作为单独的网站托管，而我的 Web 应用程序托管在不同的网站上。

我可以使用 SharePoint Web 服务，但我想使用 jquery 对整个上传进行编码。

我需要在我的外部 asp.net 应用程序中调用 Web 服务 将带有元数据的文档上传到 SharePoint 站点。使用 Windows 凭据签出/签入现有文档

有没有其他方法/资源可以做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:12:32.373

[来自 codeplex 的SPServices](http://spservices.codeplex.com/)让您可以相对轻松地从 jQuery 调用 SharePoint Web 服务。CopyIntoItems[调用](http://msdn.microsoft.com/en-us/library/copy.copy.copyintoitems.aspx)可用于将 base64 编码文档放入 SharePoint，然后编辑元数据。

# java - Android 显示来自数据库的图像

> ID：13405497
> 
> 赞同：0
> 
> 时间：2012-11-15T20:19:48.157
> 
> 标签：java, android, imageview

嗨，我学会了如何从 SQL 中获取数据并显示到 TextView 上。但是我在显示图像时遇到了一些麻烦。

这些图像作为 URL 存储在 SQL 数据库中，但我无法在视图上显示为图像。

我已经做了一些研究并发现了“如何使用给定的 URL 显示图像”，但我只是在理解抓取 URL 和显示的概念时遇到了一点困难。请帮助我。谢谢！

这是我得到的错误日志。

更新第 159 行：photoMe.setImageDrawable(drawable);

```
11-15 14:53:21.450: W/LoadImageFromWebOperations(28444): java.net.MalformedURLException: Protocol not found: photo
11-15 14:53:21.480: D/AndroidRuntime(28444): Shutting down VM
11-15 14:53:21.480: W/dalvikvm(28444): threadid=1: thread exiting with uncaught exception (group=0x40c55a68)
11-15 14:53:21.500: E/AndroidRuntime(28444): FATAL EXCEPTION: main
11-15 14:53:21.500: E/AndroidRuntime(28444): java.lang.NullPointerException
11-15 14:53:21.500: E/AndroidRuntime(28444):    at com.app.android.DirectoryDetailMeActivity$GetDirectoryDetails$1.run(DirectoryDetailMeActivity.java:159)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at android.os.Handler.handleCallback(Handler.java:605)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at android.os.Handler.dispatchMessage(Handler.java:92)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at android.os.Looper.loop(Looper.java:137)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at android.app.ActivityThread.main(ActivityThread.java:4517)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at java.lang.reflect.Method.invokeNative(Native Method)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at java.lang.reflect.Method.invoke(Method.java:511)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
11-15 14:53:21.500: E/AndroidRuntime(28444):    at dalvik.system.NativeStart.main(Native Method)

public class DirectoryDetailMeActivity extends Activity {

    ImageView photoMe;
    TextView txtName;

    String uid;

    String photo = "";

    private ProgressDialog pDialog;

    JSONParser jsonParser = new JSONParser();

    private static final String url_veiw_directory = "directory_detail_me.php";

    private static final String TAG_ID = "uid";
    private static final String TAG_IMG = "photo";
    private static final String TAG_NAME = "name";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);         
        setContentView(R.layout.directory_detail_me);

        uid = i.getStringExtra(TAG_ID);

        new GetDirectoryDetails().execute();

    }

class GetDirectoryDetails extends AsyncTask<String, String, String> {

    protected String doInBackground(String... params) { 

    runOnUiThread(new Runnable() {
        public void run() {

        int success;
            try {

            List<NameValuePair> params = new ArrayList<NameValuePair>();
            params.add(new BasicNameValuePair("id", uid));

            JSONObject json = jsonParser.makeHttpRequest(url_veiw_directory, "GET", params);

            Log.d("my profile", json.toString());

            success = json.getInt(TAG_SUCCESS);
            if (success == 1) {
            JSONArray directoryObj = json.getJSONArray(TAG_DIRECTORY); 
            JSONObject directory = directoryObj.getJSONObject(0);

            txtName.setText(directory.getString(TAG_NAME));

            Drawable drawable = LoadImageURL(TAG_IMG);
            photoMe.setImageDrawable(drawable);                             

            txtName = (TextView) findViewById(R.id.name);
            photoMe = (ImageView) findViewById(R.id.photo);                         

            }else{

            }
                } catch (JSONException e) {
                    e.printStackTrace();
                }
            }

            private Drawable LoadImageURL(String url)
            {
                try
                {
                    InputStream is = (InputStream) new URL(url).getContent();
                    Drawable d = Drawable.createFromStream(is, "photo");
                    return d;
                }
                    catch (Exception e)
                {
                    Log.w("LoadImageURL",e.toString());
                    return null;
                }
            }
            });

            return null;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:25:40.650

您似乎不了解 AsyncTask。关键是它不在 UI 线程上运行，因此可以像 HTTP 连接那样进行长期 IO。将整个 doInBackground 包装在 runOnUIThread 中与此完全相反。它不是你唯一的问题，但它在列表中。

由于格式化，其余部分难以阅读，但请查看第 159 行。您正在使用的某些变量为空。

# xamarin.ios - Monotouch Dialog在委托中获取元素值

> ID：13405499
> 
> 赞同：1
> 
> 时间：2012-11-15T20:19:49.387
> 
> 标签：xamarin.ios, monotouch.dialog

我有一个从动态对象创建的根元素。当我点击一个元素时，我想获取对象 ID：

```
var section = new Section("","Select a complex and then a property");
var root = new RootElement("Complexes"){section};

foreach(Complex complex in complexes){

    var line = new RootElement(complex.Name);

    foreach(Property property in complex.Properties){

        line.Add(new Section(property.Name,"Select the property to work"){

            new StringElement(property.Description, delegate {

                // NEED HELP HERE!!! here I want to get property.Id

            })
        });
    }
    section.Add(line);
}

this.Root = root; 
```

有什么线索吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T07:41:12.560

在局部变量中复制 property.Id 并在委托中使用

```
var line = new RootElement(complex.Name);

foreach(Property property in complex.Properties){

    var propertyId = property.Id;

    line.Add(new Section(property.Name,"Select the property to work"){

        new StringElement(property.Description, delegate {

            (new UIAlertView("title", "Id - " + propertyId, null, "Ok")).Show();

        })
    });
}
section.Add(line); 
```

# python - 检查大量字符串是否存在的有效方法

> ID：13405501
> 
> 赞同：6
> 
> 时间：2012-11-15T20:19:57.540
> 
> 标签：python, berkeley-db, leveldb, kyotocabinet

我有一组 100+ 百万个字符串，每个最多 63 个字符。我有很多磁盘空间和很少的内存（512 MB）。我需要单独查询存在，并且不存储其他元数据。

我事实上的解决方案是 BDB btree。有没有更好的选择？我知道 leveldb 和京都内阁，但不够熟悉以确定优势。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:47:02.470

如果误报是可以接受的，那么一种可能的解决方案是使用[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)。布隆过滤器类似于哈希表，但它不是使用一个哈希值来索引一个桶表，而是使用多个哈希来索引一个位数组。设置对应于这些索引的位。然后，为了测试一个字符串是否在过滤器中，再次对字符串进行哈希处理，如果设置了相应的索引，则该字符串“在”过滤器中。

它不存储有关字符串的任何信息，因此它使用的内存非常少——但如果两个字符串之间发生冲突，则无法解决冲突。这意味着可能存在误报（因为不在过滤器中的字符串可能会散列到与过滤器中的字符串相同的索引）。但是，不能有假阴性；任何真正在集合中的字符串都将在布隆过滤器中找到。

有[一些](http://code.google.com/p/python-bloom-filter/) [Python](http://code.activestate.com/recipes/577684-bloom-filter/) [实现](https://stackoverflow.com/questions/311202/modern-high-performance-bloom-filter-in-python)。自己动手也不难；我记得曾经使用[`bitarray`](http://pypi.python.org/pypi/bitarray/)s 自己编写了一个快速而肮脏的布隆过滤器，效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:00:41.807

你说你有很多磁盘，对吧？一种选择是将字符串作为文件名存储在嵌套的子目录中。您可以直接使用字符串：

*   将“drew sears”存储在`d/r/e/w/ sears`

或者通过对字符串进行哈希处理并遵循类似的过程：

*   MD5('drew sears') = 'f010fe6e20d12ed895c10b93b2f81c6e'
*   创建一个名为`f0/10/fe/6e/20d12ed895c10b93b2f81c6e`.

将其视为操作系统优化的、基于哈希表的索引 NoSQL 数据库。

附带好处：

*   您可以稍后改变主意并将数据存储在文件中。
*   您可以使用 rsync 将数据库复制到另一个系统。

# ios - 更改 uitextview 超链接颜色

> ID：13405513
> 
> 赞同：32
> 
> 时间：2012-11-15T20:20:52.537
> 
> 标签：ios, uitextview

我正在使用`UITextView`并且我想更改我在此组件中使用的超链接的颜色。例如，如果`UITextView`显示*www.gmail.com*，则显示为蓝色。我想改变那个颜色。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2014-01-09T17:40:08.077

嘘！Apple 已经发布了适用于 iOS7 的解决方案！如[本答案](https://stackoverflow.com/a/19048561/1202222)中所述，您可以使用`linkTextAttributes`a 的属性`UITextView`。带下划线的白色链接看起来像这样：

```
yourTextView.linkTextAttributes = @{
    NSForegroundColorAttributeName: [UIColor whiteColor], 
    NSUnderlineStyleAttributeName: [NSNumber numberWithInt:NSUnderlineStyleSingle]
}; 
```

或者您可以更改`tintColor`, 因为`UITextView`继承`UIView`并使用该`tintColor`属性为链接着色 - 请参阅：

```
yourTextView.tintColor = [UIColor whiteColor]; 
```

现在您的链接看起来很壮观！

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2012-11-15T20:25:51.850

简单的答案是你做不到。

这是一个解决方法：

[我可以更改 UITextView 上自动检测到的链接的颜色吗？](https://stackoverflow.com/questions/1350423/can-i-change-the-color-of-auto-detected-links-on-uitextview/2451285#2451285)

# python - python解包的值太多

> ID：13405515
> 
> 赞同：0
> 
> 时间：2012-11-15T20:20:59.023
> 
> 标签：python, file

我正在尝试读取两个文件并一起迭代它们。基本上我试图逐行比较它。我收到一个错误`Too many values to unpack`

```
f1=open("C:/oc.txt")
f2 = open("C:/p.txt")
for line,line1 in f1,f2: 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:23:35.850

要同步迭代这两个文件，请使用`itertools.izip`：

```
for line1, line2 in itertools.izip(f1, f2):
    # do whatever 
```

如果两个文件的行数不同，您可能想要使用它`itertools.izip_longest`，具体取决于您要执行的操作。

`for line1, line2 in f1, f2`尝试迭代 tuple `(f1, f2)`，而不是同步的两个文件。

# database - 允许按索引从可变数组读取和写入的数据库

> ID：13405517
> 
> 赞同：-3
> 
> 时间：2012-11-15T20:21:08.150
> 
> 标签：database, database-design, nosql, database-engine

我正在寻找一个允许我通过索引存储和检索字符串的数据库。它应该像 mutableArray 一样工作，但在磁盘上。数据库条目有一个固定的长度，条目的数量会随着时间的推移而增长，最多可达 100'000'000。

它的 sql、nosql 或其他东西都没有关系。随机读写应该很快。我看过 levelDB 和 Kyoto，但它们是按键存储的，而不是按数组索引存储的。

非常感谢任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:50:36.293

欢迎来到祖先。您正在寻找的东西是由良好的旧 Berkeley-Database 以高性能、可靠和经过良好测试的方式实现的。[http://en.wikipedia.org/wiki/Berkeley_DB](http://en.wikipedia.org/wiki/Berkeley_DB)。同时它以某种方式在 Oracle 的控制下，但据我所知仍然是开源的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:24:10.197

您可能想查看 SQLite (http://www.sqlite.org/)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:30:59.307

您需要一个支持索引的关系数据库（大多数 RDBM 都支持索引）。
它将生成一个“索引”表，帮助数据库根据您指定的字段最有效地访问您的数据。

由于您添加了 tag `c++`，我假设您想要一个可以与 C++ 程序交互的程序。他们中的许多人都这样做。

在网上搜索“关系数据库 c++（驱动程序或接口）”。

## 编辑 1：部分数据库列表（无顺序）

*   甲骨文
*   MySQL
*   SQLite
*   悖论
*   微软访问
*   福克斯专业版
*   [http://www.opensitesolutions.com/services/databases.php](http://www.opensitesolutions.com/services/databases.php)

# c# - Tor NEWNYM 不使用 C#

> ID：13405521
> 
> 赞同：4
> 
> 时间：2012-11-15T20:21:16.870
> 
> 标签：c#, .net, tor

我已经查看了关于如何以编程方式更改 Tor 的出口节点 IP 的关于 stackoverflow 的所有问题/回复，但均无济于事。每个答案都说您所要做的就是连接到 Tor 控制端口并发出“signal newnym”命令，您将获得一个新的退出 IP。我正在使用[Minimalistic Telnet 库](http://www.codeproject.com/Articles/19071/Quick-tool-A-minimalistic-Telnet-library)来发布以​​下内容：

```
TelnetConnection tc = new TelnetConnection("127.0.0.1", 9051);
tc.WriteLine("AUTHENTICATE \"pwd\"");
tc.WriteLine("SIGNAL NEWNYM");
tc.WriteLine("QUIT"); 
```

我添加了行尾，尝试了不同的 Telnet 库和直接 TCP 连接，但都不起作用。我正在我们的开发服务器上抓取一个显示请求 IP 的页面，当我循环调用此页面时，有时会停下来发出“newnym”命令，IP 地址永远不会改变。有人知道我做错了什么吗？很抱歉提交看似重复的内容，但由于没有一个答案有效，我并不认为这是一个骗局。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-12-20T15:23:36.090

`NEWNYM`不会破坏现有电路，它会将它们标记为脏并构建新的（除其他外）。只需处理现有的 TCP 连接，当您建立新的连接时，您将获得一个新的 IP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-02T07:52:13.880

如果您运行 TOR 继电器，则 NEWNYM 信号无效。它仅适用于浏览互联网的 TOR 客户端。这意味着新的身份，新的电路。

如果 Tor 选择忽略信号（例如 NEWNYM），则不会发送此事件。请注意，某些选项（如 ReloadTorrcOnSIGHUP）可能会影响此处信号的语义。

请注意，HALT (SIGTERM) 和 SHUTDOWN (SIGINT) 信号当前不生成任何事件。

# java - 如何用 XStream 处理不同的孩子？

> ID：13405524
> 
> 赞同：1
> 
> 时间：2012-11-15T20:21:24.763
> 
> 标签：java, xml, xstream

这是场景：

```
<family>
    <person>name</person>
    <person>
        <address> street </adress>
        <address> street </address>
    </person>
</family> 
```

person 值可以是地址列表或只是人名。我认为解决方案是使用转换器，但你是怎么做到的？

1.  检查您检索的输入？
2.  告诉转换器继续使用 3 类的默认值？

示例类：（请注意，这是为了说明）

```
public class Person {

    private String name;

    private List<Address> address;
}

public class Address {
    private String street;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:50:17.863

您确实需要使用转换器。这是您的示例的转换器：

```
public class PersonConverter implements Converter {

    public void marshal(Object value, HierarchicalStreamWriter writer, MarshallingContext context) {
        Person person = (Person) value;
        if(person.name != null){
            writer.setValue(person.name);
        } else if(person.address != null){
            for (Address address : person.address){
                writer.startNode("address");
                writer.setValue(address.street);
                writer.endNode();
            }
        }

    }

    public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {
        Person person = new Person();
        person.name = reader.getValue();
        if(person.name.trim().length()==0){
            person.name = null;
        }
        List<Address> addresses = getAddress(reader, new ArrayList<Address>());
        person.address = addresses;
        if(person.address.size() == 0){
            person.address = null;
        }
        return person;
    }

    private List<Address> getAddress(HierarchicalStreamReader reader, List<Address> addresses){
        if (!reader.hasMoreChildren()){
            return addresses;
        }
        reader.moveDown();
        if(reader.getNodeName().equals("address")){
            addresses.add(new Address(reader.getValue()));
            reader.moveUp();
            getAddress(reader, addresses);
        }
        return addresses;
    }

    public boolean canConvert(Class clazz) {
        return clazz.equals(Person.class);
    }
} 
```

下面是主要方法：

```
public static void main(String[] args) {        
    List<Person> persons = new ArrayList<Person>();
    persons.add(new Person("John"));

    List<Address> adds = new ArrayList<Address>();
    adds.add(new Address("123 street"));
    adds.add(new Address("456 street"));

    persons.add(new Person(adds));

    Family family = new Family(persons);

    XStream stream = new XStream();     
    stream.registerConverter(new PersonConverter());
    stream.processAnnotations(new Class[]{Family.class});

    String xml = stream.toXML(family);
    System.out.println(xml);

    Family testFam = (Family) stream.fromXML(xml);
    System.out.println("family.equals(testFam) => "+family.equals(testFam));

} 
```

`Family`如果您为、`Person`和类实现 equals 方法，`Address`它应该在运行时在方法末尾打印它们相等。另外值得注意的是，我在`Family`. 我`@XStreamAlias("family")`在 Class 本身上使用过，然后在`Person`我使用的对象集合上使用过`@XStreamImplicit(itemFieldName="person")`。

这是我运行提供的主要方法时的输出：

```
<family>
  <person>John</person>
  <person>
    <address>123 street</address>
    <address>456 street</address>
  </person>
</family>
family.equals(testFam) => true 
```

# razor - 升级到 4.10 后宏损坏

> ID：13405527
> 
> 赞同：1
> 
> 时间：2012-11-15T20:21:38.773
> 
> 标签：razor, umbraco

我最近从 4.09 升级到 Umbraco 4.10。我有一个非常常见/简单的小宏，用于生成我的顶部导航。我检查记录以查看它是否是计数中的最后一个，如果不是，则添加管道符号作为可视分隔符。这在 4.09 之前的所有版本中都按预期工作，但在升级所有项目后，即使是最后一个项目也会得到管道符号。

```
@inherits umbraco.MacroEngines.DynamicNodeContext

@{ 
  var level = String.IsNullOrEmpty(Parameter.Level) ? 1 : int.Parse(Parameter.Level); 
  var ulClass = String.IsNullOrEmpty(Parameter.UlClass) ? "" : String.Format(" class=\"{0}\"", Parameter.UlClass); 
  var parent = @Model.AncestorOrSelf(level);
  var pages = parent.Children.Where("Visible");
  if (parent != null) {
    <ul class="topNav">
    @foreach (var item in pages) {
        var selected = Array.IndexOf(Model.Path.Split(','), item.Id.ToString()) >= 0 ? " class=\"selected\"" : "";
        if (item != (pages.Last()))
        {
          <li@Html.Raw(selected)>
            <a href="@item.Url">@item.Name |</a>
          </li>
        }
        else
        {
           <li@Html.Raw(selected)>
            <a href="@item.Url">@item.Name</a>
          </li>
        }
      }
    </ul>
  }
} 
```

我不确定发生了什么变化，但似乎（在我的代码中）pages.Last() 从来都不是真的。
有人有想法么？- 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T05:40:48.440

您应该能够使用`IsNotLast()`帮助程序获得所需的结果，如下所示：

```
<li@Html.Raw(selected)>
    <a href="@item.url">@item.Name@(item.IsNotLast() ? " |" : "")</a>
</li> 
```

有关可用的 IsHelpers 的更多信息，请参阅[Umbraco Razor 功能演练 - 第 7 部分。](http://umbraco.com/follow-us/blog-archive/2011/9/18/umbraco-razor-feature-walkthrough%E2%80%93part-7.aspx)当您需要有关正在遍历的节点的信息时，它们非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:29:19.977

我最终采取了一些不同的做法，但我仍然不知道为什么会发生这种变化。

代替

> if (item != (pages.Last()))

我和

> if (item.Index() != (pages.Count()-1))

目前已解决，但如果其他人偶然发现此问题，我欢迎任何反馈

# macos - 将使用 MonoGame 的游戏移植到 OS X：奇怪的颜色问题

> ID：13405538
> 
> 赞同：4
> 
> 时间：2012-11-15T20:22:26.087
> 
> 标签：macos, mono, xna, monodevelop, monogame

我在 OS X 上使用 MonoGame 在 MonoDevelop 中运行我的游戏项目，但是游戏中的颜色非常混杂。例如，黄色显示为蓝色。这可能是什么原因造成的？我的游戏是从 XNA 移植的。android 和 iOS 端口没有这个颜色问题。

错误的颜色是所有的颜色。应该显示的颜色改为显示为其他一些颜色。例如，黄色显示为蓝色，蓝色显示为橙色等。否则图形显示正确。

我只是将 SpriteBatch 直接用于缓冲区，而不对其运行任何效果或后处理。我的代码`Begin()`是这样的：

```
spriteBatch.Begin(SpriteSortMode.Deferred, BlendState.NonPremultiplied, SamplerState.LinearClamp, DepthStencilState.Default, RasterizerState.CullNone, null, SpriteScale); 
```

当我绘制纹理时，我会像这样绘制它，例如：

```
spriteBatch.Draw(texture, new Vector2(0f, 0f), Color.White); 
```

![屏幕截图](../Images/6dfbb5e1a7855057c5ea1f332aa95aa9.png)

我尝试将所有 .png 文件替换为对应的 .xnb 文件，游戏仍然运行，但我仍然得到相同的错误颜色。

我已经意识到这`BlendState.NonPremultiplied`不应该是正确的，但是当我没有设置它时，我会在不应该存在的图像周围得到这些非常糟糕的轮廓和白块。

# drupal - Drupal Wysiwig TinyMCE 消失行为

> ID：13405540
> 
> 赞同：1
> 
> 时间：2012-11-15T20:22:42.570
> 
> 标签：drupal, drupal-7, tinymce, drupal-modules

在 Drupal 7 上，将 Wysiwig 模块安装到 /opt/drupal/modules/ 并将 TinyMCE 安装到 sites/all/libraries/ 后，我或多或少地让它们工作了。

问题如下：

*   编辑内容 => 查看编辑器；一切都很好
*   切换文本格式完整的 HTML => 过滤的 HTML，反之亦然 => 根本没有编辑器
*   禁用富文本 => 查看编辑器（无栏）应该是
*   启用富文本 => 使用正确的栏查看 TinyMCE 编辑器。

换句话说，切换文本格式时会出现故障，需要关闭和重新打开富文本编辑。没有 javascript 错误或任何其他指示，drupal 知道出了点问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T04:41:05.930

如果 TinyMCE 安装正确，您是否检查了所见即所得的配置页面？您是否使用自定义主题？检查您是否有一些导致隐藏 TinyMCE 提供的某些元素的 css 规则。

# android - 两个具有不同图像大小但希望保持相同纵横比和大小的 ImageViews

> ID：13405544
> 
> 赞同：0
> 
> 时间：2012-11-15T20:22:50.637
> 
> 标签：android, android-layout, android-activity, android-imageview, android-image

这一直困扰着我一段时间，我不知道如何解决它。

假设我有以下布局：2 个 ImageView，每个 ImageView 下都有一个 TextView。正在远程检索图像。我希望每个 ImageView 占据它们所在的 Activity 宽度的大约 40%，并在它们下方留有空白。TextViews 将小约 5%，在每个 ImageView 下方居中。

我尝试了什么：

将每对 ImageView 和 TextView 放在各自的 LinearLayout 中，即 2 个 LinearLayouts，每个 LinearLayout 的 layout_width 设置为 fill_parent 并且两者的 layout_weight (0.5) 相等。每个 ImageView 的 layout_width 为 fill_parent，layout_margin 为 15dip。layout_height 设置为 wrap_content （这是我不确定如何设置的参数）。

这很好，但问题是所有传入的图像都有不同的大小和比例，所以它们并排看起来很奇怪。

我继续设置： android:scaleType="centerCrop" android:adjustViewBounds="true"

这有所帮助，但有时每个 ImageView 的大小仍然不同。在这一点上，我只是将每个 ImageView 放在两个 ImageView 的固定宽度 100 度左右，这很有帮助，但当然对于更大尺寸的设备，这看起来很奇怪。我怎样才能实现我想要实现的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T22:00:28.657

在第二个选项中，尝试不使用“AdjustViewBounds”记住：

> 如果您希望 ImageView 调整其边界以保持其可绘制对象的纵横比，请将其设置为 true。

但这是我在你的情况下会做的：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="0.5"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:scaleType="center"
        android:src="@drawable/99" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal|bottom"
        android:text="TextView" />
</LinearLayout>

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="0.5"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:scaleType="center"
        android:src="@drawable/ic_launcher" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:text="TextView" />
</LinearLayout> 
```

它会在更大的屏幕上看起来像：

![测试1](../Images/f78e77e2f66e865d01c9b3622deb50c4.png)

在较小的屏幕上：

![测试2](../Images/570f663ff14633c741ce9274cfed0a79.png)

在这种情况下，我更喜欢居中，因为如果您有较小的图片，那么它们会更好看。如果可以的话，我会尽量避免使用固定尺寸，因为正如你所说，它在较大的设备上看起来不太好。

您还可以为每个屏幕尺寸制作不同的布局。但是您必须保留所有这些。检查[支持多种屏幕尺寸](http://developer.android.com/intl/es/guide/practices/screens_support.html)（如果您还没有；））。

# .net - 如何为多个控件使用相同的事件？

> ID：13405547
> 
> 赞同：0
> 
> 时间：2012-11-15T20:22:59.317
> 
> 标签：.net, vb.net, events

我在面板中有很多复选框，我想问是否存在任何方式来重现所有复选框中的事件操作，而无需为 20 个复选框编写相同的内容：

```
 Private Sub C1CheckBox1_CheckedChanged(sender As Object, e As EventArgs) Handles C1CheckBox1.CheckedChanged
        C1CheckBox1.Text = "test"
    End Sub 
```

**编辑**：

我不是说如何更改事件`text`中所有复选框的属性`C1CheckBox1`，我的意思是如何为所有复选框克隆该事件，如果单击所有复选框中的一个，然后为所有复选框复制相同的事件，这有点区别（我认为）

**更新**：

伪代码：

```
sub event that affect to all my checkboxes in the panel
    If ANY checkbox_CheckedChange then
       ALL_the_other_Checkboxes.Checked = False
    end if
end sub 
```

我试图谈论的区别是我问这是否可能只写一个事件或类似的东西，而不是在其他 20 个复选框事件中写相同的属性更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:49:50.397

您可以通过执行逗号分隔的控件列表及其事件来处理相同的事件。

例如：

```
Private Sub C1_CheckedChanged(sender As Object, e As EventArgs) 
    Handles C1CheckBox1.CheckedChanged, C1CheckBox2.CheckedChanged, ... C1CheckBox50.CheckedChanged
        ...
        Do Action
        ....
    End Sub 
```

# cloud-foundry - 如何安装 vmc 的 beta 版本？

> ID：13405551
> 
> 赞同：1
> 
> 时间：2012-11-15T20:23:05.010
> 
> 标签：cloud-foundry, vmc

我正在尝试安装 vmc 的 0.4.0.beta 版本，但安装后我仍然有旧版本。

```
> gem install vmc --pre
[...]
Installing RDoc documentation for vmc-0.4.0.beta.90...
>  ~  $ vmc --version
vmc 0.3.23 
```

我究竟做错了什么？我对 Ruby 没有任何经验，我正在安装这个工具来管理我的 cloudfoundry 应用程序。（我正在使用 MacOS X）

更新：我按照此处的步骤安装 ruby​​/rvm 和 gem [https://stackoverflow.com/a/11573805/156300](https://stackoverflow.com/a/11573805/156300)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:57:03.303

为了运行测试版，我必须创建以下文件

```
mkdir ~/.vmc
touch ~/.vmc/use-ng 
```

我通过挖掘源文件发现了这一点。

# python - 显示使用烧瓶应用程序访问的最后一页列表

> ID：13405558
> 
> 赞同：0
> 
> 时间：2012-11-15T20:23:21.500
> 
> 标签：python, html, heroku, flask

我发现了这个问题（[如何显示“访问的最新页面”列表](https://stackoverflow.com/questions/10813342/how-to-display-a-list-of-latest-pages-visited)）关于如何显示为 ruby​​ on rails 访问的最新页面列表。你会如何用烧瓶做到这一点？你使用网址映射吗？代码看起来像这样，我也在使用 Heroku。

```
app = Flask(__name__)

app.secret_key = 'supersecretkey'

def login():
    session['username'] = "someuser"
    session['urls'] = []

@app.after_request
def store_visted_urls():
    session['urls'].append(request.url)
    if(len[session['urls']) > 5:
        session['urls'].pop(0)
    session.modified = True

@app.route('/')
def index():
    data = []
    if 'urls' in session:
        data = session['urls']
    return  render_template('page1.html',data=data)

@app.route('/page2', endpoint='page2')
def index():
    return  render_template('page2.html')

@app.route('/page3', endpoint='page3')
def index():
    return  render_template('page3.html')

if __name__ == '__main__':
    # Bind to PORT if defined, otherwise default to 5000.
    port = int(os.environ.get('PORT', 5000))
    app.run(host='0.0.0.0', port=port) 
```

我希望在每个页面（page1、page2、page3）上都有一个部分，显示最后访问的页面。

另外，关于这个问题（[显示任何访问者最近访问的 html 页面](https://stackoverflow.com/questions/8352206/show-recently-visited-html-pages-by-any-visitor)）有人建议使用 cookie。这是更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:40:15.107

如果要存储用户的页面访问/URL 历史记录，可以使用会话。每次请求后，将访问的 URL 存储在会话中。就像是：

# 必须将密钥设置为使用会话

```
app.secret_key = 'some secret key' 
```

# 登录函数，您可以在其中初始化会话变量。

```
def login():
    session['username'] = "someuser"
    session['urls'] = [] 
```

# 下面的函数使用 after_request 装饰器在每次用户请求后存储访问过的 url。

```
@app.after_request
def store_visted_urls():
    session['urls'].append(request.url)
    if(len[session['urls']) > 5:
        session['urls'].pop(0)
    session.modified = True 
```

# 查看功能以显示最后访问的页面

```
@app.route('/')
def index():

data = []
if 'urls' in session:
data = session['urls']
return  render_template('page1.html',data=data) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-09T13:51:37.123

尝试这个：

```
url = request.url
if 'urls' in session:
    urls_list = session['urls']
    if not url in urls_list:
        urls_list.append(url)
        if len(urls_list) > 5:
            urls_list.pop(0)
            session['urls'] = urls_list
else:
     session['urls'] = [url] 
```

# scheme - Scheme中如何同时统计和删除列表中的元素

> ID：13405559
> 
> 赞同：2
> 
> 时间：2012-11-15T20:23:22.460
> 
> 标签：scheme

我有两个过程，一个用于计算列表中的元素，另一个用于从同一列表中删除相同的元素。同时计数和删除应该怎么做？我尝试了很长时间，但没有任何效果。我使用这个列表：(list 1 2 3 2 1 2 3)，最后它应该是这样的：((1 . 2) (2 . 3) (3 . 2))。第一个对数是一个元素，第二个对数是所有列表中第一对数的总和。我的尝试：1) 它只适用于计数，结果是： ((1 . 2) (2 . 3) (3 . 2) (2 . 2) (1 . 1) (2 . 1) (3 . 1) ) 2) 它仅适用于删除，结果是： ((1 . 2) 2 3 2 2 3)

哪里有问题？

这是为了计数：

```
(define count-occurrences
  (lambda (x ls)
    (cond
      [(memq x ls) =>
       (lambda (ls)
         (+ (count-occurrences x (cdr ls)) 1))]
      [else 0]))) 
```

（出现次数 '2（列表 1 2 3 2 1 2 3））-> 3

这是为了删除：

```
(define (remove-el p s)
  (cond ((null? s) '())
        ((equal? p (car s)) (remove-el p (cdr s)))
        (else (cons (car s) (remove-el p (cdr s)))))) 
```

(删除-el '2 (list 1 2 3 2 1 2 3)) -> (1 3 1 3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:16:51.140

只需一次返回计数和删除的列表。我将此例程称为计数删除。（请原谅所有不惯用或高效风格的策划者）

```
(define (count-remove ls x)
  (letrec ([loop (lambda (count l removed)
                   (cond
                     [(eq? l '()) (list count removed)]
                     [(eq? (car l) x) (loop (+ 1 count) (cdr l) removed)]
                     [else (loop count (cdr l) (cons (car l) removed))]))])
    (loop 0 ls '())))

(define (count-map ls)
  (cond
    [(eq? ls '()) '()]
    [else
       (letrec ([elem (car ls)]
                [cr (count-remove ls elem)])
         (cons (cons elem (car cr)) (count-map (cadr cr))))])) 
```

下面是一些用法：

`(count-map '(1 1 2 3 2))
((1 . 2) (2 . 2) (3 . 1))`

# javascript - 在通过 jQuery 的 load() 加载部分页面时显示加载动画

> ID：13405560
> 
> 赞同：3
> 
> 时间：2012-11-15T20:23:27.490
> 
> 标签：javascript, jquery, load

在我的网站上，我想通过 jQuery 的`load()`函数动态加载“页面”，并且我想添加一个加载动画。

```
function loadPage(){
  $("#content").load("example.html");
} 
```

`<div id="loading"></div>`当jQuery 加载该内容时，我会在哪里显示代码？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:25:31.690

使用 的回调函数`.load()`在加载完成时隐藏加载 div。

```
function loadPage(){
    $('#loading').show();

    $("#content").load("example.html", function () { //calback function
         $('#loading').hide();
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:27:36.980

你可以尝试这样的事情：

```
$(document).ready(function() {
    $(this).ajaxSend(function() {
        $(this).append('<div id="loading"></div>');
    }).ajaxStop(function() {
        $('#loading').remove();
    });
}); 
```

这将适用于你所有的 ajax 调用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:29:39.420

我不确切知道您想做什么，但可能您想将内容加载到`div`. 您应该创建一个 CSS 类：

```
.loading {
  background: url(loading.gif) center center;
} 
```

`addClass()`并在您开始加载时将此类添加到您的 div（清除它之后） ，并`removeClass`在`.load`回调中将其删除。

# php - 用 sql 更新多行

> ID：13405561
> 
> 赞同：0
> 
> 时间：2012-11-15T20:23:34.660
> 
> 标签：php, sql, insert

通过一个查询，我得到了两个 php 函数。他们都应该在数据库表中插入一些值。所以第一个

`mysql_query("INSERT INTO images (thumb) VALUES ('$path')");`

循环做薄。但是后来我需要在其他列中添加一些值，但问题是所有 thouse 值都存储在数组中。功能的样子。

```
 function uploading_paths($names_array){
    $data = '(\'' . implode('\'),(\'', $names_array) . '\')';
    mysql_query("INSERT INTO `images` (`image_path`) VALUES $data");

} 
```

那么如何`thumb`通过一个查询将 $data 数组中的值添加到已填充列的行中？可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:32:04.997

尝试为此使用 PHP PDO。它使您可以准备一个语句，然后根据需要多次执行它。例子：

```
$mysql_host = "127.0.0.1";
$mysql_user = "root";
$mysql_password = "";
$mysql_database = "myShop";
$dbLink = new PDO("mysql:host=$mysql_host;dbname=$mysql_database;charset=utf8", $mysql_user, $mysql_password, array(PDO::ATTR_PERSISTENT => true));
$dbLink->setAttribute(PDO::ATTR_EMULATE_PREPARES, true);
$query = $dbLink->prepare("insert into `images` (`thumb`, `path`) values (?, ?);");
foreach ($names_array as $thumb => $path)
{  
    $query->execute(array($thumb, $path)); // note the order as they should appear
} 
```

最终，您可以通过以下方式替换最后一条路径：

```
$query = $dbLink->prepare("insert into `images` (`thumb`, `path`) values (:thumb, :path);");
foreach ($names_array as $thumb => $path)
{  
    $query->execute(array(":path" => $path, ":thumb" => $thumb)); // no order restriction
} 
```

...并且您不必按照您拥有字段的顺序提供执行数组。

问候 ！

# android - 尝试请求广告时出现 Flurry 错误（已禁用数据库访问）

> ID：13405563
> 
> 赞同：0
> 
> 时间：2012-11-15T20:23:47.580
> 
> 标签：android, flurry

在我第一次在 Android 上快速集成时遇到了困难。这是我用来连接文档状态的代码：

```
FlurryAgent.setLogEnabled(true); 
FlurryAgent.setLogLevel(Log.VERBOSE);
FlurryAgent.onStartSession(this,"GJTCVGM4XG7PSHSZZTDM");
FlurryAgent.initializeAds(this);
FlurryAgent.enableTestAds(true);

// The following method call will asynchronously
// render a banner in the provided ViewGroup:
FrameLayout fViewGroup= (FrameLayout)findViewById(R.id.bannerframe) ;
FlurryAgent.getAd(this, "Bottom Banner", fViewGroup,
                                FlurryAdSize.BANNER_BOTTOM, 0); 
```

这将产生以下日志：

```
11-15 21:14:22.380: D/FlurryAgent(2473): Initializing Flurry session
11-15 21:14:22.380: D/FlurryAgent(2473): New session
11-15 21:14:22.390: D/FlurryAgent(2473): Initializing Flurry Ads
11-15 21:14:22.390: D/FlurryAgent(2473): Flurry Ads initialized
11-15 21:14:22.400: I/FlurryAgent(2473): Init'ing ads.
11-15 21:14:22.400: W/FlurryAgent(2473): Cannot identify UDID.
11-15 21:14:22.400: W/Settings(2473): Setting android_id has moved from     android.provider.Settings.System to android.provider.Settings.Secure, returning read-only value.
11-15 21:14:22.400: I/FlurryAgent(2473): loading persistent data: /data/data   /com.fosfore.flurryintegration/files/.flurryagent.45cf4771
11-15 21:14:22.400: D/FlurryAgent(2473): Loading API key: ****************ZTDM
11-15 21:14:22.400: D/FlurryAgent(2473): Loading session reports
11-15 21:14:22.400: D/FlurryAgent(2473): Persistent file loaded
11-15 21:14:22.400: D/FlurryAgent(2473): generating report
11-15 21:14:22.400: D/FlurryAgent(2473): Sending report to: http://data.flurry.com/aap.do
11-15 21:14:22.910: D/FlurryAgent(2473): Report successful
11-15 21:14:22.960: I/FlurryAgent(2473): Request successful
11-15 21:14:22.980: E/FlurryAgent(2473): Ad request returned errors: 
11-15 21:14:22.980: E/FlurryAgent(2473): Internal Error: java.lang.RuntimeException: Database access disabled
11-15 21:14:24.440: I/FlurryAgent(2473): Request successful
11-15 21:14:24.440: W/FlurryAgent(2473): Ad request successful but server delivered no ad units. 
```

有人能猜到发生了什么吗？我有一个名称正确的广告空间设置。

PD 使用 FlurryAgent.isAdAvailable 它总是说没有任何广告可用。我的广告空间处于活动状态，我还需要做些什么才能开始接收广告吗？我目前没有使用任何中介。

提前致谢。

# c# - LINQ，无法创建 XXX 类型的常量值。此上下文仅支持原始类型或枚举类型

> ID：13405568
> 
> 赞同：64
> 
> 时间：2012-11-15T20:24:10.867
> 
> 标签：c#, entity-framework, linq

在我的应用程序中，我有讲师，他们有他们可以教授的课程列表，当我删除课程时，我想删除与讲师的连接。这是代码：

```
public void RemoveCourse(int courseId)
{
    using (var db = new AcademicTimetableDbContext())
    {
        var courseFromDb = db.Courses.Find(courseId);

        var toRemove = db.Lecturers
                        .Where(l => l.Courses.Contains(courseFromDb)).ToList();

        foreach (var lecturer in toRemove)
        {
            lecturer.Courses.Remove(courseFromDb);
        }

        db.SaveChanges();
    }
} 
```

但它不起作用。我明白了

> NotSupportedException：无法创建类型的常量值`Course`。此上下文仅支持原始类型或枚举类型。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-11-15T20:46:16.420

您不能`Contains`与非原始值一起使用。做

```
Where(l => l.Courses.Select(c => c.CourseId).Contains(courseId) 
```

（或您使用的 Id 字段）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-04T16:52:08.157

如果您使用的是 DbContext，则可以查询 .Local 集合，并且 == 运算符也适用于对象：

```
public void RemoveCourse(int courseId)
{
    using (var db = new AcademicTimetableDbContext())
    {
        var courseFromDb = db.Courses.Find(courseId);

        db.Lecturers.Load() //this is optional, it may take some time in the first load

        //Add .Local to this line
        var toRemove = db.Lecturers.Local 
                        .Where(l => l.Courses.Contains(courseFromDb)).ToList();

        foreach (var lecturer in toRemove)
        {
            lecturer.Courses.Remove(courseFromDb);
        }

        db.SaveChanges();
    }
} 
```

.Local 是一个 ObservableCollection，因此您可以在其中比较您喜欢的任何内容（不限于不支持对象比较的 SQL 查询）。为了确保在 .Local 集合中获得所有对象，您可以在调用 .Local 之前调用 db.Lecturers.Load() 方法，这会将所有数据库条目带入 Local 集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-03T06:11:28.477

以下行的`Courses`集合应为空或为空。

```
 var toRemove = db.Lecturers
                        .Where(l => l.Courses.Contains(courseFromDb)).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-24T18:39:38.007

当您将 a 传递`Func<T, bool>`给 Where() 作为一种编写动态条件的方式时，也会发生这种情况，例如此处[。](https://stackoverflow.com/questions/3784005/can-i-use-custom-delegate-method-in-where-method-of-entity-framework) 由于某种原因，委托无法转换为 SQL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-30T07:14:56.600

如果您没有指定相等的含义，则无法比较复杂类型。

正如异常细节所说，您需要检查原始值（例如您的情况下的整数）。

最好改用`Any()`方法。

```
var toRemove = db.Lecturers
     .Where(l => l.Courses.Any(p=>p.Id == courseFromDb.Id)).ToList(); 
```

# vba - 如何通过从 MS Word VBA 用户窗体运行的 VBA（宏）在脱机工作模式下设置 Outlook

> ID：13405569
> 
> 赞同：0
> 
> 时间：2012-11-15T20:24:13.190
> 
> 标签：vba, outlook, ms-word

我正在尝试运行一个 VBA 代码，它应该让用户将文件附加到邮件合并函数中。

为此，我需要在将任何文件附加到邮件之前将 Outlook 置于脱机模式以将邮件保留在发件箱中。现在我想知道是否有一种方法可以通过 Word 宏将 Outlook 2007 置于脱机模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:44:21.280

首先，添加对 Outlook 对象库的引用。如果 Outlook 已经打开：

`Outlook.ActiveExplorer().CommandBars.FindControl(, 5613).Execute`

如果 Outlook 关闭：

```
Dim olApp As Outlook.Application
Set olApp = CreateObject("Outlook.Application")
olApp.GetNamespace("MAPI").Folders.GetFirst.GetExplorer.CommandBars.FindControl(, 5613).Execute 
```

# sql - 获取列类型的 SQL 语句

> ID：13405572
> 
> 赞同：387
> 
> 时间：2012-11-15T20:24:27.923
> 
> 标签：sql, schema

是否有可以返回表中列类型的 SQL 语句？

* * *

## 回答 #1

> 赞同：583
> 
> 时间：2012-11-15T20:31:00.257

使用 SQL Server：

```
SELECT DATA_TYPE 
FROM INFORMATION_SCHEMA.COLUMNS
WHERE 
     TABLE_SCHEMA = 'yourSchemaName' AND
     TABLE_NAME   = 'yourTableName' AND 
     COLUMN_NAME  = 'yourColumnName' 
```

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2012-11-15T20:31:05.863

TSQL 中最简单的方法是：

```
SELECT COLUMN_NAME, DATA_TYPE 
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_NAME = 'yourTableName' 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2015-09-09T08:44:07.943

对于 SQL Server，此系统存储过程将返回所有表信息，包括列数据类型：

```
exec sp_help YOURTABLENAME 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-11-15T20:27:13.137

在 TSQL/MSSQL 中，它看起来像：

```
SELECT t.name, c.name 
FROM sys.tables t 
JOIN sys.columns c ON t.object_id = c.object_id
JOIN sys.types y ON y.user_type_id = c.user_type_id
WHERE t.name = '' 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-11-15T20:28:03.493

如果您使用的是 MySQL，您可以尝试

```
SHOW COLUMNS FROM `tbl_name`; 
```

[在 dev.mysql.com 上显示列](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html)

否则你应该可以做

```
DESCRIBE `tbl_name`; 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-09-08T12:36:40.267

在 oracle SQL 中，您可以这样做：

```
SELECT
    DATA_TYPE
FROM
    all_tab_columns 
WHERE
    table_name = 'TABLE NAME' -- in uppercase
AND column_name = 'COLUMN NAME' -- in uppercase 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2019-11-22T13:22:49.103

为了建立上面的答案，以您需要声明列的相同格式获取列数据类型通常很有用。

例如，`varchar(50)`，`varchar(max)`，`decimal(p, s)`。

这允许您这样做：

```
SELECT 
  [Name]         = c.[name]
, [Type]         = 
    CASE 
      WHEN tp.[name] IN ('varchar', 'char') THEN tp.[name] + '(' + IIF(c.max_length = -1, 'max', CAST(c.max_length AS VARCHAR(25))) + ')' 
      WHEN tp.[name] IN ('nvarchar','nchar') THEN tp.[name] + '(' + IIF(c.max_length = -1, 'max', CAST(c.max_length / 2 AS VARCHAR(25)))+ ')'      
      WHEN tp.[name] IN ('decimal', 'numeric') THEN tp.[name] + '(' + CAST(c.[precision] AS VARCHAR(25)) + ', ' + CAST(c.[scale] AS VARCHAR(25)) + ')'
      WHEN tp.[name] IN ('datetime2') THEN tp.[name] + '(' + CAST(c.[scale] AS VARCHAR(25)) + ')'
      ELSE tp.[name]
    END
, [RawType]      = tp.[name]
, [MaxLength]    = c.max_length
, [Precision]    = c.[precision]
, [Scale]        = c.scale
FROM sys.tables t 
JOIN sys.schemas s ON t.schema_id = s.schema_id
JOIN sys.columns c ON t.object_id = c.object_id
JOIN sys.types tp ON c.user_type_id = tp.user_type_id
WHERE s.[name] = 'dbo' AND t.[name] = 'MyTable' 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2016-10-18T13:06:23.137

使用 MS SQL 的另一个变体：

```
SELECT TYPE_NAME(system_type_id) 
FROM sys.columns 
WHERE name = 'column_name'
AND [object_id] = OBJECT_ID('[dbo].[table_name]'); 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-12-31T20:16:28.910

使用 TSQL/MSSQL

此查询将为您提供：表名、列名、数据类型、数据类型长度和允许的空值

```
SELECT TABLE_NAME,COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, IS_NULLABLE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'your_table_name' 
```

唯一需要更改的是 your_table_name。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2021-02-22T14:30:20.773

这也适用，因为它只选择列名及其各自的字符类型

```
SELECT COLUMN_NAME ,DATA_TYPE 
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_NAME = 'Items'; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-12-13T14:50:30.463

要检索实际声明的数据类型，例如用于动态 SQL 到 ALTER COLUMN，可以使用以下内容：

```
SELECT
    TABLE_NAME, 
    COLUMN_NAME,
    DATA_TYPE
        + CASE WHEN DATA_TYPE IN ('char','nchar','varchar','nvarchar','binary','varbinary')
                    AND CHARACTER_MAXIMUM_LENGTH > 0 THEN
                 COALESCE('('+CONVERT(varchar,CHARACTER_MAXIMUM_LENGTH)+')','')
            ELSE '' END
        + CASE WHEN DATA_TYPE IN ('decimal','numeric') THEN
                COALESCE('('+CONVERT(varchar,NUMERIC_PRECISION)+','+CONVERT(varchar,NUMERIC_SCALE)+')','')
            ELSE '' END
        AS Declaration_Type,
    CASE WHEN IS_NULLABLE='NO' THEN 'NOT ' ELSE '' END + 'NULL' AS Nullable
FROM INFORMATION_SCHEMA.COLUMNS
ORDER BY 1,2 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-02-14T07:13:17.880

对于**IBM DB2**：

```
SELECT TYPENAME FROM SYSCAT.COLUMNS WHERE TABSCHEMA='your_schema_name' AND TABNAME='your_table_name' AND COLNAME='your_column_name' 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2012-11-15T20:30:13.520

```
USE [YourDatabaseName]
GO

SELECT column_name 'Column Name',
data_type 'Data Type'
FROM information_schema.columns
WHERE table_name = 'YourTableName'
GO 
```

这将返回值 Column Name，向您显示列的名称以及这些列的数据类型（ints、varchars 等）。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-05-04T08:00:34.910

使用 TSQL/MSSQL

您可以使用`INTO`关键字。

结果`SELECT`变成了一个真实的TABLE

例子：`select .... INTO real_table_name`

后

```
sp_help real_table_name 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-03-26T12:30:59.317

从 SQL Server 2012 开始：

```
SELECT * FROM sys.dm_exec_describe_first_result_set( N'SELECT * FROM [my].[Table]', NULL, 0 ); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-07-29T11:58:22.190

使用这个查询

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'TABLE_NAME'
ORDER BY ORDINAL_POSITION 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-10-10T12:40:10.057

MS SQL 的另一个选项是将`select`此处的查询替换为您想要其类型的查询：

```
declare @sql varchar(4000);

set @sql = 'select ''hi'' as greeting';

select * from master.sys.dm_exec_describe_first_result_set (@sql, Null, 0); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-07-29T17:23:42.393

就我而言，我需要获取动态 SQL 的数据类型（颤抖！）无论如何，这是我创建的一个函数，它返回完整的数据类型。例如，它不会返回“十进制”，而是返回 DECIMAL(18,4)：[dbo.GetLiteralDataType](https://stackoverflow.com/a/31706936/1819403)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-05-10T17:26:58.967

使用此查询获取 Schema、Table、Column、Type、max_length、is_nullable

```
SELECT QUOTENAME(SCHEMA_NAME(tb.[schema_id])) AS 'Schema'
    ,QUOTENAME(OBJECT_NAME(tb.[OBJECT_ID])) AS 'Table'
    ,C.NAME as 'Column'
    ,T.name AS 'Type'
    ,C.max_length
    ,C.is_nullable
FROM SYS.COLUMNS C INNER JOIN SYS.TABLES tb ON tb.[object_id] = C.[object_id]
    INNER JOIN SYS.TYPES T ON C.system_type_id = T.user_type_id
WHERE tb.[is_ms_shipped] = 0
ORDER BY tb.[Name] 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-08-29T09:15:46.633

```
SHOW COLUMNS FROM //table_name// ; 
```

它将为您提供有关表中所有列的信息。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-02-23T18:15:53.037

对于[Spark SQL](https://docs.databricks.com/spark/latest/spark-sql/language-manual/describe-table.html)：

```
DESCRIBE [db_name.]table_name column_name 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-01-18T17:09:16.767

由于有些人同时要求数据类型的精度，我想分享我为此目的创建的脚本。

```
SELECT TABLE_NAME As 'TableName'
       COLUMN_NAME As 'ColumnName'
       CONCAT(DATA_TYPE, '(', COALESCE(CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, DATETIME_PRECISION, ''), IIF(NUMERIC_SCALE <> 0, CONCAT(', ', NUMERIC_SCALE), ''), ')', IIF(IS_NULLABLE = 'YES', ', null', ', not null')) As 'ColumnType'
FROM INFORMATION_SCHEMA.COLUMNS
WHERE -- ...
ORDER BY 'TableName', 'ColumnName' 
```

它并不完美，但在大多数情况下都有效。

使用`Sql-Server`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-10-16T16:11:34.477

在 vb60 中，您可以这样做：

```
Public Cn As ADODB.Connection
'open connection
Dim Rs As ADODB.Recordset
 Set Rs = Cn.OpenSchema(adSchemaColumns, Array(Empty, Empty, UCase("Table"), UCase("field"))) 
```

'和样本（valRs 是我的函数 rs.fields("CHARACTER_MAXIMUM_LENGTH").value）：

```
 RT_Charactar_Maximum_Length = (ValRS(Rs, "CHARACTER_MAXIMUM_LENGTH"))
        rt_Tipo = (ValRS(Rs, "DATA_TYPE")) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-04-06T20:19:34.783

只要有人觉得这很有用。在 SQL Server 中：

```
 sp_columns 'yourtablename' 
```

这将提供所有列的详细信息。它为您提供 column_name、data_type、type_name、precision、length、iss_nullable 等。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-10-21T10:12:40.653

我发现这对查询很有用，特别是如果它们使用聚合或多个表（SQL Server）

```
DECLARE @query nvarchar(max) = 'select * from yourtable';
EXEC sp_describe_first_result_set @query, null, 0; 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-06-08T15:07:46.513

对于[Apache Derby ，](https://db.apache.org/derby/)[如此答案](https://stackoverflow.com/a/41774881)所示：

```
select columndatatype from sys.syscolumns
  where referenceid = (
    select tableid from sys.systables
    where tablename = 'YOUR_TABEL_NAME'
    and columnname= 'YOUR_COLUMN_NAME') 
```

# express - expressjs 没有通过中间件传递 req.params

> ID：13405574
> 
> 赞同：1
> 
> 时间：2012-11-15T20:24:30.123
> 
> 标签：express, middleware

与[此类似](https://stackoverflow.com/questions/10523644/why-does-req-params-return-an-empty-array)

我有以下路线：
`app.get('/blogpost/:link', middleware.loginCheck, blog.postBlogs);`

使用`req.params.link`返回链接参数。
当我要求`req.params.link`in 时，`middleware.loginCheck`我收到一个`undefined`.

似乎`req.params.link`没有传递给中间件，因为我可以像这样访问它：
`app.get('/blogpost/:link', function(req, res){console.log(req.params.link)});`

我的中间件有什么问题？

**最终**
`a(href='/post/#{post.link}') #{comments}`渲染`/post/myPostLink`

`{#post.link}`仅呈现变量替换并且不添加额外的`/`
`a(href='/post#{post.link}') #{comments}`呈现 '/postmyPostLink'

`a(href='/post/' + post.link) #{comments}`渲染`/post/myPostLink`

所以两者`#{post.link}`或`post.link`工作相同并且`req.params.link`适用于两个电话。

**UPDATE_2**
我`jade`用来呈现网页。在里面我有一个这样写的锚标签： 锚标签 `a(href='/post/#{post.link}) #{comments}`
工作正常并将我引导到正确的页面。但`express`不喜欢这种表示。相反，如果我将锚标记更改为`a(href='/post/' + post.link) #{comments}` `req.params.link`可以正常工作。

**UPDATE_1**
`req.param('link')`适用于这种情况。
中间件没有问题。
但为什么`req.params.link`行不通？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T23:08:27.130

好的，我们在评论中来回讨论了一下，但现在我的猜测是问题出在你的 URL 中的双斜杠

```
a(href='/post/#{post.link}') #{comments} 
```

那是A）缺少结束引号，但我认为这只是您的问题中的错字，而不是您的代码中的错字。B）真正的问题是它`post.link`包含一个前导斜杠，所以你最终得到了这个 HTML：

```
<a href='/post//post_link_name'>42</a> 
```

因此 express 将其解析为空`:link`参数。把你的玉改成这样：

```
a(href='/post#{post.link}') #{comments} 
```

你应该重新开始工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-31T08:40:45.463

在最新版本的*express*中，您可以将`router.param()`其用作中间件来专门处理`req.params`：

```
var router = express.Router();

router.param( "nickname", function (req, res, next, nickname) {

    console.log( "nickname: ", nickname );
    next();
});

router.get( "/user/:nickname", myController.method ); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-15T22:56:07.893

的签名是`middleware.loginCheck`什么样的？它需要返回一个`function(req, res, next)`

# android - 什么情况下会出现这个错误日志

> ID：13405575
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:24:30.460
> 
> 标签：android, html, webview

```
01-13 09:36:59.934: W/System.err(1368): java.lang.ArrayIndexOutOfBoundsException
01-13 09:36:59.934: W/System.err(1368):     at org.apache.harmony.luni.util.Base64.decode(Base64.java:114)
01-13 09:36:59.934: W/System.err(1368):     at org.apache.harmony.luni.util.Base64.decode(Base64.java:33)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.DataLoader.<init>(DataLoader.java:51)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.FrameLoader.handleLocalFile(FrameLoader.java:209)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.FrameLoader.executeLoad(FrameLoader.java:129)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.BrowserFrame.startLoadingResource(BrowserFrame.java:748)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.LoadListener.nativeAddData(Native Method)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.LoadListener.commitLoad(LoadListener.java:1230)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.LoadListener.handleMessage(LoadListener.java:214)
01-13 09:36:59.934: W/System.err(1368):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-13 09:36:59.934: W/System.err(1368):     at android.os.Looper.loop(Looper.java:144)
01-13 09:36:59.934: W/System.err(1368):     at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:632)
01-13 09:36:59.934: W/System.err(1368):     at java.lang.Thread.run(Thread.java:1102) 
```

我通过 WebView.loadUrl(url) 使用其 URL 将 HTML 文件加载到 webview，现在在某些设备中它可以正常工作，而在其他设备（例如 HTC Desire）中，我在 logcat 上获得了该错误日志。我真的很困惑，浪费了很多时间试图理解这一点，所以请帮助我！

也许它与 HTML 文件本身有关？因为 WebView.loadUrl(url) 确实在同一设备中显示了其他一些 HTML，但是，HTML 可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:26:08.933

您的代码中的某些内容正在尝试访问数组的不存在的成员（索引）。这就是异常的*意思*。

# hadoop - 调试 mahout 逻辑回归

> ID：13405580
> 
> 赞同：2
> 
> 时间：2012-11-15T20:25:03.657
> 
> 标签：hadoop, mahout

我是 mahout 的新手。我正在尝试此处列出的标准“甜甜圈”示例：

[http://imiloainf.wordpress.com/2011/11/02/mahout-logistic-regression/](http://imiloainf.wordpress.com/2011/11/02/mahout-logistic-regression/)

所以这个例子就像一个魅力。

但是当我尝试在我的数据集（这是一个巨大的数据集）上实现它时，它不起作用。

数据集在一个 csv 文件中。除了它有很多特征（~100）并且是 1TB 文件之外，一切都是一样的。

我收到这个错误。

```
 bin/mahout trainlogistic  --input /path/mahout_input/complete/input.csv \
--output mahoutmodel --target default --categories 2 --predictors O1 E1 I1 \
 --types numeric --features 30 --passes 100 --rate 50
Running on hadoop, using HADOOP_HOME=/opt/mapr/hadoop/hadoop-0.20.2
No HADOOP_CONF_DIR set, using /opt/mapr/hadoop/hadoop-0.20.2/conf
Exception in thread "main" java.lang.NullPointerException
        at org.apache.mahout.classifier.sgd.CsvRecordFactory.firstLine(CsvRecordFactory.java:167)
        at org.apache.mahout.classifier.sgd.TrainLogistic.main(TrainLogistic.java:75)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
        at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
        at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:187)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.util.RunJar.main(RunJar.java:186) 
```

我究竟做错了什么？

你如何调试这个..错误是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T09:41:32.437

检查您的输入路径或确保输入路径的第一行具有“”中的值，例如“x1”、“x2”、“x3”、“labell”..等等

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T20:40:17.103

我的猜测是您的输入不存在或为空。我会检查这`/path/mahout_input/complete/input.csv`是否真的是你的意思。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-01T07:54:43.433

也发生在我身上。

我的错误是绕过了不正确的 --target 参数，该参数在列中不存在。具体来说，我的标题行是

```
myColumn1,myColumn2,myColumn3 
```

我的命令行是

mahout trainlogistic --input ./input.csv --output ./logistic_model
**--target myMisTypedColumn1** --predictors myColumn2 myColumn3 --types www --features 2 --passes 100 --rate 50 --categories 2

另一个提示是：不要使用“（引号）或长列名，因此您应该避免“mahout 不喜欢我的列名吗？”等令人头疼的问题。

作为对 MAHOUT 的反馈：错误信息很糟糕。在这样一个有前途的框架中，我们永远不应该看到“NullPointerException”。

# php - 为什么重新生成会话不是防止欺骗的解决方案？

> ID：13405599
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:26:41.580
> 
> 标签：php, session, sessionid, session-fixation

经过数小时的阅读和尝试理解会议，这是我的一般结论/观点：

简单（和现实）的情况：

*   攻击者获取现有网站 'website.example.com' 并将随机 SID 放在 URL '9gag.com/?SID=1234' 后面
*   攻击者将此 URL 粘贴到“论坛”上，并附上以下文字：“9gag 为前 1000 次登录提供免费的东西！”
*   受害者认出了该网站，因为他在那里有一个帐户，所以他很快点击了给定的 URL。
*   受害者进入网站并登录。

> 因为受害者点击了“9gag.com/?SID=1234”并登录；他现在登录到 id=1234 的会话。请注意，每个会话都有一个唯一的 ID。这是服务器处理每个会话个体所必需的。虽然可以同时从多台计算机上进行相同的会话（具有相同的 id）。

*   攻击者也访问了 '9gag.com/?SID=1234'。他现在与受害者在同一场会议上。这意味着他像受害者一样登录。他可以查看所有受害者帐户设置并进行更改。

为防止这种情况发生，本网站的主机可以使用以下 PHP 代码：

```
<?php

  session_start();

  if (!isset($_SESSION['initiated']))
  {

    session_regenerate_id();
    $_SESSION['initiated'] = TRUE;
  }

  ?> 
```

> 当initiated 为真时（所以当生成随机sessionID 时）不会生成新的sessionID。否则，生成新的 sessionID。因此，当受害者使用给定的 sessionID '1234' 登录时，它会将其丢弃并生成一个新的。现在攻击者无法获得与您相同的 sessionID，因为他不知道。

攻击者很聪明，并且知道另一种方式：

*   攻击者访问该站点并登录。PHP 服务器已生成一个新的 sessionID。
*   攻击者查看他的 COOKIES 以查看他收到的 sessionID。他发现 SID='412e11d5'
*   攻击者执行与之前相同的步骤，但使用给定 ID 而不是“1234”。-> '9gag.com/?SID=412e11d5'

> 问题：这怎么可能？

*   $_SESSION['initiated'] 是否基于给定的 ID？所以'initiated == true'是因为它使用了id '412e11d5'的会话？
*   攻击者先进行会话，否则无法生成 ID。那么受害者不应该进入攻击者会话（在他的帐户设置上，..）而不是反之亦然？
*   看起来会话固定是基于很多运气。攻击者必须与受害者同时进入网站。我想我只是不明白这是如何工作的..

> 编辑：使用跨站点烹饪的攻击：

*   攻击者创建了一个自己的网站“evil.example.com”，该网站将特定的 sessionID 存储在现有网站“9gag.com”的 COOKIE 中。
*   受害者点击 URL 'evil.example.com' 就像在其他示例中一样。sessionID 已存储在他的“9gag.com”COOKIE 中。
*   受害者当天晚些时候登录了“9gag.com”。
*   攻击者现在可以使用固定会话标识符来使用受害者的帐户。

> 问题：再次，这怎么可能？：

*   即使攻击者可以在另一个网站的 COOKIE 中存储一些东西。他如何/何时可以与受害者参加同一会议？他似乎不必同时登录？还是他可以通过其他方式（但使用 sessionID）获取受害者的私人数据？

请修改我的任何误解！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:35:33.537

> $_SESSION['initiated'] 是否基于给定的 ID？所以'initiated == true'是因为它使用了id '412e11d5'的会话？

不，它基于给定的会话。但已启动 == true，因为对于该给定会话，它已启动。那个时候会话是用那个 id 保存的，是的，所以那个 id 的会话就被启动了。

> 攻击者先进行会话，否则无法生成 ID。那么受害者不应该进入攻击者会话（在他的帐户设置上，..）而不是反之亦然？

是的。但是，如果攻击者在没有登录的情况下创建了一个会话，并且受害者会登录，那么它（最初）将是攻击者会话，但受害者记录了详细信息。

> 看起来会话固定是基于很多运气。攻击者必须与受害者同时进入网站。我想我只是不明白这是如何工作的..

不，攻击者不需要同时进入。就在给定 id 的会话仍然有效时。

* * *

现在，所有这一切的一个简单解决方案是禁用 urls (trans_sid) 中的会话 ID。应该始终这样做。

为了提高安全性，可以（并且在某些情况下应该）在*每次*请求/响应时重新生成会话 ID。

# openstreetmap - MapQuest Android API 和 Mapnik

> ID：13405602
> 
> 赞同：1
> 
> 时间：2012-11-15T20:26:49.537
> 
> 标签：openstreetmap, mapquest, mapnik

我已经实现了 MapQuest 的 Android API。在通用 API 的文档中，它说在使用 OpenStreetMap 数据时可以使用“通过 Mapnik 样式文件自定义地图图块”。我想知道这是否意味着您可以托管自己的运行 Mapnik 的图块服务器并获取 API 以使用这些图块或其他东西。在我能找到的任何文档中都不再提及这一点。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T23:04:00.390

使用 Mapnik 样式文件的参考与 MapQuest 将样式文件提供给想要调整它们然后根据 OpenStreetMap 数据生成自己的图块的开发人员有关。但是，这并不特定于 Android API，而且 Android API 不支持自定义地图图块。对于造成的混乱，我深表歉意（我在 MapQuest 工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T08:00:38.037

据我所知，您是对的，您不能使用自定义磁贴样式，而是使用自定义 UI 样式（[UI 样式指南](http://developer.mapquest.com/web/documentation/sdk/javascript/v7.0/custom)）

# node.js - Node.js TCP套接字在轮询前等待几秒钟？(net.createServer)

> ID：13405603
> 
> 赞同：2
> 
> 时间：2012-11-15T20:26:49.993
> 
> 标签：node.js, sockets, tcp

我在 Node.js 中有一个非常简单的 TCP 套接字。它连接到以 XML 格式发回数据的设备。有一个 C# 程序可以做到这一点，但我必须在 Node.js 中构建它。

因此，当设备发送消息时，我会在大约 5 秒后收到响应！C# 程序在 1 或 2 秒后得到它。

看起来“tcp 套接字”具有特定的轮询频率或某种“等待功能”。这甚至可能吗？每次显示传入消息。它还显示“sock.on('close')”的退出消息

似乎 5 秒后“服务器”自动关闭。见底线“console.log('[LISTENER] Connection paused.');” 之后，传入的消息将正确显示。

我的代码有什么问题？

```
// Set Node.js dependencies
var fs = require('fs');
var net = require('net');

// Handle uncaughtExceptions
process.on('uncaughtException', function (err) {
    console.log('Error: ', err);
    // Write to logfile
    var log = fs.createWriteStream('error.log', {'flags': 'a'});
    log.write(err+'\n\r');

});

/*  
    -------------------------------------------------
    Socket TCP : TELLER
    -------------------------------------------------
*/
var oHOST = '10.180.2.210';
var oPORT = 4100;

var client = new net.Socket();
client.connect(oPORT, oHOST, function() {

            console.log('TCP TELLER tells to: ' + oHOST + ':' + oPORT);

            // send xml message here, this goes correct!
            client.write(oMessage);                     
});

// Event handler: incoming data
client.on('data', function(data) {
    // Close the client socket completely
    client.destroy();
});

// Event handler: close connection
client.on('close', function() {
    console.log('[TELLER] Connection paused.');
});     

/*  
    -------------------------------------------------
    Socket TCP : LISTENER
    -------------------------------------------------
*/
var iHOST = '0.0.0.0';
var iPORT = 4102;

// Create a server instance, and chain the listen function to it
var server = net.createServer(function(sock) {

    // We have a connection - a socket object is assigned to the connection automatically
    console.log('TCP LISTENER hearing on: ' + sock.remoteAddress +':'+ sock.remotePort);

    // Event handler: incoming data
    sock.on('data', function(data) {
        console.log('Message: ', ' '+data);
    });

    // Event handler: close connection
    sock.on('close', function(data) {
        console.log('[LISTENER] Connection paused.');
    });

}).listen(iPORT, iHOST); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:33:47.637

client.write() 并不总是立即发送数据，它会等到缓冲区满后再发送数据包。client.end() 将关闭套接字并刷新缓冲区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:54:49.317

你可以试试这个：[http ://nodejs.org/api/net.html#net_socket_setnodelay_nodelay](http://nodejs.org/api/net.html#net_socket_setnodelay_nodelay)

不过，您的 5 秒延迟确实有点奇怪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:45:00.660

所以在“TELLER”中我不得不写“sock.write(data);” 在 "sock.on('data', function(data)" 事件中。

现在可以了。感谢 Jeremy 和 rdrey 帮助我朝着正确的方向前进。

# php - 用于显示谷歌地图的 jQuery 函数中的 PHP 变量

> ID：13405605
> 
> 赞同：0
> 
> 时间：2012-11-15T20:26:52.520
> 
> 标签：php, jquery, wordpress, google-maps

我要疯了。我使用以下代码从 Wordpress 自定义字段（输入类型）中获取值（它是家庭地址）：

```
<?php $dudi=get_post_meta($post->ID, 'addr', true); ?> 
```

很好！现在我必须“传递”这个变量 $dudi 给一个 jQuery 函数（它是[gMap](http://gmap.nurtext.de/)，用于显示谷歌地图）：

```
$(function() {
    $("#map").gMap({ markers: [
        { address: '<?php echo $dudi; ?>',
          html: "blah blah<br>blah blah" }
        ],
  zoom: 10 });  
}); 
```

现在使用标签`<div id="map"></div>`gMap 应该在指定地址上显示带有标记的地图（变量 $dudi 中的值）但不起作用！请注意，如果我手动编写地址（代替`<?php echo $dudi; ?>`），它可以在带有错误的 Chrome 上运行（单击标记并移动地图时会出现奇怪的效果）并且不适用于 IE 和 Firefox

不知道...我已经尝试过任何方式，但无事可做...明天我需要这个！:(希望你们！！

**更新**：天哪！我要采取措施，因为不清楚问题是由变量的传递还是由 html/css 冲突引起的。所以目前我已经绕过变量在 jQuery 函数中手动编写了地址。好吧，经过多次头痛后，我发现地图与 css 发生冲突：

```
max-width: 100%; 
```

事实上，当我评论那条线时，地图显示正确。

现在，我恢复了变量，现在地图在任何浏览器（又名灰色背景）上都不起作用，但它正确显示了缩放推子，并且在浏览器控制台中，我在文件 main.js 中有**两个错误。** `TypeError: a is null`不幸的是我不知道这个文件，我无法修复一些代码。希望你们……再一次！

如果需要的话...

*第一个错误*

```
H(ff,hb);var Kh=256/360,Lh=256/(2*Math.PI);ff.prototype.fromLatLngToPixel=function(a,b){var c=128+a.lng()*Kh,d=Db(Math.sin(Xb(a.lat())),-0.9999,0.9999),d=128+0.5*Math.log((1+d)/(1-d))*-Lh,f=1<<b;return new r(u(c*f),u(d*f))}; 
```

*第二个错误*

```
Oh(Sj,"arrow",1);function qi(a,b,c){!a.lat&&!a.lon&&(a=new P(a.y,a.x));this.Aa=a;this.Nu=i;this.na=0;this.N=this.mb=!1;this.Oo=[];this.V=[];this.Ra=Mj;this.Mg=this.cl=i;this.Ub=!0;this.Dg=this.rf=!1;this.g=i;if(b instanceof Qj||b==i||c!=i)this.Ra=b||Mj,this.Ub=!c,this.ha={icon:this.Ra,clickable:this.Ub};else{b=this.ha=b||{};this.Ra=b.icon||Mj;this.mv&&this.mv(b);if(b.clickable!=i)this.Ub=b.clickable;if(b.isPng)this.rf=!0}b&&Ob(this,b,"id,icon_id,name,description,snippet,nodeData".split(","));this.Zu=Tj;if(b&&b.getDomId)this.Zu= 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:31:54.043

> “Chrome 用 OK 标记显示地图！！！而 Firefox 和 IE 什么也不显示（灰色背景等）”

如果 Ennui 的解决方案在 Chrome 上运行良好，请检查其他浏览器控制台 - 它们应该会输出某种错误。当 GoogleMaps 显示“灰色背景”而不是地图时，通常会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:52:10.123

尝试为 img 标签找到 css stype `max-width: none;` 并将其替换为： `max-width: none;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:34:54.647

一个快速而肮脏的解决方案是在隐藏的 div 中的页面某处回显 $dudi 变量。例如：

```
<p style="display:none" id="dudi">
  <?php echo get_post_meta($post->ID, 'addr', true); ?>
</p> 
```

然后在你的 jQuery 中：

```
var dudi = $('p#dudi').text(); 
```

没有时间对此进行测试，但我认为它应该适合您的目的。

# php - 通过 AJAX 将 JSON 传递给 PHP 文件

> ID：13405606
> 
> 赞同：0
> 
> 时间：2012-11-15T20:27:07.213
> 
> 标签：php, jquery, ajax, json

我有一些 json 我想使用 ajax 传递给另一个 php 文件。

```
{
"id":"5",
"itemName":"Infinity",
"itemDesc":"Infinity",
"imageURL":"Infinity.jpg",
"language":"N\/A",
"category":"Logos",
"size":"612 KB",
"flagDesc":"",
"fileType":"jpg"
} 
```

这是我的ajax

```
$.ajax({
  url:'download.php',
  data: {
  image: z,
},
  success:function(results){
  alert(results);
}
}); 
```

Z代表上面的json。我不确定传递数据时要放什么。我一直在来回走，没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:38:28.847

这是方法：

```
$.ajax({
    type: 'POST',
    url:'download.php',
    data: { image: JSON.stringify(z) },
    success:function(results){
        alert(results);
    }
}); 
```

在您的 中`download.php`，您可以将这些数据访问为

```
$data = json_decode($_POST['image']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:48:47.353

如果`z`您只想通过，我会这样做：

```
$.ajax({
  url:'download.php',
  data: z,
  success:function(results){
    alert(results);
  }
}); 
```

在 php 中你可以这样做：`$image = json_encode($_GET);`如果你需要你的数据是 json.

# wso2 - 租户 WSO2 Stratos 主题存储在哪里？

> ID：13405609
> 
> 赞同：1
> 
> 时间：2012-11-15T20:27:16.100
> 
> 标签：wso2, wso2stratos

为租户选择的主题存储在哪里？

我想手动获取并更改它。

1.  主题是否存储在 LDAP 中？
2.  它存储在Mysql中吗？
3.  它是否存储在文件系统中？

我说的是为租户收集和保存的主题。每个租户都有不同的主题保存在某个地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T09:03:30.003

这将保存在本地注册表中。注册表位置是“/_system/governance/repository/theme”。

# memory - NSURLCache ：说它的缓存，不是，并且内存统计没有变化

> ID：13405610
> 
> 赞同：2
> 
> 时间：2012-11-15T20:27:19.753
> 
> 标签：memory, ios6, nsurlconnection, nsurlcache, disk-access

我正在尝试通过记录 NSURLCache 周围的内存统计信息来确认 URL 缓存。

我已经扩展了基础 NSURLCache 如下：

```
@implementation  MarksCache : NSURLCache

- (NSCachedURLResponse *) cachedResponseForRequest:(NSURLRequest *)request;
{
    NSString *myString = [request.URL absoluteString];
    DDLogVerbose(@"URL CACHE GET : PRE  : %@ %d %d %d %d", myString,
                 [NSURLCache sharedURLCache].currentDiskUsage ,
                 [NSURLCache sharedURLCache].currentMemoryUsage,
                 [NSURLCache sharedURLCache].diskCapacity,
                 [NSURLCache sharedURLCache].memoryCapacity);

    NSCachedURLResponse *resp = [super cachedResponseForRequest:request];
    //NSURLResponse *rp = [resp response];
    //NSString *rpdesc = [rp description];

    //NSData *data = [resp data];
    //NSString *respdesc = [resp description];
    //NSString *selfdesc = [super description];

    DDLogVerbose(@"URL CACHE GET : POST : %@ %d %d %d %d", myString,
                 [NSURLCache sharedURLCache].currentDiskUsage ,
                 [NSURLCache sharedURLCache].currentMemoryUsage,
                 [NSURLCache sharedURLCache].diskCapacity,
                 [NSURLCache sharedURLCache].memoryCapacity);

    return resp;
}

- (void)storeCachedResponse:(NSCachedURLResponse *)cachedResponse forRequest:(NSURLRequest *)request
{
    NSString *myString = [request.URL absoluteString];
    DDLogVerbose(@"URL CACHE SET : PRE  : %@ %d %d %d %d", myString,
                 [NSURLCache sharedURLCache].currentDiskUsage ,
                 [NSURLCache sharedURLCache].currentMemoryUsage,
                 [NSURLCache sharedURLCache].diskCapacity,
                 [NSURLCache sharedURLCache].memoryCapacity);
    [super cachedResponseForRequest:request];
    DDLogVerbose(@"URL CACHE SET : POST : %d %d %d %d",
                [NSURLCache sharedURLCache].currentDiskUsage ,
                [NSURLCache sharedURLCache].currentMemoryUsage,
                [NSURLCache sharedURLCache].diskCapacity,
                [NSURLCache sharedURLCache].memoryCapacity);
}

@end 
```

我还有执行以下操作的按钮代码：

```
- (IBAction)onClearButtonPress:(id) sender{
    DDLogVerbose(@"TestViewController onClearButtonPress : START : PRE : %d %d %d %d", 
    [NSURLCache sharedURLCache].currentDiskUsage , 
    [NSURLCache sharedURLCache].currentMemoryUsage, 
    [NSURLCache sharedURLCache].diskCapacity,  
    [NSURLCache sharedURLCache].memoryCapacity);

    [NSURLCache sharedURLCache].removeAllCachedResponses;

    DDLogVerbose(@"TestViewController onClearButtonPress : START : POST : %d %d %d %d", 
    [NSURLCache sharedURLCache].currentDiskUsage , 
    [NSURLCache sharedURLCache].currentMemoryUsage, 
    [NSURLCache sharedURLCache].diskCapacity,  
    [NSURLCache sharedURLCache].memoryCapacity);

    } 
```

当我单击视图上的一些测试按钮以触发 URLConnection 事件时，我看到使用正确的 URL 调用这些方法。但是，缓存内存和磁盘使用统计信息永远不会改变。

来自日志的示例

```
URL CACHE SET : PRE  : https://<domain.com>/resources/images/bg/bg-blue.png 1970176 0 10000000 512000
URL CACHE SET : POST : https://<domain.com>/resources/images/bg/bg-blue.png 1970176 0 10000000 512000

URL CACHE GET : PRE  : https://<domain.com>/resources/images/bg/bg-footer.png 1970176 0 10000000 512000
URL CACHE GET : POST : https://<domain.com>/resources/images/bg/bg-footer.png 1970176 0 10000000 512000

TestViewController onClearButtonPress : START : PRE : 1970176 0 10000000 512000
TestViewController onClearButtonPress : EXIT : POST : 1970176 0 10000000 512000

URL CACHE SET : PRE  : https://<domain.com>/resources/images/bg/bg-footer.png 1970176 0 10000000 512000
URL CACHE SET : POST : https://<domain.com>/resources/images/bg/bg-footer.png 1970176 0 10000000 512000 
```

这让我相信：

1 - 我做错了什么，没有正确观察缓存行为

2 - 这个缓存并不是真正的缓存

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T13:44:00.633

我不久前想通了这一点，并想发布答案。我已将我的代码作为代表： `NSURLConnection - connection:willCacheResponse`

该方法允许您在缓存行为发生之前覆盖它。我只是简单地登录它以查看我的响应是可缓存的，而忘记实际进行任何缓存。修复后，我的内存统计记录确实显示项目进入和退出缓存。

[URL 加载系统编程指南](https://developer.apple.com/library/mac/#DOCUMENTATION/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html#//apple_ref/doc/uid/20001836-BAJEAIEE)

# python - 熊猫滚动适用于缺少数据

> ID：13405611
> 
> 赞同：10
> 
> 时间：2012-11-15T20:27:19.237
> 
> 标签：python, pandas, missing-data, rolling-computation

我想对丢失的数据进行滚动计算。

示例代码：（*为了简单起见，我给出了一个滚动总和的示例，但我想做一些更通用的事情。）*

```
foo = lambda z: z[pandas.notnull(z)].sum() 
x = np.arange(10, dtype="float")    
x[6] = np.NaN
x2 = pandas.Series(x)    
pandas.rolling_apply(x2, 3, foo) 
```

产生：

```
0   NaN    
1   NaN
2     3    
3     6    
4     9    
5    12    
6   NaN    
7   NaN    
8   NaN    
9    24 
```

我认为在“滚动”期间，缺少数据的窗口被忽略以进行计算。我希望得到以下结果：

```
0   NaN    
1   NaN    
2     3    
3     6    
4     9    
5    12    
6     9    
7    12    
8    15    
9    24 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-15T23:09:07.543

```
In [7]: pandas.rolling_apply(x2, 3, foo, min_periods=2)
Out[7]: 
0   NaN
1     1
2     3
3     6
4     9
5    12
6     9
7    12
8    15
9    24 
```

# jquery - 将单击时的文本替换为已单击链接中的文本

> ID：13405620
> 
> 赞同：0
> 
> 时间：2012-11-15T20:28:15.010
> 
> 标签：jquery, loops, text, each

```
<ul class="filter">
<li>
<span class="filtertext"><span>Filter</span></span>
<ul class="dropdown">
<li class="active"><a href="javascript:void(0)">All</a</li>

<li><a href="#">Administrative Associates</a></li>
<li><a href="#">Associate Principals</a></li>
<li><a href="#">Associates</a></li>
<li><a href="#">Chief Financial Officer</a></li>
<li><a href="#">Directors</a></li>
<li><a href="#">Principals</a></li>
<li><a href="#">Senior Associates</a></li>
<li><a href="#">Staff</a></li>
</ul></li>
</ul> 
```

我用流沙设置了一个过滤器，上面的列表在我的网站上显示了一个下拉列表。我想要做的是将标签中的文本“过滤器”替换为所选类别中的文本。

我有这个工作，但是，它只是第一次这样做。我有一种感觉，我需要实现类似 .each() 的东西，但似乎无法弄清楚我应该把它放在哪里。以下是我的 jQuery 代码：

```
$('ul.dropdown li a').click(function (){
$('span.filtertext span').replaceWith( $(this).html() );
}); 
```

如果您需要更多信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:29:48.827

它只在第一次工作的原因是因为你正在使用`replaceWith`，它实际上删除了元素；下次你的函数运行时，`$('span.filtertext span')`找不到任何东西。

改用它（也添加缓存）：

```
var $filtertext = $('span.filtertext span');
$('ul.dropdown li a').click(function () {
    $filtertext.text( $(this).text() );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:30:03.697

当你想改变文本时，你应该使用这个：

```
$('ul.dropdown li a').click(function (){ 
    $('span.filtertext span').html( $(this).text() );
}); 
```

因为如果你用`replaceWith`替换`span`，替换后就没有对象匹配`'span.filtertext span'`了...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:31:07.463

我会改用 jQuery 的 .text() 。

在[http://jsfiddle.net/6kTQ5/工作](http://jsfiddle.net/6kTQ5/)

尝试这个。

```
$('ul.dropdown li a').click(function (){
    $('span.filtertext span').text( $(this).text() );
});​ 
```

# scala - 在 BigInt 上调用 apply 方法时出错

> ID：13405621
> 
> 赞同：0
> 
> 时间：2012-11-15T20:28:26.447
> 
> 标签：scala

`value apply is not a member of scala.math.BigInt`当我尝试执行以下代码时，为什么会出现错误 ( )？

```
var a : BigInt = 12;
a.apply("123", 36); 
```

`BigInt#apply`在 ScalaDoc 中定义。我也尝试使用隐式`apply` 方法调用，它也不起作用：

```
a("123", 36); 
```

（第二个问题：*所有对象*调用`()`等于调用`object.apply`或`object apply` ？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:32:59.120

`BigInt#apply`指的是[对象 BigInt](http://www.scala-lang.org/api/current/scala/math/BigInt%24.html)，而不是[类 BigInt](http://www.scala-lang.org/api/current/scala/math/BigInt.html)。具体调用此方法执行以下操作：

```
BigInt.apply("123", 36) 
```

或者，因为`apply`是看起来像函数应用的特殊方法：

```
BigInt("123", 36) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T20:33:52.683

`apply()`是`BigInt` [伴随对象](http://www.scala-lang.org/api/current/scala/math/BigInt%24.html)的方法，而不是`BigInt`类本身。因此你可以说：

```
val a = BigInt("123", 36) 
```

此外，您期望`a("123", 36)`什么？`BigInt`是不可变的。

# java - 在 DELETE 期间并发 READ 导致 StaleObjectStateException？

> ID：13405624
> 
> 赞同：0
> 
> 时间：2012-11-15T20:28:29.723
> 
> 标签：java, spring, hibernate

在我们的网站上，我们有两个针对同一个表的操作，一个是读取多行，另一个是删除一行。

我们使用的是 Spring 3.1 和 Hibernate 3.6。

确切的操作是

```
EntityManager.createQuery().getResultList(); 
```

和

```
EntityManager.remove(); 
```

我们在 remove() 线程上得到了 StaleObjectStateException，而不是在 getResultList() 线程上。问题是，为什么读取会导致 StaleObjectException？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:14:24.153

就像 Pace 所说的那样，您可能正在修改使用该查询检索到的一些实例，而该实例仍然附加，这意味着在附加实例中的 persistenceContext（EntityManager 的“实例”）之前提交事务。

另一个可能的事情是您正在覆盖版本属性的值，因此 entityManager 不仅将实例/实体标记为已修改，而且还使用较低/未预期的版本值执行更新查询。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T19:08:13.180

事实证明，这个问题的根本原因与 Hibernate 或 Spring 完全无关，它是一个 HTML/Javascript 问题，导致每次单击相关链接时都会发送两个单独的 HTTP 请求。（这两个请求都是编辑，所以这是冲突的根源。）

只是把这个答案放在这里，这样人们就会知道 Spring 和 Hibernate 确实有效。

# sql - 完全消除特定出版物的复制的正确方法是什么

> ID：13405625
> 
> 赞同：0
> 
> 时间：2012-11-15T20:28:32.263
> 
> 标签：sql, replication, pull, subscriptions

我有两台服务器：

服务器 1（发布者）

服务器 2（订阅者）

我设置了 PULL 订阅。

以编程方式删除整个复制的正确步骤是什么？

我需要知道这一点，因为我有一个执行复制的自定义应用程序，并且在发生错误时，我需要“重新开始”，所以我需要删除发布、订阅和与之相关的任何其他对象......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:24:37.573

步骤是：

1.  删除拉取订阅
2.  删除发布

以下是一些可以帮助您的链接：

[删除请求订阅](http://msdn.microsoft.com/en-us/library/ms151861.aspx)

[删除出版物](http://msdn.microsoft.com/en-us/library/ms151256.aspx)

这两个示例都展示了如何使用 SSMS、T-SQL 和 RMO 删除请求订阅和发布。T-SQL 或 RMO 将以编程方式进行。我希望这有帮助。

# c# - 在 C# 中第二次创建文件时会抛出异常

> ID：13405626
> 
> 赞同：3
> 
> 时间：2012-11-15T20:28:36.040
> 
> 标签：c#, winforms

我正在使用文件流创建文件，但在此之前我正在应用 if 条件来查看文件是否存在。当我单击按钮并且假设文件在那里时，它会删除该文件。没关系，如果我再次按下按钮，文件就会被创建。第一次它运作良好。

现在文件已创建，如果我再次按下按钮，它应该删除，但它会抛出一个异常，说**进程无法访问文件'C：\ Hello1'，因为它正在被另一个进程使用。**

下面是我的代码

```
 private void button2_Click(object sender, EventArgs e)
    {
        string fileName = @"C:\Hello1";
        if

            (File.Exists(fileName))
        {
            File.Delete(fileName);
            MessageBox.Show("File is deleted");
        }
        else
        {
            FileInfo createFile = new FileInfo(fileName);
            FileStream create = createFile.Create();
            MessageBox.Show("Created");

        }
    } 
```

那么为什么我不能第二次删除，我的文本文件也没有打开，但它仍然显示异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:30:37.653

您永远不会关闭创建文件的流。把你`FileStream`放在一个`using`语句中，它会自动清理打开的文件句柄。

```
using(FileStream create = createFile.Create())
{
    //code here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:34:18.983

第二次尝试时文件流仍然打开，试试这个：

```
private void button2_Click(object sender, EventArgs e)
{
    string fileName = @"C:\Hello1";
    if

        (File.Exists(fileName))
    {
        File.Delete(fileName);
        MessageBox.Show("File is deleted");
    }
    else
    {
        FileInfo createFile = new FileInfo(fileName);
        using(FileStream create = createFile.Create())
        {
            MessageBox.Show("Created");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:31:41.930

哦，是的，我得到了答案，

我需要使用

```
 private void button2_Click(object sender, EventArgs e)
{
    string fileName = @"C:\Hello1";
    if

        (File.Exists(fileName))
    {
        File.Delete(fileName);
        MessageBox.Show("File is deleted");
    }
    else
    {
        FileInfo createFile = new FileInfo(fileName);
        FileStream create = createFile.Create();
        MessageBox.Show("Created");
        create.Close();

    }
} 
```

我们需要使用 create.Close();

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:43:40.897

这是我用来编写本地日志的示例：

```
 StreamWriter log;

            string fpath = string.Format(@"{0}\{1}.txt",GetDirectory(),DateTime.Now.ToString("yyy-MM-dd"));
            if (!File.Exists(fpath))
            {
                log = new StreamWriter(fpath);
            }
            else
            {
                log = File.AppendText(fpath);
            }

            log.WriteLine(string.Format("{0} ==> {1}",DateTime.Now.ToString("MM/dd/yyy HH:mm:ss"), Message));

            log.Dispose();
            log = null; 
```

# android - 禁用默认 AlarmClock 闹钟

> ID：13405627
> 
> 赞同：1
> 
> 时间：2012-11-15T20:28:41.090
> 
> 标签：android, clock, alarm

我在默认的闹钟应用程序中设置了闹钟。如何禁用先前设置的警报？我没有为此使用 AlarmManager。

```
 Intent alarm = new Intent(AlarmClock.ACTION_SET_ALARM);
        int hour = Integer.parseInt(message.substring(11,13));
        int minutes = Integer.parseInt(message.substring(14,16));
        if((message.substring(17,19).equalsIgnoreCase("AM") || message.substring(17,19).equalsIgnoreCase("PM")))
        {
            if(message.substring(17,19).equalsIgnoreCase("AM"))
            {
                alarm.putExtra(AlarmClock.EXTRA_HOUR, hour);
            }
            else
                alarm.putExtra(AlarmClock.EXTRA_HOUR, hour+12);

            alarm.putExtra(AlarmClock.EXTRA_MINUTES, minutes);
            alarm.putExtra(AlarmClock.EXTRA_MESSAGE, name+": "+message.substring(20));

        }
        startActivity(alarm); 
```

在字符串消息中，我从用户那里获取小时、分钟和 AM/PM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-23T04:30:34.213

我认为您直到现在才需要这个问题的答案，但我认为其他一些人将需要......请尝试： `Intent itentChangeAlarm = new Intent("android.intent.action.ALARM_CHANGED"); alarmChanged.putExtra("alarmSet", enabled); context.sendBroadcast(itentChangeAlarm);`

# facebook-opengraph - 我可以将带有 url 的开放图表歌曲发布到我们的专辑产品页面吗

> ID：13405628
> 
> 赞同：0
> 
> 时间：2012-11-15T20:28:44.867
> 
> 标签：facebook-opengraph, meta-tags, audio-player, url-link

Facebook 似乎不允许 music:song 有一个有用的 og:url。结果，显示在用户时间轴中的链接已失效。

我什至尝试使 og:url 等于对象页面（如下所示）。基本上它在调用时是一个失败的页面。这是由于白名单问题吗？

还是我在文档中遗漏了什么？如何使时间线中的链接有用？“用户在我们的收音机上收听了曲目。” track 必须是有效链接或不显示为链接。默认情况下，用户、曲目和电台都被制成链接。只有赛道不好。它链接到 facebook_object_page。

```
<meta property="fb:app_id"       content="OurId" /> 
<meta property="og:type"         content="music.song" /> 
<meta property="og:url"          content="https://mysite/facebook_object_page.php?artist=<?php echo $_GET['artist'];?>&product_id=<?php echo $_POST['product_id']; ?>" /> 
<meta property="og:title"        content="<?php echo $_GET['artist'];?>" /> 
<meta property="og:image"        content="http://mysite/images/product_images/products_150/<?php echo $_POST['product_id'];?>.jpg" /> 
```

# gwt - 单击页面上的链接时的竞争条件

> ID：13405631
> 
> 赞同：0
> 
> 时间：2012-11-15T20:28:56.360
> 
> 标签：gwt, web-applications

在我的网络应用程序中，左侧有按钮。

右侧显示基于按下哪个左侧按钮的显示。

有时，用户会执行以下操作：

```
 1\. Press button 1
 2\. wait 1-3 seconds
 3\. Get reasonably frustrated and click button 2
 4\. button 1's display shows up instead 
```

如果我理解正确，那么按钮 1 的服务器到客户端请求会在按钮 2 之前提供。

我认为其他 Web 开发人员也遇到了这个问题。应该如何处理？

谢谢，凯文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:33:05.633

按钮单击是否会导致 AJAX 请求？如果是这样，要么在获取资源时禁用按钮并显示加载图像，要么在单击按钮时取消任何现有的 AJAX 请求，然后再发出另一个请求。例如：

```
 var request;
  $('#button1').click(function(event) {
    if (request && typeof request.abort == 'function') request.abort()
    request = $.post(...)
  }); 
```

请求几乎肯定会在服务器端继续，这取决于很多因素，但是客户端将执行以显示请求结果的函数将不再运行。

# asp.net-mvc - MVC 4 中逗号分隔和破折号分隔的文本字段

> ID：13405635
> 
> 赞同：1
> 
> 时间：2012-11-15T20:29:15.287
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

我们的网络应用程序中有一个 Razor 表单。在与客户会面期间，我们了解到此表单中的一个字段应接受以下输入：

*   逗号分隔的数字列表
*   包括用破折号表示的数字范围

例如，最终用户可能输入`45,50-53,65`代表数字 45、50、51、52、53、65 的列表。我假设文本框也可能包含应忽略的任意空格（因此`45, 50-53, 65`表示相同信息）。

如何使用 Razor 在 MVC 4 中设置这样的文本框？尤其是，

1.  如何在我的 Razor 视图中创建文本框？
2.  我将如何在模型的文本框中表示信息？
3.  我如何将文本框数据绑定到模型？
4.  如何为文本框设置验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:51:51.497

1.  我只想创建一个普通的文本框——你要的是一串数字
2.  您可以将表单值作为字符串，然后将另一个属性作为字符串的解析版本，int[]。
3.  由于它是一个字符串，它可以作为一个字符串发布。
4.  对验证器使用正则表达式。

对于 2，您可以在模型中执行以下操作：

```
public string Numbers { get; set; }
public int[] ParsedNumbers
{
    get
    {
        Func<int[], int[]> arrayToRange = (range) =>
        {
            if (range.Length == 1) return range;
            int[] ret = new int[range[1] - range[0] + 1];
            for (int i = 0; i < ret.Length; i++)
            {
                ret[i] = i + range[0];
            }
            return ret;
        };

        return this.Numbers
                    .Replace(" ", "")
                    .Split(',')
                    .SelectMany(n => arrayToRange(n.Split('-')
                        .Select(n2 => int.Parse(n2)).ToArray())).ToArray();
    }
} 
```

对于 4，您可以使用此 RegEx：

```
^(\d(\-\d)?(, ?)?)*$ 
```

# php - 单击链接时如何运行 PHP 计数器脚本？

> ID：13405636
> 
> 赞同：1
> 
> 时间：2012-11-15T20:29:14.480
> 
> 标签：php

我有一个脚本在我的网站上访问页面时运行，它更新一个值并将其存储在一个文本文件中，但是我想在我的网站上单击一个链接时运行相同的脚本，这个链接只是打开一个文件在我的网络目录中，而不是实际页面。这是脚本：

```
<?php
$count_my_page = ("hitcounter.txt");
$hits = file($count_my_page);
$hits[0] ++;
$fp = fopen($count_my_page , "w");
fputs($fp , "$hits[0]");
fclose($fp);

?> 
```

因此，如果我想在点击我的链接时运行它，有人知道我会在哪里执行此操作吗？这是我的链接的示例：

```
<li><a href="files/file.pdf" target="blank" title="File">File</a></li> 
```

因此，此链接在新选项卡中打开文件，我正在绞尽脑汁试图弄清楚如何从链接单击中运行它，任何建议都将不胜感激。

我正在考虑调用一个 PHP 函数，该函数在单击链接时运行代码，但我做不到。

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T20:47:14.953

将您的计数脚本更新为：

```
<?php
$count_my_page = "hitcounter.txt";
$hits = file($count_my_page);
$hits[0] ++;
$fp = fopen($count_my_page , "w");
fputs($fp , "$hits[0]");
fclose($fp);

header("Location: ".$_GET['file']");
?> 
```

并使用链接：

```
<a href="count.php?file=files/file.pdf" target="blank" title="File">File</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-23T19:17:54.267

**更新您的代码**

另存为名称`count.php`

```
<?php
file_put_contents('hitcounter.txt', ((int) file_get_contents('hitcounter.txt')) + 1);
header('Location: ' . $_GET['url']);
?> 
```

**网页链接**

```
<a href="count.php?url=http://askedboss.com" target="blank">CLICK HERE</a> 
```

# android - 获取 OnItemClick Listview 上的项目值

> ID：13405641
> 
> 赞同：13
> 
> 时间：2012-11-15T20:29:34.130
> 
> 标签：android, listview, onitemclick

我尝试在列表视图的自定义适配器中获取所选项目的值。我用下面的代码试试这个：

```
public void onItemClick(AdapterView<?> parent, View v,
                        int position, long id) {

                    View curr = parent.getChildAt((int) id);
                    TextView c = (TextView)curr.findViewById(R.id.tvPopUpItem);
                    String playerChanged = c.getText().toString();

                    Toast.makeText(Settings.this,playerChanged, Toast.LENGTH_SHORT).show();

                } 
```

一开始，如果我单击，值很好，但是一旦我滚动并单击另一个项目，我会得到该单击项目的错误值...知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-15T20:32:15.283

参数`v`是当前行。所以使用：

```
public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
    TextView c = (TextView) v.findViewById(R.id.tvPopUpItem);
    String playerChanged = c.getText().toString();

    Toast.makeText(Settings.this,playerChanged, Toast.LENGTH_SHORT).show();
} 
```

（或者你可以使用`getChildAt(position)`，但这会更慢。）

了解您可以根据您的布局进一步简化此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-03T09:08:56.873

只需要一点零钱

```
TextView c = (TextView) v.findViewById(R.id.tvPopUpItem); 
```

由于您使用的是自定义视图，因此您需要在 OnItemClickListener 中传递 View 参数，然后您需要使用该值来获取其中存在的 TextViews 的详细信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T11:25:25.493

```
listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                Intent i=new Intent(ListOfAstrologers.this,AstroProForUser.class);
                i.putExtra("hello",adapter.getItem(position).getUsername() );
                startActivity(i);
            }
        }); 
```

这里的用户名是在类中声明的字符串字段，您必须`getItem()`在适配器类中覆盖方法才能在单击时获取膨胀行的详细信息。

# python - 如何在mongodb中使用聚合？

> ID：13405647
> 
> 赞同：2
> 
> 时间：2012-11-15T20:30:01.883
> 
> 标签：python, mongodb

蒙古菜鸟在这里。

好的，我收集了总共 30000 个（大约）的拉链。

他们看起来像这样......

```
{ "city" : "EPES", "loc" : [ -88.161443, 32.763371 ], "pop" : 1391, "state" : "AL", "_id" : "35460" }
{ "city" : "ETHELSVILLE", "loc" : [ -88.221987, 33.386816 ], "pop" : 719, "state" : "AL", "_id" : "35461" }
{ "city" : "EUTAW", "loc" : [ -87.930297, 32.888871 ], "pop" : 6586, "state" : "AL", "_id" : "35462" }
{ "city" : "FOSTERS", "loc" : [ -87.735688, 33.135859 ], "pop" : 2100, "state" : "AL", "_id" : "35463" }
{ "city" : "GAINESVILLE", "loc" : [ -88.271558, 32.908364 ], "pop" : 1051, "state" : "AL", "_id" : "35464" }
{ "city" : "GORDO", "loc" : [ -87.900504, 33.346917 ], "pop" : 4333, "state" : "AL", "_id" : "35466" }
{ "city" : "KNOXVILLE", "loc" : [ -87.791855, 32.982423 ], "pop" : 373, "state" : "AL", "_id" : "35469" }
{ "city" : "COATOPA", "loc" : [ -88.173592, 32.588509 ], "pop" : 6055, "state" : "AL", "_id" : "35470" }
{ "city" : "CYPRESS", "loc" : [ -87.615134, 32.978853 ], "pop" : 2659, "state" : "AL", "_id" : "35474" }
{ "city" : "NORTHPORT", "loc" : [ -87.591441, 33.283425 ], "pop" : 20114, "state" : "AL", "_id" : "35476" } 
```

我需要使用聚合找到其中邮政编码最多的第四个州......我不知道。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T21:33:50.243

解决方案：

```
db.zips.aggregate([ {$group:{_id:{state:"$state"},numberOfzipcodes:{$sum:1}}}, {$sort:{numberOfzipcodes:-1}}, {$limit:4}]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-16T07:46:58.017

//按州分组，然后找到每个州的邮政编码总数，按邮政编码总数降序排序。然后使用skip跳过前3个状态并限制为1

db.zips.aggregate([{$group:{_id:{state:"$state"},zips:{$sum:1}}}, {$sort:{zips:-1}}, {$skip: 3}, {$limit:1}])

# jquery - 通过 AJAX 调用减少服务器 CPU 使用率

> ID：13405650
> 
> 赞同：5
> 
> 时间：2012-11-15T20:30:08.487
> 
> 标签：jquery, ajax, performance, server-load

我正在开发一个多人 HTML5 游戏，它使用 jQuery 轮询服务器以获取游戏状态。目前，我每 2000 毫秒使用 .ajax 调用来查询服务器，以给人一种实时更新的印象。我真的没有通过太多数据......主要只是x / y位置和一些角色属性......只有少数玩家在我的游戏实例中活着。

服务器本身是一个共享托管服务器，我想在开发这个游戏时尽量保持我的 CPU 命中率尽可能低（并在未来将它转移到更高功率的东西上）。

这是我当前轮询服务器以获取数据的方法。欢迎任何和所有建议，因为服务器加载对我来说是一个新领域。

```
$.ajax({
  type:'GET',
  url:"controller.php?a=player-info",
  dataType:'json',
  success: function(data){
    //parse data
  }
});
....
setInterval(getPlayerInfo,2000); 
```

* * *

我应该提到的一件事是，因为这是在共享服务器上，所以我不能有自由运行的进程来打开到（即 Node.js）的连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:41:58.547

首先，您是说您没有推送太多数据。对我来说，你在拉。这与您可能知道的不完全相同。

您可以使用 Websockets、长轮询或服务器发送的事件。（[阅读这篇文章](http://dsheiko.com/weblog/websockets-vs-sse-vs-long-polling/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:37:24.787

从您目前所说的情况来看，尚不清楚 CPU 是否会成为您的瓶颈，但这里有一些建议可以帮助您节省服务器资源。

考虑使用[WebSockets](http://en.wikipedia.org/wiki/WebSocket)而不是 AJAX 轮询。通过转向更加面向推送的架构，这可以消除服务毫无意义的“没有任何改变”请求的大量开销。

您可能还想使用[memcached](http://memcached.org/)或其他一些基于 RAM 的数据存储层（例如[Redis](http://redis.io/)）来避免 DB 瓶颈。

# python - Markerfacecolor 忽略饱和度值（python，matplotlib）

> ID：13405651
> 
> 赞同：0
> 
> 时间：2012-11-15T20:30:09.733
> 
> 标签：python, colors, plot, matplotlib

matplotlib 规范说：

> 此外，您可以通过许多奇怪而奇妙的方式指定颜色，包括全名（'green'）、十六进制字符串（'#008000'）、RGB 或 RGBA 元组（(0,1,0,1)）

...

> markerfacecolor 或 mfc [可以是]任何 matplotlib 颜色

然而，当我制作一个简单的绘图时，误差条会去饱和到 0.1，而不是标记。标记面不能取4元组RGBA颜色吗？

```
#!/usr/bin/python
import matplotlib.pyplot as plt
plt.errorbar(1,1,1,markerfacecolor=[1,0,0,0.1], color=[1,0,0,0.1], marker='o')
plt.savefig('/test.png') 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:55:35.667

`markerdegecolor`如果您使用而不是，它似乎可以工作`markerfacecolor`

```
plt.errorbar(1,1,1,markeredgecolor=[0,1,0,0.1], color=[1,0,0,0.1], marker='o') 
```

`matplotlib`这对我来说似乎是一个错误。

[问题 1504](https://github.com/matplotlib/matplotlib/issues/1504)，现已修复。

# iphone - 在 iOS 中更改视图的背景颜色

> ID：13405659
> 
> 赞同：1
> 
> 时间：2012-11-15T20:30:38.033
> 
> 标签：iphone, objective-c, ios

在我的浏览器应用程序中，如果响应是 pdf 文件，我正在使用 NSURL 连接下载文件。当我收到数据时，我会显示一个 UIprogressView 来显示下载状态。我想禁用并更改背景视图的颜色，直到下载完成。

在 didReceiveResponse 委托中，我调用了一个方法来创建 progressView 并更改 backgroundcolor 并禁用 parentView

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response{
[self.fileData setLength:0];
self.totalFileSize = response.expectedContentLength;
[self performSelectorOnMainThread:@selector(startProgressView) withObject:nil waitUntilDone:NO];
}

-(void) startProgressView
{
CGSize frameSize = self.view.frame.size;
CGFloat margin = 30.0;
CGPoint center = self.view.center;

 topLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, margin, frameSize.width-2*margin, 20.)];
 bottomLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, margin, frameSize.width-2*margin, 20.)];

[topLabel setText:@"downloading file"];
[topLabel setCenter:CGPointMake(center.x, center.y - 20.)];
[topLabel setTextAlignment:NSTextAlignmentCenter];

[bottomLabel setText:@"downloadstatus"];
[bottomLabel setCenter:CGPointMake(center.x, center.y + 20.)];
[bottomLabel setTextAlignment:NSTextAlignmentCenter];

self.progressBar = [[UIProgressView alloc] initWithFrame:
                    CGRectMake(0, margin, frameSize.width-2*margin, 20.)];
[self.progressBar setProgress:0];
[self.progressBar setCenter:center];

[self.view addSubview:topLabel];
[self.view addSubview:(self.progressBar)];
[self.view addSubview:bottomLabel];

 /*
CGRect frame = CGRectMake(0.0, 0, self.view.bounds.size.width, self.view.bounds.size.height);
UIView *v = [[UIView alloc] initWithFrame:frame];
[v setBackgroundColor:[[UIColor alloc] initWithRed:255.0
                                             green:0.0
                                              blue:0.0
                                             alpha:0.1]];
[self.view insertSubview:v atIndex:0];
[v release];
*/

[self.view setBackgroundColor: [UIColor colorWithRed:0.0 green:255.0 blue:128.0/255 alpha:0.5]];
[self.view setUserInteractionEnabled:NO];
} 
```

我尝试设置背景颜色，甚至插入一个带有颜色的新视图，但背景颜色没有改变。有人可以指出我是否缺少任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T00:33:06.950

谢谢大家的建议。我找出了背景颜色不可见的原因。viewcontroller(self.view) 的主视图在其顶部包含另外 3 个子视图，并且由于子视图，更改 self.view 的背景颜色是不可见的。要更改背景颜色，我只需创建另一个视图

```
CGRect frame = CGRectMake(0.0, 0, self.view.bounds.size.width, self.view.bounds.size.height);
backgroundView = [[UIView alloc] initWithFrame:frame];
[backgroundView setBackgroundColor:[[UIColor alloc] initWithRed:204./255 green:213./255 blue:216./255 alpha:0.5]];
[self.view addSubview:backgroundView]; 
```

并将其添加到 self.view 中，然后再添加 progressView 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:47:20.520

进度视图的背景颜色几乎不可见。这是带有红色背景颜色的进度视图的图像：

![进度视图](../Images/59379b8e5ba8d418791918e6c5518c1f.png)

就像你看到的那样，红色只是图像的一小部分。
至于如何改变它，设置它的属性就足够了：

```
yourView.backgroundColor=[UIColor redColor];
// make it the color that you wish 
```

如果您想很好地看到它，请将其更改为另一种视图，或更改 progressTintColor 属性。

**编辑**

如果视图没有您想在背景上覆盖的东西，您可以自由地对其进行子类化并在其中绘制。我看了文档，似乎你甚至不需要像 Mac OS X 那样的 UIBezierPath 实例：

```
- (void) drawRect:(CGRect)rect
{
    [[UIColor redColor] set];  
    UIRectFill(rect);
} 
```

# java - 下面代码中的空指针异常

> ID：13405661
> 
> 赞同：0
> 
> 时间：2012-11-15T20:30:41.333
> 
> 标签：java

在下面的代码中，最后一个 sop 没有打印

```
String A=null;

if (A.contains("xyz")) {
    System.out.println("loop1");
}
System.out.println(A); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T20:31:19.397

A 是`null`，你正在打电话`if (A.contains("xyz"))`

`null`对引用结果的任何调用`NullPointerException`，您都没有将上述语句包装在 try/catch 中，因此异常会传播到更高级别，而无需执行下面的代码。

将其更改为：

```
String A=""; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T20:31:21.777

```
if (A.contains("xyz")) { 
```

由于 A 为空，您正试图在 A 上调用 Contains。因此 NPE

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-15T20:31:27.853

由于 A 为 null 上面的代码将抛出一个[NullPointerException](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/NullPointerException.html) (NPE)，它是一个 RuntimeException。

当对 null 执行任何调用时，将引发异常，在您的情况下是 contains 方法调用。

```
A.contains("xyz") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:37:30.140

在`String A=null;`您将字符串引用 A 设置为 null 时。此时你有一个引用，但它还没有指向一个对象。然后，您尝试通过调用该方法来使用引用，就好像它指向一个对象一样`.contains`，这将导致 NullPointerException，因为在引用指向的位置没有要执行的代码。

# javascript - 使用导致 IE 脚本错误的 gridview 更新面板

> ID：13405662
> 
> 赞同：0
> 
> 时间：2012-11-15T20:30:45.157
> 
> 标签：javascript, asp.net, ajax, gridview, updatepanel

我有一个包含 GridView 的更新面板。如果 gridview 中有很多行，则在加载面板和 GridView 时，我会收到错误消息。我只在 IE 中得到错误。

这是一个警告弹出窗口，表明脚本可能导致页面加载缓慢。

我环顾四周，找不到任何方法来防止这种情况发生。如何防止 IE 显示此消息？

# mysql - 为什么这个 WHERE 子句会使我的查询慢 180 倍？

> ID：13405664
> 
> 赞同：9
> 
> 时间：2012-11-15T20:30:48.283
> 
> 标签：mysql

以下查询在 1.6 秒内执行

```
SET @num :=0, @current_shop_id := NULL, @current_product_id := NULL;

#this query limits the results of the query within it by row number (so that only 250 products get displayed per store)

SELECT * FROM (

#this query adds row numbers to the query within it

SELECT *, @num := IF( @current_shop_id = shop_id, IF(@current_product_id=product_id,@num,@num+1), 0) AS row_number, @current_shop_id := shop_id AS shop_dummy, @current_product_id := product_id AS product_dummy FROM (

SELECT shop, shops.shop_id AS
shop_id, p1.product_id AS
product_id 
    FROM products p1 LEFT JOIN #this LEFT JOIN gets the favorites count for each product
  (
  SELECT fav3.product_id AS product_id, SUM(CASE 
    WHEN fav3.current = 1 AND fav3.closeted = 1 THEN 1
    WHEN fav3.current = 1 AND fav3.closeted = 0 THEN -1
    ELSE 0
    END) AS favorites_count
    FROM favorites fav3
GROUP BY fav3.product_id 

  ) AS fav4 ON p1.product_id=fav4.product_id
    INNER JOIN sex ON sex.product_id=p1.product_id AND
    sex.sex=0 AND
    sex.date >= SUBDATE(NOW(),INTERVAL 1 DAY) 
    INNER JOIN shops ON shops.shop_id = p1.shop_id
    ORDER BY shop, sex.DATE, product_id
    ) AS testtable

) AS rowed_results WHERE
rowed_results.row_number>=0 AND
rowed_results.row_number<(7) 
```

添加`AND shops.shop_id=86`到最后的 WHERE 子句会导致查询在 292 秒内执行：

```
SET @num :=0, @current_shop_id := NULL, @current_product_id := NULL;

#this query limits the results of the query within it by row number (so that only 250 products get displayed per store)

SELECT * FROM (

#this query adds row numbers to the query within it

SELECT *, @num := IF( @current_shop_id = shop_id, IF(@current_product_id=product_id,@num,@num+1), 0) AS row_number, @current_shop_id := shop_id AS shop_dummy, @current_product_id := product_id AS product_dummy FROM (

SELECT shop, shops.shop_id AS
shop_id, p1.product_id AS
product_id 
    FROM products p1 LEFT JOIN #this LEFT JOIN gets the favorites count for each product
  (
  SELECT fav3.product_id AS product_id, SUM(CASE 
    WHEN fav3.current = 1 AND fav3.closeted = 1 THEN 1
    WHEN fav3.current = 1 AND fav3.closeted = 0 THEN -1
    ELSE 0
    END) AS favorites_count
    FROM favorites fav3
GROUP BY fav3.product_id 

  ) AS fav4 ON p1.product_id=fav4.product_id
    INNER JOIN sex ON sex.product_id=p1.product_id AND
    sex.sex=0 AND
    sex.date >= SUBDATE(NOW(),INTERVAL 1 DAY)
    INNER JOIN shops ON shops.shop_id = p1.shop_id AND
    shops.shop_id=86
    ORDER BY shop, sex.DATE, product_id
    ) AS testtable

) AS rowed_results WHERE
rowed_results.row_number>=0 AND
rowed_results.row_number<(7) 
```

我原以为限制商店表`AND shops.shop_id=86`会减少执行时间。相反，执行时间似乎取决于 products 表中 products.shop_id 等于指定的 shop.shop_id 的行数。products.shop_id=86 的 products 表中大约有 34K 行，执行时间为 292 秒。products.shop_id=50 大约有 28K 行，执行时间为 210 秒。products.shop_id=175，大约有2K行，执行时间为2.8秒。到底是怎么回事？

1.6 秒查询的 EXPLAIN EXTENDED 是：

```
id  select_type table   type    possible_keys   key key_len ref rows    filtered    Extra
1   PRIMARY <derived2>  ALL NULL    NULL    NULL    NULL    1203    100.00  Using where
2   DERIVED <derived3>  ALL NULL    NULL    NULL    NULL    1203    100.00  
3   DERIVED sex ALL product_id_2,product_id NULL    NULL    NULL    526846  75.00   Using where; Using temporary; Using filesort
3   DERIVED p1  eq_ref  PRIMARY,shop_id,shop_id_2,product_id,shop_id_3  PRIMARY 4   mydatabase.sex.product_id   1   100.00  
3   DERIVED <derived4>  ALL NULL    NULL    NULL    NULL    14752   100.00  
3   DERIVED shops   eq_ref  PRIMARY PRIMARY 4   mydatabase.p1.shop_id   1   100.00  
4   DERIVED fav3    ALL NULL    NULL    NULL    NULL    15356   100.00  Using temporary; Using filesort 
```

此 EXPLAIN EXTENDED 的 SHOW WARNINGS 是

```
-----+
| Note | 1003 | select `rowed_results`.`shop` AS `shop`,`rowed_results`.`shop_id` AS `shop_id`,`rowed_results`.`product_id` AS `product_id`,`rowed_results`.`row_number` AS `row_number`,`rowed_results`.`shop_dummy` AS `shop_dummy`,`rowed_results`.`product_dummy` AS `product_dummy` from (select `testtable`.`shop` AS `shop`,`testtable`.`shop_id` AS `shop_id`,`testtable`.`product_id` AS `product_id`,(@num:=if(((@current_shop_id) = `testtable`.`shop_id`),if(((@current_product_id) = `testtable`.`product_id`),(@num),((@num) + 1)),0)) AS `row_number`,(@current_shop_id:=`testtable`.`shop_id`) AS `shop_dummy`,(@current_product_id:=`testtable`.`product_id`) AS `product_dummy` from (select `mydatabase`.`shops`.`shop` AS `shop`,`mydatabase`.`shops`.`shop_id` AS `shop_id`,`mydatabase`.`p1`.`product_id` AS `product_id` from `mydatabase`.`products` `p1` left join (select `mydatabase`.`fav3`.`product_id` AS `product_id`,sum((case when ((`mydatabase`.`fav3`.`current` = 1) and (`mydatabase`.`fav3`.`closeted` = 1)) then 1 when ((`mydatabase`.`fav3`.`current` = 1) and (`mydatabase`.`fav3`.`closeted` = 0)) then -(1) else 0 end)) AS `favorites_count` from `mydatabase`.`favorites` `fav3` group by `mydatabase`.`fav3`.`product_id`) `fav4` on(((`mydatabase`.`p1`.`product_id` = `mydatabase`.`sex`.`product_id`) and (`fav4`.`product_id` = `mydatabase`.`sex`.`product_id`))) join `mydatabase`.`sex` join `mydatabase`.`shops` where ((`mydatabase`.`sex`.`sex` = 0) and (`mydatabase`.`p1`.`product_id` = `mydatabase`.`sex`.`product_id`) and (`mydatabase`.`shops`.`shop_id` = `mydatabase`.`p1`.`shop_id`) and (`mydatabase`.`sex`.`date` >= (now() - interval 1 day))) order by `mydatabase`.`shops`.`shop`,`mydatabase`.`sex`.`date`,`mydatabase`.`p1`.`product_id`) `testtable`) `rowed_results` where ((`rowed_results`.`row_number` >= 0) and (`rowed_results`.`row_number` < 7)) |
+------ 
```

292 秒查询的 EXPLAIN EXTENDED 是：

```
id  select_type table   type    possible_keys   key key_len ref rows    filtered    Extra
1   PRIMARY <derived2>  ALL NULL    NULL    NULL    NULL    36  100.00  Using where
2   DERIVED <derived3>  ALL NULL    NULL    NULL    NULL    36  100.00  
3   DERIVED shops   const   PRIMARY PRIMARY 4       1   100.00  Using temporary; Using filesort
3   DERIVED p1  ref PRIMARY,shop_id,shop_id_2,product_id,shop_id_3  shop_id 4       11799   100.00  
3   DERIVED <derived4>  ALL NULL    NULL    NULL    NULL    14752   100.00  
3   DERIVED sex eq_ref  product_id_2,product_id product_id_2    5   mydatabase.p1.product_id    1   100.00  Using where
4   DERIVED fav3    ALL NULL    NULL    NULL    NULL    15356   100.00  Using temporary; Using filesort 
```

此 EXPLAIN EXTENDED 的 SHOW WARNINGS 是

```
----+ 
| Note | 1003 | select `rowed_results`.`shop` AS `shop`,`rowed_results`.`shop_id` AS `shop_id`,`rowed_results`.`product_id` AS `product_id`,`rowed_results`.`row_number` AS `row_number`,`rowed_results`.`shop_dummy` AS `shop_dummy`,`rowed_results`.`product_dummy` AS `product_dummy` from (select `testtable`.`shop` AS `shop`,`testtable`.`shop_id` AS `shop_id`,`testtable`.`product_id` AS `product_id`,(@num:=if(((@current_shop_id) = `testtable`.`shop_id`),if(((@current_product_id) = `testtable`.`product_id`),(@num),((@num) + 1)),0)) AS `row_number`,(@current_shop_id:=`testtable`.`shop_id`) AS `shop_dummy`,(@current_product_id:=`testtable`.`product_id`) AS `product_dummy` from (select 'shop.nordstrom.com' AS `shop`,'86' AS `shop_id`,`mydatabase`.`p1`.`product_id` AS `product_id` from `mydatabase`.`products` `p1` left join (select `mydatabase`.`fav3`.`product_id` AS `product_id`,sum((case when ((`mydatabase`.`fav3`.`current` = 1) and (`mydatabase`.`fav3`.`closeted` = 1)) then 1 when ((`mydatabase`.`fav3`.`current` = 1) and (`mydatabase`.`fav3`.`closeted` = 0)) then -(1) else 0 end)) AS `favorites_count` from `mydatabase`.`favorites` `fav3` group by `mydatabase`.`fav3`.`product_id`) `fav4` on(((`fav4`.`product_id` = `mydatabase`.`p1`.`product_id`) and (`mydatabase`.`sex`.`product_id` = `mydatabase`.`p1`.`product_id`))) join `mydatabase`.`sex` join `mydatabase`.`shops` where ((`mydatabase`.`sex`.`sex` = 0) and (`mydatabase`.`sex`.`product_id` = `mydatabase`.`p1`.`product_id`) and (`mydatabase`.`p1`.`shop_id` = 86) and (`mydatabase`.`sex`.`date` >= (now() - interval 1 day))) order by 'shop.nordstrom.com',`mydatabase`.`sex`.`date`,`mydatabase`.`p1`.`product_id`) `testtable`) `rowed_results` where ((`rowed_results`.`row_number` >= 0) and (`rowed_results`.`row_number` < 7)) | 
+----- 
```

我正在运行 MySQL 客户端版本：5.1.56。商店表在 shop_id 上有一个主索引：

```
Action  Keyname Type    Unique  Packed  Column  Cardinality Collation   Null    Comment
 Edit    Drop   PRIMARY BTREE   Yes No  shop_id 163 A 
```

我已经分析了商店表，但这没有帮助。

我注意到，如果我删除`LEFT JOIN`执行时间的差异，则会下降到 0.12 秒而不是 0.28 秒。

Cez 的解决方案，即使用 1.6 秒版本的查询并通过添加`rowed_results.shop_dummy=86`到外部查询（如下所示）来删除不相关的结果，在 1.7 秒内执行。这规避了这个问题，但为什么 292 秒查询如此缓慢仍然是个谜。

```
SET @num :=0, @current_shop_id := NULL, @current_product_id := NULL;

#this query limits the results of the query within it by row number (so that only 250 products get displayed per store)

SELECT * FROM (

#this query adds row numbers to the query within it

SELECT *, @num := IF( @current_shop_id = shop_id, IF(@current_product_id=product_id,@num,@num+1), 0) AS row_number, @current_shop_id := shop_id AS shop_dummy, @current_product_id := product_id AS product_dummy FROM (

SELECT shop, shops.shop_id AS
shop_id, p1.product_id AS
product_id 
    FROM products p1 LEFT JOIN #this LEFT JOIN gets the favorites count for each product
  (
  SELECT fav3.product_id AS product_id, SUM(CASE 
    WHEN fav3.current = 1 AND fav3.closeted = 1 THEN 1
    WHEN fav3.current = 1 AND fav3.closeted = 0 THEN -1
    ELSE 0
    END) AS favorites_count
    FROM favorites fav3
GROUP BY fav3.product_id 

  ) AS fav4 ON p1.product_id=fav4.product_id
    INNER JOIN sex ON sex.product_id=p1.product_id AND sex.sex=0
    INNER JOIN shops ON shops.shop_id = p1.shop_id
    WHERE sex.date >= SUBDATE(NOW(),INTERVAL 1 DAY) 

    ORDER BY shop, sex.DATE, product_id
    ) AS testtable

) AS rowed_results WHERE
rowed_results.row_number>=0 AND
rowed_results.row_number<(7) AND
rowed_results.shop_dummy=86; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T02:55:27.493

您应该将 shop.shop_id=86 移动到商店的 JOIN 条件。没有理由把它放在 JOIN 之外，你冒着 MySQL JOINing 的风险，然后过滤。JOIN 可以完成与 WHERE 子句相同的工作，尤其是在您不引用其他表的情况下。

```
....
INNER JOIN shops ON shops.shop_id = p1.shop_id AND shops.shop_id=86
.... 
```

与性别加入相同的事情：

```
...
INNER JOIN shops ON shops.shop_id = p1.shop_id
AND sex.date >= SUBDATE(NOW(),INTERVAL 1 DAY)
... 
```

派生表很棒，但它们没有索引。通常这无关紧要，因为它们通常在 RAM 中。但是在没有索引的过滤和排序之间，事情可以加起来。

请注意，在花费更长的第二个查询中，表处理顺序发生了变化。shop 表在慢查询中位于顶部，p1 表在快速查询中检索 11799 行而不是 1 行。它也不再使用主键。这很可能是你的问题所在。

```
3   DERIVED p1  eq_ref  PRIMARY,shop_id,shop_id_2,product_id,shop_id_3  PRIMARY 4   mydatabase.sex.product_id   1   100.00  

3   DERIVED p1  ref PRIMARY,shop_id,shop_id_2,product_id,shop_id_3  shop_id 4       11799   100.00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T01:47:42.587

在聊天室之后，实际上创建了表/列来匹配查询，我想出了以下查询。

我已经开始我最内心的查询是关于性别、产品（对于 shop_id）和收藏夹表。由于您描述了 ShopA 的 ProductX = Product ID = 1 但 ShopB 的 ProductX = 产品 ID = 2（仅作为示例），因此每个商店的每个产品始终是唯一的，并且从不重复。也就是说，我可以在此查询中获取产品和 shop_id 以及收藏夹数量（如果有），但仅对 product_id 进行分组 .. 因为我使用 MAX() 的每个产品都不会更改 shop_id。由于您总是按“昨天”和性别（sex=0 女性）的日期查找，因此我会将 SEX 表编入索引（日期、性别、product_id）...我猜您不会每添加 1000 个项目天... 产品显然会在 product_id（主键）上有一个索引，而收藏夹应该在 product_id 上有一个索引。

然后，根据该结果（别名“sxFav”），我们可以通过该“Product_ID”直接连接到性别和产品表，以获取您可能想要的任何其他信息，例如商店名称、添加产品的日期、产品描述等. 然后，此结果按产品销售的 shop_id、日期和最后的产品 ID 排序（但您可以考虑在内部查询中获取描述列并将其用作排序依据）。这导致别名“PreQuery”。

由于商店的订单都是正确的，我们现在可以添加 @MySQLVariable 引用来为每个产品分配一个类似于您最初尝试的行号。但是，仅当商店 ID 更改时才重置回 1。

```
SELECT 
      PreQuery.*,
      @num := IF( @current_shop_id = PreQuery.shop_id, @num +1, 1 ) AS RowPerShop, 
      @current_shop_id := PreQuery.shop_id AS shop_dummy 
   from 
      ( SELECT 
              sxFav.product_id, 
              sxFav.shop_id, 
              sxFav.Favorites_Count
           from 
              ( SELECT 
                      sex.product_id,
                      MAX( p.shop_id ) shop_id,
                      SUM( CASE WHEN F.current = 1 AND F.closeted = 1 THEN 1 
                                WHEN F.current = 1 AND F.closeted = 0 THEN -1 
                                ELSE 0 END ) AS favorites_count 
                   from 
                      sex
                         JOIN products p
                            ON sex.Product_ID = p.Product_ID
                         LEFT JOIN Favorites F 
                            ON sex.product_id = F.product_ID 
                   where 
                          sex.date >= subdate( now(), interval 1 day) 
                      and sex.sex = 0 
                   group by 
                      sex.product_id ) sxFav 

              JOIN sex 
                 ON sxFav.Product_ID = sex.Product_ID

              JOIN products p
                 ON sxFav.Product_ID = p.Product_ID
      order by 
         sxFav.shop_id, 
         sex.date, 
         sxFav.product_id ) PreQuery,

     ( select @num :=0, 
              @current_shop_id := 0 ) as SQLVars 
```

现在，如果您正在寻找特定的“分页”信息（例如每个商店 7 个条目），请将上面的 ENTIRE 查询包装成类似...

```
select * from ( entire query above ) where RowPerShop between 1 and 7 
```

（或根据需要在 8 和 14、15 和 21 等之间）甚至

```
RowPerShop between RowsPerPage*PageYouAreShowing and RowsPerPage*(PageYouAreShowing +1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T00:53:45.023

从讨论来看，查询规划器在指定较低级别的商店时表现不佳。

添加`rowed_results.shop_dummy=86`到外部查询以获取您正在寻找的结果。

# cakephp - 具有共享功能的 CakePHP 多站点文件系统组织

> ID：13405670
> 
> 赞同：0
> 
> 时间：2012-11-15T20:31:05.453
> 
> 标签：cakephp, vendors

我在服务器中有一个 CakePHP 1.3 多站点安装。每个站点都有自己的文件夹，它们都从同一个地方加载 CakePHP 核心库。这是它的样子：

*   [cake]（cake 的核心库）
*   [网站]
    *   [网站 1]
        *   [应用程序]
        *   [插件]
        *   [供应商]
        *   .htaccess
        *   索引.php
    *   [站点 2] *（也有自己的应用程序、插件和供应商文件夹）*
    *   [站点 3] *（也有自己的应用程序、插件和供应商文件夹）*
    *   *ETC*

我发现自己很多时候都想实现一些我想在所有应用程序中使用的功能，但到目前为止，我只是在每个站点中复制代码。我希望能够在一个地方声明这些函数并能够从任何站点调用它们。我相信**供应商**可能与此有关，但我一直在查看食谱，但我不知道如何在我的情况下使用它。

任何帮助将非常感激！

**更新**

因此，通过查看供应商，在我看来（也许我错了）如果这些供应商文件中的函数不需要直接与其他 CakePHP 类（例如 Session、Auth、 ETC）。我将举一个我正在尝试做的事情的例子，也许这有助于更好地理解我正在尝试的事情。

每个站点都有自己的登录系统（使用 cake 的**Auth**）。我想做的一件事是，当用户登录时（调用 UsersController 中的 login() 函数），有一个函数对用户的用户名进行一些处理，然后调用**Session->flash ()**函数在其中插入一条消息（消息根据函数进行的处理而变化）。所以这个函数需要用到**User**模型和**Session**模型。

我可以使用供应商来做到这一点，所以我在供应商中声明了这个函数（即**processLogin()**），并且所有站点都可以使用该函数吗？如果是这样，怎么做？如果没有，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:40:07.230

将它们粘贴在**cake**和**sites**同一级别的**vendor**文件夹中，以您选择的名称（通常是代理名称或其他唯一标识符）命名空间。

 ****在 CakePHP 1.3 中加载供应商文件的示例在此处的 Cookbook 中进行了说明：http: [//book.cakephp.org/1.3/en/view/943/Loading-Vendor-Files](http://book.cakephp.org/1.3/en/view/943/Loading-Vendor-Files)

但是，我建议升级到 CakePHP 2，并将您的代码放在**lib**下的子文件夹中。****

# javascript - 使用 jQuery 在更改后保留元素的值

> ID：13405673
> 
> 赞同：0
> 
> 时间：2012-11-15T20:31:09.290
> 
> 标签：javascript, jquery, internationalization

对于国际化支持，我编写了从`#lang-select`下拉列表更改 URL 的代码。代码是

```
$(document).ready(function(){
   var sel = document.getElementById('lang-select');
    sel.onchange = function(){window.location.replace($('#lang-select').val());};
 }); 
```

上面的代码工作正常，它将 URL 从 更改`http://0.0.0.0:3000/fr`为`http://0.0.0.0:3000/en`。现在我想保留更改后的值，但没有成功。我已经写了下面的代码。我不知道为什么它是错误的/不起作用。

```
function langSelect(){
var available_languages = {
    "en":"English",
    "de":"Deutsch",
    "ru" :"Россию",
    "fr" : "Française"
};
var languageInUrl= document.URL.split("/")[3];
for(var shortLanguage in available_languages){
    if(shortLanguage === languageInUrl) {
        var langaugeOptionArray = $("#lang-select>option");
        for(var i = 0 ; langaugeOptionArray.length > i ; i++){
            if(langaugeOptionArray[i].label === available_languages[shortLanguage]){
                langaugeOptionArray[i].selected = true;
                return;
            }
        }
    }
  }
} 
```

请告诉我上面的代码有什么问题，因为我所做的不是新事物，请分享克服这种情况的最佳实践。

目前，我正在使用后端来完成此任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:52:49.813

```
$(function() {
  $('#lang-select').on("change",function(){   
    window.location.replace($(this).val());
  }); 
});

function langSelect(){
  var available_languages = {
    "en":"English",
    "de":"Deutsch",
    "ru" :"Россию",
    "fr" : "Française"
  };
  var languageInUrl= document.URL.split("/")[3];
  var lang = available_languages[languageInUrl];
  if (lang) {
    var langaugeOptionArray = $("#lang-select>option");
    langaugeOptionArray.each(function() {
      if($(this).text() === lang){
        $("#lang-select").val(lang);
        return false;
      }
    });
  }
} 
```

我相信我们甚至可以做到

```
if (lang) {
  var opt = $("#lang-select").find('option[text="'+lang+'"]').val();
  if (opt) $("#lang-select").val(opt); 
} 
```

祝你好运

# c# - 从 Dynamics CRM 2011 更新外部系统

> ID：13405674
> 
> 赞同：0
> 
> 时间：2012-11-15T20:31:09.557
> 
> 标签：c#, dynamics-crm, dynamics-crm-2011, dynamics-crm-4

对 Dynamics CRM 有点陌生，并试图找到在 Dynamics CRM 4.0 或 2011 中创建或更新特定实体时**实时**更新外部系统的最佳方法。到目前为止，我收集到的最好的选择是

1.  为下游 LOB 系统编写一个 Web 服务。
2.  编写调用 Web 服务的自定义工作流活动并在 CRM 中注册插件。
3.  将自定义工作流活动附加到我想要接收更新的基础实体上的记录创建/更新触发器。

我是在正确的轨道上还是有更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:32:53.103

你所拥有的似乎是一个非常合理的设计，并且可能是我接近它的方式。

如果您需要同步行为（不确定您的实际时间有多实时），您可能需要考虑插件（不同于自定义工作流活动），因为这些插件可以注册为同步运行。

除此之外，您可以让下游系统定期从 CRM 读取记录 - 您可以使用 modifiedon 字段查看自上次读取以来哪些记录发生了更改。

# c# - vb.net 人工作用域

> ID：13405675
> 
> 赞同：4
> 
> 时间：2012-11-15T20:31:12.133
> 
> 标签：c#, .net, vb.net, syntax, c#-to-vb.net

在 VB.Net 4.0 中，我有需要重复类似代码的情况，但由于代码的复杂性，我将无法创建子例程来简化。我希望能够在块范围内声明变量，超出范围，然后重复。我目前的方法是做这样的事情。

```
If True Then
  Dim A = ...
  Dim B = ...
  (Code using A & B)
End If 
```

...然后尽可能多地重复。

这个也有用。。。

```
Try
  Dim A = ...
  Dim B = ...
  (Code using A & B)
Finally
End Try 
```

否则我必须给每个变量唯一的名字......

```
Dim A1 = ...
Dim B1 = ...
(Code using A1 and B1)
Dim A2 = ...
Dim B2 = ...
(Code using A2 and B2) 
```

...这使得重复代码很危险，因为我在复制代码时可能会忘记更改变量名。

你可以在 C# 中做到这一点...

```
{
  int A = ...
  int B = ...
  (Code using A & B)
} 
```

VB.Net 中有没有办法以这种方式创建块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T23:08:33.383

我在一个日本网站上找到了这个答案。

```
With Nothing
  Dim A = ...
  Dim B = ...
  (Code using A & B)
End With 
```

来自[http://www.ilovex.co.jp/Division/ITD/archives/2007/11/with_nothing.html](http://www.ilovex.co.jp/Division/ITD/archives/2007/11/with_nothing.html)

> （译自日文）我想如果我们考虑一下，用一个With语句来说明它是否不是一个更好的。因为，With 语句的目的是为了省略代码，因为它不打算从语句本身进行关联处理。

所以重点是，“With”语句除了包含快捷方式的代码外，并没有真正做任何事情。但是，它确实创建了一个独特的范围。这似乎在编译器中应该很轻。虽然我很想看到一些像“开始/结束”这样的新语句，但我将从现在开始使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:37:44.817

VB.Net 中没有固有的块范围语法，最常见的方法是您在问题中给出的第一个示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:41:47.057

好吧，这是hacky hacky，但是怎么样：

```
Do
  dim a
  dim b

  ...

loop while (false) 
```

有点像你的 if 语句，但你可以使用 false 常量。

# java - 在 GWT 中检索 Google 用户信息时出现 OAuth 2.0 身份验证错误

> ID：13405680
> 
> 赞同：0
> 
> 时间：2012-11-15T20:31:23.473
> 
> 标签：java, google-app-engine, gwt, oauth-2.0

我对请求编程不是很熟悉，所以我会尽量简洁，我可能会描述我的问题。

我正在尝试获取可用于获取 Google 帐户的用户信息的身份验证令牌。我成功获得了这种形式的令牌：[https](https://oauth2-login-demo.appspot.com/oauthcallback#access_token=) : //oauth2-login-demo.appspot.com/oauthcallback#access_token= {accesstoken}&token_type=Bearer&expires_in=3600

然后我按照本教程的 TODO#11：[http ://www.sw-engineering-candies.com/blog-1/howtogetuserinformationwithoauth2inagwtandgoogleappenginejavaapplication](http://www.sw-engineering-candies.com/blog-1/howtogetuserinformationwithoauth2inagwtandgoogleappenginejavaapplication)

```
@Override
public LoginInfo loginDetails(final String token) {
    String url = "https://www.googleapis.com/oauth2/v1/userinfo?alt=json&access_token=" 
        + token;

    final StringBuffer r = new StringBuffer();
    try {
        final URL u = new URL(url);
        final URLConnection uc = u.openConnection();
        final int end = 1000;
        InputStreamReader isr = null;
        BufferedReader br = null;
        try {
            isr = new InputStreamReader(uc.getInputStream());
            br = new BufferedReader(isr);
            final int chk = 0;
            while ((url = br.readLine()) != null) {
                if ((chk >= 0) && ((chk < end))) {
                    r.append(url).append('\n');
                }
            }
        } catch (final java.net.ConnectException cex) {
            r.append(cex.getMessage());
        } catch (final Exception ex) {
            log.log(Level.SEVERE, ex.getMessage());
        } finally {
            try {
                br.close();
            } catch (final Exception ex) {
                log.log(Level.SEVERE, ex.getMessage());
            }
        }
    } catch (final Exception e) {
        log.log(Level.SEVERE, e.getMessage());
    }

    final LoginInfo loginInfo = new LoginInfo();
    try {
        final JsonFactory f = new JsonFactory();
        JsonParser jp;
        jp = f.createJsonParser(r.toString());
        jp.nextToken();
        while (jp.nextToken() != JsonToken.END_OBJECT) {
            final String fieldname = jp.getCurrentName();
            jp.nextToken();
            if ("picture".equals(fieldname)) {
                loginInfo.setPictureUrl(jp.getText());
            } else if ("name".equals(fieldname)) {
                loginInfo.setName(jp.getText());
            } else if ("email".equals(fieldname)) {
                loginInfo.setEmailAddress(jp.getText());
            }
        }
    } catch (final JsonParseException e) {
        log.log(Level.SEVERE, e.getMessage());
    } catch (final IOException e) {
        log.log(Level.SEVERE, e.getMessage());
    }
    return loginInfo;
} 
```

运行该代码时，我遇到了一个错误：

```
WARNING: Authentication error: Unable to respond to any of these challenges: {googlelogin=WWW-Authenticate: GoogleLogin realm="https://www.google.com/accounts/ClientLogin", service="lso"}
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "required",
    "message": "Login Required",
    "locationType": "header",
    "location": "Authorization"
   }
  ],
  "code": 401,
  "message": "Login Required"
 }
} 
```

我在 GWT 中以开发模式运行。我也尝试部署和运行，但它也发现了一些错误。

一些可能的原因可能是：1）我的令牌超时（但我刚刚得到它）2）我必须先部署？3）我没有正确执行这些步骤？（拿到令牌后，我必须先验证它？我该怎么做？）

我不太确定如何从这里开始。希望能得到社区的一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T06:19:35.570

这是一个字符串连接错误。该变量没有持有有效的令牌。

# ios - libc++abi.dylib：处理程序抛出异常——但 XCode 中没有堆栈跟踪

> ID：13405684
> 
> 赞同：3
> 
> 时间：2012-11-15T20:31:37.237
> 
> 标签：ios, xcode, debugging, gcc, llvm

我正在使用带有 LLVM 的 XCode 4.5。在旧版本的 XCode 中，当发生崩溃时，它会给我有意义的调试信息。最近我不断遇到崩溃，只是说“libc++abi.dylib：处理程序抛出异常”，并且没有提供显示异常来自何处的堆栈跟踪。这对我来说完全没用。我应该设置哪些正确的调试设置才能找到问题的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:54:40.547

您可以添加一个断点并将其设置为在所有异常上中断

# mysql - Cpanel sql备份失败

> ID：13405686
> 
> 赞同：1
> 
> 时间：2012-11-15T20:31:45.513
> 
> 标签：mysql, innodb, mysqldump, cpanel, myisam

我的托管服务提供商每天自动进行完整站点备份，就像您可以使用 Cpanel 进行的备份一样。在请求其中一个文件后，我注意到该`mysql`文件夹​​包含具有我所有数据库名称的文件，但所有文件的大小均为 0 KB。

我从导出脚本中获得了一些日志：

```
ERROR: Failed to dump one or more databases

warn [pkgacct] db_1: mysqldump: unknown variable 'innodb_file_per_table=1'

warn [pkgacct] db_1: mysqldump failed -- database may be corrupt
(0 bytes) warn [pkgacct] Failed to dump database db_1
db_wp2warn [pkgacct] db_wp2: mysqldump: unknown variable 'innodb_file_per_table=1'

warn [pkgacct] db_wp2: mysqldump: unknown variable 'innodb_file_per_table=1'

db_wp2.dev_commentmeta
note     : The storage engine for the table doesn't support repair 
```

我什至没有使用任何 innodb 表（它们都是 MyISAM），我不明白`mysqldump: unknown variable 'innodb_file_per_table=1'`指的是什么。任何想法如何在不影响数据的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T08:34:33.607

```
innodb_file_per_table=1 
```

此行很可能在您的`/etc/my.cnf`文件中。删除该行或将其注释掉并重新启动mysql，这应该可以解决它。

# c# - SharpSquare api 的 Foursquare (411) 长度要求错误

> ID：13405687
> 
> 赞同：0
> 
> 时间：2012-11-15T20:31:46.603
> 
> 标签：c#, api, foursquare

我们一直在使用 Foursquare SharpSquare api 来成功添加签到。我们最近注意到我们收到“(411) 长度要求”错误。我们现在大部分时间都会收到此错误，但偶尔它会成功发布。修复此错误的普遍共识似乎是将 Content-Length=0 添加到标题中，但我不确定 SharpSquare 是否可以这样做。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T19:08:40.587

听起来 SharpSquare api 没有正确添加 Content-length 标头。如果使用 SharpSquare API 无法做到这一点，您可能需要更新 SharpSquare 源以便正确执行，或者在不使用 SharpSquare API 的情况下制作自己的 HTTP 请求。

# android - 公共类必须在自己的文件中定义

> ID：13405691
> 
> 赞同：1
> 
> 时间：2012-11-15T20:32:13.207
> 
> 标签：android, class

我试图在一个应用程序中使用两个视图来计算用户的行星重量。在重写了 java 几次之后，我终于让它工作了......主要是，但是在公共类 Planets 上它告诉我“公共类型的行星必须在它自己的文件中定义。” 我进入清单并为它做了一个活动，但这没有任何帮助。Planets 已经是我的一个 xml 文件的名称。如何将公共类型放入自己的文件中？

活动主.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/askwtTextView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="17dp"
    android:layout_marginTop="19dp"
    android:text="@string/askwt" />

<EditText
    android:id="@+id/inputwtEditText"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/askwtTextView"
    android:layout_below="@+id/askwtTextView"
    android:layout_marginTop="26dp"
    android:ems="10"
    android:inputType="numberDecimal" />

<Button
    android:id="@+id/enterButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/inputwtEditText"
    android:layout_below="@+id/inputwtEditText"
    android:layout_marginTop="38dp"
    android:onClick="buttonclick"
    android:text="@string/enter" />

</RelativeLayout> 
```

行星.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/planetTextView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/planet" />

<TextView
    android:id="@+id/textViewform2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="" />

<RadioGroup
    android:id="@+id/radioGroup1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <RadioButton
        android:id="@+id/mercuryRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="@string/mercury" />

    <RadioButton
        android:id="@+id/venusRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/venus" />

    <RadioButton
        android:id="@+id/earthRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/earth" />

    <RadioButton
        android:id="@+id/marsRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="@string/mars" />

    <RadioButton
        android:id="@+id/jupiterRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/jupiter" />

    <RadioButton
        android:id="@+id/saturnRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/saturn" />

    <RadioButton
        android:id="@+id/uranusRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="@string/uranus" />

    <RadioButton
        android:id="@+id/neptuneRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/neptune" />

    <RadioButton
        android:id="@+id/plutoRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/pluto" />
</RadioGroup>

<Button
    android:id="@+id/selectButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:onClick="buttonclick2"
    android:text="@string/select" />

<TextView
    android:id="@+id/textViewform2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     />

</LinearLayout 
```

爪哇：

```
package com.deitel.planetaryweight;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.widget.*;
import android.view.View;
import android.view.Menu;
import android.widget.Button;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.EditText;
import android.widget.TextView;
import java.text.DecimalFormat;

public class MainActivity extends Activity {

/* You should get used to declaring everything with the correct visibility.  Good  practice is to make everything private and use public mutator methods */
//Global variable
private double weight;
private Button enter;  // creates a button 

// Views
private EditText wtEntry;
private TextView txtForm2;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //Start with first screen
    setContentView(R.layout.activity_main);

    enter = (Button) findViewById(R.id.enterButton);

    //creates an editext and assigns the resource id of the xml edittext.
    wtEntry = (EditText)findViewById(R.id.inputwtEditText);
    txtForm2 = (TextView)findViewById(R.id.textViewform2);
}
// Button clicks shouldn't do anything but perform clicky actions. Leave field initialization, view creation, etc to the Activity.
//buttonclick for form 1
public void buttonclick(View view){
    //Receives the input from the edittext, converts it to a double (number).
    weight = Double.parseDouble(wtEntry.getText().toString());

    TextView t2 = null;
//change the value of the textview on screen 2 to the calculation value
   t2.setText(Double.toString(weight));

   // If you want a new layout, it's best to start a new activity.
   // It looks like you want to get information back, so use startActivityForResult().
   // setContentView(R.layout.planets);
   Intent dataIntent = new Intent(this, Planets.class);
   dataIntent.putExtra("com.deitel.identifier.DATA_WEIGHT", weight);
   startActivityForResult(dataIntent, Activity.RESULT_OK);
}
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    // Check that the resultCode is the same as we started the activity with
    if(resultCode == Activity.RESULT_OK){
        // get the double from the Intent, using the same string name (package  prefixed)
        // or a default value if it didn't get set.
        double resultWeight =  data.getDoubleExtra("com.deitel.identifier.RESULT_WEIGHT", 0.0);

        // Now do something with resultWeight
    }
}
}
// PlanetChooser.class
public class Planets extends Activity {
// constants, usually denoted by uppercase and declared static and final
public static final double MERCURYFORCE = 0.38; 
public static final double VENUSFORCE = 0.91; 
public static final double EARTHFORCE = 1.00; 
public static final double MARSFORCE = 0.38; 
public static final double JUPITERFORCE = 2.34; 
public static final double SATURNFORCE = 1.06; 
public static final double URANUSFORCE = 0.92;
public static final double NEPTUNEFORCE = 1.19;
public static final double PLUTOFORCE = 0.06;

private RadioButton mercury, venus, earth, mars, jupiter, saturn, uranus, neptune, pluto;

// No need to use the Double object as opposed to the primitive unless you have good reason
private double mercurypf, venuspf, earthpf, marspf, jupiterpf, saturnpf, uranuspf,  neptunepf, plutopf, weight;

// One variable will suffice, it seems.
private double resultForce;

public void onCreate(Bundle s){
    super.onCreate(s);
    setContentView(R.layout.planets);

    mercury = (RadioButton) findViewById(R.id.mercuryRadio);
    venus = (RadioButton) findViewById(R.id.venusRadio);
    earth = (RadioButton) findViewById(R.id.earthRadio);            
    mars = (RadioButton) findViewById(R.id.marsRadio);
    jupiter = (RadioButton) findViewById(R.id.jupiterRadio);
    saturn = (RadioButton) findViewById(R.id.saturnRadio);
    uranus = (RadioButton) findViewById(R.id.uranusRadio);
    neptune = (RadioButton) findViewById(R.id.neptuneRadio);
    pluto = (RadioButton) findViewById(R.id.plutoRadio);
}
public void buttonclick2(View view){
    /*
    It looks to me here you're looking to see which box is checked, and set a value  based on 
    that planet.  Since instance variables (in this case mercurypf, jupiterpf, etc) are  initialized
    to the default value (0), there's no need to set them manually.
    */

    // Code used to determine which planet RadioButton is checked:
    if(mercury.isChecked())    {
        resultForce = MERCURYFORCE * weight;
    }
    if(venus.isChecked()){
        resultForce = VENUSFORCE * weight;
    }
    if(earth.isChecked()){
        resultForce = EARTHFORCE * weight;
    }
    if(mars.isChecked()){
        resultForce = MARSFORCE * weight;
    }
    if(jupiter.isChecked()){
        resultForce =JUPITERFORCE * weight;
    }
    if(saturn.isChecked()){
        resultForce = SATURNFORCE * weight;
    }
    if(uranus.isChecked()){
        resultForce = URANUSFORCE * weight;
    }
    if(neptune.isChecked()){
        resultForce = NEPTUNEFORCE * weight;
    }
    if(pluto.isChecked()){
        resultForce = PLUTOFORCE * weight;
    }
    // Create a new data Intent to pass back to the calling activity, set the result  code, 
    // and manually finish() this activity.
    Intent dataIntent = new Intent(this, null);
    dataIntent.getDoubleExtra("com.deitel.identifier.RESULT_DATA", resultForce);
    setResult(Activity.RESULT_OK, dataIntent);
    finish();
}
} 
```

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.deitel.planetaryweight"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name="Planets" android:label="@string/title_planets"></activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T20:35:44.537

您的 Java 文件名为 MainActivity.java（它定义的公共类的名称）。从中删除 Planets 类，并将该类放入 Planets.java 文件中。这几乎就是 Java 想要的样子。

# c++ - 移动赋值运算符内的 std::move

> ID：13405699
> 
> 赞同：7
> 
> 时间：2012-11-15T20:32:47.040
> 
> 标签：c++, c++11, move

[我在另一个问题](https://stackoverflow.com/a/5976829/440509)中读到，在实现移动构造函数时，std::move 初始化器列表中的每个成员是一个好习惯，因为如果该成员恰好是另一个对象，那么将调用该对象的移动构造函数。像这样...

```
//Move constructor
Car::Car(Car && obj)
    : 
    prBufferLength(std::move(obj.prBufferLength)), 
    prBuffer(std::move(obj.prBuffer)) 
{
    obj.prBuffer = nullptr;
    obj.prBufferLength = 0;
} 
```

然而，在我见过的所有示例移动赋值运算符中，出于同样的原因，没有提到使用 std::move 。如果成员是一个对象，那么应该使用 std::move 吗？像这样...

```
//Move assignment
Car Car::operator=(Car && obj)  
{
    delete[] prBuffer;

    prBufferLength = std::move(obj.prBufferLength);
    prBuffer = std::move(obj.prBuffer);

    obj.prBuffer = nullptr;
    obj.prBufferLength = 0;
    return *this;
} 
```

**更新：**

我很欣赏在我选择的示例中不需要使用 std::move （差）但是我对成员是否是对象感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:05:07.643

在阅读了链接的问题之后，我可以看到第二个最受好评的答案中的建议是`std::move`在移动构造函数的初始化列表中使用，因为无论它是否是原始类型，它都会做正确的事情。我有点不同意这一点，并认为你应该只`std::move`在适当的时候打电话，但这是个人喜好。

此外，对于您的移动分配操作员，您拥有它的方式很好，尽管我认为`std::move`应该亲自删除不必要的调用。另一种选择是使用`std::swap`哪个会为您做正确的事情。

```
Car Car::operator=(Car && obj)  
{
    std::swap(this->prBufferLength, obj.prBufferLength);
    std::swap(this->prBuffer, obj.prBuffer); 
    return *this;
} 
```

上述移动赋值运算符和您的移动赋值运算符之间的区别在于，内存的释放会*延迟*，而您的版本会立即释放内存，这在某些情况下可能很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:43:10.297

它看起来像`prBuffer`一个指针并且`prBufferLength`是某种整数类型，因此`move`在这种特殊情况下不会有任何区别，因为它们都是基本类型。

如果`prBuffer`是`std::string`例如，那么您应该使用`move`来强制使用移动构造函数或移动赋值运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:48:43.490

就像 C++ 和生活中的许多事情一样，这个问题没有明确的“是”或“否”答案。

也就是说，作为一般规则，如果传入成员将被清除/重置/清空并将传入成员分配给目标成员将导致调用分配运算符，那么您将需要使用 std::move 以便移动分配将调用运算符而不是复制赋值运算符。

如果不调用赋值运算符（即只进行浅拷贝），则不需要使用 std::move。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T21:04:31.477

如果您的成员对象将从移动中受益，您当然应该移动它们。您链接到的答案中展示了另一种策略，即交换。交换就像移动，但它是双向移动的。如果您的类管理资源，则这具有传入的对象（右值）接收不再需要的数据的效果。然后该数据被该对象的析构函数销毁。例如，您的移动赋值运算符可以这样编写：

```
Car Car::operator=(Car && obj)  
{
    // don't need this, it will be handled by obj's destructor
    // delete[] prBuffer; 

    using std::swap;
    swap(prBuffer, obj.prBuffer);
    swap(prBufferLength, obj.prBufferLength);

    return *this;
} 
```

还可以看看[Copy-and-Swap](https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom)成语。这允许您对移动和复制使用相同的赋值运算符，但有一个小缺点，即自赋值会导致不必要的复制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T21:00:53.137

我相信实现移动赋值的更好方法是使用移动构造函数创建一个新的临时对象，然后将其与当前对象交换，就像复制赋值一样。

它不仅可以避免代码重复，还可以防止您因忘记移动成员而意外出错。

# sonarqube - 使用 Sonar 监控第 3 方组件的使用情况

> ID：13405700
> 
> 赞同：2
> 
> 时间：2012-11-15T20:32:50.113
> 
> 标签：sonarqube, fxcop, gendarme

我有一个拥有相当大（> 150 个解决方案）代码库的客户。他们有一个他们的开发人员可以使用的已批准第三方程序集的列表，并且他们希望使用 Sonar 来帮助识别正在使用未在批准列表中的程序集的项目。

一个简单的例子：

*   我的解决方案引用 foo.dll
*   Foo.dll 不在已批准的第 3 方程序集列表中
*   当我运行声纳分析时，我的解决方案对 foo.dll 的使用被报告为违反规则

这似乎是一个相当简单的要求，但我在确定如何最好地在 Sonar 中实现它时遇到了一些困难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T09:11:35.413

使用[NDepend](http://www.ndepend.com/)工具是即时的（*免责声明：我是 NDepend 的开发者之一*）。您只需要编写代码规则：

```
//<Name>Forbidden third-party assemblies</Name>
warnif count > 0 
from a in ThirdParty.Assemblies.WithNameNotIn(
          "Foo1", "Foo2", "Foo3")
select a 
```

瞧：

![NDepend 代码规则](../Images/93a5e30a0cf5328cdd4959d4d8ce204c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T23:12:22.930

我没有使用声纳的经验，您还没有指定您的代码库是什么语言，但是一个非常简单和基本的解决方案可能是解析项目文件（通常是 XML）并验证包含的引用。

# html - 向右浮动，向左下推内容

> ID：13405713
> 
> 赞同：2
> 
> 时间：2012-11-15T20:33:37.183
> 
> 标签：html, css

我将 SVG 浮动到右侧。我希望这些成为最上面的对象并将其余内容向下推。标题和段落应推到居中菜单下方。请启发我如何做到这一点。我对这一切都很陌生。

在 html 中，菜单和 SVG 位于第一位。应用 CSS 后，情况不再如此。由于我将 SVG 浮动到右侧，它似乎释放了标题/段落出于某种原因声称的 SVG 左侧的空间。让我觉得更奇怪的是它也绕过了菜单。

我不想在段落和标题以及下面的所有其他内容上都使用 clear:both。也将不胜感激任何其他有用的评论。谢谢！

不确定下面要包含哪些代码......小提琴可能会更有用。 [http://jsfiddle.net/akLQk/2/](http://jsfiddle.net/akLQk/2/)

```
svg {
float:right;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:44:07.517

尝试在所有 svg 内容之后添加：

```
<div style="clear:both"></div> 
```

它将下推您的所有其他内容。希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T21:46:01.220

您还可以将 SVG 和导航菜单包装在一个 div 中，然后在您的 CSS 中执行以下操作：

```
yourDivWrapper { overflow: auto; } 
```

我在这里这样做了：http: [//jsfiddle.net/joelisadev/StPky/](http://jsfiddle.net/joelisadev/StPky/)

# c# - 'is' 与尝试使用 null 检查强制转换

> ID：13405714
> 
> 赞同：115
> 
> 时间：2012-11-15T20:33:37.307
> 
> 标签：c#, .net, casting, resharper

我注意到 Resharper 建议我转这个：

```
if (myObj.myProp is MyType)
{
   ...
} 
```

进入这个：

```
var myObjRef = myObj.myProp as MyType;
if (myObjRef != null)
{
   ...
} 
```

为什么它会建议这种变化？我习惯于 Resharper 建议优化更改和代码减少更改，但这感觉就像它想把我的单个语句变成一个两行。

根据[MSDN](http://msdn.microsoft.com/en-us/library/scekt9xw%28v=vs.71%29.aspx)：

> 如果满足以下两个条件，则**is** *表达式的计算结果为 true：*
> 
> *表达式*不为空。表达式可以转换为*type*。也就是说，表单的强制转换表达式`(type)(expression)`将在不引发异常的情况下完成。

我是否误读了这一点，或者没有`is`进行完全相同的检查，只是在一行中而不需要为空检查显式创建另一个局部变量？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-11-15T20:40:32.357

因为只有一个演员。比较一下：

```
if (myObj.myProp is MyType) // cast #1
{
    var myObjRef = (MyType)myObj.myProp; // needs to be cast a second time
                                         // before using it as a MyType
    ...
} 
```

对此：

```
var myObjRef = myObj.myProp as MyType; // only one cast
if (myObjRef != null)
{
    // myObjRef is already MyType and doesn't need to be cast again
    ...
} 
```

* * *

[C# 7.0 使用模式匹配](https://docs.microsoft.com/en-us/dotnet/csharp/pattern-matching)支持更紧凑的语法：

```
if (myObj.myProp is MyType myObjRef)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-09-15T09:04:46.213

最好的选择是使用这样的模式匹配：

```
if (value is MyType casted){
    //Code with casted as MyType
    //value is still the same
}
//Note: casted can be used outside (after) the 'if' scope, too 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-04-05T15:11:18.030

目前还没有关于腰带下方实际发生的情况的信息。看看这个例子：

```
object o = "test";
if (o is string)
{
    var x = (string) o;
} 
```

这转化为以下 IL：

```
IL_0000:  nop         
IL_0001:  ldstr       "test"
IL_0006:  stloc.0     // o
IL_0007:  ldloc.0     // o
IL_0008:  isinst      System.String
IL_000D:  ldnull      
IL_000E:  cgt.un      
IL_0010:  stloc.1     
IL_0011:  ldloc.1     
IL_0012:  brfalse.s   IL_001D
IL_0014:  nop         
IL_0015:  ldloc.0     // o
IL_0016:  castclass   System.String
IL_001B:  stloc.2     // x
IL_001C:  nop         
IL_001D:  ret 
```

这里重要的是`isinst`and`castclass`调用——两者都相对昂贵。如果将其与替代方案进行比较，您会发现它仅进行`isinst`检查：

```
object o = "test";
var oAsString = o as string;
if (oAsString != null)
{

}

IL_0000:  nop         
IL_0001:  ldstr       "test"
IL_0006:  stloc.0     // o
IL_0007:  ldloc.0     // o
IL_0008:  isinst      System.String
IL_000D:  stloc.1     // oAsString
IL_000E:  ldloc.1     // oAsString
IL_000F:  ldnull      
IL_0010:  cgt.un      
IL_0012:  stloc.2     
IL_0013:  ldloc.2     
IL_0014:  brfalse.s   IL_0018
IL_0016:  nop         
IL_0017:  nop         
IL_0018:  ret 
```

另外值得一提的是值类型将使用`unbox.any`而不是`castclass`：

```
object o = 5;
if (o is int)
{
    var x = (int)o;
}

IL_0000:  nop         
IL_0001:  ldc.i4.5    
IL_0002:  box         System.Int32
IL_0007:  stloc.0     // o
IL_0008:  ldloc.0     // o
IL_0009:  isinst      System.Int32
IL_000E:  ldnull      
IL_000F:  cgt.un      
IL_0011:  stloc.1     
IL_0012:  ldloc.1     
IL_0013:  brfalse.s   IL_001E
IL_0015:  nop         
IL_0016:  ldloc.0     // o
IL_0017:  unbox.any   System.Int32
IL_001C:  stloc.2     // x
IL_001D:  nop         
IL_001E:  ret 
```

但是请注意，这不一定会转化为更快的结果，正如我们[在此处](https://stackoverflow.com/q/1583050/1864167)看到的那样。自从提出这个问题以来，似乎有了一些改进：演员表的执行速度似乎和以前一样快，但`as`现在`linq`快了大约 3 倍。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-12T04:00:10.590

更清晰的警告：

`"Type check and direct cast can be replaced with try cast and check for null"`

两者都可以，这取决于您的代码如何更适合您。就我而言，我只是忽略了该警告：

```
//1st way is n+1 times of casting
if (x is A) ((A)x).Run();
else if (x is B) ((B)x).Run();
else if (x is C) ((C)x).Run();
else if (x is D) ((D)x).Run();
//...
else if (x is N) ((N)x).Run();    
//...
else if (x is Z) ((Z)x).Run();

//2nd way is z times of casting
var a = x as Type A;
var b = x as Type B;
var c = x as Type C;
//..
var n = x as Type N;
//..
var z = x as Type Z;
if (a != null) a.Run();
elseif (b != null) b.Run();
elseif (c != null) c.Run();
...
elseif (n != null) n.Run();
...
elseif (x != null) x.Run(); 
```

在我的代码中，第二种方式更长且性能更差。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-15T20:46:03.833

对我来说，这似乎取决于它是否属于那种类型的可能性。如果对象大部分时间都是那种类型，那么预先进行转换肯定会更有效。如果只是偶尔出现这种类型，那么首先检查 is 可能会更理想。

与类型检查的成本相比，创建局部变量的成本可以忽略不计。

可读性和范围对我来说通常是更重要的因素。我不同意 ReSharper，仅出于这个原因使用“is”运算符；如果这是一个真正的瓶颈，请稍后优化。

（我假设你`myObj.myProp is MyType`在这个函数中只使用一次）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-15T20:38:17.910

我会说这是制作 myObj.myProp 的强类型版本，即 myObjRef。当您在块中引用此值时，应该使用它，而不是必须进行强制转换。

例如，这个：

```
myObjRef.SomeProperty 
```

比这更好：

```
((MyType)myObj.myProp).SomeProperty 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-15T20:35:52.787

它也应该建议进行第二次更改：

```
(MyType)myObj.myProp 
```

进入

```
myObjRef 
```

与原始代码相比，这节省了属性访问和强制转换。但这只有在更改`is`为之后才有可能`as`。

# c++ - 模板基类 typedef 成员不可见

> ID：13405715
> 
> 赞同：13
> 
> 时间：2012-11-15T20:33:37.527
> 
> 标签：c++, templates, typedef, dependent-name

我知道默认情况下编译器看不到“依赖名称”这一事实。但是在其他 SO 问题的回答中（[here](https://stackoverflow.com/questions/12514673/cant-access-members-of-a-template-base-class-within-a-derived-template-class)、[here](https://stackoverflow.com/questions/1120833/derived-template-class-access-to-base-class-member-data)以及最终[在 C++ 常见](http://www.parashift.com/c++-faq-lite/nondependent-name-lookup-members.html)问题解答中） ，有人告诉我`using`声明可能会有所帮助。

所以我尝试了。

模板基类：

```
// regardless of the fact that members are exposed...
template<typename T>
struct TBase {
   typedef T MemberType;
   MemberType baseMember;
   MemberType baseFunction() { return MemberType(); }
}; 
```

还有一个派生类，使用基类的成员：

```
template<typename T>
struct TDerived : public TBase<T> {
   // http://www.parashift.com/c++-faq-lite/nondependent-name-lookup-members.html
   // tells us to use a `using` declaration.
   using typename TBase<T>::MemberType;
   using TBase<T>::baseFunction;
   using TBase<T>::baseMember;

   void useBaseFunction() { 
      // this goes allright.
      baseFunction();
      ++baseMember;

      // but here, the compiler doesn't want to help...
      MemberType t; //error: expected `;' before ‘t’
   }
}; 
```

我[在 ideone 上试过了](http://ideone.com/iUsXKG)。它有 gcc-4.3.3 和 gcc-4.5.1

这是预期的行为吗？我们应该如何解决访问父模板类成员类型定义的“依赖名称”法则？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-15T20:40:46.827

你可能想做：

```
using MemberType = typename TBase<T>::MemberType; // new type alias syntax 
```

或者

```
typedef typename TBase<T>::MemberType MemberType; // old type alias syntax 
```

该语法`using Base::member;`只能用于将非类型成员的声明带入范围。

* * *

另请注意，实际上这些都不是必需的，您可以限定每次使用（对于具有基数的类型，对于具有任一`this->`或基数的非类型），这将使符号依赖。

# c++ - string::assign 处的段错误

> ID：13405716
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:33:39.100
> 
> 标签：c++

我很难为字符串赋值。该字符串包含在结构中。这是完整的代码。它在很大程度上是不完整的（我试图在修复我的迭代器之前让它工作）

它在 operator[] 处失败

：

```
#include <string>
#include <iostream>
#include <vector>

using namespace std;

template <class Key,class Value>
class hashMap
{
  public:
    explicit hashMap( int size = 101 ) : arraySize( size ){
      array.reserve(arraySize+1);
    }
    hashMap(const hashMap & rhs){
      arraySize = rhs.arraySize;
      array.reserve(arraySize);
      for(int i = 0; i < arraySize; i++)
      {
        array[i] = rhs.array[i];
      }
    }
    ~hashMap()
    {
    }
    hashMap & operator=(const hashMap & rhs){
      if (&rhs != this)
      {
        arraySize = rhs.arraySize;
        array.clear();
        array.reserve(arraySize);
        for(int i = 0; i < arraySize; i++)
        {
          array[i] = rhs.array[i];
        }
      }
    }
    Value & operator[](const Key & key)
    {
        unsigned long long pos = hash(key, arraySize);
        unsigned long long quad = 1;
        while (array[pos].active != false && array[pos].first != key)
        {
          pos += quad;
          pos %= arraySize;
          quad *= 2;
        }
        array[pos].first = key; // FAILS HERE
        array[pos].active = true;
        return array[pos].second;
    }

    struct cell{
      Key first;
      Value second;
      bool active;
      cell(){
        active = false;
      }
    };

    class const_iterator
    {
      public:
        cell operator*()
        {
          return array[pos];
        }
      private:
        int pos;
    };

  private:
    vector<cell> array;
    int arraySize;
    int hash(const std::string & key, int tableSize)
    {
      int hashVal = 0;

      for(int i = 0; i < key.length(); i++)
      {
        hashVal = 37 * hashVal + key[i];
      }

      hashVal %= tableSize;
      if(hashVal < 0)
      {
        hashVal += tableSize;
      }

      return hashVal;
    }
    int hash(int key, int tableSize)
    {
      return key%tableSize;
    }
}; 
```

我将非常感谢您的帮助！

〜一个绝望的计算机科学学生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:50:28.937

在您的构造函数中，您使用

```
array.reserve(arraySize); 
```

但`std::vector::reserve`只保留一些内存以便于数组扩展并且不创建元素（也不调整数组大小）。所以，你的细胞不会被构建。

然后，当您尝试将某些内容分配给数组时，您实际上超出了数组范围。

您应该使用`std::vector::resize`而不是`std::vector::reserve`（作为最简单的解决方案）

```
array.resize(arraySize); 
```

# c# - 正则表达式模式以匹配没有属性的翘曲跨度

> ID：13405717
> 
> 赞同：0
> 
> 时间：2012-11-15T20:33:40.083
> 
> 标签：c#, regex

我有一个这样的字符串

**字符串文本 =**

```
<p><span><span id="test">Meanwhile, the Cougars are coming off of a win against Eastern 
Washington University in which they scored 88 points and had three players score at least 
15 points. <span>Motum</span> recorded his fourth career double-double in the game as well.  
</span></span></p> 

<p><span>After Dexter Kernich-Drew, Royce Woolridge, and Will DiIorio were unable to 
practice last Wednesday before the game against EWU, the team is healthy and ready to play 
against Utah Valley. </span></p>

<p><span><span><span>Woolridge</span>, a <span>redshirt</span> sophomore transfer who has 
started at guard in the first two games this season, scored seven points and had two assists 
against EWU. He also had 10 points and three assists against Saint Martin&rsquo;s. </span> 
</span></p> 
```

而且我需要摆脱所有没有属性而只是包装内容的 's。我到目前为止的模式是

```
text = Regex.Replace(text, @"</?span([^>]*|/)?>", "", RegexOptions.Compiled); 
```

这只是拉出所有跨度离开

```
<p>Meanwhile, the Cougars are coming off of a win against Eastern Washington University 
in which they scored 88 points and had three players score at least 15 points. Motum 
recorded his fourth career double-double in the game as well. </p> 

<p>After Dexter Kernich-Drew, Royce Woolridge, and Will DiIorio were unable to practice 
last Wednesday before the game against EWU, the team is healthy and ready to play 
against Utah Valley. </p> 

<p>Woolridge, a redshirt sophomore transfer who has started at guard in the first 
two games this season, scored seven points and had two assists against EWU. He also had 
10 points and three assists against Saint Martin&rsquo;s. </p> 
```

那很接近，但我需要第一个

它看起来像

```
<p><span id="test">Meanwhile, the Cougars are coming off of a win against Eastern 
Washington University in which they scored 88 points and had three players score at 
least 15 points. Motum recorded his fourth career double-double in the game as well. 
</span></p> 
```

这里的问题是如何找到没有属性的嵌套跨度并删除它们。我确实有一些其他尝试使用回溯作为结束标记，但这是唯一一个最接近的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:50:28.987

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);

var spans = doc.DocumentNode.SelectNodes("//span[@*]")
                .Select(s => s.InnerText)
                .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:09:18.497

Here's some pseudocode for a simple algorithm:

```
create a stack of booleans

set the last position to the start of the text

search for the opening and the closing spans and for each one found:
    append the text since the last position up to the start of the found item to the output

    if the found item is an opening span:
        if the found item has attributes:
            // it's an opening span with attributes
            // we want to keep it
            push true onto the stack
            append the item to the output
        else:
            // it's an opening span without attributes
            // we want to drop it
            push false onto the stack
    else:
        pop the top boolean from the stack
        if the popped boolean is true:
            // the corresponding opening span had attributes
            // we want to keep this closing span
            append the found item to the output

    set the last position to the end of the found item

append the remaining text since the last position to the output 
```

# css - 在边框上创建 CSS 箭头

> ID：13405719
> 
> 赞同：0
> 
> 时间：2012-11-15T20:33:47.587
> 
> 标签：css

我试图修改以下代码，使小箭头位于框的右侧，但是当我尝试使箭头变小并将位置更改为相对位置时，它会失去其形状。有任何想法吗 ？

```
.title-box:after {
    content:"";
    border-color: transparent transparent transparent #00f;
    border-style:solid;
    border-width:5px;
    width:0;
    height:0;
    bottom:-20px;
    left:138px;
    } 
```

[http://jsfiddle.net/hyH48/](http://jsfiddle.net/hyH48/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:37:10.890

试试这个 -[**演示**](http://jsfiddle.net/hyH48/888/)

```
#mybox:after {
    content:"";
    border-color: transparent transparent transparent #ff0;
    border-style:solid;
    border-width:15px;
    width:0;
    height:0;
    position:absolute;
    top: 35px;
    right: -30px;
} 
```

# javascript - 使用正则表达式替换外部跨度标签

> ID：13405726
> 
> 赞同：1
> 
> 时间：2012-11-15T20:34:08.330
> 
> 标签：javascript, regex

使用 javascript replace 方法，我想找到这个字符串：

```
<span class="memberX"><span class="member19">text</span></span>    <---X is any number 
```

最终输出应该是：

```
<span class="member19">text</span> 
```

本质上，我想删除可以具有 memberX 类的外部跨度，其中 X 是任意数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:38:58.403

如果这是在 DOM 中，则不需要正则表达式。您应该只操作 DOM 本身。

```
var spans = document.querySelectorAll('span[class^=member] > span[class^=member]');

for (var i = 0; i < spans.length; i++) {
    spans[i].parentNode.parentNode.insertBefore(spans[i], spans[i].parentNode);
    spans[i].parentNode.removeChild(spans[i].nextSibling);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:40:13.207

1.  首先阅读[除 XHTML 自包含标签之外的 RegEx 匹配打开标签](https://stackoverflow.com/questions/1732348)。

2.  阅读文档对象模型（简称 DOM）。

3.  使用 JS 提供的 DOM 函数来遍历 DOM 树。

4.  编写遍历 DOM 树的遍历算法。

5.  `span`对于您遇到的每个元素，检查它是否有一个也是跨度的子元素。如果是这种情况，如果适合您的情况，您应该用`span`孩子替换父母。`span`

# c++ - QTreeView / QFileSystemModel 设置标题标签

> ID：13405728
> 
> 赞同：1
> 
> 时间：2012-11-15T20:34:12.593
> 
> 标签：c++, qt, qtreeview, qfilesystemmodel

非常简单的任务，但我没有设法在文档中找到任何有用的东西。我希望 QTreeView 包含一个名为“文件”的列，其中包含来自 QFileSystemView 的数据。这是我所拥有的：

```
 QFileSystemModel *projectFiles = new QFileSystemModel();
    projectFiles->setRootPath(QDir::currentPath());
    ui->filesTree->setModel(projectFiles);
    ui->filesTree->setRootIndex(projectFiles->index(QDir::currentPath()));

    // hide all but first column
    for (int i = 3; i > 0; --i)
    {
        ui->filesTree->hideColumn(i);
    } 
```

这给了我一个带有“名称”标题的单列。如何重命名此标题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:45:41.113

[`QAbstractItemModel::setHeaderData()`](http://doc.qt.digia.com/qt/qabstractitemmodel.html#setHeaderData)应该管用。如果没有，您始终可以继承`QFileSystemModel`并覆盖[`headerData()`](http://doc.qt.digia.com/qt/qabstractitemmodel.html#headerData).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T09:11:57.863

快速但有点肮脏的技巧（请注意**w.hideColumn()**）：

```
#include <QApplication>

#include <QFileSystemModel>
#include <QTreeView>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    QTreeView w;

    QFileSystemModel m;
    m.setFilter(QDir::Dirs | QDir::NoDotAndDotDot);
    m.setRootPath("C:\\");

    w.setModel(&m);
    w.setRootIndex(m.index(m.rootPath()));
    w.hideColumn(3);
    w.hideColumn(2);
    w.hideColumn(1);

    w.show();

    return a.exec();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T23:00:47.673

您可以继承 QFileSystemModel 并覆盖方法 headerData()。例如，如果您只想更改第一个标题标签并将其余部分保留其原始值，您可以执行以下操作：

```
QVariant MyFileSystemModel::headerData(int section, Qt::Orientation orientation, int role) const {

    if ((section == 0) && (role == Qt::DisplayRole)) {
        return "Folder";
    } else {
        return QFileSystemModel::headerData(section,orientation,role);
    }
} 
```

# java - 压缩算法（例如 gzip、zip 或 snappy）的输出是否肯定小于输入？

> ID：13405729
> 
> 赞同：1
> 
> 时间：2012-11-15T20:34:14.603
> 
> 标签：java, c++, c, compression

我有这个问题，因为我需要为压缩数据分配输出缓冲区。我需要知道压缩算法（例如 gzip、zip 或 snappy）的输出肯定比输入小多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:36:15.920

对于**有损**压缩算法，可能会出现这种情况，但不能保证。对于**无损**压缩算法，情况并非如此——无损压缩总是会生成*大于*某些输入的输入的输出。请参阅[此 Wikipedia 页面](http://en.wikipedia.org/wiki/Pigeonhole_principle#Uses_and_applications)了解原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:17:05.240

如果您使用的是 zlib（用于 gzip），您可能会发现以下界面很有用：（来自`zlib.h`）

```
ZEXTERN uLong ZEXPORT compressBound OF((uLong sourceLen));
/*
     compressBound() returns an upper bound on the compressed size after
   compress() or compress2() on sourceLen bytes.  It would be used before
   a compress() or compress2() call to allocate the destination buffer.
*/ 
```

我相信bzip也有类似的界面。返回的值将略大于 sourceLen，并且仅应在压缩的数据足够小以至于您可以在内存中进行压缩时使用。但是，对于此类应用程序，它非常有用。

请注意，大多数情况下，您不会使用分配的大部分内存，因此如果您计划将压缩版本保留在内存中任意时间，您还希望能够返回未使用的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:36:13.293

“标题”总是有一个固定的大小，但对于任何现实生活中的数据（例如此评论的长度），压缩通常会有所帮助。

也就是说，将压缩后缓冲区声明为与输入缓冲区相同的大小是不“安全的”。它*可能*更大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:37:23.330

不它不是。

一个简单的例子：具有均匀分布的非重复值的数据无法在不丢失的情况下进行压缩，因此您最终会得到原始数据以及附加的元数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T20:59:39.750

压缩库，例如 zlib（用于 gzip 和 pkzip 中使用的 inflate/deflate）更有可能被设计为处理来自输入的最大 N 个字节并将最大 M 个字节输出到用户分配的缓冲区——如果库需要新的输入，则向调用者发出信号数据或新的/清除的输出缓冲区。这些库很少期望完整的输入和输出驻留在内存中，而是在块上工作。

许多常见算法的“搜索窗口”也相对较小。这也限制了所需的内存量。存在反例，例如 tar.bz2 中使用的 BWT。

正如其他人所指出的那样，任何无损压缩算法的输出都可能大于输入，在这种情况下，大多数设计良好的压缩库都会自动实现回退机制，它只是将未压缩的块包装到带有大小信息的容器中。

总结一下：许多压缩库只需要一个从几千字节到几兆字节的缓冲区，并用它处理任何长度的输入。（这样的约束顺便说一句包含在 MPEG 中——除了预期的帧大小（例如 mp3 中的 128 kbps）之外，它们还指定了所需的最大缓冲区大小）

# asp-classic - 经典 Asp 从数据库中提取数据

> ID：13405736
> 
> 赞同：1
> 
> 时间：2012-11-15T20:34:38.580
> 
> 标签：asp-classic

我在使用 asp 脚本从数据库中获取数据时遇到问题，在运行下面的代码后，我只有一个空白页。有人可以帮忙吗？

```
<% Response.Buffer = True %>
<% Response.Expires = 0%>
<!--#include file="dsn.inc"-->

<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Search Results</title>
</head>

<body>
<font face="Arial Narrow">
<%
Set rst = Server.CreateObject("ADODB.Recordset")

If LCase(Request("clearsql")) = "y" Then

        strSQL = "SELECT * from npic.dbo.LMSWeb"

    Session("sql") = strSQL

Else

    strSQL = Session("sql")

End If

rst.Open strSQL, strDSN

%>

<table border="1" width="100%">
<tr>
<td align="center" width="212"><font face="Arial Narrow"><b>Agent Name </b>
</font></td>
<td align="center" width="140"><b><font face="Arial Narrow">Sup</font></b><font
face="Arial Narrow"><b> Name </b>
</font></td>
<td align="center"><font face="Arial Narrow"><b>Date</b></font></td>
<td align="center"><font face="Arial Narrow"><b>Points</b></font></td>
<td align="center">&nbsp;</td>
</tr>
<%

Dim strError

Do While Not rst.EOF

Response.Write "<tr>" & Chr(10)
Response.Write "    <td>" & rst("agent name") & "</td>" & Chr(10)
Response.Write "    <td>" & rst("sup") & "</td>" & Chr(10)
Response.Write "    <td>" & rst("date") & "</td>" & Chr(10)
Response.Write "    <td>" & rst("points") & "</td>" & Chr(10)

Response.Write "</tr>" & Chr(10)
rst.MoveNext
loop

rst.Close
Set rst=Nothing

%>
</table>
</center></div>

</body>
</html> 
```

我在使用 asp 脚本从数据库中获取数据时遇到问题，在运行上面的代码后，我只有一个空白页。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:26:41.320

It's been a while since Classic ASP, but I think this will work:

```
<% Response.Buffer = True %>
<% Response.Expires = 0 %>
<!--#include file="dsn.inc"-->
<html>
<head>
    <meta http-equiv="Content-Language" content="en-us">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <meta name="GENERATOR" content="Microsoft FrontPage 6.0">
    <meta name="ProgId" content="FrontPage.Editor.Document">
    <title>Search Results</title>
</head>
<body>
    <font face="Arial Narrow">
<%
Dim conn

Set rst = Server.CreateObject("ADODB.Recordset")
Set conn = Server.CreateObject("ADODB.Connection")
conn.Open yourConnectionStringHere

If LCase(Request("clearsql")) = "y" Then
    strSQL = "SELECT * npic.dbo.LMSWeb"
    Session("sql") = strSQL
Else
    strSQL = Session("sql")
End If

Set rst = conn.Execute(strSQL) 'Typo was on this line
%>
    <table border="1" width="100%" style="font-family: Arial Narrow;">
        <thead>
            <tr>
                <th width="212">Agent Name</th>
                <th width="140">Sup Name</th>
                <th>Date</th>
                <th>Points</th>
                <th>&nbsp;</th>
            </tr>
        <thead>
        <tbody>
<%
Dim strError

If rst.BOF And rst.EOF Then
    ' No data
Else
    Do While (Not rst.EOF)
        Response.Write "<tr>" & Chr(10)
        Response.Write "    <td>" & rst(0) & " " & rst(1) & "</td>" & vbCrLf
        Response.Write "    <td>" & rst(2) & "</td>" & vbCrLf
        Response.Write "    <td>" & rst(3) & "</td>" & vbCrLf
        Response.Write "    <td>" & rst(4) & "</td>" & vbCrLf
        Response.Write "</tr>" & vbCrLf
        rst.MoveNext
    Loop
End If

rst.Close
conn.close

Set conn = Nothing
Set rst = Nothing
%>
        </tbody>
    </table>
</body>
</html> 
```

I took the liberty of updating your HTML to slightly more modern syntax as `<font>` tags went out of `style` (pun intended) when HTML 4 hit the scene and what you clearly wanted was a table header section.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T18:03:47.593

我注意到您在初始化它们之前没有声明您的 rst 和 strSQL 变量（例如`Dim rst,strSQL`）。我在下面添加了它们。

```
<% Response.Buffer = True %>
<% Response.Expires = 0%>
<!--#include file="dsn.inc"-->

<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Search Results</title>
</head>

<body>
<font face="Arial Narrow">
<%
Dim rst, strSQL
Set rst = Server.CreateObject("ADODB.Recordset")

If LCase(Request("clearsql")) = "y" Then

        strSQL = "SELECT * from npic.dbo.LMSWeb"

    Session("sql") = strSQL

Else

    strSQL = Session("sql")

End If

rst.Open strSQL, strDSN

%>

<table border="1" width="100%">
<tr>
<td align="center" width="212"><font face="Arial Narrow"><b>Agent Name </b>
</font></td>
<td align="center" width="140"><b><font face="Arial Narrow">Sup</font></b><font
face="Arial Narrow"><b> Name </b>
</font></td>
<td align="center"><font face="Arial Narrow"><b>Date</b></font></td>
<td align="center"><font face="Arial Narrow"><b>Points</b></font></td>
<td align="center">&nbsp;</td>
</tr>
<%

Dim strError

Do While Not rst.EOF

Response.Write "<tr>" & Chr(10)
Response.Write "    <td>" & rst("agent name") & "</td>" & Chr(10)
Response.Write "    <td>" & rst("sup") & "</td>" & Chr(10)
Response.Write "    <td>" & rst("date") & "</td>" & Chr(10)
Response.Write "    <td>" & rst("points") & "</td>" & Chr(10)

Response.Write "</tr>" & Chr(10)
rst.MoveNext
loop

rst.Close
Set rst=Nothing

%>
</table>
</center></div>

</body>
</html> 
```

# ruby-on-rails - 我的模型设计是否走在正确的道路上？

> ID：13405739
> 
> 赞同：1
> 
> 时间：2012-11-15T20:34:50.137
> 
> 标签：ruby-on-rails, activerecord, models

前言：我是新手。

我以为我昨天已经解决了这个问题，但我开始怀疑我是否为这个领域设计了一个体面的模型。

我正在创建一个任务应用程序（基于我的工作）。这是我的第二次尝试（第一次，我没有进行测试，并且设计很糟糕，尽管它有效）。本质上，我想添加具有日期、开始和结束时间、装备（即 LCD 投影仪）等的任务。在创建任务时，我想查看当前是否存在具有相同房间/装备的先前任务（或前一天），并用注释更新前一个任务（:notes 是一列），说明稍后有任务在房间里。我还想检查是否有下一个任务具有相同的房间/装备，并想用有关下一个任务的信息更新当前任务。模型代码粘贴在下面：

```
class Task < ActiveRecord::Base
  attr_accessible :begin_time, :day, :end_time, :gear, :notes, :preset, :room, :setup, :strike
  before_create :initialize_linked_task_id
  before_save :check_for_adjacent_tasks

  validates :room, presence: true
  validates :begin_time, presence: true
  validates :end_time, presence: true
  validates :gear, presence: true
  validates :day, presence: true

  scope :for_day, lambda { |day| where(day: day) }
  scope :for_room, lambda { |room| where(room: room) }
  scope :with_gear, lambda { |gear| where(gear: gear) }

  private 

  def initialize_linked_task_id
    @linked_task_id = []
  end

  def check_for_adjacent_tasks
    @previous = prev?
    @next = next?

    unless @previous.nil?
      set_linked_task_id(@previous)
      @previous.update_attributes(notes: 
                              "There is a meeting in this room on #{self.day} at #{self.begin_time.strftime("%I:%M%P")}")
    end 
    unless @next.nil?
      set_linked_task_id(@next)
      self.notes = "There is a meeting in this room on #{@next.day} at #    {@next.begin_time.strftime("%I:%M%P")}"
    end
  end

  def prev?
    @prev = Task.for_day(self.day).for_room(self.room)
            .with_gear(self.gear)
            .where('begin_time < ?', self.begin_time).last
    if @prev.nil?
      @prev = Task.for_day(self.day.yesterday).for_room(self.room)
          .with_gear(self.gear).last
      return @prev unless @prev.nil?
    end

    @prev      
  end

  def next?
    @next = Task.for_day(self.day).for_room(self.room)
            .with_gear(self.gear)
            .where('begin_time > ?', self.begin_time).first
    if @next.nil?
      @next = Task.for_day(self.day.tomorrow).for_room(self.room)
          .with_gear(self.gear).first
      return @next unless @next.nil?    
    end

    @next
  end

  def set_linked_task_id(task)
    #@linked_task_id = task.id
  end
end 
```

我不确定我是否应该像现在这样更新其他模型实例。我应该创建一个 Class 方法来更新其他实例吗？我应该在实例之间创建关系吗？

我也意识到代码中有重复。但我只想先正确完成这个概念。

**编辑** 为了澄清，只有上一个？方法不起作用。

# java - 获取分配给字段的对象类型

> ID：13405741
> 
> 赞同：0
> 
> 时间：2012-11-15T20:34:54.660
> 
> 标签：java, reflection

我正在通过反射检查“ReflectMe”类。
使用 getDeclaredFields 方法我得到了“str”字段。

现在我需要获取分配给该字段的静态方法的类“Target”。

可能吗？

代码：

```
package myproj.reflect;
public class Target {
    public static final String theString = "abcd";
}

package myproj.reflect;
public class ReflectMe {
    private String str = Target.theString;
}

public static void main(String[] args) {
    ClassLoader loader = ClassLoader.getSystemClassLoader();                      
     String theclass = "myproj.reflect.ReflectMe";                   
    Class myClass = loader.loadClass(theclass);
    Field[] fields = myClass.getDeclaredFields();
} 
```

}

换句话说，我需要获得“目标”类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:41:53.090

如果您希望从via`Target`的类定义中获取类。`ReflectMe`这个领域，我认为你不能通过反射 API 做到这一点；您可以获取类定义和实例变量的值，但不能自省表达式本身。

# extjs - 使用 Netzke 创建图表

> ID：13405747
> 
> 赞同：0
> 
> 时间：2012-11-15T20:35:14.030
> 
> 标签：extjs, netzke

有谁知道用 Netzke 创建 ext js 图表的方法？我想没有这样的组件知道，但也许有人有一个想法。在没有 Netzke 的情况下，使用 Rails 和 EXT JS 进行连接的基本步骤是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T04:05:31.777

我看过那个要点和这个[https://gist.github.com/1190511](https://gist.github.com/1190511) 但我仍然无法弄清楚。是否有机会看到，无论演示应用程序中最简单图表的工作版本或其他任何东西多么简单？我了解 EXT 方面，但我在将其与 Netzke 放在一起时遇到了真正的问题。我知道我错过了一些非常简单的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T17:26:17.050

图表组件过于特定于应用程序，但肯定可以使用 Netzke 内置的客户端-服务器机制创建一个。这是一个演示： http: [//variant.herokuapp.com](http://variant.herokuapp.com)（尝试在日历上选择不同的日期以查看动态更新的图表）。这是那里使用的 LineChart 组件的要点：[https](https://gist.github.com/4112061) ://gist.github.com/4112061 - 希望它能给你一个想法（Netzke 0.7.x）。

# c++ - For C++ 中的递减 2

> ID：13405748
> 
> 赞同：-5
> 
> 时间：2012-11-15T20:35:18.547
> 
> 标签：c++

我减少了一个数字二，但我能做的就是 FOR 1。

我该怎么办？这是基本的 FOR

```
for (i=n;i>0;i--) 
```

但是减1。

```
int main(int argc, char *argv[]) {

int n,i,e;
char op;
cout<<"ingrese un numero para realizar las operaciones descriptas a continuacion :"<<endl;
cin>>n;
cout<<"Su numero es : "<<n<<endl;
cout<<"Este programa mostrara una lista de los numeros pares menores a su numero.\n\n\tEn que forma desea ver la lista? "<<endl;
cout<<"\t \t a)De manera creciente"<<endl<<"\t \t b)De manerda decreciente "<<endl;
cin>>op;
if (op=='a') {
    if (n%2==0){
        cout<<"El numero que usted ingreso es par "<<endl;
        for (i=n;i>0;--i) {
            cout<<i<<endl;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:36:36.000

为什么你不能这样做？

```
for (i = n; i > 0; i -= 2) 
{
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:44:24.100

在这个`for`循环中

```
for( int i = n; i>0; i--){
// i = i-1;
} 
```

所以如果你使用`i= i-2`或者`i-=2`它会减少`i's`2 的值

```
for(int i = n; i>0; i-=2){
// i = i - 2;
} 
```

# razor - asp.net mvc布局中数据的条件显示

> ID：13405752
> 
> 赞同：0
> 
> 时间：2012-11-15T20:35:35.300
> 
> 标签：razor, asp.net-mvc-4

在 ASP.NET MVC 应用程序中，如何将一些条件数据显示到布局页面？

我的应用程序允许具有“管理员”角色的用户查看来自同一应用程序的其他用户的页面和数据。当管理员查看另一个用户的页面时，他/她需要查看他/她正在查看的数据的用户信息，例如他/她的姓名/角色/等（此信息来自数据库）。当管理员用户登录并且仅当管理员登录时，此信息需要显示在所有页面中。即，如果非管理员用户输入这些详细信息，则不应显示，因为它不相关。

我在尝试中面临的问题是管理员用户没有登录到用户的页面，而是我必须通过单击用户列表/网格来实现切换到用户视图的功能。这将我带到用户的主页（并且我得到了显示的信息，因为我在 viwbag 中设置了它）。问题是，我如何在此会话的后续用户页面中设置此值。试图避免在每个控制器/动作中填充这个 viewbag 值。

请帮忙！

PS：需要在布局中显示的信息是根据Admin从网格中选择的用户ID来的。它来自数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:59:56.023

您可以将用户 ID 写入 cookie，并使用操作过滤器检查管理员用户完成的请求是否存在此 cookie

# html - CSS 中的 100% 高度列

> ID：13405758
> 
> 赞同：1
> 
> 时间：2012-11-15T20:36:03.897
> 
> 标签：html, css

HTML：

```
<div id="header">
    &nbsp;
</div>
<div id="wrapper">
    <div id="col1">
        Lorem Ipsum<br/>Lorem Ipsum<br/>Lorem Ipsum<br/>Lorem Ipsum<br/>
    </div>
    <div id="col2">
        &nbsp;
    </div>
    <div id="col3">
        Lorem Ipsum<br/>Lorem Ipsum
    </div>
</div>
​&lt;div id="footer">
    &nbsp;
</div>​​​​​​​​​​​​​​​​​​ 
```

CSS：

```
#header{background:#aaa;height:100px}
#wrapper{background:#000;float:left}
#col1{background:#f00;float:left;width:300px}
#col2{background:#0f0;float:left;width:5px;height:100%} /* DOESN'T WORK */
#col3{background:#ff0;float:left;width:300px}
#footer{background:#aaa;height:100px;clear:both}​ 
```

JSFiddle：http: [//jsfiddle.net/Ya9RR/16/](http://jsfiddle.net/Ya9RR/16/)

如何使任何一个`col`具有 100% 的高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:01:53.097

您需要将 Columns 的外部容器设置为也占据 100% 的高度，因为 % 是相对于其父级的。

html:

```
<html>
<body>
<div id="wrapper">
    <div id="col1">
        Lorem Ipsum<br/>Lorem Ipsum<br/>Lorem Ipsum<br/>Lorem Ipsum<br/>
    </div>
    <div id="col2">
        &nbsp;
    </div>
    <div id="col3">
        Lorem Ipsum<br/>Lorem Ipsum
    </div>
</div>
</body>
</html>​ 
```

CSS：

```
body, html {height: 100%;}
#wrapper{background:#000;float:left; height: 100%;}
#col1{background:#f00;float:left;width:300px;height:100%}
#col2{background:#0f0;float:left;width:5px;height:100%}
#col3{background:#ff0;float:left;width:300px;height:100%} 
```

​ 小提琴：http: [//jsfiddle.net/Ya9RR/14/](http://jsfiddle.net/Ya9RR/14/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-15T20:50:04.050

有很多方法可以做到这一点：[http](http://css-tricks.com/fluid-width-equal-height-columns/) ://css-tricks.com/fluid-width-equal-height-columns/我喜欢这个：[http://blog.mozilla.org/webdev/2009/02/20 /跨浏览器内联块/](http://blog.mozilla.org/webdev/2009/02/20/cross-browser-inline-block/)

```
#col1, #col2, #col3 {
    min-height: 300px;
    display: -moz-inline-stack;
    display: inline-block;
    vertical-align: top;
    zoom: 1;
    *display: inline;
    _height: 300px;
} 
```

更新小提琴：http: [//jsfiddle.net/Ya9RR/8/](http://jsfiddle.net/Ya9RR/8/)

# mysql - 如何在 MySQL 中找到每月的第一个星期日？

> ID：13405763
> 
> 赞同：4
> 
> 时间：2012-11-15T20:36:15.813
> 
> 标签：mysql, date

我没有找到任何 MySQL 的例子——它们都非常复杂。

我怎样才能`SELECT`在每个月的第一个星期日？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T20:36:15.813

所以选择当月的第一天：（`2012-01-01`或任何你想要的月份和年份）。

获取日期的工作日索引。这里的索引是从 0 到 6。

从 6 中减去该索引，您将得到在日期为星期日之前需要添加多少天。

将该天数添加到所选日期。

```
SELECT DATE_ADD("2012-01-01 10:00:00", INTERVAL (6 - WEEKDAY("2012-01-01 10:00:00")) DAY); 
```

或者：

```
SELECT DATE_ADD("2012-01-01", INTERVAL (6 - WEEKDAY("2012-01-01")) DAY); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-31T07:27:23.140

所以选择当月的第一天：2021-08-01（或任何你想要的月份和年份）。

选择添加日期（'2021-08-01'，MOD（（8-DAYOFWEEK（'2021-08-01'）），7））

# c# - 更新具有多对多关系的断开连接的实体

> ID：13405773
> 
> 赞同：8
> 
> 时间：2012-11-15T20:36:50.417
> 
> 标签：c#, entity-framework, ef-code-first, many-to-many, dbcontext

假设我在实体框架代码优先设置中有以下模型类：

```
public class Person
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Team> Teams { get; set; }
}

public class Team
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Person> People { get; set; }
} 
```

从此代码创建的数据库包括一个 TeamPersons 表，表示人员和团队之间的多对多关系。

现在假设我有一个断开连接的 Person 对象（不是代理，并且尚未附加到上下文），其 Teams 集合包含一个或多个断开连接的 Team 对象，所有这些对象都表示数据库中已经存在的 Teams。例如，如果数据库中已经存在一个 ID 为 1 的人员和一个 ID 为 3 的团队，则会创建如下对象：

```
var person = new Person
{
    Id = 1,
    Name = "Bob",
    Teams = new HashSet<Team>
    {
        new Team { Id = 3, Name = "C Team"}
    }
}; 
```

更新此对象的最佳方法是什么，以便在更新后 TeamPersons 表包含 Bob 的单行，将他链接到 C Team ？我已经尝试了明显的：

```
using (var context = new TestContext())
{
    context.Entry(person).State = EntityState.Modified;
    context.SaveChanges();
} 
```

但是 Teams 集合被忽略了。我也尝试过其他各种事情，但似乎没有什么能完全符合我的要求。谢谢你的帮助。

**编辑：**

所以我知道我可以从数据库中获取 Person 和 Team[s]，更新它们，然后提交更改：

```
using (var context = new TestContext())
{
    var dbPerson = context.People.Find(person.Id);
    dbPerson.Name = person.Name;
    dbPerson.Teams.Clear();
    foreach (var id in person.Teams.Select(x => x.Id))
    {
        var team = context.Teams.Find(id);
        dbPerson.Teams.Add(team);
    }

    context.SaveChanges();
} 
```

但是，如果 Person 是一个复杂的实体，这会很痛苦。我知道我可以使用 Automapper 或其他东西来让事情变得更容易一些，但如果没有办法保存原始人对象，而不是必须得到一个新对象并将所有属性复制过来，这仍然是一种耻辱......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:55:48.153

一般的方法是`Team`从数据库中获取，然后`Add`到`Person`'s`Teams`集合中。设置`EntityState.Modified`只影响标量属性，不影响导航属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T16:35:41.217

这就是EF s**ks的地方。对于断开连接的场景非常低效。加载更新/删除的数据以及重新附加更新的每个数据，不能只是将更新的实体附加到上下文，因为具有相同键的实体可能已经存在于上下文中，在这种情况下，EF 只会抛出。需要做的是检查具有相同键的实体是否已经在上下文中并相应地附加或更新。使用多对多关系子更新实体更糟糕。删除已删除的孩子是来自孩子的实体集而不是参考属性，这非常混乱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T20:56:55.980

尝试先选择现有实体，然后将团队附加到人员对象的团队集合。

像这样的东西：（语法可能不完全正确）

```
using (var context = new TestContext())
{
    var person = context.Persons.Where(f => f.Id == 1).FirstOrDefault();
    var team = context.Teams.Where(f => f.Id == 3).FirstOrDefault();

    person.Teams.Add(team);

    context.Entry(person).State = EntityState.Modified;
    context.SaveChanges();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-25T08:07:18.263

您可以使用附加方法。尝试这个：

```
using (var context = new TestContext())
{
    context.People.Attach(person);

    //i'm not sure if this foreach is necessary, you can try without it to see if it works
    foreach (var team in person.Teams)
    {
        context.Teams.Attach(team);
    }

    context.Entry(person).State = EntityState.Modified;

    context.SaveChanges();
} 
```

我没有测试这个代码，如果你有任何问题，请告诉我

# linux - 如何通过使用其“Elf64_Phdr”程序头来获取段的名称？

> ID：13405774
> 
> 赞同：1
> 
> 时间：2012-11-15T20:36:50.297
> 
> 标签：linux, elf

据我所知，一个 ELF 对象由许多段组成，每个段都有一个描述该段的相应程序头。在`libelf`中，程序头定义为`Elf64_Phdr`（或`Elf32_Phdr`）结构，`Elf64_Phdr`结构定义如下：

```
typedef struct {
    Elf32_Word  p_type;    /* Segment type */
    Elf32_Off   p_offset;  /* Segment file offset */
    Elf32_Addr  p_vaddr;   /* Segment virtual address */
    Elf32_Addr  p_paddr;   /* Segment physical address */
    Elf32_Word  p_filesz;  /* Segment size in file */
    Elf32_Word  p_memsz;   /* Segment size in memory */
    Elf32_Word  p_flags;   /* Segment flags */
    Elf32_Word  p_align;   /* Segment alignment */
} Elf32_Phdr; 
```

但是，段有名称（不是吗？），`Elf64_Phdr`结构没有指向其相应名称的字段。那么，如何从对应的程序头中获取ELF文件的一段名称呢？或者该`p_type`字段是否足以识别一个段，因此段没有名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T05:07:05.567

> 但是，段有名称（不是吗？）

不，他们没有。

> 还是 p_type 字段足以识别段，因此段没有名称？

正确的。

# java - Java 1.7 是否使用不同的字符编码？

> ID：13405775
> 
> 赞同：10
> 
> 时间：2012-11-15T20:36:56.937
> 
> 标签：java

我们正在将我们的应用程序从 Java 1.6 迁移到 Java 1.7。我们使用 Java 1.7 重新编译了代码，并在编译时收到了一个错误，这是由于一个字符 (an `Ó`)。

Java 1.7 中是否有与字符相关的变化？我们的应用程序对传入文件进行了大量处理，然后将它们加载到数据库中，我想确保当我们升级到 Java 1.7 时，从 java 读取文件并将该内容写入数据库不会导致一些奇数字符转换。

升级到 1.7 时我需要担心吗？如果是这样，我如何获得与 Java 1.6 中相同的编码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T20:52:05.650

发生错误是因为您告诉 Java 编译器您的源代码是 UTF-8 编码的，但它仍然包含一些 ISO-8859-1 扩展字符。我最近不得不修复从 1.5 迁移到 1.6 的代码库中的类似错误。我相信 Java 7 对 UTF-8 编码比以前的版本更严格，并且会在以前默默接受不正确编码的地方发出错误。

您需要确保您的源代码是“Unicode-clean”，也就是说，您必须将任何扩展的 ISO-8859-1 字符替换为其 Unicode 等效字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T15:20:27.447

我在 Windows 上遇到了这个问题，发现 1.7 的默认编码是`CP-1252`. 通过设置为以下环境变量，我能够获得干净的编译...

```
JAVA_TOOL_OPTIONS = -Dfile.encoding=UTF8 
```

# apache-flex - 用户界面布局算法

> ID：13405776
> 
> 赞同：1
> 
> 时间：2012-11-15T20:36:58.687
> 
> 标签：apache-flex, layout, user-interface, actionscript

我正在开发一个 UI 容器来保存 UI 组件，这些组件可以拖放到容器上，也可以在容器内移动组件。组件有各种尺寸。我在 flex/actionscript 中这样做，但我想这个问题适用于任何用户界面。是否有任何具有布局算法的资源（书籍等）。对此的任何指示都会有很大帮助。

用户可以拖放项目。但是这些项目应该重新排列，以免重叠。例如，如果有两个项目彼此相邻并且用户将第三个项目放在它们之上（在中间），则前两个项目应该移到一边为第三个项目腾出空间。（类似于examples.adobe.com/flex3/devnet/dashboard/main.html，但项目大小不同）。

仪表板布局的源代码假设所有组件都是相同的尺寸。我正在寻找的是一种布局不同尺寸组件的方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T22:55:35.023

我们过去曾为客户做过一些类似的工作。您需要的是碰撞检测算法的实现。请参阅此[http://code.google.com/p/collisiondetectionkit/](http://code.google.com/p/collisiondetectionkit/) 这里还有一篇关于代码项目的文章，它在 C# 中有一些布局实用程序，可以实现这个，您可能可以移植： http: [//www.codeproject.com/文章/23871/WPF-Diagram-Designer-Part-3](http://www.codeproject.com/Articles/23871/WPF-Diagram-Designer-Part-3)。还

# c++ - 在 Polynom 类中重载 += 运算符以添加多项式和常量

> ID：13405777
> 
> 赞同：0
> 
> 时间：2012-11-15T20:37:02.157
> 
> 标签：c++, class

我正在尝试以`+=`某种方式为我的模板 Polynom 类重载运算符，这样我就可以同时使用 Polynoms 和常量作为参数。

我在我的类中编写了一个构造函数和以下运算符：

```
Polynom(const T& num = 0) {
  coefs.push_back(num);
}
friend Polynom& operator += (Polynom& lhs, const Polynom& rhs) {
  ...
} 
```

它工作正常，我可以使用：`poly += 1;`. 当编译器遇到类似的事情时，它会做什么？它看到没有使用这些参数的 += 运算符：

```
(Polynom<int>& lhs, const int) 
```

但是有一个用于：

```
(Polynom<int>& lhs, const Polynom& rhs) 
```

所以，它试图转换`const int`为`const Polynom&`? 它为此使用构造函数，对吗？但是为什么在添加常量时这个声明不起作用：

```
Polynom& operator += (Polynom& rhs) {
  ...
} 
```

编译器说“与运算符 += 不匹配。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:49:31.130

将 a传递`int`给采用 a 的函数`const Polynom&`时，编译器能够从 构造一个临时`Polynom`对象`int`，然后将其绑定到`const Polynom&`参数。但是，参数不会发生这种情况，`Polynom&`因为临时对象不能绑定到非 const 引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:54:02.497

您需要向我们展示演示该问题的模板代码或最小的可编译代码。

尝试创建一个接受整数参数的方法：

```
friend Polynom& operator+=(const Polynom& lhs, int constant); 
```

我对您的表示法感到困惑，`Polynom<int>`这表明您的`Polynom`课程是一个模板。

# nservicebus3 - Nservicebus - 工作节点无法创建动态队列

> ID：13405780
> 
> 赞同：1
> 
> 时间：2012-11-15T20:37:16.077
> 
> 标签：nservicebus3

我们之前的配置声明 Nservicebus 不创建队列。我们从 fluent 中删除了该配置以允许创建队列。

通过每个工作节点唯一的动态队列创建，它不会为工作节点创建队列。

它抛出以下错误，

System.InvalidOperationException：输入队列有问题：FormatName:DIRECT=OS:machinename\private$\nodename.2b75b263-4511-43d8-83b9-e1de5710fcdb。有关详细信息，请参阅封闭的异常。---> System.Messaging.MessageQueueException: 队列不存在或您没有足够的权限来执行操作。
在 System.Messaging.MessageQueue.MQCacheableInfo.get_Transactional()
在 System.Messaging.MessageQueue.get_Transactional()
在 NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.QueueIsTransactional() 在 c:\TeamCity\buildAgent\work\nsb.master_2\ src\impl\unicast\queuing\NServiceBus.Unicast.Queuing.Msmq\MsmqMess ageReceiver.cs:line 124
--- 内部异常堆栈跟踪结束 ---
在 C:\TeamCity\buildAgent\work\nsb.master_2\src\impl\unicast\queuing\NServiceBus.Unicast.Queuing.Msmq\MsmqMess ageReceiver.cs:line 中的 NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.QueueIsTransactional() 130
在 C:\TeamCity\buildAgent\work\nsb.master_2\src\impl\unicast\queuing\NServiceBus.Unicast.Queuing.Msmq\ 中的 NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.Init（地址地址，布尔事务） MsmqMessageReceiver.cs：
C:\TeamCity\buildAgent\work\nsb.master_2\src\impl\un icast 中 NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.NServiceBus.Unicast.Transport.ITransport.Start（地址地址）的第 34 行\transport\NServiceBus.Unicast.Transport.Transactional\TransactionalTransport.cs：第 180 行
在 C:\TeamCity\buildAgent\work\nsb.master_2\src\unicast\NServiceBus.Unicast\UnicastBus.cs:line 828 中的 NServiceBus.Unicast.UnicastBus.NServiceBus.IStartableBus.Start(Action startupAction)

# c# - 用短日期构建动态 lambda 谓词

> ID：13405785
> 
> 赞同：1
> 
> 时间：2012-11-15T20:37:25.240
> 
> 标签：c#, reflection, lambda, predicatebuilder, predicates

我有以下代码可以帮助我通过反射构建 lambda 表达式。但是，当我尝试与 a 进行比较时，`Date`它会将我的值转换为完整的`DateTime`邮票。我怎样才能让它建立我的谓词，所以它只会比较短日期？

```
System.Reflection.PropertyInfo propInfo = typeof(T).GetProperty(property);
Type propertyType = propInfo.PropertyType;
if (Utilities.IsNullableType(propertyType))
{
    propertyType = Nullable.GetUnderlyingType(propertyType);
}
ParameterExpression propAlias = Expression.Parameter(typeof(T), alias);
MemberExpression left = Expression.Property(propAlias, property);
ConstantExpression right = Expression.Constant(Convert.ChangeType(value, propertyType));
BinaryExpression comparer = BuildComparisonExpression(left, right, comparison);
return Expression.Lambda<Func<T, bool>>(comparer, propAlias); 
```

我知道`Convert.ChangeType`是将字符串转换为 a的那个`DateTime`，但我得到的是`item => item.DateToCheck == 1/1/2012 12:00:00AM`，当我想要的时候`item => item.DateToCheck == 1/1/2012`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:34:24.730

您想传递`Convert.ChangeType(...)`第三个参数，该参数已经`IFormatProvider`用于此确切目的：`DateTimeFormatInfo`.

# sql - 创建具有 6 列中的 4 列唯一的表

> ID：13405789
> 
> 赞同：0
> 
> 时间：2012-11-15T20:37:40.003
> 
> 标签：sql, join

我有一个使用存储过程创建的原始表。结果表用于许多查询，所以我真的不想重新发明轮子。

我在表中有六列。我需要做的是创建该表的视图，其中 4 列作为一组是唯一的，其余列之一根据该组找到最大值。

例如：

```
col 1     col2     col3      col4     col 5     col 6
------------------------------------------------------
123       US       EA.COM    Good     5/1/12    456A
124       US       US.COM    Good     5/1/12    457A
124       US       EA.COM    Good     5/1/12    457A
124       US       EA.COM    Good     5/15/12   457A 
```

有了这套，我会得到 3 行回来

```
col 1     col2     col3      col4     col 5     col 6
------------------------------------------------------
123       US       EA.COM    Good     5/1/12    456A
124       US       US.COM    Good     5/1/12    457A
124       US       EA.COM    Good     5/15/12   457A 
```

我想要的是一组独特的 cols 1-4 和 col5 的最大值，然后 col 6 相当于 cols 1-5 的集合。我希望这是有道理的。在这个级别的 SQL 中，我超出了我的舒适区。

我已经尝试使用临时表并根据 cols 1-4 中的不同值加入，但还没有提出正确的语法。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:41:56.620

如果我正确理解了这个问题，您正在寻找`GROUP BY`：

```
SELECT col1, col2, col3, col4, max(col5), col6
FROM yourtable
GROUP BY col1, col2, col3, col4, col6 
```

# salesforce - 报告结果和安全性

> ID：13405794
> 
> 赞同：1
> 
> 时间：2012-11-15T20:37:59.257
> 
> 标签：salesforce, apex-code, soql

我想确保我理解了一些东西。

其中一位用户创建了一份报告，并返回了 1 条记录。当我运行她的报告时，它也返回了 1 条记录。当我从头开始重建报告时（我是系统管理员），我得到了 130 条记录，当我进行 SOQL 搜索时，它返回了 130 条记录。

这让我觉得在与此报告相关的权限方面发生了一些事情。

有人能告诉我这里发生了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:36:08.450

AHHH-我明白了，这是一个令人沮丧的！

该报告在 mdr 上，它旨在返回具有 1 个子项（内部联接）的记录。用户的报告包含来自主数据和明细数据的字段。

我的报告只有来自 master 的字段，因此它返回了所有记录。当我从详细信息中添加字段时，它又回到了 1。

修复：将报告类型从内连接更改为左连接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:46:54.747

1.  报告是否说“我的机会”之类的内容，而您构建的内容是否说“所有机会”。
2.  一些报告会记住他们的创建者在角色/区域层次结构中的位置（尤其是我认为与客户和机会相关的那些）。[你可以在这里](https://help.salesforce.com/HTViewSolution?id=000005351)阅读更多内容。因此，如果用户位于食物链的某个位置，但您位于顶部，这可能会解释这一点。我认为它不能在报告编辑器中的任何地方更改 - 只需运行它，检查报告顶部列出的层次结构，将层次结构更改为顶部角色并保存。
    *   没有角色 ( `WHERE Owner.UserRoleId = null`) 的用户是否拥有任何机会？如果它们完全超出了层次结构（或者如果您有 2 个分支），这可能就是原因。*这很愚蠢，但有时 IT 被告知将停用的用户移出角色树，而不将记录转移给他们的经理/同行。*
    *   如果在组织中启用了区域，则区域相同。
3.  如果这些都不起作用 - 您是否有机会通过单击仪表板中的图表访问报告？
4.  您是否 100% 报告上的所有“快速访问”过滤器在报告和 SOQL 中都以相同的方式设置：
    *   日期过滤器（设置为所有时间？）
    *   状态（全部？关闭？关闭赢了？）
    *   概率（全部？）
    *   机会团队...
    *   等等

* * *

你的分享有什么特别之处吗？组织范围的默认值？分享规则？它真的是机会还是一些自定义对象（甚至可能是 MD 中的一个细节？）......

# jquery - jquery隐藏/显示在IE中不起作用

> ID：13405795
> 
> 赞同：0
> 
> 时间：2012-11-15T20:38:15.893
> 
> 标签：jquery, internet-explorer

我有一组单选按钮和一个 div。When the page loads, I do not want the div visible, and when button 1-3 is selected, I want the div to show. 选择按钮4或5时，我不希望Div显示。

我目前在所有浏览器中都可以使用它，除了 IE（惊喜）。我似乎无法弄清楚出了什么问题。我用了萤火虫，没有错误。这是我所拥有的：

HTML：-按钮

```
<input type="radio" name="bWaitTime" value="1" id="group_name_0"/>
  &nbsp;&nbsp;
<input type="radio" name="bWaitTime" value="2" id="group_name_1"/>
  &nbsp;&nbsp;
<input name="bWaitTime" type="radio"  value="3" id="group_name_2"/>
  &nbsp;&nbsp;
<input type="radio" name="bWaitTime"  value="4" id="group_name_3"/>
  &nbsp;&nbsp;
<input type="radio" name="bWaitTime"  value="5" id="group_name_4"/> 
```

-要隐藏的 div

```
<div id="yes_box">
<!--Content Here -->
</div> 
```

这是我的脚本，目前位于 div #yes_box

```
 <script type="text/javascript">

          window.onload = $(function(){
                              var myDiv = $("#yes_box");
                              myDiv.hide();
                            });

          $(function(){

          var myDiv = $("#yes_box");

              $("input#group_name_0").change(function(){
                  myDiv.show('slow');  
              });
              $("input#group_name_1").change(function(){
                  myDiv.show('slow');  
              });
              $("input#group_name_2").change(function(){
                  myDiv.show('slow');  
              });
              $("input#group_name_3").change(function(){
                  myDiv.hide('slow');  
              });
              $("input#group_name_4").change(function(){
                  myDiv.hide('slow');  
              });

          });

          </script> 
```

我在其他地方看到过这种精确的方法，它在 IE 上没有问题，但是，在我的使用中，它根本不起作用。IE 完全忽略它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:40:32.723

认为问题出在这一行

```
window.onload = $(function() { 
```

应该是

```
$(window).load(function() { 
```

它可能无助于解决问题。您可以将事件处理程序压缩为单个处理程序..

并使用其中一个`$(window).load()` 或`DOM Ready`.. 两者都不是必需的

最初使用**CSS隐藏它**

```
​#yes_box
{
    display: none;
    width: 200px;
    height: 100px;
    background-color: orange;
}​ 
```

**Javascript**

```
$(window).load(function() {
    var myDiv = $("#yes_box");
    myDiv.hide();

    $("input[type='radio']").change(function() {
        var val = this.value;
        if (val == 1 || val == 2 || val == 3) {
            myDiv.show('slow');
        }
        else {
            myDiv.hide('slow');
        }
    });
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/nNwSV/1/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:44:02.193

更好地使用`jQuery`.ready *()*方法而不是*window.onload*

```
 $( document ).ready( function() {
          var myDiv = $("#yes_box");
          myDiv.hide();

          $("input#group_name_0").change(function(){
              myDiv.show('slow');  
          });
          $("input#group_name_1").change(function(){
              myDiv.show('slow');  
          });
          $("input#group_name_2").change(function(){
              myDiv.show('slow');  
          });
          $("input#group_name_3").change(function(){
              myDiv.hide('slow');  
          });
          $("input#group_name_4").change(function(){
              myDiv.hide('slow');  
          });

      }); 
```

**编辑：**

此外，如果所有 id 都与“group_name_n”模式匹配，您可以将所有*.change()*事件替换为单个事件：

```
 $("input[id^=group_name_]").change(function(){
          myDiv.show('slow');  
      }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:48:43.390

问题是您将 jQuery 对象传递给`window.onload`，它需要一个函数，例如

```
window.onload = function(){
    var myDiv = $("#yes_box");
    myDiv.hide();
}; 
```

如果您希望在页面加载时隐藏元素，那么最好使用 css 或当 DOM 准备好时在窗口加载之前触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:45:58.120

简化的代码是（*因为您的代码在我的系统上适用于 IE7、8、9*）

```
 <script type="text/javascript">
  $(function(){

      var myDiv = $("#yes_box").hide();

      $('input[name="bWaitTime"]').change(function(){
          var value = parseInt(this.value,10);
          if (value>=1 && value <=3){
              myDiv.show('slow'); 
          } else {
              myDiv.hide('slow'); 
          }
      });
  });
  </script> 
```

# ruby-on-rails - 服务器重启后如何重启 RoR 服务

> ID：13405797
> 
> 赞同：1
> 
> 时间：2012-11-15T20:38:20.850
> 
> 标签：ruby-on-rails, ubuntu, nginx, apache2, webserver

**更新**我一直在四处寻找，看看重启后我的项目中可能需要重启哪些服务。其中一个在想狮身人面像，我终于到了它记录的地步：

```
[Fri Nov 16 19:34:29.820 2012] [29623] accepting connections 
```

但我仍然无法运行 searchd 或 searchd --stop，因为在 etc/sphinxsearch 中没有生成 sphinx.conf 文件以获取更多信息，请参阅[重新启动后在 thinking_sphinx上打开的线程](https://stackoverflow.com/questions/13423400/setting-up-thinking-sphinx-after-server-reboot-rails-project)

然后，根据我得到的一些见解，我转向研究重新启动独角兽或瘦身。问题是，当我检查我的宝石时，我看到一颗是瘦的和独角兽。但是当我尝试启动其中任何一个时，它们没有驻留在 nginx 和 sphinxsearch 文件所在的 etc/init.d/ 中的文件...

重新启动会完全清除瘦或独角兽等应用服务器的文件吗？我们托管在 Rackspace 上运行

红宝石 1.9.2p290
导轨（3.2.8、3.2.7、3.2.0）
nginx/1.1.19

*   ***请注意，有独角兽和瘦的宝石，但我的应用程序的配置文件夹中没有 unicorn.rb 或 thin.rb ......如果有人能给我一些关于要采取的步骤的见解，我仍然非常迷茫我真的很感激。任何事情都会有所帮助，感谢阅读。***

瘦 1.4.1
独角兽 4.3.1

当我运行独角兽时，我遇到了与[此处引用的相同的问题](https://stackoverflow.com/questions/10763696/cannot-start-unicorn)：

```
> /usr/local/bin/unicorn start

/usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/lib/unicorn/configurator.rb:610:in `parse_rackup_file': rackup file (start) not readable (ArgumentError)
from /usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/lib/unicorn/configurator.rb:76:in `reload'
from /usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/lib/unicorn/configurator.rb:67:in `initialize'
from /usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:104:in `new'
from /usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:104:in `initialize'
from /usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/bin/unicorn:121:in `new'
from /usr/local/lib/ruby/gems/1.9.1/gems/unicorn-4.3.1/bin/unicorn:121:in `<top (required)>'
from /usr/local/bin/unicorn:19:in `load'
from /usr/local/bin/unicorn:19:in `<main>' 
```

当我运行瘦时，它只会打开一个命令行提示符......

```
/usr/local/bin/thin start

>> Using rack adapter 
```

其他宝石：

***当地宝石***

```
actionmailer (3.2.8, 3.2.7, 3.2.0)
actionpack (3.2.8, 3.2.7, 3.2.0)
activemodel (3.2.8, 3.2.7, 3.2.0)
activerecord (3.2.8, 3.2.7, 3.2.0)
activeresource (3.2.8, 3.2.7, 3.2.0)
activesupport (3.2.8, 3.2.7, 3.2.0)
arel (3.0.2)
builder (3.0.0)
bundler (1.1.5)
carmen (1.0.0.beta2)
carmen-rails (1.0.0.beta3)
cocaine (0.2.1)
coffee-rails (3.2.2)
coffee-script (2.2.0)
coffee-script-source (1.3.3)
daemons (1.1.9)
erubis (2.7.0)
eventmachine (0.12.10)
execjs (1.4.0)
faraday (0.8.4)
faraday_middleware (0.8.8)
foursquare2 (1.8.2)
geokit (1.6.5)
hashie (1.2.0)
hike (1.2.1)
httparty (0.8.3)
httpauth (0.1)
i18n (0.6.0)
journey (1.0.4)
jquery-rails (2.0.2)
json (1.7.4, 1.7.3)
jwt (0.1.5)
kgio (2.7.4)
lastfm (1.8.0)
libv8 (3.3.10.4 x86_64-linux)
mail (2.4.4)
mime-types (1.19, 1.18)
minitest (1.6.0)
multi_json (1.3.6)
multi_xml (0.5.1)
multipart-post (1.1.5)
mysql2 (0.3.11)
oauth2 (0.8.0)
paperclip (3.1.1)
polyglot (0.3.3)
rack (1.4.1)
rack-cache (1.2)
rack-ssl (1.3.2)
rack-test (0.6.1)
rails (3.2.8, 3.2.7, 3.2.0)
railties (3.2.8, 3.2.7, 3.2.0)
raindrops (0.10.0, 0.9.0)
rake (0.9.2.2, 0.8.7)
rdoc (3.12, 2.5.8)
riddle (1.5.3)
sass (3.2.0, 3.1.19)
sass-rails (3.2.5)
sprockets (2.1.3)
sqlite3 (1.3.6)
sqlite3-ruby (1.3.3)
therubyracer (0.10.2, 0.10.1)
thin (1.4.1)
thinking-sphinx (2.0.10)
thor (0.16.0, 0.15.4, 0.14.6)
tilt (1.3.3)
treetop (1.4.10)
tzinfo (0.3.33)
uglifier (1.2.7, 1.2.4)
unicorn (4.3.1)
xml-simple (1.1.1) 
```

* * *

我正在做一个由另一个小组建造的项目。我对配置文件夹中的常量文件进行了一些修改（更改填充了一些下拉字段的数组的一些值），但必须重新启动应用程序才能识别这些更改。托管是通过 Rackspace 进行的，我们通过他们网站上的选项重新启动。我联系了他们并检查了我们服务器的状态，端口已打开且可操作。问题是当您转到该站点的地址时，该应用程序没有运行。然后，当我输入服务器的 IP 地址时，它只会显示“欢迎使用 Nginx”。但在日志文件中我看到：

```
[Thu Nov 15 02:34:37.945 2012] [15916] caught SIGTERM, shutting down
[Thu Nov 15 02:34:37.996 2012] [15916] shutdown complete 
```

我不是很精通服务器端设置。我也从未参与过必须在应用程序启动之前启动特定服务的 Rails 项目。任何有关如何确定需要重新启动哪些服务以及如何重新启动它们的见解将不胜感激。这一刻，我感觉自己死在了水里……

谢谢，

艾伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:25:12.553

Nginx 本身不会为 Rails 应用程序提供服务。它需要一个“应用服务器”，它可以将请求传递给并获得响应。有多种选择，最受欢迎的是Passenger、Thin 和Unicorn。我建议你从服务器上的 nginx 配置开始，看看是否提到了这些。这应该指向您如何重新启动它们。

[http://www.modrails.com/documentation/Users%20guide%20Nginx.html](http://www.modrails.com/documentation/Users%20guide%20Nginx.html)

[http://articles.slicehost.com/2008/5/27/ubuntu-hardy-nginx-rails-and-thin](http://articles.slicehost.com/2008/5/27/ubuntu-hardy-nginx-rails-and-thin)

[http://sirupsen.com/setting-up-unicorn-with-nginx/](http://sirupsen.com/setting-up-unicorn-with-nginx/)（向下滚动到 Rails on Unicorns）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T21:54:28.480

好的，经过数小时的搜索和尝试，我在网上找到了无数的东西，我从命令行运行了这个：

```
unicorn_rails -p 3000 
```

就像魔术一样，该站点已重新启动并运行，现在我的问题是当我关闭控制台（我运行该命令）时，该站点再次出现故障。

我将[按照这个](http://codelevy.com/2010/02/09/getting-started-with-unicorn.html)希望解决这个问题

**注意：**这些是我为使事情正常工作而采取的步骤

重新启动服务器时，您必须重新启动一些服务才能访问应用程序：

1) thinking_sphinx
***参考网站***
[http://pat.github.com/ts/en/rake_tasks.html](http://pat.github.com/ts/en/rake_tasks.html)
[http://www.claytonlz.com/2010/09/thinkingsphinx-conf-problems/](http://www.claytonlz.com/2010/09/thinkingsphinx-conf-problems/)

```
a)create/modify  app/config/sphinx.yml

    development:
      morphology: stem_en
      port: 9312
      bin_path: "/usr/bin"             # set up the path to binary for searchd
      searchd_binary_name: searchd
      indexer_binary_name: indexer
      #mem_limit: 128M
    test:
      morphology: stem_en
      port: 9312
      mem_limit: 128M
    production:
      morphology: stem_en
      port: 9312
      mem_limit: 512M
    # the searchd ip, in case it's not on localhost
    # address: 10.10.0.0
    # this is by default included in db/sphinx
    # searchd_file_path: "/path/to/shared/folder/sphinx"

b)rake thinking_sphinx:index
c)rake thinking_sphinx:configure       # creates config/development.sphinx.conf which helps define sphinx's indexing

d)# then you have to start sphinx, there are 2 ways to do this

    rake thinking_sphinx:start
    rake thinking_sphinx:stop

    OR

    searchd
    searchd --stop

    # only the rake commands worked for me, when I tried to run searchd
    # I got an error FATAL: no readable config file (looked in /etc/sphinxsearch/sphinx.conf, ./sphinx.conf).
    # for some reason we dont have a sphinx.conf file, but the rake commands work without it

e)# once you start thinking_sphinx check log/searchd.log file for the line
    [Fri Nov 16 19:34:29.820 2012] [29623] accepting connections 
```

2）nginx
***参考站点：***
[http ://wiki.nginx.org/CommandLine](http://wiki.nginx.org/CommandLine)

```
a) check that nginx is up and running
    i) start server 
        # to check where nginx resides type in this into server console
        which nginx
        # whatever path it gives you is how you start the server this is my path
        /usr/sbin/nginx 
    ii) stop server
        /usr/sbin/nginx -s stop # use the path given by which command 
```

3）独角兽（启动应用服务器）
***参考站点：***
[http ://codelevy.com/2010/02/09/getting-started-with-unicorn.html](http://codelevy.com/2010/02/09/getting-started-with-unicorn.html)

```
a) test if unicorn will run after previous changes
    unicorn_rails -p 3000
    # the site should now be up and running, check that it is
    # console should now log the different actions you do on the site 

b) create unicorn.rb in config folder (if none is there)
    # only start this step if the step above got the site running
    # close the console or exit the process you started above
    # contents of unicorn.rb 
    worker_processes 2      #(starts 2 child processes, not completely neccissary)
    preload_app true
    timeout 30
    listen 3000

    after_fork do |server, worker|
      ActiveRecord::Base.establish_connection
    end

c) run unicorn in the background
    # make sure you exited the process above before running this
    unicorn_rails -c config/unicorn.rb -D

    # this was giving me an error that it said was logged by stderr
    # I got the command to run by adding a command to the front
    http://stackoverflow.com/questions/2325152/check-for-stdout-or-stderr

    exec 2> /dev/null unicorn_rails -c config/unicorn.rb -D

d) (optional) check stats from starting unicorn

    i) pgrep -lf unicorn_rails
        #sample output
        5374 unicorn_rails master -c config/unicorn.rb -D             
        5388 unicorn_rails worker[0] -c config/unicorn.rb -D    # not needed currently  
        5391 unicorn_rails worker[1] -c config/unicorn.rb -D    # not needed currently

    ii) cat tmp/pids/unicorn.pid # from inside the streetpotato folder
        #sample output
        5374 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-31T00:15:53.383

我知道我来晚了，但你正在运行的过程：

```
unicorn_rails -p 3000 
```

默认情况下关闭会话时会死。如果您希望它继续运行而不死，请运行：

```
nohup unicorn_rails -p 3000 & 
```

'nohup' 代表“无挂断”，即使在你掉线后也能保持进程运行。'&' 告诉操作系统在后台将其作为作业运行。

希望这能帮上忙！

# javascript - 我正在构建一个使用 3D UI 元素和动画的 HTML 应用程序。有哪些工具和库我可能会觉得有用？

> ID：13405800
> 
> 赞同：-2
> 
> 时间：2012-11-15T20:38:34.343
> 
> 标签：javascript, html, css, css-transitions, css-animations

因此，我计划创建一个使用 3 维 UI 元素和动画过渡来创建丰富用户体验的 Web 应用程序。您会推荐我使用哪些工具和库来使此应用程序的开发尽可能快速和顺利进行？（也许是三个.js？）

具体来说，我正在寻找能够轻松创建 3D UI 元素和处理 CSS 转换的开发库和工具。我还对包含对优雅降级的某种程度的支持感兴趣，这样事情就不会在旧版和移动浏览器上完全停止工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:48:59.660

根据您的需要，[Dom3D](http://jlongster.com/s/dom3d/ "Dom3D")可能*有用。

考虑到它是在常规 DOM 元素（没有画布、扩展或插件）上使用 CSS3 转换完成的，我认为它做得很好。

*如果您需要像素完美或超级光滑的图形，尽管 Dom3D 可能不适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:41:12.767

**[WebGL](https://developer.mozilla.org/en-US/docs/WebGL)**：

> WebGL 通过引入一个非常符合 OpenGL ES 2.0 的 API 将 3D 图形引入 Web，该 API 可用于 HTML5 画布元素。Firefox 4+、Google Chrome 9+、Opera 12+ 和 Safari 5.1+ 支持 WebGL。

为了更有帮助，你需要提供比你*想要*完成的更多的东西。**规格**、**示例代码**、**您尝试过**的内容以及**遇到的问题**都是我们希望在这里看到的，以帮助回答您的问题。

你的目标是什么**浏览器/版本**，你研究过什么技术，这将用于什么？在不知道血淋淋的**细节**的情况下，人们真的很难提供帮助。

**[Creativejs](http://creativejs.com/about/)**可能是你感兴趣的东西。

**[Three.js](http://mrdoob.github.com/three.js/)**，正如您在上面所问的，也是一个不错的库。

**[这里](https://github.com/bebraw/jswiki/wiki/WebGL)**还有很多其他的很好的列表。

**编辑：**

如果是这种情况，那么上面链接中的大多数库都可以满足您的需求。我建议仔细研究其中的一些并尝试一些教程。

# javascript - Javascript 检查 NaN - 结果与预期不符

> ID：13405804
> 
> 赞同：1
> 
> 时间：2012-11-15T20:39:14.417
> 
> 标签：javascript, nan

我有一个通过 ajax 读取数字的应用程序，该数字是十六进制的，我对其进行解析并转换为十进制。

这些数字是通过无线串行链路输入的，并不是 100% 可靠的，所以我需要在开始处理数据之前检查它们。以数字`****025781610403e5****`为例。这`****`只是检查我过去在非基于 Web 的项目中使用的数字的开始和结束的一种方式，并且可以更改。

无论如何，最后我的问题是：作为错误检查的一部分，我想我会检查 NaN，因为我在测试时确实遇到了 NaN 错误，但是虽然`*1234`给出了肯定的 NaN`12**34`却没有，为什么会这样？我还能做些什么来测试？

这是我使用的一些代码，请注意我对javascript相当陌生。

```
function readSliceConvert()
{
    functionReadForm()
    testVal = hexString.slice(4,18);
    document.getElementById("battDb4").innerHTML=testVal;
    testNum1 = h2d(testVal)
    document.getElementById("battDb5").innerHTML=testNum1.toString();
    testNum2 = parseInt(testVal);
    document.getElementById("battDb6").innerHTML=testNum2.toString();
    if (isNaN(testNum2))
    {
        errorCount++;
        document.getElementById("battDb3").innerHTML=errorCount.toString();
        document.getElementById("battDb4").innerHTML=testVal;

        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:47:50.717

那是因为您正在使用`parseInt`，当它可以解析的字符串开头有一些数字时，它会默默地忽略字符串末尾的字符。

我不知道您的`h2d`函数在做什么，但似乎您正在将十六进制字符串转换为数字，然后转换为十进制形式的字符串，然后再转换回数字。我看不出解析十六进制字符串的输出不能是数字的任何原因。

例如像这样，如果解析失败则返回 null：

```
function h2i(str) {
  var num = 0;
  var digits = "0123456789abcdef";
  str = str.toLowerCase();
  for (var i = 0; i < str.length; i++) {
    var n = digits.indexOf(str.substr(i, 1));
    if (n == -1) return null;
    num = num * 16 + n;
  }
  return num;
} 
```

演示：http: [//jsfiddle.net/Guffa/6yAaP/](http://jsfiddle.net/Guffa/6yAaP/)

用法：

```
testVal = hexString.slice(4,18);
document.getElementById("battDb4").innerHTML = testVal;
testNum = h2i(testVal)
document.getElementById("battDb5").innerHTML = testNum.toString();
if (testNum == null)
{
  errorCount++;
  document.getElementById("battDb3").innerHTML = errorCount.toString();
  document.getElementById("battDb4").innerHTML = testVal;
  return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:46:40.117

您会看到奇怪的行为，因为[isNan 已损坏](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/isNaN#Description)（有关详细信息，请参阅 mozilla 文档）。

测试数据格式是否正确的更好方法是使用快速正则表达式，例如`serial.test(/^\d+$/)`，如果整个序列完全是数字，`serial.test(/^\*{4}\d+\*{4}$/)`它将成功，或者如果序列是四个星号，后跟一个或多个数字，然后是另外四个星号。

更新：@Guffa 的答案是正确的，应该被接受，但我将把它留在这里，因为我认为从大局来看有一个有效的论点，你可以更好地完成你想要用正则表达式做的事情。

对字符串运行[test](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/test)会执行提供的正则表达式，`true`如果它与字符串匹配则返回。

正则表达式只是描述文本的模式，它可以非常复杂，也可以像我给出的示例一样简单（`\d+`意味着匹配一个数字（`\d`）一次或多次（`+`），锚点用于开头（`^`）和结尾（`$`） string 表示我们想要匹配整个字符串，而不仅仅是它的一部分。它们非常有用，所以几乎可以肯定值得花时间学习它们如何工作的基础知识，并随着时间的推移扩展你的知识。有一个关于[regular-expressions.info](http://www.regular-expressions.info/tutorial.html)的精彩教程，可让您立即开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:08:40.853

你知道 parseInt() 是做什么的吗？

来自[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)

> parseInt 是一个顶级函数，不与任何对象关联。
> 
> parseInt 函数将其第一个参数转换为字符串，对其进行解析，并返回一个整数或 NaN。如果不是 NaN，则返回值将是第一个参数的十进制整数表示形式，该参数采用指定基数（基数）中的数字。例如，基数 10 表示从十进制数、8 位八进制数、16 位十六进制数等转换。对于大于 10 的基数，字母表中的字母表示大于 9 的数字。例如，对于十六进制数（以 16 为基数），使用 A 到 F。
> 
> **如果 parseInt 在指定的基数中遇到不是数字的字符，它会忽略它和所有后续字符并返回解析到该点的整数值。**parseInt 将数字截断为整数值。允许前导和尾随空格。

在控制台中运行代码

```
console.log( parseInt("12**34",10) ); 
```

因此，您正在针对一个数字运行 isNaN，因为 parseInt 返回 12。

当您将 * 作为第一个字符时，没有要返回的前导数字。

```
console.log( parseInt("*1234",10) ); 
```

# groovy - GPars 报告大量异步函数的状态并等待完成

> ID：13405806
> 
> 赞同：2
> 
> 时间：2012-11-15T20:39:15.120
> 
> 标签：groovy, gpars

我有一个解析器，在为一行收集数据之后，我想触发一个 aync 函数并让它处理该行，而主线程继续运行并获取下一行。

我看过这篇文章：[如何在 Groovy 中同时执行两个任务并等待结果？](https://stackoverflow.com/questions/11529521/how-do-i-execute-two-tasks-simultaneously-and-wait-for-the-results-in-groovy?rq=1)但我不确定这是适合我情况的最佳解决方案。

我想要做的是，在读取所有行之后，等待所有异步函数完成，然后再继续。使用 Promise 集合的一个问题是列表可能很大（100,000+）。

另外，我想在我们进行时报告状态。最后，我不确定是否要自动等待超时（例如在 get() 上），因为文件可能很大，但是，我确实希望允许用户出于各种原因终止该进程。

所以我现在所做的是记录解析的行数（因为它们通过**rowsRead**发生），然后使用来自 Promise 的回调来记录正在完成处理的另一行，如下所示：

```
def promise = processRow(row)
promise.whenBound {
    rowsProcessed.incrementAndGet()
} 
```

其中**rowsProcessed**是一个 AtomicInteger。

然后在工作表末尾调用的代码中，在完成所有解析并且我正在等待处理完成之后，我正在这样做：

```
boolean test = true
while (test) {
    Thread.sleep(1000)  // No need to pound the CPU with this check
    println "read: ${sheet.rowsRead}, processed: ${sheet.rowsProcessed.get()}"
    if (sheet.rowsProcessed.get() == sheet.rowsRead) {
        test = false
    }
} 
```

好消息是，我这里没有 Promise 对象的爆炸 - 只是一个简单的计数来检查。但我不确定经常睡觉是否与检查每个 Promise() 对象上的 get() 一样有效。

所以，我的问题是：

1.  如果我改用 Promises 的集合，如果执行上述 while 循环的线程被 Thread.interrupt() 中断，get() 会做出反应并返回吗？
2.  使用 Promises 集合并在每个上调用 get() 会比尝试睡眠并经常检查更有效吗？
3.  有没有我没有考虑过的另一种更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T10:35:06.143

1.  如果等待（主）线程被中断，调用 allPromises*.get() 将抛出 InterruptedException
2.  是的，无论如何都已经创建了承诺，因此在我看来，将它们分组到一个列表中不应强加额外的内存要求。
3.  使用 CountDownLanch 或 Phaser 的建议解决方案比使用忙等待更适合 IMO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:19:39.177

a的替代方法`AtomicInteger`是使用 a [`CountDownLatch`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CountDownLatch.html)。它避免了对象`sleep`的大集合`Promise`。你可以像这样使用它：

```
latch = new CountDownLatch(sheet.rowsRead)
...
def promise = processRow(row)
promise.whenBound {
    latch.countDown()
}
...
while (!latch.await(1, TimeUnit.SECONDS)) {
    println "read: ${sheet.rowsRead}, processed: ${sheet.rowsRead - latch.count}"
} 
```

# android - Android：以编程方式打开 GPS

> ID：13405812
> 
> 赞同：0
> 
> 时间：2012-11-15T20:39:48.863
> 
> 标签：android, geolocation

> **可能重复：**
> [像 Tasker 一样以编程方式启用 GPS](https://stackoverflow.com/questions/4721449/enable-gps-programatically-like-tasker)

全部，

我在这个论坛上看到了我们不能打开 gps 编程盟友的大多数答案。我想知道在 Android 市场上可用的一些应用程序中，它们是怎么做的？我尝试了这个论坛中解释的大部分内容，它总是提示用户启用基于位置的服务。

还有其他想法吗？

谢谢，拉梅什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T22:33:20.697

不知道“打开它”是什么意思。你的意思是启用还是禁用它？该线程讨论了一些通过利用错误来启用或禁用它的方法：[如何在 Android 上以编程方式启用或禁用 GPS？](https://stackoverflow.com/questions/4721449). 不过我不会使用这种方法，因为它不适用于已修复错误的设备。最好将用户转发到设置应用程序并让他们启用 gps。

假设它已启用，您的意思是打开还是关闭以使用它？你不需要这样做。只需使用正确的位置提供程序调用 LocationManager.requestLocationUpdates()，系统就会为您打开它。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-15T20:55:37.930

你看过这里吗？

[http://developer.android.com/guide/topics/location/strategies.html](http://developer.android.com/guide/topics/location/strategies.html)

您可以做的是断言启用了哪种类型的位置提供程序，检查它是否是 GPS，如果不是则添加此以提示用户打开 GPS（请确保运行较长的 Toast 以让用户知道启用 GPS 定位和启用后点击后退按钮）：

```
 ComponentName intentComponent = new ComponentName("com.android.settings", "com.android.settings.LocationSettings");
          Intent mainIntent = new Intent("android.intent.action.MAIN");
          mainIntent.setComponent(intentComponent);
          startActivity(mainIntent); 
```

# c++ - SDL，随机颜色生成器

> ID：13405815
> 
> 赞同：1
> 
> 时间：2012-11-15T20:40:02.363
> 
> 标签：c++, random, colors, sdl

我的朋友给了我一些 SDL 程序的代码，我只知道它会产生随机颜色，但我不知道它是如何工作的，这是代码

```
 int unsigned temp = 10101;//seed
    for(int y = 0;y < times;y++){
        temp = temp*(y+y+1);
        temp = (temp^(0xffffff))>>2;
        //printf("%x\n",temp);
        SDL_FillRect(sprite[y],NULL,temp);
        SDL_BlitSurface(sprite[y],&paste[y],rScreen(),NULL);
        } 
```

我的问题是，这段代码是如何工作的，它是如何产生随机颜色的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:48:11.603

您的朋友正在从他发明的一些业余 PRNG 中创建一个范围从 0x000000 到 0xFFFFFF 的“随机 RGB 值”。

我将用注释解释代码：

这就是所谓的“种子”。将生成伪随机值序列的初始值。

```
 int unsigned temp = 10101; //seed 
```

然后我们得到了for循环：

```
 for(int y = 0;y < times;y++)
 {
    temp = temp*(y+y+1);
    temp = (temp^(0xffffff))>>2; 
```

每一轮你的朋友都试图进行复杂的乘法和求和，以得出一个新的临时值，该值除以 2（上面代码中的 >>2），然后用 0xFFFFFFF 屏蔽以获得 0x000000 到0xFFFFFFF（他错误地使用了按位 XOR ^ 而不是按位 AND &）

结果值用作 SDL_FillRect() 函数的 RGB 值。

```
 //printf("%x\n",temp);
    SDL_FillRect(sprite[y],NULL,temp);
    SDL_BlitSurface(sprite[y],&paste[y],rScreen(),NULL);
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:47:44.467

神奇之处在于这四行：

```
unsigned int temp = 10101; // seed - this seeds the random number generator

temp = temp * (y + y + 1); // this performs a multiplication with the number itself and y
// which is incremented upon each loop cycle
temp = (temp ^ 0xffffff) >> 2; // this reduces the generated random number
// in order it to be less than to 2 ^ 24
SDL_FillRect(sprite[y], NULL, temp); // and this fills the rectangle using `temp` as the color
// perhaps it interprets `temp` as an RGB 3-byte color value 
```

# java - 在 while 循环中正确使用 BufferedReader.readLine()

> ID：13405822
> 
> 赞同：25
> 
> 时间：2012-11-15T20:40:23.767
> 
> 标签：java, bufferedreader

所以我在将文本文件读入我的程序时遇到问题。这是代码：

```
try {
    InputStream fis = new FileInputStream(targetsFile);
    BufferedReader br = new BufferedReader(new InputStreamReader(fis));

    //while(br.readLine()!=null){
    for (int i = 0; i < 100; i++) {
        String[] words = br.readLine().split(" ");
        int targetX = Integer.parseInt(words[0]);
        int targetY = Integer.parseInt(words[1]);
        int targetW = Integer.parseInt(words[2]);
        int targetH = Integer.parseInt(words[3]);
        int targetHits = Integer.parseInt(words[4]);
        Target a = new Target(targetX, targetY, targetW, targetH, targetHits);
        targets.add(a);
    }
    br.close();
} catch (Exception e) {
    System.err.println("Error: Target File Cannot Be Read");
} 
```

我正在读取的文件是 100 行参数。如果我使用 for 循环，它会完美运行。如果我使用 while 语句（在 for 循环上方注释掉的那个），它会在 50 处停止。用户有可能使用具有任意行数的文件运行程序，因此我当前的 for 循环实现不会不工作。

为什么线路`while(br.readLine()!=null)`停在50？我检查了文本文件，没有任何东西可以挂断它。

当我使用 while 循环时，我没有从 try-catch 中得到任何错误，所以我很难过。有人有想法么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2014-02-11T15:33:56.853

也很全面...

```
try{
    InputStream fis=new FileInputStream(targetsFile);
    BufferedReader br=new BufferedReader(new InputStreamReader(fis));

    for (String line = br.readLine(); line != null; line = br.readLine()) {
       System.out.println(line);
    }

    br.close();
}
catch(Exception e){
    System.err.println("Error: Target File Cannot Be Read");
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-11-15T20:41:57.173

您在`br.readLine()`循环内第二次调用。因此，您每次四处走动时
最终都会阅读*两行。*

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-03-27T04:33:42.530

您可以使用如下结构：

```
 while ((line = bufferedReader.readLine()) != null) {
            System.out.println(line);
        } 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-12-01T20:26:23.027

如果您仍然在这个问题上绊倒。如今，Java 8 看起来更好：

```
try {
  Files.lines(Paths.get(targetsFile)).forEach(
    s -> {
      System.out.println(s);
      // do more stuff with s
    }
  );
} catch (IOException exc) {
  exc.printStackTrace();
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-11-15T20:55:36.017

感谢 SLaks 和 jpm 的帮助。这是一个非常简单的错误，我根本没有看到。

正如 SLaks 指出的那样，每个循环都会调用 br.readLine() 两次，这使得程序只能获得一半的值。这是固定代码：

```
try{
        InputStream fis=new FileInputStream(targetsFile);
        BufferedReader br=new BufferedReader(new InputStreamReader(fis));
        String words[]=new String[5];
        String line=null;
        while((line=br.readLine())!=null){
            words=line.split(" ");
            int targetX=Integer.parseInt(words[0]);
            int targetY=Integer.parseInt(words[1]);
            int targetW=Integer.parseInt(words[2]);
            int targetH=Integer.parseInt(words[3]);
            int targetHits=Integer.parseInt(words[4]);
            Target a=new Target(targetX, targetY, targetW, targetH, targetHits);
            targets.add(a);
        }
        br.close();
    }
    catch(Exception e){
        System.err.println("Error: Target File Cannot Be Read");
    } 
```

再次感谢！你们太棒了！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-04-14T07:23:28.670

概念解决方案：br.read() 返回特定字符的 int 值，因此循环继续，直到我们不会得到 -1 作为 int 值，因此到那里它打印 br.readLine()，它将一行返回为 String 形式。

```
 //Way 1:
    while(br.read()!=-1)
    {
      //continues loop until we won't get int value as a -1
      System.out.println(br.readLine());
    }

    //Way 2:
    while((line=br.readLine())!=null)
    {
      System.out.println(line);
    }

    //Way 3:
    for(String line=br.readLine();line!=null;line=br.readLine())
    {
      System.out.println(line);
    } 
```

方式4：这是一种使用集合和数组概念读取文件的高级方式我们如何使用for每个循环进行迭代。在这里查看 [http://www.java67.com/2016/01/how-to-use-foreach-method-in-java-8-examples.html](http://www.java67.com/2016/01/how-to-use-foreach-method-in-java-8-examples.html)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-04-24T14:26:29.380

除了@ramin 给出的答案之外，如果您已经拥有`BufferedReader`or `InputStream`，则可以遍历如下行：

```
reader.lines().forEach(line -> {
    //...
}); 
```

或者如果您需要按照给定的顺序处理它：

```
reader.lines().forEachOrdered(line -> {
    //...
}); 
```

# ios - 在 iOS 上安装证书

> ID：13405824
> 
> 赞同：1
> 
> 时间：2012-11-15T20:40:29.597
> 
> 标签：ios, ssl, certificate

首先，请原谅我对这个主题的无知——我仍在阅读它。

我们正在使用第 3 方库来播放受 DRM 保护的视频，并且我们需要在某个时候安装一个 certificate.der 文件。

这安装在设置 > 配置文件中。但是当我们安装它时，它显示它是“不可信的”。然后，当您单击安装时，您会收到一条警告，表明它不受信任，但是当您再次单击安装时，它变得受信任（因为您明确信任它）。

我需要采取哪些步骤才能使 certificate.der 文件从一开始就被读取为“受信任”？我需要得到权威机构的“签名”吗？我可以自己签名吗？

任何提示都会非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T21:05:12.170

实际上，您可以使用 MDM 服务器或 iPhone 配置实用程序[http://support.apple.com/kb/DL1465](http://support.apple.com/kb/DL1465)将受信任的根证书添加到 iOS 设备。

或者，用户可以通过电子邮件或 Safari 手动安装受信任的 CA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:39:29.460

是的，它必须由受信任的 CA 签名。afaik 你不能安装添加。iPhone 上的根 CA，因此获得受信任的证书

# ruby-on-rails - IIS将客户端证书传递给rails

> ID：13405828
> 
> 赞同：2
> 
> 时间：2012-11-15T20:40:41.873
> 
> 标签：ruby-on-rails, ruby-on-rails-3, iis-7

我有一个用 Rails 编写的应用程序，由于客户政府的限制，它必须在 IIS 服务器后面运行。我们必须进行 SSL 身份验证。所以在我搜索谷歌的几个小时里，我无法弄清楚如何让 IIS 将客户端证书传递给 rails 服务器（瘦）。

我看过关于 Apache 的教程使用：

```
SSLOptions +ExportCertData 
```

然后使其可用于请求对象。关于如何配置 IIS 来做同样的事情的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:53:48.873

被告知这可能是不可能的。我终于想通了！这是我采取的步骤。

1.  使用 OpenSSL 创建您自己的 CA 证书。
2.  使用生成的 CA 证书创建并使用 Open SSL 签署其他证书。
3.  打开 Internet 信息服务管理器，单击服务器，然后单击服务器证书。![服务器证书](../Images/1c07936f7bdb50a78a40a3fbf1f63723.png)
4.  单击操作列下的导入
5.  导入后点击您的网站。
6.  在操作列中单击绑定...
7.  单击添加，滚动到 https，然后选择您导入的 CA 证书
8.  再次单击您的站点以进入菜单并单击 SSL 设置
9.  检查要求 SSL，然后单击单选按钮，要求
10.  再次单击您的站点然后单击配置编辑器（安装在 IIS 7.5 中可以在 7.0 中加载） ![配置编辑器](../Images/bcad6af4417b5d1aa537115a609ef227.png)
11.  转到 system.webServer/security/authentication/iisClientCertificateMappingAuthentication
12.  设置启用为真
13.  将 manyToOneCertificateMappings 设置为 true
14.  单击 manyToOneMappings 最右端的 ... 框![配置编辑器](../Images/73170208ba94032bbfaa7cf983c48a15.png)
15.  单击集合下的操作列下的添加
16.  添加您创建的用户的用户名和密码（可以在本地机器上）![... 盒子](../Images/a3d8cf11783e3670780e449ef4a08db3.png)
17.  现在，转到主服务器并重新启动。
18.  您应该能够使用 request.headers 哈希查看证书。

哈希变量包括：

*   CERT_SERIALNUMBER
*   CERT_SUBJECT
*   CERT_ISSUER
*   HTTPS_SERVER_ISSUER
*   HTTPS_SERVER_SUBJECT

如果您找不到某些东西，您可能必须安装一个模块（用于类似身份验证）。我不记得我安装了哪些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T11:48:39.843

公司想要在 IIS 服务器后面运行 Rails（或其他）应用程序的主要原因是为了 SSO，而不是保护资源。

看看这是否有帮助。

我们已经在很多客户地点在 IIS 后面运行我们的 Rails 应用程序。我们在 Tomcat 内的 JRuby 中运行我们的 Rails 应用程序。

安装 JK ISAPI 重定向器插件的步骤在这里

```
http://tomcat.apache.org/connectors-doc/webserver_howto/iis.html 
```

使用标准 IIS 身份验证方案、集成 Windows 身份验证（协商、NTLM）在 IIS 中保护所有 Rails 上下文。

在 Rails 应用程序中，可以获取登录用户的信息。

```
request.env['java.servlet_request'].get_remote_user 
```

Rails 应用程序还连接到 Microsoft AD 以获取其他用户信息，例如电子邮件、部门等，

由于 Rails 盲目信任 IIS 服务器进行身份验证，因此需要防止其直接访问。

```
1\. Disable HTTP ports in Tomcat
2\. Enable only the AJP port
3\. Add an IP restriction so that it accepts connection only from the IIS server(s) 
```

== 我认为 IIS 不可能传递证书详细信息。我们试图提取 Kerboros 令牌（用于 kerboros 身份验证委托）但没有取得多大成功，并意识到这是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T00:58:42.593

至少以您提出问题的方式 IIS 无法提供客户端证书，因为客户端证书将由第三方颁发。因此，您需要获取您的应用程序的 x509 证书，然后将该证书作为与 iis 的初始连接请求的一部分进行身份验证。

至于 apache 功能将 ssl 证书从服务器提供给客户端，iis 没有公开此功能。

这就是为什么你在谷歌上找不到任何东西的原因

# arrays - 如何在数组中查找布尔值？

> ID：13405831
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:40:47.737
> 
> 标签：arrays, for-loop, boolean, filtering, nspredicate

我有一个对象数组，每个对象都包含一个带有是或否的布尔值。我想将所有带有 bool YES 的对象复制到另一个数组。我怎样才能做到这一点？我考虑过使用谓词过滤数组或将其集成到 for 循环中，但我似乎无法正确处理。

我需要这样的东西：

```
for (BOOL* opslag_Set in [dataSource allKeys]){
    NSArray *array = [dataSource objectForKey:opslag_Set];
    for (int j = 0; j < [array count]; j++) {
        if ([[array objectAtIndex:j] isEqualToString:@"YES"]) {
            add object to another array;
        }
    }
} 
```

我的数组的第一个对象：

```
 },
    {
    Dato = "2012-11-07 16:20:57 +0000";
    Forfatter = "Vej 51, st. tv.";
    Indhold = "Referat af beboerm\U00f8de";
    "Opslag_set" = 0;
    Overskrift = "Beboerm\U00f8de";
    Prioritet = 0;
    Svar =         (
                    {
            Dato = "2012-11-07 16:23:07 +0000";
            Forfatter = "6\. tv.";
            Indhold = "Fedt fedt fedt";
        }
    );
}, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:54:09.060

您必须使用`NSNumber`才能将布尔值存储在数组中。

假设您的布尔数组被调用`boolArray`，那么获取数组的代码`YES`将是这样的：

```
NSMutableArray* temp = [NSMutableArray new];
for (NSNumber* value in boolArray)
{
    if ([value boolValue])
    {
        [temp addObject:[NSNumber numberWithBool:YES]];
    }
} 
```

但是，您为什么要这样做？这将返回一个数组，其中包含一定数量的相同元素。如果这是你想要的，你可以数数。我能想到的另一件事是您有一个具有 bool 属性的对象，在这种情况下您可以轻松地调整上面的代码。

**编辑：**好的，假设我们有一个名为的对象`MyDataObject`，它有一个 bool 属性 - `NSNumber* boolProperty`。这是代码：

```
NSMutableArray* temp = [NSMutableArray new];
for (MyDataObject* value in boolArray)
{
    if ([value.boolProperty boolValue])
    {
        [temp addObject:value];
    }
} 
```

这应该适用于您正在做的事情。`temp`将引用原始对象 - 它们不会被复制。

# iphone - NSRegularExpression 没有得到准确的文本

> ID：13405836
> 
> 赞同：0
> 
> 时间：2012-11-15T20:41:33.163
> 
> 标签：iphone, ios, xcode, ipad, xcode4.5

我有一个像这样的字符串：

```
<book>MyBook</book><value>myValue</value> 
```

现在我想从这个字符串中获取文本“myValue”。我想使用 NSRegularExpression 来做到这一点。我试过这个：

```
 NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"(<book>MyBook</book>\\s*<value>).*?(</value>)"
                                                                          options:NSRegularExpressionCaseInsensitive
                                                                            error:&error];
    NSArray *textArray = [regex matchesInString:myData options:0 range:NSMakeRange(0, [myData length])];

    NSTextCheckingResult * result = [rege firstMatchInString:myData
                                                           options:0
                                                             range:NSMakeRange(0, [myData length])]; 
```

结果是：

```
<book>MyBook</book><value>myValue</value> 
```

所以我得到了整个字符串，但我只想要“myValue”。我怎样才能做到这一点？我在这里想念什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:52:01.217

发生这种情况是因为您编写了一个匹配整个字符串的正则表达式。我认为编写一个只匹配字符串的 myValue 部分的正则表达式太复杂了（因为你有 MyBook 字符串可能会匹配 myValue 所做的任何事情）。

我建议不要为此使用正则表达式，因为它们不适用于您在此处描述的用途。如果您不想使用任何 XML 反序列化，`NSScanner`则可以使用一个或任何`NSString`类方法，这将产生更简单、更易于维护的代码。

例如，使用 NSScanner 和其他一些方法：

```
NSString *stringToBeScanned = @"<book>MyBook</book><value>myValue</value>";
NSString *myValue;

NSScanner *scanner = [NSScanner scannerWithString:stringToBeScanned];
[scanner scanUpToString:@"<value>" intoString:nil];
// After the above, we've got "<value>myValue</value>" left to scan

[scanner scanUpToString:@"</value>" intoString:&myValue];
// We ended up with a "<value>myValue" type of a string

// This will trim the remaining of the string we don't need
myValue = [myValue stringByReplacingOccurrencesOfString:@"<value>" withString:@""]; 
```

上面的内容可能会写得更好，我可能会在脑海中写出一两个错误，但原则应该有效。

# c# - 如何使用 C# 并行执行多个“Ping”

> ID：13405848
> 
> 赞同：12
> 
> 时间：2012-11-15T20:42:12.773
> 
> 标签：c#, multithreading, ping

我正在尝试计算一组服务器的平均往返时间。为了加快速度，我想并行执行 ping。我编写了一个名为的函数`AverageRoundtripTime()`，它似乎可以工作，但是，由于我对多线程不太了解，我想知道我所做的是否还可以。请看看我的代码，让我知道它是否可以，或者是否有更好的方法来实现我想要的：

```
public void Main()
{
    // Collection of hosts.
    List<String> hosts = new List<String>();

    // Add 100 hosts to the collection.
    for (Int32 i = 0; i < 100; ++i) hosts.Add("www.google.com");

    // Display the average round-trip time for 100 hosts.
    Console.WriteLine(AverageRoundtripTime(hosts));

}

public Double AverageRoundtripTime(IEnumerable<String> hosts)
{
    // Collection of threads.
    List<Thread> threads = new List<Thread>();

    // Collection of ping replies.
    List<PingReply> pingReplies = new List<PingReply>();

    // Loop through all host names.
    foreach (var host in hosts)
    {
        // Create a new thread.
        Thread thread = new Thread(() =>
        {
            // Variable to hold the ping reply.
            PingReply reply = null;

            // Create a new Ping object and make sure that it's 
            // disposed after we're finished with it.
            using (Ping ping = new Ping())
            {
                    reply = ping.Send(host);

            }

            // Get exclusive lock on the pingReplies collection.
            lock (pingReplies)
            {
                // Add the ping reply to the collection.
                pingReplies.Add(reply);

            }

        });

        // Add the newly created thread to the theads collection.
        threads.Add(thread);

        // Start the thread.
        thread.Start();

    }

    // Wait for all threads to complete
    foreach (Thread thread in threads)
    {
        thread.Join();

    }

    // Calculate and return the average round-trip time.
    return pingReplies.Average(x => x.RoundtripTime);

} 
```

**更新：**

查看我提出的一个相关问题：

[Windows 窗体应用程序中的任务并行库代码冻结 - 可作为 Windows 控制台应用程序正常工作](https://stackoverflow.com/questions/13406901/task-parallel-library-code-freezes-in-a-windows-forms-application-works-fine-a)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-15T20:49:34.197

ping 类有一个方法`SendAsync`。这遵循基于事件的异步编程 (EAP) 模式。查看这篇文章：http: [//msdn.microsoft.com/en-us/library/ee622454.aspx](http://msdn.microsoft.com/en-us/library/ee622454.aspx)。

举个简单的例子，我有一个方法，它以非常基本的方式实现了那篇文章。您基本上可以根据需要多次调用它，并且所有 ping 都将异步完成。

```
 class Program
    {
    public static string[] addresses = {"microsoft.com", "yahoo.com", "google.com"};
    static void Main(string[] args)
    {
        List<Task<PingReply>> pingTasks = new List<Task<PingReply>>();
        foreach (var address in addresses)
        {
            pingTasks.Add(PingAsync(address));
        }

        //Wait for all the tasks to complete
        Task.WaitAll(pingTasks.ToArray());

        //Now you can iterate over your list of pingTasks
        foreach (var pingTask in pingTasks)
        {
            //pingTask.Result is whatever type T was declared in PingAsync
            Console.WriteLine(pingTask.Result.RoundtripTime);
        }
        Console.ReadLine();
    }

    static Task<PingReply> PingAsync(string address)
    {
        var tcs = new TaskCompletionSource<PingReply>();
        Ping ping = new Ping();
        ping.PingCompleted += (obj, sender) =>
            {
                tcs.SetResult(sender.Reply);
            };
        ping.SendAsync(address, new object());
        return tcs.Task;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-15T20:55:32.927

使用 Parallel.For 和 ConcurrentBag

```
 static void Main(string[] args)
    {
        Console.WriteLine(AverageRoundTripTime("www.google.com", 100));
        Console.WriteLine(AverageRoundTripTime("www.stackoverflow.com", 100));
        Console.ReadKey();
    }

    static double AverageRoundTripTime(string host, int sampleSize)
    {
        ConcurrentBag<double> values = new ConcurrentBag<double>();
        Parallel.For(1, sampleSize, (x, y) => values.Add(Ping(host)));
        return values.Sum(x => x) / sampleSize;
    }
    static double Ping(string host)
    {
        var reply = new Ping().Send(host);
        if (reply != null)
            return reply.RoundtripTime;
        throw new Exception("denied");
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-26T11:33:25.560

// 使用 LINQ 解决方案变得更简单

```
List<String> hosts = new List<String>();
for (Int32 i = 0; i < 100; ++i) hosts.Add("www.google.com");

var average = hosts.AsParallel().WithDegreeOfParallelism(64).
              Select(h => new Ping().Send(h).RoundtripTime).Average();

Console.WriteLine(average) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-15T18:10:15.490

也许像这样使用[SendPingAsync](https://msdn.microsoft.com/en-us/library/hh159414(v=vs.110).aspx)：

```
using (var ping = new Ping())
{
    var replies = await Task.WhenAll(hosts.Select(x => ping.SendPingAsync(x)))
                            .ConfigureAwait(false);
                            // false here   ^ unless you want to schedule back to sync context
    ... process replies.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-16T07:59:13.520

一个办法：

```
internal class Utils
{
    internal static PingReply Ping (IPAddress address, int timeout = 1000, int ttl = 64)
    {
            PingReply tpr = null;
            var p = new Ping ();
            try {

                tpr = p.Send (address,
                    timeout,
                    Encoding.ASCII.GetBytes ("oooooooooooooooooooooooooooooooo"),
                    new PingOptions (ttl, true));

            } catch (Exception ex) {

                tpr = null;

            } finally {
                if (p != null)
                    p.Dispose ();

                p = null;
            }

            return tpr;
        }

        internal static List<PingReply> PingAddresses (List<IPAddress> addresses, int timeout = 1000, int ttl = 64)
        {
            var ret = addresses
                .Select (p => Ping (p, timeout, ttl))
                .Where (p => p != null)
                .Where (p => p.Status == IPStatus.Success)
                .Select (p => p).ToList ();

            return ret;
        }

        internal static Task PingAddressesAsync (List<IPAddress> addresses, Action<Task<List<PingReply>>> endOfPing, int timeout = 1000, int ttl = 64)
        {

            return Task.Factory.StartNew<List<PingReply>> (() => Utils.PingAddresses (
                addresses, timeout, ttl)).ContinueWith (t => endOfPing (t));

        }   
} 
```

并使用：

```
Console.WriteLine ("start");

Utils.PingAddressesAsync (new List<IPAddress> () { 
                    IPAddress.Parse ("192.168.1.1"), 
                    IPAddress.Parse ("192.168.1.13"), 
                    IPAddress.Parse ("192.168.1.49"),
                    IPAddress.Parse ("192.168.1.200")
                }, delegate(Task<List<PingReply>> tpr) {

                    var lr = tpr.Result;
                    Console.WriteLine ("finish with " + lr.Count.ToString () + " machine found");

                    foreach (var pr in lr) {
                        Console.WriteLine (pr.Address.ToString ());
        }

});

Console.WriteLine ("execute");
Console.ReadLine (); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-23T09:52:27.637

这是一个可以 ping 多个端点的异步工作者。您可以 Start() 或 Stop() 心跳工作者并订阅以下事件：

*   PingUp（当端点关闭时边缘触发）
*   PingDown（当端点启动时边缘触发）
*   脉冲开始
*   脉冲结束
*   PingError

-

```
public class NetworkHeartbeat
{
    private static object lockObj = new object();

    public bool Running { get; private set; }
    public int PingTimeout { get; private set; }
    public int HeartbeatDelay { get; private set; }
    public IPAddress[] EndPoints { get; private set; }
    public int Count => EndPoints.Length;
    public PingReply[] PingResults { get; private set; }
    private Ping[] Pings { get; set; }

    public NetworkHeartbeat(IEnumerable<IPAddress> hosts, int pingTimeout, int heartbeatDelay)
    {
        PingTimeout = pingTimeout;
        HeartbeatDelay = heartbeatDelay;

        EndPoints = hosts.ToArray();
        PingResults = new PingReply[EndPoints.Length];
        Pings = EndPoints.Select(h => new Ping()).ToArray();
    }

    public async void Start()
    {
        if (!Running)
        {
            try
            {
                Debug.WriteLine("Heartbeat : starting ...");

                // set up the tasks
                var chrono = new Stopwatch();
                var tasks = new Task<PingReply>[Count];

                Running = true;

                while (Running)
                {
                    // set up and run async ping tasks                 
                    OnPulseStarted(DateTime.Now, chrono.Elapsed);
                    chrono.Restart();
                    for (int i = 0; i < Count; i++)
                    {
                        tasks[i] = PingAndUpdateAsync(Pings[i], EndPoints[i], i);
                    }
                    await Task.WhenAll(tasks);

                    for (int i = 0; i < tasks.Length; i++)
                    {
                        var pingResult = tasks[i].Result;

                        if (pingResult != null)
                        {
                            if (PingResults[i] == null)
                            {
                                if (pingResult.Status == IPStatus.Success)
                                    OnPingUp(i);
                            }
                            else if (pingResult.Status != PingResults[i].Status)
                            {
                                if (pingResult.Status == IPStatus.Success)
                                    OnPingUp(i);
                                else if (PingResults[i].Status == IPStatus.Success)
                                    OnPingDown(i);
                            }
                        }
                        else
                        {
                            if (PingResults[i] != null && PingResults[i].Status == IPStatus.Success)
                                OnPingUp(i);
                        }

                        PingResults[i] = tasks[i].Result;
                        Debug.WriteLine("> Ping [" + PingResults[i].Status.ToString().ToUpper() + "] at " + EndPoints[i] + " in " + PingResults[i].RoundtripTime + " ms");
                    }

                    OnPulseEnded(DateTime.Now, chrono.Elapsed);

                    // heartbeat delay
                    var delay = Math.Max(0, HeartbeatDelay - (int)chrono.ElapsedMilliseconds);
                    await Task.Delay(delay);
                }
                Debug.Write("Heartbeat : stopped");
            }
            catch (Exception)
            {
                Debug.Write("Heartbeat : stopped after error");
                Running = false;
                throw;
            }
        }
        else
        {
            Debug.WriteLine("Heartbeat : already started ...");
        }
    }

    public void Stop()
    {
        Debug.WriteLine("Heartbeat : stopping ...");
        Running = false;
    }

    private async Task<PingReply> PingAndUpdateAsync(Ping ping, IPAddress epIP, int epIndex)
    {
        try
        {
            return await ping.SendPingAsync(epIP, PingTimeout);
        }
        catch (Exception ex)
        {
            Debug.Write("-[" + epIP + "] : error in SendPing()");
            OnPingError(epIndex, ex);
            return null;
        }
    }

    // Event on ping errors
    public event EventHandler<PingErrorEventArgs> PingError;
    public class PingErrorEventArgs : EventArgs
    {
        public int EndPointIndex { get; private set; }
        public Exception InnerException { get; private set; }

        public PingErrorEventArgs(int epIndex, Exception ex)
        {
            EndPointIndex = epIndex;
            InnerException = ex;
        }
    }
    private void OnPingError(int epIndex, Exception ex) => PingError?.Invoke(this, new PingErrorEventArgs(epIndex, ex));

    // Event on ping Down
    public event EventHandler<int> PingDown;
    private void OnPingDown(int epIndex)
    {
        Debug.WriteLine("# Ping [DOWN] at " + EndPoints[epIndex]);
        PingDown?.Invoke(this, epIndex);
    }

    // Event on ping Up
    public event EventHandler<int> PingUp;
    private void OnPingUp(int epIndex)
    {
        Debug.WriteLine("# Ping [UP] at " + EndPoints[epIndex] );
        PingUp?.Invoke(this, epIndex);
    }

    // Event on pulse started
    public event EventHandler<PulseEventArgs> PulseStarted;
    public class PulseEventArgs : EventArgs
    {
        public DateTime TimeStamp { get; private set; }
        public TimeSpan Delay { get; private set; }

        public PulseEventArgs(DateTime date, TimeSpan delay)
        {
            TimeStamp = date;
            Delay = delay;
        }
    }
    private void OnPulseStarted(DateTime date, TimeSpan delay)
    {
        Debug.WriteLine("# Heartbeat [PULSE START] after " + (int)delay.TotalMilliseconds + " ms");
        PulseStarted?.Invoke(this, new PulseEventArgs(date, delay));
    }

    // Event on pulse ended
    public event EventHandler<PulseEventArgs> PulseEnded;
    private void OnPulseEnded(DateTime date, TimeSpan delay)
    {
        PulseEnded?.Invoke(this, new PulseEventArgs(date, delay));
        Debug.WriteLine("# Heartbeat [PULSE END] after " + (int)delay.TotalMilliseconds + " ms");
    }
} 
```

# c++ - 类及其派生类的 C++ 内存池

> ID：13405850
> 
> 赞同：5
> 
> 时间：2012-11-15T20:42:26.790
> 
> 标签：c++, memory, memory-management

是否有一个通用的算法或实现来拥有一个适用于 a`class A`及其派生类的内存池？创建一个仅适用于特定类 A 的 O(1) 内存池是相当容易的。例如：分配一大块数据，即每次需要分配时分配`10*sizeof(A)`1à 大小的块。`sizeof(A)`

当我们还可以考虑 A 的派生类时，是否有这样一个简单的实现？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:25:50.947

这真的取决于你对简单的定义是什么。正如杰克所说，您可以使用最大派生类的大小作为内存池数组的元素大小。这绝对是一个简单的实现。

如果某些类型的大小是最大类型的一半或更小，您可以修改实现以允许第二个实例占用一个已占用兼容实例的插槽。如果适用，这也可以扩展到四分之一尺寸类型。

# python - 是否存在任何用于滚动日志/配置文件的 python 工具？

> ID：13405852
> 
> 赞同：2
> 
> 时间：2012-11-15T20:42:30.887
> 
> 标签：python, configuration, rollover

这是我正在尝试做的事情：

1.  修改本地机器上的默认配置文件 (Thing.conf)。
2.  将虚拟客户端上的前一个配置文件保存到 Thing.conf.1 之类的文件中，并跟踪前 10 个左右的配置文件。（Thing.conf.2、Thing.conf.3 等）
3.  将该配置文件推送到远程虚拟客户端（/etc/thing/Thing.conf）。

需要明确的是——第 2 步是这里问题的症结所在，第 1 步和第 3 步仅用于上下文。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:48:38.367

python`logging`框架有一个[`RotatingFileHandler`](http://docs.python.org/2/library/logging.handlers.html?highlight=logging.handlers#logging.handlers.RotatingFileHandler)，它还允许你用`RotatingFileHandler.doRollover()`. 我不确定这是否是你所追求的。它将允许您在可能正在完成日志记录的虚拟客户端上滚动日志（配置？）文件。

# vb.net - 计算VB多行文本框中的行数

> ID：13405854
> 
> 赞同：3
> 
> 时间：2012-11-15T20:42:44.273
> 
> 标签：vb.net, textbox, count, lines

我想计算 VB 多行文本框显示整个给定字符串所需的行数。这样我就可以在 TextChanged 事件期间相应地增加文本框的高度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:45:32.910

有`TextBox`一个[`Lines`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.lines.aspx)属性。

```
int numLines = txt.Lines.Length 
```

> 但这仅在 TextChanged 事件期间返回 1。

那么你只有一条线。行由Ènvironment.NewLine (VBCrlf) 分隔。您的文本看起来会有多行，但实际上它只是被换行了，因为它对于视图来说太长了。

尝试以`TextChanged`这种方式设置高度：

```
Dim s As SizeF = TextRenderer.MeasureText(txt.Text, txt.Font, txt.ClientRectangle.Size, TextFormatFlags.WordBreak)
txt.Height = CInt(s.Height) 
```

# java - Java - 将一串字母转换为对应ascii的int？

> ID：13405855
> 
> 赞同：5
> 
> 时间：2012-11-15T20:42:45.650
> 
> 标签：java, ascii

我想将字符串转换为`"abc"`具有相应 ascii 的 int：在此示例中，`979899`.

我遇到了两个问题：

1) 我写的内容只适用于 ascii 长度为两个字符的字符，并且

2) 由于这些数字变得非常大，我不能使用 long，而且我在使用 BigIntegers 时遇到了麻烦。

这是我到目前为止所拥有的：

```
BigInteger mInt = BigInteger.valueOf(0L);
for (int i = 0; i<mString.length(); i++) {
        mInt = mInt.add(BigInteger.valueOf(
                (long)(mString.charAt(i)*Math.pow(100,(mString.length()-1-i)))));
} 
```

任何建议都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:55:23.567

首先用 a 进行所有连接`StringBuilder`然后`BigInteger`从结果中创建 a 有什么问题？这似乎比您目前所做的要简单得多。

```
String str = "abc";  // or anything else

StringBuilder sb = new StringBuilder();
for (char c : str.toCharArray())
    sb.append((int)c);

BigInteger mInt = new BigInteger(sb.toString());
System.out.println(mInt); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:56:33.447

你不必玩数字游戏。（战俘 100 等）。只需获取数字字符串，然后传递给构造函数。

```
final String s = "abc";
        String v = "";
        final char[] chars = s.toCharArray();
        for (int i = 0; i < chars.length; i++) {
            v += String.valueOf((int) chars[i]);
        }
//v = "979899" now
        BigInteger bigInt = new BigInteger(v); //BigInteger
        BigDecimal bigDec = new BigDecimal(v); // or BigDecimal 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:15:41.500

To handle n-digit numbers, you will have to multiply by a different power of ten each time. You could do this with a loop:

```
BigInteger appendDigits(BigInteger total, int n) {
    for (int i = n; i > 0; i /= 10)
        total = total.multiply(10);

    return total.plus(new BigInteger(n));
} 
```

However, this problem really seems to be about manipulating strings. What I would probably do is simply accumulate the digits int a string, and create a BI from the String at the end:

```
StringBuilder result = new StringBuilder();
for (char c : mString.getBytes())
    result.append(String.valueOf(c));
return new BigInteger(result.toString()); 
```

# java - Java StringBuffer：将内容从起始索引替换到行尾

> ID：13405862
> 
> 赞同：0
> 
> 时间：2012-11-15T20:43:50.163
> 
> 标签：java, replace, stringbuffer

我在 StringBuffer 中有一个文件的内容。该文件的内容包括多行（而不是单行）。我想编辑从索引 4（仅作为示例）到该行末尾的行的内容。我`replace()`用来编辑 StringBuffer 的内容。

重点是replace方法有起始索引和结束索引等参数。但我不知道结束索引是什么，因为每行都有不同数量的字符

我想用`str.indexOf("\n")`查找行的结束索引，但是文件有很多行，所以它会返回不正确的结果。

这是`readFile()`如果你需要阅读代码

谢谢

```
public StringBuffer readFile(){ //read file line by line
    File f = getFilePath(fileName);
    StringBuffer sb = new StringBuffer();
    String textinLine;

    try {
        FileInputStream fs = new FileInputStream(f);
        InputStreamReader in = new InputStreamReader(fs);
        BufferedReader br = new BufferedReader(in);

     while (true){
            textinLine = br.readLine();
            if (textinLine == null) break;
            sb.append(textinLine+ "\n");
        }
        fs.close();
        in.close();
        br.close();
    } ... // just some catch statements heres
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:50:06.583

按照您的指示使用`String.indexOf()`，但在起始位置传递，例如`indexOf('\n', 4);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:03:38.290

我同意 Jim 的想法，为什么不在将字符串附加到 StringBuffer 之前对其进行处理。

顺便说一句，我认为你可以使用`indexOf(String str, int fromIndex)`函数来解析StringBuffer，每次获取时`'\n'`，你可以设置一个偏移值，然后下次获取时`\n`，你可以让索引值加上偏移量。

# java - 在 Spring MVC 的 servlet 映射中，如何映射 url 模式目录的根目录？

> ID：13405868
> 
> 赞同：10
> 
> 时间：2012-11-15T20:44:14.890
> 
> 标签：java, spring, servlets, spring-mvc

```
<servlet-mapping>
    <servlet-name>testServlet</servlet-name>
    <url-pattern>/test/*</url-pattern>
</servlet-mapping> 
```

如果我点击**/test/page**以上将起作用。但是，点击**/test**或**/test/**将不起作用。我使用的是Spring MVC，我的请求映射如下：

```
@RequestMapping(value = {"","/"}) 
```

**编辑：**

我正在使用独立项目进行验证，但这似乎是 Spring 的 UrlPathHelper 的错误。当同时存在上下文和 servlet 路径时，以下方法返回不正确的路径，并且您在没有尾部斜杠的情况下点击了 servlet。

```
public String getPathWithinApplication(HttpServletRequest request) {
    String contextPath = getContextPath(request);
    String requestUri = getRequestUri(request);
    if (StringUtils.startsWithIgnoreCase(requestUri, contextPath)) {
        // Normal case: URI contains context path.
        String path = requestUri.substring(contextPath.length());
        return (StringUtils.hasText(path) ? path : "/");
    }
    else {
        // Special case: rather unusual.
        return requestUri;
    }
} 
```

举个例子，假设我有一个“admin”的上下文和以下 servlet 映射：

```
<servlet-mapping>
    <servlet-name>usersServlet</servlet-name>
    <url-pattern>/users/*</url-pattern>
</servlet-mapping> 
```

现在我在我的一个控制器中有一个请求映射，如下所示：

```
@RequestMapping(value = {"","/"}) 
```

如果我点击**/admin/users**它将不起作用。但是，如果我点击**/admin/users/**它将起作用。现在，如果我将请求映射更改为以下内容，那么它们都可以工作：

```
@RequestMapping(value = {"/users","/"}) 
```

但是，现在 URL **/admin/users/users**也可以工作（这不是我想要的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-05-13T22:02:25.950

[Yevgeniy](https://stackoverflow.com/a/13406202/393274)是正确的，但是如果您的 DispatcherServlet 正在接管默认 servlet，您必须将其添加到您的 web.xml：

```
<welcome-file-list>
    <welcome-file>/</welcome-file>
</welcome-file-list> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T21:06:10.710

我的设置通常如下所示：

```
<servlet-mapping>
    <servlet-name>testServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

控制器，我假设您想要处理`/test`并且`/test/`同样：

```
@Controller
public class MyController {

    @RequestMapping("/test")
    public String test() {
        return "redirect:/welcome";
    }

    @RequestMapping("/test/")
    public String test() {
        return "redirect:/welcome";
    }

    @RequestMapping("/welcome")
    public void test(ModelMap model) {
        // do your stuff
    }
} 
```

像这样的设置会导致`DispatcherServlet`处理文件的请求`*.css`，`*.js`这在大多数情况下是不需要的。我认为这是 Bhavik 描述的问题。对于这些资源，您可以像这样使用 ResourceController：

```
<mvc:resources mapping="/css/**" location="/resources/css/" />
<mvc:resources mapping="/js/**" location="/resources/js/" /> 
```

文件来自`/resources/css`并将`/resources/js`被提供，而不会强迫您编写额外的控制器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T20:59:02.703

首先，将 dispatcher servlet 映射到“/”和“/*”之间的区别。它们是有区别的！

当映射到“/*”时，所有 URL 请求（包括类似“/WEB-INF/jsp/.../index.jsp”）都映射到调度程序 servlet。

其次，当使用 Spring + Tiles 并在您的 tile 定义中返回一些 JSP 时，它被视为内部转发请求，并由与原始请求相同的 servlet 处理。在我的示例中，我调用根 URL“/”，它被 home() 方法正确捕获，然后由 Tiles 转发到“index.jsp”，再次由 Dispatcher Servlet 处理。显然，调度程序 servlet 无法处理“index.jsp”，因为它没有控制器。

是的，它很丑陋，但看起来这就是它的工作方式。

所以，到目前为止我找到的唯一解决方案：将 web.xml 中的“/*”改回“/”。我猜想，Tomcat 的 jsp servlet 会正确呈现 JSP，而不是调度程序 servlet。不幸的是，这个修复会破坏 Spring 的 ROOT URL 调度，所以你需要暂时放弃使用 ROOT URL + Tiles 的想法。

请注意，在使用“/*”时，在 web.xml 中添加显式 servlet 映射“ *.jsp* -> Tomcat jsp”没有帮助，而且很糟糕。

问题仍然没有解决。

这也是 Spring MVC 3.0 中的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-17T22:38:47.767

一种不接触 web.xml 文件的方法是将地图设置为默认的欢迎文件路径。

```
@RequestMapping("/index.html") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-10T23:41:37.657

就我而言，**除了根 "/" url 之外**，每个 url 都在工作。
问题是我没有删除`index.htm`我项目的 webapp 根文件夹中的文件。

# c# - oauth/token 返回空正文

> ID：13405870
> 
> 赞同：3
> 
> 时间：2012-11-15T20:44:27.260
> 
> 标签：c#, oauth, dotnetopenauth, access-token

我在使用 oauth 获取客户端应用程序中的 access_token 时遇到问题。返回的响应的正文为空，但在 API 中我可以看到响应不为空。

```
tokenresponse = { 
   "access_token":"[ACCESSTOKENVALUE]",
   "token_type":"bearer",
   "expires_in":"1200",
   "refresh_token":"[REFRESHTOKENVALUE]",
   "scope":"[SCOPEVALUE]"
} 
```

API 中返回令牌[http://api.sample.com/OAuth/Token](http://api.sample.com/OAuth/Token)的方法：

```
public ActionResult Token()
{
     OutgoingWebResponse response =
     this.AuthorizationServer.HandleTokenRequest(this.Request);
     string tokenresponse = string.Format("Token({0})", response!=null?response.Body:"")); 
     return response.AsActionResult();
} 
```

请求令牌的客户端方法是：

```
 public string GetAuthorizationToken(string code)
        { 
            string Url = ServerPath + "OAuth/Token"; 
            string redirect_uri_encode = UrlEncode(ClientPath);
            string param =  string.Format("code={0}&client_id={1}&client_secret={2}&redirect_uri={3}&grant_type=authorization_code",code, ClientId, ClientSecret, redirect_uri_encode);

            HttpWebRequest request = HttpWebRequest.Create(Url) as HttpWebRequest;
            string result = null;
            request.Method = "POST";
            request.KeepAlive = true;
            request.ContentType = "application/x-www-form-urlencoded";
            request.Timeout = 10000;
            request.Headers.Remove(HttpRequestHeader.Cookie);
            var bs = Encoding.UTF8.GetBytes(param);
            using (Stream reqStream = request.GetRequestStream())
            {
                reqStream.Write(bs, 0, bs.Length);
            }

            using (WebResponse response = request.GetResponse())
            {  
                var sr = new StreamReader(response.GetResponseStream());
                result = sr.ReadToEnd();
                sr.Close();
            } 
            if (!string.IsNullOrEmpty(result))
            {
                TokenData tokendata = JsonConvert.DeserializeObject<TokenData>(result);
                return UpdateAuthorizotionFromToken(tokendata);
            } 
            return null;
        } 
```

结果变量为空。如果您有任何想法可能导致这种情况，请告诉我。最初我认为是因为 cookie，所以我试图从请求中删除它们。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T10:56:11.857

亲爱的，只需使用以下代码创建 webclient，您将在 tokeninfo 中获得 json 信息。我使用它并且它的工作非常完美。

```
 WebClient client = new WebClient();
        string postData = "client_id=" + ""
                        + "&client_secret=" + ""
                        + "&grant_type=password&username=" + "" //your username
                        + "&password=" + "";//your password :)
        string soundCloudTokenRes = "https://api.soundcloud.com/oauth2/token";
        string tokenInfo = client.UploadString(soundCloudTokenRes, postData); 
```

然后，您可以使用仅包含来自 tokeninfo 的标记的子字符串。在声音云上上传曲目。

私人无效TestSoundCloudupload（）{

```
 System.Net.ServicePointManager.Expect100Continue = false;
        var request = WebRequest.Create("https://api.soundcloud.com/tracks") as HttpWebRequest;
        //some default headers
        request.Accept = "*/*";
        request.Headers.Add("Accept-Charset", "ISO-8859-1,utf-8;q=0.7,*;q=0.3");
        request.Headers.Add("Accept-Encoding", "gzip,deflate,sdch");
        request.Headers.Add("Accept-Language", "en-US,en;q=0.8,ru;q=0.6");

        //file array
        var files = new UploadFile[] { new UploadFile(Server.MapPath("Downloads//0.mp3"), "track[asset_data]", "application/octet-stream") };
        //other form data
        var form = new NameValueCollection();
        form.Add("track[title]", "Some title");
        form.Add("track[sharing]", "public");
        form.Add("oauth_token", "");
        form.Add("format", "json");

        form.Add("Filename", "0.mp3");
        form.Add("Upload", "Submit Query");
        try
        {
            using (var response = HttpUploadHelper.Upload(request, files, form))
            {
                using (var reader = new StreamReader(response.GetResponseStream()))
                {
                    Response.Write(reader.ReadToEnd());
                }
            }
        }
        catch (Exception ex)
        {
            Response.Write(ex.ToString());
        }
    } 
```

# php - 不会插入到 mysql 表中

> ID：13405873
> 
> 赞同：0
> 
> 时间：2012-11-15T20:44:48.447
> 
> 标签：php

我正在建立一个私人消息网络，它似乎没有将它们插入到我指定的表中。消息被发布到表中，然后在不同的脚本中访问。我的查询有什么问题？

```
 $new_of_id = $_SESSION['user_login'];

  $send_msg = mysql_query("INSERT INTO pvt_messages VALUES   ('','$new_of_id','$username','$msg_title','$msg_body','$date','$opened','$deleted')");
       echo "Your message has been sent!";
        }
      }
    echo "

    <form action='send_msg.php?u=$username' method='POST'>
    <h2>Compose a Message: ($username)</h2>
    <input type='text' name='msg_title' size='30' onClick=\"value=''\" value='Enter the message title here ...'><p />
    <textarea cols='50' rows='12' name='msg_body'>Enter the message you wish to send ...</textarea><p />
    <input type='submit' name='submit' value='Send Message'>
    </form>

    ";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:59:58.220

这里有几件事。

## 您的代码不处理失败的可能性。

目前，您发布成功消息时未检查 INSERT 查询的返回值。您可以通过在打印消息之前检查 $send_msg 的值来解决此问题：

```
$send_msg = mysql_query("
    INSERT INTO pvt_messages 
    VALUES(
        '',
        '$new_of_id',
        '$username',
        '$msg_title',
        '$msg_body',
        '$date',
        '$opened',
        '$deleted'
    )
");

//$send_msg will be TRUE if the row was inserted. FALSE if it wasn't.
if($send_msg){
    echo "Your message has been sent!";
}
else{
    echo "We were unable to send your message!";
} 
```

## 您没有正确调试查询。

通过使用 trigger_error (mysql_error() 像这样：

```
$send_msg = mysql_query("
    INSERT INTO pvt_messages 
    VALUES(
        '',
        '$new_of_id',
        '$username',
        '$msg_title',
        '$msg_body',
        '$date',
        '$opened',
        '$deleted'
    )
") or trigger_error(mysql_error()); 
```

...任何阻止您的 INSERT 正常运行的 MySQL 错误都将被吐出到页面上。这样，您可以消除任何语法错误等等。我的猜测是您正在尝试将空字符串插入主键列。

## mysql_* 函数：

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护，并且已经开始[弃用过程。](http://news.php.net/php.internals/53799)看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](https://thisinterestsme.com/pdo-insert-example/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:26:02.240

尝试这样的事情 - 只是为了检查你是否弄乱了列字段（可能是一个可能的原因）

```
$send_msg = mysql_query("
    INSERT INTO pvt_messages (
         id,
         name
         )
    VALUES(
        '',
        '$name'
    )
"); 
```

# php - switch 语句多变量赋值不重复

> ID：13405876
> 
> 赞同：3
> 
> 时间：2012-11-15T20:44:57.700
> 
> 标签：php, switch-statement

假设我有一个这样的 switch 语句：

```
switch ($var)
{
    case 'A':
       $a = 1;
       break;

    case 'B':
       $a = 1;
       $b = 2;
       break;

    case 'C':
       $a = 1;
       $b = 2;
       $c = 3;
       break;
} 
```

有没有一种方法可以构造该 switch 语句以重复`$a = 1`并`$b = 2`出现一次？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T20:47:25.227

只需恢复 case 语句的顺序并删除 break 语句。

```
switch ($var)
{
    case 'C':
       $c = 3;
    case 'B':
       $b = 2;
    case 'A':
       $a = 1;
       break;
} 
```

从[手册](http://us2.php.net/manual/en/control-structures.switch.php)：

> 为了避免错误，了解 switch 语句是如何执行的很重要。switch 语句逐行执行（实际上是逐语句执行）。一开始，没有代码被执行。只有当 case 语句的值与 switch 表达式的值匹配时，PHP 才会开始执行语句。PHP 继续执行语句，直到 switch 块结束，或者它第一次看到 break 语句。如果你不在一个 case 语句列表的末尾写一个 break 语句，PHP 将继续执行下一个 case 的语句。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T20:47:33.080

像这样：

```
switch($var) {
    case 'C':
        $c = 3;
        // fallthrough
    case 'B':
        $b = 2;
        // fallthrough
    case 'A':
        $a = 1;
} 
```

注释当然是可选的，但我喜欢将它们留在那里以确保我不会忘记缺少 a`break`是故意的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T20:48:17.267

```
开关 ($var) {
  案例“C”：
    $c = 3;
  案例“B”：
    $b = 2;
  案例“A”：
    $a = 1;
    休息;
}

```

应该做你想做的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-15T20:49:36.023

```
switch($var) {
    case 'C':
        $c = 3;
    case 'B':
        $b = 2;
    case 'A':
        $a = 1;
} 
```

通过不使用中断，如果 $var 例如包含“C”，则整个开关结构将被执行。如果 $var 是 'B'，则开关将在 case 'B' 处输入并从那里执行。

# php - 使用删除功能修改标准 Codeigniter 2 新闻教程

> ID：13405878
> 
> 赞同：0
> 
> 时间：2012-11-15T20:45:01.097
> 
> 标签：php, codeigniter-2

我正在学习 Codeigniter 2 并成功地玩弄了[他们关于如何创建基本新闻应用程序的教程/示例](http://codeigniter.com/user_guide/tutorial/index.html)。

所以在完成这项工作后，我想尝试在新闻项目中添加一个“删除记录”链接，看看我是否可以自己解决这个问题。

我将此添加到我的**模型**文件中`news_model.php`：

```
public function delete_news($id) {
    $this->db->delete('news', array('id' => $id));
} 
```

我将此添加到我的**控制器**文件中`news.php`：

```
public function delete($id) {
    $this->news_model->delete_news($id);

    $data['news'] = $this->news_model->get_news();
    $data['title'] = 'News item deleted';

    $this->load->view('templates/header', $data);
    $this->load->view('news/index', $data);
    $this->load->view('templates/footer');
} 
```

我将此添加到我的**视图**文件中，`index.php`：

```
<a href="/news/delete/<?php echo $news_item['id'] ?>">Delete Item</a> 
```

最后，我将它添加到我的**配置**文件中，`routes.php`

```
$route['news/delete/(:any)'] = 'news/delete/$1'; 
```

它似乎按书面方式工作。

从 的新闻列表页面`/news/`，我单击新闻项目的链接，当页面重新加载时，相应的项目就消失了。

问题：

1) 页面重新加载后，URL 显示`/news/delete/id`，其中`/id`是项目编号。但是，我不想要这个新 URL，我真的只想`/news/`重新加载页面以显示新内容。显然，我这样做的方式有潜在的危险，因为用户简单的页面刷新会删除另一个项目。解决/处理此问题的标准方法是什么？

2) 在我的 Controller`delete()`函数中，在第一行之后，我基本上只是从 Controller`index()`函数中重复相同的 5 行代码。毫无疑问，这在某种程度上与问题 #1 相关，但同样，更好的方法是什么？

3）我错过了与“标准”或“最佳实践”有关的任何其他内容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:49:41.937

好吧，我不会再包括所有的东西，而是写：

```
public function delete($id) {
    $this->news_model->delete_news($id);
    redirect(base_url().'news/')
} 
```

因此，在单击链接并删除新闻后，用户会被重定向到正常的新闻页面。

请参阅：[CodeIgniter url 帮助程序](http://codeigniter.com/user_guide/helpers/url_helper.html)

最好的祝福

斯蒂芬·S。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:50:20.753

1）我建议您加载 url 帮助程序并重定向到`/news/`那时。如果您希望显示删除确认，我建议您`flash_message`从`session`库中使用，它允许在会话中存储警报直到您显示它，它专门用于此目的。

2）您可能做的唯一更好的事情可能是制作一个自制的助手来管理您的视图，因此您只需调用带有参数的函数即可输出视图。但是没有其他方法可以优化它或节省一些代码行。

3）你做得很好，很干净。:)

**编辑：**

如果需要显示错误或成功信息，请参考 CodeIgniter 的[session 库](http://codeigniter.com/user_guide/libraries/sessions.html)的 flash_message，这里是一个例子。

在您的控制器中设置错误消息，就在重定向到索引之前：

```
$this->load->library('session');
$this->session->set_flashdata('error_message', "This is my error message"); 
```

在您的索引视图中，如果它存在，您将显示它：

```
<?if($this->session->flashdata('error_message')):?>
    <div class="nNote nFailure"><p><?=$this->session->flashdata('error_message');?></p></div>
<?endif;?> 
```

请注意 flash_message 只显示一次。这意味着您的索引将显示您的错误，然后销毁会话消息。这是 flash_message 的目的，正确且简单地显示错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:30:38.240

下一步将考虑错误和不良数据

*   检查 $id 以确保它确实是一个整数。这可能在调用 delete 之前在控制器中发生，或者作为 delete 方法的一部分发生。重要的一点是，因为 id 直接来自 URL 没有验证，所以在让它靠近数据库之前，你必须做一些检查。
*   在模型中，delete_news 应该返回 true 或 false，以确认找到并删除了记录。
*   在控制器中，包装 $this->news_model->delete_news($id); 在 IF 检查它是否从模型返回 true，否则错误重定向。
*   如果出现错误，由于您希望更改 url，您仍然可以重定向，只需传递适当的错误代码，例如

重定向('/news/adminerror/delete');

然后在你的新闻控制器中，有一个像 adminerror($errortype) 这样的方法，
然后基于 $errortype 的值，在这种情况下，这将是一个删除错误，显示适当的消息和视图。

编辑

2-在模型中，在你的删除方法中，把它放在最后：

```
if ($this->db->affected_rows() == '1')
{return TRUE;}
else
{return FALSE;} 
```

3-在控制器中，包裹在一个 IF 中，通常更容易检查某些东西是否首先不起作用

```
if( $this->news_model->delete_news($id) == false )
{ 
// redirect to error page or whatever you need       
} 
// if its not false, then its true, which means it worked
else
{ 
$this->session->set_flashdata('error_message', 'record #'. $id . ' deleted');
redirect('/news/');   
} 
```

更新记录的最后快速提示——

```
$this->db->affected_rows() == '1' 
```

也用于确认发生了更新。但是，如果您进行更新，假设您正在更新博客文章 - 然后您再次单击以更新，但实际上您没有更改任何内容......那么这将返回为假。更新确实通过了，但由于内容相同，因此数据库没有更改或“受影响”。

因此，如果您使用该方法来确认更新 - 可能会有更酷的方法来执行此操作，但我只是发送一些与更新内容一起总是不同的内容 - 日期/时间、随机数等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T21:01:56.127

感谢 Jean-François GB 和 Stephan S. 为我指明了正确的方向。

这是工作解决方案...

**控制器**文件，`news.php`：

```
public function delete($id) {
    $this->news_model->delete_news($id);
    $this->load->helper('url');
    redirect('/news/');
} 
```

* * *

**编辑：**

修改为显示确认消息，*“记录 #x 已删除”* ...

```
public function delete($id) {
    $this->news_model->delete_news($id);
    $this->load->helper('url');
    $this->load->library('session');
    $this->session->set_flashdata('error_message', 'record #'. $id . ' deleted');
    redirect('/news/');
} 
```

和内部**视图**文件，`index.php`：

```
<div id="message">
    <?php 
        if ( $this->session->flashdata('error_message') ) {                 
            echo $this->session->flashdata('error_message');
        }
    ?>
</div> 
```

# c# - ASP.NET 向导 - 需要加载 WizardStep

> ID：13405879
> 
> 赞同：0
> 
> 时间：2012-11-15T20:45:08.263
> 
> 标签：c#, asp.net, aspwizard

当我到达 WizardStep 时，我喜欢根据在上一个 WizardStep 中选择的内容来填充一些信息。是否有一个向导步骤的加载，我可以根据某些条件将信息填充到其中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:58:34.247

使用[`ActiveStepChanged`](http://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.wizard.activestepchanged%28v=vs.80%29.aspx)事件：

```
void OnActiveStepChanged(object sender, EventArgs e)
{
    // ...
} 
```

# android - 在我的应用程序中启动相机时没有得到任何东西

> ID：13405880
> 
> 赞同：0
> 
> 时间：2012-11-15T20:45:16.220
> 
> 标签：android, android-layout, android-intent

我的应用程序出现了一个奇怪的问题。在我的主菜单中创建了一个按钮，当点击它时，我应该按照我设定的意图将我带到我的相机。但是我只是得到一个空白的白色屏幕。

这是我的 Camera.java

```
import android.app.Activity;
import android.content.Intent;
import android.view.View;

public class Camera extends Activity{

public void takePhoto(View view) {
    Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
    int TAKE_PICTURE = 0;
    startActivityForResult(intent, TAKE_PICTURE);
}
 } 
```

在我的清单文件中：

```
 </activity)
<activity android:name=".Camera"></activity>
 </application> 
```

和权限：

```
<uses-permission android:name="android.permission.CAMERA" />
<uses-feature android:name="android.hardware.camera" /> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T11:03:52.740

以下代码非常适合我打开相机而不在 Manifest 文件中声明任何权限。

```
package com.test;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class Camera extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button btn_cal = (Button) findViewById(R.id.btn_cal);
        btn_cal.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
                int TAKE_PICTURE = 0;
                startActivityForResult(intent, TAKE_PICTURE);
            }
        });

    }

} 
```

希望这对您有所帮助。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:50:16.257

如果您通过意图拍照，您实际上不需要权限。

这是我必须在我编写的应用程序中使用的内容：

ContentValues 值 = 新 ContentValues(); values.put(MediaStore.Images.Media.TITLE, "photo.jpg"); values.put(MediaStore.Images.Media.DESCRIPTION,"我的描述");

```
 cameraResultURI = getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);
    //create new Intent
    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    intent.putExtra(MediaStore.EXTRA_OUTPUT, cameraResultURI);
    intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 1);
    startActivityForResult(intent, CAMERA_ACTIVITY); 
```

# verilog - Verilog中的时间问题

> ID：13405882
> 
> 赞同：0
> 
> 时间：2012-11-15T20:45:22.220
> 
> 标签：verilog

我是 verilog 的新手，我正在研究定义两个模块的 verilg 代码。第一个模块计算 2 个数字的模数，第二个模块使用结果对其进行一些操作。

结果是错误的，并且有很多无关值，因为两个模块中使用了相同的 clk。任何建议请同步。

模组模块

```
module mod(m,a,b);
  input  [15:0] a,b;
  output [15:0] m;

  reg [31:0] mod;
  reg [31:0] mul;

  integer i;

  always @* begin
    mul = a*b;
    mod = 32'h80008000;
    for(i=0;i<16;i=i+1) begin
      if(mul > mod) begin
        mul = mul - mod;
        mod = mod >> 1;
      end 
      else begin
        mod = mod >> 1;
      end
    end
    assign m=mul[15:0];
 endmodule 
```

顶部模块的一部分：

```
initial begin
  keyp <= 2'b10;
  shift <= 1'b0;
end

 always @(posedge clk) begin
   if(load)
     case (keyp)
       2'b10: begin 
          key[127:64] <= {k1,k0};
          keyp        <= 2'b01;
       end
       2'b01: begin
         key[63:0] <= {k1,k0};
         keyp      <= 2'b00;
         shift     <= 1'b1;
       end
     //default: keyp <=2'b00;
     endcase
   else if (shift) begin
     //shift key for first round
     temp[24:0]    <= key[127:103];
     key[127:25]   <= key[102:0];
     key [24:0]    <= temp [24:0];
     shift         <= 1'b0;
   end
 end

 assign w1[2*SIZE-1:SIZE]   = d1+key[2*SIZE-1:SIZE];
 assign w1[3*SIZE-1:2*SIZE] = d2+key[3*SIZE-1:2*SIZE];

 mod mod1( w1[SIZE-1:0],        d0, key[SIZE-1:0]       );
 mod mod2( w1[4*SIZE-1:3*SIZE], d3, key[4*SIZE-1:3*SIZE]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:26:10.667

使用阻塞分配多次分配相同的值是完全有效的 Verilog。即使在两侧出现相同的术语也可以，只要在此之前至少分配一次。

这里的代码不完整，但问题似乎是代码在多个地方分配给“键”。既作为 mod 实例的输出，也作为时钟模块内部。每当这两个“不同意”键的值时，它将被视为 X。X 除了表示未知之外，还反映了两个不同分配冲突的争用。

由于我不确定此代码的用途（似乎是某种加密），因此我无法提供修复，但您需要将分配与密钥分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:41:02.653

x 在 casex 语句或卡诺图中被称为不关心，在这里它们表示未知值。未知值可能来自未初始化（重置）的值或多个（冲突）驱动程序。

mod 模块包含这部分代码：

```
always @* begin
  mul = a*b;
  mod = 32'h80008000;
  for(i=0;i<16;i=i+1) begin
    if(mul > mod) begin
      mul = mul - mod;
      mod = mod >> 1;
    end 
    else begin
      mod = mod >> 1;
    end
  end 
```

`always @*`是一个组合块，你多次分配 mul 只有最后一次分配会有任何效果。

在这里使用 for 循环使您看起来像是在尝试重用变量，就像在 c 中一样。请记住，我们正在描述硬件，并且该值旨在作为触发器或模块之间的电线存在于某处，并且在任何给定的时钟周期内只能保存一个值。

在您拥有的 mul 定义自己的组合块中`mul = mul - mod;`，这将不起作用，您需要添加一个触发器来中断循环。

# perl - 获取大型文本文件中特定行位置中唯一值的数量

> ID：13405884
> 
> 赞同：1
> 
> 时间：2012-11-15T20:45:24.823
> 
> 标签：perl, awk, grep

全部，

我有一个大型服务器日志，其中包含以下条目：未从模块中找到

紧随其后的是一个模块的位置的引号。该文件超过 4,800 行，每个模块可能出现超过 100 次。所以，我想做的是 wc -l 之类的东西，但随后只向我显示服务器日志的模块名称部分中唯一值的数量。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:47:53.987

`grep -oP '(?<=not found from Module ")[^"]+(?=")' logfile | sort -u | wc -l`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T20:50:59.613

```
grep 'entry: not found from Module' logfile | sort -u | wc -l 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:49:40.863

```
perl -nlwe '$a{$_}++ }{ print "$_ : $a{$_}" for keys %a' log.txt 
```

为每一行创建一个哈希键，然后在最后打印键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:49:34.327

```
awk '{count[$NF]++} END{ for (mod in count) print mod, count[mod] }' file 
```

可能接近您想要的，但如果没有一些样本输入和预期输出，很难猜测。

# asp.net - asp 如何在您当前所在的子页面上执行 foreach 控件循环

> ID：13405888
> 
> 赞同：0
> 
> 时间：2012-11-15T20:45:36.327
> 
> 标签：asp.net

我只是想将我所有的 RadTextBox 边框更改为黑色。我确定我的 foreach 循环的结构是正确的，但是我找不到任何 RadTextBoxes。

我有一个名为 master.Page 的母版页和一个继承该页面的子页，名为 child.aspx。

child.aspx 上有 10 个 radtextbox，但我找不到，我试过.....

```
foreach (var control in this.Controls.OfType<RadTextBox>())
    {
        control.BorderColor = System.Drawing.Color.Black;
    }
    foreach (var control in this.Page.Controls.OfType<RadTextBox>())
    {
        control.BorderColor = System.Drawing.Color.Black; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:54:14.263

既然您提到您正在使用 MasterPages。你会发现在你的子 aspx 页面顶部的控件不是来自主页面，`this.Controls`而是通过，`contentPlaceHolder1.Controls`因为那是`NamingContainer`.

如果您在子控件中有其他文本框，`FormView`或者`GridView`您甚至不会以这种方式找到它们，因为`Enumerable.OfType`不会递归搜索给定控件的子控件。你可以试试这个递归扩展`OfType`：

```
public static IEnumerable<T> Traverse<T>(this IEnumerable<T> source, Func<T, IEnumerable<T>> fnRecurse)
{
    foreach (T item in source)
    {
        yield return item;

        IEnumerable<T> seqRecurse = fnRecurse(item);
        if (seqRecurse != null)
        {
            foreach (T itemRecurse in Traverse(seqRecurse, fnRecurse))
            {
                yield return itemRecurse;
            }
        }
    }
} 
```

按以下方式使用它：

```
var allRadTextBoxes = this.Controls.Cast<Control>()
          .Traverse(c => c.Controls.OfType<RadTextBox>());
foreach(var radTextBox in allRadTextBoxes)
{
    radTextBox.BorderColor = System.Drawing.Color.Black;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T20:59:52.013

问题是因为您的控件不是**直接在页面上**。您的控件位于页面上的**表单**中。

```
foreach (var control in this.Page.Form.Controls.OfType<RadTextBox>())
    {
        control.BorderColor = System.Drawing.Color.Black;
    } 
```

您可以在表单中查找控件，也可以使用*Tim Schmelter*方法递归搜索

# android - 本机代码无错误退出 - 可能是内存

> ID：13405890
> 
> 赞同：0
> 
> 时间：2012-11-15T20:45:42.657
> 
> 标签：android, android-ndk, java-native-interface

我有一个调用`main`c 本机代码中的函数的线程。

这不会返回到 java，所以我必须小心内存分配。

main 函数调用 java 上的静态方法作为回调的一种方式。以下是在 c 中如何实现的：

```
void writeat(int x, int y, int style, char *string) {
    JNIEnv *env = getJNIEnv();
    static jmethodID cls_mid = NULL;

    if (cls_mid == NULL) {
        jclass clazz = (*env)->FindClass(env, "com/comp/prod/Kernel");
        cls_mid = (*env)->GetStaticMethodID(env, clazz, "writeat",
                "(IIILjava/lang/String;)V");
    }

    {
        jstring out = (*env)->NewStringUTF(env, string);
        (*env)->CallStaticVoidMethod(env, nullVoid, cls_mid, x, y, style,
                out);
        (*env)->DeleteLocalRef(env, out);
    }
} 
```

这工作了一小会儿，然后死了，没有任何错误记录在 log cat 中。

如果我注释掉这个`CallStaticVoidMethod`电话，它仍然会做同样的事情。如果我注释掉新调用和删除调用，则没有问题。

仅使用字符串“000”就可以每秒调用数百次，这就是我认为它很快耗尽内存的原因。

获取有关诊断错误的信息的任何帮助都会很棒，因为此时我在日志猫中什么也看不到。

**更新：我的旧 main 和 getJNIEnv**

```
 JNIEnv *_env;

 JNIEXPORT void JNICALL Java_com_comp_prod_main(JNIEnv *env,
        jclass thiz) {
    LOGV("Main called %d", __LINE__);
    _env = (JNIEnv *) ((*env)->NewGlobalRef(env, env));
      main();
    _env = NULL;
  }

  JNIEnv *getJNIEnv(void) {
     return _env;
  } 
```

**我的新 main 和 getJNIEnv**

```
JavaVM *jvm;

JNIEXPORT void JNICALL Java_com_comp_prod_main(JNIEnv *env,
        jclass thiz) {
    LOGV("Main called %d", __LINE__);
    //this is how to cache it for other threads
    jint rs = (*env)->GetJavaVM(env, &jvm);
    assert (rs == JNI_OK);
    main();
    jvm = NULL;
}

JNIEnv *getJNIEnv(void) {
    JNIEnv *env;
     jint rs = (*jvm)->AttachCurrentThread(jvm, &env, NULL);
     assert (rs == JNI_OK);
     if(env == NULL)
     {
       LOGV("env is NULL");
     }
     return env;
} 
```

从 Java 调用：

```
Runnable runTerm = new Runnable() {

public void run() {
  // call main()
  Log.i(TAG, "About to call main on the c!");
  try {
    Terminal.main();
    } catch (IOException e) {
     e.printStackTrace();
    }
    }
};

t = new Thread(runTerm, "C thread");
t.start(); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-15T20:54:14.297

完成后您不会释放字符串，因此每次调用都会泄漏它。

# css - DIV 与位置集“相对”一起折叠

> ID：13405891
> 
> 赞同：1
> 
> 时间：2012-11-15T20:45:50.493
> 
> 标签：css, css-float, position, image-resizing

我有一个网站，上面有一个大图像覆盖屏幕。在它的图像中有几个 DIV（文本、表单、图像）（见图 2）。无论窗口大小如何，大图像容器始终显示图像的中心，因此当您缩小窗口时，中心仍然可见。

现在的问题是，当我缩小窗口大小时，DIV 正在崩溃（见图 3）。

图片 2 描绘了它的外观！

```
#div1 {
  width:25%;
  left: 32%;
  top:7.5%;
  position: relative;
  float:left;   
  }

#div2 {
  position:relative;
  left:37.5%;
  clear:both;
  width:14%;
  height:20%;
  }

    #div2 h2 {
      width:10%;
      left:15%;
      margin-top:11%;
      position: relative;
      float: left;
      }

#div3 {
  left: 64.4%;
  top:-2.5%;
  width:111px;
  position: relative;
  }

#div4{
  left: 93%;
  top:-18.0%;
  width:111px;
  position: relative;
} 
```

和 HTML：

```
<body>

    <div id="wrapper"\>

        <div id="div1">
            <h1>Seite nicht gefunden!</h1>
        </div>

        <h2>Bug melden</h2>

        <div id="div2">

            <form>
                  <label>Titel</label>
                  <input type="text" id="form_title" name="title" placeholder="Ich will einen Bug melden!" required>

                  <label>URL</label>
                  <input type="url" id="form_url" name="URL" placeholder="###" >

                  <label>Beschreibung</label>
                  <textarea type="text" id="form_whathappened" name="happened" placeholder="Was ist passiert?" required></textarea>

                  <input type="submit" value="Absenden" /> 
            </form>
        </div>

        <div id="div3">
            <a href="http://www.###.de" target="new"><img src="logo.png" alt="Logo" /></a>
        </div>

        <div id="div4">
            <a href="http://www.###.de" target="new"><p>Jetzt<br/ >Tester<br />werden!<br /></p></a>
        </div>

    </div>

</body> 
```

你能帮我解决我做错了什么吗？非常感谢您！

克里斯托夫

![全窗口大小](../Images/ed68abb42fa54b50220141b0908ad548.png)

![这就是调整窗口大小后的样子](../Images/88554879560fc2ce50df10527f4cd26b.png)

![这就是它的样子](../Images/9c173f692d08874182f602a981491d8f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:23:54.250

这可能远非完美，但值得一试。

html代码：

```
<head>
<meta charset="utf-8">
<title>404</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="wrapper">
    <div id="error">
                <h1>Seite nicht gefunden!</h1>
            </div>
            <form id="form">
                        <h2>Bug melden</h2>
                        <label>Titel</label>
                        <input type="text" id="form_title" name="title" placeholder="Ich will einen Bug melden!" required>

                        <label>URL</label>
                        <input type="url" id="form_url" name="URL" placeholder="http://www.###/???" >

                        <label>Beschreibung</label>
                        <textarea type="text" id="form_whathappened" name="happened" placeholder="Was ist passiert?" required></textarea>

                        <input type="submit" value="Absenden" /> 
            </form>
 ... //other code goes here</div> 
```

这是CSS代码的编辑部分：

```
#wrapper { width: 640px; height: auto; margin: 0 auto; }
#error { font-size: 120%; margin: 65px 0 0 60px; float:left; }
#error h1 { font-size: 150%; text-align:center; }
#form { margin: 15px 86px; width:260px; height: 40%; float: left; background: green; } 
```

在此处检查工作示例：[示例](http://bborisov.me/dev/test/)

希望这有助于作为一个开始。

# google-app-engine - 我可以使用 AWS DynamoDB 运行自定义代码吗？

> ID：13405892
> 
> 赞同：1
> 
> 时间：2012-11-15T20:45:51.017
> 
> 标签：google-app-engine, amazon-dynamodb

在过去的几个月里，我一直在尝试使用 Google App Engine。它真的很容易使用，但你能做的却很有限。也就是说，我不能使用 WebSockets 或发送 Apple Push Notifications。DynamoDB 的方式是否相同，即我无法使用它运行“​​自定义”代码？我可以使用 WebSockets 或者说在其上运行 XMPP 服务器吗？我不完全确定 DynamoDB 是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:06:43.170

好吧，DynamoDB 只是一个（精简）数据库引擎。它将存储您的数据，但除了查询之外不会运行任何东西。如果您需要通用服务器，可以查看 EC2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T23:44:43.917

App Engine 确实有 XMPP 服务：[https](https://developers.google.com/appengine/docs/python/xmpp/) ://developers.google.com/appengine/docs/python/xmpp/和[https://developers.google.com/appengine/docs/java/xmpp/overview](https://developers.google.com/appengine/docs/java/xmpp/overview)

并不是说这对 Web Sockets 或 Apple Push Notifications 有帮助。

Channel API 可用于提供持久的客户端连接：[https](https://developers.google.com/appengine/docs/python/channel/overview) ://developers.google.com/appengine/docs/python/channel/overview https://developers.google.com/appengine/docs/java/channel/

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-12T17:46:01.403

您可以将 AWS Lambda（自定义代码）与 DynamoDB 结合使用。

# bash - Shell 脚本 if 条件的参数过多

> ID：13405893
> 
> 赞同：2
> 
> 时间：2012-11-15T20:45:56.793
> 
> 标签：bash, shell, terminal

我当前的脚本执行以下操作；

它将整数作为命令行参数并从 1 到 N 开始，它检查数字是否可被 3、5 或两者整除。它只是打印出 3 的 Uc、5 的 Bes 和 3,5 的 UcBes。如果命令行参数为空，它执行相同的操作，但循环转到 1 到 20。

我遇到此错误“第 11,15 和 19 行的参数太多”。

这是代码：

```
#!/bin/bash

if [ ! -z $1 ]; then
    for i in `seq 1 $1`
    do
        if [ [$i % 3] -eq 0 ]; then
            echo "Uc"
        elif [ i % 5 -eq 0 ]; then
            echo "Bes"
        elif [ i % 3 -eq 0 ] && [ i % 5 -eq 0 ]
        then
            echo "UcBes"
        else
            echo "$i"
        fi
    done
elif [ -z $1 ]
then
    for i in {1..20}
    do
        if [ i % 3 -eq 0 ]
        then
            echo "Uc"
        elif [ i % 5 -eq 0 ]
        then
            echo "Bes"
        elif [ i % 3 -eq 0 ] && [ i % 5 -eq 0 ]
        then
            echo "UcBes"
        else
            echo "$i"
        fi
    done
else
    echo "heheheh"
fi 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:49:47.047

请注意，这`[`实际上是`test`内置 shell 的同义词（`which [`在您的终端中尝试），而不是像其他语言那样的条件语法，因此您不能这样做：

```
if [ [$i % 3] -eq 0 ]; then 
```

此外，请始终确保在 、 和组成它们之间的逻辑条件检查的变量之间至少有一个`[`空格`]`。

计算模数等表达式的语法是由 包围`$((...))`，其中的变量名不需要前缀`$`：

```
remainder=$((i % 3))
if [ $remainder -eq 0 ]; then 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T20:50:15.960

您可能应该使用类似的东西：

```
if [ $(($i % 3)) -eq 0 ] 
```

代替

```
if [ $i % 3 -eq 0 ]
if [ [$i % 3] -eq 0 ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T22:29:27.580

您的脚本可以大大简化。例如：

```
#!/bin/sh

n=0
while test $(( ++n )) -le ${1:-20}; do
  t=$n
  expr $n % 3 > /dev/null || { printf Uc; t=; }
  expr $n % 5 > /dev/null || { printf Bes; t=; }
  echo $t
done 
```

如果参数不是整数，则给出稍有不同的错误消息，但在其他方面表现相同。

# android - addToBackStack 不会添加到片段管理器的后台堆栈

> ID：13405897
> 
> 赞同：1
> 
> 时间：2012-11-15T20:46:03.597
> 
> 标签：android, android-fragments

我的应用程序有选项卡，在一个选项卡中，我有一个带有 ListView 的片段。当在列表中单击一个项目时，我尝试使用以下内容在该选项卡下初始化一个新片段：

```
private class ShowItemClickListener implements OnClickListener {
        public void onClick(View v) {
        Fragment showDetails = new ShowFragment();
        FragmentTransaction ft = activity.getFragmentManager().beginTransaction();
        ft.replace(R.id.realtabcontent, showDetails);
        ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
        ft.addToBackStack(null);    
        ft.commit();
        System.out.println(activity.getFragmentManager().getBackStackEntryCount()); // this prints 0 though
    }
} 
```

结果，当我在 Show Fragment 视图中按下后退按钮时，它只是关闭应用程序而不是返回到上一个片段。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T12:57:07.860

抱歉回答晚了，但也许有人会有同样的问题。

我正在解决同样的问题。只有当该片段不在当前视图中时，才会将实际片段添加到后台堆栈。因此，当您切换到下一个片段后，它将被添加到堆栈中。

# c# - Automapper 将多个嵌套类映射到一个具有各种属性的类

> ID：13405899
> 
> 赞同：2
> 
> 时间：2012-11-15T20:46:14.213
> 
> 标签：c#, .net, automapper

我有以下通过 JSON 请求填充的模型类：

```
public class Driver
{
    public string driverId { get; set; }
    public string url { get; set; }
    public string givenName { get; set; }
    public string familyName { get; set; }
    public string dateOfBirth { get; set; }
    public string nationality { get; set; }
}

public class Constructor
{
    public string constructorId { get; set; }
    public string url { get; set; }
    public string name { get; set; }
    public string nationality { get; set; }
}

public class DriverStanding
{
    public string position { get; set; }
    public string points { get; set; }
    public string wins { get; set; }
    public Driver Driver { get; set; }
    public List<Constructor> Constructors { get; set; }
}

public class StandingsList
{
    public string season { get; set; }
    public string round { get; set; }
    public List<DriverStanding> DriverStandings { get; set; }
}

public class StandingsTable
{
    public string season { get; set; }
    public List<StandingsList> StandingsLists { get; set; }
}

public class MRData
{
    public string xmlns { get; set; }
    public string series { get; set; }
    public string url { get; set; }
    public string limit { get; set; }
    public string offset { get; set; }
    public string total { get; set; }
    public StandingsTable StandingsTable { get; set; }
}

public class RootObject
{
    public MRData MRData { get; set; }
} 
```

然后我有一个像这样的简单类：

```
public class DriverResults
{
    public string Season { get; set; }
    public string Points { get; set; }
    public List<Driver> Driver { get; set; }
}

public class Driver
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

当我请求 JSON 时，第一组类被完全填充。我想从某个类中获取一些属性，例如/RootObject.MRData.StandingsTable.Season = DriverResults.Season。下面是我的属性映射

**司机地图**

givenName = 名字

姓氏 = 姓氏

**点地图**

积分 = 积分

**季节地图**

季节=季节

这是我迄今为止尝试过的，但每次都为空：

```
 Mapper.CreateMap<MVCF1.API.Driver, MVCF1.Models.Driver>()
            .ForMember(dest => dest.FirstName, opt => opt.MapFrom(src => src.givenName))
            .ForMember(dest => dest.LastName, opt => opt.MapFrom(src => src.familyName));

        Mapper.CreateMap<MVCF1.API.DriverStanding, MVCF1.Models.DriverResults>()
            .ForMember(dest => dest.Points, opt => opt.MapFrom(src => src.points));

        Mapper.CreateMap<MVCF1.API.StandingsList, MVCF1.Models.DriverResults>()
            .ForMember(dest => dest.Season, opt => opt.MapFrom(src => src.season));

        Mapper.CreateMap<MVCF1.API.RootObject, MVCF1.Models.DriverResults>(); 
```

我查看了自定义类型转换器，但通过阅读文档不确定如何使用它们。

请帮忙，谢谢。

**更新：这是返回的 JSON**

```
{
   "MRData":{
      "StandingsTable":{
         "StandingsLists":[
            {
               "DriverStandings":[
                  {
                     "Constructors":[
                        {
                           "constructorId":"red_bull",
                           "name":"Red Bull",
                           "nationality":"Austrian",
                           "url":"http://en.wikipedia.org/wiki/Red_Bull_Racing"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1987-07-03",
                        "driverId":"vettel",
                        "familyName":"Vettel",
                        "givenName":"Sebastian",
                        "nationality":"German",
                        "url":"http://en.wikipedia.org/wiki/Sebastian_Vettel"
                     },
                     "points":"255",
                     "position":"1",
                     "wins":"5"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"ferrari",
                           "name":"Ferrari",
                           "nationality":"Italian",
                           "url":"http://en.wikipedia.org/wiki/Scuderia_Ferrari"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1981-07-29",
                        "driverId":"alonso",
                        "familyName":"Alonso",
                        "givenName":"Fernando",
                        "nationality":"Spanish",
                        "url":"http://en.wikipedia.org/wiki/Fernando_Alonso"
                     },
                     "points":"245",
                     "position":"2",
                     "wins":"3"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"lotus_f1",
                           "name":"Lotus F1",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/Lotus_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1979-10-17",
                        "driverId":"raikkonen",
                        "familyName":"Räikkönen",
                        "givenName":"Kimi",
                        "nationality":"Finnish",
                        "url":"http://en.wikipedia.org/wiki/Kimi_R%C3%A4ikk%C3%B6nen"
                     },
                     "points":"198",
                     "position":"3",
                     "wins":"1"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"red_bull",
                           "name":"Red Bull",
                           "nationality":"Austrian",
                           "url":"http://en.wikipedia.org/wiki/Red_Bull_Racing"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1976-08-27",
                        "driverId":"webber",
                        "familyName":"Webber",
                        "givenName":"Mark",
                        "nationality":"Australian",
                        "url":"http://en.wikipedia.org/wiki/Mark_Webber"
                     },
                     "points":"167",
                     "position":"4",
                     "wins":"2"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"mclaren",
                           "name":"McLaren",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/McLaren"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1985-01-07",
                        "driverId":"hamilton",
                        "familyName":"Hamilton",
                        "givenName":"Lewis",
                        "nationality":"British",
                        "url":"http://en.wikipedia.org/wiki/Lewis_Hamilton"
                     },
                     "points":"165",
                     "position":"5",
                     "wins":"3"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"mclaren",
                           "name":"McLaren",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/McLaren"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1980-01-19",
                        "driverId":"button",
                        "familyName":"Button",
                        "givenName":"Jenson",
                        "nationality":"British",
                        "url":"http://en.wikipedia.org/wiki/Jenson_Button"
                     },
                     "points":"153",
                     "position":"6",
                     "wins":"2"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"ferrari",
                           "name":"Ferrari",
                           "nationality":"Italian",
                           "url":"http://en.wikipedia.org/wiki/Scuderia_Ferrari"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1981-04-25",
                        "driverId":"massa",
                        "familyName":"Massa",
                        "givenName":"Felipe",
                        "nationality":"Brazilian",
                        "url":"http://en.wikipedia.org/wiki/Felipe_Massa"
                     },
                     "points":"95",
                     "position":"7",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"mercedes",
                           "name":"Mercedes",
                           "nationality":"German",
                           "url":"http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1985-06-27",
                        "driverId":"rosberg",
                        "familyName":"Rosberg",
                        "givenName":"Nico",
                        "nationality":"German",
                        "url":"http://en.wikipedia.org/wiki/Nico_Rosberg"
                     },
                     "points":"93",
                     "position":"8",
                     "wins":"1"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"lotus_f1",
                           "name":"Lotus F1",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/Lotus_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1986-04-17",
                        "driverId":"grosjean",
                        "familyName":"Grosjean",
                        "givenName":"Romain",
                        "nationality":"French",
                        "url":"http://en.wikipedia.org/wiki/Romain_Grosjean"
                     },
                     "points":"90",
                     "position":"9",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"sauber",
                           "name":"Sauber",
                           "nationality":"Swiss",
                           "url":"http://en.wikipedia.org/wiki/Sauber"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1990-01-26",
                        "driverId":"perez",
                        "familyName":"Pérez",
                        "givenName":"Sergio",
                        "nationality":"Mexican",
                        "url":"http://en.wikipedia.org/wiki/Sergio_P%C3%A9rez"
                     },
                     "points":"66",
                     "position":"10",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"sauber",
                           "name":"Sauber",
                           "nationality":"Swiss",
                           "url":"http://en.wikipedia.org/wiki/Sauber"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1986-09-13",
                        "driverId":"kobayashi",
                        "familyName":"Kobayashi",
                        "givenName":"Kamui",
                        "nationality":"Japanese",
                        "url":"http://en.wikipedia.org/wiki/Kamui_Kobayashi"
                     },
                     "points":"58",
                     "position":"11",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"force_india",
                           "name":"Force India",
                           "nationality":"Indian",
                           "url":"http://en.wikipedia.org/wiki/Force_India"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1987-08-19",
                        "driverId":"hulkenberg",
                        "familyName":"Hülkenberg",
                        "givenName":"Nico",
                        "nationality":"German",
                        "url":"http://en.wikipedia.org/wiki/Nico_H%C3%BClkenberg"
                     },
                     "points":"49",
                     "position":"12",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"force_india",
                           "name":"Force India",
                           "nationality":"Indian",
                           "url":"http://en.wikipedia.org/wiki/Force_India"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1986-04-16",
                        "driverId":"resta",
                        "familyName":"di Resta",
                        "givenName":"Paul",
                        "nationality":"Scottish",
                        "url":"http://en.wikipedia.org/wiki/Paul_di_Resta"
                     },
                     "points":"46",
                     "position":"13",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"williams",
                           "name":"Williams",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/Williams_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1985-03-09",
                        "driverId":"maldonado",
                        "familyName":"Maldonado",
                        "givenName":"Pastor",
                        "nationality":"Venezuelan",
                        "url":"http://en.wikipedia.org/wiki/Pastor_Maldonado"
                     },
                     "points":"43",
                     "position":"14",
                     "wins":"1"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"mercedes",
                           "name":"Mercedes",
                           "nationality":"German",
                           "url":"http://en.wikipedia.org/wiki/Mercedes-Benz_in_Formula_One"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1969-01-03",
                        "driverId":"michael_schumacher",
                        "familyName":"Schumacher",
                        "givenName":"Michael",
                        "nationality":"German",
                        "url":"http://en.wikipedia.org/wiki/Michael_Schumacher"
                     },
                     "points":"43",
                     "position":"15",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"williams",
                           "name":"Williams",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/Williams_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1983-10-15",
                        "driverId":"bruno_senna",
                        "familyName":"Senna",
                        "givenName":"Bruno",
                        "nationality":"Brazilian",
                        "url":"http://en.wikipedia.org/wiki/Bruno_Senna"
                     },
                     "points":"30",
                     "position":"16",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"toro_rosso",
                           "name":"Toro Rosso",
                           "nationality":"Italian",
                           "url":"http://en.wikipedia.org/wiki/Scuderia_Toro_Rosso"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1990-04-25",
                        "driverId":"vergne",
                        "familyName":"Vergne",
                        "givenName":"Jean-Éric",
                        "nationality":"French",
                        "url":"http://en.wikipedia.org/wiki/Jean-%C3%89ric_Vergne"
                     },
                     "points":"12",
                     "position":"17",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"toro_rosso",
                           "name":"Toro Rosso",
                           "nationality":"Italian",
                           "url":"http://en.wikipedia.org/wiki/Scuderia_Toro_Rosso"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1989-07-01",
                        "driverId":"ricciardo",
                        "familyName":"Ricciardo",
                        "givenName":"Daniel",
                        "nationality":"Australian",
                        "url":"http://en.wikipedia.org/wiki/Daniel_Ricciardo"
                     },
                     "points":"10",
                     "position":"18",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"marussia",
                           "name":"Marussia",
                           "nationality":"Russian",
                           "url":"http://en.wikipedia.org/wiki/Marussia_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1982-03-18",
                        "driverId":"glock",
                        "familyName":"Glock",
                        "givenName":"Timo",
                        "nationality":"German",
                        "url":"http://en.wikipedia.org/wiki/Timo_Glock"
                     },
                     "points":"0",
                     "position":"19",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"caterham",
                           "name":"Caterham",
                           "nationality":"Malaysian",
                           "url":"http://en.wikipedia.org/wiki/Caterham_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1981-10-19",
                        "driverId":"kovalainen",
                        "familyName":"Kovalainen",
                        "givenName":"Heikki",
                        "nationality":"Finnish",
                        "url":"http://en.wikipedia.org/wiki/Heikki_Kovalainen"
                     },
                     "points":"0",
                     "position":"20",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"caterham",
                           "name":"Caterham",
                           "nationality":"Malaysian",
                           "url":"http://en.wikipedia.org/wiki/Caterham_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1984-09-08",
                        "driverId":"petrov",
                        "familyName":"Petrov",
                        "givenName":"Vitaly",
                        "nationality":"Russian",
                        "url":"http://en.wikipedia.org/wiki/Vitaly_Petrov"
                     },
                     "points":"0",
                     "position":"21",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"lotus_f1",
                           "name":"Lotus F1",
                           "nationality":"British",
                           "url":"http://en.wikipedia.org/wiki/Lotus_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1985-12-27",
                        "driverId":"ambrosio",
                        "familyName":"d'Ambrosio",
                        "givenName":"Jérôme",
                        "nationality":"Belgian",
                        "url":"http://en.wikipedia.org/wiki/J%C3%A9r%C3%B4me_d%27Ambrosio"
                     },
                     "points":"0",
                     "position":"22",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"marussia",
                           "name":"Marussia",
                           "nationality":"Russian",
                           "url":"http://en.wikipedia.org/wiki/Marussia_F1"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1990-02-15",
                        "driverId":"pic",
                        "familyName":"Pic",
                        "givenName":"Charles",
                        "nationality":"French",
                        "url":"http://en.wikipedia.org/wiki/Charles_Pic"
                     },
                     "points":"0",
                     "position":"23",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"hrt",
                           "name":"HRT",
                           "nationality":"Spanish",
                           "url":"http://en.wikipedia.org/wiki/Hispania_Racing"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1977-01-14",
                        "driverId":"karthikeyan",
                        "familyName":"Karthikeyan",
                        "givenName":"Narain",
                        "nationality":"Indian",
                        "url":"http://en.wikipedia.org/wiki/Narain_Karthikeyan"
                     },
                     "points":"0",
                     "position":"24",
                     "wins":"0"
                  },
                  {
                     "Constructors":[
                        {
                           "constructorId":"hrt",
                           "name":"HRT",
                           "nationality":"Spanish",
                           "url":"http://en.wikipedia.org/wiki/Hispania_Racing"
                        }
                     ],
                     "Driver":{
                        "dateOfBirth":"1971-02-24",
                        "driverId":"rosa",
                        "familyName":"de la Rosa",
                        "givenName":"Pedro",
                        "nationality":"Spanish",
                        "url":"http://en.wikipedia.org/wiki/Pedro_de_la_Rosa"
                     },
                     "points":"0",
                     "position":"25",
                     "wins":"0"
                  }
               ],
               "round":"18",
               "season":"2012"
            }
         ],
         "season":"2012"
      },
      "limit":"30",
      "offset":"0",
      "series":"f1",
      "total":"25",
      "url":"http://ergast.com/api/f1/current/driverstandings.json",
      "xmlns":"http://ergast.com/mrd/1.2"
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T21:39:35.337

按照@David 的建议运行断言时，我得到：

```
AutoMapper.AutoMapperConfigurationException : 
Unmapped members were found. Review the types and members below.
Add a custom mapping expression, ignore, add a custom resolver, or modify the source/destination type
=================================================================================
DriverStanding -> DriverResults (Destination member list)
StackOverflow.Null.API.DriverStanding -> StackOverflow.Null.Models.DriverResults (Destination member list)
---------------------------------------------------------------------------------
Season
================================================================================
StandingsList -> DriverResults (Destination member list)
StackOverflow.Null.API.StandingsList -> StackOverflow.Null.Models.DriverResults (Destination member list)
--------------------------------------------------------------------------------
Points
Driver
=============================================================================
RootObject -> DriverResults (Destination member list)
StackOverflow.Null.API.RootObject -> StackOverflow.Null.Models.DriverResults (Destination member list)
-----------------------------------------------------------------------------
Season
Points
Driver 
```

现在基本上你有一个对象 ( `MRData`)，它有一个对象列表 ( `StandingsList`)，它有一个对象列表 ( `DriverStanding`)。我假设当您应用映射时，您希望将这 1 个复杂`MRData`对象展平为许多`DriverResults`对象。这不是您可以直接通过配置轻松完成的事情，但您可以通过在各种对象上重新应用映射来完成。

我认为您正在寻找与此解决方案类似的东西：[AutoMapper and flattening nested arrays](https://stackoverflow.com/questions/13338262/automapper-and-flattening-nested-arrays/13338747#13338747)

**更新**- 更新代码以匹配更新的要求。

我已经部分实施了该解决方案。

**MVCF1Profile.cs**

```
namespace MVCF1
{
    using System.Collections.Generic;

    using AutoMapper;

    public class MVCF1Profile : Profile
    {
        public override string ProfileName
        {
            get { return "MVCF1Profile"; }
        }

        protected override void Configure()
        {
            AllowNullDestinationValues = true;
            AllowNullCollections = true;

            CreateMap<API.Driver, Models.Driver>()
                .ForMember(dest => dest.FirstName, opt => opt.MapFrom(src => src.givenName))
                .ForMember(dest => dest.LastName, opt => opt.MapFrom(src => src.familyName));

            CreateMap<API.StandingsList, Models.DriverResults>()
                .ForMember(dest => dest.Driver, opt => opt.MapFrom(src => src.DriverStandings.Select(ds => Mapper.Map<API.Driver, Models.Driver>(ds.Driver))))
                .ForMember(dest => dest.Points, opt => opt.Ignore());
        }
    }
} 
```

单元测试：

```
[Test]
public void AutoMapper_Configuration_IsValid()
{
    Mapper.Initialize(m => m.AddProfile<MVCF1Profile>());
    Mapper.AssertConfigurationIsValid();
}

[Test]
public void AutoMapper_DriverMapping_IsValid()
{
    Mapper.Initialize(m => m.AddProfile<MVCF1Profile>());
    Mapper.AssertConfigurationIsValid();

    // Convert JSON string from question to RootObject instance
    var data = GetData();

    var ds = data.MRData.StandingsTable.StandingsLists.First();
    var driverResults = Mapper.Map<StandingsList, Models.DriverResults>(ds);

    Assert.That(driverResults, Is.Not.Null);
    Assert.That(driverResults.Points, Is.Null);
    Assert.That(driverResults.Season, Is.EqualTo("2012"));
    Assert.That(driverResults.Driver, Is.Not.Null);
    Assert.That(driverResults.Driver.Count(), Is.EqualTo(25));
} 
```

供参考我`GetData`是（上面的json字符串被删除）

```
private RootObject GetData()
{
    string jsonMessage;

    #region Initialise String
    jsonMessage = @"";
    #endregion

    var data = JsonConvert.DeserializeObject<RootObject>(jsonMessage);

    Assert.That(data, Is.Not.Null);
    Assert.That(data, Is.InstanceOf<RootObject>());
    Assert.That(data.MRData, Is.Not.Null);
    Assert.That(data.MRData, Is.InstanceOf<MRData>());
    Assert.That(data.MRData.StandingsTable, Is.Not.Null);
    Assert.That(data.MRData.StandingsTable, Is.InstanceOf<StandingsTable>());

    return data;
} 
```

您只需再次调用映射器即可根据需要为更高级别的对象应用映射。例如，一旦您修复了配置，您可以执行以下操作：

```
Mapper.Map(root.MRData.StandingsTable, result); 
```

这会将来自 StandingsTable 的适当字段映射到结果目的地。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:17:42.073

尝试这样的事情。您必须明确地深入挖掘 src 对象才能正确映射。Automapper 只会自动匹配同名且深度相同的属性。如果名称不匹配或嵌套在另一个名称中，则必须准确指定所需的属性。对象列表将在不更改 Mapper.CreateMap<>() 的情况下正确映射，但您必须从单个对象映射到单个对象或从对象列表映射到另一个对象列表。

例如：

```
Mapper.CreateMap<MVCF1.API.RootObject, MVCF1.Models.DriverResults>()
    .ForMember(dest => dest.Season, opt.MapFrom(src => src.MRData.StandingsTable.season)); 
```

# xml - 从 XML 文件中获取随机地点并通过 AS3 加载该地点

> ID：13405902
> 
> 赞同：-1
> 
> 时间：2012-11-15T20:46:25.413
> 
> 标签：xml, actionscript-3, random

我正在尝试创建一个列出特定按钮场所的应用程序！我已经创建了其他所有内容，但我正在努力创建一个函数，该函数将 XML 文件中的数据随机化，然后在我已经设置的动态文本框中显示这些数据！数学函数可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:27:39.830

要从 XML 中获取随机值，我会执行以下操作：

```
import flash.display.*;
import flash.net.*;
import flash.events.*;

var xml:XML = <venues>
    <venue name="Venue A" description="A description" address="1\. 2772 Loker Ave West, Carlsbad, CA 92010" website="http://dop.com" picture="/path/to/some/picture.png" />
    <venue name="Venue B" description="B description" address="2\. 2772 Loker Ave West, Carlsbad, CA 92010" website="http://google.com" picture="/path/to/some/picture.png" />
    <venue name="Venue C" description="C description" address="3\. 2772 Loker Ave West, Carlsbad, CA 92010" website="http://yahoo.com" picture="/path/to/some/picture.png" />
    <venue name="Venue D" description="D description" address="4\. 2772 Loker Ave West, Carlsbad, CA 92010" website="http://cnn.com" picture="/path/to/some/picture.png" />
    <venue name="Venue E" description="E description" address="5\. 2772 Loker Ave West, Carlsbad, CA 92010" website="http://youtube.com" picture="/path/to/some/picture.png" />
    <venue name="Venue F" description="F description" address="6\. 2772 Loker Ave West, Carlsbad, CA 92010" website="http://bing.com" picture="/path/to/some/picture.png" />
</venues>;
var list:XMLList = new XMLList(xml.venue);

function getRandomVenue():void
{
    var rand:int = list.length() * Math.random();
    trace("Name:",list[rand].@name);
    trace("Description:",list[rand].@description);
    trace("Address:",list[rand].@address);
    trace("Website:",list[rand].@website);
    trace("Picture:",list[rand].@picture);
}
getRandomVenue(); 
```

由于我们不知道您的 XML 是什么样子，所以我猜测了它的*外观*。

# .htaccess - 替换 htaccess 中查询字符串的一部分

> ID：13405905
> 
> 赞同：2
> 
> 时间：2012-11-15T20:46:46.683
> 
> 标签：.htaccess, query-string

在使用 htaccess 重写 URL 时，我非常喜欢，尽管我可以做基础。

在这种情况下，我有一系列从供应商返回到我的脚本的查询字符串。这一切都很好，很花哨，除非它包含一个带有“http”或“https”的 URL。当它检测到这一点时，Apache 会抛出 403 Forbidden 错误。我认为我可以制作一个 RewriteRule，将查询字符串的“http”部分重写为可以通过 Apache 规则的东西。

这最终将安装在客户端的机器上，因此我无法更改任何服务器设置。

一个示例 URL 是：

```
http://mysite.com/gocardless_confirm.php?resource_uri=https%3A%2F%2Fsandbox.gocardless.com%2Fapi%2Fv1%2Fbills%2F07F56ERHRT 
```

这是我尝试使用的设置：

```
RewriteCond ${QUERY_STRING} ^(.*)$resource_uri=http^(.*)$
RewriteCond %{REQUEST_URI} ^gocardless_confirm.php
RewriteRule ^(.*)$ gocardless_confirm.php?$1resource_uri=hllp$2 [L] 
```

我怎样才能重写这部分，以便我可以简单地访问脚本？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T11:49:59.343

尝试：

```
RewriteCond %{QUERY_STRING} ^(.*)resource_uri=http(.*)$
RewriteRule ^gocardless_confirm.php$ gocardless_confirm.php?%1resource_uri=hllp%2 [L] 
```

RewriteCond 中的子模式`%#`在 RewriteRule 中被引用。
`^`是模式匹配的孔字符串的开头。
`$`is 匹配它的结尾。

# c++ - 循环依赖 C++

> ID：13405906
> 
> 赞同：2
> 
> 时间：2012-11-15T20:46:48.667
> 
> 标签：c++, circular-dependency

我正在尝试编译如下内容：

啊

```
#include "B.h"
class A {
    B * b;
    void oneMethod();
    void otherMethod();
}; 
```

A.cpp

```
#include "A.h"
void A::oneMethod() { b->otherMethod() }
void A::otherMethod() {} 
```

溴化氢

```
#include "A.h"
class B {
    A * a;
    void oneMethod();
    void otherMethod();
}; 
```

B.cpp

```
#include "B.h"       
void B::oneMethod() { a->otherMethod() }
void B::otherMethod() {} 
```

到目前为止，我在使用前向声明时没有遇到问题，但我现在可以使用它，因为我不能使用仅前向声明的类的属性或方法。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:49:10.390

在 C++ 中，与 Java 和 C# 不同，您可以在类外部定义成员函数（提供其主体）。

```
class A;
class B;

class A {
    B * b;
    void oneMethod();
    void otherMethod() {}
};

class B {
    A * a;
    void oneMethod();
    void otherMethod() {}
};

inline void A::oneMethod() { b->otherMethod(); }
inline void B::oneMethod() { a->otherMethod(); } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:58:58.677

只要我正确理解您的问题，您需要做的就是：

啊

```
class B;// Forward declaration, the header only needs to know that B exists
class A {
    B * b;
    void oneMethod();
    void otherMethod();
}; 
```

A.cpp

```
#include "A.h"
#include "B.h"//Include in the .cpp since it is only compiled once, thus avoiding circular dependency
void A::oneMethod() { b->otherMethod() }
void A::otherMethod() {} 
```

溴化氢

```
class A;// Forward declaration, the header only needs to know that A exists
class B {
    A * a;
    void oneMethod();
    void otherMethod();
}; 
```

B.cpp

```
#include "B.h" 
#include "A.h"//Include in the .cpp since it is only compiled once, thus avoiding circular dependency      
void B::oneMethod() { a->otherMethod() }
void B::otherMethod() {} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:50:06.230

您必须推迟使用类的成员，直到定义了该类。在您的情况下，这意味着将一些成员函数体移动到文件的底部：

```
class B;

class A {
    B * b;
    void oneMethod();
    void otherMethod() {}
};

class B {
    A * a;
    void oneMethod() { a->otherMethod() }
    void otherMethod() {}
};

inline void A::oneMethod() { b->otherMethod() } 
```

* * *

这是多个文件中的典型解决方案：

啊

```
class B;
class A {
    B * b;
    void oneMethod();
    void otherMethod();
}; 
```

溴化氢

```
class A;
class B {
    A * a;
    void oneMethod();
    void otherMethod();
}; 
```

A.cpp

```
#include "A.h"
#include "B.h"

void A::oneMethod() { b->otherMethod() }
void A::otherMethod() {} 
```

B.cpp

```
#include "A.h"
#include "B.h"

void B::oneMethod() { a->otherMethod() }
void B::otherMethod() {} 
```

主文件

```
#include "A.h"
int main () { A a; a.oneMethod(); } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:49:18.837

将函数的实现推送到 cpp 文件中，然后 cpp 可以包含两个标头。

# javascript - 将 SQL 结果输出到表

> ID：13405911
> 
> 赞同：0
> 
> 时间：2012-11-15T20:47:02.807
> 
> 标签：javascript, sql, html, adodb

如何修改下面的代码以动态地将我的 SQL 查询结果生成到一个想要下面示例表的表中？（每个表格行 2 个项目）

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
    function test() {
        try {
            alert("running function test")
        var cn      = new ActiveXObject("ADODB.Connection")
        var rs      = new ActiveXObject("ADODB.Recordset")
        var sql     = "SELECT * FROM tbl_rssims"
        var db      = "G:\\AS\\Asf\\ASF\\RSSIMS\\db\\rssims.mdb"

        cn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source = " + db + "")
        rs.Open(sql, cn, 1, 3)

        var html    =  '<!DOCTYPE html>\n'
            html    +=  '<html>\n'
            html    +=  '<head>\n'
            html    +=  '<table style="border: none; table-layout: fixed; width: 100%; text-align: left;" cellpadding="0" cellspacing="0">\n'

            //<!-- WRITE FIELD VALUES -->
            while (!rs.eof) {
                html += '<tr>\n';
                for (var c = 0; c < rs.fields.count; ++c) {
                    html += '<td>' + rs.fields(c).value + '</td>\n'
                }//end of for
                html += '</tr>\n'
                rs.movenext
            }//end of while
            html += '</table>'
            window.open('','').document.write(html)

        rs.close
        cn.close
    }//end of try
    catch(e) {
        alert(e.description)
    }
}//end of function

</script>
</head>
<body>
    <b>Example:</b>
    <table style="border: none; table-layout: fixed; width: 100%; text-align: left;" cellpadding="0" cellspacing="0">
        <tr>
            <td>Mr. Ronald McDonald<br>Chief Executive Officer<br>The Hudson Bay Corporation<br>123 Yahoo Street<br>Toronto, Ontario<br>Canada</td>
            <td>Mr. Steve Marin<br>Chief Executive Officer<br>General Motors<br>456 Don Mills Street<br>Toronto, Ontario<br>Canada</td>
        </tr>
    </table>
    <input onclick="test()" type="button" value="button" id="button">
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:53:09.377

这个怎么样：

```
html += '<tr><td>' + rs.GetString(2, -1, '<br>', '</td><td>', '') + '</td></tr>'; 
```

你想要`<br>`在每一列`</td><td>`之间，以及每一行之间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:02:19.697

尝试这样的事情..

```
<php?
$query='select * from table_name';
$result=mysql_query($query);
?>
<table>
<tr>
<th>ID </th>
<th>Name</th>
</tr>
<?php
while($row=mysql_fetch_assoc($result)){
    echo '<tr>
    <td align="center">'.$row['id'].'-'.$row['sID'].'</td>
    <td align="center">'.$row['name'].'</td>
    </tr>';
}
?>
</table> 
```

# jquery - 使用无限滚动时保持浏览器后退按钮后的位置

> ID：13405914
> 
> 赞同：1
> 
> 时间：2012-11-15T20:47:18.773
> 
> 标签：jquery

有人为我的网上商店创建了一个无限滚动器。除了一件事之外，这非常有效。当您在页面的一半并单击产品时，您将转到产品页面。当用户点击浏览器后退按钮时，用户将返回到带有无限滚动条的页面。问题是脚本在用户第一次点击产品的位置再次加载所有产品。换句话说，当您点击后退按钮时，所有产品都会再次加载。搜索此站点后，我已阅读您可以使用 window.loacation.hash 做一些事情。问题是我是 JS 和 Jquery 的初学者，所以我不知道这将如何适合下面的代码。任何帮助都更受欢迎......

很抱歉下面代码中的任何错误，但我不得不取消脚本....

我的代码

```
var currentPage = {{ collection.page }};
var collectionPages = {{ collection.pages }};
var category = '{{ collection.internal.url }}';
var appendProduct = function (product) {
    if (currentPage == 1) {
        return false
    }
    $('<div class="product"></div>').html(product).appendTo($(".productsGrid"));
    var i = 1;
    $('.product').each(function () {
        if (i++ % 3 == 0) $(this).addClass('last')
    })
};
var loadProducts = function () {
    var url = "http://www.riemen-tekoop.nl/" + category + "/page" + currentPage + ".ajax" + window.location.search;
    $.getJSON(url, function (data) {
        $.each(data.products, function (index, product) {
            var imageUrl = product.image.replace('50x50x2', '210x175x2');
            var itemHtml = '' + '<a href="' + product.url + '" title="' + product.title + ' ' + product.brand.title + '"><img src="' + imageUrl + '" width="210" height="175" alt="' + product.title + ' ' + product.brand.title + '" title="' + product.title + ' ' + product.brand.title + '"/>';
            if (product.price.price_old) {
                itemHtml = itemHtml + '<div class="perc">' + (((+product.price.price / product.price.price_old) * 100) - 100).toFixed(0) + '%</div>'
            }
            itemHtml = itemHtml + '<div class="caption" style="display:none;"><a href="' + product.url + '" class="opener">Quick view</a></div>' + '</a>' + '<div class="info">' + '<h3>' + '<a href="' + product.url + '" title="' + product.title + ' ' + product.brand.title + '">' + product.title + ' ' + product.brand.title + '</a>' + '</h3>' + '<div class="gridAddToCart">' + '<a class="btnLink" href="' + product.url + '" title="' + product.title + ' ' + product.brand.title + '" rel="nofollow" alt="Bekijk details"><span>{{ '
            Details ' | t }}</span></a>' + '<a class="btnWishlist" href="{{ ' / account / wishlistAdd / ' }}' + product.id + '" title="{{ '
            Add to wishlist ' | t }}" rel="nofollow" alt="Zet op {{ '
            Wishlist ' | t }}"></a>' + '</div>' + '<div class="price"><strong>' + product.price.price_money + '</strong>';
            if (product.price.price_old) {
                itemHtml = itemHtml + ' <span>' + product.price.price_old_money + '</span>'
            }
            itemHtml = itemHtml + '<div class="clear"></div>' + '</div>' + '</div>' + '<span class="imgshadow"></span>';
            appendProduct(itemHtml)
        });
        $("#overlay").fadeOut();
        $(window).scroll(function () {
            update()
        })
    })
};
loadProducts();
var isUpdating = false;
var update = function () {
    if ($(window).height() + $(window).scrollTop() >= $(document).height() - 4000) {
        if (currentPage < collectionPages && !isUpdating) {
            isUpdating = true;
            currentPage++;
            $("#overlay").fadeIn();
            $(window).unbind('scroll');
            setTimeout(function () {
                loadProducts();
                setTimeout(function () {
                    isUpdating = false
                }, 500)
            }, 500)
        }
    }
};
$(window).scroll(function () {
    update()
}); 
```

# html - CSS - 背景图片不显示

> ID：13405918
> 
> 赞同：0
> 
> 时间：2012-11-15T20:47:24.297
> 
> 标签：html, css

我有一个相当不寻常的问题。很难解释，所以这是您可以查看的[地址](http://010.rs/mali_oglasi)（网站仍在开发中，不要为 PHP 错误而烦恼）。

问题如下 - 侧边栏菜单（带有图标，在右侧，在**Kategorije**下方）是动态创建的，并且每个**li**都有为图标制作的 span 标签（用作背景图像）。这是有效的，除了第一个（**aksesoari**）。而这个也在工作，但只有 50% 的时间 - 当它处于悬停状态时，它正在工作。我什么都试过了，但互联网上的小精灵在惹我。有人可以看到问题出在哪里（问题在所有浏览器中都存在）？

这是该部分的 CSS 代码（侧边栏菜单）：

```
span[role=kategorija]{width: 24px;height: 24px; display: inline-block;position: absolute; top: 0px; left: -30px}

.kategorija_aksesoari {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0 0px}
.kategorija_izbor li a:hover .kategorija_aksesoari {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0 -24px}
.kategorija_auto_moto{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -29px 0px}
.kategorija_izbor li a:hover .kategorija_auto_moto {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -29px -24px}
.kategorija_casopisi{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -58px 0px}
.kategorija_izbor li a:hover .kategorija_casopisi {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -58px -24px}
.kategorija_filatelija{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -87px 0px}
.kategorija_izbor li a:hover .kategorija_filatelija {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -87px -24px}
.kategorija_knjige{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -116px 0px}
.kategorija_izbor li a:hover .kategorija_knjige {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -116px -24px}
.kategorija_kolekcionarstvo{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0px -53px}
.kategorija_izbor li a:hover .kategorija_kolekcionarstvo {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0px -77px}
.kategorija_masine_alati{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -28px -53px}
.kategorija_izbor li a:hover .kategorija_masine_alati {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -28px -77px}
.kategorija_muzika_filmovi{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -57px -53px}
.kategorija_izbor li a:hover .kategorija_muzika_filmovi {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -57px -77px}
.kategorija_numizmatika{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -87px -53px}
.kategorija_izbor li a:hover .kategorija_numizmatika {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -87px -77px}
.kategorija_ostalo{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -116px -53px}
.kategorija_izbor li a:hover .kategorija_ostalo {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -116px -77px}
.kategorija_racunari_oprema{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0px -106px}
.kategorija_izbor li a:hover .kategorija_racunari_oprema {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0px -130px}
.kategorija_sportska_oprema{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -29px -106px}
.kategorija_izbor li a:hover .kategorija_sportska_oprema {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -29px -130px}
.kategorija_tehnika{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -58px -106px}
.kategorija_izbor li a:hover .kategorija_tehnika {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -58px -130px}
.kategorija_telefoni{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -86px -106px}
.kategorija_izbor li a:hover .kategorija_telefoni {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -86px -130px}
.kategorija_kuca_dvoriste{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -116px -106px}
.kategorija_izbor li a:hover .kategorija_kuca_dvoriste {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -116px -130px}
.kategorija_nekretnine{background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -145px 0px}
.kategorija_izbor li a:hover .kategorija_nekretnine {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat -145px -24px} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:06:08.120

正如其他人所建议的那样，问题不在于您需要将背景图像应用于非悬停状态......这已经完成。

这里的线索是非悬停状态的声明是背景图像列表中的**第一个。**如果您更改它们的顺序，通过将悬停状态放在第一位，将显示非悬停状态并且悬停状态不起作用。

这一定意味着问题在 CSS 中更进一步。

看看实际的 CSS，你会看到：

```
.mali_oglas_izmena_selektovano {margin: 10px 0}
.mali_oglas_izmena_selektovano a {margin-right: 10px }

/
/* MALI OGLASI KATEGORIJE */

.kategorija_aksesoari {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0 0px}
.kategorija_izbor li a:hover .kategorija_aksesoari {background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0 -24px} 
```

注意评论`/`前的`/* MALI OGLASI KATEGORIJE */`？删除这个。它导致下一个 CSS 声明失败......这恰好是非悬停状态。

PS 只是为了澄清我是如何解决这个问题的——我使用[Google Chrome 开发人员工具](https://developers.google.com/chrome-developer-tools/)在我的客户端上查看源代码并使用 CSS 文件。它允许你做一些很棒的事情，比如在 CSS 和 javascript 中测试更改，而无需访问实际源代码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-15T20:54:36.073

您的问题有两个方面：

1.  你的 CSS 是一团糟，让你很难调试，这是可以理解的
2.  您的 CSS 仅将背景图像应用于`li` `span`悬停：

```
.kategorija_izbor li a:hover .kategorija_aksesoari {
    background: url('../img/resursi/kategorija/crne/icons.png') no-repeat 0 -24px;
} 
```

我建议修复两者。;)

干杯

# qt - 尝试显示窗口时出现 Qt 错误分段错误

> ID：13405919
> 
> 赞同：1
> 
> 时间：2012-11-15T20:47:24.627
> 
> 标签：qt, pointers, qt-creator, qmainwindow

我有一个类ClientWindow。我已经创建了它的几个实例并将它们的指针附加到 aa 列表中。但是，如果我尝试显示任何窗口，则会收到“分段错误（核心转储）”，我将窗口列表保存在一个名为控制器的类中。

这是我的控制器头文件：

```
#ifndef CONTROLLER_H
#define CONTROLLER_H

#include "clientwindow.h"

class Controller
{
public:
    Controller();
    void createClients(int num);
    void showWindows();

private:
    QList<ClientWindow*> clWList;
    int size;
};

#endif // CONTROLLER_H 
```

这是cpp文件：

```
#include "controller.h"

Controller::Controller()
{
}

void Controller::createClients(int num)
{
    size = num;
    for(int i = 0; i < size; i++)
    {
        ClientWindow cw;
        clWList.append(&cw);
    }
}

void Controller::showWindows()
{
    for(int i = 0; i < size; i++)
    {
        ClientWindow* cw = clWList.at(0);
        cw->show();
    }
} 
```

这是我的主要内容：

```
#include <QtGui/QApplication>
#include "clientwindow.h"
#include "controller.h"

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
   // ClientWindow w;
  // w.show();

    QString temp = argv[1];
    bool ok;
    int tempI = temp.toInt(&ok, 10);
    Controller c;
    c.createClients(tempI);
    c.showWindows();

    return a.exec();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:55:41.603

这是出错的地方：

```
for(int i = 0; i < size; i++)
{
    ClientWindow cw;
    clWList.append(&cw);
} 
```

每次迭代都会在堆栈上创建一个局部变量 cw。它在每次迭代结束时被释放。意味着数据消失了。所以你最终存储了指向垃圾的指针。

调用垃圾的成员函数通常会导致崩溃。:) 改为这样做：

```
for(int i = 0; i < size; i++)
{
    ClientWindow * cw = new ClientWindow();
    clWList.append(cw);
} 
```

完成后，您必须浏览列表并删除对象。

# jquery - Jeditable - 检测 ajax 错误

> ID：13405923
> 
> 赞同：1
> 
> 时间：2012-11-15T20:47:41.660
> 
> 标签：jquery, ajax, jeditable

如果我使用的 XHR 请求返回 HTTP 200 以外的内容（例如，如果存在内部服务器错误或服务器完全超时），是否有一些代码可以添加到[Jeditable以引发错误？](http://www.appelsiini.net/projects/jeditable)

我尝试添加回调参数（如下），但它似乎只在 AJAX 请求成功时触发......

```
 $('.foo').editable('/user/ajax_edit_full_name', 
       {
        indicator: 'Saving...',
        cancel : 'Cancel',
        submit : 'Save',
        cssclass : 'editable',
        callback : function(value, settings) {
             console.log(this);
             console.log(value);
             console.log(settings);
         }
       }
   ); 
```

**更新：**除了布鲁诺的回答之外，除了“状态”属性之外，xhr 还具有`xhr.statusText`. 所以在我的情况下，如果他们指定一个空名称（这是无效的），我已将服务器设置为发送错误 400 和自定义消息，并显示后者。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T20:56:58.260

根据[Jeditable 源代码](http://www.appelsiini.net/download/jquery.jeditable.js)，有一个名为`onerror`

```
@param Function options[onerror]  function(settings, original, xhr) { ... } called on error 
```

`onerror`因此，可以通过在函数上添加参数来实现您想要做的事情`editable`。该`onerror`参数需要以下格式的函数作为参数：

```
function(settings, original, xhr) { ... } 
```

`xhr`参数是你的`XHR Object`. 因此，您可以简单地在`onerror`函数中处理 then ，而不是尝试在 on 上捕获错误。如下所示：

```
$('.foo').editable('/user/ajax_edit_full_name', 
{
    indicator: 'Saving...',
    cancel : 'Cancel',
    submit : 'Save',
    cssclass : 'editable',
    onerror : function(settings,original,xhr){
        alert("It wasn't possible to edit. Try again");
        console.log("XHR Status: " + xhr.status);
    },
    callback : function(value, settings) {
         console.log(this);
         console.log(value);
         console.log(settings);
     }
}); 
```

我希望它有所帮助。

# java - 从另一个类更改 JLabel 文本

> ID：13405928
> 
> 赞同：1
> 
> 时间：2012-11-15T20:48:08.963
> 
> 标签：java, swing

我有以下绘制标签的类。（我这里只给出了部分代码）。Everyhting 工作正常，标签显示。

现在，我有另一个名为`Caller`Class 的课程。我有一种方法可以用来更改此标签的值。我怎样才能做到这一点

```
public class MyClass{

    private JLabel label;

    MyClass(){

       run();
    }

   public void editTheLabelsValue (String text) {
      label.setText(text);
      frame.repaint(); 
    }

    run(){
            .... // there were more code here, i removed it as it's not relevant to the problem
        label = new JLabel("Whooo");
        label.setBounds(0, 0, 50, 100);
        frame.getContentPane().add(label);
            .....
    } 
```

稍后，我将使用以下类来更改上述标签的文本。我怎样才能做到这一点。

```
public class Caller {

void methodA(){
MyClass mc = new MyClass();
mc.editTheLabelsValue("Hello");
}

} 
```

1.) 执行 methodA() 时，文本`Hello`不会显示在标签字段上。它仍然是`Whooo`. 我该如何纠正这个。我希望标签文本在`Hello`该方法执行后出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T22:03:22.067

我可以看到的直接问题是您似乎正在使用`null`布局，或者您不了解布局管理器的工作方式。

`setText`以下代码通过方法调用从子类中的主类更新标签。此方法每秒调用一次

![在此处输入图像描述](../Images/18a0a291c2ae4ee24fdb462c8ccf1414.png)

```
public class PaintMyLabel {

    private int counter = 0;

    public static void main(String[] args) {
        new PaintMyLabel();
    }

    public PaintMyLabel() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                final MasterPane master = new MasterPane();

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(master);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

                Timer timer = new Timer(1000, new ActionListener() {

                    @Override
                    public void actionPerformed(ActionEvent e) {
                        counter++;
                        master.setText("Now updated " + counter + " times");
                    }
                });
                timer.setRepeats(true);
                timer.setCoalesce(true);
                timer.start();

            }
        });
    }

    public class MasterPane extends JPanel {

        private JLabel label;

        public MasterPane() {
            label = new JLabel("Original text");
            setLayout(new GridBagLayout());
            add(label);
        }

        public void setText(String text) {
            label.setText(text);
        }

    }

} 
```

如果您正在使用`null`布局，请停止它。只是不要。只有极少数时候你会使用`null`布局，我怀疑这不是其中之一。

# ninject - Ninject拦截：服务调用被拦截的方法在自身内部调用时未被拦截

> ID：13405931
> 
> 赞同：4
> 
> 时间：2012-11-15T20:48:11.987
> 
> 标签：ninject, ninject-extensions, ninject-interception

我有一个注入了 Ninject 3.0 的服务类。我已经设置了它，所以它的代理是类代理而不是接口代理。该服务有 2 种方法，第一种方法返回广泛的结果，第二种方法调用第一种方法并对其进行过滤。我添加了一个拦截器来缓存第一种方法的结果。

当我从服务外部调用第一个方法时，拦截工作正常。

问题是当拦截器调用第二个方法时，它是通过服务本身而不是通过代理调用它，导致我从我的服务调用第一个方法没有被拦截，因此没有被缓存。

我怎样才能让它工作？

**更新：添加了示例代码**

如果有任何东西似乎没有编译，这在我的头上很抱歉

这是服务类的示例

```
public class Service : IService
{

    [CacheMethodOutput]
    public virtual object[] GetObjects(int x)
    {
        ...
    }

    public virtual object GetObject(int x, int y)
    {
        return GetObjects(x).SingleOrDefault(o => o.y == y);
    }
} 
```

CacheMethodOutputAttribute 是一个简单的属性类

这是一个示例绑定（这是我确保使用类代理而不是接口代理但实际上通过接口保留注入引用的方式）

```
// Binds by type instead of proxy to create a class proxy
Bind<Service>().ToSelf().InSingletonScope().Intercept().With<CacheAttributeInterceptor>()
Bind<IService>().ToMethod<Service>(r => r.Kernel.Get<Service>()); 
```

因此，当我从注入 IService 的任何类调用 GetObjects 时，会触发拦截器，但不会从 Service 本身的 GetObject 方法触发。

CacheAttributeInterceptor 看起来像这样（但实现细节无关紧要）：

```
public class CacheAttributeInterceptor : SimpleInterceptor
{
    public ICacheManager CacheManager {get;set;}

    public override void BeforeInvoke(IInvocation invocation)
    {
        if (Attributes.GetCustomAttribute(invocation.Request.Method, typeof(CacheMethodOutputAttribute) != null)
        {
            string key = GenerateKey(invocation.Request.Method.Name, invocation.Request.Method.Arguments);

            object returnValue;
            if (!CacheManager.TryGet(key, out returnValue))
            {
                 invocation.Proceed();
                 returnValue = invocation.ReturnValue;
                 CacheManager.Add(key, returnValue);
            }
            else
                invocation.ReturnValue = returnValue;

        }
        else
            base.BeforeInvoke(invocation);
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-16T19:06:37.413

我找到了解决方案/有关问题的更多详细信息。

如果我**删除 GetObject 方法上的 virtual 修饰符**，它将不再被拦截，当它调用 GetObjects 时，拦截器将触发。

所有这一切让我想到，如果我希望两种方法都被拦截，我需要让拦截器深入工作，如果这可能的话。

# ruby-on-rails-3 - 我怎样才能进一步干燥这个 Rails 控制器动作

> ID：13405934
> 
> 赞同：1
> 
> 时间：2012-11-15T20:48:31.033
> 
> 标签：ruby-on-rails-3, dry

我们的应用程序使用了许多环境，因此我们可以在不破坏任何东西的情况下试验设置。在一个典型的控制器动作中，我有这样的事情：

```
def some_action    
  ...
  if @foo.development_mode == 'Production'           
    @settings = SomeHelper::Production.lan(bar)
  elsif @foo.development_mode == 'Beta'
    @settings = SomeHelper::Beta.lan(nas)
  elsif @foo.development_mode == 'Experimental'
    @settings = SomeHelper::Experimental.lan(nas)
  end
  ...
 end 
```

由于我们有几十个这样的，我想我可以尝试用这样的东西来干掉事情：

```
 @settings = "SomeHelper::#{@foo.development_mode}.lan(bar)" 
```

这显然不起作用 - 我只是得到：

```
 "NasHelper::Production.lan(bar)" 
```

我怎样才能减少这种情况，还是我必须坚持我所拥有的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:06:08.647

如果您担心最终得到的是字符串而不是对象，则可以使用`String.constantize`（仅限 Rails，使用标准 Ruby，您必须实现它；它使用 Object.const_get(String)）

另一种选择是`.const_get`（例如`Object.const_get(x)`，其中 x 是您的字符串），它本身不能正确嵌套，因此您必须在“::”处拆分，等等。

此外，还有`eval`用于评估字符串的选项。但请注意：`eval`应该非常小心地使用（它很强大），或者根本不使用。

**编辑：**

这意味着，而不是：

```
 @settings = "SomeHelper::#{@foo.development_mode}.lan(bar)" 
```

你可以运行：

```
 @settings = "SomeHelper::#{@foo.development_mode}".constantize.lan(bar) 
```

**有用的资源：**

[http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-constantize](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-constantize)

[http://www.ruby-forum.com/topic/183112](http://www.ruby-forum.com/topic/183112)

[http://blog.grayproductions.net/articles/eval_isnt_quite_pure_evil](http://blog.grayproductions.net/articles/eval_isnt_quite_pure_evil)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:20:16.730

在第一种情况下，`@settings`接收方法的结果`SomeHelper::Production.lan(bar)`；在第二个，`@settings`只是得到一个字符串。您*可以*使用[这里链接的](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)[`send`方法`Object`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)来触发该方法，或者`eval`，但这不是我的首选。

It looks like you might be reinventing a wheel -- Rails already has the concept of "environments" pretty well wired into everything -- they are defined in `app/config/environments`. You set the environment when you launch the server, and can test like `Rails.env.production?`. To create new environments, just copy the existing environment file of the one closest to the new one, e.g. copy `production.rb` to `beta.rb` and edit as necessary, then test `Rails.env.beta?`, for example.

But this still leaves you testing which one all over the place. You can add to the `config` hash (e.g. `config.some_helper.lan = 'bar'`), which value you can assign to `@settings` directly. You have to make sure there's either a default or it's defined in all environments, but I think this is probably the right approach ... not knowing exactly what you aim to accomplish.

# javascript - 计算特定值在表格中出现的次数

> ID：13405936
> 
> 赞同：3
> 
> 时间：2012-11-15T20:48:40.900
> 
> 标签：javascript, jquery

我有一个 html 表，其中包含句子中的名称列表，这些名称位于`<td>`元素内部（即`<td>Mike (Jeremy's father) used to play piano</td>`或`<td>The only one who speaks french is Desmond, but Mike speaks very well spanish</td>`）。我想计算一个特定名称在**整个**表格中出现的次数。我需要通过 javascript/jquery 来完成，而不是通过 php。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T20:50:09.350

你可以使用

```
var nbMikeInTheTable = (' '+$('table').text()+' ').split('Mike').length-1; 
```

*（添加的 ' ' 是为了与 IE 上的 split 的错误实现兼容）*

或者，如果您想确定它是整个单词并且它没有被 HTML 剪切

```
 var nbMikeInTheTable = $('table').html().split(/\W+/).filter(
     function(v){return v=="Mike"}
 ).length; 
```

如果你想防止单词结尾和单元格结尾，*并确保它不是 a 属性的一部分`td`*，它会更复杂一点：

```
var nbTimesMikeIsInTheTable = $('table td').map(function(){
    return $(this).text().split(/\W+/).filter(function(v){return v=="Mike"}).length
}).toArray().reduce(function(p,v){return p+v}); 
```

*这并不优雅，但可能不需要；）*

[演示（打开控制台）](http://jsfiddle.net/KVYt7/)

# python - 要求计算逻辑矩阵 P=mn

> ID：13405944
> 
> 赞同：0
> 
> 时间：2012-11-15T20:49:26.720
> 
> 标签：python

我已经获得了一些现成的代码以及输入和预期输出，现在我需要找到一种方法来计算输入的输出

这是我得到的代码

```
3 2 4

T T
F F
T T

F F F F
T T T T

and i have been asked to calculate the logical matrix P=mn 
```

解决

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:36:18.717

```
 for i in range(len(M)):
     for j in range(len(N[0])):
         for k in range(len(N)):
             P[i][j] += M[i][k] * N[k][j] 
```

这是包含整数的矩阵的基本模式。您必须执行 2 个步骤：1）启动 P 矩阵 2）使用“T”和“F”值而不是整数进行操作。

完成第 2 步的最简单方法可能是使用 eval 函数：

```
T = 1  # eval('T') will be 1
F = 0  # eval('F') will be 0 
```

并更改行：

```
P[i][j] += eval(M[i][k]) * eval(N[k][j]) 
```

但是您仍然需要将值从 P 转换为“T”或“F”值。希望这可以帮助。

```
M = [['T', 'T'], ['F', 'F'], ['T', 'T']]             #sample values
N = [['F', 'F', 'F', 'F'], ['T', 'T', 'T', 'T']]

T = 1
F = 0

P = [] 

for i in range(len(M)):                              #result matrix creation
    P.append([None] * len(N[0]))

for i in range(len(M)):
    for j in range(len(N[0])):
        P[i][j] = 0                                  #initialization
        for k in range(len(N)):
            P[i][j] |= eval(M[i][k]) & eval(N[k][j]) #logical operators
        P[i][j] = 'T' if P[i][j] else 'F'            #conversion back to 'T' and 'F'

print P 
```

这将产生输出：

```
[['T', 'T', 'T', 'T'], ['F', 'F', 'F', 'F'], ['T', 'T', 'T', 'T']] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:17:15.660

我会看看[http://www.syntagmatic.net/matrix-multiplication-in-python/](http://www.syntagmatic.net/matrix-multiplication-in-python/)，特别是乘法函数的工作原理。

# jquery - 通过 Ajax 更改 jQuery 中的链接

> ID：13405951
> 
> 赞同：0
> 
> 时间：2012-11-15T20:49:40.147
> 
> 标签：jquery, ajax

我正在使用 jquery 在链接上绑定一些点击事件。使用以下代码，我已经能够通过 ajax 更改链接的 href - 但是当 href 更改并且我尝试单击链接时，没有任何反应。

想知道是否有人能发现我遗漏的明显错误。

```
 $('a.shortlist_action').bind('click',function(){

        item = $(this);
        href = item.attr('href');

        parent = $(this).parent('.shortlist_action_container');
        item = $(this);

        $.ajax({
          url: $(this).attr('href'),
          success: function(data) {
                item.addClass('largeviewplannerbutton');

                item.attr("href", '/myaccount/planner');
            }
          }

        });
        // stop event propagation here
        return false;
}); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:51:42.467

Remove `return false`，正如您的评论所建议的那样，它正在阻止事件传播..

请参阅[何时以及为什么在 javascript 中“返回 false”？](https://stackoverflow.com/q/855360/944681)更多细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:53:05.617

```
// stop event propagation here
return false; 
```

`return false`防止传播*和*默认行为。后者跟随`<a href>`元素的超链接。你真的应该只`e.stopPropagation()`在这里调用（并`e`在函数签名中定义）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T21:03:39.633

如前所述，`return false`在 jQuery 事件处理程序中，会阻止该事件的默认行为，当然，单击链接的默认行为是导航到链接的`href`.

因此，对于您当前的代码，每次单击都会对当前的 URL 进行 Ajax 调用`href`，而没有默认导航。即，第一次单击元素会对原始 URL 进行 Ajax 调用，然后更改 URL。没有默认导航。然后第二次单击对*新*URL 进行 Ajax 调用，但再次没有默认导航。

如果想法是只有第一次单击应该执行 Ajax 并更新`href`，而第二次和后续单击只会执行到新 URL 的标准导航，那么您应该使用该[`.one()`方法](http://api.jquery.com/one/)而不是`.bind()`. 该`.one()`方法绑定了一个事件处理程序，每个元素只运行一次。

或者，您需要在函数中添加一些额外的逻辑来决定是否更改`href`以及是否返回`false`以取消默认点击行为。和/或可能添加对`.off()`（或`.unbind()`）的调用以在您不再需要特定链接时删除单击处理程序。

# ruby-on-rails - 我应该验证连接表中的外键吗？

> ID：13405953
> 
> 赞同：3
> 
> 时间：2012-11-15T20:49:46.303
> 
> 标签：ruby-on-rails

考虑以下简化模型

```
class Article < ActiveRecord::Base
  has_many :taggings
  has_many :tags, through: :taggings
end

class Tag < ActiveRecord::Base
  has_many :taggings
  has_many :articles, through: :taggings
end

class Tagging < ActiveRecord::Base
  belongs_to :tag
  belongs_to :article
  validates :tag_id, :article_id, presence: true
end 
```

除了尝试为它编写测试外，我几乎都遵循了[标记 railscast 。](http://railscasts.com/episodes/382-tagging)

在 Railscast 中没有使用但我自己添加的 Tagging 模型中的验证让我有些头疼。

如果我创建一篇新文章，我可以传递一个标签列表：

```
a = Article.new(title: "title", tag_list: "tag 1, tag 2")
a.valid? 
#=> false 
a.errors
# => 
  @base=#<Article id: nil, title: "title">, 
  @messages={:taggings=>["is invalid", "is invalid"]}> 
```

所以看起来我的标记类的验证导致文章创建失败，因为`article_id`它还不可用。

人们通常在这里做什么？是否习惯将此类验证添加到连接表或可以跳过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:25:56.727

I would suggest that `Tagging` validates the presence of `:tag` and `:article`, rather than the IDs. This has two benefits:

1.  If the article is a new record, the `Tagging` will still be valid.

2.  If the article_id is invalid (e.g. -1), the `Tagging` will be invalid.

I disagree with the previous commenters' suggestion to remove the validation altogether, validations help avoid creating bad records. E.g a `Tagging` with an article but not a tag.

# asp.net - 在 MVC 中使用 ASP.NET 服务器控件？

> ID：13405955
> 
> 赞同：1
> 
> 时间：2012-11-15T20:49:49.133
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, razor

在我当前的项目中，我需要添加一个功能，允许用户查看他们上传的 PDF 的缩略图。我找到了一个[方便的组件](http://www.tallcomponents.com/pdfthumbnail.aspx)来实现这一点（基本版本是免费的，但足以满足我当前的需求）。无论如何，控件已经过时了（2010），因此似乎没有 MVC 支持。在演示中，他们描述了控件的用法，如下所示：

视图的标记：

```
<form method="post" runat="server" enctype="multipart/form-data">
       <asp:Panel ID="thumbnailsPanel" runat="server" />
</form> 
```

缩略图控件通过代码实例化，代表缩略图的字节数组被传递给控件，​​控件被添加到`thumbnailsPanel`

```
<script runat="server">
protected void DisplayThumbs_Click( object sender, System.EventArgs e )
{
      Thumbnail thumbnail = new Thumbnail();
      thumbnail.SessionKey = sessionID;
      thumbnail.Index = i;
      thumbnailsPanel.Controls.Add( thumbnail );
}
</script> 
```

鉴于我无法`Thumbnail`在剃刀视图中声明控件，我将如何在 MVC 中使用此控件？我花了几个小时试图使这个控件 MVC 友好无济于事，我想出的最好的方法是在我的项目中包含一个 .ASPX 视图（not.cshtml）并在该视图上呈现缩略图控件。显然这是不可取的。

那么如何在 MVC 中使用 ASPX 服务器控件呢？这个想法完全是一个坏想法，不应该实践吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:58:22.717

我在我的一个项目中通过将控件重新实现为 HtmlHelper 来解决它。假设控件不是太复杂，那么它也应该对你有用。做这个：

1.  使用反射器转储控件的源
2.  按摩源代码，使其实际编译（因为 Reflector 的源代码通常不会立即编译）
3.  确定控件的状态。将状态从成员属性转换为其自己的新 ViewModel 类的成员。
4.  找到 Render 方法并将其转换为使用的 HtmlHelper`ViewContext.Writer`

例如：

```
public class FooControl : Control {
    public String Message { get; set; }

    public override void Render(HtmlTextWriter wtr) {
        wtr.WriteLine("<p>");
        wtr.WriteLine( message );
        wtr.WriteLine("</p>");
    }
} 
```

变成这样：

```
public class FooViewModel {
    public String Message { get; set; }
}

// This method should exist in a static Extensions class for HtmlHelper
public static void Foo(this HtmlHelper html, FooViewModel model) {
    HtmlTextWriter wtr = html.ViewContext.Writer;
    wtr.WriteLine("<p>");
    wtr.WriteLine( model.Message );
    wtr.WriteLine("</p>");
} 
```

# python - 使用 python 转换图像 RGB->Lab

> ID：13405956
> 
> 赞同：46
> 
> 时间：2012-11-15T20:49:54.243
> 
> 标签：python, numpy, scipy, python-imaging-library, color-space

今天使用 PIL/Numpy/SciPy 进行转换的首选方式是什么？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-11-16T20:32:13.133

自 2010 年以来，当询问[链接问题](https://stackoverflow.com/questions/3228361/using-pil-and-numpy-to-convert-an-image-to-lab-array-modify-the-values-and-then)时，相应的代码从 scipy 移动到单独的工具包： [http ://scikit-image.org/](http://scikit-image.org/)

所以这是我真正要寻找的代码：

```
from skimage import io, color
rgb = io.imread(filename)
lab = color.rgb2lab(rgb) 
```

还应该注意的是，由于[Lab](http://en.wikipedia.org/wiki/Lab_color_space)的性质，srgb->lab 转换取决于一个附加参数：*whitepoint*，例如：
   • **Photoshop**使用称为 D50 的白点（这是 icc 的标准）
   • **OpenCV**和 skimage 使用 D65（即srgb 的标准）。
   • 默认的**Matlab**实现使用 D50（它能够使用[其他](http://www.mathworks.com/help/images/ref/whitepoint.html)），

这个很好的[常见问题解答](http://www.poynton.com/ColorFAQ.html)是这样解释的：

> 除非您有充分的理由使用其他东西，否则您应该使用 D65。
> 印刷业常用D50，摄影常用D55。
> 这些代表了室内（钨丝灯）和日光观看条件之间的折衷。

`(0,0,255)`您可以通过将 RGB 转换为 Lab来判断您正在处理的白点：
   • D50 将给您 (30, 68, -112)
   • D55 (30, 73, -110)
   • D65 (32, 79, -108)

“D”后面的数字对应于（内部）使用的白点色温：D50 = 5003 K（偏黄），D65 = 6504 K（偏蓝）

我很感谢 Alex 和 Roman 的回答，因为他们为我指明了正确的方向。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-04-15T16:22:13.360

我在旧的[Adob​​e Cookbook 网站](https://web.archive.org/web/20120502065620/http://cookbooks.adobe.com/post_Useful_color_equations__RGB_to_LAB_converter-14227.html)上找到了这段代码，并且已经适应了 Python。它不需要任何第三方模块或组件：

```
def rgb2lab ( inputColor ) :

   num = 0
   RGB = [0, 0, 0]

   for value in inputColor :
       value = float(value) / 255

       if value > 0.04045 :
           value = ( ( value + 0.055 ) / 1.055 ) ** 2.4
       else :
           value = value / 12.92

       RGB[num] = value * 100
       num = num + 1

   XYZ = [0, 0, 0,]

   X = RGB [0] * 0.4124 + RGB [1] * 0.3576 + RGB [2] * 0.1805
   Y = RGB [0] * 0.2126 + RGB [1] * 0.7152 + RGB [2] * 0.0722
   Z = RGB [0] * 0.0193 + RGB [1] * 0.1192 + RGB [2] * 0.9505
   XYZ[ 0 ] = round( X, 4 )
   XYZ[ 1 ] = round( Y, 4 )
   XYZ[ 2 ] = round( Z, 4 )

   XYZ[ 0 ] = float( XYZ[ 0 ] ) / 95.047         # ref_X =  95.047   Observer= 2°, Illuminant= D65
   XYZ[ 1 ] = float( XYZ[ 1 ] ) / 100.0          # ref_Y = 100.000
   XYZ[ 2 ] = float( XYZ[ 2 ] ) / 108.883        # ref_Z = 108.883

   num = 0
   for value in XYZ :

       if value > 0.008856 :
           value = value ** ( 0.3333333333333333 )
       else :
           value = ( 7.787 * value ) + ( 16 / 116 )

       XYZ[num] = value
       num = num + 1

   Lab = [0, 0, 0]

   L = ( 116 * XYZ[ 1 ] ) - 16
   a = 500 * ( XYZ[ 0 ] - XYZ[ 1 ] )
   b = 200 * ( XYZ[ 1 ] - XYZ[ 2 ] )

   Lab [ 0 ] = round( L, 4 )
   Lab [ 1 ] = round( a, 4 )
   Lab [ 2 ] = round( b, 4 )

   return Lab 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-16T00:49:14.137

编辑：示例 pyCMS 代码：

```
from PIL import Image
import pyCMS
im = Image.open(...)
im2 = pyCMS.profileToProfile(im, pyCMS.createProfile("sRGB"), pyCMS.createProfile("LAB")) 
```

编辑： PIL fork Pillow 似乎内置了 pyCMS。

您可以使用 pyCMS ( [http://www.cazabon.com/pyCMS/](http://www.cazabon.com/pyCMS/) )，它适用于 PIL 图像。

如果速度不是一个因素，请使用 python-colormath ( [http://code.google.com/p/python-colormath/](http://code.google.com/p/python-colormath/) )。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-12-25T18:10:48.987

这是一个类，用于转换 PIL 图像的 RGB<->LAB 颜色空间：

```
from PIL import ImageCms

class ColorTrans:

    '''Class for transforming RGB<->LAB color spaces for PIL images.'''

    def __init__(self):
        self.srgb_p = ImageCms.createProfile("sRGB")
        self.lab_p  = ImageCms.createProfile("LAB")
        self.rgb2lab_trans = ImageCms.buildTransformFromOpenProfiles(srgb_p, lab_p, "RGB", "LAB")
        self.lab2rgb_trans = ImageCms.buildTransformFromOpenProfiles(lab_p, srgb_p, "LAB", "RGB")

    def rgb2lab(self, img):
        return ImageCms.applyTransform(img, self.rgb2lab_trans)

    def lab2rgb(self, img):
        return ImageCms.applyTransform(img, self.lab2rgb_trans) 
```

示例用法：

```
color_trans = ColorTrans()
c_img = Image.open(FILENAME)
c_img_lab = color_trans.rgb2lab(c_img)
c_img_rgb = color_trans.lab2rgb(c_img_lab) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-17T08:48:31.107

目前我还没有找到一个好的包来做到这一点。您必须记住，RGB 是依赖于设备的色彩空间，因此如果您没有配置文件，您将无法准确地转换为 XYZ 或 CIE Lab。

因此请注意，在您看到从 RGB 转换为 CIE Lab 而不指定颜色空间或导入颜色配置文件的许多解决方案必须仔细评估。大多数情况下，看看引擎盖下的代码，他们认为您正在处理 sRGB 颜色空间。

# vim - 如何获取我运行的所有 vim 命令的历史列表？

> ID：13405959
> 
> 赞同：5
> 
> 时间：2012-11-15T20:50:05.463
> 
> 标签：vim

我知道这很像 Vim 中的 bash 提示符，您可以按下`:`并通过按下来获取所有历史命令的列表。

但是有没有办法将此命令历史导出到缓冲区中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-15T20:52:06.673

`:history`将向您显示您的命令的历史记录。

**编辑：**

在正常模式下，`q:`将在新缓冲区中打开您的历史记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T20:57:50.963

您可以通过查看主文件夹或`:history`vim中的 .viminfo 来检查所有命令

# android - Android中png图像的特定旋转

> ID：13405961
> 
> 赞同：2
> 
> 时间：2012-11-15T20:50:06.077
> 
> 标签：android, rotation, png

我有一个png图像。

![原始图像](../Images/7614e25246273a46d560f254a722cd03.png)

然后，我想翻转这个三角形，就像下一张图片一样。

![在此处输入图像描述](../Images/9c9f3c725156eaee1be424be6821088a.png)

红色区域是我们的原始图像被反射和转动。然后我想以不同的角度旋转新区域（红色区域）。我怎么能在android中做到这一点？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T20:55:38.903

要在 android 中旋转图像，你应该看这里

*   [在android中旋转图像](https://stackoverflow.com/questions/5389613/rotate-image-in-android)

或者在这里

*   [Android：将imageview中的图像旋转一个角度](https://stackoverflow.com/questions/8981845/androidrotate-image-in-imageview-by-an-angle)

要获得 PNG 的镜像，请执行此操作（取自以下链接，来自 Dalmas 的回答）

```
Matrix matrix = new Matrix(); 
matrix.preScale(-1.0f, 1.0f); 
Bitmap mirroredBitmap = Bitmap.createBitmap(bmp, 0, 0, bmp.width(), bmp.height(),  matrix, false); 
```

*   [如何镜像图像文件？(2.2+)](https://stackoverflow.com/questions/8552298/how-to-mirror-an-image-file-2-2)

旋转矢量看这里

*   [使用 Matrix.rotateM 旋转向量](https://stackoverflow.com/questions/6073419/rotating-a-vector-using-matrix-rotatem)

# emacs - ORG-MODE 内部 SQL-MODE 的字体锁定不是字体锁定

> ID：13405963
> 
> 赞同：5
> 
> 时间：2012-11-15T20:50:07.057
> 
> 标签：emacs, org-mode, dot-emacs, emacs24, sql-mode

与问题相关：[org-mode: fontify code blocks native](https://stackoverflow.com/questions/7189382/org-mode-fontify-code-blocks-natively)

我有截至 2012 年 11 月 1 日的最新 org-mode 和 emacs 版本（org 存储在 org-20121105 中）。

我也有 emacs-24 附带的 sql-mode。

我已经字体化变成了一个：

```
;; fontify code in code blocks
(setq org-src-fontify-natively t) 
```

然而，这并没有在我的组织文档中字体化。Java、bash 等都可以工作。

```
#+BEGIN_SRC SQL
   SELECT foo FROM bar
#+END_SRC 
```

当我打开文件 foobar.sql 时，模式指示器显示 SQL[ANSI]（我也尝试将其作为源类型），并且字体锁定有效。

提前感谢您的任何提示。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T22:40:39.743

首先，SRC 块模式的名称区分大小写。它应该`sql`代替`SQL`.

```
#+BEGIN_SRC sql
   SELECT foo FROM bar
#+END_SRC 
```

其次，sql-mode 的初始 font-lock 接缝不突出 SQL 关键字，（至少在我看来，无论你打开还是关闭它看起来都没有区别）。因此，您需要指定要突出显示的 SQL 类型。例如，如果您使用 MySQL：

```
(add-hook 'sql-mode-hook
          (lambda ()
            (sql-highlight-mysql-keywords))) 
```

然后**重启 Emacs**。它现在应该可以工作了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-15T21:35:30.627

哦，等等，试着`#+BEGIN_SRC sql`输入小写。有关标识符，请参见[此处](http://orgmode.org/worg/org-contrib/babel/languages.html)。

* * *

尝试通过重新解析块（破坏语法并撤消或其他方式）来刷新显示。python 或 bibtex 块经常发生在我身上，但这可以解决它。

我不明白为什么当你找到正确的模式时它不会内联字体化`C-c '`。

另外，我担心字体化虽然是 org-mode 更好的功能之一，但并不能完全完美地处理。从[邮件列表](http://permalink.gmane.org/gmane.emacs.orgmode/61364) ：

> 字体化引擎不是很强大，很容易被愚弄。

# file - 最佳（或任何）Grails 文件浏览器

> ID：13405965
> 
> 赞同：0
> 
> 时间：2012-11-15T20:50:08.313
> 
> 标签：file, grails, content-management-system

改天另一个问题 ;)
这次我想问你关于 grails 中的服务器文件浏览器的问题。为了更具体，我 在 grails 中寻找类似[的东西。](http://ckfinder.com/)我查看了许多站点，但只发现 CKEditror 插件附带的打开文件管理器。在某种程度上它很好，但我不能，例如，选择文件（如[CKFinder 演示](http://ckfinder.com/demo)中的“增强 HTML 表单” ）
我将非常感谢任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T12:33:26.807

我终于设法找到解决方案。有趣的是，已经提到附加到 CKEditror 插件的打开文件管理器有可能做到这一点。我只需要用新窗口打开它 (target="_blank")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T21:01:13.093

[Weceem](http://www.weceem.org/weceem/)是一个内置在 grails 中的 CMS。它具有上传 HTML 文件和进行基本文件管理的能力。

# visual-studio-2010 - 测试需要来自非域计算机的域帐户的代码

> ID：13405969
> 
> 赞同：3
> 
> 时间：2012-11-15T20:50:16.483
> 
> 标签：visual-studio-2010, active-directory, tdd, cross-domain, vpn

我正在编写连接到 Active Directory 以查询和操作用户帐户的代码。此代码包括测试集。我目前正在我的家用机器上开发此解决方案，但要针对 AD 进行测试，我需要通过 VPN 连接到公司的网络。我的家用计算机不在公司域上，但我需要在域帐户下运行才能使 AD 查询正常工作。有没有一种简单的方法可以做到这一点，或者我唯一直接的选择是远程到我的公司工作站并在那里运行测试，或者将我的个人机器添加到公司的域中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T13:44:50.607

我没有真正的 AD 经验，尽管这根本不是问题。事实上，这将有助于证明我的观点。

假设有一种方法可以返回组内的所有用户，如果我是你自己，在我正在开发的代码中，我会在我自己的接口后面抽象它。例如：

```
public class UserGroupFinder : IGroupFinder
{
    public Users FindBy(Group group)
    {
        // Code to interact with AD here
        // Note, Users and Group would be my own classes, not AD.
    }
} 
```

然后我会针对 IGroupFinder 编写有问题的应用程序，而不是一个真正的、完全成熟的 AD 系统。这意味着我可以在家、办公室或任何地方为这个事实编写单元测试（或其他自动化测试）！

只要您的代码在找到组的所有用户后“做正确的事”，您就应该没问题。例如，您可以针对姓氏以“F”开头的所有用户过滤此查询的结果。这是您的域逻辑，与 Active Directory 无关。您将对此进行*测试，***而不是**与第三方交互所需的代码。

最后一步是实际创建域对象的具体实例。因此，一旦您拥有一个配置了 AD 的系统，您实际上就可以开始将这些实现连接起来。我不会对此进行单元测试，因为根据这个定义，这不是单元测试。此代码只是对第三方代码的调用，将由 Microsoft 进行测试。

# php - SQL 数据库时间戳

> ID：13405976
> 
> 赞同：0
> 
> 时间：2012-11-15T20:50:43.643
> 
> 标签：php, mysql, sql, database, timestamp

我有一个数据库，人们在网站上注册，然后将他们的表单数据插入到他们的数据库中。除了所有这些信息，我还想插入他们的注册时间。例如，我有一个自动递增的 ID 列，我在我的 php 脚本中什么都不做，sql 数据库会自动增加每个新条目。以同样的方式，我是否可以有一个我不需要在脚本中做任何事情的时间列，而不是数据库只会获取当前时间并将其与其他插入的信息一起放置？我正在使用 phpMyAdmin，我尝试添加一个名为 Time 的列，其类型为 as `DATETIME`，默认值为 the，`CURRENT_TIMESTAMP`但它不会让我添加它并说 Time 的默认值无效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:51:51.107

[将列类型](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)更改为`TIMESTAMP`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T20:51:59.013

使用[时间戳](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)字段，这正是您想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T20:55:39.997

使用`timestamp`列类型，例如

```
`inserted` timestamp NOT NULL default CURRENT_TIMESTAMP 
```

# javascript - 如何导出带有文件名的csv文件

> ID：13405981
> 
> 赞同：3
> 
> 时间：2012-11-15T20:51:00.710
> 
> 标签：javascript, csv, export, filenames, encodeuricomponent

我想将现有数据导出到 csv 文件中。我尝试使用此代码：

```
var uriContent = "data:text/csv;charset=utf-8," + encodeURIComponent(data);
var myWindow = window.open(uriContent);
myWindow.focus(); 
```

它可以工作，但我可以设计文件名。我只能得到名称为“MVeAnkW8.csv.part”的对话框，我不知道该名称来自何处。

如何在第一个对话框中分配文件名？提前致谢。

**更新：**

我现在正在使用导轨。实际上，我在服务器端名称 export_to_csv 中有一个方法。在这个方法的最后，我使用这样的代码：

```
 send_data(csv_string,
  :type => 'text/csv; charset=utf-8;',
  :filename => "myfile.csv") 
```

它可以工作，我可以指定文件名。现在，我想使用ajax来获取更多的csv文件（这就是我想使用javascript的原因，因为普通的http请求只能下载一个文件）。

我使用这样的js代码：

```
$.post("export_to_csv",
 function(data) {
 var uriContent = "data:text/csv;charset=utf-8," + encodeURIComponent(data);
     var myWindow = window.open(uriContent);
     myWindow.focus();}); 
```

它从服务器端获取数据，我尝试将其传输到 csv 中。我可以得到一个文件，但不能指定文件名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T20:55:14.823

据我所知，您只能在 chrome 14+ 中指定文件名。看看这个问题：[Is there any way to specify aSuggested filename when using data: URI?](https://stackoverflow.com/questions/283956/is-there-any-way-to-specify-a-suggested-filename-when-using-data-uri)

更新！

如果您想“一次”下载多个 csv 文件，您可以将它们压缩在一起，或者将每个文件分别保存在服务器上（每个文件现在都有一个指向它的 url - 如果您将它们放在“www”文件夹中） . 然后通过 ajax 将文件名及其路径/url 发送到客户端（例如使用 json 编码列表）。在 ajax 回调函数中：获取文件列表并在单独的弹出窗口中打开每个文件 URL。

# java - 如何让 JPanel 垂直对齐？

> ID：13405985
> 
> 赞同：0
> 
> 时间：2012-11-15T20:51:27.487
> 
> 标签：java, jframe, jpanel, jscrollpane

这是我第一次真正在 Java 中使用图形。

我有一个问题，我试图用未定义数量的面板填充 JScrollPane（以下代码只是一个测试；我知道它是使用不良做法编写的，但这是一个测试，看看如何做到这一点就是全部）。

在最终程序中，我将有一个订单的 ArrayList（ArrayList 大小未预先确定），在 JScrollPane 中，我将有一个 JPanel，其中包含一个 JPanel（每个包含多个标签），其中包含每个订单的详细信息.

这是当前的测试代码（JScrollPane 简称为 scrollPane）：

```
 JPanel panel = new JPanel();
    GroupLayout experimentLayout = new GroupLayout(panel);
    ArrayList<JPanel> panelArray = new ArrayList();

    for(int i = 0; i <3; i++){
        JPanel panel2 = new JPanel();
        JLabel label2 = new JLabel("Hello");
        JLabel label3 = new JLabel("Hi");
        panel2.add(label2);
        panel2.add(label3);
        //panel.add(panel2);
        panelArray.add(panel2);

    }

        experimentLayout.setHorizontalGroup(
            experimentLayout.createParallelGroup()
                .addComponent(panelArray.get(0))
                .addComponent(panelArray.get(1))
                .addComponent(panelArray.get(2))
           );

        experimentLayout.setVerticalGroup(
            experimentLayout.createSequentialGroup()
                                                                                                 //.addGroup(experimentLayout.createParallelGroup(GroupLayout.Alignment.LEADING)
                .addComponent(panelArray.get(0))
                .addComponent(panelArray.get(1))
                .addComponent(panelArray.get(2))
            );

        scrollPane.setViewportView(panel); 
```

运行时，包含标签的 JPanel 将水平显示（彼此相邻），而不是彼此下方。

关于如何垂直显示它们的任何帮助都会有很大帮助 - 谢谢大家:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T20:54:52.110

您可能会发现 GridLayout 很有用。

# mysql - 在 vb.net 中发送给用户的确认电子邮件到 mysql 数据库

> ID：13405986
> 
> 赞同：0
> 
> 时间：2012-11-15T20:51:31.777
> 
> 标签：mysql, vb.net, confirmation-email

只是想问是否有某种方法可以将自动电子邮件确认添加到 vb.net 网站。我希望该用户在网站上创建新帐户，并且网站将确认链接发送给他们。只有单击确认电子邮件，用户才能完全注册。

我知道有一些方法可以从 vb 构建登录页面。但我正在使用我自己的登录名。主要是因为用户连接的数据库是MySql。

像这样的东西：[http ://www.asp.net/web-forms/videos/authentication/implement-the-registration-verification-pattern](http://www.asp.net/web-forms/videos/authentication/implement-the-registration-verification-pattern)

知道在哪里看吗？大多数谷歌搜索链接都使用 php 或 Microsoft Sql。

在此先感谢您提供任何好的链接或解决方案。

彼得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T21:43:23.600

基本上，当用户注册帐户时，您会生成一个确认号（我将使用 GUID），然后向用户发送一封带有确认链接的电子邮件。确认链接是确认页面的url，以确认#为参数，即 www.mysite.com/confirmation.aspx?code={guid} 。您将确认代码与用户帐户表一起保存在数据库中（它可以在同一个表中或单独的表中）。用户必须单击确认 url 进行确认。确认时，只需检查代码是否与数据库中的 Guid 相同即可。

基本上流程是一样的，和mySQL或者SQL Server没有太大关系。

这是一个例子，虽然是C#，同样的过程，只是代码中的语法有点不同：

[http://www.webreference.com/programming/asp_net/registration-confirmation-system/index.html](http://www.webreference.com/programming/asp_net/registration-confirmation-system/index.html)

还

[包含唯一标识符的 asp.net 确认邮件发送链接](https://stackoverflow.com/questions/8767182/asp-net-confirmation-mail-send-link-that-contains-a-unique-identifier)

# python - Python 解析 xml 以从数据中检索“标题”

> ID：13405991
> 
> 赞同：0
> 
> 时间：2012-11-15T20:51:46.720
> 
> 标签：python, xml-parsing

我正在尝试找出一种方法来使用 python 读取 URL 内容，然后将标题解析为变量。

显示/读取的 URL 数据示例：

```
<subsonic-response xmlns="http://subsonic.org/restapi" status="ok" version="1.8.0" debug="true">
    <script id="FirebugLite" firebugIgnore="true" extension="Chrome"/>
    <song id="11450" parent="11042" title="30 Minutes Or Less (2011)" album="30 Minutes Or Less (2011)" isDir="false" created="2011-11-04T16:07:38" duration="4983" bitRate="1536" size="3521040154" suffix="mkv" contentType="video/x-matroska" isVideo="true" path="30 Minutes Or Less (2011)/30 Minutes Or Less (2011).mkv" transcodedSuffix="flv" transcodedContentType="video/x-flv"/>
</subsonic-response> 
```

有没有办法从标题字段中获取数据？所以在一个变量中，我最终会得到“30 分钟或更少（2011 年）”

我现在有流动的代码，但很难让它工作。

```
import urllib, urllib2
from xml.etree.ElementTree import ElementTree
url = 'https://myurl.com'
root = urllib.urlopen(url).read()
tester = ElementTree.parse(root)
elem = ElementTree.find("title")
print elem 
```

错误：TypeError：必须使用 ElementTree 实例作为第一个参数调用未绑定的方法 parse()（改为获取 str 实例）

# assembly - 我可以使用汇编语言创建什么类型的应用程序/项目？

> ID：13405992
> 
> 赞同：1
> 
> 时间：2012-11-15T20:51:48.993
> 
> 标签：assembly

我在大学的第三个学期。我对编写汇编语言几乎一无所知：我只是使用 MASM 并编写了`mov`各种`add eax,var1`指令。

我们可以用汇编语言创建类似于我们在 C/C++ 中所做的程序吗？

您能否推荐任何使用 Assembly 构建的示例项目？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T20:59:53.447

您可以在汇编程序中编写任何类型的应用程序。它与诸如 C 之类的其他语言之间的主要区别（以及可能使您感到困惑的地方）是汇编程序的级别极低。用 C 语言中的一行代码可以轻松完成的工作需要汇编中的许多指令。这实质上就是创建诸如 C 之类的语言的原因。使编写程序更快更容易，因为它们可以在 1 行中完成需要很多很多汇编指令才能完成的工作。您还必须了解很多关于计算机如何“思考”来编写汇编程序的知识。

组装的最大好处是它的速度很快。C 和其他语言必须对您正在尝试做的事情做出假设以节省您的时间。在汇编中，您可以避免来自这些假设的所有额外开销，这使您的程序非常非常快。

在大学里学习一些汇编程序是非常值得的，因为它可以让您深入了解计算机是如何“思考”的，以及 C 和其他语言真正为您提供的好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-15T20:57:14.977

Steve Gibson 几乎在 Assembler 中编写了所有（如果不是全部）[他的实用程序。](https://www.grc.com/freepopular.htm)

他甚至有一个[“入门工具包”](https://www.grc.com/smgassembly.htm)，用于在 Assembler 中编写 Windows 应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-15T20:54:37.663

由于您的计算机最终总是运行机器指令，因此您可以用任何语言编写任何应用程序。“任何语言”当然包括汇编语言。

[WriteNow](http://en.wikipedia.org/wiki/WriteNow)是一个用汇编语言（在本例中为 68k）编写的相对复杂的应用程序的一个很好的例子。

# c++ - 从 QGridLayout 中删除一行

> ID：13405997
> 
> 赞同：7
> 
> 时间：2012-11-15T20:52:02.280
> 
> 标签：c++, qt

所有，我正在维护一个显示多项式系数的其中一个`QGridLayout`。`QLabels`我用 表示我的多项式`QList<double>`。

每次我更新我的系数时，我都会更新我的标签。更改列表大小时，我的方法效果**不佳**。 `QGridLayout::rowCount()`没有正确更新。我想知道是否有办法从 QGridLayout 中删除行。

* * *

代码如下，`QGridLayout`用更多（或更少）更新大小`QLabels`

```
int count = coefficients->count(); //coefficients is a QList<double> *
if(count != (m_informational->rowCount() - 1)) //m_information is a QGridLayout
{
    SetFitMethod(0);
    for(int i = 0; i < count; ++i)
    {
        QLabel * new_coeff = new QLabel(this);
        new_coeff->setAlignment(Qt::AlignRight);
        m_informational->addWidget(new_coeff, i+1, 0);
        QLabel * param = new QLabel(this);
        param->setAlignment(Qt::AlignLeft);
        param->setText(QString("<b><i>x</i><sup>%2</sup></b>").arg(count-i-1));
        m_informational->addWidget(param, i+1, 1);
        QSpacerItem * space = new QSpacerItem(0,0,QSizePolicy::Expanding);
        m_informational->addItem(space, i+1, 1);
    }

    m_informational->setColumnStretch(0, 3);
    m_informational->setColumnStretch(1, 1);
    m_informational->setColumnStretch(2, 1);
} 
```

SetFitMethod（这是一个初始模型）

```
void SetFitMethod(int method)
{
    ClearInformational();
    switch(method)
    {
    case 0: //Polynomial fit
        QLabel * title = new QLabel(this);
        title->setText("<b> <u> Coefficients </u> </b>");
        title->setAlignment(Qt::AlignHCenter);
        m_informational->addWidget(title,0,0,1,3, Qt::AlignHCenter);
    }
} 
```

清算方法：

```
void ClearInformational()
{
    while(m_informational->count())
    {
        QLayoutItem * cur_item = m_informational->takeAt(0);
        if(cur_item->widget())
            delete cur_item->widget();
        delete cur_item;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T21:45:34.950

问题是它`QGridLayout::rowCount()`实际上并没有返回您可以看到的行数，它实际上返回了`QGridLayout`内部为数据行分配的行数（是的，这不是很明显并且没有记录）。

要解决这个问题，您可以删除`QGridLayout`并重新创建它，或者如果您确信列数不会改变，您可以执行以下操作：

```
int rowCount = m_informational->count()/m_informational->columnCount(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T07:07:32.527

我通过创建 QVBoxLayout（用于行）解决了这个问题，并在其中添加了 QHBoxLayout（用于列）。然后在 QHBoxLayout 中插入我的小部件（在一行中）。通过这种方式，我能够很好地删除行 - 总行数正常工作。除此之外，我还获得了一个插入方法，因此我能够将新行插入特定位置（所有内容都正确重新排序/重新编号）。

示例（仅来自头部）：

```
QVBoxLayout *vBox= new QVBoxLayout(this);

//creating row 1
QHBoxLayout *row1 = new QHBoxLayout();
QPushButton *btn1x1 = new QPushButton("1x1");
QPushButton *btn1x2 = new QPushButton("1x2");
row1->addWidget(btn1x1);
row1->addWidget(btn1x2);
//adding to vBox - here you can use also insertLayout() for insert to specific location
vBox->addlayout(row1); 

//creating row 2
QHBoxLayout *row2 = new QHBoxLayout();
QPushButton *btn2x1 = new QPushButton("2x1");
QPushButton *btn2x2 = new QPushButton("2x2");
row2->addWidget(btn2x1);
row2->addWidget(btn2x2);
//adding to vBox - here you can use also insertLayout() for insert to specific location
vBox->addlayout(row2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:43:57.573

好吧，我的解决方案是同时删除`QGridLayout`in`ClearInformational`