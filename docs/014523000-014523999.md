# StackOverflow 问答 14523000-14523999

# c# - 使用 mvc 2010 在 SQL Server 中上传/下载 pdf 文件

> ID：14523001
> 
> 赞同：6
> 
> 时间：2013-01-25T13:45:02.957
> 
> 标签：c#, sql-server, asp.net-mvc, pdf

我一直在自学如何使用**mvc 2010 Express在****c#**中编程，因为我被要求为我工作的公司创建一个应用程序。我要做的最后一件事是允许用户**上传和下载 pdf**文件，但我找不到对我有帮助的解决方案。

 ****我使用**SQL Server 2005**。我要使用的表称为`Clients`. 它有一个`Id`作为主键。我应该创建一个属性来将 pdf 存储为二进制文件吗？或者怎么做？

要上传 pdf，我的视图中有一个链接，可将用户重定向到`id`客户端的另一个视图（名为 Upload）。控制器名称是`Home`，因此用户将看到如下内容：

```
Home.aspx/Upload/2 
```

在那里，我希望用户能够选择他想要上传的 pdf，然后单击按钮上传。因此控制器将使用`[HttpPost]`.

编辑客户端非常简单，因为我在 ViewModels 文件夹中创建了模型视图，然后将它们传递给控制器​​。但是我怎样才能**将 pdf 文件和 pdf 文件****都传递给控制器​​呢？`id`**我需要`id`知道那是什么用户。以及**如何将 pdf 存储`Clients`在 SQL Server 的表中？** 然后**我怎样才能下载pdf？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-25T14:07:07.613

这就是我正在使用的......你应该做一些改变以适应你的要求。

> *如何将 id 和 pdf 文件都传递给控制器​​？*

**看法：**

```
 @using (Html.BeginForm("Add", "Archivos",
                     FormMethod.Post, new { id = "attachment", enctype = "multipart/form-data", encoding = "multipart/form-data" }))
    { 

        @Html.HiddenFor(x => Model.UserID)
        <input type="file" name="uploadFile" id="uploadFile" />

       <input type="submit" value="Guardar"/>

    } 
```

**控制器：**

```
 [HttpPost]
    public ActionResult Add(HttpPostedFileBase uploadFile, int UserID)
    {
        if (uploadFile != null && uploadFile.ContentLength > 0)
        {

            //instance the user.. i.e "User1"

            byte[] tempFile = new byte[uploadFile.ContentLength];
            uploadFile.InputStream.Read(tempFile, 0, uploadFile.ContentLength);

            User1.file.Content = tempFile;
            User1.file.Save();

        }

        return RedirectToAction("Index");
    } 
```

> *然后我怎样才能下载pdf？*

**控制器：**

```
public ActionResult Get(int UserID)
    { 

        var User1 = new User {UserID = UserID };
        User1.LoadFile();

   //If file exists....

        MemoryStream ms = new MemoryStream(User1.File.Content, 0, 0, true, true);
        Response.ContentType = User1.File.Type;
        Response.AddHeader("content-disposition", "attachment;filename=" + User1.File.Name);
        Response.Buffer = true;
        Response.Clear();
        Response.OutputStream.Write(ms.GetBuffer(), 0, ms.GetBuffer().Length);
        Response.OutputStream.Flush();
        Response.End();
        return new FileStreamResult(Response.OutputStream, User1.File.Type);

    } 
```

**看法：**

```
 @Html.ActionLink("PDF", "Get", "Files", new { UserID = Model.UserID }, new { @class = "pdf-icon-l", title="Open PDF document" }) 
```

> *以及如何将 pdf 存储在 SQL Server 的表客户端中？*

**数据库表：**

```
 CREATE TABLE [dbo].[FileTableName] (
 [UserID] int NOT NULL,
 [Name] varchar(256) NOT NULL,
 [Type] varchar(256) NOT NULL,
 [Length] int NOT NULL,
 [Content] varchar(max) NOT NULL) // option: varbinary(max) 
```

要存储我正在使用存储过程的文件

**模型：**

```
 public class File
 {

    public string Name { get; set; }
    public string Type { get; set; }
    public long Length { get; set; }
    public byte[] Content { get; set; }

}

public class User

{
    public int UserID {get; set;}
    public string name {get; set;}
    /**/

    public file file {get; set;}

    /**/

    public void SaveFile()
   {
    SqlDataReader _dataReader;
    using (new MyConnectionManager())
    {
        using (_sqlCommand = new SqlCommand("SavePDFFile", MyConnectionManager.Connection)) 
       {
        _sqlCommand.CommandType = CommandType.StoredProcedure;
        _sqlCommand.Parameters.Add(new SqlParameter("@UserID", this.UserID));
        _sqlCommand.Parameters.Add(new SqlParameter("@Name", this.Name));
        _sqlCommand.Parameters.Add(new SqlParameter("@Type", this.Type));
        _sqlCommand.Parameters.Add(new SqlParameter("@Length", this.Length));
        _sqlCommand.Parameters.Add(new SqlParameter("@Content", this.Content));
        _dataReader = _sqlCommand.ExecuteReader();

        _dataReader.Close();
    }
  }
}

  public void LoadFile()
    { 
        SqlDataReader _dataReader;
        using (new MyConnectionManager())
        {
             using (_sqlCommand = new SqlCommand("GetPDFFIle", MyConnectionManager.Connection))
            _sqlCommand.CommandType = CommandType.StoredProcedure;
            _sqlCommand.Parameters.Add(new SqlParameter("@UserID", this.IDEnsayo));
            _dataReader = _sqlCommand.ExecuteReader();
            if (_dataReader.HasRows)
            {
                _dataReader.Read();
                this.File.Name = (string)_dataReader["Name"];
                this.File.Type = (string)_dataReader["Type"];
                this.File.Length = (int)_dataReader["Length"];
                this.File.Content = (byte[])_dataReader["Content"];

            }
            _dataReader.Close();
        }
    }
  }

 } 
```****

# c# - XNA。如何构建它，以便您使用尽可能少的 spritebatch 开始/结束语句

> ID：14523004
> 
> 赞同：0
> 
> 时间：2013-01-25T13:45:13.673
> 
> 标签：c#, performance, architecture, xna, spritebatch

我在 XNA 中制作 2d 游戏。我开始使用可绘制的游戏组件并且非常高兴。每个精灵都派生自 drawable-game-component 并且每个精灵都有自己的开始/结束语句（甚至每个图块构成一堵墙）。我在读了一点之后意识到这是一种不好的方式来提高性能。

现在我想知道有什么好的方法来做到这一点......让我们说我游戏中的每个房间......

```
_spritebatch.Begin(SpriteSortMode.Deferred,
                       BlendState.Opaque,
                     SamplerState.LinearClamp,
                DepthStencilState.Default,
                  RasterizerState.CullNone,
                                  null,
                         _camera.Transform);

for (each block in Blocklist)
{
    _spritebatch.Draw(block._txture,
                      block._position + block._centerVect,
                      block.txtrect, block._color,
               (float)block.txtrot,
                      block._centerVect, 
                          1.0f,
              SpriteEffects.None,
                            0f);
}
_spritebatch.End(); 
```

我要问的原因是我必须公开每个块中的字段负载，以便 Room 类可以让它们执行其 _spritebatch.Draw 例如。块._位置

我假设这并不重要，性能会提高，但是有没有人可以推荐的更好的架构来做到这一点？

此外，由于该代码在那里，任何人都可以评论我正在使用的 SpriteBatch.Begin 参数吗？他们是最快的吗？我需要的只是变换

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:46:16.557

> 我要问的原因是我必须公开每个块中的字段负载，以便 Room 类可以让它们执行其 _spritebatch.Draw 例如。块._位置

假设你有很多房间，每个房间里有很多块，你可以给每个房间和每个块一个公共或受保护的 Draw() 方法，那么块的所有字段都不需要是公共的。

```
class Block
{
  ... // private fields about Block
  ...

  Public void Draw(GameTime gt, SpriteBatch sb)
  {
     sb.Draw(private block fields here);
  }
} 
```

然后是房间

```
class Room
{
  ... // private fields about room
  ...
  List<Block> blocks;

  Public void Draw(GameTime gt, SpriteBatch sb)
  {
     sb.Draw(private room fields here);
     foreach(Block b in blocks)
         b.Draw(gt, sb)
  }
} 
```

然后在主游戏类

```
//fields section
List<Room> rooms;

    // in the Draw

    spriteBatch.Begin();
      foreach(Room r in rooms)
          r.Draw(gt, spriteBatch);
    spriteBatch.End(); 
```

在这种情况下，整个帧只有一个 Begin/End 块。

# javascript - 仅限 JavaScript - 单击或翻转时如何更改字体大小

> ID：14523007
> 
> 赞同：1
> 
> 时间：2013-01-25T13:45:19.987
> 
> 标签：javascript, css, fonts

这就是我想要做的。在我的 html 页面上，我必须有 4 种不同的字体大小，`10px 20px 30px 40px`然后重新设置。

当我单击或滚动字体时，字体大小会发生变化并在框中 `10px`显示字体的新大小。`div`

我也有一个输入框，所以当我在输入框中输入并按下提交时，它会显示您输入的文本，并在输入`div`框中以`CSS`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:51:28.660

bs至于你想要这样的 HTML

```
<ul id="sizes">
    <li class="size" rel="10">10px</li>
    <li class="size" rel="20">20px</li>
    <li class="size" rel="30">30px</li>
    <li class="size" rel="40">40px</li>
    <li>
        <input class="manual" type="text" />
    </li>
<ul>
<div id="content">The font size to change goes here</div> 
```

而对于 jQuery

```
$( '#sizes' ).on({

    mouseover: function ( event ) {

        var $target = $( event.target );

        if ( $target.is( '.size' ) ) {
            $( '#content' ).css( 'font-size', $target.attr( 'rel' ) );
        }

    },
    blur: function ( event ) {

        var $target = $( event.target );

        if ( $target.is( '.manual' ) ) {
            $( '#content' ).css( 'font-size', parseInt( $target.val(), 10 ) );
        }

    }

}); 
```

这应该足以让你开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:52:28.957

这应该让你开始；一个更改 div 字体大小的按钮，以及一个将文本从文本框复制到 div 的按钮：

```
<div id="demo"></div>

<input type="button" value="Size 10" onclick="document.getElementById('demo').style.fontSize='10px';" />

<input type="text" id="demotext" />
<input type="button" value="Use text" onclick="document.getElementById('demo').innerHTML=document.getElementById('demotext').value;" /> 
```

演示：http: [//jsfiddle.net/Guffa/AzmMc/](http://jsfiddle.net/Guffa/AzmMc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:17:28.967

```
 $("p1").mouseover(function(){
 $("p").css("fontsize","10px");
 });

 $("button ").onclick(function(){1
 $("p").css("fontsize","10px");
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:21:27.983

这可能不是您想要的，但它应该可以帮助您入门，而且它是一个纯**JavaScript**解决方案：

**HTML**

```
<div id="fonts">
    <button value="10px">10px</button>
    <button value="20px">20px</button>
    <button value="30px">30px</button>
    <button value="40px">40px</button>
    <button value="15px">Reset</button>
</div>

<div id="text">The font size to change goes here</div> 
```

您会注意到我已将`Reset`按钮设置为 15 像素，但我不确定在您的情况下默认字体大小应该是多少。

**Javascript**：

```
var text = document.getElementById("text");
var size = "15px";

var changeFontSize = function(e){
    var target = e.target;
    if(target.nodeName.toLowerCase() === "button"){
        text.style.fontSize = target.value;
        if(e.type.toLowerCase() === "click"){
            size = target.value; 
        }    
    }
};

var mouseOut = function(e){
    text.style.fontSize = size;
}

document.addEventListener("click", changeFontSize, false);
document.addEventListener("mouseover", changeFontSize, false);
document.addEventListener("mouseout", mouseOut, false); 
```

根据您需要的浏览器兼容性，您可能需要查看[addEventListener](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener)和[attachEvent](http://msdn.microsoft.com/en-us/library/ie/ms536343%28v=vs.85%29.aspx)。

在执行事件处理程序并弄乱`e`值时，浏览器之间的事情会变得有些棘手。这主要是`jQuery`解决方案受欢迎的原因，因为它通常会解决兼容性问题。

**[例子](http://jsfiddle.net/9qHKw/8/)**

# asp.net-mvc - 在 ASP.NET MVC 中显示模型警告和错误

> ID：14523008
> 
> 赞同：3
> 
> 时间：2013-01-25T13:45:20.327
> 
> 标签：asp.net-mvc, modelstate

[Simon Farrow](https://stackoverflow.com/questions/367846/model-warnings-in-asp-net-mvc)指出了一种扩展 MVC 框架以处理警告的好方法。我的问题是如何通过 ValidationSummary 以不同的颜色显示警告和模型错误。您可以使用 ValidationSummary 控制是否仅在摘要上、靠近属性或同时在两者上显示属性级别警告。

# ios - 从库 ios 访问视频

> ID：14523010
> 
> 赞同：-1
> 
> 时间：2013-01-25T13:45:22.710
> 
> 标签：ios, video, camera, uiimagepickercontroller

如何在不使用的情况下从相机胶卷库中获取所有视频文件`UIImagePickerController`？有机会吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:48:28.283

你应该使用 ALAssets 来做到这一点。[看苹果文档。](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAsset_Class/Reference/Reference.html)

# .net - 异常：WCF 服务在将图像作为字节数组保存到数据库时抛出错误请求

> ID：14523022
> 
> 赞同：0
> 
> 时间：2013-01-25T13:46:25.183
> 
> 标签：.net, wcf, exception

我创建了一个 WCF 服务，用于将图像保存为字节数组。以下是合同、实施和委托细节

**合同**

```
 [OperationContract]
        void InsertEmployeeData(EmployeeDetail empName); 
```

**执行**

```
 public void InsertEmployeeData(EmployeeDetail empName)
        {
            ctx.EmployeeDetails.AddObject(empName);
            ctx.SaveChanges();
        } 
```

当我尝试保存低于 15 kb 时，我可以成功保存。上传超过 15 kb 时出现异常**远程服务器返回意外响应：（400）错误请求**我该如何解决这个错误？

**装订细节**

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_ImobService" closeTimeout="00:10:00"
          openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00"
          maxBufferSize="250000000" maxBufferPoolSize="250000000" maxReceivedMessageSize="250000000">
          <readerQuotas maxDepth="4500000" maxStringContentLength="4500000"
            maxArrayLength="4500000" maxBytesPerRead="40960000" maxNameTableCharCount="250000000" />
          <security mode="None">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://anishk.india-powai.orioninc.com/mobservice/MobService.svc"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_ImobService"
        contract="MobileService.ImobService" name="BasicHttpBinding_ImobService" />
    </client>
  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:55:58.150

如果您在 IIS 上托管服务，则请求长度限制为 15 kb 是一个很好的变化。尝试更改 IIS 设置

```
<httpRuntime maxRequestLength="25000" /> 
```

将请求长度更改为最大值。您要上传的文件大小。

# python - 实例化一个以变量命名的对象

> ID：14523034
> 
> 赞同：0
> 
> 时间：2013-01-25T13:46:41.780
> 
> 标签：python, object, instantiation

我有一个组件对象库。我想在另一个对象中包含这些对象的选择实例。但我想将该选择作为列表提供，以便每次使用列表实例化容器对象时，都会在其中创建指定的子对象。

假设我的组件库如下所示：

```
class ColorBlob(object):
    ...
    def wipeItUp()
        ...

class RedBlob(ColorBlob):
    ...
    def paintIt()
        ...
class YellowBlob(ColorBlob):
    ...
    def paintIt()
        ...
class BlueBlob(ColorBlob):
    ...
    def paintIt()
        ... 
```

我的容器对象如下所示：

```
class Pallet(object):
    def __init__(self, colorList):
        for color in colorList:
            #Ok, here is where I get lost if I know the color I can do this:
            Pallet.BlueBlob = blobLib.BlueBlob()
            #But I don't, so I am trying to do something like this:
            blobSpecs       = getattr(blobLib, color)
            blobSpecs.Obj   = blobSpecs().returnObj(self.page) # with "returnObj" defined in the library as some other method
            setattr(self, Pallet.blobName, blobSpecs) #and I am completely lost. 
```

但我真正想要在我的功能代码中做的是：

```
workingPallet=Pallet(['RedBlob', 'BlueBlob'])
workingPallet.RedBlob.paintIt() 
```

我知道当我尝试实例化容器中的子对象时我迷路了。有人可以帮我理清我的“getattr”和“setattr”废话吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T13:54:53.637

你几乎就在那里，但这不是你的问题，`getattr`或者`setattr`那是问题所在。您最终将类重新设置为`self`，而不是您创建的实例：

```
def __init__(self, colorList):
    for color in colorList:
        blobSpec       = getattr(blobLib, color)
        blob           = blobSpec()    # create an instance of the blob
        blob.Obj       = blob.returnObj(self.page) 
        setattr(self, color, blob) 
```

这与直接调用类 ( `BlueBlob()`) 相同，但现在通过变量调用。

# jpa - 如何将 JDO 中的超类映射到与 JPA 中的 @MappedSuperclass 类似的行为

> ID：14523035
> 
> 赞同：0
> 
> 时间：2013-01-25T13:47:05.563
> 
> 标签：jpa, orm, jdo, datanucleus

我需要具有相同基本属性集但具有不同身份类型和生命周期的实体。实际上，我正在尝试使用不同的实体实施业务审计。嵌入式对象不是选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:35:44.203

```
<inheritance strategy="subclass-table"/> 
```

将允许您延迟超类与子类表的绑定。

或者，如果您更喜欢超类上的注释：

```
@Inheritance(strategy=InheritanceStrategy.SUBCLASS_TABLE) 
```

应该做的伎俩。

见[http://www.datanucleus.com/products/accessplatform_3_2/jdo/orm/inheritance.html#subclasstable](http://www.datanucleus.com/products/accessplatform_3_2/jdo/orm/inheritance.html#subclasstable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T20:22:35.233

请注意，如果您有超过 1 个子类，则无法查询超类，例如（在 JQL 中）：

```
SELECT id FROM some.superclass where creationstamp == :date" 
```

不起作用，因为 DataNucleus 无法解析多个子类的表，但 new_table 策略有效

# html - 页面中的中心 div

> ID：14523037
> 
> 赞同：0
> 
> 时间：2013-01-25T13:47:07.263
> 
> 标签：html, center

我知道这已经被问了一千（百万？）次，但是对于我的生活，我无法弄清楚为什么我不能让一个 div 在我的页面上居中。即使将 HTML 和 CSS 剥离到最低限度。

如果有人能指出我在这里缺少的东西，我将不胜感激。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">

<html>
    <head>
        <style type="text/css">
            div#branchSelect { margin: 0 auto; }
        </style>
    </head>
    <body>
        <div id="branchSelect">
            <h4 class="selectBranch">Select a Branch to View</h4>
            <select type="select" id="ddlBranches" class="selectBranch">
                <option id="defaultBranchesListItem" value="0">Select a branch...</option>
                <option value="1">Atlanta</option>
            </select>
        </div>
    </body>
</html> 
```

这是一个[jsFiddle](http://jsfiddle.net/eventide/YjvMs/1/)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T13:48:44.400

div 自动设置为 100% 宽度。

只需设置 div 的宽度并使用 将`margin: 0 auto;`其在页面上居中。

```
div#branchSelect {
    width:300px;
    margin:0 auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:54:12.343

您的 div 缺少 width 属性，因此默认情况下它的值为 100%，因此无论您做什么，它都会在屏幕上一直拉伸，因此只需将 width 属性分配给您的 div，然后将边距设置为“0 auto ” 马库斯·雷克 (Marcus Recck) 所展示的风格

```
<body>
    <div style="width:800px; margin:0 auto;">
        centered content
    </div>
</body> 
```

# ant - Ant 在构建时找不到 ant 类 (DateUtils)

> ID：14523042
> 
> 赞同：2
> 
> 时间：2013-01-25T13:47:28.803
> 
> 标签：ant, jaxb, classpath

我正在尝试通过 ant 构建一个项目。它在我的本地机器上通过 ant 构建得很好，但在我们的构建机器上我得到：

```
java.lang.NoClassDefFoundError: org/apache/tools/ant/util/DateUtils
    at org.apache.tools.ant.DefaultLogger.formatTime(DefaultLogger.java:323)
    at org.apache.tools.ant.DefaultLogger.buildFinished(DefaultLogger.java:170)
    at org.apache.tools.ant.Project.fireBuildFinished(Project.java:        
    at org.apache.tools.ant.Main.runBuild(Main.java:778)
    at org.apache.tools.ant.Main.startAnt(Main.java:217)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)
Caused by: java.lang.ClassNotFoundException: org.apache.tools.ant.util.DateUtils
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:319)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:264)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:332) 
```

这发生在 jaxb-code-generation 目标中，并在它调用简单的 ant 复制方法时发生。它找不到的类（DateUtils）在 ant.jar 本身中，我不知道如何让它为这个目标加载 ant.jar（我原以为已经有了可用的 ant.jar因为它在 ant 中运行）。我知道这是一个类路径问题，但不知道如何解决它。

这是 ant 构建文件的一部分，直到失败的副本：

```
<target name="jaxb-code-generation" depends="xjc-typedef-target,-do-init,-init-macrodef-javac">
    <mkdir dir="${build.generated.sources.dir}/jaxb" xmlns:s="http://xml.netbeans.org/schema/JAXBWizConfig"/>
    <mkdir dir="build/generated/jaxbCache" xmlns:s="http://xml.netbeans.org/schema/JAXBWizConfig"/>
    <mkdir dir="build/generated/jaxbCache/Listing"/>
    <xjc package="Listing" destdir="build/generated/jaxbCache/Listing" catalog="catalog.xml">
        <classpath>
            <pathelement location="${src.dir}"/>
            <pathelement path="${jaxbwiz.xjcrun.classpath}"/>
        </classpath>
        <arg value="-xmlschema"/>
        <schema file="xml-resources/jaxb/Listing/Listing.xsd"/>
        <depends file="xml-resources/jaxb/Listing/Listing.xsd"/>
        <produces dir="build/generated/jaxbCache/Listing"/>
    </xjc>
    <copy todir="${build.generated.sources.dir}/jaxb">
        <fileset dir="build/generated/jaxbCache/Listing"/>
    </copy> 
```

同样，这在我的本地机器上运行良好。我的本地机器和构建机器都运行 Java 1.6 和 Ant 1.7.1，并且都是 linux（我的是 Linux Mint，构建机器是 Ubuntu）。

**更新：**数据点：我创建了一个新的 build.xml，它只是复制了一个文件，就是这样。它使用了相同的 ant 方法，并且在单独运行时效果很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-06T17:58:22.703

在似乎相关的构建问题中，我遇到了同样的问题（至少同样的错误）。对我有用的解决方案只是设置 ANT_HOME 环境变量。这似乎没有必要，因为 ant 在 PATH 中，所以我希望它会找到所需的一切，但似乎没有。当我将 ANT_HOME 设置为正确的路径时，就会构建相同的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:13:46.263

有时我使用这个： [jarfinder](http://www.jarfinder.com/)

您可以检查 org/apache/tools/ant/util/DateUtils

我不确定你错过了哪个，但也许有助于猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-17T12:59:33.253

使用以下内容运行 xjc native：

```
<target name="xjc">
    <exec executable="xjc">
        <arg value="-d"/>
        <arg value="src"/>
        <arg value="-p"/>
        <arg value="bla.bla.bla"/>
        <arg value="${xjc.in.dir}/bla.xsd"/>
    </exec>
</target> 
```

对我来说完美无缺。 [在这里找到](http://josm.openstreetmap.de/ticket/10040#no1)

# windows-8 - 在相关的 Windows 应用商店应用程序之间共享设置

> ID：14523046
> 
> 赞同：0
> 
> 时间：2013-01-25T13:47:46.190
> 
> 标签：windows-8, settings, windows-store-apps

我们目前正计划开发一套 Windows 应用商店应用程序。它们是独立的并且完全单独工作，但它们是相关的并且协同行动。如果用户有几个，他们应该共享他们的一些设置（和数据），这样用户就不必手动更改每个设置中的这些设置。

这样的场景是故意的吗？

以及如何实施？

*   注册表：不起作用。应用程序无法访问注册表。
*   ApplicationData（LocalFolder、LocalSettings 等）：不起作用。应用程序无法访问其他应用程序的数据。
*   云服务：一种工作，但仅当机器在线时。我们的应用程序也应该离线工作。而且我们需要创建/租用这样的云服务，这会产生额外的成本。
*   KnownFolder.DocumentsLibrary：这 - 目前 - 对我来说似乎是唯一的解决方案。这些应用程序已经在那里保存和共享数据，所以让我们也将我们的设置保存在那里。但是共享文件夹的名称是设置之一！并且 Windows Store Apps 无法创建隐藏文件，因此用户可以看到设置文件。这使得这个解决方案有点……“粗糙”。

我错过了任何其他想法或其他信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:51:47.340

如果您希望它们立即相互同步，即使设备处于离线状态，那也是您唯一的选择。Windows 8 应用程序不打算共享设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T21:25:41.453

太想分享了。

1.  Roaming API 只会与相同的应用程序、相同的用户、任何 W8 设备共享。
2.  SkyDrive 将仅在任何应用程序、同一用户、任何设备之间共享。
3.  使用 Azure（或任何 Web 服务）将在任何应用程序、任何用户、任何设备之间共享。

不要这样做

1.  不要使用寄存器，不支持API
2.  不要使用文件系统，边界会导致你的应用程序很脆弱
3.  不要使用 ApplicationData.AnyFolder，这仅限于单个应用 GUID

你还不如从你的语言中得到“即时”，伙计。那只是不会发生。但是你可以快速（让我们称之为近乎瞬间）；您可以使用 Sockets 或 SignalR 将您的客户端连接到那里的某些服务，几乎可以立即响应。一种不太复杂的方法是也从您的客户那里进行轮询。它已经为开发人员服务了几十年。

# c - C将文件指针传递给函数

> ID：14523048
> 
> 赞同：-4
> 
> 时间：2013-01-25T13:47:55.967
> 
> 标签：c, file, function, pointers

我在传递文件指针时遇到问题。如果函数中有一个带有文件指针的函数（我的代码中的 void writequest），我该如何传递它？在我输入 void writequest 之前它正在工作。该程序本身应该从一个充满电影名称的文件中读取，然后将它们放入另一个文件中。当然，请随时注意我的代码中的任何其他故障。

```
void writequest(int no)
{
    int i, j, loop_ctrl, destination;
    int movement;
    char lib[loop_ctrl+1][92];
    int write_nr[loop_ctrl], sorting[destination];
    char searching[92];
    char *c;
    FILE *watched;
    FILE *temp;
    FILE *refrom;
    FILE *reto;
    FILE *towatch;
    if(no==1)
    {
        printf("No match found.\n");
    }
    else if(no==0)
    {
        printf("Do you wish you write them into a file?\n1 - Yes\n0 - No\n");
        scanf("%d", &j);
        if(j==1)
        {
            tofile(watched, temp, refrom, reto, destination, loop_ctrl, write_nr, lib, movement);
            close(towatch, watched, temp, refrom, reto);
            remove("To_watch.txt");
            rename("temp.txt", "To_watch.txt");
        }
        else if(j==0)
        {
            printf("Alright then\n");
            close(towatch, watched, temp, refrom, reto);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:41:38.923

```
 char *c;
    FILE *watched;
    FILE *temp;
    FILE *refrom;
    FILE *reto;
    FILE *towatch; 
```

这些都是指针。因此，如果您在函数中调用它们，您就会要求它们内部的值。那是他们的地址。除了运动。有什么奇怪的。

在任何人说出问题所在之前，了解确切的功能是至关重要的。

# jquery - jQuery：.gif 动画不起作用

> ID：14523049
> 
> 赞同：1
> 
> 时间：2013-01-25T13:47:58.223
> 
> 标签：jquery, animation, gif, progress

在我的项目中，我想显示 .gif 动画（需要显示旋转轮，表示正在下载数据），直到数据从服务器获取，单击“显示产品详细信息”后。

为此，我采用了两种方法：

第一种方法是使用 Ajax（在第一种方法中，数据在获得响应后附加到页面），第二种方法是没有 Ajax（页面被刷新）。

根据要求，我需要在第二种方法中实现功能。但是在第二种方法中，动画不起作用（轮子不旋转）。似乎浏览器正忙于等待响应。下面我给出了这两种方法的 jQuery 代码。任何人都可以建议如何使用第二种方法。提前致谢。

第一种方法：

```
function DisplayProductDetails () {
    $(‘ a#getProdutDetails).click(function (e) {         
        $.get($(this).attr('href'), function (response) {
            $("div.loadingIndicator").show();
            if (response.length > 0) {
                $('body').append(response);
            }
        });
        e.preventDefault();
        return false;
    });
} 
```

第二种方法：

```
function DisplayProductDetails () {
    $(‘ a#getProdutDetails').click(function (e) {     
        $("div.loadingIndicator").show();
        var link = $(this).attr('href');
        window.document.location = link;
        e.preventDefault();
        return false;
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T21:27:24.193

我想我理解你为什么要这样做，这是我能想到的最好的事情：

```
<div>
    <a href='http://api.jquery.com/jQuery.get/' id='theLink'>Click here to redirect</a>
    <img style='display:none;' id='Loading' alt='Loading...' src='http://oilandgas.rockwellautomation.com/images/loading.gif'>
</div>

$(function(){
    $('#theLink').click(function(e){
        $(document).queue('LoadPage',function(next){
            $('#Loading').fadeIn('slow',function(){
                setTimeout(function(){next();},1000);
            });
        });

        $(document).queue('LoadPage',function(next){
            var link = $(this).attr('href');
            window.document.location = link;        
        });

        $(document).dequeue('LoadPage');
        e.preventDefault();
        return false;
    });
}); 
```

它的作用是强制在链接之前显示加载图像。如果您的浏览器在开始导航时没有立即清除页面，那么用户将在浏览器获取链接资源时看到加载 gif。

根据我自己的观察，似乎大多数浏览器在收到您尝试检索的资源的响应之前不会清除当前页面。在这种情况下，用户将看到图像，直到页面被清除。

[这是我在上面展示的解决方案的一个小提琴。](http://jsfiddle.net/4wdgm/3/)如果您的连接速度较慢，您可能会看到我在说什么，否则它会重定向得比显示图像的速度更快。

通过使用淡入延迟图像显示，然后使用队列在代码中分离这些动作，即使连接速度很快，您也有机会看到图像。如果您想确保在页面重定向之前看到图像，您可以随时在其中添加延迟，如下所示：

```
 $(document).queue('LoadPage',function(next){
    $('#Loading').fadeIn(1000).delay(1000).show(function(){
        next();
    });
 }); 
```

[这是该方法的示例](http://jsfiddle.net/uumPd/4/)

# grails - 将 groovy 应用程序连接到 SQL Server Express

> ID：14523050
> 
> 赞同：2
> 
> 时间：2013-01-25T13:47:59.850
> 
> 标签：grails, jdbc, datasource, sql-server-express

我正在按照下面的教程进行操作，但必须有一些重要的步骤来假设我没有的知识。

[http://padcom13.blogspot.co.uk/2011/01/setting-up-sql-server-2008-express-to.html](http://padcom13.blogspot.co.uk/2011/01/setting-up-sql-server-2008-express-to.html)

以下是我的 datasource.groovy 中的设置

```
username = "sa"
password = ""
url = "jdbc:sqlserver://localhost:1433;databaseName=Sandpit"
driverClassName = "com.microsoft.sqlserver.jdbc.SQLServerDriver"
dialect = "org.hibernate.dialect.SQLServerDialect" 
```

以下是运行应用命令时弹出的错误

```
ERROR context.GrailsContextLoader  - Error executing bootstraps: 
Error creating bean with name 'transactionManagerPostProcessor': 
Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'transactionManager': 
Cannot resolve reference to bean 'sessionFactory' while setting bean property 'sessionFactory'; 
nested exception is org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'sessionFactory': 
Cannot resolve reference to bean 'lobHandlerDetector' while setting bean property 'lobHandler'; 
nested exception is org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'lobHandlerDetector': Invocation of init method failed; 
nested exception is org.springframework.jdbc.support.MetaDataAccessException: 
Error while extracting DatabaseMetaData; nested exception is org.apache.commons.dbcp.SQLNestedException: 
Cannot load JDBC driver class 'com.microsoft.sqlserver.jdbc.SQLServerDriver'
Message: Error creating bean with name 'transactionManagerPostProcessor': 
Initialization of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'transactionManager': Cannot resolve reference to bean 'sessionFactory' 
while setting bean property 'sessionFactory'; nested exception is 
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory': 
Cannot resolve reference to bean 'lobHandlerDetector' while setting bean property 'lobHandler'; 
nested exception is org.springframework.beans.factory.BeanCreationException: 
Error creating bean with name 'lobHandlerDetector': 
Invocation of init method failed; nested exception is 
org.springframework.jdbc.support.MetaDataAccessException: 
Error while extracting DatabaseMetaData; nested exception is 
org.apache.commons.dbcp.SQLNestedException: 
Cannot load JDBC driver class 'com.microsoft.sqlserver.jdbc.SQLServerDriver' 
```

这几天一直在做这件事而没有看到我的应用程序运行......有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:51:44.347

根本原因是`Cannot load JDBC driver class 'com.microsoft.sqlserver.jdbc.SQLServerDriver'`

那是因为类路径中缺少您的驱动程序。对于 SQL Server，您需要将 jar 复制到 lib 文件夹。

在其他情况下，如 MySQL，您可以声明为 maven 依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:10:12.383

我们正在做和你一样的事情。因此，我们的 /lib 目录中有 sqljdbc.jar。

在我们的 DataSource.groovy 中，我们有：

```
dbCreate = "update" // one of 'create', 'create-drop','update'
username = "dbo"
driverClassName = "com.microsoft.sqlserver.jdbc.SQLServerDriver"
url = "jdbc:sqlserver://devdb02:1433;databaseName=my_database;" 
```

I remember that just the .jar is not enough, I think you need to install a small part into your windows/unix-directory e.g. from here:

[http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=11774](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=11774)

(that's also needed if you maybe use PHP with MSSQL)

# php - 将“添加到购物车”按钮更改为“选择时预订”

> ID：14523059
> 
> 赞同：0
> 
> 时间：2013-01-25T13:48:38.727
> 
> 标签：php, magento

如果在可配置的选定产品上选择了一个选项，我很难为 magento 使用 php 和 jquery 将按钮从添加到购物车更改为预购。

检查可配置的简单子产品之一是否选择了该选项的 php。

```
<?php
$conf = Mage::getModel('catalog/product_type_configurable')->setProduct($_product);
$col = $conf->getUsedProductCollection()->addAttributeToSelect('*')->addFilterByRequiredOptions();

$productMap = array();
foreach($col as $simpleProduct){
    $productMap[$simpleProduct->getId()] = $simpleProduct->getAttributeText('preorder');
    //$test = $simpleProduct->getId() && $simpleProduct->getAttributeText('preorder');
}
?> 
```

回声结果：预购

如果所选产品有选项，则 Jquery 更改按钮。

```
<?php if($productMap) { ?>
<script type="text/javascript">
    jQuery(document).ready(function() {

        // On document ready hide the button to preorder first
        jQuery("#addtopreorder").hide();
        jQuery("#addtocart").show();
        jQuery("#<?=$productMap ?>").change(function() { 
            // Hide the button to preorder on slect element change action
            jQuery("#addtopreorder").hide();

            // Get the value of selected option
            var optionValue = jQuery(this).attr('value');
            // Just a test to see if you're getting option value
            //alert(optionValue);
            // Get the content (aka inner HTML) of selected option
            var optionValueText = jQuery.trim(jQuery('#<?=$productMap ?> :selected').text());

            // Just a test to see if you're getting right selected option inner text
            // alert(optionValueText);
            // alert('Selected option has value: ' + optionValue + ' and inner text: ' + optionValueText);

            // Show the button based on selected value
            // Whatch out, case sensitive...
            if( ! optionValue ){ 
                jQuery("#addtocart").show();
            } else {
                jQuery("#addtopreorder").show();
            }
        });
    });
</script> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T00:30:45.560

SCP 简单可配置产品解决的问题。由有机互联网制作。

[链接到扩展](http://www.magentocommerce.com/magento-connect/simple-configurable-products.html)

# android - Close() 从未在数据库上显式调用

> ID：14523060
> 
> 赞同：0
> 
> 时间：2013-01-25T13:48:42.440
> 
> 标签：android, sqlite

我有一个 SQLite 数据库，用于存储我的 Google 地图的坐标。它工作正常，但在我的 logcat 中我收到此错误：

```
01-25 14:36:24.338: E/SQLiteDatabase(12337): close() was never explicitly called on database '/data/data/com.example.androidbasic12/databases/android_api' 
01-25 14:36:24.338: E/SQLiteDatabase(12337): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:2072)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1126)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:1083)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:1170)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:844)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:228)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:157)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at   android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:231)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at com.example.androidbasic12.library.DatabaseHandler.getLatLng(DatabaseHandler.java:153)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at com.example.androidbasic12.library.UserFunctions.getCoords(UserFunctions.java:124)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at com.example.androidbasic12.map.onCreate(map.java:61)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.Activity.performCreate(Activity.java:4470)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.os.Looper.loop(Looper.java:137)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at android.app.ActivityThread.main(ActivityThread.java:4511)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at java.lang.reflect.Method.invokeNative(Native Method)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at java.lang.reflect.Method.invoke(Method.java:511)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
01-25 14:36:24.338: E/SQLiteDatabase(12337):    at dalvik.system.NativeStart.main(Native Method)
01-25 14:36:24.338: E/System(12337): Uncaught exception thrown by finalizer
01-25 14:36:24.343: E/System(12337): java.lang.IllegalStateException: Don't have database lock!
01-25 14:36:24.343: E/System(12337):    at android.database.sqlite.SQLiteDatabase.verifyLockOwner(SQLiteDatabase.java:2230)
01-25 14:36:24.343: E/System(12337):    at android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2322)
01-25 14:36:24.343: E/System(12337):    at android.database.sqlite.SQLiteDatabase$1.entryRemoved(SQLiteDatabase.java:2318)
01-25 14:36:24.343: E/System(12337):    at android.util.LruCache.trimToSize(LruCache.java:197)
01-25 14:36:24.343: E/System(12337):    at android.util.LruCache.evictAll(LruCache.java:285)
01-25 14:36:24.343: E/System(12337):    at android.database.sqlite.SQLiteDatabase.deallocCachedSqlStatements(SQLiteDatabase.java:2283)
01-25 14:36:24.343: E/System(12337):    at android.database.sqlite.SQLiteDatabase.closeClosable(SQLiteDatabase.java:1255)
01-25 14:36:24.343: E/System(12337):    at android.database.sqlite.SQLiteDatabase.finalize(SQLiteDatabase.java:2043)
01-25 14:36:24.343: E/System(12337):    at java.lang.Daemons$FinalizerDaemon.doFinalize(Daemons.java:185)
01-25 14:36:24.343: E/System(12337):    at java.lang.Daemons$FinalizerDaemon.run(Daemons.java:168)
01-25 14:36:24.343: E/System(12337):    at java.lang.Thread.run(Thread.java:856) 
```

我知道在某个地方我在使用它后没有关闭我的数据库连接，问题是错误指向的地方似乎我确实关闭了它。

*userFunctions.class*

```
 public String getUsername(Context context, String uname) {
    DatabaseHandler db = new DatabaseHandler(context);
    Cursor cursor = db.getUsername();
    cursor.moveToFirst();
    if (cursor != null){
        uname = cursor.getString(cursor.getColumnIndex("name"));
    }
    cursor.close();     
    db.close();
    return uname;

    }

    /**
 * Get lat and lng from TABLE_CARCOORDS
 */
public ArrayList<String> getCoords(Context context, String lat, String lng) {
    DatabaseHandler db = new DatabaseHandler(context);
    Cursor cursor = db.getLatLng();

    if (cursor != null && cursor.moveToFirst()){
        ArrayList<String> cordarr = new ArrayList<String>();
        lat = cursor.getString(cursor.getColumnIndex("lat"));
        lng = cursor.getString(cursor.getColumnIndex("lng"));
        cordarr.add(lat);
        cordarr.add(lng);
        return cordarr; 

    }
cursor.close();
db.close();
return null;
} 
```

*数据库处理程序类*

```
 public Cursor getUsername(){
    SQLiteDatabase db = this.getReadableDatabase();
    String query = ("SELECT * FROM " + TABLE_LOGIN + " WHERE name = " + KEY_NAME);
    Cursor cursor = db.rawQuery(query, null);
    return cursor;
}

public Cursor getLatLng(){
    SQLiteDatabase db = this.getReadableDatabase();
    String query = ("SELECT * FROM " + TABLE_CARCOORD + " WHERE name = " + CAR_KEY_NAME);
    Cursor cursor = db.rawQuery(query, null);
    return cursor;

} 
```

*最后，map.class*

```
public class map extends FragmentActivity{
private static LatLng SYDNEY = new LatLng(-33.88,151.21);
public static  LatLng sala = new LatLng(59.91602, 16.594108);
int travel = 0;
int MapTypeInt = 0;
private GoogleMap mMap;
GoogleMapOptions options = new GoogleMapOptions();
String username;

String Lat1;
String Lng1;
Double lat;
Double lng;
ProgressDialog dialog;

// JSON response node names
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_NAME = "name";
private static String KEY_LAT = "lat";
private static String KEY_LNG = "lng";

String errorhandler = "";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.maps);
    new getCord().execute();
    setUpMapIfNeeded();
    UserFunctions userFunc = new UserFunctions();
    ArrayList<String> cordarr = new ArrayList<String>();
    cordarr = userFunc.getCoords(getApplicationContext(), Lat1, Lng1);
    if(cordarr != null && cordarr.size()> 1 ){
        Log.d("LOG", "I got lat long");
        Lat1 = cordarr.get(0);
        Lng1 = cordarr.get(1);
        lat = goDouble(Lat1);
        lng  = goDouble(Lng1);
        LatLng sala = new LatLng(lat, lng);
        mMap.addMarker(new MarkerOptions().position(sala).title("Coords: " 
        + lat + ", "
        + lng));

    } else {
        Log.d("LOG", "no lat long found");
    }

    //Button that sends the user to Sala by default, and to Sydney if Sala
    Button btnSyd =  (Button) findViewById(R.id.btnSyd);
    btnSyd.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stu

            if (travel == 0){
                travelToSala();
                travel = 1;
            } else if (travel == 1) {
                travelToSydney();
                travel = 0;
            }
        }
    });
    //Button for setting map type to satellite if normal, to normal if satellite
    final ImageButton changeBtn =(ImageButton) findViewById(R.id.changeBtn);
    changeBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            changeMapType(changeBtn);
        }
    });     
}
//method that changes maptype
private void changeMapType(ImageButton button){
    if(MapTypeInt == 0){
        mMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
        button.setImageResource(R.drawable.normal_map);
        MapTypeInt = 1;
    } else if (MapTypeInt == 1) {
        mMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
        button.setImageResource(R.drawable.satellite);
        MapTypeInt = 0;
    }
}
//Function that travels user to Sydney
private void travelToSydney(){
    mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(SYDNEY, 15));
    Button btnSyd = (Button) findViewById(R.id.btnSyd);
    btnSyd.setText("travel to Sala");
}
//Function that travels user to Sala
private void travelToSala(){
    mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(sala, 15));
    Button btnSyd = (Button) findViewById(R.id.btnSyd);
    btnSyd.setText("travel to Sydney!");
}
//Checks if map is setup, and if it isn't, set's up the map
private void setUpMapIfNeeded() {
    if (mMap == null) {
        mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map)).getMap();
        mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(sala, 15));
        options.mapType(GoogleMap.MAP_TYPE_NORMAL)
        .compassEnabled(true)
        .rotateGesturesEnabled(true)
        .tiltGesturesEnabled(true);
        if(mMap != null){
            //The map is veriefied
        }
    } 

}
//method input string, output double
public Double goDouble(String Latlng) {
    Double goDouble = Double.parseDouble(Latlng);
    return goDouble;
}

class getCord extends AsyncTask<String, String, String>{

    @Override
    protected String doInBackground(String... params) {
        // TODO Auto-generated method stub
        UserFunctions userFunction = new UserFunctions();
        username = userFunction.getUsername(getApplicationContext(), "uname"); 
        JSONObject json = userFunction.getCarcoord(username);

        try {
            if (json.getString(KEY_SUCCESS) != null){
                String res = json.getString(KEY_SUCCESS);
                if (Integer.parseInt(res)==1){
                    //Successfully found users car coordinates
                    DatabaseHandler db = new DatabaseHandler(getApplicationContext());
                    JSONObject json_coord = json.getJSONObject("user");

                    //clear previous entries in table "TABLE_COORD"
                    userFunction.resetCarcoord(getApplicationContext());
                    db.addCoord(json_coord.getString(KEY_NAME), json_coord.getString(KEY_LAT), json_coord.getString(KEY_LNG));
                    errorhandler = "2";

                }
            } else if(json.getString(KEY_ERROR) != null) {
                String res = json.getString(KEY_ERROR);
                if(Integer.parseInt(res) == 1){
                    //Some error in getting registration, should not happen though
                    errorhandler = "1";
                }

            }

        }catch (JSONException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPreExecute() {
        // TODO Auto-generated method stub
        dialog = ProgressDialog.show(map.this,
                   "Loading car coordinats", "Please wait ...", true, true);
        super.onPreExecute();       
    }

    @Override
    protected void onPostExecute(String result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);
        if(errorhandler == "1"){
            Toast toast = Toast.makeText(getApplicationContext(),
                    "User has not got car", Toast.LENGTH_LONG);
            toast.show();
            errorhandler = "";
        } else if (errorhandler == "2" ) {
            // Error in login
            Toast toast = Toast.makeText(getApplicationContext(),
                    "Successfully got coords for car", Toast.LENGTH_LONG);
            toast.show();
            errorhandler = "";
        }
        dialog.cancel();
    }
} 
```

}

抱歉，如果有很多不相关的代码！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:22:03.893

您必须关闭每个 DatabaseHelper （`DatabaseHandler`在您的情况下）实例。

避免这种情况的最好方法是对整个应用程序仅使用一个 DatabaseHandler。

这是它的相关代码，以实现上述目标：

```
public static DatabaseHandler sInstance;

    public static synchronized DatabaseHandler getHandler(Context context) {
        if (sInstance == null) {
            sInstance = new DatabaseHandler(context);
        }
        return sInstance;
    } 
```

# php - 使用 jQuery 选中表格中的所有复选框

> ID：14523062
> 
> 赞同：2
> 
> 时间：2013-01-25T13:48:46.223
> 
> 标签：php, jquery, checkbox, html-table

我在表格中使用复选框，并且在表头中有一个复选框。

我想要完成的是，当我单击头部中的复选框时，应该检查表格行中下面的所有复选框。

这是我的 HTML：

```
 <form action="<?php $_PHP_SELF ?>" method="post">
        <div class="content top">
          <table id="datatable_example" class="responsive table table-striped table-bordered" style="width:100%;margin-bottom:0; ">
            <thead>
              <tr>
                <th style="width:0px; padding-right:0px;" class="no_sort"> <label class="checkbox ">
                    <input type="checkbox" id="checkAll" name="checkAll" class="select_all">
                  </label>
                </th>
                <th style="width:200px;" class="no_sort"> Institue </th>
                <th style="width:150px;" class="no_sort"> Education </th>
                <th style="width:300px;" class="no_sort"> Description </th>
                <th style="width:150px;" class="ue no_sort"> Started </th>
                <th style="width:150px;" class="ue no_sort"> Completion </th>
                <th class="ms no_sort "> Actions </th>
              </tr>
            </thead>
            <tbody>
              <?php echo $educations ?>
            </tbody>
          </table>
          <div class="row-fluid control-group">
            <div class="pull-left span6 " action="#">
              <div>

                <div class="controls inline input-large pull-left">                    
                  <select name="bulkaction" data-placeholder="Bulk actions: " class="chzn-select " id="default-select">
                    <option value=""></option>
                    <option value="delete">Delete</option>
                  </select>
                </div>
                <button type="submit" name="submitbulkaction" class="btn btn-inverse inline">Apply</button></form> 
```

这是表格中使用的 php 变量 $education..

```
$educations .= "<tr>
                <td><label class=\"checkbox\">
                    <input type=\"checkbox\" class=\"chkboxes\" name=\"ids[]\" value=\"$education_id\">
                  </label></td>
                <td class=\"to_hide_phone\"> $institue_name</td>
                <td class=\"to_hide_phone\"> $education_name</td>
                    <td>$education_desc</td>
                <td>$education_started</td>
                <td>$education_ended</td>
                <td class=\"ms\">
                <div class=\"btn-group1\"> 
                <a href=\"education-edit.php?id=$education_id\" class=\"btn btn-small\" rel=\"tooltip\" data-placement=\"left\" data-original-title=\" edit \">
                <i class=\"gicon-edit\"></i></a> 
                <a class=\"btn btn-small\" rel=\"tooltip\" data-placement=\"top\" data-original-title=\"View\">
                <i class=\"gicon-eye-open\"></i>
                </a> 
                <a class=\"btn  btn-small\" rel=\"tooltip\" data-placement=\"bottom\" data-original-title=\"Remove\"><i class=\"gicon-remove \"></i></a> 
                </div>
                </td>
              </tr>"; 
```

我试图设置的 Jquery 背后的..

```
 <script type="text/javascript">
$(document).ready(function(){
    $('#checkAll').click(function () {
        $('.chkboxes').attr('checked','checked');
    });
});
    </script> 
```

请告诉我我在这里做错了什么，以及如何解决这个问题？

我也查看了关于相同问题复选框的其他问题，其中大多数问题都得到了解决，但是当我应用相同的代码时仍然没有得到我想要的结果。

* * *

更新：正如你们所说，我修复了类名错误，谢谢，但现在出现了一些奇怪的问题。我的意思是现在它可以工作，但它不像我点击复选框并且所有复选框都在旅途中被选中一样工作。我必须刷新页面然后所有复选框都会被选中？那个问题是怎么回事？为什么我需要刷新页面才能发生该事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:51:53.517

```
$(document).ready(function(){
    $('#checkAll').click(function () {
        $('#datatable_example .chkboxes').prop('checked', true);
        // $('#datatable_example input[type=checkbox]').prop('checked', true);
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T13:52:25.180

您正在尝试检查一个名为复选框的类，而不是实际的复选框。通过其类型属性识别复选框 -

```
$(document).ready(function(){
    $('#checkAll').click(function () {
        $('#datatable_example input[type="checkbox"]').prop('checked',true);
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T13:54:03.867

你上课为`class=\"chkboxes\"`

在你给出的 jquery 中

```
 $('.checkboxes').attr('checked','checked'); 
```

纠正它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-03T10:54:12.520

对于多个表使用这个

$('th input:checkbox').click(function(e) {

var table = $(e.target).closest('table'); $('td input:checkbox', table).attr('checked', e.target.checked);

});

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T13:51:26.937

```
$('.chkboxes').attr('checked','checked'); 
```

班级不一样。

还可以考虑使用[heredocs](http://php.net/manual/en/language.types.string.php)或结束 PHP`?>`并在您的 HTML 内容之后重新开始，`<?php`然后再关闭块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T13:57:56.670

另一个例子：

```
<script type="text/javascript">
$(document).ready(function(){
  $('#checkAll').click(function () {
    $(this).parents('fieldset:eq(0)').find(':checkbox').attr('checked', this.checked);
  });
});
</script> 
```

您只需要在`fieldset`after`<form>`和 close before中添加标签`</form>`，但只会选中字段集标签之间的复选框。

[http://briancray.com/posts/check-all-jquery-javascript](http://briancray.com/posts/check-all-jquery-javascript)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-05T16:32:04.377

做它的简单方法...

`$("#buttonSelectAll").click(function () { if($("#Table").find('input:checkbox:first').attr("checked")==="checked") $('#Table input:checkbox').prop('checked', false); else $('#Table input:checkbox').prop('checked', true); });`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-21T16:04:17.140

```
$(document).ready(function(){
    $('#checkAll').click(function () {
        $('#datatable_example').find('.chkboxes').prop('checked', true);
        });
}); 
```

# php - 活动 div 的可能代码

> ID：14523063
> 
> 赞同：0
> 
> 时间：2013-01-25T13:48:46.723
> 
> 标签：php, css, function

在`logged.php`：

```
$TPL->NavBar('active',' '); 
```

在`class.template.php`：

```
public function NavBar($home,$about) {
    $this->Content('navigator_bar');            
} 
```

在`navigator_bar.php`：

```
<li class= <?php $home ?> ><a href="home">Home</a></li>
<li class= <?php $about ?> ><a href="about">About</a></li> 
```

是否可以将变量链接到一个新`$home`的?`$about``file.php`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:50:16.527

使用 $_GET、$_POST、$_REQUEST 等请求方法[将](http://php.net/manual/en/reserved.variables.request.php)数据发送到您的 new_file.php

或者

在会话中设置变量以在 new_file.php 中获取它

**会议中：**

> 在 Logged.php 中：

```
echo $_SESSION['home_val'] = $home;
echo $_SESSION['about']    = $about; 
```

> 在 new_file.php 中：

```
$_SESSION['home_val'];//gives $home

$_SESSION['about'];//gives $about 
```

# android - 安卓网页浏览。在没有滚动条的情况下在屏幕上调整 HTML

> ID：14523067
> 
> 赞同：2
> 
> 时间：2013-01-25T13:49:02.917
> 
> 标签：android, webview, android-webview

我试图在 Android 上学习网络视图。我有几个问题。

1.  我有一个 PHP 页面，它有 2-3 个小段落和一个随机生成的图像。如何确保整个 HTML 页面完全适合移动设备的屏幕（因此看不到滚动条）？如果在某些情况下不可能使图像更小以使其完美适合每台设备？.

2.  第二个问题是假设我在那个 HTML 页面上有一个链接。我希望当我单击此链接（属于不同域）时，它会在默认浏览器中打开，而不是在 android 应用程序中打开。（如何才能做到这一点）。

    包 com.example.try2;

    ```
    import android.os.Bundle;
    import android.app.Activity;
    import android.view.Menu;
    import android.view.Window;
    import android.view.WindowManager;
    import android.webkit.WebSettings;
    import android.webkit.WebView;

    public class MainActivity extends Activity {

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            //Full screen
            requestWindowFeature(Window.FEATURE_NO_TITLE); 
            this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN); 

            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);

            WebView myWebView = (WebView) findViewById(R.id.webview);
            myWebView.setVerticalScrollBarEnabled(false);
            myWebView.setHorizontalScrollBarEnabled(false);
            myWebView.getSettings().setLoadWithOverviewMode(true); 
            myWebView.getSettings().setUseWideViewPort(true);
            WebSettings webSettings = myWebView.getSettings();
            webSettings.setJavaScriptEnabled(true);
            myWebView.loadUrl("http://www.example.com/mobile/index.php");

        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // Inflate the menu; this adds items to the action bar if it is present.
            getMenuInflater().inflate(R.menu.activity_main, menu);
            return true;
        }

    } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:12:04.337

要回答您的问题：

1.  您实际上可能必须在 HTML / JS 代码中执行此操作。挂钩调整大小事件并根据该设备上可用的像素数设置图片大小。这是 jQuery 中的一个示例，其中 myImage 是图像的 id，myText 是页面顶部包含文本的 div 的 id：

    ```
    $(window).resize(function() {

        // Compute available height for image
        // by subtracting text div height from screen height
        var availableImageWidth = screen.width;
        var availableImageHeight = screen.height - $('myText').height();

        // Get image width and height
        var imageWidth = $("#myImage").width();
        var imageHeight = $("#myImage").height();

        // Compute scale that maintains aspect ratio and fits image within screen bounds
        var scale = Math.min( availableImageWidth / imageWidth, availableImageHeight / imageHeight);

        // Set new image dimensions
        $("#myImage").width(imageWidth * scale);
        $("#myImage").height(imageHeight * scale);
    } 
    ```

2.  您可以通过覆盖类的`shouldOverrideUrlLoading`方法来做到这一点`WebViewClient`：

    ```
    myWebView.setWebViewClient(new WebViewClient()
    {
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {           
            // Redirect HTTP and HTTPS urls to the external browser
            if (url != null && URLUtil.isHttpUrl(url) || URLUtil.isHttpsUrl(url))
            {
                view.getContext().startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(url)));
                return true;
            }

            return false;
         }
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:31:54.537

要使图像适合屏幕，只需检查窗口的宽度并将其与网页上 javascript 中的图像宽度进行比较。如果图像的宽度大于屏幕的宽度，则将图像的宽度设置为窗口的宽度。

查看 jQuery 的[.width()](http://api.jquery.com/width/)函数。您可以使用`$(window).width()`和`$('#myimageid").width()`。

至于在 WebView 中打开链接，默认行为是使用用户的默认浏览器（不是您的 WebView）打开它。如果要覆盖此行为，请查看[WebViewClient#shouldOverrideUrl(WebView view, String url)](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldOverrideUrlLoading%28android.webkit.WebView,%20java.lang.String%29)

# asp.net - 在带有母版页的 ASP Web 应用程序中使用引导导航栏的最佳方法

> ID：14523068
> 
> 赞同：0
> 
> 时间：2013-01-25T13:49:07.220
> 
> 标签：asp.net, twitter-bootstrap

我有一个使用 Bootstrap 的 ASP Web 应用程序。我想使用我的母版页中的导航栏组件来导航我的选择：

```
<div class="navbar">
<div class="navbar-inner">
<a class="brand" href="#">Title</a>
<ul class="nav">
  <li class="active"><a href="#">Home</a></li>
  <li><a href="#">Link</a></li>
  <li><a href="#">Link</a></li>
</ul>
</div>
</div> 
```

我显然希望在我的 Web 应用程序中获得最佳性能，并且不希望我的所有代码都放在一个页面上，因为它主要是一个数据驱动的应用程序，加载起来可能很乏味，我希望将页面刷新和请求保持在最低限度。我会使用 iFrame、容器或任何类似的基于 Web 的技术来浏览我的 Web 应用程序以实现最佳性能吗？我所服务的客户不会拥有最好的网络连接，但可以这么说，他们仍然需要物超所值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:01:10.123

您可能想要做的是创建一个 sql 表，您将使用该表将 HTML 注入您的页面。因此，基本上根据决定或选择，您可以相应地填充页面设计。

# jquery - Fullcalendar 如何显示不同的日期和时间

> ID：14523072
> 
> 赞同：0
> 
> 时间：2013-01-25T13:49:26.113
> 
> 标签：jquery, fullcalendar

我有一个包含值的表：天、开始、结束。例如周一 9:00-15:00，周五 12:00-16:00。然后我想渲染全日历议程周，只有几天和时间从数据库中获取（例如星期一，星期五）。我正在使用 Symfony2。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:58:49.240

我不确定我是否明白你想在这里做什么，你想要这样的东西：http: [//arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/)（点击“星期”按钮），但这只会显示其中有事件的日子? 所以你的周历会从星期一跳到星期五，然后是星期日等等？

# mschart - MSChart 执行鼠标左键单击时避免光标替换是否可能？

> ID：14523075
> 
> 赞同：0
> 
> 时间：2013-01-25T13:49:55.023
> 
> 标签：mschart

在 MSChart 上，当按住鼠标左键并拖动鼠标时，我可以从左到右拖动和移动 CursorX，当释放鼠标左键停止时，当发生鼠标拖动时停止移动 CursorX，这很好

但是 CursorX 可以放置在任何地方**也...** 只有在图表区域的某处单击释放鼠标左键，Cn 此功能被关闭或跳过 CursorX 替换首先没有发生 CursorX 的拖动

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T16:17:23.577

在特定情况下通过 IsUserEnabled 切换单击鼠标左键时，我实现了一些避免光标替换的方法

# c# - 相对 URI 不支持此操作，浏览 SVC-service 时出错

> ID：14523076
> 
> 赞同：8
> 
> 时间：2013-01-25T13:49:57.297
> 
> 标签：c#, wcf, web-services, svc

浏览到网站的 svc 服务时出现以下错误（在它所在的服务器上浏览它）。该网站使用 IIS7。

```
This operation is not supported for a relative URI.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.InvalidOperationException: This operation is not supported for a relative URI.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[InvalidOperationException: This operation is not supported for a relative URI.]
   System.Uri.get_Scheme() +8045854
   System.ServiceModel.HostingManager.FilterBaseAddressList(Uri[] baseAddresses, Uri[] prefixFilters) +142
   System.ServiceModel.HostingManager.CreateService(String normalizedVirtualPath) +598
   System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +50
   System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +1172

[ServiceActivationException: The service '/Templates/eDemokrati/Services/eDemokratiService.svc' cannot be activated due to an exception during compilation.  The exception message is: This operation is not supported for a relative URI..]
   System.Runtime.AsyncResult.End(IAsyncResult result) +900192
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +192830
   System.Web.AsyncEventExecutionStep.OnAsyncEventCompletion(IAsyncResult ar) +107

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

服务链接：[链接](http://www.roros.kommune.no/Templates/eDemokrati/Services/eDemokratiService.svc/)

网站的一些 web.config：

```
<system.serviceModel>
  <serviceHostingEnvironment>
        <baseAddressPrefixFilters>
            <add prefix="http://www.roros.kommune.no/"/>
            <add prefix="www.roros.kommune.no/"/>
            <add prefix="item"/>
            <add prefix="http://www.roros.kommune.no/templates/eDemokrati/Services/"/>
            <add prefix="www.roros.kommune.no/templates/eDemokrati/Services/"/>

        </baseAddressPrefixFilters>
    </serviceHostingEnvironment> 
```

错误是由什么引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:36:34.323

如异常消息所示，不允许使用相对 URI。尝试删除`prefix="item"`并将它们全部设为绝对 URI。

# c# - 在门户网站 asp.net mvc 3 中保存/显示 html 内容的安全方法

> ID：14523078
> 
> 赞同：1
> 
> 时间：2013-01-25T13:50:07.357
> 
> 标签：c#, asp.net, asp.net-mvc-3, xss

我正在制作一个门户网站，所以我想澄清一些事情。`Html`将内容保存在数据库中并将其显示给其他用户的最安全方式/方法是什么。我已经开始制作两个独立的应用程序，例如**CMS**和显示管理内容的门户网站。

我知道我必须以未编码的形式保存内容，但是是否有任何库可以检查或过滤允许的标签，因为我想尽可能避免`XSS`漏洞？`@Html.Raw()`另外，用于显示数据的缺点是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:09:01.460

是的，您可以使用 AntiXSS 库（可以在[此处](http://wpl.codeplex.com/)找到）。对我来说完美无缺。希望它会有所帮助。

# ruby-on-rails - 在 Rails 中模拟提交另一个表单

> ID：14523081
> 
> 赞同：0
> 
> 时间：2013-01-25T13:50:18.373
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1

我有一个带有这样的视图的 Rails 应用程序视图

```
 = form_tag movies_path, :method => :get, :id => "ratings_form" do
  Include:
  - @all_ratings.each do |rating|
    = rating
    = check_box_tag "ratings[#{rating}]", 1, @filter.include?(rating)
  = submit_tag 'Refresh', :id => "ratings_submit" 
```

后来在同一个视图中的链接

```
link_to "Movie Title", movies_path(:sort => :title) 
```

我想做的是当我点击链接时`Movie Title`，我是否也可以将参数添加`ratings_form`到 URL 中？所以我也可以访问控制器中的那些

例如。评分表提交 =`/movies?ratings[G]=1&commit=Refresh`
点击链接 =`/movies?sort=release_date`

当我点击链接时，我也希望`ratings[G]=1`（或任何选中的复选框）出现在 URL 中。

在rails中有什么优雅的方法可以做到这一点吗？

导轨版本：3.1.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:29:03.393

你可以这样做：

```
link_to "Movie Title", movies_path(:sort => :title), onclick: "submit_ratings_form($(this));"

# some jQuery to add the params to the form and submit it:
var submit_ratings_form = function(a_tag) {
  var params = a_tag.href.split('?')[1];
  var input = $("<input>").attr("type", "hidden").attr("name", params.split('=')[0]).val(params.split('=')[1]);
  $('#ratings_form').append($(input));
  $('#ratings_form').submit();
} 
```

此代码假定您在 link_to? 中只有一个参数？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:19:37.237

**备选方案 1：**

那么我相信你可以做这样的事情：

my_array = [1,2,3,4,5]

```
link_to "Movie Title", movies_path(:sort => :title, :ratings=> my_array) 
```

**备选方案 2：**

创建一个带有链接的表单，该链接通过 JS 在表单上调用提交。视图中的代码如下所示：

```
<% form_tag movies_path, :method => :get, :id => 'movie_'+arr.to_s do |f|%>    
        <%= hidden_field_tag('ratings[]', arr[0]) %>
        <%= hidden_field_tag('ratings[]', arr[1]) %>
        <%= hidden_field_tag('ratings[]', arr[2]) %>
        <%= link_to_function 'Movie Title', "document.getElementById('movie_"+arr.to_s+"').submit()"%>
      <%end%> 
```

**表单 id**用于标识在 JS 中调用哪个提交（因为可能存在任意数量的表单）。它可以是任何独特的形式。

# asp.net-mvc - 如何在 IIS 中的会话超时后重定向到子目录

> ID：14523082
> 
> 赞同：0
> 
> 时间：2013-01-25T13:50:19.267
> 
> 标签：asp.net-mvc, iis

我在单个 IIS 网站上运行了一些非常相似的 asp.net mvc 应用程序。这些应用程序中的每一个都有自己的子目录，即 www.contoso.com/app1、www.contoso.com/app2 等。

我面临的问题是，当用户会话超时时，它被重定向到 www.contoso.com 主地址，而不是 /app1 或 /app2 应用程序地址。

该问题的可能解决方案是什么？

# asp.net-ajax - Monodevelop 中的 Ajax 控件

> ID：14523083
> 
> 赞同：1
> 
> 时间：2013-01-25T13:50:18.957
> 
> 标签：asp.net-ajax, monodevelop, ajaxcontroltoolkit

我在 Linux (Ubuntu) 上使用 Monodevelop（版本 3.0.4.6），试图在我的 Web 应用程序中添加 Ajax 控制功能。在我的 Web 应用程序中，每件事都运行良好，但是当我尝试添加 ajax 控件时，Monodevelop 会出现一些错误，例如

“ System.TypeLoadException：无法从程序集 'AjaxControlToolkit' 加载类型 'System.Web.Script.AjaxFrameworkAssemblyAttribute'。”

有人可以在 Monodevelop.. 中使用 Ajax 控件吗？

请帮我 ！！！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:42:52.653

根据[单声道实现状态](http://go-mono.com/status/status.aspx?reference=4.0&profile=4.0&assembly=System.Web.Extensions)，AjaxFrameworkAssemblyAttribute 没有在单声道中实现，所以问题实际上不是 MonoDevelop，而是它不是在单声道中实现的事实。我假设您可以从 Microsoft .NET 实现中获取程序集并添加到您的项目中。

# machine-learning - 类别先验在 Weka 分类中的作用

> ID：14523095
> 
> 赞同：2
> 
> 时间：2013-01-25T13:50:56.273
> 
> 标签：machine-learning, classification, weka

我有一个训练数据集，由大约 1568 行组成，每行都有类属性的七个值之一。我正在寻求在 168 行的第二个数据集上测试这些数据。

但我有一个问题。Weka 报告说，“类先验”是：

```
141.0
169.0
225.0
197.0
421.0
281.0
141.0 
```

我的训练集每个类属性值的实例数如下：

```
140
168
224
196
420
280
140 
```

除了类先验与每个类属性值的训练集行数密切相关之外，谁能告诉我它们是什么以及它们实际代表什么？

测试集的每个类属性值的实例数如下：

```
15
18
24
21
45
30
15 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:02:01.207

类先验是对从总体中随机抽样一个实例将产生给定类的概率的估计（无论实例的任何属性如何）。Weka 假设您的训练数据是从总体中随机抽取的，因此您的训练集中的类比例表明它们在抽样总体中的相对丰度。请注意，Weka 报告的不是先验，而是用于计算先验的计数。将每个计数加 1 的原因是为了防止在训练数据中未表示特定类的情况下计数为零。所以 Weka 应该计算每个类的实际先验为

```
P(c_i) = n_i / (N + C) 
```

其中`n_i`是类的样本数`i`，`N`是样本总数，`C`是类数。

作为先验概率用于什么的一个非常简单的例子，考虑对疾病进行分类，只知道一个人发烧和头痛。这些症状是流感和埃博拉病毒的迹象。但患流感的人远多于埃博拉病毒（流感的先验概率远高于埃博拉病毒），因此根据这些症状，您可以将疾病归类为流感。

Weka 提供了更新或覆盖默认先验概率的方法。要了解如何在分类中使用先验概率的数学细节，请查看[贝叶斯定理](http://en.wikipedia.org/wiki/Bayes%27_theorem)。

# wpf - 如何将标记扩展方法应用于 XAML 中的绑定值？

> ID：14523096
> 
> 赞同：4
> 
> 时间：2013-01-25T13:50:57.980
> 
> 标签：wpf, xaml, binding, markup-extensions

我有一个字符串的本地化标记扩展方法，我可以通过这种方式应用它：

```
<TextBlock Text="{l:Translate 'My string'}" /> 
```

如何将此标记扩展方法应用于绑定结果？即类似的东西：

```
<TextBlock Text="{l:Translate '{Binding Path=myStringParameter}'}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T13:57:29.980

我相信你这样做是不可能的，但你可以重写它如下：

```
 <TextBlock>
     <TextBlock.Text>
        <l:Translate>
           <Binding Path="myStringParameter" />
        </l:Translate>
     </TextBlock.Text>
 </TextBlock> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:08:43.867

使用标记扩展只需执行以下操作：

```
{l:Translate {Binding Path=myStringParameter}} 
```

XAML 解析器将自行处理内部标记扩展。就像在经典的 WPF 中一样：`{StaticResource {x:Type Button}}`

# function - 变量名称作为另一个变量的值，ASP 经典

> ID：14523097
> 
> 赞同：0
> 
> 时间：2013-01-25T13:51:04.377
> 
> 标签：function, variables, asp-classic, return-value

我想创建一个将变量名称作为字符串的函数，检查是否存在查询字符串、request.form 或具有该名称的变量并返回值。

```
function revalue(varName)

   if request(varName) <> "" then
        revalue= request(varName)
    else        
        revalue= "" 
    end if

end function 
```

我如何检查称为值的变量是否`varName`存在并具有值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:24:39.257

...

```
else
   if eval(varName) <> "" then
     revalue= eval(varName)
   else
     revalue= ""    
   end if
end if 
```

# ssis - 向平面文件源添加额外的外部列

> ID：14523098
> 
> 赞同：1
> 
> 时间：2013-01-25T13:51:06.790
> 
> 标签：ssis

我有一个简单的 ssis 包 (2005)，它读取一个固定宽度的平面文件源并转储到一个表中。到目前为止，文件有 5 列，最后一列的长度为 50。现在格式改变了，在末尾添加了一个新列（长度 4），之前的 50 长度列现在只有 10 长度。

我想它应该很简单，只需在数据流下进入源的高级编辑器，在外部列下，修改 Column4（我的列名为 Column0 到 4）并将其长度更改为 10，然后“添加列”和名称它是 Column5 等。但是当我添加时，新列总是被添加到当前最后一列（Column4）之上。

如何在最后添加新列而不必重做整个列。

（注意：我过度简化了我的情况，我的列数真的很大，我不想重新做整个映射......请帮忙！）

# java - 删除具有关系的实体

> ID：14523101
> 
> 赞同：1
> 
> 时间：2013-01-25T13:51:17.537
> 
> 标签：java, hibernate, jpa

我有下一个实体。`Car`与 具有多对多关系`Human`。我在**Car**和**User**之间使用辅助类**Assign**

 ****```
@Entity
public class Car implements Serializable
{
   //...

   @LazyCollection(LazyCollectionOption.TRUE)
   @OneToMany(cascade = CascadeType.ALL, mappedBy = "car")
   private Set<Assign> cars = new HashSet<Assign>();
   //...
}  

@Entity
class Assign implements Serializable 
{
   //...

   @LazyCollection(LazyCollectionOption.FALSE)
   @ManyToOne
   @JoinColumn(name = "HUMAN_CAR", nullable = false)
   private Human human;

   @LazyCollection(LazyCollectionOption.FALSE)
   @ManyToOne
   @JoinColumn(name = "CAR_HUMAN", nullable = false)
   private Car car;
   //..

}  

@Entity
public class Human implements Serializable
{
    //...

   @LazyCollection(LazyCollectionOption.TRUE)
   @OneToMany(cascade = CascadeType.ALL, mappedBy = "human")
   private Set<Assign> cars = new HashSet<Assign>();  
   // ...  
} 
```

现在我尝试在容器管理事务中删除汽车

```
 public void deleteCar(final long id)
   {      
      final Car car = entityManager.find(roleId, Car.class);
      entityManager.remove(car);  
   } 
```

但我明白了

```
Caused by: javax.persistence.EntityNotFoundException: deleted entity passed to persist: [com.dto.Assign#<null>] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:17:16.450

`Assign`在删除之前删除-s`Car`

```
public void deleteCar(final long id)
{      
  final Car car = entityManager.find(roleId, Car.class);
  for(Assign assign : car.getAssigns()) {
     entityManager.remove(assign);
  }
  entityManager.remove(car);  
} 
```

您的吸气剂可能有不同的名称，我看不到该代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:09:23.043

在删除之前`car`，您需要先从 中`car`删除`Assign`。

这里还有另一个设计问题。您拥有实体`CascadeType.ALL`，这意味着 Car 及其分配具有组合关系（不仅仅是聚合/关联关系）。另一方面，Human 与其指定对象之间也存在相同的关系。显然分配可以在汽车和人之间共享，但组合关系遵循非共享语义。假设一个人删除了一辆汽车并级联删除了它的分配，那些在侧共享的将成为孤儿。`cars``Car``cars``person`****

# android - 如何更改操作栏背景的显示方式？

> ID：14523109
> 
> 赞同：2
> 
> 时间：2013-01-25T13:51:32.543
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在使用 ActionBar Sherlock，我想更改 ActionBar 背景。我可以通过修改我的样式 XML 文件来实现这一点：

```
<item name="android:background">@drawable/background_bitmap</item> 
```

问题是，无论设备或位置（横向/水平）如何，操作栏背景图形总是被拉伸，如下所示：

人像模式：

![人像模式](../Images/7a6549d00f8e33fd32d82a9fff62ec6e.png)

横向模式：

![横向模式](../Images/e81a11883062c1382309234c235abca3.png)

**有没有办法改变 background_bitmap 的显示方式？**

我宁愿背景与左/右对齐或缩放和裁剪。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T14:02:20.487

是的，创建一个像这样的drawable xml`/res/drawable/`并将其引用为操作栏背景drawable。

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:gravity="right"
    android:src="@drawable/background_bitmap" /> 
```

# c++-cli - C++/CLI、MEX：错误 C3767 候选函数取决于函数参数类型

> ID：14523110
> 
> 赞同：-2
> 
> 时间：2013-01-25T13:51:33.003
> 
> 标签：c++-cli, arguments, mex

我正在使用一个结构如下的 mex 解决方案：

我有一个 C# 阅读器 A，它由一个 C++/CLI 项目 B 调用，它由一个从 matlab 调用的 mex 项目 C 调用。这不是我的代码，只是我应该运行的东西。

B 包含两个我无法访问的函数，首先是构造函数：B::B(mxArray* data)

二、一个正则函数：mxArray* B::toMatlab(bool mode)

我尝试用 int 替换构造函数的 mxArray* 参数，这使错误消失了，并且与另一个函数类似，所以看起来函数本身是可访问的，但由于某种原因，我不允许使用类型 mxArray* 作为参数。

我不想包含太多关于我的代码的细节，但是如果我遗漏了任何相关的内容，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:57:00.480

错误帮助表明您的问题是本机类型的可见性（在 .NET 元数据中），并提供此链接以获取更多信息和解决方案：

*   [类型可见性](http://msdn.microsoft.com/en-us/library/4dffacbw.aspx)

# java - 显示正确的验证消息

> ID：14523111
> 
> 赞同：0
> 
> 时间：2013-01-25T13:51:34.630
> 
> 标签：java, playframework, playframework-1.x

我正在使用带有 Java 的 Play Framework 1.2.5。我有一个登录表单。我正在尝试使用必需的检查来验证登录表单，即用户名和密码都是必需的。我做了这段代码：

```
 public static void welcome(@Required String txtUserName, @Required String txtPassword){
    if(Validation.hasErrors()){
        flash.error("Oops!!! Please enter your credentials!");
        login();
    }       
    render(txtUserName,txtPassword);
} 
```

为了显示消息，这是我在 heml 页面中的内容：

```
<td align="right">
#{if flash.error}
<p style="color: red;">
    ${ flash.error }
</p>
#{/if}
</td> 
```

如果其中任何一个或两者都不存在，那么我想显示特定的消息，即如果用户名不存在，那么消息应该是“请提供用户名！！！”。目前，它正在显示一条常见消息。

请让我知道如何实现这一目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:42:13.073

Validation 类有一个方法 hasError：

```
/**
 * @param field The field name
 * @return True is there are errors related to this field
 */
public static boolean hasError(String field) {
    return error(field) != null;
} 
```

尝试像这样使用此方法：

```
if(validation.hasError("name_of_username_form_field")){
    flash.error("Username required");
    login();
}else if (validation.hasError("name_of_password_form_field")){
    flash.error("Password required");
    login();
} 
```

字段名称必须与 groovy 模板中输入元素之一的名称匹配。

祝你好运！

# java - 在 Google App Engine (Java) 上全面覆盖 URL 重写

> ID：14523117
> 
> 赞同：2
> 
> 时间：2013-01-25T13:51:51.647
> 
> 标签：java, google-app-engine, url-rewriting

我正在尝试为 GAE 应用程序创建一个短 URL，所以我使用了[UrlRewriteFilter](https://code.google.com/p/urlrewritefilter/)，但我无法正确设置它。基本上，用户会得到这个：

*   test.com/012a-bc

他们应该被重定向到的页面是

*   test.com/vote.jsp?id=012a-bc

目前它正在使用这样的`urlrewrite.xml`文件：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE urlrewrite PUBLIC "-//tuckey.org//DTD UrlRewrite 4.0//EN" "http://www.tuckey.org/res/dtds/urlrewrite4.0.dtd">
<urlrewrite>

    <rule>
        <from>/([0-z]+)</from>
        <to last="true">/vote.jsp?id=$1</to>
    </rule>

</urlrewrite> 
```

问题是所有 URL 现在都重定向到这个，例如

*   test.com/thankyou.jsp?id=0123

仍然在 vote.jsp 上运行页面。我应该怎么做才能让它仅在找不到 URL 时重定向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:59:14.420

那么下面的规则呢：

```
<rule>
   <from>^/([\w-]+)$</from>
   <to last="true">/vote.jsp?id=$1</to>
</rule> 
```

其中`[\w-]+`至少有一个任何单词字符（字母、数字、下划线），包括`-`（破折号）。您使用`^`and`$`来锚定检查文本的开头和结尾。

* * *

[UrlRewriteFilter](http://urlrewritefilter.googlecode.com/svn/trunk/src/doc/manual/4.0/index.html)文档说

> 执行规则时，过滤器将（非常简化）循环遍历所有规则，并为每个规则执行类似以下伪代码的操作：

```
Pattern.compile(<from> element); pattern.matcher(request url);
matcher.replaceAll(<to> element); 
if ( <condition> elements match && matcher.find() ) {
    handle <set> elements (if any)
    execute <run> elements (if any)
    perform <to> element (if any) 
} 
```

这就是为什么你必须使用开始（`^`）和结束（`$`）字符串正则表达式锚点

# javascript - Dojo Widget 中的 JsonRest，没有方法 query()

> ID：14523125
> 
> 赞同：0
> 
> 时间：2013-01-25T13:51:59.933
> 
> 标签：javascript, combobox, dojo

我正在构建一个模板化的小部件，在其中创建一个带有 ComboBox 的表单，我尝试在其中填充 JsonRest

这是我用于小部件的代码：

```
define( [ 
  'dojo/_base/declare', 
  'dijit/_WidgetBase', 
  'dijit/_TemplatedMixin', 
  'dijit/_WidgetsInTemplateMixin', 
  'dojo/text!./templates/PanelDesigner.html', 
  'dijit/form/TextBox', 
  'dijit/form/Form', 
  'dojo/store/JsonRest', 
  'dijit/form/ComboBox' 
], 

  function(declare, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, template,   JsonRest) { 
    worksector_store = new JsonRest({ 
      target: '/worksectors' 
    }); 

  return declare('ppc.panel_designer.PanelDesigner',[_WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin], { 
    templateString: template, 
    widgetsInTemplate: true 
  }); 
}); 
```

这是正在加载的模板：

```
<div id='${baseClass}' data-dojo-type='dijit/form/Form' data-dojo-id='${baseClass}'>
  <table>
    <tr>
      <td><label for:'name'>Name:</label></td>
      <td><input type='text' id='name' name='name' required='true' data-dojo-type='dijit/form/TextBox'/></td>
    </tr>
    <tr>
      <td><label for:'worksector'>Worksector:</label></td>
      <td><input id='worksector' name='worksector' data-dojo-type='dijit/form/ComboBox' data-dojo-props="store:worksector_store" /></td>
    </tr>
  </table>
</div> 
```

但是当我尝试使用 ComboBox 时，我总是会收到错误消息：

```
Uncaught TypeError: Object [Widget dijit.form.TextBox, dijit_form_TextBox_0] has no method 'query' 
```

我一直在寻找一段时间，但还没有找到解决方案。我试图从模板中删除存储并直接在声明函数的 postCreate 方法中调用查询方法，但这给了我同样的错误。

提前致谢。马塞尔

# 解决方案：

问题是我如何传递给定义的函数的参数顺序。第一个参数是要包含的对象数组，第二个参数是带有变量列表的函数。

函数中变量的顺序需要与传入数组中对象的顺序一致。

所以小部件的代码现在看起来像：

```
define( [
  'dojo/_base/declare',
  'dijit/_WidgetBase',
  'dijit/_TemplatedMixin',
  'dijit/_WidgetsInTemplateMixin',
  'dojo/text!./templates/PanelDesigner.html',
  'dojo/store/JsonRest',
  'dojo/store/Memory',
  'dijit/form/ComboBox',
  'dijit/form/Form',
  'dijit/form/TextBox'
],
function(declare, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, template, JsonRest, Memory, ComboBox) {
  worksector_store = new JsonRest({
    target: '/worksectors'
  });

  return declare('ppc.panel_designer.PanelDesigner',[_WidgetBase, _TemplatedMixin,     _WidgetsInTemplateMixin], {
    templateString: template,
    widgetsInTemplate: true,
  });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:59:53.643

我认为您的`worksector_store`变量在模板中不可见。我认为您只想以声明方式创建 ComboBox：

```
define([..],function(..){
  var worksector_store = new JsonRest({});

  return declare('...',[deps],{
    buildRendering:function(){
      //do the other templated dom building
      this.inherited(arguments);
      this.comboBox = new CombBox({store:worksector_store});
    }
  });
}); 
```

# c# - C#：方括号替代方案/用于多个 SOAP 地址的类

> ID：14523135
> 
> 赞同：0
> 
> 时间：2013-01-25T13:52:30.587
> 
> 标签：c#

我已经使用`wsdl.exe`工具生成了一个 SOAP 类。不幸的是，它似乎绑定到一个特定的 URL，我需要能够在每个实例的基础上更改它（我希望能够连接到共享同一接口的多个 URL）。所以，我想改变这样的代码：

```
/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("wsdl", "2.0.50727.3038")]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Web.Services.WebServiceBindingAttribute(Name="Service1Soap", Namespace="http://productmarket.bigbrain.math.uni.lodz.pl/")]
public partial class Service1 : System.Web.Services.Protocols.SoapHttpClientProtocol {

// some code here

    /// <remarks/>
    [System.Web.Services.Protocols.SoapDocumentMethodAttribute("http://productmarket.bigbrain.math.uni.lodz.pl/Authenticate", RequestNamespace="http://productmarket.bigbrain.math.uni.lodz.pl/", ResponseNamespace="http://productmarket.bigbrain.math.uni.lodz.pl/", Use=System.Web.Services.Description.SoapBindingUse.Literal, ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped)]
    public bool Authenticate(int ContractorId, string Password) {
        object[] results = this.Invoke("Authenticate", new object[] {
                    ContractorId,
                    Password});
        return ((bool)(results[0]));
    }

// more code here

} 
```

因此来自 Authenticate 的属性（带有 HTTP URL 的属性）是可变的。到目前为止，我发现的唯一解决方案是在 Service1 类中创建一个静态字符串，并像这样更改 Authenticate 代码：

```
/// <remarks/>
[System.CodeDom.Compiler.GeneratedCodeAttribute("wsdl", "2.0.50727.3038")]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Web.Services.WebServiceBindingAttribute(Name="Service1Soap", Namespace="http://productmarket.bigbrain.math.uni.lodz.pl/")]
public partial class Service1 : System.Web.Services.Protocols.SoapHttpClientProtocol {

//some code

    public static string prefix = "http://productmarket.bigbrain.math.uni.lodz.pl/";
    public static string soap_namespace = "http://productmarket.bigbrain.math.uni.lodz.pl/";

    /// <remarks/>
    [System.Web.Services.Protocols.SoapDocumentMethodAttribute(Service1.prefix+"Authenticate", RequestNamespace=Service1.soap_namespace, ResponseNamespace=Service1.soap_namespace, Use=System.Web.Services.Description.SoapBindingUse.Literal, ParameterStyle=System.Web.Services.Protocols.SoapParameterStyle.Wrapped)]
    public bool Authenticate(int ContractorId, string Password) {
        object[] results = this.Invoke("Authenticate", new object[] {
                    ContractorId,
                    Password});
        return ((bool)(results[0]));
    }

//some code

} 
```

有没有更好的解决方案可以从实例中提取这些信息，而不是强迫我在每个请求中都更改它们？我必须承认我并不完全理解 C# 中属性的概念。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:03:29.620

命名空间属性不是服务端点。目的是准确定义一个命名空间，或者更好地定义soap调用中使用的实体/方法的[xml命名空间。](https://www.google.com/search?q=xml%20namespace)

服务器部分的 url 端点是隐式定义的，服务发布在哪里。

在客户端部分取决于具体的实现。

对于 wsdl.exe 客户端，我记得语法是这样的：

```
Service1 ws = new Service1();
ws.Url = "http://anyserver.addr/of/the/service.asmx";

bool auth = ws.Authenticate(21,"****"); 
```

# php - IE通过base64图像的file_put_contents生成损坏的图像

> ID：14523138
> 
> 赞同：1
> 
> 时间：2013-01-25T13:52:43.403
> 
> 标签：php, internet-explorer, image-processing, corrupt

```
$imgPath = """BASE64 ENCODED STRING HERE""";

header('Content-Type: image/png');
$img = str_replace('data:image/png;base64,', '', $imgPath);
$img = str_replace(' ', '+', $img);
$data = base64_decode($img);
$file = "test.png";
$success = file_put_contents($file, $data);

$html = '<img src="'.$file.'" />';
exit; 
```

这里在 ff/chrome 中创建的 test.png 很好......**但是 IE 很糟糕并生成损坏的图像。**

# sql - 如何在 SQL 中的一行而不是多行上显示选定的结果

> ID：14523142
> 
> 赞同：0
> 
> 时间：2013-01-25T13:52:51.683
> 
> 标签：sql, sql-server-2008, pivot

我想让我的 MS SQL 2008 选择查询以一种非常独特的方式显示结果，我希望有人可以帮助我完成。

我不想将 3 列的结果显示在 9 行中，而是希望将数据显示在一行中，并将 3 列名称重复 9 次。

我试图谷歌这个，但我似乎无法在任何地方找到正确的想法。

感谢任何可以提供帮助的人一百万！

我想发布图片，但我需要代表点才能做到这一点，这太愚蠢了！但无论如何我发现了一篇针对 PostgreSQL 8.3 的类似帖子。但我是一个初学者，所以我不明白如何翻译 MS SQL。

前：

```
col1 |  col2  |  col3   |
-----|--------|---------|
 a   |12/01/12| 13/01/12|
-----|--------|---------|
 b   |14/01/12| 14/01/12| 
```

后：

```
col1 |  col2  |  col3   |col1 |  col2  |  col3   |
-----|--------|---------|-----|--------|---------|
 a   |12/01/12| 13/01/12| b   |14/01/12| 15/01/12|
-----|--------|---------|-----|--------|---------| 
```

这是让您更好地了解我的情况的链接 [将多行转换为具有多列的一行](https://stackoverflow.com/questions/13744386/convert-multiple-rows-into-one-row-with-multiple-columns)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:00:55.877

在 SQL Server 2005+ 中，您可以使用该[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)函数来执行此操作。*枢轴*从行中获取您的值并将其转换为列。

有几种方法可以透视数据。如果您提前知道所有值，那么您可以对查询进行硬编码。否则，您可以使用动态 SQL 在运行时生成查询。

*枢轴*的静态版本将与此类似：

```
select *
from
(
  select col1, col2
  from table1
) src
pivot
(
  max(col1)
  for col2 in (test, blah, value)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/8d93e/1)。

如果您有未知数量的值，那么您将生成类似于以下内容的动态 SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(col2) 
                    from table1
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT ' + @cols + ' from 
             (
                select col1, col2
                from table1
            ) x
            pivot 
            (
                max(col1)
                for col2 in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/8d93e/3)

这些是`col2`从您的表中获取行值并将它们转换为列。两者的结果是相同的：

```
| TEST | BLAH | VALUE |
-----------------------
|    1 |    2 |     3 | 
```

在 SQL Server 2005 之前或在没有*数据透视*函数的数据库中，您可以使用带有`case`表达式的聚合函数来转换数据：

```
select 
  max(case when col2 = 'test' then col1 end) test,
  max(case when col2 = 'blah' then col1 end) blah,
  max(case when col2 = 'value' then col1 end) value
from table1 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/8d93e/4)

如果您想一遍又一遍地重复列，另一种方法是一起使用`UNPIVOT`and`PIVOT`函数来获得结果。如果您有示例数据：

```
CREATE TABLE yourtable
    ([id] int, [name] varchar(10), [type] varchar(10))
;

INSERT INTO yourtable
    ([id], [name], [type])
VALUES
    (1, 'John', 'dog'),
    (2, 'Tim', 'bird'),
    (3, 'Betty', 'cat'),
    (4, 'Jim', 'rat')
; 
```

并且您想在重复列中重复`id`,`name`和`type`值，那么您可以使用：

```
select *
from
(
  select 
    col +'_'+cast(rn as varchar(50)) col ,
    value
  from
  (
    select 
      cast(id as varchar(10)) id,
      name, 
      type,
      row_number() over(order by id) rn
    from yourtable
  ) src
  unpivot
  (
    value
    for col in (id, name, type)
  ) unpiv
) src
pivot
(
  max(value)
  for col in (id_1, name_1, type_1,
              id_2, name_2, type_2,
              id_3, name_3, type_3,
              id_4, name_4, type_4)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/f9df4/6)。结果将是：

```
| ID_1 | NAME_1 | TYPE_1 | ID_2 | NAME_2 | TYPE_2 | ID_3 | NAME_3 | TYPE_3 | ID_4 | NAME_4 | TYPE_4 |
-----------------------------------------------------------------------------------------------------
|    1 |   John |    dog |    2 |    Tim |   bird |    3 |  Betty |    cat |    4 |    Jim |    rat | 
```

编辑＃2，查看您的示例数据，您可以使用以下内容：

```
select *
from
(
  select 
    col +'_'+cast(rn as varchar(50)) col ,
    value
  from
  (
    select 
      col1,
      convert(varchar(10), col2, 120) col2, 
      convert(varchar(10), col3, 120) col3, 
      row_number() over(order by col1) rn
    from yourtable
  ) src
  unpivot
  (
    value
    for col in (col1, col2, col3)
  ) unpiv
) src
pivot
(
  max(value)
  for col in (col1_1, col2_1, col3_1,
              col1_2, col2_2, col3_2)
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/74e0a/7)

给出结果：

```
| COL1_1 |     COL2_1 |     COL3_1 | COL1_2 |     COL2_2 |     COL3_2 |
-----------------------------------------------------------------------
|      a | 2012-01-12 | 2012-01-13 |      b | 2012-01-14 | 2012-01-14 | 
```

# django - manage.py runserver 的默认输出是什么意思？

> ID：14523143
> 
> 赞同：21
> 
> 时间：2013-01-25T13:52:52.743
> 
> 标签：django, django-dev-server

manage.py runserver 的默认输出是什么意思？找不到任何文档：

```
[25/Jan/2013 07:45:59] "GET / HTTP/1.1" 200 149 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-25T13:52:52.743

我标记了默认输出以帮助解释其含义：

```
([25/Jan/2013 07:45:59]) ("GET / HTTP/1.1") (200) (149)

(Datetime request was sent) (telnet/netcat-style plaintext request string) (HTTP status code) (bytes sent as response) 
```

所有这些都可以在您最喜欢的浏览器开发控制台中确认。

# google-maps-api-3 - 是否可以在谷歌地图中画一个圆并检查哪些坐标落在圆上？

> ID：14523144
> 
> 赞同：0
> 
> 时间：2013-01-25T13:52:52.610
> 
> 标签：google-maps-api-3

我的站点中有一张大地图，并且我已经实现了通过 Google Maps API v3 在其上绘制形状（如圆形、矩形）。

我有一组位置（由坐标组成）。有没有一种方法可以检查哪些坐标落在用户在地图上绘制的形状（比如圆形）上？

我在这里检查了几个问题并在 Google 上进行了搜索，但找不到具体的方法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:08:30.397

取决于形状。

1.  对于圆，使用[球面几何库](https://developers.google.com/maps/documentation/javascript/reference#spherical)computeDistanceBetween() 方法，对于每个点和圆心（如果计算的距离小于圆的半径，则该点在内部）

2.  对于矩形使用[LatLngBounds.contains()](https://developers.google.com/maps/documentation/javascript/reference#LatLngBounds)

3.  对于多边形，使用[poly 库](https://developers.google.com/maps/documentation/javascript/reference#poly)containsLocation() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:33:22.030

是的，您可以，您需要计算从中心到所需坐标的距离。然后你检查它的距离是否等于你的圆的半径。

相比。中心和其他坐标之间的距离可以用 来计算，`levenshtein`或者你可以使用`getDistanceMatrix`图书馆的地方。

# c++ - qmake 中的编译器范围值

> ID：14523148
> 
> 赞同：8
> 
> 时间：2013-01-25T13:53:09.107
> 
> 标签：c++, qt, scope, qmake

qmake 提供了几个内置的平台范围，允许项目文件根据当前平台执行不同的操作：

```
win32 {
    ...
}
unix {
    ...
} 
```

目录中的所有平台规范`mkspecs`也可用于测试各种平台/编译器组合，例如

```
linux-g++ {
    ...
}
win32-g++ {
    ...
}
win32-msvc2003 {
    ...
} 
```

但是，我似乎找不到只测试编译器的方法（没有操作系统）

```
#This does not work
g++ {
    ...
}
msvc {
    ...
} 
```

有没有办法做到这一点而不必列出所有组合（`linux-g++ | win32-g++ | cygwin-g++ | ... {}`）？如果这不可能，是否有充分的理由？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T14:13:15.340

**你可以这样做：**

```
*-g++ {
    ...
}
win32-msvc* {
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T14:33:41.980

These build in platform scopes are based on the [qmake spec](http://qt-project.org/doc/qt-4.8/qmake-advanced-usage.html#platform-scope-values) in Qt installation directory. The way platform scopes are resolved is not documented, but it seems that [qmake internally use regexes](https://github.com/Blizzard/qt/blob/master/qmake/project.cpp#L1562) to determine if the scope apply to the current `mkspecs`.

Only [wildcard matching](http://qt-project.org/doc/qt-4.8/qregexp.html#wildcard-matching) is enabled (ie `?`, `*`, `[]`)

Note that inside qmake `unix`,`win32`, `macx` have several meanings, both as magic keywords, and as a regular expressions to match.

# python - 用于图像处理的 python 和 gdal

> ID：14523150
> 
> 赞同：0
> 
> 时间：2013-01-25T13:53:11.333
> 
> 标签：python, gdal

我有一个数据库目录，它读取图像路径以及其他属性，并且有一部分试图在代码中打开数据集，以便如果打开成功，其他进程可以继续，但我遇到了一个关于如何在下面的代码之后告诉进程继续，代码运行顺利，但是当它遇到无法打开的图像时它会停止而不是去开始再次读取数据库并打开新图像。

```
try:  
    hDataset = gdal.Open( pszFilename, gdal.GA_ReadOnly )  
    except IOError:  
    print("gdalinfo failed - unable to open '%s'." % pszFilename )  
    status = "UPDATE %s SET job = 11  WHERE id = %s" % (table,row[2])  
    setstatus = conn.cursor()  
    setstatus.execute(status)  
    conn.commit()  
    setstatus.close()  
else:  
    print "file opened sucessfully"  
    hDataset.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T06:41:00.133

GDAL 通常不会抛出异常，这是一种耻辱。`gdal.UseExceptions()`打开后，它有时会抛出（`RuntimeError`仅！），但我还没有发现这个功能非常可靠。

如果不成功，一些带有 GDAL 的函数会返回`None`，而其他函数则返回一个状态整数，其中 0 是好的，非零是错误代码。

我使用的典型形式是这样的：

```
hDataset = gdal.Open(pszFilename, gdal.GA_ReadOnly)
if hDataset is None:
    raise IOError("Could not open '%s'" % (pszFilename,))

band_num = 1
band = hDataset.GetRasterBand(band_num)
if band is None:
    raise AttributeError("Raster band %s cannot be fetched" % (band_num,))
... 
```

# android - 如何从数据库中检索日期并将它们绘制在 Android 的折线图上

> ID：14523151
> 
> 赞同：0
> 
> 时间：2013-01-25T13:53:17.267
> 
> 标签：android, sqlite, date

这是我的应用程序代码的一部分，它在折线图上绘制特定日期的值。从 Android 的数据库中检索日期。

这是 MainActivity.java 中折线图的代码：

```
public void openChart() {
        // TODO Auto-generated method stub
        Date[] dt = new Date[100];//new Date[c.getCount()];
        int i=0;
        c=dbAdapter.getAllRecords();
        c.moveToFirst();
        //List<Date> dt = new ArrayList<Date>();

        while(c.moveToNext()){
            String stringDate = c.getString(1);
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
            Date date = null;
            try {
                date = sdf.parse(stringDate);
            } catch (ParseException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            dt[i] = date;//dt.add(date);//
            i++;
        }

        //double[] numbers = {20.0,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21.0,21.2};
        Double[] numbers = new Double[100];

        TimeSeries numbersTime = new TimeSeries("Numbers Time");

        for(int i2=0;i2<dt.length;i2++){
            numbers[i2]=(double) i2;
            numbersTime.add(dt[i2],numbers[i2]);
        }

        XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();
        dataset.addSeries(numbersTime);

        XYSeriesRenderer numbersRenderer = new XYSeriesRenderer();
        numbersRenderer.setColor(Color.BLACK);
        numbersRenderer.setPointStyle(PointStyle.CIRCLE);
        numbersRenderer.setFillPoints(true);
        numbersRenderer.setLineWidth(2);
        numbersRenderer.setDisplayChartValues(true);

        XYMultipleSeriesRenderer multiRenderer = new XYMultipleSeriesRenderer();

         multiRenderer.setChartTitle("Visits vs Views Chart");
         multiRenderer.setXTitle("Date Time");
         multiRenderer.setYTitle("Double Numbers");
         multiRenderer.setZoomButtonsVisible(true);

         multiRenderer.addSeriesRenderer(numbersRenderer);

         // Creating an intent to plot line chart using dataset and multipleRenderer
            Intent intent = ChartFactory.getLineChartIntent(getBaseContext(), dataset, multiRenderer);

            // Start Activity
            startActivity(intent);
    } 
```

这里是 LogCat 文件行：

```
01-25 19:14:30.531: D/AndroidRuntime(31866): Shutting down VM
01-25 19:14:30.531: W/dalvikvm(31866): threadid=1: thread exiting with uncaught exception (group=0x40018578)
01-25 19:14:30.546: E/AndroidRuntime(31866): FATAL EXCEPTION: main
01-25 19:14:30.546: E/AndroidRuntime(31866): java.lang.NullPointerException
01-25 19:14:30.546: E/AndroidRuntime(31866):    at org.achartengine.model.TimeSeries.add(TimeSeries.java:41)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at com.example.dateexample.seenu.MainActivity.openChart(MainActivity.java:105)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at com.example.dateexample.seenu.MainActivity$2.onClick(MainActivity.java:70)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at android.view.View.performClick(View.java:2485)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at android.view.View$PerformClick.run(View.java:9080)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at android.os.Handler.handleCallback(Handler.java:587)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at android.os.Looper.loop(Looper.java:130)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at android.app.ActivityThread.main(ActivityThread.java:3687)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at java.lang.reflect.Method.invokeNative(Native Method)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at java.lang.reflect.Method.invoke(Method.java:507)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
01-25 19:14:30.546: E/AndroidRuntime(31866):    at dalvik.system.NativeStart.main(Native Method) 
```

在这里，我在第 105 行遇到了 nullPointer 异常，它是 'numbersTime.add(dt[i2],numbers[i2]);' 陈述。我不清楚如何从数据库中检索日期并将它们绘制在聊天中。请为我的异常提供解决方案。

PS：如果我的问题不清楚，请向我进行一些编辑。感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:07:31.757

看起来您`dt[i2]`在某些时候为空，这可能是由您的`date = sdf.parse(stringDate);`. 如果解析失败，则`date`不会设置，因此它将保持为空。

尝试将其设置为您的 catch 中的默认值，或在执行之前专门检查 null`numbersTime.add(dt[i2],numbers[i2])`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:03:39.247

在我的项目中，我有某事。像这样：

```
List<Date[]> dates = new ArrayList<Date[]>();
dates.add(new Date[valueY.length]);

for(int i = 0; i < valueY.length; i++) {
     dates.get(0)[i] = new Date((Integer.valueOf(valueY[i].split("/")[2]) - 1900), (parseDayAndMonth(valueY[i].split("/")[1]) - 1), parseDayAndMonth(valueY[i].split("/")[0]));
} 
```

`valueY`是`String`数组。

```
String valueY = new String[]{"24/10/2013", "12/07/2013"}; 
```

我得到这样的图表：

```
ChartFactory.getTimeChartView(ReportsEngine.getApplicationContext(), buildDateDataset(titles, dates, values), renderer, "dd/MM"); 
```

这是我的`parseDayAndMonth()`方法。

```
public static Integer parseDayAndMonth(String number) {
    Integer num = Integer.valueOf(number);
    if(num < 10) {
        number = number.replace("0", "");
    }
    return Integer.valueOf(number);
} 
```

# arrays - 在数组 Perl 中传递参数

> ID：14523153
> 
> 赞同：-1
> 
> 时间：2013-01-25T13:53:23.087
> 
> 标签：arrays, perl, arguments

这是我的问题：我想使用具有动态数量参数的例程。例如，这是我的子：

```
dynamic_sub($firstMandatoryArgment, "second argument", $thirdArgument); 
```

我可以使用任意数量的参数调用 dynamic_sub（但有些是强制性的）。在我的程序中，参数的数量取决于上下文。所以我想写这样的东西：

```
my @args = ($firstMandatoryArgment, "second argument", $thirdArgument, ...);

dynamic_sub(@args); 
```

问题是我无法重写 dynamic_sub()，所以我必须找到一种方法将我的参数放入一个数组中，然后用我的参数数组调用 dynamic_sub()。当然@args 应该被解释为多个参数，而不是一个数组；）

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:22:49.830

在 Perl 中，子例程采用参数*列表*，该列表在内部分配给数组`@_`。因此，在大多数情况下，使用数组或值列表调用 sub 是一回事。

一个例外是子例程使用*原型*时：

```
sub without_prototypes  { say "@_" }
sub with_prototypes ($) { say "@_" }

my @args = 1 .. 5;

without_prototypes(@args); # @args is used in list context, prints "1 2 3 4 5\n".
with_prototypes(@args);    # @args is used in scalar context, prints "5\n" (length).
&with_prototypes(@args);   # the & disables prototypes; prints "1 2 3 4 5\n". 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T19:25:58.027

唯一可以作为参数传递的是标量列表，所以

```
my @args = ($firstMandatoryArgment, "second argument", $thirdArgument, ...);
dynamic_sub(@args); 
```

是一样的

```
my @args = ( $firstMandatoryArgment, "second argument", $thirdArgument, ... );
dynamic_sub($args[0], $args[1], $args[2], ...); 
```

如果子（愚蠢地）使用原型来覆盖此行为，则可以覆盖原型使用`&`：

```
&dynamic_sub(@args); 
```

# javascript - Extjs 4.1 (rc2) - Ext.panel.Panel 上的扩展有时无法完成渲染

> ID：14523158
> 
> 赞同：0
> 
> 时间：2013-01-25T13:53:57.287
> 
> 标签：javascript, extjs, rendering

我有一个在 Ext.panel.Panel 上扩展的类。

简化代码：

```
Ext.define("some.namespace.MyOwnPanel", { 
    extends: "Ext.panel.Panel",

    constructor: function (config) {
        var me = this;

        Ext.apply(this, config);
        this.callParent(arguments);

        this.layout = "border";

        this.centerPanel = Ext.create("Ext.panel.Panel" , {
            region: "center",
            layout: "fit",
            border: false
        });

        this.westPanel = Ext.create("Ext.panel.Panel", {
            region: "west",
            layout: "fit",
            border: false
        });

        this.add(this.centerPanel);
        this.add(this.westPanel);

        this.on("afterrender", function () {
            // create grid for center panel. Data is loaded with AJAX in that function and the component is also added to this.centerPanel
            me.createGrid();
        });
    }
} 
```

有时它可以工作并触发 afterrender 事件，但有时它不起作用，然后 Web 应用程序崩溃。没有给出错误，但任何 ext 组件的创建都会在该点之后停止。

我已经尝试了很多东西。原始代码大部分是由同事编写的，其中有更多与 4.1 兼容的 Extjs 3.1 代码的痕迹。我尝试将其重写为正确的 4.1 代码，但没有成功。我试图将代码移动到 initComponent 方法，但也失败了。

我对如何解决这个问题没有更多的想法。有没有人遇到过这样的事情，你是怎么做的？请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T19:58:27.027

我认为您需要在 initComponent() 函数中创建 this.centerPanel = Ext.create("Ext.panel.Panel" , { ...

```
initComponent: function() {
    Ext.apply(this, {
        centerPanel: Ext.create("Ext.panel.Panel" , { ... },
        ...
    });
    this.callParent(arguments);
} 
```

不在构造函数中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:09:44.450

这个问题与在`constructor`而不是`initComponent`. `initComponent`是设置类的推荐方式，构造函数只应在特殊情况下被覆盖。如果您的课程是使用可以解释有时工作和失败的配置 创建的，则该课程的设置方式`afterrender`可能不会触发事件。`renderTo`

```
Ext.define('Bad', {
    extend: 'Ext.Component',
    constructor: function() {
        //the parent constructor is called here and if renderTo 
        // is defined it will render before the afterrender listener is added
        this.callParent(arguments);
        this.on('afterrender', function(){
            window.alert('rendered')
        })
    }
})

var works = new Bad();
//this will alert rendered
works.render(document.body)

//this wont
new Bad({renderTo: document.body})

Ext.define('Good', {
    extend: 'Ext.Component',
    //change constructor to initComponent
    initComponent: function() {
        this.callParent(arguments);
        this.on('afterrender', function(){
            window.alert('rendered')
        })
    }
})

//alerts 
new Good({renderTo: document.body}) 
```

# c++ - 如何获得由 gcc-mingw 编译的进程的最大内存使用量

> ID：14523160
> 
> 赞同：0
> 
> 时间：2013-01-25T13:53:57.477
> 
> 标签：c++, windows, mingw

我有一个 C++ 代码。我可以编辑它。我想获得由代码生成的进程的最大内存使用量，所以我正在寻找一些函数来查看内存使用情况。

我已经搜索了三天，但我找不到任何信息。（我尝试了其中的一些，例如`GetProcessMemoryInfo`，但它没有用）

请给我一些建议。谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:15:06.987

> 我尝试了其中一些，例如`GetProcessMemoryInfo`，但它没有用

以下基于[为进程收集内存使用信息](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682050%28v=vs.85%29.aspx)，适用于我：

```
#include <windows.h>
#include <stdio.h>
#include <psapi.h>

int main() {
    HANDLE hProcess;
    PROCESS_MEMORY_COUNTERS pmc;

    hProcess = OpenProcess(PROCESS_QUERY_INFORMATION |
                           PROCESS_VM_READ,
                           FALSE, GetCurrentProcessId() );
    if (NULL != hProcess) {
        if ( GetProcessMemoryInfo( hProcess, &pmc, sizeof(pmc)) ) {
            printf( "PeakWorkingSetSize: 0x%08X\n", pmc.PeakWorkingSetSize );
            printf( "WorkingSetSize: 0x%08X\n", pmc.WorkingSetSize );
            // ... add other members from pmc, as needed ...
        }
        CloseHandle( hProcess );
    }
} 
```

编译和链接`g++ -o procinfo procinfo.cpp -lpsapi`。

# tfs - 将工作流程更改应用于每个项目

> ID：14523162
> 
> 赞同：1
> 
> 时间：2013-01-25T13:54:08.723
> 
> 标签：tfs, visual-studio-2012

我最近开始使用 TFS 2012 进行错误跟踪。昨天我被分配了一个错误，最终根本不是错误，所以我按照[本指南](http://www.pedautreppe.com/post/How-to-mark-a-bug-as-Rejected-with-TFS-.aspx)添加了一个新的自定义已解决原因。

这很好，我用我的新“不是错误”原因成功地关闭了我的错误。

但是，今天我收到了另一个错误（在不同的项目中），这也不是错误。当我去解决它时，我的新“不是错误原因”没有出现。回想起来，这是有道理的，因为我只修改了旧项目（项目 A）的工作流程，而不是项目 B。

我显然可以再次为项目 B 手动更改工作流程，但我希望在每个项目中默认使用这个自定义原因（以及最终其他原因）。鉴于源代码控制中有几十个项目，手动执行此操作需要相当长的时间。我没有看到任何编辑通用工作流程的方法，我总是不得不在特定项目下选择一个。

**有什么方法可以对默认情况下适用于每个项目的工作流程进行更改？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:48:47.150

没有任何神奇的开关可以让您将更改部署到多个团队项目。

1.  您可以使用命令行创建一个批处理文件以将[`witadmin`](http://msdn.microsoft.com/en-us/library/dd236914%28v=vs.110%29.aspx)其导入每个团队项目，然后为每次更改运行该文件。
2.  您可以创建一个构建定义来部署您的更改。[Ed Squared 的博客](http://www.edsquared.com/2010/06/18/Deploying+Process+Template+Changes+Using+TFS+2010+Build.aspx)上提供了 TFS 2010 的详细信息。我认为这需要更新 TFS 2012。

# c# - 有没有一种简单的方法可以在我的连接上使用依赖注入？

> ID：14523166
> 
> 赞同：21
> 
> 时间：2013-01-25T13:54:13.560
> 
> 标签：c#, asp.net, ninject

我正在寻找一种将我的连接注入我的存储库的方法。我尝试使用 注入`SqlConnection`，`IDBConnection`但是在`NInject`尝试停用连接时遇到了一些问题，该事件永远不会被调用。而且我无法弄清楚如何将连接字符串注入我的存储库。

有人可以给我一个建议吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-25T13:57:12.640

我使用 NInject 来执行我的项目的依赖注入。我通常以以下配置结束：

简单的工厂界面

```
public interface IDbConnectionFactory
{
    IDbConnection CreateConnection();
} 
```

工厂实施

```
public class SqlConnectionFactory : IDbConnectionFactory
{
    private readonly string _connectionString;

    public SqlConnectionFactory(string connectionString)
    {
        _connectionString = connectionString;
    }

    public IDbConnection CreateConnection()
    {
        var conn = new SqlConnection(_connectionString);
        conn.Open();
        return conn;
    }
} 
```

N注入配置：

```
Bind<IDbConnectionFactory>()
    .To<SqlConnectionFactory>()
    .WithConstructorArgument("connectionString",
ConfigurationManager.ConnectionStrings["SqlConnection"].ConnectionString); 
```

存储库示例：

```
public class UserRepository : IUserRepository
{
    private readonly IDbConnectionFactory _dbConnectionFactory;

    public UserRepository(IDbConnectionFactory dbConnectionFactory)
    {
        _dbConnectionFactory = dbConnectionFactory;
    }

    public IEnumerable<User> List()
    {
        using (var dbConnection = _dbConnectionFactory.CreateConnection())
        {
            ....
        }
    }
} 
```

编辑：我总是让 ADO.NET 负责连接池。因此，每次需要执行数据库操作时，我都会打开和关闭连接。

这种方法对我有用，并且正如您在问题中提到的那样非常简单。

# python - 在python中，是否有一个静态等价于isinstance？

> ID：14523167
> 
> 赞同：3
> 
> 时间：2013-01-25T13:54:19.363
> 
> 标签：python, inheritance, static, isinstance

我想扫描一个模块（使用`dir()`）并提取`type`扩展某个父类的类的所有类名（对象）。有没有办法在不首先创建我可以检查的实例的情况下做到这一点`isinstance()`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T13:55:31.537

我想你可能正在寻找[`issubclass`](http://docs.python.org/2/library/functions.html#issubclass)

# c++ - rapidxml first_node 不返回 null

> ID：14523177
> 
> 赞同：1
> 
> 时间：2013-01-25T13:54:54.590
> 
> 标签：c++, xml, null, rapidxml

我正在尝试在 C++ 中使用 RapidXML 解析 XML 文件，该文件类似于：

```
<root>
    <a>
        <b>1111</b>
        <c>
            <d1>2222</d1>       
            <d2>3333</d2>
        </c>
    </a>
</root> 
```

要识别我正在做的父节点：

```
if (currentNode->first_node() != 0) { // this node has children, search for them } 
```

它适用于前两个节点（根和 a），但是当我为节点“b”执行此操作时，它返回一个指向某处而不是 0 的指针，但“b”没有子节点。它不应该返回0吗？RapidXML 文档说：

**函数 xml_node::first_node 概要**

```
xml_node<Ch>* first_node(const Ch *name=0, std::size_t name_size=0, bool case_sensitive=true) const; 
```

**描述** 获取第一个子节点，可选择匹配节点名称。

**参数 name** 要查找的孩子的名称，或 0 以返回第一个孩子，无论其名称如何；如果 name_size 不为零，则此字符串不必以零结尾

**name_size** 名称的大小，以字符为单位，或 0 以从字符串自动计算大小

**case_sensitive** 名称比较是否应该区分大小写；不区分大小写的比较仅适用于 ASCII 字符

**返回** 指向找到的孩子的指针，如果没有找到，则返回 0。

知道为什么会发生这种情况或我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T14:18:20.737

您对 XML 的“元素节点”（即 root、a、b 等）和由解析器生成的 RapidXML 的“解析器节点”（包括数据节点）感到困惑。

您可以查看节点[`type()`](http://rapidxml.sourceforge.net/manual.html#classrapidxml_1_1xml__node_975e86937621ae4afe6a423219de30d0_1975e86937621ae4afe6a423219de30d0)以确定它是否是数据节点，或者使用[`parse_no_data_nodes`](http://rapidxml.sourceforge.net/manual.html#namespacerapidxml_87e8bbab53702cf3b438bd553c10b6b9_187e8bbab53702cf3b438bd553c10b6b9)解析标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-07T18:16:05.573

来自 Rapidxml 文档

```
 enum node_type
   ...
    Values

    node_document     A document node. Name and value are empty.
    node_element      An element node. Name contains element name.
                      Value contains text of first data node.
    node_data         A data node. Name is empty. Value contains data text.
    node_cdata        A CDATA node. Name is empty. Value contains data text.
    node_comment      A comment node. Name is empty. Value contains comment text.
    node_declaration  A declaration node. Name and value are empty. Declaration 
                      parameters (version, encoding and standalone) are 
                      in node attributes.
    node_doctype      A DOCTYPE node. Name is empty. Value contains DOCTYPE text.
    node_pi           A PI node. Name contains target. Value contains instructions. 
```

因此，正如 Roddy 所指出的，您应该检查“rapidXML”类型的节点。在你的例子中做类似的事情

```
 if (currentNode->first_node() != 0 && currentNode->type () == node_element) 
    { 
        // this node has children, search for them 
    } 
```

# javascript - 解析json数据失败 - jquery

> ID：14523179
> 
> 赞同：0
> 
> 时间：2013-01-25T13:54:56.143
> 
> 标签：javascript, jquery, json, parsing

我不知道我在哪里错过了一些东西，但我有这个

```
var myvar = [{"id":1,"name":"name1"},{"id":2,"name":"name2"}]; 
```

我试过这个

```
$(jQuery.parseJSON(JSON.stringify(myvar))).each(function() {  
        console.log(this.name);
}); 
```

但是我的控制台中有一个错误：`Syntax error, unrecognized expression [{"id":1,"name":"name1"},{"id":2,"name":"name2"]`

我错过了一些东西，但我不知道是什么？

编辑：事实上，当我将 myvar 复制粘贴到我的控制台并运行解析时，它就可以工作了吗？但是，当我刷新页面并这样检索 myvar 时：console.log(myvar)，我得到 [{"id":1,"name":"name1"},{"id":2,"name ":"name2"}]，通常不会被 chrome 的控制台告知它是一个对象

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:56:05.860

你没有关闭对象。

```
var myvar = [{"id":1,"name":"name1"},{"id":2,"name":"name2"}]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T13:56:27.593

你最后缺少一个 }

```
var myvar = [{"id":1,"name":"name1"},{"id":2,"name":"name2"}]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:13:24.533

这很奇怪; 我在尝试您的代码时也遇到了错误。不过，这似乎很好。

你为什么不试试这个：

```
jQuery(myvar).each(function () {
    console.log(this.name);
}); 
```

这输出

```
name1
name2 
```

在我的控制台中。这似乎是您的解决方案，因为您已经将对象转换为字符串并转换回对象（数组）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:12:03.477

这是正确的语法：

```
$(jQuery.parseJSON(myvar)).each(function() {  
    console.log(this.name);
}); 
```

（事实上​​，当我将 myvar 复制粘贴到我的控制台并运行解析时，它就可以工作了。但是，当我刷新我的页面并这样检索 myvar 时：console.log(myvar)，我得到 [{"id" :1,"name":"name1"},{"id":2,"name":"name2"}]，chrome 的控制台通常不会告诉它它是一个对象）

# vim - vim：跳过一段代码

> ID：14523183
> 
> 赞同：0
> 
> 时间：2013-01-25T13:55:07.497
> 
> 标签：vim

在 emacs 中，我经常需要处理非常大的数据文件，其中有大块的行被空行分隔。我可以使用`C-up`and`C-down`在这些空行之间移动，即代码块的开头和结尾。

vim 中是否有类似的功能可以跳转到下一个/上一个空行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T14:09:12.137

来自`:help paragraph`：

> 在每个空行之后开始一个段落，

您可以使用段落跳转`}`和`{`，也可以使用前置`[count]`。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-25T14:10:33.227

用于`}`下降和`{`上升。这些动作用于在“段落”之间跳转。

看看`:h motion.txt`是否有足够的精神打击。

请注意，您还可以使用`p`（用于“段落”）文本对象快速选择/删除/更改/缩进/拉出“段落”：

```
vip
dap
… 
```

并使用“段落”作为 Ex 命令的范围：

```
:'{,'}s/foo/bar 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-26T00:31:35.753

...另请参阅`[[` `]]` `[]` `][`在 C/Python/更多中的方法/函数之间移动

...`[m` `[M` `]M` `]m` 对于 Java 文件

# linux - 从文件中提取文件列表并打印带有条件的行的特定部分

> ID：14523184
> 
> 赞同：0
> 
> 时间：2013-01-25T13:55:11.660
> 
> 标签：linux, bash, sed, awk, grep

我想从“FILE_PATHS”之后的文件中列出的不同目录中提取文件路径，然后根据条件提取这些文件名的特定部分。例如：

```
$ grep ^FILE_PATHS file.txt
FILE_PATHS /james/families/MOTHER/analyses/trait 
FILE_PATHS /james/families/SIB/analyses/BROTHER/trait 
FILE_PATHS /james/families/REL/analyses/AUNT/trait 
FILE_PATHS /james/families/FATHER/analyses/trait 
```

从这个文件路径列表中，我想提取文件名“MOTHER”、“SIB”、“REL”、“FATHER”的特定部分，然后如果这部分等于“SIB”打印“BROTHER” ，如果等于“REL”打印“AUNT”，否则（对于“MOTHER”和“FATHER”）打印“MOTHER”和“FATHER”。唯一路径与其他文件不同的文件是第 4 个字段中等于“SIB”和“REL”的文件，但复杂的是，第 6 个字段的值可能有很多选项，所以我我正在寻找一种解决方案，我不需要在第 6 个字段中指定“BROTHER”和“AUNT”的值，但这只会打印我的第 6 个字段。

所以它会是这样的：

```
cat file.txt | while read line; do
if [ `echo "$line" | grep ^FILE_PATHS file.txt | cut -d' ' -f 2 | cut -d '/' -f4 -eq "BROTHER" | "REL" `  ]

then
    grep ^FILE_PATHS file.txt | cut -d' ' -f 2 | cut -d '/' -f5
else
    grep ^FILE_PATHS file.txt | cut -d' ' -f 2 | cut -d '/' -f4
fi; done 
```

这充满了错误和不正确，但也许我有错误的方法，我确信有一种聪明的方法可以做到这一点，但我对 BASH 完全陌生，有没有更好的方法我没有看到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:11:19.720

`sed`只需捕获倒数第二个目录即可轻松使用：

```
$ sed -r '/^FILE_PATHS/s#.*/(\w+)/.*#\1#' file
MOTHER
BROTHER
AUNT
FATHER 
```

**编辑：**如果它并不总是倒数第二个目录：

```
$ grep "^FILE_PATHS" file | egrep -o "(MOTHER|BROTHER|AUNT|FATHER)"
MOTHER
BROTHER
AUNT
FATHER 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T13:58:47.387

这应该适合你

```
your grep....|awk -F/ '{$4=$4=="REL"?"AUNT":$4;$4=$4=="SIB"?"BROTHER":$4;print $4}' 
```

实际上，您可以将 grep 组合到 awk 中，例如：

```
awk -F/ '/^FILE_PATHS/{$4=$4=="REL"?"AUNT":$4;$4=$4=="SIB"?"BROTHER":$4;print $4}' file.txt 
```

您的示例的输出：

```
MOTHER
BROTHER
AUNT
FATHER 
```

展示它是如何工作的：

```
kent$  cat o
FILE_PATHS /james/families/MOTHER/analyses/trait 
FILE_PATHS /james/families/SIB/analyses/BROTHER/trait 
FILE_PATHS /james/families/REL/analyses/AUNT/trait 
FILE_PATHS /james/families/FATHER/analyses/trait

kent$  awk -F/ '/^FILE_PATHS/{$4=$4=="REL"?"AUNT":$4;$4=$4=="SIB"?"BROTHER":$4;print $4}'  o
MOTHER
BROTHER
AUNT
FATHER 
```

**再次编辑**

> 如果第三个字段的值是 SIB 或 REL 我想打印第五个字段中的任何内容

我会说它应该是第 4 个字段是 SIB/REL，然后打印第 6 个。因为第一个字段是 FILE_PATHS。

现在这条线有效：

```
 awk -F/ '/^FILE_PATHS/{$4=$4~"^(REL|SIB)$"?$6:$4;print $4}' file.txt 
```

测试！！：

```
kent$  cat o
FILE_PATHS /james/families/MOTHER/analyses/trait 
FILE_PATHS /james/families/SIB/analyses/BROTHER/trait 
FILE_PATHS /james/families/REL/analyses/AUNT/trait 
FILE_PATHS /james/families/FATHER/analyses/trait

kent$  awk -F/ '/^FILE_PATHS/{$4=$4~"^(REL|SIB)$"?$6:$4;print $4}' o
MOTHER
BROTHER
AUNT
FATHER 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T17:08:15.950

这假设您没有任何大写字母，除了您要查找的单词：

```
sed '/^FILE_PATHS/!d; s/^FILE_PATHS//; s/[^A-Z]//g; s/^SIB\|REL//' filename 
```

# database - CodeIgniter Active Record 与常规查询

> ID：14523186
> 
> 赞同：6
> 
> 时间：2013-01-25T13:55:12.840
> 
> 标签：database, codeigniter, activerecord

目前我将 CodeIgniter 与常规查询一起使用，即：

```
$sql = "
    SELECT *
    FROM my_table
    WHERE item_id > 1
";    
$q = $this->db->query($sql); 
```

我已经开始研究 ActiveRecord，它看起来确实不错，并且无论使用哪个数据库驱动程序都具有构建查询的优势 - 但是，我通常每个项目都严格使用单个数据库类型，所以这并不是真正的对我有利。

我发现常规查询（正如我在我的示例中所做的那样）在我看来更具可读性和更容易维护，因此我目前正在考虑保持常规查询。

除了上面提到的原因，我应该选择哪个，以及出于什么原因？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T15:02:39.483

对我来说，我更喜欢运行常规查询，CI 的活动记录会消耗大量内存。因为它会将所有结果加载到内存中。如果你明白我的意思。至于复杂性，最好使用常规查询而不是坚持 CI 的活动记录语法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-28T02:08:59.617

在大多数情况下，我倾向于更喜欢 ActiveRecord。我发现它更具可读性，并且它使构建动态查询变得更加容易，因为您不必费力地将原始 SQL 块显式连接在一起。这意味着我可以毫不费力地将各种条件添加到我的查询构建器中，并得出一些非常容易阅读的东西。

在某些情况下，ActiveRecord 的 CodeIgniter 实现非常不适合（这让我想念 Doctrine），我为此使用直接 SQL，但这种情况并不经常发生。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-25T14:21:19.303

好吧，对于您厌倦了编写 SELECT blah blah 的简单查询，您可以使用活动记录稍微改变您的样式，因为在编写常规查询时，您很可能会出现语法错误。活动记录就是为此目的而设计的，除非您是专家，否则您不需要编写通常出错的可能性很高的语法。活动记录也提供了逃生设施。您不熟悉活动记录，它们（简单时）也是可读的。看看这个例子

```
$array  =   array(
        'user.username',
        'user.email',
        'user.password',
        'other.blah',
        'other.blah'
);
$where  =   array(
        'active'    =>  1,
        'other'     =>  'blahblah'
);  

return $this->db
        ->select($array)
        ->from('user')
        ->join('other','other.user_id = user.id','left')
        ->where($where)
        ->get()
        ->result(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-11-09T14:46:51.220

差不多两年后，我发现了这个问题。我的一些同事已经回答了几个优点或缺点，我只是想根据我的个人经验补充一点意见：

正如有人所说，我也混合了使用活动记录和纯直接 sql 用于非常复杂的查询，原因是当您需要一个接收大量操作系统参数并相应更改查询的方法时使用它非常简单。例如，我有一个方法可以接收一个名为“options”的参数数组：

```
if(!empty($options['login']))
{
    $this->db->where('tl.login', $options['login']);
}
if(!empty($options['ip']))
{
    $this->db->where('tl.ip', $options['ip']);
}
if(!empty($options['sucesso']))
{
    $this->db->where('tl.sucesso', $options['sucesso']);
}

if(isset($options['usuarios_existentes']) && $options['usuarios_existentes'])
{
    $this->db->join('usuario u', 'tl.login = u.login');
}
else
{
    $this->db->join('usuario u', 'tl.login = u.login', 'LEFT');
}

if(!empty($options['limit']))
{
    $this->db->limit($options['limit']);
}
else
{
    $this->db->limit(50);
}

return $this->db->select('tl.id_tentativa_login, tl.login, DATE_FORMAT(tl.data, "%d/%m/%Y %H:%i:%s") as data, tl.ip, tl.sucesso', FALSE)
                ->from('logs.tentativa_login tl')
                ->order_by('tl.data', 'DESC')
                ->get()->result(); 
```

当然这只是一个简单的例子，但是我已经构建了具有数百行和条件的方法，可以更改通用的“get”方法，并且活动记录使它非常好并且非常易读，因为您不需要在中间编写代码它以正确格式化查询。

您甚至可以有连接和其他可以有条件的东西，因此您可以使用通用的集中式方法，这样可以避免重写大部分代码并复制其中的一部分（对于维护来说很糟糕），它不仅可读，而且可以保持您的查询速度很快，因为只加载您需要的内容：

```
if(!empty($opcoes['com_maquina']))
{
    if(strtoupper($opcoes['com_maquina'])=='SIM')
    {
        $this->db->join('maquina m', 'm.id_local = l.id_local');
    }
    elseif(strtoupper($opcoes['com_maquina'])=='NAO')
    {
        $this->db->join('maquina m', 'm.id_local = l.id_local', 'LEFT');
        $this->db->where('m.id_maquina IS NULL');
    }
} 
```

activerecord 的另一个优点是它在语句中接受纯 SQL，如子查询和其他内容，因此您可以随意使用它。

我说的是优点，但是很明显纯 SQL 总是会执行得更快，并且不会有调用函数的开销。但说实话，大多数情况下php解析器会做的很快，不会以一种表现力的方式影响最终结果，如果你必须做很多手动条件，你的代码可能和activerecord一样慢无论如何解析器。

请注意，有时 activerecord 查询不会按您期望的方式工作，因为它会尝试以编程的逻辑方式构建查询，因此例如在使用“OR”语句时要小心，大多数时候您必须隔离它（和）：

```
$this->db->where('(m.ultimo_status < DATE_ADD(NOW(), INTERVAL -2 HOUR) OR m.ultimo_status IS NULL)'); 
```

如果不添加 ( )，OR 语句将影响整个 where 子句。所以，一旦你习惯了 activerecord，它可以提供很多帮助，并且仍然可以进行快速且可读的查询。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-01-25T13:59:55.577

好吧，我的主要原因是它运行快速且安全。因为它会自动转义值等。但是当涉及到复杂的查询时，我建议使用普通的查询字符串。

（不是在谈论连接等。因为 codeigniter 支持它并且可读性很好）更像是枢轴查询，或者按行号选择（如下所示）

```
$query = $this->db->query('SELECT * FROM
  (SELECT  @row := @row + 1 as row, t.*
   FROM `default_red_albums` t, (SELECT @row := 0) r) AS view
WHERE `row` IN(' . $in . ')');

return $query->result(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-07T08:55:30.907

ActiveRecord 并不总是按照您想要的顺序生成查询，这可能会导致不可预知的结果。例如，这个模型：

```
 $this->db->select('page, content');
        $this->db->from('table');
        $array = array('title' => $searchq, 'content' => $searchq);
        $this->db->or_like($array, 'both'); 
        $this->db->where('showsearch', 'Yes'); 
        return $this->db->count_all_results(); 
```

产生这个查询：

```
 SELECT COUNT(*) AS `numrows`
        FROM (`table`)
        WHERE `showsearch` =  'Yes'
        AND  `title`  LIKE '%term%'
        OR  `content`  LIKE '%term%' 
```

但是我希望在查询`showsearch`结束时进行检查，这就是为什么我首先把它放在那里的原因。但是 ActiveRecord 将它移动到查询的中间，我得到的结果不准确。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-15T17:23:24.390

使用对象模型进行查询有很大的好处。虽然您可以执行字符串解析和连接以针对多个函数构建查询，但这非常耗时且极易出错。使用对象模型，您可以传递引用并继续构建查询或在执行前将其传递给预处理器。

一个人为的示例可能是自动将日期过滤器添加到具有 creation_date 字段的表的所有查询中。

CI 还允许您将原始 SQL 与对象模型很好地混合。基本上，您构建了一个自定义查询，该查询将结果返回给水合物对象。

# c# - 计算机关闭时 Windows Service OnStop

> ID：14523192
> 
> 赞同：9
> 
> 时间：2013-01-25T13:55:30.790
> 
> 标签：c#, windows-services

我正在用 C# 编写一个 Windows 服务。我想在服务控制面板停止服务时采取与系统关闭时相同的操作。我想对这两种情况采取相同的行动。

我必须覆盖`ServiceBase.OnShutdown()`，还是`ServiceBase.OnStop()`两种情况都覆盖就足够了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T14:03:48.503

是的。`OnStop()`当机器关闭时被调用。`OnShutdown()`用于当您需要特别知道机器正在关闭时。

**更新：** 正如自首次发布以来的评论中所指出的那样，情况不再如此。所以你的代码应该假设`OnStop()`在机器关闭时可能会或可能不会被调用。如果您需要在关机期间进行清理，请处理`OnShutdown()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-12-14T16:39:41.063

覆盖`OnShutdown`是正确的方法。`OnStop`关机期间不调用。

Microsoft Windows 添加了一个名为的选项，该选项`Fast Startup`实际上不会关闭计算机。

如`Fast Startup`设置说明中所述，`Restart`不受影响。这就是为什么`Restart`触发`OnShutdown`和`Shutdown`不触发的原因。

关闭将同时`Fast Startup`触发和。`OnShutdown``Restart``Shutdown`

[![电源选项系统设置](../Images/d3106b80aedf8d45b2f007584e6618ae.png)](https://i.stack.imgur.com/wOYKT.png)

# asp.net - 在自动索引主键中插入查询

> ID：14523194
> 
> 赞同：1
> 
> 时间：2013-01-25T13:55:31.880
> 
> 标签：asp.net, sql, vb.net

我有一个名为 WorkPerUser 的表，其中包含以下列：

```
id  int 
username    nchar(50)
RMANumber   int
Charge  real 
```

“id”是自增1的主键。

我背后的代码是：

```
 Protected Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnSubmit.Click

        'Dim temp_id As String
        'temp_id = Session("se_userid")

        'SQL connection String and Query 

        Dim connectionString As String = ConfigurationManager.ConnectionStrings("ConnectionString").ConnectionString
        Dim insertSql As String = "INSERT INTO [WorkPerUser] (id,username,RMANumber,Charge)" & " values (@id,@username,@rmanumber,@charge)"

        'Create SQL connection
        Dim con As New SqlConnection(connectionString)

        'Create SQl command and parameters
        Dim cmd As New SqlCommand()
        cmd.Connection = con
        cmd.CommandType = CommandType.Text
        cmd.CommandText = insertSql

        Dim id As New SqlParameter("@id", SqlDbType.Text)
        id.Value =
        cmd.Parameters.Add(id)

        Dim username As New SqlParameter("@username", SqlDbType.NChar)
        username.Value = Session("userName")
        cmd.Parameters.Add(username)

        Dim rmanumber As New SqlParameter("@rmanumber", SqlDbType.Int)
        rmanumber.Value = txtRMA.Text.ToString()
        cmd.Parameters.Add(rmanumber)

        Dim charge As New SqlParameter("@charge", SqlDbType.Real)
        charge.Value = txtCharge.Text.ToString()
        cmd.Parameters.Add(charge)

        Try
            con.Open()
            cmd.ExecuteNonQuery()
            lblMsg.Text = "Job Inserted"
        Catch ex As SqlException
            Dim errorMessage As String = "Error registering job"
            errorMessage += ex.Message

            Throw New Exception(errorMessage)
        Finally
            con.Close()
        End Try

    End Sub 
```

正如您可能已经注意到的那样，我留下了 `id.Value =`空白，因为我不知道要向数据库发送什么。查询或其他地方是否需要更改任何内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:02:47.613

如果 Id 确实是一个自动增量（身份）列，则您不必手动插入它。只需省略 Id 部分

```
Dim insertSql As String = "INSERT INTO [WorkPerUser] (username,RMANumber,Charge)" & " values (@username,@rmanumber,@charge)" 
```

您不必指定 ID。您可能想要获取最后插入的 ID。它通常是通过的`SELECT SCOPE_IDENTITY()`，这对于内联 SQL 来说很棘手。

检查这些链接：

*   [如何获取最后插入的 id？](https://stackoverflow.com/questions/5228780/how-to-get-last-inserted-id)
*   [如何使用单个 SqlCommand 插入记录并返回新创建的 ID？](https://stackoverflow.com/questions/330707/how-to-insert-a-record-and-return-the-newly-created-id-using-a-single-sqlcommand)

# jquery - 如何为 Colorbox-Images 定义额外的动态链接？

> ID：14523195
> 
> 赞同：0
> 
> 时间：2013-01-25T13:55:37.420
> 
> 标签：jquery, colorbox

我有一个单页纸，里面有很多图片和一些画廊。当点击图像时，它们会被触发以显示在颜色框叠加层（使用 Drupal、颜色框插件）中。到目前为止一切顺利，工作得很好。

现在我想在图像和画廊上附加额外的图标（为了冗余），以便在颜色框中打开这些图像。

对于我的测试库，我得到了这个工作：

```
<script>
(function($){
    $('.field-name-field-slideshow-trigger').append('<div id="bgShowOverlay"></div>').css("cursor","pointer");
            $('#bgShowOverlay').click(function() {
                $("a[rel='gallery-all']").colorbox({open:true});
             });
})(jQuery);
</script> 
```

现在对于单个图像（没有画廊），我需要以某种方式为动态创建的图像链接指定它。我不知道如何构建这部分

```
$('#bgImageOverlay').click(function() {
                $("a[rel=?????]").colorbox({open:true});
             }); 
```

让它与我的图像一起工作，这些图像具有这样的 rel 属性：

```
rel="gallery-field_collection_item-60" 
```

我希望我的问题足够清楚，请原谅我的英语不好。任何帮助都非常感谢！

编辑：

我发现

> “一个[rel ='所有画廊']”

当我的单页机上有多个画廊时，它不起作用（就像我预期的那样）。画廊中的所有图像都显示在我在颜色框中打开的图像中。

我正在寻找一种方法来对链接进行某种区分。

我如何形成脚本，它将动态创建的画廊考虑在内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T06:40:26.380

这也许？

```
$("a[rel^=gallery]").colorbox({open:true}); 
```

我对您如何布置事情以给出明确的答案并没有足够清晰的了解。

# facebook - Facebook粉丝盒被窃听

> ID：14523196
> 
> 赞同：1
> 
> 时间：2013-01-25T13:55:37.770
> 
> 标签：facebook, facebook-graph-api

我在一个网站上有一个自定义的 fanbox，它工作正常，但是当我今天看到它被窃听时，facebook 是否更改了 api 或什么？

我没有自己构建它，我只是让它从另一个站点工作，它调用我在我的 FTP 上的一个 css。你可以在页面底部的 www.shoppingdifusora.com.br 处查看错误。

我把所有的脸都放在一起，没有边距，更小（也没有名字），既没有边界也没有找到我们..有人可以帮我吗？

这里的html：

```
<div id="facebook">
                        <a href="http://www.facebook.com/ShoppingDifusora" title="Ir para o facebook" rel="external"></a>
                        <fb:fan profile_id="408396085874237" connections="21" width="300" height="205" show_faces="true" stream="false" header="false" css="http://www.shoppingdifusora.com.br/site/assets/stylesheet/facebook.css?25"></fb:fan>
                    </div> 
```

js：

```
<script>
        window.fbAsyncInit = function() {
                FB.init({
                appId: '145103648914101',
                cookie: true,
                xfbml: true,
                oauth: true
            });

            FB.Event.subscribe('auth.login', function(response) {
                window.location.reload();
            });

            FB.Event.subscribe('auth.logout', function(response) {
                window.location.reload();
            });
        };
    </script>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/pt_BR/all.js#xfbml=1&appId=168546436606787";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:52:51.977

FB fanbox 是一种添加插件的旧方法，它允许通过添加您自己的 css 表来进行更多自定义。

看起来 Facebook 已经更新了他们的代码，以便粉丝盒现在显示他们的标准框。它的造型灵活性要小得多。我建议您查看 FB 文档：[https ://developers.facebook.com/docs/reference/plugins/like-box/](https://developers.facebook.com/docs/reference/plugins/like-box/)

您需要用更新的likebox 代码替换您的fanbox 代码以纠正此问题。

# java - 休眠验证器。如何使用@Valid 注释？

> ID：14523201
> 
> 赞同：9
> 
> 时间：2013-01-25T13:55:53.070
> 
> 标签：java, hibernate-validator

`@Valid`将注释放在方法参数级别时，注释的目的是什么？

```
public void (@Valid Person p) { ... } 
```

我创建了一个测试，并将无效对象传递给此方法，但没有任何反应。
我希望得到一个例外。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-25T14:33:25.833

对象上的 @`Valid`注释指示验证框架处理带注释的对象。当用于方法的参数时，这称为***方法级别验证***。请注意，方法级别验证***不是***核心规范的一部分，实际上仅在将 Bean Validation 集成到容器类型框架（JSF、CDI、Java EE）中时才支持。当 Bean Validation 集成到这样的支持容器中时，会发生这样的情况，即在 bean 上调用生命周期方法时，容器会检测方法参数上的 JSR 303 注释并触发关联 bean 的验证。

例如，如果您在 JAX-RS 资源类中有以下方法定义：

```
@Path("/example")
public class MyExampleResourceImpl {

    @POST
    @Path("/")
    public Response postExample(@Valid final Example example) {
        // ....
    }
} 
```

当`postExample`响应由 JAX-RS 容器处理的请求而调用该方法时，`example`将验证 bean。将此行为与运行独立 Java SE 应用程序会发生的情况进行对比：

```
public class MyMainClass {
    public static void main(final String[] args) {
        final MyMainClass clazz = new MyMainClass();
        clazz.echo(new Example());
    }

    public Example echo(@Valid final Example example) {
        // ...
    }
} 
```

在这种情况下，即使您包含所有 JSR 303 运行时 JAR ，运行程序也***不会***触发参数验证。`Example`这是因为没有可用的容器来实现方法级别的验证。[Bean Validation Specification](http://download.oracle.com/otn-pub/jcp/bean_validation-1.0-fr-oth-JSpec/bean_validation-1_0-final-spec.pdf)在附录 C 中详细描述了所有这些内容。为了您的利益，我在下面引用了其中的一些内容：

> ***方法级验证建议***
> 
> 该命题尚未集成到核心规范中，也不是其中的一部分。出于考古目的，它保留在这里，并将认真考虑用于本规范的未来修订。这个提议可能与规范的其余部分有点不同步。
> 
> 注意：*Bean Validation 提供者可以自由地将这个提议作为一个特定的扩展来实现。例如，可以通过使用 Validator.unwrap 方法访问此类特定扩展。*
> 
> 一个流行的需求是提供一种方法和参数级别的验证机制，以重用规范的约束描述。这组 API 旨在供拦截器框架使用，例如：
> 
> *   应用程序框架，如
>     *   JSR-299
> *   Enterprise Java Beans 等组件框架
> *   基于方面的框架
> 
> 当调用此类方法时，这些框架可以调用验证 API 来验证方法的参数列表或返回值。更准确地说，验证发生在方法调用周围。Bean Validation API 的此扩展允许重用核心引擎以及此类方法级别验证的约束定义和声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:00:32.547

其目的是根据定义的约束验证对象。

从[**休眠文档**](http://docs.jboss.org/hibernate/validator/4.2/reference/en-US/html/validator-usingvalidator.html#validator-usingvalidator-validate)

> 对关联对象递归执行验证。如果对象是集合或数组，则递归验证元素。如果对象是映射，则递归验证值元素。

这可能会帮助[http://www.mkyong.com/spring-mvc/spring-3-mvc-and-jsr303-valid-example/](http://www.mkyong.com/spring-mvc/spring-3-mvc-and-jsr303-valid-example/)

# c# - 无法使用 Javascript 在 raddatepicker 中显示 coreect 日期

> ID：14523205
> 
> 赞同：0
> 
> 时间：2013-01-25T13:56:03.423
> 
> 标签：c#, calendar, telerik, rad-controls, telerik-radinput

我从服务器端获取日期值并将其传递给**javascript**方法，然后我使用**Javascript**`RadDatePicker`将日期分配给 Telerik控件。

 **我正在约会

```
var Date1="25/01/2013 00:00:00";
function SetDate(Date1)
{
     var datepicker = $find("<%= RadDatePicker1.ClientID %>"); 
     var cusDate=new date(Date1); 
     datepicker.SetDate(cusDate);
} 
```

在这里，我得到的日期是**1/4/2014**而不是**25/1/2013**。我无法显示日期`raddatepicker`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T07:00:33.767

Try this.

```
 var datepicker = $find("<%= RadDatePicker1.ClientID %>"); 
    datepicker.set_selectedDate(cusDate); 
```**

# java - 如何在 iText 中创建一个带有感叹号的圆圈？

> ID：14523206
> 
> 赞同：1
> 
> 时间：2013-01-25T13:56:04.940
> 
> 标签：java, itext

作为警告符号的一种形式，我想在一个实心圆圈内添加一个感叹号作为pdf的图形，尽管我还没有成功。帮助将不胜感激！

作为后续问题：我如何将这样的符号放在 PdfPTable 单元格的右下角？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:41:02.043

您听起来好像实际上希望将该符号作为某种字体中的字符，以便能够像处理任何其他字符一样处理它。

如果这是正确的，您可能希望使用该字符创建 Type 3 字体。您可以使用 iText 做到这一点，参见。第 11.3.2 节[iText in Action - 2nd Edition的](http://itextpdf.com/book/)*Type 3 字体*，尤其是示例[Type3Example.java](http://itextpdf.com/examples/iia.php?id=200)，其中两个符号 Delta 和 Sigma 被创建为 Type 3 字体中的字符，然后使用。

最重要的部分，人物的创造，是这样的：

```
Type3Font t3 = new Type3Font(writer, true);
// Delta
PdfContentByte d = t3.defineGlyph('D', 600, 0, 0, 600, 700);
d.setColorStroke(new BaseColor(0xFF, 0x00, 0x00));
d.setColorFill(new GrayColor(0.7f));
d.setLineWidth(100);
d.moveTo(5, 5);
d.lineTo(300, 695);
d.lineTo(595, 5);
d.closePathFillStroke();
//Sigma
PdfContentByte s = t3.defineGlyph('S', 600, 0, 0, 600, 700);
s.setColorStroke(new BaseColor(0x00, 0x80, 0x80));
s.setLineWidth(100);
s.moveTo(595,5);
s.lineTo(5, 5);
s.lineTo(300, 350);
s.lineTo(5, 695);
s.lineTo(595, 695);
s.stroke();

// Use as regular font at size 12
Font f = new Font(t3, 12); 
```

您所要做的就是使用线条、曲线、圆...创建符号

# ruby-on-rails-3 - Rails 上的 POST/DELETE 请求在 Heroku 上寻找不应该出现的视图。在本地完美工作

> ID：14523208
> 
> 赞同：0
> 
> 时间：2013-01-25T13:56:10.257
> 
> 标签：ruby-on-rails-3, heroku, ruby-on-rails-3.2, railstutorial.org

我在 Rails 应用程序的用户索引页面上有一个用户列表，其想法是登录的用户可以通过单击其名称旁边的“开始友谊”按钮与其他用户建立友谊。这会在友谊表中添加一条记录。

该过程在本地托管时完美运行。这使用 SQLite（虽然我不认为这是数据库问题），日志如下所示：

```
Started POST "/friendships" for 127.0.0.1 at 2013-01-25 12:48:16 +0000
Processing by FriendshipsController#create as HTML
Parameters: {"utf8"=>"✓", "authenticity_token"=>"P5qQAuaSD1SNkgLDI6yQ2h9GhJjAub7l7On3+ZGBwiY=", "friendship"=>{"befriended_id"=>"16"}, "commit"=>"Start Friendship"}
User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."remember_token" = 'eL_PfKhO9ZnYTxXTPo9UiQ' LIMIT 1
User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."id" = ? LIMIT 1  [["id", "16"]]
(0.0ms)  begin transaction
SQL (0.6ms)  INSERT INTO "friendships" ("befriended_id", "befriender_id", "confirmed", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)  [["befriended_id", 1], ["befriender_id", 16], ["confirmed", false], ["created_at", Fri, 25 Jan 2013 12:48:16 UTC +00:00], ["updated_at", Fri, 25 Jan 2013 12:48:16 UTC +00:00]]
(1.4ms)  commit transaction
Redirected to http://localhost:3000/users
Completed 302 Found in 9ms (ActiveRecord: 2.3ms) 
```

但是，当我在 Heroku 上托管的应用程序版本（使用 PostgreSQL）上执行相同操作时，我得到了臭名昭著的“我们很抱歉，但出了点问题（500）”错误。查看日志，似乎它正在寻找一个不存在的视图，但我不知道它为什么要寻找它。以下是日志：

```
2013-01-25T12:45:39+00:00 app[web.1]: Started POST "/friendships" for 79.97.21.43 at 2013-01-25 12:45:39 +0000
2013-01-25T12:45:39+00:00 heroku[router]: at=info method=POST path=/friendships host=meetflag.herokuapp.com fwd=79.97.21.43 dyno=web.1 queue=0 wait=0ms connect=1ms service=135ms status=500 bytes=643
2013-01-25T12:45:39+00:00 app[web.1]: 
2013-01-25T12:45:39+00:00 app[web.1]: ActionView::MissingTemplate (Missing template friendships/create, application/create with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}. Searched in:
2013-01-25T12:45:39+00:00 app[web.1]:   * "/app/app/views"
2013-01-25T12:45:39+00:00 app[web.1]: ):

--- (then there's the list of where it's looked) ---

2013-01-25T12:45:39+00:00 app[web.1]: Processing by FriendshipsController#create as HTML
2013-01-25T12:45:39+00:00 app[web.1]:   Parameters: {"utf8"=>"✓",  "authenticity_token"=>"n+LI+Br3ahg5FxhNUm2u0b5YcqZGKpfeK7c3vJLkMyU=", "friendship"=>{"befriended_id"=>"2"}, "commit"=>"Start Friendship"}
2013-01-25T12:45:39+00:00 app[web.1]: Completed 500 Internal Server Error in 86ms 
```

它甚至似乎没有达到数据库的程度。我已经尝试将 coffee-rails gem 从资产中移到 Gemfile 的主体中（如此处所述[）](https://stackoverflow.com/questions/7464900/what-needs-to-be-configured-for-heroku-to-handle-templates-based-on-coffeescript)，根本没有 haml gem（如此处所述[）](https://stackoverflow.com/questions/10366394/rails-heroku-were-sorry-but-something-went-wrong?rq=1)并且我的 rake db 东西似乎正确（如[这里](https://stackoverflow.com/questions/9017668/heroku-500-internal-server-error)提到）。

Friendships 控制器如下所示：

```
class FriendshipsController < ApplicationController
    before_filter :signed_in_user, only: [:create, :update, :destroy]
    respond_to :html, :js

    def create
        @user = User.find(params[:friendship][:befriended_id])
        @user.start_friendship!(current_user)
        respond_with(@user, location: request.referer)
    end

    def destroy
        @user = Friendship.find(params[:id]).befriended
        current_user.end_friendship!(@user)
        respond_with(@user, location: request.referer)
    end

    def update
        @user = Friendship.find(params[:id]).befriended
        current_user.confirm_friendship!(@user)
        respond_with(@user, location: request.referer)
    end
end 
```

有没有人知道可能出了什么问题以及如何解决？应用程序的其余部分工作正常！

提前感谢您提供的任何帮助。

**更新**

只是为了提供更新——我在本地安装了 PostgreSQL，以确保它与此无关。不是。即使在生产中，它在本地托管时也能正常工作。正如我所说，我认为问题在于它甚至没有进入数据库部分。

**进一步更新**

问题似乎是它试图渲染一个没有要渲染的视图的视图。我已经尝试摆脱 /app/views/friendships/ 中的 .js.erb 文件，以允许按钮使用 Ajax，但这并没有任何好处（我很高兴现在没有 Ajax） . 我可以放入一个 .html.erb 视图，但我不想要一个（我只是希望它返回到用户索引页面）......虽然如果我不能想出任何其他解决方案，我可以尝试它，只是为了看看它是否有效。

PS 我对之前的控制器进行了重构，所以上面展示了新版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T16:58:42.310

是的，我已经让它工作了，但是，至少在我看来，没有充分的理由说它现在有效而以前没有。

为了让它工作，我在 production.rb 文件中启用了调试级日志记录，方法是将以下几行放入：

```
config.log_level = :debug
config.cache_classes = false                                                                                                                                                 
config.action_controller.perform_caching = false 
```

（一定要更改`config.cache_classes = true`文件顶部的）

并将一些`puts`语句放入控制器中：

```
puts "Current user:" + current_user.name
puts "@user: " + @user.name
puts "Start Friendship called. Referrer: " + request.referer 
```

（我只是想获取一些信息）。

令人惊讶的是它有效。如果有人知道为什么会这样，请在此处发布。我很高兴它做到了！

# android - 将按钮浮动到左侧

> ID：14523209
> 
> 赞同：0
> 
> 时间：2013-01-25T13:56:12.873
> 
> 标签：android, actionbarsherlock

我已将 ABS 添加到我的项目中，并且我想在此操作栏的最左侧添加一个按钮。通过这样做，我设法在右侧添加了一个按钮：

```
@Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getSupportMenuInflater();
        inflater.inflate(R.menu.actionbarmenu, menu);
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {

        switch(item.getItemId()) {

        case R.id.menuSlider:
            initializeSlideMenu();
            break;
        }

        return false;
    } 
```

当用户按下此按钮时，屏幕上会出现一个滑块菜单。但我希望将此按钮放置在操作栏的左侧。我需要设置一些 XML 属性吗？我在 Google 上找不到任何关于此的内容。也许我用错误的搜索键进行了搜索。

向应用程序图标添加操作，请参见下图：

![在此处输入图像描述](../Images/84a03118727d5e613ff11531bfbe89a6.png)

谢谢！

**编辑**

我试过这个：

```
@Override
    public boolean onOptionsItemSelected(MenuItem item) {

        switch(item.getItemId()) {

        case R.id.menuSlider:
            initializeSlideMenu();
            break;
        case android.R.id.home:
            initializeSlideMenu();
            break;
        }

        return super.onOptionsItemSelected(item);
    } 
```

第一种`case`工作正常，但第二种情况不会触发幻灯片菜单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:32:47.037

这是您如何设置向上按钮的操作，但请在为向上按钮设置自定义操作之前阅读此内容：http: [//developer.android.com/design/patterns/navigation.html#up-vs-背部](http://developer.android.com/design/patterns/navigation.html#up-vs-back)

```
@Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            case android.R.id.home:
                // This is called when the Home (Up) button is pressed in the Action Bar.
        }
        return super.onOptionsItemSelected(item);
    } 
```

在此之前，您必须启用此代码段（将其添加到`onCreate`您的活动方法中）：

```
getSupportActionBar().setDisplayHomeAsUpEnabled(true); 
```

编辑：只需重新阅读问题，显示 SliderMenu 就可以了。不过，不要破坏设计指南。

# android - 如何检查主屏幕网格 4x4 或 4x5 或其他？

> ID：14523210
> 
> 赞同：0
> 
> 时间：2013-01-25T13:56:13.657
> 
> 标签：android, widget, grid, homescreen

我有主屏幕小部件，我想向它添加尺寸 *x5。但我不希望主屏幕网格小于 5x5 的用户可以在小部件列表中看到这种类型的小部件。

如何检查主屏幕的网格大小？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:00:00.430

> 如何检查主屏幕的网格大小？

你不能。主屏幕甚至不必有网格系统。

# algorithm - 时间段不一致的平滑值

> ID：14523211
> 
> 赞同：1
> 
> 时间：2013-01-25T13:56:17.093
> 
> 标签：algorithm, moving-average

我要解决的问题：计算数据点分布不均匀的某些数据系列的当前平均速度。例如，计算上传的当前速度，其中“上传数量”信号不均匀地到达：

*   t = 0，发送 = 0
*   t = 5，发送 = 10
*   t = 6，发送 = 12
*   t = 9，发送 = 20

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:04:12.540

```
(last - first) / (time delta between first and last) 
```

这*正是*平均速度。

除非您忘记告诉我们一些细节，否则您不需要中间的数据点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:02:13.980

您可以通过获取新值和先前值的增量来计算每个时间单位的平均值。

如果你想要多个点的平均值，你可以计算几个点之间的平均值，然后取这些平均值的平均值。

例如：

```
Current average:
t34       =  9 -  6 = 3
sent34    = 20 - 12 = 8
average34 = 8 / 3 = 2.67

Average of last two time slots:
t23       =  6 -  5 = 1
sent23    = 12 - 10 = 2
average23 = 2 / 1 = 2

average234 = (2 + 2.67) / 2 = 2.33 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:04:22.617

只需重新调整最新结果

**以你为例：**

```
t = 0, sent = 0
t = 5, sent = 10
t = 6, sent = 12
t = 9, sent = 20 
```

**当前速度 = (20 -12) / (9 - 6) = 8/3 = 2.666666**

您可以使用不同的重新调整间隔大小来降低速度变化的速度（当连接“丢失”“恢复”时）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T15:45:27.290

从噪声数据计算速度的标准方法是应用[卡尔曼滤波器](http://en.wikipedia.org/wiki/Kalman_filter)。

# .net - .NET Convert 隐式可转换类型数组

> ID：14523213
> 
> 赞同：2
> 
> 时间：2013-01-25T13:56:21.757
> 
> 标签：.net, arrays, casting

假设我们有两种 ref 类型：`A`and `B`，并且 A 实现了隐式转换运算符（到 B）：

```
class A
{
    private B b;
    public static implicit operator B(A a) { return a.b; }
}
class B
{
} 
```

将数组转换为数组的最佳（简洁和/或快速）方法`A`是`B`什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T13:57:43.270

一件有效且相当直接的事情是使用 Linq：

```
A[] a = new A[5];//initialize elements
B[] b = a.Select(anA => (B)anA).ToArray(); 
```

但是使用 Linq 的 Cast<> 方法不起作用：（[看看为什么](https://stackoverflow.com/q/14523530/11545)）

```
B[] b2 = a.Cast<B>.ToArray();//throws InvalidCastException 
```

* * *

更新：这是一个不使用 Linq 的：

```
B[] b = Array.ConvertAll(a, elem => (B) elem); 
```

这可以在 pre-lambda .NET 2.0 中使用更详细的方法工作：

```
B[] b = Array.ConvertAll(a, 
            new Converter<A, B>(delegate(A elem) { return (B) elem; })); 
```

...并且可能使用较短的版本：

```
B[] b = Array.ConvertAll(a, delegate(A elem) { return (B) elem; }); 
```

# javascript - PrototypeJS/Javascript - 如何更新 Ajax 请求中的各种属性？

> ID：14523217
> 
> 赞同：0
> 
> 时间：2013-01-25T13:56:34.577
> 
> 标签：javascript, prototypejs

我有一个处理投票的原型代码。我单击箭头，JavaScript/原型代码正确处理它。

我现在的问题是我有一个带有标签的网站，并且同一篇文章的相同投票表格可能会在同一页面中显示两次或更多。由于脚本与 ID 一起使用，我遇到了问题。

我的问题是如何修改此代码以处理同一篇文章的相同投票表格在同一页面中可能不止一次？基本上我需要更新所有表单的属性。

原型代码：

```
//
// The VoteHijacker JS
//

var VoteHijacker = Class.create();
VoteHijacker.prototype =
{
    initialize: function(prefix)
    {
    console.log('this.prefix:' + this.prefix + ' prefix:' + prefix);
        this.prefix = prefix || "";
        this.registerEventHandlers();
    },

    registerEventHandlers: function()
    {
        $$("form." + this.prefix + "vote").each(function(form)
        {
            Event.observe(form, "submit", this.doVote.bindAsEventListener(this), false);
        }.bind(this));
    },

    doVote: function(e)
    {
        Event.stop(e);
        var form = Event.element(e);
        var id = /(\d+)$/.exec(form.id)[1];
        var action = /(up|down|clear)vote/.exec(form.action)[1];
        new Ajax.Request(form.action, {
            onComplete: VoteHijacker.processVoteResponse(this.prefix, id, action)
        });
    }
};

VoteHijacker.processVoteResponse = function(prefix, id, action)
{
    return function(transport)
    {
        var response = transport.responseText.evalJSON();
        if (response.success === true)
        {
            var upArrowType = "grey";
            var upFormAction = "up";
            var downArrowType = "grey";
            var downFormAction = "down";

            if (action == "up")
            {
                var upArrowType = "mod";
                var upFormAction = "clear";
            }
            else if (action == "down")
            {
                var downArrowType = "mod";
                var downFormAction = "clear";
            }

            VoteHijacker.updateArrow("up", prefix, id, upArrowType);
            VoteHijacker.updateArrow("down", prefix, id, downArrowType);
            VoteHijacker.updateFormAction("up", prefix, id, upFormAction);
            VoteHijacker.updateFormAction("down", prefix, id, downFormAction);
            VoteHijacker.updateScore(prefix, id, response.score);

        }
        else
        {
            alert("Erro a votar: " + response.error_message);
        }
    };
};

VoteHijacker.updateArrow = function(arrowType, prefix, id, state)
{
    var img = $(prefix + arrowType + "arrow" + id);
    var re = new RegExp("a" + arrowType + "(?:mod|grey)\\.png");
    img.src = img.src.replace(re, "a" + arrowType + state + ".png");
};

VoteHijacker.updateFormAction = function(formType, prefix, id, action)
{
    var form = $(prefix + formType + id);
    form.action = form.action.replace(/(?:up|down|clear)vote/, action + "vote");
};

VoteHijacker.updateScore = function(prefix, id, score)
{
    var scoreElement = $(prefix + "score" + id);
    scoreElement.innerHTML = score.score /*+ " point" + VoteHijacker.pluralize(score.score)*/;
    scoreElement.title = "after " + score.num_votes + " vote" + VoteHijacker.pluralize(score.num_votes);
};

VoteHijacker.pluralize = function(value)
{
    if (value != 1)
    {
        return "s";
    }
    return "";
}; 
```

的HTML：

```
<div class="upparrow">
    <form class="mainvote" id="mainup{{ main.id }}" action="/votarem/main/{{ main.id }}/{% if vote and vote.is_upvote %}clear{% else %}up{% endif %}vote?next=/" method="POST">
    <input type="image" id="mainuparrow{{ main.id }}" src="/media/images/aup{% if vote and vote.is_upvote %}mod{% else %}grey{% endif %}.png">
    </form>                             
</div>
<div class="actualvotes">
<span class="score" id="mainscore{{ main.id }}" title="depois de {{ score.num_votes|default:0 }} voto{{ score.num_votes|default:0|pluralize }}">
    {{ score.score|default:0 }}
</span>                                     
</div>
<div class="downarrow">
    <form class="mainvote" id="maindown{{ main.id }}" action="/votarem/main/{{ main.id }}/{% if vote and vote.is_downvote %}clear{% else %}down{% endif %}vote?next=/" method="POST">
        <input type="image" id="maindownarrow{{ main.id }}" src="/media/images/adown{% if vote and vote.is_downvote %}mod{% else %}grey{% endif %}.png">
    </form>                                 
</div> 
```

关于我应该怎么做来处理上面暴露的问题的任何线索？

PS：对不起我的英语。

此致，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T06:55:56.780

看起来您可以创建`VoteHijacker`类的多个实例，您只需要确保表单 ID 不同并且单独的实例指向正确的表单。

我猜当您创建实例时，您会这样做

```
new VoteHijacker('main'); 
```

这很容易更改为指向不同的表单，只需确保新表单的类与不同的实例调用匹配，并且表单 id 是唯一的，例如

将一组新的表单添加到具有 class`tab1`和 ids的页面`tab1up{{ main.id }}`，`tab1down{{ main.id}}`

# c# - \w 在使用常规解释时给我一个错误

> ID：14523218
> 
> 赞同：0
> 
> 时间：2013-01-25T13:56:37.400
> 
> 标签：c#, regex

我正在使用正则表达式，我试图写：

```
Regex RegObj2 = new Regex("\w[a][b][(c|d)][(c|d)].\w"); 
```

两次给我这个错误，每次出现一个`\w`：

```
unrecognized escape sequence 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T13:58:15.623

您没有`\`在非逐字字符串文字中转义 s 。

[解决方案：根据字符串文字](http://msdn.microsoft.com/en-us/library/362314fe%28v=vs.110%29.aspx)`@`的 C# 规则，在字符串前面放置 a或将反斜杠加倍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:58:23.580

尝试逃脱；）

```
Regex RegObj2 = new Regex("\\w[a][b][(c|d)][(c|d)].\\w"); 
```

或添加@（如@Dominic Kexel 建议的那样）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T14:00:38.397

编写正则表达式时需要两个级别的潜在转义：

*   正则表达式转义（例如转义括号，或者在这种情况下指定字符类）
*   C# 字符串文字转义

在这种情况下，是后者让你绊倒。*要么*转义 the`\`使其成为字符串的一部分，*要么*使用逐字字符串文字（带`@`前缀），这样`\`就没有其正常的转义含义。所以这些中的任何一个：

```
Regex regex1 = new Regex(@"\w[a][b][(c|d)][(c|d)].\w");
Regex regex2 = new Regex("\\w[a][b][(c|d)][(c|d)].\\w"); 
```

这两种方法在执行时是绝对等价的。在这两种情况下，您都在尝试使用值创建一个字符串常量

```
\w[a][b][(c|d)][(c|d)].\w 
```

这两种形式只是在 C# 源代码中表达这一点的不同方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T13:59:47.947

反斜杠没有被转义，例如`\\`或

```
new Regex(@"\w[a][b][(c|d)][(c|d)].\w"); 
```

# search - Elasticsearch 在一个查询中获得预定义类型的选择

> ID：14523222
> 
> 赞同：1
> 
> 时间：2013-01-25T13:56:48.430
> 
> 标签：search, lucene, elasticsearch

我有一个包含大量产品属性的 ElasticSearch 索引。他们都是这样的：

```
{'_id':1,'type':'manufacturer','name':'Toyota'},
{'_id':2,'type':'color','name':'Green'},
{'_id':3,'type':'category','name':'SUV Cars'},
{'_id':4,'type':'material','name':'Leather'},
{'_id':5,'type':'manufacturer','name':'BMW'},
{'_id':6,'type':'color','name':'Red'},
{'_id':7,'type':'category','name':'Cabrios'},
{'_id':8,'type':'material','name':'Steel'},
{'_id':9,'type':'category','name':'Cabrios Hardtop'},
{'_id':10,'type':'category','name':'Cabrios Softtop'},
... and 1 Mio. more ... 
```

现有 4 种不同类型的产品属性：类别、制造商、颜色和材料。

问题：我怎样才能**只用一个查询**（这是一个确定的性能要求）查询**每种类型的最佳匹配结果**？

因此，如果我请求全文搜索查询，即“Green Toyota Cabrios”，我应该得到以下结果：

```
{'_id':2,'type':'color','name':'Green'},
{'_id':1,'type':'manufacturer','name':'Toyota'},
{'_id':7,'type':'category','name':'Cabrios'},
{one matching result of the 'material'-type if found by the query} 
```

这将是完美的结果集，**总是最多 4 个结果（对于每个“类型”一个结果）**。如果**没有可用的特定类型的匹配结果，则应该只返回 3 个结果项**。

使用 Elasticsearch 怎么可能？谢谢你的想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:59:36.477

我不清楚你的用例。你实际上在索引什么？如果你索引汽车，你应该像这样索引它：

```
{
  "color": "Green",
  "manufacturer": "Toyota",
  "category": "Cabrios"
} 
```

也就是说，从你问的问题来看：

您可能可以将您的字段定义为 not_indexed。这样，如果您在“名称”字段中搜索“Green Toyota Cabrios”，您将不会得到“Cabrios Hardtop”。

不确定我是否真的回答了，但我没有看到您的用例...

# git - Git post-receive 钩子克隆和检出两个分支到两个单独的目录

> ID：14523223
> 
> 赞同：0
> 
> 时间：2013-01-25T13:57:03.127
> 
> 标签：git, hook, sh, githooks

我有一个 Git 存储库，我需要编写一个`post-receive`脚本，将两个分支检出到两个单独的目录中，然后执行一些操作。我有以下适用于一个分支的脚本，但我不确定如何编写脚本以检查两个分支。

```
#!/bin/sh

GIT_REPO="$HOME/oliverjash.me.git"
TMP_GIT_CLONE="$HOME/tmp/oliverjash.me"
PUBLIC_WWW="/var/www/oliverjash.me"

# Clone & Checkout a copy of this repository somewhere
git clone $GIT_REPO $TMP_GIT_CLONE

# Do other actions
cd $TMP_GIT_CLONE
compass compile -e $RAKE_ENV -c config.rb --force
jekyll $PUBLIC_WWW
cd $HOME
rm -rf $TMP_GIT_CLONE
exit 
```

请记住，除了变量之外，我需要对每个副本执行的“操作”都是相同的，当然——我真的很想避免重复代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:32:26.327

如果使用支持函数的 shell，您可以创建一个将克隆目录作为参数的函数。您只需调用该函数两次，每个克隆目录一次。（这是假设您的意思是**克隆**上面所说的**checkout** ，因为我在您的示例中没有看到*git checkout 。）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T18:04:11.423

它并不完美，但最后我想出了这个。

```
#!/bin/bash --login

GIT_REPO="$HOME/oliverjash.me.git"

source "$HOME/.bash_profile"

checkout () {
  BRANCH="$1"
  TMP_GIT_CLONE="$2"
  PUBLIC_WWW="$3"

  git clone $GIT_REPO $TMP_GIT_CLONE
  cd $TMP_GIT_CLONE
  git checkout $BRANCH
  compass compile -e $RAKE_ENV -c config.rb --force
  jekyll $PUBLIC_WWW
  cd $HOME
  rm -rf $TMP_GIT_CLONE
}

checkout master "$HOME/tmp/oliverjash.me" "/var/www/oliverjash.me"
checkout project "$HOME/tmp/project.oliverjash.me" "/var/www/project.oliverjash.me"

exit 
```

我不喜欢它重新编译每个分支的方式，即使更改只被推送到一个，但它已经足够好了。

# django - 如何使用 django-allauth 提供者信息填充用户配置文件？

> ID：14523224
> 
> 赞同：17
> 
> 时间：2013-01-25T13:57:05.300
> 
> 标签：django, facebook, authentication, django-allauth

我将 django-allauth 用于我的身份验证系统。我需要当用户登录时，配置文件模块会填充提供者信息（在我的情况下是 facebook）。

我正在尝试使用 pre_social_login 信号，但我只是不知道如何从提供者身份验证中检索数据

```
from django.dispatch import receiver
from allauth.socialaccount.signals import pre_social_login

@receiver(pre_social_login)

def populate_profile(sender, **kwargs):
    u = UserProfile( >>FACEBOOK_DATA<< )
    u.save() 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-25T15:18:48.097

该`pre_social_login`信号是在用户通过社交提供商成功进行身份验证后、但在实际处理登录之前发送的。社交登录、注册以及将其他社交帐户连接到帐户时会发出此信号。

所以它是在注册完全完成之前发送的——因此这不是正确使用的信号。

相反，我建议您使用`allauth.account.signals.user_signed_up`，它是为所有用户（本地用户和社交用户）发出的。

在该处理程序中，您可以检查`SocialAccount`附加到用户的任何内容。例如，如果您想检查 Google+ 特定数据，请执行以下操作：

```
user.socialaccount_set.filter(provider='google')[0].extra_data 
```

*更新：*`sociallogin`最新的开发版本通过传递一个直接包含所有相关信息（社交帐户，令牌，...）的参数，使这更加方便

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-01-10T07:50:41.070

**这是[@pennersr](https://stackoverflow.com/users/593944/pennersr)解决方案的具体示例：**

假设您的配置文件模型具有以下 3 个字段：`first_name`, `email`,`picture_url`

***视图.py：***

```
@receiver(user_signed_up)
def populate_profile(sociallogin, user, **kwargs):    

    if sociallogin.account.provider == 'facebook':
        user_data = user.socialaccount_set.filter(provider='facebook')[0].extra_data
        picture_url = "http://graph.facebook.com/" + sociallogin.account.uid + "/picture?type=large"            
        email = user_data['email']
        first_name = user_data['first_name']

    if sociallogin.account.provider == 'linkedin':
        user_data = user.socialaccount_set.filter(provider='linkedin')[0].extra_data        
        picture_url = user_data['picture-urls']['picture-url']
        email = user_data['email-address']
        first_name = user_data['first-name']

    if sociallogin.account.provider == 'twitter':
        user_data = user.socialaccount_set.filter(provider='twitter')[0].extra_data
        picture_url = user_data['profile_image_url']
        picture_url = picture_url.rsplit("_", 1)[0] + "." + picture_url.rsplit(".", 1)[1]
        email = user_data['email']
        first_name = user_data['name'].split()[0]

    user.profile.avatar_url = picture_url
    user.profile.email_address = email
    user.profile.first_name = first_name
    user.profile.save() 
```

如果您对每个提供程序中的这些`picture_url`变量感到困惑。然后看看文档：

**Facebook：**

`picture_url = "http://graph.facebook.com/" + sociallogin.account.uid + "/picture?type=large"` [文档](https://developers.facebook.com/docs/graph-api/reference/user/picture/)

**链接：**

`picture_url = user_data['picture-urls']['picture-url']` [文档](https://developer.linkedin.com/docs/fields/basic-profile)

**推特：**

`picture_url = picture_url.rsplit("_", 1)[0] + "." + picture_url.rsplit(".", 1)[1]` [Docs](https://developer.twitter.com/en/docs/accounts-and-users/user-profile-images-and-banners)`rsplit()`看看[这里](https://stackoverflow.com/questions/15012228/splitting-on-last-delimiter-in-python-string)_

希望有帮助。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-28T05:30:35.433

我就是这样做的，以图片（字段）url和google provider（字段）为例。

```
socialaccount_obj = SocialAccount.objects.filter(provider='google', user_id=self.user.id)
   picture = "not available"
   if len(socialaccount_obj):
            picture = socialaccount_obj[0].extra_data['picture'] 
```

确保导入：从 allauth.socialaccount.models 导入 SocialAccount

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-16T13:26:39.753

有一种更简单的方法可以做到这一点。

只需将以下内容添加到您的 settings.py 中。例如，链接在...

```
SOCIALACCOUNT_PROVIDERS = {
'linkedin': {
    'SCOPE': [
        'r_basicprofile',
        'r_emailaddress'
    ],
    'PROFILE_FIELDS': [
        'id',
        'first-name',
        'last-name',
        'email-address',
        'picture-url',
        'public-profile-url',
    ]
} 
```

字段会自动拉过。

# jsf - 在表单提交时验证rich:dataTable 值大小

> ID：14523228
> 
> 赞同：0
> 
> 时间：2013-01-25T13:57:29.803
> 
> 标签：jsf, jsf-2, richfaces

我有一个需要日期列表的“新项目”表单，其中包含以下组件：

*   一个`<rich:calendar>`输入；
*   A`<a4j:commandButton>`将所选日期添加到`List<Date> chosenDates`支持 bean 中的 a ；
*   A`<rich:dataTable>`将其`value`设置为`List<Date> chosenDates`属性；
*   从;`<a4j:commandButton>`中删除其日期的每个 dataTable 行`List<Date> chosenDates`

如何**验证**（JSF的验证阶段）`chosenDates`表单提交（创建过程）列表的大小？

RichFaces 4，JSF 2.1 (Mojarra)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T15:47:14.083

我建议使用 JSF PhaseListener 采用更简洁的方法。如果验证失败，JSF 处理将停止跳过其他阶段。创建一个[`PhaseListener`](http://docs.oracle.com/javaee/6/api/javax/faces/event/PhaseListener.html)将*在*验证阶段检查列表大小，而不是在模型更新/调用操作阶段检查列表的大小。尝试这样的事情

1.  为验证阶段创建一个阶段监听器

    ```
    public class TestPhaseListener implements PhaseListener {

       @Override
       public void afterPhase(PhaseEvent event) {
          throw new UnsupportedOperationException("Not supported yet.");
       }

       @Override
       public void beforePhase(PhaseEvent event) {

          if(event.getPhaseId().equals(PhaseId.PROCESS_VALIDATIONS)){
            FacesContext ctx = event.getFacesContext();
            YourBeanClass theBeanClass = ctx.getApplication().evaluateExpressionGet(ctx, "#{someBean}", YourNeanClass.class); //obtain a reference to the backing bean containing the list
    /*
       inspect the size of the list here and based on that throw the exception below
     */
           throw new ValidatorException(new FacesMessage("Too many dates","Too Many Dates"));
          }
       }

        @Override
        public PhaseId getPhaseId() {
           throw new UnsupportedOperationException("Not supported yet.");
        }
     } 
    ```

2.  `faces_config.xml`在文件中注册你的新监听器

    ```
    <lifecycle>
       <phase-listener>your.package.structure.TestPhaseListener</phase-listener>
    </lifecycle> 
    ```

编辑：根据您的评论，作为替代方案，您可以使用`<f:event/>`标签和`preValidate`or`postValidate`事件挂钩组件的生命周期（取决于您的偏好）

1.  组件的监听器标签

    ```
     <rich:dataTable>
           <f:event type="preValidate" listener="#{yourBean.listener}"/>
       </rich:dataTable> 
    ```

2.  在您的支持 bean 中定义一个侦听器方法以根据您定义的事件运行。方法签名**必须**采用类型的参数`ComponentSystemEvent`

    ```
     public void preCheck(ComponentSystemEvent evt){
           //You're in your backing bean so you can do pretty much whatever you want. I'd advise you mark the request as validation failed and queue FacesMessages. Obtain a reference to FacesContext and:

            facesContext.validationFailed();

         } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:08:52.733

执行以下操作： `#{yourBean.chosenDates.size()}` 我想您有一个名为 getChosenDates 的 getter，它返回 selectedDates 列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T15:22:51.587

关于您的“验证问题”：

`Validate`您可以在 bean中创建一个方法并返回`ValidationMessages`. 下面是一个示例，我在我的代码中使用了一个示例。

```
public List<ValidationMessage> validate() {
    List<ValidationMessage> validations = new ArrayList<ValidationMessage>();
    int curSampleSize = sampleTable.getDataModel().getRowCount();

    if(getNumberOfSamples() != null) {
        size += getNumberOfSamples();
    } else {
        validations.add(new ValidationMessage("Please enter the no of samples to continue."));
        return validations;
    }           

    return validations;
} 
```

然后，在提交时，您可以检查是否有`ValidationMessages`以下内容：

```
List<ValidationMessage> errs = validate();

if(errs.size()>0) {
    FacesValidationUtil.addFacesMessages(errs);
    return null;
} 
```

希望这可以帮助！

# backbone.js - 在主干js中调用第二个js文件的渲染方法

> ID：14523243
> 
> 赞同：0
> 
> 时间：2013-01-25T13:58:35.017
> 
> 标签：backbone.js

我有两个不同的主干 js 文件，用于 2 个不同的视图。我需要从第一个js文件中调用第二个js文件的render方法。我怎样才能做到这一点

我有一个名为 DocumentsPageView 的主干.js 文件。在我的第二个主干 js 文件中，当我单击第一个 js 文件上的按钮时，我必须调用 DocumentsPageview 的渲染方法

## 第一个js文件

```
first.backbonejs = (function($) {
    case myapp  
        sectionView = new second.mysecondbackbone.DocumentsPageView();
        sectionView.render();
        break;
    }
}(jQuery) 
```

## 第二个js文件

```
second.mysecondbackbone = (function($) {
    var DocumentsPageView= Backbone.View.extend({
        render: function(){
            //render the page
        }
    });
}(jQuery) 
```

我在声明部分得到对象未定义

感谢和问候阿希克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:04:31.573

我的建议是，不要。

使用位于两者之间的中介对象，并控制使用两个视图的过程。

它可以像这样简单：

```
myProcess = {

  show: function(){
    var view1 = new View1();
    view1.on("foo", this.doMoreStuff, this);
    this.showView(view1);
  },

  doMoreStuff: function(){
    var view2 = new View2();
    this.showView(view2);
  },

  showView: function(view){
    // code to stuff view.$el in to the DOM
  }

} 
```

这里的优点是您拥有一个可以自行管理和维护的高级工作流，与各个视图的实现细节分开。您不必追溯各个视图以了解它们如何协同工作。

我在这里写了更多关于此的内容：http: [//lostechies.com/derickbailey/2012/05/10/modeling-explicit-workflow-with-code-in-javascript-and-backbone-apps/](http://lostechies.com/derickbailey/2012/05/10/modeling-explicit-workflow-with-code-in-javascript-and-backbone-apps/)

# php - 通过 jQuery Ajax 发送 Json 数组

> ID：14523244
> 
> 赞同：4
> 
> 时间：2013-01-25T13:58:34.893
> 
> 标签：php, json, jquery, getjson

我将通过 jquery ajax 调用将一组 json 对象发送到 php 文件。

```
var arr = new Array();
var record1 = {'a':'1','b':'2','c':'3'};
var record2 = {'d':'4','e':'5','f':'6'};
arr.push(record1);
arr.push(record2); 
```

如何通过 jquery ajax 发送数组？以及如何获取 php 中的值？谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-25T14:05:13.383

```
$.ajax({
        url: "api",
        type: "POST",
        dataType: 'json',
        data: JSON.stringify(arr),
        success: function(response){}

       }); 
```

并使用 PHP：

```
$strRequest = file_get_contents('php://input');
$Request = json_decode($strRequest); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:02:05.123

我觉得`JSON.stringify()`可能有用。

或者，您可以`json_decode()`在 php 文件中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T14:06:26.903

首先下载并添加插件：jquery.json-2.4.js 到您的项目中。这个插件提供了很多帮助，让你的生活更轻松。

然后在您的 $.ajax 中，使用数据：$.toJSON(arr),

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T14:48:10.917

您必须知道的第一件事是您需要使用两个文件以使事情变得简单。1\. 你要在哪里放置你的 php 代码 phpcode.php 2\. 你要在哪里放置你的 ajax 代码 ajax.html 在你要放置你的 ajax 代码的页面中确保你连接到 jquery 插件 然后

```
 <script> 
          $(document).ready(function(){
      // your ajax code here  delete mine and put your codes
    $.getJSON(' phpcode.php ', function(data) {
              $('#myJson').html('<table style="color:red"><tr><td>' + data.name + '</td><td>' + data.user + '</td></tr></table>');
            });
          });

        </script>
    <body>
    <!—You may put the bellow div in the ajax page so that u load your data in it ---->
        <div id="myJson"></div>
      </body>
    </html>
     In your php page you need something like this at the end of your code 
    // The JSON standard MIME header.
    header('Content-type: application/json');
    echo  json_encode($array);
    Note: I took an example from my working codes just to save the time but I think you get the Idea 
```

# php - 启动进程，从 ps 隐藏参数

> ID：14523246
> 
> 赞同：5
> 
> 时间：2013-01-25T13:58:39.293
> 
> 标签：php, python, security

我有一个与 API 交互的 Python 脚本。该脚本从 PHP 页面启动。我编写了两个脚本，因此我可以根据需要更改其中的代码。

Python 脚本需要用户名和密码才能与 API 交互。我的第一个倾向是将它们作为 CLI 参数传递给 Python：

```
<?php
exec('python someScript.py AzureDiamond hunter2');
?> 
```

但是，任何人都可以通过以下方式查看凭据`ps`：

```
$ ps | grep someScript
1000     23295  2.0  0.2 116852  9252 pts/0    S+   15:47   0:00 python someScript.py AzureDiamond hunter2 
```

我正在考虑的替代方法是将数据写入文本文件或 sqlite 数据库，然后删除它们。有没有更好的想法？sqlite 方法的一个限制是它需要以相当便携的方式运行（phpFox 插件），并且大多数预算网络主机不支持该`sqlite3`模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:00:58.343

您可以使用在 PHP 中设置并在 Python 脚本中读取的环境变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T05:07:39.707

所提出的方法是一个等待发生的安全问题。MyProxy 是一种处理私钥或证书的安全方式。MyProxy 可能不是您需要的特定解决方案，但这些类型的解决方案正是您需要考虑的。

[http://grid.ncsa.illinois.edu/myproxy/](http://grid.ncsa.illinois.edu/myproxy/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T13:43:34.693

您可以在 python 进程中使用 stdin 来读取参数，并从 php 中打开这样的进程：

```
<?php
$handle = popen("/bin/python /var/www/someScript.py", "w");
// write username and password to $handle (e.g. newline separated)
?> 
```

我不知道这对于以同一用户身份运行的其他进程有多安全（是否可以从 /proc/nn/fd/0 劫持？），但这肯定比仅查看进程列表更难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:03:54.970

从另一个角度来看问题，如果隐藏传递给 exec() 的纯字符，它可以解决。您是否考虑过使用任何密码库向发送者隐藏纯文本并在接收者中解密？只是一个想法。

# android - 多个 ListView 和空视图

> ID：14523254
> 
> 赞同：1
> 
> 时间：2013-01-25T13:59:03.777
> 
> 标签：android, listview, user-interface

我有一个包含 2 个 ListViews 的片段。我尝试为每个人设置 EmptyView。我尝试使用@id/android:empty 和通过代码通过XML 添加它们，两次都被忽略了。

任何人都可以使用两个 ListViews 和不同的 Empty View 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:31:07.680

它正在工作，您必须确保将`View`（对于空状态）添加到您的布局中，其中`ListView`。

此外，`Adapter`您`ListView`必须`null`或`isEmpty()`必须为 true 才能显示空视图。

如果仍有问题，请发布一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-27T21:32:11.340

我认为@Leandros 走在正确的轨道上，您需要确保正确设置每个列表。`@id/android:empty`当您在同一个 xml中定义两次时，听起来可能存在不匹配。您可能需要为它们提供唯一的 id，然后将它们连接到 java.util 中。

您的 xml 可能看起来像这样：

```
...
<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    >
    <ListView 
        android:id="@+id/list1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        />
    <TextView 
        android:id="@+id/empty1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="List 1 is empty"
        />
</LinearLayout>

<LinearLayout 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    >
    <ListView 
        android:id="@+id/list2"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        />
    <TextView 
        android:id="@+id/empty2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="List 2 is empty"
        />
</LinearLayout>
... 
```

然后在片段中，您需要抓取视图并附加它们。

```
...
    ListView list1 = (ListView)findViewById(R.id.list1);
    View empty1 = findViewById(R.id.empty1);
    list1.setEmptyView(empty1);

    ListView list2 = (ListView)findViewById(R.id.list2);
    View empty2 = findViewById(R.id.empty2);
    list2.setEmptyView(empty2);
... 
```

如果你真的想要一个更复杂的空视图，你可以在你的 xml 中包含另一个布局而不是 TextView。

```
...
    <include layout="@layout/empty" 
        android:id="@+id/list1"
        />
...
    <include layout="@layout/empty" 
        android:id="@+id/list2"
        />
... 
```

我希望这有帮助！

# jquery - jQuery - 页面更改后无法工作（FF 和 IE）

> ID：14523256
> 
> 赞同：0
> 
> 时间：2013-01-25T13:59:14.433
> 
> 标签：jquery, html, joomla

我正在使用这个 jQuery 插件：[http ://areaaperta.com/nicescroll/](http://areaaperta.com/nicescroll/)

它在 Chrome 上完美运行，滚动条更改为我在每一页上的设置。然而：

在 Firefox 或 IE(9) 中，如果我进行缓存刷新，则滚动条会正常更改。但是，一旦我转到另一个页面或刷新，滚动条就会消失并放置默认浏览器。

我还有另一个不加载的小型 Jira jQuery 插件，但在页面缓存刷新后工作 < 一切都在 chrome 中工作。

该网站位于 Joomla 上，以下内容位于标签之前。

```
 <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js'></script>
<script type='text/javascript' src='./ext/jquery-plugins/scrollpane/jquery.nicescroll.js'></script>
<script type='text/javascript'>
$(document).ready(
    function() { 
    $("html").niceScroll({
        cursorcolor: "#cf4725",
        cursorwidth: 10,
        cursorborder: "1px solid #000000",
        mousescrollstep: 50
    });
});
</script> 
```

网站目前位于 www2.lethal-zone.eu。

有人对这是什么有任何建议吗？

TL;DR：在 FF 和 IE 中，jQuery 在页面缓存上工作，但在页面重新加载后失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:23:08.257

需要将 $ 换成 jQuery。不知道为什么它在缓存刷新上起作用！

# javascript - 从文档中删除 jQuery（垃圾收集）

> ID：14523257
> 
> 赞同：0
> 
> 时间：2013-01-25T13:59:14.730
> 
> 标签：javascript, garbage-collection, performance-testing

我想知道是否可以从文档中删除已执行的 JS 代码。假设我已经加载了 jQuery，但我不再需要它，是否可以简单地运行`delete window.$`，或者是否有*适当的*方法来做到这一点？

**我为什么要这样做？**

我正在运行一些性能测试，目前它们在一个内部`<iframe>`，以便为每个套件提供一个干净的状态，但这不是很可行，因为我正在测试的某些设备不支持`<iframes>`（是的，魔术） .

所以我想做的基本上是在某种容器中加载一些基于库的代码，对其进行测试，然后将其清除以准备垃圾收集，如果这在 JS 的当前状态下是可能的话。

注意：我以 jQuery 为例，因为它是一个 100% 覆盖率的大型库。

# delphi - delphi 中的编码时间，单位为毫秒

> ID：14523266
> 
> 赞同：0
> 
> 时间：2013-01-25T13:59:51.967
> 
> 标签：delphi

我创建了一个编码来设置比 Windows 系统快 20 毫秒。我正在使用编码时间。

这是代码

```
procedure TForm1.Button1Click(Sender: TObject);
Var
delphi_datetime :tDateTime;
t_date : tdatetime ;
windows_datetime : tSystemTime;
begin
   t_date :=  dATE;
   delphi_datetime := encodetime(8,44,59,980);
   delphi_datetime := incmillisecond(delphi_datetime, 20);
   replacedate(t_date , delphi_datetime);
   datetimetosystemtime( delphi_datetime , windows_datetime );
   setlocaltime( windows_datetime );
  showmessage('time now = ' + timetostr(delphi_datetime));
end; 
```

在我运行它之后，显示正确的时间。但日期是 1899 年 12 月 30 日.. 但我想要当前的今天日​​期，但时间快 20 毫秒。任何帮助..请...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T15:22:55.823

你有`ReplaceDate`倒退的论据。它读取*第二个参数的日期并分配**第一个*参数的日期部分。的日期部分`delphi_datetime`为 0，因为这就是`EncodeTime`工作原理。您获取该零值并将其分配给`t_date`，但随后您继续使用`delphi_datetime`。

反转 的参数`ReplaceDate`，您应该会看到当前系统时间设置为 8:45:00.000 和当前日期。

```
ReplaceDate(delphi_datetime, t_date); 
```

如果您没有使用单独的`t_date`变量，您可能会更早注意到这个错误。如果您`Date`直接调用，您的代码将无法编译：

```
ReplaceDate(Date, delphi_datetime); // can't pass function result as "var" parameter 
```

这有效：

```
ReplaceDate(delphi_datetime, Date); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T16:55:55.570

Rob 发现了您现有代码的问题。但是，您现有的方法是不必要的复杂。如果您选择更简单的方法，您会发现更容易正确编写代码。

如果您想要一个比现在大 20 毫秒的日期时间，请执行以下操作：

```
MyDateTime := IncMillisecond(Now, 20); 
```

如果你想要一个代表今天 0845 的日期时间，那么你写：

```
MyDateTime := Date + EncodeTime(8, 45, 0, 0); 
```

# c# - 如何找出图像的相对路径

> ID：14523274
> 
> 赞同：2
> 
> 时间：2013-01-25T14:00:04.850
> 
> 标签：c#, wpf, image, xaml, imagesource

在遗留项目中有图像的绝对路径，例如：

```
C:/projects/LegacyProject/Project/Client/UserInterface/Images/arrow.png 
```

现在我想使用相对路径，这样每个开发人员都可以使用该项目，无论他的源代码副本在哪里。

有没有一种简单的方法可以找出（资源）相对路径？那我该怎么用呢？

目前我有例如：

```
<Image Source="C:/projects/LegacyProject/Project/Client/UserInterface/Images/arrow.png" Stretch="Fill" /> 
```

我想要的是这样的：

```
<Image Source="arrow.png" Stretch="Fill" /> 
```

试过了

```
<Image Source="pack:,,, arrow.png" Stretch="Fill" />
<Image Source="/WPF1;arrow.png"></Image> 
```

和类似的事情

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:09:23.570

将图像文件放入 Visual Studio 项目中的文件夹（假设为`Images`），并将其[构建操作](http://msdn.microsoft.com/en-us/library/0c6xyb66.aspx)设置为`Resource`.

现在您可以像这样在 XAML 中简单地使用它们：

```
<Image Source="Images/arrow.png" ... /> 
```

在代码隐藏中，您必须编写

```
var uri = new Uri("pack://application:,,,/Images/arrow.png");
image.Source = new BitmapImage(uri); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:22:56.700

通过单击使用控件的`Source`属性添加图像`Image`

![在此处输入图像描述](../Images/c52d42c64df2b617b9fc9685b68ef957.png)

那么路径将是这样的：

```
/[project name];component/[folder name: e.g. Images]/[file name] 
```

# java - Android 客户端/Java 服务器 2 路

> ID：14523275
> 
> 赞同：0
> 
> 时间：2013-01-25T14:00:05.013
> 
> 标签：java, android, client-server

**服务器**

我认为这一面还可以，但我说我会为了确定而把它放上去。

```
import java.io.*;
import java.net.*;
public class Server_wifi {
    public static void main(String[] args) throws Exception {
        ServerSocket sersock = new ServerSocket(3000);
        System.out.println("Server  ready for chatting");
        Socket sock = sersock.accept( );                          
        // reading from keyboard (keyRead object)
        BufferedReader keyRead = new BufferedReader(new InputStreamReader(System.in));
        // sending to client (pwrite object)
        OutputStream ostream = sock.getOutputStream(); 
        PrintWriter pwrite = new PrintWriter(ostream, true);

        // receiving from server ( receiveRead  object)
        InputStream istream = sock.getInputStream();
        BufferedReader receiveRead = new BufferedReader(new InputStreamReader(istream));

        String receiveMessage, sendMessage;               
        while(true) {
            if((receiveMessage = receiveRead.readLine( )) != null) {
                System.out.println(receiveMessage);         
            }         
            sendMessage = keyRead.readLine(); 
            pwrite.println(sendMessage);             
            System.out.flush();                              
        }               
    }                    
} 
```

**客户**

我认为问题出在客户端，但似乎无法真正弄清楚在哪里。

```
package com.example.testprogram;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.net.Socket;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

public class MainActivity extends Activity {

    private Socket server;
    private PrintWriter printwriter;
    private EditText textField;
    private EditText textField2;
    private Button button;
    private String messsage;
    private int x  =0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        textField = (EditText) findViewById(R.id.tf1); //reference to the text field
        textField2 = (EditText) findViewById(R.id.tf2); //reference to the text field
        button = (Button) findViewById(R.id.wifi);   //reference to the send button
        textField.setText("Started... "); 
        //Button press event listener
        button.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                x++;   
                messsage = textField.getText().toString(); //get the text message on the text field
                textField.setText("");      //Reset the text field to blank
                System.out.println("Got here...");
                try {

                    Socket sock = new Socket("172.16.71.175", 3000);
                    // reading from keyboard (keyRead object)
                    BufferedReader keyRead = new BufferedReader(new InputStreamReader(System.in));
                    // sending to client (pwrite object)
                    OutputStream ostream = sock.getOutputStream(); 
                    PrintWriter pwrite = new PrintWriter(ostream, true);

                    // receiving from server ( receiveRead  object)
                    InputStream istream = sock.getInputStream();
                    BufferedReader receiveRead = new BufferedReader(new InputStreamReader(istream));

                    textField.setText("Start the chitchat, type and press Enter key");

                    String receiveMessage, sendMessage;
                    while(true) {
                        sendMessage = textField.getText().toString();     // keyboard reading
                        pwrite.println(sendMessage);       // sending to server
                        System.out.flush();         // flush the data

                        if((receiveMessage = receiveRead.readLine()) != null) //receive from server
                        {
                            textField.setText(receiveMessage); // displaying at DOS prompt
                        }         
                    }               
                }catch (UnknownHostException e) {
             textField.setText("Unknown host");
                 e.printStackTrace();
                 } catch (IOException e) {
             textField.setText("IO exception"+e.toString());
                 e.printStackTrace();
                 }                                   
            }
        });

    }
} 
```

它似乎正在使我的应用程序崩溃，它也一直告诉我我错过了 } 来完成。我正在尝试在电话和计算机之间建立一个双向系统，请提供帮助。我提出了一个建议，比如建议让应用程序一直没有响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:51:44.087

您应该在客户端和服务器端调用`pwrite.flush()`而不是`System.out.flush()`在调用之后调用。`pwrite.println(sendMessage)`您正在刷新错误的输出流。

# model-view-controller - 基本控制器zend框架2

> ID：14523276
> 
> 赞同：0
> 
> 时间：2013-01-25T14:00:18.990
> 
> 标签：model-view-controller, zend-framework2, controllers

我想知道这里是否有人可以提供帮助，我刚开始使用 Zend Framework 2，我发现让项目正确启动有点令人生畏..

我正在尝试创建一个可以扩展的基本控制器。我目前正在使用 Zend Framework 2 框架应用程序。

我在 vendor/zendframework/zendframework/library 中创建了一个 Resources 文件夹。在 Resources 文件夹中，我有一个 Controllers 文件夹，其中包含一个 BaseController.php 文件。

如何让我的项目自动加载 Resources 文件夹中的 BaseController 以使其在整个站点中可用？

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:01:59.843

您不需要创建基本控制器，ZF2 已经为您提供了许多基本控制器，例如 RestController 和 AbstractActionController

[http://framework.zend.com/manual/2.0/en/modules/zend.mvc.controllers.html](http://framework.zend.com/manual/2.0/en/modules/zend.mvc.controllers.html)

如果您要创建一个基本控制器，请创建您自己的模块并将其放在供应商目录中。

您永远不需要进入第三方模块并修改代码，因为您应该能够继承和扩展此类库提供的类

# c# - 对象引用未设置为对象的实例 - 未出现在服务器应用程序事件查看器中

> ID：14523286
> 
> 赞同：1
> 
> 时间：2013-01-25T14:00:46.807
> 
> 标签：c#, asp.net, exception, object

我有一个调用 Web 服务的 ASP.NET Web 应用程序。此 Web 服务接收一个 Dictionary 对象（我已经填充了会话信息）并将其转换为 XML。应用程序工作正常（并生成 XML）但我收到了这个间歇性异常（通过电子邮件）- 和用户出现错误页面 - 尽管应用程序已成功运行！

资料来源：花园废物

> 消息：对象引用未设置为对象的实例。StackTrace：位于 C:\Documents and Settings\stevd\My Documents\Visual Studio 2010\Projects\External Web Apps\GardenWaste\GardenWaste\CardSuccess.aspx.cs:line 63 中的 GardenWaste.SignUpSuccess.GWComplete()

我不确定为什么在第 63 行失败 - 此行从 Session 中获取一个对象，并在传递给 Web 服务之前添加到 Dictionary 。并生成正确的 XML（过程结束）！

应用程序服务器日志中没有与此异常相关的任何内容。如果有人可以阐明为什么会发生此错误，那就太好了。我很乐意根据需要包含更多代码。

这是引发异常的方法的代码：

```
//This method is called on the Page_Load() event
    public void GWComplete()
        {
            try
            {
                //invokes the webservice
                FocusXMLService.Service1Client client = new FocusXMLService.Service1Client();

                Dictionary<string, string> GWDict = new Dictionary<string, string>();

                //The Path and Filename used to create the files

                GWDict.Add("File", "E:\\ash\\focus\\objrepos\\1\\Input\\GreenWaste\\GARDENW-EXT" + System.DateTime.Now.ToString("ddmmmyyyyhhssffff") + ".xml");
                GWDict.Add("SourceName", "FD");

                //This is the line that it suggests there's a failure - although it's produced on the XML!
                GWDict.Add("UniqueReference", Session["UniqueRef"].ToString());

                GWDict.Add("MatterReference", "0001");               
                GWDict.Add("Status", "CURRENT");
                GWDict.Add("Service", "CUSTSERV");
                GWDict.Add("ServiceLevel", "GARDENW");
                GWDict.Add("Category", "GARDENW");
                GWDict.Add("CategoryType", "STARTS");
                GWDict.Add("Description", "Garden Waste Scheme");
                GWDict.Add("LinkedNoteText", "GCCGW");
                GWDict.Add("Title", Session["Title"].ToString());
                GWDict.Add("FirstName", Session["FirstName"].ToString());
                GWDict.Add("Surname", Session["Surname"].ToString());
                GWDict.Add("House", Session["House"].ToString());
                GWDict.Add("Street", Session["Street"].ToString());
                GWDict.Add("AddressLine2", Session["AddressLine2"].ToString());
                GWDict.Add("AddressLine3", Session["AddressLine3"].ToString());
                GWDict.Add("PostCode", Session["PostCode"].ToString());
                GWDict.Add("MobileNo", Session["MobileNo"].ToString());
                GWDict.Add("TelephoneNo", Session["TelephoneNo"].ToString());
                GWDict.Add("EmailAddress", Session["EmailAddress"].ToString());
                GWDict.Add("AddressLLPGRef", Session["AddressLLPG"].ToString());

                GWDict.Add("GWBENEFIT", Session["GWBENEFIT"].ToString());
                GWDict.Add("GWBENREF", Session["GWBENREF"].ToString());
                GWDict.Add("GWASSISTED", Session["GWASSISTED"].ToString());
                GWDict.Add("GWHAVEBINS", Session["GWHAVEBINS"].ToString());
                GWDict.Add("GWHOWMANY", Session["GWHOWMANY"].ToString());
                GWDict.Add("GWHOWMANYB", Session["GWHOWMANYB"].ToString());
                GWDict.Add("GWPAYMETH", "[1] Credit / Debit Card");
                GWDict.Add("GWDDINST", "");
                GWDict.Add("GWDDSORT", "");
                GWDict.Add("GWDDACCT", "");
                GWDict.Add("GWDDNAME", "");
                GWDict.Add("GWDDMAND", "");
                GWDict.Add("GWTERMS", "[Y] Yes");

                //sends the Dictionary object to the Web service
                bool success = client.CreateXML(GWDict);
                if (success)
                {

                }
                else
                    {Response.Redirect("Error.aspx", false);}
            }
            catch (Exception ex)
            {
                //Generates an email notification there's a problem
                WebForm_Exceptions.ExceptionNotifier(ex);
            }

            Session.Abandon();
        }
        }
    } 
```

# android - Android - 如何从最近的应用程序中删除活动？

> ID：14523287
> 
> 赞同：14
> 
> 时间：2013-01-25T14:00:49.440
> 
> 标签：android

我在我的 android 应用程序上创建了一个自定义对话框。此对话框是具有对话框主题的活动。现在，假设应用程序正在显示此对话框，用户按“主页”返回 Android 主页视图。稍后，用户按住按钮，`Home`然后从最近的应用程序中选择我的应用程序。它将再次显示对话框。我想在这里做的是对话框不应该显示。我想显示调用此对话框的活动。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-25T14:05:52.340

> 如何从最近的应用程序中删除活动？

我认为`android:excludeFromRecents="true"`应该做的伎俩。在清单中使用它

* * *

> 我想在这里做的是对话框不应该显示。

`dialog.cancel()`在`onPause()`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-01-13T14:51:07.420

您也可以使用标志 Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS：

```
.....
i.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
startActivity(i); 
```

您开始的活动不会出现在最近的应用中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T14:04:28.533

`yourdialog.cancel()`在您的活动`onPause()`方法中使用。请参阅[http://developer.android.com/reference/android/app/Activity.html](http://developer.android.com/reference/android/app/Activity.html)。一个例子：

```
@Override
protected void onPause() 
{
    super.onPause();
    if (yourdialog != null)
    {
        yourdialog.cancel();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:09:54.370

您可以覆盖`onStop()`您的对话活动：

```
@Override
protected void onStop() {
   super.onStop();
   finish();
} 
```

但是，这也意味着您的对话框将在设备锁定时关闭。

# ckeditor - 如何防止 CKEditor 用 替换空格？

> ID：14523293
> 
> 赞同：10
> 
> 时间：2013-01-25T14:01:00.763
> 
> 标签：ckeditor

我遇到了[CKEditor 4](http://ckeditor.com/)的问题，我需要有一个没有任何 html 实体的输出，所以我`config.entities = false;`在我的配置中添加了，但有些`&nbsp;`出现在

*   插入内联标记：之前的空格被替换为`&nbsp;`
*   文本被粘贴：每个空格都替换为`&nbsp;`偶数`config.forcePasteAsPlainText = true;`

您可以通过键入在[任何演示](http://ckeditor.com/demo)中进行检查

> 测试*测试*

例如。

你知道我怎样才能防止这种行为吗？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-01-07T11:13:08.880

基于 Reinmars 接受的答案和[实体插件](https://github.com/ckeditor/ckeditor-dev/tree/master/plugins/entities)，我创建了一个带有 HTML 过滤器的小插件，可以删除冗余`&nbsp;`实体​​。可以改进正则表达式以适应其他情况，因此请编辑此答案。

```
/*
 * Remove &nbsp; entities which were inserted ie. when removing a space and
 * immediately inputting a space.
 *
 * NB: We could also set config.basicEntities to false, but this is stongly
 * adviced against since this also does not turn ie. < into &lt;.
 * @link http://stackoverflow.com/a/16468264/328272
 *
 * Based on StackOverflow answer.
 * @link http://stackoverflow.com/a/14549010/328272
 */
CKEDITOR.plugins.add('removeRedundantNBSP', {
  afterInit: function(editor) {
    var config = editor.config,
      dataProcessor = editor.dataProcessor,
      htmlFilter = dataProcessor && dataProcessor.htmlFilter;

    if (htmlFilter) {
      htmlFilter.addRules({
        text: function(text) {
          return text.replace(/(\w)&nbsp;/g, '$1 ');
        }
      }, {
        applyToAll: true,
        excludeNestedEditable: true
      });
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-27T15:44:05.550

这些实体：

```
// Base HTML entities.
var htmlbase = 'nbsp,gt,lt,amp'; 
```

是个例外。要摆脱它们，您可以设置`basicEntities: false`. 但正如[文档](http://docs.ckeditor.com/#!/api/CKEDITOR.config-cfg-basicEntities)所提到的，这是一个不安全的设置。因此，如果您只想删除`&nbsp;`，那么我应该只对输出数据使用正则表达式（例如，通过为[#getData](http://docs.ckeditor.com/#!/api/CKEDITOR.editor-event-getData)添加侦听器），或者，如果您想更精确，添加您自己的规则，`htmlFilter`就像`entities`插件[在此处所做](https://github.com/ckeditor/ckeditor-dev/blob/master/plugins/entities/plugin.js#L150)的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-30T09:33:31.040

我需要更改 Imeus 发送的正则表达式，在我的情况下，我使用 TYPO3 并且需要编辑后端编辑器。这个没用。也许它可以帮助另一个有同样问题的人:)

```
return text.replace(/&nbsp;/g, ' '); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-09T19:19:29.033

## 删除所有`&nbsp;`但不`<tag>&nbsp;</tag>`使用 Javascript Regexp

这对 CKEditor 尤其有用，因为它会创建类似 的行`<p>&nbsp;</p>`，您可能希望保留这些行。

**背景：**我首先尝试使用环视断言制作单行 Javascript。看来你不能把它们锁起来，至少现在还不能。我的第一种方法不成功：

```
return text.replace(/(?<!\>)&nbsp;(?!<\/)/gi, " ")

// Removes &nbsp; but not <p>&nbsp;</p>
// It works, but does not remove `<p>&nbsp; blah &nbsp;</p>`. 
```

**这是我更新的工作单行代码：**

```
return text.replace(/(?<!\>\s.)(&nbsp;(?!<\/)|(?<!\>)&nbsp;<\/p>)/gi, " ") 
```

这按预期工作。你可以[在这里测试它](https://regexr.com/6f708)。

但是，这是一种阴暗的做法，因为[某些浏览器不完全支持](https://caniuse.com/js-regexp-lookbehind)环视。

[阅读更多关于断言](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Assertions#other_assertions)的信息。

**我最终在我的生产代码中使用了什么：** 我最终用多个 replace() 做了一些 hacky 方法。这应该适用于所有浏览器。

```
.trim()                                                            // Remove whitespaces
.replace(/\u00a0/g, " ")                                           // Remove unicode non-breaking space
.replace(/((<\w+>)\s*(&nbsp;)\s*(<\/\w+>))/gi, "$2<!--BOOM-->$4")  // Replace empty nbsp tags with BOOM
.replace(/&nbsp;/gi, " ")                                          // remove all &nbsp;
.replace(/((<\w+>)\s*(<!--BOOM-->)\s*(<\/\w+>))/gi, "$2&nbsp;$4")  // Replace BOOM back to empty tags 
```

如果你有更好的建议，我很乐意听到。

# java - 如何读取两个文本并插入数据库中的单个字段

> ID：14523298
> 
> 赞同：0
> 
> 时间：2013-01-25T14:01:28.317
> 
> 标签：java, mysql

我在 Java 中工作。我有两个 TextField 对象 t22 和 t23。我的要求如下：我必须从两个文本字段中读取字符串，在两个字符串值之间添加一个空格，并将其插入到 mysql 数据库中的单个字段中。

我尝试了以下查询，但是数据库中没有出现空间。

```
stat.executeUpdate("insert into tmpnursetab (name) values ('"+t22.getText()+"' '"+t23.getText()+"')"); 
```

请纠正我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:03:11.067

为什么不在将其传递给查询之前先在 java 中连接？

```
String _value = t22.getText() + " " + t23.getText()
stat.executeUpdate("insert into tmpnursetab (name) values ('" + _value + "')"); 
```

但查询很容易受到`SQL Injection`. 更好的使用`PreparedStatements`

*   [准备好的语句](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)

准备好的语句的例子。

```
String _value = t22.getText() + " " + t23.getText()
String _query = "insert into tmpnursetab (name) values (?)";
PreparedStatement pstmt = con.prepareStatement(_query);
pstmt.setString(1, _value);
pstmt.executeUpdate(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:03:02.540

试试这个：

```
stat.executeUpdate("insert into tmpnursetab (name) values ('"+t22.getText()+" "+t23.getText()+"')"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:06:27.013

使用 mysql 连接`select CONCAT('TEST1' , ' ', 'test2');`

```
insert into tmpnursetab (name) values (CONCAT('TEST1' , ' ', 'test2')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:13:00.950

使用任一

```
stat.executeUpdate("insert into tmpnursetab (name) values ('"+t22.getText()+" "+t23.getText()+"')"); 
```

或在 Oracle DB 上：

```
stat.executeUpdate("insert into tmpnursetab (name) values ('"+t22.getText()+"'|| '"+t23.getText()+"')"); 
```

# php - Code Igniter：使用 jQuery 加载控制器，但禁止直接加载 url

> ID：14523302
> 
> 赞同：0
> 
> 时间：2013-01-25T14:01:32.060
> 
> 标签：php, codeigniter-2

我有一个在 Code Igniter 中构建的网站，它带有一个评论系统，它为每个页面加载一个带有 jQ​​uery 的控制器函数。

我还在加载时将文章 ID 作为 URI 段传递给控制器​​。

假设控制器名称是“comments”，功能是：

```
function get_comments(){
$article_id = $this->uri->segment(3);
echo 'the uri segment is '.$article_id;
} 
```

我使用以下 jQuery 将它们调用到我的页面：

```
$(document).ready(function(){
$('.comments-holder').load('<?php echo base_url();?>comments/get_comments/'<?php echo $article_id;?>);
}); 
```

这很好。

我想要完成的事情是禁止用户通过键入`http://www.domain.com/comments/get_comments/`

我相信可能没有解决这个问题的方法，即使这意味着需要做更多的更改，解决方法也能很好地工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:03:45.787

Code igniter 默认有这个。

在 ajax 操作中添加：

```
if ($this->input->is_ajax_request()) {
    // your regular ajax code
} else {
    // redirect or show error
} 
```

# scroll - 在 Kinetic 中实现滚动的最佳方式

> ID：14523305
> 
> 赞同：0
> 
> 时间：2013-01-25T14:01:53.000
> 
> 标签：scroll, kineticjs

我需要在使用 Kinetic 开发的应用程序中实现滚动。

我看到两个选项：

1.  将主 div 放入另一个 div 并使用浏览器的滚动条。
2.  使用 kinetick 执行滚动功能。

考虑到我必须添加缩放功能（这将改变滚动条），你认为最好的方法是什么？

非常感谢。

# c# - 对象的 ActualWidth 和 ActualHeight 报告为 0？

> ID：14523307
> 
> 赞同：0
> 
> 时间：2013-01-25T14:01:57.820
> 
> 标签：c#, wpf, frameworkelement, actualwidth, actualheight

我有一个应用程序，其中包含多个`Grid`继承自抽象类的实例，`UserControl`如下所示：

```
<abstract:ScoringGrid x:Class="ReadProject.Repeater.ScoringGrid"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:abstract="clr-namespace:ReadProject.AbstractRepeater"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid x:Name="ScoringGridInstance" Width="Auto" Height="Auto">
.... 
```

以及它们继承的类（这是一个非常基本的类，只有几个方法和属性）：

```
public abstract partial class ScoringGrid : UserControl, INotifyPropertyChanged
{... 
```

这些网格是在运行时动态构建的，每个网格的大小都可以变化。当用户关闭应用程序时，我想捕获每个屏幕截图`Grid`并将它们保存到本地机器。为此，我创建了一个方法来获取对象大小并使用`RenderTargetBitmap()`. 他们中的许多人都可以毫无问题地保存，但是有些网格正在返回一个`ActualWidth`和`ActualHeight`，`0`因此没有保存。我不确定从哪里开始调试这个问题，因为它们都是同一个对象的实例；他们中的一些人有他们的`ActualWidth`和`ActualHeight`设置而其他人没有，怎么可能呢？它们都在应用程序中显示没有问题。

如果您需要更多信息/代码，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T18:45:53.177

`UserControl`为了完整起见，我可以通过在捕获它们的屏幕截图之前将这些调用添加到每个调用来解决问题：

```
scoreGrid.Measure(new Size(double.PositiveInfinity, double.PositiveInfinity));
                scoreGrid.Arrange(new Rect(0, 0, scoreGrid.ScoreGridInstance.DesiredSize.Width, scoreGrid.ScoreGridInstance.DesiredSize.Height)); 
```

# c++ - C++ 代码执行缓慢

> ID：14523312
> 
> 赞同：3
> 
> 时间：2013-01-25T14:02:13.777
> 
> 标签：c++, performance, profiler

上周我将递归 Branch&Cut 算法从 Matlab 移植到 C++，并希望看到求解时间显着减少，但尽管听起来令人难以置信，但情况恰恰相反。现在我并不是真正的 C++ 专家，所以我下载了 sleepy profiler 并试图找到潜在的瓶颈。我想问一下我是否从中得出正确的结论，或者我是否正在寻找一个完全错误的方向。

我让代码运行了 137 秒，这就是分析器显示的内容（下面还有许多其他条目，但它们无关紧要）：

![在此处输入图像描述](../Images/2358ce24f464bdad5fd11ea9ae63956a.png)

所以如果我做对了，98 秒用于创建新对象，34 秒用于释放内存（即删除对象）。

我会检查我的代码，看看哪里可以做得更好，但我也想问你是否有任何关于导致这种行为的常见错误或坏习惯的提示。我想到的一件事是我在代码中使用了很多临时的 std::vectors 来计算东西，所以这可能会很慢。

为了防止你失明，在我仔细查看之前我不会发布我的代码，但如果我不能自己解决这个问题，我会回来的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T14:05:49.083

是的，`std::vector`如果误用，s 可能会很昂贵。最大的性能损失可能是重新分配 - 因为大小需要动态调整，并且元素必须在连续内存中，所以每当您添加超出已分配内容的新元素时，就会发生重新分配。

这就是为什么您应该事先声明尺寸。如果您知道必须保存`n`元素，请将其声明为

```
 std::vector<MyClass> x(n); 
```

或者

```
 std::vector<MyClass> x;
 x.reserve(n); 
```

而不仅仅是

```
 std::vector<MyClass> x; 
```

其次是`n`push_backs。

如果在此之后它仍然很慢，您可以提供`std::vector`自定义分配器。我希望你不要到那个地步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:05:46.047

在 Matlab 中，一切都是对对象的引用。因此，当您传递它们时，您相当于复制一个指针（大小约为 int，具体取决于几个因素），而不是复制整个矩阵，这可能更大。

没有看到任何代码，我不能肯定地说，但我怀疑你正在复制大量对象而不是复制对它们的引用。我建议您研究*智能指针*，例如[`std::shared_ptr`](http://en.cppreference.com/w/cpp/memory/shared_ptr).

你没有说清楚，但你应该进行优化编译。( `g++ -O3`.) 一些昂贵的副本和其他操作可以优化出来，但不是全部。

此外，如果您是 C++ 新手，则不应使用`new`. 它是为专家准备的，只有在与同事讨论并喝了一杯浓咖啡后才能使用。（当然，`new`可能会被某些容器代表您使用，例如`std::vector`。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:33:20.807

正如 Luchian Grigore 所说， std::vector 很昂贵。但不仅如此，代码中不断创建对象、移动数据、重新分配内存甚至删除它的任何部分都可能非常耗时。如果亚历克斯·张伯伦所说的是真的，那就有很大的瓶颈。如果不是，我会记得你（或者告诉你，如果你不知道的话），几乎你所做的每一件事都会让你的软件在内存消耗方面更便宜，它会以性能为代价。反之亦然，更多的内存消耗意味着 cpu 的计算量更少，因为你对之前计算的所有内容进行了缓存。这是基本的，但有时我们会忘记它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-25T14:05:55.993

避免在时间关键代码上调用 new & delete。它很慢。或者使用快速内存​​管理器（例如 SmartHeap）。

# html - 响应式表单 - 控制文本区域的高度

> ID：14523319
> 
> 赞同：4
> 
> 时间：2013-01-25T14:02:36.090
> 
> 标签：html, css, forms, textarea, alignment

我有这个**HTML**表单：

```
<form method="post" action="#" class="cf">
    <div class="left">
        <label for="first-name">First Name</label>
        <input type="text" name="first-name" placeholder="First Name" id="first-name" required />
        <label for="last-name">Middle Name</label>
        <input type="text" name="middle-name" placeholder="Middle Name" id="middle-name" />
        <label for="last-name">Last Name</label>
        <input type="text" name="last-name" placeholder="Last Name" id="last-name" required />
    </div>
    <div class="right">
        <label for="details">Details</label>
        <textarea name="details" placeholder="Details" id="details" required></textarea>
    </div>
    <input type="submit" name="submit" value="Submit Form" />
</form> 
```

这是我的**CSS**：

```
/* Clearfix */
.cf:before,.cf:after { content: " "; display: table; }
.cf:after { clear: both; }

form > * {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

.left {
    background: rgba(255, 0, 0, .2);
}

.right {
    background: rgba(0, 255, 0, .2);
}

form {
    background: #ccc;
}

input[type="text"],
textarea {
    width: 100%;
    border: none;
}

input[type="text"] {
    margin-bottom: 10px;
}

label {
    display: inline-block;
    margin-bottom: 5px;
}

@media only screen and (min-width: 600px) {
    form {
        background: rgba(0, 0, 255, .3);
    }

    .left {
        float: left;
        width: 50%;
    }

    .right {
        float: right;
        width: 50%;
    }

    input[type="submit"] {
        clear: both;
    }
} 
```

**小提琴**
[http://jsfiddle.net/gRRmh/](http://jsfiddle.net/gRRmh/)

基本上它是三个文本输入字段，一个文本区域和一个提交按钮（又名输入类型提交）。到达断点时，表单会变成两列布局。这就是起作用的部分。

不工作的部分是文本区域的高度。我希望它与左侧的三个输入字段的高度相同。
将其设置为`height: 100%;`不起作用有两个原因：

*   需要考虑标签的高度。当然，我可以给它一个百分比高度，然后从 textarea 的高度中减去该值（10% / 90%）......
*   ...但是要使它起作用，一个父元素需要一个固定的高度，所以我需要给表单例如高度为 200px。问题是我实际上需要手动匹配左列的高度，这并不是一个好的解决方案。

所以我真正在寻找的是类似以下的东西，只是没有手动轻推像素：（ ![在此处输入图像描述](../Images/5426062b374955227ffb087bb478466d.png) 如果你愿意，也可以使用小提琴，但请注意：它有点乱。http: [//jsfiddle.net/mnBEh/1/](http://jsfiddle.net/mnBEh/1/)）

如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:44:31.413

只能通过手动为 textarea 指定高度来实现。所以在媒体查询中为 textarea 指定高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-07T01:32:28.953

试试这个。它使用 CSS 表格，但我认为它可以通过将 textarea 设置为 100% 高度，然后减去它的标签高度来获得您正在寻找的结果。但是由于某种原因，高度仅在 Chrome 中正确计算，即使其他浏览器应该支持它。 [http://jsfiddle.net/73cyorL1/](http://jsfiddle.net/73cyorL1/)

CSS：

```
.table {
    display: table;
    width: 100%;
}
.row {
    display:table-row;
    width: 100%;
}
.left {
    background: red;
}
.right {
    background: blue;
}
label {
    display: block;
    padding: 10px;
    font-family: arial;
    font-style: italic;
    font-size: 0.75em;
    line-height: 1em;
}
form {
    background: grey;
}
input[type="text"], textarea {
    width: 100%;
    border: none;
    background: #ccc;
    font-family: arial;
    padding: 10px;
    box-sizing: border-box;
    display: block;
}
input[type="text"]:focus, textarea:focus {
    outline: 0;
    background: #ddd;
}
input[type="submit"] {
    display: block;
    margin: 10px;
    padding: 10px;
    cursor: pointer;
}
@media only screen and (min-width: 600px) {
    .left {
        width: 50%;
        height: 100%;
        display: table-cell
    }
    .right {
        width: 50%;
        height: 100%;
        display: table-cell;
        overflow: hidden;
    }
    textarea {
        height: calc(100% - 0.75em);
        /* 100% fill height, minus height of details label */
    }
} 
```

HTML：

```
<form method="post" action="#" class="table">
    <div class="row">
        <div class="left">
            <label for="first-name">First Name</label>
            <input type="text" name="first-name" placeholder="First Name" id="first-name" required="required" />
            <label for="last-name">Middle Name</label>
            <input type="text" name="middle-name" placeholder="Middle Name" id="middle-name" />
            <label for="last-name">Last Name</label>
            <input type="text" name="last-name" placeholder="Last Name" id="last-name" required="required" class="last" />
        </div>
        <div class="right">
            <label for="details">Details</label>
            <textarea name="details" placeholder="Details" id="details" required></textarea>
        </div>
    </div>
    <input type="submit" name="submit" value="Submit Form" />
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-29T17:36:09.743

设置“box-sizing:border-box;” 它会起作用

# facebook - 处理 Facebook 事件

> ID：14523321
> 
> 赞同：0
> 
> 时间：2013-01-25T14:02:42.827
> 
> 标签：facebook

我希望能够在 Facebook 帐户中触发事件。例如，当用户在我的墙上插入帖子时，我想将帖子保存在我的数据库中。有图书馆允许吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:07:24.313

是的。您正在寻找[实时更新](https://developers.facebook.com/docs/reference/api/realtime/)

# java - 看起来像曲棍球棒的数据公式

> ID：14523323
> 
> 赞同：0
> 
> 时间：2013-01-25T14:02:51.693
> 
> 标签：java, math

以下是 X 和 Y 值：

```
X    Y
20   10
100  25
140  50 
```

如果我可以将这些数据近似表示为一个公式并插入从 20 到 140 的任意 X 值，那就太好了。数据似乎有点像曲棍球棒曲线。或者它是指数级的？我可以对此进行编码以仅在这三个点之间创建线性段，但是如果公式可以给我更多平滑的结果会更好。上面的数字并不是一成不变的。它们可能会有所不同。只要公式让我在球场上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:07:54.297

三个点唯一地定义了一个二阶多项式曲线，形式为

y = 轴² + Bx + C

有众所周知的公式可以从点坐标推导出 A、B、C。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:12:16.227

您可以使用多项式或指数方程来近似这种形状，您选择哪种形状取决于您到底想要做什么。

如果您只需要接近某种形状的平滑曲线，则选择一个公式并调整系数，直到它看起来像您想要的那样。

Excel 数据的多项式拟合给出：

```
Y = 0.0036*(X^2) - 0.25*X + 13.542 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:09:01.247

一种方法是实现一些类似于 Excel 提供的[GROWTH函数。](http://office.microsoft.com/en-us/excel-help/growth-function-HA102753003.aspx?CTT=5&origin=HA102752955)假设一些指数增长，它将根据您给它的值插入一个`new_y`值。`new_x`这是一段用 JavaScript 编写的代码。将其翻译成 Java 应该非常简单。

请注意，我从其他人那里借了大部分内容（代码中的学分）。

```
function GROWTH(known_y, known_x, new_x, use_const) {
  // Credits: Ilmari Karonen

  // Default values for optional parameters:
  if (typeof(known_x) == 'undefined') {
    known_x = [];
    for (var i = 1; i <= known_y.length; i++) known_x.push(i);
  }
  if (typeof(new_x) == 'undefined') {
    new_x = [];
    for (var i = 1; i <= known_y.length; i++) new_x.push(i);
  }
  if (typeof(use_const) == 'undefined') use_const = true;

  // Calculate sums over the data:
  var n = known_y.length;
  var avg_x = 0;
  var avg_y = 0;
  var avg_xy = 0;
  var avg_xx = 0; 
  for (var i = 0; i < n; i++) {
    var x = known_x[i];
    var y = Math.log(known_y[i]);
    avg_x += x;
    avg_y += y;
    avg_xy += x*y;
    avg_xx += x*x;
  }
  avg_x /= n;
  avg_y /= n;
  avg_xy /= n;
  avg_xx /= n;

  // Compute linear regression coefficients:
  if (use_const) {
    var beta = (avg_xy - avg_x*avg_y) / (avg_xx - avg_x*avg_x);
    var alpha = avg_y - beta*avg_x;
  } else {
    var beta = avg_xy / avg_xx;
    var alpha = 0;
  }

  // Compute and return result array:
  var new_y = [];
  for (var i = 0; i < new_x.length; i++) {
    new_y.push(Math.exp(alpha + beta * new_x[i]));
  }
  return new_y;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:10:08.940

[您可以使用某种形式的回归分析](http://en.wikipedia.org/wiki/Regression_analysis)将曲线与一组点进行统计拟合。但是，曲线的有效性取决于您拥有的点数；三点并不能使您对您的公式正确有很大的信心。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-25T14:46:30.270

您可以从假设这样的关系开始：

```
y = A*exp(B*x) 
```

取两边的自然对数：

```
ln(y) = ln(A) + B*x 
```

替换任意数量的点并求解这两个系数。这是一个简单的线性回归问题。

这是我从您的数据中得到的：

```
y = exp(2.006369+0.013132*x) 
```

这是生成值的表：

```
X   Y
0   7.436267437
20  9.669855877
40  12.5743343
60  16.35121402
80  21.26253316
100 27.6490367
120 35.95381719
140 46.75305634
160 60.7960002
180 79.0569415
200 102.8028156
220 133.6811
240 173.8341152
260 226.0476583 
```

即使您有大量数据，这也将起作用。

如果你对指数函数进行泰勒级数展开，你会发现它是多项式项的无限级数。二次和三次建议是指数的截断近似。

# objective-c - 清除 CGContext 行

> ID：14523325
> 
> 赞同：1
> 
> 时间：2013-01-25T14:02:54.947
> 
> 标签：objective-c, iphone, cgcontext, brush

一旦我在 UIImage 上画了一些线（如画笔应用程序），然后我想清除它们，就像橡皮一样。我在这个网站和谷歌上搜索了很多，我尝试了一些代码，但我找不到正确的解决方案。这是我用来编写的代码：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    if(isDrawing == YES) {

        UITouch *touch = [touches anyObject];
        CGPoint currentPoint = [touch locationInView:mainImageView.superview];

        UIGraphicsBeginImageContext(mainImageView.frame.size);
        [mainImageView.image drawInRect:CGRectMake(0, 0, mainImageView.frame.size.width, mainImageView.frame.size.height)];

        CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
        CGContextSetLineWidth(UIGraphicsGetCurrentContext(), dimension);

        const CGFloat *components = CGColorGetComponents([color CGColor]);
        CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), components[0], components[1], components[2], components[3]);

        CGContextBeginPath(UIGraphicsGetCurrentContext());
        CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
        CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
        CGContextStrokePath(UIGraphicsGetCurrentContext());

        mainImageView.image = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        lastPoint = currentPoint;

    } else {
        //Clear current line (like a rubber would do)
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:57:31.450

在这种情况下`[UIColor clearColor]`不起作用，使用`CGContextClearRect(context,rect);`清除区域​​！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:34:43.600

用 .填充上下文的所需部分`[UIColor clearColor]`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-03T11:50:26.523

正确的方法是使用 Bezier 路径：

*   记录每幅画（但实际上不画..在DrawRect中我们将画..使用“stroke”）
*   有厚度、颜色等...
*   有效地在视图上绘制

清除它（使用“removeAllPoints”）并调用 setNeedsDisplay 将使背景重新出现。

如果您想使用其他工具清除您编写的路径（例如您使用铅笔工具以蓝色书写.. 以及使用橡胶工具清除蓝线并使背景重新出现）您可以使用“containsPoint：”从贝塞尔路径中删除一些点。

我们是这样做的。

使用贝塞尔路径并非微不足道，但非常令人兴奋.. :)

# c - 将 2 个数字与程序集进行比较

> ID：14523333
> 
> 赞同：-1
> 
> 时间：2013-01-25T14:03:24.240
> 
> 标签：c, assembly

我有以下代码。我想完成如下所示的汇编代码：

```
int main(void)
{
    int x = 10;

    int i=0;
    label1:

    asm (.....) // code to add here: if i>=x then jump to label2

    printf("%d\n",i);

    i++;
    asm (.....) // code to add here: jump to label 1
    label2:

    printf("out\n");
} 
```

我的机器是 x86，操作系统是 Ubuntu 12

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T14:30:01.693

首先，给自己一个 x86 操作码列表，应该很容易在网上找到。

该`asm()`函数遵循以下顺序：

```
asm ( "assembly code"
           : output operands                  /* optional */
           : input operands                   /* optional */
           : list of clobbered registers      /* optional */
); 
```

其次，您遇到的一个主要问题是您不能“跳转”到 C 标签，您需要将标签设置为“汇编”标签才能跳转到它。前任：

```
int main()
{
  asm("jmp .end");    // make a call to jmp there
  printf("Hello ");
  asm(".end:");       //make a "jumpable" label
  printf("World\n");
  return 0;
} 
```

当我们跳过“Hello”时，该程序的输出只是“World”。这是相同的示例，但有一个比较跳跃：

```
int main()
{
    int x = 5, i = 0;
    asm(".start:");
    asm("cmp %0, %1;"   // compare input 1 to 2
        "jge .end;"     // if i >= x, jump to .end
        :               // no output from this code
        : "r" (x), "r" (i));  // input's are var x and i
    printf("Hello ");
    i++;
    asm("jmp .start;");    
    asm(".end:");
    printf("World\n");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:09:54.333

如果您不是真的必须在这里使用汇编，您可以更轻松地使用 C，并且至少与汇编版本一样高效：

```
int x = 10;
int i = 0;
while(i < x) {
  printf("%d\n",i);
  i++;
}
printf("out\n"); 
```

（a `for`-loop 也适用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:24:42.203

我不记得在 c 中使用汇编程序的语义，但通常当您在汇编程序中比较一个数字时，您会将这些数字相减。如果它们是相同的数字，则将设置零位，因此您可以进行条件跳转。请务必使用正确的寄存器来匹配 int 的大小。

非常粗略的示例代码（这不是我的想法，我写汇编程序已经好几年了）：

```
#load value to compare against into BX
#load number to check into AX
CMP AX, BX
JE label 
```

更新：按照@harold 的建议将 SUB 更改为 CMP

# java - ChangeListener 未检测到更新的变量

> ID：14523334
> 
> 赞同：0
> 
> 时间：2013-01-25T14:03:28.800
> 
> 标签：java, swing, changelistener

有 2 组 4 个按钮正在创建。

将`ImageIcon`第一组按钮的 拖到第二组按钮上。

布尔`enab`变量用于确定是否启用了第二组 4 个按钮。我最初将布尔值设置为`false`，只有当`ImageIcon`第一组按钮被拖过去时，`enab`值才会更改为`true`。

但是，当我将图像拖到上面时，第二组按钮仍然处于禁用状态。

我插入了 System.out.println 语句来查看它哪里出错了，结果是`enab`变量被更新但`stateChanged`方法根本没有运行。

如何获得`stateChanged`方法来检测它所听的按钮是否已启用它运行？

```
public class Test extends JFrame {
    private boolean enab = false;
    private JButton[] button = new JButton[4];
    private JButton[] rg = new JButton[4];
    private JPanel leftg;
    private String id,id2;
    private int cc,cc2;
    private String name1;
    private BufferedImage bi;

    public Test(){
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        // creates a new panel for the splitted puzzle pieces
        leftg = new JPanel();
        leftg.setLayout(new GridLayout(2,2));
        leftg.setPreferredSize(new Dimension(600,400));

        bi = new BufferedImage(200,133,BufferedImage.TYPE_INT_RGB);

    // creates 4 buttons   
    for(int a=0; a<4; a++){

        button[a] = new JButton(new ImageIcon(bi));   
        TransferHandler transfer = new TransferHandler("icon");
        button[a].setTransferHandler(transfer);
         //MouseListener ml = new MouseListener(){ 
        //button[a].addMouseListener(ml);
        button[a].addMouseListener(new MouseAdapter(){
            public void mousePressed(MouseEvent e){
            JButton button = (JButton)e.getSource();
            TransferHandler handle = button.getTransferHandler();
            handle.exportAsDrag(button, e, TransferHandler.COPY);
            name1 = e.getComponent().getName();
            System.out.println(name1);
            enab = true;
            System.out.println("enabled0:" + enab); // prints true
            }       

        });
            // adds the 4 buttons to panel
            leftg.add(button[a]);        
    }

// adds leftg panel into the frame      
this.add(leftg,BorderLayout.WEST);

// creates a new panel for the completed puzzle pieces
JPanel cp = new JPanel();
cp.setLayout(new GridLayout(2,2));
cp.setPreferredSize(new Dimension(600,400));

// creates another 4 buttons for stuff to be dragged to
for(int b=0; b<4; b++){

     rg[b] = new JButton();
     id2 += Integer.toString(++cc2);
     // unique name for each button as an ID
     rg[b].setName(id2); 
     TransferHandler transfer1 = new TransferHandler("icon");
     rg[b].setTransferHandler(transfer1);
     rg[b].setEnabled(enab);
     System.out.println("enabled00:" + enab); // prints false 

     ChangeListener clistener = new ChangeListener(){                 
         public void stateChanged(ChangeEvent ce) {

             JButton source = (JButton)ce.getSource();
             ButtonModel mod = source.getModel();
             System.out.println("enabled1:" + enab); // no output

               if (mod.isEnabled()){
                System.out.println("enabled2:" + enab); // no output
                    if(name1 == source.getName()){

                    }
                    else{
                        source.setIcon(null);
                    }
               }  
               else{        
               }
     };
     };
rg[b].addChangeListener(clistener);
// adds the 4 buttons to panel
cp.add(rg[b]);
}  
// adds rg panel to frame
this.add(cp,BorderLayout.EAST);

this.pack();
this.setVisible(true);
this.setLocationRelativeTo(null);
}
public static void main(String[] args){
    new Test();  
 }

} 
```

# javascript - 未从 QWebFrame/QWebView 调用 Javascript 函数

> ID：14523341
> 
> 赞同：0
> 
> 时间：2013-01-25T14:04:03.670
> 
> 标签：javascript, qt

有人可以解释为什么我的 JavaScript 函数没有被调用。

JS函数是：

```
function loadKMLFile(kmlUrl)
{
    alert('in loadKMLFile().');
    google.earth.fetchKml(ge, kmlUrl, finishFetchKml);
} 
```

我的 C++ Qt 代码是：

```
void MainWindow::on_loadKML_button_clicked()
{
    QString fileUrl = ui->textEdit->toPlainText(); // Get path to file
    ui->webView->page()->mainFrame()->evaluateJavaScript("loadKMLFile(" + fileUrl + ")");
} 
```

当我运行我的应用程序时，我输入了要加载的文件的路径。然后由上面的 C++ 方法提取，并通过路径中传递的 evaluateJavaScript 进行调用。

如果传入的路径为空字符串，则调用JS函数并出现警告框。如果在文本编辑中放置单个字符（更不用说整个路径），则不会调用该函数我不会出现警告框。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T16:31:06.153

你已经启用 javascript 了吗？

```
webView->page()->settings()->testAttribute( QWebSettings::JavascriptEnabled ); 
```

参考：[qwebsettings WebAttribute](http://doc.qt.digia.com/snapshot/qwebsettings.html#WebAttribute-enum)

# ios - 突出显示时如何更改 UIButton 的背景颜色？

> ID：14523348
> 
> 赞同：260
> 
> 时间：2013-01-25T14:04:22.507
> 
> 标签：ios, objective-c, xcode, uibutton

在我的应用程序的某个时刻，我有一个突出显示`UIButton`（例如，当用户将手指放在按钮上时）并且我需要在按钮突出显示时更改背景颜色（因此当用户的手指仍在按钮上时） .

我尝试了以下方法：

```
_button.backgroundColor = [UIColor redColor]; 
```

但它不起作用。颜色保持不变。当按钮未突出显示并且工作正常时，我尝试了相同的代码。我也尝试在更改颜色后调用`-setNeedsDisplay`，它没有任何效果。

如何强制按钮更改背景颜色？

* * *

## 回答 #1

> 赞同：437
> 
> 时间：2013-07-11T19:56:34.477

您可以覆盖`UIButton`的`setHighlighted`方法。

**Objective-C**

```
- (void)setHighlighted:(BOOL)highlighted {
    [super setHighlighted:highlighted];

    if (highlighted) {
        self.backgroundColor = UIColorFromRGB(0x387038);
    } else {
        self.backgroundColor = UIColorFromRGB(0x5bb75b);
    }
} 
```

**斯威夫特 3.0 和斯威夫特 4.1**

```
override open var isHighlighted: Bool {
    didSet {
        backgroundColor = isHighlighted ? UIColor.black : UIColor.white
    }
} 
```

* * *

## 回答 #2

> 赞同：305
> 
> 时间：2013-01-25T15:40:36.447

不确定这种方法是否能解决您所追求的问题，或者是否适合您的一般开发环境，但我会尝试的第一件事是更改 touchDown 事件上按钮的背景颜色。

**选项1：**

您需要捕获两个事件，UIControlEventTouchDown 用于用户按下按钮时。UIControlEventTouchUpInside 和 UIControlEventTouchUpOutside 将在他们释放按钮时将其返回到正常状态

```
UIButton *myButton =  [UIButton buttonWithType:UIButtonTypeCustom];
[myButton setFrame:CGRectMake(10.0f, 10.0f, 100.0f, 20.f)];
[myButton setBackgroundColor:[UIColor blueColor]];
[myButton setTitle:@"click me:" forState:UIControlStateNormal];
[myButton setTitle:@"changed" forState:UIControlStateHighlighted];
[myButton addTarget:self action:@selector(buttonHighlight:) forControlEvents:UIControlEventTouchDown];
[myButton addTarget:self action:@selector(buttonNormal:) forControlEvents:UIControlEventTouchUpInside]; 
```

**选项 2：**

返回由您想要的突出显示颜色制成的图像。这也可以是一个类别。

```
+ (UIImage *)imageWithColor:(UIColor *)color {
   CGRect rect = CGRectMake(0.0f, 0.0f, 1.0f, 1.0f);
   UIGraphicsBeginImageContext(rect.size);
   CGContextRef context = UIGraphicsGetCurrentContext();

   CGContextSetFillColorWithColor(context, [color CGColor]);
   CGContextFillRect(context, rect);

   UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
   UIGraphicsEndImageContext();

   return image;
} 
```

然后更改按钮的突出显示状态：

```
[myButton setBackgroundImage:[self imageWithColor:[UIColor greenColor]] forState:UIControlStateHighlighted]; 
```

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2015-03-21T18:24:07.717

无需重写`highlighted`为计算属性。您可以使用属性观察器来触发背景颜色更改：

```
override var highlighted: Bool {
    didSet {
        backgroundColor = highlighted ? UIColor.lightGrayColor() : UIColor.whiteColor()
    }
} 
```

**斯威夫特 4**

```
override open var isHighlighted: Bool {
    didSet {
        backgroundColor = isHighlighted ? UIColor.lightGray : UIColor.white
    }
} 
```

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2014-11-23T22:55:16.127

Swift 中一个方便的通用扩展：

```
extension UIButton {
    private func imageWithColor(color: UIColor) -> UIImage {
        let rect = CGRectMake(0.0, 0.0, 1.0, 1.0)
        UIGraphicsBeginImageContext(rect.size)
        let context = UIGraphicsGetCurrentContext()

        CGContextSetFillColorWithColor(context, color.CGColor)
        CGContextFillRect(context, rect)

        let image = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()

        return image
    }

    func setBackgroundColor(color: UIColor, forUIControlState state: UIControlState) {
        self.setBackgroundImage(imageWithColor(color), forState: state)
    }
} 
```

**斯威夫特 3.0**

```
extension UIButton {
    private func imageWithColor(color: UIColor) -> UIImage? {
        let rect = CGRect(x: 0.0, y: 0.0, width: 1.0, height: 1.0)
        UIGraphicsBeginImageContext(rect.size)
        let context = UIGraphicsGetCurrentContext()

        context?.setFillColor(color.cgColor)
        context?.fill(rect)

        let image = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()

        return image
    }

    func setBackgroundColor(_ color: UIColor, for state: UIControlState) {
        self.setBackgroundImage(imageWithColor(color: color), for: state)
    }
} 
```

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2014-10-07T17:54:25.373

在 Swift 中，您可以覆盖高亮（或选定）属性的访问器，而不是覆盖 setHighlighted 方法

```
override var highlighted: Bool {
        get {
            return super.highlighted
        }
        set {
            if newValue {
                backgroundColor = UIColor.blackColor()
            }
            else {
                backgroundColor = UIColor.whiteColor()
            }
            super.highlighted = newValue
        }
    } 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2015-02-03T07:51:26.603

覆盖突出显示的变量。添加`@IBInspectable`使您可以在情节提要中编辑突出显示的背景颜色，这也很漂亮。

```
class BackgroundHighlightedButton: UIButton {
    @IBInspectable var highlightedBackgroundColor :UIColor?
    @IBInspectable var nonHighlightedBackgroundColor :UIColor?
    override var highlighted :Bool {
        get {
            return super.highlighted
        }
        set {
            if newValue {
                self.backgroundColor = highlightedBackgroundColor
            }
            else {
                self.backgroundColor = nonHighlightedBackgroundColor
            }
            super.highlighted = newValue
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2016-03-26T03:10:16.747

一个更紧凑的解决方案（基于**@aleksejs-mjaliks 的**回答）：

**斯威夫特 3/4+**：

```
override var isHighlighted: Bool {
    didSet {
        backgroundColor = isHighlighted ? .lightGray : .white
    }
} 
```

斯威夫特 2：

```
override var highlighted: Bool {
    didSet {
        backgroundColor = highlighted ? UIColor.lightGrayColor() : UIColor.whiteColor()
    }
} 
```

如果您不想覆盖，这是**@timur-bernikowich**答案的更新版本（**Swift 4.2**）：

```
extension UIButton {
  func setBackgroundColor(_ color: UIColor, forState controlState: UIControl.State) {
    let colorImage = UIGraphicsImageRenderer(size: CGSize(width: 1, height: 1)).image { _ in
      color.setFill()
      UIBezierPath(rect: CGRect(x: 0, y: 0, width: 1, height: 1)).fill()
    }
    setBackgroundImage(colorImage, for: controlState)
  }
} 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2017-06-02T09:49:14.993

**我对Swift 3+**没有子类化的最佳解决方案。

```
extension UIButton {
  func setBackgroundColor(_ color: UIColor, for state: UIControlState) {
    let rect = CGRect(x: 0, y: 0, width: 1, height: 1)
    UIGraphicsBeginImageContext(rect.size)
    color.setFill()
    UIRectFill(rect)
    let colorImage = UIGraphicsGetImageFromCurrentImageContext()
    UIGraphicsEndImageContext()
    setBackgroundImage(colorImage, for: state)
  }
} 
```

使用此扩展程序，可以轻松管理不同状态的颜色，并且如果未提供突出显示的颜色，它会自动淡化您的正常颜色。

```
button.setBackgroundColor(.red, for: .normal) 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2016-10-05T08:22:23.023

**使用Swift 3+**语法的 UIButton 扩展：

```
extension UIButton {
    func setBackgroundColor(color: UIColor, forState: UIControlState) {
        UIGraphicsBeginImageContext(CGSize(width: 1, height: 1))
        UIGraphicsGetCurrentContext()!.setFillColor(color.cgColor)
        UIGraphicsGetCurrentContext()!.fill(CGRect(x: 0, y: 0, width: 1, height: 1))
        let colorImage = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        self.setBackgroundImage(colorImage, for: forState)
    }} 
```

像这样使用它：

```
YourButton.setBackgroundColor(color: UIColor.white, forState: .highlighted) 
```

原始答案： [https ://stackoverflow.com/a/30604658/3659227](https://stackoverflow.com/a/30604658/3659227)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2015-04-06T19:17:19.667

这是 Swift 中的一种方法，使用 UIButton 扩展添加 IBInspectable，称为 highlightBackgroundColor。类似于子类化，不需要子类。

```
private var HighlightedBackgroundColorKey = 0
private var NormalBackgroundColorKey = 0

extension UIButton {

    @IBInspectable var highlightedBackgroundColor: UIColor? {
        get {
            return objc_getAssociatedObject(self, &HighlightedBackgroundColorKey) as? UIColor
        }

        set(newValue) {
            objc_setAssociatedObject(self,
                &HighlightedBackgroundColorKey, newValue, UInt(OBJC_ASSOCIATION_RETAIN))
        }
    }

    private var normalBackgroundColor: UIColor? {
        get {
            return objc_getAssociatedObject(self, &NormalBackgroundColorKey) as? UIColor
        }

        set(newValue) {
            objc_setAssociatedObject(self,
                &NormalBackgroundColorKey, newValue, UInt(OBJC_ASSOCIATION_RETAIN))
        }
    }

    override public var backgroundColor: UIColor? {
        didSet {
            if !highlighted {
                normalBackgroundColor = backgroundColor
            }
        }
    }

    override public var highlighted: Bool {
        didSet {
            if let highlightedBackgroundColor = self.highlightedBackgroundColor {
                if highlighted {
                    backgroundColor = highlightedBackgroundColor
                } else {
                    backgroundColor = normalBackgroundColor
                }
            }
        }
    }
} 
```

我希望这有帮助。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2015-01-22T16:00:25.387

您可以使用此类别添加方法**setBackgroundColor:forState:**

[https://github.com/damienrometo/UIButton-setBackgroundColor-forState-](https://github.com/damienromito/UIButton-setBackgroundColor-forState-)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2019-10-08T20:13:28.320

## 细节

*   Xcode 11.1 (11A1027)、斯威夫特 5

## 解决方案

```
import UIKit

extension UIColor {
    func createOnePixelImage() -> UIImage? {
        let size = CGSize(width: 1, height: 1)
        UIGraphicsBeginImageContext(size)
        defer { UIGraphicsEndImageContext() }
        guard let context = UIGraphicsGetCurrentContext() else { return nil }
        context.setFillColor(cgColor)
        context.fill(CGRect(origin: .zero, size: size))
        return UIGraphicsGetImageFromCurrentImageContext()
    }
}

extension UIButton {
    func setBackground(_ color: UIColor, for state: UIControl.State) {
        setBackgroundImage(color.createOnePixelImage(), for: state)
    }
} 
```

## 用法

```
button.setBackground(.green, for: .normal) 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2015-03-27T11:53:53.500

试试这个 ！！！！

为 TouchedDown 事件设置一种颜色，为 TouchUpInside 设置另一种颜色。

```
- (IBAction)touchedDown:(id)sender {
    NSLog(@"Touched Down");
    btn1.backgroundColor=[UIColor redColor];
}

- (IBAction)touchUpInside:(id)sender {
    NSLog(@"TouchUpInside");
    btn1.backgroundColor=[UIColor whiteColor];    
} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2019-09-04T06:14:01.037

```
extension UIButton {
    func setBackgroundColor(color: UIColor, forState: UIControl.State) {
        let size = CGSize(width: 1, height: 1)
        UIGraphicsBeginImageContext(size)
        let context = UIGraphicsGetCurrentContext()
        context?.setFillColor(color.cgColor)
        context?.fill(CGRect(origin: CGPoint.zero, size: size))
        let colorImage = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()
        setBackgroundImage(colorImage, for: forState)
    }

} 
```

**Swift 5**，谢谢@Maverick

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2014-04-11T16:44:19.483

更新：

使用[UIButtonBackgroundColor](https://github.com/acani/UIButtonBackgroundColor) Swift 库。

老的：

使用下面的助手创建一个 1 px x 1 px 的带有灰度填充颜色的图像：

```
UIImage *image = ACUTilingImageGray(248/255.0, 1); 
```

或 RGB 填充颜色：

```
UIImage *image = ACUTilingImageRGB(253/255.0, 123/255.0, 43/255.0, 1); 
```

然后，使用它`image`来设置按钮的背景图像：

```
[button setBackgroundImage:image forState:UIControlStateNormal]; 
```

### 帮手

```
#pragma mark - Helpers

UIImage *ACUTilingImageGray(CGFloat gray, CGFloat alpha)
{
    return ACUTilingImage(alpha, ^(CGContextRef context) {
        CGContextSetGrayFillColor(context, gray, alpha);
    });
}

UIImage *ACUTilingImageRGB(CGFloat red, CGFloat green, CGFloat blue, CGFloat alpha)
{
    return ACUTilingImage(alpha, ^(CGContextRef context) {
        CGContextSetRGBFillColor(context, red, green, blue, alpha);
    });
}

UIImage *ACUTilingImage(CGFloat alpha, void (^setFillColor)(CGContextRef context))
{
    CGRect rect = CGRectMake(0, 0, 0.5, 0.5);
    UIGraphicsBeginImageContextWithOptions(rect.size, alpha == 1, 0);
    CGContextRef context = UIGraphicsGetCurrentContext();
    setFillColor(context);
    CGContextFillRect(context, rect);
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return image;
} 
```

注意：`ACU`是我的 Cocoa Touch 静态库名为 Acani Utilities 的类前缀，其中 AC 代表 Acani，U 代表 Utilities。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2020-04-16T19:40:47.990

简单就是只使用那个 UIButton 扩展

```
extension UIButton {

    func setBackgroundColor(color: UIColor, forState: UIControl.State) {
        self.clipsToBounds = true  // add this to maintain corner radius
        UIGraphicsBeginImageContext(CGSize(width: 1, height: 1))
        if let context = UIGraphicsGetCurrentContext() {
            context.setFillColor(color.cgColor)
            context.fill(CGRect(x: 0, y: 0, width: 1, height: 1))
            let colorImage = UIGraphicsGetImageFromCurrentImageContext()
            UIGraphicsEndImageContext()
            self.setBackgroundImage(colorImage, for: forState)
        }
    }

} 
```

并使用它

```
 optionButton.setBackgroundColor(color: UIColor(red:0.09, green:0.42, blue:0.82, alpha:1.0), forState: .selected)

 optionButton.setBackgroundColor(color: UIColor(red:0.96, green:0.96, blue:0.96, alpha:1.0), forState: .highlighted)

 optionButton.setBackgroundColor(color: UIColor(red:0.96, green:0.96, blue:0.96, alpha:1.0), forState: .normal) 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2016-11-24T09:02:25.927

子类化 UIButton 并添加可检查的属性以方便使用（用 Swift 3.0 编写）：

```
final class SelectableBackgroundButton: UIButton {

    private struct Constants {
        static let animationDuration: NSTimeInterval = 0.1
    }

    @IBInspectable
    var animatedColorChange: Bool = true

    @IBInspectable
    var selectedBgColor: UIColor = UIColor.blackColor().colorWithAlphaComponent(0.2)

    @IBInspectable
    var normalBgColor: UIColor = UIColor.clearColor()

    override var selected: Bool {
        didSet {
            if animatedColorChange {
                UIView.animateWithDuration(Constants.animationDuration) {
                    self.backgroundColor = self.selected ? self.selectedBgColor : self.normalBgColor
                }
            } else {
                self.backgroundColor = selected ? selectedBgColor : normalBgColor
            }
        }
    }

    override var highlighted: Bool {
        didSet {
            if animatedColorChange {
                UIView.animateWithDuration(Constants.animationDuration) {
                    self.backgroundColor = self.highlighted ? self.selectedBgColor : self.normalBgColor
                }
            } else {
                self.backgroundColor = highlighted ? selectedBgColor : normalBgColor
            }
        }
    }
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2014-12-18T14:07:08.687

您可以继承 UIButton 并制作一个不错的 forState。

**颜色按钮.h**

```
#import <UIKit/UIKit.h>

@interface colourButton : UIButton

-(void)setBackgroundColor:(UIColor *)backgroundColor forState:(UIControlState)state;

@end 
```

**颜色按钮.m**

```
#import "colourButton.h"

@implementation colourButton
{
    NSMutableDictionary *colours;
}

-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];

    // If colours does not exist
    if(!colours)
    {
        colours = [NSMutableDictionary new];  // The dictionary is used to store the colour, the key is a text version of the ENUM
        colours[[NSString stringWithFormat:@"%lu", UIControlStateNormal]] = (UIColor*)self.backgroundColor;  // Store the original background colour
    }

    return self;
}

-(void)setBackgroundColor:(UIColor *)backgroundColor forState:(UIControlState)state
{
    // If it is normal then set the standard background here
    if(state & UIControlStateNormal)
    {
        [super setBackgroundColor:backgroundColor];
    }

    // Store the background colour for that state
    colours[[NSString stringWithFormat:@"%lu", state]]= backgroundColor;
}

-(void)setHighlighted:(BOOL)highlighted
{
    // Do original Highlight
    [super setHighlighted:highlighted];

    // Highlight with new colour OR replace with orignial
    if (highlighted && colours[[NSString stringWithFormat:@"%lu", UIControlStateHighlighted]])
    {
        self.backgroundColor = colours[[NSString stringWithFormat:@"%lu", UIControlStateHighlighted]];
    }
    else
    {
        self.backgroundColor = colours[[NSString stringWithFormat:@"%lu", UIControlStateNormal]];
    }
}

-(void)setSelected:(BOOL)selected
{
    // Do original Selected
    [super setSelected:selected];

    // Select with new colour OR replace with orignial
    if (selected && colours[[NSString stringWithFormat:@"%lu", UIControlStateSelected]])
    {
        self.backgroundColor = colours[[NSString stringWithFormat:@"%lu", UIControlStateSelected]];
    }
    else
    {
        self.backgroundColor = colours[[NSString stringWithFormat:@"%lu", UIControlStateNormal]];
    }
}

@end 
```

**注释**（这是一个例子，我知道有问题，这里有一些）

我使用 NSMutableDictionay 来存储每个状态的 UIColor，我必须对 Key 进行令人讨厌的文本转换，因为 UIControlState 不是一个很好的直接 Int。如果你可以用这么多对象初始化一个数组并使用状态作为索引。

正因为如此，很多人在选择和禁用按钮时遇到困难，需要更多的逻辑。

另一个问题是，如果您尝试同时设置多种颜色，我没有尝试使用按钮，但如果您可以这样做，它可能无法正常工作

```
 [btn setBackgroundColor:colour forState:UIControlStateSelected & UIControlStateHighlighted]; 
```

我假设这是 StoryBoard，没有 init 和 initWithFrame，因此如果需要，请添加它们。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-01-25T14:26:55.187

如果您有图像，请尝试以下操作：

```
-(void)setBackgroundImage:(UIImage *)image forState:(UIControlState)state; 
```

或者看看`showsTouchWhenHighlighted`对你来说是否足够。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2015-05-27T00:27:27.640

我开源了一个 UIButton 子类[STAButton](https://github.com/Stunner/STAControls/blob/master/STAControls/STAControls/Button/STAButton.m)来填补这个巨大的功能漏洞。在 MIT 许可下可用。适用于 iOS 7+（我没有测试过旧的 iOS 版本）。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-02-09T21:25:11.600

为了解决这个问题，我创建了一个类别来处理`backgroundColor`状态`UIButtons`：
[ButtonBackgroundColor-iOS](https://github.com/GabrielMassana/ButtonBackgroundColor-iOS/tree/master/ButtonBackgroundColor-iOS)

您可以将类别安装为[pod](https://github.com/GabrielMassana/ButtonBackgroundColor-iOS/blob/master/README.md)。

易于使用**Objective-C**

```
@property (nonatomic, strong) UIButton *myButton;

...

[self.myButton bbc_backgroundColorNormal:[UIColor redColor]
                 backgroundColorSelected:[UIColor blueColor]]; 
```

**使用Swift**更容易使用：

```
import ButtonBackgroundColor

...

let myButton:UIButton = UIButton(type:.Custom)

myButton.bbc_backgroundColorNormal(UIColor.redColor(), backgroundColorSelected: UIColor.blueColor()) 
```

我建议您使用以下命令导入 pod：

```
platform :ios, '8.0'
use_frameworks!

pod 'ButtonBackgroundColor', '~> 1.0' 
```

使用 use_frameworks！在你的 Podfile 中使用 Swift 和 Objective-C 可以更容易地使用你的 pod。

**重要的**

[**我还写了一篇博文，提供更多信息。**](https://somethingaboutios.wordpress.com/2016/02/09/uibutton-backgroundcolor-for-uicontrolstateselected/)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-06-28T10:13:48.603

```
class CustomButton: UIButton {

    override var isHighlighted: Bool {
        didSet {
            if (isHighlighted) {
                alpha = 0.5
            }
            else {
                alpha = 1
            }            
        }
    }

} 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2018-09-03T18:09:29.210

使用[https://github.com/swordray/UIButtonSetBackgroundColorForState](https://github.com/swordray/UIButtonSetBackgroundColorForState)

使用 CocoaPods 添加到 Podfile

```
pod "UIButtonSetBackgroundColorForState" 
```

**迅速**

```
button.setBackgroundColor(.red, forState: .highlighted) 
```

**Objective-C**

```
[button setBackgroundColor:[UIColor redColor] forState:UIControlStateHighlighted]; 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-01-25T14:06:28.933

尝试`tintColor`：

```
_button.tintColor = [UIColor redColor]; 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-01-06T07:56:51.457

这是 Swift 中选择按钮状态的代码：

```
func imageWithColor(color:UIColor) -> UIImage {
    let rect:CGRect = CGRectMake(0.0, 0.0, 1.0, 1.0)
     UIGraphicsBeginImageContext(rect.size)
    let context:CGContextRef = UIGraphicsGetCurrentContext()!
    CGContextSetFillColorWithColor(context, color.CGColor)
    CGContextFillRect(context, rect)
    let image:UIImage = UIGraphicsGetImageFromCurrentImageContext();
    return image;
} 
```

例子：

```
 self.button.setImage(self.imageWithColor(UIColor.blackColor()), forState: .Highlighted) 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-02-01T09:00:05.063

把它放进去就可以了：
*proerty 可以在 IB 中设置，如果没有设置高亮背景，按下时背景不会改变

```
private var highlightedBackgroundColors = [UIButton:UIColor]()
private var unhighlightedBackgroundColors = [UIButton:UIColor]()
extension UIButton {

    @IBInspectable var highlightedBackgroundColor: UIColor? {
        get {
            return highlightedBackgroundColors[self]
        }

        set {
            highlightedBackgroundColors[self] = newValue
        }
    }

    override open var backgroundColor: UIColor? {
        get {
            return super.backgroundColor
        }

        set {
            unhighlightedBackgroundColors[self] = newValue
            super.backgroundColor = newValue
        }
    }

    override open var isHighlighted: Bool {
        get {
            return super.isHighlighted
        }

        set {
            if highlightedBackgroundColor != nil {
                super.backgroundColor = newValue ? highlightedBackgroundColor : unhighlightedBackgroundColors[self]
            }
            super.isHighlighted = newValue
        }
    }
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2022-03-02T13:53:37.883

`setBackgroundImage`您可以通过简单地使用UIButton 上的方法并使用此`UIImage(color:)`初始化程序使用图像来轻松更改突出显示/选定的按钮背景颜色，如下所示：

```
btn.setBackgroundImage(UIImage(color: .black), for: .highlighted) 
```

**笔记：**

如果您将该`cornerRadius`属性用于圆角边框，则必须将 设置为`clipsToBounds`，`true`以便选定的背景颜色将保留角半径值。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2016-12-28T10:35:03.323

如果您不覆盖只需设置两个动作 touchDown touchUpInside

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-02-15T06:10:29.283

下面`UIIImage`的扩展将生成具有指定颜色参数的图像对象。

```
extension UIImage {
    static func imageWithColor(tintColor: UIColor) -> UIImage {
        let rect = CGRect(x: 0, y: 0, width: 1, height: 1)
        UIGraphicsBeginImageContextWithOptions(rect.size, false, 0)
        tintColor.setFill()
        UIRectFill(rect)
        let image: UIImage = UIGraphicsGetImageFromCurrentImageContext()!
        UIGraphicsEndImageContext()
        return image
       }
    } 
```

按钮的示例用法可以应用于按钮对象：

```
setupButton.setBackgroundImage(UIImage.imageWithColor(tintColor: UIColor(displayP3Red: 232/255, green: 130/255, blue: 121/255, alpha: 1.0)), for: UIControlState.highlighted)

setupButton.setBackgroundImage(UIImage.imageWithColor(tintColor: UIColor(displayP3Red: 255/255, green: 194/255, blue: 190/255, alpha: 1.0)), for: UIControlState.normal) 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2017-04-25T12:14:53.290

斯威夫特 3：

```
extension UIButton {
    private func imageWithColor(color: UIColor) -> UIImage {
        let rect = CGRect(x:0.0,y:0.0,width: 1.0,height: 1.0)
        UIGraphicsBeginImageContext(rect.size)
        let context = UIGraphicsGetCurrentContext()

        context!.setFillColor(color.cgColor)
        context!.fill(rect)

        let image = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()

        return image!
    }

    func setBackgroundColor(color: UIColor, forUIControlState state: UIControlState) {
        self.setBackgroundImage(imageWithColor(color: color), for: state)
    }
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-06-12T23:09:25.400

在斯威夫特 5

对于那些不想使用彩色背景来击败选定状态的人

只需使用#Selector & if 语句轻松地单独更改每个状态的 UIButton 颜色即可解决问题

例如：

```
 override func viewDidLoad() {
    super.viewDidLoad()
    self.myButtonOutlet.backgroundColor = UIColor.white  //to reset the button color to its original color ( optionally )
}

@IBOutlet weak var myButtonOutlet: UIButton!{
    didSet{  // Button selector and image here
        self.myButtonOutlet.setImage(UIImage(systemName: ""), for: UIControl.State.normal)

        self.myButtonOutlet.setImage(UIImage(systemName: "checkmark"), for: UIControl.State.selected)

        self.myButtonOutlet.addTarget(self, action: #selector(tappedButton), for: UIControl.Event.touchUpInside)
    }
}

@objc func tappedButton() {  // Colors selection is here
    if self.myButtonOutlet.isSelected == true {

        self.myButtonOutlet.isSelected = false
        self.myButtonOutlet.backgroundColor = UIColor.white         
    } else {
        self.myButtonOutlet.isSelected = true

        self.myButtonOutlet.backgroundColor = UIColor.black
        self.myButtonOutlet.tintColor00 = UIColor.white

    }
} 
```

# mysql - 简单的 MySQL 查询返回无效结果

> ID：14523350
> 
> 赞同：1
> 
> 时间：2013-01-25T14:04:22.670
> 
> 标签：mysql, sql, database

我试图简单地选择价格范围内的产品，在这种情况下在 160 美元到 200 美元之间。查询看起来很正常，但它也包括价格为 123 美元的产品。

```
SELECT * FROM product
WHERE  name LIKE '%test%' 
AND  price >= '160' AND  price <= '200' AND  1=1
LIMIT 50 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:06:11.500

为什么不使用`BETWEEN`？

```
SELECT * FROM product
WHERE  name LIKE '%test%'  AND  
        price BETWEEN 160 AND 200
LIMIT 50 
```

# c++ - C++ 从类本身调用非模板类中的模板方法

> ID：14523351
> 
> 赞同：-1
> 
> 时间：2013-01-25T14:04:23.953
> 
> 标签：c++, templates

```
class Node {
public:
  template<class T>  T*   GetComponent() {
     return new T(this);  // actual code is more complicated!
  }

  Transform*   Transform() {
      return this->GetComponent<Transform>();   // invalid template argument for 'T', type expected
  }
}; 
```

但是从另一个地方调用相同的方法！像 main()。这段代码有什么问题！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:11:16.707

正如已经提到的，您提供的代码有错别字。修复它们后，您将收到您提到的错误。

你得到它的原因是你有一个带有 name 的成员函数`Transform`，与你想要具体化的类型相同`GetComponent`。因此，解决方案是通过使用完整的类型名称（包括命名空间）来“帮助”编译器。这假设`Transform`在全局命名空间中定义：

```
Transform*   Transform() {
    return this->GetComponent<::Transform>();
} 
```

如果您在命名空间中定义了它，请使用它：

```
Transform*   Transform() {
    return this->GetComponent<::YOUR_NAMESPACE::Transform>();
} 
```

编辑：我使用的完整代码：

```
class Node;
class Transform
{
public:
    Transform(Node*);
};

class Node {
public:
    template <class T>  
    T*   GetComponent() {
        return new T(this);
    }

    Transform*   Transform() {
        return this->GetComponent<::Transform>();
    }
}; 
```

# ios - iOS开发

> ID：14523352
> 
> 赞同：-3
> 
> 时间：2013-01-25T14:04:25.350
> 
> 标签：ios, objective-c, cocoa-touch

我需要编写超级简单的 iPhone 应用程序。它包含按钮列表，如果用户单击其中一个按钮，应用程序将打开一个带有图像的新视图。
我的问题是很多教程/书籍是在 2-3 年前创建的，我无法并行学习 Objective C 并理解编译器的变化。什么对我的“按钮”菜单更好？我能读到什么？请帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:06:39.700

看看故事板教程，你甚至不需要 Objective-C 来开发那种应用程序。

*例如*：[http ://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

# ios - iOS - 具有来自 php 的值的进度条

> ID：14523354
> 
> 赞同：1
> 
> 时间：2013-01-25T14:04:28.407
> 
> 标签：ios, objective-c, cocoa-touch

我的应用程序中有一个进度条显示百分比值。

```
progressView = [[DDProgressView alloc] initWithFrame:CGRectMake(20.0f, 140.0f, self.view.bounds.size.width - 40.0f, 0.0f)];
[progressView setOuterColor:[UIColor grayColor]];
[progressView setInnerColor:[UIColor lightGrayColor]];
[self.view addSubview:progressView];
[progressView release];
float randomPercentageFloat = 40;
progressView.progress = randomPercentageFloat / 100; 
```

这显示了一个已满 40% 的进度条。我想让进度条显示来自 php 的值。我有一个回显一个值的 php 文件。我想将其更改`randomPercentageFloat = 40;`为类似

```
float randomPercentageFloat = "www.website.com/value.php"; 
```

这可能吗？怎么做到呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:09:55.573

您必须与您的服务器建立连接并按照示例 cose 检索值

test.php 包含以下指令：

```
<?php echo 40; ?> 
```

这里的示例 viewController.m 带有通过 Interface Builder 链接的进度视图

```
#import "ViewController.h"

@interface ViewController () {
    IBOutlet UIProgressView *progressView;

    NSMutableData *receivedData;
}

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    progressView.progressTintColor = [UIColor lightGrayColor];
    progressView.trackTintColor = [UIColor grayColor];
    progressView.progress = 0.0f;

    NSURLRequest *theRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://192.168.0.29/test.php"]
                     cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                 timeoutInterval:10.0];
    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (!theConnection) {
        UIAlertView *connectFailMessage = [[UIAlertView alloc] initWithTitle:@"NSURLConnection " message:@"Failed in viewDidLoad"  delegate: self cancelButtonTitle:@"Ok" otherButtonTitles: nil];
        [connectFailMessage show];
    } 

}

#pragma mark NSURLConnection Methods
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    receivedData = [NSMutableData data];
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{

    [receivedData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{

    // inform the user
    UIAlertView *didFailWithErrorMessage = [[UIAlertView alloc] initWithTitle: @"NSURLConnection " message: @"didFailWithError"  delegate: self cancelButtonTitle: @"Ok" otherButtonTitles: nil];
    [didFailWithErrorMessage show];

}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{

    NSString *dataString = [[NSString alloc] initWithData: receivedData  encoding:NSUTF8StringEncoding];
    progressView.progress = [dataString floatValue] / 100;
}

@end 
```

# mysql - 复杂的MySQL Query谁能解决？

> ID：14523359
> 
> 赞同：-2
> 
> 时间：2013-01-25T14:04:46.107
> 
> 标签：mysql, sql, algorithm

我有以下表格：

```
Material
material_ID | material_Name
A           | Sugar
B           | Flour
C           | Egg Yolk
D           | Water
E           | Tea Powder

Product
product_ID  | product_Name | material_ID    
1           | Cake         | A              
1           | Cake         | B              
1           | Cake         | C
2           | Tea          | D
2           | Tea          | E
2           | Tea          | A              

ScaleData
record_ID   | product_ID     | material_ID  | Weight
1001        | 1              | A            | 30
1002        | 1              | B            | 11
1003        | 1              | C            | 25
1004        | 1              | A            | 31
1005        | 1              | B            | 25
1006        | 2              | D            | 15
1007        | 2              | E            | 20
1008        | 2              | E            | 21 
```

如您所见：产品 1 是蛋糕，它需要材料：A、B 和 C 才能形成完整的产品。产品 2 是茶，它需要材料：D、E 和 A 才能形成完整的产品。

```
From the weighing table (ScaleData) we can see that there is 1 cake and 0 tea. 

record_ID: 1001, 1002, 1003 creates one complete cake.
record_ID: 1004, 1005 are remaining incomplete cake ingredients.
record_ID: 1006, 1007, 1008 are remaining incomplete tea ingredients.

Question:
A. How can i create the following result table based on data from above tables:

Result
product_ID  | product_Name  | Qty
1           | Cake          | 1
2           | Tea           | 0

B. How can i display the remaining ingredients like below?

Remaining
record_ID   | product_ID   | material_ID  | Weight
1004        | 1            | A            | 31
1005        | 1            | B            | 25
1006        | 2            | D            | 15
1007        | 2            | E            | 20
1008        | 2            | E            | 21 
```

编辑：我目前能够通过混合使用 .NET 代码 + SQL 查询来解决这个问题。我正在寻找的是纯 SQL 查询解决方案。我目前的方法如下：

```
1\. Execute: "SELECT DISTINCT product_ID FROM Product" to get a list of Product_ID.

2\. Iterate through each product_ID and retrieve list of material from each product.
   Something like: "SELECT material_ID FROM Product WHERE product_ID=1"

3\. Scan ScaleData table for each material and get the total row counts
   Something like:
   TotalA = "SELECT COUNT(*) FROM ScaleData WHERE product_ID=1 AND material_ID='A'
   TotalB = "SELECT COUNT(*) FROM ScaleData WHERE product_ID=1 AND material_ID='B'
   TotalC = "SELECT COUNT(*) FROM ScaleData WHERE product_ID=1 AND material_ID='C'

4\. Compare variables: TotalA, TotalB, TotalC and get the lowest value.
   Lets say TotalA = 2 ; TotalB = 2 ; TotalC = 1
   LowestCount = TotalC = 1

5\. Then we can tell total Qty for product 1 is 1 ( based on lowest count ).
   Remaining for Material A = 2 - 1 = 1
   Remaining for Material B = 2 - 1 = 1 
```

这是我目前的解决方案，我知道它不是很有效。我更喜欢纯 SQL 解决方案，我希望一些 SQL 大师愿意帮助我..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:24:14.000

这将完成第一部分。它可能会被清理干净，但它基本上所做的就是采用每种产品中最少的成分，这就是您可以制造的产品数量。

```
SELECT product_id,product_name, min(c) Qty
FROM
(
  SELECT p.product_id, p.product_name, p.material_id, count(sd.product_id) c
  FROM product p
  LEFT JOIN scaledata sd
    ON p.product_id=sd.product_id
   AND p.material_id = sd.material_id
  GROUP BY product_id, p.product_name, p.material_id
) a
GROUP BY product_id 
```

我制作了一个[SQLfiddle 来测试](http://sqlfiddle.com/#!2/79046/7)任何有时间编写第二部分的人；）

# ruby - 如果对象存在，则在对象上调用方法

> ID：14523360
> 
> 赞同：3
> 
> 时间：2013-01-25T14:04:57.020
> 
> 标签：ruby

有没有更优雅的写法？

```
@on_connection_callback.call() if @on_connection_callback 
```

它必须引用@on_connection_callback 两次，这让我很恼火。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:28:06.757

我喜欢像[“andand” gem](http://andand.rubyforge.org/)这样的东西，它允许：

```
@on_connection_callback.andand.call() 
```

还有其他选项，例如各种`try`实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:20:47.017

你可以这样写

```
@on_connection_callback.call() rescue nil 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T15:04:09.660

使用这个小[宝石](https://github.com/sevenmaxis/tryit)：

```
tryit { @on_connection_callback.call() } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T14:28:19.853

```
@on_connection_callback.instance_eval{call if self} 
```

或者

```
->p{p.call if p}.call(@on_connection_callback) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-25T14:56:12.010

```
@on_connection_callback.call() if @on_connection_callback 
```

很好，实际上是最快的测试方法。我最近在这里做了一个[基准测试](https://stackoverflow.com/a/14382053/128421)，证明上面的速度略快于：

```
@on_connection_callback && @on_connection_callback.call() 
```

# django - 使用 Django 访问 ManyToMany 对象以创建 url

> ID：14523362
> 
> 赞同：0
> 
> 时间：2013-01-25T14:05:07.540
> 
> 标签：django, url, many-to-many

我想组装一篇文章的 URL，并在保存实例后立即将其发送到某处。

一切都很好，除了我无法获得 URL 的一部分，即“类别”，它应该是 ManyToMany 对象的第一项。

我想得到这样的结果： [http ://www.example.com/category/article.html](http://www.example.com/category/article.html)

编码：

```
class Categories(models.Model):
    ...
    name = models.CharField(max_length=150, blank=False)
    slug = models.SlugField()

class Texts(models.Model):
    ...
    slug = models.SlugField()
    title = models.CharField(max_length=150, blank=False)
    subtitle = models.TextField(blank=True)
    cetegory = models.ManyToManyField(to=Categories, blank=True)
    def get_absolute_url(self):
        #firstpart = self.category.all()  #returns empty list
        #firstpart = self.category        #returns empty list
        #firstpart = Categories.objects.all().filter(texts__slug = self.slug) #returns empty list
        lastpart = self.Slug              #this is ok
        return firstpart[0] + "/" + lastpart + ".html" 
models.signals.post_save.connect(post_to_twitter, sender=Texts) 
```

...是的，我知道 reverse()，我会使用它，但首先我想知道参数

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T11:03:58.220

您在 Texts 模型中有错字：'cetegory' 而不是 'category'（所以 self.category.all() 返回空列表）

# android - Android 从 Camera.setPreviewCallback 使用位图的方式

> ID：14523364
> 
> 赞同：2
> 
> 时间：2013-01-25T14:05:16.210
> 
> 标签：android

```
camera.setPreviewCallback(new Camera.PreviewCallback() {
    private long timestamp=0;
    public synchronized void onPreviewFrame(byte[] data, Camera camera) {
        Log.e("CameraTest","Time Gap = "+(System.currentTimeMillis()-timestamp));
        timestamp=System.currentTimeMillis();

        Bitmap mFaceBitmap = BitmapFactory.decodeByteArray(data, 0, data.length);
        if (mFaceBitmap!=null) FaceDetection.calculate(mFaceBitmap);

        camera.addCallbackBuffer(data);
        return;
    }
}); 
```

我有一个相机视图，在一个简单的视图前面（我可以在其中绘制一些东西）。当我能找到人的脸时，我想在 View 的正面画画。但是`mFaceBitmap`永远返回null，为什么？

如果这是一个坏主意，我怎样才能做得更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T19:47:31.837

设置相机时，您需要设置预览大小和预览格式。这是一些示例代码，可以给出粗略的想法：

```
int previewFormat = 0;
for (int format : parameters.getSupportedPreviewFormats()) {
  if (format == FORMAT_NV21) {
    previewFormat = FORMAT_NV21;
  } else if (previewFormat == 0 && (format == FORMAT_JPEG || format == FORMAT_RGB_565)) {
    previewFormat = format;
  }
}

// TODO: Iterate on supported preview sizes and pick best one
parameters.setPreviewSize(previewSize.width, previewSize.height);

if (previewFormat != 0) {
  parameters.setPreviewFormat(previewFormat);
} else {
  // Error on unsupported format
} 
```

现在在回调中，您可以执行以下操作：

```
@Override
public void onPreviewFrame(byte[] data, Camera camera) {
  Bitmnap bitmap;
  if (previewFormat == FORMAT_NV21) {
    int[] previewPixels = new int[previewSize.width * previewSize.height];
    decodeYUV420SP(previewPixels, data, previewSize.width, previewSize.height);
    bitmap = Bitmap.createBitmap(rgbPixels, previewSize.width, previewSize.height, Bitmap.Config.RGB_565);
  } else if (previewFormat == FORMAT_JPEG || previewFormat == FORMAT_RGB_565) {
    // RGB565 and JPEG
    BitmapFactory.Options opts = new BitmapFactory.Options();
    opts.inDither = true;
    opts.inPreferredConfig = Bitmap.Config.RGB_565;
    bitmap = BitmapFactory.decodeByteArray(data, 0, data.length, opts);
  }
} 
```

最后，转换

```
 static void decodeYUV420SP(int[] rgb, byte[] yuv420sp, int width, int height) {

   final int frameSize = width * height;

   for (int j = 0, yp = 0; j < height; j++) {
     int uvp = frameSize + (j >> 1) * width, u = 0, v = 0;
     for (int i = 0; i < width; i++, yp++) {
       int y = (0xff & ((int) yuv420sp[yp])) - 16;
       if (y < 0)
         y = 0;
       if ((i & 1) == 0) {
         v = (0xff & yuv420sp[uvp++]) - 128;
         u = (0xff & yuv420sp[uvp++]) - 128;
       }

       int y1192 = 1192 * y;
       int r = (y1192 + 1634 * v);
       int g = (y1192 - 833 * v - 400 * u);
       int b = (y1192 + 2066 * u);

       if (r < 0)
         r = 0;
       else if (r > 262143)
         r = 262143;
       if (g < 0)
         g = 0;
       else if (g > 262143)
         g = 262143;
       if (b < 0)
         b = 0;
       else if (b > 262143)
         b = 262143;

       rgb[yp] = 0xff000000 | ((r << 6) & 0xff0000) | ((g >> 2) & 0xff00) | ((b >> 10) & 0xff);
     }
   }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T19:13:46.127

不幸的是，您不能使用 Bitmap.decodeByteArray 将相机的预览输出转换为位图。

decodeByteArray 设计用于将 JPEG/PNG/etc 图像转换为位图，它无法知道预览回调中的数据是什么样的，因为它是一个简单的像素值原始数组，没有标识头。

您必须自己进行转换。有很多方法可以做到这一点，不同程度的效率 - 我会在这里写出最简单的一种，但它也可能是最慢的。

来自相机的数据字节数组以某种特定的像素格式编码，由[Camera.Parameters.setPreviewFormat](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#setPreviewFormat(int))指定。如果您还没有调用它，则默认格式为[NV21](http://developer.android.com/reference/android/graphics/ImageFormat.html#NV21)。NV21 保证可以在所有安卓设备上运行；在 Android 版本 >= 3.0 上，[YV12](http://developer.android.com/reference/android/graphics/ImageFormat.html#YV12)格式也保证可以工作。

这两种都是 YUV 格式，这意味着颜色被编码为一个亮度（亮度）通道和两个色度（颜色）通道。用于在位图上设置像素值的函数（主要是 setPixels）需要 RGB 颜色空间中的信息，因此需要进行转换。此外，NV21 和 YV12 都对色度通道进行二次采样 - 例如，如果您有 640x480 的图像，亮度通道中将有 640x480 像素，但两个色度通道中只有 320x240 像素。

这意味着您需要创建一个大小合适的新 int[] 数组，然后循环遍历 byte[] 数据数组，收集一组 Y、U 和 V 值，将它们转换为 RGB，然后将它们写入int[] 数组，然后在目标位图上调用 setPixels。您需要的颜色转换矩阵是 JPEG YCbCr->RGB 矩阵，例如，您可以在[Wikipedia](http://en.wikipedia.org/wiki/YCbCr#JPEG_conversion)上找到它。[您可以在fourcc](http://www.fourcc.org/yuv.php#NV21)上了解NV21或YV12的布局，例如

如果你真的不想搞砸这一切，你也可以使用[YuvImage](http://developer.android.com/reference/android/graphics/YuvImage.html)类，尽管是以迂回的方式。只要您使用 NV21 格式，您就可以从预览数据构造一个 YuvImage 实例，然后将其中的 JPEG 保存到[ByteArrayOutputStream](http://developer.android.com/reference/java/io/ByteArrayOutputStream.html)中。然后，您可以从流中获取 byte[]，并使用 Bitmap.decodeByteArray 将其解码为位图。这是完全不必要的 JPEG 往返往返，因此效率非常低，并且可能导致质量损失，但它只需要几行代码。

在最新版本的 Android 中，您还可以使用 Renderscript 高效地进行此转换。您需要将数据复制到分配中，然后使用[YUV 到 RGB 脚本内在](http://developer.android.com/reference/android/renderscript/ScriptIntrinsicYuvToRGB.html)进行转换。

最后，您可以将数据和目标位图传递到 JNI 代码中，您可以在其中直接访问位图，并在那里用 C 或 C++ 编写转换函数。这需要大量的脚手架，但非常有效。

# c# - 基于运行时类型而不是编译时类型的调用方法

> ID：14523369
> 
> 赞同：5
> 
> 时间：2013-01-25T14:05:39.297
> 
> 标签：c#, .net, polymorphism

在应用程序中，我需要 .NET 根据其运行时类型而不是编译时类型调用方法。

**简化示例：**

```
 class A { }

    class B : A { }

    static void Main(string[] args)
    {
        A b = new B();
        Print(b);
    }

    static void Print(A a)
    {
        Console.WriteLine("Called from A");
    }

    static void Print(B b)
    {
        Console.WriteLine("Called from B");
    } 
```

上面的代码实际上会打印`Called from A`，但我需要它`Called from B`。

这按预期工作：

```
static void Print(A a)
{
    var b = a as B;
    if (b != null)
       return Print(b);
    else
       Console.WriteLine("Called from A");
} 
```

但是为了可维护性，这是不可取的。

我相信这个问题与这个问题相似：[为什么不根据对象的运行时类型选择此方法？](https://stackoverflow.com/questions/1918632/why-isnt-this-method-chosen-based-on-the-runtime-type-of-its-object)，但适用于 .NET 而不是 Java。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T14:07:22.123

如果您使用 .NET 4 或更高版本，最简单的方法是使用[动态类型](http://msdn.microsoft.com/en-gb/library/dd264736.aspx)：

```
dynamic b = new B();
Print(b); 
```

几乎所有使用类型值的表达式`dynamic`都将被动态调用，“mini-C# 编译器”在执行时应用与编译时相同的规则，但使用这些动态值的*实际*执行时类型. （尽管类型在编译时静态已知的表达式仍将被视为具有这些类型 - 它不会使有关重载解析的*所有内容都变为动态。）*

如果您不使用 .NET 4，那就更难了——您可以使用反射，或者对选项进行硬编码，这两种方法都不好玩。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-25T14:06:40.110

您可以使用以下`dynamic`类型：

```
A b = new B();
dynamic tmp = b;
Print(tmp); // Prints "Called from B" 
```

但是，请注意，这有一个缺点，即如果没有匹配的方法，它将生成运行时异常而不是编译错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-25T14:08:52.683

使用 OOP 的覆盖。

示例：

```
class A { 

    public virtual void Print() { 
          Console.WriteLine("Called from A");
    }      
}

class B : A { 
    public override void Print() { 
          Console.WriteLine("Called from B");
    }  
 } 
```

并像这样使用它：

```
 A b = new B();
    Print(b);

    static void Print(A a)
    {
       a.Print(); //will run B's method
    } 
```

当您使用简单的覆盖概念时，它将运行运行*时类型方法。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:13:33.070

这不是多态性的工作方式。您应该考虑执行类似于以下的操作：

```
class A
{
    virtual string GetString()
    {
        return "Called from A";
    }
}

class B : A
{
    override string GetString()
    {
        return "Called from B";
    }
}

static void Main(string[] args)
{
    A b = new B();
    Print(b);
}

static void Print(A a)
{
    Console.WriteLine(a.GetString());
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T14:14:09.523

试试这个：

```
class A
{
    public virtual string Print()
    {
        return "Called from A";
    }
}

class B : A
{
    public override string  Print()
    {
        return "Called from B";
    }
} 
```

并在别处测试

```
A b = new B();
MessageBox.Show(b.Print()); //called from B 
```

# android - 其他xml文件中的Android Trigger按钮

> ID：14523370
> 
> 赞同：2
> 
> 时间：2013-01-25T14:05:45.183
> 
> 标签：android, xml, button, buttonclick

我正在尝试从另一个 xml 文件访问一个按钮，该文件用于自定义列表中的每一行。但是，当我在设置 onClick 侦听器时遇到空指针异常时，我该怎么做。我的代码如下所示。

主要的.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
        >
    <ListView android:id="@+id/List"
                        android:layout_width="fill_parent"
                        android:layout_height="fill_parent"/>
</LinearLayout> 
```

行.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/list_item">

<TextView
android:layout_width="0dp"
android:layout_height="wrap_content"
android:id="@+id/list_item_text_view"
android:textSize="20sp"
android:padding="10dp"
android:layout_weight="1"
android:layout_marginLeft="35dp" />

<Button
    android:id="@+id/b1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
/> 
```

这是我的活动课

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

Button b1 = (Button)findViewById(R.id.b1);
b1.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

            }
        }); 
```

所以基本上如何在 main.xml 上设置活动视图时将 onclicklistener 设置为 row.xml 的 b1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:13:02.597

**使用 LayoutInflater：**

```
public class Main extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        LayoutInflater inflater = this.getLayoutInflater();
        LinearLayout v = (LinearLayout)inflater.inflate(R.layout.hello, null);
        Button bt1 = (Button)v.findViewById(R.id.btLog);
        bt1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub

            }
        });
    }
} 
```

**更新****可扩展布局**

```
public class ExpandablePanel extends LinearLayout {

    private final int mHandleId;
    private final int mContentId;

    private View mHandle;
    private View mContent;

    private boolean mExpanded = false;
    private int mCollapsedHeight = 0;
    private int mContentHeight = 0;
    private int mAnimationDuration = 0;

    private OnExpandListener mListener;

    public ExpandablePanel(Context context) {
        this(context, null);
    }

    public ExpandablePanel(Context context, AttributeSet attrs) {
        super(context, attrs);
        mListener = new DefaultOnExpandListener();

        TypedArray a = context.obtainStyledAttributes(attrs, R.styleable.ExpandablePanel, 0, 0);

        // How high the content should be in "collapsed" state
        mCollapsedHeight = (int) a.getDimension(R.styleable.ExpandablePanel_collapsedHeight, 0.0f);

        // How long the animation should take
        mAnimationDuration = a.getInteger(R.styleable.ExpandablePanel_animationDuration, 500);

        int handleId = a.getResourceId(R.styleable.ExpandablePanel_handle, 0);
        if (handleId == 0) {
            throw new IllegalArgumentException(
                "The handle attribute is required and must refer "
                    + "to a valid child.");
        }

        int contentId = a.getResourceId(R.styleable.ExpandablePanel_content, 0);
        if (contentId == 0) {
            throw new IllegalArgumentException("The content attribute is required and must refer to a valid child.");
        }

        mHandleId = handleId;
        mContentId = contentId;

        a.recycle();
    }

    public void setOnExpandListener(OnExpandListener listener) {
        mListener = listener; 
    }

    public void setCollapsedHeight( int collapsedHeight ) { mCollapsedHeight = collapsedHeight; android.view.ViewGroup.LayoutParams lp = mContent.getLayoutParams(); lp.height = mCollapsedHeight; mContent.setLayoutParams( lp ); }

    public void setAnimationDuration(int animationDuration) {
        mAnimationDuration = animationDuration;
    }

    @Override
    protected void onFinishInflate() {
        super.onFinishInflate();

        mHandle = findViewById(mHandleId);
        if (mHandle == null) {
            throw new IllegalArgumentException(
                "The handle attribute is must refer to an"
                    + " existing child.");
        }

        mContent = findViewById(mContentId);
        if (mContent == null) {
            throw new IllegalArgumentException(
                "The content attribute must refer to an"
                    + " existing child.");
        }

        android.view.ViewGroup.LayoutParams lp = mContent.getLayoutParams();
        lp.height = mCollapsedHeight;
        mContent.setLayoutParams(lp);

        mHandle.setOnClickListener(new PanelToggler());
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        // First, measure how high content wants to be
        mContent.measure(widthMeasureSpec, MeasureSpec.UNSPECIFIED);
        mContentHeight = mContent.getMeasuredHeight();

        if (mContentHeight < mCollapsedHeight) {
            mHandle.setVisibility(View.GONE);
        } else {
            mHandle.setVisibility(View.VISIBLE);
        }

        // Then let the usual thing happen
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    }

    private class PanelToggler implements OnClickListener {
        public void onClick(View v) {
            Animation a;
            if (mExpanded) {
                a = new ExpandAnimation(mContentHeight, mCollapsedHeight);
                mListener.onCollapse(mHandle, mContent);
            } else {
                a = new ExpandAnimation(mCollapsedHeight, mContentHeight);
                mListener.onExpand(mHandle, mContent);
            }
            a.setDuration(mAnimationDuration);
            if(mContent.getLayoutParams().height == 0) //Need to do this or else the animation will not play if the height is 0
            {
                android.view.ViewGroup.LayoutParams lp = mContent.getLayoutParams();
                lp.height = 1;
                mContent.setLayoutParams(lp);
                mContent.requestLayout();
            }
            mContent.startAnimation(a);
            mExpanded = !mExpanded;
        }
    }

    private class ExpandAnimation extends Animation {
        private final int mStartHeight;
        private final int mDeltaHeight;

        public ExpandAnimation(int startHeight, int endHeight) {
            mStartHeight = startHeight;
            mDeltaHeight = endHeight - startHeight;
        }

        @Override
        protected void applyTransformation(float interpolatedTime, Transformation t) {
            android.view.ViewGroup.LayoutParams lp = mContent.getLayoutParams();
            lp.height = (int) (mStartHeight + mDeltaHeight * interpolatedTime);
            mContent.setLayoutParams(lp);
        }

        @Override
        public boolean willChangeBounds() {
            return true;
        }
    }

    public interface OnExpandListener {
        public void onExpand(View handle, View content); 
        public void onCollapse(View handle, View content);
    }

    private class DefaultOnExpandListener implements OnExpandListener {
        public void onCollapse(View handle, View content) {}
        public void onExpand(View handle, View content) {}
    }
} 
```

**布局：** 把它放在上面： xmlns:cl="http://schemas.android.com/res/com.example.androidapp.widgets" Eclipse 将始终在此布局中指示错误，因为 ExpandablePanel 中的 Throw Exceptions。类，因此您可以隐藏这些行以查看可扩展布局的显示方式并设置他的按钮和文本子项。

```
<com.example.androidapp.widgets.ExpandablePanel
        android:id="@+id/theId"
        android:layout_width="fill_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        app:collapsedHeight="80dp"
        app:content="@+id/value"
        app:handle="@+id/expand"
        cl:collapsedHeight="50dip"
        cl:content="@+id/value"
        cl:handle="@+id/expand" >

        <TextView
            android:id="@id/value"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="hejahdkashfa afsjkhas lf ksajfh as fkjsah asf kfsahkjfas  klfajsh flkas  klfajsh lasfkl aklfsjh klsa ffhaskljfha dfasfa s safjsfkhasjkf fjakshfjkasf  jksfhjkasf sjakfhas kjfa sjkfhakjsfh asjsfhkjashf askjsf sakjfh as fadsfasf af asf asf" />

        <Button
            android:id="@id/expand"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="center_vertical|center_horizontal"
            android:text="More" />

    </com.example.androidapp.widgets.ExpandablePanel> 
```

**如何设置可扩展面板：**

```
// Set expandable panel listener
        ExpandablePanel panel = (ExpandablePanel)findViewById(R.id.theId);
        panel.setCollapsedHeight(50);
        panel.setContentDescription(descricao);
        panel.setOnExpandListener(new ExpandablePanel.OnExpandListener() {
            public void onCollapse(View handle, View content) {
                Button btn = (Button)handle;
                btn.setText("More");
            }
            public void onExpand(View handle, View content) {
                Button btn = (Button)handle;
                btn.setText("Less");
            }
        }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:14:16.113

你不是从那里开始的。该辅助 xml 文件未膨胀或设置为上下文视图，因此该按钮不存在。

您可以做的是在 getView 函数中的列表适配器中，您将膨胀该行视图（对于不同的行可能多次）。一旦膨胀它，您将在行 xml 中获得顶级视图的 View 类，然后您可以在其上运行 findViewByID。

# c# - 从数据点计算指数增长方程c#

> ID：14523378
> 
> 赞同：3
> 
> 时间：2013-01-25T14:06:07.100
> 
> 标签：c#, visual-studio-2010, math, exponential

我正在尝试使用 C# 应用程序分析一些数据，并且需要计算趋势线。我知道趋势线有多种类型，但现在我正在尝试计算指数增长；我将使用它来预测未来的价值。我一直在研究的方程式是

```
x(t) = x(0) * ((1+r)^t) 
```

这是我为尝试复制图形而编写的代码：

```
public void ExponentialBestFit(List<DateTime> xvalues, List<double> yvalues)

        {
            //Find the first value of y (The start value) and the first value of x (The start date)
            xzero = Convert.ToDouble(xvalues[0].ToOADate());
            yzero = yvalues[0];
            if (yzero == 0)
                yzero += 0.1;

            //For every value of x (exluding the 1st value) find the r value
            //
            //                       |   y   |          Where t = the time sinse the start time (time period)
            //Equation for r = t root|-------| - 1      Where y = the current y value
            //                       |  y[0] |          Where y[0] = the first y value  #IMPROVMENT - Average 1st y value in range
            //
            double r = 0;

            //c is a count of how many r values are added; it is not equal to the count of all the values
            int c = 0;
            for (int i = 1; i < xvalues.Count; i++)
            {
                r += Math.Pow(yvalues[i]/yzero, 1/(Convert.ToDouble(xvalues[i].ToOADate()) - xzero)) - 1;
                c++;
            }

            r = r / c;           
        } 
```

我传入的数据是一段时间内的，但是时间增加的增量并不相同。当我在 excel 中创建图表时，他们使用不同的公式

```
x(t) = x(0)*(e^kt) 
```

但是我想我不知道 k 值是从哪里生成的。我传入的两个列表是日期和值，每个列表中的每一行对应于另一个列表中的同一行。问题是 - 有没有更好的方法来创建方程和变量，我得到的变量对于我的数据来说是最准确的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T15:54:27.567

这是提供的 javascript 的 c# 版本。

```
 IEnumerable<double> Growth(IList<double> knownY, IList<double> knownX, IList<double> newX, bool useConst)
    {
        // Credits: Ilmari Karonen

        // Default values for optional parameters:
        if (knownY == null) return null;
        if (knownX == null)
        {
            knownX = new List<double>();
            for (var i  = 0; i<=knownY.Count; i++)
                knownX.Add(i++);
        }
        if (newX == null)
        {
            newX = new List<double>();
            for (var i = 0; i <= knownY.Count; i++)
                newX.Add(i++);
        }

        int n = knownY.Count;
        double avg_x = 0.0;
        double avg_y = 0.0;
        double avg_xy = 0.0;
        double avg_xx = 0.0;
        double beta = 0.0;
        double alpha = 0.0;
        for (var i = 0; i < n; i++)
        {
            var x = knownX[i];
            var y = Math.Log(knownY[i]);
            avg_x += x;
            avg_y += y;
            avg_xy += x * y;
            avg_xx += x * x;
        }
        avg_x /= n;
        avg_y /= n;
        avg_xy /= n;
        avg_xx /= n;

        // Compute linear regression coefficients:
        if (useConst)
        {
            beta = (avg_xy - avg_x * avg_y) / (avg_xx - avg_x * avg_x);
            alpha = avg_y - beta * avg_x;
        }
        else
        {
            beta = avg_xy / avg_xx;
            alpha = 0.0;
        }

        // Compute and return result array:
        return newX.Select(t => Math.Exp(alpha + beta*t)).ToList();

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:13:05.497

以下 JavaScript 代码应该会有所帮助。我用它来实现 Excel 的[GROWTH](http://office.microsoft.com/en-us/excel-help/growth-function-HA102753003.aspx?CTT=5&origin=HA102752955)函数。它是用 JavaScript 编写的，但将其移植到 C# 应该很容易。请注意，其中大部分是由其他人编写的（代码中的学分）。

```
function GROWTH(known_y, known_x, new_x, use_const) {
  // Credits: Ilmari Karonen

  // Default values for optional parameters:
  if (typeof(known_x) == 'undefined') {
    known_x = [];
    for (var i = 1; i <= known_y.length; i++) known_x.push(i);
  }
  if (typeof(new_x) == 'undefined') {
    new_x = [];
    for (var i = 1; i <= known_y.length; i++) new_x.push(i);
  }
  if (typeof(use_const) == 'undefined') use_const = true;

  // Calculate sums over the data:
  var n = known_y.length;
  var avg_x = 0;
  var avg_y = 0;
  var avg_xy = 0;
  var avg_xx = 0; 
  for (var i = 0; i < n; i++) {
    var x = known_x[i];
    var y = Math.log(known_y[i]);
    avg_x += x;
    avg_y += y;
    avg_xy += x*y;
    avg_xx += x*x;
  }
  avg_x /= n;
  avg_y /= n;
  avg_xy /= n;
  avg_xx /= n;

  // Compute linear regression coefficients:
  if (use_const) {
    var beta = (avg_xy - avg_x*avg_y) / (avg_xx - avg_x*avg_x);
    var alpha = avg_y - beta*avg_x;
  } else {
    var beta = avg_xy / avg_xx;
    var alpha = 0;
  }

  // Compute and return result array:
  var new_y = [];
  for (var i = 0; i < new_x.length; i++) {
    new_y.push(Math.exp(alpha + beta * new_x[i]));
  }
  return new_y;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-12T15:53:26.930

因为`x(t)=x(0)*e^{kt}`，我们可以取对数来得到`ln x(t)=ln x(0) + kt`。这意味着要找到`ln x(0)`和`k`，您可以找到适合数据的最小二乘`{(t,ln x(t))}`。这会告诉你那个`ln x(t) = b + at`，所以那个`k=a`和`x(0)=e^b`。

# xml - XSLT 替换元素值，如果它以给定前缀开头，但保留 XML 的其余部分不变

> ID：14523381
> 
> 赞同：1
> 
> 时间：2013-01-25T14:06:15.907
> 
> 标签：xml, xslt

我试图在 xslt 中做一个简单的“查找替换”，但无法让它产生正确的输出。我尝试学习其他示例，但不幸的是，我对 XSLT 所做的工作并不多，也无法找到一个可以满足我要求的示例。

我有以下 XML：

```
<metadata>
<Permissions>site:abcdefg-123456-id1::{azeckoski}h,S,r</Permissions>
<Permissions>site:hjklqwe-098765-id2::{person2}h,S,r</Permissions>
<Permissions>playlist:5678::{azeckoski}h,S,r</Permissions>
<Permissions>playlist:7890::{azeckoski}H,s,r</Permissions>
<Permissions>playlist:1234::{person1}H,s,R</Permissions>
</metadata> 
```

以及以下 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:package="info:srw/extension/13/package-v1.0" >
<xsl:output omit-xml-declaration="yes" indent="no"/>
 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>
 <xsl:template match="metadata[starts-with(Permissions,'site:abcdefg-123456-id1::')]">
  <xsl:copy>
   <xsl:text>site:abcdefg-123456-id1::{azeckoski}H,S,R</xsl:text>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

我想最终得到以下 XML：

```
<metadata>
<Permissions>site:abcdefg-123456-id1::{azeckoski}H,S,R</Permissions>
<Permissions>site:hjklqwe-098765-id2::{person2}h,S,r</Permissions>
<Permissions>playlist:5678::{azeckoski}h,S,r</Permissions>
<Permissions>playlist:7890::{azeckoski}H,s,r</Permissions>
<Permissions>playlist:1234::{person1}H,s,R</Permissions>
</metadata> 
```

但是我最终得到了这个：

```
<metadata>site:abcdefg-123456-id1::{azeckoski}H,S,R</metadata> 
```

我不明白为什么要清除 XML 文档的其余部分。我以为我正在使用身份模板来保持其他所有内容不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:15:25.437

**使用**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="Permissions/text()[starts-with(.,'site:abcdefg-123456-id1::')]">
  <xsl:text>site:abcdefg-123456-id1::{azeckoski}H,S,R</xsl:text>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<metadata>
    <Permissions>site:abcdefg-123456-id1::{azeckoski}h,S,r</Permissions>
    <Permissions>site:hjklqwe-098765-id2::{person2}h,S,r</Permissions>
    <Permissions>playlist:5678::{azeckoski}h,S,r</Permissions>
    <Permissions>playlist:7890::{azeckoski}H,s,r</Permissions>
    <Permissions>playlist:1234::{person1}H,s,R</Permissions>
</metadata> 
```

**产生了想要的正确结果：**

```
<metadata>
   <Permissions>site:abcdefg-123456-id1::{azeckoski}H,S,R</Permissions>
   <Permissions>site:hjklqwe-098765-id2::{person2}h,S,r</Permissions>
   <Permissions>playlist:5678::{azeckoski}h,S,r</Permissions>
   <Permissions>playlist:7890::{azeckoski}H,s,r</Permissions>
   <Permissions>playlist:1234::{person1}H,s,R</Permissions>
</metadata> 
```

**您的问题是**您没有处理（应用模板）`metadata`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:23:07.160

该函数`start-with()` [需要一个字符串作为第一个参数](http://www.xsltfunctions.com/xsl/fn_starts-with.html)，而不是 node()。您的匹配规则不正确。它应该是 ：

```
<xsl:template match="metadata/Permissions[starts-with(./text(),'site:abcdefg-123456-id1::')]">
...
</xsl:template> 
```

在这里，测试字符串是否以 'site:abcdefg-123456-id1::' 开头`metadata/Permissions/text()`。

# powershell - 使用 Powershell 更新 .xslt 文件中的 xsl:variable

> ID：14523386
> 
> 赞同：0
> 
> 时间：2013-01-25T14:06:31.953
> 
> 标签：powershell

我有一个 .xslt 文件，其中只有几个变量。我需要使用 Powershell 更新其中两个。该文件如下所示：

```
 <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:variable name="VarA" select="this data stays the same" />
    <xsl:variable name="VarB" select="this data also stays the same" />

    <xsl:variable name="ChangeMe_1" select="data to be changed" />
    <xsl:variable name="ChangeMe_2" select="more data to be changed" />

 </xsl:stylesheet> 
```

我需要将名为 ChangeMe_1 和 ChangeMe_2 的变量中的选择值更新为传递给 Powershell 脚本的参数。我是 Powershell 的新手，我在解析 XML 文件方面找到了很多资源，但是这个 xslt 的不同之处足以让我感到困惑。

此外，这需要在文件夹层次结构中具有相同名称的每个 .xslt 文件中完成，所以如果有人能指出我正确的方向，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:28:16.967

将您的文件视为 xml ：

```
[xml]$t=@(gc C:\temp\test.xslt)
$t.stylesheet.variable | ?{$_.name -like "ChangeMe_1"}|%{$_.select="New Value"}
$t.Save("newname.xslt")
gc .\newname.xslt

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:variable name="VarA" select="this data stays the same" />
  <xsl:variable name="VarB" select="this data also stays the same" />
  <xsl:variable name="ChangeMe_1" select="NewValue" />
  <xsl:variable name="ChangeMe_2" select="more data to be changed" />
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:19:24.237

像这样，我建议在生产中运行之前在测试文件夹中对其进行测试：

```
param ($path, $filename, $newvalue)

$files = dir $path -filter $filename -Recurse
foreach ($file in $files)
{
[xml]$xml= gc $file.fullname
$xml.stylesheet.variable | ? { $_.name -match 'ChangeMe_[1|2]' } | % {$_.select= $newvalue }
$xml.Save($file.fullname)
} 
```

# graph - gnuplot：标记/突出显示区域（折线图的一部分）

> ID：14523395
> 
> 赞同：1
> 
> 时间：2013-01-25T14:06:47.880
> 
> 标签：graph, gnuplot, highlight, area

我的数据很简单，只是一个时间戳和一个像这样的数字：

*   2013-01-23 08:27:55 2801
*   2013-01-23 08:33:13 2801
*   2013-01-23 08:38:31 2660
*   2013-01-23 08:43:49 2785
*   2013-01-23 08:49:07 2785

我从另一个系统获取数据。日期和时间之间的空格，以及“日期时间”和数字之间的制表符。

整个时间窗口是几个小时......几天。这个整个时间窗口包含一个或多个有趣的部分（通常是几个小时），我想以某种方式标记或突出这些有趣的部分，以便更容易和更快地分析图表。

需要手动指定有趣的时间窗口，例如从 2014-01-23 10:00:00 到 2013-01-24 12:00:00 为 2 小时窗口。

在折线图的背景上画一个矩形是一种可能性，而改变线条颜色（或类似的东西）是另一种可能性。

如何通过手动/单独定义的时间戳做到这一点？我能找到的最好的方法是用空行分割数据，并使用这样的东西（来自[http://www.gnuplotting.org/introduction/plotting-data/](http://www.gnuplotting.org/introduction/plotting-data/)）：

```
set style line 1 lc rgb '#0060ad' lt 1 lw 2 pt 7 ps 1.5   # --- blue
set style line 2 lc rgb '#dd181f' lt 1 lw 2 pt 5 ps 1.5   # --- red
plot 'plotting-data3.dat' index 0 with linespoints ls 1, '' index 1 with linespoints ls 2 
```

但是拆分数据有点费力（？）；我正在寻找优雅的 gnuplot 手段来实现目标。如果那真的是最好的选择，那么稳健的分裂也是可能的。

下面是绘图功能，效果很好，但我想标记/突出显示图表的选定部分。

-帕沃

```
function my_gnuplot {
  if [ $# -ne 3 -o -z "$1" -o -z "$2" -o -z "$3" ]
  then
    echo $0 $FUNCNAME Invalid parameters, exiting
    exit 3
  fi

  sid="$1" ; shift
  stime="$1" ; shift
  etime="$1" ; shift

  if [ $sid -gt 0 -a $sid -lt 10 ]
  then
    title=0$sid
  else
    title=$sid
  fi

  gnuplot <<- EOF
  reset
  set terminal png size 1800,900 enhanced font myfont.ttf 10

  set xdata time
  set timefmt "%Y-%m-%d %H:%M:%S"
  set format x "%Y-%m-%d %H:%M"

  set title "SID=$title from $stime to $etime"
  set grid

  set xrange [ "$stime" : "$etime" ]
  set yrange [ -2000 : 6000 ]
  set style data linespoints

  plot "sid_data_$sid.txt" using 1:9 notitle
        EOF
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T16:10:39.823

您可以使用矩形很容易地填充空间：

```
set xdata time
set timefmt '%Y-%m-%d %H:%M:%S'
set object 1 rectangle from "2013-01-23 08:33:13",graph 0 to "2013-01-23 08:43:49",graph 1 fs solid fc rgb "red" behind
plot 'test.dat' u 1:3 w lines ls -1 
```

# pyrocms - Pyro cms 管理员登录

> ID：14523396
> 
> 赞同：0
> 
> 时间：2013-01-25T14:06:52.437
> 
> 标签：pyrocms

我已经安装了最新版本的 PyroCMS，但我无法登录到管理部分。当我填写电子邮件和密码字段并单击登录按钮时，什么也没发生。网站正在加载，直到达到执行时间....我在 Chrome、Mozilla、IE、Safari 中尝试过....当我使用 Opera 时出现警告消息：遇到错误不允许您请求的操作.

我正在使用 Wamp，Windows 8。感谢您的帮助！

# javascript - 使用事件处理程序调用函数，同时防止默认行为

> ID：14523397
> 
> 赞同：0
> 
> 时间：2013-01-25T14:06:54.120
> 
> 标签：javascript

我一直在尝试创建一个可以从一个页面导航的动态 JavaScript 图片库，而无需用户导航到另一个页面。

```
function showPic(whichPic) { 
    var source = whichpic.getAttribute("href");  
    var placeholder = document.getElementById("placeholder"); 
    placeholder.setAttribute("src",source); 
} 
```

我正在尝试`showPic`使用事件处理程序调用该函数`onlick`，同时还阻止将用户带到链接目的地的元素的默认行为。我认为通过向事件处理程序`return false`包含的 JavaScript 添加一条语句，`onclick`我可以获得此功能。它似乎不起作用，我不明白为什么。

这是我的 HTML 标记：

```
<h1>Breaking Bad Characters</h1>
<ul>
    <li>
        <a href="images/tuco.jpg" onclick="showPic(this); return false;" title="Tuco">Tuco Salamanca</a>
    </li>
    <li>
        <a href="images/walt.jpg" onclick="showPic(this); return false;" title="Walt">Walter White</a>
    </li>
    <li>
        <a href="images/gus.jpg" onclick="showPic(this); return false;" title="Gustavo">Gustavo Fring</a>
    </li>
    <li>
        <a href="images/saul.jpg" onclick="showPic(this); return false;" title="Saul">Saul Goodman</a>
    </li>
    <img id="placeholder" src="images/placeholder.gif" alt="my image gallery" />
</ul> 
```

我还可以提供该作品的链接：

[http://the-session.co.uk/JSgallery/](http://the-session.co.uk/JSgallery/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:19:59.583

您的解决方案（使用`return false`）应该适用于 IE，而 Lloyd 的解决方案（使用`event.preventDefault()`）应该适用于其他浏览器。

`preventDefault()` [要在所有浏览器中工作，您可以使用像 jQuery 这样的库，它在其方法](http://api.jquery.com/event.preventDefault/)中处理跨浏览器问题。

如果您不想使用库，则可以在调用之前测试事件是否具有 preventDefault 方法：

```
if(event.preventDefault) {
    event.preventDefault(); // handles most browsers
}
else {
    return false;           // handles ie
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:21:02.920

函数 showPic 中最简单的方法

```
function showPic(whichPic) { 
    var source = whichpic.getAttribute("href");  
    var placeholder = document.getElementById("placeholder"); 
    placeholder.setAttribute("src",source); 

    var event = window.event;
    if(event.preventDefault) {
        event.preventDefault();
    }
    else {
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:09:31.260

您需要通过调用`event.preventDefault()`.

```
function showPic(el) { 
    event.preventDefault();

    var source = el.getAttribute("href");  
    var placeholder = document.getElementById("placeholder"); 
    placeholder.setAttribute("src",source); 
}

<ul>
    <li>
        <a href="images/tuco.jpg" onclick="showPic(this)" title="Tuco">Tuco Salamanca</a>
    </li>
    <li>
        <a href="images/walt.jpg" onclick="showPic(this)" title="Walt">Walter White</a>
    </li>
    <li>
        <a href="images/gus.jpg" onclick="showPic(this)" title="Gustavo">Gustavo Fring</a>
    </li>
    <li>
        <a href="images/saul.jpg" onclick="showPic(this)" title="Saul">Saul Goodman</a>
    </li>
    <img id="placeholder" src="images/placeholder.gif" alt="my image gallery" />
</ul> 
```

在 MDN 上查看这里 - [https://developer.mozilla.org/en/docs/DOM/event.preventDefault](https://developer.mozilla.org/en/docs/DOM/event.preventDefault)

你也可以在 JSFiddle 上玩这个 - [http://jsfiddle.net/GuDeA/](http://jsfiddle.net/GuDeA/)

# javascript - 具有 2 个数组的对象

> ID：14523402
> 
> 赞同：0
> 
> 时间：2013-01-25T14:07:08.160
> 
> 标签：javascript, arrays

有人能解释一下为什么这两条代码的结果是“2,1”吗？我不明白这两件作品如何返回该结果。

```
var grid = [["0,0", "1,0", "2,0"],
            ["0,1", "1,1", "2,1"]];
show(grid[1][2]);

var grid = ["0,0", "1,0", "2,0",
            "0,1", "1,1", "2,1"];
show(grid[2 + 1 * 3]); 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:11:23.477

```
// A two-dimensional array is like having a table with rows and columns,
// though the first element always starts with "0" (as opposed to 1)

var grid = [
/* column:  0    , 1    , 2
/* row 0 */["0,0", "1,0", "2,0"],
/* row 1 */["0,1", "1,1", "2,1"]
];
show(grid[1][2]); // row 1, column 2 
```

* * *

```
// This is just a simple array with elements, again the indexes
// start at 0.

/* index:   0    , 1    ,  2   , 3    , 4    , 5    */
var grid = ["0,0", "1,0", "2,0", "0,1", "1,1", "2,1"];
show(grid[2 + 1 * 3]); // order of operations applies so 2+1*3 is actually:
                       // "2+(1*3)" => "2+3" => "5"
                       // so grid[5] = "2,1" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:10:19.697

Javascript 中的索引从 0 开始，而不是 1。

所以让我们分解一下。

`grid[1]`实际上指向第二个数组`["0,1", "1,1", "2,1"]`

然后`grid[1][2]`指向该数组中的第三个值，即`2,1`

至于第二个数组，访问`grid[5]`是指向数组中的第六个值，这也是`2,1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T14:10:44.133

```
var grid = [["0,0", "1,0", "2,0"],
            ["0,1", "1,1", "2,1"]]; 
```

**网格[1][2]**

数组从 0 开始计数。数组`grid[1]`的后半部分也是如此，并且是第二个数组`grid[1][2]`中的第三个值。

```
var grid = ["0,0", "1,0", "2,0",
        "0,1", "1,1", "2,1"]; 
```

**网格[2 + 1 * 3]**

`grid[2 + 1 * 3] === grid[5]`: 数组中的第 6 个值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:09:32.620

因为在这两种情况下，指定的索引都指向字符串“2,1”

请记住，javascript 数组使用从 0 开始的索引，因此索引 0 是数组中的第一个，索引 1 是第二个，依此类推，

在第一个中，索引`[1][2]`指向第二个数组，即该数组中的第三个。

在第二个中，您有 1 个包含 6 个事物的数组，并且您的索引`2 + 1 * 3`计算为 5，这是数组中的第 6 个事物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T14:10:15.503

怎么了？在第一种情况下，它是一个二维数组。在第二种情况下，它是一维数组。在第三个元素之后只有一个输入（在第二种情况下）。就这样

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T14:10:16.647

第一个函数：`show(grid[1][2])`输出第二个数组的第三个元素，所以`2,1`

对于第二个 2 + 1 * 3 = 5 所以它显示 grid[5]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-25T14:12:28.233

这有什么难的？

最后一个选择结果是“grid[5]”，这是“2,1”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-25T14:12:34.210

`[`在&中包含逗号分隔的值`]`会创建一个数组，一种列表。
您可以通过在数组名称后的括号中给出“索引”来访问数组中的值。第一项在索引“0”下找到，第二项在“1”下找到，依此类推。

现在，如果你这样做：

```
show(grid[1][2]); 
```

它首先在网格的第二个位置获取东西。嘿，这是一个数组！所以我们可以得到那个东西的第三个值！该数组的第三个值是“2,1”。第二个样本也一样，它只计算动态索引。2 + 1*3 = 5，所以第六个数组项：“2,1”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-25T14:12:36.737

嘿，我想你错过了从 0 开始的数组索引。所以第一种情况下的 grid[0][0] 和第二种情况下的 grid[0] 应该导致“0,0”和 grid[1] [1] 在第一种情况下是“1,1”，而在第二种情况下 grid[1] 是“1,0”（现在不奇怪了？）:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-25T14:13:19.140

在第一个示例中， 的值`grid[1]`是数组中的第二项，即数组`["0,1", "1,1", "2,1"]`，因此 的值`grid[1][2]`是该值中的第三项，即`"2,1"`。

在第二个示例中， 的值`2 + 1 * 3`是`5`，并且`grid[5]`是数组中的第六个元素，即`"2,1"`。

这些示例显示了在 Javascript 中处理二维数据的两种不同方式。如果您将数组视为特定大小的段，这类似于拥有一个数组数组，其中子数组具有该特定大小。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-01-25T14:16:34.297

```
var grid = [["0,0", "1,0", "2,0"],
            ["0,1", "1,1", "2,1"]];
show(grid[1][2]); 
```

数组索引位置总是从 开始`0`。`grid`是一个二维数组。

**显示（网格[1][2]）；**

```
grid[1] == ["0,1", "1,1", "2,1"] //2nd element in the grid array .

grid[1][2] = "2,1"; //3rd element in grid[1] . 
```

**显示（网格[2 + 1 * 3]）**；

```
var grid = ["0,0", "1,0", "2,0",
            "0,1", "1,1", "2,1"];

`grid[2+1*3]` == `grid[5]` // 2+1*3=5
 grid[5] = "2,1" 
```

我希望它能消除你的疑问。

# list - 如何订购/排序列表 在 C#5 中使用 Lambda 表达式？

> ID：14523404
> 
> 赞同：1
> 
> 时间：2013-01-25T14:07:16.857
> 
> 标签：list, sorting, .net-4.5, c#-5.0

我正在将我的应用程序从 .Net 4.0 转换为 .Net 4.5 Framework，并且`List<>`定义发生了变化。我的旧代码看起来像这样（.Net 4.0）：

```
List<Customer> list = new List<Customer>();
list.Add(new Customer("Smith", "John", "Sydney", 45));    
list.Add(new Customer("Mitchell", "Brad", "New York", 52));
list.Add(new Customer("Baker", "William", "Cape Town", 21)); 
list.OrderBy(x => x.Name); 
```

使用 .Net 4.5 (C#5) 该`List<T>.OrderBy()`方法消失了，只有[`List<T>.Sort()`](http://msdn.microsoft.com/de-de/library/vstudio/3da4abas.aspx)可用，但看起来不可能在此方法中使用 Lambda 表达式。

`IComparer`除了为每个定义一个之外，还有其他选择`<T>`吗？如果真的没有 Lambda 表达式的选项，我可以使用 generic `IComparer`，但是如何选择要比较的属性？

解决/编辑：

```
using Linq;
[...]
List<Customer> list = new List<Customer>();
list.Add(new Customer("Smith", "John", "Sydney", 45));    
list.Add(new Customer("Mitchell", "Brad", "New York", 52));
list.Add(new Customer("Baker", "William", "Cape Town", 21)); 
list.OrderBy(x => x.Name); //list stays unordered
list = list.OrderBy(x => x.Name).ToList();  // list content is now ordered 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:13:39.297

[`List<T>.OrderBy()`](http://msdn.microsoft.com/en-ca/library/vstudio/bb534966)没有消失，它仍然是一个扩展方法

你必须使用

```
using System.Linq; 
```

让它发挥作用

在您的代码中，您应该使用“list.OrderBy(x => x.Name);”

# sql-server-2008 - sql server 数据库时区与系统时区不同

> ID：14523417
> 
> 赞同：9
> 
> 时间：2013-01-25T14:07:55.417
> 
> 标签：sql-server-2008, sql-server-2005

谁能帮我一个建议，我该如何实现以下内容：

我有一个安装了我的 sql server 的系统 A。

但我想在 sql server 中为我的数据库设置不同的时区，而不是系统 A 时区。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T15:34:15.973

SQL Server 没有时区的概念。它从 Windows 继承系统时间，并实时使用。例如，如果您在系统处于一个时区时安装 SQL Server，并且您将服务器更改为不同的时区，那么下一次调用`GETDATE()`它时将反映新时区，而不是当时正在使用的时区。 SQL Server 的安装时间。

在这种情况下，我认为您应该始终存储 UTC 数据（例如，使用`GETUTCDATE()`而不是`GETDATE()`. 稍后将其转换为您想要的（或任何！）时区要容易得多，例如 .NET 具有各种内置功能来处理此问题你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-06T12:58:31.067

我建议使用它（本例中为 EST）

```
SYSDATETIMEOFFSET() AT TIME ZONE 'Eastern Standard Time' 
```

这将返回任何选定时区的精确时间日期和偏移量。这种方法将不依赖于服务器时区。

# java - Java Canvas 绘制时间不规律？

> ID：14523421
> 
> 赞同：0
> 
> 时间：2013-01-25T14:08:05.747
> 
> 标签：java, performance, swing, canvas, awt

我`Canvas`从`java.awt`包中添加了一个`JFrame`. 使用`Canvas`双缓冲绘制，启用`canvas.createBufferStrategy(2)`.

这是我的`render()`方法，应该很快，因为我画的不多：

```
Graphics g = strategy.getDrawGraphics();

// draw
g.drawImage(...); // Image with a size of 1000x1000
g.drawString(...); // Drawing a short String with the Frames per Second
drawModel(g); // this method draws a rotated game character with the 
              // help of Gaphics2D (Imagesize: 100x100)

g.dispose();
strategy.show(); 
```

我在 System.currentTimeMillis() 的帮助下测量了性能，并得到了结果（每帧时间）：

*   9ms
*   9ms
*   11ms
*   10ms
*   0ms
*   21毫秒
*   10ms

一个渲染过程需要 0 毫秒，而下一个渲染过程是平均时间的两倍，这怎么会发生？您对提高整体渲染性能有何建议？

**// 更新**

我`JPanel`现在尝试过：它是喇叭形的，而且比 Canvas 慢得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:24:59.037

`System.currentTimeMillis()`通常不超过 10 毫秒。试试`System.nanoTime()`。

# iphone - 根据按下的单元格更改视图控制器中的文本

> ID：14523422
> 
> 赞同：0
> 
> 时间：2013-01-25T14:08:15.280
> 
> 标签：iphone, objective-c, uitableview

我`UITableView`在情节提要中有很多不同的单元格，我希望`UIViewController`在您按下单元格时发送给您的文本进行一些更改。我不知道这在情节提要中是否可行，或者我是否必须添加代码。上次我为 iOS 制作应用程序时，我只是`UIViewController`为每个新按钮制作了一个新按钮，但这次不行，因为我有大约 30 个不同的单元格。如果有人可以通过教程或其他东西为我指明正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:18:11.657

步骤如下，虽然不准确，但大同小异

首先创建一个新的主从模板项目

![在此处输入图像描述](../Images/c6645692ab95f461f031342d73cce6f4.png)

下一步是选择故事板和 iPhone

![在此处输入图像描述](../Images/464b2e04d121a98f17168d2ee51113fd.png)

现在运行应用程序。它几乎是你想要的。

# ios - 核心数据 - 2 个对象模型，1 或 2 个托管对象上下文 - 哪个更好？

> ID：14523423
> 
> 赞同：0
> 
> 时间：2013-01-25T14:08:15.400
> 
> 标签：ios, core-data, nsmanagedobjectcontext

我正在开发一个小型 iPhone 日志记录应用程序，我希望将位置数据数据库与用户记录的数据分开。

我有几个理由将两者分开，包括

1) 我可能会通过应用程序更新推送定期位置数据更新，我不想冒险造成故障并影响用户数据。

2) 位置数据可能会使用户数据相形见绌，因此如果两者分开，同步和备份用户文件会更快。

因此，鉴于我打算拥有两个持久性存储，在性能和编码复杂性方面，一个上下文中有两个持久性存储，而不是 2 个独立的上下文，每个上下文都有自己的持久性存储，是否有优势或劣势？

对此的任何想法将不胜感激 - 在涉及到这些东西时我有点n00b - 在此先感谢

西蒙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:20:14.897

我在我的应用程序中实现了类似的东西，我从 2 个数据库加载数据，因为我想将更新推送到一组数据。

我这样做的方式是使用 1 个对象模型、1 个托管对象上下文但 2 个持久存储，每个存储都加载不同的 sqlite 文件。为此，我在数据模型文件中创建了 2 个配置，然后将适当的实体拖到每个配置中。然后，当您创建持久存储时，请执行以下操作：

```
[__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:@"Configuration1" URL:store1URL options:[NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption, [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil] error:&error];
[__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:@"Configuration2" URL:store2URL options:[NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption, [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil] error:&error]; 
```

到目前为止，我发现的唯一问题是您不能在商店之间建立关系。[这个答案](https://stackoverflow.com/a/13435828/673492)显示了如何使用获取的属性来复制关系。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T20:55:21.350

实际上，我能够使用两个不同的 managedObjectContexts 与两个不同的模型和两个不同的持久存储使用相同的应用程序。

只需将它们加载到 Application Delegate 上，它们就可以在整个应用程序中使用。

我所做的是，我只是为第一个上下文复制并粘贴了完全相同的初始化默认代码，并将其重命名为新的上下文、存储和模型。

我为什么这样做？我收到了一个完全独立的应用程序模块，我对它没有太多控制权，我不想弄乱我的应用程序的逻辑并能够将它保存在代码存储库的单独分支中，为主分支进行差异化提交和樱桃采摘增强。

# c# - 电子邮件报告功能、单例或工厂模式设计？

> ID：14523429
> 
> 赞同：-2
> 
> 时间：2013-01-25T14:08:30.130
> 
> 标签：c#, oop, design-patterns, singleton, factory-pattern

我正在做一个项目，在某些条件下，将向预定义的用户列表发送一封电子邮件。我不确定要遵循的最佳设计模式。只会使用一个电子邮件发件人对象。

我有一个类将执行业务规则的推理，除了它的设置类之外，还有一个将执行电子邮件发送的类。

我在 C# 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:18:22.820

在您提到的问题中，“将仅使用一个电子邮件发件人对象”。考虑到这是一项要求，Singleton 是您的最佳选择。

# mysql - 来自选择结果的mysql concat

> ID：14523431
> 
> 赞同：5
> 
> 时间：2013-01-25T14:08:43.400
> 
> 标签：mysql

我想在 MySQL 中插入数据并在字段上自动命名，`username`但我该怎么做呢？
目前表中数据为：

```
+----+----------+
| 编号 | 用户名 |
+----+----------+
| 1 | 管理员1 |
| 2 | 管理员2 |
+----+----------+

```

我尝试使用这个 sql 但它不能：

```
插入到`tbl_user`（
`用户名`
)
价值观（
CONCAT('admin',(SELECT MAX(SUBSTRING_INDEX(`username`,'admin',-1))+1 FROM `tbl_user`))
);

```

并得到错误消息`#1093 - You can't specify target table 'tbl_user' for update in FROM clause`

我想要的最终结果是：

```
+----+----------+
| 编号 | 用户名 |
+----+----------+
| 1 | 管理员1 |
| 2 | 管理员2 |
| 6 | 管理员3 |
| 9 | 管理员4 |
+----+----------+

```

那可能吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T14:24:58.937

You can use a trigger that would update the column *username* after an insert. Here's some more information on how to actually do this: [http://www.roseindia.net/sql/trigger/mysql-trigger-after-insert.shtml](http://www.roseindia.net/sql/trigger/mysql-trigger-after-insert.shtml)

**Edit**

I forgot that MySQL won't allow you to update a table from a trigger declared on the same table.

However, this should do what you're trying to do:

```
SET @id := (SELECT id FROM YOUR_TABLE ORDER BY id DESC LIMIT 1);
INSERT INTO YOUR_TABLE (username) VALUES(
   CONCAT("ADMIN", @id + 1)
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:29:37.827

Query:

**[SQLFIDDLEExample](http://sqlfiddle.com/#!2/2e321/1)**

```
INSERT INTO `tbl_user` (
`username`
)
VALUES (
CONCAT('admin',(SELECT MAX(CAST(REPLACE(`username`,'admin','') AS SIGNED INTEGER))+1 
                FROM (SELECT * FROM tbl_user) t))
); 
```

Result:

```
|     ID | USERNAME |
---------------------
|      1 |   admin1 |
|      2 |   admin2 |
| (null) |   admin3 | 
```

# timeout - SNMPv3 发现

> ID：14523445
> 
> 赞同：0
> 
> 时间：2013-01-25T14:09:08.170
> 
> 标签：timeout, version, snmp, discovery

我已经使用 SNMP v1 和 2c 通过发送带有社区“公共”的广播消息来发现打印机的网络，它工作得很好，但是当我发送带有协议版本 3 的广播消息时出现超时错误。

有人分享 SNMPv3 设备发现的例子吗？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T17:39:24.947

两件事情：

1) 做广播 SNMPv1/v2c 实际上并没有定义为在协议中工作。正如您所发现的，廉价的实现将简单地响应它看到内核接受端口而不检查地址的任何数据包。但是，您还会发现一些不会响应广播数据包的实现。所以这实际上并不是一个万无一失的发现机制。（更不用说，许多供应商终于变得聪明了，没有公共作为默认的社区名称）

2) 另一方面，SNMPv3 更不可能工作，因为引擎 ID 发现是如何在 SNMPv3 协议中发生的。无论如何，SNMPv3 都不会以正常的响应 PDU 进行响应，因为它应该以 REPORT PDU 响应“这是我的引擎 ID”，并且您必须使用该引擎 ID*和*正确的 USM 凭据进行响应才能访问设备。

简而言之，SNMPv3 是为安全而设计的，不再有“公共”等价物。您需要知道如何访问设备，而不能只是“猜测”。

# mysql - 将 Hive 表转换为 MySQL

> ID：14523455
> 
> 赞同：1
> 
> 时间：2013-01-25T14:09:35.340
> 
> 标签：mysql, hive

我有一个大型 Hive 表，我想将它从服务器传输到我的本地 MySQL 数据库。有没有这样做的标准方法？

我从 Metastore 下载了 Hive 文件，它似乎是一种不寻常的格式，很难解析到数据库（这些列似乎甚至没有分开）

例如来自蜂巢的文件：

```
"1980""007"59610.0016778523489932886"actors""007"59610.0016778523489932886"7d""007"59620.003355704697986577"abu""007"59610.0016778523489932886 
```

编辑：这是我的桌子

```
DESCRIBE phil_overall_cooc

0   tag_a   string  
1   tag_b   string  
2   bcount  bigint  
3   cooc    bigint  
4   prob    double 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T19:20:01.417

Sqoop 就是您要找的东西！我正在使用它将数据发送到 MySQL。唯一的技巧是你必须使用没有分区的 TEXTFILE

```
file_format:
  : SEQUENCEFILE
  | TEXTFILE
  | RCFILE     (Note: only available starting with 0.6.0)
  | ORC        (Note: only available starting with 0.11.0)
  | INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname 
```

[https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Create%2FDrop%2FTruncateTable](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Create%2FDrop%2FTruncateTable)

如果它不在 TEXTFILE 中，您可以执行

> INSERT INTO TABLE tablename1 [PARTITION (partcol1=val1, partcol2=val2 ...)] select_statement1 FROM from_statement;

[https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertingdataintoHiveTablesfromqueries](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertingdataintoHiveTablesfromqueries)

现在你有了导出表，你可以使用 sqoop 如下：

```
sqoop export 
  --connect ${YOUR_CONNECTION_STRING}
  --username ${YOUR_USERNAME} 
  --password ${YOUR_PASSWORD}
  --table ${MYSQL_TABLE_NAME}
  --update-key ${FIELD1[,FIELD2]*}
  --update-mode allowinsert 
  --export-dir ${PATH_TO_YOUR_HIVE_TABLE_ON_HDFS} 
  --input-fields-terminated-by \001 
  --num-mappers 1 
  --batch 
  --verbose 
```

[http://sqoop.apache.org/docs/1.4.4/SqoopUserGuide.html#_syntax_3](http://sqoop.apache.org/docs/1.4.4/SqoopUserGuide.html#_syntax_3)

祝你好运 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T13:27:08.647

*   此[PDF](http://api.ning.com/files/GmgDk5*tdQIIzeiAIT*felDpELRWJvbShVfnCCCj0XYcEhoZOIggbt4t8ej13tNxQXWF5qKzoB*W4yqTIZzAWbcK4jQ4DM1g/MySQLandHadoopNov2011.pdf&ei=rdMDUZH2LcnjrAepyYCYDg&usg=AFQjCNFDquxh4GSuQarSZaXK8S6fRPPCDw&bvm=bv.41524429,d.bmk)是帮助您的标准指南。

*   此[链接](https://stackoverflow.com/questions/4632514/how-to-transfer-mysql-table-to-hive)讨论将数据导入配置单元（这与您的要求正好相反）。但它也会为您提供有关从蜂巢“导出”的想法。

# php - 如果数据库中已经存在值验证

> ID：14523461
> 
> 赞同：-2
> 
> 时间：2013-01-25T14:09:49.433
> 
> 标签：php, sql

我是 php 新手，我制作了一个表单，其中有两个字段 Code 和 Name，我需要验证它已经在数据库中的 name 的值，但是当我以大写形式插入值时，它不验证 name 的值在大写和小写反之亦然这是我的代码

```
if(mysql_query("SELECT * FROM country "
              ."WHERE $_POST['name']='$name' and $_POST['code']='$code'" )))
{
    echo "Sorry! Your details are already in our database";
} else {
    [...]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:51:40.213

基本上，您的 SQL 语句中的列不正确（对于一个）。另外，正如其他人所指出的，请使用 mysqli_* 或 PDO 系列的 SQL 语句。

```
<?php

$count = 0;
$name = strtolower(mysql_real_escape_string(isset($_POST['name']) ? $_POST['name'] : ""));
$code = strtolower(mysql_real_escape_string(isset($_POST['code']) ? $_POST['code'] : ""));

$query = "SELECT name FROM country WHERE LOWER(name)='".$name."' AND LOWER(code)='".$code."'";

$result = mysql_query($query);

if($result != null)
{
    $count = mysql_num_rows($result);
}

if($count <= 0)
{
    echo "Sorry! Your details are already in our database";
} 
else
{
    // ...
}

?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T14:16:30.597

1) 切勿直接使用 $_POST，因为您的代码不安全。您需要过滤此数据。以下是 PHP [http://php.net/manual/fr/function.filter-var.php](http://php.net/manual/fr/function.filter-var.php)中的一些过滤器函数。

```
$username = filter_var($_POST['name'], FILTER_SANITIZE_STRING);
$code = filter_var($_POST['code'], FILTER_SANITIZE_STRING); 
```

只有这样，您才能考虑使用这些值查询数据库。

2）如果您可以使用，我建议您使用 PDO [http://php.net/manual/fr/book.pdo.php](http://php.net/manual/fr/book.pdo.php)

# php - wordpress 在图像上显示标题

> ID：14523466
> 
> 赞同：0
> 
> 时间：2013-01-25T14:10:00.353
> 
> 标签：php

我正在尝试做自己的滑块。我快完成了，但我需要将我的链接网址显示为标题或其他内容。

我应该添加什么来获取链接和显示？这是我的代码

```
<?php
  // The Loop
      while ( $the_query->have_posts() ) : $the_query->the_post(); ?><li>

          <?php 
           // Check if there's a Slide URL given and if so let's a link to it
              if ( get_post_meta( get_the_id(), 'wptuts_slideurl', true) != '' ) { ?>
                <a href="<?php echo esc_url( get_post_meta( get_the_id(),'wptuts_slideurl', true) ); ?>">

          <?php }
            // The Slide's Image
              echo the_post_thumbnail();

            // Close off the Slide's Link if there is one
              if ( get_post_meta( get_the_id(), 'wptuts_slideurl', true) != '' ) { ?>
              </a> <?php } ?> </li>

<?php endwhile; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:18:27.560

您将数据库中的 URL 作为字符串回显，该字符串放置在`<a>`标记中。这意味着您可以在任何地方回显它。尝试这样的事情：

```
// Close off the Slide's Link if there is one
if ( get_post_meta( get_the_id(), 'wptuts_slideurl', true) != '' ) { ?>
  </a>
  // Add a <span> element which includes the exact same url as your link
  <span class="your-slide-url">
    <?php echo get_post_meta( get_the_id(), 'wptuts_slideurl', true); ?>
  </span>
<?php } ?> 
```

现在，您可以随意设置样式`<span class="your-slide-url">`。

# c++ - 在 C++ 中存储/返回继承类的最佳方法

> ID：14523467
> 
> 赞同：2
> 
> 时间：2013-01-25T14:10:03.200
> 
> 标签：c++, pointers, inheritance, wrapper

我正在围绕一些自动生成的类编写一个包装器，以提供更好的接口。我写了一个简化的例子来演示这个问题。

我有一个 A 类，它有一个指向 X 类对象的指针，然后我有一个 B 类（继承 A），它有一个指向 Y 类对象（继承 X）的指针。

一切都很好，除了我不确定存储指向 X 和 Y 的指针的最佳方法是什么。我需要能够操作 A 类和 B 类对象的集合，就好像它们都是 A 一样（带有指向 X 的指针是我所需要的），这适用于我下面的示例。

我的实际问题是如何最好地处理需要操作 Y 类对象而不是 X 类的 B 类的情况。我确信有一些非常明显的东西我可以在这里使用。每次我使用这个变量并为每个继承我创建的 A 的类定义一个具有不同名称（例如 getY）的方法时，我不得不重复地转换这个变量，这感觉很笨拙。可能有许多像 doStuff 这样的方法，所有这些方法都必须调用 getY。

```
class X {
private:
    int i;
public:
    X(int i) : i(i) {}
    int getI() {
        return i;
    }
};

class Y : public X {
private:
    int j;
public:
    Y(int i, int j) : X(i), j(j) {}
    int getJ() {
        return j;
    }
};

class A {
protected:
    X* x;
public:
    A(X* a) : x(a) {}
    X* get() {
        return x;
    }
};

class B : public A {
public:
    B(Y* y) : A(y) {}
private:
    //I could create a new function for each class like class B
    Y* getY() {
        return (Y*)x;
    }
public:
    void doStuff() {
        Y* y = getY();
        y->getJ();
        std::cout << "J: " << y->getJ() << cout::endl;
    }
}; 
```

主要内容摘录：

```
X* x = new X(5);
Y* y = new Y(5,6);
B b(y);
b.doStuff(); 
```

我想到的另一种选择是，当我构造类 BI 时，可以初始化一个 Y 类型变量的指针，该指针指向与 X 中设置的位置相同的位置。只要我的指针是 const，我认为这应该是安全的两个引用指向不同的事物。

欢迎任何想法。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:54:13.423

好吧，我要做的第一件事就是打破A和B之间的继承关系。你说他们有一个共同的接口，所以从定义这个接口开始：

```
class ILibraryWrapper {
public:
    virtual X * get() = 0;
}; 
```

我假设 A 和 B 共享很多代码（因此是继承关系），所以接下来定义一个模板类来实现接口并定义公共位：

```
template <class T> class LibraryWrapper : public ILibraryWrapper {
protected:
    T * pointer;

public:
    LibraryWrapper( T * value ) : pointer( value ) {}

    virtual X * get() override { return static_cast<X *>( this->pointer ); }
}; 
```

最后，像这样定义 A 和 B：

```
class A : public LibraryWrapper<X> {
public:
    A( X * value ) : LibraryWrapper( value ) {}
};

class B : public LibraryWrapper<Y> {
public:
    B( Y * value ) : LibraryWrapper( value ) {}

    void doStuff() {
        std::cout << "J: " << this->pointer->getJ() << cout::endl;
    }
}; 
```

实际上，您的所有代码都应该处理 ILibraryWrapper 指针或引用。如果某些代码绝对必须知道被包装对象的具体类型，那么您可以进行动态转换：

```
auto wrapper = dynamic_cast<LibraryWrapper<Y> *>( object );
if( wrapper != nullptr ) {
    // ...
} 
```

但一般来说，最好在 ILibraryWrapper 接口中提供所有需要的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T15:05:50.400

只要 Y 从 X 派生，B 从 A 派生，那么这很容易。

只要这些返回类型是多态的，虚函数就可以因返回类型而异。在 A 中实现以下内容：

```
virtual X* Get() const { return x; } 
```

B中的以下内容：

```
virtual Y* Get() const { return static_cast< Y* >( A::Get() ); } 
```

# php - 登录后重定向到上一页？PHP

> ID：14523468
> 
> 赞同：59
> 
> 时间：2013-01-25T14:10:05.210
> 
> 标签：php, authentication, redirect

我一直在寻找解决方案，但无论我尝试什么，我似乎都无法正确解决。

成功登录后，用户应该被重定向到他来自的页面，假设他一直在浏览一个帖子并且想要登录以便他可以发表评论，所以他应该被重定向到他正在浏览的帖子。所以这就是我所拥有的：

**login.php**显示登录表单：

```
<form method="post" action="login-check.php">
... //input for username and password
</form> 
```

**login-check.php**检查是否输入了用户名和密码，用户是否存在，或者他是否已经登录，并向 login.php 发送一个参数`p`：

```
<?php
session_start();
if((empty($username) OR empty($password) AND !isset($_SESSION['id_login']))) {
   header("Location:login.php?p=1");
   exit();
}
elseif (!user_exists($username,$password) AND !isset($_SESSION['id_login'])) {
   header("Location:login.php?p=2");
   exit();
}
elseif(isset($_SESSION['id_login'])) {
   header("Location:login.php?p=3");
   exit();
}
?> 
```

然后参数`p`被发送回**login.php**并显示相应的消息：

```
<?php
if(isset($_GET['p'])) {
  $p = $_GET["p"];

  if($p=="1")
    echo "<p class=\"red\">You didn't fill the form.</p><br></br>";
  if($p=="2")
    echo "<p class=\"red\">User exists.</p><br></br>";
  if($p=="3")
    header("Location: index.php");
}
?> 
```

但是，成功登录后，它应该转到用户以前访问过的页面，而不是转到 index.php。我尝试过不同的方式，但它根本不起作用，或者它返回到 login.php。它不需要超级安全，因为我正在为一个学校项目做这个。
另外，我认为自己很新手，所以请耐心等待：D

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-01-25T14:23:23.127

一种常见的方法是通过`$_GET`变量将用户的当前页面传递给登录表单。

例如：如果您正在阅读一篇文章，并且想发表评论。评论的 URL 是`comment.php?articleid=17`。在`comment.php`加载时，它注意到您没有登录。它想将您发送到`login.php`，就像您之前显示的那样。但是，我们将更改您的脚本，以便让登录页面记住您的位置：

```
header("Location:login.php?location=" . urlencode($_SERVER['REQUEST_URI']));
// Note: $_SERVER['REQUEST_URI'] is your current page 
```

这应该将用户发送到：`login.php?location=comment.php%3Farticleid%3D17`。`login.php`现在应该检查是否`$_GET['location']`已填充。如果已填充，则将用户发送到此位置（在本例中为`comment.php?articleid=17`）。例如：

```
//  login.php
echo '<input type="hidden" name="location" value="';
if(isset($_GET['location'])) {
    echo htmlspecialchars($_GET['location']);
}
echo '" />';
//  Will show something like this:
//  <input type="hidden" name="location" value="comment.php?articleid=17" /> 
```

```
//  login-check.php
session_start();

//  our url is now stored as $_POST['location'] (posted from login.php). If it's blank, let's ignore it. Otherwise, let's do something with it.
$redirect = NULL;
if($_POST['location'] != '') {
    $redirect = $_POST['location'];
}

if((empty($username) OR empty($password) AND !isset($_SESSION['id_login']))) {
    $url = 'login.php?p=1';
    // if we have a redirect URL, pass it back to login.php so we don't forget it
    if(isset($redirect)) {
        $url .= '&location=' . urlencode($redirect);
    }
   header("Location: " . $url);
   exit();
}
elseif (!user_exists($username,$password) AND !isset($_SESSION['id_login'])) {
    $url = 'login.php?p=2';
    if(isset($redirect)) {
        $url .= '&location=' . urlencode($redirect);
    }
   header("Location:" . $url);
   exit();
}
elseif(isset($_SESSION['id_login'])) {
    // if login is successful and there is a redirect address, send the user directly there
    if($redirect) {
        header("Location:". $redirect);
    } else {
        header("Location:login.php?p=3");
    }
    exit();
} 
```

**陷阱**

`$_GET['location']`在将用户发送到那里之前，您应该运行一些验证。例如，如果我告诉使用您网站的人点击此链接：`login.php?location=http%3A%2F%2Fmalice.com%2Fevilpage.php`... 那么他们将被发送到一个试图做坏事的外国 URL。

始终确保`urlencode`在将 URL 作为`$_GET`参数传递时使用。这会对特殊的 URL 字符（例如 、 和 ）进行编码`?`，`&`这样`%`它们就不会破坏您的 url（例如：`login.php?location=comment.php?id=17`<- 这有两个`?`'s 并且无法正常工作）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-25T14:22:11.813

当用户进入登录页面时，使用它来查看来自哪里

```
$_SERVER['HTTP_REFERER'] 
```

然后将此值设置到会话中，当他通过身份验证时，使用会话中的 url 将他重定向回来。但是，如果 url 是您的网站，您应该先检查一下。也许他直接从另一个站点来登录:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-04-22T18:17:06.640

您可以使用 php 保存页面，如下所示：

```
$_SESSION['current_page'] = $_SERVER['REQUEST_URI'] 
```

并返回页面：

```
header("Location: ". $_SESSION['current_page']) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-25T14:13:09.743

您可能应该将要重定向到的 url 放在 POST 变量中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-25T14:25:06.107

由于登录页面是一个单独的页面，我假设您要重定向到用户到达登录页面的页面。

`$_SERVER['REQUEST_URI']`将仅保留当前页面。你想要做的是使用`$_SERVER['HTTP_REFERER']`

因此，将 HTTP_REFERER 保存在表单上的隐藏元素中，`<input type="hidden" name="referer" value="<?= $_SERVER['HTTP_REFERER'] ?>" />`但请记住，在处理表单的 PHP 中，如果登录失败，您将需要一些逻辑来重定向回登录页面，同时还要检查引用者是否实际上是您的网站，如果不是，则重定向回主页。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-07-02T10:32:36.820

另一种方式，使用 SESSION

将当前 URL 分配给会话（在每个页面上使用它）

```
$_SESSION['rdrurl'] = $_SERVER['REQUEST_URI']; 
```

并在您的登录页面中，使用

```
if(isset($_SESSION['rdrurl']))
header('location: '.$_SESSION['rdrurl']);
else
header('location: http://example.com'); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-25T14:49:03.367

使用类似的东西

```
$_SERVER['HTTP_REFERER']; 
```

如果它是一个成功的登录，显示一个链接说“点击这里返回”和一个指向引用者的链接，当页面加载时，使用一些 javascript 来自动加载该页面（不要使用 back() 或其他任何东西功能是因为它不会重新加载页面，并且看起来就像用户从未登录过一样。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-01-28T05:12:59.490

您可以使用 session 来存储登录后要返回的当前页面，如果您正确维护会话，它将适用于其他页面。这是非常有用的技术，因为您可以使用它来开发您的面包屑。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-14T00:08:10.167

你应该尝试类似的东西`$_SERVER['HTTP_REFERER']`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-25T23:16:47.750

您应该首先使用 $_SERVER['HTTP_REFERER']; 在变量中获取用户引用页面；在您的登录页面中。

像：

```
<?php 
    session_start();
    $refPage = $_SERVER['HTTP_REFERER']; 
?> 
```

现在，当用户单击登录时，将标题位置更改为用户参考页面

像：

```
<?php 
if(isset($_POST[login])){
    session_start();
    header('location:' . $refPage);
}
?> 
```

在这个时候，您应该首先检查用户引用页面是否为空，因为您的用户可以直接访问您的登录页面，然后您的 $refPage 变量将为空，因此在单击登录页面后将保留在这里

像：

```
<?php
if(isset($_POST[login])){
    session_start();
    $refPage = $_SERVER['HTTP_REFERER'];  // get reffer page url
    if(empty($refPage)){ 
        header('location: yourredirectpage'); // if ref page is empty then set default redirect page.
    }else{
        header('location:' . $refPage); // or if ref page in not empty then redirect page to reffer page
    }
}
?> 
```

或者您可以使用隐藏的输入类型，您可以在其中设置值 $_SERVER['HTTP_REFERER'];

像：

```
<input type="hidden" name="refPage" value="<?php echo $_SERVER['HTTP_REFERER']; ?>"> 
```

当用户点击登录时，您可以获得**refPage**值并重定向上一页。您还应该检查空的参考页面。因为您的用户可以直接访问您的登录页面。

谢谢你。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-08-11T08:36:35.993

我创建了一个函数来存储上一页的 URL

```
//functions.php

function set_previous_page_url(){

    $current_url = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://{$_SERVER['HTTP_HOST']}{$_SERVER['REQUEST_URI']}"; 
    $previous_url = $_SERVER['HTTP_REFERER'];
    if (!($current_url === $previous_url)){
        $_SESSION['redirect_url'] = $previous_url;
    }
    if(isset($_SESSION['redirect_url'])){
        $url = $_SESSION['redirect_url'];
        return $url;

    } else {
        $url = "index.php";
        return $url;
    }
} 
```

并在 login.php 中调用此函数

```
// login.php

<?php
// set previous page url to redirect after login
$url = set_previous_page_url();

if(ifItIsMethod('post')){
    if(isset($_POST['username']) && isset($_POST['password'])){
        if (login_user($_POST['username'], $_POST['password'])) {
            redirect($url);
            //unset session defined in set_previous_page_url() function
            if(isset($_SESSION['redirect_url'])){
                unset($_SESSION['redirect_url']);
            }

        } 
    }
}
?> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-12-09T00:58:26.730

你可以使用这个：

```
$refererpage = $_SERVER['HTTP_REFERER']; //get referer stored in a variable
if (strpos($refererpage, $_SERVER['SERVER_NAME']) == TRUE) { //if the start position of the referer and the server name is equal
    $refvar= $refererpage; //create a mew variable to be used to locate header
} else { //if referer's address is not the same as server name
    $refvar= "index.php"; //set the variable to another direction for this request
} 
```

并在您想要的任何地方添加标题：

```
header('location: '. $refvr); //set the header location to the referer varaible 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-25T14:13:16.950

通过将查询字符串键/值对写入 URL 来构造表单操作，使其“记住”或保留上一页`returnurl=value`- 这可以从重定向到登录的任何页面传递。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-01-25T14:17:16.233

我认为您可能需要 $_SERVER['REQUEST_URI'];

```
if(isset($_SESSION['id_login'])) {
  header("Location:" . $_SERVER['REQUEST_URI']);
} 
```

这应该采用他们所在的网址并在成功登录后重定向他们。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-04-26T12:15:16.813

这个怎么样 :: javascript+php

```
echo "<script language=javascript> javascript:history.back();</script>"; 
```

它将与浏览器中的上一个按钮相同

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-01-13T03:35:52.320

在登录页面中使用隐藏输入。像：

```
<input name="location" value="<?php if(!empty($_SERVER['HTTP_REFERER'])) echo $_SERVER['HTTP_REFERER']; else echo 'products.php'; ?>" type="text" style="display: none;" /> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-10-06T11:26:24.233

你可以试试

`echo "<SCRIPT>alert(\"Login Successful Redirecting To Previous Page \");history.go(-2)</SCRIPT>";`

或者

`echo "<SCRIPT>alert(\"Login Successful Redirecting To Previous Page \");history.go(-1)</SCRIPT>";`

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-04-04T05:29:19.607

@philipobenito 的回答最适合我。
我首先创建了一个隐藏输入，其中包含用户的 HTTP 引用

```
<input type="hidden" name="referer" value="<?= $_SERVER['HTTP_REFERER'] ?>" /> 
```

成功登录后，我将用户重定向到该隐藏输入中存储的任何值

```
$_POST = filter_input_array(INPUT_POST, FILTER_SANITIZE_STRING);
if(!empty($_POST['referer'])){
    header('Location: '.$_POST['referer']);
}
else{
    header('Location: members.php'); //members.php is a page used to send a user to their profile page.
}
exit; 
```

# javascript - 具有可变属性的目标 JSON 对象

> ID：14523477
> 
> 赞同：1
> 
> 时间：2013-01-25T14:10:17.200
> 
> 标签：javascript, arrays, json

我有一个带有国家列表的 JSON 对象：

```
"countries": {
        "AQ": {"name": "Antarctica", n: 0, current: 1},
        "AF": {"name": "Afghanistan", n: 2, current: 1},
        "AL": {"name": "Albania", n: 3, current: 1},
}

load >>

countriesDB = json.datas.countries 
```

我需要得到一个项目的`n`和`current`。`countriesDB.AQ.n`当然可以。但是调用者来自另一个数据库；`events[0].e[0]`给我`"AQ"`。所以我想做的是这样的：`countriesDB.(events[0].e[0]).n`。

这当然很简单，但我不知道怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:11:55.473

怎么样

```
countriesDB[events[0].e[0]].n 
```

?

# angularjs - 在 AngularJS 中处理来自模板的链接

> ID：14523479
> 
> 赞同：12
> 
> 时间：2013-01-25T14:10:20.547
> 
> 标签：angularjs

目前我正在以这种方式处理链接：

```
<a ng-click="goToLink('/foo')">foo</a>

$scope.goToLink = function(url) {
    $location.path(url)
} 
```

因为如果我这样做

```
<a ng-href="/foo">foo</a> 
```

该页面当然会重新加载（并获得 404），因为它应该类似于：

```
<a ng-href="#/foo">foo</a> 
```

是否有指令或其他东西来定义“与 html5 模式无关”的链接，这样我就不必在每个链接中都添加主题标签？

就像是

```
<a ng-smart-href="/foo">foo</a>. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T14:13:01.273

检查 ng-href，这正是您要寻找的。 [http://docs.angularjs.org/api/ng.directive:ngHref](http://docs.angularjs.org/api/ng.directive:ngHref)

[检查来自http://docs.angularjs.org/guide/dev_guide.services.$location](http://docs.angularjs.org/guide/dev_guide.services.%24location)的“相对链接”示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T16:58:23.767

在 HTML5 模式下，`<a href="/foo">link to foo</a>`如果在旧版浏览器中，将重写为 hash-bang 模式：

请参阅有关此的文档：[使用 $location，Html 链接重写](https://code.angularjs.org/1.1.5/docs/guide/dev_guide.services.%24location#htmllinkrewriting)。

# assembly - 汇编，检测溢出寄存器

> ID：14523480
> 
> 赞同：3
> 
> 时间：2013-01-25T14:10:26.787
> 
> 标签：assembly, overflow

我有这个非常简单的汇编代码：

```
start:
add ax, 100    
; if ax overflow add to bx 1
jmp start 
```

但我不知道如何检测 ax 寄存器溢出，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T14:15:36.110

`ADD`指令集适当`FLAGS`反映溢出情况。溢出有两种：有符号和无符号。您必须决定什么是合适的，并`jc/jnc`用于未签名和`jo/jno`已签名。

```
add ax, 100
jnc noUnsignedOverflow
...
noUnsignedOverflow:

add ax, 100
jno noSignedOverflow
...
noSignedOverflow: 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T14:14:15.000

使用`jo`(jump if overflow) 或`jno`(jump if no overflow)

查看[Intel x86 JUMP 快速参考](http://unixwiz.net/techtips/x86-jumps.html)

# eclipse - Eclipse 突然开始给出这个错误

> ID：14523481
> 
> 赞同：0
> 
> 时间：2013-01-25T14:10:31.980
> 
> 标签：eclipse

我正在使用 Eclipse Juno。我有一个包含 100 个左右的类和接口的工作区，分布在 5 个项目中。根据代码度量实用程序，大约有 5,000 行代码。我打开了大约 5 个 .java 文件。

当我运行单元测试和保存代码时，我不断收到这个错误（它有时是由于任何一种情况而发生的，但不一定是第一次）：

“迭代数据库键时出错

Java 堆空间"

我尝试重新启动 Eclipse 并重新启动计算机，但错误仍然存​​在。

我的 eclipse.ini 文件看起来像这样（我根据以下建议对其进行了编辑：[Out of memory error in eclipse.why?](https://stackoverflow.com/questions/6816234/out-of-memory-error-in-eclipse-why)）

```
-startup
../../../plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
../../../plugins/org.eclipse.equinox.launcher.cocoa.macosx.x86_64_1.1.200.v20120522-1813
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Xms512m
-Xmx512m
-Xdock:icon=../Resources/Eclipse.icns
-XstartOnFirstThread
-Dorg.eclipse.swt.internal.carbon.smallFonts
-XX:PermSize=128m
-XX:MaxPermSize=128m 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:13:34.283

尝试增加你的堆：

-Xmx1024m

[http://wiki.eclipse.org/FAQ_How_do_I_increase_the_heap_size_available_to_Eclipse%3F](http://wiki.eclipse.org/FAQ_How_do_I_increase_the_heap_size_available_to_Eclipse%3F)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:32:18.857

这对你所拥有的内存已经足够了。听起来您的一个单元测试正在处理一个巨大的结果集（坏主意）。向我们展示该代码，但似乎只有在您运行一项特定测试时才会发生这种情况，对吧？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T22:37:14.610

Eclipse 需要大量内存。在 32 位机器上，我将 mn 和 mx 都设置为 2048m。在 64 位机器上，我使用 4096m 作为这些值。我这样做的原因是，当我使用未在自我调整的 JDK 上设置的那些值运行 Eclipse 时，它​​会一直运行堆，直到在中等规模的项目上使用 4G。否则，我最终不得不至少每天重新启动它，这样它就可以释放它隐藏并忘记的所有小块内存。

# dart - Dart：indexed_db 开放版

> ID：14523484
> 
> 赞同：1
> 
> 时间：2013-01-25T14:10:34.133
> 
> 标签：dart

我需要使用 indexedDb 进行本地存储。

打开 indexedDb 时，版本已通过，我想这表明是否需要升级。有人可以解释一下这里发生了什么，特别是版本的意义，从哪里获得版本以及升级是什么？

例如 ：

```
import 'dart:indexed_db' as idb;

final int _iDbVersion = 1;

void fOpenDb(String sDbName) {
  var request = window.indexedDB.open(sDbName, _iDbVersion);
  request.on.success.add((e) => fDbOnOpened(request.result));
  request.on.error.add(fDbOnOpenError);
  request.on.upgradeNeeded.add((e) => fDbOnUpgradeNeeded(request.transaction));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T03:33:51.160

我发现这个有趣的描述在我看来基本上是正确的。：

索引数据库：
数据库

对于每个来源，您都可以创建无限数量的数据库。创建数据库唯一需要的就是一个唯一的名称。一个数据库也有一个版本，这个版本将用来确定数据库的结构。首次创建数据库时，版本将为空字符串。每个数据库一次只能有一个版本，这意味着数据库不能同时存在多个版本。

版本

对象存储集可以更改，但只能通过使用 Version_change 事务进行更改。此事务将更改数据库的版本并更改您定义的对象存储集。

# c# - 在表单初始化时选择选项卡

> ID：14523490
> 
> 赞同：0
> 
> 时间：2013-01-25T14:10:49.923
> 
> 标签：c#, winforms, tabs

这很愚蠢，我以前做过，但现在它不起作用，我在网上找不到解决方案。我有一个表格和一个标签页。在标签页上有 4 个标签。如何在表单加载时选择第 4 个选项卡？我还想使用选项卡的文本或名称，而不是选项卡索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:21:38.543

只需在表单构造函数中选择选项卡。样板代码是：

```
 public Form1() {
        InitializeComponent();
        tabControl1.SelectedTab = tabPage4;
        // or:
        tabControl1.SelectedIndex = 3;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:12:15.000

您需要遍历选项卡以找到所需的选项卡，然后设置 TabControl 的`SelectedTab`属性。

# ruby-on-rails - 为什么我的自定义登录控制器返回 200？

> ID：14523492
> 
> 赞同：0
> 
> 时间：2013-01-25T14:10:57.363
> 
> 标签：ruby-on-rails, json, devise

我正在通过

```
{"email":"invalidemail@gibberish.com"} 
```

作为参数。

我得到了`200`一个零体的回应。为什么我看不到一个`401`？

当我运行第一个

```
User.where('email = ?', params[:email]).first 
```

在控制台中查询，我得到零。我也尝试过使用密码，测试无效密码。在控制台中，它失败了。但我一直在这里得到`200`回应：

```
 def sign_in    
    user = User.where('email = ?', params[:email]).first
    if !user
      render :json => user, status => 401
      return
    end

    if user.valid_password?(params[:password])
      render :json => user
      return
    end

    render :json => user, status => 401
  end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T14:39:43.327

尽管@baldrick 在这种情况下应该使用是正确的，但`head`您的问题是“为什么我看不到 401？”，对此的答案是：因为您有`status`而不是`:status`（符号）。

这应该有效：

```
render :json => user, :status => 401 
```

作为旁注，起初对我来说有点奇怪，当你 put 时`status`你没有得到 a`NameError`因为你正在调用一个（我认为）不存在的方法。但实际上`status`是在 Rails 中定义的`ActionController::Base`，在[`RackDelegation`模块](https://github.com/rails/rails/blob/master/actionpack/lib/action_controller/metal/rack_delegation.rb)中，它委托给默认响应对象 ( `@_response`)：

```
delegate :headers, :status=, :location=, :content_type=,
         :status, :location, :content_type, :to => "@_response" 
```

所以`status`评估为`@_response.status`，它（至少最初）设置为 200（ok）。

因此，`render :json => user, status => 401`等价于`render :json => user, 200 => 401`。只是被忽略了，`200 => 401`因为它与任何定义的选项都不匹配，并且您会得到 200 响应代码而不是预期的 401。

希望这能说明问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:36:03.537

您应该[`head`](http://guides.rubyonrails.org/layouts_and_rendering.html#using-head-to-build-header-only-responses)改为只返回`401`没有页面内容的代码：

```
 def sign_in    
    user = User.where('email = ?', params[:email]).first
    if user && user.valid_password?(params[:password])
      render :json => user
    else 
      head :unauthorized  # 401
    end
  end 
```

# javascript - Ember.js 相当于 .difference？

> ID：14523493
> 
> 赞同：5
> 
> 时间：2013-01-25T14:11:01.820
> 
> 标签：javascript, ember.js

Ember 是否具有[像下划线一样](http://underscorejs.org/#difference)的 .difference 函数？我`ArrayController`每个都有一组对象。我想从中减去所有`ArrayController2`对象`ArrayController1`：

```
ArrayController1:
   1
   2
   3
   4

ArrayController2:
   2
   4 
```

然后做区别：

```
ArrayController1.difference(ArrayController2) => 1
                                                 3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T14:49:52.887

我认为没有一种方法可以做到这一点，但是您可以编写一个基本上执行以下操作的助手：

```
array1.reject((function(item) {
  return array2.contains(item);
}), array2); 
```

只需遍历 array1 并拒绝任何为 array2.contains() 返回 true 的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-10T13:36:42.683

晚了 5 年，但是有一个计算函数`setDiff`可以用来实现你想要的。

```
import { setDiff } from '@ember/object/computed';
...
ArrayDifference: setDiff('ArrayController1', 'ArrayController2') // [1, 3] 
```

[https://www.emberjs.com/api/ember/2.18/functions/@ember%2Fobject%2Fcomputed/setDiff](https://www.emberjs.com/api/ember/2.18/functions/@ember%2Fobject%2Fcomputed/setDiff)

# c# - 忽略另一个项目中的错误以在解决方案中运行当前项目

> ID：14523494
> 
> 赞同：2
> 
> 时间：2013-01-25T14:11:02.107
> 
> 标签：c#, visual-studio, compiler-errors, intellisense, solution

我有一个包含多个项目的解决方案，比如说项目 A、B 和其他项目。

项目 A 未编译。项目 B 正在编译并设置为启动项目。

在修复 Intellisense 捕获的项目 A 错误之前，我无法运行项目 B。并且项目 A 和 B 彼此之间没有任何引用。

有什么方法可以在不修复项目 A 错误的情况下运行项目 B？我想过禁用 Intellisense，但这不是我想要的。

我在 Visual Studio 2010 中使用 C#，但如果在 2012 年有任何帮助，也请告诉我。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T14:20:20.940

在解决方案属性中，确保项目 A 设置为不构建并且项目 B 设置为启动，项目 B 应该启动而不首先尝试构建项目 A

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:18:45.677

听起来项目 B 对项目 A 有依赖关系。如果您认为根本不引用项目 A，请在系统资源管理器中右键单击项目 B，选择项目依赖关系，然后在 Depends On 列表中取消选中项目 A。

# backup - 如何导出或备份 Sphinx 索引

> ID：14523498
> 
> 赞同：0
> 
> 时间：2013-01-25T14:11:15.630
> 
> 标签：backup, search-engine, sphinx

我在服务器上安装了 Sphinx。我想复制 sphinx 在索引期间创建的数据（基本上是为了备份或为开发团队提供精确的副本）。

除了从 {your_install}/data/*.sp* 复制文件之外，我还有其他解决方案吗？

（在这种情况下，.spl 文件受到保护，但它们是空的，它们是有用的还是只有锁定文件？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:27:29.653

.spl 只是一个锁定文件 - 不需要备份它。

我认为唯一的选择是按照您的说明备份数据文件。

请注意，如果您有 RT 索引，那么可能还有其他扩展名（我认为是 .ram）。您还应该备份 Binlog。虽然确实看到了[“FLUSH RTINDEX”](http://sphinxsearch.com/docs/current.html#sphinxql-flush-rtindex "冲洗 RTINDEX") ——这使得备份更清晰。

# wordpress - 重写除文件夹以外的所有内容的规则

> ID：14523505
> 
> 赞同：1
> 
> 时间：2013-01-25T14:11:35.757
> 
> 标签：wordpress, apache, .htaccess, zend-framework

我有一个使用 Zend Framework 的应用程序，但在公共目录下有一个 WordPress 博客（文件夹名为“blog”）。

访问博客的主页很好，但是当我尝试访问帖子时，我的 htaccess 规则让它通过 Zend 框架。我需要在 /public/.htaccess 文件中修改什么以使其忽略对 /public/blog 目录的请求？

这是当前的 .htaccess 文件：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:19:55.483

我认为，这应该工作

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/public/blog/ 
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

# c# - 更改 GET / POST 变量的值

> ID：14523507
> 
> 赞同：0
> 
> 时间：2013-01-25T14:11:43.817
> 
> 标签：c#, asp.net, post, get

我确定我在看一些简单的东西，但我不记得如何改变“GET”变量的值来挽救我的生命。

例如，假设我有网址`www.food.com/food.aspx?foodType=Healthy`

我知道`Request.QueryString["foodType"]`可以用来检索值，但是如果我想说，将“ `Healthy`”更改为“ `Unhealthy`”，我将如何更改回发时的值？

我现在正在为我的按钮使用点击事件，但我一直在更改“ `foodType`.”的值。我尝试使用`Request.QueryString.Add("foodType", "UnHealthy");`，但没有奏效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:26:02.577

我不确定你的用例是什么，但你不能修改集合。正如@Grant 已经提到的那样，该集合是只读的。

如果您使用查看源代码，[`HttpRequest`](http://msdn.microsoft.com/en-us/library/system.web.httprequest.aspx)它会创建这样的`QueryString`集合：

```
new HttpValueCollection(_queryStringText, true, true, Encoding.Default); 
```

第二个参数将集合设置为只读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:19:30.783

据我所知，你不能；该集合是只读的，并且仅在将响应作为原始请求的副产品返回时存在。您可以使用`Response.Redirect(url)`,`url`更改值的原始 URL 在哪里 - 然后这将重新发出请求，服务器将有机会“使用”新变量并为用户提供结果（定向到新 URL，即使页面相同）。

# bash - ## 在 ${} 中是什么意思

> ID：14523512
> 
> 赞同：2
> 
> 时间：2013-01-25T14:11:56.347
> 
> 标签：bash

我正在从 github 阅读 shell 脚本：[脚本](https://github.com/simonthum/git-sync/blob/master/git-sync)

它有两行代码让我感到困惑。我以前从未见过像这样在 bash 中使用 ##。谁能向我解释一下，它是如何工作的？谢谢。

```
branch_name=$(git symbolic-ref -q HEAD)
branch_name=${branch_name##refs/heads/} 
```

注意：第一行产生类似 'refs/heads/master' 的内容，下一行删除前导 refs/heads 使 branch_name 成为 master。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T14:13:52.350

从`bash(1)`手册页，**EXPANSION**部分，**Parameter Expansion**小节：

```
 ${parameter#word}
   ${parameter##word}
          Remove matching prefix pattern.  The word is expanded to produce
          a pattern just as in pathname expansion.  If the pattern matches
          the beginning of the value of parameter, then the result of  the
          expansion  is  the expanded value of parameter with the shortest
          matching pattern (the ``#'' case) or the longest  matching  pat‐
          tern  (the  ``##''  case)  deleted. 
```

当然，也可以[在手册](http://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html)中找到（但它似乎不支持链接到这个确切的文本；在页面上搜索`##`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:15:32.807

[在这里](http://tldp.org/LDP/abs/html/string-manipulation.html)查看描述了许多其他字符串操作技巧的地方。简而言之

```
${string##substring} 
```

`$substring`从 的 前面删除最长的匹配项`$string`。

# objective-c - 在 NSURLConnection sendSynchronousRequest 中接收自定义 HTTP statusCode

> ID：14523513
> 
> 赞同：1
> 
> 时间：2013-01-25T14:11:57.643
> 
> 标签：objective-c, http, nsurlconnection

`[NSURLConnection sendSynchronousRequest...]`我向我们的网络服务发送了一个 GET 请求。如果发生错误，服务器会用他的一个代码覆盖默认的 HTTP 状态代码。

我将测试错误处理，但如果服务器发送自定义 HTTP 代码，总是会变成超时（错误域=NSURLErrorDomain 代码=-1001“请求超时。”）。如果服务器发送标准 HTTP 代码（例如 400），则 NSURLConnection 工作正常并立即给我这个代码。

是否有人将 NSURLConnection 与非标准 HTTP 故障代码一起使用，并且可以帮助我使此设置正常工作？

谢谢

# qt - 如何更改 Qt QPrinter 的纸张尺寸？

> ID：14523526
> 
> 赞同：1
> 
> 时间：2013-01-25T14:12:36.210
> 
> 标签：qt

我正在尝试使用 Qt 打印 PDF，它工作正常。但是，在某些情况下，我想在知道实际打印多少之后更改纸张的大小。

我正在尝试更改连接到我的`QPainter`对象的设备的纸张大小，但它不会影响实际输出。

这是我在伪代码中所做的：

```
printer = new QPrinter(...);
printer->setPaperSize(...); /* eg. A4 */

painter = new QPainter();
painter->begin(printer);

determine_page_size_by_trial_rendering(frame, printer, *painter);

printer->setPaperSize(....); /* eg. A5 */

real_rendering(frame, printer, *painter) 
```

不幸的是，我似乎无法做到这一点。我觉得该`QPainter`对象以某种方式将页面大小保持在某处，而我无法重置它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:19:34.207

好的-我想它已经信不信由你。我找了一天多，结果发现很简单——我只是销毁了Painter反对，然后打开了一个新的：

```
painter->end();
painter = new QPainter(printer); 
```

这解决了它...

# cakephp - 如何使用 JSH 更改另一个元素事件中的元素

> ID：14523528
> 
> 赞同：0
> 
> 时间：2013-01-25T14:12:36.910
> 
> 标签：cakephp, cakephp-2.0

我想在提交表单而不发送 ajax 请求时更改元素。并且无法弄清楚如何正确编写它并生成我想要的代码。

在 cakePHP 视图中，我有：

```
$this->Js->get('#testForm')->event('submit', $this->Js->get('#fastRegisterForm')->effect('show')); 
```

它会生成：

```
$(document).ready(function () {
    $("#fastRegisterForm").bind("submit", function (event) {
        $("#fastRegisterForm").show();
        return false;
    });
}); 
```

我想拥有：

```
$(document).ready(function () {
    $("#testForm").bind("submit", function (event) {
        $("#fastRegisterForm").show();
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:12:49.687

忘记 JsHelper 并自己编写 jquery 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T17:18:21.447

我认为你应该以不同的方式设置它。

```
$eventCode = $this->Js->get('#fastRegisterForm')->effect('show');

$this->Js->get('#testForm')->event('submit', $eventCode); 
```

`js->get`当你在一个内部调用另一个蛋糕时，蛋糕可能会变得“困惑”`js->get`

# java - JNI：调用 GetStaticMethodID 失败

> ID：14523529
> 
> 赞同：5
> 
> 时间：2013-01-25T14:12:37.017
> 
> 标签：java, android, c++, java-native-interface

我正在编写一些代码来获取衍生线程以从 C++ 调用静态 Java 方法。

如果将调用该方法的位放置在来自 Java 的本机调用中，而不是来自带有附加 JNIEnv 的线程，则调用该方法的位可以正常工作。

我设置了一个 JavaVM*，如下所示：

```
jint JNI_OnLoad(JavaVM* jvm, void* reserved)
{
    LOGI("Setting Java Virtual Machine");

    ThreadJNIEnvironment::javaVM = jvm;

    return JNI_VERSION_1_6;
} 
```

这确实被调用了。

然后我生成另一个线程，并从这个线程执行以下操作：

```
JNIEnv* env;
jint ret = ThreadJNIEnvironment::javaVM->AttachCurrentThread(&env, NULL);

LOGI("AttachCurrentThread returned %d", ret);

jclass interfaceClass = env->FindClass("com/ecmsys/mcb/model/McbInterface");
jmethodID testMethod = env->GetStaticMethodID(interfaceClass, "Test", "()V");
env->CallStaticVoidMethod(interfaceClass, testMethod); 
```

AttachCurrentThread 返回 0。

GetStaticMethod 因以下错误而爆炸：

```
Fatal signal 11 (SIGSEGV) at 0x0000002c (code=1)..... 
```

我只是看不到我做了什么来扰乱它...哦等等...如果不进行一些设置，您将无法从生成的线程访问 Java 应用程序类...

```
jint JNI_OnLoad(JavaVM* jvm, void* reserved)
{
    LOGI("Setting Java Virtual Machine");
    ThreadJNIEnvironment::javaVM = jvm;

    JNIEnv* env;

    jvm->AttachCurrentThread(&env, NULL);
    jclass mcbInterface = env->FindClass("com/ecmsys/mcb/model/McbInterface");
    ThreadJNIEnvironment::interfaceClass = env->NewGlobalRef(mcbInterface);

    return JNI_VERSION_1_6;
} 
```

然后这样做：

```
JNIEnv* env;
jint ret = ThreadJNIEnvironment::javaVM->AttachCurrentThread(&env, NULL);

LOGI("AttachCurrentThread retured %d", ret);

if(ThreadJNIEnvironment::interfaceClass)
{
    jmethodID testMethod = env-->GetStaticMethodID(static_cast<jclass>ThreadJNIEnvironment::interfaceClass), "Test", "()V");
    env->CallStaticVoidMethod(static_cast<jclass>(ThreadJNIEnvironment::interfaceClass), testMethod);
}

ThreadJNIEnvironment::javaVM->DetachCurrentThread(); 
```

你生活和学习！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:25:22.433

在查找`interfaceClass`( [`env->ExceptionCheck()`](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/functions.html#wp5234)) 后检查异常，或者简单地检查它是否为非 NULL。类查找很可能失败。

# c# - 为什么 Linq Cast<> 助手不能与隐式转换运算符一起使用？

> ID：14523530
> 
> 赞同：18
> 
> 时间：2013-01-25T14:12:43.180
> 
> 标签：c#, linq, casting, implicit-conversion, coercion

*在决定投票为重复之前，请阅读到最后......*

我有一种将`implicit cast`运算符实现为另一种类型的类型：

```
class A
{
    private B b;
    public static implicit operator B(A a) { return a.b; }
}
class B
{
} 
```

现在，隐式和显式转换工作得很好：

```
B b = a;
B b2 = (B)a; 
```

...那为什么 Linq`.Cast<>`没有呢？

```
A[] aa = new A[]{...};
var bb = aa.Cast<B>();  //throws InvalidCastException 
```

查看 的源代码`.Cast<>`，并没有什么神奇之处：如果参数确实是 a `IEnumerable<B>`，则有一些特殊情况，然后：

```
foreach (object obj in source) 
    yield return (T)obj; 
    //            ^^ this looks quite similar to the above B b2 = (B)a; 
```

那么为什么*我的*显式演员表起作用，但里面的演员表不起作用`.Cast<>`？

编译器会加糖我的显式转换吗？

PS。我看到了[这个问题](https://stackoverflow.com/q/808725/11545)，但我认为它的答案并不能真正解释发生了什么。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-25T14:14:59.127

> 那么为什么我的显式演员表起作用，而 .Cast<> 里面的演员表却不起作用？

您的显式转换*在编译时*知道源类型和目标类型是什么。编译器可以发现显式转换，并发出代码来调用它。

泛型类型*并非*如此。请注意，这通常不是特定于`Cast`LINQ 或 LINQ - 如果您尝试一个简单的`Convert`方法，您会看到同样的事情：

```
public static TTarget Convert<TSource, TTarget>(TSource value)
{
    return (TTarget) value;
} 
```

这*不会*调用任何用户定义的转换 - 甚至不会调用从（比如说）`int`到`long`. 它*只会*执行参考转换和装箱/拆箱转换。这只是泛型工作方式的一部分。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-25T14:19:22.103

简短的回答很简单：该`Cast<T>`方法不支持自定义转换运算符。

在第一个示例中：

```
B b = a;
B b2 = (B)a; 
```

`B(A a)`编译器可以在静态分析期间看到这个运算符；`call`编译器将此解释为您的自定义运算符方法的静态。在第二个例子中：

```
foreach (object obj in source) 
    yield return (T)obj; 
```

不了解操作者*的*信息；这是通过实现`unbox.any`的（这与`castclass`if`T`是 ref 类型相同）。

还有第三种选择：如果您通过 via `dynamic`，运行时实现会尝试模仿编译器规则，因此这*将*找到运算符 ... 但不是 C#-to-IL 编译步骤的一部分：

```
dynamic b = a; // note that `dynamic` here is *almost* the same as `object`
B b2 = b; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-25T14:54:31.880

`Enumerable.Cast<T>`是一种 .Net 框架方法，并且具有在所有调用它的 .Net 语言中都有意义的行为。

另请参阅 Ander Hejlsberg[对此讨论](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/fe6c7c84-5f99-484a-99de-b331d4c88b76/)的回复。

* * *

> 编译器会加糖我的显式转换吗？

您所说的“隐式转换运算符”实际上是“[隐式转换运算符](http://msdn.microsoft.com/en-us/library/85w54y0a%28v=vs.80%29.aspx)”。这是一个常见的错误。

C# 允许您使用强制转换语法指定转换。发生这种情况时，您使用的是不同的实例（转换），而不是更改对同一实例的引用（转换）。

# java - 瑞典语字符无法正确保存在 MySQL 数据库中

> ID：14523532
> 
> 赞同：2
> 
> 时间：2013-01-25T14:12:56.923
> 
> 标签：java, mysql, utf-8, java-io, latin1

我有一个独立的 java 程序，它以**UTF-8 模式打开一个文本文件，并读取文件中包含****瑞典字符**（如**å、ä、ö**）的每一行。文本文件已以 utf-8 模式保存。java 程序将从文件中读取的内容打印到标准输出中，并且我已经验证该程序可以正确读取和打印这些特殊字符。然后，程序使用 JDBC 连接将从文件中读取的数据保存到**Mysql 5.5**数据库中，并使用默认**的 utf-8排序规则。**

然而，当程序将这些带有瑞典语字符的文本数据插入 mysql 数据库时，特殊字符被替换为不可读的奇怪黑色字符。如果我将数据库排序规则更改为**latin1**，那么 MySQL 服务器会删除所有这些特殊字符。我用谷歌搜索了这个问题，发现了涉及使用 utf-8 和 latin1 作为默认数据库排序规则的建议，但到目前为止似乎没有一个对我有帮助。

我想知道是否有人在将瑞典语字符放入 mysql 数据库时遇到类似问题？如果是这样，你能告诉我我应该使用什么排序规则类型和字符集来正确地在数据库中包含瑞典字符。我是否必须在 JDBC 数据库连接中进行特定设置才能正确保存这些字母？也许这个问题与 java 相关，但我从视觉上验证了我的 java 程序可以正确读取/打印这些字符。谢谢。

# c# - Modal PopUp Extender 中的网格视图？

> ID：14523533
> 
> 赞同：3
> 
> 时间：2013-01-25T14:12:56.637
> 
> 标签：c#, javascript, asp.net, ajax, modalpopupextender

我正在用 ASP.net C# 开发一个映射应用程序。

我有一个文本框和按钮，它在邮政编码上搜索数据库并将结果返回到我的 aspx 页面上的网格视图中......

```
public partial class _Default : System.Web.UI.Page
{
// SDE connection string to extract postcode from ADDRESS (sde) table. 

private SqlConnection m_sqlConn;

protected void Page_Load(object sender, EventArgs e)
{

}

private void ShowMsg(string strMessage)
{
}

protected void Button1_Click(object sender, EventArgs e)
{
    try
    {

        if (txtPostCode.Text.Length > 0)
        {
            m_sqlConn = new SqlConnection();
            m_sqlConn.ConnectionString = "Data Source=Server1;Initial Catalog=sde;User
            ID=Tom;Password = Password1";

            SqlCommand sqlCmd = new SqlCommand();
            sqlCmd.Connection = m_sqlConn;
            sqlCmd.CommandType = System.Data.CommandType.Text;
            sqlCmd.CommandText = "SELECT * FROM ADDRESS"
                                        + " WHERE Postcode = '" + txtPostCode.Text + "'";

            m_sqlConn.Open();

            SqlDataReader reader = sqlCmd.ExecuteReader();

            GridView1.DataSource = reader;
            GridView1.DataBind();

        }

        else
        {
            ShowMsg("Error - No Postal Addresses Returned");
        }
    }
    catch (Exception ex)
    {
        ShowMsg("Error - " + ex.Message);
    }

}

            private bool CloseDB()
{
    try
    {
        m_sqlConn.Close();
        return (true);
    }
    catch (Exception ex)
    {
        return (false);
    }

} 
```

}

这工作正常。我现在想在模态弹出窗口中设置数据网格，用户单击搜索按钮并以模态方式返回结果表。我试过用一个假的 ControlID 按钮来设置它，但没有运气......

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager> 
```

```
 <asp:Button id="BtnFake"  runat="server" Style="display: none"/>

<table id="ModalGrid">

<asp:GridView ID="GridView1" runat="server">

 </asp:GridView>

 <asp:Button id="Button2"  runat="server" Text="OK" />

 </table>

<cc1:ModalPopupExtender ID="ModalPopupExtender1" runat="server" 
    TargetControlID="BtnFake" PopupControlID="ModalGrid" DropShadow="false"       
    BackgroundCssClass="ModalBackground"
    CancelControlID="BtnOK" BehaviorID="ModalGrid"       RepositionMode="RepositionOnWindowScroll">
     </cc1:ModalPopupExtender> 
```

有任何想法吗？确定我在做一些明显错误的事情。干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T21:33:15.553

1.  在将模式弹出窗口设置`TargetControlId`为虚拟字段的情况下，您必须显式调用`ModalPopupExtender1.Show();`以显示模式。
2.  BtnOK 在哪里？不应该是Button2吗？

提示 - 为虚拟字段使用按钮有点矫枉过正，请使用简单的东西，例如`<span>`a

如果您遇到困难，下面是一个工作示例，但我相信致电`ModalPopupExtender1.Show();`应该可以解决您的问题：

**ASPX：**

```
<form id="form1" runat="server">
<asp:ToolkitScriptManager ID="sm" runat="server">
</asp:ToolkitScriptManager>
<span ID="dummy" runat="server" />
Post code:&nbsp;<asp:TextBox ID="txtPostcode" runat="server" /><br />
<asp:Button ID="btnSearch" runat="server" Text="Search" OnClick="Search" />
<asp:Panel runat="server" ID="modalPanel" CssClass="modalPanel">
    <asp:GridView ID="GridView1" runat="server">
    </asp:GridView>
    <asp:Button ID="btnCancel" runat="server" Text="Cancel" />
</asp:Panel>
<asp:ModalPopupExtender id="ModalPopupExtender1" runat="server" TargetControlID="dummy"
    PopupControlID="modalPanel" BackgroundCssClass="ModalBackground"
     CancelControlID="btnCancel" BehaviorID="ModalGrid">
 </asp:ModalPopupExtender>
</form> 
```

**后面的代码：**

```
protected void Search(object sender, EventArgs e)
{
    List<PostalCode> codes = new List<PostalCode>()
    {
        new PostalCode{ Code="000",Province="District 0" },
        new PostalCode{ Code="111",Province="District 1" }
    };

    string code = txtPostcode.Text;

    if (codes.Where(c => c.Code == code).Any())
    {
        GridView1.DataSource = codes.Where(c => c.Code == code);
        GridView1.DataBind();
        ModalPopupExtender1.Show();
    }
} 
```

**我用于测试的类：**

```
public class PostalCode
{
    public string Code { get; set; }
    public string Province { get; set; }
} 
```

# android - 按下按钮在列表视图中插入字符串

> ID：14523535
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:00.870
> 
> 标签：android, string, android-arrayadapter

我在一个应用程序中工作，捕获一个条形码，我想在列表中显示，但我遇到的问题是捕获的数据未显示在列表中，并且不是每次使用按钮捕获时都会添加捕获的新条形码。感谢帮助

公共类 MainActivity 扩展 Activity {

```
 String barcode;
    ListView ListaBarCode;
    ListAdapter listAdapter;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ListaBarCode = (ListView) findViewById( R.id.lvCodigoDeBarra);

        if(barcode == null)
        {
          //do nothing  

        }else
        {
            String [] codigosDeBarra = new String[] {barcode};
            ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                      android.R.layout.simple_list_item_1, android.R.id.text1, codigosDeBarra);

            ListaBarCode.setAdapter(adapter);               
        }
    }

    public void btnScanner(View view)
    {
        IntentIntegrator integrator = new IntentIntegrator(this);
        integrator.initiateScan();

    }

    public void onActivityResult(int requestCode, int resultCode, Intent intent) {
          IntentResult scanResult = IntentIntegrator.parseActivityResult(requestCode, resultCode, intent);
          if (scanResult != null) {

              barcode = scanResult.getContents();
          }

        }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:28:04.643

您需要将数据添加到，然后通过调用和`Adapter`刷新。`ListView``notifyDataSetChanged()``Adapter``invalidate()``ListView`

# regex - AND 运算符正则表达式

> ID：14523537
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:01.700
> 
> 标签：regex, arrays

我正在使用基于 RegEx 的自动 ronconciliation 工具。我想匹配两个名字。示例：`"John Francis Edward Smith"`与 比较`"John Smith"`。另外，由于名称可能包含错误，我只比较第一个单词的前三个字母和最后一个单词的前三个字母。因此，这里的积极匹配将是：`"Joh"`并且`"Smi"`在双方。我可以构建表达式`(^\D{3}).*\s+(?=\S*$)(\D{3}).*$`，但问题是引擎进行了两个分组并在它们上使用 OR 运算符，而我需要 AND 所以两者都需要是正确的。我什么都试过了。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T23:42:05.543

如果你需要避免分组，你可以尝试一些简单的事情，比如

```
\bJoh.*\bSmi 
```

这将匹配一个包含“Joh”和“Smi”的字符串，并注意每个三个字母序列开始一个单词（因此它不会匹配“John ClineSmith”）

**编辑**

> 我不是专门找约翰史密斯。我正在尝试提取姓名的第 3 个字母和姓氏的第 3 个字母，其中 name-lastname 输入可能有 1 个或多个中间名（例如：John Robert James Smith）。但它不能是两个分组，结果必须是一个单词（即上例中的'JohSmi'）。

很抱歉成为坏消息的承担者，但是您所要求的不能纯粹用正则表达式来完成。正则表达式旨在匹配一系列字符，一个接一个，不中断。您可以使用分组从最终匹配中提取子序列，也可以执行多个匹配，但正则表达式匹配将始终返回从第一个匹配字符到最后一个匹配字符的完整序列（不跳过）。

您要求的是一个正则表达式，它从匹配的开头返回 3 个字符，从结尾返回 3 个字符，中间没有任何字符。这是一个损坏的序列，我知道没有任何正则表达式引擎能够做到这一点。您将不得不使用额外的代码（php 或任何您的工具）或放弃此方法并尝试寻找替代方法。

这个问题涵盖了相同的领域：[Regular expression to skip character in capture group](https://stackoverflow.com/questions/277547/regular-expression-to-skip-character-in-capture-group)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:35:14.270

假设我正确理解了您的问题，这对我有用

```
/^(\D{3}).*(\b[^\s]{3})/ 
```

`^`锚点到行 首贪婪地尽可能多地 `(\D{3})`捕获第一组 发现“单词边界” 是三个不是空格的字符 我猜 \S{3} 也可以`.*``\b``[^\s]{3}`

诀窍是 .*\b 将找到字符串中的最后一个单词边界

# android - 使用 Android 2.3.3 SDK 的扩展通知

> ID：14523539
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:05.473
> 
> 标签：android, android-notifications

我在状态栏中收到通知，但如果文本很长，则它不会显示整个文本。我的要求是显示全文。我发现它可以使用 Notification Builder 来完成。如以下代码所示：

通知通知 = 新 Notification.BigTextStyle(builder)

但它只会支持Android 3.0及以上。现在我无法更改我的 sdk，因为我正在使用很多东西，比如 Gallery，以上版本已弃用。所以请建议我是否使用Android 2.3.3，我是否可以实现扩展通知。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:42:23.320

简短的回答是不，你不能......

长答案是：

您必须更改目标 SDK（您仍然可以使用 Gallery，但最好重写此代码）

编辑：无论如何，即使在文档中，我们也有声明：[为了在每个 Android 版本中维护您的应用程序，您应该增加此属性的值**以匹配最新的 API 级别**，然后在相应的平台版本上彻底测试您的应用程序。](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html#target)

正如我在编程中弃用的评论中所写的那样，这意味着`try to avoid this class/method, it still will works, but from now, there are better classes/methods for doing this`

现在你有两个选择：

首先，使用支持 v4 库中的[NotificationCompat.Builder](http://developer.android.com/reference/android/support/v4/app/NotificationCompat.Builder.html) ...但在版本低于 4.1 的设备上，它只会显示文本

其次，为版本低于 4.1 的设备制作自己的自定义通知，并在其他设备上使用新的 API ...

# asterisk - 连接到星号服务器上的 index.php

> ID：14523548
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:17.680
> 
> 标签：asterisk, file-not-found

我正在尝试连接到位于我的 Asterisk 服务器上的目录 /var/lib/asterisk/agi-bin/index.php 中的 index.php 文件。当我尝试连接时，我使用 /var/lib/asterisk/agi-bin/index.php url，但每次都会收到错误 404。我也在文件上使用了 chmod 777 ，这应该使它对所有人可见，包括我的浏览器。

我不知道该怎么做才能让它比 777 更显眼……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:55:10.433

听起来您正试图在您的网络浏览器中打开 index.php 文件。如果是这种情况，您可能希望将其放入您的 Web 服务器正在服务的目录中。（例如使用 apache /var/www/html/index.php）

/var/lib/asterisk/agi-bin/ 目录用于存储您计划使用拨号计划中的 AGI 访问的脚本。例如在 /etc/asterisk/extensions.conf

```
[agi-test]
exten => 100,1,NoOp(calling AGI script)
same => n,AGI(index.php) 
```

有关更多信息，请参阅：

[https://wiki.asterisk.org/wiki/display/AST/Asterisk+11+Application_AGI](https://wiki.asterisk.org/wiki/display/AST/Asterisk+11+Application_AGI)

[http://www.asteriskdocs.org/en/3rd_Edition/asterisk-book-html-chunk/AGI.html](http://www.asteriskdocs.org/en/3rd_Edition/asterisk-book-html-chunk/AGI.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:57:16.830

我是一位经验丰富的 Apache 和 Asterisk 工程师，但今天这个问题与 Asterisk 毫无关系。这只是关于提供一个 PHP 页面，仅此而已。

**您可以通过运行以下命令lynx [http://some.thing.com/path/index.php](http://some.thing.com/path/index.php)**从盒子到盒子点击相同的 URL 来测试它，然后看看你得到了什么。您可以在执行此操作的同时在另一个终端中运行此命令，以查看发生了什么**tail -f /var/log/httpd/access_log**您可能需要运行**apachectl -S**以了解更多关于您的具体内容的信息服务器正在服务。您可以在查看您正在跟踪的日志时一直尝试**lynx http://127.0.0.1/path/to/file/index.php**或**lynx http: //localhost/path/to/file/index.php。**您可以尝试**lynx http://fqdn/path/to/file/index.php**假设您的 DNS 或 /etc/hosts 文件是正确的并且可以工作。

一旦你在那里获得了更多信息，回到你的笔记本电脑上点击文件，同时仍然跟踪日志。您也可以从 BASH 提示符以**星号**用户或**root身份运行****php path/to/file/index.php**以查看它们为您做什么，具体取决于该 PHP 文件应该做什么。如果它没有收到该输入，它可能需要一些输入并且根本不会运行。

 ****根据您最终到达的位置，您将需要开始深入研究 PHP 文件/脚本本身。看起来你可能试图让它做一些它不打算做的事情。

如果该文件（或您的任何其他文件）确实要由 apache 提供，您可以将该文件从其当前位置符号链接到文件系统上适当的（即：/var/www/html/）目录。

在此处发布您的日志输出和您的 **历史记录*，供我评论。****

# php - Easyphp phpmyadmin 密码不适用于新用户

> ID：14523550
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:22.033
> 
> 标签：php, phpmyadmin, easyphp

好的，所以我使用的是 easyphp 12.1 和 phpmyadmin 3.5.3 和 mysql 5.5.27。问题是每次我使用 coomadline 或使用 phpmyadmin 用户界面创建具有密码的用户时，在 mysql 的数据库“用户”中创建的密码显示的是随机密码，而不是我设置的密码，我无法访问 mysql作为使用我设置的密码在 coomandline 中创建的用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T16:38:31.473

[http://dev.mysql.com/doc/refman/5.5/en//adding-users.html](http://dev.mysql.com/doc/refman/5.5/en//adding-users.html)

阅读该指南并尝试按照命令一步一步地操作。我不是非常精通 MySQL 访问，但我之前遇到过类似的问题，这些问题是由属于错误域的用户引起的。因此，虽然您可能有一个在本地分配给数据库的“kuu”用户，但可能会拒绝从远程地址进行身份验证的用户“kuu”。

如果您将查询运行为：

```
CREATE USER 'kuu'@'%' IDENTIFIED BY 'moo'; 
```

...然后您将被允许在任何地方进行身份验证。接下来显然你想提供特权：

```
GRANT ALL PRIVILEGES ON *.* TO 'kuu'@'%' with GRANT OPTION; 
```

如果这些不起作用，那么我认为我们需要了解有关您的设置以及您迄今为止在数据库上所做的其他事情的更多详细信息。

PS。您看到的字符串是一个哈希。如果您有兴趣了解更多关于它们的信息，请查看 AES 等谷歌散列算法、MD5 等旧算法，甚至可以使用散列生成器：http: [//quickhash.com/](http://quickhash.com/)

# java - 如何使用 iReport 将参数传递给 JasperReport

> ID：14523552
> 
> 赞同：1
> 
> 时间：2013-01-25T14:13:29.650
> 
> 标签：java, jasper-reports, ireport

我有一个带有下一个代码的类：

```
public Class GenericVehicle{

    private long vehicle_id;
    //Other attributes
    //...

    private List<wheels> myWheels

    public List<Wheels> getNyWheels(int vehicle_type_id){
        //My code to return all wheels from all vehicle with this type
        return List<Wheels>;
    }
} 
```

我需要使用 iReport 从 JasperReport 调用此方法。我无法执行它，因为我无法从 iReport 传递参数。我该怎么做？

目前，我正在使用带有此数据源表达式的子报表的报表。它为我提供了 GenericVehicle 的所有轮子（如果是汽车、公共汽车、自行车等，则独立）：

```
new JRBeanCollectionDataSource($P{genericVehicle}.getWheels()) 
```

但我需要做类似这样的事情，添加vehicle_type_id 参数以仅获取一种特定车辆类型的车轮：

```
new JRBeanCollectionDataSource($P{genericVehicle}.getWheels($P{vehicle_type_id})) 
```

我无法更改 Java 代码，因为它是固定的。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T11:11:32.173

这是我的错误，可以这样做：

```
 new JRBeanCollectionDataSource($P{genericVehicle}.getWheels($P{vehicle_type_id})) 
```

非常感谢

# javascript - window.showModalDialog 可调整大小的属性不起作用

> ID：14523555
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:38.227
> 
> 标签：javascript, asp.net

我正在 asp.net 中开发一个页面，并且我有这个脚本可以打开一个模式窗口。它工作得很好，但是 resizable 属性似乎不起作用，因为我可以在打开窗口后调整它的大小。

```
Dim script as String = "window.showModalDialog('" + page + "','','unadorned:yes; dialogWidth:330px; dialogHeight:210px; center:yes ; resizable:no; scrollbars:no; toolbar:no; copyhistory:no; menubar:no; status:no ; addressbar:no');"
ScriptManager.RegisterStartupScript(Me, GetType(Page), "alertaerror", script, True) 
```

我需要有关该物业的帮助，我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:17:46.340

某些浏览器根本不允许您打开无法调整大小的窗口，因此该`resizable`设置在这些浏览器中无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T16:29:29.467

我同意古法所说的。但是，如果您确实设置了对话框不可重新调整大小，则可以使用[jQueryUI](http://jqueryui.com/dialog/)或其他 javascript 之类的 jQuery 库来创建模态对话框的效果。

# outlook - 通过 EWS 创建的双周日历约会显示很奇怪

> ID：14523556
> 
> 赞同：0
> 
> 时间：2013-01-25T14:13:38.937
> 
> 标签：outlook, exchange-server, exchangewebservices

我在 Exchange 中创建双周日历约会*或*在 Outlook 中查看时遇到问题

该活动从 2013 年 1 月 19 日开始，每周六和周日每两周一次（间隔 = 2），最多发生 5 次。
预期发生：1 月 19 日星期六、1 月 20 日星期日、2 月 2 日星期六、2 月 3 日星期日、2 月 16 日星期六
*观察到的事件*：1 月 19 日星期六、1 月 27 日星期日、2 月 2 日星期六、2 月 10 日星期日、2 月 16 日星期六。什么？？
我查看了 Outlook 2003 SP3 或 Outlook 2010 (SP?) 的约会。

这是使用 Exchange Web 服务创建事件的代码，并带有关于我尝试过的事情的评论：

```
<soapenv:Envelope
  xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
  xmlns:typ="http://schemas.microsoft.com/exchange/services/2006/types"
  xmlns:mes="http://schemas.microsoft.com/exchange/services/2006/messages">
<soapenv:Header>
  <typ:RequestServerVersion Version="Exchange2007_SP1"/>
  <typ:MailboxCulture>en-US</typ:MailboxCulture>
  <!-- typ:TimeZoneContext makes no difference -->
  <typ:TimeZoneContext>
     <typ:TimeZoneDefinition Id="W. Europe Standard Time"></typ:TimeZoneDefinition>
  </typ:TimeZoneContext>
</soapenv:Header>
<soapenv:Body>
   <mes:CreateItem SendMeetingInvitations="SendToNone">
      <mes:Items>
         <typ:CalendarItem>
           <typ:Subject>Every 2 weeks sa/su, ends after 5</typ:Subject>
           <typ:Body BodyType="Text"></typ:Body>
           <typ:ReminderIsSet>false</typ:ReminderIsSet>
           <typ:Start>2013-01-19T11:00:00.000+01:00</typ:Start>
           <typ:End>2013-01-19T11:30:00.000+01:00</typ:End>
           <typ:IsAllDayEvent>false</typ:IsAllDayEvent>
           <typ:LegacyFreeBusyStatus>Busy</typ:LegacyFreeBusyStatus>
           <typ:Location></typ:Location>
           <typ:Recurrence>
           <typ:WeeklyRecurrence>
             <typ:Interval>2</typ:Interval>
             <!-- Day name order makes no difference -->
             <typ:DaysOfWeek>Saturday Sunday</typ:DaysOfWeek>
             <!-- typ:FirstDayOfWeek>Sunday</typ:FirstDayOfWeek   Tried but not allowed in Exchange2007_SP1 or Exchange2010-->
           </typ:WeeklyRecurrence>
           <typ:NumberedRecurrence>
             <typ:StartDate>2013-01-19</typ:StartDate>
             <typ:NumberOfOccurrences>5</typ:NumberOfOccurrences>
           </typ:NumberedRecurrence>
         <!-- MeetingTimeZone makes no difference -->
         <typ:MeetingTimeZone TimeZoneName="W. Europe Standard Time"/>
         </typ:Recurrence>
         </typ:CalendarItem>
      </mes:Items>
   </mes:CreateItem>
</soapenv:Body>
</soapenv:Envelope> 
```

此代码实际上与David Sterling 等人的《 [Inside Microsoft Exchange Server 2007 Web Services 》一书的清单 9-29 相同](https://rads.stackoverflow.com/amzn/click/com/0735623929)

如果我为此事件查询 EWS，我会取回我创建的内容：

```
<t:CalendarItem>
   <t:ItemId Id="AQMkA[snip]PYb1"/>
   <t:Subject>Every 2 weeks sa/su, ends after 5</t:Subject>
   [snip]
   <t:Start>2013-01-19T10:00:00Z</t:Start>
   <t:End>2013-01-19T10:30:00Z</t:End>
   <t:CalendarItemType>RecurringMaster</t:CalendarItemType>
   <t:Recurrence>
      <t:WeeklyRecurrence>
         <t:Interval>2</t:Interval>
         <t:DaysOfWeek>Sunday Saturday</t:DaysOfWeek>
      </t:WeeklyRecurrence>
      <t:NumberedRecurrence>
         <t:StartDate>2013-01-19+01:00</t:StartDate>
         <t:NumberOfOccurrences>5</t:NumberOfOccurrences>
      </t:NumberedRecurrence>
   </t:Recurrence>
</t:CalendarItem> 
```

这是 Exchange server 2010 无服务包。
我尝试过的其他事情：

1）如果我在 Outlook 中编辑该神秘事件并告诉它也发生在星期五，它或多或少会正确更新：一个星期五额外发生（2 月 1 日），最后一个 2 月 16 日星期六事件下降，但我的交替坐/太阳事件仍然存在

2）在 EWS 中使用相同的代码，我创建了这个事件：
星期二星期四（开始日期 1 月 15 日）：很好
星期天星期二（开始日期 1 月 15 日）：错误（再次交替模式）
星期一星期六（开始日期 1 月 14 日）：很好

3) 在 Outlook 2003 中创建完全相同的事件，而不是通过 EWS。它显示得很好。然后查询 EWS，我得到完全相同的 SOAP 结果。

我担心的是：
我误解了重复参数还是所有 Outlook 版本都错了？后者似乎不太可能，但上面指出了这一点。

有人知道这里可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T11:24:16.063

我刚刚发现这是一个星期的第一天问题。

我的 Outlook 将星期一设置为一周的第一天。如果我在 Outlook 中创建双周周六日约会，则发生的情况与预期一致：

```
 m  t  w  t  f  s  s
 .  .  .  .  . 19 20
 .  .  .  .  .  .  .
 .  .  .  .  .  2  3
 .  .  .  .  .  .  .
 .  .  .  .  .  9  . 
```

现在我将 Outlook 设置为将星期日作为一周的第一天。然后我得到：

```
 s  m  t  w  t  f  s 
 .  .  .  .  .  . 19
 .  .  .  .  .  .  .
27  .  .  .  .  .  2
 .  .  .  .  .  .  .
10  .  .  .  .  . 16
 .  .  .  .  .  .  . 
```

这里的“推理”是：
- 本周有一个星期六/太阳出现的机会：1 月 19 日
- 跳跃两周
- 分配那周的下一个星期六/太阳
- 等等

当通过 SOAP 创建我的约会时，Exchange 服务器假定星期日为一周的开始，并从第二个示例创建事件。但是，当在 Outlook 中以星期一作为一周的开始显示时，我们得到：

```
 m  t  w  t  f  s  s
 .  .  .  .  . 19  .
 .  .  .  .  .  . 27
 .  .  .  .  .  2  .
 .  .  .  .  .  . 10
 .  .  .  .  . 16  . 
```

所以“所有”我要做的就是告诉 EWS 我将在星期一作为一周的第一天进行预约。
[无法在 WeeklyRecurrence 节点中设置](http://social.technet.microsoft.com/Forums/en-IE/exchangesvrdevelopment/thread/b890bb5c-794f-459f-8dae-4695b8b7fc6e)
看起来可以通过用户配置读取和设置。
这就引出了下一个问题：[如何在 Exchange Web 服务中读取整个日历用户配置？](https://stackoverflow.com/questions/14581721/how-can-i-read-the-entire-calendar-user-configuration-in-exchange-web-services)

# c# - RemoteCertificateNotAvailable - 身份验证期间未通过根证书

> ID：14523559
> 
> 赞同：2
> 
> 时间：2013-01-25T14:13:41.963
> 
> 标签：c#, java, certificate, tomcat7, trust

我目前在将 .Net 应用程序安装为 Windows 服务时遇到问题，该应用程序与在 Windows Server 2008 上运行的 Apache Tomcat 7 中运行的另一个用 Java 编写的应用程序通信。

.NET 应用程序作为 Windows 服务运行，并使用 TcpListener 和来自本地计算机个人存储的服务器证书进行保护（根证书和中间证书存在于本地计算机的适当证书存储中），它提供给 Java然后应该提供客户端证书以保护连接的应用程序。

此过程中使用的所有证书都是从我们公司的 CA 创建的，Java 应用程序将证书添加到它所引用的密钥库和信任库中。

当 Java 应用程序尝试打开与 .NET 服务的连接时，连接失败。

我们在 .Net 应用程序中打开了跟踪，它报告这是由于“远程服务器未提供证书。”。然后我们为 Apache Tomcat 服务打开 SSL 调试，它似乎进入了服务器（在本例中为 .Net Windows 服务）通过传递机器中的所有根证书从客户端请求证书的阶段信任存储，但是我添加的根证书没有出现在根证书列表中。

我可以在本地机器信任存储中看到证书，所以我不确定下一步该做什么。什么会阻止我们自己的根证书出现在 Java 应用程序的证书颁发机构列表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:51:11.280

我的一所大学在 Windows 事件日志中发现了一个条目，说受信任的根证书列表由于有许多可用的根证书而被截断。一旦我们删除了所有不需要的，它就起作用了。

更新：来自 Windows 事件日志的消息如下所示：

> 当请求客户端身份验证时，此服务器会向客户端发送受信任的证书颁发机构列表。客户端使用此列表来选择服务器信任的客户端证书。目前，该服务器信任的证书颁发机构太多，以至于列表变得太长。因此，此列表已被截断。这台机器的管理员应该审查信任的证书颁发机构进行客户端身份验证，并删除那些实际上不需要信任的证书颁发机构。

另请参阅：http: [//support.microsoft.com/kb/2801679](http://support.microsoft.com/kb/2801679)

# spring - Spring JMS 和 Websphere MQ

> ID：14523572
> 
> 赞同：6
> 
> 时间：2013-01-25T14:14:24.143
> 
> 标签：spring, ibm-mq, spring-jms

嗨，我是 Spring JMS 和 websphere MQ 的新手。谁能给我一步一步的过程或示例如何从 websphere MQ 接收消息并能够在控制台中打印该消息非常感谢您的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-24T23:31:52.900

这是一个使用 Spring MDP/Activation Spec for websphere MQ 的工作示例

mdp-listener.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"      
    "http://www.springframework.org/dtd/spring-beans.dtd">

     <bean id="messageListener" class="com.rohid.samples.SpringMdp" />  

     <bean class="org.springframework.jms.listener.endpoint.JmsMessageEndpointManager">
         <property name="activationSpec">
           <bean class="com.ibm.mq.connector.inbound.ActivationSpecImpl">
               <property name="destinationType" value="javax.jms.Queue"/>
               <property name="destination" value="QUEUE1"/>
               <property name="hostName" value="A.B.C"/>
                   <property name="queueManager" value="QM_"/>
               <property name="port" value="1414"/>
               <property name="channel" value="SYSTEM.ADMIN.SVNNN"/>
               <property name="transportType" value="CLIENT"/>
               <property name="userName" value="abc"/>
               <property name="password" value="jabc"/>
            </bean>
          </property>
          <property name="messageListener" ref="messageListener"/>
          <property name="resourceAdapter" ref="myResourceAdapterBean"/>
    </bean>

    <bean id="myResourceAdapterBean" class ="org.springframework.jca.support.ResourceAdapterFactoryBean">
      <property name="resourceAdapter">
        <bean class="com.ibm.mq.connector.ResourceAdapterImpl">
          <property name="maxConnections" value="50"/>
        </bean>
      </property>
      <property name="workManager">
         <bean class="org.springframework.jca.work.SimpleTaskWorkManager"/>
      </property>
     </bean>
</beans> 
```

web.xml

```
<context-param>
   <param-name>contextConfigLocation</param-name>
   <param-value>/WEB-INF/context/mdp-listener.xml</param-value>
 </context-param>

<listener>
       <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 
```

SpringMdp

```
 package com.rohid.samples;

  import javax.jms.JMSException;
  import javax.jms.Message;
  import javax.jms.MessageListener;
  import javax.jms.TextMessage;

  public class SpringMdp implements MessageListener {

     public void onMessage(Message message) {
        try {
           if(message instanceof TextMessage) {
              System.out.println(this + " : " + ((TextMessage) message).getText());
           }

        } catch (JMSException ex){
           throw new RuntimeException(ex);
        }
     }
  } 
```

'

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-03-26T18:35:52.213

我自己刚刚经历了这个。从[Spring Boot JMS Starter开始](https://spring.io/guides/gs/messaging-jms/)

添加一个提供 MQQueueConnectionFactory 的 bean

```
@Configuration
@EnableJms
public class MQConfiguration {
    @Bean
    public MQQueueConnectionFactory mqFactory()
    {
        MQQueueConnectionFactory    factory = null;
        try {
            factory     = new MQQueueConnectionFactory();
            factory.setHostName("localhost");
            factory.setPort(1414);
            factory.setQueueManager("QM.LOCAL");
            factory.setChannel("SYSTEM.DEF.SVRCONN");
            factory.setTransportType(JMSC.MQJMS_TP_CLIENT_MQ_TCPIP);
        }
        catch (JMSException e) {
            System.out.println(e);
        }
        return factory;
    }
} 
```

删除对 org.apache.activemq / activemq-broker 的依赖，以确保 activemq 不会偷偷进入。

添加对 com.ibm.mqjms.jar、com.ibm.mq.jmqi.jar、dhbcore.jar 的依赖

跑

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T14:19:41.650

这些是为 WMQ V5.3 编写的，但大部分仍然适用。发生变化的更多是关于 WMQ 管理员，而不是连接和配置。

[developerWorks：春季系列](http://www.ibm.com/developerworks/views/web/libraryview.jsp?search_by=The%20Spring%20series)

请确保在以后的帖子中包含 WMQ 服务器和客户端的版本，因为 Java/JMS 配置的细节不同。此外，请务必使用与您正在使用的 WMQ 客户端或服务器版本相匹配的文档版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T15:05:42.687

您可能还想考虑在 JMS 之上使用 Spring Integration；这里有一个使用 ActiveMQ 的示例[https://github.com/SpringSource/spring-integration-samples/tree/master/basic/jms](https://github.com/SpringSource/spring-integration-samples/tree/master/basic/jms) - 您只需更改 JMS 配置以使用 MQ。

从控制台读取的样本通过 JMS 发送消息，由消息驱动的适配器读取，然后写入控制台。

# java - Android：（java）对象的二维数组/包括自定义类/在eclipse中调试

> ID：14523573
> 
> 赞同：0
> 
> 时间：2013-01-25T14:14:40.163
> 
> 标签：java, android, debugging, multidimensional-array, import

我不知道我的问题是在将文件包含在类中、在类中还是在使用它们时。我有一个简单的课程：

```
public class Entry {
char ZNAK;
boolean volno;

Entry() {
    this.volno = true;
}

// setter
void setZNAK(char z) {
    this.ZNAK = z;
}

// getter
char znak() {return ZNAK; }
boolean volno() {return volno; }
} 
```

在我添加到我在 Eclipse 中的 src 文件夹中的包中的单独文件中。在下一个文件中，有

```
 public static Entry[][] matrix; 
```

并在方法中

```
matrix = new Entry[Height][Width]; 
```

并在循环中

```
for(int i = 0; i < Height; i++)
    { 
        for(int j = 0; j < Width; j++)
        { 
            matrix[i][j] = new Entry();
            matrix[i][j].setZNAK(Character.toUpperCase(/*character here*/));
        }
    } 
```

Eclipse 没有显示任何错误，但它崩溃了。第二个问题是我无法调试它，当我尝试出现类文件编辑器时。

> **找不到源** Jaf 文件 C:\Users..\Android\android-sdk\platforms\android-16\android.jar 没有源附件

和下面的一些[日志](https://dl.dropbox.com/u/20995054/android.log)。

# asp.net - 在 mod mono web 应用程序 bin 中 System.Web.dll 时服务暂时不可用

> ID：14523576
> 
> 赞同：1
> 
> 时间：2013-01-25T14:14:55.267
> 
> 标签：asp.net, assemblies, mod-mono

我正在将一个 asp.net Web 应用程序从运行 IIS 7.x 的 64 位 Windows 2008R2 服务器迁移到运行 apache 和 mod mono 的 debian 6.06 上。我收到以下错误：

> 错误 500：无法加载类型“System.Web.Configuration.HttpCapabilitiesProvider”

对于其他程序集，我遇到了相同的错误，例如，`System.DirectoryServices.AccountManagement`但我只是转到我的 .NET 目录并将该程序集复制到我的 bin 文件夹中，这使错误消失了。

这不适用于`System.Web.dll` **任何人都知道为什么？**

当我将 System.Web.dll 复制到 mod-mono 中的 bin 目录中时，出现以下错误：

> 服务暂时不可用
> 
> 由于维护停机或容量问题，服务器暂时无法满足您的请求。请稍后再试。

# javascript - 获取最外层 div 元素的 HTML（最高父级）

> ID：14523579
> 
> 赞同：0
> 
> 时间：2013-01-25T14:15:00.633
> 
> 标签：javascript, jquery, html

我有一个`div`动态获取的，它的结构如下。

```
 <div id="mainWrap">
            <div style="z-index: 1001; height: 407px; width: 328px; top: 150px; left: 601.5px;" id="com-TMRJDOR2KOET3X6JPV6XGU0FB7RGJ926" class="textBox contentBox">
               <div style="" class="editable"><p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, </p>
               </div>
            </div>

            <div style="z-index: 1002; height: 616px; width: 288px; top: 29px; left: 3.5px;" id="com-UPWTMKZ7OUTN8KG2JEK47LNPN5JO261H" class="textBox contentBox">
               <div style="" class="editable"><p>
            ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum</p>
              </div>
           </div>            
      </div> 
```

现在，我想删除我这样实现的所有孩子的 ID。

```
 var getContent = $('#mainWrap');
      var finalContent = getContent.clone().children().removeAttr('id');
      var saveContent  = finalContent.parent().html(); 
```

但是我得到了没有最外层 div 的内部 div 即`mainWrap`。我还希望 mainWrap div 在我得到的 html 中返回。

**这是我试图做的，在某种程度上起作用：**

```
 $.fn.getOuter = function(val){
      return $('<div class="temp">').append($('#'+val).clone()).html();
    }
    var htmlPage = $.fn.getOuter('mainWrap'); 
```

如果我这样做了，`alert(htmlPage)`我会得到全部内容。但是当我尝试使用它删除 id 属性时，`var content=$(htmlPage).children().removeAttr('id');`我没有得到正确的 HTML。我仍然只得到里面的孩子`mainWrap`。我不确定我错在哪里。任何帮助都是赞赏。
谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:17:20.937

问题是因为当您`.parent()`在最终内容中执行时，没有父元素，因为您已将元素克隆到内存中。相反，将它包装在另一个中`div`并获得`html()`它。我也稍微修改了逻辑，试试这个：

```
var $getContent = $('#mainWrap').clone();
$getContent.children().removeAttr('id');
var saveContent  = $getContent.wrap('<div></div>').parent().html(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:48:41.117

这是一个有效的简单示例（[JSFiddle](http://jsfiddle.net/x8wnA/)）：

```
<div id="id1">
    <span>some text</span>
    <div id="someid">some more text</div>
</div>

<textarea id="ta"></textarea>

var getContent = $('<div>').append($("#id1").clone());
getContent.find("*").removeAttr("id");
$("#ta").val( getContent.html() ); 
```

`div`您可以即时将克隆的元素附加到 a中。我使用`find("*")`因为`children()`只获得`getContent`. 我假设您想删除所有`id`属性，无论它们有多深。

# c++ - c++ 基类和派生类约束

> ID：14523583
> 
> 赞同：0
> 
> 时间：2013-01-25T14:15:14.603
> 
> 标签：c++

以下问题可能看起来像重复，但我在网站的其他任何地方都找不到确切的想法。

简要介绍：当我试图在我的班级中理解更复杂的继承组合时，提出了这个问题。

在我提出问题之前请注意 - 我不寻找一种“解决方案”，只是希望与您讨论该主题并获得更好的思考。

假设您有以下几行：

```
class C : public B 
{
    public : 
        C (const B& b) : B (b) {}
        B& operator*() {return *this;}
};

int main() {
    A* pA = new B();
    C& c = pA -> doIt();
    *c = *pA;
    c = *pA;
    return 1;
} 
```

这段代码并不完整，这就是全部目的——假设它确实符合并提取了这段代码中的约束。我仍然不会只是编写代码并要求您解释头顶的任何约束，而是添加我的 concreate 问题：

我们对以下行有什么限制：

```
C& c = pA -> doIt(); 
```

据我了解，上面的代码有一个凝视约束，即这些类的层次顺序：C 派生于 B，B 派生于 A（如果我错了，请纠正我..）

我试图在保持上面描述的层次结构的同时实际定义这些类，并且我不能让 doIt() 返回其派生类 C 的类型。我可以在 A 函数的原型中使用不完整的类型 C& 但是我无法返回 C 类型的对象。

提前谢谢你，SyndicatorBBB

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:27:27.260

试试这个：

```
class C;

struct A
{
    C & doIt();
};

struct B : A
{
  void operator=(A const &) { }
};

class C : public B
{
public :
    using B::operator=;
    C (const B & b) : B(b) {}
    B & operator*() { return *this; }
};

C & A::doIt()
{
    static B bimpl;
    static C cimpl(bimpl);
    return cimpl;
} 
```

请注意，隐式赋值运算符隐藏了基本版本，因此我们需要使用声明显式取消隐藏运算符`using`。

# opengl - 从clipspace.xyz 和（inv）投影矩阵计算clipspace.w

> ID：14523588
> 
> 赞同：6
> 
> 时间：2013-01-25T14:15:28.353
> 
> 标签：opengl, glsl, shader, direct3d

我正在使用对数深度算法，这导致 someFunc(clipspace.z) 被写入深度缓冲区*并且没有隐式透视除法*。

我正在做 RTT / 后处理，所以稍后在片段着色器中我想重新计算 eyespace.xyz，给定 ndc.xy（来自片段坐标）和 clipspace.z（来自存储在深度缓冲区中的值的 someFuncInv()） .

请注意，我没有clipspace.w，并且我存储的值不是clipspace.z/clipspace.w（就像使用固定函数深度时一样）-所以类似于...

```
float clip_z = ...; /* [-1 .. +1] */
vec2 ndc = vec2(FragCoord.xy / viewport * 2.0 - 1.0);
vec4 clipspace = InvProjMatrix * vec4(ndc, clip_z, 1.0));
clipspace /= clipspace.w; 
```

...在这里不起作用。

那么有没有办法从clipspace.xyz中计算clipspace.w，给定投影矩阵还是它的逆矩阵？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T21:24:46.097

```
clipspace.xy = FragCoord.xy / viewport * 2.0 - 1.0; 
```

这在命名上是错误的。“剪辑空间”是顶点着色器（或任何最后一个顶点处理阶段）输出的空间。剪辑空间和窗口空间之间是标准化设备坐标 (NDC) 空间。NDC 空间是剪辑空间除以剪辑空间 W 坐标：

```
vec3 ndcspace = clipspace.xyz / clipspace.w; 
```

所以第一步就是取我们的窗口空间坐标，得到NDC空间坐标。这很容易：

```
vec3 ndcspace = vec3(FragCoord.xy / viewport * 2.0 - 1.0, depth); 
```

现在，我将*假设*您的`depth`值是正确的 NDC 空间深度。我假设您从深度纹理中获取值，然后使用它渲染的深度范围近/远值将其映射到 [-1, 1] 范围。如果你没有，你应该。

那么，既然我们有了`ndcspace`，我们如何计算`clipspace`？嗯，这很明显：

```
vec4 clipspace = vec4(ndcspace * clipspace.w, clipspace.w); 
```

很明显而且......没有帮助，因为我们没有`clipspace.w`. 那么我们如何得到它呢？

为了得到这个，我们需要看看`clipspace`第一次是如何计算的：

```
vec4 clipspace = Proj * cameraspace; 
```

这意味着它`clipspace.w`是通过对 的第四行取`cameraspace`并点积来计算的`Proj`。

嗯，这不是很有帮助。如果我们实际查看第四行，它会更有帮助`Proj`。当然，您*可以*使用任何投影矩阵，如果您不使用典型的投影矩阵，则此计算会变得更加困难（可能是不可能的）。

的第四行`Proj`，使用典型的投影矩阵，实际上就是这样：

```
[0, 0, -1, 0] 
```

这意味着`clipspace.w`真的只是`-cameraspace.z`。这对我们有什么帮助？

记住这一点会有所帮助：

```
ndcspace.z = clipspace.z / clipspace.w;
ndcspace.z = clipspace.z / -cameraspace.z; 
```

嗯，这很好，但它只是用一个未知数换另一个未知数；我们仍然有一个包含两个未知数 (`clipspace.z`和`cameraspace.z`) 的方程。但是，我们确实知道其他事情：`clipspace.z`来自投影矩阵`cameraspace`的*第三*行的点积。传统投影矩阵的第三行是这样的：

```
[0, 0, T1, T2] 
```

其中 T1 和 T2 是非零数。我们暂时忽略这些数字。所以，`clipspace.z`真的只是`T1 * cameraspace.z + T2 * cameraspace.w`。如果我们知道`cameraspace.w`是 1.0（通常是这样），那么我们可以删除它：

```
ndcspace.z = (T1 * cameraspace.z + T2) / -cameraspace.z; 
```

所以，我们还是有问题。事实上，我们没有。为什么？因为在这个euqation中只有一个未知数。记住：*我们已经知道了`ndcspace.z`*。因此，我们可以使用 ndcspace.z 来计算`cameraspace.z`：

```
ndcspace.z = -T1 + (-T2 / cameraspace.z);
ndcspace.z + T1 = -T2 / cameraspace.z;
cameraspace.z = -T2 / (ndcspace.z + T1); 
```

`T1`并`T2`直接从我们的投影矩阵（场景最初渲染的那个）中出来。我们已经有了`ndcspace.z`。所以我们可以计算`cameraspace.z`。我们知道：

```
clispace.w = -cameraspace.z; 
```

因此，我们可以这样做：

```
vec4 clipspace = vec4(ndcspace * clipspace.w, clipspace.w); 
```

显然你需要一个浮点数`clipspace.w`而不是文字代码，但你明白我的意思。一旦你有`clipspace`, 得到相机空间，你乘以逆投影矩阵：

```
vec4 cameraspace = InvProj * clipspace; 
```

# android - Android 用户位置请求

> ID：14523594
> 
> 赞同：0
> 
> 时间：2013-01-25T14:15:57.557
> 
> 标签：android, gps, location

我正在开发一个基于 GPS/用户位置的应用程序。我称之为 MainController 的一项主要活动是管理片段（替换它们）并且还管理底部选项卡（激活选定的选项卡并停用其他选项卡）。在一个 FragmentList 类中，我需要按与用户的距离对对象进行排序并将它们传递给 ArrayAdapter。我现在需要的只是用户位置，但最重要的问题是如何请求用户位置，导航到另一个片段后，我可以更新这个位置，并在需要时将其传递给片段（或来自片段的请求） . 我需要使用服务吗？还有其他方法可以实现这一目标吗？我想过 Application 对象，但我不知道它是否真的可以请求用户位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:24:06.013

你调用[Location API's](http://developer.android.com/guide/topics/location/strategies.html) in`MainController`

至于与 Fragments 的通信，[文档非常清楚](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)如何做到这一点

# windows-phone-7 - 如何在 WP7 中为 RadSlideView 项目创建和运行动画？

> ID：14523596
> 
> 赞同：1
> 
> 时间：2013-01-25T14:16:30.273
> 
> 标签：windows-phone-7, windows-phone-7.1, windows-phone-8

我在 Telerik slideView 控件中有一个图像，在 AppBar 上有一个 Button。当点击 AppBar 按钮时，我会更改活动图像的图像源。一切正常，但我需要一个动画来更改图像源。我正在使用 MVVMlight。任何人都可以通过点击 appBar 按钮来帮助我处理动画图像外观。任何信息都会很有用。

```
<telerikPrimitives:RadSlideView 
   x:Name="slideView" 
   ItemsSource="{Binding Covers}" 
   SelectedItem="{Binding CurrentCover ,Mode=TwoWay}" 
ItemRealizationMode="ViewportItem" >
<telerikPrimitives:RadSlideView.ItemTemplate>
   <DataTemplate>
      <Image x:Name="DisplayImage" Source="{Binding FullCover}">/Image>                               
    </DataTemplate>
</telerikPrimitives:RadSlideView.ItemTemplate> 
```

# tomcat - 自动部署在 appBase 的子文件夹中找到的 WAR 文件

> ID：14523598
> 
> 赞同：3
> 
> 时间：2013-01-25T14:16:33.663
> 
> 标签：tomcat, war, autodeploy

我有一个第三方 Web 应用程序，我想通过安装程序将其部署到 Tomcat 5.0 服务器。AutoDeploy 设置为 true。但是，该应用程序包含多个 WAR 文件。

如果我将 WAR 直接放在 /webapps 下，它们就像一个魅力。但是，我想在 /webapps/myapp/.. 下展开它们，这里是展开的 WAR 目录......这样他们就不会自动部署。有人可以建议我需要配置什么才能使其工作吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-02-23T09:38:17.793

**知道这个问题已有多年了，现在在这里回答 Tomcat 8.5。**

您可以像这样更改 .war 的名称：`myapp#app1.war`

将此 .war 放入后`webapps`，Tomcat 将您的应用程序部署在 .war 中`webapps/myapp/app1`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T20:57:54.080

正如[这个](http://tomcat.apache.org/tomcat-5.5-doc/config/host.html#Automatic%20Application%20Deployment)页面所建议的，您可以将两个 XML 文件放入`$CATALINA_HOME/conf/[engine_name]/[host_name]`目录（例如`$CATALINA_HOME/conf/Catalina/localhost`）中，每个文件都为两个 WAR 之一定义一个[上下文](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)。

第一个（例如 app1context.xml）：

```
<Context path="/myapp/app1" docBase="${catalina.home}/webapps/myapp/app1war">

</Context> 
```

第二个（例如app2context.xml）：

```
<Context path="/myapp/app2" docBase="${catalina.home}/webapps/myapp/app2war">

</Context> 
```

# java - BO <=> Java 中的 DTO 映射器

> ID：14523601
> 
> 赞同：5
> 
> 时间：2013-01-25T14:16:42.983
> 
> 标签：java, reflection, dto, mapper

我目前正在我的应用程序中手动将 DTO 映射到 BO（反之亦然）。然而，这种方法既笨拙又笨拙。

这两种表示之间有什么好的映射器吗？

我的要求如下：

*   应支持将 JPA 代理转换为标识符（DTO 不应直接链接到其他 DTO）。或者这个功能应该很容易实现
*   应该基于注释，约定优于配置
*   软标准：应该允许将多个 DTO 映射到一个实体（反之亦然）

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T14:30:47.137

关于对象映射我会推荐

*   [spring 3 对象映射](http://static.springsource.org/spring/previews/mapping.html)
*   [模型映射器](http://modelmapper.org)
*   [推土机](http://dozer.sourceforge.net)
*   [奥里卡](http://code.google.com/p/orika)
*   [jDTO](https://github.com/jDTOBinder/jDTO-Binder)

另外，请参阅this SO answer。它有一个或多或少完整的 Java 对象映射器列表：[https ://stackoverflow.com/a/1432956/1137735](https://stackoverflow.com/a/1432956/1137735)

我建议的 3 似乎对我更有吸引力。我认为它们都满足您提出的要求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-21T08:47:25.963

好吧，我知道这个帖子有点老了，我很确定@miguelcobain 的答案很棒。

个人而言，我建议将[Orika](http://code.google.com/p/orika/)用于运行时系统。它很强大，并且在运行时使用字节码生成，因此映射由生成的代码处理，而不是总是使用反射 API。其他列出的库总是使用复杂的配置而不是约定。

我认为第二种解决方案和更好的解决方案是使用[Selma](http://xebia-france.github.io/selma/)。这个简短的库为您完成了这项工作，但它不是在运行时处理映射，而是在编译时使用注释处理器生成映射代码。因此编译器会引发映射错误，这是重构证明，您将能够看到生成的代码。

希望你试一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-15T15:57:38.817

我建议您尝试[JMapper 框架](https://code.google.com/p/jmapper-framework/)。
它是一个 java bean 到 java bean 的映射器，允许您使用注释和/或 XML 动态地执行数据传递。使用 JMapper，您可以：
创建和丰富目标对象
将特定逻辑应用于映射
自动管理 XML 文件
实现 1 到 N 和 N 到 1 关系
实现显式转换
应用继承的配置

# jquery - 覆盖 jQuery 验证 MVC4 中的默认设置

> ID：14523602
> 
> 赞同：3
> 
> 时间：2013-01-25T14:16:48.780
> 
> 标签：jquery, asp.net-mvc-4, jquery-validate, unobtrusive-validation

要覆盖 Query validate 插件，在[plaugsin 文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)中，推荐的方法是：

```
$(".selector").validate({
    invalidHandler: function(form, validator) {
      var errors = validator.numberOfInvalids();
      if (errors) {
        var message = errors == 1
          ? 'You missed 1 field. It has been highlighted'
          : 'You missed ' + errors + ' fields. They have been highlighted';
        $("div.error span").html(message);
        $("div.error").show();
      } else {
        $("div.error").hide();
      }
    }
}) 
```

但是，它不适用于带有 jquery-1.7.1.js 的 MVC4。似乎 jquery.validate.unobtrusive.js 阻止调用覆盖句柄。如果不包含此文件，则调用覆盖句柄并显示消息。有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:38:07.353

[我终于按照布鲁斯](http://forums.asp.net/t/1759887.aspx/1)的建议让它工作了。诀窍是在连接您的自定义处理程序之前删除旧处理程序。您可以以相同的方式覆盖其他设置。Microsoft 应该加快修复其 jquery.validate.unobtrusive.js 以与 jquery.validate 一起使用。据报道，[不显眼的 [version="2.0.20710.0"] 会破坏 jquery-1.9.0](http://connect.microsoft.com/VisualStudio/feedback/details/776965/please-support-jquery-v1-9-0-properly-in-jquery-validate-unobtrusive)。

```
$('form').each(function() {
    $(this).unbind("invalid-form.validate"); // remove old handler!!!!
    $(this).bind("invalid-form.validate", function(e, validator) {
        //alert("ok");
        var errors = validator.numberOfInvalids();
        if (errors) {
            var message = errors == 1
                ? 'You missed 1 field. It has been highlighted'
                : 'You missed ' + errors + ' fields.  They have been highlighted';
            $("div.error span").html(message);
            $("div.error").show();
        } else {
            $("div.error").hide();
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T15:24:03.083

这不起作用的原因是验证器已经由不显眼的插件创建，所以当你调用

```
$(".selector").validate({..}) 
```

您只需取回已经创建的验证器实例，您的选项不会被应用。但是我认为您可以通过这种方式更改设置。

```
<script>
    $(function () {  

        // get the validator instance
        var v = $('form').validate();

        // overwrite the invalidHandler with your own function
        v.settings.invalidHandler = function(form, validator) {
          // your stuff here
        };
    });
</script> 
```

请注意，这会覆盖“不显眼”的 invalidHandler 函数，因此您不会获得“不显眼”功能的那部分。

# mysql - 分类表选择语句

> ID：14523603
> 
> 赞同：0
> 
> 时间：2013-01-25T14:17:03.110
> 
> 标签：mysql, sql, database, select, classification

我正在开发一个足球联赛，其中球队是由计算机随机完成的。这个联盟对球员而不是球队进行排名。每个玩家得分取决于游戏的结果：

```
his team wins : player scores 3 point
his team wins >5 goals difference: player scores 4 points
his team draws: player scores 1 point
his team loses: player doesnt score 
```

为了存储联赛数据，我在 mySQL InnoDB 中创建了这些表：

```
game (id)
player (num, name)
team (game.id, player.num, type)
goals (time, team.id, team.num, team.type) 
```

type - 标识哪支球队是球员（CHAR“A”或“B”）

*   我想根据上述规则检索分类，我应该如何在 mySQL 中编写查询？
*   我避免存储可以计算的数据（良好做法），但我应该更改表结构吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:20:28.677

```
SUM(CASE WHEN a THEN 3
         WHEN b THEN 4
         WHEN c THEN 5
         WHEN d THEN 1
                ELSE 0 END) ttl 
```

# c# - 如何访问在 TFS 服务器上下文中运行时触发的事件的内容？

> ID：14523612
> 
> 赞同：0
> 
> 时间：2013-01-25T14:17:29.523
> 
> 标签：c#, delegates, event-handling

我为 TFS 2012 创建了一个自定义事件处理程序，每次“工作项”更改时都会触发一个事件。我遵循了各种示例，发现以下代码可在 TFS 2012 上运行：

```
public class WorkItemChangedEventHandler : ISubscriber
   {
        public Type[] SubscribedTypes()
          {
             return new[] { typeof(WorkItemChangedEvent) };
          }
          public EventNotificationStatus ProcessEvent(TeamFoundationRequestContext requestContext, NotificationType notificationType, object notificationEventArgs,
                                                      out int statusCode, out string statusMessage, out ExceptionPropertyCollection properties)
          {
             statusCode = 0;
             properties = null;
             statusMessage = String.Empty;
             try
             {
                if( notificationType == NotificationType.Notification && notificationEventArgs is WorkItemChangedEvent )
                {
                   var ev = notificationEventArgs as WorkItemChangedEvent;
                   EventLog.WriteEntry("WorkItemChangedEventHandler", "WorkItem " + ev.WorkItemTitle + " was modified");
                }
             }
             catch( Exception exception )
             {
                //must eat all exceptions or TFS will not load the plugin
             }
             return EventNotificationStatus.ActionPermitted;
          }
          public string Name
          {
             get { return "WorkItemChangedEventHandler"; }
          }
          public SubscriberPriority Priority
          {
             get { return SubscriberPriority.Normal; }
          }
       } 
```

因此，虽然此代码在 TFS 的 /plugins 目录中作为 .dll 安装时运行良好，但我仍然不知道如何从外部代码中获取事件的结果。

我想通过 TFS 服务器 API 可以使用某种订阅，它允许我使用自定义事件处理程序（订阅者）订阅在 TFS 上下文下运行的事件，但我已经尝试了一周没有运气，所以现在我'我向 SO 社区求饶。

我有一个服务，它连接到我们的帮助台 API 并读取错误票，然后我将其转换为序列化的本地列表结构，以便稍后在我想检查是否有任何更改时读取。然后我使用 TFS API 更新相应的工作项，以便一切都同步。

这部分应用程序一切正常，但问题是我还需要（由我们开发人员）对 TFS 所做的更改反映到帮助台错误跟踪器。因此，我认为使用 WorkItemChanged() 事件来执行此操作可以省去我在另一边所做的手动编码。

我需要知道工作项上的哪些字段已更改以使用新值更新 BugTracker。

有没有人知道如何实现这一目标？ **问题实际上归结为：** 如何从控制台或服务应用程序订阅由上述编写代码触发的事件？

帮助表示赞赏。

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T21:44:26.460

您听起来好像不是在寻找服务器端事件，而是在寻找 SOAP 事件，其中 TFS 将调用 URL 并发送包含所需数据的 SOAP 信封。

您可以创建一个 Web 服务并让 TFS 在发生特定类型的事件时调用它：

*   [处理 Team Foundation Server 事件](http://blog.hinshelwood.com/tfs-event-handler-in-net-3-5-part-2-handling-team-foundation-server-events/)

但是，如果您无法从 TFS 服务器连接到控制台应用程序（通常发生在本地应用程序在您的计算机上而不是在服务器上运行），您可以创建自己的使用双工服务的消息队列。

为此，您将在上面的事件处理程序代码中“托管”您自己的 Web 服务端点，并让您的客户端连接到该端点。我可以看到您可能会遇到许多与此相关的问题，但是如果您不想进行投票并且即使在本地盒子上也无法让 TFS 发射肥皂，那么您将别无选择。

# html - html页面底部的空白

> ID：14523613
> 
> 赞同：0
> 
> 时间：2013-01-25T14:17:29.590
> 
> 标签：html, css

当我制作我的 HTNL 页面时，它看起来很完美，但突然之间，我的页面底部出现了巨大的空白。你可以在[http://thomaswd.com/pearinc2](http://thomaswd.com/pearinc2)看到它。我该如何摆脱这个？！我的样式表位于[http://thomaswd.com/pearinc2/style.css](http://thomaswd.com/pearinc2/style.css)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:37:03.113

如果您查看带有类的 HTML 元素，`back-iphone4s`您会注意到它使用 CSS 相对定位。

如果您`position: relative`从 CSS 规则中删除该部分，`.back-iphone4s`您会注意到它出现在您的空白处。

像这样使用总是很糟糕，如果元素没有相对定位`position: relative`，空白就会出现在元素的*位置。*

我建议将其添加`position: relative`到 div`devices`作为其类，然后使用`position: absolute;`on`.back-iphone4s`并使用该方法设置它的位置。这样，`back-iphone4s`元素相对于它的父元素定位，而不是相对于它在正常文档流中的位置。

还有很多其他方法可以解决这个问题，乍一看，我很想把这两部 iPhone 变成一张图片，更少的 HTML，更少的 CSS 和更少的图片下载，但看起来你可能已经有意他们为了一个目的而分开，所以也许这不是一个可行的解决方案。

... 唷，希望这是有道理的，如果现在让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:21:57.013

### 给班级`height`一个：`.devices`

```
.devices {height: 520px;} 
```

* * *

![](../Images/c2ccd9f0ae4ed30118bf6a20660115c1.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:30:14.077

我只是快速浏览了一下你的风格，我所看到的在技术上非常难看。您使用 position:absolute 设置所有主要元素，并使它们独立于上下文和内容流。而且因为它们是绝对的，所以你必须给它们一个高度——这会导致像丑陋的空白这样的事情。我会说你对页面的样式/结构有错误的概念。

尝试使用“位置：绝对”非常罕见！

# php - 即时 SSL 检测

> ID：14523615
> 
> 赞同：-2
> 
> 时间：2013-01-25T14:17:32.280
> 
> 标签：php, .htaccess, ssl, permalinks

> **可能重复：**
> [使用 .htaccess 和 mod_rewrite 强制 SSL/https](https://stackoverflow.com/questions/4398951/force-ssl-https-using-htaccess-and-mod-rewrite)

在我的网站上，我计划使用多个域，有些可能有 SSL，有些可能没有。我想强制 SSL 使用它，而非强制使用它。这可能吗？我想我需要使用 PHP，但也许这可以在 .htaccess 中完成。有什么帮助吗？如果我让我的客户输入它怎么样，就像他们可以说他们希望他们的 url 以开头`https://www`或只是`http://`，有没有办法使用 php 创建永久重定向？抱歉，对于构建如此深入的 cms 的人来说，这是一个新奇的问题。另外，快速提问：就性能而言，创建我一直在使用的永久链接的 route-all-to-index.php 风格有什么缺点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:22:52.017

尝试这个：

```
if ($_SERVER["HTTPS"] != "on") {
  header("Location: https://" . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);
} 
```

# android - Android小部件，在小部件定位后显示选项列表

> ID：14523617
> 
> 赞同：1
> 
> 时间：2013-01-25T14:17:34.120
> 
> 标签：android, android-widget, widget, options

我的小部件必须根据所选城市显示不同的信息。所以我正在寻找一种正确的方法来在小部件放置在家里后显示列表。我正在尝试使用 onEnabled() 方法，但在我的设备 (Nexus 7) 上，当我点击小部件列表上的小部件而不是将其添加到主页后，会显示选项列表。感谢您的任何帮助或建议米歇尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:32:33.650

查看[本](http://developer.android.com/guide/topics/appwidgets/index.html)文档的**创建应用小部件配置活动**部分。

# c - 使用 sse 内在函数时如何打破循环？

> ID：14523621
> 
> 赞同：3
> 
> 时间：2013-01-25T14:17:51.557
> 
> 标签：c, x86, sse, simd

```
__m128* pSrc1 = (__m128*) string;
__m128 m0 = _mm_set_ps1(0);    //null character

while(1)
{
    __m128 result = __m128 _mm_cmpeq_ss(*pSrc1, m0);

    //if character is \0 then break

    //do some stuff here

    pSrc1++;
} 
```

我有一个长度可以是 16 的倍数的字符串。如果 _mm_cmpeq_ss 返回相等，我该如何跳出循环？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T14:55:25.183

如果您在第一次遇到 a 时试图跳出循环，`\0`那么您需要执行以下操作：

```
__m128i* pSrc1 = (__m128i *)string;         // init pointer to start of string
__m128i m0 = _mm_set1_epi8(0);              // vector of 16 `\0` characters

while (1)
{
    __m128i v0 = _mm_loadu_si128(pSrc1);    // get 16 chars from string
    __m128i v1 = _mm_cmpeq_epi8(v0, m0);    // compare all 16 chars with '\0'
    int vmask = _mm_movemask_epi8(v1);      // get 16 comparison result bits
    if (vmask != 0)                         // if any bit is 1
        break;                              // we found a `\0`, break out of loop
    pSrc1++;                                // next 16 characters...
} 
```

如果您只想测试`\0`某些位置的字符而忽略任何其他字符，那么您可以将`if (vmask != 0)`测试更改为符合您特定要求的内容。

# java - 如何通过类打印出值？

> ID：14523623
> 
> 赞同：-1
> 
> 时间：2013-01-25T14:17:56.433
> 
> 标签：java

我在打印输出时遇到问题。

类方法：

```
public class Account {
    private String name1;
    private String name2;
    private  double grade1;
    private  double grade2;
    private  double grade3;
    private  double average;
    public void setAccount(String a1 ,String a2 ,double b1,double b2,double b3) {

        a1=name1;
        a2=name2; 
        b1=grade1;
        b2=grade2;
        b3=grade3;
    }

    public void setaverage(double k1){
        k1=average;
    }

    public String getAccount(){
        return name1;
    }

    public String getAccount1(){
        return name2;
    }

    public double getAccount2(){
        return grade1;
    }

    public double getAccount3(){
        return grade2;
    }

    public double getAccount4(){
        return grade3;
    }

    public double getaverage(){
        return average=(grade1+grade2+grade3)/3;
    }
} 
```

主要方法：

```
 public static void main(String[] args) {
        Scanner in = new Scanner (System.in);

        Account account= new Account();

        System.out.println("Enter the  frist  and last name of student" );

        String na1=in.nextLine();

        account.getAccount(na1);

    } // end main

} // end class AccountTest 
```

我有问题`account.getAccount(na1);`

我试图打印一个字符串以了解程序是否有效。

那么如何打印输出呢？

我知道这个问题，因为 get 方法中没有参数，但我不知道如何打印它，因为这是我第一次使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:41:18.590

这里有很多问题，但别担心，我会告诉你。你可以做很多小事来让你和其他人更容易理解你的代码。封装起初似乎令人困惑，但我发现它很快就开始有意义了。首先在您的构造函数中，您正在向后执行分配。我认为您的老师让您对每个私有变量都使用“getters”和“setters”？

创建具有这些签名的方法：

```
public void setName1(string n1){...}//assigns n1 to name1

public void setName2(String n2){...} //assigns n2 to name2

public void setGrade1(double g1){...} //assigns g1 to grade1

public void setGrade2(double g2){...} //assigns g2 to grade2

public void setGrade3(double g3){...} //assigns gee I wonder. 
```

并在您的构造函数中使用它们：

```
public void setAccount(String n1 ,String n2 ,double g1,double g2,double g3) {

    setName1(n1);
    setName2(n2);
    setGrade1(g1);
    setGrade2(g2);
    setGrade3(g3);

} 
```

接下来，我建议您以类似的方式命名您的 get* 方法。

```
 public String getName1(){...}
 public String getName2(){...}
 public double getGrade1(){...} 
```

等等

最后，用于印刷。完成所有设置后，打印到控制台非常容易。

```
System.out.println(getName1()); //will print name1 to the console. 
```

通读代码并对其进行注释以解释（对自己）它在做什么。随着您的继续，它开始越来越像english/humanLanguageOfChoice！

我也是一名学生，所以如果任何真正的开发人员想要继续挖掘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:20:27.603

`getAccount`返回值，它不带任何参数。所以写这样的东西：

```
na1 = account.getAccount(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:43:59.997

所以...一些您应该知道和学习的术语...

1.  get 方法，所谓的 getter 有一个命名约定，第一部分是 get 第二部分是带有 camelCase 的变量的名称，所以在你的情况下，getter 应该是`getName1() getName2(), getGrade1(), getGrade2(), getGrade3()`等等......而不是 getAccount()，你欺骗自己和其他开发者如果您不使用此约定....
2.  set 方法，所谓的 setter 也具有相同的命名约定，在您的情况下，setter 应该是`setName1(), setName2(), setGrade1(), setGrade2(), setGrade3()`等等
3.  getter 应该从您的类中返回变量（值），setter 应该为您的实例成员（实例或类变量）“设置”一些值......
4.  从最后一点开始，它明确指出 getter 是 public getVariable（没有参数），例如`public String getName1()`，setter 是 public setVariable（将提供给实例变量的参数），例如`public setName1(String name1)`

在您的情况下，您没有设置并且没有给变量赋值，但是您想获得它的值，显然它将具有空值...清楚吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:22:31.250

该方法`getAccount(String input)`未在您的代码中实现。

这是：`account.getAccount()`。

# sql - PostgreSQL 错误：函数 to_tsvector（字符变化，未知）不存在

> ID：14523624
> 
> 赞同：8
> 
> 时间：2013-01-25T14:18:02.867
> 
> 标签：sql, postgresql, types, casting, full-text-search

这个 psql 会话片段应该是不言自明的：

```
psql (9.1.7)
Type "help" for help.
=> CREATE TABLE languages(language VARCHAR NOT NULL);
CREATE TABLE
=> INSERT INTO languages VALUES ('english'),('french'),('turkish');
INSERT 0 3
=> SELECT language, to_tsvector('english', 'hello world') FROM languages;
 language|     to_tsvector     
---------+---------------------
 english | 'hello':1 'world':2
 french  | 'hello':1 'world':2
 turkish | 'hello':1 'world':2
(3 rows)

=> SELECT language, to_tsvector(language, 'hello world') FROM languages;
ERROR:  function to_tsvector(character varying, unknown) does not exist
LINE 1: select language, to_tsvector(language, 'hello world')...
                         ^
HINT:  No function matches the given name and argument types.  
You might need to add explicit type casts. 
```

问题是 Postgres 函数`to_tsvector`不喜欢字段类型，但是[根据文档，](http://www.postgresql.org/docs/9.1/static/textsearch-tables.html#TEXTSEARCH-TABLES-INDEX)`varchar`这个调用应该是完全正确的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T15:09:28.383

使用显式类型转换：

```
SELECT language, to_tsvector(language**::regconfig**, 'hello world') FROM languages;
```

或将列更改`languages.language`为 type `regconfig`。[请参阅@Swav 的回答。](https://stackoverflow.com/a/21995741/939860)

### 为什么？

Postgres 允许[函数重载](https://www.postgresql.org/docs/current/static/xfunc-overload.html)。函数签名由它们的（可选的*模式*限定）*名称*加上（列表）*输入参数类型*定义。2 参数形式`to_tsvector()`期望类型[**`regconfig`**](https://www.postgresql.org/docs/current/static/datatype-oid.html)作为第一个参数：

```
SELECT proname, pg_get_function_arguments(oid)
FROM   pg_catalog.pg_proc
WHERE  proname = 'to_tsvector'

   proname   | pg_get_function_arguments
-------------+---------------------------
 to_tsvector | text
 to_tsvector | regconfig, text             -- you are here 
```

如果没有现有函数*完全*匹配，则[函数类型解析](https://www.postgresql.org/docs/current/static/typeconv-func.html)的规则决定最佳匹配 - 如果有的话。这是成功的 `to_tsvector('english', 'hello world')`，因为`'english'`它是一个**无类型的字符串文字**。但是使用**typed`varchar`**参数失败，因为没有注册的*隐式*转换from `varchar`to `regconfig`。[手册](https://www.postgresql.org/docs/current/static/typeconv-func.html)：

> 丢弃输入类型不匹配且无法转换（使用**隐式**转换）以匹配的候选函数。为此，**未知文字被假定为可转换为任何内容。**

大胆强调我的。
注册演员表`regconfig`：

```
SELECT castsource::regtype, casttarget::regtype, castcontext
FROM   pg_catalog.pg_cast
WHERE  casttarget = 'regconfig'::regtype;

 castsource | casttarget | castcontext
------------+------------+-------------
 oid        | regconfig  | i
 bigint     | regconfig  | i
 smallint   | regconfig  | i
 integer    | regconfig  | i 
```

[解释`castcontext`](https://www.postgresql.org/docs/current/static/catalog-pg-cast.html)：

> `castcontext char`
> 指示可以在哪些上下文中调用强制转换。`e`仅表示作为显式强制转换（使用`CAST`或`::`语法）。`a` 意味着隐含地分配给目标列，以及显式地。`i`隐含在表达式中，以及其他情况。

[在 CREATE CAST 一章中](https://www.postgresql.org/docs/current/static/sql-createcast.html)阅读有关三种不同*类型分配* 的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-24T18:16:16.520

### Erwin Brandstetter 答案的替代方法

您可以将语言列定义为 regconfig 类型，这将使​​您的查询不那么冗长，即：

```
CREATE TABLE languages(language regconfig NOT NULL DEFAULT 'english'::regconfig) 
```

我在上面将英语设置为默认值，但这不是必需的。之后您的原始查询

```
SELECT language, to_tsvector(language, 'hello world') FROM languages; 
```

会工作得很好。

# c# - c#在TcpClient类中发送特定数据

> ID：14523625
> 
> 赞同：0
> 
> 时间：2013-01-25T14:18:04.893
> 
> 标签：c#, mobile, tcpclient, tcpserver

我有一个 TCP 服务器软件并通过

```
TcpClient NewClient = TCPListener.AcceptTcpClient(); 
```

线。我还有一个包含安全客户端 IP 的字符串列表。如果一个未知的客户想要进入系统，我拒绝它

```
NewClient.Close(); 
```

线。这对于静态 IP 设备来说不是问题。问题开始于移动设备。移动设备的每个连接可能有不同的 IP，所以当我接受它时，我应该尽快检查它的 imei 号码。有没有我可以立即到达以检查imei号码的字段？我还设计了移动软件，所以当我连接到服务器时，我想通过 TcpClient 类传递手机的 imei 号码。

可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:20:37.313

> 有没有我可以立即到达以检查imei号码的字段？

不，IMEI 根本不是 TCP/IP 的一个概念。如果您需要知道 IMEI 号码，则需要其他方法来获取它。您没有说明客户端上运行的内容 - 如果它是自定义应用程序，那么您可能会在应用程序中找到 IMEI 并将其包含在数据中。当然，任何程序都可以发送任何数据，因此您可能需要某种方式对 IMEI 进行签名或加密，以便您知道可以在服务器端信任它……

# java - 超过 FileSizeMax 时取消 FileUpload

> ID：14523632
> 
> 赞同：0
> 
> 时间：2013-01-25T14:18:41.520
> 
> 标签：java, jsf, file-upload, apache-commons, apache-commons-fileupload

我有一个在 JBoss 6.1 中运行的 JSF 应用程序，它使用内部的 Tomcat Servlet 容器。

我已经实现了使用 apache commons 文件上传的上传。我想防止上传过大的文件，并 `fileSizeMax`在类中将属性设置为 10MB `FileUploadBase`。`FileSizeLimitExceededException`它有效，文件上传会为所有大于 10MB的文件抛出一个。此异常会在不到一秒的时间内引发。但主要问题是，整个文件将通过网络传输。我通过检查网络流量发现了这一点。之后重定向到错误页面完成。

当超过最大大小而不传输整个文件时，如何中断文件传输？我假设由于 web 表单属性，文件将在多个包中传输`enctype ="multipart/form-data"`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T14:36:35.003

您不能中途终止 HTTP 请求。如果您这样做了，您将无法返回 HTTP 响应，并且客户端最终将没有任何形式的反馈，可能会出现特定于浏览器的“对等连接重置”错误页面。

最好的办法是事先在 JavaScript 中验证它。顺便说一句，这仅在[支持 HTML5 `File`API](http://caniuse.com/#feat=fileapi)的浏览器中有效。你没有告诉任何关于你正在使用哪个 JSF 文件上传组件的信息，所以我觉得你只是自制了一个，所以我将给出一个适用于呈现的 HTML 的通用答案`<input type="file">`（请注意，它工作得很好例如[战斧的`<t:inputFileUpload>`](https://stackoverflow.com/questions/5418292/jsf-2-0-file-upload/5424229#5424229)）：

```
<input type="file" ... onchange="checkFileSize(this)" /> 
```

像这样的东西

```
function checkFileSize(inputFile) {
    var max = 10 * 1024 * 1024; // 10MB

    if (inputFile.files && inputFile.files[0].size > max) {
        alert("File too large."); // Do your thing to handle the error.
        inputFile.value = null; // Clears the field.
    }
} 
```

如果较旧的浏览器不支持此功能，那么您就迷路了。您最好的选择是 Flash 或 Applet。

# vb.net - 我应该公开异步方法吗？

> ID：14523635
> 
> 赞同：1
> 
> 时间：2013-01-25T14:19:07.940
> 
> 标签：vb.net, async-await

我正在开发一个包含 RESTful Web 服务的类库（供其他开发人员使用）。我正在使用命名空间中的`HttpClient`类型来`System.Net.Http`异步执行我的所有 API 调用。

除了简单地发送/接收内容之外，我还想对返回的 XML 数据进行额外的处理。不管你怎么说，这涉及到在类库的某个地方使用 Async/Await 关键字。

我的问题是公开使用 Async 关键字的方法是好主意还是坏主意，以及为什么。我在某处读到您应该将 Async 方法设为私有，然后仅使用 return 语句创建一个附加方法。这就是我一直在做的，但感觉不对。

```
Public Function InvokeAsync(command As HttpRequestMessage) As Task(Of CommandResult)
    Return InvokeAsyncInternal(command)
End Function

Private Async Function InvokeAsyncInternal(command As HttpRequestMessage) As Task(Of CommandResult)
    Dim rawCommandResult As HttpResponseMessage = Await myHttpClient.SendAsync(command)
    Dim finalResult As CommandResult = AdditionalProcessing(rawCommandResult)
    Return finalResult
End Function 
```

请记住，这是一个过于简化的代码示例：是否有任何好的论据不直接公开 Async 方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:39:10.887

这与编译器转换有关；您可以将“真正的”`Async`方法与其对应的方法分开，并且您将获得与对迭代器（ ）方法`Public`进行相同类型的分离时相同的好处。`Yield`

特别是，从包装器抛出的异常与从`Async`方法抛出的异常处理方式不同。当`Async`返回的方法`Task`抛出一个`Exception`时，它被放置在返回`Task`而不是直接抛出给调用者。当`Public`包装方法（不是`Async`）抛出一个`Exception`时，它会直接抛出给调用者。

因此，可以在`Public`方法中放入前置条件式检查。调用者可以忽略`Task`s 上的异常，但不能忽略直接抛出的异常。将前置条件异常放在`Public`包装器中会强制调用者意识到他们正在滥用 API，并且还允许将使用异常（直接抛出）与运行时异常（放置在`Task`.

如果您的方法没有先决条件，那么您的`Public`包装器只是返回内部`Task`. 在这种情况下，`Public`包装器是不必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:10:52.107

考虑以下场景：

```
void Caller()
{
    var t = AsyncThatThrows(null);
    // ...
    Task.WaitAny(t, t2); // <-- exception thrown here
}

Task AsyncThatThrows(Object o)
{
    if (o == null)
        throw new ArgumentNullException("o");

    // ...
    await // ...
    // ...
} 
```

请注意，异常是在第一次等待*之前引发的，但仅在检查任务时才会重新引发异常。*无论是通过等待它还是通过获取它的结果。如果您选择通过以下方式实现它：

```
void Caller()
{
    var t = AsyncThatThrows(null);// <-- exception thrown here
    // ...
    Task.WaitAny(t, t2);
}

Task AsyncThatThrows(Object o)
{
    if (o == null)
        throw new ArgumentNullException("o");

    return AsyncThatThrows_Impl(o);
}

Task AsyncThatThrows_Impl(Object o)
{
    // ...
    await // ...
    // ...
} 
```

现在可以*在调用*时捕获异常，您不必检查任务。在前一种情况下，即使我们还没有开始异步部分，异常仍然会存储在结果任务中。

# android - SECURITY_ERR：openDatabase 上的 DOM 异常 18

> ID：14523636
> 
> 赞同：9
> 
> 时间：2013-01-25T14:19:08.410
> 
> 标签：android, html, web-sql, opendatabase

我有一个基于 Web 的 Android 应用程序，它使用 WebSQL 进行存储。出于某种原因，在某一点调用`openDatabase`（响应按钮单击）会导致`DOMException`带有消息的 a `"SECURITY_ERR: DOM Exception 18"`。

请注意，我没有使用 PhoneGap。

**我在这里问的主要问题是**： DOMException 18 on 的可能原因是什么`openDatabase`？

**更多细节**：仅当数据库尚不存在时才会发生此异常。如果它已经存在，它将按预期工作。进行调用的函数`openDatabase`在应用程序的另一部分中使用并且工作正常。

**到目前为止我已经尝试过**：

*   减少数据库的大小 - 应该不是问题，因为它是由应用程序的另一部分创建的。
*   我已经检查了外部存储权限 - 再次，应该不是问题。
*   我在某处读到插入的 USB 电缆可能会导致此问题 - 在这种情况下不是导致它的原因。

**编辑：** 这是命令的样子：

```
db = openDatabase('my_database', '1.0', 'My database description', 5*1024*1024, function() {}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T05:38:06.120

我发现它与数据库的允许大小有关。如果您尝试在 iOS 上打开大于 50mb 的数据库，则会收到此错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T05:17:37.990

根据规范[规范](http://www.w3.org/TR/webdatabase/#dom-opendatabase)，它仅由两个原因引起

*   如果请求违反策略决定（例如，如果用户代理配置为不允许页面打开数据库），用户代理可能会引发 SECURITY_ERR 异常而不是返回数据库对象。

*   如果 origin 不是方案/主机/端口元组，则抛出 SECURITY_ERR 异常

# c - 无法理解关于 linux 中函数调用的简单 c 代码的输出

> ID：14523637
> 
> 赞同：3
> 
> 时间：2013-01-25T14:19:12.183
> 
> 标签：c, linux, gcc, compiler-construction

当我尝试理解函数调用时，我编写了一个简单的代码。但我无法理解它的输出。

```
#include <stdio.h>

int* foo(int n)
{
    int *p = &n;
    return p;
}

int f(int m)
{
    int n = 1;
    return 999;
}

int main(int argc, char *argv[])
{
    int num = 1;
    int *p = foo(num);
    int q = f(999);
    printf("[%d]\n[%d]\n", *p, q);
    /* printf("[%d]\n", *q); */
} 
```

输出：

```
[999]
[999] 
```

为什么`*p`是999？

然后我修改了我的代码如下：

```
#include <stdio.h>

int* foo(int n)
{
    int *p = &n;
    return p;
}

int f()
{
    int n = 1;
    return 999;
}

int main(int argc, char *argv[])
{
    int num = 1;
    int *p = foo(num);
    int q = f();
    printf("[%d]\n[%d]\n", *p, q);
    /* printf("[%d]\n", *q); */
} 
```

输出：

```
[1]
[999] 
```

为什么`*p`1在这里？我在 Linux 中，使用 gcc 但 Clang 得到了相同的输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:59:42.307

除了您的代码会因为您返回一个指向堆栈变量的指针而引发未定义行为这一事实之外，您还在询问为什么行为会随着更改 f() 的签名而改变。

**之所以**

原因在于编译器为函数构建堆栈帧的方式。假设编译器正在为 foo() 构建堆栈帧，如下所示：

```
Address Contents  
0x199   local variable p
0x200   Saved register A that gets overwritten in this function
0x201   parameter n
0x202   return value
0x203   return address 
```

对于 f(int m)，堆栈看起来很相似：

```
Address Contents  
0x199   local variable n
0x200   Saved register A that gets overwritten in this function
0x201   parameter m
0x202   return value
0x203   return address 
```

现在，如果你在 foo 中返回一个指向 'n' 的指针会发生什么？结果指针将为 0x201。返回 foo 后，堆栈的顶部位于 0x204。内存保持不变，您仍然可以读取值“1”。这一直有效，直到调用另一个函数（在您的情况下为“f”）。调用 f 后，位置 0x201 被参数 m 的值覆盖。

如果您访问此位置（并且您使用 printf 语句），它会显示“999”。如果您在调用 f() 之前复制了此位置的值，您将找到值“1”。

继续我们的示例，f() 的堆栈帧看起来像这样，因为没有指定参数：

```
Address Contents  
0x200   local variable n
0x201   Saved register A that gets overwritten in this function
0x202   return value
0x203   return address 
```

当您使用“1”初始化局部变量时，您可以在调用 f() 后在位置 0x200 处读取“1”。如果您现在从位置 0x201 读取值，您将获得已保存寄存器的内容。

**一些进一步的陈述**

*   重要的是要理解上述解释是向您展示观察所见所闻的方法论。
*   真正的行为取决于您使用的工具链和所谓的调用 convections。
*   人们很容易想象，有时很难预测会发生什么。这是一个与释放内存后访问内存类似的安静情况。这就是为什么通常无法预测会发生什么的原因。
*   这种行为甚至可以随着优化级别的改变而改变。例如，我可以想象，如果您打开 -O3 例如，观察结果会有所不同，因为未使用的变量 n 将不再出现在二进制文件中。
*   了解了背后的机制之后，应该可以理解为什么对从 foo 检索到的地址进行写访问会导致严重问题。

**对于试图通过实验证明这一解释的勇敢者**

首先，重要的是要看到上面的解释不依赖于真正的堆栈框架布局。我只是介绍了布局，以便有一个易于理解的插图。

如果您想在自己的机器上测试行为，我建议您使用您最喜欢的调试器并查看放置局部变量和参数的地址，以了解实际情况。请记住：更改 f 的签名会更改放置在堆栈上的信息。因此，唯一真正的“便携式”测试是更改 f() 的参数并观察 p 指向的值的输出。

在调用 f(void) 的情况下，放入堆栈的信息有很大不同，写入 p 指向的位置的值不再一定取决于参数或局部变量。它还可以依赖于主函数中的堆栈变量。

例如，在我的机器上，复制显示您在第二个变体中读取的“1”来自将用于存储“1”的寄存器保存到“num”，因为它似乎用于加载 n。

我希望这能给你一些见解。如果您还有其他问题，请发表评论。（我知道这理解起来有点奇怪）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:20:53.227

您正在调用未定义的行为。您不能返回局部变量的地址（在本例中为参数`int n`）并期望它以后有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T14:24:19.597

一个局部变量，就像`n`你的代码一样：

```
int* foo(int n)
{
    int *p = &n;
    return p;
} 
```

`foo`功能完成后立即“消失” 。

您不能使用它，因为访问该变量可能会给您带来不可预知的结果。不过，你可以写这样的东西：

```
int* foo(int* n)
{
    *n = 999;
    return p;
}

int main(int argc, char *argv[])
{
    int num = 1;
    int *p = foo(&num);
    printf("[%d]\n", *p);
} 
```

因为您的变量`num`在打印时仍然存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:53:28.877

没有汇编器输出并不容易，但这是我的猜测：

局部变量和参数存储在堆栈中。所以调用`foo`的时候会返回第一个参数的地址，这个地址在栈上。

在第一个示例中，您将一个参数传递给您的第二个函数，该函数也将被推送到堆栈中，确切地说是`p`指向的位置。因此它会覆盖 的值`*p`。

在第二个示例中，在第二次调用中未触及堆栈。旧值 (of `num`) 仍然存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T14:32:36.483

在你的第一个样本中，当你这样做时

```
int num = 1;
int *p = foo(num); 
```

`foo()`在哪里

```
int* foo(int n)
{
    int *p = &n;
    return p;
} 
```

当变量`num`from`main()`被传递时，它按值传递给`foo`。换句话说，在堆栈上创建了一个`num`名为的变量的副本。`n`两者`num`和`n`具有相同的值，但它们是不同的变量，因此将具有不同的地址。

当您从 中返回`p`时`foo()`，将获取与delared in`main()`的地址不同的地址的值`num``main()`

相同的解释适用于您修改后的程序。

让我们看另一个例子来澄清：

```
int i = 2;

int * foo()
{
return &i;
}

int main() {

i = 1;
int *p = foo();
return 0;

} 
```

在这种情况下，`i`在堆上声明，并且在和`i`中都引用了相同的内容。相同的地址和相同的值。`main()``foo()`

让我们看第三个例子：

```
int i = 2;

int * foo(int i)
{
return &i;
}

int main() {

int i = 1;
int *p = foo(i);
return 0;

} 
```

在这里，即使有一个 global `i`，它也被局部变量`i`in隐藏了`main()`，这就是传递给`foo()`. 因此，`&i`从 的返回`foo`，即`p`in的值`main()`，将与我在 main() 中声明的变量的地址不同。

希望这可以澄清变量范围和按值传递，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T16:34:21.400

这种未定义的行为是由于堆栈的参与

```
int *p = foo(num);
int q = f(999); 
```

在第一种情况下，当您说 时`&num`，它实际上将地址存储在`num`存储的堆栈中。然后 foo(num) 完成其执行，f(999) 使用参数 999 开始动作。由于使用了相同的堆栈，因此堆栈中存储 num 的相同位置现在具有参数 999。我们知道堆栈是连续的.

这就是两者印刷的原因`999`。实际上两者都试图打印堆栈中相同位置的内容。

而在第二种情况下， num 不会被覆盖，因为没有参数传递给 f() 所以，这会按预期打印。

# java - 线程在 android 2.3.(5-7) 中看不到由其他线程填充的 ConcurentHashMap 元素

> ID：14523654
> 
> 赞同：2
> 
> 时间：2013-01-25T14:20:06.543
> 
> 标签：java, android, opengl-es-1.1

我有地图：

```
public Map bitmaps = new ConcurrentHashMap();
```

一个用于解码资源的线程，通过以下方式填充位图：

```
bitmaps.put (resource, BitmapFactory.decodeStream (input, null, options));
```

第二个本机线程将解码的资源绑定到 opengl 纹理：

```
    公共无效 onDrawFrame (GL10 gl)
    {
        如果（位图大小（）> 0）
        {

```

所以第一个线程解码和第二个线程绑定。这种模式在 android 2.3.3、2.3.4 和 4.xx 上运行良好。

但是对于 android 2.3.5 或 2.3.6 **，bitmaps.size() 中的第二个线程（必须与第一个线程的填充位图一起使用）总是返回 0，而第一个线程（填充位图）同时返回更多通过调用 bitmaps.size() 大于 0。**

那么为什么在这个版本的 android os 中一个线程看不到其他线程填充的元素呢？

# view - Domino Designer：根据配置文件值创建视图

> ID：14523655
> 
> 赞同：1
> 
> 时间：2013-01-25T14:20:13.747
> 
> 标签：view, lotus-domino

在 Notes 应用程序中，我有一个（全局）配置文件表单（只有一个实例）。在本文档中，有一个字段包含不同的时事通讯，它们存储为以逗号分隔的单个字符串。

另一方面，我有一个客户表格。每个客户都可以通过对话列表提名其中一些时事通讯。
选择背后的代码：
`@Explode(@GetProfileField( "Profile_form";"newsletter");",")`

我想建立一个视图，其中每个时事通讯都是包含指定客户的类别。

我实际上不知道该怎么做。我对 Domino 编程很陌生。
我试图显示如下结构：

```
---------- **Profile_form** --------------  
(...)  
 newsletter = "Hardware, Software"  
(...)  
------------------------------------------- 
```

（只有一个例子！）

* * *

```
---------- **Customer_form** --------------------     
name = John  
lastname = Smith  
company = Example Corporation  
newsletter_nomination = [Hardware; Software]   
----------------------------------------------------- 
```

（每个客户一个实例）

* * *

```
---------- **Newsletter_view** --------------------     
Hardware  
+---- John Smith Example Corporation  
+---- Lucy Potter Another Corporation  
Software  
+---- John Smith Example Corporation  
(...)  
----------------------------------------------------- . 
```

首先，如果您能告诉我如何在我的视图中将每个时事通讯列为条目，这对我将非常有帮助。如果我只是通过字段选项选择“时事通讯”，我的视图中不会出现任何条目。

我希望你能帮帮我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:43:17.330

@GetProfileField 在视图中不起作用。

来自 @GetProfileField 的 Notes Designer 帮助：

> 此功能在列、隐藏时间、部分编辑器或视图选择公式中不起作用。您可以在工具栏按钮或代理中使用它。

*   您可以更改应用程序以使用常规 Notes 文档来存储这些信息，并且这些信息可以显示在视图中。
*   如果由于对配置文件的依赖而过于复杂，您可以编写一个脚本来创建反映配置文件文档的文档。然后这些可以显示在视图中。

我不确定您的应用程序中的客户档案是否是 Notes Profile 文档。如果我理解正确，我认为这些应该是常规文档，并且可以显示在视图中。如果该假设正确，您可以创建一个视图，该视图显示具有 4 列的客户资料：

1.  第 1 列：客户表单的 newsletter_nomination 字段作为分类列
2.  第 2 列：姓氏（平列）
3.  第 3 列：名称（平列）
4.  第4栏：公司（平栏）

希望有帮助。

# jquery - jQuery UI .sortable 非常跳跃

> ID：14523671
> 
> 赞同：0
> 
> 时间：2013-01-25T14:21:11.790
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我正在使用嵌套的 sortables 来创建 UI 编辑器。我猜基本上类似于portlet。用户拿起小部件或小部件支架并可以在屏幕上移动它们，然后保存。他们真的很神经质，不喜欢粘在某些地方。似乎他们更喜欢自上而下地被拖。我尝试向支架和小部件添加填充，但似乎并没有让它变得更好。有谁知道使这种废话更准确的真正好方法？我已经尝试了几乎所有我能找到的东西......我理解这个问题（大部分），我只是想不出一个解决办法。一个问题是当它捕捉到一个点时，某些东西会移动，有时会发生什么移动会使布局发生巨大变化，并且占位符来回跳跃以试图解决。我不明白为什么我不能

```
 $(".widget_holder").sortable({
        distance: 30,
        revert: true,
        items: ".widget",
        opacity: .8,
        scroll: true, 
        scrollSensitivity: 100, 
        scrollSpeed: 100,
        handle: ".move_widget",
        dropOnEmpty: true,
        tolerance: "pointer",
        cursorAt: { top:0, left: 0 },
        start: function(e, ui){
        $(".widget_holder", ui.item).hide();
        $('.widget').addClass("drag_padding");
        $(".widget_holder" ).addClass("holder_hover").addClass("drag_padding").sortable("refresh");
        },
        update: function(e, ui){
        if(this === ui.item.parent()[0]) {
        updateByHolder();
        }
        },
        stop: function(e, ui){
        $(".widget_holder", ui.item).show();
        $('.widget').removeClass("drag_padding");
        $(".widget_holder" ).removeClass("holder_hover").removeClass("drag_padding");
        }
   }).sortable(
       "option", "connectWith", '.widget_holder' 
    ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:31:43.803

尝试摆脱`tolerance: "pointer",`它或将其替换为`tolerance: "intersect",`

拥有`pointer`，因为这些`tolerance`选项会使整个列表非常跳跃！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-08T18:32:08.853

对`overflow: auto;`父级（ul、#element_id 等）呢？

# javascript - 您可以在创建时将参数传递给 AngularJS 控制器吗？

> ID：14523679
> 
> 赞同：282
> 
> 时间：2013-01-25T14:21:28.927
> 
> 标签：javascript, angularjs

我有一个控制器负责与 API 通信以更新用户、姓名、电子邮件等的属性。每个用户都有一个`'id'`在查看个人资料页面时从服务器传递的。

我想将此值传递给 AngularJS 控制器，以便它知道当前用户的 API 入口点是什么。我试过将值传递给`ng-controller`. 例如：

```
function UserCtrl(id, $scope, $filter) {

$scope.connection = $resource('api.com/user/' + id) 
```

并在 HTML

```
<body ng-controller="UserCtrl({% id %})"> 
```

在哪里`{% id %}`打印从服务器发送的 id。但我得到错误。

在创建控制器时将值传递给控制器​​的正确方法是什么？

* * *

## 回答 #1

> 赞同：366
> 
> 时间：2013-01-25T22:56:53.043

**笔记：**

这个答案很旧。这只是关于如何实现预期结果的概念证明。但是，根据下面的一些评论，它可能不是最佳解决方案。我没有任何文件支持或拒绝以下方法。请参阅下面的一些评论，以进一步讨论该主题。

**原答案：**

我回答说是的，你绝对可以使用`ng-init`一个简单的 init 函数来做到这一点。

这是[plunker上的示例](http://plnkr.co/edit/jDOgjENkqEaucBX9Tvc9)

**HTML**

```
<!DOCTYPE html>
<html ng-app="angularjs-starter">
  <head lang="en">
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.min.js"></script>
    <script src="app.js"></script>
  </head>  
  <body ng-controller="MainCtrl" ng-init="init('James Bond','007')">
    <h1>I am  {{name}} {{id}}</h1>
  </body>
</html> 
```

**JavaScript**

```
var app = angular.module('angularjs-starter', []);

app.controller('MainCtrl', function($scope) {

  $scope.init = function(name, id)
  {
    //This function is sort of private constructor for controller
    $scope.id = id;
    $scope.name = name; 
    //Based on passed argument you can make a call to resource
    //and initialize more objects
    //$resource.getMeBond(007)
  };

}); 
```

* * *

## 回答 #2

> 赞同：147
> 
> 时间：2014-05-12T15:13:43.520

我已经很晚了，我不知道这是否是一个好主意，但是您可以`$attrs`在控制器函数中包含可注入的内容，从而允许使用元素上提供的“参数”来初始化控制器，*例如*

```
app.controller('modelController', function($scope, $attrs) {
    if (!$attrs.model) throw new Error("No model for modelController");

    // Initialize $scope using the value of the model attribute, e.g.,
    $scope.url = "http://example.com/fetch?model="+$attrs.model;
})

<div ng-controller="modelController" model="foobar">
  <a href="{{url}}">Click here</a>
</div> 
```

同样，不知道这是否是一个好主意，但它似乎有效并且是另一种选择。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2014-03-15T13:46:53.417

这也有效。

Javascript：

```
var app = angular.module('angularApp', []);

app.controller('MainCtrl', function($scope, name, id) {
    $scope.id = id;
    $scope.name = name;
    // and more init
}); 
```

html:

```
<!DOCTYPE html>
<html ng-app="angularApp">
  <head lang="en">
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.min.js"></script>
    <script src="app.js"></script>
    <script>
       app.value("name", "James").value("id", "007");
    </script>
  </head>
  <body ng-controller="MainCtrl">
    <h1>I am  {{name}} {{id}}</h1>
  </body>
</html> 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-12-30T22:22:08.187

**视图不应指定配置**

在 Angular 中，模板永远不应该指定配置，这本质上是人们想要从模板文件向控制器传递参数时所希望的。这变成了一个滑坡。如果配置设置在模板中是硬编码的（例如通过指令或控制器参数属性），则您不能再将该模板重复用于除单一用途之外的任何用途。很快你就会想要重新使用那个模板，但是使用不同的配置，现在为了做到这一点，你要么在模板被传递给 angular 之前预处理模板以注入变量，要么使用大量指令来吐出巨大的HTML 块，因此您可以重复使用除包装器 div 及其参数之外的所有控制器 HTML。对于小型项目，这没什么大不了的。对于一些大的东西（角度擅长的东西），它很快就会变得丑陋。

**替代方案：模块**

这种类型的配置是模块被设计来处理的。在许多 Angular 教程中，人们的整个应用程序只有一个模块，但实际上系统是经过设计的，并且完全支持许多小模块，每个小模块都包含整个应用程序的一小部分。理想情况下，控制器、模块等将在单独的文件中声明，并在特定的可重用块中拼接在一起。当您的应用程序以这种方式设计时，除了简单的控制器参数之外，您还可以获得很多重用。

下面的示例有 2 个模块，重复使用相同的控制器，但每个模块都有自己的配置设置。该配置设置通过依赖注入使用`module.value`. 这遵循了 angular 方式，因为我们有以下内容：构造函数依赖注入、可重用的控制器代码、可重用的控制器模板（控制器 div 可以很容易地包含在 ng-include 中）、无需 HTML 的易于单元测试的系统，最后是可重用的模块作为将零件缝合在一起的工具。

这是一个例子：

```
<!-- index.html -->
<div id="module1">
    <div ng-controller="MyCtrl">
        <div>{{foo}}</div>
    </div>
</div>
<div id="module2">
    <div ng-controller="MyCtrl">
        <div>{{foo}}</div>
    </div>
</div>
<script>
    // part of this template, or a JS file designed to be used with this template
    angular.element(document).ready(function() {
        angular.bootstrap(document.getElementById("module1"), ["module1"]);
        angular.bootstrap(document.getElementById("module2"), ["module2"]);
    });
</script>

<!-- scripts which will likely in be in their seperate files -->
<script>
    // MyCtrl.js
    var MyCtrl = function($scope, foo) {
    $scope.foo = foo;
    }

    MyCtrl.$inject = ["$scope", "foo"];

    // Module1.js
    var module1 = angular.module('module1', []);
    module1.value("foo", "fooValue1");
    module1.controller("MyCtrl", MyCtrl);

    // Module2.js file
    var module2 = angular.module('module2', []);
    module2.value("foo", "fooValue2");
    module2.controller("MyCtrl", MyCtrl);
</script> 
```

看看它的实际效果：[jsFiddle](http://jsfiddle.net/xmb3f464/5/)。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-02-13T10:23:49.793

就像@akonsu 和 Nigel Findlater 建议的那样，您可以读取 url 所在的 url`index.html#/user/:id`并`$routeParams.id`在控制器中使用它。

你的应用：

```
var app = angular.module('myApp', [ 'ngResource' ]);

app.config(['$routeProvider', function($routeProvider) {
    $routeProvider.when('/:type/:id', {templateUrl: 'myView.html', controller: 'myCtrl'});
}]); 
```

资源服务

```
app.factory('MyElements', ['$resource', function($resource) {
     return $resource('url/to/json/:type/:id', { type:'@type', id:'@id' });
}]); 
```

控制器

```
app.controller('MyCtrl', ['$scope', '$routeParams', 'MyElements', function($scope, $routeParams, MyElements) {
    MyElements.get({'type': $routeParams.type, "id": $routeParams.id }, function(elm) {
        $scope.elm = elm;
    })
}]); 
```

然后，`elm`可以在视图中访问，具体取决于`id`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-11-25T22:00:59.587

如果`ng-init`不是为了将对象传递给`$scope`，您可以随时编写自己的指令。所以这就是我得到的：

[http://jsfiddle.net/goliney/89bLj/](http://jsfiddle.net/goliney/89bLj/)

**Javasript：**

```
var app = angular.module('myApp', []);
app.directive('initData', function($parse) {
    return function(scope, element, attrs) {
        //modify scope
        var model = $parse(attrs.initData);
        model(scope);
    };
});

function Ctrl1($scope) {
    //should be defined
    $scope.inputdata = {foo:"east", bar:"west"};
} 
```

**html:**

```
<div ng-controller="Ctrl1">
    <div init-data="inputdata.foo=123; inputdata.bar=321"></div>
</div> 
```

但是我的方法只能修改已经在控制器中定义的对象。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-11-26T09:47:55.113

看起来对您来说最好的解决方案实际上是一个指令。这允许您仍然拥有控制器，但为其定义自定义属性。

如果您需要访问包装范围内的变量，请使用它：

```
angular.module('myModule').directive('user', function ($filter) {
  return {
    link: function (scope, element, attrs) {
      $scope.connection = $resource('api.com/user/' + attrs.userId);
    }
  };
});

<user user-id="{% id %}"></user> 
```

如果您不需要访问包装范围内的变量，请使用此选项：

```
angular.module('myModule').directive('user', function ($filter) {
  return {
    scope: {
      userId: '@'
    },
    link: function (scope, element, attrs) {
      $scope.connection = $resource('api.com/user/' + scope.userId);
    }
  };
});

<user user-id="{% id %}"></user> 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2014-12-01T11:31:10.110

我发现从 $routeProvider 传递变量很有用。

例如，您将一个控制器 MyController 用于多个屏幕，并在其中传递一些非常重要的变量“mySuperConstant”。

使用那个简单的结构：

```
Router:

$routeProvider
            .when('/this-page', {
                templateUrl: 'common.html',
                controller: MyController,
                mySuperConstant: "123"
            })
            .when('/that-page', {
                templateUrl: 'common.html',
                controller: MyController,
                mySuperConstant: "456"
            })
            .when('/another-page', {
                templateUrl: 'common.html',
                controller: MyController,
                mySuperConstant: "789"
            })

MyController:

    MyController: function ($scope, $route) {
        var mySuperConstant: $route.current.mySuperConstant;
        alert(mySuperConstant);

    } 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-07-06T20:18:56.150

您可以在设置路线时执行此操作，例如

```
 .when('/newitem/:itemType', {
            templateUrl: 'scripts/components/items/newEditItem.html',
            controller: 'NewEditItemController as vm',
            resolve: {
              isEditMode: function () {
                return true;
              }
            },
        }) 
```

稍后将其用作

```
(function () {
  'use strict';

  angular
    .module('myApp')
    .controller('NewEditItemController', NewEditItemController);

  NewEditItemController.$inject = ['$http','isEditMode',$routeParams,];

  function NewEditItemController($http, isEditMode, $routeParams) {
    /* jshint validthis:true */

    var vm = this;
    vm.isEditMode = isEditMode;
    vm.itemType = $routeParams.itemType;
  }
})(); 
```

因此，当我们设置路由时，我们发送 :itemType 并稍后从 $routeParams 中检索它。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-09-23T12:50:59.673

还有另一种将参数传递给控制器​​的方法，方法是将 $routeParams 注入控制器，然后使用此处描述的 url 参数[在 AngularJS 中读取查询参数的最简洁方法是什么？](https://stackoverflow.com/questions/11063673/whats-the-most-concise-way-to-read-query-parameters-in-angularjs)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-02-09T18:45:24.553

这个问题很老，但我挣扎了很长时间，试图找到一个适合我需要的问题的答案，但并不容易找到它。我相信我的以下解决方案比目前接受的解决方案要好得多，也许是因为 angular 自从这个问题最初提出以来就增加了功能。

简短的回答，使用 Module.value 方法允许您将数据传递到控制器构造函数中。

[在这里](http://plnkr.co/edit/WGvFbs7wWbRuaYFNejza?p=preview)看到我的 plunker

我创建了一个模型对象，然后将它与模块的控制器相关联，并用名称“模型”引用它

**HTML / JS**

```
 <html>
  <head>
    <script>
      var model = {"id": 1, "name":"foo"};

      $(document).ready(function(){
        var module = angular.module('myApp', []);
        module.value('model', model);
        module.controller('MyController', ['model', MyController]);
        angular.bootstrap(document, ['myApp']);
      });

      function confirmModelEdited() {
        alert("model name: " + model.name + "\nmodel id: " + model.id);
      }
    </script>

  </head>
  <body >
      <div ng-controller="MyController as controller">
        id: {{controller.model.id}} <br>
        name: <input ng-model="controller.model.name"/>{{controller.model.name}}
        <br><button ng-click="controller.incrementId()">increment ID</button>
        <br><button onclick="confirmModelEdited()">confirm model was edited</button>
    </div>
  </body>

</html> 
```

然后，我的控制器中的构造函数接受具有相同标识符“模型”的参数，然后它可以访问该参数。

**控制器**

```
function MyController (model) {
  this.model = model;
}

MyController.prototype.incrementId = function() {
  this.model.id = this.model.id + 1;
} 
```

笔记：

我正在使用[bootstrapping](https://docs.angularjs.org/guide/bootstrap)的手动初始化，它允许我在将模型发送到 Angular 之前对其进行初始化。这与现有代码配合得更好，因为您可以等待设置相关数据并仅在需要时按需编译应用程序的 Angular 子集。

在 plunker 中，我添加了一个按钮来提醒最初在 javascript 中定义并传递给 angular 的模型对象的值，只是为了确认 angular 真正引用了模型对象，而不是复制它并使用副本。

在这条线上：

```
module.controller('MyController', ['model', MyController]); 
```

我将 MyController 对象传递给 Module.controller 函数，而不是声明为内联函数。我认为这使我们能够更清楚地定义我们的控制器对象，但是 Angular 文档倾向于内联，所以我认为它需要澄清。

我正在使用“controller as”语法并将值分配给 MyController 的“this”属性，而不是使用“$scope”变量。我相信使用 $scope 也可以正常工作，控制器分配看起来像这样：

```
module.controller('MyController', ['$scope', 'model', MyController]); 
```

并且控制器构造函数将具有如下签名：

```
function MyController ($scope, model) { 
```

如果出于任何原因，您还可以将此模型作为第二个模块的值附加，然后将其作为依赖项附加到主模块。

我相信他的解决方案比目前接受的解决方案要好得多，因为

1.  传递给控制器​​的模型实际上是一个 javascript 对象，而不是被评估的字符串。它是对对象的真实引用，对它的更改会影响对该模型对象的其他引用。
2.  Angular 说，公认的答案对 ng-init 的使用是一种误用，而这个解决方案没有这样做。

在我见过的大多数其他示例中，Angular 的工作方式似乎是控制器定义了模型的数据，这对我来说从来没有意义，模型和控制器之间没有分离，这看起来并不像MVC 对我来说。该解决方案允许您真正拥有一个完全独立的模型对象，并将其传递给控制器​​。另外值得注意的是，如果您使用 ng-include 指令，您可以将所有 angular html 放在一个单独的文件中，将您的模型视图和控制器完全分离为单独的模块化部分。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-06T22:26:00.607

如果使用 angular-ui-router，那么这是正确的解决方案：[https ://github.com/angular-ui/ui-router/wiki#resolve](https://github.com/angular-ui/ui-router/wiki#resolve)

基本上，您在实例化控制器之前声明一组要“解决”的依赖项。您可以为每个“状态”声明依赖项。然后将这些依赖项传递到控制器的“构造函数”中。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-07-10T15:40:00.470

这样做的一种方法是拥有一个单独的服务，该服务可以用作那些作为公共数据成员的参数的“容器”。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-02-15T01:08:09.357

这是@Michael Tiller[出色答案](https://stackoverflow.com/a/23612752/1843673)的扩展。他的答案适用于通过将`$attrs`对象注入控制器来初始化视图中的变量。`$routeProvider`如果在通过路由导航时调用同一个控制器，则会出现问题。然后你会得到注入器错误`Unknown provider : $attrsProvider`，因为`$attrs`只有在编译视图时才可用于注入。`$routeParams`解决方案是在从路由`$attrs`初始化控制器和从视图初始化控制器时传递变量（foo） 。这是我的解决方案。

**从路线**

```
$routeProvider.
        when('/mypage/:foo', {
            templateUrl: 'templates/mypage.html',
            controller: 'MyPageController',
            caseInsensitiveMatch: true,
            resolve: {
                $attrs: function () {
                    return {};
                }
            }
        }); 
```

这处理一个 url，例如`'/mypage/bar'`. 如您所见， foo 是通过 url 参数传递的，我们为 foo 提供了`$injector`一个空白对象，`$attrs`因此不会出现注入器错误。

**从视图**

```
<div ng-controller="MyPageController" data-foo="bar">

</div> 
```

**现在控制器**

```
var app = angular.module('myapp', []);
app.controller('MyPageController',['$scope', '$attrs', '$routeParams'], function($scope, $attrs, $routeParams) {
   //now you can initialize foo. If $attrs contains foo, it's been initialized from view
   //else find it from $routeParams
   var foo = $attrs.foo? $attrs.foo : $routeParams.foo;
   console.log(foo); //prints 'bar'

}); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-04-18T18:36:59.523

对于我的特定用例，我真的不喜欢这里的任何解决方案，所以我想我会发布我所做的，因为我在这里没有看到它。

我只是想在 ng-repeat 循环中使用更像指令的控制器：

```
<div ng-repeat="objParameter in [{id:'a'},{id:'b'},{id:'c'}]">
  <div ng-controller="DirectiveLikeController as ctrl"></div>
</div> 
```

现在，为了访问`objParameter`每个 DirectiveLikeController 中的创建（或随时获取最新的 objParameter），我需要做的就是注入 $scope 并调用`$scope.$eval('objParameter')`：

```
var app = angular.module('myapp', []);
app.controller('DirectiveLikeController',['$scope'], function($scope) {
   //print 'a' for the 1st instance, 'b' for the 2nd instance, and 'c' for the 3rd.
   console.log($scope.$eval('objParameter').id); 
}); 
```

我看到的唯一真正的缺点是它需要父控制器知道参数是命名的`objParameter`。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-01-25T14:31:20.560

不，这是不可能的。我认为您可以将 ng-init 用作 hack [http://docs.angularjs.org/api/ng.directive:ngInit](http://docs.angularjs.org/api/ng.directive:ngInit)。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-09-02T15:39:07.670

这是一个解决方案（基于 Marcin Wyszynski 的建议），它适用于您想要将值传递到控制器但您没有在 html 中明确声明控制器（ng-init 似乎需要）的地方 - 例如，如果，您正在使用 ng-view 渲染模板，并通过 routeProvider 为相应的路由声明每个控制器。

JS

```
messageboard.directive('currentuser', ['CurrentUser', function(CurrentUser) {
  return function(scope, element, attrs) {
    CurrentUser.name = attrs.name;
  };
}]); 
```

html

```
<div ng-app="app">
  <div class="view-container">
    <div ng-view currentuser name="testusername" class="view-frame animate-view"></div>
  </div>
</div> 
```

在这个解决方案中，CurrentUser 是一个服务，可以注入到任何控制器中，然后可以使用 .name 属性。

两个注意事项：

*   我遇到的一个问题是 .name 在控制器加载后被设置，因此作为一种解决方法，我在控制器范围内呈现用户名之前有一个短暂的超时。是否有一种巧妙的方法可以等到在服务上设置了 .name ？

*   这感觉像是让当前用户进入您的 Angular 应用程序的一种非常简单的方法，而所有身份验证都保留在 Angular 之外。您可以有一个 before_filter 来防止未登录的用户访问您的 Angular 应用程序引导所在的 html，如果您想与用户的详细信息交互，您可以在该 html 中插入登录用户的名称甚至他们的 ID通过来自 Angular 应用程序的 http 请求。您可以允许未登录的用户通过默认的“访客用户”使用 Angular 应用程序。任何关于为什么这种方法不好的建议都会受到欢迎 - 感觉太容易明智了！）

# django - Django 多模板继承

> ID：14523683
> 
> 赞同：4
> 
> 时间：2013-01-25T14:21:40.413
> 
> 标签：django, templates, django-templates, jinja2

我的情况很简单：

*   我有一个文本/普通邮件模板：body.txt
*   另一个用于 text/html 邮件：body.html

这两封邮件的内容是相同的，因为我使用 EmailAlternative 在同一封邮件中发送。

**正文.txt**：

```
{% block message %}{% endblock %}

{{ site_name }} team
-----------------
If you need help contact use at {{ support_mail }} 
```

**正文.html**：

```
<html>
    <head>
        <title>{% block title %}{% endblock %}</title>
    </head>
    <body>
        <p>{% filter linebreaksbr %}{% block message %}{% endblock %}{% endfilter %}</p>
        <p><strong>{{ site_name }} team</strong></p>
        <hr/>
        If you need help contact use at <a href="mailto:{{ support_mail }}">{{ support_mail }}</a>
    </body>
</html> 
```

当然，翻译、css 和不止一个块会稍微复杂一些。

我的愿望是定义**邀请.txt**：

```
{% block message %}Dear {{ first_name|title }} {{ last_name|upper }},

Your inscription has bee accepted. Welcome!
{% endblock %} 
```

我希望能够加载（body.txt、invitation.txt）和（body.html、invitation.txt）来获取我的两个 html 部分。

编辑：

像这样的东西：

**邀请/body.txt**：

```
{% extends body.txt invitation.txt %} 
```

**邀请/body.html**：

```
{% extends body.html invitation.txt %} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T14:42:24.927

您可以使用[包括](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#include)

例如： **邀请.txt**：

```
Dear {{ first_name|title }} {{ last_name|upper }},

Your inscription has bee accepted. Welcome! 
```

**邀请/body.txt**：

```
{% extends body.txt %}
{% block message %}
{% include "invitation.txt" %}
{% endblock %} 
```

**邀请/body.html**：

```
{% extends body.html %}
{% block message %}
{% include "invitation.txt" %}
{% endblock %} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-25T14:47:14.100

您可以在上下文中设置变量并将其传递给`extends`模板标签。

在邀请.txt 中：

```
{% extends base %}
{% block message %}Dear {{ first_name|title }} {{ last_name|upper }},

Your inscription has been accepted. Welcome!
{% endblock %} 
```

使用 context 渲染邀请.txt `{'base': 'body.txt'}`，然后使用 context `{'base': 'body.html'}`。

# css - 动态 Div 在鼠标悬停时改变宽度

> ID：14523685
> 
> 赞同：0
> 
> 时间：2013-01-25T14:21:50.783
> 
> 标签：css, html

在我的项目中，我有一些动态生成的 Div。
定义这些 Div 的代码如下所示：
`"<div class=\"DivStyle\" runat=\"server\" \">";`
类`DivStyle`如下所示：

```
.DivStyle:hover  
{  
    display: inline-block;  
    border: 3px solid rgb(242, 209, 153);  
    border-style: dashed  
} 
```

我的问题是：当我将鼠标放在这些 Div 上时，它们的宽度会缩小。现在以这些 Div**之一**
为例。 通常它看起来像这样：*这* 本来就是应该看起来的样子...... 但是当我的鼠标悬停在它上面时，它会变成这样： 为什么会发生这种情况？ 我能做些什么来防止它？ **![正常的外观和感觉](../Images/2c907c999978a9f1e51264be8fcb9aaa.png)
 *![错误的外观和感觉](../Images/db3f48df6008208540f3dc5fb4737561.png)*** 

 **** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:25:24.537

在所有 CSS 中搜索 :hover，看看是否有另一个条目导致了这种情况。它可能是一个父元素。***

# c - realloc 和 malloc 过去的幽灵

> ID：14523690
> 
> 赞同：0
> 
> 时间：2013-01-25T14:22:07.757
> 
> 标签：c, free, realloc

我知道这`realloc`将在必要时释放内存，并且我知道 C 的第三条规则 - “对于每个`malloc`必须有一个相等和相反的`free`”......但是这两者如何协同工作？

这种情况最好用代码描述：

```
int main()
{
    myStruct **myStructArray;
    int      i, num_elements;

    num_elements = getnumber(); // gets value for num_elements

    myStructArray = (myStruct **) malloc(num_elements * sizeof(myStruct*));
    for (i=0; i<num_elements; i++)
        myStructArray[i] = (myStruct *) malloc(sizeof(myStruct));

    // so far so good...

    num_elements = getnumber(); // gets new, LOWER value

    myStructArray = realloc(myStructArrary, num_elements * sizeof(myStruct*));

    // rest_of_code, and necessary free loop for myStructArray etc...
} 
```

显然以上只是一个片段，但一个片段却描绘了一千个单词。

这会造成内存泄漏吗？我知道调用 to`realloc`将释放指针的内存，但我可以看到支持和反对仍然会有一堆内存被遗忘的可能性的论据。

可以通过在调用释放（现在为 NULL）指针之前合并`int number_elements_new`到代码中并循环`free`剩余的 s来规避泄漏。`myStruct``realloc`

如果`realloc`做驴工作并释放所有相关的内存，那就太好了，否则我必须仔细检查以确保没有遗漏任何东西——`myStruct`它本身包含分配的内存等等。

谢谢你的建议...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T14:25:23.513

`malloc`，`realloc`并且`free`不知道内存的用途。如果您使用内存来存储指向其他动态分配内存的指针，那么您需要整理一下！

* * *

另外，请注意，您`realloc`在代码片段中使用的方式可能不安全。如果`realloc`失败，它将保留原始内存未释放，并返回`NULL`。最佳做法是将返回值分配给临时指针，然后检查。参见例如[http://www.c-faq.com/malloc/realloc.html](http://www.c-faq.com/malloc/realloc.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:30:18.347

如果数量低于现有元素数量，您将引入内存泄漏，因为重新分配的块与内容无关，并且您将丢失对 for 循环中分配的块的引用。

因此，您必须遍历您的数组并释放所有将被删除的元素。

如果该数字高于现有数字，则不会造成内存泄漏，因为如果分配了新的内存块，则 realloc 会复制现有数据。因此，您的其他动态分配的块（for 循环中的 malloc）仍然由调整大小的数组引用。这里唯一的问题是，新分配的数组空间未初始化，因此可能包含无效指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:33:11.767

如果要缩小数组的大小，则首先需要`free`每个`myStructArray[i]` where `i`>= `num_elements`，否则会出现内存泄漏。

换句话说，缩小指针数组的大小不会影响每个数组元素指向的内存。

此外，在`realloc`调用中，您需要将结果分配给临时指针；如果`realloc`不能扩展或缩小缓冲区，它将返回 NULL，并且您将丢失对该块的引用，这也会引入泄漏：

```
myStruct **tmp = realloc(myStructArray, ...);
if (tmp)
{
  myStructArray = tmp;
  ...
} 
```

# mysql - 重启服务后无法通过 ssh 运行 mysql 控制台

> ID：14523694
> 
> 赞同：4
> 
> 时间：2013-01-25T14:22:14.110
> 
> 标签：mysql, ssh

我使用的是 Ubuntu 12.04 x64，目前使用的是 Mysql 5.5.28（加上 Galera，但我认为它不相关）。我在 my.cnf 中进行了一些更改，但更改与 InnoDB 设置有关（缓冲池、刷新、线程并发设置等更多内存）。

之后，当我点击时，`service mysql restart`我无法进入 mysql 控制台 - 我收到以下错误消息：

```
Lost connection to MySQL server at 'reading initial communication packet', 
  system error: 104 
```

有时下一次尝试会导致进入控制台，有时不会，我必须重新启动我的 SSH 连接。可能是什么问题以及如何解决？

编辑：我注意到大多数时候发生`system error: 104`以下错误后：

```
ERROR 2002 (HY000): Can't connect to local MySQL server through socket 
'/var/run/mysqld/mysqld.sock' (111) 
```

几次之后，它通常会开始。不幸的是，现在它没有，并且在 syslog 中有：

```
Error in my_thread_global_end(): 2 threads didn't exit 
```

重新启动 SSH 连接/MySQL 服务器不工作。我可以尝试重新启动服务器，但我会尝试在没有该步骤的情况下解决此问题。它的测试环境，所以我想找到比重启整个服务器更好的解决方案；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T13:38:21.503

*   请尝试此页面中的答案：-[在“读取初始通信数据包”时丢失与 MySQL 服务器的连接，系统错误：0](https://stackoverflow.com/questions/5755819/lost-connection-to-mysql-server-at-reading-initial-communication-packet-syste)

*   也试试[这个](http://www.linuxquestions.org/questions/linux-server-73/lost-connection-to-mysql-server-at-reading-initial-communication-packet-system-err-741347/#edit3613768)。

# google-maps - 带有城市/国家/地区字段的 Google Map Pin

> ID：14523696
> 
> 赞同：0
> 
> 时间：2013-01-25T14:22:24.607
> 
> 标签：google-maps

我知道可以使用 LAT/LONG 变量在谷歌地图上放置图钉。我想知道是否可以在城市/国家字段中放置大头针。我有一个注册表单，允许用户输入他的地址，并想知道是否可以使用这些地址变量（城市、州、国家、邮政/邮政编码）中的任何一个来在地图上创建图钉。而不是询问客户端搜索并输入 LAT/LONG？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:26:46.350

您将需要使用地理编码服务将地址转换为纬度/经度。您可以尝试[Google 的 API](https://developers.google.com/maps/documentation/geocoding/)或其他一些，例如[geocoder.us](http://geocoder.us/)

# extjs4 - ExtJS 网格“重置”

> ID：14523708
> 
> 赞同：2
> 
> 时间：2013-01-25T14:22:57.100
> 
> 标签：extjs4

我在 ExtJS 4 上并使用 MVC 方法。我创建了一个简单的网格视图类，并在我的控制器中向该视图添加了一个组件查询类型“ref”。在初始网格视图本身中，我将几列设置为隐藏，而一些列默认为可见。使用这些设置渲染网格一切正常。

然后我有一个按钮，当单击该按钮并基于其他一些条件时，将使一些最初隐藏的网格列可见。这也有效。

但我需要的是一种稍后将网格“重置”到其初始视图的方法（正确的列隐藏/可见，就像它们最初一样）。

我尝试了以下各种排列但没有效果：

```
var theGrid = this.getTheGrid();
theGrid.reconfigure(store, theGrid.initialConfig.columns);
theGrid.getView().refresh(); 
```

我想我可以遍历每一列并重置其“隐藏”状态，但会认为有一种方法可以“重置”回类中设置的内容？建议？

**解决方案更新**

欣赏来自 tuespetre 的指针。对于将来寻找细节的任何人，这是需要的（至少对于我的实现而言）：

*   在视图中，将列 defs 移动到变量中

*   在视图中，类中的列 ref 变为：

    ```
    columns: myColumns, 
    ```

*   在视图中，在类中创建了以下函数：

    ```
    resetGrid: function(){
        this.reconfigure(null, myColumns);
    }, 
    ```

*   在控制器内：

    ```
    var theGrid = this.getTheGrid();
    theGrid.resetGrid(); 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:41:39.857

您只需要在视图类上创建一个函数来封装该功能。

# arrays - VB6：控件字段数组，检查它是否为数字

> ID：14523709
> 
> 赞同：0
> 
> 时间：2013-01-25T14:22:59.067
> 
> 标签：arrays, vb6, controls, numeric

我是 Visual Basic 6 的新手，所以请耐心等待（并彻底回答您的问题）。

我正在构建一个表单，我需要检查在其中一个字段中输入的信息是否是数字，否则程序必须发出哔哔声。

该字段是控件数组的一部分，名为 txtMyField(0)

我写的代码中的最后一件事：

```
Private Sub txtMyField_Change(Index As Integer)
If Not IsNumeric(txtMyField(0).Text) Then
    Beep
End If
End Sub 
```

我不知道这段代码是否正确，我也不知道如何调用 Sub 来使用它，以便在插入数据库之前检查字段的值。

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:11:31.853

您可以使用 Validate 事件来执行此操作。您需要确保 CausesValidation 属性为真，如果是，则将为该控件引发 Validate 事件。

您的活动可能如下所示：

```
Private Sub txtMyField_Validate(Index As Integer, Cancel As Boolean)
    If Not IsNumeric(txtMyField(Index).Text) Then
        Beep
        Cancel = True
    End If
End Sub 
```

这将确保控件数组中的所有控件都是数字的（假设它们的 CausesValidation 属性在启动时设置为 True）。如果其中一个控件为空或包含非数字字符，则当控件失去焦点时会发出哔声。

注意这里的一些事情

*   发出哔声并不是指示验证错误的好方法。表单中显示错误的消息框或文本框通常是更好的方法。用户可能听不到您的哔声，或者可能不理解“哔声”的意思是“您需要在此字段中提供一个数字”。
*   您的代码引用了 index = 0 的控件。该事件可能会针对控件数组中的任何控件触发，因此在您应该验证 control(5) 时检查 control(0) 的值并不是真正合乎逻辑的事情（例如）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T14:57:35.683

而不是哔哔声，你也可以让你的texbox只接受某些键

例如一个只接受数字键和退格键的文本框：

```
Private Sub Text1_KeyPress(KeyAscii As Integer)
  KeyAscii = NrOnly(KeyAscii)
End Sub

Private Function NrOnly(intKey As Integer)
  Dim intReturn As Integer
  intReturn = intKey
  Select Case intKey
    Case vbKeyBack
    Case vbKey0 To vbKey9
    Case Else
      intReturn = 0
  End Select
  NrOnly = intReturn
End Function 
```

您可以为 NrOnly 函数添加更多智能以允许更多键，或检查某些边界

不过要小心，因为用户仍然可以使用鼠标通过复制和粘贴来输入其他数据

# c++ - 静态方法中的静态变量不会改变

> ID：14523717
> 
> 赞同：2
> 
> 时间：2013-01-25T14:23:18.280
> 
> 标签：c++, oop, static, static-methods

我想创建一个具有静态方法的类，该方法返回对静态变量的引用（在方法内部声明）。我想要的是在调用该方法以获取静态变量的引用时。然后当我在类外修改它并再次调用该方法以获得我之前设置的相同值时。

这是我尝试过的：

```
#include <iostream>
using namespace std;

class A
{
public:
    static int& f()
    {
        static int i;
        return i;
    }
};

int main()
{
    static int i;
    i = A::f();

    cout << i << endl;

    i = 11;
    cout << i << endl;

    i = A::f();
    cout << i << endl;

    return 0;
} 
```

问题是这段代码的输出是：

```
0
11
0
Press <RETURN> to close this window... 
```

为什么它不返回`0, 11, 11`，我怎样才能让它返回`0, 11, 11`？

注意：我希望静态变量在方法内部显式声明，而不是作为成员。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T14:25:41.360

这是因为您将引用返回的值复制到常规变量中：当您存储`int&`在 an中时`int`，它不再是引用。

你应该做的是

```
int &i = A::f(); 
```

注意，本地`i`不需要`static`：引用静态数据可以存储在自动变量中没有问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T14:25:19.353

要让局部变量`i`引用函数内的同一个变量，请将其声明为引用：

```
static int& i = A::f(); 
```

否则，您只是创建一个新变量并使用分配`A::f()`给它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-25T14:25:52.140

它必须是`int&`in `main`，如果您希望对它的更改`int`是对返回值所引用的 int 的更改`f`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T14:31:57.610

您可能想要初始化您的变量。***您可以直接使用它，***或者您可能希望在本地参考中“保存”参考。但是您不能重新分配这些本地引用。例如：

```
int main()
{
    A::f()=3;
    cout << A::f() << endl;

    static int &i = A::f();
    cout << i << endl;

    i = 11;
    cout << i << endl;

    cout << A::f() << endl;

    int &ii = A::f();
    cout << ii << endl;

    return 0;
} 
```

# c# - Metro 风格 windows 7 WPF 应用程序-toggleSwitch-

> ID：14523723
> 
> 赞同：0
> 
> 时间：2013-01-25T14:23:39.813
> 
> 标签：c#, wpf, mahapps.metro

我目前正在摆弄我的一个使用[MahApps](http://mahapps.com/MahApps.Metro/#icons) Metro 库的旧 wpf 应用程序的外观。我被**Controls:ToggleSwitch 困住**了，我可以在其中绑定除命令之外的几乎所有内容。当我尝试如下绑定命令时，

```
<Controls:ToggleSwitch Header="Start Playing" OnLabel="Stop" OffLabel="Play" 
    IsChecked="{Binding ToggleRecordCommand}"
    CommandParameter="{Binding}"  /> 
```

我收到一个错误，例如；

```
Error   62  A TwoWay or OneWayToSource binding cannot work on the read-only property 'ToggleRecordCommand' of type 'RecorderApp.View.MainWindowViewModel'. 
```

它还告诉我没有**CommandParameter**。我将如何将操作绑定到此？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T07:43:11.180

首先，正如 Brendan 所说，IsChecked 属性必须与具有 INotifyPropertyChanged 的​​一般属性绑定，而不是 ICommand 类型。

为了与 Command 绑定，最简单的解决方法是使用`Click`（或`Checked`）事件与 xaml.cs 代码隐藏工作。

在 XAML 中，如下所示。

```
<ToggleButton x:Name="recordButton" 
Checked="OnRecordButton_Checked" 
IsChecked={Binding IsRecording} /> 
```

在代码隐藏中，如下所示。

```
private void OnRecordButton_Checked(object sender, RoutedEventArgs e)
{
    if (recordButton.IsChecked.GetValueOrDefault())
    {
        // Do your own logic to execute command. with-or-without command parameter.
        viewModel.ToggleRecordCommand.Execute(null);
    }
} 
```

并且，在 ViewModel（假设）中，如下所示。

```
// Property for toggle button GUI update
public bool IsRecording{
get{ return _isRecording;}
set{
    _isRecording = value;
    NotifyPropertyChanged("IsRecording");
    }
}

public ICommand ToggleRecordCommand{
// Your command logic.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T07:14:01.003

`IsChecked`是一个`bool?`属性，如果您将其传递给 ICommand，则可能无法正常工作。[源代码](https://github.com/MahApps/MahApps.Metro/blob/master/MahApps.Metro/Controls/ToggleSwitch.cs#L77)

如果您希望看到此支持，请在[项目站点](https://github.com/MahApps/MahApps.Metro)上提出问题，我们可以进一步讨论。

# ef-code-first - EF5 继承与代码优先

> ID：14523724
> 
> 赞同：0
> 
> 时间：2013-01-25T14:23:43.280
> 
> 标签：ef-code-first, entity-framework-5

我有多个较小版本的类映射到单个数据库表

例如 UserBrief 类：

```
[Table("Users")]
public partial class UserBrief
{   
    [Key]
    public int EmployeeID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; } 
} 
```

用户管理类

```
[Table("Users")]
public partial class UserAdmin : UserBrief
{      
public int RoleID { get; set; }     
} 
```

用户HR类

```
[Table("Users")]
public partial class UserHR : UserBrief
{      
    public string EmailAddress { get; set; }
    public string Phone { get; set; }     
} 
```

用户类

```
[Table("Users")]
public partial class User
{
    [Key]
    public int EmployeeID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int RoleID { get; set; }
    public string EmailAddress { get; set; }
    public string Phone { get; set; }
} 
```

我有多个有界上下文。根据我在上面的类中使用的上下文的功能。

如果我在上下文中添加单个类并忽略所有其他类，那么它工作正常。

例如

```
public DbSet<UserHR> UserHRs { get; set; }
protected override void OnModelCreating(System.Data.Entity.DbModelBuilder modelBuilder)
{
    modelBuilder.Ignore<UserBrief>();
    modelBuilder.Ignore<UserAdmin >();
    modelBuilder.Ignore<User>();
} 
```

现在，如果我添加了 UserBrief 和 UserHRs 它会给出错误*“无效的列名'鉴别器'”*，因为 EF 假定这是按层次结构表 (TPH) 方法。

我一直在寻找解决方案，但找不到如何做到这一点。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T17:04:49.860

TPH 方法的 POCO 对象中的继承类应该表示类的子类型，而不仅仅是属性部分。拥有由 UserHR 和 UserAdmin 组合而成的 User 表会破坏这种表示形式。

您可以尝试将鉴别器属性添加到`User`表中以修复错误，但我建议仅使用`Users`具有可为空属性的表或将对象建模为一对一关系：

```
public class UserBrief
{   
    [Key]
    public int EmployeeID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; } 

    public virtual UserAdmin UserAdmin { get; set; }
    public virtual UserHR UserHR { get; set; }
}

public class UserAdmin
{      
    [Key]
    [ForeignKey("UserBrief")]
    public int EmployeeID { get; set; }
    public int RoleID { get; set; }     

    public virtual UserBrief UserBrief{ get; set; }
}

public class UserHR
{      
    [Key]
    [ForeignKey("UserBrief")]
    public int EmployeeID { get; set; }
    public string EmailAddress { get; set; }
    public string Phone { get; set; }     

    public virtual UserBrief UserBrief{ get; set; }
} 
```

# parsing - 使用 Parsec 编写 Read 实例

> ID：14523728
> 
> 赞同：6
> 
> 时间：2013-01-25T14:23:54.197
> 
> 标签：parsing, haskell, parsec

使用 Parsec，我可以`String -> Maybe MyType`相对轻松地编写类型函数。我现在想`Read`基于此为我的类型创建一个实例；但是，我不明白`readsPrec`它是如何工作的或它应该做什么。

我现在最好的猜测`readsPrec`是用于从头开始构建递归解析器以遍历字符串，在 Haskell 中构建所需的数据类型。但是，我已经有一个非常强大的解析器，它可以为我做这件事。那么如何告诉`readsPrec`我使用我的解析器呢？它采用的“运算符优先级”参数是什么，在我的上下文中它有什么好处？

如果有帮助，我[在 Github 上创建了一个最小示例](https://gist.github.com/4634782)。它包含一个类型、一个解析器和一个空白的 Read 实例，并且很好地反映了我遇到的问题。

（背景：真正的解析器是针对 Scheme 的。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T15:06:28.943

> 但是，我已经有一个非常强大的解析器，它可以为我做这件事。

它实际上不是那么健壮，你的解析器有多余括号的问题，它不会解析

```
((1) (2)) 
```

例如，它会在一些格式错误的输入上抛出异常，因为

```
singleP = Single . read <$> many digit 
```

可以使用`read "" :: Int`.

顺便说一句，优先级参数用于确定在某些地方是否需要括号，例如，如果你有

```
infixr 6 :+:

data a :+: b = a :+: b

data C = C Int

data D = D C 
```

您不需要将括号括起来`C 12`作为 的参数`(:+:)`，因为应用程序的优先级高于 的`(:+:)`，但是您需要将括号括起来`C 12`作为 的参数`D`。

所以你通常会有类似的东西

```
readsPrec p = needsParens (p >= precedenceLevel) someParser 
```

where`someParser`解析输入中的值而不包含括号，并`needsParens True thing`解析`thing`括号之间的 a，同时`needsParens False thing`解析`thing` *可选*的括在括号中的 a [您应该始终接受比必要更多的括号，`((((((1))))))`应该解析为`Int`]。

由于`readsPrec p`解析器用于在读取列表、元组等时将输入的部分解析为值的一部分，因此它们不仅必须返回解析的值，还必须返回输入的剩余部分。

`parsec`这样，将解析器转换为解析器的简单方法`readsPrec`是

```
withRemaining :: Parser a -> Parser (a, String)
withRemaining p = (,) <$> p <*> getInput

parsecToReadsPrec :: Parser a -> Int -> ReadS a
parsecToReadsPrec parsecParser prec input
    = case parse (withremaining $ needsParens (prec >= threshold) parsecParser) "" input of
        Left _ -> []
        Right result -> [result] 
```

但是，如果您使用 GHC，则最好使用`ReadPrec / ReadP`解析器（使用 构建`Text.ParserCombinators.ReadP[rec]`）而不是`parsec`解析器，并使用定义`readPrec`而不是`readsPrec`.

# windows - 如何在 Windows 上通过 SSH 自动运行命令

> ID：14523729
> 
> 赞同：1
> 
> 时间：2013-01-25T14:23:54.727
> 
> 标签：windows, ssh, jenkins, cygwin

我有两个 Windows 盒子。一种是 Jenkins 构建服务器。第二个是部署箱。

我已经安装了 SSH 并在部署 Windows 框中创建了一个用户。我可以从我的 Ubuntu 工作站 ssh 到它并运行我需要运行的命令。

但我需要从 Jenkins 自动执行此操作。怎么做？基本上我需要使这个自动化：

```
ssh richard@myserver
... enter password ...
cd C:/puppet && git pull
"/cygdrive/c/Program Files (x86)/Puppet Labs/Puppet/bin/puppet.bat" apply C:/puppet/manifests/site.pp 
```

就是这样。有没有办法从批处理文件中执行此操作，只需从 Jenkins 执行 *.bat 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T15:00:13.660

通过[ssh 发布](https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+SSH+Plugin)插件允许您运行远程命令。

在*Manage Jenkins* > *Configure System* > *Publish over SSH*中，您需要配置要部署到的远程计算机。单击*添加*并配置与服务器的连接。

在 Job 本身中添加一个 Build Step *Send files 或通过 SSH 执行命令*。从下拉列表中选择要连接的 SSH 服务器。在*Exec 命令*中，您可以添加要在远程计算机上执行的所有命令。

# joomla - 为什么我的 Joomla 3 文章不能翻译成我的新语言？

> ID：14523731
> 
> 赞同：0
> 
> 时间：2013-01-25T14:24:02.500
> 
> 标签：joomla, multilingual, joomla-extensions, joomla-article

在 Joomla 3 的最新版本中，每个链接、模块和文章都可以与一种语言相关联。

我从 AdminCP 安装了一种新语言（Joomla 3 在管理员上有一个集成的安装语言）。现在，当我创建文章时，我继续只看到英语的语言选项，而不是我刚安装的新语言

什么不见​​了？是否需要安装组件？

我认为 Joomla 3 不需要像 joomfish 这样的组件，因为内容可以是多语言作为原生功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:20:38.030

您需要在语言管理器中添加您安装的语言作为内容语言。

# javascript - HTML 列表 (Li) 通过 Javascript onClick 更改

> ID：14523744
> 
> 赞同：1
> 
> 时间：2013-01-25T14:24:45.680
> 
> 标签：javascript, html, html-lists

我有一个看起来像这样的列表，因此用户应该逐个检查项目并获得该项目是否被检查的反馈。

```
<html>
<head>
    <link href="../../fuctions/style.css" rel="stylesheet" media="screen" type="text/css" />
    <script type="text/javascript" charset="utf-8" src="../../fuctions/cordova-2.3.0.js"></script>
    <script type="text/javascript" charset="utf-8" src="../../fuctions/functions.js"></script>
</head>
<body>
    <div id="topbar">
        <div id="title">
            Engine Run-up
        </div>  
        <div id="leftnav">
            <a href="../../index_aerosoft.html">Home</a>
            <a href="katana_checklist_all.html">Overview</a>
        </div>
        <div id="rightnav">
            <a href="katan_checklist_takeoff.html"id="a_next">Next</a>
        </div>
    </div>
    <div id="content">
        <ul class="pageitem">
            <li class="radiobutton">
                <span class="name">Toe Brakes -<font color="red"> hold</font></span>
                <input name="1" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Safety Belts -<font color="red"> fastened</font></span>
                <input name="2" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Canopy -<font color="red"> closed / locked</font></span>
                <input name="3" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Fuel Pressure Warning Light -<font color="red"> OFF</font></span>
                <input name="4" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Fuel Shut-off Valve -<font color="red"> check OPEN</font></span>
                <input name="5" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Fuel Quantity Indicator -<font color="red"> check</font></span>
                <input name="6" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Engine Gauges -<font color="red"> green range</font></span>
                <input name="7" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Trim -<font color="red"> NEUTRAL</font></span>
                <input name="8" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Controls -<font color="red"> free</font></span>
                <input name="9" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Throttle -<font color="red"> 1700-1800 RPM</font></span>
                <input name="10" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Prop Control Level -<font color="red"> Cycle 3 x (50-250 RPM)</font></span>
                <input name="11" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Ignition Switch - Cycle -<font color="red"> L-BOTH-R-BOTH</font></span>
                <input name="12" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Throttle -<font color="red"> 1500 RPM</font></span>
                <input name="13" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Carburetor Heat -<font color="red"> ON (<50 RPM)</font></span>
                    <input name="14" type="radio" value="other" />
                    </li>
            <li class="radiobutton">
                <span class="name">Throttle -<font color="red"> IDLE</font></span>
                <input name="15" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Carniretor Heat -<font color="red"> OFF</font></span>
                <input name="16" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Corcuit Breakers -<font color="red"> check IN</font></span>
                <input name="17" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Electric Fuel Pump -<font color="red"> ON</font></span>
                <input name="18" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Wing Flaps -<font color="red"> T/O</font></span>
                <input name="19" type="radio" value="other" />
            </li>
            <li class="radiobutton">
                <span class="name">Parking Brake -<font color="red"> release</font></span>
                <input name="20" type="radio" value="other" />
            </li>
        </ul>
    </div>
    <div id="footer">
        <a class="noeffect" href="#" onClick="resetChecklist();">Reset ZYX</a>
        <br /><br />
        <a class="noeffect" href="#" onClick="openXYZDE();">XYZ</a>
    </div>
</body> 
```

我想通过 JavaScript 检查是否检查了“li”之一，如果是，则应将该行更改为“绿色”。

```
<li class="radiobutton">
  <span class="name">Toe Brakes -<font color="green"> hold</font></span>
  <input name="1" type="radio" value="other" />
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:29:53.577

如果 jquery 是一个选项，它变得非常简单。

```
function checkChanges()
{
  $('.radiobutton font').attr('color', 'red');

  $('.radiobutton :checked').closest('.radiobutton').find('font').attr('color', 'green');
}

$(function()
{
  checkChanges();
  $('.radiobutton :radio').on('click', checkChanges);
}); 
```

虽然我强烈建议删除字体标签，而是在 li 中添加一个类，例如`radiobutton-checked`将字体颜色设置为绿色。

上面的代码会将所有字体重置为红色，然后找到其中一个带有选中单选的单选按钮，迭代回到父单选按钮 ( `closest`)，然后找到其子字体标签并将其颜色设置为绿色。然后，只要单击单选按钮，它就会重复上述过程，从而仅将主动选中的单选按钮保持为绿色。

# html - 如何创建 SCALABLE HTML5 横幅？这将填满 100% 的屏幕。

> ID：14523747
> 
> 赞同：0
> 
> 时间：2013-01-25T14:25:04.060
> 
> 标签：html

我们需要创建 HTML5 横幅，它不会有固定大小，但可以缩放并按宽度和高度适应 100% 的屏幕。横幅相当简单，但在 320x480 和 1024x768 上应该看起来不错。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T16:36:19.100

如果使用 SVG 图像是可以接受的，我会创建一个在两个极端情况下看起来都不错的图像（确保它在低分辨率下仍然可读），然后`<div class="span12">`使用响应式布局将其放入元素中，例如[Twitter Bootstrap](http://twitter.github.com/bootstrap/)。当用户更改屏幕大小时，您的横幅将很好地缩放。

如果您不能使用 SVG，则使用 JPEG 或 PNG，以最高分辨率设计横幅，并确保在使用您想要支持的最低分辨率时它仍然可读。

If you want to be really fancy, you could skip the image altogether and design your banner as a bunch of HTML5 code, with CSS and possibly JavaScript code that would display different content depending on the size of the screen, but that could be quite a bit of work and it might not be worth the effort.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-17T05:49:45.860

您可以制作具有 100% 全屏宽度的全屏横幅部分：宽度为 100%：高度：100%；，这里有提示和实时链接

```
#bannersection {
position: relative;
display: table;
width: 100%;
background: rgba(99,214,250,1);
height: 100vh;
} 
```

[https://www.htmllion.com/fullscreen-header-banner-section.html](https://www.htmllion.com/fullscreen-header-banner-section.html)

# jquery - jQuery 1.8 Ajax 请求类型“HEAD”在成功时返回 null xhr 对象，但在 1.7 中有效

> ID：14523748
> 
> 赞同：1
> 
> 时间：2013-01-25T14:25:05.197
> 
> 标签：jquery, ajax, xmlhttprequest

我似乎在 jQuery 1.8.3 中发现了一个未记录的重大更改。

在将页面从 jQuery 1.7 升级到 1.8.3 时，我们的“HEAD”类型的 ajax 调用之一停止工作。

在调试成功回调时，当我使用 google CDN 在 jQuery 1.8.3 中运行页面时，参数“xhr”为空。

如果我切换回 1.7，xhr 对象是完全可操作的，而不是 null。

我已经搜索了 google 和 jQuery 站点以了解 1.8.* 中的重大更改，但找不到任何相关信息。我需要升级它，因为我需要使用的另一个库需要最新的 jQuery，所以我现在处于困境和困境之间。

代码如下：

```
$.ajax({
    type: "HEAD",
    async: false,
    cache: false,
    url: pth + b,
    error: function (xhr) {

    // always succeeds

    },
    success: function (xhr) {
        // in jQuery 1.7.0 ONLY xhr is a non-null object - 1.8.3/1.9.0 receive a null object as a parameter
        c = xhr.getResponseHeader('x-amz-meta-mix');
        if (c == null) c = b;

    }
}); 
```

谢谢！

PS-我应该补充一点，在 Fiddler 中，响应始终为 200，并且我正在寻找的信息始终存在。问题是如果我不使用 jQuery 1.7.0 来支持 1.8.3 或 1.9.0，则 xhr 对象为空

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:11:01.627

jQuery 似乎改变了[`success`回调](http://api.jquery.com/jQuery.ajax/)的格式。在 1.8 及更高版本中，它是：

> 类型：函数（对象数据，字符串 textStatus，jqXHR jqXHR）

现在`jqXHR`是第三个参数，而不是第一个参数，因此将您的`success`处理程序更改为：

```
success: function (data, status, xhr) {
    ... 
```

# jquery - 新手 jQuery 祖先导航问题

> ID：14523756
> 
> 赞同：3
> 
> 时间：2013-01-25T14:25:27.337
> 
> 标签：jquery, html

为基本问题道歉，但我正在尝试将悬停状态添加到导航列表中，似乎无法弄清楚如何在不影响父级的情况下将悬停状态置于子级上`<li>`。从技术上讲，父母`<li>`也被悬停在上面。我知道这`.add/removeClass()`更理想，但对于我的测试来说，使用`.attr()`.

到目前为止，我得到了：

[我在http://jsfiddle.net/gSPkj/](http://jsfiddle.net/gSPkj/)设置了一个 jsfiddle，但下面是代码-

HTML-

```
<div id="sidebarNav">
<ul>
    <li class="parent"><a href="page1.html">Page 1</a></li>
    <li class="parent"><a href="page2.html">Page 2</a></li>
    <li class="parent"><a href="page3.html">Page 3</a></li>
    <li class="parent"><a href="page4.html">Page 4</a>
        <ul>
            <li class="child"><a href="subpage_of_4-2.html">Subpage of 4 - 1</a></li>
            <li class="child"><a href="subpage_of_4-2.html">Subpage of 4 - 2</a></li>
        </ul>
    </li>
</ul> 
```

jQuery -

```
 $("#sidebarNav li.parent").hover(function(){
$(this).attr("style","background:#123de1;color:#eb9028;");
},function(){
$(this).attr("style","background:#fff;color:#000;");
});
$("#sidebarNav li.child").hover(function(){
$(this).attr("style","background:#123de1;color:#eb9028;");
$(this).parents(".parent").attr("style","background:#fff;color:#000;");
},function(){
$(this).attr("style","background:#fff;color:#000;");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:48:13.717

定位锚点会更容易，然后找到最近的 li 元素来附加样式。我会这样做：

```
$("#sidebarNav li > a").on('mouseenter mouseleave', function(e) {
    $(this).closest('li').css({
        background: (e.type == 'mouseenter' ? '#123de' : '#fff'),
        color:  (e.type == 'mouseenter' ? '#eb9028' : '#000')
    });
}); 
```

[**小提琴**](http://jsfiddle.net/gSPkj/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:49:48.730

您只能使用 CSS 执行此操作

```
a:hover {
    background: #123de1;
    color: #eb9028;
} 
```

修改后[的 JSFiddle](http://jsfiddle.net/gSPkj/3/)

如果你真的需要 Javascript，你可以使用[event.stopPropagation()](http://api.jquery.com/event.stopPropagation/)

> 防止事件在 DOM 树中冒泡，防止任何父处理程序收到事件通知。

```
$("#sidebarNav li.child").hover(function(e){
    e.stopPropagation();
    $(this).attr('style','background:#123de1;color:#eb9028;');
},function(e){
    e.stopPropagation();
    $(this).attr('style','background:#000;color:#fff;');
}); 
```

尽管这仍然存在问题，但在从子级移动到父级或向后移动时。

修改后[的 JSFiddle](http://jsfiddle.net/gSPkj/6/)

# javascript - WebSocket 服务器 Javascript 实现

> ID：14523759
> 
> 赞同：2
> 
> 时间：2013-01-25T14:25:38.223
> 
> 标签：javascript, websocket, chat

我最近发现了 HTML 5 对 WebSocket 协议的支持。我开始无所事事地尝试它，并决定进行一个简单的聊天程序项目。为此，我希望能够使用 Google 的 Blogger 网站编写一个 WebSocket 服务器并让它在博客文章中为用户提供服务。

服务器将用 Javascript 编写，并拥有将一个人的“对话线路”发送到与其连接的所有其他 WebSocket 连接所需的所有代码。稍后，我可能会实现“聊天室”，其中每一行都简单地重定向到某些用户。

我的第一个问题：是否可以创建基于 Javascript 的 WebSocket 服务器？我研究了一下，似乎所有的服务器实现都是用 PHP 或类似的服务器端语言实现的。是否可以使用 Javascript 编写 WebSocket 服务器？

服务器实现将在网页内部，因此只要博客启动，服务器就可以正常工作。我的博客可以在[这里](http://imdmstromyf8imdcaptomysl.blogspot.com)找到。客户端的代码是这样的：

```
server = "http://imdmstromyf8imdcaptomysl.blogspot.com/post_that_handles_chat";
connection = new WebSocket (server); 
```

问题是，WebSocket 在它自己的协议（ws:// 或 wss://）上运行，因此将“http://”更改为“wss://”是行不通的。我可以通过 HTTP 隧道化 WebSocket 协议吗？如果我这样做了，我可能不得不使用 Ajax，但避免那​​是我想要一个 WebSocket 聊天程序的原因。

Blogger 有一个地方可以插入自己的 HTML；是否可以使用 PHP 标记从 HTML 中描述代码？

我只想知道是否可以做我想做的事，如果可以，一些实现技巧或（甚至更好）一些示例代码可以使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:52:06.713

```
"The server implementation would be inside of a webpage" 
```

服务器实现不在网页中。不知道你在这里的意思。您可能想要编辑您的问题。

Node.js 是用 JavaScript 编写的用于服务器的库。谷歌这个，你应该找到很多开始运行 WebSockets 的方法。要连接到客户端，您也将使用 JavaScript，您应该再次选择支持 Web 套接字的库。

此外，您需要验证客户端的浏览器是否支持它。

您可以在[此处查看支持 Web 套接字的浏览器](http://caniuse.com/#search=web%20sockets)

这是一个[用于 Web 套接字的 jQuery 插件](http://code.google.com/p/jquery-websocket/)

# mobile - 缺少 Ubuntu.Components QML 模块

> ID：14523761
> 
> 赞同：4
> 
> 时间：2013-01-25T14:25:39.963
> 
> 标签：mobile, ubuntu, qml

我安装了 QTCreator 和 Ubuntu SDK，如下[所示](http://developer.ubuntu.com/get-started/gomobile/#step-get-toolkit)。当尝试运行[此处](http://developer.ubuntu.com/resources/app-developer-cookbook/mobile/currency-converter-phone-app/)提供的代码示例时，QTCreator 告诉我它找不到 Ubuntu.Components QML 模块。

**备注**：

构建日志说：

> file:///home/giladnaaman/Programming/Projects/CurrencyConverter/CurrencyConverter.qml:2 模块“Ubuntu.Components”未安装

但是该目录`/opt/qt5/imports/Ubuntu/Components` 存在（并且充满了文件）。

添加`importPaths: [ "/opt/qt5/imports" ]`到`qmlproject`文件后：

> QML 模块不包含有关插件中包含的组件的信息。
> 
> QMetaType::registerType: 二进制兼容性中断——“QPaintBufferCacheEntry”[1024] 的类型标志不匹配。之前注册了 TypeFlags(0x103)，现在注册了 TypeFlags(0x3)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T02:37:33.930

不要将**importPaths**属性添加到 qmlproject。

您是否将 QML 场景设置为您的 QML 查看器？

1.  在 Qt Creator 中，转到**工具 > 选项**...</li>
2.  选择**External Tools**选项卡，然后在窗格中选择**Preview (qmlviewer)**条目
3.  在右侧的**Executable:**字段中，将内容替换为**/opt/qt5/bin/qmlscene**。
4.  可选择通过双击上面的**Preview (qmlviewer)**条目来更改命令名称。你可以称之为**Preview (qmlscene)**。
5.  单击确定以保存更改。

您将能够通过**Tools > External > Qt Quick > Preview (qmlscene)查看您的应用**

Ubuntu SDK 仍在使用来自 QT4 的旧版 Qt Creator，它将无法找到 Ubuntu 组件，并说未找到组件。但是用于运行 QML GUI 的 QML 场景将加载并运行它而不会出现任何问题。

# c# - 我如何进入其他班级

> ID：14523764
> 
> 赞同：0
> 
> 时间：2013-01-25T14:25:51.733
> 
> 标签：c#, visual-studio, visual-studio-2012

这真的是在测试“没有愚蠢的问题”

这是`console`代码：

```
class Program {

    static void Main(string[] args) {

        myClass cl = new myClass();
        cl.myMethod("world");

        Console.WriteLine("press [enter] to exit");
        Console.ReadLine();
    }
}

public class myClass {

    public void myMethod(string x) {
        Console.WriteLine("hello {0}", x);
    }
} 
```

如果我按下`F10`并踩进去`Main`然后一直按下`F10`它为什么不踩进去`myClass`？

我可以更改我的设置以使其进入其他被调用的类吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:27:29.863

`F11`是你的解决方案。是为了进场。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:40:05.587

F11 选项将起作用（进入的正确方法）。您还可以在要进入的类中设置断点，这也可以。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T14:27:54.370

因为`F11`是 Step *Into*，`F10`是 Step *Over*。

请注意，在某些情况下，它*似乎*`F11`仍然可以跨步，即在使用属性时，您已经确定 Visual Studio 可以“忽略”进入正文。

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T14:30:20.547

这在某种程度上是一个真正的测试:)

按 F11 而不是 F10。[在此视频](http://www.youtube.com/watch?v=QCPt9aOcd98)和[此处](https://stackoverflow.com/questions/7528302/debugging-how-do-i-execute-code-line-by-line)阅读有关调试的更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T14:27:56.290

这`F10`是单*步*命令，它不会单步执行被调用的方法。

用于`F11`进入命令，确实进入方法*。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T14:28:54.810

根据[热键列表](http://www.dofactory.com/ShortCutKeys/ShortCutKeys.aspx)不`F10`进入。你想要的是`F11`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-25T14:29:28.447

`F10`: 跨步

`F11`： 踏进

`Shift+F11`: 走出去*

# python - 连接在同一服务器套接字端口上的 Python 客户端套接字

> ID：14523767
> 
> 赞同：1
> 
> 时间：2013-01-25T14:25:54.153
> 
> 标签：python, sockets, client, port

我第一次使用 python 在套接字上工作。我需要将多个客户端套接字连接到同一个服务器套接字。

为此，我使用了以下代码：

```
import socket
import time
import random

from threading import Thread
import thread
import subprocess, signal, os

class ServerObject:
    def __init__(self, port):
        self.socket = ''
        self.host = ''
        self.port = port
        self.conn = ''
        self.data = ''

        print "Server port is: ", self.port

        def openSocketConnectionAsServer(self):
            self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            self.socket.bind((self.host, self.port))
            self.socket.listen(5)
            self.conn, addr = self.socket.accept()
            print 'Server Connected by', addr

        def getData(self):
            return self.data

        def getHost(self):
            return self.host

        def getPort(self):
            return self.port

        def sendMessage(self, message):
            try :
                self.conn.sendall(message)
            except socket.error:
                print 'Server Send failed'
                sys.exit()

        def receiveMessageFromClient(self):
            while 1:
                reply = self.conn.recv(4096)
                if not self.data: break
                return reply

        def receiveMessageFromServer(self):
            reply = self.socket.recv(4096)
            return reply

        def closeConnectionAsServer(self):
            self.socket.shutdown(1)
            self.socket.close()
            del self.socket

class ClientObject:    
    def __init__(self):
        self.data = str(random.choice('abcdefghil'))
        print "Client Data Random: ", self.data
        self.host = 'localhost'
        self.port = ''

    def openSocketConnectionAsClient(self):
        self.port = 50000 + random.randint(1,3)
        print "Client socket port is: ", self.port
        try:
            self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        except socket.error:
            print 'Client Failed to create socket'
            sys.exit()

        print 'Client Socket Created'

        try:
            remote_ip = socket.gethostbyname( self.host )
        except socket.gaierror:
            print 'Client Hostname could not be resolved. Exiting'
            sys.exit()

        self.socket.connect((remote_ip , self.port))

    def getData(self):
        return self.data

    def getHost(self):
        return self.host

    def getPort(self):
        return self.port

    def sendMessage(self, message):
        try :
            self.socket.sendall(message)
        except socket.error:
            print 'Client Send failed'
            os.sys.exit()

    def receiveMessageFromServer(self):
        reply = self.socket.recv(4096)
        return reply

    def closeConnection(self):
        self.socket.shutdown(1)
        self.socket.close()
        del self.socket

def clientProcess():
    print "Client Start the client process"
    client1 = ClientObject()
    for i in range(1,10): 
        try:
            print "Client try to open the connection socket: attempt number ",i
            client1.openSocketConnectionAsClient()
            print "Client connection socket established on port ", client1.getPort()
            break
        except socket.error:
            print "Client connection error on the port ", client1.getPort()
            if i == 10:
            os.sys.exit()

    print "Client send the message"
    client1.sendMessage(client1.getData())
    print "Client receive the message back"
    client1.receiveMessageFromServer()
    print "Client Data requested: ", client1.getData(), " Hostname: ", client1.getHost(), " Port: ", client1.getPort()
    print "Client Close connection"
    client1.closeConnection()

def serverProcess(port=40007):
    print "Server oject create"
    server = ServerObject(port)
    print "Server open connection as server"
    server.openSocketConnectionAsServer()
    print "Server receive the client message"
    receivedMessage = server.receiveMessageFromClient()
    message = "Server Data requested are: "+receivedMessage
    print "Server send the message back to the client"
    server.sendMessage(message)
    print "Server close the connection with the client"
    server.closeConnectionAsServer()

if __name__ == '__main__':

    threadServer = Thread(target=serverProcess, args=[50001])
    print "New Server thread created with name: ", threadServer.getName()
    threadServer.start()

    for i in range(1,3):
        threadClient = Thread(target=clientProcess)
        print "New Client thread created with name: ", threadClient.getName()
        threadClient.start()
        threadClient.join() 
```

当我运行它时，第一个客户端能够连接到服务器，第二个客户端永远不会连接，即使我在第一个客户端线程结束时关闭了连接（从服务器和客户端）。

拜托，谁能告诉我，我的代码有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:41:01.390

我**强烈**建议使用优秀的[`socketserver`](http://docs.python.org/3/library/socketserver.html#module-socketserver)模块来做这样的事情。至于您的代码，问题在于您的*线程*套接字服务器仅在单个线程中运行。至少，您应该创建一个新线程来`accept`处理`openSocketConnectionAsServer`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:40:04.003

@Ber 说的是正确但不完整的。

你的问题在这里：

```
self.socket.listen(5)
self.conn, addr = self.socket.accept() 
```

`listen`将打开端口并准备接收连接。`accept`将**等待**下一个连接。

虽然您只需要调用`listen`一次，但您必须调用`accept`多次，每次连接一次。您可以通过多种方式进行安排。对于初学者，您可以`accept`在当前连接关闭时再次调用，但这一次只允许一个客户端。最好有一个线程调用`accept`来等待下一个连接，但让它启动一个工作线程来处理每个连接。

或者您可以使用[非阻塞 I/O](https://stackoverflow.com/questions/5308080/python-socket-accept-nonblocking/5308168#5308168)，但如果您采用这种方式，请查看[Twisted](http://twistedmatrix.com/trac/)。

# jquery - 与淘汰赛 foreach 一起使用的奇怪的 jquery 移动列表视图行为

> ID：14523769
> 
> 赞同：0
> 
> 时间：2013-01-25T14:25:56.497
> 
> 标签：jquery, jquery-mobile, knockout.js

我试图使用 ko observableArray 构建一个 jQuery 移动列表视图，并发现放置在重复区域内的一些表单控制器没有按应有的方式响应用户输入。例如，在下面的代码片段中，jqm 将呈现一个翻转开关列表，但它们不会翻转！

```
<ul  data-bind="foreach: [1, 2, 3, 4]" data-role="listview"> 
    <li>
        <select class="flip-a" data-role="slider">
            <option value="on">Yes!!</option>
            <option value="off">No</option>
        </select>        
    </li>
<ul> 
```

我用一个简单的数组替换了实际的 ko observableArray，以保持代码片段很小。我已经尝试了相同的容器少绑定，发现结果与上面的示例相同。

非常感谢有人能指出我做错了什么

jsf：http: [//jsfiddle.net/Chintana/6YRtr/](http://jsfiddle.net/Chintana/6YRtr/)

先感谢您

钦塔纳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T15:11:39.647

查看[翻转切换开关文档](http://jquerymobile.com/demos/1.2.0/docs/forms/switch/)，它指出：

> 设置标签的 for 属性以匹配输入的 id，以便它们在语义上关联。如果在页面布局中不需要标签，可以将其隐藏起来，但出于语义和可访问性的原因，我们要求它出现在标记中。

不过，您将需要创建一个唯一的 ID...请注意，带有撇号的“for”是故意存在的 - 使其在较旧的 IE 版本中工作。

```
<ul data-bind="foreach: [1, 2, 3, 4]" data-role="listview"> 
    <li>
        <label class="ui-hidden-accessible" data-bind="attr: { 'for': 'flip' + $data }"></label>
        <select class="flip-a" data-role="slider" data-bind="attr: { id: 'flip' + $data }">
            <option value="on">Yes!!</option>
            <option value="off">No</option>
        </select>        
    </li>
<ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:23:57.323

在这种情况下，淘汰赛和 jqueryui mobile 之间似乎存在冲突。我认为这与事物的创建顺序有关。即首先 jqueryui mobile 看到模板并创建按钮，然后敲除复制代码四次......我认为这使得它有点欠精细......这是修复它的示例代码：

```
<ul id="list" data-bind="foreach: [1, 2, 3, 4]" data-role="listview">
    <li>
        <select class="flip-a" data-bind="attr: { 'data-role': 'slider' }" data-role='nojs'>
            <option value="on">Yes!!</option>
            <option value="off">No</option>
        </select>        
    </li>
<ul> 
```

而js...

```
ko.applyBindings();
$('#list').trigger('create'); 
```

在这种情况下，jqueryui mobile 的第一遍忽略模板（nojs 选项）。然后发生淘汰绑定，这将创建四个项目，然后我们通过调用 trigger('create') 命令强制刷新列表。因为真正的项目是绑定的，所以它们的数据角色将是“滑块”并且它们被正确转换。

在这里摆弄：http: [//jsfiddle.net/dWCDw/](http://jsfiddle.net/dWCDw/)

# c# - 在 MVC 应用程序中拒绝旧浏览器

> ID：14523773
> 
> 赞同：2
> 
> 时间：2013-01-25T14:26:22.653
> 
> 标签：c#, asp.net, asp.net-mvc, internet-explorer, asp.net-mvc-4

如果客户端是我不想支持的浏览器，我可以想出几种不同的方法来将请求重定向到我的 MVC 4 应用程序。任何人都可以建议他们认为最好的方法吗？Http 处理程序？，Global.asax 会话开始？，自定义基本控制器？还有什么？

本质上，我想将所有请求重定向到一个页面，该页面声明不支持 IE 7 及以下版本，并提供有关如何升级其浏览器的信息和超链接。

* * *

解决方案

```
 <rule name="UserAgent MSIE Rewrite" patternSyntax="ECMAScript" stopProcessing="true">
      <match url=".*" ignoreCase="true" negate="false" />
      <conditions logicalGrouping="MatchAny" trackAllCaptures="false">
        <add input="{HTTP_USER_AGENT}" pattern="MSIE 7.0b|MSIE 7.0|MSIE 6.0b|MSIE 6.0|MSIE 5.5b1|MSIE 5.5|MSIE 5.0|MSIE 5.01|MSIE 4.0" />
      </conditions>
      <action type="Redirect" url="http://ffds1.com/NotSupported.html" appendQueryString="false" redirectType="Found" />
    </rule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:29:05.853

就像您说的那样，您可以通过多种方式做到这一点，但我会创建一个[`IHttpModule`](http://msdn.microsoft.com/en-us/library/system.web.ihttpmodule.aspx)，因为它将是最干净的方式，并且可以在任何 ASP.Net 应用程序中工作。

每个请求都会运行一个模块......这正是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T16:15:15.903

另一个想法是使用 IIS [URL 重写模块](http://www.iis.net/learn/extensions/url-rewrite-module)来检查用户代理并根据需要进行重定向。但这需要 IIS 7 和如何配置 IIS URL 重写的知识。我个人没有这样做，但计划使用这种方法来解决几乎相同的问题。我喜欢这种方法的地方在于，如果需要，它可以随时更改，而无需更改 Web 应用程序或其任何底层代码。

# java - 为什么在使用 Collections.sort() 而不是 TreeSet.add(new Object()) 时出现编译时错误

> ID：14523774
> 
> 赞同：4
> 
> 时间：2013-01-25T14:26:23.580
> 
> 标签：java

为什么我可以这样做：

```
TreeSet<Object> treeSet = new TreeSet<Object>();
treeSet.add(new Object()); 
```

但不是这个：

```
final List<Object> objects = new ArrayList<Object>();
Collections.sort(objects); 
```

第一个给我一个 ClassCastException 但第二个给我一个编译错误。据我了解，两种情况下的实际问题是相同的：`java.lang.Object`没有实现**Comparable**接口。

更新：嗯，出于某种原因，这只适用于 Java 7 而不是 6。我是愚蠢还是疲倦？有人可以对此有所了解吗？

更新#2：根据java版本，我得到不同的结果。请看图片： ![在此处输入图像描述](../Images/d0c3350128f943c8f1650994a9799353.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T14:33:18.637

起初我在这里皱眉，但你是对的。

该`SortedSet`接口不强制您将其泛型类型指定为 is `Comparable`，`TreeSet`还允许您为`Comparator`不是的类型指定 a `Comparable`。编译器无法区分这两个选项。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T14:33:39.377

`Collections.sort`需要`Comparable`'s 的列表。 `TreeSet`打字没有这个限制。使用默认构造函数，文档说它按“其元素的自然顺序”排序。尚不清楚它是如何排序`Object`的，但您的问题与打字有关。

更新：我错过了问题的最后一部分。如果不查看堆栈跟踪，我猜想由于默认构造函数`TreeSet`尝试按“自然顺序”排序，因此在内部，它正在执行强制转换`Comparable`，这将导致`ClassCastException`.

更新：我仔细查看了`TreeSet`（[JDK 6](http://docs.oracle.com/javase/6/docs/api/java/util/TreeSet.html#TreeSet%28%29)，[JDK 7](http://docs.oracle.com/javase/7/docs/api/java/util/TreeSet.html#TreeSet%28%29)）的javadocs，它说

> 构造一个新的空树集，根据其元素的自然顺序排序。插入集合中的所有元素都必须实现 Comparable 接口。此外，所有此类元素必须相互比较：e1.compareTo(e2) 不得为集合中的任何元素 e1 和 e2 抛出 ClassCastException。如果用户尝试将元素添加到违反此约束的集合中（例如，用户尝试将字符串元素添加到元素为整数的集合中），则 add 调用将抛出 ClassCastException。

对彼此而言。因此，如果 JDK6 没有发生 ClassCastException，则可能是一个错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-25T14:33:59.703

因为`TreeSet<E>`不限于实现的对象，`Comparable`因为您可以通过`Comparator<E>`.

`Collections.sort(T)``T`实现的需求`Comparable`。还有另一种方法`Collections`可以接受任何对象，但您需要提供一个`Comparator`.

最后，这完全取决于您的对象是否具有自然顺序，因为它们实现`Comparable`了，或者您为对象提供了`Comparator`完成工作所必需的条件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T14:36:40.313

从 Collection 中查看 sort 函数的签名：

```
public static <T extends Comparable<? super T>> void sort(List<T> list) 
```

它期望实现 Comparable 接口的对象。这就是为什么，您的代码显示编译时错误。

但是在 Treeset 的情况下，添加的元素应该实现 Comparable 没有任何限制。它仅用于正常工作。

# elasticsearch - ElasticSearch 在过滤时将我的 _id 字段加倍

> ID：14523775
> 
> 赞同：0
> 
> 时间：2013-01-25T14:26:24.950
> 
> 标签：elasticsearch

我不明白为什么 ES 在过滤时将数组中的 _id 字段加倍。

```
curl -X GET "http://localhost:9200/pgep-development_broadcasts/broadcast/_search?pretty=true" -d '{"query":{"match_all":{}},"fields":["_id" ， “标题”]}'
{
  “接受”：7，
  “超时”：假，
  “_shards”：{
    “总数”：5，
    “成功”：5，
    “失败”：0
  },
  “命中”：{
    “总数”：1，
    “最大分数”：1.0，
    “命中”：[{
      "_index" : "pgep-development_broadcasts",
      "_type" : "广播",
      "_id" : "50ed959dcc93282abc000062",
      “_score”：1.0，
      “字段”：{
        “_id”：[“50ed959dcc93282abc000062”，“50ed959dcc93282abc000062”]，
        "title" : "24 heures d'info"
      }
    }]
  }
}

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:14:32.947

您可能遇到了这个错误[https://github.com/elasticsearch/elasticsearch/issues/2161](https://github.com/elasticsearch/elasticsearch/issues/2161)。如果是这种情况，您可以简单地停止存储 id 字段。

# android - 使用 GCM 和 PushWoosh 注册 Android 设备时收到错误消息

> ID：14523776
> 
> 赞同：1
> 
> 时间：2013-01-25T14:26:26.413
> 
> 标签：android, cordova, push-notification, google-cloud-messaging

我在使用 cordova 推送通知插件注册 Android 设备时收到以下 logcat 消息。

```
01-25 19:33:34.871: V/GCMRegistrar(6495): Is registered on server: false
01-25 19:33:34.871: D/GCMRegistrar(6495): resetting backoff for com.example.homework
01-25 19:33:34.941: V/GCMRegistrar(6495): Registering app com.example.homework of senders 19845108581
01-25 19:33:35.011: D/memalloc(6495): ashmem: Mapped buffer base:0x534bb000 size:1536000 fd:90
01-25 19:33:35.011: D/CordovaLog(6495): report:deviceready
01-25 19:33:35.011: I/Web Console(6495): report:deviceready at file:///android_asset/www/js/index.js:122
01-25 19:33:35.162: V/GCMBroadcastReceiver(6495): onReceive: com.google.android.c2dm.intent.REGISTRATION
01-25 19:33:35.162: V/GCMBroadcastReceiver(6495): GCM IntentService class: com.arellomobile.android.push.PushGCMIntentService
01-25 19:33:35.172: V/GCMBaseIntentService(6495): Acquiring wakelock
01-25 19:33:35.192: D/GCMBaseIntentService(6495): handleRegistration: registrationId = null, error = SERVICE_NOT_AVAILABLE, unregistered = null
01-25 19:33:35.192: D/GCMBaseIntentService(6495): Registration error: SERVICE_NOT_AVAILABLE
01-25 19:33:35.192: I/GCMIntentService(6495): Received recoverable error: SERVICE_NOT_AVAILABLE
01-25 19:33:35.192: D/GCMBaseIntentService(6495): Scheduling registration retry, backoff = 2788 (3000)
01-25 19:33:35.192: D/Socket_Alarm(6495): registerHTCSocketMonitorCallBack
01-25 19:33:35.192: D/Socket_Alarm(6495): set mSocketMonitor
01-25 19:33:35.192: D/Socket_Alarm(6495): HTCSocketMonitorImpl::HTCSocketMonitorImpl
01-25 19:33:35.352: V/GCMBaseIntentService(6495): Releasing wakelock
01-25 19:33:36.603: D/DroidGap(6495): onMessage(spinner,stop)
01-25 19:35:03.978: V/webview(6495): hitTestResult use fallback 
```

我在 javascript 文件中为 projectid 和 appid 设置了正确的值。而且我的安卓设备也配置了谷歌账户。我正在关注本指南 [http://www.pushwoosh.com/programming-push-notification/android-gcm-push-notifications-guide/](http://www.pushwoosh.com/programming-push-notification/android-gcm-push-notifications-guide/)

任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-14T07:24:10.233

我遇到了和你一样的问题，检查你的设备的互联网连接。它可能很慢，如果是，它没有将 ua 设备连接到 GCM 服务器。

# winapi - 如何在 Windows 7 上以编程方式自定义文件夹

> ID：14523777
> 
> 赞同：3
> 
> 时间：2013-01-25T14:26:33.333
> 
> 标签：winapi

Windows 7 提供了自定义文件夹图标和图片的可能性，方法是右键单击文件夹，选择“属性”命令，然后选择“自定义”选项卡，如此[处](http://www.howtogeek.com/63359/how-to-customize-folder-backgrounds-and-icons-in-windows-explorer/)所述。

这可以以编程方式完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-14T12:33:29.787

`desktop.ini`是的，您可以通过编程方式创建文件。该文件记录[在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/cc144102%28v=vs.85%29.aspx)。

例如，您可以通过创建具有以下内容的文件来重命名国际化场景中的文件夹（例如，在法语操作系统上，我可以将名为“users”的文件夹显示给用户作为*utilisateurs*，或者在德语操作系统上作为*Benutzer*显示给用户） ：

```
[.ShellClassInfo]
LocalizedResourceName=@C:\foo\bar.dll,-100 
```

这将采用`bar.dll`字符串资源 ID 100 中的文件夹名称。

# php - Websocket php服务器中的循环速度

> ID：14523779
> 
> 赞同：2
> 
> 时间：2013-01-25T14:26:42.633
> 
> 标签：php, phpwebsocket

我使用以下 websocket php 类作为我的服务器：[PHPWebSocket](https://github.com/Flynsarmy/PHPWebSocket-Chat/blob/master/class.PHPWebSocket.php)。它在我希望的每一个方面都运作良好，但我遇到了一些问题。

我想以每 0.3 秒的速度更新已连接客户端的位置（他们可以四处走动）。我认为寻找while循环并在那里添加心跳事件是一件简单的事情，但在这里它变得很棘手。

```
 // server state functions
function wsStartServer($host, $port) {
    if (isset($this->wsRead[0])) return false;

    if (!$this->wsRead[0] = socket_create(AF_INET, SOCK_STREAM, SOL_TCP)) {
        return false;
    }
    if (!socket_set_option($this->wsRead[0], SOL_SOCKET, SO_REUSEADDR, 1)) {
        socket_close($this->wsRead[0]);
        return false;
    }
    if (!socket_bind($this->wsRead[0], $host, $port)) {
        socket_close($this->wsRead[0]);
        return false;
    }
    if (!socket_listen($this->wsRead[0], 10)) {
        socket_close($this->wsRead[0]);
        return false;
    }

    $this->log("Server starting");

    $write = array();
    $except = array();

    $nextPingCheck = time() + 1;
    while (isset($this->wsRead[0])) {

        $changed = $this->wsRead;
        $result = socket_select($changed, $write, $except, 1);
                     **beat()**
        if ($result === false) {
            socket_close($this->wsRead[0]);
            return false;
        }
        elseif ($result > 0) {
            foreach ($changed as $clientID => $socket) {
                if ($clientID != 0) {
                    // client socket changed
                    $buffer = '';
                    $bytes = @socket_recv($socket, $buffer, 4096, 0);

                    if ($bytes === false) {
                        // error on recv, remove client socket (will check to send close frame)
                        $this->wsSendClientClose($clientID, self::WS_STATUS_PROTOCOL_ERROR);
                    }
                    elseif ($bytes > 0) {
                        // process handshake or frame(s)
                        if (!$this->wsProcessClient($clientID, $buffer, $bytes)) {
                            $this->wsSendClientClose($clientID, self::WS_STATUS_PROTOCOL_ERROR);
                        }
                    }
                    else {
                        // 0 bytes received from client, meaning the client closed the TCP connection
                        $this->wsRemoveClient($clientID);
                    }
                }
                else {
                    // listen socket changed
                    $client = socket_accept($this->wsRead[0]);
                    if ($client !== false) {
                        // fetch client IP as integer
                        $clientIP = '';
                        $result = socket_getpeername($client, $clientIP);
                        $clientIP = ip2long($clientIP);

                        if ($result !== false && $this->wsClientCount < self::WS_MAX_CLIENTS && (!isset($this->wsClientIPCount[$clientIP]) || $this->wsClientIPCount[$clientIP] < self::WS_MAX_CLIENTS_PER_IP)) {
                            $this->wsAddClient($client, $clientIP);
                        }
                        else {
                            socket_close($client);
                        }
                    }
                }
            }
        }

        if (time() >= $nextPingCheck) {
            $this->wsCheckIdleClients();
            $nextPingCheck = time() + 1;
        }
    }

    return true; // returned when wsStopServer() is called
} 
```

对我来说，似乎没有任何特定的计时器说它应该每秒只运行一次，但确实如此。我不是在谈论 ping 检查，即使我在 while (isset($this->wsRead[0])) { 之后直接发出我的心跳调用，它也只会每秒触发一次，这让我完全被难住了。

我找错地方了吗？PHP 的 websocket 实现是否会减慢这个 while 循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:45:32.007

您的[socket_select](http://php.net/manual/en/function.socket-select.php)调用中有一秒钟的超时 - 这可能是您的延迟被引入的地方。如果您希望该调用是非阻塞的，您可以为该超时传递一个零。

# sql - 有任何适用于 Eclipse 的 SQL 格式化程序插件吗？

> ID：14523783
> 
> 赞同：6
> 
> 时间：2013-01-25T14:26:51.677
> 
> 标签：sql, sql-server, eclipse, formatting

我在网上找不到任何标准的开源 sql formatter eclipse 插件。我正在使用日食 helios。我可以找到**Edit-->FormatSQL**但这似乎不起作用。[在http://ventralnet.blogspot.in/2010/11/sql-beautifier-eclipse-plugin.html](http://ventralnet.blogspot.in/2010/11/sql-beautifier-eclipse-plugin.html)找到一个， 但格式不好。任何建议都会有所帮助。有关信息，我正在使用 sqlserver sql 脚本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-29T08:08:34.867

[Toad eclipse-extension](http://www.toadworld.com/products/toad-extension-for-eclipse/default.aspx)（社区版），几乎可以在 SQL 编辑器中为您提供所需的一切，包括格式化 (ctrl+shif+f)。在日食市场搜索“蟾蜍”。它有很好的 Oracle、MySQL 和 PostgreSQL 支持。

查看[安装说明和屏幕截图](http://www.toadworld.com/products/toad-extension-for-eclipse/w/wiki/10446.toad-extension-for-eclipse-installation.aspx)。

另一种选择是[http://dbeaver.jkiss.org/download/#eclipse](http://dbeaver.jkiss.org/download/#eclipse)（非常好，也有独立版本）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T16:11:34.937

我最喜欢的一些是：

```
Eclipse SQL Explorer at: http://eclipsesql.sourceforge.net

DBViewer at: http://www.ne.jp/asahi/zigen/home/plugin/dbviewer/about_en.html 
```

# c# - 将 wav 转换为 mp3

> ID：14523786
> 
> 赞同：0
> 
> 时间：2013-01-25T14:27:10.413
> 
> 标签：c#, .net, mono, converter

我尝试使用 C# 和 Mono 将 .wav 文件转换为 .mp3 文件。

我发现[这个链接](http://www.codeproject.com/Articles/8544/Aumplib-C-Namespace-And-Classes-For-Audio-Conversi)可能会有所帮助。

当我使用以下代码进行转换时，我错过了*libsndfile.dll*。所以我搜索了我的硬盘驱动器并找到了它，但使用它我得到的消息是它不是一个有效的 .NET 程序集。

```
 AumpelWrapper wrapper = new AumpelWrapper ();
_wrapper.Convert (filePath, (int)SoundFormat.WAV, targetPath, (int)SoundFormat.MP3); 
```

是否有另一种方法可以将 wav 转换为 mp3 或者我需要另一个库，这样可以吗？

我想在我们公司使用它，所以它需要许可。

# forms - 带有dirtyforms jQuery插件的DropDownList

> ID：14523788
> 
> 赞同：0
> 
> 时间：2013-01-25T14:27:21.010
> 
> 标签：forms, kendo-ui, jquery-dirtyforms

我想使用 jQuery 插件dirtyForms 来检查我的表单是否脏。但看起来 DropDownList 不是基于标准的 select HTML 标签。相反，它似乎正在使用

*   HTML 标记。为什么选择这个？因此，当我只更改 DropDownList 值时，jquery 插件dirtyForms 不会将我的表单设置为脏...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:41:50.630

我对 kendo-ui 或 dirtyForms 一无所知，所以我会尽力通过查看 API 来回答这个问题。kendo-ui DropDownList 有一个[`change`事件](http://docs.kendoui.com/api/web/dropdownlist#change)，看起来只有在 DropDownList 中的输入更改时才会触发。此外，dirtyForms 可以[手动将表单设置为 dirty](https://github.com/snikch/jquery.dirtyforms#public-methods)。将两者放在一起，我想以下应该可行。

```
$("#dropdownlist").kendoDropDownList({
    change: function(e) {
        $('form').dirtyForms('setDirty');
    }
}); 
```

编辑：由于您似乎希望这影响所有 DropDownList，您可以执行以下操作。

```
kendo.ui.DropDownList.fn._change = function(e) {
    if(this.element && this.element.form)
        $(this.element.form).dirtyForms('setDirty');
} 
```

这似乎有点骇人听闻，但我不确定我是否会推荐这样做。它可能会破坏其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-21T16:59:35.000

这听起来像是在[拉取请求 27](https://github.com/snikch/jquery.dirtyforms/pull/27)中修复的错误，它允许跨浏览器与选择元素兼容。

或者，可能是您没有正确忽略页面上所有在其标记中[具有锚元素](https://github.com/snikch/jquery.dirtyforms#default-anchor-ignoring-behavior)[的第 3 方小部件。](https://github.com/snikch/jquery.dirtyforms#ignoring-things)

# android - 设置壁纸

> ID：14523789
> 
> 赞同：0
> 
> 时间：2013-01-25T14:27:23.467
> 
> 标签：android, wallpaper

我试图将我的位图图像设置为墙纸！

我目前正在使用此代码来完成它。

```
 WallpaperManager wpm = WallpaperManager.getInstance(this);

            float minH =  wpm.getDesiredMinimumHeight();
            float minW =  wpm.getDesiredMinimumWidth();
            Log.d("seb", minH + " = Min Height");
            Log.d("seb", minW + " = Min Width");
            targetBitmap = Bitmap.createScaledBitmap(targetBitmap,(int)minW, (int)minH, false);         
            wpm.setBitmap(targetBitmap); 
```

有用！手机会自动调整位图的大小以适应屏幕，但不管我的位图有多小，它总是水平裁剪并放大。

有谁知道如何解决这一问题？

*（一个解决方法是在周围放置一个黑色边框并裁剪它们而不是实际图片，尽管我猜有更好的选择）*

**编辑**

![这是原图](../Images/1a4ab1ea8709a74037dde3726f6fc886.png)

这是代码中的原始图片。

下图是我设置为墙纸时裁剪的意思：

![裁剪图片](../Images/7ecc251ea8c9a0db4622074f5ee63607.png)

即使我调整图像大小，这也是一样的，因为系统会自动放大图片以适应整个屏幕

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T08:44:51.337

好的，所以在我们在“评论”中讨论之后，这是一个可行的解决方案。

试试看：

```
public Bitmap getResizedBitmap(Bitmap bm, int newHeight, int newWidth) {

    int width = bm.getWidth();

    int height = bm.getHeight();

    float scaleWidth = ((float) newWidth) / width;

    float scaleHeight = ((float) newHeight) / height;

// create a matrix for the manipulation

    Matrix matrix = new Matrix();

    // resize the bit map

    matrix.postScale(scaleWidth, scaleHeight);

// recreate the new Bitmap

    Bitmap resizedBitmap = Bitmap.createBitmap(bm, 0, 0, width, height, matrix, false);

    return resizedBitmap;

} 
```

试试看，如果您有相同（或其他）问题，请告诉我，我们会尽力解决。

# .net - 静态内容客户端缓存设置

> ID：14523795
> 
> 赞同：3
> 
> 时间：2013-01-25T14:27:35.930
> 
> 标签：.net, iis, web-config

我已将以下内容添加到我的 web.config 以启用 14 天的图像缓存。

```
 <location path="Images">
    <system.webServer>
      <staticContent>
        <clientCache cacheControlMaxAge="14.00:00:00" cacheControlMode="UseMaxAge" />
      </staticContent>
    </system.webServer>
  </location> 
```

使用 F12 工具在 chrome 中查看时，我可以看到当我刷新时浏览器似乎仍然从服务器请求图像。它得到了 304，所以不再下载它，但在页面刷新等时，每张图片似乎仍然是一次浪费之旅。

这是正确的行为还是应该像我预期的那样根据文件的标头从缓存中提取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:43:11.823

缓存控制是服务器端的，而不是客户端的。所以浏览器仍然需要向服务器请求文件并让服务器`304`知道它应该使用它的缓存副本。

考虑在下面的 HTML 中（无论图像是否设置为从缓存返回都完全相同），浏览器如何知道是下载图像还是使用缓存版本？

```
<img src="somefile.jpg" /> 
```

客户端不知道，因为它不像服务器在呈现给浏览器的标签上设置某种`cache-image="true"`属性。`img`

# ms-access - 简单的 VBA 数学

> ID：14523796
> 
> 赞同：1
> 
> 时间：2013-01-25T14:27:41.183
> 
> 标签：ms-access, vba

我正在尝试将一个字段的值添加到另一个字段的值。例如，字段 A 的值为 10，字段 B 的值为 5。我想做 A(10 + B(5) = C(15.

我试过以下...

```
Me.FieldC.Value = Nz([FieldA], 0) + Nz([FieldB], 0) 
```

然而，我很快就发现该方法不适用于保持运行总数。

所以发生的情况是，字段 A 需要是用户在字段 B 中输入的总和。因此，例如，假设字段 A 从 0 开始。用户来了一个多头并在字段 B 中输入 5 并点击确认。字段 A 现在应该变为 5。如果有人来在字段 B 中输入 100，则字段 A 应该变为 105。

这非常简单，我可能只是忽略了解决方案，但任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:30:25.510

我对VBA不太了解，但是：

```
Me.FieldC.Value = CInt(Me.FieldA.Value) + CInt(Me.FieldB.Value) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:42:51.667

我。**FieldA** .Value = Nz([FieldA], 0) + Nz([FieldB], 0) 应该这样做

# java - 如何使 Seam Validation 在 Java EE 容器之外工作？

> ID：14523797
> 
> 赞同：2
> 
> 时间：2013-01-25T14:27:45.030
> 
> 标签：java, seam, hibernate-validator

我想使用[Hibernate Validator 的方法参数验证功能](http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#validator-customoptions-methodvalidation "Hibernate Validator 方法参数验证")。从我在文档中读到的内容来看，Hibernate Validator 只是提供了一个 API，我需要[Seam Validation](http://www.seamframework.org/Seam3/ValidationModule)`@AutoValidating`的注释才能使事情正常进行。

但是，我想在 Java EE 容器之外使用 methd 参数验证，用于普通方法，例如在实用程序类中。

什么设置才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T08:44:57.947

为了使用方法验证，您需要某种容器来创建和管理您的对象，但它不一定是 Java EE。

如果你在 Java SE 中运行，你可以使用 CDI 和 Seam Validation（CDI 参考实现[Weld](http://www.seamframework.org/Weld)可以在 SE 上使用）或者 Spring 框架，[这篇文章](http://hillert.blogspot.de/2011/12/method-validation-with-hibernate.html)给出了很好的概述。

在 GitHub 上，您还可以找到[我的一个项目](https://github.com/gunnarmorling/methodvalidation-integration)，展示了方法验证与 Google Guice 以及 JDK 动态代理的集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T21:14:49.203

可以在成熟的 Java EE 容器之外构建基于 Seam 的应用程序，例如使用 Tomcat 等 Web 容器。但无论如何，Seam至少*必须*在一个 Web 容器中运行，你不能在外部将它用于独立应用程序（毕竟 Seam 是一个*Web 应用程序*框架）。如果您只需要验证，请考虑使用更简单的方法 - 例如，尝试 Apache 的[commons validator](https://commons.apache.org/validator/)。

# .net - 类库中具有服务引用的 Excel 加载项无法连接

> ID：14523798
> 
> 赞同：2
> 
> 时间：2013-01-25T14:27:52.630
> 
> 标签：.net, wcf, excel, installation, class-library

我在 Visual Studio (c#) 中创建了一个 Excel 2010 VSTO 插件。加载项使用具有对 wcf 服务的服务引用的类库。加载项项目中也引用了相同的 wcf-service。我还使用此白皮书[http://msdn.microsoft.com/en-us/library/ff937654.aspx创建了一个设置项目](http://msdn.microsoft.com/en-us/library/ff937654.aspx)

这在我调试时工作正常。Excel 启动，我可以单步执行代码并调用 wcf 服务。设置似乎也按预期工作，加载项在 excel 中注册，所有不需要 wcf 服务的功能都在工作。

但是，当尝试使用需要 wcf-service 的功能时，我收到以下错误：

> 在 ServiceModel 客户端配置部分中找不到引用合同“PurchOrder.POrderService”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。

由于我在加载项项目中具有相同的服务引用，因此 app-config 包含端点配置。当我查看安装程序创建的文件时，dll.config 文件也包含这些端点配置。

我已经尽可能多地搜索了这个问题，并且发布了几个类似的问题，但我似乎找不到解决方案。

任何帮助将不胜感激！

更新：我尝试从 vsto 文件手动安装加载项。这很好用，所以问题一定出在安装项目上。

# matlab - FreeMat：它与 Octave 有何不同？

> ID：14523803
> 
> 赞同：8
> 
> 时间：2013-01-25T14:28:11.493
> 
> 标签：matlab, octave, freemat

一直在寻找 MatLab 的替代品...发现在 Octave 上工作非常困难...缺少 MatLab 的调试功能...遇到 FreeMat...想知道 FreeMat 与 Octave 有何不同...只是像 QtOctave 一样的 Octave 图形前端（我还没有探索）还是不止于此？它提供了哪些附加功能？什么会更好地利用时间 - 投资 FreeMat 或 makign 使用 QtOctave 之类的工具使用 Octave （matlab 不是一个选项）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-27T15:21:54.960

简而言之，GNU Octave 和 FreeMat 都是 MATLAB 的开源替代品。但是，Octave 更成熟，拥有更广泛的社区支持。

我还发现了这篇比较 MATLAB、Octave、FreeMat 和 SciLab 的[有趣文章。](http://userpages.umbc.edu/~gobbert/papers/SharmaGobbertTR2010.pdf)它确实指出了一些针对 FreeMat 的问题：

1.  它不支持某些功能（例如[`kron`](http://www.mathworks.com/help/matlab/ref/kron.html)和[`pcg`](http://www.mathworks.com/help/matlab/ref/pcg.html)）。
2.  它具有有限的 3-D 图形功能（*例如*不支持该[`mesh`](http://www.mathworks.com/help/matlab/ref/mesh.html)功能）。
3.  ODE 部门也缺乏它，因为没有最先进的求解器。

本质上，这篇文章得出的结论是，Octave 确实是目前与 MATLAB 最兼容的。

现在，如果您正在寻找一个好的 GUI/IDE，请尝试其中[之一](http://en.wikipedia.org/wiki/GNU_Octave#User_interfaces)。

# php - 使用 ajax 调用更改 url

> ID：14523804
> 
> 赞同：0
> 
> 时间：2013-01-25T14:28:15.287
> 
> 标签：php, jquery, ajax, get, cross-domain

我正在做跨域 GET 以获得这样的 cnn html：

```
$(function(){

var site = 'http://cnn.com';

$.get('proxy.php', { site:site }, function(data){

$(data).appendTo('#div');

}, 'html');

}); 
```

我得到了我需要的一切，除了 url 有时不是完整的 url，而是指向服务器上的某个路径，如下所示：

```
/2013/01/24/business/samsung-record-fourth-quarter-2012-profits/index.html?hpt=hp_t3 
```

所以问题是，如果有人点击我网站上的链接，网址将如下所示：

```
http://MY-WEBSITE/2013/01/24/business/samsung-record-fourth-quarter-2012-profits/index.html?hpt=hp_t3 
```

如何摆脱插入我自己的 url 并将其替换为“cnn.com”？我尝试了 jquery 拆分和替换，但它不起作用：

```
href = $(this).prop('href');
url = href.split('/');          
href.replace(url[2], 'cnn.com'); 
```

我通常在控制台“未定义拆分”中收到错误，当我修复它时，错误会转移到“未定义 url”等等。有时（使用其他代码变体）我没有收到任何错误，但它仍然不起作用。我想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:39:35.523

查看您的代码，我假设您正在使用 jQuery。

出现问题是因为 cnn.com 上的源代码似乎使用了相对链接。您可以使用以下 jQuery 在开头插入 cnn.com

```
$(function() {
    $('a').each(function() {
        if ($(this).attr('href').indexOf('http') === 0) {
            $(this).attr('href', 'http://www.cnn.com' + this.href);
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:33:15.770

您可以简单地检查 url 是否是相对的。最简单的方法是检查它是否以`http://`.

```
var url = $(this).prop('href');
if (!(/^http/).test(url)) 
{
    url = site + url; // prepend "http://cnn.com" to the address
}

alert(url); // url is now a full url 
```

如果您想要更通用的解决方案，可以使用站点上的 regexp 对象来确定前缀是否存在。

```
var site = "http://cnn.com";
var siteRegex = new RegExp("^" + site); // Regex - Starts with site
var url = $(this).prop('href');
if (!siteRegex.test(url))
{
   url = site + url;
}

alert(url); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:35:01.803

这个小功能可以通用：

```
function RelativeToAbsoluteURL(root, url) {
    var httpMatch = /https?:\/\//ig;
    if (!httpMatch.test(url)) {
        return root + (url.substr(0, 1) != "/" ? "/" + url : url);
    } else {
        return url;
    }
} 
```

利用：

```
RelativeToAbsoluteURL("http://www.cnn.com", "http://www.cnn.com/2013/01/24/business/samsung-record-fourth-quarter-2012-profits/index.html?hpt=hp_t3");

RelativeToAbsoluteURL("http://www.cnn.com", "/2013/01/24/business/samsung-record-fourth-quarter-2012-profits/index.html?hpt=hp_t3"); 
```

两者都将输出相同的 URL ( `http://www.cnn.com/2013/01/24/business/samsung-record-fourth-quarter-2012-profits/index.html?hpt=hp_t3`)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:31:47.433

[演示](http://jsfiddle.net/mplungjan/TWK7r/)

两者似乎都有效：

```
var href = $(this).attr('href');
var url = (href.indexOf("/")===0) ? "http://...."+href:href; 
```

可能的替代方法 - 这将返回来自 href 的完全限定 URL

```
var href = this.href; // actual href and not the property
var url =(href.indexOf(location.hostname)===7) ? href.replace(location.hostname,"www.cnn.com"):href; 
```

使用道具

```
var href = $(this).prop('href');
var url = (href.indexOf("/")===0) ? "http://...."+href:href; 
```

# html - CSS3 渐变：如何制作 1px 宽的线条

> ID：14523808
> 
> 赞同：3
> 
> 时间：2013-01-25T14:28:29.240
> 
> 标签：html, css

我想制作一个由 1px 线组成的 CSS3 渐变。

我怎样才能做到这一点？

我试过下面的代码，但是产生的渐变太厚了：

```
background-image: linear-gradient(left , rgb(255,255,255) 50%, rgb(209,209,209) 50%, rgb(255,255,255) 51%); 
```

（见[这里](http://jsfiddle.net/KRvER/)）

如何使线条更小，使其只有 1px 宽？百分比值似乎控制了线条的位置，但无论我如何调整它们，我都无法将其设置为 1px 宽！

（本质上，我使用该行作为“假列”背景[即在视觉上分离左列和右列。（虽然，为了保持 jsFiddle 简单，我删除了列）] 我知道还有其他方法做专栏，但这种方法最适合我的情况）

编辑：澄清一下，这是一个稍微奇怪的用例，其中宽度必须为 100%，并且不能使用伪元素。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:32:08.183

```
/* Opera Mobile */
background: -o-linear-gradient(left, #d1d1d1 1px, white 1px);
/* Firefox for Android */
background: -moz-linear-gradient(left, #d1d1d1 1px, white 1px);
/* WebKit browsers */
background: -webkit-linear-gradient(left, #d1d1d1 1px, white 1px);
/* new syntax: IE10, Firefox, Opera */
background: linear-gradient(90deg, #d1d1d1 1px, white 1px);
background-position: 100% 0;
background-repeat: repeat-y;
background-size: 50%; 
```

## [**演示**](http://jsfiddle.net/Ff8E2/1/)

[我在演示中使用`2px`而不是因为不可见。我只在 Chrome 中测试过。]`1px``1px`

您应该**始终将无前缀版本放在最后**。没有必要`-ms-linear-gradient`。IE10 现在支持不带前缀的标准语法，而 IE9 根本不支持渐变。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-18T14:09:42.143

如果您不关心 IE8（如果您使用渐变，则可能不关心）您可以使用 calc()。

```
background-image: linear-gradient(left, transparent 50%, rgb(255,255,255) 50%, rgb(255,255,255) calc(50% + 1px), transparent calc(50% + 1px)); 
```

这适用于任何宽度元素，而仅使用百分比将分解更小和更宽的元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-26T02:45:33.363

```
.style {        
    background-image: -o-linear-gradient(left , rgb(255,255,255) 50%, rgb(209,209,209) 50%, rgb(255,255,255) 50.5%);
    background-image: -moz-linear-gradient(left , rgb(255,255,255) 50%, rgb(209,209,209) 50%, rgb(255,255,255) 50.5%);
    background-image: -webkit-linear-gradient(left , rgb(255,255,255) 50%, rgb(209,209,209) 0%, rgb(255,255,255) 50.5%);
    background-image: linear-gradient(left , rgb(255,255,255) 50%, rgb(209,209,209) 50%, rgb(255,255,255) 50.5%);
} 
```

您不是在处理像素，而是在使用百分比。所以宽度的 1%，必须是 200，是 2px。（我认为这就是为什么[它](http://jsfiddle.net/nulref/rZck9/ "这")有效，也许我错了。）你可以使用百分比小数，所以 0.5% == 1px。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-28T11:51:10.297

我之前用过这个，根据你的需要改变它。我的意思是根据需要更改颜色和角度

```
background-image: liner-gradient(to bottom, white, white 14%,blue 1%,white 15%); 
```

# jquery - 使用 jQuery UI Slider 更改 setInterval() 的值

> ID：14523810
> 
> 赞同：0
> 
> 时间：2013-01-25T14:28:46.530
> 
> 标签：jquery, jquery-ui, settimeout

我该怎么做呢？我有以下代码可以更改背景图像：

```
var alt = false;
    var delay = 5000;
    var speed = ((delay / 3)*2);
    var opacity = 1;

    $( "#slider" ).slider({
        orientation: "vertical", 
        range: "true", 
        min: 500, 
        max: 10000, 
        value: delay,
        change: function( event, ui ) {
            delay = ui.value;
        }
    });

    setInterval(function() {
    var r=Math.floor(Math.random()*b.length);
    console.log(delay);
    switch(alt)
    {   case true:
            $('#bg1').css("background-image", "url('"+b[r]+"')");
            $('#bg1').fadeTo(speed,opacity);
            $('#bg2').fadeOut(speed);
        break;
        case false:
            $('#bg2').css("background-image", "url('"+b[r]+"')");
            $('#bg2').fadeTo(speed,opacity);
            $('#bg1').fadeOut(speed);
        break;
    }
    alt = !alt;
    }, delay); 
```

更改滑块应该会更改变量，但不会。我不知道如何更改名为`delay`.

**编辑** 现在我正在尝试这个，但它也不起作用，当我移动滑块时它会改变一次：

```
var alt = false;
            var delay = 1000;
            var speed = ((delay / 3)*2);
            var opacity = 1;
            var h;

            function iSwap() {
                var r=Math.floor(Math.random()*b.length);
                console.log(delay);
                switch(alt)
                {   case true:
                        $('#bg1').css("background-image", "url('"+b[r]+"')");
                        $('#bg1').fadeTo(speed,opacity);
                        $('#bg2').fadeOut(speed);
                    break;
                    case false:
                        $('#bg2').css("background-image", "url('"+b[r]+"')");
                        $('#bg2').fadeTo(speed,opacity);
                        $('#bg1').fadeOut(speed);
                    break;
                }
                alt = !alt;
            }

            h = setInterval(iSwap(), delay);
            $( "#slider" ).slider({
                orientation: "vertical", 
                range: "true", 
                min: 500, 
                max: 10000, 
                value: delay,
                change: function( event, ui ) {
                    delay = ui.value;
                    clearInterval(h);
                    h = setInterval(iSwap(), delay);
                }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:37:18.973

`setInterval(...)`更改变量后，您必须再次调用，如下所示（截断）

```
var handle;
/* -- snip -- */
change: function( event, ui ) {
   delay = ui.value;
   clearInterval(handle);
   handle = setInterval( /* -- snip -- */ , delay);
}
/* -- snip -- */
handle = setInterval( /* -- snip -- */ , delay) 
```

理想情况下，为了减少冗余代码，您必须将其中的一部分放在命名函数中并调用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:36:51.837

尝试这个：

```
$("#slider").slider({
  orientation: "vertical",
  range: "true",
  min: 500,
  max: 10000,
  value: delay,
  slide: function (event, ui) {
    $("#amount").val(ui.value);
    delay = ui.value
    console.log(delay);
  }
}); 
```

[演示在这里](http://jsfiddle.net/2XNjq/1/)

# .net - HttpWebRequest 未发送所有 cookie

> ID：14523811
> 
> 赞同：2
> 
> 时间：2013-01-25T14:28:48.310
> 
> 标签：.net, vb.net, cookies, httpwebrequest

我正在尝试让我的应用程序在外部网站上执行登录操作。我使用以下代码：

```
Dim enc As Encoding = Encoding.UTF8
    Dim Data As Byte() = Nothing
    Dim req As HttpWebRequest

    req = CType(Net.WebRequest.Create(URL), Net.HttpWebRequest)
    req.Method = method
    req.CookieContainer = CookieJar

    req.AllowAutoRedirect = False
    If method = "POST" Then
        req.ContentType = "application/x-www-form-urlencoded"
        Data = enc.GetBytes(PostData)
        If Data.Length > 0 Then
            req.ContentLength = Data.Length
            Dim newStream As Stream = req.GetRequestStream()
            newStream.Write(Data, 0, Data.Length)
            newStream.Flush()
            newStream.Close()
        End If
    End If

    Dim Response As Net.HttpWebResponse = CType(req.GetResponse(), Net.HttpWebResponse)

    Dim ResponseStream As IO.StreamReader = New IO.StreamReader(Response.GetResponseStream(), enc)
    Dim Html As String = ResponseStream.ReadToEnd()

    Response.Close()
    ResponseStream.Close()

    Return Html 
```

什么有效：

*   响应具有所有正确的“Set-Cookie”标头
*   容器保存所有正确的 cookie（总共 5 个）

什么不起作用：

*   容器正在正确检索所有 cookie。但并非所有 cookie 都会随下一个请求一起发送。4 个 cookie 设置正确，但最重要的一个没有发送。

未发送的 cookie 是这个：

```
Set-Cookie: mpSecurity="ODc2NzM2ODoxMzUODViNTg5OWM1NTNlOWMwYmMxYjUxNWZjYzJjOGQyZGU4MTc2M2M=";Version=1;Path=/;Domain=.xxxxx.nl;Discard 
```

此 cookie 与正确发送的 cookie 之间的唯一区别在于，此 cookie 中包含“Version=1”和“Discard”...

有谁知道为什么所有检索到的 cookie 都被发送，除了上面的那个吗？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:06:45.643

这是 CookieContainer 中常见的已知错误：[此处链接](https://stackoverflow.com/questions/1047669/cookiecontainer-bug) ***.Net 版本低于 4.0***

注意 Set-Cookie Header 的域：

```
Cookie # 1 -> Set-Cookie: mpSecurity="ODc2NzM2ODoxMzUODViNTg5OWM1NTNlOWMwYmMxYjUxNWZjYzJjOGQyZGU4MTc2M2M=";Version=1;Path=/;Domain=marktplaats.nl;Discard
Cookie # 2 -> Set-Cookie: mpSecurity="ODc2NzM2ODoxMzUODViNTg5OWM1NTNlOWMwYmMxYjUxNWZjYzJjOGQyZGU4MTc2M2M=";Version=1;Path=/;Domain=.marktplaats.nl;Discard 
```

Cookie #1 在 URL 格式类似`http://marktplaats.nl/...`
时发送 Cookie #2 在 URL 格式类似时发送`http://www.marktplaats.nl/...`

## 因此问题

* * *

### 这里的解决方案＃1：（更好更简单的）

```
 class DomainComparer : StringComparer
    {
        public override int Compare(string x, string y)
        {
            if (x == null || y == null)
            {
                return StringComparer.OrdinalIgnoreCase.Compare(x, y);
            }
            if (x.StartsWith("www.", StringComparison.OrdinalIgnoreCase))
            {
                x = x.Substring(4);
            }
            if (y.StartsWith("www.", StringComparison.OrdinalIgnoreCase))
            {
                y = y.Substring(4);
            }
            return StringComparer.OrdinalIgnoreCase.Compare(x, y);
        }

        public override bool Equals(string x, string y)
        {
            return Compare(x, y) == 0;
        }

        public override int GetHashCode(string obj)
        {
            if (obj.StartsWith("www.", StringComparison.OrdinalIgnoreCase))
            {
                obj = obj.Substring(4);
            }
            return StringComparer.OrdinalIgnoreCase.GetHashCode(obj);
        }
    }

    /// <summary>
    /// this is a hackfix for microsoft bug, where cookies are not shared between www.domain.com and domain.com
    /// </summary>
    /// <param name="cc"></param>
    static void ImproveCookieContainer(ref CookieContainer cc)
    {
        Hashtable table = (Hashtable)cc.GetType().InvokeMember(
            "m_domainTable",
            System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.GetField | System.Reflection.BindingFlags.Instance,
            null, cc, new object[] { });
        var comparerPreperty = table.GetType().GetField("_keycomparer", 
            System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.GetField | System.Reflection.BindingFlags.Instance);
        if (comparerPreperty != null)
        {
            comparerPreperty.SetValue(table, new DomainComparer());
        }
    } 
```

解决方案＃1的实现，每当您创建CookieContainer的实例时，只需调用一次该方法

```
void main()
{
    CookieContainer cookieJar = new CookieContainer();
    ImproveCookieContainer(ref cookieJar);
    // then use it with the WebRequest object
} 
```

* * *

### 这里的解决方案＃2：

1.  不要使用 .Add(Cookie)，仅使用 .Add(Uri, Cookie) 方法。
2.  每次向容器添加 cookie 或在使用 .GetCookie 之前或系统使用容器之前调用 BugFix_CookieDomain。

    ```
    private void BugFix_CookieDomain(CookieContainer cookieContainer)
    {
        System.Type _ContainerType = typeof(CookieContainer);
        Hashtable table = (Hashtable)_ContainerType.InvokeMember("m_domainTable",
                                   System.Reflection.BindingFlags.NonPublic |
                                   System.Reflection.BindingFlags.GetField |
                                   System.Reflection.BindingFlags.Instance,
                                   null,
                                   cookieContainer,
                                   new object[] { });
        ArrayList keys = new ArrayList(table.Keys);
        foreach (string keyObj in keys)
        {
            string key = (keyObj as string);
            if (key[0] == '.')
            {
                string newKey = key.Remove(0, 1);
                table[newKey] = table[keyObj];
            }
        }
    } 
    ```

[CallMeLaNN](https://stackoverflow.com/questions/1047669/cookiecontainer-bug)解决方案的所有功劳

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-29T19:42:18.873

**决定为此/类似情况发布另一个解决方法，以防有人发现它有用。**

我遇到了同样的问题，收到了三个 cookie，只有两个显示为从下一个 Web 请求发送。我做了一些调试，发现对我来说错误不是域本身，正如前面的答案所暗示的那样——在我的情况下，问题是*返回的第三个 cookie 并没有在后续请求中重用是在 HTTPS 重定向上设置的*，并且它的“安全”属性设置为真。所以***我所要做的就是将下一个请求 url 从 http://.... 更改为 https://....***，然后所有 cookie 都被发送过来，一切正常。

希望它可以帮助某人！

# java - （持久性）无法创建实体管理器

> ID：14523812
> 
> 赞同：1
> 
> 时间：2013-01-25T14:28:49.103
> 
> 标签：java, servlets, jpa, persistence

我遇到了这个问题，两天后我不知道为什么会这样。我想验证登录。我的代码：

```
public String Verify(String name, String password) {
String admin="";
    Query q = emf
            .createEntityManager()
            .createQuery(
                    "SELECT u FROM user u where u.name = :name and u.password=:password");
    q.setParameter("name", name);
    q.setParameter("password", password);
    User u = (User) q.getSingleResult();

    if (u.getAdmin().equalsIgnoreCase("yes")) {
        admin = "yes";
    } else {
        admin = "no";
    }

    return admin;
} 
```

然后我收到此错误：

```
java.lang.NullPointerException
at db.DbProcessor.Verify(DbProcessor.java:19)
at controller.VerifikoServlet.doGet(VerifikoServlet.java:25)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:722) 
```

第 19 行是“.createEntityManager()”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T09:56:49.157

我解决了为初始化实体工厂管理器编写此问题的问题：

```
private static EntityManagerFactory factory = Persistence
        .createEntityManagerFactory("PROJECT_NAME");
EntityManager em = factory.createEntityManager(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:45:29.010

问题是你没有初始化你的`EntityManagerFactory`. 如我所见，您正在 Servlet 环境中运行。

看看这个链接，它可能对你有用：[http ://weblogs.java.net/blog/ss141213/archive/2005/12/dont_use_persis_1.html](http://weblogs.java.net/blog/ss141213/archive/2005/12/dont_use_persis_1.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-27T08:47:51.993

如果加载的持久层不是这个东西我们可以通过简单的添加下面的代码来验证：~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～最终 EntityManagerFactory 电动势；

```
static {
    try {
        factory = Persistence.createEntityManagerFactory("MyPu");
    } catch (Throwable ex) {
        logger.error("Initial SessionFactory creation failed", ex);
        throw new ExceptionInInitializerError(ex);
    }
} 
```

...

}

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ~~~~~~~~~~~~~~~~~~~~~~~~

请不要这是获取实体管理器工厂对象的常见内容。但这里重要的是里面的异常处理，即 ExceptionInInitializerError ...

这将清楚地说明是否存在与您的 Entity 类相关的任何问题，例如 Date 类型变量缺少 TemporalType 或类似的问题。

因此，如果假设您在实体类中使用 NamedQuery，但由于实体类中缺少任何类型或必需的属性（如日期类型的 TemoralType），持久性将无法加载它。

所以确保你处理提到的异常

# mysql - 将数据 Infile @variable 加载到 infile 错误中

> ID：14523816
> 
> 赞同：14
> 
> 时间：2013-01-25T14:29:06.403
> 
> 标签：mysql

我想在 Load data Infile 中使用一个变量作为文件名。我运行以下代码：

```
Set @d1 = 'C:/Users/name/Desktop/MySQL/1/';
Set @d2 = concat( @d1, '20130114.txt');
load data local infile  @d2  into table Avaya_test (Agent_Name, Login_ID,ACD_Time); 
```

不幸的是，运行后，出现如下注释错误：“错误代码：1064。您的 SQL 语法有错误......”

此代码中变量“@D2”带有下划线，表示此错误是由该变量引起的。

您能帮我如何在 LOAD DATA @variable infile 中正确定义文件名变量吗？

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-21T21:00:31.330

来自[MySQL 文档](http://dev.mysql.com/doc/refman/5.7/en/load-data.html)的引用：

> 文件名必须以文字字符串的形式给出。在 Windows 上，将路径名中的反斜杠指定为正斜杠或双反斜杠。character_set_filesystem 系统变量控制文件名的解释。

这意味着它不能是准备好的语句、存储过程或任何“服务器端”的参数。字符串/路径评估必须在客户端完成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-13T11:46:08.900

一般来说，这是不可能的，但您可以使用临时文件。

该过程类似于使用 PREPARE-EXECUTE 组合。请注意，您不能将 PREPARE 与 LOAD DATA INFILE 一起使用，因此您需要一个临时文件。

这是一个如何读取具有今天日期的文件的示例：

```
SET @sys_date = CURRENT_DATE();

SET @trg_file = CONCAT("LOAD DATA INFILE '/home/data/file-",@sys_date, "' INTO TABLE new_data FIELDS TERMINATED BY ' ';");

SELECT @trg_file INTO OUTFILE '/tmp/tmp_script.sql';

SOURCE /tmp/tmp_script.sql; 
```

> **警告：**您不能用 mysql 覆盖文件，因此临时文件不能存在。如果你想自动化前面的例子，这是一个严重的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-14T01:48:57.300

不幸的是，这在 mysql 中似乎是不可能的。

除了[Binary Alchemist 的](https://stackoverflow.com/users/1877173/binary-alchemist) [回答](https://stackoverflow.com/a/18367603/3530316)之外，预配对语句也不可能，因为它不在此列表中：[SQL Syntax Allowed in Prepared Statements](http://dev.mysql.com/doc/refman/5.7/en/sql-syntax-prepared-statements.html#idm47797791067520)

您可以使用 soemthing external 来生成您的 load data infile 语句，然后运行 ​​sql。例如，您可以在 Excel 中创建它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-11T04:10:18.107

这个 sysntax 不能工作，因为变量是由服务器解释的，而文件是由 mysql 客户端读取的。因此对于客户端@d2 是非法文件名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-30T11:46:05.093

我的解决方案适用于 Linux/Mac/[Windows with bash]（例如 cygwin）

使用加载 SQL创建一个**模板****`%FILENAME%`**，例如 load.tpl -- 注意占位符

```
LOAD DATA LOCAL INFILE '/path/to/data/%FILENAME%'
INTO TABLE Avaya_test ( Agent_Name, Login_ID, ACD_Time ); 
```

然后运行这个命令：

```
for n in `ls *.txt`; do echo $n; sed -e 's/%FILENAME%/'$n'/g' load.tpl | mysql -u databaseUser databaseName; done 
```

# html - 将复杂的 FLASH 动画迁移到 HTML5

> ID：14523817
> 
> 赞同：1
> 
> 时间：2013-01-25T14:29:09.250
> 
> 标签：html, flash, migration

所以让我们开始吧。我必须估计一个项目的主要目标是从 FLASH 交互式和复杂动画迁移到 HTML5。

据我所知，有很多问题如何做到这一点......所以我研究过有用于 CreateJS 和在线转换器的 Swiffy / Wallaby / Adob​​e Flash Professional Toolkit 和这里是但是......但是很多人说它不会处理更复杂的 FLASH 动画（只有简单的动画）。

所以问题是：有人有过这种迁移的经验吗，有没有一种非手动的方式来做呢？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:30:46.237

是的，对于大多数包含一些 ActionScript 的 Flash 动画以及一组有限的更具交互性的应用程序，有一种非手动方式来执行此操作。如果您首先关心的是轻松，请尝试最新版本的[Swiffy](https://www.google.com/doubleclick/studio/swiffy/)（当您写问题时和本回复时为 5.0）。Swiffy 支持[大量的 ActionScript 3 功能集，](https://www.google.com/doubleclick/studio/swiffy/actionscript3.html)对于导航控件来说绰绰有余。

缺点：

*   活泼程度可能不令人满意；我对一些简单的游戏转换的功能很满意，但它们很慢。
*   最终产品是 SVG，因此您还必须应对不受支持的浏览器。
*   可能需要先对原住民进行艺术品更改，然后再重新出口。否则，您可以编辑大量 JSON 配置（并观看它爆炸）。
*   您可能需要深入了解声音（我使用 SoundManager2）。

我对 Wallaby/CreateJS 工作流程不太熟悉，但从 Flash 导出期间的 ActionScript 支持极为有限。本质上，它使您能够导出资产库以在 JavaScript 端与 CreateJS 一起使用。

# c# - 不返回 1/5 cookie，C# 短而甜的代码：RichTextBox，Form1_Load，使用 System.Net / System.Collections.Specialized

> ID：14523820
> 
> 赞同：0
> 
> 时间：2013-01-25T14:29:20.127
> 
> 标签：c#, .net, http, cookies

```
 private void Form1_Load(object sender, EventArgs e)
   {
       string site = "https://signin.ebay.com/ws/eBayISAPI.dll?co_partnerId=2&siteid=0&UsingSSL=1&MfcISAPICommand=SignInWelcome&userid=USERNAME&pass=PWD&sngBt=Sign%20in";
       CookieContainer cookieJar = new CookieContainer();

       HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(site);
       request.CookieContainer = cookieJar;

       HttpWebResponse response = (HttpWebResponse)request.GetResponse();
       System.IO.StreamReader sr = new System.IO.StreamReader(response.GetResponseStream());

       richTextBox1.Text = sr.ReadToEnd();
       foreach (Cookie c1 in response.Cookies)
       {
           richTextBox1.AppendText(c1.Name.ToString() + "\n\n");
       }
   } 
```

我一直在搞乱提琴手和标题 2 天，没有比这更好的了。请帮我找回最后一个 cookie。在浏览器中，该 URL 将使您正确登录（分别更改 USERNAME 和 PWD），并返回 ds2、ebay、dp1、cssg、非会话 cookie.. 代码缺少 ebay cookie。

请求标头：

客户

接受：text/html,application/xhtml+xml,application/xml;q=0.9, */* ;q=0.8

接受字符集：ISO-8859-1,utf-8;q=0.7,*;q=0.3

接受编码：gzip、deflate、sdch

接受语言：en-US,en;q=0.8

用户代理：Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko)

铬/24.0.1312.56 Safari/537.17

运输

连接：保持活动

主机：signin.ebay.com

```
 private void Form1_Load(object sender, EventArgs e)
   {
       string site = "https://signin.ebay.com/ws/eBayISAPI.dll?co_partnerId=2&siteid=0&UsingSSL=1&MfcISAPICommand=SignInWelcome&userid=USERNAME&pass=PWD&sngBt=Sign%20in";
       CookieContainer cookieJar = new CookieContainer();

        HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(site);
        request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
        request.Headers.Add("Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3");
        request.Headers.Add("Accept-Encoding: gzip,deflate,sdch");
        request.Headers.Add("Accept-Language: en-US,en;q=0.8");
        request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.56 Safari/537.17";

        request.CookieContainer = cookieJar;

       HttpWebResponse response = (HttpWebResponse)request.GetResponse();
       System.IO.StreamReader sr = new System.IO.StreamReader(response.GetResponseStream());

       richTextBox1.Text = sr.ReadToEnd();
       foreach (Cookie c1 in response.Cookies)
       {
           richTextBox1.AppendText(c1.Name.ToString() + "\n\n");
       }
   } 
```

提琴手不会带我走吗？这不返回任何来源，但确实返回 ebay cookie..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T17:16:04.437

最后好，

```
class Program
{

    static void Main(string[] args)
    {
        CookieContainer cookieJar = new CookieContainer();
        HTTP http = new HTTP(cookieJar);
        string user = "this is not my username";
        string pass = "this is not my password";

        //some cookies are set before login & they are needed for an user to login, for that reason only you were getting the error
        string responseData = http.DownloadString("https://signin.ebay.com/ws/eBayISAPI.dll?SignIn");

        string midParamValue = ParseMid(responseData, "name=\"mid\" id=\"mid\" value=\"", "\"");
        string bUrlPrfx = ParseMid(responseData, "id=\"bUrlPrfx\" value=\"", "\"");
        string rqid = ParseMid(responseData, "id=\"bUrlPrfx\" value=\"", "\"");
        string pdata =
            string.Format(
                "MfcISAPICommand=SignInWelcome&bhid=a1%253Dna%7Ea2%253Dna%7Ea3%253Dna%7Ea4%253DMozilla%7Ea5%253DNetscape%7Ea6%253D5.0%2520%28Windows%29%7Ea7%253D20100101%7Ea8%253Dna%7Ea9%253Dtrue%7Ea10%253DWindows%2520NT%25206.1%253B%2520WOW64%7Ea11%253Dtrue%7Ea12%253DWin32%7Ea13%253Dna%7Ea14%253DMozilla%252F5.0%2520%28Windows%2520NT%25206.1%253B%2520WOW64%253B%2520rv%253A18.0%29%2520Gecko%252F20100101%2520Firefox%252F18.0%7Ea15%253Dfalse%7Ea16%253Den-US%7Ea17%253Dna%7Ea18%253Dsignin.ebay.com%7Ea19%253Dna%7Ea20%253Dna%7Ea21%253Dna%7Ea22%253Dna%7Ea23%253D1366%7Ea24%253D768%7Ea25%253D24%7Ea26%253D738%7Ea27%253Dna%7Ea28%253DFri%2520Jan%252025%25202013%252022%253A20%253A09%2520GMT%252B0530%2520%28India%2520Standard%2520Time%29%7Ea29%253D5.5%7Ea30%253Dpdf%257Cpdf%257Cpdf%257C%7Ea31%253Dyes%7Ea32%253Dna%7Ea33%253Dna%7Ea34%253Dno%7Ea35%253Dno%7Ea36%253Dyes%7Ea37%253Dno%7Ea38%253Donline%7Ea39%253Dno%7Ea40%253DWindows%2520NT%25206.1%253B%2520WOW64%7Ea41%253Dno%7Ea42%253Dno%7Ea43%253D&UsingSSL=1&inputversion=2&lse=true&lsv=11.5.502&mid=AQAAAThpCRHvAAUxMzg5OTM0YzA2MS5hNWFiODMyLjJmNDcyLmZmZTlhOWUwEZMPFiRFo7yUjykHfCAFgp%2Bk9%2Bk*&kgver=1&kgupg=1&kgstate=r&omid=&hmid=&rhr=f&siteid=0&co_partnerId=2&ru=&pp=&pa1=&pa2=&pa3=&i1=-1&pageType=-1&rtmData=&bUrlPrfx={0}&rqid={1}&kgct=&userid={2}&pass={3}&keepMeSignInOption=1&sgnBt=Sign+in&htmid={4}&kdata=%251E%251F%2510%251E1359132609409%251E1%251F%2510%251E1359132609409%251E0%251F%2510%251E1359132609410%251E1%251F%2510%251E1359132609410%251E0%251F%251B%251E1359132612808%251E1%251F%2510%251E1359132612837%251E1%251F%2510%251E1359132612838%251E0%251F%251B%251E1359132612977%251E0%251F", bUrlPrfx, rqid, user,pass, midParamValue);
        responseData =
            http.UploadString("https://signin.ebay.com/ws/eBayISAPI.dll?co_partnerId=2&siteid=0&UsingSSL=1", pdata);

        PrintAllCookies(cookieJar);
        Console.Read();

    }

    private static void PrintAllCookies(CookieContainer cookies)
    {
        Hashtable table = (Hashtable)cookies.GetType().InvokeMember("m_domainTable",
                                                                     BindingFlags.NonPublic |
                                                                     BindingFlags.GetField |
                                                                     BindingFlags.Instance,
                                                                     null,
                                                                     cookies,
                                                                     new object[] { });

        foreach (string key in table.Keys)
        {
            foreach (Cookie cookie in cookies.GetCookies(new Uri(string.Format("http://{0}/", key.StartsWith(".", StringComparison.Ordinal) ? "www" + key : key))))
            {
                Console.WriteLine("Name = {0} ; Value = {1} ; Domain = {2}", cookie.Name, cookie.Value,
                                  cookie.Domain);
            }
        }
    }

    public static string ParseMid(string text, string firstString, string lastString)
    {

        string str = text;
        int pos1 = str.IndexOf(firstString, StringComparison.Ordinal) + firstString.Length;
        int pos2 = str.IndexOf(lastString, pos1 + 1, StringComparison.Ordinal);
        string finalString = str.Substring(pos1, pos2 - pos1);
        return finalString;
    } 
} 
```

您将需要一个我使用的类，它是一个支持 CookieContainer 的简单 WebClient

输出 ：

![所有 cookie 的输出](../Images/3be49a377a31e451dacef59dcaeff020.png)

> 当我使用我的用户名登录时，已将 cookie 值打印为“无”：P

* * *

HTTP.cs

```
public class HTTP : WebClient
{
    public HTTP()
        : this(new CookieContainer())
    { }

    public HTTP(CookieContainer c)
    {
        CookieContainer = c;
    }
    public CookieContainer CookieContainer { get; set; }

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);

        var castRequest = request as HttpWebRequest;
        if (castRequest != null)
        {
            castRequest.CookieContainer = CookieContainer;
            castRequest.ServicePoint.Expect100Continue = false;
            castRequest.ContentType = "application/x-www-form-urlencoded";
        }

        return request;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:38:42.783

命名空间观察者 { 公共部分类 Form1 : Form { 公共 Form1() { InitializeComponent(); }

```
 private void Form1_Load(object sender, EventArgs e)
    {
        CookieContainer cookieJar = new CookieContainer();
        HTTP http = new HTTP(cookieJar);
        string user = "id";
        string pass = "password";

        //some cookies are set before login & they are needed for an user to login, for that reason only you were getting the error
        string responseData = http.DownloadString("https://signin.ebay.com/ws/eBayISAPI.dll?SignIn");

        string midParamValue = ParseMid(responseData, "name=\"mid\" id=\"mid\" value=\"", "\"");
        string bUrlPrfx = ParseMid(responseData, "id=\"bUrlPrfx\" value=\"", "\"");
        string rqid = ParseMid(responseData, "id=\"bUrlPrfx\" value=\"", "\"");
        string hidUrl = ParseMid(responseData, "name=\"hidUrl\" value=\"", "\""); //"name=\"hidUrl\" value="http://my.ebay.com/ws/eBayISAPI.dll?MyeBay"
        //string lucky9 = ParseMid(responseData, 
        string pdata =
            string.Format(
                "MfcISAPICommand=SignInWelcome&bhid=a1%253Dna%7Ea2%253Dna%7Ea3%253Dna%7Ea4%253DMozilla%7Ea5%253DNetscape%7Ea6%253D5.0%2520%28Windows%29%7Ea7%253D20100101%7Ea8%253Dna%7Ea9%253Dtrue%7Ea10%253DWindows%2520NT%25206.1%253B%2520WOW64%7Ea11%253Dtrue%7Ea12%253DWin32%7Ea13%253Dna%7Ea14%253DMozilla%252F5.0%2520%28Windows%2520NT%25206.1%253B%2520WOW64%253B%2520rv%253A18.0%29%2520Gecko%252F20100101%2520Firefox%252F18.0%7Ea15%253Dfalse%7Ea16%253Den-US%7Ea17%253Dna%7Ea18%253Dsignin.ebay.com%7Ea19%253Dna%7Ea20%253Dna%7Ea21%253Dna%7Ea22%253Dna%7Ea23%253D1366%7Ea24%253D768%7Ea25%253D24%7Ea26%253D738%7Ea27%253Dna%7Ea28%253DFri%2520Jan%252025%25202013%252022%253A20%253A09%2520GMT%252B0530%2520%28India%2520Standard%2520Time%29%7Ea29%253D5.5%7Ea30%253Dpdf%257Cpdf%257Cpdf%257C%7Ea31%253Dyes%7Ea32%253Dna%7Ea33%253Dna%7Ea34%253Dno%7Ea35%253Dno%7Ea36%253Dyes%7Ea37%253Dno%7Ea38%253Donline%7Ea39%253Dno%7Ea40%253DWindows%2520NT%25206.1%253B%2520WOW64%7Ea41%253Dno%7Ea42%253Dno%7Ea43%253D&UsingSSL=1&inputversion=2&lse=true&lsv=11.5.502&mid=AQAAAThpCRHvAAUxMzg5OTM0YzA2MS5hNWFiODMyLjJmNDcyLmZmZTlhOWUwEZMPFiRFo7yUjykHfCAFgp%2Bk9%2Bk*&kgver=1&kgupg=1&kgstate=r&omid=&hmid=&rhr=f&siteid=0&co_partnerId=2&ru=&pp=&pa1=&pa2=&pa3=&i1=-1&pageType=-1&rtmData=&bUrlPrfx={0}&rqid={1}&kgct=&userid={2}&pass={3}&keepMeSignInOption=1&sgnBt=Sign+in&htmid={4}&kdata=%251E%251F%2510%251E1359132609409%251E1%251F%2510%251E1359132609409%251E0%251F%2510%251E1359132609410%251E1%251F%2510%251E1359132609410%251E0%251F%251B%251E1359132612808%251E1%251F%2510%251E1359132612837%251E1%251F%2510%251E1359132612838%251E0%251F%251B%251E1359132612977%251E0%251F", bUrlPrfx, rqid, user, pass, midParamValue);
        responseData =
            http.UploadString("https://signin.ebay.com/ws/eBayISAPI.dll?co_partnerId=2&siteid=0&UsingSSL=1", pdata);
        richTextBox1.Text = responseData;

        PrintAllCookies(cookieJar);
    }
    private void PrintAllCookies(CookieContainer cookies)
    {
        Hashtable table = (Hashtable)cookies.GetType().InvokeMember("m_domainTable",
                                                                     BindingFlags.NonPublic |
                                                                     BindingFlags.GetField |
                                                                     BindingFlags.Instance,
                                                                     null,
                                                                     cookies,
                                                                     new object[] { });

        foreach (string key in table.Keys)
        {
            foreach (Cookie cookie in cookies.GetCookies(new Uri(string.Format("http://{0}/", key.StartsWith(".", StringComparison.Ordinal) ? "www" + key : key))))
            {
                richTextBox1.AppendText("Name = " + cookie.Name.ToString() + " Value = " + cookie.Value.ToString() + "Domain = " + cookie.Domain.ToString() + "\n\n");
            }
        }
    }

    public string ParseMid(string text, string firstString, string lastString)
    {

        string str = text;
        int pos1 = str.IndexOf(firstString, StringComparison.Ordinal) + firstString.Length;
        int pos2 = str.IndexOf(lastString, pos1 + 1, StringComparison.Ordinal);
        string finalString = str.Substring(pos1, pos2 - pos1);
        return finalString;
    }
    public class HTTP : WebClient
    {
        public HTTP()
            : this(new CookieContainer())
        { }

        public HTTP(CookieContainer c)
        {
            CookieContainer = c;
        }
        public CookieContainer CookieContainer { get; set; }

        protected override WebRequest GetWebRequest(Uri address)
        {
            WebRequest request = base.GetWebRequest(address);

            var castRequest = request as HttpWebRequest;
            if (castRequest != null)
            {
                castRequest.CookieContainer = CookieContainer;
                castRequest.ServicePoint.Expect100Continue = false;
                castRequest.ContentType = "application/x-www-form-urlencoded";
                //castRequest.AllowAutoRedirect = true;
                castRequest.Headers.Add("Cache-Control", "max-age=0");
                castRequest.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
                castRequest.Headers.Add("Accept-Charset", "ISO-8859-1,utf-8;q=0.7,*;q=0.3");
                //castRequest.Headers.Add("Accept-Encoding", "gzip,deflate,sdch");
                castRequest.Headers.Add("Accept-Language", "en-US,en;q=0.8");
                castRequest.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.57 Safari/537.17";

                castRequest.Headers.Add("Origin", "https://signin.ebay.com");
                castRequest.Referer = "https://signin.ebay.com/ws/eBayISAPI.dll?SignIn";
                castRequest.KeepAlive = true;
                castRequest.Host = "signin.ebay.com";
            }

            return request;
        }
    }
}
} 
```

我添加了更多标头，数据包看起来类似于正常的登录数据包，但仍然在 lucky9 或 url 重定向时出错？我不确定是否要进一步解决此问题.. 我尝试使用 &ru=http%3A%2F%2Fmy.ebay.com%2Fws%2FeBayISAPI.dll%3FMyEbayBeta%26MyeBay%3D%26guest%3D1&pageType 修改网址=3984 标头，但它什么也没做。其他人将不得不帮助完成最后一步。

```
<script type="text/javascript" src="https://secureir.ebaystatic.com/v4js/z/i5/r32gctn0fu3vjkpge2mjhij3q.js#SYS-ZAM_vjo_e809_1_Ear_en_US"></script>
<script type="text/javascript">vjo.dsf.error.ErrorHandlerManager.register(new vjo.dsf.error.DefaultErrorHandler());
vjo.dsf.error.ErrorHandlerManager.enableOnError(true, false);
vjo.dsf.cookie.VjCookieJar.sCookieDomain = '.ebay.com';vjo.dsf.cookie.VjCookieJar.writeCookielet('ebay','js','1');
</script>
<script language="JavaScript">window.location="http://my.ebay.com/ws/eBayISAPI.dll?MyEbayBeta&MyeBay=&guest=1"</script>
<div class="pagewidth">
    <div class="pageminwidth">
        <div class="pagelayout">
            <div class="pagecontainer">
                <div class="GlobalNavigation" id="GlobalNavigation"><div><script type="text/javascript">var _GlobalNavHeaderUtf8Encoding=true,includeHost='https://secureinclude.ebaystatic.com/';</script>

                <div class="CentralArea" id="CentralArea"><div>      <form name="AlertSuppressor" method="post"><input type="hidden" name="hidUrl" value="http://my.ebay.com/ws/eBayISAPI.dll?MyEbayBeta&amp;MyeBay=&amp;guest=1"></form>      <noscript><meta http-equiv="Refresh" content="0; url = http://my.ebay.com/ws/eBayISAPI.dll?MyEbayBeta&amp;MyeBay=&amp;guest=1"></noscript>
<b>If you are seeing this page, your browser settings prevent you from automatically redirecting to a new URL.</b></td></tr></table>
<div class="buttonDiv_space"><a href="http://my.ebay.com/ws/eBayISAPI.dll?MyEbayBeta&amp;MyeBay=&amp;guest=1">Continue</a>
<div class="SupportiveNavigation" id="SupportiveNavigation">
<script type="text/javascript">vjo.dsf.cookie.VjCookieJar.writeCookieEx("lucky9", "8067469", 730);
</script> 
```

名称=易趣价值=###

名称 = dp1 值 = ###

名称 = cssg 值 = ###

名称 = s 值 = ###

名称 = 非会话值 = ###

名称 = cid 值 = ###

名称 = ds1 值 = ###

名称 = ns1 值 = ###

名称 = 秒值 = ###

名称 = shs 值 = ###

# python - Python Tkinter 类继承问题

> ID：14523822
> 
> 赞同：0
> 
> 时间：2013-01-25T14:29:22.380
> 
> 标签：python, oop, class, inheritance, tkinter

我正在尝试在 Tkinter 中操作列表框，但遇到了一些麻烦。我曾经把所有东西都放在一个课上，在一页上，而且效果很好。我将这些方法分成两个不同页面上的不同类（一个用于显示内容，一个用于修改它们），现在我遇到了一些问题。

我收到以下错误**AttributeError: Actions has no attribute 'listbox'**。我假设它与继承有关，因为在我将其拆分为两个文件之前它运行良好。

这是第一个文件

```
from Tkinter import *
import Tkinter
import SortActions

class MakeList(Tkinter.Listbox):

    def BuildMainWindow(self):
        menubar = Frame(relief=RAISED,borderwidth=1)
        menubar.pack()

        mb_file = Menubutton(menubar,text='file')
        mb_file.menu = Menu(mb_file)
        mb_file.menu.add_command(label='open', command = self.BuildListbox)
        mb_file.pack(side=LEFT)

        mb_edit = Menubutton(menubar,text='edit')
        mb_edit.menu = Menu(mb_edit)
        mb_edit.pack(padx=25,side=RIGHT)

        mb_file['menu'] = mb_file.menu
        mb_edit['menu'] = mb_edit.menu
        return 

    def BuildListbox(self):
        self.listbox = Tkinter.Listbox()
        index = SortActions.Actions()
        self.listbox.bind('<<ListboxSelect>>', index.GetWindowIndex)
        MoveItem = SortActions.Actions()
        self.listbox.bind('<B1-Motion>', index.MoveWindowItem)
        for item in ["one", "two", "three", "four"]:
            self.listbox.insert(END, item)    
        self.listbox.insert(END, "a list entry")
        self.listbox.pack()
        #print self.listbox.get(0, END)
        return

if __name__ == '__main__':
    start = MakeList()
    start.BuildMainWindow()
    mainloop() 
```

第二个文件，我遇到的问题

```
from FileSort import MakeList

class Actions(MakeList):

    #gets the current item that was clicked in the window
    def GetWindowIndex(self, event):
        w = event.widget
        self.curIndex = int(w.curselection()[0])

    #moves the current item in the window when clicked/dragged
    def MoveWindowItem(self, event):
        i = self.listbox.nearest(event.y) #here is where the error is occurring 
        print i 
```

我假设因为我继承了 MakeList 类，所以我应该可以访问。我也尝试过更改它，所以我直接访问了 MakeList（一个对象），但不是说“Actions instance has no...”的错误，而是说“MakeList has no attribute...”

我之前发布了一些东西，但我不小心运行了旧版本的代码，所以我引用了错误的错误。对不起，如果你看到了那个帖子。现在没了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:38:25.057

在我看来，动作没有理由在课堂上......

```
#SortActions.py

#gets the current item that was clicked in the window
def GetWindowIndex(self, event):
    w = event.widget
    self.curIndex = int(w.curselection()[0])

#moves the current item in the window when clicked/dragged
def MoveWindowItem(self, event):
    i = self.nearest(event.y) #here is where the error is occurring 
    print i 
```

现在您可以使用以下操作：

```
 ...
   def BuildListbox(self):
        #self.listbox = Tkinter.Listbox()  #??? This has no master widget ...
        #Since this is already a listbox, there's no point in building another ...

        self.bind('<<ListboxSelect>>', lambda e:SortActions.GetWindowIndex(self,e))

        self.bind('<B1-Motion>', lambda e:SortActions.MoveWindowItem(self,e)
        for item in ("one", "two", "three", "four"):
            self.insert(END, item)    
        self.insert(END, "a list entry")
        self.pack() 
```

# mercurial - 当客户端“未找到更改”时，Mercurial 在服务器上运行挂钩

> ID：14523826
> 
> 赞同：0
> 
> 时间：2013-01-25T14:29:30.727
> 
> 标签：mercurial

每当客户端推送或拉取并获得“未找到更改”时，是否有破解或出路在服务器上运行挂钩。无论存储库是否已更改，我都希望能够在客户端的 pull 上运行脚本。

目前，在所有情况下都可以轻松使用标准挂钩（`pretxnchangegroup`、`changegroup`等），但在没有更改时不会触发它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T15:43:06.720

钩子将无法完成您正在寻找的事情。在服务器端运行的钩子都是由事物（变更集或按钮）的到来触发的。没有服务器端的钩子用于*空无到达*或从不发送东西的命令（`incoming`,`outgoing`等）。

我试过的一个远射**没有**用是用`post-serve`钩子。当客户端通过 ssh 连接到远程存储库时，它确实`hg serve`在该客户端上运行，所以我希望`post-serve`钩子会在 ssh 会话结束时执行，但没有这样的运气（实际上该钩子可能根本不存在） .

幸运的是，除了钩子之外，还有一些其他的黑客选项。对于您通过 ssh 访问的存储库，您可以更改`.ssh/authorized-keys`文件以强制执行某些命令：

```
command="/home/me/hg_and_somethingelse.sh" ssh-rsa AAAA.... 
```

那么`/home/me/hg_and_something_else.sh`你会有：

```
#!/bin/bash
hg $@
echo ANY COMMAND FROM HERE ONWARD IS RUN FOR EVERY PUSH, PULL, CLONE, etc. 
```

与 http 服务的存储库类似，您只需在[您正在使用的 wsgi 文件](http://www.selenic.com/repo/hg-stable/file/692cbda1eb50/contrib/hgweb.wsgi)末尾添加任何您想要的内容。

需要注意的是，有很多工具（例如 IDE）经常检查更改，因此您的脚本将比您想象的更频繁地运行。

# syntax - VHDL If 语句语法错误

> ID：14523828
> 
> 赞同：1
> 
> 时间：2013-01-25T14:29:38.167
> 
> 标签：syntax, syntax-error, vhdl

我有以下代码：

```
process(value_counter, hex5_value)
    begin
        if(value_counter <= x"0F") then
            with value_counter select hex4 <=  --error on this line
            "0111111" when x"00", 
            "0000110" when x"01", 
            "1011011" when x"02", 
            "1001111" when x"03", 
            "1100110" when x"04", 
            "1101101" when x"05", 
            "1111101" when x"06", 
            "0000111" when x"07", 
            "1111111" when x"08", 
            "1101111" when x"09",
            "1110111" when x"0A", 
            "1111100" when x"0B",
            "0111001" when x"0C", 
            "1011110" when x"0D",
            "1111001" when x"0E", 
            "1110001" when x"0F";

            hex5<="0111111";
        elsif(value_counter > x"0F") then
            with value_counter mod 10 select hex4 <=
            "0111111" when x"00", 
            "0000110" when x"01", 
            "1011011" when x"02", 
            "1001111" when x"03", 
            "1100110" when x"04", 
            "1101101" when x"05", 
            "1111101" when x"06", 
            "0000111" when x"07", 
            "1111111" when x"08", 
            "1101111" when x"09",
            "1110111" when x"0A", 
            "1111100" when x"0B",
            "0111001" when x"0C", 
            "1011110" when x"0D",
            "1111001" when x"0E", 
            "1110001" when x"0F";

            with hex5_value select hex5 <=
            "0111111" when x"00", 
            "0000110" when x"01", 
            "1011011" when x"02", 
            "1001111" when x"03",
            "1100110" when x"04", 
            "1101101" when x"05", 
            "1111101" when x"06", 
            "0000111" when x"07", 
            "1111111" when x"08", 
            "1101111" when x"09",
            "1110111" when x"0A", 
            "1111100" when x"0B",
            "0111001" when x"0C", 
            "1011110" when x"0D",
            "1111001" when x"0E", 
            "1110001" when x"0F";
        end if;
end process; 
```

但我在运行它时在指示的行上收到以下错误：`Error (10500): VHDL syntax error at xxx near text "with"; expecting "end", or "(", or an identifier ("with" is a reserved keyword), or a sequential statement`. 任何人都知道是什么原因造成的，以及我如何合法且等效地重写它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:09:24.453

“正确”答案是进程内的 CASE 语句或组合区域（即进程外）中的“with ... select”。

但是，如果您创建了一个包含 16 个 7 段显示值的常量数组，并简单地为该数组编制索引，您将拥有更好的 VHDL：

```
subtype seven_seg is std_logic_vector(6 downto 0);

constant decode : array 0 to 15 of seven_seg := (
            "0111111", "0000110", "1011011", "1001111", 
            "1100110", "1101101", "1111101", "0000111", 
            "1111111", "1101111", "1110111", "1111100",
            "0111001", "1011110", "1111001", "1110001");

    process(value_counter, hex5_value)
        begin
            if value_counter <= x"0F" then
                hex4 <= decode(to_integer(value_counter(3 downto 0)));
                hex5 <= decode(0);
            -- elsif value_counter > x"0F" then  
            -- surely this "elsif" is unnecessary!
            else 
                hex4 <= decode(to_integer(value_counter(7 downto 4)));
                hex5 <= decode(to_integer(hex5_value(3 downto 0)));
            end if;
    end process; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:44:10.883

带有 'with' 的信号赋值是一个并发语句。所以它在进程内无效。一个“案例”可以做到。但是当情况变得安静时，请检查时序分析的结果。

有关更多语法信息，请参阅[此链接](http://www.iis.ee.ethz.ch/~zimmi/download/vhdl93_syntax.html#pred197)。

# java - 使用 FlexJSON 反序列化多对一关系

> ID：14523831
> 
> 赞同：0
> 
> 时间：2013-01-25T14:29:43.043
> 
> 标签：java, spring, deserialization, flexjson

我正在向我的 Web 应用程序（使用 Spring）添加 RESTful 支持，因此我可以执行这样的 CRUD 操作：阅读有关参与者的信息（JSONSerialize）：

```
$ curl -i -H "Accept: application/json" http://localhost:8080/dancingwithstars/participant/1
{
    "birthDate": "2013-01-23",
    "code": "JS0001",
    "firstName": "Julia",
    "mainFunction": {
        "code": "AA"
        "name": "Principal Dancer"
    },
    "gender": "F",
    "height": 160.00,
    "id": 1,
    "lastName": "Smith",
    "version": 1,
    "weight": 55.00
} 
```

或者创建一个新的参与者（JSONDeserialize）

```
$ curl -i -X POST -H "Content-Type: application/json" -H "Accept: application/json" -d '{"birthDate":"2013-01-15","code":"AT0001","firstName":"Angela","mainFunction":{"code": "AB", "name":"Choreografer"},"gender":"F","height":189.00,"lastName":"Wright","version":0,"weight":76.00}' http://localhost:8080/dancingwithstars/participants 
```

但问题是，我不需要知道 mainFunction 对象的所有字段来创建参与者我只需要知道唯一的代码。对于序列化，我可以使用：

```
return new JSONSerializer().include("mainFunction.code").exclude("mainFunction.*").exclude("*.class").transform(new DateTransformer("yyyy-MM-dd"), Date.class).prettyPrint(true).serialize(this); 
```

我得到以下json：

```
{
    "birthDate": "2013-01-23",
    "code": "JS0001",
    "firstName": "Julia",
    "mainFunction": {
        "code": "AA"
    },
    "gender": "F",
    "height": 160.00,
    "id": 1,
    "lastName": "Smith",
    "version": 1,
    "weight": 55.00
} 
```

对于反序列化我不知道。这个要求似乎很普遍，所以我想在论坛中提问。有任何想法吗？

总而言之，有一个父对象具有对子对象的引用（多对一）。如果我向父母提供孩子的所有信息，一切正常。但是等一下，孩子的身份证应该足以保护父母的安全。我尝试只用孩子的 ID 保存父母，然后我得到这个异常：

org.hibernate.TransientPropertyValueException：对象引用了一个未保存的瞬态实例 - 在刷新之前保存瞬态实例

有什么想法吗？

奥古斯丁

2013 年 1 月 27 日更新：看起来问题来自 Hibernate。假设我们有产品和类别。关系是产品具有对类别的引用（多对一关系）。给定先前保存在数据库中的类别。您不能创建产品，只需提供类别的 ID 即可创建产品。即使 Hibernate 不会查看版本来创建产品，您也将需要该版本。见下文：

```
/*
 * Create one category before the product
 */
Category cat1 = new Category();
cat1.setCode("KIT");
cat1.setName("Kitchen products");
session.save(cat1);
session.flush();
session.clear();
Category cat1db = (Category) session.get(Category.class, cat1.getCode());
logger.info(cat1.toString());
assertNotNull(cat1db.getVersion());

/*
 * Create the product and assign it a category
 */
Product p1 = new Product();
p1.setName("Kettle");
p1.setPrice(4D);
Category c1 = new Category();
c1.setCode("KIT");
//c1.setVersion(new Integer(666));
p1.setCategory(c1);
session.save(p1);
session.flush();
session.clear();
Product p1db = (Product) session.get(Product.class, p1.getId());
logger.info(p1.toString());
assertNotNull(p1db.getId()); 
```

那将失败。但是，如果您取消注释类别的版本，将创建产品。此外，Hibernate 将对数据库进行额外的查询以获取该类别。

这里有两个问题：

1.  为什么 Hibernate 需要字段版本，即使它最终看起来不是它？
2.  为什么 Hibernate 会额外查询类别？

你的意见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:12:47.923

当您处理来自 JSON 或外部表示的对象时，您总是从 Hibernate 的角度处理分离的对象。

我已经有一段时间没有做任何严肃的休眠了，但是如果你正在创建一个对象，休眠不知道你必须通过重新附加会话的对象来告诉它。然后它将从数据库中提取所需的信息以将其与会话相关联，包括任何版本信息。这被称为分离对象，因为它是在 Hibernate 会话之外创建的，并且 Hibernate 不知道该对象是新对象还是数据库中存在的对象。您可以使用 session.merge(someObject) 重新附加对象。您只需要重新附加父 btw。为了更好的解释：

[在 Hibernate 中重新附加分离对象的正确方法是什么？](https://stackoverflow.com/questions/912659/what-is-the-proper-way-to-re-attach-detached-objects-in-hibernate)

版本信息用于乐观锁定。因此，在多客户端环境中，两个请求可能会修改数据库中的同一个对象，而程序员的工作就是订购这些修改并确保一个不会覆盖另一个。乐观锁定是一种方法，当有人修改对象时，对象会被赋予版本，版本会增加。但是，在保存新版本之前，您必须检查并确保提供给 DB 的对象与存储在 DB 中的对象版本相同。这样可以确保您要保存的模组是在数据库中存储的最新版本上完成的。这意味着您不能用该对象的旧版本覆盖该对象。如果没有该版本信息，Hibernate 将无法执行乐观锁定。

# django - Django Formset 没有正确清理/保存

> ID：14523834
> 
> 赞同：0
> 
> 时间：2013-01-25T14:29:56.717
> 
> 标签：django, django-forms, formset

我正在使用 inlineformset_factory 创建表单集。父对象是*特征集*，子对象是*特征项*。我在前端使用 'django-dynamic-formset' jQuery 插件来动态添加/删除 formset 表单。

虽然表单集中的每个表单都按预期提交了正确的数据，但cleaned_data 仅包含表单的ID。

**看法：**

```
@login_required
@csrf_protect
def edit_featured_set(request, fset_id):

    '''
    Edit a featured set and its items
    '''

    c = {}
    c.update(csrf(request))

    # get existing featured set for this id (if exists)
    if fset_id and int(fset_id) > 0:
        try:
            fset_obj = Featureditemset.objects.get(id=fset_id)
        except Featureditemset.DoesNotExist:
            # bad or no id passed
            return HttpResponse('ObjectDoesNotExist')
    else:
        # get new featured set object
        fset_obj = Featureditemset(id = get_next_auto_inc(Featureditemset))

    # define formset to work with featured items            
    FeaturedItemFormSet = inlineformset_factory(Featureditemset, Featureditem, extra=1, form=FeatureditemEditForm)

    if request.method == 'POST':

        form = FeatureditemsetEditForm(request.POST, request.FILES, instance=fset_obj, prefix='set')

        if form.is_valid():
            featured_item_formset = FeaturedItemFormSet(request.POST, request.FILES, instance=fset_obj, prefix='item')
            if featured_item_formset.is_valid():

                # save form
                form.save()

                # save formset
                print 'Formset: %s' % str(featured_item_formset)
                print 'cleaned_data: %s' % featured_item_formset.cleaned_data
                featured_item_formset.save()

                return HttpResponse('valid')                  
    else:
        form = FeatureditemsetEditForm(instance=fset_obj, prefix='set')

    featured_item_formset = FeaturedItemFormSet(instance=fset_obj, prefix='item')   
    c['form'] = form
    c['formset'] = featured_item_formset

    return render_to_response('admin/edit_featured.html', c, context_instance = RequestContext(request)) 
```

**形式：**

```
class FeatureditemEditForm(ModelForm):        
    class Meta:
        model = Featureditem
        fields = ('id','img', 'name', 'folio')

class FeatureditemsetEditForm(ModelForm):        
    class Meta:
        model = Featureditemset
        fields = ('name', 'application') 
```

**楷模：**

```
class Featureditemset(models.Model):

    id = models.BigIntegerField(primary_key=True, db_column='FEATUREDITEMSET_ID')    
    application = models.ForeignKey(Application, null=True, db_column='FEATUREDITEMSET_APPLICATION_ID', blank=True)    
    htmlcontent = models.TextField(db_column='FEATUREDITEMSET_HTMLCONTENT', blank=True)    
    modified = models.DateTimeField(db_column='FEATUREDITEMSET_MODIFIED', auto_now=True)    
    viewer = models.ForeignKey(Viewer, null=True, db_column='FEATUREDITEMSET_VIEWER', blank=True)    
    name = models.CharField(max_length=192, db_column='FEATUREDITEMSET_NAME', blank=True)

    class Meta:    
        db_table = u'featureditemset'

    def __unicode__(self):
        return str(self.name)

class Featureditem(models.Model):

    id = models.BigIntegerField(db_column='FEATURED_ITEM_ID', primary_key=True)
    img = models.FileField(upload_to='featured', db_column='FEATURED_ITEM_IMG_URL', blank=True)
    alt_title = models.CharField(max_length=768, db_column='FEATURED_ITEM_ALT_TITLE', blank=True)
    modified = models.DateTimeField(db_column='FEATURED_ITEM_MODIFIED', auto_now=True)
    folio = models.ForeignKey(Folio, db_column='FEATURED_ITEM_FOLIO_ID', blank=False)
    app = models.ForeignKey(Application, null=True, db_column='FEATURED_ITEM_APP_ID', blank=True)
    name = models.CharField(max_length=192, db_column='FEATURED_ITEM_NAME', blank=True)    
    featureditemset = models.ForeignKey(Featureditemset, null=True, db_column='FEATUREDITEM_FEATUREDITEMSET_ID', blank=True)

    def __unicode__(self):
        return self.name

    class Meta:
        db_table = u'featureditem' 
```

**输出到控制台：**

```
Formset: <input type="hidden" name="item-TOTAL_FORMS" value="1" id="id_item-TOTAL_FORMS" /><input type="hidden" name="item-INITIAL_FORMS" value="1" id="id_item-INITIAL_FORMS" /><input type="hidden" name="item-MAX_NUM_FORMS" id="id_item-MAX_NUM_FORMS" />
<tr><th><label for="id_item-0-id">Id:</label></th><td><input type="text" name="item-0-id" value="5" id="id_item-0-id" /></td></tr>
<tr><th><label for="id_item-0-img">Featured Image:</label></th><td><input type="file" name="item-0-img" id="id_item-0-img" /></td></tr>
<tr><th><label for="id_item-0-name">Name:</label></th><td><input id="id_item-0-name" type="text" name="item-0-name" value="item1" maxlength="192" /></td></tr>
<tr><th><label for="id_item-0-folio">Folio:</label></th><td><select name="item-0-folio" id="id_item-0-folio">
<option value="1" selected="selected">0000054220110900000025</option>
<option value="2">com.maned.kwmultitest</option>
</select></td></tr>
<tr><th><label for="id_item-0-DELETE">Delete:</label></th><td><input type="checkbox" name="item-0-DELETE" id="id_item-0-DELETE" /><input type="hidden" name="item-0-featureditemset" id="id_item-0-featureditemset" /></td></tr>
cleaned_data: [{'id': 5}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T17:33:23.207

我想到了。我的表单构造函数中的这一行（只是有时？）抛出一个 IOError 并搞砸了我的表单集表单验证/清理：

```
self.fields['img'] = forms.ImageField(label='Featured Image') # gets rid of 'clear' checkbox 
```

贴代码的时候，我把一些（我认为是多余的）表单代码拿出来了，结果我拿出来的却是问题的根源。

# flexslider - flexslider 图像如何添加标题

> ID：14523835
> 
> 赞同：0
> 
> 时间：2013-01-25T14:29:56.697
> 
> 标签：flexslider

我需要为我的图像添加一个标题，以便 flexslider 将其显示为标题。但是我不知道如何在 drupal 7 中为图像字段添加标题。我尝试将字段添加到文件类型图像 admin/config/media/file-types/manage/image/display 但它不接受我在表单中输入的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-09T11:16:31.573

如果您创建自己的模板，请复制原始模板并使用 alt 或标题字段添加打印标题标题：

```
<div id="slider" class="flexslider">
<ul class="slides">
  <?php foreach ($items as $img):?>

  <li><?php print render ($img) ; ?>

  <?php if (!empty($img['#item']['alt'])) { ?>
    <p class="title-caption"><?php print $img['#item']['alt']; ?></p>
  <?php } ?>

  </li>

  <?php endforeach; ?>
</ul>
</div>

<?php 
  $counter = count($items);
  if($counter > 0){ ?>
  <div id="carousel" class="flexslider">
    <ul class="slides">
    <?php foreach ($items as $img): ?>
      <li><?php print render($img); ?></li>
    <?php endforeach; ?>
    </ul>
 </div>
<?php  } 
```

然后添加到你的CSS：

```
.title-caption {
position: absolute;
width: 99%;
padding: 10px;
bottom: 0px;
color: #fff;
text-shadow: 0 -1px 0 rgba(0,0,0,.5);
font-size: 20px;
line-height: 28px;
margin: 5px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T14:27:41.207

有人在这里为我回答了这个问题[http://drupal.org/node/1067620#comment-6994238](http://drupal.org/node/1067620#comment-6994238) 您必须编辑内容类型，然后编辑图像，如果向下滚动，则会出现“启用标题”复选框

# android - 在名为 Android Dependencies 的文件夹中添加 *.jar 文件

> ID：14523838
> 
> 赞同：0
> 
> 时间：2013-01-25T14:30:03.143
> 
> 标签：android, eclipse, opencv

![在此处输入图像描述](../Images/5f9986bd259d35a9407c042b990fd7f6.png)我想使用名为 openCV 的库`"opencv library -2.4.3"`，我安装了它需要的所有东西，现在 openCV 教程可以工作了。所以我需要将相同的 openCV 库添加到我的项目中以供使用。问题如何将`"library -2.4.3"`另一个项目中的opencv添加到我的文件夹中`Android Dependencies`

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:35:09.220

在项目的根文件夹中创建一个 libs 文件夹 (/libs)。将想要的 jar 复制到其中。

它将被添加到 Android 依赖项中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T17:00:27.817

您必须单击项目属性（右键单击-> 属性）并将其添加为依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:14:42.387

我只是用 eclipse 4.2.1 做了一个项目。与其他回答者一样，我所要做的就是`"libs/"`在我的项目中创建一个名为的文件夹，它会自动更新 Android 依赖项列表。你是在eclipse里面复制粘贴吗？

我使用 Eclipse 之外的文件系统将文件移动到该文件夹​​。

此链接描述了如何将`libs`文件夹添加到`Android Dependencies`：

[http://tools.android.com/recent/dealingwithdependenciesinandroidprojects](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-27T18:46:37.717

1.  右键单击项目
2.  选择属性
3.  单击左侧菜单上的 Android
4.  点击添加
5.  请选择一个图书馆项目

jar 将进入 Android 依赖项。

如果您将 jar 直接添加到 libs 下的项目或使用构建路径，那么它会位于 Android Private Libraries 下。

这两种方法都有效，但如果您想在开发过程中更改库的代码，引用库项目可能会有好处。

# php - 使用 PHP 从 JSON 字符串转换 Unicode

> ID：14523846
> 
> 赞同：6
> 
> 时间：2013-01-25T14:30:25.077
> 
> 标签：php, unicode, encoding, utf-8, character-encoding

我一直在阅读一些解决方案，但还没有设法让任何工作。

我有一个从 API 调用中读取的 JSON 字符串，它包含 Unicode 字符 -`\u00c2\u00a3`例如是 £ 符号。

我想使用 PHP 将它们转换为`£`or 或`&pound;`.

我正在调查问题并找到以下代码（使用我的磅符号进行测试），但它似乎不起作用：

```
$title = preg_replace("/\\\\u([a-f0-9]{4})/e", "iconv('UCS-4LE','UTF-8',pack('V', hexdec('U$1')))", '\u00c2\u00a3'); 
```

输出是`Â£`。

我认为这是 UTF-16 编码的是否正确？我如何将这些转换为 HTML 输出？

更新

API 中的 JSON 字符串似乎有 2 或 3 个未转义的 Unicode 字符串，例如：

```
That\u00e2\u0080\u0099s (right single quotation)
\u00c2\u00a (pound symbol) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T14:43:20.583

它**不是**UTF-16 编码。它看起来像是伪造的编码，因为 \uXXXX 编码独立于 Unicode 的任何 UTF 或 UCS 编码。`\u00c2\u00a3`真的映射到`Â£`字符串。

您应该拥有的`\u00a3`是`£`.

{0xC2, 0xA3} 是此代码点的 UTF-8 编码的 2 字节字符。

如果像我认为的那样，将原始 UTF-8 字符串编码为 JSON 的软件没有注意到它是 UTF-8 并将每个字节盲目编码为转义的 unicode 代码点，那么您需要转换每对 unicode 代码指向一个 UTF-8 编码的字符，然后将其解码为原生 PHP 编码以使其可打印。

```
function fixBadUnicode($str) {
    return utf8_decode(preg_replace("/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/e", 'chr(hexdec("$1")).chr(hexdec("$2"))', $str));
} 
```

这里的例子：http: [//phpfiddle.org/main/code/6sq-rkn](http://phpfiddle.org/main/code/6sq-rkn)

**编辑：**

如果要修复字符串以获得有效的 JSON 字符串，则需要使用以下函数：

```
function fixBadUnicodeForJson($str) {
    $str = preg_replace("/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/e", 'chr(hexdec("$1")).chr(hexdec("$2")).chr(hexdec("$3")).chr(hexdec("$4"))', $str);
    $str = preg_replace("/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/e", 'chr(hexdec("$1")).chr(hexdec("$2")).chr(hexdec("$3"))', $str);
    $str = preg_replace("/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/e", 'chr(hexdec("$1")).chr(hexdec("$2"))', $str);
    $str = preg_replace("/\\\\u00([0-9a-f]{2})/e", 'chr(hexdec("$1"))', $str);
    return $str;
} 
```

**编辑 2：**修复了以前的函数，将任何错误的 unicode 转义 utf-8 字节序列转换为等效的 utf-8 字符。

请注意，其中一些可能来自 Word 等编辑器的字符无法翻译为 ISO-8859-1，因此将显示为“？” ut8_decode 之后。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T14:41:19.390

输出是正确的。

```
\u00c2 == Â
\u00a3 == £ 
```

所以这里没有错。并且转换为 HTML 实体很容易：

```
htmlentities($title); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-03T16:56:13.270

这是使用`preg_replace_callback`代替的函数的更新版本`preg_replace`。

```
function fixBadUnicodeForJson($str) {
    $str = preg_replace_callback(
    '/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/',
    function($matches) { return chr(hexdec("$1")).chr(hexdec("$2")).chr(hexdec("$3")).chr(hexdec("$4")); },
    $str
);
    $str = preg_replace_callback(
    '/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/',
    function($matches) { return chr(hexdec("$1")).chr(hexdec("$2")).chr(hexdec("$3")); },
    $str
);
    $str = preg_replace_callback(
    '/\\\\u00([0-9a-f]{2})\\\\u00([0-9a-f]{2})/',
    function($matches) { return chr(hexdec("$1")).chr(hexdec("$2")); },
    $str
);
    $str = preg_replace_callback(
    '/\\\\u00([0-9a-f]{2})/',
    function($matches) { return chr(hexdec("$1")); },
    $str
);
    return $str;
} 
```

# jquery - Jquery Else 语句不起作用

> ID：14523849
> 
> 赞同：0
> 
> 时间：2013-01-25T14:30:29.273
> 
> 标签：jquery, html, if-statement

我的问题是这里的**else**部分似乎不起作用。我已经上网寻找解决方案，尽管有很多问题与我的完全一样，但答案似乎总是不同的。

这是我点击的按钮

```
<input type="submit" value="4"> 
```

我也有这样的按钮：

```
<input type="submit" id="b1" value="Back"> 
```

我的目标是找出是否单击了带有 ID 的按钮。

* * *

```
var specify = "";
var prevpos = 0;

$('input[type=submit]').click(function(){
    specify = $(this).attr('value');

    if($(this).attr('id').substring(0,1) == "b")
    {
       $("html, body").animate({scrollTop: prevpos}, 777);
       $(".right").animate({opacity: 0.0}, 200);
       $(".left").animate({opacity: 1.0}, 200);
       // more stuff here                           
    }   
    else
    {
       $("html, body").animate({scrollTop: prevpos}, 777);  
       // more stuff here
    }
}); 
```

一如既往，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T14:36:03.613

您的代码的问题是，当您单击没有 an 的按钮时，`id`您调用`substr()`的是 null，这将导致错误。

试试这个：

```
var specify = "";

$('button').click(function () {
    specify = $(this).attr('value');
    var id = $(this).attr('id');

    // check there is an id, and if so see if it begins with 'b'
    if (id && id.substring(0, 1) == "b") {
        alert("You clicked the button WITH an id");
    } 
    else {
        alert("You clicked the button WITHOUT an id");
    }
}); 
```

[**示例小提琴**](http://jsfiddle.net/HwLWP/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:35:59.690

```
var specify = "";
var prevpos = 0;

$('input[type=submit]').click(function(){
    specify = $(this).attr('value');

    if($(this).attr('id') && $(this).attr('id').substring(0,1) == "b")
    {
       $("html, body").animate({scrollTop: prevpos}, 777);
       $(".right").animate({opacity: 0.0}, 200);
       $(".left").animate({opacity: 1.0}, 200);
       // more stuff here                           
    }   
    else
    {
       $("html, body").animate({scrollTop: prevpos}, 777);  
       // more stuff here
    }
}); 
```

在检查元素的值之前，您可能需要检查元素是否具有 id 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:53:23.270

前段时间我有类似的要求，这是我的解决方案：

```
var specify = "";
var prevpos = 0;

$('input[type=submit]').click(function(e){ //Note the addition of 'e'
    var id = e.target.id; // If the element has no ID you should get an empty string here

    specify = $(this).attr('value');

    if( id.match(/^b/) ) { // This is a regular expression, if the ID starts with 'b' then it matches
       $("html, body").animate({scrollTop: prevpos}, 777);
       $(".right").animate({opacity: 0.0}, 200);
       $(".left").animate({opacity: 1.0}, 200);
       // more stuff here                           

    } else {
       $("html, body").animate({scrollTop: prevpos}, 777);  
       // more stuff here
    }
}); 
```

# regex - 正则表达式 htaccess 删除多个 URL 段

> ID：14523851
> 
> 赞同：0
> 
> 时间：2013-01-25T14:30:33.157
> 
> 标签：regex, .htaccess

我有一个 Wordpress 博客，其中各个帖子的 URL 设置如下： [http ://blogname.com/knowledge-communities/2013/01/blog-title](http://blogname.com/knowledge-communities/2013/01/blog-title)

我最近刷新了网站，现在设置为： [http ://blogname.com/blog-title](http://blogname.com/blog-title)

因此，如果用户找到指向旧博客文章的链接（通过 Twitter 或其他社交媒体），我想通过删除“知识社区”部分和日期部分（2013/01）将他们重定向到新的 URL 结构。

到目前为止，我有这个正在删除“知识社区”部分，但我找不到删除日期部分的方法 - /2013/01。 `RewriteRule ^knowledge\-communities/(.*) /$1 [R=301,L]`

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:41:21.040

您可以修改您的正则表达式以在两组数字之后捕获该项目：

```
RewriteRule ^knowledge\-communities/[0-9]+/[0-9]+/(.*) /$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:44:11.953

```
 /\d{4}/\d{2} 
```

将挑选出您的日期字符串

# generics - 在 .NET Compact Framework 中缓存属性 Getter/Setter

> ID：14523852
> 
> 赞同：0
> 
> 时间：2013-01-25T14:30:43.937
> 
> 标签：generics, orm, compact-framework, windows-ce

我正在为 Windows CE 设备开发 ORM。我需要将属性的 getter/setter 方法缓存为委托，并在需要时调用它们以获得最佳性能。

假设我有 2 个这样定义的实体：

```
public class Car
{
    public string Model { get; set; }
    public int HP { get; set; }
}

public class Driver
{
    public string Name { get; set; }
    public DateTime Birthday { get; set; }
} 
```

我需要能够为每个实体的每个属性持有 2 个代表。所以我创建了一个 AccessorDelegates 类来为每个属性保存 2 个委托：

```
 public class AccessorDelegates<T>
{
    public Action<T, object> Setter;
    public Func<T, object> Getter;

    public AccessorDelegates(PropertyInfo propertyInfo)
    {
        MethodInfo getMethod = propertyInfo.GetGetMethod();
        MethodInfo setMethod = propertyInfo.GetSetMethod();

        Setter = BuildSetter(setMethod, propertyInfo); // These methods are helpers
        Getter = BuildGetter(getMethod, propertyInfo); // Can be ignored
    }
} 
```

现在我想将特定实体类型的每个 AccessorDelegates 添加到列表中。所以我定义了一个类：

```
public class EntityProperties<T>
{
    public List<AccessorDelegates<T>> Properties { get; set; }
} 
```

在我的示例 Car 和 Driver 中，我需要为每个实体类型保存这些 EntityProperties。为了简单起见，我创建了一个`Dictionary<string, EntityProperties<T>>`表示实体名称的字符串：

```
public class Repo<T>
{
    public Dictionary<string, EntityProperties<T>> EntityPropDict { get; set; }
} 
```

这是我无法找到解决问题的地方。我想`EntityProperties`为每个实体类型保留，但我必须给`Repo<T>`类一个类型参数才能创建字典（因为`EntityProperties<T>`需要一个**类型参数**）。

**我需要能够在没有类型参数的情况下创建它`Repo`。**如何在`Dictionary<string, EntityProperties<T>>`不给我的 Repo 类一个类型参数的情况下定义一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T11:57:38.650

我找到了一个解决方案，一个聪明的代码，但工作正常。

我添加了一个由 AccessorDelegates 实现的接口：

```
public interface IAccessorDelegates
{
    void Init(PropertyInfo propertyInfo);
} 
```

我将 PropertyMetadata 更改为包含 IAccessorDelegate 而不是 AccessorDelegate：

```
public class PropertyMetadata
{
    public PropMapAttribute Attribute { get; set; }
    public PropertyInfo PropertyInfo { get; set; }
    public IAccessorDelegates AccessorDelegates { get; set; }

    public PropertyMetadata()
    {

    }

    public PropertyMetadata(PropMapAttribute attribute, PropertyInfo propertyInfo, IAccessorDelegates delegates)
    {
        Attribute = attribute;
        PropertyInfo = propertyInfo;
        AccessorDelegates = delegates;
    }

    public AccessorDelegates<T> GetAccesssorDelegates<T>()
    {
        return (AccessorDelegates<T>)AccessorDelegates;
    }
} 
```

现在，我可以通过这种方式创建和初始化 AccessorDelegate：

```
 Type accesssorType = typeof(AccessorDelegates<>);
 Type genericAccessorType = accesssorType.MakeGenericType(type);
 IAccessorDelegates accessor = (IAccessorDelegates)Activator.CreateInstance(genericAccessorType);
 accessor.Init(propertyInfo); 
```

`PropertyMetadata.GetAccessorDelegates<T>()`方法使我能够转换并获取实际`AccessorDelegate<T>`类型的对象。

# mysql - 将图像存储在文件系统中并使用mysql进行索引

> ID：14523855
> 
> 赞同：2
> 
> 时间：2013-01-25T14:30:47.587
> 
> 标签：mysql

我是 MySQL 的新手。我有一个网站，可以检索并允许用户将照片上传到网站。我要将照片存储为文件夹调用中的文件系统`\users\images`。我如何使用文件系统从 MySQL 调用照片？我知道人们谈论索引是有意义的，但不知道如何编码。如果有人有示例或为我提供了使用文件系统存储照片并将其显示在网络上以供每个用户登录我的网站的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:35:38.950

将图像文件保存在 \users\images 位置，并在 mysql 表中保存带有文件名的路径。

所需的数据类型将是一种接受字符串的数据类型，`VARCHAR`例如。

以下是对其他类型的参考：

*   [http://dev.mysql.com/doc/refman/5.7/en/string-types.html](http://dev.mysql.com/doc/refman/5.7/en/string-types.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:38:34.463

您必须自己将它们链接在一起。只需一步一步地思考：

1.  用户登录并上传照片。
2.  服务器（PHP？）接收带有某个名称的照片，例如`picture.jpg`。
3.  服务器从 Session 中查找当前登录的用户。
4.  如果图片已经存在，服务器会检查数据库。
5.  服务器将文件保存到`\users\%username%\picture.jpg`
6.  服务器写入一条记录，将用户 ID 和图片路径链接到数据库中的一个表，例如`pictures`.

然后，如果您想向用户显示照片。

1.  用户登录并访问照片列表页面（例如`displayphotos.php`）。
2.  服务器搜索`pictures`表`where userid=`当前用户登录。
3.  服务器循环遍历结果集中检索到的每条记录。
4.  对于每个结果集，创建一个`<img`指向图片文件路径的标签
5.  将`<img`标签放置在某种表格布局中，可能是 4 列宽。

MySQL 中没有某种开箱即用的概念可以自动管理您存储在指向物理文件的数据库中的文件名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:36:17.350

这样做。上传图片`\users\images\`。在 MySQL 服务器数据库中也有一个带有路径的索引。

```
+----+---------------------+
| id | path                |
+----+---------------------+
|  1 | \users\images\1.png |
|  2 | \users\images\2.png |
|  3 | \users\images\3.png |
|  4 | \users\images\4.png |
+----+---------------------+ 
```

# asp.net-mvc - ASP.NET MVC - 枚举未发送到控制器

> ID：14523858
> 
> 赞同：0
> 
> 时间：2013-01-25T14:31:00.857
> 
> 标签：asp.net-mvc, enums, html.dropdownlistfor

我有一个 DropDropListFor 看起来像这样：

```
 using (Ajax.BeginForm("FilterListingsWorkflow", "Listing",
    new {
        categoryguid = Model.SelectedCategoryGuid,
        workflowstatus = Model.SelectedWorkflowStatus,
        entityName = Model.EntityName,
    },
    new AjaxOptions {
        HttpMethod = "POST",
        UpdateTargetId = "listingTable",
        InsertionMode = InsertionMode.Replace
    }))
    {
        <p>Filter listings by Workflow Status:</p>
        @Html.DropDownListFor(m =>
            Model.SelectedWorkflowStatus,
            Enum.GetValues(typeof (WorkflowStatus))
                .Cast<WorkflowStatus>()
                .Select(v =>
                    new SelectListItem {
                        Text = v.ToString(),
                        Value = ((int) v).ToString()
                }),
            new { onchange = "$(this.form).submit()" })
    } 
```

如您所见，有三个对象被发送到控制器：

*   `Model.SelectedCategoryGuid`,`Model.SelectedWorkFlowStatus`和`EntityName`.

`WorkFlowStatus`是一个枚举，出于某种原因，每当我单击 DropDownList 中的任何枚举时，它总是会成为第一个。

我有三个枚举值插入到 DropDownList 中，它们是：

*   草稿、发布和存档。

因此，每当我单击其中任何一个并将鼠标悬停在控制器中的变量上时，我都会看到参数变量：`workflowstatus`始终是 Draft（这是第一个）。

有谁知道为什么没有传递正确的枚举？

真是烦死我了……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:47:59.107

您的 DropDownList 的名称是`SelectedWorkflowStatus`. 因此，请确保您的控制器操作将此类参数作为参数：

```
[HttpPost]
public ActionResult FilterListingsWorkflow(WorkflowStatus selectedWorkflowStatus)
{
    ...
} 
```

这就是您将获得正确值的地方。我可以看到您正在为表单设置一些路由值：

```
new {
    categoryguid = Model.SelectedCategoryGuid,
    workflowstatus = Model.SelectedWorkflowStatus,
    entityName = Model.EntityName,
} 
```

但不要`workflowStatus`在您的操作中查看参数。这家伙将包含旧值，即第一次呈现视图时在表单中硬编码的值。新值存储在来自 DropDown 的参数中*。*`selectedWorkflowStatus`

话虽如此，处理这种情况的正确方法是（在 ASP.NET MVC 中总是如此）使用视图模型：

```
public class MyViewModel
{
    public Guid SelectedCategoryGuid { get; set; }
    public WorkflowStatus WorkflowStatus { get; set; }
    public string EntityName { get; set; }
    public WorkflowStatus SelectedWorkflowStatus { get; set; }
} 
```

您的控制器将采取的行动：

```
[HttpPost]
public ActionResult FilterListingsWorkflow(MyViewModel model)
{
    // model.SelectedWorkflowStatus will contain the value from the DropDown
    // model.WorkflowStatus will contain the initial value
    ...
} 
```

另请更换：

```
m => Model.SelectedWorkflowStatus 
```

和：

```
m => m.SelectedWorkflowStatus 
```

在您的下拉菜单中。您不需要在闭包中捕获模型。

# c# - 来自 MSTSCLib 的 C# WPF RDP ax 控件用于 Hyper-V 问题

> ID：14523859
> 
> 赞同：0
> 
> 时间：2013-01-25T14:31:01.817
> 
> 标签：c#, wpf, activex, rdp, mstsc

**目前正忙着在WPF C#**中为 Hyper-V 托管的 VM制作一个小 RDP 客户端。这个客户端应该完全没有管理，所以只连接到它，并且能够使用机器。所以没有停止/启动/等虚拟机的选项。

控制使用：AxMSTSCLib.AxMsRdpClient7NotSafeForScripting 在运行时初始化并放置在 WindowsFormsHost

## 问题是：

1）我撒谎了，有一个功能应该是可能的：发送 Ctrl + Alt + Del。我当然在客户端上为此做了一个按钮。我尝试了几种可能性，但每一种都失败了，我什至无法向虚拟机发送一个“A”。

**我尝试过的可能性：**

a) 通过 user32.dll 的 SendInput 本机调用模拟键盘

*   当我执行 SendKeystroke 'control, alt and something else' 然后转到 VM 并例如按下 F 时，触发了 control + F 命令。或者我可以开始选择多个文件（如 shift）。
*   除此之外，我尝试在控件的高级设置/安全设置上打开和关闭一些属性

因此，除非我做错了键没有被触发，否则此方法对我来说失败

* * *

b) 使用输入管理器

```
PresentationSource source = PresentationSource.FromVisual(this);
KeyEventArgs insertStuff = new KeyEventArgs(Keyboard.PrimaryDevice, source, 0, Key.D0);
insertStuff.RoutedEvent = UIElement.KeyDownEvent;
InputManager.Current.ProcessInput(insertStuff); 
```

这是windowsformhost所在的用户控件，我尝试用this.winformshost替换它，但也没有运气

* * *

c）尝试了另一种方式，但失败并忘记了，反正不是很漂亮。

* * *

2）第二个问题是焦点，更准确地说：在VM中启动应用程序时的焦点。

我将详细解释：在开发人员机器上没有任何问题。但是，当我从 RDP 内启动应用程序到虚拟机 ( **A** ) 以使用我的工具连接到另一台虚拟机 ( **B** ) 时，出现了一个重大问题。**当您在第一次显示机器B**的 RDP 控件内单击一次时，整个应用程序就会卡住。**解开它的唯一方法是，例如在机器B**上单击 Windows 开始键，然后返回客户端工具，一切正常，但这是相当不可接受的。

我发现控件存在焦点问题，但以下**无法解决**此问题（创建了将 ax 控件作为基类的新类）：

```
protected override void WndProc(ref System.Windows.Forms.Message m)
{
    //Fix for the missing focus issue on the rdp client component
    if (m.Msg == 0x0021)
    {
        this.Focus();
    }
    base.WndProc(ref m);
} 
```

* * *

如果有人能够提供帮助，我将不胜感激！

亲切的问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T05:41:27.060

```
 protected override void WndProc(ref Message m)
         {
             switch (m.Msg)
             {
                 case 0x021:
                     {
                         Message mm = new Message();
                         mm.Msg = 0x007;
                         base.WndProc(ref mm);
                     }
                     break;
             }
             base.WndProc(ref m);
         } 
```

# c# - 如何从外部位置提取 HTML 块并使用 Razor 渲染它？

> ID：14523861
> 
> 赞同：3
> 
> 时间：2013-01-25T14:31:19.897
> 
> 标签：c#, html, asp.net-mvc, razor

无论如何我可以在剃须刀中执行以下代码吗？

```
<div>
   <c:import url="http://hostName/HTML-file-name/" />
</div> 
```

我想从给定位置提取 HTML 并将其呈现在页面上。这应该是可能的...

希望这是有道理的...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:55:44.880

在 Razor 中，没有。在 HTML 中是：

```
<div>
    <iframe src="http://hostName/HTML-file-name/"></iframe>
</div> 
```

实际上，您可以使用服务器端代码向远程资源发送 HTTP 请求并内联显示结果：

```
<div>
    @Html.Raw(new System.Net.WebClient().DownloadString("http://hostName/HTML-file-name/"))
</div> 
```

但请记住，这只会获取位于指定地址的内容。例如，如果这是一个引用外部 CSS 和 javascript 文件的 HTML 页面，它们将不会被检索。

# windows-8 - 适合会议室的触屏文件浏览器？视窗 8

> ID：14523865
> 
> 赞同：1
> 
> 时间：2013-01-25T14:31:23.890
> 
> 标签：windows-8, touchscreen

嗨，我想知道是否有一种预先存在的软件（免费或付费）可以让参加活动的人在触摸屏上浏览照片、pdf 和视频等内容。它需要防止他们点击文件浏览器到桌面等。

我尝试在运行 Windows 8 的联想触摸屏上修改主屏幕，但对于以前从未使用过 Windows 8 的人来说，这似乎不是很直观。

# .net - 如何在 ASP.NET MVC 中创建以数字开头的操作名称？

> ID：14523866
> 
> 赞同：6
> 
> 时间：2013-01-25T14:31:28.273
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-2

我想将我的 ASP.NET MVC 控制器操作命名为，`123games`但由于数字，它不允许我这样做。

我需要使用`ActionNameAttribute`吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T14:43:38.127

是的你是。根据[第 2.4.2 节“标识符”，](http://msdn.microsoft.com/en-us/library/aa664670.aspx)[C# 语言规范](http://msdn.microsoft.com/en-us/library/aa645596.aspx)禁止以数字开头的标识符：

> 标识符开始字符：
> 
> *   字母字符
> *   _（下划线字符 U+005F）

请注意缺少任何数值。

也就是说，您可以使用[`ActionNameAttribute`](http://msdn.microsoft.com/en-us/library/system.web.mvc.actionnameattribute.aspx)来创建一个带有以数字开头的操作的路由（因为 URL 没有这样的限制），如下所示：

```
[ActionName("123games")]
public ActionResult _123Games()
{
     // Action code.
} 
```

请注意，使用下划线*对*标识符的第一个字符有效（根据与上面相同的部分，特别是在下面，强调我的）：

> 本节中给出的标识符规则与 Unicode 标准附件 15 推荐的规则完全一致，**除了下划线允许作为初始字符**（就像 C 编程语言中的传统字符一样）...

因此，我使用它作为方法名称的开头（即`_123Games`），以使其在 C# 代码中与 URL 片段一样紧密对齐。

# cloudbees - 如何更改 cloudbees 中的 api 密钥？

> ID：14523873
> 
> 赞同：1
> 
> 时间：2013-01-25T14:32:05.827
> 
> 标签：cloudbees

我不小心在项目的文件中提交了我的 cloudbees api 密钥。因此，我想改变它们。可能吗？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T09:35:34.617

在 support@cloudbees.com 提出支持请求

# git - 使用现有 Gitolite 配置设置 GitLab 的简单方法

> ID：14523876
> 
> 赞同：19
> 
> 时间：2013-01-25T14:32:22.203
> 
> 标签：git, gitolite, gitlab

我有一个现有的 Gitolite 配置，其中包含许多用户和存储库。它是按照 Gitolite 安装指南建议的默认方式设置的。现在我想添加 GitLab 以便能够进行代码审查和错误跟踪。

实现这一目标最方便的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:55:33.303

原始答案（2013 年 1 月）

您可以按照[标准安装](https://github.com/gitlabhq/gitlabhq/blob/master/doc/install/installation.md)，并在**[`gitlab.yml`配置文件](https://github.com/gitlabhq/gitlabhq/blob/master/config/gitlab.yml.example#L106-L121)**中指明 gitolite 存储库的位置以及 gitolite 管理员用户。

但是，GitLab 要求用户在 GitLab 中注册自己并复制他们的公共 ssh 密钥。
这意味着您可能需要调整 gitolite 存储现有 gitolite 用户的方式，因为您使用的名称可能与 GitLab 使用的名称不同（它使用基于 的名称`login_email_auuid`）。

* * *

更新（2018 年 8 月，5 年后）：

正如[Thomas](https://stackoverflow.com/users/605586/thomas)[在下面评论](https://stackoverflow.com/questions/14523876/easy-way-to-setup-gitlab-with-existing-gitolite-configuration/14524320#comment91175072_14524320)的那样，在这个答案几个月后，GitLab[发布了 GitLab 5.0，没有 gitolite](https://about.gitlab.com/2013/02/12/gitlab-without-gitolite/)。

> 现在我想添加 GitLab 以便能够进行代码审查和错误跟踪。
> 实现这一目标最方便的方法是什么？

如今（2018 年，GitLab 11.2.x），通过**[合并请求](https://docs.gitlab.com/ce/gitlab-basics/add-merge-request.html)**支持代码审查（几年前就一直如此）。
看：

*   [**Emily von Hoffmann**](https://twitter.com/emvonhoffmann)的“[**演示：使用 GitLab 掌握代码审查**](https://about.gitlab.com/2017/03/17/demo-mastering-code-review-with-gitlab/)” ，[](https://twitter.com/emvonhoffmann)
***   **[Maxim Letushov](https://stackoverflow.com/users/759685/maxim-letushov)**的“**[通过 GitLab 合并请求进行代码审查](https://yalantis.com/blog/code-review-via-gitlab-merge-requests-code-review-must/)**” 。**

# android - 如何处理移动浏览器吃键/鼠标事件

> ID：14523877
> 
> 赞同：1
> 
> 时间：2013-01-25T14:32:24.870
> 
> 标签：android, browser, dom-events

我已经编写了一些 Javascript 代码，它可以捕获键盘和鼠标事件。这个想法是，每当我点击页面上的元素（TD）时，它就会被选中（基本上我只是更改类，使其突出显示），并且我可以使用箭头键来更改选中的元素。

但是，当我在手机（运行 Gingerbread）上的股票 android 浏览器上查看此页面时，浏览器会吃掉所有事件并且我的页面无法正常工作。具体来说，当我点击页面上的某个项目时，我看到文本周围有一个橙色圆角框，我的页面没有收到该事件。当我点击向上和向下箭头键时，框会移动，但我的代码没有这样做，它似乎是浏览器正在做的事情。

我怀疑正在发生的事情是浏览器试图以某种方式“提供帮助”。我正在寻找的是某种方式来提示浏览器不要这样做，或者以其他方式禁用此行为。

更新：这是我看到的问题的更具体示例。我设置了以下简单的侦听器，只是为了查看各个键对应的键码：

```
document.onkeydown = function(evt) {
    alert(evt.which)
} 
```

现在，如果光标在 TextField 中并且我按下手机上的 Enter 键，则会弹出警报并显示“13”。但是，如果我将焦点移到另一个元素（在本例中为 TD），当我按下回车键时，*什么都不会发生*。

更新：我尝试安装六种不同的浏览器。他们似乎都吞噬了箭头键（这是设备上的物理键盘）并使用它们来滚动屏幕或突出显示页面上的不同元素，而不是将事件传递给我的网络应用程序以便它可以实际使用他们做我想做的事！我见过的唯一不这样做的浏览器是 Firefox，它似乎只是默默地完全忽略了它们。

# php - 使用 Web 服务将报价导入 vtiger crm

> ID：14523882
> 
> 赞同：3
> 
> 时间：2013-01-25T14:32:40.307
> 
> 标签：php, web-services, import, vtiger

我需要将引号导入`vtiger`. 我发现它可以使用 vtiger Web 服务 API 来完成

我找到了参考手册： [https ://wiki.vtiger.com/archives/index.php/vtiger510:Webservice_reference_manual](https://wiki.vtiger.com/archives/index.php/vtiger510:Webservice_reference_manual)

但我找不到任何示例 PHP 脚本，也找不到我需要传递给`webservice.php`.

请帮忙，我需要一些指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T21:42:31.153

我做过这样的事情，我有一个快速且（相当）肮脏但有效的解决方案：

```
<?php

function createOffer($account_id,$subject,$offerlanguage, $totalamount,$date_submission,$date_decision,$date_start,$assigned_user_id,$quotestage,$winningchance,$description,$productarray){

        global $adb;

        $endpointUrl = "[your URL]/webservice.php";
        $userName="admin";
        $userAccessKey = '[your accesskey]';

        $httpc = new HTTP_CLIENT();

        //getchallenge request must be a GET request.
        $httpc->GET($endpointUrl."?operation=getchallenge&username=".$userName);

        $response = $httpc->currentResponse();
        //decode the json encode response from the server.
        $jsonResponse = Zend_JSON::decode($response['body']);

        //check for whether the requested operation was successful or not.
        if($jsonResponse['success']==false)
            //handle the failure case.
            die('getchallenge failed:'.$jsonResponse['error']['errorMsg']);

        //operation was successful get the token from the reponse.
        $challengeToken = $jsonResponse['result']['token'];
        //create md5 string concatenating user accesskey from my preference page
        //and the challenge token obtained from get challenge result.
        $generatedKey = md5($challengeToken.$userAccessKey);

        //getchallenge request must be a GET request.
        $httpc->post("$endpointUrl",
                        array('operation'=>'login', 'username'=>$userName, 'accessKey'=>$generatedKey), true);
        $response = $httpc->currentResponse();

        //decode the json encode response from the server.
        $jsonResponse = Zend_JSON::decode($response['body']);

        //operation was successful get the token from the reponse.
        if($jsonResponse['success']==false)
            //handle the failure case.
            die('login failed:'.$jsonResponse['error']['errorMsg']);

        //login successful extract sessionId and userId from LoginResult to it can used for further calls.
        $sessionId = $jsonResponse['result']['sessionName'];
        $userId = $jsonResponse['result']['userId'];

        $currency_id=1;
        $params =  array('description'=>$description,'subject'=>$subject,'quotestage'=>$quotestage,'assigned_user_id'=>'2x'.$assigned_user_id,'account_id'=>'3x'.$account_id,'cf_682'=>$offerlanguage,'currency_id'=>'21x'.$currency_id,'taxtype'=>'group','cf_683'=>$date_submission,'cf_684'=>$date_decision,'cf_685'=>$date_start,'cf_766'=>$winningchance);

        $urlArgs = "?&total=".$totalamount;
        //encode the object in JSON format to communicate with the server.
        $objectJson = Zend_JSON::encode($params);
        //name of the module for which the entry has to be created.
        $moduleName = 'Quotes';
        //sessionId is obtained from loginResult.
        $params = array("sessionName"=>$sessionId, "operation"=>'create', "element"=>$objectJson, "elementType"=>$moduleName);
        //Create must be POST Request.
        $httpc->post($endpointUrl.$urlArgs, $params, true);
        $response = $httpc->currentResponse();
        //decode the json encode response from the server.
        $jsonResponse = Zend_JSON::decode($response['body']);

        $savedObject = $jsonResponse['result'];
        $id = $savedObject['id'];   

        $id=str_replace("13x", "", $id);

        echo $id." offer: ".$subject." created for amount ".$totalamount." for customer: ".$account_id." assigned to: ".$assigned_user_id;

        return $id;

    } 
```

如您所见，还有一些自定义字段，因此您可以看到我是如何处理这些字段的。

你可以像这样调用这个函数：

```
createOffer($account_id, $subject, $offerlanguage, $totalamount, $date_submission, $date_decision, $date_start, $assigned_user_id, $quotestage, $winningchance, $description, $productarray) 
```

然后您还需要添加产品，我发现通过单独的功能最简单，因为每个报价可以有更多产品......

```
<?php

function createProducts($productarray,$id) {
    $counter = 1;
    foreach ($productarray as $prod) {
        $query ="insert into vtiger_inventoryproductrel(id, productid, sequence_no, quantity, listprice) values(?,?,?,?,?)";
        $qparams = array($id,$prod['prod'],$counter,$prod['pcs'],$prod['price']);
        $productadded=$adb->pquery($query,$qparams);
        $counter=$counter+1;
    }
} 
```

像这样使用它：

```
$prodlist = array();

array_push($prodlist,array('prod'=>"prod1",'pcs'=>2,'price'=>1000));
array_push($prodlist,array('prod'=>"prod2",'pcs'=>2,'price'=>100));

createProducts($prodlist,10); 
```

所以我的逻辑是这样的：

*   您使用 createOffer 函数创建报价。它返回新创建的报价 ID
*   然后您构建产品数组（我这里只有非常基本的数据）并通过引用报价的 ID 添加它

也许不是最漂亮的解决方案，但有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T11:34:06.753

也许您可以这样开始（根据您的参考链接）。

手册：[https](https://wiki.vtiger.com/archives/index.php/vtiger510:Webservice_reference_manual)
://wiki.vtiger.com/archives/index.php/vtiger510:Webservice_reference_manual 登录：[https ://wiki.vtiger.com/archives/index.php/vtiger510:Webservice_reference_manual#Login](https://wiki.vtiger.com/archives/index.php/vtiger510:Webservice_reference_manual#Login)

伪;

```
<?php
class VTiger_Login
{
    private $serviceURL = 'http://vtiger_url/webservice.php?operation=login&username=%s&accessKey=%s';
    // A Vtiger username.
    private $userName = 'my_username';
    // An md5 of the concatenation of the challenge token and the user's webservice access key. 
    private accessKey = 'my_accesskey';

    public function login() {
        // Open CURL
        $ch = curl_init();
        // Set URL as same as on manual
        curl_setopt($ch, CURLOPT_URL, sprintf($this->serviceURL, $this->userName, $this->accessKey));
        // Need POST according to manual
        curl_setopt($ch, CURLOPT_POST, 1);
        // Receive server response = TRUE
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        // Exec CURL
        $result = curl_exec($ch);
        // Close CURL
        curl_close($ch);

        /*
        $result should be like this according to manual;
        LoginResult {
            sessionId: String     // Unique Identifier for the session
            userId: String        // The vtiger id for the logged in user
            version: String       // The version of the webservices api
            vtigerVersion: String // The version of the vtiger crm.
        } 
        */

        // From manual: All structural data including response from the api is represented as JSON strings. 
        $result =@ json_decode($result);
        // See "Response" on manual
        if (null === $result) {
            throw new Exception('No response returned from Vtiger server!');
        }
        // See "ErrorObject" on manual
        if (null !== $result->success && false === $result->success) {
            throw new Exception('Something went wrong with login operation! errorCode: '. 
                        $result->errorCode .', errorMessage: '. $result->errorMessage);
        }

        // I think, there is no problem anymore, go with $result after this line...
    }
} 
```

# c# - 我们如何使用 ACS 在 ASP.NET 中进行 ajax 登录

> ID：14523886
> 
> 赞同：1
> 
> 时间：2013-01-25T14:32:59.507
> 
> 标签：c#, acs

我在我的 Web 应用程序中使用 azure 访问控制服务 (ACS) 来验证来自不同身份提供者的用户。我成功注册了我的应用程序以使用 ACS。以前我使用 ASP.NET Membership 数据库对用户进行身份验证，并且在我的应用程序中有一些页面，用户可以在其中执行 ajax-logIn（在这种情况下，不会发生页面刷新/重新加载并且用户会登录）。

如何使用 ACS 登录系统执行此操作？

# opencv - 图像中的 OpenCV 斑点

> ID：14523890
> 
> 赞同：0
> 
> 时间：2013-01-25T14:33:13.437
> 
> 标签：opencv, blob

我正在使用 opencv 在图像中查找 blob。当我找到一个 blob 时，我想在它周围放一个矩形。我不能用opencv做到这一点。我做了一个基于 haar 的检测，效果非常好，但是对我来说，blob 检测是不可能的......

你们能帮帮我吗？

问候安装

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:46:44.153

试试[cvblob](http://code.google.com/p/cvblob/)库。然后，您可以只使用 cvDrawRectangle(myBlob->BoundingBox)

# ios - 在ios上播放HTML5声音时有没有办法选择音频输出

> ID：14523896
> 
> 赞同：3
> 
> 时间：2013-01-25T14:33:25.433
> 
> 标签：ios, html, html5-audio

我在 iOS 上使用 HTML5 音频 API 播放一些声音。

不幸的是，声音似乎是通过顶部扬声器播放的，而不是主要的。

有没有办法为我的声音选择输出？

# c++ - 如何在进入函数之前指定需要哪些互斥锁

> ID：14523898
> 
> 赞同：1
> 
> 时间：2013-01-25T14:33:28.297
> 
> 标签：c++, concurrency, c++11

有时编写的函数需要在进入该函数之前锁定一个或多个互斥锁。如果未指定此要求，则可以在进入之前不获取相关锁的情况下调用该函数，这可能会产生灾难性的后果。

现在，可以在函数的文档中指定类似的内容，但我真的不喜欢这样。

我正在考虑在函数的前提条件中指定它（进入函数时断言），但条件应该是什么？

即使 C++11 中的 std::mutex 确实有一个 has_lock() 函数，仍然不能保证*我*是那个拥有锁的人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T15:10:12.243

如果您真的不想使用递归互斥锁，并且您的目标是确定*当前线程*是否持有互斥锁而不尝试获取它，那么定义互斥锁包装器可能是最简单的解决方案。这是一个狂野的镜头：

```
#include <thread>
#include <mutex>
#include <iostream>

using namespace std;

template<typename M>
struct mutex_wrapper
{
    void lock() 
    { 
        m.lock(); 
        lock_guard<mutex> l(idGuardMutex); 
        threadId = this_thread::get_id();
    }

    void unlock() 
    { 
        lock_guard<mutex> l(idGuardMutex); 
        threadId = thread::id(); 
        m.unlock(); 
    }

    bool is_held_by_current_thread() const 
    { 
        lock_guard<mutex> l(idGuardMutex); 
        return (threadId == this_thread::get_id()); 
    }

private:

    mutable mutex idGuardMutex;
    thread::id threadId;
    M m;
}; 
```

这是一个如何使用它的简单示例：

```
int main()
{
    cout << boolalpha;
    mutex_wrapper<mutex> m;
    m.lock();
    cout << m.is_held_by_current_thread() << endl;
    m.unlock();
    cout << m.is_held_by_current_thread() << endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T15:44:13.673

我认为您的困境的答案就是*不要使用外部互斥锁*。如果一个类管理需要同步的资源，那么它应该使用内部互斥锁并自己处理所有同步。外部互斥锁很危险，因为它使您面临死锁和非同步访问的可能性。

从评论中，听起来您正在努力解决的问题是重构同步集合。您想将一些代码移出类，但该代码必须同步。这是一个如何做到这一点的示例：

```
class MyCollection {
private:
    std::list<Foo> items;
    std::mutex lock;

public:
    template <class F> void ForEach( F function )
    {
        std::lock_guard<decltype(this->lock) guard( this->lock );

        for( auto item : items )
            function( *item );
    }
}; 
```

这种技术仍然存在死锁的可能性。由于函数参数是一个任意函数，它可能会访问集合并因此获取互斥锁。另一方面，如果“ForEach”应该是只读的，则可能需要这种行为。

# sqlite - 用于 Windows 8 Metro 应用程序的 sql lite 的 CRUD

> ID：14523899
> 
> 赞同：0
> 
> 时间：2013-01-25T14:33:28.873
> 
> 标签：sqlite, windows-8, microsoft-metro

我对 Windows 8 Metro 应用程序的 SQLlite 的 CRUD 做了很多研究，但我没有发现任何有用的东西，我只想为 SQLlite 应用程序提供一些简单的 CRUD 语法，我还想获得插入的最后一行 id

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:38:29.850

[这是一个](http://timheuer.com/blog/archive/2012/08/07/updated-how-to-using-sqlite-from-windows-store-apps.aspx)如何使用 SQLite 在 Store 风格的应用程序中进行简单插入的示例。您可以使用[Last Insert Rowid 函数](http://sqlite.org/c3ref/last_insert_rowid.html)来获取您使用插入的行的 id。鉴于您有示例中的设置，例如...

```
db.runAsync('INSERT INTO ...');  // whatever your insert statement is    
db.runAsync('SELECT LAST_INSERT_ROWID()'); 
```

# windows - 具有 grep 功能的 Windows 单用户 SCM？

> ID：14523901
> 
> 赞同：1
> 
> 时间：2013-01-25T14:33:39.573
> 
> 标签：windows, version-control, grep

对于单用户开发，我喜欢[Fossil](http://www.fossil-scm.org/)，因为它是一个单一的 EXE，并且有很多功能。

但是，此时，它没有用于在存储库中搜索代码的 grep 功能。唯一的方法是编写一个带有循环的脚本，以依次检查每个修订版并 grep 遍历工作文件。

是否有另一个小型、良好的 SCM（适用于 Windows）支持 grep 以避免检查修订？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:06:43.180

不是那么小，但很好 - Mercurial（以[TortoiseHG](http://tortoisehg.bitbucket.io/)的形式）。它**有**权力[grep](https://www.mercurial-scm.org/repo/hg/help/grep)。

# sql - 查找连续工作 5 天且输出日期范围为日期范围的用户

> ID：14523906
> 
> 赞同：1
> 
> 时间：2013-01-25T14:33:51.277
> 
> 标签：sql, oracle, oracle10g, group-by

我有一个表有类似于下面的数据

```
 Emp  Date        Code     
  ---  --------    ---- 
  E1  11/1/2012    W 
  E1  11/1/2012    V   
  E2  11/1/2012    W   
  E1  11/2/2012    W
  E1  11/3/2012    W
  E1  11/4/2012    W
  E1  11/5/2012    W 
```

我想获取在日期范围（比如过去 3 个月）之间连续为代码 W 工作 5 天的员工列表，输出中的日期范围。每个员工在一天内可以有多个不同代码的记录。

预期输出是

```
Emp   Date-Range 
---   ----------
 E1   11/1 -11/5 
```

以下是我尝试过的，但我根本没有接近我寻求的输出

```
 SELECT distinct user, MIN(date) startdate, MAX(date) enddate
FROM (SELECT user, date, (TRUNC(date) - ROWNUM) tmpcol
      FROM (SELECT user, date
              FROM tablename
             where date between to_date('10/01/2012','mm/dd/yyyy') and to_date('10/03/2012','mm/dd/yyyy')
             ORDER BY user, date) ot) t
 GROUP BY user, tmpcol
 ORDER BY user, startdate; 
```

如果 Emp E1 连续工作了 10 天，他应该在两个日期范围的输出中列出两次。如果 E1 连续工作了 9 天（11/1 到 11/9），他应该只列出一次，日期范围为 11/1 到 11/9。

我已经看到了类似的问题，但没有一个问题完全适合我。我的数据库是 Oracle 10G，没有 PL/SQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:56:30.360

你可以从这里开始：

```
select 
emp, count(*) over (partition by emp, code order by date_worked range interval '5' day preceding) as days_worked_last_5_days
from table
where code='W'; 
```

那些带有 days_worked_last_5_days=5 的行就是您搜索的内容。

[看到这个小提琴。](http://sqlfiddle.com/#!4/b7286/7)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:45:07.077

我不确定我是否正确理解了所有内容，但这样的事情可能会让你开始：

```
select emp, 
       sum(diff) as days,
       to_char(min(workdate), 'yyyy-mm-dd') as work_start,
       to_char(max(workdate), 'yyyy-mm-dd') as work_end
from (       
  select *
  from (
    select emp, 
           workdate, 
           code, 
           nvl(workdate - lag(workdate) over (partition by emp, code order by workdate),1) as diff
    from tablename
    where code = 'W'
     and workdate between ...
  ) t1
  where diff = 1 -- only consecutive rows
) t2
group by emp
having sum(diff) = 5 
```

SQLFiddle：[http ://sqlfiddle.com/#!4/ad7ae/3](http://sqlfiddle.com/#!4/ad7ae/3)

请注意，我使用`workdate`而不是`date`使用保留字作为列名是一个坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T16:06:32.917

```
Select emp, data-5, data from (SELECT EMP, DATA, WORK,lag, lead, row_number() over(PARTITION BY emp--, DATA 
ORDER BY DATA asc) rn
  FROM (SELECT emp,
               data,
               work,
               LAG (data) OVER (PARTITION BY emp ORDER BY data ASC) LAG,
               LEAD (data) OVER (PARTITION BY emp ORDER BY data ASC) LEAD
          FROM (SELECT emp,
                       data,
                       work,
                       ROW_NUMBER ()
                           OVER (PARTITION BY emp, data ORDER BY data ASC)
                           rn
                  FROM example)
         WHERE rn = 1) a
WHERE a.data + 1 = LEAD AND a.data - 1 = LAG
) WHERE rn = 5 
```

表示例在哪里：

EMP(varchar2)、日期、“W”或“F”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-05T08:33:44.047

```
SELECT * FROM (
SELECT USERID,USEDATE,WRK,RANK() OVER (PARTITION BY USERID,WRK ORDER BY USEDATE ) AS RNK1 FROM USER1  )U1 JOIN
(
SELECT USERID,USEDATE,WRK,RANK() OVER (PARTITION BY USERID,WRK ORDER BY USEDATE ) AS RNK2 FROM USER1  )U2 ON U1.USERID=U2.USERID AND U1.RNK1+3=U2.RNK2 AND U2.USEDATE-U1.USEDATE=3; 
```

# android - AndroidBitmap_lockPixels 在 Gingerbread 中无法正常工作

> ID：14523907
> 
> 赞同：1
> 
> 时间：2013-01-25T14:33:52.703
> 
> 标签：android, android-ndk

我正在尝试将 Jelly Bean (Android 4.2+) 中的[Gallery App](https://android.googlesource.com/platform/packages/apps/Gallery2)中的图像过滤器移植到我的应用程序中，并支持 Gingerbread (Android 2.3)。我设法从 JNI NDK 源中提取了一个过滤器并将其移植到我的应用程序中。它在 Android 4.2 (Galaxy Nexus) 和 Android 4.1 (Nexus S) 上运行良好，但是`signal 11 (SIGSEGV)`当我在 Android 2.3 (HTC Wildfire S) 上尝试时它会因分段错误而崩溃。

源文件如下所示：

```
void JNIFUNCF(ImageFilterFx, nativeApplyFilter, jobject bitmap, jint width, jint height, jobject lutbitmap,jint lutwidth, jint lutheight )
{
    char* destination = 0;
    char* lut = 0;
    AndroidBitmap_lockPixels(env, bitmap, (void**) &destination);
    AndroidBitmap_lockPixels(env, lutbitmap, (void**) &lut);

    unsigned char * rgb = (unsigned char * )destination;
    unsigned char * lutrgb = (unsigned char * )lut;

    int lutdim_r   = lutheight;
    int lutdim_g   = lutheight;;
    int lutdim_b   = lutwidth/lutheight;;
    int STEP = 4;

    int off[8] =  {
        0,
        STEP*1,
        STEP*lutdim_r,
        STEP*(lutdim_r + 1),
        STEP*(lutdim_r*lutdim_b),
        STEP*(lutdim_r*lutdim_b+1),
        STEP*(lutdim_r*lutdim_b+lutdim_r),
        STEP*(lutdim_r*lutdim_b+lutdim_r + 1)
    };

    float scale_R = (lutdim_r-1.f)/256.f;
    float scale_G = (lutdim_g-1.f)/256.f;
    float scale_B = (lutdim_b-1.f)/256.f;

    int i;
    int len = width * height * STEP;

    for (i = 0; i < len; i+=STEP)
    {
        int r = rgb[i];
        int g = rgb[i+1];
        int b = rgb[i+2];

        float fb = b*scale_B;
        float fg = g*scale_G;
        float fr = r*scale_R;

        int lut_b = (int)fb;
        int lut_g = (int)fg;
        int lut_r = (int)fr;

        int p = lut_r+lut_b*lutdim_r+lut_g*lutdim_r*lutdim_b;
        p*=STEP;

        float dr = fr-lut_r;
        float dg = fg-lut_g;
        float db = fb-lut_b;

        rgb[i]   = clamp(interp(lutrgb,p  ,off,dr,dg,db));
        rgb[i+1] = clamp(interp(lutrgb,p+1,off,dr,dg,db));
        rgb[i+2]  = clamp(interp(lutrgb,p+2,off,dr,dg,db));
    }

    AndroidBitmap_unlockPixels(env, bitmap);
    AndroidBitmap_unlockPixels(env, lutbitmap);
} 
```

我在 LogCat 中看到的错误如下所示：

```
I/DEBUG ( 3973): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I/DEBUG ( 3973): Build fingerprint: 'htc_europe/htc_marvel/marvel:2.3.5/GRJ90/197017.3:user/release-keys'
I/DEBUG ( 3973): pid: 3976, tid: 4026 >>> com.company.app <<<
I/DEBUG ( 3973): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 45918002
I/DEBUG ( 3973): r0 00000000 r1 00111600 r2 ffffff01 r3 00088ff4
I/DEBUG ( 3973): r4 45918000 r5 00000000 r6 3f800000 r7 00000000
I/DEBUG ( 3973): r8 00000000 r9 00000000 10 3f800000 fp 00000002
I/DEBUG ( 3973): ip 00088ff8 sp 45acfa98 lr 80401d20 pc 804017e0 cpsr 20000010
I/DEBUG ( 3973): d0 43755b2443185b24 d1 41cc0000c2ba0000
I/DEBUG ( 3973): d2 41c8000041cc0000 d3 000000003f000000
I/DEBUG ( 3973): d4 0000000000000000 d5 bcb1a62633145c07
I/DEBUG ( 3973): d6 0000000041c80000 d7 0000001941c80000
I/DEBUG ( 3973): d8 0000000000000000 d9 0000000000000000
I/DEBUG ( 3973): d10 0000000000000000 d11 0000000000000000
I/DEBUG ( 3973): d12 0000000000000000 d13 0000000000000000
I/DEBUG ( 3973): d14 0000000000000000 d15 0000000000000000
I/DEBUG ( 3973): scr 60000012
I/DEBUG ( 3973): 
I/DEBUG ( 3973): #00 pc 000017e0 /data/data/com.company.app/lib/libjni_filtershow_filters.so
I/DEBUG ( 3973): #01 pc 00018374 /system/lib/libdvm.so
I/DEBUG ( 3973): #02 pc 0000160c /data/data/com.company.app/lib/libjni_filtershow_filters.so
I/DEBUG ( 3973): 
I/DEBUG ( 3973): code around pc:
I/DEBUG ( 3973): 804017c0 e58da038 e58d1034 e58d2030 e58db05c 
I/DEBUG ( 3973): 804017d0 e58d0060 e58d5024 e1a0c006 ea000157 
I/DEBUG ( 3973): 804017e0 e5d40002 eb0004b4 e59d1054 eb0004dd 
I/DEBUG ( 3973): 804017f0 e1a06000 e5d40001 eb0004af e59d1048 
I/DEBUG ( 3973): 80401800 eb0004d8 e1a0a000 e5d40000 eb0004aa 
I/DEBUG ( 3973): 
I/DEBUG ( 3973): code around lr:
I/DEBUG ( 3973): 80401d00 eb000307 e59d1028 eb000396 e1a01000 
I/DEBUG ( 3973): 80401d10 e1a00009 eb000302 eb000450 eb00002e 
I/DEBUG ( 3973): 80401d20 e59d3020 e59d1050 e5c40002 e283c004 
I/DEBUG ( 3973): 80401d30 e151000c e58dc020 e2844004 da000007 
I/DEBUG ( 3973): 80401d40 e35c0063 cafffea5 e59d105c e59d2060 
I/DEBUG ( 3973): 
I/DEBUG ( 3973): stack:
I/DEBUG ( 3973): 45acfa58 00000000 
I/DEBUG ( 3973): 45acfa5c afd11074 /system/lib/libc.so
I/DEBUG ( 3973): 45acfa60 002d1c18 
I/DEBUG ( 3973): 45acfa64 45acfb04 
I/DEBUG ( 3973): 45acfa68 00000000 
I/DEBUG ( 3973): 45acfa6c 00000100 
I/DEBUG ( 3973): 45acfa70 00000288 
I/DEBUG ( 3973): 45acfa74 203af046 
I/DEBUG ( 3973): 45acfa78 002d1c18 
I/DEBUG ( 3973): 45acfa7c 4588f068 
I/DEBUG ( 3973): 45acfa80 42ac5600 
I/DEBUG ( 3973): 45acfa84 3efe0000 
I/DEBUG ( 3973): 45acfa88 41bf8e90 
I/DEBUG ( 3973): 45acfa8c 80401d5c /data/data/com.company.app/lib/libjni_filtershow_filters.so
I/DEBUG ( 3973): 45acfa90 df002777 
I/DEBUG ( 3973): 45acfa94 e3a070ad 
I/DEBUG ( 3973): #00 45acfa98 00000004 
I/DEBUG ( 3973): 45acfa9c 00000100 
I/DEBUG ( 3973): 45acfaa0 00000010 
I/DEBUG ( 3973): 45acfaa4 45636b66 
I/DEBUG ( 3973): 45acfaa8 0000002e 
I/DEBUG ( 3973): 45acfaac 00000000 
I/DEBUG ( 3973): 45acfab0 00000000 
I/DEBUG ( 3973): 45acfab4 00000000 
I/DEBUG ( 3973): 45acfab8 00088ff8 
I/DEBUG ( 3973): 45acfabc 0031be08 
I/DEBUG ( 3973): 45acfac0 3f800000 
I/DEBUG ( 3973): 45acfac4 0031be08 
I/DEBUG ( 3973): 45acfac8 0031be48 
I/DEBUG ( 3973): 45acfacc 0031be4c 
I/DEBUG ( 3973): 45acfad0 0031c208 
I/DEBUG ( 3973): 45acfad4 0031c20c 
I/DEBUG ( 3973): 45acfad8 0031c248 
I/DEBUG ( 3973): 45acfadc 0031c24c 
I/DEBUG ( 3973): 45acfae0 3d700000 
I/DEBUG ( 3973): 45acfae4 00000010 
I/DEBUG ( 3973): 45acfae8 00111600 
I/DEBUG ( 3973): 45acfaec 3d700000 
I/DEBUG ( 3973): 45acfaf0 002d1bf0 
I/DEBUG ( 3973): 45acfaf4 804043f8 /data/data/com.company.app/lib/libjni_filtershow_filters.so
I/DEBUG ( 3973): 45acfaf8 804044b8 /data/data/com.company.app/lib/libjni_filtershow_filters.so
I/DEBUG ( 3973): 45acfafc 4055d210 
I/DEBUG ( 3973): 45acfb00 4588f008 
I/DEBUG ( 3973): 45acfb04 0031be08 
I/DEBUG ( 3973): 45acfb08 80018540 /system/lib/libdvm.so
I/DEBUG ( 3973): 45acfb0c 45acfb60 
I/DEBUG ( 3973): 45acfb10 00000000 
I/DEBUG ( 3973): 45acfb14 00000000 
I/DEBUG ( 3973): 45acfb18 4429bf60 
I/DEBUG ( 3973): 45acfb1c 45acfb40 
I/DEBUG ( 3973): 45acfb20 4429bf48 
I/DEBUG ( 3973): 45acfb24 4429bf30 
I/DEBUG ( 3973): 45acfb28 4272be40 
I/DEBUG ( 3973): 45acfb2c 80018378 /system/lib/libdvm.so
I/DEBUG ( 3973): #01 45acfb30 00000288 
I/DEBUG ( 3973): 45acfb34 40572b20 
I/DEBUG ( 3973): 45acfb38 00000100 
I/DEBUG ( 3973): 45acfb3c 00000010 
I/DEBUG ( 3973): 45acfb40 4238ac24 
I/DEBUG ( 3973): 45acfb44 0024ce80 
I/DEBUG ( 3973): 45acfb48 00000000 
I/DEBUG ( 3973): 45acfb4c 80401610 /data/data/com.company.app/lib/libjni_filtershow_filters.so
I/ActivityManager( 119): Process com.company.app (pid 3976) has died.
I/WindowManager( 119): WIN DEATH: Window
{4098ae20 com.company.app/com.company.app.activity.MainActivity paused=false} 
```

分段错误发生在行中

```
int r = rgb[i]; 
```

在循环中间的某个地方。基本上，循环`bitmap`逐个像素地遍历接收的参数，并使用输入对每个像素应用变换`lutbitmap`。对于 432 x 648 像素的图像，它在`i = 561144`访问内存时崩溃。我也用较小的位图检查过它，它仍然崩溃。

rgb 指针寻址的内存应该由`AndroidBitmap_lockPixels()`函数分配。但是，当访问地址时，会发生分段错误。这是功能问题还是我的 HTC Wildfire S 中的硬件错误？有没有人见过这样的事情？

# c# - 如何在我的项目中引用 word 文档

> ID：14523916
> 
> 赞同：0
> 
> 时间：2013-01-25T14:34:25.083
> 
> 标签：c#, asp.net, .net, visual-studio-2010

我想在我的 Visual Studio 项目中使用 word 文件进行编辑并返回文件。

```
Microsoft.Office.Interop.Word.Document tempDoc = null;
try
{
    object missing = System.Reflection.Missing.Value;
    Application wordApp = new Application();

    //I have a copy on C: and this works.
    object useFileName = "C:\\WordFile.doc";

    object readOnly = false;
    object isVisible = false;
    wordApp.Visible = false;
    tempDoc = wordApp.Documents.Open(ref useFileName, ref missing,
        ref missing, ref missing, ref missing, ref missing,
        ref missing, ref missing, ref missing, ref missing,
        ref missing, ref isVisible, ref missing, ref missing,
        ref missing, ref missing);
    ...
    }
    return tempDoc; 
```

如何在我的项目（Content/Documents/WordFile）中引用word文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:38:05.187

也许使用`Server.MapPath`which 指定映射到物理目录的相对或虚拟路径。

```
Server.MapPath("~/Content/Documents/WordFile") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:44:19.350

您可以从 System.Reflection.Assembly.GetExecutingAssembly().Location 获取执行代码的位置；

或者将文档位置放在配置文件中。

# iphone - 如何使用本机移动客户端维护会话状态？

> ID：14523918
> 
> 赞同：0
> 
> 时间：2013-01-25T14:34:26.070
> 
> 标签：iphone, session

考虑到手机上没有存储 cookie（或者有吗？）我知道我不能在手机上使用 cookie，所以我是否只需将 session_id 来回传递给移动客户端？

有什么方法可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:16:42.177

看[这里](https://stackoverflow.com/questions/2053568/managing-http-cookies-on-iphone)

关于通过 NSURLRequest 传输的 cookie 有很好的讨论

# css - 使用 CSS 转换时，如何避免元素溢出其父级？

> ID：14523919
> 
> 赞同：2
> 
> 时间：2013-01-25T14:34:42.630
> 
> 标签：css

我正在使用 CSS 转换来旋转一些元素。但是，旋转的元素可能会部分呈现在其父元素之外。

是否可以避免这种行为？

为了说明我的想法，[这是一个突出这一点的 jsfiddle](http://jsfiddle.net/Z5TZ3/4)。

有两个 div ：

```
<div id="g">
    <div id="inner"></div>
</div> 
```

和一些CSS规则：

```
#g {
    background:silver;
    width:400px;
    height:400px;
    margin:100px 100px 100px 100px;
    border:solid 6px green
}
#inner {
    background:blue;
    width:100px;
    height:100px;
    transform:rotate(45deg);
    -webkit-transform:rotate(45deg);
    -webkit-transform-origin: 0 0;
    transform-origin: 0 0;

} 
```

事实上，蓝色矩形不应该呈现在灰色矩形之外。

实际的：

![在此处输入图像描述](../Images/9e0564620f2beb9d1fc0c4c85dd81b3f.png)

预期的：

![在此处输入图像描述](../Images/de4943d6c4437df922208570848aed01.png)

这个问题背后的主要思想是添加某种具有交互性的视口，但永远不要在视口之外。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T14:36:55.627

添加`overflow: hidden;`到`#g`. 看到这个：http: [//jsfiddle.net/Z5TZ3/5/](http://jsfiddle.net/Z5TZ3/5/)。

它应该如下所示：

```
#g {
    background:silver;
    width:400px;
    height:400px;
    margin:100px 100px 100px 100px;
    border:solid 6px green;
    overflow: hidden;
}
#inner {
    background:blue;
    width:100px;
    height:100px;
    transform:rotate(45deg);
    -webkit-transform:rotate(45deg);
    -webkit-transform-origin: 0 0;
    transform-origin: 0 0;

} 
```

这会给你：

![在此处输入图像描述](../Images/5d7957530f76055cef7fee007b939fc6.png)

# qt - .exe 不能通过 QtCreator 和从 Qt 4.8.1 的外部运行。dll相关问题

> ID：14523922
> 
> 赞同：1
> 
> 时间：2013-01-25T14:34:48.243
> 
> 标签：qt, opencv, dll, entry-point

我在 Windows 7 64 位操作系统上安装了 Qt 4.8.1。我在我的项目中同时使用 opencv 和 Qt。对于 opencv dll，我给出了必要的路径和 .pro 中的所有内容。直到昨天一切正常。我的代码编译成功，但是现在当我运行时，它说 abc.exe 使用代码 -1073741511 执行。

当我从调试或发布文件夹手动运行 .exe 文件时，它说某些入口点无法位于 QtCore4.dll 中。

我尝试了一切，从在 %PATH% 环境变量中设置 Qt & opencv Dlls 到将 dll 复制并粘贴到同一个文件夹到 .exe

我也通过dependency walker看到了.exe，它在QtCore4.dll的Link checksum字段中显示为红色。

有人可以帮我吗？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:06:02.917

确保您没有使用（通过使用我的意思是复制/添加到路径）错误的 dll，我的意思是使用不同编译器构建的 dll，例如默认（MinGW 版本）SDK 有两个版本的 QtCore.dll：正确的一个（用 MinGW 构建）：QT_INSTALL_PATH/qt/bin 和一个用某些版本的 VS 构建的：QT_INSTALL_PATH/bin（这个由 Creator 和其他工具使用）

# django - 通过将自动字段与定义的字符 Django 连接生成的具有值的字段

> ID：14523923
> 
> 赞同：4
> 
> 时间：2013-01-25T14:34:49.273
> 
> 标签：django, django-models

我想`CharField`在我的模型中有一个 Django，其值将通过连接固定值和自动生成值的值来生成，例如 value1: KAM001, Value2:KAM002 ...

我坚持如何实现这一目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T15:50:37.010

有很多方法可以回答您的问题。这实际上取决于此字段的用途以及您希望何时自动生成代码（在保存记录之前或之后）。

在下面的代码中，我定义了一个 Charfield，它存储具有固定部分 ('KAM') 和增量部分 ('001', '002', ...) 的代码，这些部分都没有在其他地方定义。 **保存对象时**，字段*代码*（如果为空）将逐步填充。

```
class MyModel(models.Model):
    code = models.CharField(blank=True, default='')

    def save(self, force_insert=False, force_update=False):
        if self.code == "":
            existing_codes = MyModel.objects.all().order_by('-code')
            if existing_codes.count() > 0:
                new_code = int(existing_codes[0].code[1:]) + 1
            else:
                new_code = 0
            self.code = 'KAM%03d' % new_code
        super(MyModel, self).save(force_insert, force_update) 
```

如果要将字符串连接到自动增量字段，则代码稍微不那么复杂：

```
class MyModel(models.Model):
    id = models.AutoField(primary_key=True)
    code = models.CharField(blank=True, default='')

    def save(self, force_insert=False, force_update=False):
        self.code = 'KAM%08d' % self.id
        super(MyModel, self).save(force_insert, force_update) 
```

如果您希望**在保存记录之前**定义代码，您可以使用这种方法：

```
class MyModel(models.Model):
    code = models.CharField(blank=True, default=new_code)

    @property
    def new_code(self):
        existing_codes = MyModel.objects.all().order_by('-code')
        if existing_codes.count() > 0:
            new_code = int(existing_codes[0].code[1:]) + 1
        else:
            new_code = 0
        return 'KAM%03d' % new_code 
```

但请注意，如果在保存第一个对象之前实例化了两个对象，则此方法可能会生成重复值，因此我不鼓励您使用此方法。

其他方法可能使用信号、触发器等。这些只是众多方法中的一部分。

例如，如果您不需要基于“Charfield 字段”执行查询，我建议您使用另一种方法：

```
class MyModel(models.Model):
    # ... your fields here

    def my_code(self):
        return 'KAM%08d'%self.pk  # please note that I've added more padding zeroes 
```

这可以通过这种方式从您的模板中调用：

```
{{obj.my_code}} 
```

其中 obj 是 MyModel 的一个实例

如果您还需要更改某些记录的初始部分（“KAM”部分），“保存时定义”方法是可行的方法。

# css - :before/:after 伪元素的内容垂直居中

> ID：14523927
> 
> 赞同：67
> 
> 时间：2013-01-25T14:35:13.927
> 
> 标签：css, css-selectors, pseudo-element

我正在尝试实现与这张图片类似的东西：

![在此处输入图像描述](../Images/1c541ab7e41912c065faa39390baf72c.png)

我有一个包含在 div 中的图像（作为幻灯片的一部分），并且使用 :before 和 :after 伪元素，我显示了两个控件以移动到幻灯片的下一个 (>>) 或上一个 (<<) 图像.

到目前为止，我有这个：

```
div {
  position: relative;
}

div:before {
  display:block;
  height: 100%;
  content: "stuff";
  position:absolute;
  top: 0; left: 0;
  text-align: center;
} 
```

但是，我不能将伪元素的内容居中，文本显示如下：

![在此处输入图像描述](../Images/c743259a65959deabd83d9017e751f57.png)

这有可能实现吗？如果不是，最语义化的解决方法是什么？我不想将元素本身居中，而只是将其内容居中。我更喜欢将元素拉伸到 100% 的高度。

**编辑：http:** [//jsfiddle.net/rdy4u/](http://jsfiddle.net/rdy4u/)

**Edit2：**另外，img 是液体/流体，div/img 的高度未知，宽度设置为 800px 和`max-width`80%。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2013-01-25T14:47:27.527

假设您的元素不是 a `<img>`（因为自闭合元素上不允许使用伪元素），让我们假设它是 a `<div>`，因此一种方法可能是：

```
div {
    height: 100px ;
    line-height: 100px;
}
div:before, div:after {
    content: "";
    ...
    display: inline-block;
    vertical-align: middle;
    height: ...;
    line-height: normal;
} 
```

如果您无法更改 div 的 line-height，另一种方法是：

```
div {
    position: relative;
}
div:before, div:after {
    position: absolute;
    display: block;
    top: 50%;
    -webkit-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);
    content: "";
    width: ...
} 
```

否则，只需将指示器作为背景放置在中心位置。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2017-09-12T13:29:34.847

在伪元素的 css 中使用 flex 非常简单：

```
.parent::after {
  content: "Pseudo child text";
  position: absolute;
  top: 0;
  right: 0;
  width: 30%;
  height: 100%;
  border: 1px solid red;
  display:flex;
  flex-direction:row;
  align-items: center;
  justify-content: center;
} 
```

见[https://jsfiddle.net/w408o7cq/](https://jsfiddle.net/w408o7cq/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-09-25T20:38:40.780

使用 flex box，你应该先在父级中设置一个固定的宽度和高度，然后

```
div::after {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-12-17T12:38:10.313

我知道我参加聚会迟到了，但这个简单的弹性解决方案对我来说就像一种魅力，以防它对你们中的任何人有所帮助。

```
.main-div {
    display: flex;
    align-items: center;
}

.my-div-name:before, .my-div-name:after {
    /* This content will be vertically centered with the attributes of the main-div */
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-06-23T19:53:44.027

**您可以在不借助图像的情况下做到这一点。**（有时您不能，例如在 :before 或 :after 中使用字体图标）。

```
div {
   position: relative;
   overflow:hidden;
}

div:before, div:after {
   position: absolute;
   display: block;
   top: 50%;
   -webkit-transform: translateY(-50%);
   -moz-transform: translateY(-50%);
   -ms-transform: translateY(-50%);
   transform: translateY(-50%);

   height:20000px;
   line-height:20000px;

   content: ">>";
} 
```

诚然，使用 20000px 有点厚颜无耻。

**在您的情况下，您在 div 中有一个图像，因此使用 display:block 命中该图像**（图像不默认为 display:block）

这是针对您的特定情况的更新小提琴。[http://jsfiddle.net/rdy4u/56/](http://jsfiddle.net/rdy4u/56/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-09T17:25:17.550

这是一种使用 :before 和 :after 伪元素创建下一个和上一个控件的方法。以及为上一个/下一个按钮创建三角形的边框技巧。它不会给你一个 100% 高度的区域来点击，但是如果你让三角形（箭头）足够大，它应该可以弥补这一点。

```
div {
  position: relative;
  width: 800px;
  max-width: 80%;
  border: 1px solid red;
  text-align: center;
  margin: 0 auto;
}

div:before, div:after {
  opacity: 0.5;
  display:block;
  content: "";
  position:absolute;
  width: 0; 
  height: 0;
  }

div:before {
  top: 40%; left: 0;
  border-top: 25px solid transparent; 
  border-right: 50px solid blue; 
  border-bottom: 25px solid transparent;
}

div:after {
  top: 40%; right: 0;
  border-top: 25px solid transparent; 
  border-left: 50px solid blue; 
  border-bottom: 25px solid transparent;
} 
```

这是代码工作：http: [//jsfiddle.net/fiddleriddler/rPPMf/](http://jsfiddle.net/fiddleriddler/rPPMf/)

# shell - yum update 在脚本中调用时忽略排除

> ID：14523934
> 
> 赞同：0
> 
> 时间：2013-01-25T14:35:26.923
> 
> 标签：shell, scripting, centos, yum

所以，我正在尝试 CentOS 的更新（升级）脚本

我有一个用于测试的 Virtualbox VM，我有一个可以回滚到的快照

该脚本是用破折号（不是 bash）编写的，这些是我的脚本中重要的几行：

```
HOLDPKGS=(kernel python) 
```

以下循环很好地添加了字符串

```
for paket in ${HOLDPKGS[*]}
do
  HOLDSTRING="--exclude=\"$paket*\" $HOLDSTRING"
done 
```

问题出在这里：

```
yum $HOLDSTRING -y update >> "$UPGRADE_LOGFILE" 2>&1 
```

当我使用 sh -x < scriptname > 运行脚本时，这是输出（很重要）：

```
+ HOLDSTRING='--exclude="python*" --exclude="kernel*" '
++ yum '--exclude="python*"' '--exclude="kernel*"' -y update 
```

它在没有错误的情况下完成更新，并且没有关于语法的警告。

Yum 完全忽略了排除指令。这是我在日志中看到的：

```
Dependencies Resolved

================================================================================
 Package                 Arch   Version                           Repository
                                                                           Size
================================================================================
Installing:
 kernel                  x86_64 2.6.32-279.19.1.el6               updates  25 M
Updating:
 cpio                    x86_64 2.10-11.el6_3                     updates 192 k
 dhclient                x86_64 12:4.1.1-31.0.1.P1.el6.centos.1   updates 317 k
 dhcp-common             x86_64 12:4.1.1-31.0.1.P1.el6.centos.1   updates 141 k
 dracut                  noarch 004-284.el6_3.1                   updates 112 k
 dracut-kernel           noarch 004-284.el6_3.1                   updates  21 k
 glibc                   x86_64 2.12-1.80.el6_3.6                 updates 3.8 M
 glibc-common            x86_64 2.12-1.80.el6_3.6                 updates  14 M
 initscripts             x86_64 9.03.31-2.el6.centos.1            updates 935 k
 kernel-firmware         noarch 2.6.32-279.19.1.el6               updates 8.7 M
 krb5-libs               x86_64 1.9-33.el6_3.3                    updates 713 k
 libblkid                x86_64 2.17.2-12.7.el6_3                 updates 112 k
 libssh2                 x86_64 1.2.2-11.el6_3                    updates  75 k
 libudev                 x86_64 147-2.42.el6                      updates  75 k
 libuuid                 x86_64 2.17.2-12.7.el6_3                 updates  65 k
 mysql-libs              x86_64 5.1.66-2.el6_3                    updates 1.2 M
 nspr                    x86_64 4.9.1-2.el6_3                     updates 111 k
 nss                     x86_64 3.13.5-1.el6_3                    updates 763 k
 nss-sysinit             x86_64 3.13.5-1.el6_3                    updates  32 k
 nss-tools               x86_64 3.13.5-1.el6_3                    updates 729 k
 nss-util                x86_64 3.13.5-1.el6_3                    updates  53 k
 openldap                x86_64 2.4.23-26.el6_3.2                 updates 262 k
 openssl                 x86_64 1.0.0-25.el6_3.1                  updates 1.4 M
 python                  x86_64 2.6.6-29.el6_3.3                  updates 4.8 M
 python-libs             x86_64 2.6.6-29.el6_3.3                  updates 623 k
 redhat-logos            noarch 60.0.14-12.el6.centos             updates  15 M
 selinux-policy          noarch 3.7.19-155.el6_3.14               updates 1.3 M
 selinux-policy-targeted noarch 3.7.19-155.el6_3.14               updates 2.6 M
 sudo                    x86_64 1.7.4p5-13.el6_3                  updates 423 k
 tzdata                  noarch 2012j-1.el6                       updates 453 k
 udev                    x86_64 147-2.42.el6                      updates 361 k
 util-linux-ng           x86_64 2.17.2-12.7.el6_3                 updates 1.5 M 
```

我试过这样做：

```
echo yum $HOLDSTRING -y update >> "$UPGRADE_LOGFILE" 2>&1 
```

并粘贴输出：

```
yum --exclude="python*" --exclude="kernel*" -y update 
```

入壳。完成得很好（忽略了内核和python）

```
Dependencies Resolved

================================================================================
 Package                 Arch   Version                           Repository
                                                                           Size
================================================================================
Updating:
 cpio                    x86_64 2.10-11.el6_3                     updates 192 k
 dhclient                x86_64 12:4.1.1-31.0.1.P1.el6.centos.1   updates 317 k
 dhcp-common             x86_64 12:4.1.1-31.0.1.P1.el6.centos.1   updates 141 k
 dracut                  noarch 004-284.el6_3.1                   updates 112 k
 dracut-kernel           noarch 004-284.el6_3.1                   updates  21 k
 glibc                   x86_64 2.12-1.80.el6_3.6                 updates 3.8 M
 glibc-common            x86_64 2.12-1.80.el6_3.6                 updates  14 M
 initscripts             x86_64 9.03.31-2.el6.centos.1            updates 935 k
 krb5-libs               x86_64 1.9-33.el6_3.3                    updates 713 k
 libblkid                x86_64 2.17.2-12.7.el6_3                 updates 112 k
 libssh2                 x86_64 1.2.2-11.el6_3                    updates  75 k
 libudev                 x86_64 147-2.42.el6                      updates  75 k
 libuuid                 x86_64 2.17.2-12.7.el6_3                 updates  65 k
 mysql-libs              x86_64 5.1.66-2.el6_3                    updates 1.2 M
 nspr                    x86_64 4.9.1-2.el6_3                     updates 111 k
 nss                     x86_64 3.13.5-1.el6_3                    updates 763 k
 nss-sysinit             x86_64 3.13.5-1.el6_3                    updates  32 k
 nss-tools               x86_64 3.13.5-1.el6_3                    updates 729 k
 nss-util                x86_64 3.13.5-1.el6_3                    updates  53 k
 openldap                x86_64 2.4.23-26.el6_3.2                 updates 262 k
 openssl                 x86_64 1.0.0-25.el6_3.1                  updates 1.4 M
 redhat-logos            noarch 60.0.14-12.el6.centos             updates  15 M
 selinux-policy          noarch 3.7.19-155.el6_3.14               updates 1.3 M
 selinux-policy-targeted noarch 3.7.19-155.el6_3.14               updates 2.6 M
 sudo                    x86_64 1.7.4p5-13.el6_3                  updates 423 k
 tzdata                  noarch 2012j-1.el6                       updates 453 k
 udev                    x86_64 147-2.42.el6                      updates 361 k
 util-linux-ng           x86_64 2.17.2-12.7.el6_3                 updates 1.5 M 
```

如您所见，在下面的示例中，我们没有内核包，这正是我们想要的。

有谁看到我做错了什么？：/

PS 我刚刚尝试在 bash 环境中运行脚本，但问题仍然存在：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:02:01.783

问题是你的报价。没有包匹配`"kernel*"`，但有包匹配`kernel*`。但[无论如何你都应该使用数组](http://mywiki.wooledge.org/BashFAQ/050)。

```
HOLDARR=()
for paket in ${HOLDPKGS[*]}
do
  HOLDARR+=(--exclude="$paket*")
done

yum "${HOLDARR[@]}" -y update 
```

# c# - 在 Windows 注册表中保存设置以在打开 Windows 应用程序时提示重新启动

> ID：14523937
> 
> 赞同：-2
> 
> 时间：2013-01-25T14:35:42.257
> 
> 标签：c#, registry

我想通过我的应用程序在 Windows 注册表中存储一个值，以便在重新打开我的应用程序时提示重新启动。

此重新启动提示应该是特定于用户的。

在注册表中添加此设置的适当位置是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:42:27.770

这是一篇关于使用 c# 设置注册表的 Microsoft 文章：http: [//msdn.microsoft.com/en-us/library/h5e7chcf.aspx](http://msdn.microsoft.com/en-us/library/h5e7chcf.aspx)

您需要考虑的问题是：

1.  您打算将值放在注册表中的哪个位置？HKEY_LOCAL_MACHINE，HKEY_CURRENT_USER。如果你把它放在HKEY_CURRENT_USER中，那么如果另一个用户登录，你将不会得到提示
2.  您的用户有哪些权限可以写入注册表？在某些企业中，大多数用户不是管理员，可能无法向 HKEY_LOCAL_MACHINE 写入任何内容。

可能有更好的方法来完成您正在尝试做的事情（例如更改应用设置中的设置）。但这取决于你在做什么以及为什么。

# android - 加载具有不同于默认状态的活动

> ID：14523942
> 
> 赞同：0
> 
> 时间：2013-01-25T14:36:08.763
> 
> 标签：android

我的应用程序中有两个活动。Activity1 有一个列表视图和两个按钮（比如 button1 和 button2）。根据用户单击哪个按钮，列表视图中的内容会相应更改。活动的默认加载是让 button1 单击活动 1 中加载的内容。在我的 Activity2 中，我有一个按钮（比如 button3），当点击它时，它必须加载 Activity1，但列表视图加载了 button2 点击结果，而不是显示 button1 点击结果的默认显示。关于如何实现这一点的任何帮助？在 activity2 中 button3 的 onclick 事件上，我可以加载 activity1 ，但这将加载显示 button1 点击结果的默认状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:42:53.570

从第二个活动发送带有标志的 Intent。在第一个活动中，请始终注意此标志并相应地触发您的第二个按钮代码。作为参考，您可以在此处或谷歌搜索“在活动之间传递数据”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:48:16.640

在活动之间切换时，通过使用 IntentHandler 传递一个额外的字符串来保存 ListView 的状态：

```
Intent intent = new Intent(getBaseContext(), yourActivity.class);
intent.putExtra("LISTVIEW_STATE", myListViewState);
startActivity(intent); 
```

然后在您接收活动的 onCreate() 方法（在本例中为 yourActivity）中，您可以通过以下方式获取状态：

```
Intent intent = getIntent();
String recievedListViewState = intent.getStringExtra("LISTVIEW_STATE"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T14:53:08.487

您可以通过在 Intent 上添加 Extras 来做到这一点。现在，当您从 Activity2 启动 Activity1 时，您的代码可能如下所示：

```
Intent intent = new Intent(Activity2.this, Activity1.class);
startActivity(intent); 
```

您可以使用 Intent 上的`putExtra()`方法在此 Intent 上设置一个键值对（称为额外），使其看起来像这样。

```
Intent intent = new Intent(Activity2.this, Activity1.class);
intent.putExtra("LIST_TO_DISPLAY", "LIST_2");    
startActivity(intent); 
```

（键）的第一个参数`putExtra()`始终是字符串，第二个参数（值）可以是许多不同的数据类型。这也是一个字符串。

一旦 Activity1 启动，您可以通过使用来获取 Intent，`getIntent()`然后从中提取额外的内容，全部在`onCreate()`.

```
protected void onCreate(Bundle b)
{
    Intent intent = getIntent();
    String whichList = intent.getStringExtra("LIST_TO_DISPLAY"); //which List now equals "LIST_2"

    if( whichList != null && "LIST_2".equals(whichList) )
    {
        //Set up List 2
    }
    else
    {
        //Set up the default list
    }
} 
```

[这是 Intent Class 的文档](http://developer.android.com/reference/android/content/Intent.html)。您可以找到所有 put 和 get Extra 方法的说明，以及一些其他信息，这些信息在您想要自定义启动活动的行为方式时可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:58:00.943

我不明白，所以你会想到几件事。

...

Activity1 -> Button1 -> 列表视图（内容 A）

Activity1 -> Button2 -> ListView（内容 B）

Activity1 -> Activity2 -> Button3 -> Activity1 -> ListView（内容 B）

所以你可以

在活动1

开始活动（intentActivity2）；

在活动2

intentResult.putExtra("cmd", "button3"); onbutton 点击​​ setResult(RESULT_OK,intentresult) 并完成

回到活动1

onActivityResult resultIntent.getExtra("cmd")

# android - .h：没有这样的文件或目录 NDK Android

> ID：14523946
> 
> 赞同：0
> 
> 时间：2013-01-25T14:36:20.183
> 
> 标签：android, android-ndk, cygwin

嗨，Ivgot 设置了 gnu make buldier Cros GCC，以及由 cygwin 创建的 javah，. hedaer 文件。我在同一个 jni 目录中有 .h 和 .cpp：我不明白这个错误：

```
 make all 
     Building file: ../jni/com_jp_algi_CoreC.cpp
  Invoking: Cross G++ Compiler
     g++ -I"C:\android-ndk-r5c\platforms\android-9\arch-arm\usr\include" -O0 -g3 -           Wall -c -fmessage-length=0 -MMD -MP -MF"jni/com_jp_algi_CoreC.d" -                MT"jni/com_jp_algi_CoreC.d" -o "jni/com_jp_algi_CoreC.o" "../jni/com_jp_algi_CoreC.cpp"
         ../jni/com_jp_algi_CoreC.cpp:2:31: fatal error: com_jp_algi_CoreC.h: No such            file or        directory
   jni/subdir.mk:18: recipe for target `jni/com_jp_algi_CoreC.o' failed
   compilation terminated.
    make: *** [jni/com_jp_algi_CoreC.o] Error 1 
```

Android buldier 可以工作，但是 ...Syas 这个错误没有实现 ....antive。我必须使用我的外部制作，当我在cygwin中通过javah创建.h时......也许我将这个java项目转换为C++ - 添加性质..也许会有问题？

我得到了这个.mk：

```
 LOCAL_PATH := $(call my-dir)

   include $(CLEAR_VARS)

  LOCAL_MODULE    := com_jp_algi_CoreC
LOCAL_SRC_FILES := com_jp_algi_CoreC.cpp

   include $(BUILD_SHARED_LIBRARY) 
```

.cpp：

```
 #include <com_jp_algi_CoreC.h>
    /* Header for class com_jp_algi_CoreC */

  extern "C" {

  JNIEXPORT void JNICALL Java_com_jp_algi_CoreC_vector
 (JNIEnv *env, jobject clazz, jfloatArray input){
jfloat* flt1=NULL ;
jsize size = env->GetArrayLength(input);
jint i;
// check if array size >0 and wedont cause exception

// allocate buffer for array and get data from Java array
flt1  = new jfloat[size];
env->GetFloatArrayRegion(input,0,size,flt1);
// exception check. Always use exception check

// do stuff to the array

for (i = 0 ; i < size; i++){
    flt1[i] = 1;
}

// vector(flt1);
// set result to Java array and delete buffer. And exception check of course
env->SetFloatArrayRegion(input,0,size,flt1);
delete[] flt1;

// All is ok

  }

 JNIEXPORT void JNICALL Java_com_jp_algi_CoreC_vector2
  (JNIEnv *, jobject, jfloatArray, jobjectArray);

   } 
```

.h: /* 请勿编辑此文件 - 它是机器生成的*/#include /* com_jp_algi_CoreC 类的标头 */

```
 #ifndef _Included_com_jp_algi_CoreC
      #define _Included_com_jp_algi_CoreC
    #ifdef __cplusplus
    extern "C" {
       #endif
    /*
  * Class:     com_jp_algi_CoreC
 * Method:    vector
 * Signature: ([F)V
    */
  JNIEXPORT void JNICALL Java_com_jp_algi_CoreC_vector
    (JNIEnv *, jobject, jfloatArray);

      /*
     * Class:     com_jp_algi_CoreC
   * Method:    vector2
    * Signature: ([F[[F)V
        */
JNIEXPORT void JNICALL Java_com_jp_algi_CoreC_vector2
   (JNIEnv *, jobject, jfloatArray, jobjectArray);

   #ifdef __cplusplus
  }
 #endif
    #endif 
```

这个 CoreC 类：

```
 package com.jp.algi;

  public class CoreC {
        static {
    System.loadLibrary("com_jp_algi_CoreC");
    }

public native void vector(float[] input);

public native void vector2(float[] input, float[][] input2);

      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:49:31.767

您确定“com_jp_algi_CoreC.h”文件包含在“com_jp_algi_CoreC.cpp”文件中吗？

你的 Android.mk 文件看起来像这样吗？

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := module_name
LOCAL_SRC_FILES := com_jp_algi_CoreC.cpp

include $(BUILD_SHARED_LIBRARY) 
```

你的Android项目里面的目录结构是这样的吗？

```
jni/
├── Android.mk
├── com_jp_algi_CoreC.h
├── com_jp_algi_CoreC.cpp 
```

也尝试从项目的根目录而不是 Eclipse 运行**ndk-build**，看看是否有任何区别。

编辑：使用您的代码，我创建了一个测试 Android 应用程序并使用 **ndk-build**编译了本机代码，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T21:46:24.013

你的 NDK 已经很老了。新版本中有许多改进和错误修复。今天最新的是 r8d，它可以在没有 cygwin 的 Windows 上运行。

关于您的代码，您根本不需要该`#include`语句，如果您只是删除 .cpp 文件的第一行，它将正确编译和链接。

# c++ - 如果被外部级别调用者捕获，C++ 异常是否超出范围？

> ID：14523947
> 
> 赞同：1
> 
> 时间：2013-01-25T14:36:21.977
> 
> 标签：c++, exception

我做了一些研究，试图找到在我遇到的代码中实现异常的正确方法

```
 Throw by value, catch by reference 
```

成为 C++ 中处理异常的推荐方式。我对抛出的异常何时超出范围感到困惑。

我有以下异常层次结构

```
 ConnectionEx is mother of all connection exceptions thrown by dataSender
    ConnectionLostEx is one of the subclasses of ConnectionEx 
```

所以这是一个示例代码。换句话说，DataSender 实例是 DataDistrubutor 的成员，它调用 dataSender 上的函数，例如 send() 并且 DataSender 在出现问题时将 ConnectionEx 的子类作为异常抛出。

```
// dataSender send() function code chunk

try
{
   // some problem occured
       // create exception on stack and throw
   ConnectionLostEx ex("Connection lost low signals", 102);
   throw ex;
}
catch(ConnectionLostEx& e)
{
    //release resources and propogate it up
    throw ;
}

//A data distributor class that calls dataSender functions
try
{
    // connect and send data
    dataSender.send();  
}
catch(ConnectionEx& ex)
{
       // free resources
       // Is the exception not out of scope here because it was created on stack of orginal block?
       //propogate it further up to shows cause etc..

} 
```

在 C# 或 java 中，我们有一个类似引用的指针，并且它一直有效，我对异常的范围感到困惑，因为异常是由值抛出的，什么时候超出范围？？？并且在这种情况下，当作为父类型 ConnectionEx 被捕获时，是否可以将其转换为真正的返回到捕获块链中的某个位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:40:44.433

抛出异常的副本，而不是原始对象。无需实例化局部变量并抛出它；抛出异常的惯用方法是实例化它并将其抛出在同一行。

```
throw ConnectionLostEx("Connection lost low signals", 102); 
```

# android - Google Maps Android API v2 SupportMapFragment 内存泄漏

> ID：14523949
> 
> 赞同：18
> 
> 时间：2013-01-25T14:36:33.163
> 
> 标签：android, google-maps-android-api-2, android-maps-v2, supportmapfragment

使用 2 个简单的活动。第一个活动只包含一个按钮来启动第二个包含地图的活动：

主要活动：

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

public void goToMap(View view){ //This is just the onClick method for the button
    Intent intent=new Intent( this, BigMapTest.class);
    startActivity(intent);
} 
```

地图活动：

```
public class BigMapTest extends FragmentActivity {
SupportMapFragment mapFragment;
GoogleMap map;

@Override
protected void onCreate(Bundle arg0) {
    // TODO Auto-generated method stub
    super.onCreate(arg0);

    setContentView(R.layout.travel_diary_big_map);

    mapFragment=(SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.big_map);
    map=mapFragment.getMap();

} 
```

地图活动的 XML 布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<fragment
        android:id="@+id/big_map"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        class="com.google.android.gms.maps.SupportMapFragment"  
        /> 
```

现在，当我运行这段代码时，按下按钮移动到带有地图的 Activity，然后按下返回到第一个 Activity ......然后重复这个过程，我可以看到堆的大小每次都在增加，直到达到这是极限，然后它开始夹紧。如果您在地图（即缩放）方面搞得更糟一点，此时我可能会遇到 OOM 异常。

> 01-25 16:10:13.931: D/dalvikvm(21578): GC_FOR_ALLOC 释放 1898K, 7% 空闲 45859K/49187K, 暂停 204ms 01-25
> 16:10:14.671: I/dalvikvm-heap(21578): 钳制目标 GC堆从 52.724MB 到 48.000MB 01-25
> 16:10:14.671：D/dalvikvm(21578)：GC_CONCURRENT 释放 2534K，6% 空闲 46554K/49187K，暂停 3ms+14ms
> 01-25 16:10:15.372：I/dalvikvm -heap(21578): 将目标 GC 堆从 52.979MB 钳制到 48.000MB 01-25
> 16:10:15.382: D/dalvikvm(21578): GC_CONCURRENT freed 2273K, 5% free 46815K/49187K, paused 3ms+15ms
> 01-25 16:10:15.622: I/dalvikvm-heap(21578): 将目标 GC 堆从 52.604MB 钳制到 48.000MB 01-25
> 16:10:15.622: D/dalvikvm(21578): GC_FOR_ALLOC 释放 657K，6% 释放 46431K/ 49187K，暂停 202ms
> 01-25 16:10:16.203：I/dalvikvm-heap(21578)：将目标 GC 堆从 52.959MB 钳制到 48.000MB 01-25
> 16:10:16.203：D/dalvikvm(21578)：GC_FOR_ALLOC 释放 1469K，5%免费 46796K/49187K，暂停 217 毫秒 01-25
> 16:10:16.203：I/dalvikvm-heap(21578)：强制收集软引用以分配 278744 字节
> 01-25 16:10:16.423：I/dalvikvm-heap(21578 ): 将目标 GC 堆从 52.952MB 钳制到 48.000MB 01-25
> 16:10:16.423: D/dalvikvm(21578): GC_BEFORE_OOM 释放 9K, 5% free 46786K/49187K, 暂停 219ms 01-25
> 16:10:16.423: E/dalvikvm-heap(21578)：278744 字节分配内存不足。

任何建议/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-26T15:10:53.717

从一些基本的 MAT 侦查中我可以看出，您所看到的是由 Maps V2 维护的下载地图数据的缓存。如果您平移和缩放很多，缓存似乎更大。如果您离开地图并稍后返回新地图，缓存会缩小。我无法从 N 次启动示例应用程序的地图活动中获得 N 个缓存，并且缓存大小会根据用户的操作而起伏。

唉，这个缓存是不可配置的，AFAIK，就它有多大，当它被清除时，它是否溢出到磁盘等方面。

因此，默认情况下，您所能做的就是留出一部分健康的堆空间供 Maps V2 使用，并采取措施保持在这个较小的堆子集中。

如果您想进行试验，您可以尝试调用`clear()`,`GoogleMap`或`onLowMemory()`您的`SupportMapFragment`, 以查看是否有任何帮助减少此缓存大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-26T21:58:44.303

> [Android 开发者下午 5:10 - Google+ 页面](https://plus.google.com/+AndroidDevelopers/posts/A2HCnmMciNh)
> 
> 我们正在推出 Google Play 服务 v3.0，其中引入了 Google+ 登录和 Google Maps Android API 改进。

[自 2013 年 2 月 26 日起， gmaps-api-issues 页面](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4766)上也描述了此问题，现在已由当前的[Google API 更新](http://android-developers.blogspot.de/2013/02/google-sign-in-now-part-of-google-play.html)修复。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-30T09:13:10.223

我也有完全一样的问题。每次托管 V2 地图的活动开始时，内存都会增加。即使活动完成，它也不会被释放。

所以解决方法是重用该活动。`singleTask`在清单中制作活动，而不是`finish()`使用它`moveTaskToBack(true);`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-25T14:44:52.350

**在您的布局中使用它：**

```
<LinearLayout
        android:id="@+id/map_container2"
        android:layout_width="match_parent"
        android:layout_height="200dp"
        android:layout_weight="35.22"
        android:orientation="horizontal" >

        <fragment
            android:id="@+id/map1"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_weight="1"
            class="com.google.android.gms.maps.SupportMapFragment"
            map:cameraTargetLat="40.72"
            map:cameraTargetLng="-74.00"
            map:cameraZoom="8" />
    </LinearLayout> 
```

**而这段代码：**

```
onCreate{
   setUpMapIfNeeded();
}

private void setUpMapIfNeeded() {
        // TODO Auto-generated method stub
        // Do a null check to confirm that we have not already instantiated the map.
        if (mMap == null) {
            // Try to obtain the map from the SupportMapFragment.
            mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map1))
                    .getMap();
            // Check if we were successful in obtaining the map.
            if (mMap != null) {
                setUpMap();
            }
        }
    }

private void setUpMap() {
        // TODO Auto-generated method stub
         // Hide the zoom controls as the button panel will cover it.
        mUiSettings = mMap.getUiSettings();
 // Enables/disables zoom gestures (i.e., double tap, pinch & stretch).
        mMap.getUiSettings().setZoomGesturesEnabled(false);
// Enables/disables scroll gestures (i.e. panning the map).
        mMap.getUiSettings().setScrollGesturesEnabled(false);
 // Enables/disables the compass (icon in the top left that indicates the orientation of the
        // map).
        mMap.getUiSettings().setCompassEnabled(false);
        // Add lots of markers to the map.
        addMarkersToMap();

        // Pan to see all markers in view.
        // Cannot zoom to bounds until the map has a size.
        final View mapView = getSupportFragmentManager().findFragmentById(R.id.map1).getView();
        if (mapView.getViewTreeObserver().isAlive()) {
            mapView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
                @SuppressLint("NewApi") // We check which build version we are using.
                @Override
                public void onGlobalLayout() {
                    LatLngBounds bounds = new LatLngBounds.Builder()
                            .include(WOODS)
                            .build();
                    if (Build.VERSION.SDK_INT < Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
                      mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                    } else {
                      mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
                    }
                    mMap.moveCamera(CameraUpdateFactory.newLatLngBounds(bounds, 50));
                }
            });
        }
    }

private void addMarkersToMap() {
        // TODO Auto-generated method stub
         // Uses a colored icon.
        mWoods = mMap.addMarker(new MarkerOptions()
                .position(WOODS)
                .title("Woods")
                .snippet("R. Quatá, 1016, Vila Olimpia - (11) 3849-6868")
                .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
    } 
```

# php - 保护 HMVC 模块免受未登录用户的攻击

> ID：14523951
> 
> 赞同：0
> 
> 时间：2013-01-25T14:36:34.737
> 
> 标签：php, security, codeigniter, authentication, hmvc

我正在使用 HMVC 模式和 CodeIgniter 开发一个网站。

如果用户未登录，我有一些模块永远无法访问。

当用户登录时，它会设置一个会话`is_logged_in`

现在，我尝试了这段代码，它*似乎*可以正常工作，但是我不确定它是否安全。

我把它放在*控制器构造函数*中：

```
if ($this->session->userdata('is_logged_in') == NULL) { exit; } 
```

这是安全的，还是可以绕过？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:53:40.993

您可以创建像`MY_Controller`这样的核心子类控制器，它有一个调用您的安全性的构造函数，然后通过在您想要保护的控制器上扩展它。这比将它一个一个地放在控制器上要好得多，因此代码可重用。至于安全问题，添加一些只有您的系统才能读取的独特会话就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T15:08:40.703

// 使助手助手，例如。my_login_helper

```
if (!function_exists('is_logged_in')){

    function is_logged_in(){
        // Get current CI instance
        $CI =& get_instance();
        // use $CI->session instead of $this->session
        $user = $CI->session->userdata('is_logged_in');
        if (!isset($user)) { return false; } else { return true; }
    } 

  } 
```

// 在每个控制器上重复相同的代码只是为了检查用户是否登录 // make My_Controller

```
 function _remap($method)
    {
        if (method_exists($this, $method) && $this->my_login_helper->is_logged_in())
        { $this->$method(); }
        else {  redirect('/auth/'); }
    } 
```

# java - 当 jar 不在类路径上时，如何将 3rd 方 jar 的源绑定到 eclipse 以进行调试

> ID：14523955
> 
> 赞同：0
> 
> 时间：2013-01-25T14:36:46.860
> 
> 标签：java, eclipse, debugging, jar

我在我的应用程序中使用了第 3 方开源 jar。我在 Eclipse 中开发应用程序。jar 实际上不在应用程序的类路径上，它是由依赖注入框架（此处为 OSGI Felix）动态加载的。

我有 jar 的来源，但我不想构建它。

如何在Eclipse中将源绑定到jar，以便我可以通过这个jar的代码放置断点和调试？

我认为如果 jar 在类路径上，情况会有所不同，所以我强调这个事实。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T14:43:10.203

当你在 Eclipse 中进入你的方法时，如果你没有 jar 的源代码，你最终会得到这个编辑器窗口：

![在此处输入图像描述](../Images/8ec848d0b40a586be350cf704548ae82.png)

只需单击`Attach Source..`按钮，然后选择包含源代码的 jar。您将能够放置断点并进入方法。

# php - php从字符串生成html页面

> ID：14523956
> 
> 赞同：0
> 
> 时间：2013-01-25T14:36:51.040
> 
> 标签：php, html

我有这个脚本来为公司从 .xls 列表中拥有的每个商店位置生成静态 html 页面，然后脚本根据关键字字符串在商店位置之后对 url 进行编码。

现在是：

```
keyword_string = "key1 key2 key3 key4 key5";

function urlX($location) {
        return $this->xURL($location).'/'.urlencode($this->keyword_string).'.html';
    } 
```

如何让它读取 2 甚至 3 个关键字字符串的变体并随机化 html urlencode？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T16:46:38.910

这将创建真正随机的链接。如果您希望拥有一组关键字字符串集（即：keyword_string_1 = "key1 key2 key3"、keyword_string_2 = "key2 key3 key1" 等...）并选择一个随机集附加到每个位置，此方法可以是在更简单的尺度上使用。可能还有几种方法可以加快速度。

```
$keyword_string = "key1 key2 key3 key4 key5";

function urlX($location) {
   global $keyword_string;
   $keyword_string = @explode(" ", $keyword_string);
   if(is_array($keyword_string)){
      $total = count($keyword_string);
      $random_keys = Array();
      for($i=0; $i<$total; $i++){
         $new = rand(0,$total-1);
         while(in_array($new,$random_keys)){
            $new = rand(0,$total-1);
         }
         array_push($random_keys, $new);
      }
   }
   $page = "";
   foreach($random_keys as $key){
      $page .= $keyword_string[$key] . " ";
   }

   return $location . "/" . urlencode(trim($page)) . ".html";

} 
```

新增：

这是适用于一组随机字符串的上述代码。您可以预加载其他字符串并将它们添加到`$keyword_string`数组的末尾。

```
$keyword_string_1 = "key1 key2 key3 key4 key5";
$keyword_string_2 = "key2 key3 key4 key5 key1";
$keyword_string_3 = "key3 key4 key5 key1 key2";

/// ADD MORE HERE IF YOU LIKE
$keyword_string = Array($keyword_string_1, $keyword_string_2, $keyword_string_3); 

function urlX($location) {
   global $keyword_string;
   if(is_array($keyword_string)){
      $total = count($keyword_string);
      $random_keys = Array();
      $page = $keyword_string[rand(0,$total-1)];
   }
   return $location . "/" . urlencode(trim($page)) . ".html";
}

print urlX("http://www.google.com"); /// SIMPLE CALL TO NEW FUNCTION urlX() 
```

新增：

```
$keyword_string_1 = "key1 key2 key3 key4 key5";
$keyword_string_2 = "key2 key3 key4 key5 key1";
$keyword_string_3 = "key3 key4 key5 key1 key2";

function urlX($location) {
global $keyword_string_1, $keyword_string_2, $keyword_string_3;    

    if($location == "http://www.url1.com"){ /// CHANGE THESE TO ACTUAL URLS
        return $location . "/" . urlencode($keyword_string_1) . ".html";
    }else if($location == "http://www.url2.com"){
        return $location . "/" . urlencode($keyword_string_2) . ".html";
    }else if($location == "http://www.url3.com"){
        return $location . "/" . urlencode($keyword_string_3) . ".html";
    }else{
        return false;
    }

}

print urlX("http://www.url1.com"); 
```

# python - 打开程序时如何自动调整窗口大小。

> ID：14523959
> 
> 赞同：0
> 
> 时间：2013-01-25T14:36:55.307
> 
> 标签：python, python-idle

如果这真的很基本，我很抱歉，但是：当我打开 Python IDLE 编辑器时，外壳会打开，然后我必须从外壳打开编辑器。有什么办法可以让外壳和编辑器在打开时自动调整为特定大小？我可以使用批处理文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:41:59.930

试试这个 ：

选项 > 配置空闲 > 常规选项卡 > 初始窗口大小

# java - Java：LinkedList 上的快速排序给了我例外

> ID：14523960
> 
> 赞同：0
> 
> 时间：2013-01-25T14:37:02.167
> 
> 标签：java, linked-list, quicksort

我正在学习考试（算法和数据结构），我正在努力`quicksort`工作，`LinkedList`但它给了我`ListIndexOutOfBoundsException`.

前段时间的作业，我用于`straightinsertion`排序`ArrayList`和`Vector`，现在我想了解`QuickSor`t（我理论上是这样做的）`LinkedList`。我不太熟悉`linkedlist`，但应该不会太不同`ArrayList`？

```
public class Sort {

public static void quickSort(LinkedList<Oseba> a) {
    sort(a, 0, a.size() - 1); // this is line 16
}

public static void sort(LinkedList<Oseba> a, int l, int r) {
    int i = l;
    int j = r;

    Oseba x = a.get((l + r) / 2), w;

    do {
        while (a.get(i).mlajsi(x)) {
            ++i;
        }
        while (x.mlajsi(a.get(j))) { // this is line 31
            --j;
        }
        if (i <= j) {
            w = a.get(i);
            a.set(i, a.get(j));
            a.set(j, w);
            ++i;
            --j;
        }
    } while (i <= j);

    if (l < j) {
        sort(a, l, j);
    }

    if (i < r) {
        sort(a, i, r);
    }
}
} 
```

`Oseba`意思是“一个人”，这是我为测试各种方法（如排序、比较）而制作的一个类

```
public class Oseba implements Comparable<Oseba> {

protected String priimekIme; //surnameName
protected int letoRojstva; //year of birth
protected Spol spol; //gender (enum)

public Oseba(String priimekIme, int letoRojstva, Spol spol) {
    this.priimekIme = priimekIme;
    this.letoRojstva = letoRojstva;
    this.spol = spol;
}

@Override
public int compareTo(Oseba o) {
    if (this.letoRojstva < o.letoRojstva) {
        return -1;
    } else if (this.letoRojstva > o.letoRojstva) {
        return 1;
    } else {
        return this.priimekIme.compareTo(o.priimekIme);
    }
}

public boolean mlajsi(Oseba o) { //younger
    return (o.letoRojstva - this.letoRojstva <= 0);
}

@Override
public String toString() {
    String s = priimekIme + ", " + spol.getKratko() + ", " + letoRojstva;
    return s;
}
} 
```

这是我得到的错误：

```
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: -1, Size: 6
    at java.util.LinkedList.checkElementIndex(LinkedList.java:553)
    at java.util.LinkedList.get(LinkedList.java:474)
    at javaapplication1.Sort.sort(Sort.java:31)
    at javaapplication1.Sort.quickSort(Sort.java:16)
    at javaapplication1.JavaApplication1.main(JavaApplication1.java:55)
Java Result: 1 
```

这种`quicksort`方法应该与`Vector`or一起使用`ArrayList`，我不知道为什么它不会与 一起使用`LinkedList`？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:39:55.760

好吧，您不会在循环期间检查边界。

```
 while (a.get(i).mlajsi(x)) {
        ++i;
    }
    while (x.mlajsi(a.get(j))) { // this is line 31
        --j;
    } 
```

应该

```
 while (i <= r && a.get(i).mlajsi(x)) {
        ++i;
    }
    while (j >= l && x.mlajsi(a.get(j))) { // this is line 31
        --j;
    } 
```

和

```
} while (i <= j); 
```

严格来说，还应该考虑到这一点`i`并且`j`在边界之内（但我认为这不是必需的）。它将解决异常问题，但我没有验证算法的正确性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:52:27.690

Java（以及一般的 OO）的一[大规则](http://en.wikipedia.org/wiki/Design_Patterns#Introduction.2C_Chapter_1)是“代码到接口，而不是实现”。现在，您正在`LinkedList`对接口的实现进行编码`List`。保证此代码适用于任何 List ( , 等) 的唯一方法`Vector`是`ArrayList`更改​​您的声明。例如：

```
public static void quickSort(LinkedList<Oseba> a) { 
```

应该成为

```
public static void quickSort(List<Oseba> a) { 
```

与排序类似：

```
public static void sort(List<Oseba> a, int l, int r) { 
```

现在，每当您声明一个人时，它应该如下所示：

```
List<Oseba> a = LinkedList<Oseba>(); 
```

但是在 的地方`LinkedList`，您可以替换任何其他类型的列表。

这并不能回答您的代码为什么会失败的问题——我认为 UmNyobe 的建议很好，尽管我没有对其进行测试——但它回答了你关于为什么此代码不像其他列表类型那样的次要问题. 这是因为您正在对实现进行编码，您应该在其中使用接口。

# javascript - 使用包含逗号分隔值的变量填充下拉框

> ID：14523963
> 
> 赞同：1
> 
> 时间：2013-01-25T14:37:04.403
> 
> 标签：javascript

如何根据将包含逗号分隔值数据的变量填充选择框？

例子：

```
var x = Jenny,John,Stephanie,Marc,Ryan,Jessica 
```

预期结果：

```
[DROP DOWN BOX]
Jenny
John
Stephanie
Marc
Ryan
Jessica 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:50:46.753

[http://jsfiddle.net/fYN7M/](http://jsfiddle.net/fYN7M/)

HTML

```
<select id="myoptions">

</select> 
```

JavaScript

```
var x = "Jenny,John,Stephanie,Marc,Ryan,Jessica";

var options = x.split(",");

var select = document.getElementById('myoptions');
for(var i=0; i<options.length; i++)
{
  select.options[i] = new Option(options[i], i);  //new Option("Text", "Value")
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T14:43:46.653

像这样的东西应该工作：

```
<select id="DropDownList">

</select>

<script type="text/javascript" language="javascript">
   var x = "Jenny,John,Stephanie,Marc,Ryan,Jessica";
   var splitValues = x.split(",");
   for (var i = 0; i < splitValues.length; i++) {
      var opt = document.createElement("option");

      // Add an Option object to Drop Down/List Box
      document.getElementById("DropDownList").options.add(opt);

      // Assign text and value to Option object
      opt.text = splitValues[i];
      opt.value = splitValues[i];
   }
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T14:46:26.803

这里有一些纯 javascript 给你：

```
var x = 'Jenny,John,Stephanie,Marc,Ryan,Jessica';
x = x.split(',');

select = document.createElement('select');

for (var i=0;i<x.length;i++) { 
    var new_option_element = new Option(x[i], x[i]);
    select.appendChild(new_option_element);
}

document.body.appendChild(select); 
```

[http://jsfiddle.net/crowjonah/ZwtUF/1/](http://jsfiddle.net/crowjonah/ZwtUF/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T14:42:33.103

JavaScript

```
var x = 'Jenny,John,Stephanie,Marc,Ryan,Jessica'.split(',');
for (var i=0; i<x.length; i++) {
    document.getElementById("names").options[i] = new Option(x[i], x[i]);
} 
```

HTML

```
<select id="names"></select> 
```

演示

[http://jsfiddle.net/hyA96/](http://jsfiddle.net/hyA96/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T14:47:48.140

一个简单的方法是：

```
function populateWithChildren(parent, childTag, values) {
  if (!parent || !values) {
    // no parent element, or no values, nothing can be done so quit here
    return false;
  } else {
    // this ensures that 'values' is an array:
        // if values is a string, it splits that string (assuming a comma delimiter),
        // and split() returns an array, otherwise:
        // we assume it's already an array and use that.
    values = typeof values === "string" ? values.split(',') : values;
    // iterates through all the values in the 'values' array,
    for (var i = 0, len = values.length; i < len; i++) {
      // creates a new element (as passed in the 'childTag' variable)
      var newElem = document.createElement(childTag),
          text = document.createTextNode(values[i]);
      // appends the textNode to the created element
      newElem.appendChild(text);
      // appends the created-element to the 'parent' node passed to the function
      parent.appendChild(newElem);
    }
  }
}

var parent = document.getElementById('select'),
  x = 'Jenny,John,Stephanie,Marc,Ryan,Jessica';

populateWithChildren(parent, 'option', x); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/eeMfv/)。

# ios - 面部追踪器寻找眼睛 iphone

> ID：14523964
> 
> 赞同：6
> 
> 时间：2013-01-25T14:37:06.013
> 
> 标签：ios, objective-c, opencv, face-detection

我使用[这里的代码](https://github.com/aptogo/FaceTracker)来查找 Face。我试着画眼睛和脸。但我只能显示眼睛或脸，这取决于我先写哪个陈述。这该怎么做？

```
// Detect faces
std::vector faces;
_faceCascade.detectMultiScale(mat, faces, 1.1, 2, kHaarOptions, cv::Size(60, 60));
//Detect eyes
std::vector eyes;
_eyesCascade.detectMultiScale(mat, eyes, 1.1, 2, kHaarOptions, cv::Size(30, 30)); 
```

这里eyes.size() = 0。如果我交换两个语句的位置，我得到eyes.size() = 2 和 faces.size() = 0

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-02T21:48:54.407

如果您的目标是在 iOS 上检索面部和眼睛的位置，为什么不使用 CoreImage 功能？

```
CIImage *image = [CIImage imageWithContentsOfURL:[NSURL fileURLWithPath:@"image.jpg"]];

NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:CIDetectorAccuracyHigh, CIDetectorAccuracy, nil];

CIDetector *faceDetector = [CIDetector detectorOfType:CIDetectorTypeFace context:nil options:options];

NSArray *features = [faceDetector featuresInImage:image];
for(CIFaceFeature* faceFeature in features)
{
    CGRect faceSize = faceFeature.bounds.size;
    PointF leftEyePosition;
    PointF rightEyePosition;
    PointF mouthPosition;

    if(faceFeature.hasLeftEyePosition)
        leftEyePosition = faceFeature.leftEyePosition;
    //do the same for right eye and mouth
} 
```

它不使用 OpenCV，但你可以免费获得嘴的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:56:07.070

只复制共享输入参数（即复制 mat 到 mat2 并将其用作第二个输入）是合乎逻辑的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T20:17:35.247

变量 mat 是一个数组，按值传递。在函数内部，mat 中的值会发生变化，因此您首先放置的任何语句都会正确实现，而第二个语句的 mat 会发生变化。因此，在任一语句之前创建变量 mat 的深层副本，并在第二个语句中使用 mat-copy 变量代替 mat。

# objective-c - XCode：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

> ID：14523975
> 
> 赞同：0
> 
> 时间：2013-01-25T14:37:55.213
> 
> 标签：objective-c, xcode, linker, linker-errors

我正在做一个项目，当我构建项目时，我遇到了以下问题：

```
Ld /Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Products/Debug/SpaceInvaders.app/Contents/MacOS/SpaceInvaders normal x86_64
    cd /Users/KiKo-SaMa/Desktop/SpaceInvaders
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch x86_64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk -L/Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Products/Debug -F/Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Products/Debug -filelist /Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Intermediates/SpaceInvaders.build/Debug/SpaceInvaders.build/Objects-normal/x86_64/SpaceInvaders.LinkFileList -mmacosx-version-min=10.6 -fobjc-arc -fobjc-link-runtime -framework Cocoa -o /Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Products/Debug/SpaceInvaders.app/Contents/MacOS/SpaceInvaders

duplicate symbol _Cycles in:
    /Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Intermediates/SpaceInvaders.build/Debug/SpaceInvaders.build/Objects-normal/x86_64/emulator.o
    /Users/KiKo-SaMa/Library/Developer/Xcode/DerivedData/SpaceInvaders-cgcsumybmrxbddfqdwhevdvubdic/Build/Intermediates/SpaceInvaders.build/Debug/SpaceInvaders.build/Objects-normal/x86_64/SpaceInvadersMachine.o
ld: 1 duplicate symbol for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

起初，我查看了这里的问题并试图理解错误消息，似乎我有一个重复的变量名，所以我更改了它，当我尝试再次构建它时，我一直收到同样的错误，我也检查了重复的函数名称，我的代码似乎没有任何问题。我还检查了包含，因为在一个问题中，其中一个解决方案是包含 .m 而不是 .h。有人可以帮我解决这个问题。

我不知道这是否相关，但起初我遇到了 3 个问题，似乎我必须在我的项目的“构建阶段”的“编译源”中添加两个 C 文件，现在我只有 1 个问题就是上面那个。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T14:55:16.753

首先转到管理器（右上角），项目，选择项目（左列），删除派生数据
如果这不起作用......然后：
检查每个文件（甚至是头文件）：循环
你会在两个文件中找到它...从一个文件中删除它...你很好

# rest - WSO2 Synapse：设置 URL 参数

> ID：14523977
> 
> 赞同：3
> 
> 时间：2013-01-25T14:37:57.480
> 
> 标签：rest, wso2, url-parameters, synapse, wso2-am

我正在尝试做一些看似简单但无法正常工作的事情。基本上我希望 WSO2 API 管理器将 URL 参数添加到 REST 调用。

## 设置和问题

我安装了 WSO2 API 管理器。我还有一个运行着一个名为**someservlet**的虚假 servlet 的 Tomcat ，它只记录它接收到的任何内容并返回 ok。我已将 servlet 作为 API 添加到管理器中，因此我可以直接调用 servlet 或通过 WSO2 API mgr。

我可以跑

```
curl http://localhost:8080/someservlet/servlet/toto?blob=blib&secret=pass 
```

并且 servlet 工作正常，它告诉我它已收到路径**/toto**和参数**blob**和**secret**。

我可以跑

```
curl -H "Authorization: Bearer [...]" --url "http://192.168.23.1:8280/someservlet/1.0/toto?blob=blib&secret=pass" 
```

它的作用完全相同。到现在为止还挺好。

我想要的是运行：

```
curl -H "Authorization: Bearer MqVQuHqLNphtPV3XF1CtXVmbyP8a" --url "http://192.168.23.1:8280/someservlet/1.0/toto?blob=blib" 
```

（请注意，我已经删除了**秘密**参数）

...并且仍然得到相同的结果。

所以基本上我希望 API 管理器添加 URL 参数**secret=pass**。

## 我尝试的第一件事：财产调解员

**使用带有属性 REST_URL_POSTFIX**的 Synapse XML 配置。

我编辑了 API 配置文件，并添加了

```
<property name="REST_URL_POSTFIX" value="/blob?toto=titi" scope="axis2" type="STRING"/> 
```

现在如果我跑

```
curl -H "Authorization: Bearer [...]" --url "http://192.168.23.1:8280/someservlet/1.0/toti?blab=blib&secret=puss" 
```

就好像我运行了**someservlet/1.0/blob?toto=titi**：我所有的路径和参数都消失了，并被配置的路径和参数所取代。嘿，这就是它应该工作的方式，不是吗！

问题：

1.  这不会向 URL 添加任何内容，它会设置 URL 后缀，这意味着现有参数会消失（在上面的示例中，**blab=blib**）
2.  它必须以**“/”**开头才能成为有效值，所以我不能只添加**&secret=pass**（当然，因为问题 1，这无论如何都没用）

所以基本上这不能让我附加最后的**&secret=pass**。

## 我尝试的第二件事：重写 URL 中介

我找到了这个中介，虽然它可能无法解决问题，但它是一个很好的线索：我可以用**secret=foo**调用，然后让中介用**secret=pass**替换它。

我把它放在配置文件中：

```
<rewrite>
  <rewriterule>
    <action type="replace" value="pass" fragment="query" regex="foo"/>
  </rewriterule>
</rewrite> 
```

这行不通。起初我以为我没有正确的动作参数。但错误信息是：

```
Malformed URL when processing /someservlet/1.0/toti?blab=blib&amp;secret=foo 
```

畸形？异常堆栈跟踪中有更多详细信息：

```
java.net.MalformedURLException: no protocol: /someservlet/1.0/toti?blab=blib&secret=foo 
```

所以发生的事情是中介（记录或重写）收到一条消息，其**“To：”**字段指向一个没有协议的 URL！

当然，我一直在谷歌搜索，在某些情况下，我发现其他人有**logMediator: To: /blabla**，而其他（大多数）情况下他们有**logMediator: To: http://blabla**。我真的不明白是什么导致了这种差异。:-(

**所以这就是我卡住的地方！:-(**

## 可以尝试的选项

我知道可能有一个应该有效的大锤解决方案：

1.  使用**属性**存储完整路径和所有参数
2.  实现我自己的中介器（例如在 Java 中）来修改这些参数
3.  使用**属性 REST_URL_POSTFIX**将修改后的后缀放在调用上

但是我觉得这个问题应该有一个更简单的解决方案。

我有一种希望，有人会给我指出一个我没有找到的简单资源（中介、样本、语法错误等），而这正是我想要的。乐观... :-)

谢谢阅读。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T06:25:46.473

据我了解，您正在尝试将 附加`secret=pass`到您的端点网址。当您调用 API 时，我相信您正在发送该参数。同时您也在发送`"blab=blib"`参数。但是在 ESB 中，您需要将其更改为`"toto=titi"`

您使用的方法是正确的。（即：使用属性`REST_URL_POSTFIX`）在这种情况下，它将替换所有 requets 参数。但在使用之前，您可以保存请求参数并使用`"REST_URL_POSTFIX"` 您可以获得所需的最终 REST url。（是的，这是您提到的“待尝试”的最后一个选项）在“TO”地址中，您将只有端口号后面的地址。如果使用`"" POST_TO_URI"`属性 yopu 会在日志中看到完整的地址 URL，但是如果在 BE 服务和 ESB 之间配置了任何代理服务器，我们会使用它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T15:00:48.403

我已经解决了我的问题。

这就是我所做的：

1.  在配置文件中，使用**REST_URL_POSTFIX**获取 URL 后缀并将其放入属性中
2.  在 Java 中介中编辑属性
3.  使用**REST_URL_POSTFIX**在 XML 中设置新的后缀

对于第一步，我使用这一行：

```
<property name="querystrings" expression="get-property('axis2', 'REST_URL_POSTFIX')"/> 
```

这需要一些时间来解决，因为那里有很多行对我不起作用，它需要 2 个参数（axis2 和 REST ...）才能让它变得直截了当。

对于第二步，这是配置 XML：

```
<class name="mypackage.AddUrlParamMediator">
    <property name="paramName" value="mykey"/>
    <property name="paramValue" value="mysecret"/>
</class> 
```

这是中介类（没有导入）：

```
public class AddUrlParamMediator extends AbstractMediator {
    private String paramName = "default";
    private String paramValue = "default";

    public void setParamName(String paramName) {
        this.paramName = paramName;
    }

    public void setParamValue(String paramValue) {
        this.paramValue = paramValue;
    }

    public boolean mediate(MessageContext synapseMsgContext) {
        SynapseLog log = this.getLog(synapseMsgContext);
        String urlNewParam = this.paramName + "=" + this.paramValue;
        Object queryStringsPpty = synapseMsgContext.getProperty("querystrings");
        if (queryStringsPpty == null) {
            log.error("### queryStringPpty=null, exiting!");
            return true;
        }
        String queryStrings = queryStringsPpty.toString();
        queryStrings = (queryStrings.contains("?"))
            ? queryStrings + "&" + urlNewParam
            : queryStrings + "?" + urlNewParam;
        synapseMsgContext.setProperty("querystrings", queryStrings);
        return true;
    }
} 
```

当然这是 XML 配置中的第三步：

```
<property name="REST_URL_POSTFIX" expression="get-property('querystrings')" scope="axis2" type="STRING"/> 
```

所以这一切基本上都在 URL 的末尾设置了一个参数。希望这对其他人有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-11T10:51:35.160

对于可能遇到相同问题的任何人，这里有另一种解决方案，更简单且有效。

进入 carbon 管理门户，进入 API 列表，找到相关的 API 并点击它。这导致 API 的 XML 配置。在“地址”字段（和 XML 中的同一级别）之后添加字段：

```
<property name="Authorization" value="stuff to add" scope="transport"/> 
```

这会添加属性“授权”，其值为“stuff”。

# java - 使用 SWIG 从具有基类和接口的 c++ 类生成 Java 类

> ID：14523978
> 
> 赞同：1
> 
> 时间：2013-01-25T14:38:00.960
> 
> 标签：java, c++, swig

我正在将 C++ 应用程序移植到 Java。我使用 SWIG 生成了一些 Java 类和 JNI 包装器。

在 c++ 中，我有一个名为 Lion 的类，它扩展了 Animal 并实现了 Killable。我收到一条警告，说 Java 中不存在多重继承。到目前为止没问题，Lion 只会在我的 Java 类中扩展 Animal。

使用 SWIG 生成的类：

```
public class Killable {
  private long swigCPtr;
  protected boolean swigCMemOwn;

  public Killable(long cPtr, boolean cMemoryOwn) {
    swigCMemOwn = cMemoryOwn;
    swigCPtr = cPtr;
  }

  protected static long getCPtr(Killable obj) {
    return (obj == null) ? 0 : obj.swigCPtr;
  }

  protected void finalize() {
    delete();
  }

  public synchronized void delete() {
    if (swigCPtr != 0) {
      if (swigCMemOwn) {
        swigCMemOwn = false;
        cppinterfaceJNI.delete_Killable(swigCPtr);
      }
      swigCPtr = 0;
    }
  }

  public long getKillableId() {
    return cppinterfaceJNI.Killable_getId(swigCPtr, this);
  }

  public void kill() {
    cppinterfaceJNI.Killable_kill(swigCPtr, this);
  }
}

public class Lion extends Animal {
  private long swigCPtr;

  public Lion(long cPtr, boolean cMemoryOwn) {
    super(cppinterfaceJNI.Lion_SWIGUpcast(cPtr), cMemoryOwn);
    swigCPtr = cPtr;
  }

  public static long getCPtr(Lion obj) {
    return (obj == null) ? 0 : obj.swigCPtr;
  }

  ...
} 
```

现在假设我想要一个 Killable 数组。由于使用 SWIG 生成的 Java 类存储了指向原始 c++ 类的指针，因此我应该能够执行以下操作：

```
LinkedList<Killable> list = new LinkedList<Killable>();
Killable k = new Killable(Lion.getCPtr(myLionObject), false);
list.add(k);
System.out.println(k.getKillableId()) // Return a long, no crash here but I got a huge number (wrong number)
k.kill(); // Crash 
```

当我这样做时没有错误，但是当我尝试访问我的对象 k 的方法时，库崩溃了。我认为发生崩溃是因为没有找到正确的实现，但我不明白为什么，因为我给出了一个指向新对象的有效指针。知道为什么会发生崩溃或我可以在这里使用的解决方法吗？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T12:20:26.933

正如您所见，[SWIG+Java 的组合不会导致纯虚拟类自动成为接口](https://stackoverflow.com/questions/8168517/generating-java-interface-with-swig)。

问题是`getCPtr()`直接像您展示的那样操作对象类似于编写如下内容：

```
Lion *l = new lion;
intptr_t ptr = (intptr_t)l;
Killable *k = (Killable*)ptr; 
```

在 C++ 中 - 使用这样的 C 风格转换是不好的形式，因为它们掩盖了未定义的行为。它极不可能按预期工作，即使这样做也会比崩溃更糟糕，因为您的代码库中有未诊断的未定义行为。幸运的是，使用 SWIG 有一个简单的解决方法，您希望仍然可以进行这样的转换（通常只是自动转换）。

假设我们有以下头文件：

```
#include <iostream>

class Killable {
public:
  virtual ~Killable() {}
  virtual void die() = 0;
};

class Animal {
public:
  virtual ~Animal() {}
  virtual void moo() { std::cout << "The dog says: meow\n"; }
};

class Lion : public Animal, public Killable {
  virtual void die() { std::cout << "Deaded\n"; }
}; 
```

我们可以使用以下 SWIG 接口成功包装它：

```
%module test

%{
#include "test.h"
%}

%include "test.h"

%extend Animal {
  Killable *toKillable() {
    return dynamic_cast<Killable*>($self);
  }
} 
```

在这里，`%extend`添加了另一个成员函数来处理不会自动暴露的演员表。如果转换正常，则返回有效值`Killable`。如果不是，`null`则将被退回。

我们可以在 Java 中使用它：

```
import java.util.LinkedList;

public class run {
  public static void main(String[] argv) {
    System.loadLibrary("test");
    LinkedList<Killable> list = new LinkedList<Killable>();
    Lion l = new Lion();
    l.moo();
    Killable k = l.toKillable();
    list.add(k);
    k.die();
  }
} 
```

# php - 在 Prestashop 中添加 Paypal page_style 标签

> ID：14523980
> 
> 赞同：0
> 
> 时间：2013-01-25T14:38:04.173
> 
> 标签：php, paypal, prestashop

我遇到了一个问题，希望对 Prestashop 1.5 和贝宝模块有更多了解的人可以提供帮助。

我知道我可以在 Paypal 本身中设置默认页面样式，但我有多个网站都有自己的 page_styles，所以这不是一个选项:(

在 Prestashop Paypal 模块（v3.4.4）中，我编辑了文件：

/public_html/themes/{{theme}}/modules/paypal/express_checkout_payment.tpl

在表单中包含以下标签：

```
<input type="hidden" name="page_style" value="mystyle" /> 
```

使用模板并将标签添加到页面，但这似乎不起作用，它只是被忽略，这意味着加载默认样式。

有没有办法实现这一点并明确告诉 prestashop 使用我给定的 page_style （最好不要破解核心模块 php 文件，尽管欢迎所有解决方案）？

感谢您阅读并感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:53:49.760

这很奇怪，但互联网和 Paypal 资源中充斥着使用标签名称**page_style**的建议（在我尝试过的非 Prestashop 网站上效果很好），但由于某种原因在 Prestashop 上它不起作用。

那就是说使用以下代替！！

```
<input type="hidden" name="pagestyle" value="mystyle" /> 
```

在模板中使用标签或将其直接添加到我放置的 process.php 文件时，这对我都有效：

```
$fields['PAGESTYLE'] = 'mystyle'; 
```

我不建议使用第二种方法，因为它会在模块更新时被覆盖。

希望这对其他人有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T18:12:03.050

8 个月后使用 PayPal 模块 v3.6 的注释。这似乎不再有效。无论修改什么模板文件 - 顺便说一句，Paypal Express 的正确文件是 modules/paypal/views/templates/hook/express_checkout_payment.tpl。该标签确实显示在表单中，但不会中继到 API。

所以到今天为止，我认为唯一的解决方案是修改 modules/paypal/express_checkout/process.php 与上面的第二种方法一样（是的，没有下划线）。

# c++ - 存储在 LPCSTR 中的 C++ 字符 .. 坏了？

> ID：14523983
> 
> 赞同：0
> 
> 时间：2013-01-25T14:38:06.133
> 
> 标签：c++, string, variables, lpcstr

```
LPCSTR dllPath = ExePath().append("\\").append(DEF_INJECT_DLL).c_str();
DWORD dwBufSize = (DWORD)(strlen(dllPath) + 1) * sizeof(LPCSTR);

/* test */

char tbuf[1024]= {0,};
sprintf_s(tbuf, "dllPath : %s\r\ndwBufSize : %d", dllPath, dwBufSize);
MessageBoxA(NULL, tbuf, "TEST", MB_OK); 
```

注入我的dll的部分代码。

`ExePath()`是使用API 等获取数据类型`AbsolutePath`的函数。`std::string``GetModuleFileNameA`

`DEF_INJECT_DLL`定义为`#define "MyDll.dll"`

但是当我运行这段代码时，它显示了断线......

![在此处输入图像描述](../Images/2b55e67260220ba7a773d7945d6acbf9.png)

而且，当我将其更改`MessageBoxA`为：

```
MessageBoxA(NULL,
            ExePath().append("\\").append(DEF_INJECT_DLL).c_str(),
            "TEST",
            MB_OK); 
```

![在此处输入图像描述](../Images/ca046933c43fd9203047a642a018c79a.png)

它显示正确？

另外，我尝试过这种方式：

```
MessageBoxA(NULL,dllPath, "TEST", MB_OK); 
```

但它向我展示了第一个屏幕截图。

问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T14:43:01.270

问题出在这一行：

```
LPCSTR dllPath = ExePath().append("\\").append(DEF_INJECT_DLL).c_str(); 
```

在这里你调用`ExePath()`，它返回一个`std::string`实例，修改它，最后调用`c_str()`以获取原始数据缓冲区。

但是，返回值是一个临时对象。在该行之后，返回的将`std::string`被删除，并将清理其内存。因此，`dllPath`指向的地址不再有效！

您可以将返回值存储在本地实例中，例如

```
std::string str = ExePath().append("\\").append(DEF_INJECT_DLL);
LPCSTR dllPath = str.c_str(); 
```

# jquery - jquery甘特图拖入后获取新值

> ID：14523989
> 
> 赞同：1
> 
> 时间：2013-01-25T14:38:27.657
> 
> 标签：jquery, gantt-chart

在甘特图中移动条形后，我需要帮助保存或至少打印值。

我使用这里的脚本：http: [//lp344.github.com/jQuery.Gantt/](http://lp344.github.com/jQuery.Gantt/)。

问题是滑动条非常有效，但我需要在释放它们时获取值，以便我可以存储更改或其他任何内容。

这里有一个小提琴：http: [//jsfiddle.net/PhnYj/3/](http://jsfiddle.net/PhnYj/3/)

这是拖动的代码：

```
$('.ganttRed').draggable({
                    axis: 'x',
                    grid: [24, 24],
                    start: function(event, ui) {
                        $(this).data("startx",$(this).offset().left);
                    },
                    stop: function(event, ui) {
                        var change = $(this).offset().left - $(this).data("startx");
                        var value = $(this).css('margin-left');
                        value = value.split("px");
                        value = parseInt(value[0]) + change;
                        $(this).css('margin-left', value);
                        $(this).css('left', '');
                    }
                }); 
```

任何帮助，将不胜感激！

谢谢

# c# - 用户通过身份验证后如何将变量传递给每个控制器

> ID：14523990
> 
> 赞同：2
> 
> 时间：2013-01-25T14:38:31.587
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我正在开发一个分为年度会议的系统。用户可以去更改会话以查看过去的会话

我将如何将用户当前传递`yearId`给每个控制器？

我在想我可以在身份验证时设置用户cookie，或者当他们手动更改会话并使用全局过滤器检查cookie时

```
public class MyTestAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        HttpCookie cookie = filterContext.HttpContext.Request.Cookies["myCookie"];

        //do something with cookie.Value
        if (cookie!=null) 
        {
           filterContext.ActionParameters["YearId"] = cookie.Value;
        }
        else
        {
           // do something here
        }
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        base.OnActionExecuted(filterContext);
    }
} 
```

以下是我如何使用上述过滤器：（或将其添加为全局过滤器）

```
[MyTestAttribute]
public ActionResult Index(int yearId)
{
    //Pass the yearId down the layers
    // _repo.GetData(yearId);
    return View();
} 
```

使用这种方法，我必须将 yearId 添加到每个控制器。任何反馈表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T15:47:56.983

您还可以为需要参数而不是过滤器的控制器创建一个基类：

```
public class MyBaseController : Controller
{
    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        HttpCookie cookie = filterContext.HttpContext.Request.Cookies["myCookie"];

        //do something with cookie.Value
        if (cookie!=null) 
        {
           filterContext.ActionParameters["YearId"] = cookie.Value;
        }
        else
        {
           // do something here
        }
    }
} 
```

或者您甚至可以创建一个强类型属性并使其变得惰性，这样您就不必将它作为参数包含在每个操作方法中，并且除非您访问该属性，否则不要执行评估：

```
public class MyBaseController : Controller
{
    private int? _yearId;

    protected int YearId
    {
        get
        {
             // Only evaluate the first time the property is called
             if (!_yearId.HasValue)
             {
                 // HttpContext is accessible directly off of Controller
                 HttpCookie cookie = HttpContext.Request.Cookies["myCookie"];

                 //do something with cookie.Value
                 if (cookie!=null) 
                 {
                      _yearId = int.Parse(cookie.Value);
                 }
                 else
                 {
                      // do something here
                 }
             }

             return _yearId.Value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T14:42:38.743

这开销太大了。

为什么不把值放在会话中？如果他们更改“会话”以查看过去的会话，只需修改会话中的变量。

# c - 一个数组相对于另一个数组的 qsort()

> ID：14523995
> 
> 赞同：0
> 
> 时间：2013-01-25T14:38:50.610
> 
> 标签：c, arrays, sorting, qsort

我想使用 qsort() 对数组 a 相对于 b 进行排序。能给我功能吗？

a={0,1,2,3,4} b={3,4,5,1,2}

答案必须是 {3,4,0,1,2}

请给我功能代码。

喜欢 ： `int compare (const void *a,const void *b) { return(*(char *)a-*(char *)b); }`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T17:19:15.120

这不可能是您目前拥有的方式，因为 qsort() 接受一个数组并将数组的元素相互比较。您需要创建一个包含两个值的结构数组，如下所示：

```
#include <stdlib.h>
#include <stdio.h>

typedef struct {
    int a;
    int b;
} c_type;

int
compare(const void *a, 
        const void *b) {
    return ((c_type *)a)->b - ((c_type *)b)->b;
}

int
main(int argc,
     char *argv[])
{
    int i = 0;
    c_type array[] = {{0, 3}, {1, 4}, {2, 5}, {3, 1}, {4, 2}};

    qsort(array, sizeof array / sizeof(*array), sizeof(*array), compare);

    for ( i = 0; i < sizeof array / sizeof(*array); i++ ) {
       printf("%d\t", array[i].a);
    }
    printf("\n");

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-12T17:19:02.447

您需要一种机制来通知比较函数要比较的内容，而不是与存储在传递给它的地址中的值进行比较的普通实现。这可以通过`static`（全局）存储来实现：

```
#include<stdlib.h>

int *Array= NULL;
void SetArray(int *const array)
{
  Array= array;
}

int basecompare(const void *a, const void *b)
{
  return Array[*((int *) a)]- Array[*((int *) b)];
}
int main(int argc, char *argv[])
{
  int a[]= { 0, 1, 2, 3, 4 };
  int b[]= { 3, 4, 5, 1, 2 };
  size_t len= sizeof(a)/ sizeof(a[0]);

  SetArray(b);

  qsort(a, len, sizeof(int), basecompare);

  return 0;
} 
```

# python - 在 python 3.2 中启动和停止记录器

> ID：14523996
> 
> 赞同：2
> 
> 时间：2013-01-25T14:38:56.267
> 
> 标签：python, logging, python-3.x

在我的应用程序中，我使用了两个按钮：一个用于开始记录 RS422 链接消息，一个用于停止记录。

第一次，应用程序正确运行：创建带有消息的 .txt 文件。第二次，当我点击开始按钮时，一个新的 . txt 文件已创建，但现在，消息记录在此文件中，也记录在第一个 .txt 文件中。

查看我的代码：

```
def start_clic(self):
    logger=logging.getlogger("CFD")
    stringfilename=datetime.now().strftime('log_%Y_%m_%H_%M.txt')
    filehandler=logging.FileHandler(stringfilename)
    formatter=logging.Formatter('%(asctime)s %(message)s')
    logger.addHandler(filehandler)
    logger.setLevel(logging.INFO)

def stop_clic(self):
    logger.setLevel(logging.WARNING)
    filehandler.close() 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:50:07.343

如果你想停止这样的记录，你必须删除处理程序，使用[`Logger.removeHandler()`方法](http://docs.python.org/3/library/logging.html#logging.Logger.removeHandler)：

```
def stop_clic(self):
    logger=logging.getlogger("CFD")
    logger.setLevel(logging.WARNING)
    logger.removeHandler(filehandler)
    filehandler.close() 
```

否则将继续使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-19T21:57:17.403

在 3.2 中不确定，但在 3.6 中你可以这样做：`logger.disabled = True`