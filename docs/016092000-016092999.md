# StackOverflow 问答 16092000-16092999

# .net - 为什么.NET ThreadPool 滞后？

> ID：16092003
> 
> 赞同：0
> 
> 时间：2013-04-18T20:00:07.347
> 
> 标签：.net, multithreading, threadpool

因此，我正在与一个需要我为我订阅的每个事件调用 keep-alive 方法的 Web 服务交谈。在任何给定时间，最多可以有 400 个事件。

目前我正在使用没有间隔的 System.Timers.Timer。问题是这似乎耗尽了我的 ThreadPool，因为如果我尝试使用 ThreadPool.QueueWorkersItem() 运行某些东西，它在排队后最多可能需要 20 秒才能运行。

知道如何在不占用线程池的情况下运行我的保活调用吗？

BR托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:50:33.877

这取决于你有多少这些事件，你需要多久调用一次 keep alive 方法，以及调用需要多长时间。`ThreadPool.QueueUserWorkItem`将要执行的方法*排队*。如果所有线程池线程都被占用，您的工作项将不得不等待线程被释放。对于在它之前排队的所有其他项目。

您可能应该按照评论者的建议进行操作，并拥有一个专用线程来不断进行更新，可能是通过进行异步调用。

# java - JPA：检查实体对象是否已持久化

> ID：16092008
> 
> 赞同：15
> 
> 时间：2013-04-18T20:00:15.940
> 
> 标签：java, jakarta-ee, jpa, ejb

有没有通用的方法可以

```
 if(entity is persisted before){
     entity = entity.merge();
 }else{
     entity.persist();
 } 
```

那么包含上述逻辑的方法到处都是安全的吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-18T20:14:56.073

如果您需要知道对象是否已经在持久化上下文中，您应该`contains`使用`EntityManager`.

只能`EntityManager`告诉你实体是否持久化，实体没有这样的信息。

在这里您可以检查 javadoc 的[`contains`方法](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#contains%28java.lang.Object%29)。

```
if (!em.contains(entity)) {
  em.persist(entity);
} else {
  em.merge(entity);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T20:19:05.800

要检查当前 PersistenceContext 是否已持久化实体对象，您可以使用 EntityManager 方法[contains(Object entity)](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html#contains%28java.lang.Object%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-07T15:29:24.217

也许为时已晚，但这是我的发现！如果您有一个具有生成值的实体，则可以使用它来检查该实体是否已经在数据库中，假设您没有手动修改此值。

```
@Entity
public class MyEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id")
    private Integer id;

    // getter...
}

public class Main {
    public static void main() {
        MyEntity myEntity1 = new MyEntity();
        MyEntity myEntity2 = em.find(MyEntity.class, 4);
        em.detach(myEntity2); // or em.close()

        // other stuff and modifications

        // begin transaction
        persistEntity(myEntity1); // will use persist()
        persistEntity(myEntity2); // will use merge()
        // commit transaction

    }

    // This will manage correctly entities in different state
    public void persistEntity(MyEtity entity) {
        if (myEntity.getId() != null) em.merge(entity);
        else em.persist(entity);
    }
} 
```

在这种情况下使用**em.contains(entity)会失败：**

```
public static void main(){
    MyEntity myEntity = em.find(MyEntity.class, 5);

    em.detach(myEntity); // or em.close()

    // We are going to execute persist() because the entity is detached
    if (!em.contains(myEntity)) 
        // This call will produce an exception org.hibernate.PersistentObjectException
        em.persist(myEntity);
    else 
        em.merge(myEntity);
} 
```

尝试实现 OP 正在尝试做的事情是有性能原因的。您当然可以使用**em.merge()**而不是**em.persist()**，但并非没有成本。

**对em.merge()**的调用正在尝试使用*SELECT*查询从数据库中检索现有实体并对其进行更新。因此，如果实体从未被持久化，这将浪费一些 CPU 周期。另一方面**em.persist()**只会产生一个*INSERT*查询。

# r - 并行的 R 大型数据帧转换

> ID：16092009
> 
> 赞同：0
> 
> 时间：2013-04-18T20:00:17.297
> 
> 标签：r, foreach, parallel-processing, bigdata, snow

基本上我有一个大数据框：10,000,000x900（行，列），我正在尝试并行转换每列的类。最终结果需要是一个 data.frame

这是我到目前为止所得到的：

假装`df`是已经定义的数据框，所有列都是数字和字符类的混合

```
library(snow) 
cl=makeCluster(50,type="SOCK")
cl.out=clusterApplyLB(cl,df,function(x)factor(x,exclude=NULL)) 
```

`cl.out`是我想要的列表，除了我需要的是作为 data.frame 类

所以这就是我卡住的地方......我是否尝试将 cl.out 的所有元素组合到一个不会并行的 data.frame 中？（慢，时间是个问题）

我可以用不同的包实现其他东西吗？（前锋？）

我是否必须对一些 c 进行硬编码才能有效地完成这项工作？

任何帮助，将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:48:11.287

一种有用的范例是对所有列进行子集`df`化和替换，将其视为类似列表

```
df[] <- lapply(df, factor, exclude=NULL) 
```

正如您对 的调用所暗示的那样，您真的在一台机器上有 50 个内核`makeCluster`吗？如果您不在 Windows 机器上，请使用该`parallel`软件包，`mclapply`而不是

```
library(parallel)
options(mc.cores=50)
df[] <- mclapply(df, factor, exclude=NULL) 
```

这真的会帮助您进行整体评估吗？分发和检索数据的成本似乎与进行计算的成本一样高。

```
> f = factor(rep("M", 10000000), levels=LETTERS)
> df = data.frame(f, f, f, f, f, f, f, f)
> system.time(lapply(df, factor, exclude=NULL))
   user  system elapsed 
  2.676   0.564   3.250 
> system.time(clusterApply(cl, df, factor, exclude=NULL))
   user  system elapsed 
  1.488   0.752   2.476 
> system.time(mclapply(df, factor, exclude=NULL))
   user  system elapsed 
  1.876   1.832   1.814 
```

（多核和多进程时序可能变化很大）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T00:59:00.677

如果你有一个这样大小的 data.frame，我认为你会很快遇到内存*问题*。

我认为它会更快，更高效。

你可以使用`set`

```
library(data.table)

# to set as a data.table without having to copy 
setattr(df, 'class', c('data.table','data.frame')
alloc.col(df)

for(nn in names(df)){
   set(df, j = nn, value = factor(df[[nn]])
 } 
```

值得一读[的data.table和并行计算](https://stackoverflow.com/questions/14759905/data-table-and-parallel-computing)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:39:18.603

由于 data.frame 是一个带有`class`属性的列表，您只需将列表转换为 data.frame，使用`as.data.frame`.

```
cl.out <- as.data.frame(cl.out) 
```

我注意到列名丢失了：如果您确定它们的顺序相同，您可以使用以下命令重新设置它们：

```
names(cl.out) <- names(df) 
```

# java - Dropwizard 热部署

> ID：16092010
> 
> 赞同：9
> 
> 时间：2013-04-18T20:00:17.720
> 
> 标签：java, rest, hotdeploy, dropwizard

我正在寻找一个简单易用的 Java 系统，它为我创建了一个 REST 服务。所以我找到了dropwizard，但就我可以使用谷歌而言，它缺乏热部署，尽管码头能够这样做。当使用 maven-shade-plugin 时，构建这个东西至少需要 10 秒。此外，我的 IDE 报告说，当涉及到 shade-plugin 时，它不能使用 compile on save 功能（又名热部署）。

我可以以某种方式使用热部署吗？或者我可以用什么代替？

**更新**：如果没有什么能解决这个问题，我可能会使用 jersey&guice 等的组合，这在[这篇文章中有解释](http://blog.palominolabs.com/2011/08/15/a-simple-java-web-stack-with-guice-jetty-jersey-and-jackson/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-04T21:53:50.907

您不必使用 shade 插件来运行您的服务。您可以编译为常规 jar 文件，我认为这可以让您使用 IDE 热部署功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T15:00:36.057

你试过[JRebel](http://zeroturnaround.com/software/jrebel/)吗？他们也有 JAX-RS 支持......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-19T08:41:51.907

不是答案，但我写了一篇文章，详细介绍了如何使用 git 将 Dropwizard 项目推送到您的服务器并启动热**替换**。它依赖于 git 钩子并通过服务器上的脚本运行 Maven。

您可以在此处找到有关它的详细信息：http: [//gary-rowe.com/agilestack/2013/02/14/how-to-deploy-dynamic-sites-with-git/](http://gary-rowe.com/agilestack/2013/02/14/how-to-deploy-dynamic-sites-with-git/)

# css - 如何在右侧的起始位置溢出-x？

> ID：16092011
> 
> 赞同：1
> 
> 时间：2013-04-18T20:00:22.063
> 
> 标签：css, position, overflow

我有一个`div`内一个`div`。父母的宽度是 600px`overflow-x: scroll;`和孩子的宽度是 1200px 。

在页面加载时，孩子的左侧`div`显示为能够向右侧滚动。

我不确定如何将起始位置设置为右侧而不是左侧。任何提示都非常感谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:11:10.933

一个简单的解决方法是让您的容器从右到左阅读（默认情况下，滚动将位于右侧）。

将该行添加`direction: rtl`到父 div CSS，然后`direction: ltr`添加到子 div（因此子 div 中的文本将从左到右阅读）。

小提琴：http: [//jsfiddle.net/3kXUc/](http://jsfiddle.net/3kXUc/)

# python - 在 Gunicorn 工作人员之间共享对象，或在工作人员中持久化对象

> ID：16092012
> 
> 赞同：8
> 
> 时间：2013-04-18T20:00:26.610
> 
> 标签：python, bottle, gunicorn

我正在使用 Nginx / Gunicorn / Bottle 堆栈编写一个 WSGI 应用程序，该堆栈接受一个 GET 请求，返回一个简单的响应，然后向 RabbitMQ 写入一条消息。如果我通过直接的 Bottle 运行应用程序，那么每次应用程序收到 GET 时，我都会重用 RabbitMQ 连接。但是，在 Gunicorn 中，工作人员似乎每次都在销毁和重新创建 MQ 连接。我想知道是否有重用该连接的好方法。

更详细的信息：

```
##This is my bottle app
from bottle import blahblahblah
import bottle
from mqconnector import MQConnector

mqc = MQConnector(ip, exchange)

@route('/')
def index():
  try:
    mqc
  except NameError:
    mqc = MQConnector(ip, exchange)

  mqc.publish('whatever message')
  return 'ok'

if __name__ == '__main__':
  run(host='blah', port=808)
app = bottle.default_app() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-01T19:29:20.080

好的，这花了我一点时间来整理。发生的事情是，每次收到新请求时，Gunicorn 都会运行我的`index()`方法，并因此创建一个新的`MQConnector`.

解决方法是重构`MQConnector`，使其不再是一个类，而是一堆方法和变量。这样，每个工作人员每次都引用*同一个*MQConnector，而不是创建一个新的 MQConnector 实例。最后，我传递了 MQConnector 的`publish()`函数。

```
#Bottle app
from blah import blahblah
import MQConnector

@route('/')
def index():
  blahblah(foo, bar, baz, MQConnector.publish) 
```

和

```
#MQConnector
import pika
mq_ip = "blah"
exhange_name="blahblah"

connection=pika.BlockingConnection(....
...

def publish(message, r_key):
  ... 
```

结果：过去需要 800 毫秒的调用现在需要 4 毫秒。我曾经在 90 名 Gunicorn 工人中以每秒 80 次呼叫的速度最大化，而现在我在 5 名 Gunicorn 工人中以每秒约 700 次呼叫的速度最大化。

# javascript - 欧芹数据 - 等于不工作

> ID：16092015
> 
> 赞同：4
> 
> 时间：2013-04-18T20:00:40.877
> 
> 标签：javascript, parsley.js

我正在尝试使用 Parsley.js 匹配密码，但它似乎不起作用。这是代码：

```
 <div class="control-group">
      <!-- Password-->
      <label class="control-label" for="password">Password</label>
      <div class="controls">
      <div class="input-prepend">
        <span class="add-on"><i class="icon-eye-close"></i></span>
        <input type="password" id="password" name="password" placeholder="" class="input-xlarge" data-trigger="change" data-required="true" data-minlength="6">
      </div>
        <p class="help-block">Password should be at least 4 characters</p>
      </div>
    </div>
    <!-- ************ NOT WORKING *************** -->
    <div class="control-group">
      <!-- Password -->
      <label class="control-label"  for="password_confirm">Password (Confirm)</label>
      <div class="controls">
      <div class="input-prepend">
        <span class="add-on"><i class="icon-eye-close"></i></span>
        <input type="password" id="password_confirm" name="password_confirm" placeholder="" class="input-xlarge" data-equalto="#password" data-trigger="change focusout" data-required="true" >
      </div>
        <p class="help-block">Please confirm password</p>
      </div>
    </div> 
```

这部分**data-equalto="#password"**应该进行检查，但它似乎不起作用。

我以如下形式调用欧芹验证：

```
<form class="form-horizontal" id="userForm" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST" data-focus="first" data-validate="parsley"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-04T20:47:24.897

已经为此苦苦挣扎了几个小时，找到了由[JoelCDoyle](https://stackoverflow.com/users/1457231/joelcdoyle)提供的答案。我想重申它，因为虽然这个问题已经过时，但乔尔提供的答案是有效的。谢谢！:)

```
 <input type="password" name="pw" id="pw"
          parsley-minlength="8"
          parsley-required="true"
        />
        <input id="pwtwo" type="password" name="pw-verify"
          data-parsley-equalto="#pw"
          parsley-required="true"
        /> 
```

这是使比较功能与 parsley.js 一起工作所需的属性： `data-parsley-equalto="#pw"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-01T05:02:35.870

我不确定这是否会对您有所帮助，但我在这里有一个可行的解决方案：http: [//codepen.io/anon/pen/KNyjoY](http://codepen.io/anon/pen/KNyjoY)

**基本安装**

```
<form data-parsley-validate>
...
</form> 
```

**Javascript安装**（我正在使用这个）

```
<form id="form">
...
</form>

<script type="text/javascript">
  $('#form').parsley();
</script> 
```

我添加了一个事件`#password`来触发`#cpassword`表单验证。

```
$('#password').on('change input keyup', function() {
    if (this.value) {
      $('#cpassword').prop('required', true).parsley().validate();
    } else {
      $('#cpassword').prop('required', false).parsley().validate();
    }
  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-02T12:00:06.827

在最新的 Parsley 版本中，您不再通过“data-”属性调用 API。不太确定，如果您的版本是这种情况（我知道数据值过去有效），但请尝试使用新 API。

因此，您调用与属性“parsley-validate”不同的表单，该属性为 True if Set。并且用“parsley-[constraint]”调用约束。正如官方 Parsley.js 网站所述，它不太兼容 W3C，但出于某种奇怪的原因，他喜欢这样。但是，他还提供了一个解决方案，为 Parsley 定义了一个命名空间，以使其与 W3C 兼容。

如果你能提供旧的 Parsley 版本，我也可以看看。

**注意力**

这个答案（也许还有问题）已经过时了。答案可能不再有效，请查看对此答案的评论。

# javascript - Nivo Slider 标题在图像前半秒旋转

> ID：16092019
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:01.550
> 
> 标签：javascript, jquery, css, nivo-slider

我已经`Nivo Slider`使用 960px 容器修改了代码。

图像槽的宽度为 50%，标题也是如此，它浮动到左侧。

我主要用来`z-index`做这项工作。但是现在，我的集合中 NEXT 图像的标题在其图像加载之前大约 0.5 秒加载。

如何修改`JS`以使图像和相应的标题同时旋转？或者，至少，我应该关注 JS 的哪一部分？

注意：我在 3 个不同的图像/标题之间旋转。

这是JS：

```
 (function(e) {
    var t = function(t, n) {
        var r = e.extend({}, e.fn.nivoSlider.defaults, n);
        var i = {
            currentSlide: 0,
            currentImage: "",
            totalSlides: 0,
            running: false,
            paused: false,
            stop: false,
            controlNavEl: false
        };
        var s = e(t);
        s.data("nivo:vars", i).addClass("nivoSlider");
        var o = s.children();
        o.each(function() {
            var t = e(this);
            var n = "";
            if (!t.is("img")) {
                if (t.is("a")) {
                    t.addClass("nivo-imageLink");
                    n = t
                }
                t = t.find("img:first")
            }
            var r = r === 0 ? t.attr("width") : t.width(),
                s = s === 0 ? t.attr("height") : t.height();
            if (n !== "") {
                n.css("display", "none")
            }
            t.css("display", "none");
            i.totalSlides++
        });
        if (r.randomStart) {
            r.startSlide = Math.floor(Math.random() * i.totalSlides)
        }
        if (r.startSlide > 0) {
            if (r.startSlide >= i.totalSlides) {
                r.startSlide = i.totalSlides - 1
            }
            i.currentSlide = r.startSlide
        }
        if (e(o[i.currentSlide]).is("img")) {
            i.currentImage = e(o[i.currentSlide])
        } else {
            i.currentImage = e(o[i.currentSlide]).find("img:first")
        } if (e(o[i.currentSlide]).is("a")) {
            e(o[i.currentSlide]).css("display", "block")
        }
        var u = e("<img/>").addClass("nivo-main-image");
        u.attr("src", i.currentImage.attr("src")).show();
        s.append(u);
        e(window).resize(function() {
            s.children("img").width(s.width());
            u.attr("src", i.currentImage.attr("src"));
            u.stop().height("auto");
            e(".nivo-slice").remove();
            e(".nivo-box").remove()
        });
        s.append(e('<div class="nivo-caption"></div>'));
        var a = function(t) {
            var n = e(".nivo-caption", s);
            if (i.currentImage.attr("title") != "" && i.currentImage.attr("title") != undefined) {
                var r = i.currentImage.attr("title");
                if (r.substr(0, 1) == "#") r = e(r).html();
                if (n.css("display") == "block") {
                    setTimeout(function() {
                        n.html(r)
                    }, t.animSpeed)
                } else {
                    n.html(r);
                    n.stop().fadeIn(t.animSpeed)
                }
            } else {
                n.stop().fadeOut(t.animSpeed)
            }
        };
        a(r);
        var f = 0;
        if (!r.manualAdvance && o.length > 1) {
            f = setInterval(function() {
                d(s, o, r, false)
            }, r.pauseTime)
        }
        if (r.directionNav) {
            s.append('<div class="nivo-directionNav"><a class="nivo-prevNav">' + r.prevText + '</a><a class="nivo-nextNav">' + r.nextText + "</a></div>");
            e(s).on("click", "a.nivo-prevNav", function() {
                if (i.running) {
                    return false
                }
                clearInterval(f);
                f = "";
                i.currentSlide -= 2;
                d(s, o, r, "prev")
            });
            e(s).on("click", "a.nivo-nextNav", function() {
                if (i.running) {
                    return false
                }
                clearInterval(f);
                f = "";
                d(s, o, r, "next")
            })
        }
        if (r.controlNav) {
            i.controlNavEl = e('<div class="nivo-controlNav"></div>');
            s.after(i.controlNavEl);
            for (var l = 0; l < o.length; l++) {
                if (r.controlNavThumbs) {
                    i.controlNavEl.addClass("nivo-thumbs-enabled");
                    var c = o.eq(l);
                    if (!c.is("img")) {
                        c = c.find("img:first")
                    }
                    if (c.attr("data-thumb")) i.controlNavEl.append('<a class="nivo-control" rel="' + l + '"><img src="' + c.attr("data-thumb") + '" alt="" /></a>')
                } else {
                    i.controlNavEl.append('<a class="nivo-control" rel="' + l + '">' + (l + 1) + "</a>")
                }
            }
            e("a:eq(" + i.currentSlide + ")", i.controlNavEl).addClass("active");
            e("a", i.controlNavEl).bind("click", function() {
                if (i.running) return false;
                if (e(this).hasClass("active")) return false;
                clearInterval(f);
                f = "";
                u.attr("src", i.currentImage.attr("src"));
                i.currentSlide = e(this).attr("rel") - 1;
                d(s, o, r, "control")
            })
        }
        if (r.pauseOnHover) {
            s.hover(function() {
                i.paused = true;
                clearInterval(f);
                f = ""
            }, function() {
                i.paused = false;
                if (f === "" && !r.manualAdvance) {
                    f = setInterval(function() {
                        d(s, o, r, false)
                    }, r.pauseTime)
                }
            })
        }
        s.bind("nivo:animFinished", function() {
            u.attr("src", i.currentImage.attr("src"));
            i.running = false;
            e(o).each(function() {
                if (e(this).is("a")) {
                    e(this).css("display", "none")
                }
            });
            if (e(o[i.currentSlide]).is("a")) {
                e(o[i.currentSlide]).css("display", "block")
            }
            if (f === "" && !i.paused && !r.manualAdvance) {
                f = setInterval(function() {
                    d(s, o, r, false)
                }, r.pauseTime)
            }
            r.afterChange.call(this)
        });
        var h = function(t, n, r) {
            if (e(r.currentImage).parent().is("a")) e(r.currentImage).parent().css("display", "block");
            e('img[src="' + r.currentImage.attr("src") + '"]', t).not(".nivo-main-image,.nivo-control img").width(t.width()).css("visibility", "hidden").show();
            var i = e('img[src="' + r.currentImage.attr("src") + '"]', t).not(".nivo-main-image,.nivo-control img").parent().is("a") ? e('img[src="' + r.currentImage.attr("src") + '"]', t).not(".nivo-main-image,.nivo-control img").parent().height() : e('img[src="' + r.currentImage.attr("src") + '"]', t).not(".nivo-main-image,.nivo-control img").height();
            for (var s = 0; s < n.slices; s++) {
                var o = Math.round(t.width() / n.slices);
                if (s === n.slices - 1) {
                    t.append(e('<div class="nivo-slice" name="' + s + '"><img src="' + r.currentImage.attr("src") + '" style="position:absolute; width:' + t.width() + "px; height:auto; display:block !important; top:0; left:-" + (o + s * o - o) + 'px;" /></div>').css({
                        left: o * s + "px",
                        width: t.width() - o * s + "px",
                        height: i + "px",
                        opacity: "0",
                        overflow: "hidden"
                    }))
                } else {
                    t.append(e('<div class="nivo-slice" name="' + s + '"><img src="' + r.currentImage.attr("src") + '" style="position:absolute; width:' + t.width() + "px; height:auto; display:block !important; top:0; left:-" + (o + s * o - o) + 'px;" /></div>').css({
                        left: o * s + "px",
                        width: o + "px",
                        height: i + "px",
                        opacity: "0",
                        overflow: "hidden"
                    }))
                }
            }
            e(".nivo-slice", t).height(i);
            u.stop().animate({
                height: e(r.currentImage).height()
            }, n.animSpeed)
        };
        var p = function(t, n, r) {
            if (e(r.currentImage).parent().is("a")) e(r.currentImage).parent().css("display", "block");
            e('img[src="' + r.currentImage.attr("src") + '"]', t).not(".nivo-main-image,.nivo-control img").width(t.width()).css("visibility", "hidden").show();
            var i = Math.round(t.width() / n.boxCols),
                s = Math.round(e('img[src="' + r.currentImage.attr("src") + '"]', t).not(".nivo-main-image,.nivo-control img").height() / n.boxRows);
            for (var o = 0; o < n.boxRows; o++) {
                for (var a = 0; a < n.boxCols; a++) {
                    if (a === n.boxCols - 1) {
                        t.append(e('<div class="nivo-box" name="' + a + '" rel="' + o + '"><img src="' + r.currentImage.attr("src") + '" style="position:absolute; width:' + t.width() + "px; height:auto; display:block; top:-" + s * o + "px; left:-" + i * a + 'px;" /></div>').css({
                            opacity: 0,
                            left: i * a + "px",
                            top: s * o + "px",
                            width: t.width() - i * a + "px"
                        }));
                        e('.nivo-box[name="' + a + '"]', t).height(e('.nivo-box[name="' + a + '"] img', t).height() + "px")
                    } else {
                        t.append(e('<div class="nivo-box" name="' + a + '" rel="' + o + '"><img src="' + r.currentImage.attr("src") + '" style="position:absolute; width:' + t.width() + "px; height:auto; display:block; top:-" + s * o + "px; left:-" + i * a + 'px;" /></div>').css({
                            opacity: 0,
                            left: i * a + "px",
                            top: s * o + "px",
                            width: i + "px"
                        }));
                        e('.nivo-box[name="' + a + '"]', t).height(e('.nivo-box[name="' + a + '"] img', t).height() + "px")
                    }
                }
            }
            u.stop().animate({
                height: e(r.currentImage).height()
            }, n.animSpeed)
        };
        var d = function(t, n, r, i) {
            var s = t.data("nivo:vars");
            if (s && s.currentSlide === s.totalSlides - 1) {
                r.lastSlide.call(this)
            }
            if ((!s || s.stop) && !i) {
                return false
            }
            r.beforeChange.call(this);
            if (!i) {
                u.attr("src", s.currentImage.attr("src"))
            } else {
                if (i === "prev") {
                    u.attr("src", s.currentImage.attr("src"))
                }
                if (i === "next") {
                    u.attr("src", s.currentImage.attr("src"))
                }
            }
            s.currentSlide++;
            if (s.currentSlide === s.totalSlides) {
                s.currentSlide = 0;
                r.slideshowEnd.call(this)
            }
            if (s.currentSlide < 0) {
                s.currentSlide = s.totalSlides - 1
            }
            if (e(n[s.currentSlide]).is("img")) {
                s.currentImage = e(n[s.currentSlide])
            } else {
                s.currentImage = e(n[s.currentSlide]).find("img:first")
            } if (r.controlNav) {
                e("a", s.controlNavEl).removeClass("active");
                e("a:eq(" + s.currentSlide + ")", s.controlNavEl).addClass("active")
            }
            a(r);
            e(".nivo-slice", t).remove();
            e(".nivo-box", t).remove();
            var o = r.effect,
                f = "";
            if (r.effect === "random") {
                f = new Array("sliceDownRight", "sliceDownLeft", "sliceUpRight", "sliceUpLeft", "sliceUpDown", "sliceUpDownLeft", "fold", "fade", "boxRandom", "boxRain", "boxRainReverse", "boxRainGrow", "boxRainGrowReverse");
                o = f[Math.floor(Math.random() * (f.length + 1))];
                if (o === undefined) {
                    o = "fade"
                }
            }
            if (r.effect.indexOf(",") !== -1) {
                f = r.effect.split(",");
                o = f[Math.floor(Math.random() * f.length)];
                if (o === undefined) {
                    o = "fade"
                }
            }
            if (s.currentImage.attr("data-transition")) {
                o = s.currentImage.attr("data-transition")
            }
            s.running = true;
            var l = 0,
                c = 0,
                d = "",
                m = "",
                g = "",
                y = "";
            if (o === "sliceDown" || o === "sliceDownRight" || o === "sliceDownLeft") {
                h(t, r, s);
                l = 0;
                c = 0;
                d = e(".nivo-slice", t);
                if (o === "sliceDownLeft") {
                    d = e(".nivo-slice", t)._reverse()
                }
                d.each(function() {
                    var n = e(this);
                    n.css({
                        top: "0px"
                    });
                    if (c === r.slices - 1) {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1.0"
                            }, r.animSpeed, "", function() {
                                t.trigger("nivo:animFinished")
                            })
                        }, 100 + l)
                    } else {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1.0"
                            }, r.animSpeed)
                        }, 100 + l)
                    }
                    l += 50;
                    c++
                })
            } else if (o === "sliceUp" || o === "sliceUpRight" || o === "sliceUpLeft") {
                h(t, r, s);
                l = 0;
                c = 0;
                d = e(".nivo-slice", t);
                if (o === "sliceUpLeft") {
                    d = e(".nivo-slice", t)._reverse()
                }
                d.each(function() {
                    var n = e(this);
                    n.css({
                        bottom: "0px"
                    });
                    if (c === r.slices - 1) {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1.0"
                            }, r.animSpeed, "", function() {
                                t.trigger("nivo:animFinished")
                            })
                        }, 100 + l)
                    } else {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1.0"
                            }, r.animSpeed)
                        }, 100 + l)
                    }
                    l += 50;
                    c++
                })
            } else if (o === "sliceUpDown" || o === "sliceUpDownRight" || o === "sliceUpDownLeft") {
                h(t, r, s);
                l = 0;
                c = 0;
                var b = 0;
                d = e(".nivo-slice", t);
                if (o === "sliceUpDownLeft") {
                    d = e(".nivo-slice", t)._reverse()
                }
                d.each(function() {
                    var n = e(this);
                    if (c === 0) {
                        n.css("top", "0px");
                        c++
                    } else {
                        n.css("bottom", "0px");
                        c = 0
                    } if (b === r.slices - 1) {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1.0"
                            }, r.animSpeed, "", function() {
                                t.trigger("nivo:animFinished")
                            })
                        }, 100 + l)
                    } else {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1.0"
                            }, r.animSpeed)
                        }, 100 + l)
                    }
                    l += 50;
                    b++
                })
            } else if (o === "fold") {
                h(t, r, s);
                l = 0;
                c = 0;
                e(".nivo-slice", t).each(function() {
                    var n = e(this);
                    var i = n.width();
                    n.css({
                        top: "0px",
                        width: "0px"
                    });
                    if (c === r.slices - 1) {
                        setTimeout(function() {
                            n.animate({
                                width: i,
                                opacity: "1.0"
                            }, r.animSpeed, "", function() {
                                t.trigger("nivo:animFinished")
                            })
                        }, 100 + l)
                    } else {
                        setTimeout(function() {
                            n.animate({
                                width: i,
                                opacity: "1.0"
                            }, r.animSpeed)
                        }, 100 + l)
                    }
                    l += 50;
                    c++
                })
            } else if (o === "fade") {
                h(t, r, s);
                m = e(".nivo-slice:first", t);
                m.css({
                    width: t.width() + "px"
                });
                m.animate({
                    opacity: "1.0"
                }, r.animSpeed * 2, "", function() {
                    t.trigger("nivo:animFinished")
                })
            } else if (o === "slideInRight") {
                h(t, r, s);
                m = e(".nivo-slice:first", t);
                m.css({
                    width: "0px",
                    opacity: "1"
                });
                m.animate({
                    width: t.width() + "px"
                }, r.animSpeed * 2, "", function() {
                    t.trigger("nivo:animFinished")
                })
            } else if (o === "slideInLeft") {
                h(t, r, s);
                m = e(".nivo-slice:first", t);
                m.css({
                    width: "0px",
                    opacity: "1",
                    left: "",
                    right: "0px"
                });
                m.animate({
                    width: t.width() + "px"
                }, r.animSpeed * 2, "", function() {
                    m.css({
                        left: "0px",
                        right: ""
                    });
                    t.trigger("nivo:animFinished")
                })
            } else if (o === "boxRandom") {
                p(t, r, s);
                g = r.boxCols * r.boxRows;
                c = 0;
                l = 0;
                y = v(e(".nivo-box", t));
                y.each(function() {
                    var n = e(this);
                    if (c === g - 1) {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1"
                            }, r.animSpeed, "", function() {
                                t.trigger("nivo:animFinished")
                            })
                        }, 100 + l)
                    } else {
                        setTimeout(function() {
                            n.animate({
                                opacity: "1"
                            }, r.animSpeed)
                        }, 100 + l)
                    }
                    l += 20;
                    c++
                })
            } else if (o === "boxRain" || o === "boxRainReverse" || o === "boxRainGrow" || o === "boxRainGrowReverse") {
                p(t, r, s);
                g = r.boxCols * r.boxRows;
                c = 0;
                l = 0;
                var w = 0;
                var E = 0;
                var S = [];
                S[w] = [];
                y = e(".nivo-box", t);
                if (o === "boxRainReverse" || o === "boxRainGrowReverse") {
                    y = e(".nivo-box", t)._reverse()
                }
                y.each(function() {
                    S[w][E] = e(this);
                    E++;
                    if (E === r.boxCols) {
                        w++;
                        E = 0;
                        S[w] = []
                    }
                });
                for (var x = 0; x < r.boxCols * 2; x++) {
                    var T = x;
                    for (var N = 0; N < r.boxRows; N++) {
                        if (T >= 0 && T < r.boxCols) {
                            (function(n, i, s, u, a) {
                                var f = e(S[n][i]);
                                var l = f.width();
                                var c = f.height();
                                if (o === "boxRainGrow" || o === "boxRainGrowReverse") {
                                    f.width(0).height(0)
                                }
                                if (u === a - 1) {
                                    setTimeout(function() {
                                        f.animate({
                                            opacity: "1",
                                            width: l,
                                            height: c
                                        }, r.animSpeed / 1.3, "", function() {
                                            t.trigger("nivo:animFinished")
                                        })
                                    }, 100 + s)
                                } else {
                                    setTimeout(function() {
                                        f.animate({
                                            opacity: "1",
                                            width: l,
                                            height: c
                                        }, r.animSpeed / 1.3)
                                    }, 100 + s)
                                }
                            })(N, T, l, c, g);
                            c++
                        }
                        T--
                    }
                    l += 100
                }
            }
        };
        var v = function(e) {
            for (var t, n, r = e.length; r; t = parseInt(Math.random() * r, 10), n = e[--r], e[r] = e[t], e[t] = n);
            return e
        };
        var m = function(e) {
            if (this.console && typeof console.log !== "undefined") {
                console.log(e)
            }
        };
        this.stop = function() {
            if (!e(t).data("nivo:vars").stop) {
                e(t).data("nivo:vars").stop = true;
                m("Stop Slider")
            }
        };
        this.start = function() {
            if (e(t).data("nivo:vars").stop) {
                e(t).data("nivo:vars").stop = false;
                m("Start Slider")
            }
        };
        r.afterLoad.call(this);
        return this
    };
    e.fn.nivoSlider = function(n) {
        return this.each(function(r, i) {
            var s = e(this);
            if (s.data("nivoslider")) {
                return s.data("nivoslider")
            }
            var o = new t(this, n);
            s.data("nivoslider", o)
        })
    };
    e.fn.nivoSlider.defaults = {
        effect: "random",
        slices: 15,
        boxCols: 8,
        boxRows: 4,
        animSpeed: 500,
        pauseTime: 3e3,
        startSlide: 0,
        directionNav: true,
        controlNav: true,
        controlNavThumbs: false,
        pauseOnHover: true,
        manualAdvance: false,
        prevText: "Prev",
        nextText: "Next",
        randomStart: false,
        beforeChange: function() {},
        afterChange: function() {},
        slideshowEnd: function() {},
        lastSlide: function() {},
        afterLoad: function() {}
    };
    e.fn._reverse = [].reverse
})(jQuery) = [].reverse
})(jQuery) 
```

# visual-studio-2010 - Visual Studio 2012 停靠窗口选项卡顺序

> ID：16092021
> 
> 赞同：3
> 
> 时间：2013-04-18T20:01:08.927
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012

Visual Studio 2012 具有与 2010 相同的窗口/工具栏停靠/自动隐藏功能，但我注意到，如果您使用 pin 然后取消固定它们，选项卡将不再按顺序排列。这违背了为我停靠窗口/工具栏的目的，因为我把它们放在我会记得它们在哪里的地方。如果他们不断改变顺序，我必须停下来寻找我想要的那个，而不是让他们按照我放置的顺序保持不变。有没有人知道一种让它们保持有序的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-30T07:39:52.757

如果您关闭“自动隐藏按钮仅影响活动工具窗口”选项，则选项卡顺序不会更改，因为整个窗口都已固定。但是您不能在此设置上固定特定选项卡。

[http://msdn.microsoft.com/en-us/library/z4y0hsax%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/z4y0hsax%28v=vs.110%29.aspx)

# java - 小胡子+吊带+CQ5

> ID：16092022
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:09.647
> 
> 标签：java, mustache, aem, sling, templating-engine

我正在研究一种在使用 Sling 的 CQ5 中为视图引擎使用 Mustache 模板的方法。如果有人已经有过这方面的经验，我正在寻找一些建议。

我需要使用可以在需要时在前端和后端之间共享的模板格式。所以小胡子是理想的，但是，其他选项可能适用，例如车把。

我找到了一个我正在研究的“sling-scripting-mustache”的 git repo，但它缺少任何类型的文档。尽管如此，我还是会尝试一下。

将不胜感激任何想法和指导:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-02T09:59:20.843

Handlebars 自 5.6 以来一直在 CQ 中：

> handlebars javascript 库最初是在 5.6.0 中添加到 CQ 中的，用于其他目的。把手的 java 版本包含在 AEM 6.0 和 5.6.1 的功能包中，其中包含社交组件框架 (SCF) ( [source](http://labs.sixdimensions.com/blog/2014-05-22/sightly-vs-handlebars-vs-jsp-comparing-scripting-languages/#comment-1403136239) )

您可以编写 Mustache 模板并使用 Handlebars 渲染它们：

> Mustache 模板与 Handlebars 兼容，因此您可以使用 Mustache 模板，将其导入 Handlebars，然后开始利用 Handlebars 的额外功能（[来源](http://handlebarsjs.com)）

[这里](http://docs.adobe.com/content/docs/en/aem/6-0/develop/social-communities/scf.html)有更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T20:35:23.007

存储库中的代码 ( [https://github.com/lykorian/sling-scripting-mustache](https://github.com/lykorian/sling-scripting-mustache) ) 构建了一个 OSGI 包，其中包含嵌入在其元数据中的脚本引擎信息。

根据我在 pom 文件中看到的内容，您应该安装依赖项：

```
mvn -Pinstall-dependencies install 
```

然后通过在 OSGI 控制台中安装或运行 maven 来构建和安装实际的包（检查 pom 的默认值）：

```
mvn -Plocal-author install 
```

安装后，应该安装脚本引擎并且它应该能够识别 *. 小胡子文件。

免责声明：我没有对此进行测试，这些只是我基于代码和 pom 文件中的内容的想法。希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:41:26.010

我的工作流程通常是用 grunt 之类的东西在语言管道之外编译把手或小胡子，然后将其作为单独的 js 文件包含在内。

现在，如果您实际上是在尝试进行服务器端模板化，那是一个不同的问题。不确定把手作为服务器端模板的效果如何，但 mustache 肯定可以。

# java - 使用 getResource 方法时如何获取 webApp 位置？

> ID：16092024
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:12.010
> 
> 标签：java, jakarta-ee, servlets, web-applications, getresource

在我的 servlet 中：

```
protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
 new Action();
} 
```

在我的行动课上：

```
Action(){
    System.out.println("--> " + this.getClass().getResource("/").toString());
} 
```

我有结果，这个位置：

-->`file:/C:/Users/saad/Desktop/apache-tomcat-7.0.37/wtpwebapps/Serveur/WEB-INF/classes/`

但我想像这样访问我的 webApp 的根目录： `file:/C:/Users/saad/Desktop/apache-tomcat-7.0.37/wtpwebapps/Serveur/`

我坚持认为 Action 类不是从 HttpServlet 继承的，所以我不能使用 ServletContext.getResource("") 。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:03:14.740

[`ServletContext.getRealPath()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath%28java.lang.String%29)您可以通过 using方法获取 Web 资源的实际文件系统路径。

```
ServletContext ctx = request.getServletContext();
String path = ctx.getRealPath("/"); 
```

并修改您`Action`以将请求或 servlet 上下文作为参数：

```
public Action(ServletContext ctx) {
    System.out.println("--> " + ctx.getRealPath("/"));
} 
```

# json - 将json查询结果的一部分存储在powershell中的变量中

> ID：16092025
> 
> 赞同：2
> 
> 时间：2013-04-18T20:01:13.977
> 
> 标签：json, powershell, powershell-3.0

我有来自 json 查询的以下输出，我正在寻找一种方法来搜索它并提取 tvdbid 的值（数字 72663）并将其存储在一个变量中。

在下面的示例中，您可以看到实际上有 2 个结果，所以我希望它将两者都存储在数组中。

我在我的电脑上运行 powershell 3，所以任何 v3 特定的东西都应该没问题。

**输出**

```
{
    "data": {
        "langid": 7, 
        "results": [
            {
                "first_aired": "2010-11-15", 
                "name": "Accused", 
                "tvdbid": 72663
            }, 
            {
                "first_aired": "2010-01-17", 
                "name": "Enzai: Falsely Accused", 
                "tvdbid": 135881
            }
        ]
    }, 
    "message": "", 
    "result": "success"
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:25:30.717

使用 PS V3：

```
$json = @'
{
    "data": {
        "langid": 7, 
        "results": [
            {
                "first_aired": "2010-11-15", 
                 "name": "Accused", 
                "tvdbid": 72663
            }, 
            {
                "first_aired": "2010-01-17", 
                "name": "Enzai: Falsely Accused", 
                "tvdbid": 135881
            }
        ]
    }, 
    "message": "", 
    "result": "success"
}
'@

$psobj = ConvertFrom-Json $json
$psobj.data.results.tvdbid

 72663
 135881 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T03:49:24.777

大多数时候我现在使用@mjolinor 提供的 CmdLet，但在两种情况下我仍然使用以下老式 XML 序列化：

1- 当我必须使用 PowerShell V2

2- 即使在 PowerShell V3 中，当**Web 服务返回的 json 非常大**时，PowerShell V3 也会发送异常。

```
Add-Type -AssemblyName System.ServiceModel.Web, System.Runtime.Serialization
$utf8 = [System.Text.Encoding]::UTF8    

function Write-String

{
  PARAM([Parameter()]$stream,
        [Parameter(ValueFromPipeline=$true)]$string)

  PROCESS
  {
    $bytes = $utf8.GetBytes($string)
    $stream.Write( $bytes, 0, $bytes.Length )
  }  
}

function Convert-JsonToXml

{
  PARAM([Parameter(ValueFromPipeline=$true)][string[]]$json)

  BEGIN
  { 
    $mStream = New-Object System.IO.MemoryStream 
  }

  PROCESS
  {
    $json | Write-String -stream $mStream
  }

  END
  {
    $mStream.Position = 0
    try
    {
       $jsonReader = [System.Runtime.Serialization.Json.JsonReaderWriterFactory]::CreateJsonReader($mStream,[System.Xml.XmlDictionaryReaderQuotas]::Max)
       $xml = New-Object Xml.XmlDocument
       $xml.Load($jsonReader)
       $xml
    }
    finally
    {
       $jsonReader.Close()
       $mStream.Dispose()
    }
  }
}

function Convert-XmlToJson
{
  PARAM([Parameter(ValueFromPipeline=$true)][Xml]$xml)

  PROCESS
  {
    $mStream = New-Object System.IO.MemoryStream
    $jsonWriter = [System.Runtime.Serialization.Json.JsonReaderWriterFactory]::CreateJsonWriter($mStream)
    try
    {
      $xml.Save($jsonWriter)
      $bytes = $mStream.ToArray()
      [System.Text.Encoding]::UTF8.GetString($bytes,0,$bytes.Length)
    }
    finally
    {
      $jsonWriter.Close()
      $mStream.Dispose()
    }
  }
} 
```

在您的情况下，这将提供以下内容：

```
$json = @'
{
  "data": {
    "langid": 7, 
    "results": [{
       "first_aired": "2010-11-15", 
        "name": "Accused", 
       "tvdbid": 72663
       }, 
       {
       "first_aired": "2010-01-17", 
       "name": "Enzai: Falsely Accused", 
       "tvdbid": 135881
       }]
  }, 
  "message": "", 
  "result": "success"
}
'@

$xmlOut = Convert-JsonToXml -json $json
($xmlOut.root.data.results).ChildNodes[0].tvdbid.InnerText
($xmlOut.root.data.results).ChildNodes[1].tvdbid.InnerText 
```

# javascript - 来自 html 输入 id 的 Javascript 计算总是导致 1

> ID：16092026
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:15.070
> 
> 标签：javascript

使用 javascript 对提交执行计算时遇到错误。pay_amount 输入提交“1”，total_charged 提交“4.95”，无论pay_amount 的值是多少。

这是html：

```
<form method="POST" action="example-post-url.php" autocomplete="off" name="form" id="form">

    <input type="text" id="pay_amount" name="pay_amount" value="1,794.00"/>  
    <input type="hidden" id="total_charged" name="total_charged" />

    <input type="submit" value="submit" onclick="submitCard();" id="submitButton"/>

</form> 
```

这是javascript：

```
<script>
    function submitCard(){

        var payment = parseFloat(document.getElementById('pay_amount').value);
        var fee = ((payment*0.035)+3.95);
        var total = payment + fee;
        document.getElementById('total_charged').value = total.toFixed(2);

        document.form.submit();
    }
</script> 
```

我尝试用下面的代码替换 var payment，认为这是逗号的问题，但我仍然遇到问题。

```
var payment = document.getElementById('pay_amount').value.replace(/,/g, ''); 
```

这里到底发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:08:57.223

当`parseFloat()`例程看到不属于有效数字的内容时，它会停止解析。在你的情况下，这是逗号。

当您按照帖子中的建议更改代码时，您修复了逗号问题，但您将值保留为字符串。如果你将两者结合起来——去掉逗号*和*调用`parseFloat()`——效果会更好。

也就是说，如果您不打算在服务器上检查付款和费用计算，请在完成后发布您的电子商务网站的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:17:02.417

尝试这个：

```
<script>
    function submitCard(){

        var payment = parseFloat(document.getElementById('pay_amount').value);
        var fee = ((payment*0.035)+3.95);
        var total = payment + fee;
        document.getElementById('total_charged').value = total.toFixed(2);
    }
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:07:35.620

Try this

```
<input type="button" value="submit" onclick="submitCard();" id="submitButton"/> 
```

instead of

```
<input type="submit" value="submit" onclick="submitCard();" id="submitButton"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T20:03:30.610

您应该阻止原始提交

```
<form ... onsubmit="return false;" ...>

    ...

</form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T20:04:57.163

尝试

```
document.forms[0].submit(); 
```

而不是`document.forms.submit()`你现在拥有的。
无论它是否解决了`document.form`未定义的问题，都应该更改它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T20:11:22.113

幸运的是，这与表单的事件无关`submit`，更多的是与属性的字符串类型如何`value`转换为数学运算的数字有关。

查看这个[JSFiddle](http://jsfiddle.net/qGYvw/1/)以了解如何`parseFloat()`更好地使用。

这是重要的部分：

```
parseFloat(document.getElementById('pay_amount').value.replace(',', '')); 
```

# jquery - 饼图 - legendItemClick-highchart 的自定义事件

> ID：16092030
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:27.427
> 
> 标签：jquery, highcharts

请查看 jsfiddle[**`here`**](http://jsfiddle.net/8T7Ew/)以了解我在做什么。要开始`legendItemClick`工作，我需要单击图例中的彩色按钮。

但在此示例中，即使单击文本（彩色按钮右侧）也会触发`legendItemClick` 单击事件。

即使单击文本，我应该怎么做才能触发事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T07:56:16.657

根据文档 legendItemClick 在饼图中不受支持[http://api.highcharts.com/highcharts#plotOptions.pie.events.legendItemClick](http://api.highcharts.com/highcharts#plotOptions.pie.events.legendItemClick)但您可以使用解决方法：http: [//jsfiddle.net/JkDrM/13/](http://jsfiddle.net/JkDrM/13/)

```
 $(chart.series[0].data).each(function(i, e) {
        e.legendItem.on('click', function() {
            if (!e.sliced) {
                alert('hide slice');
            } else {
                alert('show slice');
            }
            e.slice(!e.sliced);
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T07:47:41.833

我猜你没有正确地提出你的问题！“//这里有一些代码来实现我的目标”什么目标？

# jquery - 异步网页

> ID：16092037
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:51.257
> 
> 标签：jquery, asynchronous, web, web-deployment

下午好，我想知道一些关于异步加载网页的知识。我有一个登录的网页，登录后正在加载，大约 10 秒（可能更多）。该网页的加载速度非常慢，因为在页面的一部分中，它有一个从多个查询加载到服务器的树。放弃查询的优化，我想做的是加载页面但不加载树。与其加载树，不如加载一个旋转的轮子来象征它的加载。当文档就绪事件被触发时，开始加载树。我想知道一个过程（如果有的话），或者它是否像将树粘贴在文档准备功能中一样简单。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:12:07.240

这是我目前正在处理的应用程序的一种微调示例。它使用 jQuery 和 AJAX。

```
$(document).ready(function() {
    params = { var1 = 2, var2 = 4 };
    var checkStatus = function() {
        $.getJSON('index.php/loader/op_status', params, function(opc) {
            results = $.parseJSON(opc.results);
            percent = results.status;

            if (results.status != 100) {
                $('#loading-percentage .percentage').html(percent);
                setTimeout(checkStatus, 1000); // check every second for results
            } else {
                $(opk.keywords).insertAfter('#opc-results .kw-section .summary');
                $('#loading-percentage').remove();
            }
        }
    }
    checkStatus();
} 
```

这样做是检查状态文件并返回一个整数，我将其用作文字状态百分比。如果百分比 < 100 则显示加载动画，否则加载完成内容并删除动画。该过程每秒检查一次，因此您可以实时获得最新状态。

您可以将此作为起点，但显然您需要根据自己的需要对其进行微调。

# php - 如果用户单击包含数字的文本，则忽略电话的拨号盘

> ID：16092039
> 
> 赞同：0
> 
> 时间：2013-04-18T20:01:54.840
> 
> 标签：php, android, iphone, html

我正在开发一个 Web 应用程序来跟踪库存。快完成了。在我的手机上测试时发现了一个问题。

如果用户在他/她的电话上并选择了一个部件/序列号，它会调出电话的拨号盘。

是否有一个标签我可以围绕这些标签让电话忽略他们的拨号盘并将其视为点击......除了让它们都指向他们所在的页面（#）之外，我还没有想办法解决它。

有人有意见吗？因为这真的很烦人，我开发这个应用程序的全部原因是我们可以在现场的手机上使用它。

Google / StackOverflow 查询返回 0 个有用的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:06:12.153

In your site's `<head>`:

```
<meta name="format-detection" content="telephone=no"> 
```

# laravel - Laravel 4，针对 @include 查看作曲家

> ID：16092045
> 
> 赞同：0
> 
> 时间：2013-04-18T20:02:27.247
> 
> 标签：laravel, laravel-4, blade

我注意到如果我像这样将第二个参数传递给@include：

```
@include('sidebars.pages', array('categories' => Category::all())) 
```

然后可以复制在视图中渲染部分的概念，并在部分中渲染部分，就像在 Rails 中一样。

我还需要具有此功能的视图作曲家吗？

我很感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:18:22.327

尝试使用 View Composers 将数据绑定到视图。最适合局部视图

```
// View Composer Example
View::composer(array('sidebars.pages'), function($view)
{
    $view->with('categories', Categories::all());

});

@include('sidebars.pages') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:53:13.877

虽然这可能是可能的，但这不是`@include`. 这样做时我会谨慎行事，而且就个人而言，我不会在您的视图中调用模型。从路由或控制器绑定您需要的数据。使用演示者执行任何演示逻辑，以保持您的视图绝对干净。

`@include`将所有当前定义的变量注入嵌套的局部视图。因此，如果您将所有类别绑定到父视图，然后 used `@include('sidebars.pages')`，该视图也会将类别绑定到它。

# c - C语言。如何将字符串添加到链表

> ID：16092046
> 
> 赞同：-4
> 
> 时间：2013-04-18T20:02:31.010
> 
> 标签：c, string, pointers, linked-list

出于某种原因，我无法正常工作。这是我在代码中的功能，如果这还不够帮助，我会很乐意发布整个代码。

```
char addcity()
{
    citylist=malloc(sizeof(struct city));
    struct city *temp;
    char addcity[50];
    char addstate[50];
    char addpopulation[50];
    char addregion[50];
    char addzipcode[50];
    //temp = citylist;
    //citylist=malloc(sizeof(struct city));
    //struct city *ptr=citylist;
    struct city *ptr= (struct city*)malloc(sizeof(struct city));
    printf("Which city would you like to add?: ");
    scanf("%s",addcity);
    printf("Which state is the city in?: ");
    scanf("%s",addstate);
    printf("What is the population?: ");
    scanf("%s", addpopulation);
    printf("what is the region?: ");
    scanf("%s", addregion);
    printf("what is the zipcode?: ");
    scanf("%s", addzipcode);
    int found;
    ptr->name=addcity;
    ptr->statecode=addstate;
    ptr->population=addpopulation;
    ptr->region=addregion;
    ptr->zipcode=addzipcode;
    ptr->next=NULL;

    curr->next=ptr;
    curr=ptr;

    printlist();  //this just prints out the whole list. 
```

有时我得到一个分段错误，而其他时候它根本不起作用。我必须使用 strcpy(a,b) 来复制字符串吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T05:18:39.670

```
printf("Which city would you like to add?: ");
scanf("%s",&ptr->name);
printf("Which state is the city in?: ");
scanf("%s",&ptr->statecode);
printf("What is the population?: ");
scanf("%s",&ptr->population);
printf("what is the region?: ");
scanf("%s",&ptr->region);
printf("what is the zipcode?: ");
scanf("%s",&ptr->zipcode); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T04:32:58.280

```
printf("Enter String ::");
scanf("%s",&ptr->str); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:19:28.380

您的代码中有一些问题。您的第一个问题是您在结构中设置指针以指向局部变量。一旦代码离开`addcity()`，这些局部变量将不再有效，任何试图使用它们的东西都会遇到麻烦。

要将本地字符串复制到您的结构中，您需要使用某种形式的字符串复制功能，例如`strcpy(a,b)`.

# c# - 我错过了什么？RestSharp 不会反序列化 Json

> ID：16092048
> 
> 赞同：10
> 
> 时间：2013-04-18T20:02:43.177
> 
> 标签：c#, json, foursquare, restsharp

我正在尝试将 json 响应从foursquare 转换回对象。我得到了类似的东西

```
 {
   "meta":{
      "code":200
   },
   "response":{
      "venues":[
         {
            "id":"4abfb58ef964a520be9120e3",
            "name":"Costco",
            "contact":{
               "phone":"6045967435",
               "formattedPhone":"(604) 596-7435"
            },
            "location":{
               "address":"7423 King George Hwy",
               "crossStreet":"btw 76 Avenue & 73A Avenue",
               "lat":49.138259617056015,
               "lng":-122.84723281860352,
               "distance":19000,
               "postalCode":"V3W 5A8",
               "city":"Surrey",
               "state":"BC",
               "country":"Canada",
               "cc":"CA"
            },
            "canonicalUrl":"https:\/\/foursquare.com\/v\/costco\/4abfb58ef964a520be9120e3",
            "categories":[
               {
                  "id":"4bf58dd8d48988d1f6941735",
                  "name":"Department Store",
                  "pluralName":"Department Stores",
                  "shortName":"Department Store",
                  "icon":{
                     "prefix":"https:\/\/foursquare.com\/img\/categories_v2\/shops\/departmentstore_",
                     "suffix":".png"
                  },
                  "primary":true
               }
            ],
            "verified":true,
            "restricted":true,
            "stats":{
               "checkinsCount":2038,
               "usersCount":533,
               "tipCount":12
            },
            "url":"http:\/\/www.costco.ca",
            "specials":{
               "count":0,
               "items":[

               ]
            },
            "hereNow":{
               "count":0,
               "groups":[

               ]
            },
            "referralId":"v-1366316196"
         }
      ]
   }
} 
```

我做了这样的课

```
 public class Response
    {
        public string Meta { get; set; }
        public List<Venue> Venues { get; set; }
    }

  public class Venue
    {
        public string Id { get; set; }
        public string Name { get; set; }
        public Contact Contact { get; set; }
        public Location Location { get; set; }
        public string CanonicalUrl { get; set; }
        public Categories Categories { get; set; }
        public bool Verified { get; set; }
    }

 var response = client.Execute<Response>(request);
       var test = response.Data; 
```

然而`Venues`始终为空。我不知道为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-25T16:58:21.200

您只需要更深入地了解 JSON 响应。该属性的上一层`venues`是该`response`属性，该属性当前未在您的`Response`类中表示。

你有两种方法可以解决这个问题。

1) 添加另一个包装响应对象，其中包含缺少的`response`属性

```
// this is the new wrapping object
public class FourSquareResponse
{
    public string Meta { get; set; }
    public VenueResponse Response { get; set; } // previously missing
}

public class VenueResponse
{
    public List<Venue> Venues { get; set; }
}

public class Venue
{
    public string Id { get; set; }
    public string Name { get; set; }
    public Contact Contact { get; set; }
    public Location Location { get; set; }
    public string CanonicalUrl { get; set; }
    public Categories Categories { get; set; }
    public bool Verified { get; set; }
} 
```

并执行请求...

```
var request = new RestRequest(uri);
var response = client.Execute<Response>(request); 
```

2）忽略该`meta`属性并开始解析该`response`属性。

*顺便说一句，看起来`meta`JSON 响应的属性可能是 HTTP 状态代码。如果它是并且您仍然需要它，RestSharp 也会为您提供（见下文）。

```
public class Response
{
    public string Meta { get; set; }
    public List<Venue> Venues { get; set; }
}

public class Venue
{
    public string Id { get; set; }
    public string Name { get; set; }
    public Contact Contact { get; set; }
    public Location Location { get; set; }
    public string CanonicalUrl { get; set; }
    public Categories Categories { get; set; }
    public bool Verified { get; set; }
} 
```

但是，这需要告诉 RestSharp 从哪里开始解析响应。

```
var request = new RestRequest(uri)
{
    RootElement = "response"
};
var response = client.Execute<Response>(request);

// and the HTTP status (if that's what you need)
response.StatusCode 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T23:53:31.963

JSON 反序列化为 .NET 对象区分大小写。您的属性名称与 JSON 标签不匹配，这就是为什么当您尝试反序列化时，您会返回 NULL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:13:31.823

如果我朝着正确的方向前进，那么你的 JSON 不是`Valid`

```
Error:Strings should be wrapped in double quotes 
```

得到它经过验证[的 jsonformatter](http://jsonformatter.curiousconcept.com/)

[更新]

有效的 JSON 就像：-

```
{
"meta": {
    "code": 200
        },
    "notifications": 
        [
            {
                "type": "notificationTray",
                "item": {
            "unreadCount": 0
                }
            }
        ],
    "response": {
    "venues": [
        {
            "id": "4e15d1348877cd5712112a44",
            "name": "The Arena",
    "contact": { },
    "location": {
        "address": "110 Wall Street",
        "lat": 40.70432634495503,
        "lng": -74.0055421062419,
        "distance": 671,
        "city": "New York",
        "state": "NY",
        "country": "United States",
        "cc": "US"
    },
    "canonicalUrl": "https://foursquare.com/v/the-arena/4e15d1348877cd5712112a44",
    "categories": [
        {
            "id": "4bf58dd8d48988d1e4941735",
            "name": "Campground",
    "pluralName": "Campgrounds",
    "shortName": "Campground",
    "icon": {
            "prefix": "https://foursquare.com/img/categories_v2/parks_outdoors/campground_",
            "suffix": ".png"
    },
    "primary": true
}
],
"verified": false,
"stats": {
        "checkinsCount": 149,
        "usersCount": 25,
        "tipCount": 4
},
"specials": {
        "count": 0,
        "items": [ ]
},
"hereNow": {
        "count": 0,
        "groups": [ ]
},
"referralId": "v-1366314443"
}         
]
}

} 
```

# c# - wpf 耗时的操作和调度程序

> ID：16092052
> 
> 赞同：0
> 
> 时间：2013-04-18T20:02:50.323
> 
> 标签：c#, wpf, multithreading, listview

我必须监视网络上的所有帧。为此，我创建了 2 个`ListViews`，一个用于显示帧名称、dlc、有效负载和时间戳。我有一个事件，当接收到新框架并在框架中进行更新时触发`ListView`。如果我在 lv 中选择一帧，则第二帧将`ListView`填充有关所选帧的少量信息。随着该事件的触发和帧有效负载的变化，选定的行和整个第二行都`ListView`在更新。所有这些工作我只有一个`Dispatcher.Invoke`，而且似乎`GUI`随着更新而落后。我应该使用两个调度程序吗？一个用于第一个帧更新，`ListView`第二个用于另一个`ListView`? 我应该为它们中的每一个选择什么优先级？目前我正在使用第 6 级，命名为：Loaded。

```
<ListView ItemsSource="{StaticResource frames}" 
          Grid.Row="0" 
          Margin="0,1,0,1" 
          Name="lvFrames"
          VerticalContentAlignment="Top" 
          ItemContainerStyleSelector="{StaticResource itemSelector}"
          FontSize="12"
          VirtualizingStackPanel.VirtualizationMode="Recycling"
          VirtualizingStackPanel.IsVirtualizing="True"
          BorderThickness="1"
          BorderBrush="Gray" 
          Grid.ColumnSpan="2" 
          SelectionChanged="lvFrames_SelectionChanged">

    <ListView.View>
        <GridView>
            <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Time}" Width="55"/>
            <GridViewColumn Header="Dir" DisplayMemberBinding="{Binding Dir}" Width="40"/>
            <GridViewColumn Header="Id" DisplayMemberBinding="{Binding Id}" Width="40"/>
            <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="125"/>
            <GridViewColumn Header="Dlc" DisplayMemberBinding="{Binding Dlc}" Width="40" />
            <GridViewColumn Header="Data" DisplayMemberBinding="{Binding Data}" Width="150" />
        </GridView>
    </ListView.View>
</ListView> 
```

这是`XAML`第一个`ListView`：

```
<ListView ItemsSource="{StaticResource signals}" 
          Grid.Row="0" 
          Margin="0,1,-0.48,0"
          Name="lvSignals"
          VerticalContentAlignment="Bottom" 
          FontSize="12" VirtualizingStackPanel.VirtualizationMode="Recycling"
          VirtualizingStackPanel.IsVirtualizing="True" 
          BorderThickness="1" BorderBrush="Gray" Grid.ColumnSpan="2"
          VerticalAlignment="Stretch">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Signal Name"
               DisplayMemberBinding="{Binding Name}" Width="160" />
                <GridViewColumn Header="Signal Value"
              DisplayMemberBinding="{Binding Value}" Width="100"/>
           </GridView>
       </ListView.View>
   </ListView> 
```

而这一为信号`ListView`。

# html - Safari 浏览器问题：固定页脚隐藏了我的内容的底部

> ID：16092055
> 
> 赞同：3
> 
> 时间：2013-04-18T20:02:55.840
> 
> 标签：html, css, grid, hidden

以下是Safari浏览器的问题。它适用于 Chrome。我正在开发一个基于网格的投资组合网站，该网站在隐藏内容方面存在一些问题。目前正在切断 3 x 4 网格的最后三个图块，有什么方法可以在滚动时使它们可见？谢谢！

演示：www.mindtale.com/portfolio.html

portfolo.html

```
<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="style2.css"> 
<title>Mindtale Test Home</title>
</head>

<body>

<!-- Header -->

<div id="headerlogo">
<a href="index.html"><img src="images/logo.png"></a></div>

<div id="headerfill"></div>
<div id="header"></div>

<div id="headerlink1">

<a href="portfolio.html">Portfolio</a>
</div>

<div id="headerlink2">
<a href="contact.html">Contact</a>
</div>

<!-- Content -->

<div id="gridcontainer">

<div id="portfolio-grid">

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://news.bbc.co.uk" target="_blank">BBC News</a></div>
    <div class="website-url"><a href="http://news.bbc.co.uk" target="_blank">http://news.bbc.co.uk</a></div>
    <div class="website-description">A popular destination for up-to-date news in the UK and around the World.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.envirogadget.com" target="_blank">EnviroGadget</a></div>
    <div class="website-url"><a href="http://www.envirogadget.com" target="_blank">http://www.envirogadget.com</a></div>
    <div class="website-description">One of Dan's websites focusing on the best of eco-friendly gadgets.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.google.co.uk" target="_blank">Google</a></div>
    <div class="website-url"><a href="http://www.google.co.uk" target="_blank">http://www.google.co.uk</a></div>
    <div class="website-description">The search engine that most people use.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://news.bbc.co.uk" target="_blank">BBC News</a></div>
    <div class="website-url"><a href="http://news.bbc.co.uk" target="_blank">http://news.bbc.co.uk</a></div>
    <div class="website-description">A popular destination for up-to-date news in the UK and around the World.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.envirogadget.com" target="_blank">EnviroGadget</a></div>
    <div class="website-url"><a href="http://www.envirogadget.com" target="_blank">http://www.envirogadget.com</a></div>
    <div class="website-description">One of Dan's websites focusing on the best of eco-friendly gadgets.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.google.co.uk" target="_blank">Google</a></div>
    <div class="website-url"><a href="http://www.google.co.uk" target="_blank">http://www.google.co.uk</a></div>
    <div class="website-description">The search engine that most people use.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://news.bbc.co.uk" target="_blank">BBC News</a></div>
    <div class="website-url"><a href="http://news.bbc.co.uk" target="_blank">http://news.bbc.co.uk</a></div>
    <div class="website-description">A popular destination for up-to-date news in the UK and around the World.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.envirogadget.com" target="_blank">EnviroGadget</a></div>
    <div class="website-url"><a href="http://www.envirogadget.com" target="_blank">http://www.envirogadget.com</a></div>
    <div class="website-description">One of Dan's websites focusing on the best of eco-friendly gadgets.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.google.co.uk" target="_blank">Google</a></div>
    <div class="website-url"><a href="http://www.google.co.uk" target="_blank">http://www.google.co.uk</a></div>
    <div class="website-description">The search engine that most people use.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://news.bbc.co.uk" target="_blank">BBC News</a></div>
    <div class="website-url"><a href="http://news.bbc.co.uk" target="_blank">http://news.bbc.co.uk</a></div>
    <div class="website-description">A popular destination for up-to-date news in the UK and around the World.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.envirogadget.com" target="_blank">EnviroGadget</a></div>
    <div class="website-url"><a href="http://www.envirogadget.com" target="_blank">http://www.envirogadget.com</a></div>
    <div class="website-description">One of Dan's websites focusing on the best of eco-friendly gadgets.</div>
    <div class="website-clear"></div>
</div>

<div class="portfolio-website">
    <div class="website-thumbnail"><a href="http://news.bbc.co.uk" target="_blank"><img src="images/gridimg1.png" alt="BBC News"></a></div>
    <div class="website-name"><a href="http://www.google.co.uk" target="_blank">Google</a></div>
    <div class="website-url"><a href="http://www.google.co.uk" target="_blank">http://www.google.co.uk</a></div>
    <div class="website-description">The search engine that most people use.</div>
    <div class="website-clear"></div>
</div>

</div>

<!-- <div id="content">
<h2>A random heading</h2>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>
<p>Content Placeholder ... </p>

</div> -->

<!-- Footer -->

<div id="footer">
Mindtale &copy; 2013
</div>

</body> 
```

样式.css

```
html { 
height:100%; /* fix height to 100% for IE */
max-height:100%; /* fix height for other browsers */
background: url(images/bg.jpg) no-repeat center center fixed; /* add background image */
-webkit-background-size: cover; /* fix height for other browsers */
-moz-background-size: cover; /* fix height for other browsers */
-o-background-size: cover; /* fix height for other browsers */
background-size: cover; /* fix height for other browsers */
}

/* Header */
/* -------------------------------------------------- */

div#header {
z-index:3;
position:fixed;
background: url(images/header.png) no-repeat center;
height: 102px;
top:0px;
left:0px;
width:100%;
padding: 0px;
}

div#headerfill {
z-index:4;
position:fixed;
background: url(images/headerfill.png) repeat-x;
height: 98px;
top:0px;
left:0px;
width:100%;
padding: 0px;
}

div#headerlink1 {
font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
font-size:90%;
z-index:4;
position:fixed;
top:55px;
left:18%;
color:#999;
padding: 0px;
}

div#headerlink2 {
font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
font-size:90%;
z-index:4;
position:fixed;
top:55px;
left:78%;
color:#999;
padding: 0px;
}

div#headerlogo {
z-index:5;
position:fixed;
top:30px;
left:42%;
color:#999;
padding: 0px;
}

/* Content */
/* -------------------------------------------------- */

div#content {
position:fixed;
width:100%;
color:#222;
top: 70px; 
bottom: 0; 
left: 0; 
right: 0;
padding: 25px;
overflow: auto;

font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;

}

/* Footer */
/* -------------------------------------------------- */

div#footer {
position:fixed;
bottom:0px;
left:0px;
width:100%;
color:#999;
background:#333;
padding: 8px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:06:43.273

这是因为您有一个具有 CSS 属性的页脚`position:fixed;`。这将页脚从元素流中取出，使页脚之前的内容隐藏在页脚后面。

尝试添加`padding-bottom:50px;`到`div#gridcontainer`，如下所示：

```
#gridcontainer {
    top: 150px;
    bottom: 100px;
    position: relative;
    overflow: hidden;
    width: 996px;
    margin: 0 auto;
    padding-bottom: 50px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:18:48.323

另一种语义较少的方法来解决这个问题（但上面的填充解决方案更好）：

固定页脚已从 DOM 流中删除，因此您必须在页脚之前的 div 底部添加一些空间，以便页脚阻塞的内容无关紧要。

您可以通过在最后一个投资组合网站 div 之后添加另一个元素来创建所需的填充。

```
<div class="spacer">
</div> 
```

然后给它一些高度，然后清除它：

```
.spacer {
  clear: both;
  height: 50px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T21:44:04.397

以下适用于 Safari 中固定页脚的重叠内容：

```
#gridcontainer {
    top: 150px;
    bottom: 100px;
    position: overflow;
    overflow: hidden;
    width: 996px;
    margin: 0 auto;
    padding-top: 150px;
    padding-bottom: 50px;
} 
```

对于 Safari，您将需要：位置 -> 溢出，并提供内容填充，使其显示在所需的屏幕区域中。

# playframework-2.0 - 在 Scala 模板中打印 HTML

> ID：16092056
> 
> 赞同：6
> 
> 时间：2013-04-18T20:02:56.577
> 
> 标签：playframework-2.0, scala-template

我需要使用最新的**Play Framework 2.1.1**消息、变量、简单的 for 循环等在 Scala 模板中打印一些原始 HTML。一切正常。但是如果我需要做一些逻辑并将原始 HTML 打印到模板中怎么办？

```
@{
    val courts = venue.getCourts()
    val totalWidth : Int = 920
    .. some other initialization variables/values

    var output : String = ""
    for(court <- courts) {
        output += "<p>SomeComplexString</p>"
    }

    output
} 
```

在这种情况下，`@{}`函数返回`output`，但 HTML 被转义，而且它也不那么实用（`output`在返回之前将所有内容组合成单个变量）。

如果我把类似的东西

```
for(court <- courts) {
    println("<p>SomeComplexString</p>")
} 
```

它不起作用（我没有收到任何编译错误，但输出没有任何内容）。

我可以

```
@for(court <- courts) {
    <p>SomeComplexString</p>
} 
```

但随后`courts`将超出范围（假设我不能`courts`在一开始就定义为模板变量）。

解决办法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-18T20:50:53.690

> 但是如果我需要做一些逻辑并将原始 HTML 打印到模板中怎么办？

Play Framework 与其他 MVC 框架一样，建议严格分离关注点。您的逻辑必须在您的控制器中，而不是在视图中。这就是为什么在 scala 模板中执行此操作相对复杂的原因。

此外，您可以使用[@Html()](http://www.playframework.com/documentation/2.1.1/ScalaTemplates)来显示未转义的变量。

# python - 从会话中获取用户对象

> ID：16092058
> 
> 赞同：1
> 
> 时间：2013-04-18T20:03:10.437
> 
> 标签：python, django, authentication

如何获取 login() 在会话中保存的用户对象？

```
user= request.session.get('user') 
```

什么都不返回在这个例子中：

```
user = authenticate(username=username, password=password)
if user is not None:
    if user.is_active:
        login(request, user) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:19:10.590

确保您已安装的应用程序中有“ `django.contrib.auth`”和“ `django.contrib.contenttypes`”。之后如果需要运行syncdb。现在您将拥有所需的所有用户表。

接下来，您要确保每个请求都有 request.user 。我认为这就是为什么你没有得到任何 request.user 的原因。 `SessionMiddleware`并且`AuthenticationMiddleware`中间件需要在您`MIDDLEWARE_CLASSES`的设置中。

有关更多信息，请阅读[此处的文档](https://docs.djangoproject.com/en/1.3/topics/auth/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-18T20:13:40.233

**AuthenticationMiddleware**将代表当前登录用户的用户属性添加到每个传入的 HttpRequest 对象。身份验证中间件需要安装会话中间件。因此，您应该在 settings.py 中将此中间件添加到 MIDDLEWARE_CLASSES 元组：

```
MIDDLEWARE_CLASSES = ( 
    #...
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    #...
) 
```

顺便说一句，如果你想知道这个中间件从哪里获得用户，请查看 auth 中间件源：

```
# contrib.auth.middleware.py:

def get_user(request):
    if not hasattr(request, '_cached_user'):
        request._cached_user = auth.get_user(request)
    return request._cached_user

class AuthenticationMiddleware(object):
    def process_request(self, request): 
        assert hasattr(request, 'session'), "The Django authentication middleware requires session middleware to be installed. Edit your MIDDLEWARE_CLASSES setting to insert 'django.contrib.sessions.middleware.SessionMiddleware'."

        request.user = SimpleLazyObject(lambda: get_user(request))

# django.contrib.auth.__init__.py (auth.get_user)

def get_user(request):
    from django.contrib.auth.models import AnonymousUser
    try:
        user_id = request.session[SESSION_KEY]
        backend_path = request.session[BACKEND_SESSION_KEY]
        backend = load_backend(backend_path)
        user = backend.get_user(user_id) or AnonymousUser()
    except KeyError:
        user = AnonymousUser()
    return user 
```

和默认 backend.get_user：

```
# contrib.auth.backends.py

def get_user(self, user_id):    
    try:
        return User.objects.get(pk=user_id)
    except User.DoesNotExist:       
        return None 
```

# android - Google Play 应用内结算版本 3 购买的服务器端验证（第 2 部分）

> ID：16092059
> 
> 赞同：25
> 
> 时间：2013-04-18T20:03:12.253
> 
> 标签：android, in-app-purchase, in-app-billing

所以我想我理解了应用内计费和服务器端验证的工作原理，这要归功于[我之前的问题](https://stackoverflow.com/questions/16067180/server-side-verification-of-google-play-in-app-billing-version-3-purchase)的答案，但现在我想起来了，我仍然迷路了......

这就是我所拥有的，也是我想做的：

我有一个应用程序，用户可以在其中购买几个“项目”。每个项目都存储在服务器上，并且项目应该可以在购买时在应用程序中下载。项目是只能购买一次的托管项目（即非消耗品）。我在 Google Play 开发者控制台中定义项目没有问题，我可以成功购买。

我不明白的是如何让我的服务器不仅验证购买（使用 purchaseToken 和签名），而且还知道购买的是商品 X 而不是商品 Y？是否有一些 Google API，服务器可以与 Google 对话并询问某个 purchaseToken 属于哪个项目 id？还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-19T15:22:06.040

我讨厌回答我自己的问题，但是，嘿，没有人回答！今天早上我和我的同事又重新审视了这个问题。在再次查看 TrivialDrive 示例中客户端验证的工作原理后，我终于想到了解决问题的方法。伙计，当我明白什么是错的时候，我是不是想戴上我的“愚蠢的帽子”。

我认为这是用于验证购买的 purchaseToken 和签名，但这样就无法验证购买的是商品 A 还是商品 B。

如果您想在向买家提供内容之前进行服务器端验证（或任何类型的验证），它实际上是原始 JSON 数据（如果您使用 IabHelper 类，您会从 Purchase 类中获取原始 JSON）您应该与签名和公钥一起使用。由于它是您传递到服务器的原始 JSON 数据，它还包含有关购买的所有信息（例如 SKU id 等）。

将开发人员有效负载设置为唯一标识您的用户（而不是设备！）的东西也很重要。在我们的例子中，每个用户在服务器上都有一个帐户，我使用唯一的用户 ID 作为开发人员有效负载。

/Mr.Stupid 签字！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-11-19T11:24:44.733

[自 2013 年 6 月起，您可以使用Purchase Status API](https://developer.android.com/google/play/billing/gp-purchase-status-api.html)和[Google APIs Client Libraries](https://developers.google.com/discovery/libraries)在服务器端直接通过 Google Play 验证购买。

# c# - ASP MVC 模型可以是单独的项目

> ID：16092065
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:03:34.613
> 
> 标签：c#, asp.net-mvc, entity-framework

ASP 新手 - MVC。使用实体框架。如果我有一个包含 100 多个表的复杂数据库，是否可以将 (M) 模型放在单独的项目中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:05:36.717

是的，您可以将模型放在单独的类库/项目中。您需要正确设置参考。如果您需要参考资料方面的帮助，请查看[https://stackoverflow.com/a/6585397/254973 。](https://stackoverflow.com/a/6585397/254973)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:16:44.523

是的。

如果您的域具有该级别的复杂性，那么单独的项目是一个好主意。这将促进非常自然的关注点分离。

# spring - mvc:annotation-driven 在 Spring 中不起作用

> ID：16092067
> 
> 赞同：2
> 
> 时间：2013-04-18T20:03:39.323
> 
> 标签：spring, spring-mvc, annotations

我有`<mvc:annotation-driven/>`错误的注释。我得到的错误是：匹配的通配符是严格的，但找不到元素'mvc：annotation-driven'的声明。

当我用豆子时

```
<bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" /> 
```

它工作正常。这怎么可能

我完整的 Spring 上下文 XML 文件是：

```
<beans xmlns="http://www.springframework.org/schema/beans"
            xmlns:context="http://www.springframework.org/schema/
         xmlns:mvc="http://www.springframework.org/schema/mvc"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/context             http://www.springframework.org/schema/context/spring-context-2.5.xsd
   http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-2.5.xsd">

    <mvc:annotation-driven/>
</beans> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:36:17.547

我相信 Spring 2.5 中没有`mvc:annotation-driven`注解，我认为它是[在 Spring 3.0 中引入的](https://stackoverflow.com/questions/3977973/whats-the-difference-between-mvcannotation-driven-and-contextannotation)。考虑使用当前版本的 Spring。

我找不到实际的`http://www.springframework.org/schema/mvc/spring-mvc-2.5.xsd`我不确定它是否存在。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T20:29:13.197

Missign 依赖 spring-webmvc，展示你的 pom

# java - 使用具有 Long[] 值的 dataset.addSeries

> ID：16092068
> 
> 赞同：1
> 
> 时间：2013-04-18T20:03:48.490
> 
> 标签：java, arrays, double, jfreechart, long-integer

dataset.addSeries 采用的参数如下`(java.lang.Comparable key, double[] values, int bins, double minimum, double maximum)`

现在，我正在尝试使用`Long[] v1`在`double[] values`字段中调用的变量，但无法弄清楚如何转换它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:05:31.123

来自 Jon Skeet 关于[如何在 Java 中将浮点数组转换为双精度数组的回答？](https://stackoverflow.com/questions/2019362/how-to-convert-array-of-floats-to-array-of-doubles-in-java/2019374#2019374)， 我引用：

> 基本上*，*必须对每个值进行转换。两种数组类型之间没有隐式转换，因为在 JITting 之后用于处理它们的代码会有所不同——它们具有不同的元素大小，并且 long 需要转换，而 double 则不需要。将此与引用类型的数组协方差进行比较，其中读取数据时不需要转换（例如，字符串引用的位模式与对象引用相同）并且所有引用类型的元素大小相同。
> 
> 简而言之，*某些东西*必须循环执行转换。我不知道有任何内置方法可以做到这一点。我确定它们存在于某个地方的第三方库中，但除非您碰巧已经在使用其中一个库，否则我只会编写您自己的方法。

以下是乔恩回答的改编实施以适合您的问题：

```
public static double[] convertLongsToDoubles(Long[] input)
{
    if (input == null)
    {
        return null; // Or throw an exception - your choice
    }
    double[] output = new double[input.length];
    for (int i = 0; i < input.length; i++)
    {
        output[i] = input[i];
    }
    return output;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:13:42.803

你将不得不自己做这件事。

编写一个为您进行转换的方法。

```
public static double[] convertFromLongToDouble(Long[] l) {
double[] doubleArray = new double[l.length];
     // .. iterate through the Long array and populate to double array
return doubleArray;
} 
```

# c# - 允许在 SQL 事务期间读取？

> ID：16092069
> 
> 赞同：3
> 
> 时间：2013-04-18T20:03:50.893
> 
> 标签：c#, asp.net, sql-server, sql-server-2008

在我的网站上，我有一个活动日历：

![在此处输入图像描述](https://i.stack.imgur.com/OE4hb.png)

现在你会注意到它们被很好地组织成天。

这是管理员用来组织项目的功能。

这是问题所在。

发生这种情况时，我使用事务范围，因为它会修改多个事件并且可能会失败：

前任：

```
 //needs id '9999'
public string Explode()
{
   string eid = Request.Form["id"];

   using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Required, new System.TimeSpan(2, 45, 0)))
            {
   try
   {
      int id = int.Parse(eid);

      Project p = ProjectManager.GetProject(id);
      int resID = p.Schedule.Employee.EmployeID;
      Employee e = ResourceManager.GetEmployee(resID);
      if (e == null)
         throw new Exception();

      var tasks = ProjectManager.GetProjectTasks(id);
      var ordered = SyncManager.Instance.GetTasks((int)p.PaymoID);

      Task firstTask = null;

      foreach (Paymo.Task t in ordered)
      {
         Task tsk = (from obj in tasks where obj.PaymoID != null && obj.PaymoID.Value == t.ID select obj).FirstOrDefault();
         if (tsk != null && t.UserName == e.EmployeName
            && tsk.Schedule == null)
         {
            if (firstTask == null)
            {
               firstTask = tsk;
            }

            int scheduleID = ScheduleManager.CreateSchedule(p.Schedule.DateFrom.Value
               ,t.BudgetHours <= 0 ? 1.0M : t.BudgetHours , e.EmployeID);

            if (scheduleID == -1)
               throw new Exception();

            if (!ScheduleManager.ChangeTaskSchedule(tsk.TaskID, scheduleID))
               throw new Exception();

            if (!ScheduleManager.GiveLowestPriority(ScheduleManager.GetSchedule(scheduleID)))
            {
               throw new Exception();
            }                           
          }
       }

       ScheduleManager.ChangeProjectSchedule(p.ProjectID, null);
       if (firstTask != null)
       {
          Bump b = new Bump();
          b.DoBump(firstTask.Schedule);
       }
       scope.Complete();
    }

    catch (Exception)
    {
       return "fail";
    }
  } 
  return "";
} 
```

现在的问题是，当交易发生时，如果用户试图以只读模式访问日历，他们必须等待才能看到它。

是否有某种方式可以在交易期间仍然加载网站？我使用 LINQ SQL 和 SQL Server 2008 和 VS 2012。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:16:14.540

将您的使用更改为：

```
new TransactionScope(TransactionScopeOption.Required, new TransactionOptions() { IsolationLevel = IsolationLevel.ReadCommitted,Timeout = new System.TimeSpan(2, 45, 0) })); 
```

# spring - SpringJUnit4ClassRunner 的问题，H2 db inetgration 测试

> ID：16092071
> 
> 赞同：0
> 
> 时间：2013-04-18T20:03:56.057
> 
> 标签：spring, unit-testing, testing, junit, integration

我正在尝试使用 h2 db 编写集成测试，在 @RunWith() 行出现“错误：无法访问 BlockJUnit4ClassRunner”错误

有人可以建议吗？我不知道，即使我注释掉测试中的所有内容，它也不会构建并给出相同的错误，所以我不认为测试中导致问题的原因

```
@RunWith(SpringJUnit4ClassRunner.class)
@TransactionConfiguration(defaultRollback = true)
@ContextConfiguration(locations = { "classpath:test-applicationContext.xml" })
public class WfsDBTest extends AbstractTransactionalJUnit4SpringContextTests {} 
```

请帮忙谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:07:19.703

It looks like you use wrong version of JUnit.

Make sure that you use JUnit 4.x and there are no other versions of JUnit in your classpath. Try to use the latest version.

# mysql - HTML5 和 MySQL 日期格式

> ID：16092074
> 
> 赞同：7
> 
> 时间：2013-04-18T20:04:07.923
> 
> 标签：mysql, html

我无法在 mysql(YYYY-mm-dd) 中插入 HTML5 默认日期格式(mm/dd/yyyy)。请帮助有什么方法可以将 html5 日期插入 mysql。或者是否可以更改 html5/mysql 日期格式？

```
<?php
  $name=$_POST['name'];
  $email=$_POST['email'];
  $password=$_POST['password'];
  $gender=$_POST['gender'];
  $bday=$_POST['bday'];
  include('connect.php');
  $y=mysql_query("insert into users values('$name','$email','$password','$gender','$bday')");
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:22:14.010

```
<?php

$date = date('Y-m-d',strtotime($date));

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:14:32.453

要更改查询中的 MySQL 日期格式，您可以使用：

...因为我们可以看到您的代码

**编辑：**

```
 mysql_query("insert into users values('$name','$email','$password','$gender',".date('Ymd',$bday)) 
```

希望这可以帮助...

# javascript - 在 asp.net 中的 javascript 中设置服务器端会话对象

> ID：16092075
> 
> 赞同：1
> 
> 时间：2013-04-18T20:04:09.747
> 
> 标签：javascript, asp.net, session-variables

我搜索了 SO 和谷歌，但没有找到任何可以解决我的问题的东西。
我有一个弹出窗口，用户可以在其中单击“保存”、“删除”或“关闭”。这三个功能中的每一个最终都会关闭弹出窗口。在父窗口代码隐藏中，我需要知道用户单击了 3 个按钮中的哪一个。

目前，在弹出窗口（如果用户单击删除）上，我有（预先存在的代码）：

```
function CloseDelete() {

    var agree = confirm("Are you sure you want to delete this record?");
    if (agree)
        __doPostBack("<%=btnDelete.UniqueID %>", "");
    // create session object here //
    else
        return false;

    GetRadWindow().Close();
} 
```

我正在考虑在弹出窗口上用 javascript 创建一个会话对象，我可以在父窗口代码隐藏中检查它。如何在上面的函数中创建会话对象？或者我如何确定用户点击了哪个按钮？

# sublimetext2 - 除一个或多个文件外的所有文件中的崇高 text2 文本替换模式

> ID：16092077
> 
> 赞同：0
> 
> 时间：2013-04-18T20:04:12.210
> 
> 标签：sublimetext2, sublimetext

我想在我的所有项目文件中查找并替换一个特定的单词，除了一个或多个 sublime 文本文件。我不确定如何指定。

所以基本上我想排除

```
/Uses/project_name/css/my_file.css 
```

/Uses/project_name/css/my_file2.css

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:41:12.287

菜单：`Find-> Find in Files...`

Sublime 将在底部打开一个新面板，您只需要填写字段即可。

```
Find: the_word_you_are_looking_for
Where: your_project_directory
Replace: the_word_that_is_going_to_replace_the_old_one 
```

然后单击`...`位于字段右侧的按钮`Where:`，然后单击选项`Add Exclude Filter`；`-*.txt`用`my_file?.css`或替换`my_file*.css`

# r - 基于 r 中的分类变量的线性回归

> ID：16092079
> 
> 赞同：1
> 
> 时间：2013-04-18T20:04:27.903
> 
> 标签：r

我查看了各种 r 资源，但找不到明显的解决方案来解决我的问题。如果在其他地方回答了这个问题，那么指向正确方向的指针会很有用。使用以下数据集：

```
 tmp <- c(35,35,35,35,35,36,36,36,36,36)
    experiment <- factor(tmp)
    rpm <- c(10,20,40,80,120,10,20,40,80,120)
    x <- c(678,1889,3416,8916,17917,665,1385,3377,8551,16793)
    test <- data.frame(experiment,rpm,x) 
```

我想执行回归，例如在 rpm 上使用 lm 对 x 进行线性回归：

```
 lm(x ~ rpm) 
```

因此，在这个例子中，我将有两个回归，一个用于实验 35，一个用于实验 36。我可以对数据进行子集化，但我的实际数据将有超过 200 个实验，我想知道我是否可以只用几行代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:08:27.080

有`plyr`：

```
library(plyr)
dlply(test, .(experiment), function(df) with(df, lm(x ~ rpm))) 
```

# html-table - 无法删除 html 表格顶部的行

> ID：16092080
> 
> 赞同：0
> 
> 时间：2013-04-18T20:04:39.540
> 
> 标签：html-table, border, borderless

我正在构建一个在主页中间包含一个表格的网站，我似乎无法让一条线（看起来像一条`<hr>`线）从它的顶部消失。这是页面[http://marccary.com/test](http://marccary.com/test)的链接，这是我用于表格的代码：

```
<table cellspacing="0" cellpadding="0" border="none">
  <colgroup border="none">
    <col span="1" width="400" >
    <col span="1" width="400" >
  </colgroup>
  <tr>
    <td height="225" width="600"><p align="center">&nbsp;
&nbsp;
&nbsp;
<iframe width="400" height="166" scrolling="no" frameborder="no" src="http://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F84936057%3Fsecret_token%3Ds-4zQJw&show_artwork=true&secret_url=true"></iframe><br><span style="font-size:20px;"><a href="https://soundcloud.com/marccary" style="color:#white;">Marc Cary on Soundcloud>></a></span></p></td>
    <td height="225" width="600"><p align="center">&nbsp;
<iframe width="400" height="225" src="http://www.youtube.com/embed/j9GhIaaEC6c" frameborder="0" allowfullscreen></iframe>
<span style="font-size:20px;"><a href="http://www.youtube.com/marccary" style="color:#white;">Marc Cary's YouTube channel>></a></savaipan></p></td></tr></table> 
```

我已经进入了我的 CSS 并试图确保表格上没有边框。我已将以下代码放入我的 CSS 样式表中：

```
table {
    border-collapse: separate;
    border-spacing: 0;
    border: none !important;
    border-top: none;
    border-bottom: none;
}
caption,
th {
    border-bottom: none;
    border: none;
    border-top: none;
}
td {
    font-weight: normal;
    text-align: left;
    border-top: none;
    border: none;
    border-bottom: none;
}
tr {
    border: none;
    border-bottom: none;
    border-top: none;
} 
```

仍然没有运气。有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:08:27.303

你有一个 CSS 设置：

```
.entry-content td, .comment-content td {
   border-top: 1px solid #EDEDED;
} 
```

这就是你看到的边界。

这个 CSS

```
border-top: none;
border: none;
border-bottom: none; 
```

可以缩短为

```
border: none; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:22:53.287

将以下内容添加到您的 CSS 中：

```
hr {
    height: 0px !important;
} 
```

您似乎正在使用 CMS 软件来开发您的网站，而您使用的模板实际上是`<hr>`在

```
<div id="page" ...>
    <header id="masthead" ...>
        <hgroup ...>
        <nav id="site-navigation" ...>
        <hr>
    </header>
    <div id="main" ...>
    <footer ...>
</div> 
```

# c# - 自动化 C# 构建 - 如何更改对发布版本的引用？

> ID：16092081
> 
> 赞同：0
> 
> 时间：2013-04-18T20:04:42.707
> 
> 标签：c#, build, tfs

我正在尝试自动化我们的构建过程。我们有一个 TFS 结构，如下所示：

Branches/ProjectName/Version2.0/all_the_files Branches/AnotherProjectName/Version5.0/all_the_files

$/ProjectName/working_line $/AnotherProjectName/working_line

我已经设法使用 TFS API 自动从工作线分支到每个项目的特定发布文件夹。现在的问题是自动构建它。我大概可以弄清楚如何生成构建序列，并传入每组构建文件的特定位置，但是引用不起作用有两个原因：1）working_line 目录结构与分支的不同代码 2) 在 working_line 我们通过直接转到包含引用的调试文件夹位置来包含引用，而在生产中我们希望指向发布文件夹

我是在以错误的方式思考这个问题，还是有一些简单的方法来做我在想的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:17:26.183

也许你应该尝试条件参考。我不确定这是否适合你。试试[这个](https://stackoverflow.com/questions/6523008/visual-studio-2010-conditional-references)。

# actionscript-3 - 我动态添加的影片剪辑的名称为“instance XX”

> ID：16092082
> 
> 赞同：0
> 
> 时间：2013-04-18T20:04:43.837
> 
> 标签：actionscript-3, flash, dynamic, actionscript, movieclip

这里发生了一些我不完全理解的事情。我创建了一个自定义类，它扩展了 MovieClip 以提供一些自定义属性并在创建的 MovieClip 内部创建一个几何形状

```
package com.hyatt
{
import flash.display.*;
import flash.geom.*;
public class mapPin extends MovieClip
{

    public var spirit:String;
    public var callName:String;
    public var hotelName:String;
    public var city:String;
    public var s:String;
    public var zip:String;
    public var country:String;
    public var brand:String;
    public var featured:Boolean;
    public var horizon:Boolean;
    private var _mc1:MovieClip = new MovieClip();

    public function mapPin(_brand:String)
    {
        brand = _brand;
        switch (_brand)
        {
            case "Andaz":
                    pinCircle(0xff0000);
                    break;
            case "Grand Hyatt":
                    pinCircle(0x0000ff);
                    break;
            case "Hyatt":
                    pinCircle(0x4600f0);
                    break;
        }
    }

    private function pinCircle(color:uint):void
    {
        _mc1.graphics.beginFill(color);
        _mc1.graphics.drawCircle(0,0,20);
        this.addChild(_mc1);
        _mc1.graphics.endFill();
    }
}

} 
```

然后，我将 mapPin 类的几个实例添加到舞台上的容器影片剪辑中，并将事件侦听器添加到该容器剪辑中。

```
var myTest1:mapPin = new mapPin("Andaz");
myTest1.brand = "Andaz";
container_mc.addChild(myTest1);
myTest1.name = "myTest1" //this is added purely for testing the "instance xx", same result
myTest.x = 100;
myTest.y = 100;

var myTest2:mapPin = new mapPin("Hyatt");
container_mc.addChild(myTest2);
myTest2.brand = "Hyatt";
myTest2.x = 400;
myTest2.y = 400;

container_mc.addEventListener(MouseEvent.CLICK, pinClicked); 
```

最后，我试图能够访问被单击的 mapPin 的属性（迄今为止唯一的一组是“品牌”）。

```
function pinClicked(e:MouseEvent):void
{
    trace(e.target.name); // traces "instance xx" instead of "myTest1"
trace(e.target.brand); // traces "undefined"
} 
```

我可以添加 mapPin 实例，并调整它们的 x 和 y，尽管我无法引用自定义类属性（如“brand”）并且它们的名称变为通用实例名称。我错过了什么？将添加超过 500 个这样的项目，我希望能够根据用户的点击从它们中提取信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:20:25.960

我必须查看您的 mapPin 类才能确定，但​​我认为调度事件的 DisplayObject 是 mapPin 的子级。

要解决此问题，请在您的 mapPin 类构造函数中添加以下行：

```
mouseChildren = false; 
```

这将指定孩子不应该接收点击/调度鼠标事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T09:51:57.087

> currentTarget 是最近调度事件的对象，target 是最初调度它的对象

它不是。AS3 文档说：

> currentTarget ：使用事件侦听器主动处理 Event 对象的对象。例如，如果用户单击“确定”按钮，则当前目标可能是包含该按钮的节点或其已为该事件注册事件侦听器的祖先之一。
> 
> target ：事件目标。此属性包含目标节点。例如，如果用户单击确定按钮，则目标节点是包含该按钮的显示列表节点。

# android - Phonegap 构建或测试飞行

> ID：16092093
> 
> 赞同：1
> 
> 时间：2013-04-18T20:05:19.220
> 
> 标签：android, ios, testflight, phonegap-build

要求：

将与 Cordova 2.6 捆绑在一起的 Sencha Touch 2.1.1 应用程序部署到由 Android 和 iOS 混合组成的测试用户组。

iOS 需要使用 Ad Hoc 分发许可选项进行分发。

已将 Testflight 和 Phonegap Build 作为选项进行了研究。虽然看起来 Testflight 将满足我将我的应用程序分发给我的测试用户的需求，但看起来 Phonegap Build 也可能，但我对此一无所知，因为从他们的网站上不清楚。

有什么想法吗？这些服务的经验？我知道 iOS 是 2 平台中更难配置以进行部署的，尤其是对于多个用户。

# android - 如何将我自己的应用程序的 APK 文件保存在 sd 卡中并通过蓝牙共享？（仅通过使用代码和意图）

> ID：16092099
> 
> 赞同：1
> 
> 时间：2013-04-18T20:05:34.953
> 
> 标签：android, android-intent, bluetooth, apk, sd-card

在这里，在我的国家，无法访问 Google Play。我已经为我的人编写了一个免费的有用应用程序，在它发布几天后，我得出结论，让它更易于访问的最佳方法是**通过蓝牙共享它的 APK 文件** *（因为通过蓝牙共享文件在这里非常流行！）*

现在，问题是：

> **如何（通过代码）将正在运行的 APK 文件的副本保存在 sd 卡中，然后使用一些意图准备文件以通过蓝牙共享？**

不幸的是，我还没有尝试过任何代码，因为我根本不知道从哪里开始。因此，非常欢迎只是起点或一些提示！

**编辑：**我的一些用户更具技术性，并且知道他们可以使用**FileManager/Bluetoth Sharing 应用程序**将 APK 发送给他们的朋友，但我希望任何人都能够通过单击应用程序中的按钮来简单地共享应用程序，即使他们是新手或他们的设备上没有任何文件管理器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-15T00:39:04.840

如果您`ACTION_SEND` `Intent`使用应用程序的安装位置执行标准，并将其`Intent`明确定位到蓝牙，则可以执行此操作。你可以在这里看到如何：

[Android上的蓝牙文件传输（甚至限制类型）](https://stackoverflow.com/questions/16277593/bluetooth-file-transfer-on-androideven-restricted-types/21790899#21790899)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:14:59.533

在您的情况下，按代码似乎有点矫枉过正。也许只使用蓝牙上的文件/应用程序共享应用程序就足够了： http: [//www.guidingtech.com/10346/transfer-android-apps-between-phones-bluetooth/](http://www.guidingtech.com/10346/transfer-android-apps-between-phones-bluetooth/)

# c++ - 智能指针 - 如果构造函数抛出怎么办？

> ID：16092106
> 
> 赞同：2
> 
> 时间：2013-04-18T20:06:13.603
> 
> 标签：c++, constructor, auto-ptr

我有一个在构造函数中连接到 USB 设备的类。如果设备不存在或其他情况失败，则构造函数会抛出异常，调用代码会处理它。

类似于：

```
CDevice* pDevice = NULL;
try
{
    pDevice = new CDevice();
} 
```

等等。我想用一个替换这个调用，`auto_ptr`但我不清楚如何在保持对象的正确范围的同时捕获异常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:07:54.647

首先，我建议您不要使用`auto_ptr`，它有些损坏并且在 C++11 中已被弃用。更喜欢 Boost 或 C++11 SBRM 类，例如`std::unique_ptr`. 您可以在不对示例进行太多修改的情况下执行此操作。

```
std::unique_ptr<CDevice> pDevice;
try
{
    pDevice.reset(new CDevice());
}
catch(...)
{
    //....
} 
```

如果`new`或`CDevice`throws 的构造函数，则 pDevice 将保持为空。使用`auto_ptr`并没有太大的不同，只是考虑到可用的替代品，不推荐使用。

```
std::auto_ptr<CDevice> pDevice;

try
{
    pDevice.reset(new CDevice());

    //pDevice = std::auto_ptr<CDevice>(new CDevice());
    // ^^ historical masochism. 
}
catch(...)
{
    //....
} 
```

# jquery - Jquery template not accepting dash (-)

> ID：16092109
> 
> 赞同：0
> 
> 时间：2013-04-18T20:06:47.433
> 
> 标签：jquery, jquery-templates

I have following code. where i'm using the Jquery template but it is not accepting - (dash) in class-no. I'm getting an error `Uncaught ReferenceError: no is not defined`. Is there any solution for this issue with jquery template.

```
var json = [{"class-no":"12","marks":"500","marks1":"200","marks2":"300"},{"class-no":"11","marks":"200","marks1":"300","marks2":"400"}]

$.template('kList','<tr title="${class-no}"><td>${marks}</td><td>${marks1}</td><td>${marks2}</td></tr>');  

for(var i=0; i<json.length; i++){   
    $.tmpl('kList',json[i]).appendTo("#table1")
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T10:05:15.747

只需在模板调用时在选项参数中提供一个自定义函数，并将模板中的函数用作，

这`classNo`是一个自定义函数，它使用字符串表示法访问对象属性。

```
$.template('kList','<tr title="${$item.classNo()}"><td>${marks}</td><td>${marks1}</td><td>${marks2}</td></tr>');  

for(var i=0; i<json.length; i++){   
    $.tmpl('kList',json[i], { 
        classNo : function(){ 
            return this.data["class-no"];
        }
    }).appendTo("#table1");
} 
```

希望这可以帮助。

# c# - When publishing an ASP.NET MVC project in Visual Studio is it possible to delete all files except images?

> ID：16092112
> 
> 赞同：1
> 
> 时间：2013-04-18T20:06:56.403
> 
> 标签：c#, visual-studio-2012, publishing

I have an ASP.NET MVC4 project that I usually publish to the file system with the 'Delete all files prior to publish' option selected. However since the user can now upload assets (eg images) to this website and these assets would not be included in the csproj file, if I were to make a change to the binaries and publish the site then the user uploaded assets would vanish and I'd have a grumpy user or two.

Is there any way of modifying the Visual Studio 2012 publishing process to delete all files except specific types eg *.jpg, *.gif, *.pdf, *.xls?

Crispin

# performance - 在 MATLAB 中涉及矩阵值更新的向量化循环

> ID：16092113
> 
> 赞同：1
> 
> 时间：2013-04-18T20:07:04.393
> 
> 标签：performance, matlab, for-loop, dependencies, vectorization

`for`循环如下：

```
N = 2;T = 3;
Trials = rand(N,T);
for i=1:N
    for j=1:T
        AverageValue = mean2(Trials);
        Trials(i,j) = Trials(i,j) - AverageValue;
    end
end 
```

困难在于`AverageValue`根据每次更新来改变它的值`Trials`。

============================================

**将 'mean2' 替换为 'trapz' 的更新版本**：

```
N=4;T=5;
Trials=rand(N,T);
for i=1:N
    for j=1:T
        IntValue=trapz(trapz(Trials(1:3,2:5)));
        Trials(i,j)=Trials(i,j)+IntValue;
    end
end 
```

请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:41:11.647

以下代码将产生与您在帖子中的示例相同的输出：

```
 n = numel(Trials);
 Trials = Trials - mean2(Trials)*reshape(((n-1)/n).^(0:n-1), T, N)'; 
```

**解释**：通过观察递归减去每个当前均值所创建的模式`m`，形成以下形式的关系：

```
 m(k) = m(k-1) - m(k-1)/n = ((n-1)/n)*m(k-1); % symbolic 
```

因此，您可以使用嵌入式递归直接从原始矩阵中减去一个矩阵，即

```
[m(1) m(2) m(3);
 m(4) m(5) m(6)]; 
```

其中每个`m`都根据规则使用先前值的累积进行分析替换`m(k)= (((n-1)/n)^(k-1)*)m(1);`，其中`m(1)`是原始矩阵的平均值。

# css - Internet Explorer 9 和 10 中的 SVG 背景大小不同

> ID：16092114
> 
> 赞同：7
> 
> 时间：2013-04-18T20:07:10.077
> 
> 标签：css, svg, internet-explorer-9, internet-explorer-10

我一直在尝试使用 SVG 作为背景图像，以便使用`background-size`-property 对其进行缩放。这在大多数当前浏览器中都很好用，但 Internet Explorer 似乎误解了这些值，当我只使用一个值时，以更小的尺寸显示图像，而使用两个值的比例不正确。

我在[http://jsfiddle.net/c7DEw/1/上举了一个例子](http://jsfiddle.net/c7DEw/1/)

svg 的宽度和高度已设置为 100%。我认为它与`viewBox`and`enable-background`属性有关，但这些似乎没有任何影响。

这在 Internet Explorer 9 和 10 中都会发生。

有没有人遇到过这种行为？如果是这样，你是如何解决的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-06-06T20:57:22.047

我对 Illustrator 生成的用作背景图像的 svg 文件有类似的问题，经过反复试验，修复似乎只是编辑每个 svg 文件并将 svg 的宽度和高度声明为属性，例如`<svg width="32px" height="128px">`（ Illustrator 没有设置，但 Sketch 有）。这导致 svg 在 IE 10/11 中的行为与在 Chrome/FF 中的行为相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-10T09:46:27.563

我刚刚在另一个项目中再次遇到了这个问题。我将 Illustrator 设计中的资源单独复制到一个新文件中，并将画板更改为与其边界框完美对齐。然后我通过 CSS background-property 包含了 SVG，并注意到 IE10 和 IE11 中的显示尺寸都较小。

然后在 Illustrator 中重新打开资源，将它们复制到 Sketch 并将它们导出到 SVG 后，这种行为就消失了。

看起来 Illustrator 正在创建尺寸不正确的画板（或容器），从而导致尺寸不正确。但是我已经多次搜索这个问题并且没有发现其他人遇到这个问题，所以这可能是我做错了。但这个过程是如此简单，以至于我无法想象它会是什么。

# c# - 工作线程上的 ASP.NET 调用事件，需要更新处理程序中的 UI 元素

> ID：16092120
> 
> 赞同：0
> 
> 时间：2013-04-18T20:07:26.357
> 
> 标签：c#, asp.net, multithreading

我目前正在编写一个小后台工作者，它在线程完成执行时调用“WorkerFinished”事件。但问题是，我显然无法更新此事件处理程序中的任何 UI 元素。线程完成后，我需要在主 ASP 页面中启用一些按钮。

所以，我知道我不能像这样直接做到这一点，但我对如何解决这个问题一无所知。

以下是相关代码：

```
public void Start(Dictionary<string, object> args)
{
   m_thread = new Thread(() =>
        {
            m_progress = 0;
            DoWork.Invoke(ref m_progress, ref m_result, args);
            m_progress= 100;

            m_isDone= true;
            if( FinishedWork != null )
                 FinishedWork.Invoke(ref m_result, args); // Here goes
        });
        m_thread .Name = m_name;
        m_thread .IsBackground = true;
        m_thread .Start();
} 
```

因此，从此，我订阅了 ASP 页面上的**FinishedWork**事件，我需要再次启用“开始”按钮。

那么，有没有办法让我确保这个调用发生在 UI 线程上？

谢谢，奥文德。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:15:02.083

你不能。当您完成后台任务时，已经发送了对客户端的响应。没了。如果您尝试向客户端发送任何不是响应特定请求的信息，或者他们已经收到响应的请求，那么他们的防火墙肯定会阻止该传输。这与标准的网络模型完全相反。客户端发出请求，服务器发送响应，仅此而已。

该模型不是为客户端和服务器之间的双向通信而设计的，其中服务器可以随时向客户端发送数据。

*确实*存在支持这种双向通信的模型，但并非所有客户端都支持它。

另一种选择是让客户端不断地轮询服务器（可能是异步的）不断地询问它，“你完成了吗？”，“你完成了吗？”，“你完成了吗？” 这里的一般模型是异步任务将以全局状态的形式存储一些与它的进度有关的信息，以供将来的请求（即数据库、会话等）访问，并且来自客户端的频繁轮询请求将查看该状态. 这个模型的一个例子可以在[这里](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6/view/SourceCode)看到。请注意，在网络上不断轮询服务器以获取更新是非常耗费资源的，因此请注意如何使用此模式。

# css - 来自 Internet Explorer 的打印问题 - 并排列

> ID：16092125
> 
> 赞同：0
> 
> 时间：2013-04-18T20:07:47.953
> 
> 标签：css, printing, css-float

我有 2 个浮动列的设置 - 使用基于 bootstrap 2.0.3 的网格设置。

每列是宽度的 5/12。

在 Firefox 中 - 页面打印正确：2 列并排。在资源管理器（9 和 10）中 - 列显示正常，但用于打印 - 它们只是一个接一个，而不是并排。

我尝试将列设置为`display:inline`，也尝试添加`float: left`，但似乎没有任何帮助：

[小提琴链接： http](http://cssdesk.com/7vamd) ://cssdesk.com/7vamd

任何想法表示赞赏！谢谢

# c - 从堆栈变量定义具有大小的数组

> ID：16092130
> 
> 赞同：0
> 
> 时间：2013-04-18T20:07:55.423
> 
> 标签：c

这个让我难住了。如果我有一个结构：

```
struct MyType
{
  float *data;
} 
```

还有一个为数据分配一些内存的初始化函数：

```
void init(MyType *s, int length)
{
  s->data = (float *)malloc(length*sizeof(float));
} 
```

如果我使用 #define 声明一个 MyType 数组，它将按预期工作：

```
#define NUM_ELEMENTS 10
MyType myArr[NUM_ELEMENTS];
for (int i=0; i<NUM_ELEMENTS; i++)
{
  init(&myArr[i], 1000);
} 
```

但是，如果我使用堆栈上的变量声明数组，我会得到奇怪的行为：

```
int numElements = 10;
MyType myArr[numElements];
... 
```

如果不详细介绍我认为只会混淆事物的更多代码，很难解释这种行为是什么。我知道在#define 和堆栈变量之间来回更改决定了它是否有效，所以我怀疑问题出在某个地方。

我的问题是：我所做的一切都是合法的，它应该起作用还是我做的事情明显是错误的？我想使用堆栈变量，以便可以在运行时从配置值定义数组大小。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:17:46.200

从为时已晚的评论中：

> 实际上我正在使用带有-std = c ++ 0x的g ++。所以我猜这是C++

就是这样了。C++ 中不能有可变长度数组 (VLA)。这是 C99 的功能。

# kdb - 如何删除 kdb 分区表的内容？

> ID：16092132
> 
> 赞同：1
> 
> 时间：2013-04-18T20:08:07.730
> 
> 标签：kdb

我编写了 aq 脚本来创建一个分区表并从我之前保存的一个大型 kdb 文件中插入行。该脚本仅保存我从命令行传入的特定日期的数据。

如何在脚本开头清除分区表的内容？或者更一般地说，如果我多次运行脚本，如何确保表格内容不重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:46:33.290

假设您按日期分区，因此目录结构：

```
2012.04.03
          /trade
2012.04.04
          /trade
2012.04.05
          /trade
                /ticker
                /price
                /size 
```

1.  要清除某个日期的内容，只需删除该文件夹，然后`\l`.

2.  为防止重复检查该日期是否首先存在任何数据：

    `select count i from trade where date=2012.04.06`

如果一个日期数据可能来自不同的文件，那就更棘手了。您可能希望添加 sourceFile 列和/或作为单独的表来跟踪加载了哪些文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-28T11:30:12.263

您还可以将删除过程合并到 aq 函数中。假设您写的位置采用以下格式：

```
/hdb/date/tablename/colname

q) db1:"/hdb/date";    / you can pass this as a argument in a function

q) deletedb:{[dbname] systemcmd: "rm -rfv ",dbdelete; system systemcmd}

q) deletedb db1 
```

# .net - OleDbDataReader 结果直接到数组

> ID：16092135
> 
> 赞同：1
> 
> 时间：2013-04-18T20:08:15.737
> 
> 标签：.net, vb.net

目前，我创建了一个允许用户输入 SQL 代码的类，然后该类将结果返回到他们可以进一步使用的数组中。大多数方法使用循环将数据从 OleDbDataReader 对象传输到数组。在处理大量项目时，这可能会非常慢。

当前方法：

```
Dim SQLdr As OleDbDataReader  'SQL reader
Dim SQLCmd As New OleDbCommand() 'The SQL Command
Dim firstline As Boolean
SQLCmd.Connection = SQLConn 'Sets the Connection to use with the SQL Command
SQLCmd.CommandText = SQLStr 'Sets the SQL String
SQLdr = SQLCmd.ExecuteReader 'Gets Data 
```

然后后来..

```
While (SQLdr.Read)
  If firstline = True Then
    'fill headers
    Do Until j = SQLdr.FieldCount
      result(j, i) = SQLdr.GetName(j)
      j = j + 1
    Loop
    firstline = False
    j = 0
    i = 1
  End If

  j = 0
  Do Until j = SQLdr.FieldCount
    ReDim Preserve result(result.GetUpperBound(0), result.GetUpperBound(1) + 1)
    If display = True Then
      MsgBox(j & ":" & i & SQLdr(j).ToString)
    End If
    result(j, i) = SQLdr(j).ToString
    j = j + 1
  Loop

  i = i + 1
End While 
```

我想知道是否有更直接的方法将结果输出到数组中。我很抱歉，但我不知道从哪里开始，如果有可能，或者是否有人尝试过前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:19:56.310

这真的是 VB.NET 吗？但是，您不应该使用它`ReDim Preserve`来调整数组的大小。而是使用泛型`List`及其`Add`方法。您还应该为您的数据使用自定义类，以提高可读性，使其更易于重用且不易出错。当您不在`Object`任何地方使用时，它也会更快，因为它不需要装箱/拆箱。

这是一个示例，`List(Of User)`其中 where`Ùser`是具有两个属性的自定义类。

```
Dim users = New List(Of User)
Using con = New OleDb.OleDbConnection(connectionString)
    Using cmd = New OleDb.OleDbCommand("SELECT UserID, UserName FROM dbo.User ORDER BY UserName", con)
        con.Open()
        Using rdr = cmd.ExecuteReader()
            While rdr.Read()
                Dim user = New User()
                user.UserID = rdr.GetInt32(0)
                user.UserName = rdr.GetString(1)
                users.Add(user)
            End While
        End Using
    End Using
End Using 
```

这里是简单的类：

```
Class User
    Public Property UserID As Int32
    Public Property UserName As String
End Class 
```

如果你想让你的代码保持动态，你也可以使用 a`DataAdapter`来填充`DataTable`/ `DataSet`。这将简化代码批次，也将更有效率。

```
Dim table = New DataTable()
Using con = New OleDb.OleDbConnection(connectionString)
    Using da = New OleDb.OleDbDataAdapter("SELECT UserID, UserName FROM dbo.User ORDER BY UserName", con)
        da.Fill(table)
    End Using
End Using 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T15:13:33.837

感谢史蒂夫最初为我指明了正确的方向，也感谢蒂姆。我在这里搜索并找到了解决方案：

[http://www.vbforums.com/showthread.php?381224-Filling-a-DataTable-using-a-DataReader](http://www.vbforums.com/showthread.php?381224-Filling-a-DataTable-using-a-DataReader)

我使用了稍微修改过的方法，因此它包括标题，并且像我之前所做的那样将它作为数组输出。

对于将来的任何人，这里是我完成的代码，它运行 TON 更快地加载结果：

```
 load_sql(username_, password_, conn_string)

    If SQLConn.State = ConnectionState.Open Then
        Dim myDataTable As New DataTable
        Try
            Using con As New Odbc.OdbcConnection(conn_string)
                ' Dim command As New Odbc.OdbcCommand(SQLConn, con)
                Dim SQLCmd As New OleDbCommand()
                SQLCmd.Connection = SQLConn 'Sets the Connection to use with the SQL Command
                SQLCmd.CommandText = SQLStr 'Sets the SQL String
                Using dr As OleDbDataReader = SQLCmd.ExecuteReader
                    myDataTable.Load(dr)
                End Using
            End Using
        Catch ex As Exception
            myDataTable = Nothing
        End Try

        Dim total_rows As Integer
        Dim total_columns As Integer
        total_rows = myDataTable.Rows.Count
        total_columns = myDataTable.Columns.Count
        Dim result(total_columns, total_rows) As String
        Dim i As Integer = 0
        Dim j As Integer = 0
        Do Until j = total_columns 'add column headers first
            result(j, 0) = myDataTable.Columns(j).Caption
            j = j + 1
        Loop

        Do Until i = total_rows 'load data to array
            RaiseEvent progress(i, total_rows)
            j = 0
            Do Until j = total_columns
                result(j, i + 1) = myDataTable.Rows(i)(j)
                j = j + 1
            Loop

            i = i + 1
        Loop
        RaiseEvent progress(total_rows, total_rows)
        RaiseEvent query_finished(result, queryindex) 'display results

    End If 
```

# linux - Mutt不会发送附件

> ID：16092140
> 
> 赞同：3
> 
> 时间：2013-04-18T20:08:50.060
> 
> 标签：linux, bash, shell, email, mutt

浏览了一些示例，我显然做错了什么，因为它们都不适合我。我可以发送一封带有文本的简单电子邮件，但是当我尝试发送附件时，它显示“找不到文件”。我从文件所在的文件夹中运行这些语句：

```
echo -e "This is the body" | mutt -a /home/adrian/Backups/Server1/MyFile-2013-04-17.zip myEmail@gmail.com -s "This is the subject"

echo -e "This is the body" | mutt -a MyFile-2013-04-17.zip myEmail@gmail.com -s "This is the subject" 
```

可以发送的文件类型或路径语法是否有任何先决条件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:42:32.660

尝试这个..

```
echo -e "This is the body" | mutt -a "/home/adrian/Backups/Server1/MyFile-2013-04-17.zip" -s "This is the subject" -- myEmail@gmail.com 
```

# java - 还有什么可以在java中抛出ClassCastException？

> ID：16092141
> 
> 赞同：60
> 
> 时间：2013-04-18T20:08:51.010
> 
> 标签：java, caching, classcastexception

这是一道面试题。

面试结束了，但这个问题还在我的脑海里。

我不能问面试官，因为我没有得到这份工作。

**设想：**

*   将 C1 类的对象放入带有键“a”的缓存中

**后期代码：**

`C1 c1FromCache = (C1) cache.get("a");`

此代码引发 ClassCastException。

**原因可能是什么？**

我说是因为其他人用相同的键*放置*了另一个对象，所以覆盖了它。我被告知没有，想想其他可能性。

我说可能定义类 C1 的 jar 在此节点上不可用（不确定这是否会导致类强制转换或 ClassNotFoundException，但我现在正在寻找任何线索。然后我说可能是错误的类版本？他们说所有节点中都存在相同的 C1 类 jar）。

**编辑/添加**询问 get 是否抛出 ClassCast 但被告知没有。之后我告诉他我解决此类问题的措施是放入一个测试 jsp，该 jsp 将模仿这些操作并在异常之后放置更好的日志记录（堆栈跟踪）。这是问题的第二部分（如果在生产中发生这种情况，为什么以及你会怎么做）

*还有其他人对为什么缓存获取*会导致强制转换问题有任何想法吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-04-18T20:15:59.360

一个原因可能是插入对象的代码部分使用的类加载器与检索它的代码不同。
不能将类的实例强制转换为由不同类加载器加载的同一类。

**对编辑的回应：**

> 如果在生产中发生这种情况，你会怎么做？

这通常发生在读取和插入模块都包含相同的 jar 包时`C1`。
由于大多数容器首先尝试父类加载器，然后是本地类加载器（*Parent first*策略），因此解决问题的常见方法是加载与插入和读取模块最近的公共父级中的类。
如果将包含`C1`该类的模块移动到父模块，则强制两个子模块从父模块获取该类，从而消除任何类加载器差异。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-04-21T04:10:57.103

`ClassCastException`如果同一个类被多个不同的类加载器加载并且类的实例在它们之间共享，则可能会发生这种情况。

考虑以下示例层次结构。

```
SystemClassloader <--- AppClassloader <--+--- Classloader1
                                         |
                                         +--- Classloader2 
```

我认为总的来说以下是正确的，但可以编写偏离此的自定义类加载器。

*   SystemClassloader 加载的类的实例可以在任何类加载器上下文中访问。
*   AppClassloader 加载的类的实例可以在任何类加载器上下文中访问。
*   Classloader1 加载的类的实例不能被 Classloader2 访问。
*   Classloader2 加载的类的实例不能被 Classloader1 访问。

如前所述，发生这种情况的常见场景是 Web 应用程序部署，一般来说 AppClassloader 非常类似于在应用程序服务器中配置的类路径，然后 Classloader1 和 Classloader2 代表单独部署的 Web 应用程序的类路径。

如果多个 Web 应用程序部署相同的 JAR/类，那么`ClassCastException`如果 Web 应用程序有任何机制可以共享对象（例如缓存或共享会话），则可能会发生这种情况。

另一种可能发生这种情况的类似情况是，如果类由 Web 应用程序加载，并且这些类的实例存储在用户会话或缓存中。如果重新部署 Web 应用程序，则这些类将由新的类加载器重新加载，并且尝试从会话或缓存访问对象将引发此异常。

在生产环境中避免此问题的一种方法是将 JAR 在类加载器层次结构中向上移动。因此，与其在每个 Web 应用程序中包含相同的 JAR，不如将它们包含在应用程序服务器的类路径中可能会更好。通过这样做，类只加载一次，并且可供所有 Web 应用程序访问。

避免这种情况的另一种方法是仅对共享对象的接口进行操作。然后需要在类加载器层次结构中将接口加载到更高的位置，但类本身不需要。您从缓存中获取对象的示例将是相同的，但`C1`该类将替换为`C1`实现的接口。

下面是一些可以独立运行以重新创建此场景的示例代码。它不是最简洁的，当然可能有更好的方法来说明它，但由于上述原因，它确实抛出了异常。

在`a.jar`包以下两个类，`A`和`MyRunnable`. 它们由两个独立的类加载器多次加载。

```
package classloadertest;

public class A {
    private String value;

    public A(String value) {
        this.value = value;
    }

    @Override
    public String toString() {
        return "<A value=\"" + value + "\">";
    }
} 
```

和

```
package classloadertest;

import java.util.concurrent.ConcurrentHashMap;

public class MyRunnable implements Runnable {
    private ConcurrentHashMap<String, Object> cache;
    private String name;

    public MyRunnable(String name, ConcurrentHashMap<String, Object> cache) {
        this.name = name;
        this.cache = cache;
    }

    @Override
    public void run() {
        System.out.println("Run " + name + ": running");

        // Set the object in the cache
        A a = new A(name);
        cache.putIfAbsent("key", a);

        // Read the object from the cache which may be differed from above if it had already been set.
        A cached = (A) cache.get("key");
        System.out.println("Run " + name + ": cache[\"key\"] = " + cached.toString());
    }
} 
```

独立于上述类运行以下程序。它不能与上述类共享一个类路径，以确保它们是从 JAR 文件中加载的。

```
package classloadertest;
import java.io.File;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.concurrent.ConcurrentHashMap;

public class Main {
    public static void run(String name, ConcurrentHashMap<String, Object> cache) throws Exception {
        // Create a classloader using a.jar as the classpath.
        URLClassLoader classloader = URLClassLoader.newInstance(new URL[] { new File("a.jar").toURI().toURL() });

        // Instantiate MyRunnable from within a.jar and call its run() method.
        Class<?> c = classloader.loadClass("classloadertest.MyRunnable");
        Runnable r = (Runnable)c.getConstructor(String.class, ConcurrentHashMap.class).newInstance(name, cache);
        r.run();
    }

    public static void main(String[] args) throws Exception {
        // Create a shared cache.
        ConcurrentHashMap<String, Object> cache = new ConcurrentHashMap<String, Object>();

        run("1", cache);
        run("2", cache);
    }
} 
```

运行时会显示以下输出：

```
Run 1: running
Run 1: cache["key"] = <A value="1">
Run 2: running
Exception in thread "main" java.lang.ClassCastException: classloadertest.A cannot be cast to classloadertest.A
        at classloadertest.MyRunnable.run(MyRunnable.java:23)
        at classloadertest.Main.run(Main.java:16)
        at classloadertest.Main.main(Main.java:24) 
```

我也将源代码放在了[GitHub 上](https://github.com/edplese/classloader-test)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-21T20:21:28.613

最后，有人破解了`String` `intern`表的字符串`"a"`。

[在此处](http://www.artima.com/forums/flat.jsp?forum=106&thread=4864)查看如何完成的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-21T05:01:20.100

好吧，也许是因为 C1 是一个抽象类，并且 get 函数还返回在返回之前被强制转换为 C1 的对象（当然是 C1 的子类）？

# c++ - 共享内存和写入时复制或右值引用以及移动语义？

> ID：16092143
> 
> 赞同：8
> 
> 时间：2013-04-18T20:08:51.713
> 
> 标签：c++, containers, shared-memory, rvalue-reference, copy-on-write

通用容器（如 Qt 容器中的容器）的共享内存/写入时复制是否被 C++11 移动语义和右值引用所取代？

一个失败，另一个成功？或者它们是互补的而不是替代的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T21:52:05.770

写入时复制和移动语义都已用于优化将数据保存在堆上的对象的值语义。 `std::string`，例如已实现为写入时复制对象和启用移动的对象。

所以写时复制和移动语义在这方面是相似的：如果你足够松散地定义“复制”，它们都可以用来优化“复制”。我有时将移动语义描述为写时复制，引用计数被限制为 0 或 1，因此包含引用计数的字段被优化掉了。

std::lib 中的所有容器现在都使用移动语义，甚至`std::string`以前被允许使用写时复制的容器现在被禁止这样做。如果我今天要编写一个新的客户容器，我会在选择写时复制之前使用移动语义。

在 C++11 中仍然可以使用写时复制。如果您希望您的数据结构很少被写入，但经常被复制，并且许多客户持有相同值的副本，那么写时复制仍然是一个巨大的胜利。

例如，我已经看到写时复制很好地用于保存复杂文档的撤消列表。在任何给定的提交（您想要保存状态的地方），自上次提交以来，只有一小部分大文档发生了变化。因此，制作文档副本以保存其状态意味着更新一堆引用计数，并实际对一小部分进行更改（写入时复制样式）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-18T20:16:23.880

Copy-on-write 和 move 语义是完全不同的概念，每个都有不同的目的。虽然有一个常见的用例：从函数返回一个对象，其中*由于原始对象超出范围*，它实际上是一个移动，但在一般情况下，它们有所不同：

通过写入时复制，多个同时处于活动状态的对象可以*共享*内容。使用移动语义，只有一个对象具有特定时间点的内容。

与此有点正交，写时复制在多线程环境中存在问题，因为可能有多个对象访问相同的数据（只读）和控制块（读/写），这需要以线程安全的方式进行管理.

# html - Html 表单动作；是否将 HTML 标记添加到 url 页面？

> ID：16092144
> 
> 赞同：0
> 
> 时间：2013-04-18T20:08:53.703
> 
> 标签：html, tags

您知道如何在 HTML 中使用输入表单指定操作：

```
<form action="example.php" method="get">
First name: <input type="text" name="fname"><br>
Last name: <input type="text" name="lname"><br>
<input type="submit" value="Submit">
</form> 
```

提交表单时，它将链接到 example.php。我的问题是，生成的网页是否添加了 html 标签，如下所示：

```
<html>
<body>
example.php
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:19:57.257

如果您使用 ajax 解决方案（例如 jquery 库），您可以编写 php，使其仅返回您想要放在调用网页上的代码，使用 div 容器接收并显示返回的内容。

否则，您的 php 脚本必须返回带有各种开始和结束标记的完整 html 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:14:50.543

正如您已经说过的，它只是重定向到给定的页面（不添加 HTML），在 URL 中传递 post/get 变量。因此，通过在 URL 中提交，您将拥有以下内容：

```
example.php?fname=Name&lname=LastName 
```

这用于由`$_GET[]`或`$_POST[]`PHP 方法进行进一步处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:12:13.123

您可以通过 GET 和 POST 变量从 example.php 访问您的表单元素。例子：

$fname = $_GET['fname']; $lname = $_GET['lname'];

# django - Django、apache2、css 未显示...可能需要身份验证？

> ID：16092148
> 
> 赞同：1
> 
> 时间：2013-04-18T20:09:05.187
> 
> 标签：django, apache2, centos

运行 CentOS 6.4、Apache 2.2.15、Django 1.5。

```
User nobody
Group nobody

LoadModule wsgi_module /usr/lib64/httpd/modules/mod_wsgi.so
LoadModule alias_module modules/mod_alias.so
LoadModule authz_host_module modules/mod_authz_host.so
WSGIDaemonProcess project python-path=/var/www/project/
WSGIScriptAlias / /path/to/wsgi.py
WSGISocketPrefix run/wsgi

ErrorLog logs/error_log

Listen 80

Alias /static/ /path/to/static/

<Directory /static>
        Satisfy Any
        Allow from all
</Directory>

<Directory /path/to/wsgi.py>
        <Files wsgi.py>
                Order deny,allow
                Allow from all
        </Files>
</Directory>

<Location ~ "/path/to/project/(css/*|images/*|style/*|js/*|)">
    Satisfy Any
    Allow from all
    AuthType None
    Require all granted
</Location> 
```

我已阅读以下 SO 问题和回复，但我仍然收到“未加载样式表，因为它的 MIME 类型“text/plain”不是“text/css”。我在 HTML 文件中的引用指定“文本/css”：

[Apache Config - 从身份验证中排除位置](https://stackoverflow.com/questions/13146455/apache-config-exclude-location-from-authentication)

[css 未加载，因为它的 MIME 类型“text/html”不是“text/css”。](https://stackoverflow.com/questions/6915338/css-was-not-loaded-because-its-mime-type-text-html-is-not-text-css)（我实际上无法让它工作。我遇到了各种语法错误）。

我不知道还能尝试什么。我猜测我的 httpd 配置文件中的某些内容不正确，但它是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:23:21.453

该错误不是来自 HTML，而是来自 Apache 告诉您的客户端它所服务的文件是 text/plain 类型（在 HTTP 响应标头中）。您需要告诉 Apache 如何确定它所服务的文件的 MIME 类型。

您应该将这些指令添加到您的 httpd 配置中（在其他`LoadModule`指令之后的顶部应该没问题）：

```
LoadModule mime_module modules/mod_mime.so
TypesConfig /etc/mime.types 
```

更多细节：[http ://httpd.apache.org/docs/2.2/mod/mod_mime.html#typesconfig](http://httpd.apache.org/docs/2.2/mod/mod_mime.html#typesconfig)

# javascript - 浏览器显示区域的javascript jquery位置

> ID：16092149
> 
> 赞同：-2
> 
> 时间：2013-04-18T20:09:08.213
> 
> 标签：javascript, browser, viewport

无论滚动位置如何，我都需要将一个对象放置在浏览器视口的顶部。对象有 offsetTop。视口的函数或对象名称是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:12:35.273

有css属性：

```
position: fixed; 
```

这是你要找的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:24:12.833

使用 css 而不是 JavaScript。给元素添加一个固定的类或者在元素上使用css。

```
.fixed { position: fixed; } 
```

或者

```
.myElement { position: fixed; } 
```

您还可以使用此 jquery 将固定类动态添加到元素

```
$('.myElement').addClass('fixed'); 
```

# facebook - 打开图表得分墙帖子显示不正确的应用名称

> ID：16092152
> 
> 赞同：0
> 
> 时间：2013-04-18T20:09:10.643
> 
> 标签：facebook, actionscript-3, facebook-graph-api, facebook-opengraph

我有 Facebook 分数发布工作（/userid/scores 带有分数和应用访问令牌），但是当它发布在新闻提要中时，它显示的应用名称不正确： ![应用名称不正确](https://i.stack.imgur.com/WjhBv.png)

![错误的应用名称 2](https://i.stack.imgur.com/zZPwa.png)

如您所见，应用名称为“Rockstar Rising”，但在帖子中显示为“主唱”。我能想到的唯一地方是“歌手”来自我们的一个开放图形对象，乐队成员。

我尝试了许多不同的搜索，但没有找到可能导致此问题的原因。我检查了我们的应用程序设置和代码，看看它是否来自那里，但一切看起来都很好。这可能是缓存问题还是其他原因？

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:51:33.517

您好确保您在调用 init 时使用了正确的应用程序 ID，还检查 OpenGraph 对象，然后使用 lint 工具对其进行测试，这可能是 facebook 的缓存问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T15:51:20.923

这个问题最终解决了自己。我不确定如何，但当我们的游戏被批准用于应用中心时，它可能会发生。如果有人遇到这个问题，我也会看看[如何强制 Facebook 清除其缓存并使用共享网页的更新元描述？](https://stackoverflow.com/questions/9026448/how-can-i-force-facebook-to-purge-its-cache-and-use-newer-meta-description-of-a)

# python - 查找过程如何在python中工作

> ID：16092153
> 
> 赞同：3
> 
> 时间：2013-04-18T20:09:11.477
> 
> 标签：python

我希望自己创建一个“查找”程序**，**它能够在字符串中查找子字符串，并且它还应该能够向后读取字符串并给出匹配的位置——就像 python 中的原始查找函数一样。

我无法弄清楚我应该使用什么逻辑 - 我也不知道原来的 find 功能如何？

我刚开始使用 python，对编程也很陌生。

任何指导将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:34:25.283

> 我也不知道原来的 find 功能如何

无需谷歌搜索即可了解函数的一个好方法是使用[Ipython](http://ipython.org/)，尤其是[notebook 变体](http://ipython.org/notebook.html/)。这些允许您以交互方式编写 python 代码，并具有一些特殊功能。在 Ipython（笔记本或解释器）中用问号键入函数的名称会返回有关该函数的一些信息，例如

```
find?

Type:       function
String Form:<function find at 0x2893cf8>
File:       /usr/lib/pymodules/python2.7/matplotlib/mlab.py
Definition: find(condition)
Docstring:  Return the indices where ravel(condition) is true 
```

输入两个问号显示源代码

```
find??

Type:       function
String Form:<function find at 0x2893cf8>
File:       /usr/lib/pymodules/python2.7/matplotlib/mlab.py
Definition: find(condition)
Source:
def find(condition):
    "Return the indices where ravel(condition) is true"
    res, = np.nonzero(np.ravel(condition))
    return res 
```

然后，您需要进一步深入兔子洞，以确切了解 find 的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:19:09.317

这个问题有一个简单的解决方案，但也有更快的解决方案，您可能希望在实现简单版本后查看这些解决方案。您要做的是检查您正在搜索的字符串中的每个位置，并查看您正在搜索的字符串是否从那里开始。这是低效的，但对于大多数用途来说效果很好，如果您对此感到满意，那么您可能需要查看 Boyer-Moore 字符串搜索，这是一个更复杂但更有效的解决方案。它利用了这样一个事实，即您可以确定如果字符串不是从某个点开始，您可能不需要检查其他一些位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T21:38:41.907

我认为[史蒂夫](https://stackoverflow.com/a/16092297/1258041)的意思是这样的：

```
def find(s, sub):
    for i, _ in enumerate(s):
        if s.startswith(sub, i):
            return i
    return -1

def rfind(s, sub):
    for i in range(len(s)-1, -1, -1):
        if s.startswith(sub, i):
            return i
    return -1 
```

但是，这比常规更简单`str.find`，`str.rfind`因为您不能提供`start`和`end`参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T20:47:18.380

这是一个返回列表中所有提示的解决方案，并`rfind`使用 original`find`关键字定义`backwards`。您也可以用于整数或浮点数。您可以轻松修改它以仅返回第一个提示。

```
def find( x, string, backward = False, ignore_case = False ):
    x      = str(x)
    string = str(string)
    if ignore_case:
        x = x.lower()
        string = string.lower()
    str_list = [ i for i in string ]
    x_list   = [ i for i in x      ]
    if backward:
        x_list.reverse()
        str_list.reverse()
    x = ''.join(x_list)
    string = ''.join(str_list)
    lenx = len(x)
    ans = []
    for i in range( len(str_list) - lenx ):
        if x == string[i:i+lenx]:
            ans.append( i )
    return ans

def rfind( x, string, ignore_case = False):
    return find( x, string, backward = True, ignore_case = ignore_case )

print  find('f','abcdefgacdfh')
# [5, 10]
print rfind('f','abcdefgacdfh')
# [1, 6]
print  find(12,'aaa3331222aa12a')
# [6, 12]
print rfind(12,'aaa3331222aa12a')
# [1, 7] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T21:45:08.537

```
'mystring'.rindex('my_substring') 
```

这将返回子字符串的第一个位置，从右侧开始

```
'mystring'.index('my_substring') 
```

做同样的事情，但从左侧开始搜索字符串。

# php - PHP Facebook 使用 Mysql 登录

> ID：16092156
> 
> 赞同：1
> 
> 时间：2013-04-18T20:09:33.267
> 
> 标签：php, facebook, api

我正在尝试创建一个带有 facebook 登录按钮的网站，我尝试使用 php sdk，但我遇到了一个问题：当我登录时，会话没有保存，所以它没有找到它，所以它的行为就像它没有设置一样。

```
<?php
if(!isset($_SESSION['user']))
{
    //Application Configurations
    $app_id     = "MY_API_KEY_HERE";
    $app_secret = "MY_SECRET_KEY_HERE";
    $site_url   = "http://localhost/";

    try{
        include_once "src/facebook.php";
    }catch(Exception $e){
        error_log($e);
    }
    // Create our application instance
    $facebook = new Facebook(array(
        'appId'     => $app_id,
        'secret'    => $app_secret,
        ));

    // Get User ID
    $user = $facebook->getUser();
    // We may or may not have this data based 
    // on whether the user is logged in.
    // If we have a $user id here, it means we know 
    // the user is logged into
    // Facebook, but we don’t know if the access token is valid. An access
    // token is invalid if the user logged out of Facebook.
    //print_r($user);
    if($user){
        // Get logout URL
        $logoutUrl = $facebook->getLogoutUrl();
    }else{
        // Get login URL
        $loginUrl = $facebook->getLoginUrl(array(
            'scope'         => 'read_stream, publish_stream, email, user_about_me',
            'redirect_uri'  => $site_url,
            ));
    }

    if($user){

        try{
        // Proceed knowing you have a logged in user who's authenticated.
        $user_profile = $facebook->api('/me');
        //Connecting to the database. You would need to make the required changes in the common.php file
        //In the common.php file you would need to add your Hostname, username, password and database name!
        mysqlc();

        $name = GetSQLValueString($user_profile['name'], "text");
        $email = GetSQLValueString($user_profile['email'], "text");
        $gender = GetSQLValueString($user_profile['gender'], "text");
        $bio = GetSQLValueString($user_profile['bio'], "text");
        $query = sprintf("SELECT * FROM newmember WHERE email = %s",$email);
        $res = mysql_query($query) or die('Query failed: ' . mysql_error() . "<br />\n$sql");
        if(mysql_num_rows($res) == 0)
        {
            $iquery = sprintf("INSERT INTO newmember values('',%s,%s,%s,%s,'yes')",$name,$email,$gender,$bio);
            $ires = mysql_query($iquery) or die('Query failed: ' . mysql_error() . "<br />\n$sql");
            $_SESSION['user'] = $user_profile['email'];
            $_SESSION['id'] = $user_profile['id'];
        }
        else
        {
            $row = mysql_fetch_array($res);
            $_SESSION['user'] = $row['email'];
            $_SESSION['id'] = $user_profile['id'];
        }
        }catch(FacebookApiException $e){
                error_log($e);
                $user = NULL;
            }

    }
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-11T05:18:31.677

Facebook 集成和登录，[PHP Facebook 登录和集成在 PHP](https://www.studytutorial.in/php-facebook-login-and-integration-in-php-website-tutorial)中，详细解释并从这里下载 Facebook SDK。

```
<?php
session_start();
// Include the autoloader provided in the SDK
require_once __DIR__ . '/facebook-php-sdk/autoload.php';

// Include required libraries
use Facebook\Facebook;
use Facebook\Exceptions\FacebookResponseException;
use Facebook\Exceptions\FacebookSDKException;

$appId = 'YOUR APP ID'; //Facebook App ID
$appSecret = 'YOUR APP SECRET KEY'; //Facebook App Secret
$redirectURL = 'YOUR CALLBACK URL'; //Callback URL
$fbPermissions = array('email');  //Optional permissions

$fb = new Facebook(array(
    'app_id' => $appId,
    'app_secret' => $appSecret,
    'default_graph_version' => 'v2.9',
        ));

// Get redirect login helper
$helper = $fb->getRedirectLoginHelper();

// Try to get access token
try {
    // Already login
    if (isset($_SESSION['facebook_access_token'])) {
        $accessToken = $_SESSION['facebook_access_token'];
    } else {
        $accessToken = $helper->getAccessToken();
    }

    if (isset($accessToken)) {
        if (isset($_SESSION['facebook_access_token'])) {
            $fb->setDefaultAccessToken($_SESSION['facebook_access_token']);
        } else {
            // Put short-lived access token in session
            $_SESSION['facebook_access_token'] = (string) $accessToken;

            // OAuth 2.0 client handler helps to manage access tokens
            $oAuth2Client = $fb->getOAuth2Client();

            // Exchanges a short-lived access token for a long-lived one
            $longLivedAccessToken = $oAuth2Client->getLongLivedAccessToken($_SESSION['facebook_access_token']);
            $_SESSION['facebook_access_token'] = (string) $longLivedAccessToken;

            // Set default access token to be used in script
            $fb->setDefaultAccessToken($_SESSION['facebook_access_token']);
        }

        // Redirect the user back to the same page if url has "code" parameter in query string
        if (isset($_GET['code'])) {

            // Getting user facebook profile info
            try {
                $profileRequest = $fb->get('/me?fields=name,first_name,last_name,email,link,gender,locale,picture');
                $fbUserProfile = $profileRequest->getGraphNode()->asArray();
                // Here you can redirect to your Home Page.
                echo "<pre/>";
                print_r($fbUserProfile);
            } catch (FacebookResponseException $e) {
                echo 'Graph returned an error: ' . $e->getMessage();
                session_destroy();
                // Redirect user back to app login page
                header("Location: ./");
                exit;
            } catch (FacebookSDKException $e) {
                echo 'Facebook SDK returned an error: ' . $e->getMessage();
                exit;
            }
        }
    } else {
        // Get login url

        $loginURL = $helper->getLoginUrl($redirectURL, $fbPermissions);
        header("Location: " . $loginURL);

    }
} catch (FacebookResponseException $e) {
    echo 'Graph returned an error: ' . $e->getMessage();
    exit;
} catch (FacebookSDKException $e) {
    echo 'Facebook SDK returned an error: ' . $e->getMessage();
    exit;
}
?> 
```

# matlab - 在 MATLAB 中的网格图上添加节点号

> ID：16092161
> 
> 赞同：0
> 
> 时间：2013-04-18T20:10:02.170
> 
> 标签：matlab, nodes

我的脚本使用以下方法绘制网格：

```
gplot(adj,NC,'-o') 
```

其中“adj”是邻接矩阵，“NC”是节点坐标的矩阵。它工作得非常好，只是它没有在图表上显示节点的编号。

例如，对于这样的网格：

![](https://i.stack.imgur.com/owydF.png)

我需要节点的编号出现在图表上，节点坐标矩阵由下式给出：

```
NC =
      0         0
      0         8.455
      0         16.91
      17.385    0
      17.385    8.455
      17.385    16.91
      34.77     0
      34.77     8.455
      34.77     16.91 
```

该脚本还提供了节点编号矩阵，在本示例中如下所示：

```
A =
     1     4     7
     2     5     8
     3     6     9 
```

节点的数量也可以表示为范围 k=1:M，其中 M 是已知的

我相信可以使用上述矩阵将节点的编号添加到图中，但我不知道如何。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:29:24.730

无论如何，我已经解决了这个问题，如果有人感兴趣，这里是代码：

```
p=Nw/Ne;
g=Nh/Ne;
for u=1:M1
h=text(NC(u,1)+p,NC(u,2)+g,num2str(u,'%d'));
set(h,'Color',[0 0 1])
end 
```

p 和 g 是偏移量，它们会有所不同，因为节点的数量取决于用户的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T12:16:06.103

您必须手动设置标签`text()`：

```
offsetx = 0.5;
offsety = -0.5;
labels  = arrayfun(@(x,y) sprintf('x: %5.2f\ny: %5.2f',x,y), NC(:,1),NC(:,2),'un',0);
labels2 = arrayfun(@(x,y) sprintf('(%g, %g)',x,y), NC(:,1),NC(:,2),'un',0);

text(NC(:,1)+offsetx, NC(:,2)+offsety,labels2) 
```

使用偏移量（您也可以为每个点定义特定的偏移量）和格式（使用`labels`，`labels2`或您自己的）玩一点。

**编辑**处理评论

您可以使用矩阵`A`来创建标签，并且`offsetx`,`offsety`可以是与长度相同的向量`NC(:,1)`

```
labels = arrayfun(@(x) sprintf('%d',x),A(end:-1:1,:),'un',0);
text(NC(:,1)+offsetx, NC(:,2)+offsety,labels(:)) 
```

# css - 摆脱表格边框 - 用户代理正在覆盖样式表

> ID：16092162
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:10:02.873
> 
> 标签：css, border, css-tables

我已经阅读了此链接[什么是用户代理样式表](https://stackoverflow.com/questions/12582624/what-is-user-agent-stylesheet) ，并且我尝试将整个规则复制到站点的样式表中，但没有成功。我试过给表本身一个类并写一个规则。我尝试过border:none，并且尝试过制作边框颜色`#fff`。

显然，我错过了显而易见的事情。

该页面是[http://www.outreachnc.com/rack-locations/](http://www.outreachnc.com/rack-locations/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:14:18.733

这就是你应该使用 firebug 的原因

```
.art-article th, .art-article td - Line 846 
```

消除`border: 1px solid #B8B8B8;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:18:26.937

TD有一个规则。是的，我错过了显而易见的事情。

# csv - 使用 awk 按名称提取 CSV 字段

> ID：16092167
> 
> 赞同：5
> 
> 时间：2013-04-18T20:10:18.623
> 
> 标签：csv, awk, gawk

假设我有一个 CSV 文件，其标题格式如下：

```
Field1,Field2
3,262000
4,449000
5,650000
6,853000
7,1061000
8,1263000
9,1473000
10,1683000
11,1893000 
```

**我想编写一个 awk 脚本，该脚本将采用逗号分隔的字段名称列表`target`，将其拆分为一个数组，然后仅挑选出具有我指定名称的那些列。**

这是我到目前为止所尝试的，并且我已经验证该`head`数组包含所需的标头，并且该`targets`数组包含给定命令行传入的所需目标。

```
BEGIN{
    FS=","
    split(target, targets, ",")

}

NR==1 {
    for (i = 1; i <= NF; i++) head[i] = $i
}

NR !=1{
    for (i = 1; i <= NF; i++) {
        if (head[i] in targets){
            print $i
        }
    }
} 
```

当我使用命令调用此脚本时

> awk -v target=Field1 -f GetCol.awk Debug.csv

我什么也没打印出来。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T20:25:48.437

我想通了并发布了答案，以防其他人遇到同样的问题。

它与`in`我用于测试数组成员资格的关键字有关。此关键字仅测试左侧的操作数是否是右侧数组中的**索引**之一，而不是值之一。解决方法是创建一个反向查找数组，如下所示。

```
BEGIN{
    OFS=FS=","
    split(target, t_targets, ",")
    for (i in t_targets)
        targets[t_targets[i]] = i
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-18T20:41:13.767

我的两分钱：

```
BEGIN{
    OFS=FS=","
    split(target,fields,FS)            # We just set FS don't hard the comma here
    for (i in fields)                  # Distinct var name to aviod headaches
        field_idx[fields[i]] = i       # Reverse lookup 
}
NR==1 {                                # Process header
    for (i=1;i<=NF;i++)                # For each field header
        head[i] = $i                   # Add to hash for comparision with target
    next                               # Skip to next line
}
{                                      # Don't need invert condition (used next)
    sep=""                             # Set for leading separator
    for (i=1;i<=NF;i++)                # For each field
        if (head[i] in field_idx) {    # Test for current field is a target field
            printf "%s%s",sep,$i       # Print the column if matched 
            sep=OFS                    # Set separator to OFS                  
    }
    printf "\n"                        # Print newline character
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-25T16:26:06.387

@sudo_O 解决方案的扩展（谢谢）

1.  根据命令行参数从标准输入输出字段，
2.  按请求的顺序输出字段（可能多次），
3.  当请求但未找到字段时输出占位符，并且
4.  警告有关标头中重复字段名称的标准错误。

```
#!/usr/bin/awk -f
# Process standard input outputting named columns provided as arguments.
#
# For example, given foo.dat containing
#     a b c c
#     1a 1b 1c 1C
#     2a 2b 2c 2C
#     3a 3b 3c 3C
# Running
#   cat foo.dat | ./namedcols c b a a d
# will output
#   1c 1b 1a 1a d
#   2c 2b 2a 2a d
#   3c 3b 3a 3a d
# and will warn on standard error that it
#   Ignored duplicate 'c' in column 4
# Notice that the requested but missing column d contains "d".
#
# Using awk's -F feature it is possible to parse comma-separated data:
#   cat foo.csv | ./namedcols -F, c b a a d
BEGIN {
    for (i=1; i<ARGC; ++i)
        desired[i] = ARGV[i]
    delete ARGV
}
NR==1 {
    for (i=1; i<=NF; i++)
        if ($i in names)
            printf "Ignored duplicate '%s' in column %d\n", $i, i | "cat 1>&2"
        else
            names[$i] = i
    next
}
{
    for (i=1; i<ARGC; ++i)
        printf "%s%s",                                          \
               (i==1 ? "" : OFS),                               \
               ((ndx = names[name = desired[i]])>0 ? $ndx: name)
    printf RS
} 
```

# msbuild - 为什么 MSBuild 在 C:\ 中查找 Microsoft.Cpp.Default.props 而不是 c:\Program Files (x86)\MSBuild？（错误 MSB4019）

> ID：16092169
> 
> 赞同：132
> 
> 时间：2013-04-18T20:10:31.343
> 
> 标签：msbuild

当我运行 msbuild 来构建一个 vc2010 项目时，我收到以下错误：

```
error MSB4019: The imported project "C:\Microsoft.Cpp.Default.props" was not found. 
Confirm that the path in the <Import> declaration is correct, and that the file exists 
on disk. 
```

*   msbuild 位于 c:\Program File (x86)\MSBuild
*   HKLM\SOFTWARE\Wow6432Node\Microsoft\MSBuild\ToolVersions\V4.0 VCTargetsPath 设置为 $(MSBuildExtensionsPath32)\Microsoft.Cpp\v4.0\
*   当运行 msbuild /verbosity:diag as good system 时显示 MSBuildExtensionsPath32、MSBuildExtensionsPath64、MSBuildExtensionsPath**在构建开始时设置为 Environment**
*   将 MSBuildExtensionsPath32、MSBuildExtensionsPath64、MSBuildExtensionsPath 设置为 shell 中的环境变量不会导致它们**在构建开始时显示为环境**

**已尝试修复**

*   卸载.net 4.5，修复.net 4.0
*   在系统变量中设置 MSBuildExtensionsPath32、MSBuildExtensionsPath64、MSBuildExtensionsPath。

似乎没有正确设置 MSBuildExtensionsPath32 并且设置 MSBuildExtensionsPath 没有帮助

```
SET MSBuildExtensionsPath="C:\Program Files\MSBuild" 
```

如果您有任何想法阻止正确设置此变量，请告诉我。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2014-12-24T03:28:13.870

我在使用他们的命令行工具（调用 MSBuild）发布 cocos2d-x 应用程序时遇到了这个问题。我使用的是 Win 7 64 位，VS2013 express，cocos2d-x 3.3 版，.NET Framework 4.5 已安装。

我通过在运行 cocos.py 发布命令之前设置以下内容解决了这个问题：

```
SET VCTargetsPath=C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V120 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-04-25T18:27:28.793

对于那些不遵循 MS 禁止命令的人（请参阅[Xv 的回答](https://stackoverflow.com/a/16213408/985454)），您仍然可以解决问题。

MSBuild 使用`VCTargetsPath`来定位默认 cpp 属性，但不能，因为注册表缺少此字符串值。

**检查字符串值**

*   启动注册表
*   导航到`HKLM\SOFTWARE\Microsoft\MSBuild\ToolsVersions\4.0`
*   检查`VCTargetsPath`钥匙。值应该 = " `$(MSBuildExtensionsPath32)\Microsoft.Cpp\v4.0\`"

**修理**

*   启动 regedit Navigator 以`HKLM\SOFTWARE\Microsoft\MSBuild\ToolsVersions\4.0`
*   添加字符串值`VCTargetsPath`
*   将值设置为“ `$(MSBuildExtensionsPath32)\Microsoft.Cpp\v4.0\`”

注：`HKLM`代表`HKEY_LOCAL_MACHINE`.

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2017-01-03T23:22:52.093

我最近遇到了同样的问题，在以不同的顺序安装不同的软件包后，它变得非常混乱。然后我找到了这个 repo - [https://github.com/felixrieseberg/windows-build-tools](https://github.com/felixrieseberg/windows-build-tools)

`npm install --global windows-build-tools`

它安装了编译大多数节点模块所需的 Python 和 VS 构建工具。它奏效了！

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2019-01-19T20:09:44.557

# 适用于 Windows 10 上的 Visual Studio 2017 和 2019

这里的很多答案都适用于旧版本的 Visual Studio。如果使用 Visual Studio 2017 Community 版本，对我有用的是设置一个名为的环境变量`VCTargetsPath`并为其赋值

```
C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\VC\VCTargets 
```

如果使用 Visual Studio 2019 社区版，

```
C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Microsoft\VC\v160 
```

此处的其他答案将此变量设置为，`c:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\v140`但我注意到在我的 Visual Studio 安装中，我的 MSBuild 文件夹中没有名为 Microsoft.Cpp 的文件夹。所以请记住这一点，以及上面的路径适用于 Visual Studio 2017 的社区版本这一事实。

此外，如果您使用 Visual Studio 2017 社区版，请确保环境变量中的 MSBuild 路径指向正确的 MSBuild 版本，

```
C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\MSBuild\15.0\Bin 
```

如果您使用的是 Visual Studio 2019 社区版，

```
C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-04-25T11:22:00.583

为 Windows SDK 7.1安装[Microsoft Visual C++ 2010 Service Pack 1 编译器更新](http://www.microsoft.com/en-us/download/details.aspx?id=4422)修复了`MSB4019`我在 Windows7 x64 上构建的错误。

该更新的自述文件指出推荐的顺序是

1.  视觉工作室 2010
2.  视窗 SDK 7.1
3.  视觉工作室 2010 SP1
4.  适用于 Windows SDK 7.1 的 Visual C++ 2010 SP1 编译器更新

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-04-18T21:30:57.157

在 64 位系统上，MSBuild 默认使用以下属性（其中 C: 是 SystemDrive）：

```
MSBuildExtensionsPath = C:\Program Files (x86)\MSBuild
MSBuildExtensionsPath32 = C:\Program Files (x86)\MSBuild
MSBuildExtensionsPath64 = C:\Program Files\MSBuild 
```

如果没有，则意味着您安装了一些自定义第三方覆盖目标，或者您的 MSBuild 安装已损坏。

要尝试的事情：

*   修复 .NET 安装
*   应用最新的 Visual Studio Service Pack
*   `MSBuildExtensionsPath`如上手动设置（注意`x86`64位机器上的部分）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-01-22T02:05:21.790

MSBuild 是一个独立的构建工具，经常与其他工具捆绑在一起。它可能已使用 .NET（旧版本）、Visual Studio（新版本）甚至 Team Foundation Build 安装在您的计算机上。

MSBuild 需要与将使用它的 Visual Studio 或 TFS 版本以及编译源代码所针对的 .NET 版本相匹配的配置文件、编译器等（工具集）。

根据 MSBuild 的安装方式，配置文件可能位于这些路径中的一个或多个中。

*   C:\Program 文件 (x86)\MSBuild\Microsoft.Cpp\v4.0\
*   C:\Program 文件 (x86)\MSBuild\Microsoft.Cpp\v4.0\V120\
*   C:\Program 文件 (x86)\MSBuild\Microsoft.Cpp\v4.0\V140\

如其他答案中所述，注册表项和/或环境变量必须指向 ToolSet 路径。

*   HKLM\SOFTWARE\Microsoft\MSBuild\ToolsVersions\4.0 下的 VCTargetsPath 键
*   VCTargetsPath 环境变量。

有时，安装工具等操作会使注册表和/或环境变量设置不正确。其他答案都是修复它们的所有变体。

我唯一需要补充的是，当我离开尾随 \ 时，环境变量对我不起作用

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-07-05T11:17:26.740

我在 Visual Studio 2015 版上遇到了这个问题。当我使用 cmake 生成项目时，出现了此错误。

*错误 MSB4019：未找到导入的项目“D:\Microsoft.Cpp.Default.props”*

我通过添加一个字符串来修复它

> VCTargetsPath

有价值

> $(MSBuildExtensionsPath32)\Microsoft.Cpp\v4.0\V140

在注册表路径中

> HKLM\SOFTWARE\Microsoft\MSBuild\ToolsVersions\14.0

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-08-17T16:23:09.687

MSBuild 键的注册表项对我来说很好用。请务必记住，必须针对 64 位或 32 位分支执行此操作，具体取决于您运行的 MSBuild 版本。我不建议使用环境变量，因为它可能会导致不同版本的 MSBuild 出现问题。

此注册表文件修复了这两种情况：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\MSBuild\ToolsVersions\14.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath12"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath12)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"
"VCTargetsPath14"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath14)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\MSBuild\ToolsVersions\14.0\10.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\MSBuild\ToolsVersions\14.0\11.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\MSBuild\ToolsVersions\14.0\12.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath12"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath12)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\MSBuild\ToolsVersions\14.0\14.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath12"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath12)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"
"VCTargetsPath14"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath14)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\14.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath12"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath12)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"
"VCTargetsPath14"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath14)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\14.0\10.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\14.0\11.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\14.0\12.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath12"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath12)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\14.0\14.0]
"VCTargetsPath"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))"
"VCTargetsPath10"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath10)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\'))"
"VCTargetsPath11"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath11)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V110\\'))"
"VCTargetsPath12"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath12)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V120\\'))"
"VCTargetsPath14"="$([MSBuild]::ValueOrDefault('$(VCTargetsPath14)','$(MSBuildExtensionsPath32)\\Microsoft.Cpp\\v4.0\\V140\\'))" 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-10-11T15:15:36.383

**编辑：这适用于旧版本的 Visual Studio / MSBuild（特别是 MSVC2015？）。在更现代的版本中，MSBuild 包含在 Visual Studio Build Tools 2019 中，编译器位于不同的位置并以不同的方式进行检测。**

这是由于安装的 MSBuild 工具集和注册表设置不匹配。如果您执行了以下一项或多项操作，则可能会发生这种情况：

*   以错误的顺序安装多个 Visual Studio 版本
*   卸载一个或多个版本的 Visual Studio
*   手动对 Visual Studio 安装进行注册表更改或修改

我所知道的唯一安全可靠的解决方案是重新安装您的操作系统。如果您的项目需要多个版本的 Visual Studio 来构建，请先安装**最旧的版本**。然后修复你的代码，这样你就可以使用一个工具来构建它，否则你或你的同事很快就会再次陷入同样的​​困境。

如果这不适合您，请首先阅读[https://stackoverflow.com/a/41786593/2279059](https://stackoverflow.com/a/41786593/2279059)以更好地了解问题以及各种“解决方案”的实际作用。然后，根据您的 Visual Studio 版本和设置，其他答案之一或它们的变体最终可能会有所帮助。

更多提示：

*   如果您不想重新安装操作系统但尝试修复注册表，您可能想尝试以下答案：[https ://stackoverflow.com/a/38503503/2279059](https://stackoverflow.com/a/38503503/2279059)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-05-01T18:28:50.313

为 Windows SDK 7.1安装[Microsoft Visual C++ 2010 Service Pack 1 编译器更新对](http://www.microsoft.com/en-us/download/details.aspx?id=4422)我有用。但是，我遇到了更新问题，因为我已经安装了 VS 2010 和 VS 2010 SP1。正如 上面[Xv](https://stackoverflow.com/users/239408/xv)所述，readme.htm 文件包含“已知问题”部分中最常见安装问题的解决方案。我会按照 readme.htm 中的说明在每次故障排除尝试后重新启动您的计算机，因为某些安装会写入您的注册表。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-09-28T13:09:57.653

除了将路径设置为：

```
C:\Program Files\Microsoft Visual Studio\2017\BuildTools\MSBuild\15.0 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-12-17T11:42:21.103

就我而言，我添加了一个`VCTargetPath`带路径的环境变量

> "C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE\VC\VCTargets\"

（末尾的'\' 至关重要，因为项目解决方案文件引用了“Microsoft cpp 目标”文件。

此外，从 Visual Studio 2017 开始，MSBUILD 出现在 Visual Studio 中 - 因此，`PATH variable`需要更新

> C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\MSBuild\15.0\Bin

更新`VCTargetPath`和 MSBUILD 的`PATH`变量和构建修复了错误。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-11-09T23:41:38.400

我通过编写一个构建脚本遇到了这个错误，该脚本将在递归挖掘 C:\Windows\Microsoft.NET 文件夹以查找任何找到的 MSBuild.exe 文件后将 MSBuild 放在 %PATH% 上。最后找到的命中是放在路径上的目录。因为在我将 64 位 MSBuild 之一放在我的路径上之后，该`dir`命令会命中该`Framework64`文件夹。`Framework`我试图构建一个 Visual Studio 2010 解决方案并最终将我的搜索字符串从 更改`C:\Windows\Microsoft.NET`为 ，`C:\Windows\Microsoft.NET\Framework`以便最终使用 32 位 MSBuild.exe。现在我的解决方案文件构建了。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-01T10:34:59.997

我刚刚将`VCTargetsPath={c:\...}`环境变量添加到我的 Hudson 工作中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-05-29T15:12:50.690

作为记录，该文件`Microsoft.Cpp.Default.props`可以修改 env var`VCTargetsPath`并使该 var 的后续使用不正确。我遇到了这个问题，并通过将`VCTargetsPath10`和设置`VCTargetsPath11`为与`VCTargetsPath`.

这应该根据您使用的 VS 版本进行调整。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-02-12T19:23:39.303

我在 VS2017 环境中看到了这一点。我的构建脚本`VsDevCmd.bat`首先调用，为了解决这个问题，我在调用 MSBuild`VCTargetsPath`之后和之前设置了环境变量：`VsDevCmd`

```
set VCTargetsPath=%VCIDEInstallDir%VCTargets 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-12T19:31:41.020

添加到上面关于 VS2017/2019 的 Chris Gong 的回答（我还没有评论权限）。

如果安装的是 VS 2019 构建工具而不是完整的 Visual Studio，则文件路径会略有不同。VCTargetsPath 应该是

```
C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Microsoft\VC\v160\ 
```

另请注意终止反斜杠 - 至少在我的情况下需要（TFS2017、VS2019 构建工具）。PATH 条目的相应更改也是如此。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-14T11:47:49.240

我在使用 MSBuild for VS 17 时遇到了同样的问题

我通过应用以下步骤解决了这个问题：

*   在我的情况下，`Microsoft.Cpp.Default.props`文件位于，`C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\Common7\IDE\VC\VCTargets` 所以我`VCTragetsPath`在注册表中 创建了`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSBuild\ToolsVersions\4.0`带有值 的字符串`C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\Common7\IDE\VC\VCTargets`

*   我还让我的 Jenkins 以管理员用户身份运行

这解决了我的问题。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-02-13T14:55:35.733

首先在构建后的命令行中尝试此操作，而不是设置固定路径：

```
SET VCTargetsPath=$(VCTargetsPath) 
```

变量 '$(VCTargetsPath)' 似乎是一个与 c++ 相关的 visual-studio-macro，它没有在 c#-sdk-projects 中显示为宏，但在那里仍然可用。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-03-10T17:18:36.577

我把安装部分弄乱了，所以我卸载了 VSCode。一年前，我安装了一些其他版本，最近又安装了另一个。因此，在卸载所有内容后，从头开始。下载最新版本的 VSCode 和构建工具。然后它工作得很好。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-05-21T16:21:59.850

我在通过命令行调用`msbuild`和使用 Visual Studio 2019 时遇到问题。

对我有用的是在调用之前清除环境变量`msbuild`：

```
set VCTargetsPath=
call %ProgramFiles(x86)%/Microsoft Visual Studio/2019/Professional/MSBuild/Current/Bin\msbuild.exe ... 
```

# ant - 在字符串上使用蚂蚁长度条件时遇到问题

> ID：16092175
> 
> 赞同：1
> 
> 时间：2013-04-18T20:11:00.090
> 
> 标签：ant

当出现问题时，我正在尝试处理具有长错误消息而不是短值的字符串。我的 ant 脚本包含以下代码：

```
<!-- build.svnversion is invalid if it's longer than 15 characters --> 
<length property="build.svnversion.length" string="${build.svnversion}" />
<echo message="build.svnversion.length: ${build.svnversion.length}"/>

<condition property="build.svnversion" value="N/A" else="${build.svnversion}">
    <length string="${build.svnversion}" when="gt" length="15" />
</condition>
<echo message="build.svnversion: ${build.svnversion}" /> 
```

这会产生以下输出：

```
[echo] build.svnversion.length: 148
[echo] build.svnversion: svn: The path '.' appears to be part of a Subversion 1.7 or greater
[echo] working copy.  Please upgrade your Subversion client to use this
[echo] working copy. 
```

为什么 build.svnversion 不设置为 N/A，因为它的长度明显大于 15？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:11:42.510

您是否正在尝试重置属性`build.svnversion`？

一旦设置了属性，就不能取消设置或更改¹。

在您的`<condition/>`任务中，您必须使用另一个属性名称。

```
<!-- build.svnversion is invalid if it's longer than 15 characters --> 
<length property="build.svnversion.length"
    string="${build.svnversion}" />

<echo message="build.svnversion.length: ${build.svnversion.length}"/>

<condition property="real.build.svnversion"
    value="N/A"
    else="${build.svnversion}">
    <length string="${real.build.svnversion}"
        when="gt" length="15" />
</condition>
<echo message="real.build.svnversion: ${real.build.svnversion}" /> 
```

* * *

¹ .. 您可以使用 Ant-Contrib 的`<var/>`任务来更改属性的值或完全取消设置它，但这被认为是错误的形式。

# google-maps - 显示我在 sencha touch 中的当前位置

> ID：16092176
> 
> 赞同：0
> 
> 时间：2013-04-18T20:11:10.003
> 
> 标签：google-maps, sencha-touch

我正在做一个小型煎茶项目。我正在尝试添加拖图。第二张地图应该显示我的位置。在第二张地图上，我试图显示我的位置 -

```
useCurrentLocation: true, 
```

这是我的代码。它没有显示我当前的位置。第一张地图很好用……

我做错了什么？

```
Ext.define('WhatsUnderMe.view.Main', {
extend: 'Ext.tab.Panel',
xtype: 'main',
requires: [
'Ext.TitleBar',
'Ext.Video',
'Ext.Map',
'Ext.util.GeoLocation',
],
config: {
    tabBarPosition: 'bottom',
    items: [
    {
        xtype: 'map',
        useCurrentLocation: true,
        title: 'My Position',
        iconCls: 'home',
        mapOptions:{
            zoom: 16,
            mapTypeId: google.maps.MapTypeId.SATELLITE 
        },
    },
    {
        xtype: 'map',
        title: 'Under Me',
        iconCls: 'star',
        mapOptions:{
            zoom: 15,
            center: new google.maps.LatLng(lat, lng),
            mapTypeId: google.maps.MapTypeId.SATELLITE 
        },
    }
    ]
  },

});

var lat, lng;
var position;
var geoLocationOptions = { maximumAge: 3000, timeout: 5000, enableHighAccuracy: true };
navigator.geolocation.getCurrentPosition(geoLocationSuccess,geoLocationError,geoLocationOptions);

function geoLocationSuccess(position) {
    lat = position.coords.latitude;
    lng = position.coords.longitude;
}

function geoLocationError() {
 Ext.Msg.alert('Error','Error while getting location');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T22:42:26.497

像这样的东西应该工作。只需确保将代码中的 yourMapInstance 更改为您的谷歌地图的变量。

```
Ext.device.Geolocation.getCurrentPosition({
    allowHighAccuracy: true,
    maximumAge: 0,
    success: function(position) {

        var lat = position.coords.latitude,
            lon = position.coords.longitude;

        var userLocation = new google.maps.LatLng(lat,lon);

        var userLocationMarker = new google.maps.Marker({
            position: userLocation,
            map: yourMapInstance,
            clickable: false
        });

        yourMapInstance.setCenter(userLocation);

    },
    failure: function() {

        Ext.Msg.alert('Argh','Can\'t Find You!');

    }
}); 
```

# mongodb - MongoDB 和 Hadoop 基础知识

> ID：16092178
> 
> 赞同：0
> 
> 时间：2013-04-18T20:11:11.267
> 
> 标签：mongodb, hadoop

hadoop 只是用作数据处理吗？Hadoop的主要好处是能够在不同的机器上读取相同的文件并在那里处理它然后减少。

使用 MongoDB 和 Hadoop 适配器，我们可以在每个节点上处理数据，但数据供应仍然来自一个 MongoDb 机器（磁盘）。因此，借助 10 个 Hadoop 节点在 10Gb 中搜索可能与完全没有 Hadoop 相同（仅在 mongodb 机器上）

对我来说，这看起来像是一个瓶颈。我对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:42:39.897

不，Hadoop 实际上是两件事，HDFS（存储层）和 Mapreduce（处理层）。

只有文件的一部分，而不是整个文件。当您将文件存储在 HDFS 中时，它首先被切成 64M 的块（默认，但可配置），然后每个块以复制的方式存储在不同的机器上。每个块都在它所在的机器上读取，并与其他机器上的其他块并行处理。

为什么要将MongoDB数据先移动到Hadoop集群中再进行处理？你可以很好地使用分片和MapReduce以分布式方式处理MongoDB数据。您可能会发现此[链接](http://docs.mongodb.org/manual/sharding/)很有用。

# php - 从 JSON 字符串中删除双引号

> ID：16092179
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:11:19.893
> 
> 标签：php, xml, json, xslt

我正在使用一个看起来像这样的 xml 文件

```
 <FCDMC><rpt_info created="data generated 04/16/2013  16:45"/><gage_rain id="770" last_rpt="2013-04-16T14:22:11" min_10="0.00" min_30="0.00" hour_1="0.00" hour_3="0.00" hour_6="0.00" day_1="0.00" day_3="0.00" day_7="0.00" name="Tat Momolikot Dam" lat="032:39:04" long="111:55:41"/></FCDMC> 
```

使用此 xsl 样式表更改/修改 xml 文档。

```
<xsl:stylesheet version="1.0">
  <xsl:output method="xml" encoding="utf-8" media-type="text/xml" indent="yes"/>
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="rpt_info">
    <xsl:element name="meta" select=".">
      <xsl:for-each select="@created">
        <xsl:element name="created" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
    </xsl:element>
  </xsl:template>
  <xsl:template match="gage_rain">
    <xsl:element name="data" select=".">
      <xsl:for-each select="@id">
        <xsl:element name="site" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@lat">
        <xsl:element name="latitude" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@long">
        <xsl:element name="longitude" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@name">
        <xsl:element name="name" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@last_rpt">
        <xsl:element name="last_rpt" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@min_10">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@min_30">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@hour_1">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@hour_3">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@hour_6">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@day_1">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@day_3">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
      <xsl:for-each select="@day_7">
        <xsl:element name="rain" select=".">
          <xsl:value-of select="."/>
        </xsl:element>
      </xsl:for-each>
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

比我使用 PHP 输出新的 xml 文件

```
<?php
header('Content-Type: application/xml');
$xml = new DOMDocument;
$xml->load('http://alert.fcd.maricopa.gov/alert/Google/xml/fcdmc_alert_rain.xml');
$xsl = new DOMDocument;
$xsl->load('http://alert.fcd.maricopa.gov/alert/Google/v3/xslt/fcdmc_alert_rain.xsl');
$proc = new XSLTProcessor;
$proc->importStyleSheet($xsl); 
echo $proc->transformToXML($xml);
?> 
```

这个 php 输出 JSON

```
<?php
$xml = simplexml_load_file('http://alert.fcd.maricopa.gov/alert/Google/v3/php/rainfall_data.php');
$json = json_encode($xml);
echo $json;
?> 
```

**这是我当前的 JSON 输出**

```
{"meta":{"created":"04-18-2013 12:45"},"data":[{"site":"770","latitude":"032:39:04","longitude":"111:55:41","name":"Tat Momolikot Dam","last_rpt":"2013-04-18T11:22:11","rain":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00"]}]} 
```

**这就是我需要我的 JSON 输出的样子。我需要删除 0.00 值附近的双引号 ("")。**

```
{"meta":{"created":"04-18-2013 12:45"},"data":[{"site":"770","latitude":"032:39:04","longitude":"111:55:41","name":"Tat Momolikot Dam","last_rpt":"2013-04-18T11:22:11","rain":[0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00]}]} 
```

如何更改`"rain"`：[字符串]？

我在 xsl 中做吗？在php中？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:17:34.943

从 php 5.3.3 开始，您可以向[json_encode](http://www.php.net/json_encode)`JSON_NUMERIC_CHECK`传递一个标志，该标志将检查一个值是否为数字并使用数字而不是字符串对 json 字符串进行编码。

编辑：

根据我的最后一条评论，使用字符串替换，这将起作用：

```
<?php
//the json data, since I don't have the original data, I am just decoding the json output.
$json = '{"meta":{"created":"04-18-2013 12:45"},"data":[{"site":"770","latitude":"032:39:04","longitude":"111:55:41","name":"Tat Momolikot Dam","last_rpt":"2013-04-18T11:22:11","rain":["0.00","0.00","0.00","0.00","0.00","0.00","0.00","0.00"]}]}';

//decode the json output
$array = json_decode($json, 1);

//an empty array for rain data
$rain = array();

//loop through each data
foreach($array['data'] as $k=>$v){
    //save the rain data
    $rain[$k] = $v['rain'];
    //overwrite the rain data with a simple unique string that can be replaced
    $array['data'][$k]['rain'] = "{rain data {$k}}";
}

//encode the new data with the replacement string
$json = json_encode($array);

//loop over the rain data replacing the rain data replacement string with a JSON_NUMERIC_CHECK json_encoded rain data
foreach($rain as $k=>$v){
    //build the search string
    $search = '"{rain data '.$k.'}"';
    //build the replace string
    $replace = json_encode($v, JSON_NUMERIC_CHECK);
    //do the replace
    $json = str_replace($search, $replace, $json);
}
var_dump($json); 
```

[http://codepad.viper-7.com/hiWxjH](http://codepad.viper-7.com/hiWxjH)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T22:01:40.790

您 json-encode a`SimpleXMLElement`默认情况下将元素节点值返回为*strings*。

如果你想改变这种行为，你需要扩展它并改变它为 json 编码对象的方式，例如*雨*数组（如果存在）应该转换为浮点值：

```
class JsonSerializeXMLElement extends SimpleXMLElement implements JsonSerializable
{
    public function jsonSerialize() {
        $array = (array) $this;
        if ($this->rain) {
            $array['rain'] = array_map('floatval', $array['rain']);
        }
        return $array;
    }
} 
```

然后，您的脚本只需稍作更改即可提示加载函数使用具有更改的序列化行为的类：

```
$filename = 'http://alert.fcd.maricopa.gov/alert/Google/v3/php/rainfall_data.php';
$xml = simplexml_load_file($filename, 'JsonSerializeXMLElement');
$json = json_encode($xml); 
```

就是这样。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T21:16:24.810

关于什么

```
<xsl:value-of select="number(RAIN_STRING_HERE)"/> 
```

# mysql - 内部自连接的表示顺序

> ID：16092180
> 
> 赞同：1
> 
> 时间：2013-04-18T20:11:20.923
> 
> 标签：mysql, sql, join, self-join

如果我有一张如下表：

```
+------+-------+   
| sno  | cno   |  
+------+-------+  
|    1 | CS112 |  
|    1 | CS113 |  
|    1 | CS114 |  
|    2 | CS112 |  
|    3 | CS112 |  
|    3 | CS114 |  
|    4 | CS112 |  
|    4 | CS113 |  
|    5 | CS113 |  
|    6 | CS113 |  
|    6 | CS114 |  
+------+-------+ 
```

如果我进行内部自联接，`sno`我希望看到以下顺序的行：

```
+------+-------+------+-------+  
| sno  | cno   | sno  | cno   |  
+------+-------+------+-------+  
|    1 | CS112 |    1 | CS112 |  
|    1 | CS112 |    1 | CS113 |  
|    1 | CS112 |    1 | CS114 |  
|    1 | CS113 |    1 | CS112 |  
|    1 | CS113 |    1 | CS113 |  
|    1 | CS113 |    1 | CS114 |  
etc
+------+-------+------+-------+ 
```

但是顺序是

```
+------+-------+------+-------+  
| sno  | cno   | sno  | cno   |  
+------+-------+------+-------+  
|    1 | CS112 |    1 | CS112 |   
|    1 | CS113 |    1 | CS112 |  
|    1 | CS114 |    1 | CS112 |  
|    1 | CS112 |    1 | CS113 |  
|    1 | CS113 |    1 | CS113 |  
|    1 | CS114 |    1 | CS113 |  
|    1 | CS112 |    1 | CS114 |  
etc
+------+-------+------+-------+ 
```

即，我希望看到左侧的每一行对于骑行中的每一行都重复。反之亦然。即，它似乎获取所有行并将其与连接右侧的第一行匹配。
为什么是这样的顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:13:44.257

您不应该对查询中的结果顺序有任何期望，除非您使用`order by`子句（或在 MySQL 中，`group by`子句）。

不幸的是，我没有在 MySQL 文档中找到*明确*说明这一点的参考资料。最接近的是这里的[引用](https://dev.mysql.com/doc/refman/5.5/en/sorting-rows.html)：

> 您可能已经注意到，在前面的示例中，结果行没有按特定顺序显示。当行以某种有意义的方式排序时，通常更容易检查查询输出。要对结果进行排序，请使用 ORDER BY 子句。

但是，ANSI 标准确实指定查询结果（和表）是无序的，除非`order by`指定了子句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:35:29.230

将表视为记录集。我说“集合”是因为这通常是 SQL 的一个远亲称为[关系代数](http://en.wikipedia.org/wiki/Relational_algebra)的有效词。而且，当然，集合中没有顺序。

添加`order by`子句后，您将按指定顺序获得结果：

```
select t1.sno, t1.cno, t2.sno, t2.cno from t t1
join t t2 on t1.sno = t2.sno
order by t1.sno, t2.sno, t1.cno, t2.cno 
```

# delphi - 更改父容器会导致再次调用 Createwnd，Delphi 6

> ID：16092183
> 
> 赞同：2
> 
> 时间：2013-04-18T20:11:31.737
> 
> 标签：delphi, parent, custom-component, owner

我们有一些覆盖 createwnd 的旧版 delphi 自定义组件。这些组件位于表单内的面板上。

当窗体和面板被实例化时，组件也被实例化，并且 createwnd 被调用一次。这是有道理的。

但是，如果我在运行时切换面板的父级，我惊讶地发现 createwnd 将再次被调用。

例如，在某些情况下，我可能会将 Panel1 的父容器更改为 Form2.panel2。基本上在运行时在 Form2 的面板内绘制 Panel1。

```
TForm1.buttonclick(..)
begin
..
  Panel1.parent := Form2.panel2;
..
end; 
```

当父级更改时，为什么要重新创建 Panel1 中的自定义组件？

Panel1 中的所有组件的行为是否相同，即使不是自定义的，例如，如果我在 Panel1 上也有一个 TButton，那么在切换父级时也会重新创建它吗？我不认为它会，这就是为什么我如此惊讶。

最后，如果这种行为不正确，我该如何做到这一点，以便在父容器更改时不会调用 createwnd。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T20:39:23.317

面板中的所有控件`TWinControl`都重新创建了它们的窗口句柄，以及面板的窗口句柄（原因是相反的）。

如果您的代码在每个程序的生命周期中只能调用一次，那么`CreateWnd`这不是正确的地方。请尝试使用构造函数。

此外，将面板从一种形式替换为另一种形式可能会混淆面板的所有权，并可能导致意外行为甚至错误。请参阅：[如何分离面板并将其显示在单独的窗口中？](https://stackoverflow.com/q/6461715/757830)

# jsf - 会话超时后未触发 JSF 1.1 请求范围命令链接操作

> ID：16092185
> 
> 赞同：1
> 
> 时间：2013-04-18T20:11:40.457
> 
> 标签：jsf

我有一个 JSF1.1 页面，其中包含几个命令链接。此页面在请求范围下运行。如果在会话超时发生之前单击命令链接的操作，则会正确触发它。但是如果在会话超时后单击它，则不会调用操作方法，单击它只会重新显示当前页面。

这是正常行为吗？有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:38:53.533

当会话超时时，会话 ID`HttpServletRequest`将变为`null`，因此它将无法实现其功能。

您可以实现一个`filter`（这会为您在页面上的每次点击增加一些开销），以检查会话是否仍然有效。如果会话仍然有效，则允许处理继续进行，否则重定向回登录页面（或其他）。

下面是`filter`.

```
public void doFilter(ServletRequest request,ServletResponse response, FilterChain filterChain) throws IOException,ServletException
    {

        if((request instanceof HttpServletRequest) && (response instanceof HttpServletResponse))
        {

            HttpServletRequest httpServletRequest = (HttpServletRequest) request;
            HttpServletResponse httpServletResponse = (HttpServletResponse) response;

               if (isSessionControlRequiredForThisResource(httpServletRequest)) {

                    // is session invalid?
                    if (isSessionInvalid(httpServletRequest)) {

                     String timeoutUrl = httpServletRequest.getContextPath() + "/" + getTimeOutPage();

                     httpServletResponse.sendRedirect(timeoutUrl);
                     return;
                    }
                   }
                  }
        filterChain.doFilter(request, response);
        }

    private boolean isSessionControlRequiredForThisResource(HttpServletRequest httpServletRequest) 
    {
          String requestPath = httpServletRequest.getRequestURI();

          boolean controlRequired = !StringUtils.contains(requestPath, getTimeOutPage());

          return controlRequired;
    }

    private boolean isSessionInvalid(HttpServletRequest httpServletRequest) 
    {

          boolean sessionInValid = (httpServletRequest.getRequestedSessionId() != null)
            && !httpServletRequest.isRequestedSessionIdValid();

          return sessionInValid;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T12:22:57.247

不，这绝对不是正常行为。JSF 应该在`ViewExpiredException`这里抛出一个而不是简单地重新显示页面。

JSF 1.1 是一个漏洞百出的版本。[升级](http://javaserverfaces.java.net)到最新的 JSF 1.2。自 2006 年左右发布 JSF 1.2 以来，JSF 1.1 的开发一直停滞不前。JSF 1.2 中修复了许多问题。任何 JSF 1.0/1.1 应用程序都可以毫无问题地升级到 JSF 1.2。仅当您的应用程序错误地依赖于某些 JSF 1.1 特定错误来正确行为时，您的应用程序可能仍会中断。所以你还是应该在升级后彻底测试。

### 也可以看看：

*   [javax.faces.application.ViewExpiredException：无法恢复视图](https://stackoverflow.com/questions/3642919/javax-faces-application-viewexpiredexception-view-could-not-be-restored)

# ios - UINavigationController 的 Unwind Segue

> ID：16092189
> 
> 赞同：7
> 
> 时间：2013-04-18T20:12:01.130
> 
> 标签：ios, uistoryboardsegue

我有一个简单的 UINavigationController，它通过自定义 segue 将 UIViewController 推送到堆栈上。然后我在第一个 UIViewController 上实现了一个 IBAction 来执行展开操作，然后我实现了 segueForUnwindingToViewController。不幸的是，没有调用 segueForUnwindingToViewController（我确实确认在第一个 VC 上调用了 canPerformUnwindSegue）。

我还没有看到这种行为的任何简单示例。有人可以帮忙吗？谢谢。

这是来自 NavigationController 的根视图控制器的代码。

```
- (IBAction) unwindFromSegue:(UIStoryboardSegue *)segue {
// unwinds back to here
//[self performSegueWithIdentifier:@"UnwindToObjectManageSegue" sender:self];

}

- (BOOL)canPerformUnwindSegueAction:(SEL)action fromViewController:(UIViewController *)fromViewController
                     withSender:(id)sender {
return YES;
}

- (BOOL)shouldPerformSegueWithIdentifier:(NSString *)identifier sender:(id)sender {
return YES;
}

- (UIStoryboardSegue *)segueForUnwindingToViewController:(UIViewController *)toViewController
                                  fromViewController:(UIViewController *)fromViewController
                                          identifier:(NSString *)identifier {
ObjectManageObjectDetailSegue *segue = [[ObjectManageObjectDetailSegue alloc] initWithIdentifier:identifier source:fromViewController destination:toViewController];
[segue setUnwinding:YES];
return segue;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-06-25T06:04:10.450

我有同样的问题，我终于找到了解决方案： [https ://github.com/simonmaddox/CustomUnwindSegue](https://github.com/simonmaddox/CustomUnwindSegue)

他也有一个问题，它没有被调用。事实证明，UINavigationController 中的任何视图控制器都不会调用呈现视图控制器，而是调用 UINavigationController。这意味着您必须将该 UINavigationController 子类化并在那里添加该方法。

# c# - 通过相等缓存 LINQ 表达式

> ID：16092190
> 
> 赞同：6
> 
> 时间：2013-04-18T20:12:03.623
> 
> 标签：c#, linq, caching

考虑这种情况。

您有一个允许对其进行某些调用的存储库。这些调用使用 LINQ，并且在返回的数据量方面可能相对昂贵。

鉴于在我的情况下，如果数据是旧的，这并不算太糟糕——可以实现一个缓存，这样就不会在每次调用时都执行大而昂贵的查询。嘿，我们甚至可以实现一些缓存策略来根据时间或使用情况确定何时再次执行该查询。

我想要解决的问题是如何在缓存中键入它。一种方法是简单地说：

```
"querytype1" = Particular LINQ expression
"querytype2" = Particular LINQ expression 
```

然后通过一个简单的字符串来键入缓存。但是，考虑到我们正在执行 LINQ，我们是否可以通过 LINQ 表达式本身对缓存进行键控？我了解性能指标，但无论如何可以比较两个 LINQ 表达式是否相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:17:58.723

**策略：比较 SQL 输出**

一种策略可能是检索呈现的 SQL 文本 + 参数，并确定它们是否与来自另一个 IQueryable 的呈现的 SQL + 参数相同。

有关详细信息，请参阅[检索 LINQ to sql 语句 (IQueryable) WITH 参数](https://stackoverflow.com/questions/6343754/retrieve-linq-to-sql-statement-iqueryable-with-parameters)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-07T19:19:05.230

这是我目前对此的解决方案。

鉴于此，在存储库中，我们将调用类似于：

```
public IEnumerable<MYPOCO> GetData(string someParameter, int anotherParameter); 
```

因此我们可以说这些参数是*标准*。所以，我介绍了一个`Criteria`类，它基本上包含`Dictionary<string, object>`实例，并且有一些类型安全的 setter 和 getter，简化了：

```
public class Criteria
{
    private Dictionary<string, object> _criteria = new Dictionary<string, object>(StringComparer.OrdinalIgnoreCase);

    public Criteria Set<T>(string key, T value)
    {
        _criteria[key] = value;
        return this;
    } // eo Set

    public T Get<T>(string key)
    {
        return _criteria.ContainsKey(key) ? _criteria[key] : default(T);
    } // eo Get

    public Dictionary<string, object> Items { get { return _criteria; } }
}    // eo class Criteria 
```

然后，我写了一个扩展方法`Dictionary<TK, TV>`，基于[这个 Stackoverflow 答案](https://stackoverflow.com/questions/3928822/comparing-2-dictionarystring-string-instances)。最后，一个`IEqualityComparer<Criteria>`适用于`Criteria`.

这意味着我的缓存现在由标准*键入*，该标准采用传入存储库的参数进行设置：

```
public class MyPocoRepository<TMYPOCO>
{
    private Cache<Criteria, IEnumerable<TMYPOCO>> _cache = new Cache<Criteria, IEnumerable<TMYPOCO>>(CriteriaComparer); // is passed to the dictionary constructor which is actually the cache.
    public IEnumerable<TMYPOCO> GetData(string someParameter, int anotherParameter)
    {
        Criteria criteria = new Criteria();
        criteria.Set("someParameter", someParameter)
                .Set("anotherParameter", anotherParameter);
        // we can check the cache now based on this...
    } // eo GetData
} // eo MyPocoRepository<TMYPOCO> 
```

请注意，当我们想要参数完全相同的缓存策略时，这也允许我扩展这个想法，但可能是不同的*用户*帐户正在访问它（我们可以在条件中添加一个字段，比如用户类型，即使 LINQ 表达式不会使用它）。

# php - PHP file_get_contents 错误

> ID：16092195
> 
> 赞同：0
> 
> 时间：2013-04-18T20:12:25.397
> 
> 标签：php, html, web-services, finance, stockquotes

我正在建立一个股票分析网站来使用股票信息，例如价格历史等。一旦我获得数据，我将实施一些我自己的算法，但我在获取历史数据时遇到了麻烦。该网站托管在免费的网络托管上biz.nf. 包含的 connect.php 文件包含所有需要的 sql 信息并连接到数据库。我在那里进行了错误检查，所以我知道那不是问题所在。我还尝试手动复制/粘贴链接，它们可以正常工作，因此我正在正确创建 URL。我在这个网站和其他网站上遇到了一些类似的主题，但我没有看到如何解决它的明确解决方案或它发生的明确原因。雅虎是不是屏蔽了我？还，我想提一下，我对 php 编程很陌生，但我在 C 和 C++ 方面有很深的背景，所以如果可以的话，请在提供任何帮助时考虑这一点。提前致谢！

这是我执行的 index.php 文件的代码

代码：

```
<html>
  <head>
    <title>StockGrader</title>
  </head>
    <body bgcolor="green"  text="black" link="red">
      <div id="header">
          <hr>
             <h1>Welcome To <b><i>StockGrader</b></i><h1/></hr>

<?php
  include("phpINCLUDES/connect.php");

//function that creates a url from which to download data
  function createURL($ticker) 
  {       $currentMonth = date("n") - 1; //"n" current month as a 1-digit number
          $currentDay = date("j");       //"j" current day as a 1-digit number
          $currentYear = date("Y");      //"Y" current year as a 4-digit number
          echo "current URL is http://ichart.finance.yahoo.com/table.csv?s=$ticker&d=$currentMonth&e=$currentDay&f=$currentYear&g=d&a=3&b=10&c=2013&ignore=.csv";
          echo "\n\n\n";
          return "http://ichart.finance.yahoo.com/table.csv?s=$ticker&d=$currentMonth&e=$currentDay&f=$currentYear&g=d&a=3&b=10&c=2013&ignore=.csv";
  }

//function to download data from a url and store into a file
  function getCSVFile($URL, $outputFile) 
  {
      **$content = file_get_contents($URL);**     //goes to the file located at this link and downloads the full file contents as a string of data

      //replace a string which is the first parameter with the string in the second parameter. the string being replaced is in the third parameter
      $content = str_replace("Date,Open,High,Low,Close,Volume,Adj Close","", $content);

      //removes all white space
      $content = trim($content);

      //write a string into a file
      file_put_contents($outputFile, $content);      
  }

  function fileToDatabase($txtFile, $tableName)
  {
          $file = fopen($txtFile, "r");

          while(!feof($file))
          {
              $line = fgets($file);

              //separates a string 
              $pieces = explode(",", $line);

              //stock variables
              $date = $pieces[0];
              $open = $pieces[1];
              $high = $pieces[2];
              $low = $pieces[3];
              $close = $pieces[4];
              $volume = $pieces[5];
              // $adjclose = $pieces[6];   WE ARE NOT GOING TO USE THIS ONE USUALLY
              $amount_change = $close - $open;
              if($open!=0)
              { $percent_change = ($amount_change/$open)*100; }
              else $percent_change = 99999;

              //check if table exists or not
              $sql = "SELECT * FROM $tableName";
              $result = mysql_query($sql); 

              //if table doesn't exist
              if(!$result) 
              {
                  $sql_2 = "CREATE TABLE $tableName (date DATE , PRIMARY KEY(date), open FLOAT, high FLOAT, low FLOAT, close FLOAT, volume INT, amount_change FLOAT, percent_change FLOAT)";
                  mysql_query($sql_2);
              }

              //insert into table
              $sql_3 = "INSERT INTO $tableName(date, open, high, low, close, volume, amount_change, percent_change) VALUES ('$date','$open','$high','$low','$close','$volume','$amount_change','$percent_change')";
              mysql_query(sql_3);
          }
          fclose($file);
  }

  function main()
  {
    //i don't have this file yet
      $mainTickerFile = fopen("tickerMaster.txt","r");
      while(!feof($mainTickerFile))
      {
          $companyTicker = fgets($mainTickerFile);
          $companyTicker = trim($companyTicker);    //trim whitespace just in case

          $fileURL = createURL($companyTicker);    //create url for each stock ticker
          //create a directory path to each file for each ticker
          $companyTxtFile = "txtFiles/".$companyTicker.".txt";           //I NEED TO CREATE THIS FOLDER ON MY SERVER

          getCSVFile($fileURL, $companyTxtFile);

          fileToDatabase($companyTxtFile, $companyTicker);
      }
  }

  main();
?>

              <p><a href="secondpage.html">Run Script</a></p>
     </div>
 </body>
</html> 
```

**这是我得到的错误：**

```
[function.file-get-contents]: failed to open stream: Connection refused in /srv/disk12/1368341/www/nemanja.co.nf/index.php on line 26 
```

我在发生错误的地方以粗体显示文本（每边 2 个星号）。

此外，托管该网站的服务器具有 allow_url_fopen = 1 如果是这种情况 yahoo.com 阻止了我，有没有办法解决这个问题？是否有另一种获取所有历史股票数据的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:17:08.807

您确定您的共享主机允许连接到远程 url - 不太可能

大多数共享主机往往不会在 php.ini 中将 allow_url_fopen 设置为 true

也许尝试使用 curl 代替

# c# - 在纹理上调用 Resources.Load 不起作用

> ID：16092200
> 
> 赞同：2
> 
> 时间：2013-04-18T20:12:38.900
> 
> 标签：c#, resources, unity3d, textures

我正在尝试`Texture`从`Resources`文件夹中加载一个，但它一直在返回`null`。

```
t = (Texture)Resources.Load("Circle") as Texture; 
```

圆形纹理的扩展名为`.tga`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-02T11:17:06.997

# Single Texture File

Texture File should be added into **Resources** folder After that use below lines of code for load texture

```
var Texture_1 : Texture2D;
Texture_1 = Resources.Load("TextureName"); 
```

# For Folder

Folder should be in kept into **Resources** folder After that use below lines of code for load folder of textures

```
var textures : Object[];
textures = Resources.LoadAll("FolderName"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-19T15:03:50.550

文件的扩展名不是必需的。所以这是正确的：

```
t = (Texture)Resources.Load("Circle") as Texture; 
```

这不是：

```
t = (Texture)Resources.Load("Circle.npg") as Texture; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T13:45:01.523

您必须将 Circle.tga 放在 Assets/Resources 文件夹中。另外，如果您有子文件夹，例如 Resources/Textures/Circle.tga 然后这样做：

```
Texture t = Resources.Load("Textures/Circle") as Texture; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-30T10:17:29.433

@Massimiliano Uguccioni 谢谢...解决了我的问题。

**使用 Resources.load 的步骤：**

1.  确保它在资源文件夹中
2.  参考没有资源的完整相对路径：例如：纹理/纹理1，其中纹理是资源中的文件夹
3.  像 Massimiliano Uguccioni 说的不包括文件扩展名

# c - 将 7 个字符放入 2 个无符号短数组中

> ID：16092201
> 
> 赞同：1
> 
> 时间：2013-04-18T20:12:39.453
> 
> 标签：c, bit-manipulation

我无法弄清楚如何在 c 编程中将 9 char 放入 4 unsigned short 数组中。

我知道一个 char 是 1 个字节，但只使用了 7 位，因为 ascii 表是 0 ~ 127，所以我需要 7 * 9 = 63 位。因为 short 每个是 2 个字节，所以每个 short 有 16 位。4 个短数组是 4 * 16 = 64 位。这意味着我可以将这 9 个字符放入一个由 4 个无符号短字符组成的数组中

所以基本上我有

> 无符号短 *ptr, theArray[4], 字母 = 0;
> 
> 整数掩码；
> 
> //读取9个字符并将其保存到数组中

我不明白的是如何读取输入的 4 个字符并将其保存到 theArray。限制是我不能先把它们放到一个字符串中，我不能声明除了 int 之外的任何东西。我知道我必须做一些位操作，但我只是不知道如何读取输入。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:23:36.893

这就是轮班和/或运营商发挥作用的地方。

我不能给出任何确切的例子，但你可以一起使用它们来将字符“粉碎”成一组无符号短裤。

一个简单的例子，可能不是你正在寻找的，将是：

```
char j = 'J';
char y = 'Y';
unsigned short s = ( y << 7 ) | j; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T08:51:02.023

如果我们可以假设 unsigned short = 16 位和 char = 8，那么除非我打错了，否则该怎么办：

```
#include <stdio.h>

int main()
{
  unsigned short *ptr, theArray[4], letter = 0;
  int mask;

  // theArray:
  //  |<-------0------>|<-------1------>|<-------2------>|<-------3------>|
  // characters:
  //   0111111122222223 3333334444444555 5555666666677777 7788888889999999

  // Because we use |= first clear the whole thing
  theArray[0] = theArray[1] = theArray[2] = theArray[3] = 0;

  /* char 1 */  letter=getchar();
                theArray[0] |= 0x7F00 & (letter << 8);

  /* char 2 */  letter=getchar();
                theArray[0] |= 0x00FE & (letter << 1);

  /* char 3 */  letter=getchar();
                theArray[0] |= 0x0001 & (letter >> 6);
                theArray[1] |= 0xFC00 & (letter << 10);

  /* char 4 */  letter=getchar();
                theArray[1] |= 0x03F8 & (letter << 3);

  /* char 5 */  letter=getchar();
                theArray[1] |= 0x0007 & (letter >> 4);
                theArray[2] |= 0xF000 & (letter << 12);

  /* char 6 */  letter=getchar();
                theArray[2] |= 0x0FE0 & (letter << 5);

  /* char 7 */  letter=getchar();
                theArray[2] |= 0x001F & (letter >> 2);
                theArray[3] |= 0xC000 & (letter << 14);

  /* char 8 */  letter=getchar();
                theArray[3] |= 0x3F80 & (letter << 7);

  /* char 9 */  letter=getchar();
                theArray[3] |= 0x007F & letter;

  return 0;
} 
```

# javascript - 使用 jsPlumb 存储和检索坐标

> ID：16092202
> 
> 赞同：1
> 
> 时间：2013-04-18T20:12:42.807
> 
> 标签：javascript, jquery, jsplumb

我想使用 jsPlumb（带有 jquery）来创建一个家谱类型的程序。我希望节点是可拖动的，我知道 jsPlumb 可以为您做到这一点。但是，在节点被拖动并重新定位后，我想让用户能够保存他的更改并保存精确的布局。我需要获取每个元素的坐标并将它们存储在数据库中，然后使用该数据重新创建页面。我怎样才能以最有效的方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T13:04:57.477

您可以使用绝对定位并使用 jQuery 检索元素位置：

```
var pos = $(yournode).position();
var top = pos.top;
var left = pos.left; 
```

# javascript - 在 Ajax 表单中设置 Google Analytics 事件

> ID：16092203
> 
> 赞同：1
> 
> 时间：2013-04-18T20:12:43.697
> 
> 标签：javascript, jquery, ajax, google-analytics

我正在尝试在 WP 插件的灯箱联系表单上设置 Google Analytics 事件。

我在内部添加了 onSubmit 调用，虽然它可以毫无问题地很好地呈现，但事件并未登录到 Analytics

```
<form action="#" method="post" class="modal-contact_form" onSubmit="_gaq.push(['_trackEvent', 'Contact V1', \'<?php echo $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"] ?>', '1']);"> 
```

该活动似乎没有登录，因为在您点击发送联系表单后会出现一个新的谢谢灯箱窗口

这是谢谢灯箱窗口的原始代码

```
 $.post( modal_contact_params.ajax_url, data, function( response ) {
                if ( response == "SUCCESS" ) {

                    $('#facebox .content form.modal-contact_form').slideUp();
                    $('#facebox .notice').remove();
                    var agent_name = jQuery("#ninety_mcf_user_name").html();
                    if(agent_name=='This Agent'){
                        $('#facebox .modal-contact_messages').html('<div class="notice success"><div><p><strong>' + modal_contact_params.i18n_sent + '</strong> ' + modal_contact_params.i18n_thanks + '</p></div></div>'
    );
}
    else
{
                        $('#facebox .modal-contact_messages').html('<div class="notice success"><div><p><strong>' + modal_contact_params.i18n_sent + '</strong>Thanks, your email has been sent to '+agent_name+'</p></div></div>'
);
                    }

                } 
```

我试图在 Success 灯箱的末尾插入 _gaq.push 事件调用，但我做不到

我尝试了各种组合，但都没有渲染，因为它们都在 Chrome 的 GA Debug 控制台上产生错误

我的许多不同尝试之一

```
</div>' + { _gaq.push(['_trackEvent', 'Contact V1', 'Send', '1']); } +''
); 
```

谢谢，我希望 SO 大师能轻松地帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T14:22:55.353

我认为您不想将函数调用附加到字符串，而是执行它...

```
...</div>');
_gaq.push(['_trackEvent', 'Contact V1', 'Send', '1']);
... 
```

# c - 在 Linux 中实现 rm 命令的 C 代码中的分段错误

> ID：16092206
> 
> 赞同：1
> 
> 时间：2013-04-18T20:12:57.117
> 
> 标签：c, segmentation-fault

这是一段编译良好但在运行时给出分段错误的代码。谁能告诉我如何解决这个问题。该代码在 C 中实现 rm 系统调用。

```
#include<sys/stat.h>
#include<unistd.h>
#include<dirent.h>
#include<error.h>
#include <stdio.h>
#include <string.h>

int rmq(char*pth)
{
  char path[1000]; //hold the file name to be removed
  strcpy(path,pth);
  char *b; // stores the complete path of the file to be removed
  struct dirent *d;
  DIR *dir;

  char cwd[256]; //holds current working directory
  getcwd(cwd, sizeof(cwd));  
  dir = opendir(cwd);
  char path1[1000]; //for recursively moving through dir and subdir
  strcpy(path1,cwd);

  char newp[1000];
  struct stat buf;

  while((d = readdir(dir))) //if there are directories to be read 
  {  
     if(!strcmp(d->d_name,".") || !strcmp(d->d_name,"..")) // skip "." and ".."
     continue;

     //appends directory read to cwd

     strcpy(newp,path1); 
     strcat(newp,"/");
     strcat(newp,d->d_name); 
     //printf("%s>>",d->d_name);

     if(stat(newp,&buf)==-1) // puts file info in buf
        perror("stat");
     if(S_ISDIR(buf.st_mode))// if directory, then add a "/" to current path
     { 
     //if a directory then call function again(recursion)
        strcat(path1,"/");
        strcat(path1,d->d_name);
        rmq(path1);
     }
     else{ 
        //if directory current read is the one to be removed
        if((strcmp(path, d->d_name)) == 0){
        // append it with cwd & put it in b
        b = malloc(25 + strlen(d->d_name) + 1);
        sprintf(b, "%s/%s", "/home/urwa/Documents/OPS", d->d_name);
        remove(b); // remove that file
        free(b);
        }
     } 
 }
 return 0;
}

int main(){
   char cwd[256];
   getcwd(cwd, sizeof(cwd));

   char *argv[2];
   argv[1] = "dumbledore.txt";
   rmq(argv[1]); // file to be removed is passed as parameter
   return 0;
} 
```

我尝试了 malloc 但它没有解决问题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T21:13:29.577

您绝对应该使用`-Wall -Wextra`标志编译您的代码，以便更好地从编译器帮助中受益。在这里，使用您的代码，您会收到以下警告：

```
test.c: In function ‘rmq’:
test.c:9:4: warning: implicit declaration of function ‘strcpy’ [-Wimplicit-function-declaration]
test.c:9:4: warning: incompatible implicit declaration of built-in function ‘strcpy’ [enabled by default]
test.c:25:3: warning: suggest parentheses around assignment used as truth value [-Wparentheses]
test.c:26:3: warning: implicit declaration of function ‘strcmp’ [-Wimplicit-function-declaration]
test.c:30:5: warning: implicit declaration of function ‘strcat’ [-Wimplicit-function-declaration]
test.c:30:5: warning: incompatible implicit declaration of built-in function ‘strcat’ [enabled by default]
test.c:34:5: warning: implicit declaration of function ‘perror’ [-Wimplicit-function-declaration]
test.c:43:5: warning: implicit declaration of function ‘sprintf’ [-Wimplicit-function-declaration]
test.c:43:5: warning: incompatible implicit declaration of built-in function ‘sprintf’ [enabled by default]
test.c:43:5: warning: passing argument 1 of ‘sprintf’ makes pointer from integer without a cast [enabled by default]
test.c:43:5: note: expected ‘char *’ but argument is of type ‘char’
test.c:44:5: warning: implicit declaration of function ‘remove’ [-Wimplicit-function-declaration]
test.c: In function ‘main’:
test.c:58:2: warning: control reaches end of non-void function [-Wreturn-type]
test.c: In function ‘rmq’:
test.c:43:12: warning: ‘b’ may be used uninitialized in this function [-Wuninitialized] 
```

因此，解决所有问题的最佳方法是执行以下操作：

*   首先，缺少包括：

    ```
    #include <stdio.h>
    #include <string.h> 
    ```

*   在 while 测试中的赋值周围添加额外的括号（编译器需要它以确保您知道自己在做什么）：

    ```
    while((d = readdir(dir))){ 
    ```

*   您需要将 转换`char b;`为 a`char *b;`并分配/取消分配必要的内存来存储字符串：

    ```
    if((strcmp(path, d->d_name)) == 0){
      b = malloc(25 + strlen(d->d_name) + 1);
      sprintf(b, "%s/%s", "/home/urwa/Documents/OPS", d->d_name);
      remove(b);
      free(b);
    } 
    ```

*   然后，您需要添加`return 0`到`main`函数中以匹配您定义的签名。

一旦你完成了所有这些，仍然存在一个错误，因为你错过了处理一些案例。尝试使用`gdb`和/或修复它`valgrind`（考虑`-g`在编译时设置选项）。

# php - MySql 查询一个子集

> ID：16092208
> 
> 赞同：0
> 
> 时间：2013-04-18T20:13:19.560
> 
> 标签：php, mysql

我有一个 MySQL 问题。我有一个包含三列的表：“salesdate”（包含日期）、“salestime”（包含时间）和“remaining”（包含整数）。该表包含过去和未来的日期。我想从“剩余”中选择一个与当前日期和时间最接近的值。

我在下面构建了查询，但它只选择日期和时间值都为真的值。这可能会产生错误的结果，因为“salesdate”中可能有昨天日期的行，但所有“salestime”值都大于当前时间 - 所以我当前的查询会忽略这些......即使它们是最接近的到当前日期/时间。

我目前的查询：

```
$result = mysql_query(
"SELECT remaining 
FROM quantity_time 
WHERE salesdate<=CURDATE() 
AND salestime<=CURTIME() 
ORDER BY salesdate DESC
LIMIT 1 "); 
```

我认为我需要做的是首先查询日期，然后以某种方式过滤此列表以显示最接近当前时间的日期/时间？但如何？如果您能提供帮助 - 我已经搜索并找不到明确的分步方法。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:56:41.250

> 最接近当前时间？

第一个问题是你的数据设计是错误的。如果时间和日期都指同一事件，则信息*应由*单个日期时间字段表示 - 而不是 2 个单独的字段。因此，您对该数据运行的任何查询都将非常低效。

此外，从您的描述中不清楚销售日期+时间是否可能在未来。

因此，使用您当前的架构：

```
SELECT remaining 
FROM quantity_time  
ORDER BY ABS(NOW() - timestamp(salesdate,salestime)) DESC
LIMIT 1 
```

“剩余”一词意味着您正在使用它来确定库存水平 - 这意味着您的架构**非常**错误。表示股票和交易的正确方法是通过 2 个单独的实体（表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:19:50.020

```
SELECT remaining FROM (
SELECT remaining,
(UNIX_TIMESTAMP(salesdate) - UNIX_TIMESTAMP()) AS difference
FROM quantity_time 
WHERE salesdate<=CURDATE() 
AND salestime<=CURTIME()
) subquery
ORDER BY difference DESC
LIMIT 1 
```

我不知道这是否非常高效，但这至少应该有效。它首先创建一个子查询，以秒为单位计算时间差，然后按差值排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:20:06.850

与当前日期时间最接近的意思是什么？

放一些范围，我不知道它应该有多准确，但是：

```
SELECT remaining 
FROM quantity_time 
WHERE salesdate<=CURDATE() 
AND salestime BETWEEN date_sub(NOW(), INTERVAL 24 HOUR) AND date_add(NOW(), INTERVAL 24 HOUR)
ORDER BY salesdate DESC
LIMIT 1 
```

# javascript - Changetab 功能适用于 IE 和 chrome 但不适用于 FireFox

> ID：16092209
> 
> 赞同：1
> 
> 时间：2013-04-18T20:13:21.497
> 
> 标签：javascript, html, internet-explorer, google-chrome, firefox

出于某种原因，我的 ebay 帐户正在使用当前的编码，它在 chrome 和 EI 上完美运行，但在 Firefox 上却不行。

ebay 对可以使用的编码类型有一些限制。

编码如下所示，带有 css 和 all。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <HEAD>
    <TITLE></TITLE>
    <STYLE>
    #maincontent {
        width: 860px;
        position: relative;
        margin-bottom: 20px;
        margin-top: 40px;
        border-top-color: #CCC;
        border-right-color: #CCC;
        border-bottom-color: #CCC;
        border-left-color: #CCC;
        margin-right: auto;
        margin-left: auto;
    }
    #tabContents {
        vertical-align: top;
        padding-top: 5px;
        padding-right: 5px;
        padding-left: 5px;
        border-right-width: thin;
        border-bottom-width: thin;
        border-left-width: thin;
        border-right-style: solid;
        border-bottom-style: solid;
        border-left-style: solid;
        border-top-color: #336633;
        border-right-color: #336633;
        border-bottom-color: #336633;
        border-left-color: #336633;
        font-family: Verdana, Geneva, sans-serif;
        font-size: 12px;
        font-weight: normal;
        color: #21A54F;
        padding-bottom: 10px;
    }
    #TabHidden {
        position: absolute;
        width: 834px;
        left: 57px;
        top: 277px;
        height: 260px;
        clear: both;
        visibility: hidden;
        overflow: hidden;
    }
    #redirect {
        width: 746px;
        margin-left: 56px;
        margin-bottom: 15px;
        font-family: Verdana, Geneva, sans-serif;
        font-style: italic;
        color: #276B3F;
        font-size: 10px;
        text-align: center;
    }
    #TabDivPic {
        height: auto;
        width: 175px;
        margin-right: 30px;
        float: left;
    }
    .conts  {
        visibility:hidden
    }
    .tab    {
        font-family:Verdana, Geneva, sans-serif;
        font-size:10pt;
        text-align:center;
        font-weight:normal;
        color: #FFF;
        background-color: #21A54F;
        border-right-style: solid;
        border-left-style: solid;
        border-right-width: thin;
        border-left-width: thin;
        border-right-color: #CCC;
        border-left-color: #CCC;
    }
    .selTab {
        font-weight:bold;
        text-align:center;
        font-family: Verdana, Geneva, sans-serif;
        color: #FFFFFF;
        background-color: #276B3F;
        font-size: 12px;
    }
    #tabstyle #td {
        font-family: Verdana, Geneva, sans-serif;
        font-size: 12px;
        color: #FFF;
    }
    #tabtable {
        width: 656px;
    }
    </STYLE>
    <SCRIPT language="javascript" type="text/javascript">

    //a public function that the container uses to pass in values for the labels
    function public_Labels(label1, label2, label3, label4, label5, label6, label7){

        t1.innerText = label1;
        t2.innerText = label2;
        t3.innerText = label3;
        t4.innerText = label4;
        t5.innerText = label5;
        t6.innerText = label6;
        t7.innerText = label7;
    }

    //a public function that the container uses to pass in values for the card containers
    function public_Contents(contents1, contents2, contents3, contents4, contents5, contents6, contents7){

        t1Contents.innerHTML = contents1;
        t2Contents.innerHTML = contents2;
        t3Contents.innerHTML = contents3;
        t4Contents.innerHTML = contents4;
        t5Contents.innerHTML = contents5;
        t6Contents.innerHTML = contents6;
        t7Contents.innerHTML = contents7;

        init();
    }

    //sets the default display to tab 1
    function init(){
        tabContents.innerHTML = t1Contents.innerHTML;
    }   

    //this is the tab switching function
    var currentTab;
    var tabBase;
    var firstFlag = true;

    function changeTabs(event){

        if(firstFlag == true){
            currentTab = t1;
            tabBase = t1base;
            firstFlag = false;
        }

        if(window.event.srcElement.className == "tab"){

            currentTab.className = "tab";

            tabBase.style.backgroundColor = "white";

            currentTab = window.event.srcElement;

            tabBaseID = currentTab.id + "base";

            tabContentID = currentTab.id + "Contents";

            tabBase = document.all(tabBaseID);

            tabContent = document.all(tabContentID);

            currentTab.className = "selTab";

            tabBase.style.backgroundColor = "";

            tabContents.innerHTML = tabContent.innerHTML;

        }
    }

    </SCRIPT>
    </HEAD>
    <BODY>
    <div id="maincontent">
    <DIV STYLE="position:relative; top:0px; height:400; width:746px; left:56px; border:none thin gray" onClick="changeTabs(event)" onload="init()">
    <TABLE id="tabtable" CELLPADDING=0 CELLSPACING=0>
        <TR id="tabstyle">
            <TD ID=t1 CLASS=selTab HEIGHT=25>TAB ONE</TD>
            <TD ID=t2 CLASS=tab>TAB TWO</TD>
            <TD ID=t3 CLASS=tab>TAB THREE</TD>
            <TD ID=t4 CLASS=tab>TAB FOUR</TD>
            <TD ID=t5 CLASS=tab>TAB FIVE</TD>
            <TD ID=t6 CLASS=tab>TAB SIX</TD>
            <TD ID=t7 CLASS=tab>TAB SEVEN</TD>
        </TR>
        <TR>
            <TD ID=t1base STYLE="height:2; border-left:solid thin white"></TD>
            <TD ID=t2base STYLE="height:2; background-color:white"></TD>
            <TD ID=t3base STYLE="height:2; background-color:white"></TD>
            <TD ID=t4base STYLE="height:2; background-color:white"></TD>
            <TD ID=t5base STYLE="height:2; background-color:white"></TD>
            <TD ID=t6base STYLE="height:2; background-color:white"></TD>
            <TD ID=t7base STYLE="height:2; background-color:white; border-right:solid thin white"></TD> 
        </TR>

        <TR>
            <TD HEIGHT="*" COLSPAN=7 ID=tabContents>
            content<br>
            content<br>
            content<br>
            content<br>

    </TD>

        </TR>
    </TABLE>
    </DIV>
      <div id="TabHidden">
      <DIV CLASS=conts ID=t1Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>

      <DIV CLASS=conts ID=t2Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>

      <DIV CLASS=conts ID=t3Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>

      <DIV CLASS=conts ID=t4Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>

      <DIV CLASS=conts ID=t5Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>

      <DIV CLASS=conts ID=t6Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>

      <DIV CLASS=conts ID=t7Contents>
            content<br>
            content<br>
            content<br>
            content<br>
      </DIV>
    </div>
    </DIV>
    </BODY>
    </HTML> 
```

对不起，一团糟。这真的是我第一次在这个网站上做这种类型的编码。

# java - 创建与 GWT Editor-Driver Framework 兼容的自定义小部件

> ID：16092211
> 
> 赞同：0
> 
> 时间：2013-04-18T20:13:29.457
> 
> 标签：java, gwt

我在服务器端有一个带有字段 List< String > xyz 的实体。所以我想为这个实体编写一个编辑器，但我也想为这个特定字段使用一个自定义小部件。由于我不完全确定 Editor-Driver 框架的工作原理，我仍在学习过程中。那么这是怎么做到的呢？我应该使用 CompositeEditor 接口还是 IsEditor 接口，或者只使用 Editor 接口就足够了。

[如果可能，还请解释 CompositeEditor、EditorDelegate、IsEditor 接口的定义以及您所知道的关于 Editor-Driver 框架工作的任何其他内容，除了http://code.google.com/p/google-web-](http://code.google.com/p/google-web-toolkit/wiki/Editors)上尚未解释的内容[工具包/wiki/编辑器](http://code.google.com/p/google-web-toolkit/wiki/Editors)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:53:02.640

以上可以通过在 Composite Widget 中实现 LeafValueEditor 来实现。然后可以使用 ListEditor 来维护这些 Widget 的列表。

示例：[https ://sites.google.com/site/mygwtexamples/home/ui/listeditor](https://sites.google.com/site/mygwtexamples/home/ui/listeditor)

据我了解，当我们需要合并那些不直接遵循编辑器合同的编辑器的工作时，实现了 IsEditor 接口。可能这意味着他们没有子编辑。显然 LeafValueEditor 和 ListEditor 没有子编辑器可以进入。

# google-oauth - 在 Google API 控制台中查找用户信息

> ID：16092214
> 
> 赞同：0
> 
> 时间：2013-04-18T20:13:35.430
> 
> 标签：google-oauth

在查看您的 Google API 控制台并选择“使用情况”下的“报告”部分时，您可以看到正在调用哪些 API、哪个区域、有多少用户等。

但是，我似乎找不到任何方法来列出实际使用 API 的用户。您可以转到报告>使用情况>用户并将鼠标悬停在图表上以查看每个用户的请求数，但仅此而已..没有用户信息与他们相关联。

我将如何找出用户 ID 是什么以及他们发出了多少请求（希望是正在使用的特定请求/API）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T16:58:18.277

出于隐私原因，开发者控制台不支持此功能。

如果您希望找出哪些用户正在访问您的应用程序，您需要将您的应用程序与 OAuth2 集成并请求用户明确授予您的应用程序授权以识别他们，方法是指定用户授权范围，例如“电子邮件”、“个人资料” ，或“openid”。然后，您应该能够收到一个令牌，该令牌会向您的信息披露 Google 用户标识符。

# android - Flash AIR - 谷歌商店的文件大小太大？该怎么办？

> ID：16092217
> 
> 赞同：0
> 
> 时间：2013-04-18T20:13:43.137
> 
> 标签：android, actionscript-3, flash, flash-cs6

我们正在制作一个包含大约 70 家餐厅的所有菜单的应用程序。每个菜单都是一个相当大的图像，用户抓住它并在屏幕上拖动它。这真是太棒了。但是，文件大小约为 115 mb。谷歌商店最大为 50mb。这是说我应该有人把它分成两个 .apk 文件。但是两个 50 mb 的文件真的不够……或者我应该以某种方式从服务器获取图像？我使用过electroserver，但我对php 很不好，而且我认为我需要做这样的事情。欢迎链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:49:44.010

就个人而言，我发现一个应用程序的想法，其唯一目的是显示餐厅菜单，占用我手机上 115MB 的空间是一个非常糟糕的主意。

Jave 提出的一种解决方案是使用[APK 扩展文件](http://developer.android.com/google/play/expansion-files.html)。扩展文件最大为 2GB，足以满足您的需求。[问题是 Flash AIR 应用程序是否支持这一点（这里](https://stackoverflow.com/questions/15232572/create-expansion-file-for-as3-android-air-app-flash-cs6)有一个未回答的问题）。

更好的解决方案是将菜单托管在您自己的服务器上。您可以使用像 Dropbox 文件夹这样简单的东西，并使用指向该文件夹的公共链接作为您的基本 URL。将菜单移至服务器有两个好处：

1) 它应该会大大减少你的 APK 的大小 2) 它允许个别餐馆更改菜单，而无需重新构建和重新发布你的整个应用程序

缺点是您的用户需要有效的网络连接才能打开菜单（您可以缓存以前下载的菜单）。

作为额外的步骤，您还可以添加功能以从服务器下载新的餐馆列表（以 XML、JSON 或类似格式）。这将允许您添加或删除菜单，而无需重新构建应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:16:31.960

如果有任何方法可以减小文件大小，请先执行此操作。如果 apk 仍然很大，请使用[APK 扩展文件](http://developer.android.com/google/play/expansion-files.html)，它们最多可以包含 2GB。

> 一些应用程序需要更多空间来存储高保真图形、媒体文件或其他大型资源。以前，如果您的应用程序超过 50MB，您必须在用户打开应用程序时自行托管和下载额外资源。托管和提供额外文件的成本可能很高，而且用户体验通常不太理想。为了让这个过程对您来说更轻松，对用户来说更愉快，Google Play 允许您附加两个大型扩展文件来补充您的 APK。

# javascript - 谷歌分析表单提交事件跟踪

> ID：16092220
> 
> 赞同：2
> 
> 时间：2013-04-18T20:13:59.890
> 
> 标签：javascript, google-analytics, dom-events

我有一个表单提交到我不拥有的另一个域并且需要在 Google Analytics 中跟踪事件。我宁愿不使用 jQuery 来避免依赖，但我不明白为什么这段代码不起作用：

```
<form action='example.com/search' onsubmit='trackSubmit()' id='frm'>
    <button type='submit'>Search</button>
</form>

<script type='text/javascript'>
function trackSubmit(e) { 

  var bForm = document.getElementById('frm');

    bForm.addEventListener('submit', function(e){
    e.preventDefault();
    _gaq.push('_trackEvent', 'Foobar', 'Foobar Form Submit');
    setTimeout(function(){

        console.log('tracking foobar');
        bForm.submit();

    }, 1000);
  }, false);

}
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:26:05.013

`onsubmit='trackSubmit()'`和`bForm.addEventListener('submit', function(e){`

这似乎是错误的部分。如果你调用`trackSubmit()`on `submit`，那么在这个函数中添加一个监听器是没有用的，它甚至不会触发。我认为应该只是：

```
<form action="http://example.com/search" onsubmit="return trackSubmit()" id="frm">
    <button type="submit">Search</button>
</form>

<script type="text/javascript">
function trackSubmit() {
    var frm = document.getElementById('frm');

    _gaq.push('_trackEvent', 'Foobar', 'Foobar Form Submit');
    setTimeout(function(){

        console.log('tracking foobar');
        frm.submit();

    }, 1000);

    return false;

}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T18:27:05.463

对于偶然发现这个问题并正在使用新版本的谷歌通用分析的用户。这是提交按钮和链接点击的代码

```
<script type='text/javascript'>
        function trackSubmit() { 

        ga('send', 'event', 'button', 'click', 'searchsubmit', 4);
          alert('testing send event')
        }

        function trackClick() { 
            ga('send', 'event', 'button', 'click', 'This is coool');
        }
    </script>

    <body>
    Pushing data.......

        <form onsubmit='trackSubmit()' id='frm'>
            <button type='submit' id= 'searchsubmit'>Search</button>

            </br>
            <a href='http://cool.com' onclick="trackClick(); return false;">cool</a>
        </form>

    </body> 
```

我已经发出警报以显示事件正在被触发，因为当页面提交并且您将在调试器中查看控制台时，您的事件将不可见。

![在此处输入图像描述](https://i.stack.imgur.com/EhHax.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T10:56:45.037

这将可重复用于多次提交跟踪。

```
<script type="text/javascript">
    function trackSubmissions(form, category, name, value) {
        try {
            _gaq.push(['_trackEvent', category, name, value]);
        } catch(err){}
        setTimeout(function() {
            form.submit();
        }, 100);
    }
</script>

<form onsubmit="trackSubmissions(this, 'category', 'name', 'value'); return false;">
</form> 
```

# c# - 我们可以保持动态变量引用某些方法来调用它吗？

> ID：16092222
> 
> 赞同：0
> 
> 时间：2013-04-18T20:14:03.183
> 
> 标签：c#, .net, wpf

我想创建一些`UserControl`并实现此代码

```
public dynamic CommandContext { set; get; } 
```

为了保持对我需要执行**的方法和参数的一些参考。**（如果有可能）

所以在同一个班级`UserControl`我得到了

#region 应用命令

```
 private ICommand _applyCommand;

    public ICommand ApplyCommand
    {
        get
        {
            if (_applyCommand == null)
            {
                _applyCommand = new RelayCommand(ApplyObject,  CanApply);
            }
            return _applyCommand;
        }
    }

    private void ApplyObject()
    {
        // use CommandContext and execute method od the ANY CLASS It has
    }

    private bool CanApply()
    {
        bool result = true;
        // Verify command can be executed here
        return result;
    }

    #endregion 
```

所以我想知道我是否可以像这样直接调用这个方法

```
private void ApplyObject()
{
      CommandContext.CloseWindow();
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:36:18.120

只是为了说清楚：

您应该使用[`Action`](http://msdn.microsoft.com/en-us/library/system.action.aspx)or [`Action<T>`](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)：

```
public class SomeClassThatCallsAnAction
{
    public Action SomeAction {get;set;}

    private void CallTheAction()
    {
        if (SomeAction != null)
           SomeAction();
    }
}

public class ClassThatDefinesTheAction:
{
    private SomeClassThatCallsAnAction instance;

    private void SomeMethod()
    {
          instance = new SomeClassThatCallsAnAction();
          instance.SomeAction = ThisIsTheAction;
    }

    private void ThisIsTheAction()
    {
        MessageBox.Show("Action Executed!!);
    }
} 
```

解释：

该`ThisIsTheAction()`方法被分配给 的`SomeAction`属性`instance`。然后，当`instance`调用`SomeAction()`Action（它持有对该`ThisIsTheAction()`方法的引用）时，将执行该方法。

笔记：

**UI 可能不适合这样做**。

创建适当的 ViewModel 来定义您的应用程序逻辑。

# android - 禁用 onTouch 直到活动对用户可见

> ID：16092232
> 
> 赞同：0
> 
> 时间：2013-04-18T20:14:58.093
> 
> 标签：android, onclick, touch

我有两个活动 A 和 B，现在在活动 A 中，当我单击该按钮时，我有一个按钮，我正在准备一个对象并移动到下一个屏幕以显示文本视图、图像视图等。

现在在活动 B 中，我对 Touch 有一些看法。

问题：如果我在 Activity A 中多次单击按钮，说两次或三次，那么即使在显示 Activiy B 之前，texview 上的 onTouch 事件也会被触发。

我也做`setEnabled(false);`了按钮，以便在按钮上单击一次。

如何解决这个问题？

# javascript - Javascript重定向和zend MVC

> ID：16092238
> 
> 赞同：0
> 
> 时间：2013-04-18T20:15:12.037
> 
> 标签：javascript, zend-framework, model-view-controller, redirect

谢谢你看这里。我正在尝试将 Zend 框架与 MVC 一起使用，但我遇到了有关链接的问题。

这是我用来重定向的javascript：

```
$("#liFoo").click(function(){
    window.location.replace('index/actionFoo);
}); 
```

单击链接时，它可以从 url 正常工作：`http://domain/`我被重定向到`http://domain/index/actionFoo`

但它不能从 : `http://domain/index/`（实际上与前一个页面相同）因为我被重定向到`http://domain/index/index/actionFoo`.

如果不使用完整的 url，我怎么能解决这个问题（我还不知道域......）？最好的方法是什么？

非常感谢，塞德里克。- 初学者

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:55:43.143

您只需要使用绝对路径（以 a`/`开头）：

```
$("#liFoo").click(function(){
    window.location = '/index/actionFoo';
}); 
```

# r - r - 如何根据因素组合向数据框添加行索引

> ID：16092239
> 
> 赞同：7
> 
> 时间：2013-04-18T20:15:18.433
> 
> 标签：r

我有一个这样的数据框：

```
df <- data.frame(
    Dim1 = c("A","A","A","A","A","A","B","B"),
    Dim2 = c(100,100,100,100,200,200,100,200),
    Value = sample(1:10, 8)
        )

  Dim1 Dim2 Value
1    A  100     3
2    A  100     6
3    A  100     7
4    A  100     4
5    A  200     8
6    A  200     9
7    B  100     2
8    B  200    10 
```

（Value 列只是为了说明每一行都是一个数据点；实际值并不重要。）最终，我想做的是根据 Dim1 和 Dim2 定义的子集中*的索引绘制值。*出于这个原因，我认为需要附加一个包含索引的新列，如下所示（在行之间添加空行以明确子集是什么）：

```
 Dim1 Dim2 Value Index
1    A  100     1     1
2    A  100     9     2
3    A  100     4     3
4    A  100    10     4

5    A  200     7     1
6    A  200     3     2

7    B  100     5     1

8    B  200     8     1 
```

我如何在 R 中优雅地做到这一点？我来自 Python，我的默认方法是对 Dim1 和 Dim2 的组合进行 for 循环，跟踪每个中的行数并将迄今为止遇到的最大值分配给每一行。我一直在试图弄清楚，但我的矢量符很弱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:20:21.210

这可能看起来像作弊，因为我将一个向量传递给一个函数，然后我完全忽略它，除了得到它的长度：

```
 df$Index <- ave( 1:nrow(df), df$Dim1, factor( df$Dim2), FUN=function(x) 1:length(x) ) 
```

该`ave`函数返回一个与其第一个参数长度相同但在由第一个参数和名为 的参数之间的所有因子定义的类别内计算的向量`FUN`。`unique() applies only to vectors`（我经常忘记在我的函数中输入“FUN=”并收到一条类似于

实际上还有另一种更紧凑的`function(x) 1:length(x)`使用`seq_along`函数的表达方式，它可能更安全，因为如果传递长度为零的向量，它会正确失败，而匿名函数形式会通过返回`1:0`而不是返回而错误地失败`numeric(0)`：

```
ave( 1:nrow(df), df$Dim1, factor( df$Dim2), FUN=seq_along ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T20:26:36.907

给你，使用`data.table`：

```
library(data.table)
df <- data.table(
    Dim1 = c("A","A","A","A","A","A","B","B"),
    Dim2 = c(100,100,100,100,200,200,100,200),
    Value = sample(1:10, 8)
        )

df[, index := seq_len(.N), by = list(Dim1, Dim2)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:27:07.970

这是你想要达到的目标吗？

```
library(ggplot2)
df <- data.frame(
  Dim1 = c("A","A","A","A","A","A","B","B"),
  Dim2 = c(100,100,100,100,200,200,100,200),
  Value = sample(1:10, 8)
)
df$index <- c(1,2,3,4,1,2,1,1)

ggplot(df,aes(x=index,y=Value))+geom_point()+facet_wrap(Dim1~Dim2) 
```

输出如下： ![在此处输入图像描述](https://i.stack.imgur.com/21sDX.png)

# ruby-on-rails - 随机独角兽超时和摆动

> ID：16092241
> 
> 赞同：4
> 
> 时间：2013-04-18T20:15:43.080
> 
> 标签：ruby-on-rails, nginx, timeout, unicorn

我在 Unicorn 和 Nginx（多个 Web 节点）上运行一个非常高流量的 Rails 3.2 应用程序，但每隔一段时间我就会看到 Unicorn 工作人员开始超时并在所有节点上被 Unicorn master sigkilled。当然，当 Unicorn 工人被 Unicorn 主人 sigkill 时，一个新工人会被分叉，但它也会挂起 60 秒然后超时并被杀死。这基本上会反复发生，直到我硬杀死所有独角兽大师和工人。

`Unicorn log:`

```
E, [2013-04-18T12:57:50.007623 #14002] ERROR -- : worker=8 PID:14968 timeout (62s > 60s), killing
E, [2013-04-18T12:57:50.108364 #14002] ERROR -- : reaped #<Process::Status: pid 14968 SIGKILL (signal 9)> worker=8
I, [2013-04-18T12:57:50.489505 #15726]  INFO -- : worker=8 ready
E, [2013-04-18T12:57:52.175842 #14002] ERROR -- : worker=5 PID:15033 timeout (61s > 60s), killing
E, [2013-04-18T12:57:52.276586 #14002] ERROR -- : reaped #<Process::Status: pid 15033 SIGKILL (signal 9)> worker=5
I, [2013-04-18T12:57:52.653069 #15782]  INFO -- : worker=5 ready
E, [2013-04-18T12:57:56.340290 #14002] ERROR -- : worker=3 PID:15074 timeout (61s > 60s), killing
E, [2013-04-18T12:57:56.440993 #14002] ERROR -- : reaped #<Process::Status: pid 15074 SIGKILL (signal 9)> worker=3
I, [2013-04-18T12:57:56.809730 #15832]  INFO -- : worker=3 ready
E, [2013-04-18T12:57:57.504142 #14002] ERROR -- : worker=7 PID:15087 timeout (61s > 60s), killing
E, [2013-04-18T12:57:57.604886 #14002] ERROR -- : reaped #<Process::Status: pid 15087 SIGKILL (signal 9)> worker=7
I, [2013-04-18T12:57:57.983581 #15845]  INFO -- : worker=7 ready
E, [2013-04-18T12:57:59.669664 #14002] ERROR -- : worker=4 PID:15108 timeout (61s > 60s), killing
E, [2013-04-18T12:57:59.770427 #14002] ERROR -- : reaped #<Process::Status: pid 15108 SIGKILL (signal 9)> worker=4
I, [2013-04-18T12:58:00.155461 #15879]  INFO -- : worker=4 ready
E, [2013-04-18T12:58:06.839906 #14002] ERROR -- : worker=9 PID:15192 timeout (61s > 60s), killing
E, [2013-04-18T12:58:06.940829 #14002] ERROR -- : reaped #<Process::Status: pid 15192 SIGKILL (signal 9)> worker=9
I, [2013-04-18T12:58:07.302766 #15956]  INFO -- : worker=9 ready
E, [2013-04-18T12:58:08.003330 #14002] ERROR -- : worker=6 PID:15213 timeout (61s > 60s), killing
E, [2013-04-18T12:58:08.104006 #14002] ERROR -- : reaped #<Process::Status: pid 15213 SIGKILL (signal 9)> worker=6
I, [2013-04-18T12:58:08.466790 #15973]  INFO -- : worker=6 ready 
```

监控系统显示外部服务（Postgres 数据库、Memcached、Redis）都在正常响应并且没有延迟问题。

以下是一些可能有价值的输出：

在这些中断期间，我注意到与 Unicorn 套接字的连接尝试大量积压。当站点未关闭时，通常以下命令仅返回一两行。

`netstat | grep unic`

```
....
unix  2      [ ]         STREAM     CONNECTING    0        /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTING    0        /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTING    0        /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTING    0        /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTING    0        /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7768134  /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7767311  /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7766999  /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7767309  /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7766941  /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7767287  /tmp/unicorn.sock
unix  2      [ ]         STREAM     CONNECTED     7766225  /tmp/unicorn.sock 
```

任何人都知道可能导致这种情况的原因是什么？这种情况同时发生在多台服务器上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:29:49.420

DDOS？在探索应用程序级别之前，我会确保您知道在网络级别发生了什么。当它工作时你有多少连接？没有的时候有多少？来自哪些 IP？等等

# php - 如何通过 php 从数据库中获取数据到 javascript 变量？

> ID：16092243
> 
> 赞同：0
> 
> 时间：2013-04-18T20:16:00.290
> 
> 标签：php, javascript, ajax, jquery

我有一个 jQuery UI 日期选择器。我想向该函数发送数据。我使用`.post`函数通过 PHP 文件从数据库中获取数据作为“数据”。我无法访问数据，因为数据返回到 .post 函数内部。我想要它到外部变量`dat`，以便我可以使用它。实际上数据是要禁用的日期。

我的代码：

```
$(function () {
    var dat = "";
    var unavailableDates = ["10-5-2013", "14-5-2011", "15-5-2011"];
    var dt = "id=1";
    $.post("fetch.php", dt, function (data) {});
    dat = data;

    function enableFirday(date) {
        dmy = date.getDate() + "-" + (date.getMonth() + 1) + "-" + date.getFullYear();
        var day = date.getDay();
        return [((day == 6 || day == 5 || day == 3) && $.inArray(dmy, unavailableDates) < 0), ''];
    }
    $("#d").datepicker({
        beforeShowDay: enableFirday
    });
}); 
```

在函数内部，第 3 行有一个变量`unavailableDates`。我想从我的数据库中获取一些日期并保存在该变量中。

我以为我可以用来`.post`从数据库中获取数据以便我可以使用。但是数据是从 PHP 文件返回的，而不是复制到变量`dat`中。从 PHP 文件返回的内容可以在 .post 函数内部使用，但不能在外部使用。如何将数据获取到`.post`函数之外。请帮助我。在我的项目中获取数据是非常有必要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:19:04.160

AJAX 调用（你的`$.post()`）ASYNCHRONOUS。您的 JS 代码将运行 .post() 函数，然后立即继续。除非您有一个非常快的网络链接，否则几乎不可能从 AJAX 调用返回响应并填充`data`变量。

这就是为什么 AJAX 调用带有一个回调处理程序，当响应来自服务器时，JS 会调用它，所以你的代码应该是

```
var dat;
$.post(url, dt, function(data) {
    dat = data;
    enableFirday(); // or whatever your code should do once you get a response.
}); 
```

# msbuild - MSBuild 认为在构建后事件完成之前已完成构建引用的项目

> ID：16092244
> 
> 赞同：1
> 
> 时间：2013-04-18T20:16:00.257
> 
> 标签：msbuild

我在解决方案中设置了一个 C# 项目和另一个 C# 项目作为项目参考。当我使用 MSBuild 参数“/m /p:buildinparallel=true”在构建服务器上构建解决方案时，依赖项目首先构建，但似乎在依赖项目的构建后事件期间，引用它的项目开始构建并失败，因为它找不到引用的程序集（因为我的构建后事件就地修改了引用的程序集，并且在该处理期间它不可用）。

我可以看到引用项目在被引用项目的程序集完成修改之前创建了它的 ProjName.csprojResolveAssemblyReference.cache 文件，到那时，它已经失败了。

当我使用“/m:1 /p:buildinparallel=false”在构建服务器上构建相同的解决方案时，构建成功，尽管我认为这不是一个好的解决方法，因为它会损害我的性能而且我不确定找到根本原因。

我可以做些什么，让 MSBuild 直到依赖项目的构建后事件完成*后才*开始依赖项目的构建？

使用 MSBuild 4.5。

# macos - 在 mdfind 中过滤“错误路径”结果

> ID：16092245
> 
> 赞同：2
> 
> 时间：2013-04-18T20:16:12.713
> 
> 标签：macos, shell, command-line, scripting

好的，所以我有一个脚本正在运行一个命令来获取文件名列表，但是其中一些可能实际上并不存在。我想做的是通过管道过滤此列表并删除任何实际不存在的文件名。

如果它有助于我使用的任何命令是 OS X 的 mdfind（Spotlight 搜索），给定一些搜索条件，它将快速返回匹配文件名的列表（实际上是绝对路径）；问题是 Spotlight 可能会返回一些垃圾结果，通常是“错误路径”，所以我需要过滤掉这些结果，以便将列表传递给另一个程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:27:52.493

尝试`mdfind`通过管道传递您的命令`grep`：

```
mdfind __your-query-args__ | grep -iv "bad path" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T22:41:48.760

假设你的 shell 是 bash：

```
result=()
mdfind ... | while IFS= read -r filename; do
  [[ -e $filename ]] && result+=("$filename")
done 
```

`IFS=`和`-r`位用于正确处理带有空格或转义字符的文件。

该数组`result`包含现有文件。将其用作带有`"${result[@]}"`（带引号）的列表或使用

```
for file in "${result[@]}"; do something "$file"; done 
```

# php - 如何使用 netbeans 选择 laravel 控制器进行测试

> ID：16092251
> 
> 赞同：3
> 
> 时间：2013-04-18T20:16:33.327
> 
> 标签：php, netbeans, laravel, xdebug

我正在使用 netbeans 7.3 来调试我的 laravel 3.2 项目。我无法让 xdebug 工作，因为它不会在断点处停止（顺便说一句，相同的设置适用于 codeigniter 项目，所以我不认为它是 IDE 或 xdebug）。

我在项目属性->运行配置对话框中设置了以下参数：

```
project URL: http://localhost/my_project/public/my_controller
index file: blank
arguments: blank 
```

它运行良好，只是 xdebug 不起作用。有人可以帮我让它工作吗？

我的开发堆栈是[http://www.easyphp.org/](http://www.easyphp.org/)。在底部的 php.ini 文件中，我有：

我刚刚通过量身定制的安装说明运行了我的 phpinfo，并得到了：

```
Tailored Installation Instructions

    Summary

    Xdebug installed: Only as PHP extension!
Server API: Apache 2.4 Handler Apache Lounge
Windows: yes - Compiler: MS VC9 - Architecture: x86
Zend Server: no
PHP Version: 5.4.6
Zend API nr: 220100525
PHP API nr: 20100525
Debug Build: no
Thread Safe Build: yes
Configuration File Path: C:\Windows
Configuration File: F:\EZPHP\apache\php.ini
Extensions directory: F:\EZPHP\php\php546x130301155435\ext
Instructions

Warning: You seem to have Xdebug loaded as a normal PHP extension only. This will cause odd issues, please see the FAQ entry on it.

Download
Move the downloaded file to F:\EZPHP\php\php546x130301155435\ext
Edit F:\EZPHP\apache\php.ini and add the line
zend_extension = F:\EZPHP\php\php546x130301155435\ext\
Restart the webserver 
```

我试过这个，但我注意到它没有说明要下载哪个版本。我下载了 32 位线程安全版本，现在在 php.ini 的底部：

```
Xdebug
;zend_extension = "${path}\php\php546x130301155435\php_xdebug-2.2.1-5.4-vc9.dll"
zend_extension = "F:\EZPHP\php\php546x130301155435\ext\php_xdebug-2.2.2-5.4-vc9.dll"
xdebug.default_enable=0
xdebug.remote_enable=1
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9000
xdebug.remote_handler=dbgp
xdebug.remote_mode=req
xdebug.remote_autostart = false
xdebug.dump_globals=1
xdebug.dump=COOKIE,FILES,GET,POST,REQUEST,SERVER,SESSION
xdebug.dump.SERVER=REMOTE_ADDR,REQUEST_METHOD,REQUEST_URI
xdebug.show_local_vars=1
xdebug.show_mem_delta=1
xdebug.collect_includes=1
xdebug.collect_vars=1
xdebug.collect_params=4
xdebug.collect_return=1
xdebug.auto_trace=0
xdebug.trace_options=0
xdebug.trace_format=0
xdebug.trace_output_dir="${path}\xdebug\trace"
xdebug.trace_output_name="trace.%t"
xdebug.profiler_enable=0
xdebug.profiler_append=1
xdebug.profiler_enable_trigger=1
xdebug.profiler_output_dir="${path}\xdebug\profiler"
xdebug.profiler_output_name="cachegrind.out.%s.%t"
;/Xdebug    

;PHPExt 
extension=php_bz2.dll
extension=php_curl.dll
;extension=php_fileinfo.dll
extension=php_gd2.dll
;extension=php_gettext.dll
;extension=php_gmp.dll
;extension=php_intl.dll
;extension=php_imap.dll
;extension=php_interbase.dll
;extension=php_ldap.dll
extension=php_mbstring.dll
;extension=php_exif.dll
extension=php_mysql.dll
extension=php_mysqli.dll
;extension=php_oci8.dll
;extension=php_oci8_11g.dll
extension=php_openssl.dll
;extension=php_pdo_firebird.dll
extension=php_pdo_mysql.dll
;extension=php_pdo_oci.dll
;extension=php_pdo_odbc.dll
;extension=php_pdo_pgsql.dll
extension=php_pdo_sqlite.dll
;extension=php_pgsql.dll
;extension=php_pspell.dll
;extension=php_shmop.dll
;extension=php_snmp.dll
;extension=php_soap.dll
extension=php_sockets.dll
;extension=php_sqlite.dll
extension=php_sqlite3.dll
;extension=php_sybase_ct.dll
;extension=php_tidy.dll
;extension=php_xmlrpc.dll
extension=php_xsl.dll
extension=php_yaz.dll
;/PHPExt 
```

按照指示，在我的文档根目录中放置一个文件，其中包含

```
Configuration File (php.ini) Path  C:\Windows  
Loaded Configuration File  F:\EZPHP\apache\php.ini 
```

作为补充说明，我刚刚发现当我在 xdebug_break() 中硬编码时它会中断

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T18:27:37.287

您确定您正在查看使用的 .ini 文件吗？创建一个 php 文件并添加`<?php phpinfo();`在浏览器中打开它并查看顶部（在顶部块中的“加载的配置文件”和“已解析的其他 .ini 文件”下列出）以获取正在使用的活动 .ini 文件。

然后打开该文件，搜索 xdebug 并注释掉或删除任何具有`extension=php_xdebug.dll`.

还请通过在此处粘贴和提交 phpinfo() 的内容来验证您是否已正确安装 xdebug：http: [//xdebug.org/find-binary.php](http://xdebug.org/find-binary.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T12:22:48.950

打开您的 php.ini 文件并通过输入注释 php_xdebug.dll ; 在它面前。所以它看起来像这样：

```
;extension=php_xdebug.dll 
```

# java - Spring应用程序中dao中的泛型类型

> ID：16092252
> 
> 赞同：0
> 
> 时间：2013-04-18T20:16:41.507
> 
> 标签：java, spring, mongodb, generics, morphia

我正在尝试使用 morphia 框架启动 spring 应用程序以创建一些与 mongodb 一起使用的 web 应用程序

好吧，我有一些抽象实体

```
public abstract class AbstractEntity {
    @Id
    protected ObjectId id;
    // getters, setters
} 
```

我也有这个抽象实体的一些抽象道

```
public abstract class AbstractDao<T extends AbstractEntity> extends BasicDAO<T, ObjectId> {
    protected AbstractDao(Mongo mongo, Morphia morphia, String dbName) {
        super(mongo, morphia, dbName);
    }
    //some methods
} 
```

我也有一些抽象动作

```
public abstract class AbstractAction {
    protected ActionType actionType;
    protected int dynamicWeight;
    protected Date createDate;
    // getters, setters
} 
```

我有一些更具体的实体，比如存储在列表中的一些动作的动作实体

```
public abstract class ActionEntity<T extends AbstractAction> extends AbstractEntity {
    protected List<T> actions;
    // getters, setters
} 
```

动作可以是喜欢、评论等，它们有自己的类，比如

```
public class LikeAction extends AbstractAction implements ICombinable { 
    protected ObjectId authorId;
    protected ObjectId sourceId;
    //getters, setters and overrided equals();
} 
```

最后，我有存储例如喜欢的实体

```
public class LikeActionEntity extends ActionEntity<LikeAction> {    
} 
```

以及此类实体的 da

```
public class LikeActionDao extends AbstractDao<LikeActionEntity> {
    protected LikeActionDao(Mongo mongo, Morphia morphia, String dbName) {
        super(mongo, morphia, dbName);
    }   
} 
```

在应用程序上下文中，我有这样的 bean

```
<bean class="com.foo.app.dao.action.LikeActionDao" id="likeActionDao">
    <constructor-arg ref="mongo" index="0"/>
    <constructor-arg ref="morphia" index="1"/>
    <constructor-arg ref="database" index="2"/>
</bean>
<bean class="com.mongodb.Mongo" id="mongo">
    <constructor-arg value="127.0.0.1:27017" index="0" />
</bean>
<bean id="morphia" class="com.google.code.morphia.Morphia" />
<bean class="java.lang.String" id="database">
    <constructor-arg value="database" />
</bean> 
```

但是当我尝试运行 spring 应用程序时，我得到下一个异常

线程“主”org.springframework.beans.factory.BeanCreationException 中的异常：在类路径资源 [app-config.xml] 中定义名称为“likeActionDao”的 bean 创建错误：bean 的实例化失败；嵌套异常是 org.springframework.beans.BeanInstantiationException：无法实例化 bean 类 [com.foo.app.dao.action.LikeActionDao]：构造函数抛出异常；嵌套异常是 java.lang.RuntimeException: bad type, not parameterized...

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:17:12.810

似乎这是morhia[问题](https://code.google.com/p/morphia/issues/detail?can=2&q=244&colspec=ID%20Type%20Stars%20Status%20Priority%20Milestone%20Owner%20Summary&id=244)

尽量不要使用 AbstractDao 并直接从 BasicDAO 扩展您的 LikeActionDao。还尝试使 LikeActionEntity 不参数化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:05:41.167

您拥有的配置文件缺少数据库的配置。，

```
<bean class="java.lang.String" id="database">
     <constructor-arg value="database" /> </bean> 
```

您可能想为它定义一些值。

# python - 使用 RhinoPython 将面添加到现有网格

> ID：16092256
> 
> 赞同：0
> 
> 时间：2013-04-18T20:16:49.277
> 
> 标签：python, rhino3d

我正在使用 RhinoPython 和 RhinoCommon 来尝试将面添加到现有网格。一切似乎都正常，但创建的面与我选择的点不在同一个位置。有人可以解释为什么所选点的索引号似乎不是正确的吗？

```
import rhinoscriptsyntax as rs
import Rhino
import scriptcontext
import rhinoscript.utility as rhutil

def AddVertices(me):
    """Add face to a mesh"""
    mesh=rhutil.coercemesh(me)

    #select the vertices
    go=Rhino.Input.Custom.GetObject()
    go.GeometryFilter=Rhino.DocObjects.ObjectType.MeshVertex
    go.SetCommandPrompt("Get mesh vertex")
    go.GetMultiple(3,4)
    objrefs = go.Objects()
    point=[item.GeometryComponentIndex.Index for item in objrefs]
    go.Dispose()

    if len(point)==4:
        mesh.Faces.AddFace(point[0], point[1], point[2], point[3])
    else:
        mesh.Faces.AddFace(point[0], point[1], point[2])
    #replace mesh delete point
    scriptcontext.doc.Objects.Replace(me,mesh)
    mesh.Dispose()
    scriptcontext.doc.Views.Redraw()

if( __name__ == "__main__" ):
    me=rs.GetObject("Select a mesh to add face")
    AddVertices(me) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:16:49.277

这是因为从“get”操作返回的是 MeshTopologyVertex 而不是 MeshVertex。MeshTopologyVertex 表示一个或多个网格顶点，这些顶点恰好在空间中共享相同的位置。这是因为每个顶点都有一个顶点法线。想想网箱中的一个角落。该角具有三个具有不同顶点法线的面，因此该角有三个网格顶点，但只有一个 MeshTopologyVertex。我已调整脚本以改用顶点索引。

```
import rhinoscriptsyntax as rs
import Rhino
import scriptcontext
import rhinoscript.utility as rhutil

def AddVertices(me):
    """Add face to a mesh"""
    mesh=rhutil.coercemesh(me)

    #select the vertices
    go=Rhino.Input.Custom.GetObject()
    go.GeometryFilter=Rhino.DocObjects.ObjectType.MeshVertex
    go.SetCommandPrompt("Get mesh vertex")
    go.GetMultiple(3,4)
    objrefs = go.Objects()
    topology_indices=[item.GeometryComponentIndex.Index for item in objrefs]
    go.Dispose()

    point = []
    for index in topology_indices:
        # in many cases there are multiple vertices in the mesh
        # for a single topology vertex. Just pick the first one
        # in this sample, you will probably have to make a better
        # decision that this for your specific case
        vertex_indices = mesh.TopologyVertices.MeshVertexIndices(index)
        point.append(vertex_indices[0])

    if len(point)==4:
        mesh.Faces.AddFace(point[0], point[1], point[2], point[3])
    else:
        mesh.Faces.AddFace(point[0], point[1], point[2])
    #replace mesh delete point
    scriptcontext.doc.Objects.Replace(me,mesh)
    mesh.Dispose()
    scriptcontext.doc.Views.Redraw()

if( __name__ == "__main__" ):
    me=rs.GetObject("Select a mesh to add face")
    AddVertices(me) 
```

# kendo-ui - 将“数据标题”应用于 Kendo UI Grid TD？

> ID：16092258
> 
> 赞同：0
> 
> 时间：2013-04-18T20:16:53.010
> 
> 标签：kendo-ui, html-table, kendo-grid

我正在使用 KendoUI Grid，它很棒，但它在移动设备上响应不佳，所以我正在寻找实现这个[响应式数据表的想法](http://css-tricks.com/responsive-data-tables/)。它基本上隐藏了标题，使所有单元格显示：阻止它们堆叠，然后在 td 的左侧创建一个人造标题`td:before{content:"td header title"}`。

唯一的事情是，这将适用于许多具有未知主题字段的不同表，所以我不能这样做

```
td:nth-of-type(1):before { content: "First Name"; }
td:nth-of-type(2):before { content: "Last Name"; }
td:nth-of-type(3):before { content: "Job Title"; }
etc 
```

理想情况下，我会将标题列标题应用于 TD，以便它呈现`<td data-title="headerTitle">data</td>`. 然后在 CSS 中，我可以这样做：

```
td:before { content: attr(data-title); } 
```

这将完美地工作，但我不确定它是否可能。也许其他人有其他想法。

[JS小提琴链接](http://jsfiddle.net/TpJyu/2/)

前任：`<td data-title="name">Jane</td>`

**编辑：**看起来我要使用 jQuery 解决方案：

```
function tableResizer() {
    var headerTitleArray = [];

    // create array of table header titles
    $('.k-grid-header-wrap th').each(function () {
        headerTitleArray.push($(this).attr('data-title'));
    });

    // append tables headers to each td
    $('.k-grid-content tr').each(function () {
        $(this).find('td').each(function (i) {
            if (typeof headerTitleArray[i] !== 'undefined') { // some headers don't have a title
                $(this).prepend('<span class="td-title">' + headerTitleArray[i] + '</span>');
            }
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:52:45.830

我认为您应该使用 javascript 来执行此操作，例如：

```
$("td").each(function() {
    $(this).prepend("<span class='before'>" + $(this).data('title') + "</span>");
}); 
```

并以班级`before`风格为您的`td:before`...

看到这个小提琴：http: [//jsfiddle.net/TpJyu/4/](http://jsfiddle.net/TpJyu/4/)

# c# - FirstOrDefault() 的性能

> ID：16092263
> 
> 赞同：7
> 
> 时间：2013-04-18T20:17:04.290
> 
> 标签：c#, .net, linq

查看我今天使用性能分析器处理的 web 应用程序的一部分。我认为联合导致了一些延迟，但发现了其他令人惊讶的结果。

放缓的原因之一似乎是 FirstOrDefault。

这是一个非常简单的 LINQ 查询，如下所示：

```
foreach(Report r in reports)
    IDTOStudy study = studies.FirstOrDefault(s => s.StudyID == r.StudyID); 
```

我创建了一个小方法来复制我认为 FirstOrDefault 正在做的行为。

```
private IDTOStudy GetMatchingStudy(Report report, IList<IDTOStudy> studies)
{
    foreach (var study in studies)
    if (study.StudyID == report.StudyID)
        return study;

    return null;
} 
```

这个方法替换了 FirstOrDefault 看起来像这样：

```
foreach(Report r in reports)
    IDTOStudy study = GetMatchingStudy(r, studies); 
```

查看使用性能分析器运行的新代码显示`FirstOrDefault`完成的时间是我的新方法的两倍。看到这真是令人震惊。

我必须对`FirstOrDefault()`查询做一些不正确的事情。它是什么？

是否`FirstOrDefault()`完成整个查询然后获取第一个元素？

我怎样才能加快速度和使用`FirstOrDefault()`？

编辑1：

我注意到的另一点是分析器说我在这两种实现中都在最大限度地利用我的 CPU。这也是我不关心和没想到的事情。我添加的附加方法并没有减少该峰值，只是将其持续时间缩短了一半。

编辑3：

将研究放入字典极大地改善了运行时间。这肯定是提交代码的外观。虽然没有回答关于 FirstOrDefault 的问题。

编辑2：

这是一个简单的控制台应用程序中请求的示例代码。我的运行仍然表明，在大多数情况下，FirstOrDefault 需要更长的时间。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Reactive.Linq;
using System.Reactive.Concurrency;
using System.Diagnostics;

namespace TestCode
{
    public class Program
    {
        public List<IntHolder> list;

        public static void Main(string[] args)
        {
            var prog = new Program();
            prog.list = new List<IntHolder>();

            prog.Add50000Items();
            prog.list.Add(new IntHolder() { Num = 12345 });
            prog.Add50000Items();

            var stopwatch = new Stopwatch();
            stopwatch.Start();
            prog.list.FirstOrDefault(n => n.Num == 12345);
            stopwatch.Stop();

            Console.WriteLine("First run took: " + stopwatch.ElapsedTicks);
            var lookingFor = new IntHolder() { Num = 12345 };

            stopwatch.Reset();
            stopwatch.Start();
            prog.GetMatching(lookingFor);
            stopwatch.Stop();
            Console.WriteLine("Second run took: " + stopwatch.ElapsedTicks);
            Console.ReadLine();
        }

        public void Add50000Items()
        {
            var rand = new Random();

            for (int i = 0; i < 50000; i++)
                list.Add(new IntHolder() { Num = rand.Next(100000) });
        }

        public IntHolder GetMatching(IntHolder num)
        {
            foreach (var number in list)
                if (number.Num == num.Num)
                    return number;

            return null;
        }
    }

    public class IntHolder
    {
        public int Num { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:28:01.790

我认为正在发生的事情（尽管获得有关您的特定场景的一些额外信息会很好，但我的假设是这是基于您的 DTO 类的数据库场景）如下：

```
foreach(Report r in reports)
    IDTOStudy study = studies.FirstOrDefault(s => s.StudyID == r.StudyID); //Database query happens here for each report

//The whole studies table is loaded into memory which means you only do one DB query and the actual firstordefault stuff is done in memory which is quicker than going over the network
private IDTOStudy GetMatchingStudy(Report report, IList<IDTOStudy> studies)
{
    foreach (var study in studies)
    if (study.StudyID == report.StudyID)
        return study;

    return null;
} 
```

这意味着在第二个示例中，您已经针对数据库往返进行了优化（这是一个好主意）。

您可以通过使用 SQL Profiler 之类的工具检查幕后发生的数据库查询来证明这一理论

# eclipse - 是否可以从命令行运行集成到 Eclipse 中的 Maven 版本？

> ID：16092267
> 
> 赞同：4
> 
> 时间：2013-04-18T20:17:16.917
> 
> 标签：eclipse, maven, m2eclipse

我安装了带有 m2eclipse 插件的 Eclipse。我想从命令行运行 Maven。是否可以使用与 Eclipse 集成的版本来执行此操作，还是必须单独安装 Maven？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:53:37.907

当 Maven 在 Eclipse 中构建某些东西时，如果您在构建结束之前在终端中运行以下命令

```
sudo ps aux | grep java 
```

你会看到这是 Eclipse 用来运行 Maven 的命令：

```
/usr/lib/jvm/java-7-oracle/bin/java -Dmaven.home=EMBEDDED -Dclassworlds.conf=/home/a/dev/workspace/.metadata/.plugins/org.eclipse.m2e.core/launches/m2conf4172661110787200776.tmp -Dfile.encoding=UTF-8 -classpath /home/a/dev/eclipse_indigo/configuration/org.eclipse.osgi/bundles/870/1/.cp/jars/plexus-classworlds-2.4.jar org.codehaus.plexus.classworlds.launcher.Launcher -B install 
```

然后，基本上你的问题的答案是**“否”**，但如果你的目标是运行完全相同的 Maven 版本（不一定是相同的 Maven），你可以这样做：

首先，发现 Eclipse 使用的 Maven 版本：

*   运行 -> 运行配置 -> 创建一个 Maven 构建
*   在“目标：”中输入 -version
*   选择任何基本目录（可以是工作区中的任何 Maven 项目）
*   跑
*   您的 Eclipse 控制台将显示它正在使用的 Maven 版本

然后，您需要做的就是下载相同的 Maven 版本并确保 Eclipse 和您单独的 Maven 使用**相同的 settings.xml**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:35:35.207

您必须安装 CLI 版本。该插件不提供特定于平台的启动器，例如`mvn`或`mvn.bat`.

# sql-server-2008 - 如果一条记录包含 NULL，则排除特定 ID 的所有记录

> ID：16092268
> 
> 赞同：2
> 
> 时间：2013-04-18T20:17:17.263
> 
> 标签：sql-server-2008

如何排除与具有`null`值的行对应的所有行？

```
-----------------------------------
| 0000139 | null | 10-01-2012 |
----------------------------------
| 0000139 | 95 | 10-02-2012 |
----------------------------------- 
```

我不仅想排除带有 null 的行，还想排除所有其他行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:24:46.790

```
;WITH x AS (SELECT key FROM dbo.table WHERE some_column IS NULL)
  SELECT col1, col2, etc.
  FROM dbo.table AS t
  WHERE NOT EXISTS (SELECT 1 FROM x WHERE key = t.key); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:41:34.593

下面的代码标识了至少一个测试分数为 NULL 的所有孩子，并将他们排除在查询结果之外。

```
CREATE TABLE #Test
    ( KidId INT NOT NULL
    , Score INT NULL);

INSERT INTO #Test (KidId, Score)
SELECT KidId
    , Score
FROM (VALUES
        (1, 100), (1, 50), (1, 10)
    , (2, NULL), (2, NULL), (2, NULL)
    , (3, 100), (3, NULL), (3, 40)) sub (KidId, Score);

SELECT *
FROM #Test trgt
WHERE NOT EXISTS
    (SELECT 1
    FROM #Test src
    WHERE trgt.KidId = src.KidId
    AND src.Score IS NULL); 
```

# php - 使用 PHP，如何让多个 shell 命令同时运行？

> ID：16092275
> 
> 赞同：1
> 
> 时间：2013-04-18T20:17:44.833
> 
> 标签：php, shell, exec, multiple-instances

我有一个项目，用户可以在其中上传音频和视频文件。上传这些文件时，它们会在服务器端使用 ffmpeg 进行处理。但是，我注意到多个转换不会同时运行。例如，如果我上传视频，然后在处理视频时上传音频，一旦上传音频，它就会停止并等待视频完成处理，然后再处理音频。

在另一个 SO question 中，我注意到一个叫做“nohup”的东西。我不知道这是什么，但根据帖子，在我看来，它允许命令运行而无需让 PHP 脚本等待它。这不是我想要的结果。我需要当前的 PHP 脚本来等待进程完成。但是我希望能够同时触发其他进程（当然不是使用相同的运行脚本）。

# ruby-on-rails - 控制器未保存属性（来自 FB 的 Oauth 令牌）

> ID：16092278
> 
> 赞同：0
> 
> 时间：2013-04-18T20:17:49.383
> 
> 标签：ruby-on-rails, omniauth

奇怪的问题——我的一个控制器中的创建操作没有保存属性——查看下面的代码。所有的行都工作到最后 2 行。 the`oauth_token`和 the`oauth_expires_at`没有被保存。我检查了属性是否正确命名，等等。有趣的是，如果我将倒数第二行更改为：

`omniauth['credentials']['token'] ? provider = omniauth['credentials']['token'] : provider = ''`

它工作得很好。实际属性`oauth_token`和`oauth_expires_at`. 然后我尝试创建 2 个新的虚拟属性以查看它是否可以在那里工作 - 不能。似乎之后创建的任何属性`oauth_token`都搞砸了。这是迁移问题吗？有任何想法吗？

```
def create
    params[:authorization] ? authorization_route = params[:authorization] : authorization_route = 'no authorization (invalid callback)'

    omniauth = request.env["omniauth.auth"]
    if omniauth and params[:authorization]
        if authorization_route == "facebook"
              omniauth['extra']['raw_info']['email'] ? email =  omniauth['extra']['raw_info']['email'] : email = ''
              omniauth['extra']['raw_info']['name'] ? name =  omniauth['extra']['raw_info']['name'] : name = ''
              omniauth['extra']['raw_info']['id'] ?  uid =  omniauth['extra']['raw_info']['id'] : uid = ''
              omniauth['provider'] ? provider =  omniauth['provider'] : provider = ''
              omniauth['credentials']['token'] ? oauth_token =  omniauth['credentials']['token'] : oauth_token = ''
              omniauth['credentials']['expires_at'] ? oauth_expires_at =  Time.at(omniauth['credentials']['expires_at']) : oauth_expires_at = ''
end
   end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:28:10.897

我不确定这是否是您的问题，但我使用三元 ( `condition ? value : other_value`) 语法的方式是非典型的。通常，你会写类似

```
def create
  authorization_route = params[:authorization] ? params[:authorization] : 'no authorization (invalid callback)'

  omniauth = request.env["omniauth.auth"]
  if omniauth and params[:authorization]
    if authorization_route == "facebook"
      email = omniauth['extra']['raw_info']['email'] ? omniauth['extra']['raw_info']['email'] : ''
      name = omniauth['extra']['raw_info']['name'] ? omniauth['extra']['raw_info']['name'] : ''
      uid = omniauth['extra']['raw_info']['id'] ? omniauth['extra']['raw_info']['id'] : ''
      provider = omniauth['provider'] ? omniauth['provider'] : ''
      oauth_token = omniauth['credentials']['token'] ? omniauth['credentials']['token'] : ''
      oauth_expires_at = omniauth['credentials']['expires_at'] ? Time.at(omniauth['credentials']['expires_at']) : ''
    end
  end
  # ...
end 
```

但是，由于您使用它来执行此操作，因此您可以通过对除最后一个以外的所有操作`attribute = value ? value : default`使用 or () 操作符来进一步简化它：`||`

```
def create
  authorization_route = params[:authorization] || 'no authorization (invalid callback)'

  omniauth = request.env["omniauth.auth"]
  if omniauth and params[:authorization]
    if authorization_route == "facebook"
      email = omniauth['extra']['raw_info']['email'] || ''
      name = omniauth['extra']['raw_info']['name'] || ''
      uid = omniauth['extra']['raw_info']['id'] || ''
      provider = omniauth['provider'] || ''
      oauth_token = omniauth['credentials']['token'] || ''
      oauth_expires_at = omniauth['credentials']['expires_at'] ? Time.at(omniauth['credentials']['expires_at']) : ''
    end
  end
  # ...
end 
```

但是，所有这三种方法都可以工作，因此要么`omniauth['credentials']['token']`不是正确的哈希键，要么你正在使用的任何东西`oauth_token`以及`oauth_expires_at`稍后在控制器或模型中进行的操作都会导致问题。

您可以编辑您的问题以包含来自控制器和用户模型的更多代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:34:40.970

我很尴尬地承认问题实际上是什么：

完全忘记了我后来在控制器中所做的事情。一定要爱粗心的错误...

不得不改变：

```
user.authorizations.build(:provider => provider, :uid => uid, :name => name, :email => email, :user_id => user.id) 
```

到：

```
user.authorizations.build(:provider => provider, :uid => uid, :name => name, :email => email, :user_id => user.id, :oauth_token => oauth_token, :oauth_expires_at => oauth_expires_at) 
```

# php - 将找到替换 %{variable_name}% 的 PHP 脚本

> ID：16092286
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:18:30.453
> 
> 标签：php, variables

我见过系统使用您`%{variable_name}%`在文本中输入的方法（比如说存储在数据库中或发送大量电子邮件），当页面加载时，它会找到`%{variable_name}`并用另一段代码/字符串替换它。

例如，在向邮件列表发送大量电子邮件时：`Hello %{name}%`，这是一封电子邮件......当点击提交时，它会发送电子邮件，除了它将是......“你好 John Doe，这是一封电子邮件”......

我搜索了谷歌并找不到它，因为我也不知道它叫什么。我刚刚在代码中看到了这一点，我目前正在编写一个非常有用的代码。

如果有人能告诉我它叫什么，要搜索什么，或者一个如何实现它的例子，那就太好了。

（如果我把错误的标签放在这里，请改成正确的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:21:36.267

我成功地使用了这种方法：

```
 $message = str_replace('[NAME]', $name, $message); 
```

因此，`[NAME]`例如，大量电子邮件被替换为`$name`

如果您更喜欢您所拥有的语法，则将`%{NAME}%`其替换为 by 的内容`$name`：

```
$message = str_replace('%{NAME}%', $name, $message); 
```

您可以根据需要多次重做，例如您要添加特定链接和电子邮件地址：

```
$message = str_replace('%{NAME}%', $name, $message);
$message = str_replace('%{LINK}%', $link, $message);
$message = str_replace('%{EMAIL}%', $email, $message); 
```

参考： http: [//php.net/manual/en/function.str-replace.php](http://php.net/manual/en/function.str-replace.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:30:30.073

您可以使用 str_replace： http: [//php.net/manual/en/function.str-replace.php](http://php.net/manual/en/function.str-replace.php)

```
 <?php
        $string = "Your %variable_name% sentence..";
        $new_string = str_replace("%variable_name%", "beautiful", $string>");
    ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:35:20.890

我为你写了一个类：

```
class templatevars{
    private static $vars=array();
    public static function set($var,$val){
        self::$vars["%{".$var."}%"]=$val;
    }
    public static function replace($text){
        return str_replace(array_keys(self::$vars),array_values(self::$vars),$text);
    }
} 
```

用法：

```
templatevars::set("varname","text to insert");
templatevars::set("varname2","other text to insert");
echo templatevars::replace("First: %{varname}% Second: %{varname2}%"); 
```

如果您想要多个替换器，请从类中删除所有静态分类器，并且：

```
$replacer_1=new templatevars();
$replacer_1->set("var","text");
$result=$replacer_1->replace($text_source); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T20:29:55.577

在 PHP.net 上找到了这个

[str_replace](http://php.net/manual/en/function.str-replace.php)

# javascript - jquery ui datepicker上的日期范围选择器

> ID：16092288
> 
> 赞同：18
> 
> 时间：2013-04-18T20:18:47.777
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-datepicker, date-range

我使用 jquery ui 创建了一个日期范围选择器，您可以在其中使用相同的内联日历来进行两个日期选择。

在这里查看我的小提琴：http: [//jsfiddle.net/kVsbq/4/](http://jsfiddle.net/kVsbq/4/)

JS

```
$(".datepicker").datepicker({
    minDate: 0,
    numberOfMonths: [12, 1],
    beforeShowDay: function (date) {
        var date1 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input1").val());
        var date2 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input2").val());
        return [true, date1 && ((date.getTime() == date1.getTime()) || (date2 && date >= date1 && date <= date2)) ? "dp-highlight" : ""];
    },
    onSelect: function (dateText, inst) {
        var date1 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input1").val());
        var date2 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input2").val());
        if (!date1 || date2) {
            $("#input1").val(dateText);
            $("#input2").val("");
            $(this).datepicker();
        } else {
            $("#input2").val(dateText);
            $(this).datepicker();
        }
    }
}); 
```

我想要做的是这样的范围选择器：http: [//jsfiddle.net/D3wLX/1/](http://jsfiddle.net/D3wLX/1/)

如果您选择较早的日期，则较早的日期会自动成为范围内的第一个日期，中间日期会突出显示。现在在我原来的 jquery ui 解决方案中，它只会将较早的日期放在第二个输入中，而不是突出显示两者之间的日期。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-07-10T16:51:58.467

你的剧本正是我想要的。我把你原来的小提琴分叉了，只对你的 onSelect 做了一点调整，让它按照你想要的方式工作。

```
onSelect: function(dateText, inst) {
    var date1 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input1").val());
    var date2 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input2").val());
    var selectedDate = $.datepicker.parseDate($.datepicker._defaults.dateFormat, dateText);

    if (!date1 || date2) {
        $("#input1").val(dateText);
        $("#input2").val("");
        $(this).datepicker();
    } else if( selectedDate < date1 ) {
        $("#input2").val( $("#input1").val() );
        $("#input1").val( dateText );
        $(this).datepicker();
    } else {
        $("#input2").val(dateText);
        $(this).datepicker();
    }
} 
```

原始部分中缺少的只是将当前选定的日期值与已捕获的日期值进行比较的检查。

这是我的分叉小提琴：http: [//jsfiddle.net/sWbfk/](http://jsfiddle.net/sWbfk/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-19T20:25:50.210

我在这里找到了答案：

~~[http://www.benknowscode.com/2012/11/selecting-ranges-jquery-ui-datepicker.html](http://www.benknowscode.com/2012/11/selecting-ranges-jquery-ui-datepicker.html)~~（该网站似乎已被黑客入侵）

很棒的教程

```
$.datepicker._defaults.onAfterUpdate = null;
var datepicker__updateDatepicker = $.datepicker._updateDatepicker;
$.datepicker._updateDatepicker = function( inst ) {
   datepicker__updateDatepicker.call( this, inst );
   var onAfterUpdate = this._get(inst, 'onAfterUpdate');
   if (onAfterUpdate)
      onAfterUpdate.apply((inst.input ? inst.input[0] : null),
         [(inst.input ? inst.input.val() : ''), inst]);
}
$(function() {
   var cur = -1, prv = -1;
   $('#jrange div')
      .datepicker({
            //numberOfMonths: 3,
            changeMonth: true,
            changeYear: true,
            showButtonPanel: true,
            beforeShowDay: function ( date ) {
                  return [true, ( (date.getTime() >= Math.min(prv, cur) && date.getTime() <= Math.max(prv, cur)) ? 'date-range-selected' : '')];
               },
            onSelect: function ( dateText, inst ) {
                  var d1, d2;
                  prv = cur;
                  cur = (new Date(inst.selectedYear, inst.selectedMonth, inst.selectedDay)).getTime();
                  if ( prv == -1 || prv == cur ) {
                     prv = cur;
                     $('#jrange input').val( dateText );
                  } else {
                     d1 = $.datepicker.formatDate( 'mm/dd/yy', new Date(Math.min(prv,cur)), {} );
                     d2 = $.datepicker.formatDate( 'mm/dd/yy', new Date(Math.max(prv,cur)), {} );
                     $('#jrange input').val( d1+' - '+d2 );
                  }
               },
            onChangeMonthYear: function ( year, month, inst ) {
                  //prv = cur = -1;
               },
            onAfterUpdate: function ( inst ) {
                  $('<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">Done</button>')
                     .appendTo($('#jrange div .ui-datepicker-buttonpane'))
                     .on('click', function () { $('#jrange div').hide(); });
               }
         })
      .position({
            my: 'left top',
            at: 'left bottom',
            of: $('#jrange input')
         })
      .hide();
   $('#jrange input').on('focus', function (e) {
         var v = this.value,
             d;
         try {
            if ( v.indexOf(' - ') > -1 ) {
               d = v.split(' - ');
               prv = $.datepicker.parseDate( 'mm/dd/yy', d[0] ).getTime();
               cur = $.datepicker.parseDate( 'mm/dd/yy', d[1] ).getTime();
            } else if ( v.length > 0 ) {
               prv = cur = $.datepicker.parseDate( 'mm/dd/yy', v ).getTime();
            }
         } catch ( e ) {
            cur = prv = -1;
         }
         if ( cur > -1 )
            $('#jrange div').datepicker('setDate', new Date(cur));
         $('#jrange div').datepicker('refresh').show();
      });
});
```

```
.wrapper {
   height: 600px;
}
#jrange input {
   width: 200px;
}
#jrange div {
   font-size: 9pt;
}
.date-range-selected > .ui-state-active,
.date-range-selected > .ui-state-default {
   background: none;
   background-color: lightsteelblue;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<div class="wrapper">
   <div id="jrange" class="dates">
    <input />
    <div></div>
   </div>
</div>
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-10-13T01:26:30.220

我还在寻找一种方法来扩展 Datepicker jQuery 插件以利用 Bootstrap 样式并遇到了这个小宝石：

Dan Grossman 的[Bootstrap-Date Range Picker展示了一些带有工作代码的实时示例。](http://www.daterangepicker.com/)

这里也是项目[GitHub](https://github.com/dangrossman/bootstrap-daterangepicker)。

最后，这是设计的简单性和强大功能的屏幕截图：

[![截屏](https://i.stack.imgur.com/Qd8dm.png)](https://i.stack.imgur.com/Qd8dm.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-12T16:01:37.747

伙计，你的代码真的是我需要的！

在 Jamie Layne 的修正下，我决定用它来做一个插件。

这是 jsfiddle 的链接：http: [//jsfiddle.net/dxLRm/35/](http://jsfiddle.net/dxLRm/35/)（链接更新于 2014/01/01）

由于我必须显示一些代码，因此我拥有以下内容：

```
(function ($) {
$.prototype.rangedatepicker = function (o,x,y) {
    var dp = $.datepicker,
        cl = dp.markerClassName,
        di = 'data-rdp-i',
        df = 'data-rdp-f';

    switch(o)
    {
        case 'option':
            return $(this).datepicker('option');
        case 'hide':
            return $(this).datepicker('hide');
        case 'show':
            return $(this).datepicker('show');
        case 'getInitialDate':
            return dp.parseDate($(this).eq(0).datepicker('option','dateFormat'),$(this).eq(0).attr(di)||'');
        case 'getFinalDate':
            return dp.parseDate($(this).eq(0).datepicker('option','dateFormat'),$(this).eq(0).attr(df)||'');
        case 'getRange':
            var ini=dp.parseDate($(this).eq(0).datepicker('option','dateFormat'),$(this).eq(0).attr(di)||''),
                fin=dp.parseDate($(this).eq(0).datepicker('option','dateFormat'),$(this).eq(0).attr(df)||'');
            return (!ini&&!fin)?null:[ini,fin];
        case 'getNumDays':
            var ini=dp.parseDate($(this).eq(0).datepicker('option','dateFormat'),$(this).eq(0).attr(di)||''),
                fin=dp.parseDate($(this).eq(0).datepicker('option','dateFormat'),$(this).eq(0).attr(df)||'');
            return (ini+0==0||fin+0==0)?0:Math.round((fin-ini)/86400000)+1;
        case 'removeRange':
            return $(this).attr(di,'').attr(df,'').datepicker('setDate',null);
        case 'destroy':
            return $(this).removeAttr(di).removeAttr(df).datepicker('destroy');
        case 'serialize':
            return this[0].id+'_initial='+this[0].getAttribute(di)+'&'+this[0].id+'_final='+this[0].getAttribute(df);
        default:
        var defaults={
            allowSelectOneDay: false,
            alwaysSetDateToFirstDay: true,
            rangeEnabled: true,
            rangeClass: 'ui-state-default ui-state-active'//'dp-highlight'
        };
            o = $.extend({}, defaults, $.datepicker._defaults, o);
        return $(this).each(function () {
            if (!$.datepicker) return;
            var t = this,
                hd = !! ((' ' + t.className + ' ').indexOf(' ' + cl + ' ') + 1);
            $(t).datepicker($.extend({}, o, {
                beforeShowDay: function (d) {
                    if (o.rangeEnabled) {
                        var d1 = dp.parseDate(o.dateFormat, t.getAttribute(di) || ''),
                            d2 = dp.parseDate(o.dateFormat, t.getAttribute(df) || ''),
                            y = (function (d) {
                                try {
                                    return o.beforeShowDay.call(t, d);
                                } catch (e) {}
                            })(d) || [true, '', null],
                            x = ((y && y[0] !== false) || !y) && d1 && ((d.getTime() == d1.getTime()) || (d2 && d >= d1 && d <= d2));
                        return (!d1||!d2)?y||[true,'',null]:[y[0]&&x, (x ? o.rangeClass || defaults.rangeClass : '') + (y[1] ? ' ' + y[1] : ''), y[2]];
                    } else {
                        return (function (d) {
                            try {
                                return o.beforeShowDay.call(t, d);
                            } catch (e) {}
                        })(d) || [true, '', null];
                    }
                },
                onSelect: function (dt, x) {
                    if (o.rangeEnabled) {
                        var i = t.getAttribute(di) || '',
                            f = t.getAttribute(df) || '',
                            d1 = dp.parseDate(o.dateFormat, i),
                            d2 = dp.parseDate(o.dateFormat, f),
                            s = dp.parseDate(o.dateFormat, dt);
                        if ((dt == i && dt == f) || (!o.allowSelectOneDay && ((dt == i && !f) || (dt == f && !i)))) {
                            t.removeAttribute(di);
                            t.removeAttribute(df);
                            $(t).datepicker('setDate', null);
                        } else if (!d1 || d2) {
                            t.setAttribute(di, dt);
                            t.removeAttribute(df);
                            o.alwaysSetDateToFirstDay && $(t).datepicker('setDate', s);
                        } else if (s < d1) {
                            t.setAttribute(df, i);
                            t.setAttribute(di, dt);
                            o.alwaysSetDateToFirstDay && $(t).datepicker('setDate', s);
                        } else {
                            t.setAttribute(df, dt);
                            o.alwaysSetDateToFirstDay && $(t).datepicker('setDate', d1);
                        }
                    } else {
                        t.removeAttribute(di);
                        t.removeAttribute(df);
                        $(t).datepicker('setDate', dp.parseDate(o.dateFormat, dt));
                    }

                    try {
                        if($(t).datepicker('getDate'))o.onSelect.call(t, dt, x);
                    } catch (e) {}
                }
            }));
        });
    }
};
})(window.jQuery); 
```

您应该访问小提琴并阅读要做的事情列表！

任何想法或代码片段表示赞赏！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-02-02T07:41:42.683

谢谢我需要这种代码。这是我的代码：

```
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script     src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

 <div id="Datepicker"></div>
<p>
<label><b>Checkin:</b></label> <label id="checkinDate"></label>
<label><b>Checkout:</b></label> <label id="checkoutDate"></label>
</p>

/** Display Checkin Datepicker and Checkout DatePicker */
<script>
datePicker();
function datePicker(){
   $(document).ready(function(){
      $( "#Datepicker" ).datepicker({
         dateFormat: "MM d, yy",
     minDate: 0,
     maxDate: "+3M +0D", 
         beforeShowDay: dateRange,
     onSelect: DRonSelect
      });
   });
}

function dateRange(date){
   var date1 = $.datepicker.parseDate("MM d, yy", $("#checkinDate").text());
   var date2 = $.datepicker.parseDate("MM d, yy", $("#checkoutDate").text());
   var isHighlight = date1 && ((date.getTime() == date1.getTime()) || (date2 && date >= date1 && date <= date2));
      $(document).ready(function(){
  // $("td.dp-highlight").text("Y");

});
   return [true, isHighlight ? "dp-highlight" : ""];
}

function DRonSelect(dateText, inst) {
   var date1 = $.datepicker.parseDate("MM d, yy", $("#checkinDate").text());
   var date2 = $.datepicker.parseDate("MM d, yy", $("#checkoutDate").text());
      if (!date1 || date2) {
         $("#checkinDate").text(dateText);
     $("#checkoutDate").text("");
         $("#Datepicker").datepicker();
      } 
      else {
         if ( $.datepicker.parseDate("MM d, yy", $("#checkinDate").text()) >= 
$.datepicker.parseDate("MM d, yy", dateText)) {
            $("#checkinDate").text(dateText);
            $("#checkoutDate").text("");
            $("#Datepicker").datepicker();
         }
         else {
        $("#checkoutDate").text(dateText);
            $("#Datepicker").datepicker();
         }
      }   
}
</script> 
```

我的代码是来自其他代码的示例代码，但在日期选择、日期范围和亮点方面有所不同。我在 JSFIDDLE 中创建并保存了一个代码

[https://jsfiddle.net/kk585b4g/](https://jsfiddle.net/kk585b4g/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-20T13:51:35.083

我自己寻找一个日期范围选择器，我找到了这个页面。我尝试了大多数建议甚至在这里演示的想法，并将这一切变成了一个易于使用和集成的扩展：[https](https://github.com/BuroRaDer/DateRangePicker) ://github.com/BuroRaDer/DateRangePicker 。试试演示页面看看它是如何工作的。我想我可以把它变成一个真正的 jQuery 扩展，但现在对它的工作方式很满意。

现场演示：

*   [http://lescamelias.eu/en/availability](http://lescamelias.eu/en/availability)
*   [http://maisonnera.eu/](http://maisonnera.eu/)

两者都是使用可用性日历模块的 Drupal 站点，现在它已集成到该模块中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-21T04:09:47.170

我一直在寻找一个即使没有内联也能工作的版本。我希望能够单击输入字段来启动范围日期选择器。我能找到的所有范围日期选择器示例都是内联的（包括上面的 mcestone 和 Jamie Layne 版本，它们是这个分叉代码的基础）。

这是小提琴：http: [//jsfiddle.net/boson/pjffdtz2/](http://jsfiddle.net/boson/pjffdtz2/)

困难的部分似乎是让 datepicker 在未内联时处理多个输入。如果您想在焦点上打开日期选择器，日期选择器将无法轻松处理两个输入 - 肯定有一个“技巧”。如果您将日期选择器与隐藏输入（显示：无）相关联，请在可见输入之前创建该隐藏输入，然后让您的可见输入在单击事件上显示日期选择器，一切都很好。

所以我接受了原来的答案，只是做了一些小的改动：

*   在 html 中，创建与日期选择器关联的隐藏输入。在可见输入**之前**列出它。
*   在 html 中，使用可见输入的点击事件来显示与隐藏输入关联的日期选择器。
*   在 Javascript 日期选择器 onSelect 中，暂时将日期选择器置于内联模式，直到两个日期都被单击。这允许您在 datepicker 关闭之前单击多个日期（范围“To”日期和“From”日期） - 这实际上将 datepicker 变成了一个多击 datepicker。
*   在日期选择器 onClose 中，关闭内联模式。这允许某人单击输入字段以再次打开日期选择器。
*   在 beforeShow 中，将日期选择器向下移动几个像素，以便您可以看到输入字段和日期选择器

这是代码：

```
$(function() {
  $(".rangepicker").datepicker({
    minDate: 0,
    numberOfMonths: [2, 1],
    beforeShow: function (input, inst) {
      var rect = input.getBoundingClientRect();
      setTimeout(function () {
	      inst.dpDiv.css({ top: rect.top + 40, left: rect.left + 0 });
      }, 0);
    },
    beforeShowDay: function(date) {
      var date1 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input1").val());
      var date2 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input2").val());
      var isHighlight =
         date1 && ((date.getTime() == date1.getTime()) || (date2 && date >= date1 && date <= date2));
      return [true, isHighlight ? "dp-highlight" : ""];
    },
    onSelect: function(dateText, inst) {
      var date1 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input1").val());
      var date2 = $.datepicker.parseDate($.datepicker._defaults.dateFormat, $("#input2").val());
      var selectedDate = $.datepicker.parseDate($.datepicker._defaults.dateFormat, dateText);

      if (!date1 || date2) {
        $("#input1").val(dateText);  
        $("#input2").val("");        
      } else if (selectedDate < date1) {
          $("#input2").val($("#input1").val()); 
          $("#input1").val(dateText);  
      } else {
          $("#input2").val(dateText);  
      }
      $(this).data('datepicker').inline = true;           
      $(this).datepicker();
    },
    onClose: function() {
      // Since we went inline as soon as the date input was clicked
      // (to leave the datepicker up for both dates selection),
      // turn inline back off again so date input click will once again
      // display the datepicker
      $(this).data('datepicker').inline = false;
    }
  });
});
```

```
.dp-highlight .ui-state-default {
          background: #484;
          color: #FFF;
        }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<input type="text" id="input1_1" class="rangepicker" style="display: none">
<p>
    Dates:
    <label><b>To:</b></label>
    <input type="text" id="input1" onclick="$('.rangepicker').datepicker('show');">
    <label><b>From:</b></label>
    <input type="text" id="input2" onclick="$('.rangepicker').datepicker('show');">
    <button id="done">Done</button>
</p>
```

还有很多东西需要改进。需要更好的输入验证。特别希望让日期选择器的“完成”按钮在内联模式下工作，但日期选择器不是为这种情况设计的（当然，在日期选择器中有一个可设置的完成按钮标志会很好）。所以现在，我在输入字段旁边有一个俗气的完成按钮，实际上什么都不做（除了鼓励用户将焦点从日期选择器上移开以关闭日期选择器）。

# php - 如何使用imagick从pdf生成图像文件？

> ID：16092302
> 
> 赞同：0
> 
> 时间：2013-04-18T20:19:24.717
> 
> 标签：php, imagick

您好我正在使用`Imagick`php 库来创建`thumbnail`大量`pdf`文件。

我的问题是，我如何实际将这些图像生成到实际文件中。像 test.jpg 或 test2.jpg。

我的代码如下：

```
 $display           = array ('pdf');
    $directoryIterator = new RecursiveDirectoryIterator('/test/project');

    foreach (new RecursiveIteratorIterator($directoryIterator) as $fileName => $file) {

        $fileExtension = pathinfo($fileName, PATHINFO_EXTENSION);

        if (in_array(strtolower($fileExtension), $display)) {
            if(file_exists($fileName)){
                 $im = new imagick($fileName.'[0]');
                 $im->setImageFormat("jpg");
                 echo $im;

            }
        }
    } 
```

代码没有错误，但文件夹中没有`image`生成`/test/project/`文件。我想知道是否有人可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:56:11.720

我认为您需要在您的 Imagick 对象上调用 writeImage 方法以使其实际写入文件。

替换`echo $im;`为：

```
$im->writeImage('thumb.jpg'); 
```

这个问题可能有更多信息：[Convert PDF to JPEG with PHP and ImageMagick](https://stackoverflow.com/questions/9227014/convert-pdf-to-jpeg-with-php-and-imagemagick)

# java - 使用 .contains() 搜索 HashSet

> ID：16092305
> 
> 赞同：0
> 
> 时间：2013-04-18T20:19:52.890
> 
> 标签：java

我有一个字符串的 hashSet，用于表示 RushHour 状态。hashSet 包含所有以前访问过的状态。

我调用一个函数来返回给定状态下可用的下一步移动，并使用代码检查它们是否已经被访问过：

`if(!(visitedHash.contains(childBoards.get(i).Convert())))`

然后，如果该状态尚未被访问，我将其添加到队列中，以使用广度优先搜索来解决。

问题是当我写这行代码时：

`if(visitedHash.contains(currentBoard.Convert())){ System.out.println("Whats Going on!!??"); }`

当我从一个新董事会投票时，我得到许多州打印“发生了什么！？？”

这应该是不可能的！应该是？我刚刚检查了它们是否被包括在内并且它们被添加到队列中，所以必须通过 IF 语句！

这是我的搜索方法的完整代码：

```
public void search(Board b){    
    //--------Perform Breadth First Search on Board b--------//Method to solve the puzzle using Breadth First Search
    System.out.println("Attempting to solve the Board using Breadth First Search...");
    long startTime = System.nanoTime();                                                     //capture the start time for the method
    queue.add(b);                                                                           //push the input board onto the front of the queue
    while(!solved){                                                                         //while the board is not solved
        currentBoard = queue.poll();                                                        //assign the top of the queue to currentBoard
        currentBoard.print();                                                               //print the board to the screen (PRINT EVERY BOARD VISITED)
        System.out.println(currentBoard.Convert());
        System.out.println("This board is on level " + getLevel(currentBoard));
        //System.out.println("Visited Boards size: " + visitedHash.size());
        if(visitedHash.contains(currentBoard.Convert())){
            System.out.println("Whats Going on!!??");
        }
        boardsExplored++;                                                                   //increment the number of boardsExplored
        if(currentBoard.isGoal()){                                                          //if the board is the goal state
            long endTime = System.nanoTime();                                               //capture the end time for the method
            long duration = endTime - startTime;                                            //calculate the duration for the method
            time = (double)duration / 1000000000.0;                                         //convert the time to seconds
            System.out.println("SOLVED! Goal car is Free!");
            System.out.println("Time taken to solve = " + time + " seconds");               //print the time taken in seconds
            System.out.println("Moves made = " + (boardsExplored - 1));                     //print the number of boards explored to reach goal
            visitedHash.add(currentBoard.Convert());                                        //add the board (when converted to a string) to the list of visited boards              
            printSolution(currentBoard);                                                    //Call method to print shortest path found
            write(b);                                                                       //Call method to write data to the file
            solved = true;                                                                  //set solved to true
            return;                                                                         //exit the loop
        }
        visitedHash.add(currentBoard.Convert());                                            //add the board (when converted to a string) to the list of visited boards              
        childBoards = currentBoard.getChildMoves();                                         //call getChildMoves on the currentBoard to retrieve all available boards
        for (int i = 0 ; i < childBoards.size() ; i ++){                                    //for every one of the child boards
            if(!(visitedHash.contains(childBoards.get(i).Convert()))){                      //if the child board has NOT previously been visited
                queue.add(childBoards.get(i));                                              //add the child board to the queue and loop back    
                parent.put(childBoards.get(i), currentBoard);                               //Map the child board to its parent
                level.put(childBoards.get(i), getLevel(currentBoard));
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T22:27:17.343

正如其他人在评论中提到的那样，您可能需要为 Convert() 的返回类型创建适当的 hashCode 和 equals 方法。

# php - 使用 PHP 从透明的 16x16 图像中裁剪非透明像素

> ID：16092306
> 
> 赞同：0
> 
> 时间：2013-04-18T20:19:55.680
> 
> 标签：php, gd, transparent, imagick

我想从透明的 16x16 画布上裁剪不透明的像素。由于非透明像素实际上是图像。可以在 PHP GD 或 Imagick 中使用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-24T01:14:07.863

只是花了很长时间摆弄这个，现在是凌晨！

**我在任何地方都找不到只使用 GD 的函数/脚本，所以我希望这对某人有所帮助。**

本质上，它循环遍历源图像的行和列，确定整个行/列是否透明，如果是，则相应地更新 $left、$right、$top 和 $bottom 变量。

我能想到的唯一限制是一个图像，其中有一行或一列将图像从中间分开，此时这将标记 $bottom 或 $right 早于预期，但对于任何寻找的人来说都是一个好的开始。

在我的情况下，源图像是一个 gd 资源，最后需要一些 imagedestroy() 调用......

```
function transparent($src_img,$in){
    $c = imagecolorsforindex($src_img,$in);
    if($c["alpha"] == 127){
        return true;
    }else{
        return false;
    }
    //var_dump($c);
}

function crop($src_img){

    $width = imagesx($src_img);
    $height = imagesy($src_img);

    $top = 0;
    $bottom = 0;
    $left = 0;
    $right = 0;

    for($x=0;$x<$width;$x++){
        $clear = true;
        for($y=0;$y<$height;$y++){
            if ($this->transparent($src_img,imagecolorat($src_img, $x, $y))){

            }else{
                $clear = false;
            }
        }
        if($clear===false){
            if($left == 0){
                $left = ($x-1);
            }
        }
        if(($clear===true)and($left != 0)){
            if($right == 0){
                $right = ($x-1);
            }else{
                break;
            }
        }
    }

    for($y=0;$y<$height;$y++){
        $clear = true;
        for($x=0;$x<$width;$x++){
            if ($this->transparent($src_img,imagecolorat($src_img, $x, $y))){

            }else{
                $clear = false;
            }
        }
        if($clear===false){
            if($top == 0){
                $top = ($y-1);
            }
        }
        if(($clear===true)and($top != 0)){
            if($bottom == 0){
                $bottom = ($y-1);
            }else{
                break;
            }
        }
    }

    $new = imagecreatetruecolor($right-$left, $bottom-$top);
    $transparent = imagecolorallocatealpha($new,255,255,255,127);
    imagefill($new,0,0,$transparent);

    imagecopy($new, $src_img, 0, 0, $left, $top, $right-$left, $bottom-$top);
    return $new;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T15:59:14.873

image magick 有一个修剪方法[http://www.php.net/manual/en/imagick.trimimage.php](http://www.php.net/manual/en/imagick.trimimage.php)我认为这就是你需要的

```
<?php
/* Create the object and read the image in */
$im = new Imagick("image.jpg");

/* Trim the image. */
$im->trimImage(0);

/* Ouput the image */
header("Content-Type: image/" . $im->getImageFormat());
echo $im;
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:11:09.250

由于图像非常小，您可以使用[imagecolorat循环遍历所有像素，然后使用](http://www.php.net/manual/en/function.imagecolorat.php)[imagesetpixel](http://php.net/manual/en/function.imagesetpixel.php)将不透明的像素写入新图像，或者记下角落并使用[imagecopy](http://www.php.net/manual/en/function.imagecopy.php)复制整个内容

就像是：

```
$x1 = -1;
$y1 = -1;
for($x=0;$x<16;$x++){
    for($y=0;$y<16;$y++){
        if (!transparent(imagecolorat($im, $x, $y))){
            if($x1 < 0 ){
                $x1 = $x;
                $y1 = $y;
            }else{
                $x2 = $x;
                $y2 = $y;       
            }
        }
    }
}
imagecopy($im2, $im, 0, 0, $x1, $y1, $x2-$x1+1, $y2-$y1+1); 
```

您将必须定义函数 transparent() - 要么进行位移以获取 alpha 通道，要么识别透明颜色（如果它是 gif）。

编辑：高度/宽度数学更新

# powershell - Import-Csv 以获取包含破折号的数据给出框或问号

> ID：16092309
> 
> 赞同：2
> 
> 时间：2013-04-18T20:19:59.343
> 
> 标签：powershell, csv, import

尝试导入一些 csv 数据时，我遇到了一个非常特殊的错误。此数据具有指向共享点站点中包含的文件的链接，这些文件需要保持不变。（我实际上正在编写一个脚本来删除这些文件）。我的问题是这些链接中特别有破折号，powershell 似乎无法识别或 import-csv 命令无法处理。我还想指出，破折号有两种类型。连字符直接在您的键盘上，这些是较长的连字符，称为“破折号”，不直接在键盘上。

如果您不确定我的意思，请打开 MS Word 并完整输入以下内容：

```
This - is a test. 
```

您会注意到，当您在键入“a”之前敲击空格键时，MS Word 会自动将连字符转换为破折号，并且会更长。

请让我知道如何让 powershell 识别破折号！

例子：

```
$web.getListItem("link contains -")
#finds file

#Please note below the actual text is: link contains -
$files = import-csv $path #csv is ms-dos csv
$files[0].Url
#Prints: link contains <box>
$files = import-csv $path #csv is excel general csv
$files[0].Url
#Prints: link contains ? 
```

**解决了**

想通了。我使用以下站点来找出我的角色的十六进制等效项，并在 excel 中进行了替换。 [http://www.asciitohex.com/](http://www.asciitohex.com/)原来十六进制等效项是：

```
e2 80 93 
```

或网址编码：

```
%E2%80%93 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T17:42:52.867

**解决了**

想通了。我使用以下站点来找出我的角色的十六进制等效项，并在 excel 中进行了替换。[http://www.asciitohex.com/](http://www.asciitohex.com/)原来十六进制等效项是：

```
e2 80 93 
```

或网址编码：

```
%E2%80%93 
```

# c++ - 是否可以编写一个字符串化的 C++ 函数？

> ID：16092310
> 
> 赞同：0
> 
> 时间：2013-04-18T20:20:06.427
> 
> 标签：c++, metaprogramming, stringification

如果您必须编写一个与宏中的运算符“#”相同的 C++ 函数，您会怎么做？

如果可以在运行时进行，那将很有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:25:32.933

你不能。你基本上要求的是这个......

```
void function(int someargname)
{
    std::cout << #someargname << std::endl;
}

int main()
{
    function(3);
    return 0;
} 
```

并期望得到“someargname”作为输出而不是“3”。该语言根本不支持该语法。

# ruby-on-rails - 如何将变量分配给活动记录对象？

> ID：16092312
> 
> 赞同：2
> 
> 时间：2013-04-18T20:20:07.147
> 
> 标签：ruby-on-rails, ruby, activerecord

以下代码将使用 ST_AsGeoJSON postgis 函数查询我的数据库，并在 rails 控制台中将 json 对象打印到屏幕上。

```
Zcta.
  select("ST_AsGeoJSON(ST_simplify(geom,500)) as my_geo").
  where(geoid10: '90210').each do |result|
    puts result.my_geo
  end 
```

如果我想将该内容放入一个变量（或数组，或就此而言的散列）中怎么办？如果我更改`puts result.my_geo`为`variable = result.my_geo`然后稍后尝试使用该变量，我会收到一条错误消息，指出该变量不存在。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:26:06.620

你在块中定义你的变量吗？那么外面就无法访问了。首先在块外定义变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:31:22.003

或`map`改用：

```
variable = Zcta.
  select("ST_AsGeoJSON(ST_simplify(geom,500)) as my_geo").
  where(geoid10: '90210').map do |result|
    result.my_geo
  end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T22:00:43.930

你正在寻找`map`而不是`each`

`each`将遍历 Enumerable 中的每个项目并为其执行块，返回`nil`. 在您的示例中，将`puts`对象打印到控制台，但不会将其存储在任何地方。

`map`, 另一方面，将为可枚举的每个元素执行块，并向您返回一个*新*的可枚举，其中包含在每个元素上运行给定块的结果。

```
x = [1,2,3].map { |elem| elem + 1 }
puts x
[2,3,4] 
```

在您的情况下，您可以执行以下操作：

```
result = Zcta.select("ST_AsGeoJSON(ST_simplify(geom,500)) as my_geo")
  .where(geoid10: '90210')
  .map(&:my_geo) 
```

您的查询结果现在将作为 Enumerable 存储在变量中`result`

# php - 清除我商店中所有信息的方法，只保留模板

> ID：16092314
> 
> 赞同：0
> 
> 时间：2013-04-18T20:20:17.940
> 
> 标签：php, magento

我有一家 magento 商店，我的产品、客户和许多其他信息都有几个问题，因为我做了一个重要的事情，而这个重要的事情打破了一切。

但是我的商店已经有了布局和模板都可以。我只想清理产品客户和其他所有人的所有收银机，只保留商店的“面子”。

这是可能的？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:54:07.337

你也可以

1.  在模板文件上安装新的 magento 和 rsync 副本（缺点 - 您需要更新 core_config、cms 和系统配置）。

2.  截断各种表

    *   [customers.sql、logs.sql 和 sales.sql](https://gist.github.com/leek/1219708)
    *   [产品和类别](http://www.magentocommerce.com/wiki/import-export_and_data_manipulation/removing_products_through_the_database)

记得备份你的数据库

# qt - Qt - 断点不起作用+“意外的 GDB 退出”

> ID：16092322
> 
> 赞同：1
> 
> 时间：2013-04-18T20:20:44.447
> 
> 标签：qt, debugging, crash, gdb, breakpoints

我在 Windows 上使用基于 QT 4.8.4（32 位）和 Ming 4.4 的 Qt Creator 2.7.0。我的 Qt 项目在发布和调试模式下运行没有任何问题。但是，当我尝试调试时，断点不起作用（代码确实成功运行到最后），最后我得到“意外的 GDB 退出 - gdb 进程终止”。任何建议表示赞赏。

# icalendar - 添加到活动网站的日历功能？

> ID：16092325
> 
> 赞同：0
> 
> 时间：2013-04-18T20:21:07.913
> 
> 标签：icalendar

我们正在开发一个活动网站，并且想知道如何提供“添加到日历”功能。我们在网站上实际上没有日历，我们正在使用 Wordpress 进行开发。一切都是基于搜索的。有谁知道我们如何生成正确的文件，以便有人可以将事件添加到他们的 Google、Android、iPhone、iCal 等日历中？非常感谢任何建议。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T09:12:44.117

你可以使用这个 jQuery icalender 脚本。虽然如果我是你，我会更改标记以使其符合 microformats2 h-event。库： http: [//keith-wood.name/icalendar.html](http://keith-wood.name/icalendar.html) microformats2 h-event [http://microformats.org/wiki/microformats2#h-event](http://microformats.org/wiki/microformats2#h-event)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T08:54:20.737

我看没有人回复，所以就这样吧。您需要生成一个 ics 提要（即文件）。尽管通常用于整个日历，但可以按事件执行此操作。规范是 RFC 5545。

在 wordpress 中，您可以使用提要概念并编写代码以添加带有 ics 后缀的提要。由于 wordpress 允许按类别、标签等甚至帖子 id 提供提要，因此即使每个事件都有一个 oics 文件，它也确实很方便（假设您的事件是帖子类型）

icalevents.com 的右下侧边栏中有一些资源链接和测试工具。该站点是我的，因为我的插件正是这样做的。当然，wordpress.org 上还有其他可用的插件，它们在不同程度上实现了规范的成功和完整性！

注意：一个人是否将其添加到他们的日历或作为单独的日历订阅它取决于他们。不能强制和“添加”到某人的个人日历中。

# multithreading - 在 C++ 中获取信号并同时显示视觉刺激

> ID：16092326
> 
> 赞同：1
> 
> 时间：2013-04-18T20:21:08.420
> 
> 标签：multithreading, parallel-processing, synchronized

我必须从外部设备获取信号，同时在 LCD 屏幕上显示视觉刺激。

信号由 BCI 设备以 512 Hz 采样，并通过蓝牙连接发送到 PC。当我获得这个信号时，我必须在屏幕上产生一些视觉刺激。这两个操作必须同步，因为时间分量至关重要（我需要查看大脑对某些刺激的反应，它以特定频率闪烁）。我做了采集和刺激，但我不能把这两件事放在一起。我在 Matlab 中遇到了同样的问题，在 C++ 中我无法解决。我不知道什么解决方案可以帮助我（并行，多线程或其他东西，所以欢迎任何建议。我希望我是清晰和全面的。

我正在使用 Visual C++ 2008 Express Edition 和 Windows XP Sp3，32 位。

# maven - Maven和Ant插件智能复制资源

> ID：16092332
> 
> 赞同：8
> 
> 时间：2013-04-18T20:21:22.993
> 
> 标签：maven, ant

复制资源和重命名它们很容易使用`org.apache.maven.plugins:maven-antrun-plugin`，但是有没有办法使用通配符或其他机制智能地做到这一点，以符合个人规则？

例如，如果我有这些文件：

*   `${project.artifactId}-${project.version}.swf`
*   `a.swf`
*   `b.swf`
*   ...
*   `z.swf`

我想将所有这些文件复制到目录中并仅重命名`${project.artifactId}-${project.version}.swf`为`foo.swf`. 我知道我可以使用：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>1.7</version>
       <executions>
          <execution>
             <id>copy-swf-files</id>
             <phase>compile</phase>
                <goals>
                   <goal>run</goal>
                </goals>
                <configuration>
                   <target name="copy swf files to web project">
                       <copy file="${project.build.directory}/${project.artifactId}-${project.version}.swf" tofile="${swf.output.location}/foo.swf" />
                       <copy file="${project.build.directory}/a.swf" tofile="${swf.output.location}/a.swf" />
                       <copy file="${project.build.directory}/z.swf" tofile="${swf.output.location}/z.swf" />
                    </target>
                 </configuration>                       
              </execution>
           </executions>
     </plugin> 
```

这是工作，但有没有另一种方便的方法来做到这一点，因为如果我有 1000 个文件要复制，那会很无聊......谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-18T21:01:40.517

你知道蚂蚁吗？Maven Ant 插件所做的所有事情就是使用您列出的任务调用 Ant。您可以执行任何 Ant 任务，包括`<taskdef>`等。

看起来你正在做的事情可以用文件集来完成：

```
 <copy todir="${swf.output.location}">
    <fileset dir="${project.build.directory}">
        <include name="*.swf"/>
    </fileset>
</copy> 
```

这会将`*.swf`直接位于`${project.build.directory}`（并且没有子目录）下的所有文件复制到`${swf.output.location}`目录中。如果要复制文件的整个目录树`*.swf`，只需更改`<include>`：

```
 <copy todir="${swf.output.location}">
    <fileset dir="${project.build.directory}">
        <include name="**/*.swf"/>  <!--NOTE DIFFERENCE HERE-->
    </fileset>
</copy> 
```

如果您需要修改文件名，可以使用[Mappers](http://ant.apache.org/manual/Types/mapper.html)。最简单的映射器是 flatten 映射器：

```
 <copy todir="${swf.output.location}">
    <fileset dir="${project.build.directory}">
        <include name="**/*.swf"/>  <!--NOTE DIFFERENCE HERE-->
    </fileset>
    <mapper type="flatten"/>
</copy> 
```

这将复制整个目录树并将所有文件展平到一个目录中。有些映射器可以匹配 glob、正则表达式甚至脚本。

这`<include>`是一个[选择器](http://ant.apache.org/manual/Types/selectors.html)而不是一个映射器，因为它选择了您想要操作的文件。这些也可能非常复杂，您可以根据它们的名称 iva 正则表达式甚至它们的内容来匹配文件。

我很惊讶没有允许您执行此操作的 Maven 插件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T08:27:55.867

好的，我终于用这个插件来做到这一点：

```
<plugin>
   <groupId>org.apache.maven.plugins</groupId>
   <artifactId>maven-antrun-plugin</artifactId>
   <version>1.7</version>
   <executions>
      <execution>
      <id>copy-swf-files</id>
      <phase>compile</phase>
      <goals>
         <goal>run</goal>
      </goals>
      <configuration>
         <target name="copy swf files to web project">      
            <copy todir="${swf.output.location}">
                <fileset dir="${project.build.directory}" includes="*.swf">
                    <filename regex="^sim-flex.*"/>
                </fileset>
            <mapper type="regexp" from=".*" to="sim.swf"/>
            </copy>
            <copy todir="${swf.output.location}" >
                <fileset dir="${project.build.directory}" includes="*.swf">
                    <not>
                        <filename regex="^sim-flex.*"/>
                    </not>                                  
                </fileset>
            </copy>
         </target>
      </configuration>                       
   </execution> 
 </executions>
</plugin> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:48:16.313

使用带有“dir”“formats/format”的程序集描述符的 maven-assembly-plugin，一个“fileSets/fileSet”，它将复制除特殊 swf 之外的大部分 swf，以及一个“files/file”，它将复制一个 swf 到具有不同名称的文件。

# android - 登录 facebook android 错误

> ID：16092337
> 
> 赞同：-3
> 
> 时间：2013-04-18T20:21:40.010
> 
> 标签：android, facebook, facebook-graph-api

我尝试编写一个可以登录 facebook 的应用程序。我使用 facebook sdk，所以我导入了 facebook sdk 中的类。

我去 Project-->Proprietes--->Android--->Library add Facebook SDK 但我收到以下错误（对于所有项目，我刚刚在 1.6 更改了 Java 编译器的属性）：

```
0:37 - BooleanOGSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - SessionLoginSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - SwitchUserSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - Hackbook] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - Scrumptious] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - FriendPickerSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - ProfilePictureSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - GraphApiSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - PlacePickerSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:37 - HelloFacebookSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - BooleanOGSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - FacebookSDK] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - FriendPickerSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - GraphApiSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - Hackbook] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - HelloFacebookSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - PlacePickerSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - ProfilePictureSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - Scrumptious] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - SessionLoginSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:10:38 - SwitchUserSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:11:04 - BooleanOGSample] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:11:04 - FacebookSDK] Android requires compiler compliance level 5.0 or 6.0\. Found '1.7' instead. Please use Android Tools > Fix Project Properties.
[2013-04-18 22:15:29 - FacebookProvaSd] Found 2 versions of android-support-v4.jar in the dependency list,
[2013-04-18 22:15:29 - FacebookProvaSd] but not all the versions are identical (check is based on SHA-1 only at this time).
[2013-04-18 22:15:29 - FacebookProvaSd] All versions of the libraries must be the same at this time.
[2013-04-18 22:15:29 - FacebookProvaSd] Versions found are:
[2013-04-18 22:15:29 - FacebookProvaSd] Path: C:\Users\Francesco\Desktop\Android\Progetti Android\FacebookProvaSd\libs\android-support-v4.jar
[2013-04-18 22:15:29 - FacebookProvaSd]     Length: 393154
[2013-04-18 22:15:29 - FacebookProvaSd]     SHA-1: 307c1cc532eabbf1d135b43e5c983c9da700449d
[2013-04-18 22:15:29 - FacebookProvaSd] Path: C:\Users\Francesco\Desktop\Android\documentazione\Facebook\AltraSDK\facebook-android-sdk-3.0.1\facebook\libs\android-support-v4.jar
[2013-04-18 22:15:29 - FacebookProvaSd]     Length: 349252
[2013-04-18 22:15:29 - FacebookProvaSd]     SHA-1: 612846c9857077a039b533718f72db3bc041d389
[2013-04-18 22:15:29 - FacebookProvaSd] Jar mismatch! Fix your dependencies 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:26:36.257

我在这里看到两个问题：

1.  Android 要求编译器合规级别为 5.0 或 6.0。而是找到了“1.7”。请使用 Android 工具 > 修复项目属性。
2.  在依赖列表中找到2个版本的android-support-v4.jar

第一个问题应该很容易通过简单地按照说明解决。第二个问题也很容易解决。只需确保 Facebook 项目和您自己的 Android 项目都使用相同版本的兼容性库。最简单的方法是将两者都更新到最新版本。

# python - 制作一个只有在程序运行后才知道的名称的列表

> ID：16092341
> 
> 赞同：1
> 
> 时间：2013-04-18T20:22:02.200
> 
> 标签：python, list, python-2.7

我想列出一个列表，并将其命名为我只有在运行程序后才知道的名称：

例如：

```
#making shelfs
group_number = 1
group_name = 'group' + str(group_number)
print group_name 
```

group_name 将是：group1

现在我想创建一个名为 group1 的空列表。怎么做这样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:23:06.367

通常你只需将它放入字典中：

```
d = {group_name:[]} 
```

现在您可以通过字典访问您的列表。例如：

```
d['group1'].append('Hello World!') 
```

* * *

另一种方法是修改`globals()`函数的结果（这是一个字典）。这绝对是不好的做法，**应该避免**，但我将其包括在此处，因为了解更多有关您正在使用的工具的信息总是很高兴：

```
globals()[group_name] = []
group1.append("Hello World!") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:35:45.030

您想要创建以“组”开头的变量的伪命名空间。为什么不使用字典呢？

```
#making shelfs
groups = {}
group_number = 1
name = str(group_number)
groups[name] = [] # or whatever
print groups[name] 
```

这与@mgilson 的回答略有不同，因为我试图鼓励您为每个相关对象集合创建新的命名空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:27:15.300

你来做这件事：

```
locals()['my_variable_name'] = _whatever_you_wish_ 
```

或者

```
globals()['my_variable_name'] = _whatever_you_wish_ 
```

或者

```
vars()['my_variable_name'] = _whatever_you_wish_ 
```

谷歌自己找出差异：P

# cordova - PhoneGap 全球化回调之外的未定义变量

> ID：16092346
> 
> 赞同：1
> 
> 时间：2013-04-18T20:22:21.880
> 
> 标签：cordova, callback, scope, globalization

我目前正在玩 PhoneGap（Cordova 版本 2.6.0），不幸的是我的 JavaScript 知识还很初级。我试图使用 PhoneGap 的全球化对象来获取月份的名称，但我无法从回调中得到结果。

那是代码：

```
<button onclick="getCurrentDate()">Get Current Date</button>

function getCurrentDate(){
  var currentDate = new Date();

  alert(getMonthAsString(currentDate.getMonth()) + ' ' + currentDate.getDate() 
    + ', ' + currentDate.getFullYear());
  }

function getMonthAsString(month){
    var monthString;
    navigator.globalization.getDateNames(
        function(names){
            monthString = names.value[month]; 
            alert(monthString);
         },
         function(){
            alert('Error getting names\n');
         },
         {type:'wide', item:'months'}
      );
      return monthString;
    } 
```

警报有正确的月份，但返回值未定义。

# c++ - OpenGL坐标系不在-1到1

> ID：16092347
> 
> 赞同：1
> 
> 时间：2013-04-18T20:22:23.020
> 
> 标签：c++, opengl

我正在用 OpenGl 和 C++ 创建一个基本游戏，并且想要制作它，这样当玩家到达屏幕边缘时，他们就不能再移动了。我无法确定屏幕边缘的位置。我知道 Windows 通常有一个介于 1 和 -1 之间的系统，但我的系统似乎更像是 0.63 到 -0.63。玩家在屏幕上显示为一个具有 x、y 和 z 位置的框，但它只会在 2D 空间中移动。

我想更改界限，使它们介于 -1 和 1 之间，而不是奇数值。

我怎样才能做到这一点？

代码已上传到[http://pastebin.com/jxd5YhHa](http://pastebin.com/jxd5YhHa)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:36:19.400

如果您不打算动态更改投影矩阵，最简单的方法是调用

glScalef(.63f,.63f,1);

在你的投影矩阵上。

然后，您可以根据这些值限制移动。

要随时计算世界空间坐标，您应该使用 gluUnProject。假设 'x' 和 'y' 分别是窗口的宽度和高度（您传递 gluPerspective 的值），您可以像这样找到世界空间坐标：

```
double world_llx,world_lly,world_llz;
//world coordinates of lower left corner of window
gluUnProject(0, 0, 0, view_mat, proj_mat, viewport,&world_llx,&world_lly,&world_llz);
//world coordinate of upper right corner of window
double world_urx,world_ury,world_urz;
gluUnProject(x,y,0,view_mat,proj_mat,viewport,&world_urx,&world_ury,&world_urz); 
```

view_mat 是您的视图矩阵。proj_mat 是您的投影矩阵。您可以使用带有 GL_MODELVIEW_MATRIX 和 GL_PROJECTION_MATRIX 的 glGetDouble* 来获得这两者。

视口参数可能与您的窗口具有相同的尺寸。无论如何，这是您使用 glViewport 设置的。

这假设您的 XZ 平面位于 z == 0。

# jquery - jQuery / jQuery mobile 的本地版本和托管版本之间的区别

> ID：16092350
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:22:28.700
> 
> 标签：jquery, jquery-mobile

在我使用托管版本的标头之前：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script> 
```

正如[下载 jQuery 移动页面所推荐的那样](http://jquerymobile.com/download/)

今天我试图获取标题的本地版本：

1.  下载[http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.zip](http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.zip)。
2.  下载[http://code.jquery.com/jquery-1.9.1.js](http://code.jquery.com/jquery-1.9.1.js)。
3.  解压缩第一个并将所有文件放入 jQuery 文件夹。
4.  然后更改我的 index.html 的元区域：

至少期望相同的 UI 外观和感觉。

```
 <link rel="stylesheet" href="jQuery/jquery.mobile-1.3.1.min.css" />
    <script src="jQuery/jquery-1.9.1.min.js"></script>
    <script src="jQuery/jquery.mobile-1.3.1.min.js"></script> 
```

不幸的是，没有主题 - index.html 以最小格式出现（猜想没有应用 CSS）。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:30:02.600

回答所有问题 - 我的目标文件夹的内容如下：

```
.:
images
index.html
jQuery
utils

./images:
post-logo-notitle-1.png
post-logo-notitle-2.png
post-logo-title-blue-1.png
post-logo-title-blue-2.png

./jQuery:
images
index.html
jquery-1.9.1.js
jquery.mobile-1.3.1.css
jquery.mobile-1.3.1.js
jquery.mobile-1.3.1.min.css
jquery.mobile-1.3.1.min.js
jquery.mobile-1.3.1.min.map
jquery.mobile.structure-1.3.1.css
jquery.mobile.structure-1.3.1.min.css
jquery.mobile.theme-1.3.1.css
jquery.mobile.theme-1.3.1.min.css

./jQuery/images:
ajax-loader.gif
icons-18-black.png
icons-18-white.png
icons-36-black.png
icons-36-white.png

./utils:
init.js 
```

# mysql - 在查询中使用 except 时出现语法错误

> ID：16092353
> 
> 赞同：17
> 
> 时间：2013-04-18T20:22:50.280
> 
> 标签：mysql, sql, select, sql-except

此查询有效：

```
mysql> SELECT s.sno FROM students s;  
+------+  
| sno  |   
+------+   
|    1 |   
|    2 |   
|    3 |   
|    4 |   
|    5 |    
|    6 |    
|    7 |   
|    8 |   
|    9 |   
|   10 |   
+------+   
10 rows in set (0.00 sec) 
```

此查询也有效：

```
mysql> SELECT t.sno FROM take t WHERE t.cno = 'CS112';  
+------+  
| sno  |  
+------+  
|    1 |  
|    2 |  
|    3 |  
|    4 |  
+------+   
4 rows in set (0.00 sec) 
```

但是这个查询：

```
SELECT s.sno FROM students s    
EXCEPT    
SELECT t.sno FROM take t WHERE t.cno = 'CS112'; 
```

失败并出现错误：

```
mysql> SELECT s.sno FROM students s  
    -> EXCEPT  
    -> SELECT t.sno FROM take t WHERE t.cno = 'CS112';  
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that   corresponds to your MySQL server version for the right syntax to use n   
ear 'EXCEPT   
SELECT t.sno FROM take t WHERE t.cno = 'CS112'' at line 2 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-18T20:31:44.883

我不相信 MySQL 支持 EXCEPT 语法。尝试使用`NOT IN`或`LEFT JOIN`：

```
SELECT s.sno 
FROM students s    
WHERE s.sno NOT IN 
(
    SELECT t.sno 
    FROM take t 
    WHERE t.cno = 'CS112'
); 
```

或者

```
SELECT s.sno 
FROM students s    
    LEFT JOIN take t ON s.sno = t.sno
WHERE IFNULL(t.cno, '') != 'CS112' 
```

**更新**

我模拟了你的数据，它正确地返回 5 到 10：

```
create temporary table temp_students (sno int)

insert into temp_students values (1)
insert into temp_students values (2)
insert into temp_students values (3)
insert into temp_students values (4)
insert into temp_students values (5)
insert into temp_students values (6)
insert into temp_students values (7)
insert into temp_students values (8)
insert into temp_students values (9)
insert into temp_students values (10)

create temporary table temp_take (sno int, cno varchar(50))

insert into temp_take values (1, 'CS112')
insert into temp_take values (2, 'CS112')
insert into temp_take values (3, 'CS112')
insert into temp_take values (4, 'CS112')

SELECT s.sno 
FROM temp_students s    
        LEFT JOIN temp_take t ON s.sno = t.sno
WHERE IFNULL(t.cno, '') != 'CS112' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-19T14:01:43.653

询问：

**[SQLFIDDLE示例](http://www.sqlfiddle.com/#!2/a7430/8)**

```
SELECT s.sno 
FROM students s
WHERE NOT EXISTS (SELECT 0 
                  FROM take t 
                  WHERE t.sno = s.sno 
                  AND t.cno = 'CS112') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-18T21:05:27.050

尝试这个。

```
SELECT s.sno FROM students s
LEFT JOIN take t ON t.sno = s.sno AND t.cno = 'CS112' 
WHERE t.sno IS NULL; 
```

[http://www.sqlfiddle.com/#!2/a7430/7](http://www.sqlfiddle.com/#!2/a7430/7)

# c++ - getline跳过第一个输入字符c ++

> ID：16092356
> 
> 赞同：4
> 
> 时间：2013-04-18T20:23:02.940
> 
> 标签：c++, loops, getline

所以我制作这个程序已经有一段时间了。我浏览了整个互联网，但没有找到任何解决方案。每次我在 arr[i].question 和 arr[i].answer 中输入我的输入时，它都会说我的问题是错误的，而我没有给出问题的答案。我尝试过使用 cin.ignore()、cin.clear() 和 cin.sync()。我可能在错误的地方使用它们，但我不确定。我可能会感到困惑，所以只看代码。

这是输入格式。

```
 cin >> count;
cin.ignore();

for(int i =0; i < count; i++){
    cout << "Enter the question.\n" << endl;
    //enter the question

    getline(cin, arr[i].question);
    cin.ignore();

    cout << "Enter the answer.\n" << endl;
    //enter the answer

    getline (cin, arr[i].answer);
    cin.ignore();

} 
```

这是测验你的输出格式。

```
 for(int j =0; j < count; j++){
    cout << "\n" << arr[j].question << endl;
    getline(cin, userguess);

    if(arr[j].answer.compare(userguess) !=0){
        cout << "Wrong. Keep trying!\n";
        incorrect++;
        total++;
    }
    if(arr[j].answer.compare(userguess) ==0){
        cout << "Nice job. Keep it up!\n";
        correct++;
        total++;
    } 
```

每当我提出问题时，它都不会在控制台中输出问题或让我输入答案。只是说错了。请帮忙？

编辑：这是整个代码：

```
// final PROJECT.cpp : Defines the entry point for the console application.

#include <iostream>
#include <string>
#include <fstream>
#include <stdlib.h>
#include <cstring>
#include <cstdio>
#include <stdio.h>
#include <tchar.h>
#include <string.h>
#include <cstdlib>

using namespace std;

struct flashcards{
string question;
string answer;
}FC1, FC2, FC3, FC4, FC5, FC6, FC7, FC8, FC9, FC10, FC11, FC12, FC13, FC14, FC15, FC16, FC17, FC18, FC19, FC20;

int _tmain(int argc, _TCHAR* argv[])

{
system ("color 4B");
string userguess;
string again;
flashcards arr[10000];
int count;
float correct=0;
float incorrect=0;
float total=0;
//one major problem, wont accept spaces.
cout<< "Flash Card Runner\n";
cout<< "This program was made by Jacob Malcy\n";
cout<< "Beta 3.8\n";
cout<< "IN ORDER FOR YOU TO HAVE MULTIPLE WORD FLASH CARDS,\n";
cout << "SKIP NUMBER ONE FLASHCARD QUESTION AND ANSWER!\n";
cout<< "This bug is currently being worked on.\n";
cout << "If you happen to have problems conntact Jacob.\n";
int choice;

cout<< "Would you like to create or test? Enter 0 for create and 1 for test.\n";
cin >> choice;
if(choice==0){
    //Creating new deck of cards
cout<< "How many flashcards do you want?\n";
cin >> count;
cin.clear();

for(int i =0; i < count; i++){
    cout << "Enter the question.\n" << endl;
    //enter the question

    getline(cin, arr[i].question);
    cin.ignore();

    cout << "Enter the answer.\n" << endl;
    //enter the answer

    getline (cin, arr[i].answer);
    cin.ignore();

}
}
else if(choice==1){
    //Reading in new file
    cout << "Reading file...\n";

    string line;
    ifstream myfile ("Save.txt");
    if (myfile.is_open())
    {
        count = 0;

        while ( myfile.good () )
        {
            getline (myfile,line);
            arr[count].question = line;
            cout << line << endl;

        getline (myfile,line);
        arr[count].answer = line;
        cout << line << endl;
        count++;

        }

        myfile.close();
    }

    else cout << "Unable to open the file";
}

do
{

for(int j =0; j < count; j++){
    cout << "\n" << arr[j].question << endl;
    getline(cin, userguess);

    if(arr[j].answer.compare(userguess) !=0){
        cout << "Wrong. Keep trying!\n";
        incorrect++;
        total++;
    }
    if(arr[j].answer.compare(userguess) ==0){
        cout << "Nice job. Keep it up!\n";
        correct++;
        total++;
    }

}
cout<< "The number of correct questions answered was: \n" << correct << endl;
cout<<"The number of total questions answered was: " << total <<"\n";
    cout<< "The number of incorrect questions answered was: \n" << incorrect << endl;
    //cout<< total;
    float percent = (correct/total)*100;
    cout<< "The total percent you got right is: \n" << percent << "% correct" << endl;
    system("pause");
    cout << "Would you like to run the quiz again?\n"
    << "Type y or Y to run this again. If not, enter any other letter.\n";
    cin >> again;
    if((again == "y") || (again == "Y")){
    correct=0;
    incorrect=0;
    total=0;
    }

}while((again == "y") || (again == "Y"));

ofstream myfile ("Save.txt");
if (myfile.is_open())
{

    for(int i =0; i <count; i++){

        myfile << arr[i].question << "\n";
        myfile << arr[i].answer << "\n";
    }
    myfile.close();

    }
else cout << "Unable to save file";

cout << "Your finished with the quiz. Goodbye!\n";

system("PAUSE");
return 0;
} 
```

当我运行它时，它会像这样

```
 Flash Card Runner
This program was made by Jacob Malcy
Beta 3.8
IN ORDER FOR YOU TO HAVE MULTIPLE WORD FLASH CARDS,
SKIP NUMBER ONE FLASH CARD QUESTION AND ANSWER!
This is a bug is currently being worked on.
if you happen to have problems, conntact Jacob.
Would you like to create or test? Enter 0 for create and 1 for test. 
```

如果我输入零：

```
How many flashcards do you want? 
```

说我输入两个 2

```
Enter the question.

Hi ho
Enter the answer.

Merry oh

enter the question.

fi fa
enter the answer.

fo fum 
```

然后它只是跳到：

```
Wrong. Keep trying!

erry oh 
```

在出错之前，它应该显示第一个问题，并给我回答的机会。它只是在我可以之前说错了。然后它显示缺少第一个字符的答案。你去吧。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T20:25:12.167

我想你是为了摆脱尾随`ignore`的`getline`换行符而立即打电话。

不要那样做。`std::getline`已经从流中提取换行符（并丢弃它），因此您将忽略下一行的第一个字符。

# javascript - 表中的扑克玩家列表使用 JSON 消失

> ID：16092358
> 
> 赞同：1
> 
> 时间：2013-04-18T20:23:07.877
> 
> 标签：javascript, json

我有 4 个 JSON 格式的玩家列表，并且 $.getJSON javascript 工作得很好，然后在我添加了 16 个 JSON 格式的玩家之后，表格中的玩家列表消失了。我做错了什么？

Javascript

```
$(document).ready(function() {
    $.getJSON("js/dataPokerPlayers.json", function(data) {
        $.each(data, function(i, data){
            $(".tableData tbody").append("<tr><td class=\"centertext\">" + data.rank + "</td><td>" + data.name + "</td><td class=\"centertext\">" + data.earnings + "</td><td class=\"centertext\">" + data.points + "</td><td class=\"centertext\">" + data.totalearnings + "</td></tr>");
        });
    });
}); 
```

JSON - [http://www.elitedeafpoker.com/dev/js/dataPokerPlayers.json](http://www.elitedeafpoker.com/dev/js/dataPokerPlayers.json)

我试图在 JSON 中删除所有 16 名球员，并让 4 名球员留在原来的位置，他们在桌面上表现得很好 - 发生了什么事？我只是为玩家的新数据复制/粘贴了 JSON 行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:25:41.403

您的 JSON 缺少一些逗号，即在第四行之后。

```
[ 
    {"rank": "1", "name": "Chad Demon", "earnings": "$9,600", "points": "345", "totalearnings": "$72,500"},
    {"rank": "2", "name": "Clay Chaman", "earnings": "$8,600", "points": "245", "totalearnings": "$42,500"},
    {"rank": "3", "name": "Christian Luneborg", "earnings": "$7,800", "points": "145", "totalearnings": "$52,500"},
    {"rank": "4", "name": "Steve Drills", "earnings": "$6,500", "points": "45", "totalearnings": "$2,250"},
    {"rank": "5", "name": "Paul Sims",  "earnings": "$5,600", "points": "345", "totalearnings": "$11,500"},
    {"rank": "6", "name": "Melissa Suzy", "earnings": "$4,600", "points": "245", "totalearnings": "$24,500"},
    {"rank": "7", "name": "Philiip Samon", "earnings": "$3,800", "points": "145", "totalearnings": "$2,500"},
    {"rank": "8", "name": "Steve Glass", "earnings": "$2,500", "points": "45", "totalearnings": "$2,000"},
    {"rank": "9", "name": "Sven Zebers",    "earnings": "$1,600", "points": "345", "totalearnings": "$12,500"},
    {"rank": "10", "name": "Chris Spabling", "earnings": "$1,000", "points": "245", "totalearnings": "$22,500"},
    {"rank": "11", "name": "John Cozz", "earnings": "$500", "points": "145", "totalearnings": "$52,500"},
    {"rank": "12", "name": "Karlan Suller", "earnings": "$485", "points": "45", "totalearnings": "$2,500"},
    {"rank": "13", "name": "Kim Uzi",   "earnings": "$350", "points": "345", "totalearnings": "$12,500"},
    {"rank": "14", "name": "Eric Borg", "earnings": "$325", "points": "245", "totalearnings": "$21,500"},
    {"rank": "15", "name": "Jasper Russo", "earnings": "$250", "points": "145", "totalearnings": "$52,500"},
    {"rank": "16", "name": "Bruce Willis", "earnings": "$225", "points": "45", "totalearnings": "$42,500"},
    {"rank": "17", "name": "Tim Burdlen",   "earnings": "$200", "points": "345", "totalearnings": "$82,500"},
    {"rank": "18", "name": "Matt Erickson", "earnings": "$175", "points": "245", "totalearnings": "$22,500"},
    {"rank": "19", "name": "Matt Sears", "earnings": "$125", "points": "145", "totalearnings": "$62,500"},
    {"rank": "20", "name": "Dong Smith", "earnings": "$100", "points": "45", "totalearnings": "$32,500"}
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:25:21.207

解析 JSON 文档时出错。文档可能格式不正确。

看起来你缺少逗号。

尝试使用[此工具](http://jsonformatter.curiousconcept.com/)来验证您的 JSON 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:25:21.920

如果您访问[http://www.jsonlint.com](http://www.jsonlint.com)并输入您的 JSON，您会看到主数组的项目之间缺少几个逗号。

# csv - 如何将 CSV 文件加载到 LiveCode 堆栈中？

> ID：16092361
> 
> 赞同：0
> 
> 时间：2013-04-18T20:23:25.267
> 
> 标签：csv, livecode

假设我有 fieldA、fieldB 和 fieldC 的背景，我想将 CSV 文件加载到堆栈中。CSV 文件有 A、B 和 C 三列。“加载”按钮的脚本是什么样的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:09:48.273

如果您只想逐字加载内容，那么

```
on mouseUp
  put url ("file:" & pathToFile) into tContents
end mouseUp 
```

会成功的。要将列放入字段中，您必须做更多的工作。单程：

```
on mouseUp
  put url ("file:" & pathToFile) into tContents
  -- set the itemDelimiter to tab -- if necessary
  repeat for each line tLine in tContents
    put item 1 of tLine & cr after field "fieldA"
    put item 2 of tLine & cr after field "fieldB"
    put item 3 of tLine & cr after field "fieldC"
  end repeat
end mouseUp 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T04:30:01.810

如果数据是干净的，CSV 文件通常具有由“;”分隔的字段 所以你可以用选项卡替换它们并使用“基本表字段”：

```
put url ("file:" & pathToFile) into tData
replace ";" with tab in tData
put tData into field "data" 
```

如果您的数据是 UTF8 或其他格式，您需要先对其进行翻译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T22:52:09.160

要将数据读入变量 lCsvData：

```
local lCsvData

on importCsv
  answer file "Chooose CSV file..."
  if it is not empty then
    put it into myPath
    put url ("binfile:" & myPath) into myData 
```

现在我们可以解码数据：

```
 put urlDecode(urlEncode(myData,"UTF8")) into myData 
```

问题：数据可以包含返回。让我们从项目中删除退货。如有必要，您可以单独处理每个项目。

```
 put empty into lCsvData
    set the itemDel to semicolon
    repeat for each line myLine in myData
      repeat for each item myItem in myLine
        put replaceText(myItem,cr,numToChar(14)) after lCsvData
      end repeat
      put cr after lCsvData
    end repeat
  end if
end importCsv 
```

现在你有了干净的数据。您可以通过以下方式选择一行并将其放入字段中：

```
on showLine theLine
  put line theLine of of lCsvData into myLine
  set the itemDel to semicolon
  repeat for each item myItem in myLine
    put replaceText(myLine,numToChar(14),tab) into fld 1
  end repeat
end showLine 
```

其中 theLine 是一个整数。您可以使用 cr 代替 tab，并且可以以任何您想要格式化输出字段的方式调整此脚本。

# python - SQLite NOT NULL 约束不适用于 INSERT OR IGNORE

> ID：16092365
> 
> 赞同：1
> 
> 时间：2013-04-18T20:23:45.377
> 
> 标签：python, sql, python-2.7, sqlite

我使用 Python 2.7 和 SQLite3。

这是代码：

```
#!/usr/bin/env python

import sqlite3
conn = sqlite3.connect('example.db')
c = conn.cursor()
c.execute('''CREATE TABLE stocks
             (transctionid text not null collate nocase primary key,
             trans text,
             symbol text not null,
             qty real,
             price real)''')
purchases = [('B1Jan', 'BUY', 'IBM', 1000, 45.00),
             ('C2Jan', 'BUY', 'MSFT', 1000, 72.00),
             ('D3Jan', 'SELL', 'IBM', 500, 53.00),
             ('d3jan', 'SELL', 'IBM', 500, 53.00),
             ('', 'SELL', 'IBM', 500, 53.00),
             ('E5Jan', 'SELL', '', 500, 53.00),
            ]
c.executemany('INSERT OR IGNORE INTO stocks VALUES (?,?,?,?,?)', purchases)
conn.commit()
for row in c.execute('SELECT * FROM stocks ORDER BY price'):
    print row
conn.close() 
```

结果是：

```
(u'B1Jan', u'BUY', u'IBM', 1000.0, 45.0)
(u'D3Jan', u'SELL', u'IBM', 500.0, 53.0)
(u'', u'SELL', u'IBM', 500.0, 53.0)
(u'E5Jan', u'SELL', u'', 500.0, 53.0)
(u'C2Jan', u'BUY', u'MSFT', 1000.0, 72.0) 
```

**INSERT OR IGNORE 仅适用于“PRIMARY KEY”约束。“NOT NULL”约束不起作用。**

根据[http://www.sqlite.org/lang_conflict.html](http://www.sqlite.org/lang_conflict.html)：

> 对于 INSERT 和 UPDATE 命令，关键字“ON CONFLICT”被替换为“OR”，这样语法读起来更自然。例如，我们用“INSERT OR IGNORE”代替“INSERT ON CONFLICT IGNORE”。... ON CONFLICT 子句适用于 UNIQUE 和 NOT NULL 约束（以及在本节中与 UNIQUE 约束相同的 PRIMARY KEY 约束）。

我预期的结果是：

```
(u'B1Jan', u'BUY', u'IBM', 1000.0, 45.0)
(u'D3Jan', u'SELL', u'IBM', 500.0, 53.0)
(u'C2Jan', u'BUY', u'MSFT', 1000.0, 72.0) 
```

顺便说一句，我怎么知道哪一行插入成功，哪一行在冲突中被忽略？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:37:08.357

空字符串不计为`NULL`，而是 0 长度的字符串。

`None`如果您希望插入 SQL ，请改用`NULL`：

```
purchases = [('B1Jan', 'BUY', 'IBM', 1000, 45.00),
             ('C2Jan', 'BUY', 'MSFT', 1000, 72.00),
             ('D3Jan', 'SELL', 'IBM', 500, 53.00),
             ('d3jan', 'SELL', 'IBM', 500, 53.00),
             (None, 'SELL', 'IBM', 500, 53.00),
             ('E5Jan', 'SELL', None, 500, 53.00),
            ] 
```

请参阅文档的[SQLite 和 Python 类型](http://docs.python.org/2/library/sqlite3.html#sqlite-and-python-types)部分`sqlit3`。

如果您需要知道行是否插入成功，请一一插入，`cursor.execute()`然后检查`cursor.rowcount`；`.rowcount`反映受影响的行数，对于您的调用`.executemany()`，其`NULL`值为 rowcount `3`，没有关于哪些行成功和哪些行失败的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:37:29.877

`''`与 NULL 不同。替换`''`为`None`：

如果您想知道哪些行违反了约束，请删除`OR IGNORE`并处理`sqlite3.IntegrityError`. 下面的代码示例一一插入行并打印（可以修改为写入文件、记录错误表等），以便您知道哪些值无法插入以及原因：

```
import sqlite3
conn = sqlite3.connect('example.db')
c = conn.cursor()
c.execute('''CREATE TABLE stocks
             (transctionid text not null collate nocase primary key,
             trans text,
             symbol text not null,
             qty real,
             price real)''')
purchases = [('B1Jan', 'BUY', 'IBM', 1000, 45.00),
             ('C2Jan', 'BUY', 'MSFT', 1000, 72.00),
             ('D3Jan', 'SELL', 'IBM', 500, 53.00),
             ('d3jan', 'SELL', 'IBM', 500, 53.00),
             (None, 'SELL', 'IBM', 500, 53.00),
             ('E5Jan', 'SELL', None, 500, 53.00)]
for purchase in purchases:
    try:
        c.execute('INSERT INTO stocks VALUES (?,?,?,?,?)', purchase)
    except sqlite3.IntegrityError as e:
        print "Couldn't insert row {}:\n {}".format(purchase, e)
        pass
conn.commit()
for row in c.execute('SELECT * FROM stocks ORDER BY price'):
    print row
conn.close() 
```

# wordpress - 为什么我的 /wp-content/uploads 文件夹中有一个“缓存”文件夹？

> ID：16092366
> 
> 赞同：5
> 
> 时间：2013-04-18T20:23:55.993
> 
> 标签：wordpress, caching, upload, thumbnails

我正在使用 WordPress 3.5.1。在我的网站上，我的帖子缩略图的图像路径，而不是直接链接到图像（即`/wp-content/uploads/image.jpg`）链接到`/wp-content/uploads/cache/image-slug/12314335235.jpg`

“插入帖子”的图像使用其原始 URL（即`/wp-content/uploads/image.jpg`）显示。缓存不知何故仅适用于帖子缩略图。

我已经搜索了为什么会发生这种情况，但没有找到任何解决方案。如果有什么不同，我曾经安装过 WP Super Cache，但是我已经正确停用并删除了插件已经有几天了。

为什么会发生这种情况，我该如何阻止它（并直接拉取图像）？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-11-30T07:38:54.883

启用/禁用缓存`wp-config.php`。

您可以利用的另一种缓存机制是默认的 WordPress 对象缓存。您可以使用 wp-config.php 文件启用或禁用本机 WordPress 对象缓存，如下所示。

```
define('WP_CACHE', true); 
```

`/* That's all, stop editing! Happy blogging. */`只需使用任何文本编辑器（记事本即可）直接在上面添加上述代码并保存文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-30T19:04:56.943

对我来说，是恶意软件自己安装到了我的网站、文档和缓存文件夹中，这是执行恶意代码的简单藏身之处（wordfence 标记了所有文件）。我无法通过 wp-files 插件删除它，所以我使用命令通过 ssh 删除它

cd /home/bitnami/apps/wordpress/htdocs

sudo rm -f -r 文档

# ajax - joomla 令牌没有被控制器方法识别

> ID：16092367
> 
> 赞同：1
> 
> 时间：2013-04-18T20:23:56.687
> 
> 标签：ajax, joomla, token

我正在尝试在 ajax 帖子上设置一个令牌，但没有被控制器方法识别。javascrip 看起来如下

```
jQuery(document).ready(function() {
    jQuery('#source').change(function() {
        jQuery('#fileupload').addClass('fileupload-processing');
        var data = jQuery('#source option:selected').val();
        jQuery.post('index.php', {
            'option': 'com_tieraerzte',
            'task': 'parser.importColumns',
            'tmpl': 'component',
            'token':'<?php echo JUtility::getToken()?>',
            'app': data,
            'dataType': 'html',
        }, function(result) {
            jQuery('td.add_column').html(result);
            jQuery('button#parse.btn').show();
            //edit the result here
            return;
        });
    }); 
```

令牌正在生成并发布

在控制器中，我检查了令牌的存在，但向我抛出了 Invalid Token

**控制器检查令牌**

```
 JRequest::checkToken('request') or jexit( 'Invalid Token' ); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T05:27:42.470

你快到了，只是有点混乱。Joomla！生成并提交表单令牌作为值为 1 的输入名称。因此，令牌在您的表单中如下所示：

`<input type="hidden" name="1LKJFO39UKSDJF1LO8UFANL34R" value="1" />`

考虑到这一点，通过 AJAX 提交时，您需要将参数名称设置为您的令牌名称，值为 1。我仅使用以下`jQuery('selector').serialize()`方法完成类似的操作：

```
Joomla.autoSave = function () {
  jQuery.ajax({
    url: "index.php?option=com_gazebos&task=product.apply&tmpl=component",
    type: "POST",
    data: jQuery("#product-form").serialize(),
    success: function (data) {
      console.log("autosaved");
    }
  });
}; 
```

这样做会拉入所有表单数据（包括来自隐藏输入的表单标记）并将其格式化为查询字符串，然后将其与请求一起发送。但是，在我看来，您可能不想这样做，您实际上只想提交一点数据，而不是整个表单。因此，让我们稍微修改一下代码以获得所需的效果：

```
/**
 * First, let's alias $ to jQuery inside this block,
 * then setup a var to hold our select list dom object.
 */
jQuery(document).ready(function ($) {
    var sourceSelect = $('#source');

    sourceSelect.change(function () {
        $('#fileupload').addClass('fileupload-processing');

        /**
         * Use the token as a parameter name and 1 as the value,
         * and move the dataType param to after the success method.
         */
        $.post('index.php',
          {
            'option':   'com_tieraerzte',
            'task':     'parser.importColumns',
            'tmpl':     'component',
            'app':      sourceSelect.val(),
            '<?php echo JSession::getFormToken()?>': 1
          },
          function(result) {
            $('td.add_column').html(result);
            $('button#parse.btn').show();
            //edit the result here
            return;
          },
          'html'
        );
    });
}); 
```

最后，此代码假设您在您的`view.html.php`或您的`views/parser/tmpl/default.php`. 如果你把它放在一个单独的`.js`文件中，那么你的 php 代码将不会执行并给你令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-28T14:51:42.187

在您的 ajax 调用方法中，使用 url 作为：

```
$.ajax({
              url: '/index.php?option=com_itemreview&task=item.userReviewVote&<?php echo JSession::getFormToken(); ?>=1',
              type: 'post',
              data: {'data': submitvalue},
              dataType: 'json',
              success: function(response) {
              }
}); 
```

有关更多信息，请参见此处：

[http://joomlabuzz.com/blog/27-preventing-cross-site-request-forgery-in-joomla](http://joomlabuzz.com/blog/27-preventing-cross-site-request-forgery-in-joomla)

[https://docs.joomla.org/How_to_add_CSRF_anti-spoofing_to_forms](https://docs.joomla.org/How_to_add_CSRF_anti-spoofing_to_forms)

# javascript - 如何滑动或移动这组 div

> ID：16092371
> 
> 赞同：0
> 
> 时间：2013-04-18T20:24:14.880
> 
> 标签：javascript, jquery, css

我有一组具有以下属性的**七个div：**

```
height: 100px;
width: 100px;
display: inline-block; 
```

我有一个包含这七个块的包装器 div，**只有足够的空间来容纳四个**并进行更改。

溢出是隐藏的。

如何制作此功能，以便当您单击并水平拖动或在移动设备上用手指滑动时，整行 div 块会滑动以显示先前隐藏的块？

请参考[这个 jsFiddle 的例子](http://jsfiddle.net/2pRBg/)。

我们可以在这里使用 css 或 jQuery。

*奖励，在容器边缘显示部分完全隐藏的 div。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:43:57.080

根据 jfriend00 的回答，我对此进行了修改，因此它可以在触摸/点击和鼠标移动时工作。

```
var last_x = null;
var holding = false;
//Mark the wrapper as clicked/touched
$('.wrapper').mousedown(function(){
    holding=true;
});
//We do this on document so that even if movement goes outside of the container the event will fire
$(document).mouseup(function(){
    holding=false;
});

$('.wrapper').mousemove(function(e){
    if(last_x === null || !holding) //If this is the first movement
    {
        last_x = e.pageX;
        return;
    }
    var ammount = e.pageX - last_x;
    $('.slider',this).css('margin-left', '+=' + ammount);
    last_x = e.pageX;
}); 
```

其工作原理的要点是，当在容器上检测到 mousedown 事件时，脚本开始跟踪所有鼠标移动并使用鼠标移动内容。当鼠标被释放时，它停止跟踪运动。

小提琴：http: [//jsfiddle.net/NvJam/2/](http://jsfiddle.net/NvJam/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:30:16.203

[`see here`](http://jsfiddle.net/2pRBg/1/)

```
 .wrapper {
        width: 900px;
        height: 100px;
        overflow: hidden;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:32:26.907

您可以放置​​一个额外的容器 div 并在该 div 上使用绝对定位来向左/向右移动项目。这是一个演示：

[http://jsfiddle.net/jfriend00/7edc9/](http://jsfiddle.net/jfriend00/7edc9/)

HTML 看起来像这样：

```
<div class="wrapper">
    <div class="slider">
        <div class="first">First</div>
        <div class="second">Second</div>
        <div class="third">Third</div>
        <div class="fourth">Fourth</div>
        <div class="fifth">Fifth</div>
        <div class="sixth">Sixth</div>
        <div class="seventh">Seventh</div>
    </div>
</div> 
```

您并不完全清楚您想如何在非触摸屏上移动它们，但这里有一些适用于按钮的事件处理程序：

```
$("#left").click(function() {
    $(".slider").stop(true, true).animate({left: "-=125px"}, 500);
});
$("#right").click(function() {
    $(".slider").stop(true, true).animate({left: "+=125px"}, 500);
}); 
```

可以为触摸事件连接类似的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T21:08:57.473

更好的解决方案：使用可拖动的 JQuery UI：

```
$('.slider').draggable({
    axis: 'x',
}); 
```

[http://jsfiddle.net/DCuGV/2/](http://jsfiddle.net/DCuGV/2/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T21:21:39.733

由于没有人提到[jQuery.Kinetic](https://github.com/davetayls/jquery.kinetic "jQuery.动力学")，我将添加以下内容：

```
<div class="carousel">
    <div class="wrapper">
        <div class="first">First</div>
        <div class="second">Second</div>
        <div class="third">Third</div>
        <div class="fourth">Fourth</div>
        <div class="fifth">Fifth</div>
        <div class="sixth">Sixth</div>
        <div class="seventh">Seventh</div>
    </div>
</div>

$('.carousel').kinetic(); 
```

演示：http: [//jsfiddle.net/louisbros/2pRBg/6/](http://jsfiddle.net/louisbros/2pRBg/6/)

# jquery - jqGrid - 解析 json 响应

> ID：16092372
> 
> 赞同：2
> 
> 时间：2013-04-18T20:24:23.437
> 
> 标签：jquery, jquery-plugins, jqgrid

我有一个 jqGrid 向我的服务器发送 ajax 请求。但是，我的服务器以完全不同的格式发送 json 响应（我无法更改它）。因此我需要解析来自服务器的响应，这样我的 jqGrid 才能正确显示数据。

如果我理解正确，我可以将**ajaxGridOptions**与**converters**一起使用。所以，我可以捕获响应并解析它。在我看来，转换器工作正常并正确解析响应。但是，jqGrid 不理解我解析的响应。它永远显示一条消息“正在加载...”（我可以在 firebug 中看到请求/响应很好，并且控制台中没有 javascript 错误）。

有人可以帮我吗？

这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/themes/redmond/jquery-ui.css" />
    <link rel="stylesheet" type="text/css" href="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.1.2/css/ui.jqgrid.css" />
</head><body>

<!-- IMPORT JS -->  
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.1.2/js/i18n/grid.locale-en.js"></script>
    <script type="text/javascript" src="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.1.2/js/jquery.jqGrid.min.js"></script>    

<script>

$(document).ready(function() {
    var parsedResponse = '{"currentPage" : "1", "totalRecords" : 5, "pageSize" : 3,'
            + '"myData" :[{"id" : "1", "name" : "Name 1" },'
            + '          { "id" : "3", "name" : "Name 3" },'
            + '          { "id" : "2", "name" : "Name 2" }]'
            + '}';

    var myGrid = $('<table>').attr( "id", "useraccount-search-datagrid");
    var myPager = $("<div>").attr("id", "useraccount-search-datagrid-pager");

    $("body").append(myGrid, myPager);

    myGrid.jqGrid({
        pager : myPager,
        // datastr: parsedResponse, // If I use these parameters and remove ajaxGridOptions then it will work fine with the local data
        // datatype : "jsonstring", // If I use these parameters and remove ajaxGridOptions then it will work fine with the local data
        serializeGridData : function(data) {
            return '{"SearchCriteria": {"keyword":"emai","orderByField":"userName","sortOrder":"DESC","pagination":{"pageSize":"10","pageNumber":"2"}}}';
        },
        ajaxGridOptions: {
            url: "../rush-controller-testing/userAccount/find",
            type: "POST",
            contentType: "application/json; charset=utf-8",         
            dataType: "json",
            converters: { "text json": function (responseText) {
                    // console.log(responseText); // Shows the response string from the cerver
                    return parsedResponse;
                }
            },
            success: function(data, textStatus, jqXHR ) {
                // Nice! It shows 'parsedResponse' from 'converters'. Looks good so far.
                console.log(data); console.log(textStatus); console.log(jqXHR);
            }
        },
        colModel : [
            { name : 'name', index : 'id', width : "500"}
        ],
        jsonReader: {
            root: "myData", page: "currentPage", records: "totalRecords" 
        },
        rowNum : 3,
        viewrecords : true,
        height : "auto",
        ignoreCase : true,
        hidegrid: false
    });

}); 
</script>
</body>
</html> 
```

**=== 更新 ===**

我的服务器响应类似于：

```
{"UserAccountSearchResult":{
    "userAccounts":[{
        "userAccountId":18,
        "clientAccount":{"clientAccountId":19,"name":"name:5791","firstName":"firstName:5791","lastName":"lastName:5791","active":true},
        "userName":"email@824504.com",
        "password":"password824504",
        "firstName":"firstName824504",
        "lastName":"lastName824504",
        "isActive":true,
        "phoneNumbers":{"phoneNumberId":36,"number":824504824504},
        "addresses":{"addressId":126,"country":"CANADA","provinceOrState":"ONTARIO","address":"address824504","city":"Windsor","postalCode":"postalCode824504"},
        "emails":{"emailId":36,"email":"secondaryEmail@824504.ca"}
        },{
        "userAccountId":44,
        "clientAccount":{"clientAccountId":45,"name":"name:3136","firstName":"firstName:3136","lastName":"lastName:3136","active":true},
        "userName":"email@796312.com",
        "password":"password796312",
        "firstName":"firstName796312",
        "lastName":"lastName796312",
        "isActive":true,
        "phoneNumbers":{"phoneNumberId":88,"number":796312796312},
        "addresses":{"addressId":298,"country":"CANADA","provinceOrState":"ONTARIO","address":"address796312","city":"Greater Sudbury","postalCode":"postalCode796312"},
        "emails":{"emailId":88,"email":"secondaryEmail@796312.ca"}
        }]
    ,"pagination":{"pageSize":10,"pageNumber":2,"totalItems":49}}} 
```

所以，我已经有了一个函数来解析这个响应，如下所示。我想将此解析后的响应与 jqGrid 一起使用，因为在我的应用程序中有很多这样的情况：

```
{"currentPage" : "1",   "totalRecords" : 2, "pageSize" : 3,
    "myData" :[{
        "id" : "1", "name" : "firstName824504", "email" : "secondaryEmail@824504.ca"
    },{
        "id" : "3", "name" : "firstName796312", "email" : "secondaryEmail@796312.ca"
    }]
}; 
```

**=== 最终代码 ===**

我让它工作了。谢谢您的帮助。这是我的功能示例。我希望它可以在未来帮助其他人。

```
$(document).ready(function() {
    /*
     * Here I will have a very complex logic to parse the response from the server in something jqGrid can understand.
     * Right now it is just a hard-coded string to make thinks easer to understand
     */ 
    function parseResponse(responseText){
        var parsedResponse = '{"currentPage" : "1", "totalRecords" : 5, "pageSize" : 3, "pageTotal" : 2,'
                + '"myData" :[{"id" : "1", "name" : "Name 1" },'
                + '          { "id" : "3", "name" : "Name 3" },'
                + '          { "id" : "2", "name" : "Name 2" }]'
                + '}';  
        return JSON.parse(parsedResponse);
    };

    var myGrid = $('<table>').attr( "id", "useraccount-search-datagrid");
    var myPager = $("<div>").attr("id", "useraccount-search-datagrid-pager");

    $("body").append(myGrid, myPager);

    myGrid.jqGrid({
        pager : myPager,
        // datastr: parsedResponse, // If I use these parameters and remove ajaxGridOptions then it will work fine with the local data
        datatype : "json",
        url: "../rush-controller-testing/userAccount/find",
        mtype: "POST",
        serializeGridData : function(data) {
            // That is just a hard-coded example to make things easier to understand. Will change it to a more complex logic later.
            return '{"SearchCriteria": {"keyword":"emai","orderByField":"userName","sortOrder":"DESC","pagination":{"pageSize":"10","pageNumber":"3"}}}';
        },
        ajaxGridOptions: {
            contentType: "application/json; charset=utf-8",
        },
        colModel : [
            { name : 'name', index : 'name', width : "500"}
        ],
        jsonReader: {
            repeatitems: false,
            root: function(data){
                //the actual data
                var result = parseResponse(data);
                return result.myData;
            },
            total: function(data) {
                //total pages for the query
                var result = parseResponse(data);
                return result.pageTotal;
            },
            page: function(data){
                //current page of the query
                var result = parseResponse(data);
                return result.currentPage;
            },
            records: function(data){
                //total number of records for the query
                var result = parseResponse(data);
                return result.totalRecords;
            } 
        },
        rowNum : 3,
        viewrecords : true,
        height : "auto",
        ignoreCase : true,
        hidegrid: false
    });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:24:52.320

您以错误的方式使用 jqGrid 选项。重要的是要了解 jqGrid 需要“知道”一些参数，例如`url`和`datatype`。如果`datatype`未指定，`"xml"`将使用默认值。

**您不应覆盖`ajaxGridOptions`jqGrid 中已存在的参数**。所以你应该正确使用jqGrid。如果 URL`"../rush-controller-testing/userAccount/find"`以您包含的格式返回数据，`parsedResponse`那么您的代码可能如下所示：

```
myGrid.jqGrid({
    url: "../rush-controller-testing/userAccount/find",
    datatype: "json",
    mtype: "POST",
    pager: "#useraccount-search-datagrid-pager",
    serializeGridData : function(data) {
        // the function is DUMMY. it MUST be replaced
        return '{"SearchCriteria": {"keyword":"emai","orderByField":"userName","sortOrder":"DESC","pagination":{"pageSize":"10","pageNumber":"2"}}}';
    },
    ajaxGridOptions: { contentType: "application/json; charset=utf-8" },
    colModel: [
        { name: 'id', key: true, width: 100 }
        { name: 'name', width: 400 }
    ],
    jsonReader: {
        root: "myData",
        page: "currentPage",
        records: "totalRecords",
        repeatitems: false
    },
    rowNum: 3,
    gridview: true,
    autoencode: true,
    viewrecords: true,
    height: "auto",
    ignoreCase: true,
    hidegrid: false
}); 
```

确实需要使用`repeatitems: false`内部属性。`jsonReader`我认为您不需要使用任何`converters`jQuery.ajax。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:19:49.737

查看jqGrid wiki 上的[数据操作页面。](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aretrieving_data)我想`jsonReader`可能是你正在寻找的。

# twitter - TwitterJS 和 Twitter 1.1 API

> ID：16092379
> 
> 赞同：1
> 
> 时间：2013-04-18T20:24:56.387
> 
> 标签：twitter, twitter-streaming-api

5 月 7 日之后，Twitter 1.0 API 将消失，TwitterJS 会不再工作吗？

[https://code.google.com/p/twitterjs/](https://code.google.com/p/twitterjs/)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:35:35.160

在研究了更多之后，我能够回答我自己的问题：它不会。

TwitterJS.js API 使用 1.0 和 v1 方法：

```
 protocol = document.location.protocol.substr(0, 4) === 'http' ? document.location.protocol : 'http:',
  URLS = {
    search: protocol + '//search.twitter.com/search.json?q=%search%&page=%page|1%&rpp=%limit|100%&since_id=%since|remove%&result_type=recent&include_entities=true', // TODO allow user to change result_type
    timeline: protocol + '//api.twitter.com/1/statuses/user_timeline.json?screen_name=%user%&count=%limit|200%&page=%page|1%&since_id=%since|remove%include_rts=%rts|false%&include_entities=true',
    list: protocol + '//api.twitter.com/1/%user%/lists/%list%/statuses.json?page=%page|1%&per_page=%limit|200%&since_id=%since|remove%&include_entities=true&include_rts=%rts|false%',
    favs: protocol + '//api.twitter.com/1/favorites/%user%.json?include_entities=true&skip_status=true&page=%page|1%&since_id=%since|remove%',
    retweets: protocol + '//api.twitter.com/1/statuses/retweeted_by_user.json?screen_name=%user%&include_entities=true&count=%limit|200%&since_id=%since|remove%&page=%page|1%'
  }, 
```

# csv - GDAL 和 OGR 虚拟格式，读取 *.csv 文件并创建行的 shapefile

> ID：16092382
> 
> 赞同：2
> 
> 时间：2013-04-18T20:25:14.603
> 
> 标签：csv, shapefile, gdal

我有一个文本文件 (*.csv) 并已在该文件中成功定义 XYZ 以编写点的 shapefile：

```
ogr2ogr -f "ESRI Shapefile" testing.shp conduitout.vrt 
```

我的 *.vrt 文件如下所示：

```
<OGRVRTDataSource>
    <OGRVRTLayer name="conduitout">
        <SrcDataSource>conduitout.csv</SrcDataSource>
        <GeometryType>wkbPoint</GeometryType>
        <LayerSRS>EPSG:2232</LayerSRS>
        <GeometryField encoding="PointFromColumns" x="start1" y="start2" z="start3"/>
    </OGRVRTLayer>
</OGRVRTDataSource> 
```

如何更改它以便我可以编写行的 shapefile？我的输入文件 (*.csv) 中有 X1、Y1、Z1 和 X2、Y2、Z2。我想我通过在我的 *.vrt 文件中定义以下内容来做到这一点：

```
<OGRVRTDataSource>
    <OGRVRTLayer name="conduitout">
        <SrcDataSource>conduitout.csv</SrcDataSource>
        <GeometryType>wkbMultiLineString</GeometryType>
        <LayerSRS>EPSG:2232</LayerSRS>
        <GeometryField encoding="WKB" />
    </OGRVRTLayer>
</OGRVRTDataSource> 
```

但我不确定如何从 *.csv 文件的列中定义每一行的起点和终点。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T11:29:23.293

对于 Wkb 和 Wkt，您的几何图形应位于包含有效 Wkb 或 Wkt 格式的单列中。在下面的示例中，我使用 WKT 编码，因为它更具可读性。另请注意，Wkt 几何图形使用逗号，因此您的文件不能使用逗号作为分隔符。

“csv”文件：

```
Name;Lines
"Line1";LINESTRING (30 10, 10 30, 40 40)
"Line2";LINESTRING (5 10, 0 30, -30 40) 
```

和 vrt 文件：

```
<OGRVRTDataSource>
       <OGRVRTLayer name="Linestest">
        <SrcDataSource SEPARATOR="SEMICOLON">D:\indata.csv</SrcDataSource> 
        <SrcLayer>indata</SrcLayer> 
        <GeometryType>wkbLineString</GeometryType> 
        <GeometryField encoding="WKT" field="Lines"/>
      </OGRVRTLayer>
</OGRVRTDataSource> 
```

有关几何图形的 Wkt 和 Wkb 格式的更多信息，请参见 Wikipedia： [http ://en.wikipedia.org/wiki/Well-known_text](http://en.wikipedia.org/wiki/Well-known_text)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-23T13:07:37.427

利用 ”`LINESTRING()" instead of LINESTRING()`

应用于前面的例子：

“csv”文件：

```
Name;Lines
"Line1";"LINESTRING (30 10, 10 30, 40 40)"
"Line2";"LINESTRING (5 10, 0 30, -30 40)" 
```

# bash - 如何使用bash显示文件中目录的内容

> ID：16092389
> 
> 赞同：0
> 
> 时间：2013-04-18T20:25:23.020
> 
> 标签：bash, cp

我想将目录的文件名复制到电子表格中。我不关心文件的内容，只关心名称。我将使用此命令，以便为特定应用程序提供详细的文档。

我目前有： cp //server_name/path/* /d/path

我正在寻找类似 >> 或 -print 和文件名的东西来创建和保存存储在目录中的文件的名称；IE，

文件名 = file_list.csv

文件内容：

word.exe notepad.exe 等等等等等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:34:30.047

`ls your/dir/path/here > your/file/path/here`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:29:42.960

```
DEST_PATH=/d/path/file_list.csv

cd <directory-with-file-names>
for f in *
do
    echo "$f" >> $DEST_PATH
done 
```

# api - 获取 Rally 中日程状态的对象 ID

> ID：16092392
> 
> 赞同：0
> 
> 时间：2013-04-18T20:25:34.187
> 
> 标签：api, rally, lookbackapi

我已经在我们组织的工作区中设置了一个包含五个计划状态的“复选框组”。我想使用带有选定计划状态的 Lookback API 作为过滤器进行查询。由于 LBAPI 由 ObjectID 驱动，因此我需要传入调度状态的 ID 表示，而不是它们的名称。有没有一种快速的方法来获取这些 ID，以便我可以将它们与复选框条目相关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:55:41.260

Lookback API 将接受字符串值的 ScheduleStates 作为查询参数。因此以下查询：

```
{
    find: {
        _TypeHierarchy: "HierarchicalRequirement",
        "ScheduleState": "In-Progress",
        __At:"current"
    }
} 
```

对我来说正常工作。如果您想要/需要 OID，并将 &fields=true 添加到 REST 查询 URL 的末尾，您会注意到返回以下信息：

```
GeneratedQuery: {
    { "fields" : true,
      "find" : { "$and" : [ { "_ValidFrom" : { "$lte" : "2013-04-18T20:00:25.751Z" },
                "_ValidTo" : { "$gt" : "2013-04-18T20:00:25.751Z" }
              } ],
          "ScheduleState" : { "$in" : [ 2890498684 ] },
          "_TypeHierarchy" : { "$in" : [ -51038,
                  2890498773,
                  10487547445
                ] },
          "_ValidFrom" : { "$lte" : "2013-04-18T20:00:25.751Z" }
        },
      "limit" : 10,
      "skip" : 0
    }
} 
```

您会在此处注意到 ScheduleState OID：

`"ScheduleState" : { "$in" : [ 2890498684 ] }`

因此，您可以在不同的 ScheduleState 上运行几个示例查询并找到它们对应的 OID。

# apache-flex - Flex：在组合框更改时获取它的先前值

> ID：16092393
> 
> 赞同：1
> 
> 时间：2013-04-18T20:25:37.497
> 
> 标签：apache-flex, events, combobox

我需要知道组合框改变的值，当它改变时。我已经浏览了所有事件的文档，但在用户交互更改它之前，它们都没有让您知道值是什么。（`currentStateChanging`完全是红鲱鱼！）处理`open`事件并保存值不是解决方案，因为还有其他方法可以更改值。

我正在使用 Flex 3.5 SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:05:00.160

像这样的东西？

```
var currentVal : Object;

private function onChange(newVal) : void {
    // currentVal stores your previous value - do something with it
    currentVal = newVal;
}

<mx:ComboBox change="onChange(event.target.selectedItem)"/> 
```

我刚刚在 Spark ComboBox 上使用了“更改”事件来解决这个问题，但它在 mx 版本上不可用

也 - 看到[这个](https://stackoverflow.com/questions/1499676/flex-combobox-prechange-event?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T14:13:09.617

我得出的结论是没有答案:(最好的解决方法是覆盖所有可能的方法来设置组合框的值，并处理任何涉及用户更改值的事件，备份那个值，然后你有一个以前的值的踪迹。然后，放很多评论说

> 这是一个 3.5-必要的 kluge！如果在另一个 SDK 上执行此操作，您可能需要更改它！

=======

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T14:29:45.180

我提出了 w/a 解决方案，但它并不完全可靠（因为它假设它将如何在其他 SDK 中工作）并且它的优雅是需要的：

```
<mx:ComboBox    xmlns:mx="http://www.adobe.com/2006/mxml" valueCommit="OnChangeAnyway()" change="OnChange()">
<mx:Metadata>
    [Event(name='traceable_change', type="assets.LineComboChangeEvent")]
</mx:Metadata>

<mx:Script><![CDATA[
    public static const CHANGE:String = 'traceable_change';

    private var m_oOld:Object;
    private var m_oNew:Object;
    private var m_bCallLaterPending:Boolean = false;  //This is necessary, because I found OnChangeAnyway() could be called any number of times before OnChange() is

    private function OnChange():void {
        var oNewEvent:LineComboChangeEvent = new LineComboChangeEvent(CHANGE, m_oOld);   //there's nothing special in this class
        dispatchEvent(oNewEvent);
    }

    private function OnChangeAnyway():void {
        if (!m_bCallLaterPending) {
            m_bCallLaterPending = true;
            callLater(function ():void { m_bCallLaterPending = false;}, []);   //presumably, whatever is passed to callLater() will be executed after everything else currently queued
            m_oOld = m_oNew;
            m_oNew = value;
        }
    }
]]></mx:Script> 
```

`m_oNew`显然是多余的，因为该值将可用于任何句柄`traceable_change`，但它确实解释了为什么我必须桶移这些对象。我认为这不可靠有几个原因：

1.  它假定`valueCommit`处理程序将在处理程序之前被调用`change`。在我的系统上，它似乎总是如此，但我在任何地方都看不到那个承诺。
2.  它假定`callLater()`之后调用的任何调用`change`都是。请参阅关注点 1。

# php - Symfony2：自定义实体？

> ID：16092396
> 
> 赞同：0
> 
> 时间：2013-04-18T20:25:46.450
> 
> 标签：php, symfony, doctrine

[这个](https://stackoverflow.com/questions/15981639/symfony2-class-not-found-in-the-chain-in-two-bundle-relationship/16052465#16052465)问题中提出的问题的解决方案是客户端实体被拆分到两个数据库 - 一个本地，一个外部，是构建本地客户端，使其包含外部客户端作为对象并具有获取器/设置器来维护外部客户对象。本地关系在本地 Client 实体中维护。现在的问题是如何最好地创建 Client 实体，以便它可以在多个地方使用。

### 当前客户端控制器方法

```
public function getClient($id = null) {
    if (!empty($id)) {
        $localEm = $this->getDoctrine()->getManager();
        $foreignEm = $this->getDoctrine()->getManager('split');

        $client = $localEm->getRepository('ManaClientBundle:Client')->find($id);
        $foreignId = $client->getCid();
        $foreignClient = $foreignEm->getRepository('ManaSplitBundle:Client')->find($foreignId);

        $client->setForeignClient($foreignClient);
    } else {
        $client = new Client();
        $client->setForeignClient(new ForeignClient());
    }
    return $client;
} 
```

尝试在客户端存储库中执行此操作或类似操作失败。正如尝试将以下服务注入独立类一样。这失败了，缺少有关构造函数的参数 1 的错误。

### services.yml 片段：

```
 foreign_client:
        class: Mana\ClientBundle\DataCombine\ClientCombine
        arguments:
          localEm: @doctrine.orm.entity_manager
          foreignEm: @doctrine.orm.split_entity_manager 
```

### ClientCombine 类片段：

```
namespace Mana\ClientBundle\DataCombine;

use Doctrine\ORM\EntityManager;

class ClientCombine {

    private $localEm;
    private $foreignEm;

    public function __construct(EntityManager $localEm, EntityManager $foreignEm) {
        $this->localEm = $localEm;
        $this->foreignEm = $foreignEm;
    }
...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:04:54.957

我使用两个实体 Beverage 和 Beer。每个都有自己的实体管理器。啤酒是冰镇的，饮料是冷冻的。我的策略是获取这两种类型的实体的列表，然后在饮料方面将它们配对，然后将它们配对。单个实体也存在类似的功能。但是，如果您处理实体列表，则需要批量处理，否则您将有一个额外的查询*FOR EACH ENTITY ON THE LIST*。这是不好的。

以下已经，我相信所有非必要的部分都被剥离了。这是一种痛苦而麻烦的方法。我可以通过采用基于模式的方法来放弃它，因为您可以在学说规范中指定模式。但是，这段代码确实为我完成了这项工作。

你已经被反复警告过，（实际上是在其他问答对中被我警告过。）

一个超级控制器，你的控制器应该扩展它以获得婚姻功能。

```
 <?php

    namespace beverage\beverageBundle\Controller;

    use Symfony\Component\HttpFoundation\Request;
    use Symfony\Bundle\FrameworkBundle\Controller\Controller;

    class ThawController extends Controller
    {
        public static function defrost( $controller, $beverages ) {
            $em = $controller->getDoctrine()->getManager( 'frosty' );
            $beverageIds = array();
            foreach ( $beverages as $k =>$v ) {
                array_push( $beverageIds, $v->getIceid() );
            }

            $qb=$em->getRepository( 'frostyfrostyBundle:Beer' )
            ->createQueryBuilder( 't' )
            ;
            if ( array() == $beverageIds ) {return null;}
            $qbeers=$qb->where( $qb->expr()
                ->in( 't.id', $beverageIds ) )
            ->getQuery()
            ->getResult();
            foreach ( $qbeers as $k => $beer ) {
                $id=$beer->getId();
                $beers[$id]=$beer;
            }
            foreach ( $beers as $k => $beer ) {
            }
            foreach ( $beverages as $k => $beverage ) {
                $beverage->ice( $beers[$beverage->getIceid()] );
            }

            return $beverages;
        }

        public static function thaw( $controller, $beverage ) {
            $beer= null;
            $em = $controller->getDoctrine()->getManager( 'frosty' );
            $beer=$em->getRepository( 'frostyfrostyBundle:Beer' )
            ->createQueryBuilder( 't' )
            ->where( 't.id = '.$beverage->getIceid() )
            ->getQuery()
            ->getSingleResult();
            $beverage->ice( $beer );
            return $beverage;
        }
    } 
```

和实体代码：

```
 <?php

    namespace freezer\freezerBundle\Entity;

    use Doctrine\ORM\Mapping as ORM;
    use frosty\frostyBundle\Entity\Beer as beer;

    class Student {
        private $id;
        private $iceid;

        public function getId() {
            return $this->id;
        }

        public function setIceid( $iceid ) {
            $this->iceid = $iceid;

            return $this;
        }

        public function getIceid() {
            return $this->iceid;
        }

        public function __construct( beer $beer=null
                                   , $manyToMany = null ) {
            if ( $beer instanceof \frosty\frostyBundle\Entity\Beer ) {
                $this->ice( $beer, $manyToMany );
            }
        }

        public function setBeer( \frosty\frostyBundle\Entity\Beer $beer=null){
            $this->beer = $beer;

            return $this;
        }

        public function getBeer() {
            return $this->beer;
        }

        public function ice( snowflake $snowflake=null
                           , $manyToMany = null ) {
            if ( $snowflake instanceof 
                 \frosty\frostyBundle\Entity\Beer ) {
                $methods=get_class_methods( get_class( $snowflake ) );
                $methods=array_filter( $methods
                                     , function( $item ) use ( &$methods ) {
                                           next( $methods );
                                           if ( "__" == substr($item 0,2)) 
                                               return false;
                                           if ( "remove" == substr($item,0,6))
                                               return false;
                                           if ( "get" == substr($item,0,3)) 
                                               return false; 
                                           return true;
                                        } );

                $amethods=array_filter( $methods
                                      , function( $item ) use ( &$methods ) {
                                            next( $methods );
                                            if ( "set" == substr($item,0,3)) 
                                                return false;
                                            return true;
                                       } );

                $methods=array_filter( $methods
                                     , function( $item ) use ( &$methods ) {
                                           next( $methods );
                                           if ( "add" == substr($item,0,3)) 
                                               return false;
                                           return true;
                                       } );

                foreach ( $methods as $k => $v ) {
                    $this->{$v}( $snowflake->{str_replace( "set"
                                                         , "get"
                                                         , $v )}() );
                }

                foreach ( $amethods as $k => $v ) {
                    if ( $manyToMany ) {
                        $results=$snowflake->{str_replace( "add"
                                                         , "get"
                                                         , $v )}();
                        foreach ( $results as $key =>$value ) {
                            $this->{$v}( $value );
                        }
                    }
                }
                $this->setIceid( $beer>getId() );
            }
        }

    } 
```

# javascript - 从打印对话框返回焦点后单击链接

> ID：16092402
> 
> 赞同：0
> 
> 时间：2013-04-18T20:25:53.660
> 
> 标签：javascript, jquery, focus, printdialog

我有一个网页可以在加载时显示打印对话框。单击打印（并返回页面焦点）后，我需要单击一个链接。有谁知道我可以做到这一点的使用 jQuery 或 Javascript 的方法吗？

这是我目前拥有的，但它似乎不起作用：

```
<script type="text/javascript">
    $(document).ready(function() {
        window.print();
        $("body").bind("focus", function(){ $("#logout").click() });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:46:17.287

试试这个：

```
<script type="text/javascript">
    $(document).ready(function() {
        if (window.print()) 
            location.href = $("#logout").attr('href');
        else
            location.href = $("#logout").attr('href');
    });
</script> 
```

和

```
<body>
    <a id="logout" href="http://www.google.it">Link</a>
</body> 
```

# django - Django 表单保存，但不重定向

> ID：16092403
> 
> 赞同：0
> 
> 时间：2013-04-18T20:25:55.260
> 
> 标签：django, forms, redirect, response.redirect, django-forms

基础：我正在尝试使用新的唯一 url 显示表单信息以及提交时的视图。表单当前正在保存到数据库，但不会重定向到新的 url 或视图。下面我发布了views.py 和urls.py。如果您需要查看其他内容，请告诉我。

注意：这是基于 ModelForm 的，我是 Django 的初学者。

提前致谢！

网址.py

```
from django.conf.urls import patterns, include, url

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
url(r'^letter/testing/$', 'letter.views.letter'),
url(r'^letter/testing/(?P<pk>\d+)/$','letter.views.submission'),

# Uncomment the admin/doc line below to enable admin documentation:
url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

# Uncomment the next line to enable the admin:
url(r'^admin/', include(admin.site.urls)), 
```

)

视图.py

```
# Create your views here.
from django.http import HttpResponseRedirect
from django.shortcuts import render_to_response, get_object_or_404
from django.template import RequestContext
from letter.forms import LetterForm
from letter.models import Letter

def submission(request, pk):
    submission = get_object_or_404(Letter, pk=int(pk))
    return render_to_response('post.html', {'submission':submission})

def letter(request):
if request.method == "POST":
    letter = LetterForm(request.POST)

    if letter.is_valid():
        try: 
            new_letter = letter.save()
            return HttpResponseRedirect('/letter/testing/%d/' % new_letter.pk)
        except:
            pass        

else:
    letter = LetterForm()

return render_to_response('letter.html',
        {'letter':letter},
        context_instance=RequestContext(request)) 
```

解答： 需要删除 if letter.is_valid() 下的 try/except 参数

谢谢@mattg！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T23:46:19.410

需要去掉下的`try`和`except`参数`if letter.is_valid()`

# ruby-on-rails - 在另一个模型的表单中检查一个模型中的字段：Rails

> ID：16092405
> 
> 赞同：0
> 
> 时间：2013-04-18T20:26:04.627
> 
> 标签：ruby-on-rails

如果在不同的模型上满足条件，我正在尝试在表单中显示某些字段。

这是示例：

```
<%= form_for(@workout) do |f| %>
    <%= f.fields_for :workout_exercises do |s| %>
    <%= s.collection_select :exercise_id, Exercise.all, :id, :name, { :include_blank => ""} %>              
    <%= s.label :sets %>:
    <%= s.number_field :set %>
    <% if @exercise.is_cardio == true %>
        <%= s.label :time %>(Minutes):
        <%= s.number_field :time %>     
    <% end %>
    <% end %>

   <%= f.submit %>
<% end %> 
```

上面给出了一个无方法错误`is_cardio`是有氧运动是练习表中的布尔字段

谢谢！

编辑：

```
class Exercise < ActiveRecord::Base

  has_many :workout_exercises
  has_many :workouts, :through => :workout_exercises

end

class Workout < ActiveRecord::Base

  has_many :workout_exercises
  has_many :exercises, :through => :workout_exercises

class WorkoutExercise < ActiveRecord::Base

  belongs_to :exercise
  belongs_to :workout
end 
```

编辑2：

具体来说，这是我得到的错误：

```
undefined method `is_cardio' for #<Array:0x007fcd3bb93dd0> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:39:39.153

我的猜测是你需要改变

```
<% if @exercise.is_cardio == true %>
    <%= s.label :time %>(Minutes):
    <%= s.number_field :time %>     
<% end %> 
```

到

```
<% if s.object.exercise.is_cardio == true %>
    <%= s.label :time %>(Minutes):
    <%= s.number_field :time %>     
<% end %> 
```

# r - 多个变量的组均值和标准差

> ID：16092407
> 
> 赞同：2
> 
> 时间：2013-04-18T20:26:05.173
> 
> 标签：r, standards, mean, deviation

我确信这个问题之前已经回答过了，但是我想通过同时处理多个变量（100s）来计算均值和标准差，并且除了使用冗长的 ddply 代码之外无法弄清楚如何做到这一点。

这是我的数据框（g）的一部分：

```
 trt blk til res sand silt clay ibd1_6 ibd9_14 ibd_ave
1  CTK   1  CT   K   74   15   11  1.323   1.593   1.458
2  CTK   2  CT   K   71   15   14  1.575   1.601   1.588
3  CTK   3  CT   K   72   14   14  1.551   1.594   1.573
4  CTR   1  CT   R   72   15   13  1.560   1.647   1.604
5  CTR   2  CT   R   73   14   13  1.612   1.580   1.596
6  CTR   3  CT   R   73   13   14  1.709   1.577   1.643
7  ZTK   1  ZT   K   72   16   12  1.526   1.546   1.536
8  ZTK   2  ZT   K   71   16   13  1.292   1.626   1.459
9  ZTK   3  ZT   K   71   17   12  1.623   1.607   1.615
10 ZTR   1  ZT   R   66   16   18  1.719   1.709   1.714
11 ZTR   2  ZT   R   67   17   16  1.529   1.708   1.618
12 ZTR   3  ZT   R   66   17   17  1.663   1.655   1.659 
```

我想要一个函数来做 ddply 所做的事情，即 ddply(g, trt, meanSand=mean(sand), sdSand=sd(sand), meanSilt=mean(silt)...) 而无需编写它全力以赴。有任何想法吗？感谢您的耐心等待！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:34:40.090

您可能希望应用于数据框的函数是`aggregate()`使用`mean`或`sd`作为函数参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T21:02:52.713

假设`myDF`是您的原始数据集：

```
library(data.table)
myDT <- data.table(myDF)

# Which variables to calculate  All columns but the first five? : 
variables <- tail( names(myDT), -5)

myDT[, lapply(.SD, function(x) list(mean(x), sd(x))), .SDcols=variables, by=list(trt, til)]

## OR Separately, if you prefer shorter `lapply` statements
myDT[, lapply(.SD, mean), .SDcols=variables, by=list(trt, til)]
myDT[, lapply(.SD, sd),   .SDcols=variables, by=list(trt, til)] 
```

--

```
> myDT[, lapply(.SD, mean), .SDcols=variables, by=list(trt, til)]
#    trt til     silt     clay   ibd1_6  ibd9_14  ibd_ave
# 1: CTK  CT 14.66667 13.00000 1.483000 1.596000 1.539667
# 2: CTR  CT 14.00000 13.33333 1.627000 1.601333 1.614333
# 3: ZTK  ZT 16.33333 12.33333 1.480333 1.593000 1.536667
# 4: ZTR  ZT 16.66667 17.00000 1.637000 1.690667 1.663667

> myDT[, lapply(.SD, sd), .SDcols=variables, by=list(trt, til)]
#    trt til      silt      clay     ibd1_6     ibd9_14    ibd_ave
# 1: CTK  CT 0.5773503 1.7320508 0.13908271 0.004358899 0.07112196
# 2: CTR  CT 1.0000000 0.5773503 0.07562407 0.039576929 0.02514624
# 3: ZTK  ZT 0.5773503 0.5773503 0.17015973 0.041797129 0.07800214
# 4: ZTR  ZT 0.5773503 1.0000000 0.09763196 0.030892286 0.04816984 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T20:49:11.270

```
aggregate(g[, c("sand", "silt", "clay")],  g$trt, function(x) c(mean=mean(x), sd=sd(x) ) ) 
```

使用匿名函数`aggregate.data.frame`允许一个人通过一次调用获得两个值。您只想传入要聚合的列。如果您有很长的列列表并且只想从计算中排除前 4 个列，则可以写为：

```
aggregate(g[, names(g)[-(1:4)],  g$trt, function(x) c(mean=mean(x), sd=sd(x) ) ) 
```

# security - 如何测试 jmx-console.war 是否在 JBoss 4.2.2 中使用？

> ID：16092414
> 
> 赞同：0
> 
> 时间：2013-04-18T20:26:15.303
> 
> 标签：security, jboss, console, jmx, nessus

在 .\jboss-4.2.2.GA\server\default\deploy 文件夹中有一个文件，名为“jmx-console.war”。我遇到了一个处理这个模块的安全漏洞。我如何判断我们的应用程序是否正在使用此模块。我实现了一个开源工具，但我不确定如何测试它是否被使用。

**高严重性的 Nessus 漏洞：**

***JBoss JMX 控制台无限制访问***

[http://www.tenable.com/plugins/index.php?view=single&id=23842](http://www.tenable.com/plugins/index.php?view=single&id=23842)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T20:30:50.060

如果您在 deploy 文件夹中看到该 war 文件，那么很可能您的应用程序正在使用它。也就是说，它最有可能被加载。假设您知道 JBoss 实例正在侦听的 HTTP 端口，它应该很容易测试。默认情况下，它是**8080**，因此将您的浏览器指向**http://[您的 jboss 主机]:8080/jmx-console**并查看控制台是否出现，请记住它可能受密码保护，而您的 HTTP 端口可能没有为8080。

**您还应该在server.log**或配置的等效项中看到类似的内容：

> 11:52:30,165 信息主 [TomcatDeployer] 部署，ctxPath=/jmx-console，warUrl=.../deploy/jmx-console.war/

话虽如此，我可以想到有几种方法可以指示或导致 jmx-console 未部署：

*   您引用的文件夹位于**默认**服务器目录中。这只是 3 个实例中的一个（默认、全部、最小），您可能正在运行其他实例之一，甚至是自定义配置的服务器。也就是说，如果您正在运行**最小的**服务器实例，或者一个不包含 jmx-console.war 的服务器实例，那么该文件在默认服务器的部署目录中的存在不会导致它被部署到另一台服务器的实例中. （这一切听起来比实际上更复杂）
*   deploy 目录中的 War 文件依赖于*另一个*名为**jboss-web.deployer 的**目录，它实际上部署了 war 文件。如果该目录不存在，我的猜测是战争部署已被禁用。不过不太可能，因为有更简单的方法可以做到这一点，如果有人不小心删除了这个文件夹，他们可能也会删除战争。

底线是，最简单的方法是找到 http 端口，然后点击 jmx-console URL 并查看它是否响应，或者检查日志文件。可以想象，有人*可以*将 jmx-console.war 重命名为其他名称（也许是一种不明智的隐藏它的尝试？）在这种情况下，您需要执行一系列 http 请求扫描并尝试找到一个 jmx-控制台签名，但这超出了我（否则相当大......）的专业领域。

# ios - 嵌入式 UINavigationController 的后退按钮不起作用

> ID：16092419
> 
> 赞同：3
> 
> 时间：2013-04-18T20:26:24.530
> 
> 标签：ios, uinavigationcontroller, uikit, uicontainerview

我`Container View`通过界面构建​​器使用控件将 a`UINavigationController`及其堆栈嵌入到我的应用程序中。

我遇到的问题是后退按钮不适用于根 VC 上的所有推送 VC。

在这些推送的 VC 上按下自动生成的后退按钮，没有任何反应。

**编辑：**

没有写代码。目前，它全部在 IB 中设置。

![在此处输入图像描述](https://i.stack.imgur.com/tT7Kk.png)

如您所见...容器视图及其嵌入式视图控制器设置为 UInavigation 控制器。左边的空白最终将是一个可滑动的菜单 - 这就是设置的原因。然后在根 RV 上有一个下一步按钮，它连接到第二个视图控制器。

![在此处输入图像描述](https://i.stack.imgur.com/tI7Ud.png)

该状态如上所示。按下后退按钮（标记为测试）什么也不做。通常它会弹出顶视图控制器并返回“测试”。显然，嵌入以某种方式干扰了正常的 UINavigiationController 功能。

我只是不知道怎么做。

**另一个编辑：**

在该顶部视图控制器上制作一个自定义按钮并手动调用

```
 [self.navigationController popViewControllerAnimated:true]; 
```

实际工作，顶视图控制器从堆栈中删除。

所以问题是为什么后退按钮不起作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-24T17:55:03.200

当我忘记在导航栏中添加了轻击手势识别器时，我遇到了类似的问题。后退按钮实际上收到了触摸（按下状态），但在你的例子中什么也没做。导航栏上的自定义按钮虽然有效。一旦我删除了手势识别器，后退按钮就会再次起作用。

也许你的容器视图中的一些其他视图/或手势识别器正在捕捉触摸......

# java - 检查导航栏

> ID：16092431
> 
> 赞同：56
> 
> 时间：2013-04-18T20:27:11.653
> 
> 标签：java, android, layout, android-4.0-ice-cream-sandwich, android-4.2-jelly-bean

我正在尝试检查加载时是否存在android导航栏，以便我可以相应地调整布局，有人有什么建议吗？

这是我要检测的导航栏： ![在此处输入图像描述](https://i.stack.imgur.com/N63wE.png)

PS 到目前为止，我发现的所有方法都是尝试删除栏的“坏”方法，我不想这样做。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-05-17T12:00:17.573

花了我一些时间，但我找到了一种比依赖**hasPermanentMenuKey()**更可靠的方法，它不适用于像**HTC One**这样没有菜单键但确实有主页和返回键的新手机，所以不需要（或显示）软导航栏。为了解决这个问题，请尝试以下代码来检查后退按钮：

```
boolean hasMenuKey = ViewConfiguration.get(context).hasPermanentMenuKey();
boolean hasBackKey = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_BACK);

if(!hasMenuKey && !hasBackKey) {
    // Do whatever you need to do, this device has a navigation bar
} 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-04-20T10:49:00.073

没有可靠的方法来检查导航栏。使用`KeyCharacterMap.deviceHasKey`您可以检查设备上是否存在某些物理键，但此信息不是很有用，因为具有物理键的设备仍然可以具有导航栏。像 OnePlus One 这样的设备，或任何运行自定义 rom 的设备，在设置中都有一个禁用物理键的选项，并添加了一个导航栏。无法检查此选项是否已启用，并且`deviceHasKey`对于被此选项禁用的键仍然返回 true。

这是你能得到的最接近的：

```
boolean hasBackKey = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_BACK);
boolean hasHomeKey = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_HOME);

if (hasBackKey && hasHomeKey) {
    // no navigation bar, unless it is enabled in the settings
} else {
    // 99% sure there's a navigation bar
} 
```

如果返回和主页按钮在设备上没有物理存在，则它必须有一个导航栏，否则用户将根本无法导航。但是，您永远无法 100% 确定这一点，因为制造商可能实施`deviceHasKey`错误。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-01-30T11:38:11.163

另一个解决方案（我的类[UtilsUISystem](https://gist.github.com/mypplication/31ffba660d42a81d48b7)的一部分）

```
 public static boolean hasNavBar (Resources resources)
    {
        //Emulator
        if (Build.FINGERPRINT.startsWith("generic"))
            return true;

        int id = resources.getIdentifier("config_showNavigationBar", "bool", "android");
        return id > 0 && resources.getBoolean(id);
    } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-03-18T11:01:28.733

这是一个结合 Pauland 和 Philask 解决方案的快速答案。不过，恐怕我没有足够的设备来测试它是否可以在任何地方使用。我很想听听其他人的结果。

```
boolean hasNavBar(Context context) {
    Resources resources = context.getResources();
    int id = resources.getIdentifier("config_showNavigationBar", "bool", "android");
    if (id > 0) {
        return resources.getBoolean(id);
    } else {    // Check for keys
        boolean hasMenuKey = ViewConfiguration.get(context).hasPermanentMenuKey();
        boolean hasBackKey = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_BACK);
        return !hasMenuKey && !hasBackKey;
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2020-06-10T10:47:33.863

我已经这样做了，它适用于我测试的每台设备，甚至在模拟器上：

```
public static boolean hasNavigationBar(Activity activity) {
    Rect rectangle = new Rect();
    DisplayMetrics displayMetrics = new DisplayMetrics();
    activity.getWindow().getDecorView().getWindowVisibleDisplayFrame(rectangle);
    activity.getWindowManager().getDefaultDisplay().getRealMetrics(displayMetrics);
    return displayMetrics.heightPixels != (rectangle.top + rectangle.height());
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-08-11T08:43:45.400

您可以将此代码添加到活动的 onCreate() 方法中：

```
 View decorView = getWindow().getDecorView();
decorView.setOnSystemUiVisibilityChangeListener
        (new View.OnSystemUiVisibilityChangeListener() {
            @Override
            public void onSystemUiVisibilityChange(int visibility) {
                if ((visibility & View.SYSTEM_UI_FLAG_HIDE_NAVIGATION) == 0) {
                    // TODO: The navigation bar is visible. Make any desired
                    // adjustments to your UI, such as showing the action bar or
                    // other navigational controls.
                } else {
                    // TODO: The navigation bar is NOT visible. Make any desired
                    // adjustments to your UI, such as hiding the action bar or
                    // other navigational controls.
                }
            }
        }); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-05-24T20:49:15.347

这种方法对我有用

```
 int id = getResources().getIdentifier("config_showNavigationBar","bool","android");
        boolean result = id > 0 && getResources().getBoolean(id);
//
        if(result) {

            // Do whatever you need to do, this device has a soft Navigation Bar
        } 
```

它对我有用，并在许多设备上进行了测试。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-02-16T07:50:02.703

```
boolean hasNavBar(Context context) {
    if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
        // navigation bar was introduced in Android 4.0 (API level 14)
        Resources resources = context.getResources();
        int id = resources.getIdentifier("config_showNavigationBar", "bool", "android");
        if (id > 0) {
            return resources.getBoolean(id);
        } else {    // Check for keys
            boolean hasMenuKey = ViewConfiguration.get(context).hasPermanentMenuKey();
            boolean hasBackKey = KeyCharacterMap.deviceHasKey(KeyEvent.KEYCODE_BACK);
            return !hasMenuKey && !hasBackKey;
        }
    } else {
        return false;
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-21T07:33:43.383

可能更好的方法是测量屏幕。

从 API 17 开始，有`getWindowManager().getDefaultDisplay().getRealSize()`，可以与返回的大小进行比较`getWindowManager().getDefaultDisplay().getSize()`。

如果你得到不同的结果，我认为可以肯定地说有一个导航栏，如果你得到相同的结果，就没有导航栏。需要注意的一件事是您的目标 SDK 和支持的屏幕，`getSize()`如果 Android 认为您的应用在不缩放的情况下无法在当前设备上正常运行，这可能会导致结果被缩放。

`getWindowManager().getDefaultDisplay().getMetrics()`在 API 17 以下，您可以通过横向和纵向模式测量屏幕，同样，不同的结果可能意味着有一个导航栏。

但是，如果您获得相同的结果，您实际上并不知道，因为即使在横向时，手机也可以将导航栏保持在较短的边缘。有根据的猜测是，如果宽度或高度比标准尺寸（如`1280x800`, `1280x720`, ）小 4% 到 8% `1024x600`，而另一个尺寸相等，那么可能还有一个导航栏。不过，不要赌它。有太多的分辨率，它们之间的差异太小，无法正常工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-15T03:42:04.393

我看到上面的答案，我想表明“不存在”可以视为高度为0；所以它可以是这样的：

```
public static int getScreenH(Context context) {
    DisplayMetrics dm = new DisplayMetrics();
    dm = context.getResources().getDisplayMetrics();
    int h = dm.heightPixels;
    return h;
}

public static int getDpi(Context context) {

    DisplayMetrics displayMetrics1 = context.getResources().getDisplayMetrics();
    int height1 = displayMetrics1.heightPixels;

    int dpi = 0;
    WindowManager windowManager = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
    Display display = windowManager.getDefaultDisplay();
    DisplayMetrics displayMetrics = new DisplayMetrics();

    @SuppressWarnings("rawtypes")
    Class c;
    try {
        c = Class.forName("android.view.Display");
        @SuppressWarnings("unchecked")
        Method method = c.getMethod("getRealMetrics", DisplayMetrics.class);
        method.invoke(display, displayMetrics);
        dpi = displayMetrics.heightPixels;
    } catch (Exception e) {
        e.printStackTrace();
    }
    return dpi;
}

public static int getBottomStatusHeight(Context context) {
    int totalHeight = getDpi(context);

    int contentHeight = getScreenH(context);

    return totalHeight - contentHeight;
} 
```

```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-26T07:30:23.397

在 Android 10（API 级别 29）上，您还可以检查底部窗口插图：

```
@RequiresApi(api = Build.VERSION_CODES.Q)
private boolean hasNavigationBar() {
    final WindowInsets windowInsets = getWindow().getDecorView().getRootWindowInsets();
    if (windowInsets == null) {
            throw new RuntimeException("Window is not attached");
    }
    return windowInsets.getTappableElementInsets().bottom > 0;
} 
```

请注意，必须附加窗口`getRootWindowInsets()`才能返回非空值，因此您可能希望在`onAttachedToWindow`.

[LineageOS 的启动器应用程序 Trebuchet (来源](https://github.com/LineageOS/android_packages_apps_Trebuchet/blob/fd3fde7a17d4d78aabcdd7e308cd8199c3becbba/src/com/android/launcher3/graphics/WorkspaceAndHotseatScrim.java#L212-L219))也使用了这个解决方案，这就是我了解它的方式。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-04-19T15:17:22.743

解决方案：只有没有永久硬件密钥的设备才有导航栏，因此您可以检查 API 版本并使用 hasPermanentMenuKey() 查找硬件密钥

```
 boolean hasMenuKey = ViewConfiguration.get(context).hasPermanentMenuKey(); 
```

# .net - VB.Net - 系列中的第一个数据点绘制到图表上的错误 x 值

> ID：16092432
> 
> 赞同：2
> 
> 时间：2013-04-18T20:27:13.947
> 
> 标签：.net, vb.net, charts, mschart

我正在开发一个类来管理图表的数据系列。但是，当我添加一个新系列时，如果第一个 dataPoint 的 XValue 为 0，它会在图上显示为 XValue 为 1。如果我添加一个额外的 dataPoint，它似乎会自行更正。使用下面的代码，首先（显然）调用构造函数，然后调用 Initialize（使用“Series1”，0,0 之类的数据），然后可以稍后调用 AddPoint。有谁知道发生了什么？

编辑：根据我的发现，只要系列只有一个数据点并且该数据点的 xValue 为 0，就会发生这种情况。直到一个（或更多）数据点非零时，该系列才会正确运行xValues 被添加。我的解决方法是，如果要添加的数据点的 xValue 为 0，则改为使其 xValue 非常小（1x10^-150）。似乎有效，但这仍然是我书中的一个奇怪的错误。我也没有找到任何关于它的信息。

```
Public Sub New(ByVal chartObj As Chart)
    'Init m_chart
    m_chart = chartObj

    m_chart.BackColor = Color.Gainsboro

    'Init Legend
    m_legend = New Legend("Legend")
    m_legend.Docking = Docking.Bottom
    m_chart.Legends.Add(m_legend)

    'Init m_chartArea

    m_chartArea = New ChartArea("Default")

    m_chartArea.BackColor = Color.Black

    m_chartArea.AxisX.LabelStyle.Format = "{0:0.00}"

    setXLimits(-10, 10)
    setYLimits(-0.5, 0.5)

    m_chartArea.AxisX.Title = "Position (mm)"
    m_chartArea.AxisX.TitleFont = New Font("Arial", 10, FontStyle.Regular)

    m_chartArea.AxisY.Title = "Peak-To-Peak (Volts)"
    m_chartArea.AxisY.TitleFont = New Font("Arial", 10, FontStyle.Regular)

    m_chartArea.AxisX.MajorGrid.LineDashStyle = ChartDashStyle.Dash
    m_chartArea.AxisX.MajorGrid.LineColor = Color.DarkGreen
    m_chartArea.AxisY.MajorGrid.LineDashStyle = ChartDashStyle.Dash
    m_chartArea.AxisY.MajorGrid.LineColor = Color.DarkGreen

    m_chart.ChartAreas.Add(m_chartArea)

    'Init m_dataSeries
    m_dataSeries = New List(Of Series)

    'Init m_markerSeries
    m_markerSeries = New Series("Peaking Markers")
    m_markerSeries.ChartType = SeriesChartType.Point
    m_markerSeries.MarkerColor = Color.Red
    m_markerSeries.MarkerStyle = MarkerStyle.Triangle
    m_markerSeries.MarkerSize = 10
    m_chart.Series.Add(m_markerSeries)

    'Init m_title
    m_title = New Title("Plots")
    m_title.Font = New Font("Arial", 20, FontStyle.Regular)
    m_chart.Titles.Add(m_title)

End Sub

Public Sub Initialize(ByVal Legend As String, ByVal xVal As Double, ByVal yVal As Double)
    Dim temp As New Series(Legend)
    temp.ChartType = SeriesChartType.Line
    temp.Points.Clear()

    If nextAxis = "X" Then
        temp.Color = xColor
        nextAxis = "Y"
    Else
        temp.Color = yColor
        nextAxis = "X"
    End If

    temp.MarkerStyle = MarkerStyle.Circle

    m_dataSeries.Add(temp)
    m_chart.Series.Add(temp)

    AddPoint(xVal, yVal)

End Sub

Public Sub AddPoint(ByVal x As Double, ByVal y As Double)
    If m_chart.InvokeRequired Then
        m_chart.Invoke(New Action(Of Double, Double)(AddressOf AddPoint), x, y)
    Else
        Dim temp As New DataPoint(x, y)

        m_dataSeries.Item(m_dataSeries.Count - 1).Points.Add(temp)
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-15T08:11:36.280

尝试改变这个：

```
If m_chart.InvokeRequired Then
    m_chart.Invoke(New Action(Of Double, Double)(AddressOf AddPoint), x, y)
Else
    Dim temp As New DataPoint(x, y)

    m_dataSeries.Item(m_dataSeries.Count - 1).Points.Add(temp)
End If 
```

对此：

```
If m_chart.InvokeRequired Then
    m_chart.Invoke(New Action(Of Double, Double)(AddressOf AddPoint), x, y)
End If

Dim temp As New DataPoint(x, y)
m_dataSeries.Item(m_dataSeries.Count - 1).Points.Add(temp) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-16T10:04:58.080

2017 年 8 月，.net Framework 4.5.2，仍然是同样的错误......

我创建了一个气泡图，当我添加一个点时：

```
Chart1.Series("MySeries").AddXY(0,0,value) 
```

奇怪：该点显示在位置 (1,0) 而不是 (0,0) 但如果我添加多个点，它是正确的......

所以，我的技巧是相似的，当我只有一个点时，我添加了两次，用一个微小的偏移量，知道它会被真实的东西掩盖......不太好，它是作弊，但它'解决'我的问题...

```
Chart1.Series("MySeries").AddXY(0.000001,0,0)
Chart1.Series("MySeries").AddXY(0,0,10) 
```

任何其他建议：欢迎！

# excel - 如何在 Excel VBA 中使用 Find 函数修复错误

> ID：16092433
> 
> 赞同：2
> 
> 时间：2013-04-18T20:27:14.840
> 
> 标签：excel, vba

我试图从另一张表中搜索一个值，而不是使用 .FIND 函数

```
Private Function Search(rng As Range, FindString As String) As Range
    With rng
        Set Search = .Find(what:=FindString, _
                        After:=.Cells(.Cells.Count), _
                        LookIn:=xlValues, _
                        lookat:=xlWhole, _
                        SearchOrder:=xlByRows, _
                        SearchDirection:=xlNext, _
                        MatchCase:=False)
     End With 
```

有趣的是，如果我进入

```
Search(Range("'DataSheet'!A1:Z1000"),"STARTING") 
```

有用。当我尝试

```
 SearchString = "'" & Selected_sheet &"'!A1:Z1000" 
```

它不起作用 Selected_sheet 只是工作表的名称（在这种情况下，它是“DataSheet”）。使用

```
Search(Range(SearchString ),"STARTING") 

Error: RUN-TIME ERROR '91'
Object variable or With Block Varibale Not Set 
```

实际问题可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:36:33.980

你的方法没有错，但我建议不要像那样通过你的范围。

用这个

```
Search(Sheets("DataSheet").Range("A1:Z1000"),"STARTING") 
```

或者

```
Selected_sheet = "DataSheet"
Search(Sheets(Selected_sheet).Range("A1:Z1000"),"STARTING") 
```

顺便说一句，您的代码没有任何问题`Range(SearchString)`。它应该工作。你怎么叫`Search`？希望是这样的？

```
Dim Ret As Range '<~~~

Selected_sheet = "DataSheet"
SearchString = "'" & Selected_sheet & "'!A1:Z1000"
Set Ret = Search(Range(SearchString), "STARTING") 
```

**原因**：该函数返回 a`Range`所以你不能在没有`Set Ret = ...`Where`Ret`再次声明为 a 的情况下调用它`Range`。

**编辑**

如果您的`Search`函数未返回范围并且您尝试使用该范围，您也可能会收到该错误`Ret`。请参阅此示例。

```
Dim Ret As Range

Selected_sheet = "DataSheet"
SearchString = "'" & Selected_sheet & "'!A1:Z1000"
Set Ret = Search(Range(SearchString), "STARTING")

'<~~ This will give you RUN-TIME ERROR '91' if "STARTING" is not found
Debug.Print Ret.Address 
```

那么我们如何解决这个问题

试试这个

```
Dim Ret As Range

Selected_sheet = "DataSheet"
SearchString = "'" & Selected_sheet & "'!A1:Z1000"
Set Ret = Search(Range(SearchString), "STARTING")

If Not Ret Is Nothing Then
    Debug.Print Ret.Address
Else
    Debug.Print "Search Didn't return any results"
End If 
```

# java - 如何根据 Java 中的特定谓词添加到集合中？

> ID：16092435
> 
> 赞同：1
> 
> 时间：2013-04-18T20:27:21.973
> 
> 标签：java, set, guava, predicate

我在 Java 中有一个包含人的集合：

```
Set<Person> uniquePeople = new HashSet<Person>(); 
```

我也有一大堆人的名单（其中有些人拥有相同的名字，例如，世界上不止一个“鲍勃”）。

```
List<Person> theWorld = // ... a BIG list of people 
```

我想遍历这个列表并将一个人添加到`uniquePeople`集合中，当且仅当他们的名字不存在于集合中时，例如：

```
for (Person person : theWorld) {
    uniquePeople.add(person IFF uniquePeople.doesNotContain(person.name));
} 
```

有没有一种简单的方法可以在 Java 中做到这一点？此外，番石榴可能会这样做（？）但我根本没有使用过它，所以我会很感激在正确的方向上的一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:33:14.743

更好的选择是放弃使用 Set 而是使用 a `Map<String, Person>`（键控名称）。

如果你想使用一个集合，我建议你使用一个新的对象类型（它只包含一个名称，可能还有一个对 Person 的引用）。

确保您覆盖 equals 以便它只会比较名称，然后您可以获得一组所有唯一的人。

您还可以将 person 子类化以覆盖 equals 以执行您想要的操作。

根据定义，集合不会只对一个人执行您想要的操作，因为它们完全依赖于使用 equals，因此这些是您的解决方法选项。您还可以实现（或在线查找）一个使用比较器而不是依赖于 equals 的集合，但我认为标准 java 中不存在这样的类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T20:38:56.853

[`Equivalence`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Equivalence.html)如果您不想（或不能）覆盖 equals 和 hashCode，请使用 Guava包装您的对象：

```
Set<Equivalence.Wrapper<Person>> set = Sets.newHashSet();
Equivalence<Person> personEquivalence = Equivalence.onResultOf(
    new Function<Person, String>() {
      @Override public String apply(Person p) {
        return p.name;
      }
    });
set.add(personEquivalence.wrap(new Person("Joe", "Doe")));
set.add(personEquivalence.wrap(new Person("Joe", "Doe")));
set.add(personEquivalence.wrap(new Person("Jane", "Doe")));
System.out.println(set);
// [PersonEquivalence@8813f2.wrap(Person{firstName=Jane, lastName=Doe}),
//  PersonEquivalence@8813f2.wrap(Person{firstName=Joe, lastName=Doe})] 
```

@DanielWilliams 也有一个好主意，但使用`Equivalence.Wrapper`更多的是自我记录 - 毕竟你不想创建包装器以外的新对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T20:47:27.973

我不确定为什么人们在这里被否决。

你绝对想要一套。您的要求不仅满足“集合”的定义和功能，而且集合实现旨在通过散列或比较身份快速识别重复项。

假设您有一个 List 实现，它带有一个委托和一个谓词：

List uniquePeople = new PredicatedList(new ArrayList(),UnqiuePersonPredicate.getInstance())

```
public class PredicatedList<T> implements List<T> {

    private List<T> delegate = null;
    private Predicate<T> predicate;

    public PredicatedList<List<T> delegate, Predicate p) {
     this.delegate = delegate;
     this.predicate = p;
    }
   // implement list methods here and apply 'p' before calling your insertion functions

   public boolean add(Person p) {
     if(predicate.apply(p))
        delegate.add(p);

   }
} 
```

为此，您需要有一个谓词来遍历列表以找到相等的元素。这是一个 O(N) 操作。如果你使用 HashSet，那么它是 O(1) < n < O(N)。您的摊销身份检查是负载因子 * N。而且，通常更接近 O(1)

如果您使用 TreeSet，您将得到 O(log(n))，因为元素按身份排序，并且您只需要 log(n) 时间进行二分搜索。

根据“名称”或您想要的任何内容定义 hashCode()/equals 并使用 HashSet 或使用 TreeSet 并定义 Comparable/Comparator

如果您的返回类型必须是列表，则执行以下操作： Set uniquePeople = new HashSet(); uniquePeople.add(...);

列出人员 = new LinkedList(uniquePeople);

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T20:38:53.870

你可以用番石榴来做，唯一的事情是 Person 需要一个 equals/hashcode 方法。

```
ImmutableSet<String> smallList = ImmutableSet.of("Eugene","Bob");
ImmutableSet<String> bigList   = ImmutableSet.of("Eugene","Bob","Alex","Bob","Alex");

System.out.println(Iterables.concat(smallList, Sets.difference(bigList, smallList)));

//output is going to be : [Eugene, Bob, Alex] 
```

# php - 字符无法在 UTF-8 网站上正确显示

> ID：16092448
> 
> 赞同：5
> 
> 时间：2013-04-18T20:28:41.213
> 
> 标签：php, mysql, html, utf-8, html-entities

我已经做了所有我能想到的事情，但是特殊字符在这个网页上没有正确显示。

例如，在数据库中它是：

![在此处输入图像描述](https://i.stack.imgur.com/UXfTL.png)

但在网站上是：

```
Nouveaux R�alistes 
```

这是我检查过的所有内容...

数据库设置为 UTF-8：

![在此处输入图像描述](https://i.stack.imgur.com/ClKX5.png)

该页面是用 NetBeans 编写的，文档编码设置为 UTF-8：

![在此处输入图像描述](https://i.stack.imgur.com/s7djn.png)

页眉声明 UTF-8：

![在此处输入图像描述](https://i.stack.imgur.com/MBjno.png)

元字符集设置为 UTF-8：

![在此处输入图像描述](https://i.stack.imgur.com/fua7X.png)

我什至在我的 .htacess 中添加了以下行：

![在此处输入图像描述](https://i.stack.imgur.com/HqxrN.png)

但是仍然没有正确显示字符，并且我从 W3C Validator 收到以下错误：

![在此处输入图像描述](https://i.stack.imgur.com/E5CHa.png)

我觉得我已经尝试了一切，但它仍然无法正常工作。（我什`htmlspecialchars`至`htmlentities`在 PHP 中尝试过，但页面甚至没有呈现！）

* * *

**更新**
按要求，这是我正在使用的代码：

```
class Exhibition {
    public $exhibitionDetails;    

    public function __construct(Database $db, $exhibitionID){
        $this->_db = $db;

        $params['ExhibitionID'] = $exhibitionID;

        $STH = $this->_db->prepare("SELECT * 
            FROM Exhibition
            INNER JOIN Schedule
                ON Exhibition.ExhibitionID = Schedule.ExhibitionID            
            WHERE Schedule.Visible = 1
                AND Exhibition.ExhibitionID = :ExhibitionID;");

        $STH->execute($params);

        $this->exhibitionDetails = $STH->fetchAll(PDO::FETCH_ASSOC);

    }
} 
```

和...

```
try {
    $db = new Database(SITE_ROOT."/../");
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $exhibition = new Exhibition($db,$_GET['id']);
} catch (PDOException $e) {
    echo "<p class='error'>ERROR: ".$e->getMessage()."</p>";
} 
```

最后...

```
<p><?php echo $exhibition->exhibitionDetails[0]["Desc"]; ?></p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:37:05.413

如果您正在使用`mysql_*`函数：

```
mysql_query("SET NAMES 'utf8'"); 
```

如果您正在使用`PDO`

```
$dsn = 'mysql:host=localhost;dbname=testdb';
$username = 'username';
$password = 'password';
$options = array(
    PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8',
); 

$dbh = new PDO($dsn, $username, $password, $options); 
```

它设置连接编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:40:03.663

自从我使用 PHP 以来已经有几年了，但那时它本身并不支持 Unicode，并且快速搜索谷歌告诉我它仍然不支持。你仍然可以让它工作。

这是一个很棒的链接：

[使用文本的编码和字符集](http://kunststube.net/encoding/)

# git - “git reset --hard origin”实际上是做什么的？

> ID：16092450
> 
> 赞同：1
> 
> 时间：2013-04-18T20:28:45.333
> 
> 标签：git

一位朋友做了一个“git reset --hard origin”，然后推送了他的更改。他这样做了，而不是去“git reset --hard origin/branch_name”，这是他真正想要的。

我认为所有“git reset --hard origin”所做的都是重置您的分支以完全匹配所有相关的远程分支。然而，在他推动之后，我做了一个“git pull origin branch_name”，出于某种未知的原因，一堆似乎来自 master 的新文件被拉了出来（就像 master 的合并一样）；但是在本地和远程日志中，我们从来没有看到这些文件被提交或从 master 到我们的分支的任何合并，我们只知道问题发生在那个 push 之后并且不知道实际发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:32:16.740

似乎将当前分支重置为*默认*（即通常是主）分支的状态`origin`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T12:32:15.893

这是一个有趣的问题......[`gitrevisions`手册页](https://www.kernel.org/pub/software/scm/git/docs/gitrevisions.html)正式涵盖了这一点（`<refname>`案例，第 5 点），但没有说明如果以`<refname>`这种方式解决 a 究竟会发生什么。

我试图这样做`git rev-parse origin`，Git 告诉我这个修订是模棱两可的（即未找到），而且我`refs/remotes/origin`在用于测试的 repo 中确实有。

在启用了命令执行跟踪（在环境中）的情况下尝试`git reset --hard origin`在同一个 repo中解决.`GIT_TRACE=1``git rev-parse`

因此，我对此的看法是，您的同事（据说是错误的）有一个真正的本地分支或名为“origin”的标签，因此`git reset --hard origin`实际上将他们当前签出的分支重置为该本地分支“origin”的尖端提交。

我现在将通过运行`git branch -a`并`git tag`在他们的 repo 中检查这个假设。

# mysql - MySQL 和 PHP 多对多数据库关系

> ID：16092452
> 
> 赞同：0
> 
> 时间：2013-04-18T20:28:47.957
> 
> 标签：mysql, sql

我正在尝试提高我对 SQL 查询的了解，但我陷入了多对多关系查询。

使用PHP和MySQL的数据库结构如下：

数据库结构：

```
--------------------------------------------
|                  colour                  |
--------------------------------------------
| colour_id         |      colour          |
--------------------------------------------
| 1                 |      blue            |
--------------------------------------------
| 2                 |      red             |
--------------------------------------------
############################################
-------------------------------------------- 
```

.

```
-----------------------------------------------------------------
|   product_colours                                             |
-----------------------------------------------------------------
| id            |     product_id       |    colour_id           |
-----------------------------------------------------------------
| 1             |         1            |         2              |
-----------------------------------------------------------------
| 2             |         2            |         1              |
-----------------------------------------------------------------
#################################################################
----------------------------------------------------------------- 
```

**主表**

```
-----------------------------------------------------------------
|   products                                                    |
-----------------------------------------------------------------
| id          |      name               |      details          |
-----------------------------------------------------------------
| 1           |      product 1          |      blah             |
-----------------------------------------------------------------
| 2           |      product 2          |      blah             |
-----------------------------------------------------------------
#################################################################
-----------------------------------------------------------------

-----------------------------------------------------------------
|    product_group_names                                        |
-----------------------------------------------------------------
| id            |      product_id         |    group_name_id    |
-----------------------------------------------------------------
| 1             |          1              |         1           |
-----------------------------------------------------------------
| 2             |          2              |         2           |
-----------------------------------------------------------------
#################################################################
-----------------------------------------------------------------

--------------------------------------------
|        group_name                        |
--------------------------------------------
| group_name_id     |      group_name      |
--------------------------------------------
| 1                 |  product_group_1     |
--------------------------------------------
| 2                 |  product_group_2     |
--------------------------------------------
############################################
-------------------------------------------- 
```

我可以使用连接写一个查询，它说：`SELECT * colours WHERE group_name = product_group_1`？

任何帮助都会很棒。太感谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:39:05.570

你当然可以写一个查询来做到这一点。您基本上需要将表连接在一起，以便将所需的数据从表链接到表，然后为所需条件添加 where 子句。

您的颜色通过属性“链接”到您的`product_colours`via`colour_id`属性，产品颜色通过两个表格`product_group_names`上的属性链接到 via`product_id`属性，并且您的组名通过表格上的`group_name_id`和`group_id`属性链接`group_names`。

但是，当您进行这种查询时，如果这些表中有很多记录 - 查询可能会非常慢。您需要确保在`JOIN...ON`子句中引用的每个列以及子句中添加索引`WHERE`。

```
SELECT colour FROM colours c
JOIN product_colours pc ON c.id = pc.colour_id
JOIN product_group_names pgn ON pgn.product_id = pc.product_id
JOIN group_name gn ON gn.id = pgn.group_name_id
WHERE gn.group_name = "product_group_1" 
```

# jquery - 滚动时移动图像

> ID：16092453
> 
> 赞同：2
> 
> 时间：2013-04-18T20:28:48.573
> 
> 标签：jquery, css

当我滚动页面并点击首页时，如何设置图像模式。我希望上下速率箭头在滚动时沿着首页移动而不会消失。

顺便说一句，我正在使用 JQuery 进行运动

![在此处输入图像描述](https://i.stack.imgur.com/Cn4kN.png)

![在此处输入图像描述](https://i.stack.imgur.com/mOn9P.png)

```
 <div class="FirstChildBox">
                <div class="imageBox">
                       <img src="textimage2.jpg" id="imageBoxImg"/>
                    <form>
                            <label class="Image1BoxLabel"><input type="checkbox"/>Image1</label>
                        <label class="Image1BoxLabel"><input type="checkbox"/>Image1</label>
                        <label class="Image1BoxLabel"><input type="checkbox"/>Image1</label>1
                        </form>
                        <a href="#">Enemy1</a>
                </div>
                <div class="rateImage">
                    <div class="arrowupdownrate">
                        <div class="upArrow" id="upArrow"><img src="up_down.png" /> </div>
                        <div class="rateNumber"><a>112320</a></div>
                        <div class="downArrow" id="downArrow"><img src="red_down.png" /></div>
                    </div>
                </div>

    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:31:29.913

将 固定到最近的父`rateImage`级的右上角。`relative`在这种情况下，文档。

```
.rateImage {
  position: absolute;
  top: 10px;
  right: 10px;
} 
```

或者，您可以使用：

```
.rateImage {
  position: fixed;
  top: 10px;
  right: 10px;
} 
```

我更喜欢`position: absolute;`，只是因为从长远来看它最终会更加灵活。在这种情况下真的没关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:31:42.933

给位置：固定到比率 div

```
.rateImage {
 position: fixed;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:32:10.217

将以下内容添加到您的`upArrow`和`downArrow`css 类中：

```
position: fixed 
```

# jquery - jQuery 什么是.drag？同时拖动多个元素不起作用

> ID：16092461
> 
> 赞同：0
> 
> 时间：2013-04-18T20:29:26.763
> 
> 标签：jquery, jquery-ui-draggable

我正在看这个小提琴示例：

[http://jsfiddle.net/ubEqb/](http://jsfiddle.net/ubEqb/)

您可以在这里看到同时拖动多个元素。在这个例子中，它有 "$('.drag').drag("init", function(ev, dd)"

'.drag' 部分是什么？我是 jquery 的新手，并认为它是“可拖动的”，但我找不到任何“.drag”实际上可以做任何事情的官方文档。

如果我将这个小提琴中的文本复制到我的 html 中，它就不起作用。这是我得到的：

```
<!DOCTYPE html>
<head>
<style>
.drag {
    position: absolute;
    border: 1px solid #89B;
    background: #BCE;
    height: 58px;
    width: 58px;
    cursor: move;
    top: 120px;
}
</style>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
<script src="https://dl.dropboxusercontent.com/u/286533/jquery-1.9.1.min.js"></script>
<script src="https://dl.dropboxusercontent.com/u/286533/jquery-ui.js"></script>
</head>
<body>
 <p>Click to select multiple boxes, and drag them around the screen.</p>
    <div id="test" class="drag" style="left:20px;">Square 1</div>
    <div class="drag" style="left:100px;"></div>
    <div class="drag" style="left:180px;"></div>
</body>
<script>    
$('.drag').drag("init", function(ev, dd) {
    if (this.id == "test") {
        return $(".drag").addClass("selected");
    }
}).drag(function(ev, dd) {
    if (ev.target.id == "test") {
        $(this).css({
            top: dd.offsetY,
            left: dd.offsetX
        });
    }
});
</script>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:43:52.020

jQuery 中没有“拖动”方法或 jQuery UI 中的“拖动”小部件。您所指的“可拖动”确实是 jQuery UI 的一部分。[您可以在此处](http://jqueryui.com/draggable/)阅读有关它的信息。

您在 jsfiddle 中看到的是 jQuery 和其他一些第三方库。如果您查看左侧的“外部资源”面板，您会看到对某个特定的引用，`jquery.event.drag-2.2.js`这实际上是在 jsfiddle 中定义“拖动”方法的原因。

# ios - 旋转时的 UICollectionViewCell alpha 值

> ID：16092463
> 
> 赞同：3
> 
> 时间：2013-04-18T20:29:29.547
> 
> 标签：ios, objective-c, uicollectionview, uicollectionviewcell

我有`UICollectionView`一个自定义的`UICollectionViewCell`. 我在to中设置了一个特定任务的`alpha`属性，所有任务都按预期工作。但是，当我将视图旋转为横向时，单元格会自行重置为.`UICollectionViewCell``0.0f``alpha``1.0`

我已经玩过这个，集合视图包含选定单元格和已删除单元格等的状态，但不包含单元格的 alpha 值。

我试图在 上重新设置已更改单元格的 alpha 值`didRotateFromInterfaceOrientation:`，它会这样做，但`1.0`一旦该调用完成，就会将其更改回。

我试图找出`UICollectionViewCell`旋转后 alpha 值在哪里重置。

如果我运行下面的代码，我会为单元格返回所需的 alpha 值，但是在此之后的某个时候，它们都会变回`1.0`：

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
    [super didRotateFromInterfaceOrientation:fromInterfaceOrientation];
    //array containing IndexPaths for cells with 0.0f alpha value
    for (NSIndexPath *path in self.selectedlettersArray) {
        LetterCellView* lsv = (LetterCellView*) [self.collectionView     cellForItemAtIndexPath:path];
        lsv.alpha = 0.0f; 
    }

    for (LetterCellView *lsv in self.collectionView.visibleCells) {

        NSLog(@"After Cell Alpha is : %f", lsv.alpha);

    } 
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:49:02.107

在集合视图中，alpha 以及其他属性不能通过通常的视图属性可靠地管理，至少这不是预期的。

相反，您应该使用由类通过管理的对象的`alpha`属性。`UICollectionViewLayoutAttributes``UICollectionReusableView``applyLayoutAttributes:`

在
[UICollectionReusableView 类参考](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionReusableView_class/Reference/Reference.html)和
[UICollectionViewLayoutAttributes 类参考中阅读此内容](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionViewLayoutAttributes_class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:36:20.930

根据 Mundi 的建议，即 UICollectionViewCell alpha 属性不是可靠管理的，我最终向我的自定义 UICollectionViewCell 添加了一个属性以将其设置为可见或隐藏。我只是将单元格的内容（在我的情况下为标签）设置为 0 或 1。

现在，当我旋转设备时，这仍然存在，尽管这似乎是一种解决方法。

# javascript - 带有验证控件的 ASP.NET 和 jQuery 的奇怪 Javascript 错误

> ID：16092467
> 
> 赞同：1
> 
> 时间：2013-04-18T20:29:48.770
> 
> 标签：javascript, jquery, asp.net, jquery-ui

当我激活生成 DatePicker 的 jQuery-UI 脚本时，我收到了一个神秘的（对我而言）javascript 错误。如果我在 Visual Studio 中并告诉它忽略错误，它可以工作。选定的日期会根据需要生成并放入文本框中。但是为什么会出现这个错误？ *它仅在存在并涉及验证错误时发生。*

好的，这里是代码。首先是asp.net页面标记：

```
<asp:TextBox ID="PickerDateTextBox" runat="server" Width="100" ></asp:TextBox>
<asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" 
    ErrorMessage="This is required"
    ControlToValidate="PickerDateTextBox"
    >
</asp:RequiredFieldValidator> 
```

这是jQuery：

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#PickerDateTextBox").datepicker({
        showOn: "button",
        buttonImage: "images/picker.gif",
        buttonImageOnly: true
        });
    });
</script> 
```

当然，包括：

```
<script src="Scripts/jquery-1.7.1.js"></script>
<script src="Scripts/jquery-ui-1.10.2.js"></script> 
```

不用担心，即使使用 jquery 1.9，我也能做到这一点。

该错误不在 jQuery 或 jQuery-UI 中，而是在 Microsoft 的 javascript 中，如下所示：

```
var vals;
if (typeof(targetedControl.Validators) != "undefined") {
    vals = targetedControl.Validators;
}
else {
    if (targetedControl.tagName.toLowerCase() == "label") {
        targetedControl = document.getElementById(targetedControl.htmlFor);
        vals = targetedControl.Validators;
    }
}
var i;
for (i = 0; i < vals.length; i++) {
    ValidatorValidate(vals[i], null, event);
}
ValidatorUpdateIsValid(); 
```

在“i < vals.length;”的行上抛出错误 发生，错误是：

```
Unhandled exception at line 172, column 17 in http://localhost...blah blah blah
0x800a138f - Microsoft JScript runtime error: Unable to get value of the property 'length': object is null or undefined 
```

同样，如果我在那里没有验证控件（任何类型），则不会发生这种情况。

任何想法正在发生什么以及如何解决它？

**编辑添加：**

正如@Steve-Wellens 指出的那样，在 .NET 4.5 和 jQuery 1.9.1 上运行时，它运行正常。同样在 .NET 4.0 上。不幸的是，由于服务器限制，我需要它在 .NET 3.5 上工作（我们的 Web 服务器是 Windows 2003，无法在其上安装 .NET 4.5。我想我可以将应用程序设置为运行 .NET 4.0，但 @Steve-Wellens 有交付了解决方法，因此可以按原样进行！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T02:06:05.643

这是修复/破解/kludge（添加一个空的 onSelect 处理程序）：

```
$("#PickerDateTextBox").datepicker({
    showOn: "button",
    onSelect: function() {},
    buttonImage: "images/picker.gif",
    buttonImageOnly: true
}); 
```

和解释： [Jquery datepicker popup not close on select date in IE8](https://stackoverflow.com/questions/1704398/jquery-datepicker-popup-not-closing-on-select-date-in-ie8/1975858#1975858)

# php - 如何从 ajax 加载页面调用用户定义的 jquery 函数

> ID：16092470
> 
> 赞同：0
> 
> 时间：2013-04-18T20:30:00.107
> 
> 标签：php, javascript, jquery

我有 2 页

*   索引.php
*   登录.php

从 index.php 进行 ajax 调用并获取 login.php

索引.php：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
    <html xmlns="http://www.w3.org/1999/xhtml"> 
    <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
    <title>Home Page</title>
    <script src="./js/jquery.js"></script>
        <script>
        $(document).ready(function(e) {
            $("a").click(function(e) {
                var model= $.ajax({
                    url: $(this).attr('href'),
                    cache:false,
                    type: "GET",
                    dataType:"json"
                });
                model.done(function(data){
                    $("#body").html(data.bodyy);
                    e.preventDefault();
                });
            });     
                $("form").submit(function(e) {
                            alert("Triggered");
                });
        });

    </script>

    <body>
    <div id="body"><a href="login.php">Login</a>
    </div>
</body>
</html> 
```

这是ajax页面：login.php

```
<?php
    $body='<form class="form-signin" action="#" method="post" id="login">
        <h2 class="form-signin-heading">Please sign in</h2>
        <input type="text" class="input-block-level" placeholder="username" name="username">
        <input type="password" id="password" class="input-block-level" placeholder="Password" name="password">
        <label class="checkbox">
          <input type="checkbox" value="remember-me"> Remember me
        </label>
        <table><th>
        <button class="btn btn-large btn-primary" type="submit">Sign in</button> </th><th width="5%">
        <h3>  or  </h3></th><th>
         <a class="btn btn-large btn-primary" href="./registration.php" >Register</a></th></table>
      </form>
      <script>
        </script>
';
    $data= array(
        'bodyy' => $body,
        );
        echo json_encode($data);
?> 
```

当我提交登录表单时，`$("form").submit(function(e)`未调用。当我从 ajax 加载页面调用它时，我遇到了这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:34:22.220

这是因为您在执行 jQuery 时绑定到表单。对于“延迟”事件绑定（意味着您要绑定到**所有**表单，而不仅仅是绑定时页面上的表单），您必须绑定到父元素，然后指定子选择器来触发处理程序， 如：

```
$("body").on("click", "form", function(e) {}); 
```

这将绑定单击主体，但仅在单击主体的子表单时触发处理程序（如果主体中有不应执行此操作的表单，则使用更具体的父元素可能会有所帮助）。

在 jQuery 中绑定事件时，请确保您仅绑定到执行绑定时页面上存在的元素，否则它将破坏事件绑定。旁注，如果您需要在不破坏其绑定事件的情况下“移动”元素，您应该使用 jQuery 的`detach`函数而不是`remove`. 该`detach`函数从页面中删除元素，但保留它的事件绑定信息，允许您将其放置在其他地方而无需更新事件函数（或处理引用的处置）。

# javascript - 在 ASP.NET MVC 中动态生成 Javascript、CSS

> ID：16092473
> 
> 赞同：22
> 
> 时间：2013-04-18T20:30:03.717
> 
> 标签：javascript, asp.net, css, asp.net-mvc, razor

ASP.NET 允许使用服务器标签（razor 或 ASPX）动态生成 HTML。但是除了使用内联（嵌入式）CSS / Javascript之外，还有什么好的方法可以以相同的方式生成 *.js 或 *.css 内容。如今，随着 Ajax 等技术的出现，越来越多的逻辑在 Javascript 中从服务器端转移到客户端。如果有机会使用 ASP.NET 为 HTML 生成提供的所有灵活性来动态生成 JS，那就太好了。

例如，我的 Javascript 包含**Knockout 视图模型声明，其中包含在 Javascript 渲染期间从服务器加载的初始数据**，以及一些额外的 js 函数，因此在我的 Html*而不是嵌入式脚本中，*我希望有这样的脚本引用：

```
<script src="~/Scripts/ContactViewModel.js?contactId=@Model.ContactId"></script> 
```

另一个例子，开发人员可能需要它是使用基于用户配置文件的 CSS。用户配置文件信息包含在 CSS 生成期间必须遵守的样式信息（字体、颜色，而不仅仅是主题），所以在我看来，我将有类似的内容：

```
<link href="~/Styles/CurrentUserOverrides.css" rel="stylesheet" /> 
```

**CurrentUserOverrides.css**将根据认证用户的个人资料数据动态生成。

如何使用 ASP.NET MVC 做到这一点？我想找到一个解决方案，让我可以像使用 ASP.NET 创建动态 HTML 一样简单，同时具备正常工作的智能以及 VS 为 ASP.NET 视图提供的所有其他功能。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-18T20:48:42.193

到目前为止，我为此找到的最佳解决方案如下：

[ASP.NET MVC 中使用 Razor 视图的动态 Javascript 和 CSS](https://www.pmunin.com/2013/04/dynamic-javascript-css-in-aspnet-mvc.html)

您只需创建视图：CurrentUserOverrides.css.cshtml、ContactViewModel.js.cshtml。此视图将包含单个 HTML 块（`<script>`或`<style>`），因此 IntelliSense 可以正常工作。然后，您创建呈现该视图的控制器，修剪根标记并返回具有适当内容类型的内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-07-08T17:14:17.050

**CSHTML 文件中的动态 CSS**

我使用 CSS 注释`/* */`来注释掉一个新`<style>`标签，然后我`return;`在结束样式标签之前：

```
/*<style type="text/css">/* */

    CSS GOES HERE

@{return;}</style> 
```

**CSHTML 文件中的动态 JS**

我使用 JavaScript 注释`<!--//`来注释掉一个新`<script>`标签，然后`return;`在结束脚本标签之前：

```
//<script type="text/javascript">

    JAVASCRIPT GOES HERE

@{return;}</script> 
```

**MyDynamicCss.cshtml**

```
@{
var fieldList = new List<string>();
fieldList.Add("field1");
fieldList.Add("field2");

}/*<style type="text/css">/* */

@foreach (var field in fieldList) {<text>

input[name="@field"]
, select[name="@field"]
{
    background-color: #bbb;
    color: #6f6f6f;
}

</text>}

@{return;}</style> 
```

**MyDynamicJavsScript.cshtml**

```
@{
var fieldList = new List<string>();
fieldList.Add("field1");
fieldList.Add("field2");
fieldArray = string.Join(",", fieldList);

}

//<script type="text/javascript">

$(document).ready(function () {
    var fieldList = "@Html.Raw(fieldArray)";
    var fieldArray = fieldList.split(',');
    var arrayLength = fieldArray.length;
    var selector = '';
    for (var i = 0; i < arrayLength; i++) {
        var field = fieldArray[i];
        selector += (selector == '' ? '' : ',')
                    + 'input[name="' + field + '"]'
                  + ',select[name="' + field + '"]';            
    }
    $(selector).attr('disabled', 'disabled');
    $(selector).addClass('disabled');
});
@{return;}</script> 
```

**无需控制器（使用视图/共享）**

我将两个动态脚本都放入其中，并且可以使用以下代码`Views/Shared/`轻松地将它们嵌入到任何现有页面（或 in ）中：`_Layout.cshtml`

```
<style type="text/css">@Html.Partial("MyDynamicCss")</style>
<script type="text/javascript">@Html.Partial("MyDynamicJavaScript")</script> 
```

**使用控制器（可选）**

如果您愿意，您可以创建一个控制器，例如

```
<link rel="stylesheet" type="text/css" href="@Url.Action("MyDynamicCss", "MyDynamicCode")">
<script type="text/javascript" src="@Url.Action("MyDynamicJavaScript", "MyDynamicCode")"></script> 
```

这是控制器的外观

**MyDynamicCodeController.cs（可选）**

```
[HttpGet]
public ActionResult MyDynamicCss()
{
    Response.ContentType = "text/css";
    return View();
}

[HttpGet]
public ActionResult MyDynamicJavaScript()
{
    Response.ContentType = "application/javascript";
    return View();
} 
```

**笔记**

*   控制器版本未经测试。我只是在脑海中输入了那个。
*   重新阅读我的答案后，我突然想到，注释掉结束标签而不是使用 cshtml 可能同样容易`@{return;}`，但我还没有尝试过。我想这是一个偏好问题。
*   关于我的整个答案，如果您发现任何语法错误或改进，请告诉我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-23T22:24:13.640

为时已晚，但仍然很有趣，这是我的解决方案：像这样形成您的 cshtml 调用：

```
<script src='@Url.Action("GetJS", "Home")'></script> 
```

创建一个像这样生成 JS 或 CSS 的控制器方法：

```
public ActionResult GetJS()
{
     byte[] jsDATA = System.Text.ASCIIEncoding.ASCII.GetBytes(mystingJS); 
     return File(jsDATA, "text/javascript");
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-18T21:26:22.017

我认为有一种相对较新的语言[TypeScript](http://www.typescriptlang.org/)可能是您正在寻找的 JavaScript，而不是 CSS。[这](http://www.devcurry.com/2012/10/typescript-template-for-aspnet-mvc4.html)是一篇让其在 ASP.NET MVC4 中工作的帖子。

# javascript - 从本地 HTML 文件访问本地 Javascript 文件

> ID：16092481
> 
> 赞同：0
> 
> 时间：2013-04-18T20:30:24.253
> 
> 标签：javascript, html

有很多类似的问题，但没有一个能够帮助我。

我是 HTML 和 JS 开发的新手。我有一个简单的 HTML 文件，它试图访问一个简单的 Javascript 文件。

HTML：

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Sample</title>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
document.write("In HTML")

</script>

<script type="text/javascript" src=./asdf.js></script>
</head>
<body>
<div id="map3d" style="height:400px;width:600px;border:1px solid red"></div>
</body> 
```

Javascript 文件名为 asdf，与 HTML 位于同一位置。我已经尝试了完整的文件路径，只是名称“asdf.js”和其他几个我不记得的选项。

我的 .js 文件是这样读取的：

```
<script>
document.write("In JS")
</script> 
```

“在 JS 中”没有出现。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:31:37.333

外部脚本不需要`<script>`和`</script>`。编写外部脚本*，就像在*标签之间进行编写一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T20:31:54.090

在您的 JS 文件中删除`<script>`and`</script>`标记。它们用于使用嵌入在 HTML 中的 JavaScript，而不是用于外部文件。

# ruby-on-rails - 如何配置动作邮件程序（我应该注册域）？

> ID：16092490
> 
> 赞同：9
> 
> 时间：2013-04-18T20:30:56.260
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, actionmailer

我正在使用 Ruby on Rails 创建一个简单的非盈利应用程序。我必须设置以下设置才能使用 Gmail 发送电子邮件：

```
Depot::Application.configure do

config.action_mailer.delivery_method = :smtp

config.action_mailer.smtp_settings = {
    address:"smtp.gmail.com",
    port:587,
    domain:"domain.of.sender.net",
    authentication: "plain",
    user_name:"dave",
    password:"secret",
    enable_starttls_auto: true
}

end 
```

我对这些东西完全陌生，不知道我到底应该做什么。

1.  如果我有 gmail 帐户，如何填充上述设置？我是否需要购买域名并且可以从谷歌购买才能使用上述设置？
2.  在我的电脑上设置邮件服务器更好吗？我看过 [本](http://www.pixelinx.com/2010/10/creating-a-mail-server-on-ubuntu-using-postfix-courier-ssltls-spamassassin-clamav-and-amavis/)教程，但据我所知，我仍然需要购买一个域名。

此外，正如[这里](https://help.ubuntu.com/community/MailServer)所说：

> 设置电子邮件服务器是一个困难的过程，涉及许多不同的程序，每个程序都需要正确配置。

由于这个和我糟糕的技能，我正在寻找最简单的解决方案。

我已经阅读了 rails action mailer[教程](http://guides.rubyonrails.org/action_mailer_basics.html)并且对这些参数的用途有所了解，但是关于 Gmail 和邮件服务器的事情根本不清楚。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-18T23:31:06.690

您的邮件程序的配置应该/可以在两者中定义`development`，`production`此配置的目的是当您设置它时，将使用`actionmailer`这些 SMTP 选项。你可以有一个简单的邮件，如下所示：

**梅勒**

```
class UserMailer < ActionMailer::Base
  default :from => DEFAULT_FROM
  def registration_confirmation(user)
    @user = user
    @url = "http://portal.herokuapp.com/login"
    mail(:to => user.email, :subject => "Registered")

  end
end 
```

**控制器**

```
 def create
    @title = 'Create a user'
    @user = User.new(params[:user])

    if @user.save
      UserMailer.registration_confirmation(@user).deliver
      redirect_to usermanagement_path
      flash[:success] = 'Created successfully.'
    else
      @title = 'Create a user'
      render 'new'
    end
  end 
```

所以这里发生的是，当`create`使用该操作时，这会触发邮件程序`UserMailer`查看上面的 UserMailer 它使用 ActionMailer 作为基础。按照下面显示的 SMTP 设置，可以在`config/environments/production.rb`development.rb 和 development.rb中定义

您将拥有以下内容：

```
 config.action_mailer.default_url_options = { :host => 'portal.herokuapp.com' }
  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
      :address              => 'smtp.gmail.com',
      :port                 => 587,
      :domain               => 'gmail.com',
      :user_name            => 'EMAIL_ADDRESS@gmail.com',
      :password             => 'pass',
      :authentication       => 'login',
      :enable_starttls_auto => true
  } 
```

如果您想在开发模式下定义 SMTP 设置，您将替换

```
config.action_mailer.default_url_options = { :host => 'portal.herokuapp.com' } 
```

和

```
config.action_mailer.default_url_options = { :host => 'IP ADDRESS HERE:3000' } 
```

这应该是一个足够彻底的解释，可以让你朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-04T21:51:59.287

一旦我将上述答案更改为

```
authentication: 'plain' 
```

并包括

```
config.action_mailer.raise_delivery_errors = true 
```

在我的开发环境中。

# php - Zend Framework 2 文件下载

> ID：16092493
> 
> 赞同：6
> 
> 时间：2013-04-18T20:31:14.370
> 
> 标签：php, zend-framework2, download

我制作了一个表格，`./data/uploads`使用`Zend\Filter\File\RenameUpload`过滤器将文件上传到文件夹。

这就像一个魅力。我现在的问题是如何将这个文件提供给用户下载呢？

我认为它会是这样的：

`$response->setContent(file_get_contents('./data/uploads/file.png'));`

但我想知道最好的方法是什么。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-24T15:20:29.690

对于遇到此线程寻找答案的任何人，这是一个有效的解决方案，它正在使用流！

```
public function downloadAction() {
    $fileName = 'somefile';

    $response = new \Zend\Http\Response\Stream();
    $response->setStream(fopen($fileName, 'r'));
    $response->setStatusCode(200);

    $headers = new \Zend\Http\Headers();
    $headers->addHeaderLine('Content-Type', 'whatever your content type is')
            ->addHeaderLine('Content-Disposition', 'attachment; filename="' . $fileName . '"')
            ->addHeaderLine('Content-Length', filesize($fileName));

    $response->setHeaders($headers);
    return $response;
} 
```

在这里找到： [使用 zf2 强制下载](https://stackoverflow.com/questions/15219873/force-download-using-zf2)

更多详细信息： [使用 zend 发送流响应](http://www.sasaprolic.com/2013/02/sending-stream-responses-with-zend.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-05-21T11:06:06.280

感谢@henrik 的回复，但他的回答中缺少几个重要的标题。小心那个。

完整的标题堆栈：

```
public function downloadAction() {
    $file = 'path/to/file';
    $response = new \Zend\Http\Response\Stream();
    $response->setStream(fopen($file, 'r'));
    $response->setStatusCode(200);
    $response->setStreamName(basename($file));
    $headers = new \Zend\Http\Headers();
    $headers->addHeaders(array(
        'Content-Disposition' => 'attachment; filename="' . basename($file) .'"',
        'Content-Type' => 'application/octet-stream',
        'Content-Length' => filesize($file),
        'Expires' => '@0', // @0, because zf2 parses date as string to \DateTime() object
        'Cache-Control' => 'must-revalidate',
        'Pragma' => 'public'
    ));
    $response->setHeaders($headers);
    return $response;
} 
```

# r - 字典和对

> ID：16092503
> 
> 赞同：0
> 
> 时间：2013-04-18T20:31:40.683
> 
> 标签：r, dictionary, keyvaluepair

在 RI 中，我想知道我是否可以有一个字典（在某种意义上像 python），其中我有一对`(i, j)`作为具有相应整数值的键。**我还没有看到在R**中构建它的干净或直观的方法。我的字典的视觉效果是：

(1, 2) --> 1

(1, 3) --> 3

(1, 4) --> 4

(1, 5) --> 3

**编辑：** 插入这些键值对的代码行在带有计数器 i 和 j 的循环中。例如假设我有：

```
for(i in 1: 5)
{  
  for(j in 2: 4)
  {
    maps[i][j] = which.min(someVector)
  }
} 
```

如何更改`maps[i][j]`以获得我正在寻找的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T21:06:02.757

命名列表和环境都提供了一个映射，但在字符串（名称，充当键）和任意 R 对象（值）之间。如果您的`i`and`j`很简单（正如它们在您的示例中显示的那样，是整数），您可以通过将它们与一些分隔符连接起来，轻松地从它们中创建一个唯一的字符串。这将生成一个有效的名称/密钥

```
mykey <- function(i, j) {
  paste(i, j, sep="|")
}

maps <- list()
for(i in 1: 5) {  
  for(j in 2: 4) {
    maps[mykey(i,j)] <- which.min(someVector)
  }
} 
```

您可以为特定的`i`和`j`使用提取任何值

```
maps[[mykey(i,j)]] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T21:10:27.140

这是您在 a 中执行此操作的方法`data.table`，这将是快速且易于扩展的：

```
library(data.table)
d = data.table(i = 1, j = 2:5, value = c(1,3,4,3), key = c("i", "j"))

# access the i=1,j=3 value
d[J(1, 3)][, value]

# change that value
d[J(1, 3), value := 12]

# do some vector assignment (you should stop thinking loops, and start thinking vectors)
d[, value := i * j] 
```

等等

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-18T20:43:46.190

你可以只使用一个data.frame：

```
a = data.frame(spam = c("alpha", "gamma", "beta"), 
               shrub = c("primus","inter","parus"),
               stringsAsFactors = FALSE)
rownames(a) = c("John", "Eli","Seth")
> a
      spam  shrub
John alpha primus
Eli  gamma  inter
Seth  beta  parus

>     a["John", "spam"]
[1] "alpha" 
```

这使用带有命名键的 2d 字典样式对象来处理这种情况。键也可以是整数，尽管它们可能必须是字符而不是数字。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-18T21:21:29.693

您可以使用向量列表来执行此操作。

```
maps <- lapply(vector('list',5), function(i) integer(0))
maps[[1]][2] <- 1
maps[[1]][3] <- 3
maps[[1]][4] <- 4
maps[[1]][5] <- 3 
```

也就是说，可能有更好的方法来做你想做的事情，但你没有给我们足够的背景知识。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-18T20:44:15.247

R 矩阵允许您这样做。有稀疏和密集版本。我相信 tm-package 使用稀疏矩阵的变体来形成其字典的实现。这显示了如何提取矩阵 M 的 [i,j] 元素，其中 [i,j] 表示为一个两列矩阵。

```
M<- matrix(1:20, 5, 5)
ij <- cbind(sample(1:5), sample(1:5) )

> ij
     [,1] [,2]
[1,]    4    4
[2,]    1    2
[3,]    5    3
[4,]    3    1
[5,]    2    5
> M[ij]
[1] 19  6 15  3  2 
```

@Justin 还指出您可以使用可以按位置索引的列表：

```
 L <- list( as.list(letters[1:5] ), as.list( paste(2,letters[1:5] ) ) )

> L[[1]][[2]]
[1] "b"
> L[[2]][[2]]
[1] "2 b" 
```

# java - 如何更改文件位置的文件扩展名

> ID：16092504
> 
> 赞同：-8
> 
> 时间：2013-04-18T20:31:40.787
> 
> 标签：java

我有一个用户上传文件的应用程序，

但我想要的是检测上传文件的文件扩展名，如果 doc 文件执行其他操作，则什么也不做

有人有想法么？

有没有办法更改文件扩展名，例如文件是 D:/test.doc 更改为 D:/test.pdf

我知道这不会转换文件格式，稍后会完成

文件位置每次都会改变等等，所以我只需要一种方法来获取位置，并更改文件扩展名

我目前拥有的代码

```
File file = new File("oldname");

File file2 = new File("newname");
// Rename file (or directory)
boolean success = file.renameTo(file2);
if (!success)
{
// File was not successfully renamed
} 
```

但这并没有做到:(这段代码的问题是我必须给出新的文件名，我不能因为它应该与旧文件名完全相同，只是扩展名不同

编辑 2

希望这会澄清它，因为最后一个问题有点令人困惑

基本上，我有一个程序可以将上传的 doc 文件转换为 pdf，但是上传的 doc 的位置每次都会改变，因为它会为每个用户创建一个文件夹

这是在变量中定义的`String location`

我想要做的是使用这个变量`location`，因为这将以 a 结尾，`.doc`我想将`location`from更改`.doc`为`.pdf`

我已经设法找到了文件的名称，没有使用 hte 扩展名：

```
 String path = location;
        File f = new File(path);
        System.out.println(f.getName()); 
        String fName = f.getName();
        System.out.println(fName.substring(0, fName.lastIndexOf('.'))); 
```

但是我怎样才能找到文件名之前的路径

编辑最后一次我找到了解决方案

```
 System.out.println(path2.substring(0, path2.lastIndexOf('.')));
            newLocation = (path2.substring(0, path2.lastIndexOf('.')))+".pdf";
            System.out.println(newLocation); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:34:52.923

您可以简单地通过字符串匹配来检查扩展名，例如`endsWith()`.

要找出文件名之前的路径，请在绝对路径上使用 lastIndexof("\")。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:39:04.787

如果您需要检查上传文件的文件扩展名，我建议使用幻数。

您可以在[此处找到更多详细信息](http://igormadjeric.blogspot.com/2012/07/checking-files-magic-numbers.html)

检查 .doc 或 .pdf 等扩展名并不意味着该文件是 word 文档或 pdf 文档文件。

# git - 如何从提交消息中删除 svn url？

> ID：16092509
> 
> 赞同：2
> 
> 时间：2013-04-18T20:31:55.347
> 
> 标签：git, github, git-svn

我正在尝试将 git-svn 存储库推送到 github，但我不希望 url 出现在我的提交消息中。

它们出现是因为我正在使用 svn 开发并且只使用 git-svn 推送到 github。所以我所有的消息看起来像：

```
Some changes

git-svn-id: ........ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T22:39:47.027

您可以通过设置以下配置选项（全局或基于远程）将其关闭，但强烈建议**不**要这样做，因为`git svn`没有此元数据将无法获取。

```
svn.noMetadata = true
svn-remote.origin.noMetadata = true 
```

您也可以使用`--no-metadata`with 选项`git svn clone`来获得相同的结果。

从手册页[`git-svn`](https://www.kernel.org/pub/software/scm/git/docs/git-svn.html)：

> **--无元数据**
> 
> 在 [svn-remote] 配置中设置 noMetadata 选项。不推荐使用此选项，请在使用此选项之前阅读此手册页的 svn.noMetadata 部分。

以及相关的配置文件选项：

> **svn.no元数据**
> 
> **svn-remote..no元数据**
> 
> 这消除了每次提交末尾的 git-svn-id: 行。
> 
> 此选项只能用于一次性导入，因为 git svn 将无法在没有元数据的情况下再次获取。此外，如果您丢失了 .git/svn/*/.rev_map。文件，git svn 将无法重建它们。
> 
> git svn log 命令也不适用于使用它的存储库。出于（希望）显而易见的原因，使用此与 useSvmProps 选项冲突。
> 
> 不推荐使用此选项，因为它很难在现有文档、错误报告和存档中追踪对 SVN 修订号的旧引用。如果您计划最终从 SVN 迁移到 git，并且确定要删除 SVN 历史记录，请考虑使用 git-filter-branch(1)。filter-branch 还允许重新格式化元数据以便于阅读和重写非“svn.authorsFile”用户的作者信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-07-01T03:47:20.553

以防万一您已经使用 获取了数据，`git svn fetch`您可以将`git filter-branch`其用作替代方案。

```
git filter-branch -f --msg-filter 'sed -e "/git-svn-id:/d" -e "/Former-commit-id:/d"' 
```

您可以相应地更改“git-svn-id:”或“Former-commit-id:”。

# jquery - 从 jquery .offset() 获取错误的值

> ID：16092512
> 
> 赞同：4
> 
> 时间：2013-04-18T20:32:14.000
> 
> 标签：jquery, html, css, offset

我从 jquery .offset() 得到错误的值，我认为这是因为 CSS 但找不到错误。

这是我试图获取偏移量的 HTML 元素：

```
<div id="sedes" class="seccion_in">
</div> 
```

这是CSS

```
.seccion_in { position:relative; overflow: hidden; width: 100%; height: auto; } 
```

这是jQuery：

```
console.log($("#sedes").offset()); 
```

这是工作链接： http: [//ficm.hacemoscodigo.com/asiste/](http://ficm.hacemoscodigo.com/asiste/)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:39:07.213

### ID 必须是唯一的！

您`#sedes`位于`<div id="nav">`和`#sedes`中`<div id="content">`。我的猜测是你`.offset()`在`#sedes`你的`nav`. 删除/重命名该元素的 ID，你应该很好。

确保改用类。

如果您有任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:40:50.540

查看. [_`offset`](http://api.jquery.com/offset/)

`{top: 0, left: 0}`由于父级的定位，它应该返回。

# c++ - 失踪 ';' 在'模板<'之前

> ID：16092520
> 
> 赞同：4
> 
> 时间：2013-04-18T20:32:36.297
> 
> 标签：c++, visual-studio-2010, templates, header-files

我在编译程序时遇到了一个奇怪的错误：

`Error 1 error C2143: syntax error : missing ';' before ''template<''`

我做的一切都很标准；没有什么不寻常的：

```
#ifndef HEAP_H
#define HEAP_H
//**************************************************************************
template<typename TYPE>
class Heap
{
    private:
        TYPE* heapData;
        int currSize;
        int capacity;
        void _siftUp(int);
        void _siftDown(int);
        int _leftChildOf(int) const;
        int _parentOf(int) const;

    public:
        Heap(int c = 100);
        ~Heap();
        bool viewMax(TYPE&) const;
        int getCapacity() const;
        int getCurrSize() const;
        bool insert(const TYPE&);
        bool remove(TYPE&);
}; 
```

不太确定出了什么问题。我尝试关闭并重新打开我的程序 - 没有运气。使用 Visual Studio 2010

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-18T20:37:01.683

这个错误可能有点误导。

`;`a发生**在之前** 并不一定重要`template<`。

这`;`实际上是在*之前*发生的任何事情**之后**预期的。*`template<`*

 *这个例子展示了这是如何发生的。

文件`header.h`

```
class MyClass
{

} 
```

文件`heap.h`

```
#ifndef HEAP_H
#define HEAP_H
//**************************************************************************
template<typename TYPE>
class Heap
{
};

#endif 
```

文件`main.cpp`

```
#include "header.h"
#include "heap.h"

int main()
{
} 
```

**编辑：**

这个编译器错误导致您输入错误文件的原因是*在*编译之前，预处理器将处理`main.cpp`成这个单一的字符流。

```
class MyClass
{

}

//**************************************************************************
template<typename TYPE>
class Heap
{
};

int main()
{
} 
```*

# mysql - MySQL，相同的别名和列名，哪个优先？

> ID：16092525
> 
> 赞同：1
> 
> 时间：2013-04-18T20:32:49.777
> 
> 标签：mysql, sql

如果 MySQL 遇到相同的列名和别名，是否总是优先使用其中一个？例如

```
select NODE1 as `NODE2`, NODE2 as `NODE1` where `NODE2`=? 
```

上述查询是否总是将NODE1**列（****标签**NODE2）与占位符匹配？换句话说，标签总是优先吗？

如果是这样，这是否适用于所有 SQL 数据库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:35:36.980

您不能在`WHERE`子句中使用别名，因此列名在这里很重要。

> 可以在查询选择列表中使用别名来为列指定不同的名称。**您可以在 GROUP BY、ORDER BY 或 HAVING 子句中使用别名来引用列：**

和

> **标准 SQL 不允许在 WHERE 子句中引用列别名。** 施加此限制是因为在评估 WHERE 子句时，可能尚未确定列值。

两个引用都来自[C.5.5.4。列别名问题](http://dev.mysql.com/doc/refman/5.0/en/problems-with-alias.html)

# python - 将变量设置为类的名称并从该类调用函数

> ID：16092529
> 
> 赞同：1
> 
> 时间：2013-04-18T20:32:59.800
> 
> 标签：python

有没有办法将变量设置为字符串，然后使用该变量从与该变量同名的类中调用函数？

例如：

```
class Foo(object):
    def printer(self):
        print "Hello."

Bar = Foo()
var = 'Bar' 
```

然后，当我尝试调用 var.printer() 时，出现错误：

```
AttributeError: 'str' object has no attribute 'printer' 
```

这是有道理的，但是有没有办法通过使用与类同名的变量以这种方式调用类函数？

我想这样做的原因是我可以拥有一组单独的变量，能够调整这些变量，然后将它们组合成一个字符串并从与字符串同名的类中调用一个函数。例如：

```
from random import randint    

x = 0
y = 0

class c00(object):
    def printname(self):
        print "c00"

class c01(object):
    def printname(self):
        print "c01"

choose_class = randint(0, 2)

if choose_class == 0:
    xstr = str(x)
    ystr = str(y)
    string = 'c' + xstr + ystr
    string.printname()

else:
    y += 1
    xstr = str(x)
    ystr = str(y)
    string = 'c' + xstr + ystr
    string.printname() 
```

有什么办法可以使这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:34:31.273

`locals`您可以从返回的映射（或`globals`取决于`Bar`定义的位置）中以字符串形式从其名称中获取对“Bar”对象的引用：

```
locals()['Bar'].printer() 
```

作为一些不请自来的建议，通常如果你这样做，最好`'Bar'`首先明确地放入字典，而不是需要依赖`locals`/ `globals`/ `vars`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:37:34.483

与其将对象放入单个变量中，不如将它们放入一个字典中：

```
chooser = {'c00': c00(), 'c01': c01()}
chooser['c' + xstr + ystr].printname() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:38:37.873

如果我很好地理解了您的问题，则无需这样做，只需使用列表即可`random.choice`：

```
class c00(object):
    def printname(self):
        print "c00" 

class c01(object):
    def printname(self):
        print "c01" 

classes = [c01, c00]

my_var = random.choice(classes)()
my_var.printname() 
```

# ios - JSON 带有“（”“）”括号而不是“[”“]”

> ID：16092546
> 
> 赞同：1
> 
> 时间：2013-04-18T20:34:12.897
> 
> 标签：ios, json, cocoa-touch

以 .m 为单位：

```
 @implementation ViewController
    {
    NSDictionary *_json;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURL* url = [NSURL URLWithString:@"http://api.worldweatheronline.com/free/v1/weather.ashx?q=Si%C3%B3fok&format=json&num_of_days=5&key=mykey"];

    NSData *jsonData = [NSData dataWithContentsOfURL:url];

    NSError *error;
    _json = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error];

    NSDictionary* fullDictFromjson = _json[@"data"];

    NSLog(@"%@",fullDictFromjson);

    NSDictionary* currentCondition = fullDictFromjson[@"current_condition"];

    NSLog(@"%@",currentCondition); 
```

在此之后，我在控制台（ currentCondition ）中得到了这个：

```
2013-04-18 22:18:16.758 weather[18111:c07] (
        {
        cloudcover = 0;
        humidity = 74;
        "observation_time" = "08:18 PM";
        precipMM = "0.0";
        pressure = 1019;
        "temp_C" = 11;
        "temp_F" = 51;
        visibility = 10;
        weatherCode = 113;
        weatherDesc =         (
                        {
                value = Clear;
            }
        );
        weatherIconUrl =         (
                        {
                value = "http://www.worldweatheronline.com/images/wsymbols01_png_64/wsymbol_0008_clear_sky_night.png";
            }
        );
        winddir16Point = S;
        winddirDegree = 170;
        windspeedKmph = 5;
        windspeedMiles = 3;
    }
) 
```

我不能用这个。

如果我在 Safari 中打开此网址：

“current_condition”：[ {“cloudcover”：“0”，......所以有“[”而不是“（”

所以我的json错了，在xcode中

我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:38:41.273

您在日志输出中看到的只是对象集合的格式，`NSArray`而`NSDictionary`不是实际的 JSON 本身。`[`在源 JSON中有 a并且`(`在日志语句中有 a 的地方，你有一个数组；哪里有`{`你有一本字典。

因此，您需要先从单元素数组中提取字典，然后才能使用它：

```
NSDictionary* currentCondition = fullDictFromjson[@"current_condition"][0]; 
```

# javascript - 阻止相机旋转phonegap android应用程序

> ID：16092555
> 
> 赞同：1
> 
> 时间：2013-04-18T20:34:50.323
> 
> 标签：javascript, android, cordova, camera

我有一个用 html5 和 javascript 编写的应用程序。这个应用程序只能在纵向模式下使用，所以我使用了`android:screenOrientation="portrait"`. 接下来我使用phonegap将它部署在android设备上，设置中禁用了屏幕自动旋转，我遇到了一个小问题。这个应用程序允许用户拍照。为此我正在使用

```
navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 100}); 
```

由于某种未知原因，当我以纵向模式拍照时，系统以横向模式旋转，并且在图片 android 尝试以横向模式重新加载我的应用程序时，我的应用程序崩溃了..

如何阻止从我的应用程序到照片应用程序的转换中的旋转？我也尝试设置`correctOrientation:true`，但它不起作用。

固定的！！！！放在正确的地方`android:configChanges="orientation|keyboardHidden">`，它的工作！

# python - 如何检查矩阵是否包含零列？

> ID：16092557
> 
> 赞同：8
> 
> 时间：2013-04-18T20:34:56.753
> 
> 标签：python, numpy

我有一个大矩阵，我想检查它的某处是否有一列全为零。如何在 numpy 中做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-18T20:43:38.960

这是一种方法：

```
In [19]: a
Out[19]: 
array([[9, 4, 0, 0, 7, 2, 0, 4, 0, 1, 2],
       [0, 2, 0, 0, 0, 7, 6, 0, 6, 2, 0],
       [6, 8, 0, 4, 0, 6, 2, 0, 8, 0, 3],
       [5, 4, 0, 0, 0, 0, 0, 0, 0, 3, 8]])

In [20]: (~a.any(axis=0)).any()
Out[20]: True 
```

如果您后来决定需要列索引：

```
In [26]: numpy.where(~a.any(axis=0))[0]
Out[26]: array([2]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T20:43:01.707

创建一个`equals 0`蒙版 ( `mat == 0`)，并`all`在其上沿轴运行。

```
(mat == 0).all(axis=0).any() 
```

# iup - IUP，矩阵上的鼠标事件

> ID：16092558
> 
> 赞同：0
> 
> 时间：2013-04-18T20:34:58.297
> 
> 标签：iup

我对 IUP 事件系统的理解有基本的困惑。现在我说的是矩阵。

这是它的创建方式：

```
Ihandle *create_mat(void)
{
mat = IupMatrix(NULL);

IupSetAttribute(mat, "READONLY", "YES");
IupSetCallback(mat, "CLICK_CB", (Icallback)click);
IupSetCallback(mat, "BUTTON_CB", (Icallback)button);
return mat;
} 
```

以下是回调：

```
int click(Ihandle *mat, int lin, int col)
{
char* value = IupMatGetAttribute(mat, "", lin, col);
if (!value) value = "NULL";
printf("click_cb(%d, %d)\n", lin, col);
return IUP_DEFAULT;
}

int button(Ihandle *mat, int button, int pressed, int x, int y, char* status)
{
printf("button %d, %d, %d, %d %s\n", button, pressed, x, y, status);
return IUP_DEFAULT;
} 
```

问题在于我需要激活两个回调，但在显示的情况下 CLICK 事件没有被触发。
如果我禁用 BUTTON_CB 则触发 CLICK 事件。但我需要两者，点击，左键双击，右键释放等......

这是 BUTTON_CB 排除 CLICK_CB 的正常行为还是我做错了什么？

实际上，如果提供 lin 和 col 的 CLICK_CB、ENTERITEM_CB 和 LEAVEITEM_CB 不可用（在所述情况下未触发），我将如何从矩阵的 BUTTON_CB 或 WHEEL_CB 处理程序中获取“lin”和“col”？

还有更多，我将如何从表单级别使用的事件处理程序中获得“活动控件”（名称、具有焦点的控件类型）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:51:16.857

> 这是 BUTTON_CB 排除 CLICK_CB 的正常行为还是我做错了什么？

是的。因为 BUTTON_CB 是一个 IupCanvas 回调，而 CLICK_CB 是一个 IupMatrix 回调。请记住，IupMatrix 继承自 IupCanvas。所以在内部 IupMatrix 使用 BUTTON_CB 回调来实现几个功能。

所以在这种情况下，你需要做的是在分配一个新的回调之前保存之前的回调，然后从你自己的内部调用旧的回调。像这样的东西：

```
old_callback = IupGetCallback(mat, "BUTTON_CB");
IupSetCallback(mat, "BUTTON_CB", new_callback);

int new_callback(...)
{
  return old_callback(...)
} 
```

> 实际上，如果提供 lin 和 col 的 CLICK_CB、ENTERITEM_CB 和 LEAVEITEM_CB 不可用（在所述情况下未触发），我将如何从矩阵的 BUTTON_CB 或 WHEEL_CB 处理程序中获取“lin”和“col”？

使用函数 pos = IupConvertXYToPos(mat, x, y) 其中 pos=lin*numcol + col。考虑到它们是整数值，计算 lin 和 col 非常简单。

> 还有更多，我将如何从表单级别使用的事件处理程序中获得“活动控件”（名称、具有焦点的控件类型）？

我没有完全理解你的问题。但我认为 IupGetFocus 和 IupGetClassName 可能是您想要的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T22:14:18.703

我将使用 Antonio 的建议来回答我自己的问题，以便其他对 IUP 感兴趣的人可以从这些帖子中受益。

如果我理解得很好，那不太可能，这就是我为我的矩阵制作 BUTTON_CB 处理程序的方法：

```
int button(Ihandle *mat, int button, int pressed, int x, int y, char* status)
{
//actually 'name' is Ihandle
//and class name is a 'type'
//in compare with other toolkits
char* name = IupGetClassName(mat);

//so since we have handle already
//we can't be here if we are not in concrete matrix
//and this comparision is not needed
if (strncmp(name, "matrix", sizeof(name)) == 0)
{
    //if left mouse button is down
    if (button == IUP_BUTTON1 && pressed == 1)
    {
        //my calculation is not 100% correct
        //but good enough for this sample
        int pos = IupConvertXYToPos(mat, x, y);
        _line = pos/numcol;
        _col = pos%numcol;

        //if is doubleclick
        if (status[5] == 'D')
        {
            //press ENTER key
            //and open another modal dialog
            //with argument 'sel'
            k_any(mat, K_CR);

            printf("Doubleclick\n");
            //say HANDLED for IUP
            //but not matter when READONLY is "YES"
            return IUP_IGNORE;
        }

        //calculate (public) sel
        //for select a clicked line
        sel = _line + from - 1;
        refreshl(from, sel);

        printf("Click\n");
        return IUP_IGNORE;
    }
}
return IUP_DEFAULT;
} 
```

这项工作符合预期。
如果有问题，请进一步提出建议。

# css - 跨度标签可以在 Firefox 中继承其输入的高度父级吗？

> ID：16092560
> 
> 赞同：3
> 
> 时间：2013-04-18T20:35:11.537
> 
> 标签：css, firefox, button

我在按钮内获取 SPAN（或 DIV）以转到 Firefox（版本 20）中按钮的完整高度时遇到问题。

[http://jsfiddle.net/spiderplant0/BwwuV/](http://jsfiddle.net/spiderplant0/BwwuV/)

它在 IE10 和 Chrome 中运行良好。

除了计算每个按钮的高度并在 px 中明确设置之外，有没有人知道是否有解决方案？

```
#id1_container {
    display: block; 
    text-decoration: none; 
    cursor: pointer; 
    box-shadow: none;
    background: none;
    -webkit-user-select: none;
    -moz-user-select: none; 
    user-select: none; 
    width: 100px;
    height: 100px;
    padding: 0;
    border: 1px solid green;
}

#id1_container > * {
    display: block;
    height: 100%;
    width: 100%;
    background: pink;
}

<button type="button" id="id1_container"><span>hello</span></button> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:10:19.980

您需要将其包装`button`在 a`div`中才能使高度生效。

```
<div>
  <button type="button" id="id1_container">
      <span>hello</span>
  </button>
</div> 
```

# [工作示例](http://jsfiddle.net/BwwuV/13/)

老实说，这背后的原因对我来说仍然有点不清楚，我正在尝试自己弄清楚。我所知道的是，这是解决问题的唯一方法，而无需像其他人建议的那样进行*黑客攻击。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:13:51.920

由于您尚未重置边距和填充`span`，因此对我来说似乎是个问题。正如@Rockafella 所建议的那样，使用绝对定位的跨度会起作用，因此它对我来说似乎并不理想，因为您的跨度具有 100% 的宽度和高度。因此，请尝试在标记之前使用 CSS 重置代码，例如 Eric Meyer @ [http://meyerweb.com/eric/tools/css/reset/提供的代码](http://meyerweb.com/eric/tools/css/reset/)

# javascript - D3：合并内部 svg 路径？

> ID：16092564
> 
> 赞同：21
> 
> 时间：2013-04-18T20:35:34.660
> 
> 标签：javascript, svg, d3.js

我有一个`svg`由许多不同`path`对象组成的元素，每个对象代表一个美国州。 ![在此处输入图像描述](https://i.stack.imgur.com/X0qZb.png)

[http://jsfiddle.net/jGjZ2/](http://jsfiddle.net/jGjZ2/)

我想将东部领土（黄金）合并为一个没有可见划分的单一路径对象。

最终结果应如下所示（忽略不准确之处）： ![在此处输入图像描述](https://i.stack.imgur.com/5tanI.png)

我正在使用 D3。没有 GeoJSON 或 TopoJSON 数据 - 地图是 svg 直接嵌入到 html 中（参见 jsfiddle）。

非常感谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-18T21:42:28.710

假设您可以忽略操作现有 SVG 图像的规定限制（这似乎是一个任意限制，因为制图边界以更易于操作的格式随时可用......），您可以**使用[topojson.mesh](https://github.com/mbostock/topojson/wiki/Client-API-Reference)合并多个多边形**。但是，请注意，此方法有一些限制，如本示例中所述：

[![合并的多边形](https://i.stack.imgur.com/KiOgS.png)](http://bl.ocks.org/mbostock/5416405)

另一种简单的方法是只**绘制两次突出显示的多边形**：一次使用粗黑色笔划且无填充，第二次在顶部使用橙色填充且无笔划。这无需任何拓扑操作即可达到相同的效果：

[![合并多边形](https://i.stack.imgur.com/XN0lc.png)](http://bl.ocks.org/mbostock/5416440)

我想如果你真的必须这样做，你可以通过提取矢量数据进入 SVG 元素并做同样的事情，但如果你从干净的数据开始会更容易。

# javascript - 正确的 JAVASCRIPT 中的 HTML 语法

> ID：16092567
> 
> 赞同：0
> 
> 时间：2013-04-18T20:35:38.770
> 
> 标签：javascript, html, syntax, simplecart

我的问题是我不知道在 javascript 片段中实现 html 的正确语法。

我正在使用 simplecart.js，我想添加一个自定义购物车列，其中包含一个项目的颜色，但我从一小时开始就一直坚持这一点。

```
{
    view: function (item, column) {
        "<div id='couleur'>
        <div style='background-color:'"
        return item.get('color')"'></div>
    </div>"
    },
    label: "Couleur"
}, 
```

谁能帮我解决这个问题？
非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:38:30.327

你不能在字符串中换行，你有嵌套的双引号，你有一个没有意义的函数调用。

```
view: function (item, column) {
    var str = "<div id='couleur'>" +
              "<div style='background-color:" + item.get('color') + "'></div>" +
              "</div>";
    return str;
} 
```

大多数人会更多地使用模板类型的架构。

```
view: function (item, column) {
    var str = "<div id='couleur'><div style='background-color:{color}'></div></div>";
    return str.replace("{color}", item.get('color'));
} 
```

# html - 单个数据输入的表格单元格更改

> ID：16092569
> 
> 赞同：0
> 
> 时间：2013-04-18T20:35:42.917
> 
> 标签：html, html-table

我正在通过使用 html 设计前端来做项目。我正在使用表来为不同的标签创建分区。

问题：当我输入单元格的静态值时，单元格大小也会发生变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:36:57.500

设置一个`width`：`td`

```
td {
  width: 100px;
} 
```

# c# - 如何在 C-Sharp 中初始化访问号码字段

> ID：16092570
> 
> 赞同：0
> 
> 时间：2013-04-18T20:35:44.973
> 
> 标签：c#, ms-access, select, sql-update

我知道如何在 Access 查询中为字符串字段使用文本框值，但我无法理解如何将它用于 int 字段。

我正在编写以下查询并接收错误消息。

> 错误消息：没有为一个或多个必需参数指定值。

```
OleDbCommand cmd = new OleDbCommand("Update Table1 Set Name= '" + textBox2.Text + "' where ID= " +textBox2.Text  , conn);
conn.Open();
cmd.ExecuteNonQuery(); 
```

我也尝试将 textBox2 转换为 int，但它也给了我一条错误消息。

> 输入字符串的格式不正确。

```
int Id= Convert.ToInt16(textBox2.Text);
OleDbCommand cmd = new OleDbCommand("Update Table1 Set Name= '" + textBox2.Text + "' where ID= " + Id  , conn);
conn.Open();
cmd.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:10:59.380

这个答案纠正了你的问题
首先，名称的文本框与用于 ID 的文本框不同。
其次，不要连接字符串来构建 sql 命令。它非常容易出错并且对一个众所周知的 sql 漏洞开放，称为[Sql Injection](https://stackoverflow.com/questions/332365/how-does-the-sql-injection-from-the-bobby-tables-xkcd-comic-work)

```
string queryText = Update Table1 Set Name= ? where ID= ?"; 
OleDbCommand cmd = new OleDbCommand(queryText, conn);
cmd.Parameters.AddWithValue("@p1", TextBox1.Text);
cmd.Parameters.AddWithValue("@p2", Convert.ToInt32(TextBox2.Text));
conn.Open();
cmd.ExecuteNonQuery(); 
```

在这里，我删除了字符串连接并插入了两个参数占位符 (?)，然后我在 OleDbCommand 中添加了两个参数及其值。
执行查询时，OleDb 代码将用实际值替换占位符，检查无效字符和无效 sql 语句

# java - 我想在Java中将4张图片合并在一起

> ID：16092573
> 
> 赞同：2
> 
> 时间：2013-04-18T20:35:52.393
> 
> 标签：java, image, image-processing, merge, awt

我正在努力理解如何在 java 中将 4 张图片合并在一起，我想将每个图像复制到合并后的图像中，其中重叠的 20 个像素混合在 50% 的合并中。为合并后的图像提供一个 20 像素的边界，该边界是每个图像的适当部分的混合。

所以一个 4 图像框，图像相互混合 20 像素。不知道我应该如何使用图像的宽度和高度，因为它非常令人困惑。

像[这样](http://www.talk.hostoi.com/img.html)的东西。怎么做？

![在此处输入图像描述](https://i.stack.imgur.com/oelpP.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T05:54:53.793

我的所有信息来自：[`AlphaComposite`](http://docs.oracle.com/javase/7/docs/api/java/awt/AlphaComposite.html)、[合成图形](http://docs.oracle.com/javase/tutorial/2d/advanced/compositing.html)、[连接图像](http://kalanir.blogspot.com/2010/02/how-to-merge-multiple-images-into-one.html)。

改进了以下程序。它使用两种方法：`joinHorizontal`和`joinVertical`加入图像。在方法内部，会发生以下情况

*   第二个图像被复制，但只有重叠的部分
*   复制的图像设置为半 alpha（透明度）
*   在“返回图像”的画布上，绘制第一个图像，然后绘制第二个没有重叠部分的图像
*   复制的图像被绘制到画布上。
*   图像被退回

为什么我只将一张图像设置为半 alpha 而不是两者都设置？

想象一个透明的玻璃窗：

![在此处输入图像描述](https://i.stack.imgur.com/82JzS.png)

将随机点涂成红色，使窗口的一半被红色覆盖。现在，将带有红点的窗口视为您的新画布。

![在此处输入图像描述](https://i.stack.imgur.com/j5Bcj.png)

将随机点涂成蓝色，使新的“画布”被蓝色覆盖一半。窗户不会被完全覆盖；你仍然可以看穿它。

![在此处输入图像描述](https://i.stack.imgur.com/cYmem.png)

但是让我们想象一下，我们先把窗户涂成红色，然后把一半涂成蓝色。现在，它将是一半蓝色和一半红色，但根本不透明。

```
public class ImageMerger {

    /**
     * @param args
     * @throws IOException 
     */
    public static void main(String[] args) throws IOException {
        // TODO Auto-generated method stub
        BufferedImage img1 = //some code here
        BufferedImage img2 = //some code here
        BufferedImage img3 = //some code here
        BufferedImage img4 = //some code here

        int mergeWidth = 20; // pixels to merge.
        BufferedImage merge =  ImageMerger.joinVertical(
                ImageMerger.joinHorizontal(img1, img2, mergeWidth),
                ImageMerger.joinHorizontal(img3, img4, mergeWidth),mergeWidth);

        //do whatever you want with merge. gets here in about 75 milliseconds

    }

    public static BufferedImage joinHorizontal(BufferedImage i1, BufferedImage i2, int mergeWidth){
        if (i1.getHeight() != i2.getHeight()) throw new IllegalArgumentException("Images i1 and i2 are not the same height");

        BufferedImage imgClone = new BufferedImage(mergeWidth, i2.getHeight(), BufferedImage.TYPE_INT_ARGB);
        Graphics2D cloneG = imgClone.createGraphics();
        cloneG.drawImage(i2, 0, 0, null);
        cloneG.setComposite(AlphaComposite.getInstance(AlphaComposite.DST_IN, 0.5f));
        cloneG.drawImage(i2, 0, 0, null);

        BufferedImage result = new BufferedImage(i1.getWidth() + i2.getWidth() 
                - mergeWidth, i1.getHeight(), BufferedImage.TYPE_INT_ARGB);
        Graphics2D g = result.createGraphics();
        g.drawImage(i1, 0, 0, null);
        g.drawImage(i2.getSubimage(mergeWidth, 0, i2.getWidth() - mergeWidth,
                i2.getHeight()), i1.getWidth(), 0, null);
        g.drawImage(imgClone, i1.getWidth() - mergeWidth, 0, null);

        return result;
    }
    public static BufferedImage joinVertical(BufferedImage i1, BufferedImage i2, int mergeWidth){
        if (i1.getWidth() != i2.getWidth()) throw new IllegalArgumentException("Images i1 and i2 are not the same width");

        BufferedImage imgClone = new BufferedImage(i2.getWidth(), mergeWidth, BufferedImage.TYPE_INT_ARGB);
        Graphics2D cloneG = imgClone.createGraphics();
        cloneG.drawImage(i2, 0, 0, null);
        cloneG.setComposite(AlphaComposite.getInstance(AlphaComposite.DST_IN, 0.5f));
        cloneG.drawImage(i2, 0, 0, null);

        BufferedImage result = new BufferedImage(i1.getWidth(), 
                i1.getHeight() + i2.getHeight() - mergeWidth, BufferedImage.TYPE_INT_ARGB);
        Graphics2D g = result.createGraphics();
        g.drawImage(i1, 0, 0, null);
        g.drawImage(i2.getSubimage(0, mergeWidth, i2.getWidth(),
                i2.getHeight() - mergeWidth), 0, i1.getHeight(), null);
        g.drawImage(imgClone, 0, i1.getHeight() - mergeWidth, null);

        return result;
    }

} 
```

# java - 正则表达式找不到匹配项

> ID：16092575
> 
> 赞同：1
> 
> 时间：2013-04-18T20:36:00.230
> 
> 标签：java, regex

我正在尝试匹配此字符串中的 Salvage 一词，但代码没有找到它。我哪里错了？

```
//String to match
String titleString = "<td><i><a href="/page/Vengeance2" title="Salary">Salvage</a></i></td>";

System.out.println(titleString);

//Template
String template = ">(.*)</a>";

//
Pattern p=Pattern.compile(template);
Matcher matcher = p.matcher(titleString);

System.out.println(matcher.group(1)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:38:57.343

尝试`matcher.find()`在`matcher.group(1)`.

该组采用“上一场比赛的组”。但是由于还没有匹配，所以你什么也没找到。

# c# - 分号“;”是什么意思 在 Uri 字符串中做什么？

> ID：16092577
> 
> 赞同：0
> 
> 时间：2013-04-18T20:36:06.087
> 
> 标签：c#, uri

我在 C# 代码中看到了一行：

```
Image = new BitmapImage(
    new Uri("/MyProgramName;component/Images/a.png", UriKind.Relative)); 
```

那个“;”是什么意思 在这个 Uri 字符串中做什么？

那个 a.png 实际上在 MyProgramName/Images/a.png 下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:39:07.320

它只是[WPF 资源 URI](http://msdn.microsoft.com/en-us/library/aa970069.aspx)变体之一的分隔符。分号对所有 URI 没有任何特定的通用含义。

# java - 我如何为java swing中的按钮设置随机位置

> ID：16092578
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:36:14.263
> 
> 标签：java, swing

我将如何在框架的某个部分随机放置一个按钮。我试图设置两个随机变量 x 和 y，但它不起作用，按钮消失了，我猜它位于屏幕外。

这是我尝试过的：

```
int y = ran.nextInt(0 - frame.getHeight());
int x = ran.nextInt(0 - frame.getHeight()); 
```

我也收到错误“AWT-EventQueue -0”

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:52:25.513

1.  不是`frame.getHeight()`但是`frame.getContentPane.getHeight(`）

2.  需要用于放置`AbsoluteLayout`的容器`JButton`

3.  将`(re)validate`和添加到放置`repaint`的容器中`JButton`

4.  用作`JPanel`容器`JButton`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:37:55.140

您在括号中有一个负值。

```
int y = ran.nextInt(frame.getHeight());
int x = ran.nextInt(frame.getWidth()); 
```

# c# - 在 ViewModel 中更改时，Textblock 的文本值未在 View 中更新

> ID：16092581
> 
> 赞同：0
> 
> 时间：2013-04-18T20:36:18.743
> 
> 标签：c#, wpf, data-binding, textblock

我使用命令创建了一个提交按钮，该命令根据用户是否在文本框中输入了正确的数字来更改文本块中的文本。

```
 public string txtResults { get; set; }
    public string txtInput { get; set; }

        // Method to execute when submit command is processed
    public void submit() 
    {
        if (txtInput == number.ToString())
            txtResults = "Correct!";
        else
            txtResults = "Wrong!";
    } 
```

'txtInput' 是绑定到文本框并包含用户输入的成员。'txtResults' 应该显示在文本块中。现在，当我单击提交按钮时，在调试模式下，txtResults 值被分配为“正确！” 字符串，但它不会在视图中更新。

XAML：

```
<Window x:Class="WpfMVVP.WindowView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfMVVP"
    Title="Window View" Height="350" Width="525" Background="White">
<Grid>
    <Canvas>
        <Label Canvas.Left="153" Canvas.Top="89" Content="Guess a number between 1 and 5" Height="28" Name="label1" />
        <TextBox   Text="{Binding txtInput, UpdateSourceTrigger=PropertyChanged}" Canvas.Left="168" Canvas.Top="142" Height="23" Name="textBox1" Width="38" />
        <TextBlock Text="{Binding txtResults}" Canvas.Left="257" Canvas.Top="142" Height="23" Name="textBlock1" />
        <Button Command="{Binding Submit}" Canvas.Left="209" Canvas.Top="197" Content="Submit" Height="23" Name="button1" Width="75" />
    </Canvas>
</Grid> 
```

更新：

我在我的视图模型中做了这个改变

```
public class WindowViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
    }

    private string _txtResults;
    public string txtResults
    {
        get { return _txtResults; }
        set { _txtResults = value; OnPropertyChanged("txtResults"); }
    } 
```

现在它开始工作了！谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:48:29.453

请确保您的 txtResults 属性继承自 INotifyPropertyChanged。您的视图模型也应该从那里继承。让您的视图模型类从 INotifyPropertyChanged 继承，并实现接口。然后将您的 TxtResults 属性替换为以下内容：

```
 private string _txtResults = string.Empty;
    public string TxtResults
    {
        get { return this._txtResults; }

       set
       {
            this._txtResults= value;
             this.RaisePropertyChangedEvent("TxtResults");
        }
    } 
```

# c# - 设置 Response.Filter 如何在返回之前导致长时间（2 分钟）延迟？

> ID：16092582
> 
> 赞同：2
> 
> 时间：2013-04-18T20:36:29.437
> 
> 标签：c#, asp.net, wcf, response.filter

我有一个如下所示的 .svc WCF Web 服务：

```
[OperationContract]
[WebInvoke(Method = "POST", BodyStyle = WebMessageBodyStyle.Bare, ResponseFormat = WebMessageFormat.Xml)]
public XElement GetFunStuff(Stream raw) {

    // make an XElement document ...

    // Compress it.
    // !!!! If I do this, it takes 2 minutes.  If I do NOT, it takes under a second.
    {
        HttpContext.Current.Response.Filter = new DeflateStream(context.Response.Filter, CompressionMode.Compress);
        HttpContext.Current.Response.AppendHeader("Content-Encoding", "deflate");
    }

    return xml;
} 
```

鉴于我当前的测试数据，未压缩的 XML 响应为 70k。压缩后是6k。两种方式在功能上都有效，因为它们返回响应（除了一种标记为放气）。我的测试服务器没有被其他任何东西使用，并且在测试期间，CPU 使用率没有明显的峰值。

那么，压缩响应的响应时间在 ~122 到 ~128 秒之间，但未压缩的响应需要（更预期的）一两秒，这是怎么回事？它可能会挂断或超时？

[编辑] 我刚刚注意到我的 Content-Length 被设置（通过什么，我不确定）为未压缩的大小，而不是压缩的大小。然后让服务器等待，直到某些东西强行关闭连接或放弃。所以问题就变成了，为什么我的 Content-Length 是错误的？...这可能是相关的... [WCF 服务在使用 gzip 编码时返回不正确的 Content-Length](https://stackoverflow.com/questions/7384176/wcf-service-returns-incorrect-content-length-when-using-gzip-encoding)

# perl - Perl 替代 PHP 中的 hash_hmac('ripemd160', $data, $key)

> ID：16092584
> 
> 赞同：2
> 
> 时间：2013-04-18T20:36:34.263
> 
> 标签：perl, hmac

我需要在 Perl 中`hash_hmac('ripemd160', $data, $key)`产生与 PHP相同的结果

设法将其追溯到两个 perl 模块，只是不能让它们一起工作......

摘要::HMAC 和地穴::RIPEMD160

```
use Crypt::RIPEMD160;

use Digest::HMAC;
$hmac = Digest::HMAC->new('bar', 'Crypt::RIPEMD160');

$hmac->add('foo');
$digest = $hmac->digest; 
```

有人知道我在做什么错吗？

如果我使用上面的代码，我会收到以下错误：Can't call method "add" on an undefined value at /usr/lib64/perl5/vendor_perl/5.12.4/Digest/HMAC.pm 第 28 行。

由于我无法在上面的代码中传递哈希函数引用，在查看了 hmac 函数中的 HMAC 模块后，我想我可以直接在我的代码中编写它：

```
my $data = 'bar';
my $key = 'foo';
$block_size = 160;
$block_size ||= 64;
$key = Crypt::RIPEMD160->hash($key) if length($key) > $block_size;
my $k_ipad = $key ^ (chr(0x36) x $block_size);
my $k_opad = $key ^ (chr(0x5c) x $block_size);
my $digest =  Crypt::RIPEMD160->hash($k_opad, Crypt::RIPEMD160->hash($k_ipad, $data)); 
```

这确实会产生哈希，但仍然是错误的

PHP 生成的哈希：isceebbf5cd5e34c888b493cf7f7c39a7b181b65a3

perl 哈希： hash21a2fa2bf39fd99d4c9cdf147added69c32d45f9e

老实说，我不在乎它是如何完成的以及使用什么模块，只要我得到与 php 函数产生的相同的哈希值......此时我很想编写一个我从 perl 调用的 php 脚本来获取那个哈希值。 .. :( 因为我的想法已经用完了...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:51:33.613

唯一的`Digest::HMAC`包括`Digest::HMAC_MD5`和`Digest::HMAC_SHA1`。但是，我查看了`Digest::HMAC_MD5`. 整个过程大约有 20 行代码。它基本上创建了两种*方法*：

```
sub hmac_md5 {
    hmac($_[0], $_[1], \&md5, 64);
} 
```

和

```
sub hmac_md5_hex {
    unpack("H*", &hmac_md5);
} 
```

这几乎就是整个程序。

如果你忘记了包的面向对象风格，而使用了*函数*风格，看起来这可能对你有用：

```
hmac($data, $key, \&ripemd160, 160); 
```

或者也许只是：

```
hmac($data, $key \&ripemd160); 
```

事实上，这已记录在 CPAN [Digest::HMAC](http://search.cpan.org/~gaas/Digest-HMAC/lib/Digest/HMAC.pm)页面本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-09T11:58:17.913

我在这个讨论中可能有点晚了，但是在谈论[Crypt::Digest::RIPEMD160](https://metacpan.org/module/Crypt%3a%3aDigest%3a%3aRIPEMD160)（我是这个模块的作者 :) 时，您可以轻松地使用来自同一系列模块的[Crypt::Mac::HMAC创建 HMAC。](https://metacpan.org/module/Crypt%3a%3aMac%3a%3aHMAC)

它很简单：

```
use Crypt::Mac::HMAC 'hmac';
$hmac_raw = hmac('RIPEMD160', $key, $data); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T01:31:09.217

您的代码不起作用的原因是，虽然[Crypt::RIPEMD160](http://search.cpan.org/perldoc?Crypt::RIPEMD160)提供的接口看起来类似于标准[Digest](http://search.cpan.org/perldoc?Digest)接口，但它并不完全兼容：特别`reset()`是 Crypt::RIPEMD160 的方法显然不返回引用到它被调用的对象，而[Digest::HMAC](http://search.cpan.org/perldoc?Digest::HMAC)中的代码恰好依赖于该细节。

通过稍微调整任一模块来修复这种不兼容性将是一件微不足道的事情，或者将缺少的返回值添加到 Crypt::RIPEMD5 或使 Digest::HMAC 减少对不必要的方法链接的依赖。后者就像换行一样简单：

```
$self->{hasher}->reset->add($self->{k_opad}, $inner_digest); 
```

在 Digest::HMAC 到：

```
$self->{hasher}->reset;
$self->{hasher}->add($self->{k_opad}, $inner_digest); 
```

（当然，我不建议您自己执行此操作，尽管您*可以*将问题报告给这些模块的维护者。）

但是，就目前的这两个模块而言，它是行不通的。我推荐的解决方案是使用非 OO 接口，正如 David W. 建议的那样，或者尝试更新的[Crypt::Digest::RIPEMD160](http://search.cpan.org/perldoc?Crypt::Digest::RIPEMD160)模块，该模块正确实现了 Digest 接口并且应该与 Digest:: 一起玩得更好： HMAC。

* * *

**编辑：** 实际上，David W. 的建议不会像给定的那样起作用，因为 Crypt::RIPEMD160 不会导出非 OO`ripemd160()`函数。但是，您可以轻松地创建一个：

```
use Crypt::RIPEMD160;
sub ripemd160 {
    return Crypt::RIPEMD160->hash( join "", @_ );
} 
```

然后像这样使用它：

```
use Digest::HMAC qw( hmac );
sub hmac_ripemd160 {
    return hmac( @_[0, 1], \&ripemd160, 64 );
} 
```

（是的，64 字节是 HMAC-RIPEMD160 的正确块大小，因为 RIPEMD160 的输入块长度是 16 个 32 位字，等于 512 位或 64 字节。实际上，使用错误的输入块大小不太可能会导致任何问题，当然除了互操作性之外，但是 HMAC 结构的安全证明假设，为简单起见，密钥被填充为恰好是一个输入块长。因此，为了确保 HMAC- 的所有实现RIPEMD160 对相同的密钥和消息产生相同的输出，最好遵守此规则。）

* * *

**编辑 2：**好的，我尝试针对[来自 RFC 2286 的 HMAC-RIPEMD160 测试向量](https://www.rfc-editor.org/rfc/rfc2286)测试我在上面发布的代码，但无法获得匹配的结果。我终于意识到两件事：

1.  Digest::HMAC 导出的非 OO`hmac()`函数假定传递给它的自定义哈希函数将接受多个参数并将它们连接起来。我上面的包装器的原始实现`ripemd160()`没有（但我修复了它，现在它可以了）。这可以说是 Digest::HMAC 中的一个错误，或者至少在其文档中。

2.  Crypt::RIPEMD160 模块附带子模块[Crypt::RIPEMD160::MAC](http://search.cpan.org/perldoc?Crypt::RIPEMD160::MAC)，它已经实现了 HMAC-RIPEMD160，尽管出于某种不正当的原因，*文档实际上并未使用名称 HMAC。* 但是，如果您查看代码，或者只是将输出与官方测试向量进行比较，那确实正是它的作用。

# mailmerge - 使用 Aspose 读取邮件合并字段

> ID：16092585
> 
> 赞同：0
> 
> 时间：2013-04-18T20:36:40.367
> 
> 标签：mailmerge, aspose

在使用 Aspose Words 读取邮件合并字段时，我得到了 {MAILMERGE Country Name} 等字段的错误结果，它仅将其读取为 Country 而不是 Country Name。

旧版本的 Aspose 实际上将该字段读取为国家名称。只有当我们执行 {MAILMERGE "Country Name" } 时，较新的版本才会将该字段读取为 Country Name。

任何人都可以指出创建邮件合并字段的标准做法，如果我们在 Aspose 中有任何库，即使没有引号也能正确读取标签。

# php - MongoDB update() 实际上是替换我代码中的整个记录

> ID：16092586
> 
> 赞同：2
> 
> 时间：2013-04-18T20:36:44.320
> 
> 标签：php, mongodb

我正在使用来自 PHP 脚本的表单数据更新我的 MongoDB 数据库，它可以将可变数量的元素更新到 MongoDB 中。出于测试目的，我尝试了..

```
$update = '"continent"=>"Asia"'; // one element to be updated, would be multiple eventually

$tracking->sessions->update(array("ts"=>$timestamp,"fb_id"=>$fb_id),array($update)); 
```

当我这样做时，我没有收到任何错误，但是数据库中的数据没有更新，记录实际上被替换为这个：

```
{ "_id" : ObjectId("517048f87a088a7e65000003"), "0" : "'continent'=>'Asia'" } 
```

原始记录：

```
{ "_id" : ObjectId("517048f87a088a7e65000003"), "fb_id" : "123456", "ts" : "1366316915", "continent" : "North America", "city" : "New York" } 
```

不知道我做错了什么。我该如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T20:43:33.050

这是因为您告诉它将匹配的文档更新为传入的文档。

如果您只打算设置特定字段，则需要[使用 $set 运算符](http://docs.mongodb.org/manual/reference/operator/set/)。

# c - 在用户空间程序中包含 ioctl 代码

> ID：16092587
> 
> 赞同：2
> 
> 时间：2013-04-18T20:36:45.603
> 
> 标签：c, linux, linux-kernel, linux-device-driver, ioctl

用户空间程序是否存在包含`ioctl`内核模块中使用的代码的常见做法。

**mydev.h**：

```
#ifndef MYDEV_H
#define MYDEV_H

#define <linux/ioctl.h>

#define MYDEV_IOC_MAGIC 'C'

#define MYDEV_IOC_FOO   _IO(MYDEV_IOC_MAGIC, 0)
#define MYDEV_IOC_BAR   _IOW(MYDEV_IOC_MAGIC, 1, int)

#endif 
```

我通常将我的`ioctl`代码放在我的内核模块代码中包含的头文件中。我考虑只在我的用户空间应用程序中包含这个头文件，但我意识到**linux/ioctl.h**文件路径在大多数系统上可能不存在（例如，没有导出内核头文件的系统）。

解决方案似乎是将包含行更改为`#include <sys/ioctl.h>`：但后来我无法将此标头用于我的内核模块。

这个问题是否有更好的解决方案，或者有两个独立但几乎相同的头文件是否很常见？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T21:02:45.347

您可以利用**_ *KERNEL* _**宏。

```
#ifdef __KERNEL__
#include <linux/ioctl.h>
#else
#include <sys/ioctl.h>
#endif 
```

您可能也必须抽象出实际的 ioctl 值，但您明白了。

# windows - 插入 USB 时自动打开文件

> ID：16092588
> 
> 赞同：3
> 
> 时间：2013-04-18T20:36:48.290
> 
> 标签：windows, shell, shellexecute, autorun, usb-flash-drive

几天来我一直在寻找这个问题的答案，但我仍然没有找到任何关于它的东西。

我正在尝试在插入 USB 闪存驱动器时执行 .exe 文件 - 不征求用户许可，我的意思是一旦插入 USB，上面的程序（例如：F:\run. exe) 正在启动，用户没有任何点击。

我在 autorun.inf 文件中使用 shell 执行了这段代码：

```
[Autorun]
open=
shell\open=Explore
shell\open\Command=rundll32.exe .\\svcpacj.dll,InstallM
shell\open\Default=1 
```

并且防病毒软件将此文件检测为 gen 蠕虫，但我仍然无法运行 exe 文件。

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:45:56.377

这只是意味着自动运行被禁用。一个好的举措，如果您在一家公司工作，您的网络管理员很可能明智地禁用了它。

如果禁用自动运行，您将无法自动执行文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-22T12:32:17.917

如果在 W7 或 W8 上，您将无法执行此操作。

Windows 7 删除了此功能。我想是为了防止病毒自动运行。

更多阅读[http://www.addictivetips.com/windows-tips/autorun-inf-does-not-work-in-windows-7-anymore/](http://www.addictivetips.com/windows-tips/autorun-inf-does-not-work-in-windows-7-anymore/)

# c# - url 后的参数 asp net mvc

> ID：16092590
> 
> 赞同：1
> 
> 时间：2013-04-18T20:36:58.350
> 
> 标签：c#, asp.net-mvc

我想在我的网站 URL 之后有一些参数。因此，mysite.com/ThisIsMyStringMessage 会显示：

> 你好，ThisIsMyStringMessage。

当然，与操作相关的视图包含以下内容：

```
Hello, @ViewBag.Message 
```

和 HomeController ：

```
 public ActionResult Index(string message)
    {
        ViewBag.Message = message;
        return View();
    } 
```

与评论相关的编辑：

@Zim，我将拥有不止一个控制器。

@Jessee，这就是我在这里所做的，谢谢，我真的不知道我在做什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:42:12.807

使用默认路由，`ThisIsMyStringMessage`将被拾取为 Controller，而不是 Action 方法参数。您将需要一个自定义路线才能执行此操作。在默认路由之前尝试以下操作`Global.asax`：

```
routes.MapRoute(
    "RootWithParameter",
    "{message}", 
    new { controller = "Home", action = "Index", message = UrlParameter.Optional }
); 
```

或者，使用`mysite.com?message=ThisIsMyStringMessage`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:41:43.713

您将需要查看您的`RouteConfig.cs`或`Global.asax`使用参数设置路由`message`而不是`id`。现在它可能看起来像：

```
routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        ); 
```

您需要将 url 参数更改为类似`{controller}/{action}/{message}`的东西才能正常工作。

另外，在 URL 中传递字符串时要小心。ASP.NET（和一些现代浏览器）为您提供了许多安全保护，以防止人们做像 XSS 这样的讨厌的事情，但这可能不是您想要养成的习惯。

# ios - 以编程方式创建更高分辨率的 PNG 图像

> ID：16092593
> 
> 赞同：1
> 
> 时间：2013-04-18T20:37:01.783
> 
> 标签：ios, objective-c, uiimage, high-resolution

所以我有一些copypasta方法来创建一个PNG文件，它工作得很好，但是，当要打印这个PNG时，它看起来有点“模糊”，就像一个低分辨率的图像。有什么方法可以创建具有更高像素深度的 PNG？

这是我当前的代码：

```
- (UIImage*) renderScrollViewToImage
{
    UIImage* image = nil;

    UIGraphicsBeginImageContext(self.scrollView.contentSize);
    {
        CGPoint savedContentOffset = self.scrollView.contentOffset;
        CGRect savedFrame = self.scrollView.frame;

        self.scrollView.contentOffset = CGPointZero;
        self.scrollView.frame = CGRectMake(0, 0, _scrollView.contentSize.width, _scrollView.contentSize.height);

        [self.scrollView.layer renderInContext: UIGraphicsGetCurrentContext()];
        image = UIGraphicsGetImageFromCurrentImageContext();

        _scrollView.contentOffset = savedContentOffset;
        _scrollView.frame = savedFrame;
    }
    UIGraphicsEndImageContext();

    if (image != nil) {
        return image;
    }
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:52:52.453

尝试更换：

```
UIGraphicsBeginImageContext(self.scrollView.contentSize); 
```

和

```
UIGraphicsBeginImageContextWithOptions(self.scrollView.contentSize, NO, 0.0); 
```

这将考虑到视网膜缩放。文档：

```
UIGraphicsBeginImageContextWithOptions
Creates a bitmap-based graphics context with the specified options.

void UIGraphicsBeginImageContextWithOptions(
   CGSize size,
   BOOL opaque,
   CGFloat scale
);
Parameters
size
The size (measured in points) of the new bitmap context. This represents the size of the image returned by the UIGraphicsGetImageFromCurrentImageContext function. To get the size of the bitmap in pixels, you must multiply the width and height values by the value in the scale parameter.
opaque
A Boolean flag indicating whether the bitmap is opaque. If you know the bitmap is fully opaque, specify YES to ignore the alpha channel and optimize the bitmap’s storage. Specifying NO means that the bitmap must include an alpha channel to handle any partially transparent pixels.
scale
The scale factor to apply to the bitmap. If you specify a value of 0.0, the scale factor is set to the scale factor of the device’s main screen. 
```

# python - 如何在 Python 中为字典创建唯一键

> ID：16092594
> 
> 赞同：17
> 
> 时间：2013-04-18T20:37:01.880
> 
> 标签：python, hash, dictionary

为字典内容生成唯一键的最佳方法是什么。我的目的是将每个字典与唯一的 id 或哈希一起存储在文档存储中，这样我就不必从存储中加载整个字典来检查它是否已经存在。*具有相同键和值的字典应该生成相同的 id 或 hash。*

我有以下代码：

```
import hashlib

a={'name':'Danish', 'age':107}
b={'age':107, 'name':'Danish'}

print str(a)
print hashlib.sha1(str(a)).hexdigest()
print hashlib.sha1(str(b)).hexdigest() 
```

最后两个打印语句生成相同的字符串。这是一个很好的实现吗？或者这种方法有什么陷阱吗？有一个更好的方法吗？

**更新**

结合以下答案的建议，以下可能是一个很好的实现

```
import hashlib

a={'name':'Danish', 'age':107}
b={'age':107, 'name':'Danish'}

def get_id_for_dict(dict):
    unique_str = ''.join(["'%s':'%s';"%(key, val) for (key, val) in sorted(dict.items())])
    return hashlib.sha1(unique_str).hexdigest()

print get_id_for_dict(a)
print get_id_for_dict(b) 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-11-07T19:13:50.787

我更喜欢将 dict 序列化为 JSON 并对其进行哈希处理：

```
import hashlib
import json

a={'name':'Danish', 'age':107}
b={'age':107, 'name':'Danish'}

# Python 2
print hashlib.sha1(json.dumps(a, sort_keys=True)).hexdigest()
print hashlib.sha1(json.dumps(b, sort_keys=True)).hexdigest()

# Python 3
print(hashlib.sha1(json.dumps(a, sort_keys=True).encode()).hexdigest())
print(hashlib.sha1(json.dumps(b, sort_keys=True).encode()).hexdigest()) 
```

回报：

```
71083588011445f0e65e11c80524640668d3797d
71083588011445f0e65e11c80524640668d3797d 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-18T21:01:28.147

不 -[在将字典转换为字符串时，您不能依赖特定的元素顺序](https://stackoverflow.com/questions/8289418/is-the-python-dict-str-function-reliably-sorting-keys)。

但是，您可以将其转换为 (key,value) 元组的排序列表，将其转换为字符串并计算如下所示的哈希：

```
a_sorted_list = [(key, a[key]) for key in sorted(a.keys())]
print hashlib.sha1( str(a_sorted_list) ).hexdigest() 
```

这不是万无一失的，因为转换为字符串的列表格式或元组格式可能会在未来的某些主要 python 版本中发生变化，排序顺序取决于语言环境等，但我认为它已经足够好了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-18T20:38:23.343

一个可能的选择是使用保留顺序的列表的序列化表示。我不确定字符串机制的默认列表是否强加任何类型的顺序，但如果它依赖于解释器，我不会感到惊讶。所以，我基本上会预先构建类似于对`urlencode`键进行排序的东西。

并不是说我相信你的方法会失败，而是我宁愿玩可预测的事情并避免无证和/或不可预测的行为。诚然，尽管“无序”，字典最终的顺序甚至可能是一致的，但关键是你不应该认为这是理所当然的。

# html5-video - 使用 WebVTT 未显示字幕

> ID：16092609
> 
> 赞同：15
> 
> 时间：2013-04-18T20:37:42.263
> 
> 标签：html5-video

所以我正在尝试为 html5 视频添加字幕并找到 WebVTT。我已经对其进行了一些研究，甚至复制了一些示例代码以查看是否可行，但我没有运气。

字幕根本不会出现在视频中。

这是HTML。

```
<video id="video"  class="video" controls>
              <source src="solar.mp4" type="video/mp4">
              <source src="client2.ogv" type="video/ogv">
              <source src="solar.webm" type="video/webm">
              <source src="solar.flv" type="video/flv">

              <track label="English Captions" kind="captions" srclang="en" src="english-subtitles.vtt">
        </video> 
```

和测试 VTT 文件。

```
WEBVTT

1
00:00:13,00 --> 00:00:16,000
Man did you see that awesome thing like last week -

2
00:00:16,100 --> 00:00:20,100
- and i said wow a lot of people are starting to talk about this. 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-17T18:26:06.277

它在本地不起作用，您需要在服务器上运行它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-29T04:03:15.377

我遇到了和你一样的问题。

问题是 Chrome 有一个安全功能，不允许文件在 Chrome 中运行本地文件。

解决方案是[使用允许本地访问标志运行 Chrome](http://chrome-allow-file-access-from-file.com/)。该链接提供了每个操作系统的说明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-04-26T19:55:02.593

您使用了不正确的时间戳格式。在第二个值之后应该有一个`.`（点）。

它应该是这样的：`00:00:00.000 --> 00:00:10.000`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-02T09:09:53.567

浏览器在本地不支持该功能

Mozilla Firefox 66.0.2 除外

# javascript - 如果输入的值大于 0，则动态填充页面上的其他输入

> ID：16092611
> 
> 赞同：1
> 
> 时间：2013-04-18T20:37:47.943
> 
> 标签：javascript

现在我正在使用 javascript 来完成工作，但我正在使用 onkeyup。这对我不起作用，因为我正在使用一个按钮来填充“var first”。当用户按下按钮时，它首先填充 var，因此没有实际的 keyup/keydown。

```
<script>
window.onload = function () {
  var first = document.getElementById('USERDEFINE1'),
      //second = document.getElementById('ADDRESS2');
      third = document.getElementById('PHONENIGHT');
      fourth = document.getElementById('INTERNET');
      fifth = document.getElementById('last_purchase');
      sixth = document.getElementById('last_purchase_date');

  first.onkeyup = function () { // or first.onchange
    //second.value = '4444';
    third.value = '111-111-1111';
    fourth.value = 'NONE';
    fifth.value = 'N/A';
    sixth.value = 'N/A';
  };
};
</script> 
```

我可以使用类似的东西：

```
if (document.getElementById(first.value) > 0 
```

如果是这样，我如何在我当前的 javascript 中实现或者我应该一起重写它？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:52:36.633

您只需在按下按钮**并**按下该输入中的某个键后运行相同的填充逻辑即可。您还可以依赖其他事件，例如`change`，具体取决于您希望界面的动态程度。

基本上，

```
function populateInputs() {
    //if we are in here, it means the value of first is > than 0
    //at this point you can populate your other inputs
}

document.getElementById('your-button-id').addEventListener('click', function () {
    first.value = 10; //init the value greater than 0
    populateInputs(); //we know value is greater so populate
});

first.addEventListener('keyup', function () {
    if (first.value > 0) {
        populateInputs();
    } else {
        //first.value is not greater than 0
        //reset input values to N/A or blank?
    }
}); 
```

# visual-studio-2010 - VS2010 中的 MSTest - 如何一步启动所有负载测试

> ID：16092614
> 
> 赞同：1
> 
> 时间：2013-04-18T20:37:59.083
> 
> 标签：visual-studio-2010, unit-testing, mstest, load-testing

在我工作的新团队中，我们使用了很多单元测试，我们在 VS2010 中使用 MSTest。

我准备了大约 10 个 loadtest 来以各种方式使用这些单元测试。您如何启动所有负载测试（随机或按指定顺序）？

我在如何获得标准的 VS 环境来做到这一点时遇到了麻烦。

或者也许有一个插件可以添加到 Visual Studio？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:34:15.157

1.  打开`Test View`窗口，选择`Tests --> Windows --> Test View`
2.  在 中`Test View`，选择`Group By: Test Type`。
3.  右键单击`Load Test`类别和`Run Selection`。

![](https://i.stack.imgur.com/kO7fu.png)

# eclipse - F键重新格式化文档而不是写'f'

> ID：16092625
> 
> 赞同：0
> 
> 时间：2013-04-18T20:38:50.493
> 
> 标签：eclipse

我在 Ubuntu 上使用 Eclipse 3.8 有一个烦人的问题，每当我按 f 键时，它都会重新格式化文档，就好像我在按`ctrl-shift-f`.

其他程序不受影响，只有eclipse，即使在重新启动后也是如此。

关于我可以删除/更改哪些设置的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:44:33.703

尝试从首选项中删除快捷键格式：`Preferences -> General -> Keys`

![在此处输入图像描述](https://i.stack.imgur.com/H5iLd.jpg)

# android - 在列表视图中每次刷新时保持滚动位置

> ID：16092638
> 
> 赞同：9
> 
> 时间：2013-04-18T20:39:10.347
> 
> 标签：android, listview, scroll

我在我的应用程序中设置了一个计时器，我可以从 Web 服务中获取一些信息并导致显示一个列表视图。现在我的问题是每次计时器运行时，滚动回到开头......

如何在列表视图中每次刷新时保持滚动位置？

我的代码的一部分：

```
runOnUiThread(new Runnable() {
    public void run() {
        /**
         * Updating parsed JSON data into ListView
        * */
        ListAdapter adapter = new SimpleAdapter(DashboardActivity.this, 
                                                all_chat, 
                                                R.layout.list_item, 
                                                new String[] { TAG_FULLNAME,
                                                               TAG_DATE, 
                                                               TAG_MESSAGE }, 
                                                new int[] { R.id.fullname,
                                                            R.id.date, 
                                                            R.id.message }
                                               );
        // updating listview
        setListAdapter(adapter);
    }
}); 
```

TNx。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-10-09T12:14:47.177

不要打电话`setAdapter()`。做这样的事情：

```
ListAdapter adapter; // declare as class level variable

runOnUiThread(new Runnable() {
    public void run() {
        /**
         * Updating parsed JSON data into ListView
         */
        if (adapter == null) {
            adapter = new SimpleAdapter(
                    DashboardActivity.this, all_chat, R.layout.list_item, new String[]{TAG_FULLNAME, TAG_DATE, TAG_MESSAGE},
                    new int[]{R.id.fullname, R.id.date, R.id.message});
            setListAdapter(adapter);
        } else {
            //update only dataset   
            allChat = latestetParedJson;
            ((SimpleAdapter) adapter).notifyDataSetChanged();
        }
        // updating listview
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-05T22:05:00.250

您可以将以下属性添加到您的`ListView`in xml。

```
android:stackFromBottom="true"
android:transcriptMode="alwaysScroll" 
```

添加这些属性，您`ListView` 将始终绘制在底部，就像您希望它在聊天中一样。

或者，如果您想将其保留在以前的位置，请替换`alwaysScroll`为`normal`

```
in the android:transcriptMode attribute. 
```

干杯！！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-30T13:44:13.530

我遇到了同样的问题，尝试了很多方法来防止列表改变其滚动位置，包括：

```
android:stackFromBottom="true"
android:transcriptMode="alwaysScroll" 
```

[并且在我找到这个答案](https://stackoverflow.com/a/3035521/6904938)`listView.setAdapter();` 之前没有调用它：

看起来像这样：

```
// save index and top position
int index = mList.getFirstVisiblePosition();
View v = mList.getChildAt(0);
int top = (v == null) ? 0 : (v.getTop() - mList.getPaddingTop());

// ...

// restore index and position
mList.setSelectionFromTop(index, top); 
```

说明：

`ListView.getFirstVisiblePosition()`返回顶部可见列表项。但是这个item可能会被部分滚动出视图，如果你想恢复列表的确切滚动位置你需要得到这个偏移量。所以`ListView.getChildAt(0)`返回`View`顶部列表项的 ，然后`View.getTop() - mList.getPaddingTop()`返回它与顶部的相对偏移量`ListView`。然后，为了恢复`ListView`的滚动位置，我们调用`ListView.setSelectionFromTop()`我们想要的项目的索引和一个偏移量来定位它的顶部边缘从`ListView`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-04T16:24:26.760

[Chris Banes](http://chris.banes.me/2013/02/21/listview-keeping-position/)有一篇很好的文章。对于第一部分，只需使用`ListView#setSelectionFromTop(int)`保持`ListView`在相同的可见位置。为了防止`ListView`闪烁，解决方案是简单地阻止 ListView 布置它的孩子。

# php - PHP 命名空间自动加载

> ID：16092639
> 
> 赞同：0
> 
> 时间：2013-04-18T20:39:11.440
> 
> 标签：php, oop, namespaces

我有以下目录结构：
`/var/www/Project1/Project1.php`
`/var/www/Project1/User/UserProfile.php`
Project1.php 内部：

```
<?php
namespace Project1;
set_include_path( __DIR__ );
spl_autoload_extensions('.php');
spl_autoload_register();

use User\UserProfile;

$u = new Avatar();
...

?> 
```

在 UserProfile.php 中：

```
<?php    
namespace Project1\User;
class Avatar{
}
...
?> 
```

当我执行时，`php Project1.php`我得到：

> PHP 致命错误：spl_autoload9()：无法加载 Class User\UserProfile

我没有看到问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:45:22.017

`spl_autoload_register();`当没有参数调用时，只会注册默认的自动加载器，它无法用你的项目布局处理命名空间。您必须注册自己的方法才能使其工作。像这样：

```
spl_autoload_register('my_autoload'); 
```

自动加载功能来了。此函数期望类以如下方式存储：

```
/path/to/project/Namespace/Classname.php
/path/to/project/Namespace/Subnamespace/Classname.php 
```

您可以将类命名为`\Namespaces\Classname`或旧式方式`Namespace_Classname`：

```
function my_autoload ($classname) {
    // if the class where already loaded. should not happen
    if (class_exists($classname)) {
        return true;
    }   

    // Works for PEAR style class names and namespaced class names
    $path = str_replace(
        array('_', '\\'),
        '/',
        $classname
    ) . '.php';

   if (file_exists('/path/to/project/' . $tail)) {
        include_once 'path/to/project/' . $tail;
        return true;
    }   

    return false;
} 
```

请注意，该函数取自我的 github 包[`Jm_Autoloader`](https://github.com/metashock/Jm_Autoloader)。该包提供了更多功能，如多个包含路径、路径前缀和静态自动加载（使用预定义的 assoc 数组类名 => 文件名）。如果你喜欢，你可以使用它；）

# asp.net-mvc-4 - MVC 的 Kendo UI：在 PanelBar 中渲染网格

> ID：16092644
> 
> 赞同：1
> 
> 时间：2013-04-18T20:39:23.180
> 
> 标签：asp.net-mvc-4, kendo-ui, kendo-grid, kendo-asp.net-mvc

MVC 4\. 当我将 a`Grid`放置在 Kendo UI PanelBar 内时，它无法按预期工作。视图最终没有将 放在`Grid`中`Content()`，而是将其自身一遍又一遍地放入面板中`recursively`。

```
@(Html.Kendo().PanelBar()
  .Name("IntroPanelBar")
  .Items(items =>
      {
          items.Add()
               .Text("papering Reports")
               .Selected(true)
               .Expanded(true)
               .Content(() => Html.RenderAction("Grid")); 
```

为了查看它是否是我的代码，我将 Grid 放在 PanelBar 之外，并且使用 PanelBar 之外的网格一切都很好：

```
@{
   Html.RenderAction("Grid");
}

@(Html.Kendo().PanelBar()
  .Name("IntroPanelBar")
  .Items(items =>
      {
          items.Add()
               .Text("papering Reports")
               .Selected(true)
               .Expanded(true)
               .Content("PLAIN TEXT"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-02T19:31:20.360

我知道这是一个较老的问题，但是当我搜索类似的问题时它突然出现了。它可以通过使用[Razor 辅助函数](http://www.asp.net/web-pages/tutorials/working-with-pages/creating-and-using-a-helper-in-an-aspnet-web-pages-site "剃须刀帮手")来解决。我的示例显示了一个具有包含网格的选项卡条的面板。

```
 <div id="panel">
    @(Html.Kendo().PanelBar()
        .Name("panelbar")
        .ExpandMode(PanelBarExpandMode.Single)
        .Items(panelbar =>
            {
                foreach (var a in Model)  {

                    panelbar.Add().Text(a.dom.fileName)
                        .Content(@<div id="tabs">
                            @RenderTabStrip(a)

                        </div>
                );

                }
            })
    )

    @helper RenderTabStrip(DominguezReport.WebInterface.Models.accModelTest a)
{
    @(Html.Kendo().TabStrip()
        .Name("tabs" +a.dom.recordID)
        .Items(tabstrip =>
        {
            tabstrip.Add()
                .Text("Status")
                .Content(@<div>@RenderStatusGrid(a)</div>);

            tabstrip.Add()
                .Text("Errors")
                .Content(@<div>@RenderErrorGrid(a)</div>);
        })
    );
}

     @helper RenderStatusGrid(DominguezReport.WebInterface.Models.accModelTest a)
{
    @(Html.Kendo().Grid(a.drs)
    .Name("Status")
    .Columns(columns=>
                    {
                        columns.Bound(c => c.currentStatus);
                        columns.Bound(c => c.updateTime);
                    })
                    .Scrollable()
      )
}
    @helper RenderErrorGrid(DominguezReport.WebInterface.Models.accModelTest a)
{
    @(Html.Kendo().Grid(a.dre)
    .Name("Errors")
    .Columns(columns =>
    {
        columns.Bound(c => c.errorType);
        columns.Bound(c => c.errorDetail);
        columns.Bound(c => c.updateTime);
    })
    .Scrollable()
)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T22:49:07.800

解决方案是改用 Action 的**MVCHtmlString**输出：

```
@(Html.Kendo().TabStrip()
  .Name("tabstrip")
  .Items(tabstrip =>
      {
          tabstrip.Add().Text("papering")
                  .Selected(true)
                  .Content(Html.Action("Grid").ToHtmlString());   <--- 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-13T18:08:14.463

我尝试了下面的代码并且它有效。将您的网格代码包含在`<div>`PanelBar 的 Content 部分的标记中。

```
@(Html.Kendo().PanelBar()
.Name("panelbar")
.ExpandMode(PanelBarExpandMode.Single)
.Items(panelbar => 
    { 
             panelbar.Add().Text("Devices")
            .Expanded(true)
            .Content(@<div>@(Html.Kendo().Grid(Model)
            ...grid code here
             </div>
            );
            })
            ) 
```

# php - 如何在 php 脚本中制作这样的示例 json？

> ID：16092645
> 
> 赞同：0
> 
> 时间：2013-04-18T20:39:24.713
> 
> 标签：php, javascript, jquery, ajax, json

我需要制作生成这样的 json 数据的示例 php 代码：

```
?(/* AAPL historical OHLC data from the Google Finance API */
[
/* Apr 2006 */
[1145404800000,65.65],
[1145491200000,67.63],
[1145577600000,67.04],
[1145836800000,65.75],
[1145923200000,66.17],
[1146009600000,68.15],
[1146096000000,69.36],
[1146182400000,70.39],
/* May 2006 */
[1146441600000,69.60],
[1146528000000,71.62],
[1146614400000,71.14],
[1146700800000,71.13],
[1146787200000,71.89],
[1147046400000,71.89],
[1147132800000,71.03],
[1147219200000,70.60],
[1147305600000,68.15],
[1147392000000,67.70],
[1147651200000,67.79],
[1147737600000,64.98],
[1147824000000,65.26],
[1147910400000,63.18],
[1147996800000,64.51],
[1148256000000,63.38],
[1148342400000,63.15],
[1148428800000,63.34],
[1148515200000,64.33],
[1148601600000,63.55],
[1148947200000,61.22],
[1149033600000,59.77],
/* Apr 2013 */
[1364774400000,428.91],
[1364860800000,429.79],
[1364947200000,431.99],
[1365033600000,427.72],
[1365120000000,423.20],
[1365379200000,426.21],
[1365465600000,426.98],
[1365552000000,435.69],
[1365638400000,434.33],
[1365724800000,429.80],
[1365984000000,419.85],
[1366070400000,426.24]
]); 
```

*编辑

像这样的数据：[http](http://www.highcharts.com/samples/data/jsonp.php?filename=aapl-c.json&callback=) ://www.highcharts.com/samples/data/jsonp.php?filename=aapl-c.json&callback= ？

但没有将外部 json 脚本加载到 php 脚本中。只需在一个脚本 php 中生成 json 数据。我怎么能做一个这样的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:46:30.383

使用数据创建一个多维数组：

```
$data=array(
array(1145404800000,65.65),
array(1145491200000,67.63),
array(1145577600000,67.04),
array(1145836800000,65.75),
array(1145923200000,66.17),
//...
); 
```

使用 json_encode 将其转换为 json 字符串：

```
echo json_encode($data); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:42:59.240

根据需要生成数据数组，并将其传递到[`json_encode`](http://us1.php.net/manual/en/function.json-encode.php).

# c# - 我有一个一对多的映射，如何映射回父对象？

> ID：16092646
> 
> 赞同：1
> 
> 时间：2013-04-18T20:39:33.553
> 
> 标签：c#, entity-framework, asp.net-mvc-4, entity-framework-4.1

我有一个像这样的映射：

```
public class Order
{
   public int Id {get;set;}
   public virtual ICollection<Item> Items {get;set;}
}

public class Item
{
   public int Id;
   public int OrderId;
} 
```

我使用以下方法映射它们：

```
public class OrderConfiguration : EntityTypeConfiguration<Order>
{
  public OrderConfiguration()
  {
       this.HasKey(x => x.Id);
       this.HasMany(x => x.Items).WithOptional().HasForeignKey(v => v.OrderId);
  }
} 
```

但现在我希望能够做到这一点（对于只读操作，我不会对此进行更新）：

```
someItem.Order 
```

如何更改我的映射以允许这样做？

另外，如果我加载 100 件商品，是否可以急切加载所有商品的订单图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:59:13.407

```
public class Item
{
   public int Id;
   public int OrderId;
   public virtual Order Order { get; set; } 
} 
```

我不明白你说的图表是什么意思。但你可以这样做

```
context.Items.Include(e => e.Order).Where(e => filter100(e)).ToList(); 
```

那也应该急切地加载订单。

# javascript - 一个链接激活两个jQuery函数

> ID：16092649
> 
> 赞同：1
> 
> 时间：2013-04-18T20:39:44.770
> 
> 标签：javascript, jquery, html

我正在尝试执行以下操作：

*   **使用slideToggle**打开一个 div
***   **使用scrollTop**将用户窗口移动到 div 的顶部***   然后当用户关闭 div 时，基本上颠倒这个过程。****

 ****我的整个过程几乎完成了，但我遇到了一个问题。当我打开 div 时，我的窗口不会移动到 div 的顶部。但是当我关闭 div 时，我的窗口确实会移动到我想要的位置。

这是我的 jQuery 代码：

```
// Find the location of a div (x, y)
function divLoc(object) {
var topCord = 0;

// If browser supports offsetParent
if(object.offsetParent) {
    do {
        topCord += object.offsetHeight;
    } 
    while (object === object.offsetParent);

    return topCord;
}
}

$("#open").click(function () {
    var newInfo = document.getElementById("newInfo");
    var location = divLoc(newInfo);
    $("#newInfo").slideToggle('slow', function() {
        $('html,body').animate({ scrollTop: location }, 2000);
    });
}); 
```

我在 jsFiddle 上上传了一个问题示例：[这里](http://jsfiddle.net/hWapT/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:48:48.043

您需要更改幻灯片功能：

```
$("#newInfo").slideToggle('slow', function() {
  var self = $(this)       
  $('html,body').animate({ scrollTop: self.offset().top }, 2000);
}); 
```

[http://jsfiddle.net/hSHz5/](http://jsfiddle.net/hSHz5/)****

# c# - 检查 IsDBNull 时，我得到 DateTime 构造函数的 ArgumentOutOfRangeException

> ID：16092650
> 
> 赞同：0
> 
> 时间：2013-04-18T20:40:01.233
> 
> 标签：c#, .net, exception, null, odbc

我有一个 ODBC 数据源，其中一列是 DateTime。如果我尝试对字段 ( `IsDbNull`, `GetValue`, `GetValues`) 执行任何操作，如果值是此数据库等效于 null，我将收到异常。

```
System.ArgumentOutOfRangeException occurred
  HResult=-2146233086
  Message=Year, Month, and Day parameters describe an un-representable DateTime.
  Source=mscorlib
  StackTrace:
       at System.DateTime.DateToTicks(Int32 year, Int32 month, Int32 day)
       at System.DateTime..ctor(Int32 year, Int32 month, Int32 day, Int32 hour, Int32 minute, Int32 second)
       at System.Data.ProviderBase.DbBuffer.ReadDateTime(Int32 offset)
       at System.Data.Odbc.CNativeBuffer.MarshalToManaged(Int32 offset, SQL_C sqlctype, Int32 cb)
       at System.Data.Odbc.OdbcDataReader.internalGetDateTime(Int32 i)
       at System.Data.Odbc.OdbcDataReader.GetValue(Int32 i, TypeMap typemap)
       at System.Data.Odbc.OdbcDataReader.GetValue(Int32 i)
       at System.Data.Odbc.OdbcDataReader.IsDBNull(Int32 i)
       at Sandbox_Form.Form1.button1_Click(Object sender, EventArgs e) in e:\Code\Sandbox Form\Form1.cs:line 49
  InnerException: 
```

如果我将查询更改为`select cast(First_Visit as varchar) as First_Visit_cast from Clients`我得到的文本字符串`0/0/0 12:00:00`作为结果返回。

这是我的测试代码片段。前 17 行工作正常，但第 18 行具有“空”值日期并引发显示的异常。

```
const string Query = @"select cast(First_Visit as varchar) as First_Visit_cast
                             ,First_Visit 
                       from Clients";

private void button1_Click(object sender, EventArgs e)
{
    using (var con = new OdbcConnection("Dsn=My_ODBC_DSN"))
    {
        con.Open();

        using (var cmd = new OdbcCommand(Query, con))
        using (var rdr = cmd.ExecuteReader())
        {
            while (rdr.Read())
            {
                var test = rdr.GetValue(0); //returns "0/0/0 12:00:00" as string.

                var test3 = rdr.IsDBNull(1); //Throws an ArgumentOutOfRangeException: "Year, Month, and Day parameters describe an un-representable DateTime."

                var test2 = rdr.GetValue(1); //Throws an ArgumentOutOfRangeException: "Year, Month, and Day parameters describe an un-representable DateTime."

                var records = new object[rdr.FieldCount];
                rdr.GetValues(records); //Throws an ArgumentOutOfRangeException: "Year, Month, and Day parameters describe an un-representable DateTime."
            }
        }
    }
} 
```

有没有办法解决这个问题？我真的想只写我的查询，`Select * from TableName`而不是识别所有的 DateTimes 并将它们显式转换为字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:56:24.210

DateTime 的最小值是[Jan 1 0001](http://msdn.microsoft.com/en-us/library/system.datetime.minvalue.aspx)。您的值小于那个值，因此在解析过程中会出现异常。

您的值不为空，但它也不是有效的 .Net DateTime。

您可以将空值写入 db 中的此字段而不是“0/0/0 12:00:00”

如果您无法更改数据源，您可以采取一种解决方法：

```
object MyGetValue(int i)
{

  if(rdr.GetFieldType(i) == typof(DateTime))
  {
    try{
       return rdr.GetValue(i);
    }
    catch(ArgumentOutOfRangeException)
    {
     return null;
    }
  }

  return rdr.GetValue(i); 
} 
```

# html - 如何控制谁可以嵌入我网站的可嵌入内容？

> ID：16092653
> 
> 赞同：1
> 
> 时间：2013-04-18T20:40:14.530
> 
> 标签：html, iframe, embed

这是我的 HTML 文件的一个简单示例`embed.html`：

```
<div id="embed_content"> Hello, I am special content on the embed.html file. How are you? </div> 
```

我希望能够控制谁可以将其嵌入到他们的页面上——也就是说，授予谁可以使用它的权限。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:41:54.720

您可以尝试基于 HTTP_REFERER 标头进行过滤，但一般来说，您在 Internet 上发布的任何内容都可以被其他任何人复制或嵌入。您唯一的办法是版权诉讼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:52:25.320

除非您的内容位于私人位置，否则如果没有一些非常复杂的服务器端规则，很难控制它的最终位置或访问权限。`iframe`s不是那么挑剔...

# php - mysqli_fetch_array 给了我重复的行

> ID：16092657
> 
> 赞同：0
> 
> 时间：2013-04-18T20:40:28.697
> 
> 标签：php, mysql

我有这个 SQL 命令：

```
SELECT Username FROM Family WHERE Parent = '$Username' LIMIT 10 
```

当我在我的 PHPMyAdmin 上运行该命令并在其上放置一些 $Username 时，我得到了以下结果：

```
+----------+
| Username |
+----------+
| johndoe  |
+----------+ 
```

但是当我尝试创建这样的函数时：

```
function userParent($Username)
{
global $con;
$Result = mysqli_query($con, "SELECT Username FROM Family WHERE Parent = '$Username' LIMIT 10");
$Result = mysqli_fetch_array($Result);
return $Result; 
} 
```

我有这个数组作为回报：

```
Array ( [0] => johndoe [Username] => johndoe ) 
```

因此，当我使用这样的 foreach 循环在我的脚本上“调用”该函数时：

```
$Parent = userParent('james');
foreach ($Parent as $value){
echo $value . '<br>';
} 
```

作为回报，我总是有重复的“johndoe”。我相信这是由 mysqli_fetch_array 引起的重复行。如何解决 mysqli_fetch_array 中的重复行？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:42:30.050

`mysqli_fetch_array()`返回 MySQL 结果的关联数组和基于数字的数组。改为使用[`mysqli_fetch_assoc()`](http://www.php.net/manual/en/mysqli-result.fetch-assoc.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:42:46.870

这不是骗子，它记录在[http://php.net/mysqli_fetch_array](http://php.net/mysqli_fetch_array)中。默认情况下，该函数返回一个双键数组（数字 + 字符串）。如果您只想要一种类型，请使用特定的

```
mysqli_fetch_row() [numeric only]
mysqli_fetch_assoc() [keyed only]
or
mysqli_fetch_array($result, $fetch_mode); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:42:24.880

见为`mysqli_fetch_assoc`。此函数省略了数字索引数组部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T20:43:43.477

检查文档：[http://php.net/manual/en/mysqli-result.fetch-array.php](http://php.net/manual/en/mysqli-result.fetch-array.php)，它正在返回它应该返回的内容。

默认情况下，它使用`MYSQLI_BOTH`，因此该数组同时具有***数字键和关联键。`MYSQLI_ASSOC`将或`MYSQLI_NUM`作为第二个参数传递给以`mysqli_fetch_array`仅获取一种索引类型。

```
$Result = mysqli_fetch_array($Result, MYSQLI_NUM); 
```

# git - 已移动的 git-svn 克隆存储库？

> ID：16092660
> 
> 赞同：0
> 
> 时间：2013-04-18T20:40:45.810
> 
> 标签：git, git-svn

我们正在一个项目中从 svn 切换到 git。

现在，我们想要移动的 svn 存储库之一，具有我们想要保留的相当长的历史。所以我尝试在它上面做 git-svn clone，效果很好。

但是，svn 存储库在其历史上已经移动了 3 次。

整个 repo 的布局是这样的；

```
repo_root/
trunk/
    projA_v1 (existed in the beginning)
    projA_v2 (then moved to v2)
    projA_v3 (and finally to v3)
    projB
    projC
branches/
    projA_b1
    projA_b2
    projB_b1
    projC_b1
tags/
    projA_t1
    projB_t1
    projC_t1 
```

该项目最初称为 projA_v1，然后移至 v2，最后移至 v3。

现在，当我们执行 git-svn clone 时，我们只获得自上次从 2 移动到 3 以来的历史记录。如果我们检查 svn 中的日志，我们可以正确看到整个历史记录。

我能做些什么来获取整个历史吗？那里有大约 3 年的失传历史，如果可以的话，我们宁愿保留它。

更新：我现在尝试在整个 repo 上做 git-svn clone，从`repo_root`. 我想我可以这样做，然后使用[Detach (move) 子目录中的说明将生成的 git repo 修剪到单独的 Git 存储库](https://stackoverflow.com/questions/359424/detach-subdirectory-into-separate-git-repository)中，它似乎运行良好。（至少修剪位）

不过还是有问题。分支将无法正常运行。我想这是因为 git-svn 无法将它们识别为分支，因为其中一个分支中的内容不是整个主干的副本，而只是主干的一部分. 有任何想法吗？

在一个理想的世界中，我最终会得到一个仅包含 projA 的 repo，其中包含 projA_v1 和 v2 的历史，以及 projA 分支和标签中的历史。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:29:34.157

我找到了一种对我有用的方法，但是它非常“不通用”，所以我很犹豫是否将其发布在这里...

我发现对我有用的是`.git/config`在项目移动时进行编辑。我做`git svn fetch -r`了它移动的修订，然后编辑了配置。

在我的例子中，项目从trunk/v2 转移到branch/v3 到trunk/v3，而最后一步对我来说是最成问题的。我在配置中翻转了主干和分支，因此从分支/v3 到主干/v3 的移动看起来像一个分支。然后我得到了整个历史。

我不得不对`--ignore-paths=""`所有其他处于同一水平的项目做相当长的时间。

我认为这种方法在其他情况下不起作用，但`config`如果其他所有方法都失败了，考虑修改可能是个好主意。

# nsarray - 过滤数组：谓词？堵塞？

> ID：16092661
> 
> 赞同：3
> 
> 时间：2013-04-18T20:40:46.657
> 
> 标签：nsarray, objective-c-blocks, nspredicate

我正在寻找在第二次处理之前过滤阵列的解决方案，无需进一步测试即可应用。

假设我想从给定文件夹中删除所有大于 500K 的文件。我可以：

1）获取一个枚举器，然后对每个项目，测试大小并删除大文件；2）获取一个枚举器，过滤它，然后删除所有剩余的文件。

我想知道如何实现解决方案2。我正在考虑另一种处理方法（这次不删除），比如图像缩小，可以应用多次。在每个循环中，文件大小都会减小，并且枚举器总是变小，直到它为空。至此，治疗结束。

但是如何做到这一点？我见过很多像 @"SELF contains[c] 'e'"（有小的变化）这样的谓词示例，但从来没有 SELF.size > 500000...</p>

我想解决方案可能是一个障碍，但我不得不承认我完全迷路了......

请伸出援助之手！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T08:12:46.703

使用`+[NSPredicate predicateWithBlock:]`工厂方法怎么样？您将返回`YES`您想要保留的项目（例如小于 500000 字节/字符/...）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-29T01:25:42.073

```
NSPredicate *predicate = [NSPredicate predicateWithBlock: ^BOOL (id evaluatedObject, NSDictionary *bindings){
NSDictionary *fileDic =[_fm attributesOfItemAtPath:[evaluatedObject path] error: nil];
unsigned long long testSize = [[fileDic valueForKey:@"NSFileSize"]longLongValue];
return testSize > 500000;
}]; 
```

# sql - 有人能详细解释一下这个 PL/SQL 语句吗？

> ID：16092665
> 
> 赞同：0
> 
> 时间：2013-04-18T20:40:57.633
> 
> 标签：sql, oracle, plsql, plsqldeveloper

```
DECLARE
    p NUMBER := 0;
    q NUMBER := 1;
    r NUMBER;
BEGIN
    DBMS_OUTPUT.PUT_LINE(LPAD('0: ', 4) || LPAD(p, 10)); 
    DBMS_OUTPUT.PUT_LINE(LPAD('1: ', 4) || LPAD(q, 10)); 
    FOR k IN 2..20 LOOP 
        r := p + q;
            DBMS_OUTPUT.PUT_LINE(LPAD(k, 2) || ': ' || LPAD(r, 10)); 
            p := q;
            q := r;
    END LOOP;
END; 
```

我们在我的一门课上讨论过这个问题，但我并没有真正理解这个 for 循环是如何工作的。我知道输出在左侧打印数字 0-20，我对右侧的数字如何增加感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:46:11.407

打印的序列是[斐波那契数](http://en.wikipedia.org/wiki/Fibonacci_number)。他们的递归定义如下：`a_n = a_(n-1) + a_(n-2)`. 在代码片段中，扮演`p`的角色。想象一下从右到左打印的序列，并叠加了一个滑动窗口 ( )。在每次迭代中，窗口向左移动一步。该函数将字符串填充到给定长度。您可以选择添加第三个参数，即填充字符（默认为）。请注意，有一个兄弟函数。但是如果代码已经在课堂上讨论过，你可能知道这一点。`a_(n-2)``q``a_(n-1)``r, q, p``lpad```rpad``

 `* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T05:21:23.493

@DaBulls33 请在下面找到您需要的解决方案

```
DECLARE
p NUMBER := 0;
q NUMBER := 1;
r NUMBER;
BEGIN
FOR k IN 2..80 LOOP 
    r := p + q;
     IF K >29 THEN
      DBMS_OUTPUT.PUT_LINE(LPAD(k, 2) || ': ' || LPAD(r, 10));
      END IF;
        p := q;
        q := r;
END LOOP;
END; 
````

# android-layout - 自定义布局的对话

> ID：16092666
> 
> 赞同：1
> 
> 时间：2013-04-18T20:41:00.343
> 
> 标签：android-layout, android-fragments, android-dialog

我想用自定义布局创建一个对话。Android API 文档建议我始终使用 Alert Dialogue，并且我不尝试直接实例化 Dialogue 类。

这非常困难，因为 AlertDialog 的构建器不允许自定义视图。我很幸运地找到了对适配器的支持，但要访问布局充气器仍然非常困难。

片段类没有 getContext() 是否有原因？当 savedInstanceState 为空时，如何在片段中获取 layoutInflater？

如果可能，创建完全自定义对话框的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:32:15.827

即使对话片段不支持...

getLayoutInflater(Bundle) （因为 SavedInstanceState 为空），或 getContext()

您可以使用 getActivity().getLayoutInflater()。

# xpages - Domino 9 有一个新的用于复选框组控件的布尔转换器 - 任何人都可以使用它吗？

> ID：16092667
> 
> 赞同：1
> 
> 时间：2013-04-18T20:41:04.220
> 
> 标签：xpages

我将新的布尔转换器添加到复选框并将其绑定到 Domino 表单上的数字字段。当我查看 XPage 时出现错误：异常 java.lang.String 与 java.lang.Boolean 不兼容。

我的来源是

```
<xp:checkBoxGroup
        id="checkBoxGroup1"
        value="#{document1.Good}"
        defaultValue="true">
        <xp:this.converter>
            <xp:convertBoolean></xp:convertBoolean>
        </xp:this.converter>
        <xp:selectItems>
            <xp:this.value><![CDATA[#{javascript:var arr = ["true", "false"];
return arr;}]]></xp:this.value>
        </xp:selectItems>
    </xp:checkBoxGroup> 
```

只是想知道 ND9 中的这个新功能是如何工作的？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T14:21:27.270

霍华德我在这里发布了一个提示：http: [//xpagetips.blogspot.com/2013/01/before-ibm-connect-5-days-5-tips-tip-1.html](http://xpagetips.blogspot.com/2013/01/before-ibm-connect-5-days-5-tips-tip-1.html)。

我觉得你是对的。它只是为了让使用布尔值更容易，但不能在 Notes 文档中实际存储该数据类型。

也许我们的未来会有对象存储？

# php - 如何在PHP中的表数据周围放置链接

> ID：16092675
> 
> 赞同：0
> 
> 时间：2013-04-18T20:41:18.573
> 
> 标签：php

我正在尝试在表格中的数据周围放置一个链接。因此，如果用户单击该链接，它会将他们带到该项目的编辑页面。每次我把代码中的数据从表中消失。这是我正在处理的页面的代码：

我正在尝试将可点击的数据放在表格代码的开头

```
<?php include '../view/header.php'; ?>

<div id="main">

    <h1>Product List</h1>

   <div id="content">
        <!-- display a table of products -->
        <h2><?php echo $name; ?></h2>
        <table>
            <tr>
                <th>Code</th>
                <th>Name</th>
                <th class="right">Version</th>
                <th>&nbsp;</th>
            </tr>

            <?php foreach ($products as $product) : ?>
            <tr>
                <td> <a href="?action=view_product&amp;product_id=<?php echo $product['productCode']; ?>"</a></td>
                <td><?php echo $product['name']; ?></td>
                <td class="right"><?php echo $product['version']; ?></td>
                <td><form action="." method="post">
                    <input type="hidden" name="action"
                           value="delete_product" />
                    <input type="hidden" name="productCode"
                           value="<?php echo $product['productCode']; ?>" />
                    <input type="submit" value="Delete" />
                </form></td>
            </tr>
            <?php endforeach; ?>
        </table>
        <p><a href="?action=show_add_form">Add Product</a></p>
        </br>

    </div>

</div>
<?php include '../view/footer.php'; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:45:44.673

可能不是问题，但我看不到任何地方的关闭：

```
<a href="?action=view_product&amp;product_id=<?php echo $product['productCode']; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:45:03.047

您没有任何结束`</a>`标签，并且在开始`<a>`标签和结束标签应该在的位置之间没有任何内容。这是问题所在：

```
<td> <a href="?action=view_product&amp;product_id=<?php echo $product['productCode']; ?>"></td> 
```

这应该是这样的：

```
<td><a href="?action=view_product&amp;product_id=<?php echo $product['productCode']; ?>"><?php echo $product['productCode']; ?></a></td> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:45:45.333

您缺少锚点的结束标签。它应该是： `<td> <a href="?action=view_product&amp;product_id=<?php echo $product['productCode']; ?>"><?php echo $product['productCode']; ?></a></td>`

# ios - 允许 UI 更新 iOS

> ID：16092677
> 
> 赞同：0
> 
> 时间：2013-04-18T20:41:23.673
> 
> 标签：ios, uikit

假设我做了这样的事情：

```
[MBProgressHUD showHUDAddedTo:self.view animated:YES];
[self methodThatTakesLotsOfTime];
[MBProgressHUD hideHUDForView:self.view animated:YES]; 
```

这将没有足够的时间让 HUD 进入动画并显示。使用`sleep(100)`或 NSTimer 只会增加问题。我也无法在主队列上运行该方法。更不用说`dispatch_get_current_queue()`iOS 6.0+ 已弃用。我一定错过了一些大事

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:47:21.777

您可以尝试使用事务完成处理程序：

```
[MBProgressHUD showHUDAddedTo:self.view animated:YES];
[CATransaction setCompletionBlock: ^{
     [self methodThatTakesLotsOfTime];
}]; 
```

但实际上这只是权宜之计。您正在使用的代码的作者可以为您提供一种使用完成块制作动画的方法。

# jquery - 是否可以在事件上使用 jQuery Autocomplete

> ID：16092680
> 
> 赞同：1
> 
> 时间：2013-04-18T20:41:31.313
> 
> 标签：jquery, jquery-ui

当我按下 ctrl-enter 键时，我想执行 Jquery Autocomplete。因此，当我按 ctrl-enter 键时，应为用户列出所有项目。

```
$("#textarea").autocomplete({
    source: ["c++", "java", "php", "coldfusion", "javascript", "asp", "ruby"]
}); 
```

现在在上面的代码中，当我在我的文本区域中按 ctrl-enter 时，所有项目都应该显示给用户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:46:23.983

[**工作小提琴**](http://jsfiddle.net/mohammadAdil/9kMXN/)

```
$("#textarea").autocomplete({
    source: ["c++", "java", "php", "coldfusion", "javascript", "asp", "ruby"],
    minLength: 0
});

$('#textarea').keydown(function (e) {
  if (e.ctrlKey && (e.keyCode == 10 || e.keyCode == 13)) {
       $("#textarea").autocomplete("search","");
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:46:09.570

请参阅[TEXTAREA 中的 Ctrl+Enter jQuery](https://stackoverflow.com/questions/1684196/ctrlenter-jquery-in-textarea)。

如果您没有完成，我不确定为什么需要自动完成。您可以触发一个 JQuery ajax 请求并在按下 ctrl + enter 时列出您想要的任何内容，如上面的链接所示。

或者您可以触发自动完成来执行列出您想要的任何内容的脚本。

# class - 类图中的依赖关系如何

> ID：16092684
> 
> 赞同：1
> 
> 时间：2013-04-18T20:41:49.013
> 
> 标签：class, dependencies, uml, class-diagram

我在类图中的依赖项有问题。我使用这些类

类**数据**和类**算法**

**类之间有什么关系？** *谢谢您的帮助*

数据.cs =>

```
public class Data {

     public string Data1 { get; set; }
     public string Data2 { get; set; }

     public Data(string data1, string data2)
     {
         this.Data1 = data1;
         this.Data2 = data2;
     }

     public string data1data2()
     {
         return Data1 + " " + Data2;
     }
 } 
```

算法.cs =>

```
public static class Algorithm
{

  public static void MethodData()
  {
     List<Data> data = new List<data>();

     data.Add(new Data("aaaa", "bbb"));
     .
     .
     foreach(Data item in data)
     {
        Console.WriteLine(item.data1data2());
     }
     .  
   }         
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:46:30.327

算法与数据具有一对多的关系。这可以通过包含数据列表（许多）的字段的存在来看出。一种算法知道许多数据对象。

数据与算法没有任何关系，因为它没有任何算法类型的字段。因此，通常人们会使用 Algorithm 中指向 Data 对象的箭头来绘制关系。

这可能会有所帮助：[UML 类图中关联箭头的方向](https://stackoverflow.com/questions/1906386/direction-of-the-association-arrow-in-uml-class-diagrams)

# c# - 使用 C# 的 Windows 凭据提供程序

> ID：16092696
> 
> 赞同：10
> 
> 时间：2013-04-18T20:42:43.353
> 
> 标签：c#, .net, credential-providers

有没有人在 C# 中成功创建了自定义 Windows 凭据提供程序？Windows SDK 中的示例均使用 C++。我所做的一些初步搜索表明它可能是可能的，但似乎找不到任何确认它的人。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-19T19:34:56.650

+1 为[pgina](http://pgina.org/)。正如 Cody 所说，没有可用于创建凭据提供程序的托管 API，如果您想使用 pInvoke 路线，解决 pInvoke 问题可能会花费更多时间，而不是找出凭据提供程序。

pGina 可以帮助您的地方是它有一个很好的插件架构，并且插件是用托管代码编写的。[请参阅此处](http://pgina.org/docs/v3.0/core.html)的图表。pGina 处理与 LogonUI（本机代码）的通信，但依赖插件（托管）进行实际身份验证，这可能是您想要控制的（否则您可能不需要自己的凭据提供程序）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-06T14:00:43.697

Windows Vista 及更高版本中的新 CredentialProvider 模型基于 COM。这意味着只要您实现正确的 COM 接口，它就应该是可能的。

基于此，它应该比旧的 GINA 模型更容易构建，因为旧的 GINA 模块使用 DLL 入口点和函数指针而不是 COM 接口。

鉴于 .Net 与 COM 互操作的能力，它应该很简单：

1.  构建 ICredentialProvider 接口的 C# 定义并使用正确的 GUIDS 添加正确的 COM 属性
2.  构建实现 ICredenitalProvider 并标记为 COMVisible(True) 的凭据提供程序类
3.  使用 Regasm 注册新程序集
4.  添加正确的注册表项以在 Windows 中注册新的 CredentialProvider (Software\Microsoft\Windows\CurrentVersion\Authentication\Credential Providers)

如果你做了所有这些，你将拥有一个可用的凭证提供程序，用 C# 编写

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-19T20:20:07.930

查看 pGina。我一直在玩它，它似乎在我的 Windows 8 安装上运行良好，因此它应该也适用于之前的所有 Windows 版本。虽然它仍处于早期阶段，但我看不到任何创建自定义 UI 的方法，而无需深入研究项目的本机部分。希望这可以帮助！

[编辑] 再次阅读 Cody Gray 的评论。需要明确的是，pGina 实际上只是为您编写的本机代码。但是，是的，一开始你可能有更多的控制权，用 C++ 编写它，但如果你不需要太多控制它的呈现方式，那么 pGina 就是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-30T12:17:20.770

这是可能的，因为凭据提供程序是 COM 对象，并且 COM 对象可以在托管代码中实现。

有关一些详细信息和一个好的起点，请参阅[此博客。](https://syfuhs.net/2017/10/15/creating-custom-windows-credential-providers-in-net/)Github 仓库在[这里](https://github.com/SteveSyfuhs/CredProvider.NET)。

# ruby-on-rails - Rails：MVC 如何使用自定义操作

> ID：16092705
> 
> 赞同：0
> 
> 时间：2013-04-18T20:43:05.177
> 
> 标签：ruby-on-rails, mongodb, model-view-controller

我有一个使用 rails 生成的脚手架的条目的表输出：CRUD ops。

如果我想在桌子上做另一个动作，比如默认的“显示、编辑、销毁”，比如图书馆的书“签到”，那会将状态更新为“签到”......

使用模型和控制器进行更新的正确方法是什么？（使用 mongodb）

更好地说明：拥有许多自定义操作的最佳方式是什么？把它想象成许多多用途的“Facebook Likes”。

在桌子上，动作列表“打这个”，“看看这个”......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:18:46.780

有很多方法可以处理这个问题，但我通常喜欢在他们自己的控制器操作中用它自己的路由隔离这样的操作。

## 模型

为了保持整洁，我建议在模型中添加一个方法来更新您关注的属性。如果您不关心验证，您可以使用`update_attribute`. 此方法跳过验证并保存到数据库

```
class LibraryBook < ActiveRecord::Base
  def check_in!
    self.update_attribute(:checked_in, true)
  end
end 
```

## 看法

您需要更新`index.html.erb`视图以添加更新单个记录的链接。这也需要添加一条路线。由于您正在更新记录，因此您需要使用 PUT HTTP 动词。

### 路线.rb

```
resources :library_books do
  match :check_in, on: :member, via: :put # creates a route called check_in_library_book
end 
```

### index.html.erb

添加链接

```
link_to check_in_library_book_path(library_book), method: :put 
```

## 控制器

现在您需要在调用该`#check_in!`方法的控制器中添加操作。

```
class LibraryBooksController < ApplicationController
  def check_in
    @library_book = LibraryBook.find(params[:id])
    if @library_book.check_in!
      # Handle the success
    else
      # Handle the Failure
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:07:57.140

**在我看来，处理这种状态工作流的最佳方法是从事件**的角度来考虑它，然后将状态视为**最近的事件**。我通常创建一个`event_type`带有`name`and的表`code`（例如`Check In`，`CHECK_IN`分别用于名称和代码），然后创建一个`event`带有`event_type_id`, 时间戳的表，通常是某种用户 ID 或 IP 地址，或两者兼而有之。

然后你可以这样说：

```
class Thing < ActiveRecord::Base
  has_many :events

  def status
    events.order("created_at DESC").first.event_type.name
  end
end 
```

那里也有“审计线索”宝石，但在我（有限的）经验中，它们并不是很好。

这与 MongoDB 无关，实际上可能与 Mongo 不兼容，但希望它至少为您指明正确的方向或给您一些想法。

# django-south - Django-South - 迁移生产服务器

> ID：16092706
> 
> 赞同：1
> 
> 时间：2013-04-18T20:43:13.693
> 
> 标签：django-south

我在开发服务器上进行所有开发，当我对更改感到满意时，将更改推送到生产服务器。有时我会更改数据库，为此，我使用 Django-South。

如果我只在一个应用程序中更改模型，我会运行`python manage.py schemamigration my_app`然后`python manage.py migrate my_app`更新开发服务器的数据库模式。

我的问题是，一旦我将更新推送到生产服务器，更新生产服务器的最简单方法是什么？由于其中的所有迁移文件`my_app/migrations/`也被推送到生产服务器，我是否只运行一个`python manage.py migrate my_app`来模拟数据库更改？

如果我通过多次 django-south`migrate my_app`执行进行了多次数据库修改，那它仍然只是一个`python manage.py migrate my_app`吗？

我只是想小心我的命令，以免意外破坏生产数据库的一部分：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:35:52.020

来自[南方文档](http://south.readthedocs.org/en/latest/commands.html#migrate)：

如果要一次迁移所有应用程序，请运行：

```
./manage.py migrate 
```

这与为每个应用程序调用第一个示例具有相同的效果，并且将正确处理依赖关系。

# php - 将图像信息输入数据库时 遇到问题

> ID：16092709
> 
> 赞同：1
> 
> 时间：2013-04-18T20:43:26.450
> 
> 标签：php, html, mysql, sql, database

当我提交表单时，我可以将文章的信息传递到我的数据库中，但我的图像信息不会发送。

我正在使用事务，因此我可以将信息从 1 个表单插入到 2 个表中。

这是将信息传递到数据库的事务：

```
$conn->query("START TRANSACTION");
$stmt = $conn->prepare('INSERT INTO articles(article_title, article_text, article_date) VALUES (?, ?, NOW())');
$stmt->bind_param('ss', $_POST['article_name'], $_POST['description']);
$stmt->execute();
$stmt = $conn->prepare('INSERT INTO images (article_id, image_caption, image_filename) VALUES(LAST_INSERT_ID(),?,?)');
$stmt->bind_param('ss', $_POST['image_caption'], $_FILES['upload']['name']);
$stmt->execute();
$stmt->close();
$conn->query("COMMIT"); 
```

这是我的表格：

```
<form id="inputArticle" name="inputArticle" method="post" action="" enctype="multipart/form-data" >
<p> <label for="article_name">Article Title:</label> <input name="article_name" placeholder="Name of the article" id="article_name" type="text" size="50" maxlength="50" /> </p>
<p> <label for="description">Article Content:</label> <textarea name="description" placeholder="Content of the article"id="description" cols="50" rows="10"></textarea> </p>
<p> <label for="image_filename">Choose File to Upload</label><br /> <input type="file" name="image_filename" id="image_filename" /> </p>
<p> <label for="image_caption">Image Caption:</label> <textarea name="image_caption"  id="image_caption" cols="50" rows="5"></textarea> </p>
<p> <input type="submit" name="insert" value="Insert New Article" /> </p>
</form> 
```

**旁注：** 当我从 sql 和表单中删除图像上传代码时，一切似乎都正常。id 和 description 被发送到数据库，所以我认为问题出在图片上传部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:33:29.150

忘记更改输入名称。

```
Issent $_FILES['upload']['name'] supposed to be $_FILES['image_filename']['name''] 
```

# android - 方向更改后未更新Android ListView

> ID：16092711
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:43:31.430
> 
> 标签：android

在过去的几个小时里，我一直在谷歌上搜索，我已经看到这个问题被问了 20 次，但似乎没有一个解决方案对我有用。我有一个 ListView 和一个 CustomList 类，它包含一个列表适配器和一个用于编辑/删除/重命名项目的简单对话框。在第一次屏幕旋转之前，一切都按预期工作。之后，列表停止更新，尽管适配器包含所有正确的数据。我将在不跳过一行的情况下发布这两个文件。我现在不需要保存任何数据，稍后我会处理。这真的很奇怪，因为据说应用程序会在屏幕旋转后完全重新启动。更奇怪的是，即使在屏幕旋转之后，虚拟项目也会添加到 onCreate，但之后列表中没有其他响应。

请原谅我的英语和我的菜鸟，并尝试为我指明正确的方向。

```
 package com.sl.mylandmarks;

import android.app.Activity; import android.content.ContentResolver; import android.content.Context; import android.location.LocationManager; import android.os.Bundle; import android.provider.Settings; import android.text.Editable; import android.text.TextWatcher; import android.util.Log; import android.view.Menu; import android.view.View; import android.view.View.OnClickListener; import android.widget.AdapterView; import android.widget.AdapterView.OnItemLongClickListener; import android.widget.Button; import android.widget.EditText; import android.widget.ListView; import android.widget.TextView;

public class MainActivity extends Activity {

    Button addButton;   ListView landmarksList;     EditText inputName, inputSearch;    CustomList customList;  Context globalContext;  TextView gpsState;  private LocationManager locationManager;    private GPSTracker gpsTracker;  private double longitude;   private double latitude;

    @Override   protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);         setContentView(R.layout.activity_main);

        gpsTracker = new GPSTracker(MainActivity.this);

        globalContext = this;

        addButton = (Button) findViewById(R.id.addBtn);

        customList = new CustomList(this);

                landmarksList = (ListView) findViewById(R.id.listView1);        landmarksList.setAdapter(customList.getAdapter());      landmarksList.setChoiceMode(ListView.CHOICE_MODE_SINGLE);       landmarksList.setTextFilterEnabled(true);       landmarksList.setLongClickable(true);       customList.theList = landmarksList;

        inputName = (EditText) findViewById(R.id.EditItemName);

        gpsState = (TextView) findViewById(R.id.gpsState);

        ContentResolver contentResolver = getBaseContext().getContentResolver();        boolean gpsStatus = Settings.Secure.isLocationProviderEnabled(
                contentResolver, LocationManager.GPS_PROVIDER);         if (gpsStatus) {            gpsState.setText("GPS Enabled");        } else {            gpsState.setText("GPS Disabled");       }

        // // SEARCH BOX

        inputSearch = (EditText) findViewById(R.id.editText3);      inputSearch.addTextChangedListener(new TextWatcher() {

            public void afterTextChanged(Editable s) {

            }

            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {            }

            public void onTextChanged(CharSequence s, int start, int before,
                    int count) {
                customList.getAdapter().getFilter().filter(s);          }       });         // // SEARCH BOX

        // / DUMMY ITEMS        customList.addItem("Home", "43.1565 / 15.8645");        customList.addItem("Work", "43.1565 / 15.8645");        customList.addItem("Denis` apartment", "43.1565 / 15.8645");        customList.addItem("Natasa", "43.1565 / 15.8645");      customList.addItem("Bruce Wayne", "43.1565 / 15.8645");         customList.addItem("Walker shop", "43.1565 / 15.8645");         customList.addItem("Chuck Norris Residence", "43.1565 / 15.8645");      customList.addItem("Some landmark", "43.1565 / 15.8645");       // customList.removeItem(3);

        OnItemLongClickListener listLongClick = new OnItemLongClickListener() {

            @Override           public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                    int arg2, long arg3) {
                customList.showOptionsDialog(arg2);
                return true;// event consumed, not dispatched forward           }       };

        landmarksList.setOnItemLongClickListener(listLongClick);

        OnClickListener ButtonClick = new View.OnClickListener() {

            @Override           public void onClick(View v) {
                switch (v.getId()) {
                case R.id.addBtn:

                    customList.addItem(inputName.getText().toString(),
                            "45.5644 / 23.6541");

                    inputName.setText("");
                    break;

                }

            }

        };

        addButton.setOnClickListener(ButtonClick);

    }

    @Override   public void onPause() {         super.onPause();

    }

    @Override   public void onResume() {        super.onResume();

    }

    @Override   public boolean onCreateOptionsMenu(Menu menu) {         // Inflate the menu; this adds items to the action bar if it is present.        getMenuInflater().inflate(R.menu.main, menu);       return true;

    }

} 
```

和 CustomList.java

```
package com.sl.mylandmarks;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import android.app.Dialog;
import android.content.Context;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.SimpleAdapter;

public class CustomList {

    ArrayList<HashMap<String, String>> list = new ArrayList<HashMap<String, String>>(
            2);
    HashMap<String, String> maplist;
    SimpleAdapter listAdapter;
    public Context context;
    public ListView theList;
    public CustomList(Context con) {

        context = con;
        String[] from = { "line1", "line2" };

        int[] to = { android.R.id.text1, android.R.id.text2 };

        listAdapter = new SimpleAdapter(context, list,
                android.R.layout.simple_list_item_2, from, to);

    }

    public void addItem(String name, String coords) {
        if ((name != null) && (name.length() != 0)) {
            maplist = new HashMap<String, String>();
            maplist.put("line1", name);
            maplist.put("line2", coords);
            list.add(maplist);
            listAdapter.notifyDataSetChanged();
        }
    }

    public void removeItem(int id) {

        Log.d("removing",list.remove(id).toString());

        listAdapter.notifyDataSetChanged();
    }

    public void renameItem(int id, String newName) {
        Log.d("SL","Rename Selected");
        maplist = new HashMap<String, String>();
        maplist.put("line1", newName);
        maplist.put("line2", list.get(id).get("line2"));
        list.set(id, maplist);
        listAdapter.notifyDataSetChanged();

    }

    public SimpleAdapter getAdapter() {

        return listAdapter;
    }

    public void showOptionsDialog(final int position) {

        //Log.d("SL", String.valueOf(position));
        final Dialog optionsDialog = new Dialog(context);
        optionsDialog.setContentView(R.layout.list_dialog);
        optionsDialog.setTitle("Options");
        optionsDialog.show();
        final EditText itemNameEdit = (EditText) optionsDialog
                .findViewById(R.id.EditItemName);
        final Button removeBtn = (Button) optionsDialog
                .findViewById(R.id.removeBtn);
        final Button renameBtn = (Button) optionsDialog
                .findViewById(R.id.renameBtn);
        final Button cancelBtn = (Button) optionsDialog
                .findViewById(R.id.cancelBtn);

        itemNameEdit.setText(list.get(position).get("line1"));
        itemNameEdit.setSelection(itemNameEdit.length());

        OnClickListener ButtonClick = new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {
                switch (arg0.getId()) {
                case R.id.removeBtn:
                    removeItem(position);
                    optionsDialog.dismiss();
                    break;
                case R.id.renameBtn:
                    renameItem(position, itemNameEdit.getText().toString());
                    optionsDialog.dismiss();
                    break;
                case R.id.cancelBtn:
                    optionsDialog.dismiss();
                    break;
                }
            }

        };

        removeBtn.setOnClickListener(ButtonClick);
        renameBtn.setOnClickListener(ButtonClick);
        cancelBtn.setOnClickListener(ButtonClick);

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:09:59.697

我不确定你的问题到底是什么。而且我没有查看您的代码，因为我认为 SO 不是转储类并说“修复此问题”的好地方。但我可能会给你一个答案。

确实，当您旋转时，Android 正在重新创建活动（如 roky 所说）。如果您来自 iPhone 开发背景（我就是这种情况），那看起来有点奇怪。

但是如果你的activity不是太复杂，你可以告诉Android来处理它。为此，将其添加到您的 AndroidManifest.xml 标记中

```
<activity android:configChanges="orientation|screenSize" ... >
</activity> 
```

这是比我更好的解释：[android:configChanges="orientation" 不适用于片段](https://stackoverflow.com/questions/7139488/androidconfigchanges-orientation-does-not-work-with-fragments)

如果我的回答是好的，那就太好了！

# javascript - 如何用超链接替换 document.body.innerHTML 中的数字字符串

> ID：16092713
> 
> 赞同：0
> 
> 时间：2013-04-18T20:43:32.963
> 
> 标签：javascript, hyperlink

目前，我正在尝试用 javascript 编写一个函数，该函数将搜索 doc.body.innerHTML 并始终以相同的格式搜索一组数字字符串。

前任。00000000123456

当它找到这个数字时，我想让它减去 8 个 0 并只用 123456 替换它。一旦它只有最后 6 位数字，我想让它成为一个超链接，以在特定页面上搜索这些数字。

但是，如果它更容易编码，那么在创建超链接之前删除 8 个 0 并不完全重要，只要我可以让超链接本身仅搜索最后 6 位数字。

我尝试了几种不同的方法，但都没有奏效，请放轻松，因为我对此还很陌生。

* * *

编辑 ：

示例：页面包含以下内容

姓名：john johnson 帐号：00000000123456 电子邮件：john@johnson.com

我需要找到帐号，删除开头的 0 并将 00000000123456 替换为 123456。然后 123456 将成为一个超链接，将我带到所述帐户页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:14:40.780

这可能是一种方法：

```
var body = document.getElementsByTagName('body')[0];

// search through each node in the DOM starting from the body element
(function search(child){
    for(var i = 0;i < child.childNodes.length;i++){
        search(child.childNodes[i]);
    }
    // if it's a text node
    if(child.nodeType === 3){
        // if it matches the number replace with a link
        var result =   /^(:?0{8}(\d+))/.exec(child.textContent);      
        if(result){
            link = document.createElement('a');
            // change this to be the href you want
            link.href = result[2];
            // change this to be the text you want
            link.innerHTML = 'search '+result[2];
            child.parentNode.replaceChild(link, child);
        }
    }
})(body); 
```

演示：http: [//jsfiddle.net/louisbros/6a8fA/](http://jsfiddle.net/louisbros/6a8fA/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:51:01.923

希望您正在寻找以下内容：（提示）

```
document.write("<p>Link: " + txt.link("http://www.example.com") + "</p>"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:58:21.990

我相信这可以满足您的要求：

```
document.body.innerHTML = document.body.innerHTML.replace(/0+(\d{6})/g, function(match, number){
    return "<a href='/search/" + number + "'>" + number + "</a>";
}); 
```

这将查找前面有一个或多个零的六位数字的任何实例，并将其转换为指向“/搜索/[六位数字]”的链接。您可以在浏览器的 javascript 控制台中运行它来测试它。

您可能希望只替换页面的相关部分，而不是整个文档（为了提高性能）。

# php - PHP Excel 图片链接

> ID：16092718
> 
> 赞同：1
> 
> 时间：2013-04-18T20:43:46.510
> 
> 标签：php, image, excel, hyperlink

我正在使用[PHP Excel](http://phpexcel.codeplex.com/)库并遇到问题。

我需要作为超链接插入到单元格图像中。有可能吗，有什么建议吗？

尝试绘制图像

```
 $image = imagecreatefromjpeg($imagePath);

        $objDrawing = new PHPExcel_Worksheet_MemoryDrawing();        
        $objDrawing->setImageResource($image);        

        $columnLetter = PHPExcel_Cell::stringFromColumnIndex($columnIndex - 1);

        $this->imageColumns[$columnLetter] = 1;

        $coordinate = $columnLetter . $rowIndex;

        $objDrawing->setCoordinates($coordinate);
        $objDrawing->setResizeProportional(false);
        $objDrawing->setRenderingFunction(PHPExcel_Worksheet_MemoryDrawing::RENDERING_JPEG);
        $objDrawing->setMimeType(PHPExcel_Worksheet_MemoryDrawing::MIMETYPE_DEFAULT);        
        $objDrawing->setWorksheet($this->objPHPExcel->getActiveSheet()); 
```

# c# - 控件失焦时更改所选值的下拉列表

> ID：16092719
> 
> 赞同：2
> 
> 时间：2013-04-18T20:43:47.773
> 
> 标签：c#, winforms, .net-4.0, combobox

我有几个具有相同属性的组合框。

```
Dropdownstyle : Dropdownlist
AutoCompleteMode: SuggestAppend
AutoCompleteSource: ListItems 
```

例如，我有一个下拉列表 cboxStates，其中手动输入了美国的 50 个州。当我输入 WI 时，它会在 WA、WV、WI、WY 中突出显示，但如果我在另一个控件上按 Tab/按 Enter/鼠标单击，则会选择 WA 而不是突出显示的 WI。这是完全随机的，它发生在动态绑定的组合框上。而且，他们没有任何事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:55:12.713

这似乎是已提交给[Connect](http://connect.microsoft.com/VisualStudio/feedback/details/711945/tab-on-a-winforms-combobox-with-properties-autocompletemode-append-autocompletesource-listitems-doesnt-work-correctly)的问题。有一个解决方法可以扩展默认的 ComboBox 控件并解决问题。扩展的 ComboBox 代码在 Connect 站点上的格式非常糟糕，所以这里是更好的版本 :)

```
public class BetterComboBox : ComboBox 
{
    private int _windows7CorrectedSelectedIndex = -1;
    private int? _selectedIndexWhenDroppedDown = null; 

    protected override void OnDropDown(EventArgs e)
    {  
        _selectedIndexWhenDroppedDown = SelectedIndex;    
        base.OnDropDown(e);
    }

    private bool _onDropDownClosedProcessing = false; 

    protected override void OnDropDownClosed(EventArgs e) 
    { 
        if (_selectedIndexWhenDroppedDown != null && _selectedIndexWhenDroppedDown != SelectedIndex)   
        {    
            try   
            {      
                _onDropDownClosedProcessing = true;     
                OnSelectionChangeCommitted(e);   
            }    
            finally   
            { 
                _onDropDownClosedProcessing = false;   
            }   
        }   
        base.OnDropDownClosed(e);   
        if (SelectedIndex != _windows7CorrectedSelectedIndex)   
        {  
            SelectedIndex = _windows7CorrectedSelectedIndex;      
            OnSelectionChangeCommitted(e);  
        }
    } 

    protected override void OnSelectionChangeCommitted(EventArgs e)
    {   
        if (!_onDropDownClosedProcessing)
            _windows7CorrectedSelectedIndex = SelectedIndex;    
        _selectedIndexWhenDroppedDown = null; 
        base.OnSelectionChangeCommitted(e); 
    } 

    protected override void OnSelectedIndexChanged(EventArgs e)
    {  
        bool alreadyMatched = true;   
        if (_windows7CorrectedSelectedIndex != SelectedIndex)  
        {  
            _windows7CorrectedSelectedIndex = SelectedIndex; 
            alreadyMatched = false; 
        }   
        base.OnSelectedIndexChanged(e);  

        //when not dropped down, the SelectionChangeCommitted event does not fire upon non-arrow keystrokes due (I suppose) to AutoComplete behavior   
        //this is not acceptable for my needs, and so I have come up with the best way to determine when to raise the event, without causing duplication of the event (alreadyMatched)   
        //and without causing the event to fire when programmatic changes cause SelectedIndexChanged to be raised (_processingKeyEventArgs implies user-caused)   
        if (!DroppedDown && !alreadyMatched && _processingKeyEventArgs)
            OnSelectionChangeCommitted(e); 
    } 

    private bool _processingKeyEventArgs = false;

    protected override bool ProcessKeyEventArgs(ref Message m)
    {  
        try   
        {   
            _processingKeyEventArgs = true; 
            return base.ProcessKeyEventArgs(ref m);  
        }  
        finally 
        { 
            _processingKeyEventArgs = false;  
        } 
    }
} 
```

# ruby-on-rails - 活动记录关系问题

> ID：16092721
> 
> 赞同：0
> 
> 时间：2013-04-18T20:43:55.820
> 
> 标签：ruby-on-rails, activerecord

假设我有 Profile Model、Test Model 和 TestItem 模型。Profile 有很多 test_item，Test 有一个 test_item。

TestItem 只是表示，该测试已添加到配置文件（通常使用 Cart-Product-LineItem 完成的方式）（因此，当我们将 TestItem 添加到配置文件时，它不是新测试，因为当我们将 LineItem 添加到购物车时，它不是新产品）。

我希望 Profile 有很多 TestItems，但我需要指定，这个 TestItems 应该属于不同的测试。我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:53:29.017

```
class Profile
  has_many :test_items
end

class TestItems
  belongs_to :profile
  belongs_to :test
end

class Test
  attr_accessible :test_item 
end 
```

# grails - 在 grails 中设置 Rabbitmq

> ID：16092726
> 
> 赞同：0
> 
> 时间：2013-04-18T20:44:18.490
> 
> 标签：grails, rabbitmq, grails-plugin-rabbitmq

我遇到了 Rabbitmq 和 grails 的配置问题。我想知道是否有其他人遇到过这种特殊情况。

我在 config.groovy 中的 rabbitmq 配置如下所示：

```
environments {
    production {
        rabbitmq {
            connectionfactory {
                username = '******'
                password = '******'
                hostname = 'ip-******.ec2.internal'

                channelCacheSize = 25
                prefetchCount = 10
                concurrentConsumers = 3
            }
            retryPolicy {
                maxAttempts = 10
            }
            queues = {
                exchange name: 'plover', type: topic, durable: true, {
                    error durable: true, binding: 'error.#'
                    user durable: true, binding: 'user.#'
                    track durable: true, binding: 'track.#'
                    klout durable: true, binding: 'klout.#'
                    showuser durable: false, binding: 'showuser.#'
                    network durable: true, binding: 'network.#'
                    customer durable: true, binding: 'cusotmer.#'
                    recommend durable: true, binding: 'recommend.#'
                    pusher durable: true, binding:'pusher.#'
                    backfill durable: true, binding: 'backfill.#'
                    mail durable: true, binding: 'mail.#'
                    checkaction durable: true, binding: 'checkaction.#'
                    timertasks durable: true, binding: 'timertasks.#'
                    mission durable: true, binding: 'mission.#'
                    sentiment durable: true, binding: 'sentiment.#'
                    updateuser durable: false, binding: 'updateuser.#'
                    googlereader durable: true, binding: 'googlereader.#'
                    flickr durable: true, binding: 'flickr.#'
                }

                exchange name:'pubsub', type: fanout, durable: true
            }
        }
    }

    development {
        rabbitmq {
            connectionfactory {
                username = 'guest'
                password = 'guest'
                hostname = 'localhost'
                channelCacheSize = 25
                prefetchCount = 10
                concurrentConsumers = 3
            }

            retryPolicy {
                maxAttempts = 10
            }

            queues = {
                exchange name: 'plover', type: topic, durable: true, {
                    error durable: true, binding: 'error.#'
                    user durable: true, binding: 'user.#'
                    track durable: true, binding: 'track.#'
                    klout durable: true, binding: 'klout.#'
                    showuser durable: false, binding: 'showuser.#'
                    network durable: true, binding: 'network.#'
                    customer durable: true, binding: 'cusotmer.#'
                    recommend durable: true, binding: 'recommend.#'
                    pusher durable: true, binding:'pusher.#'
                    backfill durable: true, binding: 'backfill.#'
                    mail durable: true, binding: 'mail.#'
                    checkaction durable: true, binding: 'checkaction.#'
                    timertasks durable: true, binding: 'timertasks.#'
                    mission durable: true, binding: 'mission.#'
                    sentiment durable: true, binding: 'sentiment.#'
                    updateuser durable: false, binding: 'updateuser.#'
                    googlereader durable: true, binding: 'googlereader.#'
                    flickr durable: true, binding: 'flickr.#'
                }

                exchange name:'pubsub', type: fanout, durable: true
            }
        }

    }
} 
```

因此，所有 Rabbitmq 配置设置都按预期在生产/开发环境中完成。

但是，当我尝试在生产或本地开发上运行时，我收到以下错误：

> 2013-04-18 13:23:10,583 [pool-7-thread-1] 错误 RabbitmqGrailsPlugin - RabbitMQ 连接工厂设置（rabbitmq.connectionfactory.username、rabbitmq.connectionfactory.password 和 rabbitmq.connectionfactory.hostname）必须在 Config 中定义.groovy

而且我看不到我的配置设置是如何损坏的。grails 环境配置是否按文档说明工作？

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T20:01:44.437

事实证明，我们使用的 Groovy 版本在 ConfigSlurper 中有一个错误，该错误会阻止多个 Environments 块。因此，如果您认为您的 config.groovy 中可能有多个 Environments { Production {} Development {} Test {} } 表达式，那么您会看到相当奇怪的行为。

这个错误有一个 Jira。我相信它将在 Groovy 2.1 中修复，或者如果您希望应用此处提供的补丁。我不太信任补丁，所以我将所有不同的环境组合成一个大表达式（看起来相当难看），它解决了问题。

[https://jira.codehaus.org/browse/GROOVY-5370](https://jira.codehaus.org/browse/GROOVY-5370)

# php - 在 if 语句表达式中设置变量

> ID：16092730
> 
> 赞同：21
> 
> 时间：2013-04-18T20:44:34.110
> 
> 标签：php, if-statement

我今天遇到了一些有趣的代码。我试图找出这是否是 PHP 的一个功能，或者我是否遗漏了某些东西，但在 Google 上找不到任何东西。可能是因为我不知道它的名字。

**代码**

```
if($logo = \Repositories\Logo::getLogoData($id)){
     $logo_href = $logo->link;
} 
```

该变量`$logo`未在其他任何地方设置。似乎此 if 语句中的表达式正在检查该类方法是否返回任何内容并同时设置`$logo`要在语句中使用的变量。

这是真的？如果是这样，这到底叫什么！？！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-18T20:48:08.807

您可以在有条件的情况下进行这样的分配。逻辑上发生的事情是，将值分配给`$logo`然后`$logo`评估它是否为真。如果为真，则执行条件中的代码。

在循环遍历数据库结果集的情况下，您经常会看到这种分配/评估，但通常我建议在这种常见用例之外避免它，以便在阅读 g 代码时清楚起见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:50:33.170

是的，这是一个功能。就像是：

`$a=$b=5;`

但是在这种情况下，想象一下 if as var $a 的 bool 结果。

但是，IDE 经常抱怨这样的解决方案，因为 == vs. = 作为一个非常常见的可能错误源。

# java - 无法启动用 Ant 构建的 jar 文件

> ID：16092731
> 
> 赞同：0
> 
> 时间：2013-04-18T20:44:39.757
> 
> 标签：java, eclipse, ant

我在 Eclipse 中有一个项目，它使用 ant 来编译和 jar 类文件和引用的 jar。使用eclipse中默认java builder生成的class文件生成的jar文件工作正常，但是使用ant编译源码然后jar结果时，报错“错误：尝试打开文件时发生意外错误... ....jar" 在目标构建上执行 java -jar 时产生结果。有谁知道我做错了什么？下面是构建 xml 内容。这是我传递给 ant 的论点

-DInTouchV.SrcPath=${InTouchV.SrcPath} -DInTouchV.DropPath=${workspace_loc:/InTouchVTransferService/dist}

```
<project default="create_run_jar" name="Create Runnable Jar for Project InTouchVTransferService">
<!--this file was created by Eclipse Runnable JAR Export Wizard-->
<!--ANT 1.7 is required                                        -->
<property name="Version" value="1.3"></property> 
<tstamp>
    <format property="TODAY" pattern="yyyy-MM-dd HH:mm:ss" />
</tstamp>
<target name="Compile_Source">
    <javac srcdir="${InTouchV.SrcPath}/InTouchVTransferService/src"
                     destdir="${InTouchV.SrcPath}/InTouchVTransferService/bin"
                     classpath="${InTouchV.SrcPath}/lib/AtomClasses.jar"
                     debug="on"
                    includeantruntime="yes"
                    /> 
</target>
<target name="create_run_jar">
    <mkdir dir="${InTouchV.SrcPath}/InTouchVTransferService/bin"/>     
    <jar destfile="${InTouchV.DropPath}/InTouchVTransferClient.jar" filesetmanifest="mergewithoutmain">
        <manifest>
            <attribute name="Main-Class" value="com.emdat.inTouchV.main.Main"/>
            <attribute name="Class-Path" value="."/>
            <section name="common">
                <attribute name="Build-Version" value="${Version}"/>
                <attribute name="Build-Date" value="${TODAY}"/>
                <attribute name="Built-By" value="${user.name}"/>
                <attribute name="JVM Version" value="${java.runtime.name} - ${java.runtime.version}" />
            </section>
        </manifest>
        <fileset dir="${InTouchV.SrcPath}/InTouchVTransferService/bin"/>
        <zipfileset excludes="META-INF/*.SF" src="${InTouchV.SrcPath}/lib/AtomClasses.jar"/>
    </jar>
    <touch file="${InTouchV.DropPath}/Version.txt" />
    <echo file="${InTouchV.DropPath}/Version.txt">${Version}</echo>
</target>
</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T22:41:39.417

发现问题，属性“JVM Version”包含一个空格。去掉空格，jar文件正确执行。老实说，我不能说为什么 eclipse + ant jar 的默认 java builder 可以与空间一起使用，但 ant build + ant jar 没有。至少它是固定的：D

# python - 您如何检查传递给函数的任何参数是否为无？

> ID：16092733
> 
> 赞同：3
> 
> 时间：2013-04-18T20:44:43.047
> 
> 标签：python

我有一个方法

```
 @staticmethod
    def add_transaction(name, date, amount, debit, user, category_id):
        pass 
```

测试它们中的任何一个是否是 的最佳方法是`None`什么？

```
if not (name or date or amount or debit or user or category_id):
    raise ValueError 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T20:49:42.207

```
if any(arg is None for arg in (name, date, amount, debit, user, category_id))):
    raise ValueError("I hate None") 
```

您需要测试`arg is None`，而不仅仅是使用`not`. 使用，如果任何参数是、、等，`not`您最终会引发异常，这不是您想要的。`False``0``[]`

@DSM 对`if None in (name, date...`作品的建议也是如此 - 取决于您喜欢哪个。

旁注：您的函数需要很多参数。我想知道你是否不能以某种方式重构它——也许你可以创建一个`Transaction`封装这些数据的类，并将这个方法签名更改为`add_transaction(transaction)`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T20:53:13.990

```
if None in (name, date, amount, debit, user, category_id):
    raise ValueError("I haz the Nones") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-18T20:55:38.643

如果这是您计划经常使用的东西，您可能需要考虑使用装饰器：

```
import functools
def None_is_dumb_and_does_not_deserve_to_enter_this_function(func):
    @functools.wraps(func)
    def new_func(*args,**kwargs):
        if None in args:
            raise ValueError("None's aren't welcome here")
        return func(*args,**kwargs)
    return new_func

@None_is_dumb_and_does_not_deserve_to_enter_this_function
def foo(a,b,c):
    """Docstring"""
    print a,b,c

foo(1,2,3)
print foo.__doc__
foo(None,'bar','baz') 
```

如果你打电话，这仍然会发生`foo(1,2,c=3)`。我们可以使用[`decorator`](https://pypi.python.org/pypi/decorator)模块解决这个问题：

```
import decorator

@decorator.decorator
def no_none(f,*args,**kwargs):
    if None in args:
        raise ValueError("None's aren't welcome here")
    return f(*args,**kwargs)

@no_none
def foo(a,b,c):
    """Docstring"""
    print a,b,c

foo(1,2,3)
print foo.__doc__

try:
    foo(None,'bar','baz')
except ValueError as e:
    print ('Good, raised ValueError')

try:
    foo("bar","baz",c=None)
except ValueError as e:
    print ('Good, raised ValueError') 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T20:57:10.457

可以使用装饰器并执行以下操作：

```
from functools import wraps

def no_none(f):
  def wrapper(*args, **kwargs):
    if any(parm is None for parm in args):
      raise ValueError('None not allowed')
    return f(*args, **kwargs)
  return wrapper

class Testing(object):
  @staticmethod
  @no_none
  def add_transaction(name, date, amount, debit, user, category_id):
    pass

Testing.add_transaction(1, 2, 3, 4, 5, 6)
Testing.add_transaction(1, 2, 3, 4, 5, None) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T20:48:53.050

如果 None 会抛出错误，您可以直接使用该函数并根据需要处理错误，而不是提前检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-18T20:50:58.987

```
def add_transaction(**kwargs):
    if None in kwargs.values():
         raise ValueError 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T21:11:18.283

pythonic 的答案是：除非它是从用户输入（或其他程序或子系统或设置文件等）获取数据的子系统入口点，否则*不要*在这种“验证”上浪费时间，而只需使用传入的任何内容。这是调用者的传递有效参数的责任，如果他不这样做，那么尝试使用这些参数无论如何都会引发异常。

# c - MPI_Send/MPI_Recv：元素计数或缓冲区大小？

> ID：16092746
> 
> 赞同：4
> 
> 时间：2013-04-18T20:45:59.160
> 
> 标签：c, mpi

我注意到 MPI_Send 和 MPI_Recv 缓冲区大小的奇怪之处，我无法理解。文档说`count`这些函数的参数描述了**许多类型的元素**`datatype`：

```
int MPI_Send(void *buf, int count, MPI_Datatype datatype, int dest, 
             int tag, MPI_Comm comm); 
```

> count [in] 发送缓冲区中的元素数（非负整数）

```
int MPI_Recv(void *buf, int count, MPI_Datatype datatype, int source, 
             int tag, MPI_Comm comm,  MPI_Status *status); 
```

> count [in] 接收缓冲区中的最大元素数（整数）

假设我们有 2 个进程，第一个（根）进程分配一个由**n 个**整数组成的数组并用一些数据填充它

```
int* temp = (int*) malloc(n * sizeof(int));
for (int i = 0; i < n; i++) temp[i] = ...; 
```

然后将其发送到 rank = 1 的第二个进程。

```
MPI_Send(temp, n, MPI_INT, 1, 0, MPI_COMM_WORLD); 
```

第二个进程接收这个由**n 个**整数组成的数组。

```
MPI_Recv(temp, n, MPI_INT, 0, 0, MPI_COMM_WORLD, MPI_STATUS_INGNORE); 
```

但是在 MPI_Recv 之后，`temp`数组似乎被截断了。当我将`count`参数从更改`n`为 时`n * sizeof(int)`，我收到了一个正确的数组。但是`n * sizeof(int)`以字节为单位描述缓冲区大小，而不是文档中所说的元素。这是一种普遍的行为还是一个简单的误解？PS 我在 Windows 7 上使用 MPICH2 x86 作为 MPI 实现和 32 位 VS08。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-09-07T08:39:42.677

根据
[https://www.open-mpi.org/doc/v1.8/man3/MPI_Recv.3.php](https://www.open-mpi.org/doc/v1.8/man3/MPI_Recv.3.php)，
count 参数保存缓冲区中元素的数量。

> count
> 要接收的最大元素数（整数）。

字节数必须通过乘以元素数（计数）和每个元素的大小（由 MPI_Datatype 类型的常量给出）来计算。

# asp.net-mvc-3 - 我已删除用户的 ACL 权限，但他们仍然可以访问我的视图

> ID：16092754
> 
> 赞同：0
> 
> 时间：2013-04-18T20:46:21.627
> 
> 标签：asp.net-mvc-3, security, asp.net-mvc-3-areas

我希望有人知道我的项目中发生了什么。我有安全问题。这是一个带有区域的 MVC 3 Web 应用程序。我通过 ACL 删除了对一组用户的访问权限。但是，他们仍然能够通过 Web 浏览器查看视图。需要注意的是，他们无权访问 ~/content/* 中的 css 和 js。

我已经运行了 procmon 并且我看到了请求并且用户对应于应用程序池用户。我认为它在我的 web.config 中。我有一个在应用程序的根目录，一个在该区域。它们在这里：这是根目录下的 web.config：

```
<configuration>
    <system.web>

    <httpRuntime maxRequestLength="100000" executionTimeout="300" />
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>

    <authentication mode="Windows" />

    <authorization>
      <deny users="?" />
    </authorization>

    <roleManager enabled="true" defaultProvider="AspNetWindowsTokenRoleProvider">
      <providers>
        <clear/>
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages"/>
      </namespaces>
    </pages>

    <customErrors mode="Off" defaultRedirect="~/Erreur/ErreurTechnique">
      <error statusCode="401" redirect="~/Erreur/AccesRefuse"></error>
      <error statusCode="404" redirect="~/Erreur/PageIntrouvable"></error>
      <error statusCode="500" redirect="~/Erreur/ErreurTechnique"></error>
    </customErrors>

  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>

  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding>
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="None"/>
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
  </system.serviceModel>
</configuration> 
```

这是视图下区域中的 web.config：

```
 <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
      </namespaces>
    </pages>
  </system.web.webPages.razor>

  <appSettings>
    <add key="webpages:Enabled" value="false" />
  </appSettings>

  <system.web>
    <httpHandlers>
      <add path="*" verb="*" type="System.Web.HttpNotFoundHandler"/>
    </httpHandlers>

    <!--
        Enabling request validation in view pages would cause validation to occur
        after the input has already been processed by the controller. By default
        MVC performs request validation before a controller processes the input.
        To change this behavior apply the ValidateInputAttribute to a
        controller or action.
    -->
    <pages
        validateRequest="false"
        pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
        pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
        userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <controls>
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
      </controls>
    </pages>
  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <remove name="BlockViewHandler"/>
      <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler" />
    </handlers>
  </system.webServer>
</configuration> 
```

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:41:31.160

查看[保护您的 ASP.NET MVC 应用程序和新的 AllowAnonymous Attribute](http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx)。

> 您不能使用路由、web.config 文件或 ACL 来保护您的 MVC 应用程序（任何版本）。保护 MVC 应用程序的唯一受支持的方法是应用 Authorize 属性...

[引用](http://blogs.msdn.com/b/rickandy/archive/2010/08/24/securing-your-mvc-application.aspx)

> MVC 使用路由并且不将 URL 映射到 WebForms、PHP 和传统 Web 服务器等物理文件位置。因此，使用 web.config 或 ACL 肯定会在您的站点中打开一个安全漏洞。

[如果以后有变化，产品团队会有沟通，但目前无一例外。](http://forums.asp.net/t/1583850.aspx/1/10)

# macos - 让 Sleepwatcher 守护进程在显示唤醒时运行 - OSX 10.8.3？

> ID：16092760
> 
> 赞同：0
> 
> 时间：2013-04-18T20:46:52.930
> 
> 标签：macos, unix, terminal, macports

我已经在我的 10.8.3 计算机上使用 Macports 安装了 Sleepwatcher，遵循从​​这篇文章中提取的指南 ( [https://discussions.apple.com/message/17966344#17966344](https://discussions.apple.com/message/17966344#17966344) )：

> MacPorts 是安装基于终端的附加组件的最有效和最简单的方法之一。首先，当然要安装 MacPorts，这就像下载一个包并运行它一样简单。
> 
> 1.  要通过 MacPorts 安装 Sleepwatcher，只需在命令行中输入：
>     
>     
>     
>     sudo 端口安装 sleepwatcher
>     
>     
> 
> 然后输入：
> 
> ```
> sudo port load sleepwatcher 
> ```
> 
> 然后会自动安装和加载 Sleepwatcher。
> 
> 1.  您需要将 AppleScript 实际转换为 Shell 脚本（它们不一样）。执行此操作的方法是将其加载到您希望放置在主文件夹中的 .sleep 或 .wakeup 脚本中。执行此操作的方法是执行以下操作： 创建要在计算机进入睡眠/唤醒状态时运行的脚本：
> 
> a.) 输入一个新的终端窗口：
> 
> ```
> cat > $HOME/.wakeup then
> 
> #!/bin/sh 
> ```
> 
> b.) 接下来要了解的是，您可以通过终端运行 Applescripts，通过称为 osascript 的东西，这是终端中给出的命令。如果您的 Applescript 相当简单（只是弹出磁盘或打开新的 Finder 窗口），我会继续用 osascript 语言编写它。要更好地了解这意味着什么，请访问此网站。但是，您似乎已将 Applescript 保存为文件。下一个解决方案可能会更简单一些。以下内容将帮助您从保存的文件中运行 Applescript（假设它是 .scpt 或其他文件）。输入上述命令后，输入：osascript 后跟一个空格。然后将您的 Applescript 文件拖到终端窗口。因此，您的命令应该类似于： osascript /path/to/desired/script
> 
> c.) 按回车键。
> 
> d.) 按 ^D (Ctrl-D)
> 
> e.) 然后输入 chmod +x $HOME/.wakeup

这对我很有用。

但是，我想要的是在显示唤醒时运行一个简单的 Applescript。但是，现在，守护程序仅在从睡眠中唤醒时运行，而不是从显示睡眠中唤醒。如何让它在显示器睡眠唤醒时运行？我可以在终端中做到这一点，但我一生都无法弄清楚如何使用启动守护进程来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-03T18:54:30.570

我自己是这个东西的新手，但是看看 man 文件，你似乎可以更新你的 .plist 文件 ~/Library/LaunchAgents/de.bernhard-baehr.sleepwatcher.plist 使用标志“-W”来表示“displaywakeupcommand” " 而不是 "wakeupcommand" 的 "-w" （除非你可以同时使用两者？）。

# inno-setup - 如何让 Inno Setup 检查文件是否不存在

> ID：16092762
> 
> 赞同：6
> 
> 时间：2013-04-18T20:46:57.473
> 
> 标签：inno-setup, pascalscript

当我编译下面的 Inno Setup 脚本时，它给了我一个错误（如下）。[我从这里](https://stackoverflow.com/questions/12951327/inno-setup-check-if-file-exist-in-destination-or-else-if-doesnt-abort-the-inst)借了代码，所以我不确定为什么它不能正常工作。

```
Line 136:
Column 10:
Invalid prototype for 'FileDoesNotExist' 
```

第 136 行是`function FileDoesNotExist(file: string): Boolean;`

```
[Run]
Filename: "{sys}\regsvr32.exe"; Parameters: "msstdfmt.dll"; WorkingDir: {app}\Pronto\Programs\; BeforeInstall: FileDoesNotExist(ExpandConstant('{sys}\msstdfmt.dll')); StatusMsg: "Registering Controls..."

[Code]
function FileDoesNotExist(file: string): Boolean;
begin
  if (FileExists(file)) then
    begin
      Result := False;
    end
  else
    begin
      Result := True;
    end;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T23:33:02.980

从[Inno Setup 文档](http://www.jrsoftware.org/ishelp/topic_scriptinstall.htm)中：

> 所有的 BeforeInstall 和 AfterInstall 函数**都不能有返回值**。

换句话说，它不能是 a `function`，因为它不能返回任何东西；`procedure`相反。（您可以从链接页面中的示例中看到它们都被声明为`procedure`，并且它们都没有在代码中包含 a `Result`。）

（顺便说一句，您链接的问题也是错误的。它显示 a`procedure`的返回类型为`Boolean`，这当然是不可能的。我怀疑如果它有效，是因为使用的 Pascal 解析器没有注意到返回值因为`procedure`在声明中。）

无论如何，您似乎正在尝试做错事。如果`msstdfmt.dll`与您的 一起分发`setup`，您应该将其添加到设置了和标志的`[Files]`部分。如果它已经安装在用户的系统上，它应该已经注册。`onlyifdoesntexist``regserver`

```
[Files]
Source: "msstdfmt.dll"; DestDir: "{sys}"; Flags: onlyifdoesntexist regserver 
```

# asp.net - 通过asp网站下载Windows Phone应用

> ID：16092763
> 
> 赞同：1
> 
> 时间：2013-04-18T20:46:59.317
> 
> 标签：asp.net, windows-phone-8

我有一个 ASP 网站，我希望用户能够从中下载 Windows Phone 8 应用程序。该应用程序需要存储每个下载它的不同用户的唯一用户帐户。任何想法我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T05:55:03.883

对于从您的网站下载的每个用户，无法在 .xap 文件中存储唯一的 ID。但是你可以试试这个。每次用户从您的网站下载时，为用户分配一个唯一编号/ID。当您启动应用程序时，要求用户输入此号码/ID 作为验证码。并交叉核对这个数字。通过这种方式，您还可以跟踪下载次数和尝试过您的应用的用户数量。

# r - 如何知道您是否可以信任 R 数值积分的输出？

> ID：16092765
> 
> 赞同：2
> 
> 时间：2013-04-18T20:47:09.387
> 
> 标签：r, integration

我无法信任 R 进行数值积分的能力。以下代码：

```
integrand = function(xval) {dnorm(x=xval,mean=0,sd=1)}
integrate(integrand,-Inf,Inf) 
```

正确产生 1 的输出，绝对误差 < 9.4e-05。

但是，如果我只是将分布移动一个常数，

```
integrand2 = function(xval) {dnorm(x=xval,mean=370,sd=1)}
integrate(integrand2,-Inf,Inf) 
```

它没有成功整合概率分布（即积分应该是一）。我得到 4.360019e-15 的答案，绝对误差 < 7.1e-15。

我知道数值积分程序很难找到分布的驼峰，但是我如何判断 R 的输出是否可靠？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T13:55:33.147

谢谢你的问题，亚当。在阅读此页面之前，我不知道这个问题。我会对这个问题提出一个建议，尽管它不是一个完美的答案。集成函数实际上返回一个列表，第 3 项 $subdivisions 可用于衡量可靠性。

```
> integrate(integrand,-Inf,Inf)$subdivisions
[1] 3
> integrate(integrand2,-Inf,Inf)$subdivisions
[1] 1 
```

我说“不完美”，因为值 3 也很小。因此，这种方法高估了不可靠性。也许，它可以用来显示一些警告。详细信息可在[我的博客上](http://tomizonor.wordpress.com/2013/04/23/reliability-of-integrate/)找到。

# android - 尝试从 Eclipse 导出时出现新错误

> ID：16092770
> 
> 赞同：0
> 
> 时间：2013-04-18T20:47:17.880
> 
> 标签：android, eclipse, upload

我和我的朋友刚刚完成了我们的申请，没有任何错误。我们只是要将它从 Eclipse 导出到我们的谷歌帐户。但在能够做到之前，它阻止了我们，说我们必须在上传之前修复错误。错误开始出现在每个 .java 文件上。

每个错误都指的是“类型”。例如： Bundle 无法解析为类型 Activity 无法解析为类型 我已将链接附加到显示问题的文件（就像每个 .java 文件上的一样）

[http://fuskbugg.se/dl/VAYBSP/asd.png](http://fuskbugg.se/dl/VAYBSP/asd.png)

这是清单的一部分，因为正文限制为 30 000 个字符，而我们的清单大约是 87 000：

```
enter code here
    <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.brottsbalken3"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.brottsbalken3.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap1"
        android:label="@string/title_activity_kap1" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para1"
        android:label="@string/title_activity_para1" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para2"
        android:label="@string/title_activity_para2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para3"
        android:label="@string/title_activity_para3" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para4"
        android:label="@string/title_activity_para4" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para5"
        android:label="@string/title_activity_para5" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para6"
        android:label="@string/title_activity_para6" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para7"
        android:label="@string/title_activity_para7" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap2"
        android:label="@string/title_activity_kap2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para21"
        android:label="@string/title_activity_para21" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para22"
        android:label="@string/title_activity_para22" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para23"
        android:label="@string/title_activity_para23" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para24"
        android:label="@string/title_activity_para24" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para25"
        android:label="@string/title_activity_para25" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para25A"
        android:label="@string/title_activity_para25" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para26"
        android:label="@string/title_activity_para26" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para27"
        android:label="@string/title_activity_para27" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para27A"
        android:label="@string/title_activity_para27" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para27B"
        android:label="@string/title_activity_para27_b" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para27C"
        android:label="@string/title_activity_para27_c" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para28"
        android:label="@string/title_activity_para28" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para23A"
        android:label="@string/title_activity_para23" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap3"
        android:label="@string/title_activity_kap3" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para31"
        android:label="@string/title_activity_para31" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para32"
        android:label="@string/title_activity_para32" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para33"
        android:label="@string/title_activity_para33" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para34"
        android:label="@string/title_activity_para34" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para35"
        android:label="@string/title_activity_para35" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para36"
        android:label="@string/title_activity_para36" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para37"
        android:label="@string/title_activity_para37" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para38"
        android:label="@string/title_activity_para38" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para39"
        android:label="@string/title_activity_para39" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para310"
        android:label="@string/title_activity_para310" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para311"
        android:label="@string/title_activity_para311" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para312"
        android:label="@string/title_activity_para312" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para313"
        android:label="@string/title_activity_para313" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap2del2"
        android:label="@string/title_activity_kap2del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap3del2"
        android:label="@string/title_activity_kap3del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap4"
        android:label="@string/title_activity_kap4" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para41"
        android:label="@string/title_activity_para41" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para42"
        android:label="@string/title_activity_para42" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para43"
        android:label="@string/title_activity_para43" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para43A"
        android:label="@string/title_activity_para43" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para43B"
        android:label="@string/title_activity_para43_b" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para44"
        android:label="@string/title_activity_para44" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para45"
        android:label="@string/title_activity_para45" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para46"
        android:label="@string/title_activity_para46" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap4del2"
        android:label="@string/title_activity_kap4del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para41A"
        android:label="@string/title_activity_para41" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para47"
        android:label="@string/title_activity_para47" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para48"
        android:label="@string/title_activity_para48" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para48A"
        android:label="@string/title_activity_para48" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para48B"
        android:label="@string/title_activity_para48_b" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para49C"
        android:label="@string/title_activity_para49_c" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para48C"
        android:label="@string/title_activity_para48_c" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para49"
        android:label="@string/title_activity_para49" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para410"
        android:label="@string/title_activity_para410" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap5"
        android:label="@string/title_activity_kap5" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para51"
        android:label="@string/title_activity_para51" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para52"
        android:label="@string/title_activity_para52" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para53"
        android:label="@string/title_activity_para53" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para54"
        android:label="@string/title_activity_para54" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para55"
        android:label="@string/title_activity_para55" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap6"
        android:label="@string/title_activity_kap6" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para61"
        android:label="@string/title_activity_para61" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para62"
        android:label="@string/title_activity_para62" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para63"
        android:label="@string/title_activity_para63" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para64"
        android:label="@string/title_activity_para64" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para65"
        android:label="@string/title_activity_para65" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para66"
        android:label="@string/title_activity_para66" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para67"
        android:label="@string/title_activity_para67" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para68"
        android:label="@string/title_activity_para68" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap6del2"
        android:label="@string/title_activity_kap6del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para69"
        android:label="@string/title_activity_para69" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para610"
        android:label="@string/title_activity_para610" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para611"
        android:label="@string/title_activity_para611" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para612"
        android:label="@string/title_activity_para612" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para613"
        android:label="@string/title_activity_para613" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para614"
        android:label="@string/title_activity_para614" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para615"
        android:label="@string/title_activity_para615" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para610A"
        android:label="@string/title_activity_para610" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap7"
        android:label="@string/title_activity_kap7" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para71"
        android:label="@string/title_activity_para71" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para72"
        android:label="@string/title_activity_para72" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para73"
        android:label="@string/title_activity_para73" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para74"
        android:label="@string/title_activity_para74" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para75"
        android:label="@string/title_activity_para75" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para76"
        android:label="@string/title_activity_para76" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.MainActivity2"
        android:label="@string/title_activity_main_activity2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap8"
        android:label="@string/title_activity_kap8" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para81"
        android:label="@string/title_activity_para81" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para82"
        android:label="@string/title_activity_para82" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para84"
        android:label="@string/title_activity_para84" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para85"
        android:label="@string/title_activity_para85" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para86"
        android:label="@string/title_activity_para86" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para87"
        android:label="@string/title_activity_para87" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para88"
        android:label="@string/title_activity_para88" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para89"
        android:label="@string/title_activity_para89" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap8del2"
        android:label="@string/title_activity_kap8del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para810"
        android:label="@string/title_activity_para810" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para810A"
        android:label="@string/title_activity_para810" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para811"
        android:label="@string/title_activity_para811" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para812"
        android:label="@string/title_activity_para812" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para813"
        android:label="@string/title_activity_para813" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap9"
        android:label="@string/title_activity_kap9" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para91"
        android:label="@string/title_activity_para91" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para92"
        android:label="@string/title_activity_para92" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para93"
        android:label="@string/title_activity_para93" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para93A"
        android:label="@string/title_activity_para93" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para94"
        android:label="@string/title_activity_para94" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para95"
        android:label="@string/title_activity_para95" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para96"
        android:label="@string/title_activity_para96" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para96A"
        android:label="@string/title_activity_para96" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap9del2"
        android:label="@string/title_activity_kap9del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para97"
        android:label="@string/title_activity_para97" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para97A"
        android:label="@string/title_activity_para97" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para98"
        android:label="@string/title_activity_para98" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para99"
        android:label="@string/title_activity_para99" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para910"
        android:label="@string/title_activity_para910" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para911"
        android:label="@string/title_activity_para911" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para912"
        android:label="@string/title_activity_para912" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap10"
        android:label="@string/title_activity_kap10" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para101"
        android:label="@string/title_activity_para101" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para102"
        android:label="@string/title_activity_para102" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para103"
        android:label="@string/title_activity_para103" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para104"
        android:label="@string/title_activity_para104" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para105"
        android:label="@string/title_activity_para105" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para105A"
        android:label="@string/title_activity_para105" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para105B"
        android:label="@string/title_activity_para105_b" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para105C"
        android:label="@string/title_activity_para105_c" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap10del2"
        android:label="@string/title_activity_kap10del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para105D"
        android:label="@string/title_activity_para105_d" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para105E"
        android:label="@string/title_activity_para105_e" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para106"
        android:label="@string/title_activity_para106" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para107"
        android:label="@string/title_activity_para107" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para108"
        android:label="@string/title_activity_para108" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para109"
        android:label="@string/title_activity_para109" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para1010"
        android:label="@string/title_activity_para1010" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap11"
        android:label="@string/title_activity_kap11" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para111"
        android:label="@string/title_activity_para111" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para112"
        android:label="@string/title_activity_para112" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para113"
        android:label="@string/title_activity_para113" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para114"
        android:label="@string/title_activity_para114" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para115"
        android:label="@string/title_activity_para115" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para116"
        android:label="@string/title_activity_para116" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para117"
        android:label="@string/title_activity_para117" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para118"
        android:label="@string/title_activity_para118" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap12"
        android:label="@string/title_activity_kap12" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para121"
        android:label="@string/title_activity_para121" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para122"
        android:label="@string/title_activity_para122" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para123"
        android:label="@string/title_activity_para123" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para124"
        android:label="@string/title_activity_para124" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para125"
        android:label="@string/title_activity_para125" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para126"
        android:label="@string/title_activity_para126" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap13"
        android:label="@string/title_activity_kap13" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para131"
        android:label="@string/title_activity_para131" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para132"
        android:label="@string/title_activity_para132" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para133"
        android:label="@string/title_activity_para133" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para134"
        android:label="@string/title_activity_para134" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para135"
        android:label="@string/title_activity_para135" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para135A"
        android:label="@string/title_activity_para135" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para135B"
        android:label="@string/title_activity_para135_b" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para136"
        android:label="@string/title_activity_para136" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Kap13del2"
        android:label="@string/title_activity_kap13del2" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para137"
        android:label="@string/title_activity_para137" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para138"
        android:label="@string/title_activity_para138" >
    </activity>
    <activity
        android:name="com.example.brottsbalken3.Para139"
        android:label="@string/title_activity_para139" > 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:22:39.057

你的清单搞砸了。这就是为什么错误谈论

> 根元素之前的标记

当您尝试将其上传到 App Engine 时，Eclipse 将您的应用程序重新配置为与该环境兼容！您需要将项目重新创建为 Android 应用程序并跳过尝试将其上传到 App Engine 的部分。

查看[此站点](http://developer.android.com/tools/publishing/publishing_overview.html)以了解发布 Android 应用程序需要采取哪些步骤。

# c# - 仅在 Windows XP 上需要帮助诊断失败的 P/Invoke 调用

> ID：16092774
> 
> 赞同：1
> 
> 时间：2013-04-18T20:47:25.457
> 
> 标签：c#, .net, pinvoke

我定义了以下 P/Invoke：

```
[DllImport("helper.dll", CallingConvention=CallingConvention.Cdecl, 
    CharSet=CharSet.Ansi, EntryPoint="F_GetValue")]
private static extern Int32 _F_GetValue(String Formula, ref DATA_STRUCT Data,
    ref DATA_KEY DefaultKeyBuf, ref Double Result); 
```

此调用在 Windows Vista 及更高版本上成功，但在 Windows XP 上失败并出现以下内存异常：

```
A first chance exception of type 'System.AccessViolationException' occurred 
in helper.dll 
```

我尝试将前两个“ref”修饰符更改为 [In, Out] 但这并没有解决问题。

DATA_STRUCT 和 DATA_KEY 都是实例化和预填充的结构。

这是我正在调用的 C++ 方法定义：

```
int F_GetValue(const char* pFormula, DATA_STRUCT* pData, 
    DATA_KEY* pDefaultKeyBuf, double* freturn) 
```

我不是 P/invoke 大师，所以不要假设任何事情。这个定义的方式有什么明显的错误吗？是否有更多的封送处理（手动）？我觉得我可能遗漏了一些明显的东西。

编辑：根据要求，这里分别是 .NET 中的结构定义、C++ F_GetValue() 方法和 C++ 结构定义：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi, Pack = 1)]
public struct DATA_STRUCT
{
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
    public String DataDir;
    [MarshalAs(UnmanagedType.U2)]
    public UInt16 LTType;
    [MarshalAs(UnmanagedType.U2)]
    public UInt16 FOMType;
    [MarshalAs(UnmanagedType.U2)]
    public UInt16 ResultType;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 136)] // ( POS_BLOCK_SIZE + sizeof(int) + 4 )
    public Byte[] posBlock;
    public DATA_REC dataBuf;
    [MarshalAs(UnmanagedType.U2)]
    public UInt16 dataLen;
    [MarshalAs(UnmanagedType.U2)]
    public UInt16 keyNum;
    public DATA_KEY keyBuf;
    [MarshalAs(UnmanagedType.U2)]
    public UInt16 TNTC;
    [MarshalAs(UnmanagedType.I2)]
    public Int16 status;
}

[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi, Pack = 1)]
public struct DATA_KEY
{
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 17)]
    public String LocName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 17)]
    public String ParName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 13)]
    public String DateTime;
}

int F_GetValue(const char* pFormula, DATA_STRUCT* pData, DATA_KEY* pDefaultKeyBuf, double* freturn)
{

    if (pFormula[0] == 0) // return quickly if nothing to do
    {
        *freturn = blank;
        pData->ResultType = sbit(DATA_BLANK);
        pData->status = B_NO_ERROR;
        return 0;
    }

    if ((_strnicmp(pFormula, "DOTNET_", 7) == 0) || (_strnicmp(pFormula, "(DOTNET_", 7) == 0)) // switch to/from dotnet
    {
        dotnetCalcs = (_strnicmp(pFormula + 7 + ((pFormula[0] == '(') ? 1 : 0), "ON", 2) == 0);
        *freturn = dotnetCalcs ? 1 : 0;
        pData->ResultType = sbit(DATA);
        pData->status = B_NO_ERROR;
        return strlen(pFormula);
    }

    BOOL bComingFromDotNet = (pData->dataLen == 65535);
    if (dotnetCalcs && (!bComingFromDotNet))
    {
        return F_GetValue2(pFormula, pData, pDefaultKeyBuf, freturn);
    }

    if (pSharedMem->bClient && ! bServer)
    {
        if (FromServer(ACTION_OPEN,NULL) == B_NO_ERROR)
        {
            ((CS_FORMULA *)pSharedMem->ClientServer)->nRecords = 1;
            strcpy(((CS_FORMULA *)pSharedMem->ClientServer)->DataDir,pData->DataDir);
            memcpy(&((CS_FORMULA *)pSharedMem->ClientServer)->Formula[0].DefaultKeyBuf,pDefaultKeyBuf,sizeof(DATA_KEY));
            strcpy(((CS_FORMULA *)pSharedMem->ClientServer)->Formula[0].Formula,pFormula);
            ((CS_FORMULA *)pSharedMem->ClientServer)->iType = CSTYPE_FORMULA;
            ((CS_FORMULA *)pSharedMem->ClientServer)->iAction = ACTION_READ;
            if (FromServer(ACTION_READ,NULL) == B_NO_ERROR)
            {
                *freturn = ((CS_FORMULA_RESULT *)pSharedMem->ClientServer)->Data[0].Data;
                pData->ResultType = ((CS_FORMULA_RESULT *)pSharedMem->ClientServer)->Data[0].ResultType;
                pData->status = ((CS_FORMULA_RESULT *)pSharedMem->ClientServer)->Data[0].status;

                FromServer(ACTION_CLOSE,NULL);
                return strlen(pFormula);
            }
            FromServer(ACTION_CLOSE,NULL);
        }
        *freturn = blank;
        return 0;
    }
    else
    {
        BOOL bOpenTemporaryData = bComingFromDotNet || (pData->dataLen == 0);
        if (bOpenTemporaryData)
        {
            DataOpenAndInitialize(pData,NULL);
        }

        int iReturn = F_DoGetValue(pFormula,pData,pDefaultKeyBuf,freturn);

        if (bOpenTemporaryData)
            DataExec(B_CLOSE,pData);

        return iReturn;
    }
}

typedef struct
{
    char DataDir[MAX_PATH];
    unsigned short LTType; 
    unsigned short FOMType; 
    unsigned short ResultType; 
    BTI_BYTE posBlock[POS_BLOCK_SIZE_];
    DATA_REC dataBuf;
    BTI_WORD dataLen;
    BTI_WORD keyNum;
    DATA_KEY keyBuf;
    unsigned short TNTC;
    BTI_SINT status;
} DATA_STRUCT;

typedef struct
{
char    LocName[LP_SIZE];
char    ParName[LP_SIZE];
char    DateTime[13];
} DATA_KEY; 
```

为了完整起见，我还包括了这个方法，F_GetValue2()，它在 F_GetValue() 中调用。虽然这看起来好像可以直接运行回托管代码，但它不会。这个方法的存在是为了不同的目的，我不能保证在我的 XP 问题的情况下它不会被调用，因为它需要 (dotnetCalcs && (!bComingFromDotNet)) 为真，但事实并非如此。

还有一件事，其中调用的另一个方法是 F_DoGetValue()，然后将一组参数传递给它。这个方法很大，所以我不会在这里发布。但只要说它解析 Formula 并使用它所学的调用更多的方法就足够了，这些方法使用解析的字符串从数据库中获取数据，将 Double 成员 fReturn 返回到链上，直到最终返回到通过封送处理的 C# 代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T11:16:05.930

```
 [StructLayout(..., Pack = 1)] 
```

C 代码中没有可见的#pragma 包，本机代码中的结构包装实际上为 1 的可能性很低。默认值为 8，与 [StructLayout] 的默认值相同。最低限度的完整性检查是 C# 中结构类型上的 Marshal.SizeOf() 返回的值与 C 代码中的 sizeof() 完全相同。当存在不匹配并且确实可能​​出现随机 AV 时，它将无法正常工作。

并使用调试器诊断 AV。项目 + 属性，调试选项卡，勾选非托管代码调试选项，以便您可以调试 C# 和 C 代码。在 C 函数的第一条语句上设置断点。并检查传递的结构指针的调试视图是否与您在 C# 代码中分配的数据相匹配。故障通常位于结构末端附近。Debug + Exceptions，勾选Win32异常的抛出框，让调试器在AV异常发生时停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T15:03:09.030

最后，这个问题与证据表明的完全不同（尤其是考虑到我对 P/Invoke 的了解程度）。事实上，问题是使用这个声明的结果：

```
__declspec( thread ) BOOL dotnetCalcs = FALSE; 
```

进入代码后，我发现它在这一行失败了：

```
if (dotnetCalcs && (!bComingFromDotNet)) 
```

成员“dotnetCalcs”被声明为线程本地存储，经过一番研究，它似乎是 XP 上的一个已知故障。我发现的一个示例线索是此 MSDN 页面末尾的评论：

[http://msdn.microsoft.com/en-us/library/9w1sdazb(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/9w1sdazb(v=vs.80).aspx)

关于延迟加载的部分适用于这种情况，因为由于 DllImport 正在加载有问题的 DLL。

感谢所有回复的人，我很抱歉导致了一场鹅追逐。但最终，设置一个专门的调试站的麻烦证明是值得的。

修复：

将 __declspec(thread) 方法替换为对 TLS 方法的调用。在 DllMain() 中，我建立了一个 TLS 索引并全局保存它，使用 TlsSetValue() 设置初始值。然后所有后续请求者都使用该索引通过 TlsGetValue() 检索 TLS 值。每当值更改时，只需再次使用 TlsGetValue() 来设置值。永远记住使用 LPVOID 进行投射，因为这是这些使用的类型。

# c++ - 在没有 & 的情况下将 unsigned char* 转换为 unsigned char**

> ID：16092777
> 
> 赞同：2
> 
> 时间：2013-04-18T20:47:40.443
> 
> 标签：c++, pointers, casting

我有这段代码

```
unsigned char* MemoryPool::GetNext(unsigned char* pBlock)
{
unsigned char** ppChunkHeader = (unsigned char**)pBlock;
return ppChunkHeader[0];
} 
```

取自这里[http://gamecode4.googlecode.com/svn/trunk/Source/GCC4/Memory/MemoryPool.cpp](http://gamecode4.googlecode.com/svn/trunk/Source/GCC4/Memory/MemoryPool.cpp)

我不知道从 unsigned char* 转换为 unsigned char** 的作用。如果我添加这些代码行：

```
unsigned char* MemoryPool::GetNext(unsigned char* pBlock)
{
    unsigned char **ppChunkHeader = (unsigned char**)pBlock;

    printf("ppChunkHeader %p\n", ppChunkHeader);
    printf("pBlock %p\n", pBlock);

    printf("sizeof(unsigned char*) = %i\n", sizeof(unsigned char*));

    printf("ppChunkHeader[0] %p\n", ppChunkHeader[0]);
    printf("&pBlock[0] %p\n", &pBlock[0]);

    printf("ppChunkHeader[0] - &pBlock[0] = %p\n", (ppChunkHeader[0] - &pBlock[0]));

    return ppChunkHeader[0];
} 
```

输出是

```
ppChunkHeader 00DCB498
pBlock 00DCB498
sizeof(unsigned char*) = 4
ppChunkHeader[0] 00DCB4A1
&pBlock[0] 00DCB4A1
ppChunkHeader[0] - &pBlock[0] = 00000009 
```

我认为值得一提的是，在我的代码中，pBlock 指向一个由 9 个元素组成的数组。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:54:13.453

不看下一行代码就无法理解演员表

```
unsigned char** ppChunkHeader = (unsigned char**)pBlock;
return ppChunkHeader[0]; 
```

pBlock 是一块内存，下一行的强制转换和取消引用所做的是获取该块的前四个字节，并将其视为另一个指针。然后从函数返回第二个指针。

您可以看到强制转换不会改变指针的值，ppChunkHeader 和 pBlock 是相同的值。不同的是他们所指向的内容是如何被解释的。如果你写

```
return pBlock[0]; 
```

那将只是一个字符，因为 pBlock 是一个无符号字符 *。但是 ppChunkHeader[0] 是一个 unsigned char*，因为 ppChunkHeader 是一个 unsigned char**。

# powershell - PSRemoting 使用 get-childItem 处理性能开销

> ID：16092778
> 
> 赞同：4
> 
> 时间：2013-04-18T20:47:53.013
> 
> 标签：powershell, powershell-3.0, powershell-remoting, get-childitem

这在 LOCALSERVER 上在 2.3 分钟内完成：

A： `measure-command {$x = invoke-command {gci -recurse "C:\"}}`

这在 LOCALSERVER 上在 38.4 分钟内完成：

乙： `measure-command {$x = invoke-command -comp LOCALSERVER {gci -recurse "C:\"}}`

为什么B这么慢？是因为“输出被序列化为 XML，然后再次重组为对象”，如此[处](https://stackoverflow.com/a/5343767/1751302)所述，使用 B 而不是 A？还是发生了其他事情？

LOCALSERVER 运行带有 PS v3 的 Windows 2008R2。在这两种情况下`$x.count`都是 98973。

我想知道如何更改现有脚本以使用 PSRemoting 在远程服务器上进行文件搜索。我认为在远程目标上运行 gci 可能会更快完成搜索。在少数测试中，使用 PSRemoting 的搜索实际上运行的时间要长得多。我询问环回方案只是因为它似乎是最简单的情况；我在远程服务器上看到了类似的结果。所以我会坚持使用这样的 UNC 路径搜索：

```
gci -recurse \\REMOTESERVER\C$\folder 
```

...除非这些结果看起来很奇怪，并且对我的远程配置或语法进行一些调整可能会大大提高性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T16:30:00.740

在返回完整对象和仅获取字符串列表之间的某个位置，如果远程系统正在运行 V3，您可以通过 json 获得浅层反序列化：

```
ConvertFrom-Json (icm -comp server { gci -rec c:\ | convertto-json -Depth 1}) 
```

编辑：

转换为/从 csv 为您提供一个（浅）反序列化对象，并且实际运行速度似乎比输出字符串快：

```
ConvertFrom-csv (icm -comp server { gci -rec c:\ | convertto-csv}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T14:11:12.133

正如您所提到的，远程调用命令所需的时间还必须考虑反序列化从远程管道返回的任何给定对象（在您的情况下是 C 驱动器的 FileSystemInfo 的整个树）所需的时间。我建议限制您通过网络序列化和反序列化的对象数量，并且在比较服务器的性能时，也许考虑在您运行代码的机器上花费的时间：

```
Invoke-Command -comp LOCALSERVER { Measure-Command { gci -recurse "C:\" } } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T14:06:59.003

是的，您对通过网络对`FileInfo`and`DirectoryInfo`对象进行序列化/反序列化的开销是正确的。如果您不关心获取真实对象，请执行以下操作：

```
icm -comp server { gci -rec c:\ | out-string } 
```

至少应该快一个数量级。

# c# - 对象属性未修改

> ID：16092779
> 
> 赞同：1
> 
> 时间：2013-04-18T20:47:54.093
> 
> 标签：c#, entity-framework

我得到了 WCF 服务，并且我使用实体框架与数据库进行通信。

当然我不能返回我的实体对象，所以我创建了 WCF 对象。

在这段代码中，我使用 EF 获取数据，这很好..但是当我使用 for each 语句时，usersForClient 总是被分配为空。这在最后返回一个空列表，但 usersList 充满了用户。

```
UserMethods userMethods = new UserMethods();
List<Users> usersList = userMethods.getUsersByLastName(pLastName);
List<wcfUser> usersListForClient = new List<wcfUser>();
wcfUser usersForClient = new wcfUser();

foreach (Users u in usersList)
{
    usersForClient = new wcfUser();
    usersForClient = TranslateServerUserToClientUser(u,usersForClient);
    usersListForClient.Add(usersForClient);
}

return usersListForClient; 
```

这是我的翻译方法：

```
private wcfUser TranslateServerUserToClientUser(Users serverSideUser, wcfUser clientSideUser)
{
    clientSideUser.Age = serverSideUser.Age;
    clientSideUser.Email = serverSideUser.Email;
    clientSideUser.DateJoined = serverSideUser.DateJoined;
    clientSideUser.LastName = serverSideUser.LastName;
    clientSideUser.Name = serverSideUser.Name;
    clientSideUser.UserName = serverSideUser.UserName;
    clientSideUser.IdUser = serverSideUser.IdUser;
    clientSideUser.DateLastLogin = serverSideUser.DateLastLogin;
    clientSideUser.ProfilePicture = serverSideUser.ProfilePicture;
    return clientSideUser;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:18:00.690

尝试将关键字放在arg`ref`前面。`wcfUser clientSideUser`它应该看起来像

```
User TranslateServerUserToClientUser(Users serverSideUser, ref wcfUser clientSideUser) 
```

# javascript - 将值从 jsp（java 代码> 传递到 javascript

> ID：16092790
> 
> 赞同：0
> 
> 时间：2013-04-18T20:48:48.207
> 
> 标签：javascript, jsp

我有一个名为 page.jsp 的 jsp 文件，其中有以下代码：

```
<%@page import="soundcap.Soundcap"%> 

<%
Soundcap cfl = new Soundcap();
String sfl = cfl.playFile();
%> 
```

我需要 javascript 文件 jscript.js 中的 sfl 值

问题：如何从 jsp 传递 sfl 并在 javascript 中接收此值？

我在 javascript 中尝试过 <%= sfl %> 但没有用。我在 jsp (session.setAttribute("sfl",sfl) ) 中设置了会话，并试图在 javascript (<%= session('sfl'%>) 中检索它，但它没有用。请你帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:53:18.760

```
<%@page import="soundcap.Soundcap"%> <%    Soundcap cfl = new Soundcap();
%>
<script>
var sfl = "<%= cfl.playFile(); %>";
</script> 
```

# c - 服务器客户端聊天程序。显示在线用户

> ID：16092796
> 
> 赞同：1
> 
> 时间：2013-04-18T20:49:00.373
> 
> 标签：c, networking, client, chat

我正在尝试将服务器中的在线用户显示给客户端。我已经声明了一个client_struct，它在客户端连接时存储必要的信息。每次用户通过身份验证并希望与服务器通信时，我都会派生一个子进程。但是，当第二个用户连接到服务器时，客户端程序只显示 1 个当前在线用户并停止工作。任何原因？现在已经连续 4 小时破解代码了。

服务器

```
/*
    C socket server example
*/

#include<stdio.h>
#include<string.h>  //strlen
#include<sys/socket.h>
#include<arpa/inet.h>   //inet_addr
#include<unistd.h>  //write
struct client_struct{
    char ip[20];
    char username[20];
    char password[20];
    int busy;
    int online;
    int user_number;

};
struct client_struct client_database[25];
char users_online[20][20];
int user_count=0;
int main(int argc , char *argv[])
{
    int socket_desc , client_sock , c , read_size,i,j=0,not_valid=1,l;
    struct sockaddr_in server , client;
    char client_message[2000],username_database[25][25],password_database[25][25],str[INET_ADDRSTRLEN],username[20],password[20],garbage[20];
    unsigned long clients[25];

    strcpy(client_database[0].username,"rushabh");
    strcpy(client_database[0].password,"nagda");
    //client_database[0].busy=0;
    //client_database[0].online=0;
    //client_database[0].user_number=0;
    strcpy(client_database[1].username,"sahil");
    strcpy(client_database[1].password,"gill");
    //client_database[1].busy=0;
    //client_database[1].online=0;
    //client_database[1].user_number=0;
    strcpy(client_database[2].username,"panty");
    strcpy(client_database[2].password,"avi");
    //client_database[2].busy=0;
    //client_database[2].online=0;
    //client_database[2].user_number=0;

    //Create socket
    socket_desc = socket(AF_INET , SOCK_STREAM , 0);
    if (socket_desc == -1)
    {
        printf("Could not create socket");
    }
    puts("Socket created");

    //Prepare the sockaddr_in structure
    server.sin_family = AF_INET;
    server.sin_addr.s_addr = INADDR_ANY;
    server.sin_port = htons( 8888 );

    //Bind
    if( bind(socket_desc,(struct sockaddr *)&server , sizeof(server)) < 0)
    {
        //print the error message
        perror("bind failed. Error");
        return 1;
    }
    puts("bind done");

    //Listen
    listen(socket_desc , 3);

    //Accept and incoming connection
    puts("Waiting for incoming connections...");
    c = sizeof(struct sockaddr_in);

    //accept connection from an incoming client
    while(1)
    {
        client_sock = accept(socket_desc, (struct sockaddr *)&client, (socklen_t*)&c);
        //Incrementing usercount
        inet_ntop(AF_INET, &(client.sin_addr), str, INET_ADDRSTRLEN); //extracting ip address
        printf("%s\n", str); // prints "192.0.2.33"
        //if(fork()==0) //remember that this is wrong!
        //{
            //printf("%u\n",client.sin_addr.s_addr);
            //clients[user_count]=client.sin_addr.s_addr;

            if (client_sock < 0)
            {
                perror("accept failed");
                return 1;
            }
            puts("Connection accepted");
            //User authentication
            write(client_sock,"Please enter username:",strlen("Please enter username\n"));
            recv(client_sock,username,20,0);

            write(client_sock,"Please enter password:",strlen("Please enter password\n"));
            recv(client_sock,password,20,0);

            //Authentication
            for(j=0;j<3;j++)
            {
                //printf("%s %s %s %s\n",client_database[j].username,username,client_database[j].password,password);
                if(!(strcmp(client_database[j].username,username)) ||
                    !(strcmp(client_database[j].password,password)))
                {
                    printf("yay!\n");
                    write(client_sock,"Authenticated\n",strlen("Authenticated\n"));
                    recv(client_sock,garbage,20,0);
                    client_database[j].online=1;
                    client_database[j].busy=0;
                    strcpy(client_database[j].ip,str);
                    not_valid=0;
                    break;

                }

            }   

            if(not_valid==1)
            {
                write(client_sock,"Invalid username or password\n",strlen("Invalid username or password\n"));
                recv(client_sock,garbage,20,0);
                return(0);
            }

            if(fork()==0)
            {
                write(client_sock,"The online users are",strlen("The online users are"));
                recv(client_sock,garbage,20,0);
                for(l=0;l<20;l++)
                {
                    if(client_database[l].online==1)
                    {
                        write(client_sock,client_database[l].username,strlen(client_database[l].username));
                        recv(client_sock,garbage,20,0);
                    }
                    else
                    {
                        printf("%s %d\n",client_database[l].username,client_database[l].online);
                        write(client_sock,"garbage",strlen("garbage"));
                        recv(client_sock,garbage,20,0);
                    }
                }

                //Receive a message from client

                while( (read_size = recv(client_sock , client_message , 2000 , 0)) > 0 )
                {
                    //Send the message back to client
                    write(client_sock , client_message , strlen(client_message));
                    puts(client_message);
                    memset(&client_message[0], 0, sizeof(client_message));

                }

                if(read_size == 0)
                {
                    puts("Client disconnected");
                    fflush(stdout);
                }
                else if(read_size == -1)
                {
                    perror("recv failed");
                }
            }
        //}
    }
    return 0;
} 
```

客户

```
/*
    C ECHO client example using sockets
*/
#include<stdio.h>   //printf
#include<string.h>  //strlen
#include<sys/socket.h>  //socket
#include<arpa/inet.h>   //inet_addr

int main(int argc , char *argv[])
{
    int sock,i=0,username_counter=0;
    struct sockaddr_in server;
    char message[1000] , server_reply[2000],server_reply1[2000];

    //Create socket
    sock = socket(AF_INET , SOCK_STREAM , 0);
    printf("%d\n",sock);
    if (sock == -1)
    {
        printf("Could not create socket");
    }
    puts("Socket created");

    server.sin_addr.s_addr = inet_addr("127.0.0.1");
    server.sin_family = AF_INET;
    server.sin_port = htons( 8888 );

    //Connect to remote server
    if (connect(sock , (struct sockaddr *)&server , sizeof(server)) < 0)
    {
        perror("connect failed. Error");
        return 1;
    }

    puts("Connected\n");

    while(1)
    {
        recv(sock,server_reply,2000,0); //rec username
        puts(server_reply);
        scanf("%s",message);
        send(sock,message,strlen(message),0);
        memset(&server_reply[0], 0, sizeof(server_reply));

        recv(sock,server_reply,2000,0); //recv password
        puts(server_reply);
        scanf("%s",message);
        send(sock,message,strlen(message),0);
        memset(&server_reply[0], 0, sizeof(server_reply));

        recv(sock,server_reply,2000,0); //auth
        puts(server_reply);
        send(sock,"foo",strlen("foo"),0);
        memset(&server_reply[0], 0, sizeof(server_reply));

        recv(sock,server_reply,2000,0); //online users
        puts(server_reply);
        send(sock,"foo",strlen("foo"),0);
        memset(&server_reply[0], 0, sizeof(server_reply));

        while(1)
        {
            if(username_counter==20)
            {
                break;
            }
            recv(sock,server_reply,2000,0);
            if(strcmp(server_reply,"garbage"))
                puts(server_reply);
            memset(&server_reply[0], 0, sizeof(server_reply));
            send(sock,"foo",strlen("foo"),0);
            username_counter++;
        }

        /*memset(&server_reply[0], 0, sizeof(server_reply));
        recv(sock,server_reply,2000,0);
        puts(server_reply);
        memset(&server_reply[0], 0, sizeof(server_reply));
        recv(sock,server_reply,2000,0);
        puts(server_reply);*/
        break;
    }
    printf("Authenticated\n");
    memset(&server_reply[0], 0, sizeof(server_reply));
    //keep communicating with server
    while(1)
    {
        printf("Enter message : ");
        scanf("%s" , message);

        //Send some data
        if( send(sock , message , strlen(message) , 0) < 0)
        {
            puts("Send failed");
            return 1;
        }

        //Receive a reply from the server
        if( recv(sock , server_reply , 2000 , 0) < 0)
        {
            puts("recv failed");
            break;
        }

        puts("Server reply :");
        puts(server_reply);

        memset(&server_reply[0], 0, sizeof(server_reply));
    }

    close(sock);
    return 0;
} 
```

# opencv - 使用 openCV 2.4.3 从罗技 c920 以 30fps 捕获 1080p

> ID：16092802
> 
> 赞同：23
> 
> 时间：2013-04-18T20:49:20.453
> 
> 标签：opencv, logitech

我正在尝试在 OpenCV 中从我的 Logitech C920 捕获视频流。使用 Labview，我可以访问 30fps 1080p 的 MJPG 流。在 opencv 中，我被限制为 5fps 或 640x480。

这是与相机设置相关的代码：

```
this->camRef.set(CV_CAP_PROP_FRAME_WIDTH, 1920);
this->camRef.set(CV_CAP_PROP_FRAME_HEIGHT, 1080);
this->camRef.set(CV_CAP_PROP_FOURCC,CV_FOURCC('M','J','P','G')); 
```

这些都返回 1，但我得到了一个 1080p 的 5fps 流，它对应于 YUY2 流。
如果我添加以下行：

```
this->camRef.set(CV_CAP_PROP_FPS, 30); 
```

这将返回 0。我在 640x480 处获得了 30 fps 的流。对我来说，看起来 MJPG 设置不被接受，但我不知道该怎么做或如何解决这个问题。

编辑：以下使程序崩溃。

```
 this->camRef.read(this->image);
 std::cout<< this->camRef.get(CV_CAP_PROP_FOURCC)                            << std::endl;
 std::cout<< this->camRef.set(CV_CAP_PROP_FRAME_WIDTH, config.width)         << std::endl;
 std::cout<< this->camRef.set(CV_CAP_PROP_FRAME_HEIGHT, config.height)       << std::endl;
 std::cout<< this->camRef.set(CV_CAP_PROP_FOURCC,CV_FOURCC('M','J','P','G')) << std::endl;
 std::cout<< this->camRef.get(CV_CAP_PROP_FOURCC)                            << std::endl; 
```

然后在我的运行代码中，我有以下内容：

```
void camera::run()
{
    while(true)
    {
        if(this->camRef.read(this->image) == 0)
        {
           if(this->capture)
            {
                cv::imwrite(fileName,this->image);
                this->count++;
            }
        }
        msleep(15);
    }
} 
```

EDIT2：解决方案是在设置相机高度和宽度之前设置fourCC编解码器。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-06-10T07:31:48.590

由于帖子的作者已经找到了解决方案，但没有将其添加为答案，我将把解决方案放在这里。

您必须在设置所需分辨率之前设置编解码器：

```
this->camRef.set(CV_CAP_PROP_FOURCC,CV_FOURCC('M','J','P','G'));
this->camRef.set(CV_CAP_PROP_FRAME_WIDTH, 1920);
this->camRef.set(CV_CAP_PROP_FRAME_HEIGHT, 1080); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-19T15:46:03.690

使用罗技 c922，需要：

```
capture.open(CV_CAP_DSHOW);
capture.set(CV_CAP_PROP_FOURCC, CV_FOURCC('M', 'J', 'P', 'G'));
capture.set(CV_CAP_PROP_FRAME_WIDTH, 1920);
capture.set(CV_CAP_PROP_FRAME_HEIGHT, 1080); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T22:56:13.783

在设置任何内容之前尝试从捕获中获取第一帧：

```
VideoCapture cap(0);
if(!cap.isOpened()) 
return -1;  

Mat frame;
cap >> frame;
double fps;
cap.set(CV_CAP_PROP_FRAME_HEIGHT, 1080.0);
cap.set(CV_CAP_PROP_FRAME_WIDTH, 1920.0);
//add the loop here 
```

并检查它是否可以在不设置 MJPG 的情况下工作。如果可行，请尝试使用 MJPG。

对我来说，在设置任何内容之前必须先获取第一帧有点奇怪，但这是它为我工作的唯一方法（Windows 7 32 位）。

***//编辑：***
你可能会尝试使用不同的 API - 请参阅我的答案的第二部分： [https](https://stackoverflow.com/a/14188280/1598485) : //stackoverflow.com/a/14188280/1598485 OpenCV 正在尝试默认使用最好的 API，但可能在你的情况下一些其他 API 会更好。

# php - 使选择选项只是链接

> ID：16092804
> 
> 赞同：0
> 
> 时间：2013-04-18T20:49:20.923
> 
> 标签：php, jquery, html, select, hyperlink

我有下面的脚本，让用户选择一个“文件夹”，然后 jquery 代码监听并显示代码。现在代码在一个选择框中，但我希望它们只显示为链接。这可能吗？

这是jQuery：

```
 <script type="text/javascript">
$(document).ready(function () {
    $("#theselect").change(function() {
var option = $(this).val();
var selectedUser = $("#thename").val();
$.get("selectfolders.php", {select:option,username:selectedUser},function(data){
    $("#theresult").html(data).hide().fadeIn(1000);
});
});
});
</script> 
```

这是查找和显示所有用户文件夹的 php 代码：（这是我想要的链接而不是选择框。）

```
<select name="theselect" id="theselect">
<option value="">Select</option>
<?
$thelistquery = mysql_query("SELECT * FROM folders WHERE username='$username'");
while ($lrows = mysql_fetch_array($thelistquery)) {
$id = $lrows['ID'];
$foldername = $lrows['foldername'];
$newfoldername = mysql_real_escape_string($foldername);

echo "<option value='$newfoldername'>$newfoldername</option>";
}
?>
</select> 
```

选择文件夹.php

```
$username = $_GET['username'];
$theselect = $_GET['select'];

$thelistquery = mysql_query("SELECT * FROM folders WHERE username='$username'");
while ($lrows = mysql_fetch_array($thelistquery)) {
$id = $lrows['ID'];
$foldername = $lrows['foldername'];
$newfoldername = mysql_real_escape_string($foldername);

if($_GET['select'] == "$newfoldername") {
//What to display
}
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:15:37.677

更改 jQuery 以处理标签单击事件而不是更改事件。请注意，“.folders”选择器是我添加到标签中的类，因此您无需使用引用页面上所有标签的选择器。

```
<script type="text/javascript">
$(document).ready(function () {
 $(".folders").click(function() {    //<-------Changes here
 var option = $(this).val();
 var selectedUser = $("#thename").val();
 $.get("selectfolders.php", {select:option,username:selectedUser},function(data){
  $("#theresult").html(data).hide().fadeIn(1000);
  });
 });
});
</script> 
```

通过删除周围的标签并将标签更改为标签，修改了输出以显示链接。还添加了一个类以使用 jQuery 轻松选择它。

```
$thelistquery = mysql_query("SELECT * FROM folders WHERE username='$username'");
while ($lrows = mysql_fetch_array($thelistquery)) {
 $id = $lrows['ID'];
 $foldername = $lrows['foldername'];
 $newfoldername = mysql_real_escape_string($foldername);

 //Changed the below to a link with a class
 echo "<a class='folders' value='$newfoldername'>$newfoldername</a>";
}
echo "<input type='text' value='$username' name='thename' />"; 
```

# javascript - 使用 jquery 进行数值验证

> ID：16092805
> 
> 赞同：0
> 
> 时间：2013-04-18T20:49:28.133
> 
> 标签：javascript, jquery, validation, math, percentage

我正在尝试用 javascript/jquery 创建一些东西。

每次我点击假的验证“按钮”时，我都试图让最终值减去一个数字。在这种情况下，我选择了数字 1。另外，我可以在数字上使用百分比符号吗？

基本上，表格中会有一个由某人输入的数字。然后，一旦他们点击“验证”，最终的总数就会从中减去那个数字。

已经有一组单选按钮可以确定最后的总数。

```
<form action="example.php" onsubmit="validateForm()">    
    <a id="a_is_valid" href="#">Validate</a>
    <input type="text" id="code_promo" name="code_promo" value="" />
    <input type="text" name="gtotal" id="gtotal" class='fTotal' value=""  />    
</form> 
```

是的，稍后在代码中有一个按钮可以提交它 - 所以我不担心提交它。

```
$(document).ready(function () {
    var new_total = $('#gtotal').val();
    $('#a_is_valid').click(function () {
        if ($('#code_promo').val() == 55) {
            new_total - 1
        }
    })
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:56:51.230

据我了解，我猜，您想根据代码促销降低价值。以下是设置总数的方法：

```
$(document).ready(function () {

    $('#a_is_valid').click(function () {
        if ($('#code_promo').val() == 55) {
            $('#gtotal').val($('#gtotal').val()-1);
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:11:57.740

也许下一个功能可以帮助您：[`parseInt()`](http://www.w3schools.com/jsref/jsref_parseint.asp)或[`parseFloat()`](http://www.w3schools.com/jsref/jsref_parsefloat.asp). 之后，您可以与 strict mode 进行比较`number === 1`。

# javascript - jQuery $() 构造函数和带有前导反斜杠的字符串

> ID：16092810
> 
> 赞同：1
> 
> 时间：2013-04-18T20:49:54.957
> 
> 标签：javascript, jquery

请看一下这段代码：http: [//jsfiddle.net/Bkdgr/1/](http://jsfiddle.net/Bkdgr/1/)
它不起作用。但是，以下两个修改中的任何一个都可以使其正常工作：

将纯`newItem`字符串传递给`append`，而不是用 包装它`$()`：

```
$('button').on('click', function(e){
    e.preventDefault();
    var newItem = '\
        <li>Hello, \
        World!</li>';
    $('ul').append(newItem);
}); 
```

将开始`<li>`标记向上移动到字符串定义的第一行：

```
$('button').on('click', function(e){
    e.preventDefault();
    var newItem = '<li>Hello, \
        World!</li>';
    $('ul').append($(newItem));
}); 
```

`<li>`当我向上移动到与前导相同的行`\`（但不删除`\`） 时，它也不起作用。
对我来说，构造函数似乎在字符串定义`$()`的前导方面存在一些问题。`\`将纯字符串（没有`$()`包装器）传递给`append`似乎不会引起任何问题。
为什么它会这样工作？前导斜杠在 中是否有任何特殊含义`$()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:53:01.993

jQuery 解析的 html 字符串`$()`不能有前导空格或换行符/返回字符，甚至只能是纯文本。这记录在 api 中。

[http://api.jquery.com/jQuery/#jQuery2](http://api.jquery.com/jQuery/#jQuery2)

如果是 HTML 字符串，则**必须**以 html 标记开头。`.append()`并且`.html()`不那么严格，因为传入的字符串不能被解析为 css 选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:53:32.510

您需要决定是否要使用 $() 作为构造函数。如果是这样，您需要提供标签作为字符串中的第一个元素。它还会检查关闭标签并在需要时添加它。如果您需要代码才能工作，如果您提供自定义 HTML 代码，请不要使用构造函数： `$('ul').append(newItem)`.

你也可以这样划分：

```
 $('button').on('click', function(e){
        e.preventDefault();
        var newItem = '\
            Hello, \
            World!';
        $("<li>").html(newItem).appendTo("ul");
    }); 
```

你需要玩 jQuery 而不是反对它:)

# android - Facebook登录后出现卡在白屏Android

> ID：16092816
> 
> 赞同：0
> 
> 时间：2013-04-18T20:50:09.743
> 
> 标签：android, facebook, facebook-android-sdk

我正在使用 Facebook SDK 登录 Facebook 帐户...尝试登录后出现白屏并卡在上面。这是我的代码：`public class MainActivity extends Activity implements OnClickListener{

```
Facebook fb;
ImageView pic, button;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Toast.makeText(MainActivity.this, "", Toast.LENGTH_SHORT).show();

    String APP_ID = "151170088390760"; // getString(R.string.APP_ID);
    fb = new Facebook(APP_ID);

    button = (ImageView) findViewById(R.id.login);
    pic = (ImageView) findViewById(R.id.profile_pic);

    button.setOnClickListener(this);
    updateButtonImage();
}

private void updateButtonImage() {
    if(fb.isSessionValid()) {
        button.setImageResource(R.drawable.logout_button);
    }else {
        button.setImageResource(R.drawable.login_button);
    }
}

@Override
public void onClick(View v) {
    if(fb.isSessionValid()) {
        try {
            fb.logout(getApplicationContext());
            updateButtonImage();
        } catch (MalformedURLException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    } else {
        // login to facebook
        fb.authorize(MainActivity.this, new DialogListener(){

            @Override
            public void onFacebookError(FacebookError e) {
                Toast.makeText(MainActivity.this, "onFacebookError()", Toast.LENGTH_SHORT).show();
            }

            @Override
            public void onError(DialogError e) {
                Toast.makeText(MainActivity.this, "onError()", Toast.LENGTH_SHORT).show();
            }

            @Override
            public void onComplete(Bundle values) {
                updateButtonImage();
                Toast.makeText(MainActivity.this, "onComplate()", Toast.LENGTH_SHORT).show();
            }

            @Override
            public void onCancel() {
                Toast.makeText(MainActivity.this, "onCancel()", Toast.LENGTH_SHORT).show();
            }
        });
    }
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    fb.authorizeCallback(requestCode, resultCode, data);
} 
```

` 我多次确认了 Keystore，并且我已将我的应用程序注册到 facebook 开发者网站，感谢您的帮助 :) 这是白屏图片：

![](https://i.stack.imgur.com/S7ywY.png)

**注意：**我使用的是 Facebook SDK 3.0.1

**问题已解决：**因为我尝试从未作为开发人员签名的其他 Facebook 帐户登录

**谢谢你**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T12:15:32.263

只需尝试在 Facebook 应用程序设置中的“基本信息”中将“沙盒模式”设置为“关闭”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T03:59:14.657

不能用其他账号登录？我也遇到过同样的场景。使用其他帐户登录时，它显示一个白色对话框，只有左上角的删除按钮。如果是用户帐户，如何访问不是开发者帐户的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-27T06:32:01.193

问题是：

我正在尝试从 Facebook 帐户登录，而不是我以开发人员身份登录

只需从应用程序的开发者帐户登录即可解决问题。

# javascript - carouFredSel 在鼠标按下时滚动

> ID：16092819
> 
> 赞同：0
> 
> 时间：2013-04-18T20:50:22.417
> 
> 标签：javascript, jquery, carousel, caroufredsel

我需要制作一个旋转木马，它会在鼠标按下时继续滚动并在鼠标升起时停止。让这个例子在悬停上工作。如何将其更改为在 mousedown 上工作？

```
$("#foo2").carouFredSel({
    auto    : {
        items           : 1,
        duration        : 1500,
        easing          : "linear",
        timeoutDuration : 0
    }
}).trigger("pause");

$("#foo2_prev").hover(function() {
    $("#foo2").trigger("configuration", ["direction", "right"]);
    $("#foo2").trigger("play");
}, function() {
    $("#foo2").trigger("pause");
}).click(function() {
    return false;
});

$("#foo2_next").hover(function() {
    $("#foo2").trigger("configuration", ["direction", "left"]);
    $("#foo2").trigger("play");
}, function() {
    $("#foo2").trigger("pause");
}).click(function() {
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T21:17:03.630

carouFredSel 初始化代码可以保持不变。然后使用以下代码在 mousedown 和 mouseup 上触发事件，而不是在悬停时触发。

```
this.$("#foo2_prev").mousedown(function() {
    me.$("#foo2").trigger("configuration", ["direction", "right"]);
    me.$("#foo2").trigger("play");
});

this.$("#foo2_next").mousedown(function() {
    me.$("#foo2").trigger("configuration", ["direction", "left"]);
    me.$("#foo2").trigger("play");
});

this.$("#foo2_prev, #foo2_next").mouseup(function() {
    console.log("mouseup");
    me.$("#foo2").trigger("pause");
}); 
```

# ios - 如何使用 mpmovieplayercontroller 从 dailymotion 打开视频

> ID：16092820
> 
> 赞同：0
> 
> 时间：2013-04-18T20:50:24.537
> 
> 标签：ios, video, mpmovieplayercontroller

我想用 mpmovieplayercontroller 从dailymotion 打开一个视频。我已经尝试过 Dailymotion SDK，但它似乎只是将视频嵌入到 uiwebview。我想知道是否有一个 dailymotion 解析器来获取视频链接，就像 hcyoutubeparser 或 ytvvimeoextractor 一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T06:11:29.300

```
-(NSDictionary*)getInfoForDailyMotionVideo:(NSString*)videoId
{
NSString *urlString = [NSString stringWithFormat:@"http://www.dailymotion.com/embed/video/%@", videoId];
NSURL *URL = [NSURL URLWithString:urlString];
NSData * data = [[NSData alloc] initWithContentsOfURL:URL];
NSString *html = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
NSString *str;

NSRange startRange = [html rangeOfString:@"var info = {"];
str = [html substringFromIndex:startRange.location];
NSRange endRange = [str rangeOfString:@"{"];
str = [str substringFromIndex:endRange.location];
endRange = [str rangeOfString:@"},"];
NSString *jsonString = [str substringToIndex:endRange.location+1];

NSDictionary *result = [NSJSONSerialization JSONObjectWithData:[jsonString dataUsingEncoding:NSUTF8StringEncoding] options:0 error:nil];
return result;
} 
```

传递 xct647 的视频 ID，将返回一个字典，其中包含以下与 MPMoviePlayerViewController 一起使用的键：

```
"stream_h264_hq_url" = "http://www.dailymotion.com/cdn/H264-848x480/video/xct647.mp4?auth=1371275189-0d67b3d0c242a8b439adf4300014d749";
"stream_h264_ld_url" = "http://www.dailymotion.com/cdn/H264-320x240/video/xct647.mp4?auth=1371275189-f581218251d42809bf13ad96ea6aacb8";
"stream_h264_url" = "http://www.dailymotion.com/cdn/H264-512x384/video/xct647.mp4?auth=1371275189-f905cebbbe96c563beca38ab59132a95";
"stream_hls_url" = "http://www.dailymotion.com/cdn/manifest/video/xct647.m3u8?auth=1371275189-dbdb650a58afe8661ec6aa9628de064f"; 
```

对 h264 url​​ 使用 MPMovieSourceTypeFile，对 'hls' url 使用 MPMovieSourceTypeStreaming。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-09T19:23:47.987

最后一个答案是一个很好的起点，但不再起作用，由于 Javascript/JSON 语法更改需要更新：

```
-(NSDictionary*)getInfoForDailyMotionVideo:(NSString*)videoId{
    NSString *urlString = [NSString stringWithFormat:@"http://www.dailymotion.com/embed/video/%@", videoId];
    NSURL *URL = [NSURL URLWithString:urlString];
    NSData * data = [[NSData alloc] initWithContentsOfURL:URL];
    NSString *html = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSString *str;

    NSRange startRange = [html rangeOfString:@"var config = {"];
    str = [html substringFromIndex:startRange.location];
    NSRange endRange = [str rangeOfString:@"{"];
    str = [str substringFromIndex:endRange.location];
    endRange = [str rangeOfString:@"}};"];
    NSString *jsonString = [str substringToIndex:endRange.location+1];
    jsonString = [jsonString stringByAppendingString:@"}"];
    NSError *jsonError;
    NSDictionary *result = [NSJSONSerialization JSONObjectWithData:[jsonString dataUsingEncoding:NSUTF8StringEncoding] options:0 error:&jsonError];
    return result;
} 
```

这现在可以工作并返回 AVPlayer 等的所有相关值......

玩得开心！

# linux - sys_read 将在缓冲区溢出时“溢出”字符

> ID：16092822
> 
> 赞同：1
> 
> 时间：2013-04-18T20:50:26.640
> 
> 标签：linux, assembly, x86, nasm, system-calls

在 Linux x86 上使用 NASM

```
mov ecx,eax
mov edx,ebx
mov eax,3
mov ebx,0
int 80h
ret 
```

EAX 最初有一个`mov`'d db 常量，EBX 有缓冲区的长度

这是我用来从控制台读取的代码。它工作正常，除了一个问题...我要求 2 个字符，如果我超过 2 个字符并按 Enter，下次我要求输入时，那些“溢出”/额外字符将立即输入该请求，没有用户交互。如果我再次要求输入失败，这些额外的字符将被 shell 立即解释为命令。

例子：

对该读取例程的 2 次后续调用将产生：

```
2345 
```

第二个输入请求不会阻止也不会提示用户输入任何内容，它只需要它可以使用的任何字符。在这两种情况下，我都要求在一个 3 字节的缓冲区上用零填充两个字符。

1 调用阅读例程：

```
2345
$> 45: command not found 
```

有想法该怎么解决这个吗？我应该使用不同的系统调用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:05:47.073

读取输入后，您需要刷新缓冲区以避免将多余的输入传递给下一个输入读取。不过，这不是缓冲区溢出。

我问过同样的问题，但对于 x86-64 Linux，所以它并不完全重复： [How to Avoid stdin input that does not fit in buffer be sent to the shell in Linux 64-bit Intel (x86-64) assembly](https://stackoverflow.com/questions/12459729/how-to-avoid-stdin-input-that-does-not-fit-in-buffer-be-sent-to-the-shell-in-lin)

无论如何，按照 GunnerInc 的优秀教程（适用于 x86 Linux）应该可以解决您的问题： [http ://www.dreamincode.net/forums/topic/286248-nasm-linux-terminal-inputoutput-wint-80h/](http://www.dreamincode.net/forums/topic/286248-nasm-linux-terminal-inputoutput-wint-80h/)

# python - python27从.bat打开程序并关闭.exe

> ID：16092823
> 
> 赞同：1
> 
> 时间：2013-04-18T20:50:30.827
> 
> 标签：python, subprocess

```
p = subprocess.Popen("path to batch file")
time.sleep(30)
#do something to terminate the .exe process 
```

我正在使用 Popen 运行批处理文件。相关程序 .exe 在 cmd 终端中打开并运行。该程序可以（很好地）通过在终端中手动输入“q”参数来终止。

我想使用上面的 python27 脚本将“q”字符串传递给终端，以便程序识别其本机终止信号并关闭。在阅读了“os”和“subprocess”模块文档并尝试了几种方法（.call、.terminate、.kill）之后，我没有成功

编辑：

操作..

```
p.send_signal('q') 
```

..似乎是我想做的。但是，“q”在解释器中引发了 ValueError。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:35:03.123

我认为您需要做的是在创建子流程时指定标准输入，然后调用其`write`方法：

```
import time
import subprocess
p = subprocess.Popen(r"your.bat", stdin=subprocess.PIPE)
time.sleep(30)
p.stdin.write("q") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:00:23.663

如果我理解正确，您想将参数传递给您的批处理文件。只需向 Popen 提供一个[列表](http://docs.python.org/2/library/subprocess.html#subprocess.Popen)。

```
p = subprocess.Popen(['path to batch file', 'arg_1', 'arg_2', etc...]) 
```

如果您想在进程运行时与其进行通信，那么您需要查看这篇[文章](https://stackoverflow.com/a/165662/2286993)。

# file - Prolog I/O 读取文件并提取信息以使用

> ID：16092827
> 
> 赞同：2
> 
> 时间：2013-04-18T20:50:39.573
> 
> 标签：file, prolog

在我在 Prolog 的旅程中，现在我被 i/o 部分困住了。我试图读取以特定格式编写的文件，并用它们创建我的事实并使用这些事实。但是在阅读了 stackoverflow 中的几个库和示例之后，我无法找到答案。例如，这是我的文件。

```
a,b,c,d,e
funct(a,[1,2,3,4,5])
funct(b,[2,4,6,8,10]
funct(c,[1,3,5,7,9])
funct(d,[1,1,2,3,5])
funct(e,[3,7,11,19,23]) 
```

funct/2 根据第一行中写入的每个元素列出了列表。我试图在开始时获得第一行然后使用它，但我无法做到。我认为这是正确的方法，尽管在现在尝试 Prolog 之后，我对自己不太确定。我想做的是：

```
functExp(a,a,1)
functExp(a,b,2)
functExp(a,c,3)
functExp(a,d,4)
functExp(a,e,5)
functExp(a,b,1)
functExp(b,a,2)
functExp(b,b,4)
functExp(b,c,6)... 
```

我正在使用 SWI-Prolog 顺便说一句。

编辑：抱歉给您带来不便。我不知道尝试使用“功能”是错误的。我纠正了我的期望。functExp/3 是我想要得到的输出，它与 funct 不同。我想我应该使用 assert/assertz 内置函数，但我仍然不确定我应该做什么。再次对我的误解深表歉意. 正如您可能猜到的那样，我仍然是新手，所以如果您愿意接受我，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T10:24:57.283

SWI-Prolog 有大量的 IO 内置，结合它们我们可以很容易地读取你的文件数据：

```
process_file :-
    open('input.txt', read, S),

    read_line_to_codes(S, Fs),
    atom_codes(Fa, Fs),
    atomic_list_concat(Elems, ',', Fa),

    repeat,
    read_line_to_codes(S, L),
    read_from_codes(L, T),
    ( T == end_of_file -> close(S)
    ; apply_line(T, Elems), fail
    ).

apply_line(T, Es) :-
    T =.. [F,K,As],
    maplist(out_line(F, K), Es, As).

out_line(F, K, E, A) :-
    T =.. [F, K, E, A],
    writeln(T). 
```

input.txt 当然包含您显示的数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T03:27:17.083

如果我们把它分解成几个子问题，这个问题会更容易解决。让我们首先尝试将文件解析为文件的直接表示，然后以您想要的形状将其加载到数据库中。

这种问题非常适合定子句语法（DCGs）。使用这种技术在 Prolog 中表达复杂的语法是很自然的，并且您可以获得基于差异列表的有效实现。如果您小心，您甚至可以使用它们来*生成输出*以及解析输入！

首先让我们在其中获取非常有用的[dcg/basics](http://www.swi-prolog.org/pldoc/doc/swi/library/dcg/basics.pl)库：

```
:- use_module(library(dcg/basics)). 
```

我发现以自上而下的方式编写语法更容易，所以让我们将输入分解为几部分。首先，我们有一个元素列表。然后我们有一些“功能”行。我真的不知道您要完成的操作的语义，所以这可能会被错误地命名，但让我们来看看它。

```
document(document(Elements, Functs)) --> 
  element_list(Elements), blanks, funct_list(Functs). 
```

解析的结果将是一个结构`document(E, F)`，其中 E 是元素列表，F 是函数列表。请注意，我们使用`-->`而不是`:-`. 这就是您定义 DCG 规则的方式。在内部，Prolog 将重写谓词给它两个额外的参数：“之前”和“之后”差异列表。

现在让我们先做元素，因为它们更简单：

```
element_list([E|Rest]) --> element(E), ",", element_list(Rest).
element_list([E])      --> element(E). 
```

如果您在此之前看过 CFG，应该非常直观。我们得到一个元素，然后是一个逗号，然后是更多元素，或者只是一个元素。现在让我们定义`element`：

```
element(E) --> [Code], { atom_codes(E, [Code]) }. 
```

我们现在可以实际测试这些`phrase/2`：

```
?- phrase(element(X), "a").
X = a. 
```

很好，这就是我们想要的结果。如果您要拥有多个单字符元素，则可能必须扩展此定义。

```
?- phrase(element_list(X), "a,b,c,d,e").
X = [a, b, c, d, e] ;
false. 
```

所以现在我们知道了`document/2`从解析器出来的第一部分会是什么样子：`document([a,b,c,d,e], Functs)`. 看起来就像我们想要的文件一样。我们的首要任务是以 Prolog 可以使用的方式引入文件及其所有结构。

接下来让我们做函数列表：

```
funct_list([F|Rest]) --> functp(F), blanks, funct_list(Rest).
funct_list([F])      --> functp(F). 
```

这看起来就像元素列表，但我们正在创建函数而不是元素。让我们看看解析一个函数是什么感觉：

```
functp(funct(E1, List)) --> 
  "funct(", element(E1), ",", whites, "[", number_list(List), "])". 
```

引号中的部分基本上是文字文本。同样，您可能需要根据您在解析文件时希望的灵活性来改进它，但这适用于您发布的示例输入。现在我们需要一个数字列表：

```
number_list([N|Rest]) --> number(N), ",", number_list(Rest).
number_list([N])      --> number(N). 
```

同样，就像元素列表一样。这实际上是我们测试它所需的一切。让我们将您的示例文本放在一个名为`file.txt`（您可以使用您实际拥有的任何内容）的文件中并运行它`phrase_from_file/2`来解析它。确保文件末尾*没有多余的换行符；*我们没有处理那个案子。此外，您在第 3 行有一个错字（缺少括号）。

```
?- phrase_from_file(document(D), 'file.txt').
D = document([a, b, c, d, e], 
             [funct(a, [1, 2, 3, 4, 5]), 
              funct(b, [2, 4, 6, 8, 10]), 
              funct(c, [1, 3, 5, 7|...]), 
              funct(d, [1, 1, 2|...]), 
              funct(e, [3, 7|...])]) ;
false. 
```

宾果游戏，我们有文件解析。

第二步是用它来创建你的`funct/3`结构。让我们做一个谓词来处理一个`funct/2`。它需要元素列表来处理，它会生成一个自己的列表。

```
do_normalize([E|Es], funct(F,[N|Ns]), [funct(F,E,N)|F3s]) :-
    do_normalize(Es, funct(F,Ns), F3s).
do_normalize([], funct(_, []), []). 
```

让我们试一试：

```
?- do_normalize([a,b,c,d,e], funct(a,[1,2,3,4,5]), X).
X = [funct(a, a, 1), funct(a, b, 2), funct(a, c, 3), funct(a, d, 4), funct(a, e, 5)]. 
```

到目前为止，这看起来还不错！

**编辑**我们回来了。

上面的函数很好，但是我们需要在`funct/2`我们从文件中传入的每个 s 上使用它来生成所有的`funct/3`s。我们可以用 来做到这一点`maplist`，但我们需要从解析器的输出中桥接。我们还需要使用`append/2`来处理它们将作为嵌套列表返回的事实；我们想要一个扁平化的列表。

```
normalize(document(Elements, Funct3s), Funct2s) :-
    normalize(Elements, Funct3s, NestedFunct2s),
    append(NestedFunct2s, Funct2s).

normalize(Elements, Funct3s, Funct2s) :- 
    maplist(do_normalize(Elements), Funct3s, Funct2s). 
```

现在让我们看看它是否有效：

```
?- phrase_from_file(document(D), 'file.txt'), normalize(D, Normalized).
Normalized = [funct(a, a, 1), 
              funct(a, b, 2), 
              funct(a, c, 3), 
              funct(a, d, 4), 
              funct(a, e, 5), 
              funct(b, a, 2), 
              funct(b, b, 4), 
              funct(b, c, 6), 
              funct(..., ..., ...)|...] 
```

所以我们现在已经完成了 2/3。我们已成功读取文件并将其内容转换为数据库中所需的结构。现在我们只需要将它们放入数据库中就可以了！

我们必须首先告诉 Prolog`funct/3`是动态的，可以在运行时修改：

```
:- dynamic funct/3. 
```

我们可以使用`forall/2`循环遍历列表并断言所有内容：

```
?- phrase_from_file(document(D), 'file.txt'), 
   normalize(D, Normalized), 
   forall(member(Fact, Normalized), assertz(Fact)). 
```

证明它有效：

```
?- funct(X, Y, Z).
X = Y, Y = a,
Z = 1 ;

X = a,
Y = b,
Z = 2 ;

X = a,
Y = c,
Z = 3 ;

X = a,
Y = d,
Z = 4 ;

X = a,
Y = e,
Z = 5 
... 
```

现在让我们将整个作品打包在一个漂亮的谓词中：

```
load_funct(Filename) :-
    phrase_from_file(document(D), Filename),
    normalize(D, Functs),
    forall(member(Funct, Functs), assertz(Funct)), !. 
```

试试看：

```
?- load_funct('file.txt').
true. 
```

你完成了！来到大约23行。

希望这会有所帮助，并希望您喜欢 Prolog 并坚持下去！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T06:42:13.960

**编辑**

我知道这并不能回答您的确切问题，而是您想做什么，如果我可以总结一下：

*   接受看起来几乎是有效的 Prolog 的输入
*   将其转换为看起来几乎是有效 Prolog 的输出（你也错过了那里的点）
*   在 Prolog 中执行此操作

你没有告诉我们你要用它做什么有用的事情。毕竟，人们会期望你会做一些与`funct`你想要作为输出的 s 相关的 Prolog。然后将它们推送到标准输出，每行一个（最后没有点）是没有意义的。

这里有一个解决方案：

您的原始文件几乎是正确的 Prolog，那么为什么不使用文本编辑程序来修复它呢？例如，使用 sed，您可以使用：

```
1 s/^/atoms(\[/
1 s/$/\])/
s/$/\./ 
```

对于更复杂的示例，您可能需要对其进行调整，但如果您已经拥有*几乎*有效的 Prolog，则仍然相对简单。

（注意：原始输入文件的第 3 行缺少右括号，我想这是疏忽）

现在您可以使用`consult`从 Prolog 加载文件。`do_normalize`如果您坚持要在数据库中明确地拥有所有关系，您仍然需要像@DanielLyons 显示的那样。但是看看这个规则：

```
funct(A,B,N) :-
    funct(A,Ns), nth1(BN,Ns,N),
    atoms(Bs), nth1(BN,Bs,B). 
```

它`funct/3`根据原始（更正）数据和您提供的示例进行定义。您可以按照您显示的顺序枚举您需要的所有“规范化”函子，只需说：

```
?- funct(A,B,N). 
```

或者使用实例化的任意参数查询它。

您当然可以在数据库中声明它们，或者将它们写入文件，如果这是心脏想要的。

# sql - 通过 VB 查询失败（Infopath 和 Access）

> ID：16092828
> 
> 赞同：0
> 
> 时间：2013-04-18T20:50:40.960
> 
> 标签：sql, vb.net, vba, infopath2010, infopath-2007

我正在使用 MS Access 作为数据库的信息路径表单。

在表单上，​​我想检查重复的电子邮件，我试图通过在以下 VB 代码中运行 SQL 查询来做到这一点。

```
 Public Sub CTRL125_7_Clicked(ByVal sender As Object, ByVal e As ClickedEventArgs)

    Dim myAdoConnection As AdoQueryConnection = _
    DirectCast(Me.DataConnections("Mainconnection"), AdoQueryConnection)

    Dim mynav As XPathNavigator = _
    CreateNavigator().SelectSingleNode("/dfs:myFields/dfs:dataFields/d:Candidate_Tracking_Database/@Email", NamespaceManager)

    Dim email As String

    email = mynav.InnerXml

    myAdoConnection.Command = _
    "select [Email] from [Candidate_Tracking_Database] where [Email] =" + email

    myAdoConnection.Execute()
    End Sub 
```

我想继续使用 If, then, else 语句来提示是否找到重复项。但是，当我尝试执行代码时出现以下错误：

```
System.Net.WebException was unhandled by user code
Message="The query method on the Document object failed.
Operation aborted" 
```

**我究竟做错了什么？**感谢期待答案。

**笔记：**

我已经改编了来自 - [http://msdn.microsoft.com/en-us/library/microsoft.office.infopath.adoqueryconnection.command.aspx?cs-save-lang=1&cs-lang=vb#code-snippet的代码-1](http://msdn.microsoft.com/en-us/library/microsoft.office.infopath.adoqueryconnection.command.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)

守则中的要素是：

```
Mainconnection = connection name
"/dfs:myFields/dfs:dataFields/d:Candidate_Tracking_Database/@Email" = Xpath of the input text box
[Email] = Field name in the [Candidate_Tracking_Database] table 
```

完全错误是：

```
System.Net.WebException was unhandled by user code
Message="The query method on the Document object failed.
Operation aborted
"
Source="Microsoft.Office.InfoPath.Client.Internal.Host"
StackTrace:
   at      Microsoft.Office.InfoPath.Internal.MomExceptionHelper.ExecuteDataConnectionAction(OMCall d)
   at Microsoft.Office.InfoPath.Internal.AdoQueryConnectionHost.Execute()
   at Candidate_Registration.FormCode.CTRL125_7_Clicked(Object sender, ClickedEventArgs e) in C:\Infopath\InfoPath Projects\Candidate Registration\FormCode.vb:line 300
   at Microsoft.Office.InfoPath.Internal.ButtonEventHost.OnButtonClick(DocActionEvent pEvent)
   at Microsoft.Office.Interop.InfoPath.SemiTrust._ButtonEventSink_SinkHelper.OnClick(DocActionEvent pEvent) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T23:46:29.043

尝试这个：

`myAdoConnection.Command = _ "select [Email] from [Candidate_Tracking_Database] where [Email] =" & email`

或这个：

`myAdoConnection.Command = _ "select [Email] from [Candidate_Tracking_Database] where [Email] ='" & email & "'"`

# versionone - 如何通过其 RESTful API 获取 Versionone 的“完成”小时数？

> ID：16092833
> 
> 赞同：4
> 
> 时间：2013-04-18T20:51:00.770
> 
> 标签：versionone

例如：当我查找任务的所有属性时，
`https://<host>/VersionOne/rest-1.v1/Data/Task`
我会得到诸如“Todo”和“DetailedEstimates”之类的信息，但没有与“Done”小时相关的信息

您是否知道是否有办法通过 VersionOne 的 Rest API 获得给定任务/测试/等的“完成”小时数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T22:05:17.917

此外，您可以汇总每个任务的所有实际值

```
https://<host>/VersionOne/rest-1.v1/Data/Task?sel=Name,Actuals.Value.@Sum 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T21:56:26.187

“完成”不是单个值，因此必须通过关系查询。表示一个小时条目的资产类型称为实际。通过 Workitem 基础的关系称为实际值。

因此，您可以使用 Story 甚至 Workitem 之类的内容“根植”您的查询。然后使用“sel”选择成员和值（小时）。

```
http://<host>/VersionOne/rest-1.v1/Data/Story?sel=Name,Actuals.Date,Actuals.Value,Actuals.Member 
```

这在数据方面可能有点压倒性，因此您可能希望将其限制为一个故事：

```
/rest-1.v1/Data/Story/1038?sel=Name,Actuals.Date,Actuals.Value,Actuals.Member 
```

请注意，如果您在任务/测试级别而不是故事级别进行跟踪，您也必须导航该关系：

```
/rest-1.v1/Data/Story/1031?sel=Name,Actuals.Date,Actuals.Value,Actuals.Member,Children.Actuals.Date,Children.Actuals.Value,Children.Actuals.Member 
```

您可以这样做的另一种方法是从实际资产本身。数据将是相同的，但结果可能更易消耗：

```
/rest-1.v1/Data/Actual?sel=Date,Value,Member.Name,Workitem.Name 
```

# javascript - WindowProxy 和 Window 对象？

> ID：16092835
> 
> 赞同：16
> 
> 时间：2013-04-18T20:51:01.147
> 
> 标签：javascript, html

有人可以解释为什么真正存在 WindowProxy 对象吗？我了解真正的 Window 对象通过该对象完成所有操作，但无法理解其目的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-10-05T04:42:11.823

此构造用于支持 html5 浏览上下文模型。本质上，每个脚本都可以为其主要活动窗口提供一个集中的访问点，以在功能上解耦各个内部窗口、文档历史记录、缓存中的瞬态引用，以及以与上下文相关的方式跟踪每个脚本的需要。

下面的两张图片说明了这个概念：

![windowProxy 在这里指的是外部的“浏览器窗口”。](https://i.stack.imgur.com/tRmVN.png)

*在上图中，**浏览器窗口**由每个内部窗口内容中的 windowProxy 引用作为别名。*

![windowProxy 在这里指的是顶层的“窗口”。](https://i.stack.imgur.com/7VQ8S.png)

*在上图中，顶级**Window**由每个内部窗口和 iframe 内容中的 windowProxy 引用别名。*

*   [HTML 标准：浏览上下文](https://html.spec.whatwg.org/multipage/browsers.html#browsing-context)
*   [伟大的视觉 MDN 文章](https://developer.mozilla.org/en-US/docs/Inner_and_outer_windows)
*   [HTML 标准：WindowProxy](https://html.spec.whatwg.org/multipage/window-object.html#windowproxy)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-05-07T14:58:58.423

考虑以下代码：

```
const iframe = document.appendChild(document.createElement("iframe"));

iframe.src = "/a";
iframe.onload = () => {
  const windowA = iframe.contentWindow;

  iframe.src = "/b";
  iframe.onload = () => {
    const windowB = iframe.contentWindow;

    console.log("window before navigation === window after navigation?", windowA === windowB);
  };
}; 
```

事实证明，这是真的。而且，许多网站都依赖于这一点：它们在导航之前获取对 的引用`iframe.contentWindow`，或者可能是。`window.frames[0]`然后他们在导航后继续使用它。

（请注意，在我们的示例中，我们通过执行 启动导航`iframe.src = "/b"`。所以理论上我们当时可能知道获取对 的新引用`iframe.contentWindow`。但在一般情况下，导航可以在不涉及外框的情况下发生，例如用户可以点击 iframe 中的链接，或者 iframe 中的代码可以这样做`location.href = "/c"`。）

这怎么可能是真的？毕竟，我们导航到了一个完全不同的页面——它将有一个新的`Window`（具有新的全局范围，不受前一页声明的任何全局变量的污染）、一个新`Document`的等。

这是真的，因为`WindowProxy`。`iframe.contentWindow`, 或`window.frames[0]`, 或任何其他尝试访问窗口的方式，返回一个`WindowProxy`对象，而不是一个`Window`对象。该`WindowProxy`对象委托给*当前的任何`Window`内容*。在我们的示例中，它代表导航前的 for 和`Window`导航后的for 。`/a``Window``/b`

# spring - 仅允许具有某些角色的用户使用 Spring Security 登录

> ID：16092837
> 
> 赞同：0
> 
> 时间：2013-04-18T20:51:06.660
> 
> 标签：spring, security, login, roles, authorize

我有一个登录页面，我想允许每个人访问 login.jsp。例如，

`<intercept-url pattern="/login.jsp" access="permitAll()" />`

但我只想允许使用 ROLE_ADMIN 访问用户。具有 ROLE_USER 的用户可能能够成功进行身份验证，但他们应该被重定向回 l​​ogin.jsp。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:02:44.213

将登录页面设置为`access-denied-page`打开`<http>`，并正确保护 URL 应该会产生预期的效果。

```
<security:http use-expressions="true" access-denied-page="/login">

    <security:form-login
            login-page="/login"
            default-target-url="/page/for/admins"
            authentication-failure-url="/login?error=true"/>

    <security:intercept-url pattern="/login.jsp" access="permitAll()" />
    <security:intercept-url pattern="/page/for/admins" access="hasRole('ROLE_ADMIN')"/>

</security:http> 
```

具有 ROLE_USER 的用户将在登录后立即被转发回登录页面。虽然这不是一个愉快的用户体验......

# ruby - Ruby 类加载机制

> ID：16092838
> 
> 赞同：4
> 
> 时间：2013-04-18T20:51:06.853
> 
> 标签：ruby

我从 Ruby 编程语言开始，我有兴趣在开始研究 Rails 框架之前深入了解它。

我目前有点失望，因为每个人都只关心 Rails 框架，而语言的其他方面只是没有深入讨论，例如它的类加载机制。

考虑到我是从做一些桌面/控制台实验开始的，我想更好地理解以下事项：

1.  将每个 Ruby 类放在一个单独的 Ruby 文件中是一种好习惯吗？(*.rb)
2.  如果我有，假设.. 10 个类.. 并且它们都相互引用，通过实例化彼此并调用彼此的方法，我是否应该在每个文件中添加一个“require”语句来说明该类需要哪些类在那个文件里？（就像我们在每个 Java 类文件中使用“导入”语句一样？）
3.  在类声明之前或之后（内部）放置“require”语句有区别吗？
4.  什么可以被认为是合适的 Ruby 程序的“入口点”？在我看来，任何 .rb 脚本都足够了，因为该语言没有像 C 或 Java 这样的约定，我们总是需要方法的“主要”函数。
5.  类加载是否被视为 Ruby 程序执行中的“阶段”？我们是否应该在一开始就加载应用程序所需的所有类？
6.  当我们运行需要它们的代码时，解释器本身不应该负责查找和加载类吗？通过搜索 $LOAD_PATH 变量中的路径，就像 Java 使用 $CLASSPATH 一样？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T21:06:22.797

一般来说，`.rb`为每个 Ruby 类创建一个单独的文件是一种很好的做法，除非这些类具有实用性并且太琐碎而不能保证分离。这种情况的一个实例是自定义的 Exception 派生类，将其放在单独的文件中会比它的价值更麻烦。

传统认为​​类的名称和文件名是相关的。在调用类的地方，调用`ExampleClass`文件`example_class`，相同的“下划线”版本。有时你会违反这个约定，但只要你对此保持一致，就不会有问题。如果您遵循惯例，Rails ActiveSupport 自动加载器将帮助您很多，所以很多人都遵循这种做法。

同样，您需要将应用程序组织到文件夹中，`lib`并将`bin`命令行脚本与后端库分开。命令行脚本通常没有`.rb`扩展名，而库应该有。

当涉及到 时`require`，应该谨慎使用。如果你正确地构建你的库文件，一旦你调用`require`了顶层文件，它们都可以自动加载。这是通过该`autoload`功能完成的。

例如，`lib/example_class.rb`可能看起来像：

```
class ExampleClass
  class SpecialException < Exception
  end

  autoload(:Foo, 'example_class/foo')

  # ...
end 
```

您可以在单独的目录或文件下组织其他内容，例如`lib/example_class/foo.rb`可能包含：

```
class ExampleClass::Foo
  # ...
end 
```

您可以一直保持链接`autoloads`。这样做的好处是只加载实际引用的模块。

有时您会希望将 a 推迟`require`到类实现中的某个地方。如果您想避免在一个繁重的库中加载，除非使用特定功能，否则此功能很有用，在一般情况下不太可能使用此功能。

例如，您可能不想加载 YAML 库，除非您正在进行一些调试：

```
def debug_export_to_yaml
  require 'yaml'

  YAML.dump(some_stuff)
end 
```

如果您查看常见 Ruby gem 的结构，“入口点”通常是库的顶层或包含此库的实用程序脚本。因此，举个例子`ExampleLibrary`，您的切入点`lib/example_library.rb`将被构造为按需包含其余部分。您可能还有一个脚本`bin/library_tool`可以为您执行此操作。

至于什么时候加载东西，如果有很大的机会被使用，那就提前加载它以早点付出代价，即所谓的“急切加载”。如果它被使用的可能性很小，请按需加载它，或者将其“延迟加载”，因为它被称为。

查看一些简单但流行的 gem 的来源，以了解大多数人如何构建他们的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:10:59.147

我将尝试帮助您解决第一个问题：

> 1.  将每个 Ruby 类放在一个单独的 Ruby 文件中是一种好习惯吗？(*.rb)

归结为这些类的相关程度。让我们看几个例子。看这个类：[https](https://github.com/resque/resque/blob/master/lib/resque.rb) ://github.com/resque/resque/blob/master/lib/resque.rb ，它`"imports"`是几个类的功能，虽然它们一起工作，但它们并没有密切相关，可以捆绑在一起。

另一方面，看看这个模块：[https](https://github.com/resque/resque/blob/master/lib/resque/errors.rb) ://github.com/resque/resque/blob/master/lib/resque/errors.rb 。它捆绑了 5 个不同的类，但它们确实属于一起，因为它们本质上都代表相同的。

此外，从设计的角度来看，一个很好的重击规则可能会问自己，还有谁在使用这个类/功能（意味着代码库的哪些其他部分需要它）？

假设您要代表 a`Click`并由`WheelScroll`a 执行`Mouse`。在这个简单的示例中，将这些类捆绑在一起会更有意义：

```
module ComputerPart
   class Mouse; end
   class WheelScroll; end
   class Click; end
end 
```

最后，我建议您仔细阅读其中一些流行项目的代码，以了解社区通常如何做出这些决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:00:57.267

1.）我遵循这种做法，但这不是必需的，如果需要，您可以将一堆类放在一个文件中。

2.）如果类在同一个文件中，不，当您运行脚本时它们都可以访问。如果它们位于单独的文件中，那么您应该要求它们，您还可以要求文件（self）所在的整个目录。

3.）是的，它应该在文件的顶部。

4.) 在 ruby​​ 中，一切都来自 Main 对象，解释器只是为您处理创建它。如果您正在编写 OO ruby​​ 而不仅仅是脚本，那么入口点将是您调用的第一个类的 init 方法。

5.) 是的，在程序运行之前，它会加载所有依赖项。

6.) 我认为它可以做到这一点，您所要做的就是在文件顶部需要正确的文件，之后您可以根据需要使用它们，而无需再次隐式加载它们。

# javascript - 如何在Javascript中将字符串转换为一系列数字？

> ID：16092840
> 
> 赞同：-1
> 
> 时间：2013-04-18T20:51:16.493
> 
> 标签：javascript

在Javascript中将字符串转换为一系列数字的好方法是什么（我不是在谈论转换`"0.5"`为`0.5`，而是更多`"Hello"`地转换为`47392048`）？

任何想法表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:54:53.793

您可以使用每个字母的 ASCII 值：

```
"a letter".charCodeAt(0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T16:33:38.397

好的，鉴于您的评论，这是一个（未经广泛测试的）解决方案。

```
var str = "κόσμε 这是一条狗 é €";

$('#orig').after('<dd>' + str + '</dd>');

var result = "";
for (var i = 0, len = str.length, code, paddedCode; i < len; ++i) {
  code = str[i].charCodeAt(0).toString();
  paddedCode = code.length >= 8
    ? code
    : new Array(8 - code.length + 1).join(0) + code; result += paddedCode;
  result += paddedCode;
}

$('#nums').after('<dd>' + result + '</dd>');

var segments = result.match(/.{8}/g);

$.each(segments, function(k, v) {
    $('#nums-segmented').after('<dd>' + v + '</dd>');
});

revertedString = '';

for (var i = 0, len = segments.length; i < len; i=i+2) {
  revertedString += String.fromCharCode((segments[i] | 0));
}

$('#string').after('<dd>' + revertedString + '</dd>'); 
```

[在JSFiddle](http://jsfiddle.net/QGnsT/)上运行它

诀窍是填充数字并在需要时将它们作为字符串使用。

# macos - 跨平台桌面应用程序开发

> ID：16092841
> 
> 赞同：0
> 
> 时间：2013-04-18T20:51:21.943
> 
> 标签：macos, windows-8, desktop-application

我想开发 Windows 8 应用程序并将它们托管在 Azure 上，就像它们是任何其他网站一样，即 Mac、PC 等可以访问。我不想仅限于将 Windows 8 应用程序下载到 Windows 8 的人电脑或设备。你能解释一下 Azure 是如何做到这一点的吗？

我想为桌面开发 Windows 8 应用程序，但不限于在 Windows 8 PC 和设备上运行它们。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T23:33:14.173

Azure 根本没有实现这一点，只是提供了一个公共端点来访问“代码”。您在云中拥有的内容将取决于您想要实现的目标以及您想要接触的对象。

您提到了网站和应用程序，但它们意味着两种截然不同的架构。

**网站**将为您提供最大的影响力，因为您将（可能）使用多种平台上可用的 HTML5/JavaScript 和 CSS 等标准。正如您通过使用 Outlook.com 等应用程序所看到的，用户体验可以非常身临其境。对于网站，除了浏览器之外几乎没有客户端要求。

应用**程序**通常意味着在目标机器上进行本地安装，并提供尽可能丰富的体验，因为您使用特定于平台或设备的技术、框架和 API。应用程序（可以说比网站更好）还可以通过 Apple 的 App Store、Google Play 和 Window Store 等市场实现覆盖和货币化。

Silverlight 和 Flash 等技术是 RIA 浪潮（富 Internet 应用程序）的一部分，它是两者的混合体：使用 Web 实现覆盖范围，以及使用插件获得丰富性。这些仍然是有效的模型，但潮流正在转向 HTML5，它现在更接近现实，并缩小了 Silverlight 和 Flash 填补的用户体验差距。虽然肯定支持 Silverlight（在浏览器外模式下也是如此），但由于支持的平台和需要额外安装，选择使用插件技术将限制您的受众。考虑到您的目标应用程序，这可能会或可能不会被接受。

我们现在看到的是向移动应用程序开发范式发展的趋势——当然，仍然是原生的，但也包括由 PhoneGap、AppMobi、Sencha 和其他 HTML5 框架和[Xamarin](http://xamarin.com)等跨平台选项提供的混合应用程序。这些中的每一个都允许您使用您熟悉的给定平台的语言和结构进行开发，但创建的应用程序部分或全部是“本地”的，并且可以在多个设备和平台上运行。通常，您将在目标平台上重用大部分“后端”和数据集成层，但重新设计用户界面以符合设备的预期。

Windows Azure 通过为数据存储、服务、身份管理、推送通知和其他依赖集中化和规模化的设施提供基础设施，在此类应用程序的开发中占有突出地位。

而且我想在这一切中还有另一种选择，即虚拟化，但这对最终用户来说是一个更大的障碍，因此不建议将其作为一种通用方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:32:17.613

您可以创建 Silverlight 应用程序，它在浏览器中运行。因此它可以在 Windows PC 和 Mac 中打开。请访问[Microsoft Silverlight](http://www.microsoft.com/silverlight/)网站。这里有几个关于 Azure 和 Silverlight 的链接。

[Azure 云中的 Silverlight](http://www.silverlightshow.net/items/Silverlight-in-the-Azure-cloud-Part-1.aspx)

[Microsoft Silverlight 5 和 Windows Azure 企业集成](http://www.silverlightshow.net/book/Microsoft-Silverlight-5-and-Windows-Azure-Enterprise-Integration.aspx)

[Windows Azure 与 Silverlight 端到端演示](http://friendssharestuff.codeplex.com/)

更多你谷歌，你会得到更多的结果。

# c# - sql事务失败

> ID：16092845
> 
> 赞同：6
> 
> 时间：2013-04-18T20:51:56.957
> 
> 标签：c#, sql-server, transactionscope

在数据库中插入记录时出现以下错误。

```
System.Transactions.TransactionException: The operation is not valid for the state of the transaction. ---> System.TimeoutException: Transaction Timeout
   --- End of inner exception stack trace ---
   at System.Transactions.TransactionState.EnlistPromotableSinglePhase(InternalTransaction tx, IPromotableSinglePhaseNotification promotableSinglePhaseNotification, Transaction atomicTransaction)
   at System.Transactions.Transaction.EnlistPromotableSinglePhase(IPromotableSinglePhaseNotification promotableSinglePhaseNotification)
   at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)
   at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)
   at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open() 
```

实际上我是通过事务范围方法在数据库中插入数据，其代码如下所述。

```
TransactionOptions tOptions = new TransactionOptions();
tOptions.IsolationLevel = IsolationLevel.ReadCommitted;
tOptions.Timeout = TransactionManager.MaximumTimeout;
using (var transactionScope = new TransactionScope(TransactionScopeOption.RequiresNew, tOptions))
{
} 
```

上面的说法有什么不正确的吗？

这里要提到的一件事是，我在至少 10 个具有大量记录的表中批量插入数据，并且表还允许在批量插入中插入重复记录，用于实现此目的的语法如下所述。

```
CREATE UNIQUE INDEX Index_a ON table1([c1], [c2]) WITH IGNORE_DUP_KEY 
```

如果有人可以帮助我解决这个问题，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T04:16:24.547

问题是 MSDTC 服务被禁用，我正在使用批量数据库操作。启用后问题就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T17:30:10.847

好像您有未提交的交易。尝试重新启动 Sql Server 或 Oracle 服务。

# sql - 动态查询和动态 Where 子句解决方案

> ID：16092848
> 
> 赞同：1
> 
> 时间：2013-04-18T20:52:10.613
> 
> 标签：sql, dynamic, where, sp-executesql

本周，我发现自己需要一些动态查询。现在，动态查询和动态 where 子句已经不是什么新鲜事了，而且在整个网络上都有很好的记录。然而，我需要更多的东西。我需要一种流畅的方式将新的 where 字段拉到客户端，并允许用户根据需要制作尽可能多的过滤器。甚至在单个字段上有多个过滤器。更重要的是，我需要访问 SQL Server 中所有可能的运算符。以下代码是实现此目的的一种方法。我将尝试用底部的完整代码指出代码的亮点。

希望你喜欢代码。

要求

1.  该解决方案永远不会允许 SQL 注入。（不能使用 exec(command)）
2.  存储过程的调用者可以是任何东西。
3.  数据集必须来自存储过程。
4.  任何字段都可以根据需要过滤多次，几乎可以进行任何操作。
5.  应允许过滤器的任何组合。
6.  存储过程应该允许强制参数

首先，让我们看一下参数。

```
CREATE PROCEDURE [dbo].[MyReport]
-- Add the parameters for the stored procedure here
@p_iDistributorUID  INT,        --    manditory
@p_xParameters      XML = null  --optional parameters (hostile) 
```

第一个参数必须始终发送，在这个演示中，我们有一个必须发送的经销商 ID。第二个参数是一个 XML 文档。这些是“动态 Where 子句”，我们认为这些潜在的 sql 注入，或者我认为这个参数是敌对的。

```
<root>
<OrFilters>
    <AndFilter Name="vcinvoicenumber" Operator="2" Value="inv12"/>
    <AndFilter Name="vcID" Operator="1" Value="asdqwe"/>
</OrFilters>
<OrFilters>
    <AndFilter Name="iSerialNumber" Operator="1" Value="123456"/>
</OrFilters> 
```

NAME= 字段名（如果你想混淆，你可以只使用 object_id） OPERATOR = SQL 运算符，例如 <,>,=,like,ect。VALUE 是用户输入的内容。

这是最终代码的样子。

```
Select *
FROM someTable
Where (
vcinvoicenumber like ‘inv12%’
and vcID = ‘asdqwe’
) 
Or
(
iSerialNumber   = ‘123456’  
) 
```

首先是找出有多少“OrFilters”标签。

```
SELECT @l_OrFilters = COUNT(1)
FROM   @p_xParameters.nodes('/root/OrFilters') Tab(Col) 
```

接下来，我们需要一个临时表来保存 XML 文档中的值。

```
CREATE TABLE #temp
(keyid int IDENTITY(1,1) NOT NULL,value varchar(max)) 
```

我们现在为第一个“OrFilters”标签创建一个光标。

```
DECLARE OrFilter_cursor CURSOR LOCAL
FOR 
SELECT Tab.Col.value('@Name','varchar(max)') AS Name
    ,Tab.Col.value('@Operator','Smallint') AS Operator
    ,Tab.Col.value('@Value','varchar(max)') AS Value
    FROM   @p_xParameters.nodes('/root/OrFilters[sql:variable("@l_OrFilters")]/AndFilter') Tab(Col) 
```

为了确保我们有一个有效的字段，我们检查系统表。

```
SELECT @l_ParameterInName = [all_columns].Name 
,@l_ParameterDataType= [systypes].Name
,@l_ParameterIsVariable= Variable
,@l_ParameterMax_length=max_length
,@l_ParameterpPrecision=precision
,@l_ParameterScale =[all_columns].scale
 FROM [AprDesktop].[sys].[all_views]
INNER JOIN [AprDesktop].[sys].[all_columns]
    ON [all_views].object_id = [all_columns].object_id
INNER JOIN [AprDesktop].[sys].[systypes]
    ON [all_columns].system_type_id = [systypes].xtype
WHERE [all_views].name = 'vw_CreditMemo_Lists'
and [all_columns].Name= @l_Name 
```

现在我们将参数保存到临时表

```
IF @@ROWCOUNT = 1   
BEGIN
INSERT INTO #temp (value) SELECT @l_Value
SET @l_FilterKey = @@IDENTITY
.
.   
. 
```

我们调用一个将实际构建 where 子句的函数。

```
SET @l_TemporaryWhere +=  
dbo.sfunc_FilterWhereBuilder2(@l_Operator
,@l_ParameterInName
,@l_TemporaryWhere
,CAST(@l_FilterKey AS VARCHAR(10))
,@l_ParameterDataType
,@l_ParameterVariable) 
```

查看这个函数，您可以看到我们使用 case 语句来生成 where 子句字符串。

```
set @l_CastToType = ' CAST( VALUE as ' + @p_DataType + @p_PrecisionScale + ') '
set @l_CastToString = ' CAST( '+@p_Field+' as VARCHAR(MAX)) '

-- Add the T-SQL statements to compute the return value here
SELECT @l_Return =    
    CASE 
--EQUAL
--ex: vcUID = (select  value FROM #temp where keyid = 1)
WHEN @p_Command = 1 
    THEN @p_Field + ' = (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')' 

--BEGIN WITH
--ex:vcInvoiceNumber LIKE (select value+'%' FROM #temp where keyid = 2)
WHEN @p_Command = 2 
    THEN @l_CastToString +' LIKE (select value+'+ QUOTENAME('%','''') +' FROM #temp where keyid = ' + @p_KeyValue + ')'
.
.
. 
```

最后调用 sp_execute。

```
EXECUTE sp_executesql @l_SqlCommand ,@l_Parameters, @p_iDistributorUID 
```

呼叫代码

```
DECLARE @return_value int

DECLARE @myDoc xml
SET @myDoc = 
'<root>
<OrFilters>
    <AndFilter Name="vcinvoicenumber" Operator="1" Value="123"/>
</OrFilters>

</root>'

EXEC    @return_value = [dbo].[spp_CreditMemo_Request_List_v2]
    @p_siShowView = 1,
    @p_iDistributorUID = 3667,
    @p_xParameters = @myDoc

SELECT  'Return Value' = @return_value 
```

主存储过程

```
ALTER PROCEDURE [dbo].[MyReport]
    -- Add the parameters for the stored procedure here
    @p_iDistributorUID          INT                 ,   --manditory
    @p_xParameters              XML         = null      --optional parameters(hostile)
AS
BEGIN

    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    DECLARE @l_TemporaryWhere       NVARCHAR(MAX)

    -- declare variables 
    DECLARE @l_SqlCommand           NVARCHAR(MAX)
    DECLARE @l_Parameters           NVARCHAR(MAX)
    DECLARE @l_WhereClause          NVARCHAR(MAX)

    DECLARE @l_OrFilters            INT

    --cursor variables
    DECLARE @l_Name                 VARCHAR(MAX)
    DECLARE @l_Operator             SMALLINT
    DECLARE @l_Value                VARCHAR(MAX)

    --variables from the database views 
    DECLARE @l_ParameterInName      NVARCHAR(128)
    DECLARE @l_ParameterDataType    NVARCHAR(128)
    DECLARE @l_ParameterIsVariable  BIT
    DECLARE @l_ParameterMax_length  SMALLINT
    DECLARE @l_ParameterpPrecision  TINYINT
    DECLARE @l_ParameterScale       TINYINT

    --the variable that holds the latest @@identity
    DECLARE @l_FilterKey INT

    --init local variables
    SET @l_SqlCommand   =''
    SET @l_Parameters   =''
    SET @l_WhereClause  =''

    BEGIN TRY

        --verify manditory variables        
        if @p_iDistributorUID is null
            raiserror('Null values not allowed for @p_iDistributorUID', 16, 1)

        --Build the base query
        -- only the fields needed in the tile should be selected
        SET @l_SqlCommand = 
            ' SELECT * ' +
            ' FROM vw_Lists ' 

        --how many "OR" filters are there
        SELECT @l_OrFilters = COUNT(1)
        FROM   @p_xParameters.nodes('/root/OrFilters') Tab(Col)

        --create a temp table to 
        --hold the parameters to send into the sp
        CREATE TABLE #temp
        (
            keyid int IDENTITY(1,1) NOT NULL,value varchar(max)
        )

        --Cycle through all the "OR" Filters
        WHILE @l_OrFilters > 0
        BEGIN
            SET @l_TemporaryWhere = '';

            --Create a cursor of the Next "OR" filter
            DECLARE OrFilter_cursor CURSOR LOCAL
            FOR 
                SELECT Tab.Col.value('@Name','varchar(max)') AS Name
                    ,Tab.Col.value('@Operator','Smallint') AS Operator
                    ,Tab.Col.value('@Value','varchar(max)') AS Value
                FROM   @p_xParameters.nodes('/root/OrFilters[sql:variable("@l_OrFilters")]/AndFilter') Tab(Col)

            OPEN OrFilter_cursor
            FETCH NEXT FROM OrFilter_cursor 
            INTO @l_Name, @l_Operator,@l_Value  

            WHILE    @@FETCH_STATUS = 0
            BEGIN

                --verify the parameter actual exists
                --  and get parameter details
                SELECT @l_ParameterInName = [all_columns].Name 
                    ,@l_ParameterDataType= [systypes].Name
                    ,@l_ParameterIsVariable= Variable
                    ,@l_ParameterMax_length=max_length
                    ,@l_ParameterpPrecision=precision
                    ,@l_ParameterScale =[all_columns].scale
                FROM [AprDesktop].[sys].[all_views]
                    INNER JOIN [sys].[all_columns]
                        ON [all_views].object_id = [all_columns].object_id
                    INNER JOIN [sys].[systypes]
                        ON [all_columns].system_type_id = [systypes].xtype
                WHERE [all_views].name = 'vw_CreditMemo_Lists'
                    and [all_columns].Name= @l_Name

                --if the paremeter exists, create a where clause
                --  if the parameters does not exists, possible injection
                IF @@ROWCOUNT = 1   
                BEGIN

                    --insert into the temp table the parameter value
                    --NOTE: we have turned in the @@identity as the key
                    INSERT INTO #temp (value) SELECT @l_Value
                    SET @l_FilterKey = @@IDENTITY

                    -- if the parameter is variable in length, add the length
                    DECLARE @l_ParameterVariable VARCHAR(1000)
                    IF @l_ParameterIsVariable = 1
                    BEGIN
                        SET @l_ParameterVariable ='(' + CAST(@l_ParameterMax_length as VARCHAR(MAX))  + ') '
                    END
                    ELSE
                    BEGIN
                        SET @l_ParameterVariable = ''
                    END

                    -- create the where clause for this filter
                    SET @l_TemporaryWhere +=  
                        dbo.sfunc_FilterWhereBuilder2(@l_Operator
                                                     ,@l_ParameterInName
                                                     ,@l_TemporaryWhere
                                                     ,CAST(@l_FilterKey AS VARCHAR(10))
                                                     ,@l_ParameterDataType
                                                     ,@l_ParameterVariable)

                END

                FETCH NEXT FROM OrFilter_cursor 
                INTO @l_Name, @l_Operator,@l_Value  

            END

            -- clean up the cursor
            CLOSE OrFilter_cursor
            DEALLOCATE OrFilter_cursor

            --add the and filers
            IF @l_TemporaryWhere != ''
            BEGIN

                --if the where clause is not empty, we need to add an OR
                IF @l_WhereClause != ''
                BEGIN
                    SET @l_WhereClause += ' or ';
                END

                --add temp to where clause including the 
                SET @l_WhereClause += '(' + @l_TemporaryWhere + ')';

            END

            --get the next AND set
            SET @l_OrFilters = @l_OrFilters - 1

        END

        --generate the where clause
        IF @l_WhereClause != ''
        BEGIN
            SET @l_WhereClause ='('+ @l_WhereClause + ') AND '
        END

        --add in the first mandatory parameter          
        SET @l_WhereClause  += '  vw_CreditMemo_Lists.iDistributorUID = @l_iDistributorUID ' 
        SET @l_Parameters   += '@l_iDistributorUID int'

        --do we need to attach the where clause
        if @l_WhereClause IS NOT NULL AND RTRIM(LTRIM(@l_WhereClause)) != ''
        BEGIN
            SET @l_SqlCommand += ' WHERE '+ @l_WhereClause;
        END

        print @l_SqlCommand

        --query for the data
        EXECUTE sp_executesql @l_SqlCommand ,@l_Parameters, @p_iDistributorUID

    END TRY

    BEGIN CATCH

        DECLARE @ErrorUID int;
        DECLARE @ErrorMessage NVARCHAR(4000);
        DECLARE @ErrorSeverity INT;
        DECLARE @ErrorState INT;

        SELECT 
            @ErrorMessage = ERROR_MESSAGE(),
            @ErrorSeverity = ERROR_SEVERITY(),
            @ErrorState = ERROR_STATE();

        --write the to stored procedure log 
        EXEC @ErrorUID = spp_Errors_CreateEntry @l_SqlCommand 

        -- Use RAISERROR inside the CATCH block to return error
        -- information about the original error that caused
        -- execution to jump to the CATCH block.
        RAISERROR (@ErrorUID, -- Message text.
                   @ErrorSeverity, -- Severity.
                   @ErrorState -- State.
                   );

        IF(CURSOR_STATUS('LOCAL','OrFilter_cursor') >= 0)
        BEGIN
            CLOSE OrFilter_cursor
        END     

        IF(CURSOR_STATUS('LOCAL','OrFilter_cursor') = -1)
        BEGIN
            DEALLOCATE OrFilter_cursor
        END     

    END CATCH

    return

END 
```

功能

```
ALTER FUNCTION [dbo].[sfunc_FilterWhereBuilder2]
(
    @p_Command          SMALLINT                ,
    @p_Field            VARCHAR(1000)           ,
    @p_WhereClause      VARCHAR(MAX)            ,
    @p_KeyValue         VARCHAR(10)             ,
    @p_DataType         VARCHAR(100)    = NULL  ,
    @p_PrecisionScale   VARCHAR(100)    = NULL

)
RETURNS VARCHAR(MAX)
AS
BEGIN
    -- Declare the return variable here
    DECLARE @l_Return       VARCHAR(MAX)
    DECLARE @l_CastToType   VARCHAR(4000)
    DECLARE @l_CastToString VARCHAR(MAX)

    set @l_CastToType = ' CAST( VALUE as ' + @p_DataType + @p_PrecisionScale + ') '
    set @l_CastToString = ' CAST( '+@p_Field+' as VARCHAR(MAX)) '

    -- Add the T-SQL statements to compute the return value here
    SELECT @l_Return =    
        CASE 
            --EQUAL
            --ex: vcBurnUID = (select  value FROM #temp where keyid = 1)
            WHEN @p_Command = 1 
                THEN @p_Field + ' = (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')' 

            --BEGIN WITH
            --ex:vcInvoiceNumber LIKE (select value+'%' FROM #temp where keyid = 2)
            WHEN @p_Command = 2 
                THEN @l_CastToString +' LIKE (select value+'+ QUOTENAME('%','''') +' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --END WITH
            --ex:vcInvoiceNumber LIKE (select '%'+value FROM #temp where keyid = 2)
            WHEN @p_Command = 4 
                THEN @l_CastToString +' LIKE (select '+ QUOTENAME('%','''') +'+value FROM #temp where keyid = ' + @p_KeyValue + ')'

            --END WITH
            --ex:vcInvoiceNumber LIKE (select '%'+value+'%' FROM #temp where keyid = 2)
            WHEN @p_Command = 8 
                THEN @l_CastToString +' LIKE (select '+ QUOTENAME('%','''') +'+value+'+ QUOTENAME('%','''') +' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --greater than
            --ex: iSerialNumber > (select  CAST(value as INT) FROM #temp where keyid = 1)
            WHEN @p_Command = 16 
                THEN @p_Field +' > (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --greater than equal
            --ex: iSerialNumber >= (select  CAST(value as INT) FROM #temp where keyid = 1)
            WHEN @p_Command = 32 
                THEN @p_Field +' >= (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --Less than
            --ex: iSerialNumber < (select  CAST(value as INT) FROM #temp where keyid = 1)
            WHEN @p_Command = 64 
                THEN @p_Field +' < (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --less than equal
            --ex: iSerialNumber <= (select  CAST(value as INT) FROM #temp where keyid = 1)
            WHEN @p_Command = 128 
                THEN @p_Field +' <= (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --less than equal
            --ex: iSerialNumber != (select  CAST(value as INT) FROM #temp where keyid = 1)
            WHEN @p_Command = 256 
                THEN @p_Field +' != (select  '+@l_CastToType+' FROM #temp where keyid = ' + @p_KeyValue + ')'

            --default to an empty string
            ELSE ''

        END 

        if @l_Return != '' and LEN(@p_WhereClause) > 1
        begin
            set @l_Return =  ' AND ' + @l_Return
        end

    -- Return the result of the function
    RETURN @l_Return

END 
```

# grails - Grails MissingMethodException 试图对多个数据源项目进行操作（使用 Java 实体）

> ID：16092849
> 
> 赞同：1
> 
> 时间：2013-04-18T20:52:19.210
> 
> 标签：grails, groovy, datasource

我正在尝试在 Grails 2.2.1 中使用多个数据源，但在访问其他数据源时遇到了一些问题，然后是默认值。POJO（不是 POGO）文件会出现此问题。

问题是当我尝试从非默认数据源调用任何持久性特定操作（如 save()、list()）时，会引发 MissingMethodException（示例如下）。我不知道出了什么问题。我遵循 grails 教程（[http://grails.org/doc/latest/guide/conf.html#dataSourcesAndEnvironments](http://grails.org/doc/latest/guide/conf.html#dataSourcesAndEnvironments)）。

```
def entity = new MyEntity()
entity.myNonDefaultDatasource.save() 
```

这个问题可以通过以下编码流程来解决：
创建一个新的 Grails 应用程序

```
$ grails create-app TestMultiDB 
```

为我的实体类创建新的（包）

```
$ mkdir src/java/testmultidb 
```

使用 JPA 注释创建实体代码

```
$ vim src/java/testmultidb/MyEntity.java 
```

```
package testmultidb;

import javax.persistence.Entity;
import javax.persistence.Id;

@Entity
public class MyEntity {

    @Id
    private long id;

    private String name;

    public void setId(long id) {
        this.id = id;
    }

    public long getId() {
        return this.id;
    }

    public void setName(final String name) {
        this.name = name;
    }

    public String getName() {
        return this.name;
    }
} 
```

编辑 Grails 数据源配置文件

```
$ vim grails-app/conf/DataSource.groovy 
```

```
dataSource {
    pooled = true
    driverClassName = "org.h2.Driver"
    username = "sa"
    password = ""
}

// ***** Added DataSource
dataSource_a2 {
    pooled = true
    driverClassName = "org.h2.Driver"
    username = "sa"
    password = ""
}

hibernate {
    cache.use_second_level_cache = true
    cache.use_query_cache = false
    cache.region.factory_class = 'net.sf.ehcache.hibernate.EhCacheRegionFactory'
}
// environment specific settings
environments {
    development {
        dataSource {
            dbCreate = "create-drop" // one of 'create', 'create-drop', 'update', 'validate', ''
            url = "jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
        }

        dataSource_a2 {
            dbCreate = "create-drop"
            url = "jdbc:h2:mem:devDbA2;MVCC=TRUE;LOCK_TIMEOUT=10000"
        }
    }
    test {
        dataSource {
            dbCreate = "update"
            url = "jdbc:h2:mem:testDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
        }
    }
    production {
        dataSource {
            dbCreate = "update"
            url = "jdbc:h2:prodDb;MVCC=TRUE;LOCK_TIMEOUT=10000"
            pooled = true
            properties {
               maxActive = -1
               minEvictableIdleTimeMillis=1800000
               timeBetweenEvictionRunsMillis=1800000
               numTestsPerEvictionRun=3
               testOnBorrow=true
               testWhileIdle=true
               testOnReturn=true
               validationQuery="SELECT 1"
            }
        }
    }
} 
```

为第二个数据源创建休眠 cfg 文件

```
$ vim grails-app/conf/hibernate/a2_hibernate.cfg.xml 
```

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
          '-//Hibernate/Hibernate Configuration DTD 3.0//EN'
          'http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd'>
<hibernate-configuration>
    <session-factory>
        <mapping class='testmultidb.MyEntity'/>
    </session-factory>
</hibernate-configuration> 
```

创建控制器

```
$ grails create-controller testmultidb.MultDataSources 
```

编辑控制器

```
$ vim grails/controllers/testmultidb/MultDataSourcesController.groovy 
```

```
package testmultidb

import testmultidb.MyEntity

class MultDataSourcesController {

    def index() {

        def entity = new MyEntity()
        entity.id = 0
        entity.name = "Some name"

        MyEntity.a2.save()

        render "-"
    }
} 
```

运行应用程序

```
$ grails run-app 
```

使用权

```
http://localhost:8080/TestMultiDB/multDataSources/index 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T22:50:01.550

这是意料之中的。`entity.save()`可以从 Java 调用，因为该方法是通过 AST 转换添加到域类中的，所以它在字节码中。但是`entity.myNonDefaultDatasource.save()`由于数据源是动态的，所以被添加到元类中。Java 不能调用添加到元类的方法或属性。

您可以调用这些方法，但您需要让您的 Java 代码调用 Groovy 类中的非动态辅助方法，然后再调用动态方法。

# javascript - 如何定义变量并在隐藏的输入字段中调用它？

> ID：16092850
> 
> 赞同：0
> 
> 时间：2013-04-18T20:52:19.817
> 
> 标签：javascript, forms

我有一个 javascript 代码可以做一些数学运算，我需要能够提取最终结果并将其包含在一个表单中。为此，我只想使用`<input type="hidden" name="new total">`. 我想从“新总计”字段中获取结果。你可以在这里看到我的 JavaScript 代码。[http://jsfiddle.net/danielrbuchanan/yjrTZ/5/](http://jsfiddle.net/danielrbuchanan/yjrTZ/5/)

```
var prices = [];

function remove(arr,itm){
    var indx = arr.indexOf(itm);
    if (indx !== -1){
        arr.splice(indx,1);
    }
}

function calculateSectedDues(checkbox, amount) {
    if (checkbox.checked === true) {
        prices.push(amount);
    } else {
        remove(prices, amount);
    }

    var total = 0;
    for (var i = 0, len = prices.length; i < len; i++)
        total += prices[i];

    var min = prices.slice().sort(function(a,b){return a-b})[0];
    if(typeof min === 'undefined') min = 0;

    var withDiscount = total - min;
    var discountAmount = withDiscount - total;

    //document.grad_enroll_form.total.value = total;
    document.querySelector("#value").innerHTML = "Total: $"+total+'<br>';
    document.querySelector("#value").innerHTML += "Discount: $"+discountAmount+'<br>';
    document.querySelector("#value").innerHTML += "New total: $"+withDiscount+'<br>';
} 
```

看起来很简单，出于某种原因，我对如何做一无所知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:04:02.410

我想你想要的是用你的变量设置一个输入值，所以我认为它应该是这样的：

Javascript：

```
document.getElementById("newTotal").value = your_new_total; 
```

HTML：

```
<form>
    <input id='newTotal' type='hidden' name='NewTotal' value='' />
</form> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:04:25.910

```
<input type="hidden" id="new_total" name="new_total">
<!-- no spaces in name and id --> 
```

将此代码放在`calculateSectedDues`函数的末尾

`document.getElementById('new_total').value = withDiscount`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:09:40.190

你有几个选择。

**选项 1：** jQuery

添加一个可见的 div，你想怎么做。将 onChange() 事件绑定到驱动计算的输入字段。

```
<div id="finalValue"></div>

<script language="javascript">
$(function() {
    $("form input").change(function() {
        calculateSectedDues($("#checkboxid"), $("#amountid").val());
    });
});
</script> 
```

在 calculateSectedDues() 函数中将其添加到末尾：

```
$("#finalValue").html("Total: $" + total + "<br />Discount: " + discountAmount + "<br />New Total: " + withDiscount + "<br />"); 
```

**选项 2：** 没有 jQuery

```
<div id="finalValue"></div>

<script language="javascript">
function bindEvent() {
    calculateSectedDues(document.getElementById("checkboxid"), document.getElementById("amountid").value);
}
window.onload = function()
{
    var elJ = document.getElementsByTagName("input");
    for (var i=0;i<elJ.length;i++) {
        elJ[i].addEventListener('change',bindEvent,false);
    }
}
</script> 
```

在 calculateSectedDues() 函数中将其添加到末尾：

```
document.getElementById("finalValue").InnerHtml("Total: $" + total + "<br />Discount: " + discountAmount + "<br />New Total: " + withDiscount + "<br />"); 
```

那是你想要追求的吗？

您还应该记住在服务器端也进行计算，而不是依赖 JavaScript 为您完成计算。这只是为了通知用户他们事先得到了什么。否则，如果您使用隐藏的总计字段，则可以轻松完成前端黑客攻击。

# sage - SAGE + right_kernel() + 基矩阵

> ID：16092856
> 
> 赞同：0
> 
> 时间：2013-04-18T20:52:36.223
> 
> 标签：sage

我对任何二进制矩阵 H 执行了 right_kernel() 指令。为什么我总是得到这种形式的基矩阵 [I|A]（其中 I：恒等矩阵）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T23:49:58.317

一般来说，基矩阵的形式不是`[I|A]`。

根据 sage[文档](http://www.sagemath.org/doc/reference/matrices/sage/matrix/matrix2.html#sage.matrix.matrix2.Matrix.right_kernel)，基础矩阵默认为梯形。

例如

```
sage: H
[1 0 0 1 1]
[1 0 1 0 1]
[1 0 0 0 0]
sage: H.right_kernel()
Vector space of degree 5 and dimension 2 over Finite Field of size 2
Basis matrix:
[0 1 0 0 0]
[0 0 1 1 1] 
```

# django - Django 过滤“或”

> ID：16092858
> 
> 赞同：1
> 
> 时间：2013-04-18T20:52:40.037
> 
> 标签：django, orm, mptt

```
class Tag(models.Model):
  parent = TreeForeignKey('self', null=True, blank=True, related_name='%(class)s_children')
  products = models.ManyToManyField('Product', through="ProductTags", blank=True)

class Product(models.Model):
  tags = models.ManyToManyField('Tag', through="ProductTags", blank=True)

tag_id in POST

currentTag = Tag.objects.get(id=tag_id)

childs = currentTag.get_children().filter(active=True) 
```

应该选择具有当前标签的产品或当前标签的子标签

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T06:39:22.813

```
from django.db.models import Q
products = Product.objects.filter(Q(tags = tag_id) | Q(tags__parent = tag_id)) 
```

应该可以解决问题。

# sql - 如何将一行中的几组不同的列值转换为它们自己的单列？

> ID：16092860
> 
> 赞同：0
> 
> 时间：2013-04-18T20:52:42.860
> 
> 标签：sql, sql-server

在 SQL Server 中，我想知道如何从一行开始，例如：

```
create table t1
(
n1 int,
n2 int,
n3 int,
a1 char, 
a2 char,
a3 char,
b1 char, 
b2 char, 
b3 char
)

insert into t1 values (1, 2, 3, 'a', 'b', 'c', 'x', 'y', 'z') 
```

对于将返回的查询：

```
n1 n2 n3 As Bs

1, 2, 3, a, x 
1, 2, 3, b, y
1, 2, 3, c, z 
```

我要旋转的列组是静态的并且列数相等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:39:50.190

尝试这个

```
SELECT n1,n2,n3,a,b
FROM 
   (SELECT * FROM t1) p
    UNPIVOT (a FOR ACOL IN (a1,a2,a3))AS u1
    UNPIVOT (b FOR BCOL IN (b1,b2,b3))AS u2
WHERE RIGHT(ACOL,1) =  RIGHT(BCOL,1); 
```

[SQL 演示](http://sqlfiddle.com/#!3/ac041/32)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:31:38.423

联合查询怎么样：

```
SELECT
    n1
    , n2
    , n3
    , a1 AS [As]
    , b1 AS [Bs]
FROM 
    t1
UNION ALL
SELECT
    n1
    , n2
    , n3
    , a2
    , b2
FROM 
    t1
UNION ALL
SELECT
    n1
    , n2
    , n3
    , a3
    , b3
FROM t1
order by a1 
```

# ruby-on-rails - FactoryGirl 在开发环境中创建对象

> ID：16092861
> 
> 赞同：6
> 
> 时间：2013-04-18T20:52:44.767
> 
> 标签：ruby-on-rails, mongoid, factory-bot

当我在开发中启动我的 rails 控制台时，我看到 FactoryGirl 创建对象。显然我做错了，但是正确的方法是什么？这段代码使我的测试工作......

```
# tests/factories/board.rb
FactoryGirl.define do

    factory :word do
        sequence(:text) { |n| "FAKETEXT#{n}" }
    end

    factory :board do
        trait :has_words do
            words [
                FactoryGirl.create(:word, id: "514b81cae14cfa78f335e250"),
                FactoryGirl.create(:word, id: "514b81cae14cfa7917e443f0"),
                FactoryGirl.create(:word, id: "514b81cae14cfa79182407a2"),
                FactoryGirl.create(:word, id: "514b81cae14cfa78f581c534")
            ]
        end
    end

end 
```

请注意，在我的目录中的任何文件中都没有提到工厂的任何内容`config`，因此 gem 会自动进行任何加载。我的相关部分`Gemfile`内容如下：

```
# Stuff not to use in production
group :development, :test do
    # Command-line debugger for development
    gem "debugger"

    # for unit testing - replace fixtures
    gem "factory_girl_rails"
end 
```

所以我可以把工厂女孩带出开发环境。但我认为这些记录是在使用工厂之前创建的，这表明我写错了我的工厂。但如果你告诉我工厂写得对，我就照做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-31T19:45:56.480

有同样的问题。有两种方法可以解决这个问题，

## 1\. 使用 FactoryGirl 语法在 Factory 中引用 Factory。

替换`FacotryGirl.create(:my_factory)`为`factory: :my_factory`

有关此的更多信息，[https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#associations](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#associations)

## 2.`factory_girl :require => false`在 Gemfile

这会导致工厂在启动时生成对象，

```
group :development, :test do  
  gem 'factory_girl_rails'
end 
```

**为什么？**在 Rails 启动期间，Bundler 需要`development`组中的所有 gem，而 FactoryGirl 似乎需要所有它们的工厂文件。要求工厂评估 Ruby 代码，因此`FactoryGirl.create(:my_factory)`被调用。

这可以通过以下方式解决，

```
# Gemfile
group :development, :test do  
  gem 'factory_girl_rails', :require => false
end 
```

**只需确保在您的测试环境中手动要求 factory_girl**，例如

```
# spec_helper
require 'factory_girl' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-26T00:23:12.350

您只需要将工厂女孩移出开发环境即可。

我有同样的问题，所以我只是做了

```
group :test do
  gem 'faker'
  gem 'factory_girl_rails'
end 
```

并且像魅力一样工作。

我根本没有在开发中使用这些宝石，所以在测试中定义它们是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T22:45:51.920

假设您希望在调用工厂时而不是在 Rails 启动时创建单词，那么您需要将单词数组放在一个块中，即：

```
trait :has_words do
        words do [
            FactoryGirl.create(:word, id: "514b81cae14cfa78f335e250"),
            FactoryGirl.create(:word, id: "514b81cae14cfa7917e443f0"),
            FactoryGirl.create(:word, id: "514b81cae14cfa79182407a2"),
            FactoryGirl.create(:word, id: "514b81cae14cfa78f581c534")
            ]
        end 
    end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-21T01:32:38.913

对于每个工厂或模型，您必须放入不同的文件

```
spec/factories/word_factory.rb
spec/factories/board_factory.rb 
```

所以每个工厂的内容，你可以做类似这样的事情：

```
FactoryGirl.define do
  factory :board do
    word
    special_id
  end
end 
```

在您的测试文件夹中时，例如 models/board_spec.rb

你可以创建你的对象

```
let(:word) { FactoryGirl.create(:word)
let(:board) { FactoryGirl.create(:board, word: word) } 
```

不确定这是你需要的，如果我错了，请纠正我

# rvm - Mac 10.5.8 上的 Ruby 2.0 通过 RVM

> ID：16092864
> 
> 赞同：0
> 
> 时间：2013-04-18T20:52:54.807
> 
> 标签：rvm, osx-leopard, ruby-2.0

我的 Ruby 和 Gem 环境一直存在一些问题，我想将它们全部清除并重新开始。因此，我删除了 rvm ( `rvm 1.13.8 (stable)`) 中的所有 ruby​​，这让我得到了 Ruby 1.8.6 和 Gem 1.0.1 的库存。我也考虑过删除这些，但我读到的所有内容都说它们应该没问题。无论如何，我去安装 Ruby 2.0 但 RVM 有 1.9.3 作为最新版本，我想知道它是否是因为我在 G4 MDD 上运行 10.5.8 以及是否有可能安装它。我运行 10.8 的 MacBook Pro 能够安装它。

```
$ rvm list known
# MRI Rubies
[ruby-]1.8.6[-p420]
[ruby-]1.8.7[-p358]
[ruby-]1.8.7-head
[ruby-]1.9.1[-p431]
[ruby-]1.9.2-p180
[ruby-]1.9.2-p290
[ruby-]1.9.2-p318
[ruby-]1.9.2[-p320]
[ruby-]1.9.2-head
[ruby-]1.9.3-preview1
[ruby-]1.9.3-rc1
[ruby-]1.9.3-p0
[ruby-]1.9.3-p125
[ruby-]1.9.3-[p194]
[ruby-]1.9.3-head
ruby-head 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T19:24:49.887

您需要更新 RVM，版本是更新的一部分：

```
rvm get head
rvm list known | grep 2.0.0 
```

这使：

```
[ruby-]2.0.0-rc1
[ruby-]2.0.0-rc2
[ruby-]2.0.0[-p0]
rbx-2.0.0-rc1 
```

# c++ - 这个函数如何将文本读入结构？

> ID：16092870
> 
> 赞同：0
> 
> 时间：2013-04-18T20:53:25.087
> 
> 标签：c++, iostream

我试图了解以下功能到底在做什么。它用于将文本文件读入一个名为的**结构**`AEntry`中，该结构仅包含四个整数。

该文件包含行列表。每行包含四个用**空格**（或**制表**符）分隔的整数。

调用此函数时，传入一行 of`istream`和 a `AEntry` `struct`。

我的问题是如何过滤掉分隔符、空格或制表符？或者我的理解是错误的。

```
istream& operator>>( istream &stream, AEntry& val )
{
    stream >> val.kv;
    stream >> val.col;
    stream >> val.bo;
    stream >> val.Offset;
    return stream;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:55:46.537

它们被过滤掉了，因为这是`istream::operator>>`. 他们停在空白处并丢弃它，而不是将其合并到提取的输出中。

# sql - 在 SSMS（Sql Server 管理工作室）中，当列为只读时，如何添加一行？

> ID：16092872
> 
> 赞同：0
> 
> 时间：2013-04-18T20:53:25.840
> 
> 标签：sql, sql-server-2008, ssms

当列是只读的时，如何添加一行？我认为我遇到的这个问题是因为我使用了一个 ID 字段（列），每当在 Microsoft SQl Server Management Studio 中添加新行时，它就会自动生成并递增，我无法手动更改 ID 字段并且它看起来不同（灰色）颜色。

不知何故，有一次，在我输入了行中的所有其他项目并在键盘上按“Enter”后，我设法添加了一行，并自动生成了 ID 字段。问题是它似乎没有乱序添加它。我不知道为什么会是 159 而不是 157

[http://i67.photobucket.com/albums/h292/Athono/sql%20server/stuck_zps00d884e5.png](http://i67.photobucket.com/albums/h292/Athono/sql%20server/stuck_zps00d884e5.png)

我删除了该行并再次尝试。这一次，它给了我一个错误：

[http://i67.photobucket.com/albums/h292/Athono/sql%20server/stuck02_zpsf175086e.png](http://i67.photobucket.com/albums/h292/Athono/sql%20server/stuck02_zpsf175086e.png)

当我尝试手动编辑该字段时，似乎我不允许：

[http://i67.photobucket.com/albums/h292/Athono/sql%20server/stuck03_zpse022ed98.png](http://i67.photobucket.com/albums/h292/Athono/sql%20server/stuck03_zpse022ed98.png)

请指教。

我正在使用 SQL Server 2008 R2

如果这有帮助，这里是版本号：

Microsoft SQL Server 管理工作室 --- 10.50.2500.0

Microsoft 分析服务客户端工具 --- 10.50.2500.0

Microsoft 数据访问组件 (MDAC) --- 6.1.7601.17514

微软 MSXML --- 3.0 4.0 5.0 6.0

微软 Internet Explorer --- 9.0.8112.16421

Microsoft .NET Framework 2.0.50727.5466 操作系统 6.1.7601

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:23:25.703

当您删除数据库中的一行时，ID 列不会重置。相反，该表使用序列中的下一个 ID 继续前进。

您插入一行，获取 ID#1，插入一行，获取 ID#2，然后删除行#2。您期望下一个插入是#2，但实际上是#3。

# c# - 我无法组合创建收据的系统

> ID：16092876
> 
> 赞同：-4
> 
> 时间：2013-04-18T20:54:01.817
> 
> 标签：c#, textbox

我的招聘人员给了我一个编码任务，作为初级开发人员的工作。有三个选择，我遇到了一个需要计算购买的问题。除非是书籍、食品或药品，否则所有物品都应征收 10% 的税。任何进口的东西都要额外征税 5%，即使它们是免税的。因此，我创建了一个表单，允许用户输入商品名称、两个用于输入商品或免税商品的复选框、一个用于输入价格的文本框以及一个用于每个输入的文本框。下面是一个用于计算总销售税的文本框，下面是一个总计的文本框。第一个复选框名为“Item1Import”，下一个复选框名为“Item1Exempt”。价格文本框名为“Item1Price”，另一个名为“Item1Output”。

这是我到目前为止的代码。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
     public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

        private void Item1Price_TextChanged(object sender, EventArgs e)
            {
                if(Item1Exempt.Checked && Item1Import.Checked)
                {
                    Item1Output.Text = ((Convert.ToInt32(Item1Price.Text)) + (Convert.ToInt32(Item1Price.Text) * 0.05).ToString("C2"));
                }
                else if(Item1Exempt.Checked && !Item1Import.Checked)
                {
                    Item1Output.Text = (Convert.ToInt32(Item1Price.Text)).ToString("C2");
                }
                else if(!Item1Exempt.Checked && Item1Import.Checked)
                {
                    Item1Output.Text = ((Convert.ToInt32(Item1Price.Text) + (Convert.ToInt32(Item1Price.Text) * 0.1) + (Convert.ToInt32(Item1Price.Text) * 0.05)).ToString("C2"));
                }
                else
                {
                    Item1Output.Text = ((Convert.ToInt32(Item1Price.Text)) + (Convert.ToInt32(Item1Price.Text) * 0.1)).ToString("C2");
                }

            }

        private void Item2Price_TextChanged(object sender, EventArgs e)
            {
                if (Item2Exempt.Checked && Item2Import.Checked)
                {
                    Item2Output.Text = ((Convert.ToInt32(Item2Price.Text)) + (Convert.ToInt32(Item2Price.Text) * 0.05).ToString("C2"));
                }
                else if (Item2Exempt.Checked && !Item2Import.Checked)
                {
                    Item2Output.Text = (Convert.ToInt32(Item2Price.Text)).ToString("C2");
                }
                else if (!Item2Exempt.Checked && Item2Import.Checked)
                {
                    Item2Output.Text = ((Convert.ToInt32(Item2Price.Text) + (Convert.ToInt32(Item2Price.Text) * 0.1) + (Convert.ToInt32(Item2Price.Text) * 0.05)).ToString("C2"));
                }
                else
                {
                    Item2Output.Text = ((Convert.ToInt32(Item2Price.Text)) + (Convert.ToInt32(Item2Price.Text) * 0.1)).ToString("C2");
                }
            }

        private void Item3Price_TextChanged(object sender, EventArgs e)
            {
                if (Item3Exempt.Checked && Item3Import.Checked)
                {
                    Item3Output.Text = ((Convert.ToInt32(Item3Price.Text)) + (Convert.ToInt32(Item3Price.Text) * 0.05).ToString("C2"));
                }
                else if (Item3Exempt.Checked && !Item3Import.Checked)
                {
                    Item3Output.Text = (Convert.ToInt32(Item3Price.Text)).ToString("C2");
                }
                else if (!Item3Exempt.Checked && Item3Import.Checked)
                {
                    Item3Output.Text = ((Convert.ToInt32(Item3Price.Text) + (Convert.ToInt32(Item3Price.Text) * 0.1) + (Convert.ToInt32(Item3Price.Text) * 0.05)).ToString("C2"));
                }
                else
                {
                    Item3Output.Text = ((Convert.ToInt32(Item3Price.Text)) + (Convert.ToInt32(Item3Price.Text) * 0.1)).ToString("C2");
                }
            }

        private void Item4Price_TextChanged(object sender, EventArgs e)
            {
                if (Item4Exempt.Checked && Item4Import.Checked)
                {
                    Item4Output.Text = ((Convert.ToInt32(Item4Price.Text)) + (Convert.ToInt32(Item4Price.Text) * 0.05).ToString("C2"));
                }
                else if (Item4Exempt.Checked && !Item4Import.Checked)
                {
                    Item4Output.Text = (Convert.ToInt32(Item4Price.Text)).ToString("C2");
                }
                else if (!Item4Exempt.Checked && Item4Import.Checked)
                {
                    Item4Output.Text = ((Convert.ToInt32(Item4Price.Text) + (Convert.ToInt32(Item4Price.Text) * 0.1) + (Convert.ToInt32(Item4Price.Text) * 0.05)).ToString("C2"));
                }
                else
                {
                    Item4Output.Text = ((Convert.ToInt32(Item4Price.Text)) + (Convert.ToInt32(Item4Price.Text) * 0.1)).ToString("C2");
                }
            }

        private void SalesTax_TextChanged(object sender, EventArgs e)
            {
                SalesTax.Text = (((Convert.ToInt32(Item1Output.Text) - Convert.ToInt32(Item1Price.Text)) + ((Convert.ToInt32(Item2Output.Text) - Convert.ToInt32(Item2Price.Text)) + ((Convert.ToInt32(Item3Output.Text) - Convert.ToInt32(Item3Price.Text)) + ((Convert.ToInt32(Item4Output.Text) - Convert.ToInt32(Item4Price.Text)).ToString("C2"));
            }

        private void Total_TextChanged(object sender, EventArgs e)
            {
                Total.Text = ((Convert.ToInt32(Item1Output)) + (Convert.ToInt32(Item1Output)) + (Convert.ToInt32(Item1Output)) + (Convert.ToInt32(Item1Output)).ToString("C2"));
            }

    }
} 
```

我遇到的第一个问题是每当我输入 Item1Price 时，它​​会输出到 Item1Output 但它不能与其他人一起使用，并且“销售税”和“总计”文本框也不显示任何内容。

第二个问题是我不能输入像“O.OO”这样的数字，但我可以输入“00”，每当我删除数字时，它就会崩溃。

任何帮助将非常感激。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:19:54.007

首先，在论坛上发布编码任务以获得工作帮助并不是一种好的方式。如果你不能自己完成编码任务，我建议你重新评估你的技能，问问自己是否准备好接受你想要获得的职位。话虽如此，我记得我刚开始从事那些我当时可能没有生意的职位的日子，所以我对此表示同情。现在到你的代码。

首先，您需要将转换包含在 try catch 块中，您的应用程序崩溃的原因是因为 0.00 不会转换为整数，因为那里有小数。00 将起作用，但是当您删除它们时，您的 textbox.text 值现在什么也不会转换，并且您的程序将崩溃。因此，您将需要添加逻辑来处理空字符串值而不进行转换。我建议您在处理货币值时使用十进制数据类型。正如我所建议的那样，我将创建一个方法，您可以在其中传递复选框值并返回一个字符串值以设置您的文本框值。这可以清理您的事件处理程序代码，因为您的计算似乎是相同的。

# java - 添加新组件后自动更新 JFrame 大小

> ID：16092878
> 
> 赞同：4
> 
> 时间：2013-04-18T20:54:10.227
> 
> 标签：java, swing, jframe, jpanel

我有一个 JFrame，里面有一个 JPanel（使用 Window Builder Pro 时的默认内容）。在我的代码中，我添加了一个新的 JPanel，但外部 JFrame 无法重新调整大小以适应新组件。所以我必须手动拖动。

这是一个屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/u9lFS.jpg)

我怎样才能做到无论我放什么，JFrame 都会自动更新它的大小以适应新的 Swing 组件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:57:16.603

添加新组件后，尝试调用

```
frame.pack() 
```

在封闭的框架上。pack 方法将根据其底层组件的大小设置框架的大小。这实际上是 Window 类的一个方法，文档可用[here](http://docs.oracle.com/javase/6/docs/api/java/awt/Window.html#pack%28%29)

如果您手边没有对 Window/Frame 的引用，一个简单的方法是 在添加***后***在面板上调用[SwingUtilities.getWindowAncestor](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#getWindowAncestor%28java.awt.Component%29) () 。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T20:57:14.257

如何在WindowsBuilder中实现这个我不能说，但是在运行时，只需`pack`在框架上调用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T20:57:41.133

重塑封闭的本机窗口、框架或对话框以适应其内容的常用方法是`pack`. 请参阅[此处的示例](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)。如果您需要从轻量级孩子那里访问例如框架，您可以使用

```
JFrame topFrame = (JFrame) SwingUtilities.getWindowAncestor(this); 
```*

# javascript - 具有 Python 和 JavaScript 引擎的多操作系统基于文本的数据库

> ID：16092879
> 
> 赞同：1
> 
> 时间：2013-04-18T20:54:11.287
> 
> 标签：javascript, python, database, json, wxpython

这可能有点牵强，但也许有人知道一个好的解决方案。

**介绍**

我目前正在使用新的 wxPython 2.9 在 Python 中制作应用程序，它具有新的`html2`库，它将继承每个操作系统的本机浏览器（Safari/IE/Firefox/Konquerer/~），这真的很棒。

**目标/目的**

我目前的目标是处理大量数据并使用 Python 超快速地对其进行分析（目前大约有 110.000 个条目，在字典中产生大约 1.500.000 到 2.250.000 个结果）。这工作得非常快而且也是动态的，所以它只会做第一次大提取一次（只需要大约 2-4 秒），然后如果在磁盘上创建了新数据，它就会继续监听。

到目前为止，一切都很好。现在有了新的 wxPython`html2`库，我正在制作新的 GUI。它主要用于显示页面，所以我现在制作的是`/html/`文件夹中的模型（使用 HTML/CSS/jQuery），它会动态查找 JSON 文件（jQuery 获取），这实际上是海量文件的完整转储Python 脚本在并行线程的后台（守护进程）中创建的字典。

JavaScript 在读取大的 JSON 文件时似乎没有问题，而且因为一切都是（并且保持）本地的，所以它不会真正导致缓慢或任何事情。CPU和内存使用率也很低。

**结论**

但瓶颈来了。从 JavaScript 的角度来看，处理大的 JSON 文件并不是一件轻松的事。我必须对需要获取的所有数据进行大量搜索和匹配，并且还会在相同的大块条目中创建大量冗余的重新循环。

**问题**

我想知道是否有任何一种为 Python 和 JavaScript 实现的“引擎”可以处理 JSON 文件，或者其他基于文本的文件作为数据库。这意味着你真的可以拥有一个类似 MySQL 的结构（当然不是完全扩展），你至少可以定义一个保存数据的表结构，并且你可以有条不紊地进行读/写/更新。

我目前正在开发的应用程序是基于多操作系统的（至少是 Ubuntu、OS X 和 Windows XP+）。我也真的不想创建比使用 wxPython（出于分发/依赖关系）使用扩展数据库（就像我可以在 localhost 上运行 MySQL 服务器）更混乱的情况，所以纯粹将它保存在我的 Python 发行版文件夹中。这也是为了防止编写大量代码（检查）检查用户是否已经使用了可能与我随后安装的应用程序发生冲突的服务器/数据库。

* * *

***最后的笔记***

我的目标是自己也为未来的项目构建某种 API，以便为需要 GUI 的 Python 脚本制定这种开发标准。现在 wxPython 可以更轻松地拥抱现代浏览器技术；构建超级快速、动态和响应迅速的图形 Python 应用程序似乎不再有任何限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:45:09.923

为什么不直接将数据粘贴到 SQLite 数据库中，然后让 Python 和 Javascript 都使用它呢？另请参阅[在 Python 中将 JSON 转换为 SQLite - 如何将 json 键正确映射到数据库列？](https://stackoverflow.com/questions/8811783/convert-json-to-sqlite-in-python-how-to-map-json-keys-to-database-columns-prop)

Sqlite 包含在所有现代版本的 Python 中。您必须查看 SQLite 网站以了解其限制

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:52:40.320

通过运行 CGI HTTP 服务器并让 Python 在其中获取 JavaScript 的 AJAX 调用的 SQLite 查询，有点想通了。这是一个小演示（仅在 OS X 上测试）：

***文件夹结构***

```
main.py
cgi/index.py
data/
html/index.html
html/scripts/jquery.js
html/scripts/main.js
html/styles/main.css 
```

**Python 服务器 (main.py)**

```
### CGI Server ###
import CGIHTTPServer
import BaseHTTPServer

class Handler(CGIHTTPServer.CGIHTTPRequestHandler):
    cgi_directories = ['/cgi']

    # Mute the messages in the shell
    def log_message(self, format, *args):
        return

httpd = BaseHTTPServer.HTTPServer(('', 61350), Handler)
#httpd.serve_forever()
thread = threading.Thread(name='CGIHTTPServer', target=httpd.serve_forever)
thread.setDaemon(True)
thread.start()

#### TEST SQLLite ####
# Make the database file if it doesn't exist
if not os.path.exists('data/sqlite.db'):
    db_file = open('data/sqlite.db', 'w')
    db_file.write('')
    db_file.close()
import sqlite3
conn = sqlite3.connect('data/sqlite.db')
cursor = conn.cursor()
cursor.execute('CREATE TABLE info(id INTEGER UNIQUE PRIMARY KEY, name VARCHAR(75), folder_name VARCHAR(75))')
cursor.execute('INSERT INTO info VALUES(null, "something1", "something1_name")')
cursor.execute('INSERT INTO info VALUES(null, "something2", "something1_name")')
conn.commit() 
```

**Python SQLite 处理器 (cgi/index.py) (demo 纯粹用于 SELECT，需要更多动态)**

```
#!/usr/bin/env python
import cgi
import json
import sqlite3
print 'Content-Type: text/json\n\n'

### Fetch GET-data ###
form = cgi.FieldStorage()
obj = {}

### SQLite fetching ###
query = form.getvalue('query', 'ERROR')
output = ''

if query == 'ERROR':
    output = 'WARNING! No query was given!'
else:
    # WARNING: The path probably needs `../data/sqlite.db` if PYTHONPATH is not defined
    conn = sqlite3.connect('data/sqlite.db')
    cursor = conn.cursor()
    cursor.execute(query)
    # TODO: Add functionality/detect if it's a SELECT, INSERT/UPDATE (then we need to conn.commit() )
    result = cursor.fetchall()

    if len(result) > 0:
        output = []

        for row in result:
            buff = []

            for entry in row:
                buff.append(entry)

            output.append(buff)
    else:
        output = 'WARNING! No results found'

obj = output

### Return the data in jSON (map) format for JavaScript
print json.dumps(obj) 
```

**JavaScript (html/scripts/main.js)**

```
'use strict';
$(document).ready(function() {
    // JSON data read test
    var query = 'SELECT * FROM test';

    $.ajax({
        url: 'http://127.0.0.1:61350/cgi/index.py?query=' + query,
        success: function(data) {
            lg(data);
        },
        error: function() {
            lg('Something went wrong while fetching the query.');
        }
    });
}); 
```

这就结束了。浏览器中的控制台输出是；

```
[
    [1, "something1", "something1_name"],
    [2, "something2", "something2_name"]
] 
```

使用这种方法，您可以让 Python 和 JavaScript 在同一个数据库中读/写，而 Python 继续执行其系统任务（守护进程）并更新数据库条目，而 JavaScript 可以继续检查新数据。

这种方法可能还可以为听众和两者之间的其他交流方式增加空间。

由于`main.py`守护程序，将立即停止运行。这是因为我的 wxPython 脚本在它之后使守护程序（服务器）保持活动状态，直到应用程序停止。如果其他人想在将来使用此代码；只需确保服务器代码在 SQLite 启动后运行并取消引用`httpd.serve_forever()`以使其保持运行。

# mysql - C# SQL Linq 获取所有重复项

> ID：16092882
> 
> 赞同：0
> 
> 时间：2013-04-18T20:54:21.843
> 
> 标签：mysql, linq, c#-4.0

请告诉我如何解决问题。

我必须序列（numbersA 和 numbersB）。在输出中，我只需要第二个序列（numbersB）中可用的元素。

int[] numbersA = { 0, 2, 4, 4, 6, 8, 9 }; int[] numbersB = { 2, 4 };

数字A - 数字B = 2, 4 ,4

except() 或 Intersect() 不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:57:17.057

听起来你想要这样的东西：

```
var result = numbersA.Where(x => numbersB.Contains(x)); 
```

如果它非常小也没关系`numbersB`，但是随着它变大，您可能希望更改为：

```
var numbersBSet = new HashSet<int>(numbersB);
var result = numbersA.Where(x => numbersBSet.Contains(x)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:58:15.277

从第二个列表创建一个 HashSet 以便查找速度快，然后执行以下操作：

```
int[] numbersA = { 0, 2, 4, 4, 6, 8, 9 }; 
int[] numbersB = { 2, 4 };
var set = new HashSet<int>(numbersB);
var finalList = numbersA.Where(n => set.Contains(n)); 
```

# sql - 使用正则表达式从字符串中删除中断标签

> ID：16092886
> 
> 赞同：3
> 
> 时间：2013-04-18T20:54:42.167
> 
> 标签：sql, regex

从字符串/数据库文本类型字段中删除所有 html 效果很好，我怎样才能省略中断标签：

```
update hazHRA set identityRisk=dbo.RegexReplace('<(?:[^>''"]*|([''"]).*?\1)*>',
'',identityRisk,1,1); 
```

我希望保留

```
<br> 
```

只要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:18:00.503

这应该做的工作：

`(?i)<(?:(?!br>|br/>)[^>'"]*|(['"]).*?\1)*>`

**(?i)**：不区分大小写。

**(?!br>|br/>)**：负前瞻。

[在线演示](http://regex101.com/r/dW5hP9)。

* * *

如果您可以在前瞻中使用量词，则可以使用：

`(?i)<(?:(?!br\s*>|br\s*/>)[^>'"]*|(['"]).*?\1)*>`

这将确保不`<br >`与空格匹配。

[在线演示](http://regex101.com/r/yT1sG4)。

# scala - 对 sbt 子项目进行汇总分析

> ID：16092888
> 
> 赞同：1
> 
> 时间：2013-04-18T20:54:48.397
> 
> 标签：scala, sbt

在 sbt 中，如果我`mapR`在`compile`任务上使用，我可以获得一个`Analysis`可以让我收获警告和其他信息的对象。这使我能够以编程方式跟踪特定于项目的警告统计信息。

但是，我使用 sbt 的聚合功能在根项目下聚合了许多子项目。有没有一种惯用的方法可以将这些信息（或任意信息）聚合到这样的聚合树上？例如，如果我想知道整个构建中的警告总数，我该怎么做？我可以在我的 sbt 项目中维护全局 Scala 级别的状态，并`AtomicInteger`在每个项目的`compile`步骤之后添加，但这感觉很难看，我觉得必须有更好的方法。

对于上下文，我想告诉 TeamCity 构建中的警告总数，所以我需要能够聚合这样的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T16:40:48.780

有一种特定于获取分析的直接方法，但`Analysis`前提是您想要的所有值都在类路径中。在 sbt 中，类路径的类型为`Seq[Attributed[File]]`. [Attributed](http://www.scala-sbt.org/0.12.3/api/#sbt.Attributed)部分将元数据附加到每个条目。一个元数据是`Analysis`该条目的（显然只有当它是从源代码编译时）。

所以，这将得到`Seq[Analysis]`一个类路径：

```
... (fullClasspath in Compile) map { (cp: Seq[Attributed[File]]) =>
   cp.map(entry => Defaults.extractAnalysis(entry)._2)
} 
```

请注意，如果没有附加，则[实现](https://github.com/sbt/sbt/blob/v0.12.3/main/Defaults.scala#L44)为`Defaults.extractAnalysis`空。`Analysis`

* * *

在 0.13 中，终于有一个 API 可以做到这一点：

[http://www.scala-sbt.org/snapshot/docs/Detailed-Topics/Tasks.html#multiple-scopes](http://www.scala-sbt.org/snapshot/docs/Detailed-Topics/Tasks.html#multiple-scopes)

在这种情况下，它看起来像：

```
someTask := {
   val allA: Seq[inc.Analysis] = compile.result.all(
      ScopeFilter( inAggregates(ThisProject), inConfigurations(Compile) )
   ).value
   ...
} 
```

（该部分与直接语法 `result`中的相同： [http](http://www.scala-sbt.org/snapshot/docs/Detailed-Topics/Tasks.html#result) ://www.scala-sbt.org/snapshot/docs/Detailed-Topics/Tasks.html#result ）`mapR`

# sql - 如何将 PostgreSQL hstore 列转换为行？

> ID：16092890
> 
> 赞同：4
> 
> 时间：2013-04-18T20:54:56.377
> 
> 标签：sql, postgresql, hstore

什么 SQL 查询会将[PostgreSQL](http://www.postgresql.org/) [hstore](http://www.postgresql.org/docs/9.2/static/hstore.html)列转换为常规表，其中所有 hstore 行中的不同键形成表中的列，值填充相应列中的行？

例如，如何转换 hstore 列

```
hstore
------------------------------------
"a"=>"1", "b"=>"2", "c"=>"3"
"a"=>"4", "b"=>"6", "c"=>"5", "d"=>7
"a"=>"8", "b"=>"3", "c"=>"8" 
```

进入“等效”表

```
a   b   c   d
---------------
 1 | 2 | 3 |
 4 | 6 | 5 | 7 
 8 | 3 | 8 | 
```

其中不同的 hstore 键 a、b、c 和 d 构成表中的列，它们的值填充每列中的行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T21:12:29.317

您不能动态执行此操作，但如果您创建与输出匹配的类型，则可以执行此操作。

```
create table foo (data hstore);
create type foo_type as (a text, b text, c text);

insert into foo (data) 
values 
('a => 1, b => 2'),
('a => 1, b=>2, c => 3'),
('a => 1');

select (populate_record(null::foo_type, data)).*
from foo; 
```

返回：

```
一个 | 乙 | C
--+----+--
1 | 2 |  
1 | 2 | 3
1 | |  

```

请注意，如果您有一个与您想要的列匹配的表，您也可以使用“表类型”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-05T14:04:14.290

我知道问题已得到解答，但我遇到了类似的问题。我需要转换 hstore 值，以便可以直接将数据插入到表中。这是我得到的解决方案：

```
INSERT INTO foo 
SELECT (populate_record(null::foo, 'a => 1, b=>2, c => 3'::hstore)).*; 
```

当然，hstore 列必须在表中，否则它们将被忽略。希望这可以帮助像我一样最终来到这里的其他人。:)

# c# - 目标服务器恢复后，ASP.NET 中的出站 HttpWebRequest 仍然超时

> ID：16092891
> 
> 赞同：1
> 
> 时间：2013-04-18T20:55:07.197
> 
> 标签：c#, asp.net, httpwebrequest

我们有一个 ASP.NET Web 应用程序 (MVC3)，它使用 HttpWebRequest 调用另一个 Web 服务器。

无论如何，当远程服务器宕机时，我们开始收到超时错误，这是我们所预料的。

但是，当远程服务器恢复时，我们继续收到超时错误。刷新应用程序池解决了这个问题，但我们真的不希望每次都重新启动应用程序池。

是否存在可能存储错误超时连接的池？我的期望是，如果连接抛出错误，它会被处理掉，然后我们会在下一次得到一个新的连接，但情况似乎并非如此。

这是我们的代码的样子：

```
var request = (HttpWebRequest)HttpWebRequest.Create(url);
int timeout = GetTimeout();
request.ReadWriteTimeout = timeout;

WebRequest.DefaultWebProxy = null; 

var asyncResult = request.BeginGetResponse(null, null);
bool complete = asyncResult.AsyncWaitHandle.WaitOne(timeout);
if (!complete)
{
    ThrowTimeoutError(url, timeout);
}
using (var webResponse = request.EndGetResponse(asyncResult))
{
    using (var responseStream = webResponse.GetResponseStream())
    {
        using (var responseStreamReader = new StreamReader(responseStream))
        {
            responseXml = responseStreamReader.ReadToEnd();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:13:11.397

您是否看过/尝试过[ServicePoint 类的](http://msdn.microsoft.com/en-us/library/system.net.servicepoint.aspx)[CloseConnectionGroup](http://msdn.microsoft.com/en-us/library/system.net.servicepoint.closeconnectiongroup%28v=vs.100%29.aspx)方法？

从 MSDN 文档：

> 连接组将一组请求与特定连接或一组连接相关联。此方法删除并关闭属于指定连接组的所有连接。

调用此方法可能会重置您的连接，而无需重新启动池。

# android - Eclipse Memory Analyzer 主饼图中的 Remainder 是什么？

> ID：16092893
> 
> 赞同：6
> 
> 时间：2013-04-18T20:55:13.953
> 
> 标签：android, memory, memory-management, memory-leaks, eclipse-memory-analyzer

我刚开始学习 Android 的内存管理。在对我正在处理的应用程序进行内存转储并使用 Eclipse 内存分析器对其进行分析后，我发现“剩余内存”占用了 37MB（在 50M 保留内存中）。这个 50M 的数字与我的 logcat 保留内存匹配，所以我猜这个 Remainder 确实占用了一些内存：

```
GC_CONCURRENT freed 12839K, 21% free 50038K/62908K, paused 7ms+15ms, total 144ms 
```

有人知道这个剩余部分通常是由什么组成的吗？这是否表明我有一些内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-18T09:33:09.777

剩下的就是剩下的部分，不像以前的那样占主导地位。

为实例：

1）位图占用10M

2）资源占用5M

3）RelativeLayout占用100K

4）LinearLayout占用20K...

在地图上，只有 1) 2) 出现，而​​ 3), 4) ... 包含在其余部分中。

# regex - 以下 awk 脚本示例的含义是什么？

> ID：16092894
> 
> 赞同：0
> 
> 时间：2013-04-18T20:55:16.950
> 
> 标签：regex, awk, gawk

我有这个例子

```
BEGIN { print "*** WARNING WARNING WARNING ***" }

/\<[8|9][0-9]%/ { print "Partition " $6 "\t: " $5 " full!" }

END { print "*** Give money for new disks URGENTLY! ***" } 
```

大部分我都懂，除了以下

```
/\<[8|9][0-9]%/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:00:38.430

这是一个正则表达式，将匹配 word-start`\<`后跟`8`，`|`或`9`(`[8|9]`应该是`[89]`) 后跟数字 ( `[0-9]`) 后跟`%`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:05:17.313

该`BEGIN`块在读取任何输入文件之前执行一次，只打印文字字符串`*** WARNING WARNING WARNING ***`。同样，该`END`块也仅在读取所有输入文件后才执行一次，并且仅打印升字符串`*** Give money for new disks URGENTLY! ***`。所有其他块都针对前一个条件评估为真的每一行执行。

```
BEGIN { 
    print "*** WARNING WARNING WARNING ***"
}    
/\<[8|9][0-9]%/{                             
    print "Partition",$6,"\t:",$5,"full!"
}    
END { 
    print "*** Give money for new disks URGENTLY! ***" 
} 
```

条件`/\<[8|9][0-9]%/`是正则表达式匹配整行，其中正则表达式的含义如下：

```
\<    # Word Start 
[8|9] # Either an 8 or | or 9 (think this should be [89])
[0-9] # A digit
%     # literal percent character 
```

基本上，如果该行包含正则`80% - 99%`表达式将匹配的范围内的任何位置，并且将打印以下内容：字符串`Partition`后跟当前行的第六个字段，然后是 TAB，然后是`:`，然后是当前行的第五个字段，最后是字符串`full`。默认的字段分隔符`awk`是空格。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T21:00:59.477

如果它匹配 <80% 到 <99%，则显示消息 Partition### Full

# c# - 使用 C# 将一些数据插入到多个表中

> ID：16092895
> 
> 赞同：4
> 
> 时间：2013-04-18T20:55:19.630
> 
> 标签：c#, asp.net

我试图一次将一些数据插入到 2 个表中，但我的代码遇到的问题是......我一次只能插入一个表。如果我注释掉第一个插入语句，那么第二个插入将起作用，反之亦然。

这是我的代码

```
 SqlCommand cmd = new SqlCommand("select Name from MainTable where Name= '" + Name+ "'  ", sqlcon);
 SqlDataReader dr = cmd.ExecuteReader();
 if (dr.Read())
 {
    lblmsg.Text = "We are already have  this Name" + Name;
 }

 else
 {
    dr.Close();
    sqlcmd.CommandText = "INSERT INTO Table1(Name, Address) VALUES(@Name, @Address)";
    sqlcmd.CommandText = "INSERT INTO Table2(Company, Address2) VALUES(@Company, @Address2)";

    sqlcmd.Parameters.Clear();
    sqlcmd.Parameters.Add("@Name", SqlDbType.VarChar).Value = Name;
    sqlcmd.Parameters.Add("@Address", SqlDbType.VarChar).Value = Address;
    sqlcmd.Parameters.Add("@Company", SqlDbType.VarChar).Value = Company
    sqlcmd.Parameters.Add("@Address2", SqlDbType.VarChar).Value = Address2;

    sqlcmd.Connection = sqlcon;
    sqlcmd.ExecuteNonQuery();

    DV_NameAdd.ChangeMode(DetailsViewMode.ReadOnly);
    sqlcon.Close();
 }
 sqlcon.Close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T20:57:31.893

您正在覆盖您原来的 SqlCommand ，这就是为什么一次只有一个工作。SqlCommand 一次只运行一个命令。正如您的代码所期望的那样，它不接受其他版本的 CommandText。如果要同时运行两个或多个命令，则必须创建一个以分号分隔的 CommandText，如下所示：

```
sqlcmd.CommandText = 
"INSERT INTO Table1(Name, Address) VALUES(@Name, @Address);" + 
"INSERT INTO Table2(Company, Address2) VALUES(@Company, @Address2)"; 
```

注意两个命令之间的分号 (;)。您的参数名称是唯一的，因此您应该可以在那里。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T20:57:40.767

您正在设置相同 SqlCommand 的命令文本

```
 sqlcmd.CommandText = "INSERT INTO Table1(Name, Address) VALUES(@Name, @Address)";
  sqlcmd.CommandText = "INSERT INTO Table2(Company, Address2) VALUES(@Company, @Address2)"; 
```

只有最后一个会被执行，因为它已经替换了第一个。可能你需要执行第一个，清除参数集合，设置新文本然后重新执行，或者创建一个单独的命令

```
 sqlcmd.CommandText = "INSERT INTO Table1(Name, Address) VALUES(@Name, @Address)";
  sqlcmd.Parameters.Add("@Name", SqlDbType.VarChar).Value = Name;
  sqlcmd.Parameters.Add("@Address", SqlDbType.VarChar).Value = Address;
  sqlCmd.ExecuteNonQuery();
  sqlCmd.Parameters.Clear();
  sqlcmd.CommandText = "INSERT INTO Table2(Company, Address2) VALUES(@Company, @Address2)";
  sqlcmd.Parameters.Add("@Company", SqlDbType.VarChar).Value = Company
  sqlcmd.Parameters.Add("@Address2", SqlDbType.VarChar).Value = Address2;
  sqlCmd.ExecuteNonQuery(); 
```

顺便说一句，第一个 SELECT 非常危险。您还应该为该命令使用参数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T21:01:27.220

有时，您可以在两条 SQL 语句之间使用分号来同时执行两条。看看是否改变这个：

```
sqlcmd.CommandText = "INSERT INTO Table1(Name, Address) VALUES(@Name, @Address)";
                    sqlcmd.CommandText = "INSERT INTO Table2(Company, Address2) VALUES(@Company, @Address2)"; 
```

对此：

```
sqlcmd.CommandText = "INSERT INTO Table1(Name, Address) VALUES(@Name, @Address);" +
"INSERT INTO Table2(Company, Address2) VALUES(@Company, @Address2)"; 
```

为你工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T21:53:23.123

要考虑的另一件事是将逻辑推入`insert`查询并消除竞争条件，如下所示：

```
public bool InsertEntry( string name , string addr1 , string company , string addr2 )
{
  const string QUERY = @"
begin transaction
declare @success bit

insert dbo.table_1
select @name , @addr1
where not exists ( select *
                   from dbo.main_table
                   where name = @name
                 )

insert dbo.table_2
select @company , @addr2
where @@rowcount = 1
  and not exists ( select *
                   from dbo.main_table
                   where name = @name
                 )
set @success = case when @@ROWCOUNT > 0 then 1 else 0 end

if ( @success = 1 )
begin
  commit transaction
end
else
begin
  rollback transaction
end

select @success
" ;
  bool success = false ;
  using ( SqlConnection connection = new SqlConnection( "Server=(local);Database=sandbox;Trusted_Connection=True;"))
  using ( SqlCommand command = connection.CreateCommand())
  {
    command.CommandType = CommandType.Text;
    command.CommandText = QUERY ;

    command.Parameters.Add( "@name"    , SqlDbType.VarChar ).Value = name    ;
    command.Parameters.Add( "@addr1"   , SqlDbType.VarChar ).Value = addr1   ;
    command.Parameters.Add( "@company" , SqlDbType.VarChar ).Value = company ;
    command.Parameters.Add( "@addr2"   , SqlDbType.VarChar ).Value = addr2   ;

    object returnedValue = command.ExecuteScalar() ;
    if ( returnedValue is bool )
    {
      success = (bool) returnedValue ;
    }
  }
  return success ;
} 
```

# python - 错误 django 'dict' 对象不可调用

> ID：16092900
> 
> 赞同：0
> 
> 时间：2013-04-18T20:55:35.057
> 
> 标签：python, django

由于这条线，我现在收到以下错误`setattr(CsvModel, field.value(), CharField())`

**错误：“dict”对象不可调用**

**视图.py**

```
if request.method == 'POST':
        form = ConfiguratorForm(data=request.POST)
        # Send import to task.
        # Clean all data and add to var data.
        if form.is_valid():
            data = form.cleaned_data
            process_upload.delay(upload_id=upload.id, form=data) 
```

**任务.py**

```
@task
def process_upload(upload_id, form):
    upload = Upload.objects.get(id=upload_id)
    upload.process(form=form) 
```

**过程**

```
import_this(data=self.filepath, extra_fields=[
                {'value': self.group_id, 'position': 5},
                {'value': self.uploaded_by.id, 'position': 6}], form=form) 
```

**模型.py**

```
def import_this(form, *args, **kw):
    # make custom ContactCSVModel
    class ContactCSVModel(CsvModel):

        for k, v in form:
            setattr(CsvModel, v, CharField())

        group = DjangoModelField(Group)
        contact_owner = DjangoModelField(User)

        class Meta:
            delimiter = ","
            dbModel = Contact
            update = {'keys': ["mobile", "group"]}

    return ContactCSVModel.import_data(*args, **kw) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:07:00.060

在第二个调用中，您传入的`form.cleaned_data`是一个*映射*(a `dict`)，因此您正在遍历键，它们是字符串。

另一方面，在第一次调用中，您传递的是`form`自身。因此，第二次调用不一样；以下调用将是：

```
form = ConfiguratorForm(data=request.POST)
if form.is_valid():
    process_upload(upload_id=upload.id, form=form) 
```

这里的问题是这是否是你真正*想要*做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:07:13.550

在第一种情况下，您的表单参数是一个表单实例。

在第二个中，您的表单参数是一个 dict 实例。

另外：

我认为您的`import_this`方法（如果它确实是您模型的方法）缺少*self*第一参数或应该声明为`@staticmethod`. 它可能会为您省去使用 import_this(self.xxx, self.yyy, ...) 调用它的麻烦，但我不太确定您如何从 upload.process() 调用 import_method() （我的 Django有点生锈）。

对于它的价值，我认为有更简单的方法可以实现您想要实现的目标（如果我猜得不错，那就是加载 CSV 文件）：

没有表单验证：看看[csv.DictReader](http://docs.python.org/2/library/csv.html#csv.DictReader) () 将为文件中的每一行返回一个字典。然后做：

```
with csv.DictReader(...) as r:
    for line in r:
        instance = MyModel(**line)
        instance.save() 
```

使用一个表单来验证从文件中读取的数据：做同样的事情但实例化一个[ModelForm](https://docs.djangoproject.com/en/1.5/topics/forms/modelforms/)，您需要定义它：

```
 with csv.DictReader(...) as r:
     for line in r:
         form = MyModelForm(**line)
         form.save() 
```

您正在做的事情看起来像是某种奇怪的、伤脑筋的元编程……您是否正在尝试根据您在 CSV 文件中找到的内容动态创建模型？

希望这可以帮助。

# jquery - 使用 background-size 平移背景图像：封面？

> ID：16092904
> 
> 赞同：4
> 
> 时间：2013-04-18T20:55:44.070
> 
> 标签：jquery, css, background

使用以下代码移动鼠标时，我目前正在平移我的网站的背景图像

```
$('body').mousemove(function(e){
    var mousePosX = 50 + (e.pageX/$(window).width())*25;
    var mousePosY = 50 + (e.pageY/$(window).height())*25;
    $('body').css('backgroundPosition', mousePosX + '% ' +  mousePosY + '%');
}); 
```

这适用于较大的背景图像（例如宽度为 2000 像素）。有没有办法做同样的事情，但

```
background-size: cover; 
```

? 乍一看，它显然不会也不应该起作用，因为背景图像始终与浏览器大小相同，因此无法平移。由于浏览器窗口永远不会是最大高度（由于书签工具栏等），它可以垂直移动。是否可以有一个“覆盖背景”，但也可以调整背景图像的一些像素大小，使其比视口略大，但也会自动调整大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:03:04.197

```
body{
    background:url(IMAGE);
    background-size: 110%;
    background-position: -10px -10px;
    background-repeat:no-repeat;
    background-attachment:fixed;
} 
```

# javascript - jsViews - 在对象列表中显示自定义属性

> ID：16092905
> 
> 赞同：0
> 
> 时间：2013-04-18T20:55:44.323
> 
> 标签：javascript, jsrender, jsviews

我有一些想要使用 jsViews 输出的数据。情况是数据数组中的对象可以根据某些条件具有不同的属性/列集。我将这些属性名称存储在设置中，并希望能够打印数据内容，并将所有附加列存储在设置数组中。例如：

```
data = {
    view_settings: [{
            property_name: "prop1"
        },
        {
            property_name: "prop2"
        }
    ],
    object_list: [{
            id: "180",
            name: "test1",
            prop1: "test-prop-1",
            prop2: "test-prop-2"
        }
    ]
} 
```

我想要实现的是使用 view_settings 中的属性列表显示 object_list 的内容。这甚至可以使用 jsViews 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:17:29.510

为你的问题找到答案的最好方法是先问它，理解它（橡皮鸭法），然后找到答案。

为了做到这一点，我们需要对对象进行两次别名。这是我简化的 jsViews 模板代码，它将正确显示来自我的问题的示例中的数据：

```
<script id="template1" type="text/x-jsrender">
    <table>
        <thead>
            <tr>
                <th>Name</th>
                {{for view_settings}}
                <th>{{>property_name}}</th>
                {{/for}}
                <th></th>
            </tr>
        </thead>
        <tbody>
            {{for object_list ~view_settings=#data.view_settings}}
            <tr>
                <th>{{>name}}</th>
                {{for ~view_settings ~object=#data}}
                <th>{{:~object[property_name]}}</th>
                {{/for}}
                <th></th>
            </tr>
            {{/for}}
        </tbody>
    </table>
</script> 
```

希望这可以节省别人的时间；）

# arrays - 如何在指针数组中找到无限循环？

> ID：16092913
> 
> 赞同：1
> 
> 时间：2013-04-18T20:56:14.410
> 
> 标签：arrays, algorithm, pointers, big-o, infinite-loop

我有一个指针数组（这是算法，所以不要进入语言细节）。大多数时候，这个数组指向数组之外的位置，但它会退化为数组中的每个指针都指向数组中的另一个指针。最终，这些指针形成了一个无限循环。

所以假设整个数组由指向数组中另一个位置的指针组成并且你从头开始，你怎么能找到在时间和空间上效率最高的循环长度？我相信最好的时间效率是 O(n)，因为你必须遍历数组，而最好的空间效率是 O(1)，尽管我不知道如何实现。

```
Index:  0  1  2  3  4  5  6
Value: *3 *2 *5 *4 *1 *1 *D 
```

D 是在循环开始之前被指向的数据。在此示例中，循环为 1、2、5，它无限重复，但索引 0、3 和 4 不是循环的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T22:15:44.487

这是循环检测问题的一个实例。Robert W. Floyd 在 1960 年发现了一个优雅的`O(n)`时空解决方案；`O(1)`它通常被称为[“龟兔赛跑”](http://en.wikipedia.org/wiki/Cycle_detection#Tortoise_and_hare)算法，因为它包括用两个指针遍历序列，一个指针的移动速度是另一个指针的两倍。

这个想法很简单：循环必须有一个长度为的循环`k`，对于一些`k`。在每次迭代中，兔子移动两步，乌龟移动一步，因此它们之间的距离比前一次迭代大一。因此，每次`k`迭代，它们都是`k`彼此相隔的多个步骤，并且一旦它们都在循环中（一旦乌龟到达就会发生），如果它们`k`相隔多个步骤，它们都指向同一个元素.

如果你只需要知道周期的长度，你就等着兔子和乌龟到达同一个地方；然后你沿着循环走，数着步数，直到你再次回到同一个地方。在最坏的情况下，总步数将是尾部长度加上循环长度的两倍，循环长度必须小于元素数量的两倍。

***注意：***对第二段进行了编辑，以可能使这个想法“更明显”，无论这意味着什么。正式的证明很容易，实现也很容易，所以我都没有提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:25:43.023

制作数组中元素的有向图，其中一个节点指向另一个节点，如果节点的元素指向其指向的节点的元素，并且对于每个节点。跟踪节点的入度（指向它的指针数。）在制作图表时，如果有一个入度 == 2 的节点，则该节点是无限循环的一部分。

如果第一个元素包含在无限循环中，则上述方法会失败，因此在算法开始之前，将第一个元素添加 1 indegree 以解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:07:29.877

正如您所描述的，该数组变成了一个图（更准确地说是福雷斯特），其中每个顶点的出度正好为 1。这种图的组件只能由链组成，每个链都可能以单个循环结束。也就是说，每个组件的形状要么像 O，要么像 6。（我假设没有指针为空，但这很容易处理。你最终会得到完全没有循环的 1 形组件。）

您可以通过“访问”跟踪所有这些组件，并使用“已访问”哈希或标志数组跟踪您去过的地方。

这是一个算法。

**编辑** 它只是为每个节点一个子节点的情况简化了一个 forrest 的 DFS，这消除了对堆栈（或递归）的需要，因为不需要回溯。

```
Let A[0..N-1] be the array of pointers.
Let V[0..N-1] be an array of boolean "visited" flags, initially false.
Let C[0..N-1] be an array if integer counts, initially zero.
Let S[0..N-1] be an array of "step counts" for each component trace.
longest = 0  // length of longest cycle
for i in 0..N-1, increment C[j] if A[i] points to A[j]
for each k such that C[k] = 0 
  // No "in edges", so must be the start of a 6-shaped component
  s = 0
  while V[k] is false
    V[k] = true
    S[k] = s
    s = s + 1
    k index of the array location that A[k] points to
  end
  // Loop found. Length is s - S[k]
  longest = max(longest, s - S[k])
end
// Rest of loops must be of the O variety
while there exists V[k] false
  Let k be such that V[k] is false.
  s = 0
  while V[k] is false
    V[k] = true
    s = s + 1
    k index of the array location that A[k] points to
  end
  // Found loop of length s
  longest = max(longest, s)
end 
```

空间和执行时间都与输入数组的大小成正比 `A`。`S`如果您愿意跟踪 6 形组件两次，则 可以摆脱阵列。

**另外**我完全同意，如果不需要找到最大大小的循环，那么[用于在链表中查找循环的古老“双指针”算法](https://stackoverflow.com/questions/7398703/linked-list-loop-detection-algorithm)是优越的，因为它只需要恒定空间。

# http - 重用 ASIO 连接，read_some 异常

> ID：16092916
> 
> 赞同：0
> 
> 时间：2013-04-18T20:56:29.160
> 
> 标签：http, boost, network-programming, boost-asio, http-1.0

我目前正在尝试弄清楚如何正确重用 asio 套接字。我能够成功发出请求，并得到结果。第二次发出请求时，我得到一个异常：read_some: End of file。第二次写入似乎工作正常，我看到第二个 http 请求通过wireshark 发出。我认为套接字上的剩余信息会以某种方式破坏我的连接。对此问题的任何帮助将不胜感激。这是我正在使用的代码：

```
persistent_connection::persistent_connection(std::string ip, std::string port):
io_service_(), socket_(io_service_), is_setup_(false)
{
    boost::asio::ip::tcp::resolver resolver(io_service_);
    boost::asio::ip::tcp::resolver::query query(ip,port);
    boost::asio::ip::tcp::resolver::iterator iterator = resolver.resolve(query);
    boost::asio::ip::tcp::endpoint endpoint = *iterator;
    socket_.async_connect(endpoint, boost::bind(&persistent_connection::handler_connect, this, boost::asio::placeholders::error, iterator));
    io_service_.run();
}

void persistent_connection::handler_connect(const boost::system::error_code &ec, boost::asio::ip::tcp::resolver::iterator endpoint_iterator)
{
    if(ec)
    {
        std::cout << "Couldn't connect" << ec << std::endl;
        return;
    }
    else
    {
        boost::asio::socket_base::keep_alive keep_option(true);
        socket_.set_option(keep_option);
    }
}

void persistent_connection::write(std::string message)
{
    std::string request_stream = "GET /" + message + " HTTP/1.0\r\n";
    request_stream += "HOST: 10.1.10.220";
    request_stream += "Accept: */*\r\n";
    request_stream += "Connection: keep-alive\r\n\r\n";

    try
    {
        boost::asio::write(socket_, boost::asio::buffer(request_stream, request_stream.size()));
    }catch(std::exception& e)
    {
        std::cout << "Write exception: " << e.what() << std::endl;
    }

    boost::array<char,8192> buf;
    try
    {
        socket_.read_some(boost::asio::buffer(buf));
    }catch(std::exception& e)
    {
        std::cout << "Read exception: " << e.what() << std::endl;
    }

    std::string response = buf.data();
    std::cout << response << std::endl;
} 
```

编辑：添加了主要功能。

```
int main()
{
    persistent_connection p("10.1.10.220", "80");
    std::string check;
    do
    {
        std::cin >> check;
        if(check.compare("s") == 0)
        {
            std::cout << "Sending" << std::endl;
            p.write("100");
        }
    }while(check.compare("x") != 0);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T18:39:14.547

您在尝试时遇到此异常的事实`read_some`意味着 HTTP 服务器在第一个请求结束后关闭连接，即服务器忽略“Connection: keep-alive”标头（请注意，HTTP 1.0 服务器不一定支持持久连接） .

但是，在 1.1 版本中[，默认情况下连接是持久的](https://www.rfc-editor.org/rfc/rfc2616#section-8.1)，因此请求“HTTP/1.1”应该可以解决这个问题。

# vb.net - Visual Basic 中的函数

> ID：16092917
> 
> 赞同：1
> 
> 时间：2013-04-18T20:56:32.017
> 
> 标签：vb.net, function, visual-studio-2012, calculator

我应该为足球比赛的编程作业制作分数计算器。它有 4 个文本框和一个按钮，该功能需要有完整的信用，我只是不确定我做错了什么。

```
Public Class Form1
Dim intTotal = 0
Dim intFirst = 0
Dim intSecond = 0
Dim intThird = 0
Dim intFourth = 0
Private Sub btnCalculate_Click(sender As Object, e As EventArgs) Handles btnCalculate.Click
    Try
        Dim intFirst As Integer = Convert.ToInt32(txtFirst.Text)
        Dim intSecond As Integer = Convert.ToInt32(txtSecond.Text)
        Dim intThird As Integer = Convert.ToInt32(txtThird.Text)
        Dim intFourth As Integer = Convert.ToInt32(txtFourth.Text)
    Catch ex As Exception
        MessageBox.Show("Enter in Digits!")
    End Try
    intTotal = calcTotal(intFirst, intSecond, intThird, intFourth, intTotal)
    Me.lblTotal.Text = intTotal 'Shows as 0 at run-time
End Sub
Function calcTotal(ByVal intFirst As Integer, ByVal intSecond As Integer, ByVal intThird As Integer, ByVal intFourth As Integer, ByVal intTotal As Integer) As Integer
    intTotal = intFirst + intSecond + intThird + intFourth
    Return intTotal
End Function
End Class 
```

`lblTotal`最终显示为 0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:05:40.460

您的变量在 try catch 内的块级声明。将声明移出块并删除类级声明（因为它们不是必需的）。

像这样：

```
Public Class Form1
    Private Sub btnCalculate_Click(sender As Object, e As EventArgs) Handles btnCalculate.Click

        Dim intFirst As Integer = 0
        Dim intSecond As Integer = 0
        Dim intThird As Integer = 0
        Dim intFourth As Integer = 0

        Try
           intFirst = Convert.ToInt32(txtFirst.Text)
            intSecond = Convert.ToInt32(txtSecond.Text)
            intThird = Convert.ToInt32(txtThird.Text)
            intFourth = Convert.ToInt32(txtFourth.Text)
        Catch ex As Exception
            MessageBox.Show("Enter in Digits!")
        End Try
        Dim intTotal as Integer = calcTotal(intFirst, intSecond, intThird, intFourth, intTotal)
        Me.lblTotal.Text = intTotal 'Shows as 0 at run-time
    End Sub

    Function calcTotal(ByVal intFirst As Integer, ByVal intSecond As Integer, ByVal intThird As Integer, ByVal intFourth As Integer, ByVal intTotal As Integer) As Integer
        Return intFirst + intSecond + intThird + intFourth
    End Function
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:01:23.400

我不确定你的问题是什么，但你的变量声明在你的函数之外。你应该在里面初始化它们。

# intellij-idea - IDEA：如何查看空项目中的子目录？

> ID：16092922
> 
> 赞同：13
> 
> 时间：2013-04-18T20:56:53.350
> 
> 标签：intellij-idea

我希望使用 IDEA 来编辑一个没有特定类型文件的目录。因此，我创建了一个**Empty Project**类型的新项目并将其指向我的目录。

项目视图现在显示目录本身中的文件。但是，它不显示任何子目录。这很奇怪。

更奇怪的是，我仍然可以使用**New -> Directory**创建一个新目录。从命令行我可以看到目录已经创建；但是，从 IDEA 内部，它仍然没有出现。

这里发生了什么？而且，更重要的是，我怎样才能真正让它显示我的子目录？

这是 IntelliJ IDEA 12.1.1。我确实发现[IntelliJ 不显示项目文件夹](https://stackoverflow.com/questions/5816419/intellij-does-not-show-project-folders)，这听起来很相似。但是，它指的是不同版本的 IDEA，他们没有使用空项目。所以，我认为这无关紧要。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-01-19T18:56:23.457

在 IntelliJ 中，您必须至少创建一个模块。正如[CrazyCoder在评论中所说，添加一个模块会设置在“](https://stackoverflow.com/users/104891/crazycoder)**项目”**窗格中显示的内容的根文件夹。

以下是我显示空文件夹的步骤。

在终端窗口中

```
mkdir one
mkdir one/two
mkdir one/two/three
mkdir one/two/three/four 
```

在 Intellij 15.0.2 中，我创建了一个新项目，选择**Empty Project**并将**Project Location**设置为`one`文件夹。

创建项目后，IntelliJ 会通过一个**项目结构**对话框提示我，其中在导航树中选择了**模块。**我单击了中间窗格中的“+”按钮来添加一个模块。我选择**Static Web**作为模块类型以防止创建额外的`src`文件夹。我将模块的**内容根目录**和**模块文件位置**设置为同一`one`文件夹。

[![添加模块](https://i.stack.imgur.com/SO0gP.png)](https://i.stack.imgur.com/SO0gP.png)

我点击**Finish**然后**Ok**。这给了我这个结构

[![项目结构](https://i.stack.imgur.com/Nuq8d.png)](https://i.stack.imgur.com/Nuq8d.png)

# excel - 如何在 Excel 中列出所有可能的数字组合

> ID：16092924
> 
> 赞同：0
> 
> 时间：2013-04-18T20:57:06.667
> 
> 标签：excel, vba

在单元格“A1”= 123 和“A2”= 456 中。

我可以知道如何显示所有可能的组合，使其看起来像这样：

```
123
132
213
231
312
321
456
465
546
564
645
654 
```

我试图在网上搜索，但找不到任何解决方案。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:01:46.927

您可以使用下面的函数来生成字符串中数字的所有排列。

```
Sub GetPermutation(x As String, y As String, ByRef CurrentRow As Double)
    Dim i As Integer, j As Integer
    j = Len(y)
    If j < 2 Then
        Cells(CurrentRow, 1) = x & y
        CurrentRow = CurrentRow + 1
    Else
        For i = 1 To j
            Call GetPermutation(x + Mid(y, i, 1), _
            Left(y, i - 1) + Right(y, j - i), CurrentRow)
        Next
    End If
End Sub 
```

对于您的示例，您可以执行以下操作：

```
CurrentRow = 2
Call GetPermutation("",Range("A1").value,CurrentRow) 
```

# angularjs - 设置默认值具有异步数据的值我有一个下拉列表 <select ng-model="referral.organization" ng-options="key as value for (key, value) in organizations"> </select> 使用$http 请求。我还有一个资源引用，其中包括几个属性，包括一个与下拉列表中保存的值相对应的整数组织。目前，下拉菜单工作正常，选择一个新值将毫无问题地更新我的推荐资源。但是，当页面加载时，下拉菜单是

> ID：16092930
> 
> 赞同：4
> 
> 时间：2013-04-18T20:57:18.463
> 
> 标签：angularjs

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:22:44.657

对于简单的类型，您只需设置`$scope.referral.organization`它就会神奇地工作：

[http://jsfiddle.net/qBJK9/](http://jsfiddle.net/qBJK9/)

```
<div ng-app ng-controller="MyCtrl">
    <select ng-model="referral.organization" ng-options="c for c in organizations">
    </select>
</div> 
```

-

```
function MyCtrl($scope) {
    $scope.organizations = ['a', 'b', 'c', 'd', 'e'];
    $scope.referral = {
        organization: 'c'
    };
} 
```

如果你使用对象，它会变得更棘手，因为 Angular 似乎不够聪明，无法知道新对象实际上是相同的。除非有一些Angular hack，否则我看到的唯一方法是`$scope.referral.organization`在从服务器加载后进行更新并将其分配给`$scope.organizations`如下值：

[http://jsfiddle.net/qBJK9/2/](http://jsfiddle.net/qBJK9/2/)

```
<div ng-app ng-controller="MyCtrl">
    <select ng-model="referral.organization" ng-options="c.name for c in organizations"></select>
    {{referral}}
    <button ng-click="loadReferral()">load referral</button>
</div> 
```

-

```
function MyCtrl($scope) {
    $scope.organizations = [{name:'a'}, {name:'b'}, {name:'c'}, {name:'d'}, {name:'e'}];
    $scope.referral = {
        organization: $scope.organizations[2]
    };
    $scope.loadReferral = function () {
        $scope.referral = {
            other: 'parts',
            of: 'referral',
            organization: {name:'b'}
        };

        // look up the correct value
        angular.forEach($scope.organizations, function(value, key) {
            if ($scope.organizations[key].name === value.name) {
                $scope.referral.organization = $scope.organizations[key];
                return false;
            }
        });

    };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T08:55:07.793

您可以分配`referral.organization`给从 ajax 获得的对象之一：

```
$scope.referral.organization = $scope.organizations[0] 
```

[我在plunker](http://plnkr.co/edit/ssFPj9?p=preview)创建了简单的演示。按钮单击处理程序更改对象列表并选择默认对象。

```
$scope.changeModel = function() {
  $scope.listOfObjects = [{id: 4, name: "miss1"},
                          {id: 5, name: "miss2"},
                          {id: 6, name: "miss3"}];
  $scope.selectedItem = $scope.listOfObjects[1];
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-09T02:44:26.020

其他答案是正确的，因为它通常“有效”。问题最终是`organization`存储在内部的键（整数）`$scope.organizations`与存储在`$http`响应中的键不匹配，响应存储在 JSON 中，因此作为字符串存储。Angular 没有将字符串与整数匹配。正如我在对原始问题的编辑中提到的，当时的解决方案是将`$http`响应数据转换为字符串。我不确定当前版本的 Angular.js 是否仍然如此。

# javascript - Chrome extension, Store data

> ID：16092932
> 
> 赞同：2
> 
> 时间：2013-04-18T20:57:24.203
> 
> 标签：javascript, google-chrome, google-chrome-extension

I've read this question: [Chrome Extensions & Javasctipy Database](https://stackoverflow.com/questions/4089422/chrome-extensions-javasctipy-database) but I want an answer with more details and more clear.

How can I store some of my extension settings?

Is it possible to use a database to do such things with JavaScript?

Is there any good tutorial on it?

I don't want to use Local Storage, because I **do not** want the behavior of SESSIONS

Thanks.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-10-08T07:30:39.540

您可以使用`chrome.storage.sync`或`chrome.storage.local`（[文档](https://developer.chrome.com/extensions/storage)）。两者都是本地存储（不是会话存储）；`sync`如果用户已将 Chrome 连接到它，它还有一个额外的优势，即它会同步到用户的 Google 帐户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T21:06:44.803

以下页面列出了 HTML5 中的存储机制。WebSQL 为您的 javascript 提供了一个非常好的数据库。

[http://www.html5rocks.com/en/features/storage](http://www.html5rocks.com/en/features/storage)

更新：自从我发布这个已经有一段时间了。WebSQL 已被删除。浏览器可能仍会继续支持它，但所有的实现都是 SQLite。IndexedDB 是现在要走的路。我已经使用了它，它有点难以进入，但对于客户端数据库来说效果很好。

再次更新：Chrome 改变了一切。请参阅[TJ 克劳德的回答](https://stackoverflow.com/a/26251407/253298)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T21:22:01.197

如果您只想保存一些设置，我相信这对您来说是一个简单的解决方案。它也有一些例子，希望它有帮助。

[https://developer.chrome.com/extensions/storage.html](https://developer.chrome.com/extensions/storage.html)

# eclipse - 在 Scala 中调试单行

> ID：16092947
> 
> 赞同：2
> 
> 时间：2013-04-18T20:58:06.427
> 
> 标签：eclipse, debugging, scala, scala-ide

在 Scala 中，单个代码可以实现很多。

```
def -(that: Nat) = if (that.isZero) this else throw new Error("negative number") 
```

但是，很难调试。有小费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T21:00:38.733

使用[scala 工作表](https://github.com/scala-ide/scala-worksheet/wiki/Getting-Started)。就是这样：您将在您的环境中获得多行 REPL，您可以在其中使用您的代码。

![在此处输入图像描述](https://i.stack.imgur.com/mwVhG.png) 或者，只需使用与 sbt ( ) 捆绑的 REPL`sbt console`并正确导入

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-19T00:16:41.153

您可以看到编译器阶段的输出，即脱糖后的 AST

> scalac -Xprint:typer
> 
> scalac -Xprint-types（注意连字符，不是冒号）

手册页有点混乱，没有列出“打字机”阶段，但它有效：

[http://www.scala-lang.org/docu/files/tools/scalac.html](http://www.scala-lang.org/docu/files/tools/scalac.html)

[编译时类型跟踪](https://stackoverflow.com/questions/4992456/compile-time-type-tracing)

# sql - LIKE 100k 记录上的 2 列或 200k 记录上的一列是否更快？

> ID：16092949
> 
> 赞同：0
> 
> 时间：2013-04-18T20:58:07.393
> 
> 标签：sql, performance, postgresql, database-design, indexing

假设我有一个带有`column_a`and的表`column_b`，其中包含 100k 条记录。我需要匹配`column_a`OR `column_b`。

创建一个只包含要匹配的一列但记录两倍的新表会更快吗？
而不是这个：

```
table_a

id  column_a  column_b
--  --------  --------
1   foo       bar

SELECT ... WHERE "column_a" LIKE '%blah%' OR "column_b" LIKE '%blah%'
# will iterate through 100k records 
```

我要这个：

```
table_b

id  column
--  ------
1   foo
2   bar

SELECT ... WHERE "column" LIKE '%blah%'
# will iterate through 200k records 
```

什么更便宜，文本匹配还是迭代？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T22:28:22.847

它还取决于列类型、列大小、数据分布、表中的其他列等等。我猜你只是懒得告诉我们所有那些乏味的细节。

通常，最快的方法是**`table_b`**使用三元组[GIN 索引](http://www.postgresql.org/docs/current/interactive/pgtrgm.html)来支持非锚定`LIKE`表达式。指数有所作为。查询风格将是另一个重要因素。利用`LIMIT 1`或。`EXISTS`_`table_b`

这个密切相关的答案中的更多细节：
[PostgreSQL LIKE query performance changes](https://stackoverflow.com/questions/1566717/postgresql-like-query-performance-variations/13452528#13452528)

我只是懒得写更详细的答案。*运行测试。*:)

# asp.net - 服务器标签在 WhereCondition= 中的格式不正确错误

> ID：16092950
> 
> 赞同：0
> 
> 时间：2013-04-18T20:58:07.677
> 
> 标签：asp.net, kentico

我知道错误是由`<%# Eval("NodeID")%>`语句引起的。当我输入一个文字整数时，它工作正常。我尝试将 WhereCondition 的外部双引号更改为单引号，将内部引号更改为双引号，但这会引发异常。

```
<cms:CMSRepeater ID="subcatPreviewImages" Path= '<%# Eval("NodeAliasPath") + "/%" %>' runat="server" ClassNames="CMS.MenuItem" TransformationName="EcommerceSite.Transformations.EMCategorySmallImagePreview" OrderBy="NodeLevel, NodeOrder, NodeName" MaxRelativeLevel="4" WhereCondition="DocumentMenuItemHideInNavigation='false' AND NodeParentID= <%# Eval("NodeID")%> AND NodeLevel=3" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:13:11.620

您需要像使用属性一样在 databind 标记*内构建字符串：*`NodeAliasPath`

```
WhereCondition='<%# "DocumentMenuItemHideInNavigation='false' AND NodeParentID=" + Eval("NodeID") + " AND NodeLevel=3" %>' 
```

`'`如果您在使用混合字符和字符时遇到问题`"`，您可能希望将构建表达式的逻辑移动到页面中的函数中：

```
public string GetWhereCondition(SomeType dataItem) {
    return "..." + dataItem.NodeID + "...";
} 
```

您的标签更改为：

```
WhereCondition="<%# GetWhereCondition(Container.DataItem) %>" 
```

免责声明：函数和类型名称仅作为示例组成——请使用适当命名的函数并替换我命名不佳的函数。

# c# - 从 WebAPI IQueryable 中排除列

> ID：16092951
> 
> 赞同：3
> 
> 时间：2013-04-18T20:58:15.060
> 
> 标签：c#, entity-framework, asp.net-web-api

是否可以从我的 WebAPI 的 IQueryable 函数中排除一列？例如，我如何从我的人员实体中排除属性“FirstName”：

```
[HttpGet]
public IQueryable<Contact> GetPeople()
{
    return _contextProvider.Context.People;
} 
```

伪代码：

```
[HttpGet]
public IQueryable<Contact> GetPeople()
{
    return _contextProvider.Context.People.ExcludeColumn("FirstName");
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T21:09:40.743

将结果手动投射到`Contact`实体，并且不为`FirstName`列提供数据：

```
[HttpGet]
public IEnumerable<Contact> GetPeople()
{
    return from p in _contextProvider.Context.People
           select new Contact {
               Id = p.Id,
               LastName = p.LastName
           };
} 
```

顺便说一句，我会创建一些其他没有`FirstName`属性的特定 DTO 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-02T20:34:25.563

`Runtime.Serialization.IgnoreDataMember`另一种方法是用这样的方式装饰柱子。

```
[Runtime.Serialization.IgnoreDataMember]
public string FirstName { get; set; } 
```

# jquery - elements not dragging in jsPlumb

> ID：16092953
> 
> 赞同：1
> 
> 时间：2013-04-18T20:58:18.447
> 
> 标签：jquery, jquery-ui, jsplumb

Something is not working correctly with my drag and drop using jsPlumb. I made the left side divs draggable, but when you try to drag them, only the lines move, not the divs too. Here is my code:

```
<html>
<head>
<title>Plumb Test</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/jquery.jsPlumb-1.3.16-all-min.js "></script>
<script type="text/javascript">
$(document).ready(function(){
    jsPlumb.draggable($(".left"));
    jsPlumb.connect({source:"div1", target:"div2",
        paintStyle:{lineWidth:15,strokeStyle:'rgb(243,230,18)'},
        endpointStyle:{fillStyle:'rgb(243,229,0)'}
    });
    jsPlumb.connect({
        source:'div3',
        target:'div4',
        paintStyle:{ lineWidth:10, strokeStyle:'rgba(0, 0, 200, 0.5)' },
        anchors:["RightMiddle", "LeftMiddle"],
        endpoint:[ "Rectangle", { width:10, height:8 } ]
    });     
    jsPlumb.connect({
        source:'div2',
        target:'div3',
        paintStyle:{lineWidth:8, strokeStyle:'rgb(189,11,11)'},
        anchors:["BottomCenter", "TopCenter"],
        endpoint:"Rectangle"
    });     
    $("#div1").css("background-color","blue");
});
</script>
<style>
#div1, #div4{background-color:red;width:150px;height:150px;}
#div2, #div3{background-color:green;width:150px;height:150px;}
.left{float:left;}
.right{float:right;}
</style>
</head>

<body>
    <div id="div1" class="left">This is a test</div>
    <div id="div2" class="right">This is a div</div>
    <div id="div3" class="left">This is a test</div>
    <div id="div4" class="right">This is a div</div>
</body>
<html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T07:26:08.793

要启用拖动，您的 Div 必须绝对定位。

```
 <style>
 #div1, #div4{background-color:red;width:150px;height:150px;position:absolute; }
 #div2, #div3{background-color:green;width:150px;height:150px; position:absolute;}
 </style> 
```

更多信息检查 jsplumbs 文档。

[你的工作小提琴](http://jsfiddle.net/eR4qc/4/)

# javascript - 尝试验证 jQuery UI Datepicker

> ID：16092957
> 
> 赞同：0
> 
> 时间：2013-04-18T20:58:30.943
> 
> 标签：javascript, jquery, validation, user-interface, datepicker

我正在尝试检查日期是否早于今天的日期，如果为真则显示错误。当前发生的情况是，如果月份小于今天的月份，即使年份设置为 2014 年或以后，也会显示错误。例如，今天是 4/18/2013 没有错误，但是 4/17/2014 和 3/17/2014 出现错误，但 5/17/2013 没有。在检查过程中似乎忽略了年份。希望这有点道理...

```
 $("#expDate").datepicker({
        changeMonth: true,
        changeYear: true,
        minDate: 0,
        onClose: function(selectedDate) {
            var currDate = $.datepicker.formatDate('mm/dd/yy', new Date());
            if (selectedDate < currDate) {              
                $("#warning").append("The number has expired"); 
            } else {
                $("#warning").html(""); 
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:01:18.787

您可以使用 maxDate 选项直接执行此操作

```
$("#datepicker").datepicker({ maxDate: new Date() }); 
```

# python - 网络爬虫的属性错误

> ID：16092958
> 
> 赞同：0
> 
> 时间：2013-04-18T20:58:31.353
> 
> 标签：python, regex, python-3.x, web-crawler, urllib

运行以下代码时：

```
import urllib
import re
from urllib import request
import webbrowser

#email pattern
r'[\w._(),:;<>]+@[\w._(),:;<>][.]\w+'

# url pattern
r'\w\w\w[.]\w+[.]\w+'

html = urllib.request.urlopen('somelinkthatistoolongforstackoverflow')

#find all websites

websites = re.findall(r'http://www[.]\w+[.]\w+',str(html.read()))
print(websites)

#find all emails

emails = re.findall(r'[\w._(),:;<>]+@[\w._(),:;<>][.]\w+',str(html.read()))
print(emails)

#sort through websites and find other links

for i in websites:
    y = urllib.request.urlopen(i)
    x = re.findall(r'http://www[.]\w+[.]\w+',str(y.read()))
    websites.append(x) 
```

我收到此错误：

```
AttributeError: 'list' object has no attribute 'timeout' 
```

注意 AttributeError。我能做些什么呢？我正在使用 urllib 模块和 regex（正则表达式）模块。这是在 python 3.3.0 中。谁能帮我这个？如果你能帮助我，请在下面发帖。这是一个网络爬虫，可以找到尽可能多的链接和电子邮件地址。感谢所有可以提供帮助的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:01:52.333

你想*扩展* `websites`：

```
websites.extend(x) 
```

因为`x`它本身就是一个列表。

您当前*附加*了匹配网站的列表，因此在某些时候您会将该列表`i`从`for`lop传递到该列表`urllib.request.urlopen()`，然后尝试将其视为一个`Request`对象，因为它肯定不是字符串，另一个有效选项。

# java - Java 的本地方法在哪里定义？

> ID：16092959
> 
> 赞同：3
> 
> 时间：2013-04-18T20:58:32.153
> 
> 标签：java, linux, networking, java-native-interface, native-code

我在 CentOS 服务器上安装了 JRE (1.6_34) 的 64 位 linux 发行版。我拉下源代码并深入研究`java.net.SocketInputStream`类。

该类有一个名为的方法`socketRead0`：

```
/** 
 * Reads into an array of bytes at the specified offset using
 * the received socket primitive. 
 * @param fd the FileDescriptor
 * @param b the buffer into which the data is read
 * @param off the start offset of the data
 * @param len the maximum number of bytes read
 * @param timeout the read timeout in ms
 * @return the actual number of bytes read, -1 is
 *          returned when the end of the stream is reached. 
 * @exception IOException If an I/O error has occurred.
*/
private native int socketRead0(FileDescriptor fd, 
        byte b[], int off, int len, int timeout)
        throws IOException; 
```

我在哪里可以找到执行此`SocketInputStream#socketRead0`方法时执行的本机源代码？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:11:08.183

正如其他答案中所解释的，`native`方法实际上是 C 函数，通过[JNI](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/)调用。包含 C 函数的库文件通常加载`System.loadLibrary`和导出遵循 JNI 命名方案（前缀为`Java_`，后跟包、类和方法名，下划线而不是点）会自动链接到这些`native`Java 方法。

但是，其他答案没有提到将 C 函数链接到`native`Java 方法的第二种方法：[RegisterNatives](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/spec/functions.html#wp17734)。该接口可用于提供 C 实现，而无需调用`System.loadLibrary`、使用 JNI 命名方案甚至导出这些函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T05:51:11.987

在 OpenJDK 中，它就在[这里](http://hg.openjdk.java.net/jdk6/jdk6-gate/jdk/file/0d99d61882b7/src/windows/native/java/net/SocketInputStream.c) 出于某种原因，我找不到 Linux 实现。通常搜索本机文件夹。您的文件将在其中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:43:13.123

方法`native`表明此方法不是 Java 代码，而是*本机*代码（也称为机器代码），通常用 C/C++ 编写。对此类函数的调用是通过[JNI](http://en.wikipedia.org/wiki/Java_Native_Interface)进行的。

您应该搜索它加载它使用的本机库的位置，看起来像

```
System.loadLibrary("nameOfLibrary"); 
```

这个本机库应该为 Java 导出函数，例如

```
JNIEXPORT returnType JNICALL Java_ClassName_methodName 
```

# android - 按 ChildView 的行为就像单击 ParentView

> ID：16092960
> 
> 赞同：1
> 
> 时间：2013-04-18T20:58:38.587
> 
> 标签：android, view, parent

我在 Android 上发现了一个奇怪的行为。假设我有一个列表视图，每一行都是一个包含 textView 的线性布局。我在listView 上设置了一个longClickListener。另外，我在 textView 上设置了一个 onTouchEvent。我想要的行为是，如果用户按下列表中的 textView，则应该运行 onTouchEvent。如果用户在 textView 外长按，它应该执行 longClickListener 中定义的操作。但是，在 Android 4.2.1 中，这种行为似乎不起作用。我发现 Google 更改了代码，以便 ChildView 在 Jelly Bean 中从其父视图共享按下状态。这是正确的吗？如果是这种情况，我该如何实现我想要的方式？

换句话说，我希望 childView 和 parentView 独立运行！

任何答案将不胜感激！

下面是我的 CustomTextView.java

```
public class CustomTextView extends TextView {

    public CustomTextView(Context context) {
        super(context);
        setPressed(false);
    }

    public CustomTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
        setPressed(false);
    }

    public CustomTextView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        setPressed(false);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        Intent.... something
        Start a new activity... pretty straightforward

        return super.onTouchEvent(event);
    }
} 
```

下面是我的 list_item.xml 的文本视图

```
<com.keek.widget.CustomTextView
    android:id="@+id/caption"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/thumbnail_overlay"
    android:lineSpacingExtra="1dp"
    android:textColor="@android:color/black"
    android:textSize="@dimen/text_11"
    android:duplicateParentState="false"
    android:longClickable="false"
    android:textColorLink="@color/linkify_blue" /> 
```

我的清单非常简单。它是一个带有 onLongClickListener 的普通 listView，它会打开一个对话框。

这是当我按下 textView 时，对话框和新活动同时打开。我想要的是，当我按下 textView 时，它应该只打开一个新活动而不是一个对话框。

# xml - Scala: Dealing with optional XML elements and Case Classes

> ID：16092962
> 
> 赞同：1
> 
> 时间：2013-04-18T20:58:53.940
> 
> 标签：xml, scala, coding-style, xml-parsing, implicit-conversion

I'm looking for a better way of building objects from XML in Scala, similar to what's [happening in this SO question](https://stackoverflow.com/questions/7739811/processing-optional-xml-attributes-in-scala). I'd like to read xml which may contain missing elements. Currently, I'm using a case class:

```
case class Content(name:String, description:String, someDouble: Double) 
```

When reading xml, I'm passing in a Node to the following function:

```
def buildContent(node: Node) = {
    Content((node \ "name").text, 
            (node \ "description").text,
            (node \ "someDouble")
} 
```

My problem is that "someDouble" may or may not be present in the current XML snippet, which would be fine if this was a string but I need to treat it as a double. Currently I'm handling this with an implicit conversion

```
implicit def NodeSeqToDouble(value: NodeSeq) = {
   value.text match {
     case "" => 0.0
     case s:String => s.toDouble
   }
} 
```

Which works, but seems verbose and somewhat ugly. I'm wondering if there is a "best practices" way of dealing with optional elements when a type conversion is involved on an optional xml element.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T07:53:33.043

您的代码的一个问题是，在转换后无法判断该`double`值是丢失还是存在但设置为`0.0`.

首先想到的是 scalas `Option`。您的案例类如下所示：

```
case class Content(name:String, description:String, someDouble: Option[Double]) 
```

转换将是：

```
implicit def NodeSeqToDouble(value: NodeSeq) = {
  value.text match {
    case "" => None
    case s:String => Some(s.toDouble)
  }
} 
```

这意味着在转换之后`double`仍然保留存在或缺失的信息。

# bash - Unexpected `then' bash script

> ID：16092963
> 
> 赞同：1
> 
> 时间：2013-04-18T20:59:03.610
> 
> 标签：bash, if-statement

How do I fix this error? I can't see anything wrong with my syntax.

```
ipcheck() {
  echolog "[INFO] Enabling IP Forwarding..."
  sudo echo 1 > /proc/sys/net/ipv4/ip_forward
  if[$(cat /proc/sys/net/ipv4/ip_forward) == "0"]
    then
    echolog "[CRITICAL] Could not enable IP Forwarding!"
    exit 0
  fi
  echolog "[INFO] IP Forwarding successfully enabled!"
} 
```

I know this is a very basic script, but it's part of a bigger one. The error happens on the then statement.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T21:01:41.900

如果您来自其他编程语言（阅读：C），Shell 脚本往往比您可能习惯的对空格更加敏感。你的`if`线路有问题。您可能正在寻找：

```
if [ $(cat /proc/sys/net/ipv4/ip_forward) == "0" ] 
```

这里要记住的是，`[`它不是任何特殊`if`语法的一部分——它*是程序的名称*（有时是内置的 shell）。如果你这样想，你可以看到命令行解析器是如何需要它被分离的。类似地，`[`命令（或内置命令）期望关闭`]`与其他参数分开，因此您也需要在它之前有一个空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T21:01:45.337

问题是您需要在`if`和之间留一个空格`[`。缺少空格会使 bash 的解析器感到困惑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T21:01:49.353

`if`在第 4 行的and部分之间放置一个空格。`[$(cat...]`要运行此脚本，您还需要`]`在同一行的 the 部分留一个空格。

在相关的说明中，如果您没有在 shell 脚本中使用缩进，您应该认真考虑它，因为它使您的代码的维护和易读性更加容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T21:07:37.703

*不*依赖 bash的稍微重构（改进）的版本：

```
#!/bin/sh

ipcheck() {
    echolog "[INFO] Enabling IP Forwarding..."
    sudo echo 1 > /proc/sys/net/ipv4/ip_forward || {
        echolog "[CRITICAL] Error echoing to ip_forward file"
        exit 1
    }

    # Paranoia check :)
    status=$(cat /proc/sys/net/ipv4/ip_forward)
    [ "$status" = "1" ] || {
        echolog "[CRITICAL] Could not enable IP Forwarding!"
        exit 1  # 1 is error in scripts, 0 is success
    }
    echolog "[INFO] IP Forwarding successfully enabled!"
} 
```

最好做一个`error()`函数，也许是这样的：

```
# Call it like: error "[INFO] Could not ..."
error() {
    echolog "$*"
    exit 1
} 
```

哦，是的，正如其他人指出的那样，不要忘记空格:)

# ios - iOS App ECSlidingViewController：向其添加新的视图控制器和瞬态

> ID：16092964
> 
> 赞同：0
> 
> 时间：2013-04-18T20:59:04.530
> 
> 标签：ios, ecslidingviewcontroller

我在我的应用程序中使用 ECSlidingViewController。示例代码附带了四个 ViewController。这四个 ViewController 对应于“MenuViewContoller”中的四个选项。

现在我想在“FirstTopViewController”中添加一个 TableViewController。此 TableViewController 的每个单元格都指向一个 ViewController，它不是四个预定义的 ViewController 之一。

我看到 ECSlidingViewController 提供了一个“SampleTableViewController”。但我不知道如何“过渡”到这个 ViewController。

我之前确实使用过 UINavigationController。我知道如何将视图控制器推送到 NavigationController。我不知道如何配合 UINavigationController 和 ECSlidingViewController。

非常感谢。

这是一个演示： [http ://www.penghou.net/file/question.png](http://www.penghou.net/file/question.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-16T18:54:00.980

ECSlidingViewController 是一个容器，就像 UINavigationController 一样。你给它视图控制器，它会在它们之间显示和转换。

`ECSlidingViewController`提供设置视图控制器并通过调用锚点/重置在它们之间转换的方法。检查头文件以获取有关这些方法的文档。

# c++ - 如何让 Visual C++ 向量化这个循环（错误代码 1200）？

> ID：16092966
> 
> 赞同：4
> 
> 时间：2013-04-18T20:59:16.353
> 
> 标签：c++, vectorization, simd

我正在尝试让 VC++ 2012 自动矢量化一个看起来有点像这样的循环（实际上正在进行有趣的计算，但为了尽可能地提出问题，它们被省略了）。

```
parameters:
int period;
unsigned char* out_array;
unsigned char* in_array1;
unsigned char* in_array2;
unsigned char* in_array3;

for (int x = 0; x < width; ++x)
{
   int index = period * (x / 2);

   out_array[0] = in_array1[x];
   out_array[1] = in_array2[index];
   out_array[2] = in_array3[index];
   out_array += 4;
} 
```

我认为唯一阻碍矢量化的是`out_array += 4`，所以我做了一个内部“展开”循环，希望至少可以矢量化一个：

```
for (int x = 0; x < width; ++x)
{
   for (int xx = 0; xx < 4; ++xx)
   {
       int index = period * ((xx + x) / 2);

       unsigned char* pout_array = out_array + (4 * xx);
       pout_array[0] = in_array1[xx + x];
       pout_array[1] = in_array2[index];
       pout_array[2] = in_array3[index];
   }
   out_array += 16;
} 
```

但是当我使用 运行编译器时`/Qvect-report:2`，它告诉我由于错误代码 1200 无法对内部循环进行矢量化。错误代码 1200 指出：

> 循环包含阻止矢量化的循环携带的数据依赖性。循环的不同迭代相互干扰，因此对循环进行矢量化会产生错误的答案，并且自动矢量化器无法向自己证明不存在这种数据依赖性。

我不明白这一点。显然，这个循环的每次迭代都是独立的。如何让 Visual Studio 对其进行矢量化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T04:02:58.643

它不能向量化的主要原因是，正如所写的那样，编译器不能消除 out_array[n] 不是 in_arrayX[m] 的可能性，所以它必须坚持你的顺序排序。

您可以使用“__restrict”或“restrict”关键字为编译器解决此问题，这是对编译器的承诺，您只会以确保 out_array 与其他三个指针中的任何一个都不相同的方式调用它。您可能还想慷慨地使用“const”修饰符来帮助编译器：

```
void func(const int period,
    unsigned char* __restrict out_array,
    const unsigned char* in_array1,
    const unsigned char* in_array2,
    const unsigned char* in_array3)
{
   ...
   //mark 'width' as 'const' if possible:
   const int width = ...;
   for (int x = 0; x < width; ++x)
   {
       const int index = period * (x / 2);

       out_array[(x* 4) + 0] = in_array1[x];
       out_array[(x* 4) + 1] = in_array2[index];
       out_array[(x* 4) + 2] = in_array3[index];
   }
} 
```

# sql-server - t-sql help. need to return that current week of data for date parameter

> ID：16092969
> 
> 赞同：0
> 
> 时间：2013-04-18T20:59:20.853
> 
> 标签：sql-server, tsql

I have a stored procedure that needs to return a weekly schedule of items being made on different days. It takes in a start date.

```
@StartDate DATETIME 
```

Based on the startdate passed in, I need to return all the rows of data for that week, with the week starting on Tuesday and ending the following Monday.

Only taking in a startdate, how do I set the start of the week to Tuesday and then have my query return data from that particular week's range?

I know NOTHING of date functions in SQL.

I did see you can set DATEFIRST as 2 (which I think is Tuesday), but I don't know how to take in the date and find that week. I assume I need two variables to set the beginning of the week date and the end of the week date and return data in that range?

Here's my query that currently only returns the current date passed in:

```
SELECT 
    PS.ProductionDate,
    L.Name,
    S.Name,
    PS.PartNo,
    --PM.DisplayName,
    PS.LotNo,
    WC.Name,
    WC2.Name,
    PSS.Name,
    PS.Mixing,
    PS.Glazing,
    PS.StartTime,
    PS.[Weight],
    PS.Pallets
    FROM PROD_ProductionSchedule PS
    --LEFT OUTER JOIN PartMaster PM on PS.PartNo = PM.Name
    LEFT OUTER JOIN Location L on PS.LocationId = L.Id
    LEFT OUTER JOIN PROD_Shifts S on PS.ShiftId = S.Id
    LEFT OUTER JOIN PROD_WorkCenters WC on PS.OvenId = WC.Id
    LEFT OUTER JOIN PROD_WorkCenters WC2 on PS.LineId = WC2.Id
    LEFT OUTER JOIN PROD_ProductionScheduleStatus PSS ON PS.ScheduleStatusId = PSS.Id
    WHERE PS.ProductionDate=@StartDate 
    AND PS.LocationId = CASE WHEN @Location = -1 THEN PS.LocationId ELSE @Location END
    AND PS.PartNo = CASE WHEN @PartNo = 'ALL' THEN PS.PartNo ELSE @PartNo END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:38:18.633

获取本周的星期二和 7 天后：

```
select dateadd(dd, 3 - datepart(dw, getdate()), 
getdate()), dateadd(dd, 10 - datepart(dw, getdate()), getdate()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:21:49.283

计算一周的开始和结束：

```
declare @StartOfWeek datetime
declare @EndOfWeek datetime

if DATEPART(weekday,@StartDate) = 3 --Tuesday
begin
    set @StartOfWeek = @StartDate
    set @EndOfWeek = dateadd(week,1,@StartDate)
end
else if DATEPART(weekday,@startdate) > 3
begin
    set @StartOfWeek = dateadd(DAY,-(DATEPART(weekday,@startdate)-3),@StartDate)
    set @EndOfWeek = dateadd(DAY,10-DATEPART(weekday,@startdate),@StartDate)
end
else
begin
    set @StartOfWeek = dateadd(DAY,-4-(DATEPART(weekday,@startdate)),@StartDate)
    set @EndOfWeek = dateadd(DAY,3-DATEPART(weekday,@startdate),@StartDate)
end 
```

然后您可以在 Where 子句中使用这些：

```
WHERE PS.ProductionDate between @StartOfWeek and @EndOfWeek 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T21:58:42.417

首先，创建一个包含两列的[日历表](http://weblogs.sqlteam.com/dang/archive/2010/07/19/calendar-table-and-datetime-functions.aspx)，其中包含任何给定日期的工作周的第一天和最后一天。然后你可以写一些非常清晰、简单的代码：

```
declare @FirstDayOfWorkingWeek date,
        @LastDayOfWorkingWeek date

select 
    @FirstDayOfWorkingWeek = FirstDayOfWorkingWeek, 
    @LastDayOfWorkingWeek = LastDayOfWorkingWeek
from
    dbo.Calendar
where
    [Date] = @StartDate

select *
from dbo.PROD_ProductionSchedule
where ProductionDate between @FirstDayOfWorkingWeek and @LastDayOfWorkingWeek 
```

根据您存储日期的方式，请[注意](https://sqlblog.org/2011/10/19/what-do-between-and-the-devil-have-in-common)使用`BETWEEN`.

使用日历表几乎总是比使用函数计算日期更可取，因为您可以轻松读取和验证日期；你可以`UPDATE`让你的表处理常规逻辑的异常；您的代码通常更具可读性且更易于维护；`JOIN`如果您在表上而不是使用嵌套函数，性能会更好。

# javascript - How do I move a tr tag back to the viewport

> ID：16092974
> 
> 赞同：0
> 
> 时间：2013-04-18T20:59:55.617
> 
> 标签：javascript, jquery, html

I have many tr in the visible area where it generates a scrollbar, tr each has its own id, how do I know if it is in the visible area of the scrollbar, and if not how do I place it in the visible area using Jquery ?

```
<tr align="center" id="100"><td><a> info </a></td></tr>
<tr align="center" id="101"><td><a> info </a></td></tr>
<tr align="center" id="102"><td><a> info </a></td></tr>
<tr align="center" id="103"><td><a> info </a></td></tr>
<tr align="center" id="104"><td><a> info </a></td></tr>
<tr align="center" id="105"><td><a> info </a></td></tr>
<tr align="center" id="106"><td><a> info </a></td></tr>
<tr align="center" id="107"><td><a> info </a></td></tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:10:28.577

[http://jsfiddle.net/DerekL/b5Bwx/](http://jsfiddle.net/DerekL/b5Bwx/)

一种快速简便的方法：

```
$("div").on("scroll", function(){
   var y = $("#target").offset().top;
    if(y < this.offsetHeight && y > -$("target").height(){
        $("span").append("Visible");
    }
}); 
```

或者这个：http: [//jsfiddle.net/DerekL/Lxsmt/](http://jsfiddle.net/DerekL/Lxsmt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:09:04.287

要确定它们是否在视口中，您需要使用一个函数来计算它。像这样的东西会起作用（不需要jQuery）：

```
function isElementInViewport(el) {
    var rect = el.getBoundingClientRect();

    return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && /*or $(window).height() */
        rect.right <= (window.innerWidth || document.documentElement.clientWidth) /*or $(window).width() */
        );
} 
```

然后，您可以从类似的链接滚动到它们`<a href="#101">Go To Row 1</a>`。

# php - 在codeigniter表单验证中运行回调函数时没有错误信息

> ID：16092982
> 
> 赞同：2
> 
> 时间：2013-04-18T21:00:42.057
> 
> 标签：php, codeigniter, callback, validation

对不起，我的英语不好，

我正在创建一个表单，它采用一些值来指定我的 codeigniter 项目中的报告选项。我想显示在我的回调函数中创建的错误消息。我有 3 个回调函数，如“ **checkStartDate()**、**checkFinishDate()**和**checkIssueExists()** ” 如果验证部分处理未在回调中设置的“必需”之类的错误，那没关系。但是当我在回调函数中设置错误消息时，它们不会出现。重要的事情；**如果“必需”规则未通过，我的所有回调错误都会按应有的方式显示**。但如果“必需”条件通过，则不会出现错误消息。

我有错误消息的问题，回调函数正常工作。当我给出错误的值时，它们返回 FALSE。

这是我的代码：

看法：

```
<div id="newIssue">
<p>
    Fill the form below, add your issue to searching pool.</br>
</p>    

<?php
    if( isset($_GET['validationErrors']) )
        echo $_GET['validationErrors'];
?>

<?=form_open("main/add-to-pool");?>
    <table class="form-table">
        <tr>
            <td>Issue </td>
            <td><?=form_input('issue', $this->input->post('issue'));?></td>
        </tr>

        <tr>
            <td>Report timing </td>
            <td>
                <?php
                    $options = array(
                      'daily'    => 'Every day',
                      'weekly'   => 'Every week',
                      'monthly'  => 'Every month',
                    );

                    echo form_dropdown('timing', $options, 'weekly');
                ?>
            </td>
        </tr>

        <tr>
            <td>Start Date </td>
            <td>
                <?=form_input(array('name' => 'startDate', 'type' => 'date'), $this->input->post('startDate'));?>
            </td>
        </tr>

        <tr>
            <td>Finish Date </td>
            <td>
                <?=form_input(array('name' => 'finishDate', 'type' => 'date'), $this->input->post('finishDate'));?>
            </td>
        </tr>

        <tr>
            <td>Location based </td>
            <td>&nbsp&nbsp 
                <?php
                echo form_radio(array(
                        'name'      => "location",
                        'class'     => "radio",
                        'checked'   => TRUE
                    )); 
                ?>
                Yes

                <?php
                echo form_radio(array(
                        'name'      => "location",
                        'class'     => "radio",
                        'checked'   => FALSE
                    )); 
                ?>
                No
            </td>
        </tr>

        <tr>
            <td></td>
            <td>
                <div style="float:right">
                    <?php
                    echo form_submit(array(
                            'class' => 'btn btn-info', 
                            'id'    => 'addToPool',
                            'name' => 'addToPool', 
                            'value' => 'Add to Pool'
                        ));
                    ?>
                </div>
            </td>
        </tr>
    </table>
<?=form_close();?> 
```

控制器：

```
public function addToPool()
{
    $this->load->library('form_validation');

    $this->form_validation->set_rules('issue', 'Issue', 'required|trim|xss_clean|callback_checkIssueExists');
    $this->form_validation->set_rules('timing', 'Report Timing', 'required|trim|xss_clean');
    $this->form_validation->set_rules('startDate', 'Start Date', 'required|trim|xss_clean|callback_checkStartDate');
    $this->form_validation->set_rules('finishDate', 'Finish Date', 'required|trim|xss_clean|callback_checkFinishDate');

    if ($this->form_validation->run()) {
        $issueContent = preg_replace("/\s+/"," ", $this->input->post('issue') );
        $startDate = date("Y-m-d H:i:s", strtotime($this->input->post('startDate')));
        $finishDate = date("Y-m-d H:i:s", strtotime($this->input->post('finishDate')));

        $issue = new Issue();

        $issue->setContent($this->clearTurkishCharacters($issueContent));
        $issue->setTrContent($issueContent);
        $issue->setCreatedDate(date("Y-m-d H:i:s"));
        $issue->setUpdatedDate(date("Y-m-d H:i:s"));
        $issue->setStartDate($startDate);
        $issue->setFinishDate($startDate);

        $user = new User();
        $user->setUsername($this->session->userdata('username'));
        $user->dbToUser();

        $issue->setUser($user);

        if ($issue->issueToDb()) {
            $_GET['newIssueFancyBox'] = "close";

            $this->home();
        } else
            echo "An error occured while adding user to database!";

    } else {
        $_GET['validationErrors'] = validation_errors('<div class="alert alert-error">','</div>');
        $_GET['newIssueFancyBox'] = "open";

        $this->home();
    }
}

public function checkStartDate()
{
    $startDate = $this->input->post('startDate');

    if (strtotime($startDate) < strtotime('-1 day')) {
        $this->form_validation->set_message('checkStartDate', 'The %s field cannot take a value before today.');
        return FALSE;
    } else {
        return TRUE;
    }
}

public function checkFinishDate()
{
    $startDate = $this->input->post('startDate');
    $finishDate = $this->input->post('finishDate');

    if (strtotime($finishDate) < strtotime($startDate) || strtotime($finishDate) < strtotime('-1 day') ) {
        $this->form_validation->set_message('checkFinishDate', 'The %s field cannot take a value before start date.');
        return FALSE;
    } else {
        return TRUE;
    }
}

public function checkIssueExists()
{
    $this->load->model('modelIssue');

    $issueContent = preg_replace("/\s+/"," ", $this->input->post('issue') );

    $issue = new Issue();

    $issue->setContent($issueContent);

    $user = new User();
    $user->setUsername($this->session->userdata('username'));
    $user->dbToUser();

    $issue->setUser($user);

    if( $this->modelIssue->checkIssueExists($issue) ) {
        $this->form_validation->set_message('checkIssueExists', 'You have already the same issue in pool.');
        return FALSE;
    }
    else
        return TRUE;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T11:51:35.570

您应该扩展 CI_Form_validation 而不是使用回调

```
class MY_Form_validation extends CI_Form_validation
{

    public function checkIssueExists ( $modelIssue )
    {
        // $ci =& get_instance(); //uses __get magic function instead
        //$modelIssue field is automatically passed as param, no need for $_POST

        if ( something ) {
            $this->form_validation->set_error ( 'checkIssueExists' ,
                                                'Some error' ) ;
            return false ;
        }
        else {
            return true ;
        }
    }
    /** magic function to get CI super object(object) **/
    public function __get ( $object )
    {
        $instance = &get_instance () ;
        return $instance->$object ;
    }

} 
```

- 像其他人建议使用错误内联

```
echo form_error('field_name') 
```

或者

```
foreach( validation_errors() as $error ):
 ...
endforeach; 
```

我还会在 ./config 中设置一个 form_validation.php 配置文件

```
$config = array(
    'class/method' => array(
      array('field'=>'', 'label'=>'', 'rules'=>'required|checkIssueExists'),  
    ),
); 
```

你现在干净的控制器方法

```
 // If the form validation cant find any key for this class/method
        // in config/form_validation.php
        // optionally you can pass in a key
        // ie: if($this->form_validation->run('key'))
        if( !$this->form_validation->run() )
        {
            return $this->home();
        }

        //validation must have passed 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T13:06:25.277

我自己解决了这个问题，但是我已经弄清楚了根据@Philip 的回答更改代码时会发生什么。在我的旧代码中，我有回调函数，然后我将它们更改为@Philip 的答案。但我仍然没有收到我想显示的错误消息。我刚刚意识到，当我在同一个函数中创建用户或问题类对象时，我无法设置错误消息。

在我的旧代码中（库/MY_Form_validation.php）；

```
public function checkIssueExists()
{

    $this->load->model('modelIssue');

    $issueContent = preg_replace("/\s+/"," ", $this->input->post('issue') );

    $issue = new Issue();

    $issue->setContent($issueContent);

    $user = new User();
    $user->setUsername($this->session->userdata('username'));
    $user->dbToUser();

    $issue->setUser($user);

    if (!$this->modelIssue->checkIssueExists($issue->getContent(), $issue->getUser()->getUsername())) {
        return TRUE;
    } else {
        $this->form_validation->set_message('checkIssueExists', 'You have already the same issue in pool.');
        return FALSE;
    }
} 
```

你可以看到`$issue = new Issue();`和`$user = new User();`线导致我的问题。但我不明白为什么会这样。我有 3 个控制器类，

*   Main（处理请求和基本功能，如 signIn()、signUp()、home()、dashboard() 等）
*   用户（基本用户函数，如 getUsername()、setId()、dbToUser()、userToDb() 等）
*   问题（getIssue()、setUser()、getContent() 等基本问题函数）

我需要这些功能，所以我认为我可以在需要时使用这些类。但是在回调函数或 MY_Form_validation.php 文件中，我不能像上面那样使用它们。

我已经如下更改了我的代码（以及依赖于我的代码的其他页面），它现在可以工作了；库/MY_Form_validation.php；

```
public function checkIssueExists()
{
    $issueContent = preg_replace("/\s+/"," ", $this->input->post('issue') );
    $username = $this->session->userdata('username');

    if (!$this->modelIssue->checkIssueExists($issueContent, $username)) {
        return TRUE;
    } else {
        $this->form_validation->set_message('checkIssueExists', 'You have already the same issue in pool.');
        return FALSE;
    }
} 
```

但是我不知道为什么我在同一个函数中使用我的类时不能设置错误消息。

谢谢你的帮助。

# mod-rewrite - 如何 301 替代英语的语言网站？

> ID：16092986
> 
> 赞同：1
> 
> 时间：2013-04-18T21:01:03.967
> 
> 标签：mod-rewrite, http-status-code-301

我的客户有一个包含英语、德语、西班牙语和法语站点的网站。它们只是 public_html 目录中服务器上的简单文件夹结构，例如。/de、/fr、/en 和 /es

他们决定删除其他语言，只有英语，但我有很多页面需要 301 重定向。

我已经使用 mod_rewrite 来完成漂亮的 URL。

在不破坏漂亮 URL 的情况下将替代语言页面重定向到英文页面的最佳方法是什么？

例如。`fr/news/news-article`->`en/news/news-article`

我已经有了：

```
RewriteRule ^([^/\.]+)/news?$ $1/news.php [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:17:52.780

在 .htaccess 中的所有其他重写规则之上添加此 RewriteRule 行：

```
RewriteRule ^(?:de|fr|es)(/.*|)$ /en$1 [L,R=301,NC] 
```

这将重定向（R = 301）每个`/fr/bla/bla`或`/de/bla/bla`或`/es/bla/bla``/en/bla/bla`

# rest - REST post/put 可以有请求参数并且没有请求有效负载

> ID：16092989
> 
> 赞同：2
> 
> 时间：2013-04-18T21:01:24.803
> 
> 标签：rest, post, put, payload

我正在研究 REST API。REST API post/put 可以包含没有请求有效负载的请求参数吗？我可以在哪里找到标准的 REST 规范

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:11:34.080

没有“标准 REST 规范”。REST 由 Roy Fielding 的论文[Architectural Styles and the Design of Network-based Software Architectures](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)定义。HTTP 动词 POST 和 PUT 在[rfc 2616](http://www.w3.org/Protocols/rfc2616/rfc2616.html)中定义。REST 并不一定意味着 HTTP 传输 - 它是一种非常适合基于 Web 的 API 的架构风格。这种风格的一部分是服务的定义完全由传递的消息的内容决定，特别是它们包含对服务其他部分的引用（即超链接）的方式。因此，如果您的 API 创建一个空资源是有意义的，那么一个空的 PUT 请求将是一种合理的方法。

# android - Only select only one radio button from listview

> ID：16092991
> 
> 赞同：6
> 
> 时间：2013-04-18T21:01:27.777
> 
> 标签：android, listview, radio-button

I have searched the question over and over, there are many questions I have found in stackoverflow but I did not come up with a solution. Here is my problem. I have a list of item in a linearlayout like this: ![enter image description here](https://i.stack.imgur.com/iFml0.jpg)

When the screen comes first, the last radion button is selected automatically. But if I select another radio button, the last radio button is already in selected state. I want to select only one radion button but at the same time when the screen comes first the last radio button will be auto selected and other automatically will not be selected. How can I achieve this. My adapter class is :

```
public class AdapterPaymentMethod extends ArrayAdapter<PaymentData> {
    private Context context;
    private boolean userSelected = false;
    ViewHolder holder;

    public AdapterPaymentMethod(Context context, int resource,
            List<PaymentData> items) {
        super(context, resource, items);
        this.context = context;
    }

    /* private view holder class */
    private class ViewHolder {
        RadioButton radioBtn;
        Button btPaymentMethod;
        // ImageView ivLine;
    }

    public View getView(final int position, View convertView, ViewGroup parent) {
        holder = null;
        PaymentData rowItem = getItem(position);
        LayoutInflater mInflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        if (convertView == null) {
            convertView = mInflater.inflate(
                    com.android.paypal.homeactivity.R.layout.list_item, null);
            holder = new ViewHolder();
            holder.radioBtn = (RadioButton) convertView
                    .findViewById(com.android.paypal.homeactivity.R.id.rdb_payment_method);
            holder.btPaymentMethod = (Button) convertView
                    .findViewById(com.android.paypal.homeactivity.R.id.bt_item_event);
            convertView.setTag(holder);
        } else
            holder = (ViewHolder) convertView.getTag();

        if(position==getCount()-1 && userSelected==false){
            holder.radioBtn.setChecked(true);
        Log.d("if position", ""+position);
        }
        else{
            holder.radioBtn.setChecked(false);
            Log.d("else position", ""+position);
        }

        holder.radioBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                userSelected=true;
                if(getCount()-1==position&&userSelected==true){         
                }
                else if(getCount()-2==position&&userSelected==true)
                {
                    holder.radioBtn.setChecked(true);
                }
            }
        });

        holder.radioBtn.setText(rowItem.getRdbText());
        holder.btPaymentMethod.setText(rowItem.getBtText());
        return convertView;
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-18T21:19:49.190

将当前签`RadioButton`入的变量保留在`Activity`. 在`OnClickListener`你`RadioButtons`这样做：

```
// checks if we already have a checked radiobutton. If we don't, we can assume that 
// the user clicked the current one to check it, so we can remember it.
if(mCurrentlyCheckedRB == null) 
    mCurrentlyCheckedRB = (RadioButton) v;
    mCurrentlyCheckedRB.setChecked(true);
}

// If the user clicks on a RadioButton that we've already stored as being checked, we 
// don't want to do anything.       
if(mCurrentlyCheckedRB == v)
    return;

// Otherwise, uncheck the currently checked RadioButton, check the newly checked 
// RadioButton, and store it for future reference.
mCurrentlyCheckedRB.setChecked(false);
((RadioButton)v).setChecked(true);
mCurrentlyCheckedRB = (RadioButton)v; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-12-01T10:33:30.550

这是我的代码：

**ListAdapter.java**

```
public class ListAdapter extends BaseAdapter {

    private Context context;
    private String[] version;
    private LayoutInflater inflater;
    private RadioButton selected = null;

    public ListAdapter(Context context, String[] version) {
        this.context = context;
        this.version = version;
        inflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        return version.length;
    }

    @Override
    public Object getItem(int position) {
        return version;
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(final int position, View view, ViewGroup viewGroup) {

        final Holder holder;
        if (view == null) {
            holder = new Holder();
            view = inflater.inflate(R.layout.row_list, null);

            holder.radioButton = (RadioButton) view.findViewById(R.id.radio1);
            holder.textViewVersion = (TextView) view.findViewById(R.id.textView1);
            holder.btnMore = (Button) view.findViewById(R.id.button1);

            view.setTag(holder);
        } else {
            holder = (Holder) view.getTag();
        }

        holder.textViewVersion.setText(version[position]);

        //by default last radio button selected
        if (position == getCount() - 1) {
            if (selected == null) {
                holder.radioButton.setChecked(true);
                selected = holder.radioButton;
            }
        }

        holder.radioButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {

                if (selected != null) {
                    selected.setChecked(false);
                }
                holder.radioButton.setChecked(true);
                selected = holder.radioButton;
            }
        });       
    }

    private class Holder {
        private RadioButton radioButton;
        private TextView textViewVersion;
        private Button btnMore;
    }
} 
```

希望这可以帮助你:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-01T06:35:00.197

试试这个技巧。

在布局中进行此更改。

```
<RadioButton
  android:id="@+id/radio"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:layout_gravity="center_vertical"
  **android:clickable="false"
  android:focusable="false"**
/> 
```

在您的适配器中，只需添加以下几行：

```
 private int selectedPosition = -1;

 viewHolder.choiceButton = (RadioButton)convertView.findViewById(R.id.radio);

 if(selectedPosition == -1) {
    viewHolder.choiceButton.setChecked(position==getCount()-1);
 }
 else{
    viewHolder.choiceButton.setChecked(selectedPosition == position);
 } 
```

在 getView() 中分配 selectedPosition：

```
viewHolder.clickLayout.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                selectedPosition = (int) view.getTag();
                notifyDataSetChanged();
            }
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-04T11:21:35.807

在您的 Adapter 类中，获取一个全局变量并对其进行初始化，如下所示。

```
private int lastSelectedPosition = -1;

public class ViewHolder extends RecyclerView.ViewHolder {
    public RadioButton check;
    public ViewHolder(View itemView) {
        super(itemView);
        check=itemView.findViewById(R.id.check_box4);//Your radio button id
        check.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                lastSelectedPosition = getAdapterPosition();
                notifyDataSetChanged();
            }
        });
    }

public void onBindViewHolder(ViewHolder holder, int position) {
    holder.check.setChecked(lastSelectedPosition == position);
} 
```

# cygwin - Cygwin 控制台 jabber 客户端

> ID：16092995
> 
> 赞同：1
> 
> 时间：2013-04-18T21:01:36.507
> 
> 标签：cygwin, xmpp

是否存在任何 cygwin 控制台 jabber 客户端？我还没有成功编译cygwin 中[列出的任何控制台客户端。](http://xmpp.org/xmpp-software/clients/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-05T22:57:44.470

你试过亵渎吗？

[http://www.profanity.im/](http://www.profanity.im/)

它适用于 Cygwin，包括 Windows 上的桌面通知，并且下载有一个脚本来安装 Cygwin 依赖项以进行编译。

# sql - 甲骨文 SQL 更新

> ID：16092996
> 
> 赞同：-2
> 
> 时间：2013-04-18T21:01:40.197
> 
> 标签：sql, oracle

我试过在这里搜索这个特定的主题，但没有找到答案......无论如何，我的目标是更新表（我们称之为 t_item），特别是列 owner_id，其值取决于另一个表（t_item_geo 在转链接到 t_geo）。

我不完全确定下面的语法对于更新语句是否真的有效。

```
UPDATE t_item SET owner_id= 6993 WHERE t_item.owner_id in
(SELECT t_item.owner_id FROM
t_item,
t_item_geo,
t_geo
WHERE
t_item.id = t_item_geo.item_id and
t_item_geo.geo_id = t_geo.id and
t_item.owner_id in (SELECT id FROM t_user WHERE network_id='fffffff') and
t_geo.id in (SELECT id FROM t_geo WHERE full_name = 'yyyyyyy')
); 
```

无论如何，我对这个查询的问题是它更新的行比它应该更新的多得多——如果我只分离选择语句 Oracle 返回 ~750 行但 udpate 本身更新超过 4000 行。几乎就好像条件被完全忽略了——这将指向我可能不正确的语法。

我需要根据从其他几个“加入”表中的选择来更新表中的特定值。希望这是有道理的。

感谢您的任何贡献！

更新：抱歉 - 问题本身可能不清楚，但编辑项目的正确数量应该是 ~750 而不是 ~4000。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:28:34.443

尝试这个

```
MERGE INTO t_item
USING 
(
    SELECT t_item.owner_id FROM
    t_item,
    t_item_geo,
    t_geo,
    t_item.rowid rowid_sub 
    WHERE
    t_item.id = t_item_geo.item_id and
    t_item_geo.geo_id = t_geo.id and
    t_item.owner_id in (SELECT id FROM t_user WHERE network_id='fffffff') and
    t_geo.id in (SELECT id FROM t_geo WHERE full_name = 'yyyyyyy')
) on (rowid = rowid_sub)
WHEN MATCHED THEN
UPDATE SET owner_id= 6993; 
```