# StackOverflow 问答 15234000-15234999

# java - 如何从 Java/Rest 客户端登录到具有 Spring Security 的应用程序

> ID：15234001
> 
> 赞同：1
> 
> 时间：2013-03-05T20:59:35.327
> 
> 标签：java, spring, rest, authentication, login

我们的应用程序是使用 Spring 构建的（MVC、事务、身份验证等）。我们使用 LoginUrlAuthenticationEntryPoint 进行身份验证（请参阅下面的整个 spring security xml）。Web 客户端 (jsp) 使用 j_spring_security_check 表单登录到此应用程序。该应用程序具有 REST API，并且浏览器代码（Web 客户端）对应用程序进行 REST 调用。到目前为止一切顺利，一切正常。我们正在用 Java 编写代码来测试应用程序 - 使用 REST 调用进行端到端测试（类似于真实客户端（在我的例子中是 Web 客户端）调用应用程序的方式）。我在测试端使用 Apache 的 HttpClient 对应用程序进行 REST 调用。你知道如何从 Java 编写的测试代码中验证/登录到应用程序吗？非常感谢任何指导。谢谢，婴儿车。

```
<security:global-method-security secured-annotations="enabled" pre-post-annotations="enabled"/>

<security:http auto-config="false" use-expressions="true" entry-point-ref="authenticationEntryPoint">
    <security:intercept-url pattern="/login*" filters="none"/>
    <security:intercept-url pattern="/agentMsg" filters="none"/>
    <security:intercept-url pattern="/wait" filters="none"/>
    <security:intercept-url pattern="/systemConfig/**" filters="none"/>
    <security:intercept-url pattern="/js/**" filters="none" />
    <security:intercept-url pattern="/css/**" filters="none" />
    <security:intercept-url pattern="/images/**" filters="none" />
    <security:intercept-url pattern="/heartbeat" filters="none" />
    <security:intercept-url pattern="/reposTracking" filters="none" />
    <security:intercept-url pattern="/alerts/sev" filters="none" />
    <security:intercept-url pattern="/**" access="isAuthenticated()" />
    <security:form-login  
        login-page="/login" 
        default-target-url="/" 
        authentication-failure-url="/login?login_error=1" 
        authentication-success-handler-ref="mcLoginSuccessHandler"
        authentication-failure-handler-ref="mcLoginFailureHandler"
    />
    <security:remember-me/>
    <security:logout success-handler-ref="mcLogoutHandler"/>
    <security:custom-filter position="CONCURRENT_SESSION_FILTER" ref="concurrencyFilter"/>
    <security:session-management session-authentication-strategy-ref="sas"/>
</security:http>

<!--  needed for remember-me service -->
<bean id="customUserDetailService" class="com.mycompany.admin.tools.webui.beans.MyCompanyUserDetailsService"/>

<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider ref="vuiAuthenticationProvider"/>
</security:authentication-manager>

<bean id="vuiAuthenticationProvider" class="com.mycompany.admin.tools.webui.beans.VuiMycompanyUserDetailsAuthenticationProvider">
    <property name="userDetailsService" ref="customUserDetailService"/>
    <property name="passwordEncoder"    ref="md5PasswordEncoder"/>
</bean>

<bean id="md5PasswordEncoder" class="org.springframework.security.authentication.encoding.Md5PasswordEncoder"/>      

<bean id="authenticationEntryPoint" class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint">
    <property name="loginFormUrl" value="/login"></property>
</bean>

 <bean id="concurrencyFilter" class="org.springframework.security.web.session.ConcurrentSessionFilter">
    <property name="sessionRegistry" ref="sessionRegistry"/>
    <property name="expiredUrl" value="/login"/>
    <!-- <property name="redirectStrategy" value=""></property> -->
 </bean>

 <bean id="sas" class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
      <constructor-arg name="sessionRegistry" ref="sessionRegistry" />
      <property name="maximumSessions" value="-1" /> <!-- no limit on number of session per user -->
 </bean>

 <bean id="sessionRegistry" class="org.springframework.security.core.session.SessionRegistryImpl" />

<bean id="mcLogoutHandler" class="com.mycompany.admin.tools.webui.servlets.McLogoutHandler"/>
<bean id="mcLoginSuccessHandler" class="com.mycompany.admin.tools.webui.servlets.McLoginSuccessHandler"/>
<bean id="mcLoginFailureHandler" class="com.mycompany.admin.tools.webui.servlets.McLoginFailureHandler"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:09:27.437

首先，如果您的测试发出 http 请求，那么它们不是单元测试，而是功能测试。

如果你想让这样的测试工作，你基本上必须完成从浏览器登录时执行的步骤：`POST`凭据到`/j_spring_security_check`，并确保`JSESSIONID`在响应中设置的 cookie 被发送回服务器每个后续调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:16:08.763

你应该测试低一级。以单元测试的方式测试你的业务逻辑。为什么需要测试 RestEasy/CXF/Jersey/whatever 是否正确调用方法？您是否需要测试 spring-security 是否正常工作？我猜有人已经为此编写了单元测试。

对于集成测试，请阅读 Spring[文档](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/testing.html#integration-testing)。您可以设置一个更简单的上下文而无需身份验证并调用 MockHttpRequest。

对于 REST 测试，您还可以使用 SoapUI。

# c++ - 我怎样才能把这个qt程序放到一个源代码文件中

> ID：15234002
> 
> 赞同：0
> 
> 时间：2013-03-05T20:59:39.897
> 
> 标签：c++, qt, user-interface

我想把这段代码放在一个文件中，但不知道怎么做。我知道这样做可能不是一个好习惯，但我正在尝试学习 qt，如果信息在一个文件中，我会发现它更容易理解。

这是main.cpp

```
#include "mainwindow.h"

#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    MainWindow mainWindow;
    mainWindow.showMaximized();
    return app.exec();
} 
```

这是主窗口.cpp

```
#include "mainwindow.h"

#include <QCoreApplication>

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
{
    // Create the button, make "this" the parent
    m_button = new QPushButton("My Button", this);
    // set size and location of the button
    m_button->setGeometry(QRect(QPoint(100, 100),
                             QSize(200, 50)));

    // Connect button signal to appropriate slot
    connect(m_button, SIGNAL(released()), this, SLOT(handleButton()));
}

void MainWindow::handleButton()
{
    // change the text
    m_button->setText("Example");
    // resize button
    m_button->resize(100,100);
} 
```

这是主窗口.h

```
#define MAINWINDOW_H

#include <QMainWindow>
#include <QPushButton>

namespace Ui {
    class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);

private slots:
    void handleButton();

private:
    QPushButton *m_button;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:25:04.803

**在与您的主文件相同的文件中定义新类通常不是一个好主意。通常，您希望每个新类都在它们自己的文件中，或者您希望将几个相关的类放在一个单独的文件中。**您可以搜索大量与最佳实践相关的资源。我建议你花一些时间阅读。

但是既然你问了......下面是你如何为你的例子做的。如果你没有在 main 之上定义你的类，编译器会抱怨，因为它不知道“MainWindow”是什么。

```
#include <QApplication>
#include <QMainWindow>
#include <QPushButton>

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);

private slots:
    void handleButton();

private:
    QPushButton *m_button;
};

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    MainWindow mainWindow;
    mainWindow.showMaximized();
    return app.exec();
}

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
{
    // Create the button, make "this" the parent
    m_button = new QPushButton("My Button", this);
    // set size and location of the button
    m_button->setGeometry(QRect(QPoint(100, 100),
                             QSize(200, 50)));

    // Connect button signal to appropriate slot
    connect(m_button, SIGNAL(released()), this, SLOT(handleButton()));
}

void MainWindow::handleButton()
{
    // change the text
    m_button->setText("Example");
    // resize button
    m_button->resize(100,100);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:14:01.537

只需将所有内容复制到一个文件中即可。

```
#include <QApplication>
#include <QMainWindow>
#include <QPushButton>

namespace Ui {
    class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);

private slots:
    void handleButton();

private:
    QPushButton *m_button;
};

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent)
{
    // Create the button, make "this" the parent
    m_button = new QPushButton("My Button", this);
    // set size and location of the button
    m_button->setGeometry(QRect(QPoint(100, 100),
                             QSize(200, 50)));

    // Connect button signal to appropriate slot
    connect(m_button, SIGNAL(released()), this, SLOT(handleButton()));
}

void MainWindow::handleButton()
{
    // change the text
    m_button->setText("Example");
    // resize button
    m_button->resize(100,100);
}

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    MainWindow mainWindow;
    mainWindow.showMaximized();
    return app.exec();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:10:14.027

`#include`基本上获取您选择的任何文件的内容并将其复制/粘贴到该位置。然后编译器从文件的顶部开始，一直到底部。

知道了这一点，您应该能够按照文件包含的顺序复制粘贴文件的内容。

`mainwindow.h`

`mainwindow.cpp`

`main.cpp`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:36:12.873

简短的回答是不要这样做，你应该在它自己的头文件中定义一个类，并在你想在主文件中运行它时将它#include 到主文件中。这允许您在整个程序中重用您认为合适的类，这是面向对象编程的原则之一，可重用代码。例如

```
class A
{
public:
    A();
    ~A();
    void somePublicMethod();
private:
    void somePrivateMethod();
}; 
```

如果在将该类编译为目标代码时将该类包含在主文件中（假设您知道在 .cpp 文件中实现该类），那么当链接所有目标文件以创建程序时，链接器基本上会生成一个大文件文件中包含的所有目标代码都将被完全编译。我建议你阅读更多关于编译和链接的内容，基本上它归结为三个阶段，预处理、编译和链接。了解有关面向对象编程的更多信息，并阅读为什么将它们全部塞入一个文件是一个坏主意。每个类都应该在其自己的自包含 .h 文件中（除非它是紧密耦合的类），因此您可以根据需要包含它们。希望这会有所帮助，玩 Qt :)

# c++ - 限制 C++ 中的登录尝试

> ID：15234021
> 
> 赞同：2
> 
> 时间：2013-03-05T21:00:32.147
> 
> 标签：c++

好的，我已经学习 C++ 大约 4 天了，它是我的第一门编程语言。所以这真正意味着我只有大约 8 小时的编程经验，其中很多是阅读我的 C++ 书的介绍并弄清楚如何使用 XCode。

无论如何，我的初学者 C++ 书要求我执行以下操作：“编写一个密码提示，只给用户一定次数的密码输入尝试，这样用户就不能轻易地编写密码破解程序。”

唯一的问题是我刚刚学习了循环，我认为这本书甚至还没有涵盖如何限制尝试。任何人都可以帮忙吗？我见过[这个](https://stackoverflow.com/questions/8439004/c-password-attempt-limit)，但它对我来说太先进了，我不明白。这是代码：（真的是基本的新代码......如果它侮辱了你的智力，对不起）

```
#include <iostream>
#include <string>

using namespace std;

int main ()
{
string username;
string password;

while ( 1 )
{
    cout << "Enter your username: " << endl;
    cin >> username;
    cout << "Enter your password: " << endl;
    cin >> password;

    if ( username != "billy" && password != "bob" )
    {
        cout << "Incorrect username/password combination. Please try again." << "\n" <<
        endl;
    }

    else
    {
        break;
    }
}

cout << "Access granted." << endl;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T21:05:06.187

除非您明确地从循环中，否则该构造会重复无穷大`while ( 1 ) { }`内部的任何内容。这是一个循环，顺便说一句。`{}``break`

经过多次尝试，你怎么能摆脱它？你可以有一个计数器，每次尝试都会增加一个计数器，并在极限处从循环中中断：

```
if ( ++counter >= limit )
    break; 
```

或者只是将条件移动到 while

```
while ( ++counter < limit ) 
```

或使用简单的`for`循环或`do {} while()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:08:06.120

取一些变量，比如尝试计数，它跟踪尝试的次数。将其初始化为 0 并在每次尝试失败时将其递增 1。将条件放入 while 循环中，检查尝试计数是否小于允许的尝试次数（在下面的代码中取 3）。因此，代码将是：

```
#include <iostream>
#include <string>

using namespace std;

int main ()
{
string username;
string password;
int attemptCount = 0;

while ( attemptCount < 3 )
{
cout << "Enter your username: " << endl;
cin >> username;
cout << "Enter your password: " << endl;
cin >> password;

if ( username != "billy" && password != "bob" )
{
    cout << "Incorrect username/password combination. Please try again." << "\n" <<
    endl;

    attemptCount++;
}

else
{
    break;
}
}

cout << "Access granted." << endl;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:08:43.080

您的`while(1)`循环将永远持续下去，除非您还有一些计数器，每次尝试失败都会增加计数器。

但坦率地说......为什么有一个`while`循环和一个单独的计数器？你有一个已知的最大迭代次数；这就是制作循环的那种情况`for`。

```
for (int attempts = 1; attempts <= 3; ++attempts) {
    ... get login info ...

    if (...username and password are correct...) {
        cout << "Access granted.\n";
        return 0;
    }
    else {
        cout << "Invalid login.\n";
    }
}

// Note as well, the default case (what happens if they make it through the loop)
// should be no access.  Otherwise, someone could just succeed by inputting three
// bad passwords.  :P
cout << "Too many invalid login attempts.\nExiting.\n";
return -1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:11:10.010

想想这是如何工作的：

```
#include <iostream>

using namespace std;
int main()
{
  const int MAXTRYS = 4;
  int numTrys = 0;

  while(numTrys != MAXTRYS)
  {
    cout << "Attempting login" << endl;
    ++numTrys;
  }
return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T21:42:41.720

您应该使用`for`循环，而不是`while`循环。类似于以下内容：

```
bool bSuccess = false;
for (int i = 0 ; i < maxAttemps ; ++i)
{
    // your stuff
    // set bSuccess = true when relevant
}

if (bSuccess)
{
    // ok, successfully logged in
} 
```

无限循环通常仅限于真正的无限循环（永远等待网络消息直到退出等）。作为良好实践的经验法则，请尽量避免无限循环，并且`break`也要构造，因为它通常有点hacky。为了练习，您应该尝试编写可以转换为简单数据流的漂亮代码。

我猜你怀疑它，但这根本不安全（你将用户名和密码以纯文本形式存储在可执行文件的代码中）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-11T07:06:37.603

我很难重新熟悉 C++，因为高中（@8 年前）发生了很大变化，或者我的信息数学老师很糟糕......我也发现“for”循环更适合这种练习，但是“返回0”不是真的吗？和“打破；” 做同样的事？这就是我用我在这里看到的和我已经“知道”的东西得出的结论:)。奇迹般有效。

```
#include <iostream>
#include <string>

using namespace std;
int main ()
{
int attempts = 0;
string password;

for (int attempts = 0; attempts < 5; ++attempts )
{
    cout << "enter your password! \n";
    cin >> password;
    ++attempts;
    if ( password == "boo123" )
    {
        cout << "granted!";
        return 0;
    }
    else
    {
        cout << "denied! \n";
    }
}

} 
```

还有一件事：所有循环都是无限的，直到你“中断”；它或“返回0；” 它...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-01T10:13:48.630

```
/*Write a password prompt that gives a user only a certain number of password entry attempts—
so that the user cannot easily write a password cracker*/

#include <iostream>
#include <string>
using namespace std;
int main ()
{
    string password;
    int x = 1;

    while (1)  //This creates an overall top level infinite loop
    {
        cout << "Input password here: ";
        cin >> password;

       if ( password == "teddy") //This sets the condition for success
       {
           cout << "Access Granted!!!!";
           break; //The break is applied here to stop the cycle after success is made
       }

       else if ( password != "teddy") //This sets the condition for failure

       {
       cout << "Wrong username/password" << "\n" << x << " " << "wrong attempts" << "\n";
       ++x;

       if ( x > 5 ) // This is the counter limit portion. Limit set to 5 attempts

       {
           break;
       }

       }

    }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-04T10:15:56.440

```
#include <iostream>

using namespace std;

int main()
{
    string password;
    int pCounter = 0;
    cout << "Enter Password here: ";
    getline(cin, password);
    while(pCounter <= 4){
        if(password != "winner"){
            cout << "Count: " << pCounter << endl;
            cout << "Try again..wrong entry.." << endl;
            cout << "Enter Password here: ";
            getline(cin, password);
            ++pCounter;
                if((password != "winner") && (pCounter == 4)){
                    cout << "The End..No more tries!!" << endl;
                    break;
                }
        }

        else{
            cout << "Welcome In Bro" << endl;
            break;
        }
    }
    return 0;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-11T23:07:47.827

# 包括

使用命名空间标准；

int main() { 字符串密码 = "set"; //声明密码字符串输入；//声明一个字符串供以后输入

```
for (int attempt = 1; attempt <= 3; attempt++) {        //if you fail the password 3 times you get kicked out
    cout << "enter password " << flush;
    cin >> input;
    if (input == password) {                            //checks to make sure the user input matches set password
        cout << "granted";
        return 0;                                       //once correct password is put in the program ends
    }
    else {                                              //if password is wrong repeat till right or 3 trys
        cout << "you fail" << endl;
    }
} 
```

}

# objective-c - 如何直接进入 Game Center 'New Game' ViewController？

> ID：15234024
> 
> 赞同：0
> 
> 时间：2013-03-05T21:00:51.443
> 
> 标签：objective-c, game-center, ios6.1

我正在做一个回合制游戏，有一个viewController，我为游戏设置了参数，想直接跳转到游戏中心邀请ViewController，se图片。

我一直在寻找解决方案，但找不到任何描述。

我的问题是这是否可能？

![在此处输入图像描述](../Images/28104c0282cfe27c60551ab32571ecaf.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T02:26:53.233

如果您设置了一个 GKTurnBasedMatchHelper 类，其中包含一个单例 sharedInstance 类方法，您可以通过执行以下操作调用 Game Center 的自动匹配屏幕：

```
[[GCTurnBasedMatchHelper sharedInstance]
     findMatchWithMinPlayers:2 maxPlayers:2 viewController:self]; 
```

GCTurnBasedMatchHelper 中的 sharedInstance 方法应如下所示：

```
+ (GCTurnBasedMatchHelper *) sharedInstance {
    static GCTurnBasedMatchHelper *sharedHelper;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        sharedHelper = [[GCTurnBasedMatchHelper alloc] init];
    });

    return sharedHelper;
} 
```

[您可以在这篇关于](http://www.raywenderlich.com/5480/beginning-turn-based-gaming-with-ios-5-part-1)使用 Game Center 进行回合制游戏的文章中找到有关使用 Game Center 进行回合制游戏的精彩教程。

# javascript - 通过 th 和第一个 td 在行中的表映射以从 json 对象填充

> ID：15234026
> 
> 赞同：0
> 
> 时间：2013-03-05T21:00:56.503
> 
> 标签：javascript, jquery, json, foreach

使用 php 内联回显 json 数组我希望 js/jquery 根据这些数据填充表。

HTML 表格

```
<table>
<thead>
    <tr>
        <th>Time</th>
        <th data-day='2013-03-15'>15-3</th>
        <th data-day='2013-03-16'>16-3</th>
        <th data-day='2013-03-17'>17-3</th>
    </tr>    
</thead>
<tbody>
<tr data-time='09'>
    <td>9am</td>
    <td></td>
    <td></td>
    <td></td>
</tr>
</tbody>
</table>
<script>
var arr=[ 
 {"date":"2013-03-15","id":"4","time_booked":"09:00:00"},
 {"date":"2013-03-15","id":"1","time_booked":"09:10:00"},
 {"date":"2013-03-17","id":"5","time_booked":"09:30:00"}
];
$.each(arr,function(){
    console.log('id:'+this.id+'inside:'+this.date+'|'+this.time_booked);
});
</script> 
```

我想循环 thro arr 并根据它的 date 和 time_booked 在 td 中写入 id。

例如，第一行将使用 date-day='2013-03-15' 和 data-time='09' 转到 td 那么我该如何使用 javascript 来做到这一点？

我想我应该在 tbody 的每个 td 中包含数据日、数据时间吗？或者有更好的方法吗？

**目前的做法：**

在每个 tr 中包含 data-day 所以 tbody 的 html 是

```
<tr data-time='09'>
   <td data-day='2013-03-15'></td>
   <td data-day='2013-03-16'></td>
etc..
</tr> 
```

然后用js

```
$.each(arr,function(){
    var rday=this.date;
    var rtime=this.time_booked;
    var sel='tr[data-hr="'+rtime.substr(0,2)+'"]';
    var dom=$(sel).find('td[data-day="'+rday+'"]').first();
    if(dom.length)dom.append(this.id);
}); 
```

但我有一种感觉它很愚蠢！必须有一种使用 x,y （表头，行头）映射表的方法，还是没有？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:31:35.263

我认为 jQuery[索引功能](http://api.jquery.com/index/)是您正在寻找的。在下面的代码示例中，我使用它来获取`colIndex`日期。在这种情况下，它会获取`th`表格中的所有单元格，并`.index(..)`与选择器一起使用来寻找所需的日期。这给出了您正在寻找的日期的列索引，从那里开始一切都很简单。

```
var arr=[ 
 {"date":"2013-03-15","id":"4","time_booked":"0900"},
 {"date":"2013-03-15","id":"1","time_booked":"0910"},
 {"date":"2013-03-17","id":"5","time_booked":"0930"}
];
$.each(arr,function(){
    var cell = GetCellByDateAndTime(this.date, this.time_booked);
    $(cell).text(this.id);
});

function GetCellByDateAndTime(date, time) {
    var colIndex = $("#BookingsTable th").index($("[data-day='" + date + "']"));
    var row = $("#BookingsTable tr[data-time='" + time + "']")
    var cell = $(row).children($("td"))[colIndex];
    return cell;
} 
```

还有一个[小提琴](http://jsfiddle.net/qYR3T/)。

# google-app-engine - 如何从我要插入 Google Drive 的网站上传的文件中确定流大小

> ID：15234028
> 
> 赞同：0
> 
> 时间：2013-03-05T21:01:11.210
> 
> 标签：google-app-engine, gwt, google-drive-api, apache-commons-fileupload

我正在尝试在启用*ProgressListener*和*ChunkSize*的情况下将文件上传到 Google Drive （因此禁用了*DirectUploadEnabled*）。这样我有一个更可靠的上传和向用户指示进度的可能性。

我使用 FormPanel 和 FileUploadField 将文件从 GWT 网站传输到 GAE，后者在 submit() 上将文件发布到 GAE。在 GAE 上，我收到带有 UploadServlet 的文件，它使用*org.apache.commons.fileupload*将文档作为流接收。我不想收到有关 GAE 的完整文件，因为这些文件太大了。因此，我使用来自传入请求的接收流开始上传（插入）到 Google Drive。

现在有一个问题；对于插入，我需要知道流的大小；

```
int lContentLength = getRequest().getContentLength();
FileItemStream lFileItemStream = getFileItemStream();
InputStream lInputStream = lFileItemStream.openStream();
BufferedInputStream lBufferedInputStream = new BufferedInputStream(lInputStream);
InputStreamContent lInputStreamContent = new InputStreamContent(pContentType, lBufferedInputStream);
lInputStreamContent.setLength(lContentLength); 
```

我的第一个猜测是来自传入 Servlet 请求的*ContentLengt 。*但这是不正确的，因为这涉及完整的请求（其中还包含用作参数的其他字段）。如果没有 Drive 选项*DirectUploadEnabled*，我需要上传文档中的确切流大小，否则上传停止在最后......

我如何把握这个文件的大小？Google 的示例很愚蠢，因为它使用了本地文件；

[https://code.google.com/p/google-api-java-client/wiki/MediaUpload](https://code.google.com/p/google-api-java-client/wiki/MediaUpload)

是的，从本地文件很容易获得文件大小*(mediaFile.length())*。但是从一个网站......几个网站指定不可能在提交（）之前从网站获取文件大小，而且在不加载完整文件的情况下似乎也无法确定 GAE 上的流大小......

我如何确定这个流大小？这个问题还有其他解决方案吗？

# javascript - 如何让javascript“呼吸”

> ID：15234034
> 
> 赞同：5
> 
> 时间：2013-03-05T21:01:37.003
> 
> 标签：javascript, jquery, freeze

我有一些 javascript/jquery 代码（用于内部网站），在大表上进行大量客户端处理。它运行有点慢，但没关系。

问题是它在运行它需要执行的循环时冻结了浏览器。这有两个不良影响：

1.  处理微调器（一个动画 gif，但我也尝试了 spin.js 并且有同样的问题）冻结。
2.  如果表中有足够的行，则循环需要很长时间并且浏览器会报告一个无响应的脚本

有没有一种方法可以在代码中添加某种“呼吸”语句，这样每（比如）100 次迭代，它就会暂停以让微调器旋转并且浏览器知道脚本仍在处理它？类似（伪代码）：

```
for (i=0;i<20000;i++)
{
    fnProcessRow();
    if (i % 100 == 0) breath();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:06:43.133

分解 javascript 的一种方法是将处理分成块并使用 setTimeout() 执行下一个“块”

如果您需要一些代码来向您展示我的意思，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:07:08.920

没有设置方法来执行此操作，因为它非常具体地取决于您的代码。像这样的东西会起作用：

```
fnProcessRows(0, 10000);

function fnProcessRows(start, end) {
    /* do row processing */

    if (end < totalRows) {
        setTimeout(function () {
            fnProcessRows(start + 10000, end + 10000);
        }, 1000);
    }
}); 
```

这将处理 10000 行，中间有 1 秒的中断。这可能会产生奇怪的副作用，例如显示“已处理”行和“未处理”行，这可能是不可取的。如果不是，那么这应该是一个非常简单的解决方案来提供帮助。

*如果仍然*没有响应，您当然可以将 10000 减少到其他值；它应该只在很短的时间内没有响应，用户很难注意到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:12:14.913

看到[这个问题](https://stackoverflow.com/a/15123623/674326)。

如果您不想使用 setTimeout/setInterval 路线，请尝试添加：

```
if (i % 100) { $("selector for your animated image").width(); } 
```

在某些（大多数？）浏览器上会强制它重新布局和渲染。

# javascript - 对话框关闭按钮缺少样式？

> ID：15234036
> 
> 赞同：1
> 
> 时间：2013-03-05T21:01:42.773
> 
> 标签：javascript, jquery, jquery-ui

我正在使用 JQuery UI 对话框：

```
$("#filter").dialog({
    autoOpen: false,
    resizable: false,
    draggable:false
}); 
```

他们示例中的关闭按钮具有：

```
<button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close" role="button" aria-disabled="false" title="close">
<span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span>
<span class="ui-button-text">close</span></button> 
```

我的有：

```
<button class="ui-dialog-titlebar-close"></button> 
```

为什么我的按钮没有这些样式。我已经包含了主题，并且我看到了其他所有内容的主题......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T13:25:08.813

这个问题可能是由使用 jQuery UI js 和 Twitter Bootsrap js 引起的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:08:22.033

`.ui-dialog-titlebar-close`仅当包装在具有 class 的元素内时，样式才会适用`.ui-dialog`。

我建议您只查看您喜欢的样式并为按钮创建一个新的样式声明。

# iphone - 使用 NSISOLatin1StringEncoding 转换语言字符 [ios]

> ID：15234037
> 
> 赞同：0
> 
> 时间：2013-03-05T21:01:45.493
> 
> 标签：iphone, ios, objective-c, nsstring

我正在提取一些语言句子（使用不同的语言）并在 TableView 中显示它们（每行最多 5 行），当用户点击任何行时，我将用户导航到新屏幕并在那里显示全文。

我遇到的问题是，将字符转换为在设备上正确可见需要太多时间。

我编写了以下代码来转换每一行的 json 文本：

```
NSString *msgDesc = [myContentsArray objectAtIndex:indexPath.row];

char const *cStr = [msgDesc cStringUsingEncoding:NSISOLatin1StringEncoding];

msgDesc = [NSString stringWithCString: cStr encoding:NSUTF8StringEncoding]; 
```

谢谢您的帮助。

问候，

雷诺琼斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:12:05.700

由于转换花费的时间太长，您应该将其从您的`tableView:cellForRowAtIndexPath:`方法中移出到从其数据源中提取数据的代码中，在那里进行转换，并将其存储以供将来使用。

添加`NSMutableArray *myContentsArrayConverted`到您的类，然后将所有内容转换为它，并在`tableView:cellForRowAtIndexPath:`每次必须显示字符串时使用而不是执行转换：

```
for (int i = 0 ; i != myContentsArray.count ; i++) {
    NSString *msgDesc = [myContentsArray objectAtIndex:i];
    char const *cStr = [msgDesc cStringUsingEncoding:NSISOLatin1StringEncoding];
    [myContentsArrayConverted addObject:[NSString stringWithCString: cStr encoding:NSUTF8StringEncoding]];
} 
```

现在您可以用更快的代码替换慢代码

```
NSString *msgDesc = [myContentsArrayConverted objectAtIndex:indexPath.row]; 
```

# codenameone - 如何加载在 Codenameone UI 设计器中定义的对话框

> ID：15234041
> 
> 赞同：0
> 
> 时间：2013-03-05T21:01:58.360
> 
> 标签：codenameone

我已经使用 UI 设计器定义了一个对话框。我现在如何在代码中显示它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T08:41:27.930

就像您可以通过命令导航到 GUI 构建器中的对话框或通过`showForm("dialogName", null);`

你也可以使用

```
Dialog dlg = (Dialog)createContainer(fetchResourceFile(), "dialogName"); 
```

然后你可以只使用`show()`方法，显示打包的、无模块的或任何其他实例级别（非静态）的显示方法。

# kendo-ui - Kendo UI 菜单 Action 和 Controller 在 DiscountASP.NET 等 ISP 提供商上产生错误。必须使用网址

> ID：15234048
> 
> 赞同：1
> 
> 时间：2013-03-05T21:02:16.493
> 
> 标签：kendo-ui

我为 MVC Web 应用程序项目创建了一个 Kendo UI，它在本地主机上运行 find。在将其作为 Web 应用程序部署到 DiscountASP.NET 或 WinHost 上我的域的子目录时，我收到一个错误：

> 此处不允许使用相对虚拟路径“~4/”。

```
Line 21:            </div>
Line 22: 
Line 23:            @(Html.Kendo().Menu()
Line 24:                    .Name("menu")
Line 25:                    .Items(menu => { 
```

不知何故，我能够在工作中通过 Visual Studio 2012 的 FTP 部署完成正确的部署。但是在家里它仍然不起作用。我正在使用 Visual Studio 2012 和 Web Deploy，并正确说明了 Web 应用程序的地址。我在 IIS 8 中搜索了某种设置，但找不到。

我想这两个互联网主机提供商都有“虚拟”网站，尽管我不熟悉它是如何工作的。我认为这可能是相关的。

目前解决上述问题的方法是更改​​默认的 Telerik 提供的代码：

```
 @(Html.Kendo().Menu()
                .Name("menu")
                .Items(menu => {
                    menu.Add().Text("Home").Action("Index", "Home");
                    menu.Add().Text("About").Action("About", "Home");
                })) 
```

对此：

```
 @(Html.Kendo().Menu()
                .Name("menu")
                .Items(menu => {
                    menu.Add().Text("Home").Url("~/Home/Index");
                    menu.Add().Text("About").Url("~/Home/About");
                })) 
```

如果有一种方法可以让我回到在 MVC 包装器中使用 Telerik 的 Kendo UI 菜单的 Controller 和 Action 方法，我将不胜感激。我已在主机提供商上提交了一份帮助票，以查看我在部署阶段可能会做什么，但否则我不确定下一步该做什么。

编辑：互联网主机提供商表示我需要联系供应商（Telerik Kendo UI）以检查包装器导致此行为的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-28T11:01:07.620

这个怎么样：

```
 menu.Add().Url(Url.Action("About", "Home")).Text("About"); 
```

# javascript - 爬取受密码保护的弹出式站点

> ID：15234049
> 
> 赞同：0
> 
> 时间：2013-03-05T21:02:22.840
> 
> 标签：javascript, perl, web-crawler, bots

我正在尝试抓取一个网站，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:08:20.190

弹出窗口可能是标准的 HTTP 身份验证。如果是这种情况，您可以像这样发送凭据：

```
http://user:pass@example.com 
```

# sublimetext2 - 更改 Sublime Text 2 中制表键的行为

> ID：15234068
> 
> 赞同：2
> 
> 时间：2013-03-05T21:04:00.887
> 
> 标签：sublimetext2, key-bindings

我已经使用 Sublime Text 2 几个多星期了，就在不久前，我的键绑定发生了变化，我无法像我想要的那样恢复它们，所以我卸载/重新安装了 Sublime Text，所以一切都会是干净，我还删除了我的 AppData 文件夹。我经常使用 Emmet 包，所以我也重新安装了它，它使用 tab 键可以很好地完成 HTML 文件中的所需操作，但是由于某种原因，当我在 CSS 文件中时，我点击了 tab 并得到了不希望的结果. 例如，我输入以下内容：

```
 .header 
```

我点击制表符缩进，它变为

```
 :; 
```

我需要改变什么来防止这种情况发生？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:20:20.580

[向emmet-sublime](https://github.com/sergeche/emmet-sublime)提交了一个问题：[https](https://github.com/sergeche/emmet-sublime/issues/220) ://github.com/sergeche/emmet-sublime/issues/220 。

在您的*User/Emmet.sublime-settings*文件中添加此功能以完全禁用该功能：

```
{
  "disable_tab_abbreviations_for_scopes": "source.css"
} 
```

显然，他们正在努力修复该功能。

# javascript - 使用谷歌应用脚 本检查现有用户

> ID：15234069
> 
> 赞同：1
> 
> 时间：2013-03-05T21:04:01.260
> 
> 标签：javascript, google-apps-script, google-apps-for-education

我正在电子表格上创建一个谷歌应用程序脚本，该脚本在从谷歌表单支持的注册表单提交的域上创建用户，使用这种方法创建用户很容易，`UserManager.createUser(username, firstname, lastname,password);`但我面临的问题是如何检查用户是否正在插入电子表格已存在。[我专门在https://developers.google.com/apps-script/](https://developers.google.com/apps-script/)上检查了互联网，但没有发现任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T14:50:59.910

使用 try catch 块怎么样？简单但应该满足您的需求。

```
try{
    // Get an existing user
    var user = UserManager.getUser("delete.me");
}catch(e){
    // If user does not exist // i.e. error // create the user
    var newUser = UserManager.createUser('delete.me', 'Delete', 'Me', 'testing123');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:20:42.533

Apps Script 没有直接的 API，但您可以使用 OAuth 2 和 UrlFetchApp使用[用户配置。](https://developers.google.com/google-apps/provisioning/)您可以看到与[Audit API的一些](https://developers.google.com/google-apps/admin-audit/)[示例集成](https://stackoverflow.com/a/15124712/662551)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:30:10.430

这是获取我域中所有用户的脚本的 2 个版本，第二个版本使用 Arun 提到的 API 并返回可以在记录器中查看的 XML 文档（对于此测试版本），您可以以合适的方式对其进行解析。

另一个（实际上是第一个）使用`UserManager`服务并在电子表格中显示结果。从那里（使用数组）可以很容易地检查用户是否已经拥有一个帐户。

这是代码：

```
function findUsers(s) {     
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()
  sheet.getDataRange().clear()
  var users = UserManager.getAllUsers();
  var r = new Array();
//
  for( var i = 0 ; i < users.length ; i++ ){
    var Umail = users[i].getEmail(); 
    var UnomF = users[i].getFamilyName()
    var UnomP = users[i].getGivenName()

      if(users[i].getAgreedToTerms()){var Udejaconnect = 'oui'}else{var Udejaconnect = 'jamais'}
//
     r.push([UnomF,UnomP,Umail,Udejaconnect]);
  }   
  r.sort(function(x,y){
  var xp = x[0].toLowerCase();
  var yp = y[0].toLowerCase();
  Logger.log(xp+'   '+yp)
  return xp == yp ? 0 : xp < yp ? -1 : 1;//  sort on name ascending
}
)
  var header = ['Nom de famille','Prénom','Email','Déjà Connecté?']
    sheet.getRange(1,1,1,r[0].length).setValues([header]).setFontWeight('bold')
    .setBackground('silver').setBorder(true,true,true,true,true,true);
    sheet.getRange(2,1,r.length,r[0].length).setValues(r);
}

// new version provisioning API
//
function getUserData() {
  var base = "https://apps-apis.google.com/a/feeds/";
  var fetchArgs = googleOAuth_("provisioning", base);
  var url = base + "domain.name" + "/user/2.0"; 

  var result = UrlFetchApp.fetch(url,fetchArgs).getContentText()
  var xml = Xml.parse(result);
  Logger.log(result)
  var users = xml.feed.entry;

  var r = [['Login', 'Nom complet', "Droits d'admin.", 'Quota Emails', 'Compte suspendu']];
  for( var i in users ) 
            r.push([users[i].login.userName,
            users[i].name.givenName+' '+users[i].name.familyName,
            users[i].login.admin,
            users[i].quota.limit,
            users[i].login.suspended]);
  var s = SpreadsheetApp.getActiveSheet();
  s.clearContents();
  s.getRange(1, 1, r.length, r[0].length).setValues(r);

}

function googleOAuth_(name,scope) {
  var oAuthConfig = UrlFetchApp.addOAuthService(name);
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
  oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setConsumerKey("anonymous");
  oAuthConfig.setConsumerSecret("anonymous");
  return {oAuthServiceName:name, oAuthUseToken:"always"};
} 
```

# html - 仅在 div 中添加 x 方向的内容

> ID：15234070
> 
> 赞同：1
> 
> 时间：2013-03-05T21:04:06.627
> 
> 标签：html, css

如何仅在 x 方向添加内容？

在`<div>`标签中，我放了 5 到 6 张图片。大于 div 的总宽度。因此，如果到达 div 宽度的末尾，它会回到新行。

我放了

```
img
{
    float:left;
} 
```

但没有运气。

div的`oveflow-x:scroll;`

但没有运气。

我希望图像水平添加而不是垂直添加。我想在 x 方向滚动条来查看所有图像。

我在哪里失踪？

HTML：

```
<div id="scrollar">
<img src="1.jpg">
<img src="2.jpg">
<img src="3.jpg">
<img src="4.jpg">
<img src="5.jpg">
<img src="6.jpg">
<img src="7.jpg">
<img src="8.jpg">
</div> 
```

宽度包含 5 个图像。之后它转到新行。我只想要该行中的所有图像。通过在 x 方向滚动应该可以看到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:34:46.790

无需指定容器的宽度或添加额外的标记，只需告诉它不要换行。

[http://jsfiddle.net/BHD5Y/](http://jsfiddle.net/BHD5Y/)

```
div#scrollar {
    white-space: nowrap;
    overflow-x: scroll;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:16:31.847

试试这个：

HTML：

```
<div class="wrapper">
    <div class="content">
        <img src="img/01.jpg" alt="" width="675">
        <img src="img/02.jpg" alt="" width="675">
        <img src="img/03.jpg" alt="" width="675">
        <img src="img/04.jpg" alt="" width="675">
        <img src="img/05.jpg" alt="" width="675">
    </div>
</div> 
```

和 CSS：

```
.wrapper{
   width:100%;
   height:100%;
   overflow:auto;
}

.content{
    height:450px;
    width: 3375px;
    position:absolute;
    left:0;
    top:0;
}

.portfolio img{
   margin:0 12px;
   float:left;
} 
```

# soundcloud - 如何让 SoundCloud iframe API 在 iPhone 上运行？

> ID：15234076
> 
> 赞同：2
> 
> 时间：2013-03-05T21:04:24.420
> 
> 标签：soundcloud

我正在尝试让 SoundCloud iframe API 在 iPhone 上启动并运行，但我遇到了让它播放的问题。我准备了一个 JSFiddle 来证明这一点：http: [//jsfiddle.net/aj3Pw/1/](http://jsfiddle.net/aj3Pw/1/)。我试图完成的是简单地添加一个播放按钮来触发小部件开始播放。在浏览器中加载示例，您会注意到一切正常（播放按钮将开始播放小部件）。但是，在 iPhone 中加载相同的示例时，小部件将无法播放。“播放”按钮将变为“暂停”按钮，但音频永远不会开始播放。此外，“就绪”事件似乎也从未在 iPhone 上触发。关于为什么这不适用于 iPhone 的任何想法？

来自上述 JSFiddle 的代码：

```
var iframe = document.querySelector('#player');
var sc = SC.Widget(iframe);

sc.bind(SC.Widget.Events.READY, function() {
    var d = document.createTextNode('Ready');
    document.querySelector('body').appendChild(d);
});

document.querySelector('button').addEventListener('click', function() {
    sc.play();
}); 
```

标记：

```
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F7659975" id="player"></iframe>

<button id="play">Play</button> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T08:59:56.990

TL;DR：iOS 6 应该通过用户操作来限制播放调用，iOS5 及更低版本可能无法修复。

完整答案在这里：[https ://stackoverflow.com/a/13569799/236135](https://stackoverflow.com/a/13569799/236135)

# ruby - Ruby 后向断言 (1.9/2.0) 中是否存在错误？

> ID：15234078
> 
> 赞同：34
> 
> 时间：2013-03-05T21:04:37.067
> 
> 标签：ruby, regex, lookbehind

为什么正则表达式不`(?<=fo).*`匹配`foo`（而匹配`(?<=f).*`）？

```
"foo" =~ /(?<=f).*/m          => 1
"foo" =~ /(?<=fo).*/m         => nil 
```

这似乎只发生在单行模式打开（点匹配换行符）；没有它，一切正常：

```
"foo" =~ /(?<=f).*/           => 1
"foo" =~ /(?<=fo).*/          => 2 
```

在 Ruby 1.9.3 和 2.0.0 上测试。

[在 Rubular 上查看](http://rubular.com/r/6VryUKUneW)

**编辑：**更多观察：

添加行尾锚不会改变任何东西：

```
"foo" =~ /(?<=fo).*$/m        => nil 
```

但与惰性量词一起，它“起作用”：

```
"foo" =~ /(?<=fo).*?$/m       => 2 
```

**编辑：**还有更多观察：

`.+`与它的等价物一样工作`{1,}`，*但仅在 Ruby 1.9 中*（在这种情况下，这似乎是两者之间唯一的行为差异）：

```
"foo" =~ /(?<=fo).+/m         => 2
"foo" =~ /(?<=fo).{1,}/       => 2 
```

在 Ruby 2.0 中：

```
"foo" =~ /(?<=fo).+/m         => nil
"foo" =~ /(?<=fo).{1,}/m      => nil 
```

`.{0,}`被破坏（在 1.9 和 2.0 中）：

```
"foo" =~ /(?<=fo).{0,}/m      => nil 
```

但`{n,m}`适用于两者：

```
"foo" =~ /(?<=fo).{0,1}/m     => 2
"foo" =~ /(?<=fo).{0,2}/m     => 2
"foo" =~ /(?<=fo).{0,999}/m   => 2
"foo" =~ /(?<=fo).{1,999}/m   => 2 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T19:07:53.830

这已被正式归类[为错误并随后修复](http://bugs.ruby-lang.org/issues/8023)`\Z`，以及与多行字符串中的锚点有关的另一个问题。

# objective-c - 如何根据其描述构造 NSData？

> ID：15234079
> 
> 赞同：2
> 
> 时间：2013-03-05T21:04:40.287
> 
> 标签：objective-c, cocoa-touch, nsdata

我得到了一个`NSData`通孔的字符串表示形式`NSLog`，我想`NSData`再次构造原始形式以进行测试，这样做的最佳方法是什么？

例如

```
<fe010200 00000000 00011012> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:33:55.427

这里有几行对数字进行简单扫描并将它们的值附加到 NSMutableData 对象

```
 NSString *dataIn = @"<fe010200 00000000 00011012>";

    const char *ptr = [dataIn cStringUsingEncoding:NSUTF8StringEncoding];

    NSMutableData *data = [NSMutableData data];

    while (*ptr) {
        unsigned char c1 = *ptr;
        ptr++;
        if (isalpha(c1))
            c1 = (10 + c1 - 'a')<<4;
        else if (isnumber(c1))
            c1 = (c1 - '0')<<4;
        else
            continue;
        if (!*ptr)
            break; // Shouldn't occure -- bad input
        unsigned char c2 = *ptr;
        ptr++;
        if (isalpha(c2))
            c2 = 10 + c2 - 'a';
        else if (isnumber(c2))
            c2 = c2 - '0';
        c1 = c1 | c2;
        [data appendBytes:&c1 length:1];
    }

    NSLog(@"%@", data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:02:20.630

我猜是这样的：

```
NSArray *wordStrings =
    [string componentsSeparatedByCharactersInSet:
        [[NSCharacterSet alphanumericCharacterSet] invertedSet]];

NSMutableData *collectedData = [NSMutableData dataWithCapacity:wordStrings.count * sizeof(unsigned)];

for(NSString *word in wordStrings)
{
    NSScanner *scanner = [NSScanner scannerWithString:word];
    unsigned newInt;
    [scanner scanHexInt:&newInt];
    [collectedData appendBytes:&newInt length:sizeof(unsigned)];
} 
```

它在使用 NSString 强制间距之后为每个单词创建一个扫描器，而在扫描器中执行所有操作会更有效，但它只是用于调试，对吧？通过这种方式，您可以获得 wordStrings 中点，以确保您对分解字符串的假设是准确的。

# drupal - 在 Drupal 6 和 Cron 上使用调度程序模块

> ID：15234080
> 
> 赞同：1
> 
> 时间：2013-03-05T21:04:40.440
> 
> 标签：drupal, drupal-6, cron, scheduler

我想使用 Drupal 6 上的调度程序模块，它将一些字段添加到节点编辑页面以在特定日期和时间发布或取消发布节点。问题是调度程序依赖于 cron 运行。我感到困惑的部分是，除非 cron 一直在运行，否则你怎么可能安排节点在特定时间发布或取消发布？换句话说，如果我创建了一个内容并安排它在两天后的早上 8 点发布，除非 cron 在早上 8 点运行，否则节点不会正确发布？例如，假设我们每天只运行两次 cron，比如在早上 2 点和下午 2 点（我只是在排除任意时间），我们的调度程序设置为在早上 8 点发布我们的文章，它在技术上不会 直到下午 2 点第二个 cron 活动运行正确时才发布？我们显然不希望 cron 一直运行，因为它可能对站点不利。就这些东西的工作原理而言，我是否遗漏了一些东西？或者是否有人有更好的解决方案来允许节点在设定的日期和时间发布和取消发布？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T07:00:58.187

我希望您有[计划程序](http://drupal.org/project/scheduler)模块来完成您必须完成的任务。根据此模块的文档，它仅在您的 cron 在您计划的时间旁边运行时发布/取消发布该节点。这是那边写的——

> 计划的自动发布和取消发布功能通过 cron 系统发生，因此实际的、现实世界的发布时间将与您的 cron 系统运行的时间保持一致。例如，如果您输入下午 3:45 的发布时间，但 cron 每小时只运行一次，那么真正的发布时间将是下午 4:00 而不是下午 3:45。

# jquery - jQuery Mobile 在页面更改期间加载内容

> ID：15234083
> 
> 赞同：0
> 
> 时间：2013-03-05T21:04:45.633
> 
> 标签：jquery, cordova, jquery-mobile

我的代码中有以下情况。在显示搜索结果的页面上，每个结果都有以下代码：

```
<a href='#pageSearchDetail'>Result</a> 
```

单击页面#pageSearchDetail 我使用以下事件在页面显示之前执行某些操作：

```
$(document).delegate('#pageSearchDetail', 'pagebeforeshow', function() 
{    
    AjaxSearchDetail();        
}); 
```

在 AjaxSearchDetail 我从网络服务器加载一些数据并将这些数据插入到 DOM 中。我的问题是现在页面已经显示，尽管 ajax 请求还没有完成。因此，在 ajax 加载完成之前，页面仅显示部分且“空”。

ajax请求代码：

```
function AjaxSearchDetail()
{               
    var data = "&data=test";

    $.ajax({
        data: data,        
        success: Success,
        error: Error
    });
} 
```

另一个有趣的事情是加载小部件在页面加载过程中没有显示。我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:18:08.647

我用以下代码解决了这个问题：

```
$(document).ajaxStart(function() {    
    $.mobile.loading('show');
});

$(document).ajaxStop(function() {
    $.mobile.loading('hide');
}); 
```

现在我使用：

```
$(document).on("pagechange", function(e, data) 
{
    var pageID = data.toPage.attr("id");

    switch (pageID)
    {

    }
} 
```

# bash - 脚本的替代解释器

> ID：15234086
> 
> 赞同：1
> 
> 时间：2013-03-05T21:04:55.643
> 
> 标签：bash, gnuplot, hashbang

我有一个在两台计算机上运行的脚本。代码的第一行如下所示：

```
#!/usr/bin/gnuplot -p 
```

在第二台计算机上，我想使用存储在`$HOME/bin/gnuplot`.

`$HOME/bin`包含在第二台计算机的`$PATH`变量中，因此我尝试使用对 GNUplot 的通用调用来启动脚本：

```
#!gnuplot -p 
```

但这不起作用，因为脚本随后搜索了`./gnuplot`.

有没有办法使两台计算机的标题行相同？我希望解决方案以某种方式包含在这一行中，而不需要脚本来区分计算机或让我告诉它它在哪台计算机上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:25:16.960

`#!/usr/bin/env gnuplot`是表达解释器的一种更便携的方式，如[here](https://en.wikipedia.org/wiki/Shebang_%28Unix%29#Portability)和[here](https://stackoverflow.com/a/15234117/752843)所述。

但是，这会带来一个您可能没有预料到的问题。

```
#!/usr/bin/gnuplot -p 
```

制作一个持久的 GNUplot 窗口，但正在运行

```
#!/usr/bin/env gnuplot -p 
```

这似乎是明显的便携式替代方案行不通。

[这里](http://mail-index.netbsd.org/netbsd-users/2008/11/10/msg002390.html)讨论了造成这种情况的一些原因，但似乎并没有真正的解决方法：争论和`/usr/bin/env`不相处。

在`-p`标志的特殊情况下，最好使用

```
#!/usr/bin/env gnuplot 
```

然后包括该行

```
set term x11 persist 
```

在你的 GNUplot 脚本中，它会做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:06:53.500

`#!/usr/bin/env gnuplot`使其更[便携](http://en.wikipedia.org/wiki/Shebang_%28Unix%29#Portability)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:24:12.407

显而易见的解决方案是

```
#!/usr/bin/env gnuplot 
```

有关此方法的优缺点的一些讨论，请参阅[此问题](https://unix.stackexchange.com/q/29608/10454)和[我的回答。](https://unix.stackexchange.com/a/29620/10454)

但是在您的情况下，您需要将`-p`参数传递给`gnuplot`-- 并且该`#!`行不处理该语法。您可以使用

```
#!/usr/bin/gnuplot -p 
```

但如果你尝试：

```
#!/usr/bin/env gnuplot -p 
```

它可能会尝试执行一些名为`gnuplot -p`的东西，这当然不存在（它`"gnuplot -p"`作为单个参数传递给`/usr/bin/env`）。

我使用的一个解决方案是编写一个安装脚本来修改`#!`每个系统的行。弄清楚如何做到这一点留作练习。

如果您的主目录在两台计算机上具有相同的完整路径名，您可以这样做：

```
#!/home/yourname/bin/gnuplot -p 
```

在`gnuplot`居住的计算机上`$HOME/bin`，这正是您想要的。另一方面，在您要使用的地方`/usr/bin/gnuplot`，创建`$HOME/bin/gnuplot`一个符号链接到`/usr/bin/gnuplot`：

```
ln -s /usr/bin/gnuplot ~/bin/gnuplot 
```

如果您不想`$HOME/bin`在两台机器上弄乱您的目录，或者如果您`$HOME`的完整路径名不同，请选择其他目录。例如，您可以将它安装在`/tmp/yourname/bin`两台机器上：

```
mkdir -p /tmp/yourname/bin
ln -s /usr/bin/gnuplot /tmp/yourname/bin/gnuplot # on one machine, OR
ln -s ~/bin/gnuplot /tmp/yourname/bin/gnuplot    # on the other 
```

并使用：

```
#!/tmp/yourname/bin/gnuplot -p 
```

# php - 在 foreach 循环中存储变量

> ID：15234087
> 
> 赞同：1
> 
> 时间：2013-03-05T21:04:57.047
> 
> 标签：php, mysql, foreach

嗨，我目前有一些 PHP 代码，它们会将先前从上一页的复选框中选择的时间段放入我的数据库中，但我不确定在执行此操作之前如何将每个时间段存储在一个变量中，以便我可以使用它们来列出预约空档在我的电子邮件功能中

在我尝试将'$key'插入我的电子邮件功能时，它只保留最后选择的值......

我在第一页上的代码如下：

```
<?php
for ($i=0;$i<=31;$i++){ while ($myrow = mysql_fetch_row($result)) {
printf("<tr><td>%s</td><td>%s</td></tr>\n",
$myrow[0]);
}

echo "<td><input type='checkbox' name='$displayTime2' onclick='KeepCount()'></td>";
echo "<td>$pagetime</td>"; ?> 
```

我目前的代码如下：

```
<?php
foreach ($_POST as $key=>$value)
{
    echo $key; // show times selected on previous page
    mysql_query("INSERT INTO appointment(Patient_ID, Appointment_Date, Appointment_Time
                , Practice_ID, Appointment_ID)
                VALUES('$patid','$insertdate','$key','$pracid','$apptype')");   
}
?> 
```

我的邮件功能如下：

```
 $to = "$pemail";
   $subject = "Talking Teeth Check Up Booking Confrmation";
   $message = "Hello! This e-mail is to confirm your ".$appname." appointment has been
   booked for ".$insertdate. " at ".$key." at the ".$pracname." practice";
   $from = "talkingteethdentists@talkingteeth.co.uk";
   $headers = "From:" . $from;
   mail($to,$subject,$message,$headers);
   echo "Mail Sent."; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:32:25.100

虽然上面的评论是对的，但让我来帮助你。

首先，您需要确定选择了哪些复选框，因此请执行一些 IF 语句来确定`foreach`循环内的每个复选框。

尝试这样的事情：

```
<?php
$savedData = array();
foreach ($_POST as $key=>$value){
    $key = mysql_real_escape_string($key);
    echo($key. "<br>"); // show times selected on previous page
    mysql_query("INSERT INTO appointment(Patient_ID, Appointment_Date, Appointment_Time
                , Practice_ID, Appointment_ID)
                VALUES('$patid','$insertdate','$key','$pracid','$apptype')");   

    //To save the variables for later:
    $savedData[] = $key;
}
?> 
```

现在您可以使用 $savedData[0] .... $savedData[1] ... $savedData[2] .... 等访问我们所有的 KEY。

因此，您的电子邮件功能可能如下所示：

```
foreach($savedData as $time){
   $to = "$pemail";
   $subject = "Talking Teeth Check Up Booking Confirmation"; //mis-spelled confirmation =)
   $message = "Hello! This e-mail is to confirm your ".$appname." appointment has been
   booked for ".$insertdate. " at ".$time." at the ".$pracname." practice";
   $from = "talkingteethdentists@talkingteeth.co.uk";
   $headers = "From:" . $from;
   mail($to,$subject,$message,$headers);
   echo "Mail Sent.";
} 
```

因此，这将为里面的每件作品发送一封电子邮件`$savedData`——如果这确实是意图的话。

# c# - 如何从 KeyEventArgs 而不是 KeyPressEventArgs 获取字符？

> ID：15234100
> 
> 赞同：0
> 
> 时间：2013-03-05T21:05:50.677
> 
> 标签：c#, keypress, keydown

我知道这已被问了数百次，但我一直无法找到对我有帮助的解决方案。我正在使用条形码扫描仪，我希望能够获取仅使用 keydown 事件键入的键。出于某种原因，我不能同时使用 keydown 和 keypress 事件（我的 keypress 事件不会运行）。

我需要能够获取字符，包括连字符、大写字母和点，还需要检测回车键。

这些是我的听众：

```
form.KeyDown += new KeyEventHandler(Input_KeyDown);
form.KeyPress += new KeyPressEventHandler(Input_KeyPress); 
```

这些是我的方法：

```
private void TimedOut(object sender, EventArgs e)
{
   _barcode = "";
}

private void Input_KeyDown(object sender, KeyEventArgs e)
{
   _timer.Stop();
   _timer.Start();

   if (e.KeyData == Keys.Enter)
   {
      if (!_barcode.Equals(""))
  {
     this.BarcodeScanned(_barcode, new EventArgs());
  }
   }

   else
   {

   }
}

private void Input_KeyPress(object sender, KeyPressEventArgs e)
{
   _timer.Stop();
   _timer.Start();
   _barcode += e.KeyChar;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:54:19.400

您上面的代码工作......在一个空白表格上。但是，有几件事会干扰关键事件，尤其是当页面上有其他控件时。确保

*   该`AcceptButton`属性未在表单上设置（这将捕获 Enter 键）
*   `TabStop`设置为的表单上没有控件`true`（可能不可行，但试一试）
*   输入时表单具有焦点（不太可能给出描述，但无论如何都要检查）
*   键入时，重点不在表单中的任何控件上，例如，`TextBox`
*   没有其他控件正在尝试处理`KeyPress`or`KeyDown`事件，并且没有其他自定义事件在您的代码中的其他任何地方配置/设置

我注意到的一件事是您正在注册这样的事件；

```
form.KeyDown += new KeyEventHandler(Input_KeyDown); 
```

这意味着您正在从另一个地方实例化此表单并试图让它将其关键事件发送到调用代码。您确定`form`实例被持久化/保存到私有类级别变量或类似的变量吗？

# c# - 在此字符串中的单词之间添加一个空格

> ID：15234110
> 
> 赞同：11
> 
> 时间：2013-03-05T21:06:21.817
> 
> 标签：c#, string-formatting

尝试设置一个在属性中有空格但非常困难的枚举，因此认为它们可能是一种使用字符串格式或其他方式破解它的简单方法，因为它们只是我需要的一个具有空格的枚举，我确切地知道它是什么. 对此字符串添加空格的任何帮助

```
public class Address
{
...blah...more class datatypes here...

public AddressType Type { get; set; }  //AddressType is an enum

...blah....
}

 if (Address.Type.ToString() == "UnitedStates")
        {
           **Add space between United and States**
        } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-05T21:15:47.977

如果您的枚举条目是驼峰式，您可以在大写字母之前插入一个空格

```
string res = Regex.Replace("UnitedStates", "[A-Z]", " $0").Trim(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T21:11:11.640

`ToString`您可以使用扩展方法在枚举上创建自己的方法。

```
public static class AddressTypeExtensions
{
     public static string ToMyString(this AddressType addressType)
     {
          if (addressType == AddressType.UnitedStates)
              return "United States";

          return addressType.ToString();
     }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T21:24:44.510

这是我昨天（2009 年）发现的一个巧妙的技巧。我想知道为什么我自己从来没有想过。在 .net 框架中，无法控制 .ToString() 进行枚举。为了解决这个问题，可以创建一个扩展方法以及一个属性来装饰枚举的不同值。然后我们可以这样写：

```
public enum TestEnum
{
    [EnumString("Value One")]
    Value1,

    [EnumString("Value Two")]
    Value2,

    [EnumString("Value Three")]
    Value3
}

EnumTest test = EnumTest.Value1;
Console.Write(test.ToStringEx());
The code to accomplish this is pretty simple:

[AttributeUsage(AttributeTargets.Field)]
public class EnumStringAttribute : Attribute
{
    private string enumString;

    public EnumStringAttribute(string EnumString)
    {
        enumString = EnumString;
    }

    public override string ToString()
    {
        return enumString;
    }
}

public static class ExtensionMethods
{
    public static string ToStringEx(this Enum enumeration)
    {
        Type type = enumeration.GetType();
        FieldInfo field = type.GetField(enumeration.ToString());
        var enumString =
            (from attribute in field.GetCustomAttributes(true)
             where attribute is EnumStringAttribute
             select attribute).FirstOrDefault();

        if (enumString != null)
            return enumString.ToString();

        // otherwise...
        return enumeration.ToString();
    }
}

[TestMethod()]
public void ToStringTest()
{
    Assert.AreEqual("Value One", TestEnum.Value1.ToStringEx());
    Assert.AreEqual("Value Two", TestEnum.Value2.ToStringEx());
    Assert.AreEqual("Value Three", TestEnum.Value3.ToStringEx());
} 
```

功劳归于这篇文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:19:23.397

我有一个方便的扩展方法来解决这个问题

```
public static class EnumExtensions
{
    public static string ToNonPascalString(this Enum enu)
    {
       return Regex.Replace(enu.ToString(), "([A-Z])", " $1").Trim();
    }

    public T EnumFromString<T>(string value) where T : struct
    {
       string noSpace = value.Replace(" ", "");
       if (Enum.GetNames(typeof(T)).Any(x => x.ToString().Equals(noSpace)))
       {
           return (T)Enum.Parse(typeof(T), noSpace);
       }
       return default(T);
    }

} 
```

例子：

```
public enum Test
{
    UnitedStates,
    NewZealand
}

// from enum to string
string result = Test.UnitedStates.ToNonPascalString(); // United States

// from string to enum
Test myEnum = EnumExtensions.EnumFromString<Test>("New Zealand");  // NewZealand 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T21:34:59.587

以下代码将转换`AbcDefGhi`为`Abc Def Ghi`.

```
public static string ConvertEnum(this string value)
{
    string result = string.Empty;
    char[] letters = value.ToCharArray();
    foreach (char c in letters)
        if (c.ToString() != c.ToString().ToLower())
            result += " " + c;
        else
            result += c.ToString();
    return result;
} 
```

# sql - 在两个表中获取不同的 column_name

> ID：15234114
> 
> 赞同：0
> 
> 时间：2013-03-05T21:06:46.263
> 
> 标签：sql, oracle, oracle10g

我有两个具有相似结构的下表，其中 id1 和 id2 是唯一的：

```
 Table1
id1    id2   amt1    amt2    id3
1A      1     12      14     12A
2A      4     23      35     34V
3A      8     45      23     13D
.................................

            Table2
id1    id2   amt1    amt2    id3
1A      1     12      27     12A
2A      4     67      35     34D
3A      8     45      23     13D

................................. 
```

所以 id1 和 id2 在这里是独一无二的，所以我想创建一个查询，告诉我哪个 id 与哪个 amt 不匹配，所以我制作了这样的简单脚本：

```
select T.id1,T.id2,
T.amt1,      P.amt1,
T.amt2,      P.amt2,
T.id3,       P.id3
from 
Table1 T,
Table2 P
where 
T.id1=P.id1
T.id2=P.id2
(
nvl(T.amt1 ,0)-nvl(P.amt1 ,0)<>0 OR      --used nvl to check if one table has null for other tables's number
nvl(T.amt2 ,0)-nvl(P.amt2 ,0)<>0 OR
T.id3  <>P.id3  
); 
```

这给了我差异，但是我很难在大表上进行分析，并且假设我有很多列和数量以及很多差异，我希望以如下所示的格式查看输出：假设我正在寻找差异`Table1`

```
id1  id2  difference in column
1A    1       amt2
2A    4       amt1,id3 
```

任何人都可以显示什么查询可以生成如上所示的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:16:03.980

使用以下查询和测试：

```
select * from (select T.id1,T.id2,
T.amt1,      P.amt1,
T.amt2,      P.amt2,
T.id3,       P.id3
decode(nvl(T.amt1 ,0)-nvl(P.amt1 ,0),0,'','amt1')||' '||decode(nvl(T.amt2 ,0)-nvl(P.amt2 ,0),0,'','amt2')||' '||decode(nvl(T.id3 ,0),nvl(P.id3 ,0),'','ID3') difference_in_col
from 
Table1 T,
Table2 P
where 
T.id1=P.id1
and T.id2=P.id2
) where difference_in_col is not null; 
```

这是假设您只有有限的已知列数要检查。

如果没有，那么您将不得不使用过程脚本来填充表或在 dbms_output 中显示结果。

这将不得不变得过于动态。取决于要求

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:19:38.793

下面这个可怕的令人费解的（和未经测试的）SQL 的野兽怎么样？

```
select id1
      ,id2
      ,decode(a.amt1, b.amt1, null, 'amt1,') ||
       decode(a.amt2, b.amt2, null, 'amt2,') || 
       decode(a.id3,  b.id3,  null, 'id3,') as difference_in_column
  from table1 a
  join table2 b using(id1, id2)
 where decode(a.amt1, b.amt1, 1, 0) = 0
    or decode(a.amt2, b.amt2, 1, 0) = 0
    or decode(a.id3,  b.id3,  1, 0) = 0; 
```

注意 1\. 我使用了 decode() 构造，因为它将 null 视为等于 null。

注意 2.`FULL OUTER JOIN`如果您还想在 table1 中查找 table2 中不存在的行，则可以更改为，反之亦然。

注意 3\. 我没有删除列表中的尾随逗号。

# javascript - 这个服务声明方法有什么区别？

> ID：15234116
> 
> 赞同：3
> 
> 时间：2013-03-05T21:06:51.847
> 
> 标签：javascript, angularjs, frontend, angularjs-service

声明服务的最佳方式是什么我发现这两种不同的方式我似乎看不出区别：第一种方法：

```
angular.module('app', [])
   .factory('Data', ['$http',function($http){
     return {
         get: function(fileName,callback){
              $http.get(fileName).
              success(function(data, status) {
                  callback(data);
              });
         }
     };
   }]); 
```

第二种方法：

```
angular.module('app', [])
   .factory('Data', ['$http', function($http){
     var Url   = "data.json";
     var Data = $http.get(Url).then(function(response){
       return response.data;
     });
     return Data;
   }]); 
```

哪个更好，为什么？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:18:37.790

这里有几件事要分开。

**对象与承诺**

服务是单例的，因此在第二种方法中（仅返回承诺）您的数据将永远不会再次更新。这通常是想要的结果。在您的第一种方法中，它每次都会被称为新鲜（尽管`$http`有一个`cache`选项）。

从我的角度来看，只有当有多个方法（例如`get`、`create`、`delete`等）或者需要多次调用它时才会返回一个服务对象。否则，我们只是堆积如山。

**承诺与回调**

承诺**很棒**——我们应该利用它们。传入回调很好，但它也非常有限。使用 Promise，我们可以轻松地将它们链接在一起，例如：

```
Data.get()
.then( massageDataFn )
.then( secondMassageFn )
.then(function ( data ) {
  $scope.items = data;
}); 
```

此外，`$http`已经返回了一个承诺。为什么要把它扔掉？

**方法参数**

您以前的（对象方法）接受了一些参数。虽然我对传入 URL 的控制器持谨慎态度，但在*某些*情况下它是可取的。但是你可以通过*只*返回一个函数而不是一个对象来做到这一点：

```
.factory( 'Data', [ '$http', function ( $http ) {
  return function ( fileName, callback ) {
    // $http call here...
  };
}]); 
```

然后只考虑上面讨论的 Object vs Promise。

**结论**

如果您的服务有 API，则返回一个带有公共 API 方法的对象，其中每个方法都返回一个 Promise。如果您的服务*只是*获取一些数据一次，只需返回承诺并完成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:09:43.443

后者需要预知 url*和*回调函数。后者允许您同时设置目标 url*和*回调，这更加灵活。在大多数情况下，我建议使用前者，但这实际上取决于您要做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:10:30.680

第一个示例为服务用户明确了 HTTP 请求的异步性，我认为这比给服务用户一个 promise 对象（这是第二个示例中的“数据”）并让用户继续进行更可取它的命令式操作，可能取决于尚未填充的“数据”对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:12:42.083

您的第二种方法有点冗长，但一个主要好处是能够创建私有属性/方法，并且只返回公共对象。

请注意，这应该围绕测试等进行计划 - 从个人使用 Angular 的经验来看，私有方法和属性更难以进行单元测试等。

举个例子：

```
angular.module('app', [])
   .factory('Data', ['$http', function($http){
        var private = {
            property: 100,
            method: function(data) {
                return data * 2;
            }
        };
        var public = {
            property: true,
            property_two: false,
            method: function(data) {
                return private.method(data + private.property);
            }
        };
        return public;
   }]); 
```

# drupal - 根据其分类术语以编程方式过滤节点

> ID：15234123
> 
> 赞同：0
> 
> 时间：2013-03-05T21:07:16.853
> 
> 标签：drupal, location, field, taxonomy

我有一个会话变量，其中包含一个不断变化的城市名称。

示例 - $_Session['Toronto'];

我还有一个包含很多字段的未过滤节点列表。最重要的是，它们有一个分类术语字段，称为“城市”。

我需要能够仅显示具有与 $_Session['Toronto'] 匹配的分类术语的节点。

示例 - 节点 9 和 10 具有分类术语“多伦多”和“渥太华”。我只希望在页面上显示带有“Toronto”一词的节点。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T13:07:13.800

对于视图，您可以使用 hook_views_query_alter

D7 示例

```
function YOURMODULE_views_query_alter(&$view, &$query){

  switch ( $view->name ){
    case 'YOURVIEWNAME':    
      $query->where[1]['conditions'][] = array(
        'field' => 'term_field_name', //your term name in the sql query
        'value' => $_Session['Toronto'],
        'operator' => '='
      );
      break;
  }
} 
```

# javascript - Object.create 设置 __proto__ 但不是原型

> ID：15234127
> 
> 赞同：5
> 
> 时间：2013-03-05T21:08:00.320
> 
> 标签：javascript, prototype

我对使用 object.create 而不是经典的 js 方式来实现原型继承非常陌生。

至少在 Chrome 中，我很惊讶地看到以下代码：

```
var baseObject = {
test : function(){
    console.log('Child');
}
}

var newObject = Object.create(baseObject);
newObject.test = function(){
console.log('Parent');
this.__proto__.test();
}
console.log(newObject);

newObject.test(); 
```

产生这个（模拟网络工具中的输出）：

```
Object {test: function, test: function} 
    test: function (){
    __proto__: Object
        test: function (){
        __proto__: Object
Parent
Child 
```

所以你看到它没有设置原型，而只是“__proto__”，我认为不鼓励使用它。您可以在我的代码中看到，我能够正确继承并调用父对象，但只能使用“__proto__”。使用“原型”会导致错误（未定义）。

这里发生了什么？我认为 object.create 会设置“原型”，因为这是标准（或者我假设）。为什么它会填充并让我使用“__proto__”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:15:37.277

不鼓励使用`__proto__`设置原型继承，因为它是非标准的。这并不意味着您不能使用`Object.create()`特定原型对象来制作新对象。

默认情况下，对象没有`.prototype`属性。您混淆`.prototype`了函数的对象。

所以如果我有这样的功能：

```
function Foo() {

} 
```

该`Foo`函数对象具有`.prototype`引用一个对象的属性，该对象将用作在`__proto__`作为构造函数调用时创建的任何对象的 。

```
var f = new Foo(); 
```

所以 now`f`是一个`Foo.prototype`在其原型链中的对象。`Object.getPrototypeOf()`您可以使用;来验证这一点

```
Object.getPrototypeOf(f) === Foo.prototype; // true 
```

* * *

使您`Object.create`能够建立相同的原型链，但不使用构造函数。所以这将是等价的。

```
var f2 = Object.create(Foo.prototype); 
```

现在我们有一个对象，它的设置方式与原始`f`对象相同。

```
Object.getPrototypeOf(f2) === Foo.prototype;            // true
Object.getPrototypeOf(f2) === Object.getPrototypeOf(f); // true 
```

* * *

所以这只是一种不同的方式来做最终相同的事情。对象与其原型链之间的关系是一种*内部*关系。非标准`__proto__`只是暴露了这种关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:15:48.827

实例的`__proto__`属性应该与*构造函数的* `prototype`属性相同。

> 当一个对象被创建时，它的`__proto__`属性被设置为引用与其内部相同的对象`[[Prototype]]`（即它的构造函数的`prototype`对象）。分配一个新值`__proto__`也会更改内部`[[Prototype]]`属性的值，除非对象是不可扩展的。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/proto#Description](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/proto#Description)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:17:17.827

`Object.create()`设置该特定对象实例的原型。 `prototype`是构造函数的一个属性，它是*自动*分配为 [[Prototype]] 的对象，该对象是通过使用`new`具有该构造函数的运算符创建的每个实例。

`__proto__`是访问特定实例的 [[Prototype]] 的非标准方式。您还可以调用[Object.getPrototypeOf(this)](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/getPrototypeOf)以获取访问原型的标准方法。

# python - 插入排序 Python

> ID：15234129
> 
> 赞同：2
> 
> 时间：2013-03-05T21:08:13.100
> 
> 标签：python, algorithm, sorting, insertion-sort

我已经在 python 中实现了插入排序，并且想知道如何确定算法的复杂性。这是实现插入排序的低效方式吗？对我来说，这似乎是最易读的算法。

```
import random as rand
source = [3,1,0,10,20,2,1]
target = []
while len(source)!=0:
 if len(target) ==0:
  target.append(source[0])
  source.pop(0)
 element = source.pop(0)
 if(element <= target[0]):
  target.reverse()
  target.append(element)
  target.reverse()
 elif element > target[len(target)-1]:
  target.append(element) 
 else:
  for i in range(0,len(target)-1):
   if element >= target[i] and element <= target[i+1]:
    target.insert(i+1,element)
    break
print target 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:26:02.893

代替：

```
target.reverse()
target.append(element)
target.reverse() 
```

尝试：

```
target.insert(0, element) 
```

此外，也许使用 for 循环而不是 while 循环来避免`source.pop()`？：

```
for value in source:
  ... 
```

在最后的 else 块中，if 测试的第一部分是多余的：

```
else:
   for i in range(0,len(target)-1):
     if element >= target[i] and element <= target[i+1]:
        target.insert(i+1,element)
        break 
```

由于列表已经排序，一旦你找到一个比你插入的元素大的元素，你就找到了插入位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:46:48.700

我会说这是相当低效的。你怎么知道？您的方法创建了第二个数组，但您在选择排序中不需要一个。你使用了很多操作——选择排序需要查找和交换，但是你有查找、追加、弹出、插入和反转。所以你知道你可能会做得更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T00:50:51.170

```
def insertionsort( aList ):
  for i in range( 1, len( aList ) ):
    tmp = aList[i]
    k = i
    while k > 0 and tmp < aList[k - 1]:
        aList[k] = aList[k - 1]
        k -= 1
    aList[k] = tmp 
```

此代码取自 g [eekviewpoint.com](http://www.geekviewpoint.com/python/sorting/insertionsort)。显然这是一种`O(n^2)`算法，因为它使用了两个循环。但是，如果输入已经排序，那么`O(n)`因为`while-loop`总是会因为`tmp < aList[k - 1]`失败而被跳过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-08T11:52:22.750

```
alist = [4,7,9,1,3,0,5,2,6,8]
sortlist = []
print(alist)
print(sortlist)
sortlist.append(alist[0])
alist.pop(0)

while len(alist) != 0:
    swap = False
    for pos in range(0, len(sortlist)-1):
        if sortlist[pos] > alist[0] and swap != True:
            sortlist.insert(pos,alist[0])
            swap = True
            print(alist)
            print(sortlist)
    if swap == False:
        sortlist.insert(len(sortlist),alist[0])
    alist.pop(0)

alist = sortlist

print(alist) 
```

# mysql - 使用 MySQL Workbench 代码插入外键引发语法错误

> ID：15234130
> 
> 赞同：-3
> 
> 时间：2013-03-05T21:08:16.650
> 
> 标签：mysql, foreign-keys

我用 MySQL Workbench 创建了几个表，但外键有问题。如果我在下面导出代码，我会收到错误，但是如果我不使用外键导出，我不会收到错误，您能否帮我看看代码。

SQL 代码：

```
DROP TABLE IF EXISTS `mydb`.`users` ;
CREATE  TABLE IF NOT EXISTS `mydb`.`users` (
`uuserid` INT NOT NULL AUTO_INCREMENT ,
`ufname` VARCHAR(25) NULL ,
`ulname` VARCHAR(25) NULL ,
`uuname` VARCHAR(45) NULL ,
`upass` CHAR(64) NOT NULL ,
`uemail` VARCHAR(254) NOT NULL ,
`urole` INT NULL DEFAULT 0 ,
PRIMARY KEY (`uuserid`) )
ENGINE = InnoDB;

DROP TABLE IF EXISTS `mydb`.`photos` ;
CREATE  TABLE IF NOT EXISTS `mydb`.`photos` (
`pphotoid` INT NOT NULL ,
`pname` VARCHAR(4) NULL ,
`plat` FLOAT(10,6) NULL ,
`plng` FLOAT(10,6) NULL ,
`pflag` DECIMAL(10,0) NULL DEFAULT 0 ,
`pext` VARCHAR(4) NULL ,
`plike` DECIMAL(10,0) NULL DEFAULT 0 ,
PRIMARY KEY (`pphotoid`) ,
CONSTRAINT `uuserid`
FOREIGN KEY ()
REFERENCES `mydb`.`users` ()
ON DELETE NO ACTION
ON UPDATE NO ACTION)
ENGINE = InnoDB; 
```

错误：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') REFERENCES `mydb`.`users` () ON DELETE NO ACTION ON UPDAT' at line 21 
```

我的数据库有更多的表，但这段代码也中断了。我尝试使用 phpmyadmin 插入它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:12:22.340

这里需要指定列名

```
FOREIGN KEY (present_table_column_name) 
```

参考文献`mydb`。`users`(foriegn_key_column_name)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:30:27.393

尝试运行此脚本。我使用您的脚本构建它并在[SQLFiddle](http://www.sqlfiddle.com/#!2/f05d7)中运行它，所以我知道它可以工作。为了添加外键，您必须有一个合适的字段。在此示例中，我`uuserid`在表中添加了一列`photos`。`uuserid`此列对表中的列具有外键约束`users`。

```
DROP TABLE IF EXISTS `mydb`.`users` ;
CREATE  TABLE IF NOT EXISTS `mydb`.`users` (
`uuserid` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
`ufname` VARCHAR(25) NULL ,
`ulname` VARCHAR(25) NULL ,
`uuname` VARCHAR(45) NULL ,
`upass` CHAR(64) NOT NULL ,
`uemail` VARCHAR(254) NOT NULL ,
`urole` INT NULL DEFAULT 0
) ENGINE = InnoDB;

DROP TABLE IF EXISTS `mydb`.`photos` ;
CREATE  TABLE IF NOT EXISTS `mydb`.`photos` (
`pphotoid` INT NOT NULL PRIMARY KEY,
`pname` VARCHAR(4) NULL ,
`plat` FLOAT(10,6) NULL ,
`plng` FLOAT(10,6) NULL ,
`pflag` DECIMAL(10,0) NULL DEFAULT 0 ,
`pext` VARCHAR(4) NULL ,
`plike` DECIMAL(10,0) NULL DEFAULT 0,
`uuserid`INT NOT NULL
) ENGINE = InnoDB;

Alter Table `photos` add constraint foreign key(`uuserid`) references `users`(`uuserid`); 
```

在上面的示例中，我将设置主键的语句移动到列本身，而不是在 SQL 末尾创建语句。

我认为向您展示如何在表创建之外添加外键约束会更清楚一些，这样您就可以看到导致语法错误的原因。您的外键引用中没有列名。添加后，上述代码将完美运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:21:35.217

在错误消息告诉您有语法错误的地方，您有一个语法错误。

问题是您没有在约束中引用任何字段。子句的形式`CONSTRAINT`应该是这样的：

```
CONSTRAINT `fkuuserid`
FOREIGN KEY `fkuuserid` (some_field_in_this_table)
REFERENCES `mydb`.`users` (uuserid)
ON DELETE NO ACTION
ON UPDATE NO ACTION 
```

老实说，我什至看不到照片表上的逻辑外键在哪里，因为该表中没有 uuserid 字段。

# unix - 从 unix 服务器到 Pure Data 的 TCP/IP 通信

> ID：15234131
> 
> 赞同：2
> 
> 时间：2013-03-05T21:08:19.467
> 
> 标签：unix, networking, client-server, puredata

我对从 Unix 服务器到 Pure Data 的 TCP/IP 通信感兴趣。我在 Unix 服务器端使用套接字，在纯数据端使用 netclient 实现了它。为此，我利用了聊天服务器教程（3.Networking > 10.chat_client.pd）。

现在的问题在于服务器将数据作为以“;”分隔的“字符串”消息流式传输。

**我的问题是，有没有办法将字符串消息以外的东西发送到 Pure Data，比如字节流或序列化数字流？Pure Data 能收到这样的消息吗？**

由于字符串需要太多字节来传输，例如数字“1024;” 已经是 5 个字节，而这样的整数只有 4 个字节。

更新：对于偶然发现这篇文章以寻找答案的每个人。

显然，纯数据端的 [netclient] 只能收到 ; 分隔的消息。所以上面提出的问题的解决方案： **我的问题是，有没有办法向纯数据发送字符串消息以外的东西，比如字节流或序列化数字流？Pure Data 能收到这样的消息吗？**

解决方法是使用[tcpclient]，它可以接收字节流数据。

**现在我的问题是，我如何获得四个紧凑的数字？** 现在我有一系列字节，至少按正确的顺序。

从我的 UNIX 服务器我发送一个结构

```
typedef struct {
    int     var_code;
    int    sample_time;
    int     hr;
    float    hs;
} phy_data; 
```

样本数据可能是 2 1000000 51 2000.56

当在 Pure Data 中接收和打印时，我得到如下输出：

> > > : 0 0 0 2 0 10 114 26 0 0 0 51 0 16 242 78

你可以清楚地注意到 2 号和 51 号，我猜其他的也是正确的。

**如何将这些数字恢复为可用格式？** 也许对 [bytes2any] 和 [route] 进行了一些操作，但我无法用它提取数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T16:12:24.073

这是您必须做的事情的概要：

*   将字节列表重新打包为各种类型的正确大小的小消息。

    由于您的所有元素都是 4 字节长，您只需重新打包您的列表（或字节流，因为 TCP/IP 不保证将您的 16 字节作为单个列表提供，但也可以决定将其分解为任意长度的列表）到许多 4 个原子列表。

    最稳定的方法可能是第一次序列化列表（检查 [list] 帮助中的“序列化程序”示例），然后将该列表重新组合为 4 个元素。

    如果你可以使用像 zexy 这样的外部工具，你可以使用 [repack 4]。

    如果您信任 [netclient] 将您的消息作为完整列表输出，您可以简单地使用一个大的 [unpack ....] 和 4 个 [pack]

*   解释每个子列表的原始数据

    整数相当简单，浮点数更复杂

整数：

```
 |
    [unpack 0 0 0 0]
    |      |   |   |
    [<< 8] |   |   |
    |      |   |   |
    [+     ]   |   |
    |          |   |
    [<< 8]     |   |
    |          |   |
    [+         ]   |
    |              |
    [<< 8]         |
    |              |
    [+             ]
    | 
```

花车留给用户作为练习:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:33:31.117

您问题的真正解决方案是使用定义明确的应用层协议，而不是自己酿造。

用于 Pd 等应用程序的最广泛协议当然是[OSC](http://opensoundcontrol.org)。

为了将原始 OSC 字节解码为 Pd 消息，请使用 [unpackOSC]（“mrpeach”库的一部分；在 Debian 上，您可以通过`pd-osc`软件包安装它）

在“服务器”端，您可以使用[liblo](http://liblo.sourceforge.net/)对数据进行编码和发送。

## 笔记

请注意，由于 OSC 是基于数据包的，因此您将需要一种用于基于流的协议（如 TCP/IP）的数据包化机制。与 OSC-1.2 一样，这应该是[SLIP](http://en.wikipedia.org/wiki/Serial_Line_Internet_Protocol)。`liblo`应该已经处理好了。检查 [unpackOSC] 附带的补丁以了解如何在 Pd 中执行此操作。

如果您使用 UDP 作为传输，则不需要所有这些。

# xcode - 如何诊断拖动过程中的意外延迟？

> ID：15234139
> 
> 赞同：2
> 
> 时间：2013-03-05T21:09:04.217
> 
> 标签：xcode, cocoa, debugging, instruments

有时，我的一个应用程序在复杂视图中拖动对象时会出现 2-10 秒的延迟。在某些情况下，延迟足以导致等待光标（旋转的死亡披萨）出现。

Time Profiler 没有显示什么特别值得注意的东西——只是在拖动对象时更新视图的预期绘图调用。（这是大量计算，但我发现暂停期间和暂停之间的配置文件没有明显差异。）

内存分析器显示暂停没有什么特别之处。在整个拖累过程中，分配似乎持平。泄漏是干净的。（我最初的假设是我剥离了太多自动释放的对象，但这似乎不是问题。）

活动监视器表明，在拖动过程中，我几乎用完一个核心来进行所有重绘。这就是我所期望的。

关于下一步该往哪里看的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T09:17:59.263

唔。好吧，也许您可​​以尝试在启用“记录等待线程”的情况下运行 Instruments.app。这将向您显示代码正在等待和运行的位置。您可能正坐在信号量中或做一些 IO- 会以这种模式显示。

![仪器](../Images/4bed971c1eebae1727e75ea945450059.png)

# sql-server - sql查询通知服务问题

> ID：15234141
> 
> 赞同：2
> 
> 时间：2013-03-05T21:09:22.390
> 
> 标签：sql-server, sql-server-2008-r2

我们的数据库出现超时问题。所以我打开了 SQL Server Profiler 并看到 SQLQueryNotificationService 每秒运行很长时间。我检查了 Service Broker 并创建了一堆 SQLQueryNotificationService 队列。我认为我们没有创建任何这些队列，也有一堆存储过程，比如这些 SqlQueryNotificationStoredProcedure-15c5b84b-42b0-4cfb-9707-9b1697f44127。你能告诉我如何丢弃它们吗？如果我删除它们对数据库有任何影响吗？请告诉我。我很感激任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-28T15:43:47.547

您是否有一个正在运行的 ASP.Net 网站或另一个创建 Sql Server 缓存依赖项的应用程序？它是 Sql Server Service Broker 队列，它执行等待大约一分钟（60000 毫秒）的 WAITFOR ... 语句，然后在下一秒再次执行。通常不应该引起问题，它不应该阻塞或延迟您的“正常”查询或存储过程。

但是，我曾经看到它给我带来了问题——其中一个存储过程，当从建立缓存依赖关系的同一个 Web 应用程序执行时，超时（或者更确切地说，在 120 秒内返回，这是不可接受的）。完全相同的存储过程，在具有相同参数的相同帐户下执行，但来自 Management Studio，运行良好，没有任何问题。它是 SQL Server 2005 SP4。

SQL Profiler 显示，在执行我的存储过程的过程中（并且总是在相同的 INSERT INTO ... 语句之后），它的执行被中断了，而不是它的语句有 WAIT FOR .... 来自 Sql Query Notification，在一分钟内完成，然后另一个 WAIT FOR... 开始并再次在 59 秒内完成 - 仅在此之后 Profiler 才向我显示我的存储过程已完成。持续时间为 119000，几乎正好是两分钟。

如果该查询通知正在我的存储过程中加入事务。

**有什么帮助：**重新编译有问题的存储过程。我只是改变了它的脚本，用一些小的语法改变做了 ALTER 语句。之后就没有问题了。

# java - JScrollPane 原点上方的 JScrollPane 中的图像原点

> ID：15234144
> 
> 赞同：1
> 
> 时间：2013-03-05T21:09:35.527
> 
> 标签：java, swing, jscrollpane, bufferedimage, jviewport

我是一个编程新手，所以如果这是一个明显的问题，请原谅我，但我正在开发一个应用程序，除其他外，构建甘特图。

我遇到的问题是其中一个面板（namesPanel）显示了相关图像，但顶部缺少大约 10 个像素。我可以通过在绘图时向 y 变量的起点添加 10 个像素来使图像看起来正确，但这感觉不对，如果有错误，我现在想将其压缩。

图表实际上是由嵌套在一个 JPanel 中的三个不同的 JScrollPanes 组成的，并用 GridBagLayout 排列：

```
 datesPanel = new JScrollPane();
    datesPane = new GanttPanel();
    panelList.put(datesPanel, datesPane);
    c = new GridBagConstraints();
    c.fill = GridBagConstraints.BOTH;
    c.gridx = 1;
    c.gridy = 0;
    c.weightx = 0.1;
    c.weighty = 0.1;
    add(datesPanel, c);

    namesPanel = new JScrollPane();
    namesPane = new GanttPanel();
    panelList.put(namesPanel, namesPane);
    c = new GridBagConstraints();
    c.fill = GridBagConstraints.BOTH;
    c.gridx = 0;
    c.gridy = 1;
    c.weightx = 0.18;
    c.weighty = 1;
    add(namesPanel, c);

    ganttPanel = new JScrollPane();
    ganttPane = new GanttPanel();
    panelList.put(ganttPanel, ganttPane);
    c = new GridBagConstraints();
    c.fill = GridBagConstraints.BOTH;
    c.gridx = 1;
    c.gridy = 1;
    c.weightx = 1;
    c.weighty = 1;
    add(ganttPanel, c);

    for (JScrollPane j : panelList.keySet()) {
        GanttPanel g = panelList.get(j);
        j.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        j.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);
        j.addMouseListener(listener);
        LineBorder b = (LineBorder) BorderFactory.createLineBorder(DARK);
        j.setBorder(b);
        j.setViewportView(g);
    }

    namesImage = (BufferedImage) namesPane.createImage(canvasWidth, canvasDepth);
    namesPane.setImage(namesImage);
    namesGraphics = (Graphics2D) namesImage.getGraphics();

    datesImage = (BufferedImage) datesPane.createImage(canvasWidth, canvasDepth);
    datesPane.setImage(datesImage);
    datesGraphics = (Graphics2D) datesImage.getGraphics();        

    ganttImage = (BufferedImage) ganttPane.createImage(canvasWidth, canvasDepth);
    ganttPane.setImage(ganttImage);
    graphics = (Graphics2D) ganttImage.getGraphics(); 
```

这样做的原因是允许用户使用鼠标滚动甘特图，因此稍后将 namesPanel 和 datesPanel 的滚动条设置为与甘特图相同的 JScrollBar 实例。

然后程序继续调整所有图像的大小以节省内存 - 首先它们都设置为相同大小的原因是需要某些图形计算来设置最终图像的边界，这意味着创建一个从中获取图形对象的图像。另外，我不知道如何使图像更大：

```
 /**
 * Sets the boundaries of all the panels and moves them into position
 */
private void setBounds()
{
    int xStart = canvasWidth - xOffset;
    int yStart = canvasDepth - yOffset;
    Container dad = getParent();
    Rectangle dadRect = dad.getBounds();
    Dimension ganttSize = new Dimension(dadRect.width - xOffset, dadRect.height - yOffset);

    ganttImage = ganttImage.getSubimage(0, 0, xStart, yStart);
    ganttPane.setPreferredSize(new Dimension(xStart, yStart));
    ganttPanel.setPreferredSize(ganttSize);

    datesImage = datesImage.getSubimage(0, 0, xStart, (yOffset + yUnit));
    datesPane.setPreferredSize(new Dimension(xStart, yOffset));
    datesPanel.setPreferredSize(new Dimension(xStart, yOffset));

    namesImage = namesImage.getSubimage(0, 0, xOffset, yOffset);
    namesPane.setPreferredSize(new Dimension(xOffset, yStart));
    namesPanel.setPreferredSize(new Dimension(xOffset, yStart));
    namesPanel.setBackground(DARK);

} 
```

最后，程序实际绘制了图像——我知道这个区域需要重构为子方法，但这里是：

```
 /**
 * Draw the bars of the Gantt Chart
 */
private void drawBars()
{
    Calendar from = model.getFrom();
    int i = 0;
    for (int y = 0; y < canvasDepth && i < elements.size(); y += yUnit) {
        GanttElement ge = elements.get(i);
        //TODO refactor this section into multiple methods
        int startPoint = 0;
        int endPoint = 0;
        try {
            startPoint = (model.calculateRange(from, ge.getFrom()) * xUnit);
            if (startPoint % 10 != 0) {
                startPoint -= startPoint % 10;
            }
            endPoint = (model.calculateRange(from, ge.getTo()) * xUnit);
        }
        catch (IllegalArgumentException | BadDateException e) {
            /*TODO add a badDateResponse method to the GanttElement interface
             *so that the program can handle a bad date request appropriately 
             */
            System.out.println(e + " " + ge.getName());
        }
        for (int x = 0; x <= endPoint; x += xUnit) {
            if (x == 0) {
                namesGraphics.setColor(Color.WHITE);
                namesGraphics.drawString(ge.getName(), (2 * getSeparatorX()), y);
            }
            if (i % 2 == 0) {
                graphics.setColor(lightBlock);
            }
            else {
                graphics.setColor(darkBlock);
            }
            if (x >= startPoint) {
                GanttBlock block = new GanttBlock(x + (separatorX / 2), y, blockWidth, rowHeight, i);
                blocks.add(block);
                graphics.fill(block);
            }
        }
        i++;
    }
} 
```

我很难过 - 我找不到导致问题的行，我看不出我处理 namesPanel 的方式与处理其他人的方式有什么区别。更改影响图像位置和尺寸的字段也无济于事。操作 JViewport 也不行。:-(

再次道歉，如果这太长了，但我不知道要关注代码的哪个区域。

# javascript - 在 JSON 中生成成员

> ID：15234146
> 
> 赞同：0
> 
> 时间：2013-03-05T21:09:47.897
> 
> 标签：javascript, json

我正在尝试将以下页面提取到 JSON 对象：

[http://www.sarajevo-airport.ba/mobile/letovi.php?vrsta=odlasci&dest=Beograd&lang=bos](http://www.sarajevo-airport.ba/mobile/letovi.php?vrsta=odlasci&dest=Beograd&lang=bos)

```
var mybody = document.getElementsByTagName('body')[0];
var table = mybody.getElementsByTagName('table')[0];

var jsonObj = [];

for (var i = 0, row; row = table.rows[i]; i++) 
{
    var cell2 = row.cells.length == '1' ? '' : row.cells[1].textContent.trim();
    jsonObj.push( { what: row.cells[0].textContent.trim(), value:cell2 });
}
console.log(jsonObj); 
```

让我找到这个 JSON 对象

```
[
    Object { what= "Beograd" , value= "" }, 
    Object { what= "Broj leta" , value= "JU 109, JA 1376" }, 
    Object { what= "Avio-kompanija" , value= "JAT AIRWAYS" }, 
    Object { what= "Tip aviona" , value= "AT72" }, 
    Object { what= "Planirano vrijeme" , value= "06:20" }, 
    Object { what= "Status leta" , value= "Odletio" }, 
    Object { what= "" , value= "" }, 
    Object { what= "Beograd" , value= "" }, 
    Object { what= "Broj leta" , value= "SOP 4121" }, 
    Object { what= "Avio-kompanija" , value= "SOLINAIR LTD" }, 
    Object { what= "Tip aviona" , value= "SF34" }, 
    Object { what= "Planirano vrijeme" , value= "16:35" }, 
    Object { what= "Status leta" , value= "Odletio" }, 
    Object { what= "" , value= "" }
] 
```

由于此页面包含有关 2 个航班的信息，我需要在 JSON 字符串中添加两个元素来描述

1.  航班1
2.  飞行2

那么我怎样才能得到这样的东西：

```
 {  "Flight1": [
    Object { what= "Beograd" , value= "" }, 
    Object { what= "Broj leta" , value= "JU 109, JA 1376" }, 
    Object { what= "Avio-kompanija" , value= "JAT AIRWAYS" }, 
    Object { what= "Tip aviona" , value= "AT72" }, 
    Object { what= "Planirano vrijeme" , value= "06:20" }, 
    Object { what= "Status leta" , value= "Odletio" }, 
    Object { what= "" , value= "" }],

"Flight2": [
    Object { what= "Beograd" , value= "" },     
    Object { what= "Broj leta" , value= "SOP 4121" }, 
    Object { what= "Avio-kompanija" , value= "SOLINAIR LTD" }, 
    Object { what= "Tip aviona" , value= "SF34" }, 
    Object { what= "Planirano vrijeme" , value= "16:35" }, 
    Object { what= "Status leta" , value= "Odletio" }, 
    Object { what= "" , value= "" ] 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:30:42.350

`Object`不是有效的 JSON 元素。

您可以在此处验证您的 JSON：http: [//jsonlint.com/](http://jsonlint.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:59:54.610

您可以检查`<hr>`元素以遍历您的对象：

```
var mybody = document.getElementsByTagName('body')[0];
var table = mybody.getElementsByTagName('table')[0];

var jsonObj = [], flights = {}, numFlights = 1;

for (var i = 0, row; row = table.rows[i]; i++) 
{
    if (row.cells[0].innerHTML == "<hr>") {
        flights["Flight"+(numFlights++)] = jsonObj;
        jsonObj = [];
    }
    else {
       var cell2 = row.cells.length == '1' ? '' : row.cells[1].textContent.trim();
       jsonObj.push( { what: row.cells[0].textContent.trim(), value:cell2 });
    }
}
console.log(flights); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:34:03.297

您正在做的是创建基本的 javascript 对象。顺便说一句，你可以这样做：

```
var jsonObject = {}; // create object
jsonObject["foo"] = ["a", "b"]; // create associative indexes, so called members
jsonObject.bar = {}
jsonObject.something = 10; 
```

要将其序列化为 JSON，最好的选择是`JSON.stringify()`将 js 对象转换为 JSON 字符串，以及`jQuery.parseJSON()`将 JSON 字符串转换回 js 对象。您将需要[jQuery](http://jquery.com/)来使用这些方法。

# wpf - 在 WPF 中调度最高优先级

> ID：15234149
> 
> 赞同：1
> 
> 时间：2013-03-05T21:09:53.763
> 
> 标签：wpf

大家好，我想知道如果我处于优先级为渲染的任务中间会发生什么，并且我创建了另一个具有优先级发送的任务。Dispatcher 会直到完成其优先级渲染任务，然后我的最高优先级任务（即发送）将被执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:10:50.313

> Dispatcher 会直到完成其优先级渲染任务，然后我的最高优先级任务（即发送）将被执行？

是的。优先级仅在`Dispatcher`启动每个任务时使用。它不会停止已经在进行的操作。

# sql - 按未格式化的日期排序 sqlite

> ID：15234150
> 
> 赞同：2
> 
> 时间：2013-03-05T21:10:01.820
> 
> 标签：sql, sqlite, date, format

我将日期作为字符串存储在数据库中，格式为 DD-MM-YYYY。

当我尝试在日期列上使用 orderby 进行选择查询时。我没有得到预期的结果。

结果示例：28/02/2013 27/02/2013 01/03/2013

我的 sql 查询：

```
SELECT * FROM data ORDER BY strftime('%s', date_column) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:33:49.850

问题是您将日期存储为 DD-MM-YYYY 字符串，这不仅会阻止日期作为字符串的自然排序，而且还会使用[SQLite 的日期和时间函数](http://www.sqlite.org/lang_datefunc.html)来解析它们。单击链接并向下滚动到“时间字符串”部分。

SQLite 期望日期/时间字符串按自然顺序，从最高有效位到最低有效位，即 YYYY-MM-DD。您可以使用字符串操作将 DD-MM-YYYY 字符串转换为该格式。例如：

```
select 
  substr(reversed_date, 7,4) || '-' || 
  substr(reversed_date, 4, 2)|| '-' ||
  substr(reversed_date, 1, 2) as proper_date
  from (
    select '12-03-2000' as reversed_date
  )
; 
```

您可以将日期列转换为这种格式（如@peterm 建议的那样），或者只使用 的值`proper_date`进行排序。您不需要为此使用`strftime`，但与日期相关的函数将使用这些值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T21:23:59.147

恕我直言，您需要更改存储日期的格式

```
DD-MM-YYYY 
```

到

```
YYYY-MM-DD 
```

来自文档

> **时间字符串** 时间字符串可以是以下任何格式：
> YYYY-MM-DD
> YYYY-MM-DD HH:MM
> YYYY-MM-DD HH:MM:SS
> YYYY-MM-DD HH:MM:SS.SSS
> YYYY -MM-DDTHH:MM
> YYYY-MM-DDTHH:MM:SS
> YYYY-MM-DDTHH:MM:SS.SSS
> ...

然后您的原始查询和这个查询将按预期工作

```
SELECT * FROM Table1 ORDER BY date(date_column);
SELECT * FROM Table1 ORDER BY strftime('%s', date_column); 
```

输出：

```
| date_column |
---------------
|  2013-02-27 |
|  2013-02-28 |
|  2013-03-01 | 
```

**[sqlfiddle](http://sqlfiddle.com/#!5/b343d/3)**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T21:15:25.410

根据[文档](http://www.sqlite.org/lang_datefunc.html)，以下应该有效

```
SELECT * 
FROM data 
ORDER BY strftime('%Y-%m-%d', date_column) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:20:21.007

尝试：

```
SELECT * FROM data ORDER BY to_date(date_column) 
```

可能这可能会解决您的问题，因为它用于字符串比较而不是日期比较，所以

01/03/2013 看起来小于 28/02/2013 或 27/02/2013

因此输出为：

2013 年 1 月 3 日、2013 年 2 月 27 日、2013 年 2 月 28 日

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-21T06:37:08.497

此查询对我有用过滤日期

```
SELECT inst.*,
       Substr(columnname, 4, 2)  AS newdate,
       Substr(columnname, 0, 3)  AS newday,
       Substr(columnname, 12, 5) AS newtime
FROM   table_name AS inst
WHERE  child_id = id
ORDER  BY newdate DESC, newday DESC, newtime DESC 
```

# linux - Bash 脚本访问重定向|管道输入

> ID：15234161
> 
> 赞同：0
> 
> 时间：2013-03-05T21:10:46.873
> 
> 标签：linux, bash

我找到了一个不错的实用程序脚本，它可以从所需的起始行有效地输出所需的行数。我将其命名为 mid.bak，它基于此处的帖子>> [http://www.fastechws.com/tricks/unix/head_tail_mid_files.php](http://www.fastechws.com/tricks/unix/head_tail_mid_files.php)

用法：mid.bak startline numlines 文件名

```
$ cat mid.bak
#!/bin/sh
echo "Positional parameter count: $#"
tail -n +$1 $3 | head -n $2
echo "Parameter three is: $3" 
```

案例一：按照上面概述的正常用法，找到位置参数“$3”。

```
$ mid.bak 3 2 file.txt
Positional parameter count: 3
This line 3 in file.txt
This line 4 in file.txt
Parameter three is: file.txt 
```

案例 II 和 III：“$3”神秘地不存在。

```
$ mid.bak 3 2 < file.txt
Positional parameter count: 2
This line 3 in file.txt
This line 4 in file.txt
Parameter three is: 

$ cat file.txt | mid.bak 3 2
Positional parameter count: 2
This line 3 in file.txt
This line 4 in file.txt
Parameter three is: 
```

我的问题：上面的位置参数 $3 可通过正常的 $1, $2 .. 用于案例 I 的脚本引用。那么为什么它不包含在计数“$#”中并且对于案例 II 和 III 没有回显？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:35:28.747

在我的情况下，文件的名称是第三个参数。在情况 II 和 III 中，没有第三个参数，因此`$3`扩展为空字符串，并且由于未引用，因此从传递给的参数列表中删除`tail`。`tail`，在其参数列表中没有接收到文件名，而是从标准输入读取，在案例 II 中`file.txt`通过运算符连接到标准输入，在案例 III 中通过管道连接`<`到输出。`cat file.txt`

# actionscript-3 - 使用 box2d 中的向量进行计算会导致滞后

> ID：15234163
> 
> 赞同：0
> 
> 时间：2013-03-05T21:10:57.350
> 
> 标签：actionscript-3, vector, box2d

我正在尝试使用来自 box2d 的向量在我的 actionScript3 游戏中实现人工智能。我正在复制向量、乘法、归一化……每次更新 10 次，由于计算量太大，游戏开始滞后。我如何减少滞后，因为游戏几乎冻结。这是一个错误还是我做得不对。

```
 var velocityTemp:b2Vec2 = velocity.Copy();
                    velocityTemp.Normalize();
                    var forward:b2Vec2 = b2Vec2.Make(velocityTemp.x, velocityTemp.y);
                    var diff:b2Vec2 = b2Vec2.Make(obstacles[i].getPosition().Copy().x - position.x,obstacles[i].getPosition().Copy().y - position.y);
                    var dotProduct:Number = b2Math.Dot(diff, forward);
velocityTemp = null;
            velocity = null;
            position = null;
            forward = null;
            diff = null;
            dotProduct = 0; 
```

我尝试将它们全部设置为空，但问题仍然存在。

# php - 通过 MySQL 搜索查询传递多个 $_POST 字段

> ID：15234165
> 
> 赞同：0
> 
> 时间：2013-03-05T21:10:57.833
> 
> 标签：php, mysql

我有一个可能包含 15 个左右字段的搜索表单，但并非所有字段都需要执行搜索，例如；

用户可能会在 'London' 中搜索在 'Finance' 工作的注册用户，但将所有其他字段留空，例如 $availability 或 $salary 等，因此 $_POST 数据可能类似于：

```
$location = $_POST['location'];    // Value - London
$sector = $_POST['sector'];        // Value - Finance
$available = $_POST['available'];  // Value - Any
$salary = $_POST['salary'];        // Value - Any 
```

请记住，我可能还有来自其他字段的另外 12 个左右的“任何”值，查询数据库（PHP/MySQL）以返回结果而不循环可能是几十个查询的最佳方法是什么。

为了尝试更清楚一点，我想要的是一个类似于（故意伪代码）的查询：

```
SELECT * FROM table where location = 'location' AND if($availability !='Any') { available = '$available' } etc etc 
```

这样的事情可能吗？

或者我可以创建一个包含 !='Any' 的所有 $_POST 字段的单个字符串，然后对包含字符串中所有单词的行进行搜索（我认为这在理论上可行）？

我希望这对某人有意义，您可以为我指明正确的方向。

PS 所有 $_POST 在与数据库交互之前都被转义和保护，只是不包括在这里:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:15:48.717

试试这个：

```
$sql = "SELECT * FROM table where 1 ";
foreach ($_POST as $key => $post) {
    if ($post != 'Any') {
        $sql .= " AND $key = '$post' ";
    }
}

// now you can run $sql against the database 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:16:28.200

您是否可以将所有 $_POST 收集到 foreach($key=>$val) 中，然后通过 switch 或 if 语句将“AND x=x”附加到语句中运行密钥？

就像是：

```
$sql = "SELECT * FROM table WHERE required='required'";
foreach($_POST as $key=>$val){
if(!empty($val)){ $sql .= " AND ".$key."='".$val"'"; }
} 
```

不确定这是否有效，但理论上这是我首先想到的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T12:05:57.243

感谢那些提供答案的人，但是我使用了问题上方链接中的建议答案，因为它对我来说更清楚。粘贴在下面的示例代码仅供参考：

```
$tmp = "where ";
if($A and $A!="any" and $A!="not used")
$tmp .= "row1 = '".$A."'";
if($B and $B!="any" and $B!="not used")
$tmp .= "AND row2 = '".$B. "'";
if($C and $C!="any" and $C!="not used")
$tmp .= "AND row3 = '".$C."'";
$db_q = "Select * from table $tmp"; 
```

再次感谢，不知道没有 SO 我会在哪里。

# php - 如何在 Magento 的父级中正确显示子块？

> ID：15234167
> 
> 赞同：1
> 
> 时间：2013-03-05T21:11:03.417
> 
> 标签：php, magento, templates

我有以下内容：

**本地.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<layout>

    <default>

        <reference name="root">
            <block type="core/text_list" name="foo" as="foo" translate="label">
                <label>Foo</label>
            </block>
        </reference>

        <reference name="foo">
            <block type="core/template" name="fooblock" template="foo.phtml" />
        </reference>

        <reference name="bar">
            <block type="core/template" name="barblock" template="bar.phtml" />
        </reference>

        <reference name="foo">
            <action method="insert">
                <name>barblock</name>
            </action>
        </reference>

    </default>

</layout> 
```

**foo.phtml**

```
<div>
<h1 style="background-color:yellow">Hello New Reference!</h1>
<div><?php echo $this->getChildHtml() ?></div>
</div> 
```

**bar.phtml**

```
<h1 style="background-color:yellow">Hello New Reference child!</h1> 
```

**1列.phtml**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="<?php echo $this->getLang() ?>" lang="<?php echo $this->getLang() ?>">
<head>
<?php echo $this->getChildHtml('head') ?>
</head>
<body<?php echo $this->getBodyClass()?' class="'.$this->getBodyClass().'"':'' ?>>
<?php echo $this->getChildHtml('after_body_start') ?>
<div class="wrapper">
    <?php echo $this->getChildHtml('global_notices') ?>
    <div class="page">
        <?php echo $this->getChildHtml('header') ?>
        <?php echo $this->getChildHtml('global_messages') ?>
        <?php echo $this->getChildHtml('breadcrumbsContainer') ?>
        <div class="main col1-layout">
            <div class="col-main">
                <h1>Custom package, Primary theme</h1>
                <?php echo $this->getChildHtml('content') ?>
            </div>
        </div>
        <?php echo $this->getChildHtml('footer_before') ?>
        <?php echo $this->getChildHtml('footer') ?>
        <?php echo $this->getChildHtml('before_body_end') ?>
    </div>
</div>
<?php echo $this->getChildHtml('foo') ?>
<?php echo $this->getAbsoluteFooter() ?>
</body>
</html> 
```

这显示如下（查看屏幕截图底部附近）：

http://i.stack.imgur.com/BC9bf.png

如何让屏幕截图中列出的“子块”实际上是第一个子块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:34:28.473

您使用`<reference name="bar">`但布局中没有名称为“bar”的块。您想在“fooblock”中定义“barblock”：

```
<?xml version="1.0" encoding="UTF-8"?>
<layout>

    <default>

        <reference name="root">
            <block type="core/text_list" name="foo" as="foo" translate="label">
                <label>Foo</label>
            </block>
        </reference>

        <reference name="foo">
            <block type="core/template" name="fooblock" template="foo.phtml" />
        </reference>

        <reference name="fooblock">
            <block type="core/template" name="barblock" template="bar.phtml" />
        </reference>

    </default>

</layout> 
```

# wordpress - Caroufredsel 上的第一项应该是 Wordpress 中的当前页面项

> ID：15234168
> 
> 赞同：2
> 
> 时间：2013-03-05T21:11:03.590
> 
> 标签：wordpress, carousel, caroufredsel

我在我的 Wordpress 主题上与 Caroufredsel 合作，其中每个项目都链接到一个帖子（这个轮播总是在这个帖子的顶部。

目前，我的轮播以随机顺序开始，当前具有“ativo”类的项目如何成为第一个开始？

这是我的js：

```
$("#modelos_slider_interna").carouFredSel({
    swipe       : true,
    auto        : false,
    items       : {
        height      : 175,
        width       : "variable",
        start       : "random",
    },
    prev : "#modelos_slider_interna_volta",
    next : "#modelos_slider_interna_vai",
    scroll: 1,

}); 
```

这是php：

```
 <div class="modelos_slider_interna">
      <div id="modelos_slider_interna">
<?php

    global $wp_query;
    $args = array( 'post_type' => 'barco', );
    $loop = new WP_Query( $args );
    $current_id = $wp_query->get_queried_object_id();
    while ( $loop->have_posts() ) : $loop->the_post();
            echo "<div class='modelos_itens_interna ". ( $current_id == $post->ID ? 'ativo' : '' ) ."'><a href='".get_permalink()."'><div class='fader'>";
            $carrosel = rwmb_meta( 'meta_barco_carrosel', 'type=plupload_image&size=');

            foreach ( $carrosel as $thumb )
               {
                  echo "<img src='".get_bloginfo('template_directory')."/inc/timthumb.php?src={$thumb['url']}&h=102&w=175' width='175' height='102' alt='{$thumb['alt']}' />";
               };

            echo "</div>";

            the_title( '<h3>', '</h3>' );

            echo"</a></div>";

    endwhile; ?>
</div>
      <div class="clearfix"></div>
      <a class="prev" id="modelos_slider_interna_volta" href="#"><span>prev</span></a> <a class="next" id="modelos_slider_interna_vai" href="#"><span>next</span></a> </div>
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-05T00:15:25.523

根据文档[http://docs.dev7studios.com/caroufredsel-old/configuration.php#items_object](http://docs.dev7studios.com/caroufredsel-old/configuration.php#items_object)，只需替换以下行：

```
start       : "random", 
```

至：

```
start       : $("#modelos_slider_interna div.ativo"), 
```

# vba - 通过 Microsoft Word 2007 中的 VBA 宏显示右键单击上下文菜单

> ID：15234171
> 
> 赞同：2
> 
> 时间：2013-03-05T21:11:05.827
> 
> 标签：vba, ms-word, contextmenu, office-2007

我想通过 Word 2007 中的 VBA 宏以编程方式显示右键单击上下文菜单。

这将允许我将宏映射到热键并在不离开键盘的情况下显示具有焦点的菜单。我假设这将通过`Application`对象的`CommandBars`集合来完成，按照以下方式访问：

`Application.CommandBars.'access appropriate mehod or member here'`

但我没有看到任何似乎会显示上下文菜单的方法或成员。是否可以通过 VBA 宏来实现这一点？

**编辑：**

正如建议的那样，我遍历每个 CommandBar 并获取名称和索引以尝试找出要使用的 CommandBar 索引：

```
Sub C_RightClick()
'Activates right-click context menu
'

Dim cbar As Office.CommandBar
Dim cbarIndex As Integer
Dim testString As String
Dim cBarsArray(0 To 500)
Dim arrayCounter As Integer

testString = ""
arrayCounter = 1

For Each cbar In CommandBars
    'TRUE if right-click
    'If LCase(cbar.Name) = 'right-click' Then
    '    cbarIndex = cbar.Index
    'End If

    testString = testString + CStr(cbar.Index) + " " + cbar.Name + " " + CStr(cbar.Type = msoBarTypePopup) + vbCrLf
    Debug.Print cbar.Name; " "; cbar.Type = msoBarTypePopup

    'Add name to array and increment counter
    cBarsArray(arrayCounter) = cbar.Name
    arrayCounter = arrayCounter + 1

Next cbar

MsgBox testString

'Application.CommandBars(cbarIndex).ShowPopup

End Sub 
```

但是，我没有看到任何标题为“右键单击”的内容。我认为它可能是 'Standard' ，其索引为 1，但当我尝试访问它时收到错误消息。

如果有人知道选择选项卡时出现在 Word 2007 中的默认右键单击上下文菜单的正确名称`Home`，我们将不胜感激。否则，我会将这个问题提交给 SuperUser 并自行研究。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:19:58.307

尝试类似：

```
Application.CommandBars(100).ShowPopup 
```

参数可以是命令栏索引或标题。

要在命令栏上执行特定命令，请尝试以下操作：

```
Application.CommandBars(100).Controls("Paste").Execute 
```

要将所有命令栏的列表打印到即时窗口：

```
Sub test()
Dim cbar As Office.CommandBar
For Each cbar In CommandBars
    'TRUE if right-click
    Debug.Print cbar.Name; " "; cbar.Type = msoBarTypePopup
Next cbar
End Sub 
```

**编辑：** 在回答您关于通过 HOME 选项卡获得的右键单击菜单的问题时，我认为它是与 CommandBar 不同类型的控件。

为了更好地了解右键菜单名称和索引，我稍微修改了上面的代码。现在尝试将控件添加到每个右键单击菜单。添加的控件的标题是菜单的名称和索引。这些控件是临时的 - 下次打开 Word 时它们就会消失。

```
Sub test()
Dim cbar As Office.CommandBar
Dim ctl As Office.CommandBarControl
For Each cbar In Application.CommandBars
    With cbar
        On Error Resume Next
        'this will delete any customizations
        .Reset
        Set ctl = .Controls.Add(Type:=msoControlButton, Temporary:=True)
        ctl.Caption = .Index & " - " & cbar.Name
        Debug.Print "Name: "; cbar.Name; " Right-click: "; cbar.Type = msoBarTypePopup; " Error descr: "; Err.Description
        On Error GoTo 0
    End With
Next cbar
End Sub 
```

如果有错误消息，它还会将错误消息打印到即时窗口。

我认为您不会对“主页”上下文菜单感到满意的原因是没有添加任何控件。这是添加了控件的菜单图片：

![在此处输入图像描述](../Images/6da2d16f2b60883d9e359c0f7a7b8924.png)

# android - 音量变化监听器：registerMediaButtonEventReceiver 比 onKeyDown 更可取吗？

> ID：15234176
> 
> 赞同：7
> 
> 时间：2013-03-05T21:11:14.923
> 
> 标签：android, broadcastreceiver, android-broadcast, android-audiomanager

寻找一种“最全面和兼容（即所有 Android 版本......）”的方式来收听音量变化，我发现了两种不同的方法来处理这个问题：

1.  [注册媒体按钮事件接收器](https://stackoverflow.com/a/11319772)
2.  [onKeyDown](https://stackoverflow.com/a/11410609) + [SettingsContentObserver](https://stackoverflow.com/a/7017516/725417)

哪种方法更可取？

为什么？

**更新 1：**感谢下面的评论，我发现 onKeyDown() 实际上**接管了**音量键，这可能不是一个完整的解决方案，因为其中一篇文章提到音量可以通过硬件按钮以外的接口更改（不是提到谷歌似乎正在逐渐取消那些“接管”能力）。

OTOH，android.media.VOLUME_CHANGED_ACTION 是一个黑客，[甚至没有记录](http://www.google.com/#hl=en&output=search&sclient=psy-ab&q=%22VOLUME_CHANGED_ACTION%22+site:android.com&oq=%22VOLUME_CHANGED_ACTION%22+site:android.com&gs_l=hp.3...743.743.0.1112.1.1.0.0.0.0.112.112.0j1.1.0.les;..0.0...1c.1.5.psy-ab.dotTrLKxpfA&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&bvm=bv.43148975,d.dmQ&fp=d865acc55386e82d&biw=983&bih=816)。这可能意味着它将在 Android 5 左右[停止工作......](https://stackoverflow.com/a/8974510/725417)

**更新 2：** registerMediaButtonEventReceiver 根本不起作用！（对于*音量硬件按钮*，我只是尝试过）。

额外的见解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T10:06:49.303

`BroadcastReceiver`在未来的 API中为音量流提供 a 会很棒，但今天最好的解决方案可能是`ContentObserver`为设置注册 a（包括 VOLUME_NOTIFICATION）：

```
mSettingsContentObserver = new SettingsContentObserver( new Handler() ); 
this.getApplicationContext().getContentResolver().registerContentObserver( 
    android.provider.Settings.System.CONTENT_URI, true,
    mSettingsContentObserver ); 
```

有关更多信息，请参阅此答案：[https ://stackoverflow.com/a/7017516/117382](https://stackoverflow.com/a/7017516/117382)

编辑：用工作代码更正。也许这个解决方案更好：[https ://stackoverflow.com/a/17398781/117382](https://stackoverflow.com/a/17398781/117382)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-21T11:17:29.300

为了能够收听所有音量流，对我来说最好的方法是使用 ContentObserver。这是我的代码：

```
public class AudioVolumeObserver
{
    public interface OnAudioStreamVolumeChangedListener
    {
        void onAudioStreamVolumeChanged(ArrayList<Integer> audioStreamType);
    }

    public interface OnAudioModeVolumeChangedListener
    {
        void onAudioModeVolumeChanged(int volumeMode);
    }

    private static class AudioVolumeContentObserver
            extends ContentObserver
    {
        private final AudioManager mAudioManager;

        private final OnAudioStreamVolumeChangedListener mVolumeStreamListener;
        private final OnAudioModeVolumeChangedListener mVolumeModeListener;

        private int[] currentVolumeStreams = new int[6];
        private int[] lastVolumeStreams = new int[6];

        private int currentVolumeMode;
        private int lastVolumeMode;

        ArrayList<Integer> changedVolumeStreams = new ArrayList<>();

        public AudioVolumeContentObserver(
                @NonNull
                        Handler handler,
                @NonNull
                AudioManager audioManager,
                @NonNull
                        OnAudioModeVolumeChangedListener volumeModeListener,
                @NonNull
                OnAudioStreamVolumeChangedListener volumeStreamListener)
        {
            super(handler);

            mAudioManager = audioManager;
            mVolumeModeListener = volumeModeListener;
            mVolumeStreamListener = volumeStreamListener;

            lastVolumeMode = mAudioManager.getRingerMode();

            lastVolumeStreams[0] = mAudioManager.getStreamVolume(AudioManager.STREAM_VOICE_CALL);
            lastVolumeStreams[1] = mAudioManager.getStreamVolume(AudioManager.STREAM_SYSTEM);
            lastVolumeStreams[2] = mAudioManager.getStreamVolume(AudioManager.STREAM_RING);
            lastVolumeStreams[3] = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC);
            lastVolumeStreams[4] = mAudioManager.getStreamVolume(AudioManager.STREAM_ALARM);
            lastVolumeStreams[5] = mAudioManager.getStreamVolume(AudioManager.STREAM_NOTIFICATION);

        }

        @Override
        public void onChange(boolean selfChange)
        {
            currentVolumeMode = mAudioManager.getRingerMode();

            currentVolumeStreams[0] = mAudioManager.getStreamVolume(AudioManager.STREAM_VOICE_CALL);
            currentVolumeStreams[1] = mAudioManager.getStreamVolume(AudioManager.STREAM_SYSTEM);
            currentVolumeStreams[2] = mAudioManager.getStreamVolume(AudioManager.STREAM_RING);
            currentVolumeStreams[3] = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC);
            currentVolumeStreams[4] = mAudioManager.getStreamVolume(AudioManager.STREAM_ALARM);
            currentVolumeStreams[5] = mAudioManager.getStreamVolume(AudioManager.STREAM_NOTIFICATION);

            if (currentVolumeMode != lastVolumeMode){
                lastVolumeMode = currentVolumeMode;
                mVolumeModeListener.onAudioModeVolumeChanged(currentVolumeMode);

            }

            changedVolumeStreams.clear();

            for (int i=0; i<6; i++)
                if (currentVolumeStreams[i] != lastVolumeStreams[i])
                {
                    lastVolumeStreams[i] = currentVolumeStreams[i];
                    changedVolumeStreams.add(i);
                }

            if (!changedVolumeStreams.isEmpty()){
                mVolumeStreamListener.onAudioStreamVolumeChanged(changedVolumeStreams);
            }

        }
    }

    private final Context mContext;

    private AudioVolumeContentObserver mAudioVolumeContentObserver;

    public AudioVolumeObserver(
            @NonNull
            Context context)
    {
        mContext = context;
    }

    public void start(@NonNull
                      OnAudioModeVolumeChangedListener volumeModeListener,
                      @NonNull
                      OnAudioStreamVolumeChangedListener volumeStreamListener)
    {
        stop();

        Handler handler = new Handler();
        AudioManager audioManager = (AudioManager) mContext.getSystemService(Context.AUDIO_SERVICE);

        mAudioVolumeContentObserver = new AudioVolumeContentObserver(handler, audioManager, volumeModeListener, volumeStreamListener);

        mContext.getContentResolver()
                .registerContentObserver(android.provider.Settings.System.CONTENT_URI, true, mAudioVolumeContentObserver);
    }

    public void stop()
    {
        if (mAudioVolumeContentObserver == null)
        {
            return;
        }

        mContext.getContentResolver()
                .unregisterContentObserver(mAudioVolumeContentObserver);
        mAudioVolumeContentObserver = null;
    }
} 
```

# .htaccess - 使用 .htaccess 向不同的用户显示不同的页面（通过重定向或其他方式）

> ID：15234178
> 
> 赞同：1
> 
> 时间：2013-03-05T21:11:15.507
> 
> 标签：.htaccess, http, authentication, redirect, web

我正在尝试创建一个具有非常基本的身份验证的活动网站，并向不同的用户显示不同的内容。两种类型的用户：客人和特邀客人。我试图弄清楚是否可以根据经过身份验证的用户将诸如[http://mysite.com/RSVP](http://mysite.com/RSVP)之类的页面重定向到两个位置之一 - [mydomain]/RSVP/form1.html用于“来宾”或 [mydomain]/RSVP/form2.html 用于“特殊来宾”

是否有可能有这样的条件重定向？

# android - 将数据从 Activity 发送到 Service

> ID：15234181
> 
> 赞同：5
> 
> 时间：2013-03-05T21:11:27.620
> 
> 标签：android, android-service

如何将数据从当前发送到在特定时间运行`Activity`的后台类？`Service`我试图进入`Intent.putExtras()`，但我没有在`Service`课堂上得到它

类`Activity`中调用`Service`.

```
Intent mServiceIntent = new Intent(this, SchedulerEventService.class);
        mServiceIntent.putExtra("test", "Daily");
        startService(mServiceIntent); 
```

课堂上的代码`Service`。我很想输入`onBind()`and `onStartCommand()`。这些方法都没有打印值。

```
@Override
public IBinder onBind(Intent intent) {
    //Toast.makeText(this, "service starting", Toast.LENGTH_SHORT).show();

    //String data = intent.getDataString();

    Toast.makeText(this, "Starting..", Toast.LENGTH_SHORT).show();

    Log.d(APP_TAG,intent.getExtras().getString("test"));

    return null;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:22:39.790

你的代码应该是`onStartCommand`. 如果您从不调用`bindService`您的活动`onBind`将不会被调用，并使用`getStringExtra()`而不是`getExtras()`

```
@Override
public int onStartCommand(Intent intent, int flags, int startId)
{
    Toast.makeText(this, "Starting..", Toast.LENGTH_SHORT).show();
    Log.d(APP_TAG,intent.getStringExtra("test"));
    return START_STICKY; // or whatever your flag
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:48:15.750

如果你想传递可以放入 Intent 的原始数据类型，我建议使用 IntentService。要启动 IntentService，请输入您的活动：

```
startService(new Intent(this, YourService.class).putExtra("test", "Hello work"); 
```

然后创建一个扩展 IntentService 类的服务类：

```
public class YourService extends IntentService {

String stringPassedToThisService;

public YourService() {
    super("Test the service");
}

@Override
protected void onHandleIntent(Intent intent) {

    stringPassedToThisService = intent.getStringExtra("test");

    if (stringPassedToThisService != null) {
        Log.d("String passed from activity", stringPassedToThisService);
    // DO SOMETHING WITH THE STRING PASSED
    }
} 
```

# ruby-on-rails - Ruby On Rails - 如何使用来自其正常控制器之外的 form_for 的输出更新模型记录？

> ID：15234182
> 
> 赞同：0
> 
> 时间：2013-03-05T21:11:28.910
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我有一个 Rails 3.2.11 应用程序，在我的视图中有一个名为联系人的联系表单，它刚刚发送了一封电子邮件。逻辑运作良好。现在我们决定使用 PostgreSQL 数据库将表单的内容保存到 ReceivedEmail 模型中。

我将 form_tag 表单更改为 form_for @received_email 表单。这是我的 form_for 视图：

```
<%= form_for(@received_email) do |f| %>
  <p class="radio-buttons">
    <span class="label1"><%= f.label "Select one: (required)" %></span>
    <%= f.radio_button :purpose, '1' %><span class="label2"><%= f.label :purpose_order, 'My Order' %></span>
    <%= f.radio_button :purpose, '2' %><span class="label3"><%= f.label :purpose_special, 'Quote For Special Order' %></span>
    <%= f.radio_button :purpose, '3' %><span class="label4"><%= f.label :purpose_wholesale, 'Wholesale Discounts' %></span>
    <%= f.radio_button :purpose, '4' %><span class="label5"><%= f.label :purpose_church, 'Store/Church Discounts' %></span>
    <%= f.radio_button :purpose, '5' %><span class="label6"><%= f.label :purpose_other, 'General Inquiry' %></span>
  </p><br><br>
  <%= f.label "First Name (required)" %><%= f.text_field :first_name, :minlength => 2, :maxlength => 30, placeholder: "First Name (max. 30)" %><br>
  <%= f.label "Last Name (required)" %><%= f.text_field :last_name, :minlength => 2, :maxlength => 30, placeholder: "Last Name (max. 30)" %><br>
  <%= f.label "Email (required)" %><%= f.text_field :email, :minlength => 2, :maxlength => 60, placeholder: "Valid Email Address (max. 60)" %><br>
  <%= f.label "Order Number" %><%= f.text_field :order, :minlength => 2, :maxlength => 20, placeholder: "Order #  (max. 20)" %><span class="contact-required">Required for My Order</span><br>
  <%= f.label "Business / Organization" %><%= f.text_field :company, :minlength => 2, :maxlength => 30, placeholder: "Business/Organization Name (max. 30)" %><span class="contact-required">Required for Wholesale Discounts & Store/Church Discounts</span><br>
  <%= f.label "Business / Organization Website" %><%= f.text_field :website, :minlength => 2, :maxlength => 70, placeholder: "Company Website (max. 70)" %><br>
  <%= f.label "More Info About You" %><%= f.text_area :about_you, :minlength => 10, :maxlength => 255, placeholder: "More Info About You and/or Your Organization (max. 255.)" %>
  <span class="contact-required">Required for Wholesale Discounts & Store/Church Discounts</span><br>
  <%= f.label "Address (required)" %><%= f.text_field :address, :minlength => 2, :maxlength => 50, placeholder: "Street Address (max. 50)" %><br>
  <%= f.label "City (required)" %><%= f.text_field :city, :minlength => 2, :maxlength => 30, placeholder: "City (max. 30)" %><br>
  <%= f.label "State (required)" %><%= f.text_field :state, :minlength => 2, :maxlength => 30, placeholder: "State/Province (max. 30)" %><br>
  <%= f.label "Postal Code / Zip (required)" %><%= f.text_field :zip, :minlength => 2, :maxlength => 15, placeholder: "Postal/Zip (max. 15)" %><br>
  <%= f.label "Country (required)" %><%= f.text_field :country, :minlength => 2, :maxlength => 30, placeholder: "Country (max. 30)" %><br>
  <%= f.label "Message (required)" %><%= f.text_area :message, :minlength => 10, :maxlength => 255, placeholder: "Message or Project Information (max. 255)" %><br>
  <%= f.submit "Submit" %>
<% end %> 
```

我做的下一件事是对我的控制器代码进行微小的更改：

```
if params[:commit]=='Submit'
  if params[:first_name].blank? || params[:last_name].blank? || params[:address].blank? || params[:city].blank? || params[:state].blank? || params[:zip].blank? || params[:country].blank? || 
     params[:message].blank? || params[:purpose].blank? || params[:email].blank? || params[:email] !~ /\A[\w+\-.]+@[\w\-.]+\.[a-z]+\z/i
    flash.now[:error] = "First Name, Last Name, Address, Email, Address, City, State, Postal Code / Zip, Country and Message are required for all emails.  You must also select an email type."
    render 'contact'
  elsif params[:purpose] == '1' && params[:order].blank?
    flash.now[:error] = "Order Number is required when selecting My Order."
    render 'contact'
  elsif (params[:purpose] == '3' || params[:purpose] == '4') && (params[:company].blank? || params[:about_you].blank?)
    flash.now[:error] = "Business / Organization and More Info About You are required when selecting Wholesale Discounts or Store/Church Discounts."
    render 'contact'
  else
    @received_email = ReceivedEmail.new(params[:received_email])
    if @received_email.save
      begin
        HyperCubeOfLoveMailer.inquiry_email(@received_email).deliver
        flash.now[:success] = "The HyperCube Of Love Team has received your inquiry.  You should receive a confirmation email shortly."
      rescue Net::SMTPFatalError, Net::SMTPSyntaxError, Net::SMTPAuthenticationError => pages_error
        logger.warn pages_error
        flash.now[:notice] = "There was a problem with sending your inquiry to the HyperCube Of Love Team.  Please resubmit your inquiry."
      end   
      redirect_to home_path
    else
      render 'contact'
    end
  end
else
  render 'contact'
end 
```

我将 :received_emails 添加到 config.rb 因为我第一次尝试执行此代码时收到错误消息，指出与模型相关的路由不存在。

下次我尝试执行此代码来创建 ReceiveEmail 记录时，我收到了一个初始化错误，因为它正在寻找 received_emails_controller.rb。

然后我用新视图创建了控制器。在尝试执行此操作后，我得到了一个错误，指出我没有创建视图。然后我创建了创建视图。我只是创建它来看看我最终的结果。它显示了我的创建视图。我知道我不应该做这些事情。

目前唯一的数据库访问权限是为此表单添加记录。我所需要的只是将数据从我的表单移动到记录中并将其添加到模型中。

我对 Rails 命令做了一些检查。我相信我可以为表单上的所有字段做这样的事情来创建记录：

```
ReceiveModel.create(purpose: params[:purpose], first_name: params[:first_name], etc.) 
```

但是我认为也许我可以以某种方式使用 params[:received_email] 进行某种插入，但我不知道该怎么做或者这是否可能。

```
ReceiveModel.create(params[:received_email]) 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:35:28.963

如果我理解正确，控制器代码中已有的结构是处理事情的正确方法：

```
@received_email = ReceivedEmail.new(params[:received_email])
if @received_email.save
  # Send the e-mail 
else
  # Re-show the page because something didn't work
end 
```

但是，由于 Rails 脚手架支持您要做的 90%，因此您可能希望从`rails generate scaffold ContactMessage purpose:integer first_name:string ...`. 这将为您提供创建和查看联系信息的所有代码。然后您可以将生成的_form.html.erb 替换为您自己的表单，并将您的通知电子邮件代码放在ContactMessageController 中。

# iframe - iframe 沙盒正在阻止嵌入对象

> ID：15234184
> 
> 赞同：6
> 
> 时间：2013-03-05T21:11:29.860
> 
> 标签：iframe, sandbox

Hy这里是一个 [示例示例](http://www.ufilme.ro/index/cereri/0-11) 为什么当我使用

```
<IFRAME sandbox="allow-forms allow-scripts" SRC="http://roshare.info/embedx-xcnvxz71l8fb-699x380.html" FRAMEBORDER=0 MARGINWIDTH=0 MARGINHEIGHT=0 SCROLLING=NO WIDTH=699 HEIGHT=400></IFRAME> 
```

沙盒我看不到播放器..我想使用沙盒来阻止弹出窗口但看起来如果我使用它我看不到播放器有没有`allow-objects`？

我在该页面上也有一个无沙箱示例，它可以工作..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T13:59:57.603

你是对的。沙箱将阻止框架内的插件内容。与沙盒的其他方面不同，沙盒中没有启用插件的机制`iframe`。如果您好奇，[http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/#granular-control-over-capabilities有更多细节。](http://www.html5rocks.com/en/tutorials/security/sandboxed-iframes/#granular-control-over-capabilities)

# bash - 在标记字符串之后提取引用的文本

> ID：15234187
> 
> 赞同：2
> 
> 时间：2013-03-05T21:11:42.600
> 
> 标签：bash, sed

我正在寻找一个 sed 配方，它将文件作为输入并输出以下形式的每个匹配项的空格分隔列表：

```
sentinel-string 'stuff-to-match' 
```

例如，如果哨兵字符串是“哨兵”并且文件是：

```
sentinel 'match1' a random ' I don't know and maybe a sentinel 'match2' ''' test 
```

我希望输出为：match1 match2

我一直在尝试构建它，但我对实用程序还不够熟悉，无法完成工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:27:03.510

`Sed`不是用于编辑线条的工具，但在这里您有一种方法：

```
sed -e "
  s/sentinel[ ]*/\n/g
  s/[^\n]*\n'\([^']*\)'[^\n]*/\1 /g
" infile 
```

它是如何工作的？

```
s/sentinel[ ]*/\n/g 
```

在要提取的单词之前插入换行符。所以输入就像：

```
<blank line>
'match1' a random ' I don't know and maybe a 
'match2' ''' test 
```

和

```
`s/[^\n]*\n'\([^']*\)'[^\n]*/\1 /g` 
```

提取那些换行符之后的内容，删除其他所有内容。

它产生：

```
match1 match2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:22:19.750

以这种方式尝试grep：

```
s="sentinel"  
 grep -Po "(?<=$s ')[^']*" inputFile|tr '\n' ' ' 
```

变量`s`存储模式字符串，在您的情况下，它是哨兵字符串。

# android - 如何从 for 循环中保存矩形

> ID：15234198
> 
> 赞同：0
> 
> 时间：2013-03-05T21:12:28.463
> 
> 标签：android, rect

我已将屏幕分成矩形，但我使用的是 aa for 循环，因此我不会将矩形存储在那里每次都重新制作。我将如何将它们存储在数组中？

```
 public void drawGrid() {
    //android.os.Debug.waitForDebugger();
    int height,width;
    int column,row;
    int maxColumn,maxRow;
    maxColumn = 4;
    maxRow = 4;
    column = 0;
    row = 0;
    height = c.getHeight()/maxRow;
    width = c.getWidth()/maxColumn;
    Paint pg = new Paint();
    Rect[] test[];

    for(int i = 0;i < 5; i++) {
        int srcX = column * width;
        int srcY = row * height;
        Rect src =new Rect(srcX,srcY,srcX + width, srcY +height);
        pg.setColor(Color.WHITE);
        pg.setStyle(Paint.Style.STROKE);
        pg.setStrokeWidth(5);
        c.drawRect(src, pg);
        if (column == maxColumn && row == maxRow){
            i = 5;
        } else {i=0;}
        if (column == maxColumn){
            row = row + 1;
            column = 0;
        } else {column = column + 1;}

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:16:32.940

提前分配它们，这样您就不会在绘图操作期间实例化对象。因此，每当您确定所需的矩形数量时（即，如果它始终相同，请在构造函数中初始化它们）。像这样的东西：

```
Rect[] rects = new Rect[rectCount];
for(int i = 0; i < rectCount; i++) rects[i] = new Rect(); 
```

然后，在您的绘图循环中，使用：

```
rects[i].set(srcX, srcY, srcX + width, srcY + height); 
```

您应该尽可能避免在绘制操作期间分配对象。

编辑：对于二维数组：

```
Rect[][] rects = new Rect[rowCount][colCount];
for(int i = 0; i < rowCount; i++) {
    for(int j = 0; j < colCount; j++) {
        rects[i][j] = new Rect();
    }
} 
```

然后在循环中，它是同样的事情：

```
rects[row][col].set(srcX, srcY, srcX + width, srcY + height); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:14:35.353

```
Rect rectArray[] = new Rect[5]; 
```

然后在循环内：

```
rectArray[i] = new Rect(srcX,srcY,srcX + width, srcY +height); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:22:21.737

你总是会有固定数量的矩形吗？您可能想考虑一个数组列表？

```
ArrayList<Rect> rects = new ArrayList<Rect>();
rects.add(new Rect(srcX,srcY,srcX + width, srcY +height)); 
```

你可以用这些东西轻松地做很多有用的东西，这里有一些例子：http: [//javarevisited.blogspot.com.es/2011/05/example-of-arraylist-in-java-tutorial.html](http://javarevisited.blogspot.com.es/2011/05/example-of-arraylist-in-java-tutorial.html)

# haskell - Haskell不能在'<-'之后调用函数？

> ID：15234201
> 
> 赞同：1
> 
> 时间：2013-03-05T21:12:40.303
> 
> 标签：haskell, parse-error

我刚开始使用 Haskell，我无法理解一件事 - 为什么这样的东西不起作用？

```
fun f = f * f
main = 
    do 
        foo <- getLine 
        bar <- getLine
        print (fun 4) 
```

我不断收到来自 ghc 的“输入 `print' 上的解析错误”。但对我来说更神秘的是，它在删除 foo <- getLine 和 bar <- getLine 之后才起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T21:23:34.577

这意味着您正在混合制表符和空格。注意空格对于解析 Haskell 很重要。您的`print`行可能缩进太远（或缩进不够远）。替换所有标签！

编辑：请注意，您发布的代码的复制/粘贴只会使用空格并且可以正常工作。

# asp.net-mvc - ASP.NET 按子域路由到 mvc 或 api

> ID：15234204
> 
> 赞同：1
> 
> 时间：2013-03-05T21:12:50.557
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-web-api, asp.net-routing

我们的应用程序有 2 个域 (www | api).mydomain.com

如何将请求路由到 api.mydomain.com 到 api 控制器和 www 到 mvc 控制器？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:50:01.880

我使用约束解决了我的问题。

这个网站给了我线索：[http ://stephenwalther.com/archive/2008/08/07/asp-net-mvc-tip-30-create-custom-route-constraints.aspx](http://stephenwalther.com/archive/2008/08/07/asp-net-mvc-tip-30-create-custom-route-constraints.aspx)

这是我的实现：

```
public class SubdomainRouteConstraint : IRouteConstraint
{
    private readonly string _subdomain;

    public SubdomainRouteConstraint(string subdomain)
    {
        _subdomain = subdomain;
    }

    public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
    {
        return httpContext.Request.Url != null && httpContext.Request.Url.Host.StartsWith(_subdomain);
    }
} 
```

还有我的路线：

```
 public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
#if !DEBUG
                ,constraints: new { subdomain = new SubdomainRouteConstraint("www") }
#endif
            );
        }

        public static void Register(HttpConfiguration config)
        {
            config.Routes.MapHttpRoute(
                name: "DefaultApi",
#if DEBUG
                routeTemplate: "api/{controller}/{id}",
#else
                routeTemplate: "{controller}/{id}",
#endif
                defaults: new {id = RouteParameter.Optional}
#if !DEBUG
                , constraints: new {subdomain = new SubdomainRouteConstraint("api")}
#endif
                );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:18:26.623

这是一篇博客文章，旨在做你正在谈论的事情。本质上，这个想法是在您定义的路由中定义子域：

[http://blog.maartenballiauw.be/post/2009/05/20/ASPNET-MVC-Domain-Routing.aspx](http://blog.maartenballiauw.be/post/2009/05/20/ASPNET-MVC-Domain-Routing.aspx)

然而，最简单和最明显的方法是简单地创建两个不同的站点。因为，一个是您的网站，一个是您的 API，因此将它们分成不同的项目是有意义的。

# wpf - WPF 窗口中的波浪线

> ID：15234206
> 
> 赞同：2
> 
> 时间：2013-03-05T21:13:02.590
> 
> 标签：wpf

[已经有在FlowDocument](https://stackoverflow.com/questions/632450/wavy-underlines-in-a-flowdocument)和[其他地方](https://stackoverflow.com/questions/633678/wavy-underlines-as-a-textdecoration-what-i-am-doing-wrong)绘制波浪线的解决方案，但它们在将波浪线作为窗口中的普通视觉控件绘制时不太有效。当我尝试第一个链接解决方案时，我得到的是双线而不是单线，而且它也有点苍白。使用厚度值或线条控件只会使情况变得更糟。

使用 VisualBrush 和 Path 的 Line 组合似乎足够复杂，但是当我认为我可能需要使用 DrawingBrush 使用 Pen 使用 VisualBrush 使用 Path 的 Rectangle 时，这完全是太多了。

我也更喜欢纯 C# 的解决方案，因为它是动态生成和使用的。但我也可以使用 XAML 中定义的资源在生成的对象中使用。

# r - 删除 R 中的索引级别

> ID：15234208
> 
> 赞同：0
> 
> 时间：2013-03-05T21:13:13.353
> 
> 标签：r, list

我有一堆结果存储为双向量列表的列表（使用 optim 函数从 for 循环尝试的不同参数列表），因此当我键入 list 时，元素显示如下：

```
[[1]]
        r         k     sigma 
 96.66667 328.66667 396.33333 
.
.
.
.

[[291]]
    r     k sigma 
 97.0 329.8 397.7 
.
.
.
etc 
```

我希望能够访问命名值“r”“k”和“sigma”的最小值和最大值。但是 RI 无法使用 $ 符号或使用引号来访问它们，因为 R 在 lsit 的列表中将每个名称视为唯一的，我尝试使用 unlist 但这将数据变成了 1000 长的向量，我已经尝试过 cbind 但都没有成功。

我将非常感谢任何人可以提供的任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:24:11.107

如果列表的每个元素的大小相同（长度为 3 的向量），那么您可以执行以下操作：

```
do.call(rbind, mylist) 
```

`mylist`您的输出对象列表在哪里。这将创建一个矩阵（或`cbind`代替`rbind`）。

仅抓住其中一个部分的另一种选择是：

```
sapply( mylist, `[`, "r" ) 
```

它将从每个向量中获取“r”元素，并尽可能将其简化为单个向量。将“r”替换为其他名称以获得其他部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T21:21:21.860

您可以通过以下方式将其放入矩阵或数据框中：

```
mtx <- do.call(rbind, object) 
```

您将能够通过以下位置访问单个元素：

```
listname[[291]]   # should return 
   r     k sigma 
97.0 329.8 397.7 
```

# jquery - 单击链接时jQuery切换图像

> ID：15234209
> 
> 赞同：0
> 
> 时间：2013-03-05T21:13:17.140
> 
> 标签：jquery, html, css, jquery-selectors, switching

在这里需要一些帮助。我正在努力实现这一目标：

默认情况下，图像被 css display: none; 隐藏。

例如，当用户单击链接时：vanilla glazed 它将显示与图像 alt“vanilla-glazed”匹配的图像。

然后，如果用户单击另一个链接，例如：布鲁克林停电，它将隐藏活动图像并显示布鲁克林停电图像。

说得通？这是我的 html 标记。

我需要 jQuery 部分的帮助。不知道从哪里开始。

```
<div id="nameWrapper">

<ul>

<li><a href="#" class="vanilla-glazed">vanilla glazed</a></li>
<li><a href="#" class="brookyln-blackout">brookyln blackout</a></li>

</ul>

</div>

<div class="gallery">

<div class="image-wrapper">

<img src="#" alt="brookyln-blackout" />

   <div class="meta">
   <p>description</p>
   </div>

</div>

<div class="image-wrapper">

<img src="#" alt="vanilla-glazed" />

   <div class="meta">
   <p>description</p>
   </div> 

</div>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:30:09.257

你可以试试这样的

```
 $(document).ready(function(){ //on load of the document 
   $("#nameWrapper a").click(function(){ //on a click on a a in your div
       $('.image-wrapper img').hide(); //hide all images (including already hidden ones
       $("img[alt='"+$(this).attr('class')+"']").show(); //show the image with alt value          
   });
}); 
```

见[小提琴](http://jsfiddle.net/2K4VQ/)

# c# - 使用 .Net 运行在 MonoDev 中制作的 gtk# 应用程序

> ID：15234211
> 
> 赞同：0
> 
> 时间：2013-03-05T21:13:22.853
> 
> 标签：c#, .net, monodevelop, gtk#, xamarin

现在我正在尝试学习如何使用 gtk# 和 Xamarin studio，但是在创建 .EXE 之后，我无法使用 .NET 运行它。我对 C# 真的很陌生，我不知道我的程序需要在 .Net 中运行什么，它在 mono 中运行良好，但我想看看它是否可以在没有 mono 的情况下运行。

当我尝试从 cmd 运行 Exe 时，我得到了这个

```
Unhandled Exception: System.DllNotFoundException: Unable to load DLL 'libgtk-win
32-2.0-0.dll': The specified procedure could not be found. (Exception from HRESU
LT: 0x8007007F)
   at Gtk.Application.gtk_init(Int32& argc, IntPtr& argv)
   at Gtk.Application.Init()
   at Notepad.Notepad.Main(String[] args) 
```

我试图创建的程序只是用 gtk# 制作的记事本的克隆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T10:13:56.863

如果您在与用于开发的机器不同的机器上运行 GTK# 应用程序，那么您需要安装以下依赖项才能使您的应用程序完美运行：

1.  您所针对的版本的 .NET Framework 运行时（单声道或毫秒，两者都可以）

2.  GTK# 框架（您可以在这里找到它：http: [//download.xamarin.com/Installer/gtk-sharp-2.12.20.msi](http://download.xamarin.com/Installer/gtk-sharp-2.12.20.msi)）

3.  GTK+ 库：GTK# 是与 GTK+ 的绑定，而不是它的完整端口。[所以你还需要来自http://www.gtk.org/download/win32.php](http://www.gtk.org/download/win32.php)的 GTK+ 库

笔记：

对于第 2 点，您可以选择将 gtk# msi 作为安装包的一部分。如果是 3，您可以下载完整的 gtk+ 包（由 glade 和其他 3rd 方库组成）或仅下载 gtk、gdk、pango 等的单个运行时 dll，以进行极简安装。

# sql - 将行转置为列并连接表

> ID：15234212
> 
> 赞同：6
> 
> 时间：2013-03-05T21:13:24.977
> 
> 标签：sql, sql-server, sql-server-2008, pivot

嗨我有两个表属性，实例

**属性表**

```
id  |    key_info   |   value_info
2   |     amount    |    1009
2   |   currency    |     USD
2   |     Level     |    Level 5
3   |    amount     |     2017 
3   |   currency    |     CAD 
```

**实例表**

```
id   |  status
2    | Pending 
3    | Approved 
```

我想像这样加入两张桌子-

**新表**

```
id | amount |  currrency | level   | status
2  |  1001  |     USD    | Level 5 | Pending
3  |   2017 |     CAD    |         | Approved 
```

Attribute 和 Instance 中的所有字段都是可选的，除了 id。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-05T21:20:26.073

```
select
  a.id,
  max(case when a.key_info = 'amount' then a.value_info end) as amount,
  max(case when a.key_info = 'currency' then a.value_info end) as currency,
  max(case when a.key_info = 'level' then a.value_info end) as level,
  i.status
from
  attribute a
  join instance i on a.id = i.id
group by
  a.id,
  i.status 
```

## [Sql 小提琴](http://sqlfiddle.com/#!2/2ecd66/6)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-05T22:14:49.333

从 SQL Server 2005 开始，该[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)函数可以执行从行到列的这种转换：

```
select id, 
  amount, 
  currency, 
  level,
  status
from 
(
  select i.id, i.status,
    a.key_info,
    a.value_info
  from instance i
  inner join attribute a
    on i.id = a.id
) src
pivot
(
  max(value_info)
  for key_info in (amount, currency, level)
) piv 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/6e689/2)。

如果您的数量未知，`key_values`则可以使用动态 SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(key_info) 
                    from Attribute
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT id, ' + @cols + ', status from 
             (
                select i.id, i.status,
                  a.key_info,
                  a.value_info
                from instance i
                inner join attribute a
                  on i.id = a.id
            ) x
            pivot 
            (
                max(value_info)
                for key_info in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/6e689/4)。两者都给出结果：

```
| ID | AMOUNT | CURRENCY |   LEVEL |   STATUS |
-----------------------------------------------
|  2 |   1009 |      USD | Level 5 |  Pending |
|  3 |   2017 |      CAD |  (null) | Approved | 
```

# algorithm - 资源共享/交易算法

> ID：15234213
> 
> 赞同：1
> 
> 时间：2013-03-05T21:13:25.410
> 
> 标签：algorithm

假设我们有 3 个人，Alice、Bob 和 Charlie。

假设他们每个人都有一个资源，Aplles、Bannanas 和 Coconuts。

他们每个人都有 3 个这种资源。

该算法的目标是进行 1-1 笔交易，以使每笔交易最终得到我们 3 种资源中的每一种。这些交易的清单是我想要获得的。

理想情况下，我想知道如何解决这个问题。但我愿意接受这类问题的名称，或者类似的问题，我可以研究并从中获得想法。

我正在处理的问题将有大约 600 个对象，每个对象有大约 1000 人具有随机数量/类型的起始资源，（假设有足够的资源来满足我们的最终结果）所以理想情况下提供的任何解决方案都是对于这样的规模是可行的。但我会尽我所能，我只需要某种起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T13:42:58.170

ElKamina 和 Tyler Durden 的回答都不错，但他们似乎没有考虑到 Kuriso 想要进行 1-1 交易，人们可能拥有多种商品，以及多种商品单位。我有一个天真的解决方案。

我认为原来的例子有点过于简单了，所以让我们再举一个：

```
 c1 c2 c3 c4
A 5  0  1  0
B 0  1  0  1
C 0  6  2  0 
```

其中 A,B,C 是人，c1,c2,c3,c4 是商品。

首先，让我们计算理想的分布，这很容易做到：对于每种商品，用东西的总和除以人数，四舍五入，每个人都得到：

```
 c1 c2 c3 c4
A 1  2  1  0
B 1  2  1  0
C 1  2  1  0 
```

现在让我们定义一个 WANT 函数，表示人 X 需要多少东西 c 才能进入理想位置：WANT(X,c) = IDEAL(c) - Xc。

```
 c1  c2  c3  c4 sum
A -4  2   0   0  -2
B  1  1   1   0   3
C  1 -4  -1   0  -4 
```

让我们按照他们的需求总和列出一个人的列表。让我们以最富有的人为例，即需求最低的人，在这种情况下为 C，让我们尝试通过将他与最能提供他最想要的商品的人匹配来满足他的需求。如果他们可以进行交易，很好，如果不能，继续直到我们找到匹配（最终保证匹配）。在这个例子中，C 需要 c1；提供c1最多的是A，对商品进行迭代，我们发现A需要c2，而C确实有剩余c2，所以他们交换了它们。更新他们在列表中的位置，如果他们不再有任何需要，则将其删除。重复这个直到没有人有任何需求。这不会产生适当的平等分配，但他们可以通过 1 交易获得平等。

这确实是一个幼稚的解决方案，根据启发式方法，最富有的人最有机会提供东西以换取他需要的商品。复杂性很高，但是对于有序列表，它应该可以针对您指定的数字进行管理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T01:29:32.837

假设您总共有 x1 个种类 1、...、xn 个种类 n 的资源。

假设您有 k 个人，并且每个人都有（或需要分别以 y1、y2、...、yk 资源结束。

现在，选择一个人 i 并分配给他最流行的资源。一旦分配完成，减少相应的 xj s （即如果资源 j 分配给 i，则减少 xj）。

不断重复，直到分配完所有资源。

这是最均匀地分配东西的方法。它假设您不关心交易的顺序，而是关心最终结果本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:36:52.943

为了重申这一点，假设您有一组这样的列表：

{ 1, 1, 1 }
{ 2, 2, 2 }
{ 3, 3, 3 }

并且你想交换不同集合中的元素，直到你有这样的集合：

{ 1, 2, 3 }
{ 1, 2, 3 }
{ 1, 2, 3 }

现在，您可能会注意到，如果我们将这些列表视为单个矩阵，那么一个矩阵就是另一个矩阵的逆矩阵。您可以通过交换 1-2-3 对角线来执行此反转。

所以列表 1 中的项目 2 与第 2 行中的项目 2 交换，列表 1 中的项目 3 与列表 3 中的项目 1 交换，最后列表 2 中的项目 3 与列表 3 中的项目 2 交换。

总结一下：通过对角线交换来进行矩阵求逆。

# three.js - 将场景阴影渲染到纹理（纹理烘焙）

> ID：15234215
> 
> 赞同：6
> 
> 时间：2013-03-05T21:13:28.530
> 
> 标签：three.js

有谁知道如何在threejs中渲染阴影贴图？我的场景中有一个地形网格，而不是让所有对象在地形上投射阴影，我希望我可以将一个不错的阴影贴图渲染到应用于网格的纹理上。

有没有人知道如何实现这一点 - 或者可能有一些关于我可以应用于三个主题的文档？

** 编辑 ** 只是为了澄清以供将来参考，我想知道是否有任何技术可用于渲染/烘焙纹理，这些纹理以后可以作为制服应用于网格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-02T15:18:33.700

看看他的例子： [http ://threejs.org/examples/#webgl_materials_lightmap](http://threejs.org/examples/#webgl_materials_lightmap)

你所追求的在threejs中被称为“光照贴图”，在其他地方它们也被称为遮挡纹理/贴图。

[编辑] 可以使用其他工具（例如 Blender）从几何体烘焙光照贴图：[https ://blender.stackexchange.com/questions/13956/how-do-you-bake-ambient-occlusion-for-一个模型](https://blender.stackexchange.com/questions/13956/how-do-you-bake-ambient-occlusion-for-a-model)

# javascript - 标签内的不同字体

> ID：15234216
> 
> 赞同：0
> 
> 时间：2013-03-05T21:13:29.593
> 
> 标签：javascript, html, css, mxml

如果我有诸如“1234B”、“5678M”之类的标签……如何更改此标签，使末尾的字母小于数字的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:27:30.117

最简单的方法是使用`small`元素（这在 HTML5 中仍然是允许的，尽管使用了人为的“语义”，但对于浏览器来说它仍然意味着更小的字体大小）：

```
1234<small>B</small> 
```

然后，您可以使用 CSS 来调整字体大小的缩小，例如使用

```
small { font-size: 80%; } 
```

然而，这会产生印刷不良的结果，因为不同的字体大小意味着不同的笔画宽度，所以字母看起来也会更细，而且更小。在排版中，人们可能会使用字体的小型大写字形（尽管在排版中，人们通常宁愿尝试使数字和字母在大小上匹配，而不是不匹配！）。原则上这在网页上也是可能的（使用`font-feature-settings: "smcp"`, 带前缀），尽管仍然很少见，并且它需要具有此类可用字形的字体（如 Calibri、Cambria 或 Palatino Linotype）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:14:50.283

```
<p>1234<span class="smaller">B</span></p>

.smaller {
    font-size: 5px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:30:43.760

沃森有它........但让我认为**CMS在思考**......如果你只想小写唯一的字母并且数字保持不变，你可以这样做：

HTML：

```
 <div style="text-transform: lowercase;">3529M</div> 
```

或者

```
<div class="lowMe">3529M</div>
<div class="lowMe">5546D</div> 
```

CSS：

```
.lowMe {text-transform: lowercase} 
```

否则我会像提到的那样做跨度......

# iphone - 如何禁用整个 iPhone 应用程序主视图的圆角？

> ID：15234217
> 
> 赞同：9
> 
> 时间：2013-03-05T21:13:30.780
> 
> 标签：iphone, ios

运行我的 iPhone 应用程序时，应用程序的整个 UI 都有圆角（即状态栏下方的区域）。UI 是使用故事板设置的，它不显示圆角。如何关闭圆角？我在我的方法中尝试了以下`AppDelegate's` `didFinishLoading`方法：

```
[self.window.layer setCornerRadius:0.0]; 
```

但这没有任何区别。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-08T07:37:01.453

尝试使用此代码。

```
self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease]; 
```

它可能会删除圆角半径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T02:56:05.733

这是 iOS 本身的一部分。一种解决方法是创建一个全屏应用程序并这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-13T21:18:46.517

以编程方式，在主视图控制器中，在 viewWillLoad() 上，可能会执行以下操作：

```
viewController.view.layer.cornerRadius = 0; 
```

可能会工作......希望如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-18T11:22:20.057

尝试使用您选择的角创建一个基础视图控制器，并从基础继承剩余的视图控制器。我认为这可能有效。

# google-app-engine - GAE - 对索引属性的查询性能

> ID：15234218
> 
> 赞同：0
> 
> 时间：2013-03-05T21:13:40.783
> 
> 标签：google-app-engine, google-cloud-datastore

如果我有一个具有索引属性的实体，比如“名称”，那么 == 对该属性的查询的性能会如何？

当然，我知道不可能有确切的答案，但是性能与`name == x`某些 x 的实体总数、数据存储中的实体总数等有何关联？

`name == x`如果我有 1000 个名称等于 x 的实体与 100 个实体相比，查询会慢多少？是否对此进行了任何类型的基准测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:57:51.560

我的一些不是很费力的测试表明响应时间随着返回的结果数量大致线性增加。请注意，即使您有 1000 个实体，如果您在查询中添加 limit=100，它的执行效果也会与您只有 100 个实体相同。

这与表明性能随返回的实体数量而变化的文档一致。

当我说不是很费劲时，我的意思是响应时间到处都是，而且这是一个非常非常粗略的估计。在同一个请求上，我经常会看到性能上有一个数量级的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T03:30:54.040

AppEngine 以一种非常优化的方式进行查询，因此从性能的角度来看，您是否对 name 属性进行查询与仅使用键进行批处理获取几乎无关紧要。两者都将与返回的实体数量呈线性关系。存储在数据库中的实体总数没有区别。但是，产生微小差异的是数据库中出现的“名称”的不同值的数量（因此，返回的 1000 个实体几乎比返回的 100 个实体慢 10 倍）。

完成此操作的方法是通过与您的数据一起存储的索引（或首选索引）。“名称”属性的索引由一个表组成，该表具有按字母顺序排序的所有名称（如果您在任何查询中使用降序排序，则第二个按字母倒序排序），然后查询将简单地找到您要在表中查询的名称的第一次出现并开始按顺序返回结果。这称为“扫描”。

这个视频有点技术性，但它详细解释了这一切是如何工作的，如果你担心编码以获得最佳性能，可能是一个很好的时间投资：

[Google I/O 2008：在 Google App Engine 数据存储的掩护下](https://sites.google.com/site/io/under-the-covers-of-the-google-app-engine-datastore)

（视频质量很差，但他们也有在线幻灯片（见上面的视频链接））

# android - Android、PARTIAL_WAKE_LOCK 和睡眠模式

> ID：15234219
> 
> 赞同：0
> 
> 时间：2013-03-05T21:13:47.510
> 
> 标签：android, connection, sleep, keep-alive

我编写了一个包含一个活动和远程服务的应用程序。该服务的主要目标是与远程 TCP 服务器保持网络连接。我在活动 PARTIAL_WAKE_LOCK 中使用以防止系统进入睡眠模式。但是大约二十分钟后，屏幕关闭后，连接停止。看起来它不幸地启动了睡眠模式并切断了连接。当我打开我的设备连接再次开始（我的代码检测到错误并尝试再次设置连接）。是一种更好的方式来保持连接吗？我不必担心电池 - 该设备一直在充电。优先级是保持连接。有人可以建议如何解决我的问题吗？

问候阿蒂克

# linux - ARM926 USB 电源管理

> ID：15234221
> 
> 赞同：2
> 
> 时间：2013-03-05T21:14:00.607
> 
> 标签：linux, usb, arm, power-management

我有一些基于 Atmel ARM926 400MH 的入门套件板。由 linux 提供支持。

我需要控制USB的电源，即关闭它并关闭它。

我尝试研究使用 sysfs，但没有关于打开/关闭的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T05:58:36.673

您要么无法控制 USB 电源，要么操作系统会为您控制它。[正如此评论](https://stackoverflow.com/a/8631997/1821972)中所指出的，“......用户不应该意识到这一层。”</p>

端口电源可能被硬连线始终存在，但更多时候硬件允许驱动程序控制。我见过的一个例子是，通过 3320 USB PHY 的主机端口应该由 CPEN 输出自动启用端口电源。

2.6.32 内核中引入的运行时电源管理框架增强了该区域。详细信息可能取决于 SoC 和特定的板支持。新功能可以允许用户空间控制，以防止自动挂起和导致断电；否则，默认情况下，USB 应在挂起模式下断电。

更多信息在[Regupathy](https://rads.stackoverflow.com/amzn/click/com/1435457862)。

# linux - Linux 内核分配缓存以删除 const 警告

> ID：15234222
> 
> 赞同：0
> 
> 时间：2013-03-05T21:14:01.117
> 
> 标签：linux, memory-management, module, kernel

我的目标是在内核模块中编写一个允许获取 root 访问权限的函数。在最初的时候我有这个：

```
struct task_struct *cur_task;
struct cred *credz;
/*obtain root access*/
cur_task=current;
credz=cur_task->cred;
credz->uid=0;
credz->gid=0;
credz->suid=0;
credz->sgid=0;
credz->euid=0;
credz->egid=0; 
```

它有效，但我尝试删除有关 const 变量的警告。所以我尝试使用 memcopy 绕过它。但我有一个内核恐慌。

我认为我的错误是内存分配（kmem 缓存）

```
static struct kmem_cache *cred_jar; //global

char func(void){
        struct task_struct *cur_task;
        const struct cred *old;
        struct cred *credz;

        cred_jar = kmem_cache_create("cred_jar", sizeof(struct cred), 0, SLAB_HWCACHE_ALIGN|SLAB_PANIC, NULL);
        credz = kmem_cache_alloc(cred_jar, GFP_KERNEL);
        if (!credz){

            return 0;
        }
        /* obtain root access in shell*/
        cur_task=current;
        /**/
        old = cur_task->cred;

        /* remove warning const */
        memcpy(credz, old, sizeof(struct cred));
        credz->uid=0;
        credz->gid=0;
        credz->suid=0;
        credz->sgid=0;
        credz->euid=0;
        credz->egid=0; 
        cur_task->cred=credz;
        kfree(old);
} 
```

如果您有任何想法来纠正它，我很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:23:35.617

我认为它被标记为的原因`const`是你不应该更改或替换它，因此内核恐慌

# php - PHP 自提交表单在 FF 和 Chrome 中有效，但在 IE 中无效（404 错误）

> ID：15234229
> 
> 赞同：0
> 
> 时间：2013-03-05T21:14:24.407
> 
> 标签：php, forms

我有点难过。我一直在拉我的头发来解决这个问题。PHP 自提交表单在 Fire Fox 和 Chrome 中运行良好，但是当我在 IE 中尝试时，我收到 404 错误。

这是我的表单标签：

```
<form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>"
    name="New Policy/Procedure Form" id="form_name">

//content

<input type="submit" value="submit" id="submit" name="submit" /> 
```

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:16:13.007

你应该`PHP_SELF`在引号内加上：`$_SERVER['PHP_SELF']`; 如果您的错误报告设置允许 PHP 生成它通常为此所做的通知，那将毁了您的一天。

此外（但不太可能），可以想象`$_SERVER['PHP_SELF']`包含一些用于 HTML 标记的“红旗”字符。每当您在 HTML 中嵌入非固定值时，都应**始终**使用，包括在这种情况下：`htmlspecialchars`

```
action="<?php echo htmlspecialchars($_SERVER[PHP_SELF]); ?>" 
```

[`htmlspecialchars`](http://php.net/manual/en/function.htmlspecialchars.php)还有其他参数，它们的默认值在大多数情况下都是可以的（但并非总是如此）。您应该检查它们并明确指定它们。

# objective-c - 在调用 popToRootViewController 方法之前将数据发送回 rootviewcontroller？

> ID：15234234
> 
> 赞同：1
> 
> 时间：2013-03-05T21:14:59.857
> 
> 标签：objective-c, uiviewcontroller, viewcontroller

在调用 popToRootViewControllerAnimated 方法之前将数据发送回根视图控制器的最佳方法是什么？我试图向 rootviewcontroller 发出当前视图控制器不再存在的信号，并记录通过 segue 推送的视图控制器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:26:09.380

您不能等到当前视图控制器“不再存在”。虽然当前视图控制器确实存在，但根视图控制器是当前视图控制器的`navigationController.viewControllers[0]`. 所以你有你需要的参考从这个发送消息到那个。只需转换到根视图控制器的类，现在您可以在根视图控制器中调用任何公共方法，例如

```
MyRootViewController* rvc = (MyRootViewController*)(self.navigationController.viewControllers[0]);
rvc.coolData = myCoolData; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:20:06.197

有两种基本方法可以做到这一点：1）使用 NSNotification 消息或 2）使用委托调用。有很多关于如何编码两者的教程。我写了一个小的委托教程作为这个问题的答案：[iPhone 应用程序中的后退按钮](https://stackoverflow.com/questions/10272843/back-button-in-iphone-app/10273551#10273551)，您可以在这里找到一个很棒的 NSNotification 教程：[通过 Objective-C 中的 NSNotificationCenter 发送和接收消息？](https://stackoverflow.com/questions/2191594/send-and-receive-messages-through-nsnotificationcenter-in-objective-c)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:20:54.147

您可以继承 UINavigationController 并覆盖必要的方法来跟踪您的数组。我建议为从堆栈中弹出的每个视图控制器保留一组唯一的标题。至于向当前视图控制器发出前一个视图控制器不存在的信号，这就是`-viewWillAppear`目的。如果您需要更细粒度的控制，请为您的视图控制器实例创建一个协议，以符合导航控制器从堆栈中弹出一个或多个实例时调用的协议。

# c# - 对 List 和打印值的反思

> ID：15234236
> 
> 赞同：8
> 
> 时间：2013-03-05T21:15:13.960
> 
> 标签：c#, reflection

我写了一个接受泛型参数的方法，然后打印它的属性。我用它来测试我的网络服务。它正在工作，但我想添加一些我不知道如何实现的功能。我想打印列表的值，因为现在它只写 System.Collection.Generic.List1 这是预期的。

到目前为止，这是我的代码，这适用于基本类型（int、double 等）：

```
static void printReturnedProperties<T>(T Object)
{ 
   PropertyInfo[] propertyInfos = null;
   propertyInfos = Object.GetType().GetProperties();

   foreach (var item in propertyInfos)
      Console.WriteLine(item.Name + ": " + item.GetValue(Object).ToString());
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T21:32:29.110

你可以这样做：

```
 static void printReturnedProperties(Object o)
    {
        PropertyInfo[] propertyInfos = null;
        propertyInfos = o.GetType().GetProperties();

        foreach (var item in propertyInfos)
        {
            var prop = item.GetValue(o);

            if(prop == null)
            {
                Console.WriteLine(item.Name + ": NULL");
            }
            else
            {
                Console.WriteLine(item.Name + ": " + prop.ToString());
            }

            if (prop is IEnumerable)
            {
                foreach (var listitem in prop as IEnumerable)
                {
                    Console.WriteLine("Item: " + listitem.ToString());
                }
            }
        }

    } 
```

然后它将枚举任何 IEnumerable 并打印出各个值（我每行打印一个，但显然，您可以做不同的事情。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T21:17:23.870

可以通过 indexer 属性检索列表中的元素`Item`。这个属性接受一个索引参数（有一个`PropertyInfo.GetValue`接受`object`数组的重载，就像`MethodInfo.Invoke`）并返回那个位置的对象。

```
int index = /* the index you want to get here */;
PropertyInfo indexer = Object.GetProperty("Item");
object item = indexer.GetValue(Object, new object[] { index }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T21:18:48.537

`,`我通常在每个项目之间打印一个列表。

为了方便起见，我创建了一个简单的扩展方法：

```
public static class ListEx
{
    public static string StringJoin<T>(this IEnumerable<T> items)
    {
        return string.Join(", ", items);
    }
} 
```

将该方法称为`myList.StringJoin()`.

您当然可以修改方法以`string.Join`直接使用另一个分隔符 och 调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:32:31.180

这是一个片段，假设您的 List 是 T 型。

```
 foreach (PropertyInfo item in propertyInfos)
            {
                Object obj = item.GetValue(object,null);
                if (!obj.GetType().IsValueType)
                {
                    if (obj.GetType() == typeof(String))
                    {
                        Console.WriteLine(obj.ToString());
                    }
                    else if (obj.GetType() == typeof(List<T>))
                    {
                        //run a loop and print the list

                    }
                    else if (obj.GetType().IsArray) // this means its Array
                    {
                        //run a loop to print the array
                    }

                }
                else
                {
                    //its primitive so we will convert to string 
                    Console.WriteLine(obj.ToString());

                } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-05T21:40:51.293

我想你想要这样的东西：

```
public class Program
{
    public static void PrintProperties<T>(T t)
    {
        var properties = t.GetType().GetProperties();

        foreach (var property in properties)
        {
            var name = property.Name;
            var value = property.GetValue(t, null);

            if (property.PropertyType.IsGenericType && property.PropertyType == typeof(IEnumerable<>))
            {
                var formatList = typeof(Program).GetMethod("FormatList", new[] { value.GetType() });

                // value.GetType().GetGenericArguments().First() will get you the underlying type of the list,
                // i.e., the TItemType where the property you are currently
                // handling is of type IEnumerable<TItemType>
                formatList.MakeGenericMethod(value.GetType().GetGenericArguments().First());

                value = formatList.Invoke(null, new object[] { value });

                Console.Out.WriteLine(name + ": " + value);
            }
            else
            {
                Console.Out.WriteLine(name + ": " + value);
            }
        }
    }

    public static string FormatList<TPlaceholder>(IEnumerable<TPlaceholder> l)
    {
        return string.Join(", ", l);
    }
} 
```

该代码未经测试，但基本上，与标量值相比，您希望以不同的方式处理可枚举类型，因此一旦您遇到 type 的某些内容`IEnumerable<TItemType>`，您就可以调用该`FormatList<TPlaceholder>`方法。

现在，请记住，您的原始`T`和`TItemType`不一定相同。当您使用反射调用 FormatList 时，您希望将其绑定`TPlaceholder`到`TItemType`. 完成后，您只需调用格式化方法并将列表的实际实例传递给它，它会返回一个字符串。然后你可以输出那个字符串。

希望有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-06T18:04:09.853

大量借鉴上述示例，这是我的完整解决方案。这已经过测试并通过打印出每个元素的属性来处理传入的 IEnumerable。它不是递归的，但很容易添加。

请注意，上述许多示例都会因索引属性（例如列表）而崩溃。 [property.GetValue() 中的参数计数不匹配](https://stackoverflow.com/questions/31835823/parameter-count-mismatch-in-property-getvalue)。

通过使用这一位 LINQ 过滤具有索引属性的属性，可以避免这种情况。

```
Where(x=>!x.GetIndexParameters().Any()) 
```

下面是扩展方法形式的完整示例。

```
 /// <summary>
    /// Returns string representation of object property states i.e. Name: Jim, Age: 43
    /// </summary>
    public static string GetPropertyStateList(this object obj)
    {
        if (obj == null) return "Object null";

        var sb = new StringBuilder();
        var enumerable = obj as IEnumerable;

        if (enumerable != null)
        {
            foreach (var listitem in enumerable)
            {
                sb.AppendLine();
                sb.Append(ReadProperties(listitem));
            }
        }
        else
        {
            sb.Append(ReadProperties(obj));
        }

        return sb.ToString();
    }

    private static string ReadProperties(object obj)
    {
        var sb = new StringBuilder();
        var propertyInfos = obj.GetType().GetProperties().OrderBy(x => x.Name).Where(x=>!x.GetIndexParameters().Any());

        foreach (var prop in propertyInfos)
        {
            var value = prop.GetValue(obj, null) ?? "(null)";
            sb.AppendLine(prop.Name + ": " + value);
        }

        return sb.ToString();
    } 
```

# python - 需要用 facebook.py 列出所有朋友

> ID：15234237
> 
> 赞同：3
> 
> 时间：2013-03-05T21:15:23.563
> 
> 标签：python, facebook, facebook-graph-api

[我使用来自： https](https://github.com/pythonforfacebook/facebook-sdk) ://github.com/pythonforfacebook/facebook-sdk的 facebook.py

我的问题是：我不知道使用来自 graph.get_object("me/friends") 的 next-url

```
graph = facebook.GraphAPI(access_token)
friends = graph.get_object("me/friends") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-20T16:00:15.713

如果您在`/me/friends`Graph [API Explorer](https://developers.facebook.com/tools/explorer?method=GET&path=me%2Ffriends)中输入内容，您会看到它返回一个 JSON 文件，该文件只是字典和列表的组合。

例如，输出可能是：

```
{
  "data": [
    {
      "name": "Foo", 
      "id": "1"
    }, 
    {
      "name": "Bar", 
      "id": "1"
    }
  ], 
  "paging": {
    "next": "some_link"
  }
} 
```

此 JSON 文件已转换为 Python 字典/列表。在外部字典中，键`data`映射到字典列表，其中包含有关您朋友的信息。

所以要打印你的朋友列表：

```
graph = facebook.GraphAPI(access_token)
friends = graph.get_object("me/friends")
for friend in friends['data']:
    print "{0} has id {1}".format(friend['name'].encode('utf-8'), friend['id']) 
```

这`.encode('utf-8')`是为了正确打印出特殊字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-10-05T23:10:19.963

上述答案具有误导性，因为 Facebook 已禁止`graph`用户获取好友列表，**除非好友也安装**了该应用程序。

看：

```
graph   = facebook.GraphAPI( token )
friends = graph.get_object("me/friends")
if friends['data']:
  for friend in friends['data']:
    print ("{0} has id {1}".format(friend['name'].encode('utf-8'), friend['id']))
else:
  print('NO FRIENDS LIST') 
```

# c++ - 将函数作为参数传递以简化线程创建

> ID：15234245
> 
> 赞同：1
> 
> 时间：2013-03-05T21:15:59.703
> 
> 标签：c++, multithreading, function, parameters, g++

我正在尝试编写一小段代码，使使用 CreateThread() 看起来更简洁。我不能说我真的打算使用它，但我认为对于像我这样的新程序员来说，这将是一个有趣的小项目。这是我到目前为止所拥有的：

```
#include <iostream>
#include <windows.h>
using namespace std;

void _noarg_thread_create( void(*f)() )
{
    cout << "Thread created...\n" << endl;
    Sleep(10);
    CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)f, NULL, 0, NULL);
}

template <typename T>
void _arg_thread_create( void(*f)(T), T* parameter)
{
    cout << "Thread created...\n" << endl;
    Sleep(10);  
    CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)*f, parameter, 0, NULL); 
}

void printnums(int x)
{
    for(int i = x; i < 100; i++)
    {
        cout << i << endl;
    }
}

void printnumsnoarg()
{
    for(int i = 0; i < 100; i++)
    {
        cout << i << endl;
    }
}

int main()
{
    cin.get();
    _noarg_thread_create( &printnumsnoarg );
    cin.get();
    int x = 14;
    _arg_thread_create( &printnums, &x );
    cin.get();
} 
```

基本上，我有两个函数将为 CreateThread 调用两个不同的预设：一个用于线程中需要参数时，一个用于线程中不需要参数时。我可以用 g++ 编译器（cygwin）编译它，它运行没有任何错误。第一个线程被正确创建并按预期打印出数字 0-99。但是，第二个线程不会打印出任何数字（使用此代码，它应该打印 14-99）。我的输出如下所示：

```
<start of output> 

$ ./a.exe

Thread created...

0     
1
2   
3
.
.
.        
97
98   
99

Thread Created...

<end of output> 
```

任何想法为什么第二个线程不能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:22:58.967

你实际上似乎错过了你正在传递一个指向你的`printnums(int x)`函数的指针。由于`x`main 函数中的存储位置将远大于 100，因此您的循环永远不会运行。

您应该尝试更改`printnums`为：

```
void printnums(int *x)
{
    for(int i = *x; i < 100; i++)
    {
        cout << i << endl;
    }
} 
```

我想那时一切都会按预期进行。

# osx-snow-leopard - 在 OSX 上使用没有 Java7u9 的 JavaFX - Snow Leopard

> ID：15234254
> 
> 赞同：0
> 
> 时间：2013-03-05T21:16:14.293
> 
> 标签：osx-snow-leopard, javafx

我想在我的一个项目中使用 JavaFX。我知道它是自带的`Java7-Update9`，但我使用的机器最多只支持`Java7-Update2`. （这是一个`OSX-Snow Leopard`）

有没有人有关于如何做到这一点的建议？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:41:03.170

[JavaFX 是适用于 Windows、OS X 和 Linux 的 Oracle Java for Java 7 update 6 及更高版本的一部分](http://www.oracle.com/technetwork/java/javase/downloads/index.html)。

[JavaFX 2.2 目前可作为 Windows 的单独下载，](http://www.oracle.com/technetwork/java/javafx/downloads/index.html)用于某些不包括 JavaFX 的 Java 版本（更新 6 之前的 Java 6 和 Java 7 版本）。

JavaFX 不适用于 OS X 10.6 (Snow Leopard)。

JavaFX 不适用于 OS X 或 Linux 的 Java 7 update 6 之前的 Java 版本。

（这个答案是指当前的 JavaFX 2+ 版本，而不是过时的 JavaFX 1.x 版本 - 不建议使用过时的版本）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T07:39:12.037

虽然我无法验证这一点（我不知道如何使用 JavaFX），但我知道可以在 Mac OS X 10.6（Snow Leopard）上强制安装最新的 Java 7（更新 14）： [如何安装 java jdk 7 雪豹](https://stackoverflow.com/questions/13536667/how-to-install-java-jdk-7-on-snow-leopard)

# java - Java 蛇游戏的类未编译

> ID：15234255
> 
> 赞同：2
> 
> 时间：2013-03-05T21:16:15.540
> 
> 标签：java

请找到我正在尝试创建的蛇游戏的一些源代码：

```
package Snake;

import java.awt.*;
import Snake.GameBoard.*;

public enum TileType {
  SNAKE(Color.GREEN),
  FRUIT(Color.RED),
  EMPTY(null),

  private Color tileColor;

  private TileType(Color color) {
    this.tileColor = color;
  }

  // @ return

  public Color getColor() {
    return tileColor;
  }

  private TileType[] tiles;

  public void GameBoard() {
    tiles = new TileType[MAP_SIZE * MAP_SIZE];
    resetBoard();
  }

  //  Reset all of the tiles to EMPTY.

  public void resetBoard() {
    for(int i = 0; i < tiles.length; i++) {
      tiles[i] = TileType.EMPTY;
    }
  }

  // @ param x The x coordinate of the tile.
  // @ param y The y coordinate of the tile.
  // @ return The type of tile.

  public TileType getTile(int x, int y) {
    return tiles[y * MAP_SIZE + x];
  }

  /**
   * Draws the game board.
   * @param g The graphics object to draw to.
   */
  public void draw(Graphics2D g) {

    //Set the color of the tile to the snake color.
    g.setColor(TileType.SNAKE.getColor());

    //Loop through all of the tiles.
    for(int i = 0; i < MAP_SIZE * MAP_SIZE; i++) {

      //Calculate the x and y coordinates of the tile.
      int x = i % MAP_SIZE;
      int y = i / MAP_SIZE;

      //If the tile is empty, so there is no need to render it.
      if(tiles[i].equals(TileType.EMPTY)) {
        continue;
      }

      //If the tile is fruit, we set the color to red before rendering it.
      if(tiles[i].equals(TileType.FRUIT)) {
        g.setColor(TileType.FRUIT.getColor());
        g.fillOval(x * TILE_SIZE + 4, y * TILE_SIZE + 4, TILE_SIZE - 8, TILE_SIZE - 8);
        g.setColor(TileType.SNAKE.getColor());
      } else {
        g.fillRect(x * TILE_SIZE + 1, y * TILE_SIZE + 1, TILE_SIZE - 2, TILE_SIZE - 2);
      }
    }
  }
} 
```

很多这样的工作正常。但是，在它显示“私有颜色 tileColor；”的地方，我收到“我收到 '令牌 tileColor 的语法错误'，请删除令牌”，但是当我删除它时，它会在我的 IDE 上导致更多的红色（我使用 Eclipse）。

此外，每当 MAP_SIZE 和 TILE_SIZE 出现时，它表示它们无法解析为变量，尽管它们存在于以下类中：

包蛇；

```
public class GameBoard {
  public static final int TILE_SIZE = 25;
  public static final int MAP_SIZE = 20;
} 
```

在同一个包中，因此编译器应该很容易找到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:18:06.653

你需要一个分号：

```
SNAKE(Color.GREEN),
FRUIT(Color.RED),
EMPTY(null); <-- 
```

这是必需的，因为`enums`它包含的不仅仅是常量定义。从[文档](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)

> 当存在字段和方法时，枚举常量列表必须以分号结尾。

* * *

`MAP_SIZE`并且`TILE_SIZE`无法解决，因为它们存在于不同的类中，`GameBoard`. 这里有 2 个选项：

*   使用限定名称，即`GameBoard.MAP_SIZE`&`GameBoard.TILE_SIZE`

*或者*

*   `enums`可以实现接口：制作`GameBoard`接口并*实现**接口*。然后变量将成为成员变量。

# html - 如何使用 HTML 增加 SVG 文件的大小

> ID：15234262
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:16:37.397
> 
> 标签：html, image, svg

我用 Inkscape 创建了一个 SVG 图像，但我无法使用 HTML 使它更大
SVG是在*HTML*之外创建的，而不是在*HTML*代码本身中，我没有使用
<SVG> 标签
我使用了一个 <img> 标签

```
<img src='images/picture.svg' \/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:20:32.733

您应该能够像对任何其他图像一样设置它的样式。所以这样的事情应该有效：

```
img {
  height: 100px;
  width: 100px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T03:52:30.303

步骤 1) 在页面上制作 SVG 元素——无论你嵌入了它，无论是 inline 、`<svg>`还是——你想要它的大小。`<img>``<object>``<embed>`

步骤 2) 在 SVG 元素上设置[`viewBox`属性](https://developer.mozilla.org/en-US/docs/SVG/Attribute/viewBox)以定义应缩放的内容区域以填充空间。

# apache-modules - Apache模块在头部插入文本

> ID：15234263
> 
> 赞同：2
> 
> 时间：2013-03-05T21:16:40.290
> 
> 标签：apache-modules

对这件事很生气。我在这里尝试做一件非常简单的事情。

我尝试在 Apache 模块中的 html 文件的开头插入一个字符串，代码很简单。

```
apr_bucket* txt_esc(apr_bucket_alloc_t* alloc ) 
{
    return apr_bucket_transient_create("ggggggggggggggg", 15, alloc) ;
}

apr_status_t add_string(ap_filter_t *f, apr_bucket_brigade *pbbIn)
{    
    APR_BRIGADE_INSERT_HEAD(pbbIn, txt_esc(f->r->connection->bucket_alloc));           
    return ap_pass_brigade(f->next, pbbIn);        
} 
```

问题是我可以在头部插入字符串，但与此同时，html文件末尾的字符串大小相同的内容将被截断。

有人知道为什么会这样吗？此 Apache 服务器作为代理运行。

# java - 如何从同一个类中的方法调用servlet？

> ID：15234265
> 
> 赞同：0
> 
> 时间：2013-03-05T21:16:43.417
> 
> 标签：java, servlets, methods

如何从方法调用 servlet？
一种方法是通过按钮启动的，我希望该方法启动 servlet 但是，我遇到了困难，因为它是一个 servlet？我希望 setRc 调用 doGet，而后者又调用 processRequest。

```
public class rc extends HttpServlet {

public void setRc(String rc) throws ServletException, IOException {
    rc test = new rc();
    test.doGet(null, null);
    this.rc = rc;
}

public String getRc() {
    return rc;
}

@Override
public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    System.out.println("FROM doGet");
    response.setContentType("text/xml");
     //this is where the debugger quits...
    PrintWriterout = response.getWriter();
    processRequest(request, response);
    setRc(rc);
}

public void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    name = request.getParameter("rc");
    IP = request.getRemoteAddr();
    FileWriter fstream = new FileWriter("C:\\commands\\IPLog\\IP.txt");
    BufferedWriter txt = new BufferedWriter(fstream);
    txt.write(IP);
    txt.close();
    Process p = Runtime.getRuntime().exec("c:\\commands\\psexec \\\\" + IP + "  -s -i     C:\\Windows\\System32\\mstsc.exe /v:" + name);
} 
```

}

```
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="style.css">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Index</title>
    </head>
    <body>
        <jsp:useBean id="info" scope="session" class="org.mypackage.WebTools.info" />
        <jsp:setProperty name="info" property="info" />
        <jsp:useBean id="hinv" scope="session" class="org.mypackage.WebTools.hinv" />
        <jsp:setProperty name="hinv" property="hinv" />
        <jsp:useBean id="rc" scope="session" class="org.mypackage.WebTools.rc" />
        <jsp:setProperty name="rc" property="rc" />
        <jsp:useBean id="remx" scope="session" class="org.mypackage.WebTools.remx" />
        <jsp:setProperty name="remx" property="remx" />
        <jsp:useBean id="SOne" scope="session" class="org.mypackage.WebTools.SOne" />
        <jsp:setProperty name="SOne" property="SOne" />

        <b><font color="blue">Please Enter your Full Name here:</font></b><br>
        <form name="frm" method="get" action="rc.java">
            <table border = "0">
                <tr align="left" valign="top">
                    <td>First Name:</td>
                    <td><input type="text" name ="name" /></td>
                </tr>
                <tr align="left" valign="top">
                    <td></td>
                    <td><input type="submit" value="submit"/></td>
                </tr>
            </table>
        </form>
        <%--   --%>     

        <table border="1">
            <tbody>
                <tr>
                    <td><a href="http://intranet/SITES/UBOX/SUPPORTUNITS/ITG/Pages/Default.aspx?cm_re_o=JPRr%20ZBFwCjCaB5%20WzM%20C%20mA55Byf%20JEbflCjCGa7"><img src="UBLogo.jpg" class ="ublogo" alt="UBLogo"/></a></td>
                    <td><strong>RDWeb</strong><a href="https://mpsc-dcs-util1/RDWeb/Pages/en-US/Desktops.aspx"><img src="RD.png" class ="rd" alt="UBLogo"/></a></td>
            </tbody>
        </table>

        <table border="1">
            <thead>
                <tr><th colspan="2">Welcome to Web Tools</th><br>
            <th colspan="2">${UserDetails.displayName0}
                <br>${UserDetails.Full_User_Name0}</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <form name="info" action="index.jsp">
                    Enter the UB ID, User Name or Computer Name:</td>
            <td><input type="text" name="info" />
                <input type="submit" value="OK" />
                </form>
            </td>
            <td><strong>Contact Details: </strong></td>
            <td><strong>Email: </strong><a href="mailto:${UserDetails.mail0}">${UserDetails.mail0}</a>
                <br><strong>IM: </strong><a href="im:<sip:${UserDetails.givenName0}.${UserDetails.sn0}@uboc.com>">${UserDetails.givenName0} ${UserDetails.sn0}</a>
                <br><strong>phone:</strong>${UserDetails.telephoneNumber0}              

                <br><span style="font-size:smaller; font-style:italic;">
                    <em>last login: ${UserDetails.Login_Date}</em></span></td>
        </tr>
        <tr>
            <td><strong>AD Site</strong></td>
            <td><strong>${UserDetails.AD_Site}</strong></td>
            <td><strong>Computer</strong></td>
            <td><strong>PC: ${UserDetails.Computer_Name}</strong>
                <br><strong>OS: ${UserDetails.Network_Operating_System0}</strong>
                <br><strong>IP: ${UserDetails.IP_Address}</strong></td>
        </tr>
        <tr>
            <td>
                <form name="hinv" action="index.jsp" />
                Hardware Inventory:<input type="submit" value="${UserDetails.Computer_Name}" onsubmit=jsp:setProperty name="hinv"/>
                </form>
            </td>
            <td>
                <form name="rc" action="index.jsp" />
                Remote Control:<input type="submit" value="${UserDetails.Computer_Name}" onsubmit=jsp:setProperty name="rc"/>
                </form>               
            </td>
            <td>
                <form name="remx" action="index.jsp" />
                RemX_OKillX.exe:<input type="submit" value="${UserDetails.Computer_Name}" onsubmit=jsp:setProperty name="remx"/>
                </form>
            </td>
            <td>
                <form name="SOne"  action="index.jsp" />
                5685-SourceOne.exe:<input type="submit" value="${UserDetails.Computer_Name}" onsubmit=jsp:setProperty name="SOne"/>
                </form>
            </td>
        </tr>
    </tbody>
</table>
<br>
<table border="1">
    <tbody>
        <tr>
            <c:forEach var="columnName" items="${result.columnNames}">
                <th><c:out value="${columnName}"/></th>
            </c:forEach>
        </tr>
        <!-- column data -->
        <c:forEach var="row" items="${result.rowsByIndex}">
            <tr>
                <c:forEach var="column" items="${row}">
                    <td><c:out value="${column}"/></td>
                </c:forEach>
            </tr>
        </c:forEach>
    </tbody>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:28:59.653

```
 RequestDispatcher reqDisp = new RequestDispatcher("index.jsp");
    reqDisp.forward(request,response);
    or 
    reqDisp.forward(request,response);

or other way is
response.sendRedirect("/url to call"); 
```

## 请求调度程序

forward 方法将请求的控制权传递给另一个 servlet 或 jsp，而不告诉任何关于请求分派到客户端浏览器的信息。因此客户端浏览器不知道返回的资源是否来自另一个 servlet/jsp。

## 发送重定向

方法停止对请求的进一步处理，并在响应标头中发送 http 状态代码“301”和要重定向到客户端浏览器的位置的 URL。将重定向相关的 HTTP 标头发送到客户端浏览器后，服务器无法控制此请求。客户端浏览器看到 http 状态 301，然后它知道它应该向服务器设置的“Location”http 标头中的 url 发送一个新请求。客户端浏览器向新 URL 发送一个新请求，服务器会将其作为另一个正常请求进行处理。

因此请求调度完全发生在服务器端。但是 sendRedirect 是通过客户端浏览器处理的。

# php - 如何将下拉选择值发送到另一个页面我有代码但我无法获取下拉选择值

> ID：15234266
> 
> 赞同：-2
> 
> 时间：2013-03-05T21:16:48.230
> 
> 标签：php, javascript, jquery

如何将下拉选择值发送到另一个页面我有代码但我无法将下拉选择值发送到另一个页面？我想将大小值发送到另一个页面`header('location:shoppingcart.php?size='.$sizes.'');`也不起作用。我已经尝试过表单操作..当我使用而不是它的工作时出现问题`size form`，但功能不起作用？`addtocart not working``button``submit button``button``submit button` `add to cart`

我可以`$_POST['size']`在不提交表单的情况下将值发送到另一个页面吗？

* *javascript **

```
<script language="javascript">
function addtocart(id){
document.form1.id.value=id;
document.form1.command.value='add';
document.form1.submit();
}
</script> 
```

**php代码**

```
$sizes=$_POST['size'];
include("cart/functions.php");
if($_REQUEST['command']=='add' && $_REQUEST['id']>0){
$id=$_REQUEST['id'];
addtocart($id,1);
header('location:shoppingcart.php?size='.$sizes.'');    
exit();
} 
```

**加入购物车的表格 1**

```
<form name="form1" method="post">
<input type="hidden" name="id" />
<input type="hidden" name="command" />
</form> 
```

**尺寸表**

```
<form action="" id="size1" name="size1" method="post">
<div class="details clearfix">
<p class="item">
<label style="font-family:Arial,Helvetica,sans-serif; font-size:12px; font-weight:bold; ">Choose your size:</label>
<select style="background-color:#CCC" name="size" id="size" >
<option>Select</option>
<option value="Small">Small</option>
<option value="Medium">Medium</option>
<option value="Large">Large</option>
<option value="XL">XL</option>
</select>
</div> 
```

**添加到购物车按钮**

```
<div class="buy">
<?php 
$query3=mysql_query("select * from products WHERE id='$id' ");
$row3=mysql_fetch_array($query3);
?>
<input type="button" class="button1" value="Add To Cart" >
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:51:40.420

如果您只想在下拉值更改后立即将数据发送到其他页面，那么您可以尝试使用 jQuery：

```
$("#size").change(function(){
  var dropdown_val=$(this).val();
  $.post("shoppingcart.php", { size:dropdown_val},function(data){
   console.log(data);
} );
}); 
```

在 shoppingcart.php 方面，您可以收到价值`$_POST['size']`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-05T21:24:50.640

使用动作事件

```
<form action="process.php" id="size1" name="size1" method="post"> 
```

我不知道这是一个学校项目还是你正在做的一些奇怪的事情，或者只是非常早期的阶段，但整个页面的编写方式看起来很奇怪。

# php - 如何在 php 变量中使用 if 语句？

> ID：15234270
> 
> 赞同：0
> 
> 时间：2013-03-05T21:17:01.287
> 
> 标签：php, html

我正在使用 ajax 在单击“卡片”时调用文件以显示对话框。它与 php 的普通 html 一样工作得很好，但现在我已经将它保存为 php 变量，它不喜欢 if 语句，并且下拉菜单总是显示默认的“选择”选项。这可以做到吗？或者也许我只是写错了？

```
$html.="<select name='priority'>";
$html.="<option>---Choose---</option>";
$html.="<option if ($priority == 'Low') echo 'selected' value='Low'>Low</option>";
$html.="<option if ($priority == 'Normal') echo 'selected' value='Normal'>Normal</option>";
$html.="<option if ($priority == 'High') echo 'selected' value='High'>High</option>";
$html.="<option if ($priority == 'Critical') echo 'selected' value='Critical'>Critical</option>";
$html.="</select>"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:18:54.460

应该这样做：

```
$html .= "<option " .
         (($priority == 'Low') ? 'selected' : '') .
         " value='Low'>Low</option>"; 
```

不使用三元运算符：

```
$html .= "<option ";

if ($priority == 'Low') {
    $html .= 'selected';
}

$html .= " value='Low'>Low</option>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:23:00.990

你可能忘记了区别。双引号中的所有内容都是字符串。用三元试试：

```
 $priority = "Normal";
        $html = "";

        //Use from here
        $html .= "<select name='priority'>";
        $html.="<option>---Choose---</option>";
        $html.="<option ";
        $html.= (($priority == 'Low') ? 'selected' : '');
        $html.=" value='Low'>Low</option>";
        $html.="<option ";
        $html.=(($priority == 'Normal') ? 'selected' : '');
        $html.=" value='Normal'>Normal</option>";
        $html.="<option ";
        $html.=(($priority == 'High') ? 'selected' : '');
        $html.=" value='High'>High</option>";
        $html.="<option ";
        $html.=(($priority == 'Critical') ? 'selected' : '');
        $html.=" value='Critical'>Critical</option>";
        $html.="</select>";
        echo $html;
        exit; 
```

经测试！

# vtd-xml - 使用 VTD-XML 查找给定元素的命名空间

> ID：15234271
> 
> 赞同：1
> 
> 时间：2013-03-05T21:17:02.803
> 
> 标签：vtd-xml

对于我的应用程序，我只需要确定根节点的命名空间，所以理想情况下我想执行一个操作来获取这个命名空间。

`/*/namespace::*`我的代码使用 XPath 来获取所有声明的命名空间（

我确定我在这里遗漏了一些明显的东西，但是获取给定元素的名称空间的最佳方法是什么，因为 xmlns: 属性不在 getAttrValNS 中考虑？

```
String elementName = vn.toRawString(vn.getCurrentIndex());

String prefix = prefix(elementName);
String localName = localName(elementName);

QName rootQName;
if (prefix == null) {
    rootQName = new QName(localName);
} else {
    int nsIndex = vn.getAttrValNS("xmlns", prefix);

    // Can't find index because xmlns attributes are not included

    String namespace =  vn.toRawString(nsIndex);
    rootQName = new QName(namespace, localName);
} 
```

是否有一个简单的 XPath 只会给我根节点的名称空间，而不是根节点上声明的所有名称空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T02:34:10.857

```
AutoPilot ap = new AutoPilot(vn);
ap.selectXPath("namespace-uri(.)");
String ns = ap.evalXPathToString(); 
```

# c - Printf 结果为负

> ID：15234272
> 
> 赞同：3
> 
> 时间：2013-03-05T21:17:12.253
> 
> 标签：c, negative-number

我是编程新手，我试图让我的程序采用给定的数字，将其加倍，然后在用户输入的任何天数内继续加倍。我做了这个循环，它可以工作，但最终的数字是负数。我不确定如何阻止它出现负面影响，并希望能提供任何帮助。

```
int main(void)
{

    int d;
    int s;
    float a;

    do
    {
        printf ("Please enter the amount of days in the month: ");
        d = GetInt();   
    } while (d > 31 || d < 28);

    do 
    { 
        printf("Please enter the amount of pennies you start will start with: ");
        s = GetInt();
    } while( s < 0);

    do 
    {    
        s = s * 2;
        d = d - 1;
        a = s / 100.0;
        printf("%f\n", a);

    } while(d > 0);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:00:30.737

问题在这里：

```
s=s*2; 
```

（尽管您应该确保*始终*初始化变量，例如`s=0`在循环之前。）

当数字大于存储类型时，整数没有特殊值，因此它们会[溢出](https://en.wikipedia.org/wiki/Integer_overflow)。

这是一个可能发生的例子。想象一下，我们将整数存储为一系列 4 位，其中第一位表示数字为负数。如果我们然后开始在我们的系统中计数，我们会得到以下信息：

```
0000 = 0
0001 = 1
0010 = 2
0011 = 3
0100 = 4
0101 = 5
0110 = 6
0111 = 7
1000 = -0
1001 = -1
1010 = -2 
```

因此，您可以看到数字在计算机内部不断增长，但是当最高有效位被翻转时，它们转换为的内容突然变为负数。

计算机使用各种不同的方案来存储负数，但二进制[补](https://en.wikipedia.org/wiki/Two%27s_complement)码很常见。它比我在这里用来解释事物的系统更聪明，但要点保持不变：当数字变得太大时，它们就会变成负数。在`int`交叉点的情况下，通常是在您点击`2^31`或 2147483648 时。

一种解决方法是使用`unsigned int`，它大约使您可以表示的最大数字翻倍，或`long`, `long long`, `unsigned long`, 或`unsigned long long`。请记住，这不会解决您的问题，它只会为您提供更大的数字，您可以在问题出现之前使用。

[`limits.h`](http://www.cplusplus.com/reference/climits/)您可以使用头文件找到最大的可用值；因为`int`它是`INT_MAX`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:06:36.973

```
2^31 = 2147483648 
```

如果超过 30 天，即使从 1 美分开始并将值加倍，您也会溢出一个整数。如果您从大量便士开始，您会更快溢出。

当整数溢出时，它显示为负值。根据下面的建议，它是未定义的行为。这是程序员使用的术语，新手不太了解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T03:06:28.423

C标准第6.5p5节：

> 如果在计算表达式期间出现异常情况（即，如果结果未在数学上定义或不在其类型的可表示值范围内），则行为未定义。

这说明任何`int`大于`INT_MAX`或小于的表达式`INT_MIN`都会导致问题。这些问题没有定义，所以你无法处理它们；最好避免这样的事情。在您的情况下，如上所述，计算包含负值。但是，这不是必需的。也许如果你要在不同的系统上用不同的编译器编译和运行它，你的程序可能会崩溃，或者它可能看起来像预期的那样工作，以某种方式在有限的存储空间中表示无限的值集，或者一只鸡可能无头跑了几分钟...谁知道呢？

您可以通过仔细选择具有更广泛范围的类型来避免此问题，正如其他答案中所涵盖的那样，并在您的输入上强制执行一个上限，这样就不会出现溢出。另一种方法是使用不应该溢出的任意精度算术库，例如[GNU MP Bignum 。](http://gmplib.org/)

# vb.net - 用于 VB.NET 的类似 Codemaid 的工具

> ID：15234273
> 
> 赞同：0
> 
> 时间：2013-03-05T21:17:14.147
> 
> 标签：vb.net, visual-studio-2010, code-formatting

我曾经在 C# 中做很多工作，但最近我担任了 VB.NET 开发人员的新角色。当我在做 C# 时，我真的很喜欢 CodeMaid 作为一个自动格式化工具。有没有类似 VB.NET 的工具（因为 CodeMaid 不支持 VB.NET）？我无法在搜索中找到任何东西（无论如何都是免费的......）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T11:32:41.130

我听到了您的请求.. 我们向 CodeMaid 添加对 VB 的支持怎么样？:)

VB 支持现在可在此处进行 beta 测试：[https ://bitbucket.org/s_cadwallader/codemaid/downloads/CodeMaid_v0.5.7.4_BETA.vsix](https://bitbucket.org/s_cadwallader/codemaid/downloads/CodeMaid_v0.5.7.4_BETA.vsix)

试一试，如果您发现问题或有建议，请在 gmail 上向 codemaid 发送消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:29:07.460

我建议尝试[ReSharper](http://www.jetbrains.com/resharper/)。它几乎支持您可以在 Visual Studio 中使用的任何语言。它可能不是免费的，但您应该试一试。

要快速“自动格式化”文本，您可以选择文件中的所有文本并使用此快捷方式：

`Ctrl`+ `K`, `Ctrl`+`F`

根据您的 Visual Studio 格式化指南自动格式化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T15:22:08.670

VB.NET 强制您必须在 C# 中进行大部分格式化，即代码自动格式化。对于其他一切，几乎没有开发工作。您不需要任何工具。

*资料来源：4 年以上的专业 VB.NET 开发人员。*

# java - 试图获得未售出的地段

> ID：15234276
> 
> 赞同：1
> 
> 时间：2013-03-05T21:17:20.380
> 
> 标签：java, jakarta-ee

我的代码是这样的，但是我遇到了未售出的问题。我不想为 lotNumber 输入一个 int，因为我想显示所有未售出的批次。

我哪里做错了？

```
public ArrayList<Lot> getUnsold()
{  
   for(Lot lot : lots) 
   {
    Bid highestBid = lot.getHighestBid();
    lotNumber = lot.getNumber();
    Unsold = new ArrayList<Lot>();
      if (highestBid != null) 
        {

            System.out.println("Lot number " + lotNumber + " is sold"); //retuern "Sold" is highestBid
        }
      else
        {
            System.out.println(lotNumber); //print bidder and highest bid value
        }
   }
   return Unsold;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:21:44.030

您需要`Unsold`在 for 循环之前实例化（应该未售出）。而且您没有在块`Unsold`列表中添加任何内容。`else`您需要将该批次添加到`Unsold`块中`else`。

```
//assuming you are passing `lots` as parameter
    public List<Lot> getUnsold(List<Lot> lots)
    {  
       List<Lot> unsold = new ArrayList<Lot>();
       for(Lot lot : lots) 
       {
        Bid highestBid = lot.getHighestBid();
        lotNumber = lot.getNumber();
          if (highestBid != null) 
            {

                System.out.println("Lot number " + lotNumber + " is sold"); //retuern "Sold" is highestBid
            }
          else
            {
                System.out.println(lotNumber); //print bidder and highest bid value
                unsold.add(lot); // you are missing this
            }
       }
       return unsold;
    } 
```

# javascript - javascript继承的对象在分配上创建了新的数据成员？

> ID：15234277
> 
> 赞同：0
> 
> 时间：2013-03-05T21:17:22.687
> 
> 标签：javascript, inheritance, prototypal-inheritance

我们有一个如下所示的代码：

```
var Product = function(){

    }
Product.prototype = 
    {
                GetName: function(){
            return this.name;
        },

        name: "something"
    };

var Apparel = function(){

    }

Apparel.prototype = Object.create(Product.prototype);

var jeans = new Apparel();
console.log(jeans.name);
console.log(jeans.GetName());

jeans.name = "Levis";
console.log(jeans.name);
console.log(jeans.GetName()); 
```

输出：Levis Levis

所以，一切正常！但是，问题是，一旦我们执行了 jeans.name = "Levis" 分配，我们就会在调试器中看到 TWO 'name's。一个用于父产品，一个用于服装。这不是浪费内存吗？由于 name 是父级的一个属性，我希望这个属性会被使用，而不是一个新的被创建。

关于为什么的任何想法？

谢谢

里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:17:22.687

实际上，当我完成打字时，我意识到了答案：以这样的方式行事实际上是非常聪明的 Javascript。如果 Product 会受到 Apparel 更改的影响，那么任何 Product 派生对象的所有后续实例都将携带任何派生对象的最后更改。

因此，原型继承语言需要它

谢谢大家，现在清楚了。里奥

# javascript - Google map api v3 在单击外部元素时显示信息窗口

> ID：15234278
> 
> 赞同：1
> 
> 时间：2013-03-05T21:17:23.223
> 
> 标签：javascript, jquery, google-maps-api-3

我有一个功能性 gmap，当我单击标记时，它会显示标记并显示信息窗口。现在，当我悬停与该标记相关的列表项时，我想显示一个信息窗口。我已经测试了很多东西，但信息窗口从不显示。

我的物品是这样的`<li class="shop" data-shop="markerId">`

还有我的js：

```
function initShopsMap(shops, myLatlng) {
    createMap('map-canvas', myLatlng);

    var infoWindow = new google.maps.InfoWindow();

    for (var i = 0, length = shops.length; i < length; i++) {
        var data = shops[i],
            latLng = new google.maps.LatLng(data.latitude, data.longitude); 

        // Creating a marker and putting it on the map
        var marker = new google.maps.Marker({
            position: latLng,
            map: map,
            id: data.id,
            name: data.name,
            slug: data.slug,
            infoWindow: infoWindow
         });

        (function(marker) {
            // Attaching a click event to the current marker
            google.maps.event.addListener(marker, 'click', function(e) {
                infoWindow.setContent(marker.name + ' ' + marker.slug);
                infoWindow.open(map, marker);
            });
                    //hover list item when hover a marker
            google.maps.event.addListener(marker, 'mouseover', function(e) {
                //todo scroll to
                $('.shop[data-shop="'+marker.id+'"]').addClass('active');
            });
            google.maps.event.addListener(marker, 'mouseout', function(e) {
                $('.shop[data-shop="'+marker.id+'"]').removeClass('active');
            });
        })(marker, data);
    }
} 
```

如何添加`$('.shop[data-shop="'+marker.id+'"]')`显示相关信息窗口的事件？

编辑：解决的问题`google.maps.event.trigger(markers[myPoint-1], "click");`与 IIFE 配合得很好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:26:07.947

我认为[这个答案](https://stackoverflow.com/a/15150047/2110460)可能是您正在寻找的。

不要使用 href 属性，而是使用 mouseover 事件来调用 show 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:44:31.190

使用 setter 属性来获得正确的参考，我认为标记 id 不会为它工作

```
add_markers: function(_locations,no_click){

        var handler = this;
        var map_options = handler.options;

        var infowindow =  new google.maps.InfoWindow({
            content: ''
        });

        //add markers
        for (var i = 0; i < _locations.length; i++) {

            var marker = new google.maps.Marker({
            /////////////////////////////change tootip info here///////////////////////////////////////
                setter: i,
                title: _locations[i].address,
                position: new google.maps.LatLng(_locations[i].lat, _locations[i].lon),
                map: map
            });
            var marker_icon = new google.maps.MarkerImage(map_options.offc_icon.image);
            marker_icon.size = new google.maps.Size(map_options.offc_icon.width, map_options.offc_icon.height);
            marker_icon.anchor = new google.maps.Point(map_options.offc_icon.iconanchor[0],map_options.offc_icon.iconanchor[1]);
            marker.setIcon(marker_icon);

            handler.marker_initializer(marker, map, infowindow, "<p>"+ _locations[i].address + "</p>",no_click);  
        }
    },
    ////Set Marker
    marker_initializer: function(marker, map, infowindow, html,no_click) {

        var handler = this;

        if(!no_click)
        google.maps.event.addListener(marker, 'click', function() {
            lender_model.show_lenders(marker.setter);
        }); 
        google.maps.event.addListener(marker, 'mouseout', function() { 
            infowindow.close(); 
        }); 
    }, 
```

# opengl - Nvidia 驱动程序上的“out can't be used with non-varying”着色器编译错误，英特尔工作正常，AMD 有另一个错误

> ID：15234281
> 
> 赞同：9
> 
> 时间：2013-03-05T21:17:34.780
> 
> 标签：opengl, glsl

我尝试使用以下顶点着色器程序运行一个简单的 OpenGL 3 应用程序：-

```
in vec4 vPosition;
out vec2 otexcoord;

uniform mat4 modelview;
uniform mat4 projection;

void main()
{
    gl_Position = projection * modelview * vPosition;
    otexcoord.s = vPosition.x;
    otexcoord.t = vPosition.y * -1.0;
}; 
```

我已经在来自不同公司的 3 个 GPU 上运行此代码，结果不同。

*   使用英特尔的驱动程序，没有错误，并且运行良好。
*   使用 Nvidia 的驱动程序，错误是“out can't be used with non-variable otexcoord”。
*   使用 AMD 的驱动程序，错误是“GL3 前向兼容上下文不支持隐式版本号 110”

AMD 的似乎是最不明显的。事实上，我对此一无所知。

下面是一些查询字符串

*   英特尔：OpenGL 3.2.0 - 构建 9.17.10.2932 GLSL 1.50 - 构建 9.17.10.2932
*   Nvidia：OpenGL 3.2.0 GLSL 1.50 NVIDIA 通过 Cg 编译器
*   AMD：OpenGL 3.2.12002 核心配置文件上下文 9.12.0.0 GLSL 4.20

英特尔和英伟达的类似，都是 GLSL 1.50 编译器。AMD 是 GLSL 4.20

下面是问题：-

1.  在英特尔和英伟达的编译器之间，哪一个在这种情况下工作正常？
2.  AMD 编译器的错误信息到底是什么意思？我需要什么来纠正错误。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-05T21:39:31.447

您必须始终使用[#version 指令](http://www.opengl.org/wiki/Core_Language_%28GLSL%29#Version)。如果您不这样做，那么编译器将假定您的意思是 GLSL 版本 1.10。这意味着这`out`不是一个有效的关键字。

# ios - 创建没有箭头并在 UIViewController 中居中的 PopOver

> ID：15234282
> 
> 赞同：5
> 
> 时间：2013-03-05T21:17:38.603
> 
> 标签：ios, objective-c, size, uipopovercontroller

我正在尝试在横向方向的 ipad 中心显示 PopOver。我现在可以使用下面的代码执行此操作，但它没有与情节提要上链接的“popOverViewController”关联的属性。我希望它成为故事板上的视图，以便我能够对其进行处理和编辑。以及能够将其大小更改为 ipad 全视图的 50% 或 75% 并且没有箭头...

拜托，任何事情都会有所帮助。*更新代码....现在可以设置大小。但仍然没有看到“popOverViewController”的内容。

```
self.popOverViewController = [[PopOverViewController alloc]init];
self.popOver = [[UIPopoverController alloc]
                            initWithContentViewController:self.popOverViewController];
CGSize size = CGSizeMake(400.0,300.0);
[self.popOver setPopoverContentSize:size];
CGRect rect = CGRectMake(self.view.frame.size.width/2, self.view.frame.size.height/2, 1, 1);
[self.popOver presentPopoverFromRect:rect inView:self.view permittedArrowDirections:0 animated:YES]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-02T06:48:49.273

只需复制并粘贴以下代码

```
UIViewController *popovercontroller=[[UIViewController alloc] init];
UIView *popoverView=[[UIView alloc] initWithFrame:CGRectMake(312,390, 400, 344)];
popoverView.backgroundColor=[UIColor whiteColor];

popovercontroller.contentSizeForViewInPopover=CGSizeMake(400, 300);

UIDatePicker *pickerView = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 44, 400, 0)];
[pickerView setTintColor:[UIColor blackColor]];
[pickerView addTarget:self action:@selector(dueDateChanged:) forControlEvents:UIControlEventValueChanged];

pickerView.datePickerMode = UIDatePickerModeDate;
pickerView.hidden = NO;
NSString *bs ; //= [NSString alloc];
//    //NSDate *newDate = [NSData alloc];
bs =  CurrentSelectedDate;
if (bs.length >= 1) {
    NSDateFormatter* dateFormatter = [[NSDateFormatter alloc] init] ;
    //        //[dateFormatter setDateStyle:NSDateFormatterLongStyle];
    //        [dateFormatter setTimeStyle:NSDateFormatterNoStyle];
    [dateFormatter setDateFormat:@"dd-MMM-yyyy"];
    // NSDate *myDate = [dateFormatter dateFromString: txtText.text];
    pickerView.date = [dateFormatter dateFromString: CurrentSelectedDate];

}
else
{
    pickerView.date = [NSDate date];
}
[popoverView addSubview:pickerView];

// pickerView.date = [dateFormatter dateFromString:txtText.text];
UIToolbar *pickerToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 400, 44)];
pickerToolbar.barStyle = UIBarStyleDefault;
pickerToolbar.barTintColor=[UIColor colorWithRed:150.0f/255.0f green:91.0f/255.0f blue:129.0f/255.0f alpha:1.0f];

[pickerToolbar sizeToFit];
self.navigationController.toolbar.barTintColor = [UIColor colorWithRed:150.0f/255.0f green:91.0f/255.0f blue:129.0f/255.0f alpha:1.0f];
NSMutableArray *barItems = [[NSMutableArray alloc] init];

UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:self action:nil];
[barItems addObject:flexSpace];

UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed:)];
doneBtn.tintColor=[UIColor whiteColor];
[barItems addObject:doneBtn];

UIBarButtonItem *cancelBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemCancel target:self action:@selector(cancelButtonPressed:)];
 cancelBtn.tintColor=[UIColor whiteColor];
[barItems addObject:cancelBtn];

[pickerToolbar setItems:barItems animated:YES];

[popoverView addSubview:pickerToolbar];
popovercontroller.view=popoverView;

pickerViewPopup = [[UIPopoverController alloc] initWithContentViewController:popovercontroller];

[pickerViewPopup presentPopoverFromRect:CGRectMake(312, 212, 400, 344) inView:self.view permittedArrowDirections:0 animated:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:24:19.617

您看不到任何内容的原因是，通过从头开始显式重新创建您已经连接到插座的视图控制器，编译器假定您想要丢弃旧值并释放 IB 创建的视图控制器实例。或者，如果这是一个单独的故事板或 XIB，那么正确的初始化程序将是`-initWithNibName:bundle:`. 只需省略/编辑第一行，假设插座连接正确，您应该看到您在 IB 中放置的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T16:21:23.063

好的。所以我做了这个...

```
popOverViewController =  [self.storyboard instantiateViewControllerWithIdentifier:@"popOver"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-14T11:46:22.463

我一直在努力解决这个问题，但想在故事板中做尽可能多的事情，这会稍微改变方法：

1）选择情节提要中的弹出框并取消勾选向上/向下/向左/向右方向以摆脱箭头。

要将其集中在屏幕覆盖上，为 segue 做准备并执行以下操作：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    UIStoryboardPopoverSegue* popover = (UIStoryboardPopoverSegue*)segue;
    CGFloat horizontalInset = (self.view.frame.size.width - popover.popoverController.popoverContentSize.width) / (CGFloat)2.0;
    CGFloat verticalInset = (self.view.frame.size.height - popover.popoverController.popoverContentSize.height) / (CGFloat)2.0;
    popover.popoverController.popoverLayoutMargins =
        UIEdgeInsetsMake(
            verticalInset,
          horizontalInset,
            verticalInset,
          horizontalInset);
} 
```

在我的情况下，我还发现 popover segue 的圆角半径与我的设计不匹配，所以我将背景颜色更改为清除以对其进行排序，即将其添加到上面的块中：

```
popover.popoverController.backgroundColor = [UIColor clearColor]; 
```

2）在segue的目标控制器中找到属性'Popover'并勾选'Use Explicit Size'并将您希望它出现在popover模式下的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-18T21:05:24.583

使背景颜色清晰几乎对我有用，但它弄乱了变灰的背景。直接在箭头后面的视图部分是清晰的，而背景的其余部分是灰色的。所以我把颜色改成了灰色的alpha。

```
 UIPopoverController *popoverController = [[UIPopoverController alloc] initWithContentViewController:newViewController];

 popoverController.backgroundColor = [UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.15]; 
```

# php - PHP 5.3 getallheaders

> ID：15234285
> 
> 赞同：2
> 
> 时间：2013-03-05T21:17:42.173
> 
> 标签：php, apache

我正在开发一个 Web 应用程序，它需要捕获客户端发送的自定义标头数据。在我的本地主机中安装了 PHP 5.4，我正在使用`getallheaders()`.

但是在我安装了 PHP 5.3 的主机中。我无法获得标题。我已经尝试过其他方法，例如：

```
foreach ($_SERVER as $name => $value) 
{ 
    if (substr($name, 0, 5) == 'HTTP_') 
    {
        $name = str_replace(' ', '-', ucwords(strtolower(str_replace('_', ' ', substr($name, 5))))); 
        $headers[$name] = $value; 
    } else if ($name == "CONTENT_TYPE") { 
        $headers["Content-Type"] = $value; 
    } else if ($name == "CONTENT_LENGTH") { 
        $headers["Content-Length"] = $value; 
    } 
} 
```

和

```
apache_request_headers(), apache_response_headers() 
```

还有其他方法吗？我的主机使用 PHP 5.3 (FastCGI)。

**更新**

嗯，我知道问题出在哪里了。所以首先（为了证明这个概念），我将 PHP 切换为作为 Apache 模块运行，是的，正如预期的那样，我可以使用`getallheaders()`.

之后，我尝试了其他休息客户端/调试器来发送自定义标头（现在作为 FastCGI），并且我的代码能够捕获标头（在 $_SERVER 内）。所以问题是，为什么第一个 REST 客户端只有在服务器作为 Apache 模块运行时才能发送标头。

我担心如果我的一个用户遇到同样的问题而另一个人很好。

# python - 使任何其他模块都可以访问变量

> ID：15234288
> 
> 赞同：3
> 
> 时间：2013-03-05T21:17:47.853
> 
> 标签：python

我是 Python 的新用户，我一直在关注这个网页，它对我帮助很大。目前，我正在尝试解决无法从其他模块访问的变量问题。

```
Modelu1.py
Texto = ' string'
textoMayus = texto.upper()

print textoMayus 

cadena = textoMayus.split () 

moduel2.py
import entrada
size = len(cadena) 
```

当我运行 moduel2.py python 给我这个错误： NameError: name 'cadena' is not defined

如何声明可以从任何其他模块访问的变量...

谢谢！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:19:05.880

当您`import entrada`导入模块时，而不是其中的名称。你可以这样做：

```
import entrada
size = len(entrada.cadena) 
```

或者

```
from entrada import cadena
size = len(cadena) 
```

您应该阅读[Python 教程](http://docs.python.org/2/tutorial/)以了解 Python 中模块导入的基础知识。

# java - JPA 更新与加入

> ID：15234291
> 
> 赞同：2
> 
> 时间：2013-03-05T21:17:51.650
> 
> 标签：java, jakarta-ee, jpa

我希望是一个简单的 JPA 问题。假设我有以下类结构：

```
@Entity
@Table(name="foo_table")
class Foo{
    @Id @Column(name="ID")
    String id;
...
    @ManyToOne()
    @JoinColumn(name="BAR_ID")
    Bar bar;
}

@Entity
@Table(name="bar_table")
class Bar{
    @Id @Column(name="ID")
    String id;
    @Column(name="COL3")
    String col3;
} 
```

场景：假设我想更新“Foo”记录与哪个“Bar”相关联。

这是我目前使用的查询：

```
EntityTransaction tx = em.getTransaction();
tx.begin();
int rowsUpdated = em.createQuery("UPDATE Foo f SET bar = :bar " +
                  "WHERE f.id = :fooId").
                  setParameter("fooId", fooId).
                  setParameter("bar", newBar).
                  executeUpdate();
tx.commit(); 
```

问题：是否可以在仅更新 foo_table 而不更新 bar_table 的 JPA 更新中进行。DBA 不想给我 bar_table 的更新权限，但 JPA 似乎想要进行“深度”更新并同时更新 foo_table 和 bar_table。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:40:13.870

此解决方案也有效：

```
@ManyToOne()
@JoinColumn(name="BAR_ID", updatable=false)
Bar bar; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:29:30.983

如果我没记错的话，`@ManyToOne`的默认行为是将持久性级联到引用的对象。在您的情况下，这意味着它`Bar`也将被更新。您可以使用以下注释来控制它：

```
@ManyToOne(cascade={})
@JoinColumn(name="BAR_ID")
Bar bar; 
```

这意味着持久化`Foo`对象不会影响`Bar`对象。

# mysql - SQL：在特定字段中选择符合特定条件的行

> ID：15234292
> 
> 赞同：2
> 
> 时间：2013-03-05T21:17:55.433
> 
> 标签：mysql, sql

我有一种情况，我需要从数据库表中选择行，这取决于列中的值。

```
Project    Version     Status

MSS           3         active
MSS           2         active 
MSS           1         complete 
RIL           3         active
RIL           2         active  
RIL           1         active
DT            2         complete
DT            1         complete 
```

一个项目只有在其所有版本都完整时才被认为是完整的。这意味着当状态列在表的项目列中所有出现的相同项目中具有“完成”时。

怎么能只选择那些已经完成的项目呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:21:44.937

```
select project
from MyTable
group by project
having count(*) = sum(case when status = 'complete' then 1 else 0 end) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:22:52.250

```
SELECT * FROM MyTable
WHERE Project IN
(SELECT Project FROM MyTable WHERE Status = 'complete') 
```

# c++ - 在 Code::Blocks 中构建 wxWidgets 程序

> ID：15234293
> 
> 赞同：4
> 
> 时间：2013-03-05T21:18:06.417
> 
> 标签：c++, mingw, wxwidgets, linker-errors, codeblocks

我正在尝试使用 Code::Blocks 12.11 构建[这个 wxWidgets 示例程序](http://www.wxwidgets.org/docs/tutorials/hworld2.txt)，但无论我尝试什么，构建都会失败。

例如，构建日志显示如下（项目位于 X:\programming\c++\HelloWxWidgets 下）：

> mingw32-g++.exe -Wall -fexceptions -g -D_ *GNUWIN32* _ -D_ *WXMSW* _ -DwxUSE_UNICODE -D_ *WXDEBUG* _ -IC :\libraries\wxWidgets-2.8.12.01\include -IC:\libraries\wxWidgets-2.8.12.01\ contrib\include -IC:\libraries\wxWidgets-2.8.12.01\lib\gcc_lib\mswud -c X:\programming\c++\HelloWxWidgets\hworld2.cpp -o obj\Debug2\hworld2.o mingw32-g++.exe -LC :\libraries\wxWidgets-2.8.12.01\lib\gcc_lib -o bin\Debug2\HelloWxWidgets.exe obj\Debug2\hworld2.o -static-libgcc C:\libraries\wxWidgets-2.8.12.01\lib\gcc_lib\libwxmsw28ud。 a C:\libraries\wxWidgets-2.8.12.01\lib\gcc_lib\libwxmsw28ud.a(monolib_window.o): 在函数`ZN8wxWindow6UpdateEv': C:\BuildAgent\work\wxPack\wxwidgets\build\msw/../../src/msw/window.cpp:1643: undefined reference to`GdiFlush@0' C:\libraries\wxWidgets-2.8.12.01\lib\gcc_lib\libwxmsw28ud.a( monolib_window.o): 在函数中`ZNK8wxWindow13GetTextExtentERK8wxStringPiS3_S3_S3_PK6wxFont': C:\BuildAgent\work\wxPack\wxwidgets\build\msw/../../src/msw/window.cpp:2132: undefined reference to`GetTextExtentPoint32W@16' C:\BuildAgent\work\wxPack\wxwidgets\build\msw/../../src/msw/window.cpp:2133：未定义对“GetTextMetricsW@8”的引用

这些是我得到的一些构建信息

> C:\libraries\wxWidgets-2.8.12.01\lib\gcc_lib\libwxmsw28ud.a(monolib_window.o)||在函数`ZN8wxWindow6UpdateEv':| C:\BuildAgent\work\wxPack\wxwidgets\build\msw\..\..\src\msw\window.cpp|1643|undefined reference to`GdiFlush@0'| C:\libraries\wxWidgets-2.8.12.01\lib\gcc_lib\libwxmsw28ud.a(monolib_window.o)||在函数`ZNK8wxWindow13GetTextExtentERK8wxStringPiS3_S3_S3_PK6wxFont':| C:\BuildAgent\work\wxPack\wxwidgets\build\msw\..\..\src\msw\window.cpp|2132|undefined reference to`GetTextExtentPoint32W@16'| C:\BuildAgent\work\wxPack\wxwidgets\build\msw....\src\msw\window.cpp|2133|未定义对`GetTextMetricsW@8'的引用|

这是完整的[构建日志](http://pastebin.com/kWZLFAdE)和所有[构建消息](http://pastebin.com/Je2PfZY8)（顺便说一下，我没有 C:\BuildAgent 目录）

我正在使用[wxPack 2.8.12 （安装在 C:\libraries\wxWidgets-2.8.12.01 中）和 GCC 4.7.2（使用](http://wxpack.sourceforge.net/Main/Downloads)[mingw-get](http://sourceforge.net/projects/mingw/)与 C:\mingw 中的 Code::Blocks 分开安装）

以下是 Code::Blocks 中的构建选项

*   [编译器设置 > 定义](http://i47.tinypic.com/21d1s80.jpg)
*   [链接器设置](http://i49.tinypic.com/28r1wo.png)
*   [搜索目录 > 编译器](http://i45.tinypic.com/27yah6q.png)
*   [搜索目录 > 链接器](http://i47.tinypic.com/34nfvdk.png)
*   [搜索目录 > 资源编译器](http://i47.tinypic.com/25jw7kk.png)

提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T00:35:54.300

好吧，我终于设法让它工作了:)

如果像我一样，有人想在 Code::Blocks 下的（最初）控制台项目中使用 wxWidgets，我将在此处发布要遵循的过程。有了这个，任何人都应该能够在 Wind0ws 环境中构建/运行至少[这个示例代码：](http://www.wxwidgets.org/docs/tutorials/hworld2.txt)

1.  我假设 Code::Blocks 和 MinGW 设置正确。
2.  [从http://www.wxwidgets.org/downloads/](http://www.wxwidgets.org/downloads/)下载/安装 wxMSW （在我的情况下，我下载了 wxMSW-2.8.12-Setup.exe 并将其安装在 C:\libraries\wxWidgets-2.8.12 中）
3.  打开命令提示符，需要构建 wxWidgets，我将以使用 unicode 的静态链接、整体、调试构建为例（更多信息[在这里](http://wiki.codeblocks.org/index.php?title=WxWindowsQuickRef)）：

    > cd /DC:\libraries\wxWidgets-2.8.12\build\msw
    > 
    > mingw32-make -f makefile.gcc BUILD=debug SHARED=0 MONOLITHIC=1 UNICODE=1
    > 
    > :(mingw32-make 需要一些时间来构建库）

4.  打开代码::块

5.  创建一个新的**控制台项目**，或者如果您已经有一个控制台项目（并且您计划向其中添加一个 wxWidgets GUI）打开它
6.  右键单击项目>构建选项
7.  [以下是](http://s23.postimage.org/4mjjohbaj/solution.png)我用于 Debug 构建的构建选项。 ![Code::Blocks wxWidgets 的构建选项](../Images/15bc4b7af2addd4ab2e98216cf56205d.png)
8.  构建和运行

[编辑] 除了 wx/wx.h 之外，还应包含 wx/app.h

```
#include <wx/wx.h>
#include <wx/app.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:25:42.680

您可能需要将以下库添加到链接器设置（我从 VS 2012 中获取了列表，但对于 GCC 应该是相同的，您需要添加 -luuid -luser32 .... 到链接器高级选项）

> kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib

**UPD：**可以看到 taht chris 建议添加 gdi32 库。对我来说看起来很合理。至少在那里定义了日志中[缺少](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144937%28v=vs.85%29.aspx)的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-11T02:54:50.677

我发现一个最好的方法是在你的“其他衬里选项”中添加“wx-config --libs all”，在这个问题上，很多问题都会消失。

[wxconfig 屏幕截图](https://i.stack.imgur.com/AUoLs.png)

# jquery - 在 jQuery 事件中创建全局函数

> ID：15234298
> 
> 赞同：0
> 
> 时间：2013-03-05T21:18:27.540
> 
> 标签：jquery, global-variables, uploadify

我有一个函数，它使用 2 种方法为 php 脚本调用 POST 事件。一个是调用后`document.ready`返回一个 ID。第二个我想为第二种方法发送该 ID，该方法将从该 ID 中找到所有附加信息。

第一种方法会起作用，但第二种方法不起作用。我可以从 jquery 函数事件创建一个全局变量吗，即

```
... function(data){
Record=Data; 
} 
```

这是创建全局变量的方法吗？

我的代码：

```
function getAttachRecords(metodo, id){
    RegId = "";
    jQuery.ajax({
        type: "GET",
        async: true,
        url: "source/getAttchRecord.php",
        data:{method: metodo, id: id},
        cache: true,
        dataType: "html",
        contentType: "application/x-www-form-urlencoded;charset=ISO-8859-15",
        success: function(data,textStatus,jqXHR){   

            if(metodo ="truncRecord"){  
                RegId = data;           
              $('#file_upload').uploadify({
                'formData'     : {
                            'timestamp' : '<?php echo time();?>',
                            'token'     : '<?php echo md5("unique_salt" . $timestamp);?>',
                            'registo'   : RegId             
                        },
                'uploader'  : 'source/uploadify/upload.php',
                'swf'      : 'source/uploadify/uploadify.swf',
                'script'    : 'source/uploadify/upload.php',
                'cancelImg' : 'source/uploadify/cancel.png',
                'folder'    : 'source/uploadify/uploads',
                'auto'      : true,
                'onSelect': function(){
                                    $("#table_content").slideUp();
                                },
                'onQueueComplete' : function() {
                                    $("#table_content").slideDown();
                                    getAttachRecords("getAttachRecords", RegId);  

                                }
              });
            }else{
                alert(data);
                $("table").find("#table_content").html(data);
            }
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:21:11.067

`window`应该总是在范围内，所以只需添加你的变量：

```
//alert(bar); // `foo` is undefined up here

(function(){
  (function(){
    (function(){
      // some nested scope
      window.foo = 'bar';
    })();
  })();
})();

alert(foo); // `foo` now contains 'bar' 
```

不过要小心，因为（尤其是使用 ajax）它不能保证在你使用它时可用，所以最好也检查一下：

```
if (typeof foo !== 'undefined'){
  alert(foo);
} 
```

但是，您也可以在该范围内之前定义它：

```
var foo;

(function(){
  (function(){
    (function(){
      // some nested scope
      foo = 'baz';
    })();
  })();
})();

alert(foo); // 'baz' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:23:11.603

只需在回调或其他包装函数之外定义它：

```
var Record;

function getNewRecord () {
   Record = 'new data';
} 
```

也就是说，如果该值是由回调设置的，那么除了从成功函数内部或触发其他事件/回调之外，您将无法确定何时更新此值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T00:47:20.967

我发现了问题

> 如果（metodo =“truncRecord”）{

这个 if 语句是错误的，它应该是：

> 如果（metodo =="truncRecord"）{

更改后一切正常

# android - 在LinearLayout的行尾添加Android中的CheckBox

> ID：15234299
> 
> 赞同：0
> 
> 时间：2013-03-05T21:18:34.363
> 
> 标签：android, layout, checkbox

我有这样的线性布局：

```
 <!-- First column in row with image -->
    <ImageView
        android:id="@+id/bild"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:layout_gravity="center"
        android:layout_margin="8dp"
        android:contentDescription="@string/description"
        android:src="@drawable/ic_launcher" >
    </ImageView>

    <!-- Second column in row with data -->

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="20dp"
        android:gravity="center"
        android:orientation="vertical"
        android:paddingTop="10dp" >

        <TextView
            android:id="@+id/selectedItem"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:textColor="#464f58"
            android:textSize="16sp"
            android:textStyle="bold" />

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/numberOfLeaflet"
                android:textSize="12sp" />

            <TextView
                android:id="@+id/number"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text=""
                android:textSize="12sp" />
        </LinearLayout>
    </LinearLayout>

    <!-- Third column with checkBox -->
    <CheckBox
        android:id="@+id/chkBox"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

问题是这个复选框是不可见的。当我在 ImageView 之前更改并给出此复选框时，我可以看到此复选框。

你知道为什么我在 3 列中看不到这个复选框吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:22:23.873

第二列设置为 fill_parent 宽度。所以最后一个复选框不适合并放在同一行，但不在屏幕的一侧。解决此问题的最简单方法是使第二列不是 fill_parent，或者将其和复选框都设置为 fill_parent 并使用权重使它们拆分空间。您可以做的另一件事是使外部布局成为RelativeLayout，这样您就可以将第二列设置为复选框的layout_leftOf，并使复选框alignParentRight=true。

# lucene - 如何根据 Lucene 中的 termPostion 获取术语？

> ID：15234305
> 
> 赞同：0
> 
> 时间：2013-03-05T21:19:09.900
> 
> 标签：lucene, term

```
Here are some code to access terms in a Lucene document:
int docId = hits[i].doc;  
TermFreqVector tfvector = reader.getTermFreqVector(docId, "contents");  
TermPositionVector tpvector = (TermPositionVector)tfvector;  
// this part works only if there is one term in the query string,  
// otherwise you will have to iterate this section over the query terms.  
int termidx = tfvector.indexOf(querystr);  
int[] termposx = tpvector.getTermPositions(termidx);  
TermVectorOffsetInfo[] tvoffsetinfo = tpvector.getOffsets(termidx); 
```

我的问题是，使用 termposx，如何根据 termposx 数组获取术语？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T01:59:02.663

Zincup: termposx has {7, 19, 34}. What is the term at 8 or 9? how to access it?

TermPositionVector.getTermPositions() returns **an array of positions in which the term is found.**

Terms are identified by the index at which its number appears in the term String array obtained from the **indexOf** method.

So it is the same term that appears at multiple positions at {7, 19, 34}.

Using the TermPositionVector, you can gain access to the "positions in which each of the terms is found", but not the other way.

I am afraid, you've to iterate to find the term at positions 8,9\. I will explore the API further and let you know if I find a solution.

# python - 快速/简单的阵列比较算法，无需共享数据

> ID：15234307
> 
> 赞同：0
> 
> 时间：2013-03-05T21:19:16.167
> 
> 标签：python, algorithm, matlab, locality-sensitive-hash

我有两个由两个彼此独立的不同系统生成的数组。我想通过仅比较从数组生成的几个数字来比较它们的相似之处。

现在，我只比较数组的最小值、最大值和总和，但我想知道是否有更好的算法？任何类型的散列算法都需要对数组之间的小浮点差异不敏感。

编辑：我要做的是验证两种算法是否生成相同的数据，而无需直接比较数据。所以算法应该对数据的变化敏感，对每个元素之间的微小差异相对不敏感。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:32:25.037

我不会尝试将其减少到一个数字。只需传递一个`tuple`值，并编写一个`close_enough`比较元组的函数。

例如，您可以将`(mean, stdev)`其用作您的值，然后定义`close_enough`为“每个数组的均值在另一个数组均值的 0.25 标准差范围内”。

```
def mean_stdev(a):
    return mean(a), stdev(a)

def close_enough(mean_stdev_a, mean_stdev_b):
    mean_a, stdev_a = mean_stdev_a
    mean_b, stdev_b = mean_stdev_b
    diff = abs(mean_a - mean_b)
    return (diff < 0.25 * stdev_a and diff < 0.25 * stdev_b) 
```

显然，正确的值是您想要根据您的用例进行调整的值。也许您实际上想要基于方差（stdev 的平方），或方差和偏斜，或 stdev 和 sqrt（偏斜），或除算术平均值之外的一些完全不同的归一化。这一切都取决于你的数字代表什么，以及“足够接近”是什么意思。

在不了解您的应用领域的情况下，很难给出更具体的信息。例如，如果您要比较音频指纹（或 DNA 指纹或指纹指纹），您将需要与比较 JPEG 压缩的风景图像截然不同的结果。

* * *

在您的评论中，您说您希望对值的顺序敏感。为了解决这个问题，您可以生成一些衡量序列“乱序”程度的方法。例如：

```
diffs = [elem[0] - elem[1] for elem in zip(seq, sorted(seq))] 
```

这为您提供了每个元素与排序位置中的元素之间的差异。您可以从中构建一个类似于 stdev 的度量（将每个值平方、平均值、sqrt），或者采用平均绝对差异等。

或者您可以比较实际索引与“正确”索引的距离。或者该值与基于平均值和标准差的索引处的预期值相差多远。或者……有无数种可能。同样，这在很大程度上取决于您的应用领域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:40:24.880

完全取决于您对“比较它们的相似性”的定义。

您想比较哪些功能？**你能识别出哪些特征？**它们是可识别的模式吗？即在这组中，有 6 个临界点，有 2 个不连续点……等等……

您已经提到比较最小/最大/总和；并且在评论中也谈到了方法和标准偏差。这些都是套装的特点。

最终，您应该能够利用所有这些特征并制作一个 n 维描述符。例如 [min, max, mean, std, etc...]

然后，您可以比较这些 n 维描述符以定义一个描述符是否比另一个“少”、“相等”或“多”。如果您想将其他集合分类为更像“集合 A”还是更像“集合 B”，您可以查看分类器。

看：

[使用模糊逻辑对高维模式进行分类](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&cad=rja&ved=0CDwQFjAC&url=http://downloads.hindawi.com/journals/afs/2012/920920.pdf&ei=NWQ2UdPiEom1O7zKgLgM&usg=AFQjCNGuTADh_jhSWSvzGAsReWcSAA3uyQ&bvm=bv.43148975,bs.1,d.ZWU)

[支持向量机](http://en.wikipedia.org/wiki/Support_vector_machine)

# c# - ASP.Net 4 会话在回发时过期

> ID：15234312
> 
> 赞同：1
> 
> 时间：2013-03-05T21:19:23.767
> 
> 标签：c#, asp.net, .net, session, master-pages

我正在使用 ASP.Net 4 (Visual Studio 2010 - C#)。我的会话在回发时一直过期。我在 MasterPage 的 Page_Init 方法中设置我的会话变量。该问题不是超时问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:25:22.013

ASP.NET 无法检测到 IE10.. 请检查这个..

[http://www.hanselman.com/blog/BugAndFixASPNETFailsToDetectIE10CausingDoPostBackIsUndefinedJavaScriptErrorOrMaintainFF5ScrollbarPosition.aspx](http://www.hanselman.com/blog/BugAndFixASPNETFailsToDetectIE10CausingDoPostBackIsUndefinedJavaScriptErrorOrMaintainFF5ScrollbarPosition.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:14:04.790

回发似乎有问题...您如何进行回发...请您添加详细信息..

公共部分类 MasterPage : System.Web.UI.MasterPage

{

```
protected void Page_Load(object sender, EventArgs e)

{

    if(Session["abc"] == null)
    Session["abc"] = "abcd";
} 
```

}

公共部分类 Default2：System.Web.UI.Page

{

```
 protected void Page_Init(object sender, EventArgs e)

{

    string x = Session["abc"] as string;

    Response.Write(x);

} 
```

}

# ruby - 无法安装任何 Gems（watir-webdriver、selenium-webdriver）

> ID：15234316
> 
> 赞同：1
> 
> 时间：2013-03-05T21:19:49.543
> 
> 标签：ruby, rubygems, gem, watir, watir-webdriver

我安装了 Ruby：成功

```
ruby -v
=> ruby 1.9.3p392 (2013-02-22) [i386-mingw32]

gem -v
=> 1.8.24

gem source
=> *** CURRENT SOURCES ***
=> http://rubygems.org/ 
```

当我尝试安装任何 gem 时：失败。

在家工作对我来说很好，但在我的工作地点却不行。我尝试ping ruby​​gems.org 站点，但没有ping 通。我直接从网站下载了 gems 并将其放在文件夹中：（watir-webdriver） `C:\Ruby193\lib\ruby\gems\1.9.1\gems>`

像这样安装的宝石：`C:\Ruby193\lib\ruby\gems\1.9.1\gems>gem install watir-webdriver`

收到此错误：`C:\Ruby193\lib\ruby\gems\1.9.1\gems>gem install watir-webdriver ERROR: While executing gem ... (Zlib::GzipFile::Error) not in gzip format`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:13:23.473

你在代理后面吗？在这种情况下，请参阅此页面寻求帮助：

*   [http://watir.com/installation/](http://watir.com/installation/)
*   [http://wiki.openqa.org/display/WTR/FAQ#FAQ-HowdoIgeminstallWatirbehindaproxyserver%3F](http://wiki.openqa.org/display/WTR/FAQ#FAQ-HowdoIgeminstallWatirbehindaproxyserver%3F)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T17:08:22.613

如果您在 linux 上安装（我在 Ubuntu 上遇到过类似的问题），您需要按照[这些说明进行操作](https://stackoverflow.com/questions/937608/i-get-this-error-when-installing-a-gem-error-while-executing-gem-zlibg)

一、获取正确的zlib驱动

```
sudo apt-get install libzlib-ruby 
```

其次，检查您的来源并可能添加到它们：

```
gem sources
gem sources -a http://gems.rubyforge.org/
gem sources -a http://rubygems.org 
```

顺便说一句，我在 Ubuntu 上更新我的各种库以在 Ubuntu 上启用合理的 IRB 交互（历史、选项卡完成、颜色等）有一个漫长的过程。这需要一些工作，但能够使用 RVM 是值得的。

# java - 如何将通过浏览器链接传递的数据存储在 mySQL 数据库中？

> ID：15234318
> 
> 赞同：-5
> 
> 时间：2013-03-05T21:20:00.320
> 
> 标签：java, php, javascript, html, mysql

代码看起来像这样，

```
<form name="input" action="Sent.jsp" method="get">
<p><br>Reply:<br>
<textarea name="message3">Type Here</textarea>
<input type="submit" value="Submit"></p></form></td> 
```

我想在下一页上以粗体捕获下面链接的部分并将其存储在 mySQL 数据库中

```
localhost:8080/WebContent/Sent.jsp?message=**Message+from+the+getter** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:21:20.387

你实际上是在寻找`_GET['message3']`变量..

做这样的事情

```
 $message = _GET['message3'] ;
   if(isset($message){ 
    $sql = insert your $message variable in database here
    run the query
    }
     etc.. 
```

你完成了

我假设您正在通过 localhost 进行学习，并且您获得了 Sent.jsp 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:24:50.347

```
if(isset('message'))
{
$message = $_GET[message];
//Now save $message variable to mySql
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:26:50.383

在您的 Sent.jsp 文件中，您应该使用检查变量是否实际**设置**，以及它是否不为**空**

```
if(isset($_GET['message3']) && (!empty($_GET['message3']))
{
    $variable = $_GET['message3'];
    ... 
```

然后将其存储到数据库中

```
mysql_query("INSERT INTO tableName VALUES ('$variable')"); 
```

# java - 外部 switch 语句中的变量

> ID：15234323
> 
> 赞同：-2
> 
> 时间：2013-03-05T21:20:12.727
> 
> 标签：java, variables, combobox, switch-statement

我正在编写一个包含 ComboBox 的程序，您可以在其中选择文本，该文本将使用程序中的 switch 语句转换为系数。问题是我不能使用变量外部开关语句。如果有人可以提供帮助，我真的很感激。

代码示例：

```
double Cst1; 
String s = Cst.getSelectedItem().toString();

switch (s) { 

     case "ABC":
         Cst1 = -25;
         break;

     case "CBA":
         Cst1 = -10;
         break;

     case "BCA":
         Cst1 = 0;      
         break;

     case "ACB":
         Cst1 = 10;             
         break;

     default:
         answer.setText("ERROR");
         break;                     
}

double C14 = 9 * Cst1; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:23:55.857

如果你得到一个错误提示变量没有初始化，试试这个：

```
double Cst1 = 0.; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:32:06.043

如果您有一个未在您的开关中明确涵盖的字符串值，`Cst1`则永远不会被初始化。例如，字符串`"AAA"`将属于默认情况。

有两种可能的修复方法：

1.  像初始化 Cst1

    ```
    double Cst1 = 0. 
    ```

2.  将 Cst1 设置为默认情况，例如

    ```
    default:
        Cst1 = 0.;
        // Display your error
        break; 
    ```

# java - 这段代码多线程安全吗？

> ID：15234324
> 
> 赞同：2
> 
> 时间：2013-03-05T21:20:16.327
> 
> 标签：java, multithreading, static-methods

```
 private static Map<Integer, String> map = null;

    public static String getString(int parameter){

        if(map == null){

            map = new HashMap<Integer, String>();
            //map gets filled here...

        }

        return map.get(parameter);
    } 
```

随着多线程的发展，该代码是否不安全？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:45:25.627

如前所述，这绝对不安全。如果地图的内容不是基于 getString() 中的参数，那么最好将地图初始化为静态初始化程序，如下所示：

```
private static final Map<Integer, String> MAP = new HashMap<Integer,String>();

static {
  // Populate map here
} 
```

加载类时，上面的代码被调用一次。它是完全线程安全的（尽管未来对地图的修改不是）。您是否出于性能原因尝试延迟加载它？如果是这样，这更安全：

```
private static Map<Integer, String> map = null;

public synchronized static String getString(int parameter){

    if(map == null){

        map = new HashMap<Integer, String>();
        //map gets filled here...

    }

    return map.get(parameter);
} 
```

使用[synchronized](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)关键字将确保在任何时候只有一个线程可以执行该方法，并且始终传播对映射引用的更改。

如果你问这个问题，我推荐阅读“Java Concurrency in Practice”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:24:18.710

**比赛条件？可能。**

如果`map`是`null`，并且两个线程`if (map == null)`同时检查，每个线程都会分配一个单独的映射。这可能是也可能不是问题，主要取决于是否`map`是不变的。即使地图是不变的，填充地图的成本也可能成为一个问题。

**内存泄漏？不。**

无论竞争条件如何，垃圾收集器都会正确完成其工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:22:06.687

`map`在多线程场景中，您确实冒着初始化两次的风险。

在托管语言中，垃圾收集器最终将处理不再引用的实例。在非托管语言中，您永远不会释放为覆盖映射分配的内存。

无论哪种方式，初始化都应该得到适当的保护，以便多个线程不会同时运行初始化代码。

一个原因：第一个线程可能正在初始化 HashMap，而第二个线程很长，看到它`map`不为空，并愉快地尝试使用部分初始化的数据结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:36:35.937

由于竞争条件，在多线程情况下它是不安全的。

但是你真的需要地图的延迟初始化吗？如果无论如何都要使用地图，似乎你可以为它做急切的初始化..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-05T21:41:50.443

上面的代码不是线程安全的，正如其他人所提到的，您的地图可以初始化两次。您可能很想尝试通过添加一些同步来修复上述代码，这被称为“双重检查锁定”，[这里有一篇文章](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)描述了这种方法的问题，以及一些潜在的修复。

最简单的解决方案是使该字段成为单独类中的静态字段：

```
class HelperSingleton {
  static Helper singleton = new Helper();
 } 
```

它也可以使用 volatile 关键字来修复，如 Bill Pugh 的文章中所述。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T21:47:48.940

不，此代码对于多线程使用是不安全的。

在地图的初始化中存在竞争条件。例如，多个线程可以同时初始化映射并破坏彼此的写入。

没有内存屏障来确保线程所做的修改对其他线程可见。例如，每个线程都可以使用自己的映射副本，因为它们永远不会“看到”另一个线程写入的值。

没有原子性可以确保在同时访问映射时保留不变量。例如，一个正在执行`get()`操作的线程可能会进入无限循环，因为另一个线程在同时`put()`操作期间对存储桶进行了重新散列。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-05T22:21:50.897

如果您使用的是 Java 6，请使用 ConcurrentHashMap

[ConcurrentHashMap JavaDoc](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)

# javascript - 使所有函数成为严格模式文字对象？

> ID：15234326
> 
> 赞同：3
> 
> 时间：2013-03-05T21:20:22.107
> 
> 标签：javascript, object, literals, mode, strict

假设我们有这个脚本。

```
var apple = {
    type: "macintosh",
    color: "red",
    getInfo: function () {
        return this.color + ' ' + this.type + ' apple';
    }
    ///more functions here....
} 
```

如何让所有这些功能在严格模式下运行？我可以将“use strict”放在文件顶部，但 JSlint 不同意。另一种方法是在每个函数中都加上“use strict”，但有更好的选择吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:21:58.820

将所有内容包装在 IIFE 中，JSLint 应该会批准。

```
(function () {
    "use strict";
    //all your code here
}()); 
```

* * *

请注意，以前在全局范围内声明的变量/函数在移至此立即调用的函数表达式内部时将不再可在全局范围内访问。

您必须将这些显式设置为全局对象的属性，例如`window`浏览器环境的对象：

```
(function () {
    "use strict";
    window.someGlobalVariable = "something";
}()); 
```

**@zzzzBov**的解决方案也适用于浏览器和后端环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:25:12.437

将所有内容包装在[IIFE](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)中，为全局引用设置别名，并在全局对象上显式设置全局变量：

```
(function (root) { //could be window (browser), could be global (node)
    "use strict";
    ...code...
    root.apple = apple; //explicitly make apple a global variable
}(this)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-23T17:41:25.993

如果您为对象文字使用命名空间，我最喜欢这种方法：

```
(function (myApp) {
    'use strict';

    myApp.myObj = {
        init: function(){}           
    }

}(window.myApp = window.myApp || {}));

myApp.myObj.init(); 
```

# android - 无需下载即可检查服务器上的文件是否已更改的简单方法

> ID：15234330
> 
> 赞同：0
> 
> 时间：2013-03-05T21:20:41.380
> 
> 标签：android, xml-parsing, android-query

我有一个在我的 Android 应用程序中解析的 XML 文件。如果文件没有更改，我不想解析它。

我可以获得上次修改文件的时间，并且可以从 GMT 的服务器标头中获得上次修改的日期，但不知道现在该怎么办......

```
 //this is a string: status.getHeader("last-modified"); 
    //Shows like so: Tue, 05 March 2013 16:45:02 GMT
    String serverlastmodified = status.getHeader("last-modified");    
    Log.e("Header",serverlastmodified);

    Date s = status.getTime();
    String filelastgotten = s.toGMTString();
    //String shows like so: 5 Mar 2013 19:41:43 GMT
    Log.e("LM", filelastgotten);

//this needs to be a great-than / less-than? 
//But I cannot do that to a string... so change to int?
    if(serverlastmodified.equals(filelastgotten)){
        Log.e(TAG,"YES!");
    }else{
        Log.e(TAG,"NO!");
    } 
```

编辑：：：：：：：：：

这看起来怎么样？

我最终只是使用 SimpleDateFormat 和 toGMTString(); 确保两个日期不相同。

```
 String serverLastModified = status.getHeader("last-modified");
                SimpleDateFormat sdf = new SimpleDateFormat("EEE, dd MMM yyy HH:mm:ss zzz");

                Date d = null;
                try {
                    d = sdf.parse(serverLastModified);
                } catch (ParseException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                Date fileLastGotten = status.getTime();

                Log.e("DATE1", d.toGMTString());
                Log.e("DATE2", fileLastGotten.toGMTString());

                if (d.before(fileLastGotten)) {
                    Log.e("DS", "YES!");
                } else {
                    Log.e("DS", "NO!");
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T02:51:52.423

[我刚刚完成了一个名为droidQuery](http://phil-brown.github.io/droidQuery/)的开源库，如果数据没有被修改，它可以通过返回错误而不是成功来为您处理此任务：

```
$.ajax(new AjaxOptions(url).type("GET")
                           .dataType("XML")
                           .ifModified(true)
                           .context(this)
                           .success(new Function() {
                               @Override
                               public void invoke($ droidQuery, Object... params) {
                                   Document xml = (Document) params[0];
                                   //TODO parse XML Document
                               }
                           })
                           .error(new Function() {
                               @Override
                               public void invoke($ droidQuery, Object... params) {
                                   int status = (Integer) params[1];
                                   if (status == 304) {
                                       Log.i("ajax", "data was not modified. No need to parse");
                                   }
                                   else {
                                       Log.e("ajax", "error: " + (String) params[2];
                                   }
                               }
                           })); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:23:42.517

本机应用程序应保留您要解析的文件的 MD5 哈希值。在请求文件之前，请从服务器请求其 MD5。如果此 MD5 与您的本地 MD5 匹配，则不要请求该文件。否则做并解析它。如果解析了新文件，请不要忘记更新本机 MD5。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:39:06.400

你应该用

```
try {
    long serverTime = Date.parse(serverLastModified).getTime();
    long myTime = status.getTime.getTime();
    if (serverTime != myTime) {
        //Not equals
    } else {
        //equals
    }
} catch (Exception e) {
    //can't parse server string
} 
```

# perl - grep 和替换

> ID：15234334
> 
> 赞同：2
> 
> 时间：2013-03-05T21:20:50.283
> 
> 标签：perl, sed, grep

我只想在第一次出现时从文件（file.dat）中获取一个字符串，并通过从另一个文件（输出）中读取来替换它。我有一个名为“输出”的文件，例如包含“ `AAA T 0001`”

```
#!/bin/bash
procdir=`pwd`

cat output | while read lin1 lin2 lin3
do
  srt2=$(echo $lin1 $lin2 $lin3 | awk '{print $1,$2,$3}')
  grep -m 1 $lin1  $procdir/file.dat | xargs -r0 perl -pi -e 's/$lin1/$srt2/g'
done 
```

基本上我想要的是：当第一次从文件“file.dat”中grep字符串“AAA”时，我想用“T 0001”替换“AAA”旁边的第二和第三列但是仍然保持第一列“AAA”不变。上面的脚本基本上不起作用。基本上在 's/$lin1/$srt2/g' 中不理解 "$lin1" 和 $srt2 变量

例子：

在我的 file.dat 我有一排

AAA D----城市国家

我想要的是：

AAA T 0001 城市 国家

任何意见都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T04:32:44.497

如果你有这样的**输出文件**：

```
$ cat output
AAA T 0001 
```

您的**file.dat**文件包含以下信息：

```
$ cat file.dat
AAA D ---- CITY COUNTRY
BBB C ---- CITY COUNTRY
AAA D ---- CITY COUNTRY 
```

你可以尝试这样的事情`awk`：

```
$ awk '
NR==FNR { 
    a[$1]=$0
    next
} 
$1 in a {
    printf "%s ", a[$1]
    delete a[$1]
        for (i=4;i<=NF;i++) { 
            printf "%s ", $i 
        }
    print ""
    next
}1' output file.dat
AAA T 0001 CITY COUNTRY
BBB C ---- CITY COUNTRY
AAA D ---- CITY COUNTRY 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T05:12:01.383

这只会更改文件中的第一个匹配项：

```
#!/bin/bash
procdir=`pwd`
while read line; do
    set $line
    sed '0,/'"$1"'/s/\([^ ]* \)\([^ ]* [^ ]*\)/\1'"$2 $3"'/' $procdir/file.dat
done < output 
```

要更改所有匹配行：

```
sed '/'"$1"'/s/\([^ ]* \)\([^ ]* [^ ]*\)/\1'"$2 $3"'/' $procdir/file.dat 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:55:54.713

假设您将要搜索`$s`的字符串和要替换的字符串放在 in 中`$r`，以下不是吗？

```
perl -i -pe'
   BEGIN { ($s,$r)=splice(@ARGV,0,2) }
   $done ||= s/\Q$s/$r/;
' "$s" "$r" file.dat 
```

（如果存在则替换第一个实例）

# java - POI 没有写入 excel

> ID：15234335
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:20:53.617
> 
> 标签：java, struts, apache-poi

我使用 POI 将报告写入 excel。这是我的代码：

```
 HSSFWorkbook wb = new HSSFWorkbook();
        HSSFSheet sheet = wb.createSheet("Export To Excel");     

        response.setContentType("application/vnd.ms-excel");
        response.setHeader("Content-Disposition", "attachment; filename=avt.xls");

        HSSFRow row = sheet.createRow(0);
        HSSFCell cell = row.createCell(0);
        cell.setCellValue("AAAAAAAAAAAAAA");
        cell = row.createCell(1);
        cell.setCellValue("BBBBB");
//        cell.setCellStyle(cellStyle);

        FileOutputStream out =  new FileOutputStream("avt.xls");    
        wb.write(out);     
        out.close();     System.out.println("Excel written successfully.."); 
```

当我单击该按钮时，excel 弹出窗口会打开并显示一条警告消息，但不会将任何内容写入 excel。我也没有在编译器中看到任何错误。怎么了>？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:27:52.577

FileOutputStream 尝试写入服务器端的文件。如果您尝试使用响应来编写它，那么您应该使用响应的输出流。

```
wb.write(response.getOutputStream());
response.getOutputStream().close(); 
```

# zend-framework2 - ZF 2 - 将对象的某些属性与表单绑定的最佳方法？

> ID：15234337
> 
> 赞同：0
> 
> 时间：2013-03-05T21:20:56.210
> 
> 标签：zend-framework2

我有一个对象`User`，我提供了一个表单来编辑一些属性，如用户名、邮件等，但不是所有**属性**。

`User`实现`ArraySerializable`。

为了填充我的表单，我使用`bind`方法将字段值与我的对象绑定。但是经过验证，我的绑定对象（用户）的其他属性为空。

**我怎么能准确地说我只想填充 from 的值？**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T08:43:54.333

尝试使用 forms`setValidationGroup()`方法仅验证这些值

```
 $form->setValidationGroup(array('username', 'email')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T08:57:46.703

为什么不手动水合对象（提取），然后在表单上设置数据：

```
$array = $userHydrator->extract($userModel);
$form->setData($array); 
```

那么就不需要绑定对象了，对象就不会受到表单的影响。

# android - ListView 可以在 ExpandableListView 内吗？

> ID：15234349
> 
> 赞同：2
> 
> 时间：2013-03-05T21:21:31.660
> 
> 标签：android, android-layout, android-listview, expandablelistview, expandablelistadapter

我们可以在 ExpandableListView 中有 ListView，这样我就可以先拥有组级别，然后再拥有子数组（listView）。我已经完成了 listview 课程，而且效果很好！但是如何在可扩展列表视图中调用每个组以显示列表视图（布局）！并得到正确的孩子！请任何人帮忙！谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-04-03T13:23:01.723

实际上，您可以将一个可滚动视图（例如您的 ListView）放在另一个可滚动视图（例如您的 ExpandableListView）中，并通过以下方式使前者可滚动：

```
listView.setOnTouchListener(new OnTouchListener() {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
        // disallow the onTouch for your scrollable parent view 
        v.getParent().requestDisallowInterceptTouchEvent(true);
        return false;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-24T12:49:15.503

是的你可以！但真正的事情是在expandableView中创建一个listView。这是诀窍：[https ://www.captechconsulting.com/blogs/android-expandablelistview-magic](https://www.captechconsulting.com/blogs/android-expandablelistview-magic)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:32:29.553

请看一下两天前提出的[这个问题。](https://stackoverflow.com/questions/15190949/is-it-posible-to-have-separatedlistadapter-inside-expandablelistadapter/)那里的用户试图将从 ListView 派生的自定义视图放入 ExpandableListView。我对这个问题的回答也适用于你的情况，所以我会引用它：

> 你不能这样做，因为你不能把一个可滚动的视图（ListView）放到另一个可滚动的视图（ExpandableListView）中。原因是父母会消耗所有的触摸事件，他们永远不会到达孩子。ExpandableListView 将滚动，但 ListView 永远不会知道发生了滚动。

# c# - D3绘图仪和文件观察器，干扰？

> ID：15234355
> 
> 赞同：0
> 
> 时间：2013-03-05T21:21:45.183
> 
> 标签：c#, wpf, events, filesystemwatcher, dynamic-data-display

我正在使用文件观察器监视文件输出，然后使用 d3（动态数据显示）动态显示结果。这里有更多细节：

1.  数据是一系列快速生成的 tiff 文件（每个文件生成 20-25 毫秒）；
2.  一旦有文件进来，就会触发事件，并处理文件（一些统计计算）；
3.  结果将被发送到 d3 绘图仪，该绘图仪将在宪章上动态显示结果。

**当我关闭 d3 包机窗口时，文件观察程序捕获几乎所有事件**，但这是我的问题：

*   但是，当我打开 d3 宪章窗口时，即使没有任何统计数据计算，文件观察程序也会丢弃许多事件（发生一些大差距）。

这是我们尝试过的：

*   增加观察者缓冲区，但是，只要 d3 宪章窗口打开，它仍然会丢弃事件。
*   使用 C++ dll 计算统计数据，但它看起来更慢。

所以我想知道：

*   d3 绘图仪和文件观察器是否相互冲突/干扰？
*   我可以将它们一起用于实时绘图吗？
*   有没有办法解决我的问题？

任何指针表示赞赏。

这是d3绘图仪的代码，包括构造函数、绘图仪启动器和绘图仪更新：

```
#region Constructor
public SignalStatsDisplay()
{
    InitializeComponent();

    //   timeDomainPlotter.Legend.Remove();

    _initialChildrenCount = timeDomainPlotter.Children.Count;

    int count = timeDomainPlotter.Children.Count;

    //do not remove the initial children
    if (count > _initialChildrenCount)
    {
        for (int i = count - 1; i >= _initialChildrenCount; i--)
        {
            timeDomainPlotter.Children.RemoveAt(i);
        }
    }

    _nMaxStatsOneChannel = Enum.GetNames(typeof(Window1.ROISignalList)).Length;
    _curveBrush = new Brush[_nMaxStatsOneChannel];
    _statsEnable = new int[_nMaxStatsOneChannel];

    for (int i = 0; i < _nMaxStatsOneChannel; i++)
    {
        _curveBrush[i] = new SolidColorBrush((Color)ColorConverter.ConvertFromString(_colorList[i]));
        _statsEnable[i] = 0;
    }

    _nActiveStatsOneChannel = 0;
}
#endregion Constructor

public void InitiateSignalAnalysisPlot()
{
    _statsName = Enum.GetNames(typeof(Window1.ROISignalList));

    int count = 0;
    _statsEnableIndex = new int[_nActiveStatsOneChannel];
    for (int i = 0; i < _nMaxStatsOneChannel; i++)  // assign color
    {
        if (_statsEnable[i] == 1)
        {
            _statsEnableIndex[count] = i;
            count++;
        }
    }

    if (_nActiveChannel > 0)    // timeDomainPlotter init
    {
        _dataX = new List<double[]>();
        _dataY = new List<double[]>();

        double[] dataXOneCh = new double[_signalLength];
        double[] dataYOneCh = new double[_signalLength];

        dataXOneCh[0] = 0;
        dataYOneCh[0] = 0;

        for (int i = 0; i < _nActiveChannel; i++)
        {
            for (int j = 0; j < _nActiveStatsOneChannel; j++)
            {
                _dataX.Add(dataXOneCh);    // data x-y mapping init
                _dataY.Add(dataYOneCh);

                EnumerableDataSource<double> xOneCh = new EnumerableDataSource<double>(dataXOneCh);
                EnumerableDataSource<double> yOneCh = new EnumerableDataSource<double>(dataYOneCh);

                xOneCh.SetXMapping(xVal => xVal);
                yOneCh.SetXMapping(yVal => yVal);

                CompositeDataSource dsOneCh = new CompositeDataSource(xOneCh, yOneCh);

                LineAndMarker<MarkerPointsGraph> lam = timeDomainPlotter.AddLineGraph(dsOneCh,
                    new Pen(_curveBrush[_statsEnableIndex[j]], 2),
                    new CirclePointMarker { Size = 5, Fill = _curveBrush[_statsEnableIndex[j]] },
                    new PenDescription(_statsName[_statsEnableIndex[j]]));

            }
        }

        Action FitToView = delegate()
        {
            timeDomainPlotter.FitToView();
        };
        this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, FitToView);
    }
    else
    {
        return;
    }
}

public void RedrawSignalAnalysisPlot()
{
    int startIndex = _initialChildrenCount;

    if ((_nActiveStatsOneChannel > 0) && (_dataX != null) && (_dataY != null))
    {
        CompositeDataSource[] dsCh = new CompositeDataSource[_nActiveStatsOneChannel];
        int m, n;
        int index;

        for (int i = 0; i < _nActiveChannel; i++)
        {
            for (int j = 0; j < _nActiveStatsOneChannel; j++)
            {
                index = i * _nActiveStatsOneChannel + j;
                if (_dataX[index].Length == _dataY[index].Length)
                {
                    EnumerableDataSource<double> xOneCh = new EnumerableDataSource<double>(_dataX[index]);
                    xOneCh.SetXMapping(xVal => xVal);
                    EnumerableDataSource<double> yOneCh = new EnumerableDataSource<double>(_dataY[index]);
                    yOneCh.SetYMapping(yVal => yVal);
                    CompositeDataSource ds = new CompositeDataSource(xOneCh, yOneCh);

                    Action UpdateData = delegate()
                    {
                        m = i * 2;
                        n = j * 2;

                        // ((LineGraph)timeDomainPlotter.Children.ElementAt(startIndex + n + m * _nActiveStatsOneChannel)).DataSource = ds;
                        // ((LineGraph)timeDomainPlotter.Children.ElementAt(startIndex + n + m * _nActiveStatsOneChannel)).LinePen
                        //    = new Pen(new SolidColorBrush(_curveBrush[j]), 1);

                        ((MarkerPointsGraph)timeDomainPlotter.Children.ElementAt(startIndex + n + 1 + m * _nActiveStatsOneChannel)).DataSource = ds;
                        //  ((MarkerPointsGraph)timeDomainPlotter.Children.ElementAt(startIndex + n + 1 + m * _nActiveStatsOneChannel)).Marker
                        //      = new CirclePointMarker { Size = 5, Fill = Brushes.Green };
                    };

                    this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, UpdateData);
                }

            }

        }

        /* Action PlotFitToView = delegate()
          {
              timeDomainPlotter.FitToView();
          };

         this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, PlotFitToView);*/
    }
} 
```

以下是文件的监控方式： 事件（文件写入）的归档位置

```
void tiffWatcher_EventChanged(object sender, WatcherExEventArgs e)
{
    string fileName = ((FileSystemEventArgs)(e.Arguments)).FullPath;
    string fileExt = StringExtension.GetLast(fileName, 4);

    if (!IsFileLocked(fileName))
    {

        Action EventFinished = delegate()
        {
            CreateListViewItem(fileName, "Finished", DateTime.Now.ToString("HH:mm:ss.fff"));
        };

        listView1.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, EventFinished);

        _tiffName.Add( fileName);
        _tiffFilledCount++;    
    }
} 
```

tiff 数据处理，以及与 d3 绘图仪的数据通信：

```
void tiffTimer_Tick(object sender, EventArgs e)
{
    //throw new NotImplementedException();
    byte[] image = new byte[_signalManager.ImgWidth * _signalManager.ImgHeight];

    if (_tiffFilledCount - _tiffProcessedCount >= 1)
    {

        string fileName = _tiffName[_tiffProcessedCount++];
        char filePre = fileName[49];
        int indexBeigin = fileName.LastIndexOf("_");
        int indexEnd = fileName.LastIndexOf(".");

        _signalIndex = Convert.ToInt32(fileName.Substring(indexBeigin + 1, indexEnd - indexBeigin - 1)) - 1; // 0 based//
        _deltaT = ExtractTiffDeltaT(fileName, "DeltaT=", 1);
        _channelIndex = (int)Enum.Parse(typeof(ChannelList), Convert.ToString(filePre));
        TIFFIImageIO.LoadTIFF(fileName, ref image);
        _signalManager.Image = image;
        for (int i = 0; i < _nActiveStatsOneChannel; i++)
        {
            _signalManager.GetSignal( _signalDisplay.StatsEnableIndex[i], ref _signal);
            UpdateSignal(_channelIndex, i, _tiffProcessedCount-1, _deltaT, _signal);
        }

      // if( _tiffProcessedCount % 5 == 0)
        _signalDisplay.SetData(_XList, _YList, true);
    }
} 
```

我使用 Timer.Tick 每 50-100 毫秒处理一次文件，仍在测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T15:43:45.740

我处理它的方式是设置一个定时器，循环处理计算，显示。到目前为止，它工作正常。当然会有很多事件丢失，但是我们处理大量的点（数千个），所以数百个做情节是可以的。这是代码：

```
private Timer _tiffTimer;
void Window1_Loaded(object sender, RoutedEventArgs e)
        {
            //throw new NotImplementedException();
            _tiffTimer = new Timer();
            _tiffTimer.Interval = 50;  // change interval to change performance
            _tiffTimer.Tick += new EventHandler(tiffTimer_Tick);
            _tiffTimer.Start();

        }

void tiffTimer_Tick(object sender, EventArgs e)
        {
            //do your stuff here

        } 
```

# ios - iOS - SplitViewController 替代方案？

> ID：15234356
> 
> 赞同：1
> 
> 时间：2013-03-05T21:21:47.697
> 
> 标签：ios, uisplitviewcontroller

我希望以`UISplitViewController`App Store 可接受的方式更改主视图的宽度。更改私有`_masterColumnWidth`财产原则上可行，但我假设如果提交到 App Store 它将被拒绝。

我研究了一个普遍推荐的替代方案，[`MGSplitViewController`](https://github.com/mattgemmell/MGSplitViewController/ "MGSplitViewController")但它已经有一段时间没有更新了，至少在我对 iOS 6+ 的测试中表现得有点零星——当你不断旋转设备时，并不总是正确地计算视图的几何形状. 考虑到这几乎`UISplitViewController`是我需要实现的唯一更改，还有其他选择吗？

# git-checkout - 什么控制 git checkout 反馈？

> ID：15234357
> 
> 赞同：7
> 
> 时间：2013-03-05T21:21:49.913
> 
> 标签：git-checkout

有时一个`git checkout`命令会给出进度反馈：

```
$ git checkout develop
Checking out files: 100% (10779/10779), done.
Switched to branch 'develop' 
```

有时它不会，（下一个命令行，相同的 repo 上下文）：

```
$ git checkout master
Switched to branch 'master' 
```

这不是因为分支相等，因为切换回下一个命令会显示以下反馈：

```
$ git checkout develop
Checking out files: 47% (5067/10779), done.
Switched to branch 'develop' 
```

这也发生在小型回购中。我有一个只有 13 个文件的存储库，当我在分支中添加一个文件并使用 checkout 来回切换时，我没有得到任何反馈。是某种“这需要很长时间，开始显示反馈”的计时器吗？

我搜索了（谷歌，Stackoverflow），但没有找到任何具体的东西。我确实找到了一些补丁文档，其中显示了在 checkout 中添加了一个 --verbose 标志，该标志强制反馈总是发生，但我找不到解释为什么反馈有时在没有该补丁的情况下才会发生。相同的注释指出，只有当 isatty() 返回 true 时才会发生反馈，但这在这里不相关，因为上面的所有命令都输入到同一个 bash 窗口中，这可能是 isatty。

我正在使用 git `version 1.8.1.msysgit.1`（从 gi​​t-scm.com 下载为 1.8.1.3），据我所知，它没有 --verbose 补丁。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-11-08T10:18:41.277

此结帐输出现在应该与 Git 2.7（2015 年 11 月/12 月）更加一致

请参阅[Edmundo Carmona Antoranz (](https://github.com/eantoranz) [)的](https://github.com/eantoranz)[提交 870ebdb](https://github.com/git/git/commit/870ebdb9c4facb55ed4817c5ff0968c0aadb7283)（2015 年 11 月 1 日） 。^(（由)^([Junio C Hamano 合并](https://github.com/gitster))^([——](https://github.com/gitster))^在^([提交 6a38bd6](https://github.com/git/git/commit/6a38bd6268fd78ee3e551668bce7ef3a862332d4))^(中，2015 年 11 月 5 日）)[`eantoranz`](https://github.com/eantoranz)
^([`gitster`](https://github.com/gitster))

> " `git checkout`" 没有遵循通常的 " `--[no-]progress`" 约定，只实现了 " `--quiet`" 本质上是 " `--no-progress`" 的超集。
> 扩展命令以支持通常的“ `--[no-]progress`”。

该[`git checkout`文档](https://github.com/git/git/blob/6a38bd6268fd78ee3e551668bce7ef3a862332d4/Documentation/git-checkout.txt#L110-L114)现在显示：

```
--[no-]progress:: 
```

> `--quiet`除非指定，否则在附加到终端时，默认情况下会在标准错误流上报告进度状态。
> 即使没有附加到终端，此标志也启用进度报告，无论`--quiet`.
> 
> ## `checkout`: 添加`--progress`选项
> 
> 在正常情况下，和其他 git 命令一样，`git checkout`如果附加到终端，会将进度信息写入 stderr。
> **即使不使用终端，此选项也允许强制进度**。
> 此外，如果使用 option ，则可以跳过进度`--no-progress`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-12T21:22:43.893

在正常情况下，当检查操作是否运行超过一秒时，您将看到输出。

# android - ScoreLoop 成就在说成功时未发布到 Facebook 或 Twitter

> ID：15234359
> 
> 赞同：0
> 
> 时间：2013-03-05T21:22:02.853
> 
> 标签：android, mobile, game-engine, libgdx, scoreloop

我想看看你能不能帮我解决这个问题。我在我的 android 游戏中运行了 ScoreLoop，除了一件事之外，我一切都井井有条。当我尝试在 Facebook 或 Twitter 上发布我的成就时，应用程序告诉我它已成功发布，但我的 Facebook 时间线或 Twitter 页面上没有任何帖子。有什么我可能会丢失的吗？

我确实拥有 Internet 权限和其他权限。成就保存正确。

（如果这对你有用的话，我在 ICS 4.0.4 上使用三星 Galaxy S2）

我正在使用 ScoreLoopUI，并且确实添加了 PostOverlayActivity。该工具甚至可以通过 webview 对话框登录 Facebook 和 Twitter。

会不会是 Facebook 没有显示帖子，例如发布“本地主机或调试器”帖子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-18T09:18:06.613

FB 帖子没有出现，因为您没有为您的游戏发布的发行版集。目前，Scoreloop 仅在使用 Scoreloop 为游戏设置已发布分发时才会发布到 FB。这是因为，在帖子中.. 有一个您的游戏的下载链接，您的朋友可以从那里下载游戏。如果游戏没有已发布的分发集，则无法创建链接。

如果您尚未将您的游戏提交给 Scoreloop，请继续这样做，以便 Scoreloop 可以发布您的发行版。如果您已经提交了游戏，请在 developer.scoreloop.com 上查看您的发行状态。如有问题，请在 support.scoreloop.com 上发布消息，支持团队会就此与您联系。

# windows - IndexedDB 查看所有数据库和对象存储

> ID：15234363
> 
> 赞同：22
> 
> 时间：2013-03-05T21:22:19.037
> 
> 标签：windows, windows-store-apps, winjs, indexeddb

我在 Windows 8 应用程序中使用 IndexedDB，我对两者都很陌生。我已经能够成功地从对象存储中创建、读取、更新、删除对象，并创建了几个数据库和一些对象存储。我的问题是如何列出我所有的对象存储和数据库？我创建了一些不需要的假的，我想稍微清理一下，但我不记得它们的名字了。也许这是肛门保留，但似乎应该可以列出所有数据库和商店。谢谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2019-03-16T09:49:36.363

在撰写这篇文章 [chrome 72] 时，您可以在浏览器的控制台中使用以下命令列出所有数据库。本质上 `indexedDB.databases()`是一个`Promise`. 您可以使用它来获取所有数据库的列表作为数组。在数组上运行循环以获取数据库的名称。

```
indexedDB.databases().then(r => console.log(r)) 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-03-05T21:49:37.690

编辑 2018 这个答案不再适用：

`webkitGetDatabaseNames() is deprecated in chrome 60`

* * *

[在 Chrome webkit 中有一个函数可以返回所有数据库名称，从 Chrome 60 ( webkitgetdatabasenames](https://developers.google.com/web/updates/2017/06/chrome-60-deprecations#remove_indexeddbwebkitgetdatabasenames%22webkitgetdatabasenames%22) )开始，该函数不再可用：

```
indexedDB.webkitGetDatabaseNames().onsuccess = function(sender,args)
{ console.log(sender.target.result); }; 
```

还有另一个函数列出了在所有浏览器中工作的单个数据库中的所有对象存储：

```
indexedDB.open(databaseName).onsuccess = function(sender, args) 
{ console.log(sender.target.result.objectStoreNames); }; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-03-05T22:57:04.130

目前无法枚举[标准](http://www.w3.org/TR/IndexedDB/)中的现有数据库。Windows 8 应用程序使用 IE，它不提供非标准`webkitGetDatabaseNames`方法。您可以使用[IE10 中的选项对话框](http://browsers.about.com/od/internetexplorertutorials/ss/How-To-Manage-Browsing-History-And-Other-Private-Data-In-Ie10_9.htm)清除数据库。

标准中使用[IDBDatabase](http://msdn.microsoft.com/en-us/library/windows/apps/hh441231.aspx)实例的[objectStoreNames](http://msdn.microsoft.com/en-us/library/windows/apps/hh767347.aspx)方法定义了列出数据库内的商店。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-06-30T21:50:35.623

由于所有其他主题在此处引用为重复项。在 Chrome 中，您可以查看和删除所有已创建的数据库`Developer Tools > Application > Storage`。

查看 IndexedDB 内部：`chrome://indexeddb-internals/`

# asp.net-mvc - 跨 Web 和 Winforms/控制台解决方案共享项目的正确方法是什么？

> ID：15234367
> 
> 赞同：0
> 
> 时间：2013-03-05T21:22:26.140
> 
> 标签：asp.net-mvc, winforms, visual-studio

我正在将 .NET 2.0 Winforms 应用程序转换为 ASP.NET MVC3。Winforms 解决方案为业务逻辑使用了多个项目，MVC 应用程序包括这些项目。这些项目也被各种 Windows 控制台应用程序使用。

问题是这些项目用于`System.Windows.Forms.Application.StartupPath`查找他们使用的文件，而用于 Web 开发`System.Web.HttpRunTime.AppDomainAppPath`。

我希望这两种解决方案都使用相同的项目，并且这些项目尽可能少地被修改，因为它们很大、很旧并且相对没有文档。解决此问题的正确方法是什么？

现在我想我会为每个定义 WEB 的项目创建一个新配置，然后使用`#if/#else`语句来包含正确的依赖关系并定义`getPath()`方法的返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:25:23.450

这就是类库的用途。创建一个类库项目，将所有公共位移到那里，然后有一个单独的 WinForms 和 MVC 项目，它们都引用您的类库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T04:35:01.577

在开始使用预处理器困扰您的代码之前，您应该考虑创建一个接口`IApplicationConfigurator`或`IApplicationStarter`

```
public interface IApplicationStarter
{
    string GetPath();
} 
```

并根据您的应用程序将其注入 a`MvcApplicationStarter`或 a 。`WinformsApplicationStarter`然后，您可以让您的项目库依赖于`IApplicationStarter`接口。它应该需要对项目进行最少的实现，并且您可以将该模式重用于其他常见的依赖项。[研究依赖注入框架](https://stackoverflow.com/questions/21288/which-net-dependency-injection-frameworks-are-worth-looking-into)，因为它将这种方法带入了*一个新*的水平。

# php - PHP数字格式4位

> ID：15234368
> 
> 赞同：6
> 
> 时间：2013-03-05T21:22:27.353
> 
> 标签：php, numbers, number-formatting

例如，我有这种格式： `$s_number = "12";`对于这个输入，我需要`0012`作为输出：

另一个例子：

输入`$s_number = "3";` 输出：`0003`

每次我需要 4 位数字时，我都希望发生这种情况。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-05T21:26:07.713

它不会是一个数字（而是一个字符串），但您可以使用 str_pad 来做到这一点。在您的示例中：

```
$s_number = str_pad( "12", 4, "0", STR_PAD_LEFT );
$s_number = str_pad( "3", 4, "0", STR_PAD_LEFT ); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-05T21:26:01.063

用于[`str_pad()`](http://www.php.net/manual/en/function.str-pad.php)：

```
echo str_pad($number, 4, '0', STR_PAD_LEFT); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T21:26:27.673

您可以使用 phps 轻松实现此目的`printf`

```
<?php
$s_number = '12';
printf("%04d", $s_number);
?> 
```

希望这可以帮助

# android - 在纵向模式下拍摄的图像应保留在android中的横向模式下

> ID：15234373
> 
> 赞同：0
> 
> 时间：2013-03-05T21:22:52.623
> 
> 标签：android, orientation, android-camera, landscape-portrait

我正在创建一个应用程序，在该应用程序中单击操作栏项目，相机活动开始，并在捕获并保存图片后，将其显示在主要活动中。

现在，如果我在纵向时从 MainActivity 启动相机，然后在相机 Activity 中切换到横向，拍照，然后单击保存按钮，它会返回到 MainActivity，但图像不显示，这是我猜测是因为主要活动正在重新加载，但我不确定。

即使在方向改变之后，我如何才能保留图像。

MainActivity.java

```
public boolean onOptionsItemSelected(MenuItem item) {
     switch (item.getItemId()) {
     case R.id.menu_camera: 

        Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

        // file creation for saving video
        Uri fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE);  
        if (fileUri != null) {
            targetFile = fileUri.getPath();

            // setting file image name
            intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri);   

            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);

            startActivityForResult(intent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
        }

        return true; 
```

onActivityResult()

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
        if (resultCode == RESULT_OK) {
            // Image captured and saved to fileUri specified in the Intent
            ImageView imgPicture = (ImageView) findViewById(R.id.imgPicture);
            if (targetFile != null) {
                theFile = targetFile;
                imgPicture.setImageBitmap(BitmapFactory.decodeFile(theFile));
            }

        } else if (resultCode == RESULT_CANCELED) {

        } else {

            Toast.makeText(this, "Your picture could not be saved.", Toast.LENGTH_LONG).show();
        }
    }
} 
```

清单.xml

```
 <uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="17" />

<uses-feature
    android:name="android.hardware.camera"
    android:required="true" />

<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.ActionBarTest.MainActivity"
        android:label="@string/app_name" 
        android:launchMode="singleTop">

        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:49:20.180

也许您可以使用它来知道图像是如何保存的，然后制作位图或基于它的任何东西

```
public static int getExifRotation(String imgPath) 
    {
        try 
        {
            ExifInterface exif = new ExifInterface(imgPath);
            String rotationAmount = exif.getAttribute(ExifInterface.TAG_ORIENTATION);
            if (!TextUtils.isEmpty(rotationAmount)) 
            {
                int rotationParam = Integer.parseInt(rotationAmount);
                switch (rotationParam) 
                {
                    case ExifInterface.ORIENTATION_NORMAL:
                        return 0;
                    case ExifInterface.ORIENTATION_ROTATE_90:
                        return 90;
                    case ExifInterface.ORIENTATION_ROTATE_180:
                        return 180;
                    case ExifInterface.ORIENTATION_ROTATE_270:
                        return 270;
                    default:
                        return 0;
                }
            } 
            else 
            {
                return 0;
            }
        }
        catch (Exception ex) 
        {
            return 0;
        }
    } 
```

还要检查

```
if(bitmap.getWidth() > bitmap.getHeight()){} 
```

这会让你知道图片是否是横向的，因为宽度会大于高度，并使用位图构造函数来旋转矩阵：

```
Matrix matrix = new Matrix();
matrix.postRotate(90); //or whatever 
```

# soap - “理解”标记为“必须理解”的肥皂标题是什么意思

> ID：15234380
> 
> 赞同：13
> 
> 时间：2013-03-05T21:23:12.570
> 
> 标签：soap

我正在学习 SOAP。我看到一些标题元素具有可以设置为真或假的“必须理解”属性。但是“理解”一个肥皂信息是什么意思呢？解析它没有错误？我发现一些网站[并没有](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapheader.mustunderstand.aspx) [真正](http://wso2.org/library/tutorials/understand-famous-did-not-understand-mustunderstand-header-s-error) [解释它](http://tutorials.jenkov.com/soap/header.html)。

有人可以告诉我发生了什么吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-09T21:01:03.003

为了调用 Web 服务，您需要尊重它的合同。如果一个 Web 服务有`<operationA>`但`<operationB>`你发送`<operationC>`给它，你会得到一个错误（在 SOAP 用语中是错误的）。

当消息包含或时， Web 服务具有操作`<operationA>`并且`<operationB>`知道如何处理该消息。但它没有也不知道如何处理包含的消息，所以它只是返回一个错误。不能忽略不正确的主体，但另一方面，标头对它们的内容没有限制，因此您需要不同的机制才能正确处理它们。`<operationA>``<operationB>``<operationC>``<operationC>`

标头用于通过添加事务支持、身份验证、路由等来扩展消息。但是这些扩展并没有在 SOAP 规范中定义，它们是用户定义的。规范只是说标题用于此目的，并且还指定了当标题存在时必须如何处理消息。**该`mustUnderstand`属性是“应该如何处理消息”的一部分。**

一条 SOAP 消息从发起者传送到最终目的地，可能是通过沿消息路径的一组 SOAP 中介。标头可以针对特定节点或最终节点（即 SOAP 1.1`actor`属性或 SOAP 1.2`role`属性），当这种情况发生时，节点必须对标头执行某些操作。这可以是使用它或忽略它。

**该`mustUnderstand`属性指示对报头的处理是可选的还是强制的。这基本上转化为节点试图找到与标头匹配的适当处理程序并以与其规范一致的方式继续处理消息。如果找不到合适的处理程序，它必须返回错误并停止进一步处理。如果`mustUnderstand`为 true/1，则不允许节点忽略它。**

例如，假设标头用于事务语义（即调用必须在事务中执行，以便操作以原子方式执行，要么全部成功，要么全部失败）。如果处理节点看到事务头，它应该启动该事务。想象一下，如果节点看到标头但不知道它是什么，所以它决定忽略它并且不启动任何事务会发生什么。后来，一些操作失败，而另一些成功，没有事务可以回滚。所以现在你的应用程序处于不一致的状态。

> SOAP mustUnderstand 属性允许稳健发展。必须假定用值为“1”的 SOAP mustUnderstand 属性标记的元素以某种方式修改其父元素或对等元素的语义。以这种方式标记元素可确保语义上的这种变化不会被那些可能不完全理解它的人默默地（并且可能是错误地）忽略。
> 
> *   [http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383500](http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383500)

# c# - VS2010 模块列表中缺少 DLL

> ID：15234384
> 
> 赞同：5
> 
> 时间：2013-03-05T21:23:30.037
> 
> 标签：c#, c++, visual-studio-2010, debugging, pinvoke

我真的一直在用头撞到众所周知的墙上。

我有一个同时包含 C# 和 C++ 代码项目的解决方案。

我经常调用 C++ DLL，它们是在这个项目中通过 P/Invoke 从 C# 编译的。没问题。据我所知，通过 *.sln 文件以及 C++ 和 C# 文件进行的所有必需的调试器设置都已正确设置。注意：我经常能够毫无问题地调试类似的 P/Invoked C++ 代码！

自然地，我想，也许符号没有加载——然而，在打开模块窗口时，我发现我试图进入的 DLL 甚至没有列出！在我的 C# 程序中运行该函数确实使用了 DLL（我得到了正确的输出），但是，在查看 Modules 窗口时，DLL 仍然没有出现。

有人知道发生了什么吗？

tl;dr --> 我在调试 P/Invoked C++ 方面有相当多的经验。但是，我希望调试的 DLL 甚至没有出现在模块列表中（因此，如果 VS 调试器似乎完全不知道它的存在，我显然无法进入它）。

提前致谢！！

干杯!

-卡达伊

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T22:22:05.793

我的猜测是您没有为非托管代码打开调试。转到启动项目的属性->调试选项卡。选中“启用非托管代码调试”。

# ios - NSOperation 层次结构，工作单元

> ID：15234392
> 
> 赞同：0
> 
> 时间：2013-03-05T21:23:45.153
> 
> 标签：ios, nsoperation

所以我想知道将长任务分解为 NSOperations 的最佳方法是什么。如果我有 3 个长时间运行的任务，最好有一个 NSOperation 子类，它基本上可以做类似的事情

```
Single NSOperation subclass
- (void)main {
  // do long running task 1
  // do long running task 2
  // do long running task 3

  // call back the delegate
} 
```

还是让每个任务成为 NSOperation 的子类，然后将我的 ViewController 中的每个任务作为一个工作单元来管理更好？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:28:21.923

这取决于操作队列是串行（即最大并发操作1）还是并行，以及工作的性质是什么。如果队列是串行的，那真的没关系。如果队列是并行的，那么它取决于一堆因素：

*   同时做的工作安全吗
*   工作是否在共享资源（例如网络或磁盘 IO，或锁）上竞争，以消除并发性
*   每个工作单元是否足够大，值得单独调度的开销

（编辑）

另外，如果您不需要 NSOperationQueue 的高级功能（操作依赖项和优先级、KVO 等），请考虑使用调度队列。它们的重量明显更轻。

# jquery - AJAX JQuery 从数据库中删除

> ID：15234394
> 
> 赞同：0
> 
> 时间：2013-03-05T21:23:48.253
> 
> 标签：jquery

我正在尝试从 php 中创建的表中删除动画行。

我是 AJAX 和 JQuery 的菜鸟，我似乎看不出哪里出错了。我也尝试关注我获得代码的网站[http://davidwalsh.name/animated-ajax-jquery](http://davidwalsh.name/animated-ajax-jquery)但似乎发生的事情是当我点击删除链接时没有任何反应。

这是我的 delete.php

```
 // connect to the database
  $dbConn = odbc_connect("flamingo","","")
    or die("Error opening database .... use the browsers BACK button");

  if (isset($_GET['id']))
  {
  $id = $_GET['id'];

  $result = odbc_exec($dbConn,"DELETE FROM prodList WHERE prodCode='$id'")
    or die("ERROR: Cannot Delete Record!");
  } 
```

这是我的 HTML

```
 <html>
   <head>
      <title>Delete a Flamingo Product from the list</title>
      <script src="script/jquery-1.9.1.min.js" type="text/javascript"></script>
      <script type="text/javascript">
        $(document).ready(function() {
  $('a.delete').click(function(e) {
    e.preventDefault();
    var parent = $(this).parent("td").parent("tr");
    $.ajax({
      type: 'get',
      url: 'delete.php',
      data: 'ajax=1&delete=' + parent.attr('id').replace('record-',''),
      beforeSend: function() {
        parent.animate({'backgroundColor':'#fb6c6c'},300);
      },
      success: function() {
        parent.slideUp(300,function() {
          parent.remove();
        });
      }
    });
  });
});
      </script>
   </head>

<body>
<b><font color="#000099"><font size=+2>Flamingo Product List&nbsp;</font></font></b>
&nbsp;&nbsp;&nbsp;&nbsp;<img SRC="pinkflamingo.gif" NOSAVE height=85 width=61>
<p>

<?php

    /* script to list all the products in the prodList table
        use default ODBC connection
        variables
         $dbConn   - database connection
         $sqlQuery - a query string
         $dbResult - result of a, SQL query
         $rows     - number of rows
    */

    // connect to the database
    $dbConn = odbc_connect("flamingo","","")
      or die("Error opening database .... use the browsers BACK button");

    //Veiw record and delete

        $result = odbc_exec($dbConn,"SELECT * FROM prodList ORDER BY prodCode")
      or die("Error Retrieving Product Listing");

    echo "<table border='1' cellpadding='10'>";
    echo "<tr>
    <th><font color='Red'>Code</font></th>
    <th><font color='Red'>Name</font></th>
    <th><font color='Red'>Description</font></th>
    <th><font color='Red'>Price</font></th>
    <th><font color='Red'>Delete</font></th>
    </tr>"; 

    while($row = odbc_fetch_row( $result ))
    {

    echo '<tr class="record" id="record-',$row['item_id'],'">';
    echo '<td><b><font color="#663300">' . odbc_result ($result, "prodCode") . '</font></b></td>';
    echo '<td><b><font color="#663300">' . odbc_result ($result, "prodName") . '</font></b></td>';
    echo '<td><b><font color="#663300">' . odbc_result ($result, "prodDesc") . '</font></b></td>';
    echo '<td><b><font color="#663300">' . odbc_result ($result, "prodPrice") . '</font></b></td>';
    echo '<td><b><font color="#663300"><a href="?delete=',$row['item_id'],'" class="delete">Delete</a></font></b></td>';
    echo "</tr>";

}

echo "</table>";
?> 
```

你能看到我哪里出错了，看看我能做些什么来解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:37:24.583

我相信你的问题出在这条线上：

```
var parent = $(this).parent("td").parent("tr"); 
```

可能正在 **`$(this)`**返回. 尝试在您的 HTML 标记中使用 id，以便您可以选择如下元素：`JQuery $('a.delete').click(function(e) {}`

```
 $('#element_id') 
```

这可以让您更好地控制您的选择。

# php - Mysql INSERT INTO 不会插入带有变量的数据库，但没有

> ID：15234398
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:23:57.807
> 
> 标签：php, mysql, database, forms

我一直在尝试，但我不知道我的代码有什么问题。

```
<?php
session_start();
include('../database.php');
$to = mysql_real_escape_string($_POST['to']);
$from = $_SESSION['username'];
$msg = mysql_real_escape_string($_POST['msg']);
$subject = mysql_real_escape_string($_POST['subject']);
echo $to, $from, $msg, $subject;
$_SESSION['to'] = $to;
$_SESSION['msg'] = $msg;
$_SESSION['subject'] = $subject;
$err = array( );
$errflag = false;
if ($to = '') {
    $err[ ] = 'Missing To.';
    $errflag = true;
}
if ($from = '') {
    $err[ ] = 'Please Login.';
    $errflag = true;
}
if ($msg = '') {
    $err[ ] = 'Missing Message.';
    $errflag = true;
}
if ($subject = '') {
    $err[ ] = 'Missing Subject.';
    $errflag = true;
}
if ($errflag = true) {
    $_SESSION['mailerr'] = $err;
    //header('Location: send.php');
}
$result = mysql_query("INSERT INTO mail(id, subject, to, from, msg) VALUES(NULL,'" . $subject . "', '" . $to . "', '" . $from . "', '" . $msg . "')");
if ($result) {
    echo "No Errors";
} else {
    echo mysql_error();
}
//header("Location: index.php");
?> 
```

当我手动插入数据而不是变量时，它可以工作，但是当我尝试使用变量时却不行。

还有我得到的错误

```
You have an error in your SQL syntax; check the manual that corresponds 
to your  MySQL server version for the right syntax to use near 
'to, from, msg) VALUES(NULL, '', '', '', '')' at line 1 
```

这是send.php

```
<form method="post" action="insert.php">
   <table border="0">
      <tr>
         <td>Subject:</td>
         <td><input type="text" id="subject" name="subject" value="<?php if(isset($_POST['subject'])){echo $_POST['subject'];}else if(isset($_SESSION['subject'])){echo $_SESSION['subject']; unset($_SESSION['subject']);}?>"/></td>
      </tr>
      <tr>
         <td>To:</td>
         <td><input type="text" id="to" name="to" value="<?php if(isset($_POST['to'])){echo $_POST['to'];}else if(isset($_SESSION['to'])){echo $_SESSION['to']; unset($_SESSION['to']);}?>"/></td>
      </tr>
   </table>
   <?php if(isset($_POST['old'])){echo "<textarea disabled=disabled rows='8' cols='20'>".$_POST['old']."</textarea><br />";}?>
   <input type="text" name="msg" />
   <br />
   <input type="submit" name="msg" id="msg" value="Send"/>
</form>
</div>
</body>
</html> 
```

我不知道错误是什么我已经尝试了一切。也只有这个页面。当我为其他所有事情都这样做时，它工作得很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:26:12.467

你用

```
if($from = ''){ 
```

到处。

将其更改为：

```
if($from == ''){ 
```

这样你比较变量，而不是设置它....

另外，您在 mysql 查询中使用保留关键字。反引号可以解决这个问题。

```
INSERT INTO mail(`id`, `subject`, `to`, `from`, `msg`) 
```

另一个提示：为新项目使用 PDO 或 mysql 和准备好的语句。如果有一个`'`in $subject，你也会得到这个错误（虽然你似乎逃避它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:27:18.770

`TO`并且`FROM`是mysql的保留关键字

尝试使用反引号

```
 INSERT INTO mail(id, subject, `to`, `from`, msg) 
```

# asp.net-mvc - 创建自定义 301 重定向页面

> ID：15234403
> 
> 赞同：1
> 
> 时间：2013-03-05T21:24:15.670
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing, url-routing, httpresponse

我正在尝试使用自定义路由（派生自 RouteBase 的类）编写 301 重定向方案，类似于为[MVC 中的任何级别处理旧版 url](https://stackoverflow.com/questions/4970321/handling-legacy-urls-for-any-level-in-mvc#answer-4971478)。我正在使用反射器查看 RedirectPermanent() 方法中的 HttpResponse 类，并注意到代码既设置了状态又输出了一个简单的 HTML 页面。

```
 this.StatusCode = permanent ? 0x12d : 0x12e;
    this.RedirectLocation = url;
    if (UriUtil.IsSafeScheme(url))
    {
        url = HttpUtility.HtmlAttributeEncode(url);
    }
    else
    {
        url = HttpUtility.HtmlAttributeEncode(HttpUtility.UrlEncode(url));
    }
    this.Write("<html><head><title>Object moved</title></head><body>\r\n");
    this.Write("<h2>Object moved to <a href=\"" + url + "\">here</a>.</h2>\r\n");
    this.Write("</body></html>\r\n"); 
```

这是可取的，因为根据我的经验，并非所有浏览器都配置为遵循 301 重定向（尽管搜索引擎会这样做）。因此，如果浏览器没有自动转到该页面，也应该给用户一个指向该页面的链接。

我想做的是把它提升到一个新的水平——我想输出 MVC 视图的结果（连同它的主题布局页面），而不是在响应中硬编码丑陋的通用 HTML。就像是：

```
 private void RedirectPermanent(string destinationUrl, HttpContextBase httpContext)
    {
        var response = httpContext.Response;

        response.Clear();
        response.StatusCode = 301;
        response.RedirectLocation = destinationUrl;

        // Output a Custom View Here
        response.Write(The View)

        response.End();
    } 
```

如何将视图的输出写入响应流？

**附加信息**

过去，我们遇到过从 mydomain.com 到 www.mydomain.com 的 301 重定向问题，随后收到大量用户报告 SSL 证书无效。搜索引擎完成了他们的工作，但在我切换到 302 重定向之前，用户遇到了问题。我实际上无法重现它，但我们收到了大量报告，所以必须做点什么。

我计划让视图执行元重定向和 javascript 重定向，以帮助提高可靠性，但对于那些仍停留在 301 页面的用户，我希望他们有宾至如归的感觉。我们已经有自定义的 404 和 500 页面，为什么不也有自定义主题的 301 页面呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:53:26.337

事实证明，我只是想多了这个问题，解决方案比我想象的要简单得多。我真正需要做的就是使用 routeData 将请求推送到另一个控制器操作。让我失望的是需要附加到请求中的额外 301 状态信息。

```
 private RouteData RedirectPermanent(string destinationUrl, HttpContextBase httpContext)
    {
        var response = httpContext.Response;

        response.CacheControl = "no-cache";
        response.StatusCode = 301;
        response.RedirectLocation = destinationUrl;

        var routeData = new RouteData(this, new MvcRouteHandler());
        routeData.Values["controller"] = "Home";
        routeData.Values["action"] = "Redirect301";
        routeData.Values["url"] = destinationUrl;

        return routeData;
    }

    public override RouteData GetRouteData(HttpContextBase httpContext)
    {
        RouteData result = null;

        // Do stuff here...

        if (this.IsDefaultUICulture(cultureName))
        {
            var urlWithoutCulture = url.ToString().ToLowerInvariant().Replace("/" + cultureName.ToLowerInvariant(), "");

            return this.RedirectPermanent(urlWithoutCulture, httpContext);
        }

        // Get the page info here...

        if (page != null)
        {
            result = new RouteData(this, new MvcRouteHandler());

            result.Values["controller"] = page.ContentType.ToString();
            result.Values["action"] = "Index";
            result.Values["id"] = page.ContentId;
        }

        return result;

    } 
```

我只需要返回 RouteData 以便路由器可以处理它！

另请注意，我添加了一个 CacheControl 标头以防止 IE9 和 Firefox 以无法清除的方式缓存重定向。

现在我有一个不错的页面，当浏览器无法遵循 301 时，它会向用户显示链接和消息，并且我将添加元重定向和 javascript 重定向到要启动的视图 - 浏览器很可能会遵循其中一个.

> 另请参阅[此答案](https://stackoverflow.com/a/36168395/181087)以获得更全面的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:23:44.557

假设您可以访问`HttpContextBase`以下内容，您可以如何将控制器操作的内容呈现给响应：

```
private void RedirectPermanent(string destinationUrl, HttpContextBase httpContext)
{
    var response = httpContext.Response;

    response.Clear();
    response.StatusCode = 301;
    response.RedirectLocation = destinationUrl;

    // Output a Custom View Here (HomeController/SomeAction in this example)
    var routeData = new RouteData();
    routeData.Values["controller"] = "Home";
    routeData.Values["action"] = "SomeAction";
    IController homeController = new HomeController();
    var rc = new RequestContext(new HttpContextWrapper(context), routeData);
    homeController.Execute(rc);

    response.End();
} 
```

这将呈现在响应`SomeAction`上。`HomeController`

# javascript - 正则表达式只工作一次

> ID：15234407
> 
> 赞同：2
> 
> 时间：2013-03-05T21:24:33.517
> 
> 标签：javascript, regex

我最近通过[在此处](http://to-do-today.com)创建一个待办事项列表 Web 应用程序来学习 JavaScript 。

到目前为止，几乎一切正常，但是如果您尝试多次选中和取消选中一个项目，我会遇到问题。如果您继续选中/取消选中，您会看到删除按钮消失并`-->`出现在紧急图标之后。

图标的更改是通过正则表达式将代码从已注释更改为未注释来完成的。我只是不明白为什么如果它只工作一次，它就不能每次都工作？

```
if (tr.outerHTML.indexOf("checked=\"\"") >= 0) {

    // replace checked with unchecked
    var cookieHTML = tr.outerHTML.replace(/checked=\"\" class=\"list-checkbox\"/, 'class=\"list-checkbox\"')
    .replace(/<tr class=\"list-row done\"/, '<tr class=\"list-row\"')

    // change delete button to urgency.
    .replace(/<!--<span aria-hidden=\"true\" data-icon=\"c\"/, '<span aria-hidden="true" data-icon="c"')
    .replace(/alt=\"Neutral\"><\/span>-->/, 'alt="Neutral"></span>')

    .replace(/<!--<span aria-hidden=\"true\" data-icon=\"f\"/, '<span aria-hidden="true" data-icon="f"')
    .replace(/alt=\"Urgent\"><\/span>-->/, 'alt="Urgent"></span>')

    .replace(/<span aria-hidden=\"true\" data-icon=\"e\"/, '<!--<span aria-hidden="true" data-icon="e"')
    .replace(/onclick=\"deletetodo\(this\)\"><\/span>/, 'onclick="deletetodo(this)"></span>-->');

} else {

    // else add checked to the input.
    var cookieHTML = tr.outerHTML.replace(/class=\"list-checkbox\"/, 'checked class=\"list-checkbox\"')
    .replace(/<tr class=\"list-row\"/, '<tr class=\"list-row done\"')

    // change urgency to delete button.
    .replace(/<span aria-hidden=\"true\" data-icon=\"c\"/, '<!--<span aria-hidden="true" data-icon="c"')
    .replace(/alt=\"Neutral\"><\/span>/, 'alt="Neutral"></span>-->')

    .replace(/<span aria-hidden=\"true\" data-icon=\"f\"/, '<!--<span aria-hidden="true" data-icon="f"')
    .replace(/alt=\"Urgent\"><\/span>/, 'alt="Urgent"></span>-->')

    .replace(/<!--<span aria-hidden='true' data-icon='e'/, '<span aria-hidden="true" data-icon="e"')
    .replace(/onclick='deletetodo\(this\)'><\/span>-->/, 'onclick="deletetodo(this)"></span>');

} 
```

这是控制它的（相当大的！）JS 块。有什么想法有什么问题吗？或者也许是改变这些图标的更好方法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:46:06.823

我会说：你做错了。使用字符串/正则表达式替换方法不是正确的方法。

而不是做那些替换使用 DOM 方法，即：

```
someElement.setAttribute('data-icon', 'f');
someElement.setAttribute('alt', 'Urgent'); 
```

一个简单的例子可以在这里找到：http: [//jsbin.com/iwakof/1/edit](http://jsbin.com/iwakof/1/edit)

[*我知道这不是您问题的直接答案，但相信我这是要走的路*]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:21:45.400

你正在学习 JavaScript 真是太棒了。不错的工作。但是，我很高兴您发布了这个问题，因为看起来您可以使用几个指针。

你的问题的答案是——是的，有一种更简单的方法可以实现这种效果——我很快就会讲到。但首先 - 我注意到在您的待办事项应用程序的底部，您包含一个名为 JQuery 的库

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

这个库将对您有很大帮助，不仅在您上面描述的函数中，而且对您编写的大部分代码都有帮助。你最终会得到更清晰和自我解释的代码。

[http://jquery.com/](http://jquery.com/)

基本上，JQuery 允许您做的是操纵 DOM 的状态。你肯定想从这里开始。

这是一个小示例，它显示了一个可以选中或取消选中的复选框，并且在更改时，可以根据需要显示或隐藏一个元素。

[http://jsfiddle.net/m4vGE/5/](http://jsfiddle.net/m4vGE/5/)

请 - 花时间看看 JQuery - 这是你可以采取的很好的第一步，可以提高你的生产力并降低 JavaScript 的复杂性

另外 - 作为旁注，如果你发现自己使用 js 来构建带有字符串的 HTML，答案总是“有更好的方法”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:53:06.213

如果您要做的只是根据是否选中复选框来更改图标，您可以执行类似的操作。

```
 function getVisibility()
{
  var temp = document.getElementById("iconName").style.visibility;

  return temp;
}

function switchIfChecked()
{

  var current = getStyle();

  if( current == "visible" )
   {
     document.getElementById("iconName").style.visibility = "hidden";
   }
   else
   {
     document.getElementById("iconName").style.visibility = "visible";
   }
}

<div id="iconName" style="visibility: visible">INSERT ICON IMG here</div> 
```

上面所做的是它使图标的 div 可见或隐藏。当然，您需要有两个 div，然后将或设置为隐藏或可见。就你目前正在做的事情而言，你并没有真正让浏览器*做*任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:35:11.740

尝试使用正则表达式的全局选项（查看第二个斜杠后的 g）：

```
// ...
.replace(/<tr class=\"list-row done\"/g, '<tr class=\"list-row\"')
// ... 
```

这是一个[例子](http://jsfiddle.net/CCDQW/)。

来自[developer.mozilla.org](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp#RegExp_instances-Properties)：

> global：是针对字符串中所有可能的匹配项测试正则表达式，还是仅针对第一个匹配项进行测试。

# css - ol 中的 ol 并使某些列表项扩展到父元素的宽度

> ID：15234409
> 
> 赞同：0
> 
> 时间：2013-03-05T21:24:43.437
> 
> 标签：css, html-lists

我对 css 有点陌生，并试图创建一个显示书籍列表的布局。因此，我想在两列布局的左侧显示封面图像（由小提琴中的固定宽度 div 表示）。在封面的右侧，我想展示关于这本书的信息：标题和一个包含属性值项的有序列表。

这些项目应填充宽度的剩余部分。属性及其对应的值应放在同一行。

其中一个属性值项还包含一个按钮，这里只是用一个跨度来表示。按钮应放置在属性之后的同一行中。

我遇到了几个问题，到目前为止我无法解决：

*   属性列表的格式不正确。我想这是因为我无法将包含的列表项配置为扩展到全宽。最后，属性值项应显示在同一行。

*   标题带有下划线，我希望看到下划线延伸到正文的整个宽度。目前它已被截断，我无法找到实现这一目标的方法。

我创建了一个小提琴，它应该显示问题：http: [//jsfiddle.net/7Xeb7/3/](http://jsfiddle.net/7Xeb7/3/)

这是我的基本 html 结构：

```
<body>
    <ul class="book">
        <li>
            <div class="cover"></div>
        </li>
        <li class="bookdetail">
            <div class="title">Title</div>
            <ol class="attributes">
                <li>
                    <span class="property">property <span>btn</span></span>
                    <span class="value">value</span>
                </li>
                <li>
                     <span class="property">property</span>
                    <span class="value">value</span>
                </li>
            </ol>
        </li>
    </ul>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:09:40.370

`div`我已相应地使用和更改了您的布局`tables`

```
<div class="leftColumn">

    </div>

    <div class="rightColumn">
        <div class="header">
            Title
        </div>

        <div class="content">
            <table width="100%">
                <tr><td>Property1<td><td>Value</td>
                <tr><td>Property2<td><td>Value</td>
                <tr><td>Property3<td><td>Value</td>
            <div>
 </div> 
```

和CSS

```
.leftColumn
{
    float:left;
    width:30%;
    height:250px;
    background-color:red;
}
.rightColumn
{
    float:right;
    width:70%;
    height:250px;
    background-color:green;
}
.header
{
    font-size:25px;
    padding:15px;
    height:30px;
    verticle-align:middle;
    border-bottom:1px solid #ccc;    
} 
```

看看[这里](http://jsfiddle.net/GqdBs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:48:07.457

**简答**

您的 HTML 比必要的要复杂一些，并且对于不是真正列表的事物非正统地使用列表元素。简化它会使页面样式更容易。我在这个 jsFiddle 中这样做了，我认为您的问题已经通过绝对定位`.cover`和添加适当的填充来解决：http `.bookdetails`: [//jsfiddle.net/7Xeb7/10/](http://jsfiddle.net/7Xeb7/10/)。（**编辑**：新的 jsfiddle 反映了评论）

**长答案**

您使用的 HTML 标记应尽可能与它们所代表的内容在*语义上相关。*因此，使用`ul`or`ol`表示事物列表，使用`img`图像，并使用标题标签（`h1`、`h2`等）作为标题。这里不需要使用`table`s （通常不赞成布局，因为它们违反了这种语义逻辑）。在这里，我保留了您的结构和 CSS 类，但使用了更多逻辑标签：

```
 <div class="book">
        <img class="cover" src="" alt="Book Title Here" />
        <div class="bookdetail">
            <h2 class="title">Title</h2>
            <ol class="attributes">
                <li>
                    <span class="property">property</span> <!-- this span wasn't closed before! -->
                    <span class="button">btn</span></span>
                    <span class="value">value</span>
                </li>
                <li>
                    <span class="property">property</span>
                    <span class="value">value</span>
                </li>
            </ol>
        </div><!-- /.bookdetail -->
    </div><!-- /.book --> 
```

清理完 HTML 后，您可以更轻松地进行必要的 CSS 更改。你的主要问题是`.bookdetail`在正确的地方。目前很难，因为您正在尝试平衡固定宽度元素 ( ) 与您想要占据其整个容器`.cover`的可变宽度元素 ( ) - 除了固定宽度元素。`.bookdetail`

这可以通过绝对定位相当容易地解决`.cover`，因此它不再对 中其他元素的定位产生任何影响`.book`。然后，您可以将 .bookdetail 的填充设置为`0 0 0 140px`- 自动相对于具有指定位置的最新父元素，这是我所做的`.book`。因此可以根据需要`.bookdetail`扩展以填充`book`，但正确的填充（或边距，如果您愿意）意味着它不会与封面图像重叠。

我还进行了一些其他 CSS 更改，在 jsFiddle 中可见，以使 .title 显示更好并适应我的 HTML 更改，但它们与解决您的主要问题没有直接关系，所以我将它们留在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:58:27.180

您缺少尺寸的宽度属性，但不确定这是否是您希望看到的方式：

[http://jsfiddle.net/Riskbreaker/7Xeb7/4/](http://jsfiddle.net/Riskbreaker/7Xeb7/4/)

**我在你的 bookdetail**课程上添加了 width: 100%

```
.bookdetail {
    vertical-align:top;
    display: inline-block;
    width: 100%;
} 
```

# php - 使用 php xpath 获取节点文本时遇到问题

> ID：15234425
> 
> 赞同：0
> 
> 时间：2013-03-05T21:25:32.470
> 
> 标签：php, xpath

我有以下html：

```
<div class="data">
    <p class="info">output</p>
     <p class="info">output2</p> 
```

我正在尝试使用以下内容获取文本“输出”

```
$xpath = new DOMXPath($dom);    

foreach ($xpath->evaluate("//div[@class='data']/p[1]") as $elt) {
    $output=$elt->wholeText;
}

echo $output; 
```

它不工作。我收到 2 个错误：

```
Message: Undefined property: DOMElement::$wholeText
Message: Undefined variable: output 
```

谁能指出我正确的方向？

提前致谢，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:43:51.803

**试试这个：**

```
$xpath = new DOMXPath($dom); 

$elements = $xpath->query("*/div[@class='data']");

if (!is_null($elements)) {
  foreach ($elements as $element) {
    $nodes = $element->childNodes;
    foreach ($nodes as $node) {
      echo $node->nodeValue. "\n";
    }
  }
} 
```

# windows-7 - Office 2013、Word、Excel 不再显示“以不同用户身份运行”是怎么回事？

> ID：15234426
> 
> 赞同：1
> 
> 时间：2013-03-05T21:25:40.177
> 
> 标签：windows-7, ms-office, runas

当我 shift + 右键单击​​ Word 2013 的快捷方式时，“以其他用户身份运行”不可用。它适用于非 Office 2013 快捷方式。

如何为 Office 2013 产品重新启用此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-27T03:48:12.990

打开 Windows 资源管理器，然后在右上角的搜索框中键入“winword”。等待结果回来。Shift+右键单击“WINWORD”条目，然后选择“以其他用户身份运行”。

# windbg - 以编程方式在托管代码中设置 ba（访问中断）断点

> ID：15234429
> 
> 赞同：1
> 
> 时间：2013-03-05T21:25:54.620
> 
> 标签：windbg, heap-corruption

为了调查托管堆损坏，我想使用 ba（访问中断）断点。我可以在托管代码中使用它们吗？如果是，我如何以编程方式设置它们？

更新：也可以在 WinDbg 中设置它们（-> 为每个 XY 类型的对象设置 ba）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T04:36:03.877

'ba' 命令设置的断点称为处理器或硬件断点。

**首先是好消息**

设置硬件断点很容易。您需要使用数据地址设置处理器的调试寄存器（DR0、DR1、DR2 或 DR3）之一，并使用字段设置调试控制寄存器 DR7 以设置内存大小和访问类型。指令（在 x64 汇编器中）如下所示：

MOV 拉克斯，DR0

显然，您将不得不从您选择的语言中以某种方式执行此汇编指令，或者使用与 C++ 和内联汇编的互操作，但这比设置软件断点更容易。

**现在坏消息**

首先，在 SMP 机器上，您必须对所有可以接触您的代码的处理器执行此操作。如果您为进程配置处理器亲和性，或者在单进程机器上进行调试，这可能是可以解决的。其次，英特尔架构上只有 4 个调试处理器。如果您尝试使用 WinDbg 设置处理器断点，在第 4 次之后它会`Too many data breakpoints for thread N`在您点击`g`.

我假设您询问自动化的全部目的是因为有太多对象无法手动设置断点。由于无论如何您都被限制为 4 个`ba`断点，因此自动化这一点没有多大意义。

# c# - 从 mysql 检索 blob 并在 asp.net c# 和 linq 数据源中使用中继器显示

> ID：15234430
> 
> 赞同：0
> 
> 时间：2013-03-05T21:25:56.683
> 
> 标签：c#, asp.net, mysql, linq-to-sql, repeater

我已在**mysql 数据库**中的类别表中的**Longblob**数据类型中的字段 categoryImage 中手动存储图像。我添加了一个 devart linq-mysql 模型来从数据库中检索数据。

 **我已将**linq 数据源**添加到**转发器**控件，并希望直接从数据库中检索 blob 数据类型图像。当我写这段代码时
`<%# Eval("CategoryImage" %>`

我得到一个 System.Byte[] 作为输出。有人给了我一个建议，我应该使用该方法将字节数组转换为图像

```
 public System.Drawing.Image byteArrayToImage (System.Byte[] ByteInArray)
    {
        MemoryStream ms = new MemoryStream(ByteInArray);
        System.Drawing.Image returnimage = System.Drawing.Image.FromStream(ms);
        return returnimage;

    } 
```

当我编写此代码时`<%# byteArrayToImage(Eval("CategoryImage") %>` ，它给了我一个`byteArrayToImage(btye[])`包含一些无效参数的错误。谁能帮我解决这个问题。

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:28:21.347

首先，您的标签似乎格式不正确：

```
<%# byteArrayToImage(Eval("CategoryImage") %> 
```

应该：

```
<%# byteArrayToImage(Eval("CategoryImage")) %> 
```

此外，`Eval`方法返回`object`，`byteArrayToImage`方法参数是 type `System.Byte[]`，因此您必须将其强制转换为正确的类型。

此外，如果您明确说明您正在应用`byteArrayToImage`方法返回值的元素会更好。它可能无法与`System.Drawing.Image`.

如果[您](https://stackoverflow.com/questions/10590055/how-to-add-a-system-drawing-image-to-a-system-web-ui-webcontrols-image)尝试`<asp:Image>`基于. `System.Drawing.Image`

另一种方法是为您的图像创建自定义 HTTP 处理程序，或创建包含图像内容的文件并将 URL 提供给`<asp:Image>`控件。**

# database - 将多个评级存储在单个表行中

> ID：15234432
> 
> 赞同：0
> 
> 时间：2013-03-05T21:26:01.130
> 
> 标签：database, database-design, architecture

如何存储多个评级而不重复存储评级的行

```
create table pic_table
(user_id varchar2(10) not null,
 pic_id number not null,
 pic_snap bfile,
 rating number,
 constraint snp_pk primary key (pic_id));

insert into pic_table
values(u1,p1, bfilename('GIF_FILES', 'PIC_1'),'JPEG'); 
```

用户 1 上传一张图片，它可以被评为 1,2 或 3。然后用户 2 将图片评分为 2，u3 将图片评分为 3。记录每个评分是否需要 3 列，我是否需要 3 行来记录每个用户评分对于图片，即

```
user_id pic_id  vote_1  vote_2   vote_3
u1      pic_1           u2       u3 
```

如果有超过 2 个用户评分，即 user4 评分 2 和 user5 评分 3 怎么办。如何存储这些数据并计算聚合？

```
user_id pic_id    v_1   v_2 v_3
u1          pic_1       u2  u3
u1          pic_1       u4  u5 
```

这将占用巨大的空间。我可以使用记录以数组的形式存储值并通过从集合中提取结果来计算聚合吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:34:29.470

使用以下字段创建表“评分”：

```
user_id (int)
pic_id (int)
rating (int) 
```

我建议将 user_id 和 pic_id 设置为组合主键。

在这张桌子上做所有的计算，你应该没有空间问题。

# javascript - jQuery相当于insertNode？

> ID：15234440
> 
> 赞同：1
> 
> 时间：2013-03-05T21:26:10.193
> 
> 标签：javascript, jquery

我正在将纯 JS 文本高亮脚本转换为 jQuery，但我试图弄清楚 jQuery 等价于什么`insertNode`：

```
var selection = window.getSelection().getRangeAt(0);
var selectedText = selection.extractContents();
var span = document.createElement("span");
span.style.backgroundColor = "yellow";
span.appendChild(selectedText);
selection.insertNode(span); 
```

我想我可以使用以下内容：

```
var span = $("<span class='highlight'>" + selectedText + "</span>");
selection.insertNode(span); 
```

结果是：

```
NOT_FOUND_ERR: DOM Exception 8: An attempt was made to reference a Node in a context where it does not exist. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:29:13.933

我不认为 jQuery 可以对选择进行操作，您必须使用常规的 JS 方法。你得到一个错误，因为你`span`是一个 jQuery 对象，而不是一个节点。

此外，`selection.extractContents()`将返回 DocumentFragment，而不是字符串。所以试试这个：

```
var selection = window.getSelection().getRangeAt(0);
var selectedText = selection.extractContents();
var span = $("<span class='highlight'>" + selectedText.textContent + "</span>");
selection.insertNode(span[0]); // pass the first node in the jQuery object 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:28:06.313

使用 prepend() 或 append() 或 insertAfter() 或 insertAt()

$(选择).append();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:30:48.333

您要插入元素，而不是 jQuery 对象：

```
selection.insertNode(span[0]); 
```

# json - 带有 eclipselink MOXy 的 jaxbcontext.newinstance() 挂起

> ID：15234444
> 
> 赞同：2
> 
> 时间：2013-03-05T21:26:21.237
> 
> 标签：json, spring, eclipselink, moxy

免责声明：我非常业余

我正在尝试让我正在处理的项目除了 XML 之外还输出 JSON。最初，这样做的方法涉及一个方法，该方法接受 Element 的参数并将事物递归地插入到 net.sf JSONObject 类型的对象中以创建 JSON 输出，并使用普通`JAXBContext`的 's`Marshaller`编组为 XML。

我想要的是使用 MOXy 作为我的 JAXB 提供程序，然后从绑定中编组出 XML 和 JSON。

最初，当 XML 被编组时，我有：

```
jc = JAXBContext.newInstance("packageA:packageB:packageC...etc."); 
```

```
public static String marshal(JAXBContext context, JAXBElement<?> je) throws JAXBException {
    StringWriter sout = new StringWriter();
    Marshaller m = context.createMarshaller();
    m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.FALSE);
    m.setProperty(Marshaller.JAXB_ENCODING, "UTF-8");
    m.marshal(je, sout);
    return sout.toString();
} 
```

进而

```
JAXBElement<myObject> jaxb = 
  new JAXBElement<myObject>(myObject_QNAME, myObject.class, null, value);
return XmlResponseMessage(marshal(jc, jaxb));
} 
```

（这可能很重要，所以我应该提到我正在开发的应用程序使用了 spring 框架。）

**另外，我已经阅读了 Blaise 关于 EclipseLink 的每一篇博文。有的多次。我只是对它的理解非常肤浅，如果您不将我链接到他的一个页面，而是解释它的任何解决方案及其工作原理，我将不胜感激**

话虽如此，我尝试将`jaxb.properties`文件包含在其中一个包中以尝试获取 MOXy，而不是`JAXBElement`获取我的绑定。但是，`JAXBContext.newInstance("my list of : delimited packages")`只会使程序挂起。甚至没有错误，只是挂起它。单步执行只是显示对 EclipseLink`newInstance`方法的调用挂起。我已经在网上寻找了很多小时的解决方案。我有太多的类只能包含在 Class[] 中，因此无法通过使用类数组来设置属性。这也是我不能使用本机 moxy API 而不是使用属性文件的原因。我*想*我已经正确设置了 EclipseLink：我已经设置`eclipselink_home`了我的环境变量，并将 eclipselink.jar 添加到我的构建路径中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:35:44.657

**更新#2**

EclipseLink 2.4.2 和 2.5.0 流中已对该问题进行了修复，并且可以从**2013 年 3 月 12 日**开始从以下链接下载包含该修复的每晚构建：

*   [http://www.eclipse.org/eclipselink/downloads/nightly.php](http://www.eclipse.org/eclipselink/downloads/nightly.php)

* * *

**更新#1**

经过几次电子邮件交流后，我认为您遇到的问题是由于以下错误造成的。您可以使用该链接跟踪我们在此问题上的进展。

*   [http://bugs.eclipse.org/402801](http://bugs.eclipse.org/402801)

我将在下面演示它是如何表现出来的：

**对象工厂**

要发生问题，您需要有一个`@XmlElementDecl`注释，其中`name`与 相同`substitutionHeadName`。

```
@XmlRegistry
public class ObjectFactory {

    @XmlElementDecl(name="foo", substitutionHeadName="foo")
    public JAXBElement<Foo> createBar(Foo foo) {
        return new JAXBElement<Foo>(new QName("foo"), Foo.class, foo);
    }

} 
```

**域对象（Foo）**

然后在您的一个域对象上，您需要有一个`@XmlElementRef`注释引用我们在`@XmlElementDecl`.

```
public class Foo {

    @XmlElementRef(name="foo")
    public Foo foo;

} 
```

**演示**

创建`JAXBContext`.

```
public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Foo.class, ObjectFactory.class);
        System.out.println(jc.getClass());
    }

} 
```

**痕迹**

MOXy 进入无限循环添加参考元素。

```
...
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
    at org.eclipse.persistence.jaxb.compiler.AnnotationsProcessor.addReferencedElement(AnnotationsProcessor.java:3740)
... 
```

* * *

**原始答案**

您可以尝试使用以下内容来创建您的`JAXBContext`. 它通过使用本机 MOXy 代码绕过标准 JAXB impl 查找代码。

```
JAXBContext jc = org.eclipse.persistence.jaxb.JAXBContextFactory.createContext("packageA:packageB:packageC...etc."); 
```

如果可行，我们将知道问题与 impl 查找代码有关，我们可以从那里着手。

# android - 启动套接字服务器时方法“锁定”整个屏幕

> ID：15234447
> 
> 赞同：0
> 
> 时间：2013-03-05T21:26:32.423
> 
> 标签：android

下面是实现套接字服务器并完美运行的接收方法。

```
 private void Receive(){ 
    log.info("Server started - waiting for the clients.");
     try {
         Boolean end = false;
         ServerSocket ss = new ServerSocket(12345);
         while(!end){
                 //Server is waiting for client here, if needed
                 Socket s = ss.accept();
                 BufferedReader input = new BufferedReader(new InputStreamReader(s.getInputStream()));
                 PrintWriter output = new PrintWriter(s.getOutputStream(),true); //Autoflush
                 String st = input.readLine();

                JSONObject jsonObj;
                try {
                    jsonObj = new JSONObject(st);
                    long id = jsonObj.optLong("DeviceID", count.addAndGet(1) );
                    String name = jsonObj.toString();
                    table.put(id, name);
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                 etResult.setText(st);
                 Log.d("Tcp Example", "From client: "+st);
                 output.println("Response from Sever: Connectivity ok");
                 s.close();
                 if (st != null ){ end = true; }
         }
    ss.close();

    } catch (UnknownHostException e) {
         // TODO Auto-generated catch block
         e.printStackTrace();
    } catch (IOException e) {
         // TODO Auto-generated catch block
         e.printStackTrace();
    }   
} 
```

唯一的问题是，当我按下按钮调用该方法时，套接字开始侦听并等待客户端消息。虽然它没有发生，但应用程序仍然冻结，我尝试点击任何其他按钮，应用程序可能会崩溃。

有没有人暗示如何处理它并让套接字在“后台”监听而不锁定整个屏幕？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:28:21.400

创建一个线程或 AsyncTask 并在其上执行所有套接字功能。如果这是您很少做的事情，并且想要启动它并处理结果，请使用 AsyncTask。如果这是您想要不断做的事情并且不想同时运行多个工作人员或让多个工作人员排队，请使用线程。

# c# - 使用 C# 运行 shell 命令并将信息转换为字符串

> ID：15234448
> 
> 赞同：16
> 
> 时间：2013-03-05T21:26:40.020
> 
> 标签：c#, .net, shell

我想从 C# 运行一个 shell 命令并在我的程序中使用返回的信息。所以我已经知道要从终端运行某些东西，我需要做这样的事情：

```
string strCmdText;
strCmdText= "p4.exe jobs -e";
System.Diagnostics.Process.Start("CMD.exe",strCmdText); 
```

所以现在执行命令，并从这个命令返回一些信息......我的问题是如何在我的程序中使用这些信息，可能与命令行参数有关，但不确定。

我真的需要使用 C#。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-05T21:29:04.430

[您可以使用ProcessStartInfo](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)重定向输出。[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput.aspx)和[SO](https://stackoverflow.com/questions/4291912/process-start-how-to-get-the-output)上有示例。

例如

```
Process proc = new Process {
    StartInfo = new ProcessStartInfo {
        FileName = "program.exe",
        Arguments = "command line arguments to your executable",
        UseShellExecute = false,
        RedirectStandardOutput = true,
        CreateNoWindow = true
    }
}; 
```

然后启动该过程并从中读取：

```
proc.Start();
while (!proc.StandardOutput.EndOfStream) {
    string line = proc.StandardOutput.ReadLine();
    // do something with line
} 
```

根据您要完成的工作，您还可以取得更多成就。我编写了将数据异步传递到命令行并从中读取的应用程序。这样的例子不容易发布在论坛上。

# maven - Maven 依赖 picocontainer

> ID：15234451
> 
> 赞同：3
> 
> 时间：2013-03-05T21:26:56.710
> 
> 标签：maven

我正在尝试包含 maven 依赖项

```
<dependency>
    <groupId>org.jacorb</groupId>
    <artifactId>jacorb</artifactId>
    <version>2.3.1</version>
</dependency> 
```

依赖关系已解决，但它导致另一个依赖关系 picocontainer 出现问题：

```
[ERROR] Failed to execute goal on project s_s: Could not resolve dependencies 
for project my.package:s_s:war:1: Failed to collect dependencies for  org.jacorb:jacorb:jar:2.3.1 (compile), picocontainer:picocontainer:jar:1.2 (compile)]: Failed to read artifact descriptor for picocontainer:picocontainer:jar:${picocontainer.version}: Could not transfer artifact picocontainer:picocontainer:pom:${picocontainer.version} from/to central (http://repo.maven.apache.org/maven2): IllegalArgumentException: Illegal character in path at index 65: http://repo.maven.apache.org/maven2/picocontainer/picocontainer/${picocontainer.version}/picocontainer-${picocontainer.version}.pom -> [Help 1] 
```

`${picocontainer.version}`当我检查本地存储库时，会创建名为的版本。我试过包含自己的依赖：

```
<dependency>
    <groupId>picocontainer</groupId>
    <artifactId>picocontainer</artifactId>
    <version>1.2</version>
</dependency> 
```

但它没有帮助，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:41:53.780

好的，我想通了 :) 我应该像这样排除依赖`org.jacorb`：

```
<dependency>
        <groupId>org.jacorb</groupId>
        <artifactId>jacorb</artifactId>
        <version>2.3.1</version>
        <exclusions>
            <exclusion>
                <groupId>picocontainer</groupId>
                <artifactId>picocontainer</artifactId>
            </exclusion>
            <exclusion>
                <groupId>picocontainer</groupId>
                <artifactId>picocontainer-tck</artifactId>
            </exclusion>
            <exclusion>
                <groupId>picocontainer</groupId>
                <artifactId>picocontainer-gems</artifactId>
            </exclusion>
        </exclusions>
</dependency> 
```

并包括必要的一项

```
 <dependency>
        <groupId>picocontainer</groupId>
        <artifactId>picocontainer</artifactId>
        <version>1.2</version>
    </dependency>
    <dependency>
        <groupId>picocontainer</groupId>
        <artifactId>picocontainer-tck</artifactId>
        <version>1.2</version>
    </dependency>
    <dependency>
        <groupId>picocontainer</groupId>
        <artifactId>picocontainer-gems</artifactId>
        <version>1.2</version>
    </dependency> 
```

我猜这是maven损坏的神器？

# design-patterns - 只创建和存储实例的类的名称？

> ID：15234454
> 
> 赞同：0
> 
> 时间：2013-03-05T21:27:09.817
> 
> 标签：design-patterns

是否有一个只初始化和存储不同对象实例的类的名称？

```
class MyInitializerOfMyObjectAndStorage

public MyInitializerOfMyObjectAndStorage(CollectionOfInfoHowToInitialize)
{
   foreach (var item in CollectionOfInfoHowToInitialize)
       instances.add(new MyObject(item));
   ............................
}

private or public MyObject _instances; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T07:52:56.223

在这里，您打破了[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)该类正在做两件事，初始化和存储对象，这就是为什么您很难命名的原因。你可以把这个类分成两个类，一个是

```
public class ObjectInitializer {

  public Object initialize() {
    //return some object 
    return null;
  }
} 
```

另一个是

```
public class ObjectsStore {

  public void store(Object someObject) {
   // do something here .. 
  }
} 
```

# windows - cmd和感叹号

> ID：15234457
> 
> 赞同：1
> 
> 时间：2013-03-05T21:27:29.553
> 
> 标签：windows, batch-file, cmd, delayedvariableexpansion

对于包含感叹号的文件夹名称，以下代码将失败。我想我需要启用 DelayedExpansion 来处理嵌套的 for 循环。有什么想法可以完成这项工作吗？谢谢！

```
@echo off & setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION

set "dest=%~dpn1"
IF "%1" equ "" Set "dest=%cd%"

set /a Folders=0
set /a FoldersWithSubFoldersAndFiles=0
set /a FoldersWithOnlyFiles=0
set /a FoldersWithOnlySubFolders=0
set /a FoldersEmpty=0

for /f "usebackq tokens=*" %%a in (`DIR /AD /S /B "%dest%"`) do (
    Set /a Folders+=1
    for /f "usebackq tokens=*" %%i in (`DIR "%%a" /A-D /B 2^>NUL^| FIND /C /V ""`) do (
        Set NumberOfFiles=%%i
    )
    for /f "usebackq tokens=*" %%i in (`DIR "%%a" /AD /B 2^>NUL^| FIND /C /V ""`) do (
        set NumberOfFolders=%%i
    )
    IF "!NumberOfFiles!" neq "0" IF "!NumberOfFolders!" neq "0" set /a FoldersWithSubFoldersAndFiles+=1
    IF "!NumberOfFiles!" neq "0" IF "!NumberOfFolders!" equ "0" set /a FoldersWithOnlyFiles+=1
    IF "!NumberOfFiles!" equ "0" IF "!NumberOfFolders!" neq "0" set /a FoldersWithOnlySubFolders+=1
    IF "!NumberOfFiles!" equ "0" IF "!NumberOfFolders!" equ "0" (
        set /a FoldersEmpty+=1
        echo %%a is empty.
    )
)

echo Found %Folders% folders below "%dest%".
echo %FoldersWithSubFoldersAndFiles% folders containing files and subfolders.
echo %FoldersWithOnlyFiles% folders containing files only.
echo %FoldersWithOnlySubFolders% folders containing subfolders only.
echo %FoldersEmpty% folders are empty.

endlocal 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:49:07.437

我看到了 3 个简单的解决方案：

1）最慢的方法是使用 CALL ，这样您就不需要在循环中进行延迟扩展。

```
@echo off & setlocal disableDelayedExpansion

set "dest=%~dpn1"
IF "%1" equ "" Set "dest=%cd%"

set /a Folders=0
set /a FoldersWithSubFoldersAndFiles=0
set /a FoldersWithOnlyFiles=0
set /a FoldersWithOnlySubFolders=0
set /a FoldersEmpty=0

for /f "usebackq tokens=*" %%a in (`DIR /AD /S /B "%dest%"`) do (
    Set /a Folders+=1
    for /f "usebackq tokens=*" %%i in (`DIR "%%a" /A-D /B 2^>NUL^| FIND /C /V ""`) do (
        Set NumberOfFiles=%%i
    )
    for /f "usebackq tokens=*" %%i in (`DIR "%%a" /AD /B 2^>NUL^| FIND /C /V ""`) do (
        set NumberOfFolders=%%i
    )
    call :incrementCounts
)

echo Found %Folders% folders below "%dest%".
echo %FoldersWithSubFoldersAndFiles% folders containing files and subfolders.
echo %FoldersWithOnlyFiles% folders containing files only.
echo %FoldersWithOnlySubFolders% folders containing subfolders only.
echo %FoldersEmpty% folders are empty.
echo See dircount.log for list of empty folders.

endlocal
exit /b

:incrementCounts
IF "%NumberOfFiles%" neq "0" IF "%NumberOfFolders%" neq "0" set /a FoldersWithSubFoldersAndFiles+=1
IF "%NumberOfFiles%" neq "0" IF "%NumberOfFolders%" equ "0" set /a FoldersWithOnlyFiles+=1
IF "%NumberOfFiles%" equ "0" IF "%NumberOfFolders%" neq "0" set /a FoldersWithOnlySubFolders+=1
IF "%NumberOfFiles%" equ "0" IF "%NumberOfFolders%" equ "0" (
    set /a FoldersEmpty+=1
    echo %%a is empty.
)
exit /b 
```

2) 一种更快的方法是暂时启用延迟扩展，仅足够长的时间将值传输到 FOR 变量。

```
@echo off & setlocal disableDelayedExpansion

set "dest=%~dpn1"
IF "%1" equ "" Set "dest=%cd%"

set /a Folders=0
set /a FoldersWithSubFoldersAndFiles=0
set /a FoldersWithOnlyFiles=0
set /a FoldersWithOnlySubFolders=0
set /a FoldersEmpty=0

for /f "usebackq tokens=*" %%a in (`DIR /AD /S /B "%dest%"`) do (
    Set /a Folders+=1
    for /f "usebackq tokens=*" %%i in (`DIR "%%a" /A-D /B 2^>NUL^| FIND /C /V ""`) do (
        Set NumberOfFiles=%%i
    )
    for /f "usebackq tokens=*" %%i in (`DIR "%%a" /AD /B 2^>NUL^| FIND /C /V ""`) do (
        set NumberOfFolders=%%i
    )
    setlocal enableDelayedExpansion
    for /f "tokens=1,2" %%N in ("!NumberOfFiles! !NumberOfFolders!") do (
        endlocal
        IF "%%N" neq "0" IF "%%M" neq "0" set /a FoldersWithSubFoldersAndFiles+=1
        IF "%%N" neq "0" IF "%%M" equ "0" set /a FoldersWithOnlyFiles+=1
        IF "%%N" equ "0" IF "%%M" neq "0" set /a FoldersWithOnlySubFolders+=1
        IF "%%N" equ "0" IF "%%M" equ "0" (
            set /a FoldersEmpty+=1
            echo %%a is empty.
        )
    )
)

echo Found %Folders% folders below "%dest%".
echo %FoldersWithSubFoldersAndFiles% folders containing files and subfolders.
echo %FoldersWithOnlyFiles% folders containing files only.
echo %FoldersWithOnlySubFolders% folders containing subfolders only.
echo %FoldersEmpty% folders are empty.
echo See dircount.log for list of empty folders.

endlocal 
```

3）但我处理它的方式是消除仅在循环中使用的 2 个变量。它们不在循环之外使用，并且它们已经从 FOR 变量派生。由于现在一切都是 FOR 变量，因此您不再需要延迟扩展。

```
@echo off & setlocal ENABLEEXTENSIONS ENABLEDELAYEDEXPANSION

set "dest=%~dpn1"
IF "%1" equ "" Set "dest=%cd%"

set /a Folders=0
set /a FoldersWithSubFoldersAndFiles=0
set /a FoldersWithOnlyFiles=0
set /a FoldersWithOnlySubFolders=0
set /a FoldersEmpty=0

for /f "usebackq tokens=*" %%a in (`DIR /AD /S /B "%dest%"`) do (
    Set /a Folders+=1
    for /f "usebackq tokens=*" %%N in (`DIR "%%a" /A-D /B 2^>NUL^| FIND /C /V ""`) do (
        for /f "usebackq tokens=*" %%M in (`DIR "%%a" /AD /B 2^>NUL^| FIND /C /V ""`) do (
            IF "%%N" neq "0" IF "%%M" neq "0" set /a FoldersWithSubFoldersAndFiles+=1
            IF "%%N" neq "0" IF "%%M" equ "0" set /a FoldersWithOnlyFiles+=1
            IF "%%N" equ "0" IF "%%M" neq "0" set /a FoldersWithOnlySubFolders+=1
            IF "%%N" equ "0" IF "%%M" equ "0" (
                set /a FoldersEmpty+=1
                echo %%a is empty.
            )
        )
    )
)

echo Found %Folders% folders below "%dest%".
echo %FoldersWithSubFoldersAndFiles% folders containing files and subfolders.
echo %FoldersWithOnlyFiles% folders containing files only.
echo %FoldersWithOnlySubFolders% folders containing subfolders only.
echo %FoldersEmpty% folders are empty.
echo See dircount.log for list of empty folders.

endlocal 
```

# c - Makefile 和跨平台开发

> ID：15234461
> 
> 赞同：4
> 
> 时间：2013-03-05T19:40:26.123
> 
> 标签：c, cross-platform, makefile

我一直在试图弄清楚如何创建一个可以为所有主要操作系统编译的 C 程序。我考虑过使用 makefile，所以我只需要更改目标操作系统，但我有一些问题。我的第一个问题是我无法弄清楚如何更改目标操作系统，因此我可以在一个操作系统上编译，但在所有操作系统上使用该应用程序。我的第二个问题是我无法弄清楚如何让它自动编译 src 目录中的所有 .c 文件，所以我不必每次添加新文件时都修改 makefile。有人知道怎么做这些东西吗？

我当前的makefile（目前未从[此处](http://mrbook.org/tutorials/make/)修改）

```
CC=gcc
CFLAGS=-c -Wall
LDFLAGS=
SOURCES=main.cpp hello.cpp factorial.cpp
OBJECTS=$(SOURCES:.cpp=.o)
EXECUTABLE=hello

all: $(SOURCES) $(EXECUTABLE)

$(EXECUTABLE): $(OBJECTS) 
    $(CC) $(LDFLAGS) $(OBJECTS) -o $@

.cpp.o:
    $(CC) $(CFLAGS) $< -o $@q2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:43:06.883

GNU Autoconf 是一个很好的起点。我不能给你一个完整的答案，因为除了维护一组 nmake 脚本之外，我不知道你会为 Windows 做什么。虽然有一个学习曲线，但它们使编写跨平台工作的 make 文件和 c 代码成为可能。它不仅会为您处理多个源文件，还会帮助您定义目标，例如“all”、“install”、“clean”等。如果您熟悉下载项目然后键入“./configure”，然后'make install' 那么你可能是 Autoconf 生成项目的用户。

除了处理多个源文件之外，还有其他使用 Autoconf 的原因。

What makes C/C++ development across flavors of Unix difficult is the definition of 'Unix' and C. Different flavors of Unix have slightly different library or system calls depending on what flavor of standards they support. The same is true of C. So, when writing code you'll see #defines specifying a group of preprocessor symbols that define a version of Unix and C that you'd like to use. Going from GCC to HP C or some other vendor's C compiler may include different 'default' levels of behavior, so you need to make the expected behavior explicit.

其次，您需要定义需要哪些库。在您的构建中，您可能需要探测 mysql 库并决定如果未安装这些库该怎么办。在某些情况下，您可能根本不需要构建，或者在某些情况下，您可能只需要替换另一个库（如 libdb）。在尝试编写复杂的 makefile 以支持甚至两个操作系统（Solaris 和 Linux）之后，我不想重新发明这个轮子。

# excel - Excel公式从多个单元格转换数字，然后在一个单元格中添加转换

> ID：15234464
> 
> 赞同：0
> 
> 时间：2013-03-05T21:27:59.990
> 
> 标签：excel, worksheet-function

我试图找出一种简洁的方法来做到这一点，它不需要为变量使用额外的列。

基本上，我有 9 列，每列的值介于 1 和 6 之间。在一个特殊的“元分数”列中，我想对其他九列进行转换。我想查看其他 9 列中的每个值，并且我想将每个 1 转换为 6，每个 2 转换为 5，每个 3 转换为 4，每个 4 转换为 3，每个 5 转换为 2，每个 6 转换为a 1\. 然后我想将所有这些转换后的数字相加，并将总和放在“元分数”列中。

这显然可以通过为存储转换的 9 列中的每一列创建相应的列，然后将它们相加来以一种笨拙的方式完成。但是，有没有一种不需要额外列的简单方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:30:53.097

假设您的原始分数在 A 到 I 列的行中，请使用以下公式：

```
=63-总和（A1：I1）

```

如果任何单元格可能为空白并且您想忽略它，请使用此公式（感谢 Barry！）：

```
=COUNT(A1:I1)*7-SUM(A1:I1)

```

# javascript - JS：连接 html（带 +）-> 仅在条件为真时打印 html？

> ID：15234467
> 
> 赞同：2
> 
> 时间：2013-03-05T21:28:06.507
> 
> 标签：javascript, jquery

不太知道如何命名这个问题。我的问题可能相当简单，但我不知道正确且有效的解决方案。

```
if ( rt > 0 ) retweets = '<div class="stats"><b>' + rt + '</b> Retweets</div>';

var tweet = 
'<article class="item tweet">' +
    '<h4 class="tweet_from_user_name">' + tw.from_user_name +
    '<p class="tweet_text">' + tw.text + '</p>' +
    retweets + 
'<article>';

$('#twitter').html(tweet); 
```

所以我遇到的问题是这个。我正在打印一条带有“用户名”和“推文文本”的推文，并希望显示“转推”，但前提是它们可用。

所以我不想写“0转推”，而只是不显示`<div>`包含转推的内容。

如果小于 0 ，我如何确保该`retweets`变量不是 printet `rt`。现在这可以工作。然而唯一的是，如果小于 0 ，那`retweets`现在是未定义的。`rt`

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:30:42.323

```
var retweets = "";
if ( rt > 0 ) retweets = '<div class="stats"><b>' + rt + '</b> Retweets</div>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:30:24.107

```
retweets = (rt > 0) ? ('<div class="stats"><b>' + rt + '</b> Retweets</div>') : ""; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:30:24.493

这是一种没有任何额外变量的捷径：

```
var tweet = 
'<article class="item tweet">' +
    '<h4 class="tweet_from_user_name">' + tw.from_user_name +
    '<p class="tweet_text">' + tw.text + '</p>' +
    (rt > 0 ? '<div class="stats"><b>' + rt + '</b> Retweets</div>' : '') + 
'<article>'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:30:44.847

`retweets`如果没有转推，则设置为空字符串

```
if ( rt > 0 ) {
    retweets = '<div class="stats"><b>' + rt + '</b> Retweets</div>';
} else {
    retweets = '';
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T21:30:51.487

你可以试试三元

```
var tweet = 
'<article class="item tweet">' +
    '<h4 class="tweet_from_user_name">' + tw.from_user_name +
    '<p class="tweet_text">' + tw.text + '</p>' +
    (rt > 0 ? retweets : "") + 
'<article>'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T21:30:57.887

```
retweets = (rt > 0) ? '<div class="stats"><b>' + rt + '</b> Retweets</div>' : ''; 
```

`rt`基本上，如果小于或等于 0 ，则将其设置为空字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-05T21:31:21.813

只需使用 if 语句

```
if ( rt > 0 ) retweets = '<div class="stats"><b>' + rt + '</b> Retweets</div>';

var tweet = 
'<article class="item tweet">' +
    '<h4 class="tweet_from_user_name">' + tw.from_user_name +
    '<p class="tweet_text">' + tw.text + '</p>';
if rt > 0 {
 var tweet+= retweets
}
var tweet+='<article>';

$('#twitter').html(tweet); 
```

# outlook - 如何通过 HTML 将内部书签添加到 Outlook 电子邮件？

> ID：15234468
> 
> 赞同：0
> 
> 时间：2013-03-05T21:28:07.803
> 
> 标签：outlook, outlook-addin

我正在创建一个 HTML 电子邮件，并想添加一个目录，其中显示了电子邮件中项目的超链接。我目前的工作流程只是生成完整的 HTML 文件，然后在 Outlook 邮件项目的 HTMLBody 中显示该 HTML 文件。

当我在浏览器中打开 HTML 页面时，它工作正常。但是，当我将 Outlook 邮件 HTMLBody 设置为等于该文本时，书签不再起作用。

书签超链接类似于： `<a href = "#item" ...>Blah<\a>`

HTML 中的一个项目的`name`和`id`属性等于`"item"`

如何让书签工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:37:28.273

请将电子邮件类型设置为 html.. 类似这样的..

*// 设置邮件消息正文的格式为 HTML*

mMailMessage.IsBodyHtml = **IsBodyHtml;**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-20T07:33:40.223

使用 Outlook 2010，当我`<a name="item"></a>`用作书签时，它对我有帮助。即正好是“A”项目。

# javascript - iOS6 Mobile Safari：geolocation.watchPosition 的准确性和更新周期

> ID：15234473
> 
> 赞同：4
> 
> 时间：2013-03-05T21:28:32.177
> 
> 标签：javascript, ios, html, geolocation, mobile-safari

我在 iOS6 上的 iPhone4 和 iPhone5 上的移动 Safari 上遇到了奇怪的行为。

## 我想做的事

**高精度**跟踪用户在浏览器中的位置，使用

```
geolocation.watchPosition({ enableHighAccuracy: true, maximumAge: 0, callback }) 
```

## 我面临的问题

正常情况下，当设备在户外、晴空和移动时，GPS位置的准确性和更新周期都非常好。

传递给回调的`coords`对象具有 5 米的精度，给出了正确的航向值，并且在移动回调时至少每 500 毫秒触发一次。

*但是*：有时观察的位置永远不会准确，即使我在相同的条件下（尽可能）测试它。

此外，更新周期要长得多，几乎 30 秒。

基本上，在这种情况下，HTML 地理位置不能用于准确跟踪位置。

## 观察

*   这似乎发生了，当 GPS 传感器未处于“热待机”状态时，我的意思是它没有被另一个本机应用程序使用一段时间（不确定多长时间）。

*   重新加载页面，重新允许 GPS 访问和重新初始化 watchPosition 并没有改变任何东西，仍然是错误的准确性和缓慢的更新。

*   更改传递给的选项`watchPosition`似乎没有任何作用。

*   手动修复1：

    *   关闭 Safari
    *   打开另一个本机应用程序，例如地图或 GMaps
    *   确定在本机应用程序中的位置
    *   打开 Safari
    *   GPS 位置立即准确，在 500 毫秒内再次触发位置更新，并且非常准确（无需重新加载）。
*   手动修复2：

    *   关闭 Safari
    *   打开设置面板
    *   禁用 Wi-Fi
    *   打开 Safari
    *   再次，问题已修复（无需重新加载）

## 结论

当问题发生时，我查看`coords`了回调的对象并检测到以下内容：

即使经过的位置距离设备的实际位置很远（> 1km），`accuracy`经过的位置也要小得多（通常在 165 米处）。`heading`从来没有给出。

当 iPhone 上的 WiFi 被禁用时，设置面板中会显示启用 WiFi 将提高确定您的位置的准确性（因为 AGPS 由地理编码 WiFi 网络的数据集支持）。但据我所知，如果您想在移动 safari 中使用 GPS，这**不是真的。**事实上，它的作用恰恰相反。

在我看来，移动 Safari 会做这样的事情来确定位置：

*   如果 GPS 已在设备上激活/正在使用，则使用 GPS 传感器（快速准确的位置更新）

*   如果 GPS 之前未激活并且启用了 WiFi，则设备**仅**使用其 WiFi 数据库来获取位置。（更新很慢，不准确）。它只是从一个 WiFi 位置更新到另一个位置。您可以非常清楚地看到这一点，例如，如果您在联邦道路上行驶，因为您的位置大多会映射到下一个住宅区。

*   仅当 GPS 之前未激活且 WiFi 已**禁用**时，移动 Safari 才会使用 GPS 来确定设备的位置（再次，快速且准确）。

## 问题

谁能证实我的问题和我的观察？我在早期的 iO​​S 版本中使用过地理定位，但以前从未遇到过这个问题。

它是移动 safari 的已知错误吗，有机会修复吗？还是我只是错过了更好的配置`watchPosition`以获得更好的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-01T19:36:37.667

> 谁能证实我的问题和我的观察？我在早期的 iO​​S 版本中使用过地理定位，但以前从未遇到过这个问题。

我试过 watchPosition(onGeoSuccess,onGeoFail,{enableHighAccuracy:true}); 在我的网络应用程序中使用我的 iPhone (iOS 7.0.2)。

使用 WiFi 的准确性真的很差，有时一英里。在 WiFi 关闭的情况下，准确度几乎是完美的，偶尔会有几百英尺的差异。

我尚未测试是否有助于让 GPS 在捕获点之间运行，或者是否最好将其关闭，直到您到达下一个捕获点并让 watchPosition() 函数稳定下来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T14:55:37.590

很多人都描述过类似的问题，包括我自己。我在本次讨论[https://discussions.apple.com/thread/4313850?start=45&tstart=0](https://discussions.apple.com/thread/4313850?start=45&tstart=0)中描述了我在第 5 页及以后的问题（作为 alstorp） 阅读并查看它是否符合您的问题。

问题是，据我所知，Apple 尚未证实这一点。他们正在努力修复它吗？真的站在他们这边吗？它真的是一个错误吗？因此，我们不知道何时/是否会修复它......

有没有人对 iOS 6 中基于浏览器的地理位置没有问题？（即使在不同情况下进行了多次测试）。

您是否广泛测试了您的修复程序？我的经验是，这种类型的修复在某些情况下会有所帮助，但并非总是（或长时间）。如果它们为您可靠地工作，那将是非常有趣的......

（还检查[IOS6 地理位置 watchPosition 回调失败](https://stackoverflow.com/questions/12553910/ios6-geolocation-watchposition-callbacks-fail) [iOS 6 破坏 webapps 中的 GeoLocation（apple-mobile-web-app-capable）](https://stackoverflow.com/questions/12503815/ios-6-breaks-geolocation-in-webapps-apple-mobile-web-app-capable)）

# git - git remote clone 的正确语法

> ID：15234474
> 
> 赞同：0
> 
> 时间：2013-03-05T21:28:34.423
> 
> 标签：git

如何将 git 存储库远程克隆到与存储库相同的服务器上的 Rails 应用程序目录？

如果我执行以下操作，克隆的存储库最终会出现在我的本地/Windows 机器上，这不是我想要的：

```
git clone -q username@server.com:/users/home/jdquirke/git/deq.git \
    /users/home/username/rails_apps/deq/releases/20130305205259 
```

如果我改为执行以下操作，

```
git clone -q username@server.com:/users/home/jdquirke/git/deq.git \
    username@server.com:/users/home/username/rails_apps/deq/releases/20130305205259 
```

我明白了

> 致命：无法创建 'username@server.com:/users/home/jdquirke/rails_apps/deq/releases/20130305205​​259' 的前导目录：无效参数

在我看来，好像我的问题集中在如何告诉克隆命令我希望克隆去的远程目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:39:40.970

我不知道您是否可以仅使用 git 命令来执行此操作，但是您可以使用在远程服务器上执行 git 的 ssh 命令来执行此操作。

例如这样的：

```
ssh steinar@delta "git clone git@delta:private.git /tmp/git-test/private" 
```

请注意，我有单独的 git 用户和在服务器上执行命令的用户。对你来说可能会也可能不会，这取决于 git 在服务器上的设置方式。

# c# - 复制和粘贴网页元素

> ID：15234475
> 
> 赞同：0
> 
> 时间：2013-03-05T21:28:40.477
> 
> 标签：c#, web-scraping, html-agility-pack

我习惯用 c# 抓取数据，但我想知道你是否可以从浏览器复制和粘贴。假设您加载了一个站点，您可以突出显示您想要的任何元素并复制它们，然后粘贴到say-word中。布局和视图看起来几乎相同。

是否可以在代码中执行此操作，我并不是说使用 HTMLAgilityPack 或类似的方式通过 HTML 抓取元素。我想以编程方式从 UI 复制和粘贴。这可以做到吗？

# ubuntu - ubuntu 12.04 左侧面板图标丢失

> ID：15234477
> 
> 赞同：0
> 
> 时间：2013-03-05T21:28:54.090
> 
> 标签：ubuntu, icons, panel

我只是注意到左侧面板中的图标都不见了。面板在那里，但它是空的。现在我必须使用 alt + tab 在打开的应用程序之间切换。我不知道发生了什么。我只是打开了很多 chrome 标签。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T13:05:37.557

你可以试试这个 `Super`（Windows键）++`Alt`然后`right click`选择“添加到面板”

# sql - Oracle 检索最大记录

> ID：15234479
> 
> 赞同：0
> 
> 时间：2013-03-05T21:28:56.233
> 
> 标签：sql, oracle, top-n

```
Table_A

A_id          
1     

Tale_B
B_id       A_id
1            1
2            1
3            1

Table_C

B_id      Process_date
1   20130101 12:20:01
2   20130101 12:10:01
3   20130101 13:00:01 
```

如何根据 Table_C 计时窗口使用 Table_A A_id 的引用从 Table_C 中检索最大 process_date。如果我想在计时窗口 20130101 12:09:00 到 12:21:00 中检索 Table_C id 和 max(process_date) 那么它应该返回id 为 1 和 process_date 为 12:20:01

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:36:03.880

您可以使用获取以下内容的子查询`max(process_date)`：

```
select c1.b_id,
  c2.MaxDate
from table_a a
inner join table_b b
  on a.a_id = b.a_id
inner join table_c c1
  on b.b_id = c1.b_id
inner join
(
  select max(process_date) MaxDate
  from table_c
) c2
  on c1.process_date = c2.maxdate; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/1e80c/9)

或者您可以使用`row_number()`：

```
select b_id, process_date
from 
(
  select c1.b_id,
    c1.process_date,
    row_number() over(partition by a.a_id order by c1.process_date desc) rn
  from table_a a
  inner join table_b b
    on a.a_id = b.a_id
  inner join table_c c1
    on b.b_id = c1.b_id
) 
where rn = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/1e80c/10)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:44:00.027

此查询应该为您`process_date`提供每个`B_id`参考的最大值`Table_A`：

```
SELECT c.B_id, MAX(Process_date)
FROM Table_C c
INNER JOIN Table_B b 
    ON b.B_id = c.B_id
INNER JOIN Table_A a
    ON a.A_ID = b.A_id
GROUP BY c.B_id 
```

只需`c.B_id`从选择中删除 ，`GROUP BY`如果您想要`process_date`所有 B_id 的最大值并引用`Table_A`.

[SQL小提琴](http://sqlfiddle.com/#!4/9eb56/1)

# javascript - 如何让用户浏览那里的计算机以在 HTML JAVASCRIPT 中选择背景图像

> ID：15234489
> 
> 赞同：0
> 
> 时间：2013-03-05T21:29:26.323
> 
> 标签：javascript, html, css

我试图让用户浏览他们的文档并选择一张图片设置为背景图片。我已经了解了用户如何使用 URL 更改背景图像。请在下面找到演示：

> 演示：http: [//goo.gl/253IN](http://goo.gl/253IN)
> 
> 用户名：demo
> 
> 密码：demo1

我不知道如何让它与

> 文件字段

我找到了以下我想使用的[示例。](http://jsfiddle.net/N7KfQ/4/)[在这里](https://stackoverflow.com/questions/14678207/how-can-i-let-users-customize-background-images)找到问题

JavaScript：

```
$(switchBackground);
var oFReader = new FileReader(),
    rFilter = /^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;

oFReader.onload = function(oFREvent) {
    localStorage.setItem('b', oFREvent.target.result);
    switchBackground();
};

function switchBackground() {
  $('body').css('background-image', "url(" + localStorage.getItem('b') + ')');    
}

function loadImageFile(testEl) {
  if (! testEl.files.length) { return; }
  var oFile = testEl.files[0];
  if (!rFilter.test(oFile.type)) { alert("You must select a valid image file!"); return; }
  oFReader.readAsDataURL(oFile);
} 
```

HTML：

```
<input id="test" type="file" onchange="loadImageFile(this)" /> 
```

但是我无法让它与我当前的代码一起使用（请参阅演示）

提前致谢

PS我不是HTML和Javascrpit方面的专家（还：D），所以我无法理解真正复杂的代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:34:49.510

简而言之，您不能`file`以这种方式使用输入。出于安全原因，JavaScript 无法访问用户直接机器。此输入仅允许文件通过 HTTP`POST`请求正文中的 Web 流传递。

要完成您想要的，您必须使用服务器端语言（例如or ）上传文件**服务器端**。然后，您可以将其保存并存储，以便在用户访问时将其显示为用户背景。`PHP``ASP.NET`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-27T07:57:35.430

根本不可能！

您实际上可以使用此插件将此功能添加到您的网站

[https://github.com/CybrSys/custom-background.js](https://github.com/CybrSys/custom-background.js)

# javascript - 使用 AJAX 直接上传到亚马逊 S3 返回错误：Bucket POST must contain a field named 'key'

> ID：15234496
> 
> 赞同：14
> 
> 时间：2013-03-05T21:30:18.337
> 
> 标签：javascript, jquery, amazon-s3

我正在尝试将文件从浏览器上传到 s3 amazon，我已修改 CORS 策略规则以允许发布存储桶，但出现错误

```
 <?xml version="1.0" encoding="UTF-8"?>
    <Error><Code>InvalidArgument</Code><Message>Bucket POST must contain a field named 'key'.  If it is specified, please check the order of the fields.</Message>
<ArgumentValue></ArgumentValue><ArgumentName>key</ArgumentName><RequestId>1E0A8DC78C0CEA9A</RequestId><HostId>XN38Qje9hUrGqHNIhtT8CtowX9tXlpyfEoaXb1UNxlsyLOWreh2mKqKVXg1zjLVl</HostId></Error> 
```

这是我的请求和响应，我仍然收到此错误，以正确的顺序传递关键参数

![http://screencast.com/t/9ZUQO0s9d](../Images/766085b30e6ba745e909597af5f29c41.png)

![http://screencast.com/t/CL8MKq6l6](../Images/bf899a0137819c8236ae541928d266a0.png)

谁能告诉我有什么问题，我正在使用 FormData 提交请求

任何帮助将不胜感激。

谢谢

编辑：这是代码请检查

```
var form_data = new FormData();         
                form_data.append('file',hdlr.file);
                //form_data.append('crop_type',settings.get_cropped_type());
                //form_data.append('attributes',JSON.stringify(file_attr));
                $('input:hidden',$form).each(function(){

                    form_data.append(this.name,this.value);

                });

                //finally post the file through AJAX  
                var xhr = new XMLHttpRequest();  
                xhr.open("POST", $form[0].action, true);  
                xhr.send(form_data); 
```

![在此处输入图像描述](../Images/680a94e9205ddea9cf7864b02e828240.png)

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-05T23:04:46.440

看起来您的文件表单字段首先出现在请求中。我无法确定，因为您没有在答案中包含整个请求有效负载，但看起来它出现在“关键”字段的上方。AWS 会忽略请求中文件字段之后的所有字段，因此所有其他字段必须出现在文件之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-23T17:27:25.723

谢谢[雷·尼古拉斯](https://stackoverflow.com/a/15235866/2505542)

这个对我有用。

```
{
  "formAttributes": {
    "action": "https://**.s3.ap-southeast-1.amazonaws.com",
    "method": "POST",
    "enctype": "multipart/form-data"
  },
  "formInputs": {
    "acl": "public-read",
    "key": "users/2/images/drops-of-water-578897_640.jpg",
    "X-Amz-Credential": "**",
    "X-Amz-Algorithm": "AWS4-HMAC-SHA256",
    "X-Amz-Date": "**",
    "Policy": "**",
    "X-Amz-Signature": "**"
  }
} 
```

```
function uploadFile(event) {
  event.preventDefault();

  getSignedPost().then(() => {
    const fileEl = document.getElementById('id-file');
    const file = fileEl.files[0];

    const formData = new FormData();
    Object.keys(uploadCredentials.formInputs).forEach((key) => {
      formData.append(key, uploadCredentials.formInputs[key]);
    });

    // update key to file name
    const key = `users/2/images/${file.name}`;
    formData.set('key', key);
    uploadCredentials.formInputs.key = key;

    // update show data on page
    const el = document.getElementById('id-upload-info');
    el.innerText = JSON.stringify(uploadCredentials, null, 2);

    // IMPORTANCE: https://stackoverflow.com/a/15235866
    // AWS ignores all fields in the request after the file field, so all other fields must appear before the file.
    formData.append('file', file);

    fetch(uploadCredentials.formAttributes.action, {
      method: uploadCredentials.formAttributes.method,
      // headers: {
      //   'Content-Type': 'multipart/form-data',
      // },
      body: formData,
    })
      .then((res) => {
        if (res.status === 204) {
          console.log('Successfully uploaded file');
          console.log('-- 204 - no content');

          return `Successfully uploaded file: ${key}`;
        }

        if (res.ok) {
          return res.json();
        } else {
          return res.text();
        }
      })
      .then((res) => {
        alert(JSON.stringify(res, null, 2));
      })
      .catch((err) => {
        alert(err.message || err);
      });
  });
} 
```

# java - 使用 JSP 和 Spring 更新嵌套字段

> ID：15234497
> 
> 赞同：1
> 
> 时间：2013-03-05T21:30:19.757
> 
> 标签：java, hibernate, jsp, spring-mvc, jstl

大家晚上好

我正在尝试更新页面中的字段并不断抛出异常。

我有一个主要对象“汽车”，它有一个“模型”的外键

当我建立我的页面时，我创建了一个选择框来列出所有模型。所以现在当我选择一个模型并提交表单时，我得到下面抛出的异常。只要我不包含模型字段，Car 表中的所有字段都会更新。一旦我尝试包含模型字段，代码就会在提交时中断。

```
org.apache.jasper.JasperException: An exception occurred processing JSP page /WEB-INF/jsp/sellcar.jsp at line 28

25:                                             <c:forEach items="${cars}" var="car">
26:                                                     <option
27:                                                             value='<c:out value="${car.model.modId}"/>'
28:                                                             <c:if test="${car.model.model == status.value.model}">SELECTED</c:if>>
29:                                                             <c:out value="${car.model.model}" />
30:                                                     </option>
31:                                             </c:forEach>

**Stacktrace:**
        org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:521)
        org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:430)
        org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
        org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:111)
        org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)
        org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1045)
        org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:810)
        org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:723)
        org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:396)
        org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:360)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
root cause 
javax.el.PropertyNotFoundException: Property 'model' not found on type java.lang.String
        javax.el.BeanELResolver$BeanProperties.get(BeanELResolver.java:214)
        javax.el.BeanELResolver$BeanProperties.access$400(BeanELResolver.java:191)
        javax.el.BeanELResolver.property(BeanELResolver.java:300)
        javax.el.BeanELResolver.getValue(BeanELResolver.java:81)
        javax.el.CompositeELResolver.getValue(CompositeELResolver.java:54)
        org.apache.el.parser.AstValue.getValue(AstValue.java:123)
        org.apache.el.parser.AstEqual.getValue(AstEqual.java:38)
        org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:186)
        org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:938)
        org.apache.jsp.WEB_002dINF.jsp.sellcar_jsp._jspx_meth_c_005fif_005f0(sellcar_jsp.java:847)
        org.apache.jsp.WEB_002dINF.jsp.sellcar_jsp._jspx_meth_c_005fforEach_005f0(sellcar_jsp.java:791)
        org.apache.jsp.WEB_002dINF.jsp.sellcar_jsp._jspService(sellcar_jsp.java:107)
        org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
        org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
        org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:111)
        org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)
        org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1045)
        org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:810)
        org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:723)
        org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:396)
        org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:360)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
</b> 
```

我的模型：

**车：**

```
package com.usedcarsearch.domain;

// Generated Feb 19, 2013 10:31:37 PM by Hibernate Tools 3.4.0.CR1

import java.math.BigDecimal;
import java.util.HashSet;
import java.util.Set;

/**
 * Car generated by hbm2java
 */
public class Car implements java.io.Serializable {

private Integer carId;
private Make make;
private State state;
private Model model;
private City city;
private String vin;
private int year;
private String image;
private String engine;
private String trans;
private String mileage;
private BigDecimal price;
private String color;
private BigDecimal hwyMpg;
private BigDecimal cityMpg;
private String address;
private String accessories;
private String comments;
private Set buyers = new HashSet(0);
private Set ownerships = new HashSet(0);
private Set carSearchLists = new HashSet(0);

public Car() {
}

public Car(Make make, State state, Model model, City city, int year,
        String engine, String trans, String mileage) {
    this.make = make;
    this.state = state;
    this.model = model;
    this.city = city;
    this.year = year;
    this.engine = engine;
    this.trans = trans;
    this.mileage = mileage;
}

public Car(Make make, State state, Model model, City city, String vin,
        int year, String image, String engine, String trans,
        String mileage, BigDecimal price, String color, BigDecimal hwyMpg,
        BigDecimal cityMpg, String address, String accessories,
        String comments, Set buyers, Set ownerships, Set carSearchLists) {
    this.make = make;
    this.state = state;
    this.model = model;
    this.city = city;
    this.vin = vin;
    this.year = year;
    this.image = image;
    this.engine = engine;
    this.trans = trans;
    this.mileage = mileage;
    this.price = price;
    this.color = color;
    this.hwyMpg = hwyMpg;
    this.cityMpg = cityMpg;
    this.address = address;
    this.accessories = accessories;
    this.comments = comments;
    this.buyers = buyers;
    this.ownerships = ownerships;
    this.carSearchLists = carSearchLists;
}

public Integer getCarId() {
    return this.carId;
}

public void setCarId(Integer carId) {
    this.carId = carId;
}

public Make getMake() {
    return this.make;
}

public void setMake(Make make) {
    this.make = make;
}

public State getState() {
    return this.state;
}

public void setState(State state) {
    this.state = state;
}

public Model getModel() {
    return this.model;
}

public void setModel(Model model) {
    this.model = model;
}

public City getCity() {
    return this.city;
}

public void setCity(City city) {
    this.city = city;
}

public String getVin() {
    return this.vin;
}

public void setVin(String vin) {
    this.vin = vin;
}

public int getYear() {
    return this.year;
}

public void setYear(int year) {
    this.year = year;
}

public String getImage() {
    return this.image;
}

public void setImage(String image) {
    this.image = image;
}

public String getEngine() {
    return this.engine;
}

public void setEngine(String engine) {
    this.engine = engine;
}

public String getTrans() {
    return this.trans;
}

public void setTrans(String trans) {
    this.trans = trans;
}

public String getMileage() {
    return this.mileage;
}

public void setMileage(String mileage) {
    this.mileage = mileage;
}

public BigDecimal getPrice() {
    return this.price;
}

public void setPrice(BigDecimal price) {
    this.price = price;
}

public String getColor() {
    return this.color;
}

public void setColor(String color) {
    this.color = color;
}

public BigDecimal getHwyMpg() {
    return this.hwyMpg;
}

public void setHwyMpg(BigDecimal hwyMpg) {
    this.hwyMpg = hwyMpg;
}

public BigDecimal getCityMpg() {
    return this.cityMpg;
}

public void setCityMpg(BigDecimal cityMpg) {
    this.cityMpg = cityMpg;
}

public String getAddress() {
    return this.address;
}

public void setAddress(String address) {
    this.address = address;
}

public String getAccessories() {
    return this.accessories;
}

public void setAccessories(String accessories) {
    this.accessories = accessories;
}

public String getComments() {
    return this.comments;
}

public void setComments(String comments) {
    this.comments = comments;
}

public Set getBuyers() {
    return this.buyers;
}

public void setBuyers(Set buyers) {
    this.buyers = buyers;
}

public Set getOwnerships() {
    return this.ownerships;
}

public void setOwnerships(Set ownerships) {
    this.ownerships = ownerships;
}

public Set getCarSearchLists() {
    return this.carSearchLists;
}

public void setCarSearchLists(Set carSearchLists) {
    this.carSearchLists = carSearchLists;
}

} 
```

**模型：**

```
 package com.usedcarsearch.domain;

        // Generated Feb 19, 2013 10:31:37 PM by Hibernate Tools 3.4.0.CR1

        import java.util.HashSet;
        import java.util.Set;

        /**
         * Model generated by hbm2java
         */
        public class Model implements java.io.Serializable {

            private Integer modId;
            private String model;
            private Set cars = new HashSet(0);

            public Model() {
            }

            public Model(String model) {
                this.model = model;
            }

            public Model(String model, Set cars) {
                this.model = model;
                this.cars = cars;
            }

            public Integer getModId() {
                return this.modId;
            }

            public void setModId(Integer modId) {
                this.modId = modId;
            }

            public String getModel() {
                return this.model;
            }

            public void setModel(String model) {
                this.model = model;
            }

            public Set getCars() {
                return this.cars;
            }

            public void setCars(Set cars) {
                this.cars = cars;
            }

        } 
```

**汽车.hbm**

```
 <?xml version="1.0"?>
    <!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/
             Hibernate Mapping DTD 3.0//EN"
     "http://hibernate.sourceforge.net
             /hibernate-mapping-3.0.dtd">
    <!-- Generated Feb 19, 2013 10:31:37 PM by Hibernate Tools 3.4.0.CR1 -->
    <hibernate-mapping default-lazy="false">
     <class name="com.usedcarsearch.domain.Car" table="Car">
      <id name="carId" type="java.lang.Integer">
       <column name="carId"/>
       <generator class="identity"/>
      </id>
      <many-to-one class="com.usedcarsearch.domain.Make" 
              fetch="select" name="make">
       <column name="fkMakeId" not-null="true"/>
      </many-to-one>
      <many-to-one class="com.usedcarsearch.domain.State" 
               fetch="select" name="state">
       <column name="fkStateId" not-null="true"/>
      </many-to-one>
      <many-to-one class="com.usedcarsearch.domain.Model" 
               fetch="select" name="model">
       <column name="fkModelId" not-null="true"/>
      </many-to-one>
              <many-to-one class="com.usedcarsearch.domain.City" 
               fetch="select" name="city">
       <column name="fkZipCode" not-null="true"/>
      </many-to-one>
      <property generated="never" lazy="false" name="vin" type="string">
       <column length="25" name="vin"/>
      </property>
      <property generated="never" lazy="false" name="year" type="int">
       <column name="year" not-null="true"/>
      </property>
      <property generated="never" lazy="false" name="image" type="string">
       <column length="100" name="image"/>
      </property>
      <property generated="never" lazy="false" name="engine" type="string">
       <column length="45" name="engine" not-null="true"/>
      </property>
      <property generated="never" lazy="false" name="trans" type="string">
       <column length="45" name="trans" not-null="true"/>
      </property>
      <property generated="never" lazy="false" name="mileage" type="string">
       <column length="20" name="mileage" not-null="true"/>
      </property>
      <property generated="never" lazy="false" name="price" type="big_decimal">
       <column name="price" precision="11"/>
      </property>
      <property generated="never" lazy="false" name="color" type="string">
       <column length="20" name="color"/>
      </property>
      <property generated="never" lazy="false" name="hwyMpg" type="big_decimal">
       <column name="hwyMpg" precision="3" scale="1"/>
      </property>
     <property generated="never" lazy="false" name="cityMpg" type="big_decimal">
       <column name="cityMpg" precision="3" scale="1"/>
      </property>
      <property generated="never" lazy="false" name="address" type="string">
       <column length="50" name="address"/>
      </property>
      <property generated="never" lazy="false" name="accessories" type="string">
       <column length="100" name="accessories"/>
      </property>
      <property generated="never" lazy="false" name="comments" type="string">
       <column length="100" name="comments"/>
      </property>
      <set fetch="select" inverse="true" lazy="false" name="buyers"
       sort="unsorted" table="Buyer">
       <key>
        <column name="fkCarId" not-null="true"/>
       </key>
       <one-to-many class="com.usedcarsearch.domain.Buyer"/>
      </set>
      <set fetch="select" inverse="true" lazy="false" name="ownerships"
       sort="unsorted" table="Ownership">
       <key>
        <column name="fkCarId" not-null="true"/>
       </key>
       <one-to-many class="com.usedcarsearch.domain.Ownership"/>
      </set>
      <set fetch="select" inverse="true" lazy="false" name="carSearchLists"
       sort="unsorted" table="Car_Search_List">
       <key>
        <column name="fkCarId" not-null="true"/>
       </key>
       <one-to-many class="com.usedcarsearch.domain.CarSearchList"/>
      </set>
     </class>
    </hibernate-mapping> 
```

**JSP 代码：（我没有包含所有内容，只包含必要的内容）**

```
 <spring:bind path="command.model">
 <select name='<c:out value="${status.expression}"/>'>
    <option value=""></option>
    <c:forEach items="${cars}" var="car">
    <option value='<c:out value="${car.model.modId}"/>'
    <c:if test="${car.model.model == status.value.model}">SELECTED</c:if>>
    <c:out value="${car.model.model}" />
    </option>
        </c:forEach>
      </select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T04:54:51.293

我把它修好了。看来我必须在 Car.hbm 中添加外键属性，同时将外键变量、getter 和 setter 添加到 Car。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:25:41.903

根据错误消息，您可能希望将第 28 行从：

```
status.value.model 
```

至

```
status.value 
```

# regex - Git 通过 grep/regex 添加行到索引

> ID：15234500
> 
> 赞同：25
> 
> 时间：2013-03-05T21:30:23.930
> 
> 标签：regex, git, git-add

我有一个巨大的补丁，我想将它分成多个逻辑 git 提交。大量更改只是更改变量名称或函数调用，以便可以使用 grep 轻松定位它们。如果我可以将与正则表达式匹配的任何更改添加到索引中，然后在 git gui 中进行清理，它将为我节省大量的手动工作。有没有一种好方法可以使用 git 中的正则表达式或 grep 的某些输出（例如行号）逐行更新索引？

我发现[了一个类似的问题](https://stackoverflow.com/questions/2783166/git-add-part-of-changed-file-to-index-by-line-numbers)，但我不确定如何从正则表达式搜索构建临时文件。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-04-09T09:57:59.657

[patchutils](http://cyberelk.net/tim/software/patchutils/)有一个命令`grepdiff`可以用来实现这一点。

```
# check that the regex search correctly matches the changes you want.
git diff -U0 | grepdiff 'regex search' --output-matching=hunk  

# then apply the changes to the index
git diff -U0 | grepdiff 'regex search' --output-matching=hunk | git apply --cached --unidiff-zero 
```

我`-U0`在 diff 上使用以避免获得不相关的更改。您可能需要调整此值以适应您的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-03T15:56:03.530

更简单地说，您可以使用`git add -p`并利用该`/`选项在您的差异中搜索要添加的补丁。它不是完全自动化的，但比我发现的其他替代方案更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-27T08:08:09.493

你可以先运行：

```
git status | \grep "your_pattern" 
```

如果输出符合预期，则将文件添加到索引中：

```
git add $(git status | \grep "your_pattern") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-28T14:13:56.930

我现在正在 Windows 上使用 Git-Bash，我遇到了类似的问题：我不需要从“未暂存的提交文件列表”中添加一些文件：

```
 $ git status
 On branch Bug_#292400_buggy
 Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

    modified:   the/path/to/the/file333.NO   
    modified:   the/path/to/the/file334.NO 
    modified:   the/path/to/the/file1.ok
    modified:   the/path/to/the/file2.ok
    modified:   the/path/to/the/file3.ok
    modified:   the/path/to/the/file4.ok
    ....................................
    modified:   the/path/to/the/file666.ok 
```

首先，我检查了文件选择是否是我想要的：

```
$ git status | grep ok
            modified:   the/path/to/the/file1.ok
            modified:   the/path/to/the/file2.ok
            modified:   the/path/to/the/file3.ok
            modified:   the/path/to/the/file4.ok
            ....................................
            modified:   the/path/to/the/file666.ok 
```

我尝试了这个 dorum 中描述的一个想法，以便使用 git 添加相同的文件列表，如下所示：

```
$ git add $(git status | \grep "your_pattern") 
```

但这对我不起作用（*记住：Windows10 上的 Git-Bash*）

至少，我直接尝试了，效果很好：

```
$ git add *ok
$ git status
On branch Bug_#292400_buggy
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

            modified:   the/path/to/the/file1.ok
            modified:   the/path/to/the/file2.ok
            modified:   the/path/to/the/file3.ok
            modified:   the/path/to/the/file4.ok
            ....................................
            modified:   the/path/to/the/file666.ok

Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

        modified:   the/path/to/the/file333.NO   
        modified:   the/path/to/the/file334.NO 
```

准备提交，所以。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-07T01:36:42.180

xargs 是您正在寻找的。尝试这个：

```
grep -irl 'regex_term_to_find' * | xargs -I FILE git add FILE 
```

由管道决定的`|`是用于搜索所有文件的标准 grep 命令`*`。选项是：

*   `i`- 不区分大小写
*   `r`- 通过目录递归
*   `l`- 仅列出文件名

`xargs`语句的一部分`FILE`是用于 grep 命令传递的每个参数/匹配的变量的名称。然后在适当的地方使用变量输入所需的命令。

# sql - Select 下的子查询 - 添加 where 子句以排除数据

> ID：15234503
> 
> 赞同：0
> 
> 时间：2013-03-05T21:30:25.973
> 
> 标签：sql, select, subquery

您好，我正在为我们的客户群提取卷信息，并想为 SELECT 下的列 [Volume2] 编写一个子查询，以便在 Fiscal Year = 2013 时提取卷信息。由于当前编写查询，所有卷当前都包含在 Fiscal Years >= 2012 在 WHERE 子句下，但我不想在那里更改它，我想为 SELECT 下的 [Volume2] 列指定它。因此，[Volume1] 列将包括 2012 和 2013 财年的交易量，而 [Volume2] 列将仅包括 2013 年的交易量。

任何帮助表示赞赏！谢谢！

```
SELECT 

sum([FactActualDetail].[Volume]) AS [Volume1],
sum([FactActualDetail].[Volume]) AS [Volume2],
sum([FactActualDetail].[AdjGrossMarginAmount]) AS [AdjGrossMarginAmount],
left([FactActualDetail].[SourceCustomerProductCode],7) as [Acct #],
[DimDate].[Fiscal_Year] as [Fiscal_Year],
[DimCustomer].[TerrSalesManagerName] AS [TerrSalesManagerName],
[DimCustomer].[AccountRepsalesmanName] AS [AccountRepsalesmanName]

FROM [dbo].[FactActualDetail] [FactActualDetail] 

LEFT JOIN [dbo].[DimCustomer] [DimCustomer] ON ([FactActualDetail].[CustomerSK] = [DimCustomer].[CustomerSK])
LEFT JOIN [Common].[DimDate] [DimDate] ON ([FactActualDetail].[DeliveryDateSK] = [DimDate].[DateSK])

WHERE [EQMultiplier] > 0 AND [Fiscal_Year] >= 2012 AND ([SuperChannelCode] = 04 OR [SuperChannelCode] = 06 OR [SuperChannelCode] = 07) AND (substring([SourceCustomerProductCode],8,3) = 102) 

GROUP BY left([FactActualDetail].[SourceCustomerProductCode],7),[TerrSalesManagerName],[AccountRepsalesmanName],[Fiscal_Year] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:49:12.437

利用

```
SUM(CASE WHEN Fiscal_Year = 2013 THEN FactActualDetail.Volume
         ELSE 0 END) AS Volume2 
```

而不仅仅是

```
SUM(FactActualDetail.Volume) AS volume2 
```

在您的查询中。

# ios - 是否有更准确的方法来使用 Sphero API 检测球对球的碰撞？

> ID：15234516
> 
> 赞同：3
> 
> 时间：2013-03-05T21:30:49.190
> 
> 标签：ios, objective-c, collision-detection, sphero-api

我正在为 sphero，机器人球（他们的论坛有问题，似乎无法提问）编写游戏。我正在尝试为 2 名或更多球员进行球对球碰撞检测。

首先，他们在这里提供了一个示例： [https ://github.com/orbotix/Sphero-iOS-SDK/tree/master/samples/CollisionDetection](https://github.com/orbotix/Sphero-iOS-SDK/tree/master/samples/CollisionDetection)

他们提供的阈值太敏感了，在木地板上它一直触发。暂时忘记这一点，我必须使用两个设备的影响时间戳来查看它们是否大致同时触发了碰撞。

我的问题是在减去时间戳时，在某些情况下我会得到非常广泛的变化，而且我认为差异一开始就很长。我存储了几个时间戳，所以我不会错过正确的时间戳，我尝试使用死时间来查看降低它是否会有所帮助。

最常见的是减去 2 个 NSTimeIntervals 我得到 0.68 和 0.72 之间的差异（我预计会有 0.01 级反应）。所以我检查差异是否低于 0.72，连续 3 次我在 0.72 和 0.73 之间，有几次我得到 1.5、2.6、1.1 甚至 3.8。

它似乎并不可靠。文档说这次来自 iPhone 参考。两台设备都会同步以自动获取时间，因此它们尽可能彼此靠近。

有没有人试过这个并想出一个可靠的解决方案，不涉及保持一个球静止？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:59:39.497

当我开始担任 Sphero 的制造商 Orbotix 的开发人员时，我对球对球碰撞的主题进行了大量研究。

这是一个非常复杂的问题要解决。我最接近完成这项工作（对于受感染的僵尸研究游戏）是检测哪个球击中哪个球的准确率约为 80%，样本大小为 3。你放入游戏中的球越多，准确率越低变得。因此，我们决定通过让一个球在它变得脆弱之前停止移动来消除这个问题，就像在 Sphero TAG 中一样。

有几个因素限制了这种能力，您似乎已经发现了它们。我认为最大的问题是碰撞检测在球行驶时表现不佳。尤其是在粗糙的表面上或当球做出快速的急速运动时。再加上死区时间，仅此一项就会导致专业问题。

我能够将碰撞时间戳平均控制在 50 毫秒内。您是否考虑在手机之间传输数据包时的 wifi 延迟？

解决方案是您可能不想听到的，但您应该调整您的游戏玩法以在碰撞检测功能范围内工作。也就是说，当可以接触到球时，球的行驶速度非常慢，甚至像 TAG 一样停下来。问问自己，如果没有球对球的碰撞，我怎样才能让这个变得有趣？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T20:49:58.690

我只想说，首先，我们正在将我们的开发者支持论坛移到 StackOverflow，这就是为什么你不能在论坛上发帖的原因。所以，西蒙，你来到 StackOverflow 是对的，你应该感到自豪。

我们只是将论坛更改为重定向到这里，而不是让人们感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T20:04:57.113

时间戳*由*Sphero 生成。但它们只有在您使用 Poll Packet Times 命令来生成延迟和偏移值时才有意义。请参考 API 命令文档中的 DID 00h、CID 50h。

话虽如此，碰撞检测是我们不断发展的技术。我们在机器人内部实时滑动数据窗口上采用了巧妙编码的 DFT 频率变换。这些参数允许调整到您正在运行的表面；没有通用设置。如果您获得太多误报，请进行实验。如果您有改进算法的想法，请直接联系我们，也许我们可以将其作为一种新的过滤方法。我们总是对聪明的想法持开放态度！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-11T03:50:08.807

您可以在游戏开始时同步每个 Sphero 的内部计时器。这些可以与每个主机电话内的同步计时器进行匹配。时钟可能不同，但一毫秒就是一毫秒。您还可以降低碰撞检测的阈值，从而使“事件”（损坏、感染等）只有在“攻击”Sphero 以一定速度移动时才会发生。或其变体。

# slickgrid - Slickgrid - 使用箭头链接移动行

> ID：15234517
> 
> 赞同：1
> 
> 时间：2013-03-05T21:30:50.497
> 
> 标签：slickgrid

我正在尝试创建一个函数，当在某一行上单击箭头链接（向上或向下）时，该行将向上或向下移动。

有没有办法以这种方式动态移动数据中的行？

（我知道有 RowMoveManager 但需求请求箭头链接而不是可拖动）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:06:52.847

我找到了一种方法，尽管它可能不是最有效的方法。我的数据中有一个列，排名，我在箭头 moveOneUp(index); 上添加了一个 onClick 函数；

```
function moveOneUp(rowIndex) {
        _grid.dataView.getItem(rowIndex).rank = parseInt(_grid.dataView.getItem(rowIndex).rank)-1 ;
        _grid.dataView.getItem(rowIndex-1).rank = parseInt(_grid.dataView.getItem(rowIndex-1).rank)+1;
        _grid.dataView.fastSort('rank');
} 
```

如果有人需要其余的箭头功能：

```
function moveOneDown(rowIndex) {
    _grid.dataView.getItem(rowIndex).rank = parseInt(_grid.dataView.getItem(rowIndex).rank)+1 ;
    _grid.dataView.getItem(rowIndex+1).rank = parseInt(_grid.dataView.getItem(rowIndex+1).rank)-1;
    _grid.dataView.fastSort('rank');
}

function moveTop(rowIndex) {
    _grid.dataView.getItem(rowIndex).rank = 0 ;
    _grid.dataView.fastSort('rank');
}

function moveBottom(rowIndex) {
    _grid.dataView.getItem(rowIndex).rank = parseInt(_grid.dataView.getLength())+1;
    _grid.dataView.fastSort('rank');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-07T11:22:07.727

```
function moveOneUp(rowIndex) {
    dataViewReorder.beginUpdate();
    rowIndex = rowIndex - 1;
    dataViewReorder.getItem(rowIndex).intOrd0 = parseInt(dataViewReorder.getItem(rowIndex).intOrd0) - 1;        
    dataViewReorder.getItem(rowIndex - 1).intOrd0= parseInt(dataViewReorder.getItem(rowIndex - 1).intOrd0) + 1;
    dataViewReorder.fastSort('intOrd0');

    dataViewReorder.setItems(dataReorder);
    dataViewReorder.endUpdate();

    gridReorder.setData(dataViewReorder);
    gridReorder.render();
}
function moveOneDown(rowIndex) {
    dataViewReorder.beginUpdate();
    rowIndex = rowIndex - 1;
    dataViewReorder.getItem(rowIndex).intOrd0= parseInt(dataViewReorder.getItem(rowIndex).intOrd0) + 1;
    dataViewReorder.getItem(rowIndex + 1).intOrd0= parseInt(dataViewReorder.getItem(rowIndex + 1).intOrd0) - 1;
    dataViewReorder.fastSort('intOrd0');

    dataViewReorder.setItems(dataReorder);
    dataViewReorder.endUpdate();

    gridReorder.setData(dataViewReorder);
    gridReorder.render();
} 
```

# php - detect retina (HD) display on the server side

> ID：15234519
> 
> 赞同：21
> 
> 时间：2013-03-05T21:30:52.590
> 
> 标签：php, retina-display

I found many questions about Retina Display, but none of the answers were on the server side.

I would like to deliver a different image according to the screen, ex (in PHP):

```
if( $is_retina)
    $thumbnail = get_image( $item_photo, 'thumbnail_retina' ) ;
else
    $thumbnail = get_image( $item_photo, 'thumbnail' ) ; 
```

Can you see a way of dealing with this?

I can only imagine a test in JavaScript, setting a Cookie. However this requires an initial exchange to set it. Anyone have a better solution?

Cookie setting code:

```
(function(){
  if( document.cookie.indexOf('device_pixel_ratio') == -1
      && 'devicePixelRatio' in window
      && window.devicePixelRatio == 2 ){

    document.cookie = 'device_pixel_ratio=' + window.devicePixelRatio + ';';
    window.location.reload();
  }
})(); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-05T21:48:28.067

好吧，因为目前似乎没有更好的方法，这是我结合 JS、PHP 和 Cookies 的解决方案。

希望以后有更好的答案

```
<?php
    if( isset($_COOKIE["device_pixel_ratio"]) ){
        $is_retina = ( $_COOKIE["device_pixel_ratio"] >= 2 );

        if( $is_retina)
            $thumbnail = get_image( $item_photo, 'thumbnail_retina' ) ;
        else
            $thumbnail = get_image( $item_photo, 'thumbnail' ) ;

    }else{
?>
<script language="javascript">
(function(){
  if( document.cookie.indexOf('device_pixel_ratio') == -1
      && 'devicePixelRatio' in window
      && window.devicePixelRatio == 2 ){

    var date = new Date();
    date.setTime( date.getTime() + 3600000 );

    document.cookie = 'device_pixel_ratio=' + window.devicePixelRatio + ';' +  ' expires=' + date.toUTCString() +'; path=/';
    //if cookies are not blocked, reload the page
    if(document.cookie.indexOf('device_pixel_ratio') != -1) {
        window.location.reload();
    }
  }
})();
</script>
<?php } ?> 
```

在 function.php 中：

```
add_action( 'init', 'CJG_retina' );

function CJG_retina(){

    global $is_retina;  
    $is_retina = isset( $_COOKIE["device_pixel_ratio"] ) AND $_COOKIE["device_pixel_ratio"] >= 2;
} 
```

然后在我可以使用以下 GLOBAL 之后：

`global $is_retina;`或者`$GLOBALS['is_retina'];`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-05-06T17:36:05.330

由于您没有指定您需要什么确切的用例，而且我并没有真正看到服务器的用例知道客户端想要它的图像的分辨率（我认为客户端应该决定）这是我的建议：

使用类似[Retina.js](https://imulus.github.io/retinajs/)或使用 srcset 属性`<img src="low-res.jpg" srcset="medium-res.jpg 1.5x, high-res.jpg 2x">`

这样，您还可以利用图像的浏览器缓存。如果您有一个 url 用于两种不同的图像尺寸，您就无法做到这一点。即使它使用 last-modified 或 etag 标头自动创建/更新图像缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:48:24.503

我不确定到底是怎么做的，但是解决这个问题的纯 PHP 方法是使用**`get_browser`**它返回浏览器版本和一些功能。这可能会告诉你一些*可能*导致它是否在视网膜上运行的信息。

[http://php.net/manual/en/function.get-browser.php](http://php.net/manual/en/function.get-browser.php)

此外，您可以查看**`$_SERVER['HTTP_USER_AGENT']`**哪个会告诉您有关设备的信息。那么您需要一个具有视网膜的设备列表并进行比较以获得答案。

在 JS 中进行视网膜检测可能更容易且万无一失。

# jsf - @EJB 注释 bean 上的 NullPointerException

> ID：15234521
> 
> 赞同：0
> 
> 时间：2013-03-05T21:30:57.700
> 
> 标签：jsf, converter

当我尝试覆盖 getAsObject 函数时遇到问题

```
@FacesConverter("countryConverter")
public class CountryConverter implements Converter {

@EJB private CountryService countryService;

     @Override
        public Object getAsObject(FacesContext context, UIComponent arg1, String arg2){

         Country country = countryService.findByName(arg2);
         return country;
    }

} 
```

所以当我在每个帖子中加载我的组合框时

```
<p:selectOneMenu value="#{registerController.selectedCountry}"
                converter="countryConverter">
                <f:selectItems value="#{registerController.countries}" var="country"
                    itemLabel="#{country.name}" itemValue="#{country}" />
            </p:selectOneMenu> 
```

我在 findbyName 行中遇到了一个 nullPointer 异常！我检查了 arg2 参数，它带有一个有效值，我还测试了服务功能，它也工作正常......在 CountryConverter 类之外。

*正如我在 getAsObject 函数行中所描述的，我得到的错误如下*

```
SEVERE: java.lang.NullPointerException
    at com.garagesalelive.controllers.converter.CountryConverter.getAsObject(CountryConverter.java:29)
    at com.sun.faces.renderkit.html_basic.HtmlBasicInputRenderer.getConvertedValue(HtmlBasicInputRenderer.java:171)
    at com.sun.faces.renderkit.html_basic.MenuRenderer.convertSelectOneValue(MenuRenderer.java:202)
    at com.sun.faces.renderkit.html_basic.MenuRenderer.getConvertedValue(MenuRenderer.java:319)
    at org.primefaces.component.selectonemenu.SelectOneMenuRenderer.getConvertedValue(SelectOneMenuRenderer.java:58)
    at javax.faces.component.UIInput.getConvertedValue(UIInput.java:1030)
    at javax.faces.component.UIInput.validate(UIInput.java:960)
    at javax.faces.component.UIInput.executeValidate(UIInput.java:1233)
    at javax.faces.component.UIInput.processValidators(UIInput.java:698)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at org.primefaces.component.dialog.Dialog.processValidators(Dialog.java:378)
    at javax.faces.component.UIForm.processValidators(UIForm.java:253)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
    at javax.faces.component.UIViewRoot.processValidators(UIViewRoot.java:1172)
    at com.sun.faces.lifecycle.ProcessValidationsPhase.execute(ProcessValidationsPhase.java:76)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)

SEVERE:     at com.garagesalelive.controllers.converter.CountryConverter.getAsObject(CountryConverter.java:29)
SEVERE:     at com.sun.faces.renderkit.html_basic.HtmlBasicInputRenderer.getConvertedValue(HtmlBasicInputRenderer.java:171)
SEVERE:     at com.sun.faces.renderkit.html_basic.MenuRenderer.convertSelectOneValue(MenuRenderer.java:202)
SEVERE:     at com.sun.faces.renderkit.html_basic.MenuRenderer.getConvertedValue(MenuRenderer.java:319)
SEVERE:     at org.primefaces.component.selectonemenu.SelectOneMenuRenderer.getConvertedValue(SelectOneMenuRenderer.java:58)
SEVERE:     at javax.faces.component.UIInput.getConvertedValue(UIInput.java:1030)
SEVERE:     at javax.faces.component.UIInput.validate(UIInput.java:960)
SEVERE:     at javax.faces.component.UIInput.executeValidate(UIInput.java:1233)
SEVERE:     at javax.faces.component.UIInput.processValidators(UIInput.java:698)
SEVERE:     at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
SEVERE:     at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
SEVERE:     at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
SEVERE:     at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
SEVERE:     at org.primefaces.component.dialog.Dialog.processValidators(Dialog.java:378)
SEVERE:     at javax.faces.component.UIForm.processValidators(UIForm.java:253)
SEVERE:     at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
SEVERE:     at javax.faces.component.UIComponentBase.processValidators(UIComponentBase.java:1214)
SEVERE:     at javax.faces.component.UIViewRoot.processValidators(UIViewRoot.java:1172)
SEVERE:     at com.sun.faces.lifecycle.ProcessValidationsPhase.execute(ProcessValidationsPhase.java:76)
SEVERE:     at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
SEVERE:     at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
SEVERE:     at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
SEVERE:     at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
SEVERE:     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
SEVERE:     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
SEVERE:     at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
SEVERE:     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
SEVERE:     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
SEVERE:     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
SEVERE:     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
SEVERE:     at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
SEVERE:     at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
SEVERE:     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
SEVERE:     at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
SEVERE:     at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
SEVERE:     at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
SEVERE:     at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
SEVERE:     at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
SEVERE:     at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:37:24.170

我认为您的 countryService 为空。可能是注射问题。

试试这个

```
@ManagedBean
@RequestScoped
@FacesConverter("countryConverter")
public class CountryConverter implements Converter {... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T03:49:29.630

@EJB 不适用于不受容器管理的 bean。据我了解，它仅适用于 JSF Managed Beans 、其他 EJB 和 servlet。

如果您也在使用 CDI 库，那么您可以尝试，

```
@Inject private CountryService countryService; 
```

或以其他方式进行查找，

```
 InitialContext ctx = new InitialContext();
    CountryService  countryService = 
(CountryService)ctx.lookup("ejb/countryService"); 
```

Your JNDI name will depend on your container or will be value of mappedBy attribute in your EJB if that is supported by your container and is specified by you on EJB.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-11-02T13:44:37.933

by calling `ManagedBean` through `FacesContext`:

```
 context.getApplication().getELResolver().getValue(context.getELContext(), null, "nameOfManagedBean"); 
```

# python - a href not displaying link on page in python cgi

> ID：15234524
> 
> 赞同：0
> 
> 时间：2013-03-05T21:31:05.720
> 
> 标签：python, html, cgi

I have a list of links and some text stored in database. I wish to print the text using the corresponding links using `<a href`.

In a for loop, I tried to print the anchors this way :

```
for i in range(8):
    #print url_list[i], question[i]
    print "<a href=\"" + url_list[i] + "\">" + question[i] + "<\/a>" + "<br>" 
```

The commented part prints the text but the second gives a blank page. This should print 8 links on the page.

What could be wrong ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:33:23.023

What could be wrong?

For one thing, `"<\/a>"` should be `"</a>"`.

For another, your python is incredibly difficult to read. Try:

```
print r'<a href="{0}">{1}</a><br>'.format(url_list[i], question[i]) 
```

or even:

```
for url, q in zip(url_list, question):
  print r'<a href="{0}">{1}</a><br>'.format(url, q) 
```

Also note that if your URLs have special characters in them (such as space or ampersand), you will need to escape them:

```
import urllib
for url, q in zip(url_list, question):
  url = urllib.quote_plus(url)
  print r'<a href="{0}">{1}</a><br>'.format(url, q) 
```

# c++ - Boost 1.53 local date time compiler error with -std=c++0x

> ID：15234527
> 
> 赞同：6
> 
> 时间：2013-03-05T21:31:35.570
> 
> 标签：c++, boost, c++11, g++

Using g++ version 4.7.2, if I try compiling the following

```
#include <boost/date_time/local_time/local_time.hpp> 

class Bar
{
public:

Bar() { tz_db_.load_from_file("/home/date_time_zonespec.csv"); }

private:
    boost::local_time::tz_database tz_db_;
};

int main()
{
    return 0;
} 
```

with -std=c++0x I get the following error.

```
In file included from /usr/local/include/boost/date_time/local_time/local_time_types.hpp:18:0,
                 from /usr/local/include/boost/date_time/local_time/local_time.hpp:13,
                 from test.h:4,
                 from test.cpp:1: /usr/local/include/boost/date_time/local_time/custom_time_zone.hpp: In instantiation of ‘bool boost::local_time::custom_time_zone_base<CharT>::has_dst() const [with CharT = char]’: test.cpp:11:1:   required from here /usr/local/include/boost/date_time/local_time/custom_time_zone.hpp:67:30: error: cannot convert ‘const boost::shared_ptr<boost::date_time::dst_day_calc_rule<boost::gregorian::date>
>’ to ‘bool’ in return 
```

If I leave off the c++0x option, everything is fine. Can anybody tell me what's going on here?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T21:45:22.023

当您为 C++11 构建时，`boost::shared_ptr::operator bool()`声明为`explicit`. 这通常是一件好事，但不幸的是它破坏了依赖隐式转换的代码，例如这个函数（这是你的错误的原因）：

```
virtual bool has_dst() const
{
  return (dst_calc_rules_); //if calc_rule is set the tz has dst
} 
```

哪里`dst_calc_rules_`是`shared_ptr`。

在 Boost 的某个人开始修复它之前，您可以做两件事：

*   破解该功能`return bool(dst_calc_rules_);`
*   定义`BOOST_NO_CXX11_EXPLICIT_CONVERSION_OPERATORS`为允许隐式转换。

# c++ - 如何防止删除成员函数返回的指针？

> ID：15234529
> 
> 赞同：1
> 
> 时间：2013-03-05T21:31:37.580
> 
> 标签：c++, arrays, oop, pointers

考虑下面的示例代码。该类`Data`用于存储数据数组：为简单起见，我选择使用 a`vector<char>`作为数据成员。但是，这些数据必须由外部例程处理，这需要一个指向数组第一个元素的指针，当然还有这个数组的长度：为此，我还实现了函数`get_data()`和`get_length()`.

```
class Data
{
public:
    Data(const char* sourcePtr, int sourceLength) : _data(sourcePtr, sourcePtr+sourceLength) { ; }

    const char* get_data() const { return &_data.front(); }
    int get_length() const { return _data.size(); }

    void print() const
    {
        vector<char>::const_iterator it;
        for(it = _data.begin(); it != _data.end(); ++it)
            cout << *it;
    }

private:
    vector<char> _data;
}; 
```

现在考虑以下使用类的代码示例`Data`。

```
int main(int argc, char** argv)
{
    char* a = new char[4];
    a[0] = 'b';
    a[1] = 'y';
    a[2] = 't';
    a[3] = 'e';

    Data myData(a,4);
    delete[] a;

    myData.print();
    cout << endl;

    const char* aPtr = myData.get_data();

    // The following statement frees the memory allocated
    // for the data member of the class Data.
    delete[] aPtr;

    return 0;
} 
```

上面的语句`delete[] aPtr`释放了为类的数据成员分配的内存`Data`。结果，当`myData`对象被自动解除分配时， 的内容`vector<char>`已经被手动解除分配，显然会出现错误**SIGABRT**。

如何确保编译器将该语句表示`delete[] aPtr`为错误？你应该如何修改类`Data`来实现这个目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:38:52.317

处理这个问题的最直接的方法是确保清楚谁是指针的“所有者”。在我的 C++ 时代，如果一个函数返回了一个指针，那么函数的名称应该以“Create”而不是“Get”开头。后来，我们通常在这种情况下返回智能指针。

事实上，编写 C++ 一点也不难，你永远不需要显式删除任何指针，而是将所有指针存储在一个智能指针中，当指针被销​​毁时它会删除它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T22:00:53.420

停止使用“裸”`new`和`delete`操作，将其包装`new`在 RAII 类型中并且不要使用`delete`，除非您正在编写 RAII 类型的析构函数。

```
std::unique_ptr<char[]> a{ new char[4] };
a[0] = 'b';
a[1] = 'y';
a[2] = 't';
a[3] = 'e';

Data myData(std::move(a),4); 
```

这段代码意味着数组的所有权明确地赋予了智能指针，然后明确地转移给了`Data`对象。尝试`delete`该数组将无法编译。

这并不会阻止用户以后这样做`delete[] aPtr`，但是如果您养成了**从不**使用RAII 类型的析构函数中除外的习惯，那么当有人通过使用他们不应该使用的地方引入错误时`delete`，就会变得*非常*`delete`明显，因为他们没有拥有记忆。

停止摆弄裸指针。如果您的代码的用户不会停止这样做，那么让他们以艰难的方式学习。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:36:14.033

你没有。 `new`并且`delete`不要跟踪谁拥有指针。那是你的工作。

相反，您可以做的是复制指针指向的数据。然后调用者对其数组做了什么并不重要。你有自己的副本，假设你没有做一些脑残的事情，比如把它暴露给任何想要它的人，它是安全的。

或者，查看`std::unique_ptr`和`std::shared_ptr`。:P 就内存管理而言，它们是新的热点；当您使用智能指针时，内存几乎可以自行管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T21:51:27.303

写好文档。阻止其他程序员做愚蠢的事情不是你的工作。

# php - Checked box: Get all values, not only the last one (form, mysql and php)

> ID：15234530
> 
> 赞同：0
> 
> 时间：2013-03-05T21:31:44.260
> 
> 标签：php, mysql, foreach

I am having an issue with a form. I have a database, and with a form I get all the data from the clients with the php function foreach.

On the action page (invoice.php), I can display all the selected items, but every time I put the quantity for each items, it only displays the last text box I filled.

I don't know how to explain it any more, so here's my code:

form.php :

```
 <input type="text" name="txtbox[<?php echo $input->id_article; ?>]" value="<?php echo $input->id_article; ?>" placeholder="1" style="text-align: center; width:30px;"></input>

        <input
            type="checkbox" 
            name="checked_articles[]"
            value="<?php echo $input->id_article; ?>">
        <?php echo "(".
                        ($input->ref_article).")".
                        ($input->nom_article)." (".
                        ($input->prix_article)." €)"; ?><br>
  <?php endforeach; ?> 
```

invoice.php (header with the mysql data queries):

```
if(isset($_POST['checked_articles'])){
foreach($_POST['checked_articles'] as $chkbx){
$sql_articles = 'SELECT * FROM articles WHERE id_article="'.$chkbx.'"';
$req_articles = mysql_query($sql_articles) or die('Erreur SQL !<br>'.$sql_articles.'<br>'.mysql_error());
$data_articles[] = mysql_fetch_assoc($req_articles);
}}

$textbox = $_POST['txtbox'][$chkbx]; 
```

invoice.php (where the datas are displayed):

```
<?php foreach ($data_articles as $input) : ?>
    <tr>
        <td><?php echo $input['ref_article']; ?></td>
        <td><?php echo $input['nom_article']; ?></td>
        <td><?php echo $textbox; ?></td> <!-- Where I want the quantity to be displayed -->
        <td><?php echo $input['prix_article']; ?> €&lt;/td>
        <td><?php echo $input['prix_article']*$textbox; ?> €&lt;/td>
    </tr>
    <?php endforeach; ?> 
```

I want to display, for each selected items, the quantity the users put on the text box.

Any help would be highly apprecied !
Thank you!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:11:56.730

从您的代码的外观来看，$textbox 是一个充满 id 的数组，如下所示：

```
Array
(
    [txtbox] => Array
        (
            [1] => 1
            [2] => 1
            [3] => 1
        )

) 
```

在您的 foreach 中，您需要使用文章 ID 引用该值，如下所示：

```
<td><?php echo $_POST['txtbox'][$input['id_article']]; ?></td> 
```

此外，您应该考虑防止 sql 注入。你 sql 中的 id 是直接从帖子传递的。

希望能帮助到你。

# javascript - NetBeans 7.3 - disable closing brackets and parentheses automatically

> ID：15234535
> 
> 赞同：3
> 
> 时间：2013-03-05T21:31:56.003
> 
> 标签：javascript, ide, netbeans-7

I'm using NetBeans 7.3 to edit JavaScript files.

Whenever I type a `(` or a `[`, NetBeans automatically inserts a `)` or a `]`.

I find this annoying (it also doesn't always work correctly).

Is there a way to turn this feature off?

This was possible in NetBeans 7.2 by disabling the following feature:

*   *Insert Closing Brackets Automatically*

However, it no longer works in NetBeans 7.3

In NetBeans 7.3 this feature only controls whether or not closing brackets are added after if statements, for loops, etc...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:42:27.540

在 7.2 版中，可以通过 禁用此功能`Options > Editor > Code Completion > "Insert Closing Brackets Automatically"`。7.3 应该是一样的

# java - Plugin execution not covered by lifecycle configuration: com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.5.0:generate-sources

> ID：15234536
> 
> 赞同：17
> 
> 时间：2013-03-05T21:31:56.393
> 
> 标签：java, android, eclipse, maven, maven-3

I have an Android application, which is built using `pom.xml` file given below. `mvn clean install` works without errors, but in Eclipse I get following errors:

```
Plugin execution not covered by lifecycle configuration: com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.5.0:generate-sources (execution: default-generate-sources, phase: generate-sources)
Plugin execution not covered by lifecycle configuration: com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.5.0:proguard (execution: default-proguard, phase: process-classes) 
```

How can I fix them?

Here's the `pom.xml` file:

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.mycompany</groupId>
    <artifactId>myapp-android</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <packaging>apk</packaging>
    <name>myappAndroidClient</name>

    <repositories>
        <repository>
            <id>achartengine</id>
            <name>Public AChartEngine repository</name>
            <url>https://repository-achartengine.forge.cloudbees.com/snapshot/</url>
        </repository>       
    </repositories>

    <dependencies>
        <dependency>
            <groupId>com.google.android</groupId>
            <artifactId>android</artifactId>
            <version>4.1.1.4</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.8.2</version>
            <scope>compile</scope>
        </dependency>
        <!-- Make sure this (robolectric dependency) is below the android dependencies -->
        <dependency>
            <groupId>com.pivotallabs</groupId>
            <artifactId>robolectric</artifactId>
            <version>1.0-RC4</version>
        </dependency>
        <dependency>
            <groupId>org.achartengine</groupId>
            <artifactId>achartengine</artifactId>
            <version>1.1.0</version>
        </dependency>               
    </dependencies>
    <build>
        <finalName>${project.artifactId}</finalName>
        <sourceDirectory>src</sourceDirectory>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <configuration>
                        <source>1.6</source>
                        <target>1.6</target>
                        <encoding>UTF-8</encoding>
                    </configuration>
                </plugin>

                <plugin>
                    <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                    <artifactId>android-maven-plugin</artifactId>
                    <version>3.5.0</version>

                    <extensions>true</extensions>

                </plugin>
            </plugins>
        </pluginManagement>
        <plugins>
            <plugin>
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                    <configuration>
                        <sdk>
                            <!-- platform or api level (api level 4 = platform 1.6) -->
                            <platform>17</platform>
                            <path>C:\Program Files\adt-bundle-windows-x86\adt-bundle-windows-x86\sdk</path>
                        </sdk>
                    </configuration>
            </plugin>
        </plugins>
    </build>
    <reporting>
        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>javancss-maven-plugin</artifactId>
                <version>2.0</version>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-pmd-plugin</artifactId>
                <configuration>
                    <targetJdk>1.7</targetJdk>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-checkstyle-plugin</artifactId>
                <version>2.6</version>
                <configuration>
                    <configLocation>altruix-checkstyle.xml</configLocation>
                    <includeTestSourceDirectory>true</includeTestSourceDirectory>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>cobertura-maven-plugin</artifactId>
                <version>2.5.2</version>
                <configuration>
                    <formats>
                        <format>html</format>
                        <format>xml</format>
                    </formats>
                    <instrumentation>
                        <excludes>
                            <exclude>**/*Test.class</exclude>
                        </excludes>
                    </instrumentation>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-project-info-reports-plugin</artifactId>
                <version>2.0.1</version>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-site-plugin</artifactId>
                <version>2.2</version>
                <configuration>
                    <inputEncoding>UTF-8</inputEncoding>
                    <outputEncoding>UTF-8</outputEncoding>
                    <locales>en</locales>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>findbugs-maven-plugin</artifactId>
                <version>2.5.2</version>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>jdepend-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </reporting>
</project> 
```

**Update 1 (06.03.2013)**: Here's the list of installed plugins.

![enter image description here](../Images/fd8ed0a474d87bfaca9013471b947f12.png)

**Update 2 (08.03.2013):** Below you can find the updated `pom.xml`. Now I get another error - `Plugin execution not covered by lifecycle configuration: com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.5.0:proguard (execution: default-proguard, phase: process-classes)` at the place marked by `<!-- Error occurs here -->` in the XML code below.

```
 <build>
        <finalName>${project.artifactId}</finalName>
        <sourceDirectory>src</sourceDirectory>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <configuration>
                        <source>1.6</source>
                        <target>1.6</target>
                        <encoding>UTF-8</encoding>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>org.eclipse.m2e</groupId>
                    <artifactId>lifecycle-mapping</artifactId>
                    <version>1.0.0</version>
                    <configuration>
                        <lifecycleMappingMetadata>
                            <pluginExecutions>
                                <pluginExecution>
                                    <pluginExecutionFilter>
                                        <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                                        <artifactId>android-maven-plugin</artifactId>
                                        <versionRange>[3.5.0,)</versionRange>
                                        <goals>
                                            <goal>generate-sources</goal>
                                        </goals>
                                    </pluginExecutionFilter>
                                    <action>
                                        <ignore />
                                    </action>
                                </pluginExecution>
                            </pluginExecutions>
                        </lifecycleMappingMetadata>
                    </configuration>
                </plugin>
                <plugin>
                    <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                    <artifactId>android-maven-plugin</artifactId>
                    <version>3.5.0</version>
                    <extensions>true</extensions>

                </plugin>

                <plugin>
                    <artifactId>maven-resources-plugin</artifactId>
                    <version>2.5</version>
                </plugin>
            </plugins>
        </pluginManagement>
        <plugins>
            <plugin> <!-- Error occurs here -->
                <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                <artifactId>android-maven-plugin</artifactId>
                <configuration>
                    <sdk>
                        <!-- platform or api level (api level 4 = platform 1.6) -->
                        <platform>17</platform>
                        <path>C:\Program Files\adt-bundle-windows-x86\adt-bundle-windows-x86\sdk</path>
                    </sdk>
                </configuration>
            </plugin>
        </plugins>
    </build> 
```

**Update 3 (08.03.2013):** When I change the `pom.xml` file in this way

```
<plugin>
    <groupId>org.eclipse.m2e</groupId>
    <artifactId>lifecycle-mapping</artifactId>
    <version>1.0.0</version>
    <configuration>
        <lifecycleMappingMetadata>
            <pluginExecutions>
                <pluginExecution>
                    <pluginExecutionFilter>
                        <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                        <artifactId>android-maven-plugin</artifactId>
                        <versionRange>[3.5.0,)</versionRange>
                        <goals>
                            <goal>generate-sources</goal>
                            <goal>proguard</goal>
                            <goal>emma</goal>
                            <goal>dex</goal>
                            <goal>internal-pre-integration-test</goal>
                            <goal>internal-integration-test</goal>
                        </goals>
                    </pluginExecutionFilter>
                    <action>
                        <ignore />
                    </action>
                </pluginExecution>
            </pluginExecutions>
        </lifecycleMappingMetadata>
    </configuration>
</plugin>
<plugin>
    <groupId>com.jayway.maven.plugins.android.generation2</groupId>
    <artifactId>android-maven-plugin</artifactId>
    <version>3.5.0</version>
    <extensions>true</extensions>

</plugin> 
```

and run the application from Eclipse, I get following error:

```
FATAL EXCEPTION: main
java.lang.NoClassDefFoundError: co.altruix.ccp.android.impl.viewtype2fragmentmapper.DefaultViewTypeToFragmentMapper
    at co.altruix.ccp.android.impl.activities.MainActivity.<init>(MainActivity.java:22)
    at java.lang.Class.newInstanceImpl(Native Method)
    at java.lang.Class.newInstance(Class.java:1319)
    at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
    at android.app.ActivityThread.access$600(ActivityThread.java:141)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:5039)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
    at dalvik.system.NativeStart.main(Native Method) 
```

When I run the same application using `mvn clean install; mvn android:emulator-start; mvn android:deploy`, everything works fine.

**Update 4 (11.03.2013 00:24 MSK):** Here's the list of installed plugins in my new eclipse installation:

![List of plugins](../Images/ebd81248c38f76241a7f46bb177d3c58.png)

**Update 5 (12.03.2013 23:22 MSK):** Here's the classpath (achartengine seems to be included):

![Classpath](../Images/dff23460148e11cb01f93c2a2d1aed6c.png)

You can also download my [Eclipse installation](https://dl.dropbox.com/u/11776689/2013_03_12_android-eclipse.7z).

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T13:11:43.323

解决它的一种方法是将以下部分添加到您的**pom.xml**（或父 pom.xml）中：

```
<plugin>
   <groupId>org.eclipse.m2e</groupId>
   <artifactId>lifecycle-mapping</artifactId>
   <version>1.0.0</version>
   <configuration>
      <lifecycleMappingMetadata>
         <pluginExecutions>
            <pluginExecution>
               <pluginExecutionFilter>
                  <groupId>com.jayway.maven.plugins.android.generation2</groupId>
                  <artifactId>android-maven-plugin</artifactId>
                  <versionRange>[3.5.0,)</versionRange>
                  <goals>                                                               
                     <goal>generate-sources</goal>      
                     <goal>proguard</goal>
                     <goal>emma</goal>
                     <goal>dex</goal>
                     <goal>apk</goal>
                     <goal>internal-pre-integration-test</goal>
                     <goal>internal-integration-test</goal>                                         
                  </goals>
               </pluginExecutionFilter>
               <action>
                  <execute />
               </action>
            </pluginExecution>
         </pluginExecutions>
      </lifecycleMappingMetadata>
   </configuration>
</plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-27T04:16:28.183

我在**Spring Tool Suite 4**（*版本：4.6.0.RELEASE*）上遇到了完全相同的问题。

**我是如何解决的。**

**步骤 1.**将鼠标悬停在 pom.xml 中的执行元素上

[![在此处输入图像描述](../Images/f56dddb57a8b003ea8cc7e93a181a467.png)](https://i.stack.imgur.com/jpXQ1.png)

**步骤 2.**选择“***在 pom.xml 中将目标编译标记为已忽略***”或“***在 Eclipse 首选项中将目标编译为已忽略***”，具体取决于您是要忽略项目级别还是 IDE 级别的执行。

**步骤 3.**在包资源管理器中右键单击您的项目和“ ***Maven --> 更新项目***”

# winforms - Trouble binding entity framework 5 object with windows control

> ID：15234537
> 
> 赞同：0
> 
> 时间：2013-03-05T21:31:57.330
> 
> 标签：winforms, data-binding, entity-framework-5

I'm using Entity Framework for the first time (database first, entity framework 5) in a windows forms application (vs2010, .net 4). I am having trouble with the binding between my entity object and the windows forms controls. I have textbox, datetimepicker and combobox controls. When I open a window with the bound controls, the correct data is displayed in the controls. However, when I change the value in one of my controls and tab off the control, the value reverts to the original value in the control as if the value is not getting pushed to the object. Here are code exerpts:

**My entity object:**

```
namespace Entities
{
    using System;
    using System.Collections.Generic;

    public partial class ExternalDocument
    {
        public int ExternalDocumentID { get; set; }
        public bool Active { get; set; }
        public bool Closed { get; set; }
        public Nullable<int> CompanyID { get; set; }
        public Nullable<int> ContactID { get; set; }
        public string DocumentNbr { get; set; }
        public Nullable<System.DateTime> DocumentDate { get; set; }
        public Nullable<System.DateTime> DateReceived { get; set; }

        public virtual Company Company { get; set; }
        public virtual Contact Contact { get; set; }
    }
} 
```

**The data binding:**

```
private void SetDataBindings()
        {
            LoadComboBoxValues();
            this.textDocumentNbr.DataBindings.Add("Text", this.document, "DocumentNbr");
            this.textDocumentNbr.Leave += new EventHandler(textDocumentNbr_Leave);
            this.dateDocument.DataBindings.Add(new Binding("Value", this.document, "DocumentDate"));
            this.dateReceived.DataBindings.Add("Value", this.document, "DateReceived");
            this.comboCompanyID.DataBindings.Add("SelectedValue", document, "CompanyID");
        } 
```

I have wondered if there is an entity framework error when the object property is set but I have not been able to figure out a good way to trap any such errors. My entity framework object does not have the On< PropertyName >Changing methods that are created for earlier versions of entity framework. I have been trying to trap errors when focus leaves the control but think this can't be the best method:

```
private void dateDocument_Leave(object sender, EventArgs e)
        {

            string errorString = this.entitiesController.GetValidationErrors();
            this.errorDocumentDate.SetError(this.dateDocument, errorString);
        }

public string GetValidationErrors()
        {
            string errorString = "";

            List<DbEntityValidationResult> errorList = (List<DbEntityValidationResult>)this.finesse2Context.GetValidationErrors();
            if (errorList.Count > 0)
            {
                foreach(var eve in errorList)
                {
                    errorString += "Entity of type " + eve.Entry.Entity.GetType().Name + " in state" + eve.Entry.State + " has the following validation errors:"; ;
                    foreach (var ve in eve.ValidationErrors)
                    {
                        errorString += "- Property: " + ve.PropertyName + " Error: " + ve.ErrorMessage;
                    }
                }
            }

            return errorString;
        } 
```

Any help would be appreciated. Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T21:07:19.760

事实证明，除非在绑定上指定了“formattingEnabled”，否则当绑定将不可为空的值推送到对象中的可空属性时会收到异常。

因此，像这样的绑定有效：

```
this.dateDocument.DataBindings.Add(new Binding("Value", this.document, "DocumentDate", true)); 
```

而这不是：

```
this.dateDocument.DataBindings.Add(new Binding("Value", this.document, "DocumentDate")); 
```

我仍然不清楚如何捕获这种类型的错误，因为绑定只是捕获错误并将控件中的值替换为原始值。

# python - Errors are NOT throwing properly?

> ID：15234548
> 
> 赞同：0
> 
> 时间：2013-03-05T21:32:31.607
> 
> 标签：python, exception, visual-studio-2012

Okay, so this is the strangest thing I've seen happen in a pretty long time. So, I fire up vs2012 like I normally do, and start some imports. I have a module I'm working with, and I import it via static import from the root of my module.

```
import os
from foo.bar import bang 
```

I execute these in the interpreter... and all of a sudden, my exceptions don't work.

I type in, `assert 1 == 2`, and nothing happens. I type in `x[1]`, and nothing happens. No x is undefined, no assertionerror, nothing.

Okay, so I restart my interpreter, and just do the assertion statement. It works fine.

Has anyone ever seen anything like this? What could possibly be causing it? (Yes, I know it's the imported module, but seeing as it's quite a bit of code, perhaps a place to start looking before I go diving into the depths?)

[edit]

Running commands in the interactive seem to take a long time, too-- `dir()` took like 3 seconds to come up with a list 8 or so items long.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:36:24.533

这是一种可能性：

```
import sys

def hook(type, value, traceback):
    pass

sys.excepthook = hook
assert 1 == 2 
```

在这种情况下，断言不会打印任何内容。您可以通过查看 if 来验证这一点`sys.excepthook != sys.__excepthook__`。

*注意：以 ipython 为例，这个值是傻瓜。因此，如果您正在对此进行测试，请确保您只使用`python`而不是`ipython`.*

# mysql - 将 MYSQL 转换为 Codeigniter

> ID：15234549
> 
> 赞同：1
> 
> 时间：2013-03-05T21:32:48.873
> 
> 标签：mysql, database, codeigniter, select

我正在尝试将 MYSQL 查询转换为 codeigniter 并且没有真正快速的地方。我正在尝试转换此查询

```
$conn->prepare("SELECT `id`,`song`,`artist`,`album`,`track`,`mix_name`,`date` FROM `podcasts` where mix_number = (SELECT MAX(mix_number) FROM podcasts) order by track asc"); 
```

这是在我的模型中：

```
//$where = '(SELECT MAX(mix_number)from podcasts)';
$this->db->select('id,song,artist,album,track,mix_name,date, link');
//$this->db->where('mix_number', '(SELECT MAX(mix_number)from podcasts)');
$this->db->order_by('track', 'asc');
$query = $this->db->get('podcasts');
return $query->result(); 
```

**我的问题区域在 where 语句中。**当我注释掉 where 语句时，我得到了数据。显然不是我想要的方式。

我这样做是因为我的下一个查询将是

```
("SELECT `id`,`song`,`artist`,`album`,`track`,`mix_name`,`date` FROM `podcasts` where mix_number = **(SELECT MAX(mix_number) FROM podcasts) - 1** order by track asc") 
```

一直到**(SELECT MAX(mix_number) FROM podcasts) - 3**

关于编写 where 语句的正确方法有什么想法吗？谢谢你的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:43:32.320

设置 to 的第三个参数`where()`以`false`防止 CI 更改您传递给第二个参数的字符串，然后您可以执行子查询：

```
return $this->db
    ->select('id,song,artist,album,track,mix_name,date, link')
    ->where('mix_number', '(SELECT MAX(mix_number) from podcasts)', false)
    ->order_by('track', 'asc')
    ->get('podcasts')
    ->result(); 
```

> [https://www.codeigniter.com/userguide2/database/active_record.html](https://www.codeigniter.com/userguide2/database/active_record.html)
> 
> `$this->db->where()`接受可选的第三个参数。如果您将其设置为 FALSE，CodeIgniter 将不会尝试使用反引号保护您的字段或表名。

对我来说，这会产生以下查询：

```
SELECT `id`, `song`, `artist`, `album`, `track`, `mix_name`, `date`, `link`
FROM (`podcasts`)
WHERE mix_number = (SELECT MAX(mix_number) from podcasts) ORDER BY `track` asc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:40:48.303

如果您对使用 CodeIgniter 的 Active Record 语法不太讲究，您可以简单地按原样使用您的查询：

```
$sql = "SELECT `id`,`song`,`artist`,`album`,`track`,`mix_name`,`date` FROM `podcasts` where mix_number = (SELECT MAX(mix_number) FROM podcasts) order by track asc";

$this->db->query($sql); 
```

然后`$query->result()`用来得到你的结果。

# scala - 播放带有附加字段的文件上传表单

> ID：15234550
> 
> 赞同：3
> 
> 时间：2013-03-05T21:32:49.983
> 
> 标签：scala, playframework-2.1

我遇到了包含文件上传和附加输入字段的 Play 2.1.0 表单的问题。我用

```
def uploadTaxonomy() = Action(parse.multipartFormData) {
    implicit request =>
      request.body.file("xml").map { file =>
        val xml = scala.io.Source.fromFile(file.ref.file).mkString
        taxonomyForm.bindFromRequest().fold(
          formWithErrors => BadRequest(views.html.index(formWithErrors)),
          result => {
            Taxonomies.create(result._1, xml)
            Redirect(routes.Application.index())
          }
        )
      }.getOrElse {
        Redirect(routes.Application.index())
      }
  } 
```

我的表格是这样的：

```
val taxonomyForm = Form(
  tuple(
    "label" -> text,
    "xml" -> text
  )
) 
```

问题是`bindFromRequest()`总是失败（导致错误的请求返回给客户端）。

有人知道问题可能出在哪里吗？

*注意：*我知道[2.1.0](https://groups.google.com/forum/#!searchin/play-framework/multipartFormData/play-framework/eWCfiI-7YFc/pzki9zRyyKUJ)中存在一个错误，当在上传字段中未选择任何文件时会出现该错误；然而，它似乎并不相关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:30:15.623

据我所知，`xml`不应该是表单定义的一部分，因为您直接从请求正文中获取它。

# android - Android - findViewById() - 将参数传递给构造函数

> ID：15234551
> 
> 赞同：1
> 
> 时间：2013-03-05T21:32:52.617
> 
> 标签：android, view, surfaceview

我创建了一个继承自 SurfaceView 的类。我想在调用 findViewById() 时将参数传递给它的构造函数。是否可以？如何？如果没有怎么处理？

```
this.surfaceView = (TubeSurfaceView) findViewById(R.id.surfaceView); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:34:57.357

没有。findViewById 用于已实例化的视图以查找已实例化的子视图。您需要以编程方式创建表面视图（在这种情况下，您不需要调用 findViewById），或者您需要将要通过构造函数传递的任何内容设置为 xml 参数。

# bash - 删除一段文字的最简单方法，n次

> ID：15234554
> 
> 赞同：2
> 
> 时间：2013-03-05T21:33:06.067
> 
> 标签：bash, shell, vi

我有一个大于 4gb 的文件，这对我来说是个坏消息，因为我无法在 notepad++ 中打开文件并使用宏功能来记录和重复一个过程到文件末尾。我想做的是，留下前 20 行文本，然后删除接下来的 80 行，然后重复该过程到文件末尾。

最简单的方法是什么？我正在Linux服务器上查看这些文件，因此运行某种脚本将是最简单的方法，或者也许有人知道在vi中执行此操作的方法？（因此蹩脚的标签）

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T21:37:08.297

`awk`可以很容易地做到这一点：

```
awk '(NR-1)%100 < 20' bigfile.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:41:44.367

我会选择 awk 解决方案，但这里有一种方法可以用 sed 做同样的事情：

```
seq 20 | sed 's/$/~100p/' | sed -nf - bigfile.txt 
```

测试：

```
seq 20 | sed 's/$/~100p/' | sed -nf - <(seq 200) 
```

输出：

```
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120 
```

# ios - 为什么横向视图报告它的中心就好像它是纵向的？

> ID：15234555
> 
> 赞同：2
> 
> 时间：2013-03-05T21:33:12.083
> 
> 标签：ios, uiview, frame, uiinterfaceorientation, bounds

我有一个仅限风景的应用程序。这些视图在 IB 中设计为横向 (568x320)。然而，当我这样做时：

```
NSLog(@"view center: %@", NSStringFromCGPoint(self.view.center)); 
```

我明白了：

```
view center: {160, 284} 
```

这就是中心在肖像模式下的样子。这会导致很多问题，因为我想将事物放置在视图的中心。为什么视图认为它处于纵向模式，以及在视图中居中的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:02:46.553

这里的中心是指框架的中心。请记住，当设备旋转时，框架不会旋转。只有框架内的边界旋转。

因此，如果您正在编写依赖于设备方向的代码，您应该使用边界来获取视图的中心（x，y 坐标），您可以使用以下命令：

self.view.bounds.size.width/2 和 self.view.bounds.size.height/2。

在我的 iPhone5 上，我得到：

*   (160,274) 用于纵向模式下的视图中心。这是有道理的，因为纵向的全视图尺寸为 (320,568)。您在状态栏的 y 轴上损失了 20 个点。
*   (284,150) 用于横向模式下的视图中心。这是有道理的，因为横向的完整视图尺寸为 (568,320)。您在状态栏的 y 轴上损失了 20 个点。

我上面的 xy 参考随着设备旋转。所以 x 总是从左到右， y 总是从上到下

# ios - How to assign UIImageView PlaceHolderImage

> ID：15234556
> 
> 赞同：1
> 
> 时间：2013-03-05T21:33:12.743
> 
> 标签：ios, uiimageview

I am trying to assign a placeholderimage in my `UIImageView` but am getting this error

> No visible @interface for 'UIImage' declares the selector 'placeholderImage:'

This is how I thought I might be able to do it... obviously wrong but anyway this is what the code looks like.

```
firstSpaceImageView.image = [[UIImage imageNamed:@"CA.png"] placeholderImage:[UIImage imageNamed:@"placeholder.png"]]; 
```

any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T22:19:46.523

`-[UIImageView setImageWithURL:placeholderImage:]`是[AFNetworking](https://github.com/AFNetworking/AFNetworking)的一部分。您需要包含它才能获得此方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:19:31.450

`placeholderImage`UIImage（或 UIImageView）上没有调用属性。如果您想制作自己的占位符解决方案，[这个问题](https://www.google.com/url?sa=t&source=web&cd=1&ved=0CC4QFjAA&url=https://stackoverflow.com/questions/5152288/using-a-placeholder-image-before-loading-the-full-image&ei=rW02UcSBEey40QHRt4GYAQ&usg=AFQjCNH0RoJQpoJ8X0zyFiuhEztfSfrzoA)会有所帮助。

PS：即使有这样的属性，setter方法也会`setPlaceholderImage:`比`placeholderImage`

# c++ - Lambda function referenced pointer destroyed detection

> ID：15234560
> 
> 赞同：1
> 
> 时间：2013-03-05T21:33:28.450
> 
> 标签：c++, pointers, lambda, detection

I create a lambda function to run code in a different thread or simply to run it a bit later, but it can happen that an object kept by the lambda function is deleted in the mean time.

How can I detect that and not run the function in that case?

for instance

```
class A
{
public:
    A(){}
    virtual void test(){std::cout << m;}
    int m;
};
int main()
{
    A* a = new A();
    std::function<void ()> function = [=]()->void
    {
        //if( pointer to 'a' still valid )
        {
            a->test();
        }
    };
    delete a;
    //or if( pointer to 'a' still valid )
    function();

    system("pause");
    return 0;
} 
```

or the detection could be done before executing the lambda function too.

An other idea is to have an object "Runnable" keep the lambda function and register it to the one that can be deleted. Then in the destructor I would notify the Runnable and prevent the execution.

Would that be a good way to do it ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:46:00.497

您无法测试指针指向的对象是否已被删除。

如果它已被删除，您的 test() 将只有未定义的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T15:00:32.067

这是一个解决方案：

```
std::shared_ptr<A> a(new A());
std::weak_ptr<A> weak_a(a);
std::function<void ()> function = [weak_a]()->void
{
    if( std::shared_ptr<A> a = weak_a.lock() )
    {
        // to get the A* from a, do a.get()
        // operator-> and *a work however:
        a->test();
    }
};
a.reset(); // instead of delete 
```

的使用`weak_ptr`是可选的——如果您改为将其`shared_ptr`复制到 lambda，则 lambda 的生命周期`a`将延长 lambda 的生命周期。

这确实要求`a`在 lambda 之外使用的代码是`shared_ptr`兼容的。

# java - Unique ArrayList

> ID：15234562
> 
> 赞同：0
> 
> 时间：2013-03-05T21:33:45.177
> 
> 标签：java

I am using an arraylist that contains duplicate copies of object. I can determine the duplicate copies using lastIndexOf method. After determination, I can remove that duplicate item from list. Now, AFAIK, on removal of item from list, the overall structure of the list would get damaged. I mean if I remove item number 5 from list, then at location 5, nothing would be there which would utlimatly lead to traversing problem. I have read the stack overflow similar questions and tried every single one like hashset, for me, they dont work. How can I maintain a unique Arraylist containing string only.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:35:39.620

如果删除第 5 项，位置 5 将不包含“洞”。如果有，列表中的下一项将成为第 5 项。因此，您可以继续从列表中删除项目以实现唯一性。但是如果你想要一个独特的集合，你可以使用一个集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:40:10.790

阅读[文档](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#remove%28int%29)是值得的。

```
public Object remove(int index) 
```

> 移除此列表中指定位置的元素。将任何后续元素向左移动（从它们的索引中减去 1）。

正如迈克所说，如果重复是一个问题，为什么不使用`Set`?

# c++ - 内联函数访问静态？

> ID：15234572
> 
> 赞同：6
> 
> 时间：2013-03-05T21:34:20.840
> 
> 标签：c++, static, inline

[Marshall P. Cline 的 C++ FAQs (2nd Edition) (Paperback) 第 16.4 节，Greg Lomow](https://rads.stackoverflow.com/amzn/click/com/0201309831)说内联函数不能安全地访问静态数据成员，因为可以在初始化静态数据成员之前调用该函数。

我不明白为什么这适用于内联函数，而不仅仅是其他翻译单元中调用另一个翻译单元中的静态数据成员的任何函数？我看不出“内联”在这场灾难中扮演什么角色？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T21:39:46.277

`static`**在执行同一翻译单元**（或多或少的 cpp 文件）中的任何函数之前，变量已完全初始化。如果它们在不同的翻译单元中， 则不能保证它们在`main`被调用之前被初始化。功能是重复的，每个翻译单元都有自己的副本。这意味着与变量不同的翻译单元中的内联函数可能会在正确初始化之前尝试读取/写入该变量，从而导致未定义的行为。（规则很复杂，但我记得是这样的）`main``inline``static`

> § 3.6.2/4 具有静态存储持续时间的非局部变量的动态初始化是否在 main 的第一条语句之前完成是实现定义的。如果初始化延迟到 main 的第一个语句之后的某个时间点，它应该发生在与要初始化的变量在同一翻译单元中定义的任何函数或变量的第一次 odr-use (3.2) 之前。

和

> § 3.2/3 内联函数应在使用 odr 的每个翻译单元中定义。

据我所知，内联函数并不比非内联函数更危险。任何访问不同 TU 中的静态函数的函数都是有风险的，并且由于`inline`恰好将函数放在*每个*TU 中，因此它们中的大多数都不安全。一种解决方法是使用["construct on first use idiom"](https://stackoverflow.com/questions/7325399/can-construct-on-first-use-idiom-fail-under-any-circumstances)。

隐式模板特化很复杂，但为了完整性：

> § 14.7.1/3 [temp.inst] 静态数据成员的初始化（以及任何相关的副作用）不会发生，除非静态数据成员本身以需要定义静态数据成员的方式使用存在。

所以模板类的静态成员总是在使用前被初始化。

以上均受制于 [静态初始化顺序惨败](https://stackoverflow.com/questions/3035422/static-initialization-order-fiasco)），由上述“首次使用 idom 构造”解决。

# php - 如何将表 id 字段连接到另一个表 id 字段？

> ID：15234579
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:34:38.153
> 
> 标签：php, database, database-design, phpmyadmin

我对 PHP 和数据库还很陌生，在创建我需要的数据库时遇到了一些问题。我希望这里有人可以帮助我！可能是一个非常愚蠢的问题......

我要做的是创建一个非常简单的电影库并从 phpmyadmin 中创建表。我还没有开始为此编写任何 PHP 代码，我只是想确保我正确地创建了数据库表。

我正在使用以下字段制作一张表（电影）：ID、TITLE、DIRECTOR、YEAR 和 CATEGORY_ID。

该表应该与另一个类别表有关系。所以第一个表中的 CATEGORY_ID 字段应该连接到存储类别的表。

我对 CATEGORY_ID 字段有疑问。由于第一个 ID 字段设置为主要字段并且自动缩进我不能在 CATEGORY_ID 字段上使用它，所以当我从 phpmyadmin 中添加电影作为测试时，我只会在类别 ID 上获得 ID 编号 0。

只是为了显示我所做的表格布局：

MOVIE TABLE - ID（主键，自动缩进）、TITLE、DIRECTOR、YEAR、CATEGORY_ID
CATEGORY TABLE - CATEGORY_ID、CATEGORY

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:45:10.970

您需要进行更多研究才能获得完整的帮助。我建议你做一些谷歌搜索并阅读这样的文章：

[http://www.sitepoint.com/mysql-foreign-keys-quicker-database-development/](http://www.sitepoint.com/mysql-foreign-keys-quicker-database-development/)

## [编辑]

感谢您花时间编辑您的问题并进行必要的更改：

## 示例数据库模式

**类别表**

```
CATEGORY_ID int auto_increment (11) (primary key)
CATEGORY 
```

**电影表：**

```
ID int auto_increment (Primary Key) 
TITLE, 
DIRECTOR, 
MOVIE_YEAR
CATEGORY_ID int(11) (Foreign Key) 
```

现在你明白我所说的外键是什么意思了；上述架构基于您的问题和示例。我只重命名了年份列。我很小心可能与保留字冲突的字词或名称。我只是把它命名为MOVIE_YEAR。TITLE 字段不是唯一的。没有必要这样做。如果需要，为了防止重复，您可以查询数据库以查找匹配项。但是看到两部电影可能有相同的名字，他们的 id 应该把它们区分开来。

### mysql

您不需要表中的两个自动增量列。首先创建类别表并加载类别的值。Id 列可以是自动增量，也可以不是。如果不是，您必须手动提供 ID。然后创建电影表。你正在做一对多的关系。意思是，一个类别可以匹配电影表中的许多电影。所以有 0 没有错误。该问题将由您的 PHP 脚本解决。该列可能设置为不为空，因此提供了默认值。

### PHP 脚本

在 PHP 中，创建代码以将类别表中的值提取到下拉选择或可点击链接之类的内容中，并将它们传递给隐藏的表单元素。使用 select 可能会更快（参见下面的示例）。添加新电影所需的 select 和其他表单元素将采用一个 html 表单。因此，当您提交表单时，它会将数据添加到电影表中。该数据将携带用户正在插入的 category_id。这将取代您现在拥有的 0。

### 创建选择下拉菜单

如果您将 category_id 列设置为不为空，0 会更快乐。没什么奇怪的。在更新期间，重复相同的过程。请注意，选择将具有特殊格式，如下所示：

```
<?php while($row = mysqli_fetch_assoc($connection, $recordset)){ ?>
    <select name='category_id' id='categories_id'>
        <options value='<?php echo $row['category_id'] ?>'><?php echo $row['category_name'] ?></option>
    </select>
<?php } ?> 
```

这些值应该来自您的数据库并填充选择菜单。这应该让你开始。因此，现在尝试使用您当前拥有的数据库在 PHP 端工作。如果您有 PHP 代码，您可以展示它，以便我们都对其进行调整。

***忘了赞成票和反对票吧，我们不是在竞争。这叫声望。我们似乎有很多。:)***

### 显示记录

显示是棘手的部分。在那里你需要一个加入。符合以下条件的东西：

```
$sql='SELECT * FROM movies LEFT JOIN category ON movies.category_id = category.id';
$recordset_all = mysqli_query($connection, $sql); 
```

像这样的东西会给你所有的电影记录和类别的匹配记录。这样，您就可以拥有适用于所有电影的类别名称。而且由于您似乎没有列名冲突，所以一切都应该没问题。如果只想匹配行，去掉LEFT这个词，这样电影中没有category_id匹配外键的电影就不会被选中。

### 子标题

如果您打算在类别名称的子标题中加载行，您的情况会变得复杂。在这种情况下，您必须进行两次数据库选择并创建一个函数来调用和返回相应的电影。可能有更好的方法。如有必要，我们会在您到达该部分时解决该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:39:29.867

你可能正在寻找`INNER JOIN`

```
SELECT ... FROM table1 t1
INNER JOIN table2 t2 ON t1.key = t2.key
WHERE ... 
```

可以在[此处找到有关表连接的更多信息](http://www.w3schools.com/sql/sql_join_inner.asp)

请记住在您的列名前加上表的别名（在这种情况下，别名是`t1`和`t2`

希望这可以帮助。

编辑：这是一个示例更新和选择查询，您可以使用它来更新 categoryID，然后使用内部连接进行选择

```
UPDATE MovieTable 
SET categoryID = (number here)
WHERE (use unique identifier like ID or Title if it is unique) = (value)

SELECT my.Title FROM MovieTable mt
INNER JOIN CategoryTable ct ON mt.categoryID = ct.categoryID
WHERE ct.categoryID = (value) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:48:36.873

这是一个非常常见的一对多关系数据库设计的示例。注意 CATEGORIES 有一个用于关联 MOVIES 的主键，它使用 FOREIGN KEY 语句。另请注意，TITLE 必须是唯一的（我假设）。

```
create table CATEGORIES (
  ID int not null auto_increment,
  Description varchar(100),
  PRIMARY KEY (ID)
  );
create table MOVIES(
  ID int not null auto_increment,
  TITLE varchar(30),
  DIRECTOR varchar(30),
  YEAR datetime,
  CATEGORY_ID int,
  PRIMARY KEY (ID),
  UNIQUE KEY (TITLE),
  FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORIES(ID)
) 
```

# animation - PyGame 独立背景图片

> ID：15234582
> 
> 赞同：0
> 
> 时间：2013-03-05T21:34:46.813
> 
> 标签：animation, background, pygame, sprite

我有一个问题，希望你们能帮助我。在这场足球比赛中，当我在场上移动球员时，球门不会粘在那个位置上，它们会随着球一起移动。

例子：

[![在此处输入图像描述](../Images/698d16b4259b33883d24e6f7a739f03f.png)](https://i.stack.imgur.com/DM05o.gif)

```
import pygame
import random
import sys, glob
from pygame.locals import *

class Ball(pygame.sprite.Sprite):

    def __init__(self,x,y,image_x):
        self.bottom = 20
        self.image = pygame.image.load("res/images/ball1.png")
        self.rect = self.image.get_rect() 
        self.rect.x = x
        self.rect.y = y
        screen.blit(self.image,(self.rect.x,self.rect.y))
        self.change_x=x
        self.change_y=y

class Field(pygame.sprite.Sprite):

    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        #self.field = pygame.image.load('res/images/field.png').convert()
        #self.field_rect = self.field.get_rect()
        #self.field_rect.x = 0  
        #screen.blit(self.field,(self.field_rect.x,self.field_rect.y))

    def goal_top(self):      
        self.goal_top = pygame.image.load("res/images/goal-top.png")
        screen.blit(self.goal_top,(425,0))

    def goal_bottom(self): 

        self.goal_bottom = pygame.image.load("res/images/goal-btm.png")
        self.goal_bottom_rect = self.goal_bottom.get_rect()
        self.goal_bottom_rect.y = 720

        screen.blit(self.goal_bottom,(425,self.goal_bottom_rect.y ))        

class Player(pygame.sprite.Sprite):

    def __init__(self,x,y,image_x,image_y):
        self.bottom = 20
        self.image = pygame.image.load("res/images/player/boy.png")
        self.rect = self.image.get_rect() 
        self.rect.x = x
        self.rect.y = y
        screen.blit(self.image,(self.rect.x,self.rect.y))
        self.change_x=x
        self.change_y=y

    def changespeed_x(self,x):
        self.change_x = x

    def changespeed_y(self,y):
        self.change_y = y  

class Camera(object):
    def __init__(self, camera_func, width, height):
        self.camera_func = camera_func

        self.state = Rect(0, 0, width, height)

    def apply(self, target):

        try:
            return target.rect.move(self.state.topleft)
        except AttributeError:
            return map(sum, zip(target, self.state.topleft))

    def update(self, target):
        self.state = self.camera_func(self.state, target.rect)

def complex_camera(camera, target_rect):
    l, t, _, _ = target_rect
    _, _, w, h = camera
    l, t, _, _ = -l + HALF_WIDTH, -t+HALF_HEIGHT, w, h

    l = min(0, l)                           # stop scrolling left
    l = max(-(camera.width-WIN_WIDTH), l)   # stop scrolling right
    t = max(-(camera.height-WIN_HEIGHT), t) # stop scrolling bottom
    t = min(0, t)                           # stop scrolling at the top
    return Rect(l, t, w, h)

pygame.init() 

# Set the height and width of the screen 
WIN_WIDTH = 963
WIN_HEIGHT = 760
HALF_WIDTH = int(WIN_WIDTH / 2)
HALF_HEIGHT = int(WIN_HEIGHT / 2)

size=[WIN_WIDTH,WIN_HEIGHT] 
screen=pygame.display.set_mode(size)
#screen=pygame.display.set_mode(size,FULLSCREEN)

pygame.display.set_caption("Soccer") 
clock=pygame.time.Clock() 

x=500
y=280

set_ball_x = 500
set_ball_y = 300
shot = False
type=''
dir_y=0

##INITIAL POSITION OF IMAGES
image_x=0
image_y=0
ball_image_x=0

dir_y=0

   ##CAMERA TRACK
total_level_width = 963 ##BACKGROUND (Field) width
total_level_height = 1200 ##BACKGROUND (Field) height
camera = Camera(complex_camera, total_level_width, total_level_height)
background = pygame.image.load('res/images/field.png').convert()
background_rect = background.get_rect()

while 1:

    clock.tick(20)

    screen.blit(background, camera.apply((0,0)))

    ball = Ball(set_ball_x,set_ball_y,ball_image_x)

    camera.update(ball)

    player = Player(x,y,image_x,image_y)

    field = Field()
    field.goal_top()
    field.goal_bottom()

    if pygame.key.get_pressed()[pygame.K_RIGHT]:
        x=x+6
        pos =+1
        image_x = 0

        if image_y < 90:
            image_y +=30
        else:
            image_y = 0

    if pygame.key.get_pressed()[pygame.K_LEFT]:
        x=x-6
        image_x = 130 

        if image_y < 90:
            image_y +=30
        else:
            image_y = 0

    if pygame.key.get_pressed()[pygame.K_UP]:
        y=y-6

        image_x = 195

        if image_y < 90:
            image_y +=30
        else:
            image_y = 0
    if pygame.key.get_pressed()[pygame.K_DOWN]:
        y=y+6 

        image_x = 70

        if image_y < 90:
            image_y +=30
        else:
            image_y = 0    

    if pygame.sprite.collide_rect(player,ball):
        set_ball_x = player.change_x
        set_ball_y = player.change_y+20

    if pygame.key.get_pressed()[pygame.QUIT]:
            sys.exit()

    if pygame.key.get_pressed()[pygame.K_q]: ## KEY "Q" to EXIT
            sys.exit()

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()  
            sys.exit()

    pygame.display.flip()       
    pygame.display.update() 
```

任何想法为什么会发生这种情况？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T13:44:19.823

在`Camera.apply()`做什么？

这个：

```
l, t, _, _ = target_rect
_, _, w, h = camera 
```

应该：

```
loc = target_rect.topleft
size = camera.size 
```

和

```
l, t, _, _ = -l + HALF_WIDTH, -t+HALF_HEIGHT, w, h 
```

如果你想获得中心坐标？你用

```
loc = target_rect.center 
```

# firefox - 我需要检测 Firefox 19 中哪个是活动的（而不是已安装的）PDF 查看器

> ID：15234589
> 
> 赞同：1
> 
> 时间：2013-03-05T21:35:18.700
> 
> 标签：firefox, pdf, adobe, acrobat

我有一个问题，我需要知道使用 Firefox 19 的客户是否将 Adob​​e PDF 插件设置为浏览器的默认查看器（而不是新的嵌入式查看器）。javascript 可以检测它是否已安装，但这还不够。

到目前为止，我遇到的唯一解决方案是检测 Firefox 19，然后打开一个弹出窗口，警告用户他们*可能*需要手动将 PDF 查看器更改为 Adob​​e。我真的宁愿不必那样做。

有没有人幸运地从 FF19 获得了更详细的 PDF 信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T11:59:08.900

如果我们这样做会怎样：

```
if(document.contentType="text\html" && window.location.href.endsWith(".pdf") > -1)
        return true; // native PDF viewer is opened
else
        return false; 
```

上面的片段是基于这样的假设，即对于 PDF 文件，URL 将始终以 .pdf 结尾。

# verilog - 预处理器能否判断 SystemVerilog 是否已启用？

> ID：15234592
> 
> 赞同：0
> 
> 时间：2013-03-05T21:35:33.380
> 
> 标签：verilog, system-verilog

我希望能够编写这样的代码：

```
`ifdef SYSTEMVERILOG_ENABLED
  .. systemverilog code here.
`else
 .. verilog-2001 equivalent code here.
`endif 
```

但是 SystemVerilog 参考手册似乎没有引用任何此类标准预定义常量。这似乎是一个疏忽——有没有一种简单的方法来做我打算在这里做的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:54:12.660

是的，有编译器指令`begin_keywords "version_specifier"`和`end_keywords`，其中：

```
version_specifier ::=
    1800-2009
  | 1800-2005
  | 1364-2005
  | 1364-2001
  | 1364-2001-noconfig
  | 1364-1995 
```

来自 LRM 的示例：

```
`begin_keywords "1364-2001" // use IEEE Std 1364-2001 Verilog keywords
module m2 (...);
reg [63:0] logic; // OK: "logic" is not a keyword in 1364-2001
...
endmodule
`end_keywords 
```

IEEE 1800-2009 第 22.14 章对此进行了介绍。

就个人而言，我从未使用过这些，所以我不知道这些工具对它们的支持程度。

# linux - 如何更改 Linux shell 脚本中的文件扩展名？

> ID：15234593
> 
> 赞同：4
> 
> 时间：2013-03-05T21:35:35.670
> 
> 标签：linux, shell

我发现了一些在类似情况下执行此操作的示例，但这是我编写的唯一一个除了逐字运行命令之外还可以执行任何操作的 shell 脚本，因此我正在努力将这些示例应用于我自己的情况并需要一些帮助-持有<3

我只是想从 MP4 中批量翻录音频。该脚本有效：

```
for f in *.mp4; 
    ffmpeg -i "$f" -f mp3 -ab 192000 -vn "mp3s/$f.mp3"
done 
```

但是文件都以.mp4.mp3结尾。我怎样才能摆脱 mp4 部分？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T21:38:15.013

如果你使用 bash

```
${f%%.mp4} 
```

将给出不带`.mp4`扩展名的文件名。

尝试像这样使用它：

```
for f in *.mp4; do
    ffmpeg -i "$f" -f mp3 -ab 192000 -vn "mp3s/${f%%.mp4}.mp3"
done 
```

...并且不要忘记`do`给出的示例中的关键字。

## 解释

bash 手册（`man bash`）指出：

> ${参数%word} ${参数%%word}
> 
> 删除匹配的后缀模式。单词被扩展以产生一个模式，就像在路径名扩展中一样。如果模式匹配 parameter 扩展值的尾随部分，则扩展的结果是 parameter 的扩展值，其中最短匹配模式（`%'' case) or the longest matching pattern (the`%%'' 情况）被删除。如果参数是@或*，模式移除操作将依次应用于每个位置参数，扩展是结果列表。如果 parameter 是下标为 @ 或 * 的数组变量，模式移除操作将依次应用于数组的每个成员，展开是结果列表。

这只是您可以对 shell 变量执行的众多字符串操作之一。它们都以**Parameter Expansion**的名字命名。

这也是 bash 手册中给出的部分标签。因此`man bash` `/paramter exp`应该很快带你到那里。`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-07T11:36:26.763

以下命令更改当前目录下所有文件的文件扩展名。

```
find . -depth -name "*.c" -exec sh -c 'dname=$(dirname {}) && fname=$(basename {} .c) && mv {} $dname/$fname.h' ";" 
```

# c++ - 在eclipse中添加c/c++源文件

> ID：15234595
> 
> 赞同：3
> 
> 时间：2013-03-05T21:35:38.697
> 
> 标签：c++, eclipse

我是 Eclipse 新手，在选择源文件夹时遇到问题。我想将 c++ 文件添加到我的 jni 文件夹中，但是当我点击“浏览”时没有文件夹。

![示例屏幕截图](../Images/adf042c53f79e53e7b1ccab09023f8e7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T17:40:18.240

右键单击“jni”文件夹并选择 New -> Source File 并输入文件名，Eclipse 将在该文件夹中创建文件。

# android - OpenGL ES Tracer 不会在我的 Nexus 10 上收集任何数据

> ID：15234599
> 
> 赞同：5
> 
> 时间：2013-03-05T21:35:50.683
> 
> 标签：android, opengl-es

我正在尝试使用 OpenGL ES Tracer，但它只是不收集任何数据。我进入以下屏幕，但跟踪文件保持为空：

![在此处输入图像描述](../Images/9e24a3fecf48ea0c5aaf231824126616.png)

我也使用 Google 的 OpenGLES20Complete 示例应用程序进行了尝试，以排除任何特定于我的应用程序的东西都会导致此问题，但它只是不起作用。

我正在关注[OpenGL ES Tracer 的文档](http://developer.android.com/tools/help/gltracer.html)，除了我使用的是 IntelliJ IDEA 并从那里启动 Monitor 工具。我使用的是带有 Android 4.2 的 Nexus 10，因此它满足最低版本要求。

我现在还设法在不同的设备上尝试了它（Cyanogenmod 10 上的三星 Galaxy i9000），并且 OpenGL 跟踪工作。因此，似乎有一些特定于硬件或 Android 设备上运行的操作系统会禁用或启用跟踪。

我是否需要采取任何进一步的步骤或设置才能完成这项工作？我无法收集任何 OpenGL 跟踪的原因可能是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:14:35.047

我会检查 logcat 中的输出，看看是否有任何可疑的事情发生。否则，您可以从 shell 尝试以下操作：

```
$ adb shell
$ am start --opengl-trace com.app.package/com.app.package.Activity 
```

此时您应该看到您的应用程序已启动，但正在等待来自主机的连接。然后，您可以使用监控工具，并在跟踪连接对话框中，只需使用关键字`system`代替包名称即可连接到正在运行的任何内容。

请注意，您的应用程序必须是可调试的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T14:19:50.693

我相信这可能是 Jelly Bean 4.2.2 的回归。我在我的 Galaxy Nexus 和 Nexus 7 上遇到了同样的问题，然后我使用 fastboot 和库存的 Google ROM 将我的 Galaxy Nexus 降级到 Android 4.1.2 并且跟踪器再次工作。我在这里打开了一个错误报告：[https ://code.google.com/p/android/issues/detail?id=53426](https://code.google.com/p/android/issues/detail?id=53426)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-07-24T11:23:25.337

转到设备上的开发人员设置，然后在启用 OpenGL 跟踪选项上选择 Logcat 或 Systrace。

# python - 我正在用 python 制作龙与地下城风格的游戏，但如果返回我会变得不正确

> ID：15234600
> 
> 赞同：2
> 
> 时间：2013-03-05T21:36:00.117
> 
> 标签：python, class, random, python-2.7

在过去的几天里，我已经弄清楚了如何做大部分这些事情，但这就是我所拥有的全部经验，所以这可能很简单。无论如何，一切都很顺利，直到我试图使一些公式复杂化，或者至少改变他们使用的值。这是我正在使用的。

```
class EnemyStats():
    def Ename(self):
        return #Not sure What i should put in these spots...
    def EBaseDodge(self):
        return 
    def EnemyEvasion(self):
        return 
    def ENickRange(self):
        return 
    def EBaseAttack(self):
        return 
    def EWeaponAttack(self):
        return 
    def EAttackRating(self):
        return 
    def EnemyDefense(self):
        return 
    def EAttackDamage(self):
        return 
    def Damage(self):
        return ((PAttackDamage-EnemyDefense)if (PAttackDamage-EnemyDefense>0) else 0);
    def EDamage(self):
        return ((EAttackDamage-PDefense) if ((EAttackDamage-PDefense)>0) else 0);
    def LightAttackDamage(self):
        return int(LightAttackDamage == (Damage * 0.72));
    def HeavyAttackDamage(self):
        return (Damage * 1.28);
    def LightNicked(self):
        return (LightAttackDamage/2);
    def HeavyNicked(self):
        return (HeavyAttackDamage/2);
    def Nicked(self):
        return (Damage/2)

    def Estats(self):
        Ename = raw_input('Target Enemy Name: ');
        EBaseDodge = int(raw_input('Enter Enemy Dodge: '));
        EnemyEvasion = int(raw_input('Enter Enemy Evasion: '));
        ENickRange = (EBaseDodge + EnemyEvasion);
        EBaseAttack = int(raw_input('Enter Enemy Base Attack: '));
        EWeaponAttack = int(raw_input('Enter Enemy Weapon Attack(If N/A, 0): '));
        EAttackRating = (EBaseAttack + EWeaponAttack);
        EnemyDefense = int(raw_input('Enter Enemy Defense: '));
        EAttackDamage = int(raw_input('Enter Enemy Attack Damage: '));
        Damage = ((PAttackDamage-EnemyDefense)if (PAttackDamage-EnemyDefense>0) else 0);
        EDamage = ((EAttackDamage-PDefense) if ((EAttackDamage-PDefense)>0) else 0);
        LightAttackDamage = (Damage * 0.72);
        HeavyAttackDamage = (Damage * 1.28);
        LightNicked = (LightAttackDamage/2);
        HeavyNicked = (HeavyAttackDamage/2);
        Nicked = (Damage/2) 
```

然后它被this引用。

```
def PLightAttackForm():#light attack
    print 'Light attack!';
    d = dice()
    lightbase = d.LightAttack()
    EE = EnemyStats()
    if lightbase <= EE.EBaseDodge:
        print 'You rolled', lightbase, ', Miss!', 0, 'Damage!'
    elif lightbase > EE.ENickRange:
        print 'You rolled', lightbase, ', Hit!', EE.LightAttackDamage, 'Damage!'
    elif lightbase < EE.ENickRange:
        print 'You rolled', lightbase, ', Nicked!', EE.LightNicked, 'Damage!'
    else:
        print lightbase 
```

一切都很棒，没有错误，但我明白了。

轻攻击！你投了700，小姐！0伤害！#应该是命中和伤害

普通攻击！你投了 278 ，小姐！0伤害！#应该受到打击和伤害

重击！你投了 135 ，小姐！0 伤害！#should be a Nick and damage

我敢肯定这只是我不知道的事情，但如果你能帮助我，那就太棒了！谢谢！

另外，这是我编写的所有代码。可能有一些冗余......：D

```
import random
Name = raw_input("Enter Name: ")
#EName===
#EBaseDodge = int(raw_input("Enter Enemy Dodge: "))
PBaseDodge = int(input('Enter Base Dodge: '))
#EnemyEvasion = int(raw_input("Enter Enemy Evasion: "))
PEvasion = int(input('Enter Evasion: '))
#ENickRange = (EBaseDodge + EnemyEvasion)
PNickRange = (PBaseDodge + PEvasion)
PBaseAttack = int(raw_input("Enter Base Attack: "))
#EBaseAttack===
PWeaponAttack = int(raw_input("Enter Weapon Attack: "))
#EWeaponAttack===
PAttackRating = (PBaseAttack + PWeaponAttack)
#EAttackRating = (EBaseAttack + EWeaponAttack)
#EnemyDefense = int(raw_input("Enter Enemy Defense: "))
PDefense = int(input('Enter Defense: '))
PAttackDamage = int(raw_input("Enter Attack Damage: "))
#EAttackDamage===
#Damage = (PAttackDamage-EnemyDefense)
#EDamage = (EAttackDamage-PDefense)
#LightAttackDamage = (Damage * 0.72)
#HeavyAttackDamage = (Damage * 1.28)
#LightNicked = (LightAttackDamage/2)
#HeavyNicked = (HeavyAttackDamage/2)
#Nicked = Damage/2

class dice():
        def NormalAttack(self):
            return random.randint(1, PAttackRating);
        def LightAttack(self):
            return random.randint(1, (int(PAttackRating*1.25)));
        def HeavyAttack(self):
            return random.randint(1, (int(PAttackRating*0.75)));

#def att():
#   d = dice()
#   base = d.roll()
#   if base <= a:
#       print 'You rolled', base, ', Miss!', 0, 'Damage!'
#   elif base > b:
#       print 'You rolled', base, ', Hit!', Damage, 'Damage!'
#   elif base < b:
#       print 'You rolled', base, ', Nicked!', Nicked, 'Damage!'
#   else:
#       print base

####################NEW CODE#######################################
def Menu():
    print '(1)Attack';
    print '(2)Choose Enemy';
    print '(3)Charge';
    print '(4)Item';

def select():
    choice = input('Enter Choice: ');
    EE = EnemyStats()
    if (choice == 1):
        Attacktype();
    elif (choice == 2):
        EE.Estats();
    elif (choice == 3):
        Charge();
    elif (choice == 4):
        ItemSelection();
    else:
        print 'There are Numbers for a reason Nuub!',;

##############Enemy Stats############

class EnemyStats():
    def Ename(self):
        return 
    def EBaseDodge(self):
        return 
    def EnemyEvasion(self):
        return 
    def ENickRange(self):
        return 
    def EBaseAttack(self):
        return 
    def EWeaponAttack(self):
        return 
    def EAttackRating(self):
        return 
    def EnemyDefense(self):
        return 
    def EAttackDamage(self):
        return 
    def Damage(self):
        return ((PAttackDamage-EnemyDefense)if (PAttackDamage-EnemyDefense>0) else 0);
    def EDamage(self):
        return ((EAttackDamage-PDefense) if ((EAttackDamage-PDefense)>0) else 0);
    def LightAttackDamage(self):
        return int(LightAttackDamage == (Damage * 0.72));
    def HeavyAttackDamage(self):
        return (Damage * 1.28);
    def LightNicked(self):
        return (LightAttackDamage/2);
    def HeavyNicked(self):
        return (HeavyAttackDamage/2);
    def Nicked(self):
        return (Damage/2)

    def Estats(self):
        Ename = raw_input('Target Enemy Name: ');
        EBaseDodge = int(raw_input('Enter Enemy Dodge: '));
        EnemyEvasion = int(raw_input('Enter Enemy Evasion: '));
        ENickRange = (EBaseDodge + EnemyEvasion);
        EBaseAttack = int(raw_input('Enter Enemy Base Attack: '));
        EWeaponAttack = int(raw_input('Enter Enemy Weapon Attack(If N/A, 0): '));
        EAttackRating = (EBaseAttack + EWeaponAttack);
        EnemyDefense = int(raw_input('Enter Enemy Defense: '));
        EAttackDamage = int(raw_input('Enter Enemy Attack Damage: '));
        Damage = ((PAttackDamage-EnemyDefense)if (PAttackDamage-EnemyDefense>0) else 0);
        EDamage = ((EAttackDamage-PDefense) if ((EAttackDamage-PDefense)>0) else 0);
        LightAttackDamage = (Damage * 0.72);
        HeavyAttackDamage = (Damage * 1.28);
        LightNicked = (LightAttackDamage/2);
        HeavyNicked = (HeavyAttackDamage/2);
        Nicked = (Damage/2)

#Attacking
def Attacktype():
    print '(1)LightAttack';
    print '(2)NormalAttack';
    print '(3)HeavyAttack';
    print '(4)Use Dem Magicks';
    print '(5)Menu(<<This is for nuublets)';
    Attchoice = input('Enter Choice: ')
    if (Attchoice == 1):
        PLightAttackForm();
    elif (Attchoice == 2):
        PNormalAttackForm();
    elif (Attchoice == 3):
        PHeavyAttackForm();
    elif (Attchoice == 4):
        MagicMenu();
    elif (Attchoice == 5):
        Menu();
    else:
        print 'You wot M8?';
        Menu();

def PLightAttackForm():#light attack
    print 'Light attack!';
    d = dice()
    lightbase = d.LightAttack()
    EE = EnemyStats()
    if lightbase <= EE.EBaseDodge:
        print 'You rolled', lightbase, ', Miss!', 0, 'Damage!'
    elif lightbase > EE.ENickRange:
        print 'You rolled', lightbase, ', Hit!', EE.LightAttackDamage, 'Damage!'
    elif lightbase < EE.ENickRange:
        print 'You rolled', lightbase, ', Nicked!', EE.LightNicked, 'Damage!'
    else:
        print lightbase

def PNormalAttackForm():#Normal attack
    print 'Normal Attack!';
    d = dice()
    base = d.NormalAttack()
    EE = EnemyStats()
    if base <= EE.EBaseDodge:
        print 'You rolled', base, ', Miss!', 0, 'Damage!'
    elif base > EE.ENickRange:
        print 'You rolled', base, ', Hit!', EE.Damage, 'Damage!'
    elif base < EE.ENickRange:
        print 'You rolled', base, ', Nicked!', EE.Nicked, 'Damage!'
    else:
        print base

def PHeavyAttackForm():#Heavy Attack
    print 'Heavy Attack!';
    d = dice()
    heavybase = d.HeavyAttack()
    EE = EnemyStats()
    if heavybase <= EE.EBaseDodge:
        print 'You rolled', heavybase, ', Miss!', 0, 'Damage!'
    elif heavybase > EE.ENickRange:
        print 'You rolled', heavybase, ', Hit!', EE.HeavyAttackDamage, 'Damage!'
    elif heavybase < EE.ENickRange:
        print 'You rolled', heavybase, ', Nicked!', EE.HeavyNicked, 'Damage!'
    else:
        print heavybase

def MagicMenu():#magic menu()   
    print 'Magic menu!';

##############Enemy Stats############

####################NEW CODE####################################### 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:43:22.500

正如 That1Guy 所说，您没有将参数传递给您的函数。在 python 中，函数也是对象，您可以将它们与其他对象进行比较。所以当你这样做时：

```
if lightbase <= EE.EBaseDodge:
    print 'You rolled', lightbase, ', Miss!', 0, 'Damage!'
elif lightbase > EE.ENickRange:
    print 'You rolled', lightbase, ', Hit!', EE.LightAttackDamage, 'Damage!'
elif lightbase < EE.ENickRange:
    print 'You rolled', lightbase, ', Nicked!', EE.LightNicked, 'Damage!'
else:
    print lightbase 
```

`lightbase <= EE.EBaseDodge`总是评估为真。

您需要在对`EBase...`方法的调用中添加括号。您还需要将返回值添加到方法的声明中。所以让你的函数看起来像（假设你有一个名为 base_dodge 的变量）：

```
 def EBaseDodge(self):
    return base_dodge 
```

并将您的 ifs 更改为：

```
 if lightbase <= EE.EBaseDodge():
    ... 
```

我不确定您为什么首先尝试对所有这些值使用方法。如果方法是属性会更有意义。

尝试删除所有方法`Enemystats`并使变量成为实例变量：

```
class EnemyStats:
    def Estats(self):
        #Keep this method to set all of the stats and add self. before them like this
        self.Ename = raw_input('Target Enemy Name: ');
        self.EBaseDodge = int(raw_input('Enter Enemy Dodge: '));
        self.EnemyEvasion = int(raw_input('Enter Enemy Evasion: '));
        self.ENickRange = (self.EBaseDodge + self.EnemyEvasion);
        .... 
```

将所有变量放在`self.`您的所有变量之前，将它们与您的类的一个实例相关联 ( `EnemyStats`)。

然后创建一个新的 EnemyStats 对象并输入值：

```
EE = EnemyStats()
EE.Estats() # will prompt you for the values 
```

之后，您可以像之前想要的那样引用您的值：

```
if lightbase <= EE.EBaseDodge:
   ... 
```

只是让你知道，这不是最有组织/推荐的做事方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:44:39.593

你从来没有真正调用过你的任何类方法。您只需将您的值与函数对象本身进行比较，这不是您通常会做的事情。例如，您应该这样做：

```
if lightbase <= EE.EBaseDodge(): 
```

（注意括号） - 当然，一旦你这样做，你会得到很多很多错误，因为这段代码还有其他几个问题。

# jquery - 将 Backbone.js 与 jQuery UI Selectable 集成

> ID：15234601
> 
> 赞同：2
> 
> 时间：2013-03-05T21:36:01.600
> 
> 标签：jquery, jquery-ui, backbone.js, jquery-ui-selectable

我正在尝试创建一个将`li`元素作为可选视图的应用程序。该应用程序要求使用单击和拖动界面选择多个元素。因此，我使用 Backbone.js 来跟踪元素状态和视图，以及用于选择 UI 的 jQuery UI Selectable。

目前，我拥有的唯一结构是主 App 视图、`li`元素的模型和视图以及模型的集合。

构建它的最佳方式是什么，以便我的主 App 视图可以跟踪所选元素并与之交互？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T06:10:30.803

这是我很久以前做过的事情的精简版。对于您的需要，它可能过于复杂，但它确实有效。我需要能够以编程方式选择/取消选择项目以及让 jQuery-selectable 处理它，这就是模型具有`Selected`属性的原因。使用这种方法，您可以`model.set({Selected:true})`在 UI 中执行所有操作，并且一切都保持同步。

添加了 jsFiddle 来演示它：http: [//jsfiddle.net/phoenecke/VKRyS/5/](http://jsfiddle.net/phoenecke/VKRyS/5/)

然后在您的 App 视图中，您可以执行以下操作：

```
_.each(collection.where({Selected:true}), function(item){
    // do something with item
}); 
```

希望能帮助到你。

项目视图：

```
var ItemView = Backbone.View.extend({

  tagName: "li",

  initialize: function(options) {
     this.listenTo(this.model, 'change:Selected', this.selectedChanged);
  },

  render: function() {
     this.$el.html(template(this.model));
     // add cid as view's id, so it can be found when jQuery-selectable says selection changed (in ListView below).
     this.$el.attr({
        'id': this.model.cid
     });
     this.selectedChanged();
     return this;
  },

  selectedChanged: function() {
     // respond to model's Selected change event.
     // This way, you can programmatically change it, ie. model.set({Selected:true}).
     // but usually this class is already on the view, 
     // since jQuery selectable adds/removes it. it does not hurt to re-add it,
     // but you could check for the class.
     if(this.model.get('Selected')) {
        this.$el.addClass('ui-selected');
     } else {
        this.$el.removeClass('ui-selected');
     }
  }
}); 
```

列表显示：

```
var ListView = Backbone.View.extend({
    initialize: function(options) {
        this.listenTo(this.collection, 'reset', this.render);
        this._views = {};
    },

    render: function() {
        this.collection.each(function(item) {
            var view = new ItemView({model: item});
            this._views[item.cid] = view;
            this.$el.append(view.render().el);
        }, this);
        this.setupSelectable();
    },

    setupSelectable: function() {
        var thisView = this;
        // Set up JQuery UI Selectable
        this.$el.selectable({
            filter: 'li',
            selected: function(event, ui) {
                var cid = ui.selected.id;
                var view = thisView._views[cid];
                if(view) {
                    // I think I only did this stuff to keep the model's Selected 
                    // attribute in sync with the UI. 
                    // this will trigger a redundant call to 'selectedChanged' in the
                    // ItemView, but it has no negative effect.
                    view.model.set({
                        Selected: true
                    });
                }
            },
            unselected: function(event, ui) {
                var cid = ui.unselected.id;
                var view = thisView._views[cid];
                if(view) {
                    view.model.set({
                        Selected: false
                    });
                }
            }
        });
    }
}); 
```

# session - 由不同域启动时，coldfusion 会话丢失

> ID：15234605
> 
> 赞同：0
> 
> 时间：2013-03-05T21:36:20.993
> 
> 标签：session, coldfusion, dns, session-cookies

我有一个登录页面，它位于一个域上，而应用程序位于另一个域上。

当我使用来自单独域的登录名时，不会为第二个域存储会话变量，即使这是创建它们的域。

需要明确的是，我不是在域之间共享会话

登录域在应用程序域上运行脚本，应用程序在其中创建会话变量。在应用程序域中调用重定向时，不会传输此变量。

如果我从同一个域调用脚本，会话将按预期存储。有趣的是，直到今天这一切都很好。某些 cf 设置可能已更改。

我注意到正在传递 CFID 和 CFTOKEN，是否有可能使用来自引用网站的 CFID 和 CFTOKEN 编写会话？

如果是这样，我该如何防止呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:50:17.947

您可以通过在 Application.cfc 中设置来覆盖默认会话 cookie 行为`this.setclientcookies = false`，并在 Application.cfc 中发出您的 cfcookie`onSessionStart()`

例如

```
<cfcomponent>
  <cfset this.sessionmanagement = true>
  <cfset this.setclientcookies = false>
  <cffunction name="onSessionStart">
      <cfcookie name="CFID" value="#session.cfid#" domain=".subdomain.domain.com">
      <cfcookie name="CFTOKEN" value="#session.cftoken#" domain=".subdomain.domain.com">
  </cffunction>
<cfcomponent> 
```

当您使用它时，最好将该`httpOnly`属性也设置为 true。

# java - 获取表示时间的字符串的简单方法，以毫秒为单位给出浮点数

> ID：15234610
> 
> 赞同：0
> 
> 时间：2013-03-05T21:36:32.860
> 
> 标签：java

给定浮点 x = 1500，是否有一个内置对象可以返回字符串“00:00:01:30”在我的情况下，浮点表示经过的毫秒数，我想打印它的字符串版本。

```
System.out.println(????.Stringvalue(x));  //for example 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:40:04.573

我怀疑是否有一个内置方法可以为您执行此操作，但是您自己使用除法和`%`模运算符的组合应该相当简单。

在此示例中，您知道 1500 / 1000 = 1 秒。1500 % 1000 会给你 500，或者考虑到 1 秒后的剩余毫秒数。如果您以较大的毫秒数开始，这可以重复扩展。

但是，我不确定为什么将 500 毫秒写为“30”。通常，几秒后会是毫秒，所以它看起来像“00:00:01:500”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:39:07.527

没有这样的内置对象来表示*任何*类型的持续时间，所以没有。滚动你自己的相当简单，或者[像往常一样，只需使用 Joda Time。](http://joda-time.sourceforge.net/)

```
long x = 1500; // Don't use floats to store milliseconds.
Duration d = new Duration(x);
String formatted = String.format("%02d:%02d:%02d.%02d",
    d.getStandardHours(),
    d.getStandardMinutes(),
    d.getStandardSeconds(),
    d.getMillis() % 1000);
System.out.println(formatted); // 00:00:01.500 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:44:33.217

你去吧，效率极低，而且完全矫枉过正，但是嘿嘿：

```
DateFormat df = new SimpleDateFormat("HH:mm:ss.SSS");
df.setTimeZone(TimeZone.getTimeZone("GMT"));
System.out.println(df.format(new Date((long) x))); 
```

注意：您的毫秒被截断，而不是四舍五入到最接近的毫。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:45:38.530

有**一种**方法可以根据需要格式化您的值。但是，您需要将 FLOAT 转换为 LONG。为什么还要使用浮点数？

您可以使用[org.apache.commons.lang3.time.DurationFormatUtils](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/time/DurationFormatUtils.html)。

```
DurationFormatUtils.formatDurationHMS(longValue); 
```

将返回标准 ISO8601 格式。“00:00:01:500”

请参阅[标准 ISO8601 格式](http://en.wikipedia.org/wiki/ISO_8601)。

# c# - 需要一个 ASP MVC 数据库专家来正确初始化关系

> ID：15234611
> 
> 赞同：0
> 
> 时间：2013-03-05T21:36:34.140
> 
> 标签：c#, sql, asp.net-mvc-4

我在客户和地址之间建立了一对一的关系。根据我的理解，我必须修改我拥有的`OnModelCreating`方法。现在我已经准备好尝试我的应用程序了，但是我需要正确初始化我的数据库；但我遇到了一个错误。

主要计划是先创建一个客户，然后再创建一个与他们关联的地址。

这是我的上下文类：

```
public class VolumeV2Context : DbContext
{
    public DbSet<GiftCard> GiftCards { get; set; }
    public DbSet<Clients> Clients { get; set; }
    public DbSet<Address> Address { get; set; }              

         // use if you need to drop the database
         static VolumeV2Context(){

     // use if need to reset the models
     // Database.SetInitializer(new DropCreateDatabaseIfModelChanges<VolumeV2Context>());

     // use to reset whole database tables
      Database.SetInitializer(new DropCreateDatabaseAlways<VolumeV2Context>());

    }

    protected override void OnModelCreating(System.Data.Entity.DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Clients>()
            .HasOptional(j => j.Address)
            .WithOptionalDependent()
            .WillCascadeOnDelete(true);

        modelBuilder.Entity<Address>()
            .HasRequired(j => j.client)
            .WithRequiredDependent()
            .WillCascadeOnDelete(true) ;                           

        base.OnModelCreating(modelBuilder);
    }
} 
```

**楷模**

```
public class Address
{
    [Required]
    public int Id { get; set; }

    [DataType(DataType.Text)]
    [Display(Name = "Street Address")]
    public string StreetAddress { get; set; }

    [DataType(DataType.Text)]
    [Display(Name = "Postal Code")]
    public string PostalCode { get; set; }

    [DataType(DataType.Text)]
    public string City {get; set; }

    [DataType(DataType.Text)]
    public string Province {get; set;}

    public virtual Clients client { get; set; }

}
public class Clients
{
    [Required]
    public long Id { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "First Name")]
    public string FirstName { get; set; }

    [Required]
    [DataType(DataType.Text)]
    [Display(Name = "Last Name")]
    public string LastName { get; set; }

    [Required]
    [DataType(DataType.PhoneNumber)]
    [Display(Name = "Phone ")]
    public string PhoneNumber { get; set; }

    public virtual Address Address {get; set;}

    [Display(Name = "Email List")]
    public Boolean EmailList { get; set; }

    [DataType(DataType.EmailAddress)]
    [Display(Name = "E-mail")]
    public string Email { get; set; }

    [DataType(DataType.Text)]
    [Display(Name = "Hair Type")]
    public string HairType { get; set; }        

   [DataType(DataType.MultilineText)]
    public string Description { get; set; }
} 
```

在我第一次调用数据库时，它在主索引方法中

```
return View(db.Clients.Take(25).ToList()); 
```

它返回一个错误说：

> *在表“地址”上引入 FOREIGN KEY 约束“FK_dbo.Addresses_dbo.Clients_client_Id”可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。无法创建约束。请参阅以前的错误。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:51:26.637

问题是您有双向级联删除。换句话说，删除客户将删除一个地址，该地址将删除一个将删除地址的客户......你明白了。

仅查看您的数据模型，如果客户的地址被删除（人们一直在移动:-)），那么不删除客户是否*更有*意义。或者是否有理由删除地址也应该消灭客户端（毕竟，您的数据模型确实说地址是可选的......）

如果您注释掉这些行：

```
 modelBuilder.Entity<Address>()
    .HasRequired(j => j.client)
    .WithRequiredDependent()
    .WillCascadeOnDelete(true) ; 
```

，或将 WillCascadeOnDelete 设为 false，是否有效？

另一种选择是完全关闭级联删除约定......

```
 modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>(); 
```

但我不认为这就是你想要在这里做的......

# jquery - Chrome jQuery 图像请求状态“待定”

> ID：15234614
> 
> 赞同：6
> 
> 时间：2013-03-05T21:36:48.887
> 
> 标签：jquery, google-chrome

我以前从未遇到过这样的事情，所以我希望其他人有并且可以向我解释。

我正在一个包含一些 Adsense 横幅的网站上工作。为了防止它们出现在我的本地主机或我的任何测试帐户上，我创建了一些服务器端代码来生成并提供具有 CSS 文件背景图像的替代 div。这是针对 Adsense 的 Labnol.org 响应式设计代码的破解。

无论如何，我在那里有一对这样的行（带有 ID 的 div 是一个 ASP.net 控件）：

```
sampleImg = $("<div></div>").addClass("sample-ad-320-x-50");
$("#ctl00_Page_Footer_Top_Leaderboard_Sample").append(sampleImg) 
```

在我的 CSS 中，我有：

```
div.sample-ad-320-x-50 {width:  320px;  height:  50px;  background:  URL(../common-images/banner-ad-320-x-50.gif) center center no-repeat #C0FF00;} 
```

子 div 本身会加载，但我在 Chrome 的“资源”窗口中看到了这一点：

横幅广告 728-x-90.gif /ss2013/common-images GET（失败）待处理 jquery-1.9.1.min.js:3 脚本 13 B 0 B

## 49 毫秒

我可以在 Chrome 中查看图像本身......但当它加载到 div （或图像标签中，就此而言）时不能。

我知道背景在那里，因为它在 Firefox 中加载良好。我也知道背景是存在的，因为我可以将资源窗口中的链接复制/粘贴到浏览器中并以这种方式查看。

我不知道是什么可能导致这种情况......这是 jQuery 的东西还是 Chrome 的东西？我怀疑这是Chrome的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-10T14:32:48.740

你的css中的url应该有单引号：

```
div.sample-ad-320-x-50 {width:  320px;  height:  50px;  background:  url('../common-images/banner-ad-320-x-50.gif') center center no-repeat #C0FF00;} 
```

# derby - 建立与 Derby 的连接

> ID：15234615
> 
> 赞同：0
> 
> 时间：2013-03-05T21:36:49.520
> 
> 标签：derby

我正在尝试使用下面的代码建立到 Derby 数据库的连接。

```
static {
  try  { 
    Class.forName("org.apache.derby.jdbc.ClientDriver");
  } catch (Exception e) {e.printStackTrace();}
} 
```

但是，当我运行它时，我收到以下错误：

```
java.lang.ClassNotFoundException: org.apache.derby.jdbc.ClientDriver
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method) 
```

我知道它找不到 Derby 驱动程序，并且是类路径错误。但是，我已将所有 Derby .jar 文件复制到我的项目的 /lib 文件夹中，但我不明白缺少什么。帮助任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T14:50:19.903

也许您项目的 lib 文件夹不在类路径中。

该错误表示在类路径中找不到 derbyclient.jar。

# c++ - boost::spirit::karma: 使用 no_delimit 和替代方案

> ID：15234616
> 
> 赞同：1
> 
> 时间：2013-03-05T21:36:50.690
> 
> 标签：c++, boost, boost-spirit, boost-variant, boost-spirit-karma

我正在尝试关闭包含替代运算符 ('|') 的规则的定界，但我收到有关不兼容定界符的编译错误。举个例子，我取了 boost 中的 calc2_ast_dump.cpp 例子，并将 struct dump_ast 中的 ast_node 规则修改为：

```
ast_node %= no_delimit[int_ | binary_node | unary_node]; 
```

但这会产生编译错误：

```
/usr/include/boost/function/function_template.hpp:754:17: note: candidate function not viable: no known conversion
  from 'const
boost::spirit::karma::detail::unused_delimiter<boost::spirit::karma::any_space<boost::spirit::char_encoding::ascii>
  >' to 'const boost::spirit::karma::any_space<boost::spirit::char_encoding::ascii>' for 3rd argument
result_type operator()(BOOST_FUNCTION_PARMS) const 
```

以及 boost/spirit/home/karma/nonterminal/rule.hpp 中的相关评论：

```
// If you are seeing a compilation error here stating that the
// third parameter can't be converted to a karma::reference
// then you are probably trying to use a rule or a grammar with
// an incompatible delimiter type. 
```

在我自己的项目中，我可以毫无问题地执行“no_delimit[a << b]”（使用 karma::space 分隔符）。

我对替代品有什么遗漏吗？为什么 no_delimit 可以使用 '<<' 而不是 '|'？

我使用的是 boost 1.48，所以我需要修复错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:05:41.580

您需要修改规则声明以反映它们没有使用分隔符的事实。

假设您不想要任何定界，无论如何：

```
template <typename OuputIterator>
struct dump_ast
  : karma::grammar<OuputIterator, expression_ast()>
{
    dump_ast() : dump_ast::base_type(ast_node)
    {
        ast_node %= int_ | binary_node | unary_node;
        binary_node %= '(' << ast_node << char_ << ast_node << ')';
        unary_node %= '(' << char_ << ast_node << ')';
    }

    karma::rule<OuputIterator, expression_ast()> ast_node;
    karma::rule<OuputIterator, binary_op()> binary_node;
    karma::rule<OuputIterator, unary_op()> unary_node;
}; 
```

[在http://liveworkspace.org/code/4edZlj$0](http://liveworkspace.org/code/4edZlj%240)上实时查看

# php - Composer 建议的内部包方法

> ID：15234618
> 
> 赞同：6
> 
> 时间：2013-03-05T21:36:55.783
> 
> 标签：php, tdd, domain-driven-design, laravel, composer-php

**先介绍一下背景**

我们公司是一家只有四名开发人员的小型初创公司，正在开始将我们的产品重构为可重用的模块，以简化开发过程，提高生产力，并且在此过程中，我们希望在合适的地方引入单元测试。

与小型初创公司一样，我们不能浪费太多的开发时间，但正如我们所见，这对于我们的中长期业务成功极为重要。

目前，我们有两种终端用户产品。两者都是建立在我们自己内部业务层之上的 Laravel (PHP) 应用程序，主要由 web 服务、restful api 和一个庞大的数据库组成。

该业务层为这些产品提供了大部分数据，但每个产品的使用方式完全不同。我们计划在不久的将来构建其他产品，除了维护和改进这两个几乎完成的产品。

为此，我们打算将这些（以及未来）产品的通用逻辑抽象为可重用和解耦的模块。显而易见的选择似乎是 Composer，即使我们对此知之甚少。

**现在到真正的问题**

我想就如何以测试驱动的方式开发内部包询问其他意见。每个模块应该是一个带有自己的单元测试并需要它的依赖项的 composer 包，还是应该构建一个包含每个模块命名空间的单个包？

为了澄清一点，例如，我们希望有一个 CurlWrapper 模块，这在我们的 InternalWebserviceAPI 模块（以及其他一些模块）上是必需的。

我个人喜欢为每个模块提供完全独立的包并声明对 composer.json 的依赖项的想法，这将在精神上强制解耦，并允许我们有一天将其中一些包作为开源发布。它还可以简化对这些模块的重大更改，因为我们可以将它的版本冻结在需要更新的依赖项上。

虽然，我也认为这种分离可能会增加很多复杂性，并且可能更难以维护和测试，因为每个模块都需要独立成为一个项目，而我们没有足够的人力来跟踪这么多小项目。

Composer 真的是我们问题的理想解决方案吗？如果是这样，哪个会推荐：单个包装或多个包装？

**编辑1：**

我想指出，这些模块中的大多数将是：

*   库（即从 youtube URL 获取 ID 或将日期转换为“x 秒前”）
*   包装器（如可链接的 CURL 包装器）
*   Facades（在我们的多个 Web 服务中，需要其他两种）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:02:22.337

是的，作曲家是要走的路，我建议您使用单个包。

你不知道什么时候需要这些模块。最好创建许多单个包并能够将它们全部（或单个）包含在内，而不是创建大包并且当您需要其中的一些类时需要花费更多时间将一个包分成多个包。

例如，参见 Symfony2 项目。这是全栈 Symfony2 框架所需的大量组件，但您也可以在自己的项目中使用一些组件（就像 Drupal8 正在做的那样）。此外，Symfony2 获得的包越来越多，拥有小包似乎很有用，以至于人们花时间将一些大包分解成碎片。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-11T20:43:54.960

使用单个包的替代方法：为每个子项目使用[单独的 composer.json 文件](http://getcomposer.org/doc/05-repositories.md#includes)。

这样做的好处是让您可以将所有库保存在同一个存储库中。在重构代码时，您还可以按子库对自动加载和依赖项进行分区。

如果您想将库拆分为自己的版本化包，您可以进行最后一步并将其签入自己的存储库。

# android - 如何从 keytool 命令获取指纹？

> ID：15234622
> 
> 赞同：0
> 
> 时间：2013-03-05T21:37:11.943
> 
> 标签：android, api, google-maps, keytool

我无法让 keytool 命令正常工作。

```
C:\Users\Psiu>$keytool - list - alias androiddebugkey - keystore C:\Users\Psiu\.android\debug.keystore 
-storepass android -keypass android 
```

当我运行命令时，我收到以下消息。

'$keytool' 不是内部或外部命令、可运行程序或批处理文件。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-21T12:53:17.863

这些是对我有用的命令提示符的步骤：

> cd C:\Program Files\Java\jdk1.8.0_05\bin keytool -list -alias androiddebugkey -keystore C:\Users\ {用户名}.android\debug.keystore -storepass android -keypass android

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:40:30.927

删除只是 linux 命令提示符一部分的 $

编辑：keytool -list -alias androiddebugkey -keystore C:\Users\Psiu.android\debug.keystore -storepass android -keypass android

# windows - WMI 类的“内存速度，以纳秒为单位”是什么意思？

> ID：15234630
> 
> 赞同：0
> 
> 时间：2013-03-05T21:37:39.803
> 
> 标签：windows, winapi, wmi

因此，出于某种原因，我正在翻阅 WMI 类文档，试图弄清一些事情的含义。

到目前为止，我发现的最令人困惑的事情之一是[CIM_PhysicalMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387968(v=vs.85).aspx)。它具有属性“速度”，它表示：

> 物理内存的速度，以纳秒为单位。

这意味着什么？你会如何衡量这个？

# mysql - 将旧文本数据库转换为 SQL

> ID：15234632
> 
> 赞同：0
> 
> 时间：2013-03-05T21:37:53.617
> 
> 标签：mysql, sql, database, text-processing, legacy-database

在我的办公室，我们有一个遗留的会计系统，它将所有数据存储在具有固定宽度记录的纯文本文件（TXT 扩展名）中。每个数据文件都被命名为例如 FILESALE.TXT。我的目标是将这些数据带入我们的 MySQL 服务器，以供许多其他无法与旧版软件交互的程序只读使用。每个文件本质上是一个表。

我总共需要访问大约 20 个文件，大约 1gb 的总数据。每行可能有 350-400 个字符宽并且有 30-40 列。拉入数据后，没有一个 MySQL 表比 100mb 大得多。

遗留会计系统可以修改文本文件中的任何行，删除旧行（它有一个已删除的记录标记——0x7F），并随时添加新行。

几年来，我每 5 分钟运行一次 cron 作业：

1.  检查每个数据文件的最后修改时间。
2.  如果文件没有被修改，跳过它。否则：
3.  解析数据文件，清理所有问题（仅非常简单的检查），然后输出我需要的列的制表符分隔文件（我只是忽略了一些列）。
4.  截断表并将新数据导入我们的 MySQL 服务器，如下所示：

    ```
    START TRANSACTION;
    TRUNCATE legacy_sales;
    LOAD DATA INFILE '/tmp/filesale.data' INTO TABLE legacy_sales;
    COMMIT; 
    ```

cron 脚本并行运行每个文件检查和解析，因此整个更新过程并不需要很长时间。最大的表（不经常更改）需要大约 30 秒来更新，但大多数表需要不到 5 秒的时间。

这一直工作正常，但存在一些问题。我猜它会混淆数据库缓存，所以每次我必须 TRUNCATE 和 LOAD 一个表时，其他使用 MySQL 数据库的程序一开始很慢。此外，当我切换到并行运行更新时，数据库可能会在几秒钟内处于稍微不一致的状态。

这整个过程似乎效率低下！有没有更好的方法来解决这个问题？关于可能值得研究的优化或程序的任何想法？遇到类似情况的人有什么巧妙的技巧吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:01:39.477

几个想法：

*   如果文本文件中的行具有修改时间戳，您可以更新脚本以跟踪其运行时间，然后仅处理自上次运行以来已修改的记录。

*   如果文本文件中的行有一个可以作为主键的字段，您可以为每一行维护一个指纹缓存，由该 id 键控。使用它来检测行何时更改，并跳过未更改的行。即，在读取文本文件的循环中，计算整行的 SHA1（或其他）哈希，然后将其与缓存中的哈希进行比较。如果它们匹配，则该行没有改变，所以跳过它。否则，更新/插入 MySQL 记录并将新的哈希值存储在缓存中。缓存可以是 GDBM 文件、memcached 服务器、MySQL 表中的指纹字段等等。这将使未更改的行在 MySQL 上保持不变（因此仍被缓存）。

*   在事务中执行更新以避免不一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:47:51.863

我想到了两件事，我不会详细说明，但请随时提出问题：

1.  一种将文件处理卸载到应用程序服务器然后只填充 mySQL 表的服务，您甚至可以通过检查重复记录而不是截断整个表来构建智能。

2.  将处理卸载到另一个 mysql 服务器并复制/传输它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T03:49:59.770

我同意亚历克斯的建议。如果可以的话，只更新修改过的字段，并使用分组的事务和多个插入进行批量更新。事务的另一个好处是更新速度更快

如果您担心停机时间，请不要截断表，而是插入新表。然后重命名它。

为了提高性能，请确保您对字段进行了正确的索引。

查看数据库特定的性能提示，例如 _delayed_inserts in mysql 提高性能 _ 可以优化缓存 _ 即使您没有唯一的行，您可能（或可能不）能够 md5 行

# mysql - Mysql Event error out 用于创建常规日志

> ID：15234636
> 
> 赞同：0
> 
> 时间：2013-03-05T21:38:11.817
> 
> 标签：mysql, mysql-event

我有这个活动

```
CREATE DEFINER=`frontend`@`%` EVENT `general_log_event` 
ON SCHEDULE EVERY 5 MINUTE STARTS '2013-03-05 16:08:54' DO BEGIN

    SET @query = CONCAT("
    SELECT * INTO OUTFILE '/Users/Admin/logs/log_", 
    DATE_FORMAT(NOW(),"%M-%d-%y_%h-%m-%s"), ".csv'",
    " 
    FIELDS TERMINATED BY ','
    ENCLOSED BY '\"\'",
    "LINES TERMINATED BY '\\n\'",
    "FROM mysql.general_log;");
    PREPARE statement FROM @query;
    EXECUTE statement; 
END 
```

但每次运行它都会给我这个错误

`[ERROR] Event Scheduler: [root@%][ge.general_log] File '/Users/Admin/logs/log_03-05-13_04-03-54.csv' already exists`

每次都是相同的确切错误。它不应该具有每次都应该更改的相同文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T17:20:24.723

用于`FLOOR(1052 + RAND() * 3564)`创建随机值，它似乎正在工作。这是最后一块。

```
SET @query = CONCAT("
SELECT SQL_NO_CACHE * INTO OUTFILE '/Users/Admin/logs/General_Log/log_", 
DATE_FORMAT(NOW(),"%M-%d-%y_%h-%m-%s_"), FLOOR(1052 + RAND() * 3564), ".csv'",
" 
FIELDS TERMINATED BY ','
ENCLOSED BY '\"\'",
"LINES TERMINATED BY '\\n\'",
"FROM mysql.general_log;");
PREPARE statement FROM @query;
EXECUTE statement;

SELECT @query; 
```

# scheme - （方案）查找列表中两个单词之间的距离？

> ID：15234639
> 
> 赞同：1
> 
> 时间：2013-03-05T21:38:16.747
> 
> 标签：scheme

好的，所以我正在尝试编写一个函数来查找列表中两个元素 s 和 t 之间的距离。

例如，如果 s = bob 且 t = Pizza：

```
(d 'bob 'pizza '(bob blah blah pizza)) 
```

它会返回：3

这就是我到目前为止所拥有的。

```
(define dist
 (lambda (s t line)
  (cond
   [(equal? s (car line))
     [(equal? t (car (cdr line)))
        1]]
   [else (add1 (dist s t (cdr line)))]))) 
```

由于某种原因，它不起作用。帮助？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:59:24.013

问题中建议的代码不起作用，它只是检查两个元素在列表中是否连续。让我们尝试一种完全不同的方法 - 将问题拆分为更小的子问题，首先定义一个返回列表中元素索引的过程，从零开始计算索引：

```
(define (index-of elt lst)
  <???>) ; ToDo 
```

有了上述过程，并假设`s`和`t`都出现在列表中并`t`出现在 之后`s`，很容易找到问题的解决方案：

```
(define dist
  (lambda (s t line)
    (- (index-of t line)
       (index-of s line)))) 
```

例如：

```
(dist 'bob 'pizza '(bob blah blah pizza))
=> 3 
```

为了获得额外的功劳，请考虑其中一个或两个元素都不存在于列表中的情况（因此`index-of`应该返回一个表明这一点的值，例如`#f`），或者`s`出现`t`在列表中之后的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:52:18.537

当您在最后一步中使用（cdr 行）时，即使 bob 是第一个元素，您也会扔掉 bob。

您需要处理 3 个甚至 4 个案例。其中 s 和 t 匹配前两个元素，你做得很好。在哪里 s 匹配，而 t 您不需要使用 line 将 1 添加到递归调用中，并删除了第二个元素。像 (cons (car line) (cdr (cdr line))) 之类的东西。如果 s 不匹配，则需要删除 line 的 car 并重试。除非您确定 s 和 t 都会发生，并且您需要一个终止条件来处理超出范围的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:56:12.730

这是一个每次遍历列表以查找“s”和“t”的解决方案。当两者都被看到时，返回结果；否则，继续寻找：

```
(define (dist s t line)
  (let looking ((l line) (n 0) (i #f))
    (and (not (null? l))
         (let ((item (car l)))
           (if (or (equal? item s)
                   (equal? item t))
               (if (not i)
                   (looking (cdr l) (+ n 1) n) ; found first, continue
                   (- n i))                    ; found second, done
               (looking (cdr l) (+ n 1) i)))))); continue looking 
```

# idtabs - idTabs（在页面之间链接到特定选项卡）

> ID：15234641
> 
> 赞同：0
> 
> 时间：2013-03-05T21:38:32.750
> 
> 标签：idtabs

基本上，我的侧边栏位于我网站的每个页面上。单击另一页上的时，如何将其链接到用户所需的 idTab。请注意，它们是 2 个单独的页面。

我目前正在使用 Sean Catchpole idTabs 3.0 beta 这里的链接：[http ://www.sunsean.com/idTabs/](http://www.sunsean.com/idTabs/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T18:04:18.213

攻击它的一种方法是向发送页面中的链接添加一个 url 变量（即 ?tabLink="software"），其中名称与接收页面上的选项卡 url 的 id 匹配（即`<a href="#sw" id="software">`）。

在接收页面上，获取查询字符串。此函数运行良好（代码来自[How can I get query string values in JavaScript?](https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values/901144#901144)）：

```
(function($) {
    $.QueryString = (function(a) {
        if (a == "") return {};
            var b = {};
            for (var i = 0; i < a.length; ++i) {
                var p=a[i].split('=');
                if (p.length != 2) continue;
                    b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
                }
                return b;
    })(window.location.search.substr(1).split('&'))
})(jQuery); 
```

然后像这样使用它：

```
$("#" + $.QueryString["tabLink"]).click(); 
```

# laravel - Laravel 4：更新用户

> ID：15234650
> 
> 赞同：1
> 
> 时间：2013-03-05T21:39:01.050
> 
> 标签：laravel, laravel-4

我正在尝试更新从 Laravel 4 中的数据库中提取的用户的密码。这是我所拥有的：

```
$user = User::where('username', $username)->get();
if (!empty($user)) {
    $user->password = Hash::make($password);
    $user->save();
} 
```

但是 Laravel 告诉我这`save`是一种未知的方法。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-03T03:04:00.353

`get`返回一个用户数组。您需要使用`first`来获取单个用户对象，该对象将允许您调整密码并保存记录。

```
if ($user = User::where('username', $username)->first())
{
    $user->password = Hash::make($password);

    $user->save();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T11:26:05.360

您确定`$user`其中实际上有一个“用户”吗？

它不会是“空的”——它将是 BOOL `false`。尝试`var_dump($user)`并确认返回的东西？

尝试这个：

```
$user = User::where('username', $username)->get();
var_dump($user);
if ($user) {
    $user->password = Hash::make($password);
    $user->save();
} 
```

# javascript - JPG 与 Javascript 的连接

> ID：15234654
> 
> 赞同：0
> 
> 时间：2013-03-05T21:39:18.680
> 
> 标签：javascript, image, jpeg, concatenation

这是一个远射，但也许这里有人是超级天才。

我想在一个网格中组合 4 个 jpg

```
1 2
3 4 
```

我想做这个客户端，没有 SVG（因为 IE 崩溃）。

我正在研究操纵 jpg 文件中的代码以生成单个新图像。我会将它们作为所有相同大小的 jpg 文件，如有必要，我可以将它们输出为另一种格式（如位图）。我也愿意接受使用任何特殊 IE “功能”（如 VML）的解决方案。IE8是目标受众。

我意识到我可以用 SVG 做到这一点。我意识到我可以在服务器端做这个。我意识到我可以将它们放在一起。我需要来自 4 个原件的单个图像，因为字符串很好（甚至更可取），因为我可以对其进行 base64 编码并将其放入图像元素中。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:23:08.310

我很确定您唯一的选择（在客户端上）实际上是基于 Flash 的画布库，例如[FX Canvas](https://code.google.com/p/fxcanvas/)。它们为您提供了完整的标准画布方法（例如您最需要的 toDataURL）... 通常我不提倡使用 Flash，但是使用模拟画布的库可以在您的客户决定升级时轻松迁移您的代码他们的浏览器设置。

# hadoop - 使用 Oozie 组合输出文件部分

> ID：15234655
> 
> 赞同：3
> 
> 时间：2013-03-05T21:39:21.270
> 
> 标签：hadoop, oozie

是否可以使用 Oozie 将 MapReduce 作业的输出连接到单个文件中？可以说我有输出......

```
part-r-00000
part-r-00001
part-r-00002 
```

而我只想...

```
output.csv 
```

我知道我可以将它们作为单个文件拉下来`hadoop fs -getmerge`，但我很好奇它是否可以使用工作流应用程序和 HDFS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:04:59.803

我能想到的两个简单的选择：

1.  修改产生此输出的作业以使用单个减速器
2.  使用身份映射器、身份归约器和单个归约器运行 map-reduce 操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-15T12:42:43.307

您可能可以使用 pig 或 Java 来调用

[http://hadoop.apache.org/docs/current/api/org/apache/hadoop/fs/FileSystem.html#concat-org.apache.hadoop.fs.Path-org.apache.hadoop.fs.Path：一个-](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/fs/FileSystem.html#concat-org.apache.hadoop.fs.Path-org.apache.hadoop.fs.Path:A-)

或者也许将它添加到您自己的 Oozie 的 fs-action 分支中。

或者，使用 webhdfs： [http](http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/WebHDFS.html#Concat_Files) ://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/WebHDFS.html#Concat_Files 。

您可以将该 curl 调用包装在 shell 或 ssh 操作中。

# java - 从对象类访问二维数组。

> ID：15234657
> 
> 赞同：0
> 
> 时间：2013-03-05T21:39:28.723
> 
> 标签：java, arrays, class

在 Java 中，我有一个二维对象数组，但我无法在对象的类方法中访问这些对象数组中的任何一个。我应该怎么办？这是我的课：

```
class GoPiece
{
    final int boardSize = 19;
    final int empty = 0;
    final int black = 1;
    final int white = 2;
    int pieceType = empty;
    int leftRight;
    int downUp;
    int turnPlayed;
    boolean legal;
    // GoPiece's Constructor with 3 parameters.
    GoPiece(int blackOrWhite, int horizontalCoordinate, int verticalCoordinate)
    {
        pieceType = blackOrWhite;
        leftRight = horizontalCoordinate;
        downUp = verticalCoordinate;
        if ((true));
    }
    // GoPiece's Constructor with 2 parameters.
    GoPiece(int horizontalCoordinate, int verticalCoordinate)
    {
        pieceType = empty;
        leftRight = horizontalCoordinate;
        downUp = verticalCoordinate;
    }
    // GoPiece's Constructor with no parameters.
    GoPiece()
    {
        leftRight = 0;
        downUp = 0;
    }
    // Initialize an empty Go board full of GoPieces.
    GoPiece[][] InitializeBoard()
    {        
        GoPiece[][] intersection = new GoPiece[boardSize][boardSize];
        for(int horizontal = 0; horizontal < boardSize; horizontal++)
        {
            for(int vertical = 0; vertical < boardSize; vertical++)
            {
                intersection[horizontal][vertical] = new GoPiece(horizontal,vertical);
            }
        }
        return intersection;
    }

    // Make a piece a certain type: empty, black, or white.
    public void SetType(int newType)
    {
        pieceType = newType;
    }

    public int GetType()
    {
        return pieceType;
    }

    public void CheckKill()
    {
        int foobar = this.GetType();
    }
} 
```

然后，我可以在程序的另一部分中使用 InitializeBoard() 来创建 GoPieces 的二维数组......这可行，但是除了我在 GoPiece 类的成员函数中引用的部分之外，我如何访问所有这些部分? 我尝试将整个数组传递给 GoPieces 函数之一，但这似乎不起作用。

围棋是中国古代棋盘游戏。上面的 CheckKill() 方法是我尝试访问数组的不同部分但失败的地方。在这里，我有一些工作虚拟代码。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:41:44.103

您需要创建一个单独的类来表示棋盘本身（包括棋子的当前位置）。创建棋盘、测试击杀等的逻辑属于棋盘，而不是单个棋子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:49:07.687

你的意思是你想用数组调用一个方法，比如`InitializeBoard.GetType();`Where InitializeBoard is a 2 Dimensional Array？

你不能那样做。您必须指定要退出 InitializeBoard 的 GoPiece。示例：`InitializeBoard[0][0].GetType();`如果必须调用所有方法，则可以使用 for 循环单独调用每个方法。

# powershell - powershell cmdlet：位置与管道是否相互对抗？

> ID：15234662
> 
> 赞同：1
> 
> 时间：2013-03-05T21:39:35.067
> 
> 标签：powershell, cmdlets, cmdlet

我的 cmdlet 尝试获取 2 个参数，1 个来自管道，1 个来自用户输入，我想知道是否可以通过位置参数来完成，就像这样：

```
Set-login name pw | add-view viewName 
```

add-view 是这样的：

```
[parameter(position=0, ValueFromPipeline = true, ValueFromPipelineByPropertyName = true, Mandatory = true)]
public loginInfo Login {}
[parameter(position=1, Mandatory = true)]
public String Name {}
... 
```

然而，有了上述属性，

```
Set-login name pw | add-view viewName 
```

将返回错误说 cannot convert `String`to `loginInfo`，我必须这样做：

```
$a = Set-login name pw
Add-View $a viewnames 
```

或者

```
$a | Add-View -Name viewnames 
```

似乎位置参数和管道相互矛盾，这是真的吗？解决方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T10:16:38.153

解决方案：将`Name`参数移动到第一个位置以确保传递的字符串将绑定到此参数而不是`Login`参数，您希望将值传递给使用管道的参数。

原因：*内联*参数绑定是在管道处理开始之前发生的一个过程。例如简单的函数，它有点类似于你的 cmdlet：

```
function Test-FooBar {
param (
    [Parameter(ValueFromPipeline)]
    $Foo,
    $Bar
)

process {
    "Foo: $Foo Bar: $Bar"
}
} 
```

取决于位置绑定（在第一个位置从管道中获取值）：

```
Trace-Command -Name ParameterBinding -Expression { 1 | Test-FooBar 2} -PSHost
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Foo-Bar]
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Foo-Bar]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2] to parameter [Foo]
DEBUG: ParameterBinding Information: 0 :         BIND arg [2] to param [Foo] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Foo-Bar]
DEBUG: ParameterBinding Information: 0 :     BIND arg [] to parameter [Bar]
DEBUG: ParameterBinding Information: 0 :         BIND arg [] to param [Bar] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
(...) 
```

'2' 已经绑定到第一个位置，因此您将收到无法绑定管道输入的错误（最终）。

同样，但这次我们确保 '2' 将绑定到第二个参数：

```
Trace-Command -Name ParameterBinding -Expression { 1 | Test-FooBar -Bar 2} -PSHost
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Test-FooBar]
DEBUG: ParameterBinding Information: 0 :     BIND arg [2] to parameter [Bar]
DEBUG: ParameterBinding Information: 0 :         COERCE arg to [System.Object]
DEBUG: ParameterBinding Information: 0 :             Parameter and arg types the same, no coercion is needed.
DEBUG: ParameterBinding Information: 0 :         BIND arg [2] to param [Bar] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Test-FooBar]
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Test-FooBar]
DEBUG: ParameterBinding Information: 0 :     BIND arg [] to parameter [Foo]
DEBUG: ParameterBinding Information: 0 :         BIND arg [] to param [Foo] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : BIND PIPELINE object to parameters: [Test-FooBar]
DEBUG: ParameterBinding Information: 0 :     PIPELINE object TYPE = [System.Int32]
DEBUG: ParameterBinding Information: 0 :     RESTORING pipeline parameter's original values
DEBUG: ParameterBinding Information: 0 :     Parameter [Foo] PIPELINE INPUT ValueFromPipeline NO COERCION
DEBUG: ParameterBinding Information: 0 :     BIND arg [1] to parameter [Foo]
DEBUG: ParameterBinding Information: 0 :         BIND arg [1] to param [Foo] SUCCESSFUL
(...) 
```

正如您现在所看到的 - 一旦 BeginProcessing 被称为 BIND PIPELINE 触发器，并且因为仍然存在接受管道输入的参数 - 它工作正常。

# qml - qml中的自定义单选按钮

> ID：15234664
> 
> 赞同：4
> 
> 时间：2013-03-05T21:39:38.147
> 
> 标签：qml

我想要一个带有 3 个按钮的窗口，但这个按钮应该像单选按钮一样工作！所以这是我的代码：

```
Rectangle {
    id: sideButton
    color:  sideButtonMouseArea.containsMouse ? '#DDDDDD' : '#F4F4F4'
    property string text: 'Button'
    MouseArea {
        id: sideButtonMouseArea
        anchors.fill: parent
        hoverEnabled: true
        onClicked: {
            parent.color = '#4872E8'
            sideButtonLabel.color = '#E2EBFC'
        }
    }

    Text {
        id: sideButtonLabel
        text: sideButton.text
        font.pixelSize: 20
        font.family: 'Tahoma'
        anchors.centerIn: sideButton
        color: '#787878'
    }
} 
```

我使用这个矩形而不是按钮，但是在第二次单击其他按钮时出现问题我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T12:15:16.793

这段代码对我有用：

**MyRadioGroup.qml**

```
import QtQuick 1.0

QtObject {
    property Item selected : null
} 
```

**MyRadioButton.qml**

```
import QtQuick 1.0

Rectangle {
    id: sideButton
    property string text: 'Button'
    property MyRadioGroup radioGroup

    color:  radioGroup.selected === sideButton ? '#E2EBFC' :
            (sideButtonMouseArea.containsMouse ? '#DDDDDD' : '#F4F4F4')
    MouseArea {
        id: sideButtonMouseArea
        anchors.fill: parent
        hoverEnabled: true
        onClicked: sideButton.radioGroup.selected = sideButton
    }

    Text {
        id: sideButtonLabel
        text: sideButton.text
        font.pixelSize: 20
        font.family: 'Tahoma'
        anchors.centerIn: sideButton
        color: radioGroup.selected === sideButton ? '#E2EBFC' : '#787878'
    }
} 
```

**main.qml**

```
import QtQuick 1.0

Rectangle {
    height: 600
    width: 600

    MyRadioGroup {
        id: radioGroup1
    }

    Column {
        anchors.fill: parent

        MyRadioButton {
            anchors { left: parent.left; right: parent.right }
            text: "Button 1"
            radioGroup: radioGroup1
            height: 100
        }

        MyRadioButton {
            anchors { left: parent.left; right: parent.right }
            text: "Button 2"
            radioGroup: radioGroup1
            height: 100
        }

        MyRadioButton {
            anchors { left: parent.left; right: parent.right }
            text: "Button 3"
            radioGroup: radioGroup1
            height: 100
        }

        MyRadioButton {
            anchors { left: parent.left; right: parent.right }
            text: "Button 4"
            radioGroup: radioGroup1
            height: 100
        }
    }   
} 
```

它的作用：我创建了容器`MyRadioGroup`来保存当前选定的项目。然后，我以声明方式将其`selected`属性与`color`我的`MyRadioButton`-s 的属性绑定，因此它将在每次`selected`更改时更新。

* * *

话虽如此，请检查一下，您的组件提供商还没有包含这样的东西——也许您正在重新发明轮子。

# visual-studio-2012 - 路径中的非法字符

> ID：15234665
> 
> 赞同：2
> 
> 时间：2013-03-05T21:39:42.320
> 
> 标签：visual-studio-2012, cmd, nuget

我在 Visual Studio 2012 工具命令行中运行以下命令：

```
"C:\source\Branch-1\.nuget\nuget.exe" install "C:\source\Branch-1\ClassLibs\WCF\ServiceHosts\PINPoller\packages.config" -source ""  -RequireConsent -solutionDir "C:\source\Branch-1\" 
```

我得到了错误：

```
 Illegal characters in path. 
```

这是构建解决方案时出现的错误。我手动将其复制到cmd。

**更新：**

文件夹名称在那里：

> C:\source\Branch-1.nuget ![图片](../Images/5bd632f4e13c5610946e6a04a5ad94c5.png)

当我只运行部分命令时，

```
"C:\source\Branch-1\.nuget\nuget.exe" install "C:\source\Branch-1\ClassLibs\WCF\ServiceHosts\PINPoller\packages.config" -source "" 
```

没关系。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T16:46:03.530

可能是 [http://nuget.codeplex.com/discussions/398910#post925903的答案](http://nuget.codeplex.com/discussions/398910#post925903)

更换

```
-solutionDir "$(SolutionDir) " 
```

和

```
-OutputDirectory "$(SolutionDir)packages\\" 
```

在 NuGet.targets

# php - 在远程服务器上使用 google api php 客户端时出现 HTTP 500（内部服务器错误）

> ID：15234668
> 
> 赞同：1
> 
> 时间：2013-03-05T21:39:52.877
> 
> 标签：php, google-api, google-drive-api, google-api-php-client

我按照[本教程](http://www.html.it/articoli/google-drive-e-php-come-integrarli/)直接从远程服务器使用 php 在 Google Drive 上上传文件：所以我从 Google API 控制台创建新的 API 项目，启用 Drive API 和 Drive SDK 服务，请求 OAuth 客户端 ID 和客户端密码，并编写它们在脚本中，然后将其与[Google APIs Client Library for PHP](https://code.google.com/p/google-api-php-client/)文件夹一起上传到[http://www.MYSERVER.com/script1.php](http://www.MYSERVER.com/script1.php)，以检索 Auth 代码：

```
<?php

require_once 'google-api-php-client/src/Google_Client.php';
require_once 'google-api-php-client/src/contrib/Google_DriveService.php';

$drive = new Google_Client();

$drive->setClientId('XXX'); // HERE I WRITE MY Client ID

$drive->setClientSecret('XXX'); // HERE I WRITE MY Client Secret

$drive->setRedirectUri('urn:ietf:wg:oauth:2.0:oob');

$drive->setScopes(array('https://www.googleapis.com/auth/drive'));

$gdrive = new Google_DriveService($drive);

$url = $drive->createAuthUrl();
$authorizationCode = trim(fgets(STDIN));

$token = $drive->authenticate($authorizationCode);

?> 
```

当我访问[http://www.MYSERVER.com/script1.php](http://www.MYSERVER.com/script1.php)时，它运行良好，因此我允许授权并获得可以在第二个脚本中编写的 Auth 代码。然后我将它上传到[http://www.MYSERVER.com/script2.php](http://www.MYSERVER.com/script2.php)，它看起来像：

```
<?php

require_once 'google-api-php-client/src/Google_Client.php';
require_once 'google-api-php-client/src/contrib/Google_DriveService.php';

$drive = new Google_Client();

$drive->setClientId('X');  // HERE I WRITE MY Client ID
$drive->setClientSecret('X');  // HERE I WRITE MY Client Secret
$drive->setRedirectUri('urn:ietf:wg:oauth:2.0:oob');
$drive->setScopes(array('https://www.googleapis.com/auth/drive'));

$gdrive = new Google_DriveService($drive);

$_GET['code']= 'X/XXX'; // HERE I WRITE AUTH CODE RETRIEVED AFTER RUNNING REMOTE script.php

file_put_contents('token.json', $drive->authenticate());

$drive->setAccessToken(file_get_contents('token.json'));

$doc = new Google_DriveFile();

$doc->setTitle('Test Drive');
$doc->setDescription('Document');
$doc->setMimeType('text/plain');

$content = file_get_contents('drive.txt');

$output = $gdrive->files->insert($doc, array(
      'data' => $content,
      'mimeType' => 'text/plain',
    ));

print_r($output);

?> 
```

好吧，现在我可以在 MYSERVER 的同一个文件夹中上传一个 token.json 空文件（可写）和一个简单的 drive.txt（要上传到我的驱动器中的文件），但是当我最终访问[http://www.MYSERVER.com /script2.php](http://www.MYSERVER.com/script2.php)浏览器每次都会给出**HTTP 500（内部服务器错误）**，并且我的 Google Drive 中没有文件上传：步骤中有错误，或者脚本有问题？请帮我解决这个问题！

**编辑：**

MYSERVER 错误日志充满：

```
PHP Fatal error:  Uncaught exception 'Google_AuthException' with message 'Error fetching OAuth2 access token, message: 'invalid_grant'' in /var/www/vhosts/.../gdrive/google-api-php-client/src/auth/Google_OAuth2.php:113
Stack trace:
#0 /var/www/vhosts/.../gdrive/google-api-php-client/src/Google_Client.php(131): Google_OAuth2->authenticate(Array, NULL)
#1 /var/www/vhosts/.../gdrive/sample2.php(23): Google_Client->authenticate()
#2 {main}
thrown in /var/www/vhosts/.../gdrive/google-api-php-client/src/auth/Google_OAuth2.php on line 113 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:55:07.753

似乎您无法获得新的访问令牌，因为您的旧访问令牌尚未过期，这就是这段代码告诉您的内容：

'Google_AuthException' 带有消息'获取 OAuth2 访问令牌时出错，消息：'invalid_grant'

您必须一次获得访问令牌，将其保存在某处并使用它直到它过期，每次尝试查询某些内容时都无法获得新的访问令牌

要撤销您的第一个访问令牌，请转到[Google API 控制台](https://code.google.com/apis/console/)，您将在**已安装应用程序的客户端 ID下找到它**

此致

# jquery-ui - 在 jQuery UI drop 上向所有客户端广播套接字

> ID：15234674
> 
> 赞同：1
> 
> 时间：2013-03-05T21:40:23.233
> 
> 标签：jquery-ui, socket.io

**问题**

当一个用户使用`drags and drops`一个元素时`jQuery UI`，我想`broadcast`向`drop`其他用户发送一个元素，以便他们可以看到`element`.

**问题**

如何配置脚本以便能够使用 'dropping' 发送元素`socket.broadcast.emit`？

**代码**

客户端（放置设置）

```
$('#dropArea').droppable({

    drop: function(event, ui) {
        var dropped = ui.draggable;
        var droppedOn = $(this);

        $(dropped).detach().css({
            top: 0,
            left: 0
        }).appendTo(droppedOn);

        socket.emit('status', {
          status: 'ToDo', 
          _id: $(this).find('p').data('id') 
        });

    }
}); 
```

**服务器**（一些套接字设置）

```
io.sockets.on('status', function(data) {
    Item.findOne({_id: data._id}, function(err, item) {
      if(err) throw err;
      item.status = data.status;
      item.save();
    });
  }); 
```

**笔记**

“`emit`状态”更新数据库中的元素状态

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T03:52:08.287

您也可以在客户端设置此事件的侦听器，

```
 io.sockets.on('status', function(data) {
   //do the update in client here
  }); 
```

还有一件事是你需要在这里使用`socket.broadcast.emit`。因为 `socket.emit`将向所有客户端广播消息，客户端正在广播消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T10:17:20.067

我想出了一个方法。我通过套接字发送了对象中项目所需的相关数据。

在服务器上，我从 mongoDB 进行了所需的状态更新，然后将对象广播回所有客户端。从客户端，从当前位置删除项目并使用 jquery 重新构建并将其附加到新位置。

# android - 在将用户引导至设置页面后，我如何知道用户是否真的打开了 GPS/网络？

> ID：15234678
> 
> 赞同：0
> 
> 时间：2013-03-05T21:40:45.503
> 
> 标签：android, gps, settings, provider

我正在构建一个需要 GPS 或网络操作的定位应用程序。我希望能够将用户引导到 GPS 或无线设置，以强制他们在没有打开它的情况下打开它。我的问题是，我如何检查他们是否真的在设置页面后打开了提供程序？

以下是引导用户进行设置的常用代码。之后我会怎么做？

```
LocationManager service = (LocationManager) getSystemService(LOCATION_SERVICE);
    boolean enabled = service
            .isProviderEnabled(LocationManager.GPS_PROVIDER);
    if (!enabled) {
        Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
        startActivity(intent);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:43:43.983

> 之后我会怎么做？

没有。

您大概（希望？）检查您是否可以在`onResume()`您的活动中使用 GPS。当控制从 Settings 活动返回到您的活动时，将再次调用该逻辑。因此，您将再次经历相同的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:43:24.440

使用 startActivityForResult 而不是 startActivity。然后在 onActivityResult 中再次检查 isProviderEnabled。这应该可以工作，除非 idProviderEnabled 在你有 GPS 同步之前不会返回 true，我认为情况并非如此。同样的事情应该适用于wifi。

# python - 在内存中运行 Django MySQL 测试

> ID：15234679
> 
> 赞同：4
> 
> 时间：2013-03-05T21:40:45.293
> 
> 标签：python, mysql, django

我有一个使用 mysql 作为后端的 django 1.4 项目。我有测试设置在内存中运行

```
if 'test' in sys.argv:
  DATABASES['default'] = {'ENGINE': 'django.db.backends.sqlite3'} 
```

问题是我需要使用 mysql 功能（全文索引）。

**有没有办法让 django 在内存中运行 MySQL 进行测试？**

我的项目依赖全文索引。当我在syncdb上开发项目时，然后`.sql`使用sql执行一个文件以创建全文索引。

我想在我测试的函数中使用 django orm 全文搜索。我正在尝试在每个测试的初始化中手动添加全文索引，例如：

`cursor.execute('alter table mytable add fulltext(one, two)')`

这在使用 sqlite 时不起作用（我相信是因为 sqlite 不支持全文索引）

当我删除内存测试时，上面的 sql 确实有效。我喜欢内存测试的速度。 **有没有办法可以在内存中运行mysql？**

人们如何测试依赖于数据库特定功能的应用程序？像全文索引或 gis 等...他们必须在文件系统上正常运行测试吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-05T23:06:38.123

MySQL 有一个`MEMORY`存储引擎。您*可以*`OPTIONS`使用以下密钥激活它：

```
if 'test' in sys.argv:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.mysql',
            'HOST': 'localhost',
            'NAME': 'foo',
            'USER': 'bar',
            'PASSWORD': 'baz',
            'OPTIONS': {
                'init_command': 'SET storage_engine=MEMORY'
            }
        }
    } 
```

**但是**根据[文档](http://dev.mysql.com/doc/refman/5.0/en/memory-storage-engine.html)：

```
MEMORY tables cannot contain BLOB or TEXT columns. 
```

因此，我认为这对您（和许多其他）用例来说毫无用处。

[我在这个线程](https://stackoverflow.com/questions/3096148/how-to-run-djangos-test-database-only-in-memory)中发现了一些加速 MySQL 测试的其他技巧。请务必阅读 Daniel Roseman 关于使用`INNODB`引擎的回答。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T00:05:08.207

正如在问题评论中所建议的那样，您可以通过将测试数据库存储在 RAM 驱动器上来获得一些 MySql 加速。例如，如果在 Linux 上运行，则为 tmpfs 文件系统。但是，如果您担心测试期间的速度，这可能不会提供太多的速度改进，因为 MySql 通常会将其数据缓存在内存中。

我使用的方法是编写一个测试装饰器，它将跳过给定数据库后端不支持的测试，然后使用不同`settings.py`的文件针对不同的后端进行测试。

在这里，我使用了[django-nose](https://github.com/jbalogh/django-nose)功能来帮助编写一个装饰器，以在任何测试数据库使用 SQLite 时跳过测试。

```
from nose import SkipTest
from django.conf import settings

def skip_if_sqlite(test_fn):
    """Nose test decorator to skip test if testing using sqlite databases.

    This may be useful when we know that a test will fail when using sqlite,
    possibly because the test uses functionality not supported on sqlite such
    as database views or full text indexes.

    This decorator can be used as follows:
    @skip_if_sqlite
    def my_test_that_shouldnt_run_if_sqlite_database(self):
        pass
    """

    @functools.wraps(test_fn)
    def wrapper(*args, **kwargs):
        # Skip test if any database contain a sqlite engine.
        for alias, db_settings in settings.DATABASES.iteritems():
            if 'sqlite' in db_settings['ENGINE']:
                raise SkipTest()
            return test_fn(*args, **kwargs)

    return wrapper 
```

然后，设置`settings.test.mysql`并`settings.test.sqlite`使用不同的`DATABASE`设置。如果您使用 执行测试，`settings.test.sqlite`则将跳过依赖于 MySql 特定功能的测试，但如果您针对 运行测试`settings.test.mysql`，则将执行测试。

这种方法允许您专门针对特定数据库后端的测试，但仍然提供了在开发期间针对更快的 SQLite 数据库运行大多数测试的灵活性。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-03-05T23:33:17.777

不要测试 MySQL。MySQL 已经过其开发人员的测试。您的工作是以这种方式编写代码，以便您可以用一个模拟 Python 对象替换 MySQL 连接，该对象将返回 MySQL 将返回的任何内容（或断言发送到 MySQL 的查询是否是您想要的）

# css - 100% 纯 CSS 的屏幕高度

> ID：15234682
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:40:50.407
> 
> 标签：css

这应该很简单，但我无法弄清楚。我有这样的标记：

```
<section id="container">
    <article></article>
    <article></article>
    <article></article>
    <article></article>
</section> 
```

如何通过使用纯 CSS 而不使用 JS 使每篇文章成为窗口的全高？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:44:42.023

您应该确保 html、body 和 #container 标签的高度也为 100%：

```
html, body, #container {
    height: 100%;
} 
```

示例：http: [//jsfiddle.net/aXPwL/1/](http://jsfiddle.net/aXPwL/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:45:09.167

```
<section id="container" style="height:100%">
    <article style="height:100%;"></article>
    <article style="height:100%;"></article>
    <article style="height:100%;"></article>
    <article style="height:100%;"></article>
</section> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:50:59.207

从 html 级联到 article 元素的所有元素都需要指定 100% 的高度，否则任何子元素将始终仅与其父元素一样高。

[我的 JSFiddle](http://jsfiddle.net/zBJ94/)来证明这一点

```
html {
  height: 100%;
}

body {
  height: 100%;
} 
section {
  height: 100%;
}
article {
  background: blue;
  width: 100%;
  height: 100%;
} 
```

另请注意，不确定这是否是您想要的，但由于文章没有堆叠在一起，用户必须向下滚动才能看到所有 4 篇文章，使实际页面高度成为浏览器窗口高度的 4 倍.

# javascript - Javascript，从覆盖方法调用超类方法的便捷方法

> ID：15234686
> 
> 赞同：0
> 
> 时间：2013-03-05T21:41:01.697
> 
> 标签：javascript

为了在 JavaScript 中模拟经典的类 Java 类，我有一个名为“createClass”的函数：

它有 3 个参数：
* 应该创建的构造函数的名称和路径。
* 超类的路径。
* 带有类方法的 JavaScript 对象。

例如：

```
myApp.createClass("myapp.core.JString", "myapp.core.BaseString", {
  abc: function () {
  ... 
```

首先我创建一个构造函数

```
Cf = function () {
... 
```

如果有超类（“Base”是超类的构造函数）：

```
protoObj = new Base();
protoObj.constructor = Cf; 
```

现在，新类的方法一个方法，我把它们放到protoObj上：（
“protos”是具有“类”方法的对象）

```
for (name in protos) {
  ????????????????????
  protoObj[name] = protos[name] 
```

但在将方法放入 protoObj 之前，我想创建方便的方法来从覆盖的方法中调用超类方法：

```
init: function () {
  this.jstring_super_init();
... 
```

因此，在问号所在的位置，我想放置以下代码：（在这种情况下，classnameLast 是“jstring”=> 类路径的最后一部分 => 小写）

```
if ((typeof protos[name] === "function") && 
    (protoObj[name]) && 
    (typeof protoObj[name] === "function")) {
  supername = classnameLast + "_super_" + name;
  protoObj[supername] = XXXXXXXXXXXXX 
```

在多个 X 所在的地方，我尝试了几件事，但没有任何效果。它应该调用被覆盖的超类的方法。

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:38:56.213

也许你可以做这样的事情：

```
for (name in protos) {
    var super_function = ...; //wherever it comes from
    protoObj[name] = protos[name];
    protos[name]._super = super_function;
} 
```

然后，从函数内部，您应该可以通过`this._super`. 您甚至`this._super.call(this, ...)`可以确保在`this`.

希望我正确理解你。另外，如果我可以提出建议，可能会有一种更简单的方法来处理经典对象和继承。如果你不想使用 Typescript，至少尝试一下他们使用的继承模型（这很常见）。

[http://pastebin.com/Z2kaXqEv](http://pastebin.com/Z2kaXqEv)

编辑：帮助我的是使用 Typescript 游乐场（[http://www.typescriptlang.org/Playground/](http://www.typescriptlang.org/Playground/)）。尝试一下它和它的类特性，看看它是如何编译成 Javascript 的。这将帮助您更好地理解如何在 Javascript 中完成经典继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T10:43:06.960

我为 XXXXXXXXXXXX 尝试了这个，它奏效了：

```
(function(name1, Base1){
  return function() {
    Base1.prototype[name1].apply(this, arguments);                                                                       
  };
})(name, Base); 
```

我在 Firefox 19、Firebug 1.11.2 中调试了“jstring_super_init”函数调用。

Firebug 的行为很奇怪，跳到代码的错误位置！！

然后，我插入了“console.log(this.cid);” 在 superinit 调用之后。

在超类的 init 方法中放置在“this”上的 cid 就在那里！

使用 Google Chrome 25 版调试时，它会跳转到正确的功能！

# javascript - Oncomplete JavaScript 不会在执行时重新评估 EL 表达式

> ID：15234687
> 
> 赞同：0
> 
> 时间：2013-03-05T21:41:01.697
> 
> 标签：javascript, jsf-2, primefaces, el

我有一个 Primefaces 对话框，其中包含一个带有以下完整规则的“保存”按钮：

```
<p:dialog id="dialogId" widgetVar="dialogWidget">
     ...
    <p:commandButton value="Save" async="true"
                     oncomplete="if (!args.validationFailed &amp;&amp; #{xp:hasNoMessagesToDisplay(dialogId)}) dialogWidget.hide()" 
                     partialSubmit="true" process="dialog"/> 

</p:dialog> 
```

`#{xp:hasNoMessagesToDisplay}`是一个自定义 EL 函数，用于检查是否有与指定的 dialogId 关联的任何 FacesMessage。问题是这个函数的评估只发生在为对话框呈现 HTML 时（例如在初始页面加载时）。我需要在评估 oncomplete Javascript 时评估该函数（即在运行中）。

是否可以扩展 Primefaces“args”Javascript 对象以包含其他信息，或者有哪些替代方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:54:50.020

[从这篇文章](https://stackoverflow.com/questions/14401652/how-to-trigger-args-validationfailed-in-primefaces-oncomplete?rq=1)中得到了一个想法，它给了我一个解决方案：

`FacesContext.getCurrentInstance().validationFailed();`在创建对话框的 FacesMessage 以指示 JSF 验证失败时使用，因此

`oncomplete="if (!args.validationFailed) dialogwidget.hide()"`

足够了。我不确定这有什么影响，我想我只需要拭目以待......

# ios - Apple 推送通知 - 从生产应用程序获取空推送令牌 - 将在修复配置文件问题后发送推送令牌

> ID：15234690
> 
> 赞同：3
> 
> 时间：2013-03-05T21:41:08.893
> 
> 标签：ios, app-store, push-notification, apple-push-notifications, entitlements

我们向 iPhone 应用程序添加了接收推送通知。一切都在测试/沙箱环境中工作，我们从应用程序获取令牌 ID，并且可以从我们的服务器发送推送通知。

但是现在该应用程序已获得批准并从 Appstore 中出来，我们收到了空的推送令牌/通知 ID 发送到我们的服务器。我们已经有 600 多个...请注意，最终用户确实会弹出窗口以批准在应用程序中接收通知，应用程序只是在批准后向我们的服务器发送空令牌。因此，APNS 服务器可能会分发空令牌。

以下问题向我们表明，这可能是由于我们用于构建应用商店的配置文件中缺少“推送通知”权利： [如何检查 iOS 分发配置文件是否启用了推送通知？](https://stackoverflow.com/questions/8747539/how-do-i-check-if-an-ios-distribution-provisioning-profile-has-push-notification)

缺少的权利是由于 Apple 的供应商网站中的一个错误，但在以下文章 [http://developer.apple.com/library/mac/#documentation中提到的“在下载新配置文件之前修改任何现有配置文件”之后/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ProvisioningDevelopment/ProvisioningDevelopment.html)

我们现在在 .mobileprovision 文件中拥有正确的权利：

```
<key>Entitlements</key>
<dict>
 ..   
 <key>aps-environment</key>
 <string>production</string>
 .. 
```

所以我们正在重建我们的应用程序并将其添加到商店。并希望届时能收到推送通知。

我希望以上内容可能对其他人有所帮助。但是现在要回答我的实际问题：当他们从商店安装下一个更新时，我们是否也会开始为已经下载当前版本的 600 多个用户接收新的推送令牌？还是我们需要在我们的应用程序中添加一些初始代码？registerForRemoteNotifications 方法现在只在应用程序启动时调用。当推送令牌 id 从空 ('') 更改为实际令牌时也会触发吗？当然，我们不想再等（小）一周等待新的 AppStore 批准，然后才发现推送通知仍然不适用于某些用户。希望有高手能告诉我们。

注意：我们使用的是在 MonoTouch 中开发的 iPhone 应用程序，并使用（旧）APNS-Sharp 库从我们的服务器发送通知，但我认为这些细节与此问题无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:34:15.660

当这 600 多个用户安装下一个更新并再次运行应用程序时，您的应用程序将调用`registerForRemoteNotifications`（因为您说您在启动时调用它），并将获得非空设备令牌（何时`application:didRegisterForRemoteNotificationsWithDeviceToken:`调用）。Apple 在他们的文档中声明，您应该始终在启动时调用此方法，而不是使用设备令牌的缓存副本，因为不能保证设备令牌保持不变。所以你不应该有任何问题。

这是来自 APNS 文档的相关引用：

> 应用程序应在每次启动时注册并为其提供者提供当前令牌。它调用 registerForRemoteNotificationTypes: 方法来启动注册过程。此方法的参数采用 UIRemoteNotificationType（或者，对于 OS X，为 NSRemoteNotificationType）位掩码，该位掩码指定应用程序希望接收的通知的初始类型——例如，图标标记和声音，但不包括警报消息。在 iOS 中，用户随后可以在“设置”应用程序的“通知”首选项中修改启用的通知类型。在 iOS 和 OS X 中，您可以通过调用 enabledRemoteNotificationTypes 方法来检索当前启用的通知类型。操作系统不会标记图标、显示警报消息、

这也是相关的：

> 通过在每次启动应用程序时请求设备令牌并将其传递给提供者，您可以帮助确保提供者拥有设备的当前令牌。如果用户将备份恢复到为其创建备份的设备或计算机之外的设备或计算机（例如，用户将数据迁移到新设备或计算机），他或她必须至少启动一次应用程序以使其恢复再次收到通知。如果用户将备份数据恢复到新设备或计算机，或重新安装操作系统，则设备令牌会更改。此外，永远不要缓存设备令牌并将其提供给您的提供商；始终在需要时从系统获取令牌。如果您的应用程序之前已注册，请调用 registerForRemoteNotificationTypes：

# java - 仅当 JTable 适合视口时才启用自动调整大小

> ID：15234691
> 
> 赞同：14
> 
> 时间：2013-03-05T21:41:10.220
> 
> 标签：java, swing, jtable, preferredsize, jviewport

我需要在 JScrollPane 内创建一个带有可调整大小的列的 JTable（当用户增加列宽时 - 出现水平滚动条）。为此，我使用了`table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);`. 此外，当视口足够宽以包含整个表格时 - 列应拉伸以填充视口宽度。为了做到这一点，我有`getScrollableTracksViewportWidth()`JTable 类的覆盖方法如下：

```
@Override
public boolean getScrollableTracksViewportWidth() {
    return getPreferredSize().width < getParent().getWidth();
} 
```

这种方法效果很好，除了一件事：当我第一次尝试调整列的大小时，它会返回自己的宽度到起始位置。如果我快速调整列大小并释放鼠标表继续工作良好。那么，这种行为的原因是什么？为什么即使`getScrollableTracksViewportWidth()`返回 false，表格也会尝试调整大小？或者，也许，您可以提出更好的解决方案来实现这种调整大小模式？

贝娄是上述问题的一个简单的工作示例：

```
import javax.swing.*;

public class TestTable {
    private static Object[][] data = new Object[][] {
            { "a", "b", "c" },
            { "d", "e", "f" }
    };
    private static Object[] colNames = new Object[] { "1", "2", "3" };

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JTable table = new JTable(data, colNames) {
                    @Override
                    public boolean getScrollableTracksViewportWidth() {
                        return getPreferredSize().width < getParent().getWidth();
                    }
                };
                table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new JScrollPane(table));
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-06T06:50:10.230

当您在水平滚动条不可见时尝试增加列的大小时，默认逻辑似乎`doLayout()`不起作用，所以我摆脱了默认逻辑，只是接受了列的宽度而不尝试调整它.

```
import javax.swing.*;
import javax.swing.table.*;

public class TestTable {
    private static Object[][] data = new Object[][] {
            { "a", "b", "c" },
            { "d", "e", "f" }
    };
    private static Object[] colNames = new Object[] { "1", "2", "3" };

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JTable table = new JTable(data, colNames)
                {
                    @Override
                    public boolean getScrollableTracksViewportWidth()
                    {
                        return getPreferredSize().width < getParent().getWidth();
                    }

                    @Override
                    public void doLayout()
                    {
                        TableColumn resizingColumn = null;

                        if (tableHeader != null)
                            resizingColumn = tableHeader.getResizingColumn();

                        //  Viewport size changed. May need to increase columns widths

                        if (resizingColumn == null)
                        {
                            setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);
                            super.doLayout();
                        }

                        //  Specific column resized. Reset preferred widths

                        else
                        {
                            TableColumnModel tcm = getColumnModel();

                            for (int i = 0; i < tcm.getColumnCount(); i++)
                            {
                                TableColumn tc = tcm.getColumn(i);
                                tc.setPreferredWidth( tc.getWidth() );
                            }

                            // Columns don't fill the viewport, invoke default layout

                            if (tcm.getTotalColumnWidth() < getParent().getWidth())
                                setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);
                                super.doLayout();
                        }

                        setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
                    }

                };
                table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new JScrollPane(table));
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

编辑为使用 AUTO_RESIZE_ALL_COLUMNS。

# django - Django-CMS - 当我指定模型时，管理员的 CMS 部分消失

> ID：15234696
> 
> 赞同：0
> 
> 时间：2013-03-05T21:41:40.597
> 
> 标签：django, django-admin, django-cms

我试图在 Django-CMS 文档（[http://docs.django-cms.org/en/2.3.5/extending_cms/custom_plugins.html](http://docs.django-cms.org/en/2.3.5/extending_cms/custom_plugins.html)）中复制 2.4 中的示例。但是，每当我在**cms_plugins.py**下指定模型时`class HelloPlugin`，管理员中的整个 CMS 部分都会消失。知道是什么原因造成的吗？

**模型.py**

```
from django.db import models

class MyModel(models.Model):
    title = models.CharField(max_length=50, null=True, blank=True)

    def __unicode__(self):
        return self.title

from cms.models.pluginmodel import CMSPlugin

class HelloPlugin(CMSPlugin):
    ad = models.ForeignKey('core.MyModel', related_name='plugins')

    def __unicode__(self):
      return self.ad.title 
```

**cms_plugins.py**

```
class HelloPlugin(CMSPluginBase):
    model = MyModel
    name = _("MyModel Plugin")
    render_template = "myplugin.html"

    def render(self, context, instance, placeholder):
        context['instance'] = instance
        return context

plugin_pool.register_plugin(HelloPlugin) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:04:04.557

小但重大的错误。我正在导入模型，而不是插件。

# javascript - 表格单元格中的每一行都有一个按钮

> ID：15234702
> 
> 赞同：2
> 
> 时间：2013-03-05T21:42:04.290
> 
> 标签：javascript

我正在尝试使用 JavaScript 将 2 个按钮放入表格单元格

我有这样的事情：

```
var table_cell = document.getElementById("table_cell")
var button_A = document.createElement("input")
button_A.setAttribute("value","BUTTON A")
button_A.setAttribute("type","button")
var button_B = document.createElement("input")
button_B.setAttribute("value","BUTTON A")
button_B.setAttribute("type","button")
table_cell.appendChild(button_A)
table_cell.appendChild(button_B) 
```

按钮并排排列，而不是一个上一个下。我正在努力做到每一层都有一个按钮

```
 _____________   
|  _________  |   
| |_________| |     
|  _________  |   
| |_________| |     
|_____________| 
```

而不是

```
 __________________________
|  _________   _________   |
| |_________| |_________|  |
|__________________________| 
```

我尝试在 table_cell 上附加一个文本节点，其中包含“\r\n”和“ &38”等转义字符，但没有一个有效。

如果有 JS 的解决方案，我将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:45:46.910

如何`<br>`在按钮之间使用标签

```
table_cell.appendChild(button_A);
table_cell.appendChild(document.createElement('br'));
table_cell.appendChild(button_B); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:45:58.127

你可以这样做：

```
button_A.style.display = 'block';
button_B.style.display = 'block'; 
```

但使用 CSS 可能是最好的：

```
input[type="button"] {
    display:block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:44:58.257

```
table_cell.appendChild(button_A)
table_cell.appendChild(document.createElement("br"))
table_cell.appendChild(button_B) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:46:21.200

添加换行符 ( `<br />`) 元素：

```
var table_cell = document.getElementById("table_cell");
var button_A = document.createElement("input");
button_A.setAttribute("value","BUTTON A");
button_A.setAttribute("type","button");
var button_B = document.createElement("input");
button_B.setAttribute("value","BUTTON A");
button_B.setAttribute("type","button");
var newline = document.createElement("br"); // <-- Add a newline
table_cell.appendChild(button_A);
table_cell.appendChild(newline); // <-- and append
table_cell.appendChild(button_B); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/FdkM7/)**

# actionscript-3 - Loader.as 返回空白位图

> ID：15234703
> 
> 赞同：0
> 
> 时间：2013-03-05T21:42:10.130
> 
> 标签：actionscript-3, flash, loader

我有一个应用程序从服务器中提取 Bitmap 资源 - 目前我使用 Loader 类来执行此操作，然后，一旦加载它们，根据加载器尺寸生成 BitmapData 并将 Loader 的实例直接绘制到它（ BitmapData 用于 Away3D 纹理以及 Bitmap 实例，所以我不需要加载器一次获取）。

这一直对我有用，但最近我开始得到 0x0 加载器，结果是无效的 BitmapData。

我停止这样做：

```
this.imageBitmap = new BitmapData(this.imageLoader.width, this.imageLoader.height, true, 0); 
```

..并开始这样做：

```
this.imageBitmap = new BitmapData(event.target.content.width, event.target.content.height, true, 0); 
```

其中 event 是加载程序触发的 Event.COMPLETE 事件。这解决了尺寸问题，但 BitmapData 只是一个纯白色位图（默认情况下它设置为透明，所以它被绘制到其中）。令人沮丧的是，这并不是每次都会发生，如果我刷新应用程序，它应该在大约 25% 的时间里正常工作，否则它会像这样播放。

我的截止日期很紧，我真的在搞砸这件事，如果有人可以提供帮助或建议更好的方法，你真的会拯救我的脖子！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T01:04:10.570

听起来您需要调整加载程序的图像解码策略 - 以确保它在 COMPLETE 触发之前解码图像 - 然后宽度和高度等应该是可靠的。

为此，只需在 Loader.load 方法中添加一个合适的 LoaderContext 对象：

```
var loaderContext:LoaderContext = new LoaderContext();
//set decode policy
loaderContext.imageDecodingPolicy = ImageDecodingPolicy.ON_LOAD;
//load image
loader.load(yourUrl, loaderContext); 
```

默认解码策略是 ImageDecodingPolicy.ON_DEMAND - 在实际需要之前不会解码图像。

朗文档：[http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/ImageDecodingPolicy.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/ImageDecodingPolicy.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T10:25:48.883

修复了它，愚蠢的疏忽和有点模糊的情况，但我会留下答案，以防有人遇到类似的事情。

我的加载器包含在 Asset 类中 - 当另一个对象需要内部位图时，它会查询此类 - 如果位图存在，则返回它，如果不存在，则使用加载器加载它并为触发的 COMPLETE 事件注册回调当 Loader 已加载并将其内容传输到 BitmapData 实例时。

我犯的愚蠢错误是，如果多个对象正在查询同一个（尚未加载的）资产，它每次都会开始重新加载资产，并创建一个新的加载器......所以当第一个加载器已完成，它会触发一个事件但不存在对它的引用，这不仅会造成内存泄漏，还会导致资产类从最近创建的加载器中提取 BitmapData，这并不完整！Loader 的异步特性是它有时工作的原因，因为有时最终的 Loader 会及时准备好进行 BitmapData 提取。

简单的解决方案是创建一个内部布尔值 _isLoading，它在第一次调用 load() 时设置为 true - 如果它为 true，则任何后续调用都将被忽略，但回调仍然注册，这是一种享受！

# matlab - 在图像上创建随机高斯

> ID：15234704
> 
> 赞同：0
> 
> 时间：2013-03-05T21:42:10.420
> 
> 标签：matlab, random, 2d, gaussian

我正在尝试创建一些高斯分布并将它们放在图像上。高斯随机创建参数（幅度、位置和标准偏差）。首先，我将参数放入向量或矩阵中，然后我使用 ngrid() 函数来获取 2d 空间来创建高斯，但是我得到了一个错误（因为可能使用 ngrid 值的数学运算不是微不足道的......）。错误是：

```
 ??? Error using ==> minus
Integers can only be combined
with integers of the same class,
or scalar doubles.
Error in ==> ss_gauss_fit at 23
  gauss = amp(i)*
  exp(-((x-xc).^2 +
  (y-yc).^2)./(2*std(i))); 
```

代码在这里：

```
clear all;
image = uint8(zeros([300 300]));
imsize=size(image);

noOfGauss=10;
maxAmpGauss=160;
stdMax=15;
stdMin=3;

for i=1:noOfGauss
    posn(:,:,i)=[  uint8(imsize(1)*rand())   uint8(imsize(2)*rand())  ];
    std(i)=stdMin+uint8((stdMax-stdMin)*rand());
    amp(i)= uint8(rand()* maxAmpGauss);
end

% draw the gaussians on blank image
for i=1:noOfGauss
    [x,y] = ndgrid(1:imsize(1), 1:imsize(2));
    xc = posn(1,1,i);
    yc = posn(1,2,i);
    gauss = amp(i)* exp(-((x-xc).^2 + (y-yc).^2)./(2*std(i)));

    image = image + gauss;
end 
```

请告诉我如何解决这个问题，用参数向量绘制二维高斯......在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:41:22.097

除了我不太了解的“在图像上绘图”的疯狂之外，我认为您正在尝试在网格上添加一堆单独的高斯分布。这是我对您的代码所做的。请注意，您的二元高斯未正确归一化，并且您之前使用的是方差而不是标准差。我修复了后者；但是，我没有为归一化而烦恼，因为无论如何您都将每个值乘以一个幅度值。

```
clear all;
xmax = 50;
ymax = 50;

noOfGauss=10;
maxAmpGauss=160;
stdMax=10;
stdMin=3;

posn = zeros(noOfGauss, 2);
std = zeros(noOfGauss, 1);
amp = zeros(noOfGauss, 1);

for i=1:noOfGauss
    posn(i,:)=[ xmax*rand()  ymax*rand() ];
    std(i)=stdMin+(stdMax-stdMin)*rand();
    amp(i)= rand()* maxAmpGauss;
end

% draw the gaussians
[x,y] = ndgrid(1:xmax, 1:ymax);
z = zeros(xmax, ymax);

for i=1:noOfGauss    
    xc = posn(i,1);
    yc = posn(i,2);    
    z = z + amp(i)* exp(-((x-xc).^2 + (y-yc).^2)./(2*std(i)^2));
end 

surf(x, y, z); 
```

随机输出：

![在此处输入图像描述](../Images/57a8b1954ffaa4db8b6a02eabeb05134.png)

# ios - 如何将 ManagedObjectID 传递给主线程

> ID：15234709
> 
> 赞同：0
> 
> 时间：2013-03-05T21:42:41.047
> 
> 标签：ios, core-data, nsmanagedobjectcontext, nsmanagedobjectid

我将 ManagedObject 保存在具有自己上下文的后台线程上。然后，我想使用托管对象上下文将通知发送回主线程，以便我可以使用它的数据。

根据文档，看起来我应该将 id 传递给主线程而不是对象。

这是正确的，那我应该怎么处理那个Id呢？我应该使用 ID 从主线程获取核心数据以在主线程上获取 ManagedObject 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:49:49.220

您正确理解将对象 ID 传递回主线程。完成此操作后，使用该`objectWithID:`方法传递`NSManagedObjectID`从另一个线程发送的消息，将对象从主线程的`NSManagedObjectContext`实例中取出。

```
NSManagedObject *objectForThisThread = [managedObjectContextForThisThread objectWithID:managedObjectID]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:52:11.077

另一种方法是使用以下方法

```
- (NSManagedObject *)existingObjectWithID:(NSManagedObjectID *)objectID error:(NSError **)error 
```

此方法从不返回该对象的错误。

在你的后面线程做一个保存。使用该方法将允许检索保存在后台的对象。

请参阅[`NSManagedObjectContext`类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html)。

# uml - 穿着完整的用例中的泛化

> ID：15234712
> 
> 赞同：0
> 
> 时间：2013-03-05T21:42:48.320
> 
> 标签：uml, use-case

概括如下图所示的用例图。我认为这是一个不好的例子，但让我们假设在一个完整的用例中，本地呼叫和长途呼叫每个都需要 10 步。一半的步骤相同，另一半（略有）不同。

[图 http://www.wthreex.com/rup/smallprojects/rup/guidances/guidelines/resources/ucgen4.gif](http://www.wthreex.com/rup/smallprojects/rup/guidances/guidelines/resources/ucgen4.gif)

我的问题是，我们如何在完整的用例中显示此图？我认为以下，如果我错了，请纠正我：

```
Place call
1\. do something that is the same for both children (ex. pick up phone)
2\. do something that is the same for both children
3\. do something that is the same for both children
4\. do something that is different for both children but write it very abstract 
   so that it applies to both. (ex. make  a connection to the grid)
5\. do something that is different for both children but write it very abstract
6\. do something that is the same for both children
7\. do something that is different for both children but write it very abstract
8\. do something that is the same for both children
9\. do something that is different for both children but write it very abstract
10\. do something that is different for both children but write it very abstract

Place local call
1\. rewrite the steps that are the same as the parent.
2.
3.
4\. do something that is different for both children and write it detailed 
   (ex. make  a connection to the LOCAL grid)
... 
```

第二个问题是：您是将主要演员与地方电话联系起来还是与每个孩子联系起来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T11:32:14.720

第一个问题：我将使用各个用例的文本描述来概述所述细节，或者（作为替代）编写一个场景 - 或者（作为另一种替代）使用活动图。

我认为将所有内容都放在用例图中太过分了，因为它太详细了。

第二个问题：将其与`place call`. 毕竟，这是使用泛化的重要好处之一。

# javascript - 检测浏览器是否对站点足够快

> ID：15234717
> 
> 赞同：4
> 
> 时间：2013-03-05T21:43:12.663
> 
> 标签：javascript, browser-detection

特征检测通常优于浏览器嗅探。如果某些浏览器“支持”我正在使用的功能但 javascript 运行时太慢，我该怎么办？

我正在使用 d3 库进行一些复杂的可视化。可视化在 chrome / firefox 中非常流畅，在 IE9 中可以接受，但在 IE8 中运行缓慢。我想向 IE8 用户显示一个横幅，告诉他们升级，并向 IE9 用户显示一个通知横幅，它会在 chrome 或 FF 中更快。通过用户代理嗅探来做这件事是不是很糟糕？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:01:16.377

为什么不测量浏览器计算复杂事物所花费的时间，类似于您想要做的事情，并为其设置阈值时间？

```
function detectBrowserSpeed(){

    var i,
        slowThreshold = 100; // milliseconds
        startMillis = + new Date(); //The + is to 'force' casting to an integer representing EPOCH milliseconds. If + is ommited, then I get an instance of Date.

    //Do something complex here:
    for (i=0;i<100000;i+=0.1){

    }

    var elapsed = (+ new Date()) - startMillis;
    if(elapsed > slowThreshold){
        return 'slow';
    }else{
        return 'fast'; 
    }

} 
```

# java - 如何使用 MyBatis 在 Oracle 中获取最后插入 id？

> ID：15234718
> 
> 赞同：6
> 
> 时间：2013-03-05T21:43:13.333
> 
> 标签：java, oracle, mybatis

我正在向表中插入一些数据，`Oracle`并且需要检索`id`插入行的。Said`id`由序列生成，然后由触发器插入到表中。

现在，我知道在使用时有几种方法可以获取插入行的id `JDBC`，但是由于我是`MyBatis`用来执行`INSERT`命令的，所以我似乎无法弄清楚插入数据后如何获取id。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T16:20:24.353

像这样的东西应该工作

```
class User {
  int userId
  ...
}

<insert id="addUser" useGeneratedKeys="true" keyColumn="user_id" keyProperty="userId">
  INSERT INTO user(login, name,...) VALUES(#{login}, #{name},...
</insert> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-06T15:29:11.767

对我来说它是这样工作的（mybatis 3）

```
<insert id="create" parameterType="Project" useGeneratedKeys="true" keyProperty="project.projectId" keyColumn="PROJECT_ID">
    INSERT INTO PROJECT (TITLE,DESCRIPTION)
    VALUES
    (#{title},#{description})
</insert> 
```

不需要选择键。只需确保在 keyProperty 中输入正确的值。在插入 oracle 之前我有一个触发器以从序列中获取下一个 id。

或者，这也适用：

```
<insert id="createEmpty" statementType="CALLABLE" parameterType="Panelist">
    BEGIN INSERT INTO PANELIST(PANEL_ID) VALUES (#{panelId})
    RETURNING PANELIST_ID INTO
    #{panelist.panelistId,mode=OUT,jdbcType=INTEGER}; END;
</insert> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:58:49.423

假设触发器使用 id_seq Oracle 序列来获取 id。如果你使用相同的数据库会话从 MyBatis 执行，SQL

```
select id_seq.currval from dual; 
```

您将获得使用的 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-09T07:54:17.047

使用 oracle，最好分两个阶段进行。效果很好，价格只是一个映射器：

第一阶段：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sample.work.dao.SequencerMapper" >
<select id="selectNextId" resultType="long" >
 select seq_sample.nextval from dual
</select>
</mapper> 
```

您获得序列，放入您的对象占位符并

第二阶段：

插入你的对象

# java-ee-6 - 覆盖内置主体 Bean

> ID：15234723
> 
> 赞同：2
> 
> 时间：2013-03-05T21:43:26.147
> 
> 标签：java-ee-6, cdi

在 Java EE 6 中，有一个内置的 bean 类型`javax.security.Principal`可用于注入，例如`@Inject Principal principal;`.

这是默认情况下，我想知道是否有办法改变它，比如说，通过提供生产者方法。

就目前而言，编写生产者方法将导致部署异常。

示例生产者：

```
my.package;

import javax.security.Principal;

public class MyProducer {

    ...

    @Produces
    public Principal obtainPrincipal() {
        return getMyPrincipal();
    }
} 
```

例外：

```
org.jboss.weld.exceptions.DeploymentException: WELD-001409 Ambiguous dependencies for type [Principal] with qualifiers [@Default] at injection point [[parameter 1] of [constructor] @Inject public my.package.MyType(Principal, SomeOtherType)]. Possible dependencies [[Producer Method [Principal] with qualifiers [@Any @Default] declared as [[method] @Produces @SessionScoped protected my.package.MyProducer.obtainPrincipal()], Built-in Bean [java.security.Principal] with qualifiers [@Default]]]
    at org.jboss.weld.bootstrap.Validator.validateInjectionPoint(Validator.java:278)
    at org.jboss.weld.bootstrap.Validator.validateInjectionPoint(Validator.java:244)
    at org.jboss.weld.bootstrap.Validator.validateBean(Validator.java:107)
    at org.jboss.weld.bootstrap.Validator.validateRIBean(Validator.java:127)
    at org.jboss.weld.bootstrap.Validator.validateBeans(Validator.java:346)
    at org.jboss.weld.bootstrap.Validator.validateDeployment(Validator.java:331)
    at org.jboss.weld.bootstrap.WeldBootstrap.validateBeans(WeldBootstrap.java:366)
    at org.jboss.as.weld.WeldContainer.start(WeldContainer.java:83)
    at org.jboss.as.weld.services.WeldService.start(WeldService.java:76)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722) 
```

所以问题是 - 有没有办法替换 CDI 中的默认内置类型？

为了让您了解我为什么需要它，我的项目正在从 JAAS 切换到 Apache Shiro。有大量现有代码基于注入的主体执行某些操作。然而，Web 环境中的 Shiro 仅包装 HttpServlet 请求/响应并覆盖适当的安全相关方法。然而，这不会传播到 CDI，在这种情况下，它总是返回匿名主体。

**更新** 我还尝试了以下方法：

```
my.package;

import javax.security.Principal;

@Alternative
public class MyPrincipal implements Principal {

    ...

    @Override
    public String getName() {
        return getMyPrincipalName();
    }

} 
```

然后在 beans.xml 中启用替代方案：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://java.sun.com/xml/ns/javaee"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaeehttp://java.sun.com/xml/ns/javaee/beans_1_0.xsd">

    <alternatives>
        <class>my.package.MyPrincipal</class>
    </alternatives>

</beans> 
```

在这种情况下，没有部署错误，但注入的主体仍然是默认的，而不是我启用的替代方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T16:25:22.730

Weld 的人帮助了我。我的部署结构是这样的：

```
-- app.war
  |-- module0.jar (beans.xml)
  |-- module1.jar (beans.xml)
  |-- ...
  |-- other-lib.jar 
```

但在 CDI 1.0 中，仅对每个 bean 归档启用了替代方案。所以，添加

```
<alternatives>
    <class>my.package.MyPrincipal</class>
</alternatives> 
```

在每个 beans.xml 中都可以正常工作。

# excel - Excel - 需要在工作表中随机输入项目的主列表

> ID：15234724
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:43:27.780
> 
> 标签：excel, vba

我有一个 12 列 x 26 行的表格，名称将在单元格中随机输入。我想按照它们在表中输入的顺序生成这些名称的列表。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:41:48.857

您并没有真正指定您想要列表的位置等，所以我对它采取了一些自由。

代码将监控`Range(A1:L26)`并执行以下操作

> 如果添加了任何文本，它将将该项目添加到列表中（即 N 和 M 列）。
> 如果稍后修改该单元格内的值，它将更新初始列表项。
> 如果清除该值，则列表项将被删除，将剩余的列表项向上移动一个。

将以下代码复制到工作表模块中（例如：Sheet1，如果您希望它在工作表 1 上处于活动状态）

```
Private Sub Worksheet_Change(ByVal Target As Range)
Dim Row As Integer
Dim List As Range
Set List = Range("N1")
If Not Intersect(Target, Range("A1:L26")) Is Nothing Then
    Row = 0
    Do
        If List.Offset(RowOFfset:=Row).Value = "" Then
            ' End of list or empty list, add item to list
            List.Offset(RowOFfset:=Row).Value = Target.Address
            List.Offset(RowOFfset:=Row, ColumnOffset:=1).Value = Target.Value
            Exit Do
        Else
            If List.Offset(RowOFfset:=Row).Value = Target.Address Then
                ' Target has been added already
                If Target.Value = "" Then
                    ' Target has been cleared, remove the item from the list and shift list up
                    Range(List.Offset(RowOFfset:=Row), List.Offset(RowOFfset:=Row, ColumnOffset:=1)).Delete xlShiftUp
                Else
                    ' Target has changed, update the list item (in place)
                    List.Offset(RowOFfset:=Row, ColumnOffset:=1).Value = Target.Value
                End If
                Exit Do
            Else
                Row = Row + 1
            End If
        End If
    Loop
Else
    ' Invalid Target
End If
End Sub 
```

**更新**

我已经更改了代码，希望能做你想做的事。我对“每隔 2 列”有点困惑，所以我希望你的意思是 B、E、H、K 列......

```
Private Sub Worksheet_Change(ByVal Target As Range)
Dim Row As Integer
Dim List As Range
Dim Column As Integer

    Set List = ThisWorkbook.Worksheets("Sheet2").Range("A1")

    If Target.Cells.Count > 1 Then Exit Sub

    Column = Target.Column
    ' This is used to determine if the column is one we are looking for
    ' eg: 2-3 = -1, 5-3-3 = -1, 8-3-3-3 = -1 etc
    Do
        Column = Column - 3
        If Column <= 0 Then Exit Do
    Loop

    If Column = -1 Then
        If Target.Row > 2 And Target.Row < 27 Then
            ' Target Match
            Row = 0
            Do
                If List.Offset(RowOffset:=Row).Value = "" Then
                    ' End of list or empty list, add item to list
                    List.Offset(RowOffset:=Row).Value = Target.Address
                    List.Offset(RowOffset:=Row, ColumnOffset:=1).Value = Target.Value
                    List.Offset(RowOffset:=Row, ColumnOffset:=2).Value = Cells(2, Target.Column).Value
                    Exit Do
                Else
                    If List.Offset(RowOffset:=Row).Value = Target.Address Then
                        ' Target has been added already
                        If Target.Value = "" Then
                            ' Target has been cleared, remove the item from the list and shift list up
                            Range(List.Offset(RowOffset:=Row), List.Offset(RowOffset:=Row, ColumnOffset:=2)).Delete xlShiftUp
                        Else
                            ' Target has changed, update the list item (in place)
                            List.Offset(RowOffset:=Row, ColumnOffset:=1).Value = Target.Value
                        End If
                        Exit Do
                    Else
                        Row = Row + 1
                    End If
                End If
            Loop
        Else
            ' Target Column, Non-Target Row
        End If
    Else
        ' Non-Target Column
    End If

End Sub 
```

# c# - 重用添加到 EF 的对象

> ID：15234726
> 
> 赞同：0
> 
> 时间：2013-03-05T21:43:38.127
> 
> 标签：c#, entity-framework, object

我正在使用 EF 4。我想在（消息）表中添加一行，因此我声明了一个新对象（newMSG）并填充它。然后我使用消息表的方法 .AddObject(newMSG) 添加新行。

newMSG 对象现在是否可以“重用”以添加另一行？还是我需要一个新对象？似乎我应该能够重用 newMSG 对象，但测试起来并不容易。

你们马上就会知道...当然，这适用于任何物体，我想。EF没有什么特别的......

如果我在两次使用之间使用 savechanges() 方法可能有关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:06:24.790

你需要一个新对象。有附加到该 newMSG 对象的元数据，将其与该特定行联系起来。

# syntax - 在这个宏中包含 STDEV 并调用

> ID：15234728
> 
> 赞同：0
> 
> 时间：2013-03-05T21:43:45.130
> 
> 标签：syntax, macros, spss

我汇总了以下宏以获取各种大小的随机样本，然后计算 MEAN 给定次数。我还想在 MEAN 旁边计算 STDEV。我尝试了对脚本的各种修改，但我很难应用我认为的正确语法。谢谢你的帮助。

问候

安迪

```
DEFINE !sample(myvar !TOKENS(1)
/nbsampl !TOKENS(1)
/size !CMDEND).

myvar = the variable of interest (here we want the mean of salary)
nbsampl = number of samples.
size = the size of each samples.

!LET !first='1'
!DO !ss !IN (!size)
!DO !count = 1 !TO !nbsampl.

GET FILE='E:\Monte carlo testing\s1.sav'.
COMPUTE draw=uniform(1).
SORT CASES BY draw.
N OF CASES !ss.

COMPUTE samplenb=!count.
COMPUTE ss=!ss.

AGGREGATE
/OUTFILE=*
/BREAK=samplenb
/!myvar = MEAN(!myvar) /ss=FIRST(ss).

!IF (!first !NE '1') !THEN
ADD FILES /FILE=* /FILE='E:Monte carlo testing\sample.sav'.
!IFEND
SAVE OUTFILE='E:\Monte carlo testing\sample.sav'.
!LET !first='0'

!DOEND.
!DOEND.

VARIABLE LABEL ss 'Sample size'.
EXAMINE
VARIABLES=salary BY ss /PLOT=BOXPLOT/STATISTICS=NONE/NOTOTAL
/MISSING=REPORT.

!ENDDEFINE.

!sample myvar=VAR00001 nbsampl=200 size= 1 2 3 4 5 6 7 8 9 10 20 30 40 50 60 70 80 90 100 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T11:15:21.963

这有帮助吗？

```
AGGREGATE
 /OUTFILE=*
 /BREAK=samplenb
 /!myvar = MEAN(!myvar)
 /sd = STDEV(!myvar)
 /ss=FIRST(ss). 
```

# iis - 如何将 deployIisAppPath 指定到不是 DefaultWebSite 的站点根目录？

> ID：15234734
> 
> 赞同：10
> 
> 时间：2013-03-05T21:43:54.980
> 
> 标签：iis, tfs, msbuild, msdeploy

我有一个 ASP.NET MVC Web 应用程序项目，我想将它部署到我的 IIS 网络服务器。站点树是这样设置的：

```
SERVERNAME(myDomain\Username)
   Application Pools
   Sites
      Default Web Site
      MyProjectSite
         bin
         Content
         ...
         Views 
```

我正在尝试部署到 MyProject 站点。请参阅下面我使用的设置与我返回的错误。我显然没有正确指定我的站点路径，但对于我的生活，我无法弄清楚它应该是什么。

以下设置在迭代之间保持不变：

`/p:DeployOnBuild=True /p:DeployTarget=MsDeployPublish /p:CreatePackageOnPublish=False /p:MSDeployPublishMethod=WMSvc /p:AuthType=Basic /p:Username="myUserName" /p:Password="MyPassword" /p:AllowUntrustedCertificate=True`

# 将 SiteName/ 指定为 IISAppPath：

## 参数：

`/p:MsDeployServiceUrl="https://serverName:8172/MsDeploy.axd?Site=MyProjectSite" /p:DeployIisAppPath="MyProjectSite/"`

## 错误：

`Could not complete an operation with the specified provider ("createApp") when connecting using the Web Management Service`- 我不想创建新网站。我想同步已经存在的内容。

# 将 IISAppPath 指定为 Root（假设使用 URL 中的站点名称）

## 参数：

`/p:MsDeployServiceUrl="https://serverName:8172/MsDeploy.axd?Site=MyProjectSite" /p:DeployIisAppPath="/"`

## 错误：

`Could not complete an operation with the specified provider ("iisApp") when connecting using the Web Management Service`- 看起来它正在尝试访问默认网站或其他东西（我故意没有赋予自己权利）。

# 将 IISAppPath 指定为空字符串（假设使用 URL 中的站点名称）

## 参数：

`/p:MsDeployServiceUrl="https://serverName:8172/MsDeploy.axd?Site=MyProjectSite" /p:DeployIisAppPath=""`

## 错误：

`The "ConcatFullServiceUrlWithSiteName" task was not given a value for the required parameter "SiteAppName"`- 所以它将“”解释为实际上是一个空值，从而破坏了连接它的尝试。

# 在 URL 中不指定站点属性，但将 SiteName/ 指定为 IISAppPath

## 参数：

`/p:MsDeployServiceUrl="https://serverName:8172/MsDeploy.axd" /p:DeployIisAppPath="MyProjectSite/"`

## 错误：

`Could not complete an operation with the specified provider ("createApp") when connecting using the Web Management Service`

# 在 URL 中不指定站点属性，但将 SiteName 指定为 IISAppPath

## 参数：

`/p:MsDeployServiceUrl="https://serverName:8172/MsDeploy.axd" /p:DeployIisAppPath="MyProjectSite"`

## 错误：

`Could not complete an operation with the specified provider ("createApp") when connecting using the Web Management Service`

现在鉴于它在 SiteAppName 上运行连接，它必须将它与站点名称结合起来，是吗？你应该放什么来让网站同步到网站的根目录？

# 更新

为了找出正确的路径方案，我尝试使用 Visual Studio 2012 发布对话框进行发布。在这种情况下，我收到一条错误消息，指出请求超时（测试连接几乎可以立即工作，预览更改工作但需要几秒钟）。我检查了事件日志，wmsvc 的跟踪日志无济于事。即使将跟踪设置为详细，跟踪日志中也不会显示任何内容。我已尝试禁用两台计算机上的防火墙，但在这方面似乎也没有任何效果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T16:57:47.603

想出了这个。

问题源于项目属性的 Web 部署页面中的两个设置。我之前已经设置了这个项目（在调试配置中），只复制运行应用程序所需的文件，而不是构建一个 zip 包。但是，我忽略了对发布配置的这些设置做任何事情。

它尝试使用 createApp 的原因（置信度为 75%）是因为它是从它创建的 Zip 包进行部署的。所以在这些情况下我的 IISAppPath 设置很好，我只是部署了错误的东西。

我将`Create deployment package as a zip file`设置设置为 false，并将`Items to deploy`下拉菜单设置为仅运行此应用程序所需的文件，一切顺利。

顺便说一句，我发现（如上所述）您可以使用 Visual Studio 中的 Web 发布对话框输出的发布配置文件（不幸的是 2012 年；2010 年您必须做一些我不确定的按摩）。我命名我的没有空格，并提供密码作为参数以及不受信任的证书设置。现在 TFS 的构建定义中的 MSBuild 参数如下所示： `/p:DeployOnBuild=True;PublishProfile=NameOfPublishProfile /p:AllowUntrustedCertificate=True /p:Password=PleaseVerifyMe`

# objective-c - 在 Core Data 中更新数据库的方法

> ID：15234737
> 
> 赞同：2
> 
> 时间：2013-03-05T21:44:00.577
> 
> 标签：objective-c, xcode, core-data, nspredicate, nsfetchedresultscontroller

我有一种在卡上添加印章的方法，从二维码阅读器到网络服务，我的问题是，

这是我的代码：

```
- (void)addStamp
{    
    NSString *url = [_URL stringByAppendingString:@"add-stamp"];
    NSString *post = [NSString stringWithFormat:@"userId=%@&code=%@", self.userId, self.code ];
    post = [post stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    NSData *postData = [NSData dataWithBytes:[post UTF8String]
                                      length:[post lengthOfBytesUsingEncoding:NSUTF8StringEncoding]];

    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL 
    URLWithString:url] cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:600];

    [request setHTTPMethod:@"POST"];
    [request setHTTPBody:postData];
} 
```

现在我想用新方法更新我的数据库 - >如果代码重复添加戳，如果没有创建添加新卡：

```
-(void)addStampInDB:(int)cardId
{
    NSManagedObjectContext* managedObjectContext = [(AppDelegate*) [[UIApplication 
    sharedApplication] delegate] managedObjectContext];

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Card"
                                          inManagedObjectContext:managedObjectContext];
    [fetchRequest setEntity:entity];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"remote_id = %d", cardId];
    [fetchRequest setPredicate:predicate];
    [managedObjectContext lock];

    NSError *error;
    NSArray *fetchedObjects = [managedObjectContext executeFetchRequest:fetchRequest
    error:&error];
    [managedObjectContext unlock];

    Card *d = nil;
    if([fetchedObjects count] > 0 ){
        d = [fetchedObjects objectAtIndex:0];
        cardId++;

    } else{ 
        d = [NSEntityDescription insertNewObjectForEntityForName:@"Card" 
                                          inManagedObjectContext:managedObjectContext];
    }

    NSArray *test;
    for(NSDictionary *stamp in test)
    {   
        d.remote_id = [NSNumber numberWithInt:[[stamp objectForKey:@"id"] intValue]];
        d.stampNumber = [NSNumber numberWithInt:[[stamp objectForKey:@"stampNumber"] intValue]];
        d.createdAt = [NSDate dateWithTimeIntervalSince1970:[[stamp objectForKey:@"createdAt"] 
        intValue]];

        [managedObjectContext lock];
        NSError *error;
        if (![managedObjectContext save:&error])
        {
            NSLog(@"Whoops, couldn't save: %@", [error localizedDescription]);
            NSLog(@"Failed to save to data store: %@", [error localizedDescription]);
            NSArray* detailedErrors = [[error userInfo] objectForKey:NSDetailedErrorsKey];
            if(detailedErrors != nil && [detailedErrors count] > 0) {
                for(NSError* detailedError in detailedErrors) {
                    NSLog(@"  DetailedError: %@", [detailedError userInfo]);
                }
            } else {
                NSLog(@"  %@", [error userInfo]);
            }
        }
        [managedObjectContext unlock];
    }
} 
```

我不知道我的方法是否正确以及如何测试我的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:31:59.247

我不太确定您的问题，但我会尝试提供一些提示。

**第一的**

```
Card *d = nil;
if([fetchedObjects count] > 0 ){
    d = [fetchedObjects objectAtIndex:0];
    cardId++;

} else{ 
    d = [NSEntityDescription insertNewObjectForEntityForName:@"Card" 
                                      inManagedObjectContext:managedObjectContext];
} 
```

在这里你找到了一张现有的卡片，你使用它，否则你创建一个新的。问：那怎么`cardId`办？它在哪里使用？

**第二**

```
for(NSDictionary *stamp in test)
{   
    d.remote_id = [NSNumber numberWithInt:[[stamp objectForKey:@"id"] intValue]];
    d.stampNumber = [NSNumber numberWithInt:[[stamp objectForKey:@"stampNumber"] intValue]];
    d.createdAt = [NSDate dateWithTimeIntervalSince1970:[[stamp objectForKey:@"createdAt"] 
    intValue]];

    // other code here
} 
```

如果你循环，你每次都会`test`覆盖你的卡的价值。`d`这样对吗？

**第三**

```
for(NSDictionary *stamp in test)
{   
    // other code here
}

// save here 
```

将保存移出 for 循环。这可以提高您的应用程序的性能。不必在循环中每次都保存。只在最后做。

希望有帮助。

PS如果你想知道别的让我知道。

# php - 运行一个无限期的 PHP 脚本一小时。每小时重启一次

> ID：15234748
> 
> 赞同：0
> 
> 时间：2013-03-05T21:44:47.887
> 
> 标签：php, process, cron, restart

我编写了一个 PHP 脚本来从 Twitter firehose 中提取推文并将它们存储到数据库中。理想情况下，我只想让它运行，以便随着时间的推移收集推文，因此，它被包裹在一个`while(1)`循环中。

这似乎是有问题的，因为它正在超时。如果我只是在浏览器中运行它，它不会运行超过 30 秒，然后超时并给我一个 324 错误。

**问题：**有没有办法让它运行一段时间（20秒），自动杀死自己，然后重新启动？全部在 cron 工作中（PS...我不知道如何编写 cron 工作）？

**背景：**网站托管在 Godaddy 上。理想情况下希望在我的托管服务器上运行它。

**剧本：**

```
<?php
    $start = time();
    $expAddress = "HOSTNAME";
    $expUser = "USERNAME";
    $expPwd = "PASSWORD";
    $database = "DBNAME";

    $opts = array(
        'http' => array(
            'method'    =>  "POST",
            'content'   =>  'keywords,go,here',
        )
    );

    // Open connection to stream
    $db = mysql_connect($expAddress, $expUser, $expPwd);
    mysql_select_db($database, $db);

    $context = stream_context_create($opts);
    while (1) {
        $instream = fopen('https://USERNAME:PASSWORD@stream.twitter.com/1/statuses/filter.json','r' ,false, $context);
        while(! feof($instream)) {

             if(time() - $start > 5) { // break after 5 seconds
                break;
             }

            if(! ($line = stream_get_line($instream, 100000, "\n"))) {
                continue;
            }
            else {
                $tweet = json_decode($line);

                // Clean before storing             

                            // LOTS OF VARIABLES FOR BELOW...REMOVED FOR READABILITY

                // Send to database
                $ok = mysql_query("INSERT INTO tweets 
                    (created_at, from_user, from_user_id, latitude, longitude, tweet_id, language_code, 
                            place_name, profile_img_url, source, text, retweet_count, followers_count,
                            friends_count, listed_count, favorites_count) 
                    VALUES 
                    (NOW(), '$from_user', '$from_user_id', '$latitude', '$longitude', '$tweet_id', '$language_code', 
                            '$place_name', '$profile_img_url', '$source', '$text', '$retweet_count', '$followers_count',
                            '$friends_count', '$listed_count', '$favorites_count')");

                if (!$ok) { echo "Mysql Error: ".mysql_error(); }

                flush();
            }
        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:55:05.963

您可以让 cron 作业每分钟运行一次。

为此，请按照下列步骤操作：

1.  制作一个运行 PHP 代码的脚本，例如：

    ```
    #!/bin/bash
    wget myurl.com/blah > /dev/null 
    ```

    将其另存为`my-cron.sh`某个文件夹（如`/var`）

2.  将其添加到 cron。运行`crontab -e`请参阅[Cron 格式](http://en.wikipedia.org/wiki/Cron#Format)和[Crontab 用法](http://www.pantz.org/software/cron/croninfo.html)。例如，这将每分钟运行一次。

    ```
    # Minute   Hour   Day of Month   Month   Day of Week    Command    
        *        *          *          *          *         /var/my-cron.sh 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:00:09.303

如果我能满足您的需求，那么对您来说最好的办法是`cron job`让脚本无限期地运行并不是一个好主意。

作为其中一个评论中的说明符，您正在使用托管服务器**Godaddy**，因此您可能无法获得 shell 访问权限，**但**取决于您的 cPanel 版本，您可能能够创建和定义 cron 作业。

看到[这个链接](http://www.siteground.com/tutorials/cpanel/cron_jobs.htm)和这个[谷歌搜索](https://www.google.com/search?q=add+cronjob+from+cPanel&rlz=1C5CHFA_enMA503MA503&aq=f&oq=add+cronjob+from+cPanel&aqs=chrome.0.57j62.4798&sourceid=chrome&ie=UTF-8)

### 也许，如果您没有此选项并且您希望打开浏览器，我会建议以下

> 创建一个 html 页面作为客户端，它会每小时向你的 PHP 脚本发出一个 ajax 请求，就像这样你模拟一个 cron 作业函数

**ajax 请求代码可能看起来像（使用 jQuery）**

```
function makeRequest(){
    $.ajax({
        url: "http://yourhost/url-to-your-script.php",
        complete: function(data){
            setTimeout(function(){
                makeRequest();
            }, 60 * 60 * 1000); // Minutes * Seconds * MS
        }
    });
}
makeRequest(); 
```

我希望这有帮助

> ### 编辑
> 
> 这个[链接](http://docs.cpanel.net/twiki/bin/view/AllDocumentation/CpanelDocs/CronJobs)也可能有帮助
> 
> ***重要***不要忘记删除无限循环

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-26T05:21:18.970

```
I just had same issue.

Only cron job can do if you want run script off browser. You can set up cron job with free providers or you can set up cron job in windows's Scheduled tasks.

If your site has a good traffic then you can follow the option below that your users does the work for you.

In php you can find time in hour and seconds 
$time= date(' H:i:s');
create a table to track if the code was run.
eg; table column  name check with option 0 and 1;

select check from table.

    enter code here

if ($minute > 59)
{
if($check==0)
{
run your code
then update the table each time when it was run
eg; update table set check='1' 
}
}

then another if condition to reset your code
if(minute>0 && minute <1)
{
select check from your table.
if(check==1)
{
update table set check='0'
}
} 
```

# python - 无法在列表列表中找到值

> ID：15234753
> 
> 赞同：2
> 
> 时间：2013-03-05T21:45:12.073
> 
> 标签：python, list, python-2.7, loops

我有两个清单。第一个是`a_list`这样的：

```
a_list = [1,2,3] 
```

第二个是`b_list`，它是一个包含列表的列表。就像这样：

```
b_list = [['a',1,'b'],['c',2,'g'],['e',3,'5'] 
```

我想要做的是使用`a_list`找到正确的`b_list`并打印`value[2]`在`b_list`.

我的代码如下所示：

```
for a in a_list:
    for b in b_list:
        if b[1] == a:
            print b[2] 
```

实际上`a_list`有 136 个值。真实的`b_list`有 315 个列表。

我最初编写了代码来索引 b 项并将其从`b_list`if中删除`b[1] == a`。

为了解决真正的问题，我已经删除了该代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T21:51:04.500

无需循环`a_list`；一个简单的`in`测试就足够了：

```
for b in b_list:
    if b[1] in a_list:
        print b[2] 
```

如果你做`a_list`了一个集合，这会表现得更好：

```
a_set = set(a_list)

for b in b_list:
    if b[1] in a_set:
        print b[2] 
```

无论哪种方式，此代码都会打印：

```
b
g
5 
```

对于您的示例数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:09:43.310

如果我理解正确你想要做什么：

```
a_list = [1,2,3,5]

b_list = [['a',1,'b'],['c',2,'g'],['e',3,'5'],
          ['d',4,'h'],['Z',5,'X'],['m',6,'i']]

print 'a_list ==',a_list
print '\nb_list before :\n',b_list

print '\nEnumerating b_list in reversed order :'
L = len(b_list)
print ('  i       el          L-i  b_list[L-i]  \n'
       '  -------------------------------------')
for i,el in enumerate(b_list[::-1],1):
    print '  %d  %r     %d  %r' % (i,el,L-i,b_list[L-i])

L = len(b_list)
for i,el in enumerate(b_list[::-1],1):
    if el[1] in a_list:
        del b_list[L-i]

print  '\nb_list after :\n',b_list 
```

结果

```
a_list == [1, 2, 3, 5]

b_list before :
[['a', 1, 'b'], ['c', 2, 'g'], ['e', 3, '5'],
 ['d', 4, 'h'], ['Z', 5, 'X'], ['m', 6, 'i']]

Enumerating b_list in reversed order :
  i       el          L-i  b_list[L-i]  
  -------------------------------------
  1  ['m', 6, 'i']     5  ['m', 6, 'i']
  2  ['Z', 5, 'X']     4  ['Z', 5, 'X']
  3  ['d', 4, 'h']     3  ['d', 4, 'h']
  4  ['e', 3, '5']     2  ['e', 3, '5']
  5  ['c', 2, 'g']     1  ['c', 2, 'g']
  6  ['a', 1, 'b']     0  ['a', 1, 'b']

b_list after :
[['d', 4, 'h'], ['m', 6, 'i']] 
```

**需要以相反的顺序迭代 b_list**的原因是*abarnert*所说的，并由 doc 解释：

> 注意：当序列被循环修改时有一个微妙之处（这只会发生在可变序列，即列表中）。内部计数器用于跟踪接下来使用哪个项目，并在每次迭代时递增。当此计数器达到序列的长度时，循环终止。这意味着如果套件从序列中删除当前（或前一个）项目，则将跳过下一个项目（因为它获取已处理的当前项目的索引）。同样，如果套件在当前项目之前插入序列中的项目，则当前项目将在下一次循环中再次被处理。这可能会导致讨厌的错误，可以通过使用整个序列的切片制作临时副本来避免这些错误，例如，
> 
> 对于 a[:] 中的 x：
> 如果 x < 0：a.remove(x)
> 
> [http://docs.python.org/2/reference/compound_stmts.html#the-for-statement](http://docs.python.org/2/reference/compound_stmts.html#the-for-statement)

# jquery - 将固定列宽设置为 JQGrid

> ID：15234754
> 
> 赞同：4
> 
> 时间：2013-03-05T21:45:13.023
> 
> 标签：jquery, css, jqgrid

有没有办法为 Jqgrid 设置固定的列宽和高度。

我将 jqgrid css 更改为

```
.ui-jqgrid tr.jqgrow td {vertical-align:text-top;font-weight: normal; overflow: hidden; white-space:pre-wrap; height: 20px !important;padding: 0 2px 0 2px;border-bottom-width: 1px; border-bottom-color: inherit; border-bottom-style: solid;} 
```

但这并没有将高度设置为 20px。

我还需要将所有行设置为特定的高度，如果大小超过列的大小，列中的数据应该被切断，并且悬停在列上应该显示整个数据。

下面是我的 colName 和 model

```
ColNameData = ['Date', 'Fund', 'Partner', 'Menu', 'Sub Menu', 'Document Name', 'Document Description', 'Type', 'ID'];
                     ColModelData = [{ name: 'MessageDate',
                         align: 'right',
                         sorttype: 'date',
                         datefmt: 'm/d/Y',
                         width :10,resizable:false
                          },
                                    { name: 'Fund', align: 'left',width : 8, resizable:false},
                                    { name: 'Partner', align: 'left',width : 7,resizable:false },
                                    { name: 'Menu', align: 'left',width : 9,resizable:false },
                                    { name: 'SubMenu', align: 'left',width : 9,resizable:false},
                                    { name: 'Documentname', align: 'left',width : 35,resizable:false },
                                    { name: 'DocumentDescription', align: 'left',width : 35,resizable:false },
                                    { name: 'Type', align: 'left',width : 5,resizable:false},
                                    { name: 'ID', hidden: true, resizable: false }
                                   ]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T04:07:56.963

在`jqgrid`属性中，您会发现 jqgrid 的宽度和高度可以通过属性设置`width`，`height`如下[所示](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions)。这同样适用于 jqgrid 的每一行。

```
{ name: 'Fund', align: 'left',width : 8, height:20, resizable:false} 
```

上面的行将把这个单元格的高度设置为`20 px`。因此您可以设置`height`所有列的参数以确保行的高度为`20 px`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-27T06:14:13.143

这对我来说非常好（在呈现 jqgrid 后调用）

```
function reDefineColWidth(){
    var columnWidths = '65px|88px|175px|140px|200px|75px|140px|150px|130px|220px|125px|230px|200px|111px'
    var widthsArr = columnWidths.split('|');
    for(var j=0; j < widthsArr.length ; j++ ){
        $('.ui-jqgrid-labels > th:eq('+j+')').css('width',widthsArr[j]); // will set the column header widths
        $('#grid tr').find('td:eq('+j+')').each(function(){$(this).css('width',widthsArr[j]);}) // will set the column widths
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-10T10:51:56.277

您可以使用 colModel 中的固定选项

```
fixed: true 
```

列的属性（请参阅[文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acolmodel_options)）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-22T11:48:06.363

归功于 neel 和 Ajo。在 jqGrid 4.5.4 中，我发现当整个网格的 autowidth 设置为 true 时，在 colModel 中的列上应用 resizable 为 false 和 fixed 为 true 都有效。

```
{ name: 'fund', width: 8, height: 20, resizable: false, fixed: true } 
```

但无法确认未来的版本。

# sql - 将不同的数据存储在同一列中是一种好习惯 - SQL

> ID：15234756
> 
> 赞同：1
> 
> 时间：2013-03-05T21:45:21.547
> 
> 标签：sql

我目前有一个`Users`表，其中包含以下列：

1.  用户身份
2.  地址

目前我们将 IP 地址存储在`Address`列中。展望未来，我们需要存储一个 MAC 地址。将它们都存储在同一列中（两者都是`varchar`）并用另一列指示它是什么类型，`typeOfAddress int`用 1 或 2 指示地址类型，这是一个好习惯吗？或者我应该创建一个单独的可为空列（并将现有列更改为可为空）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:47:43.240

不，这不是好习惯。几十年前我被告知的第一件事是“计算机领域不应该用于多个目的”。否则，您原则上无法知道它的含义，除非您有另一个指标字段，您也可以将其用于其他值类型，并且您正在引入完全不必要的误解风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:48:38.713

绝对创建一个单独的可为空列。这将使您在此表上编写所有未来的 SQL 变得更加容易，并使所有内容总体上更易于维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:51:03.023

好吧，根据给出的信息，这取决于。

用户会同时拥有 IP 地址和 MAC 地址吗？如果是这样，您需要将这些记录放在与用户记录具有外键关系的单独表中。

检索呢？在检索有关用户的数据时，是否经常需要检索这些值？如果这样做，将它们存储在同一个表中并避免每次都进行表连接可能是有意义的。

我倾向于有两个单独的列，一个 for`IpAddress`和一个 for `MacAddress`。这样就可以清楚地知道哪一列中有哪些数据，而无需查找另一列来找出它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:47:51.307

推荐这种结构：

1.  用户身份
2.  地址类型
3.  地址

因为它在第三个NF。

在单个表中简单地使用多个列的缺点是：

*   每当过滤地址时需要记住“空句柄”
*   随着时间的推移，随着新地址类型的添加，该范式可能会超出意义；但是转换成本太高而无法考虑。

应添加带有 FK 关系的 AddressType 表，以防止意外输入看起来有效但实际上无效的 AddressType。

最重要的是，理论上，每个 AddressType 都有一个单独的表，在 UserId 上链接到用户表；但这对于所提出的问题确实看起来有点矫枉过正。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T21:49:08.743

如果您认为您不会添加更多不同类型的地址，我更喜欢有两列。我认为它在概念上更简单，查询也更简单。但是，如果您认为要添加更多类型的“地址”（无论可能是什么），那么拥有 5 或 6 个不同的列可能并不理想。在这种情况下，我会使用一个地址列和一个地址类型列，并创建一个定义地址类型的联结表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T21:52:11.737

不要创建新列，而是创建一个新表地址和地址类型，链接到这些：

```
Users
foreign key address_id

Address
id
value (varchar)
foreign key adress_type_id

AddressType
id
name (varchar) 
```

可能有点矫枉过正，但这是一种很好的标准化做法

# c# - 路径中有空格的 CMD 命令

> ID：15234758
> 
> 赞同：1
> 
> 时间：2013-03-05T21:45:22.717
> 
> 标签：c#, vb.net, cmd

我的命令中的空格有问题。我正在尝试运行 cmd 提示符并执行一个带有命令行参数的程序。在进程完成执行后，我需要 cmd 窗口保持打开状态。

我设法让它在另一段代码中工作，但这次我几乎可以肯定它与参数路径中的空格有关。如果我使用没有空格的路径，它工作正常。我试图转义引号，但要么我做错了，要么转义引号不起作用。

基本上，我需要使下面的行与空格一起使用，并在执行后保持 cmd 窗口打开......

```
 Dim ps As Process = System.Diagnostics.Process.Start("cmd /k", "C:\common\tools\tap.exe -f flash C:\Users\test project\Desktop\image.signed") 
```

我知道“测试”和“项目”之间的空间是问题，但我无法绕过它。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T21:46:51.267

将路径用双引号括起来，如下所示：

```
"C:\common\tools\tap.exe -f flash ""C:\Users\test project\Desktop\image.signed""" 
```

给你：

```
Dim ps As Process = System.Diagnostics.Process.Start ("cmd /k", "C:\common\tools\tap.exe -f flash ""C:\Users\test project\Desktop\image.signed""") 
```

# c# - 为什么更改 XML 模式并重新验证会导致内存泄漏？

> ID：15234762
> 
> 赞同：2
> 
> 时间：2013-03-05T21:45:37.977
> 
> 标签：c#, xml, memory-leaks, xsd

我最近在我为工作而维护的应用程序中发现了内存泄漏，我对为什么代码会产生泄漏感到困惑。我已经提取了相关代码（稍作修改）并在下面提供。

在我们的应用程序中，给定的 XML 文档可以针对一个或多个可用的模式文件进行验证。随着时间的推移，每个模式文件都对应于 XML 文档的不同版本。我们只关心 XML 文档是否针对至少一种模式进行验证。每个模式都完整地描述了 XML 文档的内容（它们不是嵌套的模式文件）。

根据 ANTS 内存分析器，看起来 XmlDocument 对象正在隐藏对先前模式的引用，即使在模式集已被清除之后也是如此。**注释掉对 Validate() 的调用，让其他所有内容保持不变，将阻止泄漏。**

我通过在应用程序初始化时加载模式**一次**并换出与 XML 文档相关联的模式文件，直到我们找到一个可以验证的模式来修复我们的应用程序中的泄漏。

下面的代码会产生内存泄漏，我不知道为什么。

```
class Program
{
    private static XmlDocument xmlDocument_ = new XmlDocument();

    static void Main(string[] args)
    {
        using (StreamReader reader = new StreamReader("contents.xml"))
        {
            xmlDocument_.LoadXml(reader.ReadToEnd());
        }

        XmlReaderSettings xmlReaderSettings = new XmlReaderSettings();
        xmlReaderSettings.CloseInput = true;

        while (true)
        {
            xmlDocument_.Schemas = new XmlSchemaSet();

            XmlReader xmlReader = XmlReader.Create("schema.xsd", xmlReaderSettings);

            xmlDocument_.Schemas.Add(XmlSchema.Read(xmlReader, null));

            xmlReader.Close();

            xmlDocument_.Validate(null);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T00:04:50.333

尝试如下更改`while`语句。我没有对此进行测试，但它与原始代码的不同之处在于每次`while`迭代都会处理`XmlReader`.

GC`XmlReader`最终可能会自动处理这些实例，但我对此表示怀疑，因为`XmlReader`实现了`IDispose`. 也就是说，使用的代码`XmlReader`必须确定性地处理它（垃圾收集是非确定性的）。如果 GC 能够处理它们，并且如果在`while`GC 执行此操作之前迭代数千次，那么所使用的内存无论如何都会杀死系统。

```
while (true)
{
    xmlDocument_.Schemas = new XmlSchemaSet();

    using (XmlReader xmlReader = XmlReader.Create("schema.xsd", xmlReaderSettings))
    {
        xmlDocument_.Schemas.Add(XmlSchema.Read(xmlReader, null));
    }

    xmlDocument_.Validate(null);
} 
```

**编辑：**

我阅读了上的[MSDN 页面`XmlDocument.Validate`](http://msdn.microsoft.com/en-us/library/ms162371%28v=vs.100%29.aspx)，它提供了一个以不同方式执行此操作的代码示例，`XmlReaderSettings`用于设置*验证选项*。此外，OP 中的代码假定 XML 文件始终编码为 UTF-8。这是检测文本编码并基于 MSDN 示例的重写；这*可能会*修复内存泄漏。此代码未经测试。

```
class Program
{
    private static XmlDocument xmlDocument_ = new XmlDocument();

    static void Main(string[] args)
    {
        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationType = ValidationType.Schema;
        settings.CloseInput = true;

        xmlDocument_.Load(XmlReader.Create("contents.xml", settings));

        while (true)
        {
            settings.Schemas = new XmlSchemaSet();
            settings.Schemas.Add(null, "schema.xsd");

            xmlDocument_.Validate(null);
        }
    }
} 
```

你可以试试 ILDASM 看看里面有什么`XmlDocument.Validate`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T03:33:30.923

您有*内存泄漏*，因为您的 XmlDocument 引用是静态的，并且因为[SchemaInfo](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.schemainfo.aspx)属性，当您验证您的 XML 时填充。由于这些属性包含对来自已编译 XSD 的对象的引用，因此只要您拥有 XmlDocument，您就可以拥有这些属性，这可能需要相当长的一段时间（因为它是静态的）。

有些人可能会争论这是否确实是泄漏：使用另一组 XSD 验证另一个 XML 将释放以前持有的资源。

# xcode - 在单独的类中处理方法

> ID：15234764
> 
> 赞同：2
> 
> 时间：2013-03-05T21:45:40.740
> 
> 标签：xcode, class, methods

在我的应用程序中，我经常在不同的类中使用相同的 void 方法。我不想在每个单独的类中编写 void 代码，但能够从单独的类中调用它，因为我经常需要更改其中的代码并且不想遍历每个类并单独更改它（最大限度地减少错误在代码中）。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:57:26.607

创建一个类并将方法作为类方法添加到它：

我的助手.h

```
@interface MyHelper : NSObject

+(void)utilityMethod;

... 
```

我的助手.m

```
@implementation

+(void)utilityMethod {

... 
```

然后可以参考类：

```
#include "MyHelper.h"

....

[MyHelper utilityMethod]; 
```

现在代码在一个地方，可以通过包含 .h 文件添加到任何你想要的地方

# scala - 在 Play 2.1 (scala) 中设置自定义响应标头

> ID：15234765
> 
> 赞同：2
> 
> 时间：2013-03-05T21:45:44.510
> 
> 标签：scala, playframework, http-headers, playframework-2.0

我知道[在 Play 2.0 (scala) 中设置 HTTP 标头吗？](https://stackoverflow.com/questions/8199490/setting-http-headers-in-play-2-0-scala)

但是如何像`X-Hello-World`在播放框架中一样设置自定义响应标头？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T22:01:08.750

只是：

```
Ok
  .withHeaders("X-Hello-World" -> "it's me") 
```

# ios - 在 Xcode Simulator 中切换“颜色混合图层”的快捷方式是什么？

> ID：15234769
> 
> 赞同：1
> 
> 时间：2013-03-05T21:45:50.840
> 
> 标签：ios, xcode, simulator

我发现切换“慢速动画”的快捷方式可以通过按三下 Shift 来完成。（不知道为什么没有列出来）

我想知道是否有人知道 iOS 模拟器是否有“颜色混合图层”选项的切换快捷方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:56:05.793

您可以为此创建自定义系统范围的快捷方式：

1.  打开系统偏好设置
2.  转到“键盘”
3.  选择“键盘快捷键”区域
4.  选择“应用程序快捷方式”部分
5.  单击“+”添加新的快捷方式
6.  输入名称为“Color Blended Layers”（名称**区分**大小写）
7.  选择一个键和弦来切换行为（我使用 Ctrl+Shift+L）

它应该立即开始工作；无需重新启动 Xcode 或模拟器。如果配置正确，您选择的组合键现在将出现在“颜色混合图层”菜单项旁边的“模拟器调试”菜单中。

# facebook-opengraph - G+ 不接受我的 og:image

> ID：15234775
> 
> 赞同：2
> 
> 时间：2013-03-05T21:46:09.140
> 
> 标签：facebook-opengraph, meta-tags

我似乎无法弄清楚为什么 G+ 没有在我的页面上显示照片[http://cruiser.mototribe.com/photo/march-contest](http://cruiser.mototribe.com/photo/march-contest)

它具有适当的元标记：

```
<meta property="og:image" content="http://cruiser.mototribe.com/sites/default/files/styles/large/public/photos/new/bikeer%2520pose.jpg" /> 
```

测试工具确认 og:image 标签 [http://www.google.com/webmasters/tools/richsnippets?url=http://cruiser.mototribe.com/photo/march-contest](http://www.google.com/webmasters/tools/richsnippets?url=http://cruiser.mototribe.com/photo/march-contest)

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T10:26:50.637

从[https://developers.google.com/+/web/snippet/](https://developers.google.com/+/web/snippet/)谷歌通知：

> +Snippet 中不包含太小或不够方形的图像，即使这些图像被 schema.org 微数据或 Open Graph 标记明确引用。具体来说，高度必须至少为 120px，如果宽度小于 100px，则纵横比不得大于 3.0。

我认为您的图像具有足够的高度和宽度，但应注意纵横比。

另一个信息：我没有在我的 webmastertool 帐户中看到该图像。

# asp.net - 无法访问已关闭的文件

> ID：15234776
> 
> 赞同：6
> 
> 时间：2013-03-05T21:46:11.167
> 
> 标签：asp.net, file-upload

我有一个 ASP.NET FileUpload 控件，它在我部署之前可以正常工作。然后它工作正常，除非文件超过〜55kb。我认为这与回发有关，我必须将其放入会话变量中。不过，它适用于小文件。

是否可能限制会话变量的大小？但是从我的 IDE 运行时它可以工作，所以不确定。

System.ObjectDisposedException：无法访问已关闭的文件

感谢任何线索。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T12:23:16.367

这可以通过在 web.config 中提供 DiskBufferSize 来解决：

```
<system.web>
    <httpRuntime executionTimeout="90" maxRequestLength="20000" useFullyQualifiedRedirectUrl="false" requestLengthDiskThreshold="8192"/>
</system.web> 
```

per[无法访问已关闭的文件](http://forums.asp.net/t/1397944.aspx/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-01T20:17:28.850

我对此进行了一些测试，似乎设置 DiskBufferSize 通过禁用缓冲来解决问题。现在计算机将使用更多内存。现在缓冲被有效禁用。并且您从中获得的性能提升已经消失了。

我认为正确的解决方案是使用 SaveAs 方法将发布的文件保存到 FIRST 回发的临时文件夹中，并将文件路径存储到视图状态或会话中的临时文件。

在任何额外的回发或重定向之后，特别是在涉及异步线程的情况下，如果需要缓冲，SaveAs 函数将不起作用；您将收到错误“无法访问已关闭的文件”。

我不知道您在“会话变量”中放了什么，但我猜这是文件控制，这就是问题所在。

这解决了我的问题，以防其他人遇到此问题但不想禁用缓冲。

# android - 如何阻止android杀死我的守护进程

> ID：15234778
> 
> 赞同：3
> 
> 时间：2013-03-05T21:46:16.107
> 
> 标签：android, out-of-memory

我的 Android“智能电视盒”附有一个磁盘，我在其中安装了一个小型 Debian 发行版，运行各种服务器进程（ntp、mpd、lighttpd、...）。问题是，即使我有足够的交换空间，当有很多活动时（即当机器交换更多时），我的一些守护程序往往会“死亡”。我不知道根本原因是什么，但听起来可能是某种 Android OOM 系统决定最好杀死这些进程（大概是因为它是在假设没有交换的情况下进行调整的）。

我如何验证确实如此？

如果是这种情况，即使交换空间仍有足够的空间，我还能阻止内核杀死进程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T02:33:51.133

您可以调整内存杀手写入到`/sys/module/lowmemorykiller/parameters`. 作为内核杀手，我认为它不会区分 android 或本机进程，但我可能错了。

更详细的信息可以在[这里找到](http://forum.xda-developers.com/showthread.php?t=622666)

# c# - 如果存在则更新，否则插入会抛出我的 DAL

> ID：15234779
> 
> 赞同：2
> 
> 时间：2013-03-05T21:46:19.570
> 
> 标签：c#, tsql

如果记录存在，我正在尝试构建更新语句，否则插入新记录。我有一个可以使插入正常的 DAL，但现在我需要为现有案例添加更新。我有这个用于插入的工作代码：

```
 public static void saveArticle(DateTime mtime, int mid, string mname, double homeodds, double awayodds, double drawodds)
    {
       var culture = CultureInfo.GetCultureInfo("sv-SE");
       var dateTimeInfo = DateTimeFormatInfo.GetInstance(culture);
       var dateTime = DateTime.Today;

       int weekNumber = culture.Calendar.GetWeekOfYear(dateTime, dateTimeInfo.CalendarWeekRule, dateTimeInfo.FirstDayOfWeek);
       string mroundY = dateTime.Year.ToString();
       string mroundW = weekNumber.ToString();
       string mround = mroundY + mroundW;

       //Console.WriteLine(mround);

       SqlCommand saveArticle = new SqlCommand("Insert Into gameTB(mround, mtime, mid, mname, homeodds, awayodds, drawodds) VALUES (@mround,@mtime,@mid,@mname,@homeodds,@awayodds,@drawodds)");
       saveArticle.Parameters.Add("@mround", SqlDbType.Int).Value = mround;
       saveArticle.Parameters.Add("@mtime", SqlDbType.DateTime).Value = mtime;
       saveArticle.Parameters.Add("@mid", SqlDbType.Int).Value = mid;
       saveArticle.Parameters.Add("@mname", SqlDbType.VarChar, 255).Value = mname;
       saveArticle.Parameters.Add("@homeodds", SqlDbType.Float).Value = homeodds;
       saveArticle.Parameters.Add("@awayodds", SqlDbType.Float).Value = awayodds;
       saveArticle.Parameters.Add("@drawodds", SqlDbType.Float).Value = drawodds;

       DAL.ExecuteNonQuery(saveArticle);
    } 
```

[阅读此论坛帖子](https://stackoverflow.com/questions/9698568/if-exists-update-else-insert)后，我尝试添加 IF 语句，但它不适用于我使用的逻辑。

如何使用已有的 else insert 命令完成更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:13:04.533

基于这个[INSERT vs. UPDATE](https://stackoverflow.com/questions/9599709/insert-vs-update)我设法让它工作。我关注了一篇类似的文章，该文章留下了对我来说并不明显的基本想法。我以前试过这个，但我犯了一些大错误，所以我认为我偏离了轨道。这是我的工作代码；

```
 SqlCommand saveArticle = new SqlCommand("if Exists(Select 1 from gameTB where mround = @mround AND mid = @mid)\r\n" +
    "UPDATE gameTB SET homeodds = @homeodds, awayodds = @awayodds, drawodds = @drawodds Where mround = @mround AND mid=@mid\r\n" +
    "else\r\n" +
    "Insert Into gameTB(mround, mtime, mid, mname, homeodds, awayodds, drawodds) VALUES (@mround,@mtime,@mid,@mname,@homeodds,@awayodds,@drawodds)");

    saveArticle.Parameters.Add("@mround", SqlDbType.Int).Value = mround;
    saveArticle.Parameters.Add("@mtime", SqlDbType.DateTime).Value = mtime;
    saveArticle.Parameters.Add("@mid", SqlDbType.Int).Value = mid;
    saveArticle.Parameters.Add("@mname", SqlDbType.VarChar, 255).Value = mname;
    saveArticle.Parameters.Add("@homeodds", SqlDbType.Float).Value = homeodds;
    saveArticle.Parameters.Add("@awayodds", SqlDbType.Float).Value = awayodds;
    saveArticle.Parameters.Add("@drawodds", SqlDbType.Float).Value = drawodds;

    DAL.ExecuteNonQuery(saveArticle); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:12:13.390

这是一个 MS SQL 2012。我研究了 MERGE 命令，但不明白如何使用它。

我曾尝试这样做，但在尝试构建时收到很多错误，我猜我已经偏离轨道了，对吧？

```
 SqlCommand updateArticle = new SqlCommand("UPDATE gameTB SET homeodds = @homeodds, awayodds = @awayodds, drawodds = @drawodds Where mround = @mround AND mid=@mid");
    DAL.ExecuteNonQuery(updateArticle);
    if (@@rowcount = 0) Then
    SqlCommand saveArticle = new SqlCommand("Insert Into gameTB(mround, mtime, mid, mname, homeodds, awayodds, drawodds) VALUES (@mround,@mtime,@mid,@mname,@homeodds,@awayodds,@drawodds)");
    saveArticle.Parameters.Add("@mround", SqlDbType.Int).Value = mround;
    saveArticle.Parameters.Add("@mtime", SqlDbType.DateTime).Value = mtime;
    saveArticle.Parameters.Add("@mid", SqlDbType.Int).Value = mid;
    saveArticle.Parameters.Add("@mname", SqlDbType.VarChar, 255).Value = mname;
    saveArticle.Parameters.Add("@homeodds", SqlDbType.Float).Value = homeodds;
    saveArticle.Parameters.Add("@awayodds", SqlDbType.Float).Value = awayodds;
    saveArticle.Parameters.Add("@drawodds", SqlDbType.Float).Value = drawodds;
    DAL.ExecuteNonQuery(saveArticle);
    EndIf; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:57:24.480

假设您使用的是 SQL Server，您可以按如下方式重写您的命令

```
var saveArticle = new SqlCommand(@"UPDATE gameTB SET homeodds = @homeodds, awayodds = @awayodds, drawodds = @drawodds Where mround = @mround AND mid=@mid
if (@@rowcount = 0)
    Insert Into gameTB(mround, mtime, mid, mname, homeodds, awayodds, drawodds) VALUES (@mround,@mtime,@mid,@mname,@homeodds,@awayodds,@drawodds)"); 
```

`@@rowcount`包含受最后一条语句影响的记录数。因此，如果`update`成功，它将包含`1`并且`insert`不会被执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:28:59.287

如果你想使用 MERGE 只需像这样设置你的命令

```
SqlCommand saveArticle = new SqlCommand(@"
    MERGE INTO gametb AS target 
    using ( VALUES (@mround, 
          @mtime, 
          @mid, 
          @mname, 
          @homeodds, 
          @awayodds, 
          @drawodds ) ) AS source (mround, mtime, mid, mname, homeodds, awayodds, 
          drawodds) 
    ON ( source.mround = target.mround 
         AND source.mid = target.mid ) 
    WHEN matched THEN 
      UPDATE SET mtime = source.mtime, 
                 mname = source.mname, 
                 homeodds = source.homeodds, 
                 awayodds = source.awayodds, 
                 drawodds = source.drawodds 
    WHEN NOT matched THEN 
      INSERT (mround, 
              mtime, 
              mid, 
              mname, 
              homeodds, 
              awayodds, 
              drawodds ) 
      VALUES (source.mround, 
              source.mtime, 
              source.mid, 
              source.mname, 
              source.homeodds, 
              source.awayodds, 
              source.drawodds );"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T21:55:01.123

我看到你`mid`的代码中有 。如果这是`id`数据库中的记录并且您没有使用任何其他记录`id`（自动生成的记录），那么最简单的方法是在存在具有相同 ID 的记录时执行选择查询。如果选择查询返回一些东西，你应该更新，如果没有，则插入。

# vb.net - 如何用户 Response.Write 重定向到一个 url？

> ID：15234783
> 
> 赞同：1
> 
> 时间：2013-03-05T21:46:33.093
> 
> 标签：vb.net, redirect, response, response.redirect, response.write

我想在 VB.NET 中使用 Response.Write() 重定向到相对 URL。我正在使用以下代码：

## 编辑：

```
Response.Write(("account/msgbox.aspx?action=account&status=" & Convert.ToInt16(eAccountStatus).ToString))

Response.Write(("~/account/msgbox.aspx?action=account&status=" & Convert.ToInt16(eAccountStatus).ToString)) 
```

和

```
Response.Write(("/account/msgbox.aspx?action=account&status=" & Convert.ToInt16(eAccountStatus).ToString)) 
```

在我的情况下返回相同的值。

我的应用程序错误事件处理程序报告正在形成的 url 无效。

这是我得到的：

```
http://localhost:14154/~/http:/localhost:14154/account/msgbox.aspx?action=account&status=6 
```

而不是这个

```
http:/localhost:14154/account/msgbox.aspx?action=account&status=6 
```

Response.Write() 之前的 Response.Clear() 什么都不做。

**在整个项目使用 Response.Write() 之前，我现在不能使用/切换到 Response.Redirect(** ) 并且选择使用 Response.Redirect() 将使所有在 Response.Write 调用之后编写的代码都变得无用。

我只需要清除以某种方式附加的基本 url。请让我知道如何实现这一目标。

谢谢。

**PS：**此代码以前运行良好。一些开发人员进行了更改，现在 Response.Write() 不会导致上述重定向。

## 编辑

堆栈跟踪：

> System.Web.HttpException (0x80004005)：文件“/~/account/msgbox.aspx”不存在。在 System.Web.UI.Util.CheckVirtualFileExists(VirtualPath virtualPath) 在 System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) 在 System.Web.Compilation。 BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) 在 System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean throwIfNotFound) 在 System .Web.Compilation.BuildManager。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:00:24.860

好的，我用这个解决了这个问题。虽然我仍然需要了解这是如何工作的。但无论如何，我将它发布给遇到类似问题的任何人。

这是我的新代码。

```
Response.Write(("../account/msgbox.aspx?action=account&status=" & Convert.ToInt16(eAccountStatus).ToString)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:52:20.637

看起来设置 baseUrl 的代码设置了两次。如果你找不到，你可以把这段代码拼凑到它上面：

```
Response.Write((baseUrl.replace("http://localhost:14154/~/http:/localhost:14154/", _
    "http://localhost:14154/") & "account/msgbox.aspx?action=account&status=" & _ 
    Convert.ToInt16(eAccountStatus).ToString)) 
```

您最好在原点（设置 baseUrl 的位置）修复它。

# javascript - XMLHttpRequest - 如何捕获返回 HTML 错误页面而不是数据的情况

> ID：15234784
> 
> 赞同：0
> 
> 时间：2013-03-05T21:46:43.147
> 
> 标签：javascript, xmlhttprequest, http-status-code-404

Javascript：使用 XMLHttpRequest 获取少量数据，这些数据由网络服务器上的特定 php 例程回显给它。与回调函数异步。或同步，没有任何可能性。

如果 php 文件不存在或无法访问，则会出现问题。responseText 属性不是返回错误标志，而是返回服务器 404 错误页面的 HTML 内容。

404 页面内容因服务器而异，因此几乎不可能通过任何字符串测试来捕获这种情况。有什么方法可以标记发生错误并返回 null 的事实吗？

```
 // envvars is set previously
 AjaxRequest.open('post','handler.php?nocache='+nocache,true);
 AjaxRequest.setRequestHeader("User-Agent",'Firefox');
 AjaxRequest.onreadystatechange = aCallback;
 AjaxRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
 AjaxRequest.setRequestHeader("Content-length", envvars.length);
 AjaxRequest.setRequestHeader("Connection", "close");
 AjaxRequest.send(envvars);
}

function aCallback() {
 if(AjaxRequest.readyState == 4){
   var response = AjaxRequest.responseText;
   if(response == 0){
     // It is useless to test for failure here because a complete 404 page is returned, 
     // instead of a null or -1 response. 
     document.ajax.response.value="Fail";   
    } else {
     document.ajax.response.value=response;   
   }
 }
}

// handler.php:
if ($_POST["request"]=="countbananas"):
  echo "bananas=43" ;
endif; 
```

ps 我知道会提到 jQuery，但我宁愿避免这条路线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:53:29.583

您可以读取对象的[`status`属性`XMLHttpRequest`](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#status)以获取 HTTP 响应代码：

```
function aCallback() {
 if(AjaxRequest.readyState == 4){
   if(AjaxRequest.status !== 200){
     // something went wrong
     document.ajax.response.value="Fail";   
    } else {
     var response = AjaxRequest.responseText;
     document.ajax.response.value=response;   
   }
 }
} 
```

这当然假设您的源返回正确的 HTTP 代码，例如“404 文件未找到”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:53:45.277

不能使用XMLHttpRequest 返回的[HTTP 状态码吗？](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

```
if ( AjaxRequest.status + "" == "404" ) {
  // Error page
} 
```

或者：

```
// 4xx status code
if ( (AjaxRequest.status + "").substr(0,1) == "4" ) {
  // Error page
} 
```

# sqlalchemy - SqlAlchemy：进行裸存在查询的正确方法

> ID：15234786
> 
> 赞同：0
> 
> 时间：2013-03-05T21:46:45.880
> 
> 标签：sqlalchemy, exists, turbogears

我有以下构造，它似乎产生了所需的 SQL：

```
>>> print session.query(exists('1').where(MyTable.name=='x'))
SELECT EXISTS (SELECT 1 
FROM my_table
WHERE my_table.name = :name_1) AS anon_1 
```

但是，当我尝试使用它执行它时，`.scalar()`它`.all()`会返回错误：

`*** UnboundExecutionError: Could not locate a bind configured on SQL expression or this Session`

如何为这个简单的查询绑定它？我不想这样做`bool(MyTable.query.filter(MyTable.name=='x').first())`，因为这会浪费地从表中拉回整行。

* * *

更新：

我也试过：

```
>>> session.connection(mapper=MyTable).execute(
        exists('1').where(MyTable.name=='x'))
StatementError: Not an executable clause 'EXISTS \
  (SELECT 1 \nFROM my_table \nWHERE my_table.name = %(name_1)s)' [] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T19:32:19.247

明白了，我认为：

```
>>> session.connection(mapper=MyTable).execute(
      select([exists('1').where(MyTable.name=='x')])) 
```

# database - 用于调度通知的数据库（可能存储在 RAM 中 - radis、memcashedb）

> ID：15234801
> 
> 赞同：0
> 
> 时间：2013-03-05T21:47:40.597
> 
> 标签：database, notifications, redis, scheduling, memcachedb

我有很多数据类型——日期时间、电子邮件、数据——用于发送通知。

如果我使用普通数据库，我需要通过每秒调查一次来轮询数据库。

请帮助我选择架构。

我想将这些数据存储在 RAM 中 - 可能是 redis 或 memcashedb

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T13:21:12.267

rabbitmq - 是实现高级消息队列协议（AMQP）标准的开源消息代理软件（即面向消息的中间件）

# php - 嵌套关联的数据结构

> ID：15234802
> 
> 赞同：0
> 
> 时间：2013-03-05T21:47:43.030
> 
> 标签：php, algorithm, data-structures, nested, nested-loops

首先，请不要激怒我，因为我是编程和 PHP 新手。我是一名学生，试图走出教室里舒适的基础，开始我的第一个项目。我进行了搜索，我的问题是我什至不知道如何表达我正在寻找的内容，并且很好奇我是否忽略了一个简单的解决方案。我已尝试搜索我认为与此问题相关的“嵌套”或“树”的所有变体，但在找到可以回答我的问题的内容时遇到问题。

我试图在嵌套树中列出其他成员推荐的成员，即如果约翰赞助了玛丽、迈克和汤姆，迈克赞助了梅根和苏珊，苏珊赞助了贝蒂和米歇尔，我希望能够显示如下内容：

1.  约翰
    *   玛丽
    *   麦克风
        *   梅根
        *   苏珊
            *   贝蒂
            *   米歇尔
    *   汤姆

我希望能够指定要搜索的深度，例如，如果需要，我只需要显示 5 层深度。为此，我想了一个`for (i=0;i<=4;i++)`

```
$query = "SELECT fname, lname, user_id FROM USER WHERE sponsor_id = (SELECT user_id FROM USER WHERE username = '$_SESSION[username]')";
$result = mysqli_query($con, $query); 

while ($row = mysqli_fetch_row($result)) {
  echo "<ul><li>$row[0] $row[1]</li>";
  $subquery = "SELECT fname, lname, user_id FROM USER WHERE sponsor_id = '$row[2]'";
  $subresult = mysqli_query($con, $subquery);
  while ($row2 = mysqli_fetch_row($subresult)) {
    echo "<ul><li>$row2[0] $row2[1]</li></ul>";
  }     
} 
```

这是我最后一次尝试找出不完全有效的一般所需结构。如果我想继续加深并进一步嵌套，我很确定我可以在任何所需的级别上完成这项工作，但是如果我想返回 100 个级别怎么办......似乎有一个简单的结构，我只是忽略了。

任何指导将不胜感激，如果您知道如何搜索我正在寻找的内容，甚至可以提供帮助解释这一点的链接，我将很乐意阅读和学习自己，谢谢！

* * *

在阅读了大家的评论并进行了大量搜索后，我找到了答案。我正在寻找的是邻接表或闭包表。我在这方面找到的最佳信息位于[http://www.slideshare.net/billkarwin/models-for-hierarchical-data](http://www.slideshare.net/billkarwin/models-for-hierarchical-data)。谢谢大家的信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:42:18.863

您需要的通常称为`B+ tree`. 每个节点都有孩子，但孩子的数量没有预设。因此，一个节点可能有 5 个子节点，而另一个节点可能有 3 个子节点，而另一个节点可能有 1 个子节点。要了解什么`not preset`意思，请与`n-ary tree`. An`n-ary tree`是一棵树，其中每个节点的子节点数是已知的（即预设）。例如，`Bin-ary`表示每个节点有两个孩子。在您的情况下，您可以决定使用`n-ary`树，这意味着您将使用预设大小的子数组。您的结构可能最终变得稀疏。如果发生这种情况，请更改为`B+`使每个子数组都有自己的大小。

请注意，您不需要为此绘制图表，因为每个人可能只有一位赞助商（即一位家长）。

# ios - IOS后台播放M4V

> ID：15234805
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:47:47.077
> 
> 标签：ios, objective-c, uikit, mpmovieplayercontroller, avfoundation

我试图弄清楚是否可以在背景中播放 m4v 文件，并使用覆盖在视频顶部的按钮？该视频基本上是一个动画（没有声音），但我需要能够在动画之上添加额外的导航，以便在应用程序中引入其他呼叫。

那有可能吗？如果是这样，需要什么电话？我试过四处寻找，但还没有找到答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:15:08.510

您可以使用 MPMoviePlayerController，将控件样式设置为无，并在其上放置您自己的按钮。

[http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMoviePlayerController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMoviePlayerController_Class/Reference/Reference.html)

# gem - 无法安装 pg gem

> ID：15234810
> 
> 赞同：5
> 
> 时间：2013-03-05T21:48:21.143
> 
> 标签：gem, bundler, pg

在花了几个小时试图弄清楚它为什么不起作用之后，我终于设法安装了“pg”gem ......

最后我进入了`sudo env ARCHFLAGS="-arch x86_64" gem install pg -v 0.12.2 -- --with-pg-config=/Applications/Postgres.app/Contents/MacOS/bin/pg_config`它就像一个魅力。但是现在我在尝试 bundler 时仍然遇到同样的错误 - 所以我想我并没有真正解决问题？无论如何，这里`bundle install`是说：

```
 Installing pg (0.12.2) 
    Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

            /Users/thomas/.rvm/rubies/ruby-1.9.3-p392/bin/ruby extconf.rb --with-pg-config=/usr/pgsql-9.2/bin/pg_config
    Using config values from /usr/pgsql-9.2/bin/pg_config
    sh: /usr/pgsql-9.2/bin/pg_config: No such file or directory
    sh: /usr/pgsql-9.2/bin/pg_config: No such file or directory
    checking for libpq-fe.h... yes
    checking for libpq/libpq-fs.h... yes
    checking for PQconnectdb() in -lpq... yes
    checking for PQconnectionUsedPassword()... yes
    checking for PQisthreadsafe()... yes
    checking for PQprepare()... yes
    checking for PQexecParams()... yes
    checking for PQescapeString()... yes
    checking for PQescapeStringConn()... yes
    checking for PQgetCancel()... yes
    checking for lo_create()... yes
    checking for pg_encoding_to_char()... yes
    checking for PQsetClientEncoding()... yes
    checking for rb_encdb_alias()... yes
    checking for rb_enc_alias()... yes
    checking for struct pgNotify.extra in libpq-fe.h... yes
    checking for unistd.h... yes
    checking for ruby/st.h... yes
    creating extconf.h
    creating Makefile

make
    compiling compat.c
    compiling pg.c
    pg.c: In function ‘pgconn_wait_for_notify’:
    pg.c:2117: warning: ‘rb_thread_select’ is deprecated (declared at /Users/thomas/.rvm/rubies/ruby-1.9.3-p392/include/ruby-1.9.1/ruby/intern.h:380)
    pg.c: In function ‘pgconn_block’:
    pg.c:2592: warning: format not a string literal and no format arguments
    pg.c:2598: warning: ‘rb_thread_select’ is deprecated (declared at /Users/thomas/.rvm/rubies/ruby-1.9.3-p392/include/ruby-1.9.1/ruby/intern.h:380)
    pg.c:2607: warning: format not a string literal and no format arguments
    linking shared-object pg_ext.bundle
    ld: warning: directory not found for option '-L-Wl,-undefined,dynamic_lookup'
    Undefined symbols for architecture x86_64:

....

    ld: symbol(s) not found for architecture x86_64
    collect2: ld returned 1 exit status
    make: *** [pg_ext.bundle] Error 1 
```

我认为问题在于捆绑器尝试使用来自另一个 postresql 安装（我已删除）的 pg_config 安装 gem。有什么方法可以确保捆绑器使用正确的路径？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-12-26T07:05:55.257

我被困在我的捆绑安装上 3 天。尝试了一切，比如添加 env ARCHFLAGS="-arch x86_64" gem install pg -- --with-pg-config=/usr/local/Cellar/postgresql/9.3.5_1/bin/pg_config

我能够看到在这个命令之后安装了 pg gem，但它仍然没有从 bundle install 安装，这很痛苦，因为我不知道在 Gemfile 中写什么，除了 gem 'pg'

最终对我有用的是发现我的 pg_config 在 /Library/PostgreSQL/9.3/bin/pg_config 中，默认情况下 Gemfile 包安装在 /usr/local/bin/pg_config

我刚刚运行了以下命令，神奇的事情发生了。**捆绑配置 build.pg --with-pg-config=/Library/PostgreSQL/9.3/bin/pg_config**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-21T19:06:51.643

一些修正。对于那些使用自制软件安装了 postgres 的人。

1）在您的 ~/.bash_profile 中写入以下行

**出口 ARCHFLAGS="-arch x86_64"**

2）重启控制台

3）执行以下命令

**bundle config build.pg --with-pg-config=/usr/local/Cellar/postgresql/9.3.5_1/bin/pg_config** （这必须是您的 pg 配置地址，可能因 postgres 的版本而异）

4）通过运行此命令在本地安装一次pg

**sudo env ARCHFLAGS="-arch x86_64" gem install pg --with-pg-config=/usr/local/Cellar/postgresql/9.3.5_1/bin/pg_config**

5)**捆绑安装**

# forms - Delphi2006 - 如何在 DLL 中为线程中的新窗口创建消息泵？

> ID：15234811
> 
> 赞同：1
> 
> 时间：2013-03-05T21:48:23.713
> 
> 标签：forms, delphi, dll, messaging, delphi-2006

我有加载我的自定义 dll 的多线程应用程序。
在这个 dll 中，我需要创建一个窗口。
我正在通过创建新线程来做到这一点，并在其中尝试创建此窗口，但是我收到错误消息告诉我：`EInvalidOperation - Canvas does not allow drawing`。

通过在网上搜索，我发现我需要为该线程定制消息泵。
所以，我的问题是，如何正确地做到这一点？

我现在要做的是：
- 外部应用程序正在加载 dll
- 比单独线程中的这个应用程序`Init`从 dll 调用函数
-`Init`函数创建线程
-`TMyThread`声明为：

```
type
  TMyThread = class(TThread)
  private
    Form: TMyForm;
    FParentHWnd: HWND;
    FRunning: Boolean;
  protected
    procedure Execute; override;
  public
    constructor Create(parent_hwnd: HWND); reintroduce;
  end;

constructor TMyThread.Create(parent_hwnd: HWND);
begin
  inherited Create(False); // run after create
  FreeOnTerminate:=True;
  FParentHWnd:=parent_hwnd;
  FRunning:=False;
end;

procedure TMyThread.Execute;
var
  parent_hwnd: HWND;
  Msg: TMsg;
  XRunning: LongInt;
begin
  if not Terminated then begin
    try
      try
        parent_hwnd:=FParentHWnd;

        Form:=TMyForm.Create(nil); // <-- here is error
        Form.Show;

        FRunning:=True;

        while FRunning do begin
          if PeekMessage(Msg, 0, 0, 0, PM_NOREMOVE) then begin
            if Msg.Message <> WM_QUIT then
              Application.ProcessMessages
            else
              break;
          end;
          Sleep(1);
          XRunning:=GetProp(parent_hwnd, 'XFormRunning');
          if XRunning = 0 then
            FRunning:=False;
        end;
      except
        HandleException; // madExcept
      end;
    finally
      Terminate;
    end;
  end;
end; 
```

`EInvalidOperation - Canvas does not allow drawing`在线程到达我现有的消息泵代码之前触发 异常。

我做错了什么或使它起作用的正确方法是什么？
谢谢你的帮助。

* * *

要在 DLL 中创建第二个 GUI 线程，我必须完全按照标准应用程序中的方式进行操作。
谁能证实我的想法？

在 DLL`begin...end.`部分，我这样做：

```
begin
  Application.CreateForm(THiddenForm, HiddenForm);
  Application.Run;
end. 
```

在`TMyThread.Execute`我必须做的：

```
procedure TMyThread.Execute;
begin
  if not Terminated then begin
    try
      try
        Application.CreateForm(TMyForm, Form);

        ???? how to make a thread that has remained in this place until you close this window ???
      except
        HandleException; // madExcept
      end;
    finally
      Terminate;
    end;
  end;
end; 
```

这是正确的方法吗？会不会这么简单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T13:03:29.177

在线程中运行消息队列的最简单方法如下：

```
procedure PerformThreadLoop;
var
  Msg: TMsg;
begin
  while GetMessage(Msg, 0, 0, 0) and not Terminated do begin
    Try
      TranslateMessage(Msg);
      DispatchMessage(Msg);
    Except
      Application.HandleException(Self);
    End;
  end;
end; 
```

在你的线程过程中看起来像这样：

```
procedure TMyThread.Execute
begin
  InitialiseWindows;
  PerformThreadLoop;
end; 
```

话虽如此，你正在尝试的东西是行不通的。您似乎试图在远离主线程的地方使用 VCL 组件。这是明确不允许的。VCL 的线程模型规定所有 VCL 代码都在主线程上运行。您在远离主线程的地方创建 VCL 表单的尝试注定要失败。

* * *

我会质疑您创建新线程的愿望。Delphi DLL 可以显示 VCL 表单，前提是它在加载和调用 DLL 的线程之外运行这些表单。您可以`Show`从该线程调用并显示无模式表单。这意味着您依赖主机应用程序的消息队列将消息传递到您的窗口。总的来说，这可以发挥作用。如果您的表单是模态的，那么您可以简单地调用`ShowModal`，该表单将由标准的 Delphi 模态消息循环提供服务。

所以我给你的建议是把你所有的 GUI 都保存在主机应用程序的 GUI 线程中。如果您的 DLL 预计会显示 GUI，并且还预计会远离主机应用程序的 GUI 线程，那么您就有麻烦了。但我认为这种情况不太可能发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T16:33:48.147

早些时候（一年前）我说过：`"To create second GUI thread in a DLL, I must do things exactly as in standard application"`.

这是`exactly`每个正在寻找此解决方案的人都应该做的事情。
让我一步一步解释：

1.  我们必须将我们的应用程序对象添加到我们的线程中：

    ```
    type  
      TMyThread = class(TThread)  
    private  
      ThreadApplication: TApplication; 
    ```

2.  现在对定义进行一些修改`procedure TMyThread.Execute;`

    ```
    procedure TMyThread.Execute;  
    begin  
      if not Terminated then begin  
        try  
          ThreadApplication:=TApplication.Create(nil);  
          try  
            ThreadApplication.Initialize;  
            ThreadApplication.CreateForm(TMyForm, Form);  
            ThreadApplication.Run;
          finally  
            ThreadApplication.Free;
          end;  
        finally  
          Terminate;  
        end;  
      end;  
    end; 
    ```

3.  所以，就是这样，现在我们在 DLL 的第二个 GUI 线程中有消息泵。

最近，我在 Christian Wimmer 撰写的 Delphi-Jedi 博客中找到了对该解决方案的确认：
[http ://blog.delphi-jedi.net/2008/05/27/winlogon-notification-package/](http://blog.delphi-jedi.net/2008/05/27/winlogon-notification-package/)

非常感谢你。

# c# - asp:CustomValidator 功能

> ID：15234815
> 
> 赞同：0
> 
> 时间：2013-03-05T21:48:30.263
> 
> 标签：c#, asp.net

所以我有这个旧的 asp .net 2.0 应用程序，它在某些表单控件上有这些 asp:RequiredFieldValidator 和 asp:CustomValidator。

当我在 Web 浏览器中关闭 javascript 时，我发现服务器/后端验证不存在。在编写了所有 asp:Validator 的 ac# 版本以进行后端验证后，我发现我可以简单地调用 [ValidatorID].IsValid 来获取控件的值是否有效。

我想我的问题是，由于我关闭了 javascript，应用程序如何知道 asp:CustomValidator 的关联控件是否有效？该javascript在何时何地运行？它必须是服务器正确的？

添加后端验证的正确/建议方法也只是拥有 if(validator1.IsValid && validator2.IsValid ...) { //isvalid } 还是有一种方法可以查看整个页面是否有效？还是一种对验证器进行分组的方法，这样我每次添加验证器时都不必更改代码隐藏？

谢谢 - 罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:52:36.627

在服务器端，您可以`if(Page.IsValid)`用来检查所有验证是否成功验证，如果客户端验证已关闭，则仅在服务器端进行验证。

请参阅[Page.IsValid](http://msdn.microsoft.com/en-us/library/system.web.ui.page.isvalid.aspx) MSDN 文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T21:55:03.353

在每个服务器端验证器函数上放置一个断点，然后调用`if(Page.IsValid)`您将看到您的代码将依次转到每个函数，并在遇到第一个返回 false 的函数时停止。

# r - ggplot2 - 设置大于最低点的下限

> ID：15234819
> 
> 赞同：12
> 
> 时间：2013-03-05T21:48:43.597
> 
> 标签：r, graphics, ggplot2

由于某种原因，我正在拟合的函数`ggplot2`超出了 y 轴，即使可以获得的最小值为零。因此，在尝试将下限限制为零时，我注意到似乎不能只设置下限，从而省略数据点（或预测点，显然）。这是真的？

例如，可以使用`expand_limits`缩小，因为它是：

```
require(ggplot2)
p = ggplot(mtcars, aes(wt, mpg)) + geom_point() 
p + expand_limits(y=0) 
```

但是不能放大：

```
p + expand_limits(y=15) 
```

与设置美学相同：

```
p + aes(ymin=0)
p + aes(ymin=15) 
```

我知道我可以使用`ylim`,`coord_cartesian`等来设置上限*和*下限，但在这种情况下，我将一个列表传递给`ggplot`using`lapply`并且上限会根据正在绘制的列表中的对象而变化。所以我回到单独绘制每个对象，这非常乏味。有任何想法吗？

编辑：哈德利确认这是不可能的，所以@Arun 的解决方法必须这样做！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T02:57:45.827

这取决于你想如何绘制图表，但如果你可以为每个图表创建一个上限向量，你可以做这样的事情......

```
# Some vector of upper bounds for each plot which you can determine beforehand
ul <- c(20,25,30,35)
# Layout for printing plots (obviously you can handle this part however you like, this is just an example)
vplayout <- function(x, y) viewport(layout.pos.row = x, layout.pos.col = y)

# Make some sensible number of rows/columns for plot page
x <- floor(sqrt(length(ul)))
y <- ceiling( length(ul) / x )

# Make list to hold plots
plots <- as.list( 1:length(ul) )
dim( plots ) <- c( x , y )

# Store plots with variable upper limit variable each time 
for( i in plots ){
        plots[[i]] <- ggplot(mtcars, aes(wt, mpg)) + geom_point()  + scale_y_continuous( limits = c( 15,ul[i]) , expand = c( 0 , 0 ) )
}

# Print the plots
grid.newpage()
pushViewport(viewport(layout = grid.layout(x, y)))
for( i in 1:x){
    for( j in 1:y){
        print( plots[[ i , j ]] , vp = vplayout( i , j ) )
        }
    } 
```

![在此处输入图像描述](../Images/8d12b0356d7729686f2bf525b99e7bac.png)

# asp.net - ModalPopup div 不显示

> ID：15234822
> 
> 赞同：1
> 
> 时间：2013-03-05T21:48:49.983
> 
> 标签：asp.net, listview, html, popup, modal-dialog

我的 asp.net 应用程序中有一个 ModalPopup 窗口，我想在单击 Listview 控件项时显示该窗口。

```
 <div id="ModalPopup" style="visibility:hidden" runat="server">
  <div style="position: absolute; width: 100%; height: 100%; z-index: 10002; background-color: Gray; filter: alpha(opacity=70); opacity: 0.7;">
    &nbsp;
  </div>
  <table style="position: absolute; width: 100%; height: 100%; z-index: 10003;">
    <tr>
      <td align="center" valign="middle">
        <div style="color: Black; font-weight: bolder; background-color: White; padding: 15px; width: 200px;">
          <asp:Image ID="Image4" runat="server" ImageUrl="~/Images/ajax-loader.gif" />...Processing....
        </div>
      </td>
    </tr>
  </table>
  </div> 
```

但是，在我的`RadListView1_SelectedIndexChanged`事件中，我的代码是：`ModalPopup.Attributes.Add("style", "visibility:visible");` 但不显示模式弹出窗口。

选择 ListView 项目时如何显示它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:33:52.460

由于您已经将`ModalPopup`div 定义为服务器控件（例如`runat=server`）***，并且***您正在尝试决定是否*在代码隐藏*中显示它- 只需使用该`Visible`属性...

```
 <div id="ModalPopup" Visible="false" runat="server">
   ....
 </div> 
```

在您的`RadListView1_SelectedIndexChanged`事件中，只需将 Visible 更改为 true：

```
protected void RadListView1_SelectedIndexChanged()
{
    ModalPopup.Visible = true;
} 
```

如果您坚持更改可见性属性本身，则可以像这样使用**[RegisterStartupScript](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx)**：

```
protected void RadListView1_SelectedIndexChanged()
{
    ClientScript.RegisterStartupScript(this.GetType(), "ShowPopup", "document.getElementById('" + ModalPopup.ClientID + "').style.visibility = 'visible';", true);
} 
```

# ruby-on-rails - 需要在 Rails 应用程序启动时存在 ENV VAR

> ID：15234823
> 
> 赞同：0
> 
> 时间：2013-03-05T21:48:53.820
> 
> 标签：ruby-on-rails, heroku, configuration, environment-variables

[Figaro](https://github.com/laserlemon/figaro)等Gem和[Heroku](http://www.heroku.com/)等服务允许使用*环境变量*配置运行时 Rails 应用程序。

如何验证应用程序是否需要*env var*，如果不存在则无法启动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:58:36.053

您可以将这样的内容放入初始化程序中：

```
# config/initializers/check_env.rb
fail "MY_ENV not defined" unless ENV["MY_VAR"] 
```

# asp.net - 我可以修改 Request.Headers 集合吗？

> ID：15234826
> 
> 赞同：6
> 
> 时间：2013-03-05T21:49:08.600
> 
> 标签：asp.net, crystal-reports, http-headers, httprequest, user-agent

我有一个使用第三方报告组件的 ASP.NET 站点。每当客户端浏览器未在请求标头中`NullReferenceException`指定 a 时，此组件就会抛出异常。`User-Agent`

这基本上是一个奇怪的场景，我只是想想出一个解决方法。我不知道谁/哪个客户端没有指定用户代理，这似乎是 IMO 的错误形式，但我们必须处理它产生的异常。我已经向第三方记录了一份关于他们报告组件中的错误的支持票，但我怀疑这条路线会有多大的成果。所以我的想法只是检测何时`User-Agent`为空白并将其默认为只是为了安抚报告组件。但是，我似乎无法更改 Request.Headers 集合中的任何内容。我得到以下异常：

```
Operation is not supported on this platform. 
```

我开始相信我无法做到这一点。我理解*为什么*ASP.NET 不允许这样做，但我还没有想出任何其他解决方法。

*更新：*`User-Agent`在penfold 的建议下，我`Request.Headers`尝试[使用`HttpModule`](https://stackoverflow.com/a/4098734/249144). 这使它添加到`Headers`集合中，但没有更新`Request.UserAgent`属性，这就是导致报告组件失败的原因。我一直在查看 .NET Reflector 以确定如何设置该属性以便我可以更新它，但我还没有想出任何东西（我可以找到的不仅仅是一个驱动属性的私有字段）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-23T15:12:36.777

最近我也遇到了和你一样的问题。我通过使用模拟 HttpWorkerRequest 克服了 Request.UserAgent 的问题。

（假设您已经使用自定义 HttpModule 解决了 Request.Headers 中的代理字符串）

这是示例代码：

```
Friend Class MockedRequestWorker
    Inherits HttpWorkerRequest

    Private ReadOnly _BaseHttpWorkerRequest As HttpWorkerRequest
    Private ReadOnly _UserAgent As String

    Friend Sub New(ByVal base As HttpWorkerRequest, 
        ByVal UserAgent As String)
        _BaseHttpWorkerRequest = base
        _UserAgent = UserAgent
    End Sub

    Public Overrides Sub EndOfRequest()
        _BaseHttpWorkerRequest.EndOfRequest()
    End Sub

    Public Overrides Sub FlushResponse(ByVal finalFlush As Boolean)
        _BaseHttpWorkerRequest.FlushResponse(finalFlush)
    End Sub

    'Note: remember to override all other virtual functions by direct invoke functions
    'from _BaseHttpWorkerRequest, except the following function

    Public Overrides Function GetKnownRequestHeader(ByVal index As Integer) As String

        'if user is requesting the user agent value, we return the 
        'override user agent string
        If index = HttpWorkerRequest.HeaderUserAgent Then
            Return _UserAgent
        End If

        Return _BaseHttpWorkerRequest.GetKnownRequestHeader(index)
    End Function

End Class 
```

然后，在您的自定义 HttpApplication.BeginRequest 处理程序中，执行此操作

```
Private Sub BeginRequestHandler(ByVal sender As Object, ByVal e As EventArgs)

    Dim request As HttpRequest = HttpRequest.Current.Request
    Dim HttpRequest_wrField As FieldInfo = GetType(HttpRequest).GetField("_wr", BindingFlags.Instance Or BindingFlags.NonPublic)

    Dim ua As String = "your agent string here"
    Dim _wr As HttpWorkerRequest = HttpRequest_wrField.GetValue(request)
    Dim mock As New MockedRequestWorker(_wr, ua)

    'Replace the internal field with our mocked instance
    HttpRequest_wrField.SetValue(request, mock)

End Sub 
```

注意：此方法仍然不能替换 ServerVariables 中的用户代理值，但它应该能够解决您需要的问题（也是我的问题）

希望这有帮助:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-24T08:09:24.757

```
protected void Application_BeginRequest(Object sender, EventArgs e) {
    const string ua = "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)";
    Request.Headers["User-Agent"] = ua;
    var httpWorkerRequestField = Request.GetType().GetField("_wr", BindingFlags.Instance | BindingFlags.NonPublic);
    if (httpWorkerRequestField != null) {
        var httpWorkerRequest = httpWorkerRequestField.GetValue(Request);
        var knownRequestHeadersField = httpWorkerRequest.GetType().GetField("_knownRequestHeaders", BindingFlags.Instance | BindingFlags.NonPublic);
        if (knownRequestHeadersField != null) {
            string[] knownRequestHeaders = (string[])knownRequestHeadersField.GetValue(httpWorkerRequest);
            knownRequestHeaders[39] = ua;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T22:32:36.033

我认为处理这个问题的最好方法是使用一个 http 模块，该模块将检查标头并在必要时注入用户代理。

正如您发现的那样，您不能在 Headers 对象上使用 set 方法。相反，您将不得不通过受保护的属性将用户代理字符串注入标头，这些属性可以通过反射访问，如[该问题](https://stackoverflow.com/questions/4091157/httpmodule-to-add-headers-to-request)的答案中所述。

## 更新

不幸的是`Request.UserAgent`，它没有使用 HttpWorkerRequest 中保存的信息`Request.Headers`，而是调用[HttpWorkerRequest](http://msdn.microsoft.com/en-us/library/system.web.httpworkerrequest%28v=vs.100%29.aspx)`GetKnownRequestHeader`中的方法。这是一个抽象类，通过查看反编译的库代码，实际实现会因托管环境而异。因此，我看不到通过反射以可靠方式替换用户代理字符串的方法。您可以推出自己的 WorkerRequest 课程，但我认为付出的努力并不值得。

很抱歉是否定的，但我认为不可能以简单的方式在 Web 应用程序中设置用户代理。目前最好的选择是对用户代理执行预检查，如果请求没有，则返回浏览器不支持的错误消息。

您还可以调查在更早的时候注入一些东西，即在 IIS 中或在您的代理服务器上（如果您使用一个）。

另外，我建议将此问题报告给 SAP。我知道他们目前正在积极开发 Viewer，谁知道他们可能会修复它，甚至可能会添加对 Opera 的支持！

# php - 用于通过 SSH（PHP 或其他）格式化代码的良好 IDE（或 VIM 替换/插件）

> ID：15234834
> 
> 赞同：0
> 
> 时间：2013-03-05T21:49:39.043
> 
> 标签：php, linux, ide, formatting

我发现自己不得不在远程服务器上编写 PHP 代码，而且我在 PHP 方面相对较新，我发现自己执行和测试了很多。

不过，在这一点上，我在*很多*嵌套的 if 语句中都有一个错误，这些语句只会变得更复杂，所以更多的格式确实会非常好！

我意识到这个问题可能有点开放，但我想知道是否有人会提醒我一个有效格式化代码的解决方案（在这种情况下是 PHP，尽管所有语言都是受欢迎的，尤其是 C++）被远程操纵。

（无缝的本地到远程也很好。）

我什至找不到在 VIM 中添加前导空格或制表符的方法。

提前致谢！

# grammar - 编写满足以下要求的明确的 Statement 语法：

> ID：15234842
> 
> 赞同：0
> 
> 时间：2013-03-05T21:50:22.437
> 
> 标签：grammar

编写满足以下要求的“语句”语法：

*   跳过是一个有效的语句
*   形式的赋值`x := E`是一个有效的语句，其中 x 是一个标识符，E 是一个算术表达式
*   两个语句的组成 S0 ；S1 是一个有效的语句

我有以下解决方案，但不确定它是否正确：

```
x:: E|skip|s0 E|s1 E 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:09:07.940

```
S:
  SKIP
| ID ':=' E
| S ';' S
; 
```

E 和 SKIP 必须有另一条规则，ID 是词法标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:05:53.297

这个怎么样？我不确定什么会被视为“有效”算术表达式以及什么会被视为有效标识符，但这样的事情怎么样？

```
S   :: 'skip'
S   :: IDENTIFIER ':=' E
S   :: S | S ';' S

A1  :: '+' | '-'
A2  :: '*' | '/'

NBR :: '1'|'2'|'3'|'4'|'5'|'6'|'7'|'8'|'9'|'0'
O   :: NBR          /* remove this if arithm. expression only on identifiers */
O   :: IDENTIFIER
O   :: '(' E ')'

F   :: O
F   :: O A1 O

E   :: F A2 F 
```

# javascript - 从 js 数组中删除值而不重新排序键

> ID：15234844
> 
> 赞同：4
> 
> 时间：2013-03-05T21:50:25.613
> 
> 标签：javascript

我有一个数组，我只想删除一个元素，但不重新排序键。有没有不使用删除或重建整个数组的简单方法？

或者在删除后清理以摆脱未定义的值，再次固定长度。

```
var array = ["valueone", "valuetwo"];

console.dir(array); // keys 0 and 1
array.splice(0, 1);
console.dir(array); // key 1 is now 0, do not want! 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T21:54:13.453

您可以`delete`将数组的元素：

```
a = ['one', 'two'];
delete a[0];

// a is now [undefined, 'two']; 
```

或者，`a[0]`明确设置为`undefined`.

请注意，数组`.length`参数由系统自动维护。如果您故意将其设置为更高的数字，您将获得大量`undefined`缺失键的值：

```
a.length = 10;
// a is now [undefined, 'two', undefined x 8] 
```

如果您不能接受这些语义，那么您应该考虑使用 an`Object`来代替。这将保留您的密钥，也许效率更高，但您会失去`.length`财产。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:00:57.647

您不能直接将值显式设置为 undefined 或 null 或空字符串。你想达到什么目的？

```
var arr = ['aaaa','bbb','ccc','ddd'];
    arr[0]= undefined;
    //or
    arr[0]= null;
    ///or
    arr[0]= "";
    arr.length; <--- 4 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:47:42.393

# 2018-09-07 更新

在我看来，这个答案不是很好。*[我提供了一个关于如何从 JavaScript 对象中删除属性](https://stackoverflow.com/a/12469043/1175714)*的答案，这些年来我受到了更多的关注，并涵盖了这个案例并进行了更详细的介绍。

关键是，您应该使用`Array.prototype.splice`and `Array.prototype.slice`。

`array.splice(start, n)`返回具有顺序元素的`array`from index的子集，并从原始数组中删除此子集，在此过程中创建一个新数组。`start``n`

```
let array = [1,2,3,4,5,6];
array.splice(2,3); // [3,4,5]
array; // [1,2,6] 
```

`array.slice(start, end)`返回`array`从索引`start`到索引的子集，`end`而不改变原始索引。行为与 有点不同`splice`，这就是为什么我更喜欢将其称为`array.slice(start, start + n)`。

```
let array = [1,2,3,4,5,6];
array.slice(2, 2 + 3); // [3,4,5]
array; // [1,2,3,4,5,6] 
```

当然，您*可以*将索引设置为类似`null`or的标记值`""`，但如果您希望数组在删除后保持相同的顺序，也许您应该改变您的方法——为什么`"valuetwo"`必须在索引 1 处？如果内容总是与访问它们所需的密钥相同，那么这个数据结构中甚至保存了哪些有用的信息？

* * *

原答案如下。如果我要保留原文，也许我应该详细说明为什么这是不好的建议。

> 您可以使用 javascript 的`delete`关键字。
> 
> ```
> delete array[index]; 
> ```

不要这样做。如果你的数组是同质的（应该是这样的），那么这将通过引入第二种类型（`undefined`）来破坏你的数组。您应该`array.splice()`如上所述使用，这将创建一个省略指定范围的新数组。

> 不幸的是，这会`undefined`在数组内部创建一个索引
> 
> ```
> var arr = ['pie', 'cake', 'fish'];
> delete arr[1];
> arr; // ['pie', undefined, 'fish'] 
> ```

举个例子。

> 你也可以这样做：
> 
> ```
> var arr = [9,8,7,6];
> arr[1] = null;
> arr;        // [9,null,7,6]
> arr.length; // 4
> var i = -1;
> while(++i < arr.length){
>     if(arr[i] && typeof(arr[i] === "number")){
>         alert(arr[i]);
>     }
> } 
> ```

你可以，但你不应该。这不仅是不必要的，而且没有做任何有用的事情（因为它所做的只是调用`alert`），而且它实际上已经被破坏了。

```
if(arr[i] && typeof(arr[i] === "number")){
    alert(arr[i]);
} 
```

你可能希望它只打印我们的元素，如果它是一个非零数字，但实际上也会运行类似的值`"foo"`，`[]`和`document.createElement("p")`，因为`typeof(arr[i] === "number")`总是返回值`"boolean"`，它是一个非空字符串，它是真实的并且会因此评估为真。`alert`这意味着被调用的唯一要求`arr[i]`是真实的。整个语言中只有六个值会导致这个 if 语句不执行，它们是：

*   `undefined`
*   `null`
*   `0`
*   `""`（读作“空字符串”）
*   `false`
*   `NaN`

> 或者，如果您不需要使用数组，则可以使用对象并使一切变得更容易：
> 
> ```
> var obj = {
>     0: "first",
>     1: "second",
>     2: "third"
> };
> delete obj[1];
> obj; // {0: "first", 2: "third"}
> for(var i in obj){
>     alert(obj[i]);
> } 
> ```

这将立即消除使用数组的所有优势。现在你有一个数据集，它可能是异构的，也可能不是异构的，它不能以任何理智的方式过滤、映射、减少或转换，你必须求助于类似的东西`for(i in obj)`（如果你敢这样做的话，这是极容易出错的使用像 jQuery 这样的库）来迭代它。幸运的是，今天我们有一些花哨的东西，例如`Object.keys(obj).map(k => obj[k]).forEach(function(el){ ... })`，但这不是拥有糟糕数据结构的借口。

> 要获取对象的长度：
> 
> ```
> getLength = function(obj){
>     var i = 0, l = 0;
>     for(i in obj){
>         l++;
>     }
>     return l;
> }
> getLength(obj); // 3 
> ```

同样，对于数组，这是不必要的。

> 但请记住，对象`date of creation`按名称对索引进行排序，而不是 >。不过，这不应该导致障碍。
> 
> 要按字母顺序对对象的索引进行排序：
> 
> ```
> sortObject = function (){
>     var arr = [], i;
>     for(i in this){
>         arr.push({index:i,content:this[i]});
>         delete this[i];
>     }
>     arr.sort();
>     for(i in arr){
>         var item = arr[i];
>         this[item.index] = item.content;
>     }
>     return this; // make chainable
> }
> var obj = {
>     acronym: "OOP",
>     definition: "Object-Oriented Programming",
>     article: "http://wikipedia.org/OOP"
> };
> sortObject.apply(obj); // indices are "acronym", "article", "definition" 
> ```

```
array.sort(fn) 
```

无论如何，对象的全部意义在于它的属性是未排序的。对未排序的列表进行排序几乎不会做任何有用的事情。

只是为了说明数组在做数组事情方面有多好：

```
let array = ["pie", "cake", "fish", "brownie", "beef", ...];
/* do some stuff... */
array
.filter(el => exclude.indexOf(el) === -1)
.forEach(function(el){
    console.log(el);
}); 
```

如果`exclude`是`["cake", "brownie"]`，那么这会将以下内容记录到控制台：

```
pie
fish
beef
... 
```

试想一下使用此答案的先前版本中的方法来执行相同操作需要多少不必要的代码行。

> * * *
> 
> 希望这有帮助

希望此*更新*有所帮助。

# mysql - LOAD DATA LOCAL INFILE：从文本文件中加载数据自动增量语法

> ID：15234849
> 
> 赞同：1
> 
> 时间：2013-03-05T21:50:35.787
> 
> 标签：mysql, primary-key, auto-increment, load-data-infile

我正在尝试将 .txt 文件中的数据加载到 mysql 中。该表如下所示：

```
+-------------+------------------+------+-----+---------+----------------+
| Field       | Type             | Null | Key | Default | Extra          |
+-------------+------------------+------+-----+---------+----------------+
| user_name   | varchar(10)      | NO   | MUL | NULL    |                |
| user_id     | int(10) unsigned | NO   | PRI | NULL    | auto_increment |
| listings    | int(10) unsigned | NO   |     | 0       |                |
| connections | int(10) unsigned | NO   |     | 0       |                |
| flags       | int(10) unsigned | NO   |     | 0       |                |
| days        | int(10) unsigned | NO   |     | 0       |                |
| email       | varchar(30)      | NO   |     | NULL    |                |
| suspend     | tinyint(1)       | YES  |     | 0       |                |
+-------------+------------------+------+-----+---------+----------------+ 
```

`LOAD DATA LOCAL INFILE`当我使用如何处理列加载数据时`user_id`？所有其他项目已经有数据。我希望数据库分配 user_id。那可能吗？

`user_id`文本文件中的列应该是什么样的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:23:58.800

我使用了以下内容：

```
name   \N    2    4    2    100    emal@mail.com    o 
```

每个条目都被自动赋予了正确的 id 来代替 \N。

如果有更好的方法，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:44:55.463

*“您还可以通过将输入值分配给用户变量而不将变量分配给表列来丢弃输入值”*阅读[此处](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

例子：

```
LOAD DATA LOCAL INFILE 'file.txt' INTO TABLE tablename (user_name, @skip, listings, connections, flags, days, email, suspend); 
```

# reporting-services - SSRS 2008 R2 中的分组 - 分组和组织字段

> ID：15234857
> 
> 赞同：0
> 
> 时间：2013-03-05T21:51:16.800
> 
> 标签：reporting-services, ssrs-2008, ssrs-grouping

我正在写一份报告，其中有 3 列中的组，每个组的末尾都有一个小计。当我创建分组时，会在报告左侧创建一列。我通常习惯将分组列重命名为正在分组的字段并删除报告中的列。但是，客户希望该字段位于报告内部而不是外部（换句话说，他希望这些列专门位于他请求它们的位置。有没有办法做到这一点？

这是我要实现的目标的代表性示例。

```
BusinessSegment Entity CostCenter  ShipDate InvoiceNumber CompanyCode Estimated Amount 
```

我想按 CostCenter 和 CompanyCode 进行分组，并在每个组的末尾提供 Estimated Amount 的小计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:10:36.613

除了聚合（最小值，最大值，总和，计数）等之外，您不能对内联进行分组。否则，您将获得第一个结果，某些内容被分组并且不准确。

您可以只折叠分组的值吗？

在 SSRS 中，通常带有报告，无论是矩阵报告还是表格报告，您都有一个“详细信息”分组。您提到了“列”，因此听起来您有 A、B 和 C 的标题，他们希望查看总数。您通常可以添加一个分组，然后让它根据需要折叠或扩展。这样，您可以向最终用户展示数据，但如果他们愿意，他们可以选择扩展数据以查看更多内容。

由于您没有指定是否有矩阵，所以我假设您有一个。当您有多个类别时，您可以对行或列进行分组，如果您有一个矩阵，它可能使用 [SUM(field)]。列的分组显示所有列，但是您可以指定它们在运行时折叠或展开。右键单击groing，您将获得“组属性”。选择左侧的“可见性”窗格。选择“隐藏”单选按钮，您的报告的默认值将“折叠”为聚合值，而不是每列的展开详细信息。如果您想要让用户展开或折叠的选项，请选中复选框“可以通过此报告项目切换显示：”。

# javascript - 如何检索具有编号名称的 JSON 对象键

> ID：15234869
> 
> 赞同：2
> 
> 时间：2013-03-05T21:52:07.777
> 
> 标签：javascript, jquery, json

我正在尝试从我的服务器传递一些 JSON 对象，这些对象的名称附加一个数字以相互区分。

检索这些对象时遇到问题。它无法附加带有通用名称的数字。

对象如下所示：

```
 {"shareInfo":[{"uname1":"abc","uname2":"sds","uname3":"uuh",.....}]} 
```

我尝试向它附加一个`integer`变量。

```
 data.shareInfo[i].uname+''+i; 
```

但它不是一起读取变量。我的意思是它不喜欢它`uname0,uname1,...`

请任何人告诉我如何附加数字以检索数据，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:53:35.387

`data.shareInfo[i]["uname" + i]`应该管用。

值得注意的是，您的示例数据在 data.shareInfo 中仅包含一个数组元素，因此您可能实际需要的是：

`data.shareInfo[0]["uname" + i]`

但我无法从您的测试数据中判断哪个是正确的。

# spring - 将 Spring DMLC 作为 CRON 运行

> ID：15234872
> 
> 赞同：1
> 
> 时间：2013-03-05T21:52:15.327
> 
> 标签：spring, jms, quartz-scheduler

Spring DMLC（DefaultMessageListenerContainer）有没有办法使用 CRON 来消费消息（比如每 10 分钟）？

我不希望 Spring DMLC 一直接收消息。

假设一条消息被生成并丢弃到 JMS 代理中，我喜欢消费者（Spring DMLC）在一段时间后接收处理。

我想知道是否有办法配置 Spring DMLC 和 Quartz？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T10:33:08.060

在这种情况下，为什么需要 DMLC？如果您使用 spring，[则 JMSTemplate](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/jms/core/JmsTemplate.html)可能是您正在寻找的。

```
void readOneMessageAndProcess() throws JmsException{
   Message msg = jmsTemplate.receive("SOME.QUEUE");
   // Process.
} 
```

然后让 Quartz、java 计时器或`public static void main(String args[])`由 cron 作业触发的简单方法运行该方法

# ember.js - 提交后如何强制 ember-data 刷新对象？

> ID：15234876
> 
> 赞同：4
> 
> 时间：2013-03-05T21:52:24.887
> 
> 标签：ember.js, ember-data

我通过 POST 向我们的 API 提交一个对象，然后转换到显示该对象的路由。API 修改 POST 中对象中的一个或多个字段，并在请求响应中返回更新的信息。

显示的数据是 POST 到我们 API 之前的原始数据。我可以从控制台看到 ember-data 正在从我们的 API 接收更新的信息。如何强制 ember “刷新”对象以显示正确的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T21:58:08.487

马特。Yehuda Katz 向提供此功能的用户发布了回复：

[https://stackoverflow.com/a/14183507/506230](https://stackoverflow.com/a/14183507/506230)

基本上你创建一个记录，应用它，保存它，然后重新加载它。

```
saveMessage: function(text){
    var acct = Social.Account.find(this.get("id")),
        msg = Social.store.createRecord(
                    Social.Message,
                    {
                        text: text,
                        account: acct,
                        created: new Date()
                    }
                );

    acct.get("messages").addObject(msg);
    Social.store.commit();

    var timeoutID = window.setTimeout(function(){
        __msg.reload();__
        console.log('reloading');
    }, 250);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:53:18.300

事实证明，ember 实际上表现正常，不需要额外的工作。问题是我在控制器上设置了一个与模型上的计算属性同名的变量。显示的是控制器上的变量值，而不是计算的属性。更改控制器变量的名称解决了该问题，无需任何额外代码。

# installation - 处理“已安装此产品的另一个版本。无法继续安装此版本...”

> ID：15234879
> 
> 赞同：6
> 
> 时间：2013-03-05T21:52:37.953
> 
> 标签：installation, windows-installer, installshield, installshield-2011

我的安装程序有 32 位和 64 位版本，它们具有（几乎）完全相同的代码和自定义操作序列（只有与此问题无关的微小差异）

我希望我的安装程序检测它之前是否已经安装过，在这种情况下运行我自己的代码而不是显示默认的 Windows Installer 错误：

> 该产品的另一个版本已安装。此版本的安装无法继续。要配置或删除本产品的现有版本，请使用控制面板上的添加/删除程序。

我的 32 位安装程序工作得非常好，如果我在产品已安装时运行安装程序，它会运行我的自定义代码，但我的 64 位安装程序中的相同代码和自定义操作无法正常工作，并且总是显示不需要的错误味精。

CheckPreviousVersion 是在 UI 序列中作为自定义操作调用的第一个函数，我尝试将它放在不同的位置，例如在 InstallValidate 之后，但没有任何效果。

我检查了详细的日志文件，但找不到任何可以解释这种行为的东西，这是日志的一部分：

```
=== Verbose logging started: 05/03/2013  16:27:20  Build type: SHIP UNICODE 5.00.7601.00  Calling process: C:\Windows\system32\msiexec.exe
===

MSI (c) (0C:94) [16:27:20:331]: Machine policy value 'Debug' is 0 MSI (c) (0C:94) [16:27:20:331]: ******* RunEngine:
           ******* Product: foo.msi
           ******* Action: 
           ******* CommandLine: ********** MSI (c) (0C:94) [16:27:21:546]: Machine policy value 'DisableUserInstalls' is 0 MSI (c) (0C:94) [16:27:21:557]: SOFTWARE RESTRICTION POLICY: Verifying package --> 'C:\Builds\.msi' against software restriction policy MSI (c) (0C:94) [16:27:21:557]: Note: 1: 2262 2: DigitalSignature 3:
-2147287038  MSI (c) (0C:94) [16:27:21:557]: SOFTWARE RESTRICTION POLICY: C:\Builds\.msi is not digitally signed MSI (c) (0C:94) [16:27:21:558]: SOFTWARE RESTRICTION POLICY: C:\Builds.msi is permitted to run at the 'unrestricted' authorization level. MSI (c) (0C:94) [16:27:21:584]: Cloaking enabled. MSI (c) (0C:94) [16:27:21:584]: Attempting to enable all disabled privileges before calling Install on Server MSI (c) (0C:94) [16:27:21:586]: End dialog not enabled MSI (c) (0C:94) [16:27:21:586]: Original package ==> C:\Builds\....msi MSI (c) (0C:94) [16:27:21:586]: Package we're running from ==> C:\Builds\.....msi MSI (c) (0C:94) [16:27:21:589]: APPCOMPAT: Uninstall Flags override found. MSI (c) (0C:94) [16:27:21:589]: APPCOMPAT: Uninstall VersionNT override found. MSI (c) (0C:94) [16:27:21:589]: APPCOMPAT: Uninstall ServicePackLevel override found. MSI (c) (0C:94) [16:27:21:589]: APPCOMPAT: looking for appcompat database entry with ProductCode '{B8CBA92E-2140-48AB-B4EA-A4C3FF10295B}'. MSI (c) (0C:94) [16:27:21:589]: APPCOMPAT: no matching ProductCode found in database. MSI (c) (0C:94) [16:27:21:599]: MSCOREE not loaded loading copy from system32 MSI (c) (0C:94) [16:27:21:608]: Machine policy value 'DisablePatch' is 0 MSI (c) (0C:94) [16:27:21:608]: Machine policy value 'AllowLockdownPatch' is 0 MSI (c) (0C:94) [16:27:21:608]: Machine policy value 'DisableLUAPatching' is 0 MSI (c) (0C:94) [16:27:21:608]: Machine policy value 'DisableFlyWeightPatching' is 0 MSI (c) (0C:94) [16:27:21:609]: APPCOMPAT: looking for appcompat database entry with ProductCode '{}'. MSI (c) (0C:94) [16:27:21:609]: APPCOMPAT: no matching ProductCode found in database. MSI (c) (0C:94) [16:27:21:609]: Transforms are not secure. MSI (c) (0C:94) [16:27:21:609]: PROPERTY CHANGE: Adding MsiLogFileLocation property. Its value is 'C:\Builds\Angoss\Products\Workstation\single-exec\INSTALL64.LOG'. MSI (c) (0C:94) [16:27:21:609]: Command Line: CURRENTDIRECTORY=C:\Builds\Angoss\Products\Workstation\single-exec CLIENTUILEVEL=0 CLIENTPROCESSID=7948  MSI (c) (0C:94) [16:27:21:609]: PROPERTY CHANGE: Adding PackageCode property. Its value is '{}'. MSI (c) (0C:94) [16:27:21:609]: Product Code passed to Engine.Initialize:  '' MSI (c) (0C:94) [16:27:21:609]: Product Code from property table before transforms: '{}' MSI (c) (0C:94) [16:27:21:609]: Product Code from property table after transforms:  '{}' MSI (c) (0C:94) [16:27:21:609]: Product registered: entering maintenance mode MSI (c) (0C:94) [16:27:21:609]: Determined that existing product (either this product or the product being upgraded with a patch) is installed per-machine. MSI (c) (0C:94) [16:27:21:609]: PROPERTY CHANGE: Adding ProductState property. Its value is '5'. MSI (c) (0C:94) [16:27:21:609]: PROPERTY CHANGE: Adding ProductToBeRegistered property. Its value is '1'. MSI (c) (0C:94) [16:27:21:609]: Entering CMsiConfigurationManager::SetLastUsedSource. MSI (c) (0C:94) [16:27:21:609]: Specifed source is already in a list. MSI (c) (0C:94) [16:27:21:609]: User policy value 'SearchOrder' is 'nmu' MSI (c) (0C:94) [16:27:21:609]: Machine policy value 'DisableBrowse' is 0 MSI (c) (0C:94) [16:27:21:609]: Machine policy value 'AllowLockdownBrowse' is 0 MSI (c) (0C:94) [16:27:21:609]: Adding new sources is allowed. MSI (c) (0C:94) [16:27:21:609]: PROPERTY CHANGE: Adding PackagecodeChanging property. Its value is '1'. Another version of this product is already installed. Installation of this version cannot continue. To configure or remove the existing version of this product, use Add/Remove Programs on the Control Panel. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-06T11:43:42.700

此消息通常只出现在开发阶段，而不是最终用户机器上。出现该消息是因为您只修改了包中的资源并重新构建它，**而没有增加版本号**，因此 Windows Installer 会看到机器上有一个具有相同产品代码和名称的包，但具有不同的包代码。

您的用户将永远不会收到此消息，因为我假设您会在发布软件包时增加版本号。这也基于您的函数名称，即“CheckPreviousVersion”。

如果您希望在机器上发现旧版本时出现自定义消息，请确保您首先安装了旧版本，您当前已安装最新版本，但使用另一个先前构建的包（即不同的包代码）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T12:54:43.660

如果您使用的是 BasicMSI 安装程序，您可以创建一个系统搜索来检查以下注册表项：

> HKEY_LOCAL_MACHINE\SOFTWARE\(Wow6432Node)\Microsoft\Windows\CurrentVersion\Uninstall\ *YOURPRODUCTCODE*

如果此密钥可用，则会在计算机上安装旧版本的设置。现在创建一个放置在“CheckPreviousVersion”之前的自定义操作来运行您的代码。将此自定义操作的条件设置为系统搜索中的属性。

这应该够了吧。

# clojure - 如何使用 clojure.edn/read 获取文件中的对象序列？

> ID：15234880
> 
> 赞同：13
> 
> 时间：2013-03-05T21:52:38.040
> 
> 标签：clojure, edn

Clojure 1.5 引入`clojure.edn`，其中包括一个读取函数，该函数需要一个`PushbackReader`.

如果我想阅读前五个对象，我可以这样做：

```
(with-open [infile (java.io.PushbackReader. (clojure.java.io/reader "foo.txt"))]
  (binding [*in* infile]
    (let [edn-seq (repeatedly clojure.edn/read)]
      (dorun (take 5 (map println edn-seq)))))) 
```

我怎样才能打印出所有的对象？考虑到其中一些可能是 nil，似乎我需要检查 EOF 或类似的东西。我想要一系列与我从中得到的对象相似的对象`line-seq`。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-06T00:50:07.533

使用 :eof 键

[http://clojure.github.com/clojure/clojure.edn-api.html](http://clojure.github.com/clojure/clojure.edn-api.html)

> opts 是一个可以包含以下键的映射： :eof - 在文件结束时返回的值。如果未提供，eof 将引发异常。

编辑：对不起，这还不够详细！给你：

```
(with-open [in (java.io.PushbackReader. (clojure.java.io/reader "foo.txt"))]
  (let [edn-seq (repeatedly (partial edn/read {:eof :theend} in))]
    (dorun (map println (take-while (partial not= :theend) edn-seq))))) 
```

应该这样做

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T15:59:12.940

我又看了一遍。这是我想出的：

```
(defn edn-seq
  "Returns the objects from stream as a lazy sequence."
  ([]
     (edn-seq *in*))
  ([stream]
     (edn-seq {} stream))
  ([opts stream]
     (lazy-seq (cons (clojure.edn/read opts stream) (edn-seq opts stream)))))

(defn swallow-eof
  "Ignore an EOF exception raised when consuming seq."
  [seq]
  (-> (try
        (cons (first seq) (swallow-eof (rest seq)))
        (catch java.lang.RuntimeException e
          (when-not (= (.getMessage e) "EOF while reading")
            (throw e))))
      lazy-seq))

(with-open [stream (java.io.PushbackReader. (clojure.java.io/reader "foo.txt"))]
  (dorun (map println (swallow-eof (edn-seq stream))))) 
```

`edn-seq`具有与 相同的签名`clojure.edn/read`，并保留所有现有行为，鉴于人们可能`:eof`以不同方式使用该选项，我认为这一点很重要。包含 EOF 异常的单独函数似乎是一个更好的选择，尽管我不确定如何最好地捕获它，因为它显示为`java.lang.RuntimeException`.

# javascript - 如何在jquery中捕获任何点击事件

> ID：15234881
> 
> 赞同：3
> 
> 时间：2013-03-05T21:52:40.777
> 
> 标签：javascript, jquery

我有一个按钮，当它被点击时，如果我再次点击它会显示一个带有图像的 div（就像一个聊天的表情面板），但我想要做的是：如果 div 已经出现然后我单击页面的任何其他内容，我想隐藏它。我试过这个：

```
$("myBtn").click(function(){
    // show div
});

$(document).click(function(){
// hide div
}); 
```

单击“myBtn”时，div 会自动显示和隐藏。我该如何解决？

感谢您的时间。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-05T21:59:05.697

您可以尝试以下方法：

```
$(document).on('click', function(evt) {
    if(!$(evt.target).is('#my-id')) {
        //Hide
    }
}); 
```

**更新**

这样您就可以拥有完整的工作集：

```
$('#mybutton').on('click', function(evt) {
    $('#mydiv').show();
    return false;//Returning false prevents the event from continuing up the chain
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:03:25.077

在展示您的原始文件的同时`<div>`，向您的页面添加一个新`<div>`的样式/css 设置如下：

```
.ui-widget-overlay {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: 100%;
    z-index: 100;
} 
```

确保原始`<div>`文件（您希望能够在不关闭它的情况下单击它）具有较高的`z-index`，但页面上的所有其他内容具有较低的 z-index。

当您将新的 div 添加到您的页面时，给它一个`.ui-widget-overlay`类，并添加一个点击处理程序来拦截对它的点击`<div>`。使用点击处理程序添加覆盖 div 如下所示：

```
$('<div class="ui-widget-overlay">')
    .click(function() {
        $('.ui-widget-overlay').remove();
        $('selector-for-original-div').hide();
    })
    .appendTo('body'); 
```

所有这一切的结果：你有两个 div。第一个是您要显示的内容并允许用户在不关闭它的情况下单击它，第二个是第一个下方的不可见 div 占据整个浏览器窗口，因此如果用户单击除上部 div 之外的任何位置，它会拦截单击事件. 在该单击事件中，您删除隐藏的 div 并隐藏原始 div。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:56:12.043

*更新*

假设您在元素显示时有一个“活动”类，它将是：

```
$('html').click(function(e){

  if(!$(e.target).attr("id") == "my-id") { 

  }

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:58:30.933

```
<script type="text/javascript">
  $('body').click(function() {
   if($("div").is(':visible')){
    $("div").hide();
   }
  });
</script> 
```

此处的 $("div") 选择器应该是您的 div 或者具有 id 或 class 例如：如果`<div class="class" id="id">`then`$("div")`将更改为`$("div.class")`或`$("div#id")`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-05T21:58:33.757

```
<div class="slControlWrapper">
    <div class="slControlLabel">
        <asp:Label ID="lblSL" CssClass="lblSL" runat="server">Clickable Label</asp:Label>
    </div>
    <div class="slControlSeparator">

    </div>
    <div class="slControlDropDown">

    </div>
     <div id="wndSL">
        This is the hidden content of my DIV Window
    </div>
    <div id="test">
    I am for test click on me
    </div>
</div>

 $('.slControlLabel, .slControlDropDown').bind('click',function(event){

   $('#wndSL').show(); 
 event.stopPropagation();
 });

$('html').click(function() {
   $('#wndSL').hide(); 
});

    #wndSL {

display:none;     background-color: blue;    height:500px;    width:590px;
} 
```

在这里看一看：

[http://jsfiddle.net/nCZmz/26/](http://jsfiddle.net/nCZmz/26/)

# email - 需要帮助优化标记电子邮件的谷歌应用脚 本

> ID：15234882
> 
> 赞同：12
> 
> 时间：2013-03-05T21:52:43.873
> 
> 标签：email, gmail, google-apps-script, gmail-imap

Gmail 存在一个问题，即对话标签不适用于到达对话线程的新邮件。[问题详情在这里](http://www.jamesmurty.com/2008/03/13/gmail-labelling-search-bug/comment-page-1/)

我们[发现](http://www.lifehacker.com.au/2011/12/fix-gmail-label-issues-with-an-app-script/)了一个 Google Apps 脚本，它修复了 Gmail 收件箱中单个邮件的标签，以解决此问题。脚本如下：

```
function relabeller() {
  var labels = GmailApp.getUserLabels();

  for (var i = 0; i < labels.length; i++) {
    Logger.log("label: " + i + " " + labels[i].getName());

    var threads = labels[i].getThreads(0,100);
    for (var j = 1; threads.length > 0; j++) {
      Logger.log( (j - 1) * 100 + threads.length);
      labels[i].addToThreads(threads);
      threads = labels[i].getThreads(j*100, 100);
    }
  }
} 
```

但是，由于 Google Apps 脚本的 5 分钟执行时间限制，此脚本在包含超过 20,000 封邮件的电子邮件箱上会超时。

任何人都可以建议一种优化此脚本使其不会超时的方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-28T12:05:41.480

好的，我已经为此工作了几天，因为我对 Gmail 在对话中标记/不标记邮件的奇怪方式感到非常沮丧。

实际上，我很惊讶标签不会自动应用于对话中的新消息。这根本没有反映在 Gmail 用户界面中。无法查看线程并确定标签仅适用于线程中的某些消息，并且您无法将标签添加到 UI 中的单个消息。在我处理下面的脚本时，我注意到您甚至无法以编程方式将标签添加到单个消息中。因此，目前的行为确实没有理由。

随着我的咆哮，我有一些关于脚本的注释。

1.  我将 Saqib 的代码与 Serge 的代码结合起来。
2.  该脚本有两部分：一个重新标记所有附加了用户标签的线程的初始运行，以及一个标记最近电子邮件的维护运行（当前回顾 4 天）。在单次运行期间只执行一个部分。初始运行完成后，将仅运行维护部分。您可以设置一个触发器，使其每天运行一次，或多或少地运行一次，具体取决于您的需要。
3.  初始运行在 4 分钟后停止，以避免被 5 分钟的脚本时间限制终止。它将触发器设置为在 4 分钟后再次运行（这两个时间都可以使用脚本中的常量进行更改）。触发器在下次运行时被删除。
    *   维护部分没有运行时检查。如果您在过去 4 天内有大量电子邮件，则维护部分可能会达到脚本时间限制。我可能可以在这里更改脚本以提高效率，但到目前为止它对我有用，所以我并没有真正的动力去改进它。
4.  初始运行中有一条 try/catch 语句，试图捕捉 Gmail “写入配额错误”并优雅退出（即写入当前进度，以便稍后再次拾取），但我不知道它是否有效，因为我无法让错误发生。
5.  当达到时间限制以及初始运行完成时，您会收到一封电子邮件。
6.  由于某种原因，日志并不总是在运行之间完全清除，即使使用 Logger.clear() 命令也是如此。因此，它通过电子邮件发送给用户的状态日志不仅仅是最新的运行信息。我不知道为什么会这样。

我用它在大约半小时（包括等待时间）内处理了 20,000 封电子邮件。我实际上运行了两次，所以它在一天内处理了 40,000 封电子邮件。我猜 10,000 的 Gmail 读/写限制不是这里应用的（也许一次将标签应用于 100 个线程算作单个写入事件而不是 100？）。根据它发送的状态电子邮件，它在 4 分钟的运行中通过了大约 5,000 个线程。

很抱歉排长队。我责怪宽屏显示器。让我知道你的想法！

```
function relabelGmail() {

  var startTime= (new Date()).getTime(); // Time at start of script
  var BATCH=100; // total number of threads to apply label to at once.
  var LOOKBACKDAYS=4; // Days to look back for maintenance section of script. Should be at least 2
  var MAX_RUN_TIME=4*60*1000; // Time in ms for max execution. 4 minutes is a good start.
  var WAIT_TIME=4*60*1000; // Time in ms to wait before starting the script again.
  Logger.clear();

//  ScriptProperties.deleteAllProperties(); return; // Uncomment this line and run once to start over completely

  if(ScriptProperties.getKeys().length==0){ // this is to create keys on the first run
    ScriptProperties.setProperties({'itemsProcessed':0, 'initFinished':false, 'lastrun':'20000101', 'itemsProcessedToday':0, 
                                    'currentLabel':'null-label-NOTREAL', 'currentLabelStart':0, 'autoTrig':0, 'autoTrigID':'0'});
  }

  var itemsP = Number(ScriptProperties.getProperty('itemsProcessed')); // total counter
  var initTemp = ScriptProperties.getProperty('initFinished'); // keeps track of when initial run is finished. 
  var initF = (initTemp.toLowerCase() == 'true'); // Make it boolean

  var lastR = ScriptProperties.getProperty('lastrun'); // String of date corresponding to itemsProcessedToday in format yyyymmdd
  var itemsPT = Number(ScriptProperties.getProperty('itemsProcessedToday')); // daily counter
  var currentL = ScriptProperties.getProperty('currentLabel'); // Label currently being processed
  var currentLS = Number(ScriptProperties.getProperty('currentLabelStart')); // Thread number to start on

  var autoT = Number(ScriptProperties.getProperty('autoTrig')); // Number to say whether the last run made an automatic trigger
  var autoTID = ScriptProperties.getProperty('autoTrigID'); // Unique ID of last written auto trigger

  // First thing: google terminates scripts after 5 minutes. 
  // If 4 minutes have passed, this script will terminate, write some data, 
  // and create a trigger to re-schedule itself to start again in a few minutes. 
  // If an auto trigger was created last run, it is deleted here.
  if (autoT) {
    var allTriggers = ScriptApp.getProjectTriggers();

    // Loop over all triggers. If trigger isn't found, then it must have ben deleted.
    for(var i=0; i < allTriggers.length; i++) {
      if (allTriggers[i].getUniqueId() == autoTID) {
        // Found the trigger and now delete it
        ScriptApp.deleteTrigger(allTriggers[i]);
        break;
      }
    }
    autoT = 0;
    autoTID = '0';
  }

  var today = dateToStr_();
  if (today == lastR) { // If new day, reset daily counter
    // Don't do anything
  } else {
    itemsPT = 0;
  }

  if (!initF) { // Don't do any of this if the initial run has been completed
    var labels = GmailApp.getUserLabels();

    // Find position of last label attempted
    var curLnum=0;
    for ( ; curLnum < labels.length; curLnum++) { 
      if (labels[curLnum].getName() == currentL) {break};
    }
    if (curLnum == labels.length) { // If label isn't found, start over at the beginning
      curLnum = 0;
      currentLS = 0;
      itemsP=0;
      currentL=labels[0].getName();
    }

    // Now start working through the labels until the quota is hit.
    // Use a try/catch to stop execution if your quota has been hit. 
    // Google can actually automatically email you, but we need to clean up a bit before terminating the script so it can properly pick up again tomorrow.
    try {
      for (var i = curLnum; i < labels.length; i++) {
        currentL = labels[i].getName(); // Next label
        Logger.log('label: ' + i + ' ' + currentL);

        var threads = labels[i].getThreads(currentLS,BATCH);

        for (var j = Math.floor(currentLS/BATCH); threads.length > 0; j++) {
          var currTime = (new Date()).getTime();
          if (currTime-startTime > MAX_RUN_TIME) {

            // Make the auto-trigger
            autoT = 1; // So the auto trigger gets deleted next time.

            var autoTrigger = ScriptApp.newTrigger('relabelGmail')
            .timeBased()
            .at(new Date(currTime+WAIT_TIME))
            .create();

            autoTID = autoTrigger.getUniqueId();

            // Now write all the values.
            ScriptProperties.setProperties({'itemsProcessed':itemsP, 'initFinished':initF, 'lastrun':today, 'itemsProcessedToday':itemsPT, 
                                            'currentLabel':currentL, 'currentLabelStart':currentLS, 'autoTrig':autoT, 'autoTrigID':autoTID});

            // Send an email
            var emailAddress = Session.getActiveUser().getEmail();
            GmailApp.sendEmail(emailAddress, 'Relabel job in progress', 'Your Gmail Relabeller has halted to avoid termination due to excess ' +
                               'run time. It will run again in ' + WAIT_TIME/1000/60 + ' minutes.\n\n' + itemsP + ' threads have been processed. ' + itemsPT + 
                               ' have been processed today.\n\nSee the log below for more information:\n\n' + Logger.getLog());
            return;
          } else {
            // keep on going
            var len = threads.length;
            Logger.log( j * BATCH + len);

            labels[i].addToThreads(threads);

            currentLS = currentLS + len;
            itemsP = itemsP + len;
            itemsPT = itemsPT + len;
            threads = labels[i].getThreads( (j+1) * BATCH, BATCH);
          }
        }

        currentLS = 0; // Reset LS counter
      }

      initF = true; // Initial run is done

    } catch (e) { // Clean up and send off a notice. 
      // Write current values back to ScriptProperties
      ScriptProperties.setProperties({'itemsProcessed':itemsP, 'initFinished':initF, 'lastrun':today, 'itemsProcessedToday':itemsPT, 
                                      'currentLabel':currentL, 'currentLabelStart':currentLS, 'autoTrig':autoT, 'autoTrigID':autoTID});

      var emailAddress = Session.getActiveUser().getEmail();
      var errorDate = new Date();
      GmailApp.sendEmail(emailAddress, 'Error "' + e.name + '" in Google Apps Script', 'Your Gmail Relabeller has failed in the following stack:\n\n' + 
                         e.stack + '\nThis may be due to reaching your daily Gmail read/write quota. \nThe error message is: ' + 
                         e.message + '\nThe error occurred at the following date and time: ' + errorDate + '\n\nThus far, ' + 
                         itemsP + ' threads have been processed. ' + itemsPT + ' have been processed today. \nSee the log below for more information:' + 
                         '\n\n' + Logger.getLog());
      return;
    }

    // Write current values back to ScriptProperties. Send completion email.
    ScriptProperties.setProperties({'itemsProcessed':itemsP, 'initFinished':initF, 'lastrun':today, 'itemsProcessedToday':itemsPT, 
                                    'currentLabel':currentL, 'currentLabelStart':currentLS, 'autoTrig':autoT, 'autoTrigNumber':autoTID});

    var emailAddress = Session.getActiveUser().getEmail();
    GmailApp.sendEmail(emailAddress, 'Relabel job completed', 'Your Gmail Relabeller has finished its initial run.\n' + 
                       'If you continue to run the script, it will skip the initial run and instead relabel ' + 
                       'all emails from the previous ' + LOOKBACKDAYS + ' days.\n\n' + itemsP + ' threads were processed. ' + itemsPT + 
                       ' were processed today. \nSee the log below for more information:' + '\n\n' + Logger.getLog());

    return; // Don't run the maintenance section after initial run finish

  } // End initial run section statement

  // Below is the 'maintenance' section that will be run when the initial run is finished. It finds all new threads
  // (as defined by LOOKBACKDAYS) and applies any existing labels to all messages in each thread. Note that this 
  // won't miss older threads that are labeled by the user because all messages in a thread get the label
  // when the label action is first performed. If another message is then sent or received in that thread, 
  // then this maintenance section will find it because it will be deemed a "new" thread at that point. 
  // You may need to search further back the first time you run this if it took more than 3 days to finish
  // the initial run. For general maintenance, though, 4 days should be plenty.

  // Note that I have not implemented a script-run-time check for this section. 

  var threads = GmailApp.search('newer_than:' + LOOKBACKDAYS + 'd', 0, BATCH); // 
  var len = threads.length;

  for (var i=0; len > 0; i++) {

    for (var t = 0; t < len; t++) {
      var labels = threads[t].getLabels();

      for (var l = 0; l < labels.length; l++) { // Add each label to the thread
        labels[l].addToThread(threads[t]);
      }
    }

    itemsP = itemsP + len;
    itemsPT = itemsPT + len;

    threads = GmailApp.search('newer_than:' + LOOKBACKDAYS + 'd', (i+1) * BATCH, BATCH); 
    len = threads.length;
  }
  // Write the property data
  ScriptProperties.setProperties({'itemsProcessed':itemsP, 'initFinished':initF, 'lastrun':today, 'itemsProcessedToday':itemsPT, 
                                  'currentLabel':currentL, 'currentLabelStart':currentLS, 'autoTrig':autoT, 'autoTrigID':autoTID});
}

// Takes a date object and turns it into a string of form yyyymmdd
function dateToStr_(dateObj) { //takes in a date object, but uses current date if not a date

  if (!(dateObj instanceof Date)) {
    dateObj = new Date();
  }

  var dd = dateObj.getDate();
  var mm = dateObj.getMonth()+1; //January is 0!
  var yyyy = dateObj.getFullYear();

  if(dd<10){dd='0'+dd}; 
  if(mm<10){mm='0'+mm};
  dateStr = ''+yyyy+mm+dd;

  return dateStr;

} 
```

编辑：2017 年 3 月 24 日我想我应该打开通知或其他东西，因为我从未见过来自 user29020 的问题。如果有人有同样的问题，我会这样做：我通过将每日触发器设置为每晚凌晨 1 点到 2 点之间运行，将其作为维护功能运行。

附加说明：似乎在过去一年左右的某个时候，对 Gmail 的标记调用显着放缓。现在每个线程大约需要 0.2 秒，所以我预计最初运行 20k 封电子邮件至少需要运行 20 次左右才能完成。这也意味着，如果您通常每天收到超过 100-200 封电子邮件，维护部分也可能会开始花费太长时间并开始失败。现在有很多电子邮件，但我敢打赌，有些人会收到这么多，而且看起来你会比我第一次写失败时每天需要 1000 封左右的电子邮件更有可能收到。脚本。

无论如何，一种缓解措施是将 LOOKBACKDAYS 减少到小于 4，但我不建议将其小于 2。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T22:40:10.030

从[文档中：](https://developers.google.com/apps-script/class_gmailapp?hl=fr-FR#getInboxThreads)

**方法 getInboxThreads()**

*检索所有收件箱线程，而不考虑标签 当所有线程的大小太大而系统无法处理时，此调用将失败。如果线程大小未知，并且可能非常大，请使用“分页”调用，并指定要在每次调用中检索的线程范围。**

因此，您应该处理一定数量的线程，标记消息并设置时间触发器以每 10 分钟左右运行每个“页面”，直到所有消息都被标记。

* * *

编辑：我已经**尝试**过了，请考虑作为草稿开始：

该脚本将一次处理 100 个线程并向您发送一封电子邮件以通知您其进度并显示日志。

完成后，它还会通过电子邮件警告您。它使用 scriptProperties 来存储其状态。（不要忘记在脚本末尾更新邮件地址）。我尝试了将时间触发器设置为 5 分钟，现在它似乎运行顺利......

```
function inboxLabeller() {

  if(ScriptProperties.getKeys().length==0){ // this is to create keys on the first run
    ScriptProperties.setProperties({'threadStart':0, 'itemsprocessed':0, 'notF':true})
    }
    var items = Number(ScriptProperties.getProperty('itemsprocessed'));// total counter
    var tStart = Number(ScriptProperties.getProperty('threadStart'));// the value to start with
    var notFinished = ScriptProperties.getProperty('notF');// the "main switch" ;-)
    Logger.clear()

  while (notFinished){ // the main loop
    var threads = GmailApp.getInboxThreads(tStart,100);
    Logger.log('Number of threads='+Number(tStart+threads.length));
      if(threads.length==0){
      notFinished=false ;
      break
      }
      for(t=0;t<threads.length;++t){
       var mCount = threads[t].getMessageCount();
       var mSubject = threads[t].getFirstMessageSubject();
       var labels = threads[t].getLabels();
       var labelsNames = '';
         for(var l in labels){labelsNames+=labels[l].getName()}
       Logger.log('subject '+mSubject+' has '+mCount+' msgs with labels '+labelsNames)
         for(var l in labels){
             labels[l].addToThread(threads[t])
      }
      }
        tStart = tStart+100;
        items = items+100
        ScriptProperties.setProperties({'threadStart':tStart, 'itemsprocessed':items})
        break
      }
   if(notFinished){
      GmailApp.sendEmail('mymail', 'inboxLabeller progress report', 'Still working, '+items+' processed \n - see logger below \n \n'+Logger.getLog());
      }else{
      GmailApp.sendEmail('mymail', 'inboxLabeller End report', 'Job completed : '+items+' processed');
      ScriptProperties.setProperties({'threadStart':0, 'itemsprocessed':0, 'notF':true})
      }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-18T06:14:48.337

This will find individual messages that do not have a label and apply the label of the associated thread. It takes much less time because it's not relabeling every single message.

```
function label_unlabeled_messages() {
  var unlabeled = GmailApp.search("has:nouserlabels -label:inbox -label:sent -label:chats -label:draft -label:spam -label:trash");

  for (var i = 0; i < unlabeled.length; i++) {
    Logger.log("thread: " + i + " " + unlabeled[i].getFirstMessageSubject());
    labels = unlabeled[i].getLabels();
    for (var j = 0; j < labels.length; j++) {
      Logger.log("labels: " + i + " " + labels[j].getName());
      labels[j].addToThread(unlabeled[i]);
    }
  }
} 
```

# html - 列表在同一行上按顺序左对齐和右对齐

> ID：15234885
> 
> 赞同：3
> 
> 时间：2013-03-05T21:52:49.660
> 
> 标签：html, list, inline, alignment

尝试使用包含 5 个（或更多项目）的列表使代码正常工作，但试图让它像所需的图像显示的那样工作。

我对 css 很陌生，所以请多多包涵。谢谢

任何帮助，将不胜感激。

```
期望：

    第 1 项 第 2 项 第 3 项 第 4 项 第 5 项

目前：

    第 1 项 第 5 项 第 4 项 第 3 项 第 2 项

```

CSS

```
#navlist li
{
display: inline;
}

#navlist #right
{
float: right;
margin-right: 10px;
}

#navlist li a
{
text-decoration: none;
} 
```

HTML

```
<div id="navcontainer">
<ul id="navlist">
    <li>Item 1</li>
    <li id="right">Item 2</li>
    <li id="right">Item 3</li>
    <li id="right">Item 4</li>
    <li id="right">Item 5</li>
</ul>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:34:00.043

尝试`display: table`在您的 CSS 中使用：

```
#navlist
{
    display: table;
}

#navlist li
{
    display: table-cell;
    padding-right: 10px;
    white-space: nowrap;
}

#navlist li:last-child
{
    padding-right: 0;
}

#navlist li.span-full
{
    width: 100%;
} 
```

你的标记现在看起来像这样：

```
<div id="navcontainer">
    <ul id="navlist">
        <li class="span-full">Item 1</li>
        <li>Item 2</li>
        <li>Item 3</li>
        <li>Item 4</li>
        <li>Item 5</li>
    </ul>
</div> 
```

这是一个更新的小提琴：http: [//jsfiddle.net/QfD6J/7/](http://jsfiddle.net/QfD6J/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:00:07.060

你可以像这个**[jsFiddle 例子那样做](http://jsfiddle.net/j08691/QfD6J/)**

使用这个 CSS

```
#navlist li {
    display:inline-block;
    list-style-type:none
}
#navlist li:nth-of-type(1) {
    margin-right:60px;
} 
```

您也可以使用`float:left`而不是`display:inline-block`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:15:22.147

就放

```
float: left; 
```

里面`#navlist li`和`#navlist #right`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:20:59.197

为什么不使用 2 个列表，其中一个浮动在右侧？[http://jsfiddle.net/rEc3V/](http://jsfiddle.net/rEc3V/)

```
<div id="navcontainer">
    <ul class="nav pull-right">
        <li>Item 2</li>
        <li>Item 3</li>
        <li>Item 4</li>
        <li>Item 5</li>
    </ul>
    <ul class="nav">
        <li>Item 1</li>
    </ul>
</div> 
```

CSS：

```
.nav {
    list-style-type: none;
    padding: 0;
    margin: 0;
}
.nav li {
    display: inline-block;
}

.pull-right {
    float: right;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-02T19:31:37.970

这似乎工作 jsfiddle.net/Z3a6Z/23。谢谢大家的指导。

# c# - 如何在 Outlook 2013 中禁用特定存储的索引？

> ID：15234889
> 
> 赞同：3
> 
> 时间：2013-03-05T21:52:58.383
> 
> 标签：c#, .net, office-interop, outlook-2013

对于早期版本的 Outlook，我使用此答案[https://stackoverflow.com/a/2716229/1741116](https://stackoverflow.com/a/2716229/1741116)中描述的解决方案，它对我来说很好。

但在 Outlook 2013 中，与 Windows Search 的互通已被删除（[http://blogs.office.com/b/microsoft-outlook/archive/2012/12/19/outlook-2013-deprecated-features-and-components.aspx](http://blogs.office.com/b/microsoft-outlook/archive/2012/12/19/outlook-2013-deprecated-features-and-components.aspx)） ，甚至索引选项中的 Outlook 项目也不再可扩展。

![不可扩展的前景项目](../Images/e8acb0ad48e3d0d0bbd7899def278852.png)

修改注册表项中的值（最后的'20'实际上只适用于我的机器）

```
HKLM\SOFTWARE\Microsoft\Windows Search\CrawlScopeManager\Windows\SystemIndex\WorkingSetRules\20 
```

从

```
mapi15://{S-1-5-21-1397509461-1896107085-1961542790-1001}/ 
```

到

```
mapi://{S-1-5-21-1397509461-1896107085-1961542790-1001}/ 
```

添加可扩展的 Outlook 项目

![可扩展的前景项目](../Images/c173649761f9f48d649b65f27a66c221.png)

我可以从 WDS 索引中排除位置（以编程方式或手动），但仍然无法阻止我的特定存储被 Outlook 2013 索引。谁能建议我一个答案或资源链接来解释我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T21:29:06.620

基本上，您必须使用 Crawl Scope Manager 并为您的商店注册一个 URL。此处记录了完整的详细信息：http: [//blogs.msdn.com/b/stephen_griffin/archive/2013/12/31/wrapped-pst-and-indexing.aspx](http://blogs.msdn.com/b/stephen_griffin/archive/2013/12/31/wrapped-pst-and-indexing.aspx)

# makefile - 在先决条件之前制作强制目标

> ID：15234890
> 
> 赞同：0
> 
> 时间：2013-03-05T21:53:02.927
> 
> 标签：makefile, gnu-make

我知道以前有人问过这个问题，但请多多包涵。run_test 是我要创建的文件的名称。我更喜欢调用“make run_test”。我希望每次调用 make run_test 时都调用 prereq 的 makefile。但我不希望调用 prereq 的 make 来强制 run_test 重建。

```
run_test: build_prereq prereq_dir/prereq_ts
  rebuild_test.sh

.PHONY: build_prereq

build_prereq:
  make -C prereq_dir 
```

如果 make -C prereq (prereq_dir/makefile) 检测到 prereq 的依赖项是旧的并且 prereq 需要重建，则 prereq_dir/prereq_ts 被更新。

这样做的问题是总是调用 rebuilt_test.sh，我认为这是因为 run_test 的依赖项之一被执行（因为它是 PHONY）。

我已通过将 run_test 更改为：

```
run_test:: build_prereq

run_test:: prereq_dir/prereq_ts
  rebuild_test.sh

.PHONY: build_prereq

build_prereq:
  make -C prereq_dir 
```

这是一个好的解决方案吗？这首先运行 build_prereq，然后如果 prereq_dir/prereq_ts 更新（如果需要，这将在 build_prereq 的 make 调用中发生），它会运行 rebuild_test.sh。

有没有更合适的方法来做到这一点。我不想创建额外的目标，因为这不允许直接调用 make 即“make run_test”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:35:25.853

使支持正是你想要的。

```
.PHONY: build_prereq
build_prereq:
    ${MAKE} -C prereq_dir

prereq_dir/prereq_ts: build_prereq ; 

run_test: prereq_dir/prereq_ts
    rebuild_test.sh 
```

因此，您要求 make 构建`run_test`.

1.  为了确保`prereq_dir/prereq_ts`是最新的，它首先运行`build_prereq`.
2.  接下来它运行配方`prereq_dir/prereq_ts`（什么都不做——见`;`）。
3.  现在它检查时间戳`prereq_dir/prereq_ts`以确定是否`run_test`过期。

完美的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T13:02:09.207

如果您愿意成为不可移植的，GNU make 支持*仅订购的先决条件*（请参阅 GNU make 手册），这正是您想要的：

```
run_test: | build_prereq

build_prereq:
        $(MAKE) -C prereq_dir 
```

（注意在调用子制作时*总是*使用，从不）`$(MAKE)``make`

# python - 在 sorted 函数中编写 key 函数

> ID：15234899
> 
> 赞同：0
> 
> 时间：2013-03-05T21:53:49.850
> 
> 标签：python

我是 python 新手，正在尝试对以下元组列表进行排序：

```
>>> str
[('991', 'Shantell'), ('992', 'Cherish'), ('993', 'Linsey'), ('994', 'Hali'), ('995', 'Tarah'), ('996', 'Annemarie'), ('997', 'Asha'), ('998', 'Jada'), ('999', 'Leila'), ('1000', 'Peggy')] 
```

我想根据元组的第一个值对其进行排序，但不幸的是每个元组的第一个值是一个字符串而不是整数。我知道我可以创建一个执行此操作的关键函数：

```
def digit_key(t):
    return (int(t[0])) 
```

然后调用排序如下：

```
>>> sorted(str,key=digit_key)
[('991', 'Shantell'), ('992', 'Cherish'), ('993', 'Linsey'), ('994', 'Hali'), ('995', 'Tarah'), ('996', 'Annemarie'), ('997', 'Asha'), ('998', 'Jada'), ('999', 'Leila'), ('1000', 'Peggy')] 
```

我总是必须在排序之前定义关键功能吗？有没有更漂亮的方法来编写这段代码而不为它定义两个函数？我尝试了以下但失败了：

```
>>> sorted(str,key= int(str[0][0]))
Traceback (most recent call last):
  File "<pyshell#1112>", line 1, in <module>
    sorted(str,key= int(str[0][0]))
TypeError: 'int' object is not callable 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:55:17.193

你可以做：

```
sorted(str,key=lambda x: int(x[0])) 
```

创建一个内联函数，`lambda`它等效于（至少在这种情况下）您的`digit_key`. 我不确定这是否“更漂亮”，但它不那么冗长，并且是大多数人可能会使用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T21:55:37.397

是的。Lambda 语句：

```
sorted(str, key= lambda a: (int(a[0])) ) 
```

基本上它是一种声明内联函数的简洁方法。语法是`lambda`关键字后跟参数（用逗号分隔）、冒号，然后是函数返回的语句：

```
lambda <arg...> : <statement> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T22:14:12.310

如果你真的想避免定义函数，那就`lambda`无济于事了；这只是定义函数的另一种方式。您可以使用高阶函数来创建函数而不定义它们：

```
sorted(str, key=functional.compose(int, operator.itemgetter(0))) 
```

（您需要安装[`functional`](https://github.com/abarnert/functional)模块（或其他`compose`函数源），以及`import`两者`functional`和`operator`。）

但我认为这是围绕“定义”的定义作弊，而且它肯定不是更蟒蛇。

同时，如果你只想要最漂亮、最 Python 或最可维护的代码……也许你已经得到了。

给函数起一个名字通常会使它更具可读性。

它还使调试变得更加容易。如果`lambda foo: bar(baz(foo), qux(foo))`没有做正确的事情，您必须尝试猜测它*应*该做什么，然后才能修复它。如果函数有名字，你不必猜测——它应该按照名字的含义去做。

不合时宜地定义它也意味着您可以在多个地方使用它，而无需复制粘贴。

你可以对它进行单元测试。

而且它通常更有效。

你所花费的只是一行浪费的代码。这真的不能接受吗？

显然，在足够简单的情况下，`lambda`它通常是可读的——否则，它一开始就不会出现在语言中。但它实际上从来没有必要，并且总是在简洁和明确之间进行权衡。

# jquery - 保存 jquery 同位素过滤历史

> ID：15234900
> 
> 赞同：1
> 
> 时间：2013-03-05T21:53:56.000
> 
> 标签：jquery, save, history

我正在使用 Jquery isotope 来过滤我主页上的产品。

在我的页面上：http: [//osaiart.no/terrazzolys.php](http://osaiart.no/terrazzolys.php)

我有不同的产品类别。问题是，如果您单击与第一个类别不同的​​类别，然后单击产品。当您点击后退按钮时，它不会识别您所在的类别。

当你回去的时候，这是一种让它识别你所在类别的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T17:16:22.133

我不确定同位素本身是否提供了任何特定方法，但这就是我要做的。使用 javascript cookie 来存储所选类别的值。然后在页面加载时，您可以过滤掉像这样的其他产品

```
$('#container').isotope({ filter: '.selected' });
//filter out other products and show the only category that has the .selected class 
```

这是一个 cookie 插件，我通常使用[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie) 以及进一步的实现，例如使用后退按钮控制过滤等。您可以使用 html5 的历史 API 或类似这样的插件进行简单的实现 - [https://github.com/balupton/jquery-history](https://github.com/balupton/jquery-history)

# php - Windows 中的 PHP 和符号链接

> ID：15234904
> 
> 赞同：1
> 
> 时间：2013-03-05T21:54:06.180
> 
> 标签：php, windows, symlink

我有一个带有符号链接的目录树。它们用require_once 调用，但有时用'm' 和有时用'mydir' 来引用它们。'm' 和 'mydir' 是符号链接的，但是当 require_once 被调用两次时，它会将它们视为不同的文件和代码错误。

```
require_once("m/myfile.php");
require_once("mydir/myfile.php); 
```

我只希望文件包含一次，但它会尝试执行两次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-10-23T08:18:20.493

几年后，在 Windows 10 下，我遇到了类似的问题：

*   我通过 git 检查了我们的项目，在 git 中激活了符号链接
*   在项目中使用了一些目录符号链接
*   Windows 下的 Apache 和 bash 工作正常，生成的符号链接没有任何问题
*   PHP、Windows Explorer 和 CMD 无法处理符号链接

问题是，符号链接被创建为“文件”符号链接，但指向目录。删除符号链接并手动重新创建它们后

```
mklink /D link target 
```

一切都按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:12:34.227

[如果完全 OO http://php.net/manual/en/language.oop5.autoload.php](http://php.net/manual/en/language.oop5.autoload.php)或修复路径函数，我将使用我自己的 require 函数/自动加载 。

IE

```
//custom require
function myRequireOnce($filePath)
{//ensure only one version of sym path is ever used
  $filepath = str_replace('mydir', 'm' , $filepath); //possibly too simple
  require_once($filepath);
}

//fix path function
_fp($path)
{
  return str_replace('mydir', 'm' , $filepath);
}

require_once(_fp("m/myfile.php")); 
```

在所有情况下，目标是确保实际上只需要一个路径，并且在替代版本上进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T21:56:41.563

Windows 中没有符号链接，抱歉。

如果您已经从 github 签出或下载了代码，然后将其放到 NTFS 文件系统中，您的下载程序可能会为链接创建文件两次，为链接文件创建一次。我经常看到这个

# asp.net-mvc - 如何在 ASP.NET MVC 中显示混合表单？

> ID：15234906
> 
> 赞同：0
> 
> 时间：2013-03-05T21:54:12.747
> 
> 标签：asp.net-mvc

我设计了执行 CRUD 操作来管理用户偏好的表单（不是 SPA 模板）。在所有表单上，我还需要在 CRUD 表单的右侧显示最新的用户偏好列表。

我想知道控制器是否应该具有标准的 Index、Edit、Insert 等方法，然后在 Insert 视图中调用 Index 方法的子操作来列出最新的首选项？或者我应该有一个 ViewModel 包含要插入的单个记录和一个具有混合表单的 List 绑定到 View Model？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T01:50:59.870

这是我每周都会面临的一个很好的问题。我喜欢 MVVM 的概念，但我选择用子动作来解决它。

我喜欢孩子的行动，因为

1.  我可以从我的模型中将值传递给它们并让它们适应
2.  我可以使用 JQuery .load() 调用它们并从下拉列表或其他用户输入中传递一个值。

它们的多功能性使子动作 Partials 成为依赖行为的首选。

# asp.net-mvc - 如何在 MVC4 表单中编辑子对象？

> ID：15234912
> 
> 赞同：5
> 
> 时间：2013-03-05T21:54:54.510
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我有以下内容：

```
@foreach (var parent in Model.Parents)
{      
    @foreach (var child in parent.Children)
    {    
        @Html.TextAreaFor(c => child.name)    
    }                   
} 
```

如何让编辑对子对象起作用？我也尝试过这样的事情：

```
<input type="hidden" name="children.Index" value="@child.Id" />
<textarea name="children[@child.Id]" >@child.Name</textarea> 
```

将 IDictionary 传递给控制器​​，但出现错误：

```
[InvalidCastException: Specified cast is not valid.]
   System.Web.Mvc.CollectionHelpers.ReplaceDictionaryImpl(IDictionary`2 dictionary, IEnumerable`1 newContents) +131 
```

这似乎是一个非常常见的任务......有一个简单的解决方案吗？我错过了什么？我需要使用编辑器模板吗？如果是这样，任何与 MVC4 兼容的示例都会很棒。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T21:59:47.023

> 有一个简单的解决方案吗？

是的。

> 我错过了什么？

编辑器模板。

> 我需要使用编辑器模板吗？

是的。

> 如果是这样，任何与 MVC4 兼容的示例都会很棒。

ASP.NET MVC 4？伙计，从 ASP.NET MVC 2 开始就存在编辑器模板。您需要做的就是使用它们。

因此，首先摆脱外`foreach`循环并将其替换为：

```
@model MyViewModel
@Html.EditorFor(x => x.Parents) 
```

然后显然定义了一个编辑器模板，它将为`Parents`集合的每个元素自动呈现（`~/Views/Shared/EditorTemplates/Parent.cshtml`）：

```
@model Parent
@Html.EditorFor(x => x.Children) 
```

然后是`Children`集合中每个元素的编辑器模板 ( `~/Views/Shared/Editortemplates/Child.cshtml`)，我们将在其中删除内部`foreach`元素：

```
@model Child
@Html.TextAreaFor(x => x.name) 
```

在 ASP.NET MVC 中，一切都按照约定进行。所以在这个例子中，我假设它`Parents`是一个`IEnumerable<Parent>`并且`Children`是一个`IEnumerable<Child>`。相应地调整模板的名称。

结论：每次您使用`foreach`或`for`在 ASP.NET MVC 视图中您都做错了，您应该考虑摆脱它并用编辑器/显示模板替换它。

# java - cobertura-maven-plugin 不包括配置

> ID：15234914
> 
> 赞同：11
> 
> 时间：2013-03-05T21:54:54.790
> 
> 标签：java, maven, maven-3, cobertura

`DefaultViewTypeToFragmentMapperTest.java`我有一个 Maven 项目，目录中有一个测试用例`/src/test/java/test/com/mycompany/myproduct/android/viewtype2fragmentmapper/`。

我希望将此测试用例从单元测试覆盖率计算中排除。为了达到这个结果，我这样配置插件：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>cobertura-maven-plugin</artifactId>
    <version>2.5.2</version>
    <configuration>
        <formats>
            <format>html</format>
            <format>xml</format>
        </formats>
        <instrumentation>
            <excludes>
                <exclude>test/co/**/*.class</exclude>
            </excludes>
        </instrumentation>
    </configuration>
</plugin> 
```

但我仍然在覆盖率报告中看到上述课程。

如何修复它以使测试用例不出现在报告中并且不考虑其覆盖率（根据报告为 0 %）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-02-10T15:57:15.177

经过多次尝试并失败后，我得到了它的工作。

1.  编辑 pom。
2.  mvn clean 测试编译
3.  mvn cobertura:cobertura
4.  从 Firefox 重新打开页面。（确保页面没有被缓存）

我得到了它的工作：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>cobertura-maven-plugin</artifactId>
    <version>2.6</version>
        <configuration>
            <instrumentation>
                <excludes>
                    <exclude>aaa/**/*.class</exclude>
                    <exclude>com/test/bbb/**/*.class</exclude>
                </excludes>
            </instrumentation>
        </configuration>
 </plugin> 
```

将“aaa”更改为要排除的包名称的开头。将“bbb”更改为您要从报告中排除的包名称。

我希望它有帮助，马克安德鲁

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-05T22:01:49.270

你应该使用`<ignore>`标签。

```
<configuration>
  <instrumentation>
    <ignores>
      <ignore>com.example.boringcode.*</ignore>
    </ignores>
  </instrumentation>
</configuration> 
```

`<exclude>`used within`<instrumentation>`只是将包从您的检测中排除。在这种情况下，这没什么，因为你什么也没做。

请在[此处查看 Mojo Maven Cobertura 插件文档](http://mojo.codehaus.org/cobertura-maven-plugin/usage.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-06T03:15:05.807

是错字吗？

`<exclude>test/co/**/*.class</exclude>`.

**co**应该是**com**。

顺便说一句，`<ignores>`指示 Cobertura 忽略对与忽略正则表达式匹配的任何方法的任何调用。在检测期间它**不会**跳过这些类。为了排除类被检测，`<excludes>`应该使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-06T03:18:34.510

您不应该像以下示例一样附加 .class

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>cobertura-maven-plugin</artifactId>
    <version>2.5.2</version>
    <configuration>
        <formats>
            <format>html</format>
            <format>xml</format>
        </formats>
        <instrumentation>
            <excludes>
                <exclude>test/co/**/*</exclude>
            </excludes>
        </instrumentation>
    </configuration>
</plugin> 
```

我希望这可能会有所帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-15T13:02:31.227

我刚刚失去了两个小时的生命，因为 Cobertura 被排除在外，但最终成功了。

我找到的解决方案是，带有检测和排除 cobertura-maven-plugin 的插件配置必须在 pom 的 build/plugins 或 build/pluginManagement 章节中，同时**还**必须引用 cobertura-maven-plugin在报告章节中。

这里的陷阱是您最初从在报告章节定义插件开始，否则不会生成报告。但是仪器本身不会从 pom 的那部分获取任何配置。您需要在构建章节中定义它。

```
<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>cobertura-maven-plugin</artifactId>
                <version>2.7</version>
                <configuration>
                    <instrumentation>
                        <excludes>
                            <exclude>my/exclusion/package/**</exclude>
                        </excludes>
                    </instrumentation>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
</build>

<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
        </plugin>
    </plugins>
</reporting> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-19T15:27:25.203

除了[BertKoor](https://stackoverflow.com/users/6381983/bertkoor)的回答，我想指出，如果您正在执行`mvn cobertura:cobertura`或`mvn cobertura:cobertura-integration-test`直接执行，您的报告**仍将**包括在您的目标目录中找到的所有检测类的覆盖范围，如此[处](https://github.com/mojohaus/cobertura-maven-plugin/issues/20)所述！

如果是这种情况，请确保您这样做`mvn **clean** cobertura:cobertura`是为了首先从以前的构建中清理目标目录，**然后**检测并运行您的测试。

# c# - 如何将值插入数组，保持顺序？

> ID：15234926
> 
> 赞同：2
> 
> 时间：2013-03-05T21:55:58.050
> 
> 标签：c#, arrays

我有一个字符串数组，我想在中心的某处添加一个新值，但不知道该怎么做。任何人都可以为我做这个方法吗？

```
void AddValueToArray(String ValueToAdd, String AddAfter, ref String[] theArray) {
    // Make this Value the first value
    if(String.IsNullOrEmpty(AddAfter)) {
        theArray[0]=ValueToAdd; // WRONG: This replaces the first Val, want to Add a new String 
        return;
    }

    for(int i=0; i<theArray.Length; i++) {
        if(theArray[i]==AddAfter) {
            theArray[i++]=ValueToAdd; // WRONG: Again replaces, want to Add a new String 
            return;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T22:02:24.343

您不能将项目添加到数组中，它始终保持相同的大小。

要获得一个添加了项目的数组，您需要分配一个包含更多项目的新数组，并将所有项目从原始数组复制到新数组。

这当然是可行的，但效率不高。您应该使用 a`List<string>`代替，它已经有一个`Insert`方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:43:07.443

这仅在某些特定情况下有效。

```
public static void AddValueToArray(ref String[] theArray, String valueToAdd, String addAfter) {
    var count=theArray.Length;
    Array.Resize(ref theArray, 1+count);
    var index=Array.IndexOf(theArray, addAfter);
    var array=Array.CreateInstance(typeof(String), count-index);
    Array.Copy(theArray, index, array, 0, array.Length);
    ++index;
    Array.Copy(array, 0, theArray, index, array.Length);
    theArray[index]=valueToAdd;
} 
```

这是一个示例，但它适用于`Type`，您可能需要修改所需的类型。这是一个递归复制数组的例子。

*   [如何找到两种类型之间最佳拟合的最小协变类型？](https://stackoverflow.com/questions/14472103/evaluate-the-minimum-covariance-type-to-fit-both-of-types)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:14:02.150

查看[IList](http://msdn.microsoft.com/en-us/library/system.collections.ilist.aspx) Insert 方法是如何实现的

# google-maps - 使用 Meteor 的 Template.rendered 用于谷歌地图

> ID：15234935
> 
> 赞同：2
> 
> 时间：2013-03-05T21:56:48.103
> 
> 标签：google-maps, meteor

我正在使用以下代码：

```
Template.categories.rendered = function() {
  var map = new GMaps({
      div: '#map_canvas',
      lat: -12.043333,
      lng: -77.028333
  });
} 
```

执行 Gmaps.js 插件 - 它可以工作，每次我提交表单时，布局都会重新渲染，我的谷歌地图也会重新绘制。

我还使用常量来尝试隔离它......并且隔离......什么都没有。（它不在模板内）

```
 {{#constant}}
        <div id="map_canvas"></div>
 {{/constant}} 
```

我尝试将 Template.categories.rendered 更改为 Template.categories.created 但我遇到了一堆错误。我希望“创建”只执行一次..

**编辑**我制作了一个新模板“地图”并将表格与地图分开

但恐怕这不是一个可行的解决方案，因为我想在地图和表单之间进行通信.. 特别是我想获取纬度和经度并自动填写一个字段......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T07:31:37.543

尝试将您的地图放在单独的模板中，例如

```
<template name="categories">
    {{>map}}
    {{>other_form_with_submit_button}}
</template> 
```

所以你把你的地图放在

```
<template name="map">
    <div id="map_canvas></div>
</template>

<template name="other_form_with_submit_button">
    .. your form data
</template> 
```

您应该仍然能够像往常一样与地图通信，DOM 甚至没有注意到很多差异

```
Template.other_form_with_submit_button.events({
    'submit' : function() {
        var lat = "-12.043333",
        var lng = "-77.028333";
        var map = new GMaps({
           div: '#map_canvas',
           lat: -12.043333,
           lng: -77.028333
        });
    }
} 
```

同样，在移动地图时，您可以附加一个侦听器并让它像您希望的那样更改文本框：

```
Template.map.rendered = function() {
var map = new GMaps({
      div: '#map_canvas',
      lat: -12.043333,
      lng: -77.028333
});

//Im not sure what you're using to get the location but this is the example if moving the center could be used
google.maps.event.addListener(map, 'center_changed', function() {
    $("#lat").val(map.getPosition().lat());
    $("#lng").val(map.getPosition().lng());
}

}); 
```

# ruby - Ruby 正则表达式匹配然后从匹配中排除

> ID：15234936
> 
> 赞同：0
> 
> 时间：2013-03-05T21:56:56.913
> 
> 标签：ruby, regex

我有一个这样的网址：

```
http://www.example.com/blah.ashx?ID=fj203-fj230r-3jf030 
```

我想知道是否可以在 Ruby 中匹配从 ID= 到 URL 结尾的所有内容，然后从匹配中排除 ID=？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:00:18.240

Ruby 可能有一个内置的 URL 和查询字符串解析器，但是这个正则表达式应该足够简单：

```
\?ID=(.*) 
```

[http://rubular.com/r/kYf3EURRPN](http://rubular.com/r/kYf3EURRPN)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:08:16.023

我总是坚持使用图书馆方法，让我睡得更好;-)

```
require 'cgi'
require 'uri'

uri    = URI.parse('http://www.example.com/blah.ashx?ID=fj203-fj230r-3jf030')
params = CGI.parse(uri.query)
id     = params["ID"].first

#=> "fj203-fj230r-3jf030" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:03:35.497

像这样的东西。

```
"http://www.example.com/blah.ashx?ID=fj203-fj230r-3jf030"[/(?<=ID=)(.*)/] 
```

# .htaccess - 使用 htaccess 将域重定向到新域

> ID：15234937
> 
> 赞同：0
> 
> 时间：2013-03-05T21:56:59.440
> 
> 标签：.htaccess

我环顾四周，找不到任何适合我需求的东西。

我需要弄清楚如何将旧域的所有 URL 大规模重定向到新域。例如：

[http://www.olddomain.com/blog-post-title](http://www.olddomain.com/blog-post-title) 到 [http://www.newdomain.com/blog-post-title](http://www.newdomain.com/blog-post-title)

URI 总是相同的，我只需要 htaccess 来识别 URL 何时具有此属性并将其重定向到新域。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:45:33.193

如果您想将旧域名批发重定向到新域名，您可以使用该[`Redirect`](http://httpd.apache.org/docs/current/mod/mod_alias.html#redirect)指令

```
Redirect / http://www.newdomain.com/ 
```

# vb6 - vb6 ocx 项目 - 可以直接运行 EXE，而不是在调试器中

> ID：15234939
> 
> 赞同：2
> 
> 时间：2013-03-05T21:57:04.340
> 
> 标签：vb6, activex, ocx

我有一个 VB6 ActiveX 控件项目（创建一个`.OCX`），它有几个用户控件。控件正在由 EXE（也是 VB6）加载。当我直接运行 EXE 时，它运行正常，但是当我尝试在调试器中运行它时（我需要单步执行代码），它无法加载用户控件（.ctl），给我“类未注册. 正在寻找具有 CLSID 的对象：..." 消息

我设置了二进制兼容性（保留了所有旧的 GUID），并且我在注册表中看到了类，一切看起来都很好——只是没有在调试器中运行。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T04:50:42.673

十多年来，我一直在使用 VB6。问题是 VBP 项目引用与您的 OCX 用户控件的最新版本不同步。只需将项目作为一个组打开或单独打开 EXE 项目，然后单击 Project->Components。

您现在将看到两件事之一。参考将无效，或者您选择了有效的参考。无论哪种方式，取消选中参考并单击确定（在此操作期间不要重新选择它..相信我）。现在，关闭该对话框并返回 Projects->Components，现在从列表中选择您的 OCX 控件。这将解决您的问题。如果您的 OCX 不在列表中，请先独立重建它并重试。

这是 VB6 IDE 的一个未记录的错误。即使使用 VB6 SP6 也没有解决。

# hidden-field - Livevalidation - 如何忽略隐藏字段？

> ID：15234940
> 
> 赞同：2
> 
> 时间：2013-03-05T21:57:12.167
> 
> 标签：hidden-field, required, livevalidation

我有一个带有下拉列表的表单，显示 1 到 10。如果用户选择 1-9，则应显示特定的辅助段落字段。如果用户选择 10，则应显示不同的段落字段。

我想出了一些 javascript 来显示第二个表单字段（可能不是最优雅的方式，所以欢迎提出建议）。然后我使用了 livevalidation 代码，这样如果用户没有进行任何选择（下拉选项停留在选择一个而不是 1-10），那么下拉字段下会出现一个错误，而不是表单提交。

现在我想更进一步，需要显示的辅助字段，但不需要隐藏的字段。因此，如果选择 1 -9，则第二个字段显示 AND 将是唯一需要的字段。但如果选择 10，则其特定的第二个字段将显示并且是唯一的必填字段。

我尝试了几件事，但无法让表单提交 b/c 我认为隐藏字段仍然是必需的。

这是我的 JS，用于确定下拉列表并显示第二个字段：

```
<script type="text/javascript">
function selectionChanged()
{
if(document.getElementById("field0").value == "blank")
{   
document.getElementById("formElement1").style.display="none";
document.getElementById("formElement2").style.display="none";
}
else if(document.getElementById("field0").value == "10")
{
document.getElementById("formElement1").style.display="none";
document.getElementById("formElement2").style.display="inline";
}
else
{
document.getElementById("formElement1").style.display="inline";
document.getElementById("formElement2").style.display="none";
}

return true;
}
</script> 
```

如果没有做出下拉选择并留在选择一个上，这是 livevalidation 显示错误的代码：

```
<script type="text/javascript" >var field0 = new LiveValidation('field0', {onlyOnSubmit: true });
field0.add( Validate.Exclusion, { within: [ 'blank' ], failureMessage: 'Please make a selection' } );</script> 
```

希望这是有道理的，有人可以提供帮助。谢谢！

# c# - 如何在不使用 TextBox 的情况下检测是否按下了某个键？

> ID：15234946
> 
> 赞同：0
> 
> 时间：2013-03-05T21:57:26.867
> 
> 标签：c#, keypress

我看过 Stack Overflow 和 Google，但我还没有找到我的问题的答案。我想检测何时按下键而不需要文本框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:01:30.740

覆盖`OnKeyPress`main `Form`，这将捕获按键

窗体：

```
 protected override void OnKeyPress(KeyPressEventArgs e)
    {
        base.OnKeyPress(e);
    } 
```

WPF：（必须使用`OnKeyDown`或`OnKeyUp`

```
 protected override void OnKeyDown(KeyEventArgs e)
    {
        base.OnKeyDown(e);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:03:07.820

所有控件（包括窗体）都具有您可以使用的`KeyPress`、`KeyDown`和`KeyUp`事件。

*   [`KeyPress`事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keypress.aspx)
*   [`KeyDown`事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx)
*   [`KeyUp`事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keyup.aspx)

您可以在自己的控件中覆盖相应的`OnKeyPress`,`OnKeyDown`和方法。`OnKeyUp`

# javascript - 在库加载之前调用 jquery 函数的脚本

> ID：15234947
> 
> 赞同：0
> 
> 时间：2013-03-05T21:57:33.570
> 
> 标签：javascript, jquery, jquery-ui, jsp

我有一个 Jquery 函数的问题。

我从谷歌得到 jquery 库。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script> 
```

首先，我将以下代码放在 .js 上

```
(function($){
jQuery.fn.jConfirmAction = function (options) {
    var theOptions = jQuery.extend ({
        question: "Are You Sure ?",
        yesAnswer: "Yes",
        cancelAnswer: "Cancel"
    }, options);

    return this.each (function () {

        $(this).bind('click', function(e) {
            var submitBtn = $(this);
            if($(this).attr("jconfirmed")){
                submitBtn.removeAttr("jconfirmed");
            }else{
                e.preventDefault();
                thisHref = $(this).attr('href');

                var btns = {};
                btns[theOptions.yesAnswer]=function() {                                                         
                        $( this ).dialog( "close" );                                    
                        if (thisHref!=null){
                                window.location = thisHref;
                        }else{
                                submitBtn.attr("jconfirmed", true);
                                submitBtn.click();
                        }
                };

                btns[theOptions.cancelAnswer]=function() {                                                              
                    $( this ).dialog( "close" );                                    
                    submitBtn.removeAttr("jconfirmed");
                };

                var content='<p>'+theOptions.question+'</p>';
                if(theOptions.checkboxText!=undefined){
                        content='<p>'+'<input type="checkbox" id="cbox">'+theOptions.checkboxText+'<br/><br/>'+theOptions.question+'</p>';
                }

                $('#dialog-confirm').html(content);
                $('#cbox').click(function() {
                    /*
                    if($('#cbox').attr("checked")){
                            $('.ui-dialog-buttonset button:first-child').show();
                    }else{
                            $('.ui-dialog-buttonset button:first-child').hide();
                    }
                    */
                });

                $('#dialog-confirm').dialog({
                    resizable: false,
                    modal: true,
                    buttons: btns,
                    show: {
                        effect: "blind",
                        duration: 1000
                      },

                    hide: {
                          effect: "explode",
                          duration: 1000
                    }, 
                    draggable: false,
                    dialogClass: 'main-dialog-class'
                });
            }   
        });

    });
};
})(jQuery); 
```

并且，在一个jsp文件中调用该函数。

```
<script type="text/javascript">
$(document).ready(function() {
    $('.confirm').jConfirmAction();
});
</script> 
```

但我在控制台中有以下错误：

> 未捕获的类型错误：对象 [object Object] 没有方法“jConfirmAction”

我试图通过将函数代码放在同一个 jsp 中来解决这个问题，在`<script type="text/javascript"></script>`. 这适用于某些页面，但在其他页面中具有相同的错误。有没有办法仅在加载 jquery 时调用该函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:08:32.827

用 document.ready() 包装你的整个 JS 代码

```
$(document).ready(function () {
    (function ($) {
        jQuery.fn.jConfirmAction = function (options) {
            var theOptions = jQuery.extend({
                question: "Are You Sure ?",
                yesAnswer: "Yes",
                cancelAnswer: "Cancel"
            }, options);

            return this.each(function () {

                $(this).bind('click', function (e) {
                    var submitBtn = $(this);
                    if ($(this).attr("jconfirmed")) {
                        submitBtn.removeAttr("jconfirmed");
                    } else {
                        e.preventDefault();
                        thisHref = $(this).attr('href');

                        var btns = {};
                        btns[theOptions.yesAnswer] = function () {
                            $(this).dialog("close");
                            if (thisHref !== null) {
                                window.location = thisHref;
                            } else {
                                submitBtn.attr("jconfirmed", true);
                                submitBtn.click();
                            }
                        };

                        btns[theOptions.cancelAnswer] = function () {
                            $(this).dialog("close");
                            submitBtn.removeAttr("jconfirmed");
                        };

                        var content = '<p>' + theOptions.question + '</p>';
                        if (theOptions.checkboxText !== undefined) {
                            content = '<p>' + '<input type="checkbox" id="cbox">' + theOptions.checkboxText + '<br/><br/>' + theOptions.question + '</p>';
                        }

                        $('#dialog-confirm').html(content);
                        $('#cbox').click(function () {
                            /*
                        if($('#cbox').attr("checked")){
                                $('.ui-dialog-buttonset button:first-child').show();
                        }else{
                                $('.ui-dialog-buttonset button:first-child').hide();
                        }
                        */
                        });

                        $('#dialog-confirm').dialog({
                            resizable: false,
                            modal: true,
                            buttons: btns,
                            show: {
                                effect: "blind",
                                duration: 1000
                            },

                            hide: {
                                effect: "explode",
                                duration: 1000
                            },
                            draggable: false,
                            dialogClass: 'main-dialog-class'
                        });
                    }
                });

            });
        };
    })(jQuery);
}); 
```

在文件末尾包含所有 JS 文件，然后再试一次，并附注 ? 使用 '!==' 将变量与 'null' 和 'undefined' 进行比较

# javascript - 发送 html 代码

> ID：15234949
> 
> 赞同：0
> 
> 时间：2013-03-05T21:57:52.897
> 
> 标签：javascript, html

好吧，例如，我有这种不太安全和正确的形式

```
 <BODY>
<FORM ACTION="" METHOD="post" NAME="test" ID="test">
<INPUT TYPE="text" NAME="testt" VALUE="1">
<INPUT TYPE="reset" VALUE="testtt" onClick="test.submit()">
</FORM> 
```

我知道它在注射时很脆弱，但它是故意的。当我直接从页面发送 html 代码时，其形式被解释为 html 代码。但是，当我使用[JavaScript 发布请求中的脚本（如表单提交](https://stackoverflow.com/questions/133925/javascript-post-request-like-a-form-submit)其打印为纯文本）时，我试图将文本转换为 html 实体但仍打印为纯文本，我如何使用将被解释的脚本发送 html 代码作为html代码和注入将是可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:03:27.133

您可以尝试使用像[这样的 html 解析器。](http://ejohn.org/apps/htmlparser/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:36:35.237

好的，我的解决方案是为一些特殊字符添加反斜杠并添加`CONTENT="text/html;`

# tfs - 将 TFS Explorer 自定义控件从 2010 升级到 2012 - 呈现差异？

> ID：15234953
> 
> 赞同：1
> 
> 时间：2013-03-05T21:58:08.190
> 
> 标签：tfs, custom-controls

我们与拥有 VS 2010 和 VS 2012 的开发人员一起使用 TFS 2010。我们创建了一个自定义控件（TFS Explorer 和 Web Access）。由于一些开发人员正在升级到使用 VS 2012，因此我也将 TFS Explorer 自定义控件更新到 2012，但是在处理两个 Team Explorer 如何呈现控件时遇到了一个奇怪的问题。

该控件是一个 Windows 窗体控件，其中包含一个下拉列表和一个按钮（它不扩展 TFS 特定的下拉列表）。在某些情况下还会出现一个标签，但大多数情况下，当它在 VS 2010 中呈现时，它看起来像这样：

参见图片：[http ://social.msdn.microsoft.com/Forums/en-SG/tfsworkitemtracking/thread/e3e254e1-7f56-495c-a3c1-e92bfe030102](http://social.msdn.microsoft.com/Forums/en-SG/tfsworkitemtracking/thread/e3e254e1-7f56-495c-a3c1-e92bfe030102)

丢失的白框是对图像的更改，仅用于编辑内部信息。

请注意，您可以看到完整的下拉列表和刷新按钮。此控件使用自动调整大小（增长和缩小）进行编译，下拉和刷新按钮停靠，因此当您调整表单大小时，它可以正确调整大小。

为了迁移到 2012 年，我创建了一个新项目，移动了控件并将工作项控件和工作项客户端的引用更新到 2012 年的对应项。一切编译正确，控件按预期工作；但是，它们的渲染效果很差。

参见图片：[http ://social.msdn.microsoft.com/Forums/en-SG/tfsworkitemtracking/thread/e3e254e1-7f56-495c-a3c1-e92bfe030102](http://social.msdn.microsoft.com/Forums/en-SG/tfsworkitemtracking/thread/e3e254e1-7f56-495c-a3c1-e92bfe030102)

请注意，控件太宽了。它完全切断了刷新按钮，并且一些下拉菜单也被切断了。

当我在 VS 2012 中调整窗口大小时，它也会“正确”缩放，但总是在同一个地方被切断。

控件本身在两个版本之间的设置方式相同，实际上我所做的只是引用较新的 TFS 相关程序集并重新编译，然后部署到我的本地 2012 文件夹以获取它。2012 和 2010 都指向同一个 TFS 2010 进程模板。看起来两者呈现的控件不同，或者基于不同的值自动调整大小。这是一个错误还是我没有处理的一些设置？

我的一个选择是将控件设置为特定大小，但我不想这样做。有人可以提示我为什么这些渲染不同吗？

**更新**：在玩这个时，控件的大小似乎太大了。在 VS 2012 中，它的空间比在 VS 2010 中多 20-30 像素，所以当它自动调整大小时，它太大了，但是渲染中的某些东西将其切断。当我移动内部控件以在控件右侧提供一个空白空间时，它们就会出现；但是，我也注意到，当我放大窗口然后尝试将其缩小回来时，即使自动调整大小设置为缩小和增长，控件也不会再变小。

**更新**：我已将此发布到 Connect 站点，因为它可能是 Studio 中的错误。[http://connect.microsoft.com/VisualStudio/feedback/details/781607/updgrading-tfs-explorer-custom-control-from-2010-to-2012-rendering-differences](http://connect.microsoft.com/VisualStudio/feedback/details/781607/updgrading-tfs-explorer-custom-control-from-2010-to-2012-rendering-differences)

# php - 使用 for 循环打印数组

> ID：15234955
> 
> 赞同：3
> 
> 时间：2013-03-05T21:58:20.837
> 
> 标签：php, arrays, for-loop

我想将此数组打印到最多 21 个的所有索引，但在此代码中，这仅打印到数组长度，我应该在**for 循环**中打印整个数组吗？

```
<?php
$array=array(0=>"hello",
             1=>"world", 
             2=>"this", 
             3=>"is", 
             4=>"an", 
             20=>"array",
             21=>"code" );

$length=count($array);

for($i=0;$i<$length;$i++){
         echo "$i=>".$array[$i]; 
         echo "<br />";

      }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:12:50.430

您的困难在于您定义数组的方式：

```
$array=array(0=>"hello",
             1=>"world", 
             2=>"this", 
             3=>"is", 
             4=>"an", 
             20=>"array",
             21=>"code" ); 
```

php 中的数组实际上是 hashmap；当您`5`在上述数组上调用 index 时，它是未定义的。不会定义最多 20 的索引项，这些将注意：

```
PHP Notice:  Undefined offset:  5 
```

因为您使用数组长度作为迭代变量，并准确调用该变量，所以您永远不会在代码中获得位置 20 和 21。

这是您的阵列在计算机上的样子：

```
0 => "hello"
1 => "world"
2 => "this"
3 => "is"
4 => "an"
5 => NULL
6 => NULL
7 => NULL
... //elided for succinctness 
19 => NULL
20 => "array"
21 => "code" 
```

当你调用`$array[7]`它不能返回任何东西。当您调用`$array[20]`它时，它将返回“数组”。

你真正想要的是一个 foreach 循环：

```
foreach($array as $key => $val) {
    //key will be one of { 0..4, 20..21}
    echo "$key is $value\n";
} 
```

导致：

```
$ php test.php 
0 is hello
1 is world
2 is this
3 is is
4 is an
20 is array
21 is code 
```

如果必须使用 for 循环：

```
$key_array = array_keys($array);
for($i=0;$i<count($key_array);$i++){
   $key = $key_array[$i];
   echo "$key => ".$array[$key]."\n";
} 
```

请注意，这不是一个干净的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:18:57.210

使用 for 循环的解决方案：

```
$array=array(0=>"hello",
             1=>"world", 
             2=>"this", 
             3=>"is", 
             4=>"an", 
             20=>"array",
             21=>"code" );

$max = max(array_flip($array)); // What if max array key is 10^5 ?
for($i=0;$i<=$max;$i++){
    if(isset($array[$i])){
        echo "$i=>".$array[$i]."<br>";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:03:26.180

```
foreach($array as $key=>$value){
    echo $key."=>".$value; 
    echo "<br />";
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-05T22:03:52.280

您想以 $i=0 开始循环，因为 PHP 使用零索引。同样在您的循环中，您希望将交互的最大值限制在 $i

```
 <?php
    $array=array(0=>"hello",
                 1=>"world", 
                 2=>"this", 
                 3=>"is", 
                 4=>"an", 
                 20=>"array",
                 21=>"code" );

    $length=count($array);

    for($i=0;$i<$length;$i++){
             echo "$i=>".$array[$i]; 
             echo "<br />";

          }
    ?> 
```

# asp.net - 手机造型；iOS 6 中的“选择文件”按钮太小

> ID：15234958
> 
> 赞同：2
> 
> 时间：2013-03-05T21:58:29.440
> 
> 标签：asp.net, html, css, ios6, safari

我目前正在设计几个最初用 ASP.NET 编写的用于移动设备的简单表单页面。我在 CSS3 中使用媒体检测来确定设备是否是移动设备，如果是移动设备，我基本上会让一切看起来更大。到目前为止，这在我测试过的大多数手机中都有效，但在 iOS6 中，“选择文件”按钮顽固地拒绝像其他所有元素一样变大。我尝试通过其 ID 或仅通过所有输入对其进行样式设置，虽然我可以更改颜色或字体，但大小永远不会改变。如何使选择文件按钮看起来更大？

我的 CSS 页面：

```
@import url(master.css);

/* --- page wrapper --- */
#wrapper { width:80%; margin:auto; max-width:1200px; position:relative; border:1px solid #000; background-color:#000; }
#main { width:100%; height:100%; border-bottom:1px solid #000; }
#content { height:100%; background-color:#CDCCCC; padding: 20px 50px 20px 50px; }
#login { text-align:center; }
#upload { padding:10px; }
#list {  display: inline; width: auto; height: auto; }
#logoutButton { display: inline; float: right; }
#guidelines {
    text-align:justify;
}
#flash { 
    padding: 20px; 
}
@media only screen and (max-width: 720px), only screen and (max-device-width: 720px) {
     #logoutButton {
        display: inline;
        float: right;
    }
    #guidelines {
        background-image:url(http://cite.nwmissouri.edu/PhotoContest_MobileApp/transparentbg4androidwidthbug.png);
        background-repeat:repeat;
        text-align:inherit;
        height:100%; 
        background-color:#CDCCCC; 
    }
    #hwrapper {
        width:initial;
    }

    #contentum { 
        height: 100%; 
        width:inherit;
        background-color:#CDCCCC; 
        text-align:inherit; 
        font-size:40px; 
        padding-right: 5px;
    }
    input {
        font-size:40px;
        height:inherit;
        width:inherit;
    }

    select {
        font-size:40px;
        height:auto;
        width:inherit;
    }

    #upload {
        font-size: 40px;
        text-align: start;
        height: 100%;
        width: 100%;
        padding-right: 12px;
    }
    #wrapper {
        width:inherit; 
        height:inherit; 
        margin:auto; 
        position:inherit; 
        border:1px solid #000; 
        background-color:#000; 
        overflow:scroll;
    }
    li {
        font-size: 40px;
        text-align: start;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:32:27.753

如果我理解，您希望文件上传 ( `<input type="file"/>`) 按钮显示得更大吗？

您应该能够为 WebKit 使用以下（非标准）伪元素选择器：

```
input[type="file"]::-webkit-file-upload-button {
    /* add styles here, such as width, height etc. */
} 
```

您可以使用（类似的非标准）在 IE10 中执行相同操作：

```
input[type="file"]::-ms-browse {
    /* add styles here, such as width, height etc. */
} 
```

# c - 使用 Autoconf 为 ARM 进行交叉编译

> ID：15234959
> 
> 赞同：16
> 
> 时间：2013-03-05T21:58:29.753
> 
> 标签：c, cross-compiling, autoconf

我在使用 autconf 为我的手臂板交叉编译库时遇到问题。

我正在使用这条线：

```
./configure --target=arm-linux --host=arm-linux --prefix=/bla/bla/bla/linux_arm_tool CFLAGS='-m32'
make
make install 
```

当我`file`检查它时，我得到：

```
libjpeg.so.8.4.0: ELF 32-bit LSB shared object, Intel 80386, version 1 (SYSV), dynamically linked, not stripped 
```

这似乎根本不对，但我还是尝试使用它......我得到：

```
/usr/lib/gcc/arm-linux-gnueabi/4.5.3/../../../../arm-linux-gnueabi/bin/ld: skipping incompatible /bla/bla/bla/bla/../linux_arm_tool/lib/libjpeg.so when searching for -ljpeg 
```

我很茫然，我已经在谷歌上搜索了一个小时......

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-05T22:56:08.597

所以我知道我在使用真正基本的方法调用之前已经进行了交叉编译，并且在检查输出之后我弄清楚了为什么我已经摆脱了这个：

```
checking for arm-linux-gnueabi-gcc... no
checking for gcc... gcc
...
...
checking for arm-linux-gnueabi-gcc... gcc 
```

在我`/usr/bin`没有`arm-linux-gnueabi-gcc`，我必须：

```
ln -s /usr/bin/arm-linux-gnueabi-gcc-4.5 /usr/bin/arm-linux-gnueabi-gcc 
```

* * *

我使用以下方法成功交叉编译：

```
./configure --host=arm-linux-gnueabi -prefix=${CSTOOL_DIR}/linux_arm_tool 
```

至于链接......我仍然需要检查一些事情，但我会假设我可能需要`-rpath-link`在更高级的编译中抛出一些标志。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-01-16T23:17:44.517

我认为这个问题可以更一般地重述为：“我如何使用 Autoconf 为 ARM 进行交叉编译？”

根据`./configure -h`：

```
System types:
  --build=BUILD     configure for building on BUILD [guessed]
  --host=HOST       cross-compile to build programs to run on HOST [BUILD] 
```

官方 GNU 文档有助于回答这个问题：

[http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Hosts-and-Cross_002dCompilation.html](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Hosts-and-Cross_002dCompilation.html)

请注意，当他们定义`--host`and 和的用法时`--build`：

```
Therefore, whenever you specify --host, be sure to specify --build too. 
```

这是我刚刚`iperf`为我的嵌入式 ARM 平台配置的示例：

首先，“./configure”脚本实际上被称为“Autoconf”，这对 google-ing 很有帮助。这里的想法是：

*   让你的交叉编译器在你当前的 $PATH 中
*   设置 CC 和 CXX 环境变量指向交叉编译器
*   给出正确的 --host 和 --build

    ```
    buildpath    <--- my little script to setup my $PATH
    export CC=arm_v5t_le-gcc
    export CXX=arm_v5t_le-g++
    ./configure --host=armv5tl-montavista-linux-gnueabi --build=x86_64-linux-gnu 
    ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T22:05:36.480

您需要覆盖环境变量 CC、LD 和其他相关变量。设置这些开关并不能告诉配置您的交叉工具链在哪里（它可能在任何地方）

查看各种项目的一些指南，例如： [http ://wiki.wxwidgets.org/Cross-Compiling_Under_Linux](http://wiki.wxwidgets.org/Cross-Compiling_Under_Linux)

另外，这是我为 node.js 设置交叉编译的脚本 - 相同的想法： [https ://gist.github.com/edhemphill/5094239](https://gist.github.com/edhemphill/5094239)

libjpeg 不能工作 b/c 它是 x86 二进制文件，你需要它说：

```
 ELF 32-bit LSB executable, ARM, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.26, not stripped 
```

或类似的。

这就是你得到一个`skipping incompatible`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-11T02:17:22.427

```
# Install arm-linux-gnueabi packages
apt-get install libc6-armel-cross libc6-dev-armel-cross \
binutils-arm-linux-gnueabi arm-linux-gnueabi-gcc libncurses5-dev

./configure --target=arm-linux-gnueabi --host=arm-linux-gnueabi
...
checking for arm-linux-gnueabi-gcc... arm-linux-gnueabi-gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... yes
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether arm-linux-gnueabi-gcc accepts -g... yes
checking for arm-linux-gnueabi-gcc option to accept ISO C89... none needed
checking whether arm-linux-gnueabi-gcc understands -c and -o together... yes
checking whether make supports the include directive... yes (GNU style)
checking dependency style of arm-linux-gnueabi-gcc... gcc3
...

make
arm-linux-gnueabi-gcc -DPACKAGE_NAME=\"Tutorial\ Program\" -DPACKAGE_TARNAME=\"tutorial-program\" -DPACKAGE_VERSION=\"1.0\" -DPACKAGE_STRING=\"Tutorial\ Program\ 1.0\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE_URL=\"\" -DPACKAGE=\"tutorial-program\" -DVERSION=\"1.0\" -I.     -g -O2 -MT main.o -MD -MP -MF .deps/main.Tpo -c -o main.o main.c
```

# drupal - php过滤器模块的错误

> ID：15234966
> 
> 赞同：1
> 
> 时间：2013-03-05T21:58:52.473
> 
> 标签：drupal, drupal-modules

当我故意从**php 过滤器模块**的嵌入式 php 代码中抛出一个 php 错误时，Drupal 会显示该消息`The website encountered an unexpected error. Please try again later.`

我们喜欢将出现意外程序员错误的用户发送到错误处理页面，这样他们就不会在没有我们得到通知的情况下登陆死错误页面，所以我试图找出如何在 Drupal 中拦截它。我尝试在 Drupal 中搜索此错误字符串的输出位置，但没有成功。

Drupal 究竟如何处理嵌入式 php 代码中发生的错误，或者更直接地：如何让它重定向到另一个页面或以另一种方式捕获错误？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:27:36.297

该特定错误是 Drupal 将 PHP 异常处理程序显式设置为自定义函数（在 中完成[`_drupal_bootstrap_configuration()`](http://api.drupal.org/api/drupal/includes%21bootstrap.inc/function/_drupal_bootstrap_configuration/7)）的结果。

异常处理程序本身是[`_drupal_exception_handler()`](http://api.drupal.org/api/drupal/includes%21bootstrap.inc/function/_drupal_exception_handler/7)，它调用[`_drupal_log_error()`](http://api.drupal.org/api/drupal/includes%21errors.inc/function/_drupal_log_error/7)，这就是生成错误页面的地方。

我从未尝试过，但我认为您可以通过实现[`hook_boot()`](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_boot/7)和使用[`set_exception_handler()`](http://php.net/manual/en/function.set-exception-handler.php)来提供您自己的核心 Drupal 功能实现，以不同的方式为错误页面设置主题。

这似乎有点漫长，但由于`_drupal_error_log()`没有调用任何钩子（无论如何它可能发生得太早了），如果不编辑核心文件，我看不到任何其他方法。

# swing - 用多个列表数据java填充JTable行

> ID：15234968
> 
> 赞同：0
> 
> 时间：2013-03-05T21:58:55.283
> 
> 标签：swing, jtable

我正在从“步骤”列表中动态填充 JTable。'opening'排序步骤不同于其他步骤，因为它可以包含多个动作，而所有其他步骤类型仅包含一个动作。因此，我希望 - 当达到“开放”类型的步骤时 - 将其所有操作都添加到同一个表中，如下所示：

```
 step name     Action     on Object  value   result
opening      full open    door1       30     ...    delete  replace
             haulgh open  door2       40            delete  replace
             wholeOpen    door1       10            delete  replace

comparison   compare      state1      ..      ... 
```

其中“删除”和“替换”是 JButton 的扩展。我写的代码如下：

```
public DefaultTableModel ListToTableModel(Object[] l, String tableName) throws Exception {

    Vector<String> columnNames = null;
    Vector<Vector<Object>> data = new Vector<>();
    columnNames = new Vector<>(Arrays.asList(" Step name:  ","  Action: ","  On object: ","  Action value: "," Action result: ","                          ","                              "));
    for (int i = 0; i < l.length; i++) {

        for(int j=0;j<((Step) l[i]).action.size();j++){
            Vector<Object> vector = new Vector<>();
            String string="";int k=0;
            if(((Step) l[i]).Name=="opening"){
                 vector.add(((Step) l[i]).Name);

                 for(k=0;k<((Step) l[i]).action.size();k++){
                     string+=((Step) l[i]).action.get(k)+"\n";
                 }
                 vector.add(string);
                 string="";

                 for( k=0;k<((Step) l[i]).onObject.size();k++){
                     string+=((Step) l[i]).onObject.get(k)+"\n";
                 }
                 vector.add(string);
                 string="";

                 for(k=0;k<((Step) l[i]).value.size();k++){
                     string+=((Step) l[i]).value.get(k)+"\n";
                 }
                 vector.add(string);
                 string="";

                 for( k=0;k<((Step) l[i]).result.size();k++){
                     string+=((Step) l[i]).result.get(k)+"\n";
                 }
                 vector.add(string);
                 break;
            }
            else
            {
                vector.add(((Step) l[i]).Name);
                vector.add(((Step) l[i]).action.get(j));
                vector.add(((Step) l[i]).onObject.get(j));
                vector.add(((Step) l[i]).value.get(j));
                vector.add(((Step) l[i]).result.get(j));
                vector.add("delete");
                vector.add("Replace");
            }
            data.add(vector);
        }
        }
    return new DefaultTableModel(data, columnNames) {

        @Override
        public boolean isCellEditable(int rowIndex, int mColIndex) {
            return true;
        }

    };
} 
```

和步骤类是：

```
public class Step {
public String Name=null;
public List<String> action=null;
public List<String> onObject=null;
public List<String> value=null;
public List<String> result=null;

public Step(String n){
    Name=n;
    action=new ArrayList<String>();
    onObject=new ArrayList<String>();
    value=new ArrayList<String>();
    result=new ArrayList<String>();
}

public void add(String act,String onobject ,String val,String res){
    action.add(act);
    onObject.add(onobject);
    value.add(val);
    result.add(res);
} 
```

但我打电话时得到的唯一结果：

```
Step step=new Step("opening");
    step.add("full open","door1","30.0","door_1");
    step.add("haulgh open","door2","40.0","door_2");
    step.add("whole open","door3","40.0","door_3");
           Controller.getStepList().add(step);

    step=new Step("comparison");
    step.add("compare","state1","--","state_1");
       Controller.getStepList().add(step); 
```

是：

```
step name  Action   on Object  value  result
comparison  compare  state1      --    state_1 
```

有人知道它有什么问题吗？

预先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T16:29:41.170

好的，我知道了。当到达一个“正在发生的”步骤类型时，外部循环中的索引 j 指向该步骤的操作列表。但在内部循环中，k 会自行遍历操作列表，并通过将字符串添加到原始数据来结束。问题是 J 继续在正确的相同动作列表上运行，在下一个循环中..所以在最后一个循环中，字符串不包含任何内容..

我解决问题的方法是更改​​ Step 类结构以将整个步骤数据包含在一个 uniq 字符串中，然后我只需以与所有其他步骤类型相同的方式填充“oppening”步骤数据，而无需内部循环。我知道这可能是解决它的更好方法，但是由于其他一些原因，我需要更改 Step 类结构，所以我利用它..

# java - 删除具有给定编号的批次

> ID：15234974
> 
> 赞同：-1
> 
> 时间：2013-03-05T21:59:14.290
> 
> 标签：java, jakarta-ee

我需要删除具有给定编号的批次。它似乎每次都返回 null，或者以未找到的大量响应。这是怎么回事？

问题可能出在其他地方而不是这段代码吗？removeLot 是需要修复的方法。我在这里有点困惑。

```
public class Auction
{
// The list of Lots in this auction.
private ArrayList<Lot> lots;
// The number that will be given to the next lot entered
// into this auction.
private int nextLotNumber;

private ArrayList<Lot> Unsold;

private int  lotNumber;

/**
 * Create a new auction.
 */
public Auction()
{
    lots = new ArrayList<Lot>();
    nextLotNumber = 1;
}

/**
 * Enter a new lot into the auction.
 * @param description A description of the lot.
 * Adds lot to ArrayList
 */
public void enterLot(String description)
{
    lots.add(new Lot(nextLotNumber, description));
    nextLotNumber++;

}

/**
 * Show the full list of lots in this auction.
 */
public void showLots()
{
    for(Lot lot : lots) {
        System.out.println(lot.toString());
    }
}

/**
 * Make a bid for a lot.
 * A message is printed indicating whether the bid is
 * successful or not.
 * 
 * @param lotNumber The lot being bid for.
 * @param bidder The person bidding for the lot.
 * @param value  The value of the bid.
 * If successful bid it removes lot from ArrayList
 */
public void makeABid(int lotNumber, Person bidder, long value)
{
    Lot selectedLot = getLot(lotNumber);
    if(selectedLot != null) {
        Bid bid = new Bid(bidder, value);
        boolean successful = selectedLot.bidFor(bid);
        if(successful) {
            System.out.println("The bid for lot number " +
                               lotNumber + " was successful.");                    
        }
        else {
            // Report which bid is higher.
            Bid highestBid = selectedLot.getHighestBid();
            System.out.println("Lot number: " + lotNumber +
                               " already has a bid of: " +
                               highestBid.getValue());
        }
    }
}

/**
 * Return the lot with the given number. Return null
 * if a lot with this number does not exist.
 * @param lotNumber The number of the lot to return.
 * No longer determines the lot number according to index number.
 */
public Lot getLot(int lotNumber)
{
    if((lotNumber >= 1) && (lotNumber < nextLotNumber)) {
        // The number seems to be reasonable.
        Lot selectedLot = lots.get(lotNumber - 1);
        // Include a confidence check to be sure we have the
        // right lot.
        if(selectedLot.getNumber() != lotNumber) {
            System.out.println("Internal error: Lot number " +
                               selectedLot.getNumber() +
                               " was returned instead of " +
                               lotNumber);
            // Don't return an invalid lot.
            selectedLot = null;
        }
        return selectedLot;
    }
    else {
        System.out.println("Lot number: " + lotNumber +
                           " does not exist.");
        return null;
    }
}

    /**
 * Look for closed lots. Return highest bid and bidder name if sold.
 * If lot not sold print not sold.
 */
public void close(int lotNumber, String description)
{
    for(Lot lot : lots) 
    {
        System.out.println(lotNumber + description); //print lot number and description.
        Bid highestBid = lot.getHighestBid(); //get the highest bid for the lot.
        if (highestBid != null) 
        {
            String name = highestBid.getBidder().getName(); 
            System.out.println(name + " " + highestBid.getValue()); //print bidder and highest bid value
        }     
        else
        {
            System.out.println("Not sold"); //if not sold print "Not sold"
        }
    }
}

       /**
 * Returns the list of unsold lots.
 * If sold print sold statement.
 */
public ArrayList<Lot> getUnsold()
{  
    ArrayList<Lot> unsold = new ArrayList<Lot>();
    for(Lot lot : lots) 
    {
        Bid highestBid = lot.getHighestBid();
        lotNumber = lot.getNumber();
      if (highestBid != null) 
        {

        System.out.println("Lot number " + lotNumber + " is sold"); //retuern "Sold" is highestBid
        }
       else
        {
        System.out.println(lotNumber); //print bidder and highest bid value
        unsold.add(lot); // you are missing this
        }
    }
    return unsold;
}

    /**
 * Remove the lot with the given lot number.
 * @param number The number of the lot removed.
 * @return The Lot with the given number, or null if there is no such lot.
 */
public Lot romoveLot(int number)
{
    if((number >= 1) && (number < nextLotNumber)) {
        // The number seems to be reasonable.
        Lot selectedLot = lots.get(number);
        // Include a confidence check to be sure we have the
        // right lot.
        if(selectedLot.getNumber() != number) {
            System.out.println("Internal error: Lot number " +
                               selectedLot.getNumber() +
                               " was returned instead of " +
                               number);
            // Don't return an invalid lot.
            selectedLot = null;
        }
        else {
             lots.remove(number);
            }
            return selectedLot;

    }
    else {
        System.out.println("Lot number: " + number +
                           " does not exist.");
        return null;
    } 
 }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:05:47.160

我建议`HashMap`根据您的需要使用一个或任何其他哈希表实现。就像是`HashMap<Lot> lots= new HashMap<Lot>();`

将所有`Lot`变量存储到地图中并简单地应用

```
lot.contains(numberYouWantToCheck); 
```

# javascript - 页面在 Firefox 中不断重新加载

> ID：15234978
> 
> 赞同：0
> 
> 时间：2013-03-05T21:59:34.290
> 
> 标签：javascript, html

出于某种原因，仅在 Firefox 中，我们的页面不断重新加载。对此似乎没有任何解释。（在 Mac 和 PC 上的 FF19.0 中发生）

我已经苦苦挣扎了好几个小时试图解决这个问题。我尝试使页面（大部分）在 W3C 中验证，但这也不起作用。我也尝试删除所有 Facebook API 代码，但无济于事。

你可以在这里看到页面：http: [//www.socialgoodnetwork.com/home.php](http://www.socialgoodnetwork.com/home.php)

没有 Facebook 代码： [http ://www.socialgoodnetwork.com/home.php?fb=1](http://www.socialgoodnetwork.com/home.php?fb=1)

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:32:21.747

您似乎正在使用 framebuster.js，当 dom 存在任何框架时，它会重新加载页面……而且您似乎有很多 iframe - facebook 可能是一个，但也可能是 youtube，还有一些是由 javascript 写的。 .

# php - 正则表达式 OR 的界限如何？

> ID：15234983
> 
> 赞同：0
> 
> 时间：2013-03-05T21:59:54.033
> 
> 标签：php, regex

我现在有两个 preg_match_all() 正在运行，我想将它们合并为一个。每个都找到函数 A 或函数 B 的出现。我知道使用 "this|that" 来匹配这个或那个，但是在匹配 "%this()" 或 "%that()" 时，我不确定是否最好匹配 "%this()| %that()" 或者是否有办法绑定 '|' 两边包含的内容 写一些简短的东西，比如“%this|that()”，我相信它会匹配“%this”和“that()”，但不能匹配“this()”或“that()”。我知道解决我的特定问题的其他方法，但我（希望其他发现此问题的人）很想知道如何正确使用“|” 无需重复整个字符串。这里'

```
$regex = '/%myFunc\(([0-9]+)\)/u';
$one = preg_match_all($regex, $text, $matches);
$regex2 = '/%otherFunc\(([0-9]+)\)/u';
$two = preg_match_all($regex2, $text, $matches2); 
```

目标更短，例如：

```
$regex = '/%myFunc|otherFunc\(([0-9]+)\)/u';
preg_match_all($regex, $text, $matches); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:03:57.663

好吧，您可以使用括号对表达式进行分组并控制优先级：

```
%(this|that)\(\) 
```

如果您不想创建新的捕获组，您也可以为此使用非捕获组，这仅用于优先级并且没有副作用：

```
%(?:this|that)\(\) 
```

# android - Android ImageButton 推送颜色

> ID：15234987
> 
> 赞同：0
> 
> 时间：2013-03-05T22:00:09.317
> 
> 标签：android, imagebutton

我有一个 ImageButton 可以在按下时切换图像。问题是当我在两个图像开关之间按下按钮时，动画会将按钮染成蓝色。如何防止蓝色调动画？此外，您如何以编程方式而不是通过 XML 来执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:06:53.080

好吧，对于大多数用例，您应该使用 XML ......但抛开讲座不谈，蓝色背景是[`StateListDrawable`](http://developer.android.com/reference/android/graphics/drawable/StateListDrawable.html)默认设置为按钮背景的 a 的一部分。定义和设置您自己的背景（通过[`setBackgroundResource(int resId)`](http://developer.android.com/reference/android/view/View.html#setBackgroundResource%28int%29)或类似方式）应该足以“摆脱”聚焦颜色状态。

# vb.net - VB.NET 在用户决定退出之前有整个程序循环吗？

> ID：15234991
> 
> 赞同：0
> 
> 时间：2013-03-05T22:00:17.340
> 
> 标签：vb.net, loops, console

我有一个简单的程序来平均十个（用户定义的）数字，然后打印结果。在程序结束时，我想打印`Would you like to average a new set of numbers? (Y/N)`如果用户输入`y`比我希望程序从顶部再次执行。如果用户输入`n`比程序应该关闭。我已经尝试对此进行研究，但只找到了让整个控制台退出并重新打开的方法，这不是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:07:24.943

要检测用户输入的内容，您有几个选项：

```
Console.ReadKey() 
```

将读取下一个按键。然后，您可以使用一个简单的`Select Case`分支来选择要做什么。

您还可以使用：

```
Console.ReadLine() 
```

这将返回一个字符串（在用户按下回车后）。然后，您可以使用简单的 If 语句来确定字符串中的内容（如果输入的不是“y”或“n”，则重复查询。）

例子：

```
Shared Sub Main()    
    While True
        AverageNums()
        Console.WriteLine( "Do you want to run again? (Y/N)" )
        Dim key = Console.ReadKey()
        If key.Key = ConsoleKey.N Then
            Exit While
        End If
    End While    
End Sub

Shared Sub AverageNums()
    ' ...
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-12T13:36:07.217

我的反应可能有点晚了，但我想我会分享一个实现 try-catch 方法的紧凑版本。

```
Sub Main()
    Do
        Try
            Console.Write("Enter a value: ")
            Console.ReadLine()
            '...

            SomeProcedure()

        Catch ex As Exception
            Console.WriteLine(ex.ToString)
        Finally
            Console.Write("Enter another value? (N for No) ")
        End Try

    Loop Until Console.ReadLine() = "N"

End Sub

Sub SomeProcedure()
    '...
End Sub 
```

# javascript - 在特定月份打开 dijit.calendar 但未选择日期

> ID：15234996
> 
> 赞同：0
> 
> 时间：2013-03-05T22:00:38.443
> 
> 标签：javascript, dojo

我在使用 dojo 工具包时遇到了一个非常具体的问题，我在 api 或文档上找不到它的答案。我的页面上有一个独立的日历，它由

```
var myCal = new dijit.Calendar({
                                    'value':            new Date(unixTimestamp * 1000),
                                    'title':            'Title',
                                    'isDisabledDate':   function(data){
                                        var dat =   new Date(data);
                                        dat.setHours(0,0,0,0);
                                        var ms  = parseInt( (dat.getTime()/1000), {'places':0});
                                        return (GERA.palestras.diasComPalestras[ms] !== true);
                                    }
     }, "mycal"); 
```

这确实有效，日历已创建，它位于正确的月/年并选择了日期。我想这样做，但是没有选择日期。所以我想将一年和飞蛾传递给日历以显示在页面上**但不选择日期**。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T23:05:28.557

我知道你的帖子有点老了。

我一直需要类似的东西。查看文档，有一个名为“currentFocus”的属性应该完全按照您所说的进行。也不要为任何东西设置值，它将被取消选中。

```
var myCal = new dijit.Calendar({
                                'currentFocus':            new Date(unixTimestamp * 1000),
                                'title':            'Title',
                                'isDisabledDate':   function(data){
                                    var dat =   new Date(data);
                                    dat.setHours(0,0,0,0);
                                    var ms  = parseInt( (dat.getTime()/1000), {'places':0});
                                    return (GERA.palestras.diasComPalestras[ms] !== true);
                                }
 }, "mycal"); 
```

但是，我个人还没有让这个工作，我想知道你发帖后是否有任何进展？

编辑：这确实有效。后来我的解析器有其他东西破坏了这个变化。