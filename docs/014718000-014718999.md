# StackOverflow 问答 14718000-14718999

# excel - 每次启动宏时如何复制列并将值粘贴到新列

> ID：14718000
> 
> 赞同：1
> 
> 时间：2013-02-05T22:12:39.213
> 
> 标签：excel, vba, offset

我有一个计算 Z 列差异的电子表格。在月底，我想将这些值复制并粘贴到同一个电子表格的另一列中，以跟踪每月的差异。

我有一个宏要从 Z 列复制到 BK 列。

我希望每次运行宏时都从 Z 列复制值并使用以下时间表将其粘贴到新列中：

*   第 1 个月 = 值应粘贴在 BK 列中
*   第 2 个月 = 值应粘贴在 BL 列中
*   第 3 个月 = 值应粘贴在 BM 列中
*   第 4 个月 = 值应粘贴在 BN 列中
*   第 5 个月 = 值应粘贴在 BO 列中
*   第 6 个月 = 值应粘贴在 BP 列中
*   第 7 个月 = 值应粘贴在 BQ 列中
*   第 8 个月 = 值应粘贴在 BR 列中
*   第 9 个月 = 值应粘贴在 BS 列中
*   第 10 个月 = 值应粘贴在 BT 列中
*   第 11 个月 = 值应粘贴在 BU 列中
*   第 12 个月 = 值应粘贴在 BV 列中

在第 12 次迭代之后，我希望将 Z 列中的值复制到 BK 列（起点）中。我相信这可以使用循环来完成？

我很难提出循环逻辑/编码。

```
Sub copyCurrentToPrevious()

    Dim ans As String

    On Error Resume Next

    Application.ScreenUpdating = False

    Sheets("Direct Materials").Activate

    ans = MsgBox("Are you sure you want to copy Previous Month Variance to YTD Variance Tracking?  This action can not be undone." & vbNewLine _
      & vbNewLine & "Select Yes to proceed with the copy/paste operation or Select No to cancel.", vbYesNo + vbExclamation, "Product Costing")

    If ans = vbNo Then Exit Sub

    Range("Z9:Z220").Copy
    Range("BK9").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False

    Range("Z226:Z306").Copy
    Range("BK226").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False

    Range("Z311:Z471").Copy
    Range("BK311").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False

    Range("Z476:Z524").Copy
    Range("BK476").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False

    Application.CutCopyMode = False

    Range("A1").Select

    MsgBox "Copy / paste operation is complete.  Select OK to continue.", vbOKOnly + vbInformation, "Product Costing"

    Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:46:34.210

这是您的代码的重构，添加所需的偏移量，并解决了许多其他问题：

*   使用正确的数据类型`ans`
*   不要使用`Resume Next`. 这就是说*我不在乎我是否有错误，不管怎样，继续。谁知道接下来会发生什么*
*   不要使用`Activate`or `Select`（除非您有特殊需要）。请改用`Workbook`、`Worksheet`和`Range`对象。请注意，这`Worksheets("Direct Materials")`是隐含的说法`Activeworkbook.Worksheets("Direct Materials")`
*   你实际上不需要`Copy`/`Paste`为此。改用返回`Variant Array`的。`.Value`这将更快，并且不易受到其他应用程序使用剪贴板的干扰。这也是一个好习惯，因为它在各种方面都很有用。

* * *

```
Sub copyCurrentToPrevious()
    Dim ans As VbMsgBoxResult
    Dim rng As Range

    On Error GoTo EH

    ans = MsgBox("Are you sure you want to copy Previous Month Variance to YTD Variance Tracking?  This action can not be undone." & vbNewLine _
        & vbNewLine & "Select Yes to proceed with the copy/paste operation or Select No to cancel.", vbYesNo + vbExclamation, "Product Costing")

    If ans = vbNo Then Exit Sub
    Application.ScreenUpdating = False

    With Worksheets("Direct Materials")
        Set rng = .Range("Z9:Z220")
        rng.Offset(0, Month(Now()) + 36).Value = rng.Value

        Set rng = .Range("Z226:Z306")
        rng.Offset(0, Month(Now()) + 36).Value = rng.Value

        Set rng = .Range("Z311:Z471")
        rng.Offset(0, Month(Now()) + 36).Value = rng.Value

        Set rng = .Range("Z476:Z524")
        rng.Offset(0, Month(Now()) + 36).Value = rng.Value
    End With

    MsgBox "Copy / paste operation is complete.  Select OK to continue.", vbOKOnly + vbInformation, "Product Costing"

    Application.ScreenUpdating = True
Exit Sub
EH:
    MsgBox "Something went horribly wrong!"
End Sub 
```

# dependencies - 将 Silex $app 注入自定义控制器类

> ID：14718006
> 
> 赞同：1
> 
> 时间：2013-02-05T22:13:09.520
> 
> 标签：dependencies, silex

我有的：

```
# index.php
$app = new Silex\Application();

... (loading routes file by YamlFileLoader) ...

$app['routes']->addCollection($loader->load('routes.yml'));
$app->run(); 
```

路由：

```
# routes.yml
home:
    pattern: /
    defaults: { _controller: 'Controllers\DefaultController::indexAction' } 
```

如何访问控制器中的 $app 实例？这很简单：

```
# controllers/DefaultController.php
class DefaultController
{
    public function indexAction(Request $request, Application $app)
    {
        // this is the place!
        return $app['twig']->render('index.twig');
    }
} 
```

好的，没关系，但是有几个原因导致我无法接受这种方法。我想使用经典的方式：

```
# controllers/DefaultController.php
class DefaultController
{
    public function indexAction()
    {
        return $this->twig->render('index.twig');
    }
} 
```

为此，我想使用父基类：

```
# controllers/BaseController.php
class BaseController
{
    protected $twig;

    public function __construct(Application $app)
    {
        $this->twig = $app['twig'];
    }
} 
```

正如您所料：

```
# controllers/DefaultController.php
class DefaultController extends BaseController
... 
```

**那么，哪种方式更适合将 silex $app 注入 Base Controller？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:54:34.857

我过去常常做你想做的事情`BaseController`.

在 Controller 类中，定义如下`connect`方法：

```
class MyController implements ControllerProviderInterface                                                                                                                                                                                         
{                                                                                                                                                                                                                                             
    protected $app;                                                                                                                                                                                                                           

    public function connect(Application $app)                                                                                                                                                                                                 
    {                                                                                                                                                                                                                                         
        $this->app = $app;                                                                                                                                                                                                                    
        $controller_collection = $app['controllers_factory'];                                                                                                                                                                                 

        $controller_collection->get('/', array($this, 'searchForm'))->bind('user_search_form');

        // DECLARE ALL YOUR ROUTES HERE
    }

    public function searchForm()
    {
        return $this->app['twig']->render("search_form", array ... )
    }
} 
```

它工作得很好。我也不建议您使用 YML 进行路由，除非您将 PHP 缓存在某处或您想要性能问题。

# javascript - 在数组javascript中获取msg的值

> ID：14718012
> 
> 赞同：-1
> 
> 时间：2013-02-05T22:13:34.563
> 
> 标签：javascript, arrays

我有以下数组：

```
Array
(
[0] => Array
    (
        [id] => 179
        [user_id] => 191
        [behandeling] => msg
    )
) 
```

由于某种原因，我无法获得'behandeling'的价值..我尝试了几种方法，例如：

console.debug(msg[0].behandeling);

有关构建数组的更多信息：

```
$d[] = array('id' => $row['id'],
        'user_id' => $row['user_id'],
        'behandeling' => $row['behandeling']);
//print_r($d);
//echo json_encode($d); 
```

如果我使用 print_r($d)，behandeling 的值 = 正确。如果我使用 json_encode($d)，behandeling 的值为 null..

编辑：

我想我发现了问题.. 提交数据时，数据以这种方式未转义地发送： `var data = 'actie=Wijzig&module=treatment&treatments=' + treatment.val();`

这意味着如果有某些字符需要转义，等等。数据字符串被破坏......这导致空和/或半个消息......

编辑2：

上述发现非常重要，但描述了网站的不同部分。保存数据现在很好，但仍然难以返回一些消息的数据值..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:15:48.320

如评论中所述，这是一个 PHP 数组，您可以尝试以下操作：

```
<script type="text/javascript">
  var myArray = <?=json_encode($array)?>;
  var behandeling = myArray[0].behandleing;
</script> 
```

**更新：**

我相信由于您的标头，Javascript 会将 JSON 解释为常规字符串`content-type`。你应该尝试添加

```
header('Content-Type: application/json'); 
```

输出 JSON 时。

或者，如果由于某种原因您无法更改标题并且您正在使用 jQuery，您可以尝试：

```
var parsed = $.parseJSON(ajaxResults);
var behandling = parsed[0].behandling; 
```

如果没有 jQuery，您可以使用`eval`，但是会涉及安全隐患。

# actionscript-3 - 这个 AGAL 输出正确吗？

> ID：14718014
> 
> 赞同：0
> 
> 时间：2013-02-05T22:13:38.633
> 
> 标签：actionscript-3, flash, 3d, stage3d, agal

我正在尝试转换此着色器：

```
<script id="shader-vs" type="x-shader/x-vertex">
            attribute vec2 pos;
            attribute vec4 aVertexColor;

            varying vec4 vColor;

            void main(void) {
                gl_Position = vec4(pos.x, pos.y, 0.0, 1.0);
                vColor = aVertexColor;
            }

        </script> 
```

和

```
<script id="shader-fs" type="x-shader/x-fragment">
        precision mediump float;

        varying vec4 vColor;

        void main(void) {
            gl_FragColor = vColor;
        }

        </script> 
```

结果（**这个输出对你来说看起来不错吗？或者我遗漏了一些东西**）：

```
mov vt0.zw, vc0.xyyy
mov vt0.x, va0.x
mov vt0.y, va0.y
mov op, vt0
mov v0, va1 
```

和

```
mov oc, v0 
```

但是，如果我将 AGAL 顶点着色器更改为一些非常简单的工作，我将无法显示任何内容：

```
mov op, va0n
mov v0, va1n 
```

当我通过以下方式将 GLSL 转换为 AGAL 时，我添加了常量：

```
var constval:Array;
                for (var constant:String in result.consts) {
                    trace(constant, result.consts[constant]);
                    constval = result.consts[constant];
                    context.setProgramConstantsFromVector( type, int(constant.slice(2)), Vector.<Number>([constval[0], constval[1], constval[2], constval[3]]) )    
                } 
```

我准备了所有这样的缓冲区：

```
 var vertices:Vector.<Number> = Vector.<Number>([
        -0.3,-0.3,0, 1, 0, 0, // x, y, z, r, g, b
        -0.3, 0.3, 0, 0, 1, 0,
        0.3, 0.3, 0, 0, 0, 1]);

    const dataPerVertex:int = 6;
    vertexbuffer = context.createVertexBuffer(vertices.length/dataPerVertex, dataPerVertex);
    vertexbuffer.uploadFromVector(vertices, 0, vertices.length/dataPerVertex );         

    var indices:Vector.<uint> = Vector.<uint>([0, 1, 2]);
    indexbuffer = context.createIndexBuffer(3);         
    indexbuffer.uploadFromVector (indices, 0, 3);       

    context.setVertexBufferAt (0, vertexbuffer, 0, Context3DVertexBufferFormat.FLOAT_3); //Defines shader input va0 as the position data
    context.setVertexBufferAt(1, vertexbuffer, 3, Context3DVertexBufferFormat.FLOAT_3);//Defines shader input va1 as the position data 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T17:29:53.817

我可以看到许多不一致的地方：

1.  你在哪里设置 constval 的值？将 Vector.([constval[0], constval[1], constval[2], constval[3]]) 分配给一个变量并在调试器中检查它。
2.  数组值是否具有 x=0.0 和 y=1.0？
3.  您是在设置顶点缓冲区之前设置常量吗？您的常量可能会被其他渲染代码覆盖。
4.  您的顶点缓冲区对于位置和颜色都是 FLOAT_3 格式，但您的顶点着色器要求位置的 vec2 属性和颜色的 vec4 属性。

常数更有可能是问题所在。您可以通过在位置向量中硬编码它们来测试您的常量是否应该受到指责，如下所示：

1.  硬编码 0.0 和 1.0 的常量

    ```
    var vertices:Vector.<Number> = Vector.<Number>([
        -0.3,-0.3, 0.0, 1.0, 1, 0, 0, // x, y, z=0.0, w=1.0, r, g, b
        -0.3, 0.3, 0.0, 1.0, 0, 1, 0,
        0.3, 0.3, 0.0, 1.0, 0, 0, 1]); 
    ```

2.  更改顶点数据的大小以匹配

    ```
    const dataPerVertex:int = 7; 
    ```

3.  更改缓冲区设置以反映新的大小和偏移量

    ```
    context.setVertexBufferAt (0, vertexbuffer, 0, Context3DVertexBufferFormat.FLOAT_4); //Defines shader input va0 as the position data
    context.setVertexBufferAt(1, vertexbuffer, 4, Context3DVertexBufferFormat.FLOAT_3);//Defines shader input va1 as the position data 
    ```

4.  现在在这里更改您的脚本：

    ```
    attribute vec4 pos; 
    ```

5.  和这里：

    ```
    gl_Position = pos; 
    ```

如果您的问题消失了，则表明您没有发送正确的常量。恢复到旧代码并确保正确上传常量。

# c++ - 调试断言失败的 InsertItem 函数

> ID：14718019
> 
> 赞同：0
> 
> 时间：2013-02-05T22:14:22.107
> 
> 标签：c++, mfc, modal-dialog

目前在 MFC 中编写一个基于对话框的应用程序，当按下主对话框上的按钮时，它会创建一个子对话框。子对话框则有 3 个编辑控制框和一个按钮。当按下按钮时，来自三个编辑控制框的信息被检索并存储为单独的 CStrings。这些 CString 被传递给位于 Main Dlg.cpp 中的函数。该函数获取这些字符串并将它们插入到列表控件中。该程序构建良好并一直运行，直到按下添加按钮（在子对话框上）。不知道为什么程序崩溃我似乎有正确的参数？我也不确定这是否是在两个对话框之间传递这样的数据的最佳方式。任何更好的想法也值得赞赏。

**弹出添加按钮功能**

```
 void Popup::OnBnClickedPopadd()
   {
    CString str1, str2, str3;
    CThermotronDlg dlg;
    GetDlgItemText(ID_RampEdit,str1);
    GetDlgItemText(ID_DwellEdit,str2);
    GetDlgItemText(ID_TempEdit,str3);

    dlg.ReciveAndDisplay(str1,str2,str3);
   } 
```

**接收显示功能**

```
 void CThermotronDlg::ReciveAndDisplay(CString str1, CString str2,CString str3){

    LPCTSTR ramp(str1),dwell(str2),temp(str3);

    MyListEx.InsertItem(1,ramp);
    MyListEx.SetItemText(0,1,dwell);
    MyListEx.SetItemText(0,2,temp);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T01:29:33.250

无需在弹出对话框中初始化变量`CThermotronDlg dlg;`，您需要找到主对话框的地址并直接调用此对话框的 ReceiveAndDisplay 方法。一种方法是访问[`m_pMainWnd`](http://msdn.microsoft.com/en-us/library/f3ddxzww%28v=vs.80%29.aspx)应用程序对象的公共变量 ( `theApp`)。的正确代码`OnBnClickedPopadd()`将是：

```
 void Popup::OnBnClickedPopadd()
   {
    CString str1, str2, str3;
    CThermotronDlg *pDlg = (CThermotronDlg*)theApp.m_pMainWnd;
    GetDlgItemText(ID_RampEdit,str1);
    GetDlgItemText(ID_DwellEdit,str2);
    GetDlgItemText(ID_TempEdit,str3);

    pDlg->ReciveAndDisplay(str1,str2,str3);
   } 
```

# c++ - 如何用 cvmGet 替换对 cvGetReal2D 的调用？

> ID：14718020
> 
> 赞同：0
> 
> 时间：2013-02-05T22:14:25.213
> 
> 标签：c++, windows, optimization, opencv

`cvGetReal2D`我怎样才能用替换我的电话`cvmGet`？

我有类似的功能

```
bool someFunction(CvPoint2D32f location, IplImage &image)
{
  // code
  z = cvGetReal2D(image, location.y, location.x);
  // code
} 
```

我正在尝试替换`cvGetReal2D`，`cvmGet`因为我读到它更快 - 但我是 OpenCV 的初学者（我正在修改其他人编写的代码）。

我`CvMat`每次都必须为每个点创建一个整体吗？在那种情况下，因为我无法改变我正在传递的事实`IplImage`......改变会使代码变慢，对吧？

```
CvMat* imageCopy = cvCreateMat(image.width, image.height, image.depth); 
```

（我也看到过类似的常量`CV_32FC1`- 但我不知道如何选择）

那么，我要复制它吗？

```
cvCopy(image, imageCopy);    // I hope this would copy the values
I tried - I get an exception... 
```

它适用于多通道矩阵吗？我是否必须询问有多少个频道并对其进行迭代？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:31:46.153

使用以下方法将 IplImage 转换为 Mat：

```
IplImage *img; 
Mat imgMat(img); 
```

然后你可以使用`cvmGet`

`CV_32FC1`可以选择如下：

```
Mat imageCopy = cvCreateMat(image.width, image.height, image.depth, CV_32FC1); 
```

我希望你使用的是 OpenCV 2.4x

```
#include <opencv2/opencv.hpp>
#include <opencv2/highgui/highgui.hpp> 
```

包括这些以使用 cv::Mat

使用 cvarrtoMat：

```
IplImage A1; 
Mat B1 = cvarrToMat(&A1); 
```

# django - 在 Django 中，我如何获得两个以上模型的聚合数据

> ID：14718021
> 
> 赞同：1
> 
> 时间：2013-02-05T22:14:26.567
> 
> 标签：django, orm, models, aggregate, django-queryset

```
class Book(models.Model):
    # fields

class Chapter(models.Model):
     book = models.ForeignKey(Book)

class Page(models.Model):
     chapter = models.ForeignKey(Chapter) 
```

如果我想知道那本特定书“A”的页数，实现这一目标的最佳方法是什么？

当然，我可以循环阅读 A 书的章节并对每章的页面求和，但我认为这不是更聪明的方法。

有没有办法通过 ORM / Queryset 做到这一点？某种聚合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:25:45.383

像这样的东西可以工作：

```
book_a = Book.objects.get(name='A')
page_count = Page.objects.filter(chapter__book=book_a).count() 
```

这将导致数据库连接，这将返回章节来自书籍 A 的页数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:09:08.527

尝试类似：

```
from django.db.models import Count

page_count = Book.objects.filter(name='A').annotate(Count(chapter__pages)) 
```

结果应该在`page_count[0].chapter__pages__count`. 查看[文档](https://docs.djangoproject.com/en/dev/ref/models/querysets/#annotate)以获取更多信息。

# sql - 连接两个表的查询的 SQL Server“FOR XML”输出

> ID：14718026
> 
> 赞同：3
> 
> 时间：2013-02-05T22:14:43.720
> 
> 标签：sql, sql-server, xml, xsd

我是 SQL Server 中“FOR XML”功能的新手。我正在使用 SQL Server 2012。

我有两个表，Word 和 Word_Expansion。

样本数据：

表[字]：

```
WordOID   Word
-------   ----    
      1   PIPE
      2   WIRE 
```

表 [Word_Expansion]：

```
WEOID  fk_WordOID  Word_Expansion
-----  ----------  --------------
    1          2             COAX
    2          2    SPEAKER CABLE
    3          1          CONDUIT 
```

现在，我想生成类似于以下内容的 XML：

```
<expansion>
  <sub>WIRE</sub>
  <sub>SPEAKER CABLE</sub>
</expansion>
<expansion>
  <sub>PIPE</sub>
  <sub>CONDUIT</sub>
</expansion> 
```

我已经在制作 XML FOR 语句方面付出了各种努力，但我似乎无法理解我需要做些什么才能将这两个表混合到正确的 XML 输出中。我将进一步深入研究 XML FOR 语法，但如果您有时间并且非常了解这一点...

有人对我应该尝试什么有任何指示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:32:09.140

这应该为您解决问题：

**SQL：**

```
SELECT Word Sub,      
        (      
             SELECT Word_Expansion  AS Sub   
             FROM Word_Expansion WE
             WHERE WE.fk_WordOID = W.WordOID 
             FOR XML PATH(''), type 
        )      
FROM Word W
FOR XML PATH ('Expansion') 
```

**XML 输出：**

```
<Expansion>
  <Sub>Pipe</Sub>
  <Sub>CONDUIT</Sub>
</Expansion>
<Expansion>
  <Sub>Wire</Sub>
  <Sub>COAX</Sub>
  <Sub>SPEAKER CABLE</Sub>
</Expansion> 
```

虽然我不确定你为什么希望 Word.Word 被归类为“Sub”？这不应该是 Word_Expansion 的父级（应该是子级吗？）

[编辑：我发现这个链接在查看 FOR XML 和嵌套查询Nested FOR XML](http://richarddingwall.name/2008/08/26/nested-xml-results-from-sql-server-with-for-xml-path/)时非常有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:50:33.563

这是我的……我赞成第一个帖子，因为他的速度最快，但它有点不同，所以我认为添加我的不会有什么坏处……

```
With    groupedWords
As
(
        Select  WordOID, 
                Word
        From    Word
        Union   
        Select  fk_WordOID, Word_Expansion
        From    Word_Expansion
)
Select (Select  s.word As sub 
        From    groupedWords s 
        Where   s.WordOID = n.WordOID 
        For     Xml Path(''), Type)
From    groupedWords n
Group   By n.WordOID
For     Xml Path('expansion') 
```

# android - 安卓。如何在另一个图像上添加透明图像

> ID：14718028
> 
> 赞同：1
> 
> 时间：2013-02-05T22:15:01.173
> 
> 标签：android, xml, splash-screen

我知道如何通过surfaceView 做到这一点，我想知道我是否应该走那条路。

我只是想创建一个启动画面，它有一个全屏图像，顶部有一个不透明的图像（经过短暂的延迟）。我无法弄清楚这是如何在 XML 代码中完成的。

这就是我所拥有的......

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>

<ImageView
android:id="@+id/lightDot"
android:src="@drawable/splashlight"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@null"
 />

<ImageView
android:id="@+id/bGround"
android:src="@drawable/splash"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
 /> 
```

所以我的“lightDot”对象是半透明的，我想在短暂的延迟后将它覆盖在我的 bGround 资源之上。

这是我的代码：

```
import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

public class SplashAct extends Activity implements OnClickListener{

Button mainButton;
Button lightDot;
ImageView background;
ImageView light;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splashscreen);

    background = (ImageView)findViewById(R.id.bGround); 
    light = (ImageView)findViewById(R.id.lightDot); 

    background.setOnClickListener(this);
}

@Override
public void onClick(View arg0) {
    //finish();
    Intent toMainGame = new Intent(this, ActOptions.class);
    startActivity(toMainGame);
    }

} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T22:38:05.793

你想要的是一个[FrameLayout](http://developer.android.com/reference/android/widget/FrameLayout.html)。

> 子视图绘制在堆栈中，最近添加的子视图在顶部。

您可以更加了解叠加层的使用位置`layout_gravity`，但听起来这就是您所需要的。

```
 <FrameLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <ImageView
            android:id="@+id/image"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:src="@drawable/image" >
        </ImageView>

        <ImageView
            android:id="@+id/overlay"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:src="@drawable/overlay"/>
    </FrameLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:20:06.653

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:id="@+id/ll"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
***android:background="@drawable/splash"*** > 
```

* * *

```
// Try this for invisible
iv.getBackground().setAlpha(0);

//Try this for visible 
iv.getBackground().setAlpha(255);

//What great about this is that you could create a loop 
//to slowly increment the alpha, creating a fade effect instead of 
//invisible to visible. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:29:21.270

使用相对布局而不是线性布局。

这允许您将视图彼此叠加，而不是在线性列表中。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="vertical"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  >

  <ImageView
    android:id="@+id/lightDot"
    android:src="@drawable/splashlight"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@null"
     />

  <ImageView
    android:id="@+id/bGround"
    android:src="@drawable/splash"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
     />

</RelativeLayout> 
```

要使点在时间之后出现，`android:visiblity="INVISIBLE"`请在 xml 中使用。（所以它开始不可见）

然后`light.setVisiblity(View.VISIBLE);`在您的代码中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:45:54.227

你可以使用[LayerDrawable](http://developer.android.com/reference/android/graphics/drawable/LayerDrawable.html)

定义一个简单的线性布局

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/splash_layout"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
> 
```

在您的活动课程中：

```
LinearLayout layout = (LinearLayout) findViewById(R.id.splash_layout);
Drawable drawableLayers[] = new Drawable[] {getResources().getDrawable(R.drawable.splash), getResources().getDrawable(R.drawable.splashlight)};
// ^ The order of drawables is important: The above line overlays splashlight on top of splash.
LayerDrawable layerDrawable = new LayerDrawable(drawableLayers);
layout.setBackgroundDrawable(layerDrawable); 
```

# asp.net - .NET 4.0 FormsAuthentication.SetAuthCookie 失败

> ID：14718032
> 
> 赞同：1
> 
> 时间：2013-02-05T22:15:08.790
> 
> 标签：asp.net, vb.net, forms-authentication

我知道已经有一些问题，但似乎没有一个可以帮助我解决问题。

我正在调试一个 VB.NET webForms 应用程序，但我无法让 FormsAuthentication.SetAuthCookie 工作（使用非持久性 cookie）。当我在监视窗口中检查它时，它似乎创建了一个 HttpContext.Current.User 对象，它似乎已经创建了该对象，但不是它的“Identity”属性。

我已经阅读了一堆 SO 帖子检查了基本的东西，比如查看我的浏览器是否支持 cookie 等......这个项目是我们早期项目的直接端口，它对此处列出的所有内容使用相同的代码，相对而言，它工作得很好。这引发异常的地方是从我应该得到它的 BLL 代码中调用它的地方。

这是调用 FormsAuthentication 方法的代码...：

```
 'When participant logs in having already created records in DB. 
Protected Sub btnGo_Click(ByVal sender As Object, ByVal e As System.Web.UI.ImageClickEventArgs) Handles btnGo.Click
    If Me.txtUsername.Text.Trim.Length <> 0 AndAlso Me.txtPassword.Text.Trim.Length <> 0 Then
        If Membership.ValidateUser(Me.txtUsername.Text, Me.txtPassword.Text) Then
            FormsAuthentication.SetAuthCookie(Me.txtUsername.Text, False)

            'This is where we run into trouble; the property checks with the forms auth...
            MyBLL.Common.CurrentUser = New MyBLL.User(Me.txtUsername.Text)

            'set site property.. 
            If Site_ IsNot Nothing Then
                MyBLL.Common.CurrentUser.Site = Me.Site_
            End If
            MyBLL.Common.CurrentParticpant = Nothing
            MyBLL.Common.CurrentParticpantVisitID = -1
            Response.Redirect("~/Apps/Dashboard.aspx", True)
        Else
            Me.lblLoginMsg.Visible = True
        End If
    Else
        Me.lblLoginMsg.Visible = True
    End If
End Sub 
```

这是 BLL 对象的代码（它有一个从 HttpContext 调用用户的共享属性...）

```
 Public Shared Property CurrentUser() As MyBLL.User
        Get
            Dim objUser As MyBLL.User

            If Not IsNothing(HttpContext.Current.Session("currentSiteUser")) Then
                objUser = CType(HttpContext.Current.Session("currentSiteUser"), MyBLL.User)
                If objUser.Username <> HttpContext.Current.User.Identity.Name Then
                    objUser = New MyBLL.User(HttpContext.Current.User.Identity.Name)
                    HttpContext.Current.Session("currentSiteUser") = objUser
                End If
            Else
                objUser = New MyBLL.User(HttpContext.Current.User.Identity.Name)
                HttpContext.Current.Session("currentSiteUser") = objUser
            End If

            Return objUser

        End Get
        Set(ByVal value As MyBLL.User)
            '_CurrentUser = value
            HttpContext.Current.Session("currentSiteUser") = value
        End Set
    End Property 
```

这是我的 webConfig 中的 Forms 元素；对我来说，这里的一切似乎都很好......

```
 <authentication mode="Forms">
        <forms loginUrl="~/Public/Default2.aspx" defaultUrl="~/Public/Default2.aspx" timeout="60"/>
    </authentication> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:17:35.610

您应该在调用该方法后**立即**重定向，`SetAuthCookie`并且仅在后续请求中您可能希望初始化完整的 IPrincipal。不要尝试`HttpContext.Current.User.Identity.Name`在调用该`SetAuthCookie`方法的同一控制器操作中进行访问。它不会有任何影响。重定向很重要，因此在下一次请求时，表单身份验证模块将从请求 cookie 构建主体。

在您的`CurrentUser`方法中，您似乎正在调用该`HttpContext.Current.User.Identity.Name`属性，但这在您重定向之前不可用。

# css - 调整屏幕大小时，响应式图像不会随 Firefox 缩放。在其他浏览器中工作

> ID：14718033
> 
> 赞同：6
> 
> 时间：2013-02-05T22:15:12.603
> 
> 标签：css, firefox, responsive-design

我是响应式图像的新手，但已经想出了如何使用以下 CSS 让我的图像在 Safari、Opera 和 Chrome（不了解 IE）中缩放：

```
img {   
  max-width: 100%;   
  width: auto;   
  height: auto; 
} 
```

随着屏幕尺寸的改变，图像会缩放。在 Firefox 中，图像不会缩放，除非我将 width:auto 更改为 width:100%; 然后 Safari 在加载或重新加载时将图像压缩为空；虽然，清算现金使其全尺寸。我正在使用 Zen 7.5-dev 响应主题开发 Drupal。我将我的 css 文件保存在 SASS 中，但这可能只是一个 CSS 问题。也许我错过了 HTML 5 或 CSS3 方面的一些东西。

无论如何，我通过覆盖 Firefox 特定指令的图像宽度来完成工作，如下所示：

```
/* Make Firefox images scale with screen width. The width:100% messes up on Safari */
@-moz-document url-prefix() {  
  img {   
    width: 100%;   
  }
} 
```

我认为我不应该这样做，而且谷歌搜索似乎没有遇到这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-13T16:03:40.143

这是用于响应式图像的默认 CSS：

```
img {
  max-width: 100%;
  height: auto;
  width:100%;
} 
```

这是必不可少的 Javascript：[Bongard.net](https://web.archive.org/web/20080206142139/http://www.bongard.net/blog/2007/12/07/browsererkennung-mit-javascript-browserweiche/)

*感谢 David Bongard 的 Javascript。*

现在将以下内容添加到脚本的“if safari”规则中：

```
for (var i = 0; i < document.getElementsByTagName("img").length; i++) {
  document.getElementsByTagName("img")[i].style.width = "auto";
  } 
```

Safari 希望`width:auto;`我测试的其他浏览器都满意`width:100%;`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-27T16:10:52.543

这对我有用

```
@-moz-document url-prefix() {  
    img{
        width: 100%;
        max-width: 100%;
    }
}

@media screen and (-webkit-min-device-pixel-ratio:0) {    
     img{
        max-width: 100%;
    }    
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-21T14:59:11.430

我有类似的问题，发现`max-width`包装元素上的设置有点解决了这个问题。（仅在 Firefox 23 上测试过，但它也应该适用于早期的 Firefox。）另见这些 JSFiddle：

*   [http://jsfiddle.net/CLUGX/](http://jsfiddle.net/CLUGX/)（在 Firefox 上演示该问题）
*   [http://jsfiddle.net/CLUGX/1/](http://jsfiddle.net/CLUGX/1/)（用于`max-width`包装器来解决问题）
*   [http://jsfiddle.net/CLUGX/4/](http://jsfiddle.net/CLUGX/4/)（演示响应式大小调整有效，尝试调整内框大小）

在最大宽度之前：

![在最大宽度之前](../Images/15eb3bcb39792f760685db99f0777795.png)

最大宽度后：

![在最大宽度之后](../Images/c485a303ff794ba9a7d9ca46c4261b6a.png)

但是，需要注意的一件事是，如果您碰巧`padding`在 wrapper 元素上进行了设置，它不会被纳入`img`的宽度计算中，并且会导致 Firefox 和 Safari 之间的结果不一致（[http://jsfiddle.net/CLUGX/3/](http://jsfiddle.net/CLUGX/3/)） ：

![啊啊啊](../Images/973d56ca6da47312d2997a6b630b8ce5.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-06T11:18:02.910

您的图像可能位于收缩包装容器内，然后必须根据图像的宽度计算其宽度。然后图像的最大宽度为容器宽度的 100%。

如果是这样的话，CSS 规范实际上并没有定义这种标记的行为，其中父级的宽度取决于子级，而子级的宽度取决于父级。

有关该问题的一些讨论，请参阅[https://bugzilla.mozilla.org/show_bug.cgi?id=823483 。](https://bugzilla.mozilla.org/show_bug.cgi?id=823483)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-14T07:20:49.190

如果您使用 px 中的图像宽度或使用填充或使用 display:table 而不是 display:block 图像，则图像响应在某些/所有浏览器上将无法正常工作

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-24T07:28:24.683

好吧，在尝试了各种代码和小提琴之后，我的 css 上的这个简单版本对我有用：

```
img {width: 100%;} 
```

只需在您希望图像调整大小的位置，在不添加“宽度”参数的情况下定义它们（从源调整为原始大小）；然后如果您确实希望修复它们的大小，只需在 SRC 样式上添加“宽度”参数（常规宽度 =“”定义将不起作用）。如果它是段落中的内联图像，只需将其包装在一个 div 中并将该 div 对齐到您想要的任何一侧。非常简单！

它适用于 Google、Firefox 和 IE。干杯!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-30T20:21:02.813

我刚刚遇到这个问题并找到了解决方案：当我在 CSS 表中设置 img max-width 时，什么也没有发生 - 图像不会缩放。当我在页面本身中设置最大宽度时 - 调用图像的位置，它适用于所有浏览器和所有设备。

不：

```
img {
    max-width: 100%;
    height: auto;   } 
```

是的：

```
<img src ="image.jpg" style="max-width:100%; height:auto;"> 
```

如果有人可以对此有所启发，请这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-10T22:50:49.630

我使用了 Kridsada Thanabulpong 的 jsfiddle，但只有当我从包装我的图像的 div 中删除 display:table 时，它​​才能工作。

# linux - 如何在表的每一列上循环 awk 命令并输出到单个输出文件？

> ID：14718035
> 
> 赞同：3
> 
> 时间：2013-02-05T22:15:16.543
> 
> 标签：linux, shell, awk

我有一个由单个单元 1s、2s 和 3s 组成的多列文件。每列中有很多重复单元，有时它会从一个单元切换到另一个单元。我想计算在每一列上发生了多少次这种切换。例如在第 1 列中，开关从 1 到 2 到 3 到 1，所以有 3 个开关，输出应该是 3。在第二列中，整列有 2s，所以变化为 0，输出为 0 .

我的输入文件有 4000 列，因此无法手动完成。该文件以空格分隔。

例如：

输入：

```
1 2 3 1 2 
1 2 2 1 3
1 2 3 1 2
2 2 2 1 2
2 2 2 1 2    ......
3 2 2 1 2 
3 2 2 1 1
1 2 2 1 1
1 2 2 1 2
1 2 2 1 1 
```

期望的输出：

```
3    ## column 1 switch times
0    ## column 2 switch times
3    .....
0    
5 
```

我正在使用：

```
awk '{print $1}' <inputfile> | uniq | wc -l
awk '{print $2}' <inputfile> | uniq | wc -l
awk '{print $3}' <inputfile> | uniq | wc -l
.... 
```

这一次执行一列。它会给我第一列的输出“4”，稍后我将只计算 4-1 =3 以获得我想要的输出。但是有没有办法可以将这个 awk 命令写入一个循环并在每一列上执行它并输出到一个文件？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T01:27:47.930

`awk`告诉您变量 NF 的给定行中有多少个字段，因此您可以创建两个数组来跟踪您需要的信息。一个数组将保留给定列中最后一行的值。另一个将计算给定列中的开关数量。您还将跟踪最大列数（并将新列的计数设置为零，以便在该列的开关数为 0 时在最后的输出中正确打印它们）。您还将确保不计算从空字符串到非空字符串的转换——当第一次遇到该列时会发生这种情况。

事实上，如果文件的列数一致，那只会影响第一行数据。如果后续行实际上比第一行包含更多列，则添加它们。如果一列停止出现一段时间，我假设它应该从它停止的地方恢复（好像丢失的列与以前的值相同）。您可以决定不同的算法；这可以算作两次转换（从数字到空白以及从空白到数字。如果是这种情况，您必须修改计数代码。或者，也许更明智的是，您可以决定根本不允许不规则数量的列，在这种情况下，如果当前行中的列数与前一行中的列数不同，您可以提前退出（注意空行，或者它们是否也被取缔？）。

而且您不会尝试在一行上编写整个程序，因为这将是不可理解的，而且确实没有必要。

```
awk '{   if (NF > maxNF)
         {
             for (i = maxNF + 1; i <= NF; i++)
                 count[i] = 0;
             maxNF = NF;
         }
         for (i = 1; i <= NF; i++)
         {
             if (col[i] != "" && $i != col[i])
                 count[i]++;
             col[i] = $i;
         }
     }
     END {
         for (i = 1; i <= maxNF; i++)
             print count[i];
     }' data-file-with-4000-columns 
```

给定您的示例数据（删除了点），脚本的输出符合要求：

```
3
0
3
0
5 
```

这个带有锯齿行的替代数据文件：

```
1 2 3 1 2
1 2 2 1 3
1 2 3 1 2
2 2 2 1 2
2 2 2 1 2 1 1 1
3 2 2 1 2 2 1
3 2 2 1 1
1 2 2 1 1 2 2 1
1 2 2 1
1 2 2 1 1 3 
```

产生输出：

```
3
0
3
0
3
2
1
0 
```

根据我制定的规则，这是正确的——但如果你决定想要不同的规则来覆盖数据，你最终可能会得到不同的答案。

如果您`printf("%d\n", count[i]);`在最终循环中使用，则无需在循环中将计数值设置为零。您付钱并选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:27:01.393

使用循环并为每个列*当前*值保留一个数组，并为相应的*count*保留另一个数组：

```
awk '{for(i=0;i<5;i++) if(c[i]!=$(i+1)) {c[i]=$(i+1); t[i]++}} END{for(i=0;i<5;i++)print t[i]-1}' filename 
```

请注意，这假定列的值不为零。如果您碰巧有零值，则只需将数组初始化`c`为文件中不存在的某个唯一值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T01:45:36.073

为便于查看而编码，SaveColx、CountColx 应该是数组。我至少会在结果中打印列号本身以进行检查:-)

```
BEGIN { 
    SaveCol1 = " "
    CountCol1 = 0
    CountCol2 = 0
    CountCol3 = 0
    CountCol4 = 0
    CountCol5 = 0
}
{
if ( SaveCol1 == " " ) {
    SaveCol1 = $1
    SaveCol2 = $2
    SaveCol3 = $3
    SaveCol4 = $4
    SaveCol5 = $5
    next
    }
if ( $1 != SaveCol1 ) {
    CountCol1++
    SaveCol1 = $1
    }
if ( $2 != SaveCol2 ) {
    CountCol2++
    SaveCol2 = $2
    }
if ( $3 != SaveCol3 ) {
    CountCol3++
    SaveCol3 = $3
    }
if ( $4 != SaveCol4 ) {
    CountCol4++
    SaveCol4 = $4
    }
if ( $5 != SaveCol5 ) {
    CountCol5++
    SaveCol5 = $5
    }
}
END {
    print CountCol1
    print CountCol2 
    print CountCol3
    print CountCol4
    print CountCol5
} 
```

# java - 无论如何要在 try 块的 catch 块中执行后续操作

> ID：14718037
> 
> 赞同：2
> 
> 时间：2013-02-05T22:15:22.853
> 
> 标签：java, exception-handling, scope

我需要将一个 xml 文件保存在一个目录中......如果它的格式不正确。只是为了分析失败的原因。

如何将 xml 请求保存在 catch 块中的目录中？

我试过这样做..但是在 try 块中创建的变量在 catch 块中似乎未定义。我是新手......对不起，如果它是一个基本问题。任何解决方案？

```
 try {
  Create a well formed xml request
  open a http connection and post it
   }
  //catching all exceptions here
  catch (Exception e) {

  e.printStackTrace();
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:20:35.967

{} 大括号限定了 try 块内的变量，因此它们在该范围之外不可用[。](http://en.wikipedia.org/wiki/Scope_%28computer_science%29)你可以这样做：

```
String xml = null;
try {
  xml = ...; //Create a well formed xml request

  //open a http connection and post it
} catch (Exception e) {
    if (xml != null) {
        // write XML to file
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:21:08.070

如果您在 try 块之外/之前定义变量，则可以在 catch 内使用它。但实际上，您应该考虑为什么使用 try/catch 错误处理作为流控制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:24:26.237

您必须在 try 块之外声明变量，然后它将起作用

```
XmlDocument xml = null;
try {
  xml = Create a well formed xml request
  open a http connection and post it
}
catch (Exception e) {
  xml.save();
} 
```

如您所说，在 try 块中声明的任何变量在 catch 块中均不可用，因此您必须将其放在外面

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:25:08.620

如果您在内部块中创建一个新元素，则无法访问它。

因此，如果您在 try 块中创建某些内容，它只会在其上可见。你无法做到这一点。

因此，对于您的问题，您应该从 try 块中创建 xml 请求。像这样的东西；

```
Create a well formed xml request
try {
    open a http connection and post it
}
//catching all exceptions here
catch (Exception e) {
    e.printStackTrace();
} 
```

# android - Android：如何以编程方式设置相机的“GPS 标签”标志？

> ID：14718038
> 
> 赞同：0
> 
> 时间：2013-02-05T22:15:32.207
> 
> 标签：android, android-camera

在 Android API 8 上编程。假设设备 GPS 信号已启用并具有位置修复：

我的三星 Galaxy 标签附带的相机应用程序具有允许对照片进行地理标记的设置。在相机应用程序中，如果我进入“设置|（滚动到底部）GPS 标签”，我可以打开和关闭此功能。

我想以编程方式打开/关闭此设置 - 这可能吗？如果是这样，你能分享一些示例代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:54:58.757

使用 Camera.Parameter 方法

*   setGpsLongitude（双经度）
*   setGpsLatitude（双纬度）
*   setGpsAltitude（双高度）
*   setGpsTimestamp（长时间戳）
*   setGpsProcessingMethod（字符串处理方法）

在使用 Camera#takePicture 拍照之前。您必须以编程方式获取纬度和经度。此外，您需要先调用 Camera.Parameter#removeGpsData()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-10T11:05:53.523

这是无法做到的。我找不到解释原因的链接作为参考，但它与应用程序的工作方式有关。将另一个应用程序调用到您的应用程序时，有些事情是您无法做到的。

您将必须创建一个自定义相机应用程序并使用 beerockxs 描述的 Camera.Parameter 方法。

# svg - 来自 d3.scale.category10() 的渐变颜色在 svg 圆上具有不透明度变化？

> ID：14718044
> 
> 赞同：1
> 
> 时间：2013-02-05T22:15:56.917
> 
> 标签：svg, d3.js, gradient, radial-gradients

我正在尝试将`color = d3.scale.category10();`var 中的颜色应用于圆形 svg 的渐变，我做错了什么？我所看到的只是`color = d3.scale.category10();`（蓝色）到 0% 不透明度渐变的第一种颜色，但仅此而已。如果我取出渐变，那么我会看到我想要的范围是 1-4？提前致谢！

```
var nodes = d3.range(300).map(function() { return {radius: Math.random() * 12 + 4}; }),
    root = nodes[0],
    color = d3.scale.category10();

root.radius = 0;
root.fixed = true;

var force = d3.layout.force()
  .gravity(0.05)
  .charge(function(d, i) { return i ? 0 : -4000; })
  .nodes(nodes)
  .size([width, height]);

  force.start();

var svg = d3.select("body").append("svg:svg")
  .attr("width", width)
  .attr("height", height);

var gradient = svg.append("defs").append("radialGradient")
  .attr("id", "gradient")
  .attr("cx", "50%")
  .attr("cy", "50%");

gradient.append("stop")
  .attr("offset", "75%")
  .style("stop-color", function(d, i) { return color(i % 4); })
  .attr("stop-opacity", "1");

gradient.append("stop")
  .attr("offset", "100%")
  .style("stop-color", function(d, i) { return color(i % 4); })
  .attr("stop-opacity", ".1");

svg.selectAll("circle")
  .data(nodes.slice(1))
  .enter().append("circle")
  .attr("r", function(d) { return d.radius; })
  .style("fill", "url(#gradient)"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T08:28:03.667

您的`stop`元素没有与它们连接的任何数据，因此在您的`function (d, i)`,`i`中将始终为`0`. 如果你只想要两站，你可以这样做：

```
gradient.append("stop")
  .attr("offset", "75%")
  .style("stop-color", color(0))
  .attr("stop-opacity", "1");

gradient.append("stop")
  .attr("offset", "100%")
  .style("stop-color", color(1))
  .attr("stop-opacity", ".1"); 
```

相反，如果您只是想淡化圆圈的边缘，那么渐变根本不是您想要的。相反，您需要对每个圆圈应用纯色，然后在蒙版内创建一个仅不透明度的渐变，并将该蒙版应用于每个圆圈。像[这样](http://bl.ocks.org/4721017/96f3312bc1b7ae2579ff8a5ec2cab5d3e5d88f75)的东西：

```
var defs = svg.append('defs');
var gradient = defs.append('radialGradient')
    .attr('id', 'fadient');
gradient.append('stop')
    .attr('offset', '75%')
    .attr('stop-color', 'white')
    .attr('stop-opacity', 1)
gradient.append('stop')
    .attr('offset', '100%')
    .attr('stop-color', 'white')
    .attr('stop-opacity', .1)

var mask = defs.append('mask')
    .attr('id', 'mask')
    .attr('maskContentUnits', 'objectBoundingBox')
  .append('circle')
    .attr('fill', 'url(#fadient)')
    .attr('cx', .5)
    .attr('cy', .5)
    .attr('r', .5)

svg.selectAll("circle")
  .data(nodes.slice(1))
  .enter().append("circle")
  .attr('cx', function (d, i) { return 20 * i })
  .attr('cy', 50)
  .attr("r", function(d) { return d.radius; })
  .attr('mask', 'url(#mask)')
  .attr("fill", function (d, i) { return color(i); }); 
```

# php - 将 JavaScript 变量传递到 Ajax 数据中：

> ID：14718045
> 
> 赞同：2
> 
> 时间：2013-02-05T22:15:58.297
> 
> 标签：php, javascript, jquery, ajax

我正在研究一个可排序的 jQuery。我从我的数据库中提取信息以填充每个可订购元素，然后将新订单重新发布回我的数据库。但是我无法弄清楚如何获取我在序列化 jQuery 中定义的变量并将其输入到 data: 区域中的 AJAX 函数中。

这是我的代码：

```
$(document).ready(function() 
{              
    $('#social_list').sortable(
    { 
        update: function() 
        {
            var order = $('#social_list').sortable('serialize');
            alert(order);
        }                         
    });
});

$.ajax(
{
    url: 'save_items_order.php',
    data: ?,
    type: '$_POST', 
    success: function(msg)
    {
        alert(msg);
    }
}); 
```

所以我想把 var order 创建的字符串传递给 ajax 所以 data: = var order string

我尝试了数据：$('#social_list').sortable('serialize')，一切似乎都正常，只是似乎没有更新我的表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:20:28.543

最简单的解决方案是做一个全球性的

```
$(document).ready(function() {
    $('#social_list').sortable({
        update: function() {
            // global. you could just omit var, but I find this clearer
            window.order = $('#social_list').sortable('serialize');
        }
    });
});

$.ajax({
    url: 'save_items_order.php',
    data: window.order, /* ...rest of code */
}); 
```

但我敢肯定你知道全局变量是不好的，你至少可以将它们包含在你的命名空间中，

```
var myNs = {};
$(document).ready(function() {
    $('#social_list').sortable({
        update: function() {
            myNs.order = $('#social_list').sortable('serialize');
        }
    });
});

$.ajax({
    url: 'save_items_order.php',
    data: myNs.order /* ... rest of code */
}); 
```

或重新组织您的代码，以便他们可以共享变量。

```
$(document).ready(function() {
    var order;
    $('#social_list').sortable({
        update: function() {
            order = $('#social_list').sortable('serialize');
        }
    });
    $('#myButton').click(function(){
        $.ajax({
            url: 'save_items_order.php',
            data: order, /* ... rest of code */
        });
    });
}); 
```

请注意，对于这种情况，您可以执行以下操作

```
$.ajax({
    url: 'save_items_order.php',
    data: $('#social_list').sortable('serialize') /* ... rest of code */
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T22:18:37.370

您只需将任何 javascript 对象作为数据传递。

对于您的具体情况，我可能会将 AJAX 调用包装在一个函数中，例如：

```
function saveItemOrder(order)
{
    $.ajax({
        url: 'save_items_order.php',
        data: { "order": order },
        type: 'POST', // <-- this should be just "POST"
        success: function(msg){
            alert(msg);
        }
    });
} 
```

接着：

```
update: function() {
    var order = $('#social_list').sortable('serialize');
    // alert(order);

    saveItemOrder(order);
} 
```

# c# - 创建处理多种事件类型的事件处理程序

> ID：14718049
> 
> 赞同：4
> 
> 时间：2013-02-05T22:16:05.287
> 
> 标签：c#

我今天查看了一些旧代码，发现了一个看起来像这样的事件处理程序：

```
public void HandleEvent(EventClassA eventObj)
{
    if(eventObj is EventSubClassA)
    {
        HandleEventSubClassA(eventObj as EventSubClassA);
    }
    else if(eventObj is EventSubClassB)
    {
        HandleEventSubClassB(eventObj as EventSubClassB);
    }
    else if(eventObj.GetType() == typeof(EventSubClassC))
    {
        HandleEventSubClassC(eventObj as EventSubClassC);
    }
    else if(eventObj is EventSubClassD)
    {
        HandleEventSubClassD(eventObj as EventSubClassD);
    }
} 
```

我觉得这有点丑。所以我像这样重构它：

```
delegate void EventHandler(dynamic eventObj);
private static readonly Dictionary<Type, EventHandler> EVENT_MAP = new Dictionary<Type, EventHandler>()
    {
        { typeof(EventSubClassA), HandleEventSubClassA },
        { typeof(EventSubClassB), HandleEventSubClassB },
        { typeof(EventSubClassC), HandleEventSubClassC },
        { typeof(EventSubClassD), HandleEventSubClassD }
    };

public void HandleEvent(EventClassA eventObj)
{
    EVENT_MAP[eventObj.GetType()](eventObj);
}

private void HandleEventSubClassA(dynamic evt)
{
    var eventObj = evt as EventSubClassA;
} 
```

我让一位同事审查了代码，与之前的解决方案相比，我担心这个解决方案的工作方式。我很难相信以前的解决方案是这种情况下的最佳解决方案，所以我求助于 StackOverflow。

有没有更好的方法来构建这种类型的类？是否有一种我不知道的模式是为此而设计的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:40:34.283

您可以使用泛型使您现有的解决方案更加安全：

```
private static Dictionary<Type, Delegate> handlers;

static HandlerClass()
{
    handlers = new Dictionary<Type, Delegate>();
    AddHandler<EventSubClassA>(HandleEventSubClassA);
    AddHandler<EventSubClassB>(HandleEventSubClassB);
    ...
}

public static void AddHandler<T>(Action<T> handler) where T : EventClassA
{
    handlers[typeof(T)] = handler;
}

public void HandleEvent(EventClassA @event)
{
    Delegate handler;
    if(handlers.TryGetValue(@event.GetType(), out handler))
    {
        handler.DynamicInvoke(@event);
    }
} 
```

或者，如果您可以修改事件层次结构中的类，则可以实现访问者模式：

```
public interface IHandlers
{
    void HandleSubClassA(EventSubClassA a);
    void HandleSubClassB(EventSubClassB b);
    ...
}

public abstract class EventClassA
{
    public abstract void Visit(IHandlers handlers);
}

public class EventSubClassA : EventClassA
{
    public override void Visit(IHandlers handlers)
    {
        handlers.HandleSubClassA(this);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:20:38.537

我觉得我错过了什么。为每种事件类型编写重载不是最好的方法吗？

# css - 高度变化时 Chrome 不会重新计算宽度

> ID：14718050
> 
> 赞同：8
> 
> 时间：2013-02-05T22:16:24.453
> 
> 标签：css

我有一个带有链接和图像的缩略图列表，因此当用户悬停一个`li`元素时，它的高度变为 100%，但由于某些奇怪的原因，它在 Chrome 中**出现错误的问题。**我不明白为什么在 Chrome 中悬停的`li`宽度不会调整到它的“新”大小。

*（注意：这是我的问题的简化版本）*

此外，此问题仅发生在`:hover`. 但不是，可以说，与`:nth-child`

[**游乐场链接**](http://jsbin.com/operib/81/edit)

![铬 vs FF](../Images/cf498837154882fa08d52d0cb1e01b4a.png)

## 更新：问题继续...

在答案中查看我的解决方案，但问题仍在继续……我用鼠标放大，你会看到它发生……请注意，图像的数量可能很大。

## 更新 2：

每次触发 mousehweel 事件时强制重绘... `thumbs.hide().show(0);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T15:49:27.280

我的解决方案：[**解决方案游乐场**](http://jsbin.com/operib/81/edit)

*这个想法是通过给图像一个与状态几乎*相同的新高度来欺骗 Chrome 重新计算宽度`li:hover`。但这对 Chrome 来说还不够。转换也必须应用于`img`. 这都是巫毒编码，但这是我能想到的最不难看的解决方案：

```
ul{ list-style:none; display:inline-block; height:80px; white-space:pre; width:100%; }
  li{ display:inline-block; vertical-align:middle; height:60%; -webkit-transition:.2s; transition:.2s; }
  li:hover{ height:100%; }
    li a{ height:100%; padding:0 2px; display:block; }
    li a img{ height:96%; -webkit-transition:.2s; transition:.2s; }
    li:hover a img{ min-height:96%; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:56:04.753

我是新来的，我不确定这是否是一个好习惯，但我会发布我的观察结果，而不是一个精确的解决方案：

1.  同样的问题也出现在 Opera 上。

2.  这对我来说似乎很奇怪 - 当`li:hover a img{ border:1px solid black; }`或任何类似的不应该对当前情况做出任何改变的 css 代码被添加时，这一切都开始表现得非常奇怪。前 - [http://jsbin.com/operib/43/edit](http://jsbin.com/operib/43/edit)

这是我不觉得优雅的解决方案，只是一个快速修复：http: [//jsbin.com/operib/39/edit](http://jsbin.com/operib/39/edit)

编辑：在测试了@Carol McKay 的结果后，我意识到过渡正在把整个事情搞得一团糟。下一个链接（节点 58）是上面链接的节点 43（基本上是节点 1，只是在悬停时为图像添加了边框），移除了过渡，它工作得很好 [http://jsbin.com/operib/58/edit](http://jsbin.com/operib/58/edit)。

似乎应该在悬停时添加任何 css 规则，以便`<img/>`重新计算尺寸。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:57:55.833

改为对图像应用过渡。

css

```
ul{ list-style:none; display:inline-block; height:80px; white-space:pre; width:100%; 
}
li{ display:inline-block; vertical-align:middle; height:60%; }
li a{ height:100%; padding:0 2px; display:block; }
li a img{ display:inline-block; vertical-align:middle; height:96%; transition:0.15s; -   webkit-transition:0.15s; }

li:hover{ height:100%; }
li:hover a img{ height:100%; opacity:1; } 
```

[http://jsbin.com/operib/83/edit](http://jsbin.com/operib/83/edit)

# sql - 交叉引用表

> ID：14718052
> 
> 赞同：0
> 
> 时间：2013-02-05T22:16:32.303
> 
> 标签：sql, sql-server

我有 3 个表格，Chapters、SubChapters 和 Divisions。这些表中的每一个都有额外的记录，我想将它们存储在一个名为“Sections”的表中。它们都是 1:many 关系。
我的问题是在这里建立交叉引用的最佳方法是什么？这是我目前拥有的：

```
Chapter table:
     chapterID int
     partID int
     chapterNumber varchar
     chapterName varchar
SubChapter table:
     subChapterID int
     chapterID int
     subChapterNumber varchar
     subChapterName varchar
Division Table:
     divisionID int
     subChapterID int
     divisionNumber varchar
     divisionName varchar

Section Table:
     sectionID int
     parentID int
     parentType int (1 = chapter; 2 = subchapter; 3 = division)
     sectionNumber varchar
     sectionName varchar 
```

我在这里遇到的问题是 FK 限制。我应该取消外键吗？如果我这样做了，我能做些什么来提高效率，或者这甚至会成为一个问题？

对于那些想知道的人，我的要求是在数据库中访问州和联邦行政代码的某些方面，以填充 Intranet 网页上的下拉菜单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:52:17.167

就个人而言，我会为每个父类型创建一个节表，然后你的外键就会正常工作。然后，我将创建一个视图来连接所有连接，以减轻连接这六个表的重复性。

我当然可以欣赏您现在拥有的设计，但是拥有 FK 可以很好地防止孤立数据。另一种选择是向章节、子章节和分区添加删除触发器，以在存在相应的章节记录时避免删除。

# mysql - 错误 1005(105) 无法创建表...但是为什么呢？

> ID：14718053
> 
> 赞同：0
> 
> 时间：2013-02-05T22:16:44.847
> 
> 标签：mysql, sql, foreign-keys

```
create table bankdb.customer(
    customer_name varchar(45) not null,
    social_security int not null,
    customer_street varchar(45),
    customer_city varchar(45),
primary key(`social_security`)
)engine=InnoDB;

create table bankdb.branch(
    branch_name varchar(45) not null,
    branch_city varchar(45),
    assets int,
primary key (`branch_name`)
)engine=InnoDB;

create table bankdb.account(
    branch_name varchar(45),
    account_number varchar(45) not null,
    balance int,
primary key (`account_number`),
constraint fk_acount_branch
    foreign key (`branch_name`)
    references bankdb.branch(`branch_name`)
)engine=InnoDB;  

create table bankdb.depositor(
    customer_name varchar(45) not null,
    account_number varchar(45) not null,
primary key (`customer_name`, `account_number`),
constraint fk_depositor_customer
    foreign key(`customer_name`)
    references bankdb.customer(`customer_name`),
constraint fk_depositor_account
    foreign key(`account_number`)
    references bankdb.account(`account_number`)
)engine=InnoDB; 
```

那是我的 sql 代码...我收到错误无法为表 bankdb.depositor 创建表...我的外键有什么问题吗？有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:20:03.113

编辑，根据您的新脚本，以下似乎在 SQL Fiddle 中工作。我不得不添加索引：

```
create table bankdb.customer(
    customer_name varchar(45) not null,
    social_security int not null,
    customer_street varchar(45),
    customer_city varchar(45),
  primary key(`social_security`),
  INDEX (customer_name)
)engine=InnoDB;

create table bankdb.branch(
    branch_name varchar(45) not null,
    branch_city varchar(45),
    assets int,
  primary key (`branch_name`)
)engine=InnoDB;

create table bankdb.account(
    branch_name varchar(45),
    account_number varchar(45) not null,
    balance int,
  primary key (`account_number`),
  INDEX (account_number),
  constraint fk_acount_branch
      foreign key (`branch_name`)
      references bankdb.branch(`branch_name`)
)engine=InnoDB;  

create table bankdb.depositor(
  customer_name varchar(45) not null,
  account_number varchar(45) not null,
  primary key (`customer_name`, `account_number`),
  INDEX (customer_name),  
  INDEX (account_number),
  constraint fk_depositor_customer
      foreign key(`customer_name`)
      references bankdb.customer(`customer_name`),
  constraint fk_depositor_account
      foreign key(`account_number`)
      references bankdb.account(`account_number`)
)engine=InnoDB; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/a731c)

~~如果这是您的完整脚本，那么您的问题在于为`account`.~~

您正在尝试在`branch`似乎不存在的表上创建一个外键：

```
create table bankdb.account(
    branch_name varchar(45),
    account_number varchar(45) not null,
    balance int,
primary key (`account_number`),
constraint fk_acount_branch
    foreign key (`branch_name`)
    references bankdb.branch(`branch_name`)  -- does this exist
)engine=InnoDB; 
```

# c++ - 特质和政策有什么区别？

> ID：14718055
> 
> 赞同：62
> 
> 时间：2013-02-05T22:16:56.143
> 
> 标签：c++, template-meta-programming, typetraits, policy-based-design

我有一个我正在尝试配置其行为的类。

```
template<int ModeT, bool IsAsync, bool IsReentrant> ServerTraits; 
```

然后稍后我有我的服务器对象本身：

```
template<typename TraitsT>
class Server {…}; 
```

我的问题是我上面的用法是我的命名错误吗？我的模板化参数实际上是策略而不是特征吗？

什么时候模板化参数是一个特征而不是一个策略？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-02-06T07:47:09.893

## 政策

**策略是将行为**注入父类的类（或类模板），通常通过继承。通过将父接口分解为正交（独立）维度，策略类形成了更复杂接口的构建块。一种常见的模式是将策略作为用户可定义的模板（或模板模板）参数提供库提供的默认值。标准库中的一个示例是分配器，它们是所有 STL 容器的策略模板参数

```
template<class T, class Allocator = std::allocator<T>> class vector; 
```

在这里，`Allocator`模板参数（它本身也是一个类模板！）将内存分配和释放策略注入到父类`std::vector`中。如果用户不提供分配器，`std::allocator<T>`则使用默认值。

与基于模板的多态性一样，策略类的接口要求是**隐式的和语义**的（基于有效的表达式），而不是显式的和句法的（基于虚拟成员函数的定义）。

请注意，最近的无序关联容器具有多个策略。除了通常的`Allocator`模板参数外，它们还采用`Hash`默认为`std::hash<Key>`函数对象的策略。这允许无序容器的用户沿多个正交维度（内存分配和散列）配置它们。

## 性状

特征是从泛型类型中**提取属性的类模板。**有两种特征：单值特征和多值特征。单值特征的示例是标题中的那些`<type_traits>`

```
template< class T >
struct is_integral
{
    static const bool value /* = true if T is integral, false otherwise */;
    typedef std::integral_constant<bool, value> type;
}; 
```

单值特征通常用于**模板元编程**和 SFINAE 技巧中，以根据类型条件重载函数模板。

多值特征的示例分别是来自 headers`<iterator>`和的 iterator_traits 和 allocator_traits `<memory>`。由于特征是类模板，它们可以被专门化。下面是一个 for 特化的`iterator_traits`例子`T*`

```
template<T>
struct iterator_traits<T*>
{
    using difference_type   = std::ptrdiff_t;
    using value_type        = T;
    using pointer           = T*;
    using reference         = T&;
    using iterator_category = std::random_access_iterator_tag;
}; 
```

该表达式`std::iterator_traits<T>::value_type`可以使成熟的迭代器类的通用代码甚至可用于原始指针（因为原始指针没有 member `value_type`）。

## 政策和特征之间的相互作用

在编写您自己的通用库时，考虑用户可以专门化您自己的类模板的方式很重要。但是，必须小心，不要让用户通过使用特征的特化来注入而不是提取行为而成为**单一定义规则**的受害者。套用安德烈亚历山德雷斯库的这篇[旧帖子](http://lists.boost.org/Archives/boost/2002/04/28906.php)

> 根本的问题是，没有看到特性的特殊版本的代码仍然可以编译，可能会链接，有时甚至可能会运行。这是因为在没有显式特化的情况下，非特化模板会发挥作用，可能会实现适用于您的特殊情况的通用行为。因此，如果不是应用程序中的所有代码都看到相同的特征定义，则违反了 ODR。

C++11`std::allocator_traits`通过强制所有 STL 容器只能`Allocator`通过`std::allocator_traits<Allocator>`. 如果用户选择不提供或忘记提供一些必需的策略成员，则特征类可以介入并为那些缺失的成员提供默认值。因为`allocator_traits`它本身不能被专门化，所以用户总是必须通过一个完全定义的分配器策略来定制他们的容器内存分配，并且不会发生静默的 ODR 违规。

请注意，作为库编写者，仍然可以特化特征类模板（就像 STL`iterator_traits<T*>`在正如 STL 在`allocator_traits<A>`) 中所做的那样。

**更新**：特征类的用户定义特化的 ODR 问题主要发生在特征被用作**全局类模板**并且您不能保证所有未来的用户都会看到所有其他用户定义的特化时。策略是**本地模板参数**并包含所有相关定义，允许用户定义它们而不会干扰其他代码。仅包含类型和常量（但不包含行为功能）的本地模板参数可能仍被称为“特征”，但它们对其他代码（如`std::iterator_traits`and ）不可见`std::allocator_traits`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-05T23:20:05.997

**[我想你会在Andrei Alexandrescu 的这本书](http://en.wikipedia.org/wiki/Modern_C%2B%2B_Design)**中找到你的问题的最佳答案。在这里，我将尝试给出一个简短的概述。希望它会有所帮助。

* * *

**特征类**是通常旨在将类型与其他类型或常量值相关联以提供这些类型的特征的元函数的类。换句话说，它是一种*对 types 的属性*进行建模的方法。该机制通常利用模板和模板特化来定义关联：

```
template<typename T>
struct my_trait
{
    typedef T& reference_type;
    static const bool isReference = false;
    // ... (possibly more properties here)
};

template<>
struct my_trait<T&>
{
    typedef T& reference_type;
    static const bool isReference = true;
    // ... (possibly more properties here)
}; 
```

上面的特征元函数`my_trait<>`将引用类型`T&`和常量布尔值关联`false`到所有`T`本身*不是*引用的类型；另一方面，它将引用类型`T&`和常量布尔值`true`与所有*引用*`T`类型相关联。

 *例如：

```
int  -> reference_type = int&
        isReference = false

int& -> reference_type = int&
        isReference = true 
```

在代码中，我们可以如下断言上述内容（下面的所有四行都将编译，这意味着满足第一个参数中表达的条件`static_assert()`）：

```
static_assert(!(my_trait<int>::isReference), "Error!");
static_assert(  my_trait<int&>::isReference, "Error!");
static_assert(
    std::is_same<typename my_trait<int>::reference_type, int&>::value, 
    "Error!"
     );
static_assert(
    std::is_same<typename my_trait<int&>::reference_type, int&>::value, 
    "Err!"
    ); 
```

在这里你可以看到我使用了标准`std::is_same<>`模板，它本身就是一个接受*两个*而不是一个类型参数的元函数。事情可以在这里变得任意复杂。

尽管`std::is_same<>`是`type_traits`标题的一部分，但有些人认为只有当它充当元谓词（因此，接受*一个*模板参数）时，类模板才是类型特征类。然而，据我所知，术语并没有明确定义。

有关在 C++ 标准库中使用特征类的示例，请查看输入/输出库和字符串库的设计方式。

* * *

**政策**略有不同（实际上，完全不同）。它通常是一个类，它指定另一个通用类的行为应该与某些可能以几种不同方式实现的操作有关（因此，其实现由策略类决定）。

例如，一个通用的智能指针类可以设计为一个模板类，它接受一个策略作为模板参数来决定如何处理引用计数——这只是一个假设的、过于简单化和说明性的例子，所以请尝试抽象从这个具体的代码和*机制上看*。

这将允许智能指针的设计者不对引用计数器的修改是否应以线程安全的方式进行硬编码承诺：

```
template<typename T, typename P>
class smart_ptr : protected P
{
public:
    // ... 
    smart_ptr(smart_ptr const& sp)
        :
        p(sp.p),
        refcount(sp.refcount)
    {
        P::add_ref(refcount);
    }
    // ...
private:
    T* p;
    int* refcount;
}; 
```

在多线程上下文中，客户端可以使用智能指针模板的实例化和实现引用计数器的线程安全递增和递减的策略（此处假定 Windows 平台）：

```
class mt_refcount_policy
{
protected:
    add_ref(int* refcount) { ::InterlockedIncrement(refcount); }
    release(int* refcount) { ::InterlockedDecrement(refcount); }
};

template<typename T>
using my_smart_ptr = smart_ptr<T, mt_refcount_policy>; 
```

另一方面，在单线程环境中，客户端可以使用简单地增加和减少计数器值的策略类来实例化智能指针模板：

```
class st_refcount_policy
{
protected:
    add_ref(int* refcount) { (*refcount)++; }
    release(int* refcount) { (*refcount)--; }
};

template<typename T>
using my_smart_ptr = smart_ptr<T, st_refcount_policy>; 
```

通过这种方式，库设计者提供了一个灵活的解决方案，能够在性能和安全性之间提供最佳折衷（*“您无需为不使用的东西付费”*）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-17T23:11:20.833

如果您使用 ModeT、IsReentrant 和 IsAsync 来控制服务器的行为，那么它就是一个策略。

或者，如果您想要一种将服务器的特征描述给另一个对象的方法，那么您可以定义一个特征类，如下所示：

```
template <typename ServerType>
class ServerTraits;

template<>
class ServerTraits<Server>
{
    enum { ModeT = SomeNamespace::MODE_NORMAL };
    static const bool IsReentrant = true;
    static const bool IsAsync = true;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T23:12:58.000

这里有几个例子来澄清亚历克斯·张伯伦的评论：

特征类的一个常见示例是 std::iterator_traits。假设我们有一个带有成员函数的模板类 C，它接受两个迭代器，迭代值，并以某种方式累积结果。我们希望积累策略也被定义为模板的一部分，但将使用策略而不是特征来实现这一目标。

```
template <typename Iterator, typename AccumulationPolicy>
class C{
    void foo(Iterator begin, Iterator end){
        AccumulationPolicy::Accumulator accumulator;
        for(Iterator i = begin; i != end; ++i){
            std::iterator_traits<Iterator>::value_type value = *i;
            accumulator.add(value);
        }
    }
}; 
```

策略被传递给我们的模板类，而特征是从模板参数派生的。所以你所拥有的更像是一项政策。在某些情况下，特征更合适，政策更合适，并且通常可以使用任何一种方法实现相同的效果，从而引发关于哪种方法最具表现力的争论。*

# requirejs - 需要其他 requirejs 应用程序

> ID：14718060
> 
> 赞同：0
> 
> 时间：2013-02-05T22:17:32.820
> 
> 标签：requirejs

是否可以要求另一个 requirejs 应用程序（具有自己的配置）作为 requirejs 包？假设我有我的主应用程序，我想需要我的独立日历小部件。那可能吗？

提前致谢

**编辑**

一种方法可能是要求小部件的优化版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T05:17:11.527

RequireJS 和 CurlJS（更常用的 AMD 加载器）允许您重新配置本地范围。查看[多版本支持文档](http://requirejs.org/docs/api.html#multiversion)

然而，这里只是一个想法：

尽可能少地依赖配置。很可能只在全局配置中设置真正通用的全局事物`jquery`，例如`underscore`路径，并在小部件中滚动命名定义以满足本地打包需求。对于 James 发明的每个配置选项，都有一种有效的方法可以在没有配置的情况下完成。

可以使用嵌套的 require 调用轻松地在本地模拟 Shim。将所有纯 JS 别名放入其中`paths`可能是无用的，因为您可以轻松地使用对纯 js 文件“path/to/file* *.JS* *”的直接引用

实际上，您实际上并不需要那么多配置。远离需要它，您的问题就被简化了。

# drupal-7 - Drupal 7 - 块：你如何指定它除了某些页面的页面列表？

> ID：14718074
> 
> 赞同：2
> 
> 时间：2013-02-05T22:18:50.070
> 
> 标签：drupal-7, block

我创建了一个要出现在这些路径上的块：

example.com/sample/1
example.com/sample/2
example.com/sample/3
example.com/sample/4
example.com/sample/6

但是，我不希望它出现在：

example.com/sample/5

在块的可见性设置下，我可以在“仅列出的页面”上选择显示块并输入 /sample/* 之类的内容

但是，如果不单独输入所有其他路径，我如何告诉它不要出现在 /sample/5 中？是否有一个“除外”或“非”指示符，就像 * 表示全部一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:03:27.073

使用[上下文模块](http://drupal.org/project/context)来处理块的放置。它允许您指定块应显示在哪些路径上，以及不应显示在哪些路径上（通过以 ~ 开头的路径）

例如，在您的上下文中，您可以像这样指定路径：sample/* ~sample/5

这告诉drupal在所有匹配“sample/*”的路径上显示你的块，除了“sample/5”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:24:58.260

只有两种方法可以获得所需的微调：

1.  您一一键入要包含/排除的所有 URL
2.  您选择完全可定制的 php 代码模式。

也许您应该尝试 Context 模块[http://drupal.org/project/context](http://drupal.org/project/context)，看看它提供的更复杂、可配置的选项是否能满足您的目的/解决您的问题。

PD。我的第一个答案完全没有抓住重点，我在考虑观点......对不起！

# sql - 根据列添加自动递增数字

> ID：14718078
> 
> 赞同：1
> 
> 时间：2013-02-05T22:18:53.757
> 
> 标签：sql, sql-server, odbc, ms-access-2010

我试图解决一个问题，我遇到了将数据从一个系统导出到另一个系统的问题。

假设我有一张像这样的桌子：

```
id  |  item_num  
1      1            
2      1            
3      2            
4      3            
5      3           
6      3 
```

我需要在表中添加一列并将其更新为包含基于项目的递增 product_num 字段。这将是上表给出的最终结果。

```
id  |  item_num  |  product_num
1      1            1
2      1            2
3      2            1
4      3            1
5      3            2
6      3            3 
```

有什么想法吗？

编辑：这是在 Access 2010 中从一个系统到另一个系统完成的（sql server 源，自定义/未知 ODBC 驱动的目标）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:35:34.127

也许您可以在 SQL Server 数据库中[创建一个视图](http://msdn.microsoft.com/en-us/library/ms187956.aspx)，然后在 Access 中从中选择以插入到您的目标中。

SQL Server 中可能的解决方案：

```
-- Use row_number() to get product_num in SQL Server 2005+:
select id
    , item_num
    , row_number() over (partition by item_num order by id) as product_num
from MyTable;

-- Use a correlated subquery to get product_num in many databases:
select t.id
    , t.item_num
    , (select count(*) from MyTable where item_num = t.item_num and id <= t.id) as product_num
from MyTable t; 
```

结果相同：

```
id          item_num    product_num
----------- ----------- --------------------
1           1           1
2           1           2
3           2           1
4           3           1
5           3           2
6           3           3 
```

# php - 带有 POST 方法和 PHP 的 NSURLMutableRequest

> ID：14718082
> 
> 赞同：0
> 
> 时间：2013-02-05T22:19:03.640
> 
> 标签：php, ios, objective-c, http-post, nsurlrequest

* * *

因此，我使用有效的新代码修复了问题代码，并更改了问题的标题以供其他人协助。

我的问题是在应用程序内部我正在使用 in`POST`方法，但`PHP`另一方面，我正在使用 in`GET`方法。只是将其更改为`POST`并且效果很好。

享受。

* * *

我不断从我的服务器收到用户名错误的错误，我在这里做错了什么？

谢谢你的帮助。

```
- (void)addNewUser:(NSString *)username andDate:(NSDate *)date
{
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

    NSString * urlString = [NSString stringWithFormat:@"http://www.myurl.com/url/insert.php"];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"dd-MM-yyyy HH:mm:ss"];
    NSString *strDate = [dateFormatter stringFromDate:date];

    NSString *paramDataString = [NSString stringWithFormat:@"username=%@&date=%@",[username stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding],
                                 [strDate stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

    [request setHTTPBody:[paramDataString dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES]];

    [NSURLConnection sendAsynchronousRequest:request
                                       queue:[NSOperationQueue mainQueue]
                           completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                               NSString *requestData = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
                           }];
} 
```

在服务器端我有这个：（PHP）

```
<?php
   header("Content-type: text/html; charset=utf8");

   $connection = mysql_connect("localhost","myusername","mypassword");
   if(!$connection)
   {
       die("database connection failed:" . mysql_error());       
   }

   $db = mysql_select_db("db_users",$connection);
   if(!db)
   {
       die("database connection failed:" . mysql_error());
   }

   mysql_query("SET NAMES 'utf8'",$connection);
?>

<?php 
    $varGet1 = $_POST['username'];
    $varGet2 = $_POST['date'];

    if (!$varGet1) {
        $message = "no username";
    } else if (!$varGet2) {
        $message = "no date";
    } else {
        $query = "INSERT INTO `Users` (username, date, first) VALUES('{$varGet1}','{$varGet2}','0')";

        $query = mysql_query($query,$connection);

        if($query) {
            $message = "Added";
        } else {
            $message = "Error";
        }
    }

    echo($message);

    mysql_close($connection);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:36:45.030

没有什么是真的错了。你只是`GET`从你的 php 而`POST`从objective-c。切换到`$_POST`，你会很高兴的。

# nservicebus - 在 NServiceBus 3+ 中将超时管理器与分配器一起使用的正确方法是什么？

> ID：14718083
> 
> 赞同：7
> 
> 时间：2013-02-05T22:19:05.573
> 
> 标签：nservicebus, nservicebus3, nservicebus-distributor

前 3 版的建议是将超时管理器作为独立进程在您的集群上运行，在分发服务器旁边。（详见此处： http: [//support.nservicebus.com/customer/portal/articles/965131-deploying-nservicebus-in-a-windows-failover-cluster](http://support.nservicebus.com/customer/portal/articles/965131-deploying-nservicebus-in-a-windows-failover-cluster)）。

在将超时管理器包含为卫星程序集之后，在与分发器进行横向扩展时，使用它的正确方法是什么？

服务 A 的每个工作人员应该在启用超时管理器的情况下运行，还是应该只将服务 A 的分发进程配置为运行服务 A 的超时管理器？

如果每个工作人员都运行它，他们是否共享相同的 Raven 实例来存储超时？（如果是这样，你如何确保两个或更多工作人员不会同时选择相同的过期超时？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-10T17:41:16.240

请允许我自己清楚地回答这个问题。

经过大量挖掘并在 NSB 团队的 Andreas Öhlund 的帮助下（[http://tech.groups.yahoo.com/group/nservicebus/message/17758](http://tech.groups.yahoo.com/group/nservicebus/message/17758)），这个问题的正确答案是：

*   就像 Udi Dahan 提到的那样，根据设计，只有分发器/主节点应该在横向扩展场景中运行超时管理器。
*   不幸的是，在 NServiceBus 3 的早期版本中，这并没有按设计实现。

您有以下 3 个问题：

## 1) 使用 Distributor 配置文件运行不会启动超时管理器。

解决方法：

通过在分发服务器上包含以下代码，您自己在分发服务器上启动超时管理器：

```
class DistributorProfileHandler : IHandleProfile<Distributor> 
{
   public void ProfileActivated()
   {
       Configure.Instance.RunTimeoutManager();
   }
} 
```

如果您运行主配置文件，这不是问题，因为超时管理器会自动为您在主节点上启动。

## 2) 使用 Worker 配置文件运行的 Worker 每个都启动一个本地超时管理器。

这与设计不符，并且会扰乱对超时存储的轮询和超时分派。所有工作人员都使用“给我 MASTERNODE 即将超时”来轮询超时存储。请注意，他们要求 MASTERNODE 的超时，而不是 W1、W2 等。因此，多个工作人员最终可能会同时从超时存储中获取相同的超时，从而导致在从中删除超时时与 Raven 发生冲突。

调度总是通过 LOCAL .timouts/.timeoutsdispatcher 队列发生，而它应该通过 MasterNode/Distributor 上的超时管理器的队列进行。

解决方法，您需要同时执行以下操作：

**a）禁用工人的超时管理器。将此代码包含在您的工人身上**

```
class WorkerProfileHandler:IHandleProfile<Worker>
{
    public void ProfileActivated()
    {
        Configure.Instance.DisableTimeoutManager();
    }
} 
```

**b) 在工作人员上重新路由 NServiceBus 以使用 MasterNode/Distributor 上的 .timeouts 队列。**

如果你不这样做，任何对 worker 的 RequestTimeout 或 Defer 的调用都将终止，并出现一个异常，指出你忘记配置超时管理器。将此包含在您的工作人员配置中：

```
<UnicastBusConfig TimeoutManagerAddress="{endpointname}.Timeouts@{masternode}" /> 
```

## 3) 错误的“就绪”消息返回给分销商。

因为超时管理器将消息直接分派到工作人员输入队列，而不从分发服务器存储队列中的可用工作人员中删除条目，所以工作人员在处理超时后将错误的“就绪”消息发送回分发服务器。即使您已经修复了 1 和 2，也会发生这种情况，并且如果超时是从 worker 上的本地超时管理器或在分发器/MasterNode 上运行的一个超时管理器获取的，则没有区别。结果是在分配器上的存储队列中为工人处理的每个超时建立一个额外的条目。

解决方法：使用 NServiceBus [3.3.15](https://github.com/Particular/NServiceBus/releases/tag/3.3.15)或更高版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T06:48:35.140

在版本 3+ 中，我们创建了主节点的概念，它在其中托管所有卫星，如分发器、超时管理器、网关等。

主节点运行起来非常简单——你只需将 /master 标志传递给 NServiceBus.Host.exe 进程，它就会为你运行一切。因此，从部署的角度来看，您曾经部署分发服务器，现在部署主节点。

# .net - .Net 4 WPF DataGrid 的 ItemsSource - 以编程方式工作，但不是以声明方式工作

> ID：14718086
> 
> 赞同：0
> 
> 时间：2013-02-05T22:19:21.940
> 
> 标签：.net, xaml, mvvm, wpfdatagrid

我正在使用 C# 编写一个 WPF 程序并以 .Net 4.0 为目标。我正在尝试遵循 MVVM 模式，其中我的视图（代码隐藏）具有最少甚至没有代码。

我有一个`List<MyRecord>`我想使用`DataGrid`. 在我的 XAML 中，我有以下内容：

```
<DataGrid x:Name="RecordGrid" ...>
   <DataGrid.Columns>
      <DataGridTextColumn Binding="{Binding RecId}" Header="Record ID"/>
      <DataGridTextColumn Binding="{Binding Name}" Header="Name"/>
   </DataGrid.Columns>
</DataGrid> 
```

剩下的就是将此网格绑定到数据集合。

当我将它绑定到代码隐藏文件中时，它可以正常工作：

```
RecordGrid.ItemsSource = MyRecordList; 
```

但是，我更愿意在 XAML 中以声明方式绑定它。所以我尝试了这个：

```
<DataGrid x:Name="RecordGrid" ItemsSource="{Binding MyRecordList}" ...> 
```

但它默默地不起作用。加载数据网格时没有 XAML 绑定错误消息。我在 MyRecordList 的`get`方法上设置了一个断点，只要 ItemsSource 以声明方式定义，它就不会被调用。

如何让我的数据网格`MyRecordList`通过 XAML 拉出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:31:25.423

如果您希望绑定工作，您需要设置 DataContext... MVVM 模式有一个 View 和一个 ViewModel。*视图*是您的UI - 例如窗口（我们称之为 MainWindow），而您的*ViewModel*是您拥有`RecordGrid`属性和所有其他命令/属性的地方（我们称之为 MainWindowViewModel 类）

您需要将它们都连接起来，这是通过在您的视图中指定是谁`DataContext`（在我们的例子中是 MainWindowViewModel 类）来完成的。

所以你会想在你的视图的构造函数中做这样的事情：

```
 public MainWindow()
    {
        this.DataContext = new MainWindowViewModel();
        InitializeComponent(); 
```

# spring - 在测试类弄脏 Spring JUnit 应用程序上下文后如何重置它？

> ID：14718088
> 
> 赞同：68
> 
> 时间：2013-02-05T22:19:31.253
> 
> 标签：spring, junit, hsqldb, applicationcontext

我正在使用 Spring 3.1.1.RELEASE、JUnit 4.8.1 和 HSQL 2.7.7 内存数据库。我有一个测试类注释为

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({ "classpath:test-trainingSessionServiceContext.xml" })
@DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD)
public class TrainingSessionServiceTest  
{ 
```

问题是，当我运行“mvn clean test”时，似乎所有测试类在上述类失败后运行，因为内存数据库被破坏而不是重新创建。我收到类似的错误

```
org.hibernate.exception.SQLGrammarException: user lacks privilege or object not found: CB_ORGANIZATION" type="javax.persistence.PersistenceException">javax.persistence.PersistenceException:   org.hibernate.exception.SQLGrammarException: user lacks privilege or object not found: CB_ORGANIZATION
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1360)
    at org.hibernate.ejb.AbstractEntityManagerImpl.find(AbstractEntityManagerImpl.java:817)
    at org.hibernate.ejb.AbstractEntityManagerImpl.find(AbstractEntityManagerImpl.java:771)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy46.find(Unknown Source)
    at org.mainco.subco.organization.repo.OrganizationDaoImpl.findById(OrganizationDaoImpl.java:77)
    at org.mainco.subco.pd.repo.LinkDaoTest.createDummyLink(LinkDaoTest.java:686)
    at org.mainco.subco.pd.repo.LinkDaoTest.testSaveLink(LinkDaoTest.java:67)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15) 
```

这是我如何设置给出异常的测试类（在上述类之后运行）......</p>

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration({ "classpath:test-context.xml" })
public class LinkDaoTest extends AbstractTransactionalJUnit4SpringContextTests
{ 
```

在运行每个测试类之前，有什么方法可以将我的应用程序上下文恢复到其原始状态？我不想让“TrainingSessionServiceTest”类扩展 AbstractTransactionalJUnit4SpringContextTests。这是我的应用程序上下文的相关部分：

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="org.hsqldb.jdbcDriver"/>
    <property name="url" value="jdbc:hsqldb:mem:pd" />
    <property name="username" value="sa" />
    <property name="password" value="" />
</bean>

<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
    </property>
    <property name="persistenceXmlLocation" value="classpath:META-INF/test-persistence.xml"/>
    <property name="persistenceUnitName" value="testingDatabase"/>
    <property name="dataSource" ref="dataSource"/>
</bean>

<bean id="sharedEntityManager" class="org.springframework.orm.jpa.support.SharedEntityManagerBean">
   <property name="entityManagerFactory" ref="entityManagerFactory"/>
</bean>

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory"/>
</bean>

<tx:annotation-driven />

<jdbc:embedded-database id="embedded" type="HSQL"/> 
<jdbc:initialize-database data-source="dataSource">
    <jdbc:script location="classpath:db-test-data.sql"/>    
</jdbc:initialize-database> 
```

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-04-11T12:06:32.960

使用 @DirtiesContext 强制重置。例如我有：

```
@ContextConfiguration(classes={BlahTestConfig.class})
@DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD)
public class SomeTest {

    @Autowired XXXX xx;
    @Autowired YYYY yy;

    @Before
    public void setUp() {
        MockitoAnnotations.initMocks(this);
        when(YYYY.newYY()).thenReturn(zz);
    }

    @Test
    public void testSomeTest() {
        XX.changeSomething("StringTest");
        XX.doSomething();
        check_for_effects();
    }

    @Test
    public void testSomeOtherTest() {
        XX.changeSomething("SomeotherString");
        XX.doSomething();
        check_for_effects();
    } 
```

* * *

来自[春季文档](http://docs.huihoo.com/spring/3.0.x/en-us/ch09s03.html)

# DirtiesContext

表示底层 Spring ApplicationContext 在执行测试的过程中已经被污染（修改）如下，应该关闭，不管测试是否通过：

*   在当前测试类之后，当在类模式设置为 AFTER_CLASS（这是默认类模式）的类上声明时。

*   在当前测试类中的每个测试方法之后，当在类模式设置为 AFTER_EACH_TEST_METHOD 的类上声明时。

*   在当前测试之后，在方法上声明时。

如果测试修改了上下文（例如，通过替换 bean 定义），请使用此注释。为后续测试提供了一个新的上下文。[注意] @DirtiesContext 与 JUnit 3.8 的限制

**> 在 JUnit 3.8 环境中，@DirtiesContext 仅在方法上受支持，因此在类级别上不受支持。**

您可以将@DirtiesContext 用作同一类中的类级别和方法级别注释。在这种情况下，ApplicationContext 在任何此类带注释的方法之后以及整个类之后都被标记为脏。如果 ClassMode 设置为 AFTER_EACH_TEST_METHOD，则在类中的每个测试方法之后将上下文标记为脏。

```
@DirtiesContext
public class ContextDirtyingTests {
    // some tests that result in the Spring container being dirtied
}

@DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD)
public class ContextDirtyingTests {
    // some tests that result in the Spring container being dirtied
}

@DirtiesContext
@Test
public void testProcessWhichDirtiesAppCtx() {
    // some logic that results in the Spring container being dirtied
} 
```

当应用程序上下文被标记为脏时，它会从测试框架的缓存中删除并关闭；因此，对于需要具有相同资源位置集的上下文的任何后续测试，都会重建底层 Spring 容器。

# facebook - 如何通过服务器端应用程序集成检索用户令牌

> ID：14718090
> 
> 赞同：3
> 
> 时间：2013-02-05T22:19:38.570
> 
> 标签：facebook, facebook-graph-api

目标非常简单，但没有关于如何检索与当前运行的应用程序关联的用户令牌的示例。

我的目标是使用我在 facebook 中创建的应用程序拉出我的公共 facebook 页面（具有完全开放访问权限的业务页面），我创建该应用程序只是为了获取应用程序 ID 和机密，以便我可以让 PHP 执行数据请求和然后在我的主页上对其进行迭代。非常简单，但网站上的文档主要处理我无意做的 facebook 登录。我只想从网站上的公共业务页面获取我的提要。

这就是我认为 Facebook 大错特错的地方。到目前为止，这是我的代码，可以正确查询但生成一个空数据集：

```
$app_id = "APP_ID";
$app_secret = "APP_SECRET";
$app_token_url = "https://graph.facebook.com/oauth/access_token?"
    . "client_id=" . $app_id
    . "&client_secret=" . $app_secret
    . "&grant_type=client_credentials";

    $response = file_get_contents($app_token_url);
    $params = null;
parse_str($response, $params);

$graph_url = "https://graph.facebook.com/202978003068170/feed?access_token=".$params['access_token'];

$app_details = json_decode(file_get_contents($graph_url), true);

    echo '<pre>';
            var_dump($app_details);
    echo '<pre>'; 
```

现在让我澄清一下实际`access_token`价值是什么，因为 Facebook 对此含糊不清。实际上有两种类型的访问令牌，我创建的应用程序具有*这两种*类型，如果您登录并使用您的应用程序，您可以在这里看到： [https ://developers.facebook.com/tools/access_token/](https://developers.facebook.com/tools/access_token/)

主要问题是`access_token`oauth 从上面的代码返回的值是“App Token”，它查询用户配置文件数据没有问题（这有点吓人），但是当我尝试查询我的公共业务页面时返回空白数据`{"data":[]}`我有启用所有权限。经过一周尝试不同的方法并将我的头撞在桌子上并且仅通过第三方信息源找到部分救赎后，我才弄清楚这两者之间的区别。

我在这里遇到了一篇文章，说我必须进行第二次 OAUTH 查询以提取应用程序的“用户令牌”（我已经从 fbook 中的令牌调试器测试了与应用程序令牌关联的用户令牌并且它可以工作）到Facebook，但该查询包含什么。

请有人帮忙。这应该不是那么困难，我不希望用户使用 fbook 登录我的网站。我只想在我的商业网站上显示商业事件、提要和图片。

谢谢

# c# - 如何安排 VSS 历史记录出现在代码中？

> ID：14718095
> 
> 赞同：0
> 
> 时间：2013-02-05T22:20:03.550
> 
> 标签：c#, vb.net, tsql, visual-sourcesafe

根据我们在旧项目中的一些示例，我最近需要在新项目的源代码中嵌入 Visual Source Safe 历史记录，其中历史记录出现在编码器放置某些注释的位置。最终结果类似于：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
//$Archive: /UserManagementSolution.root/UserManagementSolution/UserDAL/Tems.cs $
//$History: Tems.cs $
//* 
//* *****************  Version 3  *****************
//* User: michaelc     Date: 1/31/13    Time: 9:44a
//* Updated in $/UserManagementSolution.root/UserManagementSolution/UserDAL
//
//
namespace UserDAL
{
    public class Tems 
```

VSS 放置版本及其后的两行。我知道 VSS 根据放置行的位置放置历史记录：

```
//$Archive:  $
//$History:  $
//* 
```

请注意，VSS 还将 VSS 文件信息放在 $Archive 和 $History 参数中。只需使用如图所示的美元符号来告诉它这些信息的去向。

但是，当我实际签入代码（大约 20 个 C# 文件）时，VSS 将历史记录放入没有注释字符中，从而破坏了构建。这需要一些烦人的返工来评论这些行。问题是，当 VSS 放入历史时，如何让其评论历史？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:20:03.550

我花了一些时间思考这个问题，然后突然想起在 srcsafe.ini 文件中需要一些编码来告诉 VSS 将历史记录放在注释行中。

我找到了一个按预期运行的项目的 srcsafe.ini 文件，并将其与我的新项目的文件进行了比较。我在行为正确的 .ini 文件中找到了以下几行：

```
Keyword_Masks = *.cs, *.sql
Shadow = 

[Keyword Comments] 
*.cs = "//"
*.sql = "--" 
```

Keyword_Masks 和 Shadow 关键字放在 .ini 文件中 UseHelperService 之后。我想 Keyword_Masks （带有逗号分隔的值）告诉 VSS 哪些文件类型要放置历史记录（我不知道 Shadow 表示什么，但由于它出现在我们所有的项目中，我不想省略它并找出它后来引起了一些微妙的错误）。

新的 [Keyword Comments] 部分紧随其后（并且在 [Timezone] 部分之前。这显然告诉 VSS 哪些字符用于行注释，以及用于哪种文件类型。

做到了！

请注意，如果您使用的是 Visual Basic，它将被编码为 *.vb。明显地。而且你不必包含 Sql；在这种情况下，我们的 VSS 项目碰巧包含解决方案和项目文件以及我们也在 VSS 中保存的存储过程。

# php - 更新“个人资料页面”将条目添加到 mySQL 数据库表单 PHP 表单？

> ID：14718098
> 
> 赞同：0
> 
> 时间：2013-02-05T22:20:07.123
> 
> 标签：php, mysql, database, forms

我创建了一个简单的登录和注册项目。

然后向用户呈现他们的“个人资料页面”。我希望他们能够单击“编辑”按钮并将信息输入到注册期间不存在的字段中。我可以让脚本向数据库添加“简历”，但它会创建一条新记录，如何将此生物信息添加到特定成员记录？

```
<?php
ob_start();
session_start();
if(!isset($_SESSION['Email'])){
header("Location: login.php");
}   
?>

<body>
<div id="wrapper">

<?php
$con = mysql_connect("HIDDEN");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("HIDDEN", $con);

$sql="INSERT INTO members (Bio)
VALUES
('$_POST[Bio]')";

if (!mysql_query($sql,$con))
{
die('Error: ' . mysql_error());
}
echo "1 record added";

mysql_close($con);
?>

<form action="edit.php" method="post">
Bio: <input type="text" name="Bio">
<input type="submit">
</form>

</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-08T18:16:00.680

```
<?php
ob_start();
session_start();
if(!isset($_SESSION['Email'])){
header("Location: login.php");
}   
?>

<body>
<div id="wrapper">

<?php
if(isset($_REQUEST['submit'])) {
$con = mysql_connect("HIDDEN");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("HIDDEN", $con);

$sql="INSERT INTO members(Bio) VALUES ('".$_POST['Bio']."')";

if (!mysql_query($sql,$con))
{
die('Error: ' . mysql_error());
}
echo "1 record added";

mysql_close($con);
}
?>

<form action="edit.php" method="post">
Bio: <input type="text" name="Bio">
<input type="submit" name="submit">
</form>

</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:24:39.467

如果该`bio`列在同一个表中，那么您需要执行一个`UPDATE`语句，而不是另一个`INSERT`语句。您还需要知道用户的 ID。

```
UPDATE `members` SET `bio` = ? 
```

另外，不要`$_POST`在 SQL 语句中直接使用变量。那么，您的网站就会容易受到 SQL 注入漏洞的攻击。使用诸如 PDO 之类的东西来准备语句，然后使用绑定参数执行它们。一个例子，在[PDO](http://php.net/manual/en/book.pdo.php)`$db`的一个实例中：

```
$sql = "UPDATE `members` SET `bio` = :bio WHERE `id` = :id LIMIT 1";

$statement = $db->prepare($sql);
$statement->bindParam(':bio', $bio);
$statement->bindParam(':id', $user_id);
$statement->execute(); 
```

您需要分配`$bio`和`$user_id`变量。

# vba - ReplacementRange.value = ReplacementRange.value 错误

> ID：14718103
> 
> 赞同：0
> 
> 时间：2013-02-05T22:20:29.507
> 
> 标签：vba

我的代码中有一个错误（我找到了解决方法），但我希望您能帮助我确定问题所在。这是不起作用的代码：

```
Sub replacewithnumbers1()

Dim ReplacementRange As Range

Set ReplacementRange = Range("a2:c2")
Set ReplacementRange = Range(ReplacementRange, ReplacementRange.End(xlDown))

ReplacementRange.value = ReplacementRange.value

End Sub 
```

当我运行它时，它适用于 A2:C17，但下面的所有内容都更改为“#N/A”。

现在这里是有效的代码：

```
Dim ReplacementRange As Range

Set ReplacementRange = Range("A2")
Set ReplacementRange = Range(ReplacementRange, ReplacementRange.End(xlDown))

ReplacementRange.value = ReplacementRange.value

Set ReplacementRange = Range("b2")
Set ReplacementRange = Range(ReplacementRange, ReplacementRange.End(xlDown))
ReplacementRange.value = ReplacementRange.value

Set ReplacementRange = Range("c2")
Set ReplacementRange = Range(ReplacementRange, ReplacementRange.End(xlDown))
ReplacementRange.value = ReplacementRange.value

Set ReplacementRange = Range("I2")
Set ReplacementRange = Range(ReplacementRange, ReplacementRange.End(xlDown))

ReplacementRange.value = ReplacementRange.value 
```

我所做的只是把它分解成更多的步骤（每列一个），然后它就可以工作了。当我一次做两列时，我得到相同的错误（A:B 或 B:C）。它总是停在第 17 行，我不知道为什么。愿意帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:56:07.500

我发现它为什么会这样（我认为）。数据集上有一个过滤器，因此第 16 行不可见，当我关闭过滤器时，它运行正常。抱歉，这有点反高潮。

# string - Haskell字符串到使用单词的字符串列表

> ID：14718108
> 
> 赞同：3
> 
> 时间：2013-02-05T22:20:39.163
> 
> 标签：string, list, haskell, word

我对 Haskell 比较陌生，我目前正在使用 LearnYouAHaskell。我正在尝试获取一个由空格分隔的字符串，并将其分解为一个较小的字符串列表。我目前的程序：

```
main = do 
    putStrLn "Insert a string to convert: "
    -- Input string
    line <- getLine
    words line; 
```

但在这种情况下，它告诉我我遇到了 IO 错误。据我了解，getLine 是一个动作，所以由于这是不纯的，我必须将它绑定到“line”。Line 是 getLine 的准确表示，它是一个 IO String。

但是， line 不应该是字符串吗？当我尝试在线使用单词时，它告诉我“无法将预期类型“IO a0”与实际类型 [String] 匹配

好像 line 不是字符串。此外，我可以在程序本身中使用 :t 行来查看它是否是正确的类型吗？

我为新手问题道歉，但我有点卡住了。

编辑：

我在 GHCI 中做了类似的事情，它告诉我我的类型实际上是一个普通的字符串。我不明白。

```
Prelude> line <- getLine
"Hello fellows"
Prelude> :t line
line :: String
Prelude> words line
["Hello","fellows"] 
```

为什么那行不通？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T22:23:05.163

在haskell中如果你想返回一个值，你必须这样说：

```
main = do 
    putStrLn "Insert a string to convert: "
    -- Input string
    line <- getLine
    return (words line) 
```

`words line`不是 IO 操作，它是字符串列表，因此不能是`do`块中的语句。

`return :: Monad m => a -> m a`在这种情况下，我们可以将其专门化为 type `a -> IO a`，然后专门化为`[String] -> IO [String]`. 块中的每个语句都`do`必须是`IO`语句。

* * *

**更进一步：**

如果你想编译你的程序，你应该有`main :: IO()`，这意味着你不应该返回你的列表。

例如，如果您想将`process`这些字符串转换为单个字符串然后输出，您可以这样做

```
process :: [String] -> String
process xss = "I don't know, some answer"

main = do 
    putStrLn "Insert a string to convert: "
    -- Input string
    line <- getLine
    putStrLn (process (words line)) 
```

尽管我个人会将最后一行写为`putStrLn $ process.words $ line`.

* * *

您在 GHCi 中的互动

```
Prelude> line <- getLine
"Hello fellows"
Prelude> :t line
line :: String
Prelude> words line
["Hello","fellows"] 
```

正在使用 GHCi 实际上不仅仅是在 IO monad 中运行的事实。在 GHCi 中，如果您的输入是`do`块中的有效行，它将运行，但如果它是纯代码，它将被评估和打印。（像这样的交互式解释器通常称为 Read-Eval-Print-Loop 的 REPL。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T22:23:55.037

好吧，问题是你想做什么`words line`？

在`words line`do 块中作为一行什么都不做，但要让它工作，你必须使用`return`它来将它包装在 IO monad 中：

```
main = do 
    putStrLn "Insert a string to convert: "
    -- Input string
    line <- getLine
    return (words line); 
```

无论如何，也许您想打印它？

```
main = do 
    putStrLn "Insert a string to convert: "
    -- Input string
    line <- getLine
    print (words line); 
```

# java - 使用 Jsoup 解析 Html 时出错

> ID：14718109
> 
> 赞同：0
> 
> 时间：2013-02-05T22:20:43.763
> 
> 标签：java, android, html-parsing, jsoup

我想解析 html 站点并获取一个字符串值。但是我在解析 div 类时收到错误。

```
<div class="content clear"> 
```

我写了上面的代码，但我收到了错误。

```
try {
        doc = Jsoup.connect("http://tvrehberi.hurriyet.com.tr/program-detay/308271/deli-deli-olma").get();

List<String> saatItem = new ArrayList<String>();
        for (Element  iterable : doc.getElementsByClass("content&clear")) {
            saatItem.add(iterable.text());

        }
catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

此错误导致类有空白字符。如果类值没有空白字符，则代码运行良好。我怎么解决这个问题 ？

错误日志：

```
02-06 00:18:53.770: E/AndroidRuntime(28775): FATAL EXCEPTION: main
02-06 00:18:53.770: E/AndroidRuntime(28775): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.htmlparsingtutorial/com.example.htmlparsingtutorial.MainActivity}: android.os.NetworkOnMainThreadException
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2100)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.os.Looper.loop(Looper.java:137)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.ActivityThread.main(ActivityThread.java:4898)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at java.lang.reflect.Method.invokeNative(Native Method)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at java.lang.reflect.Method.invoke(Method.java:511)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at dalvik.system.NativeStart.main(Native Method)
02-06 00:18:53.770: E/AndroidRuntime(28775): Caused by: android.os.NetworkOnMainThreadException
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1118)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at java.net.InetAddress.lookupHostByName(InetAddress.java:385)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at java.net.InetAddress.getAllByName(InetAddress.java:214)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:340)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpEngine.connect(HttpEngine.java:310)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:408)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:393)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:159)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at org.jsoup.helper.HttpConnection.get(HttpConnection.java:148)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at com.example.htmlparsingtutorial.MainActivity.onCreate(MainActivity.java:90)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.Activity.performCreate(Activity.java:5206)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1083)
02-06 00:18:53.770: E/AndroidRuntime(28775):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2064)
02-06 00:18:53.770: E/AndroidRuntime(28775):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:59:07.123

是的，如果您在主线程中运行 networkcode，则会引发此异常。解决方案是将您的任务作为[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)运行。

顺便提一句。请测试此代码，在 PC 上它可以工作：

```
Document doc = Jsoup.connect("http://tvrehberi.hurriyet.com.tr/program-detay/308271/deli-deli-olma").get();

List<String> saatItem = new ArrayList<String>();

for( Element element : doc.select("div[class=content clear]"))
{
    saatItem.add(element.text());
} 
```

# ruby-on-rails - ActiveRecord 迁移：Postgres：字符串作为主键

> ID：14718116
> 
> 赞同：1
> 
> 时间：2013-02-05T22:21:12.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, rails-activerecord

我尝试了几种方法将字符串添加为rails中的主键。到目前为止，这是我尝试过的。有人可以帮助找到解决方案。

```
class CreateClients < ActiveRecord::Migration
  def change
    create_table :clients, primary_key: :client_id, id: false do |t|
      t.string :client_id
      t.string :client_secret
      t.integer :app_id
    end
    add_index :clients, [:app_id, :client_id]
  end
end 
```

--

```
class CreateClients < ActiveRecord::Migration
  def change
    create_table :clients, id: false do |t|
      t.string :client_id, primary: true
      t.string :client_secret
      t.integer :app_id
    end
    add_index :clients, [:app_id, :client_id]
  end
end 
```

--

```
class CreateClients < ActiveRecord::Migration
  def change
    create_table :clients, id: false do |t|
      t.string :client_id, primary_key: true
      t.string :client_secret
      t.integer :app_id
    end
    add_index :clients, [:app_id, :client_id]
  end
end 
```

# payment-gateway - 如何在付款页面发送 Authorize.net 无声帖子 URL

> ID：14718120
> 
> 赞同：0
> 
> 时间：2013-02-05T22:21:32.863
> 
> 标签：payment-gateway, authorize.net

我正在做服务器集成方法 (SIM)

我需要知道我需要提及哪些字段来告诉授权付款确认页面和静默发布页面。

下面的代码不会做静默后回调

```
<?php
require_once 'anet_php_sdk/AuthorizeNet.php'; // Include the SDK you downloaded in Step 2
$api_login_id = 'YOUR_API_LOGIN_ID';
$transaction_key = 'YOUR_TRANSACTION_KEY';
$amount = "5.99";
$fp_timestamp = time();
$fp_sequence = "123" . time(); // Enter an invoice or other unique number.
$fingerprint = AuthorizeNetSIM_Form::getFingerprint($api_login_id,
  $transaction_key, $amount, $fp_sequence, $fp_timestamp)
?>

<form method='post' action="https://test.authorize.net/gateway/transact.dll">
<input type='hidden' name="x_login" value="<?php echo $api_login_id?>" />
<input type='hidden' name="x_fp_hash" value="<?php echo $fingerprint?>" />
<input type='hidden' name="x_amount" value="<?php echo $amount?>" />
<input type='hidden' name="x_fp_timestamp" value="<?php echo $fp_timestamp?>" />
<input type='hidden' name="x_fp_sequence" value="<?php echo $fp_sequence?>" />
<input type='hidden' name="x_version" value="3.1">
<input type='hidden' name="x_show_form" value="payment_form">
<input type='hidden' name="x_test_request" value="false" />
<input type='hidden' name="x_method" value="cc">
<input type='submit' value="Click here for the secure payment form">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:44:16.933

好的，我找到了这个

`x_Relay_URL`用于静默后处理 URL

```
x_Receipt_Link_URL 
```

网站上的成功页面。

# c# - Mvc3 - 如何从静态函数调用动作

> ID：14718121
> 
> 赞同：-3
> 
> 时间：2013-02-05T22:21:33.220
> 
> 标签：c#, asp.net-mvc

我有一个静态函数，我需要使用参数调用特定的控制器/动作并获得结果。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:25:13.910

您可以创建该特定控制器的实例，然后使用该实例的 Execute() 方法来执行控制器。

我在 Application_Error 处理程序中做了类似的事情：

```
var routeData = new RouteData();
routeData.Values["controller"] = "Error";
routeData.Values["action"] = "General";
routeData.Values["exception"] = exception;

IController errorsController = new ErrorController();
var rc = new RequestContext(new HttpContextWrapper(Context), routeData);
try
{
    errorsController.Execute(rc);
}
catch (Exception ex)
{
    // Appropriate error handling.
} 
```

# excel - Excel - 合并具有共同值的行并将差异连接在一列中

> ID：14718123
> 
> 赞同：6
> 
> 时间：2013-02-05T22:21:54.793
> 
> 标签：excel, vba, excel-formula, merge, concatenation

我想合并具有共同值的行并将差异连接在一列中。

我认为最简单的做法是向您展示一个示例。

**输入：**

```
Customer Name   |   NEW YORK    |   ALBANY 
Customer Name   |   NEW YORK    |   CLINTON    
Customer Name   |   NEW YORK    |   COLUMBIA
Customer Name   |   NEW YORK    |   DELAWARE
Customer Name   |   NEW YORK    |   DUTCHESS  
Customer Name   |   VERMONT     |   BENNINGTON  
Customer Name   |   VERMONT     |   CALEDONIA
Customer Name   |   VERMONT     |   CHITTENDEN
Customer Name   |   VERMONT     |   ESSEX
Customer Name   |   VERMONT     |   FRANKLIN 
```

**期望的输出：**

```
Customer Name   |   VERMONT     |   BENNINGTON,CALEDONIA,CHITTENDEN,ESSEX,FRANKLIN
Customer Name   |   NEW YORK    |   ALBANY,CLINTON,COLUMBIA,DELAWARE,DUTCHESS 
```

我确实看到了其他一些帖子，但我认为它们并不是我想要做的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:48:01.200

如果`|`您的意思是单独的单元格，那么下面的宏（Excel 2007）应该可以解决问题（您的数据从单元格 A1 开始）：

```
Application.ScreenUpdating = False

last_row = Cells(Rows.Count, 1).End(xlUp).Row

'first: make sure data is sorted
Sort.SortFields.Clear
Sort.SortFields.Add Key:=Columns("A:A"), SortOn:=xlSortOnValues
Sort.SortFields.Add Key:=Columns("B:B"), SortOn:=xlSortOnValues
Sort.SortFields.Add Key:=Columns("C:C"), SortOn:=xlSortOnValues

With Sort
    .SetRange Range("A1:C" & last_row)
    .Header = xlNo
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
End With

'then: join text until key values in two neighboring row changes
myText = ""
myPos = 1

For i = 1 To last_row
    If Cells(i, 1).Value <> Cells(i + 1, 1).Value Or Cells(i, 2).Value <> Cells(i + 1, 2).Value Then
        Cells(myPos, 5).Value = Cells(i, 1).Value
        Cells(myPos, 6).Value = Cells(i, 2).Value

        myText = myText & Cells(i, 3).Value
        Cells(myPos, 7).Value = myText
        myText = ""
        myPos = myPos + 1
    Else
        myText = myText & Cells(i, 3).Value & ","
    End If
Next i

Application.ScreenUpdating = True
MsgBox "Done" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-15T12:49:46.320

在新工作表中，您可以使用这些公式来创建唯一客户名称和状态的列表。

您需要使用两个协调功能，在新工作表中输入以下功能`A2`

```
=IFERROR(INDEX(Sheet1!$A$2:$A$6, MATCH(0, COUNTIFS(Sheet2!$A$1:A1, Sheet1!$A$2:$A$6,Sheet2!$B$1:B1, Sheet1!$B$2:$B$6), 0)),"") 
```

和以下功能`B2`

```
=IFERROR(INDEX(Sheet1!$B$2:$B$6, MATCH(0, COUNTIFS(Sheet2!$A$1:A1, Sheet1!$A$2:$A$6,Sheet2!$B$1:B1, Sheet1!$B$2:$B$6), 0)),"") 
```

为此，必须满足以下条件

1.  这需要放在第二个工作表中（`Sheet2`相应地重命名）
2.  `Sheet1!$A$2:$A$6`并且`Sheet1!$B$2:$B$6`应该修改（工作表名称和范围）以分别包含您的客户名称和状态的完整列表。如果列表太长，则唯一值列表中的最后一个条目将 b`0`
3.  上述公式应分别粘贴在`Sheet2!A2`和`Sheet2!B2`
4.  这些是数组公式。输入到指定单元格，然后点击提交`ctrl+alt+enter`
5.  将初始公式输入`A2`并`B2`作为数组输入后，复制并粘贴公式`Column A`，`Column B`直到不再出现唯一名称。

（这个答案是从[这个问题](https://stackoverflow.com/questions/13307927/ignore-duplicates-and-create-new-list-of-unique-values-in-excel)中采用的。有一些变体作为其他答案）

使用数组函数返回 中的县`ColumnC`。将公式粘贴`C2`为数组（带有更新的引用），然后将其复制到列表中。

```
=TEXTJOIN(", ",TRUE,IF((Sheet2!A2=Sheet1!$A$2:$A$6)*(Sheet2!B2=Sheet1!$B$2:$B$6),Sheet1!$C$2:$C$6,"")) 
```

关于这些功能如何工作的简要说明：

-功能1：

1.  `COUNTIFS`查看您的源数据，如果它已经在列表中，则返回一个数组，如果`1`不是，则返回一个数组`0`。
2.  `MATCH`查看`COUNTIFS`数组，并确定第一个`0`
3.  `INDEX`查看您的源数据，并返回由`MATCH`

-功能2：

1.  该`IF`函数创建两个数组`TRUE`或`FALSE`基于源数据是否匹配唯一的客户和行的状态。
2.  这些数组相乘，创建一个新数组，`TRUE`仅当两个条目都是`TRUE`. （表示客户和状态都匹配）
3.  如果为真，则该`IF`语句返回县，如果为假，则返回空单元格`""`
4.  `TEXTJOIN`过滤掉空单元格（这就是`TRUE`正在做的事情）并用逗号和空格（分隔符）将它们连接在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-30T22:02:07.443

In the hyperlink below you'll find the solution to this question. Look for the section "How to combine duplicate rows into one (keeping unique values only)"

[How To Merge Rows For many Scenarios](https://www.ablebits.com/office-addins-blog/2014/02/06/merge-rows-excel/)

Update: The Add-in that performs the task is not free, but there is a 15 day free trial version

# c++ - 如何轻松使 std::cout 线程安全？

> ID：14718124
> 
> 赞同：46
> 
> 时间：2013-02-05T22:22:00.660
> 
> 标签：c++, multithreading, logging, locking, iostream

我有一个多线程应用程序，它大量`std::cout`用于没有任何锁定的日志记录。在这种情况下，如何轻松添加锁机制以使`std::cout`线程安全？

我不想搜索每次出现`std::cout`并添加一行锁定代码。那太乏味了。

有更好的做法吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-11-13T12:46:31.067

虽然我不能确定这适用于 std 库的每个编译器/版本，但在我使用的代码库中`std::cout::operator<<()`它已经是线程安全的。

我假设您真正想要做的事情是在跨多个线程与每个字符串的多个时间`std::cout`连接时停止混合字符串。`operator<<`

字符串出现乱码的原因是因为有一个“外部”竞争，`operator<<` 这可能导致这样的事情发生。

```
//Thread 1
std::cout << "the quick brown fox " << "jumped over the lazy dog " << std::endl;

//Thread 2
std::cout << "my mother washes" << " seashells by the sea shore" << std::endl;

//Could just as easily print like this or any other crazy order.
my mother washes the quick brown fox seashells by the sea shore \n
jumped over the lazy dog \n 
```

如果是这种情况，有一个比创建自己的线程安全 cout 或实现与 cout 一起使用的锁要简单得多的答案。

只需在将字符串传递给 cout 之前编写字符串

例如。

```
//There are other ways, but stringstream uses << just like cout.. 
std::stringstream msg;
msg << "Error:" << Err_num << ", " << ErrorString( Err_num ) << "\n"; 
std::cout << msg.str(); 
```

这样，您的刺就不会出现乱码，因为它们已经完全形成，而且在发送它们之前无论如何都完全形成您的弦也是一种更好的做法。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-05T23:23:57.433

*注意：这个答案是 C++20 之前的，因此它不使用[`std::osyncstream`](https://stackoverflow.com/a/47480827/1468366)单独的缓冲，而是使用锁。*

我想您可以实现自己的类，该类包装`cout`并关联互斥锁。那个`operator <<`新类的 将做三件事：

1.  为互斥锁创建一个锁，可能会阻塞其他线程
2.  做输出，即为`<<`包装的流和传递的参数做运算符
3.  构造一个*不同*类的实例，将锁传递给该类

这个不同的类会将锁和委托运算符保留`<<`给包装的流。第二个类的析构函数最终会破坏锁并释放互斥锁。

因此，您作为单个语句编写的任何输出，即作为单个`<<`调用序列，只要您的所有输出都通过具有相同互斥锁的该对象，就会自动打印。

让我们称这两个类`synchronized_ostream`和`locked_ostream`. 如果`sync_cout`是`synchronized_ostream`wraps的一个实例`std::cout`，则序列

```
sync_cout << "Hello, " << name << "!" << std::endl; 
```

将导致以下操作：

1.  `synchronized_ostream::operator<<`将获得锁
2.  `synchronized_ostream::operator<<`将“Hello”的打印委托给`cout`
3.  `operator<<(std::ostream&, const char*)`会打印“你好，”
4.  `synchronized_ostream::operator<<`将构造 a`locked_ostream`并将锁传递给那个
5.  `locked_ostream::operator<<`将委托`name`印刷`cout`
6.  `operator<<(std::ostream&, std::string)`会打印名字
7.  `cout`感叹号和端线操纵器发生相同的委托
8.  临时对象被破坏，`locked_ostream`锁被释放

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-11-24T22:39:03.190

由于`C++20`，您可以使用`std::osyncstream`包装器：

[http://en.cppreference.com/w/cpp/io/basic_osyncstream](http://en.cppreference.com/w/cpp/io/basic_osyncstream)

```
{
  std::osyncstream bout(std::cout); // synchronized wrapper for std::cout
  bout << "Hello, ";
  bout << "World!";
  bout << std::endl; // flush is noted, but not yet performed
  bout << "and more!\n";
} // characters are transferred and std::cout is flushed 
```

> 它保证所有输出到同一个最终目标缓冲区（上面示例中的 std::cout ）将没有数据竞争，并且不会以任何方式交错或乱码，只要每次写入该 final目标缓冲区是通过 std::basic_osyncstream 的（可能不同的）实例创建的。

或者，您可以使用临时：

```
std::osyncstream(std::cout) << "Hello, " << "World!" << '\n'; 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2017-01-11T23:47:08.533

我真的很喜欢 Nicolás 在[这个问题](https://stackoverflow.com/questions/2196155/is-there-anyway-to-write-the-following-as-a-c-macro)中给出的创建临时对象并将保护代码放在析构函数上的技巧。

```
/** Thread safe cout class
  * Exemple of use:
  *    PrintThread{} << "Hello world!" << std::endl;
  */
class PrintThread: public std::ostringstream
{
public:
    PrintThread() = default;

    ~PrintThread()
    {
        std::lock_guard<std::mutex> guard(_mutexPrint);
        std::cout << this->str();
    }

private:
    static std::mutex _mutexPrint;
};

std::mutex PrintThread::_mutexPrint{}; 
```

然后，您可以从任何线程将其用作常规`std::cout`：

```
PrintThread{} << "my_val=" << val << std::endl; 
```

该对象定期收集数据`ostringstream`。一旦达到昏迷状态，对象就会被销毁并刷新所有收集到的信息。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-03-14T12:50:01.587

为了快速调试 c++11 应用程序并避免交错输出，我只编写了如下的小函数：

```
...
#include <mutex>
...
mutex m_screen;
...
void msg(char const * const message);
...
void msg(char const * const message)
{
  m_screen.lock();
  cout << message << endl;
  m_screen.unlock();
} 
```

我将这些类型的函数用于输出，如果需要数值，我只需使用以下内容：

```
void msgInt(char const * const message, int const &value);
...
void msgInt(char const * const message, int const &value)
{
  m_screen.lock();
  cout << message << " = " << value << endl;
  m_screen.unlock();
} 
```

这很简单，对我来说效果很好，但我真的不知道它在技术上是否正确。所以我很高兴听到你的意见。

* * *

好吧，我没有读到这个：

> 我不想搜索每次出现的 std::cout 并添加一行锁定代码。

对不起。但是我希望它可以帮助某人。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-06T21:52:03.197

一个可行的解决方案是为每个线程使用一个行缓冲区。您可能会得到交错的行，但不会得到交错的字符。如果将其附加到线程本地存储，还可以避免锁争用问题。然后，当一行已满时（或者如果需要，可以刷新），将其写入标准输出。这最后一个操作当然必须使用锁。你把所有这些都塞进一个流缓冲区，你把它放在 std::cout 和它的原始流缓冲区之间。

这不能解决的问题是格式标志（例如数字的十六进制/十进制/八进制）之类的东西，它们有时会在线程之间渗透，因为它们附加到流中。这没什么不好，假设您只记录而不将其用于重要数据。它有助于不专门格式化事物。如果您需要某些数字的十六进制输出，请尝试以下操作：

```
template<typename integer_type>
std::string hex(integer_type v)
{
    /* Notes:
    1\. using showbase would still not show the 0x for a zero
    2\. using (v + 0) converts an unsigned char to a type
       that is recognized as integer instead of as character */
    std::stringstream s;
    s << "0x" << std::setfill('0') << std::hex
        << std::setw(2 * sizeof v) << (v + 0);
    return s.str();
} 
```

类似的方法也适用于其他格式。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-07-12T00:15:27.770

按照 Conchylicultor 建议的答案，但没有继承自`std::ostringstream`：

* * *

编辑：修复了重载运算符的返回类型，并为`std::endl`.

* * *

编辑 1：我已将其扩展为一个[简单的仅标头库](https://github.com/cantordust/dlog)，用于记录/调试多线程程序。

* * *

```
#include <iostream>
#include <mutex>
#include <thread>
#include <vector>    
#include <chrono>

static std::mutex mtx_cout;

// Asynchronous output
struct acout
{
        std::unique_lock<std::mutex> lk;
        acout()
            :
              lk(std::unique_lock<std::mutex>(mtx_cout))
        {

        }

        template<typename T>
        acout& operator<<(const T& _t)
        {
            std::cout << _t;
            return *this;
        }

        acout& operator<<(std::ostream& (*fp)(std::ostream&))
        {
            std::cout << fp;
            return *this;
        }
};

int main(void)
{

    std::vector<std::thread> workers_cout;
    std::vector<std::thread> workers_acout;

    size_t worker(0);
    size_t threads(5);

    std::cout << "With std::cout:" << std::endl;

    for (size_t i = 0; i < threads; ++i)
    {
        workers_cout.emplace_back([&]
        {
            std::cout << "\tThis is worker " << ++worker << " in thread "
                      << std::this_thread::get_id() << std::endl;
        });
    }
    for (auto& w : workers_cout)
    {
        w.join();
    }

    worker = 0;

    std::this_thread::sleep_for(std::chrono::seconds(2));

    std::cout << "\nWith acout():" << std::endl;

    for (size_t i = 0; i < threads; ++i)
    {
        workers_acout.emplace_back([&]
        {
            acout() << "\tThis is worker " << ++worker << " in thread "
                    << std::this_thread::get_id() << std::endl;
        });
    }
    for (auto& w : workers_acout)
    {
        w.join();
    }

    return 0;
} 
```

输出：

```
With std::cout:
        This is worker 1 in thread 139911511856896
        This is worker  This is worker 3 in thread 139911495071488
        This is worker 4 in thread 139911486678784
2 in thread     This is worker 5 in thread 139911503464192139911478286080

With acout():
        This is worker 1 in thread 139911478286080
        This is worker 2 in thread 139911486678784
        This is worker 3 in thread 139911495071488
        This is worker 4 in thread 139911503464192
        This is worker 5 in thread 139911511856896 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-27T01:49:38.723

我知道这是一个老问题，但它对我的问题帮助很大。我根据这篇文章的答案创建了一个实用程序类，我想分享我的结果。

考虑到我们使用 C++11 或更高版本的 C++，该类提供了 print 和 println 函数来在调用标准输出流之前组合字符串并避免并发问题。这些是可变参数函数，它们使用模板来打印不同的数据类型。

您可以在我的 github 上查看它在生产者-消费者问题中的使用情况：[https ://github.com/eloiluiz/threadsBar](https://github.com/eloiluiz/threadsBar)

所以，这是我的代码：

```
class Console {
private:
    Console() = default;

    inline static void innerPrint(std::ostream &stream) {}

    template<typename Head, typename... Tail>
    inline static void innerPrint(std::ostream &stream, Head const head, Tail const ...tail) {
        stream << head;
        innerPrint(stream, tail...);
    }

public:
    template<typename Head, typename... Tail>
    inline static void print(Head const head, Tail const ...tail) {
        // Create a stream buffer
        std::stringbuf buffer;
        std::ostream stream(&buffer);
        // Feed input parameters to the stream object
        innerPrint(stream, head, tail...);
        // Print into console and flush
        std::cout << buffer.str();
    }

    template<typename Head, typename... Tail>
    inline static void println(Head const head, Tail const ...tail) {
        print(head, tail..., "\n");
    }
}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-15T15:46:10.343

这就是我在`std::cout`使用自定义枚举和宏时管理线程安全操作的方式：

```
enum SynchronisedOutput { IO_Lock, IO_Unlock };

inline std::ostream & operator<<(std::ostream & os, SynchronisedOutput so) {
  static std::mutex mutex;

  if (IO_Lock == so) mutex.lock();
  else if (IO_Unlock == so)
    mutex.unlock();

  return os;
}

#define sync_os(Os) (Os) << IO_Lock
#define sync_cout sync_os(std::cout)
#define sync_endl '\n' << IO_Unlock 
```

这使我可以编写如下内容：

```
sync_cout << "Hello, " << name << '!' << sync_endl; 
```

在没有赛车问题的线程中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-08T14:05:23.790

我遇到了和你类似的问题。您可以使用以下类。这仅支持输出到`std::cout`，但如果您需要通用的，请告诉我。在下面的代码中，`tsprint`创建类的内联临时对象`ThreadSafePrinter`。如果您愿意，您可以更改`tsprint`为`cout`if you have used `cout`instead of `std::cout`，因此您不必替换 的任何实例，`cout`但我一般不推荐这种做法。无论如何，从项目的开头开始对此类调试行使用特殊的输出符号要好得多。

我也喜欢这个解决方案：[1](https://stackoverflow.com/a/65739143/17358011)。在我的解决方案中，所有线程都可以继续插入到它们相应`thread_local` `stringstream`的静态对象中，然后仅在需要刷新时才锁定互斥锁，这在析构函数中触发。这有望通过缩短互斥锁的持有时间来提高效率。也许我可以包含一个类似于[1](https://stackoverflow.com/a/65739143/17358011)`sync_endl`中提到的解决方案的机制。

```
class ThreadSafePrinter
{
    static mutex m;
    static thread_local stringstream ss;
public:
    ThreadSafePrinter() = default;
    ~ThreadSafePrinter()
    {
        lock_guard  lg(m);
        std::cout << ss.str();
        ss.clear();
    }

    template<typename T>
    ThreadSafePrinter& operator << (const T& c)
    {
        ss << c;
        return *this;
    }

    // this is the type of std::cout
    typedef std::basic_ostream<char, std::char_traits<char> > CoutType;

    // this is the function signature of std::endl
    typedef CoutType& (*StandardEndLine)(CoutType&);

    // define an operator<< to take in std::endl
    ThreadSafePrinter& operator<<(StandardEndLine manip)
    {
        manip(ss);
        return *this;
    }
};
mutex ThreadSafePrinter::m;
thread_local stringstream ThreadSafePrinter::ss;
#define tsprint ThreadSafePrinter()

void main()
{
    tsprint << "asd ";
    tsprint << "dfg";
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-12-08T13:25:02.527

除了同步之外，此解决方案还提供有关写入日志的线程的信息。

**免责声明**：这是一种非常幼稚的同步日志方式，但它可能适用于一些小的调试用例。

```
thread_local int thread_id = -1;
std::atomic<int> thread_count;

struct CurrentThread {

  static void init() {
    if (thread_id == -1) {
      thread_id = thread_count++;
    }
  }

  friend std::ostream &operator<<(std::ostream &os, const CurrentThread &t) {
    os << "[Thread-" << thread_id << "] - ";
    return os;
  }
};

CurrentThread current_thread;
std::mutex io_lock;
#ifdef DEBUG
#define LOG(x) {CurrentThread::init(); std::unique_lock<std::mutex> lk(io_lock); cout << current_thread << x << endl;}
#else
#define LOG(x)
#endif 
```

可以这样使用。

```
LOG(cout << "Waiting for some event"); 
```

它会给出日志输出

```
[Thread-1] - Entering critical section 
[Thread-2] - Waiting on mutex
[Thread-1] - Leaving critical section, unlocking the mutex 
```

# java - 读取文本文件中的五个分数，然后将它们打印回来，并将新分数添加到列表中 - ANDROID

> ID：14718125
> 
> 赞同：3
> 
> 时间：2013-02-05T22:22:11.457
> 
> 标签：java, android, eclipse, text-files, fileoutputstream

在我的程序中，当玩家提交分数时，它会被添加到名为`localHighScores`. 这是玩家在该特定设备上获得的前五名的列表。

我不知道如何使用（如果你知道请分享）写入新行`FileOutputStream`，所以我在每个分数之间输入了一个空格。因此，我想要做的是当玩家点击`submit`程序将打开文件并读取保存的任何当前数据。它将它保存到一个`String Array`，每个元素都是文本文件中的五个分数之一，当它在文件中点击一个“空格”时，它会将刚刚读取的分数添加到写入数组元素中

我目前拥有的代码如下：

```
 String space = "  ";
    String currentScoreSaved;

    String[] score = new String[5]; 

    int i = 0;
    try
    {           
        BufferedReader inputReader = new BufferedReader(new InputStreamReader(openFileInput("localHighScore.txt")));
        String inputString;StringBuffer stringBuffer = new StringBuffer();

        while ((inputString = inputReader.readLine()) != null && i < 6)
        {
            if((inputString = inputReader.readLine()) != space)
            {
                stringBuffer.append(inputString + "\n");
                i++;
                score[i] = stringBuffer.toString();
            }
        }
        currentScoreSaved = stringBuffer.toString();
        FileOutputStream fos = openFileOutput("localHighScore.txt", Context.MODE_PRIVATE);

        while (i < 6)
        {
            i++;

            fos.write(score[i].getBytes());
            fos.write(space.getBytes());

        }       
        fos.write(localHighScore.getBytes());
        //fos.newLine(); //I thought this was how you did a new line but sadly I was mistaken

        fos.close();
    }
    catch(Exception e)
    {
        e.printStackTrace();            
    } 
```

现在您会注意到，如果达到新的高分，这不会重新排列分数。我计划下一步做的事情。目前，我只是想让程序执行在当前数据中读取的主要内容，将其粘贴到数组中，然后将其与新分数一起打印回该文件

任何想法这可能如何工作，因为目前即使我事先在文本文件中得分，它也没有打印任何内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:50:55.680

我只是 Java 编程的一年级学生，而且我是 stackoverflow.com 的新用户，所以如果 android 编码有一些我不知道的特殊规则，请原谅我，这会阻止这个简单而谦逊的示例工作. 但这是我以最简单的方式从文件中读取的方式。

```
File tempFile = new File("<SubdirectoryIfAny/name_of_file.txt");

Scanner readFile = new Scanner( tempFile );

// Assuming that you can structure the file as you please with fx each bit of info
// on a new line.

int counter = 0;
while ( readFile.hasNextLine() ) {
    score[counter] = readFile.nextLine();
    counter++;
} 
```

至于写回文件？将它放在一个完全不同的方法中，并简单地制作一个简化的 toString 类方法，以您希望它们在文件中的确切方式打印出所有值，然后创建一个类似“loadToFile”的方法并使用 to string 方法打印回来使用打印流进入文件，如下所示。

```
File tempFile = new File("<SubdirectoryIfAny/name_of_file.txt");

PrintStream write = new PrintStream(tempFile);

// specify code for your particular program so that the toString method gets the 
// info from the string array or something like that.

write.print( <objectName/this>.toStringLikeMethod() );
// remember the /n /n in the toStringLikeMethod so it prints properly in the file. 
```

同样，如果这是您已经知道的事情，在这种情况下这是不可能的，请忽略我，但如果不是，我希望它有用。至于例外情况，您可以自己计算。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T00:09:42.730

由于您是初学者，并且我假设您正在尝试尽快完成任务，因此我建议您使用[`SharedPreferences`](http://developer.android.com/reference/android/content/SharedPreferences.html). 基本上它只是一个供您使用的巨大持久地图！话虽如此...您应该真正了解Android中的所有存储方式，因此请查看此文档：

[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

Android 文档很棒！仅供参考，SharedPreferences 可能不是做到这一点的最好和最棒的方法......但我完全赞成作为学习者的快速原型设计。如果需要，可以围绕 SharedPreferences 编写一个包装类。

# actionscript-3 - 在 AS3 中更改类属性

> ID：14718126
> 
> 赞同：1
> 
> 时间：2013-02-05T22:22:15.583
> 
> 标签：actionscript-3, oop, class, properties

好的，所以我最近一直在尝试正确理解 AS3 中的 OOP。现在我有一个非常简单的场景，我有一个类 Paddle，它绘制一个矩形。在我的文档类中，我创建了 Paddle 类的两个实例，即 paddle1 和 paddle2。

我还为我的 Paddle 类创建了一个属性，我想更改它绘制的矩形的颜色。我希望能够从主类调整这个属性。我知道我可以通过在实例化类时传入属性来做到这一点，但似乎属性会是更好的方法，现在我想知道这是否是正确的思维方式。

主类：

```
 package
{
    import flash.display.Sprite;
    import flash.events.Event;

    public class Engine extends Sprite 
    {
        private var paddle1:Paddle = new Paddle();
        private var paddle2:Paddle = new Paddle();

        public function Engine() 
        {
            paddle1.x = 30;
            paddle1.color = 0xFF00FF;
            stage.addChild(paddle1);

            paddle2.x = stage.stageWidth - 45;
            paddle2.color = 0xFF0000;
            stage.addChild(paddle2);
        }

    }

} 
```

桨类：

```
package
{
    import flash.display.MovieClip;
    import flash.display.Shape;
    import flash.display.Graphics;
    import flash.events.Event;

    public class Paddle extends MovieClip
    {
        public var color:uint = 0xFFFFFF;

        public function Paddle() 
        {
            var child:Shape = new Shape();
            child.graphics.beginFill(color);
            child.graphics.drawRect(0, 260, 15, 80);
            child.graphics.endFill();
            addChild(child);
        }

    }

} 
```

如果以这种方式更改属性不是最好的做事方式，那么当然要这么说。否则，我做错了什么，它不起作用？似乎与订单有关（当主类更改颜色属性时，它已经创建了矩形并且更改它为时已晚？）

感谢：D

编辑：意识到当我执行这段代码时会发生什么可能会有所帮助。基本上从 Engine 类更改颜色属性不会改变矩形的颜色，它们都只是保持白色（FFFFFF）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:32:26.037

您遇到的问题是，当您这样做时：

```
new Paddle(); 
```

您的构造函数代码已运行。这意味着已经使用类顶部定义的颜色绘制了 Rectangle。然后，您将在此之后更改颜色属性，如您所见，这没有任何效果。

我建议你`draw()`为你的`Paddle`. 它可以接受一种颜色并用于绘制矩形。它可能看起来像这样：

```
public class Paddle extends MovieClip
{

    private var _child:Shape;

    public function Paddle() 
    {
        _child = new Shape();
        addChild(_child);
    }

    public function draw(color:uint):void
    {
        _child.graphics.clear();
        _child.graphics.beginFill(color);
        _child.graphics.drawRect(0, 260, 15, 80);
        _child.graphics.endFill();
    }

} 
```

这种方式提供了一个优势，即您可以修改 的参数`draw()`以接受 Rectangle 或其他会影响视觉效果的元素的尺寸。如果您决定要这样做，这将比必须向类本身添加更多属性更清洁和更快。

然后你可以这样做：

```
var paddle1:Paddle = new Paddle();
var paddle2:Paddle = new Paddle();

paddle1.draw(0xFF00FF);
paddle2.draw(0xFF0000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:48:43.810

*除了*为颜色创建一个设置器之外，您可能要做的是允许构造函数分配一种颜色，随后两个调用都绘制桨（顺便说一下，它也可以是一个简单的 flash.display.Shape）：

**桨.as：**

```
package
{
    //Imports
    import flash.display.Sprite;

    //Class
    public class Paddle extends Sprite
    {
        //Constants
        private static const DEFAULT_COLOR:uint = 0xFF0000;

        //Properties
        private var mColor:uint;

        //Constructor
        public function Paddle(color:uint = DEFAULT_COLOR) 
        {
            mColor = color;

            draw();
        }

        //Draw
        private function draw():void
        {
            graphics.clear();
            graphics.beginFill(mColor);
            graphics.drawRect(0, 0, 15, 80);
            graphics.endFill();
        }

        //Set Color
        public function set color(value:uint):void
        {
            mColor = value;

            draw();
        }

        //Get Color
        public function get color():uint
        {
            return mColor;
        }
    }
} 
```

所以现在您可以创建和定位任意数量的 Paddle 实例，每个实例都有自己的颜色设置器：

**红色实例：**

```
var paddleRed:Paddle = new Paddle();
paddleRed.y = 10;
addChild(paddleRed); 
```

**绿色实例：**

```
var paddleGreen:Paddle = new Paddle(0x00FF00);
paddleGreen.y = 126;
addChild(paddleGreen); 
```

**蓝色实例：**

```
var paddleBlue:Paddle = new Paddle();
paddleBlue.color = 0x00FF00;
paddleBlue.y = 260;
addChild(paddleBlue); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:43:46.403

为什么不两者都做？:D

```
public class Paddle extends MovieClip
{
    private var color:uint;
    private var rec:Shape;

    public function Paddle(newColor:uint = 0xFFFFFF) // default color
    {
        color = newColor;
        rec = new Shape();
        drawShape();
        addChild(rec);
    }

    public function drawShape()
    {
        child.graphics.clear();
        child.graphics.beginFill(color);
        child.graphics.drawRect(0, 260, 15, 80);
        child.graphics.endFill();
    }

    public function setColor(newColor:uint)
    { 
        color = newColor;
        drawShape();
    }
} 
```

# javascript - JSON Stringify 崩溃

> ID：14718130
> 
> 赞同：4
> 
> 时间：2013-02-05T22:22:26.137
> 
> 标签：javascript, json, stringify

我一直在测试一些代码，它采用 json 格式的变量并应该打印它，但是它打印一个空数组。

如果我正在尝试这个：

```
console.log(JSON.stringify({first:1,second:2})); 
```

然后我正在崩溃页面（Chrome：“Aw，Snap！”）。

我问了几个人，他们无法重现它，但我每次都得到它。也在 FireFox 中测试过，它也崩溃了。

这是代码：

```
var timer={first:0,second:0,third:0,fourth:0};
localStorage.setItem('saveTimers', JSON.stringify(timer)); 
```

这在 localStorage 中设置 []

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:52:22.520

我经常运行它时能够让它*崩溃*：

```
for (var i = 0; i < 100000; i ++) {
    var timer={first:0,second:0,third:0,fourth:0};
    localStorage.setItem('saveTimers', JSON.stringify(timer));
} 
```

也许您真的很快地多次运行此代码？一个解决方案可能是限制你的函数，这可以通过[实现一个节流函数](http://remysharp.com/2010/07/21/throttling-function-calls/)或使用[Underscore.js 的节流](http://underscorejs.org/#throttle)来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:48:29.920

因此，据我了解，您真正遇到的问题是将内容保存到`localStorage`.

这似乎更像是一个权限问题而不是其他任何事情。浏览器是否有权访问文件系统？浏览器使用的文件夹是否可以写入？您是否尝试过重新安装浏览器？

这些是你应该检查的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:56:20.277

如果您使用的是 chrome 的 beta 或 dev 版本，请仔细检查此行为在稳定版本中是否相同，如果不是，那么就是您的问题。

# java - 将 XML 字符串转换为 JSON 对象对象

> ID：14718133
> 
> 赞同：1
> 
> 时间：2013-02-05T22:22:47.440
> 
> 标签：java, xml, json, transformation

我正在尝试将 XML 字符串转换为 JSON 对象。我使用了 net.sf.json，但它去掉了根元素。

```
XMLSerializer xmlSerializer = new XMLSerializer();
net.sf.json.JSON netsfJSON = xmlSerializer.read(xml); 
```

我也试过 org.json.XML

```
JSONObject jsonObject=XML.toJSONObject(xml); 
```

但它没有区分属性和元素。还有什么我可以使用的，或者上面的两个库中有一些设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:24:54.453

创建对象后，`XMLSerializer`您需要将**forceTopLevelObject**属性设置为 true，因为默认设置为 false。

```
XMLSerializer xmlSerializer = new XMLSerializer();

xmlSerializer.setForceTopLevelObject(true); 
```

希望这可以帮助。

颂歌

# python - 如何判断我使用的是哪个 python 实现？

> ID：14718135
> 
> 赞同：65
> 
> 时间：2013-02-05T22:22:56.820
> 
> 标签：python, cpython

Python 有几个不同的实现：CPython、Jython、PyPy 等。我想以编程方式确定我的代码在哪个实现上运行。我怎样才能做到这一点？

具体来说，写一个`get_implementation_name()`为我调用的函数：

```
impl_name = get_implementation_name()
if impl_name == "CPython":
  print "I can abuse CPython implementation details. (I'm a bad, bad man.)"
elif impl_name == "PyPy":
  print "Can't count on reference-counting garbage collection here..."
else:
  print "I better be careful..." 
```

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2013-02-05T22:25:19.993

```
In [50]: import platform    
In [52]: platform.python_implementation()
Out[52]: 'CPython' 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-05T22:26:32.857

[平台](http://docs.python.org/2/library/platform.html#platform.python_implementation)怎么样

它给了你

```
platform.python_implementation() 
```

# string - perl中的字符串对齐/匹配对齐

> ID：14718136
> 
> 赞同：0
> 
> 时间：2013-02-05T22:22:57.457
> 
> 标签：string, perl, alignment

我有两个字符串 $dna1 和 $dna2。将两个字符串作为连接打印，然后在连接字符串的末尾打印在其副本上排列的第二个字符串。例如，如果输入字符串是 AAAA 和 TTTT，则打印：

```
AAAATTTT
    TTTT 
```

这是一个自我练习题..不是家庭作业，

我尝试使用索引 #!/usr/bin/perl -w

```
$a ='AAAAAAAAAATTTTTTTTT';
$b ='TTTTTTTTTT';
print $a,"\n";
print ''x index($a,$b),$b,"\n"; 
```

但它没有按需要工作。请帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:28:01.770

首先检查`index($a,$b)`返回的内容......也许你应该选择一个`$b`实际在`$a`！

然后意识到连接 10 个空字符串的实例是一个空字符串，而不是 10 个空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:46:26.307

这是一个有趣的小练习。我这样做了：

```
perl -lwe'$a="AAAA"; $b="TTTT"; $c = $a.$b; $i = index($c,$b) + length($b); 
          print $c; printf "%${i}s\n", $b;'
AAAAAAATTTT
       TTTT 
```

请注意，一般来说，通过使用变量名称`$a`是`$c`一个坏主意，并且仅在此处可接受，因为它是单行的。`$a`并且`$b`也是与 . 一起使用的保留变量名称`sort`。

# special-characters - AutoHotKeys 不从文件发送换行符或制表符

> ID：14718141
> 
> 赞同：0
> 
> 时间：2013-02-05T22:23:12.387
> 
> 标签：special-characters, autohotkey

我想通过使用 AHK 将文本文件复制到游戏中，因为复制和粘贴不起作用。我去了网站，发现我可以使用这个：

```
!a::
    Loop, read, D:\MoeTM\Desktop\Farm Turtle.txt
    {
        Loop, parse, A_LoopReadLine
        {
            Send %A_LoopField%
            sleep 100
        }
    } 
```

这使得 AHK 循环遍历文件并发送所有普通字符 abc...123... 但它不发送制表符或换行符。我将如何解决这个问题？发送制表符和换行符（我只需要这些特殊字符）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T06:37:57.257

正如 Dexter 之前提到的，`'n`是换行符和`'r`回车符，但可能是您只需要`Enter`在每一行之后添加一个吗？
顺便说一句，我`'`在这个回复中使用了，但应该是 AHK #Escape 字符，它是`Esc`美国布局键盘上键下方的反引号或控制台键。我在实际代码中使用了正确的字符。

当你想以`NewLine`和/或结束时`CarriageReturn`

```
Send %A_LoopField%`n`r 
```

或者当你想结束时`Enter`

```
Send %A_LoopField%{Enter} 
```

或者当你想结束时`Tab`

```
Send %A_LoopField%{Tab} 
```

根据接收应用程序，只需`'n`or`'r`就足够了，或者您可能需要两者`'n'r`或相反的顺序`'r'n`。

# c - 在 C 中的 double 上返回负功率

> ID：14718144
> 
> 赞同：0
> 
> 时间：2013-02-05T22:23:51.297
> 
> 标签：c

我有一个计算双数幂的函数，下一个任务是添加选项，以便它可以处理负幂。

所以我将此代码添加到函数中：

```
if (p < 0)
    {
        for (y = 1; y <= p; y++)
        {
            pow *= n;
        }
        pow = 1/pow;
    } 
```

整个程序很短，所以我也将分享它：

```
#include <stdio.h>
double power(double n, int p); // ANSI prototype

int main(void)

{
    double x, xpow;
    signed int exp;
    printf("Enter a number and the positive integer power");
    printf(" to which\nthe number will be raised. Enter q");
    printf(" to quit.\n");
    while (scanf("%lf%d", &x, &exp) == 2)
    {
        xpow = power(x,exp); // function call
        printf("%.3g to the power %d is %.5g\n", x, exp, xpow);
        printf("Enter next pair of numbers or q to quit.\n");
    }
    printf("Hope you enjoyed this power trip -- bye!\n");
    return 0;
}
double power(double n, signed int p) // function definition
{
    double pow = 1;
    int i;
    int y;

    if (p < 0)
    {
        for (y = 1; y <= p; y++)
        {
            pow *= n;
        }
        pow = 1/pow;
    }

    for (i = 1; i <= p; i++)
        pow *= n;

    return pow; // return the value of pow
} 
```

如果我输入输入和我想得到`5.0`的功率，我得到......`-3``0.008``1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:26:59.727

你忘了一个 else 吗？如果

```
if (p < 0)
{
    for (y = 1; y <= -p; y++)
    {
        pow *= n;
    }
    pow = 1/pow;
}
else

for (i = 1; i <= p; i++)
    pow *= n; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:27:06.473

如果你输入你的力量为 -3，你的 for 条件都不成立。

```
 if (p < 0)
    {
        for (y = 1; y <= p; y++)
        {
            pow *= n;
        }
        pow = 1/pow;
    } 
```

如果 p < 0，y 永远不会小于 p。

# python - 在 Linux 上开发 HDMI 端口

> ID：14718147
> 
> 赞同：7
> 
> 时间：2013-02-05T22:24:09.473
> 
> 标签：python, c, linux, kernel, hdmi

怎样才能从应用程序中专门驱动 HDMI 输出，而不允许操作系统自动配置它以进行显示输出？

例如，使用标准 DVI/VGA 作为主显示器，但使用设备文件将 Mplayer 视频输出发送到 HDMI。

这是一个很难通过谷歌回答的问题。几乎所有结果都与通过 HDMI 制作音频有关。

（在这里编辑）

下面的评论提到使用单独的 Xorg 服务器。尽管这是一个有用的想法，但它并没有回答我提出的一个问题，以及我暗示的一个问题：

1) 如果它在另一个显示器之前加载，或者如果它是唯一的显示器（仅使用 SSH 登录时），我如何防止 Linux 将控制台放在该显示器上？2）如果没有X怎么办？我想直接将图形驱动到适配器。我可以使用标准功能从代码中执行此操作，而不直接与驱动程序交互（可能已过时，但使用 SVGALib 或其他一些非 X 图形层）？

（在这里编辑）

我查看了 SVGALib（它是旧的）和 SDL。后者在 X 内部和外部都可以工作，甚至提供对 OpenGL 的访问。我通过某处的论坛链接找到了 1.3 版本，但网站和 FTP 似乎都只有 1.2 版本。总的来说，SDL 是一个很好的解决方案，但它有以下两个具体的缺点：

1) 一般的 create-device 调用接受设备索引，但完全忽略它：

```
(src/video/bwindow/SDL_bvideo.cc)
BE_CreateDevice(int devindex) 
```

特定于驱动程序的调用似乎具有相同的缺陷。例如，DirectFB（我假设它在控制台下提供图形）：

```
(src/video/directfb/SDL_DirectFB_video.c)
DirectFB_CreateDevice(int devindex) 
```

这些函数的主体似乎都没有设置设备索引的现有位置......毫无疑问，由于缺乏对它们构建的标准接口的支持。

2) 无论何时选择适配器，SDL 似乎都会自动将所有显示器连接在一起。示例“testsprite2.c”（与库一起提供）接受“--display”参数，该参数在“common.c”（所有示例的通用功能）中处理。您可以看到，它使用“--display”参数所做的只是在一个大的组合画布中计算该屏幕的 X/Y 坐标：

```
if (SDL_strcasecmp(argv[index], "--display") == 0) {
    ++index;
    if (!argv[index]) {
        return -1;
    }
    state->display = SDL_atoi(argv[index]);
    if (SDL_WINDOWPOS_ISUNDEFINED(state->window_x)) {
        state->window_x = SDL_WINDOWPOS_UNDEFINED_DISPLAY(state->display);
        state->window_y = SDL_WINDOWPOS_UNDEFINED_DISPLAY(state->display);
    }
    if (SDL_WINDOWPOS_ISCENTERED(state->window_x)) {
        state->window_x = SDL_WINDOWPOS_CENTERED_DISPLAY(state->display);
        state->window_y = SDL_WINDOWPOS_CENTERED_DISPLAY(state->display);
    }
    return 2;
} 
```

因此，如果它们在同一个适配器上，则无法将它们与另一台显示器隔离开来。SDL 将无法工作。

**除非有与 SDL 类似的解决方案，或者将特定设备 (devindex) 设置在适当的位置是微不足道的（可能不是这种情况，因此可能是它未实现的原因），它似乎独家和完全专用使用屏幕的最佳选择是在分配给您的第二台设备的单独 Xorg 实例下编写您自己的窗口管理器。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T02:59:09.220

您可以直接写入帧缓冲设备 /dev/fb （假设您的控制台默认使用一个）。要防止控制台显示在其上，只需禁用所有虚拟终端（然后您将只能远程登录）。如果您有多个适配器，您应该获得多个帧缓冲设备（这需要确认）。

在帧缓冲区上绘制矩形的 AC 示例如下：

[通过 Linux FrameBuffer 将像素绘制到屏幕上](https://stackoverflow.com/questions/4996777/paint-pixels-to-screen-via-linux-framebuffer)

```
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <fcntl.h>
#include <linux/fb.h>
#include <sys/mman.h>
#include <sys/ioctl.h>

int main()
{
    int fbfd = 0;
    struct fb_var_screeninfo vinfo;
    struct fb_fix_screeninfo finfo;
    long int screensize = 0;
    char *fbp = 0;
    int x = 0, y = 0;
    long int location = 0;

    // Open the file for reading and writing
    fbfd = open("/dev/fb0", O_RDWR);
    if (fbfd == -1) {
        perror("Error: cannot open framebuffer device");
        exit(1);
    }
    printf("The framebuffer device was opened successfully.\n");

    // Get fixed screen information
    if (ioctl(fbfd, FBIOGET_FSCREENINFO, &finfo) == -1) {
        perror("Error reading fixed information");
        exit(2);
    }

    // Get variable screen information
    if (ioctl(fbfd, FBIOGET_VSCREENINFO, &vinfo) == -1) {
        perror("Error reading variable information");
        exit(3);
    }

    printf("%dx%d, %dbpp\n", vinfo.xres, vinfo.yres, vinfo.bits_per_pixel);

    // Figure out the size of the screen in bytes
    screensize = vinfo.xres * vinfo.yres * vinfo.bits_per_pixel / 8;

    // Map the device to memory
    fbp = (char *)mmap(0, screensize, PROT_READ | PROT_WRITE, MAP_SHARED, fbfd, 0);
    if ((int)fbp == -1) {
        perror("Error: failed to map framebuffer device to memory");
        exit(4);
    }
    printf("The framebuffer device was mapped to memory successfully.\n");

    x = 100; y = 100;       // Where we are going to put the pixel

    // Figure out where in memory to put the pixel
    for (y = 100; y < 300; y++)
        for (x = 100; x < 300; x++) {

            location = (x+vinfo.xoffset) * (vinfo.bits_per_pixel/8) +
                       (y+vinfo.yoffset) * finfo.line_length;

            if (vinfo.bits_per_pixel == 32) {
                *(fbp + location) = 100;        // Some blue
                *(fbp + location + 1) = 15+(x-100)/2;     // A little green
                *(fbp + location + 2) = 200-(y-100)/5;    // A lot of red
                *(fbp + location + 3) = 0;      // No transparency
        //location += 4;
            } else  { //assume 16bpp
                int b = 10;
                int g = (x-100)/6;     // A little green
                int r = 31-(y-100)/16;    // A lot of red
                unsigned short int t = r<<11 | g << 5 | b;
                *((unsigned short int*)(fbp + location)) = t;
            }

        }
    munmap(fbp, screensize);
    close(fbfd);
    return 0;
} 
```

只要您有可用的构建工具以及系统的标头，它就应该可以编译。为了刺激，从 SSH 运行它，并在您尚未登录的物理屏幕上观看它的绘制。

应该注意的是，在 X11 之外，有很多工具可以处理帧缓冲区，但它们不会直接访问帧缓冲区。相反，它们通过称为 DirectFB 的附加抽象层工作。DirectFB 将允许相同的应用程序在 X11 内外运行......包括 MPlayer、GStreamer、任何包含 SDL（称为 DirectFB）的应用程序，以及一个名为 XDirectFB 的轻量级、流行的假 X11 容器（我相信它应该运行 X11 应用程序，但不像典型的窗口管理器那样负担过重）。

# java - 如何在 JSP 中包含文件的转义版本

> ID：14718151
> 
> 赞同：2
> 
> 时间：2013-02-05T22:24:28.250
> 
> 标签：java, jsp, escaping

我有一个要包含在 JSP 中的静态文件。另一个文件将被视为静态文本，而不是 JSP。这个其他文件中包含特殊字符，例如“<%”。因此，当我尝试包含它时会出现错误。

如何包含转义字符或理解它应该是静态的这个文件？

`<%@ include file="/FileWithSpecialCharacters.html" %>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:45:44.000

我不认为你可以用包含来做到这一点。

但是您可以通过在某处读取和缓存文件内容然后用于`<%= ...%>`插入它来做到这一点。这个主题有很多可能的变化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:50:51.690

您可以尝试使用[JSTL](http://www.oracle.com/technetwork/java/index-jsp-135995.html)：

```
<c:import url="/FileWithSpecialCharacters.html" context="/other" var="doc"/> 
```

您可以使用该`var`属性在一个`<c:import>`标签和另一个需要输入的标签之间进行通信。

```
<c:out value="${doc}"/> 
```

`<c:out>`，默认情况下，它确保任何对 HTML 或 XML 具有特殊含义的字符都使用实体引用进行转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:44:21.803

如何首先将其作为资源读取，对其进行 url 编码并将其写入另一个文件 - 然后将其包含在内。所以我想你必须先做一个检查，如果等效的“编码”文件已经存在。为什么首先要使用特殊字符？

# java - 如何使用 JFreeChart 绘制数组产生的值

> ID：14718160
> 
> 赞同：1
> 
> 时间：2013-02-05T22:24:54.600
> 
> 标签：java, jfreechart

我有一个函数可以产生两倍于数组大小的负载。我很想知道如何使用 a 绘制这些值`XYLineChart`？我不确定如何将这些双打放入正确的格式，以便它们可以被绘制。如何将我的`double[]`变量更改为`XYSeries`将接受然后绘制的合适格式。我的代码清单如下。

```
public XYSeries inputOutputGraph() {
    XYSeries graph = new XYSeries();
    XYDataset xyDataset = new XYSeriesCollection(graph);
    graph.add(valuesToPlot.outputArray); //This line here is the issue
    JFreeChart chart = ChartFactory.createXYLineChart(
            " Array values", "Time", "values",
            xyDataset, PlotOrientation.VERTICAL, true, true, false);
    ChartFrame graphFrame = new ChartFrame("XYLine Chart", chart);
    graphFrame.setVisible(true);
    graphFrame.setSize(300, 300); 
    return graph;
} 
```

这是我收到的错误消息：

> 没有找到适合 add(double[]) 方法的方法 org.jfree.data.xy.XYSeries.add(org.jfree.data.xy.XYDataItem,boolean) 不适用

（实际参数列表和形式参数列表的长度不同）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:59:51.813

# java - 为什么我在android中使用layoutinflater？

> ID：14718164
> 
> 赞同：0
> 
> 时间：2013-02-05T22:25:08.730
> 
> 标签：java, android

我是 Android 的初学者开发人员：

你`layoutinflater`能解释一下它是做什么的吗？你能解释一下它在一般情况下的用途，尤其是在这段代码中吗？

我有这个代码：

```
 private class MyPagerAdapter extends PagerAdapter {

    public int getCount() {
        return 5;
    }

    public Object instantiateItem(View collection, int position) {

    *** LayoutInflater inflater = (LayoutInflater) collection.getContext()
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        int resId = 0;
        switch (position) {
        case 0:
            resId = R.layout.farleft;
            break;
        case 1:
            resId = R.layout.left;
            break;
        case 2:
            resId = R.layout.middle;
            break;
        case 3:
            resId = R.layout.right;
            break;
        case 4:
            resId = R.layout.farright;
            break;
        }

        View view = inflater.inflate(resId, null);

        ((ViewPager) collection).addView(view, 0);

        return view;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:45:21.457

LayoutInflater 服务将存储的 XML 布局副本转换为应用程序进程内存空间中真实实例化视图的集合。

*   您在编辑器中创建的布局保存为 XML。
*   XML 作为资源嵌入到您的应用程序中。
*   layoutinflater 读取资源文件。
*   然后它会创建您指定为对象的视图。
*   您现在可以从代码中操作视图对象。

当您调用[setContentView(int)时，Activity 类会自动为您执行此过程](http://developer.android.com/reference/android/app/Activity.html#setContentView%28int%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:46:05.850

A`LayoutInflater`将 XML 文件“转换”为一个`View`对象，其中包含`View`该 XML 中指定的所有子项。您也可以说“平面”XML 文件“膨胀”为`View`.

另请参阅[LayoutInflater | 安卓开发者](http://developer.android.com/reference/android/view/LayoutInflater.html)

# sql - 如何根据其他列计算重复项？

> ID：14718167
> 
> 赞同：0
> 
> 时间：2013-02-05T22:25:17.527
> 
> 标签：sql, sql-server, database, tsql

这是一个模仿我的场景的示例表：

```
COL_1   COL_2       
1       a               
2       a               
9       b               
8       b               
11      b 
```

我有两列，其中第 1 列具有不同的数值，第 2 列代表不同的类（a、b、c 等）。在第 3 列中，我希望根据第 1 列中的最大/最低值对它们进行按班级计数并与 0/1 数字匹配。因此，如果在我的示例中，“a”类只有两个值（在我们的示例中 1 2）它们应该从 0 到 1 计数（其中 0 代表第 1 列中的最小数字，1 代表最大数字）。如果 b 类由 3 个条目表示，我希望根据“b”类中第 1 列的最大/最小数字将它们与 0/1/2 数字匹配。

在我的查询之后，我想要这样的东西：

```
COL_1   COL_2   COL_3   
1       a       0       
2       a       1       
9       b       1       
8       b       0       
11      b       2 
```

所以，换句话说，我想要一个查询来查看我们在第 2 列中有多少重复项，并根据它们在第 1 列中表示的内容为它们提供从最低到最大的值（其中 0 是最低的）。

感谢任何帮助我的人。

*我正在使用 MS SQL，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:42:49.913

```
select 
    col_1,
    col_2,
    row_number() over(
        partition by col_2 order by col_1
    ) - 1 as col3
from yourtablename 
```

# javascript - javascript对象和html dom之间的内存利用率

> ID：14718175
> 
> 赞同：1
> 
> 时间：2013-02-05T22:25:49.777
> 
> 标签：javascript, html, dom, frontend

当涉及到 javascript 对象和 html dom 之间的浏览器内存利用率时，主要关注的是什么。

```
var testArray = [1,2,3,4,5,6,7,8,9,10] 
```

对比

```
<input type="text" id="textTextbox" value="test value"/> 
```

在查看大图时，可以说页面上有 10,000 个 html dom，并且一个 javascript 对象拥有大量记录，可以说 50,000

1.  在浏览器上使用更多内存
2.  如何为 javascript 对象管理内存
3.  浏览器如何管理 html dom

请帮忙..

问候，

纳文·莱昂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:40:34.677

这个问题有实际原因吗？我无法想象为什么有人想要在现实生活中管理这样的数据。

我的直觉反应是说很大程度上取决于浏览器环境。在您的意思上，没有与浏览器自身的内存管理分开的 JavaScript 内存管理或 DOM 内存管理之类的东西。

请记住，DOM 有不同的渲染引擎（WebKit、Gecko、Trident）和实现 JavaScript 运行时的不同 JavaScript 引擎（Rhino、JavaScriptCore、V8、IonMonkey）。这些都会以不同的方式管理内存，各有利弊。

因此，不同的浏览器会以不同的方式管理 DOM 和/或 JavaScript。如果您想知道答案，我建议在您描述的两种情况下使用诊断工具在不同浏览器中进行实验并测量内存使用情况。

# php - php info 不显示 GD 设置

> ID：14718188
> 
> 赞同：2
> 
> 时间：2013-02-05T22:26:25.747
> 
> 标签：php, macos, apache2, gd

我在 Mac OS X 10.5.8 上运行 Apache2
我按照说明在 Mac OS X 10.5.8 上安装 GD for Apache2 并重新启动了我的 Apache2

如果我去 bash

```
bash-3.2$ php -m | grep gd
gd 
```

所以这意味着我已经安装了它，但是当我这样做时

```
echo phpinfo(); 
```

我没有看到任何 GD 设置。我怎样才能解决这个问题？

# python - 字符串到黑白图像

> ID：14718193
> 
> 赞同：0
> 
> 时间：2013-02-05T22:26:47.557
> 
> 标签：python, image

在 Python 中，字符串：

```
a = '00001111\n00110011\n00110101\n.....' 
```

我如何将其转换为 8x8 像素的图像，其中 0 代表黑色，1 代表白色。是学习例如 BMP 并从中制作 BMP 文件的途径。还是有更顺畅的启蒙之路？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:02:28.123

第一步是将您的字符串转换为包含正确值的字节序列：

```
pixel_value = {'0': 0, '1': 255}
byte_seq = ''.join(chr(pixel_value[c]) for c in a if c in pixel_value) 
```

然后使用[PIL`Image.fromstring`](http://www.pythonware.com/library/pil/handbook/image.htm)将其转换为图像：

```
from PIL import Image
im = Image.fromstring('L', (8, 8), byte_seq)
im.show() 
```

# javascript - 使用字符限制javascript粘贴而不是在输入字段中输入文本

> ID：14718198
> 
> 赞同：0
> 
> 时间：2013-02-05T22:27:15.350
> 
> 标签：javascript, character, limit, paste

我的代码使用一种“倒计时”字段来限制字符数，该字段在用户键入时实时工作。

除非用户“粘贴”他们的文本，否则一切正常。只有当他们再次单击该字段时，它才会重置并知道输入的字符太多。

有没有办法让它在 mouseup / out 上工作......或与用户的粘贴交互？

这是当前代码：

```
<script type="text/javascript">
function textCounter(field,cntfield,maxlimit) {
if (field.value.length > maxlimit)
field.value = field.value.substring(0, maxlimit);
else
cntfield.value = maxlimit - field.value.length;
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:37:35.403

试试这个`maxlength`属性：

```
<input type="text" maxlength="10"> 
```

# linux - 通过 Linux/Ubuntu shell 脚本访问 Firefox Web 控制台？

> ID：14718200
> 
> 赞同：1
> 
> 时间：2013-02-05T22:27:25.403
> 
> 标签：linux, shell, firefox, ubuntu, console

我有一个 shellscript (ubuntu /bin/bash)，它可以提取 html 页面、提取纯文本、为所有页面创建索引等。现在我需要网页的屏幕截图。

我尝试了很多 linux 命令行工具，例如 webkit2png、cutycapt 和快门。他们都无法获得正确的输出。Webkit2png 是最好的，但是 qt4 库中有一个错误，这对我来说是不可能的。

新版firefox控制台截图命令完美，页面按需渲染。

是否可以通过 shell 脚本运行 firefox 的 Web 控制台的命令，我想到类似 ">firefox --webconsole=screenshot [http://www.domain.com](http://www.domain.com) " 的东西？

# excel - 使用 Excel 在字母数字字符串中出现的某些字母的总和

> ID：14718201
> 
> 赞同：4
> 
> 时间：2013-02-05T22:27:25.933
> 
> 标签：excel, parsing, match, string-matching

我有一个用于应用程序测试的字母数字数据数组，由于某些原因，我需要计算每个字符串**中从“a”到“f”的字母出现的总和**（这将用于进一步的数据处理）：

```
02599caa0b600 --> should be 4
489455f183c1fb49b --> should be 5
678661081c1h
66410hd2f0kxd94f5bb
8a0339a4417
f6d9f967ts4af6e
886sf7asc3e85ec
03f1fhh3c3a2am
e491b17638m60
1m8h2m07bhaa4tnhbc4
29ma900a80m96m65
ca6a75f505tsac8
956828db8ts7fd1d
cf1d220a59a7851180e
a8b7852xd9e7a9
b85963fbe30718db9976
39b8kx8f85abb1b6
0xxb3b648ab
a8da75f730d45048
588h69d344 
```

这就是字符串的样子，它们的长度大约是 10-30 个符号，我想每天大约有**3-5k**个用于处理。假设和限制：

1.  字母大小写无关紧要（高兴地）。
2.  字母列表可能有一天会改变，但很可能仍然是一个**范围**，例如 ak、dg 等 - 因此解决方案应该尽可能灵活。
3.  不禁止任何临时计算/范围，但越短越好。
4.  我更喜欢纯 Excel 解决方案，但如果它太复杂 - VBA 仍然是一种选择。然而，复杂的 Excel 公式比“2 行代码”VBA 更好 - 如果第一个按预期工作。

到目前为止我尝试过的事情（我注意到，这里的做法非常受欢迎）：

*   搜索已经回答的问题，但没有找到任何类似的基于 Excel 的解决方案。其他语言/方法不是一种选择（VBA 除外）。
*   到目前为止，我自己得到的最好的东西是嵌套`SUBSTITUTE`函数，但它很脏而且非常简单。假设范围可能会更改为 cx，那将是一场噩梦。
*   我不是 Excel 的新手，但复杂的数组公式之类的东西对我来说仍然是个难题——唉，但确实如此……

无论如何，我不要求“即用型”“开箱即用”的解决方案——我要求帮助和正确的方向/方法来自学和进一步理解类似的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:41:31.883

您可以在不嵌套多个 SUBSTITUTE 函数的情况下使用 SUBSTITUTE，例如，对于 A1 中的文本字符串，B1 中的这个公式将计算所有字母 a 到 f（大写或小写）

`=SUMPRODUCT(LEN(A1)-LEN(SUBSTITUTE(LOWER(A1),{"a","b","c","d","e","f"},"")))`

对于像 c 到 x 这样更长的字母列表，您可以使用此版本来避免将它们全部列出

`=SUMPRODUCT(LEN(A1)-LEN(SUBSTITUTE(LOWER(A1),CHAR(96+ROW(INDIRECT("3:24"))),"")))`

3:24 代表字母 3 (c) 到字母 24 (x)，因此您可以轻松地将所有字母更改为 1:26 或将 o 更改为 15:25 到 y 等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T00:12:05.247

这是我的选择 - 与已经发布的非常相似，但无论如何......特别是如果你有兴趣学习，这在今天非常罕见）

假设您的列表以 A2 开头，请使用以下数组公式：

```
=SUM(LEN($A2)-LEN(SUBSTITUTE($A2,CHAR(ROW(INDIRECT(CODE("a")&":"&CODE("f")))),""))) 
```

就像提醒一样 - 按`CTRL`+ `SHIFT`+`ENTER`而不是通常`ENTER`。

一些解释：

1.  `CHAR(ROW(INDIRECT(...)))`字母范围 af 是使用范围边缘的字符代码生成的，使用结构转换回字符数组。
2.  然后“噩梦”来帮忙，最后总结获得的替换与原始字符串减法的数量。
3.  因此，在这种双重转换的情况下，您不需要代码表）））

还有两个类似的“坚果”样本——仅用于学习目的。

如果您需要汇总所有**数字匹配项**- 您仍然可以使用 0 和 9 作为输入（数字是从 0 开始的 48 到 57 个代码的字符）。但是，以下更简单的解决方案也将适用：

```
=SUM(LEN($A2)-LEN(SUBSTITUTE($A2,ROW($1:$10)-1,""))) 
```

这里的技巧是我们可以使用数组或行号 1-10**减去**1 生成数字 0-9 -`ROW(0)`会产生错误。

最后，如果您需要计算字符串**中所有数字的总和**- 使用这个：

```
=SUM(IFERROR(VALUE(MID($A2,ROW(INDIRECT("1:"&LEN($A2))),1)),0)) 
```

`MID`在这里，我们使用每个字符将初始字符串分解为字母，然后测试它是否是一个数字`IFERROR`，并使用除数字以外的任何内容返回 0。

最后 2 个（显然）是你心爱的阵列坚果）））

我在我的 Excel 培训中使用上述示例进行质量检查（顺便说一句，欢迎来到 SE，同事！），从而展示了坚果破解的典型功能/方法。希望这对你也有用。然而，所有之前的答案至少值得你公平地投票，尤其是@barry 的无坚果食谱）

为方便起见，共享示例文件：[https ://www.dropbox.com/s/qo5k479oyawkrzh/SumLettersCount.xlsx](https://www.dropbox.com/s/qo5k479oyawkrzh/SumLettersCount.xlsx)

祝你测试顺利）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-05T23:02:25.537

此公式假定您的数据在 A 列中，您要查找的范围的第一个字母在 F1 中，最后一个字母在 G1 中。它需要作为数组公式输入，然后复制到数据的底部。

```
 =SUM(--(UPPER(MID(A1,ROW(INDIRECT("1:"&LEN(A1))),1))>=UPPER($F$1))*--(UPPER(MID(A1,ROW(INDIRECT("1:"&LEN(A1))),1))<=UPPER($G$1))). 
```

请注意，如果您要更改的字母范围，您需要更改单元格 F1 中的第一个字母和 G1 中的最后一个字母。

如果您确定任何字符串中的字符数不会超过某个最大数，例如 50，那么公式可以简化为：

```
 =SUM(--(UPPER(MID(A1,ROW($1:$50),1))>=$F$1)*--(UPPER(MID(A1,ROW($1:$50),1))<=$G$1)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:39:52.477

假设您的数据在 A 列中，请尝试以下公式：

```
=SUM(--NOT(ISERROR(SEARCH(MID(A1,ROW($1:$99),1),"abcdef"))))-99+LEN(A1) 
```

将公式输入为数组公式，即按`Ctrl`- `Shift`- `Enter`。

# sql - 如何检查查询是否使用索引

> ID：14718202
> 
> 赞同：7
> 
> 时间：2013-02-05T22:27:34.140
> 
> 标签：sql, sql-server, database, database-design

我正在使用 SQL Server，但没有足够的数据集来测试查询的性能。

我想分析查询并查看索引是否被利用。我该如何检查

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T23:32:40.373

这实际上比看起来更难——一个典型的现代 DBMS（MS SQL Server 也不例外）有时会进行全表扫描，即使索引可用，仅仅是因为在少量数据上可能会更快。¹

例子：

*   [这个 SQL Fiddle 示例中的最后一条语句](http://sqlfiddle.com/#!6/0a1d3/1/2)可以通过索引来满足，但查询计划清楚地表明了表扫描：

    ![在此处输入图像描述](../Images/02d5813cc90f7c9a3ee83c515fd68493.png)

*   但是如果我们[插入一些数据](http://sqlfiddle.com/#!6/78629/2/2)，就会使用索引：

    ![在此处输入图像描述](../Images/6041f0d366d6cf7008f46252783722ab.png)

更重要的是，DBMS 做出的决定可能会受到[统计数据](http://www.sqlservercentral.com/blogs/aschenbrenner/2012/02/29/statistics-enhancements-in-sql-server-2012/)的新鲜/准确程度的影响。

是否使用索引的最可靠测试是简单地用具有**代表性的数据量**填充您的数据库，*然后*查看[执行计划](http://msdn.microsoft.com/en-us/library/ms178071%28v=sql.105%29.aspx)。并且不要忘记计时查询的实际执行时间！

* * *

*¹一个简化的示例：如果整个表适合单个数据库页面，则简单地加载该页面并按顺序浏览它比等待包含索引的页面的额外 I/O 更快。*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T22:31:43.460

在 SQL Management Studio 中，只需键入查询，然后按 Control-L（显示查询执行计划）。在那里，您将能够看到是否正在使用任何索引。“表扫描”意味着不使用索引。“索引扫描”意味着使用了索引。

# r - 删除 r 列中的特定字符

> ID：14718203
> 
> 赞同：9
> 
> 时间：2013-02-05T22:27:39.080
> 
> 标签：r, strsplit

我有一个名为 LOAN 的表，其中包含名为 RATE 的列，其中观察值以百分比形式给出，例如 14.49% 我如何格式化该表以便编辑 rate 中的所有值并从条目中删除 % 以便我可以使用绘图功能就可以了。我尝试使用strsplit。

```
strsplit(LOAN$RATE,"%") 
```

但得到错误非字符参数

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T22:32:04.463

打印时看起来是字符但 R 认为不是这样的项目通常是因子类对象。我还猜测您不会对 strsplit 将返回的列表输出感到满意。尝试：

```
gsub( "%", "", as.character(LOAN$RATE) n) 
```

出现数字的因素也可能是混淆的根源：

```
> factor("14.9%")
[1] 14.9%
Levels: 14.9%
> as.character(factor("14.9%"))
[1] "14.9%"
> gsub("%", "", as.character(factor("14.9%")) )
[1] "14.9" 
```

这尤其令人困惑，因为 print.data.frame 删除了引号：

```
> data.frame(z=factor("14.9%"), zz=factor(14.9))
      z   zz
1 14.9% 14.9 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-07-10T09:41:01.190

这可以使用包中的`mutate`动词来实现`tidyverse`。在我看来，这更具可读性。因此，为了举例说明这一点，我创建了一个名为的数据集`LOAN`，重点关注`RATE`上述问题。

```
library(tidyverse)
LOAN <- data.frame("SN" = 1:4, "Age" = c(21,47,68,33), 
                   "Name" = c("John", "Dora", "Ali", "Marvin"),
                   "RATE" = c('16%', "24.5%", "27.81%", "22.11%"), 
                   stringsAsFactors = FALSE)
head(LOAN)
  SN Age   Name   RATE
1  1  21   John    16%
2  2  47   Dora  24.5%
3  3  68    Ali 27.81%
4  4  33 Marvin 22.11% 
```

在接下来的内容中，`mutate`允许更改列内容，`gsub`进行所需的替换（`%`with `""`）`as.numeric()`并将`RATE`列转换为`numeric`值，从而保持数据清理流程的可遵循性。

```
LOAN <- LOAN %>% mutate(RATE = as.numeric(gsub("%", "", RATE)))
head(LOAN)
  SN Age   Name  RATE
1  1  21   John 16.00
2  2  47   Dora 24.50
3  3  68    Ali 27.81
4  4  33 Marvin 22.11 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-21T19:10:37.330

尝试：

```
LOAN$RATE <- sapply(LOAN$RATE, function(x), gsub("%", "",  x)) 
```

# html - css3 向左滑动过渡

> ID：14718204
> 
> 赞同：1
> 
> 时间：2013-02-05T22:27:44.653
> 
> 标签：html, css, transition

我正在开发一个 html5 和 css3 网站，但我陷入了滑动过渡。 [在这里，您可以查看当前示例](http://clubpenguin25.com/html5/)，当您单击右箭头时，它会向右滑动，我正在尝试使其滑动到底部，返回箭头也应该滑动到顶部。从我在“bg”类的代码中看到的：

```
-moz-transition: left 1.5s ease-in-out;
-webkit-transition: left 1.5s ease-in-out;
transition: left 1.5s ease-in-out; 
```

如果我将其更改为底部，则会产生奇怪的效果。我知道我错过了一些很容易的事情，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:44:12.050

```
#test       {            
            -webkit-transition-property: top, bottom;
            -webkit-transition-duration: 0.5s;
            }

#test:hover {
            top:100px;
            bottom:100px;
            } 
```

测试为悬停添加它。您希望它移动多少像素。

# java - 是否可以将字符串内容用作绘画的图像修饰符？

> ID：14718205
> 
> 赞同：2
> 
> 时间：2013-02-05T22:27:51.690
> 
> 标签：java, string, image, graphics, paint

我目前正在 Eclipse 中开发一个小型 Java 游戏，并且已经深入研究了几千行代码。现在，我正在专门尝试使用字符串的内容来绘制图像，并且想知道这是否可能。如果是这样，它将为每个图像节省至少几百行单独的变量。

由于篇幅太长，粘贴整个程序很可能会适得其反，所以我只会展示我正在尝试的内容。

我正在尝试做的事情：

```
ImageIcon ladder = new ImageIcon (getClass ().getResource ("ladder.png"));
floorContents [currentX] [currentY] = "ladder";

public void paint (Graphics g)
{
     if (floorContents [currentX] [currentY] != "none") // painting item where standing
     {
         floorContents[currentX][currentY].paintIcon (this, g, 0, 0);
     }
} 
```

本质上，我试图让程序看到这一行：

```
floorContents[currentX][currentY].paintIcon (this, g, 0, 0); 
```

像这样：

```
ladder.paintIcon (this, g, 0, 0); 
```

如果可能的话。这将使我不必分别写入每个图像项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:35:53.507

将每个图像放在一个[`Map`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)由字符串键入的键中

```
imageMap.put("ladder", new ImageIcon (getClass ().getResource ("ladder.png")));

//...

imageMap.get(floorContents [currentX] [currentY]).paintIcon (this, g, 0, 0); 
```

当然，你应该先key看map是否包含key，或者返回的值是否为null……

```
if (imageMap.containsKey(floorContents [currentX] [currentY]) {
    //....
} 
```

的

```
ImageIcon image = imageMap.get(floorContents [currentX] [currentY]);
if (image != null) {
    //...
} 
```

但这取决于你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:40:37.950

```
 if (floorContents [currentX] [currentY] != "none") 
```

应该更像：

```
 if (!floorContents [currentX] [currentY].equals("none")) 
```

有关详细信息，请参阅[Java 中的字符串比较](https://stackoverflow.com/questions/5286310/string-comparison-in-java)（以及[大约 500 多个](https://stackoverflow.com/search?q=[string]+[java]+comparison)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:45:07.893

我会完全停止使用字符串。`null`如果我见过，“无”就是代码气味。为什么甚至完全匹配`String`。

```
ImageIcon[][] floorContents;
ImageIcon ladder = new ImageIcon (getClass ().getResource ("ladder.png"));
floorContents[currentX][currentY] = ladder;

public void paint (Graphics g) {
   if (floorContents [currentX] [currentY] != null) {
      floorContents[currentX][currentY].paintIcon (this, g, 0, 0);
   }
} 
```

# c - 未初始化时检查指针是否为空

> ID：14718212
> 
> 赞同：2
> 
> 时间：2013-02-05T22:28:21.030
> 
> 标签：c

如果变量未初始化，假设 if 语句将始终有效是否安全？假设是肯定的，但有人告诉我，变量中的随机垃圾位并不总是意味着检查是否为 null 将起作用。

```
Void afunction () {
    char* someStr;
    if (someStr) 
    {
        // do something
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T22:31:00.047

> 如果变量未初始化，假设 if 语句将始终有效是否安全？

不会。读取未初始化的存储会调用未定义的行为。您不能对此代码做出安全的假设。

不要这样做！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T22:31:09.743

这绝对不能保证总是有效。你必须自己初始化它。

```
char* someStr = NULL; 
```

或其他一些价值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T22:34:12.320

未初始化的变量是不确定的。在赋值之前读取它们会导致未定义的行为。

检查指针是否是很容易的`NULL`：

```
if (someStr) {
   // Don't use it (or do for some weird reason)
} 
```

为了安全起见并确保指针是您想要的值，我会在初始化时为其分配一个值。

```
char* someStr = NULL; 
```

您还可以将指针设为静态以避免未定义的行为。

```
static char* someStr; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T22:31:29.843

的值`someStr`未定义。一般来说，它将被设置为堆栈中的某个旧值。因此，它很可能是 NULL（即 0）。

# clearcase - 未选择目录元素版本

> ID：14718216
> 
> 赞同：2
> 
> 时间：2013-02-05T22:28:31.483
> 
> 标签：clearcase

我有以下配置规范：

```
element * CHECKEDOUT
element /cl5_sw_ste/DCT/... /main/rel_drop5/int_drop5/cl5_p65719_AUTE/LATEST
element /cl5_sw_ste/DCT/... /main/rel_drop5/int_drop5/LATEST                 -mkbranch cl5_p65719_AUTE
element /cl5_sw_ste/DCT/... /main/rel_drop5/LATEST                           -mkbranch int_drop5
element /cl5_sw_ste/DCT/... /main/0                                          -mkbranch rel_drop5
element * /main/0 
```

这个配置规范不允许我看到一个名为 DCT 的目录元素，它位于 VOB cl5_sw_ste 的根目录中。DCT 具有以下版本树：

```
cl5_sw_ste/DCT@@\main
cl5_sw_ste/DCT@@\main\0
cl5_sw_ste/DCT@@\main\rel_drop5
cl5_sw_ste/DCT@@\main\rel_drop5\0
cl5_sw_ste/DCT@@\main\rel_drop5\int_drop5
cl5_sw_ste/DCT@@\main\rel_drop5\int_drop5\0
cl5_sw_ste/DCT@@\main\rel_drop5\int_drop5\cl5_p65719_AUTE
cl5_sw_ste/DCT@@\main\rel_drop5\int_drop5\cl5_p65719_AUTE\0
cl5_sw_ste/DCT@@\main\rel_drop5\int_drop5\cl5_p65719_AUTE\1 
```

我会认为配置规范规则：

```
element /cl5_sw_ste/DCT/... /main/rel_drop5/int_drop5/cl5_p65719_AUTE/LATEST 
```

会选择：

```
cl5_sw_ste/DCT@@\main\rel_drop5\int_drop5\cl5_p65719_AUTE\1 
```

但是，没有选择任何版本。我究竟做错了什么？

谢谢，戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:36:47.103

您需要检查选择了 DCT*父*目录的哪个版本，即 vob `cl5_sw_ste`。

如果是`/main/0`，那么这是正常的：这是一个不包含子元素**[的占位符。](https://stackoverflow.com/questions/5309333/why-i-only-get-a-clearcase-version-0/5309714#5309714)**
这意味着不会选择vob下的任何内容`cl5_sw_ste`，也不可见。

您的最后一条规则应该是：

```
 element * /main/LATEST 
```

这将允许选择至少应包含目录`/main/1`的 vob 。 这就是为什么我在您之前的问题“ [Can't Create Directory Element With Multi-Branching in Base ClearCase](https://stackoverflow.com/a/14715198/6309) ”中提到了这个停止规则。`cl5_sw_ste``DCT`

# apache - 避免使用动态 URL 的重复内容

> ID：14718220
> 
> 赞同：0
> 
> 时间：2013-02-05T22:29:11.310
> 
> 标签：apache, mod-rewrite, sitemap

所以我使用 mod_rewrite 并每天为我的页面（待售产品）制作站点地图。Google 会读取 URL 并将其编入索引。但是，如果我更改项目的标题，则站点地图中的 url 将被更改和更新，因此搜索引擎将索引重复的内容，并具有更新的标题。例如：

example.com/green-dress/54325

（域/标题/ID）

如果我决定更新标题，例如 example.com/green-dress-with-small-rip/54325

如您所见，它最后具有相同的项目 ID。它是同一个项目，除了现在有更新。但是谷歌，不像我，不知道它应该更新项目，因为它显然不知道 url 的最后一部分是项目 ID。

所以问题是......我应该如何解决这个问题？一种方法是不进行 mod-rewrite，但如果可能的话，我宁愿避免这种情况。

谢谢，戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:37:35.240

第一种可能性是存储旧 URI 并执行`301 Moved Permanently`重定向到新 URI。但是我们在项目中所做的是将地址中的标题与控制器中的实际标题进行比较，如果不匹配，则将 301 重定向到具有正确标题的地址。一段时间后，Google 将不再扫描旧页面。我认为我们的解决方案更通用

# regex - 将单词与前导空格匹配

> ID：14718221
> 
> 赞同：4
> 
> 时间：2013-02-05T22:29:20.573
> 
> 标签：regex, perl

我在数组中有以下字符串`@stat`：

```
 r>  10.12.44.0/24                             
  r>  10.11.48.0/24                               
  *>  10.15.49.0/24                              
  r>  10.16.53.0/24                               
  r>  10.14.59.0/24                              
  *>  10.18.63.0/24 
```

我想匹配有“ `*>`”的那个。请注意，在`*`. 我尝试使用以下方法，但没有奏效。

```
foreach (@stat) {
    if (/^\s\*\>/) { 
    # do something
    }
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:35:02.837

`\s`匹配一个空白字符。您发布的内容实际上有两个前导空格。以下应该可以解决问题：

```
foreach (@stat) {
    if (/^\s*\*>/) { 
        # do something
    }
} 
```

如果没有，请更仔细地检查阵列中的实际内容。

```
use Data::Dumper qw( Dumper );

{
    local $Data::Dumper::Useqq = 1;
    print(Dumper(\@stat));
} 
```

# javascript - 带有自定义投影的传单 maxBounds

> ID：14718223
> 
> 赞同：0
> 
> 时间：2013-02-05T22:29:22.770
> 
> 标签：javascript, leaflet

我制作了简单的传单[示例](http://jsfiddle.net/cMjZa/2/)。它渲染程序图块，每个图块都显示位置和缩放。投影和 CRS 被配置为将 lat 和 lng 直接映射到 x 和 y，而不需要在 zoom=20 时进行任何转换。您可以通过单击地图并查看带有坐标的弹出窗口来轻松检查这一点。

```
var naturalZoom = 20;

L.Projection.Direct = {
    project: function (latlng) {
        return new L.Point(latlng.lat, -latlng.lng);
    },

    unproject: function (point) {
        return new L.LatLng(point.x, -point.y);
    }
};

L.CRS.Wall = L.extend({}, L.CRS, {
    projection: L.Projection.Direct,
    transformation: new L.Transformation(1, 0, -1, 0),

    scale: function (zoom) {
        return Math.pow(2, zoom-naturalZoom);
    }
});

var map = L.map('map', {
    crs: L.CRS.Wall,
    maxBounds: new L.LatLngBounds([0,0], [4096, 4096])
});
map.setView([0,0], naturalZoom); 
```

我试图限制地图的边界（取消注释 jsfiddle 示例中代码的第 26 行），但这会破坏整个图层的拖动。有没有人对自定义 crs 和 maxBounds 有类似的问题？这可能是传单库中的错误吗？

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T04:39:56.687

我认为问题是你`project/unproject`的坏了？无论如何，您不必手动执行任何操作，Leaflet.js 提供了一个 CRS 来在 px 和 latlng 之间进行转换，像这样设置您的地图：

```
var map = L.map('map', {
  maxZoom: 20,
  minZoom: 20,
  crs: L.CRS.Simple
}).setView([0, 0], 20); 
```

然后设置地图边界（我的图像是 1024x6145）：

```
var southWest = map.unproject([0, 6145], map.getMaxZoom());
var northEast = map.unproject([1024, 0], map.getMaxZoom());
map.setMaxBounds(new L.LatLngBounds(southWest, northEast)); 
```

然后，您可以通过以下方式添加标记：

```
var m = {
  x: 102, // px coordinates on full sized image
  y: 404
}
var marker = L.marker(map.unproject([m.x, m.y], map.getMaxZoom())).addTo(map); 
```

请注意，我们使用`map.unproject`的是从 px 到 latlng。

我更详细地写[了如何执行此操作，包括如何拆分图像](http://omarriott.com/aux/leaflet-js-non-geographical-imagery/)，但以上内容为您提供了基本要点。

# mysql - 在mysql查询中提取字符串之前的第一个数字

> ID：14718226
> 
> 赞同：0
> 
> 时间：2013-02-05T22:30:12.497
> 
> 标签：mysql, substring, rights

我有一个像这样的图像文件名：

```
5110b99ba85c72_t.jpg 
```

`_t`我想在字符串或以 .`_m`开头的内容之前提取第一个数字`_`。在这种情况下，它是数字 2。

我找到了 2 个工作正常的解决方案，但不确定哪个更好，两种方法的优缺点......

专家们怎么看？

方法一

```
SELECT SUBSTRING(SUBSTRING_INDEX(thumb_filename, '_', 1), -1) FROM image 
```

方法二

```
SELECT RIGHT(SUBSTRING_INDEX(thumb_filename, '_', 1), 1) FROM image 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:28:50.617

我相当确定两者在性能方面不会有太大差异。

也就是说，我可能会使用 RIGHT() 函数，因为它更清楚你到底想要做什么。

但是，如果您担心性能，我会添加一个具有该值的列，并在文件更改时使其保持最新。生成/更新行时获得数字一次的速度要快得多，然后不必在查询中执行 SUBSTRING 函数。

# haskell - 指称语义映射是可判定的吗？

> ID：14718228
> 
> 赞同：12
> 
> 时间：2013-02-05T22:30:26.023
> 
> 标签：haskell, formal-semantics

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T00:09:31.033

There are no set theoretic models of turing complete languages. If your language is strongly normalizing, there exits a total function to "interpret it" to something. You may or may not have set theoretic semantics in a non-turing complete language. Regardless, turing complete, and non-turing complete, languages can have non set theoretic semantics with total semantic mapping functions.

I don't think that is the issue here.

There is a difference between inductive and co-inductive definitions. We can explore this set theoretically:

The inductive definition of a list of integers reads:

> the set `[Z]` is the **smallest** set `S` such that the empty list is in `S` , and such that for any `ls` in `S` and `n` in `Z` the pair `(n,ls)` in `S`.

This can also be presented in a "step indexed" way as `[Z](0) = {[]}` and `[Z](n) = {(n,ls) | n \in Z, ls \in [Z](n-1)}` which lets you define `[Z] = \Union_{i \in N}([Z](n)` (if you believe in natural numbers!)

On the other hand, "lists" in Haskell are more closely related to "coinductive streams" which are defined coinductively

> the set `[Z]` (coinductive) is the **largest** set `S` such that forall `x` in `S`, `x = []` or `x = (n,ls)` with `n` in `Z` and `ls` in `S`.

That is, coinductive defintions are backwards. While inductive definations define the smallest set containing some elements, coinductive definations define the largest set where all elements take a certain form.

It is easy to show that all inductive lists have finite length, while some coinductive lists are infinitely long. Your example requires coinduction.

More generally, inductive definitions can be though of as the "least fix-point of a functor" while coinductive definitions can be thought of as "the greatest fix-point of a functor". The "least fix point" of a functor being just its "initial algebra" while the "greatest fixpoint" is its "final coalgebra". Using this as your semantic tools makes it easier to define things in categories other than the category of sets.

I find that Haskell provides a good language for describing these functors

```
data ListGenerator a r = Cons a r | Nil

instance Functor (ListGenerator a) where
  fmap f (Cons a x) = Cons a (f x)
  fmap _ Nil        = Nil 
```

although haskell provides a good language for describing these functors, because its function space is CBN and the language is not total, we have no way of defining the kind of least fix point we would like :(, although we do get the definition of the greatest fixpoint

```
data GF f = GF (f (GF f)) 
```

or the non recursive existentially quantified

```
data GF f = forall r. GF r (r -> (f r)) 
```

if we were working in a strict or total language, the least fixpoint would be the universally quantified

```
data LF f = LF (forall r. (f r -> r) -> r) 
```

EDIT: since "smallest" is a set theoretic notion though the "least"/"greatest" distinction might not be the right one. The definition of `LF` is basically isomorphic to `GF` and is "the free initial algebra" which is the categorical formalism of "least fix point."

as to

> how can I convince you that it's not some finite number of "1-and-tuples" and then a non-productive ⊥?

you can't unless I believe in the kind of constructions in this post. If I do, then your definition leaves me stuck!. If you say "`ones` is the coinductive stream consisting of the pair `(1,ones)`" then I have to believe! I know `ones` is not `_|_` by definition, and thus by induction I can show that it can't be the case that for any value `n` I have `n` ones and then bottom. I can try to deny your claim only be denying the existence of coinductive steams.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T04:44:56.383

For more on proof techniques over coinductive structures (expanding on Philip JF's very nice answer), you can take a look at Hinze and James' "Proving the Unique Fixed-Point Principle Correct": [http://www.cs.ox.ac.uk/people/daniel.james/unique/unique-tech.pdf](http://www.cs.ox.ac.uk/people/daniel.james/unique/unique-tech.pdf)

# php - 使用 PHP 在不同表中搜索项目

> ID：14718229
> 
> 赞同：0
> 
> 时间：2013-02-05T22:30:26.207
> 
> 标签：php, html, mysql, sql

我想知道如何创建一个 PHP 搜索表单来在三个表中执行搜索功能：电话、制造商和操作系统。用户将搜索价格，即键入“350”将搜索**手机**表中的“价格”字段并显示价值 350 的所有项目，或者搜索“Android”将搜索**操作系统**表并显示所有运行 Android 的手机。

但是，**操作系统**表有一个称为 OSID 的主键，而**电话**表有一个引用 OSID 的外键。**当电话**表包含 ID 而不是操作系统的名称时，我将如何让它基于对 Android 的搜索来提取结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:14:28.293

那么创建第四个表来索引所有其他表的内容呢？

您可以将此表设置为具有主键（自动递增）、第二个字段（0，表 1；1，表 2；2，表 3）和第三个字段，其外键引用指定的表。然后最后一个字段将包含一个单词。

可以将搜索查询拆分为单词并针对该第四个表进行查询。

然后 SELECT 和 JOIN 在 3 个原始表中寻找它们的匹配项......

然后在前端，您可以添加一些 css 类以允许用户快速过滤（jquery）并仅保留某种类型的结果，以便您（实际上是她）删除误报，同时仍允许用户更改她头脑。

祝你好运，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:05:28.080

希望我理解得很好...

您有一个表：`phone`，它具有来自表的引用的 ID `operating_system`，并且与 相同`manufacturer`，因此，例如，我在操作系统的表条目中像

操作系统

1.  三星
2.  诺基亚
3.  IPhone

和制造商

1.  苹果电脑
2.  诺基亚

所以，在我的桌面电话里，我有类似的东西

ID/名称/操作系统/制造商/价格

1/三星galaxy/android/三星/300usd

所以，如果你想显示搜索 350 美元以下手机的所有详细信息，你需要做这样的事情

```
select * from operating_system, manufacturer, phones
where phones.operating_system = operating_system.id
and manufacturer.id = phone.manufacturer
and phone.price < 350 
```

然后显示结果..

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T22:54:43.883

对于不同的数据，您可以有不同的表单输入。这样，您将知道将哪些数据插入 SQL 查询的哪个部分。

不过，重新发明轮子并不是 2013 年开发人员通常推荐的活动。你可以使用已经存在的东西，比如[Sphider](http://www.sphider.eu/)。我敢肯定，有很多替代方案，但这是一个开始......

不过有几点建议：

*   永远不要相信用户。这包括他在搜索框中输入的内容。总是逃避它，以保护自己免受 SQL 注入。
*   如果您打算使用 Javascript 进行客户端验证，那么也可以在服务器端进行。任何人都可以在他们的浏览器中禁用他们的 Javascript...

# java - 我可以限制另一个类可以在 Java 中调用的方法吗？

> ID：14718231
> 
> 赞同：19
> 
> 时间：2013-02-05T22:30:35.070
> 
> 标签：java, interface

假设我有 classes `A`, `B`, 并且`C`class`C`具有可读和可写属性：

```
public class C {
    private int i = 0;

    // Writable.
    public void increment() { i++; }

    // Readable.
    public int getScore() { return i; }
} 
```

是否可以只让`A`使用`increment()`方法，只让`B`使用`getScore()`方法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-05T22:33:21.807

### 不，不可能分配每个班级的访问权限。

考虑将您的类分成单独的接口，以便每个类仅获取具有所需接口的对象。例如：

```
interface Incrementable { public void increment(); }
interface HasScore { public int getScore(); }
class C implements Incrementable, HasScore { /* ... */ }

class A {
  public A(Incrementable incr) { /* ... */ }
}

class B {
  public B(HasScore hs) { /* ... */ }
} 
```

当然，存在安全隐患，但这应该让您朝着正确的方向思考。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T22:34:40.553

是的，但你必须经历一些回旋。

```
public interface Incrementable {
    public void increment();
}

public interface Readable {
    public int getScore();
}

public class C implements Incrementable, Readable
{
    ...
} 
```

现在，当您在 A 中定义接收对`B`实例的引用的方法时，请定义该方法以`Incrementable`取而代之。对于`B`，将其定义为`Readable`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-05T22:33:17.250

Java 有 4 个作用域：私有、受保护、公共和“包”。可以从任何地方访问公共的东西。仅受子类保护。private 只是那个类。“包”范围未命名，但如果省略其他三个中的任何一个，则假定为包范围。这只能由同一包中的其他类访问。

HTH。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-05T22:32:25.657

不，这是不可能的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-06T00:11:25.913

不是你想要的，但你可以去堆栈跟踪（创建一个异常）并检查调用你的增量方法的类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T22:38:31.060

尽管直接的答案是否定的，但另一种解决方法（丑陋的）可能是创建两个扩展第三个接口（或者您可以只将对象作为参数）：Reader 和 Writer，将调用类作为参数传递给每个函数：

```
public interface Caller;
public interface Reader extends Caller;
public interface Writer extends Caller;

public void increment(Caller c) { 
     if (c instanceof Writer) {
         i++;
     } 
} 
```

# asp.net - 页面中只能添加一个 ScriptManager 实例

> ID：14718232
> 
> 赞同：0
> 
> 时间：2013-02-05T22:30:39.140
> 
> 标签：asp.net, scriptmanager, toolkitscriptmanager

我收到一个奇怪的错误：

> 只能将 ScriptManager 的一个实例添加到页面中。

当我最初发现这个错误时，我注意到我的一个页面中有一个“ScriptManager”标签，而同一页面的母版页中有一个 ajax:ToolScriptManager。所以我用服务器注释（<% %>）注释掉了“ScriptManager”标签并上传到了现场。仍然得到错误。我尝试完全删除该行，但仍然出现错误。

有趣的是，在没有调试模式的情况下运行的本地副本上不会发生错误。

有什么线索吗？我很确定我使用的是 ASP.NET 3.5，它是一个网络应用程序而不是一个网站。在更改生效之前我需要编译或其他东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T21:52:21.177

问题是我正在上传到一个代码库并在不同的代码库（在不同的服务器上）上进行测试。所以我所做的改变没有任何效果。哎呀！

# haskell - Haskell 中的日志记录模式

> ID：14718236
> 
> 赞同：3
> 
> 时间：2013-02-05T22:30:52.197
> 
> 标签：haskell

我正在编写一些代码来登录 Haskell。在命令式语言中，我会（已经）写过类似的东西：

```
log = new Logger();
log.registerEndpoint(new ConsoleEndpoint(settings));
log.registerEndpoint(new FileEndpoint(...));
log.registerEndpoint(new ScribeEndpoint(...));
...
log.warn("beware!")
log.info("hello world"); 
```

甚至可能制作`log`一个全局静态，所以我不必传递它。实际的端点和设置可能会在启动时从配置文件中配置，例如。一种用于生产，一种用于开发。

在 Haskell 中做这样的事情有什么好的模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T23:34:06.147

该`pipes`包允许您将数据生成与数据消费分开。您将程序编写为 log`String`的生产者，然后在运行时选择如何使用这些`String`s。

例如，假设您有以下简单程序：

```
import Control.Proxy

program :: (Proxy p) => () -> Producer p String IO r
program () = runIdentityP $ forever $ do
    lift $ putStrLn "Enter a string:"
    str <- lift getLine
    respond $ "User entered: " ++ str 
```

该类型表示它是一个`Producer`of `String`s（在本例中为日志字符串），它也可以`IO`使用`lift`. `IO`因此，对于不涉及日志记录的普通命令，您只需使用`lift`. 每当您需要记录某些内容时，您都可以使用该`respond`命令，该命令会生成一个`String`.

这会创建一个抽象的字符串生产者，它没有指定如何使用它们。这让我们可以推迟选择如何使用生成`String`的 s。每当我们调用该`respond`命令时，我们都会抽象地将我们的日志字符串交给一些尚未指定的下游阶段，该阶段将为我们处理它。

现在让我们编写一个程序，该程序`Bool`从命令行获取一个标志，该标志指定是否将输出写入`stdout`或写入文件`"my.log"`。

```
import System.IO
import Options.Applicative

options :: Parser Bool
options = switch (long "file")

main = do
    useFile <- execParser $ info (helper <*> options) fullDesc
    if useFile
        then do
            withFile "my.log" WriteMode $ \h ->
                runProxy $ program >-> hPutStrLnD h
        else runProxy $ program >-> putStrLnD 
```

如果用户在命令行中没有提供任何标志，则`useFile`默认为`False`，表示我们要登录到`stdout`。如果用户提供`--file`标志，则`useFile`默认为`True`，表示我们要登录到`"my.log"`。

现在，检查两个`if`分支。第一个分支使用运算符`String`将​​生成的 s馈送`program`到文件中`(>->)`。可以将其视为接受 a并创建 s 的抽象消费者的`hPutStrLnD`东西，该消费者将每个字符串写入该句柄。当我们连接到时，我们将每个日志字符串发送到文件：`Handle``String``program``hPutStrLnD`

```
$ ./log
Enter a string:
Test<Enter>
User entered: Test
Enter a string:
Apple<Enter>
User entered: Apple
^C
$ 
```

第二个`if`分支将`String`s 馈送到`putStrLnD`，它只是将它们写入`stdout`：

```
$ ./log --file
Enter a string:
Test<Enter>
Enter a string:
Apple<Enter>
^C
$ cat my.log
User entered: Test
User entered: Apple
$ 
```

尽管从生产中解耦生成，`pipes`仍然立即流式传输所有内容，因此输出阶段（即`hPutStrLnD`和`putStrLnD`）将在生成后立即写出，`Strings`并且不会缓冲`String`s 或等待程序完成。

请注意，通过将生成与实际日志记录操作分离，我们获得了在最后时刻`String`注入消费者依赖项的能力。`String`

要了解有关如何使用[的](http://hackage.haskell.org/packages/archive/pipes/3.1.0/doc/html/Control-Proxy-Tutorial.html)`pipes`更多信息，我建议您阅读[教程](http://hackage.haskell.org/packages/archive/pipes/3.1.0/doc/html/Control-Proxy-Tutorial.html)。[`pipes`](http://hackage.haskell.org/packages/archive/pipes/3.1.0/doc/html/Control-Proxy-Tutorial.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T22:43:30.607

如果您只有一组固定的端点，这是一种可能的设计：

```
data Logger = Logger [LoggingEndpoint]
data LoggingEndpoint = ConsoleEndpoint ... | FileEndpoint ... | ScribeEndpoint ... | ... 
```

那么实现这个应该很简单：

```
logWarn :: Logger -> String -> IO ()
logWarn (Logger endpoints) message = forM_ logToEndpoint endpoints
  where
    logToEndpoint :: LoggingEndpoint -> IO ()
    logToEndpoint (ConsoleEndpoint ...) = ...
    logToEndpoint (FileEndpoint ...) = ... 
```

如果您想要可扩展的端点集，有一些方法可以做到，其中最简单的方法是定义`LoggingEndpoint`为函数记录，基本上是一个 vtable：

```
data LoggingEndpoint = LoggingEndpoint { 
    logMessage :: String -> IO (),
    ... other methods as needed ...
}

consoleEndpoint :: Settings -> LoggingEndpoint
consoleEndpoint (...) = LoggingEndpoint { 
    logMessage = \message -> ...
    ... etc ...
} 
```

然后，`logToEndpoint`简单地变成

```
logToEndpoint ep = logMessage ep message 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T22:42:59.913

在 Real World Haskell 中，他们描述了如何使用 Writer monad 来做到这一点，比我能解释的要好得多：http: [//book.realworldhaskell.org/read/programming-with-monads.html#id649416](http://book.realworldhaskell.org/read/programming-with-monads.html#id649416)

另请参阅有关 monad 转换器的章节：http: [//book.realworldhaskell.org/read/monad-transformers.html](http://book.realworldhaskell.org/read/monad-transformers.html)

# sql - sql 正则表达式解析文本以添加新行

> ID：14718239
> 
> 赞同：0
> 
> 时间：2013-02-05T22:31:19.503
> 
> 标签：sql, regex, oracle

我正在尝试使用一个只是一大块文本的注释字段，示例数据如下，就好像我将它插入到表格中一样。

```
create table test_table
(
job_number number,
notes varchar2(4000)
)

insert into test_table (job_number,notes)
values (12345,1022089483 notes notes notes notes 1022094450 notes notes notes notes 1022095218 notes notes notes notes) 
```

我需要将其解析出来，以便每个注释条目都有单独的记录（注释前的 10 位数字是 unix 时间戳）。所以如果我要导出到管道分隔它看起来像这样：

> 工作编号|注释
> 
> 12345|1022089483 注释 注释 注释 注释
> 
> 12345|1022094450 注释 注释 注释 注释
> 
> 12345|1022095218 备注 备注 备注

我真的希望这是有道理的。我很欣赏任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:50:19.310

这样做的几种方法：

```
SQL> insert into test_table (job_number,notes)
  2  values (12345,'1022089483 notes notes notes notes 1022094450 notes notes notes notes 1022095218 notes notes notes notes');

1 row created.

SQL> insert into test_table (job_number,notes)
  2  values (12346,'1022089483 notes notes notes notes 1022094450 foo 1022095218 test notes 1022493228 the answer is 42');

1 row created.

SQL> commit;

Commit complete. 
```

注意：我使用`[0-9]{10}`正则表达式来确定注释（即任何 10 位数字都被视为注释的开头）。

首先，我们可以采用计算任何给定行中的最大音符数的方法，然后对该行数进行笛卡尔连接。然后过滤掉每个音符：

```
SQL> with data
  2  as (select job_number, notes,
  3            (length(notes)-length(regexp_replace(notes, '[0-9]{10}', null)))/10 num_of_notes
  4        from test_table t)
  5  select job_number,
  6         substr(d.notes, regexp_instr(d.notes, '[0-9]{10}', 1, rn.l),
  7                       regexp_instr(d.notes||' 0000000000', '[0-9]{10}', 1, rn.l+1)
  8                       -regexp_instr(d.notes, '[0-9]{10}', 1, rn.l) -1
  9               ) note
 10    from data d
 11         cross join (select rownum l
 12                      from dual
 13                    connect by level <= (select max(num_of_notes)
 14                                           from data)) rn
 15   where rn.l <= d.num_of_notes
 16   order by job_number, rn.l;

JOB_NUMBER NOTE
---------- --------------------------------------------------
     12345 1022089483 notes notes notes notes
     12345 1022094450 notes notes notes notes
     12345 1022095218 notes notes notes notes
     12346 1022089483 notes notes notes notes
     12346 1022094450 foo
     12346 1022095218 test notes
     12346 1022493228 the answer is 42

7 rows selected. 
```

只要音符的数量通常相同就可以（差异越大，缩放越差，因为我们正在进行大量递归查找）。

在 11g 中，我们可以使用递归分解子查询来做与上面相同的事情，但不做额外的循环：

```
SQL> with data (job_number, notes, note, num_of_notes, iter)
  2  as (select job_number, notes,
  3             substr(notes, regexp_instr(notes, '[0-9]{10}', 1, 1),
  4                    regexp_instr(notes||' 0000000000', '[0-9]{10}', 1, 2)
  5                    -regexp_instr(notes, '[0-9]{10}', 1, 1) -1
  6                  ),
  7             (length(notes)-length(regexp_replace(notes, '[0-9]{10}', null)))/10 num_of_notes,
  8             1
  9        from test_table
 10      union all
 11     select job_number, notes,
 12             substr(notes, regexp_instr(notes, '[0-9]{10}', 1, iter+1),
 13                    regexp_instr(notes||' 0000000000', '[0-9]{10}', 1, iter+2)
 14                    -regexp_instr(notes, '[0-9]{10}', 1, iter+1) -1
 15                  ),
 16             num_of_notes, iter + 1
 17       from data
 18      where substr(notes, regexp_instr(notes, '[0-9]{10}', 1, iter+1),
 19                    regexp_instr(notes||' 0000000000', '[0-9]{10}', 1, iter+2)
 20                    -regexp_instr(notes, '[0-9]{10}', 1, iter+1) -1
 21                  ) is not null
 22    )
 23  select job_number, note
 24    from data
 25  order by job_number, iter;

JOB_NUMBER NOTE
---------- --------------------------------------------------
     12345 1022089483 notes notes notes notes
     12345 1022094450 notes notes notes notes
     12345 1022095218 notes notes notes notes
     12346 1022089483 notes notes notes notes
     12346 1022094450 foo
     12346 1022095218 test notes
     12346 1022493228 the answer is 42

7 rows selected. 
```

或者从 10g 开始，我们可以使用模型子句来组成行：

```
SQL> with data as (select job_number, notes,
  2                       (length(notes)-length(regexp_replace(notes, '[0-9]{10}', null)))/10 num_of_notes
  3                  from test_table)
  4  select job_number, note
  5    from data
  6  model
  7  partition by (job_number)
  8  dimension by (1 as i)
  9  measures (notes, num_of_notes, cast(null as varchar2(4000)) note)
 10  rules
 11  (
 12    note[for i from 1 to num_of_notes[1] increment 1]
 13      = substr(notes[1],
 14               regexp_instr(notes[1], '[0-9]{10}', 1, cv(i)),
 15               regexp_instr(notes[1]||' 0000000000', '[0-9]{10}', 1, cv(i)+1)
 16               -regexp_instr(notes[1], '[0-9]{10}', 1, cv(i)) -1
 17              )
 18  )
 19  order by job_number, i;

JOB_NUMBER NOTE
---------- --------------------------------------------------
     12345 1022089483 notes notes notes notes
     12345 1022094450 notes notes notes notes
     12345 1022095218 notes notes notes notes
     12346 1022089483 notes notes notes notes
     12346 1022094450 foo
     12346 1022095218 test notes
     12346 1022493228 the answer is 42 
```

# asp.net-mvc-3 - MVC、Nhibernate、castle、windsor 集成测试不写入数据库

> ID：14718241
> 
> 赞同：0
> 
> 时间：2013-02-05T22:31:27.610
> 
> 标签：asp.net-mvc-3, nhibernate, castle-windsor, integration-testing

我们正在尝试为使用 MVC、Nhibernate、castle、windsor 和 sharpArch 的 Web 应用程序编写一些集成测试。当我们逐步完成测试时，它们正确地命中了所有方法，但没有将任何数据写入数据库。我们使用的是存储库模型，并且 Nhibernate 保存。该代码在从网站运行时有效。我们没有在集成测试中使用 DI，这是 Web 应用解决方案中的一个项目。没有抛出任何错误。Nhibernate 在全局集成测试中初始化为

```
NHibernateSession.Init(WebSessionStorage,
                               new string[] { binPath },
                               null,
                               appconfigPath,
                               configuration, null, null); 
```

其中 binPath 是包含 Nhibernate 映射和类的 dll 的路径，而 appconfigPath 是网站 bin 的路径。NHibernateSession 似乎已填充。

欢迎任何想法，建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:46:38.697

验证您在测试中没有忘记事务处理（并提交它们（从而触发刷新））。

# twitter-bootstrap - Bootstrap - 响应式导航栏适用于索引页面但没有其他页面

> ID：14718245
> 
> 赞同：1
> 
> 时间：2013-02-05T22:31:40.780
> 
> 标签：twitter-bootstrap

标题中几乎说了我的问题。响应式导航适用于索引页面，但在其他页面上则不然。它仍然崩溃，但是当您单击下拉图标时没有任何反应。

我的导航代码是：

```
 <div class="navbar">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li class="navbar_link navitem1"><a href="index.html"><strong>HOME</strong></a></li>
                            <li class="divider-vertical navitem2"></li>
                            <li class="navbar_link navitem3"><a href="gallery.html"><strong>GALLERY</strong></a></li>
                            <li class="divider-vertical navitem4"></li>
                            <li class="navbar_link navitem5"><a href="aboutus.html"><strong>ABOUT US</strong></a></li>
                            <li class="divider-vertical navitem6"></li>
                            <li class="navbar_link navitem7"><a href="contact.html"><strong>CONTACT</strong></a></li>
                        </ul>
                    </div>
                </div>
            </div>
    </div> 
```

任何帮助是极大的赞赏。

# c++ - 我们如何在 C++ 中快速求解斐波那契数列？

> ID：14718254
> 
> 赞同：2
> 
> 时间：2013-02-05T22:32:15.563
> 
> 标签：c++

是否可以在少于 N 次的时间内确定某个整数是否是斐波那契数，其中 N 是第 N 个斐波那契数？我正在尝试优化解决方案，这将有很大帮助。

我也在尝试排除所有外部库（因此下面答案中的 Math.sqrt() 之类的内容不适用于我的目的）。任何其他建议都会很棒。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:35:55.487

也许你可以使用这个属性：

N 是斐波那契数当且仅当`5 N^2 + 4`或`5N^2 – 4`是平方数。

并查看[这篇文章](https://stackoverflow.com/questions/295579/fastest-way-to-determine-if-an-integers-square-root-is-an-integer)以获得平方问题的有效解决方案。

希望这可以帮助

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T22:51:59.987

将斐波那契数预先计算到某个界限，然后您可以比使用线性搜索更有效地在列表中搜索您的数字。

斐波那契数字增长得如此之快，以至于我怀疑存储它们会构成问题。我的意思是，如果您愿意保存前 100 个左右，那将涵盖 3.5e+20 之前的所有数字。

假设您存储了第一个`M`斐波那契数。那么使用二分查找的最坏情况是`log(M)`. 有计算`M`给定斐波那契数的公式`M`；您可以使用它来近似`M`给定`M`第 斐波那契数，以根据数字（`N`而不是列表大小`M`）获得界限。我认为这使它最终成为类似的东西`log(log(N))`，但你应该检查我。

# python - 使用 f2py 从 python 将动态向量分配到 fortran

> ID：14718257
> 
> 赞同：2
> 
> 时间：2013-02-05T22:32:23.680
> 
> 标签：python, fortran, f2py

我有以下由 python 调用的子程序的开始：

从 python 调用：`libomp.cic(pos,mpart,boxsize,dim,npart)`

```
subroutine cic(pos,mpart,boxsize,dim,npart,mesh)
use omp_lib
implicit none 
real*8 mpart
!f2py intent(in) :: mpart
real*8 boxsize
!f2py intent(in) :: boxsize
integer dim
!f2py intent(in) :: dim
integer*8 npart
!f2py intent(in) :: npart
real*8, dimension(0:dim-1,0:dim-1,0:dim-1) :: mesh
!f2py intent(out) :: mesh
real*8, dimension(npart,3) :: pos
!f2py intent(in) :: pos 
```

运行python脚本时出错：

```
error: (shape(pos,0)==npart) failed for 1st keyword npart: cic:npart=47099622
WARNING: Failure executing file: <test.py> 
```

出于某种原因，当我设置`npart`为整数时它可以工作，但它无法`npart`从 python 接收并动态创建数组`pos`。它适用于`mesh`使用`dim`但不适用`pos`，为什么？它与调用它们的顺序有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T12:29:52.537

`pos`被声明为`intent(in)`这意味着它应该在您进入例程时被分配。请注意，这与在 fortran 中使用自动数组完全不同，因为`pos`它是一个虚拟参数。问题是，因为`pos`is `intent(in)`，`f2py`正在检查它的声明尺寸与您传入的尺寸 ( `mpart`)，因为`npart`也应该是`intent(in)`. 由于它们不匹配，因此您会收到错误消息。

换句话说，您有 2 个`intent(in)`变量，而您为它们传递的值是不兼容的。实际的解决方案实际上取决于子例程应该做什么，以及虚拟参数的实际意图应该是什么。

如果`pos`是真的`intent(in)`，那么您原则上可以更改`npart`为`intent(hide)`在这种情况下，numpy 将`npart`根据分配的维度将 传递给您的子例程`pos`。例如，我相信它会被称为：

```
libomp.cic(pos,mpart,boxsize,dim) 
```

# c# - .NET 自定义配置部分：Configuration.GetSection 引发“无法定位程序集”异常

> ID：14718262
> 
> 赞同：14
> 
> 时间：2013-02-05T22:32:34.647
> 
> 标签：c#, .net, configuration

我为插件 DLL 创建了一个自定义配置部分，它将 .config XML 存储在一个单独的（来自主可执行应用程序）文件中。

这是自定义部分类的示例：

```
using System;   
using System.Configuration;

namespace PluginFramework.MyConfiguration
{

public class MyConfigurationSettings : ConfigurationSection
{
    private Configuration _Config = null;

    #region ConfigurationProperties     
    /// <summary>
    /// A custom XML section for an application's configuration file.
    /// </summary>
    [ConfigurationProperty("MyProjects", IsDefaultCollection = true)]
    public MyProjectConfigurationCollection MyProjects
    {
        get { return (MyProjectConfigurationCollection) base["MyProjects"]; }
    }

    // ...
    #endregion

    /// <summary>
    /// Private Constructor used by our factory method.
    /// </summary>
    private MyConfigurationSettings () : base () {
        // Allow this section to be stored in user.app. By default this is forbidden.
        this.SectionInformation.AllowExeDefinition =
        ConfigurationAllowExeDefinition.MachineToLocalUser;
    }

    // ...

    #region Static Members  
    /// <summary>
    /// Gets the current applications &lt;MyConfigurationSettings&gt; section.
    /// </summary>
    /// <param name="ConfigLevel">
    /// The &lt;ConfigurationUserLevel&gt; that the config file
    /// is retrieved from.
    /// </param>
    /// <returns>
    /// The configuration file's &lt;MyConfigurationSettings&gt; section.
    /// </returns>
    public static MyConfigurationSettings GetSection (ConfigurationUserLevel ConfigLevel) 
    {
        string appDataPath = System.Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
        string localDataPath = System.Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
        System.Configuration.ExeConfigurationFileMap exeMap = new ExeConfigurationFileMap();
        exeMap.ExeConfigFilename = System.IO.Path.Combine(appDataPath, @"MyCompany\MyPluginApp\Default.config");
        exeMap.RoamingUserConfigFilename = System.IO.Path.Combine(appDataPath, @"MyCompany\MyPluginApp\Roaming.config");
        exeMap.LocalUserConfigFilename = System.IO.Path.Combine(localDataPath, @"MyCompany\MyPluginApp\Local.config");

        System.Configuration.Configuration Config = ConfigurationManager.OpenMappedExeConfiguration(exeMap,ConfigLevel);
        MyConfigurationSettings myConfigurationSettings = null;

        try {
            myConfigurationSettings = (MyConfigurationSettings)Config.GetSection("MyConfigurationSettings");
        } 
        catch (System.Exception ex) {
            // ConfigurationErrorsException caught here ...
        }
        if (myConfigurationSettings == null) {
            myConfigurationSettings = new MyConfigurationSettings();
            Config.Sections.Add("MyConfigurationSettings", myConfigurationSettings);                    }
        } 
        if(myConfigurationSettings != null) {
            myConfigurationSettings._Config = Config;
        }

        return myConfigurationSettings;
    }       
    #endregion
}
} // PluginFramework.MyConfiguration 
```

第一次保存时生成的 .config XML 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <configSections>
        <!-- The exception complains about the following line (assembly attributes are compliant): -->
        <section name="MyConfigurationSettings" type="PluginFramework.MyConfiguration.MyConfigurationSettings, PluginFramework, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" allowDefinition="Everywhere" allowExeDefinition="MachineToLocalUser" />
    </configSections>
    <MyConfigurationSettings>
        <!-- Config properties are serialized fine according MyConfigurationSettings 
             properties marked with the ConfigurationProperty attribute ... -->
        <MyProjects>
            <MyProjectConfiguration GUID="{4307AC92-8180-4686-9322-830312ED59AB}">
                <!-- ... more complex configuration elements -->
            </MyProjectConfiguration>
        </MyProjects>
    </MyConfigurationSettings>
</configuration> 
```

当尝试`Config.GetSection()`在后续运行中加载此 XML 时，我`ConfigurationErrorsException`在 XML 示例中标记的行中捕获一个，说明`MyPlugin`无法找到程序集或其依赖项之一（请原谅我没有发布原始异常消息，但我只有德语，并且怀疑此文本在这里会有所帮助）。内部异常来自`System.IO`尝试加载程序集并获得反射以解析“MyConfigurationSettings”类类型。

为了准确起见，上面的代码被放置在一个框架 DLL（程序集）中，而后者又被从主应用程序加载的实际插件 DLL 引用。

下面的 UML 图说明了几个组件的关系： ![主要应用插件和框架组件](../Images/612fe5add6e09b1c7e33c85da1e9f514.png)

在环顾了一下这个问题之后，我觉得有必要对导出`MyConfigurationSettings`类（即`PluginFramework`）的程序集进行强命名（签名）并将其注册到 GAC。我还没有尝试过，并且出于几个原因想避免这一步（在知道它是否甚至可以帮助之前，这是解决问题的唯一选择）。

所以这里是问题（抱歉，我实际上在这里提出了 4 个问题，但它们之间的关系非常密切，因此为它们创建单独的 SO 问题是没有意义的）。

1.  我可以通过强命名有问题的程序集并将其注册到 GAC 来解决定位失败问题吗？

2.  配置管理抱怨的程序集很愚蠢，保证被加载（因为它调用`Configuration.GetSection()`自己）。
    有没有办法用`ConfigurationManager`or`Confguration`类显式注册程序集或适当的配置类型反序列化器？

3.  我也对有关[Hans Passant 评论](https://stackoverflow.com/questions/14718262/net-custom-configuration-section-configuration-getsection-throws-unable-to-lo#comment20591740_14718262)的更多信息感兴趣，他提到这可能是由从主应用程序加载（主）程序集的方式引起的问题。我无法控制这种机制，如果这会导致这种行为，我想知道是否有合理的解决方法？

4.  另一个想法（如果上述任何方法都无法显示）是完全管理配置 XML 格式（使用 XML 反序列化支持）以及从何处加载和合并配置文件。如果这是最合适的选择，任何人都可以给出如何有效地做到这一点的好的指导（管理路径和合并的最少必要代码）？

**更新：**
由于似乎没有人能够对这个问题提供更多见解（2个答案并没有真正让我进一步了解），所以我从 4\. 更改为选项，手动完成所有操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T04:24:23.960

我也试过了，但我从来没有让它像那样工作。我只是想自动加载 .config 不适用于 .dll 仅适用于 .exe。然后我放弃了，决定手动加载 .config 文件会更容易。您可以在此处查看完整代码：[https](https://github.com/GeertBellekens/Enterprise-Architect-Toolpack/blob/master/EANavigator/NavigatorSettings.cs) ://github.com/GeertBellekens/Enterprise-Architect-Toolpack/blob/master/EANavigator/NavigatorSettings.cs 这是最相关的部分：

```
public NavigatorSettings() {
     Configuration roamingConfig = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.PerUserRoaming);

     // the roamingConfig now get a path such as C:\Users\<user>\AppData\Roaming\Sparx_Systems_Pty_Ltd\DefaultDomain_Path_2epjiwj3etsq5yyljkyqqi2yc4elkrkf\9,_2,_0,_921\user.config
     // which I don't like. So we move up three directories and then add a directory for the EA Navigator so that we get
     // C:\Users\<user>\AppData\Roaming\GeertBellekens\EANavigator\user.config
     string configFileName =  System.IO.Path.GetFileName(roamingConfig.FilePath);
     string configDirectory = System.IO.Directory.GetParent(roamingConfig.FilePath).Parent.Parent.Parent.FullName;

     string newConfigFilePath = configDirectory + @"\Geert Bellekens\EANavigator\" + configFileName;
     // Map the roaming configuration file. This
     // enables the application to access 
     // the configuration file using the
     // System.Configuration.Configuration class
     ExeConfigurationFileMap configFileMap = new ExeConfigurationFileMap();
     configFileMap.ExeConfigFilename = newConfigFilePath;       

     // Get the mapped configuration file.
     currentConfig = ConfigurationManager.OpenMappedExeConfiguration(configFileMap, ConfigurationUserLevel.None);
     // merge the default settings
     this.mergeDefaultSettings();
 } 
```

访问配置属性：

```
public bool trackSelectedElement
{
    get {
        bool result;
        if(bool.TryParse(this.currentConfig.AppSettings.Settings["trackSelectedElement"].Value, out result)) {
            return result;
        }
        else {
            return true;
        }
    }
    set {
        this.currentConfig.AppSettings.Settings["trackSelectedElement"].Value = value.ToString();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:39:23.477

.NET Framework 不支持您尝试执行的操作。

第一 - 有意义的是，您的 plugin.dll 是为每个使用它的主机应用程序（.exe 或 web）配置的（这就是为什么它是可配置的）

第二 - 配置文件支持继承（例如：machine.config -> applicationHost.config -> web.config）。这就是他们的设计目的。在这方面，您的非路径配置将无法正常工作。

因此，如果您需要为部分应用程序或插件进行自定义配置，而不遵循 .config 概念，请制作标准 XML 文件或 jsonconfig 并从那里加载设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T05:40:56.327

@g-makulik

在这里，我有一份在真实环境中完成的工作副本，并被证明是有效的。

在 App.config 文件中：

```
<configSections>
    <sectionGroup name="mySectionGroupName">
        <section name="mySectionName" type="MyNamespace.MySectionHandler,MyNamespace" />
    </sectionGroup>
</configSections>
....
<mySectionGroupName>
    <mySectionName>
        <add key="MyKey" value="MyKeyValue" />
    </mySectionName>
</mySectionGroupName> 
```

在您使用配置的类中：

```
....
Hashtable ht = ConfigurationManager.GetSection("mySectionGroupName/mySectionName") as Hashtable; 
// when you call this, your handler will do what you want in there
string keyVal = ht["MyKey"] as String;
.... 
```

负责配置处理的类：

```
public class MySectionHandler : DictionarySectionHandler 
{
    public override object Create(object parent, object context, XmlNode section) 
    {
        // here do what you want with the value of "MyKey" - "MyKeyValue"
    }
} 
```

我希望这有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-12T18:19:27.543

我遇到了同样的问题，到目前为止还没有找到一个完全令人满意的解决方案。我们的应用程序加载是使用对专用程序集中定义的配置节类的引用进行编译的。应用程序与强名称程序集链接，但稍后当配置加载器尝试读取配置时，融合跟踪显示它尝试加载同一程序集的弱名称。出于某种原因，.net 无法看到它是同一个程序集并引发 System.IO.FileNotFound 异常。在我的情况下，工作解决方案是在配置中引用强名称。

我还注意到一个奇怪的行为：一旦.net“配置加载器”使用强名称加载程序集，使用弱名称的进一步引用实际上会成功！出于某种原因，框架“记住”了弱名称指的是同一个程序集。

任何关于您的问题的消息都会很有趣！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-09T16:06:58.530

为 .添加事件处理程序`AppDomain.CurrentDomain.AssemblyResolve`。这应该适用于`option 2`.

# joomla - 如何在前端更改模块 xml 参数

> ID：14718265
> 
> 赞同：0
> 
> 时间：2013-02-05T22:32:49.390
> 
> 标签：joomla

不要打扰我正在使用 Joomla 天气模块。在这个模块中，管理员可以输入一个城市的名称，它的天气数据可以在城市中看到。我要改变这个，所以它似乎是关于参数中列出的城市的信息。管理环境无需输入城市名称，通过列表可以选择城市名称。我需要在用户的环境中才能做到这一点。因此需要在用户环境中更改参数。你能帮我吗？！

管理员 xml 参数：

```
<param name="location" type="list" default="Tehran" label="LOCATION" description="LOCATION_DESC">
               <option value="Tehran">Tehran</option>
            <option value="Karaj">Karaj</option>            
            <option value="Mashhad">Mashhad</option>            
            <option value="Shiraz">Shiraz</option>
            <option value="Tabriz">Tabriz</option></param> 
```

使用前面的代码：

```
<td><select name="location" label="LOCATION" description="LOCATION_DESC">
            <option value="Tehran" <?php if ($params->get('location') == "Tehran") echo "selected";echo $location ?> >Tehran</option>
            <option value="Karaj" <?php if ($params->get('location') == "Karaj") echo "selected"; ?> >Karaj</option>            
            <option value="Mashhad" <?php if ($params->get('location') == "Mashhad") echo "selected"; $params->get('location') = Mashhad; ?> >Mashhad</option>          
            <option value="Shiraz" <?php if ($params->get('location') == "Shiraz") echo "selected"; ?> >Shiraz</option>
            <option value="Tabriz" <?php if ($params->get('location') == "Tabriz") echo "selected"; ?> >Tabriz</option>
                            </select></td> 
```

图片：[http://photos.vne.ir/img/2a1d073d5ed3.jpg][1]

،要改变城市需要改变的是Param，是否正确？

$params->get('location') 的变化如何？

```
$params->get('location') = value; 
```

# flyway - 如何在具有外部约束的数据库上使用 flyway:clean？

> ID：14718270
> 
> 赞同：2
> 
> 时间：2013-02-05T22:33:20.090
> 
> 标签：flyway

我是flyway的新手，目前只是尝试一下，我复制了我的数据库并尝试运行

mvn flyway:clean

我收到以下错误，

无法删除对象“VIP_STATUS”，因为它被 FOREIGN KEY 约束引用。

我需要做一些特别的事情来清理带有外键约束的数据库吗？我的数据库是sql server。Flyway 版本是 3.0.3 maven 插件。

编辑，更多信息：我有多个带有外键的架构，所以我认为将架构添加到配置中可能会有所帮助，但它没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T09:50:20.050

Clean 按 指定的顺序清理模式`flyway.schemas`。

只要模式之间没有循环引用，它就应该很好地处理外键引用。

我现在已经修复了文档，因为他们没有明确说明这一点。

# ruby-on-rails - ruby - 数组中不同元素之间的排列

> ID：14718271
> 
> 赞同：-1
> 
> 时间：2013-02-05T22:33:20.350
> 
> 标签：ruby-on-rails, ruby

> **可能重复：**
> [ruby - 数组元素之间的排列](https://stackoverflow.com/questions/14716873/ruby-permutation-between-elements-of-an-array)

我正在用 ruby​​ 在 Google Sketchup 中编写一个插件，在尝试置换另一个数组中存在的数组中的不同元素时遇到了一个真正的问题，这一切都取决于用户组合。

我有一个数组，如：

```
[["a, "b", c"], ["lol1", "lol2", lol3"], ["so1", "so2", "so3"]] 
```

对于这样的组合：

```
[1, 2, 3] 
```

输出应该仍然相同：

```
[["a", "b", "c"], ["lol1", "lol2", "lol3"], ["so1", "so2", "so3"]] 
```

但是对于这样的组合：

```
[2, 1, 3] 
```

输出应该是：

```
[["b", "a", "c"], ["lol2", "lol1", "lol3"], ["so2", "so1", "so3"]] 
```

但是对于这样的组合：

```
[3, 2, 1] 
```

输出应该是：

```
[["c", "b", a"], ["lol3", "lol2", "lol1"], ["so3", "so2", "so1"]] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:58:39.770

```
ar = [["a, b, c"], ["lol1, lol2, lol3"], ["so1, so2, so3"]]
p maybe_this = ar.map{|sub_ar| sub_ar.first.split(', ')}
#[["a", "b", "c"], ["lol1", "lol2", "lol3"], ["so1", "so2", "so3"]]
idx = [2,1,3]
#indexing of an array is zero-based
p idx.map!{|i| i-1} #[1,0,2]
p res = maybe_this.map{|sub_ar| sub_ar.values_at(*idx)}
#[["b", "a", "c"], ["lol2", "lol1", "lol3"], ["so2", "so1", "so3"]] 
```

小故事：[values_at](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-values_at)方法接受多个参数；`*idx`将一个数组分解为多个参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:40:44.333

也许你想要这个：

```
perm_idx = [1,2,3].permutation.to_a.index([2,3,1])
[["a", "b", "c"], ["lol1", "lol2", "lol3"], ["so1", "so2", "so3"]].map {|x| x.permutation.to_a[perm_idx] } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:15:26.497

不完全确定您想要什么，但这可能对您有用：

```
a = [["a, b, c"], ["lol1, lol2, lol3"], ["so1, so2, so3"]]

def combi_with_join(ordering, arrays)
  ordering = ordering.map {|x| x - 1}
  arrays.map {|ar| [ar.first.split(/,\s*/).values_at(*ordering).join(", ")] }
end

puts combi_with_join([1, 2, 3], a).inspect
puts combi_with_join([2, 1, 3], a).inspect
puts combi_with_join([3, 2, 1], a).inspect 
```

如果你真的想要一个数组数组......

```
def combi(ordering, arrays)
  ordering = ordering.map {|x| x - 1}
  arrays.map {|ar| ar.first.split(/,\s*/).values_at(*ordering) }
end

puts combi([1, 2, 3], a).inspect
puts combi([2, 1, 3], a).inspect
puts combi([3, 2, 1], a).inspect 
```

# apache - 重写很好，但不重定向

> ID：14718277
> 
> 赞同：0
> 
> 时间：2013-02-05T22:33:41.487
> 
> 标签：apache, .htaccess, mod-rewrite

-问题：我想使用 htaccess 重定向 javascript 文件的 url：

-->来自：

```
 http://www.domain.co.uk/tracking/tracking.js 
```

-->到：

```
 http://www.domain.co.uk/templates/domain.co.uk/js/tracking.js 
```

-我的 HTTACES（所有在线测试者都给出肯定的结果）：

```
 RewriteEngine on
    RewriteRule ^tracking/tracking\.js$ http://www.domain.co.uk/Templates/domain.co.uk/js/tracking.js [L,R] 
```

-结果

```
 Not Found
    The requested URL /tracking/tracking.js was not found on this server.
    Apache/2.2.0 (Fedora) Server at domain.co.uk Port 80 
```

-文件夹结构

```
 /...
    |
    /http
       |/Templates
       |      |/domain.co.uk
       |            |/js
       |               | - tracking.js
       |- .htaccess
       |- index.php 
```

因为那天我在测试许多不同的方式，我开始认为不是因为重写，但如果不是那样，可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:50:38.900

我认为您应该包括所有基本指令以使重写工作。像这样：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /
# Then the rewrite rule
RewriteRule ^tracking/tracking\.js Templates/domain.co.uk/js/tracking.js [L,R,NC] 
```

如果仍然不起作用，则问题很可能出在 Apache 配置文件上。

**此规则集应位于根目录的 .htaccess 文件中**

# scala - 使用 Jackson 时在 Spray.io 中找不到隐式 Marshaller

> ID：14718279
> 
> 赞同：1
> 
> 时间：2013-02-05T22:33:55.043
> 
> 标签：scala, spray, spray-json, jerkson

我有一个处理 POST 的 Spray.io 指令，我想使用 Jerkson（Jackson 的 scala 接口）将传入的 JSON 解析为适当的类。

```
post {
        path("") {
          entity(as[String]) { stuff =>
              complete {
                parse[User](stuff)
              }
          }
        }
      } 
```

问题是当我去编译时，Spray 去寻找一个 Marshaller：

```
 [error] C:\project\src\main\scala\com\project\AccountService\controllers\Users.scala:53: 
could not find implicit value for evidence parameter of type
 spray.httpx.marshalling.Marshaller[com.project.AccountService.models.User]
    [error]                     parse[User](stuff)
    [error]                                ^
    [error] one error found 
```

我需要为此编写一个自定义的 Marhsaller 吗？还是我的指令写得不正确？如果我确实需要一个，那里有什么好的例子吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:19:22.097

这设法完成了工作：

```
post {
        path("") {
          entity(as[String]) { body =>
            val user = parse[User](body)
                    complete(generate(user))
          }
        }
      } 
```

看起来因为我没有返回字符串，所以`complete`它开始寻找一个 Marshaller 来 Marshall 我的 User 对象。

# php - php html dom解析器仅将最后一个结果保存到mysql数据库

> ID：14718290
> 
> 赞同：1
> 
> 时间：2013-02-05T22:34:42.993
> 
> 标签：php, html, mysql, dom

我正在使用 php html dom 解析器从 2 个站点收集信息，当回显它时，它就像我想要的那样工作，但是当我尝试将我的一些变量保存到数据库时，它只会保存最后一个结果。

这是我一直在处理的代码。

```
<?php
include_once('simple_html_dom.php');

ini_set('display_errors', true);
error_reporting(E_ALL);

$host="localhost";
$username="root";
$password="";
$database="betatv_local";

mysql_connect($host,$username,$password);
mysql_select_db($database) or die( "Unable to select database");

$html = file_get_html('http://www.sidereel.com/Supernatural');

// find the title and echo it out
foreach($html->find('.title') as $title)
foreach($title->find('.sr-header') as $title2)
echo $title2->plaintext .'<br>';

echo '<br>';

// find the desc and echo it out
foreach($html->find('.summary') as $desc)
foreach($desc->find('.full-summary') as $descc)
echo $descc->plaintext .'<br>';

echo '<br>';

// find the showinfo and echo it out
foreach($html->find('.count') as $info)
echo $info->plaintext;

// find the airtime and echo it out
foreach($html->find('.airtime') as $air)
echo $air->plaintext;

// find the show status and echo it out
foreach($html->find('.status') as $status)
echo $status->plaintext .'<br>';

echo '<br>';

// find the show img and echo it out
foreach($html->find('.show-image') as $cover_img)
foreach($cover_img->find('img') as $cover_img_link)
echo $cover_img_link->src .'<br>';

echo '<br>';

$html = file_get_html('http://www.1channel.ch/watch-11054-Supernatural');

    // find the show episodes and echo it out
foreach($html->find('.tv_container') as $episodes)
foreach($episodes->find('a') as $episode_links)

echo $episode_links->plaintext .'<br>';

$query = "INSERT INTO tv_shows (show_name,show_info,show_airs,show_status,show_cover,show_desc,show_episodes) VALUES('$title2->plaintext','$info->plaintext','$air->plaintext','$status->plaintext','$cover_img_link->src','$descc->plaintext','$episode_links->plaintext')";

mysql_query($query) or die(mysql_error());

// clean up memory
    $html->clear();
    unset($html);

?> 
```

当回显时，它看起来像这样。

> 超自然
> 
> Jensen Ackles 和 Jared Padalecki 饰演 Dean 和 Sam Winchester，两兄弟正在寻找母亲死于恶魔之手以及父亲神秘失踪背后的意义。
> 
> 8 季 163 集 | 播出时间：CW 晚 9:00 | 显示状态：中断
> 
> [http://s3.sidereel.com/tv_shows/4373/large/sc_supernatural.jpg](http://s3.sidereel.com/tv_shows/4373/large/sc_supernatural.jpg)
> 
> 第 2 部分 第 3 集第 0 集 - 宣传片第 1 集 - 壮丽的七人 第 2 集 - 孩子们都很好 第 3 集 - 黑石的糟糕日子 第 4 集 - 罪恶之城 第 5 集 - 睡前故事 第 6 集 - 早晨的红色天空 第 7 集 - 新鲜血第 8 集 - 一个非常超自然的圣诞节 第 9 集 - Malleus Maleficarum 第 10 集 - 我的小梦 第 11 集 - 神秘的地方 第 12 集 - 在贝洛 第 13 集 - 鬼面者 第 14 集 - 长途电话 第 15 集 - 时间到了我的身边第 16 集 - 邪恶的第 4 季没有休息第 0 集 - 促销第 1 集 - 拉撒路崛起第 2 集 - 你在神吗？是我，Dean Winchester 第 3 集 - 开始 第 4 集 - 变形 第 5 集 - 怪物电影 第 6 集 - 黄热病 第 7 集 - 这是大南瓜，Phil 第 6 集 - Slash Fiction 第 7 集 - The Mentalists 第 8 集 - 婚礼时间到了！第 9 集 - 如何赢得朋友和影响怪物 第 10 集 - 死亡之门 第 11 集 - 保姆冒险 第 12 集 - 一次又一次 第 13 集 - 切片女孩 第 14 集 - 勇敢的 Pennywhistle 的魔法动物园 第 15 集 - 回购人 第 16 集 - 出去旧的第17集-重生的身份第18集第19集第20集-龙与地下城纹身的女孩第21集-阅读是基础第22集-会有血第23集-适者生存第8季第0集-第 8 季宣传片第 1 集 - 我们需要谈谈凯文第 2 集 - 怎么了，虎妈？第 3 集 - 心痛 第 4 集 - 被咬 第 5 集 - 血兄弟 第 6 集 - 南方舒适 第 7 集 - 凯文的一小片 第 8 集 - Hunteri Heroici 第 9 集 - 公民方 第 10 集 - 撕裂和磨损 第 11 集 - LARP 和真正的女孩第 12 集 - 随着时间的流逝 第 19 集 - 非常重要

除了我的变量 $episode_links 之外，一切都保存到数据库中。它只会节省

> 时光荏苒，第 19 集——意义重大

我需要它来保存变量中的所有信息，而不仅仅是最后的结果。知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:44:49.720

php`foreach`构造为数组中的每个项目执行下一条语句。如果您希望在 foreach 中发生不止一件事（例如回显并保存到数据库），则需要用花括号括住您想要发生的所有事情`{}`。

```
$html = file_get_html('http://www.1channel.ch/watch-11054-Supernatural');
$ep_links = "";

// find the show episodes and echo it out
foreach($html->find('.tv_container') as $episodes) {
    foreach($episodes->find('a') as $episode_links) {

        echo $episode_links->plaintext .'<br>';
        $ep_links .= $episode_links->plaintext;
    }
}

$ep_links = mysql_real_escape_string($ep_links);
$query = "INSERT INTO tv_shows (show_name,show_info,show_airs,show_status,show_cover,show_desc,show_episodes) VALUES('$title2->plaintext','$info->plaintext','$air->plaintext','$status->plaintext','$cover_img_link->src','$descc->plaintext','$ep_links')";

mysql_query($query) or die(mysql_error());
// clean up memory
$html->clear();
unset($html); 
```

编辑为在解析时将每个剧集附加到一个变量，然后将其插入数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:19:17.903

在运行查询之前尝试使用[mysql_real_escape_string](http://php.net/manual/en/function.mysql-real-escape-string.php)

# internet-explorer - 用于 Internet Explorer 查看加载的 css 和 javascript 文件的工具

> ID：14718294
> 
> 赞同：1
> 
> 时间：2013-02-05T22:35:04.940
> 
> 标签：internet-explorer

问这个问题我觉得很荒谬，但是对于我的生活，我不记得我曾经在 Internet Explorer 中使用什么工具来查看已加载的 js 和 css 文件。（我使用的 CMS 使用了大量的插件，因此使用了大量的样式表——当然，IE 不喜欢这样，所以我需要知道在 IE 的 32 个样式表限制中哪些文件优先）。我记得该工具会在 IE 的垂直框架中加载，显示文件列表。这听起来很熟悉吗？对于类似类型的工具的任何建议将不胜感激。

多谢你们！

# racket - 对球拍合同感到困惑

> ID：14718296
> 
> 赞同：9
> 
> 时间：2013-02-05T22:35:17.937
> 
> 标签：racket

我在球拍/列表中定义了一个`true?`与[计数一起使用的函数。](http://docs.racket-lang.org/reference/pairs.html?q=count&q=let&q=regexp-match&q=string-match&q=search#%28def._%28%28lib._racket/list..rkt%29._count%29%29)

```
(define (true? expr)
  (and (boolean? expr) expr #t)) 
```

我注意到我可以为它提供数字参数，并且我的函数会很高兴地返回`#f`.

```
> (true? 6)
#f 
```

所以，我想我会探索使用球拍合约来使非布尔参数返回违反合约的错误。所以我把这段代码放在我文件的顶部：

```
(provide (contract-out
          [true?         (-> boolean? boolean?)])) 
```

但是，在添加合同后，我仍然在球拍 REPL 中得到与上述相同的行为。我不明白这怎么可能。我错过了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-05T23:02:53.320

合同通常在模块*之间强制执行。*因此，您必须从外部角度进行尝试。但是，REPL 从您正在使用的模块内部应用。

从外部进行测试的一种简单方法是使用[测试子模块](http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._main-and-test%29)。例如：

```
#lang racket

(define (true? expr)
  (and (boolean? expr) expr #t))

(provide (contract-out
          [true?         (-> boolean? boolean?)]))   

(module* test racket/base
  (require (submod "..")
           rackunit)
  (check-true (true? #t))
  (check-false (true? #f))
  (check-exn exn:fail:contract? (lambda () (true? 3)))) 
```

更改合同并在 DrRacket 中重新运行，您应该在此处看到您的合同生效，因为`test`此处的模块被视为合同的外部客户。

* * *

或者，制作另一个文件作为`require`第一个文件，然后您也可以在那里看到合同的效果。如果第一个文件被调用`true-test.rkt`，那么你可以制作另一个模块，然后：

```
 #lang racket
 (require "true-test.rkt")
 (true? 42)  ;; And _this_ should also raise a contract error. 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-06T06:53:32.747

Danny Yoo 给出了一个很好的答案。我只是想扩展它并注意 Racket 确实为您提供了更多的灵活性，让您可以在哪里执行合同（即，在哪里放置*合同边界*）。例如，您可以使用以下`define/contract`形式：

```
-> (define/contract (true? expr)
     (-> boolean? boolean?)
     (and (boolean? expr) expr #t)) 
```

这将在定义`true?`和所有其他代码之间建立合同检查：

```
-> (true? "foo")
; true?: contract violation
;  expected: boolean?
;  given: "foo"
;  in: the 1st argument of
;       (-> boolean? boolean?)
;  contract from: (function true?)
;  blaming: top-level
;  at: readline-input:1.18
; [,bt for context] 
```

如果我想在 REPL 测试与合同相关的东西，我发现`define/contract`它特别有用，因为我并不总是有模块。但是，`contract-out`这是默认建议，因为在模块边界检查合约通常是一个不错的选择。

# jquery-ui - 绝对 div 转义其容器

> ID：14718300
> 
> 赞同：0
> 
> 时间：2013-02-05T22:35:31.363
> 
> 标签：jquery-ui, position, jquery-ui-tabs, absolute, jquery-ui-accordion

[http://micheresources.com/html/miche-u/lead-with-style](http://micheresources.com/html/miche-u/lead-with-style)

单击“Lead With Style”，它会自动将您置于“Calls 1-6”下。

正如您可能看到的，页面右侧的内容正在转义其容器。这不是浮动问题，但可能与绝对定位和显示有关。

我正在使用 jQuery 选项卡和 jQuery 手风琴。我找到了这个脚本并对其进行了修改，但它不起作用：

```
$(function() { 
    var parentHeight = $('#accordion').height(), 
        childHeight = $('.ui-tabs-panel').height(); 

    if (parentHeight <= childHeight) { 
        $('#accordion').height(childHeight); 
    } 
}); 
```

这是相关的CSS：

```
#main-content {
    background-color: rgba(255,255,255,.5);
    padding: 35px;
    border: 1px solid rgba(0,0,0,.1);
    border-radius: 10px;
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
    -khtml-border-radius: 10px;
    position: relative;
}

#accordion { position: relative; }
    #accordion h3 {
        width: 220px;
        margin: 0;
        padding: 4px 0 8px;
        font-size: 1.1em;
        cursor: pointer;
        outline: none;
        color: #6a6a6a;
    }

#accordion > div > ul {
    width: 205px;
    padding: 0 0 7px 15px;
}
    #accordion > div > ul li {
        background: url(../images/arrow.png) left 9px no-repeat;
        padding: 6px 0 6px 10px; 
        outline: none;
    }
        #accordion > div > ul li a { font: .9em Arial, "Lucida Grande", sans-serif; outline: none; }
        #accordion > div > ul li a:link, #accordion > div > ul li a:visited { color: #7d7d7d; }
        #accordion > div > ul li a:hover, #accordion > div > ul li.ui-state-active a { color: #64d1e7; }
        #accordion > div > ul li.ui-state-active a { text-decoration: underline; }

#accordion > div > div.ui-tabs-panel, #accordion > div > section {
    width: 560px;
    position: absolute;
    top: -23px;
    right: 0;
}
    #accordion > div > div.ui-tabs-panel span.button, #accordion > div > section span.button { float: right; display: inline-block; }
    #accordion > div > div.ui-tabs-panel h4, #accordion > div > section h4 { margin-bottom: 7px; font-size: 1.5em; color: #6a6a6a; }
    #accordion > div > div.ui-tabs-panel h5, #accordion > div > section h5 { margin-bottom: 15px; font-size: .9em; color: #a6a6a6; }
    #accordion > div > div.ui-tabs-panel p, #accordion > div > section p {
        font: 1em Helvetica, Arial, "Lucida Grande", sans-serif;
        color: #757575;
        line-height: 1.5em;
    } 
```

和 HTML：

```
<div id="main-content">
    <h1>Welcome, Leader!</h1>
    <hr />
    <h2>SECTIONS</h2>
    <div id="accordion">
        <h3>Coaching and Mentoring</h3>
        <div id="sec-1">
            <ul>
                <li><a href="sections/lead-with-style/1-1">Under Construction</a></li>
            </ul>
        </div>
        <h3>Lead With Style</h3>
        <div id="sec-2">
            <ul>
                <li><a href="sections/lead-with-style/2-1">Calls 1-6</a></li>
            </ul>
        </div>
        <h3>Moving Up</h3>
        <div id="sec-3">
            <ul>
                <li><a href="sections/lead-with-style/3-1">Compensation Plan Videos</a></li>
            </ul>
        </div>
        <h3>Dan Clark Leadership</h3>
        <div id="sec-4">
            <ul>
                <li><a href="sections/lead-with-style/4-1">Tab 1</a></li>
            </ul>
        </div>
        <h3>New Rep Coaching</h3>
        <div id="sec-5">
            <ul>
                <li><a href="sections/lead-with-style/5-1">Advisor Checklist</a></li>
                <li><a href="sections/lead-with-style/5-2">Six Weekly Emails</a></li>
            </ul>
        </div>
        <h3>Monthly Meetings</h3>
        <div id="sec-6">
            <ul>
                <li><a href="sections/lead-with-style/6-1">How to Hold an Effective Meeting</a></li>
                <li><a href="sections/lead-with-style/6-2">Monthly Basic Meeting Agenda</a></li>
                <li><a href="sections/lead-with-style/6-3">Monthly Agenda Details</a></li>
                <li><a href="sections/lead-with-style/6-4">More Info</a></li>
            </ul>
        </div>
        <h3>Communication Skills</h3>
        <div id="sec-7">
            <ul>
                <li><a href="sections/lead-with-style/7-1">Under Development</a></li>
            </ul>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:03:35.023

绝对位置肯定会毁了你的聚会，所以让我们用一些 CSS 和 jQuery 来解决这个问题：

```
.ui-tabs-panel {
  overflow: auto;
} 
```

如果内容“太长”，这会给我们一个滚动条。什么太长了？这就是我们使用 jQuery 的地方：

```
$('.ui-tabs-panel').css("height", $('#accordion').innerHeight()+"px"); 
```

我们强制选项卡内容具有与手风琴相同的高度。现在我们有了一个“太多”的度量标准，它看起来是正确的（当然，滚动条可能不美观）。

请注意，为了使用尺寸不太严格的容器来保持这种行为，您必须在调整浏览器大小时重新绑定高度，这将需要更多的 jQuery。让我们包装上面的代码：

```
function makeAccordionContentFit() {
  $('.ui-tabs-panel').css("height", $('#accordion').innerHeight()+"px");
}

// make it work right now!
makeAccordionContentFit();

// also make it work on document resize...
$(document).resize(makeAccordionContentFit); 
```

您的页面看起来有一个固定大小的容器，但它始终是未来的好计划。

# ios - 块没有被方法调用

> ID：14718305
> 
> 赞同：1
> 
> 时间：2013-02-05T22:35:52.940
> 
> 标签：ios, block

我猜我的语法是关闭的，但我似乎无法弄清楚这一点，因为我是新的块。我有这个自定义方法：

```
-(void)animateViewConstraintChange: (void(^)(void))completionHandler; 
```

这个方法看起来像这样：

```
-(void)animateViewConstraintChange:(void(^)(void))completionHandler
{
    [[self view]setNeedsUpdateConstraints];
    [UIView animateWithDuration:0.6
                 animations:^{
                 [[self view]layoutIfNeeded];
                 } completion:^(BOOL finished){
                     completionHandler;
                 }];

} 
```

它编译并运行，但是当我调用此方法并实际为完成处理程序放入某些内容时，该代码永远不会被调用。

```
[self animateViewConstraintChange:^{
    [orderedViewControllers removeObject:[self middleViewController]];
    [[[self middleViewController] view] removeFromSuperview];

    [[self middleViewController] removeFromParentViewController];

    _middleViewController = nil;

    [[self view]setNeedsUpdateConstraints];
}]; 
```

因此，在上述代码的情况下， animateViewConstraintChange 被调用，但块中的代码没有。

此外，编译器在 animateViewConstraintChange 方法中给了我一个错误

```
completionHandler; 
```

说，“未使用的表达结果”。

感谢您的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:37:54.940

应该用括号调用块：

```
} completion:^(BOOL finished){
                 completionHandler();
         }]; 
```

# asp.net-mvc - FormCollection.AllKeys 和 FormCollection.Keys 的区别

> ID：14718308
> 
> 赞同：2
> 
> 时间：2013-02-05T22:35:56.830
> 
> 标签：asp.net-mvc, formcollection

我目前正在 MVC 中四处寻找，想知道 the和属性`FormCollection`之间的含义和预期用法的差异。我知道这是一个并且是一个，但是如果您必须查看在帖子期间提交的表单字段，您为什么要选择一个属性而不是另一个属性？它只是用于快速检查特定密钥是否存在的约定吗？我的一个表单上有多个提交按钮，用于快速检查实际用于提交表单的按钮，但它让我想到了两者之间的预期差异，如果确实有的话。`AllKeys``Keys``AllKeys``string[]``Keys``KeysCollection``AllKeys``AllKeys`

大多数时候，我将利用模型绑定并将 ViewModel 或 Command 对象传递回控制器操作，但是否有`FormCollection.Keys`我不知道的特定用例？从内部快速查看`NameValueCollection`，`NameObjectCollectionBase`它看起来好像`KeysCollection`实际上只是一个字符串的集合，实际上更像是一个字符串`string[]`。是否可能在框架的更高版本中引入了一个，而另一个也保留了以实现向后兼容性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T14:00:53.957

看起来这是纯继承的产物。看一下 FormsCollection 的继承图（[http://msdn.microsoft.com/en-us/library/system.web.mvc.formcollection(v=vs.108).aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.formcollection(v=vs.108).aspx)）

**FormsCollection**继承自**NameValueCollection**，后者继承自**NameObjectCollectionBase**。**键**在**NameObjectCollectionBase**中定义并由**NameValueCollection**继承，NameValueCollection将**AllKeys**定义为所有键的字符串表示。NameValueCollection 的唯一目的似乎是将键公开为字符串（MSDN：表示可以使用键或索引访问的关联字符串键和字符串值的集合）

可能还有更多内容，但这是我迄今为止发现的。如果您（或任何其他人）发现任何其他解释，请发布

# java - 测试设置例程设计模式

> ID：14718311
> 
> 赞同：0
> 
> 时间：2013-02-05T22:36:07.803
> 
> 标签：java, design-patterns, testing, junit, integration-testing

我有一个扩展 JUnit TestCase 类的类。该测试有许多需要执行的“设置”例程。这些例程之一是将一些数据插入数据库，例如，另一个是将 JMS 消息发送到 EMS 队列。

目前，所有这些功能都在测试类中被覆盖的 setUp 方法中。但是，必须有更好的方法来做到这一点。我可能还想使用依赖注入来使测试类更通用。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:51:22.593

除非您计划为测试用例编写测试，否则我认为依赖注入不是（必然）答案。如果我是你，我会做最简单的事情，那就是将这个设置代码提取到类中。例如，一个`JmsSetup`类和一个`DatabaseSetup`类。让您的设置方法创建并使用这些类。

从那里开始，如果开始变得混乱，您可以做更多事情，但在到达之前不要过桥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:51:48.740

没有什么能阻止您将这些设置代码段分解为单独的类并使用您喜欢的任何其他 OO 原则。然后，您可以拥有一个简单的设置例程，将其全部委托给执行实际工作的多个类，因此可以在其他测试用例中重用。

# html - 用于 IE 以外的浏览器的 msapplication-task？

> ID：14718314
> 
> 赞同：1
> 
> 时间：2013-02-05T22:36:30.647
> 
> 标签：html, browser, meta-tags

在 IE 中，使用`<META NAME="msapplication-task" CONTENT="name=TASKNAME;action-uri=ONCLICK;icon-uri=ICON" />`Windows 8+ 中的 IE 9+，您可以轻松地将自定义操作图标放入固定站点的跳转列表中。**有什么方法可以实现与其他浏览器相同或类似的效果吗？**

关于这个话题，**有没有办法在其他操作系统中实现这个效果？**我主要对 Max OS 10.6+ 和 Ubuntu 10.10+ 感兴趣（也就是说，还有 Ubuntu with Unity）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:45:07.293

iOS有*一些*这样的。把它放在你的`<head>`：

```
<!-- Hide the browser UI when pinned to the home screen -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black"> 
```

您可以在根目录中设置主屏幕图标。您将需要以下内容：

```
<!-- With a reflective shine -->
<link rel="apple-touch-icon" href="apple-touch-icon.png">

<!-- Without a reflective shine -->
<link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png"> 
```

[HTML5 Boilerplate 建议](https://github.com/h5bp/html5-boilerplate/blob/master/index.html#L13)您将图标放在根目录中，就像 favicon 一样。

# html - 为什么溢出-x：隐藏使我的绝对定位元素变得固定？

> ID：14718319
> 
> 赞同：7
> 
> 时间：2013-02-05T22:36:56.320
> 
> 标签：html, css

我试图弄清楚，为什么设置`overflow-x: hidden`为 HTML 页面的正文会使我的元素`position: fixed`即使我将其设置为`position: absolute`.

在这个[演示](http://tinkerbin.com/8CPcFZnS)中效果更好地理解。

这是代码：

```
html,
body {
  width: 100%;
  height: 100%;
  padding: 0;
  margin: 0;
  overflow-x: hidden;/* If I remove this line everything is how I expect it to be! */
}

div.page {
  position: relative;
  width: 100%;
  height: 100%;
  min-height: 100%;
  border: 1px solid red;
  margin-bottom: 200px;
}

div.background {
  background: blue;
  position: absolute;
  width: 100%;
  height: 10%;
}
```

```
<div class='background'></div>
<div class='page'></div>
<div class='page'></div>
<div class='page'></div>
<div class='page'></div>
```

## 问题

和定位有什么关系`overflow-x: hidden`？为什么设置该属性会导致我的元素变为`position: fixed`而不是`position: absolute`？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-06T23:03:47.433

元素仍然是`position: absolute`，但由于`position`,`overflow`和盒子模型之间的一些相当复杂的交互作用，它看起来是固定的。令人难以置信的是，这些行为都不是未指定的，也不是任何浏览器中的错误——它实际上完全是设计使然，如果有点违反直觉的话。

它基本上归结为以下几点：

*   一个绝对定位的元素被锚定到最初的包含块，除非它的任何祖先被定位。（这就是为什么[添加`position: relative`到 body 工作如另一个答案中所建议的那样](https://stackoverflow.com/questions/14718319/why-does-overflow-x-hidden-make-my-absolutely-positioned-element-become-fixed/14718479#14718479)。）

*   你有`width: 100%; height: 100%;`html 和 body；这可以防止初始包含块扩展超出视口（可见区域），因此初始包含块永远不会滚动。

*   由于初始包含块不滚动，因此绝对定位的元素也不滚动。即使页面的其余部分确实滚动，这也会导致它看起来是固定的。

奇怪的是，[这也适用于 IE6](http://ryanfait.com/resources/fixed-positioning-in-internet-explorer)。

* * *

更长的解释：

*   **一个绝对定位的元素被锚定到最初的包含块，除非它的任何祖先被定位。**

    该属性的[规范](http://www.w3.org/TR/CSS21/visufx.html#overflow)，`overflow`顺便说一句，包含您正在观察的同一问题的另一个示例，其中元素与`overflow: scroll`绝对定位的后代元素交互，说明如下：

    > 此属性指定块容器元素的内容在溢出元素的框时是否被剪裁。它影响所有元素内容的剪辑，除了包含块是元素的视口或祖先的任何后代元素（及其各自的内容和后代）。

    您的绝对定位元素是其包含块是初始包含块（也是 html 元素的包含块）的后代，因为 html 和 body 都没有定位。这是根据[规范的另一部分](http://www.w3.org/TR/CSS21/visudet.html#containing-block-details)。这可以防止 html 和 body 上的溢出剪辑对您的绝对定位元素产生任何影响，因为它锚定到初始包含块。

*   **你有`width: 100%; height: 100%;`html 和 body；这可以防止初始包含块扩展超出视口（可见区域），因此初始包含块永远不会滚动。**

    规范然后在同一部分进一步说明以下内容：

    > UA 必须将根元素上设置的“溢出”属性应用于视口。当根元素是 HTML "HTML" 元素或 XHTML "html" 元素，并且该元素具有 HTML "BODY" 元素或 XHTML "body" 元素作为子元素时，用户代理必须改为应用 'overflow' 属性如果根元素上的值为“可见”，则从第一个此类子元素到视口。用于视口时的“可见”值必须解释为“自动”。从中传播值的元素必须具有用于“可见”的“溢出”的使用值。

    更简单地说：

    *   如果 html 不是`overflow: visible`，则将其应用于视口，然后将 html 转换为`overflow: visible`. 赋予 body的`overflow`值不受影响。

    *   如果 html 是`overflow: visible`，但 body 不是，则将其应用于视口，然后将 body 转换为`overflow: visible`.

    （设置`overflow-x`或到一个元素`overflow-y`以外的任何东西[都会导致速记](http://www.w3.org/TR/css3-box/#overflow)[不再等于](http://www.w3.org/TR/css3-box/#overflow)[那个元素](http://www.w3.org/TR/css3-box/#overflow)。）`visible`[`overflow``visible`](http://www.w3.org/TR/css3-box/#overflow)

    通常，这意味着视口应该与 html 和 body 一起自然滚动，因为一次只能存在一个滚动条。

    **但是......**你也给 html 和 body 一个宽度和高度`100%`！这意味着 100% 的容器。body的容器是html，html的容器是初始的包含块。但是由于您实际上不能使用 CSS 来控制视口的大小——这完全由浏览器处理——所以你的两个元素被限制在 100% 的视口高度（也称为折叠）。视口本身不必扩展到折叠之外，因为它的任何内容都不需要比可见更多的空间（请注意，绝对定位的元素永远不会被考虑在内）。因此，视口不会生成滚动条（html 也不会）；您看到的滚动条属于正文。

    如果您没有设置`width`or`height`属性，那么它们将默认为`auto`，从而导致 html 和 body 随内容一起扩展，并且始终与初始包含块所覆盖的整个区域相同大小，包括折叠下方的区域。这可以防止 body 生成滚动条，因为它总是会拉伸以适应其内容，因此您只能看到视口滚动条，而绝对定位的元素将与页面的其余部分一起滚动。

*   **由于初始包含块不滚动，因此绝对定位的元素也不滚动。即使页面的其余部分确实滚动，这也会导致它看起来是固定的。**

    那么，当您滚动时会发生什么，您实际上是在滚动 body 元素。由于绝对定位的元素被锚定到从不滚动的初始包含块上，因此它看起来是固定的而不是滚动的。

    顺便说一句，这也是元素在根本不滚动时似乎与滚动条重叠的原因。滚动条属于body，它位于绝对定位元素的下方。如果您从 html 和 body 中删除`overflow-x`声明或`width`and`height`声明，则您看到的滚动条属于视口。但是，如果定位 body，滚动条仍然属于 body，但该元素也成为 body 的子元素，因此不会与滚动条重叠。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T22:50:31.040

您需要添加`position: relative`到`body`. 你`div.background`有`position: absolute`它，这导致它粘在 HTML 文档的顶部。如果你不想这样，你需要给它的父母（在这种情况下，身体标签）`position: relative`。

演示#1：[http ://tinkerbin.com/nmI74RpC](http://tinkerbin.com/nmI74RpC)

或者，您可以从 中删除`position: absolute`，`div.background`但我不确定这将如何影响您的其余布局。

演示#2：[http ://tinkerbin.com/PP5PpbuC](http://tinkerbin.com/PP5PpbuC)

# android - OpenGL ES 无法使 LUMINANCE FBO 在 Android 中工作

> ID：14718322
> 
> 赞同：1
> 
> 时间：2013-02-05T22:37:26.893
> 
> 标签：android, opengl-es, fbo, render-to-texture

我正在使用帧缓冲区在视频渲染器上进行一些后期处理着色器。其中一个着色器的查找非常密集，因此我想更改为仅亮度的帧缓冲区以加快速度。我尝试在初始化时将 glTexImage2D 调用从 RGBA 更改为 LUMINANCE，但是当我尝试在“onDrawFrame”中附加缓冲区时出现错误。

问题是我已经从示例中破解了代码并且不太了解它所做的一切。一方面，我还创建了一个深度附件，因为我正在渲染视频，所以我不需要任何深度信息，但我不知道我是否可以禁用它。无论如何，这是我在 onSurfaceCreated 中对 FBO 的初始化：

```
 GLES20.glGenTextures(1, renTex, 0);

        // generate
        GLES20.glGenFramebuffers(1, fb2, 0);
        GLES20.glActiveTexture(GLES20.GL_TEXTURE4);

        // generate color texture
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, renTex[0]);

        // parameters
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST);

        // create it 
        // create an empty intbuffer first?
        GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGBA, texW, texH, 0, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE, texBuffer);
        //**THIS WORKS AS IS, CHANGING FROM RGBA TO LUMINANCE BREAKS IT**

        // create render buffer and bind 16-bit depth buffer
        GLES20.glBindRenderbuffer(GLES20.GL_RENDERBUFFER, depthRb[0]);
        GLES20.glRenderbufferStorage(GLES20.GL_RENDERBUFFER, GLES20.GL_DEPTH_COMPONENT16, texW, texH); 
```

这是在 onDrawFrame 中附加缓冲区的代码：

```
 GLES20.glBindFramebuffer(GLES20.GL_FRAMEBUFFER, fb[0]);
    // specify texture as color attachment
    GLES20.glViewport(0, 0, w, h);
    Matrix.frustumM(mProjMatrix, 0, -.30f, .30f, -.30f, .30f, 3, 7);

    GLES20.glFramebufferTexture2D(GLES20.GL_FRAMEBUFFER, GLES20.GL_COLOR_ATTACHMENT0, GLES20.GL_TEXTURE_2D, renTex[0], 0);
    // attach render buffer as depth buffer

    GLES20.glFramebufferRenderbuffer(GLES20.GL_FRAMEBUFFER, GLES20.GL_DEPTH_ATTACHMENT, GLES20.GL_RENDERBUFFER, depthRb[0]);
    int status = GLES20.glCheckFramebufferStatus(GLES20.GL_FRAMEBUFFER);
    if (status != GLES20.GL_FRAMEBUFFER_COMPLETE)
        System.out.println("Frame buffer not obtained :(");
//This works for RGBA but returns an error for LUMINANCE 
```

有人有什么建议吗？我也可以放弃深度缓冲区组件还是强制性的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-08T18:56:43.387

GL_LUMINANCE 不是可呈现颜色的格式。从[OpenGL ES 2.0 规范](http://www.khronos.org/registry/gles/specs/2.0/es_full_spec_2.0.25.pdf)第 4.4.5 节：

> 表 4.5 中未列出的格式，包括压缩的内部格式。无论它们包含哪些组件，它们都不能进行颜色、深度或模板渲染。

表中列出的可呈现颜色的格式为：RGBA4、RGB5_A1 和 RGB565。

甚至 RGB8 和 RGBA8 也没有在表中列出，但由于您可以使用 RGBA8，您的设备可能支持 OES_rgb8_rgba8 和/或 ARM_rgba8 扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-06T19:03:13.703

使用两个纹理作为帧缓冲区目标，一个具有 GL_RED_EXT 格式的 Y 平面，另一个具有 GL_RG_EXT 的 UV 平面。第二个纹理将具有第一个的一半尺寸，因此您不能一次将它们分配给不同的 COLOR_ATTACHMENTS 并且需要使用不同的视口进行两次渲染。

```
 #include "gl2ext.h" 

...
    glGenTextures(1, &mYTextureId);
    glBindTexture(GL_TEXTURE_2D, mYTextureId);
...
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RED_EXT, mCameraFrameWidth, mCameraFrameHeight, 0, GL_RED_EXT, GL_UNSIGNED_BYTE, NULL);
    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, mYTextureId, 0);
    glViewport(0, 0, mCameraFrameWidth, mCameraFrameHeight);
...

    glGenTextures(1, &mUVTextureId);
    glBindTexture(GL_TEXTURE_2D, mUVTextureId);
...
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RG_EXT, mCameraFrameWidth/2, mCameraFrameHeight/2, 0, GL_RG_EXT, GL_UNSIGNED_BYTE, NULL);
    glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, mUVTextureId, 0);
    glViewport(0, 0, mCameraFrameWidth/2, mCameraFrameHeight/2);
... 
```

这适用于大多数带有 arm7+ 的 iPhone 和 Android 手机

# xml - 修剪 HTML 锚节点中的 href

> ID：14718323
> 
> 赞同：2
> 
> 时间：2013-02-05T22:37:26.360
> 
> 标签：xml, xslt, xslt-1.0

嘿，我需要`<a>`使用 XML 1.0 将每个标记中的内容修剪到描述节点中的字符限制 20。这是XML

```
 <description> 
       This is text <a href="http://stackoverflow.com/posts/14718323/edit">http://stackoverflow.com/posts/14718323/edit</a>. 
       Also here is more text than we have another 
       <a href="http://stackoverflow.com/posts/14718323/edit">http://stackoverflow.com/posts/14718323/edit</a>.
  </description> 
```

我需要它变成这样：

```
 <description> 
       This is text <a href="http://stackoverflow.com/posts/14718323/edit">http://stacko</a>. 
       Also here is more text than we have another 
       <a href="http://stackoverflow.com/posts/14718323/edit">http://stacko</a>.
  </description> 
```

我可以做大部分的逻辑，但我在做一个“for-each”搜索描述节点并转换“each”<a>时遇到了麻烦。

这有意义吗？任何帮助表示赞赏。

** 编辑 2/7/13 ***

根据这里提供的答案是我现在的位置。

```
 <xsl:template match="/">
     <xsl:apply-templates select="//description"/>
   </xsl:template>

   <xsl:template match="a">
    <a href="{@href}">
       <xsl:value-of select="substring(normalize-space(),1,20)"/>
    </a>
   </xsl:template> 
```

问题是“应用模板”不起作用，因为我的 XSL 中有多个模板。我需要专门调用一个模板，所以我认为“调用模板”将是要走的路线。“调用模板”的唯一问题是我不知道如何指定要引用的特定 XML 节点。到目前为止，这是我如何破解它（deosn't work）：

```
 <xsl:template match="/">
      <xsl:call-template name="trim_text"/>
     </xsl:template>

    <xsl:template name="trim_text" match="//description">
     <a href="{@href}">
       <xsl:value-of select="substring(normalize-space(),1,20)"/>
     </a>
    </xsl:template> 
```

最初的“调用模板”需要在 a 中，`<xsl:template match="/">`因为这是在一个更大的函数中。所以我需要三样东西：

1) HREF 与 XML 中的内容保持一致

2）标签之间的文字`<a>`要修剪到20px

3) 我需要从一个更大的 xsl 模板中调用这个模板，该模板对 XML 做了很多转换。这将是大约 7 个模板调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T03:42:51.967

**这种转换避免了使用`xsl:attribute`, 格式更好，可读性更好**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="a[@href]">
  <a href="{substring(@href,1,20)}">
    <xsl:apply-templates select="@*[not(name()='href')]|node()"/>
  </a>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时：**

```
<root>
    <description>
            This is text 
        <a href="http://www.longlink/morelink/page/anotherpage">Link Here</a>.
            Also here is more text than we have another
        <a href="link-style:null">Link Here</a>.
    </description>
</root> 
```

**产生想要的正确结果：**

```
<root>
   <description>
            This is text 
        <a href="http://www.longlink/">Link Here</a>.
            Also here is more text than we have another
        <a href="link-style:null">Link Here</a>.
    </description>
</root> 
```

**说明**：

1.  **[身份规则](http://www.dpawson.co.uk/xsl/sect2/identity.html)**——按原样复制选择此模板执行的每个节点。

2.  使用**[AVT](http://www.w3.org/TR/xslt#attribute-value-templates)**（属性值模板）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:00:19.287

> 问题是“应用模板”不起作用，因为我的 XSL 中有多个模板。我需要专门调用一个模板，所以我认为“调用模板”将是要走的路线。“调用模板”的唯一问题是我不知道如何指定要引用的特定 XML 节点。

模板*模式*可能是您正在寻找的

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

  <xsl:template match="/">
    <!-- do some other stuff ... -->

    <!-- handle the description -->
    <xsl:apply-templates select=".//description" mode="description" />

    <!-- more other stuff here -->
  </xsl:template>

  <!-- description-specific templates -->
  <xsl:template match="@* | node()" mode="description">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()" mode="description" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="a" mode="description">
    <xsl:copy>
      <xsl:apply-templates select="@*" mode="description" />
      <xsl:value-of select="substring(., 1, 20)" />
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

当您使用 指定模式时`apply-templates`，在查找要应用于每个节点的模板时，仅考虑标记为相同模式的模板（加上匹配所有元素节点并递归地将模板应用于*使用相同模式的*子节点的默认隐式模板，但是这不适用于这里，因为我们有一个身份模板）。例如，此元素的示例模板`a`不允许包含其他标签的链接

```
<a href="#">This is a <b>very</b> long piece of text used as an example</a> 
```

会成为

```
<a href="#">This is a very long </a> 
```

如果你想保留这样的标记，它会变得更加复杂。你不能用明显的方法来做到这一点

```
<xsl:template match="a//text()" mode="description">
  <xsl:value-of select="substring(., 1, 20)"/>
</xsl:template> 
```

因为这将孤立地对待每个文本节点，并产生

```
<a href="#">This is a <b>very</b> long piece of text </a> 
```

（因为“This is a”和“very”已经短于20个字符，而“long-piece of text”是“long-piece of text used as...”截断到20个字符）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T23:55:42.140

回答 OP 评论中修订的问题，即他需要将字符限制为 20 个字符。

尝试使用 substring 函数只返回前 20 个字符：

```
<xsl:value-of select="substring(.,1,20)"/> 
```

这是一个更完整的答案：

**这个 XSLT 1.0 转换：**

```
 <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
        <xsl:template match="@*|node()">
            <xsl:copy>
                <xsl:apply-templates select="@*|node()"/>
            </xsl:copy>  
        </xsl:template>
        <xsl:template match="a/@href">
            <xsl:attribute name="href"><xsl:value-of select="substring(.,1,20)"/></xsl:attribute>
        </xsl:template>
    </xsl:stylesheet> 
```

**应用于此 XML 文档时：**

```
 <root>
        <description> 
            This is text <a href="http://www.longlink/morelink/page/anotherpage">Link Here</a>. 
            Also here is more text than we have another 
            <a href="link-style:null">Link Here</a>.
        </description>
    </root> 
```

**产生所需的结果（注意第一个 href 属性的缩短）：**

```
 <root>
        <description> 
            This is text <a href="http://www.longlink/">Link Here</a>. 
            Also here is more text than we have another 
            <a href="link-style:null">Link Here</a>.
        </description>
    </root> 
```

**解释：**

*   恒等变换（第一个模板）会将所有节点和属性复制到结果树，
*   第二个模板将仅复制 href 的前 20 个字符
*   还要注意缺少 for-each，而是使用模板规则和应用模板。在可能的情况下，您应该使用模板。

# windows-phone-7 - 我想使用我的代码从我的 mainpage.xaml.cs 到 schduledagent.cs。可能吗？

> ID：14718324
> 
> 赞同：0
> 
> 时间：2013-02-05T22:37:27.613
> 
> 标签：windows-phone-7

我想在我的 mainpage.xaml.cs 中使用 textblock1.text 到 schduledagent.cs。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:48:12.080

您的主应用程序不会与您的后台代理同时运行，因此您无法在两者之间进行通信。但是，您可以在它们之间共享代码，为此您应该将公共代码放在类库中。为此，请右键单击您的解决方案并选择“添加项目”=>“Windows Phone 类库”（这是另一个线程的答案），[请参见此处](https://stackoverflow.com/questions/8787964/accessing-data-in-main-project-from-a-scheduledtaskagent)

# javascript - 使用 $.xml2Json 返回一个复杂的对象

> ID：14718327
> 
> 赞同：0
> 
> 时间：2013-02-05T22:37:39.423
> 
> 标签：javascript, jquery, json, jquery-plugins, xml-parsing

我有这个代码：

```
$.ajax({
    type: "GET",
    url: trgUrl,
    success: function (data)
    {
        var xml= $.parseXML(data);
                               {
        var obj= $.xml2json(xml);

        //....
    }
 }); 
```

并且`data`可以是这样的：

```
 "<name> Mike </name>" 
```

现在，问题是使用后`$.xml2json(xml)`，为了显示我需要写的名字：

```
 alert(obj.name.value); // Mike 
```

而不仅仅是：

```
 alert(obj.name);    // object object 
```

换句话说：`$.xml2json`将 的内容`<name>`转换为另一个对象（而不是使其成为直接字符串）

**我该如何解决这种行为？**有人有这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:31:25.077

修改插件如下：

```
// Add element value
if(node.childElementCount == 0 && node.textContent != null && node.textContent != "") {
         /* comment out ".value" */
         result[node.nodeName]/*.value */= node.textContent.trim();
} 
```

演示：http: [//jsfiddle.net/ycN37/](http://jsfiddle.net/ycN37/)

如果节点有子节点，这可能会产生问题，这可能是作者首先创建对象的原因

# php - 服务器 cpu 100% 使用率和许多 php 变量

> ID：14718328
> 
> 赞同：-1
> 
> 时间：2013-02-05T22:37:41.247
> 
> 标签：php, ajax, performance, webserver

首先，我说的是托管我的网站的服务器。

所以，几分钟前我在我的 cPanel 规格中注意到我的 CPU 使用率接近 100%（我的范围是 80-95%）。另一方面，我的内存使用率为 5-10%。

我想知道这个服务器是否会在未来崩溃。例如 CPU 使用率 = 100% 会发生什么？该服务器是否会崩溃？

我注意到这个 cpu 使用是因为我正在运行一个 ajax 脚本，它每 5 秒刷新一个 div。这个 div 的内容是来自 3 个随机数组的字符串，它们每 5 秒创建一次。

此外，我在我的代码（php 代码）上使用了许多变量 - 数组，我想知道是否必须刷新这些变量。例如

```
<html>
<?
$variable1 == something
$variable2 == something
$variable3 == something

?>
</html>
<? flush($variable1) ?> 
```

是否需要在 php 上执行此操作（如在 C++ 上）？或者 php 有像 Java 这样的自动垃圾收集器吗？

编辑：我正在使用的 Ajax 脚本

索引.html

```
<html>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.0/jquery.min.js"></script>
    <script type="text/javascript">
    var auto_refresh = setInterval(
    function ()
    {
    $('#autoRefreshDiv').load('autoRefreshDiv.php').fadeIn("slow");
    }, 5000); // refresh every 5000 milliseconds
    </script>
    <body>
    <div id="autoRefreshDiv"></div>
</body>
    </html> 
```

autoRefreshDiv.php

```
<?
$array1 = array("something1", "something2");
$array2 = array('something3','something4');
$array3 = array('something5','something6');
shuffle($array1);
shuffle($array2);
shuffle($array3);
echo $array1[0].'.....'.$array3[0].'.....'.$array2[0] ;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:45:18.597

你的问题有点含糊。一些答案：如果 CPU 负载达到 100%，您的服务器不会崩溃。它可能响应较慢，但崩溃不是一种选择。您可能仍想对您的应用程序进行一些优化...

刷新与垃圾收集没有太大关系，但与输出缓冲有关。它会在脚本完成之前向用户发送一些数据。

如果您不谈论数千个变量，那么拥有许多变量并不是一个大问题。只要你没有疯狂的递归之类的，你就应该是安全的。由于您的记忆力最高只有 10%，因此没有危险。当然 php.ini 会限制脚本使用的内存总量。

我希望这能有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:48:03.520

您不必刷新变量，因为 PHP 具有在请求关闭时触发的 GC -> 每次 ajax 请求完成时。此外，使用许多变量很可能只会给您的 RAM 带来压力，而不是 CPU。

我认为每隔几秒生成一次大型随机数组会导致您的 CPU 使用率出现问题。

# iis-7 - IIS和多个域名

> ID：14718329
> 
> 赞同：0
> 
> 时间：2013-02-05T22:37:54.067
> 
> 标签：iis-7, url-rewriting, url-redirection

我遇到了一种域名情况，这让我有点难过，因为我还不太熟悉 IIS。

我以为我可以使用 URLRewrite，但它似乎不适用于目录中的绑定。

**设想：**

我有一个作为多个网站的主网站。

**例子：**

用户一可以创建 chris.html 并将其放入：

```
masterwebsite/Chris/Chris.html 
```

用户二可以​​创建 mike.html 并将其放入

```
masterwebsite/Mike/Mike.html 
```

我想将多个域名绑定到我的主网站上的不同位置。

IE;

*   网址：chris.com

*   绑定到：masterwebsite/Chris/Chris.html

和

*   网址：mike.com
*   绑定到：masterwebsite/Mike/Mike.html

作为我尝试使用的 url 重写规则的模式；

*   `^chris.com$`重定向到`Chris/Chris.html`
*   `^mike.com$`,重定向到`Mike/Mike.html`

谁能建议如何正确地做到这一点？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:07:18.867

如果要测试特定主机，则必须使用条件。
以您的示例为例，它将是：

```
<rule name="Chris" patternSyntax="ExactMatch" stopProcessing="true">
  <match url="^.*$" />
  <conditions>
    <add input="{HTTP_HOST}" pattern="^chris.com$" />
  </conditions>
  <action type="Redirect" url="http://masterwebsite/Chris/Chris.html" redirectType="Permanent" />
</rule> 
```

# python - Python 中“和”与集合的行为

> ID：14718332
> 
> 赞同：8
> 
> 时间：2013-02-05T22:38:12.663
> 
> 标签：python, set

我知道，如果我想获得两组（或 freezesets）的交集，我应该使用 & 符号`&`。出于好奇，我尝试使用“和”这个词

```
a = set([1,2,3])
b = set([3,4,5])
print(a and b) #prints set([3,4,5]) 
```

我只是好奇为什么？当与列表一起使用时，这`and`代表什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-05T22:40:52.477

`x and y`只是将整体`x`和`y`表达式视为布尔值。如果`x`为假，则返回`x`. 否则，它返回`y`. 有关详细信息，请参阅[文档](http://docs.python.org/3/library/stdtypes.html#boolean-operations-and-or-not)。

当且仅当它们为空时， s （`set`如您的示例）和s （如您的问题）都是错误的。`list`同样，有关详细信息，请参阅[文档](http://docs.python.org/3/library/stdtypes.html#truth-value-testing)。

所以，如果它是空的，`x and y`将返回，否则。`x``y`

# android - 在 Android 中使用示例库进行应用内计费：由 IInAppBillingService.aidl 创建的接口

> ID：14718333
> 
> 赞同：4
> 
> 时间：2013-02-05T22:38:17.327
> 
> 标签：android, android-billing

使用 Google 新的应用内计费库（第 3 版），将计费添加到一个应用程序应该会[变得更加容易。](http://android-developers.blogspot.de/2012/12/in-app-billing-version-3.html)开发人员博客（见链接）中显示的代码看起来已经很简单了。

但是，我在 SDK 的文件夹中发现了示例应用程序`extras\google\market_billing\in-app-billing-v03`。它被称为“TrivialDrive”。

当我尝试使用示例代码时，提出了一些问题：

1.  将文件粘贴`IInAppBillingService.aidl`到新包中`com.android.vending.billing`是否正确？然后创建的 Java 界面为我显示了两条待办事项消息，例如`getBuyIntent()`：“TODO：将其更改为特定于应用程序的键”。听起来不太好。但是，这个接口是否已准备好生产？
2.  `util`示例的“src”中有一个文件夹，其中包含 、`IabHelper`和其他类。我可以简单地复制该目录并按原样使用所有这些辅助函数吗？`Base64``Purchase`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T08:57:06.850

您可能将示例代码与生成的 AIDL 存根混淆了。应用内计费服务的实现是在 Google Play Store 客户端中，AIDL 文件只是调用它的一种方式（使用 RPC）。您应该更改示例代码以使其与您的帐户、密钥和项目一起使用。至于 中的代码`util`，许可证是许可的，所以你可以复制它并使用它。当然，您可以从头开始构建自己的库，只需`IInAppBillingService`使用生成的存根调用。

# android - 如何禁用膨胀视图中的其他复选框

> ID：14718335
> 
> 赞同：0
> 
> 时间：2013-02-05T22:38:31.027
> 
> 标签：android

我在活动中有一个线性布局1，还有另一个带有文本框和复选框的布局2。

所以layout2被膨胀并添加到layout1，这是多次完成的。完全膨胀后，我得到一种具有 TextView 和复选框的 listView。现在我需要使复选框的行为类似于单选按钮，这意味着如果单击其中一个复选框，则应禁用其他复选框。我做了一些谷歌搜索并制作了一些东西，但是每次单击一个框时，都会禁用完整的布局。

谁能告诉我如何处理这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:15:50.357

如果您必须使用 ScrollView，则尝试将其更改为 ListView 和其他需要滚动以及列表的 View，添加为 ListView 的标题：http: [//developer.android.com/reference/android/widget /ListView.html#addHeaderView(android.view.View)](http://developer.android.com/reference/android/widget/ListView.html#addHeaderView(android.view.View))

# php - Symfony2 使用 Backbone.js 和 WSSE 进行身份验证

> ID：14718339
> 
> 赞同：1
> 
> 时间：2013-02-05T22:38:48.053
> 
> 标签：php, symfony, backbone.js, fosrestbundle

我使用 FOSRestBundle 开发了一个 REST-ful Web 应用程序，我想使用 Backbone.js 作为前端。我想知道使用令牌的身份验证。我知道 OAuth 仅适用于交换服务器到服务器，但对于我的应用程序的前端，我该如何管理它？我在论坛上阅读了很多，我知道有 WSSE 方法，但是我如何与 Backbone.js 集成？

此外，最好的设置（防火墙）是什么，以便最终我可以集成 OAuth 应用程序？如何管理所有这些身份验证协议？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:02:17.953

使用 twig 创建一个正常的登录页面，然后在成功通过身份验证后，重定向到一个控制器，该控制器呈现一个包含主干.js 和任何其他客户端资源的 twig 文件，然后主干可以从那里接管，因为您的所有 REST 端点都将是如果您已正确设置权限，则可访问。

# sql - 优化为每一行聚合整个表的更新命令

> ID：14718343
> 
> 赞同：1
> 
> 时间：2013-02-05T22:39:11.133
> 
> 标签：sql, database, sqlite, sql-update

我有 2 个表，`company`和`investment`，我需要在 company 表中有一个列，其中包含每家公司的投资数量。

顺便说一下，这是一个 sqlite 数据库。

我尝试了以下查询：

```
UPDATE company SET numlinks = (SELECT count(*) 
                                   FROM investment 
                                   WHERE investment.company_name = company.name); 
```

我很确定查询是正确的。如果我为一家公司运行它，则该行将正确更新。但鉴于我有超过 300K 行，查询开始运行，似乎需要一段时间。

使用命令为单个公司运行它时，`.timer ON`使用的 CPU 约为 0.03（我不确定单位，我猜它以秒为单位）

关于如何使这更快的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:49:35.967

您想要做的是计算摘要，然后将它们加入到更新语句中。不幸的是，SQLite 不支持连接（[这里](http://sqlite.org/lang_update.html)），除非通过这种相关的子查询语法。

加快速度的一种方法是创建一个临时表：

```
select company_name, count(*) as cnt
from investment
group by company_name 
```

然后对这张表做同样的事情：

```
set numlinks = (select cnt from TemporaryTable) 
```

性能优势是双重的。首先，您不必为每一行重新计算。更重要的是，您可以在 上创建索引`company_name`，显着加快查询速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:53:48.287

这是最简单的解决方案。

```
alter table company
drop column numlinks 
```

数据库规范化的首要原则之一是不存储计算值。想显示链接数时，需要时查询。

```
select company.name, other_stuff, count(*) links
from company join investment on company.name = investment.company_name
group by company.name, other_stuff 
```

顺便说一句，在您当前的设计中，如果两家公司名称相同，您就有麻烦了。这就是为什么名称字段很少用于标识记录的原因。

如果无法理解这个答案，我听说过这本书的好东西，数据库设计为普通人。

# android - AppMobi 应用程序是否需要 Applab？

> ID：14718345
> 
> 赞同：0
> 
> 时间：2013-02-05T22:39:16.097
> 
> 标签：android, ios, html, appmobi

使用 AppMobi 制作的 HTML5 应用程序是否总是需要在用户手机上安装 applab？或者我可以将它构建为一个独立的应用程序吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T13:58:10.787

appLab 用于测试应用程序，而无需使用“Test Anywhere”构建它。

准备就绪后，您可以将应用程序构建为二进制文件并分发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T23:56:55.513

第一个答案是正确的。appLab 的美妙之处在于，您可以从 XDK 更新“随处测试”版本，然后您可以运行 appLab 以在您想要的任何设备上运行该应用程序，而不必费力将其安装到建立在所有这些平台上。关于它的另一个好处是，如果您只是想制作一个简单的应用程序，只是为了帮助弄清楚如何使一些新功能发挥作用，您无需完成每个平台的所有设置，以及 iOS 上的配置 BS看看它是否适用于iOS平台。最大的缺点，不是什么大问题，是当你切换到另一个应用程序时，比如阅读你的电子邮件，当你回来时，你不是在你的应用程序中离开 appLab 的地方，而是你从头开始appLab 主屏幕。

# c++ - 一旦中间有一个空白空间，如何将数组中的所有内容移到左侧？

> ID：14718350
> 
> 赞同：0
> 
> 时间：2013-02-05T22:39:42.727
> 
> 标签：c++, arrays

A[5] 有元素 {a,b,c,d,e}

A[2] 变为空，将所有内容向右移动的最佳方法是什么，以便它们部分填充数组，将空白空间留在最左边。我知道如何使用逻辑和循环来做到这一点，我想知道是否有任何命令可以为我做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:44:03.897

C 风格的数组没有“空”元素的概念。该元素将始终具有一个值。您可能会决定某个值表示一个空元素，但这取决于您。如果您的“空”占位符值被命名为`empty`，您可以执行以下操作：

```
auto empty_it = std::find(std::begin(arr), std::end(arr), empty);
std::rotate(empty_it, empty_it + 1, std::end(arr)); 
```

这会将第一个空元素移动到数组的后面。

最好使用`std::vector`,`std::list`或其他标准库容器。它们提供了从容器中移除元素的功能，而您不必关心移动元素。例如：

```
std::vector<int> v = {0, 1, 2, 3, 4, 5, 6};
v.erase(v.begin() + 3);
for (auto& x : v) {
    std::cout << x << " ";
} 
```

这将打印`0 1 2 4 5 6`. `3`已从容器中取出。

# c# - 在 MdiChild 中打印图片框

> ID：14718351
> 
> 赞同：0
> 
> 时间：2013-02-05T22:39:44.460
> 
> 标签：c#, printing, picturebox, mdichild

我正在尝试在 MdiChild 中打印图片框的内容。调试代码看起来永远不会触发 PrintPage 事件。我主要将此代码用于该项目：[printing content of a picturebox](https://stackoverflow.com/questions/5920989/printing-content-of-a-picturebox)

怎么了 ？

这是我的代码：

```
private void stampaToolStripMenuItem_Click(object sender, EventArgs e)
    {

        Form2 activeChild = this.ActiveMdiChild as Form2;
        PictureBox theBox = (PictureBox)activeChild.pictureBox1;
        dastampare = theBox.Image as Bitmap;
        printDocument1.OriginAtMargins = true;
        printDocument1.DocumentName = "Prova";
        printDialog1.Document = printDocument1;
        printDialog1.ShowDialog();
        if (printDialog1.ShowDialog() == DialogResult.OK)
        {
            printDocument1.Print();
        }
    }

    private void printDocument1_PrintPage(object sender,  System.Drawing.Printing.PrintPageEventArgs e)
    {
        e.Graphics.DrawImage(dastampare, 0, 0);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:25:35.323

在表单的构造函数中，尝试连接事件处理程序：

```
public Form1() {
  InitializeComponent();
  printDocument1.PrintPage += printDocument1_PrintPage;
} 
```

# c# - 发生数据库死锁，但为什么？

> ID：14718355
> 
> 赞同：2
> 
> 时间：2013-02-05T22:40:04.910
> 
> 标签：c#, sql-server, multithreading, transactions, deadlock

我无法弄清楚这一点，认为我已经对这个问题视而不见。

我在 MsSql server 2012 上有以下场景。

在 10 个线程（C# + NHibernate）中，我这样做：

1.  开始事务（ReadCommitted）
    1.  Select **count(*)** from MyTable1 where ... （比较没有索引的列，因此这可能会导致完整的表扫描）
    2.  插入 MyTable1 ...
    3.  插入 MyTable2 ...
    4.  重复 a、b、c 100 次。
2.  提交事务

每个线程使用的数据都是唯一的，因此一个线程不能创建与另一个线程相同的插入。

**这会导致死锁。**

如果我使用**ReadUncommitted**事务，它可以完美地工作，因为根本没有读/写锁。

但我似乎无法理解这如何导致死锁，我很确定这是一个教科书上的死锁示例。

有人可以澄清这如何导致死锁吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:50:00.800

这样想：

*   线程 (a) 执行步骤 1.1（读取 MyTable1）
*   线程 (b) 执行步骤 1.1（读取 MyTable1）
*   线程 (a) 执行步骤 1.2 (Write MyTable1)
*   线程 (b) 执行步骤 1.2 (Write MyTable1)

下一次迭代...

*   线程 (a) 尝试执行步骤 1.1，必须等待线程 (b) 提交
*   线程 (b) 尝试执行步骤 1.1，必须等待线程 (a) 提交

僵局

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T16:14:33.163

原来数据库是为 SnapshotReadComitted 配置的。但我不知道（系统上的neebie）。

一旦我意识到这一点，我就能够解决这个问题:)。

感谢您的所有帮助:)。

# mysql - 将 VARCHAR 字段拆分为 2 行 MySQL

> ID：14718358
> 
> 赞同：0
> 
> 时间：2013-02-05T22:40:17.807
> 
> 标签：mysql, text, chunking

我有一个充满电子邮件的数据库。它包含收件人、发件人、主题、正文等作为列。我试图输出基本相同的格式，但对于我将使用输出文件的应用程序，正文不能超过大约 300 个字符。我不想只抓取前 300 个字符，因为我需要所有文本。我想要做的是将文本分块，这样如果电子邮件正文是 900 个字符，则返回 3 个单独的行，每行包含消息的三分之一，并且所有行都包含收件人、发件人、主题等信息。

即）我有这个：

```
sender1      recipient1       subject1       body1(600 characters)
sender2      recipient2       subject2       body2(150 characters) 
```

我要这个：

```
sender1     recipient1        subject1       body1(first 300 characters)
sender1     recipient1        subject1       body1(next 300 characters)
sender2     recipient2        subject2       body2(150 characters) 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:15:25.737

这是一种方法的示例：

```
SELECT p.i, SUBSTR(e.body,p.i*n.len+1,n.len) AS bodypart
  FROM ( SELECT 'abcdefghijklmnopqrstuvwxyz' AS body
       ) e
 CROSS
  JOIN ( SELECT 10 AS len
       ) n
  JOIN ( SELECT 0 AS i UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
                       UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
                       UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
       ) p
    ON p.i <= LENGTH(e.body) DIV n.len 
```

该查询最多拆分十 (10) 个部分`n.len`，长度不超过字符。

要使零件的长度达到 300 个字符，请将文字 10 更改为 300，或者您想要的任何最大大小。要返回更多部分，您可以修改别名为 p 的内联视图以返回一组整数 0 到您需要的最大部分数。要让它针对您的表运行，您可以将别名为`e`包含该`body`列的表替换内联视图，并返回您想要的其他列。

像这样的东西：

```
SELECT e.sender
     , e.recipient
     , e.subject
     , SUBSTR(e.body,p.i*n.len+1,n.len) AS bodypart
     , p.i AS bodypart_number
  FROM myemailtable e
 CROSS
  JOIN ( SELECT 300 AS len
       ) n
  JOIN ( SELECT 0 AS i UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
                       UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
                       UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9
       ) p
    ON p.i <= LENGTH(e.body) DIV n.len 
```

* * *

## 更新

该查询有一个极端情况，当 LENGTH(e.body) 是 n.len 的偶数倍时，它将返回一个“额外”的空块。一个丑陋的解决方法是更改`ON`​​子句中的谓词：

```
 ON p.i < LENGTH(e.body) DIV n.len 
    OR (p.i = LENGTH(e.body) DIV n.len AND LENGTH(e.body) MOD n.len > 0) 
```

另请注意，如果将`bodypart`表达式的结果存储在 VARCHAR 列中，则将从每个部分中删除任何尾随空格。

# mysql - 多个表之间的求和

> ID：14718360
> 
> 赞同：0
> 
> 时间：2013-02-05T22:40:31.273
> 
> 标签：mysql

我有三张桌子：

```
Services
ID    Name       Price
1     Internet   99.99
2     Phone      49.95
3     TV         159.95

Customers
ID    Name
1     Ryan
2     Simon
3     Jimmy

Customer Services
CustomerID ServiceID
1          1
1          2
2          3 
```

我将如何查询这些表以获取客户名称和客户为其所有服务支付的总价格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:47:45.430

你应该试试 ：

```
SELECT c.name, SUM(s.price) FROM services s
INNER JOIN customer_services sc ON cs.service_id = s.id
INNER JOIN customers c ON c.id = cs.customer_id
GROUP BY c.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:53:24.370

```
select 
   c.name, 
   sum(s.price) 
from ((
   customers c
      inner join custserv cs on cs.cid = c.id )
      inner join services s on s.id = cs.sid )
group by 
   c.id 
```

# javascript - JQuery.getJSON 不提醒 json

> ID：14718365
> 
> 赞同：3
> 
> 时间：2013-02-05T22:40:45.800
> 
> 标签：javascript, jquery, json

我目前在 localhost 中运行：

```
$.getJSON("http://localhost/call", function(json) {
  alert(json.something);
}); 
```

`http://localhost/call`返回`{something:1}`，但没有任何警报。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T22:43:11.743

```
{something:1} 
```

不是一个有效的[JSON](http://en.wikipedia.org/wiki/JSON)字符串，但是

```
{"something":1} 
```

是。

如果您将电话替换为

```
$.ajax({
    url: 'http://localhost/call',
    dataType: 'json',
    success: function(){},
    error: function(xhr, textStatus, errorThrown){
         //you should get a parse error and end up here
    }
}); 
```

你应该在`error`回调中结束。

在你的 php 文件中：

```
header('Cache-Control: no-cache, must-revalidate');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
header('Content-type: application/json');

$arr = array('something' => 1, 'somethingelse' => 2);

echo json_encode($arr); 
```

# sql-server - 一个数据透视表有点组

> ID：14718368
> 
> 赞同：0
> 
> 时间：2013-02-05T22:40:52.240
> 
> 标签：sql-server

我有三个表，表 1：包含客户详细信息，表 2：包含 uniq 代码，表 3：包含每个购买的单件的 1 行。购买的物品数量从 1 到 n。

表 1：随着业务的进行，每隔几分钟导入一次数据 ID、帐户、电子邮件地址、事务 ID

表2：ID，uniqcode

表 3：随着业务的进行，每隔几分钟导入一次数据 ID、帐户、事务 ID、项目

我对递增的 ID 进行连接，这会给我这样的结果： select * from table1 join table3 on table1.transactionID = table3.transactionID join table2 on on table3.ID = table2.ID

这导致：

emailaddress1, item1, uniqcode1 emailaddress1, item2, uniqcode2 emailaddress1, item3, uniqcode3 emailaddress2, item1, uniqcode4 emailaddress2, item2, uniqcode5

我想得到这样的结果 emailaddress1, item1, uniqcode1, item2, uniqcode2, item3, uniqcode3 emailaddress2, item1, uniqcode4, item2, uniqcode5, null, null

为什么麻烦？因为我们的bulkmailer 只能处理“平面”表格，我想发送1 封电子邮件，其中包含他们有权收到的uniq 代码数量（他们每购买一件商品都会收到1 个），而不是包含单个代码。代码由第三方提供。所有这些都需要在 mssql 中完成。将使用一个视图让批量邮件程序认为它实际上是在查看单个表。

我怎样才能做到这一点？？？

# sass - 使 SASS 生成的行注释从项目根目录而不是文件系统根目录开始

> ID：14718369
> 
> 赞同：5
> 
> 时间：2013-02-05T22:40:58.840
> 
> 标签：sass, compass-sass

对于 SASS 生成的行注释，有没有办法表示从项目根目录而不是文件系统根目录开始的文件位置？

现在我有：

```
file:///Users/user-1/Sites/mysite/sass/_base.scss 
```

拥有它会很棒：

```
sass/_base.scss 
```

所以我们不会遇到像这样的冲突/覆盖：

```
file:///Users/user-1/Sites/mysite/sass/_base.scss
file:///Users/user-2/Sites/mysite/sass/_base.scss 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T20:10:08.707

没有配置选项可以让您让 sass 生成的资产的行注释显示相对于项目根目录的路径。

但是，您似乎在为您的问题寻求错误的解决方案。您面临的问题是，每次不同的用户编译资产时，您最终都会遇到行注释的冲突/覆盖。但是您可能不需要首先将预编译的资产签入您的版本控制系统，如果是这种情况，那么您不应该这样做，并且应该在部署期间坚持预编译它们。

实际上，您还应该在生产中压缩资产，您可以通过将这一行添加到您的`config/environments/production.rb`:

```
config.assets.compress = true 
```

# ruby-on-rails-3 - Rails 3，仅查看日期格式？

> ID：14718370
> 
> 赞同：6
> 
> 时间：2013-02-05T22:40:59.950
> 
> 标签：ruby-on-rails-3

我需要以本地化格式显示日期。即 2013 年 12 月 31 日

因此，我在 config/initializers/datetime_formats.rb 中将默认日期格式设置为该格式

```
Date::DATE_FORMATS[:default]="%m/%d/%Y"
Time::DATE_FORMATS[:default]="%m/%d/%Y %H:%M" 
```

但是，我的测试在单元测试中失败了，因为某些搜索是基于日期格式的。例如

```
>> User.find_by_created_at("#{DateTime.now}")
User Load (2.7ms)  SELECT `users`.* FROM `users` 
WHERE `users`.`created_at` = '02/04/2013 14:43' LIMIT 1 
```

当然，我可以将所有模型更改为使用所有日期或日期时间搜索以使用日期类或日期时间类而不是字符串。但是，我很好奇我们是否可以应用仅查看日期格式或仅查看时间格式。

有没有办法应用仅查看日期（或时间）格式？

- - - 编辑 - - -

我已经有自定义方法 l_or_none 用于具有异常处理的视图。

```
def l_or_none(object)
  l(object) rescue ''
end 
```

我只是不想在所有视图中重复此方法，并寻找一种方法，“如果在视图中调用 Date#to_s，则以这种方式格式化”，而不使用我自己的方法。

为什么我们没有这样的概念？

“如果在视图下使用此对象，请以这种方式覆盖方法”

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-13T14:25:13.457

您可以使用导轨的本地化：

`config/locales/en-US.yml`

```
date:
  formats:
    default: "%m/%d/%Y"
    short: "%m/%d"
datetime:
  formats:
    default: "%m/%d/%Y %H:%M"
    short: "%H:%M"
    notime: "%m/%d/%Y" 
```

在视图中：

```
<%= l(@entry.created_at) %>
<%= l(@entry.created_at, :format => :short) %>
<%= l(@entry.created_at, :format => :notime) %> 
```

结果：

```
02/13/2013 15:24
15:24
02/13/2013 
```

[http://guides.rubyonrails.org/i18n.html](http://guides.rubyonrails.org/i18n.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:35:43.790

试试这个，也许事情会好起来的：

```
User.find_by_created_at(DateTime.now) 
```

# asp.net - ConnectionString 对象实例化

> ID：14718372
> 
> 赞同：0
> 
> 时间：2013-02-05T22:41:05.490
> 
> 标签：asp.net, .net

我应该在何时何地存储和实例化要在 ASP.NET WebApp UI 层中使用的 ConnectionString（从 web.config 获取）对象，通过业务层和数据访问层传递（所有层都是不同的项目/dll ）。

我知道要创建它并访问它，我只是想知道最佳实践是 Global.asax 属性 ConnectionString 吗？何时实例化（Application_Start，Session_Start）？会话项目？

感谢阅读，请大声说出你的意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T11:59:21.477

让您的 DAL 从您的 UI web.config 中读取您的连接字符串。您的表示层和业务层不需要知道您的数据库连接字符串，也不应该在层之间传递。所以你可以在 DAL 中初始化它或者把它放在构造函数中。请记住为您在 DAL 中调用的每个方法打开和关闭您的连接。

# c# - 找到最高的总和值并取 3

> ID：14718374
> 
> 赞同：1
> 
> 时间：2013-02-05T22:41:23.503
> 
> 标签：c#, .net, linq, nhibernate

我有这段代码（不确定它是否有效，因为我无法测试它）：

```
var test = base.UnitOfWork.Session.Query<NutritionFact>()
                                  .Where(x => x.NutritionalServing.Id == servingId)
                                  .GroupBy(x => x.UserVerifiedFacts)
                                  .OrderByDescending(x => x.Sum(e => e.UserVerifiedFacts.Count()))
                                  .Take(3)
                                  .Select(r => new
                                      {
                                          c = r.Key,
                                          Sum = r.Sum(x => x.UserVerifiedFacts.Count())
                                      })
                                  .ToList(); 
```

我想做的是找到所有`NutritionFacts`正确的`servingId`. 然后，我想为每个`NutritionFacts`发现的用户计算验证信息的用户数。然后我想获得前 3 个结果并使用它们。

我现在所做的会导致“未实现”错误，这显然是因为 nhibernate sum 只能处理任何参数。

![在此处输入图像描述](../Images/7ae10f241fcdada8fe2e7bb15a6ddb26.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:06:15.900

我会尝试：

```
var test = ...Query<NutritionFact>()
             .Where(x => x.NutritionalServing.Id == servingId)
             .Select(x=> new { Nf= x, VfCount= x.UserVerifiedFacts.Count() })
             .OrderByDescending(x => x.VfCount))
             .Take(3)
             .ToList(); 
```

你不需要使用`Sum`. `Sum`用于聚合（汇总）分组列，但您只需要相关`Count()`表中每个特定的行数`NuturitionFact`。

*它对应于这个 SQL 语句（我想这就是你需要的）*

```
SELECT TOP 3 n.*, 
       (SELECT COUNT(*) FROM UserVerifiedFact uv WHERE uv.NuturitionFacts_Id = n.Id) AS NumbOfVer  
       FROM NutritionFact n 
       WHERE n.NutritionalServing_Id = @servingId
       ORDER BY NumbOfVer DESC 
```

# objective-c - UIImageView 动画不在屏幕上时是否运行

> ID：14718377
> 
> 赞同：1
> 
> 时间：2013-02-05T22:41:44.017
> 
> 标签：objective-c, animation, uiimageview, background-process

在我的应用程序中，我使用几个 UIImageViews 来制作图像动画。对于这些 UIImageViews 我调用`startAnimating`并无限期地循环动画。我的应用程序包含许多不同的视图，并且很多时候这些 UIImageViews 不在屏幕上。此外，我的应用程序在后台运行。我的问题是，如果对于这些我从未调用过`stopAnimating`的 UIImageViews，即使 UIImageViews 不在屏幕上（即它们的超级视图不在屏幕/隐藏或应用程序在后台），视图是否会继续动画并消耗处理能力？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:47:14.523

老实说，我不确定，但我确实在苹果文档中找到了这个

> 隐藏视图
> 
> 要在视觉上隐藏视图，您可以将其 hidden 属性设置为 YES 或将其 alpha 属性更改为 0.0。隐藏视图不接收来自系统的触摸事件。但是，**隐藏视图确实参与了与视图层次结构相关的自动调整大小和其他布局操作**。因此，隐藏视图通常是从视图层次结构中删除视图的便捷替代方法，特别是如果您计划在不久的某个时候再次显示视图。

[我在这里](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/CreatingViews/CreatingViews.html)通读了文档，但找不到任何可以保证可靠答案的东西。我记得通过我不久前观看的斯坦福在线课程，根本没有绘制隐藏视图以保持处理能力。但是被跟踪（如上所述）。话虽如此，我通常认为Apple会以有效的方式处理此问题，但不确定。

如果您想要一个更明确的答案，您可以为一堆视图设置动画并使用工具跟踪它们以查看它们消耗了多少。

# .net-4.5 - .NET 中哪些有序对象类似于 Hashtable？

> ID：14718379
> 
> 赞同：2
> 
> 时间：2013-02-05T22:41:56.343
> 
> 标签：.net-4.5

我们正在将 WCF 服务从 .NET 4.0 迁移到 .NET 4.5。[.NET Framework 4.5 文章中的](http://msdn.microsoft.com/en-us/library/hh367887%28v=VS.110%29.aspx)此应用程序兼容性规定如下：

> 在 .NET Framework 4.5 下序列化的 Hashtable 和类似的有序集合对象不能在 .NET Framework 4 下反序列化。

“类似的有序集合对象”涵盖了哪些其他对象？

# javascript - 如何将 SVG 元素绑定到数据？

> ID：14718381
> 
> 赞同：0
> 
> 时间：2013-02-05T22:42:11.113
> 
> 标签：javascript, svg

我正在寻找有关我设计 Javascript/SVG 界面的编码技术的反馈。我是这些语言的新手，因为我最近放弃了 Adob​​e Flex 的专长。

该软件将是一个通用接口，用于将源信号映射到目标信号。连接由网格表示，行/列代表源/目标信号：

```
XXXX | 目的地A
XOXX | 目的地B
XXXX | 目的地C
XXXX | 目的地 D
---------
1 2 3 4

```

在这个美丽的图中，“0”表示源“信号 2”映射到“目标 B”。

我关心将数据（连接对象）绑定到视图（SVG 元素）。我是这样做的：

数据存储在二维数组中：connections[nSources][mDestinations]

在视图中，对于二维连接数组中的每个项目，我创建一个 SVG 元素，其 ID 为“celln,m”（“n,m”对应于它的行/列索引）并将其添加到 DOM。我发现这是访问任何 SVG 元素的一种非常简单的方法，通过使用 document.getElementById(...)，或者通过解析“evt.target.id”字符串来查找用户单击的行/列。

第一次实施效果很好。但我很担心，因为接口需要支持处理动态数据......源/目标信号将即时添加或删除。用户可以重新排列行和列。并且它需要支持将信号分组到可扩展和可折叠的节点中。

一个简单的例子：如果在索引 0 处添加新行，我需要更新每个 SVG 元素的 ID 以将其行增加 1。

我的具体问题：这么多地操作 DOM 元素的 ID 是否可以（良好做法、安全和可靠）？

要查看代码示例（操作 SVG 元素 ID 的函数），请参见此处： [示例](http://six39.com/mcgill/libmappergui/sample.txt)

在 200x200（例如）的网格中，在索引 0 处添加一行意味着更改 40,000 个 SVG 元素的 ID，这似乎很可怕。有没有人看到这有问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:54:54.833

无论如何，您将使用 DOM 操作来实现您的目标。建议：使用MVC模式。每当用户添加/删除行或重新排列它们时，您修改的不是 DOM，而是模型。然后你调用一些重绘SVG的监听器/回调。就我个人而言，我会将整个表（例如，我会将所有行保留在一个 parent`<g>`中）从 DOM 中分离出来（使用`remove`操作或类似的操作。你使用什么库？）。然后，我将在内存中重新创建它，然后才将其附加（`appendChild`到该组）回来。这种方法似乎足够简单和快速。

# javascript - 使用 jquery 和 knockout 过滤和排序 li 标签

> ID：14718385
> 
> 赞同：0
> 
> 时间：2013-02-05T22:42:30.053
> 
> 标签：javascript, jquery, asp.net-mvc, knockout.js

我正在使用 MVC4 生成一个包含许多元素的动态列表。例如，此类的标记如下：

```
 <ul>
<li class="item" data-price="1" data-categoryid="200,300,400">
<!-- further markup -->
</li>
<li class="item" data-price="4" data-categoryid="210,310,400">
<!-- further markup -->
</li>
<li class="item" data-price="3" data-categoryid="220,030,430">
<!-- further markup -->
</li>
<li class="item" data-price="6" data-categoryid="250,300,410">
<!-- further markup -->
</li>
</ul> 
```

上述标记的数据是在页面加载时通过控制器操作的 MVC 模型填充的。

我有很多我想用这个标记实现的事情，我需要帮助。对于初学者，在我的页面上我也有许多与上面的“data-categoryid”属性相对应的复选框。例如，我有复选框 200、300 等。当用户选中这些框中的任何一个时，我只想显示包含 data-categoryid 属性中复选框值的 li 标签？

当用户在其中选择价格时，我也有一个下拉菜单，我希望根据 li 中的“data-price”属性订购 li 标签？

我正在使用 jquery 和淘汰赛（热衷于学习这个），所以希望使用这些来完成这个。

我已将标记添加到[http://jsfiddle.net/tE6fb/](http://jsfiddle.net/tE6fb/)

我必须就上述问题提出进一步的问题。如前所述，我通过控制器返回视图等填充了此类内容。当用户向下滚动页面时，我将使用无限滚动来进行服务器端调用以返回下一个 li 标签列表并将它们附加到上面。我正在考虑易于使用，在服务器上填充部分视图并返回它的内容并附加到标记。

另一种方法是不通过服务器端而是通过客户端在开始时加载标记，并将 li 标签与敲除绑定。但是我担心，通过使用这种方法，第一次加载时页面上没有任何标记，从而导致用户延迟，并且搜索引擎机器人也无法索引此标记。我对上述的理解是正确的还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:50:36.390

[http://api.jquery.com/](http://api.jquery.com/)

```
var $li = $('ul li');
$('input[type=checkbox]').change(function(){
   $li.filter('[data-categoryid*='+ this.value +']').toggle(this.checked);
});

$('select').change(function(){
    $li.sort(function(a, b){
        return a.dataset.price > b.dataset.price 
    }).appendTo('ul');
}); 
```

[http://jsfiddle.net/zPfWj/](http://jsfiddle.net/zPfWj/)

# c - C - 如何将整数值插入数组

> ID：14718389
> 
> 赞同：1
> 
> 时间：2013-02-05T22:42:53.410
> 
> 标签：c

我对这段代码有疑问：

主要的 ：

```
#include <stdio.h>
#include <stdlib.h>
#include "Function.h"
int main()
{

int B[9]; 

saisie_B_M(&B[9]);

return 0;

} 
```

函数.c

```
void saisie_B_M(int B[9])
{

int i;

for(i=0; i<8; i++)
{
    printf("Une cellule morte ayant %d voisins sera t-elle morte ou vivante à la génération suivante ? \n", i);
    scanf("%d", &B[i]);
        }
    } 
```

函数.h

```
#ifndef Function_H_INCLUDED
#define Function_H_INCLUDED
void saisie_B_M(int B[9]);
#endif // Function_H_INCLUDED 
```

原理很简单，它是一个 9 的数组，我只是在表格的每个单元格中返回一个值。但是最后有一个错误，我不知道为什么编译器没有显示消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T22:48:56.967

问题是当你调用你的函数时

> saisie_B_M(&B[9]);

它应该是

> saisie_B_M(B);

在第一种情况下，您给出一个数组，但从第 9 个 offset 开始`B[9]`。所以你的函数将在第 9 次然后第 10 次、第 11 次、第 12 次开始迭代......行为未定义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T22:51:03.810

扩展`@Miguel Prz`的答案，如果您想从第一个元素开始，那么您需要传递对数组中第一个元素的引用：`saisie_B_M(&B[0])`或者您可以只使用`saisie_B_M(B)`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T22:46:05.553

C 中的数组是零索引的，因此 B[9] 的元素在 0..8 范围内。这是无效的：

```
saisie_B_M(&B[9]); 
```

如果你想将指针传递给你需要使用的最后一个元素：

```
saisie_B_M(&B[8]); 
```

但似乎您需要完整的数组，因此将 &B[0] （或简单的 B）传递给 saisie_B_M 函数。您的“for”循环也应更改为：

```
for(i=0; i<9; i++) {
/* ... */
} 
```

# php - 为我的 PHP 脚本创建 API - 文件上传

> ID：14718392
> 
> 赞同：8
> 
> 时间：2013-02-05T22:43:09.317
> 
> 标签：php, api, file, file-upload, upload

好的，这里是：（我正在第三次更改此帖子的内容以更好地解释）

*我的网站是一个**图片托管**网站，这意味着用户可以上传到我的网站并接收到他/她上传的图片的直接链接。*

我需要某种 API/方式来从我的网站与我的用户进行交流。我希望注册到我网站的用户能够将图像从他们的网站**上传到我的****图像主机**，而无需离开他们自己的网站（AJAX、iFrame、cURL、JSON，无论需要什么）。

对我的网站的请求应该包含一个`&request=api`参数，以便用户从我的 upload.php 脚本中获取纯文本。通过这种方式，我认为我可以确保以更简单的方式从我的站点获取数据/输出。

因此，基本上，在用户站点向我的**Image Host发出 POST/FILES 请求****后**，他们会从我的上传处理脚本接收链接，他们需要检索这些链接，然后将其用于自己的需要。

 ****我的问题是：**我的**注册用户在****不**重新加载页面的情况下将文件发送到我的服务器并取回该图像的 URL。我该怎么做呢？

# 我试过的：

我所有的尝试都是阻塞，没有继续。

首先，我在两个不同的表中添加了两个新列。我的*users 表*收到一`api_key`列，如果用户实际注册它，该列旨在存储 API 密钥。另一列`is_api`被添加到我存储*图像信息*的表中，只有注册用户将他们的图像存储在数据库中。有了这个新列（它是 type `TINYINT`），我想检查来自用户的图像是（或不是）通过 API 添加/上传的。

用户使用以下参数向我的**图像主机**发送请求： `upload.php?submit=true&action=upload&request=api&key=_SOME_API_KEY_`. 我获取 API 密钥并检查它属于谁 -> 根据该密钥检索用户 ID -> 我将图像存储到我的服务器 -> 我将图像信息存储在我的数据库中（现在有一个用户 ID）-> 我`echo`退出网址。

我在这里的失败是：

*   我无法从第 3 方网站异步向我的**Image Host发送****任何内容**
***   我无法收到任何返回到我的第 3 方网站的信息。**

 **为什么会出现这些失败？**因为我不知道如何实现这两个最重要的步骤。**

我停止尝试发送`$_FILES[]`到我的**Image Host**的想法之一是尝试通过**POST将****IMAGE STRING**发送到我的服务器并自己在那里创建图像。我也做不到，这只是一个有时间思考的人的想法。

 **所以，就是这样：我自己没有解决方案的大问题。
如果您需要更多信息以便更轻松地帮助我，请询问。

谢谢你。

## 更新

如果我能以某种方式（异步）接收文件，我会在数据库中使用`is_api`值为**1**的字段将其注册，以通过 API（外部）将其标记为放置。这样，我可以创建一个名为`viewer.php`Maybe 的新文件，它也会接受一些参数`viewer.php?request=api&key=_API_KEY_`，并且它会返回一个 JSON 页面，其中包含该**外部 api**用户指向最新图像的链接。由第 3 方网站通过 JSON 检索页面将非常容易。因此，使用这种方法，我基本上只需要在我的**Image Host**中以某种方式接收图像，并且检索部分不会太难。那么如何通过**POST**向我的**图像主机**发送**图像字符串**？

 ****如果我的这个新想法可以利用，请告诉我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T20:16:06.493

我正在向我的用户提供这样的脚本作为我网站的桥梁：

```
<?php 
$api_key = 'n8N9v0g9e7b1h0H4A7s2t6q5K8f07B6E4a5p2k4D6L2T1G4Y7I3z5Q5';
$uses_ajax = false;
$imgit = array('error' => true);

if (isset($_POST['imgit_request']))
{
    if ($_POST['imgit_request'] == 'upload')
    {
        $post_data = array(
            'submit'  => 'true',
            'action'  => 'upload',
            'request' => 'api',
            'api_key' => $api_key,
            'imagestr' => chunk_split(base64_encode(file_get_contents($_FILES['images']['tmp_name']))),
            'imagemime' => $_FILES['images']['type'],
            'imagename' => $_FILES['images']['name'],
            'imagesize' => $_FILES['images']['size'],
        );  
    }
    else if ($_POST['imgit_request'] == 'remote')
    {
        $post_data = array(
            'submit'  => 'true',
            'action'  => 'remote',
            'request' => 'api',
            'api_key' => $api_key,
            'links'   => $_POST['links'],
        );  
    }

    $curl = curl_init();
    curl_setopt_array($curl, array(
        CURLOPT_RETURNTRANSFER => 1,
        CURLOPT_URL => 'http://dugi/imgitv3/upload.php',
        CURLOPT_CONNECTTIMEOUT => 5,
        CURLOPT_POST => 1,
        CURLOPT_POSTFIELDS => $post_data,
    ));

    $resp = curl_exec($curl);
    curl_close($curl);

    if (strpos($resp, 'http://') !== false)
    {
        $imgit = array(
            'direct' => $resp,
            'thumb' => str_replace('/i/', '/t/', $resp),
            'error' => false,
        );

        if ($uses_ajax)
        {
            echo $imgit['direct'];  
        }
    }
    if (strpos($resp, 'http://') === false)
    {
        $imgit = array(
            'error' => $resp,
        );  
    }
}
?> 
```

然后我根据收到的信息在我的网站上进行其余的处理。一旦我在我的网站上完成了完整的 API CP，我将更新这个答案，使用 API 的网站管理员可以看到哪些图像已通过他的网站上传到我的图像主机。从上面的脚本中，您可以看到一个 API 密钥——它对每个用户都是唯一的，上面的只是一个示例。

对于异步，我通过告诉用户使用*jQuery Form*插件来实现它。这是一个用于提交表单的非常方便的插件，我会向用户展示他们将如何做到这一点。

感谢所有试图帮助我的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T02:39:25.350

尝试使用

```
json_encode() 
```

对于有问题的链接的 php 端（不要忘记包含 JSON mimetype 标头）和

```
$.getJSON() 
```

在接收端使用 jQuery。然后，您可以将生成的链接放在您喜欢的 div 或段落（或其他任何内容）中。如果超链接是已存在的正在更改/更新的超链接，您可以[使用 jQuery 更改超链接](https://stackoverflow.com/questions/179713/how-to-change-the-href-for-a-hyperlink-using-jquery)。

这些链接可能会有所帮助：

[http://www.w3schools.com/jquery/ajax_getjson.asp](http://www.w3schools.com/jquery/ajax_getjson.asp)

[http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T18:59:59.923

请查看我[在 GitHub 上的 RestServer 课程](https://github.com/jakesankey/PHP-RestServer-Class)。它将允许您将任何 PHP 类转换为 RESTful Web 服务（返回 JSON 响应）。JSON 是处理这些类型的响应的方式，RestServer 会在将数据返回给客户端之前将返回对象编码为 JSON。

您可以发出 GET 请求`http://mysite.com/myapi.php?method=sayHello&name=World`，例如查询字符串需要方法名称以及该方法的每个参数。只需将您的请求更改为 POST 并将您的参数包含在 POST 正文中，也可以支持 POST 请求。

它将自动检测请求方法所需的参数。您可以设置一个秘密 API 密钥，并将其作为每个 API 方法的必需参数以进行身份​​验证。

```
class Hello
{
  public static function sayHello($name)
  {
    // RestServer will json_encode this array before returning it to the client.
    return array("Response" => "Hello, " . $name);
  }
}

$rest = new RestServer(Hello);
$rest->handle(); 
```

然后，您只需使用带有 jQ​​uery 的[$.getJSON](http://www.w3schools.com/jquery/ajax_getjson.asp)进行调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T10:58:04.883

如何使用您的 upload.php 通过 POST 从第 3 方站点接收原始请求到您的图像主机，然后在 upload.php 中使用 AJAX 调用将请求路由到另一个页面。这样，它将是异步的。我认为这种方式是可以实现的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T15:55:30.577

听起来他们正在使用网络表单，因此您应该严格使用 POST。如果您希望客户端向您发送字符串，则无法在某处使用脚本（但是为什么要让他们这样做呢？）。

如果他们正在 POST 表单，请使用 POST 方法，然后让服务器端脚本使用 PUT 写入后端 API 服务器，该服务器将返回一个 JSON 页面，其中包含指向最新图像的链接。

如果他们直接写入 API，请遵循相同的约定，除了您的用户将直接使用 PUT（PUT 在 Web 表单中不可用，只有 POST 和 GET）。

编辑：对于使用 HTML5 的客户端，我有一个可能的解决方案。您可以将图像放入 html5 画布并将数据转换为字符串。然后只需抓住该字符串并通过表单发布它。有关如何执行此操作的更多信息，请参阅[此答案。](https://stackoverflow.com/questions/12950465/how-to-get-image-bytes-string-base64-in-html5-jquery-javascript)

```
<label>Image File:</label><br/>
<input type="file" id="imageLoader" name="imageLoader"/>
<canvas id="imageCanvas"></canvas>
<script>
var imageLoader = document.getElementById('imageLoader');
    imageLoader.addEventListener('change', handleImage, false);
var canvas = document.getElementById('imageCanvas');
var ctx = canvas.getContext('2d');

function handleImage(e){
    var reader = new FileReader();
    reader.onload = function(event){
        var img = new Image();
        img.onload = function(){
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img,0,0);
        }
        img.src = event.target.result;
    }
    reader.readAsDataURL(e.target.files[0]);
     /** replace readAsDataURL() with something that will read it to a string.
     Reference: https://developer.mozilla.org/en-US/docs/DOM/FileReader **/
}
</script> 
```

总结一下：将图像放入canvas DOM 元素中，然后将canvas 数据转换为字符串。**********

# c# - WCF Rest WebFaultException 总是返回 202

> ID：14718398
> 
> 赞同：2
> 
> 时间：2013-02-05T22:43:29.743
> 
> 标签：c#, .net, wcf, wcf-rest

当我的代码中有异常时，我想将其作为 FaultException/WebFaultException 返回，具体取决于它是 REST 还是 SOAP。以下问题与我的项目的 REST 组件有关。触发了异常，我在调试窗口中看到了它（见图）。

![在此处输入图像描述](../Images/aca6368f37f3f3a52b87e41021536dff.png)

我们清楚地看到 WebFaultException 正在被触发，但我在 JSON 中的响应不是 http badrequest 也不是我的异常消息，而是始终如下：

```
{"readyState":4,"responseText":"","status":202,"statusText":"Accepted"} 
```

这是我的界面：

```
[WebInvoke(Method = "POST", UriTemplate = "/Package/", BodyStyle = WebMessageBodyStyle.Wrapped, ResponseFormat = WebMessageFormat.Json)]
[FaultContract(typeof(FaultException))]
[OperationContract]
string CopyZip(Stream zippedPackage); 
```

这是它的实现：

```
public string CopyZip(Stream zippedPackage)
{
   try
   {
      ZipCreator pck = new ZipCreator();
      pck.CopyUploadedZip(zippedPackage);
      return "Zipped";
   }
   catch (Exception ex)
   {
   //throw new FaultException(ex.Message);
      throw new WebFaultException<string>(ex.Message,             HttpStatusCode.BadRequest);
   } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-05T18:00:57.043

我看过一些关于 WcfRestContrib 自定义错误处理的问题的帖子。在这些情况下，将服务类属性从 [ServiceConfiguration("Rest", true)] 更改为 [ServiceConfiguration("Rest", false)] 最终解决了问题。或者，您可以将其保留为 true，并尝试使用 WebException 而不是 WebFaultException，如下所示

```
throw new
    WcfRestContrib.ServiceModel.Web.Exceptions.WebException(HttpStatusCode.BadRequest, "My custom error!"); 
```

# objective-c - 带有数千个对象的 OS X 上的 SceneKit

> ID：14718407
> 
> 赞同：8
> 
> 时间：2013-02-05T22:44:13.970
> 
> 标签：objective-c, cocoa, scenegraph, scenekit

我正在关注本教程：[http ://blog.bignerdranch.com/754-scenekit-in-mountain-lion/](http://blog.bignerdranch.com/754-scenekit-in-mountain-lion/)

我对使用 Scene Kit 很感兴趣，但我的场景可能有数千个球体。为了对 Scene Kit 进行压力测试，我尝试了这个：

```
SCNSphere *sphere = [SCNSphere sphereWithRadius:0.5];
for (int i=0; i<10; i++) {
    for(int j=0; j<10; j++){
        for(int k=0; k<10; k++){
            SCNNode *myNode = [SCNNode nodeWithGeometry:sphere];
            myNode.position = SCNVector3Make(i,j,k);
            [root addChildNode:myNode];
        }
    }
} 
```

例如，这适用于 1000 个球体 (10^3)​​，但对于 1,000,000 个球体 (100^3) 则失败（可能不足为奇）。我不介意不能使用一百万个球体，但我想弄清楚合理的上限是多少（5,000？15,000？）以及如何增加它。

我能做些什么来减轻这种情况？例如，我尝试了 sphere.segmentCount = 3，虽然这可以加快渲染速度，但它对内存使用没有太大影响，我怀疑这是限制因素。

此外，似乎没有 SCNPoint 类。我正在考虑在球体数量过多时切换到仅显示一个点，但是我无法从 SceneKit 文档中看到如何显示一个简单的点——我能看到的最简单的是一个三角形。

任何帮助深表感谢。

**编辑：** @toyos 建议将 SCNSphere 对象合并到单个 SCNGeometry 对象中（前提是它们不需要独立动画，它们不需要），但我找不到一个简单的方法来做到这一点。

SCNGeometry 是通过使用[此处](https://developer.apple.com/library/mac/#documentation/SceneKit/Reference/SCNGeometry_Class/Reference/SCNGeometry.html)`[SCNGeometry geometryWithSources:(* NSArray)sources geometryWithElements:(* NSArray) elements]`记录的方法创建的，但我不清楚如何从我的球体创建对象。`SCNGeometry`

例如对于单个球体，我可以看到使用`sphere.geometryElementCount`来获取元素的数量，然后使用它来填充一个数组，使用`[sphere geometryElementAtIndex:(NSInteger)elementIndex]`它会给我元素，但我不确定如何获取“源”（或者它们甚至是）。获取几何源的方法是`[sphere geometrySourcesForSemantic:(NSString*) semantic]`，但是这个语义字符串是什么？（它的意思是“法线”或“顶点”还是别的什么？文档很有帮助地说语义是“几何源的语义值。”没有说明语义的可能值是什么）

这只是针对单个球体，这将是毫无意义的（因为无论如何`SCNSphere`只是一个子类`SCNGeometry`），所以现在我必须添加多个球体。那么在将球体的顶点添加到我的`SCNGeometry`对象时，我是否必须手动平移它们？

我只是想找出最明智的方法来做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T14:26:46.427

语义字符串是 SCNGeometrySourceSemanticVertex|Normal|Texcoord ...

对于多个球体，答案是肯定的，您必须在展平之前使用当前节点变换来变换顶点/法线。

下面是一个简化的示例（即，如果它们都具有相同的几何形状，它只支持合并“输入”的孩子）

```
- (SCNNode *) flattenNodeHierarchy:(SCNNode *) input
{
    SCNNode *result = [SCNNode node];

    NSUInteger nodeCount = [[input childNodes] count];
    if(nodeCount > 0){
    SCNNode *node = [[input childNodes] objectAtIndex:0];

        NSArray *vertexArray = [node.geometry geometrySourcesForSemantic:SCNGeometrySourceSemanticVertex];
        SCNGeometrySource *vertex = [vertexArray objectAtIndex:0];

        SCNGeometryElement *element = [node.geometry geometryElementAtIndex:0]; //todo: support multiple elements
        NSUInteger primitiveCount = element.primitiveCount;
        NSUInteger newPrimitiveCount = primitiveCount * nodeCount;
        size_t elementBufferLength = newPrimitiveCount * 3 * sizeof(int); //nTriangle x 3 vertex * size of int
        int* elementBuffer = (int*)malloc(elementBufferLength);

        /* simple case: here we consider that all the objects to flatten are the same
         In the regular case we should iterate on every geometry and accumulate the number of vertex/triangles etc...*/

        NSUInteger vertexCount = [vertex vectorCount];
        NSUInteger newVertexCount = vertexCount * nodeCount;

        SCNVector3 *newVertex = malloc(sizeof(SCNVector3) * newVertexCount);        
        SCNVector3 *newNormal = malloc(sizeof(SCNVector3) * newVertexCount); //assume same number of normal/vertex

        //fill
        NSUInteger vertexFillIndex = 0;
        NSUInteger primitiveFillIndex = 0;
        for(NSUInteger index=0; index< nodeCount; index++){
            NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

            node = [[input childNodes] objectAtIndex:index];

            NSArray *vertexArray = [node.geometry geometrySourcesForSemantic:SCNGeometrySourceSemanticVertex];
            NSArray *normalArray = [node.geometry geometrySourcesForSemantic:SCNGeometrySourceSemanticNormal];
            SCNGeometrySource *vertex = [vertexArray objectAtIndex:0];
            SCNGeometrySource *normals = [normalArray objectAtIndex:0];

            if([vertex bytesPerComponent] != sizeof(float)){
                NSLog(@"todo: support other byte per component");
                continue;
            }

            float *vertexBuffer = (float *)[[vertex data] bytes];
            float *normalBuffer = (float *)[[normals data] bytes];

            CATransform3D t = [node transform];
            GLKMatrix4 matrix = MyGLKMatrix4FromCATransform3D(t);

            //append source
            for(NSUInteger vIndex = 0; vIndex < vertexCount; vIndex++, vertexFillIndex++){
                GLKVector3 v = GLKVector3Make(vertexBuffer[vIndex * 3], vertexBuffer[vIndex * 3+1], vertexBuffer[vIndex * 3 + 2]);
                GLKVector3 n = GLKVector3Make(normalBuffer[vIndex * 3], normalBuffer[vIndex * 3+1], normalBuffer[vIndex * 3 + 2]);

                //transform
                v = GLKMatrix4MultiplyVector3WithTranslation(matrix, v);
                n = GLKMatrix4MultiplyVector3(matrix, n);

                newVertex[vertexFillIndex] = SCNVector3Make(v.x, v.y, v.z);
                newNormal[vertexFillIndex] = SCNVector3Make(n.x, n.y, n.z);
            }

            //append elements
            //here we assume that all elements are SCNGeometryPrimitiveTypeTriangles
            SCNGeometryElement *element = [node.geometry geometryElementAtIndex:0];
            const void *inputPrimitive = [element.data bytes];
            size_t bpi = element.bytesPerIndex;

            NSUInteger offset = index * vertexCount;

            for(NSUInteger pIndex = 0; pIndex < primitiveCount; pIndex++, primitiveFillIndex+=3){                
                elementBuffer[primitiveFillIndex] = offset + _getIndex(inputPrimitive, bpi, pIndex*3);
                elementBuffer[primitiveFillIndex+1] = offset + _getIndex(inputPrimitive, bpi, pIndex*3+1);
                elementBuffer[primitiveFillIndex+2] = offset + _getIndex(inputPrimitive, bpi, pIndex*3+2);
            }

            [pool drain];
        }

        NSArray *sources = @[[SCNGeometrySource geometrySourceWithVertices:newVertex count:newVertexCount],
                             [SCNGeometrySource geometrySourceWithNormals:newNormal count:newVertexCount]];

        NSData *newElementData = [NSMutableData dataWithBytesNoCopy:elementBuffer length:elementBufferLength freeWhenDone:YES];
        NSArray *elements = @[[SCNGeometryElement geometryElementWithData:newElementData
                                                            primitiveType:SCNGeometryPrimitiveTypeTriangles
                                                           primitiveCount:newPrimitiveCount bytesPerIndex:sizeof(int)]];

        result.geometry = [SCNGeometry geometryWithSources:sources elements:elements];

        //cleanup
        free(newVertex);
        free(newNormal);
    }

    return result;
}

//helpers:
GLKMatrix4 MyGLKMatrix4FromCATransform3D(CATransform3D transform) {
    GLKMatrix4 m = {{transform.m11, transform.m12, transform.m13, transform.m14,
        transform.m21, transform.m22, transform.m23, transform.m24,
        transform.m31, transform.m32, transform.m33, transform.m34,
        transform.m41, transform.m42, transform.m43, transform.m44}};
    return m;
}

GLKVector3 MySCNVector3ToGLKVector3(SCNVector3 vector) {
    GLKVector3 v = {{vector.x, vector.y, vector.z}};
    return v;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-05T19:30:24.547

如何最好地做到这一点取决于您要完成的工作。

这数千个点（也许是外太空场景的星空背景）是静态的，还是需要相对于彼此移动？它们真的需要是球体吗？他们需要多少细节？

如果它们不需要独立移动，将它们合并成一个几何体是个好主意。在 Mavericks (OS X 10.9) 上，您不需要自己弄乱几何数据来做到这一点 - 为每个节点创建一个节点，然后将它们全部作为单个节点（不是场景的根节点）的父节点，然后调用`flattenedClone`以获取该节点的几何图形组合的副本。

如果他们不需要太多的细节，有几个选项可以提高性能。

一种是减少`segmentCount`球体的几何形状——你不需要 5000 个三角形来绘制一个在渲染时只有几个像素宽的球体，这与默认段数 48 所得到的差不多。（如果在减少段数后，您将立即弄乱几何数据或展平节点，请务必调用`[SCNTransaction flush]`以确保它得到更新。）

另一个是进一步减少三角形数量。恒星（或其他）是否足够小以至于它们甚至需要成为球体？如果您的场景可以设置为始终朝向相机，则`SCNPlane`可能会更好——它的最小段数只有两个三角形。

他们甚至需要是三角形吗？Scene Kit 可以渲染点——它们没有`SCNGeometry`子类，因为独立定位和转换单个点通常没有用。但是您可以使用顶点位置数组和`SCNGeometryPrimitiveTypePoint`几何元素类型创建自定义几何。如果您想自定义单点的渲染，您可以将着色器（或着色器修改器）附加到几何体。

# pywin32 - PyInstaller 无法识别下载的 pywin32

> ID：14718414
> 
> 赞同：8
> 
> 时间：2013-02-05T22:44:38.790
> 
> 标签：pywin32, pyinstaller

我已经下载了Python 2.7.3、PyInstaller（与2.7兼容）和pywin32（与2.7兼容）并重新启动了我的机器，但是当我进入提示时：

pyinstaller.py [选择] nameofscript.py

然后提示告诉我：

错误：Windows 上 Python 2.6+ 的 PyInstaller 需要 pywin32。请从[http://sourceforge.net/projects/pywin32/安装](http://sourceforge.net/projects/pywin32/)

为什么 PyInstaller 不能“看到”我已经下载了 pywin32？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-12-05T20:01:48.280

如果您使用的是 Python 2.7，则需要将 C:/Python27/Lib/site-packages/PyInstaller 文件中的 compat.py 更改为：

```
if is_win:
try:
    #from win32ctypes.pywin32 import pywintypes  # noqa: F401
    #from win32ctypes.pywin32 import win32api
    import pywintypes
    import win32api
except ImportError:
    # This environment variable is set by seutp.py
    # - It's not an error for pywin32 to not be installed at that point
    if not os.environ.get('PYINSTALLER_NO_PYWIN32_FAILURE'):
        raise SystemExit('PyInstaller cannot check for assembly dependencies.\n'
                         'Please install PyWin32 or pywin32-ctypes.\n\n'
                         'pip install pypiwin32\n') 
```

为了工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T17:33:00.260

知道了！找到了这个有用的教程：

[http://bojan-komazec.blogspot.ca/2011/08/how-to-create-windows-executable-from.html](http://bojan-komazec.blogspot.ca/2011/08/how-to-create-windows-executable-from.html)

第三段告诉你如何解决这个问题。他指向的链接虽然很棘手。你需要去这里获取 pywin32 安装程序。

[http://sourceforge.net/projects/pywin32/files/pywin32/Build%20218/](http://sourceforge.net/projects/pywin32/files/pywin32/Build%20218/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-07T01:04:27.833

您应该先将 pywin32 安装到 Python 路径，然后通过运行以下 Python 命令验证它是否成功：

```
import win32com 
```

如果没有错误，则安装 pywin32。

# ios - iOS 故事板中按钮的大小相同

> ID：14718422
> 
> 赞同：1
> 
> 时间：2013-02-05T22:45:20.313
> 
> 标签：ios, xcode, uistoryboard, xcode-storyboard

我想知道如何自动 - 如果有办法 - 设置按钮的宽度，使它们的大小都相同，并且情节提要两侧的边距相同。在屏幕截图中，你们可以看到按钮的大小不同：

![在此处输入图像描述](../Images/5e549b0cec1a1b6b95b3a69059415c55.png)

中间有一个空间，我希望它作为每个按钮之间的空间。有没有办法做到这一点？

提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:21:09.273

不，没有自动的方法可以做到这一点。使按钮的大小都相同很容易——你可以拖出一个，按你想要的大小调整它，然后复制它（command-d）任意多次，或者你可以全部选择它们并调整它们的大小尺寸检查员。获得相同的间距更加繁琐，特别是如果您想处理旋转（最好在使用布局约束的代码中处理）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-05T16:10:46.857

1) 转到您希望所有按钮大小相同的按钮的尺寸检查器，并记下或记住该按钮的高度和宽度。

2）cmd点击所有大小不正确的按钮

3）到inspector处，将hight和width更改为button的height和width是step 1，并且所有button的大小应该相同。

# asp.net-mvc-4 - 无法让 MVC 4 FileExtensions 属性在 ViewModel 属性上工作

> ID：14718425
> 
> 赞同：8
> 
> 时间：2013-02-05T22:45:26.313
> 
> 标签：asp.net-mvc-4, data-annotations

我需要上传一个 csv 文件，并且我想将它的扩展名限制为 .csv

所以我在我的 ViewModel 中添加了以下属性：

```
[FileExtensions(ErrorMessage = "Must choose .csv file.",Extensions = "csv,txt")]
public HttpPostedFileBase File { get; set; } 
```

在我看来，我有以下几点：

```
@Html.TextBoxFor(m => m.File, new { type = "file"})
@Html.ValidationMessageFor(m => m.File) 
```

但是，一旦它点击我的“ModelState.IsValid”检查，它就会返回无效，并显示我的错误消息“必须选择 .csv 文件”。

我假设我只是缺少一个参数，但我还没有在任何地方找到这个使用的样本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T22:12:36.353

问题是 FileExtensionsAttribute 仅适用于字符串变量。检查 HttpPostedFileBase 变量的文件扩展名的最简单方法是使用[这个简单的属性](https://stackoverflow.com/a/13650754/1838837)。它解决了我的问题。

唯一的缺点是这个新属性只在服务器端验证，所以不要忘记检查模型状态：

```
if (ModelState.IsValid)
{
  // Do the work
} 
```

# facebook-opengraph - 打开图发布返回“内部服务器错误 500”

> ID：14718426
> 
> 赞同：3
> 
> 时间：2013-02-05T22:45:30.757
> 
> 标签：facebook-opengraph, publishing

我想发布一个动态创建的操作，例如在[https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/publish-open-graph-story/](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/publish-open-graph-story/)中：

```
 <?php
`function curPageURL() {`
 `$pageURL = 'http://';`
` if ($_SERVER["SERVER_PORT"] != "80") {` 
 `$pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
 } else {`
 `$pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
 }` 
 `return $pageURL;
}
?>`

`<html>`<html>
  `<head prefix="og: http://ogp.me/ns# product: http://ogp.me/ns/product#">
    <meta property="fb:app_id" content="<?php echo strip_tags($_REQUEST['fb:app_id']);?>">`
   `<meta property="og:url" content="<?php echo strip_tags(curPageURL());?>">
      <meta property="og:type" content="<?php echo strip_tags($_REQUEST['og:type']);?>">
      <meta property="og:title" content="<?php echo strip_tags($_REQUEST['og:title']);?>">
      <meta property="og:image" content="<?php echo strip_tags($_REQUEST['og:image']);?>">
      <meta property="og:description" content="<?php echo strip_tags($_REQUEST['og:description']);?>">
      <title>Product Name</title>
  </head>`   
  `<body>
      <?php echo strip_tags($_REQUEST['body']);?>
    </body>
</html>` 
```

facebook 对象调试器（[http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)）返回我的对象​​是好的，但是当我尝试通过我的 iOS 应用程序发布它时，我得到一个响应“内部服务器错误 500”

```
object url:
`http://wl.uasoft.net/wishobject.php?fb:app_id=437320636331183&og:type=mytestbiaka:wish&og:title=wishik&og:description=MyTestBiaka%20app&og:image=http%3A%2F%2Fsilkdream.ru/pict/mult-pict.narod.ru276_small.jpg&body=Wish`

request to fb:
`https://graph.facebook.com/me/mytestbiaka:add?wish=http://wl.uasoft.net/wishobject.php?fb:app_id=437320636331183&og:type=mytestbiaka:wish&og:title=wishik&og:description=MyTestBiaka%20app&og:image=http%3A%2F%2Fsilkdream.ru/pict/mult-pict.narod.ru276_small.jpg&body=Wish&access_token=ACCESS_TOKEN 
```

`

有人收到这样的错误吗？

# mongodb - MongoDb 读取从处于 RECOVERY 状态的辅助节点发生

> ID：14718428
> 
> 赞同：0
> 
> 时间：2013-02-05T22:45:40.960
> 
> 标签：mongodb

我有一个副本集，其中添加了一个新的辅助节点。该节点状态为“正在恢复”。当我尝试使用 Nearest 作为 ReadPreference 执行 java 驱动程序客户端时，一些读取将进入正在同步并引发异常的辅助。

驱动程序是否应该足够智能，不会向处于“正在恢复”状态的辅助节点发出读取请求？还是我错过了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T02:24:35.590

实际上，驱动程序不应该向处于 RECOVERING 状态的节点发送请求。我创建了一个 Jira 票来跟踪这个错误：

[https://jira.mongodb.org/browse/JAVA-753](https://jira.mongodb.org/browse/JAVA-753)

# jenkins - 哈德逊到詹金斯的迁移

> ID：14718437
> 
> 赞同：1
> 
> 时间：2013-02-05T22:46:11.580
> 
> 标签：jenkins, hudson

我正在尝试从哈德逊迁移​​到詹金斯。我的意图是保持 hudson 服务器启动并在新端口上启动 jenkins 并在 jenkins 上手动创建作业。但是，当我使用 安装 jenkins 时`sudo apt-get install jenkins`，会卸载 hudson。有没有办法让两者都运行？

`sudo apt-get install hudson`在詹金斯删除它之后，我尝试使用它来安装哈德森；试图让两者都运行。但是安装 hudson 也会删除 jenkins，我又回到了第 1 格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:13:43.253

这两个 Debian 软件包被标记为相互冲突；这就是为什么安装一个会删除另一个。

您可以做的是下载常规 Jenkins WAR 文件并手动启动，指定新端口，例如：

```
java -jar jenkins.war --httpPort=9090 
```

但请注意，Hudson 默认可能会将其配置保存在`/var/lib/hudson`Jenkins 中，以帮助您无缝迁移，可能会自动检测您现有的 Hudson 配置并使用它。

因此，启动 Jenkins 可能会显示您现有的 Hudson 配置，并且您在 Jenkins UI 中所做的任何更改都可能会对您正在运行的 Hudson 安装产生不利影响。所以你可能想强制 Jenkins 使用不同的配置目录来保持两台服务器完全分开。

您可以通过指定`JENKINS_HOME`包含您要使用的路径的环境变量来做到这一点。

# stdout - 操作标准输出：控制和过滤它

> ID：14718441
> 
> 赞同：0
> 
> 时间：2013-02-05T22:46:58.287
> 
> 标签：stdout, ncurses, io-redirection

我已经阅读[了这个 stackoverflow 问题](https://stackoverflow.com/questions/955962/how-to-buffer-stdout-in-memory-and-write-it-from-a-dedicated-thread)，并且我成功地重定向了标准输出。但是上述代码的工作方式，我完全失去了我的终端，这意味着我不能在上面打印任何东西。

我想要实现的是使用 ncurses 格式化我的程序的输出（它将使用我的一些代码和一些我无法修改的库），并有一个窗口可以显示任何虚假的 printf。

有没有办法可以做到这一点？

```
 saved_stdout = dup(STDOUT_FILENO);  /* save stdout for display later $

    if( pipe(out_pipe) != 0 ) {          /* make a pipe */
        exit(1);
    }

    dup2(out_pipe[1], STDOUT_FILENO);   /* redirect stdout to the pipe */
    close(out_pipe[1]);

    initscr();                      /* Start curses mode            */ 
```

这样我就不能在屏幕上打印任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:13:43.797

为了达到我想要的效果，我必须解决一个问题：默认情况下，所有输出函数都使用 STDOUT，并且对于大多数输出​​函数，我无法改变这种行为（想想我没有源代码在 lib 中嵌入 printf ，或 ncurses 本身）。

因此，如果您修改 STDOUT，一切都会受到影响。

但我希望我的程序保留对 STDOUT 的控制。因此，您必须以某种方式将获得真正 STDOUT 的内容和获得*假*STDOUT 的内容分开。分离听起来很像叉子......所以叉子就是这样。

本质上，您在一个子进程中分叉了所有程序的大部分，您为此修改了 STDOUT 管道它。父进程保持对 STDOUT 的控制，并且能够读取管道并对其中的数据执行任何操作。

```
#include <ncurses.h>
#include <unistd.h>
#include <string.h>
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <iostream>
#include <sstream>
#define MAX_LEN 99

WINDOW *create_newwin(int height, int width, int starty, int startx, int vert, int horz);

char buffer[MAX_LEN+1] = {0};
int out_pipe[2];
int saved_stdout;

volatile sig_atomic_t s_interrupted = 0;
volatile sig_atomic_t alarm_expired = 0;

static void s_signal_handler (int signal_value)
{
    if (signal_value == SIGTERM || signal_value == SIGSTOP || signal_value == SIGINT)
        s_interrupted = 1;
    if (signal_value == SIGALRM)
        //signal(SIGALRM,alarm_wakeup);
        alarm_expired = 1;
}

static void s_catch_signals (void)
{
    struct sigaction action;
    action.sa_handler = s_signal_handler;
    action.sa_flags = 0;
    sigemptyset (&action.sa_mask);
    sigaction (SIGINT, &action, NULL);
    sigaction (SIGTERM, &action, NULL);
    sigaction (SIGALRM, &action, NULL);
}

int main (int arg, char **argv) {

    const char mesg[]="Testing stdout redirection";
    WINDOW *my_win, *my_win2;
    int cycle = 0, pid, p[2], row, col;

if(pipe(p) == -1)
{
    perror("pipe call error");
    return(1);
}

    switch (pid=fork())
    {
        case -1: perror("error: fork call");
            return(2);

        case 0:  /* if child then write down pipe */
            if(dup2(p[1], 1) == -1 ) /* stdout == write end of the pipe */
            {
                perror( "dup2 failed" );
                return(1);
            }
            s_catch_signals ();
            setvbuf(stdout, NULL, _IOLBF, 1000);
            while(!s_interrupted)
            {
                printf("Test %d\n",cycle);
                cycle++;
                usleep(10000);
            }
            printf("\n\tChild quitting cleanly\n\n");
            break;
        default:
            s_catch_signals ();
            std::string mystr;
            if(dup2(p[0], 0 ) == -1 ) /* stdin == read end of the pipe */
            {
                perror( "dup2 failed" );
                return(1);
            }
            initscr();              /* start the curses mode */
            getmaxyx(stdscr,row,col);       /* get the number of rows and columns */
            mvprintw(row/2,(col-strlen(mesg))/2,"%s",mesg);
                            /* print the message at the center of the screen */

            refresh();
            my_win2 = create_newwin(10,col,row-10, 0, 0, 0);    
            wrefresh(my_win2);
            my_win = create_newwin(8,col-2,row-9, 1, ' ', ' ');
            wrefresh(my_win);
            wprintw(my_win,"This screen has %d rows and %d columns\n",row,col);
            wprintw(my_win,"Try resizing your window(if possible) and then run this program again\n");
            scrollok(my_win,TRUE);
            int myy,myx;
            std::stringstream ss;
            while(!s_interrupted)
            {
                while( std::getline(std::cin, mystr) )
                {
                    ss.clear();
                    ss << mystr << std::endl;
                    mystr = ss.str();
                    waddstr(my_win,mystr.c_str());
                    wrefresh(my_win);
                }
                usleep(100000);

            }
            endwin();

            break;
    }
    endwin();
    printf("\n\tProgram quitting cleanly\n\n");
    return (EXIT_SUCCESS);
}

WINDOW *create_newwin(int height, int width, int starty, int startx, int vert, int horz)
{   WINDOW *local_win;

    local_win = newwin(height, width, starty, startx);
    box(local_win, vert , horz);        /* 0, 0 gives default characters 
                     * for the vertical and horizontal
                     * lines            */
    wrefresh(local_win);        /* Show that box        */

    return local_win;
} 
```

该程序准确地显示了这种行为：主程序产生一个子程序，它将自己的 STDOUT 重定向到管道。然后，该管道由父级读取，父级将其输出到受控窗口内。屏幕的其余部分可以由父母自由操作，但这是必要的。

```
switch (pid=fork())
{
    case 0:  /* if child then write down pipe */
        if(dup2(p[1], 1) == -1 ) /* stdout == write end of the pipe */
        {
            perror( "dup2 failed" );
            return(1);
        } 
```

当调用 fork 时，如果我们是孩子 (pid==0) 则取我们之前创建的管道，并将我们自己的 STDOUT 切换到该管道的写入端。

```
setvbuf(stdout, NULL, _IOLBF, 1000); 
```

将缓冲模式改为行，这样我们的父级可以更轻松地抓取它。

```
while(!s_interrupted)
{
    printf("Test %d\n",cycle);
    cycle++;
    usleep(10000);
} 
```

生成一些简单的文本来检查它是否有效。

```
 switch (pid=fork())
    {
        default:
        if(dup2(p[0], 0 ) == -1 ) /* stdin == read end of the pipe */
        {
            perror( "dup2 failed" );
            return(1);
        } 
```

如果我们是父级，请将我们的 STDIN 设置为我们之前创建的管道的读取端。

```
 initscr();              /* start the curses mode */
    getmaxyx(stdscr,row,col);       /* get the number of rows and columns */
    mvprintw(row/2,(col-strlen(mesg))/2,"%s",mesg);
                    /* print the message at the center of the screen */

    refresh();
    my_win2 = create_newwin(10,col,row-10, 0, 0, 0);    
    wrefresh(my_win2);
    my_win = create_newwin(8,col-2,row-9, 1, ' ', ' ');
    wrefresh(my_win);
    wprintw(my_win,"This screen has %d rows and %d columns\n",row,col);
    wprintw(my_win,"Try resizing your window(if possible) and then run this program again\n");
    scrollok(my_win,TRUE); 
```

初始化 ncurses 并创建一些窗口。我们使用 my_win2 绘制边框，使用无边框的 my_win 实际包含数据。此外，我们将 my_win 设置为自动滚动，以便我们可以继续在其上打印，而不必担心空间不足。

```
 while( std::getline(std::cin, mystr) )
        {
            ss.clear();
            ss << mystr << std::endl;
            mystr = ss.str();
            waddstr(my_win,mystr.c_str());
            wrefresh(my_win);
        }
        usleep(100000); 
```

在一个轻松节奏的循环中，我们检查我们的 STDIN，如果我们有新的行，我们只需将它们添加到我们的滚动窗口中。因此，当我们的进程被安排在活动状态时，我们会花时间处理大量输出，而不是重复轮询。

这被证明是对所提出问题的有效解决方案。

# php - 使用 javascript/ajax/php 提交 html 表单

> ID：14718446
> 
> 赞同：2
> 
> 时间：2013-02-05T22:47:40.753
> 
> 标签：php, javascript, ajax, onclick, progress-bar

晚上，我似乎遇到了通过 javascript`onclick()`函数提交此 html 表单的问题。这是我第一次尝试这个，我是 js/ajax 的新手，但是根据我对两者的理解，我这样做是正确的......最后这是我的目标：用户输入信息 - javascript/ajax 构造 GET 请求和发送它 - 我的 php 表单将每个输入字段作为自己的查询运行，每次运行查询时，它都会回显进度百分比（在它运行的每个查询之后） - 然后（通过 ajax）将该百分比返回到我的 HTML5进度条（感谢新`<prgress>`标签。）然后创建一个进度条。但是 1\. 我想我可能做错了 2\. 我这样做的方式应该可行 3\. 我已经走到尽头了……

这是我的js：

```
function reply(){
 var total = document.getElementById("setName").name;
  var firstArray = new Array();
   for(i = 1; i <= total; i++){
    firstArray[] = "i = document.getElementById(i)";
   }
  //implode firstArray for uset in $_GET
  //aparently its called join...
  var GET = firstArray.join('&');

    //need to set up xml to run php for query
     if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
       xmlhttp = new XMLHttpRequest();
      }
     else
      {// code for IE6, IE5
       xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
      }

     xmlhttp.onreadystatechange = function(){
       if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
         document.getElementById("progressBar").innerHTML = xmlhttp.responseText;
       }
     };
xmlhttp.open("GET","ajaxQuery.php?"+GET,true);
xmlhttp.send();
} 
```

同样，我是 js/ajax 的新手，但不是 PHP，运行查询不是问题，这部分工作完美无缺，但这甚至不会运行 onclick....

作为旁注，我的输入字段使用数字作为名称属性，以更好地与 js 交互，但这里是 onclick 调用

```
<button type = "button" onClick = "reply()">Submit</button> 
```

我知道这可能会好很多，请随意将其拆开，最好的学习方法是批评错误:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:11:56.063

我试图用 jQuery 重写你的一些代码。它应该可以工作，但我没有测试它：

```
<!--Import jQuery --> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js" type="text/javascript"></script> 
<script type="text/javascript">

    $(function() {
        $("#submitButton").click(function(){
            reply();
        })
    });

    function reply(){
        var total = document.getElementById("setName").name;
        var firstArray = new Array();
        for(i = 1; i <= total; i++){
            firstArray[] = "i = document.getElementById(i)";
        }
        //implode firstArray for uset in $_GET
        //aparently its called join...
        var GET = firstArray.join('&');     

        var jqxhr = $.ajax( {
            type: "GET",
            url: "ajaxQuery.php?"+GET
        } )
        .done(function(data) { 
            $("#progressBar").html( data );    
        });

    }
</script>

<button type = "button" id="submitButton">Submit</button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:18:09.887

要构造查询字符串，您应该执行以下操作：

```
var firstArray = new Array(), qs;

for(i = 1; i <= total; i++){
    firstArray.push('i[]=' + encodeURIComponent(document.getElementById(i).value);
}

// i[]=123&i[]=456&...
qs = firstArray.join('&');

// ...

xmlhttp.open("GET", "ajaxQuery.php?" + qs, true); 
```

顺便说一句，您不应该使用`id`具有以数字开头的属性的元素！

# objective-c - 沙盒：bookmarkDataWithOptions 和错误都是 nil 没有解释

> ID：14718447
> 
> 赞同：2
> 
> 时间：2013-02-05T22:47:42.990
> 
> 标签：objective-c, cocoa, appstore-sandbox

我正在沙箱化我的应用程序。当我打电话时，`-bookmarkDataWithOptions: includingResourceValuesForKeys:relativeToURL:error:`我没有任何解释就收到`nil`了（错误对象`nil`也是）。

*   该应用程序已正确签名
*   我创建了这些权利：

> ```
> <dict>
>   <key>com.apple.security.app-sandbox</key>
>   <true/>
>   <key>com.apple.security.files.user-selected.read-write</key>
>   <true/>
>   <key>com.apple.security.network.client</key>
>   <true/>
>   <key>com.apple.security.files.bookmarks.app-scope</key>
>   <true/>
> </dict>
> </plist> 
> ```

*   我正在使用以下代码创建书签：

> ```
> NSError *error = nil; 
> 
> // nextfile is NSURL and comes from NSOpenPanel
> 
> NSData *fileURLSecureData = [nextFile bookmarkDataWithOptions:NSURLBookmarkCreationWithSecurityScope 
>                                includingResourceValuesForKeys:nil
>                                                 relativeToURL:nil
>                                                         error:&error]; 
> 
> if (error) {
>     ALog(@"Error securing bookmark %@", error);
> } 
> ```

我看到，当我在调试器中单步执行代码时，`fileURLSecureData`并且`error` 都`nil`在执行之后`-bookmarkDataWithOptions: includingResourceValuesForKeys:relativeToURL:error:`

我肯定错过了什么。我已经阅读并重新阅读了论坛和文章，但我无法弄清楚我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:06:57.897

解决了。问题是微不足道的。在 Xcode 中，我无意中取消了 Dev 配置的“Enable Entitlement”的选中，而将其选中了 Release 版本。

# ios - iOS In App Purchase 请求登录两次

> ID：14718454
> 
> 赞同：17
> 
> 时间：2013-02-05T22:48:11.710
> 
> 标签：ios, ios6, in-app-purchase

我正在将应用内购买添加到我的一个应用中。根据需要，我添加了一个按钮，让用户重新下载购买的项目。这是 IBAction 方法：

```
- (IBAction)touchedButtonUnlockAgain:(id)sender {
    [self.activityIndicator startAnimating];            
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
    [[SKPaymentQueue defaultQueue] restoreCompletedTransactions];

} 
```

当我点击这个按钮时，我得到了标准的登录框。我输入了我的 Sandbox 用户名和密码（正确，经过验证）。该登录框消失后，半秒后又重新出现。因此，我使用相同的用户名和密码（正确，经过验证）再次登录，然后重新下载购买。我已经验证它发生在模拟器和设备上（两种情况下都是 iOS 6.0）。

为什么提示我输入用户名/密码两次？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-06-30T13:48:06.527

造成这种情况的唯一原因将是未完成的交易——等待`finishTransaction`赎回召唤的幽灵。它们的存在可能是由于退出的用户发起的交易无法完成 - 或者仅仅是由于应用程序在完成之前突然终止。`addPayment`基本上，对/`restoreCompletedTransactions`的不平衡调用`finishTransaction`可能会导致它们。

检查你的代表：`paymentQueue:RestoreCompletedTransactionsFinished:`&`paymentQueue:restoreCompletedTransactionsFailedWithError:`

你做任何事情两次吗？您收到任何错误吗？

要检查的另一件事是：在您的应用程序生命周期中，您何时调用以下语句？

```
[[SKPaymentQueue defaultQueue] addTransactionObserver] 
```

尽早调用这一点很重要 - 因为有时由于应用程序终止而丢失的交易会再次出现 - 期望完成。如果没有活跃的观察者，他们不会点击 updatedTransactions 方法，这是他们最后`finishTransaction`调用的网关。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-11T20:08:09.930

在您的手机上，尝试进入设置/iTunes & App Stores 并注销那里指定的现有 Apple ID。返回您的应用程序并重试。

# mysql - 没有 JDBC 类型的方言映射：0

> ID：14718456
> 
> 赞同：0
> 
> 时间：2013-02-05T22:48:19.233
> 
> 标签：mysql, spring, hibernate

如果我像这样在休眠中运行查询：

```
sessionFactory.getCurrentSession().createSQLQuery("select 'test' from dual where 1=2").list() 
```

我正确地得到了`size=(0)`.

但是，当我像这样运行休眠查询时：

```
sessionFactory.getCurrentSession().createSQLQuery("select null from dual where 1=2").list() 
```

我收到一条错误消息：“没有 JDBC 类型的方言映射：0”？

我怎样才能修复它，而不是错误我得到结果大小=（0）？

*** 编辑 ***

我在 hibernate.cfg.xml 中为休眠配置了方言，如下所示：

```
<property name="dialect">org.hibernate.dialect.MySQLDialect</property> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-07-25T14:47:30.467

我知道这是一个很晚的答案，但如果有人确实有同样的问题：这里的问题是执行查询：

```
sessionFactory.getCurrentSession().createSQLQuery("select null from dual where 1=2").list() 
```

字段与任何表都不相关，并且始终设置为空。Hibernate 依赖结果集元数据来构造答案......在这种情况下，元数据返回值为 0 的 java.sql.SQLType，因为数据库不知道数据的类型。

一种解决方法是强制转换空值：

```
 sessionFactory.getCurrentSession().createSQLQuery("select CAST(null as char) from dual where 1=2").list() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-05T14:09:46.707

我深入研究了一些意大利面条代码，这些代码需要支持多个数据库和多种我不想弄乱的方言（MySql、Oracle、MS SqlServer）。该代码也在执行本机 sql。我能够成功替换以下内容：

select null 作为 required_field, foo from bar;

和

select '' as required_field, foo from bar;

这是一个黑客，但它进行了一天。

这里似乎讨论了更好的解决方案：

[SQLite - JDBC 类型没有方言映射：0（休眠）](https://stackoverflow.com/questions/10719117/sqlite-no-dialect-mapping-for-jdbc-type-0-hibernate)

[Sqlite & Hibernate Ex：没有 JDBC 类型的方言映射：0](https://stackoverflow.com/questions/25520751/sqlite-hibernate-ex-no-dialect-mapping-for-jdbc-type-0)

[https://code.google.com/p/hibernate-sqlite/issues/detail?id=3](https://code.google.com/p/hibernate-sqlite/issues/detail?id=3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T01:42:20.387

尝试：

```
<property name="hibernate.dialect">org.hibernate.dialect.MySQL5Dialect</property> 
```

# java - Java：InputStream 和 OutputStream 的通用接口

> ID：14718457
> 
> 赞同：4
> 
> 时间：2013-02-05T22:48:24.013
> 
> 标签：java, stream

这个问题（在某种程度上）与[这个](https://stackoverflow.com/questions/14715473/share-stdfstream-or-stdstringstream-trough-stdiostream)问题有关。

基本上，我想做一个函数，如下所示：

```
public InputOutputStream func()
{
    if (condition)
    {
        // open a file stream and convert to InputOutputStream 
    }
    else
    {
        // make an InputOutputStream from string
    }
} 
```

出现几个问题：

*   我在任何地方都找不到像`InputOutputStream`. 它只是`InputStream`and`OutputStream`及其变体（如`InputDataStream`,`OutputDataStream`等）。有吗？我需要一个支持读写操作的流。
*   我怎样才能`InputOutputStream`从文件中创建一个？
*   我怎样才能`InputOutputStream`从字符串？

因为 C++`InputOutputStream`是一个`std::iostream`. 我可以毫无问题地转换`std::fstream`或转换它。`std::stringstream`它在Java中可以访问吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:54:33.277

您可以考虑改用 RandomAccessFile。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:05:59.730

Java中没有`InputOutputStream`。如果您想 DIY，请按照以下说明进行操作。如果您扩展`abstract class`，请使用[Javadoc](http://docs.oracle.com/javase/7/docs/api/)确保覆盖*每个* `abstract`方法；没有那么多。

创建一个使用两个流 an`InputStream`和 an 的类`OutputStream`。扩展其中一个类；你不能从两个类继承（这些`Stream`类是抽象的）。

`InputOutputStream`然后，以调用适当的`InputStream`或方法的方式编写您的每个`OutputStream`方法。

```
public InputOutputStream () {
    InputStream is = new BufferedInputStream(source);
    OutputStream os = new BufferedOutputStream(source);
}
//....
public int read () { return is.read(); }
public void write (int x) { os.write(x); }
//....more methods....
// (if you extend an abstract class, you must override EVERY
// abstract method in the class...) 
```

如果需要，您可以使用一个适配器类来包装一个`InputOutputStream`并扩展另一个`Stream`类，将所有方法调用传递给底层的`InputOutputStream`.

**However,** it's probably easier to just use raw `InputStream`s and `OutputStreams`, though, and just pass the needed one to whatever method or code uses it....

Hope this helped, anyway.

# javascript - 将从 javascript 函数返回的值分配给变量

> ID：14718463
> 
> 赞同：3
> 
> 时间：2013-02-05T22:48:48.760
> 
> 标签：javascript, function, variables, return-value

我有一个返回字符串的函数，我需要多次调用该函数并将结果放入一个变量中。

我有这个：

```
function GetValue() {
    ... Do Something ...
    console.log(string); // displays 'string'
    return string;
} 
```

我正在尝试将函数的输出分配给另一个函数中的变量。目前我正在这样做：

```
var theString = GetValue();
console.log(theString); // displays 'undefined' 
```

我不明白的是函数中的控制台输出是显示值，但不是在将变量分配给函数的输出之后。

显然这不是将函数的输出分配给变量的方法。那么我该怎么做呢？

**[附加信息]**

显然，我试图在示例代码中保持简短只会造成混乱。

这是我需要从 javascript 文件的其他地方多次调用的完整函数：

```
/*
* Build URL link
*/
function BuildUrlTargetFolder() {
    // Get the current url and remove the 'zipCodes/branchAdmin' part of it for the branch url link
    var urlArray = window.location.href.split('/'),
    targetLength = urlArray.length - 3,
    i,
    targetFolder = '';

    for (i = 0; i < targetLength; i++) {
        // Only add a slash after the 'http:' element of the array
        if (i === 0) {
            targetFolder += urlArray[i];
        } else {
            targetFolder += '/' + urlArray[i];
        }
    }

    console.log('targetFolder: ' + targetFolder); // console output is the current url minus two "levels"

    return targetFolder;
} 
```

这是需要使用该功能的地方之一：

```
var targetFolder = BuildUrlTargetFolder();

console.log('targetFolder: ' . targetFolder); // console output: "undefined"

// If the url has a value, set the href attribute for the branch link otherwise hide the url
if (data['url'] !== '') {
    $('a#branchLink').attr('href', targetFolder + '/index.php/coverage-area/' + data['url']).show();
} else {
    $('a#branchLink').attr('href', '#').hide();
} 
```

那么，话虽如此，我如何从分配给调用代码变量的函数中获取字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T00:29:15.333

问题是这一行：

```
console.log('targetFolder: ' . targetFolder); // console output: "undefined" 
```

`.`应该是`+`一个.

如所写，您的代码等效于执行此操作：

```
console.log('targetFolder'.targetFolder); 
```

换句话说，它计算为`targetFolder`字符串“targetFolder”的属性（强制为`String`实例） - 这是未定义的。

# php - 本地主机重写

> ID：14718464
> 
> 赞同：0
> 
> 时间：2013-02-05T22:48:54.980
> 
> 标签：php, apache

我在我的机器上设置了 wampserver 和一个网站 @ localhost/site/

我想设置一个本地重写，我可以在浏览器中输入“somename”，它解析为 localhost/site/

这可以在hosts文件中完成吗？我在 Windows 7 顺便说一句

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:16:06.417

## 单击图标托盘上的服务器图标

![在此处输入图像描述](../Images/6770ffd8c35b6f93ca973acc6b8e4ad5.png)

然后点击 Apache 然后选择**Apache 模块**

![在此处输入图像描述](../Images/c8f03c6a83e4e0dfef0c97fb253af4f8.png)

然后点击 mode_rewrite

然后重新启动服务器，它将正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:51:05.067

不完全的。您可以将该行添加`127.0.0.1 somename`到您的 HOSTS 文件中，但它只会将您发送到`localhost`，您不能为其指定文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:51:40.537

是的，您可以通过主机文件将任何主机名重定向到 localhost。投放：

```
127.0.0.1       my.site.com 
```

不，您不能设置 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T22:54:10.063

在`DRIVE:\wamp\bin\apache\Apache2.2.21\conf\httpd.conf`

更改`ServerName localhost`为`ServerName somename`

试试看，

通过这种方式，您可以将本地主机（实际上，我们不能这样说：P）直接发送给其他名称

# c# - 高性能 8 字节十六进制到浮点值转换？

> ID：14718466
> 
> 赞同：0
> 
> 时间：2013-02-05T22:49:02.510
> 
> 标签：c#, performance, type-conversion

我需要将存储为 8 个字符的十六进制字符串的大量值转换为 C# 程序中的浮点值。性能至关重要，因为代码每秒会被调用多达 50,000 次。

至于功能，Python代码：

```
f = struct.unpack('<f', bytes.fromhex(strng))[0] 
```

做我需要的。我试过“无聊”的版本：

```
byte[] raw = BitConverter.GetBytes(int.Parse(hex, NumberStyles.HexNumber));
Array.Reverse(raw);
float f = BitConverter.ToSingle(raw, 0); 
```

但这非常慢。我尝试使用[此处](http://www.codeproject.com/Tips/447938/High-performance-Csharp-byte-array-to-hex-string-t)的代码优化它 ，它使用表查找和 c# 指针，并以这种方式调用它：

```
byte[] raw = FastHex.FromHexString(hex);
float f = BitConverter.ToSingle(raw, 0); 
```

这对于十六进制到字节 [] 的转换非常有用，但仍然涉及非本地字节 [] 数组的创建和销毁。我想知道我是否可以直接从 byte[] 到 FromHexString() 代码末尾的“float”值。也就是说，我希望能够做到：

```
fixed (float* floatptr = (float*)result)
    return *floatptr; 
```

其中 result 是包含结果的字节 [4]，但 C# 不喜欢这样......有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T13:04:06.190

```
 // This works for a two byte string, possibly more ;-)
        string hex = "FF";
        //
        float f = (float) Convert.ToInt32(hex, 16);
        //
        // f is now 255, yahoo! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:56:05.097

我认为这可能会奏效：

```
float f = (float)System.Net.IPAddress.NetworkToHostOrder(
    BitConverter.ToInt32(bytes, 0)); 
```

# c - 为什么我在 C 中的链表失败了？

> ID：14718467
> 
> 赞同：2
> 
> 时间：2013-02-05T22:49:06.480
> 
> 标签：c, algorithm

我打算编写一个简单的 SDL 应用程序，所以我想我应该实现一个可以稍后扩展的简单链表。现在经过一番挣扎后，我决定在这里寻求帮助。

我知道链表，我读过它。我看到了几个实现，不是那么难，很容易掌握。所以我想我应该能够自己实现一个。我猜我在这里严重忽略了一些东西。:(

首先这段代码编译不好，分段错误。其次，不幸的是，如果我能克服我用指针做的基本错误，我认为它不会产生我想要的东西。

你能告诉我我的代码中的错误吗？我在哪里做错了？

这是一个用于编辑的 liveworkspace 链接 [http://liveworkspace.org/code/1qu1RN](http://liveworkspace.org/code/1qu1RN) $1

这是我在 Cygwin gcc 上遇到的错误

```
temp [v 0] -> 0.460241 0.000000 0.050356
temp [v 1] -> 0.072079 0.153807 0.864573
temp [v 2] -> 0.683917 0.709301 0.080479
temp [v 3] -> 0.295755 0.264795 0.894696
address of ptemp @ 1629101750

[v 0] -> linked vertex is  7731159828445146316135105405324534341657178000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.000000 578395405356271.125000 1310047834864691498231654014730274851713450000.000000
Segmentation fault (core dumped) 
```

这是代码

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define NEWline printf("\n")

typedef struct position {
    double x;
    double y;
    double z;
} position;

struct datalist {
    position v;
    struct datalist  *pnext;

};
typedef struct datalist datalist;

void initializeList (datalist *head);
void addList_II (datalist *head , double data[3] );

void initializeList (datalist *head){
    position pv= {0,0,0};
    head = (datalist *) malloc ( sizeof (head) );
        if (head == NULL){ printf("cannot allocate memory");  exit(1); }
    head->v=pv;
    head->pnext=NULL;
}

void addList_II ( datalist *head , double data[3] ) {

    datalist *adddata;
    adddata = (datalist *)malloc ( sizeof (datalist) );
        if (adddata == NULL) { printf("cannot allocate memory for insertion data"); exit(1); }
    adddata->v.x = data[0];
    adddata->v.y = data[1];
    adddata->v.z = data[2];

    adddata->pnext = head->pnext;
    head=adddata;
}

int main() {

    datalist *ptemp;
    datalist temp;
    int i,c; //counters
    datalist *head;

    initializeList(head);

    for ( i = 0; i < 4; i++ ) {
        double t[3];
        srand ( time ( NULL )*i+234 );
            temp.v.x = ((double ) rand()  )/ RAND_MAX;
        srand ( time ( NULL )*i*546 );
            temp.v.y = ((double ) rand()  )/ RAND_MAX;
        srand ( time ( NULL )*i*567+345 );
            temp.v.z = ((double ) rand()  )/ RAND_MAX;
        t[0] = temp.v.x; t[1] = temp.v.y; t[2] = temp.v.z;

        printf ( "temp [v %d] -> %F %F %F \n",i, temp.v.x, temp.v.y, temp.v.z );
        addList_II (head, t );
    }

    c=0;
    ptemp=head;
    while (ptemp!=NULL) {
        printf("[v %d] -> linked vertex is  %F %F %F \n", c, ptemp->v.x,ptemp->v.y, ptemp->v.z);
        ptemp=ptemp->pnext;

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:54:05.340

在您`addList_II`的设置中，您设置了错误的指针。您正在获取新节点并将其下一个指针指向头的下一个指针，该指针为空。

```
 void addList_II ( datalist *head , double data[3] ) {
        datalist *adddata;
        adddata = (datalist *)malloc ( sizeof (datalist) );
            if (adddata == NULL) { printf("cannot allocate memory for insertion data"); exit(1); }
        adddata->v.x = data[0];
        adddata->v.y = data[1];
        adddata->v.z = data[2];

        //    adddata->pnext = head->pnext; //not THIS
        adddata->pnext = head;        //DO THIS
        head=adddata;
    } 
```

此外，您的指针超出了函数调用的范围。你需要做的是传入**变量。这意味着您传递一个指向指针的指针，该指针指向您的内存块。您通过取消引用本地 * 来修改原始指针，并且在返回时您会很好。

如果您需要更多解释，请询问，但这是解决方案

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define NEWline printf("\n")

typedef struct position {
    double x;
    double y;
    double z;
} position;

struct datalist {
    position v;
    struct datalist  *pnext;

};
typedef struct datalist datalist;

void initializeList (datalist **head);
void addList_II (datalist **head , double data[3] );

void initializeList (datalist **head){
    position pv= {0,0,0};
    *head = (datalist *) malloc ( sizeof (datalist) );
        if (head == NULL){ printf("cannot allocate memory");  exit(1); }
    (*head)->v=pv;
    (*head)->pnext=NULL;
}

void addList_II ( datalist **head , double data[3] ) {
    datalist *adddata;
    adddata = (datalist *)malloc ( sizeof (datalist) );
        if (adddata == NULL) { printf("cannot allocate memory for insertion data"); exit(1); }
    adddata->v.x = data[0];
    adddata->v.y = data[1];
    adddata->v.z = data[2];

    adddata->pnext = *head;        //DO THIS
    *head=adddata;
}

int main() {

    datalist *ptemp;
    datalist temp;
    int i,c; //counters
    datalist *head;

    initializeList(&head);

    for ( i = 0; i < 3; i++ ) {
        double t[3];
        srand ( time ( NULL )*i+234 );
            temp.v.x = ((double ) rand()  )/ RAND_MAX;
        srand ( time ( NULL )*i*546 );
            temp.v.y = ((double ) rand()  )/ RAND_MAX;
        srand ( time ( NULL )*i*567+345 );
            temp.v.z = ((double ) rand()  )/ RAND_MAX;
        t[0] = temp.v.x; t[1] = temp.v.y; t[2] = temp.v.z;

        printf ( "temp [v %d] -> %F %F %F \n",i, temp.v.x, temp.v.y, temp.v.z );
        addList_II (&head, t );
    }

    ptemp=head;

    while (ptemp!=NULL) {
       NEWline; 
        printf("[v ] -> linked vertex is  %F %F %F \n", ptemp->v.x,ptemp->v.y, ptemp->v.z);
        ptemp=ptemp->pnext;

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:59:21.130

查看您的代码，在我看来，在功能`addList_II`上您应该将前一行替换为最后一行

```
adddata->pnext = head; 
```

而不是：adddata->pnext = head->pnext；否则你总是会失去一个元素。然后您可以简单地设置`head=NULL`而不是初始化列表。

# bash - 路径和文件结构

> ID：14718473
> 
> 赞同：2
> 
> 时间：2013-02-05T22:49:55.437
> 
> 标签：bash, path

每次我安装一个新程序时，我必须将它的子目录添加到 PATH 中吗？还是此声明涵盖所有子目录？：`PATH=$PATH:~/local/bin` 在我的`.bashrc`

如果我必须将每个子目录添加到 PATH 中，是否有可以放入的自动化解决方案`.bashrc`？这样在启动时它会根据 PATH 检查所有子目录，如果 FALSE 更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:14:04.000

如果确实是这样的情况下您有**目录**`$HOME/local/bin`

```
$HOME/local/bin/atool
$HOME/local/bin/btool
$HOME/local/bin/ctool 
```

并且您希望这些中的每一个都在您的系统中，`$PATH`然后您可以在您的`.bashrc`或可能的您的系统中执行以下操作，`.bash_login`因为您不希望每次从现有会话开始 bash 会话时都执行此操作。

```
MYLOCALPATH=`find $HOME/local/bin -type d -depth 1 | paste -s -d : -`
PATH=$PATH:$MYLOCALPATH 
```

如果不是这种情况，那么也许您可以更具体地了解您没有发生的事情，因为通常会安装 exes `<somewhere>/bin`，即使它们不是出于版本控制的原因，它们通常也会链接到那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:07:34.647

通过包管理器安装或`make install`没有特殊`./configure`选项的程序将自行安装或至少在标准二进制目录之一中添加符号链接，例如`/usr/bin/`or 有时`/usr/games/bin`or `/usr/local/bin`。

您不需要将程序的数据目录添加到路径中。

# c# - C#：Marshal.Copy() 访问冲突从 IntPtr 转换为 float

> ID：14718477
> 
> 赞同：2
> 
> 时间：2013-02-05T22:50:17.197
> 
> 标签：c#, floating-point, intptr

我正在尝试通过 ReadProcessMemory() 读取内存，然后将读取的值存储在浮点数中（它绝对是内存中的浮点数，我已经使用另一个实用程序对其进行了验证）以供以后参考，但我尝试过的所有内容（BitConverter，Marshal .Copy() 等）似乎失败了。

我查看了许多示例，但我不确定我无法理解什么。

我做了一个简短的程序来测试这个概念。我知道完成这项任务的其他技术，但我也遇到了麻烦，所以我现在只关注这个。基本上，我将浮点值中的（已知）字节存储在 4 个字节的数组中，通过 IntPtr 指向它，然后使用 Marshal.Copy() 尝试从 IntPtr 转换为浮点数：

```
const int FLOAT_SIZE = 4;
byte[] baSource = new byte[FLOAT_SIZE];
IntPtr ipIntermediate = Marshal.AllocHGlobal(sizeof(float));
float[] faDest = new float[1];

baSource[0] = 0xA7;
baSource[1] = 0x68;
baSource[2] = 0xB9;
baSource[3] = 0x44;

ipIntermediate = ((IntPtr)(baSource[0]));
Marshal.Copy(ipIntermediate, faDest, 0, 1); // causes AccessViolation exception 
```

我正在运行 Windows 7 64 位。我目前的目标是为 x86 构建此版本，但也尝试了“任何 CPU”，只是为了获得相同的结果。字节顺序似乎也不是问题。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:00:26.210

`((IntPtr)(baSource[0]))`意思是：取数组的第一个元素，并将其转换为`IntPtr`. 你真正想要的：获取字节数组第一个元素的地址。您可以使用不安全的代码或`GCHandle`实现此目的：

```
const int FLOAT_SIZE = 4;
byte[] baSource = new byte[FLOAT_SIZE];
float[] faDest = new float[1];

baSource[0] = 0xA7;
baSource[1] = 0x68;
baSource[2] = 0xB9;
baSource[3] = 0x44;

var gch = GCHandle.Alloc(baSource, GCHandleType.Pinned);
try
{
    var source = gch.AddrOfPinnedObject();
    Marshal.Copy(source, faDest, 0, 1);
}
finally
{
    gch.Free();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:55:46.997

可能是因为 IntPtr 是一个指针，所以在您调用 Marshal.Copy 时它被解释为一个指针，而不是数据。

请注意，有一种更简单的方法可以从其组成字节构建浮点数：

```
float f2 = BitConverter.ToSingle(byteArray, 0); 
```

# javascript - 恒星动画背景图像效果

> ID：14718482
> 
> 赞同：1
> 
> 时间：2013-02-05T22:50:38.617
> 
> 标签：javascript, jquery, css

这似乎是一个稍微笼统的问题，但我想不出更好的地方来问它。

[我怎样才能达到像http://philmartinezdesign.com/](http://philmartinezdesign.com/)上看似爆炸的文字的效果？

我知道它是使用恒星和背景图像完成的，但我想知道是否有人可以看到动画是如何完成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:01:15.837

[像这样：](http://philmartinezdesign.com/assets/js/init.js)

```
//explosion! I'll probably be making a plugin for sequencing like this soon...

var siteUrl = $('#siteUrl').html();
var $path = siteUrl + 'assets/img/explosion';
var explosion = [];
var $frameNum;
var $spacing = 40;
var $frames = 25;

//add all the frames into an array
for( var s = 0; s < $frames; s++ ) {
    explosion[s] = $path + '/' + s +'.jpg';
}
explosion.shift();

//cache
$('body').append('<div id="cache"></div>');
$('#cache').hide();
$(explosion).each(function() {
    $('<img />').attr('src', this).appendTo('#cache');
});

//on scroll swap the images
$(window).scroll(function(){

    var $scrollTop = $(window).scrollTop() -40;

    $frameNum = Math.ceil( $scrollTop / $spacing );

    if( $frameNum <= $frames ) {
        $('#explosion img').attr('src' , explosion[$frameNum] );
    }

}); 
```

他有 25 张图像，每张都是爆炸的一帧。当您滚动时（或当他通过单击链接强制滚动时），他会快速连续地旋转图像以创建效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:58:14.610

我假设您指的是顶部的大“PM”？这只是两张图片：

[![图 1](../Images/4735c10f144f89654de8c336c4a9bce2.png)](https://i.stack.imgur.com/lWmXr.png)
[（来源：[philmartinezdesign.com](http://philmartinezdesign.com/assets/img/explosion/phil_martinez.png)）]

[![图 2](../Images/14f12d79de0b607e040435f46babd75d.png)](https://i.stack.imgur.com/efz8W.jpg)
[（来源：[philmartinezdesign.com](http://philmartinezdesign.com/assets/img/explosion/2.jpg)）]

它所做的只是在滚动到达某个点时用另一个图像替换一个图像。它没有什么特别之处。

（顺便说一句，那个网站充满了可怕的设计选择。不要把它作为你自己工作的灵感，不管你认为它有多“酷”）

# python - XPath：查找包含某些标签的 div

> ID：14718483
> 
> 赞同：0
> 
> 时间：2013-02-05T22:50:40.877
> 
> 标签：python, html, xml, xpath, lxml

我知道它可以让你找到一个带有`<a>`标签的 div

```
'//div[a]' 
```

但是如果我想要一个带有`<a>`标签和`<p>`标签的 div 怎么办。

我试着做`'//div[a][p]'`。

我也尝试过`'//div[a|p]'`我认为会给 div 带有`<a>`or`<p>`标记的操作，然后我可以检查它是否`<div>`包含 an`<a>`和 a`<p>`之后...但是返回的 div 都不包含 a `<p>`，`<a>`即使我知道有`<div>`s 包含两者.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:09:59.073

如果您只想选择`<div>`具有`<a>`和`<p>`作为**子**元素（直接后代）的元素，那么您的 XPath 表达式是正确的，问题出在其他地方。

如果您打算选择**包含**and的`<div>`元素，则应使用轴。 **`<a>``<p>``descendant`**

 **```
//div[descendant::a and descendant::p] 
```

它将选择以下所有`<div>`

```
<root>
  <div>
    <a>Dolor</a>
    <p>et calculum</p>
  </div>
  <div>
    <a>Dolor<p>et calculum</p></a>
  </div>
  <div>
    <ul>
      <li><a>Foo</a><li>
    </ul>
    <p>Bar</p>
  </div>
</root> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:08:09.943

我敢肯定有一个更好的方法，但直接的 kludge 是这样的：

```
set(tree.xpath('//div[a]')).intersection(tree.xpath('//div[p]')) 
```

或者这个怪物保持简单的 XPath：

```
tree.xpath('//div[a][count(. | //div[p]) = count(//div[p])]') 
```

如果`lxml`使用 XPath 2.0 - 那么你会有一个 intersect 运算符，但是唉......**

# javascript - 在提交时验证所有表单字段

> ID：14718484
> 
> 赞同：0
> 
> 时间：2013-02-05T22:50:40.903
> 
> 标签：javascript, jquery

基本上我正在做的是将8个表单输入值传递给一个Javascript Ajax文件，在这个过程中我想做一个

```
if(in_array(all form values) == 'empty') { 
```

这是我正在使用的当前代码

```
if($("#merchant").val()==='') {
        //prevent submit button to sending to the handler page
        event.preventDefault();
        //popup the alert
        $("#response").html("<br/><div class='alert alert-error'>Please enter a Merchant Name</div>");
        $("#response").slideDown('slow');
        slideout();
        $("#loading").fadeOut('slow');
} 
```

但是使用这段代码，我必须为每个字段复制和粘贴大约 8 次，如果可能的话，我宁愿做一个数组检查。

这可能与 Javascript 吗？如果是这样怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:52:41.873

像这样迭代`:inputs`表单，假设你在一个`submit`事件中并且表单是`this`

```
$(':input', this).each(function(e) {
    if ($(this).val() === '') {
        // do your stuff
    }
}); 
```

您还可以将错误消息附加为数据属性并像这样引用它

```
<input type="text" ... data-error-msg="Some Error Message"/>

$(this).data('error-msg'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:53:26.027

此功能完美运行

```
function in_array(item,arr) {
     for(p=0;p<arr.length;p++) if (item == arr[p]) return true;
     return false;
} 
```

像这样使用它

```
if(in_array("value", myarray))
{
   // Do something
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T22:56:10.850

这只会选择空的元素：

```
$(".my-class:empty").each(function() {
    // Do things
}); 
```

# php - PHP 和 XML - 增量变量，检查 xml 节点。如果它们相等，则回显 X，否则回显 Y

> ID：14718491
> 
> 赞同：-1
> 
> 时间：2013-02-05T22:51:14.917
> 
> 标签：php, xml, loops, xpath

我有一个需要从中提取数据的 XML 文档。我基本上是在制定一个时间表。我已经有一个变量 $timeToFind，我从“7:00am”到“10:00pm”增加了半小时。我还有一种方法来计算事件的时间长度。

如果在星期一（星期一）发现任何事件，我需要使用某种方法在 $timeToFind 处检查。如果找到，则回显一个包含时间和类型的 div，否则，回显一个空 div。

```
$xml = simplexml_load_string('<?xml version="1.0" encoding="UTF-8"?>
<schedule>
    <about>
        <name>Person 1</name>
    </about>
    <daily>
        <mon>
            <event type="work" start="8:00am" end="12:00pm">
                <title>Work at McDonalds</title>
            <description>Go to work and get free food.</description>
            </event>
        <event type="classs" start="12:30pm" end="2:30pm">
            <title>English Class</title>
            <description>Go to English class in Room 219.</description>
        </event>
        </mon>
    </daily>
</schedule>');

$dayStart = 7;
$dayEnd = 22.5;
$hoursInDay = $dayEnd - $dayStart;

for ($i=$dayStart; $i<=$dayEnd; $i+=.5) {

// if it happens to be 1:00 (13), keep the $current variable non-military
if($i >= 13){
    $current = $i-12;
}else {
    $current = $i;
}

// $i >= 12, then it's PM, else AM
if($i >= 12){
    $timeToFind = $timeToFind . "pm";
}else {
    $timeToFind = $timeToFind . "am";
}

$nodes = $xml->xpath(sprintf('/mon/event[@type="%s"]', $timeToFind));

if (!empty($nodes)) {
    printf('Time "%s" found!! <br> ', $timeToFind);
} else {
    printf('Time "%s" Not found. <br> ', $timeToFind);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:05:36.787

我强烈建议不要做你的“非军事”黑客：它会让你的事情变得更难。

看看这里 [http://www.php.net/manual/en/class.simplexmlelement.php#103614](http://www.php.net/manual/en/class.simplexmlelement.php#103614)

对于一些使用 simplexml 解析 xml 数据结构的代码。在执行计划循环之前，您需要将 xml 读入某种结构。

HtH

露丝

# android - 如何在使用 ant 和外部库时更改 android.jar 优先级？

> ID：14718494
> 
> 赞同：1
> 
> 时间：2013-02-05T22:51:26.793
> 
> 标签：android, ant

我正在尝试使用 ant 编译和构建一个 android 应用程序。我确实`android update project --target 1 --path <path to project>`创建了我的 build.xml。我正在使用 api 16。我有一些外部 jars 覆盖了 android.jar 中的一些类和方法，因此它们需要在 android.jar 之前的类路径中。Eclipse 允许我重新排序我的优先级，因此我可以在那里工作。但是在使用 ant 时，我提供外部 jar 位置的方式是在 build.properties 文件中添加`jar.libs.dir=libs`和。`external.libs.dir=libs`但看起来它们是在编译任务中的 android.jar 文件之后添加的。

有什么办法可以改变吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T18:09:12.027

我可以通过覆盖 build.xml 中的编译目标来解决这个问题，将我的自定义 jars 作为引导库，将 android.jar 作为类路径库。

# c# - IoC、UnitOfWork 与 Ninject 和实体框架

> ID：14718495
> 
> 赞同：2
> 
> 时间：2013-02-05T22:51:28.777
> 
> 标签：c#, entity-framework, inversion-of-control, ninject

我试图为我的服务类实现一个通用存储库。但是当我尝试在 Web 层绑定我的 DbConext 时，我需要引用实体框架。

**我的`DbContext`**

```
 public partial class SalesDbContext : DbContext, IUnitOfWork
    {
        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
        }

        public DbSet<Activity> Activities { get; set; }

        /// <summary>
        /// Allows saving changes via the IUnitOfWork interface.
        /// </summary>
        void IUnitOfWork.Commit()
        {
            base.SaveChanges();
        } 
```

**我的`IUnitOfWork`**

```
public interface IUnitOfWork
{
    /// <summary>
    /// Saves changes to all objects that have changed within the unit of work.
    /// </summary>
    void Commit();
} 
```

**我的`Repository`**

```
public class Repository
{
    protected IUnitOfWork UnitOfWork { get; set; }

    protected SalesDbContext Context
    {
        get { return (SalesDbContext)this.UnitOfWork; }
    }

    public Repository(IUnitOfWork unitOfWork)
    {
        if (unitOfWork == null) throw new ArgumentNullException("unitOfWork");
        this.UnitOfWork = unitOfWork;
    }

    private DbSet<TEntity> GetDbSet<TEntity>() where TEntity : class
    {
        return this.Context.Set<TEntity>();
    }

    protected IEnumerable<TEntity> GetAll<TEntity>() where TEntity : class
    {
        return this.GetDbSet<TEntity>()
            .AsEnumerable();
    }

    protected virtual void SetEntityState(object entity, EntityState entityState)
    {
        this.Context.Entry(entity).State = entityState;
    }
} 
```

**最后我的 Ninject 配置**

```
private static void RegisterServices(IKernel kernel)
{
    IUnitOfWork unitOfWork = new SalesDbContext();

    kernel.Bind<IUnitOfWork>().ToConstant(unitOfWork);
    kernel.Bind<IMarketService>().To<MarketService>();
} 
```

问题是 Ninject 想要实体框架的引用，但我不想在这里添加它，它属于数据层。

你认为 DbContext 的 ToConstant 实现会导致问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T01:06:43.487

如果您不想从顶级（例如 Web）项目中引用 EntityFramework，您将如何构建您的应用程序？顶级项目需要引用所有底层依赖项，*因此可以将它们放在`bin`文件夹中，在 web app 的情况下*。

*绝对不是 Ninject 想要那个参考。这是因为您正在使用类，这取决于该项目中的 EntityFramework。*

从顶层（通过中间）到底层的引用没有问题。它可能是（设计）问题，如果它会是另一种方式（例如从数据层引用到`System.Web`）。

*更新*

正如OP在他的评论中所说。[有一种可能的解决方案可以避免使用ninject.extensions.xml](https://github.com/ninject/ninject.extensions.xml)从顶层引用底层（如 EF）的依赖关系。*仅当目的是在顶层项目中进行 ninject 配置时，它才会起作用，但项目本身没有引用（使用）任何具有依赖关系的底层类。EF 也必须在 GAC 中。*

* * *

`DbContext` `ToConstant()`只要实现了就绑定你的不是一个好概念`IDisposable`。`DbContext`应该以`Scope`对应用程序有意义的最短可能进行绑定（例如`InRequestScope()`，对于网络应用程序）。Ninject 将在`Scope`.

如果您让`DbContext`bound `ToConstant`，它将在整个应用程序生命周期中保持一个与数据库的连接。当被多个线程访问时，您可能会遇到并发问题并且`DbContext`可能变得不一致，因为它无法跟上对象同步。

# android - 有没有办法防止列表视图在其适配器的数据更改时滚动到其顶部位置？

> ID：14718502
> 
> 赞同：21
> 
> 时间：2013-02-05T22:52:03.247
> 
> 标签：android

在更改适配器的数据时，我在保留列表视图的滚动位置时遇到了一些麻烦。

我目前正在做的是在`onCreate`ListFragment 中创建一个自定义 ArrayAdapter（具有重写的 getView 方法），然后将其分配给它的列表：

```
mListAdapter = new CustomListAdapter(getActivity());
mListAdapter.setNotifyOnChange(false);
setListAdapter(mListAdapter); 
```

然后，当我从定期获取所有内容的加载程序接收到新数据时，我在其`onLoadFinished`回调中执行此操作：

```
mListAdapter.clear();
mListAdapter.addAll(data.items);
mListAdapter.notifyDataSetChanged(); 
```

问题是，调用会`clear()`重置列表视图的滚动位置。删除该调用会保留该位置，但显然会将旧项目留在列表中。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-06T00:30:06.057

正如您自己指出的那样，对“clear()”的调用会导致位置重置为顶部。

摆弄滚动位置等是让这个工作的一个小技巧。

如果您的 CustomListAdapter 是 ArrayAdapter 的子类，则可能是问题所在：

对 clear() 的调用调用了“notifyDataSetChanged()”。您可以防止这种情况：

```
mListAdapter.setNotifyOnChange(false); // Prevents 'clear()' from clearing/resetting the listview
mListAdapter.clear();
mListAdapter.addAll(data.items);
// note that a call to notifyDataSetChanged() implicitly sets the setNotifyOnChange back to 'true'!
// That's why the call 'setNotifyOnChange(false) should be called first every time (see call before 'clear()').
mListAdapter.notifyDataSetChanged(); 
```

我自己没试过，但试试看：）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T23:13:02.447

签出：[返回 ListView 时保持/保存/恢复滚动位置](https://stackoverflow.com/questions/3014089/maintain-save-restore-scroll-position-when-returning-to-a-listview)

在调用 .clear()、.addAll() 和 .之前，使用它来保存 ListView 中的位置。通知数据集更改（）。

```
int index = mList.getFirstVisiblePosition();
View v = mList.getChildAt(0);
int top = (v == null) ? 0 : v.getTop(); 
```

更新 ListView 适配器后，Listview 的项目将被更改，然后设置新的位置：

```
mList.setSelectionFromTop(index, top); 
```

基本上你可以保存你的位置并滚动回它，保存 ListView 状态或整个应用程序状态。

其他有用的链接：

保存位置： [如何在 Android 中保存和恢复 ListView 位置](https://stackoverflow.com/questions/7167487/how-to-save-and-restore-listview-position-in-android)

保存状态： [Android ListView y 位置](https://stackoverflow.com/questions/5878421/android-listview-y-position)

问候，

请让我知道这可不可以帮你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-07T23:44:55.377

我最近遇到了另外一个用例（Android 8.1）——由 Android 代码中的错误引起。如果我使用鼠标滚轮滚动列表视图 - 连续`adapter.notifyDataSetChanged()`将滚动位置重置为零。使用此解决方法，直到错误在 Android 中得到修复

```
 listView.onTouchModeChanged(true); // workaround
        adapter.notifyDataSetChanged(); 
```

更多细节在这里：[https ://issuetracker.google.com/u/1/issues/130103876](https://issuetracker.google.com/u/1/issues/130103876)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-09-30T11:51:34.123

在您的可扩展/列表适配器中，放置此方法

```
public void refresh(List<MyDataClass> dataList) {
    mDataList.clear();
    mDataList.addAll(events);
    notifyDataSetChanged();
} 
```

从您要更新列表的活动中，输入此代码

```
if (mDataListView.getAdapter() == null) {
    MyDataAdapter myDataAdapter = new MyDataAdapter(mContext, dataList);
    mDataListView.setAdapter(myDataAdapter);
} else {
    ((MyDataAdapter)mDataListView.getAdapter()).refresh(dataList);
} 
```

> 如果是**Expandable List View**，您将使用 **mDataListView.getExpandableListAdapter()**而不是 **mDataListView.getAdapter()**

# mongodb - 对 MongoDB 中的大型集合进行范围查询

> ID：14718503
> 
> 赞同：1
> 
> 时间：2013-02-05T22:52:07.133
> 
> 标签：mongodb

我有大约 4000 万份文档（~10GB）的文档集合。此集合中的文档相当小（约 1000 字节）。主要感兴趣的领域如下：

```
start_x     integer
end_x       integer 
```

我有一个查询来为给定的 x 值返回一行。对于 x 的值，集合中只能有一个匹配的行。为此，我正在使用以下选择器：

```
"start_x"=>{"$lte"=>1258}, "end_x"=>{"$gte"=> 1258} 
```

我没有得到预期的查询性能。我从一个复合索引开始（start_x = 1，end_x = 1）。查询计划显示大约 400K nscanned

```
{
  "cursor"=>"BtreeCursor start_x_1_end_x_1", 
  "nscanned"=>417801, 
  "nscannedObjects"=>1, 
  "n"=>1, 
  "millis"=>3548, 
  "nYields"=>0, 
  "nChunkSkips"=>0, 
  "isMultiKey"=>false,
  "indexOnly"=>false
} 
```

随后，我在 start_x 和 end_x 字段上添加了独立索引。查询计划没有显示出太大的改进。

*   为什么`indexOnly`即使我有一个复合索引并且查询中使用的所有字段都被索引覆盖，为什么不正确？

*   有没有办法优化这个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:14:37.950

我最终在`end_x`字段上使用索引查找来解决这个问题。

*   删除集合上的所有索引
*   `end_x`在字段上添加了 ASC 索引。
*   查询上界等于或高于给定值的第一个匹配行

    ```
    row = Model.where(:end_x.gte => 1258).asc(:end_x).limit(1).first 
    ```

*   检查以确保返回的行确实是匹配范围

    ```
    row = (row.present? and 1258.between?(row.start_x, row.end_x)) ? row : nil 
    ```

# sql - SQL Server - 如何将派生表用于计算字段？

> ID：14718505
> 
> 赞同：3
> 
> 时间：2013-02-05T22:52:19.587
> 
> 标签：sql, sql-server, sql-server-2008-r2

我试图在查询的 WHERE 子句中使用计算字段值，经过一些研究，我知道我需要创建一个派生表。但是我不确定语法，因为我的计算字段使用 CASE 语句，例如：

```
 CASE T.IsReassigned
        WHEN 1 THEN DATEDIFF(MINUTE,
                    (SELECT top 1 SXAVWFTaskHistory.CreatedWhenUTC from SXAVWFTaskHistory where TaskID = T.TaskID and StatusID = 7 order by TaskHistoryID desc),
                    SYSDATETIMEOFFSET())                        
        ELSE 
        CASE Stat.StatusID      
            WHEN 1 THEN DATEDIFF(MINUTE,TSK.CreatedWhenUTC, SYSDATETIMEOFFSET())    -- time duration between when task is created(use SXAVWFTask.CreatedWhenUTC) and now 
            WHEN 2 THEN DATEDIFF(MINUTE,TSK.CreatedWhenUTC, SYSDATETIMEOFFSET())    -- time duration between when task is created(use SXAVWFTask.CreatedWhenUTC) and now
            ELSE DATEDIFF(MINUTE,TSK.CreatedWhenUTC, TH.CreatedWhenUTC) 
        END 
    END as TaskItemAge, 
```

然后我想在 where 子句中使用 TaskItemAge 值，例如：

```
WHERE TaskItemAge > @TaskAgeStart AND TaskItemAge < @TaskAgeEnd 
```

如何将该 CASE 语句放入子选择中？

****** *** ** *** ** *** ** *** ******编辑******* *** ** *** ** *** ** ***** 抱歉，我仍然对这将如何工作感到有些困惑。这是我查询的更大片段：*****

 *****```
 SELECT TSK.TaskID, --0
    TH.IsLatest,
    TH.CreatedWhenUTC as TaskHistoryCreationDate, --10
    TS.Name AS STATE,
    CASE T.IsReassigned
        WHEN 1 THEN DATEDIFF(MINUTE,
                    (SELECT top 1 SXAVWFTaskHistory.CreatedWhenUTC from SXAVWFTaskHistory where TaskID = T.TaskID and StatusID = 7 order by TaskHistoryID desc),
                    SYSDATETIMEOFFSET())                        
        ELSE 
        CASE Stat.StatusID      
            WHEN 1 THEN DATEDIFF(MINUTE,TSK.CreatedWhenUTC, SYSDATETIMEOFFSET())    -- time duration between when task is created(use SXAVWFTask.CreatedWhenUTC) and now 
            WHEN 2 THEN DATEDIFF(MINUTE,TSK.CreatedWhenUTC, SYSDATETIMEOFFSET())    -- time duration between when task is created(use SXAVWFTask.CreatedWhenUTC) and now
            ELSE DATEDIFF(MINUTE,TSK.CreatedWhenUTC, TH.CreatedWhenUTC) 
        END 
    END as TaskItemAge,
    ctx.ContextTypeName,  
    ctx.ContextDescription, --15
    TH.TouchedWhenUTC as TaskHistoryModifiedDate
INTO #ii        
FROM SXAVWFTask TSK 
INNER JOIN SXAVWFTaskHistory TH ON TSK.TaskID = TH.TaskID
INNER JOIN @PagedTemp T on TH.TaskHistoryID = T.TaskHistoryID

Where TaskItemAge > @TaskAgeStart AND TaskItemAge < @TaskAgeEnd 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T22:55:03.413

```
select  *
from    (
        select  case ... end as CaseColumn
        ,       *
        from    YourTable
        ) as SubQueryAlias
where   CaseColumn between 1 and 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:58:53.547

Andomar 是正确的形式 (+1)，这是您的特定语法：

```
SELECT *
FROM (
    SELECT *,
        CASE T.IsReassigned
            WHEN 1 THEN DATEDIFF(MINUTE,
                        (SELECT top 1 SXAVWFTaskHistory.CreatedWhenUTC from SXAVWFTaskHistory where TaskID = T.TaskID and StatusID = 7 order by TaskHistoryID desc),
                        SYSDATETIMEOFFSET())                        
            ELSE 
            CASE Stat.StatusID      
                WHEN 1 THEN DATEDIFF(MINUTE,TSK.CreatedWhenUTC, SYSDATETIMEOFFSET())    -- time duration between when task is created(use SXAVWFTask.CreatedWhenUTC) and now 
                WHEN 2 THEN DATEDIFF(MINUTE,TSK.CreatedWhenUTC, SYSDATETIMEOFFSET())    -- time duration between when task is created(use SXAVWFTask.CreatedWhenUTC) and now
                ELSE DATEDIFF(MINUTE,TSK.CreatedWhenUTC, TH.CreatedWhenUTC) 
            END 
        END as TaskItemAge
    FROM BaseTable
) as DerivedTable
WHERE TaskItemAge > @TaskAgeStart AND TaskItemAge < @TaskAgeEnd 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T22:59:02.287

您也可以使用[CTE](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)

```
 ;WITH cte AS
   (
    SELECT CASE WHEN ... THEN ... END AS TaskItemAge
    FROM your_table
    )
    SELECT *
    FROM cte
    WHERE TaskItemAge > @TaskAgeStart AND TaskItemAge < @TaskAgeEnd 
```*****

# jquery - Drupal Webform 项目描述显示得很好？

> ID：14718507
> 
> 赞同：0
> 
> 时间：2013-02-05T22:52:23.140
> 
> 标签：jquery, drupal, drupal-webform

在一个*[drupal](http://drupal.org)*站点上，我有一个带有[表格排序输入的](https://stackoverflow.com/a/12058923/1589669)*[网络表单](http://drupal.org/project/webform)*。很难很好地显示长描述。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:52:23.140

这是我为附加描述折叠到标签（添加为*节点*描述）所做的：

```
<script type="text/javascript">
    $(document).ready(function(){   
        $(".form-item:has(div.description)").children("label").append(function(){
            $(this).parent().children('.description').hide();
            return '<sup><a href="#" onclick="$(this).parent().parent().parent().find(\'.description\').toggle();" title="'+$(this).parent().children('.description').text()+'"><strong>?</strong></a></sup>';
        }); 
    });
</script> 
```

这里的沙箱：http: [//jsfiddle.net/eapo/3ubec/](http://jsfiddle.net/eapo/3ubec/)

还有其他建议吗？

# symfony-2.1 - 如何在 Symfony 2.1 控制器中获取语言环境？

> ID：14718512
> 
> 赞同：3
> 
> 时间：2013-02-05T22:52:48.310
> 
> 标签：symfony-2.1

我安装了捆绑包：[https](https://github.com/lunetics/LocaleBundle) ://github.com/lunetics/LocaleBundle ，它有助于在语言之间切换。一切正常，在树枝上，翻译工作正常。但是当我想翻译控制器中的任何消息时，我得到的是法语（fr）而不是定义的语言（例如 en）。

请问如何在控制器中获取当前选择的语言环境？

我使用：`$this->getRequest()->getLocale()`但它不起作用，它给了我每种文化的 FR。

我在 parameter.ini 中的默认设置语言是 FR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:10:18.813

在查看了 LuneticsLocaleBundle 和 Symfony 2.1 文档的代码后，我发现 symfony2.1 正在通过路线中的语言环境。从 symfony 创建 nes 请求的 twig 模板渲染动作时存在问题。所以，为了解决这个问题，我重写了 LuneticsLocaleBundle 的代码，并添加`$this->get('session')->set('_locale', $_locale);`了包的 LocaleController 的 switchAction。

因此，语言环境将存储在会话中。

我希望这也能帮助你。

# django - Django 使用 GET 变量将无效表单重定向到同一页面

> ID：14718513
> 
> 赞同：1
> 
> 时间：2013-02-05T22:52:52.377
> 
> 标签：django, django-views

嗨，我有一个 Django 视图，它对应于这样的 url：

```
<my_site>/project_info/?pitched=true 
```

我以正常方式验证此页面的表单：

```
form = ProjectInfoForm(request.POST or None)
if form.is_valid():
    # handle form
    ... 
```

但是，当表单返回错误时，它最终会出现在没有 url 的同一页面上（显然）：

```
<my_site>/project_info/ 
```

我真的不想将 pitched=true 参数更改为捕获的 url 参数。考虑到我不知道页面是否有这个 GET 变量，重定向的最佳方式是什么？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T22:55:04.177

模板中的 HTML 是什么样的？尝试将`action`表单上的属性设置为`""`（它应该保留您的变量），如下所示：

```
<form action="" method="post"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T23:22:55.883

`action=""`诀窍奏效。如果你想确定，你可以做类似的事情

```
<form action="{% if request.GET.pitched %}?pitched={{ request.GET.pitched }}{% endif %}" method="post"> 
```

# shell - 统计删除的文件Shell脚本

> ID：14718516
> 
> 赞同：0
> 
> 时间：2013-02-05T22:53:15.237
> 
> 标签：shell

您能告诉我如何计算从文件夹中删除的扩展名为“.txt”的文件吗？Unix 中的 Shell 脚本

谢谢您的回答 ：）

我试图以这种方式删除它们：

删除=0

而读线做

```
if test -d "$line"
then

for i in "$line"/*
do

    if test -f "$i"
    then
    deleted=`ls -l $line |grep "*.o" | wc -l`
    echo "From: " $line " I deleted : " $deleted
    find . -type f -name "*.o" -exec rm -f {} \;

    else
    echo "Not file " $i                   
    fi

done

else
echo "NOT a directory!"
fi 
```

完毕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:15:47.850

尝试这样做：

```
LANG=C rm -v *.txt | grep -c "^removed " 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:59:57.917

一个答案 - 虽然不一定是正确的：

```
files=*.txt
ls -1 "$files" | wc -l
rm "$files" 
```

露丝

# uiviewcontroller - 委托/协议不起作用：将数组从 TableViewController 传递给父 ViewController

> ID：14718517
> 
> 赞同：0
> 
> 时间：2013-02-05T22:53:19.270
> 
> 标签：uiviewcontroller, delegates, nsmutablearray, uitableview, protocols

我有一个父 ViewController (SearchViewController)，它连接到一个 TableViewController (FilterTableViewController)，用户可以在 TableView 中选择人员。选择存储在一个名为 selectedpersonArray 的 NSMutableArray 中，它已经可以正常工作了。但现在我需要将它们传递回父 ViewController。我试图实现一个协议/委托。由于我是 Objective-C 的新手，我无法正确理解某些部分并且它不起作用：

**FilterTableViewController.h（子控制器）**

```
@protocol filterDelegate <NSObject>
-(void)addArraytoSearchViewController:(NSMutableArray *)array;
@end

@interface FilterTableViewController : UITableViewController

@property (nonatomic, assign) id <filterDelegate> selectedpersonDelegate;

@property (nonatomic, retain) NSMutableArray *selectedpersonArray;    

@end 
```

**过滤表视图控制器.m**

```
#import "FilterTableViewController.h"

@interface FilterTableViewController ()
@end

@implementation FilterTableViewController

...

@synthesize selectedpersonArray;
@synthesize selectedpersonDelegate;

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
...

[[self selectedpersonDelegate] addArraytoSearchViewController:selectedpersonArray];
NSLog(@"personarray: %@", selectedpersonDelegate);
} 
```

问题 1：我可以在 NSLog 中显示代理吗？这里它返回 nil，但 selectedpersonArray 包含值。问题 2：有没有比 didSelectRowAtIndexPath 更好的传递 Array 的地方，因为可以进行多个选择，并且只有在按下 Back 按钮时才能传递 Array。我可以使用 *- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender*吗？

**SearchViewController.h：（父视图）**

```
#import "FilterTableViewController.h"

@interface SearchViewController: UIViewController <UITableViewDataSource, UITableViewDelegate, filterDelegate> 
```

**SearchViewController.m：**

```
@implementation SearchViewController

...

- (void)viewDidLoad{
    FilterTableViewController * FTC = [[FilterTableViewController alloc] init];
    FTC.delegate = self;

- (void)addArraytoSearchViewController:(NSMutableArray *)array {
    NSLog(@"%@", array);
} 
```

问题 3： NSLog 在这里没有做任何事情......怎么了？问题 4：如何从第二个 ViewController 传递多个 Array？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T22:03:50.037

我忘了设置委托，因为用户 firoze 想通了。这解决了我的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T00:44:33.697

所以听起来好像您实际上并没有在 segue 为您呈现的 FilterTableViewController 上设置委托。只需在您的方法中设置委托，您`prepareForSegue:sender:`显然也在推送其他数据。

现在，在您的`-[SearchViewController viewDidLoad]`方法中，您正在创建*另一个*名为 FTC 的实例，设置它的委托，然后立即丢弃该 FTC 实例。该实例与将由 segue 推送的实例无关。

关于你的其他问题：

1.) 是的，您应该可以在那里看到代表。

2.) 是的，如果您想收集多个选择，那么在选择完成时通知您的代表可能更有意义。

3.) 可能永远不会调用此方法，因为您从未正确设置委托。

4.) 如果你有两个数组，你可能只在你的委托方法中包含两个参数。如果超过 2 个，我会考虑一个数组字典，或者一个数组数组。

希望有帮助。

# c# - C# 或者底层的 CLR 不是真的支持多重继承吗？

> ID：14718524
> 
> 赞同：2
> 
> 时间：2013-02-05T22:53:47.070
> 
> 标签：c#, inheritance, multiple-inheritance

这必须要么讨论，要么我非常愚蠢。关于为什么 C# 没有 MI，有很多类似的线程，我已经经历了大部分。但我很想知道 C# 是否还没有隐式支持它。

由于 .NET 中的每种类型都派生自我`System.Object`可以将类编写为

```
Person : object { } 
```

现在如果我有

```
Employee : Person { } 
```

难道真的不是

```
Employee : object, Person { } 
```

1）类不是`Employee`已经从两个类继承了吗？

多重继承的所有问题也都存在这里吧？可以说我有这个：

```
Person : object
{
    new public Type GetType()
    {
        return null;
    } 
}

Employee : object, Person 
{ 

} 
```

2）现在如果我打电话`Employee.GetType()`应该打电话`Person.GetType()`还是`object.GetType()`？混淆是正确的。我觉得 C# 是不是神奇地为类提供了某种继承优先`object`级，因为它在MI 的情况下[已经在许多语言中出现了？](http://en.wikipedia.org/wiki/Multiple_inheritance#Mitigation)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T22:54:57.517

你误解了继承。

`Employee`继承`Person`，**只有**。
`Person`继承`Object`.

`Employee``Object` *间接*继承，通过`Person`.
因为`Person`介于`Employee`和之间`Object`，所以不存在 MI 问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T23:01:29.733

当人们讨论多重继承时，他们通常是指直接从两个父类继承。

实例方法调用的正常解决方案是沿着继承层次结构向上移动并在方法的第一个定义处停止。

直接从两个父类继承的能力引入了[钻石问题](http://en.wikipedia.org/wiki/Multiple_inheritance#The_diamond_problem)，这是许多人认为多重继承是一个坏主意的主要原因。对于多个父类，作为上层接口的一部分所需的东西可以在两个父类中以不同方式覆盖，并且没有明确的选择使用哪个。

不同的语言以不同的方式处理这个问题，而 C# 和 Java 确实都通过简单地不允许多重继承来处理它，

# url - 缩短 Joomla SEF URL 父/子/子菜单项，仅使用一个别名而不使用多个父别名

> ID：14718531
> 
> 赞同：1
> 
> 时间：2013-02-05T22:54:37.043
> 
> 标签：url, joomla, alias, sef

无论如何，是否只在 URL 中显示菜单项别名而不显示其父别名？我知道我可以创建一个隐藏菜单，其中包含根级别的所有项目，但这会使面包屑无法使用。

例如：www.mysite.com/grand-parent/parent/child

我喜欢它只是 www.mysite.com/child

我使用 Joomla 2.5 打开了 url rewrite/sef。

谢谢，

将要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-27T22:57:03.567

无需任何解决方法。它直接工作。

（为 J 2.5 编写，但 J 3 应该相同）

1.  选择要从 SEF URL（提供 url 的父菜单）中删除的菜单项。从菜单管理器打开它

2.  在左侧标题为“详细信息”的部分中，有一行带有“别名”。在它旁边有一个“继承”按钮。单击它，使其变为“未继承”。

3.  保存并关闭

4.  瞧！它消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T06:05:43.033

有一种解决方法。

创建一个单独的菜单并在该菜单中创建具有所需别名的菜单项。然后在首先要链接的菜单上，创建一个菜单别名类型的菜单项，然后选择单独的菜单项作为目标。这样，任何别名类型的菜单项都不会出现父别名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-24T19:25:13.633

它与“直接别名”扩展一起使用。

[http://extensions.joomla.org/extension/direct-alias](http://extensions.joomla.org/extension/direct-alias)

安装后，“别名”旁边会出现“继承”按钮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-06-17T00:47:03.640

我刚刚遇到了类似的问题，这个插件完美地满足了我的需求。这节省了我创建 301 重定向的工作时间。我必须购买专业版才能控制单个菜单项。这为您提供了 Ben Shomer 上面描述的功能，例如在它旁边有一个“继承”按钮。单击它，使其变为“未继承”。免费版控制所有菜单项别名。很棒的插件，强烈推荐。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-21T16:53:58.370

要执行您想做的事情：

1-安装“直接别名”扩展：[http ://extensions.joomla.org/extension/direct-alias](http://extensions.joomla.org/extension/direct-alias)

2- 转到**“菜单”** -> **“所有菜单项”**并选择您的菜单项。在**“别名**”字段之后，您将有两个按钮**“相对”**和**“继承”**。点击**“亲戚”**。它将转换为**“直接**”。保存并测试。现在，您的菜单中有您的子项目的直接链接。

**注意：如果您没有安装 Direct “Direct Alias” 扩展，这两个按钮将不会显示。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T21:49:12.317

我不确定核心 Joomla 是否可行。

您可以使用 sh404 扩展来实现这一点 - 并完全控制您的 SEF url。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-03T16:20:45.457

I solve it by following these steps.

*   Create a hidden menu which is your `child` menu. ([For creating the hidden menu](https://www.joomshaper.com/blog/how-to-create-hidden-menu-items-in-joomla) go to the ***Link Type*** tab and select ***No*** for ***Display in Menu*** option).

*   Then create your `parent` menu with a type of anything under the ***System Links*** (except ***Menu Item Alias***)

*   Create a menu (*as a child of the `parent` menu you have created before*) with the type of ***Menu Item Alias*** and select the hidden `child` menu you've created before as the ***Menu Item***.

That's all. Now you can show your menu structure like-

```
|-Parent
|--Child 
```

And when you click on the `Child` link the URL will look like `mysite.com/child`

# permissions - Capifony setfacl 权限：“不允许操作”

> ID：14718533
> 
> 赞同：4
> 
> 时间：2013-02-05T22:54:42.900
> 
> 标签：permissions, nginx, capistrano, acl, capifony

我有一个用户`didongo`（用户和组`didongo`）和 nginx 服务器（用户和组`www-data`）。我已经设置 Capifony 以`didongo`用户身份登录：我第一次部署`setfacl`命令工作正常（而日志文件夹为空）。但是在由 nginx 提供服务的 Web 应用程序生成了一些日志 (prod.log) 之后，下一次部署失败并出现`setfacl`错误。

我确定我在用户和 Web 服务器之间的权限上犯了一个 noob 错误，但我没有看到什么错误。我看到`didongo`应该无法更改他没有权限的文件的权限。但是，我应该如何配置服务器或 Capifony？

谢谢！

相关（希望如此） Capifony deploy.rb 配置：

```
set :user,                  "didongo"
set :webserver_user,        "www-data"
set :permission_method,     :acl
set :use_set_permissions,   true

set :shared_children,       [app_path + "/logs", web_path + "/uploads", "vendor"]
set :writable_dirs,         ["app/cache", "app/logs"] 
```

这是 Capifony 错误：

```
$ setfacl -R -m u:didongo:rwx -m u:www-data:rwx /home/didongo/staging/shared/app/logs
setfacl: /home/didongo/staging/shared/app/logs/prod.log: Operation not permitted 
```

ACL 的一些数据：

```
$ getfacl app/logs

# file: logs
# owner: didongo
# group: didongo
user::rwx
user:www-data:rwx
user:didongo:rwx
group::rwx
mask::rwx
other::r-x
default:user::rwx
default:user:www-data:rwx
default:user:didongo:rwx
default:group::rwx
default:mask::rwx
default:other::r-x

# file: logs/prod.log
# owner: www-data
# group: www-data
user::rw-
user:www-data:rwx               #effective:rw-
user:didongo:rwx                #effective:rw-
group::rwx                      #effective:rw-
mask::rw-
other::r-- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-05T08:42:27.710

用 sudo 试试这个，之后你就不需要使用 sudo

```
sudo sh -c 'setfacl -R -m u:didongo:rwX -m u:www-data:rwX /home/didongo/staging/shared/app/logs' 
```

因为需要设置`x+`权限，所以看这篇[什么是尾随加号表示](http://www.linuxnix.com/2011/12/trailing-drwxr-xr-x-linux-permissions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T08:12:29.037

这里的问题是该`prod.log`文件是自动创建的，所以它的所有者是`www-data`. Capifony 以`didongo`用户身份运行部署。一个用户不能`setfacl`对另一个所有者的文件做任何事情。

所以只需添加`didongo`到组中`www-data`：`sudo adduser didongo www-data`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T12:16:07.517

最后，我管理这个创建具有与用户相同权限的不同 PHP-FPM 池。这样我就可以让不同的用户彼此分开。作为奖励 deploy.rb 被简化。

# ios - 如何通过移动客户端 oauth-login 服务器应用程序（尤其是 iOS、Twitter，但通常也是如此）

> ID：14718537
> 
> 赞同：2
> 
> 时间：2013-02-05T22:54:52.590
> 
> 标签：ios, facebook, web-applications, twitter, oauth

我们有一个 Web 应用程序，它支持 Facebook 和 Twitter 通过 oAuth 登录/注册（也可以发布到 FB/TW）。现在我们正在构建一个移动客户端，我们自然希望人们能够在移动设备上通过 FB-Twitter 登录注册，在 iOS 上甚至使用系统集成帐户。

现在移动应用程序和我们的服务器应用程序是两个不同的应用程序，但是，如果我正确获取 oAuth，我们将需要进行两种身份验证：一个用于移动客户端（可以使用系统帐户），另一个用于服务器（我们'将不得不为它显示 WebView）。

然而，一些现有的应用程序似乎只适用于单一身份验证（例如 Flickr 和 Foursquare！至少 4sq 似乎只适用于 iOS 系统 FB 帐户。​​这怎么可能？

*   他们是否在移动和网络应用程序之间共享消费者密钥/秘密，使其本质上是相同的应用程序？
*   他们是否对 oAuth 使用了一些特定于 FB 的扩展
*   他们是否只使用身份验证令牌，无论它来自于将其设为用户 ID 吗？
*   完全不同的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-06T19:52:00.167

老问题，但这可能会帮助在这里找到路的人。

[Twitter 反向认证](https://dev.twitter.com/docs/ios/using-reverse-auth)

# java - Java发送时PHP POST变量不等效

> ID：14718540
> 
> 赞同：1
> 
> 时间：2013-02-05T22:54:58.863
> 
> 标签：java, php, mysql, pdo

我已经为这段代码苦苦挣扎了将近 16 个小时，结果对我来说仍然毫无意义。

我正在做的是制作一个将 POST 参数发送到 URL 的 Java 程序。我也在使用带有 Firefox 的表单测试相同的方法。

问题是，在 Firefox 上，我测试了正在发送的值并将其回显。我还根据我知道它应该相等的值测试该值，但是当 Java 发送该值时，它返回 false，但 Firefox 返回 true，这是为什么呢？

PHP代码：

```
 $player = array('code' => "code");
    $msg = "neither";

    if(isset($_POST['player']))
    {
        $player = getPlayer(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME, DB_TABLE_NAME, $_POST['player']);
        $msg = "?player=" . $_POST['player'] . " post";
    }

    function getPlayer($DbHost, $DbUsername, $DbPassword, $DbName, $DbTableName, $name)
    {
        try
        {
            $dsn = "mysql:host=$DbHost;dbname=$DbName"; //Data Source Name = MySQL
            $dbc = new PDO($dsn, $DbUsername, $DbPassword); //Connect to DB

            $query = "SELECT * FROM $DbTableName WHERE name = :name";
            $result = $dbc->prepare($query); //Prepare query

            if($name == "pathurs")
            {
                echo 'true:' . $name;
            }
            else
            {
                echo 'false:' . $name;
            }

            $result->bindParam(':name', $name, PDO::PARAM_STR);

            $result->execute(); //Execute Query

            while($row = $result->fetchObject()) //Loop through results
            {
                $array = array();

                //Convert stdClass($row) to array($array)
                foreach($row as $key => $value)
                {
                    $array[$key] = $value;
                }

                $dbc = null;
                return $array;
            }
        }
        catch(PDOException $e)
        {
            echo $e->getMessage();
        }
    }

    echo "code:" . $player['code'] . $msg . $_POST['player']; 
```

Java 代码：

```
public String getContent(String url, String params)
    {
        String result = "";

        try
        {
            this.url = new URL(url);
            try
            {
                URLConnection con = this.url.openConnection();
                con.setDoOutput(true);

                PrintStream ps = new PrintStream(con.getOutputStream());
                ps.println(params);

                InputStream is = con.getInputStream();
                BufferedReader in = new BufferedReader(new InputStreamReader(is));
                String line = "";

                while((line = in.readLine()) != null)
                {
                    result += line;
                }

                System.out.println(result);
            }
            catch(IOException e)
            {
                e.printStackTrace();
            }
        }
        catch(MalformedURLException e)
        {
            e.printStackTrace();
        }

        return result;
    } 
```

火狐输出：

```
true:pathurscode:code?player=pathurs postpathurs 
```

Java 程序输出：

```
false:pathurscode:?player=pathurs postpathurs 
```

为什么当我比较时`$name == "pathurs"`（在第 20 行的 PHP 代码中）它在 Firefox 中为真，但在 Java 中为假？看到它们都在 PHP 页面中测试并且它们都是字符串，并且它们都在 echo 中输出它们都等于一种形式，这对我来说没有意义`'pathurs'`

是不是我做错了什么？我目前无法理解它只会在 Java 发送信息而不是 Firefox 发送信息时发生的原因。我通过将 PDO 查询替换为：

```
$query = "SELECT * FROM $DbTableName WHERE name = 'pathurs'"; 
```

它在两个输出上都能完美运行。这让我更加困惑。我希望有人能帮帮忙！

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:05:01.380

这是因为您正在使用：

```
ps.println(params); 
```

所以它在参数之后发送一个换行符，即：`player=pathurs\n`

尝试：

```
ps.print(params); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T23:00:39.300

我没有在您的代码中看到进行比较的位置，但是我可以告诉您有关 java 的信息：

在 java 中比较 2 个字符串时，不要使用 ==，使用字符串类 .equals 方法或 compareTo 或类似的方法。原因是，在java中，两个字符串只有在它们引用同一个对象时才==。当您创建字符串时，Java 通常会自行执行此操作，如果您创建一个名为“name”的字符串，然后在程序的其他地方创建另一个名为“name”的字符串，它会环顾四周并说“嘿，他已经创建了一个名为名称，让我们使用指向它的指针”这可能会使人们感到困惑，因为它使得 == 通常为真，但它是不可靠的。

所以我的猜测是，由于其中一个字符串是从程序外部接收的，它们不是指同一个字符串对象，因此不是 ==。

如果我误解了这个问题，我深表歉意:)

# python - 自然语言处理 - 类似于 ngram

> ID：14718543
> 
> 赞同：3
> 
> 时间：2013-02-05T22:55:07.430
> 
> 标签：python, nlp, nltk, n-gram

我目前正在从事一个 NLP 项目，该项目试图区分上下文中的同义词（从 Python 的 NLTK 和 WordNet 接收）。我研究了很多 NLP 概念，试图找到我想要的东西，我找到的最接近的东西是 n-gram，但它并不完全适合。

假设我试图找到动词“盒子”的正确定义。“盒子”可以表示“战斗”或“包裹”；然而，在文本的其他地方，出现了“戒指”或“战斗机”这个词。据我了解，n-gram 将是“box fighter”或“box ring”，这作为一个短语相当可笑，而且不太可能出现。但是在概念图上，“盒子”动作可能与“环”相关联，因为它们在概念上是相关的。

n-gram 是我想要的吗？这个还有别的名字吗？关于在哪里寻找检索此类关系数据的任何帮助？

感谢所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:03:01.757

您可能想研究一下`word sense disambiguation (WSD)`，这是确定一个词的哪个“意义”（意义）是通过在特定上下文中使用该词来激活的问题，这个过程在人们看来很大程度上是无意识的。

# c# - 正则表达式验证逻辑 && || 字符串中的运算符

> ID：14718556
> 
> 赞同：6
> 
> 时间：2013-02-05T22:56:41.303
> 
> 标签：c#, regex, string

我正在尝试创建一个正则表达式来验证逻辑`&&` `||`字符串组合及其相应的左括号和右`()`括号。

我一直在搞乱正则表达式象形文字模式，但似乎无法让它正常工作，主要是因为我完全不了解正则表达式模式。

经过几个小时的 StackOverflow 和谷歌，这是我到目前为止所拥有的，我觉得我很接近。

```
 private void ValidationTest()
    {
        string hieroglyphics = @"^(?=^[^()]*\((?>[^()]+|\((?<DEPTH>)|\)(?<-DEPTH>))*(?(DEPTH)(?!))\)[^()]*$)[(]*\d+[)]*(\s+(&&|\|\|)\s+[(]*\d+[)]*)*$";

        var tests = new List<string>
        {
            // Working
             "(1 && 2)",
             "((1 && 2) && (3 || 4))",
             "((1 && 2) && (3 || 4) || ((1 && 2) && (3 || 4)))",

            // Not working
            "(Stack && Overflow)"
        };

        if (tests.All(test => Regex.IsMatch(test, hieroglyphics)))
        {
            MessageBox.Show("Woohoo!!");
        }
    } 
```

所以到目前为止我所拥有的主要问题是如果没有括号`1 && 2`它不会验证，与`(1 && 2) && (3 || 4)`. 它似乎也忽略了所有单词`(Stack && Overflow)`

我试图验证的一些字符串的示例。

```
"IsRecording && IsPlaying"
"IsVisible && (IsPlaying && (IsMusic || IsRadio))" 
```

还有一些关键字包含可能会搞砸的小括号示例：

```
"IsWindowVisible(2) && (IsControlVisible(22) && IsControlFocused(100))" 
```

**编辑：** 因为现在这个表达式可以很好地验证我需要的那种复杂性，但是我唯一真正的问题是它只有 nubers。

可以很好地验证的复杂示例`Regex`

```
"((1 && 2) && (3 || 4) || ((1 && 2) && (3 || 4)))" 
```

一个简单的字符串`1 && 2`不会在没有括号的情况下验证，但我不介意在这些字符串中添加括号。

我只需要添加对单词的支持而不仅仅是数字，如果有帮助的话，这将是一个固定的单词列表。

如果有人能发现错误或为我指出更好的方向，那就太好了谢谢

## 编辑：

[mellamokb](https://stackoverflow.com/users/116614/mellamokb)的回答非常完美。看来麻烦是`d+`需要的`0-9a-zA-Z()`

这是对其他人有用的模式。

```
 string hieroglyphics = @"^(?=^[^()]*(?>[^()]+|\((?<DEPTH>)|\)(?<-DEPTH>))*(?(DEPTH)(?!))[^()]*$)[(]*[0-9a-zA-Z()]+[)]*(\s+(&&|\|\|)\s+[(]*[0-9a-zA-Z()]+[)]*)*$"; 
```

它准确地验证了我的需要

例子：

```
 "IsPlayer(Video) && Player(Playing)",
 "((IsPlayer(Video) && (Player(Playing) && ControlIsVisible(34))) || (IsPlayer(Video) && (Player(Playing) && ControlIsVisible(34)))) && ControlIsFocused(22)" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T00:01:22.357

我认为您无法在没有包装的情况下验证表达式的原因是`()`核心嵌套逻辑中的包装括号。如果您取出我在下面记下的以下括号，则其他两个非包装表达式将有效：

```
^(?=^[^()]*\((?>[^()]+|\((?<DEPTH>)|\)(?<-DEPTH>))*(?(DEPTH)(?!))\)[^()]*$...
           ^^ remove this                            remove this ^^ 
```

然后，为了允许不仅是数字的表达式，您需要`\d`用更自由的定义来替换您的限制，以定义您想要验证的内容，例如`[0-9a-zA-Z]`：

```
...[(]*\d+[)]*(\s+(&&|\|\|)\s+[(]*\d+[)]*)*$
       ^^ change these expression ^^ 
```

所以它会变成：

```
...[(]*[0-9a-zA-Z]+[)]*(\s+(&&|\|\|)\s+[(]*[0-9a-zA-Z]+[)]*)*$ 
```

演示：http: [//ideone.com/jwkcpL](http://ideone.com/jwkcpL)

# javascript - 如何检查一个数字是否在两个值之间？

> ID：14718561
> 
> 赞同：176
> 
> 时间：2013-02-05T22:56:54.690
> 
> 标签：javascript

在 JavaScript 中，如果窗口大小大于 500 像素，我会告诉浏览器执行某些操作。我这样做：

```
if (windowsize > 500) {
    // do this
} 
```

这很好用，但我想应用同样的方法，但有一系列数字。所以我想告诉我的浏览器在窗口大小在 500px 到 600px 之间时做些什么。我知道这行不通，但这是我的想象：

```
if (windowsize > 500-600) {
    // do this
} 
```

在 JavaScript 中这是否可能？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2013-02-05T22:58:29.710

测试是否`windowsize`大于`500`和小于`600`意味着值`500`或`600`本身都不会导致条件变为真。

```
if (windowsize > 500 && windowsize < 600) {
  // ...
} 
```

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2013-09-18T20:31:51.710

我有一点时间，所以，虽然你已经接受了答案，但我想我会贡献以下内容：

```
Number.prototype.between = function(a, b) {
  var min = Math.min.apply(Math, [a, b]),
    max = Math.max.apply(Math, [a, b]);
  return this > min && this < max;
};

var windowSize = 550;

console.log(windowSize.between(500, 600));
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/6P2q4/)。

或者，如果您希望选择检查数字是否在定义的范围内，*包括端点*：

```
Number.prototype.between = function(a, b, inclusive) {
  var min = Math.min.apply(Math, [a, b]),
    max = Math.max.apply(Math, [a, b]);
  return inclusive ? this >= min && this <= max : this > min && this < max;
};

var windowSize = 500;

console.log(windowSize.between(500, 603, true));
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/6P2q4/1/)。

鉴于——如评论中所述——编辑对上述内容进行了小修改

> ……`Function.prototype.apply()`慢！除了当你有固定数量的参数时调用它是没有意义的......

值得删除的使用`Function.prototype.apply()`，它产生上述方法的修改版本，首先没有“包容性”选项：

```
Number.prototype.between = function(a, b) {
  var min = Math.min(a, b),
    max = Math.max(a, b);

  return this > min && this < max;
};

var windowSize = 550;

console.log(windowSize.between(500, 600));
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/6P2q4/39)。

并使用“包容性”选项：

```
Number.prototype.between = function(a, b, inclusive) {
  var min = Math.min(a, b),
    max = Math.max(a, b);

  return inclusive ? this >= min && this <= max : this > min && this < max;
}

var windowSize = 500;

console.log(windowSize.between(500, 603, true));
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/6P2q4/40)。

参考：

*   [`Function.prototype.apply()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply).
*   [`Math.max()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/max).
*   [`Math.min()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/min).

* * *

## 回答 #3

> 赞同：99
> 
> 时间：2013-02-05T23:06:07.587

我更喜欢将变量放在里面，以提供额外的提示，即代码正在验证我的变量是否在一个范围值之间

```
if (500 < size && size < 600) { doStuff(); } 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2017-05-25T15:12:14.070

这是一个老问题，但可能对像我这样的人有用。

`lodash`具有`_.inRange()`功能[https://lodash.com/docs/4.17.4#inRange](https://lodash.com/docs/4.17.4#inRange)

例子：

```
_.inRange(3, 2, 4);
// => true 
```

请注意，此方法使用`Lodash`实用程序库，并且需要访问已安装的 Lodash 版本。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-12-04T06:21:56.900

您可以在条件中使用 Multiple 子句`if`而不是编写

```
if (windowsize > 500-600) {
    // do this
} 
```

因为这在逻辑上真的没有意义 JavaScript 会读取你的 if 条件

```
windowSize > -100 
```

因为它计算`500-600`为`-100`

您应该使用`&&`严格检查这两种情况，例如看起来像这样

```
if( windowSize > 500 && windowSize < 600 ){

// Then doo something

} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-11-25T07:58:55.170

这是一个通用方法，你可以在任何地方使用

```
const isBetween = (num1,num2,value) => value > num1 && value < num2 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-08-23T12:11:24.493

你可以简单地做到这一点

```
if (windowsize > 500 && windowsize < 600) {
//your logic
} 
```

或者，如果您想要**干净的代码**，您可以在任何常见位置的主 js 文件中编写自己的函数。

```
Number.prototype.between = function(a, b) {
 var min = Math.min.apply(Math, [a, b]),
    max = Math.max.apply(Math, [a, b]);
  return this > min && this < max;
}; 
```

然后你可以这样称呼它

```
if(windowsize.between(500, 600)){
 //your logic
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-28T08:52:28.837

这是可能的最短方法：

```
if (Math.abs(v-550)<50) console.log('short')
if ((v-500)*(v-600)<0) console.log('short') 
```

参数化：

```
if (Math.abs(v-max+v-min)<max+min) console.log('short')
if ((v-min)*(v-max)<0) console.log('short') 
```

如果你不明白第一个是如何工作的，你可以将两边除以 2；）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-18T20:22:51.360

我刚刚实现了一点 jQuery 来显示和隐藏引导模式值。根据用户文本框条目的值范围显示不同的字段。

```
$(document).ready(function () {
    jQuery.noConflict();
    var Ammount = document.getElementById('Ammount');

    $("#addtocart").click(function () {

            if ($(Ammount).val() >= 250 && $(Ammount).val() <= 499) {
                {
                    $('#myModal').modal();
                    $("#myModalLabelbronze").show();
                    $("#myModalLabelsilver").hide();
                    $("#myModalLabelgold").hide();
                    $("#myModalPbronze").show();
                    $("#myModalPSilver").hide();
                    $("#myModalPGold").hide();
                }
            }
    }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-22T15:06:44.290

就像大卫的回答一样，但我需要 a 或 b 的包容性。所以我的溶胶：

```
export const between = (num: number, a: number, b: number, inclusiveA = true, inclusiveB = true): boolean => {
  if (a > b) [a, b, inclusiveA, inclusiveB] = [b, a, inclusiveB, inclusiveA];
  if (a == b && (inclusiveA || inclusiveB)) [inclusiveA, inclusiveB] = [true, true];
  return (inclusiveA ? num >= a : num > a) && (inclusiveB ? num <= b : num < b);
};

if (require.main === module) {
  console.log(between(12, 15, 10)); //true
  console.log(between(15, 15, 10)); //true
  console.log(between(15, 10, 15)); //true
  console.log(between(10, 10, 15, false)); //false
  console.log(between(15, 10, 10, true, false)); //false

  //edge case: if a==b then enough that either of the edges is inclusive
  console.log(between(10, 10, 10, true, false)); //true
} 
```

它也是打字稿而不是javascript

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-08-23T11:57:11.177

```
 function handleBetween(number, calc) {
        let [a, b] = calc;
        let min = Math.min(a, b), max = Math.max(a, b);
        return number > min && number < max;
    }

    if(510 >500 && 510 <600){
    console.log(`510 >500 && 510 <600 is true`)
    }

    if(610 >500 && 610 <600){
    // false
    console.log(`610 >500 && 610 <600 is true`)
    } else console.log(`610 >500 && 610 <600 is false`)

     console.log(handleBetween(510, [500, 600])); // true
     console.log(handleBetween(610, [500, 600])); // false
```

# c++ - 空表达式的计算结果是否为 NOP？

> ID：14718562
> 
> 赞同：3
> 
> 时间：2013-02-05T22:57:10.787
> 
> 标签：c++

想知道空表达式是否计算为 NOP 或者它是否依赖于编译器。

```
// Trivial example
int main()
{
    ;;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T22:57:42.800

它依赖于编译器，但可观察到的行为必须是什么都没有发生。在实践中，我确信大多数编译器根本不会为空表达式省略任何代码。

> 执行格式良好的程序的一致实现应产生与具有相同程序和相同输入的抽象机的相应实例的可能执行之一相同的可观察行为。

可观察的行为由以下定义：

> 对一致性实现的最低要求是：
> 
> *   对 volatile 对象的访问严格按照抽象机的规则进行评估。
> *   在程序终止时，写入文件的所有数据应与根据抽象语义执行程序可能产生的结果之一相同。
> *   交互式设备的输入和输出动态应该以这样一种方式发生，即在程序等待输入之前实际交付提示输出。构成交互式设备的内容是实现定义的。
> 
> 这些统称为程序的*可观察行为*。

这实际上是实现的唯一要求。它通常被称为“as-if”规则——只要可观察到的行为符合预期，编译器就可以为所欲为。

对于它的价值，这些空表达式被称为*空语句*：

> 缺少表达式的表达式语句称为空语句。

如果你真的想要一个 NOP，你可以尝试：

```
asm("nop"); 
```

但是，这是有条件地支持的，其行为是实现定义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:59:38.087

> 或者如果它依赖于编译器。

它依赖于编译器（“as-if rule”），但大多数合理的优化编译器会为了效率而忽略空语句，并且它们通常不会发出`NOP`指令。

# button - 在 iOS 6 的 TableView 中创建一个按钮

> ID：14718572
> 
> 赞同：0
> 
> 时间：2013-02-05T22:58:09.137
> 
> 标签：button, ios6, tableview

是否可以在 ios 6 的 TableView 内创建一个按钮？

一个示例是在设置 --> 邮件、日历... --> 单击现有电子邮件帐户（在 iPhone 上）。在此视图的底部有一个“按钮”，表示删除帐户。

这是一个按钮还是只是另一个看起来像按钮的单元格？

我想保留 TableView 附带的标准背景，这就是我要询问的原因。我知道我可以缩短 TableView 并添加一个普通按钮。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T23:57:51.527

在 GitHub 上查看我的代码。[https://github.com/eddieios/ECFormView](https://github.com/eddieios/ECFormView)

ECFormView 使用一个 UITableView，并在 tableFooterView 中添加了一个按钮。我把相关的代码放在下面。

```
UIView *footerView = [[UIView alloc] init];
[footerView setFrame:CGRectMake(0, 0, 320, 100)];
self.tableView.tableFooterView = footerView;
[self.tableView sendSubviewToBack:footerView];

UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[footerView addSubview:button];
[button setFrame:CGRectMake(10, 10, 300, 44)];
[button setTitle:@"Submit" forState:UIControlStateNormal];
//[button addTarget:self action:@selector(nextView:) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T19:55:47.280

您可以通过将按钮作为子视图添加到表视图的`tableHeaderView`or来完成此操作。`tableFooterView`这篇 SO 帖子描述了一些实现：[在 UITableView 标头的标头中添加 UIButton](https://stackoverflow.com/questions/3866182/adding-a-uibutton-in-the-header-of-uitableview-header)

iOS 6 添加了一个`UITableViewHeaderFooterView`实现页眉和页脚的*可重用视图的类。*这可以提高处理大型表视图时的性能。请参阅：[如何使用 UITableViewHeaderFooterView？](https://stackoverflow.com/questions/12900446/how-to-use-uitableviewheaderfooterview)

# jquery - jQuery ajax 成功调用不影响接收到的元素

> ID：14718574
> 
> 赞同：0
> 
> 时间：2013-02-05T22:58:13.283
> 
> 标签：jquery, ajax

我正在使用 ajax 从 .php 文件接收数据并将其显示在页面上。接收到的数据有一个 id 为“question0”“question1”“question2”等的 div 列表。我需要成功调用来更改这些元素的某些 css 值。这是我的代码，

```
$.ajax({ 
                            type: "POST",
                            data : { TestID: testID[0] },
                            cache: false,  
                            url: "load-test.php",   
                            success: function(data){
                                $(".main-section").html(data);
                                $("#question1").css('display','none');                      
                            }   
                        });   
                        return false; 
});
}); 
```

div 列表加载到页面上，但 CSS 不受影响，求助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T03:29:11.097

我假设 #question1 ID 是从 load-test.php 返回的，元素在第一次运行后不会影响 css，除非使用类属性，但您还需要为该类预定义样式。

# c# - Linq：选择一个新列表 在 C# 中

> ID：14718579
> 
> 赞同：2
> 
> 时间：2013-02-05T22:58:32.730
> 
> 标签：c#, linq

使用**linq**我试图获得一个**List[Guid]**，但我做不到。

我试过这个：

```
var myGuidList = from x in
                 mydatasource
                 where x.Field==value
                 select new Guid(){x.TheGuid};   <- Problem here 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T23:00:40.360

目前尚不清楚`TheGuid`属性的类型是什么，但如果它是一个字符串，您可以使用以下内容：

```
IEnumerable<Guid> myGuidList = 
    from x in mydatasource
    where x.Field == value
    select new Guid(x.TheGuid); 
```

如果它是一个 Guid，那么你可以直接选择它：

```
IEnumerable<Guid> myGuidList = 
    from x in mydatasource
    where x.Field == value
    select x.TheGuid; 
```

如果你想得到 a `List<Guid>`，只需`.ToList()`在结果上使用扩展方法：

```
List<Guid> guids = myGuidList.ToList(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T23:00:33.247

`Guid`如果您已经有一个，为什么还需要创建一个新的实例？

```
var myGuids = from x in
              mydatasource
              where x.Field == value
              select x.TheGuid; 
```

（假设这`x.TheGuid`是`Guid`当然）

如果你想要一个`List<Guid>`：

```
List<Guid> myGuidList = myGuids.ToList(); 
```

请注意，`Guid`没有构造函数采用（无论如何都没[有意义](http://msdn.microsoft.com/en-us/library/system.guid.guid.aspx)）`Guid`或无参数构造函数，并且它也没有属性（只是一个字段`Empty`），这就是您的代码无法编译的原因。

# java - Java MySQLpreparedStatement 批处理

> ID：14718580
> 
> 赞同：1
> 
> 时间：2013-02-05T22:58:33.143
> 
> 标签：java, mysql, batch-file, prepared-statement

我正在尝试使用preparedStatement Batch，但我遇到了问题。

下面的代码没有给我错误，但它只在表中插入地图的最后一个键，我不知道为什么。

这肯定是一个非常愚蠢的错误，但这是我第一次使用 addBatch() 方法..

```
 Class.forName("com.mysql.jdbc.Driver");
        this.connect = DriverManager.getConnection("jdbc:mysql://localhost/" + this.database + "?user=" + this.user + "&password=" + this.password);
        String s;
        for (String key : this.map.keySet())
        {
            s = ("insert into " + this.database + ".user (nickname) values (?)");
            this.preparedStatement = this.connect.prepareStatement(s);
            this.preparedStatement.setString(1, key);
            this.preparedStatement.addBatch();
        }

        this.preparedStatement.executeBatch(); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T23:03:14.660

在循环之外准备语句和查询：

```
 s = ("insert into " + this.database + ".user (nickname) values (?)");
      this.preparedStatement = this.connect.prepareStatement(s);
      for (String key : this.map.keySet())
        {
            this.preparedStatement.setString(1, key);
            this.preparedStatement.addBatch();
        }
        this.preparedStatement.executeBatch(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T23:03:25.610

您错误地使用了 addBatch() 方法。在您的代码中，您正在 for 循环的每次迭代中执行 prepareStatement，这每次都会替换准备好的查询。

您应该每批只调用一次 prepareStatement 。您应该将准备好的语句放在循环之前（只有一次调用）

# html - 如何使用 Xcode 编码奇怪的 HTML 字符？

> ID：14718587
> 
> 赞同：0
> 
> 时间：2013-02-05T22:59:04.370
> 
> 标签：html, objective-c, encoding

我需要在我的应用程序中保存一个 HTML 页面，当找到像“€”这样的字符时，保存的文件显示错误。我尝试了几种编码，但都没有解决这个问题，有什么解决方案吗？我也尝试替换 HTML 名称的字符，但它仍然不起作用。这是我的代码：

```
 NSString *HTML = [web stringByEvaluatingJavaScriptFromString:@"document.getElementsByTagName('html')[0].innerHTML;"];

    NSArray *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *filePath = [NSString stringWithFormat:@"%@/%@", [path objectAtIndex:0],@"code.html"];

    int enc_arr[] = {
        NSISOLatin1StringEncoding,      // ESP
        NSUTF8StringEncoding,           // UTF-8
        NSShiftJISStringEncoding,       // Shift_JIS
        NSJapaneseEUCStringEncoding,    // EUC-JP
        NSISO2022JPStringEncoding,      // JIS
        NSASCIIStringEncoding           // ASCII
    };

    NSData *urlData= nil;

    for (int i=0; i<6; i++) {
        urlData = [HTML dataUsingEncoding:enc_arr[i]];
        if (urlData!=nil) {
            break;
        }
    }

    [urlData writeToFile:filePath atomically:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:12:58.507

请参阅以下方法`NSString`：

```
- (NSStringEncoding)smallestEncoding
- (NSStringEncoding)fastestEncoding 
```

或者只是使用下面的方法`flag`设置为`YES`：

```
- (NSData *)dataUsingEncoding:(NSStringEncoding)encoding allowLossyConversion:(BOOL)flag 
```

但有了这个，你可以失去一些角色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:59:27.070

好的，我终于做到了，这不是最好的方法，而是唯一对我有用且不使用外部库的方法：

```
-(NSString*)escapeHTML:(NSString*)code{

    NSMutableArray *maExceptions = [[NSMutableArray alloc] initWithObjects: @"Œ", @"œ", @"Š", @"š", @"Ÿ", @"ƒ", @"‘", @"’", @"‚", @"“", @"”", @"„", @"†", @"‡", @"•", @"…", @"‰", @"€", @"™", nil];

    for (int i=0; i<[maExceptions count]; i++) {
        code = [code stringByReplacingOccurrencesOfString:[maExceptions objectAtIndex:i] withString:[NSString stringWithFormat:@"&#x%x;",[[maExceptions objectAtIndex:i] characterAtIndex:0]]];

    }

    return code;
} 
```

# windows - 给定变量中的转义百分号

> ID：14718591
> 
> 赞同：5
> 
> 时间：2013-02-05T22:59:18.237
> 
> 标签：windows, batch-file, escaping, cmd

我的第一篇文章，大多数问题已经使用这里提供的友好知识解决了。但是现在我的想法已经用完了，又是一个关于在 cmd.exe 中处理毒字符的问题。

假设有一个用双引号括起来的给定字符串变量。大多数毒字符之前已经被普通字符替换了，剩下的扰乱脚本的是“&”、“(”、“)”和“%”。之后必须将该字符串回显到不带引号的文件中。于是我萌生了将毒字逃出三倍的念头：

```
@echo off & setlocal ENABLEEXTENSIONS
SET AlbumArtist=%1
CALL :EscapePoisonChars %AlbumArtist% AlbumArtist_VDN

SET "FlacHyperLink==hyperlink^("file://%AlbumArtist_VDN%"^;"LossLess"^)")
echo %FlacHyperLink%
echo %AlbumArtist_VDN%

endlocal &GOTO:EOF

:EscapePoisonChars
@echo off & setlocal ENABLEEXTENSIONS
SET TmpString=%1
SET TmpString=%TmpString:&=^^^&%
SET TmpString=%TmpString:(=^^^(%
SET TmpString=%TmpString:)=^^^)%
endlocal&SET %2=%TmpString:~1,-1%&GOTO :EOF 
```

当我在上面调用我的脚本时，我得到了预期的输出——除了缺少的百分号：

```
G:\YAET\20130204_Work>TryAmper.bat "100% Rock & Roll (7' UpMix)"
=hyperlink("file://100 Rock & Roll (7' UpMix)";"LossLess")
100 Rock & Roll (7' UpMix)

G:\YAET\20130204_Work> 
```

我知道百分比可以自行逃脱。所以“%%”通常会导致一个单一的文字“%”。但是我不可能找到百分号的有效替换过程，因为 cmd 总是将其解释为变量并尝试扩展它。这是处理这个问题的完全错误的方向还是只是对变量扩展的误解？欢迎任何提示！谢谢！

干杯，马丁

**编辑** 删除了自己的代码，请参阅下面 Jeb 对干净解决方案的回答。

谢谢你的帮助，马丁

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T23:36:58.123

好问题！
起初，是的，您可以替换偶数百分比符号，但不能在百分比扩展内，您需要在这里延迟扩展。

```
Setlocal EnableDelayedExpansion
set tmpstr=!tmpstr:%=%%! 
```

但是，如果您使用延迟扩展，则不再需要转义，因为延迟扩展是批处理解析器的最后阶段，所有字符都失去了任何特殊含义。
您只需要响应延迟扩展。

```
Echo !tmpvar! 
```

**编辑：清洁解决方案**

```
@echo off
setlocal DisableDelayedExpansion

REM * More or less secure getting the parameter
SET "AlbumArtist=%~1"

setlocal EnableDelayedExpansion
SET "FlacHyperLink==hyperlink("file://!AlbumArtist!";"LossLess")"

echo !FlacHyperLink!
echo !FlacHyperLink!> hugo.txt 
```

您首先需要 disableDelayedExpansion ，才能从`%1`.
之后，您应该切换到延迟扩展并在任何地方使用它。

# c# - 带有哈希键的查询字符串以访问搜索结果

> ID：14718593
> 
> 赞同：0
> 
> 时间：2013-02-05T22:59:29.737
> 
> 标签：c#, hash, key, md5, salt

我需要尽快帮助（我只是被要求在明天早上提出解决方案）。首席开发人员让我想出一个可能已经存在的解决方案来解决以下问题：

我们有第三方网站公开使用的 C# 搜索结果页面，但我们将通过传递到查询字符串的哈希键添加访问限制。

首先，第三方网站开发人员将访问一个我们将创建的新页面，以根据他们所处的状态自动生成哈希密钥。然后他们会将密钥添加到他们的链接中。当我们从他们的链接之一收到请求时，我们将尝试将密钥与我们在数据库中的内容进行匹配，以允许访问结果 - 我们还希望检查域/IP 地址等额外信息，以防止欺骗和其他各种攻击。

另一个考虑因素是：我们是否可以使这个密钥系统动态化，使其随着时间的推移而变化，但第三方开发人员不需要回到我们这里来更新他们所拥有的——中间密钥？

问题是这种情况下的最佳解决方案是什么？那里已经有类似的东西了吗？在查询字符串中使用哈希键是正确/最好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:12:57.750

通常在这种情况下，您有一个标识符和一个共享密钥。

标识符在查询中传递，以便您识别用户。共享密钥用于散列算法以提供请求的校验和。这通常在查询字符串中发送（在第三方上很容易）或作为 HTTP 标头发送。

Amazon 在 AWS 中使用这种类型的数字签名和 HMAC-SHA256。[请参阅有关System.Security.Cryptography.HMACSHA256](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hmacsha256.aspx)的 MSDN 文档和有关[Authenticating Requests](http://s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html)的 AWS 文档。单独使用 MD5 或 SHA 也可能适用于您的情况。

假设您有办法将其分发给客户，您可以维护每个用户的共享密钥。

# jquery - 如何在 servlet 中打印标签？

> ID：14718594
> 
> 赞同：-1
> 
> 时间：2013-02-05T22:59:32.560
> 
> 标签：jquery, jsp, servlets

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:02:45.767

你永远不会关闭`href`属性的引用。

输出本身就足以诊断这一点——href 继续运行：

```
out.println("<tr><td><a href=\"VenueServlet?action=edit&userId="+v.getId()+"\">Update</a></td></tr>"); 
```

为什么不在 Java 端生成 HTML 的另一个原因。也考虑使用`String.format`; 当您不必担心字符串数学时，更容易（IMO）阅读这个烂摊子。

此外，如果 ID 来自浏览器，您可能需要适当地转义它。

# asp.net-mvc - 嵌套对象脚手架 ASP.net MVC 3 VB.net

> ID：14718599
> 
> 赞同：0
> 
> 时间：2013-02-05T22:59:53.923
> 
> 标签：asp.net-mvc, vb.net, nested

我是 ASP.net 和 VB.net 的完整初学者，我创建了两个类，一个用于团队，另一个用于夹具，将容纳 2 个团队。

```
Imports System.Data.Entity

Public Class Team
    Public Property ID() As Integer
    Public Property Name() As String
    Public Property Points() As Integer
End Class

Public Class TeamDBContext
   Inherits DbContext
   Public Property Teams() As DbSet(Of Team)
End Class

Imports System.Data.Entity

Public Class Fixture
   Public Property ID() As Integer
   Public Property Week() As Integer
   Public Property HomeTeam() As Team
   Public Property AwayTeam() As Team

End Class

Public Class FixtureDBContext
   Inherits DbContext
   Public Property Fixtures() As DbSet(Of Fixture)
End Class 
```

我创建了一个带有读/写操作和视图的 FixturesController。但是，当我在我的应用程序中创建一个夹具时，我只看到一个 Week 字段，而不是 HomeTeam 或 AwayTeam 字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:06:40.190

那么你需要手动添加它们。Brad Wilson[`nice article`](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-4-custom-object-templates.html)详细解释了如何使模板化助手递归地下降到嵌套模型中。

另外顺便说一句，您可能不需要 2 个数据库上下文，一个就足够了，它可以包含您的团队和夹具：

```
Public Class FixtureDBContext
   Inherits DbContext
   Public Property Teams() As DbSet(Of Team)
   Public Property Fixtures() As DbSet(Of Fixture)
End Class 
```

# java - 在 Java 中模拟完全外连接

> ID：14718607
> 
> 赞同：-1
> 
> 时间：2013-02-05T23:00:39.863
> 
> 标签：java, join, outer-join

假设我在 Java 中有两个数组，我想对它们执行完全外部连接（返回第三个数组）。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T23:05:47.463

我相信[来自 apache commons 的 CollectionUtils](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html)将拥有您需要的一切以及更多。

查看这些方法及其描述：

> **联盟**
> 
> 公共静态 java.util.Collection 联合（java.util.Collection a，java.util.Collection b）
> 
> 返回一个包含给定集合的并集的集合。返回的 Collection 中每个元素的基数将等于两个给定 Collection 中该元素的最大基数。
> 
> 参数：
> 
> a - 第一个集合，不能为空
> 
> b - 第二个集合，不能为 null 返回：两个集合的并集
> 
> 另请参阅：Collection.addAll(java.util.Collection)

这可能是您需要的。但要左右做，我认为你会使用的是：

> **减去**
> 
> 公共静态 java.util.Collection 减法（java.util.Collection a，java.util.Collection b）
> 
> 返回一个包含 a - b 的新集合。返回的 Collection 中每个元素 e 的基数将是 e 在 a 中的基数减去 e 在 b 中的基数或零，以较大者为准。
> 
> 参数：
> 
> a - 要从中减去的集合，不能为 null
> 
> b - 要减去的集合，不能为 null 返回：带有结果的新集合
> 
> 另请参阅： Collection.removeAll(java.util.Collection)

# mysql - 从两个表中选择整行

> ID：14718613
> 
> 赞同：0
> 
> 时间：2013-02-05T23:01:07.160
> 
> 标签：mysql, sql

我不知道这是否可能，我可能会在这里问一个愚蠢的问题，如果可以，请原谅我。
我有两张有些相似但不完全相似的表。
表 1 (user_opinions)

```
 | o_id     | user_id | opinion      |is_shared_from| date,isglobal etc
    |:---------|---------|:------------:|:------------:|
    | 1        |       11|     text 1   | 0
    | 2        |       13|     text 2   | 2
    | 3        |        9|     text 3   | 0 
```

表 2 (Buss_opinions)

```
 | bo_id    | o_id   | user_id      | opinion    | date
    |:---------|--------|:------------:|:------------:|
    | 1        |       2|   52         | bus text 1
    | 2        |       3| 41           | bus text 2 
```

如果我像这样进行标准选择并加入：

```
SELECT * FROM user_opinions uo
JOIN Buss_opinions bo
ON uo.o_id = bo.o_id 
```

这将返回两个表的数据连接在一起的行。

我的问题是，如果我想从这两个表中的单独行中获取数据怎么办。结果应该是这样的：

```
| oid      | bo_id   | opinion      | nb: and other rows from both tables
|:---------|---------|:------------:|
| 1        |    NULL |     text 1   | nb:from table 1
| NULL     |        1|    bus text 1| nb:from table 2
| 2        |    NULL |     text 2   |nb:from table 1 
```

等等

它获取表的数据和没有公共字段的地方，它在字段中放置一个 NULL 值。有没有一种加入方式？还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:07:46.573

一种方法是使用 UNION（[http://dev.mysql.com/doc/refman/5.0/en/union.html](http://dev.mysql.com/doc/refman/5.0/en/union.html)）：

```
SELECT oid AS OID, null AS BOID, user_id AS USERID, opinion AS Opinion
FROM table1
UNION
SELECT null AS OID, bo_id AS BOID, user_id AS USERID, opinion AS Opinion
FROM table2 
```

编辑：您甚至可以更进一步，将其与 CONCAT 函数结合起来：

```
SELECT CONCAT('OID-', oid) AS ID, user_id AS USERID, opinion AS Opinion
FROM table1
UNION
SELECT CONCAT('BOID-', bo_id) AS ID, user_id AS USERID, opinion AS Opinion
FROM table2 
```

# xslt - Mule-XSLT 转换失败

> ID：14718615
> 
> 赞同：0
> 
> 时间：2013-02-05T23:01:26.633
> 
> 标签：xslt, transformation, mule

在调用我的 JDBC 连接器之前，我试图在 Mule 中转换 XML，但是转换失败：

错误 2013-02-05 14:43:53,989 [WrapperListener_start_runner] org.mule.module.launcher.application.DefaultMuleApplication: null org.xml.sax.SAXParseException: prolog 中不允许有内容。在 org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException（未知来源）

这甚至在我传入 XML 之前，这里是 Mule 配置：

```
<jms:inbound-endpoint topic="${topic.logTopic}" connector-ref="jmsConnector" doc:name="JMS">
        <jms:transaction action="NONE" timeout="${queue.transaction.timeout}" />
    </jms:inbound-endpoint>

    <mule-xml:xslt-transformer outputEncoding="UTF-8" ignoreBadInput="false" encoding="UTF-8">
        <mule-xml:xslt-text>
        <xsl:stylesheet version="2.0"
              xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

        <xsl:template match="ZLOIPRO1" >
          <table>
            <th><td>ZLOIPRO1</td></th>
              <xsl:apply-templates select="data"/>
          </table>
        </xsl:template>

       <xsl:template match="data" >
          <xsl:attribute name="TABNAME">
            <xsl:value-of select="$TABNAM"/>
          </xsl:attribute>
       </xsl:template>

       <xsl:template match="data" >
         <xsl:attribute name="MANDT">
           <xsl:value-of select="$MANDT"/>
         </xsl:attribute>
       </xsl:template>

      <xsl:template match="data" >
        <xsl:attribute name="DOCNUM">
           <xsl:value-of select="$DOCNUM"/>
        </xsl:attribute>
      </xsl:template>

       <xsl:template match="data" >
        <xsl:attribute name="DOCREL">
          <xsl:value-of select="$DOCREL"/>
        </xsl:attribute>
      </xsl:template>

       <xsl:template match="data" >
        <xsl:attribute name="STATUS">
           <xsl:value-of select="$STATUS"/>
        </xsl:attribute>
      </xsl:template>

       <xsl:template match="data" >
        <xsl:attribute name="DIRECT">
          <xsl:value-of select="$DIRECT"/>
        </xsl:attribute>
       </xsl:template>

     </xsl:stylesheet>
   </mule-xml:xslt-text>
</mule-xml:xslt-transformer>

    <object-to-string-transformer/>

    <jdbc:xml-to-maps-transformer name="XMLToMaps"/>

    <jdbc:outbound-endpoint queryKey="insertion" connector-ref="insertionConnector"> 
```

这是我的 XML：

```
<ZLOIPRO1>
  <IDOC BEGIN="1">
    <EDI_DC40 SEGMENT="1">
      <TABNAM>EDI_DC40</TABNAM>
      <MANDT>300</MANDT>
      <DOCNUM>0000000000705856</DOCNUM>
      <DOCREL>640</DOCREL>
      <STATUS>30</STATUS>
      <DIRECT>1</DIRECT>
      <OUTMOD>2</OUTMOD>
      <EXPRSS />
      <TEST />
      <IDOCTYP>LOIPRO01</IDOCTYP>
      <CIMTYP>ZLOIPRO1</CIMTYP>
      <MESTYP>LOIPRO</MESTYP>
      <MESCOD />
      <MESFCT />
      <STD />
      <STDVRS />
      <STDMES />
      <SNDPOR>SAPR3P</SNDPOR>
      <SNDPRT>LS</SNDPRT>
      <SNDPFC />
      <SNDPRN>R3PCLNT300</SNDPRN>
      <SNDSAD />
      <SNDLAD />
      <RCVPOR>5555</RCVPOR>
      <RCVPRT>LS</RCVPRT>
      <RCVPFC />
      <RCVPRN>SBCR3P300</RCVPRN>
      <RCVSAD />
      <RCVLAD />
      <CREDAT>20120512</CREDAT>
      <CRETIM>182139</CRETIM>
      <REFINT />
      <REFGRP />
      <REFMES />
      <ARCKEY />
      <SERIAL>20120512182139</SERIAL>
    </EDI_DC40>
    <E1AFKOL SEGMENT="1">
      <AUFNR>8390</AUFNR>
      <APROZ>0.00</APROZ>
      <AUART>ZP01</AUART>
      <AUFLD>20120605</AUFLD>
      <AUTYP>10</AUTYP>
      <BAUMNG>1.0000</BAUMNG>
      <BMEINS>EA</BMEINS>
      <BMENGE>1.0000</BMENGE>
      <CY_SEQNR>00000000000000</CY_SEQNR>
      <DISPO>401</DISPO>
      <FHORI>000</FHORI>
      <FREIZ>000</FREIZ>
      <FTRMI>00000000</FTRMI>
      <FTRMS>20120619</FTRMS>
      <GAMNG>1.0000</GAMNG>
      <GASMG>1.0000</GASMG>
      <GETRI>00000000</GETRI>
      <GEUZI>000000</GEUZI>
      <GLTRI>00000000</GLTRI>
      <GLTRP>20120619</GLTRP>
      <GLTRS>20120619</GLTRS>
      <GLUZP>000000</GLUZP>
      <GLUZS>000000</GLUZS>
      <GMEIN>EA</GMEIN>
      <GSTRI>00000000</GSTRI>
      <GSTRP>20120619</GSTRP>
      <GSTRS>20120619</GSTRS>
      <GSUZP>000000</GSUZP>
      <GSUZS>000000</GSUZS>
      <IASMG>0.000</IASMG>
      <IGMNG>0.000</IGMNG>
      <LODIV>0.000</LODIV>
      <MATNR>1007012-04-C</MATNR>
      <PLAUF>20120605</PLAUF>
      <PLNAL>1</PLNAL>
      <PLNME>EA</PLNME>
      <PLNNR>50000147</PLNNR>
      <PLNTY>N</PLNTY>
      <PLSVB>99999999.000</PLSVB>
      <PLSVN>1.000</PLSVN>
      <PSPEL>00000000</PSPEL>
      <RMNGA>0.000</RMNGA>
      <SBMNG>0.000</SBMNG>
      <SICHZ>000</SICHZ>
      <SLSBS>0.000</SLSBS>
      <SLSVN>0.000</SLSVN>
      <TERKZ>2</TERKZ>
      <VORGZ>000</VORGZ>
      <WERKS>3100</WERKS>
      <E1JSTKL SEGMENT="1">
        <STAT>E0006</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0001</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0016</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0028</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0115</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0215</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0291</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0361</STAT>
      </E1JSTKL>
      <E1JSTKL SEGMENT="1">
        <STAT>I0420</STAT>
      </E1JSTKL>
      <E1AFFLL SEGMENT="1">
        <APLZL>00000001</APLZL>
        <AUSCHL>2</AUSCHL>
        <FLGAT>0</FLGAT>
        <PLNFL>0</PLNFL>
        <E1AFVOL SEGMENT="1">
          <VORNR>0010</VORNR>
          <ABRUE>0.000000000000000E+00</ABRUE>
          <ANZZL>0</ANZZL>
          <ARBEI>0.0</ARBEI>
          <ARBID>10000031</ARBID>
          <ARUZE>HUR</ARUZE>
          <AUFAK>0.000</AUFAK>
          <BEARZ>0.000000000000000E+00</BEARZ>
          <BEAZE>HUR</BEAZE>
          <BMSCH>1.000</BMSCH>
          <CY_SEQNRV>00000000000000</CY_SEQNRV>
          <DAUNO>0.0</DAUNO>
          <DAUMI>0.0</DAUMI>
          <FSAVD>20120619</FSAVD>
          <FSAVZ>000000</FSAVZ>
          <FSEDD>20120619</FSEDD>
          <FSEDZ>000000</FSEDZ>
          <FSELD>20120619</FSELD>
          <FSELZ>000000</FSELZ>
          <FSEVD>20120619</FSEVD>
          <FSEVZ>000000</FSEVZ>
          <FSSAD>20120619</FSSAD>
          <FSSAZ>000000</FSSAZ>
          <FSSBD>20120619</FSSBD>
          <FSSBZ>000000</FSSBZ>
          <FSSLD>20120619</FSSLD>
          <FSSLZ>000000</FSSLZ>
          <KALID>US</KALID>
          <LAR01>LAB02</LAR01>
          <LAR02>LAB01</LAR02>
          <LIEGZ>0.000000000000000E+00</LIEGZ>
          <LMNGA>0.000</LMNGA>
          <LTXA1>General Assembly</LTXA1>
          <MEINH>EA</MEINH>
          <MINWE>0.000</MINWE>
          <MGVRG>1.000</MGVRG>
          <PEINH>0</PEINH>
          <PREIS>0.00</PREIS>
          <PRZNT>0</PRZNT>
          <RMNGA>0.000</RMNGA>
          <RSTZE>HUR</RSTZE>
          <RUEST>0.000000000000000E+00</RUEST>
          <SPLIM>0</SPLIM>
          <SSAVD>20120619</SSAVD>
          <SSAVZ>000000</SSAVZ>
          <SSEDD>20120619</SSEDD>
          <SSEDZ>000000</SSEDZ>
          <SSELD>20120619</SSELD>
          <SSELZ>000000</SSELZ>
          <SSEVD>20120619</SSEVD>
          <SSEVZ>000000</SSEVZ>
          <SSSAD>20120619</SSSAD>
          <SSSAZ>000000</SSSAZ>
          <SSSBD>20120619</SSSBD>
          <SSSBZ>000000</SSSBZ>
          <SSSLD>20120619</SSSLD>
          <SSSLZ>000000</SSSLZ>
          <STEUS>PP03</STEUS>
          <TRANZ>0.000000000000000E+00</TRANZ>
          <USR04>0.000</USR04>
          <USR05>0.000</USR05>
          <VGE01>HUR</VGE01>
          <VGE02>HUR</VGE02>
          <VGW01>0.000</VGW01>
          <VGW02>5.000</VGW02>
          <VGW03>0.000</VGW03>
          <VGW04>0.000</VGW04>
          <VGW05>0.000</VGW05>
          <VGW06>0.000</VGW06>
          <VGWTS>Z001</VGWTS>
          <WARTZ>0.000000000000000E+00</WARTZ>
          <XMNGA>0.000</XMNGA>
          <ZLPRO>0.000</ZLPRO>
          <ZMINB>0.000</ZMINB>
          <ZMINU>0.000</ZMINU>
          <ZTMIN>0.000</ZTMIN>
          <ZWMIN>0.000</ZWMIN>
          <ZWNOR>0.000</ZWNOR>
          <ISAVD>00000000</ISAVD>
          <IEAVD>00000000</IEAVD>
          <ISDD>00000000</ISDD>
          <ISDZ>000000</ISDZ>
          <IEDD>00000000</IEDD>
          <IEDZ>000000</IEDZ>
          <ANZMA>0.00</ANZMA>
          <E1JSTVL SEGMENT="1">
            <STAT>I0001</STAT>
          </E1JSTVL>
        </E1AFVOL>
      </E1AFFLL>
      <E1AFPOL SEGMENT="1">
        <POSNR>0001</POSNR>
        <AMEIN>EA</AMEIN>
        <BMENG>0.000</BMENG>
        <KDAUF>1000021859</KDAUF>
        <KDEIN>0000</KDEIN>
        <KDPOS>000010</KDPOS>
        <MATNR>1007012-04-C</MATNR>
        <MEINS>EA</MEINS>
        <PLNUM>2718553</PLNUM>
        <PSAMG>0.000</PSAMG>
        <PSMNG>1.000</PSMNG>
        <UMREN>1</UMREN>
        <UMREZ>1</UMREZ>
        <WEBAZ>0</WEBAZ>
        <WEMNG>0.000</WEMNG>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>IZMT</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>IDCF</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>PPSR</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>PF01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>RFPO</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>TR01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>WT21</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>CH01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>AU01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>TP01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>PS01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X019</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X024</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>TM01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>AD02</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>SU01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>BT85</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>CC00</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>CN01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>DRLH</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>RENA</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>AU01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>BT85</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>CH01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>HP01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>PPSR</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>PS01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>RFPO</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>SC01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>SU01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>TM01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>TP01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>TR01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>WT21</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>SC01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>HP01</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X013</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X001</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X007</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X011</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X003</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X015</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X005</ZATWTB>
        </ZE1AFPO>
        <ZE1AFPO SEGMENT="1">
          <ZATWTB>X009</ZATWTB>
        </ZE1AFPO>
      </E1AFPOL>
    </E1AFKOL>
  </IDOC>
</ZLOIPRO1> 
```

有什么建议么？

问候斯里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T00:39:47.270

我对骡子不熟悉，所以对此持保留态度。

您的错误消息来自 SAX 解析器，因此有人试图读取一些他们认为是 XML 的数据。您说您甚至在尝试传入 XML 输入之前就收到了错误消息，因此我们可以猜测问题不在输入中。您提供了一个 Mule 配置文件——配置文件通常会被提前读取，因此配置文件中的错误似乎是一个合理的诊断。而且您提供的配置文件不是格式良好的 XML：它缺少根元素，它使用四个未绑定到命名空间（jms、doc、mule-xml 和 jdbc）的命名空间前缀，以及 jdbc:outbound-endpoint 元素最后没有结束标签。该输入很容易从 SAX 解析器中引出您给出的错误消息。

所以一个合理的理论是问题出在你的配置文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T01:36:42.283

“prolog 中不允许内容”通常意味着您的 XML 有问题。在这种情况下，问题可能是您的 mule 配置文件缺少根元素 mule 标签。这是 mule 3.2 中的示例（可能不适用于您的需求，因为您使用其他组件（jms、xsl 等）并且可能使用其他版本的框架）

```
<?xml version="1.0" encoding="UTF-8"?>
<mule
xmlns="http://www.mulesoft.org/schema/mule/core"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:mxml="http://www.mulesoft.org/schema/mule/xml"
xmlns:vm="http://www.mulesoft.org/schema/mule/vm"
xmlns:spring="http://www.springframework.org/schema/beans"
xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/3.2/mule.xsd
http://www.mulesoft.org/schema/mule/xml http://www.mulesoft.org/schema/mule/xml/3.2/mule-xml.xsd
http://www.mulesoft.org/schema/mule/vm http://www.mulesoft.org/schema/mule/vm/3.1/mule-vm.xsd
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"> 
```

# ruby-on-rails - Ruby on Rails 中的嵌套表单没有可见字段

> ID：14718617
> 
> 赞同：0
> 
> 时间：2013-02-05T23:01:28.563
> 
> 标签：ruby-on-rails, nested-forms

我正在尝试为具有多个帐单地址和邮政地址的客户配置文件创建一个嵌套组。当我浏览到客户配置文件表单时，我看到了客户配置文件表单的字段，但我没有看到帐单地址表单的任何字段或邮寄地址表格。有任何想法吗？我的控制器、模型和视图如下。

目标是拥有一个可以有多个帐单地址和多个邮政地址的客户资料。

客户档案模型：

```
 class CustomerProfile < ActiveRecord::Base
        #These entries are required to create a nested model form (multiple models in one form)
        validates_presence_of :customerNumber
        validates_uniqueness_of :customerNumber

        has_many :billing_addresses, :dependent => :destroy
        has_many :postal_addresses,  :dependent => :destroy

        accepts_nested_attributes_for :billing_addresses, :reject_if => lambda { |a| a[:content].blank?}, :allow_destroy => true
        accepts_nested_attributes_for :postal_addresses, :reject_if => lambda { |a| a[:content].blank?}, :allow_destroy => true
    end 
```

帐单地址型号：

```
 class BillingAddress < ActiveRecord::Base
        belongs_to :customer_profile
        attr_protected :customerNumber
    end 
```

邮政地址模型：

```
 class PostalAddress < ActiveRecord::Base
        belongs_to :customer_profile
        attr_protected :customerNumber
    end 
```

客户档案控制器：

```
 def new
        @customer_profile = CustomerProfile.new

        respond_to do |format|
          format.html # new.html.erb
          format.json { render json: @customer_profile }
        end
    end

    def create
        @customer_profile = CustomerProfile.new(params[:customer_profile])

        respond_to do |format|
          if @customer_profile.save
            format.html { redirect_to @customer_profile, notice: 'Customer profile was successfully created.' }
            format.json { render json: @customer_profile, status: :created, location: @customer_profile }
          else
            format.html { render action: "new" }
            format.json { render json: @customer_profile.errors, status: :unprocessable_entity }
          end
        end
    end 
```

客户资料表格：

```
 <br />
    <h3>Add new customer profile with Billing and Postal Address</h3>
    <br />
    <h4> Customer Profile </h4>
    <%= form_for @customer_profile do |f| %>
        <div class="field">
            <%= f.label :customerNumber %><br />
            <%= f.text_field :customerNumber %>
        </div>

        #.... a few other fields removed to keep this short

    <br />
        <h4> Billing Address </h4>
        <%= f.fields_for :billing_addresses do |b| %>

            <div class="field">
                <%= b.label :addressLine1 %><br />
                <%= b.text_field :addressLine1 %>
            </div>

        #.... a few other fields removed to keep this short

        <% end %>

        <br />
        <h4> Postal Address </h4>
        <br />
        <%= f.fields_for :postal_addresses do |p| %>

            <div class="field">
                <%= p.label :addressLine1 %><br />
                <%= p.text_field :addressLine1 %>
            </div>

        #.... a few other fields removed to keep this short

        <br />
        <% end %>
        <%= f.submit %>
    <% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:45:10.930

fields_for 将显示作为 customer_profile 子项的 billing_addresses 字段。如果这是一个新对象，您需要添加一个或多个，或者 - 通过 JavaScript 添加适当的字段。你可能想要两个，所以当他们到达那里时会有一个空字段，然后他们可以添加更多。

您可以执行 a`@customer_profile.billing_addresses.build`以在呈现表单时获得一个空的。

你知道如何通过 javascript 添加和删除字段吗？它在railscasts上得到了很好的报道。

# php - 调用非对象上的成员函数 bind_param() 在从另一个函数调用的函数内部不起作用

> ID：14718620
> 
> 赞同：-3
> 
> 时间：2013-02-05T23:01:42.260
> 
> 标签：php, mysql, mysqli

我在下面列出的类的 get_template() 函数中收到上述错误。有谁知道我为什么会收到这个错误？所有其他查询都执行得很好，并且 $template_number 肯定会返回一个 int ，这是查询中此时预期的，那么为什么我会收到此错误？可能是因为这个查询的返回在 MySQL 中被格式化为 TEXT（并且在 PHPMyAdmin 中显示为 BLOB？

```
 class Page{

private $con; 

public function __construct(Connection $con) {
    $this->con = $con;
    if(isset($_GET['id'])){
    $id = $_GET['id'];
    }else{      
    $id = 1;
    }       
    $this->get_headers($id);
    $this->get_content($id);
    $this->get_footer($id);
}

private function get_headers($pageId){ 
    $retrieveHead = $this->con->prepare("SELECT headers FROM pages WHERE page_id=?");
    $retrieveHead->bind_param('i',$pageId);
    $retrieveHead->execute();
    $retrieveHead->bind_result($header);
    $retrieveHead->fetch();
    $retrieveHead->close();
    echo $header;   
}

private function get_footer($pageId){ 
    $retrieveFooter = $this->con->prepare("SELECT footer FROM pages WHERE page_id=?");
    $retrieveFooter->bind_param('i',$pageId);
    $retrieveFooter->execute();
    $retrieveFooter->bind_result($footer);
    $retrieveFooter->fetch();
    $retrieveFooter->close();
    echo $footer;   
}

private function get_content($pageId){
    $retreiveContent = $this->con->prepare("SELECT template_id, section_title, i1, i2 FROM content WHERE page_id=? ORDER BY sequence DESC");
    $retreiveContent->bind_param('i',$pageId);
    $retreiveContent->execute();
    $retreiveContent->bind_result($template_id, $section_title, $i1, $i2);
         while ($retreiveContent->fetch()) {
            //Variables will be populated for this row.
            //Update the tags in the template.
            $template = $this->get_template($template_id);
            $template = str_replace('[i1]',$i1,$template);
            $template = str_replace('[i2]',$i2,$template);
            //$theTemplate is populated with content. Probably want to echo here
            echo $template;
        }
    $retreiveContent->close();
}

private function get_template($template_number){
    $retreiveFunction = $this->con->prepare("SELECT code FROM templates WHERE template_id=?");
    $retreiveFunction->bind_param('i',$template_number);
    $retreiveFunction->execute();
    $retreiveFunction->bind_result($template);
    $retreiveFunction->fetch();
    $retreiveFunction->close();
    return $template;
}

} 
```

表结构如下：

![表结构](../Images/86ea98c469f943973e7ef3d9b86fc5f6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:33:33.627

见[这里](http://www.php.net/manual/en/mysqli-stmt.execute.php)和[这里](http://www.php.net/manual/en/mysqli-stmt.store-result.php)。`mysqli_stmt::execute()`默认情况下，服务器端存储结果并逐行获取，除非您调用`mysqli_stmt::store_result()`在客户端缓冲它们。尝试准备另一个语句很可能会失败，因为前一个语句有未获取的结果服务器端。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-06T20:01:06.723

对于搜索此解决方案的任何其他人，正如 bwewsing 建议的那样，我需要添加 store_result 但是从上面提供的链接中，不太清楚应该在哪里实施。

实施应在初始调用方法中进行。因此，当 get_content() 方法调用 get_template() 方法时，它应该在此处以下列方式实现：

```
 private function get_content($pageId){
    $retreiveContent = $this->con->prepare("SELECT template_id, section_title, i1, i2 FROM content WHERE page_id=? ORDER BY sequence DESC");
    $retreiveContent->bind_param('i',$pageId);
    $retreiveContent->execute();
    $retreiveContent->bind_result($template_id, $section_title, $i1, $i2);
    $retreiveContent->store_result();
         while ($retreiveContent->fetch()) {
            //Variables will be populated for this row.
            //Update the tags in the template.
            $template = $this->get_template($template_id);
            $template = str_replace('[i1]',$i1,$template);
            $template = str_replace('[i2]',$i2,$template);
            //$theTemplate is populated with content. Probably want to echo here
            echo $template;
        }
    $retreiveContent->free_result();    
    $retreiveContent->close();
} 
```

# facebook - 无法获取 Facebook 签到，数据数组始终为空

> ID：14718623
> 
> 赞同：1
> 
> 时间：2013-02-05T23:02:07.593
> 
> 标签：facebook, facebook-checkins

尝试获取地点或用户的签到时，我有一个奇怪的行为：结果始终是一个空数据数组：

```
{
    "data": [
    ]
} 
```

当我使用 Graph Explorer 时会发生这种情况：`/4/checkins`

或者当我使用 FQL 时：`SELECT checkin_id, author_uid, page_id, timestamp from checkin where page_id = 111856692159256`

或使用 javascript 时：

```
FB.api("/me/checkins", function(response){
    console.log(response);
}); 
```

我总是使用 access_token，即使是具有所有权限的。根本没有结果。我读到，签到现在已经发布了位置，所以我尝试了`/4/posts?with=location`，但仍然没有运气。我是否缺少某种错误或限制（国家/应用程序权限）？

编辑：我现在很幸运，可以让我的一些朋友签到。这就像一个50/50的机会......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:12:04.457

有 2 个不同的命令，一个命令是获取用户签到的 url：

*   `/me/checkins`将返回当前用户（生成令牌的用户）的所有签到
*   `/<USERID>/checkins`将返回`User ID`当前用户可以看到的所有检查。
*   `/<PLACEID>/checkins`将返回当前用户在此地点签到的所有好友

所以，可能你没有在 id 签到的朋友`111856692159256`

# iphone - AFNetworking：setImageWithURLRequest 未设置图像

> ID：14718634
> 
> 赞同：2
> 
> 时间：2013-02-05T23:02:55.257
> 
> 标签：iphone, ios, afnetworking, block

我正在尝试在 tableViewCell上`ImageView`使用 AFNetworking设置图像。`setImageWithURLRequest`如果我没有像这样在方法中包含`success`and`failure`块：

```
[cell.thumbnailImageView setImageWithURL:url placeholderImage:nil]; 
```

一切正常，图像设置。不幸的是我需要积木。

这是我目前拥有的`cellForRowAtIndexPath`：

```
if (self.images) { //check if the array of images is set, fetched from a URL

        NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString: [[self.images objectAtIndex:indexPath.row] objectForKey:@"tbUrl"]]];

        [cell.thumbnailImageView setImageWithURLRequest:request placeholderImage:[UIImage imageNamed:@"placeholder"] success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
                NSLog(@"success"); //it always lands here! But nothing happens
        } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
                NSLog(@"fail");
        }];

    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T00:16:13.167

来自`UIImageView+AFNetworking.h`：

> 如果指定了成功块，则该块负责在返回之前设置图像视图的图像。

在你的成功块中，你需要说：

```
[cell.thumbnailImageView setImage: image] 
```

# python - Pandas 未记录的 DataFrame.keys() 方法

> ID：14718643
> 
> 赞同：0
> 
> 时间：2013-02-05T23:03:49.500
> 
> 标签：python, dictionary, dataframe, pandas, data-analysis

我是 Pandas 的新手，在玩它的时候`Dataframe`，我发现方法`keys()`很像`dict.keys()`。[但我在docs](http://pandas.pydata.org/pandas-docs/dev/api.html#dataframe)中找不到它。我错过了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T23:33:22.537

[您可以查看源代码](https://github.com/pydata/pandas/blob/master/pandas/core/frame.py#L708)中定义的位置：

```
def keys(self):
    return self.columns 
```

而且，如果您查看 git blame，您会发现它是作为[#1240: "Request: keys() method on dataFrame"](https://github.com/pydata/pandas/issues/1240)的修复添加的。理由似乎是：

> 在学习 Pandas 时，这种方法对于从易于理解的 dict 结构转移到更强大的 DataFrame 很有用。作为熊猫新手，这种心理映射将不胜感激。

但是，值得注意的是，`DataFrame`它只支持大约一半的映射接口。例如，有`iteritems`and `keys`，但没有`iterkeys`。在某些情况下，他们添加了相似但不完全相同的名称，例如`iterkv`，这相当于`iteritems`但特别是因为后者“被 2to3 错误地转换为 .items()”。

您可以浏览源代码并查看每个添加的位置以及添加原因，但似乎没有太多的押韵或理由超出“`DataFrame`有点像 a `dict`，有点不像”。

事实上，他们选择不记录这些方法中的大多数，或者记录`DataFrame`有点像 a `dict`，我不会依赖其中的任何一个。只需使用`columns`代替`keys()`等。

# html - 在 Django 循环中继续 HTML 表单

> ID：14718645
> 
> 赞同：0
> 
> 时间：2013-02-05T23:04:05.273
> 
> 标签：html, django, forms, django-templates

是否可以关闭，然后重新打开/继续页面上的 html 表单？基本上我有一个电子表格网络前端从数据库中提取数据。但是，我需要将字段拆分为左 div 和右 div。原因是他们想要右侧 div 上的水平滚动条，因为它包含比左侧 div 更多的字段（左侧 div 字段就像没有滚动条的静态字段），这是为了复制现有电子表格的外观。

我决定在我的模板中使用两个 for 循环来做到这一点。第一个循环生成页面的左侧，然后关闭左侧的 div，第二个循环生成页面的右侧，然后关闭右侧的 div。

由于我这样做的方式，我遇到了一个问题，即在关闭第一个表单之前我有很多表单元素。

```
<div left>
   <% for bla in bla %}
       <form id="{{ bla.id }}"><submit>
       <input value="{{ bla.name}}"><input value="{{ bla.number }}">
   {% endfor %}
</div>
<div right>
    {% for bla2 in bla2 %}
       <input value="{{ bla2.address}"><input value="{{ bla2.state }}">
       </form>
    {% endfor %}
</div> 
```

显然我遇到了问题，因为当您查看由类似于上面的代码生成的 html 时，您有许多表单元素在生成第二个 div 之前不会关闭。所以我的 POST 数据始终是最后一条记录。

我尝试过，我给表单一个名称和 ID，即 {{ bla.id }}。然后我在第一个循环中关闭表单，并在第二个循环中放置一个具有相同 id 和名称 {{ bla.id }} 的新标签。

我以为该页面会知道此表单是先前表单的延续，但可惜它不起作用，我似乎找不到解决方法。

也许我的整个逻辑都关闭了，我应该以不同的方式生成整个页面。也许我缺少一个简单的解决方案...

我希望我解释得足够好。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:46:57.710

[编辑]

从评论中，如果您想为每条记录提供一个提交按钮，您仍然可以使用下面概述的标记，将每个表单标签作为“行”循环。对象名称`blah`和`blah2`有点误导，特别是如果所有字段都包含一个模型。

如果这些字段实际上都是同一模型的所有部分，那么 for 循环将简单地移到表单标记之外，而不是在每个“列”内。

如果您不想手动输出字段，另一种选择是使用模型表单集来生成模型表单的多个实例。您的标记将与下面概述的几乎相同，但是您将在表单集的循环之外为表单集的管理表单提供额外的字段。

例子：

```
<form action="." method="post" enctype="application/x-www-form-urlencoded">
    <div id="left_column">
        <fieldset>
            {% for bla in blah %}
                <input name="name" value="{{ bla.name}}" />
                <input name="number" value="{{ bla.number }}" />
            {% endfor %}
        </fieldset>
    </div>
    <div id="right_column">
        <fieldset>
            {% for bla2 in blah2 %}
                <input name="address" value="{{ bla2.address}" />
                <input name="state" value="{{ bla2.state }}" />
            {% endfor %}
        </fieldset>
    </div>
    <input type="submit" value="Submit" />
</form> 
```

每个表单元素都需要一个名称属性，否则在 request.POST QueryDict 中找不到它们。表单标签必须包含您希望作为 POST 的一部分提交的所有元素，除非您通过 JavaScript 进行 POST 并通过 JavaScript 收集值。

# gitolite - gitolite + gitweb | 'repo @all R = gitweb' 不工作

> ID：14718646
> 
> 赞同：1
> 
> 时间：2013-02-05T23:04:23.623
> 
> 标签：gitolite, gitweb

出于某种原因，以下 gitolite.conf 不会将任何存储库添加到 projects.list。当我为每个存储库手动设置“R = gitweb”时，它们会被添加到 projects.list。

```
[....]

repo aaa
repo bbb

repo @all
    RW+ = @admins
    R = gitweb

[...] 
```

对我有什么提示吗？我真的很想允许 gitweb 访问所有存储库，然后通过 '- = gitweb' 删除单个存储库的权限...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T06:40:06.427

我实际上不需要`gitweb`规则或`project.list`在[我的 gitweb 设置](https://github.com/VonC/compileEverything/blob/master/apache/env.conf.tpl#L49-L93)中完成：
我只确保我有一个[`gitweb.conf.pl`](https://github.com/VonC/compileEverything/blob/master/gitweb/gitweb.conf.pl.tpl)：

*   将被 gitweb 调用（通过[`gitweb_config.perl`](https://github.com/VonC/compileEverything/blob/master/gitweb/gitweb_config.perl)文件，如果 gitweb 检测到存在则调用）
*   将[调用 gitolite](https://github.com/VonC/compileEverything/blob/master/gitweb/gitweb.conf.pl.tpl#L43)以查看是否可以授予或应该拒绝对 repo 的访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T20:14:28.160

我刚刚遇到了类似的问题，但解决方案不同：

在 gitolite3 中，如果您只看到一个 gitweb.* 属性，那么您的存储库似乎启用了 gitweb：

```
repo foobar
  desc = "Foobar repository"
  category = "foobar"
  Rw+= myself 
```

或者，如果您喜欢：

```
repo foobar
  config gitweb.description = "Foobar repository"
  config gitweb.category = "foobar"
  Rw+= myself 
```

我不知道它是否适用于@all，例如：

```
repo @all
  category= "uncategorized" 
```

但是由于描述或（有效）类别并不是一件坏事，我会说它对我有用。

另一方面，我还尝试使用我的所有存储库（除了 gitolite-admin）创建一个 @almost-all 组，但由于 gitweb.description/category 配置，我不知道它是否有效。

# css - 我对 CSS 文件所做的更改不会反映在 Wordpress 的浏览器中

> ID：14718647
> 
> 赞同：1
> 
> 时间：2013-02-05T23:04:35.593
> 
> 标签：css, wordpress, templates

这是我第一次创建 WP 模板。我使用了本教程：[http ://themeshaper.com/2012/10/22/the-themeshaper-wordpress-theme-tutorial-2nd-edition/](http://themeshaper.com/2012/10/22/the-themeshaper-wordpress-theme-tutorial-2nd-edition/)

我正在编辑模板文件夹（WCCB 主题 - 副本）中的 style.css 文件。它位于本地服务器 XAMPP 上，因此没有任何 FTP 传输。我编辑文件，然后刷新浏览器，没有任何反应。目前我那里只有一种样式，将 H2 设为红色，其余为空白（标题注释除外）。不知道我做错了什么。

1：当我查看源代码时，该文件被列为应用的样式表。2：当我直接转到文件的URL时，浏览器可以找到它。3：当我使用开发人员工具检查我的 H2 时，它说只应用了用户代理样式。

最初它显示为缓存问题，但我已清除缓存（Chrome）。我不知道出了什么问题。如何让我的 CSS 更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T22:10:43.530

转到模板文件夹（通常在：下`/var/www/html/wp-content/themes/<your theme>`）并编辑文件：（`header.php`不要忘记先备份它！）

替换行：

```
<link rel="stylesheet" href="<?php bloginfo('stylesheet_url') ?>" media="screen" /> 
```

和：

```
<link rel="stylesheet" href="<?php bloginfo('stylesheet_url') ?>?v=123" media="screen" /> 
```

并刷新页面。如果它没有刷新并且您正在使用 WP Super Cache - 删除缓存。
还是没有刷新？从提示符运行`service httpd restart`（它重新启动 Apache）并重试。为我工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:23:50.510

我知道我以前遇到过这样的问题。尝试 ctrl+f5 进行完全重新加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:25:58.250

不知道我是如何解决这个问题的。我从 WP 管理面板中删除了模板，并使用不同的名称再次添加了它，并且已经进行了一些 CSS 更改。有效。现在我可以更改我的 CSS 文件并刷新我的浏览器，更改就会出现。不知道发生了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-10T14:26:21.303

我通常做的是在隐身模式（`Ctrl`++ ）下打开页面- 如果您使用的是 Mac（`Shift`++ ）。`N``cmd``shift``N`

# r - R gbm 处理缺失值

> ID：14718648
> 
> 赞同：9
> 
> 时间：2013-02-05T23:04:37.257
> 
> 标签：r, missing-data, na

有谁知道如何`gbm`处理`R`缺失值？我似乎无法使用谷歌找到任何解释。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-09-14T17:39:26.897

为了解释 gbm 对缺失预测变量的作用，让我们首先可视化 gbm 对象的单个树。

假设您有一个 gbm 对象`mygbm`。使用`pretty.gbm.tree(mygbm, i.tree=1)`您可以可视化 mygbm 上的第一棵树，例如：

```
 SplitVar SplitCodePred LeftNode RightNode MissingNode ErrorReduction Weight    Prediction
0       46  1.629728e+01        1         5           9      26.462908   1585 -4.396393e-06
1       45  1.850000e+01        2         3           4      11.363868    939 -4.370936e-04
2       -1  2.602236e-04       -1        -1          -1       0.000000    271  2.602236e-04
3       -1 -7.199873e-04       -1        -1          -1       0.000000    668 -7.199873e-04
4       -1 -4.370936e-04       -1        -1          -1       0.000000    939 -4.370936e-04
5       20  0.000000e+00        6         7           8       8.638042    646  6.245552e-04
6       -1  3.533436e-04       -1        -1          -1       0.000000    483  3.533436e-04
7       -1  1.428207e-03       -1        -1          -1       0.000000    163  1.428207e-03
8       -1  6.245552e-04       -1        -1          -1       0.000000    646  6.245552e-04
9       -1 -4.396393e-06       -1        -1          -1       0.000000   1585 -4.396393e-06 
```

有关详细信息，请参阅 gbm 文档。每行对应一个节点，第一列（未命名）是节点号。我们看到每个节点都有一个左右节点（如果节点是叶子，则设置为 -1）。我们还看到每个节点都关联了一个`MissingNode`.

为了在树上运行观察，我们从节点 0 开始。如果观察在`SplitVar`= 46 上有缺失值，那么它将沿着树向下发送到节点`MissingNode`= 9。对于这种观察的树的预测将是`SplitCodePred`= -4.396393e-06，这与在对节点零进行任何拆分之前树的预测相同（节点零`Prediction`= -4.396393e-06）。

该过程与其他节点和拆分变量类似。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-29T12:59:58.067

它似乎将缺失值发送到每棵树中的单独节点。如果您有一个名为“mygbm”的 gbm 对象，那么您将通过键入“pretty.gbm.tree(mygbm, i.tree = 1)”看到树中的每个拆分都有一个 LeftNode、一个 RightNode 和一个 MissingNode。这意味着（假设您有interaction.depth=1）每棵树将有3个终端节点（分裂的每一侧1个，预测器缺失的地方一个）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T17:41:09.257

gbms的[官方指南](http://cran.r-project.org/web/packages/gbm/gbm.pdf)在测试数据中引入了缺失值，所以我假设它们被编码为处理缺失值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-10T22:32:38.627

gbm 包特别处理 NA（缺失值），如下所示。该算法通过构建和连续组合分类或回归树来工作。所谓的基础学习树是通过将观察结果分成左右两部分来构建的（@user2332165 是正确的）。gbm 中还有一个单独的节点类型 Missing。如果行或观察没有该变量的值，则算法将应用代理拆分方法。

如果您想更好地理解代理拆分，我建议您阅读[包 rpart vignette](http://cran.r-project.org/web/packages/rpart/vignettes/longintro.pdf)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T00:20:33.107

然后从源代码开始。只需`gbm`在控制台输入即可显示源代码：

```
function (formula = formula(data), distribution = "bernoulli", 
    data = list(), weights, var.monotone = NULL, n.trees = 100, 
    interaction.depth = 1, n.minobsinnode = 10, shrinkage = 0.001, 
    bag.fraction = 0.5, train.fraction = 1, cv.folds = 0, keep.data = TRUE, 
    verbose = TRUE) 
{
    mf <- match.call(expand.dots = FALSE)
    m <- match(c("formula", "data", "weights", "offset"), names(mf), 
        0)
    mf <- mf[c(1, m)]
    mf$drop.unused.levels <- TRUE
    mf$na.action <- na.pass
    mf[[1]] <- as.name("model.frame")
    mf <- eval(mf, parent.frame())
    Terms <- attr(mf, "terms")
    y <- model.response(mf, "numeric")
    w <- model.weights(mf)
    offset <- model.offset(mf)
    var.names <- attributes(Terms)$term.labels
    x <- model.frame(terms(reformulate(var.names)), data, na.action = na.pass)
    response.name <- as.character(formula[[2]])
    if (is.character(distribution)) 
        distribution <- list(name = distribution)
    cv.error <- NULL
    if (cv.folds > 1) {
        if (distribution$name == "coxph") 
            i.train <- 1:floor(train.fraction * nrow(y))
        else i.train <- 1:floor(train.fraction * length(y))
        cv.group <- sample(rep(1:cv.folds, length = length(i.train)))
        cv.error <- rep(0, n.trees)
        for (i.cv in 1:cv.folds) {
            if (verbose) 
                cat("CV:", i.cv, "\n")
            i <- order(cv.group == i.cv)
            gbm.obj <- gbm.fit(x[i.train, , drop = FALSE][i, 
                , drop = FALSE], y[i.train][i], offset = offset[i.train][i], 
                distribution = distribution, w = ifelse(w == 
                  NULL, NULL, w[i.train][i]), var.monotone = var.monotone, 
                n.trees = n.trees, interaction.depth = interaction.depth, 
                n.minobsinnode = n.minobsinnode, shrinkage = shrinkage, 
                bag.fraction = bag.fraction, train.fraction = mean(cv.group != 
                  i.cv), keep.data = FALSE, verbose = verbose, 
                var.names = var.names, response.name = response.name)
            cv.error <- cv.error + gbm.obj$valid.error * sum(cv.group == 
                i.cv)
        }
        cv.error <- cv.error/length(i.train)
    }
    gbm.obj <- gbm.fit(x, y, offset = offset, distribution = distribution, 
        w = w, var.monotone = var.monotone, n.trees = n.trees, 
        interaction.depth = interaction.depth, n.minobsinnode = n.minobsinnode, 
        shrinkage = shrinkage, bag.fraction = bag.fraction, train.fraction = train.fraction, 
        keep.data = keep.data, verbose = verbose, var.names = var.names, 
        response.name = response.name)
    gbm.obj$Terms <- Terms
    gbm.obj$cv.error <- cv.error
    gbm.obj$cv.folds <- cv.folds
    return(gbm.obj)
}
<environment: namespace:gbm> 
```

快速阅读表明数据被放入模型框架中，NA`na.pass`依次`?na.pass`处理从长远来看这意味着什么。看起来您可能还需要查看代码`gbm.fit`等。

# php - Magento 编辑器在添加新产品时自动换行问题

> ID：14718649
> 
> 赞同：3
> 
> 时间：2013-02-05T23:04:38.140
> 
> 标签：php, zend-framework, magento, e-commerce, magento-1.7

我在 Magento CE 1.7.0.2 中添加了一个新产品。*我在简短描述*属性中输入了 HTML 代码。

**我的问题：**我真的不知道这些额外`<br>`的来自哪里。即使是所见即所得的编辑器也没有显示这些`<br>`，但它们出现在网站的产品页面上。请帮忙。

**我输入的内容：**

```
<p>Product Description:</p>
<table border="1" cellspacing="0" cellpadding="5px">
    <tr>
        <td>Category</td>
        <td>Specials</td>
    </tr>
    <tr>
        <td>Texure</td>
        <td>Digitally Printed on High Quality Matte Paper</td>
    </tr>
</table> 
```

**它显示的内容：**

```
<p>Product Description:</p>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<table border="1" cellspacing="0" cellpadding="5px">
    <tr>
        <td>Category</td>
        <td>Specials</td>
    </tr>
    <tr>
        <td>Texure</td>
        <td>Digitally Printed on High Quality Matte Paper</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-08T16:13:19.593

These additional breaks are caused by `nl2br()` function that should be removed.

To resolve this for **short description**, open app/design/frontend/[package]/[theme]/template/catalog/product/view.phtml, find:

`<?php echo $_helper->productAttribute($_product, nl2br($_product->getShortDescription()), 'short_description') ?>`

and replace this by:

`<?php echo $_helper->productAttribute($_product, $_product->getShortDescription(), 'short_description') ?>`

To resolve this for **description**, open app/design/frontend/[package]/[theme]/template/catalog/product/view/description.phtml, find:

`<?php echo $this->helper('catalog/output')->productAttribute($this->getProduct(), nl2br($_description), 'description') ?>`

and relace this by:

`<?php echo $this->helper('catalog/output')->productAttribute($_product, $_product->getDescription(), 'description') ?>`

[Source](https://www.designhaven.co.uk/2012/08/removing-automatic-line-breaks-from-magentos-product-descriptions/)

# objective-c - 使用 OCMockito 对 NSURLConnection sendAsynchronousRequest 进行单元测试

> ID：14718650
> 
> 赞同：0
> 
> 时间：2013-02-05T23:04:38.687
> 
> 标签：objective-c, unit-testing, objective-c-blocks, ocmockito

我正在努力为具有类似接口的 API 包装器编写单元测试

```
- (void)publish:(id<MyCustomRequest>)aRequest completionHandler:(void (^)(id<MyCustomResponse>, NSError *)) completionBlock 
```

它在后台调用此方法：

```
NSURLConnection sendAsynchronousRequest:queue:completionHandler 
```

我不想使用委托，因为公开的 API 更适合 sendAsynchronousRequest 方法（并且每个请求不需要单独的累加器对象）。此外，我使用 OCMockito 来模拟整个代码的其余部分，它不支持部分模拟或模拟类方法。

是否有任何其他测试技术可以测试此功能？是否有必要使用委托？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:49:27.387

使用基于委托的 API。我意识到它的代码更多，但便利的 API 显然不足以满足您的需求（即可以用 OCMockito 模拟）。此外，不必担心为每个请求分配一个辅助设备的“开销”。我很有信心，在你的调用下，系统框架中会在后台分配几十个对象`+[NSURLConnection sendAsynchronousRequest:queue:completionHandler:]`；你不应该担心。也就是说，单个对象可以是多个请求的委托，因此您不必拥有多个请求。

# javascript - 使用 activexobject 处理文件夹

> ID：14718653
> 
> 赞同：0
> 
> 时间：2013-02-05T23:05:05.437
> 
> 标签：javascript, activex

我需要创建文件夹，复制它并删除。所以我创建了几个 javascript 函数 - 获取文件夹的路径、删除文件夹、创建和复制文件夹。

但是当我尝试在谷歌浏览器中运行它时，我遇到了一个异常 ![在此处输入图像描述](../Images/5d766d5aca66042e191b356cb4a1d4df.png)

我认为这是 ActiveX 的问题。但在 IE 中它也不起作用。

```
<html>
<head>
    <meta charset="utf-8">
    <script type="text/javasript">
        function onFolder(){
            var ob = new ActiveXObject("Scripting.FileSystemObject");
            var name = document.getElementById("idtextbox1").value;
            var path = document.getElementById("idtextbox2").value;
            var x = path + "\\" + name;
            return x;
        }
        function onCreate(){
            var ob = new ActiveXObject("Scripting.FileSystemObject");
            var path = onFolder();
            var x = ob.CreateFolder(path);
        }
        function onCopy(){
            var ob = new ActiveXObject("Scripting.FileSystemObject");           
            var source = onFolder();
            var dest = document.getElementById("idtextbox3").value;
            ob.CopyFolder(source,dest + "\\");
        }
        function onDelete(){
            var ob = new ActiveXObject("Scripting.FileSystemObject");
            var folder = onFolder();
            ob.DeleteFolder(folder);
        }
    </script>
</head>
<body>
    Folder name<input type="text" id="idtextbox1">
    <br>
    Destination<input type="text" id="idtextbox2">
    <br>
    Copy destination<input type="text" id="idtextbox3">
    <br>
    <input type="button" id="idbutton1" value="Create" onClick="onCreate()">
    <input type="button" id="idbutton2" value="Copy" onClick="onCopy()">
    <input type="button" id="idbutton3" value="Delete" onClick="onDelete()">
</body>
</html> 
```

有什么问题？是 ActiveX 吗？因为我认为javascript函数是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:25:45.550

最大的问题是您使用的是 chrome Chrome。ActiveX 仅适用于 IE，因为它是一个非标准功能。对于您要执行的操作，安全级别必须很低，这是非常规的。JavaScript 并不是一种尝试访问或更新计算机文件系统的好语言。

# objective-c - 使用 NSXMLParser 解析后无法使用 NSMutableArray 数据（objective-c）

> ID：14718655
> 
> 赞同：0
> 
> 时间：2013-02-05T23:05:15.267
> 
> 标签：objective-c, parsing, nsmutablearray, nsxmlparser

嗨，我用 NSXMLParser 解析了一些 xml ：

```
<company>
     <name>Idan</name>
     <country>Israel</country>
      .....
     <gender>man</gender>
</company> 
```

我看到解析成功，现在我有一个包含所有字符串（Idan、Israel 等）的对象的 MutableArray，但是当我想使用这个数组时，我无法获取它包含的字符串。当我做 ：

```
NSMutableArray *use = [pars users ];
        NSLog(@"%@",use ); 
```

（用户这是我的对象数组）我看到：

```
 <List:03f5a78> 
```

我的代码中的 List 是：

```
#import <Foundation/Foundation.h>
@interface List : NSObject{
    NSString *name;
    NSString *country;
    NSString *status;
    NSString *gender;
}
@property (nonatomic, strong) NSString *name;
@property (nonatomic, strong) NSString *country;
@property (nonatomic, strong) NSString *status;
@property (nonatomic, strong) NSString *gender;
@end

#import "List.h"
@implementation List
@synthesize name,date,city,country,status, gender;
@end 
```

我尝试做这样的事情：

```
 NSMutableArray *use = [pars users.name ];
     NSLog(@"%@",use ); 
```

但不工作，任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:59:18.560

覆盖类的`description`方法`List`，并返回一个包含所有属性值的字符串，然后像第一次一样输出它。然后控制台将打印您返回的值。

例子：

```
@implementation List

...
...
    -(NSString *)description
    {
        NSMutableString *desc = [NSMutableString string];
        [desc appendFormat:@"name=%@, ", self.name];
        [desc appendFormat:@"country=%@, ", self.country];
        [desc appendFormat:@"status=%@, ", self.status];
        [desc appendFormat:@"gender=%@", self.gender];
        return desc
    }
...
...
@end 
```

# php - Uncaught SyntaxError: Unexpected token ; 但是哪里

> ID：14718660
> 
> 赞同：0
> 
> 时间：2013-02-05T23:05:39.460
> 
> 标签：php, jquery

我收到此错误，但我看不出有什么问题。我需要一点帮助。我已经尝试了一切：寻找非法字符，擦除分号，但我还是无法修复它。

```
(function(){

$.ajax({
dataType:           "json",
url:                "prueba.php",
type:               "get",
data:               "t=javascript",
success:function(inf){

    var div += "<span class='carpeta'>";//<-- here is where the error comes but i dont see anything!
    div =+ "<span class='titulo'>"+inf["categoria"]+"<h2>"+inf["titulo"]+"</h2></span>";//cerrando titulo
    div =+"<span class='mascara'>"; 
    div =+"<h2>"+inf["titulo"]+"</h2>"; 
    div =+ "<p>"+info["descripcion"]+"</p>";
    div =+ "<a onclick('tutorial_numero("+1+")') href='javascript:void(0)'>Leer mas</a>";
    div =+"</span>"; //cerrando el span de la class mascara
    div =+ "</span>";//cerrando el span de la class carpeta

    document.getElementById("contenido").innerHTML = "porque tio";
    alert("ola k ase")
}
});

})(); 
```

php代码

```
<?php

if(isset($_GET["t"]))

{

require 'conexion.php';

$getConexion = new conexion();

$conexion_mysql  = $getConexion->mysql();

$id_tutorial = $_GET["t"];$query = "SELECT titulo,contenido_tutorial,descripcion,categoria FROM tituriales WHERE tags LIKE '%$id_tutorial%'";

    $ejecutar_query = $conexion_mysql->prepare($query);

    $ejecutar_query->execute();

        $enviar = $ejecutar_query->fetchAll(PDO::FETCH_ASSOC);

        foreach($enviar as $resultado)
        {

            $f['titulo'] = $resultado['titulo'];
            $f['contenido'] = $resultado['contenido_tutorial'];
            $f['descripcion'] = $resultado['descripcion'];

            if($resultado['categoria']=="web");
            {
                $f['categoria'] = "<img src='../pc.png' />";
            }
            if($resultado['categoria']=="desktop")
            {
                $f['categoria'] = "@";
            }
            if($resultado['categoria']=="ambos")
            {
                $f['categoria'] = "klk";
            }

            //echo $f["categoria"];

            echo json_encode($f);

        }

}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:09:59.900

您的字符串连接运算符不正确。替换`=+`为`+=`

```
(function(){

$.ajax({
dataType:           "json",
url:                "prueba.php",
type:               "get",
data:               "t=javascript",
success:function(inf){

    var div += "<span class='carpeta'>";//<-- here is where the error comes but i dont see anything!
    div += "<span class='titulo'>"+inf["categoria"]+"<h2>"+inf["titulo"]+"</h2></span>";//cerrando titulo
    div +="<span class='mascara'>"; 
    div +="<h2>"+inf["titulo"]+"</h2>"; 
    div += "<p>"+info["descripcion"]+"</p>";
    div += "<a onclick('tutorial_numero("+1+")') href='javascript:void(0)'>Leer mas</a>";
    div +="</span>"; //cerrando el span de la class mascara
    div += "</span>";//cerrando el span de la class carpeta

    document.getElementById("contenido").innerHTML = div;

}
});
})(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T23:35:30.740

您的[赋值运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Assignment_Operators)是错误的：

*   第一个，在变量的[声明和初始化](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)中，应该是一个单一的`=`
*   以下的，速记赋值和连接，应该`+=`代替`=+`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T23:36:47.527

Shane Andrade 已经给了你一部分答案，但这实际上并不能解决你首先遇到的错误：

```
var div += "<span class='carpeta'>"; 
```

此行本身无效，无需其他代码即可查看。`div`尚未定义，但您尝试向其添加一些内容，因为`div += x`它只是 . 的简写`div = div + x`。只需在此处分配字符串：

```
var div = "<span class='carpeta'>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T23:08:08.660

看起来PHP不返回json。我认为你应该调试 PHP 脚本。

# ios - 呈现 ABPeoplePickerNavigationController 后自动进入搜索模式

> ID：14718661
> 
> 赞同：2
> 
> 时间：2013-02-05T23:05:42.810
> 
> 标签：ios, uisearchbar, abpeoplepickerview

我正在使用`ABPeoplePickerNavigationController`Apple 提供的类来让用户选择联系人。

在此列表中，用户可以通过点击搜索栏开始搜索。但是我希望用户不需要点击 searchBar，因此我想在呈现视图控制器后自动进入搜索模式。

对于 searchBar，您通常可以通过调用来输入 searchMode `searchDisplayController setActive:YES animated:YES`。但是，这似乎不适用于使用`ABPeoplePickerNavigationController`.

这就是我尝试过的：

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
[self presentViewController:picker animated:YES completion:^{
    [picker.searchDisplayController.searchBar becomeFirstResponder];
    [picker.searchDisplayController setActive:YES animated:YES];
}]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T15:10:16.093

由于`ABPeoplePickerNavigationController`是一个导航控制器，所以您看到的 searchBar 是该导航控制器的一部分`topViewController`或`visibleViewController`在该导航控制器中（它实际上`ABMembersViewController`是 AddressBookUI API 未公开的类）。

要激活 searchBar，您可以在完成块中执行以下操作：

```
[picker.visibleViewController.searchDisplayController.searchBar becomeFirstResponder];
[picker.visibleViewController.searchDisplayController setActive:YES animated:YES]; 
```

# php - 电子邮件图像输出

> ID：14718663
> 
> 赞同：0
> 
> 时间：2013-02-05T23:05:53.543
> 
> 标签：php, phpmailer, yahoo-mail

我无法按原样发送图像..我发送电子邮件没有问题只是图像没有显示..只是链接..你能帮我吗？这是我的代码..提前谢谢

```
require("phpmailer/class.phpmailer.php");
$mail = new PHPMailer();

$mail->IsSMTP(); // send via SMTP
$mail->Host="smtp.mail.yahoo.com"; // SMTP servers
$mail->SMTPAuth = true; // turn on SMTP authentication
$mail->Username = "*************"; // SMTP username
$mail->Password = "**********"; // SMTP password

$mail->From = "*********";
mail->FromName = "*****";
$mail->AddAddress(***********);

$mail->WordWrap = 50; // set word wrap

$mail->IsHTML(true); // send as HTML

$mail->Subject = "Welcome to LilShop";

$mail->Body = '<html>
<head>
</head>
<body>
<a href="http://localhost/mylilshoppev4/mylilshoppe/menu.php">
<img src="C:\phpwebsites\mylilshoppev4\mylilshoppe\images\images\lilshop.gif"alt="lilshop "  width="380" height="380" style="margin-left:1.5em;margin-top:1.5em;"/></a>
</body>
</html>';

$mail->Send(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:08:39.460

该图像使用本地路径。接收电子邮件的任何人都无法使用该文件。

利用`http://localhost/mylilshoppev4/mylilshoppe/images/images/lilshop.gif`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:09:37.773

source 必须始终是图像的 URL，代码中的图像永远不会显示/上传到邮件中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:22:40.410

除了将文件放在外部网站上——imageshack、flickr 等等——还可以将图像的内容作为“附加文件”包含在电子邮件中。如果您想这样做，请调查邮件附件和 mime64 编码。您仍然可以使用 url 引用该文件，但它是一个相对的，即前面没有[http://example.com/](http://example.com/)。

只是一个警告......如果这是互联网上的一个站点，请确保您知道您从浏览器中读取的任何值都是您期望的：最好不要从浏览器中读取它，但有尽可能硬编码。

另外，我建议确保不能在任何其他上下文中调用 php 邮件函数 - 例如，希望“ [http://example.com/email.php](http://example.com/email.php) ”会调用它的人，即使没有引用该文件的链接.

HtH

露丝

# javascript - 推送到节点 request() 中的数组

> ID：14718673
> 
> 赞同：0
> 
> 时间：2013-02-05T23:06:29.973
> 
> 标签：javascript, node.js

我正在尝试使用[Request](https://github.com/mikeal/request)和[Cheerio](https://github.com/MatthewMueller/cheerio)构建一个简单的网络爬虫。

现在的目标是抓取目标页面（在本例中为[http://bukk.it](http://bukk.it)），从页面上的目标选择器中抓取文本，并将其推送到我可以在其他函数中使用的数组中。

我知道这`request()`是异步执行的，但不知道如何在函数外看到抓取的数据。

**例子.js**

```
// dependencies
var request = require('request')
, cheerio = require('cheerio');

// variables
var url = 'http://bukk.it/'; // url to scrape
var bukkits = []; // hold our scraped data

request(url, function(err, resp, body){

  if (err) {
    return
  }

  $ = cheerio.load(body);
  // for each of our targets (within the request body)...
  $('td a').each(function(){
    content = $(this).text();
    // I would love to populate the bukkits array for use later...
    bukkits.push(content);
  })
  console.log(bukkits.length); // everything is working inside request
});

console.log(bukkits.length); // nothing, because request is asynchronous?

// that's cool but... how do I actually get the data from the request into bukkits[] ? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:23:21.800

本质上，您的整个程序现在必须在回调中进行。该回调之后的任何代码都无法访问异步检索并传递给回调的数据。

这并不像听起来那么糟糕。您可以使用命名函数，如下所示：

```
request(url, onRequestDone);

function onRequestDone(err, resp, body) {
  var bukkits = []; // not global, make it local

  // as above

  doMoreWork(bukkits);
}

function doMoreWork(bukkits) {
  // stuff after the parsing goes here.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:19:47.527

您的代码在请求完成之前结束。

使用永久版本的代理

```
request = require('request').forever; 
```

使用 setTimeout 来保持程序运行。

```
setTimeout(function(){}, 1000000); 
```

要稍后使用这些值，还需要在请求调用完成后完成。

# android - 如何在android中显示日期选择器

> ID：14718677
> 
> 赞同：0
> 
> 时间：2013-02-05T23:07:00.217
> 
> 标签：android, button, datepicker

我是 Android 开发的新手，所以如果你觉得我的问题太简单了，我提前道歉。

我按照这里的教程创建了一个日期选择器：http: [//developer.android.com/guide/topics/ui/controls/pickers.html](http://developer.android.com/guide/topics/ui/controls/pickers.html)

它有效，但我想知道是否有一种方法可以显示日期选择器而无需单击按钮？基本上我希望日期选择器现在自动显示在与我的按钮完全相同的位置。我正在考虑只有一个空的 TextView 并在那里调用 showDatePickerDialog 但这显然不起作用。

这是我当前按钮的 xml 部分：

```
<Button 
    android:id="@+id/pick_date"
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"
    android:text="@string/pick_date" 
    android:onClick="showDatePickerDialog" /> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:12:28.370

Android 中有一个 DatePicker 小部件。如果您使用的是 Eclipse，请查看 XML 文件的“图形布局”以查看可用的小部件。

这应该可以解决问题：

```
<DatePicker 
    android:id="@+id/pick_date"
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content" /> 
```

# javascript - 谷歌地图API，js未定义对象？

> ID：14718681
> 
> 赞同：0
> 
> 时间：2013-02-05T23:07:33.293
> 
> 标签：javascript, google-maps-api-3

```
var myloc;

function initialize() {

  var mapOptions = {
    zoom: 14,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };    
  var map = new google.maps.Map(document.getElementById("map_canvas"), 
            mapOptions);

  var mylocOptions = {
    draggable: true,
    animation: google.maps.Animation.DROP,
    title: "You are here..."
  };
  myloc = new google.maps.Marker(mylocOptions);

<% if !signed_in? || !current_user.loc %>
  if (navigator.geolocation) navigator.geolocation.getCurrentPosition(function(pos) {
    var me = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
    myloc.setPosition(me);
    myloc.setMap(map);
    map.setCenter(me);
    $.ajax({
      data: { me: me.toString() },
      type: 'POST',
      url: '/set-location'
    })
  }, function(error) {
      var address = prompt('Where are you looking?');
      geocoder = new google.maps.Geocoder();
      geocoder.geocode({ 'address': address }, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          var me = results[0].geometry.location
          myloc.setPosition(me);
          myloc.setMap(map);
          map.setCenter(me);
        } else {
          alert("Geocode was not successful for the following reason: " + status);
        };
      });
  });

<% else %>
  var me = new google.maps.LatLng(<%= current_user.loc %>);
  myloc.setPosition(me);
  myloc.setMap(map);
  map.setCenter(me);

<% end %>

} 
```

所以，我不是想提醒一些东西，但这就是我发现问题的方式。为真时，`myloc is undefined`. 为假时，为`myloc = Object object`. `navigator.geolocation`该功能中是否有可以`myloc`被识别的东西？

我想通过`var myloc`在初始化函数之外声明，一切都是肉汁。范围问题？谷歌地图诡计？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:02:45.433

地理定位是一个异步过程。

在`getCurrentPosition`执行的回调时，标记已经创建，因为浏览器在请求用户位置时会继续执行脚本。

# c# - 读取行 Asp:Table 并将单元格值插入 DB

> ID：14718687
> 
> 赞同：0
> 
> 时间：2013-02-05T23:07:47.337
> 
> 标签：c#, asp.net, row

我描述了这个问题：我有一个 aspx 页面，其中有一个由两行和两列组成的表格。

我需要读取单元格中的值并在数据库中执行插入查询。

但是如何读取行中的值并在数据库中插入 2 行？

页面.aspx：

```
<asp:table id="Tbl1" cellpadding="3" cellspacing="3" runat=server 
         Width="301" Height="76" BorderColor="Black" BorderWidth="1" BorderStyle="None" 
         GridLines="Both">

            <asp:TableRow>
            <asp:TableHeaderCell ColumnSpan="2"><label class="LabelCampi">Taglie</label></asp:TableHeaderCell>
            </asp:TableRow>
            <asp:TableRow>
                <asp:TableHeaderCell><label style="font:Arial, Helvetica, sans-serif; font-size:14px; font-weight: bold;">Valore Effettivo</label></asp:TableHeaderCell>
                <asp:TableHeaderCell><label style="font:Arial, Helvetica, sans-serif; font-size:14px; font-weight: bold;">Valore Etichetta</label></asp:TableHeaderCell>
            </asp:TableRow>     
            <asp:TableRow>
                <asp:TableCell>
                <asp:DropDownList ID="DropDownListl" runat="server">
                <asp:ListItem>37</asp:ListItem>
                <asp:ListItem>38</asp:ListItem>
                <asp:ListItem>39</asp:ListItem>
                </asp:DropDownList>

                </asp:TableCell>
                <asp:TableCell>
                <asp:TextBox ID="txt1" runat="server"></asp:TextBox>
                </asp:TableCell>
            </asp:TableRow>
            <asp:TableRow>
                <asp:TableCell>
                <asp:DropDownList ID="DropDownList2" runat="server">
                <asp:ListItem>37</asp:ListItem>
                <asp:ListItem>38</asp:ListItem>
                <asp:ListItem>39</asp:ListItem>
                </asp:DropDownList>
                </asp:TableCell>
                <asp:TableCell>
                <asp:TextBox ID="txt2" runat="server"></asp:TextBox>
                </asp:TableCell>
            </asp:TableRow>

        </asp:table>
        <asp:Button ID="SaveIntoDB" runat="server" Text="Save into DB" 
            onclick="SaveIntoDB_Click" /> 
```

代码背后：

```
protected void SaveIntoDB_Click(object sender, EventArgs e)
        {
            Table table = (Table)Page.Form.FindControl("Tbl1");
            if (table != null)
            {
                foreach (TableRow row in table.Rows)
                {
                    //here you can access the property of each row
                    foreach (TableCell cell in row.Cells)
                    {
                        //here query insert?
                    }
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:47:11.107

```
protected void SaveIntoDB_Click(object sender, EventArgs e)
    {
        string Str1 = (string)this.FindControl("Label1");
        SqlCommand sqlCmd = new SqlCommand("UPDATE table SET column1= @para1", sqlConn); 
        sqlCmd.Parameters.AddWithValue("@para1", Str1);
         try
           {
             sqlConn.Open();
             sqlCmd.ExecuteNonQuery();
            }
         finally
         {
            sqlConn.Close();
         }
    } 
```

Label1 是您要存储到 DB 的标签的 id。

# delphi - 有没有办法在编译时声明对方法的 const 引用？

> ID：14718688
> 
> 赞同：11
> 
> 时间：2013-02-05T23:07:51.483
> 
> 标签：delphi

我正在开发一个脚本解释器，我已经设法进入工作状态。它有一个解析脚本并生成字节码的编译器，以及一个执行字节码的虚拟机。

解释器的核心是一个带有巨大`case`语句的循环，看起来像这样：

```
case CurrentOpcode.Operation of
  OP_1: DoOp1(CurrentOpcode);
  OP_2: DoOp2(CurrentOpcode);
  ...
  OP_N: DoOpN(CurrentOpcode);
end; 
```

分析告诉我，无论出于何种原因，我的脚本执行都在该语句中花费了大量时间`case`，这对我来说似乎很奇怪，所以我正在寻找一种优化它的方法。`Operation`显而易见的解决方案是，由于所有操作函数基本上具有相同的签名，因此创建一个由操作码值索引的方法指针数组。但是`Operation`被声明为枚举，如果能够将其声明为 const 数组，那就太好了，这样如果我将来添加更多操作码，编译器可以提醒我更新数组。

由于方法指针存储运行时状态（`Self`对其运行对象的引用），因此我无法创建方法指针的 const 数组。（无论如何，这也不是一个好主意，因为我很可能最终会同时运行多个脚本。）但是无论如何，方法只是语法糖。就像是：

```
procedure TMyObject.DoSomething(x, y: integer); 
```

真正意思：

```
procedure TMyObject_DoSomething(Self: TMyObject; x, y: integer); 
```

所以我应该能够以后一种形式声明一个函数指针类型并以这种方式分配它，然后我只需要`Self`在调用它时显式地作为第一个参数传递。但是编译器不喜欢这样。

```
type TOpcodeProc = procedure (Self: TScriptVM; Opcode: TOpcode);
const OPCODE: TOpcodeProc = TScriptVM.DoOp1;

[DCC Error]: E2009 Incompatible types: 'regular procedure and method pointer' 
```

我已经尝试了不同的变体来尝试让它编译，但它们都给出了错误。有没有办法让它编译？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T08:26:57.353

宣言：

```
const
  OPCODE: array[TOperation] of Pointer = (
    @TScriptVM.DoOp1, 
    @TScriptVM.DoOp2, 
    ... 
    @TScriptVM.DoOpN
  ); 
```

称呼：

```
TOpcodeProc(OPCODE[CurrentOpcode.Operation])(Self, CurrentOpcode); 
```

更酷的东西：

```
var
  OpCodeProcs: array[TOperation] of TOpCodeProc absolute OPCODE; 
```

调用该方法的语法要好得多：

```
OpCodeProcs[CurrentOpcode.Operation](Self, CurrentOpcode); 
```

好事是因为绝对常量编译器阻止你分配一些东西给 OpCodeProcs 变量！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T23:27:44.343

没有解决您问题中不变部分的方法，但这是您可以消除的方法`case`：

```
type
  TTestMethod = procedure(Instance: TObject; Param1, Param2: Integer);

  TTest = class(TObject)
  private
    FMethods: array[0..1] of TTestMethod;
    procedure InitMethods;
    procedure CallMethod(ID: Integer; Param1, Param2: Integer);
  protected
    procedure TestMethod0(Param1, Param2: Integer);
    procedure TestMethod1(Param1, Param2: Integer);
  end;

procedure TTest.InitMethods;
begin
  FMethods[0] := TTestMethod(@TTest.TestMethod0);
  FMethods[1] := TTestMethod(@TTest.TestMethod1);
end;

procedure TTest.CallMethod(ID: Integer; Param1, Param2: Integer);
begin
  FMethods[ID](Self, Param1, Param2);
end; 
```

# c# - 如何删除由 xmlreader 在 C# 中打开的文件？

> ID：14718689
> 
> 赞同：2
> 
> 时间：2013-02-05T23:07:59.873
> 
> 标签：c#, xml, winforms, xmlreader

我研究了几个问题，但我找到的答案都没有帮助。此函数的目标是修改 xml 文件。我读取原始文件并将旧的东西和新的东西写入新文件。所有这一切都完美无缺。当我完成并需要删除旧文件并移动新文件时，问题就出现了。

收到的错误是 jnv_config.xml 正在被另一个进程（阅读器文件）使用。

删除 Close 和/或 Dispose 并不能解决问题。

```
using (XmlReader reader = XmlReader.Create("jnv_config.xml"))
using (XmlWriter writer = XmlWriter.Create("jnv_temp.xml"))
{
    writer.WriteStartDocument();
    while (reader.Read())
    {
      // Read the file, write to the other file - this part works perfectly.
      // No filestreams nor anything else is created in here.
    }
    writer.WriteEndElement();
    writer.WriteEndDocument();
    reader.Close();
    writer.Close();
    reader.Dispose();
    writer.Dispose();
}
// Delete the old file and copy the new one
File.Delete("jnv_config.xml");
//File.Move("jnv_temp.xml", "jnv_config.xml"); 
```

我正在使用 VS2012 (NET 4.5)、C#、标准 Windows 窗体项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T00:12:08.420

你确定是这个`XmlReader`文件仍然打开吗？在执行此代码之前，您是否尝试过使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653 "Process Explorer")确认配置文件没有打开的文件句柄？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:18:53.633

根据我的经验，许多 NTFS 文件处理函数（尤其是 DELETE）是略微异步的。尝试在重命名之前添加睡眠或等待至少 0.2 秒。

* * *

由于这不起作用，我建议将睡眠/等待放在*前面*，然后慢慢增加它直到它起作用。如果你达到了一些不合理的大时间跨度（比如 10 秒）并且它仍然不起作用，那么我认为你可以公平地得出结论，问题是`XmlReader`只要你留在这段代码中，你就没有被释放。

在这种情况下，您可能需要做一些事情来确保它被完全处置，比如强制 GC 运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T00:26:43.830

Check if the file is ready before you delete it. If your working with large files perhaps call code via a loop for a couple of seconds.

```
private void IsFileOpen(FileInfo file)
{
    FileStream stream = null;
    try {
        stream = file.Open(FileMode.Open, FileAccess.ReadWrite, FileShare.None);
    }
    catch (Exception ex) {

        if (ex is IOException && IsFileLocked(ex)) {
            // do something here, either close the file if you have a handle or as a last resort terminate the process - which could cause corruption and lose data
        }
    }
}

private static bool IsFileLocked(Exception exception)
{
    int errorCode = Marshal.GetHRForException(exception) & ((1 << 16) - 1);
    return errorCode == 32 || errorCode == 33;
} 
```

# jquery - 如何在带有主干的视图周围传递变量

> ID：14718694
> 
> 赞同：0
> 
> 时间：2013-02-05T23:08:09.627
> 
> 标签：jquery, variables, backbone.js, views

我目前正在编写一个 Backbone 应用程序，并且陷入了一个看似非常简单但似乎无法解决的问题。

假设我有这样的视图（演示代码）

```
var View = Backbone.View.extend({
    initialize: function () {
         console.log('created a view');
    },
    events: {
         'click button':'buttonClicked',
         'click link':'linkClicked'
    },
    buttonClicked: function (event) {
         // I would like to store the event and pass this to the 
         // linkClicked function below when the linkClicked function is called 
         var $currentEvent = $(event.currentTarget);
    },
    linkClicked: function () {
         // When the link is clicked I would like to gain access to $currentEvent
    }
}); 
```

单击链接时，我想将变量 $currentEvent 传递给函数 linkClicked 。最好将它存储在模型中，还是我可以在视图周围传递变量。

对此的任何帮助都会很棒！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:11:20.147

你可以这样做：

```
initialize: function () {
     /** Initialize the variable when View is first created. */
     this.currentEvent = 'something'; 
},
buttonClicked: function (event) {
     /** Assign variable when button is clicked. */
     this.currentEvent = $(event.currentTarget);
},
linkClicked: function () {
     /** Receive the value of the variable and output it. */
     console.log(this.currentEvent);
} 
```

# git - 测量大型源树中的“接近度”

> ID：14718696
> 
> 赞同：7
> 
> 时间：2013-02-05T23:08:31.697
> 
> 标签：git, diff, directory-structure

作为我之前提出的关于[在两个源之间找到最佳匹配](https://stackoverflow.com/questions/13898659/finding-what-git-commit-some-code-spawned-from)的问题的一部分，其中一个具有活动的 git repo 而另一个没有 git 历史记录，我编写[了一个 perl 脚本来查找最接近的 git commit](https://github.com/redbmk/bin/blob/master/git-diff-search)。

我正在重写脚本，这样您就不必猜测要使用哪个分支，但它会运行并在所有分支中找到最接近的匹配项，然后告诉您具有最佳分支的最佳提交。不幸的是，我发现我使用的测量方法可能不是“亲近度”的最佳判断。

目前，我`diff -burN -x.git my_git_subtree my_src_subtree | wc -l`用来确定代码树的接近程度。这似乎或多或少地起作用，但我遇到了添加或丢失整个文件夹的情况，这些文件夹可能存在或不存在于另一个分支中。

有没有更好的方法来确定来源有多近？我正在设想一些比较目录结构的东西，可能还有多少行不同。可能只是将不同的参数传递给`diff`，或者可能有另一个工具可以做类似的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T17:02:51.027

为了改进你的测量，为什么不试试 'git diff --shortstat' 呢？输出如下所示：

```
 1 file changed, 1 insertion(+), 2 deletions(-) 
```

您可以根据结果尝试如何确定文件更改/插入/删除的优先级。

查看您的 perl，我认为您可能无法对提交之间的“接近性”顺序做出假设——您可能需要强力检查每个提交，或者至少将其作为一个选项。

我还建议不要寻找最接近的，而是保留（提交，“接近”）对的排序列表，并可能显示前几对并手动查看它们。如下所述，仅通过查看更改次数来确定两组代码是否接近并没有灵丹妙药。也就是说，更改的数量绝对可以帮助您缩小应该查看的列表...

**更新：**我还应该提到使用 git diff 的另一个优点是您不必为每次提交运行硬重置。只需符号链接 .git/ 目录从你的未知树（一个 w/oa git 历史），并使用 git reset [--mixed] 它会更新当前的头指针，但保持你的源不变（显然需要备份未知使用此方法之前的源树）。

# c++ - 没有背景的透明 SDL_Surface

> ID：14718698
> 
> 赞同：0
> 
> 时间：2013-02-05T23:08:46.520
> 
> 标签：c++, opengl, sdl, alpha, sdl-ttf

我正在使用 SDL 和 OpenGL。我正在使用 SDL ttf 使用文本创建表面，然后使用该表面创建纹理。

我正在尝试将 alpha 通道（不透明度）应用于文本，我正在使用这种方式：

```
 SDL_Surface * fontsurf = TTF_RenderUTF8_Blended(font,buff_split.at(i).c_str(),color);
SDL_PixelFormat *format = fontsurf->format;
SDL_Surface* newSurface = SDL_CreateRGBSurface( SDL_SRCALPHA,
   fontsurf->w, fontsurf->h, 32,
   0x000000ff, 0x0000ff00, 0x00ff0000, 0xff000000 );

    Uint32 alpha = 0;
    alpha = SDL_MapRGBA( newSurface->format, 0,0,0, color.unused);

    SDL_Rect rect;
    rect.x = 0;
    rect.y = 0;
    rect.h = fontsurf->h;
    rect.w = fontsurf->w;
    int ret = SDL_FillRect( newSurface, &rect, alpha);

    SDL_SetAlpha(newSurface,SDL_SRCALPHA,SDL_ALPHA_TRANSPARENT);

    ret = SDL_BlitSurface( fontsurf, 0, newSurface, 0 ); 
```

不透明度应用正确，但 SDL_MapRGBA 在“newSurface”中创建黑色背景。如何将 alpha/opacity 应用于文本，而不添加背景，仅添加文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T19:17:15.073

我认为您缺少 newSurface 的 SDL_SetColorKey。

像这样的东西：

```
SDL_SetColorKey( newSurface , SDL_SRCCOLORKEY, SDL_MapRGB( newSurface->format, 0, 0, 0) ); 
```

甚至更简单的是跳过用黑色矩形填充 newSurface

删除这个：

```
SDL_FillRect( newSurface, &rect, alpha); 
```

这是我如何使用透明颜色制作图片的示例：

```
testImage = IMG_Load( "trans.png" );
// This picture contains color 255,0,255 which will be set as transparent

SDL_SetColorKey( testImage , SDL_SRCCOLORKEY, SDL_MapRGB( screen->format, 255, 0, 255) );
// I set the color 255,0,255 as transparent for that surface

SDL_BlitSurface( testImage , NULL , screen , NULL );
// and I draw it on the main surface (screen) 
```

# jasper-reports - 贾斯珀条形图

> ID：14718702
> 
> 赞同：0
> 
> 时间：2013-02-05T23:09:06.940
> 
> 标签：jasper-reports

只是想问一下jasper是否可以生成如下堆积条形图？如果是，我该怎么做？非常感谢您的帮助

![在此处输入图像描述](../Images/72e6a84223718c34367f63c2afddc8ad.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T06:20:58.447

我认为如果不将 JasperReport 服务器与任何其他图表库集成是不可能的，在当前的 Ireport 中，您只能使用现有的堆栈条形图，然后您可以使用此属性设置图形属性“显示标签”，您可以在栏中看到值。

# microsoft-sync-framework - 同步框架卡在 Synchronize()

> ID：14718705
> 
> 赞同：0
> 
> 时间：2013-02-05T23:09:11.893
> 
> 标签：microsoft-sync-framework

我有一个简单的应用程序，它在 2 个表上同步 2 个数据库，事情是，在配置和取消配置之后，我被困在这个`Synchronize()`方法中。它没有抛出任何错误，SQL Profiler 已经抛出了`Audit Logout`事件类。

这是在 microsoft 服务上，当查看它的进程时，它仍然使用 400mb 的内存以及 sqlserver.exe。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:31:15.210

它被卡住了多长时间以及您尝试同步的更改有多大。

您应该启用 Sync Fx 跟踪，这样您就知道它在哪里。

它应该永远卡在那里，因为最终 SQL 命令将超时。

# cross-browser - 有没有办法从 firefox 和 chrome 启动 exe 应用程序

> ID：14718706
> 
> 赞同：1
> 
> 时间：2013-02-05T23:09:12.920
> 
> 标签：cross-browser, exe

我有一个 Intranet 站点，所以我不担心安全问题。我需要做的是允许我的用户从浏览器链接启动 putty.exe。关键是不同ip的端口等上有许多腻子连接。

目前我们使用IE和activex。但我们想使用 chrome 或 firefox。

我听说过 ie tab 和 locallink，但它们并不那么可行。

有没有办法从链接、跨浏览器启动程序？IE`<a href="c:\program file\putty.exe -ip=2.3.4.5 -port=1111 -user=user -pass=pass">Putty</a>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:18:16.080

由于您要使用的程序是 PuTTY，因此您可以执行以下操作：

```
<a href="telnet://<your-ip and some other parameters>">Putty</a> 
```

在 Chrome 和 Firefox 中，第一次会提示您为该协议选择适当的程序，之后该程序应自动启动...

如果您的客户端软件（在本例中为 PuTTY）注册了这些 URI 方案，您也可以使用`ssh`or`ssh2`代替......`telnet`

# c# - 用于将 ObservableCollection 解释为 StackPanel 元素的 WPF 样式

> ID：14718707
> 
> 赞同：2
> 
> 时间：2013-02-05T23:09:25.193
> 
> 标签：c#, wpf, styles, observablecollection, itemscontrol

我有一个动态实例化的数据数组（存储为`ObservableCollection`），并且我将它链接`ItemsControl`到`StackPanel`. 数据格式如下：

```
public class VariableValueList<T>
{
    public String Name {get; private set;}
    public IList<T> Values {get; private set;}
    ...
} 
```

并且 my `ObservableCollection<VariableValueList<double>> IVCollection`，在构造之后，`ItemsControl`与以下内容相关联：

**主窗口.xaml.cs**

```
private void Open_OnClick(object sender, RoutedEventArgs e)
{
    ...
    IndependentVariables.ItemsSource = IVCollection;
} 
```

`IndependentVariables`起源于这里：

**主窗口.xaml**

```
 <StackPanel>
            <ItemsControl Name="IndependentVariables" Style="{StaticResource IVCell}"></ItemsControl>
        </StackPanel> 
```

我需要构建 Style`IVCell`来访问每个`VariableValueList<double>`（一旦我得到它，获得它的`Name`和`Values`成员将是微不足道的）。

我需要对数据进行格式化，以便对每个元素进行打印`Name`，`Values`如下所示：

> 姓名
> 
> 价值价值价值...
> 
> 姓名
> 
> 价值价值价值...
> 
> ...

利用现有的`StackPanel`. 我知道这个问题至少有两个潜在的问题。

1.  如何让 Style 访问这个数组？（或：拥有数组后如何修改样式？）

2.  我如何在 Style 中即时实例化新元素（例如，对于每个数组元素）？

我真的很感谢你的帮助。如果我试图以这种方式构建任何*完全*错误的东西，请纠正我。我对 WPF 相当陌生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:28:36.437

您不需要额外的`StackPanel`，因为`ItemsControl`将为项目创建它自己的面板。Style 不需要访问数组，`ItemsControl`自动为所有项目创建和管理容器。您只需要提供`DataTemplate`这两种类型的物品。您可以使用另一个`ItemsControl`内部`DataTemplate`for`VariableValueList<double>`来显示`Values`属性中包含的项目。要获得水平布局，请为此设置自`ItemsPanelTemplate`定义`ItemsControl`。

简单的风格开始：

```
<Style TargetType="{x:Type ItemsControl}"
       x:Key="IVCell">
    <Setter Property="ItemTemplate">
        <Setter.Value>
            <DataTemplate>
                <StackPanel>
                    <TextBlock Text="{Binding Name}" />
                    <ItemsControl ItemsSource="{Binding Values}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel />
                                <!-- or <StackPanel Orientation="Horizontal"> -->
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" Margin="2,0" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </DataTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# css - 将 div 设置为具有 2 列的动态宽度

> ID：14718711
> 
> 赞同：0
> 
> 时间：2013-02-05T23:09:52.357
> 
> 标签：css, html, column-width

我确信这已被涵盖，但我不确定要搜索什么。

我在 1 个 div 中有 2 个 div。2 个内部 div 我`float:left`有 2 列。第一个 div 属于 .username 类。第二个 div 属于 .commentText 类。外部 div 称为 .comment：

```
.comment{
  border: 0px;
  clear: both;
}

.commentText, .username {
  float:left;
} 
```

但是，如果 2 个内部 div 的内容之和大于外部 div 的宽度，则第二个内部 div 低于第一个内部 div。

例如：在下图中，时间戳在用户名 div 中。评论在commentText div 中。请注意时间戳下方的底部注释凸起。

我得到什么：

![我得到了什么](../Images/d92de768fbb1e507665660ec9261c231.png)

我想要的是：

![我想要的是](../Images/f0c8850173fcef1d276bec3eab9428c8.png) 我想要的是底部评论上的 commentText 保持宽度，如果它只有 1 行并且只是垂直增长。另请注意，每个评论中的 .username div 具有不同的宽度。

谢谢！

编辑：我刚刚找到了一个不错的解决方案，其中我使用 max-width: 20% for .username 和 max-width: 79% for .commentText，但问题是我不想限制用户名的宽度分区。如果用户名很短而评论很长，那么它不会一直填充到外部 div 的右侧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:07:23.237

我知道它在所有时代的所有浏览器上都不是交叉兼容的，但@bybe 给了我一个使用 display:table-cell[的建议。](http://jsfiddle.net/pkxjF/)这很好用。

```
.commentText, .username {
    display:table-cell;
    margin:0px 0px 10px 0px;
}

.username {
    padding: 0px 15px 0px 0px;
    white-space:nowrap;
} 
```

# css - 如何将静态布局和流体布局与 Twitter Bootstrap 结合起来？

> ID：14718717
> 
> 赞同：1
> 
> 时间：2013-02-05T23:10:08.377
> 
> 标签：css, twitter-bootstrap, fluid-layout

我真的很喜欢 Bootstrap 的流畅布局，但有一个例外。缩小侧边栏非常不方便，因为侧边栏通常包含导航或帮助内容，在调整大小时看起来很糟糕。有没有办法将侧边栏锁定为一种尺寸，同时让界面的其余部分保持流畅？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:14:10.910

也许通过在相关列中添加最小宽度/最大宽度？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T03:53:40.020

我明白你的意思，但这可能不值得这样做。要么选择完全流畅的布局，要么选择完全固定宽度的布局。

否则，您很可能会使用 JavaScript 解决方案通过从页面中减去侧边栏宽度来计算内容的宽度。我不太确定仅使用 CSS 的另一种方法，因为一个是静态像素值，另一个是百分比。

# php - 发布 XML 订单：无法检索查询字符串参数

> ID：14718719
> 
> 赞同：0
> 
> 时间：2013-02-05T23:10:24.927
> 
> 标签：php, xml, post, curl

我正在从数据库创建 XML 文件。随后，我正在获取该 XML 文件并尝试将其发布到外部网站。在处理与解析错误有关的严重问题后，我意识到问题是使用 DOMDocument 的结果，因此我将其转换为 simpleXML。

我收到的错误是：Obj: SimpleXMLElement Object ([@attributes] => Array ([Reason] => Failed to retrieve query string parameters)) Reference=

```
//Save XML
$xmlDoc->save("file.xml");

//Convert DOMDocument to SimpleXML
$sxmlDoc = simplexml_load_file("file.xml");
print_r($sxmlDoc);

//Posting Order XML with PHP
$PartnerNumber = '1111'; 
$PartnerReference = $row['id'];
$OrderXml = '<Order Test="true">'.$sxmlDoc.'</Order>';
$urlConn = curl_init ("https://website.com/PostXmlOrder.axd?
   PartnerNumber=".$PartnerNumber."&PartnerReference=".urlencode($PartnerReference));
curl_setopt ($urlConn, CURLOPT_POST, 1);
curl_setopt ($urlConn, CURLOPT_HTTPHEADER, array("Content-type", "text/xml"));
curl_setopt ($urlConn, CURLOPT_POSTFIELDS, $sxmlDoc);
curl_setopt ($urlConn, CURLOPT_RETURNTRANSFER, 1);
curl_setopt ($urlConn, CURLOPT_SSL_VERIFYPEER, 0);
$result = curl_exec($urlConn);
if (empty($result)) {
  print "ERROR: " . curl_error($urlConn) . "\n";
  exit;
}
// Parse the response
$xml = simplexml_load_string($result);
echo "Obj:\r\n";
print_r($xml);
echo "Reference=";
echo $xml->attributes()->Reference; 
```

XML 文件以 SimpleXML 格式输出到屏幕。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:11:52.000

你正在做一些额外的循环。

让我们回顾一下：您很可能需要将 XML 发布为字符串，因此您不需要将 DOMDocument 转换为 SimpleXML，只需将其输出为字符串：

```
curl_setopt ($urlConn, CURLOPT_POSTFIELDS, $xmlDoc->saveXML()); 
```

也见[`DOMDocument::saveXML()`](http://php.net/domdocument.saveXML)。

注意*不要*转换`$xmlDoc`为 a `SimpleXMLElement`，因此请从上面删除该代码。

```
// Create XML String
$xml = $xmlDoc->saveXML();

// Posting Order XML with Curl
$PartnerNumber    = '1111'; 
$PartnerReference = $row['id'];

$url = sprintf(
  "https://example.com/PostXmlOrder.axd?PartnerNumber=%s&PartnerReference=%s", 
   urlencode($PartnerNumber), 
   urlencode($PartnerReference)
);

$urlConn = curl_init($url);
curl_setopt_array(
    $urlConn, 
    array(
        CURLOPT_POST           => 1,
        CURLOPT_HTTPHEADER     => array("Content-type", "text/xml"),
        CURLOPT_POSTFIELDS     => $xml,
        CURLOPT_RETURNTRANSFER => 1,
        CURLOPT_SSL_VERIFYPEER => 0,    
   )
);

$result = curl_exec($urlConn);
if (empty($result)) {
  print "ERROR: " . curl_error($urlConn) . "\n";
  exit;
}

// Parse the response
$sxml = simplexml_load_string($result);

echo "Obj:\r\n", print_r($sxml);
echo "Reference=", $sxml->attributes()->Reference; 
```

# bash - 如何 scp 文件名中带有冒号的文件？

> ID：14718720
> 
> 赞同：54
> 
> 时间：2013-02-05T23:10:32.337
> 
> 标签：bash, escaping, scp

我正在尝试使用源文件名`scp`中`bash`带有冒号 ( `:`) 字符的 in 复制文件。我正在使用的命令的混淆版本是：

```
scp file\:\ name.mp4 user@host:"/path/to/dest" 
```

我收到此错误：

```
ssh: Could not resolve hostname Portal 2: Name or service not known 
```

我知道我可以重命名文件并删除`:`，但我想知道是否可以转义冒号。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-02-05T23:16:26.910

不是一个`bash`逃避问题，它被`scp`视为`x:`[user@]host 前缀，请尝试：

```
scp ./file:\ name.mp4 user@host:"/path/to/dest" 
```

使用相对（例如`./`）或完全限定路径（`/path/to/source`）可以防止这种行为 -`/`之前的存在`:`导致 OpenSSH 停止检查可能的`host:`或`user@host:`前缀）。

OpenSSH`scp`唯一以冒号*开头*的特殊情况文件名允许它们正常工作，它不支持`:`在正常意义上转义 a，并且没有其他有效主机名的概念，因此几乎任何带有 a 的文件名`:`都可能导致这种情况（或等效如果`[` `]`在之前找到IPv6 行为`:`）。

这也可能影响其他程序，例如`rsync`，同样的解决方法适用于那里。

（由于 OpenSSH 对`[]`封闭的 IPv6 地址的简单解析，您可以成功地`scp`包含`:`以`[``@[``:``]:`

* * *

（**下面的文字是**在[最初的问题](https://stackoverflow.com/revisions/14718720/1)是*如何在 bash 中转义冒号时编写的？*它适用于这种情况，但不适用于`scp`任何 shell 转义都无济于事。）

要回答有关*如何*逃脱的问题`:`，您不需要，但“ `\:`”有效。使用a 的地方`:`：

1.  空命令`:`，不需要转义，虽然你可以，就像`\e\c\h\o foo`它对命令没有影响一样（“没有影响”并不完全正确，如果你转义一个或多个字符，它会阻止别名被匹配，你*可以*别名`:`）
2.  `PATH`（和其他人，`CDPATH`, `MAILPATH`）转义值没有有用的效果（我无法从包含 a 的目录中运行我的 PATH 中的程序`:`，这有点出乎意料）
3.  参数扩展`${name:-x}`等等，`name`必须是`[a-zA-Z_][a-zA-Z0-9_]`，所以不需要转义变量名称，并且由于没有歧义，不需要`:`在参数扩展的其他变体中转义后续
4.  `? :`trinary 只对变量和数字进行操作，无需转义
5.  `==`并且`=~`像这样的模式中的类`[[:digit:]]`，你可以逃脱，`\:`但我不知道这可能会有什么用......
6.  在命令或函数名称中，无需转义，`\:`没有任何用处

（请注意，空命令只是`:`，您可以拥有一个名为 " `:foo`" 的命令或函数，并且可以在不转义的情况下调用它，在这方面，它与需要转义的命令不同。`#`）`#foo`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-21T10:08:28.797

我尝试使用完全限定的路径作为@mr.spuratic 的答案，但不起作用，在我的情况下，我必须使用绝对路径，这是我的解决方案：

```
scp `hostname`:/root/this/is/test/file.txt user@host:"/path/to/dest" 
```

# css - iPhone4的百分比？

> ID：14718722
> 
> 赞同：0
> 
> 时间：2013-02-05T23:10:48.373
> 
> 标签：css, jquery-mobile

我对移动设计非常陌生，所以如果这是一个愚蠢的问题，请原谅..

我正在使用 Chrome 来模拟 iPhone 屏幕。我在 Chrome 中一切正常，然后当我在 iPhone 上尝试它时，标题（下面代码中的 .name-win）a）不是我期望的大小，并且 b）滚动时正在改变大小。

这是我现在拥有的代码

```
@media (max-width:480px){

body{
background:#FFF;
margin-top:0;
margin-left:0;
}

.container{
position:relative;
top:0;
left:0;
width:100%;
height:100%;
padding-left:0;
background:#EEE;
}

.name-win{
position:fixed;
background:#EEE;
top:0;
left:0;
height:27%;
width:100%;
z-index:10000;
overflow:hidden;
padding-left:5%;
-moz-box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
-webkit-box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
-o-box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
box-shadow:-2px 0px 2px 3px rgba(200, 200, 200, 0.8);
}

.scroll{
background:none;
}

.info-win{
position:relative;
margin-top:33%;
background:#FFFFFF;
height:100%;
width:100%;
z-index:1000;
min-height:500px;
overflow:hidden;
padding-bottom:20px;
}

.name-win h1{
font-family: 'Archivo Narrow', sans-serif;
font-weight:700;
max-width:200px;
margin-top:1px;
margin-left:119px;
margin-bottom:1px;
}

#pic{
float:left;
}

#pic img{
margin-top:-32px;
width:100px;
border:6px solid #fff;
}

.res_cont{
width:100%;
}

.contact h3{
margin-top:1px;
margin-left:120px;
margin-bottom:0px;
font-family: 'Archivo Narrow', sans-serif;
font-weight:700;
}

.contact p{
margin-top:0px;
font-family: 'Archivo Narrow', sans-serif;
font-weight:300;
margin-left:130px;
margin-bottom:1px;
}

.label{
height:33px;
width:420px;
padding-left:10px;
margin-bottom:10px;
}

.label h2{
font-family: 'Archivo Narrow', sans-serif;
color:#fff;
text-shadow:1px 1px #555;
}

.res_cont p{
font-family: 'Archivo Narrow', sans-serif;
color:#555;
margin-left:25px;
}

.res_cont span{
font-style:italic;
color:#999;
}

#objective_label{
background-color:#4F8AFF;
}

#rs_label{
background-color:#CC0000;
}

#about_label{
background-color:#00CC66;
}

#education_label{
background-color:#FF6633;
}

#links_label{
background:#E4B434
}

#links_ul li{
font-family: 'Archivo Narrow', sans-serif;
color:#666;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:30:06.180

你在 Iphone 上测试过什么类型的设备？适用于 iPhone 3

尝试添加CSS：

```
@media only screen and (max-device-width: 480px) {

} 
```

和html：

```
<link  rel="stylesheet" type="text/css" media="only screen and (max-device-width: 480px)"> 
```

# visual-studio - 从命令行将文件添加到 Visual Studio C++ 项目

> ID：14718724
> 
> 赞同：3
> 
> 时间：2013-02-05T23:10:57.030
> 
> 标签：visual-studio, visual-studio-2012

我已经检查了[/Command](http://msdn.microsoft.com/en-us/library/vstudio/19sf6kk3%28v=vs.100%29.aspx)和相关文档，但我没有找到任何方法将现有文件添加到命令行（C++，VS2012）打开项目中的特定过滤器。我有一个自动生成一些代码的脚本，我希望它将文件添加到项目中。

这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T19:22:16.323

您可以编写一个简短的脚本来编辑 .vc(x)proj.filters 文件中的 xml 并将文件名传递给它。不过，这仍然需要您卸载并重新加载项目，因为我认为它不会对文件进行实时更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-30T02:42:06.457

> ...我还没有找到任何方法将现有文件添加到命令行中打开项目中的特定过滤器（C++，VS2012）

您可以使用`/FI`强制包含未包含在项目源文件中的文件。我在将 OpenSSL 之类的库可以 Crypto++ 移植到 Windows RT 和 Windows Phone 时使用它。例如：

```
/FI SDKDDKVer.h /FI winapifamily.h 
```

有效地：

```
#include <SDKDDKVer.h>
#include <winapifamily.h> 
```

对于项目中的每个源文件。

不过，我不确定过滤器部分。（我不清楚你在做什么）。

# javascript - 带有 flatiron.app 的 Flatiron 路由表

> ID：14718729
> 
> 赞同：2
> 
> 时间：2013-02-05T23:11:23.040
> 
> 标签：javascript, flatiron.js

我从定义 flatiron.app 的教程开始使用 flatiron：

```
app = flatiron.app; 
```

教程使用 get、post 等方法定义路由。

```
app.router.get('/', function () {
   this.res.writeHead(200, { 'Content-Type': 'text/plain' });
   this.res.end('juuri\n');
}); 
```

而不是这个，我想使用带有路由表的director

```
var routes = {
   '/': (function(){
      this.res.writeHead(200, { 'Content-Type': 'text/plain' });
      this.res.end('root\n');
    }),

   '/cat': (function(){
      this.res.writeHead(200, { 'Content-Type': 'text/plain' });
      this.res.end('meow\n');
    })
}; 
```

如何将此路由表应用于“本机”app.router？

是否可以使用路由表将获取和发布请求分开？

# 好的，从 flatirons google group 找到答案：

这有效：

```
var routes = {
    //
    // a route which assigns the function `bark`.
    //
    '/': {
        get: (function(){
           this.res.writeHead(200, { 'Content-Type': 'text/plain'});
           this.res.end('root\n');
        })

    },

    '/cat': { 
          get: (function(){
             this.res.writeHead(200, { 'Content-Type': 'text/plain' });
             this.res.end('cat\n');
          })
        }
      }

app.router.mount(routes);This works:

var routes = {
    //
    // a route which assigns the function `bark`.
    //
    '/': {
        get: (function(){
           this.res.writeHead(200, { 'Content-Type': 'text/plain'});
           this.res.end('root\n');
        })

    },
    '/cat': { 
        get: (function(){
           this.res.writeHead(200, { 'Content-Type': 'text/plain' });
           this.res.end('cat\n');
        })
     }
}

app.router.mount(routes); 
```

# sql - 将查询结果提取到过程中的游标中

> ID：14718730
> 
> 赞同：3
> 
> 时间：2013-02-05T23:11:43.680
> 
> 标签：sql, oracle, oracle11g

我正在将许多程序从 MySQL 迁移到 oracle，我发现了一些问题。这是我到目前为止所得到的：

```
CREATE OR REPLACE PROCEDURE PROCEDURE1(PROCEDURE_PARAM IN NUMBER)
IS
CURSOR C1 (CURSOR_PARAMETER IN NUMBER)
IS
 SELECT COL1, COL2, MY_FUNCTION1(P1), SUM(COL3), MY_FUNCTION2(P1,P2)
        COL4, MY_FUNCTION(P1,P2,P3,P4)
 FROM TABLE_1
 WHERE COL1 = CURSOR_PARAMETER -- How to reference it to 'Procedure_param' ?
 GROUP BY COL1, COL2, COL4
 ORDER BY COL2;

BEGIN
    -- HOW TO FETCH RESULTS INTO CURSOR ??
END PROCEDURE1;
/ 
```

这些是名称列和函数（用户创建的函数）的示例。我关心的是如何告诉游标参数`CURSOR_PARAMETER`是相同的`PROCEDURE_PARAM`，也是最重要的，如何将结果提取到游标中？我陷入了这个问题。任何帮助，将不胜感激。通过这个例子，我可以开始转换我必须的所有程序。

最好的祝福。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:04:06.947

你会像这样从游标中获取：

```
BEGIN
  for r_row in C1(PROCEDURE_PARAM)
  loop
    dbms_output.put_line(r_row.col1);--or whatever you want to do here.
  end loop;
end; 
```

虽然我通常更喜欢将这些内联写成

```
begin
  for r_row in (SELECT COL1, COL2, MY_FUNCTION1(P1), 
                       SUM(COL3), MY_FUNCTION2(P1,P2)
                       COL4, MY_FUNCTION(P1,P2,P3,P4)
                  FROM TABLE_1
                 WHERE COL1 = PROCEDURE_PARAM 
                 GROUP BY COL1, COL2, COL4
                 ORDER BY COL2)
  loop
    ...
  end loop; 
```

这样我就不必向上滚动到光标 def 来查看它实际上在做什么。

# ruby-on-rails - RoR - 不要破坏对象，只是标记为隐藏

> ID：14718733
> 
> 赞同：10
> 
> 时间：2013-02-05T23:12:17.790
> 
> 标签：ruby-on-rails

我在 RoR 中有一个简单的模型，我想保留人们在网站上输入的所有内容。但是，如果用户单击“删除”，我也希望能够隐藏一些内容。

所以我在我的模型中添加了一个名为“displayed”的布尔属性。

我想知道，最佳实践风格的方法是什么。

我想我必须用类似的东西改变控制器：

```
def destroy
 @point = Point.find(params[:id])
 @point.displayed = false
 @point.save

respond_to do |format|
  format.html { redirect_to points_url }
  format.json { head :no_content }
end 
```

但我不确定它是否干净。最好的方法是什么。

正如你猜想的那样，我对 RoR 不屑一顾。代码块将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-06T01:27:08.403

自己实现它（而不是使用 gem）。它比一开始看起来要容易得多，而且它也没有任何**改变**方法含义的宝石那么复杂`destroy`，在我看来，这是一个坏主意。

我并不是说使用 gem 本身很复杂——我是说通过改变`destroy`方法的含义，你正在改变 Rails 世界中人们认为理所当然的东西的含义——当你调用`destroy`该记录时会消失，`destroy`如果它们通过`dependent: destroy`回调链接在一起，也可能会在依赖对象上调用。

更改 的含义`destroy`也很糟糕，因为在“约定优于配置”的世界中，当您违反约定时，您实际上是在破坏 Rails 代码的“自动性”。所有这些你认为理所当然的东西，因为你阅读了一段 Rails 代码，并且你知道某些假设通常适用——那些已经过时了。当您以不明显的方式更改这些假设时，您几乎肯定会因此而引入一个错误。

不要误会我的意思，没有什么比实际阅读代码来检查您的假设更好的了，但作为一个社区，能够谈论某些事情并通常让他们的行为以某种方式行事也很好。

考虑以下：

*   Rails 中没有规定必须`destroy`在控制器中实现动作，所以不要这样做。这是标准操作之一，但不是必需的。
*   使用该`update`操作设置和清除`archived`布尔属性（或类似名称）
*   我使用了`acts_as_paranoid`gem，如果您需要在模型中添加任何范围（除了 gem 提供的范围），您将发现自己不得不绕过它，关闭默认的“隐藏存档记录” " 范围，当你遇到它时，它几乎立即失去了它的价值。此外，该 gem 本身几乎什么都不做，而且它的功能可以很容易地自己编写（我的意思是只比安装 gem 本身做更多的工作），所以从这个角度来看使用它确实没有任何好处。
*   如前所述，重写方法或动作是一个坏主意，因为它打破了 Rails（和 ActiveRecord）关于调用对象`destroy`意味着什么的约定。`destroy`任何这样做的宝石（`acts_as_paranoid`例如）也打破了这个惯例，你最终会混淆自己或其他人，因为`destroy`根本不会意味着它应该意味着什么。这会给您的代码增加混乱，而不是清晰。不要这样做——你以后会付钱的。
*   如果您想使用软删除 gem，因为您要防止一些理论上的、未来的开发人员可能会占用您的数据……那么，最好的解决方案是不要雇用这些人或与这些人一起工作。没有经验的人需要指导，而不是防止他们犯错的宝石。
*   如果你真的，绝对，必须防止破坏给定模型的记录（除了能够简单地归档它），然后使用`before_destroy`回调并简单地返回 false，这将防止它被破坏，除非显式调用`delete`被使用（无论如何都与破坏不同）。此外，有了回调就可以（a）很明显为什么`destroy`不改变其含义就不能工作，并且（b）很容易编写测试以确保它不可破坏。这意味着将来，如果您不小心删除了该回调或执行其他使该模型可销毁的操作，则测试将失败，并提醒您注意这种情况。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-05T23:20:17.590

像这样的东西：

```
class Point < ActiveRecord::Base

  def archive        
    update_attribute!(:displayed, false)
  end 

end 
```

然后`@point.archive`在您通常调用的控制器的销毁操作中调用`@point.destroy`. 您还可以创建一个隐藏存档点，直到您明确查询它们，请参阅[应用默认范围的](http://guides.rubyonrails.org/active_record_querying.html#applying-a-default-scope)`default_scope`RoR 指南。

**编辑：根据下面的 normalocity 和 logan 的评论更新了我的答案。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T23:16:00.960

查看[acts_as_archive](https://github.com/winton/acts_as_archive "act_as_archive") gem。它将无缝地进行软删除。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-05T23:16:16.817

您的解决方案很好，但您可以使用[acts_as_paranoid gem](https://github.com/goncalossilva/rails3_acts_as_paranoid)来管理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-26T16:57:55.180

在这种情况下，与其添加一个新的布尔标志，不如添加一个`deleted_at:datetime`列

```
@point = Point.find(params[:id])
@point.touch(:deleted_at)
... 
```

然后稍后

```
Point.where(deleted_at: nil) # these are NOT hidden
Point.where.not(deleted_at: nil) # these are hidden 
```

# c# - 仅在 Azure Compute Emulator 中出现 EdmMetadata 错误

> ID：14718736
> 
> 赞同：1
> 
> 时间：2013-02-05T23:12:29.637
> 
> 标签：c#, entity-framework, azure

我无法让我的应用程序在 Azure Compute Emulator 中运行。我正在使用 Entity Framework 6.0-pre2，当我的应用程序运行时，我收到以下错误：

> 无效的对象名称 dbo.EdmMetadata

该数据库是使用 Code First 迁移创建的。使用相同的连接信息，如果它在常规控制台应用程序或 ASP.NET MVC 4 网站中运行，则一切正常。

相关的 app.config 部分：

```
<section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />

<connectionStrings>
    <add name="ApplicationServices" connectionString="Data Source=localhost;Initial Catalog=Database;Integrated Security=True" providerName="System.Data.SqlClient" />
</connectionStrings>

<entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory>
</entityFramework> 
```

我已经验证了 DbContext 正在使用正确的连接字符串

```
string connection = db.Database.Connection.ConnectionString; 
```

仅当我在模拟器中启动任务（以及当我部署到 Azure 时）才会发生这种情况是否有原因？

外部异常堆栈跟踪：

```
at System.Data.Entity.Core.EntityClient.Internal.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior)
at System.Data.Entity.Core.Objects.Internal.ObjectQueryExecutionPlan.Execute[TResultType](ObjectContext context, ObjectParameterCollection parameterValues)
at System.Data.Entity.Core.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption)
at System.Data.Entity.Core.Objects.ObjectQuery`1.<System.Collections.Generic.IEnumerable<T>.GetEnumerator>b__0()
at System.Lazy`1.CreateValue()
at System.Lazy`1.LazyInitValue()
at System.Data.Entity.Internal.LazyEnumerator`1.MoveNext()
at System.Linq.Enumerable.FirstOrDefault[TSource](IEnumerable`1 source) 
```

内部异常堆栈跟踪：

```
at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
at System.Data.SqlClient.SqlDataReader.get_MetaData()
at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite)
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite)
at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
at System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
at System.Data.Entity.Core.EntityClient.Internal.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-26T01:06:30.190

发生这种情况是因为 EF 正在检查您的数据库中是否存在 EdmMetadata 表以进行升级/向后兼容方案。但是，该异常由 EF 处理，因此除非您打开了“抛出异常时中断”选项，否则您不应该看到它。启用此选项后，任何异常都会中断执行 - 即使它已被处理并且永远不会到达您的代码。您可以按继续继续执行或禁用第一次机会异常中断。这是另一个具有更多详细信息的线程： [Invalid object name 'dbo.__MigrationHistory' using Database.Create; 传入连接字符串时的EF6.02](https://stackoverflow.com/questions/20877039/invalid-object-name-dbo-migrationhistory-using-database-create-ef6-02-when/20895515#20895515)

# java - 从被覆盖的方法中获取对象

> ID：14718743
> 
> 赞同：1
> 
> 时间：2013-02-05T23:13:06.050
> 
> 标签：java, events, methods, jtable, listselectionlistener

```
public class Job_GUI extends javax.swing.JFrame {

    private JobDTO jdto;

    public Job_GUI() {
        initComponents();
    }

      private void menuEditJobActionPerformed(java.awt.event.ActionEvent evt) {
            editJob.setVisible(true);
            //here I want to obtain the updated dto. 
        }

  } 

public class JobDTO extends BaseDTO {
//setters and getters

}

class ListDataUI { 

    private void initListeners() {
        summaryTable.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        summaryTable.getSelectionModel().addListSelectionListener(new ListSelectionListener() {

            @Override
            public void valueChanged(ListSelectionEvent e) {
                if (!e.getValueIsAdjusting()) {
                    final int selectedRowIndex = summaryTable.getSelectedRow();
                    if (selectedRowIndex != -1) {
                        BaseDTO dto = data.get(summaryTable.convertRowIndexToModel(selectedRowIndex));
                    } else {
                    }
                }
            }
        });

    }

} 
```

我不知道如何获取`BaseDTO`对象`dto`到`menuEditJobActionPerformed`方法，所以我可以显示对象的所有值。我如何从`valueChanged`事件发生时传递它？I'm simply using a table, when a row is selected, the dto state changes, need to pass this new state to the class Job_GUI actionperformed method

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:14:36.690

声明`dto`后立即`class GUI {`声明。

这样它将具有全局范围，因此您的所有功能都可以看到它。

```
类 GUI {
   BaseDTO dto;

  私人无效菜单EditJobActionPerformed（java.awt.event.ActionEvent evt）{
        editJob.setVisible(true);
        //现在你可以访问“dto”
    }

  }

类 ListDataUI {

    私人无效initListeners（）{
        summaryTable.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        summaryTable.getSelectionModel().addListSelectionListener(new ListSelectionListener() {

            @覆盖
            公共无效值更改（ListSelectionEvent e）{
                if (!e.getValueIsAdjusting()) {
                    final int selectedRowIndex = summaryTable.getSelectedRow();
                    if (selectedRowIndex != -1) {
                        /*BaseDTO */ dto = data.get(summaryTable.convertRowIndexToModel(selectedRowIndex));
                        //不声明一个新对象
                    } 别的 {
                    }
                }
            }
        });

    }

}

```

# c# - 如何将数据从gridview传输到文本框

> ID：14718744
> 
> 赞同：0
> 
> 时间：2013-02-05T23:13:06.440
> 
> 标签：c#, winforms

假设如果我说我在 gridview 中选择了一行，并希望该行出现在它们各自的文本框中。例如，我选择了一个具有名字和姓氏的行，并且在选择行时，来自 gridview 的数据应该进入 winform 上的文本框。请告诉我。

如果我是对的，我猜这是基于选择更改事件的事情？如下所示：

```
private void dgv_SelectionChanged(object sender, EventArgs e)
    {
        string str = txtFirstName.Text;
        DataGridViewRow selectedRow;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:23:09.007

如果我的问题正确，您的解决方案是`DataGridView.SelectedRows Property`与`DataGridView.SelectionChanged Event`

> DataGridView.SelectedRows 获取用户选择的行的集合。
> 
> DataGridView.SelectionChanged在选择单元格或取消选择，无论是以编程方式还是通过用户操作，都会发生。

```
private void dataGridView1_SelectionChanged(object sender, EventArgs e)
{
 if (dataGridView1.SelectedRows.Count > 0)
    {

    foreach (DataGridViewRow row in dataGridView1.SelectedRows) {
        //Send the first cell value into textbox'
        Txt_FirstName.Text = row.Cells(0).Value.ToString; // or row.Cells["ColumnName"].Value;
          }
    }
} 
```

[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.selectedrows.aspx)和[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.selectionchanged%28v=vs.100%29.aspx)

# c# - 用于将 CSS 边框属性拆分为其部分的正则表达式

> ID：14718745
> 
> 赞同：6
> 
> 时间：2013-02-05T23:13:19.570
> 
> 标签：c#, css, regex

我想将 CSS 中的边框属性拆分为其组成部分，即：

```
.someClass{
  border: 1px solid black;
} 
```

进入

```
border-width: 1px
border-style: solid;
border-color: black; 
```

在此之前我已经拆分了边框：和分号，所以我只需要解析属性的值部分

现在在 CSS 中，您可以使用上述 3 个属性的任意组合，因此

```
border: 1px solid;
border: solid Gold;
border: 1em;
border: 1mm #000000;
border: 1px inset rgb(12, 44, 199); 
```

一切都是合法的，所以我需要说明这一点。

到目前为止我所拥有的是

```
([0-9]+[a-zA-Z|%]+)* *([a-zA-Z]*) *( .*) 
```

这在正常情况下工作正常，但在“1px Solid”情况下失败，因为 Solid 被放入第三个捕获组，而不是第二个。我不是正则表达式专家，所以我可能会犯非常基本的错误，但任何帮助将不胜感激。我正在使用 C#（但主要是在[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)中进行测试，所以任何差异都可能是问题所在）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:25:01.507

简单地包括`border:`在表达式的开头似乎是一个主要的帮助，因为它不会意外地匹配第二或第三组。同样，添加`;`到表达式的末尾可以防止过早捕获第二组或第三组。除此之外，将第二组从更改`*`为`+`也有帮助，因为这允许它按预期匹配第二组而不是第三组。总而言之，试试这个：

```
border: ([0-9]+[a-zA-Z|%]+)* *([a-zA-Z]+)* *( .*)*; 
```

我怀疑这是否完美，如果您需要 100% 的结果，您可能不应该使用单个正则表达式，而是标记并解析字符串（我非常怀疑 CSS 规则完全用正则表达式解析），但如果这适用于您需要的有限规则非常好。

# php - 使用 RegEx 中的单词边界 (\b)，我需要在单词之前和之后，还是之前？

> ID：14718748
> 
> 赞同：2
> 
> 时间：2013-02-05T23:13:38.150
> 
> 标签：php, regex

如果我想匹配所有出现的单词`foo`，我会使用`\bfoo\b`还是不使用最后一个？似乎两者都有效，但什么是正确的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T23:18:14.023

您需要同时使用两者。如果没有最后一个`\b`，您将在字符串上获得匹配，例如：

```
"I love football"
"You foolishly left off your second word boundary" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T01:19:24.827

但是，请注意，单词边界`\b`的定义是基于以下定义的`\w`：单词边界是在非单词字符和单词字符之间定义的，其中单词字符由 定义`\w`。`\w`对于 ASCII 字符串等价于`[A-Za-z0-9_]`，因此`\bfoo\b`也**拒绝**以下情况：

```
foo123
3富
foo_bar
fun_foo

```

由于数字 和`_`被认为是单词字符，如果它们紧挨着`foo`，它不会形成单词边界，因此`\bfoo\b`不会匹配上述任何一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T00:04:14.187

给定以下输入：

```
foo foobar 
```

此正则表达式将仅匹配第一个`foo`：

```
\bfoo\b 
```

此正则表达式将匹配第一个和`foo`in `foobar`：

```
\bfoo 
```

# c++ - 为什么我自己的输出流类不起作用？

> ID：14718751
> 
> 赞同：1
> 
> 时间：2013-02-05T23:13:52.203
> 
> 标签：c++, class, stream, iostream, template-function

> **可能重复：**
> [重载 operator<< 时 std::endl 的类型未知](https://stackoverflow.com/questions/1134388/stdendl-is-of-unknown-type-when-overloading-operator)

```
#include <iostream>

using namespace std;

struct OutputStream
{
    template<class T>
    OutputStream& operator <<(const T& obj)
    {
        cout << obj;

        return *this;
    }
};

OutputStream os;

int main()
{    
    os << 3.14159 << endl; // Compilation Failure!
} 
```

VC++ 2012 编译器抱怨：

> 错误 C2676：二进制“<<”：“OutputStream”未定义此运算符或转换为预定义运算符可接受的类型

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:23:18.893

原因是编译器无法推断出 的类型`T`，因为[`std::endl`](http://www.cplusplus.com/reference/ios/endl/)函数模板定义为

```
template <class charT, class traits>
  basic_ostream<charT,traits>& endl ( basic_ostream<charT,traits>& os ); 
```

在 IOStreams 中克服它的方法是提供适当的重载`operator<<`：

```
OutputStream& operator <<(std::ostream& ( *pf )(std::ostream&))
{
  cout << pf;
  return *this;
} 
```

# asp.net - 仅生成 & 符号的数据绑定块

> ID：14718752
> 
> 赞同：0
> 
> 时间：2013-02-05T23:14:01.383
> 
> 标签：asp.net

我正在尝试在数据绑定块中生成许多字符（在本例中为星号）。它在客户端生成的只是＆符号（虽然是正确的数字）。

```
<span class="review-stars">
    <%# New String("&#9733;", Eval("CustomerReviewScore"))%>
</span> 
```

我不确定我需要做什么才能让角色真正出现在客户端上。

编辑：

HTML是：

```
<span class="review-stars">&amp;&amp;&amp;&amp;&amp;</span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:23:43.917

您可以改用[`Literal`](http://www.techrepublic.com/blog/programming-and-development/use-aspnets-literal-control-to-its-full-potential/618)控件并将其[`Mode`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.literal.mode.aspx)属性设置为`PassThrough`：

```
<asp:Literal ID="Literal1"
    Mode="PassThrough"
    Text= '<%# New String("&#9733;", Eval("CustomerReviewScore"))%>'       
    runat="server">
</asp:Literal> 
```

# doctrine-orm - 动态关系和 SonataAdminBundle

> ID：14718757
> 
> 赞同：7
> 
> 时间：2013-02-05T23:14:27.600
> 
> 标签：doctrine-orm, symfony-2.1, symfony-sonata, sonata-admin

我有生以来第一次使用 SonataAdminBundle，但遇到了一些问题。

起初，我有一个 PageBundle，它有一个`Page`和一个`Author`实体。然后我开始使用 SonataAdminBundle 并使用s`sonata_type_model`来很好地显示`Author`a 的 s `Page`：

```
// ...

protected function configureFormFields(FormMapper $mapper)
{
    $mapper
        ->add('title')
        ->add('slug', null, array('required' => false))
        ->add('published', null, array(
            'label'    => 'publish',
            'required' => false,
        ))
        ->add('author', 'sonata_type_model')
        ->add('content')
    ;
} 
```

但后来我发现了 SonataUserBundle。我开始使用它，当我终于让它工作时，我认为使用这个`User` 实体而不是`Author`PageBundle 中的实体会很好。为了使这成为可能，我使用了文档在 [“如何定义与抽象类和接口的关系”](http://symfony.com/doc/master/cookbook/doctrine/resolve_target_entity.html)中讨论的技术。

这有效，但不适用于 SonataAdminBundle。似乎 the `sonata_type_model`不能与 the 一起使用`ResolveTargetEntityListener`，我无法使其正常工作。

`Page`PageBundle中的相关实体代码：

```
namespace Wj\PageBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
* @ORM\Table
* @ORM\Entity
* @ORM\HasLifeCycleCallbacks
*/
class Page
{
    /**
    * @var integer $authorId
    *
    * @ORM\ManyToOne(targetEntity="Wj\PageBundle\Model\AuthorInterface")
    */
    private $author;
} 
```

`Wj\PageBundle\Model\AuthorInterface`：_

```
namespace Wj\PageBundle\Model;

interface AuthorInterface
{
    public function getId();
} 
```

`User`以及UserBundle 中的实体：

```
namespace Wj\UserBundle\Entity;

use Sonata\UserBundle\Entity\BaseUser;
use Wj\PageBundle\Model\AuthorInterface;
use Doctrine\ORM\Mapping as ORM;

/**
* @ORM\Entity
* @ORM\Table(name="fos_user")
*/
class User extends BaseUser implements AuthorInterface
{
    /**
    * @ORM\Id
    * @ORM\Column(type="integer")
    * @ORM\GeneratedValue(strategy="AUTO")
    */
    protected $id;

    public function __toString()
    {
        return $this->getFirstName().' '.$this->getLastName();
    }
} 
```

`FormMapper`配置和我上面贴的一样。

**如何将 ResolveTargetEntityListener 技术与 SonataAdminBundle 和他的 结合使用`sonata_type_model`？**

# asp.net - twiiter bootstrap 动态对齐缩略图

> ID：14718759
> 
> 赞同：1
> 
> 时间：2013-02-05T23:14:32.610
> 
> 标签：asp.net, twitter-bootstrap

我想让缩略图动态对齐，但我该怎么做呢？

我有以下代码：

HTML

```
 <div class="row-fluid">
        <ul class="thumbnails">

         <uc1:loadUsers runat="server" ID="loadUsers" />

        </ul>
      </div> 
```

ASP.NET

这是一个用户控件

_str 是一个字符串，它将被添加到将其转换为 HTML 的文字控件中

```
 _str =  "<li class='span3'>"
                        + "<div class='thumbnail'>"
                        + "<div class='caption'>"

                        + "<h3>" + _name + "</h3>"
                        + "<ul>"
                        + "<li><h5>" + _other + "</h5></li>"
                        + "<li><h5>" + _other + "</h5></li>"
                        + "<li><h5><img src='" + _imagePath + "'" + _size + " /> " + _other + "</h5></li>"
                        + "<br><li>"
                        + "<div class='btn-group'><button class='btn btn-info'>Options</button><button class='btn btn-info dropdown-toggle' data-toggle='dropdown'><span class='caret'></span></button><ul class='dropdown-menu'>"
                        + "<li><a href='users.aspx?delete=" + _id + "'><i class='icon-fire'></i> Delete</a></li>"
                        + "<li><a href='users.aspx?edit=" + _id + "'><i class='icon-edit'></i> Edit</a></li>"
                        + "</ul></div>"
                        + "</li>"
                        + "</ul>"

                        + "</div>"
                        + "</div>"
                        + "</li>"; 
```

我知道 class='row-fluid' 负责对齐，我该如何动态使用它？

![如您所见，缩略图未对齐，我希望它们保持完全对齐](../Images/9da4a1743d9041646ddc7d6559265794.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:00:06.623

问题是我正在插入`<li>`，但在 HTML 中我没有`<ul>`，这就是动态取消公式化的原因。所以我`<div></div>`在动态控件的开头和结尾插入了。

我很容易解决了这个问题：

```
_str =  "<div><li class='span3'>"
                    + "<div class='thumbnail'>"
                    + "<div class='caption'>"

                    + "<h3>" + _name + "</h3>"
                    + "<ul>"
                    + "<li><h5>" + _other + "</h5></li>"
                    + "<li><h5>" + _other + "</h5></li>"
                    + "<li><h5><img src='" + _imagePath + "'" + _size + " /> " + _other + "</h5></li>"
                    + "<br><li>"
                    + "<div class='btn-group'><button class='btn btn-info'>Options</button><button class='btn btn-info dropdown-toggle' data-toggle='dropdown'><span class='caret'></span></button><ul class='dropdown-menu'>"
                    + "<li><a href='users.aspx?delete=" + _id + "'><i class='icon-fire'></i> Delete</a></li>"
                    + "<li><a href='users.aspx?edit=" + _id + "'><i class='icon-edit'></i> Edit</a></li>"
                    + "</ul></div>"
                    + "</li>"
                    + "</ul>"

                    + "</div>"
                    + "</div>"
                    + "</li></div>"; 
```

# jqgrid - Jqgrid寻呼机文本垂直对齐

> ID：14718761
> 
> 赞同：1
> 
> 时间：2013-02-05T23:14:42.337
> 
> 标签：jqgrid

我在我的 ASP.NET MVC 4 应用程序中使用 Jqgrid，由于某些原因，寻呼机文本（X 页的 X）似乎与底部对齐，尽管我尝试更改 CSS（ui.grid.css）对齐中间/顶部。这只发生在 IE9 上。它在 Firefox 中正确显示。有没有人有类似的问题？

我想发布图片，但本网站的垃圾邮件预防机制不允许。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:09:45.960

终于弄清楚是什么导致了问题。它是 IE 中的文档模式。它被设置为“IE7标准”。将其设置为“IE8 或 IE9 标准”解决了该问题。

# node.js - 使用“npm 爬虫”进行爬网

> ID：14718762
> 
> 赞同：0
> 
> 时间：2013-02-05T23:14:57.463
> 
> 标签：node.js, web-crawler

例如，我从[npmjs.org](http://www.npmjs.org)爬取 Node.js 模块的描述。
但这段代码不起作用。以及它是如何使用 jQuery 实现的，而不是使用[jsdom](https://npmjs.org/package/jsdom)模块。

```
var Crawler = require("crawler").Crawler;
var crawler = new Crawler({
   "maxConnections":10,
});

crawler.queue([{
"uri":"https://npmjs.org/package/crawler",

"callback":function(error,result) {
    console.log("description:", window.$("p.description").text());
    }
}]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:40:52.617

您的代码存在得太早了。在最后一行添加一个 setTimeout，为您的代码提供足够的时间来完成。

然后从您的回调函数中调用 process.exit() 。

爬虫回调需要 3 个参数，第三个是 jQuery，所以你可能会使用类似这样的东西：

```
"callback":function(error,result,$) {
  console.log("description:",$("p.description").text());
} 
```

# asp.net-mvc-3 - ASP MVC3 条件意外失败

> ID：14718763
> 
> 赞同：0
> 
> 时间：2013-02-05T23:15:04.453
> 
> 标签：asp.net-mvc-3

我在我的 ASP MVC3 网页顶部设置了这个条件。然而，无论出于何种原因，程序每次都进入`else`语句并将页面结果标记为完整。我们现在正在测试，因此模型从中提取的表中只有两条记录，并且都`I`在`RecordStatus`字段中。

我已经测试过`Model`返回的对象是否为空，而事实并非如此。我还测试了里面的值`Model.RecordStatus`，发现它会输出一个`I`.

如果有人能看到我遗漏的东西，将*不胜*感激。谢谢

编辑

RecordStatus 将始终等于`I`for`Incomplete`或`C`for `Complete`。它们将始终为大写。

```
@model Monet.Models.AgentTransmission

@{
    ViewBag.Title = "Edit";
}
<div>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    <h2>Edit Agent - Record Status:    
    @if (Model.RecordStatus.Equals("I") || String.IsNullOrWhiteSpace(Model.RecordStatus))
    {
        <span style="color:Red;">Not Saved</span>
    }
    else
    {
        <span style="color:Black;">Complete</span>
    }    
    </h2> 
```

截屏：

![在此处输入图像描述](../Images/a13f15d7b466560ec11e2d9ef4ca1760.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:35:37.960

根据评论中的建议，这是通过消除任何潜在的空白来解决的。下面是语法：

```
Model.RecordStatus.Trim().Equals("I") 
```

# ruby-on-rails - 调用之前的 Rails 辅助方法执行

> ID：14718766
> 
> 赞同：0
> 
> 时间：2013-02-05T23:15:13.927
> 
> 标签：ruby-on-rails, variables, helpermethods

我拥有的`@test`变量在我想要它之前得到了评估。这就是我的意图：我有一个按钮（现在是链接），旁边显示了一个变量。最初加载页面时，该值应显示为“空白”。当我单击该按钮时，页面应该刷新并且变量应该更改为其他内容，因为该按钮调用了一个辅助方法。

这是我在 home.html.erb 中的内容：

```
<%= link_to 'Do stuff', my_helper_method(), :method => :get %>
<%= @test %> 
```

这是我在 my_proj_helper.rb （辅助方法）中的内容：

```
module MyProjHelper
    def my_helper_method()
       @test = "changed"
    end
end 
```

在 my_proj_controller.rb （控制器）中，我有这个：

```
class My_Proj_Controller < ApplicationController
    def home
        @test = "blank"
    end
end 
```

我一定没有正确地做事。需要改变什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:25:12.110

你不能使用这样的辅助方法。以下是您可以执行的操作：

在 routes.rb 中创建路由

```
 get '/some_path/:test_variable' => 'my_proj_controller#test_action', as: :test_action 
```

然后在您的控制器中创建相应的操作

```
 def test_action
     @test = params[:test_variable]
     render 'home'
   end 
```

然后换个链接

```
 <%= link_to 'Link', test_action_path('change') %> 
```

当用户单击链接时，它会从您的页面发送一个 GET 请求，`My_Proj_Controller`其中包含一个`test_variable`参数。您的控制器接收请求，然后设置`@test`变量并呈现`home.html.erb`页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:22:56.030

我认为您在单击时尝试使用辅助方法。这不是辅助方法的用途——它们只是在视图或控制器中做一些你需要的事情——比如渲染 html。例如，'link_to' 方法是一个助手。如果您希望 @test 变量根据需要更改 - 只需有条件地在控制器中设置值。

link_to 方法的第二个参数应该是您要导航到的 url。如果它是一个方法，它应该返回一个字符串。在这种情况下，您调用一个返回字符串的方法。如果您查看该标记的 a href=""，您会看到“已更改”作为 href 属性。

# html - 使用 CSS 重叠 divtags

> ID：14718769
> 
> 赞同：0
> 
> 时间：2013-02-05T23:15:31.143
> 
> 标签：html, css, animation

试图弄清楚如何利用 CSS 动画和重叠元素。

[演示站点](http://mods.minepress.co.uk/)

本质上，我 div 叫 Steven，让他一半坐在 div 地面上，一半坐在名为 moon 的 div 上（有动画）

页：

```
 <style>

        body {
            background-repeat: no-repeat;
            background: -moz-linear-gradient(top, #1e5799 0%, #2989d8 50%, #207cca 51%, #7db9e8 100%); /* FF3.6+ */
            background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#1e5799), color-stop(50%,#2989d8), color-stop(51%,#207cca), color-stop(100%,#7db9e8)); /* Chrome,Safari4+ */
            background: -webkit-linear-gradient(top, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* Chrome10+,Safari5.1+ */
            background: -o-linear-gradient(top, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* Opera 11.10+ */
            background: -ms-linear-gradient(top, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* IE10+ */
            background: linear-gradient(to bottom, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* W3C */
            filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#1e5799', endColorstr='#7db9e8',GradientType=0 ); /* IE6-9 */
            height: 100%;
            margin: 0;
            background-repeat: no-repeat;
            background-attachment: fixed;
            -webkit-animation: sky-to-black 5s ease forwards;
            -moz-animation:    sky-to-black 5s ease forwards;
            -ms-animation:     sky-to-black 5s ease forwards;
        }
        .ground {
            position: relative;
            top: 50%;
            left: 0;
            width: 100%;
            height: 50%;
            background: black;
            -webkit-animation: ground-to-black 5s ease forwards;
            -moz-animation:    ground-to-black 5s ease forwards;
            -ms-animation:     ground-to-black 5s ease forwards;
        }
        .moon {
            width: 100px;
            height: 100px;
            position: absolute;
            background: white;
            border-radius: 0px;
            box-shadow: 0 0 20px white;
            left: 50%;
            top: 80%;
            margin: 0 -50px;
            -webkit-animation: rising-sun 5s ease forwards;
            -moz-animation:    rising-sun 5s ease forwards;
            -ms-animation:     rising-sun 5s ease forwards;
        }

        .ground, .moon {
            text-indent: -9999px;
            overflow: hidden;
        }

        @-moz-keyframes rising-sun {
            0%   { 
                top: 80%; 
                box-shadow: 0 0 20px 100px white;
            }
            100% {
                top: 15%;
                box-shadow: 0 0 150px 20px white;
            }
        }
        @-webkit-keyframes rising-sun {
            0%   { 
                top: 80%; 
                box-shadow: 0 0 20px 100px white;
            }
            100% {
                top: 15%;
                box-shadow: 0 0 150px 20px white;
            }
        }
        @-ms-keyframes rising-sun {
            0%   { 
                top: 80%; 
                box-shadow: 0 0 20px 100px white;
            }
            100% {
                top: 15%;
                box-shadow: 0 0 150px 20px white;
            }
        }

        @-moz-keyframes sky-to-black {
            0%   { 
                background-color: #133d48;
            }
            100% {
                background-color: black;
            }
        }
        @-moz-keyframes ground-to-black {
            0%   { 
                background-color: #211d11
            }
            100% {
                background-color: black;
            }
        }
        @-webkit-keyframes sky-to-black {
            0%   { 
                background-color: #133d48;
            }
            100% {
                background-color: black;
            }
        }
        @-webkit-keyframes ground-to-black {
            0%   { 
                background-color: #211d11
            }
            100% {
                background-color: black;
            }
        }
        @-ms-keyframes sky-to-black {
            0%   { 
                background-color: #133d48;
            }
            100% {
                background-color: black;
            }
        }
        @-ms-keyframes ground-to-black {
            0%   { 
                background-color: #211d11
            }
            100% {
                background-color: black;
            }
        }

    #Central {
    width: 100%;

    }

    #Steve {

        width: 500px;
        height:500px;
        background: #fff;
        margin-top: 250px;
        position:relative;

    }
    </style>

<div id="container">    
<div class="moon">
</div>
<div id="Central" style="color: #fff; width:100%; Text-align: Center;"><h1>Welcome to my Minecraft Mods!</h1></div>
<div id="Steve"></div>
<div class="ground">
</div>
</div> 
```

问题：

为什么我不能将带有白框的 div 标签放在中间的所有内容之上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:02:13.563

我去掉了左边的值和边距，它变得更近了。不太确定。对于那种特定的位置，我不会使用基于百分比的值。获取高度并计算您是否最常通过 jquery 进行计算，但实际上，仅使用 css 来定位像素会更容易。

# email - 无需运行自己的 SMTP 服务器即可接收和处理电子邮件

> ID：14718774
> 
> 赞同：1
> 
> 时间：2013-02-05T23:16:10.470
> 
> 标签：email, smtp, google-apps-script, mta

试图把这个放在一起：

[通过电子邮件触发 Google Apps 脚本](https://stackoverflow.com/questions/10420435/trigger-google-apps-script-by-email)

有了这个：

[使用 Google App Engine 自定义接收邮件域](https://stackoverflow.com/questions/1698802/custom-incoming-mail-domain-with-google-app-engine)

这样最终我们就可以将电子邮件处理到可扩展的收件箱@ourgoogleappsdomain.com。谷歌应用程序帐户每天限制为 10,000 个，这对我们不起作用。似乎提供了这个功能的服务，只是没有达到我们需要的规模，包括：

1.  [http://mailnuggets.com](http://mailnuggets.com)
2.  [http://www.mailhooks.com](http://www.mailhooks.com)
3.  [http://www.email2http.net](http://www.email2http.net)

所以是的——试着看看我们能做些什么来避免在这里滚动我们自己的邮件服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T04:32:07.677

您需要将 Google Apps 配置为将传入该地址的邮件路由到单独的 SMTP 服务器（[拆分递送](http://support.google.com/a/bin/answer.py?hl=en&answer=2685650)）。

然后，您可以使用任何第三方 SMTP 服务器来接收您的消息并运行您的代码（通常通过发送 HTTP POST 请求）

以下服务可用于接收大量邮件：

*   [http://www.mailgun.com/pricing](http://www.mailgun.com/pricing)
*   [https://postmarkapp.com/pricing](https://postmarkapp.com/pricing)
*   [http://www.cloudmailin.com/plans](http://www.cloudmailin.com/plans)
*   [http://sendgrid.com/docs/API_Reference/Webhooks/parse.html](http://sendgrid.com/docs/API_Reference/Webhooks/parse.html)

# php - 无法让自定义图像大小在 Wordpress 中工作

> ID：14718776
> 
> 赞同：-1
> 
> 时间：2013-02-05T23:16:19.740
> 
> 标签：php, wordpress, wordpress-theming

我有点不知所措。我要做的就是添加自定义图像大小，以使 Wordpress 能够为我的特色帖子轮播生成适当大小的图像。我想要的尺寸是 650x300。所以我把它添加到我的主题的functions.php文件中：

```
add_theme_support( 'post-thumbnails' );
add_image_size( 'feature-slider-image', 650, 300, true);
function bavg_image_sizes_choose( $sizes ) {  
    $custom_sizes = array(  
        'feature-slider-image' => 'Featured Post Slider Panel'  
    );
    return array_merge( $sizes, $custom_sizes );  
}

add_filter( 'image_size_names_choose', 'bavg_image_sizes_choose' ); 
```

但它不起作用。完全没有。甚至没有创建缩略图，更不用说在插入媒体时可供选择了。关于我在这里搞砸的任何想法？似乎第一部分 - 为主题添加缩略图支持 - 甚至根本不起作用。我觉得如果我能解决这个问题，其余的都会好起来的。

更令人费解的是，我认为可能只是发生了一些缓存错误，所以我安装了 AJAX Thumbnail Rebuilder 插件，该插件应该遍历您的每个图像并重建缩略图（在某些情况下您可能会在某些图像之后更改缩略图大小过去已经发布过）。自定义缩略图大小在我运行时显示在列表中，但实际上没有创建缩略图（甚至是标准缩略图）。

**编辑：更多信息**- 我什至尝试在全新的 Wordpress 安装上使用该主题，但它仍然无法正常工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:15:23.683

好消息，我发现了问题——我没有为 PHP 启用 GD 库。我多么愚蠢！

# php - 无法在 Linux Mint 上访问本地 LAMP 服务器上的索引

> ID：14718777
> 
> 赞同：1
> 
> 时间：2013-02-05T23:16:25.623
> 
> 标签：php, zend-framework, apache2

我开始使用 Zend FrameWork，但我遇到了麻烦。我尝试在 10 分钟内遵循[从零到 Zend 框架](http://www.jeremykendall.net/2010/04/17/from-zero-to-zend-framework-project-in-10-minutes/)的超级指南，但它一无所获。

我也收到了那条令人讨厌的信息

`apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1 for ServerName ... waiting apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1 for ServerName`两次。

虽然我设法解决[了](http://xubuntugeek.blogspot.com/2012/07/solved-apache2-could-not-reliably.html)这个问题，但这就是我的本地服务器的样子。![在此处输入图像描述](../Images/cb9412a3cbded5c05d7699605a506359.png).

这就是我的`/etc/hosts`样子。

```
127.0.0.1   localhost
127.0.0.1   prueba.local
127.0.1.1   dradis

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters 
```

而且，根据[1](http://www.jeremykendall.net/2010/04/17/from-zero-to-zend-framework-project-in-10-minutes/)，我的虚拟主机配置应该如何。这是在`/sites-avaliable`但符号链接到`/sites-enabled`.

`prueba.local`：

```
<VirtualHost *:80>
    ServerName prueba.local
    DocumentRoot /home/seba/solartekka/test/prueba/public
</VirtualHost> 
```

`/home/seba/solartekka/test/prueba`是我有我的项目的地方。

我已经完成了两天的战斗，我的精神被粉碎了。有谁知道可能发生的事情？

我试图提供尽可能多的相关信息，但如果您需要更多信息，我会很乐意提供。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:38:55.857

您应该查看 apache 日志消息文件，它们会给您提示：

```
tail /var/log/apache2/error.log 
```

常见的问题是缺少 Zend 库。

尝试将此代码添加到您的虚拟主机文件中：

```
<Directory "/home/seba/solartekka/test/prueba/public/">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride all 
        Order allow,deny
        Allow From all
</Directory> 
```

不要忘记重新启动 apache。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T03:25:05.403

有时，我遇到了权限问题。作为测试，尝试设置`chmod 0777 public/index.php`.

此外，您可以尝试直接浏览到`http://prueba.local/index.php`.

# sql - 如何在sql中获取最少的行

> ID：14718780
> 
> 赞同：0
> 
> 时间：2013-02-05T23:16:27.523
> 
> 标签：sql, sql-server

嗨，我想从 Sql Server 表中检索具有最小值但不应更改行中数据顺序的行，即不应将 Id 旁边的数据排序错误我正在尝试获取结果，但我不是对我得到的结果感到满意。我知道我可以使用 where 子句来阻止数据放错顺序，但是因为我想将它与 java 向量相关联，所以我不能使用该选项。这是我目前正在编码的内容 rm_id 是我的 ID，但我到处都是最小值，即 0

```
SELECT   b.rm_id AS 'REMITTANCE ID',
     min(b.[1]) AS 'Re. 1',
     min(b.[2]) AS 'Rs. 2',
     min(b.[5]) AS 'Rs. 5',
     min(b.[10]) AS 'Rs. 10',
     min(b.[20]) AS 'Rs. 20',
     min(b.[50]) AS 'Rs. 50',
     min(b.[100]) AS 'Rs. 100',
     min(b.[500]) AS 'Rs. 500',
     min(b.[1000]) AS 'Rs. 1000',
     min(b.[tp]) AS 'T.P',
     min(b.[tv]) AS 'T.V'
FROM     trans_det AS b
GROUP BY b.rm_id WITH ROLLUP
ORDER BY rm_id DESC; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:36:20.957

我怀疑你可能想要这个：

```
select top 1 td.* from trans_det order by b.[1] union all
select top 1 td.* from trans_det order by b.[2] union all
select top 1 td.* from trans_det order by b.[5] union all
. . .
select top 1 td.* from trans_det order by b.tv 
```

这将返回每个值具有最小值的行集。

# python - 使用 scipy.interpolate.LSQBivariateSplines 将 2-D 样条拟合到有间隙的噪声数据

> ID：14718783
> 
> 赞同：4
> 
> 时间：2013-02-05T23:16:55.160
> 
> 标签：python, scipy, interpolation, spline, data-fitting

我在网格上有一个带有矩形数据的 numpy 数组，并希望在其上拟合 2-D 样条以重现大规模变化，同时消除所有/大部分噪声。数据也有一些区域用 NaN 值标记为无效。

我尝试使用 scipy.interpolate.RectBivariateSpline 函数，但差距搞砸了结果。所以我尝试使用同一个包中的 LSQBivariateSpline 函数，希望当我将所有 NaN 像素的权重设置为 0 时，它会简单地忽略它们。但是，那时我遇到了以下我不知道如何避免的错误：

我的代码是：

```
# some preparation, loading data and stuff
# all my data is stored in 'data'

# Create the knots (10 knots in each direction, making 100 total
xcoord = numpy.linspace(5, data.shape[0]-5, 10)
ycoord = numpy.linspace(5, data.shape[1]-5, 10)

# Create all weights, and set them to 0 when the data is NaN
weights = numpy.ones(data.shape)
weights[numpy.isnan(data)] = 1e-15  # weights must be >0

# LSQBivariateSpline needs x and y coordinates as 1-D arrays
x, y = numpy.indices(data.shape)
spline_fit = scipy.interpolate.LSQBivariateSpline(x.ravel(), y.ravel(), data.ravel(), 
                                               xcoord, ycoord, 
                                               w=weights.ravel(),
                                               bbox=[None, None, None, None], 
                                               kx=2, ky=2) 
```

代码的输出是以下错误消息：

```
The coefficients of the spline returned have been computed as the
minimal norm least-squares solution of a (numerically) rank deficient
system (deficiency=25). If deficiency is large, the results may be
inaccurate. Deficiency may strongly depend on the value of eps.
done!
Traceback (most recent call last):
  File "./fitpg.py", line 513, in <module>
    fit_pupilghost(prebinned, (center_y, center_x), (r_inner, r_outer), dr)
  File "./fitpg.py", line 298, in fit_pupilghost
    fitout = pupil2d(radius[:,y], angle[:,y])
  File "/usr/local/lib64/python2.7/site-packages/scipy/interpolate/fitpack2.py", line 545, in __call__
    raise ValueError("Error code returned by bispev: %s" % ier)
ValueError: Error code returned by bispev: 10 
```

我输入的输入矩阵（“数据”）大约为 1000 x 1000 像素，这足以将样条线约束在 100 节。将每个方向上的节数增加到 100 个，代码运行速度会变慢，但除了不足数之外，没有任何变化。我还尝试使用 1-e30 到 0.9 之间的值增加和减少 eps 值（默认为 1e-16

我也尝试用谷歌搜索错误代码，但找不到好的结果，所以这也无济于事。

知道这里可能有什么问题吗？还是有解决此问题的解决方法/更好的方法？

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T10:22:50.803

样条拟合代码不以任何特殊方式处理 NaN。由于任何与 NaN 接触的数字也会变成 NaN，这意味着它们的存在会毒化整个计算，因此您不会得到任何结果。

您可以做的是用一些（任意）有限值替换 NaN 值，例如，除了设置零权重

```
weights = numpy.ones(data.shape)
mask = numpy.isnan(data)
weights[mask] = 0
data[mask] = 0   # arbitrary 
```

由于重量很小，因此选择的值无关紧要。`1e-15`如果由于某种原因不喜欢零权重，您也可以尝试将相应的权重设置为较小的值，例如 your 。

# java - 在 Android 中使用 httpUrlConnection 发送授权标头

> ID：14718785
> 
> 赞同：3
> 
> 时间：2013-02-05T23:17:01.230
> 
> 标签：java, android

我正在尝试在使用 HttpUrlConnection 时设置“授权”标头，但我在服务器上将其视为“HTTP_AUTHORIZATION”。

这是我的代码：

```
public static String doGet(String params, String accessToken)
            throws MHNetworkException {
        try {
            URL url = new URL(getServerUrl());

            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestProperty("Content-Type", "application/json");
            conn.setRequestProperty("Authorization", "Token token="
                    + accessToken);
            conn.setRequestMethod("GET");

            int httpStatus = conn.getResponseCode();
            Log.v(tag, "httpStatus " + httpStatus);

            if (httpStatus == 200) {
                return MHIOUtil.getInputStreamAsString(conn.getInputStream());
            } 
        } catch (MalformedURLException me) {

        } catch (IOException ioe) {

        }
    } 
```

顺便说一句，“Content-Type”标头也被更改为 CONTENT_TYPE。

为什么 Android 发送更改它，有什么方法可以让我完全按照我想要的方式发送它。还是我在这里做错了什么？如果这很重要，我们会在后端使用 nginx 和 Rails。

请不要推荐使用 HttpClient。我只想使用 HttpURLConnection，如果我可以让它工作，因为谷歌的 Android 开发人员说他们将把所有的努力都放在 HttpURLConnection 上。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:16:44.733

没有任何错误。大多数标头都可以在以 HTTP_ 为前缀的服务器上访问，但 Content-Type 会被特殊处理。Android 没有改变它，映射发生在服务器上。到大写的映射是标准的（标题的大小写不重要），将“-”替换为“_”也是如此。

请参阅[CGI 规范](http://www.ietf.org/rfc/rfc3875)。

# .htaccess - htaccess - 将目录重写为文件以更干净

> ID：14718789
> 
> 赞同：0
> 
> 时间：2013-02-05T23:17:20.680
> 
> 标签：.htaccess

目前，mysite.com/profile 被重写为 mysite.com/profile.php。我还想以干净的格式传递参数，例如 mysite.com/profile/43/settings 到 mysite.com/profile.php?1=43&2=settings 和 mysite.com/thread/223/reply 将被写入 mysite .com/thread.php?1=223&2=回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:25:12.713

通常，为了启用这样的干净参数，您实际上不会使用不同的重写规则。您将使用完全相同的前端控制器重写规则将所有内容定向到`profile.php`. 然后在脚本中，您可以将 URI 分解为特定的组件（例如，提供与特定资源不匹配的 URI 的适当标头）。

原因是重写规则不能很好地处理任意数量的参数。例如，如果您知道您将始终有两个参数，那么使用重写规则就很容易了，因为它很容易执行以下操作：

```
RewriteRule /?profile/(.*)/(.*) /profile.php?param1=$1&param2=$2 
```

但是，当您不知道要获得多少参数时，构建重写规则来处理这种情况会变得更加复杂。

最好建议您使用 PHP 路由器类（谷歌它，您应该找到很多选项或指导）来检查 URI 并采取适当的措施。

# c# - C# - 移位和反转字节数组中的位顺序

> ID：14718797
> 
> 赞同：0
> 
> 时间：2013-02-05T23:18:17.117
> 
> 标签：c#, binary, byte, bits, bitarray

我正在尝试从字节数组中获取正确的 int 。通过 .Net 的 POS 从 RFIDTag 读取字节。（实际上我需要 18 位）

二进制字节数组如下： 00001110 11011100 00000000 00011011 10000000

我需要摆脱的是：00 00000000 11101101 (int = 237)

从原始字节开始，将是以下位的倒序： ------10 11011100 00000000

我一直在看bitArray。数组.反向。以及几种移位位的方法。但我就是无法理解这个。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T23:48:26.333

您可以像这样获取这些位并将它们反转：

```
byte[] data = { 0x0E, 0xDC, 0x00, 0x1B, 0x80 };

// get only first four bytes
byte[] bits = new byte[4];
Array.Copy(data, 0, bits, 0, 4);

// reverse array if system uses little endian
if (BitConverter.IsLittleEndian) {
  Array.Reverse(bits);
}

// get a 32 bit integer from the four bytes
int n = BitConverter.ToInt32(bits, 0); // 0x0EDC001B

// isolate the 18 bits by shifting and anding
n >>= 8; // 0x000EDC00
n &= 0x0003FFFF; // 0x0002DC00

// reverse by shifting bits out to the right and in from the left
int result = 0;
for (int i = 0; i < 18; i++) {
  result = (result << 1) + (n & 1);
  n >>= 1;
}

Console.WriteLine(result); 
```

输出：

```
237 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:36:34.467

也许

```
// 00001110 11011100 00000000 00011011 10000000
//    0E       DC       00       1B       80   
byte[] info = new byte[] { 0x0E, 0xDC, 0x00, 0x1B, 0x80 };
int result = (info[0] << 4) | (info[1] >> 4);
Console.WriteLine(result); // ==> 237 
```

`info[0] << 4`变成. `0E`_`E0`

`>> 4`变成. `DC`_`0D`

`|`ORs `E0`，其中是`0D`十进制`ED``237`

# forms - Zend Framework 2：在视图中使用纯 html 创建 Web 表单

> ID：14718798
> 
> 赞同：0
> 
> 时间：2013-02-05T23:18:17.610
> 
> 标签：forms, model-view-controller, frameworks, zend-framework2

目前，我使用这个：

```
<?php echo $this->form()->openTag($form); ?>
        <?php echo $this->formHidden($form->get('page_id')); ?>
        <fieldset>
            <?php echo $this->formRow($form->get('title')); ?>
        </fieldset>
        <fieldset>
            <?php echo $this->formRow($form->get('content')); ?>
        </fieldset>
        <fieldset>
            <?php echo $this->formRow($form->get('url_slug')); ?>
        </fieldset>
        <fieldset>
            <?php echo $this->formSubmit($form->get('submit')); ?>
        </fieldset>
        <?php echo $this->form()->closeTag(); ?> 
```

在视图脚本中显示我的表单，但我想添加一些额外的样式、html 属性等，所以最好用纯 html 编写表单。到目前为止一切顺利，但是否可以在不使用上述方法的情况下在 html 视图中显示表单错误？在 ZF1 中，我使用了：

```
 <ul>
    <?php foreach ($this->form->class->getMessages() as $key => $value): ?>
        <li><?php echo $value; ?></li>
    <?php endforeach; ?>

    <?php foreach ($this->form->letter->getMessages() as $key => $value): ?>
        <li><?php echo $value; ?></li>
    <?php endforeach; ?>

    <?php foreach ($this->form->type->getMessages() as $key => $value): ?>
        <li><?php echo $value; ?></li>
    <?php endforeach; ?>
</ul>
//the html of the form 
```

任何帮助深表感谢。提前致谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:20:44.790

您可以使用 formElementErrors 视图助手来获取每个元素的错误消息，如下所示：

```
<ul>

    <li>
         <?php echo $this->formLabel($form->get($form->get('title')) ?>
         <?php echo $this->formElement($form->get($form->get('title'))) ?>
         <?php echo $this->formElementErrors($form->get($form->get('title')), array('class' => 'errors')) ?>
    </li>
    <li>
         <?php echo $this->formLabel($form->get($form->get('content')) ?>
         <?php echo $this->formElement($form->get($form->get('content'))) ?>
         <?php echo $this->formElementErrors($form->get($form->get('content')), array('class' => 'errors')) ?>
    </li>

</ul> 
```

您还可以像这样对 HTML 进行更多控制：

```
<li>
   <?php echo $form->get('content')->getLabel() ?>
    <input class="some-class" type="text" 
       name="<?php echo $form->get('content')->getName() ?>"
       value="<?php echo $form->get('content')->getValue() ?>"
    />
</li> 
```

如果您想获取所有表单错误：

```
<?php foreach($form->getMessages() as $errors): ?>
    <?php var_dump($errors) // Array for messages for each input ?>
<?php endforeach ?> 
```

# javascript - 如何让我的 JavaScript 项目更易于管理？

> ID：14718799
> 
> 赞同：3
> 
> 时间：2013-02-05T23:18:30.707
> 
> 标签：javascript

目前我正在构建一个可以附加到任何 HTML5 Canvas 元素上下文并与之交互的 JS 库。

但是，该项目开始变得广泛，包含大量文件和数千行代码。每个文件代表一个不同的对象/模块。每个文件目前都是这样布局的，我真的很想保留这种风格的一些外观：

```
Object = function() { 
    // constructor
}

Object.prototype.method1 = function() {
    // Logic
}

Object.prototype.method2 = function() {}; // .... etc 
```

在 HTML 的开发版本中，我有一个需要按精确顺序排列的 bajillion 脚本标签（每个文件一个）（用于依赖项）。我意识到这是非常低效的，也不是很容易维护。但是我不确定尝试使我的项目更易于构建和维护的最佳方向是什么。移植到 NodeJS 以方便工具和 CommonJS 模块系统？转换为 RequireJS？我刚刚开始阅读 Grunt，这对我的情况有用吗？

改进我的组织和引入某种构建系统都是我已经推迟了一段时间的事情。我现在后悔了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:29:11.640

**你需要一个模块系统**。

带有 RequireJS 优化器的 RequireJS 是这里的规范解决方案。如果您更倾向于 Node.js，您可以使用[browserify](http://browserify.org/)`define(function (require, exports, module) { ... });` ，或者如果您不喜欢 AMD cruft ( )，则可以使用 RequireJS 优化器的 cjsTranslate 功能——可能在开发中与[Cajon](http://tagneto.blogspot.com/2012/06/cajon-browser-module-loader-for.html)结合使用。

* * *

像 Grunt 这样的构建工具并不是这里最重要的因素。这主要在您有多个构建步骤时很有用——例如，运行 RequireJS 优化器，然后将您的 SASS 编译为原始 CSS，然后连接 CSS，然后将您的图像转换为精灵，然后......等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:24:05.810

需要注意的是，对于这些`<script>`标签中的每一个，浏览器都必须再发出一个 HTTP 请求——即使它是从缓存中加载的，浏览器也必须询问服务器文件是否已更改。

我建议编写一个小程序，例如这个 PHP 脚本，将所有 .js 文件合并为一个：

```
<?php
function loop($dir="./") {
    $ret = Array();
    foreach(glob($dir."*",GLOB_ONLYDIR) as $d) $ret = array_merge($ret,loop($d));
    foreach(glob($dir."*.js") as $f) $ret[] = $f;
    return $ret;
}
$out = fopen("__main.js","w");
foreach(loop() as $file) {
    if( $file == "./__main.js") continue; // don't include "main" script
    fwrite($out,file_get_contents($file));
}
fclose($out);
?> 
```

现在你可以只用一个`<script>`标签指向那个`__main.js`文件，你所有的脚本都会在那里。

如果您的脚本必须按特定顺序排列，那么您做错了什么。如果您只在这些文件中定义对象，则它不应依赖于其他文件，因为引用应该在方法中（`init`例如，考虑使用方法）。

# php - 如何使用 Javascript 和 Ajax 将 HTML 单选按钮值传递给 PHP 变量？

> ID：14718800
> 
> 赞同：1
> 
> 时间：2013-02-05T23:18:31.077
> 
> 标签：php, javascript, ajax, radio

我正在尝试使用 Jquery/Javascript 和 Ajax 将用户选中的 HTML 单选按钮值传递给 PHP 变量。

以下是 HTML/Javascript 的简化版本（没有错误检查等）

```
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js"></script>
</head>
<body>

<input type="radio"  name="bus_plan" id="smallBtn" value="1"/>
<input type="radio"  name="bus_plan" id="smallBtn" value="2"/>

<script type="text/javascript">
$(document).ready(function()
{
    $("input[name=bus_plan]").on('change', function(){
    var $postID = $('input:radio[name=bus_plan]:checked').val();
    $postID = "="+$postID;
    });
    $.ajax ({
       type: "GET",
       url: "localhost/ajax/product-group.php",
       data: {"postID" : $postID }
    });
});
</script>
</body>
</html> 
```

以下是 PHP 程序的简化版本（localhost/ajax/product-group.php）：

```
<?php
  $postid = $_GET['postID']; 
  echo "The PostID is ".$postid;
?> 
```

这是在 MAMP 堆栈上运行的。

Javascript 一直工作到 $.ajax 调用，然后 PHP 程序 (localhost/ajax/product-group.php) 永远不会“调用”。

任何建议或帮助将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:23:41.473

代替：

```
$("input[name=bus_plan]").on('change', function(){
   var $postID = $('input:radio[name=bus_plan]:checked').val();
   $postID = "="+$postID;
});

$.ajax ({
   type: "GET",
   url: "localhost/ajax/product-group.php",
   data: {"postID" : $postID }
}); 
```

和：

```
$("input[name=bus_plan]").on('change', function(){
    var $postID = $('input:radio[name=bus_plan]:checked').val();
    $postID = "="+$postID;
    $.ajax ({
       type: "GET",
       url: "localhost/ajax/product-group.php",
       data: {"postID" : $postID }
    });
}); 
```

或使用您的代码通过在选项中添加**async = false**使 ajax**异步**

 **使用您的代码，您不知道在单选按钮更改之前或之后何时调用 ajax，因为它是**异步**的，添加**async=false**作为 ajax 选项，您将确保它将同步执行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:28:36.963

在正确缩进代码之前，您无法真正看到问题：

```
$("input[name=bus_plan]").on('change', function() {
    var $postID = $('input:radio[name=bus_plan]:checked').val();
    $postID = "="+$postID;
});
$.ajax ({
   type: "GET",
   url: "localhost/ajax/product-group.php",
   data: {"postID" : $postID }
}); 
```

几个问题：

1.  您`$postID`是变更处理程序的本地人
2.  `$.ajax()`立即运行。
3.  URL 缺少`http://`方案。

您也应该将`$.ajax()`调用移到内部，以便它仅在发生变化时运行：

```
$("input[name=bus_plan]").on('change', function() {
    var $postID = "=" + $('input:radio[name=bus_plan]:checked').val();
    $.ajax ({
       type: "GET",
       url: "http://localhost/ajax/product-group.php",
       data: {"postID" : $postID }
    });
}); 
```**

# javascript - 如何将 Backbone.js 用于多页 Web 应用程序？

> ID：14718806
> 
> 赞同：6
> 
> 时间：2013-02-05T23:19:01.097
> 
> 标签：javascript, backbone.js, single-page-application

我一直使用 Backbone 的路由 (#!/blah)

但我意识到，为了被 Google 索引，您需要提供该网站的非 JavaScript 版本。

我不喜欢写两次代码。所以，我宁愿构建一个多页应用程序，而不是一个单页网络应用程序。

Backbone.js 为我提供了“结构”，因此我的 javascript 不会变成乱七八糟的东西。但是，我对如何使用 Backbone 构建多页应用程序一无所知。

您是否在每个页面渲染中都包含 main.js 文件？路线呢？你怎么处理？你如何处理模块化等？

我希望有一个关于如何使用 Backbone 构建多页 javascript 应用程序的教程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:24:54.360

做这样的事情有很多考虑因素，但这里有两个关键：

### 服务页面

您可能希望让您的 Web 服务器将所有内容路由到服务相同的静态页面（假设它是静态资产）。这意味着一切都`http://yourdomain.com/*`将服务`/var/www/yourdomain.com/index.html`。加载静态页面后，该页面上的 JS 将根据 url 决定要做什么。

### 推送状态

要进行路由，您仍然可以使用主干路由，但不要使用 hashbangs（`#!/blah`样式 url）。例如，参见[http://backbonejs.org/#History](http://backbonejs.org/#History)。这将允许您导航到真实的 URL，而实际上不需要刷新页面。如果浏览器不支持 pushState，一切仍然有效，但它会重新加载页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T16:51:12.303

@Jamie Wong 的回答让您分得一杯羹。通过使用 pushState 而不是基于哈希的 URL，Google 应该将每个路由视为不同的页面。但是，由于我假设每条路线的内容是动态生成的，因此我不清楚 Google 是否会抓取所有内容。正如上面提到的@Domenic，谷歌肯定有访问动态内容的能力，但问题是：

1）他们可以访问多少？

2) 他们是否尝试尽可能多地访问所有站点或可能只访问 Facebook 等大型数据站点？

您可以尝试为每个视图提供默认数据，然后在动态的、基于用户行为的东西中分层。Backbone 称之为自举。 [http://backbonejs.org/#FAQ-bootstrap](http://backbonejs.org/#FAQ-bootstrap)

# javascript - 使用javascript在html中设置输入值

> ID：14718807
> 
> 赞同：0
> 
> 时间：2013-02-05T23:19:03.007
> 
> 标签：javascript, html, getelementbyid

地点：

> [http://tinyurl.com/ah9hkgz](http://tinyurl.com/ah9hkgz)

问题：我正在尝试编写简单的 javascript 函数来计算客户订单的小计和总计。我有箭头来增加/减少每个产品的值。

尝试编写函数 cash(qty); 这与其他“内联javascript”代码一起称为onclick。在现场，只有第一个产品的向上箭头是调用现金功能。

当调用函数 cash 时，`document.getelementbyid('szett_subtotal').Value=price;`不起作用。

收银功能：

```
function cash(qty)
{
   var price = 0;
   price = 12990 + ((qty.value-1)*9990); 
   document.getelementbyid('szett_subtotal').Value=price;
) 
```

谢谢你的帮助。我希望。

**澄清**

向下按钮不包含此现金功能调用，因为我专注于向上按钮进行测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:41:52.400

您的函数声明`cash`导致解析错误：

```
function cash(qty)
{
   var price = 0;
   price = 12990 + ((qty.value-1)*9990); 
   document.getElementById('szett_subtotal').value=price; 
)
^
Uncaught SyntaxError: Unexpected token ) 
```

函数体应以花括号结尾`}`。

此外，不要使用内联 JavaScript 代码，它容易出错，并且最好从 HTML 外部添加行为，例如`.addEventListener()`.

最简单的方法是创建一个点击处理函数并从内联调用*它*：

```
function inc_quantity(v)
{
  var qty_el = document.getElementById(v);
  var qty = qty_el.value;
  if( !isNaN( qty )) qty_el.value++;
  cash(qty_el);
}

  ... onclick="inc_quantity('quantity_szett')" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:20:53.317

`Value`应该是`value`，`getelementbyid`应该是`getElementById`。

```
document.getElementById('szett_subtotal').value=price; 
```

JavaScript 是一种区分大小写的语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:25:43.690

在向下按钮上，您的页面具有：

```
var qty_el = document.getElementById('quantity_szett'); var qty = qty_el.value; if( !isNaN( qty ) && qty > 0 ) qty_el.value--;return false; 
```

然而，在向上按钮上，它说：

```
var qty_el = document.getElementById('quantity_szett'); var qty = qty_el.value; if( !isNaN( qty )) qty_el.value++;cash(document.getElementById('quantity_szett'));return false; 
```

调用`cash`向下按钮的函数`onclick`。计算机**没有常识**`cash`，即使向上按钮也不会要求向下按钮。

IE添加

```
cash(document.getElementById('quantity_szett')); 
```

就在`return false`您的向下按钮之前`onclick`。

希望这有帮助！

# angularjs - 使用 ServiceStack 的路由路径

> ID：14718808
> 
> 赞同：3
> 
> 时间：2013-02-05T23:19:05.887
> 
> 标签：angularjs, servicestack

我正在使用 AngularJS，我想在 ServiceStack-serving-static-html 上执行以下路由

![在此处输入图像描述](../Images/fe33591e421c686e828df2a70e89beda.png)

请注意**截取屏幕截图上的任何路径**。

另请注意，我没有将 ServiceStack 用于 REST，而是将其用作纯网络服务器来提供静态内容，例如 html

是否可以在 ServiceStack 上做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:26:32.370

这是 node.js 代码，这里没有显示任何 C# ServiceStack AppHost 代码。

[ServiceStack](http://www.servicestack.net/)默认支持通过 HTTP 提供静态内容，但要从应用程序的根目录提供静态内容，您应该将其托管在`/`.

您没有提到您是通过 ASP.NET 主机使用托管 ServiceStack 还是作为独立的自托管 HttpListener 使用。如果是后者，您还需要在 VS.NET 中设置您想要将`Build Action`静态文件标记为**Content**的文件，并将其设置`Copy to Output Directory`为**Copy if Newer**。

# arrays - 循环浏览替代文本 onclick

> ID：14718811
> 
> 赞同：0
> 
> 时间：2013-02-05T23:19:32.690
> 
> 标签：arrays, text, for-loop, onclick, cycle

完全的新手，试图创建一个个性化的圣经，用户可以通过直接单击所述单词/短语来循环各个单词/短语的替代翻译。我知道我可能需要在函数中使用某种“for 循环”，但我希望将它们的首选项存储（作为字符串？）在缓存和用户配置文件中，因此文本不应在页面加载时重置为默认值。理想情况下，我会在 HTML 中嵌入备用文本选项（“数组”？），如下所示，同时保持 HTML 尽可能整洁。JS 最终会填充数千个 ID，可能每节圣经都有几个 ID，因此脚本越通用越好。提前致谢！

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function() {
    $('.alternate').click(function() {
        $('#1Cor13-4a').text('[What goes here if I want to cycle through the options listed in HTML?]');
        $('#1Cor13-4b').text('[Ditto]');
    });
});
</script>

My <span class="alternate" id="1Cor13-4a" onclick="ChangeText({"care","love"})">love</span><span class="alternate" id="1Cor13-4b" onclick="ChangeText({"is patient with","suffers long for"})">is patient with</span> you. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:57:23.283

使用数据属性...

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.js"></script>
<script>
$(document).ready(function() {
 $('.alternate').click(function() {
       var index=   $(this).attr("data-text-index");
     var text = $.parseJSON($(this).attr("data-text"));
     if(index== null)
         index = -1;
     index = Number(index)+1>=text.length? 0:Number(index)+1;
     $(this).html(text[index]);
     $(this).attr("data-text-index",index);
  });
});
</script>
My <span class="alternate" id="1Cor13-4a" data-text='["care","love"]'>love</span><span class="alternate" id="1Cor13-4b" data-text='[" is patient with"," suffers long for"]'> is patient with</span> you. 
```

# microblogging - qq/腾讯测试用户

> ID：14718814
> 
> 赞同：0
> 
> 时间：2013-02-05T23:19:48.983
> 
> 标签：microblogging

有没有腾讯/QQ提供的API来创建测试用户（就像facebook一样？）？我有开发人员的信誉，api 文档似乎很复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T10:09:31.717

这里提供了一个带有示例代码的精彩 sdk

[http://wiki.opensns.qq.com/wiki/%E3%80%90QQ%E7%99%BB%E5%BD%95%E3%80%91IOS_SDK%E4%BD%BF%E7%94%A8 %E8%AF%B4%E6%98%8E](http://wiki.opensns.qq.com/wiki/%E3%80%90QQ%E7%99%BB%E5%BD%95%E3%80%91IOS_SDK%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E)

# android - Android：安装后第一次未显示视图

> ID：14718821
> 
> 赞同：0
> 
> 时间：2013-02-05T23:20:45.433
> 
> 标签：android, view, invisible

我有一个 Activity，它使用 ViewSwitcher 来显示加载屏幕，然后是我的主视图。加载屏幕显示正常，但主视图不可见。它在那里是因为我的应用程序启动后我无法触摸屏幕上的任何东西，但它是不可见的。我需要导航到主屏幕（系统栏仍处于活动状态），然后重新启动应用程序，它只是将其带到前台（使其可见）。

这只发生在安装后第一次打开时。我尝试手动设置可见性并使用 bringToFront() 将其置于前台，但在我再次点击应用程序图标之前它一直不可见。

这是我的代码：我开始加载 AsyncTask 并在*onPreExecute*中执行此操作：

```
viewSwitcher = new ViewSwitcher(MainActivity.this);  
viewSwitcher.addView(ViewSwitcher.inflate(MainActivity.this, R.layout.splashscreen, null));  
setContentView(viewSwitcher);
mv = new MainView(MainActivity.this); 
```

然后在*doInBackground*中，我完成了所有繁重的工作，在*onPostExecute*中，我像这样切换视图：

```
viewSwitcher.addView(mv);
viewSwitcher.showNext();
//I have tried all this:
mv.setVisibility(View.VISIBLE);
viewSwitcher.setVisibility(View.VISIBLE);
viewSwitcher.bringToFront();
mv.bringToFront(); 
```

我也尝试在没有内容切换器的情况下正常设置内容视图，但无济于事。就像 UI 在异步任务之后没有失效一样。我不知道为什么这只会在安装后发生一次并且每隔一段时间都可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T00:36:58.857

好的，想通了。问题是在加载和访问 asyncTask 以更新进度时出错。该错误已得到处理，因此加载继续，但这不知何故使视图不可见。我将 myasyncTask.setProgress() 放在 runOnUiThread 和 viola 中，视图加载并按预期显示。

# wordpress - 处理 Git 部署 (WordPress)

> ID：14718822
> 
> 赞同：2
> 
> 时间：2013-02-05T23:20:49.167
> 
> 标签：wordpress, git

所以，像你们大多数人一样，我使用 MAMP 在本地开发我的网站。我最近一直在学习 git，并为此准备将 FTP 从我的工作流程中完全删除。

不过，我想知道是否有处理 WordPress 数据库的最佳实践。

目前我只对当前主题使用版本控制，但想将其扩展为在本地控制整个站点并相应地将其推送到服务器。这意味着对文件进行更改，添加帖子/页面，并且通常在整个站点上乱搞，保持本地和远程站点同步。这可能吗？

在过去的一周里，我阅读了大量的指南，并遵循了无数的教程，所以任何帮助都将不胜感激。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T05:42:21.963

这不是真的可行，git 是用于文件更改，而不是用于您的数据库。由于 WordPress 将数据存储在数据库中的方式，如果没有自定义脚本（bash、ruby 等），您将无法同步内容，也就是...*跳过箍*。

您可以使用 cron 转储数据库文件并将其放入 git，但由于 WordPress 存储值的方式，您无法同步文件。

这已在[https://wordpress.stackexchange.com/上提出过问题](https://wordpress.stackexchange.com/search?tab=votes&q=sync%20database)

# javascript - 显示和隐藏 div

> ID：14718824
> 
> 赞同：0
> 
> 时间：2013-02-05T23:20:53.813
> 
> 标签：javascript, html, toggle, show-hide

我的 html 中有四个不同的 div，我想隐藏它们，然后根据我点击的链接显示我选择的一个。但是，我无法隐藏它们。它不起作用，我希望各个 div 中的任何内容都显示在链接下，而不是像现在这样显示在它们旁边。我最大的困难是隐藏我的div，有什么解决办法吗？

Javascript

```
function show1(){
var minaP = document.getElementByID("one");
minaP.style.visibility = "visible";
}

function show2(){
var minaP = document.getElementById("two");
minaP.style.visibility = "visible";
}

function show3(){
var minaP = document.getElementById("three");
minaP.style.visibility = "visible";
}

function show4(){
var minaP = document.getElementById("four");
minaP.style.visibility = "visible";
}

function init() {

var minaDiv = document.getElementsByTagName("div");
for(i=0; i<minaDiv.length; i++){
  minaDiv[i].style.visibility = "hidden";
}

var minaA = document.getElementsByTagName("a");
for(i=0; i<minaA.length; i++){
  if(document.getElementById == "1"){
    minaA.onclick = show1;
  }
}

}

window.onload = init; 
```

html

```
<div>
<ul class="meny">
<li><a href="#" id="1">Utvärdering/Feedback</a></li>
<li><a href="#" id="2">Kontakt</a></li>
<li><a href="#" id="3">Öppettider</a></li>
<li><a href="#" id="4">Om Asperöd</a></li>
</ul>
</div>

<div id="one">
<p><b>Aperåd Äventyrsland</b></p> 
<p>Växel: 0200-123456999 (kl.08:30-15)</p>
<p>Stora Vägen 140</p>
<p>289 22 Aperöd</p>
<p>Skicka oss din <a href="#">fråga</a></p>
</div>
<div id="two">
<p>Du kan kontakta oss på följande nummer: 
<br> 040-123456
</p>
<p> Du kan även mejla oss:
<br> aperöd@hotmail.com
</p>
</div>
<div id="three">
<p>Vi har följande öppettider:</p>
<p> Mån-Fre: 10:00 - 20:00 </p>
<p> Lör: 10:00 - 18:00 </p>
</div>
<div id="four"> 
```

Aperöd är en fin park för alla möjliga personer。Vi erbjuder en massa, men det kostar 500kr for
att delta för en dag。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:25:02.637

你需要使用`style.display = 'none'`，而不是`style.visibility`和`style.display = 'block'`或`'inline'`来显示它们

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:50:08.827

也许你应该考虑使用/学习 jQuery。它有助于减少代码大小，并且有很多精美的动画；）

这是一个快速演示`.hide() .show()`

[http://jsfiddle.net/yFhX5/](http://jsfiddle.net/yFhX5/)

# javascript - JQuery 检查点击的 li 是否有子 ol/ul

> ID：14718825
> 
> 赞同：0
> 
> 时间：2013-02-05T23:20:55.690
> 
> 标签：javascript, jquery

寻找关于如何检测 li 是否有子 ul 或 ol 的解决方案，我发现 jquery [has()](http://api.jquery.com/has/)非常棒，除了我需要检测是否只有实际点击的 li 有子 ol，而不是它的任何兄弟姐妹。有没有办法做到这一点？文档没有涵盖这一点。

**HTML**

```
 <ol>
    <li><a class="delete-li" href="">Page 1</a></li>
    <li><a class="delete-li" href="">Page 2</a></li>
    <li><a class="delete-li" href="">Page 3 has ol</a>
             <ol>
                <li><a class="delete-li" href="">Page 4</a></li>
                <li><a class="delete-li" href="">Page 5</a></li>
                <li><a class="delete-li" href="">Page 6</a></li>
             </ol> 
        </li>
 </ol> 
```

**JS**

```
$('.delete-li').live('click', function(event){
event.preventDefault();
item_id = $(this).attr('rel');  
clicked = $(this);
////////////////////
    //check if has sub pages
            if(clicked.has('ol')){
              answer = confirm('This will delete all sub pages and content are you sure?');
              console.log(answer);
              if(answer===true){gogogo=true;   
                  }else{gogogo=false;}
                       }else{ gogogo=true;}
        //if yes run AJAX delete
        if(gogogo===true){
        alert('LI REMOVED');
}
////////////////

    }); 
```

签出[jsfiddle](http://jsfiddle.net/ZqzVN/)的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T23:24:40.400

`has`返回一个始终为 的 jQuery 对象`true`，因为您的处理程序绑定到`a`您可以使用`next`方法和`length`属性的元素：

```
if ( clicked.next('ol').length ) 
```

请注意，`live`不推荐使用方法，您可以改用`on`方法。

```
$(document).on('click', '.delete-li',  function (event) {
    event.preventDefault();
    var gogogo = false, $clicked = $(this), item_id = this.rel;  
    ////////////////////
    //check if has sub pages
    if ($clicked.next('ol').length) {
        gogogo = confirm('This will delete all sub pages and content are you sure?');
        // console.log(gogogo);
    }

    if (gogogo === true) {
        alert('LI REMOVED');
    }
}); 
```

[http://jsfiddle.net/jMF42/](http://jsfiddle.net/jMF42/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:29:42.673

您正在将点击处理程序绑定到`a`元素。您需要参考`li`.

```
listItem = $(this).parent('li');
//check if has sub pages
if (listItem.find('ol').length) {
   ...
} 
```

[jsfiddle](http://jsfiddle.net/pwGwX/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:59:09.133

您正在调用标签上的函数`<a>`，该标签没有孩子。如果你想更深入，你需要参考他的父母`<li>`。

```
$('.delete-li').on('click', function (event) {
    event.preventDefault();
    $this = $(this);
    if ($this.parent('li').children('ol').length) {
        answer = confirm('This will delete all sub pages and content are you sure?');
        alert(answer);
    } else {
        alert('dont');
    }
}); 
```

[http://jsfiddle.net/NGmz6/](http://jsfiddle.net/NGmz6/)

# caching - AngularJS 在开发机器上禁用部分缓存

> ID：14718826
> 
> 赞同：212
> 
> 时间：2013-02-05T23:20:59.087
> 
> 标签：caching, angularjs, browser-cache

我在 AngularJS 中缓存局部有问题。

在我的 HTML 页面中，我有：

```
<body>
 <div ng-view></div>
<body> 
```

我的部分加载的地方。

当我更改部分 HTML 代码时，浏览器仍会加载旧数据。

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2013-10-04T08:49:34.660

对于开发，您还可以停用浏览器缓存 - 在 Chrome Dev Tools 的右下角单击齿轮并勾选选项

> 禁用缓存（在 DevTools 打开时）

更新：在 Firefox 中，调试器 -> 设置 -> 高级部分有相同的选项（检查版本 33）

更新 2：虽然此选项出现在 Firefox 中，但一些报告称它不起作用。我建议使用萤火虫并遵循 hadaytullah 的回答。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2013-02-06T04:06:12.677

以@Valentyn 的回答为基础，这是一种在 ng-view 内容更改时始终自动清除缓存的方法：

```
myApp.run(function($rootScope, $templateCache) {
   $rootScope.$on('$viewContentLoaded', function() {
      $templateCache.removeAll();
   });
}); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2014-03-12T17:24:03.843

如其他答案中所述，[here](https://stackoverflow.com/questions/14718826/angularjs-disable-partial-caching-on-dev-machine#answer-14721340)和[here](https://stackoverflow.com/questions/14718826/angularjs-disable-partial-caching-on-dev-machine#answer-14719200)，可以使用以下方法清除缓存：

```
$templateCache.removeAll(); 
```

但是，正如[gatoatigrado](https://stackoverflow.com/users/81636/gatoatigrado)在[评论](https://stackoverflow.com/questions/14718826/angularjs-disable-partial-caching-on-dev-machine#comments-14718826)中所建议的那样，这仅在没有任何缓存标头的情况下提供 html 模板时才有效。

所以这对我有用：

在角度：

```
app.run(['$templateCache', function ( $templateCache ) {
    $templateCache.removeAll(); }]); 
```

您可能会以多种方式添加缓存标头，但这里有一些对我有用的解决方案。

如果使用`IIS`，请将其添加到您的 web.config 中：

```
<location path="scripts/app/views">
  <system.webServer>
    <staticContent>
      <clientCache cacheControlMode="DisableCache" />
    </staticContent>
  </system.webServer>
</location> 
```

如果使用 Nginx，您可以将其添加到您的配置中：

```
location ^~ /scripts/app/views/ {
    expires -1;   
} 
```

**编辑**

我刚刚意识到问题提到了`dev`机器，但希望这仍然可以帮助某人......

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-02-05T23:57:03.693

如果您谈论的是用于缓存模板而不重新加载整个页面的缓存，那么您可以通过以下方式清空它：

```
.controller('mainCtrl', function($scope, $templateCache) {
  $scope.clearCache = function() { 
    $templateCache.removeAll();
  }
}); 
```

在标记中：

`<button ng-click='clearCache()'>Clear cache</button>`

并按此按钮清除缓存。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2014-11-22T23:27:08.550

## 使用 Firebug (22.0.6) 的 Firefox (33.1.1) 解决方案

1.  工具 > Web 工具 > Firebug > 打开 Firebug。
2.  在 Firebug 视图中，转到“Net”视图。
3.  “网络”（视图的标题）旁边将出现一个下拉菜单符号。
4.  从下拉菜单中选择“禁用浏览器缓存”。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2014-05-03T06:51:24.103

这个片段帮助我摆脱了模板缓存

```
app.run(function($rootScope, $templateCache) {
    $rootScope.$on('$routeChangeStart', function(event, next, current) {
        if (typeof(current) !== 'undefined'){
            $templateCache.remove(current.templateUrl);
        }
    });
}); 
```

以下片段的详细信息可以在此链接上找到：http: [//oncodesign.io/2014/02/19/safely-prevent-template-caching-in-angularjs/](http://oncodesign.io/2014/02/19/safely-prevent-template-caching-in-angularjs/)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2015-01-28T16:31:47.377

我发布这个只是为了涵盖所有可能性，因为其他解决方案都不适合我（它们由于 angular-bootstrap 模板依赖性等而引发错误）。

在开发/调试特定模板时，可以通过在路径中包含时间戳来确保它始终刷新，如下所示：

```
 $modal.open({
          // TODO: Only while dev/debug. Remove later.
          templateUrl: 'core/admin/organizations/modal-selector/modal-selector.html?nd=' + Date.now(),
          controller : function ($scope, $modalInstance) {
            $scope.ok = function () {
              $modalInstance.close();
            };
          }
        }); 
```

注意变量`?nd=' + Date.now()`中的final 。`templateUrl`

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-05-15T19:20:00.360

正如其他人所说，完全出于开发目的而取消缓存可以在不更改代码的情况下轻松完成：使用浏览器设置或插件。在开发人员之外，要击败基于路由的模板的 Angular 模板缓存，请在 $routeChangeStart（或 $stateChangeStart，对于 UI 路由器）期间从缓存中删除模板 URL，如 Shayan 所示。但是，这不会影响 ng-include 加载的模板的缓存，因为这些模板不是通过路由器加载的。

我希望能够在生产中修补任何模板，包括那些由 ng-include 加载的模板，并让用户在浏览器中快速接收修补程序，而无需重新加载整个页面。我也不担心破坏模板的 HTTP 缓存。解决方案是拦截应用程序发出的每个 HTTP 请求，忽略那些不适用于我的应用程序的 .html 模板的请求，然后将参数添加到每分钟更改一次的模板 URL。请注意，路径检查特定于应用程序模板的路径。要获得不同的间隔，请更改参数的数学运算，或完全删除 % 以获得不缓存。

```
// this defeats Angular's $templateCache on a 1-minute interval
// as a side-effect it also defeats HTTP (browser) caching
angular.module('myApp').config(function($httpProvider, ...) {
    $httpProvider.interceptors.push(function() {
        return {
            'request': function(config) {
                config.url = getTimeVersionedUrl(config.url);
                return config;
            }
        };
    });

    function getTimeVersionedUrl(url) {
        // only do for html templates of this app
        // NOTE: the path to test for is app dependent!
        if (!url || url.indexOf('a/app/') < 0 || url.indexOf('.html') < 0) return url;
        // create a URL param that changes every minute
        // and add it intelligently to the template's previous url
        var param = 'v=' + ~~(Date.now() / 60000) % 10000; // 4 unique digits every minute
        if (url.indexOf('?') > 0) {
            if (url.indexOf('v=') > 0) return url.replace(/v=[0-9](4)/, param);
            return url + '&' + param;
        }
        return url + '?' + param;
    } 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2014-12-14T05:26:21.713

如果您使用的是 UI 路由器，那么您可以使用装饰器并更新 $templateFactory 服务并将查询字符串参数附加到 templateUrl，浏览器将始终从服务器加载新模板。

```
function configureTemplateFactory($provide) {
    // Set a suffix outside the decorator function 
    var cacheBust = Date.now().toString();

    function templateFactoryDecorator($delegate) {
        var fromUrl = angular.bind($delegate, $delegate.fromUrl);
        $delegate.fromUrl = function (url, params) {
            if (url !== null && angular.isDefined(url) && angular.isString(url)) {
                url += (url.indexOf("?") === -1 ? "?" : "&");
                url += "v=" + cacheBust;
            }

            return fromUrl(url, params);
        };

        return $delegate;
    }

    $provide.decorator('$templateFactory', ['$delegate', templateFactoryDecorator]);
}

app.config(['$provide', configureTemplateFactory]); 
```

我相信你可以通过修饰 $routeProvider 中的“when”方法来达到同样的效果。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-03-24T16:55:36.793

我发现 HTTP 拦截器方法工作得非常好，并且允许额外的灵活性和控制。此外，您可以使用发布哈希作为 buster 变量来缓存每个生产版本。

下面是 dev cachebusting 方法使用的样子`Date`。

```
app.factory('cachebustInjector', function(conf) {   
    var cachebustInjector = {
        request: function(config) {    
            // new timestamp will be appended to each new partial .html request to prevent caching in a dev environment               
            var buster = new Date().getTime();

            if (config.url.indexOf('static/angular_templates') > -1) {
                config.url += ['?v=', buster].join('');
            }
            return config;
        }
    };
    return cachebustInjector;
});

app.config(['$httpProvider', function($httpProvider) {
    $httpProvider.interceptors.push('cachebustInjector');
}]); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-08-28T13:52:04.270

这是 Chrome 中的另一个选项。

点击`F12`打开开发者工具。然后**Resources** > **Cache Storage** > **Refresh Caches**。

[![在此处输入图像描述](../Images/7c99cc9c8521cf752d7f9cc0d3cc7337.png)](https://i.stack.imgur.com/czsGi.png)

我喜欢这个选项，因为我不必像其他答案那样禁用缓存。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-03T15:11:26.007

没有解决方案可以防止浏览器/代理缓存，因为您无法控制它。

另一种向用户强制提供新鲜内容的方法是重命名 HTML 文件！就像[https://www.npmjs.com/package/grunt-filerev](https://www.npmjs.com/package/grunt-filerev)对资产所做的一样。

# highcharts - 在工具提示中格式化 Highchart 的日期会导致值发生变化

> ID：14718828
> 
> 赞同：1
> 
> 时间：2013-02-05T23:21:00.707
> 
> 标签：highcharts

我正在使用 Highcharts 绘制一天内发生的一些点。当我使用默认值时，x 轴标签是正确的：`12AM, 4AM, 8AM, 12PM, 4PM and 8PM,`每个点在工具提示中回显的时间也是正确的，例如 0400 年 1 月 6 日、1200 年 1 月 6 日、1600 年 1 月 6 日等。

我不想要军用时间（例如 1600 小时），所以我通过以下方式更改时间格式：

`tooltip: {xDateFormat: '%b %e, %l %p' }`

我认为这会导致 1 月 6 日下午 4 点。

但是当我这样做时，x 轴上的标签都变成了 12 AM，工具提示看起来像 Jan 6, 00:00:00.016。点本身出现在相同的位置，只是标签和工具提示错误；现在看来时间是从上午 12 点开始的毫秒数。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:25:47.470

您可以使用 Highcharts.dateFormat(); [http://api.highcharts.com/highcharts#Highcharts.dateFormat()](http://api.highcharts.com/highcharts#Highcharts.dateFormat())

# google-apps-script - 谷歌应用脚 本我想为所有月份的第一个星期六定义重复

> ID：14718830
> 
> 赞同：1
> 
> 时间：2013-02-05T23:21:07.793
> 
> 标签：google-apps-script, recurrence

我有复发的问题。我无法定义所有月份的复发，只有第一个星期六

我有这个代码：

```
var bck_startdate = new Date("January 7, 2012 22:00"); 
var bck_enddate = new Date("January 7, 2012 23:00"); 
eventRecurrence.addMonthlyRule().onlyOnWeekday(CalendarApp.Weekday.SATURDAY);
var cal_event=cal_netbackup.createEventSeries("TEST,bck_startdate,bck_enddate,eventRecurrence,{description:"TEST_DESCRPT"}); 
```

但结果是所有星期都在星期六。如果我直接在日历上输入 eventserie 并按工作日，它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:11:44.697

您可以通过将每月的天数限制为前七天来确保它只是每月的第一个星期六。

```
var recurrence = CalendarApp.newRecurrence().addMonthlyRule()
    .onlyOnWeekday(CalendarApp.Weekday.SATURDAY)
    .onlyOnMonthDays([1,2,3,4,5,6,7]); 
```

# c++ - Qmake在创建Visual Studio项目时不替换环境变量？

> ID：14718836
> 
> 赞同：2
> 
> 时间：2013-02-05T23:21:38.573
> 
> 标签：c++, windows, qt, environment-variables, qmake

在 Windows 7 上使用 qmake 创建项目时（使用 Visual Studio 2010）：

```
qmake -tp vc OmniScribe.pro 
```

在我的 .pro 文件中，我在 INCLUDEPATH=+ 下有（以及许多其他内容）

```
${OPENCV_HOME}/include/opencv \ 
```

但是当我查看项目设置 -> C/C++ -> 常规 -> 附加包含目录时，在清单中，我看到这个 OPENCV_HOME 环境变量没有被替换，并且以下内容包含在列表中：

```
${OPENCV_HOME}\include\opencv 
```

我肯定有一个 OPENCV_HOME 作为我的用户环境变量的一部分设置为：

```
X:\users\username\Windows_Stuff\OpenCV2.4 
```

请注意，这是我没有管理员权限的机器上的网络驱动器。

如何配置我的 .pro 文件或更改我的 qmake 命令以防止这种情况发生？上面的语法在使用 Linux 时被正确解析，所以我不确定我需要做什么来修复问题或根本问题在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T10:21:36.930

要在运行 qmake 时扩展环境变量，请使用：$$(OPENCV_HOME)

# php - php递归正则表达式

> ID：14718838
> 
> 赞同：0
> 
> 时间：2013-02-05T23:21:44.123
> 
> 标签：php, regex

这是一个简单的问题，但我浪费了太多时间试图自己解决。

我将数据存储在字符串中，`r{N}-{N}s{N}`其中 {N} 是一位或两位数。这种模式最多可以重复 5 次。我需要从模式中提取数字，最好以某种方式分组。

例如，如果字符串是`"r4-10s5"`，我想提取`{4,10,5}`

如果字符串是`"r4-10s5r6-7s8"`我想提取`{4,10,5} {6,7,8}`

我怎么能在 PHP 中完成这项工作？

我曾尝试使用递归正则表达式，但我无法让它们正确匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:24:34.417

静态模式是：**r `- `s``**```，空点只能是数字```

 ````/r(\d{1,2})-(\d{1,2})s(\d{1,2})/`=> 在这里测试：[http ://regex101.com/r/sH4sY0](http://regex101.com/r/sH4sY0)

`\d{1,2}`连续匹配 1 或 2 个数字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:29:16.213

```
$str = "r4-10s5r6-7s8";

preg_match_all("#r(\d{1,2})-(\d{1,2})s(\d{1,2})#", $str, $matches);

// group the matches together
$sets = array();
for ($i = 0, $count = count($matches[0]); $i < $count; $i++)
    $sets[] = array($matches[1][$i], $matches[2][$i], $matches[3][$i]);

print_r($sets); 
```

输出：

```
array (size=2)
  0 => 
    array (size=3)
      0 => string '4' (length=1)
      1 => string '10' (length=2)
      2 => string '5' (length=1)
  1 => 
    array (size=3)
      0 => string '6' (length=1)
      1 => string '7' (length=1)
      2 => string '8' (length=1) 
```

* * *

没有循环的另一个选项是：

```
preg_match_all("#r(\d{1,2})-(\d{1,2})s(\d{1,2})#", $str, $matches, PREG_SET_ORDER);

print_r($matches); 
```

输出：

```
array (size=2)
  0 => 
    array (size=4)
      0 => string 'r4-10s5' (length=7)
      1 => string '4' (length=1)
      2 => string '10' (length=2)
      3 => string '5' (length=1)
  1 => 
    array (size=4)
      0 => string 'r6-7s8' (length=6)
      1 => string '6' (length=1)
      2 => string '7' (length=1)
      3 => string '8' (length=1) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T00:01:35.667

我会这样做：

```
function extractNumbers($string, $multiples = 3, $strict = false) {
    $string = preg_replace('/\D+/', ' ', trim($string));
    $array  = explode(' ', trim($string));
    $count  = count($array);
    $remove = ($count % $multiples);
    if ($remove > 0) {
        // Strict, do not allow dangling numbers
        if ($strict) {
            return null;
        }
        $array = array_slice($array, 0, ($count - $remove));
    }
    $array = array_map('intval', $array);
    return array_chunk($array, $multiples);
}
$str = 'r4-10s5r6-7s8';
var_dump(extractNumbers($str)); 
```

它可能不是很优雅，但相对容易理解和维护。```

# jasmine - Jasmine：为什么是 toBeUndefined 而不是 toBeDefined？

> ID：14718841
> 
> 赞同：10
> 
> 时间：2013-02-05T23:22:00.290
> 
> 标签：jasmine

我只是在学习 Jasmine 库，我注意到 Jasmine 的内置断言数量非常有限。我还注意到，尽管数量有限，但其中的两个断言似乎是多余的：`toBeDefined`/ `toBeUndefined`。

换句话说，这两个似乎都在检查相同的东西：

```
expect(1).toBeDefined();
expect(undefined).not.toBeUndefined(); 
```

这有什么原因吗，比如`toBeDefined`不一样的情况`toBeUndefined`？或者这只是 Jasmine 中的一个断言，它有两种完全相等的调用方式？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T13:40:17.727

`toBeTruthy`对于and `toBeFalsy`， or `toBeLessThan`and可能会假设相同`toBeGreaterThan`（尽管我猜最后两个中缺少的断言是`toEqual`）。最后，它归结为可读性和用户偏好。

为了给您一个更完整的答案，查看为这些函数调用的代码可能会很有用。执行的代码通过不同的路径（所以`toBeUndefined`不是简单的`!toBeDefined`）。唯一有意义的真正答案是可读性（或屈服于烦人的功能请求）。[https://github.com/jasmine/jasmine/tree/main/src/core/matchers](https://github.com/jasmine/jasmine/tree/main/src/core/matchers)

# qt - Qt5 过载插槽错误

> ID：14718842
> 
> 赞同：1
> 
> 时间：2013-02-05T23:22:02.567
> 
> 标签：qt

例如

```
class A : public QObject
{
Q_OBJECT

public:
    void f(int);
    void f();
};

A a;
QAction action(0);

connect(&action, &QAction::triggered, &a, &A::f); // error because 2 f functions. 
```

除了重命名两个重载函数之一之外，如何克服它？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:27:41.477

QT5 仍然支持使用完整原型连接的“旧”方式：

```
connect((&action, SIGNAL(triggered()), &a, SLOT(f(int)); 
```

或者

```
connect((&action, SIGNAL(triggered()), &a, SLOT(f()); 
```

编辑：使用新方法可以通过演员来完成（我自己没有尝试过）：

```
connect((&action, &QAction::triggered, &a, static_cast<void (A::*)(int)>(&A::f)); 
```

# networking - 子网零 CIDR 表示法

> ID：14718843
> 
> 赞同：1
> 
> 时间：2013-02-05T23:22:15.983
> 
> 标签：networking, ip, cidr

我和一个朋友正在争论 CIDR 表示法。

如果主机有 /0 掩码会发生什么？

我的朋友说他总是能够与世界上所有的计算机通信，主机总是会要求它的路由器路由它的数据包。

但我认为主机永远不会与其路由器通信，因此无法路由其数据包。

另一个问题：用十六进制写IP地址是否正确？

（对不起我可能的英语错误）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T22:59:49.003

如果主机有 /0 子网掩码，它永远不会与默认网关通信，因为它总是假定目标在它自己的 LAN 范围内。因此，将通过 ARP 解析与 MAC 地址进行进一步的通信。

因此，如果：

*   目标 IP 在子网内 => MAC 和 ARP
*   目标 IP 不在子网内 => 发送到默认网关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T04:37:06.537

“主机有 /0 掩码”是指主机的默认路由有 /0 掩码吗？在这种情况下，我的回答如下。回到基础：/0 掩码表示点分十进制表示法中的 0.0.0.0。这意味着在没有更好匹配的情况下，它会将所有数据包转发到该接口。如果路由器连接到该接口，它将进一步发送。有关完整的逻辑，您可以参考：[http ://www.cisco.com/en/US/tech/tk365/technologies_tech_note09186a00800a67f5.shtml](http://www.cisco.com/en/US/tech/tk365/technologies_tech_note09186a00800a67f5.shtml)

# actionscript-3 - 在 as3 中的 Object 内构造变量

> ID：14718845
> 
> 赞同：0
> 
> 时间：2013-02-05T23:22:37.520
> 
> 标签：actionscript-3, apache-flex, flex4, flex4.5, flexbuilder

嗨，我有以下 ArrayCollection：

```
priceModel.model.arrayProducts.addItem( {'productID':pc.productID, 'product':pc.product,
'provider1': {'value':0, 'selected':false},                                                             'provider2': {'value':0, 'selected':false},                                                             'provider3': {'value':0, 'selected':false},                                                             'provider4': {'value':0, 'selected':false},                                                             'provider5': {'value':0, 'selected':false},                                                             'provider6': {'value':0, 'selected':false}); 
```

我有一组产品，问题是我需要遍历产品并访问某个提供商，例如：

```
priceModel.model.arrayProducts[product_index].('provider'+(idx+1)).value; 
```

这不起作用。如何将代码集中在每个产品中访问它的 provider_X？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:43:08.377

对于 ArrayCollection 你不能使用 [] 语法 - 你必须使用 getItemAt 来访问该项目：

```
priceModel.model.arrayProducts.getItemAt(product_index) 
```

要“动态”访问对象的属性，您可以使用 []：

```
['provider'+(idx+1)].value; 
```

所以这应该工作：

```
priceModel.model.arrayProducts.getItemAt(product_index)['provider'+(idx+1)].value; 
```

# php - 将 PHP 代码实现为函数

> ID：14718847
> 
> 赞同：2
> 
> 时间：2013-02-05T23:22:46.057
> 
> 标签：php, function, ssh, phpseclib

我有一些代码想做成一个函数，因为我想在代码的不同部分和不同的页面上使用它，而且我不想到处都有代码。我正在使用 PHPseclib 库和类。独立工作的代码是：

```
 set_include_path(get_include_path() . PATH_SEPARATOR . 'phpseclib');
include('phpseclib/Net/SSH2.php');

$ssh = new Net_SSH2('$address');
if (!$ssh->login('$username', '$password')) {
    exit('Login Failed');
}

$sPath = "minecraft/servers/";
$sSavingCode = "server.properties";
$motd = "test";

echo $ssh->exec("cat > $sPath$sSavingCode <<EOF
motd=".$motd."
EOF
"); 
```

我想把它变成一个函数，所以我试着这样做：

set_include_path(get_include_path() . PATH_SEPARATOR . 'phpseclib'); 包括（'phpseclib/Net/SSH2.php'）；

```
 $ssh = new Net_SSH2('$address');
    if (!$ssh->login('$username', '$password')) {
        exit('Login Failed');
    }    
function test($motd)
    {
        $sPath = "minecraft/servers/";
        $sSavingCode = "server.properties";

        $ssh->exec("cat > $sPath$sSavingCode <<EOF
        motd=".$motd."
        EOF
        ");
    } 
```

其余代码在函数之外和之上。我正在尝试调用该函数，例如：

```
$motd = "Server";
test($motd); 
```

但这会带来服务器错误。这个功能可以吗？还是应该每次我想使用它时把代码放在我需要的地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:36:14.610

您的函数依赖于`$ssh`，因此应将其作为参数传递：

```
function test(Net_SSH2 $ssh, $motd)
{
    $sPath = "minecraft/servers/";
    $sSavingCode = "server.properties";

    $ssh->exec("cat > $sPath$sSavingCode <<EOF
    motd=".$motd."
    EOF
    ");
}

$ssh = new Net_SSH2('$address');
// ... 
test($ssh, $motd); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T23:32:38.730

当您想要在函数之外定义的 $ssh 变量时，您正在访问本地 $ssh 变量。

所以在你的函数中声明'global $ssh'并使用它，否则你试图在本地调用exec，这是未定义的。

```
$ssh = new Net_SSH2('$address');
if (!$ssh->login('$username', '$password')) {
    exit('Login Failed');
}    
function test($motd)
{
    global $ssh;
    $sPath = "minecraft/servers/";
    $sSavingCode = "server.properties";

    $ssh->exec("cat > $sPath$sSavingCode <<EOF
    motd=".$motd."
    EOF
    ");
} 
```

或者，预定义的 php 数组 $Globals 允许您在不定义本地变量的情况下访问这些变量

```
$ssh = new Net_SSH2('$address');
if (!$ssh->login('$username', '$password')) {
    exit('Login Failed');
}    
function test($motd)
{

    $sPath = "minecraft/servers/";
    $sSavingCode = "server.properties";

    $GLOBALS['ssh']->exec("cat > $sPath$sSavingCode <<EOF
    motd=".$motd."
    EOF
    ");
} 
```

# ios - UIRefreshControl - 当 UITableViewController 在 UINavigationController 内时，beginRefreshing 不起作用

> ID：14718850
> 
> 赞同：129
> 
> 时间：2013-02-05T23:23:03.313
> 
> 标签：ios, objective-c, uitableview, uinavigationcontroller, uirefreshcontrol

我在我的 UITableViewController 中设置了一个 UIRefreshControl（它位于 UINavigationController 中），它按预期工作（即下拉触发正确的事件）。但是，如果我以编程方式调用`beginRefreshing`刷新控件上的实例方法，例如：

```
[self.refreshControl beginRefreshing]; 
```

什么都没发生。它应该动画下来并显示微调器。`endRefreshing`当我在刷新后调用该方法时，该方法可以正常工作。

我用这种行为创建了一个基本的原型项目，当我的 UITableViewController 直接添加到应用程序委托的根视图控制器时，它可以正常工作，例如：

```
self.viewController = tableViewController;
self.window.rootViewController = self.viewController; 
```

但是，如果我`tableViewController`先将 添加到 UINavigationController，然后将导航控制器添加为`rootViewController`，则该`beginRefreshing`方法不再有效。例如

```
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:tableViewController];
self.viewController = navController;
self.window.rootViewController = self.viewController; 
```

我的感觉是这与导航控制器中的嵌套视图层次结构与刷新控件不兼容 - 有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2013-02-06T00:43:02.417

似乎如果您开始以编程方式刷新，您必须自己滚动表格视图，例如，通过更改 contentoffset

```
[self.tableView setContentOffset:CGPointMake(0, -self.refreshControl.frame.size.height) animated:YES]; 
```

我猜这是因为当用户位于表格视图的中间/底部时滚动到刷新控件可能是不可取的？

@muhasturk 的 Swift 2.2 版本

```
self.tableView.setContentOffset(CGPoint(x: 0, y: -refreshControl.frame.size.height), animated: true) 
```

简而言之，为了保持这个便携性，添加这个扩展

**UIRefreshControl+ProgramaticallyBeginRefresh.swift**

```
extension UIRefreshControl {
    func programaticallyBeginRefreshing(in tableView: UITableView) {
        beginRefreshing()
        let offsetPoint = CGPoint.init(x: 0, y: -frame.size.height)
        tableView.setContentOffset(offsetPoint, animated: true)        
    }
} 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2014-03-18T05:34:21.363

UITableViewController 在iOS 7 之后有*automaticAdjustsScrollViewInsets*属性。table view 可能已经有contentOffset，通常是(0, -64)。

因此，在编程开始刷新后显示 refreshControl 的正确方法是将 refreshControl 的高度添加到现有的 contentOffset。

```
 [self.refreshControl beginRefreshing];
 [self.tableView setContentOffset:CGPointMake(0, self.tableView.contentOffset.y-self.refreshControl.frame.size.height) animated:YES]; 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2016-02-17T21:50:34.703

这是使用上述策略的 Swift 扩展。

```
extension UIRefreshControl {
    func beginRefreshingManually() {
        if let scrollView = superview as? UIScrollView {
            scrollView.setContentOffset(CGPoint(x: 0, y: scrollView.contentOffset.y - frame.height), animated: true)
        }
        beginRefreshing()
    }
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-05-20T18:01:19.893

其他答案都不适合我。它们会导致微调器显示和旋转，但刷新操作本身永远不会发生。这有效：

```
id target = self;
SEL selector = @selector(example);
// Assuming at some point prior to triggering the refresh, you call the following line:
[self.refreshControl addTarget:target action:selector forControlEvents:UIControlEventValueChanged];

// This line makes the spinner start spinning
[self.refreshControl beginRefreshing];
// This line makes the spinner visible by pushing the table view/collection view down
[self.tableView setContentOffset:CGPointMake(0, -1.0f * self.refreshControl.frame.size.height) animated:YES];
// This line is what actually triggers the refresh action/selector
[self.refreshControl sendActionsForControlEvents:UIControlEventValueChanged]; 
```

注意，这个例子使用了一个表格视图，但它也可以是一个集合视图。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-02-13T12:50:10.857

已经提到的方法：

```
[self.refreshControl beginRefreshing];
 [self.tableView setContentOffset:CGPointMake(0, self.tableView.contentOffset.y-self.refreshControl.frame.size.height) animated:YES]; 
```

将使微调器可见。但它不会动画。我改变的一件事是这两种方法的顺序，一切正常：

```
[self.tableView setContentOffset:CGPointMake(0, self.tableView.contentOffset.y-self.refreshControl.frame.size.height) animated:YES];
[self.refreshControl beginRefreshing]; 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2018-05-27T10:53:47.953

# 对于 Swift 4/4.1

现有答案的混合为我完成了这项工作：

```
refreshControl.beginRefreshing()
tableView.setContentOffset(CGPoint(x: 0, y: tableView.contentOffset.y - (refreshControl.frame.size.height)), animated: true) 
```

希望这可以帮助！

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-04-27T10:06:40.867

另请参阅此问题

[调用 beginRefreshing 并且 contentOffset 为 0 时 UIRefreshControl 不显示刺](https://stackoverflow.com/questions/16120797/uirefreshcontrol-not-showing-spiny-when-calling-beginrefreshing-and-contentoffse)

对我来说它看起来像一个错误，因为它仅在 tableView 的 contentOffset 属性为 0 时发生

我用以下代码（UITableViewController 的方法）修复了这个问题：

```
- (void)beginRefreshingTableView {

    [self.refreshControl beginRefreshing];

    if (self.tableView.contentOffset.y == 0) {

        [UIView animateWithDuration:0.25 delay:0 options:UIViewAnimationOptionBeginFromCurrentState animations:^(void){

            self.tableView.contentOffset = CGPointMake(0, -self.refreshControl.frame.size.height);

        } completion:^(BOOL finished){

        }];

    }
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-10-10T12:46:34.053

这是**Swift 3 和更高版本**的扩展，它显示微调器并为其设置动画。

```
import UIKit
extension UIRefreshControl {

func beginRefreshingWithAnimation() {

    DispatchQueue.main.asyncAfter(deadline: .now() + 0.05) {

        if let scrollView = self.superview as? UIScrollView {
            scrollView.setContentOffset(CGPoint(x: 0, y: scrollView.contentOffset.y - self.frame.height), animated: true)
          }
        self.beginRefreshing()
      }
   }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-04-14T10:46:44.690

对于 Swift 5，对我来说唯一缺少的就是调用`refreshControl.sendActions(.valueChanged)`. 我做了一个扩展，让它更干净。

```
extension UIRefreshControl {

    func beginRefreshingManually() {
        if let scrollView = superview as? UIScrollView {
            scrollView.setContentOffset(CGPoint(x: 0, y: scrollView.contentOffset.y - frame.height), animated: false)
        }
        beginRefreshing()
        sendActions(for: .valueChanged)
    }

} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-02-16T15:30:33.740

它对我来说很完美：

斯威夫特 3：

```
self.tableView.setContentOffset(CGPoint(x: 0, y: -self.refreshControl!.frame.size.height - self.topLayoutGuide.length), animated: true) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-03-11T12:21:00.640

除了@Dymitry Shevchenko 解决方案。

我找到了解决这个问题的好方法。您可以`UIRefreshControl`为该覆盖方法创建扩展：

```
// Adds code forgotten by Apple, that changes content offset of parent scroll view (table view).
- (void)beginRefreshing
{
    [super beginRefreshing];

    if ([self.superview isKindOfClass:[UIScrollView class]]) {
        UIScrollView *view = (UIScrollView *)self.superview;
        [view setContentOffset:CGPointMake(0, view.contentOffset.y - self.frame.size.height) animated:YES];
    }
} 
```

*您可以通过在Identity Inspector*中设置自定义类来使用新类，以便在 Interface Builder 中进行刷新控制。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-05-05T06:27:27.900

如果你在 swift 3.1 中使用 Rxswift，可以在下面使用：

```
func manualRefresh() {
    if let refreshControl = self.tableView.refreshControl {
        self.tableView.setContentOffset(CGPoint(x: 0, y: -refreshControl.height), animated: true)
        self.tableView.refreshControl?.beginRefreshing()
        self.tableView.refreshControl?.sendActions(for: .valueChanged)
    }
} 
```

**这适用于 swift 3.1、iOS 10。**

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-05-25T18:28:38.327

斯威夫特堡 2.2+

```
 self.tableView.setContentOffset(CGPoint(x: 0, y: -refreshControl.frame.size.height), animated: true) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-03-26T16:53:57.947

**在 Swift 5 上测试**

用这个`viewDidLoad()`

```
fileprivate func showRefreshLoader() {
    DispatchQueue.main.asyncAfter(deadline: .now() + 0.05) {
        self.tableView.setContentOffset(CGPoint(x: 0, y: self.tableView.contentOffset.y - (self.refreshControl.frame.size.height)), animated: true)
        self.refreshControl.beginRefreshing() 
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-23T21:57:18.350

我使用相同的技术来显示用户“数据正在更新”视觉标志。结果用户从后台带来应用程序，并且提要/列表将使用 UI 进行更新，例如用户拉表以刷新自己。我的版本包含 3 件事

1）谁发送“唤醒”

```
- (void)applicationDidBecomeActive:(UIApplication *)application {
    [[NSNotificationCenter defaultCenter] postNotificationName:kNotificationHaveToResetAllPages object:nil];
} 
```

2) UIViewController 中的观察者

```
- (void)viewDidLoad {
    [super viewDidLoad];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(forceUpdateData) name:kNotificationHaveToWakeUp:nil];
} 
```

3)协议

```
#pragma mark - ForcedDataUpdateProtocol

- (void)forceUpdateData {
    self.tableView.contentOffset = CGPointZero;

    if (self.refreshControl) {
        [self.refreshControl beginRefreshing];
        [self.tableView setContentOffset:CGPointMake(0, -self.refreshControl.frame.size.height) animated:YES];
        [self.refreshControl performSelector:@selector(endRefreshing) withObject:nil afterDelay:1];
    }
} 
```

[![结果](../Images/756cb5e57db2f37c5b29bdca513a81cc.png)](https://i.stack.imgur.com/aCZqB.gif)

# android - 将文件夹中结构的预建文件集添加到 android out 文件夹

> ID：14718852
> 
> 赞同：4
> 
> 时间：2013-02-05T23:23:13.113
> 
> 标签：android, linux, makefile, android-source, prebuild

我已经为 arm 编译了 glibc，它与 Android glibc 或仿生 C 不同，因为我编译的 glibc 环境将有助于提供更多的 api。现在我可以在 Android 运行时复制 /system/ 文件夹中的 glibc 环境，并且在执行 chroot 时我可以在 glibc 环境中运行我的程序。

目前我正在分别编译 glibc 和 Android，然后将 glibc 压缩并复制到 Android 模拟器 sdcard 上，然后在 /system 文件夹上解压缩，然后在 /system/glibc 上执行 chroot

我单独编译 glibc，然后将其放在 Android 源代码中的某个位置。现在在编译 Android 源代码时，我应该怎么做才能将 glibc 的整个预构建文件夹结构复制到 /system 文件夹并成为 system.img 的一部分。

有了这个，当我将 system.img 复制到 Android 模拟器并启动它时，glibc 已经存在于 /system 文件夹中，只需要在 glibc 环境中运行应用程序。

**更新**

在按照 Yuri 在他的回答中提到的操作（我创建了 glibc 文件夹并将所有内容复制到其中）之后，当我编译代码时，我得到以下输出。

```
build/core/main.mk:490: * Some files have been added to ALL_PREBUILT.
build/core/main.mk:491: *
build/core/main.mk:492: * ALL_PREBUILT is a deprecated mechanism that
build/core/main.mk:493: * should not be used for new files.
build/core/main.mk:494: * As an alternative, use PRODUCT_COPY_FILES in
build/core/main.mk:495: * the appropriate product definition.
build/core/main.mk:496: * build/target/product/core.mk is the product
build/core/main.mk:497: * definition used in all products.
build/core/main.mk:498: *
build/core/main.mk:499: * unexpected glibc in ALL_PREBUILT
build/core/main.mk:500: *
build/core/main.mk:501: * ALL_PREBUILT contains unexpected files. Stop. 
```

所以我在 build/core/legacy_prebuilts.mk 中添加了 glibc

但后来我得到

```
make: * No rule to make target mkdir', needed byout/target/product/generic/root/glibc'. Stop. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T01:18:59.307

最后我以一种非常不寻常的方式做到了。

我有 3 个选择：

1.  使用 BUILD_PREBUILT 变量，但缺点是你可以为单个文件执行此操作，但我有多个文件并且在特定的 forlder 结构中
2.  使用 PRODUCT_COPY_FILES。但不知何故它对我不起作用 PRODUCT_COPY_FILES 是用于设备的，它对我来说不是新设备。我在模拟器上工作。
3.  使用 Yuri 给出的解决方案，使用 ALL_PREBUILT +=，但正如 Yuri 提到的那样，它适用于 GB，我使用的是 JB 和 ICS，因此不适用于我。

我采用的方法是在 Android.mk 文件中使用 shell 脚本。我使用了一些这样的：假设您有一个名为 my_folder 的文件夹，其中包含整个预建文件夹结构，需要按原样复制到 android out 文件夹中，在**my_folder**中，我创建了**Android.mk**并输入了以下文本：

> ```
> LOCAL_PATH:= $(call my-dir)
> include $(CLEAR_VARS)
> 
> $(shell mkdir -p $(TARGET_OUT)/my_folder/)
> $(shell cp -rf $(LOCAL_PATH)/* `pwd`/$(TARGET_OUT)/my_folder/) 
> ```

这样，我在**my_folder**目录中的所有预建文件和文件夹集都被原样复制到 android out 中的系统文件夹中。

我希望这可以帮助别人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-18T13:29:58.950

PRODUCT_COPY_FILES 必须放在产品 mk 文件 (device/mydevice/..) 中，而不是模块文件 (Android.mk) 中。[这里](https://groups.google.com/forum/#!msg/android-building/h-aaU_7pQTc/hzWgmeGD_VIJ)提到了这一点。

此格式用于复制目录：

```
PRODUCT_COPY_FILES += $(call find-copy-subdir-files,*,vendor/mydir,system/app) 
```

但是，此命令不适用于 apk 文件，并给出错误：

build/core/Makefile：*** PRODUCT_COPY_FILES 中的预构建 apk：vendor/mydir/ray-system-ui-release.apk:system/app/ui-release.apk，请改用 BUILD_PREBUILT！停止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T10:23:43.373

这是“Embedded Android”一书中的一个例子，它可以帮助你。在您的 aosp 项目的根目录中创建一个名为 的文件夹`rootfs-glibc`，将您要复制的代码放在那里，并在那里创建`Android.mk`具有以下内容的文件：

```
LOCAL_PATH:= $(call my-dir)
include $(CLEAR_VARS)
# This part is a hack, we're doing "addprefix" because if we don't,
# this dependency will be stripped out by the build system
GLIBC_ROOTFS := $(addprefix $(TARGET_ROOT_OUT)/, rootfs-glibc)
$(GLIBC_ROOTFS): mkdir -p $(TARGET_ROOT_OUT) cp -af $(TOPDIR)rootfs-glibc/* $(TARGET_ROOT_OUT) rm
# The last command just gets rid of this very .mk since it's copied as-is
ALL_PREBUILT += $(GLIBC_ROOTFS) 
```

有一个说明，这对姜饼来说是正确的。也许在较新版本的 Android 中，make 系统已更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-12T04:34:22.470

考虑使用带有自定义安装步骤的 PHONY_PACKAGE。

与上面的 $(shell cp whatever) 答案不同，这只会在安装步骤中运行，而不是在每个 Make 步骤中运行（这肯定不是你想要的）。

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := some_module
LOCAL_ADDITIONAL_DEPENDENCIES := FORCE # Decide if you need this
LOCAL_POST_INSTALL_CMD = cd $(LOCAL_PATH) && cp -a mystuff $(TARGET_OUT_WHATEVER)
include $(BUILD_PHONY_PACKAGE) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T18:08:30.943

I was thinking if I could do this way 1\. I have both android and glibc compiled separetely. 2\. Once both are compiled, I manually copy the glibc entire folder to /out/target/product/generic/system/glibc/ folder 3\. Then I run "make snod"

Would that work?

# c#-4.0 - 如何从 BitmapImage 创建 WriteableBitmap？

> ID：14718855
> 
> 赞同：7
> 
> 时间：2013-02-05T23:23:37.883
> 
> 标签：c#-4.0, windows-8, windows-runtime, writeablebitmap

我可以从 Assets 中的图片创建 WriteableBitmap。

```
Uri imageUri1 = new Uri("ms-appx:///Assets/sample1.jpg");
WriteableBitmap writeableBmp = await new WriteableBitmap(1, 1).FromContent(imageUri1); 
```

但是，我无法从图片目录创建 WriteableBitmap，（我正在使用 [WinRT XAML Toolkit](http://winrtxamltoolkit.codeplex.com/)）

```
//open image
StorageFolder picturesFolder = KnownFolders.PicturesLibrary;
StorageFile file = await picturesFolder.GetFileAsync("sample2.jpg");
var stream = await file.OpenReadAsync();

//create bitmap
BitmapImage bitmap2 = new BitmapImage();
bitmap2.SetSource();
bitmap2.SetSource(stream);

//create WriteableBitmap, but cannot
WriteableBitmap writeableBmp3 = 
    await WriteableBitmapFromBitmapImageExtension.FromBitmapImage(bitmap2); 
```

这个对吗 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T06:00:59.247

这是一个完全的发明，但它似乎确实有效......

```
// load a jpeg, be sure to have the Pictures Library capability in your manifest
var folder = KnownFolders.PicturesLibrary;
var file = await folder.GetFileAsync("test.jpg");
var data = await FileIO.ReadBufferAsync(file);

// create a stream from the file
var ms = new InMemoryRandomAccessStream();
var dw = new Windows.Storage.Streams.DataWriter(ms);
dw.WriteBuffer(data);
await dw.StoreAsync();
ms.Seek(0);

// find out how big the image is, don't need this if you already know
var bm = new BitmapImage();
await bm.SetSourceAsync(ms);

// create a writable bitmap of the right size
var wb = new WriteableBitmap(bm.PixelWidth, bm.PixelHeight);
ms.Seek(0);

// load the writable bitpamp from the stream
await wb.SetSourceAsync(ms); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-06T07:22:23.300

正如 Filip 所说，这是将图像读取到 WriteableBitmap 的方式：

```
StorageFile imageFile = ...

WriteableBitmap writeableBitmap = null;
using (IRandomAccessStream imageStream = await imageFile.OpenReadAsync())
{
   BitmapDecoder bitmapDecoder = await BitmapDecoder.CreateAsync(
      imageStream);

   BitmapTransform dummyTransform = new BitmapTransform();
   PixelDataProvider pixelDataProvider =
      await bitmapDecoder.GetPixelDataAsync(BitmapPixelFormat.Bgra8, 
      BitmapAlphaMode.Premultiplied, dummyTransform, 
      ExifOrientationMode.RespectExifOrientation,
      ColorManagementMode.ColorManageToSRgb);
   byte[] pixelData = pixelDataProvider.DetachPixelData();

   writeableBitmap = new WriteableBitmap(
      (int)bitmapDecoder.OrientedPixelWidth,
      (int)bitmapDecoder.OrientedPixelHeight);
   using (Stream pixelStream = writeableBitmap.PixelBuffer.AsStream())
   {
      await pixelStream.WriteAsync(pixelData, 0, pixelData.Length);
   }
} 
```

请注意，我使用的是可写位图使用的像素格式和 alpha 模式，并且我通过了 .

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-06T02:10:49.340

`WriteableBitmapFromBitmapImageExtension.FromBitmapImage()` works by using the original Uri used to load `BitmapImage` and IIRC it only works with `BitmapImage`s from the appx. In your case there isn't even a Uri since loading from Pictures folder can only be done by loading from stream, so your options from the fastest to slowest (I think) are:

1.  Open the image as `WriteableBitmap` from the get go, so that you don't need to reopen it or copy bits around.
2.  If you need to have two copies - open it as `WriteableBitmap` and then create a new `WriteableBitmap` of same size and copy the pixel buffer.
3.  If you need to have two copies - track the path used to open the first bitmap and then create a new `WriteableBitmap` by loading it from the same file as the original one.

I think option 2 might be faster than option 3 since you avoid decoding a compressed image twice.

# regex - 有条件地删除分隔文件中行的一部分

> ID：14718859
> 
> 赞同：0
> 
> 时间：2013-02-05T23:23:49.997
> 
> 标签：regex, sed

我有一个 ~ 分隔的文本文件，其中包含大约 20 个可为空的列。

如果满足以下条件，我正在尝试使用 SED（来自 cygwin）“清除”第 11 列中的值...

1.  第 3 列为零 (0)

2.  第 11 列的日期格式为 mm/dd/yy（我并不担心它是否是有效日期）

这就是我正在尝试的...

```
s/\([^~]*~[^~]*~0~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~\)\(\d{2}\/\d{2}\/\d{2}~\)\(.*$\)/\1~\3/ 
```

这是文件中的一个示例：

```
Test A~7~1~~~~72742050~~~Z370~10/25/11~~~0~8.58563698~6.40910452~4.59198764~3.18239469~1.72955975~.23345372~-1.30891113~-2.89971394~1~0
Test B~7~0~~~~72742060~~~Z351~05/15/12~05/14/12~~0~18.88910518~12.69425528~9.96182381~6.76077612~6.76077612~3.86279298~.22449489~-.91021010~0~0
Test C~7~0~~~~72742060~~~Z352~06/12/12~ABC~~0~20.60845679~17.54889351~15.52912556~12.43279217~12.43279217~10.32033576~9.35296144~8.09245899~0~0 
```

...这就是我期望得到的回报

```
Test A~7~1~~~~72742050~~~Z370~10/25/11~~~0~8.58563698~6.40910452~4.59198764~3.18239469~1.72955975~.23345372~-1.30891113~-2.89971394~1~0
Test B~7~0~~~~72742060~~~Z351~05/15/12~~~0~18.88910518~12.69425528~9.96182381~6.76077612~6.76077612~3.86279298~.22449489~-.91021010~0~0
Test C~7~0~~~~72742060~~~Z352~06/12/12~ABC~~0~20.60845679~17.54889351~15.52912556~12.43279217~12.43279217~10.32033576~9.35296144~8.09245899~0~0 
```

但文件通过第 2 行完全不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:45:48.310

您正在尝试替换第 12 列而不是第 11 列：

```
\([^~]*~[^~]*~0~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~\)\(\d{2}\/\d{2}\/\d{2}~\)\(.*$\)
    1     2   3   4     5     6     7     8     9    10    11              12 
```

如果只是`[^~]*~`从第一组的末尾删除一个并不能解决它，那可能是因为您的 sed 版本不支持任何一个`\d`或重复 with `{2}`（尽管转义大括号可能会解决这个问题）。

这是一个应该在任何地方都可以使用的版本，它将每个替换`\d{2}`为`[0-9][0-9]`（并修复了上面提到的不正确的列问题）：

```
s/\([^~]*~[^~]*~0~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~[^~]*~\)\([0-9][0-9]\/[0-9][0-9]\/[0-9][0-9]~\)\(.*$\)/\1~\3/ 
```

# php - 检查 cookie 和会话值

> ID：14718861
> 
> 赞同：-1
> 
> 时间：2013-02-05T23:23:54.260
> 
> 标签：php, model-view-controller, multilingual, gettext

我正在开发一个多语言网站，现在我遇到了问题。当 $_GET['setlang'] 为空时，语言设置为 en_US，即使我之前打开了 ?setlang=pl（工作正常 - 语言正在改变）

```
empty($_GET['setlang']) ? $_GET['setlang'] = '' : $_GET['setlang'];
    switch ($_GET['setlang']) {
        case 'en':
            $lang = 'en_US';
            putenv('LC_ALL='.$lang);
            setlocale(LC_ALL, $lang.'.UTF8');
            setcookie('lang', $lang, time()+60*60*24*365);
            $_SESSION['lang'] = $lang;
            $_config['lang'] = $lang;
            break;

        case 'pl':
            $lang = 'pl_PL';
            putenv('LC_ALL='.$lang);
            setlocale(LC_ALL, $lang.'.UTF8');
            setcookie('lang', $lang, time()+60*60*24*365);
            $_SESSION['lang'] = $lang;
            $_config['lang'] = $lang;
            break;

        default:
            if((isset($_SESSION['lang']) && $_SESSION['lang'] ='en_US') || (isset($_COOKIE['lang']) && $_COOKIE['lang'] = 'en_US')){
                $lang = 'en_US';
                putenv('LC_ALL='.$lang);
                setlocale(LC_ALL, $lang.'.UTF8');
             }

            else{
                $lang = 'pl_PL';
                putenv('LC_ALL='.$lang);
                setlocale(LC_ALL, $lang.'.UTF8');
             }

            $_config['lang'] = $lang;
            break;
    }

    $my_name = 'default';

    bindtextdomain($my_name,'./locale');
    textdomain($my_name); 
```

运行 ?setlang=pl 操作后，我无法让此脚本将语言更改为 pl_PL。当此 get 为空时，cookie 值将更改为 en_US ；/

我应该如何检查它并避免这个问题？

我也在使用 MVC。这段代码似乎是正确的，还是我应该将一些代码放入模型而不是控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:42:38.983

`if((isset($_SESSION['lang']) && $_SESSION['lang'] =='en_US') || (isset($_COOKIE['lang']) && $_COOKIE['lang'] == 'en_US'))`

`==`与not这种方式进行比较，`=`您可以分配or是`'en_US'`什么。`$_SESSION["lang"]``$_COOKIE["lang"]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:39:23.933

你开始会话了吗？如果没有，则无法设置或查询会话变量。

使用 session_start();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:53:49.847

```
$lang = "";

// Check if lang cookie is set
if(isset($_COOKIE['lang']))
{
    $lang = $_COOKIE['lang'];
}
// Cookie is not set
else
{
// Get language GET variable
    $set_lang = (empty($_GET['setlang'])) ? '' : $_GET['setlang'];

    switch($set_lang)
    {
        case 'en':
            $lang = "en_US";
        break;

        case 'pl':
            $lang = "pl_PL";
        break;

        default:
            $lang = "en_US";
        break;
    }

    // Set language cookie
    setcookie('lang', $lang, time()+60*60*24*365);
}

// Set locale
putenv('LC_ALL=' . $lang);
setlocale(LC_ALL, $lang . ".UTF8"); 
```

# android - 使用 sprite sheet 和 Matrix 绘制到 Canvas

> ID：14718862
> 
> 赞同：2
> 
> 时间：2013-02-05T23:23:56.463
> 
> 标签：android, matrix, bitmap, sprite-sheet

在我的应用程序中，我希望我的精灵根据它们前进的方向旋转，这已经用矩阵很好地完成了。

然而，现在在尝试实现一些精灵动画之后，我意识到没有 Canvas.drawBitmap(...) 方法采用矩阵并允许剪切精灵表。

有没有办法在我必须绘制它们之前将精灵表剪辑成单独的位图，即在我的自定义 SurfaceView 的 onCreate 中，我可以通过剪辑表来创建一个位图数组来包含我的精灵吗？

谢谢安迪

PS我知道旋转画布来实现旋转图像，但是看到我所有的代码都设置好了并且工作得很好，我不想改变它

# php - 在 Apache 启动/重启时在后台运行 PHP 脚本（Windows Server）

> ID：14718865
> 
> 赞同：7
> 
> 时间：2013-02-05T23:24:04.717
> 
> 标签：php, windows, apache, windows-server-2008-r2

我已经按照本手册中的说明在 Windows Server 2008 上安装了带有 PHP 5.4 的 Apache 2.4： [Apache 安装手册](http://lifeofageekadmin.com/how-install-apache-2-4-php-5-4-and-mysql-5-5-21-on-windows-7/)。Apache 现在作为服务运行。

我的应用程序需要一个 php websocket 脚本才能在后台运行。我正在手动运行它：

```
php myscript.php 
```

问题是：有没有办法在系统（apache）重新启动时自动启动后台脚本？

我找到了以下[主题](https://stackoverflow.com/questions/2992938/is-it-possible-to-launch-a-php-script-at-apache-startup)，但我不知道在哪里可以找到适用于 Windows 的 apache 启动脚本。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-01-21T22:24:49.950

我想出了一个解决方案:)

*   **创建**一个指向 Apache 目录的环境变量

    ```
    APACHE_HOME = C:/PATH/TO_APACHE 
    ```

    *   **重命名** `%APACHE_HOME%\bin\httpd.exe`为`%APACHE_HOME%\bin\httpdVendor.exe`*   **创建**一个批处理文件并输入以下代码：

    ```
    php myscript.php
    %APACHE_HOME%\bin\httpdVendor.exe -k runservice
    exit 0 
    ```

    *   **下载/安装**免费软件[BatToExeConverter](http://battoexeconverter.com/) (next, next, ...)*   **打开**已安装的转换器并**打开**新创建的批处理文件*   **点击**按钮**Build EXE**（让默认配置）*   **保存**文件：`%APACHE_HOME%\bin\httpd.exe`*   **启动**您的 Apache 服务器

测试：Windows 7、Apache 2.4、Advanced Bat to Exe Converter 2.92

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-22T17:38:09.210

使用内置的 Windows 任务计划程序触发`.bat`脚本，该脚本使用定义的 url 调用 curl。

1.  [从http://curl.haxx.se/download.html](http://curl.haxx.se/download.html)下载 curl并将 curl.exe 解压到任意目录，但我们将使用`c:\backgroundtasks`
2.  根据您的需要调整以下脚本：

    CDC：\

    cd c:\backgroundtasks

    curl [http://localhost/path/to/script.php](http://localhost/path/to/script.php)

    出口

3.  将任务计划程序配置为作为基本任务运行：

    *   常规选项卡 - 作为系统帐户（在您未登录服务器时运行）
    *   触发器选项卡 - 调整频率
    *   设置选项卡 - 在底部设置`If the task is already running...`为`Stop the existing instance`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-27T18:19:07.097

这里最好的方法是使用 Windows 服务依赖项。

使用最后一行创建一个`php-websocket-server.cmd`包含任何必要环境设置的文件（例如，更改为目录、设置 PATH 等）：

```
php myscript.php 
```

安装[Windows Server Resource Kit Tools](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=17657)，以获取`srvany`和`instsrv`创建[用户定义的服务](http://support.microsoft.com/kb/137890/en-us)。请记下安装路径，因为您将在下一步中需要它。

打开`cmd`外壳并运行：

```
<path_to_resource_kit>\instsrv PHPWebSocketServer <path_to_resource_kit>\srvany.exe 
```

接下来，创建一个`php-websocket-server.reg`包含以下内容的文件（针对您的环境进行更新）：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PHPWebSocketServer\Parameters]
"Application"="c:\\path\\to\\php-websocket-server.cmd" 
```

通过双击或导入`regedit /s php-websocket-server.reg`

回到你的`cmd`外壳：

```
sc config Apache2.4 depend= PHPWebSocketServer 
```

使 Apache2.4* 服务依赖于您的 php 服务。现在，当 Apache 启动时，将首先启动 php 服务。同样，如果您停止 php 服务，Apache 也会随之停止。

^(*howto 指示该服务名为“Apache2.4”，但您可能需要在安装中进行验证。)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-23T13:46:45.230

我找到了另一个答案 C:\wamp\scripts\wampserver.lib.php 这个文件每次你的 wamp 启动时都会运行

包括该文件的文件路径`include_once("file_path");`及其完成。这是您想要的完美解决方案

享受！！！！！！！！！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-27T09:06:47.877

尽管 Halayem Anis 的解决方案非常有创意，但我认为重要的是要注意，您永远无法确定`PHP`脚本会在后台继续运行。因此，如果您选择在“Apache start”上启动脚本，那么您可能会经常结束操作重置 Apache，重启脚本很简单。

我认为这就是您提出这个问题的方式，因为在普通服务器上，您永远不必触摸 Apache 重置按钮。它在系统启动时启动，然后运行。如果是这种情况，您可以`php myscript.php`在启动时简单地运行您的命令。

考虑到无法确保脚本继续运行，我将使用不同的方法，检查它是否正在运行，如果没有，则重新启动它。

所以第一步是让跟踪脚本是否正在运行成为可能。我会采用一种简单的方法，即`myscript.php`每 5 秒左右将一个字节写入文件。这样我可以使用文件的最后修改时间来查看它是否仍在运行，因为`last modified time + 5 seconds < now == not running`.

您还可以每 5 秒左右将上次访问时间存储在数据库中。如果您有大量流量，可能会比访问文件稍快一些。

第二部分是让每个请求检查脚本是否正在运行。对于这两项工作，我将使用 为`PHP.ini`每个请求添加一个 php 脚本。您可以使用[auto_append_file](http://php.net/auto-append-file)选项来完成。

这个前置脚本将像这样工作：

```
<?php
$filename = 'checkonline.txt';
$cmd = "php myscript.php";
if (filemtime($filename)+5<time()) {

  //run in background without freezing php
  //based on code posted on PHP exec manual, linked below
  if (substr(php_uname(), 0, 7) == "Windows"){
    pclose(popen("start /B ". $cmd, "r")); 
  }
  else {
    exec($cmd . " > /dev/null &");  
  } 
}
?> 
```

确保检查[filemtime](http://php.net/manual/en/function.filemtime.php)和[exec](http://php.net/manual/en/function.exec.php)的工作方式以及您需要记住的内容。它们在 Windows/*nix 上的工作方式略有不同。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-06T08:07:09.033

作为服务运行时，您将没有启动脚本。

执行一些允许将其他程序作为服务运行的服务实现，然后使新服务（正在运行您的脚本）成为 Apache 服务的依赖项。但是，这不会在 apache 重新启动时重新启动脚本。

[一种使用 SrvStart 的可能解决方案](http://www.howtogeek.com/50786/using-srvstart-to-run-any-application-as-a-windows-service/)，[另一种使用 ServiceEx](http://serviceex.com/)的解决方案。

或许不要将Apache安装为服务，然后编辑启动/重启脚本，并使用上述方法将Apache作为服务运行（而不是使用Apache自己的安装程序）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-23T06:44:47.120

创建 bat 文件，例如 'myphp.bat' 包含`path/php myscript.php`. 如果不是路径，请包括正确的 php 路径。

创建一个 bat 文件，例如 runmyphp.bat 包含

> AT 00:00 /every:M,T,W,Th,F "cmd /c /path/myphp.bat"，再次包括正确的路径。

然后使用资源管理器将runmyphp拖到启动文件夹中，这样它就会一直在系统启动时运行。

谷歌“windows at command”或“windows cron”以获得“at”命令的所有正确语法，但您目前可以[在此处](https://technet.microsoft.com/en-us/library/bb726974.aspx)找到详细说明。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-26T03:44:58.970

将所有需要的进程打包在一个批处理文件中，并使用[RunAsService](https://stackoverflow.com/questions/415409/run-batch-file-as-a-windows-service) 通过一些调整，您可以确保您的服务在 Apache 之前启动。

# javascript - 如何从外部 HTML 执行 Javascript

> ID：14718872
> 
> 赞同：0
> 
> 时间：2013-02-05T23:24:41.827
> 
> 标签：javascript, jquery, html

如果我有一个执行代码的按钮

`$('#main').load('welcome.html');`

在`welcome.html`我有一个执行代码的按钮

`$('#main').load('otherpage.html');`

无论该函数是在父文件的 HTML 代码还是子文件的 HTML 代码上，Javascript 都不会执行。

如何让 Javascript 函数从外部加载的 HTML 文件中工作？

**编辑** 这里有更多的样本......

主页：

```
<body>
    <div id="main"></div>
</body>

<script>
    document.onLoad(){
        $('#main').load('welcome.html');
    }

    function show(file){
        $('#main').load(file+'.html');
    }
</script> 
```

`welcome.html`页：

```
<a href="javascript:show(test)">Test</a> 
```

...但是，当单击“测试”按钮时，`test.html`不会将其加载到主 div 中。

**编辑 2**

这是当前状态和问题所在 - 确切地说。

[我已将代码的骨架上传到 PasteBin](http://pastebin.com/XAjbFFnk)。

单击“网格”按钮时，内容会发生变化，页脚也会发生变化。

但是，具有基于 Javascript 的 URL 的页脚出现了错误：

`Uncaught SyntaxError: Unexpected token ILLEGAL`

...尝试访问该`1i.html`页面时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:50:22.697

`test`变量和`'test'`字符串之间有区别：

```
<a href="javascript:show(test)">Test</a> 
```

大概应该是：

```
<a href="javascript:void show('test')">Test</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:47:08.897

检查[jQuery.live()](http://api.jquery.com/live/)和[jQuery.on()](http://api.jquery.com/on/)。

也许您的事件处理程序是错误的。当您通过 load() 或 ajax() 导入新标记时，您必须从新文档初始化处理程序。最简单的方法是使用 jQuery.on 或 jQuery.live() 而不是 jQuery.click()。

```
$('MYBUTTON').live('click', function(){
    $('#main').load('your_url.html')
}) 
```

或使用回调函数（重新）初始化按钮事件。

更好的解决方案是：只需将 target_url 添加到按钮 rel 属性...

```
<button rel="YOUR_URL.html">Open Page</button>

$('button[rel]').live('click', function(){
    $('#main').load($(this).attr('rel'));
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T23:41:47.567

重要的是要了解当通过 AJAX 将脚本加载到主页已经通过的页面时`document.ready`。因此，您加载的任何代码都会立即触发。

如果您加载的代码在它引用的 html 之前，它会在触发时找不到该 html。

将代码放在远程页面中的 html 之后将解决此问题

# silverlight - 打印包含图像的用户控件？

> ID：14718873
> 
> 赞同：0
> 
> 时间：2013-02-05T23:24:43.280
> 
> 标签：silverlight, xaml, printing, silverlight-4.0

我实现了[此页面](http://www.silverlightshow.net/items/Advanced-printing-in-Silverlight-4.aspx)上详述的打印机功能，我想我偶然发现了**System.Windows.Printing**的打印行为中的一个错误。我刚刚在布局中添加了一个**图像，如下所示：**

```
<Grid x:Name="documentRoot">
    <Grid.RowDefinitions>
        <RowDefinition Height="100" />
        <RowDefinition Height="25"/>
        <RowDefinition />
        <RowDefinition Height="25"/>
    </Grid.RowDefinitions>
    <Image x:Name="logo" Source="/MyProject;component/Image/logo.jpg" Grid.Row="0" Width="265" Height="51" HorizontalAlignment="Left" Margin="0,0,0,15" VerticalAlignment="Bottom" />
    <TextBlock x:Name="headerTextBlock" Grid.Row="1" HorizontalAlignment="Center" />
    <TextBlock x:Name="bodyTextBlock" Grid.Row="2" TextWrapping="Wrap" />
    <TextBlock x:Name="footerTextBlock" HorizontalAlignment="Center" Grid.Row="3"/>
</Grid> 
```

这段代码发生的情况是，每当应用程序启动后第一次需要打印多个页面时，它将跳过前 2 个页面，只打印其余页面。如果您尝试再次打印相同的内容，它将按预期很好地打印页面，并且永远打印，直到您重新启动应用程序。

请注意，它与添加的**RowDefinition 无关**，因为我试图仅删除**Image**元素并且它工作得很好。只有当我将**Image**元素放在我的 UserControl 中时，打印机才会开始发疯。

所以我假设这是微软多年来不会费心修复的另一个“小”错误，例如我在早期不得不努力解决的 Powershell 中的[这个或其他一些非工作标志。](https://stackoverflow.com/questions/7249263/ibeam-caret-on-contextmenu-of-richtextbox)

话虽这么说，我很乐意在这个问题上被告知错误。但是，如果我不是，是否有人对解决方法有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T14:40:45.343

[找到了解决我的问题的方法：使用此网站](http://www.iaci.ro/2008/06/29/how-to-convert-anything-to-xaml/)将图像文件转换为 XAML 画布，然后复制粘贴整个**画布**代码而不是我的 PrintPage.xaml 文件中的**图像似乎可以解决问题。**尽管这非常可怕。我知道。

# java - 是否有与传输无关的 java tls 服务器实现？

> ID：14718874
> 
> 赞同：0
> 
> 时间：2013-02-05T23:24:45.410
> 
> 标签：java, ssl

我正在尝试通过纯文本通信通道（我考虑过使用 base64）来隧道 tls，但我似乎找不到不使用 SSLSocket 的 tls 服务器示例。

对于 tls 客户端，我能够找到与传输无关的充气城堡 TlsProtocolHandler，因为它只使用输入和输出流，但是对于服务器 tls 实现，我找不到任何类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:20:10.370

*   使用`SSLSocket`：

    您当然可以实现自己[`Socket`](http://docs.oracle.com/javase/7/docs/api/java/net/Socket.html)的不基于 TCP 的。例如，有[Unix 套接字实现](https://stackoverflow.com/q/170600/372643)。一旦你有它为你自己的运输，[`SSLSocketFactory.createSocket(Socket, ...)`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSocketFactory.html#createSocket(java.net.Socket,%20java.lang.String,%20int,%20boolean))可以建立一个`SSLSocket`在你自己的之上`Socket`。

*   使用`SSLEngine`（有点复杂）：

    [`SSLEngine.wrap`（和`unwrap`）](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLEngine.html)在`ByteBuffer`s 上工作。这些缓冲区可能来自您自己的通信渠道。

您可能遇到的困难之一是将证书的概念映射到您的自定义传输。证书（或更一般地证明服务器的身份）对于 SSL/TLS 通道的安全性至关重要，以防止 MITM 攻击。身份验证需要检查证书是否受信任，并且它的身份是否与您尝试访问的实体相对应（主机名验证）。默认情况下不启用主机名验证，但是如果您没有主机名，则无论如何您都需要找到类似的东西（例如，这可能是 unix 套接字的问题，尽管在这种情况下使用 SSL 可能不会反正感觉）。

# java - Scala 2.9.1 问题？=> MappingException：将属性 bitmap$init$0 设置为 null

> ID：14718876
> 
> 赞同：0
> 
> 时间：2013-02-05T23:25:00.597
> 
> 标签：java, scala, playframework-2.0, spring-data, spring-data-neo4j

我使用 scala 2.9.1、Play Framework 2.0.4、Spring 3.2.0、Spring Data 2.1.0 和 neo4j 1.8。

我有这个模型对象：

```
package models

import java.lang.{String, Long}
import org.springframework.data.neo4j.annotation.{Indexed, NodeEntity, GraphId}

    @NodeEntity
    class Article(_title: String) {

      @GraphId var id: Long = _     //causes the error !!

      @Indexed val title: String = _title

      def this() {
        this("no title")
      }

      override def hashCode(): Int = {
        41 * title.hashCode
      }

      override def equals(other: Any): Boolean = {
        other match {
          case that: Article => (that canEqual this) && ((this.id == that.id) && (this.title == that.title))
          case _ => false
        }
      }

      def canEqual(other: Any) = other.isInstanceOf[Article]
    } 
```

之前，我使用 Scala 2.10 和 Play Framework 2.1-RC2 和相同版本的 Spring Data，没有发生任何不好的事情，此后我再也没有接触过代码（这是一个个人项目）。

我有这个错误：

```
MappingException: Setting property `bitmap$init$0` to null on models.Article@466b9021 
```

我发现这个类似[的帖子](https://stackoverflow.com/questions/10760970/scala-hibernate-jpa-ignore-autogenerated-bitmapinit0-mapping/13327497#13327497)解释（尤其是在评论中）似乎是 2.10.0 的前 scala 版本导致了这个问题。

有没有人遇到过这个问题？我该如何解决？

# c++ - 类中的 Fstream 初始化 - 检查文件是否打开

> ID：14718880
> 
> 赞同：1
> 
> 时间：2013-02-05T23:25:04.803
> 
> 标签：c++, class, exception-handling, initialization, fstream

例子：

//头文件

```
class Example
{
    private:
            fstream InputObject;  

    public:
            Example();  

} 
```

//实现文件

```
Example::Example():InputObject("file_name.txt", ios::in) {} 
```

从我迄今为止从类似问题中读到的内容来看，在“旧”版本的 C++ 中，初始化类中的 fstream 对象的唯一方法是通过上面显示的成员列表初始化来实现。

问题：
如果这确实是在类中初始化 fstream 对象的“唯一”方式，那么如果文件无法打开，我们该怎么办？

通常我会通过检查运行 fstream 对象以确保它正确打开，但在这种情况下这似乎是不可能的。另外，即使我可以，如果第一次没有这样做，我怎么能重新初始化对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-22T07:29:09.340

```
#define WIN32_LEAN_AND_MEAN // This makes it so it doesn't look through libs that are not included when running

#include <fstream> //To Read write to files, to be able to
#include <iostream> // The basic stuff, cout, cin, etc.
using namespace std; // the capability of typing cout instead of std::cout
int main() // our main loop
{
fstream InputObject; // declaring InputObject as something that can write to a file
if(!Inputobject.open("File Name Here") // if it cant open the file
{
cout << "File not Open" << endl; // then write to console, " File not Open"
}

return 0;
system("pause");
} 
```

你想知道文件是否打开，所以使用 ! 在打开文件的功能之前意味着，未打开，因此带有！InputObject.open 的 if 语句将检查它是否未打开，如果是，请执行某些操作，因此 cout << "File is not open" 会告诉你它是否打开。

# xcode - 文件在 xcode 中列出了两次

> ID：14718881
> 
> 赞同：4
> 
> 时间：2013-02-05T23:25:06.970
> 
> 标签：xcode, github, repository

我正在 Xcode 中开发一个 iPhone 项目，我使用 github 作为存储库。最近，在从仓库进行了一系列的推拉之后，项目中的一些文件在 Xcode 中被列出了两次。我的意思是，在 Xcode 的左侧面板中，它显示了项目中的所有文件，其中一些文件被列出了两次。

我做了一些实验，重复的文件似乎只是对同一个基础文件的引用。如果我更改`ViewController.h`相同的更改，则会出现在其他列出的`ViewController.h`文件中。同样，如果我删除列出的事件，两个副本都会消失。

我尝试重新启动 Xcode，删除派生数据并重新克隆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T04:29:33.803

Xcode 项目浏览器只是文件和/或文件夹链接的集合。如果您右键单击每个实例`ViewController.h`并选择“在 Finder 中显示”，它们可能都指向您计算机上的同一个真实文件。

如果是这种情况，您可以安全地从 Xcode 中删除其中一个，而不会产生任何不良影响。只需确保执行默认的“删除参考”而不是“移至废纸篓”。

# ruby-on-rails-3 - Ruby on Rails 异常处理基础知识

> ID：14718886
> 
> 赞同：1
> 
> 时间：2013-02-05T23:25:34.100
> 
> 标签：ruby-on-rails-3, exception-handling, exception-notification

我有一个 Rails 3 应用程序，它使用 exception_notification gem 发送有关异常的电子邮件。

我还想在发生异常时向用户显示特定的错误消息，但是通过捕获通用异常，因为我不确定可能发生的所有异常。我在想这样做的方法是从异常中拯救出来，然后引发一个自定义异常。这样我仍然会收到有关异常的电子邮件，并且用户可以看到自定义异常的错误页面。

这听起来像 Rails 3 的做事方式吗？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T01:08:13.030

我想不是。

正如瑞恩戴维斯所说

> 不要拯救异常。曾经。否则我会刺伤你。

有关该声明的更多信息在[这里](https://stackoverflow.com/questions/10048173/why-is-it-bad-style-to-rescue-exception-e-in-ruby)。

Rails 3.2 在两个中间件中进行异常处理：

*   ActionDispatch::ShowExceptions
*   ActionDispatch::DebugExceptions

你可以通过运行来检查那个

```
$ rake middleware 
```

### ActionDispatch::ShowExceptions [[源](https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/show_exceptions.rb)]

在生产中用于呈现异常页面。

### ActionDispatch::DebugExceptions [[源](https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/debug_exceptions.rb)]

在开发环境中用于在发生异常时呈现详细的堆栈跟踪。停止中间件调用链并呈现堆栈跟踪，如果`action_dispatch.show_detailed_exceptions`更准确的话。

* * *

所以用这个中间件做一些正常的事情的最简单的方法是猴子修补 的`call`方法`ActionDispatch::DebugExceptions`，做你需要做的所有事情，然后调用原始方法。

但是，更好的方法是在这两者之间包含您自己的中间件。在其中，您会将调用包装在救援块中并进行自定义处理。

我是[Airbrake](https://airbrake.io)的维护者，这正是[我们现在正在做的事情](https://github.com/airbrake/airbrake/blob/master/lib/airbrake/rails/middleware.rb)。

您可能还想检查[Errbit](https://github.com/errbit/errbit)，这是自托管的替代方案。

# jquery - AnytingSlider expand and resizecontents 一起将幻灯片高度降低到 2px

> ID：14718891
> 
> 赞同：0
> 
> 时间：2013-02-05T23:25:47.597
> 
> 标签：jquery, anythingslider

如果我尝试同时使用 AnytingSlider expand 和 resizecontents 它会将幻灯片高度降低到 2px 没有*resizecontent 真正的*幻灯片正确显示。我在 CSS 中设置了高度，并查看了 js，但不知道为什么会这样

CSS

```
#slider1 {
    width: 700px;
    height: 280px;
    list-style: none;
    overflow-y: auto;
    overflow-x: hidden;
}

body
....
<div class="box">
  <div id="banner-full">
    <div id="page-wrap">
       <div id="hover">
         //...some hover over slider...//
       </div>
       <div class="anythingSlider anythingSlider-metallic activeSlider" style="width: 617px; height: 2px;">
          <div class="anythingWindow" style="width: 100%; height: 100%;">
            <ul id="slider1" class="anythingBase horizontal" style="width: 3085px; left: -617px;">
              <li class="cloned panel" style="width: 617px; height: 2px;">
              <li class="panel activePage" style="width: 617px; height: 2px;">
              <li class="panel" style="width: 617px; height: 2px;">
              <li class="panel" style="width: 617px; height: 2px;">
              <li class="cloned panel" style="width: 617px; height: 2px;">
            </ul>
          </div>
        <div class="anythingControls" style="display: block;">
            //...some controls html...//
        </div>
      </div>
    </div>
  </div>
</div>
.... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T23:01:37.310

如果您使用该`expand`选项，

```
$('#slider').anythingSlider({
    expand: true
}); 
```

您需要将滑块包装在不是文档正文（[demo](http://jsfiddle.net/Mottie/ycUB6/4088/)）的元素中：

```
<div class="wrapper">
    <ul id="slider">
        <li><img src="http://placekitten.com/500/200" alt="" /></li>
        <li><img src="http://placehold.it/500x200" alt="" /></li>
        <li><img src="http://placebear.com/500/200" alt="" /></li>
        <li><img src="http://lorempixel.com/500/200" alt="" /></li>
        <li><img src="http://placedog.com/500/200" alt="" /></li>
    </ul>
</div> 
```

现在剩下的就是定义 的大小`.wrapper`：

```
.wrapper {
    width: 80%;
    height: 200px;
    margin: 20px auto;
} 
```

# javascript - getElementById javascript 未定义

> ID：14718895
> 
> 赞同：2
> 
> 时间：2013-02-05T23:26:17.077
> 
> 标签：javascript, greasemonkey, getelementbyid

我目前正在为 Greasemonkey 编写这个脚本。此脚本的目标是从 MeetMe.com 网站的提要中删除特定用户的帖子。
我的代码是：

```
// ==UserScript==
// @name        PostBeGone
// @namespace   TestingNameSpace
// @include     http://www.meetme.com/apps/home
// @version     1
// ==/UserScript==
var posterId;
var blacklist = new Array();
var toDelete;
blacklist [0] = 45112400; //These are just random peoples' user Id's that I am
blacklist [1] = 9649820;  //using to test this script
blacklist [2] = 55907221;
blacklist [3] = 56788411;
window.onload = function checkAndRemove () {
    var children = document.getElementById('feedReloadArea').childnodes;
    alert(children); //alert says "undefined"
    i = 0;
    While (i < children.length) 
    {
        posterId = children[i].getAttribute('data-poster');
        toDelete = null;

        i2 = 0;
        while (i2 < blacklist.length)
        {
            if (posterId == blacklist[i2])
            {
                toDelete = children[i];
                break;
            }
            i2++;
        }
        if (toDelete != null)
        {
            toDelete.parentNode.removeChild(toDelete);
        }
        i++;
    }
} 
```

使用具有多次执行的各种警报，我知道代码执行到我拥有的点`alert(children)`，即返回`undefined`。

在加入`window.onload =`我的脚本之前，在搜索谷歌和这个网站寻找答案时，我读了很多地方，问题可能是脚本可能在页面加载之前尝试执行，所以我添加了`window.onload =`. 但是，问题仍然存在，我找不到任何与我的问题相似的问题来理解它。

要查看元素的 html 代码，我一直在使用 Firefox 的“检查元素”功能。页面上可能有帮助的 html 代码片段是：

```
<div id="feedReloadArea" style="display: block;">  
     <div class="feedItemArea feedSpotlightHighlight" data-comment-maintenance="0" data-created-at="1360098729.05091" data-numeric-reference-id="" data-reference-uuid="0d76957f-2f64-4654-99ea-f67974116b32" data-entity="StatusUpdate" data-poster="59538173" data-uuid="b9e85465-5b91-4b5c-a443-c4e37d716481"></div><div class="feedItemArea" data-comment-maintenance="0" data-created-at="1360103761.624714" data-numeric-reference-id="" data-reference-uuid="c2c201ca-a391-4fff-aec2-9823a3e90815" data-entity="StatusUpdate" data-poster="45508368" data-uuid="11149a32-38cf-4919-b081-0bd39bdc49eb"></div>
     <div class="feedItemArea" data-comment-maintenance="0" data-created-at="1360103737.756343" data-numeric-reference-id="" data-reference-uuid="997824a2-994c-467f-bfbe-aa4beb1e402f" data-entity="StatusUpdate" data-poster="38033716" data-uuid="bc075882-771c-4ee2-ad28-dbf21fbf3bd3"></div> 
```

澄清一下，这只是 HTML 代码的一部分。提要上有许多这样的类，因为每个类都代表一个用户的帖子。此外，每个类中都有多个，例如用户的链接和用户的个人资料图片。但是，我想删除与黑名单上的任何海报 ID 相同的完整 feedItemArea 类。

我希望我已经足够清晰和简洁，以便于帮助，但如果需要任何其他信息来帮助我，请告诉我，我会发布它。我的问题是是什么导致`children`的`undefined`？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:28:27.307

JavaScript 区分大小写，它[`childNodes`](https://developer.mozilla.org/en-US/docs/DOM/Node.childNodes)不是`childnodes`. 顺便说一句，由于您可能只想迭代元素节点（没有文本节点、注释等），请使用[`children`collection](https://developer.mozilla.org/en-US/docs/DOM/Element.children)。此外，您几乎不需要`window.onload`, 因为 GreaseMonkey 脚本默认[在 DOMready上执行。](http://wiki.greasespot.net/DOMContentLoaded)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:29:06.370

大写！

```
var children = document.getElementById('feedReloadArea').child ~~n~~节点；
```

# c# - Windows 任务计划程序 - 上次运行时间和上次运行结果

> ID：14718898
> 
> 赞同：1
> 
> 时间：2013-02-05T23:26:23.183
> 
> 标签：c#, scheduled-tasks

我们在各种服务器上运行了几个预定的作业。我正在寻找是否可以做一些事情来查看所有计划的任务以及最后一次运行时间和最后一次运行结果。

我查看了这篇[CodeProject 文章](http://www.codeproject.com/Articles/21418/Scheduled-Tasks-Web-Service)，但找不到任何有关上次运行详细信息的信息。

另外，我查看了位于

```
C:\Windows\System32\Tasks 
```

使用此文件，我可以获得作业，但不能获得上次运行的详细信息。

我想知道我应该如何继续从远程计算机获取作业以及它们的最后运行详细信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:56:49.493

您可能想尝试调度程序 API 的托管包装器：http: [//taskscheduler.codeplex.com/](http://taskscheduler.codeplex.com/)

项目迁移到[https://github.com/dahall/taskscheduler](https://github.com/dahall/taskscheduler)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-15T18:09:27.880

从这篇 2015 年[的博客文章](https://blogs.technet.microsoft.com/heyscriptingguy/2015/01/12/use-powershell-to-show-results-of-scheduled-tasks/)中，您可以通过运行 PowerShell 命令获取这些数据：

```
Get-ScheduledTask | where state -EQ 'ready' | Get-ScheduledTaskInfo | Export-Csv -NoTypeInformation -Path C:\scheduledTasksResults.csv 
```

结果将保存在 CSV 文件中，您可以使用 Excel 打开该文件并将其导出为下表：

```
LastRunTime    | LastTaskResult | NextRunTime | ...
21-12-17 20:24 | 0              | 0           | ...
15-05-18       | 12:55          | 0           | ...
14-05-18 19:13 | 0              | 0           | ...
14-05-18       | 19:14          | 0           | ...
30-11-99 01:00 | 267011         | 0           | ...
15-05-18 12:25 | 0              | 16-05-18    | ...
14-05-18 19:13 | 2147500037     | 0           | ...
15-05-18       | 14:15          | 0           | ...
14-05-18       | 19:15          | 0           | ...
15-05-18       | 12:25          | 0           | ... 
```

__

与有关：

1.  [从 ASP.NET 获取 Windows 计划任务中任务的最后运行日期](https://stackoverflow.com/questions/565922/get-last-run-date-of-task-in-windows-scheduled-tasks-from-asp-net)

# android - 为正在加载的多个图像显示单个不确定的进度条

> ID：14718901
> 
> 赞同：0
> 
> 时间：2013-02-05T23:26:58.340
> 
> 标签：android, android-progressbar, universal-image-loader

所以我有一个 ListView，每个列表项中有几个 ImageView。我使用通用图像加载器来加载每个图像。

我想要的是显示一个不确定的进度条微调器（比如在操作栏上），而列表中的所有图像都在加载，并且当最后一个图像加载时微调器被隐藏。

我不确定这是否可能，或者这样做的最佳技术？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T10:20:50.707

试试这个。在适配器中：

```
@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    ...     
    ImageLoadingListener listener = new CombinedImageLoadingListener(3, progressBar);
    imageLoader.displayImage(uri1, imageView1, listener);
    imageLoader.displayImage(uri2, imageView2, listener);
    imageLoader.displayImage(uri3, imageView3, listener);
    ...
} 
```

而这个听众：

```
class CombinedImageLoadingListener extends SimpleImageLoadingListener {

    private int imageCount;
    private ProgressBar progressBar;

    public CombinedImageLoadingListener(int imageCount, ProgressBar progressBar) {
        this.imageCount = imageCount;
        this.progressBar = progressBar;
    }

    @Override
    public void onLoadingComplete(Bitmap loadedImage) {
        imageCount--;
        if (imageCount == 0) {
            progressBar.setVisibility(View.GONE);
        }
    }
} 
```

# c# - 释放方法返回的 XmlReader 的底层 MemoryStream

> ID：14718903
> 
> 赞同：0
> 
> 时间：2013-02-05T23:27:05.777
> 
> 标签：c#

我有以下方法返回一个`XmlReader`：

```
public XmlReader RequestXML(string endpoint)
{
    using (WebClient request = this.PrepareRequest(RestMethod.GET, null))
    {
        byte[] response = request.DownloadData(this.RestUrl + endpoint);
        using (MemoryStream responseStream = new MemoryStream(response))
        {
            XmlReader xReader = XmlReader.Create(responseStream);
            return xReader;
        }
    }
} 
```

但是，当然，这不起作用，因为`MemoryStream`在调用代码有机会使用`XmlReader`. 是否有可能返回`XmlReader`并仍然处置其底层`MemoryStream`？

我考虑过`Action<XmlReader>`在我的方法中接受委托（或）作为第二个参数来完成 中的工作`using`，但这种设计似乎有点尴尬。

另外，[我不能只打电话`WebClient.DownloadString()`](https://stackoverflow.com/q/6231255/361684)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:26:15.127

如果有疑问使用`XmlReaderSettings.CloseInput`这个重载：`XmlReader.Create(Stream, XmlReaderSettings)`，像这样......

```
public XmlReader RequestXML(string endpoint)
{
    using (WebClient request = this.PrepareRequest(RestMethod.GET, null))
    {
        byte[] response = request.DownloadData(this.RestUrl + endpoint);
        MemoryStream responseStream = new MemoryStream(response);
        XmlReaderSettings xmlReaderSettings = new XmlReaderSettings();
        xmlReaderSettings.CloseInput = true;
        return XmlReader.Create(responseStream, xmlReaderSettings);
    }
} 
```

这样调用的代码`RequestXml`不需要负责处理`MemoryStream`.

# qt - 使用 lambda 函数时 Qt 连接崩溃

> ID：14718905
> 
> 赞同：0
> 
> 时间：2013-02-05T23:27:08.727
> 
> 标签：qt, lambda

代码在这里

```
void A::fun()
{
    QAction* act = new QAction(this);
    QAction* act2 = new QAction(this);
    connect(act, QAction::triggered, [this, &act2]() {...; act2.setDisable(true);}
                              // crash when &act2 is used to capture the variable
                              // but it is okay using act2 to capture the variable
} 
```

是什么原因？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:38:09.680

即使它是一个超出范围的指针，您也正在*引用*，这就是复制指针起作用的原因。`act2`

# r - 在r中的栅格图层上绘制空间点

> ID：14718915
> 
> 赞同：3
> 
> 时间：2013-02-05T23:28:03.673
> 
> 标签：r, plot, spatial, raster

我希望在将矩阵（temp_matrix）转换为栅格对象（tempMap）后绘制它。此外，我希望在同一个绘图窗口上添加几个点，这些点的纬度和经度位置可供我使用。我尝试了几种方法，但似乎没有一种方法有效，因为可用的点是纬度/经度的特定位置，而我得到的栅格对象具有不同的程度。请帮我解决这个问题。下面给出了该问题的示例数据。

```
library(raster)
temp_matrix<-array(NA,c(11,11))
temp_matrix[1,]<-c(NA,NA,NA,NA,NA,NA,NA,0,0,-6,-6)
temp_matrix[2,]<-c(0,0,0,0,NA,NA,1,0,0,0,0)
temp_matrix[3,]<-c(1,0,0,-1,-1,0,0,0,1,0,0)
temp_matrix[4,]<-c(1,1,0,0,0,0,-1,-1,0,0,0)
temp_matrix[5,]<-c(1,NA,NA,NA,NA,-1,-1,-1,0,-1,-1)
temp_matrix[6,]<-c(NA,NA,NA,NA,NA,NA,-1,-1,-1,0,0)
temp_matrix[7,]<-c(NA,NA,NA,NA,NA,NA,NA,0,-1,0,0)
temp_matrix[8,]<-c( NA,NA,NA,NA,NA,NA,NA,0,0,0,-1)
temp_matrix[9,]<-c(NA,NA,NA,NA,NA,NA,NA,-1,0,0,0)
temp_matrix[10,]<-c(NA,NA,NA,NA,NA,NA,NA,NA,-1,-1,-2)
temp_matrix[11,]<-c(NA,NA,NA,NA,NA,NA,NA,NA,-2,-3,-2)
plot(raster(temp_matrix),axes = FALSE,legend=FALSE)
tempMap <- raster(temp_matrix)

# plot the points over this raster layer
point_1<-c(10,10) # should appear on 2nd row from top i.e. over temp_matrix[2,10]
point_2<-c(9,10)  # should appear on 3rd row from top i.e. over temp_matrix[3,10]
point_3<-c(1,10)  # should appear on lowermost row i.e.over temp_matrix[11,10] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T23:38:17.087

您需要设置所需的范围，而不是依赖默认值。

作为对`raster`国家的帮助

```
## S4 method for signature 'matrix'
raster(x, xmn=0, xmx=1, ymn=0, ymx=1, crs=NA, template=NULL) 
```

和

> *   `xmn`:: 最小 x 坐标（左边框）
>     
>     
> *   `xmx`:: 最大 x 坐标（右边框）
>     
>     
> *   `ymn`:: 最小 y 坐标（下边框）
>     
>     
> *   `ymx`:: 最大 y 坐标（上边框）

您可以将`xmn`、`xmx`和设置为您希望的值（在这种情况下为 1、11、1、11）`ymn`）`ymx`

```
tempMap <- raster(temp_matrix, xmn = 1, xmx = 11, ymn = 1, ymx=11)
plot(tempMap,axes = FALSE,legend=FALSE)
points(c(10,9,1), c(10,10,10)) 
```

![](../Images/93cdf26feb40ae618208271a0bd6271c.png)

# c# - 动态设置图像

> ID：14718921
> 
> 赞同：1
> 
> 时间：2013-02-05T23:28:25.013
> 
> 标签：c#, winforms, embedded-resource, picturebox

在*(pbAdvertisingSpace)*`Image`的属性中，我在我的项目 中添加了一些图像。`picturebox` *`Embedded Resources`*

 *但是，我的困难是尝试`pictureBox`根据另一个属性*(HoleNumber)*的值动态设置图像。从我下面的试用方法可以看出，

我尝试了几种不同的方法来改变图片，但迄今为止都没有成功。

谁能告诉我访问这些图像的正确方法？

```
 private void SetAdvertisingLogo()
    {
        if (_getPlayerDetail.HoleNumber == 1 || _getPlayerDetail.HoleNumber == 8 || _getPlayerDetail.HoleNumber == 15)
        {
            pbAdvertisingSpace.Image.PropertyIdList.GetValue(7); 
        }
        else if (_getPlayerDetail.HoleNumber == 2 || _getPlayerDetail.HoleNumber == 9 || _getPlayerDetail.HoleNumber == 16)
        {
            pbAdvertisingSpace.Image.PropertyItems.ElementAt(9);
        }
        else if (_getPlayerDetail.HoleNumber == 3 || _getPlayerDetail.HoleNumber == 10 || _getPlayerDetail.HoleNumber == 17)
        {
            pbAdvertisingSpace.Image.PropertyItems.ElementAt(8);
        }
       etc...
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T00:11:51.297

```
 pbAdvertisingSpace.Image = Resources.yourImage; 
```*

# php - 拉取facebook数据xml

> ID：14718923
> 
> 赞同：0
> 
> 时间：2013-02-05T23:28:28.077
> 
> 标签：php, html, mysql, xml

```
http://developers.facebook.com/docs/reference/rest/links.getStats/ 
```

好的，我看过上面的网站。但我还是有一些麻烦。

我已经像这样格式化了我需要的东西

[http://api.facebook.com/restserver.php?method=links.getStats&urls=dogtags.com.com,http://www.petsmart.com](http://api.facebook.com/restserver.php?method=links.getStats&urls=dogtags.com.com,http://www.petsmart.com)

我唯一的问题是我需要这些数据由邮政编码选择另一个词我只想查看邮政编码 66614 中的 url [http://www.petsmart.com](http://www.petsmart.com)上有多少喜欢。如何添加该变量到xml数据显示

谢谢大家的帮助，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:40:59.597

您正在使用过时的 facebook API。我建议实施：

[http://developers.facebook.com/docs/reference/api/insights/](http://developers.facebook.com/docs/reference/api/insights/)

但是，我不相信有任何方法可以使用 facebook Insight API 查看来自特定邮政编码的数据

# knockout.js - Simple Knockout + Bootstrap Typeahead 插件竞争条件

> ID：14718925
> 
> 赞同：2
> 
> 时间：2013-02-05T23:28:36.873
> 
> 标签：knockout.js, jquery, knockout-2.0

我有一个[非常简单的用于 Knockout.js 的 Bootstrap Typeahead 绑定（jsFiddle）](http://jsfiddle.net/bmh_ca/Fzk4n/4/)，如下所示：

```
ko.bindingHandlers.typeahead = {
    init: function (element, valueAccessor) {
        var $e = $(element),
            source = valueAccessor();

        $e.typeahead({
            source: source,
            minLength: 0
        });
    },
}; 
```

它的用法很简单：

```
<input data-bind='typeahead: source, value: item,
                  valueUpdate: "afterkeydown"' /> 
```

绑定在[jsFiddle](http://jsfiddle.net/bmh_ca/Fzk4n/4/)中按预期工作。但是，当使用 RequireJS 加载时，它并不总是按预期工作。似乎存在竞争条件，因为 Knockout 和 jQuery 正在并行加载。

如果我查看`change`绑定输入元素的事件处理程序，如果 jQuery 是处理程序，则绑定按预期工作。如果 Knockout 是`change`事件的处理程序，则例如，如果您键入“alp”，并且 Typeahead 建议“Alpha”，并且您从 Typeahead 下拉列表中选择“Alpha”，则`<input>`元素将显示所选文本（“Alpha” )，但绑定的 observable 将是“alp”。

在当前系统中，Typeahead 绑定不能直接修改给定的 observables，因此传递`{ source: src, observable: item }`不会解决问题。这个 Typeahead 绑定的作用只是更新绑定的输入区域的内容。

我已经尝试从绑定中触发相关事件，例如“keydown”、“keypress”和“keyup”，但由于显而易见的原因，这不是一个非常有弹性的选项。

我怀疑这个问题与 RequireJS 的不确定性有关，Typeahead 插件的工作与否取决于首先加载的是 jQuery 还是 Knockout。特别是，似乎通过使用 RequireJS 使 jQuery 成为 Knockout 的依赖项（即首先加载 jQuery）解决了这个问题[`shim`](http://requirejs.org/docs/api.html#config-shim)：

```
requirejs.config({
   shim: {
      knockout: { deps: ['jquery'] },
   }
 }); 
```

这看起来很奇怪，我想更好地了解这里发生的事情以及这是否是问题的合理解决方案——即我实际上是在解决这里的潜在问题，还是这个问题会随着后续版本的 Knockout 或 jQuery 而出现。

我会很感激任何想法。

**编辑**

您可以通过按顺序内联加载脚本来简单地复制问题，例如：

```
<script src='knockout.js'></script>
<script src='jquery.js'></script> 
```

这是一个[展示该问题的jsFiddle。](http://jsfiddle.net/bmh_ca/Fzk4n/5/)

按上述顺序插件将失败；否则它将按预期工作。

无论如何，RequireJS 配置是这样的：

```
requirejs.config({
  baseUrl: "/script",
  shim: {
    knockout: { deps: ['jquery'] }, # remove this for race condition
  }
}); 
```

`main`has的简化版本`require(['jquery', 'knockout', 'bindings'], ...)`，其中`bindings`定义了 Knockout 处理程序。该`bindings.js`文件有效地以`define(['knockout', 'jquery'], ...)`.

在这种情况下，虽然问题不是 RequireJS，而是脚本的顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:53:56.570

我怀疑您以某种方式缺少依赖项。可能是引导程序。

在这里查看我的示例。你看看垫片配置是对的。 [http://jsfiddle.net/jaques/sfvy9/2/](http://jsfiddle.net/jaquers/sfvy9/2/)

```
requirejs.config({
    shim: {
        'bootstrap': {
            deps: ['jquery'],
            exports: 'jQuery.fn.typeahead'  // we can't test for more than one object                   
        }
    }
}); 
```

# sql - 使用实体框架时锁定记录以进行编辑的最佳实践

> ID：14718929
> 
> 赞同：12
> 
> 时间：2013-02-05T23:28:55.810
> 
> 标签：sql, entity-framework

不太确定如何措辞这个问题，但它就在这里。我正在开发一个项目，其中多个客户端应用程序通过 WCF 服务访问一个数据源。它可能不相关，但 WCF 服务正在利用实体框架来访问此数据源。每当客户查询要编辑的记录时，我想防止其他客户编辑同一条记录，直到第一个客户完成更新。

如果我错了，请纠正我，但我相信这也称为同步和异步数据访问。

我的问题是，实现此功能的行业最佳实践是什么。有没有办法从数据库端（使用 SQL）控制它，还是必须通过客户端完成？

我已经考虑为每个表包含一个布尔“EditMode”列，并在编辑它时简单地将其设置为 true，并在允许另一个客户端访问该记录之前检查它是否设置为 true。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T23:36:34.433

最佳实践是使用 RowVersion 和乐观锁定。

[解释了乐观并发模式](http://msdn.microsoft.com/en-us/data/jj592904)。

如果首先使用代码，则在您的 POCO 中包含一个字段。

```
public virtual byte[] RowVersion { get; set; } 
```

EF 会将 Timestamp/RowVersion 属性添加到您的表中。它将在更新期间进行检查。并在更改时由数据库自动更新。

**编辑：更好地解释。**

EF 正在寻找的是属于并发字段的属性，因此您实际上可以使用一个或多个字段来控制并发。

```
entity.Property(p => p.RowVersion).IsConcurrencyToken() 
```

执行更新或删除时，您会捕获定义的异常

```
catch (DbUpdateConcurrencyException ex) 
```

EF 将 RowVersion 视为并发令牌。这是常用的方法。由于 SQLServer 会自动为您更新此字段类型。所以非常快速和容易。但是你可以明确地告诉 EF 一个属性是一个并发令牌并且有多个。

因此，EF 应该在 where 子句中添加属性以进行更新和删除，以确保记录自访问后没有更改。

# php - gmail未收到Codeigniter电子邮件

> ID：14718932
> 
> 赞同：1
> 
> 时间：2013-02-05T23:29:06.430
> 
> 标签：php, codeigniter, email

我有一个应用程序，我在其中发送某些事件的电子邮件，但是当我使用我的 gmail 帐户时，我从未收到电子邮件，它们不在我的垃圾邮件文件夹中。当我将它们发送到我的工作电子邮件时，我会立即收到它们。

我需要做什么才能将电子邮件发送到谷歌？

我正在使用标准的 codeigniter 电子邮件配置（我认为使用 sendmail）。

我正在使用谷歌商业应用程序，并且我有谷歌提供的 MX 记录设置。

我还需要什么吗？另外，我在我的应用程序中使用子域，这会影响我可能需要设置的内容吗？

![在此处输入图像描述](../Images/a8f39a8d1b84acd43d623c26c15a4795.png) ![在此处输入图像描述](../Images/4f7816974c502ea16b0481bd66b081a9.png)

**编辑**

当我像这个例子一样使用 smtp 使用[带有 codeigniter 电子邮件库](https://stackoverflow.com/questions/1555145/sending-email-with-gmail-smtp-with-codeigniter-email-library)的 gmail smtp 发送电子邮件时，页面似乎永远不会回来。它最终只是超时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T20:10:04.090

此行为的唯一合理解释是 SPF 检查失败。SPF 或发件人策略框架是一种新技术，可以轻松检测垃圾邮件。除非您手动将这些电子邮件标记为非垃圾邮件，否则 Gmail 会采用 SPF。不管怎样，如果您收到来自另一个地址的电子邮件，那么它们也**一定**已经到达了 Gmail。彻底检查您的垃圾邮件，因为即使高度怀疑垃圾邮件，Gmail 也不会丢弃电子邮件，而是将它们最终放在垃圾邮件文件夹中。

您可以设置一个 SPF，允许您的网络服务器发送电子邮件，这将导致 Gmail 接受您的网络服务器发送的真实电子邮件。请参阅[http://www.mydigitallife.info/how-to-set-up-and-create-sender-policy-framework-spf-domain-dns-txt-record-with-wizard/](http://www.mydigitallife.info/how-to-set-up-and-create-sender-policy-framework-spf-domain-dns-txt-record-with-wizard/)和 Microsoft 的[向导](http://www.microsoft.com/mscorp/safety/content/technologies/senderid/wizard/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:52:19.847

您可能会看到，在未来的某个时候，您会让它们全部出现在 Gmail 中。谷歌很可能会查看发件人是否是垃圾邮件，并保留这些邮件。在设置开发服务器之前，我已经经历过。我建议使用事务性电子邮件服务，例如 Mandrill 或 SendGrid。如果您只是通过 PHP 发送电子邮件，您会发现您从那些您放弃的服务中获得了很多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T04:46:09.827

**过滤器理论**另一种可能性是发帖人在他们的 GMail 帐户上设置了一个过滤器，用于过滤掉电子邮件。

我会确保您也发送所需的标头信息。您是否尝试过注册一个新的 gmail 帐户并将其发送给该用户？

# windows-phone-7 - 如何使用 HttpWebRequest 在 Windows Phone 中发送长查询字符串

> ID：14718933
> 
> 赞同：1
> 
> 时间：2013-02-05T23:29:10.163
> 
> 标签：windows-phone-7, httpwebrequest, windows-phone-7.1, query-string, windows-phone-8

我正在使用 Facebook C# SDK 对 Facebook 进行 API 调用，但我似乎无法通过 HTTP GET 发送长查询字符串。我需要一个长的 FQL 查询（选择 .. from .. where .. in ）来执行，我似乎无法发送它。如果查询较小，它确实发送成功并返回结果。不幸的是，由于 FQL 支持 GET 而不是 POST，所以我坚持使用 GET。

如何增加 Windows Phone HttpWebRequest 中的默认查询字符串限制？

我正在使用 Windows Phone SDK 7.1，但在 Windows Phone 8 设备上进行测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:26:35.147

看来您需要切换到 http post（如果可能）或以某种方式优化您的请求。

阅读[不同浏览器中 URL 的最大长度是多少？](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url). 虽然 HTTP 的官方标准说不应该有最大值，但实际上[有最大值](http://www.boutell.com/newfaq/misc/urllength.html)。例如，[IE 的上限为 2083 个字符](http://support.microsoft.com/kb/208427)。Windows Phone 似乎与 IE 有类似的限制。

> Microsoft Internet Explorer 的最大统一资源定位符 (URL) 长度为 2,083 个字符。Internet Explorer 的最大路径长度也为 2,048 个字符。此限制适用于 POST 请求和 GET 请求 URL。
> 
> 如果您使用 GET 方法，则限制为最多 2,048 个字符，减去实际路径中的字符数。
> 
> 但是，POST 方法不受用于提交名称/值对的 URL 大小的限制。这些对在标头中传输，而不是在 URL 中。
> 
> RFC 2616，“超文本传输​​协议——HTTP/1.1”，没有指定对 URL 长度的任何要求。

资料来源：[http ://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/f96622fe-4dcb-4d38-8831-4cfad1aa4a06/](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/f96622fe-4dcb-4d38-8831-4cfad1aa4a06/)

# java - 使用递归来反转短语

> ID：14718937
> 
> 赞同：-2
> 
> 时间：2013-02-05T23:29:20.423
> 
> 标签：java, recursion, reverse

我有一个任务要求我创建一个 Java 程序，该程序使用递归反转输入短语并输出它。例如，给定输入“数据结构和算法”，程序将输出“算法和结构数据”。

限制之一是程序中不能使用存储或 Java 集合，除了单个本地 String 变量。

我无法理解如何从多行读取输入数据并在字符串上实现递归方法。我了解递归的一般概念，但是将其实现到 Java 中是一项更困难的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:03:05.327

如所要求的，此解决方案逐字“反转”字符串，其中单词仅由单个空格字符分隔。

```
public class TestClass {

    public static String wordReverse(String s) {
        int idx = s.indexOf(" ");
        if (idx < 0) {
            // no space char found, thus, s is just a single word, so return just s itself
            return s;
        } else {
            // return at first the recursively reversed rest, followed by a space char and the first extracted word
            return wordReverse(s.substring(idx + 1)) + " " + s.substring(0, idx); 
        }
    }

    public static void main(String[] args) {
        System.out.println(wordReverse("DATA STRUCTURES AND ALGORITHMS"));
    }
} 
```

> 我无法理解如何从多行读取输入数据

我不完全理解这一点，但如果您询问如何从标准输入读取用户输入，请查看*System.in*

# jquery - 如何避免Rapahel js路径重叠

> ID：14718943
> 
> 赞同：0
> 
> 时间：2013-02-05T23:30:07.773
> 
> 标签：jquery, svg, raphael, graphael

我有一个基于 Raphael js 的流程图。它与[http://raphaeljs.com/graffle.html](http://raphaeljs.com/graffle.html)相同。但是，由于我有许多矩形 Raphael 框，并且我的线路径是直线而不是弯曲的，如上例所示。在这种直线类型中，这些线有时会重叠，因此很难分辨哪条线连接了哪些框。

请让我知道我是否可以实现这一目标以及如何实现。

更新：附上我当前的流程图 jpeg。正如您所看到的，连接线穿过拉斐尔形状，而且很难分辨线从哪里开始。 ![在此处输入图像描述](../Images/ba7943a079465d87287bc7cf46e0ecb1.png)

# matlab - 如何在 Matlab 中求解常微分方程（ODE）系统

> ID：14718944
> 
> 赞同：0
> 
> 时间：2013-02-05T23:30:29.430
> 
> 标签：matlab, differential-equations, ode

我必须求解以下形式的常微分方程组：

```
dx/ds = 1/x * [y* (g + s/y) - a*x*f(x^2,y^2)]
dy/ds = 1/x * [-y * (b + y) * f()] - y/s - c 
```

其中x和y是我需要找出的变量，s是自变量；其余的都是常数。到目前为止，我试图用 ode45 解决这个问题，但没有成功：

```
y = ode45(@yprime, s, [1 1]);

function dyds = yprime(s,y)
    global g a v0 d
    dyds_1 = 1./y(1) .*(y(2) .* (g + s ./ y(2)) - a .* y(1) .* sqrt(y(1).^2 + (v0 + y(2)).^2));
    dyds_2 = - (y(2) .* (v0 + y(2)) .* sqrt(y(1).^2 + (v0 + y(2)).^2))./y(1) - y(2)./s - d;
   dyds = [dyds_1; dyds_2];
return 
```

其中@yprime 具有方程组。我收到以下错误消息：

> YPRIME 返回一个长度为 0 的向量，但初始条件向量的长度为 2。YPRIME 返回的向量和初始条件向量必须具有相同数量的元素。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:46:43.230

当然，你应该看看你的功能`yprime`。使用一些与您的问题共享微分状态变量数量的简单模型，看看这个例子。

```
function dyds = yprime(s, y)
    dyds = zeros(2, 1);
    dyds(1) = y(1) + y(2);
    dyds(2) = 0.5 * y(1);
end 
```

`yprime`必须返回一个包含右侧两个值的列向量。`s`可以忽略输入参数，因为您的模型与时间无关。您展示的示例有些困难，因为它不是 dy/dt = f(t, y) 的形式。作为第一步，您必须重新排列方程式。这将有助于重命名`x`为`y(1)`和。`y``y(2)`

另外，你确定你`global g a v0 d`的不是空的吗？如果其中任何一个变量仍未初始化，则您将状态变量与空矩阵相乘，最终导致`dyds`返回一个空向量。这可以用

```
assert(~isempty(v0), 'v0 not initialized'); 
```

in `yprime`，或者您可以使用调试断点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T10:53:09.137

ODE 求解器的语法是`[s y]=ode45(@yprime, [1 10], [2 2])`

而且你不需要在你的情况下进行元素操作，而不是`.*`仅仅使用`*`![y(:,1) 针对 s 绘制初始条件 [2 2] 和参数值：g=1;a=2;v0=1;d=1.5;](../Images/2f74ff6859c59c35c28ec07b57c6c967.png)

![y(:,2) 与 s](../Images/574d5a96bcc3fb2e5f0b2e1faa1297ec.png)

# c - 使用二进制补码进行按位减法溢出

> ID：14718946
> 
> 赞同：6
> 
> 时间：2013-02-05T23:30:51.150
> 
> 标签：c, bit-manipulation, bitwise-operators

当使用二进制补码执行按位减法时，如何知道何时应该忽略溢出？我读过的几个网站说溢出被简单地忽略了，但这并不总是有效 - 溢出对于诸如 之类的问题是必要的`-35 - 37`，因为需要一个额外的数字来表达`-72`.

编辑：这是一个例子，使用上面的等式。

`35`到 binary -> `100011`，找到二进制补码使其为负：`011101`

`37`到 binary -> `100101`，找到二进制补码使其为负：`011011`

执行上述项的加法（二进制等价于`-35 - 37`）：

```
011101
011011
------
111000 
```

取二进制补码转换回正数：`001000`

以上是许多网站（包括学术网站）所说的答案，因为您忽略了溢出。然而，这显然是不正确的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T23:40:09.757

当结果无法以目标数据类型表示时，就会发生溢出。值 -72 可以用 char 表示，它是一个有符号的 8 位量......在您的示例中没有溢出。也许您正在考虑`borrow`进行按位减法...当您从`'1'`a 中减去 a 时，`'0'`您需要`borrow`从下一个高阶位位置中减去。做减法时不能忽略借位。

```
-35 decimal is   11011101 in two's complement 8-bit
+37 decimal is   00100101 in two's complement 8-bit 
```

从最低有效位到最高有效位从右到左，您可以从 -35 中的每个位中减去 +37 中的每个位，直到到达第 5 位（从右侧的第 0 位开始计数）。在第 5 位，您需要从中减去`'1'`，`'0'`因此您需要从 -35 中的第 6 位（下一个高阶位）借用，这恰好是`'1'`借用之前的。结果看起来像这样

```
-35 decimal is   11011101 in two's complement 8-bit
+37 decimal is   00100101 in two's complement 8-bit
                 --------
-72 decimal is   10111000 in two's complement 8-bit 
```

结果是否定的，并且您在 8 位二进制补码中的结果设置了高位（第 7 位）......这是负数，因此没有溢出。

**更新**：我想我知道混乱在哪里，并且我声称这里的答案[加减二进制补码](https://stackoverflow.com/questions/3878062/adding-and-subtracting-twos-complement/)是错误的，当它说你可以时`discard the carry (indicates overflow)`。在那个答案中，他们通过使用二进制补码将第二个操作数转换为负数然后加法来进行减法。这很好 - 但在这种情况下进位并不代表溢出。如果您在 N 位（编号 0 到 N-1）中添加两个正数，并且您考虑这个无符号算术`range 0 to (2^N)-1`并且您得到位位置 N-1 的进位，那么您有溢出 - 两个正数之和（解释为无符号最大可表示的正数范围）不应产生最高位（位 N-1）的进位。因此，当添加两个正数时，您可以通过说来识别溢出

1.  当您将它们解释为无符号和
2.  当解释为有符号（二进制补码）时，位 N-1 中的结果必须为零

但是请注意，处理器不区分有符号和无符号加/减...它们设置溢出标志以指示**如果**您将数据解释为有符号**，则**无法表示结果（错误）。

这是[进位和溢出标志的非常详细的解释](http://teaching.idallen.com/dat2343/10f/notes/040_overflow.txt)。那篇文章的要点是

*   在`unsigned`算术中，观察进位标志以检测错误。
*   在`unsigned`算术中，溢出标志告诉你什么有趣的东西。

*   在`signed`算术中，观察溢出标志以检测错误。

*   在`signed`算术中，进位标志告诉你什么有趣的东西。

[这与维基百科中算术溢出](http://en.wikipedia.org/wiki/Arithmetic_overflow)的定义一致，该定义说

> 大多数计算机区分两种溢出条件。当加法或减法的结果（将操作数和结果视为无符号数）不适合结果时，就会发生进位。因此，在添加或减去被解释为无符号值的数字后检查进位标志很有用。当结果没有从操作数的符号中预测的符号时（例如，两个正数相加时的负结果），就会发生溢出。因此，在以二进制补码形式表示的数字（即它们被认为是有符号数字）相加或相减后检查溢出标志是很有用的。

# python - Enthought 中的 Enaml 示例不适用于 Python(x,y) Enthought 工具套件版本的 Enaml

> ID：14718950
> 
> 赞同：1
> 
> 时间：2013-02-05T23:31:41.440
> 
> 标签：python, enthought, pythonxy, epd-python, traitsui

我最近发现了 Enthought 的 Python GUI 开发包 Enaml。我对将它与 Enthought Traits 和 Chaco 一起使用以实现更快速的科学应用程序开发非常感兴趣。我一直使用 Python(x,y) 作为我的基础 Python 安装，因为我喜欢 Spyder（熟悉来自 Matlab 背景）我最初的目标是构建一个 PyQt 应用程序。

Python(x,y) 带有 Enthought 工具套件，它似乎包含了大部分 Enthought 内部开发的工具，如 Traits、Chaco、Mayavi 和 Enaml。我在 enaml 上看到了[pygotham 幻灯片](http://blog.enthought.com/?cat=157)，发现[教程示例](http://docs.enthought.com/enaml/instructional/tut_hello_world.html)看起来真的很酷！但是，当我尝试运行第一个示例时，出现此错误：

回溯（最后一次调用）：文件“C:\Users\bnables\Documents\Python\enaml\person.py”，第 8 行，来自 enaml.stdlib.sessions import simple_session ImportError: No module named sessions

我刚刚发现我全新安装的 Python(x,y) 2.7.3.1 具有 Enthought Tool Suite 版本 4.2 和 Enaml 版本 0.2...在线 Enaml 文档最高版本为 0.6.3。所以我想我的问题是 - Python(x,y) 用户使用 Enaml 的最佳途径是什么？

我试图避免直接使用 Enthought Python Distribution，因为我在工作中使用它并且没有购买付费版本的权限或资金。可以从 Enthought 源存储库更新 Python(x,y) 中内置的 Enthought 工具套件吗？Enaml 本身可以单独更新吗？

深思熟虑的人，我要带你谈谈你最近宣布正式支持 Stack Overflow 的问题！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T00:00:25.653

我没有使用过 python(x,y)，但我假设你可以从源代码构建一个项目。这可能是目前最好的做法。我们在 Enaml 上付出了很多努力，它的缺点是使其快速变化。0.2 版没有运行 pygotham 中的一些示例也就不足为奇了。

仅供参考，EPDFree 现在允许更新包，包括 Enaml。但考虑到每周对 Enaml 的提交数量，我仍然建议从源代码构建，即使再使用 EPD 几个月，只是为了让所有很酷的功能都进入。

看到我们正在兑现我们对 SO 进行监控的承诺 :)。

乔纳森

# python - Windows 8 上的 TracD / Python

> ID：14718952
> 
> 赞同：0
> 
> 时间：2013-02-05T23:31:52.947
> 
> 标签：python, windows-8, sqlite, trac

背景：

使用全新安装将开发环境升级到 Windows 8 (x64)。Trac/Python 设置与 Windows 7 (x64) 下长期建立的工作和可靠实现相同。

Trac 1.0、ActivePython 2.7.2 (x86) 使用 TracD 作为 SVRANY 的服务（问题与管理员命令提示符中的 TracD 测试相同，而不是作为服务）。

症状：

Trac 元素在浏览器中的显示不稳定 - 有时缺少样式和布局，某些图像无法显示，但可以通过右键单击显示图片来加载。片刻之后，Trac 站点变得无法访问，必须重新启动服务。IE10 和 Chrome 出现问题（与浏览器无关，见下文）。

日志：

每次页面访问（TracD）都会产生多次错误：

```
File "C:\Python27\lib\socket.py", line 303, in flush
self.wfile.flush()
self._sock.sendall(view[write_offset:write_offset+buffer_size])
error: [Errno 10053] An established connection was aborted by the software in
your host machine
File "C:-\Pyt-h-o-n2-7\-l---i----b-\--so-ck--e--t.-p--y-"-,-- ---line 303,- --
-i---n-- flush 
```

事件簿：

更罕见的是，另一个问题正在发生：

```
Faulting application name: Python.exe, version: 0.0.0.0, time stamp: 0x4e04e3b8
Faulting module name: sqlite3.dll, version: 0.0.0.0, time stamp: 0x4e04e486
Exception code: 0xc0000005
Fault offset: 0x00014c45
Faulting process id: 0x638
Faulting application start time: 0x01ce039b9e7bf067
Faulting application path: C:\Python27\Python.exe
Faulting module path: C:\Python27\DLLs\sqlite3.dll
Report Id: 57f144f2-6f8f-11e2-bea0-00221597cbcd 
```

尝试解决（未成功）：

1.  兼容性设置。
2.  防火墙暂时禁用。
3.  防病毒暂时禁用。
4.  Windows 8/2012 上的 Google 错误消息和/或 Trac/Python 问题。
5.  从 ActivePython 2.7.2 升级到 python.org 2.7.3（Trac 目前无法在 3.x 上运行）。
6.  使用 Bitnami Trac Stack 将 TracD 替换为 Apache。
7.  确保 Python 中包含的 SQLite 二进制文件是最新版本（尚未尝试）。

问题：

1.  有没有人让 Trac/Python 在 Windows 8/2012 平台上正常工作？

2.  这是否表明 Python 2.7.x 在 Windows 8 上被破坏了，对许多应用程序有潜在的影响，不仅仅是 Trac，还有任何使用套接字或 SQLite 在 Python 上运行的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:21:58.323

是的，我怀疑这个问题是由 Trac 本身引起的。

# android - 如何在插入 3.5 毫米插孔以使用外部麦克风录制声音时使用内部扬声器播放声音

> ID：14718962
> 
> 赞同：5
> 
> 时间：2013-02-05T23:33:15.043
> 
> 标签：android, audio-recording, speaker

我现在正在编写一个应用程序，以便在用户进行一些练习时通过内部扬声器提供声音反馈。

现在我想添加一个功能来记录用户的心跳和通过3.5mm插孔插入手机的听诊器呼吸。问题是当我插入插孔时，扬声器不会播放任何声音，因为手机认为耳机已连接，声音将通过它们播放。

我想要实现的是通过插入手机的听诊器录制声音，同时通过内部扬声器播放声音。

基本上我使用两种播放声音的方法，MediaPlayer 和 TextToSpeech。

我在互联网上搜索，找到了这些文章：

[在Android中强制通过扬声器输出声音](https://stackoverflow.com/questions/2917184/forcing-sound-output-through-speaker-in-android)

[想在蓝牙耳机上播放 TTS](https://stackoverflow.com/questions/7518452/want-to-play-tts-on-bluetooth-headset)

他们告诉我要做的是添加权限 MODIFY_AUDIO_SETTINGS 到清单

声明变量：

```
MediaPlayer mediaPlayer; 
AudioManager mAudioManager;
HashMap<String, String> mHashAlarm = new HashMap<String, String>(); 
```

在 OnCreate 方法中：</p>

```
mAudioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
mAudioManager.setSpeakerphoneOn(true);
mediaPlayer = MediaPlayer.create(context, R.raw.ding);
mHashAlarm.put(TextToSpeech.Engine.KEY_PARAM_STREAM, String.valueOf(AudioManager.STREAM_MUSIC));
...
tts.speak(text, TextToSpeech.QUEUE_FLUSH, mHashAlarm); 
```

但它们都不起作用。

有谁知道如何实现这个功能？任何想法都会有很大帮助。谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2020-09-28T21:11:41.527

只需购买一个音频分配器......之后，你会得到两个端口，将外部麦克风插入一个端口，并将任何扬声器插入另一个端口......

# c# - 如何以特定形式对列表进行排序？

> ID：14718963
> 
> 赞同：-5
> 
> 时间：2013-02-05T23:33:17.717
> 
> 标签：c#, .net

我确实有一个字符串列表，其中包含

```
"aa1"
"aa2"
"aa3"
"bb1"
"bb2"
"bb3" 
```

值可以是任何形式，其中“aa3”可以位于底部或任何其他 oder

我想以以下形式对其进行排序或重新排序

```
"aa1"
"bb1"
"aa2"
"bb2"
"aa3"
"bb3" 
```

那我该怎么做

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:44:39.243

以下答案使用 Linq 按所需顺序返回一系列字符串：

```
List<string> l = new List<string>
{
    "aa1",
    "aa2",
    "aa3",
    "bb1",
    "bb2",
    "bb3"
};

var result = l.OrderBy(s => s[2])
              .ThenBy(s => s.Substring(0, 2));

foreach (string str in result)
    Console.WriteLine(str); 
```

请注意，原始列表保持不变。

* * *

您也可以通过匿名对象提取这些字符串：

```
var result = l.Select(s => new { Name = s.Substring(0, 2), 
                                 Num = s[2].ToString() })
                .OrderBy(o => o.Num)
                .ThenBy(o => o.Name);

foreach (var a in result)
    Console.WriteLine(a.Name + a.Num); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T23:42:52.663

你可以只使用 LINQ：

```
var strings = new List<string> { "aa1", "aa2", "aa3", "bb1", "bb2", "bb3" };
var orderedStrings = strings
    .OrderBy(s => s[2])
    .ThenBy(s => s[1])
    .ThenBy(s => s[0])
    .ToList(); 
```

# android - 在z轴上倾斜android

> ID：14718968
> 
> 赞同：5
> 
> 时间：2013-02-05T23:33:40.407
> 
> 标签：android

在 Jellybean 应用程序列表或许多谷歌应用程序中，如果屏幕上的所有项目在 z 轴上略微倾斜，则表明您在滚动时处于最后。这是如何实现的？谢谢，迈克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-09T15:31:30.760

这是一个视图动画 - 旋转。它可以使用 RenderScript 或 Android 动画系统来完成。Chet Haas 和 Romain Guy 在这里提到：http: //youtu.be/ToHpumrutXg?t= [12m55s](http://youtu.be/ToHpumrutXg?t=12m55s)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T04:41:13.783

当我遇到[这个](http://sriramramani.wordpress.com/2012/10/12/kinetic-list-view/)时正在寻找类似的东西。我最终决定不使用这种效果。但这里希望它可以帮助你。

# python - Python 2.6：“无法打开图像”错误

> ID：14718969
> 
> 赞同：2
> 
> 时间：2013-02-05T23:33:52.173
> 
> 标签：python, image, pygame

我正在尝试为要用于游戏的地图制作基础，但我无法将图像加载到屏幕上。我尝试使用相同的字母大小写向图像发送绝对文件路径，我尝试更改图像的名称，我尝试加载在我制作的其他程序中工作的不同图像，我尝试将图像与脚本本身位于同一目录中。还没有任何效果。我查看了一些遇到相同问题的人的帖子，例如[为什么我的 pygame 图像没有加载？](https://stackoverflow.com/questions/5188670/why-are-my-pygame-images-not-loading)我找不到我的问题的答案。图像不会加载。这是代码：

```
import sys, pygame
from pygame.locals import *

pygame.init()
size = (600, 400)
screen = pygame.display.set_mode(size)
pygame.display.set_caption("Practice Map")
walls = pygame.image.load("C:\Users\dylan\Desktop\Practice Game\brick.jpg")

x = 0
y = 0

while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            sys.exit()
        if event.type == KEYDOWN and event.key == K_ESCAPE:
            sys.exit()
        if event.type == KEYDOWN and event.key == K_UP:
            y -= 20
        if event.type == KEYDOWN and event.key == K_DOWN:
            y += 20
        if event.type == KEYDOWN and event.key == K_LEFT:
            x -= 20
        if event.type == KEYDOWN and event.key == K_RIGHT:
            x += 20
        screen.fill((0,0,0))
        screen.blit(walls,(x, 330))
        # more bricks to go here later
        pygame.display.flip()

#end 
```

和错误：

```
Traceback (most recent call last):
  File "C:\Users\dylan\Desktop\Practice Game\move.py", line 8, in <module>
    walls = pygame.image.load("C:\Users\dylan\Desktop\Practice Game\brick.jpg")
error: Couldn't open C:\Users\dylan\Desktop\Practice Gamerick.jpg 
```

我将 Python 2.6 和 PyGame 1.9 用于 Python 2.6 版，IDLE 作为我的编辑器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T23:47:38.850

这里的问题是您使用 \ 作为路径名分隔符，但 \ 在 Python 字符串中也用作转义字符。特别是，`\b`表示“退格”（或`'\x08'`）。由于没有完全记录但可靠的行为，您可以摆脱其他反斜杠，例如未知转义序列`\X`被视为反斜杠，后跟`X`.

有三种解决方案：

1.  使用原始字符串，这意味着 Python 字符串转义被忽略：`r"C:\Users\dylan\Desktop\Practice Game\brick.jpg"`.
2.  转义你的反斜杠：`"C:\\Users\\dylan\\Desktop\\Practice Game\\brick.jpg"`.
3.  改用正斜杠：`"C:/Users/dylan/Desktop/Practice Game/brick.jpg"`.

如果你已经记住了 Python 转义序列的列表，并且愿意依赖可能会改变但可能不会改变的功能，那么你可以只在`\b`此处转义，但应该清楚为什么其他三个是更好的想法从长远来看。

虽然 Windows 路径名本身使用反斜杠分隔符，但所有内置和标准库 Python 函数以及第三方库中的大多数函数都非常乐意让您使用正斜杠。（这是因为 Windows 根本不允许在路径中使用正斜杠。）

要了解它的工作原理和原因，您可能想尝试打印出字符串：

```
>>> print "C:\Users\dylan\Desktop\Practice Game\brick.jpg"
C:\Users\dylan\Desktop\Practice Gamrick.jpg
>>> print r"C:\Users\dylan\Desktop\Practice Game\brick.jpg"
C:\Users\dylan\Desktop\Practice Game\brick.jpg
>>> print "C:\\Users\\dylan\\Desktop\\Practice Game\\brick.jpg"
C:\Users\dylan\Desktop\Practice Game\brick.jpg
>>> print "C:/Users/dylan/Desktop/Practice Game/brick.jpg"
C:/Users/dylan/Desktop/Practice Game/brick.jpg 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T23:40:29.513

```
walls = pygame.image.load("C:\Users\dylan\Desktop\Practice Game\brick.jpg") 
```

你需要逃脱最后`\`

```
walls = pygame.image.load("C:\Users\dylan\Desktop\Practice Game\\brick.jpg") 
```

**编辑**：解释

您需要在最后转义，`\`因为 , 之后有 ab `\`，并且`\b`是退格的转义序列。这将删除序列之前的字符。这就是为什么您需要转义最后一个反斜杠的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T23:45:09.230

请注意，Windows 路径使用`\`字符作为分隔符。这些也意味着 Python 字符串中的“转义”。

尝试使用原始字符串：

```
walls = pygame.image.load(r"C:\Users\dylan\Desktop\Practice Game\brick.jpg") 
```

（注意`r"`字符串前面的。）

# bash - 使用 ssh 杀死并重新启动所有 sshd 进程

> ID：14718970
> 
> 赞同：0
> 
> 时间：2013-02-05T23:33:55.893
> 
> 标签：bash, ssh

我有一个脚本可以

1.  杀死所有 sshd 进程
2.  启动一个新的 sshd 进程

我想将此脚本 scp 到远程计算机上并使用 ssh 执行它。执行完第一步杀掉所有sshd后，还会进入第二步再次运行sshd吗？我很担心，因为我正在使用 ssh 运行脚本，而 ssh 在第 1 步之后会死掉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:46:47.620

正常的程序是停止主 sshd，例如，`/etc/init.d/sshd stop`或者你的发行版的等价物。这样，在现有连接继续进行时，监听守护程序将关闭，直到客户端断开连接。

如果要升级/替换 sshd，更改任何设置并重新启动它，这就是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:35:37.617

不需要`scp`它到服务器，只需尝试这样做：

```
while read cmd; do ssh server "bash -c $cmd"; done < script.sh 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T00:51:48.533

为什么不使用 cron 呢？例如：

10 * * * * /path_to_script

分钟 小时 天 月 dayofweek 命令

不要忘记将其关闭；）

# c# - 向 SQL Server 表添加多个值

> ID：14718971
> 
> 赞同：1
> 
> 时间：2013-02-05T23:34:05.407
> 
> 标签：c#, sql, sql-server, winforms, ado.net

首先，如果这更像是一个问题而不是一个例子，我想道歉，但我真的迷路了。我有一个从文本文件加载信息的 Windows 窗体。在每个文本文件中都有给定州的所有市县，每个部分用`.Split`. 我有一个`SQL Server 2008`数据库，2 列，名称和类型。我想做的是获取所有信息并将其添加到单独的行中，名称列是名称，类型列是州或县。这是我如何拆分信息的方式。如何为文本中的每个条目添加一个新行？

```
void PopulateZones()
{
    ofdFile.Filter = "Text File (.txt)|*.txt|All Files (*.*|*.*";
    ofdFile.FilterIndex = 1;
    ofdFile.Multiselect = true;

    ofdFile.FileName = String.Empty;
    if (ofdFile.ShowDialog() == DialogResult.OK)
    {
        ofdFileLocTextBox.Text = ofdFile.FileName.ToString();
        string groups = File.ReadAllText(ofdFile.FileName);
        string[] parts = groups.Split(new char[] { '*' }, StringSplitOptions.RemoveEmptyEntries);
        stateTextBox.Text = parts[0];
        citiesTextBox.Text = parts[1];
        countiesTextBox.Text = parts[2];
        AddtoSQL(parts[0], parts[1]);
    }
}

void AddtoSQL(string cities, string counties)
{
    Sqlconnection conn = new SqlConnection(connString)
    Sqlcommand comm = new Sqlcommand("INSERT into [Table] (Name, Type) Values (@Name, @Type))";
    comm.Parameters.Add(@Name, each line of textbox);
    comm.Parameters.Add(@Type, City or County);
    comm.ExecuteNonQuery();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T09:46:27.080

所以，你遇到的第一个问题是你的代码没有做你认为的那样。最大的问题是你正在阅读所有文本，然后只选择它的前三个值。你没有给出您的数据的格式，但假设它看起来像这样：

```
Scotland*Edinburgh*Midlothian*
Scotland*Perth*Perthshire* 
```

你的代码

```
string groups = File.ReadAllText(ofdFile.FileName); 
```

将整个文件读入一个字符串，看起来像这样

```
Scotland*Edinburgh*Midlothian*\r\nScotland*Perth*Perthshire* 
```

所以使用以下方法拆分它

```
string[] parts = groups.Split(new char[] { '*' }, 
         StringSplitOptions.RemoveEmptyEntries); 
```

给你一个 6 部分的字符串数组。从中插入多行是可行的，但不会很整洁。您最好按行读取文本文件，然后遍历行数组，将每一行拆分，然后将相关部分添加到 SQL 中。就像是

```
string[] lines = System.IO.File.ReadAllLines(ofdFile.FileName);
foreach (var line in lines)
{
    string[] parts = line.Split('*');
    AddtoSQL(parts[0], parts[1]);
} 
```

这应该插入所有数据，但顺便说一句，如果您希望一次执行大量插入，我建议将这些插入包含在 SQL 事务中。

我会指导您查看[有关 SqlTransaction 类的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqltransaction.aspx)

它的要点是您首先声明一个事务，然后循环执行针对该事务的插入。最后，当您提交事务时，查询全部写入数据库。我这样做的原因是它会更快更安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:40:24.117

如果将 sql 语句更改为“插入 [table] (name, type) values(@name, @type)”是否有效？与支架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T00:32:24.900

在 SQL Server 2008 中，您可以通过一个查询插入多行（记录）。您需要做的就是一个循环来提取行值并构造查询字符串。因此，在`AddToSQL`方法中，您的查询如下：

```
INSERT INTO [Table](Name, Type)
VALUES ('First',State1),
('Second',State2),
('Third',State3),
('Fourth',State4), 
```

[使用一个插入语句插入多条记录](http://blog.sqlauthority.com/2007/06/08/sql-server-insert-multiple-records-using-one-insert-statement-use-of-union-all/)

# javascript - Javascript 倒计时永远不会显示 0 分钟

> ID：14718978
> 
> 赞同：0
> 
> 时间：2013-02-05T23:35:01.643
> 
> 标签：javascript, timer

我正在为一个站点开发一个倒数计时器——它实际上没有目的，它就在那里。所以基本上在午夜它从 24 小时开始，倒计时一整天，在午夜再次重置。我有计时器工作，唯一的问题是我想确保它永远不会说“0 HRS，0 MIN” - 它应该保持在 1 MIN 直到它重置。我以为我找到了一种方法，但我不确定它是否有效：

```
var date = new Date();
var month = date.getMonth();
var day = date.getDate();
var dayOfWeek = date.getDay();
var hours = {start: new Date(date.getFullYear(), month, day), end: new Date(date.getFullYear(), month, day)};

updateCountDown();
$(document).ready(function(){
    setInterval('updateCountDown()', 1000);
});

function updateCountDown(){
    var date = new Date();
    var hourDiff = 23 - date.getHours();
    var minDiff = 59 - date.getMinutes();

    $('span.hours').html(23-date.getHours());
    $('span.minutes').html(59 - date.getMinutes());

    if (hourDiff == 0 && minDiff == 0 ) {
     minDiff = 1;
    };
}; 
```

有没有办法测试这个而不等到今晚午夜看看会发生什么？我尝试将 updateCountDown 中的 new Date() 更改为 new Date('2/5/13 4:30:00') 但它没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:46:35.477

`minDiff`您在显示变量后正在更新它。

试试这个：

```
var date = new Date();
var month = date.getMonth();
var day = date.getDate();
var dayOfWeek = date.getDay();
var hours = {start: new Date(date.getFullYear(), month, day), end: new Date(date.getFullYear(), month, day)};

updateCountDown();
$(document).ready(function(){
    setInterval(updateCountDown, 1000);
 });

function updateCountDown(){
    var date = new Date();
    var hourDiff = 23 - date.getHours();
    var minDiff = 59 - date.getMinutes();

    if (hourDiff == 0 && minDiff == 0 ) {
      minDiff = 1;
    };

    $('span.hours').html(hourDiff);
    $('span.minutes').html(minDiff);
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:48:37.033

要进行测试，只需将`new Date()`方法中`updateCountDown`的调用替换为`new Date(2013, 01, 01, 23, 59, 50)`.

并使用 Marcus 发布的代码。

# sql - 错误视觉工作室 2010 SQL INTERSECT

> ID：14718986
> 
> 赞同：0
> 
> 时间：2013-02-05T23:35:54.577
> 
> 标签：sql, visual-studio-2010

所以我试图在我的数据库中找到在特定列具有相同值的两个 ID，即

```
SELECT SALARY FROM TABLE1 WHERE ID='1'
INTERSECT
SELECT SALARY FROM TABLE2 WHERE ID='5' 
```

所以我在VS2010中做了

```
Dim ConnectionString As String
ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=C:\\;Extended Properties=dBase  IV"
Dim dBaseConnection As New System.Data.OleDb.OleDbConnection(ConnectionString)
dBaseConnection.Open()
Dim myQ As String = "SELECT 'SALARY' FROM TABLE1 WHERE ID='1' INTERSECT SELECT 'SALARY' FROM TABLE2 WHERE ID='5'"
Dim dBaseCommand As New System.Data.OleDb.OleDbCommand(myQ, dBaseConnection)
Dim dBaseDataReader As System.Data.OleDb.OleDbDataReader = dBaseCommand.ExecuteReader(CommandBehavior.SequentialAccess) 
```

执行最后一行时出现此错误

> *System.Data.dll 中出现“System.Data.OleDb.OleDbException”类型的未处理异常
> 附加信息：IErrorInfo.GetDescription 失败，出现 E_FAIL(0x80004005)。*

难以置信，当我使用 UNION 而不是 INTERSECT 作品时

任何想法，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T23:41:21.850

看起来好像您正在为 dBase IV 文件使用 Microsoft JET 提供程序。dBase 和 Microsoft Jet 不支持 intersect 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:43:56.653

我并没有完全回答您的问题以解决您的错误，但无论如何这可能是您尝试做的事情的解决方法。

您可以使用以下查询，而不是使用 intersect：

```
select salary
from Table1 inner join Table2 on Table1.Salary = Table2.Salary
where Table1.Id = '1' and Table2.Id = '5' 
```

# c# - [输入] 在 C# 中是什么意思？

> ID：14718987
> 
> 赞同：0
> 
> 时间：2013-02-05T23:35:58.580
> 
> 标签：c#, .net

我在示例源代码项目中看到了这一点。

```
 [Input]
    public int Length { get; set; } 
```

它是在一个类中定义的：

```
 namespace PowerLanguage.Strategy
    {
        public class MovAvg_Cross_SE : SignalObject
        {
   .... 
```

[输入] 是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T23:41:44.133

那是一个[属性](http://msdn.microsoft.com/en-us/library/z0w1kczw.aspx)——一种声明有关源代码的信息的方法。您的特定属性的含义取决于属性的名称空间。您可以将鼠标悬停在它上面以获取有关它的信息，或者（如果声明是您项目的一部分）按住 ctrl 并单击它以查看其来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:42:58.853

它是一个属性。完整的类名是 InputAttribute。代码可以反映属性并发现属性，这可能会修改行为或触发其他功能。添加功能的另一个示例是[Data Annotations](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.aspx)，当它与将发现并运行它们的东西一起使用时，可以被认为是添加行为。[您可以在此处](http://msdn.microsoft.com/en-us/library/aa288454%28v=vs.71%29.aspx)阅读有关属性的更多信息（虽然较旧，但概念是相同的）。

# javascript - jquery animate width 打乱了其他元素的流动

> ID：14718988
> 
> 赞同：-1
> 
> 时间：2013-02-05T23:36:06.217
> 
> 标签：javascript, jquery, html, css

我有一堆网格模式的 div，当单击 tile div 时，我希望它向右展开以显示以前隐藏的 div。但是，在动画过程中，周围的 tile div 会在动画完成后回到正确位置之前暂时偏离位置。我希望它能够顺利滑出到右侧。单击左上角的图块以最仔细地查看我的意思。

这是 JS 代码，但我认为必须进行一些 CSS 调整。参见 CSS 的小提琴。

```
$('.tile').on('click', function(){
    $(this).find('.sparkline').show();

    $(this).animate({
        width : '326px'
    },
    600, 
    function(){

    }); 
}); 
```

[JSFiddle](http://jsfiddle.net/nup6x/)

少之又少：

```
.tiles{
  .tile{
    display:inline-block;
    width:auto;
    height:72px;
    margin:8px;
    background-color:#F1F1F1;
    border:1px solid gray;
    border-radius:5px;
    cursor:pointer;
    .origMetrics{
      width:154px;
      display:inline-block;
    }
    .sparkline{
      display:inline-block;
      width:154px;
      height:53px;
      float:right;
    }
    .seperator {
      margin: 0 15px 5px 15px;
      border-color:black;
    }
    .metrictitle{
      display:block;
      margin-left:auto;
      margin-right:auto;
      text-align:center;
    }
    .metricvalue {
      display:inline-block;
      text-align:left;
      width:auto;
      margin-left:10px;
      font-size:25px;
    }
    .metrictrend {
      float:right;
      margin-right:10px;
      margin-top:5px;
    }
    .positive{
      color:green;
      img{
        position:relative;
        bottom:15px;
        left:15px;
      }
    }
    .negative{
      color:red;
      img{
        display:none;
      }
    }
    .even{
      img{
        display:none;
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T23:46:57.190

尝试将迷你图的显示`div`放在`.animate()`完整的回调函数中。

在动画完成之前，迷你图容器正在显示并占用 DOM 中的空间。这导致动画中出现了跳跃。

要获得更清洁的外观，您可以使用`.fadeIn()`而不是`.show()`在迷你图容器上使用。

```
$('.tile').on('click', function () {
    $(this).animate({
        width: '326px'
    }, 600, function () {
        $(this).find('.sparkline').fadeIn();
    });
}); 
```

此外，在 IE 和 Firefox 中，`display: inline-block`瓷砖上的样式似乎干扰了`overflow: hidden`作为动画一部分应用的样式。当您使用 时`inline-block`，我强烈建议您也`vertical-align`相应地设置属性。在你的情况下，我相信`vertical-align: top`这将是瓷砖的最佳设置。

```
.tile{
    display:inline-block;
    vertical-align: top;
    width:auto;
    height:72px;
    margin:8px;
    background-color:#F1F1F1;
    border:1px solid gray;
    border-radius:5px;
    cursor:pointer;
} 
```

[jsfiddle](http://jsfiddle.net/PChBS/7/)

# law-of-demeter - 得墨忒耳法则——务实的程序员

> ID：14718998
> 
> 赞同：1
> 
> 时间：2013-02-05T23:37:00.570
> 
> 标签：law-of-demeter

考虑到“务实的程序员”中的练习，我有一些问题。

它说：

1.

```
public void showBalance(BankAccount acct) {
Money amt = acct. getBalance() ;
printToScreen(amt .printFormat()) ;
} 
```

> 变量 acct 作为参数传入，因此允许调用 getBalance。然而，调用 amt.printFormat() 不是。我们不“拥有”amt，它也没有传递给我们。

但是我们*确实*拥有amt 对吗？它在方法和 LOD 中声明：当您的方法创建本地对象时，该方法可以调用本地对象上的方法。

这个例子是否打破了 LOD？在我看来，不是吗？

2.

```
public class Colada {
private Blender myBlender;
private Vector myStuff;

public Colada() {
myBlender = new Blender();
myStuff = new Vector() ;
}

private void doSomething() {
myBlender.addlngredients(myStuff.elements());
}
} 
```

> 由于 Colada 创建并拥有 myBlender 和 myStuff，因此允许调用 addIngredients 和元素。

现在我不明白为什么允许 doSomething 调用 myBlender 和 myStuff ，因为它没有创建它。

3.

```
void processTransaction(BankAccount acct, int) {
Person *who;
Money amt;
amt.setValue(123.45);
acct.setBalance(amt);
who = acct .getOwner() ;
markWorkflow(who->name(), SET_BALANCE);
} 
```

> 在这种情况下，processTransaction 拥有 amt，它是在堆栈上创建的，acct 是传入的，因此 setValue 和 setBalance 都是允许的。但是 processTransaction 不拥有谁，所以调用 who->name() 是违规的。

所以在这里它确实声明了谁，但不允许调用它。也许我误解了“拥有”的概念。

有人可以澄清一下吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:16:10.043

让我们一一来看看所谓的矛盾。

1.

```
public void showBalance(BankAccount acct) {
    Money amt = acct. getBalance() ;
    printToScreen(amt .printFormat()) ;
}

The variable acct is passed in as a parameter, 
so the getBalance call is allowed. 
Calling amt.printFormat(), however, is not. 
We don't "own" amt and it wasn't passed to us. 
```

这个声明是完全有效的，因为 LoD 声明虽然`acct`可以传递给`showBalance()`并且`showBalance()`可以访问`getBalance()`由于直接引用`acct`，它可能不会在 的任何实例上调用任何方法`Money`。这是因为没有类型的对象`Money`被传递给`showBalance()`，它只是通过本地访问器引用它。这并不意味着`amt`现在拥有`showBalance()`.

2.

```
public class Colada {
    private Blender myBlender;
    private Vector myStuff;

    public Colada() {
        myBlender = new Blender();
        myStuff = new Vector() ;
    }

    private void doSomething() {
        myBlender.addlngredients(myStuff.elements());
    }
}

Since Colada creates and owns both myBlender and myStuff, 
the calls to addIngredients and elements are allowed . 
```

现在，在这个类构造函数中发生的是 a`Blender`和一个`Vector`对象的声明和实例化。`myBlender`因此， and的所有者`myStuff`是类`Colada`。LoD 声明`m`对象的方法`o`可以访问 的所有直接组件`o`，因此在这种情况下，方法可以直接`doSomething()`访问`Colada`的组件，并且它可以调用和的方法`Blender`和。`Vector``myBlender``myStuff`

3.

```
void processTransaction(BankAccount acct, int) {
    Person *who;
    Money amt;
    amt.setValue(123.45);
    acct.setBalance(amt);
    who = acct .getOwner() ;
    markWorkflow(who->name(), SET_BALANCE);
}

In this case, processTransaction owns amt, 
it is created on the stack, acct is passed in, 
so both setValue and setBalance are allowed. 
But processTransaction does not own who, 
so the call who->name() is in violation. 
```

该方法`processTransaction()`接收对象中的银行帐户`acct`。它初始化一个 type 的对象`Money`，设置值，然后调用`setBalance()`acct 上的 setter 方法，这与 LoD 是一致的。由于`amt`是在里面创建和初始化的`processTransaction`，所以访问`setValue`of`amt`也是符合LoD的。现在矛盾来了。`*who`只是一个指向类型对象的指针`Person`，它只能通过访问器方法看到`getOwner`。但该方法归 拥有`acct`，因此调用方法`*who`无效，因为它会破坏 LoD。

简而言之，LoD 状态`a.getB().getC().doSomething()`无效，只有`a.getB()`有效。如果我必须用简单的英语写 LoD，可以用 3 个单词指定 - `Chain Of Command`。

假设层次结构 其中`Object A`包含 的实例`Object B`，并且`Object B`包含 的实例`Object C`，根据 LoD，以下情况成立。

*   对象 A 不能通过对象 B 的实例访问和更改对象 C。
*   但是，对象 B 可以根据可以从对象 A 获取的某些标准访问和更改对象 C。

我希望这能消除你的疑虑。